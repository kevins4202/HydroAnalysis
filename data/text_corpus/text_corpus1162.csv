index,text
5810,extended streamflow forecasting is nowadays important for early flood warning and risk mitigation under a changing climate however the absence of reliable estimates of the usual streamflow descriptors at the considered time horizons renders common input output modeling approaches inapt for extended forecasting for such a problem system recurrence information is vital to produce relatively improved forecasts like any time series generated by complex systems river flow can be represented by a time varying parameter tvp model tvp modeling frameworks often assume that the system evolution exhibits superstatistical random walks and a number of statistical assumptions is followed upon to infer better forecasts from the system also the tvps should hone a model s ability to capture system recurrence which in this case translates to a number of state based model structures in this work we develop an ensemble based computationally efficient method that extracts useful cyclic type tvps which are strongly coupled over extended but more continuous and less aggregated time horizons a multi level modeling framework is proposed to facilitate the creation and direct use of updated parameter states to produce more reliable forecasts on the considered temporal resolutions a dummy variable optimization technique is also proposed within the state updating procedure to allow smooth state transition we show that the modeling framework produces stable results of parameter variations at different time horizons when applied to estimate the streamflow of clearwater river the proposed framework can incorporate exogenous descriptors at different levels without loss of generality and can be used for various forecasting applications keywords system identification time varying paramter tvp multi level modeling dummy variable optimization ensemble learning streamflow forecasting 1 introduction flood warning systems are vital for many communities worldwide such systems require reliable forecasts over extended horizons different from those usually referred to as long term forecasts where weather information may not be available shiri and kisi 2010 long term river flow forecasting studies have been dominated by statistical and deterministic based techniques atiya et al 1999 lucatero et al 2018 yaseen et al 2018 such techniques can successfully produce useful inferences in absence of information about the variables that drive river flow duan et al 1992 dye and croke 2003 the gap in the frequency temporal resolution and aggregation size between short term and long term forecasts is ignored and implicitly justified given the absence of important predictor information also similar to any time series generated by complex dynamical systems river flow has a time changing pattern and hence can be represented by a model whose parameters change in time in other words a set of streamflow modes or response patterns are naturally observed and attributed to various factors this class of modeling approaches is usually referred to as time varying parameter tvp modeling and originates from fields outside of water resource management and hydrology verdult and verhaegen 2005 the above is not to be confused with approaches intended for modeling nonstationary processes in hydrology el adlouni et al 2007 sarhadi et al 2016 tvp models are considered a subset of modeling frameworks referred to as probability error methods under the umbrella of system identification ljung 1998 söderström and stoica 1989 nevertheless tvp modeling frameworks often exhibit stochastic properties and relevant assumptions are utilized when building a model based on this view these statistical techniques have been developed in the literature and discussed in control system frameworks verdult and verhaegen 2005 viberg 1995 in general two broad approaches for modeling systems can be recognized under system identification probability error methods and methods which relate to the stochastic realization theory van overschee and de moor 2012 the latter deals with building models from data and is not solely based on optimization concepts as in probability error methods katayama and picci 1999 in addition models based on stochastic realization have been recognized as either applying a deterministic analysis to the data derived hankel matrix or applying the canonical correlation analysis to the observed system dynamics further studies in this field have led to the development of an important branch in stochastic realization based models known as subspace identification methods akaike 1974a akaike 1974b ho and kálmán 1966 an advantage of subspace methods is that they are free from nonlinear optimization techniques and do not require imposing or investigating canonical parametrization on the system s model larimore 1983 larimore 1990 qin and ljung 2003 hence modeling techniques following this framework such as subspace methods do not suffer from the inconveniences encountered in several well established statistical techniques commonly used for a variety of applications especially in hydrology in addition kalman filtering has been widely used in short term river flow forecasting studies loizu et al 2018 maxwell et al 2018 moradkhani et al 2005 neal et al 2007 on the other hand most of the related studies in the literature discuss kalman filter method independently from its family of modeling techniques and do not provide a clear separation from conventional time series forecasting techniques furthermore the recent literature on system identification provides an introduction to tvp modeling practice bamieh and giarre 2002 from this perspective tvp enables the linearization of a complex system s model modified in time to match a nominal behavior of the system at that instance this is analogous to utilizing taylor series expansion to linearize a function around a proximate point in the function s space various studies adopted this approach and reported improved results in their applications outside hydrology and water resource management bastin and gevers 1988 liu et al 2017 tsatsanis and giannakis 1993 while tvp modeling solutions have the potential to bridge the gap in the river flow forecasting practice the evolution of river flow is recurrent in other words the tvps should hone a predefined model s ability to capture systems recurrence this requires the development of a new varying parameter modeling approach which combines the advantages of probability error and state space methods to the best of our knowledge there has been no research effort made to study such models for extended short term streamflow forecasting in this work we develop a computationally efficient method which extracts useful cyclic type tvps that are predictable a modeling framework is presented where a state defining procedure and state updating output forecasting model is proposed linear regression is used to facilitate the creation and direct use of updated parameter states and produce improved forecasts on the considered prediction horizons the model does not require inherently stochastic assumptions and can be formulated using a linear programing routine we apply the proposed model to forecast the streamflow of clearwater river in canada at different temporal resolutions and different time horizons the main objective of this study is to introduce varying parameter modeling to hydrology and provide a discussion on how the problem of interest can innovate new tvp models which are useful to a wide range of applications the paper is organized as follows section 2 details the proposed method starting with a relevant summary of a time varying parameter approach from system identification aspect terminology section 3 presents the case studies and experimental setup for the developed model sections 4 and 5 provide the results of the case study and conclusions of this work respectively 2 methodology 2 1 common state space formulation for a broad overview of system identification and varying parameter modeling a detailed description is provided in the literature such as in bamieh and giarre 2002 ljung 1998 van overschee and de moor 2012 viberg 1995 suppose that the system s real functional form is not known which is usually the case in the field of interest but a set of observations is available such as 1 ds p k y k u k k 1 l where u k r n u is the system input y k r is the system output p k r n p is the time varying parameter vector k 1 2 l is the time step for a discrete representation of the system dataset and captured dynamics and l is the size of the dataset in terms of available observations in the dataset ds system identification general framework deals with the creation of useful models of the system system identification describes the identification approach via an observability state space representation of the candidate model such as 2 x k 1 a p k x k b p k u k w k y k c p k x k d p k u k v k where x k r n x is the state of the system w k r n x is the process noise v k r is the measurement noise a p k ℝ n x n x b p k ℝ n u n x c p k ℝ n x d p k ℝ n u are the system s evolving parameter matrices in addition an important practice in this formulation allowing an efficient linearization in all aspects of the real system is to create a predefined compact set p from which the time varying parameters stem i e p k p r n p in other words we aim to create a set of parameters that changes and overlaps in time which is also related to the state of the system hence a useful definition is shown to be that each state will have p k p x x k in other words a number of linear time invariant lti models will be defined to appropriately cover all the available dynamics within the system of interest and an interpolation or weighted selection can be utilized in the state space formulation the compact set will define the low level models in the hierarchy which will be discussed shortly fig 1 depicts an illustration of the main idea behind this approach because in the lti construction stage the collection of these models should be defined over all the state space the latter should be defined appropriately 2 2 proposed tvp approach the usual state space formulation is interested in properties of matrix a k and a trivial selection of matrices b c and d is usually performed due to the nature of the problem of interest and predetermined knowledge of the lti models type the varying parameter framework in this work implicates another approach to defining these matrices such that 3 x k 1 a k x k w k y k c k x k d k u k v k the subspace formulation in eq 3 is chosen to facilitate the use of different techniques for the various parts of the model furthermore we begin by defining the dynamics of matrix c k which is the link to the low level model as follows 4 c p x x k β 1 u β 2 u β n x u t where β i is the ordinary least squares ols parameters of the linear models describing the system in state i i 1 2 nx u is the predefined subset of covariates or explanatory variables which are used in the low level linear model and define the subset ds from the available dataset here we have two main tasks choosing the right number of states nx and the appropriate set of explanatories for the low level model in order to create the implicitly time dependant matrix c k this can be done by a validation plan which minimizes the number of states required to approximate the system of interest in this work the choice of the number of states and the evaluation of the lti model parameters are performed interactively in other words the lti parameters are estimated in the following manner 5 β β 1 r u k γ n x 1 2 β 2 r u k γ n x 1 2 1 β n x 1 2 r u k γ 0 β n x 1 r u k γ 1 n x 1 2 β n x r u k γ n x 1 2 where β is the parameter matrix of all the defined lti models r u k is the ols residual from fitting a linear model using the available input data in ds and γ i is a predefined residual level through which the available input output data has been clustered when comparing their residuals to γ i and each cluster of data was used to determine the corresponding lti model parameters β 1 notice that the definition given by eq 5 demands an odd number of states where the middle state x k x 0 drives this oddity in addition we simplify the search for optimal number of states by setting a symmetric choice of the parameters γ i around the middle state such that 6 γ i γ i i 1 2 n x 1 2 hence in the state determination stage the number of states can be easily found by only evaluating the trade off between the available number of data in each cluster and the overall goodness of fit to the corresponding lti model i e for a given cluster moreover the state extraction problem shown here is in fact one dimensional because the state space formulation presented is for a single output state space soss model which is sufficient for the problem of interest a generalization to this stage is expected to be significantly different for a multiple output state space moss model and is out of scope noticeably we can now set c p x x k c k u k β for each time step k 1 2 l as a result the evaluation of matrix c k is done independently from the rest of the varying parameter model matrices which reduces the computational requirement of this modeling framework and allows for a more flexible optimization problem of which we take advantage to this extent we require useful insights on matrices a and d in order to complete the optimization problem due to the fact that we consider an io state representation i e x k is multinomial vector matrix a k is defined as a transition matrix such that 7 x k 1 a k x k j 1 n x a i j k 1 i 1 2 n x j 1 n x x j k 1 1 this definition is similar to the markov chain representation of memoryless evolution of system states however a new transition matrix is defined every time step and different initial states are considered as well as different information set is fed to the optimization problem hence the memoryless nature of this system is the only similarity to that in the markovian processes the last constraint in eq 7 is inherently satisfied and not needed as long as the formulation above is used only for one step ahead forecasting lastly matrix d k which is a one dimensional vector in our case will be determined as a residual from the optimization problem which will be defined shortly from an empirical point of view d k 1 u k 1 can be considered as a component relieving other components from utilizing information important to the forecast but not considered in the transition matrix formulation i e not part of the specific input set u used to build the states whose corresponding parameters are preserved within β 2 3 dummy variable optimization notice here that the step ahead state forecast will likely have uncertain entries due to the nature of the transition matrix while this may be a stochastic problem faced by conventional modeling approaches we take advantage of this state distribution it is obvious that multiple solutions can be generated from c k 1 x k 1 leading to an appropriate forecast of the output y k 1 this is evident because not only c k 1 is not unique on the true state due to the lti approximation nature of its origin but also because infinite combinations of x k 1 can be potentially generated from specific formulation of a yielding appropriate forecasts as well instead of attempting to find a classical solution the previous as it is usually the case in conventional modeling we take advantage of such nature we utilize a sequence of dummy state variable x d k k 1 2 l 1 such that 8 x d k 1 a k x d k y d k 1 c k 1 x d k 1 where y d k 1 is the one step ahead estimate of the system output using the solution of the dummy state variable we also utilize this formulation in the optimization problem which is in the form 9 e k 1 α 1 l d ε 1 k 1 α 2 l d ε 2 k 1 α 3 l d ε 3 k 1 where 10 l d ε 1 k 1 y k 1 y k 1 d 11 l d ε 2 k 1 y k 1 y d k 1 d 12 l d ε 3 k 1 x k 1 x d k 1 d subject to 13 j 1 n x a ij k 1 i 1 2 n x k 1 2 l 1 14 j 1 n x x d j k 1 1 k 1 2 l 1 where e k 1 is the optimization problem formulated for time step k 1 to match the current dynamics ε s k 1 are the individual objective functions and α s s 1 2 3 constants are optimization scalars selected based on the priority of the corresponding objective function s components and l d ε s k 1 is the d th norm utilized within the objective function furthermore e k 1 can be seen as a scalar optimization problem since it is essentially a multi objective one while the three objective functions are linked via the transition matrix each plays a major role in estimating the system matrices the first objective function is utilized to estimate the transition matrix a k and system matrix d k the third objective function prompts a smoothing effect or a robust search approach where the dummy variables facilitate identifying a more resilient x k 1 path as discussed before this smoothing effect further manages the estimation of the system matrices hence there will be a mixture of state transition effects coming from the certain x k state and corresponding estimates preserved within the system matrix c k 1 and a superposition of various other possible solutions captured by the dummy optimization variables this approach is one of the main contributions of the proposed method we take further notice of the nature of our optimization problem e k 1 the optimization problem is formulated every time step i e a recursive formulation is performed to evaluate the system states and output hence the dataset ds should be arranged such that a subset of data is selected to match the current dynamics of the system and initiate the estimation procedure this can be done by determining useful features for the subset selection and allocating them in an auxiliary dataset ds this is recently referred to as soft mutual nearest neighbor filtering smnnf in the broad literature rocco et al 2018 the discrete time based family of systems for which the proposed methodology is considered is likely to have a time series representation of lagged output observations as part of its feature space these variables can be selected into ds and the subset matching procedure will be performed such that particular data arrangements f ds and f ds are projected to f ds b and f ds a using a useful transformation in this work the pearson linear correlation operator is used to select the subset from ds and then the corresponding observations in ds are matched in addition a further improvement to the estimation approach is allowed we utilize an ensemble learning procedure where a resampling of the matched subset is performed and the proposed methodology is applied using each resample this will create an ensemble of estimates of the varying parameter model s matrices called neighborhood lti consensus network and sub ensemble tvp models respectively the corresponding estimates of the output variables are then combined using the mean statistic once all observations in the training set are estimated using the proposed methodology and the suggested ensemble learning procedure commonly known as bootstrap aggregation bagging we finalize the improved estimation by inputting the ensemble estimates into a bias correcting linear regression model the two latter improvements do not require mathematical description as bagging and linear regression are well established in the literature alobaidi et al 2019 fig 2 depicts a visual representation of the proposed methodology 3 experimental setup 3 1 description of the case studies we utilize the proposed method in river flow forecasting observed data of clearwater river alberta canada is considered the area served by the clearwater river drains is measured to be 30 800 km2 broach lake in saskatchewan canada is the headwaters of the river at an elevation of 460 m also it is estimated that only 20 of the total of a local basin athabasca basin covers the drainage area of the river fig 3 depicts the hydrological network of clearwater river the streamflow data q for the period between 1970 and 2012 is provided by water survey of canada wsc fig 4 shows the observed streamflow record precipitation pr snowfall s relative humidity rh minimum air temperature tmin and maximum air temperature tmax are obtained from station 07cd001 and t089r09w4 the coordinates of station 07cd001 are longitude 111 2554 and latitude 56 68528 it is observed that high flows often take place in spring this is particularly due to melting snow and seasonal rainfalls in contrast low flows take place in winter which is expected as precipitation takes the form of snow another observation is that extreme rainfall produce floods in summer the data shows a maximum daily flow of 790 m3 s recorded on april 30 1974 as well as a minimum of 26 2 m3 s recorded on february 19 1982 table 1 presents the descriptive statistics of the study variables in hydrological events the climatological variables may affect the streamflow with time delay to illustrate this in the present case studies the correlation coefficients between each of the available variables and the streamflow at different lags were calculated as well as the streamflow autocorrelation in this work we are interested in forecasting the one step ahead of three different flow resolutions three days ahead with a resolution of three day mean q 3 3 six days ahead with a resolution of three day mean q 6 3 and fourteen days ahead with a resolution of seven day mean q 14 7 are considered to identify the optimal set of predictors to forecast the streamflow cross correlation auto correlation and partial correlation analyses are applied given that in hydrological processes the climatological variables may affect the streamflow with time delay cross correlation is applied considering different lags as follows i cross correlation between the streamflow and all available predictors at different delay steps and auto correlation is applied ii the predictor with the highest correlation coefficient is considered the best predictor and is included in the optimal set of variables scaled to the considered temporal resolution iii partial correlation is then applied between the streamflow and the remaining variables the best predictor is included in the optimal set of predictors iv based on partial correlation results the second best predictor can be identified as the variable with the highest partial correlation coefficient v the partial correlation is again applied with the variables that showed significant partial correlation coefficient given the two most important predictors included and so forth in table 2 the correlation coefficients between streamflow and different possible predictors at lag time from zero to 10 days are shown the correlation coefficients shown in table 2 are all significant at 95 confidence level results of correlation analysis between the precipitation and streamflow showed an increasing pattern from lag 0 0 0894 to lag 7 0 1766 which indicates that rainwater from different places within the catchment may take around seven days to reach the main stream similarly the minimum air temperature at lag 3 tmin t 3 shows the best correlation coefficient for the tmin thus according to the cross correlation and auto correlation analyses to forecast the streamflow for any lead time q 3 3 q 6 3 and q 14 7 partial correlation analysis is then applied between the streamflow and the remaining predictors table 3 presents the results of the partial correlation analysis also table 3 shows that the st and tmax t are not significantly correlated while tmin t 3 pt 7 and rht are significantly correlated where pt 7 shows the highest partial correlation coefficient 0 266 results of the partial correlation analysis between streamflow and each of the t min t 3 and rht given that qt and pt 7 are included are given in table 3 which shows that both the t min t 3 and rht can be excluded thus for forecasting q 3 3 q 6 3 and q 14 7 the optimal set of predictors is scaled based on the one day resolution results 3 2 data preprocessing parameter tuning and evaluation criteria preprocessing is a critical stage in this work as the matching strategy optimization approach and estimation of system matrices depend on the variables considered in this work linear transformation is used for all the variables so that a 0 1 domain is observed using the following relation 15 v t v v max v max v min where v t is the linear transformation of variable v v max and v min are the maximum and minimum observed values of the variable v t respectively furthermore because the mean of different days ahead will be utilized it is important to note that moving average is not used to produce the dataset for each of the considered temporal resolutions in order not to bias the results hence the final dataset will have a size equal to the available number of days between january 1 1970 and december 31 2012 divided by the temporal resolution if the division yields a reminder the first days in the dataset is excluded from the study once the dataset is preprocessed and arranged in the proper format for the modeling stage a training set and a testing set should be used in this work we utilize a jackknife cross validation strategy where all the available observations in the processed dataset act as a target observation one at a time this allows us to mitigate the effect of data availability on the performance of the proposed modeling approach since we consider ensemble learning and bias correcting stage in this work every time the target point is excluded from the training set the latter is then used to create the subsets via bootstrap resampling and each of the obtained subsets will be divided into a validation set and a testing set the validation set will be used in the optimization problem to estimate the system matrices and the testing set will be used to tune the bias correcting regression model moreover all ensembles will have a size 10 and will not require a separate validation set for the integration stage since bagging ensembles uses the mean statistic it is important to note that the pre analysis of the case studies showed that the optimal number of states is three this is expected since river flow is a one dimensional system to this extent the pearson correlation used in the matching and data selection strategies from the available dataset with the target observation will be utilized on a three previous observation string of the streamflow comprising the variables in ds fig 5 shows a snapshot of the discussed procedure for one target observation whose training set is resampled and a subset is selected finally the evaluation criteria used in this study are the root mean square error rmse median absolute deviation mad relative root mean square error rrmse and relative median absolute deviation rmad used as measures of model performance and generalization ability over different ensemble parameter values i e mixture ratios the rmad and rrmse measures are obtained by normalizing the error magnitude of each point by its own magnitude performance criteria are defined as follows 16 rmse t d 1 l i 1 l q t d i q t d i 2 17 rrmse t d 100 1 l i 1 l q t d i q t d i q t d i 2 18 mad t d m e d i a n q t d i q t d i 19 rmad t d 100 m e d i a n q t d i q t d i q t d i where q t d i is the ith observation of the d day mean streamflow d 3 7 14 q t d i is the final estimate of q t d i after passing through the ensemble model and bias correcting model and l is the number of observations the use of the above criteria is motivated due to the different information each measurement provides rmse and mad criteria are typical performance measurements in addition rrmse and rmad complement the latter as they provide information of the models performance distribution low rrmse and rmad values indicate that the target variable s lower observations have relatively low prediction errors which is obviously the preferred target in contrast if these measures are found high they indicate that the low and high target variable s observations are poorly predicted hosking and wallis 1993 hence using the four error measurement criteria is important moreover the use of the median statistic rather than the bias error criterion is motivated due to the scaling problem in streamflow records 4 results and discussion the proposed ensemble integrated framework is demonstrated on the considered case studies and compared against a linear regression as described in the design section for each one of the three extended short term forecasting problems the models are created and trained the optimum model results are evaluated via jackknife simulation over the different forecasting problems as stated earlier varying the number of states considered for the system identification part of the varying parameter model may provide different optimum configuration results every time a validation study is carried out hence the ensemble of these models is expected to alleviate this validation issue in this study the number of considered varying states is limited to three moreover the use of linear regression as a benchmark is facilitated due to previous work which shows that it is the best among other more complex models such as artificial neural networks support vector machines and decision trees predicting streamflow using input output model first level at extended horizons will produce inferior forecasts especially on events with relatively higher streamflow values whether it is a linear model or a complex model the proposed method incorporates the system s recurrence information second level in the modeling framework assuming cyclic behavior which allows for improved capture of events on an extended horizon in addition table 4 shows the results of the expected performance of perfect state matching for each forecasting problem fig 6 presents the expected scatter of forecasted streamflow values with respect to their observed values notice that this can be used as an expected maximum of the model performance or training performance from a machine learning perspective the training errors among all performance criteria tend to increase with an increase of the time horizon this result conforms intuition as higher horizons are more challenging to forecast in addition q14 7 forecasts have a mild case of heteroscedastic estimates due to the absence of rainfall data along the two week window of forecasting hence the proposed model should account for this problem and limit the dependence of forecasts on the immediate streamflow observation closest to the forecasted one moreover table 4 shows the results of the optimum model performance for each case study the results agree with the expected behavior as shorter forecasting horizons prompts better results in addition a comparison with the linear regression models performance shows a significant improvement undertaken by the proposed model in all performance criteria comparing the training error with the testing error tables 4 and 5 we can also observe additional insights on the proposed optimization framework the use of dummy variables allows us to utilize a superposition of unseen optimal solutions to the state estimates embedded on the latter s effect on the transition matrix hence a significant improvement in the testing results is provided in other words if such effect is not utilized the optimization problem will converge to an attempt of pure fitting of the state estimates to the real ones coming from prior construction of matrix c k and its corresponding states x k the fact that the proposed model produces improved forecasting performance emphasizes on the requirement to include structural recurrences in the modeling problem of extended short term forecasting the state space formulation of the proposed model enables the capture of predefined recurrences in the river flow and pursues a dynamic integration of their recurrences to produce a useful super positioning of the available outputs this integration identity is also similar to the third stage in the ensemble learning framework which is ensemble integration furthermore the application of the proposed model can be done continuously so that the forecasts can be generated per the chosen temporal resolution unlike those in mid term and long term forecasting the authors created unique observations from the available streamflow history without a moving average usually used to generate as much observations as possible the generation of unique observations is used in this work in order to ensure unbiased performance results affected by the moving average which generates significant similarity between consecutive training observations in the same time the generation of unique observation yields gaps in the time series which would be compensated by executing the proposed model on different time series generated sequentially to provide a continuous forecasting in fig 7 the jackknife results are presented for the proposed model and linear regression model performed for each case study the figure shows the jackknife estimates with respect to observed streamflow values all proposed models provided the best forecasting performance along the space of the observed values lower streamflow values are more accurately forecasted and high streamflow events have been properly captured in many occasions more importantly the relatively moderate streamflow observations usually occurring in the beginning of the spring and end of fall are more adequately forecasted this forecasting behavior shows the ability of the proposed model to utilize most of the available information during such transient flow seasons which are also indicators to possible high streamflow events if properly forecasted the linear regression scatter plots show the challenge in forecasting these events apparent in the mid space of the target observations to provide an insight on the stability of the obtained performances from the proposed models a monte carlo simulation is carried out on the available error measurement criteria the proposed models produce stable forecasts far more superior to the linear regression models this trend is a result from utilizing the ensemble learning strategy bagging as well as the final bias correcting model more importantly even in seasons of high streamflow where the performance of all models is lowest the proposed framework produces stable forecasting performance with tighter error bounds this is also due to the added benefit of ensemble learning stage which superimposes diverse hidden optimal solutions of the results from the previous subspace model 5 conclusions in this work a varying parameter method utilizing an ensemble of a system identification approach to forecast streamflow was proposed for extended short term streamflow forecasting the main contributions of the proposed method comprised of the introduction of system identification based varying parameter modeling to hydrology and water resource management development of a subspace formulation unique to the pure and applied literature utilization of a simple and novel time varying state representation and integration of ensemble learning in the proposed method moreover the use of dummy variable optimization for extraction of a superposition of hidden optimal solutions was considered this work is expected to bring more attention toward the use of system identification and machine learning techniques in hydrology and water resource management future work will consider investigating a robust state extraction approach that does not limit the formulation to predefined states coming from the derived lti models in addition a clustering approach could be developed in order to facilitate better representation of the state transition matrix and new ensemble models should be utilized for further improvement of the forecasting strategy because of the observed heteroscedastic nature of the forecasts in the long horizon case study more attention must be paid to the transformation of the available features which is expected to play a major role in alleviating this problem varying parameter models rely heavily on the available data and model constraints hence another potential improvement is expected when developing a new testing strategy which can provide more insights on the suitability of the utilized modeling framework in comparison with other candidate approaches the proposed approach can also be investigated in terms of pure ensemble learning where the subspace identification stage will rely on nonlinear systems represented by for example artificial neural networks authorship contribution statement mohammad h alobaidi conceptualization methodology software data curation writing original draft mohamed a meguid writing review editing supervision fateh chebana conceptualization writing review editing supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper 
5810,extended streamflow forecasting is nowadays important for early flood warning and risk mitigation under a changing climate however the absence of reliable estimates of the usual streamflow descriptors at the considered time horizons renders common input output modeling approaches inapt for extended forecasting for such a problem system recurrence information is vital to produce relatively improved forecasts like any time series generated by complex systems river flow can be represented by a time varying parameter tvp model tvp modeling frameworks often assume that the system evolution exhibits superstatistical random walks and a number of statistical assumptions is followed upon to infer better forecasts from the system also the tvps should hone a model s ability to capture system recurrence which in this case translates to a number of state based model structures in this work we develop an ensemble based computationally efficient method that extracts useful cyclic type tvps which are strongly coupled over extended but more continuous and less aggregated time horizons a multi level modeling framework is proposed to facilitate the creation and direct use of updated parameter states to produce more reliable forecasts on the considered temporal resolutions a dummy variable optimization technique is also proposed within the state updating procedure to allow smooth state transition we show that the modeling framework produces stable results of parameter variations at different time horizons when applied to estimate the streamflow of clearwater river the proposed framework can incorporate exogenous descriptors at different levels without loss of generality and can be used for various forecasting applications keywords system identification time varying paramter tvp multi level modeling dummy variable optimization ensemble learning streamflow forecasting 1 introduction flood warning systems are vital for many communities worldwide such systems require reliable forecasts over extended horizons different from those usually referred to as long term forecasts where weather information may not be available shiri and kisi 2010 long term river flow forecasting studies have been dominated by statistical and deterministic based techniques atiya et al 1999 lucatero et al 2018 yaseen et al 2018 such techniques can successfully produce useful inferences in absence of information about the variables that drive river flow duan et al 1992 dye and croke 2003 the gap in the frequency temporal resolution and aggregation size between short term and long term forecasts is ignored and implicitly justified given the absence of important predictor information also similar to any time series generated by complex dynamical systems river flow has a time changing pattern and hence can be represented by a model whose parameters change in time in other words a set of streamflow modes or response patterns are naturally observed and attributed to various factors this class of modeling approaches is usually referred to as time varying parameter tvp modeling and originates from fields outside of water resource management and hydrology verdult and verhaegen 2005 the above is not to be confused with approaches intended for modeling nonstationary processes in hydrology el adlouni et al 2007 sarhadi et al 2016 tvp models are considered a subset of modeling frameworks referred to as probability error methods under the umbrella of system identification ljung 1998 söderström and stoica 1989 nevertheless tvp modeling frameworks often exhibit stochastic properties and relevant assumptions are utilized when building a model based on this view these statistical techniques have been developed in the literature and discussed in control system frameworks verdult and verhaegen 2005 viberg 1995 in general two broad approaches for modeling systems can be recognized under system identification probability error methods and methods which relate to the stochastic realization theory van overschee and de moor 2012 the latter deals with building models from data and is not solely based on optimization concepts as in probability error methods katayama and picci 1999 in addition models based on stochastic realization have been recognized as either applying a deterministic analysis to the data derived hankel matrix or applying the canonical correlation analysis to the observed system dynamics further studies in this field have led to the development of an important branch in stochastic realization based models known as subspace identification methods akaike 1974a akaike 1974b ho and kálmán 1966 an advantage of subspace methods is that they are free from nonlinear optimization techniques and do not require imposing or investigating canonical parametrization on the system s model larimore 1983 larimore 1990 qin and ljung 2003 hence modeling techniques following this framework such as subspace methods do not suffer from the inconveniences encountered in several well established statistical techniques commonly used for a variety of applications especially in hydrology in addition kalman filtering has been widely used in short term river flow forecasting studies loizu et al 2018 maxwell et al 2018 moradkhani et al 2005 neal et al 2007 on the other hand most of the related studies in the literature discuss kalman filter method independently from its family of modeling techniques and do not provide a clear separation from conventional time series forecasting techniques furthermore the recent literature on system identification provides an introduction to tvp modeling practice bamieh and giarre 2002 from this perspective tvp enables the linearization of a complex system s model modified in time to match a nominal behavior of the system at that instance this is analogous to utilizing taylor series expansion to linearize a function around a proximate point in the function s space various studies adopted this approach and reported improved results in their applications outside hydrology and water resource management bastin and gevers 1988 liu et al 2017 tsatsanis and giannakis 1993 while tvp modeling solutions have the potential to bridge the gap in the river flow forecasting practice the evolution of river flow is recurrent in other words the tvps should hone a predefined model s ability to capture systems recurrence this requires the development of a new varying parameter modeling approach which combines the advantages of probability error and state space methods to the best of our knowledge there has been no research effort made to study such models for extended short term streamflow forecasting in this work we develop a computationally efficient method which extracts useful cyclic type tvps that are predictable a modeling framework is presented where a state defining procedure and state updating output forecasting model is proposed linear regression is used to facilitate the creation and direct use of updated parameter states and produce improved forecasts on the considered prediction horizons the model does not require inherently stochastic assumptions and can be formulated using a linear programing routine we apply the proposed model to forecast the streamflow of clearwater river in canada at different temporal resolutions and different time horizons the main objective of this study is to introduce varying parameter modeling to hydrology and provide a discussion on how the problem of interest can innovate new tvp models which are useful to a wide range of applications the paper is organized as follows section 2 details the proposed method starting with a relevant summary of a time varying parameter approach from system identification aspect terminology section 3 presents the case studies and experimental setup for the developed model sections 4 and 5 provide the results of the case study and conclusions of this work respectively 2 methodology 2 1 common state space formulation for a broad overview of system identification and varying parameter modeling a detailed description is provided in the literature such as in bamieh and giarre 2002 ljung 1998 van overschee and de moor 2012 viberg 1995 suppose that the system s real functional form is not known which is usually the case in the field of interest but a set of observations is available such as 1 ds p k y k u k k 1 l where u k r n u is the system input y k r is the system output p k r n p is the time varying parameter vector k 1 2 l is the time step for a discrete representation of the system dataset and captured dynamics and l is the size of the dataset in terms of available observations in the dataset ds system identification general framework deals with the creation of useful models of the system system identification describes the identification approach via an observability state space representation of the candidate model such as 2 x k 1 a p k x k b p k u k w k y k c p k x k d p k u k v k where x k r n x is the state of the system w k r n x is the process noise v k r is the measurement noise a p k ℝ n x n x b p k ℝ n u n x c p k ℝ n x d p k ℝ n u are the system s evolving parameter matrices in addition an important practice in this formulation allowing an efficient linearization in all aspects of the real system is to create a predefined compact set p from which the time varying parameters stem i e p k p r n p in other words we aim to create a set of parameters that changes and overlaps in time which is also related to the state of the system hence a useful definition is shown to be that each state will have p k p x x k in other words a number of linear time invariant lti models will be defined to appropriately cover all the available dynamics within the system of interest and an interpolation or weighted selection can be utilized in the state space formulation the compact set will define the low level models in the hierarchy which will be discussed shortly fig 1 depicts an illustration of the main idea behind this approach because in the lti construction stage the collection of these models should be defined over all the state space the latter should be defined appropriately 2 2 proposed tvp approach the usual state space formulation is interested in properties of matrix a k and a trivial selection of matrices b c and d is usually performed due to the nature of the problem of interest and predetermined knowledge of the lti models type the varying parameter framework in this work implicates another approach to defining these matrices such that 3 x k 1 a k x k w k y k c k x k d k u k v k the subspace formulation in eq 3 is chosen to facilitate the use of different techniques for the various parts of the model furthermore we begin by defining the dynamics of matrix c k which is the link to the low level model as follows 4 c p x x k β 1 u β 2 u β n x u t where β i is the ordinary least squares ols parameters of the linear models describing the system in state i i 1 2 nx u is the predefined subset of covariates or explanatory variables which are used in the low level linear model and define the subset ds from the available dataset here we have two main tasks choosing the right number of states nx and the appropriate set of explanatories for the low level model in order to create the implicitly time dependant matrix c k this can be done by a validation plan which minimizes the number of states required to approximate the system of interest in this work the choice of the number of states and the evaluation of the lti model parameters are performed interactively in other words the lti parameters are estimated in the following manner 5 β β 1 r u k γ n x 1 2 β 2 r u k γ n x 1 2 1 β n x 1 2 r u k γ 0 β n x 1 r u k γ 1 n x 1 2 β n x r u k γ n x 1 2 where β is the parameter matrix of all the defined lti models r u k is the ols residual from fitting a linear model using the available input data in ds and γ i is a predefined residual level through which the available input output data has been clustered when comparing their residuals to γ i and each cluster of data was used to determine the corresponding lti model parameters β 1 notice that the definition given by eq 5 demands an odd number of states where the middle state x k x 0 drives this oddity in addition we simplify the search for optimal number of states by setting a symmetric choice of the parameters γ i around the middle state such that 6 γ i γ i i 1 2 n x 1 2 hence in the state determination stage the number of states can be easily found by only evaluating the trade off between the available number of data in each cluster and the overall goodness of fit to the corresponding lti model i e for a given cluster moreover the state extraction problem shown here is in fact one dimensional because the state space formulation presented is for a single output state space soss model which is sufficient for the problem of interest a generalization to this stage is expected to be significantly different for a multiple output state space moss model and is out of scope noticeably we can now set c p x x k c k u k β for each time step k 1 2 l as a result the evaluation of matrix c k is done independently from the rest of the varying parameter model matrices which reduces the computational requirement of this modeling framework and allows for a more flexible optimization problem of which we take advantage to this extent we require useful insights on matrices a and d in order to complete the optimization problem due to the fact that we consider an io state representation i e x k is multinomial vector matrix a k is defined as a transition matrix such that 7 x k 1 a k x k j 1 n x a i j k 1 i 1 2 n x j 1 n x x j k 1 1 this definition is similar to the markov chain representation of memoryless evolution of system states however a new transition matrix is defined every time step and different initial states are considered as well as different information set is fed to the optimization problem hence the memoryless nature of this system is the only similarity to that in the markovian processes the last constraint in eq 7 is inherently satisfied and not needed as long as the formulation above is used only for one step ahead forecasting lastly matrix d k which is a one dimensional vector in our case will be determined as a residual from the optimization problem which will be defined shortly from an empirical point of view d k 1 u k 1 can be considered as a component relieving other components from utilizing information important to the forecast but not considered in the transition matrix formulation i e not part of the specific input set u used to build the states whose corresponding parameters are preserved within β 2 3 dummy variable optimization notice here that the step ahead state forecast will likely have uncertain entries due to the nature of the transition matrix while this may be a stochastic problem faced by conventional modeling approaches we take advantage of this state distribution it is obvious that multiple solutions can be generated from c k 1 x k 1 leading to an appropriate forecast of the output y k 1 this is evident because not only c k 1 is not unique on the true state due to the lti approximation nature of its origin but also because infinite combinations of x k 1 can be potentially generated from specific formulation of a yielding appropriate forecasts as well instead of attempting to find a classical solution the previous as it is usually the case in conventional modeling we take advantage of such nature we utilize a sequence of dummy state variable x d k k 1 2 l 1 such that 8 x d k 1 a k x d k y d k 1 c k 1 x d k 1 where y d k 1 is the one step ahead estimate of the system output using the solution of the dummy state variable we also utilize this formulation in the optimization problem which is in the form 9 e k 1 α 1 l d ε 1 k 1 α 2 l d ε 2 k 1 α 3 l d ε 3 k 1 where 10 l d ε 1 k 1 y k 1 y k 1 d 11 l d ε 2 k 1 y k 1 y d k 1 d 12 l d ε 3 k 1 x k 1 x d k 1 d subject to 13 j 1 n x a ij k 1 i 1 2 n x k 1 2 l 1 14 j 1 n x x d j k 1 1 k 1 2 l 1 where e k 1 is the optimization problem formulated for time step k 1 to match the current dynamics ε s k 1 are the individual objective functions and α s s 1 2 3 constants are optimization scalars selected based on the priority of the corresponding objective function s components and l d ε s k 1 is the d th norm utilized within the objective function furthermore e k 1 can be seen as a scalar optimization problem since it is essentially a multi objective one while the three objective functions are linked via the transition matrix each plays a major role in estimating the system matrices the first objective function is utilized to estimate the transition matrix a k and system matrix d k the third objective function prompts a smoothing effect or a robust search approach where the dummy variables facilitate identifying a more resilient x k 1 path as discussed before this smoothing effect further manages the estimation of the system matrices hence there will be a mixture of state transition effects coming from the certain x k state and corresponding estimates preserved within the system matrix c k 1 and a superposition of various other possible solutions captured by the dummy optimization variables this approach is one of the main contributions of the proposed method we take further notice of the nature of our optimization problem e k 1 the optimization problem is formulated every time step i e a recursive formulation is performed to evaluate the system states and output hence the dataset ds should be arranged such that a subset of data is selected to match the current dynamics of the system and initiate the estimation procedure this can be done by determining useful features for the subset selection and allocating them in an auxiliary dataset ds this is recently referred to as soft mutual nearest neighbor filtering smnnf in the broad literature rocco et al 2018 the discrete time based family of systems for which the proposed methodology is considered is likely to have a time series representation of lagged output observations as part of its feature space these variables can be selected into ds and the subset matching procedure will be performed such that particular data arrangements f ds and f ds are projected to f ds b and f ds a using a useful transformation in this work the pearson linear correlation operator is used to select the subset from ds and then the corresponding observations in ds are matched in addition a further improvement to the estimation approach is allowed we utilize an ensemble learning procedure where a resampling of the matched subset is performed and the proposed methodology is applied using each resample this will create an ensemble of estimates of the varying parameter model s matrices called neighborhood lti consensus network and sub ensemble tvp models respectively the corresponding estimates of the output variables are then combined using the mean statistic once all observations in the training set are estimated using the proposed methodology and the suggested ensemble learning procedure commonly known as bootstrap aggregation bagging we finalize the improved estimation by inputting the ensemble estimates into a bias correcting linear regression model the two latter improvements do not require mathematical description as bagging and linear regression are well established in the literature alobaidi et al 2019 fig 2 depicts a visual representation of the proposed methodology 3 experimental setup 3 1 description of the case studies we utilize the proposed method in river flow forecasting observed data of clearwater river alberta canada is considered the area served by the clearwater river drains is measured to be 30 800 km2 broach lake in saskatchewan canada is the headwaters of the river at an elevation of 460 m also it is estimated that only 20 of the total of a local basin athabasca basin covers the drainage area of the river fig 3 depicts the hydrological network of clearwater river the streamflow data q for the period between 1970 and 2012 is provided by water survey of canada wsc fig 4 shows the observed streamflow record precipitation pr snowfall s relative humidity rh minimum air temperature tmin and maximum air temperature tmax are obtained from station 07cd001 and t089r09w4 the coordinates of station 07cd001 are longitude 111 2554 and latitude 56 68528 it is observed that high flows often take place in spring this is particularly due to melting snow and seasonal rainfalls in contrast low flows take place in winter which is expected as precipitation takes the form of snow another observation is that extreme rainfall produce floods in summer the data shows a maximum daily flow of 790 m3 s recorded on april 30 1974 as well as a minimum of 26 2 m3 s recorded on february 19 1982 table 1 presents the descriptive statistics of the study variables in hydrological events the climatological variables may affect the streamflow with time delay to illustrate this in the present case studies the correlation coefficients between each of the available variables and the streamflow at different lags were calculated as well as the streamflow autocorrelation in this work we are interested in forecasting the one step ahead of three different flow resolutions three days ahead with a resolution of three day mean q 3 3 six days ahead with a resolution of three day mean q 6 3 and fourteen days ahead with a resolution of seven day mean q 14 7 are considered to identify the optimal set of predictors to forecast the streamflow cross correlation auto correlation and partial correlation analyses are applied given that in hydrological processes the climatological variables may affect the streamflow with time delay cross correlation is applied considering different lags as follows i cross correlation between the streamflow and all available predictors at different delay steps and auto correlation is applied ii the predictor with the highest correlation coefficient is considered the best predictor and is included in the optimal set of variables scaled to the considered temporal resolution iii partial correlation is then applied between the streamflow and the remaining variables the best predictor is included in the optimal set of predictors iv based on partial correlation results the second best predictor can be identified as the variable with the highest partial correlation coefficient v the partial correlation is again applied with the variables that showed significant partial correlation coefficient given the two most important predictors included and so forth in table 2 the correlation coefficients between streamflow and different possible predictors at lag time from zero to 10 days are shown the correlation coefficients shown in table 2 are all significant at 95 confidence level results of correlation analysis between the precipitation and streamflow showed an increasing pattern from lag 0 0 0894 to lag 7 0 1766 which indicates that rainwater from different places within the catchment may take around seven days to reach the main stream similarly the minimum air temperature at lag 3 tmin t 3 shows the best correlation coefficient for the tmin thus according to the cross correlation and auto correlation analyses to forecast the streamflow for any lead time q 3 3 q 6 3 and q 14 7 partial correlation analysis is then applied between the streamflow and the remaining predictors table 3 presents the results of the partial correlation analysis also table 3 shows that the st and tmax t are not significantly correlated while tmin t 3 pt 7 and rht are significantly correlated where pt 7 shows the highest partial correlation coefficient 0 266 results of the partial correlation analysis between streamflow and each of the t min t 3 and rht given that qt and pt 7 are included are given in table 3 which shows that both the t min t 3 and rht can be excluded thus for forecasting q 3 3 q 6 3 and q 14 7 the optimal set of predictors is scaled based on the one day resolution results 3 2 data preprocessing parameter tuning and evaluation criteria preprocessing is a critical stage in this work as the matching strategy optimization approach and estimation of system matrices depend on the variables considered in this work linear transformation is used for all the variables so that a 0 1 domain is observed using the following relation 15 v t v v max v max v min where v t is the linear transformation of variable v v max and v min are the maximum and minimum observed values of the variable v t respectively furthermore because the mean of different days ahead will be utilized it is important to note that moving average is not used to produce the dataset for each of the considered temporal resolutions in order not to bias the results hence the final dataset will have a size equal to the available number of days between january 1 1970 and december 31 2012 divided by the temporal resolution if the division yields a reminder the first days in the dataset is excluded from the study once the dataset is preprocessed and arranged in the proper format for the modeling stage a training set and a testing set should be used in this work we utilize a jackknife cross validation strategy where all the available observations in the processed dataset act as a target observation one at a time this allows us to mitigate the effect of data availability on the performance of the proposed modeling approach since we consider ensemble learning and bias correcting stage in this work every time the target point is excluded from the training set the latter is then used to create the subsets via bootstrap resampling and each of the obtained subsets will be divided into a validation set and a testing set the validation set will be used in the optimization problem to estimate the system matrices and the testing set will be used to tune the bias correcting regression model moreover all ensembles will have a size 10 and will not require a separate validation set for the integration stage since bagging ensembles uses the mean statistic it is important to note that the pre analysis of the case studies showed that the optimal number of states is three this is expected since river flow is a one dimensional system to this extent the pearson correlation used in the matching and data selection strategies from the available dataset with the target observation will be utilized on a three previous observation string of the streamflow comprising the variables in ds fig 5 shows a snapshot of the discussed procedure for one target observation whose training set is resampled and a subset is selected finally the evaluation criteria used in this study are the root mean square error rmse median absolute deviation mad relative root mean square error rrmse and relative median absolute deviation rmad used as measures of model performance and generalization ability over different ensemble parameter values i e mixture ratios the rmad and rrmse measures are obtained by normalizing the error magnitude of each point by its own magnitude performance criteria are defined as follows 16 rmse t d 1 l i 1 l q t d i q t d i 2 17 rrmse t d 100 1 l i 1 l q t d i q t d i q t d i 2 18 mad t d m e d i a n q t d i q t d i 19 rmad t d 100 m e d i a n q t d i q t d i q t d i where q t d i is the ith observation of the d day mean streamflow d 3 7 14 q t d i is the final estimate of q t d i after passing through the ensemble model and bias correcting model and l is the number of observations the use of the above criteria is motivated due to the different information each measurement provides rmse and mad criteria are typical performance measurements in addition rrmse and rmad complement the latter as they provide information of the models performance distribution low rrmse and rmad values indicate that the target variable s lower observations have relatively low prediction errors which is obviously the preferred target in contrast if these measures are found high they indicate that the low and high target variable s observations are poorly predicted hosking and wallis 1993 hence using the four error measurement criteria is important moreover the use of the median statistic rather than the bias error criterion is motivated due to the scaling problem in streamflow records 4 results and discussion the proposed ensemble integrated framework is demonstrated on the considered case studies and compared against a linear regression as described in the design section for each one of the three extended short term forecasting problems the models are created and trained the optimum model results are evaluated via jackknife simulation over the different forecasting problems as stated earlier varying the number of states considered for the system identification part of the varying parameter model may provide different optimum configuration results every time a validation study is carried out hence the ensemble of these models is expected to alleviate this validation issue in this study the number of considered varying states is limited to three moreover the use of linear regression as a benchmark is facilitated due to previous work which shows that it is the best among other more complex models such as artificial neural networks support vector machines and decision trees predicting streamflow using input output model first level at extended horizons will produce inferior forecasts especially on events with relatively higher streamflow values whether it is a linear model or a complex model the proposed method incorporates the system s recurrence information second level in the modeling framework assuming cyclic behavior which allows for improved capture of events on an extended horizon in addition table 4 shows the results of the expected performance of perfect state matching for each forecasting problem fig 6 presents the expected scatter of forecasted streamflow values with respect to their observed values notice that this can be used as an expected maximum of the model performance or training performance from a machine learning perspective the training errors among all performance criteria tend to increase with an increase of the time horizon this result conforms intuition as higher horizons are more challenging to forecast in addition q14 7 forecasts have a mild case of heteroscedastic estimates due to the absence of rainfall data along the two week window of forecasting hence the proposed model should account for this problem and limit the dependence of forecasts on the immediate streamflow observation closest to the forecasted one moreover table 4 shows the results of the optimum model performance for each case study the results agree with the expected behavior as shorter forecasting horizons prompts better results in addition a comparison with the linear regression models performance shows a significant improvement undertaken by the proposed model in all performance criteria comparing the training error with the testing error tables 4 and 5 we can also observe additional insights on the proposed optimization framework the use of dummy variables allows us to utilize a superposition of unseen optimal solutions to the state estimates embedded on the latter s effect on the transition matrix hence a significant improvement in the testing results is provided in other words if such effect is not utilized the optimization problem will converge to an attempt of pure fitting of the state estimates to the real ones coming from prior construction of matrix c k and its corresponding states x k the fact that the proposed model produces improved forecasting performance emphasizes on the requirement to include structural recurrences in the modeling problem of extended short term forecasting the state space formulation of the proposed model enables the capture of predefined recurrences in the river flow and pursues a dynamic integration of their recurrences to produce a useful super positioning of the available outputs this integration identity is also similar to the third stage in the ensemble learning framework which is ensemble integration furthermore the application of the proposed model can be done continuously so that the forecasts can be generated per the chosen temporal resolution unlike those in mid term and long term forecasting the authors created unique observations from the available streamflow history without a moving average usually used to generate as much observations as possible the generation of unique observations is used in this work in order to ensure unbiased performance results affected by the moving average which generates significant similarity between consecutive training observations in the same time the generation of unique observation yields gaps in the time series which would be compensated by executing the proposed model on different time series generated sequentially to provide a continuous forecasting in fig 7 the jackknife results are presented for the proposed model and linear regression model performed for each case study the figure shows the jackknife estimates with respect to observed streamflow values all proposed models provided the best forecasting performance along the space of the observed values lower streamflow values are more accurately forecasted and high streamflow events have been properly captured in many occasions more importantly the relatively moderate streamflow observations usually occurring in the beginning of the spring and end of fall are more adequately forecasted this forecasting behavior shows the ability of the proposed model to utilize most of the available information during such transient flow seasons which are also indicators to possible high streamflow events if properly forecasted the linear regression scatter plots show the challenge in forecasting these events apparent in the mid space of the target observations to provide an insight on the stability of the obtained performances from the proposed models a monte carlo simulation is carried out on the available error measurement criteria the proposed models produce stable forecasts far more superior to the linear regression models this trend is a result from utilizing the ensemble learning strategy bagging as well as the final bias correcting model more importantly even in seasons of high streamflow where the performance of all models is lowest the proposed framework produces stable forecasting performance with tighter error bounds this is also due to the added benefit of ensemble learning stage which superimposes diverse hidden optimal solutions of the results from the previous subspace model 5 conclusions in this work a varying parameter method utilizing an ensemble of a system identification approach to forecast streamflow was proposed for extended short term streamflow forecasting the main contributions of the proposed method comprised of the introduction of system identification based varying parameter modeling to hydrology and water resource management development of a subspace formulation unique to the pure and applied literature utilization of a simple and novel time varying state representation and integration of ensemble learning in the proposed method moreover the use of dummy variable optimization for extraction of a superposition of hidden optimal solutions was considered this work is expected to bring more attention toward the use of system identification and machine learning techniques in hydrology and water resource management future work will consider investigating a robust state extraction approach that does not limit the formulation to predefined states coming from the derived lti models in addition a clustering approach could be developed in order to facilitate better representation of the state transition matrix and new ensemble models should be utilized for further improvement of the forecasting strategy because of the observed heteroscedastic nature of the forecasts in the long horizon case study more attention must be paid to the transformation of the available features which is expected to play a major role in alleviating this problem varying parameter models rely heavily on the available data and model constraints hence another potential improvement is expected when developing a new testing strategy which can provide more insights on the suitability of the utilized modeling framework in comparison with other candidate approaches the proposed approach can also be investigated in terms of pure ensemble learning where the subspace identification stage will rely on nonlinear systems represented by for example artificial neural networks authorship contribution statement mohammad h alobaidi conceptualization methodology software data curation writing original draft mohamed a meguid writing review editing supervision fateh chebana conceptualization writing review editing supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper 
5811,the evolution of the water table in the cuenca alta del río laja aquifer carl aquifer was investigated using empirical bayesian kriging ebk utilizing arcgis and the curve fit tool developed by the united states geological survey usgs we created a new methodology to identify areas of the aquifer that can host unregistered wells or users that overdraft the permitted extraction volume and forecast water table change based on historical annual water levels short term climate variability specifically the el niño and la niña phenomena had an indirect influence on groundwater availability driven by less or more groundwater demand for irrigation respectively la niña phenomena 2011 2012 caused severe drought driving a mean water table velocity wtv of 1 57 m year drawdown this contrasted to a wet el niño period 2014 2015 driving a mean wtv of 1 12 m year recovery across the period 2008 2015 the wtv and water table acceleration maps revealed mean values of 0 43 m year and 0 93 m year2 respectively these numbers suggest that the problem of dewatering of the carl aquifer continued but that the rate of drawdown has slowed if the observed drawdown rate continues by the year 2035 45 of the surface area of the carl aquifer will have a water table greater than 120 m below surface 24 of the area will exceed 150 m and 5 of the area will exceed 180 m whereas deeper water tables increase the cost of lifting water to the surface there is also a risk of worsening groundwater quality as deeper parts of the aquifer are sourced furthermore the demand for irrigation is likely to increase under the most likely near term climate change scenarios published by the intergovernmental panel on climate change a 5 10 reduction in rainfall is predicted by 2040 given these potential negative future consequences of over exploiting aquifers this original approach will help water managers make more informed decisions for the development of groundwater resources keywords water table acceleration changes in aquifer storage forecasting water table change groundwater management empirical bayesian kriging 1 introduction in the last 70 years an increasing number of private and public groundwater pumping wells in the state of guanajuato led to groundwater being over exploited foster et al 2004 wester et al 2009 pressures from the growing agricultural activity and population contributed to a permanent decline of groundwater storage a deterioration in groundwater quality a progressive decrease in base flow to rivers changes in groundwater flow patterns subsidence and substantial increases in the cost of groundwater extraction chaussard et al 2014 hoogesteger and wester 2017 mahlknecht et al 2006 navarro de león et al 2005 ortega guerrero 2009 semarnat 2013 to address these impacts different strategies have been implemented by the federal government to reduce groundwater abstractions but unfortunately the water table continues to decline unabated hoogesteger 2017 hoogesteger and wester 2017 scott and shah 2004 wester et al 2009 the unsustainable groundwater development in the cuenca alta río laja catchment hereinafter referred to as the carl catchment however could have been exacerbated by the methodology implemented by the federal government authority conagua that over estimates average annual groundwater availability for extraction 1 1 groundwater availability issue groundwater availability should not be confused with the total volume of water stored in an aquifer because it is unrealistic and undesirable for all water stored in the aquifers to be removed by pumping the concept of availability is defined as the volume of water that is available for different uses while still avoiding undesirable impacts on ecosystems the availability of groundwater as a supply is a function of different factors like water law regulations economics infrastructure climate quality and quantity of water anderson and woosley 2005 barlow 2002 faunt 2009 nevertheless the evaluation of groundwater availability based on the renewable fluxes could be questionable for some aquifers because the groundwater resilience and overall volume of groundwater stored groundwater resilience is the ability of the system to dynamically increase recharge and decrease base flow to rivers termed capture taylor 2009 zhou 2009 some authors define groundwater availability as the total volume of groundwater storage recoverable because this includes the concepts of resiliency and the capacity of the aquifer system to continue providing a long term water supply when storage is large buffer capacity richey et al 2015 taylor 2009 however even in resilient systems with high buffering capacity the negative impacts of pumping include 1 limiting the recoverable groundwater in storage through subsidence which decreases porosity and therefore aquifer storativity 2 streamflow depletion 3 increased pumping costs and 4 declining water quality alley 2007 therefore groundwater availability defined this way will still incur negative effects that need to be considered in long term management plans of this resource conagua performs a periodic water budget nom 011 conagua 2015 to determine groundwater availability for extraction in all the 653 aquifers in mexico the conagua methodology considers the natural recharge plus capture induced recharge as inputs to the aquifer the outputs are groundwater extraction and the natural groundwater discharge allocated for environmental purposes in the carl catchment and many aquifers throughout central mexico natural discharge is unfortunately zero since falling water tables have disconnected rivers from year round baseflow navarro de león et al 2005 sophocleous 2002 thus in practice groundwater development of the carl catchment is more closely related to groundwater mining since pumping greatly exceeds any definition of groundwater availability 1 2 contradictory policies exacerbate perceptions of groundwater availability in the state of guanajuato the vedas i e bans of new wells have been applied by conagua since 1952 conagua 2010 unfortunately these well drilling prohibitions have not been effective since no capacity for enforcement exists foster et al 2004 great subsidies for electricity consumption have been given to the agricultural sector these subsidies cover on average 86 of the cost of day time consumption and 92 of the cost of night time consumption compared to domestic tariffs cfe 2017 furthermore federal government programs for modernizing irrigation like sprinkler or drip irrigation are inaccessible by the ejido sector hoogesteger 2017 ejidos are parcels of land that belong to the federal government but are allocated to families provided they continue to farm them although they are often inefficient compared to larger farms run by big businesses in the late 1990s conagua and the guanajuato state water commission ceag comisión estatal del agua de guanajuato promoted self regulation of groundwater use through the creation of technical water councils cotas consejos técnicos de aguas these cotas are auxiliary organizations according to water law they have no legal mandate and they depend economically on ceag and conagua one of the cotas primary objectives are to stop falling water tables to date is clear that cotas cannot achieve these objectives and with current water policies neither can state and federal water administrators stabilize water tables with legal power without the cotas foster et al 2004 hoogesteger and wester 2017 wester et al 2009 wester et al 2011 1 3 relevance and pertinence of this research understanding the various causes for changes in decline rates on water tables and calculating annual availability of groundwater is an urgent issue in the state of guanajuato coclima 2011 the evaluation and modelling of changing groundwater resources is fundamental for their management and for planning regional economic activity the evolution of the water table of guanajuatós aquifers is updated annually by ceag whereas various physically based deterministic mathematic models have been used to simulate the aquifers in the state of guanajuato foster et al 2004 navarro de león 2006 sandoval 2004 the most significant effort was made by ceag during the period 1998 2006 with the aquifer model development program serra et al 2005 nevertheless a correct model calibration in the carl catchment was not possible owing to various sources of error in the input data and lack of information about the subsurface geology natural recharge and groundwater extractions chavez et al 2005 despite these limitations the ceag cotas groundwater monitoring network continues to measure the depth to the water table and the water level data is quite complete in terms of coverage in time and space past studies performed on the carl catchment have estimated groundwater recharge residence time and groundwater flow pathways based on water isotopes and other natural tracers mahlknecht et al 2006 mahlknecht et al 2004 other studies have specifically addressed groundwater quality seeking to understand the principal origins of arsenic as and fluoride f knappett et al 2018 knappett et al 2019 ortega guerrero 2009 the present and future distribution in groundwater quality is important since inadequate quality water effectively limits groundwater availability for use as drinking and irrigation water concentrations of geogenic as and f concentrations are dependent on pumping rates and declining groundwater tables in the carl catchment knappett et al 2018 knappett et al 2019 analysing the explicit response in groundwater quality to pumping is however beyond the scope of the present study the lack of reliable information on the physical properties and fluxes to and from the aquifer system motivated us to develop a new approach to managing groundwater by quantifying the evolution of groundwater storage over time and space using only water table information the proposed methodology includes the use of geostatistical geospatial and time series tools maps were generated to 1 forecast the water table velocity wtv in the short 10 years and medium term 10 20 years 2 assess annual change in storage without relying on estimates of groundwater extractions evapotranspiration et or natural recharge 3 classify wtv and water table acceleration maps to detect areas with possible over pumping or the placement of unregistered wells and 4 generate maps forecasting the time to reach economically unfeasible water table depths new approaches that utilize the latest geospatial mapping and statistical tools to quantify the behaviour of aquifers for which minimal information is available are critically important today this is because the physical properties of most of the world s aquifers that are used to grow food and provide drinking water for the world s rapidly growing population are poorly studied especially in latin america africa and south asia villholth et al 2018 2 materials and methods the analysis of the water table levels measured across the monitoring network using geostatistical models was performed to evaluate their inter annual variation and the evolution of water storage in an aquifer first a water table surface was generated with the empirical bayesian kriging ebk method by interpolating the measured water table levels across the monitoring network next the area of analysis was delineated using prediction error maps of the ebk model and the geology and the administrative limits aquifer known as cuenca alta del río laja aquifer hereinafter carl aquifer next the change in storage was evaluated and water table acceleration maps were calculated by stacking successive annual water table velocity maps finally the curve fit tool a tool developed by usgs for arcmap of esri was applied to fit a linear model the results were used to forecast the future evolution of water table and estimated the time to reach critical depths to water table that may be economically important for agricultural groundwater users 2 1 study area and data sets the carl catchment fig 1 has an area of approximately 7000 km2 it is divided into four administrative zones the previously mentioned carl aquifer the laguna seca aquifer the dr mora san jose iturbide aquifer and the san miguel de allende aquifer see fig 1 these aquifers are hydraulically dependent as evidenced by similar water table elevations dividing any two administrative boundaries data not shown the laja river and its tributaries are the principal channels draining surface water at the bottom of the carl catchment water exits the basin through the ignacio allende ia dam this dam is mainly used for irrigation and flow control for the lowlands of the state of guanajuato bajio the ia dam was built in 1968 with an initial storage capacity of 251 mm3 106 cubic meters prior to 1971 the laja river was a perennial river the la begoña gauging station located where the ia dam is located today registered a minimum base flow of approximately 1 m3 s up until the dam s construction in 1968 after this the laja river gradually became an intermittently flowing river caused by excessive groundwater pumping semarnat 2013 this reduction in surface flow primarily impacted the irrigation district 085 la begoña that is downstream of ia dam the carl aquifer has an area of approximately 4130 km2 and is in the northern portion of the state of guanajuato in central mexico the analysed area shown in fig 1 has a surface area of 1965 km2 see the area represented by a black dotted line and is located within the limits of the carl aquifer yellow dashed lines the climate is semi arid with an average annual precipitation 400 mm in the plains and 800 mm in mountain areas the rainy season starts in may and ends in october typical mean monthly rainfall during the wet season range from 35 to 86 mm month in the dry season however mean monthly rainfall typically ranges from 8 to 18 mm month the mean annual temperature is 17 c the period from april to june is the hottest months with mean monthly temperatures ranging from 18 c to 22 c whereas the coldest months are december to february with mean monthly temperatures ranging from 11 c to 15 c conagua 2017 mahlknecht et al 2006 the carl aquifer is pumped primarily for municipal and irrigation use eighty five percent of groundwater pumped is used for agriculture followed by 11 7 for municipal use the actual volumes for 2017 are listed in table 1 the groundwater monitoring network of the carl aquifer is comprised of 61 wells the depth to water table in each of the wells was measured at the end of both the dry and rainy this information was provided by ceag for the years 2008 2015 conagua periodically evaluates groundwater availability for extraction the last publication semarnat 2018 concluded there was a deficit in the carl aquifer of 62 1 mm3 year as a result of this last publication the construction of new pumping wells has been prohibited by law an exception is made for deepening or replacing wells that run dry in practice however conagua has little control over the drilling of illegal wells the geology of the basin is comprised of volcanic sedimentary rocks mahlknecht et al 2004 ortega guerrero 2009 fig 2 there are few publicly available borehole lithologies within the basin but the limited information suggests that within carl catchment two main aquifers overlay one another the upper aquifer is comprised of poorly consolidated sedimentary deposits with clasts ranging from silt to boulder sized these layers are inter bedded with volcanic tuffs underlying the upper sedimentary aquifer is a fractured ignimbrite aquifer of mainly rhyolitic origin fig 3 the upper and lower aquifers are considered hydraulically connected since the hydraulic heads of wells screened in both aquifers are similar and the hydraulic conductivities of each aquifer are within an order of magnitude the upper aquifer however is more conductive ortega guerrero 2009 2 2 data analysis 2 2 1 exploratory data analysis descriptive statistics that includes the mean minimum maximum standard deviation sd and coefficient of variation cv were utilized to summarize observed water levels in wells of the water table monitoring network to evaluate normality and stationarity the statistical distribution of water levels for each year was evaluated using the skewness kurtosis and normality test that included the jarque bera j b and shapiro wilks s w methods box plot diagrams and variogram cloud graphs were created to analyse possible outliers the variogram cloud graphs were generated to detect local outliers where pairs of observations with variances greatly differing from the rest are considered as atypical in their spatial correlation 2 2 2 geostatistical analysis generally geostatistical models perform better overall than the deterministic spatial interpolation models to predict spatial temporal variation of groundwater levels adhikary and dash 2017 kresic and mikszewski 2012 sun et al 2009 varouchakis and hristopulos 2013b geostatistical methods are commonly applied to water table elevations to 1 reveal the spatial and temporal structure of water table fluctuations ahmadi and sedghamiz 2007 chen and feng 2013 2 detect critical regions where correction is needed to achieve more sustainable groundwater use el fadel et al 2014 thomas and famiglietti 2015 3 estimate the water table decline and fluctuations with low uncertainty in both space and time scales sun et al 2009 ta any et al 2009 4 optimally contour the water table to achieve effective management and monitoring decisions ahmadi and sedghamiz 2007 béjar pizarro et al 2017 kumar 2007 varouchakis and hristopulos 2013a and 5 generate vulnerability maps for environmental planning and decision making using index methods coupled with gis based spatial analysis as an alternative to more costly methodologies el fadel et al 2014 varouchakis and hristopulos 2013b finally it should be stated that there is some concern that the popularity of geostatistical methods could lead to frequent misuse and hence to errors in the estimation process kresic and mikszewski 2012 2 2 2 1 empirical bayesian kriging krivoruchko and gribov krivoruchko and gribov 2014 krivoruchko and gribov 2019 improved upon the classical geostatistical kriging methods coded within the esri software package which use only one variogram by introducing empirical bayesian kriging ebk the fundamental advance was that classical kriging methods estimate a variogram that is considered the true variogram of the observed data but does not explicitly consider uncertainty by not taking this uncertainty into account classical methods underestimate the standard errors of predictions basu 2016 in contrast ebk creates and spectrum of variograms this process accounts for the error introduced by estimating a variogram model in the first place additional advantages of ebk over classical kriging models are krivoruchko 2012 krivoruchko and gribov 2014 krivoruchko and gribov 2019 1 it permits moderate local and large non stationarity in the data 2 it allows for varying measurement errors 3 if needed the method can transform the data to conform to a spatial gaussian distribution locally with a normal score process 4 in the case of a large datasets the input data can be divided into subsets of specified size that may or may not overlap and 5 in each subset the distribution of the different possible variograms is produced and prediction is generated from variograms of each subset there are some disadvantages of ebk compared to classical kriging models 1 the variogram parameters in ebk are estimated using restricted maximum likelihood that creates limitations for large datasets basu 2016 2 processing is slower than other kriging methods especially when the results are output in a raster format and 3 cokriging and anisotropic corrections are unavailable esri 2016 some applications where ebk performs better than classical geostatistical methods are described in gupta et al 2017 wherein ebk was used to characterize rainfall variability in arid and semi arid regions and mirzaei and sakizadeh 2016 wherein ebk was used to characterize the spatial temporal distribution of groundwater contamination the comparison of performance between classical geostatistical methods deterministic interpolation methods and ebk is beyond the scope of this study 2 2 2 2 assessing the variability of predictions cross validation is a process implemented by arcgis to compare the predicted values to the observed values using the following statistics 1 me 1 n i 1 n y i x i 2 rmse 1 n i 1 n y i x i 2 3 ase 1 n i 1 n σ 2 y i 4 mse 1 n i 1 n y i x i σ y i 5 rmsse 1 n i 1 n y i x i σ y i 2 where me is the mean error rmse is the root mean square error ase is the average standard error mse is the mean standardized error and rmsse is the root mean square standardized error in these equations y i is the simulated value x i is the observed value and σ is the standard deviation cross validation extracts each observation one by one and predicts them with the remaining information every data point extracted is restored once it is predicted to continue with the next point it is important to correctly assess the variability of predictions a summary of some rules to check are listed in table 2 kresic and mikszewski 2012 an accurate model should reasonably comply with the conditions indicated in table 2 furthermore the rules showed in the table can help to identify if the predictions are overestimated or underestimated 2 2 2 3 comparing distributions comparing distributions of measured and predicted water levels in wells help us to confirm if there is a significant difference or not we used the parametric paired t test which assumes that differences between pairs are normally distributed additionally we used the non parametric two sample kolmogorov smirnov test is important to confirm that there is no bias between measured and predicted to satisfy the assumptions of the curve fit tool 2 2 3 curve fit tool curve fit is a pixel level raster regression tool for mapping spatial patterns developed by de jager and fox 2013 this tool was developed as an extension of arcgis by using this tool it is possible to execute a linear or non linear regression analysis for a raster dataset that represents the temporal evolution of the water table elevation the temporal evolution is represented by a unique mathematical model for each pixel located at the same spot across different raster datasets fig 4 the results of the fitted model create a new raster for each variable of the mathematical model the supported models include polynomial power exponential four parameters logistic and the linear model represented by eq 6 6 linear y a x b where a and b are parameters in raster format wherein pixels store the best fit parameter value in the linear model to the observed values x represents time years and y represents the simulated water table the curve fit tool outputs 1 model fit 2 residual errors 3 p value 4 multi model inference statistics aic akaike information criterion or bic bayesian information criterion 5 parameter value estimates 6 standard errors se and 7 t statistics 2 2 4 area of analysis delineation the administrative area of the carl aquifer see yellow dashed lines in the fig 1 defined by conagua includes mountainous areas and geology that are not suitable for the analysis of evolution through geostatistical methods since the abrupt topography and sharp lateral changes in rock type drive abrupt lateral changes in the water table in addition the monitoring network itself only covers an area underlain by the sedimentary deposits of quaternary age forming the upper carl aquifer and the network is not equally distributed across this surface area this is also the part of the basin that is most actively farmed and pumped for irrigation so it is relevant to focus the study here therefore the area of analysis see the area bounded by black dotted line in fig 1 was defined considering the following 1 avoiding areas with large uncertainties 2 the administrative boundary of carl aquifer and 3 the surface geology the area of analysis coincided with the outcrop area of the quaternary sedimentary deposits fig 2 2 2 5 evaluation of water table velocity and water table acceleration the prediction of water levels in wells with ebk generated water table maps across the study area for each study year 2008 2015 furthermore annual wtv maps were created by considering the difference between water table maps from consecutive years water table velocity maps are commonly used to define the variation of the water table in time dh dt and have units of m year if the storage coefficient of the unconfined aquifer is known in this case this is s specific yield the annual net change in aquifer storage can be calculated which is the volume of additional or missing water thus although the individual components of the water budget are not assumed the change in storage which is often the purpose of calculating a water budget can be calculated water table acceleration wta maps were evaluated as the difference in rates of wtv over time d 2 h dt 2 this provides novel information that is highly relevant for managing the aquifer these wta maps allow identification of changing groundwater extraction intensities that are not visible in the annual wtv maps furthermore from wtv and wta classification maps fig 14 one can establish areas of interest for future research to address possible relationships with water quality exploitation intensity or subsidence the average acceleration over a period of years serves as a baseline to define whether there is a year to year acceleration or deceleration in recovery or drawdown 2 2 6 case classification of water table velocity and water table acceleration there are four different cases with respect to wtv and wta explained in fig 5 accelerating recovery case 1 has positive velocity and acceleration in contrast decelerating recovery case 2 has positive velocity but negative acceleration deceleration in contrast under the more typical case for the carl aquifer of negative velocity decline in the water table a positive acceleration case 3 represents a slowing of the rate of drawdown in contrast a negative velocity with a negative acceleration case 4 represents accelerating drawdown in an over exploited aquifer system with a deep water table these four cases can be ranked from best case 1 to worst case 4 scenarios for the purposes of visualizing which parts of the basin are experiencing best or worst case conditions in its water table the four cases were given numerical values ranging from 1 to 4 2 2 7 groundwater budget evaluation the technical studies published by conagua semarnat 2009 semarnat 2013 semarnat 2015 reported the average annual groundwater availability in the carl aquifer for the following dates see table 3 september 30 2008 march 31 2013 june 30 2014 and december 31 2015 the methodology implemented by conagua to evaluate annual average groundwater availability agwa follows the official mexican standard nom 011 conagua 2000 updated by the nom 011 conagua 2015 this method calculates a water budget using an annual average total recharge which includes natural and captured recharge the natural discharge committed and the volume of annually extracted groundwater eq 7 7 agwa average annual total recharge annual natural discharge committed annual ground water extraction the groundwater availability values published by conagua for the carl aquifer reported an average total recharge of 139 7 mm3 106 cubic meters per year that was estimated by conagua in 1971 1981 and 1982 semarnat 2015 unfortunately in the more recently published agwa values the natural discharge committed in the carl aquifer was assumed to be zero by conagua this means that eq 7 without the natural discharge committed stipulates that availability exists only when groundwater extractions are less than or equal to total recharge natural recharge plus capture unfortunately extractions in the carl aquifer have historically exceeded the total recharge groundwater mining and their negative effects are well known sophocleous 2000 zhou 2009 the lack of reliable information needed to close the water budget means that other options should be considered in this particular situation a change in storage δs made with water table velocity maps dh dt the average aquifer storage coefficient s specific yield and the area covered by the analysis a could be more useful than eq 7 to evaluate changes in stored groundwater the proposed equation is shown in eq 8 8 δ s s y a 1 n n 1 n dh dt where n is the number of pixels of the drawdown velocity map in the analysis area enough information on sy does not exist with spatial variability for the carl aquifer therefore a mean value of 0 04 for the coefficient sy is used conagua 2002 to compare the calculated annual change in storage with that published by conagua 2 2 8 time to reach a critical water table depth the time to reach a critical water table depth can be calculated with eq 6 by changing the prediction variable y to the critical depth and solving for the time variable because all the variables from eq 9 are raster format the variable y from eq 6 is evaluated with the digital elevation model dem inegi 2018 minus the critical depth and the resulting equation is shown in eq 9 where x is the time variable in raster format 9 x dem critical depth b a the critical depth values used for the analysis were 120 150 and 180 m foster et al 2004 concluded that farming using water from guanajuato s aquifers agricultural crops and irrigation techniques would be uneconomical when the depth to water table approached 120 m today however part of the farming regime changed hoogesteger 2017 since 2004 and according to unofficially information from some stakeholders and ceag staff the economically unfeasible limitation of water table depth will be between 180 and 200 m in part due to government electricity subsidies up to 92 compared with domestic tariffs nevertheless the ejido sector with less access to technical improvements in irrigation hoogesteger 2017 suffers more expenses associated with accessing the lower water table depths e g less than 150 m 3 results and discussion 3 1 descriptive statistics of the water level dataset descriptive statistics of each year of water levels measured in 61 wells that comprise the groundwater monitoring network provide an initial assessment of the normality of the distribution of annual water table levels and inter annual stationarity of the distributions between years the distribution of observed water table levels had a kurtosis that decreased throughout the study period table 4 between 2008 and 2015 kurtosis decreased from 4 1 to 3 2 the kurtosis gradually tended towards a normal distribution but with a positively skewed distribution the normality test shows that the distribution approached gaussian j b p 0 05 over time this is likely because the cones of depression became deeper and wider compared to the more focussed drawdown from spatially clustered agricultural activity other processes besides agricultural activity may explain this phenomenon however such as delayed mountain front recharge and the indirect effect of rainfall variability with short term climate phenomena such as el niño and la niña water tables have a non stationary pattern that can be partially explained by climate variability holman et al 2011 and interactions with pumping for irrigation demand in the present dataset non stationarity is indicated by inter annual variability of the mean the standard deviation and indicators of kurtosis and skewness table 4 a rapid decline in the mean water table occurred between the years of 2011 and 2012 during this period the la niña phenomenon drove severe drought conditions during the normally wet season conagua 2012 this intensified a drop in the water table owing to increased groundwater extraction to meet irrigation demand in contrast during the el niño year 2014 2015 when abundant rainfall occurred even during the normally dry season conagua 2015 a rapid recovery of the aquifer was observed owing to less irrigation demand thus climate phenomena interact with groundwater pumping for irrigation and drive inter annual changes in observed water levels 3 2 outlier analysis an outlier analysis was performed with boxplots fig 6 and variogram cloud graphs fig 7 the well id of these possible outliers is shown in the fig 1 not all possible outliers are actual outliers the box plot diagram fig 6 identified wells with higher topographic elevation than others as possible outliers outliers were confirmed with the residual errors of the ebk model and their relevance in the groundwater budget uncertainty see section 3 4 only wells id 1 and 2 were excluded as outliers in the geostatistical analysis 3 3 geostatistical model and interpolation maps the ebk model was used to interpolate the water table level in 59 pumping wells 2 wells excluded as outliers during the period of 2008 to 2015 the ebk parameter configuration was calibrated for the year 2008 and it was maintained for all the years of analysis to assess model accuracy and bias relative to observed water levels each year cross validation was performed table 5 to determine the best fitting theoretical ebk model the ebk modelling approach is well suited to moderately non gaussian data the theoretical model was k bessel the transformation was set to empirical and the number of iterations was set to 100 the overlap factor used was 1 and the subset size was 50 the search neighbourhood parameter was set to smooth circular with a smoothing factor of 0 85 and search radius of 14 5 km different errors from cross validation were analysed with the rules shown in table 2 to assess the variability of predictions and evaluate the performance under or over estimation of the ebk model the interpolation errors summarized in table 5 suggest that ebk model performed correctly and avoided important under or overestimation this is evidenced by me and mse values that are close to zero convergent rmse and ase values and rmsse values near unity table 2 a visual fit of the empirical semivariances blue crosses to the semivariogram spectrum generated by the ebk model is shown in fig 8 the interpolated versus observed water levels are shown in fig 9 for the years 2008 2015 the distribution of interpolation errors is analysed in fig 10 with normal q q plots the best fit line through the interpolated versus observed water levels had a slope close to 1 and the interpolation errors were normally distributed p 0 05 these findings confirm the lack of systematic bias in the ebk model table 6 summarizes normality tests statistics to confirm there was no statistically significant difference between predicted and observed water levels and use in good conditions the curve fit tool the interpolation maps generated with ebk for the water table during the period of 2008 2015 are depicted in fig 11 fig 12 shows maps of standard errors of interpolation 3 4 evolution of change in storage 2008 2015 the impact of including or excluding various outliers on the calculation of the annual change in storage and its uncertainty is shown in fig 13 from fig 13 we confirmed wells id 1 and 2 as outliers after removing these two outliers the uncertainty in the change in storage was substantially reduced for the periods 2008 2009 2009 2010 and 2011 2012 the rest of possible outliers identified were not excluded of the analysis because their elimination from the model did not reduce the uncertainty of change in storage estimates the water table interpolation maps were used to evaluate the evolution of wtv the results are shown in fig 14 a with the average velocity for the period 2008 2015 annual mean wtv maps were stacked to evaluate the water table acceleration wta maps for the period 2008 2015 fig 14 b the classification of areas falling into four categorically distinct states of wtv and wta reveals that a large part of the basin is experiencing either decelerating case 3 or accelerating drawdown case 4 fig 5 this argues that the carl aquifer is laterally well connected and has important implications for groundwater managers fig 14 c the storage coefficient used for the water deficit calculations sy 4 is the mean value published by technical studies of conagua in the region which found this value ranged from 1 8 to 6 using single well pumping tests the groundwater budget availability published by conagua can be accessed in the federation official report dof diario oficial de la federación the published values from this report summarized in table 7 see values marked with and compared with the estimated change in storage using the geostatistical method followed in this study water managers should pay close attention to areas with accelerating drawdown case 4 in fig 5 as shown in fig 14 c accelerating drawdown reveals indicates 1 the possible locations of new illegal wells 2 users that overdraft groundwater extraction 3 areas with high density of pumping wells or 4 areas where the water table may be moving across a depth interval of the aquifer that has a decreasing specific yield sy with depth the classification of areas in fig 14 c according to the accelerating or decelerating recovery or drawdown is novel information derived from water table velocity and acceleration maps fig 14 c shows the location of 1260 pumping wells installed within the carl aquifer that are registered in the registro público de derechos de agua repda database public registry of water rights there is a high spatial density of pumping wells in the centre of the catchment which coincides with the largest area that is experiencing accelerating drawdown during the period from 2008 to 2015 the mean wtv was 0 43 m year the mean change in storage volume was 34 1 mm3 year 106 cubic meters per year and the mean wta was 0 19 m year2 therefore although there are important regional differences on average in the carl aquifer and over the 8 years the aquifer is experiencing decelerating drawdown case 3 in fig 5 thus the problem of falling water tables continues but the drawdown is apparently decelerating this however could change rapidly with short term 1 year climate phenomena like the next la niña or el niño the el niño and la niña phenomena have important indirect effects on the availability of water in the carl aquifer during the period from 2011 to 2012 la niña caused severe drought conditions during the normally wet season the indirect effects of this on the water table was evident by the rapid decline of mean water table elevation table 4 and the change in storage was 123 5 mm3 year in contrast during the el niño period from 2014 to 2015 a rapid recovery of observed water levels was measured and the change in storage volume was 87 8 mm3 year the most plausible explanation for this is that less irrigation water was needed during the normally dry season march june because of the abundant rainfall and the delayed mountain front recharge from past events fig 15 and table 8 permit testing this hypothesis fig 15 shows quarterly precipitation each year bars with circles indicating the change in storage volume for each year a relationship is evident between rainfall during the late dry season apr jun and the change in storage volume this relationship was evaluated with a pearson correlation analysis see table 8 which showed the highest correlation r 0 58 between rainfall in apr jun and the change in storage each year compared to rainfall in all other periods 3 5 forecasting analysis the interpolation maps of the period from 2008 to 2015 fig 11 comprised the input for the curve fit tool developed by the usgs as they are statistically representative of measured values see table 8 this tool permits the calculation of the drawdown trend using different models to forecast future water table maps to choose the best model to extrapolate the water table trend the following assumptions were considered in the carl aquifer and catchment the construction of new pumping wells will continue to be banned with exceptions made for repositioning or deepening older pumping wells subsidies for energy consumption will allow the current rates of groundwater development of the aquifer to continue some users will avoid paying for electricity consumption hoogesteger 2017 the drilling of illegal pumping wells will continue in addition the extracted volumes of water by illegal wells is unknown however the changing water table driven by these extractions is known the el niño and la niña periodical climate phenomena conagua 2012 2015 have an indirect influence on the evolution of annual water table in the aquifer table 7 these phenomena have opposite effects see el niño and la niña years in tables 5 and 7 and thus the regular co occurrence of both phenomena over the span of a decade may counteract or reduce their impacts over the short term less than a decade and medium term a couple of decades these assumptions permitted the forecasting of possible future water tables by extrapolating the results from the model of the actual water table trends over the period from 2008 to 2015 the phreatic water table is the final response for all inputs and outputs from the aquifer including the indirect effects of climate variability in this specific application by geostatistical analysing only water table elevation the most appropriate mathematical model to extrapolate the actual trend was found to be eq 6 or the linear model the linear model fitted with the curve fit tool over the period from 2008 to 2015 has a good correlation coefficient r between 0 7 and 0 95 where the cone of depression is located and it accounts for 47 6 of the analysis area a moderate r between 0 5 and 0 7 around cone of depression accounts for 18 6 of the analysis area see fig 16 left meanwhile areas with low correlation coefficient r 0 5 accounts for 33 8 of the analysis area in general areas with low correlation are not valid for forecasting but these areas have minimal impact on the results presented here because these areas tend to have few pumping wells the exception to this is the san miguel de allende sm allende area where there are approximately 12 of carl aquifer pumping wells are located fig 16 right b c d e depicts the forecast water table for different years considering the same trends as the prediction maps over the period from 2008 to 2015 in these forecasting maps the evolution of depression cone below the city of d hidalgo and nearby communities is owing to rapid urban growth this highlights competition between urban centres and farms for potable water since the city is in an intensively farmed area this consumptive activity will gradually reduce the availability of public groundwater supply for d hidalgo and nearby communities 3 6 time to reach economically unsustainable depths to water table the world bank recommendations on groundwater depletion presented by foster et al 2004 predicted that the 120 m depth to water table would be economically unsustainable in the aquifers of guanajuato even considering electrical subsidies unfortunately in 2015 the water table underlying over 35 of the modelled surface area of the carl aquifer already exceeds 120 m in depth fig 17 a and table 9 the critical water table depth 120 m 150 m and 180 m is dependent on the farming regime profit margin of agricultural crops and irrigation techniques hoogesteger 2017 and the energy subsidy policies currently as much as 92 the consequences of growing water table depths will be specific for every farm but some costly and health impacting issues are common to all groundwater users including well deepening burnt out pumps and worsening water quality knappett et al in review if the modelled trends during the period 2008 2015 remain similar over the coming years and decades the percentage of the modelled surface area of the carl aquifer that could exceed 120 m 150 m and 180 m for the year 2035 will be 45 2 24 1 and 5 4 respectively table 9 these forecasts are potential scenarios and obviously the uncertainty grows with the time horizons used owing to different external factors that are impossible to predict nevertheless extrapolations of observed water level trends are commonly used by groundwater managers to assess the likely future conditions of the aquifer recently drilled municipal supply wells in the basin reach 600 m depth knappett et al 2018 the justification for the great depth and expense is that it will allow more time to recover the investment in drilling the well installing very deep wells however raises the risk of consuming toxic concentrations of as and f knappett et al 2019 4 conclusions the water table level evolution in the carl aquifer was evaluated with a new geostatistical method this method only requires annual water level measurements and is especially well suited for situations when the costs of gathering relevant information for other more deterministic solutions is infeasible this study demonstrates this method is a helpful tool for 1 understanding the indirect effects of climate variability in the year to year evolution of aquifer storage 2 supporting decisions in the short term for managing the aquifer by prioritizing inspections for illegal wells or excessive pumping in specific areas and 3 forecasting future scenarios with a linear trend empirical bayesian kriging ebk was implemented to deal with non gaussian moderately non stationary data table 4 an area for analysis was delimited based on an acceptable level of uncertainty in the interpolation maps of water levels nevertheless other kriging models or deterministic spatial interpolation models can be used if their predictions correspond with the conceptual site model and spatial variability of the groundwater level the application of this methodology was limited to the spatial extent and distribution of the groundwater monitoring network outside of this analysis area the prediction errors increased rapidly the uncertainty in the calculated change in storage was sensitive to outliers id 1 and id 2 these were dismissed from the analysis furthermore another source of uncertainty is the average specific yield sy 0 04 value used in the change in storage evaluation unfortunately information about spatial variability of specific yield doesn t exist and only a few values from single well pumping test exist the current method used by conagua however to calculate groundwater budgets also has important sources of uncertainty there are uncertainties in reported total recharge and extractions volumes for example furthermore the method utilized by conagua assumes that total recharge natural recharge plus capture used is constant and unaffected by natural climate phenomena like el niño and la niña during the period 2008 2015 the la niña and el niño phenomena indirectly impacted water table evolution during the period from 2011 to 2012 la niña caused severe drought and over extraction conditions that exacerbated a rapid decline of mean water table level the average wtv that year was 1 6 m year in contrast during the el niño period from 2014 to 2015 a rapid recovery of observed water table 1 1 m year can be explained principally by less irrigation water demand during the dry season because of relatively abundant rainfall new tools are needed for managers to identify accelerating rates of drawdown exacerbated by unregistered wells and users that exceed their permitted groundwater extraction volumes new classification maps of wtv fig 14a and wta fig 14b can be utilized diagnose locations with accelerating rates of drawdown fig 14c which likely indicates increased pumping although the areas with accelerating drawdown velocities could also be the result of diminishing hydraulic conductivity or aquifer storage capacity with depth in the carl aquifer the mean wtv was 0 43 m year the mean change in storage volume was 34 1 mm3 year and the mean wta was 0 19 m year2 these numbers suggest that the problem of drawdown continued but the rate decelerated although these numbers will change rapidly with the next la niña or el niño event if deceleration of drawdown continues in coming years it could suggest that governmental management policies and self regulation ceag cotas finally had a positive effect other policies however only exacerbate the problem such as the electricity subsidization programs nevertheless a deceleration of drawdown does not mean that the problem is over but the situation may be gradually improving forecasting the actual water table trend is an important product of the new method presented in this study falling water tables will reduce human access to the aquifer through domestic and water supply wells users cope with the loss of pump efficiency caused by falling water tables by pumping the well longer up to 24 h a day to get the same daily production volume as before but with greater electricity consumption an economically unfeasible limitation considered by some stakeholders and ceag is the depth to water table between 180 m and 200 m because of the government electricity subsidies up to 92 compared with domestic tariffs and change in the farming regime agricultural crops and irrigation techniques hoogesteger 2017 hoogesteger and wester 2017 however the ejido sector with less access to technical improvements in irrigation hoogesteger 2017 suffers the greatest economic consequences and therefore will have shallower economically feasible water table depths e g less than 150 m by the year 2035 the percentage of the modelled surface area of the carl aquifer that could exceed 120 m 150 m and 180 m will be 45 24 and 5 respectively the actual trend of the falling water tables will have important repercussion for municipal water supply for the growing city of dolores hidalgo and nearby communities as well as the nearly ubiquitous farms throughout the basin our forecast becomes serious when one considers the current subsidy of up to 92 for electricity consumption and the likely impact of climatic change published by the intergovernmental panel on climate change which is considered by governmental policies coclima 2011 a 5 10 reduction in rainfall is predicted for guanajuato by 2040 credit authorship contribution statement yanmei li funding acquisition project administration writing review editing j horacio hernandez conceptualization formal analysis investigation methodology software visualization writing original draft writing review editing manuel aviles data curation software validation visualization peter s k knappett funding acquisition project administration writing review editing john r giardino funding acquisition project administration writing review editing raúl miranda conceptualization visualization maría jesús puy conceptualization supervision francisco padilla investigation jorge morales formal analysis declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements thanks to the comisión estatal de aguas de guanajuato ceag and the consejo técnico de aguas cotas for the access to water table information the interpretation of the results in this study benefited from discussions with prof richard woodward texas a m university funding the investigation work was supported by the universidad de guanajuato grant number 004 2015 1013 2016 and 219 2019 and texas a m university conacyt collaborative research grant program grant number 2014 001 and 2017 034s appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2019 124517 these data include google maps of the most important areas described in this article appendix a supplementary data the following are the supplementary data to this article the following kmz file contain the google maps of the most important areas described in this article map 
5811,the evolution of the water table in the cuenca alta del río laja aquifer carl aquifer was investigated using empirical bayesian kriging ebk utilizing arcgis and the curve fit tool developed by the united states geological survey usgs we created a new methodology to identify areas of the aquifer that can host unregistered wells or users that overdraft the permitted extraction volume and forecast water table change based on historical annual water levels short term climate variability specifically the el niño and la niña phenomena had an indirect influence on groundwater availability driven by less or more groundwater demand for irrigation respectively la niña phenomena 2011 2012 caused severe drought driving a mean water table velocity wtv of 1 57 m year drawdown this contrasted to a wet el niño period 2014 2015 driving a mean wtv of 1 12 m year recovery across the period 2008 2015 the wtv and water table acceleration maps revealed mean values of 0 43 m year and 0 93 m year2 respectively these numbers suggest that the problem of dewatering of the carl aquifer continued but that the rate of drawdown has slowed if the observed drawdown rate continues by the year 2035 45 of the surface area of the carl aquifer will have a water table greater than 120 m below surface 24 of the area will exceed 150 m and 5 of the area will exceed 180 m whereas deeper water tables increase the cost of lifting water to the surface there is also a risk of worsening groundwater quality as deeper parts of the aquifer are sourced furthermore the demand for irrigation is likely to increase under the most likely near term climate change scenarios published by the intergovernmental panel on climate change a 5 10 reduction in rainfall is predicted by 2040 given these potential negative future consequences of over exploiting aquifers this original approach will help water managers make more informed decisions for the development of groundwater resources keywords water table acceleration changes in aquifer storage forecasting water table change groundwater management empirical bayesian kriging 1 introduction in the last 70 years an increasing number of private and public groundwater pumping wells in the state of guanajuato led to groundwater being over exploited foster et al 2004 wester et al 2009 pressures from the growing agricultural activity and population contributed to a permanent decline of groundwater storage a deterioration in groundwater quality a progressive decrease in base flow to rivers changes in groundwater flow patterns subsidence and substantial increases in the cost of groundwater extraction chaussard et al 2014 hoogesteger and wester 2017 mahlknecht et al 2006 navarro de león et al 2005 ortega guerrero 2009 semarnat 2013 to address these impacts different strategies have been implemented by the federal government to reduce groundwater abstractions but unfortunately the water table continues to decline unabated hoogesteger 2017 hoogesteger and wester 2017 scott and shah 2004 wester et al 2009 the unsustainable groundwater development in the cuenca alta río laja catchment hereinafter referred to as the carl catchment however could have been exacerbated by the methodology implemented by the federal government authority conagua that over estimates average annual groundwater availability for extraction 1 1 groundwater availability issue groundwater availability should not be confused with the total volume of water stored in an aquifer because it is unrealistic and undesirable for all water stored in the aquifers to be removed by pumping the concept of availability is defined as the volume of water that is available for different uses while still avoiding undesirable impacts on ecosystems the availability of groundwater as a supply is a function of different factors like water law regulations economics infrastructure climate quality and quantity of water anderson and woosley 2005 barlow 2002 faunt 2009 nevertheless the evaluation of groundwater availability based on the renewable fluxes could be questionable for some aquifers because the groundwater resilience and overall volume of groundwater stored groundwater resilience is the ability of the system to dynamically increase recharge and decrease base flow to rivers termed capture taylor 2009 zhou 2009 some authors define groundwater availability as the total volume of groundwater storage recoverable because this includes the concepts of resiliency and the capacity of the aquifer system to continue providing a long term water supply when storage is large buffer capacity richey et al 2015 taylor 2009 however even in resilient systems with high buffering capacity the negative impacts of pumping include 1 limiting the recoverable groundwater in storage through subsidence which decreases porosity and therefore aquifer storativity 2 streamflow depletion 3 increased pumping costs and 4 declining water quality alley 2007 therefore groundwater availability defined this way will still incur negative effects that need to be considered in long term management plans of this resource conagua performs a periodic water budget nom 011 conagua 2015 to determine groundwater availability for extraction in all the 653 aquifers in mexico the conagua methodology considers the natural recharge plus capture induced recharge as inputs to the aquifer the outputs are groundwater extraction and the natural groundwater discharge allocated for environmental purposes in the carl catchment and many aquifers throughout central mexico natural discharge is unfortunately zero since falling water tables have disconnected rivers from year round baseflow navarro de león et al 2005 sophocleous 2002 thus in practice groundwater development of the carl catchment is more closely related to groundwater mining since pumping greatly exceeds any definition of groundwater availability 1 2 contradictory policies exacerbate perceptions of groundwater availability in the state of guanajuato the vedas i e bans of new wells have been applied by conagua since 1952 conagua 2010 unfortunately these well drilling prohibitions have not been effective since no capacity for enforcement exists foster et al 2004 great subsidies for electricity consumption have been given to the agricultural sector these subsidies cover on average 86 of the cost of day time consumption and 92 of the cost of night time consumption compared to domestic tariffs cfe 2017 furthermore federal government programs for modernizing irrigation like sprinkler or drip irrigation are inaccessible by the ejido sector hoogesteger 2017 ejidos are parcels of land that belong to the federal government but are allocated to families provided they continue to farm them although they are often inefficient compared to larger farms run by big businesses in the late 1990s conagua and the guanajuato state water commission ceag comisión estatal del agua de guanajuato promoted self regulation of groundwater use through the creation of technical water councils cotas consejos técnicos de aguas these cotas are auxiliary organizations according to water law they have no legal mandate and they depend economically on ceag and conagua one of the cotas primary objectives are to stop falling water tables to date is clear that cotas cannot achieve these objectives and with current water policies neither can state and federal water administrators stabilize water tables with legal power without the cotas foster et al 2004 hoogesteger and wester 2017 wester et al 2009 wester et al 2011 1 3 relevance and pertinence of this research understanding the various causes for changes in decline rates on water tables and calculating annual availability of groundwater is an urgent issue in the state of guanajuato coclima 2011 the evaluation and modelling of changing groundwater resources is fundamental for their management and for planning regional economic activity the evolution of the water table of guanajuatós aquifers is updated annually by ceag whereas various physically based deterministic mathematic models have been used to simulate the aquifers in the state of guanajuato foster et al 2004 navarro de león 2006 sandoval 2004 the most significant effort was made by ceag during the period 1998 2006 with the aquifer model development program serra et al 2005 nevertheless a correct model calibration in the carl catchment was not possible owing to various sources of error in the input data and lack of information about the subsurface geology natural recharge and groundwater extractions chavez et al 2005 despite these limitations the ceag cotas groundwater monitoring network continues to measure the depth to the water table and the water level data is quite complete in terms of coverage in time and space past studies performed on the carl catchment have estimated groundwater recharge residence time and groundwater flow pathways based on water isotopes and other natural tracers mahlknecht et al 2006 mahlknecht et al 2004 other studies have specifically addressed groundwater quality seeking to understand the principal origins of arsenic as and fluoride f knappett et al 2018 knappett et al 2019 ortega guerrero 2009 the present and future distribution in groundwater quality is important since inadequate quality water effectively limits groundwater availability for use as drinking and irrigation water concentrations of geogenic as and f concentrations are dependent on pumping rates and declining groundwater tables in the carl catchment knappett et al 2018 knappett et al 2019 analysing the explicit response in groundwater quality to pumping is however beyond the scope of the present study the lack of reliable information on the physical properties and fluxes to and from the aquifer system motivated us to develop a new approach to managing groundwater by quantifying the evolution of groundwater storage over time and space using only water table information the proposed methodology includes the use of geostatistical geospatial and time series tools maps were generated to 1 forecast the water table velocity wtv in the short 10 years and medium term 10 20 years 2 assess annual change in storage without relying on estimates of groundwater extractions evapotranspiration et or natural recharge 3 classify wtv and water table acceleration maps to detect areas with possible over pumping or the placement of unregistered wells and 4 generate maps forecasting the time to reach economically unfeasible water table depths new approaches that utilize the latest geospatial mapping and statistical tools to quantify the behaviour of aquifers for which minimal information is available are critically important today this is because the physical properties of most of the world s aquifers that are used to grow food and provide drinking water for the world s rapidly growing population are poorly studied especially in latin america africa and south asia villholth et al 2018 2 materials and methods the analysis of the water table levels measured across the monitoring network using geostatistical models was performed to evaluate their inter annual variation and the evolution of water storage in an aquifer first a water table surface was generated with the empirical bayesian kriging ebk method by interpolating the measured water table levels across the monitoring network next the area of analysis was delineated using prediction error maps of the ebk model and the geology and the administrative limits aquifer known as cuenca alta del río laja aquifer hereinafter carl aquifer next the change in storage was evaluated and water table acceleration maps were calculated by stacking successive annual water table velocity maps finally the curve fit tool a tool developed by usgs for arcmap of esri was applied to fit a linear model the results were used to forecast the future evolution of water table and estimated the time to reach critical depths to water table that may be economically important for agricultural groundwater users 2 1 study area and data sets the carl catchment fig 1 has an area of approximately 7000 km2 it is divided into four administrative zones the previously mentioned carl aquifer the laguna seca aquifer the dr mora san jose iturbide aquifer and the san miguel de allende aquifer see fig 1 these aquifers are hydraulically dependent as evidenced by similar water table elevations dividing any two administrative boundaries data not shown the laja river and its tributaries are the principal channels draining surface water at the bottom of the carl catchment water exits the basin through the ignacio allende ia dam this dam is mainly used for irrigation and flow control for the lowlands of the state of guanajuato bajio the ia dam was built in 1968 with an initial storage capacity of 251 mm3 106 cubic meters prior to 1971 the laja river was a perennial river the la begoña gauging station located where the ia dam is located today registered a minimum base flow of approximately 1 m3 s up until the dam s construction in 1968 after this the laja river gradually became an intermittently flowing river caused by excessive groundwater pumping semarnat 2013 this reduction in surface flow primarily impacted the irrigation district 085 la begoña that is downstream of ia dam the carl aquifer has an area of approximately 4130 km2 and is in the northern portion of the state of guanajuato in central mexico the analysed area shown in fig 1 has a surface area of 1965 km2 see the area represented by a black dotted line and is located within the limits of the carl aquifer yellow dashed lines the climate is semi arid with an average annual precipitation 400 mm in the plains and 800 mm in mountain areas the rainy season starts in may and ends in october typical mean monthly rainfall during the wet season range from 35 to 86 mm month in the dry season however mean monthly rainfall typically ranges from 8 to 18 mm month the mean annual temperature is 17 c the period from april to june is the hottest months with mean monthly temperatures ranging from 18 c to 22 c whereas the coldest months are december to february with mean monthly temperatures ranging from 11 c to 15 c conagua 2017 mahlknecht et al 2006 the carl aquifer is pumped primarily for municipal and irrigation use eighty five percent of groundwater pumped is used for agriculture followed by 11 7 for municipal use the actual volumes for 2017 are listed in table 1 the groundwater monitoring network of the carl aquifer is comprised of 61 wells the depth to water table in each of the wells was measured at the end of both the dry and rainy this information was provided by ceag for the years 2008 2015 conagua periodically evaluates groundwater availability for extraction the last publication semarnat 2018 concluded there was a deficit in the carl aquifer of 62 1 mm3 year as a result of this last publication the construction of new pumping wells has been prohibited by law an exception is made for deepening or replacing wells that run dry in practice however conagua has little control over the drilling of illegal wells the geology of the basin is comprised of volcanic sedimentary rocks mahlknecht et al 2004 ortega guerrero 2009 fig 2 there are few publicly available borehole lithologies within the basin but the limited information suggests that within carl catchment two main aquifers overlay one another the upper aquifer is comprised of poorly consolidated sedimentary deposits with clasts ranging from silt to boulder sized these layers are inter bedded with volcanic tuffs underlying the upper sedimentary aquifer is a fractured ignimbrite aquifer of mainly rhyolitic origin fig 3 the upper and lower aquifers are considered hydraulically connected since the hydraulic heads of wells screened in both aquifers are similar and the hydraulic conductivities of each aquifer are within an order of magnitude the upper aquifer however is more conductive ortega guerrero 2009 2 2 data analysis 2 2 1 exploratory data analysis descriptive statistics that includes the mean minimum maximum standard deviation sd and coefficient of variation cv were utilized to summarize observed water levels in wells of the water table monitoring network to evaluate normality and stationarity the statistical distribution of water levels for each year was evaluated using the skewness kurtosis and normality test that included the jarque bera j b and shapiro wilks s w methods box plot diagrams and variogram cloud graphs were created to analyse possible outliers the variogram cloud graphs were generated to detect local outliers where pairs of observations with variances greatly differing from the rest are considered as atypical in their spatial correlation 2 2 2 geostatistical analysis generally geostatistical models perform better overall than the deterministic spatial interpolation models to predict spatial temporal variation of groundwater levels adhikary and dash 2017 kresic and mikszewski 2012 sun et al 2009 varouchakis and hristopulos 2013b geostatistical methods are commonly applied to water table elevations to 1 reveal the spatial and temporal structure of water table fluctuations ahmadi and sedghamiz 2007 chen and feng 2013 2 detect critical regions where correction is needed to achieve more sustainable groundwater use el fadel et al 2014 thomas and famiglietti 2015 3 estimate the water table decline and fluctuations with low uncertainty in both space and time scales sun et al 2009 ta any et al 2009 4 optimally contour the water table to achieve effective management and monitoring decisions ahmadi and sedghamiz 2007 béjar pizarro et al 2017 kumar 2007 varouchakis and hristopulos 2013a and 5 generate vulnerability maps for environmental planning and decision making using index methods coupled with gis based spatial analysis as an alternative to more costly methodologies el fadel et al 2014 varouchakis and hristopulos 2013b finally it should be stated that there is some concern that the popularity of geostatistical methods could lead to frequent misuse and hence to errors in the estimation process kresic and mikszewski 2012 2 2 2 1 empirical bayesian kriging krivoruchko and gribov krivoruchko and gribov 2014 krivoruchko and gribov 2019 improved upon the classical geostatistical kriging methods coded within the esri software package which use only one variogram by introducing empirical bayesian kriging ebk the fundamental advance was that classical kriging methods estimate a variogram that is considered the true variogram of the observed data but does not explicitly consider uncertainty by not taking this uncertainty into account classical methods underestimate the standard errors of predictions basu 2016 in contrast ebk creates and spectrum of variograms this process accounts for the error introduced by estimating a variogram model in the first place additional advantages of ebk over classical kriging models are krivoruchko 2012 krivoruchko and gribov 2014 krivoruchko and gribov 2019 1 it permits moderate local and large non stationarity in the data 2 it allows for varying measurement errors 3 if needed the method can transform the data to conform to a spatial gaussian distribution locally with a normal score process 4 in the case of a large datasets the input data can be divided into subsets of specified size that may or may not overlap and 5 in each subset the distribution of the different possible variograms is produced and prediction is generated from variograms of each subset there are some disadvantages of ebk compared to classical kriging models 1 the variogram parameters in ebk are estimated using restricted maximum likelihood that creates limitations for large datasets basu 2016 2 processing is slower than other kriging methods especially when the results are output in a raster format and 3 cokriging and anisotropic corrections are unavailable esri 2016 some applications where ebk performs better than classical geostatistical methods are described in gupta et al 2017 wherein ebk was used to characterize rainfall variability in arid and semi arid regions and mirzaei and sakizadeh 2016 wherein ebk was used to characterize the spatial temporal distribution of groundwater contamination the comparison of performance between classical geostatistical methods deterministic interpolation methods and ebk is beyond the scope of this study 2 2 2 2 assessing the variability of predictions cross validation is a process implemented by arcgis to compare the predicted values to the observed values using the following statistics 1 me 1 n i 1 n y i x i 2 rmse 1 n i 1 n y i x i 2 3 ase 1 n i 1 n σ 2 y i 4 mse 1 n i 1 n y i x i σ y i 5 rmsse 1 n i 1 n y i x i σ y i 2 where me is the mean error rmse is the root mean square error ase is the average standard error mse is the mean standardized error and rmsse is the root mean square standardized error in these equations y i is the simulated value x i is the observed value and σ is the standard deviation cross validation extracts each observation one by one and predicts them with the remaining information every data point extracted is restored once it is predicted to continue with the next point it is important to correctly assess the variability of predictions a summary of some rules to check are listed in table 2 kresic and mikszewski 2012 an accurate model should reasonably comply with the conditions indicated in table 2 furthermore the rules showed in the table can help to identify if the predictions are overestimated or underestimated 2 2 2 3 comparing distributions comparing distributions of measured and predicted water levels in wells help us to confirm if there is a significant difference or not we used the parametric paired t test which assumes that differences between pairs are normally distributed additionally we used the non parametric two sample kolmogorov smirnov test is important to confirm that there is no bias between measured and predicted to satisfy the assumptions of the curve fit tool 2 2 3 curve fit tool curve fit is a pixel level raster regression tool for mapping spatial patterns developed by de jager and fox 2013 this tool was developed as an extension of arcgis by using this tool it is possible to execute a linear or non linear regression analysis for a raster dataset that represents the temporal evolution of the water table elevation the temporal evolution is represented by a unique mathematical model for each pixel located at the same spot across different raster datasets fig 4 the results of the fitted model create a new raster for each variable of the mathematical model the supported models include polynomial power exponential four parameters logistic and the linear model represented by eq 6 6 linear y a x b where a and b are parameters in raster format wherein pixels store the best fit parameter value in the linear model to the observed values x represents time years and y represents the simulated water table the curve fit tool outputs 1 model fit 2 residual errors 3 p value 4 multi model inference statistics aic akaike information criterion or bic bayesian information criterion 5 parameter value estimates 6 standard errors se and 7 t statistics 2 2 4 area of analysis delineation the administrative area of the carl aquifer see yellow dashed lines in the fig 1 defined by conagua includes mountainous areas and geology that are not suitable for the analysis of evolution through geostatistical methods since the abrupt topography and sharp lateral changes in rock type drive abrupt lateral changes in the water table in addition the monitoring network itself only covers an area underlain by the sedimentary deposits of quaternary age forming the upper carl aquifer and the network is not equally distributed across this surface area this is also the part of the basin that is most actively farmed and pumped for irrigation so it is relevant to focus the study here therefore the area of analysis see the area bounded by black dotted line in fig 1 was defined considering the following 1 avoiding areas with large uncertainties 2 the administrative boundary of carl aquifer and 3 the surface geology the area of analysis coincided with the outcrop area of the quaternary sedimentary deposits fig 2 2 2 5 evaluation of water table velocity and water table acceleration the prediction of water levels in wells with ebk generated water table maps across the study area for each study year 2008 2015 furthermore annual wtv maps were created by considering the difference between water table maps from consecutive years water table velocity maps are commonly used to define the variation of the water table in time dh dt and have units of m year if the storage coefficient of the unconfined aquifer is known in this case this is s specific yield the annual net change in aquifer storage can be calculated which is the volume of additional or missing water thus although the individual components of the water budget are not assumed the change in storage which is often the purpose of calculating a water budget can be calculated water table acceleration wta maps were evaluated as the difference in rates of wtv over time d 2 h dt 2 this provides novel information that is highly relevant for managing the aquifer these wta maps allow identification of changing groundwater extraction intensities that are not visible in the annual wtv maps furthermore from wtv and wta classification maps fig 14 one can establish areas of interest for future research to address possible relationships with water quality exploitation intensity or subsidence the average acceleration over a period of years serves as a baseline to define whether there is a year to year acceleration or deceleration in recovery or drawdown 2 2 6 case classification of water table velocity and water table acceleration there are four different cases with respect to wtv and wta explained in fig 5 accelerating recovery case 1 has positive velocity and acceleration in contrast decelerating recovery case 2 has positive velocity but negative acceleration deceleration in contrast under the more typical case for the carl aquifer of negative velocity decline in the water table a positive acceleration case 3 represents a slowing of the rate of drawdown in contrast a negative velocity with a negative acceleration case 4 represents accelerating drawdown in an over exploited aquifer system with a deep water table these four cases can be ranked from best case 1 to worst case 4 scenarios for the purposes of visualizing which parts of the basin are experiencing best or worst case conditions in its water table the four cases were given numerical values ranging from 1 to 4 2 2 7 groundwater budget evaluation the technical studies published by conagua semarnat 2009 semarnat 2013 semarnat 2015 reported the average annual groundwater availability in the carl aquifer for the following dates see table 3 september 30 2008 march 31 2013 june 30 2014 and december 31 2015 the methodology implemented by conagua to evaluate annual average groundwater availability agwa follows the official mexican standard nom 011 conagua 2000 updated by the nom 011 conagua 2015 this method calculates a water budget using an annual average total recharge which includes natural and captured recharge the natural discharge committed and the volume of annually extracted groundwater eq 7 7 agwa average annual total recharge annual natural discharge committed annual ground water extraction the groundwater availability values published by conagua for the carl aquifer reported an average total recharge of 139 7 mm3 106 cubic meters per year that was estimated by conagua in 1971 1981 and 1982 semarnat 2015 unfortunately in the more recently published agwa values the natural discharge committed in the carl aquifer was assumed to be zero by conagua this means that eq 7 without the natural discharge committed stipulates that availability exists only when groundwater extractions are less than or equal to total recharge natural recharge plus capture unfortunately extractions in the carl aquifer have historically exceeded the total recharge groundwater mining and their negative effects are well known sophocleous 2000 zhou 2009 the lack of reliable information needed to close the water budget means that other options should be considered in this particular situation a change in storage δs made with water table velocity maps dh dt the average aquifer storage coefficient s specific yield and the area covered by the analysis a could be more useful than eq 7 to evaluate changes in stored groundwater the proposed equation is shown in eq 8 8 δ s s y a 1 n n 1 n dh dt where n is the number of pixels of the drawdown velocity map in the analysis area enough information on sy does not exist with spatial variability for the carl aquifer therefore a mean value of 0 04 for the coefficient sy is used conagua 2002 to compare the calculated annual change in storage with that published by conagua 2 2 8 time to reach a critical water table depth the time to reach a critical water table depth can be calculated with eq 6 by changing the prediction variable y to the critical depth and solving for the time variable because all the variables from eq 9 are raster format the variable y from eq 6 is evaluated with the digital elevation model dem inegi 2018 minus the critical depth and the resulting equation is shown in eq 9 where x is the time variable in raster format 9 x dem critical depth b a the critical depth values used for the analysis were 120 150 and 180 m foster et al 2004 concluded that farming using water from guanajuato s aquifers agricultural crops and irrigation techniques would be uneconomical when the depth to water table approached 120 m today however part of the farming regime changed hoogesteger 2017 since 2004 and according to unofficially information from some stakeholders and ceag staff the economically unfeasible limitation of water table depth will be between 180 and 200 m in part due to government electricity subsidies up to 92 compared with domestic tariffs nevertheless the ejido sector with less access to technical improvements in irrigation hoogesteger 2017 suffers more expenses associated with accessing the lower water table depths e g less than 150 m 3 results and discussion 3 1 descriptive statistics of the water level dataset descriptive statistics of each year of water levels measured in 61 wells that comprise the groundwater monitoring network provide an initial assessment of the normality of the distribution of annual water table levels and inter annual stationarity of the distributions between years the distribution of observed water table levels had a kurtosis that decreased throughout the study period table 4 between 2008 and 2015 kurtosis decreased from 4 1 to 3 2 the kurtosis gradually tended towards a normal distribution but with a positively skewed distribution the normality test shows that the distribution approached gaussian j b p 0 05 over time this is likely because the cones of depression became deeper and wider compared to the more focussed drawdown from spatially clustered agricultural activity other processes besides agricultural activity may explain this phenomenon however such as delayed mountain front recharge and the indirect effect of rainfall variability with short term climate phenomena such as el niño and la niña water tables have a non stationary pattern that can be partially explained by climate variability holman et al 2011 and interactions with pumping for irrigation demand in the present dataset non stationarity is indicated by inter annual variability of the mean the standard deviation and indicators of kurtosis and skewness table 4 a rapid decline in the mean water table occurred between the years of 2011 and 2012 during this period the la niña phenomenon drove severe drought conditions during the normally wet season conagua 2012 this intensified a drop in the water table owing to increased groundwater extraction to meet irrigation demand in contrast during the el niño year 2014 2015 when abundant rainfall occurred even during the normally dry season conagua 2015 a rapid recovery of the aquifer was observed owing to less irrigation demand thus climate phenomena interact with groundwater pumping for irrigation and drive inter annual changes in observed water levels 3 2 outlier analysis an outlier analysis was performed with boxplots fig 6 and variogram cloud graphs fig 7 the well id of these possible outliers is shown in the fig 1 not all possible outliers are actual outliers the box plot diagram fig 6 identified wells with higher topographic elevation than others as possible outliers outliers were confirmed with the residual errors of the ebk model and their relevance in the groundwater budget uncertainty see section 3 4 only wells id 1 and 2 were excluded as outliers in the geostatistical analysis 3 3 geostatistical model and interpolation maps the ebk model was used to interpolate the water table level in 59 pumping wells 2 wells excluded as outliers during the period of 2008 to 2015 the ebk parameter configuration was calibrated for the year 2008 and it was maintained for all the years of analysis to assess model accuracy and bias relative to observed water levels each year cross validation was performed table 5 to determine the best fitting theoretical ebk model the ebk modelling approach is well suited to moderately non gaussian data the theoretical model was k bessel the transformation was set to empirical and the number of iterations was set to 100 the overlap factor used was 1 and the subset size was 50 the search neighbourhood parameter was set to smooth circular with a smoothing factor of 0 85 and search radius of 14 5 km different errors from cross validation were analysed with the rules shown in table 2 to assess the variability of predictions and evaluate the performance under or over estimation of the ebk model the interpolation errors summarized in table 5 suggest that ebk model performed correctly and avoided important under or overestimation this is evidenced by me and mse values that are close to zero convergent rmse and ase values and rmsse values near unity table 2 a visual fit of the empirical semivariances blue crosses to the semivariogram spectrum generated by the ebk model is shown in fig 8 the interpolated versus observed water levels are shown in fig 9 for the years 2008 2015 the distribution of interpolation errors is analysed in fig 10 with normal q q plots the best fit line through the interpolated versus observed water levels had a slope close to 1 and the interpolation errors were normally distributed p 0 05 these findings confirm the lack of systematic bias in the ebk model table 6 summarizes normality tests statistics to confirm there was no statistically significant difference between predicted and observed water levels and use in good conditions the curve fit tool the interpolation maps generated with ebk for the water table during the period of 2008 2015 are depicted in fig 11 fig 12 shows maps of standard errors of interpolation 3 4 evolution of change in storage 2008 2015 the impact of including or excluding various outliers on the calculation of the annual change in storage and its uncertainty is shown in fig 13 from fig 13 we confirmed wells id 1 and 2 as outliers after removing these two outliers the uncertainty in the change in storage was substantially reduced for the periods 2008 2009 2009 2010 and 2011 2012 the rest of possible outliers identified were not excluded of the analysis because their elimination from the model did not reduce the uncertainty of change in storage estimates the water table interpolation maps were used to evaluate the evolution of wtv the results are shown in fig 14 a with the average velocity for the period 2008 2015 annual mean wtv maps were stacked to evaluate the water table acceleration wta maps for the period 2008 2015 fig 14 b the classification of areas falling into four categorically distinct states of wtv and wta reveals that a large part of the basin is experiencing either decelerating case 3 or accelerating drawdown case 4 fig 5 this argues that the carl aquifer is laterally well connected and has important implications for groundwater managers fig 14 c the storage coefficient used for the water deficit calculations sy 4 is the mean value published by technical studies of conagua in the region which found this value ranged from 1 8 to 6 using single well pumping tests the groundwater budget availability published by conagua can be accessed in the federation official report dof diario oficial de la federación the published values from this report summarized in table 7 see values marked with and compared with the estimated change in storage using the geostatistical method followed in this study water managers should pay close attention to areas with accelerating drawdown case 4 in fig 5 as shown in fig 14 c accelerating drawdown reveals indicates 1 the possible locations of new illegal wells 2 users that overdraft groundwater extraction 3 areas with high density of pumping wells or 4 areas where the water table may be moving across a depth interval of the aquifer that has a decreasing specific yield sy with depth the classification of areas in fig 14 c according to the accelerating or decelerating recovery or drawdown is novel information derived from water table velocity and acceleration maps fig 14 c shows the location of 1260 pumping wells installed within the carl aquifer that are registered in the registro público de derechos de agua repda database public registry of water rights there is a high spatial density of pumping wells in the centre of the catchment which coincides with the largest area that is experiencing accelerating drawdown during the period from 2008 to 2015 the mean wtv was 0 43 m year the mean change in storage volume was 34 1 mm3 year 106 cubic meters per year and the mean wta was 0 19 m year2 therefore although there are important regional differences on average in the carl aquifer and over the 8 years the aquifer is experiencing decelerating drawdown case 3 in fig 5 thus the problem of falling water tables continues but the drawdown is apparently decelerating this however could change rapidly with short term 1 year climate phenomena like the next la niña or el niño the el niño and la niña phenomena have important indirect effects on the availability of water in the carl aquifer during the period from 2011 to 2012 la niña caused severe drought conditions during the normally wet season the indirect effects of this on the water table was evident by the rapid decline of mean water table elevation table 4 and the change in storage was 123 5 mm3 year in contrast during the el niño period from 2014 to 2015 a rapid recovery of observed water levels was measured and the change in storage volume was 87 8 mm3 year the most plausible explanation for this is that less irrigation water was needed during the normally dry season march june because of the abundant rainfall and the delayed mountain front recharge from past events fig 15 and table 8 permit testing this hypothesis fig 15 shows quarterly precipitation each year bars with circles indicating the change in storage volume for each year a relationship is evident between rainfall during the late dry season apr jun and the change in storage volume this relationship was evaluated with a pearson correlation analysis see table 8 which showed the highest correlation r 0 58 between rainfall in apr jun and the change in storage each year compared to rainfall in all other periods 3 5 forecasting analysis the interpolation maps of the period from 2008 to 2015 fig 11 comprised the input for the curve fit tool developed by the usgs as they are statistically representative of measured values see table 8 this tool permits the calculation of the drawdown trend using different models to forecast future water table maps to choose the best model to extrapolate the water table trend the following assumptions were considered in the carl aquifer and catchment the construction of new pumping wells will continue to be banned with exceptions made for repositioning or deepening older pumping wells subsidies for energy consumption will allow the current rates of groundwater development of the aquifer to continue some users will avoid paying for electricity consumption hoogesteger 2017 the drilling of illegal pumping wells will continue in addition the extracted volumes of water by illegal wells is unknown however the changing water table driven by these extractions is known the el niño and la niña periodical climate phenomena conagua 2012 2015 have an indirect influence on the evolution of annual water table in the aquifer table 7 these phenomena have opposite effects see el niño and la niña years in tables 5 and 7 and thus the regular co occurrence of both phenomena over the span of a decade may counteract or reduce their impacts over the short term less than a decade and medium term a couple of decades these assumptions permitted the forecasting of possible future water tables by extrapolating the results from the model of the actual water table trends over the period from 2008 to 2015 the phreatic water table is the final response for all inputs and outputs from the aquifer including the indirect effects of climate variability in this specific application by geostatistical analysing only water table elevation the most appropriate mathematical model to extrapolate the actual trend was found to be eq 6 or the linear model the linear model fitted with the curve fit tool over the period from 2008 to 2015 has a good correlation coefficient r between 0 7 and 0 95 where the cone of depression is located and it accounts for 47 6 of the analysis area a moderate r between 0 5 and 0 7 around cone of depression accounts for 18 6 of the analysis area see fig 16 left meanwhile areas with low correlation coefficient r 0 5 accounts for 33 8 of the analysis area in general areas with low correlation are not valid for forecasting but these areas have minimal impact on the results presented here because these areas tend to have few pumping wells the exception to this is the san miguel de allende sm allende area where there are approximately 12 of carl aquifer pumping wells are located fig 16 right b c d e depicts the forecast water table for different years considering the same trends as the prediction maps over the period from 2008 to 2015 in these forecasting maps the evolution of depression cone below the city of d hidalgo and nearby communities is owing to rapid urban growth this highlights competition between urban centres and farms for potable water since the city is in an intensively farmed area this consumptive activity will gradually reduce the availability of public groundwater supply for d hidalgo and nearby communities 3 6 time to reach economically unsustainable depths to water table the world bank recommendations on groundwater depletion presented by foster et al 2004 predicted that the 120 m depth to water table would be economically unsustainable in the aquifers of guanajuato even considering electrical subsidies unfortunately in 2015 the water table underlying over 35 of the modelled surface area of the carl aquifer already exceeds 120 m in depth fig 17 a and table 9 the critical water table depth 120 m 150 m and 180 m is dependent on the farming regime profit margin of agricultural crops and irrigation techniques hoogesteger 2017 and the energy subsidy policies currently as much as 92 the consequences of growing water table depths will be specific for every farm but some costly and health impacting issues are common to all groundwater users including well deepening burnt out pumps and worsening water quality knappett et al in review if the modelled trends during the period 2008 2015 remain similar over the coming years and decades the percentage of the modelled surface area of the carl aquifer that could exceed 120 m 150 m and 180 m for the year 2035 will be 45 2 24 1 and 5 4 respectively table 9 these forecasts are potential scenarios and obviously the uncertainty grows with the time horizons used owing to different external factors that are impossible to predict nevertheless extrapolations of observed water level trends are commonly used by groundwater managers to assess the likely future conditions of the aquifer recently drilled municipal supply wells in the basin reach 600 m depth knappett et al 2018 the justification for the great depth and expense is that it will allow more time to recover the investment in drilling the well installing very deep wells however raises the risk of consuming toxic concentrations of as and f knappett et al 2019 4 conclusions the water table level evolution in the carl aquifer was evaluated with a new geostatistical method this method only requires annual water level measurements and is especially well suited for situations when the costs of gathering relevant information for other more deterministic solutions is infeasible this study demonstrates this method is a helpful tool for 1 understanding the indirect effects of climate variability in the year to year evolution of aquifer storage 2 supporting decisions in the short term for managing the aquifer by prioritizing inspections for illegal wells or excessive pumping in specific areas and 3 forecasting future scenarios with a linear trend empirical bayesian kriging ebk was implemented to deal with non gaussian moderately non stationary data table 4 an area for analysis was delimited based on an acceptable level of uncertainty in the interpolation maps of water levels nevertheless other kriging models or deterministic spatial interpolation models can be used if their predictions correspond with the conceptual site model and spatial variability of the groundwater level the application of this methodology was limited to the spatial extent and distribution of the groundwater monitoring network outside of this analysis area the prediction errors increased rapidly the uncertainty in the calculated change in storage was sensitive to outliers id 1 and id 2 these were dismissed from the analysis furthermore another source of uncertainty is the average specific yield sy 0 04 value used in the change in storage evaluation unfortunately information about spatial variability of specific yield doesn t exist and only a few values from single well pumping test exist the current method used by conagua however to calculate groundwater budgets also has important sources of uncertainty there are uncertainties in reported total recharge and extractions volumes for example furthermore the method utilized by conagua assumes that total recharge natural recharge plus capture used is constant and unaffected by natural climate phenomena like el niño and la niña during the period 2008 2015 the la niña and el niño phenomena indirectly impacted water table evolution during the period from 2011 to 2012 la niña caused severe drought and over extraction conditions that exacerbated a rapid decline of mean water table level the average wtv that year was 1 6 m year in contrast during the el niño period from 2014 to 2015 a rapid recovery of observed water table 1 1 m year can be explained principally by less irrigation water demand during the dry season because of relatively abundant rainfall new tools are needed for managers to identify accelerating rates of drawdown exacerbated by unregistered wells and users that exceed their permitted groundwater extraction volumes new classification maps of wtv fig 14a and wta fig 14b can be utilized diagnose locations with accelerating rates of drawdown fig 14c which likely indicates increased pumping although the areas with accelerating drawdown velocities could also be the result of diminishing hydraulic conductivity or aquifer storage capacity with depth in the carl aquifer the mean wtv was 0 43 m year the mean change in storage volume was 34 1 mm3 year and the mean wta was 0 19 m year2 these numbers suggest that the problem of drawdown continued but the rate decelerated although these numbers will change rapidly with the next la niña or el niño event if deceleration of drawdown continues in coming years it could suggest that governmental management policies and self regulation ceag cotas finally had a positive effect other policies however only exacerbate the problem such as the electricity subsidization programs nevertheless a deceleration of drawdown does not mean that the problem is over but the situation may be gradually improving forecasting the actual water table trend is an important product of the new method presented in this study falling water tables will reduce human access to the aquifer through domestic and water supply wells users cope with the loss of pump efficiency caused by falling water tables by pumping the well longer up to 24 h a day to get the same daily production volume as before but with greater electricity consumption an economically unfeasible limitation considered by some stakeholders and ceag is the depth to water table between 180 m and 200 m because of the government electricity subsidies up to 92 compared with domestic tariffs and change in the farming regime agricultural crops and irrigation techniques hoogesteger 2017 hoogesteger and wester 2017 however the ejido sector with less access to technical improvements in irrigation hoogesteger 2017 suffers the greatest economic consequences and therefore will have shallower economically feasible water table depths e g less than 150 m by the year 2035 the percentage of the modelled surface area of the carl aquifer that could exceed 120 m 150 m and 180 m will be 45 24 and 5 respectively the actual trend of the falling water tables will have important repercussion for municipal water supply for the growing city of dolores hidalgo and nearby communities as well as the nearly ubiquitous farms throughout the basin our forecast becomes serious when one considers the current subsidy of up to 92 for electricity consumption and the likely impact of climatic change published by the intergovernmental panel on climate change which is considered by governmental policies coclima 2011 a 5 10 reduction in rainfall is predicted for guanajuato by 2040 credit authorship contribution statement yanmei li funding acquisition project administration writing review editing j horacio hernandez conceptualization formal analysis investigation methodology software visualization writing original draft writing review editing manuel aviles data curation software validation visualization peter s k knappett funding acquisition project administration writing review editing john r giardino funding acquisition project administration writing review editing raúl miranda conceptualization visualization maría jesús puy conceptualization supervision francisco padilla investigation jorge morales formal analysis declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements thanks to the comisión estatal de aguas de guanajuato ceag and the consejo técnico de aguas cotas for the access to water table information the interpretation of the results in this study benefited from discussions with prof richard woodward texas a m university funding the investigation work was supported by the universidad de guanajuato grant number 004 2015 1013 2016 and 219 2019 and texas a m university conacyt collaborative research grant program grant number 2014 001 and 2017 034s appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2019 124517 these data include google maps of the most important areas described in this article appendix a supplementary data the following are the supplementary data to this article the following kmz file contain the google maps of the most important areas described in this article map 
5812,water is the backbone of socio economic and environmental systems increasing demand and unpredictable availability due to anthropogenic climate change is making water an extremely scarce resource in different parts of the world when the resources facing scarcity are shared between different administrative boundaries conflicts could arise transboundary river basins are typical examples water sharing problems within these transboundary river basins are very difficult to solve because of the socio economic and environmental asymmetries among the water claiming stakeholders in addition water sharing problems have a systemic feature that evolves through time previous studies did not comprehensively capture these features this article attempts to fill this research gap by combining the evolutionary game and system dynamic model to predict the equilibrium outcomes of different strategic scenarios when the riparian states choose polarizing strategies the equilibrium evolves either quickly initiated by the countries need to avoid the loss that could result from water conflict or very slowly if the countries opt to maintain the benefits that result from their polarized strategies in the scenario where both choose a tolerance strategy the equilibrium evolves very slowly if either of the countries chooses a polarizing strategy irrespective of its neighbor choosing a compromise strategy the equilibrium evolves much faster the results depicted that the equilibrium under different scenarios does not always lead to concessions therefore the countries should strengthen the cooperation in water resource management to ensure that a zero sum game and the inception of a new strategic evolution are prevented keywords transboundary river water allocation conflict evolutionary game theory system dynamics 1 introduction with the population growth economic development and climate change the global water demand has been increasing rapidly on the contrary the amount of available fresh water for consumption is becoming unpredictable through time and space yuan et al 2019 at present about 3 6 billion people live in water scarce areas and in 2050 this number is expected to increase by 30 mekonnen and hoekstra 2016 hence more and more countries will face serious water shortages in the near future there are 286 transboundary rivers that run through 151 countries twap 2011 these basins include more than 2 8 billion people cover 62 million km2 and produce around 22 000 km3 of river discharge each year twap 2011 as a result these river basins are the backbones of social economic and environmental systems zhang et al 2019 during the periods of water scarcity riparian countries usually exhibit utility maximizing behavior competing for more water such strategic behavior could lead to either cooperation or conflict transboundary river water conflict is a complex problem which is related to the multi stakeholder benefit sharing dombrowsky 2009 and multi system casual feedback loop duran encalada et al 2016 xu et al 2019 if the water sharing problem is not addressed in time it could lead to water conflicts that may disturb the social economic and environmental systems degefu et al 2016 and decrease the efficient utilization of the rivers water capital an et al 2018 therefore understanding how water conflicts evolve is very important effectively identifying the formation of water conflict can serve as a base to establish a rational mechanism for resolving water conflict aiming to find a way to solve water conflicts in transboundary river basins a vast number of researchers have carried out studies on the causes of water conflict water sharing behavior of riparian countries and solutions to conflicts finding the factors that catalyze water conflicts is a key step to find the solutions to water sharing problems in transboundary river basins these factors can be classified as internal and external a transboundary river is characterized by unidirectional flow multiple tributaries spatial temporal differences in terms of runoff contribution among the country basin units degefu et al 2018 the fact that valuation of water is not internalized in the water using the economy tang et al 2011 and the quasi public nature of water resources dinar et al 2013 are the internal causes of water sharing problems in a transboundary river climate change and environmental pollution kalogeropoulos and chalkias 2013 population growth economic development nasem 2018 and lack of integrated water resources management funder 2010 petersen perlman et al 2017 are some of the external causes of water conflict in transboundary rivers these factors determine the seriousness and intensity of water conflicts the evolution of water conflicts within transboundary river basins is depicted by the change in the strategic decision making behavior of stakeholders raquel et al 2007 yang et al 2008 wei et al 2009 mehrparvar et al 2015 podimata and yannopoulos 2015 zomorodian et al 2017 studied the competitive behavior of the water sharing agents using non cooperative and cooperative game theory in addition these past studies explored the choice framework and response strategy of water claimants most of these past studies focused on analyzing water conflicts qualitatively and did not take into account their dynamic feature however it is very important to analyze the dynamic evolution process of water conflicts from the quantitative perspective to improve the water resources management efficiency system dynamics is a computer simulation method for studying information feedback loops of complex systems it can be applied to understand water sharing problems and provide a comprehensive structure to simulate the degree of the water dispute yuan et al 2018 due to the fact that the strategies of countries affect each other s behavior evolutionary games are a natural study approach whenever any external factors changes the behavior of the agents involved over time friedman 1998 therefore this paper built an evolutionary game model and simulated the game behavior of basin countries based on system dynamics and as such an approach increases the prediction accuracy better than traditional game models 2 a game theoretical model of water sharing problems within a transboundary river basin the essence of transboundary river water sharing problems is the fact that the available water resource is not adequate to satisfy the total water claim when each country tries to maximize their utility they withdraw more water and this triggers water disputes the water sharing problem appears as an asymmetric dynamic evolution game motro 1994 cao 2013 the following assumptions were considered in this article when building the evolutionary game model for water sharing problems within a transboundary river basin assumption 1 country a and country b are located within a transboundary river basin country a withdraws less water than country b for various geographical and historical reasons under water scarcity conditions country a demands that country b reduce its water consumption q in order to mitigate its water shortage problem assumption 2 country a has two strategic selections conflict with country b for more water conflict strategy or tolerate water scarcity tolerance strategy country b also has two different strategic options reduce its water consumption q compromise strategy or compete with a for more water conflict strategy assumption 3 in country a the utility from q amount of water is w 1 in country b the utility from q amount of water is v 1 assumption 4 if country a chooses the tolerance strategy and country b chooses the compromise strategy country a gets q amount of water if country a chooses the tolerance strategy and country b chooses the conflict strategy the loss of country a is represented as w 3 the cost of conflict for country b is v 2 if country a chooses the conflict strategy and country b chooses the compromise strategy the cost of conflict for country a is w 2 the loss of country b from the water conflict is v 3 if country a chooses the conflict strategy and country b chooses the conflict strategy countries a and b will suffer the loss of w 4 and v 4 respectively assumption 5 the goal of both countries is to maximize their own payoff based on the above assumptions the payoff matrix of countries a and b is constructed as follows country b compromise conflict country a tolerance w 1 0 w 3 v 1 v 2 conflict w 1 w 2 v 3 w 2 w 4 v 1 v 2 v 4 3 evolutionary game and system stability analysis if the probability of country a choosing the tolerance strategy is x then the probability of country a choosing the conflict strategy is 1 x if the probability of country b choosing the compromise strategy is y then the probability of country b choosing the conflict strategy is 1 y therefore the expected payoff from the two strategies for country a are u 11 and u 12 respectively 1 u 11 y w 1 1 y w 3 2 u 12 y w 1 w 2 1 y w 2 w 4 the average payoff of country a is u 11 3 u 1 x u 11 1 x u 12 the replicated dynamic equation f x of country a is obtained by combining the equations 1 and 3 4 f x dx dt x μ 11 μ 1 x 1 x w 3 y w 4 y w 2 w 3 w 4 then 5 f x 1 2 x w 3 y w 4 y w 2 w 3 w 4 if f x 0 x is the steady point of the replicated dynamic equation therefore x 1 0 and x 2 1 are stable strategies of country a under the different scenarios y w 3 w 2 w 4 w 3 w 4 y w 3 w 2 w 4 w 3 w 4 y w 3 w 2 w 4 w 3 w 4 the dynamic evolution paths of country a are shown in fig 1 supplementary material section 1 the same method is used to analyze the stable evolution strategy of country b under the different scenarios x v 1 v 2 v 3 v 4 v 3 v 4 x v 1 v 2 v 3 v 4 v 3 v 4 x v 1 v 2 v 3 v 4 v 3 v 4 the dynamic evolution paths of country b are shown in fig 2 supplementary material section 2 in summary the threshold probability of country a s and country b s strategy is v 1 v 2 v 3 v 4 v 3 v 4 w 3 w 2 w 4 w 3 w 4 as shown in fig 3 the evolution of the game depends on the strategic choice probability of both countries the replicated dynamic equations of both countries constitute the dynamic replication system of the water allocation conflict game the partial equilibrium points of the system constitute the equilibrium of the evolutionary game which is the evolutionary stable strategy ess of both countries the partial equilibrium point can be obtained by the partial equilibrium analysis of the determinant and trace of the jacobian matrix are det j and tr j he et al 2013 kang and udiani 2014 gao et al 2019 supplementary material section 3 if det j 0 and tr j 0 the equilibrium point is the ees of both countries the det j and tr j of five equilibrium points a 0 0 b 0 1 c 1 0 d 1 1 e v 1 v 2 v 3 v 4 v 3 v 4 w 3 w 2 w 4 w 3 w 4 as follows where t v 1 v 2 v 3 v 4 v 1 v 2 v 3 v 4 w 2 w 3 w 2 w 4 w 3 w 4 and assuming that o w 2 w 3 w 4 it means that if country b chooses the conflict strategy the payoffs from the two different strategies are not the same for country a p v 1 v 2 v 3 v 4 it means that if country a chooses the conflict strategy the payoffs from the two different strategies are not the same for country b q v 1 v 2 which means that if country a chooses the tolerance strategy the payoffs for country b from the two different strategies are not the same according to table 1 the variables o p and q are the key determining parameters of the evolutionary stability strategies under the following scenarios 1 o 0 p 0 q 0 2 o 0 p 0 q 0 3 o 0 p 0 q 0 the evolutionary stability point is 1 1 the replicated dynamic phase map is shown in fig 4 the ees of country a and country b are the tolerance strategy and compromise strategy respectively under the following scenarios 4 o 0 p 0 q 0 5 o 0 p 0 q 0 the evolutionary stability point is 1 0 the replicated dynamic phase map is shown in fig 5 the ees of country a and country b are the tolerance strategy and conflict strategy respectively under the scenario 6 o 0 p 0 q 0 the evolutionary stability points are 1 1 0 0 the replicated dynamic phase map is shown in fig 6 the ees of country a and country b are the tolerance strategy and compromise strategy respectively or both country a and country b choose the conflict strategy under the scenario 7 o 0 p 0 q 0 the evolutionary stability point is 0 0 the replicated dynamic phase map is shown in fig 7 the ees of country a and country b is the conflict strategy under the scenario 8 o 0 p 0 q 0 there is no evolutionary stable point the replicated dynamic phase map is shown in fig 8 based on the analysis of the evolutionary game of water allocation conflict in the transboundary river basin the ees under different scenarios are depicted in table 2 4 simulation results and discussion 4 1 simulation results 4 1 1 construction of the system dynamics model for water sharing problem the evolutionary game integrated with system dynamics model for understanding transboundary river water sharing problems is established by venism pls software vensim is simulation software for continuous simulation it has discrete event and agent based modelling capabilities sadeghi et al 2015 as shown in fig 9 the model consists of 4 level variables 2 flow variables 8 external variables and 16 intermediate variables the 4 level variables represent the probability of strategic choices of country a and country b respectively the 2 flow variables represent the change rate of the probability selections of country a and country b respectively the 8 external variables correspond to the 8 variables in the payoff matrix respectively the times of simulation was set as 25 times the initial values of each external variable are shown in table 3 under this scenario o 7 p 1 q 1 according to scenario 6 shown in table 2 the equilibrium points of the system are 0 0 and 1 1 assuming that the initial state x 1 y 0 01 country a chooses the tolerance strategy while country b chooses the conflict strategy with the probability of 99 the evolutionary game process of both parties is shown in fig 10 with the increase simulation time the probability of country b choosing the compromise strategy gradually increases from 0 01 to 1 the system eventually stabilizes at the point of 1 1 which indicates that if country a chooses the tolerance strategy even if the probability of country b choosing the compromise strategy is very low initially gradually country b will eventually choose the compromise strategy to maximize its interests assuming that the initial state y 0 x 0 99 country b chooses the conflict strategy while country a chooses the tolerance strategy with the probability of 99 as the simulation time increases the probability of country a selecting the tolerance strategy gradually decreases from 0 99 to 0 and the system eventually stabilizes at the stable point of 0 0 which indicates that if country b chooses the conflict strategy even if the probability of country a choosing the tolerance strategy is very high initially it will gradually choose the conflict strategy to maximize its interests the evolutionary game process of both countries is shown in fig 11 4 1 2 impact of external variables of countries on their strategy choice the external variables of country a b will influence the strategic choices of country a b directly two batch simulations to identify the influence of the internal and external variables that affect the decision making of country a and country b was conducted the range for the values of the variables was kept within 10 the change rate range was assumed to be 10 10 simulation batch 1 was done to understand the impact of the variables on country a s decision making it was done assuming that initially country b chooses the equilibrium strategy and country a chooses the tolerance strategy with 50 probability while simulation batch 2 was done to study the role of the variables on country b s strategic choices assuming that initially country a chooses the equilibrium strategy and country b chooses the compromise strategy with 50 probability from the results it can be seen that the loss and cost of conflict has a direct relationship with the probability of changing strategic choices of the stake holders in a water sharing problem with increasing w 2 or w 4 the probability of country a choosing the tolerance strategy increases and eventually country a s strategic decision evolves to a non cooperative utility maximizing behavior however surprisingly the strategic choice of country a was found not to be sensitive to the utility obtained from q amount of water fig 12 for country b with the increase of v 1 the probability of country b choosing the compromise strategy decreases and evolves to eventually choose the conflict strategy the probability of country b choosing the compromise strategy decreases with the decline of v 2 finally country b chooses the conflict strategy with the increase of v 2 the probability of country b choosing the compromise strategy increases initially but v 2 does not reach the threshold point within the change rate interval of 10 0 as a result the probability tends to follow a decreasing trend and in the end country b chooses the conflict strategy the probability of country b choosing the compromise strategy increases initially with the decrease of v 3 but within the change rate interval of 10 0 v 3 does not reach the threshold point hence the probability follows a decreasing trend and country b chooses the conflict strategy country b ends up choosing the conflict strategy with the decrease of v 4 hence the probability of country b choosing the compromise strategy decreases but v 4 fails to reach the threshold point within the change range of 10 0 as a result even though initially with the increase of v 4 the probability of country b choosing the compromise strategy increases it will ultimately decline and country b ends up choosing the conflict strategy fig 13 in summary there are negative correlations between the parameter w 3 and x v 1 v 3 and y if w 3 is increasing the probability of country a choosing the tolerance strategy decreases if v 1 or v 3 is increasing the probability of country b choosing the compromise strategy declines there are no correlations between the parameters w 1 and x and there is a positive correlation between the parameters w 2 w 4 x and v 2 v 4 y if w 2 or w 4 increases the probability of country a choosing the tolerance strategy also increases if v 2 or v 4 rises the probability of country b choosing the compromise strategy will surge the countries strategic choices are more sensitive to w 3 v 1 v 2 and v 3 than the other influencing parameters as shown in supplementary materials sections 4 5 4 2 discussion through the evolutionary game and system dynamics analysis of transboundary river water sharing problems the authors of this article found that the evolution of transboundary river water allocation conflict depends on the initial state of the conflict and the interests of riparian counties different initial states and benefits will lead to the different evolution approach different strategic choice and different evolutionary equilibrium this has an impact on the relationship among river basin countries and regional socio economic and environmental security using the model constructed in this paper the authors identified three different evolutionary equilibrium strategies the first one is when one country chooses the tolerance strategy another country chooses the compromise strategy in such a case the two countries adopt an unfriendly attitude toward each other in the treatment to solve the existing conflict the second equilibrium is when one country chooses the tolerance strategy another country opt the conflict strategy in such a scenario a potential crisis develops due to the water hegemony the third equilibrium happens when both countries choose the conflict strategy which seriously affects the water use efficiency and socio economic and environmental security within the river basin the probability of the riparian country changing its strategic choice is very sensitive to the other claimant s strategic behavior for the purpose of illustrating these we assumed a hypothetical unidirectional river basin with two riparian countries country a and country b under a scenario where country a chooses the tolerance strategy and the neighboring country b chooses the hegemonic non cooperative utility maximizing strategy conflict strategy in such equilibrium country a is impacted heavily and the probability of it maintaining the status quo choice decreases when country b chooses the conflict strategy and neighboring country a chooses the tolerance strategy country b will try to maintain this equilibrium until the probability of country a changing the tolerance strategy passes the threshold thereby forcing the strategy choice of country b to evolve to a new equilibrium the same phenomenon occurs when country b chooses the tolerance strategy and its neighbor chooses the non cooperative behavior the probability of country b maintaining the tolerance strategy declines until it passes the threshold and a new equilibrium evolves the utility of water also affects the behavior of the countries involved in the water sharing game as the utility of water increases the probability of both countries choosing the conflict strategy rises however under this scenario the probability of this equilibrium shifting to the one where both countries choose the tolerance strategy is high this is because the countries will behave to avoid the loss during the conflict generally when one chooses the conflict strategy and the other options to tolerance strategy the probability of the one changing its strategic choice is not sensitive as compared to its neighbor s when both choose the conflict strategy or the tolerance strategy the equilibrium evolves very slowly with the economic development population growth urbanization and anthropogenic climate change the risk of water shortages have become one of the most serious problems in the world these factors are also exacerbating the uncertainty in the availability of water and posing a major challenge to water resources management in the world this has become a new normal that riparian countries of transboundary river basins have to deal with the historical economic social and ecological water use differences among riparian countries make the water sharing problem a challenging issue as a result cooperation and conflict have been the most talked about features of the internationally shared river basins zeitoun and mirumachi 2008 therefore it is necessary to adopt corresponding measures to strengthen cooperation and alleviate any issues that can arise as the result of lack of equity in terms of water use firstly riparian countries should build cooperation based on including all the diverse water using sectors cooperation can involve different sectors such as navigation power generation or agriculture in addition environmental monitoring information sharing and joint development should be promoted to ensure integrated water resources management secondly principles of equitable and reasonable distribution need to be mainstreamed in all water sharing negotiations lankford 2013 the fact that the basin countries have differences in terms of their water consuming infrastructures should also be considered balancing the interests of the riparian states and clearly stating their rights and obligations is important to promote equitable and reasonable water sharing thirdly riparian countries should consider the basic human needs and ecological needs of other countries to avoid water conflicts that could lead to severe socio economic and environmental disruptions the convention on the law of the non navigational uses of international watercourses un 1997 and the helsinki rules on the uses of the waters of international rivers international law association 1967 clearly state the importance of water for sustaining humanity s way of life and ecosystems salman 2007 ignoring the water demand of human and natural ecosystems could cause military confrontations and irreversible ecological deterioration that will have a serious negative impact on the sustainable development of river basin countries fourthly riparian countries should design a water diplomacy framework islam and susskind 2012 attach importance to each other s interdependence identify the causes of conflicts and implement effective management of water resources in the basin based on the principles of fairness and sustainability relying on scientific evidence and practical experiences islam and susskind 2018 such an approach will transform the zero sum game into benefit sharing to achieve a win win scenario finally with the global climate changing the uncertainty of water availability is increasing and transboundary river water conflicts and water scarcity have become the focus of global concern it is not a problem for one riparian country it needs all the riparian countries to cooperate with each other to overcome the administrative boundaries of the basin and implement basin wide integrated water resources management system al saidi 2017 in a nutshell in order to solve water conflicts within transboundary rivers basin countries should cooperate with each other and construct a harmonious water allocation mechanism such as establishing an allocation agreement and take group actions according to the agreement to reduce the risk of water disputes and promote water resources development and utilization honkonen and lipponen 2018 building a negotiation mechanism to decide on water allocations and coordinate the behavior of different countries zagonari and rossi 2014 launching a coordination scheme and design an integrated water resources management framework to maximize individual and group utilities this paper provides a novel way to simulate and forecast the interaction and the strategy choice of basin countries within transboundary river basins but in reality water conflicts are more complex hence when interpreting the results of this article readers should take the assumptions of the paper into account in addition the article did not consider all the possible combination of scenarios the authors believe that this is a topic that needs to be addressed through further research furthermore how to further demonstrate the theoretical insights using a case study for better interpretation and simulation of water allocation conflicts based on the evolutionary game and system dynamic model is open to further research 5 conclusion and recommendations sdg 6 5 sustainable development goals 6 5 target promotes the need for integrated water resources management such a scheme will help avoid fragmented water management systems un 2015 this will in turn avoid water conflicts and ecological deterioration this article attempted to provide insights into the factors that determines the evolution of concession and conflicts by considering the river sharing problem as a system water sharing problems arise when the total water claim within a shared river basin is bigger than the water available for consumption this problem has dynamic behavior that evolves through time as the factors affecting the water allocation change when the river basin is international the problem becomes even more complex and hard to address because the way the stakeholders depend on the rivers socially economically and environmentally differs this is the main reason why water conflicts are hard to solve this paper through the evolutionary game and system dynamics build a simulation model that determines equilibrium and what its consequences are the following conclusions can be drawn from analyzing the results of the article 1 the results of the simulation showed that under asymmetric information the equilibrium doesn t always develop into a peaceful scenario 2 increasing the loss and cost of conflict does not always drive the equilibrium into a concession 3 inequality in terms of the utility derived per unit of water affects the decision making of the stakeholders with asymmetric social economic and environmental profiles therefore the basin countries should respect and balance their interests to resolve the water allocation conflicts within their shared river basins the basin countries need to reasonably manage their strategic choices because their choice will not only influence their own payoff but also affect other countries strategy choices and payoffs directly dulal 2014 once they cause losses to other countries and pressure them to reach the threshold point the change in strategic decision making will cause the activation of the strategic choices of all parties this will give birth to water conflicts and cause a serious negative impact in the river basins beyers et al 2011 therefore the basin countries cannot only consider their own interests when they choose the strategy but also have to consider the profit and loss of the other countries in order to solve the water conflicts of transboundary rivers the basin countries should strengthen their understanding of the problem s complexity nuances and possible solutions furthermore having faith in their own problem solving ability to negotiate integrative solutions will help to ensure engagement in communication that is clear and accurate liu 2014 the resolution of water resources conflicts is an opportunity and bridge to strengthen the cooperation and ultimately improve the utilization of water resources in the basin countries and achieve win win solutions among the river basin countries it is necessary to strengthen transboundary river water resources cooperation from the following aspects firstly the basin countries should adhere to the principles of absolute territorial sovereignty and integrity as well as the international water law houba et al 2013 correctly handle contradictions between these principles secondly the basin countries should design the appropriate management modes which combine the advantage of integrated and adaptive water resources management to combat the impacts of anthropogenic climate change on the water resources they share kindler 2000 xia et al 2012 thirdly the basin countries should shelve disputes and insist on benefit sharing sign a cooperation treaty to provide a solid legal basis for sharing and management of the water resources arjoon 2016 fourthly the basin countries should improve the resolution mechanism of water conflicts clarify the procedures for water conflict resolution ryu et al 2010 incorporate water conflicts into the procedural mechanism emphasize the benefits compensation of water transfer yen and chen 2001 and balance the interests of the river basin countries funding this research was funded by the national natural science foundation of china grant no 71874101 declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2019 124521 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
5812,water is the backbone of socio economic and environmental systems increasing demand and unpredictable availability due to anthropogenic climate change is making water an extremely scarce resource in different parts of the world when the resources facing scarcity are shared between different administrative boundaries conflicts could arise transboundary river basins are typical examples water sharing problems within these transboundary river basins are very difficult to solve because of the socio economic and environmental asymmetries among the water claiming stakeholders in addition water sharing problems have a systemic feature that evolves through time previous studies did not comprehensively capture these features this article attempts to fill this research gap by combining the evolutionary game and system dynamic model to predict the equilibrium outcomes of different strategic scenarios when the riparian states choose polarizing strategies the equilibrium evolves either quickly initiated by the countries need to avoid the loss that could result from water conflict or very slowly if the countries opt to maintain the benefits that result from their polarized strategies in the scenario where both choose a tolerance strategy the equilibrium evolves very slowly if either of the countries chooses a polarizing strategy irrespective of its neighbor choosing a compromise strategy the equilibrium evolves much faster the results depicted that the equilibrium under different scenarios does not always lead to concessions therefore the countries should strengthen the cooperation in water resource management to ensure that a zero sum game and the inception of a new strategic evolution are prevented keywords transboundary river water allocation conflict evolutionary game theory system dynamics 1 introduction with the population growth economic development and climate change the global water demand has been increasing rapidly on the contrary the amount of available fresh water for consumption is becoming unpredictable through time and space yuan et al 2019 at present about 3 6 billion people live in water scarce areas and in 2050 this number is expected to increase by 30 mekonnen and hoekstra 2016 hence more and more countries will face serious water shortages in the near future there are 286 transboundary rivers that run through 151 countries twap 2011 these basins include more than 2 8 billion people cover 62 million km2 and produce around 22 000 km3 of river discharge each year twap 2011 as a result these river basins are the backbones of social economic and environmental systems zhang et al 2019 during the periods of water scarcity riparian countries usually exhibit utility maximizing behavior competing for more water such strategic behavior could lead to either cooperation or conflict transboundary river water conflict is a complex problem which is related to the multi stakeholder benefit sharing dombrowsky 2009 and multi system casual feedback loop duran encalada et al 2016 xu et al 2019 if the water sharing problem is not addressed in time it could lead to water conflicts that may disturb the social economic and environmental systems degefu et al 2016 and decrease the efficient utilization of the rivers water capital an et al 2018 therefore understanding how water conflicts evolve is very important effectively identifying the formation of water conflict can serve as a base to establish a rational mechanism for resolving water conflict aiming to find a way to solve water conflicts in transboundary river basins a vast number of researchers have carried out studies on the causes of water conflict water sharing behavior of riparian countries and solutions to conflicts finding the factors that catalyze water conflicts is a key step to find the solutions to water sharing problems in transboundary river basins these factors can be classified as internal and external a transboundary river is characterized by unidirectional flow multiple tributaries spatial temporal differences in terms of runoff contribution among the country basin units degefu et al 2018 the fact that valuation of water is not internalized in the water using the economy tang et al 2011 and the quasi public nature of water resources dinar et al 2013 are the internal causes of water sharing problems in a transboundary river climate change and environmental pollution kalogeropoulos and chalkias 2013 population growth economic development nasem 2018 and lack of integrated water resources management funder 2010 petersen perlman et al 2017 are some of the external causes of water conflict in transboundary rivers these factors determine the seriousness and intensity of water conflicts the evolution of water conflicts within transboundary river basins is depicted by the change in the strategic decision making behavior of stakeholders raquel et al 2007 yang et al 2008 wei et al 2009 mehrparvar et al 2015 podimata and yannopoulos 2015 zomorodian et al 2017 studied the competitive behavior of the water sharing agents using non cooperative and cooperative game theory in addition these past studies explored the choice framework and response strategy of water claimants most of these past studies focused on analyzing water conflicts qualitatively and did not take into account their dynamic feature however it is very important to analyze the dynamic evolution process of water conflicts from the quantitative perspective to improve the water resources management efficiency system dynamics is a computer simulation method for studying information feedback loops of complex systems it can be applied to understand water sharing problems and provide a comprehensive structure to simulate the degree of the water dispute yuan et al 2018 due to the fact that the strategies of countries affect each other s behavior evolutionary games are a natural study approach whenever any external factors changes the behavior of the agents involved over time friedman 1998 therefore this paper built an evolutionary game model and simulated the game behavior of basin countries based on system dynamics and as such an approach increases the prediction accuracy better than traditional game models 2 a game theoretical model of water sharing problems within a transboundary river basin the essence of transboundary river water sharing problems is the fact that the available water resource is not adequate to satisfy the total water claim when each country tries to maximize their utility they withdraw more water and this triggers water disputes the water sharing problem appears as an asymmetric dynamic evolution game motro 1994 cao 2013 the following assumptions were considered in this article when building the evolutionary game model for water sharing problems within a transboundary river basin assumption 1 country a and country b are located within a transboundary river basin country a withdraws less water than country b for various geographical and historical reasons under water scarcity conditions country a demands that country b reduce its water consumption q in order to mitigate its water shortage problem assumption 2 country a has two strategic selections conflict with country b for more water conflict strategy or tolerate water scarcity tolerance strategy country b also has two different strategic options reduce its water consumption q compromise strategy or compete with a for more water conflict strategy assumption 3 in country a the utility from q amount of water is w 1 in country b the utility from q amount of water is v 1 assumption 4 if country a chooses the tolerance strategy and country b chooses the compromise strategy country a gets q amount of water if country a chooses the tolerance strategy and country b chooses the conflict strategy the loss of country a is represented as w 3 the cost of conflict for country b is v 2 if country a chooses the conflict strategy and country b chooses the compromise strategy the cost of conflict for country a is w 2 the loss of country b from the water conflict is v 3 if country a chooses the conflict strategy and country b chooses the conflict strategy countries a and b will suffer the loss of w 4 and v 4 respectively assumption 5 the goal of both countries is to maximize their own payoff based on the above assumptions the payoff matrix of countries a and b is constructed as follows country b compromise conflict country a tolerance w 1 0 w 3 v 1 v 2 conflict w 1 w 2 v 3 w 2 w 4 v 1 v 2 v 4 3 evolutionary game and system stability analysis if the probability of country a choosing the tolerance strategy is x then the probability of country a choosing the conflict strategy is 1 x if the probability of country b choosing the compromise strategy is y then the probability of country b choosing the conflict strategy is 1 y therefore the expected payoff from the two strategies for country a are u 11 and u 12 respectively 1 u 11 y w 1 1 y w 3 2 u 12 y w 1 w 2 1 y w 2 w 4 the average payoff of country a is u 11 3 u 1 x u 11 1 x u 12 the replicated dynamic equation f x of country a is obtained by combining the equations 1 and 3 4 f x dx dt x μ 11 μ 1 x 1 x w 3 y w 4 y w 2 w 3 w 4 then 5 f x 1 2 x w 3 y w 4 y w 2 w 3 w 4 if f x 0 x is the steady point of the replicated dynamic equation therefore x 1 0 and x 2 1 are stable strategies of country a under the different scenarios y w 3 w 2 w 4 w 3 w 4 y w 3 w 2 w 4 w 3 w 4 y w 3 w 2 w 4 w 3 w 4 the dynamic evolution paths of country a are shown in fig 1 supplementary material section 1 the same method is used to analyze the stable evolution strategy of country b under the different scenarios x v 1 v 2 v 3 v 4 v 3 v 4 x v 1 v 2 v 3 v 4 v 3 v 4 x v 1 v 2 v 3 v 4 v 3 v 4 the dynamic evolution paths of country b are shown in fig 2 supplementary material section 2 in summary the threshold probability of country a s and country b s strategy is v 1 v 2 v 3 v 4 v 3 v 4 w 3 w 2 w 4 w 3 w 4 as shown in fig 3 the evolution of the game depends on the strategic choice probability of both countries the replicated dynamic equations of both countries constitute the dynamic replication system of the water allocation conflict game the partial equilibrium points of the system constitute the equilibrium of the evolutionary game which is the evolutionary stable strategy ess of both countries the partial equilibrium point can be obtained by the partial equilibrium analysis of the determinant and trace of the jacobian matrix are det j and tr j he et al 2013 kang and udiani 2014 gao et al 2019 supplementary material section 3 if det j 0 and tr j 0 the equilibrium point is the ees of both countries the det j and tr j of five equilibrium points a 0 0 b 0 1 c 1 0 d 1 1 e v 1 v 2 v 3 v 4 v 3 v 4 w 3 w 2 w 4 w 3 w 4 as follows where t v 1 v 2 v 3 v 4 v 1 v 2 v 3 v 4 w 2 w 3 w 2 w 4 w 3 w 4 and assuming that o w 2 w 3 w 4 it means that if country b chooses the conflict strategy the payoffs from the two different strategies are not the same for country a p v 1 v 2 v 3 v 4 it means that if country a chooses the conflict strategy the payoffs from the two different strategies are not the same for country b q v 1 v 2 which means that if country a chooses the tolerance strategy the payoffs for country b from the two different strategies are not the same according to table 1 the variables o p and q are the key determining parameters of the evolutionary stability strategies under the following scenarios 1 o 0 p 0 q 0 2 o 0 p 0 q 0 3 o 0 p 0 q 0 the evolutionary stability point is 1 1 the replicated dynamic phase map is shown in fig 4 the ees of country a and country b are the tolerance strategy and compromise strategy respectively under the following scenarios 4 o 0 p 0 q 0 5 o 0 p 0 q 0 the evolutionary stability point is 1 0 the replicated dynamic phase map is shown in fig 5 the ees of country a and country b are the tolerance strategy and conflict strategy respectively under the scenario 6 o 0 p 0 q 0 the evolutionary stability points are 1 1 0 0 the replicated dynamic phase map is shown in fig 6 the ees of country a and country b are the tolerance strategy and compromise strategy respectively or both country a and country b choose the conflict strategy under the scenario 7 o 0 p 0 q 0 the evolutionary stability point is 0 0 the replicated dynamic phase map is shown in fig 7 the ees of country a and country b is the conflict strategy under the scenario 8 o 0 p 0 q 0 there is no evolutionary stable point the replicated dynamic phase map is shown in fig 8 based on the analysis of the evolutionary game of water allocation conflict in the transboundary river basin the ees under different scenarios are depicted in table 2 4 simulation results and discussion 4 1 simulation results 4 1 1 construction of the system dynamics model for water sharing problem the evolutionary game integrated with system dynamics model for understanding transboundary river water sharing problems is established by venism pls software vensim is simulation software for continuous simulation it has discrete event and agent based modelling capabilities sadeghi et al 2015 as shown in fig 9 the model consists of 4 level variables 2 flow variables 8 external variables and 16 intermediate variables the 4 level variables represent the probability of strategic choices of country a and country b respectively the 2 flow variables represent the change rate of the probability selections of country a and country b respectively the 8 external variables correspond to the 8 variables in the payoff matrix respectively the times of simulation was set as 25 times the initial values of each external variable are shown in table 3 under this scenario o 7 p 1 q 1 according to scenario 6 shown in table 2 the equilibrium points of the system are 0 0 and 1 1 assuming that the initial state x 1 y 0 01 country a chooses the tolerance strategy while country b chooses the conflict strategy with the probability of 99 the evolutionary game process of both parties is shown in fig 10 with the increase simulation time the probability of country b choosing the compromise strategy gradually increases from 0 01 to 1 the system eventually stabilizes at the point of 1 1 which indicates that if country a chooses the tolerance strategy even if the probability of country b choosing the compromise strategy is very low initially gradually country b will eventually choose the compromise strategy to maximize its interests assuming that the initial state y 0 x 0 99 country b chooses the conflict strategy while country a chooses the tolerance strategy with the probability of 99 as the simulation time increases the probability of country a selecting the tolerance strategy gradually decreases from 0 99 to 0 and the system eventually stabilizes at the stable point of 0 0 which indicates that if country b chooses the conflict strategy even if the probability of country a choosing the tolerance strategy is very high initially it will gradually choose the conflict strategy to maximize its interests the evolutionary game process of both countries is shown in fig 11 4 1 2 impact of external variables of countries on their strategy choice the external variables of country a b will influence the strategic choices of country a b directly two batch simulations to identify the influence of the internal and external variables that affect the decision making of country a and country b was conducted the range for the values of the variables was kept within 10 the change rate range was assumed to be 10 10 simulation batch 1 was done to understand the impact of the variables on country a s decision making it was done assuming that initially country b chooses the equilibrium strategy and country a chooses the tolerance strategy with 50 probability while simulation batch 2 was done to study the role of the variables on country b s strategic choices assuming that initially country a chooses the equilibrium strategy and country b chooses the compromise strategy with 50 probability from the results it can be seen that the loss and cost of conflict has a direct relationship with the probability of changing strategic choices of the stake holders in a water sharing problem with increasing w 2 or w 4 the probability of country a choosing the tolerance strategy increases and eventually country a s strategic decision evolves to a non cooperative utility maximizing behavior however surprisingly the strategic choice of country a was found not to be sensitive to the utility obtained from q amount of water fig 12 for country b with the increase of v 1 the probability of country b choosing the compromise strategy decreases and evolves to eventually choose the conflict strategy the probability of country b choosing the compromise strategy decreases with the decline of v 2 finally country b chooses the conflict strategy with the increase of v 2 the probability of country b choosing the compromise strategy increases initially but v 2 does not reach the threshold point within the change rate interval of 10 0 as a result the probability tends to follow a decreasing trend and in the end country b chooses the conflict strategy the probability of country b choosing the compromise strategy increases initially with the decrease of v 3 but within the change rate interval of 10 0 v 3 does not reach the threshold point hence the probability follows a decreasing trend and country b chooses the conflict strategy country b ends up choosing the conflict strategy with the decrease of v 4 hence the probability of country b choosing the compromise strategy decreases but v 4 fails to reach the threshold point within the change range of 10 0 as a result even though initially with the increase of v 4 the probability of country b choosing the compromise strategy increases it will ultimately decline and country b ends up choosing the conflict strategy fig 13 in summary there are negative correlations between the parameter w 3 and x v 1 v 3 and y if w 3 is increasing the probability of country a choosing the tolerance strategy decreases if v 1 or v 3 is increasing the probability of country b choosing the compromise strategy declines there are no correlations between the parameters w 1 and x and there is a positive correlation between the parameters w 2 w 4 x and v 2 v 4 y if w 2 or w 4 increases the probability of country a choosing the tolerance strategy also increases if v 2 or v 4 rises the probability of country b choosing the compromise strategy will surge the countries strategic choices are more sensitive to w 3 v 1 v 2 and v 3 than the other influencing parameters as shown in supplementary materials sections 4 5 4 2 discussion through the evolutionary game and system dynamics analysis of transboundary river water sharing problems the authors of this article found that the evolution of transboundary river water allocation conflict depends on the initial state of the conflict and the interests of riparian counties different initial states and benefits will lead to the different evolution approach different strategic choice and different evolutionary equilibrium this has an impact on the relationship among river basin countries and regional socio economic and environmental security using the model constructed in this paper the authors identified three different evolutionary equilibrium strategies the first one is when one country chooses the tolerance strategy another country chooses the compromise strategy in such a case the two countries adopt an unfriendly attitude toward each other in the treatment to solve the existing conflict the second equilibrium is when one country chooses the tolerance strategy another country opt the conflict strategy in such a scenario a potential crisis develops due to the water hegemony the third equilibrium happens when both countries choose the conflict strategy which seriously affects the water use efficiency and socio economic and environmental security within the river basin the probability of the riparian country changing its strategic choice is very sensitive to the other claimant s strategic behavior for the purpose of illustrating these we assumed a hypothetical unidirectional river basin with two riparian countries country a and country b under a scenario where country a chooses the tolerance strategy and the neighboring country b chooses the hegemonic non cooperative utility maximizing strategy conflict strategy in such equilibrium country a is impacted heavily and the probability of it maintaining the status quo choice decreases when country b chooses the conflict strategy and neighboring country a chooses the tolerance strategy country b will try to maintain this equilibrium until the probability of country a changing the tolerance strategy passes the threshold thereby forcing the strategy choice of country b to evolve to a new equilibrium the same phenomenon occurs when country b chooses the tolerance strategy and its neighbor chooses the non cooperative behavior the probability of country b maintaining the tolerance strategy declines until it passes the threshold and a new equilibrium evolves the utility of water also affects the behavior of the countries involved in the water sharing game as the utility of water increases the probability of both countries choosing the conflict strategy rises however under this scenario the probability of this equilibrium shifting to the one where both countries choose the tolerance strategy is high this is because the countries will behave to avoid the loss during the conflict generally when one chooses the conflict strategy and the other options to tolerance strategy the probability of the one changing its strategic choice is not sensitive as compared to its neighbor s when both choose the conflict strategy or the tolerance strategy the equilibrium evolves very slowly with the economic development population growth urbanization and anthropogenic climate change the risk of water shortages have become one of the most serious problems in the world these factors are also exacerbating the uncertainty in the availability of water and posing a major challenge to water resources management in the world this has become a new normal that riparian countries of transboundary river basins have to deal with the historical economic social and ecological water use differences among riparian countries make the water sharing problem a challenging issue as a result cooperation and conflict have been the most talked about features of the internationally shared river basins zeitoun and mirumachi 2008 therefore it is necessary to adopt corresponding measures to strengthen cooperation and alleviate any issues that can arise as the result of lack of equity in terms of water use firstly riparian countries should build cooperation based on including all the diverse water using sectors cooperation can involve different sectors such as navigation power generation or agriculture in addition environmental monitoring information sharing and joint development should be promoted to ensure integrated water resources management secondly principles of equitable and reasonable distribution need to be mainstreamed in all water sharing negotiations lankford 2013 the fact that the basin countries have differences in terms of their water consuming infrastructures should also be considered balancing the interests of the riparian states and clearly stating their rights and obligations is important to promote equitable and reasonable water sharing thirdly riparian countries should consider the basic human needs and ecological needs of other countries to avoid water conflicts that could lead to severe socio economic and environmental disruptions the convention on the law of the non navigational uses of international watercourses un 1997 and the helsinki rules on the uses of the waters of international rivers international law association 1967 clearly state the importance of water for sustaining humanity s way of life and ecosystems salman 2007 ignoring the water demand of human and natural ecosystems could cause military confrontations and irreversible ecological deterioration that will have a serious negative impact on the sustainable development of river basin countries fourthly riparian countries should design a water diplomacy framework islam and susskind 2012 attach importance to each other s interdependence identify the causes of conflicts and implement effective management of water resources in the basin based on the principles of fairness and sustainability relying on scientific evidence and practical experiences islam and susskind 2018 such an approach will transform the zero sum game into benefit sharing to achieve a win win scenario finally with the global climate changing the uncertainty of water availability is increasing and transboundary river water conflicts and water scarcity have become the focus of global concern it is not a problem for one riparian country it needs all the riparian countries to cooperate with each other to overcome the administrative boundaries of the basin and implement basin wide integrated water resources management system al saidi 2017 in a nutshell in order to solve water conflicts within transboundary rivers basin countries should cooperate with each other and construct a harmonious water allocation mechanism such as establishing an allocation agreement and take group actions according to the agreement to reduce the risk of water disputes and promote water resources development and utilization honkonen and lipponen 2018 building a negotiation mechanism to decide on water allocations and coordinate the behavior of different countries zagonari and rossi 2014 launching a coordination scheme and design an integrated water resources management framework to maximize individual and group utilities this paper provides a novel way to simulate and forecast the interaction and the strategy choice of basin countries within transboundary river basins but in reality water conflicts are more complex hence when interpreting the results of this article readers should take the assumptions of the paper into account in addition the article did not consider all the possible combination of scenarios the authors believe that this is a topic that needs to be addressed through further research furthermore how to further demonstrate the theoretical insights using a case study for better interpretation and simulation of water allocation conflicts based on the evolutionary game and system dynamic model is open to further research 5 conclusion and recommendations sdg 6 5 sustainable development goals 6 5 target promotes the need for integrated water resources management such a scheme will help avoid fragmented water management systems un 2015 this will in turn avoid water conflicts and ecological deterioration this article attempted to provide insights into the factors that determines the evolution of concession and conflicts by considering the river sharing problem as a system water sharing problems arise when the total water claim within a shared river basin is bigger than the water available for consumption this problem has dynamic behavior that evolves through time as the factors affecting the water allocation change when the river basin is international the problem becomes even more complex and hard to address because the way the stakeholders depend on the rivers socially economically and environmentally differs this is the main reason why water conflicts are hard to solve this paper through the evolutionary game and system dynamics build a simulation model that determines equilibrium and what its consequences are the following conclusions can be drawn from analyzing the results of the article 1 the results of the simulation showed that under asymmetric information the equilibrium doesn t always develop into a peaceful scenario 2 increasing the loss and cost of conflict does not always drive the equilibrium into a concession 3 inequality in terms of the utility derived per unit of water affects the decision making of the stakeholders with asymmetric social economic and environmental profiles therefore the basin countries should respect and balance their interests to resolve the water allocation conflicts within their shared river basins the basin countries need to reasonably manage their strategic choices because their choice will not only influence their own payoff but also affect other countries strategy choices and payoffs directly dulal 2014 once they cause losses to other countries and pressure them to reach the threshold point the change in strategic decision making will cause the activation of the strategic choices of all parties this will give birth to water conflicts and cause a serious negative impact in the river basins beyers et al 2011 therefore the basin countries cannot only consider their own interests when they choose the strategy but also have to consider the profit and loss of the other countries in order to solve the water conflicts of transboundary rivers the basin countries should strengthen their understanding of the problem s complexity nuances and possible solutions furthermore having faith in their own problem solving ability to negotiate integrative solutions will help to ensure engagement in communication that is clear and accurate liu 2014 the resolution of water resources conflicts is an opportunity and bridge to strengthen the cooperation and ultimately improve the utilization of water resources in the basin countries and achieve win win solutions among the river basin countries it is necessary to strengthen transboundary river water resources cooperation from the following aspects firstly the basin countries should adhere to the principles of absolute territorial sovereignty and integrity as well as the international water law houba et al 2013 correctly handle contradictions between these principles secondly the basin countries should design the appropriate management modes which combine the advantage of integrated and adaptive water resources management to combat the impacts of anthropogenic climate change on the water resources they share kindler 2000 xia et al 2012 thirdly the basin countries should shelve disputes and insist on benefit sharing sign a cooperation treaty to provide a solid legal basis for sharing and management of the water resources arjoon 2016 fourthly the basin countries should improve the resolution mechanism of water conflicts clarify the procedures for water conflict resolution ryu et al 2010 incorporate water conflicts into the procedural mechanism emphasize the benefits compensation of water transfer yen and chen 2001 and balance the interests of the river basin countries funding this research was funded by the national natural science foundation of china grant no 71874101 declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2019 124521 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
5813,real time coupling of a hydro environmental model and an optimization model is difficult because hydrodynamic model hdm and scalar transport model stm are both time consuming especially when the computational domain is large e g river lake system this study presents a new 1d hydro environmental model for free surface flows and scalar transport in large river lake systems using a prediction correction method hydrodynamic is simulated by solving local linear systems based on domain decomposition a flux form eulerian lagrangian method elm is constructed to solve advective transport of scalars in 1d grid systems and a nested technique is proposed to reduce its startup cost the resulting stm and hdm both allow large time steps for which the courant friedrichs lewy number cfl is greater than 1 and they are parallelized using the open multiprocessing technique openmp moreover the stm is good at solving multiscalar transport and has low startup cost the new model is tested using the jing dongting jdt system which is covered by a grid of 2382 cells with 113 600 sub grids stable and accurate simulations are achieved at large time steps for which the cfl can be larger than 5 a sequential run of the new model runs tens of times faster than that of a conventional 1d model such as the mike11 moreover the efficiency of the new model can be further improved by the openmp parallel technique in the test of scale property of the hdm stm model using 32 kinds of scalars and 16 cores a parallel run is 11 8 times faster than a sequential run and it only takes the new model 33 3 s to complete a simulation of a 1 year process of unsteady flow and scalar transport in the jdt system keywords river lake system free surface flow scalar transport local solution eulerian lagrangian method parallel computing 1 introduction in the management of river lake systems rapid decisions are often required to cope with the emergency events of dangerous floods and sudden water pollutions where calculations of hydrodynamic and scalar transport are involved in these scenarios an optimization model is also often introduced to help doing decision making and it requires thousands of calls of the hydrodynamic model hdm and scalar transport model stm it is expected that the hdm and the stm run as fast as possible to provide data for the real time calls the hdm and stm respectively based on the saint venant and the transport equations have been long developed for real applications and revealed to provide accurate simulations li et al 2014 du et al 2018 to achieve a real time hydro environmental simulation for a large river lake system the hdm and stm are both required to allow large computational time steps and also they are expected to be parallelizable moreover real hydro environmental applications often need to simulate the transport of tens of different scalars for each of which one transport equation must be solved this issue is called multiscalar transport a stm should be able to solve the time consuming multiscalar transport efficiently the hdms may be divided into explicit and implicit ones parallelization of explicit hdms is straightforward but the time step of such models is often limited by the courant friedrichs lewy cfl number restriction implicit hdms e g hec 2010 casulli and stelling 2013 are more attractive for their large time steps but they have to solve a large linear nonlinear system arising from the velocity pressure coupling where iterative solutions are required the parallel implementation of the iterative solutions of these algebraic systems is often difficult and inefficient e g for the popular partitioned matrix method based on domain decomposition bjørndalen 2003 fringer et al 2006 jankowski 2009 nesterov 2010 the overhead arising from frequent data exchanges among subdomains may be significant and limit the speedup of a parallel code generally alluvial river lake systems are filled with gradually varied subcritical free surface flows zhu et al 2011 for such flows a multi dimensional implicit hdm using domain decomposition is developed in hu et al 2015a where a prediction correction method pcm is proposed to solve the resulting subsystems in parallel using the pcm the hydrodynamic of a river lake system is simulated by solving local linear systems which can be well parallelized the performance of a stm relates closely to the solution of advection terms which is often calculated explicitly using eulerian schemes e g the popular finite volume method that can conserve mass well the time step of these eulerian schemes is also limited by the cfl stability condition although a sub cycling casulli and zanolli 2002 wang et al 2008 can be used to alleviate the cfl restriction the dependence of solutions among neighbor substeps in the subcycling determines that the explicit eulerian advection schemes using a sub cycling cannot be well parallelized as an explicit advection scheme the eulerian lagrangian method elm allows large time steps for which the cfl can be greater than 1 and is parallelizable moreover the elm is good at solving the multiscalar transport by reusing trajectory tracking information dukowicz and baumgardner 2000 lauritzen et al 2010 however the application of a traditional pointwise elm is often limited by two defects of the non conservation gross et al 2002 and the high startup cost associated with trajectory tracking on the one hand much effort has been devoted to finding ways to construct a conservative elm during the past three decades especially in the realm of atmosphere modeling at least six kinds of conservative elms have been reported in the literature which are respectively the cell integration and remapping method e g rancic 1995 the flux form method e g harris et al 2011 the localized adjoint method e g russell and celia 2002 the posteriori correction method e g oliveira and fortunato 2002 the constrained interpolation profile method e g tanaka et al 2000 and the weight interpolation weight balancing method e g lentine et al 2011 hu et al 2017 2019 found a mechanism to eliminate the unphysical oscillations in the construction of a conservative elm and successfully rebuilt some of the above conservative elms for multidimensional simulations of scalar transport in shallow water systems on the other hand to our best knowledge studies on the methods of cutting the high startup cost of the elm applied to stms have not been reported yet this study is aimed to achieve real time simulation of hydrodynamic and scalar transport in large shallow water systems so that the hydro environmental model is efficient enough to be nested in an optimization model the hydrodynamic is simulated by solving local linear systems based on domain decomposition a flux form elm and nested technique are proposed to solve scalar transport in 1d grid systems the accuracy stability and efficiency of the new models are then tested using a real river lake system and compared with existing models 2 study area the jing dongting jdt river lake system is a large scale 3900 km2 strongly coupled shallow water system comprising the jing river the upper part of the middle yangtze river dongting dt lake and jing south js river networks see fig 1 one of its inflow entrances is at zhicheng on the jing river 100 km downstream of the three gorges reservoir tgr twelve percent of the inflow of the jing river runs through the js river networks and then enters the dt lake additionally four inflows from the xiang zi yuan and li rivers are received stored by the dt lake and then drained downstream the only outflow from the dt lake and the lower jing river converge at chenglingji moreover the jdt system has a compound floodplain channel cross section leading to various flow regimes in different seasons for example the dt lake acts as a lake when fully flooded in flood seasons but has only river like flows passing through narrow channels in dry seasons since the tgr began to regulate runoff and trap sediment in 2003 new hydrological processes and river lake relations in jdt system have been gradually formed resulting in many problems of flood defense water resource hydro environment etc the hydrodynamics and scalar transport in the jdt system have been widely studied in china chen et al 2012 li et al 2009 and serve as basic knowledge for other researches 3 methods 3 1 governing equations of numerical models the 1d saint venant equations eqs 1 and 2 and the advection diffusion equation eq 3 are respectively used as the governing equations of the hdm and the stm they are given by 1 b η t a u x q 2 u t u u x g η x g n m 2 u u r 4 3 3 ac t uac x x υ c a c x s o where a wet cross sectional area m2 b wet surface width of a cross section m u cross section averaged velocity of x direction m s t time s η water level measured from an undisturbed reference water surface m q lateral inflow per unit length m2 s g gravity acceleration m s2 nm manning s roughness coefficient m 1 3s r hydraulic radius m c scalar concentration kg m3 so source term of a scalar kg m2 s and υc diffusion coefficient of a scalar m2 s 3 2 description of river lake system and computational grid the developed hdm and stm both use a local solution of the governing equations see sections 3 3 and 3 4 correspondingly the river lake system is divided into and described by branches linked by junctions each branch is covered by a set of 1d cells elements the control volume generated for a junction is defined as the junction cell for which the number of connected branches can be arbitrary a non junction cell only has two cell faces sides while a junction cell can have more than two cell faces the side shared by a junction cell is defined as the junction side for both non junction and junction cells a cross section cs with general topographical data bathymetry is arranged at the center of the cell the cell at the two ends of an internal branch is either a junction cell or is connected to a junction cell a junction cell does not stand alone but is arranged into the branch that has the largest river width around the junction as a default arrangement the ne and ns are respectively used to denote the quantities of cells and sides in the computational grid the number of the branches is denoted by nr and the cell quantities of the branches are sequentially denoted by n 1 n 2 nnr every cell side has a unique global cell side index branch k is taken as an example to illustrate the relations between the global and the local indices as follows we stipulate that the cells of branch k take up a successive section of the global indices of the cell sequence of river lake system denoted by i 1 i 2 i nk and otherwise arbitrary numberings are allowed a mapping is defined between the local indices of the cells in branch k and their global indices for branch k the cells with local indices 1 2 nk in sequence correspond to the cells with global indices i 1 i 2 i nk a similar mapping is also defined between the local indices of the sides in branch k and their global indices moreover notations with a global index see fig 2 are defined to describe the complex topology relations among cells and sides in different branches and the definitions of these notations are similar to those in hu et al 2015a these notations with a global index are mainly used at end cells to find their neighboring cells sides in a different branch for the calculation of the gradients of certain variables e g water levels and scalar concentrations a staggered grid of variable arrangement is used the u is defined at side centers whereas the η and c are defined at cell centroids see fig 2 for cell i local index δxi represents the length of the 1d cell the length of a junction cell is set to the width of the neighboring reach which is at the same branch as the cell bi is the wet surface width of cell i and is related to ηi that varies with respect to time ai is the conveyance area of cell i which is obtained by integrating the water depth related to ηi along the cs for side j i 1 2 which connects cells i and i 1 δxi 1 2 is the distance between the centers of cells i and i 1 ai 1 2 and ri 1 2 are the conveyance area and the hydraulic radius at side j respectively and they are interpolated from those of neighboring cells a common sub grid method usually adopted in 1d models hec 2010 mike11 2014 is used to describe the geometry of a cs applying a stepwise approximation to the cs the topography of a sub grid is represented by the average elevation of its two nodes dry and wet alternation of the grid is simulated using the method of the conventional critical water depths the dry and wet states of a cell and a sub grid are defined by two critical water depths respectively the h 0 0 01 m and the h k 0 001 m when the water level of a cell is h 0 higher than the elevation of its lowest sub grid denoted by zb lsg this cell is defined as wet the wet cells are included in the computation of the next time step while the dry ones will not 3 3 formulation of hdm the hdm follows a classic θ semi implicit formulation casulli and stelling 2013 using the pcm hu et al 2015a 2015b the hydrodynamics in a river lake system especially the velocity pressure coupling is solved locally based on domain decomposition benefiting from local solutions the hdm only needs to solve pure 1d problems the hdm requires only solutions of 1d subsystems for branches while solution of large multi dimensional algebraic systems for the whole river lake system is not needed calculation of a branch is introduced as follows momentum equations are solved within a finite difference framework and using operator splitting techniques to eliminate stability restrictions imposed by rapid gravity waves the θ semi implicit method is used to discretize the gradient of the free surface elevation in two parts a point wise elm using a multistep backward euler technique dimou 1992 zhang et al 2004 is used to solve the advection term when the advection term is solved by the elm u is updated and denoted by ubt for side i 1 2 the discretized momentum equation is given by 4 1 g δ t n m 2 u bt i 1 2 n r i 1 2 n 4 3 u i 1 2 n 1 u bt i 1 2 n 1 θ g δ t η i 1 n η i n δ x i 1 2 θ g δ t η i 1 n 1 η i n 1 δ x i 1 2 where θ is the implicit factor δt is the time step superscript n indicates time level n and the riverbed friction is discretized using ubt and un 1 to enhance computational stability in calculating free surface gradients at a junction side the cells in different branches are found by resorting to the notations with global indices for a side in a branch of the river lake system the elm tracking is confined within the domain of the branch when the tracking trajectory of a side passes through a junction side and enters a junction cell the backtracking is stopped due to the difficulty of the further tracking in a junction cell at this time the foot of the trajectory is regulated at the junction side of the junction cell backtracking of a junction side of a junction cell is only implemented when the direction of the velocity at this junction side corresponds to the inflow of the junction cell otherwise the ubt is obtained by an upwind interpolation when explicit terms of the discretized momentum equation are incorporated the unknowns cell water levels of time level n 1 ηn 1 emerge and eq 4 is then transformed into the following form 5 u i 1 2 n 1 g i 1 2 n f i 1 2 n θ δ t g 1 f i 1 2 n η i 1 n 1 η i n 1 δ x i 1 2 where f i 1 2 n 1 g δ t n m 2 u bt i 1 2 n r i 1 2 n 4 3 g i 1 2 n u bt i 2 n 1 θ g δ t η i 1 n η i n δ x i 1 2 and g i 1 2 n f i 1 2 n is regarded as the provisional solution provisional velocity by solving the explicit terms corresponding to the discretized momentum equations the continuity equation eq 1 is discretized using the implicit factor θ within a finite volume framework as follows at cell i 6 b i n δ x i η i n 1 η i n θ δ t a i 1 2 n u i 1 2 n 1 a i 1 2 n u i 1 2 n 1 1 θ δ t a i 1 2 n u i 1 2 n a i 1 2 n u i 1 2 n for each branch the velocity pressure coupling is performed by substituting eq 5 into eq 6 to construct a subsystem with cell water levels as unknowns at the two end cells of a branch all the neighboring cells in other branches supply water levels as boundary conditions to close the subsystem the subsystem is a tridiagonal linear system with a symmetric and positive definite coefficient matrix and can be solved directly for each branch the matrix and the right hand side of the subsystem are independently arranged when constructions of subsystems have been complete for all the branches the two step solutions a prediction step and a correction step of the pcm is used to couple the solutions of the subsystems for branches the subsystems for branches are solved to obtain the final solutions ηn 1 once the ηn 1 have been obtained the un 1 defined at side centers is calculated using eq 5 3 4 formulation of stm within a finite volume framework the stm is advanced fully explicitly as follows 7 c i n 1 c bt i n 1 δ t a i n δ x i υ c i 1 2 n a i 1 2 n c i 1 n c i n δ x i 1 2 υ c i 1 2 n a i 1 2 n c i n c i 1 n δ x i 1 2 δ t h i n s 0 n where cbt is the solution to the advection term because the stm is advanced fully explicitly the extension of eq 7 to solve the scalar transport for a junction cell is straightforward using the notations with global indices to find the cells in a different branch a multi dimensional ffelm hu et al 2019 is rebuilt in 1d grid systems using distances between cross sections and topographical data of cross sections to calculate cbt and the new scheme is as follows the proposed 1d ffelm applied to the stm requires only the backtracking of cell faces the backtracking starts at a cell face and then a multi step backward euler technique dimou 1992 is performed to backtrack from the known location at time level tn 1 to the unknown foot of the backward trajectory at time level tn the tracking displacement of each substep is given by δ x u δ t n where n is the number of substeps and u is the velocity vector at the starting point of each substep when a tracking point has been found the velocity at this point is interpolated based on the data of time level n for calculating the next displacement and searching the next tracking point on each tracking point scalar concentration is interpolated based on the values of the cell faces which belong to the cell where the tracking point lies for the backtracking of side j using n substeps the backward trajectory comprises n tracking points p1 p2 pn see fig 3 and the scalar concentration of the k th tracking point is denoted by cj k correspondingly the time step of the solution of the advection term δt is equally divided into n sub time steps δτ for substep k k 1 2 n a representative cell face velocity u j k θ is required to work with cj k to calculate the advective subflux of a scalar through cell face j e g i 1 2 i 1 2 a linear distribution of the cell face velocity is assumed from time level n to n 1 and the u j k θ at substep k is then defined as 8 u j k θ 1 θ u j k 1 θ u j k where uj k is the cell face velocity at the end of substep k and u j k n k n u j n k n u j n 1 the sub quantity of scalar through cell face j at substep k is computed as 9 s j k n 1 δ τ a j n u j k θ c j k n the summation of the subflux of each substep is independent for each side within one time step therefore sub scalar quantity of each substep within one time step can be directly summed to obtain the total scalar quantity through cell face j from time level n to n 1 as follows 10 s j n 1 δ τ a j n k 1 n u j k θ c j k n according to gross et al 2002 the consistency between the discretized continuity equation of flows and the discretized advection equation of scalars is necessary for the preservation of constants hu et al 2019 defined a g correction to satisfy the consistency condition for a multi dimensional stm by correcting cell face advective fluxes applying the idea of the g correction to the current 1d stm the total advective scalar quantity through cell face j from time level n to n 1 can be corrected as 11 s j c o r n 1 α j δ τ a j n k 1 n u j k θ c j k n where αj is the parameter for the g correction and can be explicitly calculated as 12 α j n 1 θ u j n θ u j n 1 1 θ u j n n 1 2 u j n u j n 1 θ u j n 1 the cell update of the 1d ffelm from time level n to n 1 is then derived as 13 c bt i n 1 c i n δ τ a i n δ x i α i 1 2 n a i 1 2 n k 1 n u i 1 2 k θ c i 1 2 k n α i 1 2 n a i 1 2 n k 1 n u i 1 2 k θ c i 1 2 k n the proposed 1d ffelm has the following advantages first the ffelm uses a flux form cell update so the mass is conserved both locally and globally by the unique flux at a cell face second the dependence domain for evaluating cell face advective fluxes is extended from the upwind cell to the domain swept by the elm trajectory hence the ffelm is free from the cfl number restriction of stability and the scheme allows large time steps for which the cfl can be greater than 1 third because evaluation of the cell face advective flux is independent for each side and cell update is independent for each cell within one time step the ffelm can be well parallelized fourth when the ffelm is used to solve multiscalar transport the geometrical computation which is common for each tracer can be reused the most time consuming parts calculations of trajectories and interpolation weights are avoided and only a relatively very small computation cost is added for solving each additional tracer these advantages of the ffelm allow that an accurate and highly efficient stm can be developed 3 5 nested implementation of ffelm for an elm type scheme applied to a stm the tracking information of the lagrangian trajectory is generally obtained directly by doing a trajectory tracking the most time consuming part of an elm such as the elcirc model zhang et al 2004 however we may have another choice if the following conditions are satisfied the hdm also uses an elm and the elm starts at the same grid point and uses the same tracking strategy as the elm in the stm if these conditions are met it is possible for the elm in the stm to reuse the tracking information of the elm in the hdm instead of doing the trajectory tracking again as a result the most time consuming geometrical computation associated with the trajectory tracking of the elm applied to the stm is totally eliminated the high startup cost of the elm applied to the stm is then essentially alleviated for the current model the condition for reusing the tracking information of an elm is satisfied the reuse is realized by a nested implementation of the elm applied to the stm and the flowchart of the nested ffelm ffelm n is shown in fig 4 in the backtracking of the point wise elm in the hdm the scalar concentration is interpolated at each tracking point and recorded for the calculation of the ffelm in this way a nested technique is proposed to reduce the startup cost of an elm type advection scheme applied to a stm 3 6 parallel implementation of hdm and stm one time stepping of the current model mainly takes six steps first all the explicit terms advection riverbed friction and the explicit part of free surface gradients in momentum equations are computed to obtain provisional velocities second the velocity pressure coupling is performed and the subsystems for branches are constructed and solved to obtain new cell water levels third cells that experience the alternation from wet to dry states at this time step are eliminated and then back substitution is done to obtain final velocities forth the stm is solved fifth dry and wet state of the grid is updated using new cell water levels sixth auxiliary variables are updated on the one hand using the pcm the solution of the velocity pressure coupling problem of a river lake system requires only local solutions of subsystems for branches which can be represented by two parallelizable loops on the other hand almost all the left calculations of the hdm and the stm are explicit and can also be represented by a series of parallelizable loops these loops can be easily parallelized using a loop based parallelization in the present code the open multiprocessing openmp technique is used to parallelize these loops a shared memory computer which had a 16 core processor intel xeon e5 2697a v4 clock speed 2 6 ghz formed the hardware environment microsoft windows 7 and intel c 14 0 provided the software environment the virtual cores generated by the hyper threading technique were turned off the runtime speedup used as an indicator of how much faster the parallel code is than the sequential code is defined by 14 sp t 1 t nc where sp speedup of a parallel run relative to a sequential run t 1 runtime of a sequential run using one working core tnc runtime of a parallel run using nc working cores 4 results the new model was tested using the jdt system to clarify its accuracy stability and efficiency in solving the hydrodynamic and scalar transport in large river lake systems a grid of 2382 cells is used to cover the domain of the jdt system including 113 600 sub grids the grid scales are respectively 1 2 km 0 2 0 5 km and 1 2 km for the jing river js river networks and dt lake this grid is used in tests all through this section the bathymetry dataset and the hydrological data are provided by the hydrology department of the yangtze river water conservancy commission yrwcc 4 1 accuracy tests using moderate time step in tests the time step of the model was set to 900 s and the semi implicit factor θ was set to 0 6 manning s roughness coefficient nm was determined by calibration tests with field data as follows the calibration tests include a preparatory work and a try error process hu et al 2015b in the preparatory work the jdt system is divided into branches each of which has its own nm the nm of the branch downstream of chenglingji and the dt lake are adjusted so that the simulated water levels agree with the field data a reliable downstream boundary is then formed the try error process of the calibration is conducted as follows first priority is given to flow diversion calibration for the upper parts of the jing river and js river networks the nm of the related branches is adjusted so that the simulated discharges at the key stations e g xjk sdg mts kjg gjp and so on agree with field data second the nm of the lower parts of the jing river and js river networks is adjusted so that the simulated water levels at these stations agree with field data these two steps are repeated alternately and advanced in opposite spatial directions to improve the simulation results until both the simulated discharges and water levels throughout the jdt system agree with the field data at the same time the nm was calibrated as 0 029 0 018 0 028 0 020 and 0 022 0 018 respectively for the jing river js river networks and dt lake from upstream to downstream then the process of the 2005 unsteady flow and scalar transport in the jdt system was simulated to demonstrate the accuracy of the hdm and the stm the field data of flows during january 1 to december 31 2005 were used to set the open boundary conditions for the sake of convenience constant scalar concentration of 1 0 kg m3 was set at all inflow open boundaries as a result the scalar transport rate q cs c cs at a cs is equal to the discharge q cs in values theoretically all through the time of a simulation of the scalar transport in the unsteady flows it allows that a mean absolute relative error in simulated q cs c cs eqc and a relative error of mass conservation es can be defined as follows 15 e qc 1 n y l 1 n y q cs c cs q cs 1 kg m 3 q cs 1 kg m 3 l 16 e s l 1 n y t q cs c cs l l 1 n y t q cs 1 kg m 3 l l 1 n y t q cs 1 kg m 3 l where ny is the number of samples and ny 365 for a simulation of 365 day scalar transport process one sample per day t is the time interval of sampling and t 86400 s one sample per day the hdm stm model completed the simulation stably and gave reasonable results in the simulation the water level z cs the q cs and the q cs c cs at cross sections in the jdt system were recorded each day for the hdm the simulated histories of the q cs and the z cs agree well with field data as shown in fig 5 taking stations xinjiangkou xjk guanjiapu gjp shashi ss and yingtian yt as examples the mean absolute error in simulated water levels at gauges is generally 0 12 0 27 m and the relative error in simulated annual water flux eq at cross sections is 1 6 5 2 compared with field data the conservation error of water defined as the difference between the total inflows and outflows in a year is 2 3 10 3 for the stm the simulated histories of cross sectional q cs and q cs c cs at station jl and station xjk are plotted in fig 6 one sample per day because a constant concentration of 1 0 kg m3 is set at all the inflow open boundaries the q cs c cs should be equal to the q cs in values theoretically all the time in the unsteady hydrological process in fig 6 the histories of the simulated q cs are found to be almost the same as those of the simulated q cs c cs the eqc and the es at cross sections are 0 29 0 35 and 0 36 0 46 respectively mass conservation error of the stm mainly arises from disturbances by the error of the hdm the frequent wet and dry alternations of unsteady flows and the rough interpolation in the evaluation of q cs and q cs c cs 4 2 stability tests using different time steps under different flow conditions simulations of the flow and scalar transport are characterized by different cfl levels the stability of a hdm and a stm is often approximately described by the maximum cfl under which stable simulations can be achieved a cfl number at side centers cflj was defined as 17 cf l j u j δ j where uj velocity at side j δj distance between the centers of the two cells that share side j moreover a big cfl ratio was defined as the percent that wet sides of cflj 1 account for of the total sides the process of the 2005 unsteady flow and scalar transport in the jdt system is used to test the stability of the hdm and the stm five time steps 300 600 900 1200 and 1440 s are tested and a sub time step δτ of 100 s is used for backtracking the test results using different time steps are shown in fig 5 when δt is equal or less than 1200 s the models complete the simulation stably the accuracy of the hdm and the stm is almost kept constant when δt changes from 300 to 1200 s the cfl levels of a simulation using a time step of 1200 s is taken as example and analyzed here in the simulation the distribution of the quantities of sides with different levels of cfl in selected months of 2005 is shown in fig 7 a in flood seasons july august the big cfl ratio reaches 73 6 74 2 and about 30 60 sides have a cflj larger than 5 however if the time step continues to increase the time resolution for simulating dry and wet alternations of cross sectional sub grids may gradually become insufficient causing instabilities in this case simulations using the hdm and stm may be unstable in tests when δt is equal to or larger than 1440 s spurious oscillations begin to appear in the simulated histories of discharges or water levels at some cross sections such as station gjp see fig 5b 4 3 efficiency tests sequential versions of the current hdm and stm have been already very efficient because stable and accurate simulations can be achieved at large time steps cfl 1 however efficiencies of the hdm and the stm can be further sharply improved by simple parallelization techniques to achieve real time simulations in this section the parallelized hdm and stm were tested while the runtime reduction brought by the multi scalar property of the ffelm and the nested technique was also clarified for both the hdm and the stm the time step δt is set to 900 s and a sub time step δτ of 100 s is used in the backtracking the scale property of the parallelized hdm and stm is tested using 5 kinds of working cores nc 1 2 4 8 and 16 five simulations using the hdm alone nc 1 16 are run and the runtimes are recorded to clarify the efficiency of the stm in solving multi scalar transport six kinds of scalar numbers n 1 2 4 8 16 and 32 are tested correspondingly 30 simulations using the hdm stm model are run the process of the 2005 unsteady flow and scalar transport in the jdt system is used in the tests in the 1 year simulations runtimes of the stm are recorded see table 1 and the speedups of them are shown in fig 8 first the scale property of the model is discussed runtime of the hdm for 1 year simulation is respectively 97 13 s nc 1 and 10 73 s nc 16 where the speedup nc 16 is 9 0 speedups nc 16 of the stm are 9 8 13 5 under n 1 32 large speedups for the hdm and stm are achieved by the parallel technique second the advantage of the stm in solving multiscalar transport is analyzed in sequential tests the average runtime increment of the stm for solving each added scalar is about 8 6 relative to the runtime of the hdm see table 2 in parallel tests nc 16 the average runtime increment of the stm for solving each added scalar is about 5 9 using the runtime of the hdm as a reference the stm using the ffelm is revealed in tests to be quite efficient in solving the transport of a large number of scalars multiscalar transport third the improvement in efficiency brought by the nested technique is discussed in this part 30 ffelm n simulations are run whose results are compared with those of the ffelm simulations runtime of the stm n 1 is regarded as the startup cost of the stm using the nested technique the startup of the stm is reduced by 33 2 in sequential runs and 26 2 in parallel runs see table 2 the backtracking for the ffelm is only a part of the stm calculations and the runtime of the former accounts for about 50 of that of the latter when n 1 when the number of the scalars increases the proportion of the computation cost of the ffelm backtracking in that of the stm is reduced and the improvement of the nested technique is weakened finally the runtime of the hdm stm model is summarized under n 1 32 speedups of the model nc 16 are 9 3 11 5 and 9 0 11 8 respectively in the ffelm and the ffelm n simulations using a grid of 2382 cells with 113 600 sub grids and a processor with 16 cores the model only takes 33 3 s to complete a simulation of a 1 year process of the unsteady flow and scalar transport 32 kinds of scalars in the jdt system 5 comparison studies the performance of the new model is compared with those of two existing models of the two existing models the first one is a conventional 1d model the mike11 which uses eulerian type schemes and the second one is a 2d model which uses numerical schemes similar to the proposed 1d model 5 1 comparison studies using mike11 5 1 1 theoretical comparisons and preliminary tests according to the user manual of dhi 2014 the mike11 s computational time step is limited by two aspects first as a conventional model using eulerian advection schemes the time step of the mike11 is limited by the cfl restriction of stability the maximum cfl of a hdm and a stm simulation should be less than 1 and 0 5 respectively second the dry wet variations treated using a slot method in the mike11 and the rapidly changing cross sectional geometry cause instabilities and further limit the time step as a result in real applications the mike11 often only allows small time steps for which the cfl is obviously less than 1 relatively the hdm of the new model is unconditionally stable with respect to the wave celerity advection and bottom friction benefiting from the semi implicit method the elm and the implicit discretization of bottom friction as a result the hdm of the new model allows large time steps for which the cfl can be much larger than 1 the inputs of the topographical and hydrological data of the mike11 are the same as those used in the new model in tests of the 2005 unsteady flows in the jdt system using the new model the cfl level of a simulation with δt 120 s is shown in fig 7b for such a test the theoretical maximum time step which the hdm of the mike11 allows is 120 s however it only allows a time step as small as 45 s due to the disturbances caused by dry wet variations and rapidly changing cross sectional geometry the hdm of the new model has been revealed in tests to achieve stably simulations and give accurate results under a time step as large as 1200 s the mike11 and the new model both use a linearization technique for the term a t in continuity equations which simplifies the solution of the hdm and improves its efficiency to be different the hdm of the mike11 adopts a 6 point abbott scheme and its solution takes two steps with the time step being equally split at each step a time consuming iteration is required because of the implicit solution relatively the hdm of the new model which is also an implicit model only needs to solve tridiagonal linear systems for branches and is free of any iteration with the help of the elm the pcm it means that the hdm of the new model may run several times faster than that of the mike11 under the same time step the runtime of the hdm for the 1 year simulation is respectively 6333 0 s using the mike11 and 1925 9 s using the sequential version of new model under a time step of 45 s however the hdm of the new model allows a time step larger than 900 s and the corresponding runtime is less than 97 1 s that is to say the runtime of the hdm of the new model can be more than 65 2 times shorter than that of the mike11 leskens et al 2014 reported that a kind of hdms such as casulli and stelling 2013 allow for computation times that are more than 100 times shorter than conventional models typically this kind of hdms uses a combination of an implicit method for discretizing free surface gradients and the elm for solving advections which are also adopted in the hdm of the new model relative to casulli and stelling 2013 the hdm of the new model linearizes the a t in the continuity equation and adopts the pcm hu et al 2015a 2015b to couple the solutions of branches of a shallow water system as a result our hdm only needs to solve local linear subsystems for branches and is free of any iteration while the hdm of casulli and stelling 2013 has to solve a global nonlinear system for the whole shallow water system using iterative methods 5 1 2 comparisons of accuracy and efficiency to conduct a more general comparison test a local model for the jing river is built by extracting the necessary materials from the jdt model the computational domain of the local model is marked in fig 1 bounded by the dashed line and it is covered by a grid of 388 cells 13 550 sub grids the process of the 2005 unsteady flow and scalar transport is used in tests because the domain characterized by frequent dry wet variations and rapid changing cross sections has been excluded as much as possible the stability of the local model is significantly improved relative to that of the jdt model according to preliminary tests the mike11 can run stably using a time step as large as 120 s for the hdm and 60 s for the stm under which the maximum cfl of the hdm and stm simulation approaches 1 and 0 5 respectively therefore in the comparison tests three time steps δt 60 120 and 900 s are used for the tests of the stm two kinds of scalar numbers n 1 and 32 are used the scale property of a parallelized model is tested using two kinds of working cores nc 1 and 16 the simulated histories of the z cs and the q cs agree with field data as shown in fig 9 taking stations zhicheng zc and luoshan ls as examples in tests using the mike11 δt 120 s the mean absolute error in simulated water levels is 16 8 cm and the relative error in simulated cross sectional discharge is 3 45 compared with field data correspondingly in tests using the new model δt 900 s the mean absolute error in simulated z cs is 17 1 cm and the relative error in simulated q cs is 3 47 the hdms of the new model and the mike11 achieve almost the same accuracy even though the new model uses a much larger time step runtimes of the 1 year simulations are recorded see table 3 and analyzed first the hdm of the new model the former runs 3 0 3 6 times faster than that of the mike11 the latter under the same time step benefiting from the improved stability and much larger time step the former will run 23 3 times faster than the latter second when n 1 the stm of the new model using the ffelm and a nested technique the former runs 8 4 times faster than that of the mike11 the latter under the same time step benefiting from the improved stability and much larger time steps the former will run 80 6 times faster than the latter when the n is increased to 32 the former which benefits from the multiscalar property will run 184 4 times faster than the latter in the hdm stm simulations with n 1 32 a sequential run using the new model runs 48 1 140 6 times faster than that using the mike11 relative to the tests using the jdt system the simulations using the jing river have smaller granularities in terms of a parallel implementation the parallel speedup of the local model is reduced to 5 3 6 9 from 9 0 11 8 of the jdt model when the speedup brought by parallel technique is included nc 16 the new model runs 282 8 966 0 times faster than the mike11 5 2 comparison studies using a 2d model using similar schemes 5 2 1 overview of the 2d model the adopted 2d model hu et al 2015a 2019 uses the depth averaged 2d shallow water equations and the advection diffusion equations as the governing equations it uses numerical schemes similar to the proposed 1d model namely the 2d version of the θ semi implicit method the elm and the fflem as a result the 2d hdm is also unconditionally stable with respect to wave celerity and advection allowing large time steps for which the cfl is larger than 1 the 2d stm has advantages of allowing large time steps parallelizable and multiscalar property the 2d hdm adopts domain decomposition method to treat large shallow water systems and uses the pcm to couple the solutions of subdomains moreover the nested technique proposed in this study is also used to construct a 2d version of the nested fflem also denoted by ffelm n a channel refined unstructured grid hu et al 2015b is used to divide the jdt system and has 327 820 cells it ensures an accurate simulation of the dry season channel flows in a river lake system characterized by compound floodplain channel cross sections and irregular boundaries with as few cells as possible the δt is set to 60 s and is equally divided into 6 sub time steps in the backtracking of the elm or the ffelm ffelm n the 2d model provides an improved description of the physical processes of the flow and scalar transport in a complex and widespread river lake system and improves the accuracy of simulations relative to a 1d model for examples the mean absolute error in simulated water levels is generally less than 0 15 m using the 2d hdm hu et al 2015b and it is increased to 0 12 0 27 m using the 1d hdm besides the macroscopic hydrological information the 2d model can also provide the detailed distributions of velocity field water level and scalar concentration in the horizontal domain despite these advantages a high resolution 2d simulation of a large shallow water system such as the jdt system is time consuming because so many computational cells are involved therefore in the following section the efficiency of the 2d model applied to the jdt system is focused which is compared with that of the proposed 1d model 5 2 2 efficiency tests and discussions first the efficiency of the 2d model is tested under a 1 day steady flow condition of bankfull discharge the runtime of the hdm is 1250 16 s nc 1 and 115 89 s nc 16 the scale property and the multiscalar property of the stm are tested using two kinds of working cores nc 1 and 16 and six kinds of scalar numbers n 1 2 4 8 16 and 32 under the bankfull discharge the wet cell ratio of the grid is 64 7 and there are 214 600 wet cells runtimes of the stm using the ffelm n are compared with those using the ffelm as listed in table 4 in both the sequential and the parallel runs the base cost of the stm n 1 using the ffelm n is shown to be about a half of that using the ffelm the speedup nc 16 is 10 5 8 2 in ffelm runs and is 11 7 9 0 in the ffelm n runs under n 1 32 in sequential tests nc 1 the runtime increments for solving each added scalar using the ffelm and the ffelm n are 5 0 6 6 and 5 6 6 6 respectively relative to the base cost of the stm using the ffelm in parallel tests nc 16 the runtime increments for solving each added scalar using the ffelm and the ffelm n are 7 4 9 3 and 7 0 8 1 respectively second the process of the 2005 unsteady flow and scalar transport in the jdt system is simulated to clarify the difference in efficiency between the 2d and the 1d model in the tests four kinds of scalars and 16 working cores are used the runtimes of the hdms and the stms n 4 and nc 16 are listed in table 5 in a simulation of hydrodynamic and scalar transport in the jdt river lake system the 1d model can run more than 3600 times faster than the 2d model using similar numerical schemes according to the comparison studies when a conventional 1d model e g the mike11 or a 2d high resolution hydro environmental model is nested in an optimization model it is difficult for the former to provide data for the real time calls of the latter because of the long runtime of the hdm and stm such a nesting is useless in real applications the aim of this study is to eliminate the efficiency bottleneck of hydro environmental simulations by constructing new numerical schemes and developing new 1d models 6 discussions in this study real time simulations of hydrodynamic and scalar transport in large river lake systems are realized by constructing new numerical schemes and developing new 1d models in this section the key techniques and the limitations of the models are summarized moreover the possibility of combing the new hydro environmental model with an optimization model is discussed in terms of efficiency 6 1 key techniques used in hdm and stm first this study presents a semi implicit hdm for free surface flows in a river lake system benefiting from the semi implicit method the elm and the implicit discretization of bottom friction the hdm is unconditionally stable with respect to the wave celerity advection and bottom friction moreover the introduction of the pcm allows that a river lake system is described by branches and the hydrodynamics especially the velocity pressure coupling problem of a river lake system can be solved locally based on domain decomposition as a result a very simple formulation for the solution of free surface flows in river lake systems is designed where the hdm only needs to solve 1d tridiagonal linear systems for branches the resulting hdm for river lake systems allows large time steps for which the cfl is greater than 1 and can be well parallelized second a 1d ffelm is proposed for solving advective transport of scalars in 1d grid systems by rebuilding a multi dimensional scheme hu et al 2019 a nested technique is proposed to reduce the ffelm s startup cost associated with trajectory tracking the developed stm allows large time steps for which the cfl is greater than 1 is parallelizable is good at solving the multiscalar transport and has low startup cost the aforementioned advantages of the new hdm and hdm explain why they can run tens or hundreds of times faster than a conventional 1d model using eulerian type numerical schemes 6 2 combination of hdm and stm with optimization models in water resources management simplified hdms e g kinematic wave model diffusion wave model which is computationally efficient are often nested in an optimization model for decision making on the one hand application of the simplified hdms is often limited e g downstream backwater cannot be accounted for and they can only produce rough predictions of flood routing on the other hand optimization models often require thousands of calls of the hydrodynamic calculation so a full hdm also called dynamic wave model which is time consuming is seldom nested in optimization models moreover when a hydro environment issue is included the coupling of an optimization model and a hdm stm model become more difficult because simulations of the transport of scalars further increase the runtime significantly to our best knowledge a real time coupling of the hydro environmental simulation and the optimization calculation has not been reported yet the jdt system is used as an example to analyze the possibility of coupling an optimization model and a hdm stm model for the jdt system covered by a grid of 2382 cells with 113 600 sub grids it takes the model 33 3 s to complete a simulation of a 1 year process of unsteady flow and scalar transport when 32 kinds of scalars and 16 cores are used when an emergency event of water pollutions happens a conventional simulation of a 15 day process of flows and scalar transport will take 1 39 s 5000 times of calls which is generally needed by an optimization model will only take about 2 h because the hdm and stm are both well parallelizable the runtime of the model can be further reduced sharply by using a new processor with more cores in terms of hydro environment managements the developed models are so efficient that they make possible the real time coupling of an optimization model and a hdm stm model for large river lake systems 6 3 limitations of the new model the hdm using the pcm essentially solves quasi coupled subsystems of branches of river networks where only one time data exchange is involved in the solution of subsystems the main inadequacy of the new model is the limitation imposed on the time step by the condition for application of the pcm hu et al 2015a for alluvial river flows this condition is easily satisfied according to former theoretical analysis and tests and large times for which the cfl can be much larger than 1 are allowed that is to say the limitation of this condition is very weak for river lake systems and it can be neglected relative to the cfl restriction associated with eulerian schemes however when the model is used to simulate highly unsteady flows water levels and velocity fields vary fast with respect to time such as tidal flows the time step needs to be small to satisfy the condition of the pcm for application in this case the advantage of the efficiency of the new model does not exist any longer because small time steps are required to ensure the simulation accuracy in this case the model may alternatively resort to the global layer iteration cai et al 2005 zhu et al 2011 to improve the simulation accuracy 7 conclusions this study presents a new 1d hydro environmental model for free surface flows and scalar transport in large river lake systems using a prediction correction method the hydrodynamic is simulated by solving local linear systems based on domain decomposition a flux form elm is constructed to solve advective transport of scalars in 1d grid systems and a nested technique is proposed to reduce its startup cost the resulting stm and hdm both allow large time steps for which the cfl is greater than 1 and can be well parallelized moreover the stm is good at solving multiscalar transport and has low startup cost the new model is tested using the jdt system which is covered by a grid of 2382 cells with 113 600 sub grids stable and accurate simulations are achieved at large time steps for which the cfl can be larger than 5 in the test of scale property of the hdm stm model using 32 kinds of scalars and 16 cores a parallel run is 11 8 times faster than a sequential run and it only takes the new model 33 3 s to complete a simulation of a 1 year process of unsteady flow and scalar transport in the jdt system performance of the new model is also compared with those of a conventional 1d model the mike11 and a 2d model using schemes similar to the new model on the one hand the new model achieves almost the same accuracy as the mike11 and allows a much larger time step a sequential run of the new model runs tens of times faster than that of the mike11 moreover the parallel technique will further enlarge the difference in efficiency between the new model and the mike11 on the other hand the new 1d model can run more than 3600 times faster than the 2d model using similar numerical schemes when a conventional 1d model e g the mike11 or a 2d high resolution model is nested in an optimization model it is difficult for the former to provide data for the real time calls of the latter because of the long runtime of the hydro environmental simulations such a nesting is useless in real applications in this study the efficiency bottleneck of the hydro environmental simulations is eliminated by constructing new schemes and developing new 1d models the developed hdm and stm are so efficient that they make possible the real time coupling of an optimization model and a hdm stm model for large shallow water systems credit authorship contribution statement dechao hu conceptualization methodology software validation writing original draft investigation funding acquisition resources supervision project administration shiming yao methodology software validation writing original draft investigation funding acquisition resources chengkun duan investigation validation visualization writing review editing songping li investigation validation visualization writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements financial support from natural science foundation of hubei province 2019cfb462 national natural science foundation of china 51339001 51779015 51479009 and fundamental research funds for the central universities china 2017kfyxjj197 are acknowledged 
5813,real time coupling of a hydro environmental model and an optimization model is difficult because hydrodynamic model hdm and scalar transport model stm are both time consuming especially when the computational domain is large e g river lake system this study presents a new 1d hydro environmental model for free surface flows and scalar transport in large river lake systems using a prediction correction method hydrodynamic is simulated by solving local linear systems based on domain decomposition a flux form eulerian lagrangian method elm is constructed to solve advective transport of scalars in 1d grid systems and a nested technique is proposed to reduce its startup cost the resulting stm and hdm both allow large time steps for which the courant friedrichs lewy number cfl is greater than 1 and they are parallelized using the open multiprocessing technique openmp moreover the stm is good at solving multiscalar transport and has low startup cost the new model is tested using the jing dongting jdt system which is covered by a grid of 2382 cells with 113 600 sub grids stable and accurate simulations are achieved at large time steps for which the cfl can be larger than 5 a sequential run of the new model runs tens of times faster than that of a conventional 1d model such as the mike11 moreover the efficiency of the new model can be further improved by the openmp parallel technique in the test of scale property of the hdm stm model using 32 kinds of scalars and 16 cores a parallel run is 11 8 times faster than a sequential run and it only takes the new model 33 3 s to complete a simulation of a 1 year process of unsteady flow and scalar transport in the jdt system keywords river lake system free surface flow scalar transport local solution eulerian lagrangian method parallel computing 1 introduction in the management of river lake systems rapid decisions are often required to cope with the emergency events of dangerous floods and sudden water pollutions where calculations of hydrodynamic and scalar transport are involved in these scenarios an optimization model is also often introduced to help doing decision making and it requires thousands of calls of the hydrodynamic model hdm and scalar transport model stm it is expected that the hdm and the stm run as fast as possible to provide data for the real time calls the hdm and stm respectively based on the saint venant and the transport equations have been long developed for real applications and revealed to provide accurate simulations li et al 2014 du et al 2018 to achieve a real time hydro environmental simulation for a large river lake system the hdm and stm are both required to allow large computational time steps and also they are expected to be parallelizable moreover real hydro environmental applications often need to simulate the transport of tens of different scalars for each of which one transport equation must be solved this issue is called multiscalar transport a stm should be able to solve the time consuming multiscalar transport efficiently the hdms may be divided into explicit and implicit ones parallelization of explicit hdms is straightforward but the time step of such models is often limited by the courant friedrichs lewy cfl number restriction implicit hdms e g hec 2010 casulli and stelling 2013 are more attractive for their large time steps but they have to solve a large linear nonlinear system arising from the velocity pressure coupling where iterative solutions are required the parallel implementation of the iterative solutions of these algebraic systems is often difficult and inefficient e g for the popular partitioned matrix method based on domain decomposition bjørndalen 2003 fringer et al 2006 jankowski 2009 nesterov 2010 the overhead arising from frequent data exchanges among subdomains may be significant and limit the speedup of a parallel code generally alluvial river lake systems are filled with gradually varied subcritical free surface flows zhu et al 2011 for such flows a multi dimensional implicit hdm using domain decomposition is developed in hu et al 2015a where a prediction correction method pcm is proposed to solve the resulting subsystems in parallel using the pcm the hydrodynamic of a river lake system is simulated by solving local linear systems which can be well parallelized the performance of a stm relates closely to the solution of advection terms which is often calculated explicitly using eulerian schemes e g the popular finite volume method that can conserve mass well the time step of these eulerian schemes is also limited by the cfl stability condition although a sub cycling casulli and zanolli 2002 wang et al 2008 can be used to alleviate the cfl restriction the dependence of solutions among neighbor substeps in the subcycling determines that the explicit eulerian advection schemes using a sub cycling cannot be well parallelized as an explicit advection scheme the eulerian lagrangian method elm allows large time steps for which the cfl can be greater than 1 and is parallelizable moreover the elm is good at solving the multiscalar transport by reusing trajectory tracking information dukowicz and baumgardner 2000 lauritzen et al 2010 however the application of a traditional pointwise elm is often limited by two defects of the non conservation gross et al 2002 and the high startup cost associated with trajectory tracking on the one hand much effort has been devoted to finding ways to construct a conservative elm during the past three decades especially in the realm of atmosphere modeling at least six kinds of conservative elms have been reported in the literature which are respectively the cell integration and remapping method e g rancic 1995 the flux form method e g harris et al 2011 the localized adjoint method e g russell and celia 2002 the posteriori correction method e g oliveira and fortunato 2002 the constrained interpolation profile method e g tanaka et al 2000 and the weight interpolation weight balancing method e g lentine et al 2011 hu et al 2017 2019 found a mechanism to eliminate the unphysical oscillations in the construction of a conservative elm and successfully rebuilt some of the above conservative elms for multidimensional simulations of scalar transport in shallow water systems on the other hand to our best knowledge studies on the methods of cutting the high startup cost of the elm applied to stms have not been reported yet this study is aimed to achieve real time simulation of hydrodynamic and scalar transport in large shallow water systems so that the hydro environmental model is efficient enough to be nested in an optimization model the hydrodynamic is simulated by solving local linear systems based on domain decomposition a flux form elm and nested technique are proposed to solve scalar transport in 1d grid systems the accuracy stability and efficiency of the new models are then tested using a real river lake system and compared with existing models 2 study area the jing dongting jdt river lake system is a large scale 3900 km2 strongly coupled shallow water system comprising the jing river the upper part of the middle yangtze river dongting dt lake and jing south js river networks see fig 1 one of its inflow entrances is at zhicheng on the jing river 100 km downstream of the three gorges reservoir tgr twelve percent of the inflow of the jing river runs through the js river networks and then enters the dt lake additionally four inflows from the xiang zi yuan and li rivers are received stored by the dt lake and then drained downstream the only outflow from the dt lake and the lower jing river converge at chenglingji moreover the jdt system has a compound floodplain channel cross section leading to various flow regimes in different seasons for example the dt lake acts as a lake when fully flooded in flood seasons but has only river like flows passing through narrow channels in dry seasons since the tgr began to regulate runoff and trap sediment in 2003 new hydrological processes and river lake relations in jdt system have been gradually formed resulting in many problems of flood defense water resource hydro environment etc the hydrodynamics and scalar transport in the jdt system have been widely studied in china chen et al 2012 li et al 2009 and serve as basic knowledge for other researches 3 methods 3 1 governing equations of numerical models the 1d saint venant equations eqs 1 and 2 and the advection diffusion equation eq 3 are respectively used as the governing equations of the hdm and the stm they are given by 1 b η t a u x q 2 u t u u x g η x g n m 2 u u r 4 3 3 ac t uac x x υ c a c x s o where a wet cross sectional area m2 b wet surface width of a cross section m u cross section averaged velocity of x direction m s t time s η water level measured from an undisturbed reference water surface m q lateral inflow per unit length m2 s g gravity acceleration m s2 nm manning s roughness coefficient m 1 3s r hydraulic radius m c scalar concentration kg m3 so source term of a scalar kg m2 s and υc diffusion coefficient of a scalar m2 s 3 2 description of river lake system and computational grid the developed hdm and stm both use a local solution of the governing equations see sections 3 3 and 3 4 correspondingly the river lake system is divided into and described by branches linked by junctions each branch is covered by a set of 1d cells elements the control volume generated for a junction is defined as the junction cell for which the number of connected branches can be arbitrary a non junction cell only has two cell faces sides while a junction cell can have more than two cell faces the side shared by a junction cell is defined as the junction side for both non junction and junction cells a cross section cs with general topographical data bathymetry is arranged at the center of the cell the cell at the two ends of an internal branch is either a junction cell or is connected to a junction cell a junction cell does not stand alone but is arranged into the branch that has the largest river width around the junction as a default arrangement the ne and ns are respectively used to denote the quantities of cells and sides in the computational grid the number of the branches is denoted by nr and the cell quantities of the branches are sequentially denoted by n 1 n 2 nnr every cell side has a unique global cell side index branch k is taken as an example to illustrate the relations between the global and the local indices as follows we stipulate that the cells of branch k take up a successive section of the global indices of the cell sequence of river lake system denoted by i 1 i 2 i nk and otherwise arbitrary numberings are allowed a mapping is defined between the local indices of the cells in branch k and their global indices for branch k the cells with local indices 1 2 nk in sequence correspond to the cells with global indices i 1 i 2 i nk a similar mapping is also defined between the local indices of the sides in branch k and their global indices moreover notations with a global index see fig 2 are defined to describe the complex topology relations among cells and sides in different branches and the definitions of these notations are similar to those in hu et al 2015a these notations with a global index are mainly used at end cells to find their neighboring cells sides in a different branch for the calculation of the gradients of certain variables e g water levels and scalar concentrations a staggered grid of variable arrangement is used the u is defined at side centers whereas the η and c are defined at cell centroids see fig 2 for cell i local index δxi represents the length of the 1d cell the length of a junction cell is set to the width of the neighboring reach which is at the same branch as the cell bi is the wet surface width of cell i and is related to ηi that varies with respect to time ai is the conveyance area of cell i which is obtained by integrating the water depth related to ηi along the cs for side j i 1 2 which connects cells i and i 1 δxi 1 2 is the distance between the centers of cells i and i 1 ai 1 2 and ri 1 2 are the conveyance area and the hydraulic radius at side j respectively and they are interpolated from those of neighboring cells a common sub grid method usually adopted in 1d models hec 2010 mike11 2014 is used to describe the geometry of a cs applying a stepwise approximation to the cs the topography of a sub grid is represented by the average elevation of its two nodes dry and wet alternation of the grid is simulated using the method of the conventional critical water depths the dry and wet states of a cell and a sub grid are defined by two critical water depths respectively the h 0 0 01 m and the h k 0 001 m when the water level of a cell is h 0 higher than the elevation of its lowest sub grid denoted by zb lsg this cell is defined as wet the wet cells are included in the computation of the next time step while the dry ones will not 3 3 formulation of hdm the hdm follows a classic θ semi implicit formulation casulli and stelling 2013 using the pcm hu et al 2015a 2015b the hydrodynamics in a river lake system especially the velocity pressure coupling is solved locally based on domain decomposition benefiting from local solutions the hdm only needs to solve pure 1d problems the hdm requires only solutions of 1d subsystems for branches while solution of large multi dimensional algebraic systems for the whole river lake system is not needed calculation of a branch is introduced as follows momentum equations are solved within a finite difference framework and using operator splitting techniques to eliminate stability restrictions imposed by rapid gravity waves the θ semi implicit method is used to discretize the gradient of the free surface elevation in two parts a point wise elm using a multistep backward euler technique dimou 1992 zhang et al 2004 is used to solve the advection term when the advection term is solved by the elm u is updated and denoted by ubt for side i 1 2 the discretized momentum equation is given by 4 1 g δ t n m 2 u bt i 1 2 n r i 1 2 n 4 3 u i 1 2 n 1 u bt i 1 2 n 1 θ g δ t η i 1 n η i n δ x i 1 2 θ g δ t η i 1 n 1 η i n 1 δ x i 1 2 where θ is the implicit factor δt is the time step superscript n indicates time level n and the riverbed friction is discretized using ubt and un 1 to enhance computational stability in calculating free surface gradients at a junction side the cells in different branches are found by resorting to the notations with global indices for a side in a branch of the river lake system the elm tracking is confined within the domain of the branch when the tracking trajectory of a side passes through a junction side and enters a junction cell the backtracking is stopped due to the difficulty of the further tracking in a junction cell at this time the foot of the trajectory is regulated at the junction side of the junction cell backtracking of a junction side of a junction cell is only implemented when the direction of the velocity at this junction side corresponds to the inflow of the junction cell otherwise the ubt is obtained by an upwind interpolation when explicit terms of the discretized momentum equation are incorporated the unknowns cell water levels of time level n 1 ηn 1 emerge and eq 4 is then transformed into the following form 5 u i 1 2 n 1 g i 1 2 n f i 1 2 n θ δ t g 1 f i 1 2 n η i 1 n 1 η i n 1 δ x i 1 2 where f i 1 2 n 1 g δ t n m 2 u bt i 1 2 n r i 1 2 n 4 3 g i 1 2 n u bt i 2 n 1 θ g δ t η i 1 n η i n δ x i 1 2 and g i 1 2 n f i 1 2 n is regarded as the provisional solution provisional velocity by solving the explicit terms corresponding to the discretized momentum equations the continuity equation eq 1 is discretized using the implicit factor θ within a finite volume framework as follows at cell i 6 b i n δ x i η i n 1 η i n θ δ t a i 1 2 n u i 1 2 n 1 a i 1 2 n u i 1 2 n 1 1 θ δ t a i 1 2 n u i 1 2 n a i 1 2 n u i 1 2 n for each branch the velocity pressure coupling is performed by substituting eq 5 into eq 6 to construct a subsystem with cell water levels as unknowns at the two end cells of a branch all the neighboring cells in other branches supply water levels as boundary conditions to close the subsystem the subsystem is a tridiagonal linear system with a symmetric and positive definite coefficient matrix and can be solved directly for each branch the matrix and the right hand side of the subsystem are independently arranged when constructions of subsystems have been complete for all the branches the two step solutions a prediction step and a correction step of the pcm is used to couple the solutions of the subsystems for branches the subsystems for branches are solved to obtain the final solutions ηn 1 once the ηn 1 have been obtained the un 1 defined at side centers is calculated using eq 5 3 4 formulation of stm within a finite volume framework the stm is advanced fully explicitly as follows 7 c i n 1 c bt i n 1 δ t a i n δ x i υ c i 1 2 n a i 1 2 n c i 1 n c i n δ x i 1 2 υ c i 1 2 n a i 1 2 n c i n c i 1 n δ x i 1 2 δ t h i n s 0 n where cbt is the solution to the advection term because the stm is advanced fully explicitly the extension of eq 7 to solve the scalar transport for a junction cell is straightforward using the notations with global indices to find the cells in a different branch a multi dimensional ffelm hu et al 2019 is rebuilt in 1d grid systems using distances between cross sections and topographical data of cross sections to calculate cbt and the new scheme is as follows the proposed 1d ffelm applied to the stm requires only the backtracking of cell faces the backtracking starts at a cell face and then a multi step backward euler technique dimou 1992 is performed to backtrack from the known location at time level tn 1 to the unknown foot of the backward trajectory at time level tn the tracking displacement of each substep is given by δ x u δ t n where n is the number of substeps and u is the velocity vector at the starting point of each substep when a tracking point has been found the velocity at this point is interpolated based on the data of time level n for calculating the next displacement and searching the next tracking point on each tracking point scalar concentration is interpolated based on the values of the cell faces which belong to the cell where the tracking point lies for the backtracking of side j using n substeps the backward trajectory comprises n tracking points p1 p2 pn see fig 3 and the scalar concentration of the k th tracking point is denoted by cj k correspondingly the time step of the solution of the advection term δt is equally divided into n sub time steps δτ for substep k k 1 2 n a representative cell face velocity u j k θ is required to work with cj k to calculate the advective subflux of a scalar through cell face j e g i 1 2 i 1 2 a linear distribution of the cell face velocity is assumed from time level n to n 1 and the u j k θ at substep k is then defined as 8 u j k θ 1 θ u j k 1 θ u j k where uj k is the cell face velocity at the end of substep k and u j k n k n u j n k n u j n 1 the sub quantity of scalar through cell face j at substep k is computed as 9 s j k n 1 δ τ a j n u j k θ c j k n the summation of the subflux of each substep is independent for each side within one time step therefore sub scalar quantity of each substep within one time step can be directly summed to obtain the total scalar quantity through cell face j from time level n to n 1 as follows 10 s j n 1 δ τ a j n k 1 n u j k θ c j k n according to gross et al 2002 the consistency between the discretized continuity equation of flows and the discretized advection equation of scalars is necessary for the preservation of constants hu et al 2019 defined a g correction to satisfy the consistency condition for a multi dimensional stm by correcting cell face advective fluxes applying the idea of the g correction to the current 1d stm the total advective scalar quantity through cell face j from time level n to n 1 can be corrected as 11 s j c o r n 1 α j δ τ a j n k 1 n u j k θ c j k n where αj is the parameter for the g correction and can be explicitly calculated as 12 α j n 1 θ u j n θ u j n 1 1 θ u j n n 1 2 u j n u j n 1 θ u j n 1 the cell update of the 1d ffelm from time level n to n 1 is then derived as 13 c bt i n 1 c i n δ τ a i n δ x i α i 1 2 n a i 1 2 n k 1 n u i 1 2 k θ c i 1 2 k n α i 1 2 n a i 1 2 n k 1 n u i 1 2 k θ c i 1 2 k n the proposed 1d ffelm has the following advantages first the ffelm uses a flux form cell update so the mass is conserved both locally and globally by the unique flux at a cell face second the dependence domain for evaluating cell face advective fluxes is extended from the upwind cell to the domain swept by the elm trajectory hence the ffelm is free from the cfl number restriction of stability and the scheme allows large time steps for which the cfl can be greater than 1 third because evaluation of the cell face advective flux is independent for each side and cell update is independent for each cell within one time step the ffelm can be well parallelized fourth when the ffelm is used to solve multiscalar transport the geometrical computation which is common for each tracer can be reused the most time consuming parts calculations of trajectories and interpolation weights are avoided and only a relatively very small computation cost is added for solving each additional tracer these advantages of the ffelm allow that an accurate and highly efficient stm can be developed 3 5 nested implementation of ffelm for an elm type scheme applied to a stm the tracking information of the lagrangian trajectory is generally obtained directly by doing a trajectory tracking the most time consuming part of an elm such as the elcirc model zhang et al 2004 however we may have another choice if the following conditions are satisfied the hdm also uses an elm and the elm starts at the same grid point and uses the same tracking strategy as the elm in the stm if these conditions are met it is possible for the elm in the stm to reuse the tracking information of the elm in the hdm instead of doing the trajectory tracking again as a result the most time consuming geometrical computation associated with the trajectory tracking of the elm applied to the stm is totally eliminated the high startup cost of the elm applied to the stm is then essentially alleviated for the current model the condition for reusing the tracking information of an elm is satisfied the reuse is realized by a nested implementation of the elm applied to the stm and the flowchart of the nested ffelm ffelm n is shown in fig 4 in the backtracking of the point wise elm in the hdm the scalar concentration is interpolated at each tracking point and recorded for the calculation of the ffelm in this way a nested technique is proposed to reduce the startup cost of an elm type advection scheme applied to a stm 3 6 parallel implementation of hdm and stm one time stepping of the current model mainly takes six steps first all the explicit terms advection riverbed friction and the explicit part of free surface gradients in momentum equations are computed to obtain provisional velocities second the velocity pressure coupling is performed and the subsystems for branches are constructed and solved to obtain new cell water levels third cells that experience the alternation from wet to dry states at this time step are eliminated and then back substitution is done to obtain final velocities forth the stm is solved fifth dry and wet state of the grid is updated using new cell water levels sixth auxiliary variables are updated on the one hand using the pcm the solution of the velocity pressure coupling problem of a river lake system requires only local solutions of subsystems for branches which can be represented by two parallelizable loops on the other hand almost all the left calculations of the hdm and the stm are explicit and can also be represented by a series of parallelizable loops these loops can be easily parallelized using a loop based parallelization in the present code the open multiprocessing openmp technique is used to parallelize these loops a shared memory computer which had a 16 core processor intel xeon e5 2697a v4 clock speed 2 6 ghz formed the hardware environment microsoft windows 7 and intel c 14 0 provided the software environment the virtual cores generated by the hyper threading technique were turned off the runtime speedup used as an indicator of how much faster the parallel code is than the sequential code is defined by 14 sp t 1 t nc where sp speedup of a parallel run relative to a sequential run t 1 runtime of a sequential run using one working core tnc runtime of a parallel run using nc working cores 4 results the new model was tested using the jdt system to clarify its accuracy stability and efficiency in solving the hydrodynamic and scalar transport in large river lake systems a grid of 2382 cells is used to cover the domain of the jdt system including 113 600 sub grids the grid scales are respectively 1 2 km 0 2 0 5 km and 1 2 km for the jing river js river networks and dt lake this grid is used in tests all through this section the bathymetry dataset and the hydrological data are provided by the hydrology department of the yangtze river water conservancy commission yrwcc 4 1 accuracy tests using moderate time step in tests the time step of the model was set to 900 s and the semi implicit factor θ was set to 0 6 manning s roughness coefficient nm was determined by calibration tests with field data as follows the calibration tests include a preparatory work and a try error process hu et al 2015b in the preparatory work the jdt system is divided into branches each of which has its own nm the nm of the branch downstream of chenglingji and the dt lake are adjusted so that the simulated water levels agree with the field data a reliable downstream boundary is then formed the try error process of the calibration is conducted as follows first priority is given to flow diversion calibration for the upper parts of the jing river and js river networks the nm of the related branches is adjusted so that the simulated discharges at the key stations e g xjk sdg mts kjg gjp and so on agree with field data second the nm of the lower parts of the jing river and js river networks is adjusted so that the simulated water levels at these stations agree with field data these two steps are repeated alternately and advanced in opposite spatial directions to improve the simulation results until both the simulated discharges and water levels throughout the jdt system agree with the field data at the same time the nm was calibrated as 0 029 0 018 0 028 0 020 and 0 022 0 018 respectively for the jing river js river networks and dt lake from upstream to downstream then the process of the 2005 unsteady flow and scalar transport in the jdt system was simulated to demonstrate the accuracy of the hdm and the stm the field data of flows during january 1 to december 31 2005 were used to set the open boundary conditions for the sake of convenience constant scalar concentration of 1 0 kg m3 was set at all inflow open boundaries as a result the scalar transport rate q cs c cs at a cs is equal to the discharge q cs in values theoretically all through the time of a simulation of the scalar transport in the unsteady flows it allows that a mean absolute relative error in simulated q cs c cs eqc and a relative error of mass conservation es can be defined as follows 15 e qc 1 n y l 1 n y q cs c cs q cs 1 kg m 3 q cs 1 kg m 3 l 16 e s l 1 n y t q cs c cs l l 1 n y t q cs 1 kg m 3 l l 1 n y t q cs 1 kg m 3 l where ny is the number of samples and ny 365 for a simulation of 365 day scalar transport process one sample per day t is the time interval of sampling and t 86400 s one sample per day the hdm stm model completed the simulation stably and gave reasonable results in the simulation the water level z cs the q cs and the q cs c cs at cross sections in the jdt system were recorded each day for the hdm the simulated histories of the q cs and the z cs agree well with field data as shown in fig 5 taking stations xinjiangkou xjk guanjiapu gjp shashi ss and yingtian yt as examples the mean absolute error in simulated water levels at gauges is generally 0 12 0 27 m and the relative error in simulated annual water flux eq at cross sections is 1 6 5 2 compared with field data the conservation error of water defined as the difference between the total inflows and outflows in a year is 2 3 10 3 for the stm the simulated histories of cross sectional q cs and q cs c cs at station jl and station xjk are plotted in fig 6 one sample per day because a constant concentration of 1 0 kg m3 is set at all the inflow open boundaries the q cs c cs should be equal to the q cs in values theoretically all the time in the unsteady hydrological process in fig 6 the histories of the simulated q cs are found to be almost the same as those of the simulated q cs c cs the eqc and the es at cross sections are 0 29 0 35 and 0 36 0 46 respectively mass conservation error of the stm mainly arises from disturbances by the error of the hdm the frequent wet and dry alternations of unsteady flows and the rough interpolation in the evaluation of q cs and q cs c cs 4 2 stability tests using different time steps under different flow conditions simulations of the flow and scalar transport are characterized by different cfl levels the stability of a hdm and a stm is often approximately described by the maximum cfl under which stable simulations can be achieved a cfl number at side centers cflj was defined as 17 cf l j u j δ j where uj velocity at side j δj distance between the centers of the two cells that share side j moreover a big cfl ratio was defined as the percent that wet sides of cflj 1 account for of the total sides the process of the 2005 unsteady flow and scalar transport in the jdt system is used to test the stability of the hdm and the stm five time steps 300 600 900 1200 and 1440 s are tested and a sub time step δτ of 100 s is used for backtracking the test results using different time steps are shown in fig 5 when δt is equal or less than 1200 s the models complete the simulation stably the accuracy of the hdm and the stm is almost kept constant when δt changes from 300 to 1200 s the cfl levels of a simulation using a time step of 1200 s is taken as example and analyzed here in the simulation the distribution of the quantities of sides with different levels of cfl in selected months of 2005 is shown in fig 7 a in flood seasons july august the big cfl ratio reaches 73 6 74 2 and about 30 60 sides have a cflj larger than 5 however if the time step continues to increase the time resolution for simulating dry and wet alternations of cross sectional sub grids may gradually become insufficient causing instabilities in this case simulations using the hdm and stm may be unstable in tests when δt is equal to or larger than 1440 s spurious oscillations begin to appear in the simulated histories of discharges or water levels at some cross sections such as station gjp see fig 5b 4 3 efficiency tests sequential versions of the current hdm and stm have been already very efficient because stable and accurate simulations can be achieved at large time steps cfl 1 however efficiencies of the hdm and the stm can be further sharply improved by simple parallelization techniques to achieve real time simulations in this section the parallelized hdm and stm were tested while the runtime reduction brought by the multi scalar property of the ffelm and the nested technique was also clarified for both the hdm and the stm the time step δt is set to 900 s and a sub time step δτ of 100 s is used in the backtracking the scale property of the parallelized hdm and stm is tested using 5 kinds of working cores nc 1 2 4 8 and 16 five simulations using the hdm alone nc 1 16 are run and the runtimes are recorded to clarify the efficiency of the stm in solving multi scalar transport six kinds of scalar numbers n 1 2 4 8 16 and 32 are tested correspondingly 30 simulations using the hdm stm model are run the process of the 2005 unsteady flow and scalar transport in the jdt system is used in the tests in the 1 year simulations runtimes of the stm are recorded see table 1 and the speedups of them are shown in fig 8 first the scale property of the model is discussed runtime of the hdm for 1 year simulation is respectively 97 13 s nc 1 and 10 73 s nc 16 where the speedup nc 16 is 9 0 speedups nc 16 of the stm are 9 8 13 5 under n 1 32 large speedups for the hdm and stm are achieved by the parallel technique second the advantage of the stm in solving multiscalar transport is analyzed in sequential tests the average runtime increment of the stm for solving each added scalar is about 8 6 relative to the runtime of the hdm see table 2 in parallel tests nc 16 the average runtime increment of the stm for solving each added scalar is about 5 9 using the runtime of the hdm as a reference the stm using the ffelm is revealed in tests to be quite efficient in solving the transport of a large number of scalars multiscalar transport third the improvement in efficiency brought by the nested technique is discussed in this part 30 ffelm n simulations are run whose results are compared with those of the ffelm simulations runtime of the stm n 1 is regarded as the startup cost of the stm using the nested technique the startup of the stm is reduced by 33 2 in sequential runs and 26 2 in parallel runs see table 2 the backtracking for the ffelm is only a part of the stm calculations and the runtime of the former accounts for about 50 of that of the latter when n 1 when the number of the scalars increases the proportion of the computation cost of the ffelm backtracking in that of the stm is reduced and the improvement of the nested technique is weakened finally the runtime of the hdm stm model is summarized under n 1 32 speedups of the model nc 16 are 9 3 11 5 and 9 0 11 8 respectively in the ffelm and the ffelm n simulations using a grid of 2382 cells with 113 600 sub grids and a processor with 16 cores the model only takes 33 3 s to complete a simulation of a 1 year process of the unsteady flow and scalar transport 32 kinds of scalars in the jdt system 5 comparison studies the performance of the new model is compared with those of two existing models of the two existing models the first one is a conventional 1d model the mike11 which uses eulerian type schemes and the second one is a 2d model which uses numerical schemes similar to the proposed 1d model 5 1 comparison studies using mike11 5 1 1 theoretical comparisons and preliminary tests according to the user manual of dhi 2014 the mike11 s computational time step is limited by two aspects first as a conventional model using eulerian advection schemes the time step of the mike11 is limited by the cfl restriction of stability the maximum cfl of a hdm and a stm simulation should be less than 1 and 0 5 respectively second the dry wet variations treated using a slot method in the mike11 and the rapidly changing cross sectional geometry cause instabilities and further limit the time step as a result in real applications the mike11 often only allows small time steps for which the cfl is obviously less than 1 relatively the hdm of the new model is unconditionally stable with respect to the wave celerity advection and bottom friction benefiting from the semi implicit method the elm and the implicit discretization of bottom friction as a result the hdm of the new model allows large time steps for which the cfl can be much larger than 1 the inputs of the topographical and hydrological data of the mike11 are the same as those used in the new model in tests of the 2005 unsteady flows in the jdt system using the new model the cfl level of a simulation with δt 120 s is shown in fig 7b for such a test the theoretical maximum time step which the hdm of the mike11 allows is 120 s however it only allows a time step as small as 45 s due to the disturbances caused by dry wet variations and rapidly changing cross sectional geometry the hdm of the new model has been revealed in tests to achieve stably simulations and give accurate results under a time step as large as 1200 s the mike11 and the new model both use a linearization technique for the term a t in continuity equations which simplifies the solution of the hdm and improves its efficiency to be different the hdm of the mike11 adopts a 6 point abbott scheme and its solution takes two steps with the time step being equally split at each step a time consuming iteration is required because of the implicit solution relatively the hdm of the new model which is also an implicit model only needs to solve tridiagonal linear systems for branches and is free of any iteration with the help of the elm the pcm it means that the hdm of the new model may run several times faster than that of the mike11 under the same time step the runtime of the hdm for the 1 year simulation is respectively 6333 0 s using the mike11 and 1925 9 s using the sequential version of new model under a time step of 45 s however the hdm of the new model allows a time step larger than 900 s and the corresponding runtime is less than 97 1 s that is to say the runtime of the hdm of the new model can be more than 65 2 times shorter than that of the mike11 leskens et al 2014 reported that a kind of hdms such as casulli and stelling 2013 allow for computation times that are more than 100 times shorter than conventional models typically this kind of hdms uses a combination of an implicit method for discretizing free surface gradients and the elm for solving advections which are also adopted in the hdm of the new model relative to casulli and stelling 2013 the hdm of the new model linearizes the a t in the continuity equation and adopts the pcm hu et al 2015a 2015b to couple the solutions of branches of a shallow water system as a result our hdm only needs to solve local linear subsystems for branches and is free of any iteration while the hdm of casulli and stelling 2013 has to solve a global nonlinear system for the whole shallow water system using iterative methods 5 1 2 comparisons of accuracy and efficiency to conduct a more general comparison test a local model for the jing river is built by extracting the necessary materials from the jdt model the computational domain of the local model is marked in fig 1 bounded by the dashed line and it is covered by a grid of 388 cells 13 550 sub grids the process of the 2005 unsteady flow and scalar transport is used in tests because the domain characterized by frequent dry wet variations and rapid changing cross sections has been excluded as much as possible the stability of the local model is significantly improved relative to that of the jdt model according to preliminary tests the mike11 can run stably using a time step as large as 120 s for the hdm and 60 s for the stm under which the maximum cfl of the hdm and stm simulation approaches 1 and 0 5 respectively therefore in the comparison tests three time steps δt 60 120 and 900 s are used for the tests of the stm two kinds of scalar numbers n 1 and 32 are used the scale property of a parallelized model is tested using two kinds of working cores nc 1 and 16 the simulated histories of the z cs and the q cs agree with field data as shown in fig 9 taking stations zhicheng zc and luoshan ls as examples in tests using the mike11 δt 120 s the mean absolute error in simulated water levels is 16 8 cm and the relative error in simulated cross sectional discharge is 3 45 compared with field data correspondingly in tests using the new model δt 900 s the mean absolute error in simulated z cs is 17 1 cm and the relative error in simulated q cs is 3 47 the hdms of the new model and the mike11 achieve almost the same accuracy even though the new model uses a much larger time step runtimes of the 1 year simulations are recorded see table 3 and analyzed first the hdm of the new model the former runs 3 0 3 6 times faster than that of the mike11 the latter under the same time step benefiting from the improved stability and much larger time step the former will run 23 3 times faster than the latter second when n 1 the stm of the new model using the ffelm and a nested technique the former runs 8 4 times faster than that of the mike11 the latter under the same time step benefiting from the improved stability and much larger time steps the former will run 80 6 times faster than the latter when the n is increased to 32 the former which benefits from the multiscalar property will run 184 4 times faster than the latter in the hdm stm simulations with n 1 32 a sequential run using the new model runs 48 1 140 6 times faster than that using the mike11 relative to the tests using the jdt system the simulations using the jing river have smaller granularities in terms of a parallel implementation the parallel speedup of the local model is reduced to 5 3 6 9 from 9 0 11 8 of the jdt model when the speedup brought by parallel technique is included nc 16 the new model runs 282 8 966 0 times faster than the mike11 5 2 comparison studies using a 2d model using similar schemes 5 2 1 overview of the 2d model the adopted 2d model hu et al 2015a 2019 uses the depth averaged 2d shallow water equations and the advection diffusion equations as the governing equations it uses numerical schemes similar to the proposed 1d model namely the 2d version of the θ semi implicit method the elm and the fflem as a result the 2d hdm is also unconditionally stable with respect to wave celerity and advection allowing large time steps for which the cfl is larger than 1 the 2d stm has advantages of allowing large time steps parallelizable and multiscalar property the 2d hdm adopts domain decomposition method to treat large shallow water systems and uses the pcm to couple the solutions of subdomains moreover the nested technique proposed in this study is also used to construct a 2d version of the nested fflem also denoted by ffelm n a channel refined unstructured grid hu et al 2015b is used to divide the jdt system and has 327 820 cells it ensures an accurate simulation of the dry season channel flows in a river lake system characterized by compound floodplain channel cross sections and irregular boundaries with as few cells as possible the δt is set to 60 s and is equally divided into 6 sub time steps in the backtracking of the elm or the ffelm ffelm n the 2d model provides an improved description of the physical processes of the flow and scalar transport in a complex and widespread river lake system and improves the accuracy of simulations relative to a 1d model for examples the mean absolute error in simulated water levels is generally less than 0 15 m using the 2d hdm hu et al 2015b and it is increased to 0 12 0 27 m using the 1d hdm besides the macroscopic hydrological information the 2d model can also provide the detailed distributions of velocity field water level and scalar concentration in the horizontal domain despite these advantages a high resolution 2d simulation of a large shallow water system such as the jdt system is time consuming because so many computational cells are involved therefore in the following section the efficiency of the 2d model applied to the jdt system is focused which is compared with that of the proposed 1d model 5 2 2 efficiency tests and discussions first the efficiency of the 2d model is tested under a 1 day steady flow condition of bankfull discharge the runtime of the hdm is 1250 16 s nc 1 and 115 89 s nc 16 the scale property and the multiscalar property of the stm are tested using two kinds of working cores nc 1 and 16 and six kinds of scalar numbers n 1 2 4 8 16 and 32 under the bankfull discharge the wet cell ratio of the grid is 64 7 and there are 214 600 wet cells runtimes of the stm using the ffelm n are compared with those using the ffelm as listed in table 4 in both the sequential and the parallel runs the base cost of the stm n 1 using the ffelm n is shown to be about a half of that using the ffelm the speedup nc 16 is 10 5 8 2 in ffelm runs and is 11 7 9 0 in the ffelm n runs under n 1 32 in sequential tests nc 1 the runtime increments for solving each added scalar using the ffelm and the ffelm n are 5 0 6 6 and 5 6 6 6 respectively relative to the base cost of the stm using the ffelm in parallel tests nc 16 the runtime increments for solving each added scalar using the ffelm and the ffelm n are 7 4 9 3 and 7 0 8 1 respectively second the process of the 2005 unsteady flow and scalar transport in the jdt system is simulated to clarify the difference in efficiency between the 2d and the 1d model in the tests four kinds of scalars and 16 working cores are used the runtimes of the hdms and the stms n 4 and nc 16 are listed in table 5 in a simulation of hydrodynamic and scalar transport in the jdt river lake system the 1d model can run more than 3600 times faster than the 2d model using similar numerical schemes according to the comparison studies when a conventional 1d model e g the mike11 or a 2d high resolution hydro environmental model is nested in an optimization model it is difficult for the former to provide data for the real time calls of the latter because of the long runtime of the hdm and stm such a nesting is useless in real applications the aim of this study is to eliminate the efficiency bottleneck of hydro environmental simulations by constructing new numerical schemes and developing new 1d models 6 discussions in this study real time simulations of hydrodynamic and scalar transport in large river lake systems are realized by constructing new numerical schemes and developing new 1d models in this section the key techniques and the limitations of the models are summarized moreover the possibility of combing the new hydro environmental model with an optimization model is discussed in terms of efficiency 6 1 key techniques used in hdm and stm first this study presents a semi implicit hdm for free surface flows in a river lake system benefiting from the semi implicit method the elm and the implicit discretization of bottom friction the hdm is unconditionally stable with respect to the wave celerity advection and bottom friction moreover the introduction of the pcm allows that a river lake system is described by branches and the hydrodynamics especially the velocity pressure coupling problem of a river lake system can be solved locally based on domain decomposition as a result a very simple formulation for the solution of free surface flows in river lake systems is designed where the hdm only needs to solve 1d tridiagonal linear systems for branches the resulting hdm for river lake systems allows large time steps for which the cfl is greater than 1 and can be well parallelized second a 1d ffelm is proposed for solving advective transport of scalars in 1d grid systems by rebuilding a multi dimensional scheme hu et al 2019 a nested technique is proposed to reduce the ffelm s startup cost associated with trajectory tracking the developed stm allows large time steps for which the cfl is greater than 1 is parallelizable is good at solving the multiscalar transport and has low startup cost the aforementioned advantages of the new hdm and hdm explain why they can run tens or hundreds of times faster than a conventional 1d model using eulerian type numerical schemes 6 2 combination of hdm and stm with optimization models in water resources management simplified hdms e g kinematic wave model diffusion wave model which is computationally efficient are often nested in an optimization model for decision making on the one hand application of the simplified hdms is often limited e g downstream backwater cannot be accounted for and they can only produce rough predictions of flood routing on the other hand optimization models often require thousands of calls of the hydrodynamic calculation so a full hdm also called dynamic wave model which is time consuming is seldom nested in optimization models moreover when a hydro environment issue is included the coupling of an optimization model and a hdm stm model become more difficult because simulations of the transport of scalars further increase the runtime significantly to our best knowledge a real time coupling of the hydro environmental simulation and the optimization calculation has not been reported yet the jdt system is used as an example to analyze the possibility of coupling an optimization model and a hdm stm model for the jdt system covered by a grid of 2382 cells with 113 600 sub grids it takes the model 33 3 s to complete a simulation of a 1 year process of unsteady flow and scalar transport when 32 kinds of scalars and 16 cores are used when an emergency event of water pollutions happens a conventional simulation of a 15 day process of flows and scalar transport will take 1 39 s 5000 times of calls which is generally needed by an optimization model will only take about 2 h because the hdm and stm are both well parallelizable the runtime of the model can be further reduced sharply by using a new processor with more cores in terms of hydro environment managements the developed models are so efficient that they make possible the real time coupling of an optimization model and a hdm stm model for large river lake systems 6 3 limitations of the new model the hdm using the pcm essentially solves quasi coupled subsystems of branches of river networks where only one time data exchange is involved in the solution of subsystems the main inadequacy of the new model is the limitation imposed on the time step by the condition for application of the pcm hu et al 2015a for alluvial river flows this condition is easily satisfied according to former theoretical analysis and tests and large times for which the cfl can be much larger than 1 are allowed that is to say the limitation of this condition is very weak for river lake systems and it can be neglected relative to the cfl restriction associated with eulerian schemes however when the model is used to simulate highly unsteady flows water levels and velocity fields vary fast with respect to time such as tidal flows the time step needs to be small to satisfy the condition of the pcm for application in this case the advantage of the efficiency of the new model does not exist any longer because small time steps are required to ensure the simulation accuracy in this case the model may alternatively resort to the global layer iteration cai et al 2005 zhu et al 2011 to improve the simulation accuracy 7 conclusions this study presents a new 1d hydro environmental model for free surface flows and scalar transport in large river lake systems using a prediction correction method the hydrodynamic is simulated by solving local linear systems based on domain decomposition a flux form elm is constructed to solve advective transport of scalars in 1d grid systems and a nested technique is proposed to reduce its startup cost the resulting stm and hdm both allow large time steps for which the cfl is greater than 1 and can be well parallelized moreover the stm is good at solving multiscalar transport and has low startup cost the new model is tested using the jdt system which is covered by a grid of 2382 cells with 113 600 sub grids stable and accurate simulations are achieved at large time steps for which the cfl can be larger than 5 in the test of scale property of the hdm stm model using 32 kinds of scalars and 16 cores a parallel run is 11 8 times faster than a sequential run and it only takes the new model 33 3 s to complete a simulation of a 1 year process of unsteady flow and scalar transport in the jdt system performance of the new model is also compared with those of a conventional 1d model the mike11 and a 2d model using schemes similar to the new model on the one hand the new model achieves almost the same accuracy as the mike11 and allows a much larger time step a sequential run of the new model runs tens of times faster than that of the mike11 moreover the parallel technique will further enlarge the difference in efficiency between the new model and the mike11 on the other hand the new 1d model can run more than 3600 times faster than the 2d model using similar numerical schemes when a conventional 1d model e g the mike11 or a 2d high resolution model is nested in an optimization model it is difficult for the former to provide data for the real time calls of the latter because of the long runtime of the hydro environmental simulations such a nesting is useless in real applications in this study the efficiency bottleneck of the hydro environmental simulations is eliminated by constructing new schemes and developing new 1d models the developed hdm and stm are so efficient that they make possible the real time coupling of an optimization model and a hdm stm model for large shallow water systems credit authorship contribution statement dechao hu conceptualization methodology software validation writing original draft investigation funding acquisition resources supervision project administration shiming yao methodology software validation writing original draft investigation funding acquisition resources chengkun duan investigation validation visualization writing review editing songping li investigation validation visualization writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements financial support from natural science foundation of hubei province 2019cfb462 national natural science foundation of china 51339001 51779015 51479009 and fundamental research funds for the central universities china 2017kfyxjj197 are acknowledged 
5814,hydroseismograms reflect the oscillations of well water levels caused by seismic waves in this study the relationships between the hydroseismogram oscillation amplitude and three factors seismic magnitude epicentral distance and focal depth in jingle well china were analyzed the results revealed that hydroseismogram amplitude increases exponentially with seismic magnitude as h mag 7 848 10 8 e 2 1690 m 0 047 m m w 5 8 m seismic magnitude decreases exponentially with epicentral distance as h dis 2 1108 10 5 e 2 3864 γ 0 011 γ epicentral distance and decreases exponentially with focal depth as h dep 1 6438 10 3 e 0 0254 d 0 203 d is focal depth however these relationships become uncertain when the epicentral distance exceeds 4000 km and are not applicable to nuclear explosions based upon the single well aquifer model constructed for jingle well the amplification μ of the water level oscillation by ground vibrations μ a b a a r 2 r 2 r 2 depends on the frequency of the water level oscillations for relatively high frequency oscillations caused by earthquakes with relatively small epicentral distances the amplification will be small while for low frequency oscillations caused by earthquakes with relatively large epicentral distances the amplification will be large using the s transform the dominant hydroseismogram period increases with the epicentral distance as τ 0 5826 γ 12 51 which means that the amplification μ increases with the epicentral distance of course the amplitude of ground oscillations will be greatly attenuated with increasing epicentral distance due to the anisotropy of the earth and seismic wave superposition the relationships between the hydroseismogram amplitude and the seismic magnitude epicentral distance and focal depth become blurred or even uncertain with increasing epicentral distance and focal depth leading to poor goodness of fit between the dominant hydroseismogram period and epicentral distance the quantitative relationships between the hydroseismogram amplitude and the seismic magnitude epicentral distance and focal depth which determine the ratio between the amplitudes of water level oscillations and ground vibrations and the relationship between groundwater oscillations and seismic wave transmission are proposed for the first time in the present work these results will improve understanding of hydrogeological conditions and could also be important in identifying reliable earthquake precursors keywords hydroseismogram seismic phase seismic wave groundwater level coseismic response 1 introduction groundwater is incompressible flows easily and is widely distributed thus the groundwater level represents a natural strain gauge with which even microscopic earth strain changes can be observed with a precision of 10 9 under the conditions of a confined aquifer and confined well aquifer system bodvarsson 1970 hsieh et al 1987 xiang et al 2017 numerous studies have been conducted on the coseismic response of the groundwater level primarily by focusing on the response mechanism in one proposed mechanism the aquifer permeability is enhanced by the passage of seismic waves which create periodic tension and compression that dislodge the sediments and blockages in fissures rutter et al 2016 wang et al 2016 fischer et al 2017 shi et al 2018 sun et al 2018a b furthermore the location of the borehole within the aquifer system i e whether it is in a recharge area runoff area or discharge area determines the type of coseismic response of the water level oscillation step up or step down accompanied by aquifer permeability enhancement he and singh 2019 another hypothesis is that the coseismic response of the groundwater level depends on the stress strain state that is the groundwater level will decline in areas of tensional stress but rise in areas of compressive stress wakita 1975 merifield and lamar 1984 roeloffs 1998 ge and stover 2000 jonsson et al 2003 wang and manga 2010 in addition a seismic fault dislocation model was proposed based on the stress strain state mechanism of groundwater level changes king et al 1999 lee et al 2002 a hydroseismogram illustrates water level oscillations in wells caused by seismic waves byerly and blanchard 1935 rexin et al 1962 the oscillation period of a hydroseismogram has been shown to determine the natural period of a borehole he et al 2017 according to the calculation formula 1 1 w ω g h 3 8 d w ω is the resonance frequency g is the acceleration due to gravity h is the water column height within the well casing and d is the length of the filter pipe for the natural period of a borehole presented by cooper et al 1965 the natural period of a borehole can be estimated to be between several seconds and tens of seconds according to the nyquist sampling theorem the sampling frequency is 2 56 4 times the highest signal frequency this relationship requires samples to be acquired at a rate of approximately 1 sample s to record a complete hydroseismogram as the sampling rates of traditional water level recorders are too low hydroseismograms have rarely been analyzed quantitatively seismic waves can affect the consolidation of fractures in aquifers and change the hydrological parameters hydraulic conductivity storage coefficient etc of well aquifer systems montgomery and manga 2003 parotidis et al 2004 mays 2009 manga et al 2012 xiang et al 2017 quantitative studies of the characteristics of hydroseismograms can improve understanding of regional geological structures and hydrogeological conditions and enhance analysis of the regularity of groundwater movements such research could even facilitate the search for earthquake precursors xiang et al 2017 accordingly in the present study we investigated the characteristics of hydroseismograms associated with 75 earthquakes in jingle well over the last three years we determined the quantitative relationships between the hydroseismogram amplitude and the seismic magnitude epicentral distance and focal depth and obtained the ratio between the amplitudes of the water level oscillations and ground vibrations 2 outline of the studied well 2 1 jingle well jingle well longitude 112 03 e latitude 38 35 n elevation 1295 m is located on the eastern edge of the luliang mountains and the dongnianhe fault zone which trends nearly e w this area hosts two main aquifers a lower paleozoic karst aquifer composed of limestone and dolomite and a quaternary alluvial diluvia sand gravel aquifer strong hydraulic movement occurs between these two aquifers karst caves are highly developed fig 1 and groundwater is discharged from n nw to se the jingle well borehole is located in an area of strong runoff groundwater recharge is derived mainly from atmospheric precipitation in areas of exposed bedrock in the northern and southern mountainous regions where the water infiltrates into the fracture zone along the dongnianhe fault jingle well has a depth of 362 92 m of which 0 46 30 m is composed of quaternary alluvial diluvia gravel followed by lower ordovician dolomitic limestone siliceous limestone and upper cambrian argillaceous limestone fig 1 the dynamic water level observation layer is the cambrian and ordovician aquifer characterized by karst fissures and the water rich section is a fault fractured zone with a depth of 229 81 288 76 m the permeability coefficient is 83 787 m d upon well completion the casing and sealing up spans the depth range of 0 53 32 m followed by a bare hole fig 1 in recent years several studies of jingle well have been conducted for instance yu et al 1995 described and analyzed the ability of the jingle well water level to record earthquakes and found oscillation amplitudes of up to dozens of millimeters and an oscillation duration of more than 60 min using an analog water level meter fig 2 zhang et al 2012 discussed the reproducibility of water level precursor waves and lyu et al 2013 investigated anomalies in the water levels of jingle well he et al 2017 acquired a natural period of 12 s for jingle well and proposed the underground reservoir model to explain why the water level oscillated considerably but the groundwater temperature remained unchanged by analyzing the co seismic response to the gorkha nepal mw 7 8 earthquake the water level of jingle well has shown sensitivity to earthquakes and can provide detailed seismic information 2 2 water level observation system a drum type analog water level recorder was previously installed in jingle well the maximum observed amplitudes of the water level fluctuations were recorded but detailed information about the fluctuations was not obtained because the instrument time scale was too short about 20 cm day and the record appeared merely as a thick line transverse to the direction of time movement fig 2 jingle well was equipped with an swy ii water level recorder manufactured by the institute of crustal dynamics cea in 2015 this type of recorder adopts a pressure water level transmitter with an accuracy better than 0 02 m and a resolution of 0 001 m the response speed is better than 5 m 100 ms and the sampling rate is 1 sample s using the equation of the natural frequency obtained by cooper et al 1965 and actual observations the natural frequency of jingle well was determined to be about 12 s he et al 2017 according to the nyquist shannon sampling theorem the employed device can acquire a complete record of water level oscillations the output of this recorder is the distance from the well head to the water surface within the well hence to visualize fluctuations in the groundwater level the y axis needs to be reversed when drawing the observation curve 3 methods 3 1 earthquake selection considering that the water level in jingle well is sensitive to large earthquakes occurring on the global scale 75 earthquakes fig 3 with seismic magnitudes greater than mw 5 5 at epicentral distances within 2000 km seismic magnitudes greater than mw 6 5 at epicentral distances within 4000 km and seismic magnitudes greater than mw 7 0 worldwide were selected the earthquakes selected for this study occurred between 2015 08 30 and 2019 07 30 there were 61 earthquakes with co seismic responses and 14 earthquakes without co seismic responses all of the earthquakes 24 earthquakes with epicentral distances within 4000 km showed co seismic responses except for a nuclear explosion 2017 9 3 mw 6 3 and epicenter distance 1416 km 3 2 oscillation amplitude analysis we took the maximum oscillation amplitude to represent the amplitude in this investigation for example the mw 6 7 earthquake that occurred 140 km wsw of makurazaki japan 31 0009 n and 128 8729 e depth of 12 km on 2015 11 13 at 20 51 at a distance of 1740 km from jingle well caused water level oscillations with a maximum amplitude of 0 206 m fig 4 we obtained the water level oscillation amplitude for each earthquake using the abovementioned calculation method the oscillation amplitude is closely related to the magnitude epicentral distance from the well and focal depth we independently analyzed the relationships between the oscillation amplitude and magnitude between the oscillation amplitude and epicentral distance from the well and between the oscillation amplitude and focal depth because these three factors are completely unrelated for an independent earthquake event it was not suitable to estimate the epicentral distance based on the spherical distance between two points since the earthquake events occurred worldwide thus we examined the abovementioned relationships in two ways according the epicentral distance within 4000 km and globally 3 3 epicentral distance within 4000 km twenty four earthquake events occurred with epicenters within 4000 km of jingle well all of the earthquakes caused co seismic water level responses expect for a nuclear explosion we identified the relationship between the oscillation amplitude and magnitude as the most significant after comparing the relationships between the oscillation amplitude and three factors magnitude epicentral distance and focal depth to minimize the calculation error we firstly analyzed the relationship between the oscillation amplitude and magnitude the relationship between the original oscillation amplitude of the water level h org and the seismic magnitude m is shown in fig 5 a the fitting curve l 1 blue dashed line in fig 5 a of the maximum water level oscillation amplitude caused by the seismic magnitude was acquired through multi point fitting green points in fig 5 a considering l 1 to be the amplitude of oscillations caused by virtual earthquakes within 1500 km and with focal depths less than 40 km the residual represents the difference between the original observation and assumed value the establishment condition of l 1 was magnitudes greater than mw 5 8 1 l 1 h mag 7 848 10 8 e 2 1690 m 0 047 here h mag is the water level oscillation amplitude m m is the moment magnitude and the adjusted coefficient of determination is 0 9893 it can be seen that the maximum water level oscillation amplitude increases exponentially with the seismic magnitude we obtained the residual h mag of the oscillation amplitude after eliminating the magnitude factor by subtracting l 1 from h org h mag h org l 1 the relationship between h mag and the epicentral distance is shown in fig 5 b the fitting curve l 2 blue dashed line in fig 5 b of the maximum value of h mag according to the epicentral distance was acquired through multi point fitting green points in fig 5 b the establishment conditions for l 2 were a magnitude greater than mw 5 8 and an epicentral distance less than 4000 km 2 l 2 h dis 2 1108 10 5 e 2 3864 γ 0 011 here h dis is the oscillation amplitude after eliminating the magnitude factor m γ is the epicentral distance 10 3 km and the adjusted coefficient of determination is 0 9577 hence the oscillation amplitude decreases exponentially with the epicentral distance but is almost unaffected when the epicentral distance is less than 1500 km finally we obtained the residual h dis of the oscillation amplitude after eliminating the epicentral distance factor by subtracting l 1 and l 2 from the original oscillation amplitude h dis h org l 1 l 2 the relationship between h dis and the focal depth is shown in fig 5 c the fitting curve l 3 blue dashed line in fig 5 c of h dis as a function of the focal depth was acquired through multi point fitting green points in fig 5 c 3 l 3 h dep 1 6438 10 3 e 0 0254 d 0 203 here h dep is the oscillation amplitude obtained after eliminating the magnitude and epicentral distance factors m d is the focal depth km and the adjusted coefficient of determination is 0 9935 it can be seen that the oscillation amplitude decreases exponentially with the focal depth in addition the oscillation amplitude is almost independent of the focal depth when the focal depth is less than 40 km however there are three special events in which the focal depth exceeds 190 km we consider these three events table 1 to be the outcomes of too deep of a focal depth 196 km and too great of an epicentral distance 3424 km and to have been produced by anisotropy which was caused by too large of epicentral distances combined with too deep of focal depths 3 4 global earthquake events there were 57 earthquakes with magnitudes greater than 7 0 globally including 44 earthquakes with water level co seismic responses and 13 without responses in jingle well for uniform calculation the oscillation amplitude was assumed to be 0 m when the earthquake did not cause a co seismic water level response we considered the distances between the earthquakes and jingle well in two ways since the earthquake events occurred worldwide linear distance l l and spherical distance l r fig 6 the latitude and longitude of jingle well were assumed to be located at point a x 1 y 1 while the latitude and longitude of the earthquake event were assumed to be at point b x 2 y 2 with x 1 and x 2 being the mean latitudes and y 1 and y 2 the mean longitudes fig 6 l r km between points a and b could easily be obtained using matlab eq 4 4 l r d i s t d i m d i s t a n c e x 1 y 1 x 2 y 2 d e g k i l o m e t e r s then l l km could be calculated using a trigonometric function eq 5 5 l l 2 r 0 sin l r 2 r 0 here r 0 is the radius of the earth and was assumed to be 6371 km the relationship between the oscillation amplitude and distance became clearest after comparing the relationships between the oscillation amplitude and the magnitude distance and focal depth firstly the relationships between the oscillation amplitude and distances linear distance and spherical were analyzed fig 7 two fitting curves l 4 blue dashed line in fig 7 a and l 5 blue dashed line in fig 7 b were acquired using the green points revealing where the oscillation amplitude decreases the fastest with distance 6a l 4 h dis 0 9835 e 0 2505 l l 0 05 6b l 5 h dis 0 9718 e 0 2722 l r 0 09 here h dis is the oscillation amplitude m l l is the linear distance 10 3 k m between the earthquake and jingle well and l r is the spherical distance 10 3 k m between the earthquake and jingle well the adjusted coefficients of determination were determined to be 0 9792 and 0 9794 for l4 and l5 respectively it can be seen that the water level oscillation amplitude decreases exponentially with the epicentral distance h dis was obtained by subtracting l4 and l5 from h org we further analyzed the relationship between h dis and seismic magnitudes fig 8 two fitting curves l 6 blue dashed line in fig 8 a and l 7 blue dashed line in fig 8 b were acquired using the green points revealing where the oscillation amplitude increases the fastest with the seismic magnitude 7a l 6 h mag 5 0009 10 9 e 2 2062 m 0 405 7b l 7 h mag 8 6420 10 9 e 2 1407 m 0 370 here h mag is the oscillation amplitude after eliminating the epicentral distance factor m m is the seismic magnitude and the adjusted coefficients of determination were found to be 0 9950 and 0 9946 for l6 and l7 respectively it can be seen that the water level oscillation amplitude increases exponentially with the seismic magnitude h mag was obtained by subtracting l6 and l7 from h dis we subsequently analyzed the relationship between h mag and the focal depth fig 9 there is no obvious relationship between h mag and the focal depth which exhibits a random state whether calculated using the linear distance fig 9 a or spherical distance fig 9 b 3 5 time frequency analysis to observe the energy distributions of the hydroseismograms in both the time and frequency domains we employed the s transform which uses a gaussian window function where the window width is proportional to the reciprocal of the frequency the s transform is a generalization of the short time fourier transform extending the continuous wavelet transform and overcoming some of its disadvantages additionally the s transform boasts good time frequency characteristics and is suitable for extracting some of the time frequency characteristics of signals stockwell et al 1996 dash et al 2003 two typical earthquakes were selected for time frequency analysis one was a mw 6 7 earthquake that struck japan which was used as a representative earthquake close to jingle well the other event was a mw 8 3 earthquake in chile which was used as a representative earthquake far away from jingle well the dominant frequency of the japan earthquake was approximately 0 07 hz period of approximately 14 29 s fig 10 a and b while that of the chile earthquake was approximately 0 055 hz period of approximately 18 18 s fig 10 c and d time frequency analyses were conducted using the abovementioned method for all of the typical earthquake events that caused the water level oscillation amplitude to exceed 0 01 m table 2 we found that the dominant period increased linearly with increasing spherical epicentral distance table 2 eq 8 8 l 8 τ 0 5826 γ 12 51 here τ is the dominant period s γ is the spherical epicentral distance 10 3 km and the adjusted coefficient of determination is 0 6510 4 results and discussion a well aquifer system is a zero delay system with respect to seismic activity that is the water level responds synchronously to the passage of seismic waves in addition a hydroseismogram can record an abundance of seismic phases blanchard and byerly 1935 kano and yanagidani 2006 accordingly a one dimensional well aquifer system model was proposed liu et al 1986 based on the basic information of jingle well he et al 2017 to analyze the hydroseismogram mechanism the aquifer was assumed to have an infinite ring structure where the outer circle radius r corresponds to the area of the response of the aquifer to an earthquake and the inner circle radius r corresponds to the borehole fig 11 the variations in the aquifer volume caused by ground vibrations can be obtained from v a a a π r 2 π r 2 and the variations in the water level within the borehole can be determined using v b a b π r 2 where a a is the ground vibration a b is the water level oscillation v a is the variation of the aquifer volume and v b is the variation of the water level within the borehole if the aquifer is considered to be an ideal confined aquifer water movement occurs only between the borehole and aquifer and v a v b in other words the water required to increase the water level comes from the aquifer supply and the water is released into the aquifer as the water level decreases under this condition the amplification μ of the groundwater level oscillation due to the ground vibration can be expressed as follows 9 μ a b a a π r 2 π r 2 π r 2 r 2 r 2 r 2 because the borehole radius of a typical aquifer is constant μ depends mainly on the effective response radius r of the aquifer obviously r f τ t is a function of numerous parameters such as the seismic wave period τ s and coefficient of transmissivity t m 2 d based on the single aquifer model wang et al 2004 and the groundwater level response to the wenchuan earthquake of may 2008 in china he and singh 2019 the water level only oscillated without step changes when the earthquake occurred which means that the borehole was located in the runoff area the discharge or recharge capability of an observation well will not be affected if the observation well is far away from the recharge and discharge area even if seismic waves enhance its permeability he and singh 2019 thus the parameters of the well aquifer system can be regarded as the factors that remain unchanged in jingle before and after the earthquake which means that t is a constant and r is determined by τ through the relationship r f τ the amplification is dependent on τ consequently for the same borehole different seismic wave periods will result in different amplifications coincidentally artificial nuclear explosion experiments provide further proof of this assertion nuclear explosions feature some different characteristics for example the p wave amplitude of an artificial explosion is larger than that of the s wave the induced seismic wave has a higher frequency and faster attenuation and the amplitude of the low frequency surface wave is smaller thus nuclear explosions do not cause water level oscillations and constitute a special case when the frequency of seismic activity is high such as for seismic waves produced by nearby earthquakes the water situated far away from the borehole will not have enough time to move the water within the well aquifer system causing r to decrease and the amplification to be relatively small in contrast r increases and the amplification is relatively large if the frequency of seismic activity is low such as for seismic waves generated by extremely distant earthquakes this hypothesis can be proven by analyzing the oscillation amplitude and examining the results of the time frequency analysis the dominant period of water level oscillation increases with a slope of 0 5826 s 1000 km fig 12 with respect to the epicentral distance however the adjusted coefficient of determination of l 8 is only 0 651 which means that the fit is not very good and the dominant period is affected by other factors such as the anisotropy in the earth and focal depth more seismic events and observed data are necessary to analyze the relationships between the dominant period and other factors especially the anisotropy quantitatively in addition the discreteness of l 8 increases markedly when the epicentral distance exceeds a certain value e g 12 000 km which could be due to the combination of seismic waves from different paths obviously it is very complicated to analyze ultra far earthquakes quantitatively because of the anisotropy and seismicwaveformsuperposition we should emphasize that the above quantitative relationships and mechanism are based on an ideal well aquifer system and are not suitable for all observation wells it is necessary for the borehole to bear pressure and to be far away from the aquifer supply discharge area he and singh 2019 the most obvious characteristic is that the coseismic response oscillates rather than changing in steps 5 conclusions a well aquifer system is a zero delay system with respect to earthquake activity consequently many seismic phases are recorded in the hydroseismograms from jingle well the hydroseismogram oscillation amplitude increases exponentially with increasing magnitude but decreases exponentially with the epicentral distance and focal depth when the epicentral distance is less than 4000 km it is difficult to obtain quantitative relationships between the oscillation amplitude and the magnitude epicentral distance and focal depth when the epicentral distance exceeds 4000 km we confirmed that in a cylindrical well aquifer system the magnification of the oscillation amplitude due to ground vibration is determined by the dominant period using the s transform the dominant period of the hydroseismogram increases at a rate of 0 528 s per 1000 km with increasing epicentral distance there is a marked discreteness between the dominant period and epicentral distance especially when the distance exceeds 12 000 km because of the anisotropy of the earth and seismic wave superposition of course wearekeenlyawarethat these quantitative relations are not suitable for all wells and the specific parameters of the quantitative relations should also be closely related to the well aquifer conditions in the future we will continue to carry out the similar research on the multi observed wells and try to summary the rules about the quantitative relations and the well aquifer conditions credit authorship contribution statement anhua he conceptualization methodology software formal analysis investigation resources writing original draft visualization supervision funding acquisition weiping deng software investigation visualization ramesh p singh writing review editing formal analysis fang lyu investigation methodology declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the present study was supported financially by research grants from the institute of crustal dynamics china earthquake administration cea no zdj2018 21 and the national natural science foundation of china 41772256 the authors thank the china earthquake network center for providing the water level data and the united states geological survey for providing the seismic data the authors thank prof sun xiaolong institute of crustal dynamics cea for providing the matlab source code of the s transform the authors are grateful to the two anonymous reviewers the associate editor and editor for their valuable comments and suggestions which have helped us improve the manuscript 
5814,hydroseismograms reflect the oscillations of well water levels caused by seismic waves in this study the relationships between the hydroseismogram oscillation amplitude and three factors seismic magnitude epicentral distance and focal depth in jingle well china were analyzed the results revealed that hydroseismogram amplitude increases exponentially with seismic magnitude as h mag 7 848 10 8 e 2 1690 m 0 047 m m w 5 8 m seismic magnitude decreases exponentially with epicentral distance as h dis 2 1108 10 5 e 2 3864 γ 0 011 γ epicentral distance and decreases exponentially with focal depth as h dep 1 6438 10 3 e 0 0254 d 0 203 d is focal depth however these relationships become uncertain when the epicentral distance exceeds 4000 km and are not applicable to nuclear explosions based upon the single well aquifer model constructed for jingle well the amplification μ of the water level oscillation by ground vibrations μ a b a a r 2 r 2 r 2 depends on the frequency of the water level oscillations for relatively high frequency oscillations caused by earthquakes with relatively small epicentral distances the amplification will be small while for low frequency oscillations caused by earthquakes with relatively large epicentral distances the amplification will be large using the s transform the dominant hydroseismogram period increases with the epicentral distance as τ 0 5826 γ 12 51 which means that the amplification μ increases with the epicentral distance of course the amplitude of ground oscillations will be greatly attenuated with increasing epicentral distance due to the anisotropy of the earth and seismic wave superposition the relationships between the hydroseismogram amplitude and the seismic magnitude epicentral distance and focal depth become blurred or even uncertain with increasing epicentral distance and focal depth leading to poor goodness of fit between the dominant hydroseismogram period and epicentral distance the quantitative relationships between the hydroseismogram amplitude and the seismic magnitude epicentral distance and focal depth which determine the ratio between the amplitudes of water level oscillations and ground vibrations and the relationship between groundwater oscillations and seismic wave transmission are proposed for the first time in the present work these results will improve understanding of hydrogeological conditions and could also be important in identifying reliable earthquake precursors keywords hydroseismogram seismic phase seismic wave groundwater level coseismic response 1 introduction groundwater is incompressible flows easily and is widely distributed thus the groundwater level represents a natural strain gauge with which even microscopic earth strain changes can be observed with a precision of 10 9 under the conditions of a confined aquifer and confined well aquifer system bodvarsson 1970 hsieh et al 1987 xiang et al 2017 numerous studies have been conducted on the coseismic response of the groundwater level primarily by focusing on the response mechanism in one proposed mechanism the aquifer permeability is enhanced by the passage of seismic waves which create periodic tension and compression that dislodge the sediments and blockages in fissures rutter et al 2016 wang et al 2016 fischer et al 2017 shi et al 2018 sun et al 2018a b furthermore the location of the borehole within the aquifer system i e whether it is in a recharge area runoff area or discharge area determines the type of coseismic response of the water level oscillation step up or step down accompanied by aquifer permeability enhancement he and singh 2019 another hypothesis is that the coseismic response of the groundwater level depends on the stress strain state that is the groundwater level will decline in areas of tensional stress but rise in areas of compressive stress wakita 1975 merifield and lamar 1984 roeloffs 1998 ge and stover 2000 jonsson et al 2003 wang and manga 2010 in addition a seismic fault dislocation model was proposed based on the stress strain state mechanism of groundwater level changes king et al 1999 lee et al 2002 a hydroseismogram illustrates water level oscillations in wells caused by seismic waves byerly and blanchard 1935 rexin et al 1962 the oscillation period of a hydroseismogram has been shown to determine the natural period of a borehole he et al 2017 according to the calculation formula 1 1 w ω g h 3 8 d w ω is the resonance frequency g is the acceleration due to gravity h is the water column height within the well casing and d is the length of the filter pipe for the natural period of a borehole presented by cooper et al 1965 the natural period of a borehole can be estimated to be between several seconds and tens of seconds according to the nyquist sampling theorem the sampling frequency is 2 56 4 times the highest signal frequency this relationship requires samples to be acquired at a rate of approximately 1 sample s to record a complete hydroseismogram as the sampling rates of traditional water level recorders are too low hydroseismograms have rarely been analyzed quantitatively seismic waves can affect the consolidation of fractures in aquifers and change the hydrological parameters hydraulic conductivity storage coefficient etc of well aquifer systems montgomery and manga 2003 parotidis et al 2004 mays 2009 manga et al 2012 xiang et al 2017 quantitative studies of the characteristics of hydroseismograms can improve understanding of regional geological structures and hydrogeological conditions and enhance analysis of the regularity of groundwater movements such research could even facilitate the search for earthquake precursors xiang et al 2017 accordingly in the present study we investigated the characteristics of hydroseismograms associated with 75 earthquakes in jingle well over the last three years we determined the quantitative relationships between the hydroseismogram amplitude and the seismic magnitude epicentral distance and focal depth and obtained the ratio between the amplitudes of the water level oscillations and ground vibrations 2 outline of the studied well 2 1 jingle well jingle well longitude 112 03 e latitude 38 35 n elevation 1295 m is located on the eastern edge of the luliang mountains and the dongnianhe fault zone which trends nearly e w this area hosts two main aquifers a lower paleozoic karst aquifer composed of limestone and dolomite and a quaternary alluvial diluvia sand gravel aquifer strong hydraulic movement occurs between these two aquifers karst caves are highly developed fig 1 and groundwater is discharged from n nw to se the jingle well borehole is located in an area of strong runoff groundwater recharge is derived mainly from atmospheric precipitation in areas of exposed bedrock in the northern and southern mountainous regions where the water infiltrates into the fracture zone along the dongnianhe fault jingle well has a depth of 362 92 m of which 0 46 30 m is composed of quaternary alluvial diluvia gravel followed by lower ordovician dolomitic limestone siliceous limestone and upper cambrian argillaceous limestone fig 1 the dynamic water level observation layer is the cambrian and ordovician aquifer characterized by karst fissures and the water rich section is a fault fractured zone with a depth of 229 81 288 76 m the permeability coefficient is 83 787 m d upon well completion the casing and sealing up spans the depth range of 0 53 32 m followed by a bare hole fig 1 in recent years several studies of jingle well have been conducted for instance yu et al 1995 described and analyzed the ability of the jingle well water level to record earthquakes and found oscillation amplitudes of up to dozens of millimeters and an oscillation duration of more than 60 min using an analog water level meter fig 2 zhang et al 2012 discussed the reproducibility of water level precursor waves and lyu et al 2013 investigated anomalies in the water levels of jingle well he et al 2017 acquired a natural period of 12 s for jingle well and proposed the underground reservoir model to explain why the water level oscillated considerably but the groundwater temperature remained unchanged by analyzing the co seismic response to the gorkha nepal mw 7 8 earthquake the water level of jingle well has shown sensitivity to earthquakes and can provide detailed seismic information 2 2 water level observation system a drum type analog water level recorder was previously installed in jingle well the maximum observed amplitudes of the water level fluctuations were recorded but detailed information about the fluctuations was not obtained because the instrument time scale was too short about 20 cm day and the record appeared merely as a thick line transverse to the direction of time movement fig 2 jingle well was equipped with an swy ii water level recorder manufactured by the institute of crustal dynamics cea in 2015 this type of recorder adopts a pressure water level transmitter with an accuracy better than 0 02 m and a resolution of 0 001 m the response speed is better than 5 m 100 ms and the sampling rate is 1 sample s using the equation of the natural frequency obtained by cooper et al 1965 and actual observations the natural frequency of jingle well was determined to be about 12 s he et al 2017 according to the nyquist shannon sampling theorem the employed device can acquire a complete record of water level oscillations the output of this recorder is the distance from the well head to the water surface within the well hence to visualize fluctuations in the groundwater level the y axis needs to be reversed when drawing the observation curve 3 methods 3 1 earthquake selection considering that the water level in jingle well is sensitive to large earthquakes occurring on the global scale 75 earthquakes fig 3 with seismic magnitudes greater than mw 5 5 at epicentral distances within 2000 km seismic magnitudes greater than mw 6 5 at epicentral distances within 4000 km and seismic magnitudes greater than mw 7 0 worldwide were selected the earthquakes selected for this study occurred between 2015 08 30 and 2019 07 30 there were 61 earthquakes with co seismic responses and 14 earthquakes without co seismic responses all of the earthquakes 24 earthquakes with epicentral distances within 4000 km showed co seismic responses except for a nuclear explosion 2017 9 3 mw 6 3 and epicenter distance 1416 km 3 2 oscillation amplitude analysis we took the maximum oscillation amplitude to represent the amplitude in this investigation for example the mw 6 7 earthquake that occurred 140 km wsw of makurazaki japan 31 0009 n and 128 8729 e depth of 12 km on 2015 11 13 at 20 51 at a distance of 1740 km from jingle well caused water level oscillations with a maximum amplitude of 0 206 m fig 4 we obtained the water level oscillation amplitude for each earthquake using the abovementioned calculation method the oscillation amplitude is closely related to the magnitude epicentral distance from the well and focal depth we independently analyzed the relationships between the oscillation amplitude and magnitude between the oscillation amplitude and epicentral distance from the well and between the oscillation amplitude and focal depth because these three factors are completely unrelated for an independent earthquake event it was not suitable to estimate the epicentral distance based on the spherical distance between two points since the earthquake events occurred worldwide thus we examined the abovementioned relationships in two ways according the epicentral distance within 4000 km and globally 3 3 epicentral distance within 4000 km twenty four earthquake events occurred with epicenters within 4000 km of jingle well all of the earthquakes caused co seismic water level responses expect for a nuclear explosion we identified the relationship between the oscillation amplitude and magnitude as the most significant after comparing the relationships between the oscillation amplitude and three factors magnitude epicentral distance and focal depth to minimize the calculation error we firstly analyzed the relationship between the oscillation amplitude and magnitude the relationship between the original oscillation amplitude of the water level h org and the seismic magnitude m is shown in fig 5 a the fitting curve l 1 blue dashed line in fig 5 a of the maximum water level oscillation amplitude caused by the seismic magnitude was acquired through multi point fitting green points in fig 5 a considering l 1 to be the amplitude of oscillations caused by virtual earthquakes within 1500 km and with focal depths less than 40 km the residual represents the difference between the original observation and assumed value the establishment condition of l 1 was magnitudes greater than mw 5 8 1 l 1 h mag 7 848 10 8 e 2 1690 m 0 047 here h mag is the water level oscillation amplitude m m is the moment magnitude and the adjusted coefficient of determination is 0 9893 it can be seen that the maximum water level oscillation amplitude increases exponentially with the seismic magnitude we obtained the residual h mag of the oscillation amplitude after eliminating the magnitude factor by subtracting l 1 from h org h mag h org l 1 the relationship between h mag and the epicentral distance is shown in fig 5 b the fitting curve l 2 blue dashed line in fig 5 b of the maximum value of h mag according to the epicentral distance was acquired through multi point fitting green points in fig 5 b the establishment conditions for l 2 were a magnitude greater than mw 5 8 and an epicentral distance less than 4000 km 2 l 2 h dis 2 1108 10 5 e 2 3864 γ 0 011 here h dis is the oscillation amplitude after eliminating the magnitude factor m γ is the epicentral distance 10 3 km and the adjusted coefficient of determination is 0 9577 hence the oscillation amplitude decreases exponentially with the epicentral distance but is almost unaffected when the epicentral distance is less than 1500 km finally we obtained the residual h dis of the oscillation amplitude after eliminating the epicentral distance factor by subtracting l 1 and l 2 from the original oscillation amplitude h dis h org l 1 l 2 the relationship between h dis and the focal depth is shown in fig 5 c the fitting curve l 3 blue dashed line in fig 5 c of h dis as a function of the focal depth was acquired through multi point fitting green points in fig 5 c 3 l 3 h dep 1 6438 10 3 e 0 0254 d 0 203 here h dep is the oscillation amplitude obtained after eliminating the magnitude and epicentral distance factors m d is the focal depth km and the adjusted coefficient of determination is 0 9935 it can be seen that the oscillation amplitude decreases exponentially with the focal depth in addition the oscillation amplitude is almost independent of the focal depth when the focal depth is less than 40 km however there are three special events in which the focal depth exceeds 190 km we consider these three events table 1 to be the outcomes of too deep of a focal depth 196 km and too great of an epicentral distance 3424 km and to have been produced by anisotropy which was caused by too large of epicentral distances combined with too deep of focal depths 3 4 global earthquake events there were 57 earthquakes with magnitudes greater than 7 0 globally including 44 earthquakes with water level co seismic responses and 13 without responses in jingle well for uniform calculation the oscillation amplitude was assumed to be 0 m when the earthquake did not cause a co seismic water level response we considered the distances between the earthquakes and jingle well in two ways since the earthquake events occurred worldwide linear distance l l and spherical distance l r fig 6 the latitude and longitude of jingle well were assumed to be located at point a x 1 y 1 while the latitude and longitude of the earthquake event were assumed to be at point b x 2 y 2 with x 1 and x 2 being the mean latitudes and y 1 and y 2 the mean longitudes fig 6 l r km between points a and b could easily be obtained using matlab eq 4 4 l r d i s t d i m d i s t a n c e x 1 y 1 x 2 y 2 d e g k i l o m e t e r s then l l km could be calculated using a trigonometric function eq 5 5 l l 2 r 0 sin l r 2 r 0 here r 0 is the radius of the earth and was assumed to be 6371 km the relationship between the oscillation amplitude and distance became clearest after comparing the relationships between the oscillation amplitude and the magnitude distance and focal depth firstly the relationships between the oscillation amplitude and distances linear distance and spherical were analyzed fig 7 two fitting curves l 4 blue dashed line in fig 7 a and l 5 blue dashed line in fig 7 b were acquired using the green points revealing where the oscillation amplitude decreases the fastest with distance 6a l 4 h dis 0 9835 e 0 2505 l l 0 05 6b l 5 h dis 0 9718 e 0 2722 l r 0 09 here h dis is the oscillation amplitude m l l is the linear distance 10 3 k m between the earthquake and jingle well and l r is the spherical distance 10 3 k m between the earthquake and jingle well the adjusted coefficients of determination were determined to be 0 9792 and 0 9794 for l4 and l5 respectively it can be seen that the water level oscillation amplitude decreases exponentially with the epicentral distance h dis was obtained by subtracting l4 and l5 from h org we further analyzed the relationship between h dis and seismic magnitudes fig 8 two fitting curves l 6 blue dashed line in fig 8 a and l 7 blue dashed line in fig 8 b were acquired using the green points revealing where the oscillation amplitude increases the fastest with the seismic magnitude 7a l 6 h mag 5 0009 10 9 e 2 2062 m 0 405 7b l 7 h mag 8 6420 10 9 e 2 1407 m 0 370 here h mag is the oscillation amplitude after eliminating the epicentral distance factor m m is the seismic magnitude and the adjusted coefficients of determination were found to be 0 9950 and 0 9946 for l6 and l7 respectively it can be seen that the water level oscillation amplitude increases exponentially with the seismic magnitude h mag was obtained by subtracting l6 and l7 from h dis we subsequently analyzed the relationship between h mag and the focal depth fig 9 there is no obvious relationship between h mag and the focal depth which exhibits a random state whether calculated using the linear distance fig 9 a or spherical distance fig 9 b 3 5 time frequency analysis to observe the energy distributions of the hydroseismograms in both the time and frequency domains we employed the s transform which uses a gaussian window function where the window width is proportional to the reciprocal of the frequency the s transform is a generalization of the short time fourier transform extending the continuous wavelet transform and overcoming some of its disadvantages additionally the s transform boasts good time frequency characteristics and is suitable for extracting some of the time frequency characteristics of signals stockwell et al 1996 dash et al 2003 two typical earthquakes were selected for time frequency analysis one was a mw 6 7 earthquake that struck japan which was used as a representative earthquake close to jingle well the other event was a mw 8 3 earthquake in chile which was used as a representative earthquake far away from jingle well the dominant frequency of the japan earthquake was approximately 0 07 hz period of approximately 14 29 s fig 10 a and b while that of the chile earthquake was approximately 0 055 hz period of approximately 18 18 s fig 10 c and d time frequency analyses were conducted using the abovementioned method for all of the typical earthquake events that caused the water level oscillation amplitude to exceed 0 01 m table 2 we found that the dominant period increased linearly with increasing spherical epicentral distance table 2 eq 8 8 l 8 τ 0 5826 γ 12 51 here τ is the dominant period s γ is the spherical epicentral distance 10 3 km and the adjusted coefficient of determination is 0 6510 4 results and discussion a well aquifer system is a zero delay system with respect to seismic activity that is the water level responds synchronously to the passage of seismic waves in addition a hydroseismogram can record an abundance of seismic phases blanchard and byerly 1935 kano and yanagidani 2006 accordingly a one dimensional well aquifer system model was proposed liu et al 1986 based on the basic information of jingle well he et al 2017 to analyze the hydroseismogram mechanism the aquifer was assumed to have an infinite ring structure where the outer circle radius r corresponds to the area of the response of the aquifer to an earthquake and the inner circle radius r corresponds to the borehole fig 11 the variations in the aquifer volume caused by ground vibrations can be obtained from v a a a π r 2 π r 2 and the variations in the water level within the borehole can be determined using v b a b π r 2 where a a is the ground vibration a b is the water level oscillation v a is the variation of the aquifer volume and v b is the variation of the water level within the borehole if the aquifer is considered to be an ideal confined aquifer water movement occurs only between the borehole and aquifer and v a v b in other words the water required to increase the water level comes from the aquifer supply and the water is released into the aquifer as the water level decreases under this condition the amplification μ of the groundwater level oscillation due to the ground vibration can be expressed as follows 9 μ a b a a π r 2 π r 2 π r 2 r 2 r 2 r 2 because the borehole radius of a typical aquifer is constant μ depends mainly on the effective response radius r of the aquifer obviously r f τ t is a function of numerous parameters such as the seismic wave period τ s and coefficient of transmissivity t m 2 d based on the single aquifer model wang et al 2004 and the groundwater level response to the wenchuan earthquake of may 2008 in china he and singh 2019 the water level only oscillated without step changes when the earthquake occurred which means that the borehole was located in the runoff area the discharge or recharge capability of an observation well will not be affected if the observation well is far away from the recharge and discharge area even if seismic waves enhance its permeability he and singh 2019 thus the parameters of the well aquifer system can be regarded as the factors that remain unchanged in jingle before and after the earthquake which means that t is a constant and r is determined by τ through the relationship r f τ the amplification is dependent on τ consequently for the same borehole different seismic wave periods will result in different amplifications coincidentally artificial nuclear explosion experiments provide further proof of this assertion nuclear explosions feature some different characteristics for example the p wave amplitude of an artificial explosion is larger than that of the s wave the induced seismic wave has a higher frequency and faster attenuation and the amplitude of the low frequency surface wave is smaller thus nuclear explosions do not cause water level oscillations and constitute a special case when the frequency of seismic activity is high such as for seismic waves produced by nearby earthquakes the water situated far away from the borehole will not have enough time to move the water within the well aquifer system causing r to decrease and the amplification to be relatively small in contrast r increases and the amplification is relatively large if the frequency of seismic activity is low such as for seismic waves generated by extremely distant earthquakes this hypothesis can be proven by analyzing the oscillation amplitude and examining the results of the time frequency analysis the dominant period of water level oscillation increases with a slope of 0 5826 s 1000 km fig 12 with respect to the epicentral distance however the adjusted coefficient of determination of l 8 is only 0 651 which means that the fit is not very good and the dominant period is affected by other factors such as the anisotropy in the earth and focal depth more seismic events and observed data are necessary to analyze the relationships between the dominant period and other factors especially the anisotropy quantitatively in addition the discreteness of l 8 increases markedly when the epicentral distance exceeds a certain value e g 12 000 km which could be due to the combination of seismic waves from different paths obviously it is very complicated to analyze ultra far earthquakes quantitatively because of the anisotropy and seismicwaveformsuperposition we should emphasize that the above quantitative relationships and mechanism are based on an ideal well aquifer system and are not suitable for all observation wells it is necessary for the borehole to bear pressure and to be far away from the aquifer supply discharge area he and singh 2019 the most obvious characteristic is that the coseismic response oscillates rather than changing in steps 5 conclusions a well aquifer system is a zero delay system with respect to earthquake activity consequently many seismic phases are recorded in the hydroseismograms from jingle well the hydroseismogram oscillation amplitude increases exponentially with increasing magnitude but decreases exponentially with the epicentral distance and focal depth when the epicentral distance is less than 4000 km it is difficult to obtain quantitative relationships between the oscillation amplitude and the magnitude epicentral distance and focal depth when the epicentral distance exceeds 4000 km we confirmed that in a cylindrical well aquifer system the magnification of the oscillation amplitude due to ground vibration is determined by the dominant period using the s transform the dominant period of the hydroseismogram increases at a rate of 0 528 s per 1000 km with increasing epicentral distance there is a marked discreteness between the dominant period and epicentral distance especially when the distance exceeds 12 000 km because of the anisotropy of the earth and seismic wave superposition of course wearekeenlyawarethat these quantitative relations are not suitable for all wells and the specific parameters of the quantitative relations should also be closely related to the well aquifer conditions in the future we will continue to carry out the similar research on the multi observed wells and try to summary the rules about the quantitative relations and the well aquifer conditions credit authorship contribution statement anhua he conceptualization methodology software formal analysis investigation resources writing original draft visualization supervision funding acquisition weiping deng software investigation visualization ramesh p singh writing review editing formal analysis fang lyu investigation methodology declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the present study was supported financially by research grants from the institute of crustal dynamics china earthquake administration cea no zdj2018 21 and the national natural science foundation of china 41772256 the authors thank the china earthquake network center for providing the water level data and the united states geological survey for providing the seismic data the authors thank prof sun xiaolong institute of crustal dynamics cea for providing the matlab source code of the s transform the authors are grateful to the two anonymous reviewers the associate editor and editor for their valuable comments and suggestions which have helped us improve the manuscript 
