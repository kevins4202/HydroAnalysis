index,text
715,solute exchange between the pore water of a streambed and overlying flowing surface water can have important effects on the chemical mass balance and biological productivity in the aquatic environment the base mechanism for driving this hyporheic exchange in a moving current is turbulence at the water sediment interface and the water surface slope many previous studies have shown that the nature of the exchange can be significantly modified when spatial pressure variations induced by standing surface waves or bed forms are present in the system in contrast to these studies we consider how transient pressure variations induced by moving waves modify hypothetic exchange this is achieved experimentally by using a vertical array of electrical conductivity probes to track the movement of a conservative solute tracer in the gravel bed of a recirculating laboratory flume under a variety of flow conditions our experimental observations indicate that the addition of traveling waves greatly increases the initial rate and depth of solute penetration into the bed when the analytical solution of a one dimensional vertical advection dispersion model is fit to the experimental measurements it appears that the presence of traveling surface waves results in a more dispersive hyporheic transport through experimental observation model fitting and direct simulation we demonstrate that this apparent dispersion dominated transport is due to the vertical pumping of interstitial fluid in the presence of traveling surface waves from these simulations we develop a relation that for a given set of flow and wave characteristics allows us to estimate the apparent dispersion due to traveling waves keywords hyporheic exchange travelling surface waves gravel bed apparent dispersion advection dispersion model 1 introduction hyporheic exchange is commonly defined as the flow of surface water into and out of a sediment bed harvey and wagner 2000 boano et al 2014 as surface water passes through the sediment interface it mixes with ambient porewater and takes a variety of flow paths from centimeters to kilometers in length harvey and wagner 2000 cardenas et al 2004 boano et al 2006 wörman and wachniew 2007 tonina and buffington 2007 and may penetrate a few millimeters to meters in depth elliot and brooks 1997 wörman et al 2002 2007 cardenas and wilson 2007 higashino and stefan 2008 these flow paths effectively delineate the hyporheic zone and influence the distribution of solutes colloids dissolved gases and suspended sediment in surface water environments and sediment pore water packman and brooks 1995 packman et al 2000 boudreau and jorgensen 2001 wörman et al 2002 cardenas et al 2008 gooseff 2010 grant et al 2014 hyporheic exchange has profound implications for surface water biogeochemistry by mediating processes such as nutrient cycling contaminant transport and remediation thermal exchange and microbial activity bencala et al 1984 findlay 1995 shum and sundby 1996 brunke and gosner 1997 battin 2000 wörman et al 2002 ren and packman 2004 precht et al 2004 battin et al 2008 marzadri et al 2011 2012 2013a 2013b huettel et al 2014 azizian et al 2015 ultimately these processes directly impact water quality and aquatic habitat for example tonina and buffington 2009 showed that exchange of dissolved oxygen do from overlying water into stream gravel beds is necessary for salmonid eggs to survive and to hatch in contrast excessive dissolved organic carbon uptake by a streambed can cause a substantial deterioration of the pore water quality hill 2000 rutherford et al 1993 1995 other researchers have shown conditions that promote biofilm growth diminish the exchange of surface and ground waters battin et al 2003 orr et al 2009 whereas benthic invertebrate activity may promote exchange van rees et al 1996 hyporheic exchange also affects water quality of lake and marine environments dissolved oxygen uptake by organic sediments results in do depletion in the summer and is linked to phosphate release from sediments which in turn can stimulate algal blooms wetzel 2001 sulfate uptake in lake sediments and de nitrification are dependent on interstitial solute transport that controls microbial activities wetzel 2001 these interactions in the near bed environment are the basis of the aquatic food chain and as such are recognized in stream restoration efforts as well as emerging policy kashara et al 2009 tonina and buffington 2009 boulton et al 2010 hester and gooseff 2010 harvey and gooseff 2015 over the past twenty years experimental studies and modeling efforts have greatly improved our understanding of the mechanisms of hyporheic exchange boano et al 2014 cardenas 2015 harvey and gooseff 2015 hyporheic exchange is driven by a combination of physical biological and chemical factors across a large range of spatial and temporal scales cardenas 2008 buffington and tonina 2009 käser et al 2009 stewardson et al 2011 briggs et al 2012 gomez et al 2012 aubeneau et al 2015 mccluskey et al 2016 the exchange between surface water and sediment pore water is driven by fluid motion and its interaction with river and bed morphology bed texture and groundwater flux although large scale topographic and geomorphic features have been shown to be important drivers of hyporheic exchange tonina and buffington 2007 hester and doyle 2008 revelli et al 2008 so called fine scaled hydrodynamic drivers e g surface waves near bed turbulence bed forms also have a role boano et al 2014 while these processes operate on short temporal and spatial scales their contribution to the overall cumulative effect of hyporheic processes at the watershed scale can be important stonedahl et al 2010 2012 gomez and harvey 2014 gomez et al 2015 previous investigators of fine scaled drivers of hyporheic exchange have carefully selected the hydrodynamic processes that operate in their experiments leading to separate studies on the near bed turbulent diffusional transfer due to the slip velocity rahm and svensson 1989 shimizu et al 1990 zhou and mendoza 1993 turbulence penetration into the bed nagaoka and ohgaki 1990 packman et al 2004 tonina and buffington 2007 higashino et al 2009 boano et al 2011 bed forms elliot and brooks 1997 packman et al 2004 bottacin busolin and marion 2010 and standing surface waves e g huettel and webster 2001 qian et al 2008 2009a 2009b cardenas and jiang 2011 geng and boufadel 2015 in the case of bed forms and standing surface waves the hyporheic exchange is driven by the spatially varying pressure field induced on the substrate surface in contrast traveling surface waves induce both a spatially and temporally variable pressure field at the bed surface our interest here is to investigate the behavior of hyporheic exchange under traveling surface waves up to now the effects of traveling surface waves on water and solute exchange within the hyporheic zone have been investigated primarily in marine and lacustrine environments as well as the laboratory riedl et al 1972 webb and theodor 1972 webster and taylor 1992 shum 1992 precht and huettel 2003 habel and bagtzoglou 2005 boufadel et al 2007 king et al 2009 geng and boufadel 2015 the particular interests in our investigation are two fold 1 to quantitatively identify the mechanisms by which traveling waves drive hyporheic exchange and 2 evaluate the relative role of this exchange mechanism in most field and lab investigations changes in solute concentration in the water column are measured for further analysis here as an alternative we track the concentration histories of the solute at specified depths as it moves vertically down through the bed although many previous investigators characterize hyporheic exchange processes as a single diffusion coefficient see grant et al 2012 we employ a one dimensional vertical advection dispersion model we use our experimental data along with the analytical solution to the model to demonstrate that the hyporheic transport is apparently more dispersive in character in the presence of traveling surface waves then through a combination of experimental observation model fitting and direct simulation we argue that this behavior is driven by transient pressure oscillations on the sediment bed induced by the traveling surface waves we then use these arguments to arrive at a quantitative estimate of the apparent dispersion induced by traveling waves 2 methods 2 1 experimental set up a recirculating flume at the university of minnesota s st anthony falls laboratory was used for this study the flume was 9 1 m long 0 51 m wide 0 7 m deep and had a 7 0m long test section filled with a 0 2m deep layer of very well sorted fine free pea gravel with median particle diameter dg 7 2 mm fig 1 the gravel bed in the test section was confined between impermeable boundaries 0 2 m in height at the upstream and downstream end such that the solute could enter the bed only from above the mean bulk porosity ε 0 4 was measured using volumetric displacement the volume of pore water was 286 l which represented approximately 7 of the overall system volume hydraulic conductivity k 18 cm s of the clean sediment was determined using a constant head permeameter the surface of the sediment was leveled in both the longitudinal and cross stream directions such that there was no bed slope and no bed forms though small scale topography did vary locally due to individual grains and grain clusters we were careful not to compact the bed so that the ex situ porosity and hydraulic conductivity measurements would be representative of the test bed the flume had a tailwater box and headwater box connected by a pipe with an impeller pump water is withdrawn from the tailwater box and pumped into the head tank from where it flows into the flume and over the test section flow rate was measured using a sharp crested weir in the head tank and a sluice gate downstream controlled the flow depth instrumentation was deployed from a cart that runs on horizontal rails along the top of the flume 2 2 range of experimental flow conditions in the experiments we systematically vary flow depth and velocity in the flume to generate a range of flow conditions both with and without waves table 1 these flows are in the range of what can be expected in small channels in nature and fit within other experimental studies cataloged by o connor and harvey 2008 and grant et al 2012 a point gauge on the instrument cart was used to measure midstream water surface elevation at 1 m intervals in order to determine the water surface slope the mean water depth above the gravel bed was varied from 9 5 cm to 19 5 cm and the mean flow velocity above the gravel bed ranged from 5 8 cm s to 23 3 cm s in all experiments the water flow was fully turbulent and subcritical 2 3 experimental procedure solute transfer into the sediment bed was tracked by injecting a conservative tracer nacl into the recirculating stream at the tail box the solute was added into the flowing water over approximately one recirculation period 3 5 min depending upon the flow conditions of the flume a vertical array of temperature compensated electrical conductivity probes sensorex cs 150tc were used to track pore water electrical conductivity ec the probes were buried at 5 cm intervals from the bottom of the flume 20 cm depth to the surface and were located 3 5 m downstream of the start of the test section fig 1 electrical conductivity data were logged at six second intervals using a campbell scientific multiplexer electrical conductivity and nacl concentration were related by a linear relationship obtained by calibration 2 4 wave generation a variable speed motor and square plunger 30 cm by 30 cm were used to induce periodic water surface fluctuations at the head of the flume the test section was situated 2 5 m downstream from the wave generator to allow some conditioning of the waveforms before they passed over the test section a series of baffles consisting of nested wire mesh downstream of the test section were used to dissipate the waves thereby eliminating reflected wave interference although the waves had some three dimensional characteristics a progressive wave motion in the downstream direction was clearly observed water surface fluctuations in the transverse direction were much less than in the downstream direction and were ignored wave frequency and wavelength could be changed via the motor speed and the stroke could be adjusted such that the amplitude of the surface wave also could be varied we chose a combination of these three parameters to generate similar waveforms for each run while there was some degree of variability in the characteristic of the waves generated by this process frequencies μ obtained from a spectral analysis were on the order of 1 hz wavelengths were of the order of 100 cm and surface amplitudes aw ranged between 0 5 cm and 1 2 cm with these value ranges estimates for the pressure amplitudes at the bed surface a aw exp 2πh l kinsman 1965 are in the range of 0 15 0 65 cm these wave characteristics are consistent with observations of surface waves at small streams 3 experimental results electrical conductivity ec which is proportional to solute concentration was recorded in the water column and sediment bed for approximately two hours after the initial injection figs 2 and 3 in the early phase of the experiments ec fluctuates in the surface water column as the injected solute passes through the flume the fluctuations generally are fully attenuated by 1000 s and in the later phase approach a final value as solute is transferred into the bed and exchanged with pore water unfortunately the difference between the ambient bed and the surface flow concentration values is not the same in all runs for example the maximum difference is 362 ppm run 3 and the minimum is 118 ppm run 7 we acknowledge that density gradients may contribute to the observed hyporheic exchange e g boano et al 2009 jin et al 2011 but the relatively short duration of our experiments preclude such small concentration differences from affecting our comparisons between runs the concentration gradient of our runs falls within experiments from boano et al 2009 labeled e1 5 as their fig 1 illustrates the change in surface water concentration over 15 h due to density variation is small under flow conditions that are similar to ours most of the changes in our runs take place within an hour after injection and while there may be some effect of different density gradients between the runs they are minor and should not affect our interpretation of the observed trends first we consider runs without waves and observe that increasing flow depth while holding velocity constant decreases the rate and depth of solute penetration into the bed fig 2 runs 1 3 and 5 the solute clearly takes longer to reach the probes as flow depth increases and although the upper two probes reach the surface concentration the 15 cm and 20 cm probes do not we see also a diminished rate of solute exchange and depth of penetration when flow depth is held constant at 19 5 cm and velocity is decreased fig 2 run 5 and fig 3 runs 7 9 and 11 for example the time for the solute to reach the uppermost probe increases with decreasing velocity and the solute does not reach the lower two probes under the slow deep flows of runs 9 and 11 when waves are present we see contrasting exchange behaviors in the upper z 5 cm and 10 cm and lower z 15 cm and 20 cm probes in the presence of waves exchange in the upper half of the bed appears relatively insensitive to changes in flow velocity and depth solute reaches the upper probes quickly under all flow conditions and unlike the wave free runs at the termination of all the wave experiments the upper two probes have nearly reached the surface water value right panels of figs 2 and 3 this is not the case for the lower probe measurements which indicate a dependence on flow conditions for example the bottom probe has approached surface water concentrations by the end of the experiment under deep and fast conditions fig 2 run 6 but barely reaches half the water surface value under slower flows at the same depth fig 3 run 12 comparing paired run e g runs 1 2 3 4 we can see the effects of traveling waves on solute behavior under the same flow conditions for example in the shallow and fast flow of runs 1 and 2 the solute reaches the probes more quickly when waves are present fig 2 we observe also that even in these fast shallow runs solute barely reaches the bottom probe in the absence of waves whereas when waves are present the deepest probe approaches the concentration of the ambient surface water fig 2 runs 1 and 2 in all paired runs regardless of flow conditions we observe that the solute enters the bed more quickly penetrates deeper and accesses a larger portion of the pore water when waves are present figs 2 and 3 in addition to measuring the exchange at the probes we also made videos of the interstitial flow within the bed by using a dye tracer see supporting material these videos illustrate a physical phenomenon that is associated with an enhanced apparent dispersion in the presence of waves in particular we note that the passage of the surface waves creates an alternating pumping motion as can be seen in direct observations of dye injected into the sediment bed the video in our supporting material shows dye injections at 13 cm in depth for runs 1 and 2 h 9 5 cm and u 23 3 cm s for the wave free run left video panel the dye tends to form a plume directly beneath the point of injection that becomes slightly skewed downstream where the dye eventually exits the bed that the dye exits the bed downstream rather than simply traveling longitudinally through the gravel suggests that there are upward pressure gradients likely driven by combination of water surface slope coupled with turbulent momentum transfer across the water sediment interface in contrast with traveling surface waves right video pane the pore water follows orbital paths this greatly enhances the movement of dye into the streambed and its mixing with the surrounding pore water the dye can be seen to pulse at depth with the passage of surface waves the plume becomes larger and penetrates deeper than in the wave free runs it is more difficult to follow the plume as it exits the bed because of the dilution due to the enhanced mixing additional injections into the bed at various depths yielded similar results the orbital motions are attenuated with depth but remain clearly visible we can better delimitate between exchange behavior with and without waves by using our experimental measurements to determine the temporal change in the average concentration in the region z 10 cm our first step is to normalize the measured data to a common scale c we do this by subtracting the initial bed ec value from the measured probe concentrations dividing the results by the prevailing steady state value of the surface probe z 0 cm in addition we also define the zero time t 0 for the data in each run to occur at the point where the surface probe first reaches a value half way between the initial value and the prevailing steady state value with this approach we can use a trapezoidal integration rule 1 c a v e t 2 5 1 2 c 5 c 10 10 where we have assumed that the surface probe takes unit value and ci i 5 10 refers to the normalized measurements at probes 5 cm and 10 cm respectively at early times since we essentially have a step change in concentration between the surface probe and the bed we should not expect this integration to be accurate to overcome this we only report values once the calculated value of cave 2 75 which should be close to the point where the concentration at probe 5 cm starts to increase at earlier times the exchange in the upper portion of the bed when waves are present is dramatically faster fig 4 however in cases where we have higher velocity flows in the channel i e runs 1 3 and 5 as time increases the average value with no waves can catch up and pass the values obtained with waves this is signaled in the plots of fig 4 by noting that the upper probe values for no wave cases plateau first i e reach the surface water concentration value in contrast with waves while the initially faster exchange leads to significant early time penetration the time to reach the plateau is longer fig 4 this is because the surface waves generate an oscillatory motion at depth see supplementary video this motion results in solute accessing a greater proportion of deep fresh pore water figs 2 and 3 which mixes with and dilutes the overlying solute laden water the result for the upper probes is a longer time to plateau under waves in broad terms these two contrasting behaviors can be described by considering the relative roles of advection and dispersion in the case of an advection controlled process we would expect to see that the solute moves into the substrate with a relatively sharp front separating saturated and unsaturated regions at given time after a given amount of solute has been fluxed into the sediment we would see near surface regions of the bed close to saturation and little or no penetration to deeper points below the advection front dispersive behavior in contrast will not produce a sharp front but a more gradual change in concentration for the same amount of solute fluxed into the substrate points near the surface are likely to have smaller concentration values compared to the advection dominated case but at deeper points in the bed the concentration values will be higher than under pure advection hence our results seem to be suggesting that the physical presence of waves induces dispersive behavior that is not present when there are no waves 4 modeling 4 1 a phenomenological model much of the prior research nagaoka and ohgaki 1990 elliot and brooks 1997 packman et al 2004 grant et al 2012 qian et al 2008 2009a 2009b 2013 has suggested that the hyporheic exchange between a solute laden flow and a sediment bed can be modeled with a 1 d transient dispersion through the bed thickness that employs a depth dependent dispersion coefficient here in an alternative approach we will consider a 1 d advection dispersion equation with constant velocity and dispersion coefficient we will demonstrate that this provides a reasonable phenomenological model for our experiments and more importantly provides a clear means by which we can measure the difference between hyporheic exchange between wave and no wave cases using the normalized concentration values the model we propose is 2 c t u c z z d c z 0 with the boundary and initial conditions 3 c z 0 0 0 c 0 t 1 c z t 0 where u is an apparent fluid velocity in the vertical direction d is the apparent dispersion coefficient c z t is the transient solute concentration at a given depth z below the bed surface ci is the initial concentration and c 0 is the fixed initial concentration with this model up to the point where the solute first arrives at the bottom of the bed z 20 cm we assume that exchange at shallower depths z 10 cm can be modeled by the analytical solution of eq 2 4 c z t 1 2 1 erf z u t 4 d t exp z u d 1 erf z u t 4 d t the implicit assumption in using and fitting the model in eq 4 is that the operation and consequences of the myriad of advection and dispersion like solute transport mechanisms operating in the channel substrate can be characterize and grouped into two parameters an apparent vertical velocity u and an apparent dispersion coefficient d below we will use these parameters through the definition of an appropriate peclet number to compare and contrast the level of apparent advection to the level of apparent dispersion in the hyporheic exchange in making this step however it must be recognized that the value of the fitted dispersion coefficient is a direct result of the advection transport processes i e transport by fluid flow operating in the system hence while a relative increase in the value of d over the value of the apparent velocity u means that the nature of hyporheic exchange is more dispersive at the same time it also might indicate that advective transport process in the system are more pronounced it is just that these advective transport processes e g the pumping of the interstitial flow are better characterized in the fitting model by an apparent dispersion term than an apparent vertical velocity 4 2 a least squares fitting to test our proposed phenomenological model we used a non linear regression package to fit the analytical advection dispersion solution in eq 4 to the experimental measurements in this non linear fitting we restrict attention to the normalized concentration measurements in the upper part of the bed where exchange is most active i e z 10 cm over the first 3000 s of the each run where we expect this solution to be valid in most runs we use the lsqnonlin package in matlab to adjust the values of apparent dispersion d and apparent vertical velocity u until the sum of the squares of the difference between the values from eq 4 and the experimental measurements at z 5 cm and z 10 cm is a minimum the exceptions are runs 7 and 9 where due to insufficient measurements at z 10 cm we only fit to the z 5 cm probe and run 11 where there is insufficient measurements to make any fit the resulting fits to the measured data along with the fit values of apparent vertical velocity u cm s and apparent dispersion coefficient d cm2 s and the associated sum of squares are shown in fig 5 waves and fig 6 no waves the fit values are also listed in table 1 along with a calculation of a peclet number with the form 5 p e d g u d where d g 0 72 cm is the size of the gravel for the cases with waves the fit of the advection dispersion model is excellent closely matching the behavior of the solute exchange at both z 5 and z 10 cm fig 5 the fits to the no wave runs are not as good but sufficient to indicate that the advection dispersion model captures the first order characteristics of the solute penetration at shallow depth and early times fig 6 thus a comparison of the fitted values of apparent velocity and apparent dispersion can be used to identify differences in the hyporheic exchange between wave and no waves cases for example we observe a clear separation between the pe numbers in the wave and no wave cases fig 7 a for paired runs 1 2 3 4 etc the no wave peclet numbers are 5 40 fold greater than in the wave cases indicating that the magnitude of the apparent dispersion coefficient is much larger than the apparent vertical velocity when waves are present we do not observe any separation in the fitted values of the vertical velocity fig 7b in contrast we observe a clear separation between the fitted values for the apparent dispersion coefficient fig 7c reinforcing our initial inference from the peclet number plot in fig 7a together these fitted results indicate a strong contrast between the wave and no wave cases hyporheic exchange at shallower depths and early times in the presence of travelling waves i is well modeled by an advection dispersion treatment using a constant vertical velocity and an apparent dispersion coefficient and ii when compared to similar cases without traveling waves this apparent dispersion is significantly an order of magnitude plus larger the question now arises what is the driver of the apparent significant increase in dispersive hyporheic exchange in the presence of a traveling wave existing theory suggests that flow oscillations will enhance dispersive transport fisher et al 1979 e g the enhanced dispersion in tidal estuaries schnoor 1996 indeed previous theory simulations and experiments harrsion et al 1983 webster and taylor 1992 illustrate how wave induced pressure oscillations in coarse gravel substrates lead to a significant enhancement of dispersion in the sediment bed thus our hypothesis is that the flow pumping in the bed observed in the presence of waves is the probable cause of the observed separation in the values of wave and no wave apparent dispersion coefficients seen in our experiments fig 7c 4 3 a direct simulation to support our hypothesis on the role of the wave pumping we will develop a direct numerical simulation of the solute exchange in the bed based on the advection diffusion equation in eq 2 in detail when waves are present this simulation evaluates the oscillating vertical velocity acting in the sediment bed as 6 u t u o a μ sin μ 2 π t where u 0 is a mean vertical velocity cm s μ is the wave frequency 1 hz in our set up and a cm is the pressure amplitude at the sediment bed surface from the basic theory of flow in porous media scheidegger 1954 1961 and the relationship given in wexler 1992 we set the apparent dispersion related to this velocity as 7 d t d g u o a μ sin μ 2 π t where we have assumed that the dispersivity is given by the sediment particle diameter dg 0 72 cm here we emphasis that the flow pumping in the bed is induced by applying a time transient and spatially variable pressure fluctuation at the bed surface this in contrast to the so called advective flow pumping elliot and brooks 1997 bottacin busolin and marion 2010 driven by temporally constant and spatially fixed spatial pressure changes due to bed forms and or standing waves the proposed numerical simulation while still based on the advection dispersion eq 2 differs from the model used in obtaining the fits to measured data in figs 5 and 6 in that fitting we use the analytical solution eq 4 with constant values for apparent vertical velocity u and apparent dispersion d here we are proposing fitting a numerical solution of eq 2 that employs the non constant time oscillating values for the velocity eq 6 and dispersion coefficient eq 7 an explicit central difference solution is used with grid independent space and time steps of δx 1 cm and δt 0 125 our idea in adopting the oscillating vertical velocity is to directly induce the observed pumping in the sediment bed one way to test the validity of this approach would be to adjust the values of the mean velocity u 0 and wave amplitude a until the simulation predictions fit the experimental concentration measurements for the wave cases even numbered runs however since the basic analytical advection dispersion solution in eq 4 has already been shown to provide an accurate model of the hyporheic exchange the alternative is to fit the direct numerical simulation to the analytical solution i e connect the values of u 0 and a in eqs 6 and 7 to the fit values of velocity u and apparent dispersion d given by the even wave runs in table 1 in the first place we simply set the eq 6 mean velocity as u 0 u secondly we equate the integral over one cycle t 1 μ of the transient dispersion d t in eq 7 to the fit value of d formally this second step gives 8 μ 0 1 μ d t d t d g μ 0 1 μ u d t 2 0 1 2 μ a μ sin 2 π μ t d t d which on evaluation setting dg 0 72 and assuming a frequency of μ 1 hz representative of our system allows us to evaluate the amplitude in eq 6 as a π 2 d 0 72 u in this way rather than performing a new formal fitting exercise we directly determine the values for the mean vertical velocity uo and amplitude a used in the direct simulation of the oscillating velocity in terms of the constant values u and d previously obtained from the fit of the analytical advection dispersion solution table 1 this approach essentially provides an exact match between the numerical simulation employing an oscillating velocity eq 6 and dispersion eq 7 and the fitted analytical advection dispersion solution eq 4 using a fixed values for apparent vertical velocity u and apparent dispersion d fig 8 note the values of calculated amplitudes reported in each sub plot of fig 8 are consistent with of the range of bed pressure amplitudes considered to be acting in our experiments 0 15 0 65 cm therefore it is clear that a direct simulation employing an oscillating bed flow velocity provides a sound accounting of the hyporheic exchange observed at early time t 3000 s and shallow depth z 10 cm when waves are present in our experimental flume this allows us to conclude that the observed induced flow pumping in the sediment bed due to pressure fluctuations at the water sediment interface is a likely cause for the observed enhancement in the dispersive nature of hyporheic exchange in the presence of traveling surface waves 5 discussion 5 1 wave pumping as a driver of hyporheic exchange the pumping action of the waves that we observe directly in our experiments has previously been associated with a form of mechanical dispersion referred to as rotational dispersion webster and taylor 1992 in the case of fine sediments experiments have shown that this mechanism of dispersion has little or no effect on hyporheic exchange webster and taylor 1992 precht and huettel 2003 this is to be expected because sediment size and related parameters e g porosity and permeability exert a primary control on exchange with the bed grant et al 2012 however in coarse gravel sediments similar in nature to the substrate of our experiments rotational dispersion greatly enhances pore water exchange with the overlying water column webster and taylor 1992 observations from waves in marine settings suggest that large amplitude waves highly permeable sediments and small flow depths result in an enhanced sediment bed dispersions up to 4 orders of magnitude larger than molecular diffusion harrison et al 1983 modeling work by habel and bagtzoglou 2005 reinforced the role of bed permeability and added that long surface wavelengths relative to the flow depth lead to greater rates of exchange thus because the work presented here uses a coarse gravel bed it is not surprising that we observe the strong influence on hyporheic exchange of the traveling wave induced pumping phenomena additional insight can be gained if using the data reported in table 1 we plot our fitted values of the peclet number for both non wave and wave cases against the channel froude number fig 9 there are a number of meaningful conclusions that can be drawn from this plot in the first place we see that in all cases regardless of the presence or absence of moving waves hyporheic transport under shallower faster flows tends to be less dispersive than in deep slow flows i e the ratio of advection to dispersion increases as the froude number increases note however that the rate of increase in the peclet number with increasing froude is more pronounced in the absence of waves peno fr3 vs pewave f0 9 suggesting that the presence of moving waves suppresses the augmented advective effects of shallow fast flows the reason for this as we ve argued above is that the wave induced advection enhances dispersion and that effect is greater in shallower flows this can be seen in the divergence in the wave vs no wave peclet numbers fig 9 the positive slopes of the lines in the plots indicate also that as the channel flow becomes deeper and or slower the additional dispersive effect in the presence of traveling waves diminishes in fact as the channel flow slows and deepens we may reach a point where the level of apparent dispersion in both the wave and no wave cases is similar this observation is to be expected a deeper slower flow will decrease the surface wave pressure amplitude at the bed surface and is consistent with previous work harrison et al 1983 habel and bagtzoglou 2005 5 2 comparisons of dispersion values reported in the literature our values of apparent dispersion d under waves are consistent with the value of dispersion encountered in previous flume experiments in particular our values of dispersion approach the 1 1 line produced in the meta analysis of flume exchange experiments compiled by grant et al 2012 fig 10 in this respect it is important to note that in contrast to the approach taken here the base model in grant et al 2012 assumes that the exchange in the bed is described by a dispersion alone transport equation in that case the apparent effective dispersion coefficient accounts lumps the effects of both advection and dispersion the fact that the wave enhanced values of d obtained from fitting a two parameter advection dispersion model to our data lie near the 1 1 line provides additional confirmation that under waves the hyporheic exchange is dominated by dispersion like processes fig 10 moreover the apparent diffusion coefficients of our wave runs are consistent with data from other experiments suggesting that the contribution of waves to hyporheic exchange is the same order of magnitude as other fine scale hydrodynamic drivers like near bed turbulence and bed forms another feature of the meta analysis by grant et al 2012 is that under similar channel flow conditions the values of the effective diffusion coefficient between planar and bed form surfaces can take similar values this is clearly reflected in the regression model they use eq 24 in grant et al 2012 which lacks parameters for bed forms e g height and wavelength and yet reasonably predicts the effective diffusion in experiments with and without bed forms this indicates that while the mechanisms of the hyporheic exchange might be quite different between the two cases bed forms or flat bed the lumped apparent dispersion does not capture this difference by contrast in our analysis when waves are not present our fitted dispersion coefficients are clearly removed from the best fit line fig 10 this is because in our advection dispersion model the advective term is the same order of magnitude as the apparent dispersion in the wave free runs table 1 it is only when the advective term becomes small relative to the dispersion term as it does under waves that our apparent dispersion coefficient comes into agreement with the grant et al 2012 dispersion only model 5 3 connection of experiments to field scale in the context of the practicality of our findings we note that while traveling surface waves are more common in lake and coastal environments propagating waves also can be found in streams and channels flow around or over large rocks or large in stream wood riffles and step pool stream morphology can all generate standing waves which can cause traveling surface waves to develop downstream larger rivers with appreciable fetch lengths have surface waves induced by winds much as lakes and estuaries do because the waves propagate downstream of the disturbance the zone of enhanced exchange may extend well beyond the disturbance itself even the wakes from boat traffic may temporally modify the exchange in coarse bedded material in connecting our results to field scales we note that the flow and surface wave conditions in our experiment are not too far removed from those that might be found in natural settings for example our flow depths 9 5 19 5 cm could occur in small streams further due to various forcings e g winds schutten et al 2004 and recreational boat wakes shuster 2017 moving surface waves of frequencies in the range 0 5 to 1 hz and amplitudes in the range 1 to 10 cm are observed in the field it is reasonable to assume therefore that the separation in hypothetic exchange behaviors between the presence and absence of traveling surface waves observed in our flume could occur across a spectrum of natural systems at the same time however it could be argued that depth might be a limiting factor on the extent of the enhanced hyporheic exchange observed under traveling waves as water depths become deeper than the maximum 20 cm used in our experiments will the value of the resulting apparent dispersion become negligible as the depth increase what wave frequencies and amplitudes will be required to maintain the value of d the following manipulation of eq 8 provides us a means to answer these questions on its integration we arrive at the following expression for determining the apparent dispersion observed in our experiments 9 d d g u 2 μ a π we can simplify eq 9 by assuming that exchange in the presence of a wave as shown in our analysis above will be diffusive dominated allowing us to ignore the vertical velocity term further we can use the treatment in kinsman 1965 to replace the amplitude of the pressure wave at the bed surface with the amplitude of the wave itself a aw exp 2πh l giving us 10 d d g 2 μ a w π exp 2 π h l recall h is the flow depth and l is the surface wave length this expression provides a means by which we might determine for particular wave characteristics aw μ and l the magnitude of the apparent dispersion d we emphasize that this formula only determines the contribution to an apparent dispersion due to the presence of traveling waves in field settings additional large and small scale drivers e g higher flow velocities bed forms meanders groundwater flux will contribute to hyporheic exchange as well further research is needed to determine under what field settings traveling waves will be a significant contributor to the overall hyporheic exchange one way to use eq 10 is in assessment on the effect of flow depth for our typical experimental data dg 0 72 cm aw 1 cm μ 1 hz l 100 cm and h 20 cm eq 10 gives a value of d 0 13 cm2 s on first sight eq 10 suggests that as flow depth increases this value of d will decrease exponentially in practice however we may expect the rate of this decay to be slowed by an increase with depth in wavelength and amplitude for example a field observation of a boat wake table 2 in shuster 2017 reports at a water depth of 99 cm aw 6 cm μ 0 5 hz and l 658 cm assuming the same substrate as our experiments these values would result in an increase value d 0 53 cm2 s eq 10 indicates also a direct dependence of apparent diffusion on grain size an observation that is consistent with other studies e g richardson and parr 1988 nagaoka and ohgaki 1990 webster and taylor 1992 grant et al 2012 it is therefore expected that the apparent diffusion will decrease substantially as sediment fines webster and taylor 1992 for example showed very high exchange rates under waves in a substrate consisting of 3 mm pebbles but virtually no exchange when sediment size was sub millimeter based on those experiments we expect this relation eq 10 to apply as long as the sediment is of coarse sand or larger another possible factor to consider in connecting our findings to natural settings is the time scale of the transport phenomena marion and zaramella 2005 cautioned that if the time scale of the transport differs between laboratory and natural settings the phenomenological model used to describe the experiments may not be applicable at the field scale as noted above our experimental conditions are not too far removed from many natural surface waters we expect then that the drivers which would affect the time scale of exchange should also be similar 6 summary and conclusions previous studies have elucidated the important role of traveling surface waves on hyporheic exchange in lacustrine and coastal settings however no one has investigated their role in the riverine environment direct observations of conservative tracer behavior in a coarse bedded recirculating flume indicate an alternating pumping motion of the interstitial fluid in the presence of traveling surface waves this pumping action generates an additional transport mechanism which results in solute penetrating more quickly and deeply into the gravel bed and influences a greater proportion of the pore water in order to make a quantitative comparison between wave and wave free measurements we fitted an analytical solution for advection dispersion transport to our experimental measurements for times less than 3000 s on the order of ½ an experimental duration and at sediment depths less than 10 cm 1 2 of the bed thickness this model on adjusting the parameter values of apparent vertical velocity and apparent dispersion provide an excellent fit to the experimental concentration measurements in the presence of waves when waves are not present the fit is weaker but still adequately captures the characteristics of the solute penetration in the upper half of the bed comparison of the fitted values revealed for experiment runs with the same surface flow characteristics i e velocity depth and slope a clear separation in the values of the apparent dispersion coefficient in the presence of traveling surface waves apparent dispersion coefficient are an order of magnitude or more larger than runs without waves indicating that hyporheic exchange is dominated by a different process when waves are present an alternative model for the solute exchange in our flume s sediment bed was based on a numerical simulation of the advection dispersion equation that directly accounted for vertical oscillations of the interstitial flow a scenario that is known to generate dispersive transport with an appropriate deterministic setting of the amplitude of the fluctuation driving the oscillating velocity in this simulation we were able to essentially match the previous model based on the fit of the analytical solution thus this simulation not only confirms the role of the previously noted flow pumping induced by traveling waves it also provides an experimentally validated deterministic model for this process in turn for a given a set of wave flow and substrate characteristics this model provides a quantification of the level of hyporheic exchange that might be expected in the presence of traveling waves acknowledgments this work was partially supported by the stc program of the national science foundation via the national center for earth surface dynamics under the agreement number ear 0120914 we offer special thanks to garrett katerzynske for assistance in video editing we also thank the editor and reviewers who provided valuable insights and critical suggestions on how to improve not only the manuscript but also the analysis supplementary material supplementary material associated with this article can be found in the online version at doi 10 1016 j advwatres 2018 11 005 appendix supplementary materials image video 1 
715,solute exchange between the pore water of a streambed and overlying flowing surface water can have important effects on the chemical mass balance and biological productivity in the aquatic environment the base mechanism for driving this hyporheic exchange in a moving current is turbulence at the water sediment interface and the water surface slope many previous studies have shown that the nature of the exchange can be significantly modified when spatial pressure variations induced by standing surface waves or bed forms are present in the system in contrast to these studies we consider how transient pressure variations induced by moving waves modify hypothetic exchange this is achieved experimentally by using a vertical array of electrical conductivity probes to track the movement of a conservative solute tracer in the gravel bed of a recirculating laboratory flume under a variety of flow conditions our experimental observations indicate that the addition of traveling waves greatly increases the initial rate and depth of solute penetration into the bed when the analytical solution of a one dimensional vertical advection dispersion model is fit to the experimental measurements it appears that the presence of traveling surface waves results in a more dispersive hyporheic transport through experimental observation model fitting and direct simulation we demonstrate that this apparent dispersion dominated transport is due to the vertical pumping of interstitial fluid in the presence of traveling surface waves from these simulations we develop a relation that for a given set of flow and wave characteristics allows us to estimate the apparent dispersion due to traveling waves keywords hyporheic exchange travelling surface waves gravel bed apparent dispersion advection dispersion model 1 introduction hyporheic exchange is commonly defined as the flow of surface water into and out of a sediment bed harvey and wagner 2000 boano et al 2014 as surface water passes through the sediment interface it mixes with ambient porewater and takes a variety of flow paths from centimeters to kilometers in length harvey and wagner 2000 cardenas et al 2004 boano et al 2006 wörman and wachniew 2007 tonina and buffington 2007 and may penetrate a few millimeters to meters in depth elliot and brooks 1997 wörman et al 2002 2007 cardenas and wilson 2007 higashino and stefan 2008 these flow paths effectively delineate the hyporheic zone and influence the distribution of solutes colloids dissolved gases and suspended sediment in surface water environments and sediment pore water packman and brooks 1995 packman et al 2000 boudreau and jorgensen 2001 wörman et al 2002 cardenas et al 2008 gooseff 2010 grant et al 2014 hyporheic exchange has profound implications for surface water biogeochemistry by mediating processes such as nutrient cycling contaminant transport and remediation thermal exchange and microbial activity bencala et al 1984 findlay 1995 shum and sundby 1996 brunke and gosner 1997 battin 2000 wörman et al 2002 ren and packman 2004 precht et al 2004 battin et al 2008 marzadri et al 2011 2012 2013a 2013b huettel et al 2014 azizian et al 2015 ultimately these processes directly impact water quality and aquatic habitat for example tonina and buffington 2009 showed that exchange of dissolved oxygen do from overlying water into stream gravel beds is necessary for salmonid eggs to survive and to hatch in contrast excessive dissolved organic carbon uptake by a streambed can cause a substantial deterioration of the pore water quality hill 2000 rutherford et al 1993 1995 other researchers have shown conditions that promote biofilm growth diminish the exchange of surface and ground waters battin et al 2003 orr et al 2009 whereas benthic invertebrate activity may promote exchange van rees et al 1996 hyporheic exchange also affects water quality of lake and marine environments dissolved oxygen uptake by organic sediments results in do depletion in the summer and is linked to phosphate release from sediments which in turn can stimulate algal blooms wetzel 2001 sulfate uptake in lake sediments and de nitrification are dependent on interstitial solute transport that controls microbial activities wetzel 2001 these interactions in the near bed environment are the basis of the aquatic food chain and as such are recognized in stream restoration efforts as well as emerging policy kashara et al 2009 tonina and buffington 2009 boulton et al 2010 hester and gooseff 2010 harvey and gooseff 2015 over the past twenty years experimental studies and modeling efforts have greatly improved our understanding of the mechanisms of hyporheic exchange boano et al 2014 cardenas 2015 harvey and gooseff 2015 hyporheic exchange is driven by a combination of physical biological and chemical factors across a large range of spatial and temporal scales cardenas 2008 buffington and tonina 2009 käser et al 2009 stewardson et al 2011 briggs et al 2012 gomez et al 2012 aubeneau et al 2015 mccluskey et al 2016 the exchange between surface water and sediment pore water is driven by fluid motion and its interaction with river and bed morphology bed texture and groundwater flux although large scale topographic and geomorphic features have been shown to be important drivers of hyporheic exchange tonina and buffington 2007 hester and doyle 2008 revelli et al 2008 so called fine scaled hydrodynamic drivers e g surface waves near bed turbulence bed forms also have a role boano et al 2014 while these processes operate on short temporal and spatial scales their contribution to the overall cumulative effect of hyporheic processes at the watershed scale can be important stonedahl et al 2010 2012 gomez and harvey 2014 gomez et al 2015 previous investigators of fine scaled drivers of hyporheic exchange have carefully selected the hydrodynamic processes that operate in their experiments leading to separate studies on the near bed turbulent diffusional transfer due to the slip velocity rahm and svensson 1989 shimizu et al 1990 zhou and mendoza 1993 turbulence penetration into the bed nagaoka and ohgaki 1990 packman et al 2004 tonina and buffington 2007 higashino et al 2009 boano et al 2011 bed forms elliot and brooks 1997 packman et al 2004 bottacin busolin and marion 2010 and standing surface waves e g huettel and webster 2001 qian et al 2008 2009a 2009b cardenas and jiang 2011 geng and boufadel 2015 in the case of bed forms and standing surface waves the hyporheic exchange is driven by the spatially varying pressure field induced on the substrate surface in contrast traveling surface waves induce both a spatially and temporally variable pressure field at the bed surface our interest here is to investigate the behavior of hyporheic exchange under traveling surface waves up to now the effects of traveling surface waves on water and solute exchange within the hyporheic zone have been investigated primarily in marine and lacustrine environments as well as the laboratory riedl et al 1972 webb and theodor 1972 webster and taylor 1992 shum 1992 precht and huettel 2003 habel and bagtzoglou 2005 boufadel et al 2007 king et al 2009 geng and boufadel 2015 the particular interests in our investigation are two fold 1 to quantitatively identify the mechanisms by which traveling waves drive hyporheic exchange and 2 evaluate the relative role of this exchange mechanism in most field and lab investigations changes in solute concentration in the water column are measured for further analysis here as an alternative we track the concentration histories of the solute at specified depths as it moves vertically down through the bed although many previous investigators characterize hyporheic exchange processes as a single diffusion coefficient see grant et al 2012 we employ a one dimensional vertical advection dispersion model we use our experimental data along with the analytical solution to the model to demonstrate that the hyporheic transport is apparently more dispersive in character in the presence of traveling surface waves then through a combination of experimental observation model fitting and direct simulation we argue that this behavior is driven by transient pressure oscillations on the sediment bed induced by the traveling surface waves we then use these arguments to arrive at a quantitative estimate of the apparent dispersion induced by traveling waves 2 methods 2 1 experimental set up a recirculating flume at the university of minnesota s st anthony falls laboratory was used for this study the flume was 9 1 m long 0 51 m wide 0 7 m deep and had a 7 0m long test section filled with a 0 2m deep layer of very well sorted fine free pea gravel with median particle diameter dg 7 2 mm fig 1 the gravel bed in the test section was confined between impermeable boundaries 0 2 m in height at the upstream and downstream end such that the solute could enter the bed only from above the mean bulk porosity ε 0 4 was measured using volumetric displacement the volume of pore water was 286 l which represented approximately 7 of the overall system volume hydraulic conductivity k 18 cm s of the clean sediment was determined using a constant head permeameter the surface of the sediment was leveled in both the longitudinal and cross stream directions such that there was no bed slope and no bed forms though small scale topography did vary locally due to individual grains and grain clusters we were careful not to compact the bed so that the ex situ porosity and hydraulic conductivity measurements would be representative of the test bed the flume had a tailwater box and headwater box connected by a pipe with an impeller pump water is withdrawn from the tailwater box and pumped into the head tank from where it flows into the flume and over the test section flow rate was measured using a sharp crested weir in the head tank and a sluice gate downstream controlled the flow depth instrumentation was deployed from a cart that runs on horizontal rails along the top of the flume 2 2 range of experimental flow conditions in the experiments we systematically vary flow depth and velocity in the flume to generate a range of flow conditions both with and without waves table 1 these flows are in the range of what can be expected in small channels in nature and fit within other experimental studies cataloged by o connor and harvey 2008 and grant et al 2012 a point gauge on the instrument cart was used to measure midstream water surface elevation at 1 m intervals in order to determine the water surface slope the mean water depth above the gravel bed was varied from 9 5 cm to 19 5 cm and the mean flow velocity above the gravel bed ranged from 5 8 cm s to 23 3 cm s in all experiments the water flow was fully turbulent and subcritical 2 3 experimental procedure solute transfer into the sediment bed was tracked by injecting a conservative tracer nacl into the recirculating stream at the tail box the solute was added into the flowing water over approximately one recirculation period 3 5 min depending upon the flow conditions of the flume a vertical array of temperature compensated electrical conductivity probes sensorex cs 150tc were used to track pore water electrical conductivity ec the probes were buried at 5 cm intervals from the bottom of the flume 20 cm depth to the surface and were located 3 5 m downstream of the start of the test section fig 1 electrical conductivity data were logged at six second intervals using a campbell scientific multiplexer electrical conductivity and nacl concentration were related by a linear relationship obtained by calibration 2 4 wave generation a variable speed motor and square plunger 30 cm by 30 cm were used to induce periodic water surface fluctuations at the head of the flume the test section was situated 2 5 m downstream from the wave generator to allow some conditioning of the waveforms before they passed over the test section a series of baffles consisting of nested wire mesh downstream of the test section were used to dissipate the waves thereby eliminating reflected wave interference although the waves had some three dimensional characteristics a progressive wave motion in the downstream direction was clearly observed water surface fluctuations in the transverse direction were much less than in the downstream direction and were ignored wave frequency and wavelength could be changed via the motor speed and the stroke could be adjusted such that the amplitude of the surface wave also could be varied we chose a combination of these three parameters to generate similar waveforms for each run while there was some degree of variability in the characteristic of the waves generated by this process frequencies μ obtained from a spectral analysis were on the order of 1 hz wavelengths were of the order of 100 cm and surface amplitudes aw ranged between 0 5 cm and 1 2 cm with these value ranges estimates for the pressure amplitudes at the bed surface a aw exp 2πh l kinsman 1965 are in the range of 0 15 0 65 cm these wave characteristics are consistent with observations of surface waves at small streams 3 experimental results electrical conductivity ec which is proportional to solute concentration was recorded in the water column and sediment bed for approximately two hours after the initial injection figs 2 and 3 in the early phase of the experiments ec fluctuates in the surface water column as the injected solute passes through the flume the fluctuations generally are fully attenuated by 1000 s and in the later phase approach a final value as solute is transferred into the bed and exchanged with pore water unfortunately the difference between the ambient bed and the surface flow concentration values is not the same in all runs for example the maximum difference is 362 ppm run 3 and the minimum is 118 ppm run 7 we acknowledge that density gradients may contribute to the observed hyporheic exchange e g boano et al 2009 jin et al 2011 but the relatively short duration of our experiments preclude such small concentration differences from affecting our comparisons between runs the concentration gradient of our runs falls within experiments from boano et al 2009 labeled e1 5 as their fig 1 illustrates the change in surface water concentration over 15 h due to density variation is small under flow conditions that are similar to ours most of the changes in our runs take place within an hour after injection and while there may be some effect of different density gradients between the runs they are minor and should not affect our interpretation of the observed trends first we consider runs without waves and observe that increasing flow depth while holding velocity constant decreases the rate and depth of solute penetration into the bed fig 2 runs 1 3 and 5 the solute clearly takes longer to reach the probes as flow depth increases and although the upper two probes reach the surface concentration the 15 cm and 20 cm probes do not we see also a diminished rate of solute exchange and depth of penetration when flow depth is held constant at 19 5 cm and velocity is decreased fig 2 run 5 and fig 3 runs 7 9 and 11 for example the time for the solute to reach the uppermost probe increases with decreasing velocity and the solute does not reach the lower two probes under the slow deep flows of runs 9 and 11 when waves are present we see contrasting exchange behaviors in the upper z 5 cm and 10 cm and lower z 15 cm and 20 cm probes in the presence of waves exchange in the upper half of the bed appears relatively insensitive to changes in flow velocity and depth solute reaches the upper probes quickly under all flow conditions and unlike the wave free runs at the termination of all the wave experiments the upper two probes have nearly reached the surface water value right panels of figs 2 and 3 this is not the case for the lower probe measurements which indicate a dependence on flow conditions for example the bottom probe has approached surface water concentrations by the end of the experiment under deep and fast conditions fig 2 run 6 but barely reaches half the water surface value under slower flows at the same depth fig 3 run 12 comparing paired run e g runs 1 2 3 4 we can see the effects of traveling waves on solute behavior under the same flow conditions for example in the shallow and fast flow of runs 1 and 2 the solute reaches the probes more quickly when waves are present fig 2 we observe also that even in these fast shallow runs solute barely reaches the bottom probe in the absence of waves whereas when waves are present the deepest probe approaches the concentration of the ambient surface water fig 2 runs 1 and 2 in all paired runs regardless of flow conditions we observe that the solute enters the bed more quickly penetrates deeper and accesses a larger portion of the pore water when waves are present figs 2 and 3 in addition to measuring the exchange at the probes we also made videos of the interstitial flow within the bed by using a dye tracer see supporting material these videos illustrate a physical phenomenon that is associated with an enhanced apparent dispersion in the presence of waves in particular we note that the passage of the surface waves creates an alternating pumping motion as can be seen in direct observations of dye injected into the sediment bed the video in our supporting material shows dye injections at 13 cm in depth for runs 1 and 2 h 9 5 cm and u 23 3 cm s for the wave free run left video panel the dye tends to form a plume directly beneath the point of injection that becomes slightly skewed downstream where the dye eventually exits the bed that the dye exits the bed downstream rather than simply traveling longitudinally through the gravel suggests that there are upward pressure gradients likely driven by combination of water surface slope coupled with turbulent momentum transfer across the water sediment interface in contrast with traveling surface waves right video pane the pore water follows orbital paths this greatly enhances the movement of dye into the streambed and its mixing with the surrounding pore water the dye can be seen to pulse at depth with the passage of surface waves the plume becomes larger and penetrates deeper than in the wave free runs it is more difficult to follow the plume as it exits the bed because of the dilution due to the enhanced mixing additional injections into the bed at various depths yielded similar results the orbital motions are attenuated with depth but remain clearly visible we can better delimitate between exchange behavior with and without waves by using our experimental measurements to determine the temporal change in the average concentration in the region z 10 cm our first step is to normalize the measured data to a common scale c we do this by subtracting the initial bed ec value from the measured probe concentrations dividing the results by the prevailing steady state value of the surface probe z 0 cm in addition we also define the zero time t 0 for the data in each run to occur at the point where the surface probe first reaches a value half way between the initial value and the prevailing steady state value with this approach we can use a trapezoidal integration rule 1 c a v e t 2 5 1 2 c 5 c 10 10 where we have assumed that the surface probe takes unit value and ci i 5 10 refers to the normalized measurements at probes 5 cm and 10 cm respectively at early times since we essentially have a step change in concentration between the surface probe and the bed we should not expect this integration to be accurate to overcome this we only report values once the calculated value of cave 2 75 which should be close to the point where the concentration at probe 5 cm starts to increase at earlier times the exchange in the upper portion of the bed when waves are present is dramatically faster fig 4 however in cases where we have higher velocity flows in the channel i e runs 1 3 and 5 as time increases the average value with no waves can catch up and pass the values obtained with waves this is signaled in the plots of fig 4 by noting that the upper probe values for no wave cases plateau first i e reach the surface water concentration value in contrast with waves while the initially faster exchange leads to significant early time penetration the time to reach the plateau is longer fig 4 this is because the surface waves generate an oscillatory motion at depth see supplementary video this motion results in solute accessing a greater proportion of deep fresh pore water figs 2 and 3 which mixes with and dilutes the overlying solute laden water the result for the upper probes is a longer time to plateau under waves in broad terms these two contrasting behaviors can be described by considering the relative roles of advection and dispersion in the case of an advection controlled process we would expect to see that the solute moves into the substrate with a relatively sharp front separating saturated and unsaturated regions at given time after a given amount of solute has been fluxed into the sediment we would see near surface regions of the bed close to saturation and little or no penetration to deeper points below the advection front dispersive behavior in contrast will not produce a sharp front but a more gradual change in concentration for the same amount of solute fluxed into the substrate points near the surface are likely to have smaller concentration values compared to the advection dominated case but at deeper points in the bed the concentration values will be higher than under pure advection hence our results seem to be suggesting that the physical presence of waves induces dispersive behavior that is not present when there are no waves 4 modeling 4 1 a phenomenological model much of the prior research nagaoka and ohgaki 1990 elliot and brooks 1997 packman et al 2004 grant et al 2012 qian et al 2008 2009a 2009b 2013 has suggested that the hyporheic exchange between a solute laden flow and a sediment bed can be modeled with a 1 d transient dispersion through the bed thickness that employs a depth dependent dispersion coefficient here in an alternative approach we will consider a 1 d advection dispersion equation with constant velocity and dispersion coefficient we will demonstrate that this provides a reasonable phenomenological model for our experiments and more importantly provides a clear means by which we can measure the difference between hyporheic exchange between wave and no wave cases using the normalized concentration values the model we propose is 2 c t u c z z d c z 0 with the boundary and initial conditions 3 c z 0 0 0 c 0 t 1 c z t 0 where u is an apparent fluid velocity in the vertical direction d is the apparent dispersion coefficient c z t is the transient solute concentration at a given depth z below the bed surface ci is the initial concentration and c 0 is the fixed initial concentration with this model up to the point where the solute first arrives at the bottom of the bed z 20 cm we assume that exchange at shallower depths z 10 cm can be modeled by the analytical solution of eq 2 4 c z t 1 2 1 erf z u t 4 d t exp z u d 1 erf z u t 4 d t the implicit assumption in using and fitting the model in eq 4 is that the operation and consequences of the myriad of advection and dispersion like solute transport mechanisms operating in the channel substrate can be characterize and grouped into two parameters an apparent vertical velocity u and an apparent dispersion coefficient d below we will use these parameters through the definition of an appropriate peclet number to compare and contrast the level of apparent advection to the level of apparent dispersion in the hyporheic exchange in making this step however it must be recognized that the value of the fitted dispersion coefficient is a direct result of the advection transport processes i e transport by fluid flow operating in the system hence while a relative increase in the value of d over the value of the apparent velocity u means that the nature of hyporheic exchange is more dispersive at the same time it also might indicate that advective transport process in the system are more pronounced it is just that these advective transport processes e g the pumping of the interstitial flow are better characterized in the fitting model by an apparent dispersion term than an apparent vertical velocity 4 2 a least squares fitting to test our proposed phenomenological model we used a non linear regression package to fit the analytical advection dispersion solution in eq 4 to the experimental measurements in this non linear fitting we restrict attention to the normalized concentration measurements in the upper part of the bed where exchange is most active i e z 10 cm over the first 3000 s of the each run where we expect this solution to be valid in most runs we use the lsqnonlin package in matlab to adjust the values of apparent dispersion d and apparent vertical velocity u until the sum of the squares of the difference between the values from eq 4 and the experimental measurements at z 5 cm and z 10 cm is a minimum the exceptions are runs 7 and 9 where due to insufficient measurements at z 10 cm we only fit to the z 5 cm probe and run 11 where there is insufficient measurements to make any fit the resulting fits to the measured data along with the fit values of apparent vertical velocity u cm s and apparent dispersion coefficient d cm2 s and the associated sum of squares are shown in fig 5 waves and fig 6 no waves the fit values are also listed in table 1 along with a calculation of a peclet number with the form 5 p e d g u d where d g 0 72 cm is the size of the gravel for the cases with waves the fit of the advection dispersion model is excellent closely matching the behavior of the solute exchange at both z 5 and z 10 cm fig 5 the fits to the no wave runs are not as good but sufficient to indicate that the advection dispersion model captures the first order characteristics of the solute penetration at shallow depth and early times fig 6 thus a comparison of the fitted values of apparent velocity and apparent dispersion can be used to identify differences in the hyporheic exchange between wave and no waves cases for example we observe a clear separation between the pe numbers in the wave and no wave cases fig 7 a for paired runs 1 2 3 4 etc the no wave peclet numbers are 5 40 fold greater than in the wave cases indicating that the magnitude of the apparent dispersion coefficient is much larger than the apparent vertical velocity when waves are present we do not observe any separation in the fitted values of the vertical velocity fig 7b in contrast we observe a clear separation between the fitted values for the apparent dispersion coefficient fig 7c reinforcing our initial inference from the peclet number plot in fig 7a together these fitted results indicate a strong contrast between the wave and no wave cases hyporheic exchange at shallower depths and early times in the presence of travelling waves i is well modeled by an advection dispersion treatment using a constant vertical velocity and an apparent dispersion coefficient and ii when compared to similar cases without traveling waves this apparent dispersion is significantly an order of magnitude plus larger the question now arises what is the driver of the apparent significant increase in dispersive hyporheic exchange in the presence of a traveling wave existing theory suggests that flow oscillations will enhance dispersive transport fisher et al 1979 e g the enhanced dispersion in tidal estuaries schnoor 1996 indeed previous theory simulations and experiments harrsion et al 1983 webster and taylor 1992 illustrate how wave induced pressure oscillations in coarse gravel substrates lead to a significant enhancement of dispersion in the sediment bed thus our hypothesis is that the flow pumping in the bed observed in the presence of waves is the probable cause of the observed separation in the values of wave and no wave apparent dispersion coefficients seen in our experiments fig 7c 4 3 a direct simulation to support our hypothesis on the role of the wave pumping we will develop a direct numerical simulation of the solute exchange in the bed based on the advection diffusion equation in eq 2 in detail when waves are present this simulation evaluates the oscillating vertical velocity acting in the sediment bed as 6 u t u o a μ sin μ 2 π t where u 0 is a mean vertical velocity cm s μ is the wave frequency 1 hz in our set up and a cm is the pressure amplitude at the sediment bed surface from the basic theory of flow in porous media scheidegger 1954 1961 and the relationship given in wexler 1992 we set the apparent dispersion related to this velocity as 7 d t d g u o a μ sin μ 2 π t where we have assumed that the dispersivity is given by the sediment particle diameter dg 0 72 cm here we emphasis that the flow pumping in the bed is induced by applying a time transient and spatially variable pressure fluctuation at the bed surface this in contrast to the so called advective flow pumping elliot and brooks 1997 bottacin busolin and marion 2010 driven by temporally constant and spatially fixed spatial pressure changes due to bed forms and or standing waves the proposed numerical simulation while still based on the advection dispersion eq 2 differs from the model used in obtaining the fits to measured data in figs 5 and 6 in that fitting we use the analytical solution eq 4 with constant values for apparent vertical velocity u and apparent dispersion d here we are proposing fitting a numerical solution of eq 2 that employs the non constant time oscillating values for the velocity eq 6 and dispersion coefficient eq 7 an explicit central difference solution is used with grid independent space and time steps of δx 1 cm and δt 0 125 our idea in adopting the oscillating vertical velocity is to directly induce the observed pumping in the sediment bed one way to test the validity of this approach would be to adjust the values of the mean velocity u 0 and wave amplitude a until the simulation predictions fit the experimental concentration measurements for the wave cases even numbered runs however since the basic analytical advection dispersion solution in eq 4 has already been shown to provide an accurate model of the hyporheic exchange the alternative is to fit the direct numerical simulation to the analytical solution i e connect the values of u 0 and a in eqs 6 and 7 to the fit values of velocity u and apparent dispersion d given by the even wave runs in table 1 in the first place we simply set the eq 6 mean velocity as u 0 u secondly we equate the integral over one cycle t 1 μ of the transient dispersion d t in eq 7 to the fit value of d formally this second step gives 8 μ 0 1 μ d t d t d g μ 0 1 μ u d t 2 0 1 2 μ a μ sin 2 π μ t d t d which on evaluation setting dg 0 72 and assuming a frequency of μ 1 hz representative of our system allows us to evaluate the amplitude in eq 6 as a π 2 d 0 72 u in this way rather than performing a new formal fitting exercise we directly determine the values for the mean vertical velocity uo and amplitude a used in the direct simulation of the oscillating velocity in terms of the constant values u and d previously obtained from the fit of the analytical advection dispersion solution table 1 this approach essentially provides an exact match between the numerical simulation employing an oscillating velocity eq 6 and dispersion eq 7 and the fitted analytical advection dispersion solution eq 4 using a fixed values for apparent vertical velocity u and apparent dispersion d fig 8 note the values of calculated amplitudes reported in each sub plot of fig 8 are consistent with of the range of bed pressure amplitudes considered to be acting in our experiments 0 15 0 65 cm therefore it is clear that a direct simulation employing an oscillating bed flow velocity provides a sound accounting of the hyporheic exchange observed at early time t 3000 s and shallow depth z 10 cm when waves are present in our experimental flume this allows us to conclude that the observed induced flow pumping in the sediment bed due to pressure fluctuations at the water sediment interface is a likely cause for the observed enhancement in the dispersive nature of hyporheic exchange in the presence of traveling surface waves 5 discussion 5 1 wave pumping as a driver of hyporheic exchange the pumping action of the waves that we observe directly in our experiments has previously been associated with a form of mechanical dispersion referred to as rotational dispersion webster and taylor 1992 in the case of fine sediments experiments have shown that this mechanism of dispersion has little or no effect on hyporheic exchange webster and taylor 1992 precht and huettel 2003 this is to be expected because sediment size and related parameters e g porosity and permeability exert a primary control on exchange with the bed grant et al 2012 however in coarse gravel sediments similar in nature to the substrate of our experiments rotational dispersion greatly enhances pore water exchange with the overlying water column webster and taylor 1992 observations from waves in marine settings suggest that large amplitude waves highly permeable sediments and small flow depths result in an enhanced sediment bed dispersions up to 4 orders of magnitude larger than molecular diffusion harrison et al 1983 modeling work by habel and bagtzoglou 2005 reinforced the role of bed permeability and added that long surface wavelengths relative to the flow depth lead to greater rates of exchange thus because the work presented here uses a coarse gravel bed it is not surprising that we observe the strong influence on hyporheic exchange of the traveling wave induced pumping phenomena additional insight can be gained if using the data reported in table 1 we plot our fitted values of the peclet number for both non wave and wave cases against the channel froude number fig 9 there are a number of meaningful conclusions that can be drawn from this plot in the first place we see that in all cases regardless of the presence or absence of moving waves hyporheic transport under shallower faster flows tends to be less dispersive than in deep slow flows i e the ratio of advection to dispersion increases as the froude number increases note however that the rate of increase in the peclet number with increasing froude is more pronounced in the absence of waves peno fr3 vs pewave f0 9 suggesting that the presence of moving waves suppresses the augmented advective effects of shallow fast flows the reason for this as we ve argued above is that the wave induced advection enhances dispersion and that effect is greater in shallower flows this can be seen in the divergence in the wave vs no wave peclet numbers fig 9 the positive slopes of the lines in the plots indicate also that as the channel flow becomes deeper and or slower the additional dispersive effect in the presence of traveling waves diminishes in fact as the channel flow slows and deepens we may reach a point where the level of apparent dispersion in both the wave and no wave cases is similar this observation is to be expected a deeper slower flow will decrease the surface wave pressure amplitude at the bed surface and is consistent with previous work harrison et al 1983 habel and bagtzoglou 2005 5 2 comparisons of dispersion values reported in the literature our values of apparent dispersion d under waves are consistent with the value of dispersion encountered in previous flume experiments in particular our values of dispersion approach the 1 1 line produced in the meta analysis of flume exchange experiments compiled by grant et al 2012 fig 10 in this respect it is important to note that in contrast to the approach taken here the base model in grant et al 2012 assumes that the exchange in the bed is described by a dispersion alone transport equation in that case the apparent effective dispersion coefficient accounts lumps the effects of both advection and dispersion the fact that the wave enhanced values of d obtained from fitting a two parameter advection dispersion model to our data lie near the 1 1 line provides additional confirmation that under waves the hyporheic exchange is dominated by dispersion like processes fig 10 moreover the apparent diffusion coefficients of our wave runs are consistent with data from other experiments suggesting that the contribution of waves to hyporheic exchange is the same order of magnitude as other fine scale hydrodynamic drivers like near bed turbulence and bed forms another feature of the meta analysis by grant et al 2012 is that under similar channel flow conditions the values of the effective diffusion coefficient between planar and bed form surfaces can take similar values this is clearly reflected in the regression model they use eq 24 in grant et al 2012 which lacks parameters for bed forms e g height and wavelength and yet reasonably predicts the effective diffusion in experiments with and without bed forms this indicates that while the mechanisms of the hyporheic exchange might be quite different between the two cases bed forms or flat bed the lumped apparent dispersion does not capture this difference by contrast in our analysis when waves are not present our fitted dispersion coefficients are clearly removed from the best fit line fig 10 this is because in our advection dispersion model the advective term is the same order of magnitude as the apparent dispersion in the wave free runs table 1 it is only when the advective term becomes small relative to the dispersion term as it does under waves that our apparent dispersion coefficient comes into agreement with the grant et al 2012 dispersion only model 5 3 connection of experiments to field scale in the context of the practicality of our findings we note that while traveling surface waves are more common in lake and coastal environments propagating waves also can be found in streams and channels flow around or over large rocks or large in stream wood riffles and step pool stream morphology can all generate standing waves which can cause traveling surface waves to develop downstream larger rivers with appreciable fetch lengths have surface waves induced by winds much as lakes and estuaries do because the waves propagate downstream of the disturbance the zone of enhanced exchange may extend well beyond the disturbance itself even the wakes from boat traffic may temporally modify the exchange in coarse bedded material in connecting our results to field scales we note that the flow and surface wave conditions in our experiment are not too far removed from those that might be found in natural settings for example our flow depths 9 5 19 5 cm could occur in small streams further due to various forcings e g winds schutten et al 2004 and recreational boat wakes shuster 2017 moving surface waves of frequencies in the range 0 5 to 1 hz and amplitudes in the range 1 to 10 cm are observed in the field it is reasonable to assume therefore that the separation in hypothetic exchange behaviors between the presence and absence of traveling surface waves observed in our flume could occur across a spectrum of natural systems at the same time however it could be argued that depth might be a limiting factor on the extent of the enhanced hyporheic exchange observed under traveling waves as water depths become deeper than the maximum 20 cm used in our experiments will the value of the resulting apparent dispersion become negligible as the depth increase what wave frequencies and amplitudes will be required to maintain the value of d the following manipulation of eq 8 provides us a means to answer these questions on its integration we arrive at the following expression for determining the apparent dispersion observed in our experiments 9 d d g u 2 μ a π we can simplify eq 9 by assuming that exchange in the presence of a wave as shown in our analysis above will be diffusive dominated allowing us to ignore the vertical velocity term further we can use the treatment in kinsman 1965 to replace the amplitude of the pressure wave at the bed surface with the amplitude of the wave itself a aw exp 2πh l giving us 10 d d g 2 μ a w π exp 2 π h l recall h is the flow depth and l is the surface wave length this expression provides a means by which we might determine for particular wave characteristics aw μ and l the magnitude of the apparent dispersion d we emphasize that this formula only determines the contribution to an apparent dispersion due to the presence of traveling waves in field settings additional large and small scale drivers e g higher flow velocities bed forms meanders groundwater flux will contribute to hyporheic exchange as well further research is needed to determine under what field settings traveling waves will be a significant contributor to the overall hyporheic exchange one way to use eq 10 is in assessment on the effect of flow depth for our typical experimental data dg 0 72 cm aw 1 cm μ 1 hz l 100 cm and h 20 cm eq 10 gives a value of d 0 13 cm2 s on first sight eq 10 suggests that as flow depth increases this value of d will decrease exponentially in practice however we may expect the rate of this decay to be slowed by an increase with depth in wavelength and amplitude for example a field observation of a boat wake table 2 in shuster 2017 reports at a water depth of 99 cm aw 6 cm μ 0 5 hz and l 658 cm assuming the same substrate as our experiments these values would result in an increase value d 0 53 cm2 s eq 10 indicates also a direct dependence of apparent diffusion on grain size an observation that is consistent with other studies e g richardson and parr 1988 nagaoka and ohgaki 1990 webster and taylor 1992 grant et al 2012 it is therefore expected that the apparent diffusion will decrease substantially as sediment fines webster and taylor 1992 for example showed very high exchange rates under waves in a substrate consisting of 3 mm pebbles but virtually no exchange when sediment size was sub millimeter based on those experiments we expect this relation eq 10 to apply as long as the sediment is of coarse sand or larger another possible factor to consider in connecting our findings to natural settings is the time scale of the transport phenomena marion and zaramella 2005 cautioned that if the time scale of the transport differs between laboratory and natural settings the phenomenological model used to describe the experiments may not be applicable at the field scale as noted above our experimental conditions are not too far removed from many natural surface waters we expect then that the drivers which would affect the time scale of exchange should also be similar 6 summary and conclusions previous studies have elucidated the important role of traveling surface waves on hyporheic exchange in lacustrine and coastal settings however no one has investigated their role in the riverine environment direct observations of conservative tracer behavior in a coarse bedded recirculating flume indicate an alternating pumping motion of the interstitial fluid in the presence of traveling surface waves this pumping action generates an additional transport mechanism which results in solute penetrating more quickly and deeply into the gravel bed and influences a greater proportion of the pore water in order to make a quantitative comparison between wave and wave free measurements we fitted an analytical solution for advection dispersion transport to our experimental measurements for times less than 3000 s on the order of ½ an experimental duration and at sediment depths less than 10 cm 1 2 of the bed thickness this model on adjusting the parameter values of apparent vertical velocity and apparent dispersion provide an excellent fit to the experimental concentration measurements in the presence of waves when waves are not present the fit is weaker but still adequately captures the characteristics of the solute penetration in the upper half of the bed comparison of the fitted values revealed for experiment runs with the same surface flow characteristics i e velocity depth and slope a clear separation in the values of the apparent dispersion coefficient in the presence of traveling surface waves apparent dispersion coefficient are an order of magnitude or more larger than runs without waves indicating that hyporheic exchange is dominated by a different process when waves are present an alternative model for the solute exchange in our flume s sediment bed was based on a numerical simulation of the advection dispersion equation that directly accounted for vertical oscillations of the interstitial flow a scenario that is known to generate dispersive transport with an appropriate deterministic setting of the amplitude of the fluctuation driving the oscillating velocity in this simulation we were able to essentially match the previous model based on the fit of the analytical solution thus this simulation not only confirms the role of the previously noted flow pumping induced by traveling waves it also provides an experimentally validated deterministic model for this process in turn for a given a set of wave flow and substrate characteristics this model provides a quantification of the level of hyporheic exchange that might be expected in the presence of traveling waves acknowledgments this work was partially supported by the stc program of the national science foundation via the national center for earth surface dynamics under the agreement number ear 0120914 we offer special thanks to garrett katerzynske for assistance in video editing we also thank the editor and reviewers who provided valuable insights and critical suggestions on how to improve not only the manuscript but also the analysis supplementary material supplementary material associated with this article can be found in the online version at doi 10 1016 j advwatres 2018 11 005 appendix supplementary materials image video 1 
716,coastal canopies deliver a wide range of ecosystem services through the flow and transport processes within and around the canopies this study presents a numerical investigation on the effect of suspended floating canopies on wave driven current around canopy using a non hydrostatic model swash the model results by swash for a submerged canopy are first validated with experiment measurements and compared with predictions from two volume of fluid vof based free surface flow models then the effects of suspended floating canopies on wave attenuation and vertical mean flow structures are examined using swash the model results show that a strong shoreward wave driven current is generated at the top of a suspended canopy in the same direction as the wave same as that at the top of a benthic canopy in contrast a seaward mean current is generated at the bottom of a suspended canopy in the opposite direction to the wave the predicted particle trajectories indicate that due to flow attenuation within canopy at the bottom of the canopy the fluid particles travel faster at the bottom half of their orbits outside the canopy in the opposite direction of wave propagation than at the top half of their orbits within the canopy in the direction of wave propagation this leads to open particle orbits and a time averaged mean current in the opposite direction of wave propagation the present study is the first attempt that reveals and examines this physical phenomena that would play an important role in particulate transport and exchange across the suspended canopies the maximum magnitudes of wave induced currents at the top and bottom of canopy are consistent with a recent empirical formula extracted from the observations for submerged canopy the predicted wave decay agrees well with a three layer analytical solution for suspended and submerged canopy and indicates that the canopy vertical location plays an important role in wave attenuation and canopy induced currents the spatial distribution patterns of the wave driven current clearly support the notion that the current strength generated at the canopy interface is a function of horizontal oscillatory velocity vertical orbital excursion and canopy density the spanwise extent of the mean current is examined by a 3 d simulation where the canopy occupies only half the flume width numerical results show that the wave driven current is mainly confined to the part of flume occupied by the canopy and that the current strength is soon attenuated to zero towards the other part of flume through a mixing layer like transition region at the canopy side interface keywords swash openfoam vegetation suspended canopy wave driven current flow structures 1 introduction in coastal environments canopies of aquatic vegetation are abundant and provide a wide range of ecosystem services barbier et al 2011 nepf 2012 the most quoted ecosystem service in changing climate is perhaps wave attenuation and mitigation of coastal flooding e g by seagrass meadows salt marshes mangroves and kelp forests bradley and houser 2009 gaylord et al 2003 ondiviela et al 2014 riffe et al 2011 wamsley et al 2010 zhang et al 2012 damping of waves and currents help promote sedimentation and prevent erosion which in turn contributes to growth and expansion of the coastal canopy corenblit et al 2007 horstman et al 2015 hu et al 2018 gacia and duarte 2001 van katwijk et al 2010 unlike the familiar natural submerged or emergent canopies that are rooted at seafloor suspended canopies have received little attention common examples of suspended canopies include forests of certain kelp such as macrocytis that have most of its biomass near the surface rosman et al 2007 long line mussel farms in aquaculture plew et al 2005 2006 mckindsey et al 2011 vegetated platforms that serve as breakwaters for shore protection and marsh restoration in estuaries chen et al 2016 and floating treatment wetlands to purify stormwater and eutrophic water bodies in ecological engineering fang et al 2007 tanner and headley 2011 xu et al 2017 wave attenuation due to vegetation has been studied extensively via theory experiments field observations and numerical modelling in the past decades however the effect of canopies on wave induced mean flow is much less understood the mean flow dictates the exchange of water and particulate matter across the canopy boundaries which regulates the ecosystem services capacity of aquatic canopies as for unidirectional flow in rivers and tides nepf and vivoni 2000 huai et al 2012 plew 2011 the presence of canopy also alters the vertical flow profiles for oscillatory flows abdolahpour et al 2017b lowe et al 2005a luhar et al 2010 pujol et al 2013 lowe et al 2005a found that flow inside a canopy is more intensified under oscillatory forcing of wave action than steady current forcing of the same magnitude which in turn results in higher mass transfer rates lowe et al 2005b in the vicinity of the canopy water interface a few laboratory experiments abdolahpour et al 2017b luhar et al 2010 stratigaki et al 2011 and a field study luhar et al 2013 revealed a strong shoreward mean current in the wave direction immediately within and above a submerged canopy which may influence the canopy residence time through advection and vertical mixing abdolahpour et al 2017a currently there is a lack of experimental studies on wave driven flows in the presence of suspended canopies many numerical studies in the literature have been dedicated to wave attenuations by the submerged or emergent canopies using bousinessq type models augustin et al 2009 blackmar et al 2013 chakrabarti et al 2017 yang et al 2015 non hydrostatic wave model nhwave ma et al 2013 wu et al 2016 zhu and chen 2015 and navier stokes solvers coupled with volume of fluid vof surface capturing schemes chakrabarti et al 2016 chen et al 2016 2017 marsooli and wu 2014 maza et al 2013 2016 however very few studies have focused on the vertical and horizontal structure of mean flow induced by submerged emergent canopies chakrabarti et al 2016 chen et al 2017 maza et al 2013 and hardly any on suspended canopies in this study we utilize a non hydrostatic wave flow model swash simulating waves till shore zijlema et al 2011 to investigate the canopy effect on wave attenuation and the wave driven current the merit of the non hydrostatic models lies in their computational efficiency and high accuracy of capturing wave dispersion properties with only two to three vertical layers on the other hand this type of model can also be applied with an arbitrary number of vertical layers to resolve the vertical structure of the flow the grid resolution requirement for the latter application is less than that for the vof based models to further reduce the computational cost dominated by solving the pressure poisson equations rijnsdorp et al 2017 proposed a subgrid approach which solves the vertical accelerations and non hydrostatic pressures on a relatively coarse vertical grid and the horizontal velocities and turbulent stresses on a much finer subgrid this boosts the computational efficiency by up to one order of magnitude the new implementation in swash makes it highly attractive for three dimensional 3d wave flow simulations at field scales 10 10 wavelengths and 1000 wave periods in the present study the subgrid approach was adopted in 3d simulations for a partially vegetated flume the objective of the present study is to investigate the wave attenuation and vertical structure of wave driven flows in the presence of both submerged and suspended canopies in particular the wave driven current at the interface of suspended canopies the performance of swash and two vof based models with different wave absorption techniques are first compared the paper is structured as follows the non hydrostatic model swash and the two vof based models built on the openfoam platform wavefoam and ihfoam are described in section 2 all three models consider rigid canopies only and treat them as a continuous medium which is in its discrete form similar to an infinite row of identical vegetation stems dupont et al 2010 in section 3 the performance of the three models to predict wave height decay are compared followed by the validation of vertical flow profiles predicted by swash and ihfoam the effect of canopy configuration on wave attenuation and wave driven flow pattern are then examined the wave driven current generated at the canopy interface is further investigated by a 3d simulation of a canopy that occupies only half width of the flume conclusions are drawn in section 4 2 methodology 2 1 swash the non hydrostatic model swash zijlema et al 2011 solves the mass and momentum balance equations for an incompressible single phase free surface flow which is vertically bounded by the time varying free surface z η x y t and the fixed bottom z h x y here x y z are the cartesian coordinates t is time η is the free surface displacement relative to the still water level where z 0 and h is the still water depth the governing equations are given as rijnsdorp et al 2017 1 u x v y w z 0 2 u t u u x u v y u w z g η x q x τ x x x τ x y y τ x z z 1 ρ f d x 3 v t v u x v v y v w z g η y q y τ y x x τ y y y τ y z z 1 ρ f d y 4 w t w u x w v y w w z q z τ z x x τ z y y τ z z z where u v w are the velocity component in the x y and z direction respectively g is the gravitational acceleration ρ is the constant fluid density and τ ij represents the turbulent stresses i and j denoting the coordinates in these equations the total pressure has been decomposed into the hydrostatic ρg η z and non hydrostatic component ρq with q being the normalized non hydrostatic pressure the last terms in eqs 2 and 3 represent the momentum loss due to the presence of canopy fdx and fdy are the x and y component of the drag force acting on the rigid canopy 5 f d x 0 5 ρ c d n b v u u 6 f d y 0 5 ρ c d n b v u v where cd is the canopy drag coefficient n is the number of vegetation stems per unit bed area and bv is the stem width and u u 2 v 2 w 2 is the magnitude of the velocity the time evolution of the free surface is obtained by enforcing the mass conservation across the entire water column 7 η t x h η u d z y h η v d z 0 the numerical implementation of swash is based on an explicit second order accurate finite difference method in space and time it makes use of a surface and terrain following σ coordinate that divides the instantaneous water column vertically into a fixed number of layers the number of layers required for accurate wave predictions depends on the dimensionless water depth kh where k is the wave number to ensure sufficiently accurate prediction of wave dispersion the pressure gradient in the vertical momentum equation is approximated by the keller box scheme or the standard central differences in the present study the wave height decay is simulated using low vertical resolutions 3 layers and the keller box scheme while the flow profiles are resolved using high vertical resolutions 30 50 layers and the central differencing scheme waves are generated by prescribing time series of surface elevation or horizontal particle velocities at the wavemaker boundary which may be obtained from wave theory or experiments in case of flat bottom waves need to be damped or absorbed by specifying a sponge layer of finite length before reaching the other end of the flume in case of a sloping beach a moving shoreline boundary is also available which conserves the mass and removes the computational grid points wherever the local water depth is below a certain threshold the sponge layer implemented in swash is similar to the relaxation zone in the vof based wave model wavefoam described in the next section the vertical layer schematization of vegetation by suzuki et al 2012 extends swash to study the effects of submerged and suspended canopies on wave attenuation and vertical flow structures 2 2 vof models since swash treats the free surface as a single valued function η x y t it cannot resolve wave breaking processes such as overturning plunging air entrainment and breaking induced turbulence with the development of sophisticated cfd algorithms and increasing computing power the free surface flow models using vof method hirt and nichols 1981 have seen increasing applications to wave structure interactions and surf zone breakers e g chen et al 2017 jacobsen et al 2012 zhou et al 2017 for example the interfoam is a family of two phase flow solvers in the open source cfd toolbox openfoam jasak 1996 rusche 2002 treating the air water mixture as one effective fluid the two phase flow model solves only one set of mass conservation and momentum equations jasak 1996 rusche 2002 8 u 0 9 ρ u t ρ u u μ e f f u p g x ρ u μ e f f f d 10 α t u α u r α 1 α 0 where u u v w is the fluid velocity vector with u v w being the velocity component in x y z directions respectively ρ is the fluid density μ eff μ ρν t is the effective viscosity incorporating both dynamic viscosity μ and turbulent eddy viscosity ν t p is the pseudo dynamic pressure g is the acceleration due to the gravity x is the position vector of the fluid grid f d 0 5 ρ c d n b v u u is the hydrodynamic drag force acting on the canopy note that this formulation consists of a vertical drag component which is much smaller than the horizontal components eqs 5 and 6 future implementations should use different drag coefficients in directions that are respectively tangential vertical for rigid canopies and perpendicular horizontal to the stem s longitudinal axis α is the volume of fluid fraction used to mark the location of the free surface and u r is a velocity field to prevent the smearing of the air water interface the local density ρ and the local viscosity μ of the effective fluid are calculated by 11 ρ α ρ 1 1 α ρ 2 12 μ α μ 1 1 α μ 2 where the subscripts 1 and 2 denote the water and air properties respectively the interfoam solver is implemented on a collocated unstructured grid with a finite volume discretization with eqs 8 12 solved using the pressure implicit with splitting of operators piso algorithm the readers should refer to jasak 1996 for a detailed description of the finite volume method in openfoam and to rusche 2002 for the vof surface capturing scheme to apply the general purpose free surface flow solver to study coastal processes jacobsen et al 2012 and higuera et al 2013 separately extended the interfoam solver with additional functionalities for wave current generation and absorption and released the solvers open source as wavefoam and ihfoam respectively building upon these two solvers the present authors further incorporated the canopy effect in the momentum equation eq 9 2 2 1 wavefoam the wavefoam solver by jacobsen et al 2012 adopts the relaxation zone technique which requires extra computational domains 1 2 wavelengths to minimize the wave reflection for each region designated as a relaxation zone a target solution of wave current field is prescribed the velocity and volume fraction field inside the relaxation zone are a weighted average of the target solution and that computed from the cfd solver 13 u γ u c o m p u t e d 1 γ u t a r g e t 14 α γ α c o m p u t e d 1 γ α t a r g e t where γ denotes a relaxation parameter which varies smoothly from 1 to 0 across the relaxation zone the relaxation parameter typically takes either a higher order polynomial or exponential functional form when the target field is set to be the state of the still water the incoming wave field gradually approaches this target with γ 0 at the end of the relaxation zone similar approach was implemented in swash designated as sponge layer to prevent wave reflections 2 2 2 ihfoam on a different approach the ihfoam solver by higuera et al 2013 uses an active absorbing boundary condition to cope with the wave reflection without increasing the length of the computational domain it measures the surface elevation in front of the boundary and actively adjusts the inflow or outflow flux by comparing the measured surface elevation η m with the theoretical target η t in case a reflected wave η r is detected the inflow velocity profile is adjusted by assuming that the reflected wave is in shallow water regime and hence its phase speed c and depth uniform velocity profile uc can be easily determined by 15 c g h 16 u c g h η r where η r η m η t is the reflected wave height and uc is the correction velocity to be applied perpendicular to the boundary to cancel out the reflected wave for a wavemaker boundary the target surface elevation is calculated from a given wave theory for a pure absorbent boundary the target surface elevation is the still water level η t 0 2 3 turbulence models the standard two equation k ε model have been adapted to compute the mean flow and turbulence structures in open channels with rigid submerged canopies e g shimizu and tsujimoto 1994 lopez and garcia 2001 assuming that the work done by the flow against canopy drag is converted to the turbulent energy two additional terms are introduced in the transport equations for turbulent kinetic energy k and dissipation rate ε in swash the default closure coefficients are those calibrated by shimizu and tsujimoto 1994 for the vof based models wavefoam and ihfoam the k ε model in openfoam is adapted following the formulations proposed by lopez and garcia 2001 in the present study both models have been run with and without activating the two equation closure model we found that the model results are not sensitive to the inclusion of the turbulence model skill index changes less than 4 therefore only results without the closure model are reported in the following section the most noticeable difference observed is that for swash activating turbulence model helps to smooth slightly the vertical flow profiles 3 results and discussion before applying the model to study wave attenuation and mean flow structures around the canopies three validation exercises were performed against observations and analytical solutions 1 wave height decay above a submerged canopy 2 wave decay and velocity profiles within a submerged canopy and 3 wave decay by additional suspended floating canopies in this section we first assess the performance of swash and two vof based models to predict the wave attenuation in the presence of submerged canopies the predictive capability of swash to resolve the vertical flow profiles is then confirmed by comparing with ihfoam predictions and a large scale flume experiment stratigaki et al 2011 the effects of canopy configurations submerged suspended and floating canopies on wave attenuation and spatial distribution patterns of the mean flow are then examined the maximum wave driven current predicted at the canopy interface is evaluated with a recent empirical model by abdolahpour et al 2017b the formation mechanism of this current is further investigated by a 3d simulation in which the canopy occupies only half width of the flume 3 1 comparison of wave height decay by three models fig 1 shows the experimental and the numerical flume setup for the non hydrostatic model swash and the vof based model wavefoam and ihfoam respectively the experiments were conducted at the usda ars national sedimentation laboratory nsl in oxford mississippi usa wu et al 2012 where the wave attenuation with rigid and flexible vegetation was tested over a flatbed marsooli and wu 2014 the stem of the rigid vegetation is made of birch dowels and that of the flexible vegetation polyurethane tubing both of which are 0 2 m tall and have a stem diameter of 3 1 mm the vegetation canopy with a staggered arrangement is 3 66 m long and has a density of 3182 stems m2 the porous parabolic beach in the physical flume fig 1a is not included in the numerical flumes fig 1b d because the porosity and the shape of the beach is unknown the error metrics of model sensitivity in appendix a are used to evaluate the model performance for the swash model the numerical flume is 14 0 m long including a 4 0 m sponge layer to the right of the flume the computational domain is discretized into 700 grids horizontally with a uniform size of 0 02 m and 3 equidistant layers vertically see appendix b for the model sensitivity to vertical layer resolutions a weakly reflective wavemaker boundary is specified based on the target wave conditions listed in table 1 a radiation boundary condition is specified at the right end outlet the time step is automatically adjusted between a maximum and minimum courant number of 0 5 and 0 2 all cases are run 30 s while only the last 5 wave periods results are used for post processing for the vof based flow solvers the flume height increases to 0 5 m to accommodate the air motion the wavefoam model uses a 4 0 m long relaxation zone to absorb the outgoing waves while the ihfoam model adopts the absorbing boundary to let the waves leave the domain freely a uniform grid size of 0 01 m in the horizontal direction and 0 005 m in the vertical direction is used resulting in a total of 140 000 grids for the wavefoam model and 100 000 grids for the ihfoam model the time step is automatically adjusted at runtime by imposing a maximum courant number of 0 3 our modeling experience suggests that a smaller courant number is required to achieve more accurate wave predictions the corresponding wave parameters listed in table 1 are used to specify the boundary conditions at the wavemaker fig 2 shows the comparison of the three model predictions with the experimental measurements it is seen that all three models adequately capture the extent of wave height decay by the submerged canopy the average skill index being 0 96 0 97 and 0 92 for swash wavefoam and ihfoam respectively see table 2 for relatively deep water and shorter waves cases 1 and 3 the predictions by swash and wavefoam are almost identical with negligible spatial oscillations in the wave height evolution average wave reflection coefficient 1 0 however the prediction by ihfoam exhibits a considerable spatial oscillation starting at the rear edge of the canopy wave reflection coefficient about 9 which is attenuated approaching the leading edge for relatively shallow water and longer waves cases 2 and 4 the extent of the spatial oscillation in the ihfoam predictions is reduced since the numerical models exclude the porous parabolic beach of limited length in the physical flume which may cause stronger wave reflections for longer period waves as demonstrated by the measurements in fig 2c and d the models tend to under predict the spatial oscillations of wave height this comparison suggests that the absorbing boundary condition proposed by ihfoam which assumes a shallow water wave regime indeed performs slightly better for shallow water waves than for their deep water counterparts on the other hand the sponge layer relaxation zone technique adopted by swash wavefoam seem to work well for both cases although extra length of the computational domain entails more cpu time see table 3 for computational time comparisons the calibrated canopy drag in table 1 for both rigid and flexible vegetation is consistent with those in previous studies e g marsooli and wu 2014 the calibrated drag for the flexible canopy cases 3 and 4 is only slightly smaller than that for the rigid canopy cases 1 and 2 it is also noted that the drag coefficients calibrated for swash is only slightly different from those for the vof based models which may be attributed to the differences in the wavemaker boundaries and the wave velocity profiles in these models it should be emphasized that the good predictive skills for the different models in table 2 were achieved by fitting the bulk canopy drag coefficient against the measured wave height data the canopy drag coefficient is the most uncertain parameter used to incorporate the canopy effect into hydrodynamic models as a continuous medium as reviewed by henry et al 2015 significant variations exist in the plethora of the proposed canopy drag coefficients which are typically functions of reynolds number and keulegan carpenter number a universal canopy drag formulation applicable to various vegetation properties and wave conditions is currently lacking and is still an ongoing research topic 3 2 vertical flow profiles in the presence of submerged canopies fig 3 a and b show the laboratory flume and the swash model setup in which a submerged canopy is subjected to regular waves generated at relatively deep water stratigaki et al 2011 the flume bottom is covered with a 20 m long flat sandy layer and two sloping beaches the vegetation canopy is 10 7 m long and 0 55 m high with a canopy density of 180 360 stems m2 and a stem width of 1 cm the incident wave conditions are listed in table 4 while all cases have been simulated using swash only case s1 was also simulated using ihfoam which requires less computational time compared with wavefoam the wave absorbing sandy sloping beach at the outlet in the laboratory flume was replaced with a solid flat bottom combined with a sponge layer in swash and an absorbing boundary in ihfoam the implications of using different wave absorbing techniques in numerical models is discussed by comparing the present model results using varying sponge layer lengths and the ih2vof model results maza et al 2013 for the swash model the horizontal grid size is 0 08 m for t 3 5 4 0 s and 0 04 m for t 2 0 s which leads to more than 150 grids per wavelength preliminary tests have shown that it is adequate to use 3 vertical layers to resolve the wave height evolution see appendix b while it requires 50 layers for h 2 4 m and 30 layers for h 1 8 m to adequately resolve the vertical flow profiles for the ihfoam model a uniform grid of 0 04 m in horizontal and 0 02 m in vertical is used which results in four times as many grids as the swash model both models were run for 60 s while only the last 5 wave periods results are used for post processing fig 4 shows the effect of sponge layer length and or the starting location on the oscillation of wave height decay for a submerged canopy with normalized root mean square error nrmse nrmse 0 28 and skill index si si 0 79 for a 6 m sponger layer nrmse 0 18 and si 0 89 for a 8 m sponger layer nrmse 0 33 and si 0 58 for a 10 m sponger layer and nrmse 0 16 and si 0 91 for ih2vof the flume length is kept constant at 60 m so varying the sponge layer length also changes the location where the wave starts to be artificially damped by the sponge layer this would affect the phase of the reflected waves relative to the incident waves and hence the spatial oscillation patterns of the wave height above the canopy the swash model results in fig 4 confirm this hypothesis and show that the oscillation pattern for a 8 m sponger layer solid line is more consistent with that in the experimental measurements although the predicted oscillation is slightly weaker also shown in fig 4 is the ih2vof model result by maza et al 2013 which shows that the predicted oscillation magnitude and distance between troughs in the wave height are also smaller than the observation model data comparisons for other incident wave and canopy conditions see figs 6 and 7 in maza et al 2013 and fig 6 in marsooli and wu 2014 suggest that even if the wave absorbing is simulated by including a sloping beach the numerical model cannot replicate the observed partial standing wave patterns exactly these discrepancies may come from the difference in the incident waves generated at the wavemaker and the unknown wave reflections altered by the beach morphologic changes due to the wave action to validate the predicted vertical profiles of velocity the swash predictions from the surface and terrain following σ coordinate are interpolated vertically to a fixed uniform grid subsequently the mean velocities were computed at each grid point by time averaging the interpolated model predictions fig 5 shows the vertical flow profiles predicted by swash and ihfoam and experimental measurements by stratigaki et al 2011 before entering the leading edge of the submerged canopy the wave kinematics is not affected by the canopy fig 5a and consistent with the depth uniform velocity profiles typical of shallow water waves while within the canopy the wave kinematics is altered significantly in the vicinity of the canopy interface which generates a non zero mean current in the direction of wave propagation both model predictions are in reasonable agreements with the experiment with skill index si si 0 54 for swash and si 0 59 for ihfoam the relatively low skills affected by the limited number of measurements the discrepancies near the canopy interface between swash and ihfoam may be due to the additional vertical drag component in the ihfoam model see eq 9 in section 2 2 the discrepancies below the canopy interface between model and measurement in fig 5c may result from the local bed elevation changes around the vegetation stems and the disturbance of the suspended sediments picked up from the sandy bottom which are not considered in the models from the macroscopic point of view ma et al 2014 summarized that the presence of suspended sediments would create a stably stratified water column which then plays a critical role in damping the flow turbulence and altering the sediment stratified bottom boundary layer it is worth noting that swash model results are almost as accurate as those by the vof based ihfoam model this is reassuring since swash does not require as fine a grid as vof based cfd models which makes it feasible to conduct field scale swash simulations without compromising much accuracy this is especially true when wave breaking and or turbulence effects are absent or insignificant as demonstrated in appendix c the partial standing wave patterns as a result of the varying sponge layer lengths fig 4 have negligible effects on the vertical flow profiles 3 3 effect of canopy configurations on wave height decay and wave driven current fig 6 shows the comparison of wave height evolution predicted by the swash model and a three layer analytical solution zhu and zou 2017 under submerged suspended and floating canopy configurations see fig 3c e for illustrations the same canopy parameters i e canopy length height density and drag coefficient are specified in the swash model and used for calculating the analytical solutions assuming the wave height h at a distance x into a canopy is related to the incident wave height h 0 as h h 0 exp kvx zhu and zou 2017 derived the analytical solution of the exponential decay coefficient kv for a canopy of height d 2 vertically positioned with a distance d 1 below the still water surface and a distance d 3 above the bottom 17 k v k 1 9 π c d b v n h 0 s i n h 3 k d 2 d 3 s i n h 3 k d 3 9 s i n h k d 2 d 3 9 s i n h k d 3 s i n h k d 2 k d s i n h 2 k d where k is the wavenumber bv is the vegetation stem width and d d 1 d 2 d 3 is the total water depth at which the canopy stands this three layer analytical solution has been validated in zhu and zou 2017 against both laboratory and field observations for submerged emergent and suspended canopies it can be observed in fig 6 that the most significant wave height decay occurs for the floating canopy for the case of relatively deep water waves kd 1 80 fig 6a the vertical location of the canopy in the water column plays a significant role in mitigating the wave energy this is expected since the wave kinematics for this case varies a lot across the water depth and becomes increasingly larger toward the free surface consequently increasingly larger canopy drag and more wave height decay are seen in the order of the submerged suspended and floating canopies as observed in fig 6a for the case of relatively shallow water waves kd 0 82 fig 6b the wave height decay is less sensitive to the canopy vertical location since the wave kinematics in this case is more uniform in the vertical direction note that for both cases the analytical solutions closely follow the swash model results with the largest discrepancy for the floating canopy in fig 6a the wave height decay by the analytical solution is overestimated compared with the swash result this is likely related to the linear wave assumption inherent in the analytical solution which tends to predict a proportionally larger damping for larger incident waves the agreement between the swash model results and the analytical solution is better for the linear incident waves in fig 6b where 0 5h0k 0 05 than for the nonlinear waves in fig 6a where 0 5h0k 0 11 fig 7 shows the spatial distribution of wave driven current and its vertical profile at x 5 35 m in the presence of submerged suspended and floating canopy respectively it is noted that the strong mean current jet is generated mainly in the vicinity of the canopy interface due to strong velocity shear at this region the higher the interface is located in the water column the larger the velocity shear the stronger the mean current strength and the larger the vertical extent of the current jet these results clearly support the empirical formulation proposed by abdolahpour et al 2017b for a submerged canopy based on physical tests which indicated that the maximum current speed increases with the above canopy orbital velocity and the vertical orbital excursion at the canopy interface and the canopy density more notably the model also predicts a mean current jet underneath the suspended and floating canopies in the opposite direction of the wave propagation this is in contrast to the shoreward current jet immediately within and above submerged canopies as observed by luhar et al 2010 2013 this phenomena has not been revealed previously however both current jets are generated near the canopy boundaries and would play an important role in the particulate transport and exchange around the canopies the mechanism behind the formation of the negative current jet is illustrated by the lagrangian trajectories of five particles initially placed within at the top and bottom of the canopy in fig 8 a the positive current jet at the canopy upper interface is generated by the positive velocity gradient due to damped flow motion within the canopy which is analogous to the wave streaming in the wave bottom boundary layers however due to flow attenuation within canopy the fluid particles at the bottom of the canopy travel faster at the bottom half of their orbits outside the canopy than at the top half of their orbits within the canopy fig 8e this leads to open particle orbits and a time averaged mean current in the opposite direction of wave propagation by analogy the current jet strength at the canopy lower interface should also be a function of the horizontal orbital velocity and the vertical orbital excursion at the interface and the canopy density the empirical model proposed for positive current jet by abdolahpour et al 2017b at the top of a submerged canopy may also be applicable to predict the magnitude of the negative current jet at the lower interface of a floating suspended canopy abdolahpour et al 2017b proposed that the observed maximum wave driven current speed u m a x at the top of a submerged canopy correlating well with the experimental data can be described by the following empirical formula 18 u m a x 0 5 u r m s ɛ t l d 0 3 where u r m s 1 t 0 t u u 2 d t is the root mean square rms horizontal orbital velocity far above the canopy u 1 t 0 t u d t is the time averaged mean velocity with u being the phase averaged velocity over multiple wave periods ε t is the vertical orbital excursion at canopy interface according to the linear wave theory and ld is the canopy drag length scale which is a function of canopy density and drag it should be noted that the empirical formulation eq 18 was proposed based on a laboratory study for shallow water waves applying the formula to intermediate water waves may need some adjustments since the rms wave velocity in the latter case is not as depth uniform as in shallow water waves as a result the rms orbital velocity at the canopy interface is used instead in our calculations fig 9 shows the maximum wave driven current speeds predicted by swash at the canopy interface in comparison with those by the empirical model of abdolahpour et al 2017b for all the three canopy configurations the positive negative currents are extracted from the vertical profiles at the middle of the canopy x 5 3 m it is found that the empirical model predicts quite well the positive current and slightly underestimates the magnitude of the negative current when the magnitude becomes larger the discrepancy in the stronger negative current between swash and the empirical model is reminiscent of the closed nature of the numerical flume the larger the stokes drift and the wave driven current near the canopy top the more return flow recirculating above and beneath as well as through the canopy it is not surprising that the recirculating flow in a closed flume would reinforce the negative current generated at the canopy lower interface therefore increasing the discrepancy observed between swash and the empirical model relative to open systems such as the ocean the return flow in a closed flume may have more impacts on the strength of the negative current than the positive current because in the latter case the compensating flow may preferentially return through a channel well above and below the canopy shear layer at the top interface abdolahpour et al 2017b where there is less resistance 3 4 wave driven current in a partially vegetated 3d flume fig 10 shows the swash model setup for a 3d numerical wave flume in which a submerged canopy occupies only half the flume width it is interesting to see how the spatial patterns of the wave driven current would change for this case the 3d numerical flume is 34 8 m long and 1 0 m wide as in the previous section the canopy is 10 7 m long and 0 57 m high which is equal to one third of the still water depth the computational domain is discretized with a uniform grid of 0 08 m in x direction and 0 0625 m in y direction and 50 layers in the vertical direction resulting in a total of 435 16 50 0 348 million grids the model was run 60 s on a lenovo thinkpad using 3 intel core i5 processors 2 2 ghz the subgrid approach by rijnsdorp et al 2017 was also tested by reducing the equidistantly distributed vertical pressure layers from 50 to 5 for each real time of 1 s this reduces the computational time from 13 min to 1 7 min without compromising the model results rijnsdorp et al 2017 fig 11 shows the spatial distribution of the wave driven mean flow in vertical x z plane y 0 06 m and the vertical profiles of mean horizontal velocity in the vicinity of side interface y 0 0 m center of flume of the partially filled submerged canopy fig 12 shows the spatial distribution of the mean flow in horizontal x y plane z 1 14 m and the spanwise profiles of horizontal velocity near the canopy top interface z 1 13 m it is found that at the canopy side interface y 0 0 m there is a strong current near the canopy top moving sideways from the canopy and into the other half of the flume i e y 0 06 0 12 m however the strength of this current cannot be sustained and is soon attenuated because of the absence of canopy drag while the vertical extent of the current near the canopy top interface is related to the water particle vertical excursion abdolahpour et al 2017b the spanwise extent of the current across the side interface is not for plane regular waves the water particle orbits in the same plane as that of wave propagation there is no out of plane orbital velocity that may contribute to the spanwise spreading of the current considering the spatial distribution of the mean flow in fig 12 the spanwise extent of the wave driven current is likely induced by the mixing layer formed at the canopy side interface fig 13 shows the spatial distribution of the depth averaged wave driven mean flow in the presence of the partially filled submerged canopy the model results show that there is a returning flow in the numerical flume compensating the stokes drift and the wave driven jet current generated near the canopy top interface the model results also confirm that the wave height decay along the canopy length induces additional wave setup o 0 1 mm dean and bender 2006 van rooijen et al 2016 for this 3d flume however we observed no spanwise variations of the wave height and the mean water level likely due to the small canopy drag and canopy width relative to the incoming wave length thus the dominant flow direction is longitudinal pointing to the negative x direction with the flow strength attenuated in half the flume due to the presence of canopy the flow adjusts itself near the leading and rear edges of the canopy the strength of the spanwise flow o 0 001 m s is at least one order of magnitude smaller than the dominant wave driven current in the direction of wave propagation 4 conclusions the present study examines the canopy induced wave driven mean flow structures across the suspended canopies the predictive capability of the non hydrostatic model swash is first assessed by comparisons with experiments and two vof based models developed on the openfoam platform for a submerged canopy it is shown that swash predicts well the wave height decay using only 3 vertical layers and resolves the vertical flow profiles using 30 50 layers the wave driven current jet near the top of a submerged canopy is as well captured by swash as the much more computationally intensive openfoam models the effects of suspended floating canopies on wave attenuation and vertical structures of wave driven mean flows are then examined using swash the predicted wave height decay agrees well with a three layer analytical solution zhu and zou 2017 the model results indicate the significant effect of canopy vertical location on wave attenuation and wave driven mean flow patterns for a suspended canopy numerical results show that a strong shoreward downwave mean current jet is generated near the top of canopy this result is consistent with that at the top of submerged canopy by luhar et al 2010 and abdolahpour et al 2017b in contrast a seaward upwave mean current jet is generated near the bottom of canopy which has not been revealed by previous studies the predicted particle trajectories indicate that due to flow attenuation within canopy at the bottom of the canopy the fluid particles travel faster at the bottom half of their orbits outside the canopy in the opposite direction of wave than at the top half of their orbits within the canopy in the direction of wave this leads to open particle orbits and a negative time averaged flow in the opposite direction of wave propagation at the top of the canopy the fluid particles travel faster at the top half of their orbits outside the canopy in the wave direction than at the bottom half of their orbits within the canopy in the opposite direction of wave abdolahpour et al 2017b this leads to open particle orbits and a positive time averaged flow in the direction of wave these findings provide more insights into the wave driven flows at the canopy boundaries which are critical to the particulate transport and exchange across the canopy the strength of both currents is related to wave horizontal velocity vertical orbital excursion and canopy density the proposed empirical formulation by abdolahpour et al 2017b based on observations for a submerged canopy predicts well the magnitude of the positive current and tends to underestimate that of the negative current which is reinforced by the recirculating flow near the canopy bottom in a closed flume the wave driven current generated near the canopy side interface is examined using a 3d swash simulation for a partially vegetated flume in the spanwise direction while the vertical extent of the current near the top and bottom of canopy is related to the wave particle vertical excursion the 3d model results suggest that the spanwise extent of the wave driven current is likely induced by the mixing layer at the canopy side interface turbulence resolving models such as large eddy simulations may be adopted to investigate in more detail the characteristics of the mixing layer these localized wave driven current patterns around the canopy water interface have strong implications on the net transport of suspended sediments nutrients and pollutants in the vegetated coastal habitats appendix a error metrics to quantify model performance two quantities normalized root mean square error nrmse and skill index si are used to quantify the model performance the nrmse is computed as a1 n r m s e 1 n i 1 n q p i q m i 2 max q m i min q m i and the skill index is computed as willmott 1981 a2 s i 1 i 1 n q p i q m i 2 i 1 n q p i q m q m i q m 2 where qp and qm are the predicted and measured parameters of interest and q m is the mean of the measured data the nrmse represents the magnitude of the errors with respect to the range of the measured data the skill index measures the similarity of the trend and absolute accuracy between the measurements and the model results which is bounded between 0 significant discrepancies and 1 perfect agreement appendix b effect of swash vertical layer resolutions on wave dissipation fig b1 shows the effect of swash vertical layer resolutions on the wave height decay above a submerged canopy the incident waves are in the range of intermediate depth kh 0 76 1 37 table 1 without adjusting the canopy drag coefficient increasing the vertical resolution from 3 layers to 50 layers adversely affected the model s skill index by 0 3 for cases 1 and 3 and 2 for cases 2 and 4 better resolving the velocity profiles results in slightly less wave dissipation however it is seen that most of the wave dissipation could be captured remarkably by swash using a low vertical resolution of 3 layers appendix c effect of swash sponge layer length on velocity profiles the wave dissipating sloping beach in the laboratory flume stratigaki et al 2011 was not incorporated in the present model studies as a result the reflected waves from the shoaling breaking process on the beach may lead to partial standing wave patterns not being captured by the swash model adopting sponge layers fig 4 demonstrates that by using different sponge layer lengths there appears a spatial shift in the resulting partial standing wave patterns the average wave reflection coefficients calculated at the leading and rear edges of the canopy using the four probe method lin and huang 2004 are 5 6 3 4 and 4 4 respectively for a sponge layer of 6 m 8 m and 10 m fig c1 shows the effect of these partial standing wave patterns on the velocity profiles within a submerged canopy it is therefore confirmed that despite the spatial shift of the reflected waves as observed in fig 4 the partial standing wave patterns have little effect on the velocity magnitude within the canopy 
716,coastal canopies deliver a wide range of ecosystem services through the flow and transport processes within and around the canopies this study presents a numerical investigation on the effect of suspended floating canopies on wave driven current around canopy using a non hydrostatic model swash the model results by swash for a submerged canopy are first validated with experiment measurements and compared with predictions from two volume of fluid vof based free surface flow models then the effects of suspended floating canopies on wave attenuation and vertical mean flow structures are examined using swash the model results show that a strong shoreward wave driven current is generated at the top of a suspended canopy in the same direction as the wave same as that at the top of a benthic canopy in contrast a seaward mean current is generated at the bottom of a suspended canopy in the opposite direction to the wave the predicted particle trajectories indicate that due to flow attenuation within canopy at the bottom of the canopy the fluid particles travel faster at the bottom half of their orbits outside the canopy in the opposite direction of wave propagation than at the top half of their orbits within the canopy in the direction of wave propagation this leads to open particle orbits and a time averaged mean current in the opposite direction of wave propagation the present study is the first attempt that reveals and examines this physical phenomena that would play an important role in particulate transport and exchange across the suspended canopies the maximum magnitudes of wave induced currents at the top and bottom of canopy are consistent with a recent empirical formula extracted from the observations for submerged canopy the predicted wave decay agrees well with a three layer analytical solution for suspended and submerged canopy and indicates that the canopy vertical location plays an important role in wave attenuation and canopy induced currents the spatial distribution patterns of the wave driven current clearly support the notion that the current strength generated at the canopy interface is a function of horizontal oscillatory velocity vertical orbital excursion and canopy density the spanwise extent of the mean current is examined by a 3 d simulation where the canopy occupies only half the flume width numerical results show that the wave driven current is mainly confined to the part of flume occupied by the canopy and that the current strength is soon attenuated to zero towards the other part of flume through a mixing layer like transition region at the canopy side interface keywords swash openfoam vegetation suspended canopy wave driven current flow structures 1 introduction in coastal environments canopies of aquatic vegetation are abundant and provide a wide range of ecosystem services barbier et al 2011 nepf 2012 the most quoted ecosystem service in changing climate is perhaps wave attenuation and mitigation of coastal flooding e g by seagrass meadows salt marshes mangroves and kelp forests bradley and houser 2009 gaylord et al 2003 ondiviela et al 2014 riffe et al 2011 wamsley et al 2010 zhang et al 2012 damping of waves and currents help promote sedimentation and prevent erosion which in turn contributes to growth and expansion of the coastal canopy corenblit et al 2007 horstman et al 2015 hu et al 2018 gacia and duarte 2001 van katwijk et al 2010 unlike the familiar natural submerged or emergent canopies that are rooted at seafloor suspended canopies have received little attention common examples of suspended canopies include forests of certain kelp such as macrocytis that have most of its biomass near the surface rosman et al 2007 long line mussel farms in aquaculture plew et al 2005 2006 mckindsey et al 2011 vegetated platforms that serve as breakwaters for shore protection and marsh restoration in estuaries chen et al 2016 and floating treatment wetlands to purify stormwater and eutrophic water bodies in ecological engineering fang et al 2007 tanner and headley 2011 xu et al 2017 wave attenuation due to vegetation has been studied extensively via theory experiments field observations and numerical modelling in the past decades however the effect of canopies on wave induced mean flow is much less understood the mean flow dictates the exchange of water and particulate matter across the canopy boundaries which regulates the ecosystem services capacity of aquatic canopies as for unidirectional flow in rivers and tides nepf and vivoni 2000 huai et al 2012 plew 2011 the presence of canopy also alters the vertical flow profiles for oscillatory flows abdolahpour et al 2017b lowe et al 2005a luhar et al 2010 pujol et al 2013 lowe et al 2005a found that flow inside a canopy is more intensified under oscillatory forcing of wave action than steady current forcing of the same magnitude which in turn results in higher mass transfer rates lowe et al 2005b in the vicinity of the canopy water interface a few laboratory experiments abdolahpour et al 2017b luhar et al 2010 stratigaki et al 2011 and a field study luhar et al 2013 revealed a strong shoreward mean current in the wave direction immediately within and above a submerged canopy which may influence the canopy residence time through advection and vertical mixing abdolahpour et al 2017a currently there is a lack of experimental studies on wave driven flows in the presence of suspended canopies many numerical studies in the literature have been dedicated to wave attenuations by the submerged or emergent canopies using bousinessq type models augustin et al 2009 blackmar et al 2013 chakrabarti et al 2017 yang et al 2015 non hydrostatic wave model nhwave ma et al 2013 wu et al 2016 zhu and chen 2015 and navier stokes solvers coupled with volume of fluid vof surface capturing schemes chakrabarti et al 2016 chen et al 2016 2017 marsooli and wu 2014 maza et al 2013 2016 however very few studies have focused on the vertical and horizontal structure of mean flow induced by submerged emergent canopies chakrabarti et al 2016 chen et al 2017 maza et al 2013 and hardly any on suspended canopies in this study we utilize a non hydrostatic wave flow model swash simulating waves till shore zijlema et al 2011 to investigate the canopy effect on wave attenuation and the wave driven current the merit of the non hydrostatic models lies in their computational efficiency and high accuracy of capturing wave dispersion properties with only two to three vertical layers on the other hand this type of model can also be applied with an arbitrary number of vertical layers to resolve the vertical structure of the flow the grid resolution requirement for the latter application is less than that for the vof based models to further reduce the computational cost dominated by solving the pressure poisson equations rijnsdorp et al 2017 proposed a subgrid approach which solves the vertical accelerations and non hydrostatic pressures on a relatively coarse vertical grid and the horizontal velocities and turbulent stresses on a much finer subgrid this boosts the computational efficiency by up to one order of magnitude the new implementation in swash makes it highly attractive for three dimensional 3d wave flow simulations at field scales 10 10 wavelengths and 1000 wave periods in the present study the subgrid approach was adopted in 3d simulations for a partially vegetated flume the objective of the present study is to investigate the wave attenuation and vertical structure of wave driven flows in the presence of both submerged and suspended canopies in particular the wave driven current at the interface of suspended canopies the performance of swash and two vof based models with different wave absorption techniques are first compared the paper is structured as follows the non hydrostatic model swash and the two vof based models built on the openfoam platform wavefoam and ihfoam are described in section 2 all three models consider rigid canopies only and treat them as a continuous medium which is in its discrete form similar to an infinite row of identical vegetation stems dupont et al 2010 in section 3 the performance of the three models to predict wave height decay are compared followed by the validation of vertical flow profiles predicted by swash and ihfoam the effect of canopy configuration on wave attenuation and wave driven flow pattern are then examined the wave driven current generated at the canopy interface is further investigated by a 3d simulation of a canopy that occupies only half width of the flume conclusions are drawn in section 4 2 methodology 2 1 swash the non hydrostatic model swash zijlema et al 2011 solves the mass and momentum balance equations for an incompressible single phase free surface flow which is vertically bounded by the time varying free surface z η x y t and the fixed bottom z h x y here x y z are the cartesian coordinates t is time η is the free surface displacement relative to the still water level where z 0 and h is the still water depth the governing equations are given as rijnsdorp et al 2017 1 u x v y w z 0 2 u t u u x u v y u w z g η x q x τ x x x τ x y y τ x z z 1 ρ f d x 3 v t v u x v v y v w z g η y q y τ y x x τ y y y τ y z z 1 ρ f d y 4 w t w u x w v y w w z q z τ z x x τ z y y τ z z z where u v w are the velocity component in the x y and z direction respectively g is the gravitational acceleration ρ is the constant fluid density and τ ij represents the turbulent stresses i and j denoting the coordinates in these equations the total pressure has been decomposed into the hydrostatic ρg η z and non hydrostatic component ρq with q being the normalized non hydrostatic pressure the last terms in eqs 2 and 3 represent the momentum loss due to the presence of canopy fdx and fdy are the x and y component of the drag force acting on the rigid canopy 5 f d x 0 5 ρ c d n b v u u 6 f d y 0 5 ρ c d n b v u v where cd is the canopy drag coefficient n is the number of vegetation stems per unit bed area and bv is the stem width and u u 2 v 2 w 2 is the magnitude of the velocity the time evolution of the free surface is obtained by enforcing the mass conservation across the entire water column 7 η t x h η u d z y h η v d z 0 the numerical implementation of swash is based on an explicit second order accurate finite difference method in space and time it makes use of a surface and terrain following σ coordinate that divides the instantaneous water column vertically into a fixed number of layers the number of layers required for accurate wave predictions depends on the dimensionless water depth kh where k is the wave number to ensure sufficiently accurate prediction of wave dispersion the pressure gradient in the vertical momentum equation is approximated by the keller box scheme or the standard central differences in the present study the wave height decay is simulated using low vertical resolutions 3 layers and the keller box scheme while the flow profiles are resolved using high vertical resolutions 30 50 layers and the central differencing scheme waves are generated by prescribing time series of surface elevation or horizontal particle velocities at the wavemaker boundary which may be obtained from wave theory or experiments in case of flat bottom waves need to be damped or absorbed by specifying a sponge layer of finite length before reaching the other end of the flume in case of a sloping beach a moving shoreline boundary is also available which conserves the mass and removes the computational grid points wherever the local water depth is below a certain threshold the sponge layer implemented in swash is similar to the relaxation zone in the vof based wave model wavefoam described in the next section the vertical layer schematization of vegetation by suzuki et al 2012 extends swash to study the effects of submerged and suspended canopies on wave attenuation and vertical flow structures 2 2 vof models since swash treats the free surface as a single valued function η x y t it cannot resolve wave breaking processes such as overturning plunging air entrainment and breaking induced turbulence with the development of sophisticated cfd algorithms and increasing computing power the free surface flow models using vof method hirt and nichols 1981 have seen increasing applications to wave structure interactions and surf zone breakers e g chen et al 2017 jacobsen et al 2012 zhou et al 2017 for example the interfoam is a family of two phase flow solvers in the open source cfd toolbox openfoam jasak 1996 rusche 2002 treating the air water mixture as one effective fluid the two phase flow model solves only one set of mass conservation and momentum equations jasak 1996 rusche 2002 8 u 0 9 ρ u t ρ u u μ e f f u p g x ρ u μ e f f f d 10 α t u α u r α 1 α 0 where u u v w is the fluid velocity vector with u v w being the velocity component in x y z directions respectively ρ is the fluid density μ eff μ ρν t is the effective viscosity incorporating both dynamic viscosity μ and turbulent eddy viscosity ν t p is the pseudo dynamic pressure g is the acceleration due to the gravity x is the position vector of the fluid grid f d 0 5 ρ c d n b v u u is the hydrodynamic drag force acting on the canopy note that this formulation consists of a vertical drag component which is much smaller than the horizontal components eqs 5 and 6 future implementations should use different drag coefficients in directions that are respectively tangential vertical for rigid canopies and perpendicular horizontal to the stem s longitudinal axis α is the volume of fluid fraction used to mark the location of the free surface and u r is a velocity field to prevent the smearing of the air water interface the local density ρ and the local viscosity μ of the effective fluid are calculated by 11 ρ α ρ 1 1 α ρ 2 12 μ α μ 1 1 α μ 2 where the subscripts 1 and 2 denote the water and air properties respectively the interfoam solver is implemented on a collocated unstructured grid with a finite volume discretization with eqs 8 12 solved using the pressure implicit with splitting of operators piso algorithm the readers should refer to jasak 1996 for a detailed description of the finite volume method in openfoam and to rusche 2002 for the vof surface capturing scheme to apply the general purpose free surface flow solver to study coastal processes jacobsen et al 2012 and higuera et al 2013 separately extended the interfoam solver with additional functionalities for wave current generation and absorption and released the solvers open source as wavefoam and ihfoam respectively building upon these two solvers the present authors further incorporated the canopy effect in the momentum equation eq 9 2 2 1 wavefoam the wavefoam solver by jacobsen et al 2012 adopts the relaxation zone technique which requires extra computational domains 1 2 wavelengths to minimize the wave reflection for each region designated as a relaxation zone a target solution of wave current field is prescribed the velocity and volume fraction field inside the relaxation zone are a weighted average of the target solution and that computed from the cfd solver 13 u γ u c o m p u t e d 1 γ u t a r g e t 14 α γ α c o m p u t e d 1 γ α t a r g e t where γ denotes a relaxation parameter which varies smoothly from 1 to 0 across the relaxation zone the relaxation parameter typically takes either a higher order polynomial or exponential functional form when the target field is set to be the state of the still water the incoming wave field gradually approaches this target with γ 0 at the end of the relaxation zone similar approach was implemented in swash designated as sponge layer to prevent wave reflections 2 2 2 ihfoam on a different approach the ihfoam solver by higuera et al 2013 uses an active absorbing boundary condition to cope with the wave reflection without increasing the length of the computational domain it measures the surface elevation in front of the boundary and actively adjusts the inflow or outflow flux by comparing the measured surface elevation η m with the theoretical target η t in case a reflected wave η r is detected the inflow velocity profile is adjusted by assuming that the reflected wave is in shallow water regime and hence its phase speed c and depth uniform velocity profile uc can be easily determined by 15 c g h 16 u c g h η r where η r η m η t is the reflected wave height and uc is the correction velocity to be applied perpendicular to the boundary to cancel out the reflected wave for a wavemaker boundary the target surface elevation is calculated from a given wave theory for a pure absorbent boundary the target surface elevation is the still water level η t 0 2 3 turbulence models the standard two equation k ε model have been adapted to compute the mean flow and turbulence structures in open channels with rigid submerged canopies e g shimizu and tsujimoto 1994 lopez and garcia 2001 assuming that the work done by the flow against canopy drag is converted to the turbulent energy two additional terms are introduced in the transport equations for turbulent kinetic energy k and dissipation rate ε in swash the default closure coefficients are those calibrated by shimizu and tsujimoto 1994 for the vof based models wavefoam and ihfoam the k ε model in openfoam is adapted following the formulations proposed by lopez and garcia 2001 in the present study both models have been run with and without activating the two equation closure model we found that the model results are not sensitive to the inclusion of the turbulence model skill index changes less than 4 therefore only results without the closure model are reported in the following section the most noticeable difference observed is that for swash activating turbulence model helps to smooth slightly the vertical flow profiles 3 results and discussion before applying the model to study wave attenuation and mean flow structures around the canopies three validation exercises were performed against observations and analytical solutions 1 wave height decay above a submerged canopy 2 wave decay and velocity profiles within a submerged canopy and 3 wave decay by additional suspended floating canopies in this section we first assess the performance of swash and two vof based models to predict the wave attenuation in the presence of submerged canopies the predictive capability of swash to resolve the vertical flow profiles is then confirmed by comparing with ihfoam predictions and a large scale flume experiment stratigaki et al 2011 the effects of canopy configurations submerged suspended and floating canopies on wave attenuation and spatial distribution patterns of the mean flow are then examined the maximum wave driven current predicted at the canopy interface is evaluated with a recent empirical model by abdolahpour et al 2017b the formation mechanism of this current is further investigated by a 3d simulation in which the canopy occupies only half width of the flume 3 1 comparison of wave height decay by three models fig 1 shows the experimental and the numerical flume setup for the non hydrostatic model swash and the vof based model wavefoam and ihfoam respectively the experiments were conducted at the usda ars national sedimentation laboratory nsl in oxford mississippi usa wu et al 2012 where the wave attenuation with rigid and flexible vegetation was tested over a flatbed marsooli and wu 2014 the stem of the rigid vegetation is made of birch dowels and that of the flexible vegetation polyurethane tubing both of which are 0 2 m tall and have a stem diameter of 3 1 mm the vegetation canopy with a staggered arrangement is 3 66 m long and has a density of 3182 stems m2 the porous parabolic beach in the physical flume fig 1a is not included in the numerical flumes fig 1b d because the porosity and the shape of the beach is unknown the error metrics of model sensitivity in appendix a are used to evaluate the model performance for the swash model the numerical flume is 14 0 m long including a 4 0 m sponge layer to the right of the flume the computational domain is discretized into 700 grids horizontally with a uniform size of 0 02 m and 3 equidistant layers vertically see appendix b for the model sensitivity to vertical layer resolutions a weakly reflective wavemaker boundary is specified based on the target wave conditions listed in table 1 a radiation boundary condition is specified at the right end outlet the time step is automatically adjusted between a maximum and minimum courant number of 0 5 and 0 2 all cases are run 30 s while only the last 5 wave periods results are used for post processing for the vof based flow solvers the flume height increases to 0 5 m to accommodate the air motion the wavefoam model uses a 4 0 m long relaxation zone to absorb the outgoing waves while the ihfoam model adopts the absorbing boundary to let the waves leave the domain freely a uniform grid size of 0 01 m in the horizontal direction and 0 005 m in the vertical direction is used resulting in a total of 140 000 grids for the wavefoam model and 100 000 grids for the ihfoam model the time step is automatically adjusted at runtime by imposing a maximum courant number of 0 3 our modeling experience suggests that a smaller courant number is required to achieve more accurate wave predictions the corresponding wave parameters listed in table 1 are used to specify the boundary conditions at the wavemaker fig 2 shows the comparison of the three model predictions with the experimental measurements it is seen that all three models adequately capture the extent of wave height decay by the submerged canopy the average skill index being 0 96 0 97 and 0 92 for swash wavefoam and ihfoam respectively see table 2 for relatively deep water and shorter waves cases 1 and 3 the predictions by swash and wavefoam are almost identical with negligible spatial oscillations in the wave height evolution average wave reflection coefficient 1 0 however the prediction by ihfoam exhibits a considerable spatial oscillation starting at the rear edge of the canopy wave reflection coefficient about 9 which is attenuated approaching the leading edge for relatively shallow water and longer waves cases 2 and 4 the extent of the spatial oscillation in the ihfoam predictions is reduced since the numerical models exclude the porous parabolic beach of limited length in the physical flume which may cause stronger wave reflections for longer period waves as demonstrated by the measurements in fig 2c and d the models tend to under predict the spatial oscillations of wave height this comparison suggests that the absorbing boundary condition proposed by ihfoam which assumes a shallow water wave regime indeed performs slightly better for shallow water waves than for their deep water counterparts on the other hand the sponge layer relaxation zone technique adopted by swash wavefoam seem to work well for both cases although extra length of the computational domain entails more cpu time see table 3 for computational time comparisons the calibrated canopy drag in table 1 for both rigid and flexible vegetation is consistent with those in previous studies e g marsooli and wu 2014 the calibrated drag for the flexible canopy cases 3 and 4 is only slightly smaller than that for the rigid canopy cases 1 and 2 it is also noted that the drag coefficients calibrated for swash is only slightly different from those for the vof based models which may be attributed to the differences in the wavemaker boundaries and the wave velocity profiles in these models it should be emphasized that the good predictive skills for the different models in table 2 were achieved by fitting the bulk canopy drag coefficient against the measured wave height data the canopy drag coefficient is the most uncertain parameter used to incorporate the canopy effect into hydrodynamic models as a continuous medium as reviewed by henry et al 2015 significant variations exist in the plethora of the proposed canopy drag coefficients which are typically functions of reynolds number and keulegan carpenter number a universal canopy drag formulation applicable to various vegetation properties and wave conditions is currently lacking and is still an ongoing research topic 3 2 vertical flow profiles in the presence of submerged canopies fig 3 a and b show the laboratory flume and the swash model setup in which a submerged canopy is subjected to regular waves generated at relatively deep water stratigaki et al 2011 the flume bottom is covered with a 20 m long flat sandy layer and two sloping beaches the vegetation canopy is 10 7 m long and 0 55 m high with a canopy density of 180 360 stems m2 and a stem width of 1 cm the incident wave conditions are listed in table 4 while all cases have been simulated using swash only case s1 was also simulated using ihfoam which requires less computational time compared with wavefoam the wave absorbing sandy sloping beach at the outlet in the laboratory flume was replaced with a solid flat bottom combined with a sponge layer in swash and an absorbing boundary in ihfoam the implications of using different wave absorbing techniques in numerical models is discussed by comparing the present model results using varying sponge layer lengths and the ih2vof model results maza et al 2013 for the swash model the horizontal grid size is 0 08 m for t 3 5 4 0 s and 0 04 m for t 2 0 s which leads to more than 150 grids per wavelength preliminary tests have shown that it is adequate to use 3 vertical layers to resolve the wave height evolution see appendix b while it requires 50 layers for h 2 4 m and 30 layers for h 1 8 m to adequately resolve the vertical flow profiles for the ihfoam model a uniform grid of 0 04 m in horizontal and 0 02 m in vertical is used which results in four times as many grids as the swash model both models were run for 60 s while only the last 5 wave periods results are used for post processing fig 4 shows the effect of sponge layer length and or the starting location on the oscillation of wave height decay for a submerged canopy with normalized root mean square error nrmse nrmse 0 28 and skill index si si 0 79 for a 6 m sponger layer nrmse 0 18 and si 0 89 for a 8 m sponger layer nrmse 0 33 and si 0 58 for a 10 m sponger layer and nrmse 0 16 and si 0 91 for ih2vof the flume length is kept constant at 60 m so varying the sponge layer length also changes the location where the wave starts to be artificially damped by the sponge layer this would affect the phase of the reflected waves relative to the incident waves and hence the spatial oscillation patterns of the wave height above the canopy the swash model results in fig 4 confirm this hypothesis and show that the oscillation pattern for a 8 m sponger layer solid line is more consistent with that in the experimental measurements although the predicted oscillation is slightly weaker also shown in fig 4 is the ih2vof model result by maza et al 2013 which shows that the predicted oscillation magnitude and distance between troughs in the wave height are also smaller than the observation model data comparisons for other incident wave and canopy conditions see figs 6 and 7 in maza et al 2013 and fig 6 in marsooli and wu 2014 suggest that even if the wave absorbing is simulated by including a sloping beach the numerical model cannot replicate the observed partial standing wave patterns exactly these discrepancies may come from the difference in the incident waves generated at the wavemaker and the unknown wave reflections altered by the beach morphologic changes due to the wave action to validate the predicted vertical profiles of velocity the swash predictions from the surface and terrain following σ coordinate are interpolated vertically to a fixed uniform grid subsequently the mean velocities were computed at each grid point by time averaging the interpolated model predictions fig 5 shows the vertical flow profiles predicted by swash and ihfoam and experimental measurements by stratigaki et al 2011 before entering the leading edge of the submerged canopy the wave kinematics is not affected by the canopy fig 5a and consistent with the depth uniform velocity profiles typical of shallow water waves while within the canopy the wave kinematics is altered significantly in the vicinity of the canopy interface which generates a non zero mean current in the direction of wave propagation both model predictions are in reasonable agreements with the experiment with skill index si si 0 54 for swash and si 0 59 for ihfoam the relatively low skills affected by the limited number of measurements the discrepancies near the canopy interface between swash and ihfoam may be due to the additional vertical drag component in the ihfoam model see eq 9 in section 2 2 the discrepancies below the canopy interface between model and measurement in fig 5c may result from the local bed elevation changes around the vegetation stems and the disturbance of the suspended sediments picked up from the sandy bottom which are not considered in the models from the macroscopic point of view ma et al 2014 summarized that the presence of suspended sediments would create a stably stratified water column which then plays a critical role in damping the flow turbulence and altering the sediment stratified bottom boundary layer it is worth noting that swash model results are almost as accurate as those by the vof based ihfoam model this is reassuring since swash does not require as fine a grid as vof based cfd models which makes it feasible to conduct field scale swash simulations without compromising much accuracy this is especially true when wave breaking and or turbulence effects are absent or insignificant as demonstrated in appendix c the partial standing wave patterns as a result of the varying sponge layer lengths fig 4 have negligible effects on the vertical flow profiles 3 3 effect of canopy configurations on wave height decay and wave driven current fig 6 shows the comparison of wave height evolution predicted by the swash model and a three layer analytical solution zhu and zou 2017 under submerged suspended and floating canopy configurations see fig 3c e for illustrations the same canopy parameters i e canopy length height density and drag coefficient are specified in the swash model and used for calculating the analytical solutions assuming the wave height h at a distance x into a canopy is related to the incident wave height h 0 as h h 0 exp kvx zhu and zou 2017 derived the analytical solution of the exponential decay coefficient kv for a canopy of height d 2 vertically positioned with a distance d 1 below the still water surface and a distance d 3 above the bottom 17 k v k 1 9 π c d b v n h 0 s i n h 3 k d 2 d 3 s i n h 3 k d 3 9 s i n h k d 2 d 3 9 s i n h k d 3 s i n h k d 2 k d s i n h 2 k d where k is the wavenumber bv is the vegetation stem width and d d 1 d 2 d 3 is the total water depth at which the canopy stands this three layer analytical solution has been validated in zhu and zou 2017 against both laboratory and field observations for submerged emergent and suspended canopies it can be observed in fig 6 that the most significant wave height decay occurs for the floating canopy for the case of relatively deep water waves kd 1 80 fig 6a the vertical location of the canopy in the water column plays a significant role in mitigating the wave energy this is expected since the wave kinematics for this case varies a lot across the water depth and becomes increasingly larger toward the free surface consequently increasingly larger canopy drag and more wave height decay are seen in the order of the submerged suspended and floating canopies as observed in fig 6a for the case of relatively shallow water waves kd 0 82 fig 6b the wave height decay is less sensitive to the canopy vertical location since the wave kinematics in this case is more uniform in the vertical direction note that for both cases the analytical solutions closely follow the swash model results with the largest discrepancy for the floating canopy in fig 6a the wave height decay by the analytical solution is overestimated compared with the swash result this is likely related to the linear wave assumption inherent in the analytical solution which tends to predict a proportionally larger damping for larger incident waves the agreement between the swash model results and the analytical solution is better for the linear incident waves in fig 6b where 0 5h0k 0 05 than for the nonlinear waves in fig 6a where 0 5h0k 0 11 fig 7 shows the spatial distribution of wave driven current and its vertical profile at x 5 35 m in the presence of submerged suspended and floating canopy respectively it is noted that the strong mean current jet is generated mainly in the vicinity of the canopy interface due to strong velocity shear at this region the higher the interface is located in the water column the larger the velocity shear the stronger the mean current strength and the larger the vertical extent of the current jet these results clearly support the empirical formulation proposed by abdolahpour et al 2017b for a submerged canopy based on physical tests which indicated that the maximum current speed increases with the above canopy orbital velocity and the vertical orbital excursion at the canopy interface and the canopy density more notably the model also predicts a mean current jet underneath the suspended and floating canopies in the opposite direction of the wave propagation this is in contrast to the shoreward current jet immediately within and above submerged canopies as observed by luhar et al 2010 2013 this phenomena has not been revealed previously however both current jets are generated near the canopy boundaries and would play an important role in the particulate transport and exchange around the canopies the mechanism behind the formation of the negative current jet is illustrated by the lagrangian trajectories of five particles initially placed within at the top and bottom of the canopy in fig 8 a the positive current jet at the canopy upper interface is generated by the positive velocity gradient due to damped flow motion within the canopy which is analogous to the wave streaming in the wave bottom boundary layers however due to flow attenuation within canopy the fluid particles at the bottom of the canopy travel faster at the bottom half of their orbits outside the canopy than at the top half of their orbits within the canopy fig 8e this leads to open particle orbits and a time averaged mean current in the opposite direction of wave propagation by analogy the current jet strength at the canopy lower interface should also be a function of the horizontal orbital velocity and the vertical orbital excursion at the interface and the canopy density the empirical model proposed for positive current jet by abdolahpour et al 2017b at the top of a submerged canopy may also be applicable to predict the magnitude of the negative current jet at the lower interface of a floating suspended canopy abdolahpour et al 2017b proposed that the observed maximum wave driven current speed u m a x at the top of a submerged canopy correlating well with the experimental data can be described by the following empirical formula 18 u m a x 0 5 u r m s ɛ t l d 0 3 where u r m s 1 t 0 t u u 2 d t is the root mean square rms horizontal orbital velocity far above the canopy u 1 t 0 t u d t is the time averaged mean velocity with u being the phase averaged velocity over multiple wave periods ε t is the vertical orbital excursion at canopy interface according to the linear wave theory and ld is the canopy drag length scale which is a function of canopy density and drag it should be noted that the empirical formulation eq 18 was proposed based on a laboratory study for shallow water waves applying the formula to intermediate water waves may need some adjustments since the rms wave velocity in the latter case is not as depth uniform as in shallow water waves as a result the rms orbital velocity at the canopy interface is used instead in our calculations fig 9 shows the maximum wave driven current speeds predicted by swash at the canopy interface in comparison with those by the empirical model of abdolahpour et al 2017b for all the three canopy configurations the positive negative currents are extracted from the vertical profiles at the middle of the canopy x 5 3 m it is found that the empirical model predicts quite well the positive current and slightly underestimates the magnitude of the negative current when the magnitude becomes larger the discrepancy in the stronger negative current between swash and the empirical model is reminiscent of the closed nature of the numerical flume the larger the stokes drift and the wave driven current near the canopy top the more return flow recirculating above and beneath as well as through the canopy it is not surprising that the recirculating flow in a closed flume would reinforce the negative current generated at the canopy lower interface therefore increasing the discrepancy observed between swash and the empirical model relative to open systems such as the ocean the return flow in a closed flume may have more impacts on the strength of the negative current than the positive current because in the latter case the compensating flow may preferentially return through a channel well above and below the canopy shear layer at the top interface abdolahpour et al 2017b where there is less resistance 3 4 wave driven current in a partially vegetated 3d flume fig 10 shows the swash model setup for a 3d numerical wave flume in which a submerged canopy occupies only half the flume width it is interesting to see how the spatial patterns of the wave driven current would change for this case the 3d numerical flume is 34 8 m long and 1 0 m wide as in the previous section the canopy is 10 7 m long and 0 57 m high which is equal to one third of the still water depth the computational domain is discretized with a uniform grid of 0 08 m in x direction and 0 0625 m in y direction and 50 layers in the vertical direction resulting in a total of 435 16 50 0 348 million grids the model was run 60 s on a lenovo thinkpad using 3 intel core i5 processors 2 2 ghz the subgrid approach by rijnsdorp et al 2017 was also tested by reducing the equidistantly distributed vertical pressure layers from 50 to 5 for each real time of 1 s this reduces the computational time from 13 min to 1 7 min without compromising the model results rijnsdorp et al 2017 fig 11 shows the spatial distribution of the wave driven mean flow in vertical x z plane y 0 06 m and the vertical profiles of mean horizontal velocity in the vicinity of side interface y 0 0 m center of flume of the partially filled submerged canopy fig 12 shows the spatial distribution of the mean flow in horizontal x y plane z 1 14 m and the spanwise profiles of horizontal velocity near the canopy top interface z 1 13 m it is found that at the canopy side interface y 0 0 m there is a strong current near the canopy top moving sideways from the canopy and into the other half of the flume i e y 0 06 0 12 m however the strength of this current cannot be sustained and is soon attenuated because of the absence of canopy drag while the vertical extent of the current near the canopy top interface is related to the water particle vertical excursion abdolahpour et al 2017b the spanwise extent of the current across the side interface is not for plane regular waves the water particle orbits in the same plane as that of wave propagation there is no out of plane orbital velocity that may contribute to the spanwise spreading of the current considering the spatial distribution of the mean flow in fig 12 the spanwise extent of the wave driven current is likely induced by the mixing layer formed at the canopy side interface fig 13 shows the spatial distribution of the depth averaged wave driven mean flow in the presence of the partially filled submerged canopy the model results show that there is a returning flow in the numerical flume compensating the stokes drift and the wave driven jet current generated near the canopy top interface the model results also confirm that the wave height decay along the canopy length induces additional wave setup o 0 1 mm dean and bender 2006 van rooijen et al 2016 for this 3d flume however we observed no spanwise variations of the wave height and the mean water level likely due to the small canopy drag and canopy width relative to the incoming wave length thus the dominant flow direction is longitudinal pointing to the negative x direction with the flow strength attenuated in half the flume due to the presence of canopy the flow adjusts itself near the leading and rear edges of the canopy the strength of the spanwise flow o 0 001 m s is at least one order of magnitude smaller than the dominant wave driven current in the direction of wave propagation 4 conclusions the present study examines the canopy induced wave driven mean flow structures across the suspended canopies the predictive capability of the non hydrostatic model swash is first assessed by comparisons with experiments and two vof based models developed on the openfoam platform for a submerged canopy it is shown that swash predicts well the wave height decay using only 3 vertical layers and resolves the vertical flow profiles using 30 50 layers the wave driven current jet near the top of a submerged canopy is as well captured by swash as the much more computationally intensive openfoam models the effects of suspended floating canopies on wave attenuation and vertical structures of wave driven mean flows are then examined using swash the predicted wave height decay agrees well with a three layer analytical solution zhu and zou 2017 the model results indicate the significant effect of canopy vertical location on wave attenuation and wave driven mean flow patterns for a suspended canopy numerical results show that a strong shoreward downwave mean current jet is generated near the top of canopy this result is consistent with that at the top of submerged canopy by luhar et al 2010 and abdolahpour et al 2017b in contrast a seaward upwave mean current jet is generated near the bottom of canopy which has not been revealed by previous studies the predicted particle trajectories indicate that due to flow attenuation within canopy at the bottom of the canopy the fluid particles travel faster at the bottom half of their orbits outside the canopy in the opposite direction of wave than at the top half of their orbits within the canopy in the direction of wave this leads to open particle orbits and a negative time averaged flow in the opposite direction of wave propagation at the top of the canopy the fluid particles travel faster at the top half of their orbits outside the canopy in the wave direction than at the bottom half of their orbits within the canopy in the opposite direction of wave abdolahpour et al 2017b this leads to open particle orbits and a positive time averaged flow in the direction of wave these findings provide more insights into the wave driven flows at the canopy boundaries which are critical to the particulate transport and exchange across the canopy the strength of both currents is related to wave horizontal velocity vertical orbital excursion and canopy density the proposed empirical formulation by abdolahpour et al 2017b based on observations for a submerged canopy predicts well the magnitude of the positive current and tends to underestimate that of the negative current which is reinforced by the recirculating flow near the canopy bottom in a closed flume the wave driven current generated near the canopy side interface is examined using a 3d swash simulation for a partially vegetated flume in the spanwise direction while the vertical extent of the current near the top and bottom of canopy is related to the wave particle vertical excursion the 3d model results suggest that the spanwise extent of the wave driven current is likely induced by the mixing layer at the canopy side interface turbulence resolving models such as large eddy simulations may be adopted to investigate in more detail the characteristics of the mixing layer these localized wave driven current patterns around the canopy water interface have strong implications on the net transport of suspended sediments nutrients and pollutants in the vegetated coastal habitats appendix a error metrics to quantify model performance two quantities normalized root mean square error nrmse and skill index si are used to quantify the model performance the nrmse is computed as a1 n r m s e 1 n i 1 n q p i q m i 2 max q m i min q m i and the skill index is computed as willmott 1981 a2 s i 1 i 1 n q p i q m i 2 i 1 n q p i q m q m i q m 2 where qp and qm are the predicted and measured parameters of interest and q m is the mean of the measured data the nrmse represents the magnitude of the errors with respect to the range of the measured data the skill index measures the similarity of the trend and absolute accuracy between the measurements and the model results which is bounded between 0 significant discrepancies and 1 perfect agreement appendix b effect of swash vertical layer resolutions on wave dissipation fig b1 shows the effect of swash vertical layer resolutions on the wave height decay above a submerged canopy the incident waves are in the range of intermediate depth kh 0 76 1 37 table 1 without adjusting the canopy drag coefficient increasing the vertical resolution from 3 layers to 50 layers adversely affected the model s skill index by 0 3 for cases 1 and 3 and 2 for cases 2 and 4 better resolving the velocity profiles results in slightly less wave dissipation however it is seen that most of the wave dissipation could be captured remarkably by swash using a low vertical resolution of 3 layers appendix c effect of swash sponge layer length on velocity profiles the wave dissipating sloping beach in the laboratory flume stratigaki et al 2011 was not incorporated in the present model studies as a result the reflected waves from the shoaling breaking process on the beach may lead to partial standing wave patterns not being captured by the swash model adopting sponge layers fig 4 demonstrates that by using different sponge layer lengths there appears a spatial shift in the resulting partial standing wave patterns the average wave reflection coefficients calculated at the leading and rear edges of the canopy using the four probe method lin and huang 2004 are 5 6 3 4 and 4 4 respectively for a sponge layer of 6 m 8 m and 10 m fig c1 shows the effect of these partial standing wave patterns on the velocity profiles within a submerged canopy it is therefore confirmed that despite the spatial shift of the reflected waves as observed in fig 4 the partial standing wave patterns have little effect on the velocity magnitude within the canopy 
717,the coincidence of two or more extreme events precipitation and storm surge for example may lead to severe floods in coastal cities it is important to develop powerful numerical tools for improved flooding predictions especially over a wide range of spatial scales metres to many kilometres and assessment of joint influence of extreme events various numerical models have been developed to perform high resolution flood simulations in urban areas however the use of high resolution meshes across the whole computational domain may lead to a high computational burden more recently an adaptive isotropic unstructured mesh technique has been first introduced to urban flooding simulations and applied to a simple flooding event observed as a result of flow exceeding the capacity of the culvert during the period of prolonged or heavy rainfall over existing adaptive mesh refinement methods amr locally nested static mesh methods this adaptive unstructured mesh technique can dynamically modify both coarsening and refining the mesh and adapt the mesh to achieve a desired precision thus better capturing transient and complex flow dynamics as the flow evolves in this work the above adaptive mesh flooding model based on 2d shallow water equations named as floodity has been further developed by introducing 1 an anisotropic dynamic mesh optimization technique anisotropic dmo 2 multiple flooding sources extreme rainfall and sea level events and 3 a unique combination of anisotropic dmo and high resolution digital terrain model dtm data it has been applied to a densely urbanized area within greve denmark results from mike 21 fm are utilized to validate our model to assess uncertainties in model predictions sensitivity of flooding results to extreme sea levels rainfall and mesh resolution has been undertaken the use of anisotropic dmo enables us to capture high resolution topographic features buildings rivers and streets only where and when is needed thus providing improved accurate flooding prediction while reducing the computational cost it also allows us to better capture the evolving flow features wetting drying fronts keywords anisotropic dynamic mesh optimization double control volume finite element method dcv fem joint flood 1 introduction over the last two decades the risk of urban flooding in heavily populated coastal regions has increased and is expected to increase further mainly due to the urbanization and climate change urban flooding in coastal regions could be caused by a single source heavy rainfall high sea levels or storms or several sources acting in combination dawson et al 2008 due to this increasing high risk the combined effect and the joint probability of multiple extreme floods are gaining importance in flooding simulations lian et al 2013 improving the predictive capabilities in such cases is critical for populated areas especially cities it is therefore important to develop an efficient and accurate numerical model for studying floods caused by several concurrent hazards in coastal cities an overview of flood inundation models has been given by teng et al 2017 in the past various numerical models have been developed to simulate flood inundation chen et al 2012 van dijk et al 2014 hunter et al 2008 soares frazão et al 2008 son et al 2016 these models are classified into three categories 1 empirical methods such as measurements o connor and costa 2004 and remote sensing smith 1997 2 hydrodynamic models and 3 conceptual models for large floodplains teng et al 2015 and probabilistic flood risk assessment apel et al 2004 the hydrodynamic models include one dimensional 1d huber et al 1988 two dimensional 2d dhi 2009 mignot et al 2006 xia et al 2017 and three dimensional 3d models prakash et al 2014 zhang et al 2016 mike flood dhi 2014 has the capability of simulating combined river sewer and floodplain modelling with high resolution and reliability sto domingo et al 2010 recently various efforts to compute overland flows by solving the shallow water equations have been made these studies have simulated overland flows under extreme and unsteady rainfall conditions and spatially constant infiltration rates have been taken into account bellos and tsakiris 2016 nguyen et al 2016 singh et al 2014 however due to the complexity and uncertainty of flood modelling efficient simulation of flooding at high resolution terrain remains a significant challenge in hydrologic and hydraulic studies for efficient and accurate flood inundation modelling numerous methods have been developed such as grid coarsening methods hartnack et al 2009 cellular automata approach dottori and todini 2011 and speeding up strategies such as parallel processing hu and song 2018 sanders et al 2010 zhang et al 2014 nguyen et al 2016 have proposed a coupled model called hiresflood uci which combines the hydrological model hl rdhm and the hydrodynamic brezo model while ensuring a bare minimum computational cost hiresflood uci uses hl rdhm as a rainfall runoff generator and brezo as the hydrological routing scheme this model has been successfully applied to a catchment of the illinois river in usa more recently a new 2d double control volume finite element dcv fem flood model has been developed together with the adaptive unstructured mesh technology and validated by a simple flooding case hu et al 2018 in comparison to adaptive mesh refinement amr a fine structured mesh nested within a coarse mesh technique berger and colella 1989 the dmo technique is able to adapt the mesh optimally in time and space in response to the evolving flow features thus providing sufficient mesh resolution where and when it is required in this work we have further developed this adaptive unstructured mesh shallow water model with anisotropic considerations for modelling urban floods from multiple sources rainfall and storm surge the implicit θ scheme has been adopted for solving the shallow water equations and applications to urban floods caused by multiple sources rains and sea levels in the dcv fem scheme the velocity components are discretised fe wise while the pressure free surface height is discretised cv wise salinas et al 2017 in this paper a dcv fem adaptive mesh urban flooding model based on 2d shallow water equations named as floodity hu et al 2018 has been further developed for modelling the concurrent flooding and has been successfully applied to a 2 2 km 1 7 km densely urbanized area within greve denmark this is the first time to apply the anisotropic dmo method to simulate urban floods caused by multiple sources based on high resolution digital terrain model dtm data model validation has been performed in comparison with results from mike 21 fm sensitivity of the extreme sea levels rainfall and mesh resolution to the flood volume has been explored to assess uncertainties in model predictions the structure of this paper is as follows the governing equations and anisotropic dmo method are introduced in section 2 section 3 demonstrates the application of floodity to simulate flood events within greve denmark it describes the study site and geospatial data used for modelling and specifies boundary conditions and parameter settings section 4 presents and discusses the floodity results by comparing with results from mike 21 fm finally some conclusions are given in section 5 2 methodology in this work we have adopted the element pair p 1dg p 1cv salinas et al 2017 a modification of linear discontinuous velocity and continuous pressure representations for 2d shallow water simulations in dcv fem scheme used here the pressure free surface height is discretized cv wise rather than fe wise in the classic cv fem forsyth et al 1989 geiger et al 2004 gomes et al 2017 jackson et al 2015 matthai et al 2007 the dcv fem provides significant improvements in the quality of the pressure matrix that can be solved efficiently even on highly anisotropic elements we also use flux limiting of the free surface height based on the normalized variable diagram nvd approach of leonard 1988 the discontinuous galerkin dg method is used for the discretization of the momentum equation the dg approach is very powerful as it has a natural dissipation associated with it to robustly stabilize the shallow water momentum equation a non linear petrov galerkin scheme farrell and maddison 2011 is used it is a mathematically consistent residual scheme and converges to the governing equations as the mesh and time step size are refined due to a diffusion term proportional introduced to the residual of the momentum equation it provides the robustness needed when there are sharp changes in velocity usually occurs near wetting and drying fronts a non linear θ method is used for the time discretization in which the value of θ between 0 5 and 1 is adjusted in space and time θ is calculated at each cv face based on the satisfaction of a total variational diminishing tvd criterion pavlidis et al 2016 the non linear iteration is based on the fixed point iteration method described in salinas et al 2017 this is important as wetting and drying due to the non linear drag and inertia is highly non linear 2 1 governing equations 2 1 1 momentum and continuity equations for depth averaged velocity u in non conservative form the momentum equation or shallow water is written as 1 u t u u c f u μ 2 u p s b and the continuity equation is written as 2 h t h u s h where h is the water depth cf is the volumetric drag coefficient μ is the dynamic viscosity p is the depth averaged pressure sb is the source term of velocity unit m s 2 sh is the source term of mass from rainfall for example unit m s 1 and p is calculated 3 p g h d and thus 4 h p g d where g is the gravitational acceleration and d is bathymetry the height deviation from a horizontal and flat plain the pressure and free surface height are defined cv wise contrary to the classical cv fem where they are fe wise 2 1 2 drag coefficient a commonly used bottom stress parameterization is the manning strickler formulation keulegan 1938 rouse 1961 5 n ν u n m 2 g u u h 1 3 on γ b o t t o m in which n is the unit normal to the bottom surface γbottom normal ν is the kinematic viscosity and nm is the manning coefficient the formulation for the volumetric drag coefficient cf is 6 c f n m 2 g u max h h min 1 3 wetting and drying here we use the thin film wetting and drying algorithms which specify a minimum threshold depth that defines the categories of wet or dry in the model importantly we have introduced the flux limiter to ensure the positive water depth and avoid the physical oscillation h min 0 01 mm was finally chosen as considering a layer of water of 0 01 mm in the dry areas is physically plausible while also reducing the non linear behaviour which may be introduced by a smaller value e g 0 001 mm in order to enable the cvs to wet and dry freely we perform an element wise average of the node wise depths of water within each element we then use this average in eq 6 representation of buildings the most common methods for simulating the water flow among structures are 1 blocking out of the solid area 2 local elevation rise of the solid area 3 local increase of roughness of the solid area either via the manning coefficient increase bellos 2012 the method used here is similar to the local elevation rise the elevation and shape of buildings are embedded in the realistic topography data with the use of anisotropic dmo the details of buildings can be captured as the water floods around them 2 1 3 boundary conditions for the joint flooding events the boundary conditions need to be set for the water depth h pressure p or velocity u we can define either pressure or velocity boundary conditions but not both gresho and sani 1998 here we specify the pressure p boundary conditions and then the velocity is calculated from the pressure gradient h boundary conditions for the joint flooding events involved with pluvial and coastal flooding the water depth h boundary conditions along the coastline include 1 time series of extreme water level heights e estimated from storm surge models or the historical data observed 2 bathymetry terrain elevation d along the coastline thus the water depth h is calculated from h e d p boundary conditions once the h boundary conditions are set the pressure p boundary conditions are specified through eq 3 and the velocity is calculated from the pressure gradient gresho and sani 1998 and evolve to point into or out of the domain depending on the dynamics the boundaries except the coastline over the domain can be set up as closed or open based on actual situation rainfall as source term the rainfall needs to be considered as the source term sh in eq 2 generally given a large domain a large catchment where the characteristics of the subcatchments are found to be significantly different from each other the effect of spatial distribution of rainfall is considered this mean that different subcatchments may receive different amounts of rainfall namely different rainfall intensity time series are induced according to the region however since the computation domain in this study is relatively small we assume that the rainfall is uniform across the domain due to the fact that the effect of rainfall is relatively small compared with that of incoming waves infiltration is not considered here an average depth of runoff is then obtained which contributes to the calculation of the water depth h 2 2 anisotropic dynamic mesh optimization technique anisotropic dmo the anisotropic dmo has the advantage of capturing details of surface and local flows wetting drying front during the process of flooding modelling the use of anisotropic dmo can efficiently provide a high mesh resolution where and when it is needed hiester et al 2011 that is finer meshes are placed only in specific regions where the variations of flow variable solutions are relatively large e g flow around buildings and along the flooding paths while coarser meshes are used in areas far from these regions where inundation has not yet occurred for example here the anisotropic dmo technique relies on the derivation of appropriate error measures which dictate how the mesh is to be modified the required error measure is defined in the form of a metric tensor the metric is derived from a solution field variable and an error norm based on the interpolation error pain et al 2001 defined to make sure that a desired element length can be obtained while having a required interpolation error thus the metric m is calculated from 7 m γ ϵ h where γ is a scalar constant and γ 1 is used here ϵ is a required interpolation error and h is the hessian matrix for a specified field ψ ω here the field of water depth 8 h 2 ψ x 2 2 ψ x y 2 ψ y x 2 ψ y 2 the desired edge length hi in the direction of the ith eigenvector ei of the metric m is defined as h i 1 λ i i e anisotropic as well as inhomogeneous resolution results from a mesh that respects the metric m where λi is the eigenvalue associated with ei piggott et al 2009 power et al 2006 it is advantageous to modify the metric to impose the maximum and minimum element sizes on the mesh especially for problems that have known high aspect ratio dynamics or domains to impose these maximum and minimum constraints directionally m is modified and defined as 9 m v t v where v is a rotation matrix that includes the eigenvectors of the metric m calculated from eq 7 and general directions for the maximum and minimum edge length can be introduced through the use of v to bound the aspect ratio of elements in physical space there is a need to limit the ratio of eigenvalues for example to limit the aspect ratio of elements to be below a the eigenvalues are modified as follows pain et al 2001 10 λ j max λ j 1 a 2 max j 1 2 3 λ j j 1 2 3 where 11 λ j min 1 h min 2 max λ j 1 h max 2 j 1 2 3 in which a is the maximum aspect ratio h min and h max are the minimum and maximum element sizes a uniform isotropic element can be transformed to an adapted anisotropic element under the transformation s v 1 in the physical domain achieving the desired interpolation error everywhere the galerkin interpolation technique farrell and maddison 2011 is used for interpolating the solutions from the previous mesh onto the newly adapted mesh the overhead and extra computational cost introduced during the adaptive mesh procedure is very low around 10 of the total cpu time hu et al 2018 3 model application 3 1 descriptions of study site and data to assess the performance of anisotropic dmo in flooding modelling the new flooding model has been applied to an urban area located within a 2 2 km 1 7 km densely urbanized area within greve denmark the study area is located in the northeastern part of greve denmark which covers part of the coastal area see fig 1 a historical extraordinary flood events which were caused by a series of rain events have occurred in greve kommune 2007 in addition to extreme rainfall events greve is also vulnerable to flood induced by extreme sea level events along its coast for example the most extreme historical flood occurred on 13th october 1760 with a maximum water level of 3 7 m was caused by a very serious storm surge madsen 2008 recurrence of any of these flood events would cause numerous damages e g loss of life direct damages to roads railways and buildings indirect damages including loss of income clean up cost turnover loss cost of illnesses etc as a consequence it is important to develop flooding models to improve the accuracy of flood predictions in the greve case study the digital elevation data provided was quality assured and buildings were incorporated into the dtm digital terrain model data with a resolution of 1 6 m fig 1 b which was detailed enough to describe topographic features buildings rivers and streets data of different extreme rainfall events as well as extreme sea level events have been used as the boundary conditions and sources 3 2 extreme sea level and rainfall events due to the impact of climate change in the next 100 years future climate change conditions should be taken into account to estimate the future extreme sea level and rainfall events berbel roman 2014 to forecast storm surges a hydrodynamic model has been calibrated against historical events during 2000 2015 the capability of this built hydrodynamic model to forecast storm surges was evaluated against historical storm event during 2010 2017 an example of a real time forecast issued during the storm gorm on 29th november 2015 can be seen in fig 2 a from fig 2 b it can be seen how the correlation coefficient between observed and forecasted water levels goes down as the lead time increased the 3d hydrodynamic model was built using mike 3 fm a software tool for modelling unsteady three dimensional flows which uses a flexible mesh calculation grid taking into account density variations bathymetry and external forcing such as meteorology tidal elevations currents and other hydrographic conditions dhi 2016 meteorological forcing for the model is obtained from a wrf weather research and forecasting limited area numerical weather prediction model covering northern europe with a resolution of 0 1 degrees which is run by stormgeo in norway more information about the calibration and the model in general are given in dhi 2011 a description of the above method for estimating storm surge event time series for climate change analysis is described in berbel roman 2014 fig 3 b shows the extreme sea water levels which were used as input boundary conditions along the coastline according to berbel roman 2014 to estimate the expected changes in sea surges in future up to year 2100 hydrodynamic simulations were carried out which were driven by the wind and atmospheric pressure results from three regional climate models a general observed extreme event pattern was identified based on the past observed extreme sea level events the future extreme water level event time series fig 3 b were then obtained from the general observed pattern by scaling to a given return period and adding estimates of mean sea level rise and change in storm surge signal the water level calculated with statistics projections of 100 yr return period considering climate change under a present scenario identified as current and a future scenario identified as 2100 mean and 2100 upper depending of the climate factor considered these extreme sea level events current 2100 mean and 2100 upper lasted 24 h as seen in fig 3 b for a return period of 100 years the maximum value for the extreme water levels is 1 52 m current 2 25 m 2100 mean and 3 08 m 2100 upper extreme precipitation data in this case study is obtained by a frequency analysis where the rainfall data over more than 10 years from 83 stations in denmark is used by running a regional statistical extreme model the intensities of rainfall for the 2 yr 10 yr and 100 yr return period have been obtained then multiplied by a factor of 1 1 1 5 due to the impact of climate change in the next 100 years berbel roman 2014 the designed intensities are shown in fig 3 c it is assumed that for a given rainfall event a uniform rainfall is falling over the whole area of the domain 2 2 km 1 7 km 3 3 model applications a series of model simulations using anisotropic dmo have been carried out to assess the performance of the new flooding model developed here the extreme seawater level event fig 3 b which lasts 24 h is used as input boundary condition on the sea boundary fig 1 b the remaining boundaries are set up as closed no flow in these simulations sea water enters the densely urbanized area from the sea boundary fig 1 b and the extreme rainfall events fig 3 c take place simultaneously fig 3 a shows the initial water depth within the domain in a scenario of 2100 upper extreme water level the adapting mesh schemes are listed in table 1 the mesh is adapted to ensure an absolute error in the water depth field of 0 01 m and the aspect ratio is 100 4 results and discussion 4 1 individual flooding events 4 1 1 flooding map fig 4 shows the flood propagation process over the urban area in a scenario of an individual 2100 upper extreme sea level event it can be observed that in most of the inundation area the solutions of water depths obtained from floodity are in good agreement with those from mike 21 fm the mesh is optimally adapted according to the evolving flow features in time and space thus providing sufficient mesh resolution where and when it is required right panel in fig 4 for example the fine mesh is located along the flood propagation path while the coarser mesh is used in the areas where inundation has not occurred yet to further estimate and compare the flood extent the flood volume during the flood propagation process is calculated fig 5 it is clearly that flood volume obtained from floodity is a little higher than that from mike 21 fm during the whole period whilst the general trends of both are consistent 4 1 2 comparison with mike 21 fm results at detector locations to further evaluate the performance of floodity using different mesh resolutions the time series of water depth at detector locations p1 p2 p3 and p4 are plotted in fig 6 in comparison to those from mike 21 fm in fig 6 the blue green and black lines represent the time series of water depth predicted by the new anisotropic unstructured mesh flooding model floodity with a minimum mesh size of 20 m 10 m and 5 m respectively it can be seen that a good agreement is achieved between the results from both the fixed and adaptive mesh simulations except for that with a minimum mesh size of 20 m at detectors p3 and p4 during the flooding propagation period 6 7 24 h however mike 21 fm predicts an earlier flood arrival time at p3 and p4 than that predicted by the floodity simulations the results of water depth at detectors p1 and p2 obtained by both the mike 21 fm and floodity simulations are very close to each other when almost the same mesh resolution 10 m is used over the inundated regions the detectors p1 and p2 are located within a narrow open channel where a high resolution mesh a mesh size smaller than 10 m at least is required to represent it we can see that the floodity simulation with a minimum mesh size of 5 m predicts a deeper water depth at p1 and p2 than that in the simulations with the large mesh size 10 m and 20 m it proves that more detailed solutions can be obtained in the local areas when using an adaptive mesh instead of a fixed mesh we also note that using anisotropic dmo floodity is capable of providing reasonable results even with use of a coarser mesh 20 m for comparison purposes mike 21 fm results from the model updated from berbel roman 2014 are used as a reference solution in this study the original model domain in berbel roman 2014 has a dimension of 2 3 km 7 5 km where the northeastern region is selected as our computational domain fig 3 a berbel roman 2014 divided the domain in 9 sub regions with the element size in range of 10 100 m where large elements were used to represent the surroundings of harbours the coastline and the train tracks were represented with smaller elements thus a flexible mesh with the element size in range of 10 100 m is used in the mike 21 fm simulations while the adaptive meshes with a minimum mesh size of 20 m 10 m and 5 m are used in floodity a comparison of water depth results using the adaptive floodity and fixed mike 21 fm unstructured mesh has been carried out 4 2 joint flooding events the newly developed adaptive mesh flooding model is further used for simulating floods under the combined impacts of the events extreme rainfall and sea level fig 7 shows the results of water depth from mike 21 fm and floodity with a minimum adaptive mesh size of 10 m at time levels t 15 h it presents the flood propagation process over the urban area in scenarios of an individual 2100 upper extreme sea level event and a joint event with 100 yr return period rainfall respectively due to the effect of rainfall the joint event has larger flood areas than the individual event as shown in the areas marked with rectangles in fig 7 figs 8 and 9 show the time series of water depth at four detector locations predicted by these models respectively the total rainfall amount in 24 h is 28 1 mm 45 7 mm and 82 1 mm within the 2 2 km 1 7 km study area for the 2 yr 10 yr 100 yr return period respectively thus in comparison to the extreme sea level the rainfalls have a relatively smaller impact on the inundation extent again it can be observed that under the scenarios of joint flooding events the water depths and velocity obtained from floodity using the minimum mesh size of 10 m are in good agreement with those from mike 21 fm simulations 4 3 impact of buildings on flooding simulations the use of anisotropic dmo in flooding modelling can better capture the evolving flow features and topographic features buildings rivers and streets thus providing improved accurate flooding prediction to further demonstrate the capability of the flooding model floodity has been applied to the joint flooding events with the bathymetric data including buildings which were represented as impervious obstacles blocking the flow path fig 10 presents the flooding map over the urban area at time level t 15 h in scenarios of an individual and joint flooding event respectively it can be observed that floodity results with a mesh resolution 5 m have a larger inundation extent than mike 21 fm results and present more details of topographic features including buildings and channels the details of roads buildings and channels can be observed clearly with an increased mesh resolution around them fig 11 provides the details of the areas marked with rectangles in fig 10 it is noted that the information of roads and channels has been lost in the mike 21 fm simulations however with the use of anisotropic dmo floodity can capture the details of topographic features even with almost the same mesh resolution 10 m as that used in the mike simulation the bottom in fig 11 shows more details of the anisotropic unstructured meshes where the adapted anisotropic elements are placed under the limitation of the aspect ratio of elements in these simulations the topographical data digital elevation data is available with a high resolution of 1 6 m the availability of high resolution topographical data is important for the accurate numerical simulation of urban food inundation however high resolution topographical data requires a high computational effort thus resulting in a computationally demanding flood modelling using anisotropic dmo the topographical data over the domain is obtained by interpolating the high resolution 1 6 m data onto the adapted mesh at each time level therefore the high resolution topographical data is only used in the flooded region while the low resolution data is used in the rest of the domain thus reducing the computational cost in addition the details of buildings can be represented accurately as the flooding water spreads across the domain see figs 10 and 12 fig 13 shows the time series of water depth at four detector locations simulated using mike 21 fm and floodity with three different meshes in a scenario of a joint flooding event from extreme sea level and rainfall for a 100 yr return period it can be observed that due to the impact of buildings the water depths obtained from floodity have a slight difference from that of mike 21 fm a deeper water depth at p1 and p2 locations is predicted when using the 5 m resolution adaptive mesh than that using the fixed mesh mike 21 fm similarly as which is shown in fig 6 this is due to the fact that the detectors p1 and p2 are located at the channel thus having a larger water depth again this proves that the adaptive mesh flooding model can provide relatively accurate predictions also note that there is an arrival time lag at detectors if the impact of buildings is considered in the flooding simulations as a result the arrival time at p3 and p4 has nearly 140 min time lag in floodity with a mesh resolution of 5 m results in comparison to mike 21 fm results 4 4 sensitivity to the forcing inputs and mesh resolution extreme joint flooding is the product of a wide range of interacting processes here the uncertainties from the forcing inputs are the extreme sea levels and rainfall in addition the mesh resolution is one of critical parameters in flooding modelling in this section sensitivity analysis of flood volume over inundated areas to extreme sea levels rainfall and mesh resolution has been explored and shown in fig 3 a b and c respectively the impact of the incoming sea levels on flooding results has been investigated and the corresponding results in fig 14 a there are three scenarios of individual extreme sea level events shown in fig 3 b where the maximum value for the extreme incoming water levels is 1 52 m current 2 25 m 2100 mean and 3 08 m 2100 upper peaking at t 9 5 h in fig 14 a we can see that the flood volume become large with an increased incoming wave level the flood volume peaks approximately at t 9 5 h when the incoming wave is reaching its extreme there is a slight time lag in the peak of flood volumes in the scenario of the current extreme sea level event further investigation of the effect of rainfall on flood volume has been undertaken in the scenario of the joint flood event a comparison of flood volumes between the scenarios of the individual and joint flood events is provided in fig 14 b the solid line is the flood volume during the individual extreme sea level event 2100 upper while the dashed line represents the joint flood event with the 100 yr return period rainfall event during the rainfall period t 13 16 h the influence of rainfall is reflected by the divergence of the flood volume during rainfall the largest difference in flood volume is 1 10 105 m3 at t 14 08 h fig 14 c presents the flood volume results from the simulations using different mesh resolutions it is found that the peak values of flood volume results are very close in all simulations while the peak time differs greatly when using the mesh resolutions of 20 m dotted blue line and 10 m dotted green line as well as 5 m solid black line the reason for this is that the blocking effect of buildings cannot be represented in flood modelling with use of coarse mesh resolutions 20 m here due to the failure of capturing the details of buildings in general the flood volume results are sensitive to both incoming sea levels and rainfall however in joint flood events the effect of rainfall is relatively small in comparison to extreme incoming waves in flooding modelling the mesh resolution is the key to capture the details of complex topography for example buildings and channels one can see the blocking effect of buildings only when the buildings are captured with high mesh resolutions 4 5 performance of floodity modelling as seen in fig 15 and table 2 an unstructured mesh with 20 m resolution generated by gmsh geuzaine and remacle 2009 consists of 13 033 nodes and 25 666 unstructured triangle elements while 10 m resolution consists of 51 367 nodes and 101 939 elements and 5 m resolution mesh contains 204 980 nodes and 408 373 elements these meshes are used during the whole simulation period for fixed unstructured mesh modelling and used as the initial mesh for the adaptive mesh simulations after first adapting the mesh the numbers of nodes and elements used for adaptive mesh of 20 m 10 m and 5 m resolution are reduced by 74 82 and 88 respectively then gradually increased during t 1 600 min and decreased during t 600 1440 min as the flooding water retreats above all floodity is less computationally expensive than fixed unstructured mesh modelling the use of adaptive unstructured meshes improves the computational efficiency to further reduce the computational cost various numerical techniques can be adopted in the flood model floodity for example parallel computing using mpi 5 conclusions realising the importance of flood coincidence risk assessments we have further developed the adaptive unstructured mesh flooding model floodity hu et al 2018 for the joint urban flood events caused by multiple sources extreme rainfall and sea level events and successfully applied to greve in denmark by introducing the anisotropic dmo technique the features of flooding flows local flows around the buildings or the wetting and drying front for example are able to be better captured while reducing computational cost without sacrificing accuracy of flooding simulations with a unique combination of anisotropic dmo and high resolution digital terrain model dtm data the complex urban topography can be accurately represented when where needed by increasing the mesh resolution around the buildings for example dynamically when the flooding water spreads over the urban area this new floodity model has been applied to several flooding scenarios that happened in greve denmark where the flood is induced by different combinations of extreme incoming sea levels and rainfall a comparison between floodity and mike 21 fm results has been undertaken it has been found that floodity is able to provide relatively accurate results while the computational cost is reduced by 20 88 in comparison to fixed mesh models to assess uncertainties in model predictions the sensitivity of flood volumes to extreme sea levels and rainfalls has been explored in joint flood events we found that the flood volume over the inundated area is more sensitive to sea levels than rainfall extreme sea level events with the higher peak water levels induce higher peak flood volume while the impact of rainfall is relatively small the sensitivity of flood results to the mesh resolution is also investigated in flood modelling the blocking effect of buildings on the peak time of flood volumes can be seen only when using high resolution meshes and digital terrain model data flood modelling is a complex and parametric problem the input uncertainty is one of the main sources of uncertainty in this paper we mainly focused on the simulation of flooding from multiple sources we have done some basic sensitivity analysis given its complexity in future we will further carry out uncertainty analysis using advanced numerical techniques for example the adjoint sensitivity and uncertainty analysis cacuci et al 2003 in this work the effect of rainfall is relatively small compared to incoming waves so infiltration is not taken into account here namely all amount of rainfall water becomes ponded water on ground surface we will further introduce infiltration rate in future work due to the lack of optimization of codes the cpu time is not demonstrated here instead we have demonstrated the computational cost is significantly reduced by the decrease of the number of nodes used while the accuracy remains the same or better than that in fixed mesh modelling in future work we will focus on the optimization of codes data structures acknowledgements the authors acknowledge the support of the nsfc grant 11502241 funding from the european union seventh framework programme fp7 20072013 under grant agreement no 603663 for the research project pearl preparing for extreme and rare events in coastal regions the epsrc memphis multi phase flow programme grant ep k003976 1 and epsrc magic ep n010221 1 funding for salinas from epsrc smart geowells grant ep r005761 1 is gratefully acknowledged we would like to thanks dr linmei nie s valuable advice the data used are listed in the references tables and figures we would like to thank the four reviewers for their in depth comments that contributed to improving the presentation of our paper 
717,the coincidence of two or more extreme events precipitation and storm surge for example may lead to severe floods in coastal cities it is important to develop powerful numerical tools for improved flooding predictions especially over a wide range of spatial scales metres to many kilometres and assessment of joint influence of extreme events various numerical models have been developed to perform high resolution flood simulations in urban areas however the use of high resolution meshes across the whole computational domain may lead to a high computational burden more recently an adaptive isotropic unstructured mesh technique has been first introduced to urban flooding simulations and applied to a simple flooding event observed as a result of flow exceeding the capacity of the culvert during the period of prolonged or heavy rainfall over existing adaptive mesh refinement methods amr locally nested static mesh methods this adaptive unstructured mesh technique can dynamically modify both coarsening and refining the mesh and adapt the mesh to achieve a desired precision thus better capturing transient and complex flow dynamics as the flow evolves in this work the above adaptive mesh flooding model based on 2d shallow water equations named as floodity has been further developed by introducing 1 an anisotropic dynamic mesh optimization technique anisotropic dmo 2 multiple flooding sources extreme rainfall and sea level events and 3 a unique combination of anisotropic dmo and high resolution digital terrain model dtm data it has been applied to a densely urbanized area within greve denmark results from mike 21 fm are utilized to validate our model to assess uncertainties in model predictions sensitivity of flooding results to extreme sea levels rainfall and mesh resolution has been undertaken the use of anisotropic dmo enables us to capture high resolution topographic features buildings rivers and streets only where and when is needed thus providing improved accurate flooding prediction while reducing the computational cost it also allows us to better capture the evolving flow features wetting drying fronts keywords anisotropic dynamic mesh optimization double control volume finite element method dcv fem joint flood 1 introduction over the last two decades the risk of urban flooding in heavily populated coastal regions has increased and is expected to increase further mainly due to the urbanization and climate change urban flooding in coastal regions could be caused by a single source heavy rainfall high sea levels or storms or several sources acting in combination dawson et al 2008 due to this increasing high risk the combined effect and the joint probability of multiple extreme floods are gaining importance in flooding simulations lian et al 2013 improving the predictive capabilities in such cases is critical for populated areas especially cities it is therefore important to develop an efficient and accurate numerical model for studying floods caused by several concurrent hazards in coastal cities an overview of flood inundation models has been given by teng et al 2017 in the past various numerical models have been developed to simulate flood inundation chen et al 2012 van dijk et al 2014 hunter et al 2008 soares frazão et al 2008 son et al 2016 these models are classified into three categories 1 empirical methods such as measurements o connor and costa 2004 and remote sensing smith 1997 2 hydrodynamic models and 3 conceptual models for large floodplains teng et al 2015 and probabilistic flood risk assessment apel et al 2004 the hydrodynamic models include one dimensional 1d huber et al 1988 two dimensional 2d dhi 2009 mignot et al 2006 xia et al 2017 and three dimensional 3d models prakash et al 2014 zhang et al 2016 mike flood dhi 2014 has the capability of simulating combined river sewer and floodplain modelling with high resolution and reliability sto domingo et al 2010 recently various efforts to compute overland flows by solving the shallow water equations have been made these studies have simulated overland flows under extreme and unsteady rainfall conditions and spatially constant infiltration rates have been taken into account bellos and tsakiris 2016 nguyen et al 2016 singh et al 2014 however due to the complexity and uncertainty of flood modelling efficient simulation of flooding at high resolution terrain remains a significant challenge in hydrologic and hydraulic studies for efficient and accurate flood inundation modelling numerous methods have been developed such as grid coarsening methods hartnack et al 2009 cellular automata approach dottori and todini 2011 and speeding up strategies such as parallel processing hu and song 2018 sanders et al 2010 zhang et al 2014 nguyen et al 2016 have proposed a coupled model called hiresflood uci which combines the hydrological model hl rdhm and the hydrodynamic brezo model while ensuring a bare minimum computational cost hiresflood uci uses hl rdhm as a rainfall runoff generator and brezo as the hydrological routing scheme this model has been successfully applied to a catchment of the illinois river in usa more recently a new 2d double control volume finite element dcv fem flood model has been developed together with the adaptive unstructured mesh technology and validated by a simple flooding case hu et al 2018 in comparison to adaptive mesh refinement amr a fine structured mesh nested within a coarse mesh technique berger and colella 1989 the dmo technique is able to adapt the mesh optimally in time and space in response to the evolving flow features thus providing sufficient mesh resolution where and when it is required in this work we have further developed this adaptive unstructured mesh shallow water model with anisotropic considerations for modelling urban floods from multiple sources rainfall and storm surge the implicit θ scheme has been adopted for solving the shallow water equations and applications to urban floods caused by multiple sources rains and sea levels in the dcv fem scheme the velocity components are discretised fe wise while the pressure free surface height is discretised cv wise salinas et al 2017 in this paper a dcv fem adaptive mesh urban flooding model based on 2d shallow water equations named as floodity hu et al 2018 has been further developed for modelling the concurrent flooding and has been successfully applied to a 2 2 km 1 7 km densely urbanized area within greve denmark this is the first time to apply the anisotropic dmo method to simulate urban floods caused by multiple sources based on high resolution digital terrain model dtm data model validation has been performed in comparison with results from mike 21 fm sensitivity of the extreme sea levels rainfall and mesh resolution to the flood volume has been explored to assess uncertainties in model predictions the structure of this paper is as follows the governing equations and anisotropic dmo method are introduced in section 2 section 3 demonstrates the application of floodity to simulate flood events within greve denmark it describes the study site and geospatial data used for modelling and specifies boundary conditions and parameter settings section 4 presents and discusses the floodity results by comparing with results from mike 21 fm finally some conclusions are given in section 5 2 methodology in this work we have adopted the element pair p 1dg p 1cv salinas et al 2017 a modification of linear discontinuous velocity and continuous pressure representations for 2d shallow water simulations in dcv fem scheme used here the pressure free surface height is discretized cv wise rather than fe wise in the classic cv fem forsyth et al 1989 geiger et al 2004 gomes et al 2017 jackson et al 2015 matthai et al 2007 the dcv fem provides significant improvements in the quality of the pressure matrix that can be solved efficiently even on highly anisotropic elements we also use flux limiting of the free surface height based on the normalized variable diagram nvd approach of leonard 1988 the discontinuous galerkin dg method is used for the discretization of the momentum equation the dg approach is very powerful as it has a natural dissipation associated with it to robustly stabilize the shallow water momentum equation a non linear petrov galerkin scheme farrell and maddison 2011 is used it is a mathematically consistent residual scheme and converges to the governing equations as the mesh and time step size are refined due to a diffusion term proportional introduced to the residual of the momentum equation it provides the robustness needed when there are sharp changes in velocity usually occurs near wetting and drying fronts a non linear θ method is used for the time discretization in which the value of θ between 0 5 and 1 is adjusted in space and time θ is calculated at each cv face based on the satisfaction of a total variational diminishing tvd criterion pavlidis et al 2016 the non linear iteration is based on the fixed point iteration method described in salinas et al 2017 this is important as wetting and drying due to the non linear drag and inertia is highly non linear 2 1 governing equations 2 1 1 momentum and continuity equations for depth averaged velocity u in non conservative form the momentum equation or shallow water is written as 1 u t u u c f u μ 2 u p s b and the continuity equation is written as 2 h t h u s h where h is the water depth cf is the volumetric drag coefficient μ is the dynamic viscosity p is the depth averaged pressure sb is the source term of velocity unit m s 2 sh is the source term of mass from rainfall for example unit m s 1 and p is calculated 3 p g h d and thus 4 h p g d where g is the gravitational acceleration and d is bathymetry the height deviation from a horizontal and flat plain the pressure and free surface height are defined cv wise contrary to the classical cv fem where they are fe wise 2 1 2 drag coefficient a commonly used bottom stress parameterization is the manning strickler formulation keulegan 1938 rouse 1961 5 n ν u n m 2 g u u h 1 3 on γ b o t t o m in which n is the unit normal to the bottom surface γbottom normal ν is the kinematic viscosity and nm is the manning coefficient the formulation for the volumetric drag coefficient cf is 6 c f n m 2 g u max h h min 1 3 wetting and drying here we use the thin film wetting and drying algorithms which specify a minimum threshold depth that defines the categories of wet or dry in the model importantly we have introduced the flux limiter to ensure the positive water depth and avoid the physical oscillation h min 0 01 mm was finally chosen as considering a layer of water of 0 01 mm in the dry areas is physically plausible while also reducing the non linear behaviour which may be introduced by a smaller value e g 0 001 mm in order to enable the cvs to wet and dry freely we perform an element wise average of the node wise depths of water within each element we then use this average in eq 6 representation of buildings the most common methods for simulating the water flow among structures are 1 blocking out of the solid area 2 local elevation rise of the solid area 3 local increase of roughness of the solid area either via the manning coefficient increase bellos 2012 the method used here is similar to the local elevation rise the elevation and shape of buildings are embedded in the realistic topography data with the use of anisotropic dmo the details of buildings can be captured as the water floods around them 2 1 3 boundary conditions for the joint flooding events the boundary conditions need to be set for the water depth h pressure p or velocity u we can define either pressure or velocity boundary conditions but not both gresho and sani 1998 here we specify the pressure p boundary conditions and then the velocity is calculated from the pressure gradient h boundary conditions for the joint flooding events involved with pluvial and coastal flooding the water depth h boundary conditions along the coastline include 1 time series of extreme water level heights e estimated from storm surge models or the historical data observed 2 bathymetry terrain elevation d along the coastline thus the water depth h is calculated from h e d p boundary conditions once the h boundary conditions are set the pressure p boundary conditions are specified through eq 3 and the velocity is calculated from the pressure gradient gresho and sani 1998 and evolve to point into or out of the domain depending on the dynamics the boundaries except the coastline over the domain can be set up as closed or open based on actual situation rainfall as source term the rainfall needs to be considered as the source term sh in eq 2 generally given a large domain a large catchment where the characteristics of the subcatchments are found to be significantly different from each other the effect of spatial distribution of rainfall is considered this mean that different subcatchments may receive different amounts of rainfall namely different rainfall intensity time series are induced according to the region however since the computation domain in this study is relatively small we assume that the rainfall is uniform across the domain due to the fact that the effect of rainfall is relatively small compared with that of incoming waves infiltration is not considered here an average depth of runoff is then obtained which contributes to the calculation of the water depth h 2 2 anisotropic dynamic mesh optimization technique anisotropic dmo the anisotropic dmo has the advantage of capturing details of surface and local flows wetting drying front during the process of flooding modelling the use of anisotropic dmo can efficiently provide a high mesh resolution where and when it is needed hiester et al 2011 that is finer meshes are placed only in specific regions where the variations of flow variable solutions are relatively large e g flow around buildings and along the flooding paths while coarser meshes are used in areas far from these regions where inundation has not yet occurred for example here the anisotropic dmo technique relies on the derivation of appropriate error measures which dictate how the mesh is to be modified the required error measure is defined in the form of a metric tensor the metric is derived from a solution field variable and an error norm based on the interpolation error pain et al 2001 defined to make sure that a desired element length can be obtained while having a required interpolation error thus the metric m is calculated from 7 m γ ϵ h where γ is a scalar constant and γ 1 is used here ϵ is a required interpolation error and h is the hessian matrix for a specified field ψ ω here the field of water depth 8 h 2 ψ x 2 2 ψ x y 2 ψ y x 2 ψ y 2 the desired edge length hi in the direction of the ith eigenvector ei of the metric m is defined as h i 1 λ i i e anisotropic as well as inhomogeneous resolution results from a mesh that respects the metric m where λi is the eigenvalue associated with ei piggott et al 2009 power et al 2006 it is advantageous to modify the metric to impose the maximum and minimum element sizes on the mesh especially for problems that have known high aspect ratio dynamics or domains to impose these maximum and minimum constraints directionally m is modified and defined as 9 m v t v where v is a rotation matrix that includes the eigenvectors of the metric m calculated from eq 7 and general directions for the maximum and minimum edge length can be introduced through the use of v to bound the aspect ratio of elements in physical space there is a need to limit the ratio of eigenvalues for example to limit the aspect ratio of elements to be below a the eigenvalues are modified as follows pain et al 2001 10 λ j max λ j 1 a 2 max j 1 2 3 λ j j 1 2 3 where 11 λ j min 1 h min 2 max λ j 1 h max 2 j 1 2 3 in which a is the maximum aspect ratio h min and h max are the minimum and maximum element sizes a uniform isotropic element can be transformed to an adapted anisotropic element under the transformation s v 1 in the physical domain achieving the desired interpolation error everywhere the galerkin interpolation technique farrell and maddison 2011 is used for interpolating the solutions from the previous mesh onto the newly adapted mesh the overhead and extra computational cost introduced during the adaptive mesh procedure is very low around 10 of the total cpu time hu et al 2018 3 model application 3 1 descriptions of study site and data to assess the performance of anisotropic dmo in flooding modelling the new flooding model has been applied to an urban area located within a 2 2 km 1 7 km densely urbanized area within greve denmark the study area is located in the northeastern part of greve denmark which covers part of the coastal area see fig 1 a historical extraordinary flood events which were caused by a series of rain events have occurred in greve kommune 2007 in addition to extreme rainfall events greve is also vulnerable to flood induced by extreme sea level events along its coast for example the most extreme historical flood occurred on 13th october 1760 with a maximum water level of 3 7 m was caused by a very serious storm surge madsen 2008 recurrence of any of these flood events would cause numerous damages e g loss of life direct damages to roads railways and buildings indirect damages including loss of income clean up cost turnover loss cost of illnesses etc as a consequence it is important to develop flooding models to improve the accuracy of flood predictions in the greve case study the digital elevation data provided was quality assured and buildings were incorporated into the dtm digital terrain model data with a resolution of 1 6 m fig 1 b which was detailed enough to describe topographic features buildings rivers and streets data of different extreme rainfall events as well as extreme sea level events have been used as the boundary conditions and sources 3 2 extreme sea level and rainfall events due to the impact of climate change in the next 100 years future climate change conditions should be taken into account to estimate the future extreme sea level and rainfall events berbel roman 2014 to forecast storm surges a hydrodynamic model has been calibrated against historical events during 2000 2015 the capability of this built hydrodynamic model to forecast storm surges was evaluated against historical storm event during 2010 2017 an example of a real time forecast issued during the storm gorm on 29th november 2015 can be seen in fig 2 a from fig 2 b it can be seen how the correlation coefficient between observed and forecasted water levels goes down as the lead time increased the 3d hydrodynamic model was built using mike 3 fm a software tool for modelling unsteady three dimensional flows which uses a flexible mesh calculation grid taking into account density variations bathymetry and external forcing such as meteorology tidal elevations currents and other hydrographic conditions dhi 2016 meteorological forcing for the model is obtained from a wrf weather research and forecasting limited area numerical weather prediction model covering northern europe with a resolution of 0 1 degrees which is run by stormgeo in norway more information about the calibration and the model in general are given in dhi 2011 a description of the above method for estimating storm surge event time series for climate change analysis is described in berbel roman 2014 fig 3 b shows the extreme sea water levels which were used as input boundary conditions along the coastline according to berbel roman 2014 to estimate the expected changes in sea surges in future up to year 2100 hydrodynamic simulations were carried out which were driven by the wind and atmospheric pressure results from three regional climate models a general observed extreme event pattern was identified based on the past observed extreme sea level events the future extreme water level event time series fig 3 b were then obtained from the general observed pattern by scaling to a given return period and adding estimates of mean sea level rise and change in storm surge signal the water level calculated with statistics projections of 100 yr return period considering climate change under a present scenario identified as current and a future scenario identified as 2100 mean and 2100 upper depending of the climate factor considered these extreme sea level events current 2100 mean and 2100 upper lasted 24 h as seen in fig 3 b for a return period of 100 years the maximum value for the extreme water levels is 1 52 m current 2 25 m 2100 mean and 3 08 m 2100 upper extreme precipitation data in this case study is obtained by a frequency analysis where the rainfall data over more than 10 years from 83 stations in denmark is used by running a regional statistical extreme model the intensities of rainfall for the 2 yr 10 yr and 100 yr return period have been obtained then multiplied by a factor of 1 1 1 5 due to the impact of climate change in the next 100 years berbel roman 2014 the designed intensities are shown in fig 3 c it is assumed that for a given rainfall event a uniform rainfall is falling over the whole area of the domain 2 2 km 1 7 km 3 3 model applications a series of model simulations using anisotropic dmo have been carried out to assess the performance of the new flooding model developed here the extreme seawater level event fig 3 b which lasts 24 h is used as input boundary condition on the sea boundary fig 1 b the remaining boundaries are set up as closed no flow in these simulations sea water enters the densely urbanized area from the sea boundary fig 1 b and the extreme rainfall events fig 3 c take place simultaneously fig 3 a shows the initial water depth within the domain in a scenario of 2100 upper extreme water level the adapting mesh schemes are listed in table 1 the mesh is adapted to ensure an absolute error in the water depth field of 0 01 m and the aspect ratio is 100 4 results and discussion 4 1 individual flooding events 4 1 1 flooding map fig 4 shows the flood propagation process over the urban area in a scenario of an individual 2100 upper extreme sea level event it can be observed that in most of the inundation area the solutions of water depths obtained from floodity are in good agreement with those from mike 21 fm the mesh is optimally adapted according to the evolving flow features in time and space thus providing sufficient mesh resolution where and when it is required right panel in fig 4 for example the fine mesh is located along the flood propagation path while the coarser mesh is used in the areas where inundation has not occurred yet to further estimate and compare the flood extent the flood volume during the flood propagation process is calculated fig 5 it is clearly that flood volume obtained from floodity is a little higher than that from mike 21 fm during the whole period whilst the general trends of both are consistent 4 1 2 comparison with mike 21 fm results at detector locations to further evaluate the performance of floodity using different mesh resolutions the time series of water depth at detector locations p1 p2 p3 and p4 are plotted in fig 6 in comparison to those from mike 21 fm in fig 6 the blue green and black lines represent the time series of water depth predicted by the new anisotropic unstructured mesh flooding model floodity with a minimum mesh size of 20 m 10 m and 5 m respectively it can be seen that a good agreement is achieved between the results from both the fixed and adaptive mesh simulations except for that with a minimum mesh size of 20 m at detectors p3 and p4 during the flooding propagation period 6 7 24 h however mike 21 fm predicts an earlier flood arrival time at p3 and p4 than that predicted by the floodity simulations the results of water depth at detectors p1 and p2 obtained by both the mike 21 fm and floodity simulations are very close to each other when almost the same mesh resolution 10 m is used over the inundated regions the detectors p1 and p2 are located within a narrow open channel where a high resolution mesh a mesh size smaller than 10 m at least is required to represent it we can see that the floodity simulation with a minimum mesh size of 5 m predicts a deeper water depth at p1 and p2 than that in the simulations with the large mesh size 10 m and 20 m it proves that more detailed solutions can be obtained in the local areas when using an adaptive mesh instead of a fixed mesh we also note that using anisotropic dmo floodity is capable of providing reasonable results even with use of a coarser mesh 20 m for comparison purposes mike 21 fm results from the model updated from berbel roman 2014 are used as a reference solution in this study the original model domain in berbel roman 2014 has a dimension of 2 3 km 7 5 km where the northeastern region is selected as our computational domain fig 3 a berbel roman 2014 divided the domain in 9 sub regions with the element size in range of 10 100 m where large elements were used to represent the surroundings of harbours the coastline and the train tracks were represented with smaller elements thus a flexible mesh with the element size in range of 10 100 m is used in the mike 21 fm simulations while the adaptive meshes with a minimum mesh size of 20 m 10 m and 5 m are used in floodity a comparison of water depth results using the adaptive floodity and fixed mike 21 fm unstructured mesh has been carried out 4 2 joint flooding events the newly developed adaptive mesh flooding model is further used for simulating floods under the combined impacts of the events extreme rainfall and sea level fig 7 shows the results of water depth from mike 21 fm and floodity with a minimum adaptive mesh size of 10 m at time levels t 15 h it presents the flood propagation process over the urban area in scenarios of an individual 2100 upper extreme sea level event and a joint event with 100 yr return period rainfall respectively due to the effect of rainfall the joint event has larger flood areas than the individual event as shown in the areas marked with rectangles in fig 7 figs 8 and 9 show the time series of water depth at four detector locations predicted by these models respectively the total rainfall amount in 24 h is 28 1 mm 45 7 mm and 82 1 mm within the 2 2 km 1 7 km study area for the 2 yr 10 yr 100 yr return period respectively thus in comparison to the extreme sea level the rainfalls have a relatively smaller impact on the inundation extent again it can be observed that under the scenarios of joint flooding events the water depths and velocity obtained from floodity using the minimum mesh size of 10 m are in good agreement with those from mike 21 fm simulations 4 3 impact of buildings on flooding simulations the use of anisotropic dmo in flooding modelling can better capture the evolving flow features and topographic features buildings rivers and streets thus providing improved accurate flooding prediction to further demonstrate the capability of the flooding model floodity has been applied to the joint flooding events with the bathymetric data including buildings which were represented as impervious obstacles blocking the flow path fig 10 presents the flooding map over the urban area at time level t 15 h in scenarios of an individual and joint flooding event respectively it can be observed that floodity results with a mesh resolution 5 m have a larger inundation extent than mike 21 fm results and present more details of topographic features including buildings and channels the details of roads buildings and channels can be observed clearly with an increased mesh resolution around them fig 11 provides the details of the areas marked with rectangles in fig 10 it is noted that the information of roads and channels has been lost in the mike 21 fm simulations however with the use of anisotropic dmo floodity can capture the details of topographic features even with almost the same mesh resolution 10 m as that used in the mike simulation the bottom in fig 11 shows more details of the anisotropic unstructured meshes where the adapted anisotropic elements are placed under the limitation of the aspect ratio of elements in these simulations the topographical data digital elevation data is available with a high resolution of 1 6 m the availability of high resolution topographical data is important for the accurate numerical simulation of urban food inundation however high resolution topographical data requires a high computational effort thus resulting in a computationally demanding flood modelling using anisotropic dmo the topographical data over the domain is obtained by interpolating the high resolution 1 6 m data onto the adapted mesh at each time level therefore the high resolution topographical data is only used in the flooded region while the low resolution data is used in the rest of the domain thus reducing the computational cost in addition the details of buildings can be represented accurately as the flooding water spreads across the domain see figs 10 and 12 fig 13 shows the time series of water depth at four detector locations simulated using mike 21 fm and floodity with three different meshes in a scenario of a joint flooding event from extreme sea level and rainfall for a 100 yr return period it can be observed that due to the impact of buildings the water depths obtained from floodity have a slight difference from that of mike 21 fm a deeper water depth at p1 and p2 locations is predicted when using the 5 m resolution adaptive mesh than that using the fixed mesh mike 21 fm similarly as which is shown in fig 6 this is due to the fact that the detectors p1 and p2 are located at the channel thus having a larger water depth again this proves that the adaptive mesh flooding model can provide relatively accurate predictions also note that there is an arrival time lag at detectors if the impact of buildings is considered in the flooding simulations as a result the arrival time at p3 and p4 has nearly 140 min time lag in floodity with a mesh resolution of 5 m results in comparison to mike 21 fm results 4 4 sensitivity to the forcing inputs and mesh resolution extreme joint flooding is the product of a wide range of interacting processes here the uncertainties from the forcing inputs are the extreme sea levels and rainfall in addition the mesh resolution is one of critical parameters in flooding modelling in this section sensitivity analysis of flood volume over inundated areas to extreme sea levels rainfall and mesh resolution has been explored and shown in fig 3 a b and c respectively the impact of the incoming sea levels on flooding results has been investigated and the corresponding results in fig 14 a there are three scenarios of individual extreme sea level events shown in fig 3 b where the maximum value for the extreme incoming water levels is 1 52 m current 2 25 m 2100 mean and 3 08 m 2100 upper peaking at t 9 5 h in fig 14 a we can see that the flood volume become large with an increased incoming wave level the flood volume peaks approximately at t 9 5 h when the incoming wave is reaching its extreme there is a slight time lag in the peak of flood volumes in the scenario of the current extreme sea level event further investigation of the effect of rainfall on flood volume has been undertaken in the scenario of the joint flood event a comparison of flood volumes between the scenarios of the individual and joint flood events is provided in fig 14 b the solid line is the flood volume during the individual extreme sea level event 2100 upper while the dashed line represents the joint flood event with the 100 yr return period rainfall event during the rainfall period t 13 16 h the influence of rainfall is reflected by the divergence of the flood volume during rainfall the largest difference in flood volume is 1 10 105 m3 at t 14 08 h fig 14 c presents the flood volume results from the simulations using different mesh resolutions it is found that the peak values of flood volume results are very close in all simulations while the peak time differs greatly when using the mesh resolutions of 20 m dotted blue line and 10 m dotted green line as well as 5 m solid black line the reason for this is that the blocking effect of buildings cannot be represented in flood modelling with use of coarse mesh resolutions 20 m here due to the failure of capturing the details of buildings in general the flood volume results are sensitive to both incoming sea levels and rainfall however in joint flood events the effect of rainfall is relatively small in comparison to extreme incoming waves in flooding modelling the mesh resolution is the key to capture the details of complex topography for example buildings and channels one can see the blocking effect of buildings only when the buildings are captured with high mesh resolutions 4 5 performance of floodity modelling as seen in fig 15 and table 2 an unstructured mesh with 20 m resolution generated by gmsh geuzaine and remacle 2009 consists of 13 033 nodes and 25 666 unstructured triangle elements while 10 m resolution consists of 51 367 nodes and 101 939 elements and 5 m resolution mesh contains 204 980 nodes and 408 373 elements these meshes are used during the whole simulation period for fixed unstructured mesh modelling and used as the initial mesh for the adaptive mesh simulations after first adapting the mesh the numbers of nodes and elements used for adaptive mesh of 20 m 10 m and 5 m resolution are reduced by 74 82 and 88 respectively then gradually increased during t 1 600 min and decreased during t 600 1440 min as the flooding water retreats above all floodity is less computationally expensive than fixed unstructured mesh modelling the use of adaptive unstructured meshes improves the computational efficiency to further reduce the computational cost various numerical techniques can be adopted in the flood model floodity for example parallel computing using mpi 5 conclusions realising the importance of flood coincidence risk assessments we have further developed the adaptive unstructured mesh flooding model floodity hu et al 2018 for the joint urban flood events caused by multiple sources extreme rainfall and sea level events and successfully applied to greve in denmark by introducing the anisotropic dmo technique the features of flooding flows local flows around the buildings or the wetting and drying front for example are able to be better captured while reducing computational cost without sacrificing accuracy of flooding simulations with a unique combination of anisotropic dmo and high resolution digital terrain model dtm data the complex urban topography can be accurately represented when where needed by increasing the mesh resolution around the buildings for example dynamically when the flooding water spreads over the urban area this new floodity model has been applied to several flooding scenarios that happened in greve denmark where the flood is induced by different combinations of extreme incoming sea levels and rainfall a comparison between floodity and mike 21 fm results has been undertaken it has been found that floodity is able to provide relatively accurate results while the computational cost is reduced by 20 88 in comparison to fixed mesh models to assess uncertainties in model predictions the sensitivity of flood volumes to extreme sea levels and rainfalls has been explored in joint flood events we found that the flood volume over the inundated area is more sensitive to sea levels than rainfall extreme sea level events with the higher peak water levels induce higher peak flood volume while the impact of rainfall is relatively small the sensitivity of flood results to the mesh resolution is also investigated in flood modelling the blocking effect of buildings on the peak time of flood volumes can be seen only when using high resolution meshes and digital terrain model data flood modelling is a complex and parametric problem the input uncertainty is one of the main sources of uncertainty in this paper we mainly focused on the simulation of flooding from multiple sources we have done some basic sensitivity analysis given its complexity in future we will further carry out uncertainty analysis using advanced numerical techniques for example the adjoint sensitivity and uncertainty analysis cacuci et al 2003 in this work the effect of rainfall is relatively small compared to incoming waves so infiltration is not taken into account here namely all amount of rainfall water becomes ponded water on ground surface we will further introduce infiltration rate in future work due to the lack of optimization of codes the cpu time is not demonstrated here instead we have demonstrated the computational cost is significantly reduced by the decrease of the number of nodes used while the accuracy remains the same or better than that in fixed mesh modelling in future work we will focus on the optimization of codes data structures acknowledgements the authors acknowledge the support of the nsfc grant 11502241 funding from the european union seventh framework programme fp7 20072013 under grant agreement no 603663 for the research project pearl preparing for extreme and rare events in coastal regions the epsrc memphis multi phase flow programme grant ep k003976 1 and epsrc magic ep n010221 1 funding for salinas from epsrc smart geowells grant ep r005761 1 is gratefully acknowledged we would like to thanks dr linmei nie s valuable advice the data used are listed in the references tables and figures we would like to thank the four reviewers for their in depth comments that contributed to improving the presentation of our paper 
718,we consider a one dimensional unconfined groundwater flow equation for the horizontal propagation of water this equation was derived by using a particular form of the forchheimer equation in place of darcy s law such equations can model turbulent flows in coarse and fractured porous media for power law head exponential head power law flux and exponential flux boundary conditions at the inlet the problems can be reduced using similarity transformations to boundary value problems for a nonlinear ordinary differential equation we construct quadratic and cubic approximate solutions of these problems we also numerically compute solutions using a new modification of a method of shampine which exploits scaling properties of the governing equation the polynomial approximate solutions replicate well the numerical solutions and they are easy to use last we compare the predicted wetting front positions from our quadratic and cubic polynomials to predictions based on adomian polynomials of the same degrees the work demonstrates the value of polynomial approximate solutions for validating numerical solutions and for obtaining good approximations for water profiles and the extent of water propagation this work also presents a new application of shampine s method for this type of groundwater flow equation we note that this paper introduces additional classes of approximate solutions for the forchheimer equation up to this date not many solutions are known especially for the transient cases considered here keywords forchheimer equation polynomial approximate solution nonlinear flow equation shampine s method unconfined flow adomian method 1 introduction unconfined groundwater flows are often modeled using the boussinesq equation the derivation of which relies on vertical averaging and an assumption of darcian flow when flows are non darcian other groundwater flow equations can be derived generalizations of darcy s law such as the forchheimer and izbash equations can be used to derive governing equations for non darcy flows moutsopoulos 2009 in this work we focus on one dimensional horizontal water propagation non darcy flows have been studied in a variety of contexts bordier and zimmer 2000 note that the forchheimer and izbash equations can be used to model flows in coarse gravel and geosynthetic media chin et al 2009 found that flows through karstic limestone samples can be described by the forchheimer equation xia et al 2017 experimentally investigated flow characteristics in artificially constructed rock joints and found that the forchheimer and izbash equations both accurately describe fluid flows in a single joint ghane et al 2014 observed that the forchheimer equation describes flows through a woodchip denitrification bed while other researchers have used the forchheimer equation to model flows to wells see e g mathias and moutsopoulos 2016 wen et al 2011 the two term forchheimer equation hassanizadeh and gray 1987 is a generalization of darcy s law for flows that satisfy 1 h x a q b q q where h is the groundwater head and q is the bulk velocity the forchheimer coefficient a is the reciprocal of the hydraulic conductivity which depends on properties of the fluid and porous medium while b depends only on properties of the porous medium chin et al 2009 a detailed discussion of the physical meaning of the coefficients is given by venkataraman and rao 1998 we note that when inertial effects represented by the quadratic term of 1 are negligible b 0 and darcy s law is recovered xia et al 2017 for fully turbulent flows the viscous effects represented by the linear term of 1 are dominated by the inertial effects and the linear term is negligible xia et al 2017 in the current work we use forchheimer equation in a simplified form where the linear term on the right side of 1 is neglected researchers have studied the conditions for which non darcy flows occur for example xiong et al 2017 note that non darcy flows can occur at small and large flow rates while mathias et al 2008 classified these flows as pre linear and post linear some investigators classify non darcian flows by reynolds number see irmay 1958 and burcharth and andersen 1995 for the discussion of these classifications barenblatt et al 1990 caution that non darcy flows can occur at low pre turbulence reynolds numbers due the tortuous flow paths taken by fluids in porous media zeng and grigg 2006 argue for using a forchheimer number instead of the reynolds number to identify non darcy flows and hassanizadeh and gray 1987 summarize various potential causes of nonlinear effects on flows these nonlinear effects can be attributed to turbulence microscopic inertial forces and microscopic drag forces that occur at high flow velocities to name a few of the causes numerical methods are traditionally used to approximate solutions to nonlinear flow problems since in general exact solutions cannot be constructed at the same time to justify the validity of numerical codes and to interpret experimental results approximate analytic solutions are required these and other uses of analytical solutions are discussed by hayek 2016 approximate analytic methods such as the adomian see e g adomian 1994 serrano 1997 and homotopy perturbation see e g munusamy and dhar 2016 are among the methods used to generate solutions to groundwater flow problems the polynomial approximate solutions constructed in the current work are based on the method introduced in lockington et al 2000 for the boussinesq equation the method was further extended in telyakovskiy and allen 2006 to more classes of boundary conditions and in olsen and telyakovskiy 2013 it was applied to a generalized boussinesq equation turbulent flow in porous media is often modeled by using the forchheimer equation in place of darcy s law at present there is a limited number of analytical solutions to the forchheimer equation for flows in unconfined aquifers for example solutions for steady state flows are considered in eck et al 2012 and sedghi asl et al 2014 both of these papers deal with the realistic case of inclined aquifers and deposits sedghi asl et al 2014 provide a family of analytical solutions that can be applied to inclined aquifers the slopes of which vary from zero to high values sedghi asl et al 2014 also presented an experimental study that illustrated the presence of fully developed turbulent flow in an inclined rock drain meanwhile eck et al 2012 derived an analytical solution for a sloped porous pavement that is being recharged by constant rainfall other work has been done on the construction of approximate analytical solutions for the transient forchheimer equation analytical solutions based on adomian polynomials were constructed by moutsopoulos 2007 in that paper it was assumed that the inertial term dominates the viscous term in the quadratic forchheimer equation the considered problems differ from those presented in this paper since the aquifer was initially non empty while at the inlet there was a sudden change in groundwater head extensive experimental results showing the presence of non darcian flows in coarse porous media are presented in bordier and zimmer 2000 they fit the forchheimer and izbash equations to observed data both equations led to similar results but the forchheimer equation has a firmer theoretical foundation compared to the izbash equation moreover these authors provided a theoretical analysis on which a more recent paper of mathias and moutsopoulos 2016 is based mathias and moutsopoulos 2016 constructed a collection of approximate analytical solutions for the radially symmetric forchheimer equation their approximate solutions compare favorably with the numerical results presented in that paper moutsopoulos 2009 analyzed the resulting nonlinear governing equation in the case of one dimensional unconfined turbulent flow under the dupuit forchheimer assumption for a special form of the forchheimer equation that includes only the inertial term in appendix a moutsopoulos 2009 presented conditions under which such flows can occur in fractures and porous media for fully turbulent flow to develop the hydraulic gradient should be sufficiently high at the same time a high value of the hydraulic gradient will lead to a steep slope of the phreatic surface and the dupuit assumption of strictly horizontal flow may not hold the theoretical observations of moutsopoulos 2009 back the experimental results of qian et al 2005 for flows in fractures sedghi asl et al 2014 provided experimental confirmation of the analysis of moutsopoulos 2009 for fully turbulent steady state flow in porous media conditions for the existence of such flows are presented in appendix a of moutsopoulos 2009 in this paper we consider one dimensional flows of this type moutsopoulos analyzed the problem of recharge into an initially dry aquifer for two types of boundary conditions specified at the inlet a power law time condition on head and a constant flux condition using a similarity transformation the problem was reduced to a free boundary value problem for a nonlinear ordinary differential equation that was approximately solved using adomian polynomials for certain recharge regimes the problem has exact solutions which the adomian procedure reproduced for other regimes moutsopoulos used a shooting type of procedure based on the runge kutta method to find the numerical solutions of the governing equation and compared them with the adomian polynomial solutions in the current work we consider the problem described in moutsopoulos 2009 but we use different methods and extend his work to include other types of boundary conditions in addition to a power law head condition at the inlet we consider exponential head power law flux and exponential flux conditions the exponential boundary conditions are shown to be the limiting cases of the corresponding power law conditions with the introduction of dimensionless variables we transform all of these problems into boundary value problems involving the same ordinary differential equation next we construct quadratic and cubic approximate solutions to these problems that are compared to numerical solutions obtained using a newly introduced modification of a method by shampine 1973 earlier in this introduction in addition to motivating the use of the forchheimer equation we mentioned a number of approximate analytical solutions for the forchheimer equation some were for the steady state case and some were for the transient case all together there are not many solutions to the forchheimer equation unlike for the boussinesq and generalized boussinesq equations the boussinesq and generalized boussinesq equations have been extensively studied since they describe many types of common flows in unconfined aquifers with the solutions presented in the later sections of this paper we provide one more approximate analytical approach to the analysis of transient forchheimer flows in the sections below we present the four flow problems one for each of the boundary conditions introduce dimensionless variables and convert the problems into boundary value problems involving the ordinary differential equation after this using the boundary conditions and properties of the ordinary differential equation we describe conditions that the actual solutions satisfy these conditions are used to determine the coefficients of the polynomial approximate solutions and the unknown wetting front position or penetration length the polynomials are determined exclusively by the stated conditions one set of conditions is used for the head boundary conditions at the inlet while a different set is used for the flux boundary conditions finally we describe our modification of shampine s method numerically compute solutions of the dimensionless equations and then compare these solutions to the polynomial approximate solutions 2 problem formulation we consider unconfined flow in an initially dry aquifer with a horizontal impermeable lower boundary as shown in fig 1 for each of four boundary conditions at the inlet we present the initial and boundary conditions the dimensionless variables and the reduced dimensionless form of each problem see moutsopoulos 2009 for the derivation of the governing equation the formulation of the power law head problem and the exact solutions to this problem when the bulk velocity q is positive and when viscous forces can be neglected under turbulent flow conditions moutsopoulos 2009 1 can be simplified to 2 q 1 b h x by using 2 in place of darcy s law in the conservation of mass equation the following groundwater flow equation can be derived 3 s h t x h 1 b h x 0 x 0 and t 0 here s is the specific yield and b is the quadratic coefficient from 1 in the current work we construct approximate solutions to 3 with four boundary conditions at the inlet power law head exponential head power law flux and exponential flux 2 1 problem i power law head boundary condition at the inlet the power law head problem consists of 3 with initial and boundary conditions 4 h x 0 0 for x 0 h 0 t σ t α and lim x h x t 0 for t 0 here σ is a non negative constant the case of α 1 2 corresponds to a free groundwater mound spreading into the aquifer moutsopoulos 2009 we consider values of α 1 2 so that the level of water in the reservoir for x 0 does not drop faster than water in the porous medium can drop this restriction prevents the formation of a seepage face with the flow in the upstream direction at the inlet for this problem using dimensional analysis the following dimensionless variables and parameters can be formed moutsopoulos 2009 5 ξ x β t α 2 1 3 6 β b s 2 σ α 2 3 2 and 7 h ξ h x t σ t α here ξ is the similarity variable and h ξ is the scaling function this choice of dimensionless variables transforms 3 into 8 d d ξ h d h d ξ ξ d h d ξ λ h 0 or equivalently 9 h 2 d 2 h d ξ 2 d h d ξ 2 ξ d h d ξ d h d ξ λ h d h d ξ 0 where 10 λ 3 α α 2 the case of a finite redistribution of water under the action of gravity in the aquifer corresponds to α 1 2 and λ 1 if the water level rises at the inlet α 0 and correspondingly λ 0 the initial and boundary conditions become 11 h 0 1 and lim ξ h ξ 0 two exact solutions were derived by moutsopoulos 2009 for this problem when λ 1 h ξ ξ 3 3 1 for 0 ξ 3 3 and h ξ 0 for ξ 3 3 second when λ 1 h ξ ξ 1 for 0 ξ 1 and h ξ 0 for ξ 1 2 2 problem ii exponential head boundary condition at the inlet the exponential head problem consists of 3 with initial and boundary conditions 12 h x 0 0 for x 0 h 0 t h 0 e k t for t 0 and lim x h x t 0 the parameter h 0 is a positive quantity representing the initial head at the inlet and k is the continuous rate of change of head at the inlet we choose the following dimensionless variables 13 ξ b k 2 s 2 9 h 0 e k t 1 3 x and 14 h ξ h x t h 0 e k t that are obtained using dimensional analysis and a time translation transformation barenblatt et al 1990 with this choice of variables 3 is transformed into 15 d d ξ h d h d ξ ξ d h d ξ 3 h 0 or equivalently 16 h 2 d 2 h d ξ 2 d h d ξ 2 ξ d h d ξ d h d ξ 3 h d h d ξ 0 with boundary conditions 17 h 0 1 and lim ξ h ξ 0 we note that 16 and 17 can be considered as the limiting case of the power law head problem since as α λ 3 in 10 2 3 problem iii power law flux boundary condition at the inlet the power law flux problem consists of 3 with initial and boundary conditions 18 h x 0 0 for x 0 h 0 t 1 b h x x 0 τ t γ and lim x h x t 0 for t 0 the second condition in 18 represents a power law flux condition at the inlet based on the forchheimer equation 2 we consider the cases of γ 1 3 and τ 0 due to the forms of the dimensionless variables below by selecting 19 ξ γ 3 4 3 4 b s 3 τ t γ 3 1 4 x and 20 h ξ 3 γ 1 4 1 4 s b τ 3 t 3 γ 1 1 4 h 3 is converted into 21 d d ξ h d h d ξ ξ d h d ξ λ h 0 or equivalently 22 h 2 d 2 h d ξ 2 d h d ξ 2 ξ d h d ξ d h d ξ λ h d h d ξ 0 with boundary conditions 23 h 0 d h d ξ ξ 0 1 and lim ξ h ξ 0 where 24 λ 3 γ 1 γ 3 since we consider the cases corresponding to γ 1 3 by 24 λ must be greater than 0 we note that when λ 1 this problem has an exact solution h ξ ξ 1 for ξ 1 and h ξ 0 otherwise this problem given by 21 24 is very similar to the problem for the power law head boundary condition given by 8 11 the only differences are in the condition at the inlet ξ 0 and the way in which λ is defined this fact will be used in the construction of the numerical solution to this problem 2 4 problem iv exponential flux boundary condition at the inlet the exponential flux problem consists of 3 with initial and boundary conditions 25 h x 0 0 for x 0 h 0 t 1 b h x x 0 h 1 e k t and lim x h x t 0 for t 0 the parameters h 1 and k are positive quantities representing the initial flux at the inlet and the continuous rate of increase of flux at the inlet respectively by selecting 26 ξ b k 3 s 3 64 h 1 e k t 1 4 x and 27 h ξ k s 4 b h 1 e k t 3 1 4 h 3 is converted into 28 d d ξ h d h d ξ ξ d h d ξ 3 h 0 or equivalently 29 h 2 d 2 h d ξ 2 d h d ξ 2 ξ d h d ξ d h d ξ 3 h d h d ξ 0 with boundary conditions 30 h 0 d h d ξ ξ 0 1 and lim ξ h ξ 0 this problem is the limiting case of the power law flux problem since as γ in 24 λ 3 3 conditions used for determining polynomial approximate solutions for the four problems that we introduced in section 2 we construct approximate analytical solutions in polynomial form for special values of the parameter λ some of the problems have exact polynomial solutions this makes polynomials the natural choice for the approximations in this paper to construct polynomial approximate solutions we state a number of conditions satisfied by the exact solutions the approximating polynomials are found by requiring that they satisfy these conditions even though these polynomials may not satisfy the governing differential equation itself this approach was introduced by lockington et al 2000 and extended by telyakovskiy and allen 2006 for the power law head and power law flux problems we construct quadratic and cubic approximate solutions of 8 9 and 21 22 of the forms 31 h q ξ a ξ 0 ξ b ξ 0 ξ 2 c and 32 h c ξ a ξ 0 ξ b ξ 0 ξ 2 c ξ 0 ξ 3 d the polynomial coefficients a through d depend on the parameter λ and on ξ 0 which in turn depends on λ by setting λ 3 when solving for the polynomial coefficients we will also generate approximate solutions to the exponential head and exponential flux problems we will construct the quadratic and cubic approximate solutions using the conditions listed below however instead of using the zero head condition at infinity we assume in condition 2 which follows that the dimensionless head is zero at a finite location ξ 0 which is not known a priori this ξ 0 exists because for an initially dry aquifer 21 and 9 produce a wetting front that propagates at a finite speed barenblatt 1952 in addition to the unknown polynomial coefficients this unknown ξ 0 must be obtained using the conditions listed below these conditions represent properties of the actual solution at the boundaries of the problem domain and at points between the boundaries this approach differs from using a taylor polynomial approximation in which the taylor coefficients depend on the solution properties at only one point here are the conditions that we use and their explanation appears below 33 c1 a h 0 1 b h 0 d h d ξ ξ 0 1 c2 h ξ 0 0 c3 d h d ξ ξ ξ 0 ξ 0 2 c4 a 1 2 0 ξ 0 ξ h d 2 h d ξ 2 d ξ 0 ξ 0 ξ d h d ξ 2 d ξ 0 ξ 0 ξ 2 d h d ξ d h d ξ d ξ λ 0 ξ 0 ξ h d h d ξ d ξ 0 b 1 2 0 ξ 0 h d 2 h d ξ 2 d ξ 0 ξ 0 d h d ξ 2 d ξ 0 ξ 0 ξ d h d ξ d h d ξ d ξ λ 0 ξ 0 h d h d ξ d ξ 0 c5 a 1 2 d 2 h d ξ 2 ξ 0 d h d ξ 2 ξ 0 λ d h d ξ ξ 0 0 b h 0 2 d 2 h d ξ 2 ξ 0 d h d ξ 2 ξ 0 λ 0 these conditions capture properties of the solutions to the dimensionless problems conditions 1 represent the boundary conditions at the inlet a is for the power law head condition and b is for the power law flux condition condition 2 represents the head being zero at the wetting front location ξ ξ 0 c3 follows from 9 when ξ ξ 0 it represents the slope of the phreatic surface near the wetting front c4a is obtained when 9 is multiplied by ξ and integrated over ξ 0 ξ 0 c4b which corresponds to the power law flux boundary condition is obtained by the direct integration of 22 over 0 ξ 0 conditions 4 capture global behavior of the solution over the problem domain finally conditions 5 are obtained from 9 and 22 in the limit as ξ 0 these conditions capture the limiting behavior of the solution near the inlet and incorporate conditions 1 again c5a corresponds to the power law head boundary condition and c5b corresponds to the power law flux boundary condition in appendix a we present an alternative formulation of conditions 4 based on 8 21 for the power law head problems we use four conditions c1a c2 c3 and c4a to determine the quadratic coefficients a b and c and the wetting front position ξ 0 in 31 we use five conditions c1a c2 c3 c4a and c5a to determine ξ 0 and the cubic coefficients a b c and d 32 the constant terms in hq and hc are zero due to c2 for the power law flux problems we use c1b c4b and c5b in place of c1a c4a and c5a we note that the exact solutions of the governing equations 21 and 9 satisfy the conditions described above we emphasize however that the constructed quadratic and cubic approximate solutions do not in general satisfy 21 and 9 3 1 polynomial approximate solutions to the power law head boundary problem 3 1 1 quadratic approximate solution to construct the quadratic polynomials hq 31 we must find four unknowns a b c and ξ 0 we use c1a c2 c3 and c4a from 33 by applying c2 hq can be written in the form 34 h q ξ a ξ 0 ξ b ξ 0 ξ 2 conditions c1a and c3 are used to determine a and b and c4a is used to find ξ 0 from c1a and c3 the coefficients a and b are 35 a ξ 0 2 and b 1 ξ 0 3 ξ 0 2 the polynomial hq can be rewritten in a normalized form as 36 h q z ξ 0 3 1 z 1 ξ 0 3 1 z 2 where z ξ ξ 0 condition c4a 33 written in terms of ξ 0 and z is 37 1 4 1 2 0 1 z d h q d z 2 d z ξ 0 3 2 0 1 z 2 d h q d z d h q d z d z λ ξ 0 3 2 0 1 z h q d h q d z d z 0 next we substitute hq 36 into 37 to find ξ 0 3 we note that 37 is a nonlinear equation in ξ 0 the wetting front position ξ 0 can be determined by numerically solving this algebraic equation we used the fsolve matlab routine that is based on the trust region dogleg method for the solution of this nonlinear algebraic equation it was necessary to use different initial guesses for the cases of λ 1 and λ 1 the case of λ 1 is the linear exact solution that this nonlinear equation reproduces the coefficients a and b are obtained from 35 results comparing this and the other polynomial approximate solutions that follow to the numerical solutions are given in section 5 3 1 2 cubic approximate solution for the cubic approximation hc 32 we use conditions c1a c2 c3 c4a and c5a 33 to find a b c d and ξ 0 application of condition c2 yields 38 h c ξ a ξ 0 ξ b ξ 0 ξ 2 c ξ 0 ξ 3 using c1a and c3 the coefficients a and b are found to be 39 a ξ 0 2 and b 1 ξ 0 3 c ξ 0 3 ξ 0 2 in normalized form 40 h c z ξ 0 3 1 z 1 ξ 0 3 c ξ 0 3 1 z 2 c ξ 0 3 1 z 3 where again z ξ ξ 0 conditions c4a and c5a shown below in terms of ξ 0 and z form a system of nonlinear algebraic equations that should be solved numerically to find c and ξ 0 41 1 4 1 2 0 1 z d h c d z 2 d z ξ 0 3 2 0 1 z 2 d h c d z d h c d z d z λ ξ 0 3 2 0 1 z h c d h c d z d z 0 and 42 d 2 h c d z 2 z 0 2 d h c dz z 0 2 2 λ ξ 0 3 2 d h c dz z 0 0 as in the quadratic case we use the fsolve routine from matlab the only difference is that we now solve a system of two nonlinear algebraic equations instead of just one nonlinear algebraic equation the c and ξ 0 solutions allow one to determine coefficients a and b in hc 38 the results are again presented in section 5 3 2 polynomial approximate solutions to the power law flux boundary problem the case of the power law flux boundary condition is treated similarly to the case of the power law head boundary condition we only need to use different conditions c1b c2 c3 c4b and c5b to construct the approximating quadratic and cubic polynomials 3 2 1 quadratic approximate solution to find the unknown coefficients a b c and ξ 0 in hq 31 we use conditions c1b c2 c3 and c4b when c2 is used 31 can be written as 43 h q ξ a ξ 0 ξ b ξ 0 ξ 2 now the remaining conditions c1b c3 and c4b will be used to find the rest of the unknowns using c3 we find that 44 a ξ 0 2 c1b leads to the following equation in b and ξ 0 45 ξ 0 3 ξ 0 2 b ξ 0 2 2 ξ 0 b 1 2 1 the polynomial hq can be written in normalized form as 46 h q z ξ 0 3 1 z ξ 0 2 b 1 z 2 where z ξ ξ 0 condition c4b written in terms of z is 47 h q 0 d h q d z z 0 0 1 d h q d z 2 d z 2 ξ 0 3 2 0 1 z d h q d z d h q d z d z 2 λ ξ 0 3 2 0 1 h q d h q d z d z 0 by substituting hq 46 into eq 47 we obtain a nonlinear algebraic equation in b and ξ 0 the values of b and ξ 0 can be determined by numerically solving the nonlinear system of algebraic equations formed by 45 and 47 as in the power law head case we relied on the fsolve routine in matlab again different initial guesses were needed when λ 1 and λ 1 the results are shown in section 5 3 2 2 cubic approximate solution to construct the cubic polynomial hc 32 in addition to the conditions used in the previous section we use condition c5b when c2 is used hc will be of the form 48 h c ξ a ξ 0 ξ b ξ 0 ξ 2 c ξ 0 ξ 3 we next use c1b c3 c4b and c5b to determine a b c and ξ 0 for hc 48 using c3 we find that 49 a ξ 0 2 condition c1b leads to the following equation in b c and ξ 0 50 ξ 0 3 ξ 0 2 b ξ 0 3 c ξ 0 2 2 ξ 0 b 3 ξ 0 2 c 1 2 1 the polynomial hc can now be written in normalized form as 51 h c z ξ 0 3 1 z ξ 0 2 b 1 z 2 ξ 0 3 c 1 z 3 where z ξ ξ 0 condition c4b written in terms of z is 52 h c 0 d h c d z z 0 0 1 d h c d z 2 d z 2 ξ 0 3 2 0 1 z d h c d z d h c d z d z 2 λ ξ 0 3 2 0 1 h c d h c d z d z 0 finally condition c5b shown below in terms of z is 53 h c 0 d 2 h c d z 2 z 0 2 d h c d z z 0 2 2 λ ξ 0 2 0 after we substitute hc 51 into 52 and 53 we obtain the system of nonlinear algebraic equations given by 50 52 and 53 and we solve it for b c and ξ 0 the numerical solution procedure is the same as in the quadratic case the only difference is that we now have three equations not two as before the value of a is obtained from ξ 0 the results for this approximation are presented in section 5 3 3 adomian polynomial approximate solutions to the four problems moutsopoulos 2009 used adomian polynomials of degree five to approximate solutions to the governing eq 9 for certain boundary conditions see moutsopoulos 2009 for a detailed explanation of the adomian approximation procedure following the same procedure degree two and three adomian approximate solutions can be derived for the four problems described in section 2 in the adomian procedure the solution function h is represented as a power series h ξ i 0 n c i ξ i and recursion relations for the coefficients ci for i 2 are established the first two relations which are sufficient for finding quadratic and cubic approximate solutions are 54 c 2 c 1 2 c 0 λ c 1 1 2 and 55 c 3 1 3 1 5 λ c 1 1 2 c 1 c 0 5 3 c 1 3 c 0 2 λ 2 3 for each problem the unknown coefficients and the wetting front position ξ 0 are found by solving a nonlinear system of equations formed by conditions c2 h ξ 0 0 and c3 d h d ξ ξ ξ 0 ξ 0 2 these equations for the cubic approximate solution functions are shown below for the quadratic approximations c 3 0 56 c 0 c 1 ξ 0 c 2 ξ 0 2 c 3 ξ 0 3 0 57 c 1 2 c 2 ξ 0 3 c 3 ξ 0 2 ξ 0 2 finally the system 56 and 57 is solved using the recurrence relations 54 and 55 and the inlet boundary condition c1 for the power law head problem c 0 1 due to the inlet boundary condition c1a h 0 1 the unknowns c 1 and ξ 0 can then be found for the power law flux problem the inlet boundary condition c1b is h 0 d h d ξ ξ 0 1 this leads to the relation c 0 c 1 1 or equivalently c 1 1 c 0 2 using this relation the unknowns c 0 and ξ 0 can be found 4 numerical solutions we solve the power law head problem 9 and 11 and the power law flux problem 22 and 23 using a modification of shampine s method shampine 1973 telyakovskiy and allen 2006 in this procedure the governing equation is solved numerically as an initial value problem by assuming that ξ 0 1 starting at ξ 0 the equation is solved back towards the inlet ξ 0 to yield a water surface profile to start the calculations we use a taylor series expansion of the solution about ξ 0 1 to step away from ξ 0 toward ξ 0 the taylor series expansion uses values of the derivatives of the solution function at ξ ξ 0 those derivatives are obtained from the governing eq 9 to solve 9 we write it as a first order system of differential equations and a runge kutta method is used since ξ 0 need not be one the intermediate numerical solution described above does not in general match the boundary condition at ξ 0 shampine s method exploits scale invariant properties of the governing equation to produce a solution that matches the inlet boundary condition the intermediate solution is rescaled to force it to satisfy this boundary condition the rescaling process also generates the true value of ξ 0 the details of the rescaling process are discussed below in the power law head problem 9 is invariant with respect to the transformations ξ l 1 3 ξ and h l h when l 0 if h 0 ξ is a solution of 9 then h 1 ξ l 0 h 0 l 0 1 3 ξ is also a solution in particular if h 0 is an intermediate solution such that h 0 1 0 we select l 0 so that h 1 will satisfy the inlet boundary condition c1a for the power law head boundary problem in this case l 0 h 0 0 1 the wetting front position for this problem is obtained by solving for ξ 0 plh in l 0 1 3 ξ 0 p l h 1 therefore ξ 0 p l h h 0 0 1 3 a similar rescaling process can be conducted to generate solutions to the power law flux boundary problem an intermediate solution h 0 to the power law flux problem such that h 0 1 0 can be used alternatively the solution h 1 to the power law head boundary problem can be used for the latter approach let us denote as h 2 the solution of the power law flux problem we rescale h 1 to produce a solution h 2 h 2 ξ l 1 h 1 l 1 1 3 ξ the scaling factor l 1 is selected so that h 2 satisfies the flux boundary condition c1b at the inlet in this case l 1 d h 1 d ξ ξ 0 3 10 the wetting front position is obtained by solving for ξ 0 plf in l 1 1 3 ξ 0 p l f ξ 0 p l h therefore ξ 0 p l f l 1 1 3 ξ 0 p l h numerical results for the power law head and power law flux problems are shown in tabular and graphical forms in section 5 these numerical results are compared with the polynomial approximate solutions 5 comparison of the polynomial approximate and numerical solutions for each of the four problems described above we compare the estimated positions of the dimensionless wetting front ξ 0 with the numerically calculated values these results are shown in tables 1 and 2 we also present the graphs of the polynomial approximate and numerical solutions in figs 2 and 3 the results for the exponential boundary conditions are special cases of the power law results for λ 3 we also show in appendix a how the form of the approximate solutions will change if we use 8 21 as the governing equations instead of 9 22 on which the derivations of sections 2 and 3 were based 5 1 power law head boundary problem the positions of the dimensionless wetting fronts ξ 0 as predicted by shampine s method and by the quadratic and cubic approximate solutions are shown in table 1 for various values of λ the case of λ 3 corresponds to the exponential head condition at the inlet this is the limiting case of the power law head boundary condition as the power law exponent α exact cubic and linear solutions exist for the cases of λ 1 and λ 1 respectively for all of the cases shown both polynomial approximate solutions provide reasonable predictions of the wetting front positions the quadratic and cubic adomian predictions are also shown in table 1 our polynomials produce more accurate predictions of the wetting front positions than the adomian polynomials of the same degrees we note that in moutsopoulos 2009 adomian polynomials of degree five were considered and they provide better estimates of the wetting front positions than our polynomials of lower degree the dimensionless scaling profiles are shown in fig 2 in each case the cubic approximate solution closely agrees with the numerical solution the cubic approximations also reproduce the exact solutions for λ 1 the quadratic polynomial solutions approximate reasonably well the numerical solutions except for the case of λ 1 in which the exact solution is a cubic polynomial overall the cubic approximate solutions match the numerical solutions better than the quadratic approximate solutions the polynomial coefficients for the approximate solutions are tabulated in appendix b a discussion of the difference between flows described by the two term forchheimer equation and those described by the one term forchheimer equation for the fully turbulent case considered in this paper is given in appendix c on this topic some results for the power law head boundary condition are given in moutsopoulos 2009 also in appendix c we present our findings for the case of the exponential head boundary condition 5 2 power law flux boundary problem in table 2 the positions of the dimensionless wetting fronts ξ 0 for various values of λ are shown the case of λ 3 corresponds to the exponential flux condition at the inlet this is the limiting case of the power law flux boundary condition as the power law exponent γ an exact linear solution exists for the case of λ 1 for the cases considered the polynomial approximate solutions provide reasonable predictions of the wetting front positions the cubic approximate solutions provide better estimates of the wetting front positions than the quadratic solutions the quadratic and cubic adomian predictions are also shown in table 2 as with the power law head boundary problem our polynomials produce more accurate predictions of the wetting front positions than the adomian polynomials of the same degree the dimensionless solution curves are shown in fig 3 in each case the cubic approximate solution closely agrees with the numerical solution and the quadratic approximate solution gives slightly worse values the quadratic and cubic approximations also reproduce the exact solution for λ 1 the polynomial coefficients for the approximate solutions are tabulated in appendix b as in the case of the head boundary conditions we analyze the difference between flows described by the two term forchheimer equation and those described by the one term forchheimer equation for the fully turbulent flow for flux boundary conditions our findings for the problems with the flux boundary conditions are given in appendix c 6 summary and conclusions we derived polynomial approximate solutions of a forchheimer groundwater flow equation for four types of boundary conditions at the inlet of a one dimensional initially dry unconfined aquifer the particular form of the forchheimer equation that we utilized represents turbulent flow in the aquifer for power law head and flux conditions at the inlet quadratic and cubic polynomial approximate solutions replicated accurately the numerical solutions of the equation the cubic solutions approximated well the numerical solutions for all cases considered moreover the cubic approximate solutions replicated the three exact solutions the quadratic approximate solutions approximated well the numerical solutions except in the case of a finite redistribution of water λ 1 in this case however the problem has an exact cubic solution the other two exact solutions were replicated by the quadratic approximate solutions the problems with exponential boundary conditions at the inlet were shown to be the limiting cases of the corresponding power law problems as the power law exponents increase without bound using the procedures presented in this work the process of constructing approximate solutions to the nonlinear ordinary differential equation is reduced to solving a nonlinear algebraic equation or system of nonlinear algebraic equations for the wetting front position and polynomial coefficients after these approximations have been constructed they can be used for different values of the constants appearing in the equation and the boundary conditions using a modification of a method of shampine we also numerically solved the equation using a procedure which exploited its scaling properties and showed that these numerical solutions can be validated using low degree polynomials this demonstrates the utility of the approximate solutions for validating numerical solutions when exact solutions do not exist more realistic problems appearing in applications are usually modeled with the more complicated forchheimer type equations the newly derived approximate analytical solutions in this paper can be used to test the validity and accuracy of numerical schemes we note that not many exact solutions are available for this purpose as a result approximate analytical solutions can be used to validate numerical solutions variations of shampine s method and of the methods used for the construction of the polynomial approximate solutions have been previously used with the boussinesq and porous medium equations in the current work the methods were extended to a different type of nonlinear groundwater flow equation the current work and work done for the boussinesq and porous medium equation show that approximate solutions can be constructed using only values of the solution function and its derivatives near the problem boundaries and one integral representing global behavior of the solution this information was sufficient for the polynomials to closely match the numerical solutions as evidenced by the polynomials close agreement to numerical solutions and their replication of the exact solutions finally our polynomials better predicted the wetting front positions than adomian polynomials of the same degree with additional terms the adomian method produces better results as one would expect acknowledgement this research did not receive any specific grant from funding agencies in the public commercial or not for profit sectors the authors thank the editor graham sander for his comments on this paper we also thank konstantinos moutsopoulos and the anonymous reviewer for multiple useful comments and suggestions that improved the quality of this paper appendix a in this appendix we present an alternative set of conditions 4 that can be used to determine the coefficients of the polynomial approximate solutions and the wetting front positions these alternative conditions are derived in the same manner as the original conditions 4 but 8 21 is used in place of 9 22 again c4a was obtained by multiplying 8 by ξ and integrating it over the problem domain while c4b was obtained by only integrating 21 over the problem domain conditions c1a and c1b were used respectively to simplify the forms of c4a and c4b that appear below the other conditions listed in 33 were not changed a 1 c4 a 0 ξ 0 h d h d ξ d ξ λ 2 0 ξ 0 ξ h d ξ 0 b 0 ξ 0 h d ξ 1 1 λ alternative power law head formulation for the power law head condition at the inlet conditions c1a c2 and c3 are used again to write the quadratic and cubic polynomials in normalized form as a 2 h q z ξ 0 3 1 z 1 ξ 0 3 1 z 2 and a 3 h c z ξ 0 3 1 z 1 ξ 0 3 ξ 0 3 c 1 z 2 ξ 0 3 c 1 z 3 where z ξ ξ 0 the alternative condition c4a a 1 can be written in terms of ξ 0 and the normalized variable z as a 4 0 1 h d h d z d z λ 2 ξ 0 3 2 0 1 z h d z 0 solving a 4 with the quadratic hq yields a solution for ξ 0 solving the system consisting of a 4 and c5a 42 with the cubic hc allows one to find c and ξ 0 the values of the coefficients a and b can then be found for the power law head problem the alternative quadratic approximate solution better approximates the wetting front position when λ 1 than the previous quadratic solution however the new solutions yield worse approximations when λ 1 when 9 was used as the governing equation the quadratic approximate solution did give the correct value of ξ 0 up to the specified precision for λ 1 however the alternative quadratic approximate solution did not give the correct value of ξ 0 in this case as shown in table a 1 the alternative cubic solutions produce similar results to those of the original cubic approximate solutions for the power law head problem the comparison is shown in table a 1 alternative power law flux formulation for the power law flux problem conditions c1b c2 and c3 are again used to write the quadratic and cubic polynomials in normalized form as a 5 h q z ξ 0 3 1 z ξ 0 2 b 1 z 2 and a 6 h c z ξ 0 3 1 z ξ 0 2 b 1 z 2 ξ 0 3 c 1 z 3 where z ξ ξ 0 the alternative condition c4b a 1 can be written in terms of ξ 0 and the normalized variable z as a 7 ξ 0 0 1 h d z 1 1 λ solving a 7 and the nonlinear eq 45 for c1b with the quadratic hq yields solutions for ξ 0 and b solving the system consisting of a 7 and conditions c1b and c5b with the cubic hc 50 and 53 allows one to solve for ξ 0 b and c the coefficient a can then be found the alternative formulation of c4b produces similar results to the original formulation but the calculations are somewhat easier appendix b in tables b1 and b2 we present the polynomial coefficients for the approximate solutions to the power law head and power law flux problems the wetting front positions ξ 0 for these problems are shown in tables 1 and 2 appendix c in this appendix we present numerical simulations conducted with the pdepe matlab subroutine for problems ii iii and iv of this paper the parameters for the numerical simulations are in many ways similar to those of moutsopoulos 2009 in his work he showed that fully turbulent flow is more likely to be observed for earlier times than for later times in our numerical results we observed similar phenomena for problems ii iii and iv which were not analyzed in moutsopoulos 2009 in moutsopoulos 2009 only problem i was analyzed for problem ii which represents the exponential head boundary condition at the inlet we did numerical simulations for the times 25 5 and 175 5 seconds we selected s 0 2 a 0 225 s m 1 and b 121 0 s 2 m 2 these parameters are the same as those of moutsopoulos 2009 for the boundary condition we used h 0 1 38 10 1 m and k 0 01 s 1 the results are presented in figs c 1 and c 2 in each figure there are two curves one is for the two term forchheimer equation and the second is for the fully turbulent flow considered in this paper for the power law flux boundary condition we consider flux increasing linearly at the inlet boundary for fully turbulent flow this form of the boundary term corresponds to the linear exact solution shown earlier in this paper the parameters used in this case were γ 1 and τ 3 321 10 3 m 2 s 2 numerical results for two instances of time 98 5 and 3 598 5 seconds are given in figs c 3 and c 4 we selected the same parameters as moutsopoulos 2009 forchheimer s1 means that the two term forchheimer equation was used to represent flux in both the p d e and in the boundary term we used a 0 137 s m 1 and b 1 666 s 2 m 2 the numerical results for the fully turbulent case shown in figs c 3 and c 4 represent the case considered in this paper they do not differ substantially from the forchheimer s2 case also presented in those figures in which the viscous term was significantly smaller than in the s1 case in the s2 case a 0 0137 s m 1 and b 1 666 s 2 m 2 all of these cases represent flow in fractures so s 1 for problem iv which represents the exponential flux boundary condition at the inlet we did similar calculations to those of the power law flux boundary condition the numerical results are presented in figs c 5 and c 6 the meaning of the curves is the same as before the main difference is that one of the times is different instead of 3 958 5 seconds we used 758 5 seconds the value of h 1 3 321 10 3 m 2 s 1 and k 0 01 s 1 we can see that the fully turbulent case over predicts the wetting front position while the two term forchheimer equation gives as expected higher values for the boundary head in the cases where the flux boundary condition is specified this occurs since in addition to the inertial term there is a viscous term in eq 1 that was neglected in the fully turbulent case 
718,we consider a one dimensional unconfined groundwater flow equation for the horizontal propagation of water this equation was derived by using a particular form of the forchheimer equation in place of darcy s law such equations can model turbulent flows in coarse and fractured porous media for power law head exponential head power law flux and exponential flux boundary conditions at the inlet the problems can be reduced using similarity transformations to boundary value problems for a nonlinear ordinary differential equation we construct quadratic and cubic approximate solutions of these problems we also numerically compute solutions using a new modification of a method of shampine which exploits scaling properties of the governing equation the polynomial approximate solutions replicate well the numerical solutions and they are easy to use last we compare the predicted wetting front positions from our quadratic and cubic polynomials to predictions based on adomian polynomials of the same degrees the work demonstrates the value of polynomial approximate solutions for validating numerical solutions and for obtaining good approximations for water profiles and the extent of water propagation this work also presents a new application of shampine s method for this type of groundwater flow equation we note that this paper introduces additional classes of approximate solutions for the forchheimer equation up to this date not many solutions are known especially for the transient cases considered here keywords forchheimer equation polynomial approximate solution nonlinear flow equation shampine s method unconfined flow adomian method 1 introduction unconfined groundwater flows are often modeled using the boussinesq equation the derivation of which relies on vertical averaging and an assumption of darcian flow when flows are non darcian other groundwater flow equations can be derived generalizations of darcy s law such as the forchheimer and izbash equations can be used to derive governing equations for non darcy flows moutsopoulos 2009 in this work we focus on one dimensional horizontal water propagation non darcy flows have been studied in a variety of contexts bordier and zimmer 2000 note that the forchheimer and izbash equations can be used to model flows in coarse gravel and geosynthetic media chin et al 2009 found that flows through karstic limestone samples can be described by the forchheimer equation xia et al 2017 experimentally investigated flow characteristics in artificially constructed rock joints and found that the forchheimer and izbash equations both accurately describe fluid flows in a single joint ghane et al 2014 observed that the forchheimer equation describes flows through a woodchip denitrification bed while other researchers have used the forchheimer equation to model flows to wells see e g mathias and moutsopoulos 2016 wen et al 2011 the two term forchheimer equation hassanizadeh and gray 1987 is a generalization of darcy s law for flows that satisfy 1 h x a q b q q where h is the groundwater head and q is the bulk velocity the forchheimer coefficient a is the reciprocal of the hydraulic conductivity which depends on properties of the fluid and porous medium while b depends only on properties of the porous medium chin et al 2009 a detailed discussion of the physical meaning of the coefficients is given by venkataraman and rao 1998 we note that when inertial effects represented by the quadratic term of 1 are negligible b 0 and darcy s law is recovered xia et al 2017 for fully turbulent flows the viscous effects represented by the linear term of 1 are dominated by the inertial effects and the linear term is negligible xia et al 2017 in the current work we use forchheimer equation in a simplified form where the linear term on the right side of 1 is neglected researchers have studied the conditions for which non darcy flows occur for example xiong et al 2017 note that non darcy flows can occur at small and large flow rates while mathias et al 2008 classified these flows as pre linear and post linear some investigators classify non darcian flows by reynolds number see irmay 1958 and burcharth and andersen 1995 for the discussion of these classifications barenblatt et al 1990 caution that non darcy flows can occur at low pre turbulence reynolds numbers due the tortuous flow paths taken by fluids in porous media zeng and grigg 2006 argue for using a forchheimer number instead of the reynolds number to identify non darcy flows and hassanizadeh and gray 1987 summarize various potential causes of nonlinear effects on flows these nonlinear effects can be attributed to turbulence microscopic inertial forces and microscopic drag forces that occur at high flow velocities to name a few of the causes numerical methods are traditionally used to approximate solutions to nonlinear flow problems since in general exact solutions cannot be constructed at the same time to justify the validity of numerical codes and to interpret experimental results approximate analytic solutions are required these and other uses of analytical solutions are discussed by hayek 2016 approximate analytic methods such as the adomian see e g adomian 1994 serrano 1997 and homotopy perturbation see e g munusamy and dhar 2016 are among the methods used to generate solutions to groundwater flow problems the polynomial approximate solutions constructed in the current work are based on the method introduced in lockington et al 2000 for the boussinesq equation the method was further extended in telyakovskiy and allen 2006 to more classes of boundary conditions and in olsen and telyakovskiy 2013 it was applied to a generalized boussinesq equation turbulent flow in porous media is often modeled by using the forchheimer equation in place of darcy s law at present there is a limited number of analytical solutions to the forchheimer equation for flows in unconfined aquifers for example solutions for steady state flows are considered in eck et al 2012 and sedghi asl et al 2014 both of these papers deal with the realistic case of inclined aquifers and deposits sedghi asl et al 2014 provide a family of analytical solutions that can be applied to inclined aquifers the slopes of which vary from zero to high values sedghi asl et al 2014 also presented an experimental study that illustrated the presence of fully developed turbulent flow in an inclined rock drain meanwhile eck et al 2012 derived an analytical solution for a sloped porous pavement that is being recharged by constant rainfall other work has been done on the construction of approximate analytical solutions for the transient forchheimer equation analytical solutions based on adomian polynomials were constructed by moutsopoulos 2007 in that paper it was assumed that the inertial term dominates the viscous term in the quadratic forchheimer equation the considered problems differ from those presented in this paper since the aquifer was initially non empty while at the inlet there was a sudden change in groundwater head extensive experimental results showing the presence of non darcian flows in coarse porous media are presented in bordier and zimmer 2000 they fit the forchheimer and izbash equations to observed data both equations led to similar results but the forchheimer equation has a firmer theoretical foundation compared to the izbash equation moreover these authors provided a theoretical analysis on which a more recent paper of mathias and moutsopoulos 2016 is based mathias and moutsopoulos 2016 constructed a collection of approximate analytical solutions for the radially symmetric forchheimer equation their approximate solutions compare favorably with the numerical results presented in that paper moutsopoulos 2009 analyzed the resulting nonlinear governing equation in the case of one dimensional unconfined turbulent flow under the dupuit forchheimer assumption for a special form of the forchheimer equation that includes only the inertial term in appendix a moutsopoulos 2009 presented conditions under which such flows can occur in fractures and porous media for fully turbulent flow to develop the hydraulic gradient should be sufficiently high at the same time a high value of the hydraulic gradient will lead to a steep slope of the phreatic surface and the dupuit assumption of strictly horizontal flow may not hold the theoretical observations of moutsopoulos 2009 back the experimental results of qian et al 2005 for flows in fractures sedghi asl et al 2014 provided experimental confirmation of the analysis of moutsopoulos 2009 for fully turbulent steady state flow in porous media conditions for the existence of such flows are presented in appendix a of moutsopoulos 2009 in this paper we consider one dimensional flows of this type moutsopoulos analyzed the problem of recharge into an initially dry aquifer for two types of boundary conditions specified at the inlet a power law time condition on head and a constant flux condition using a similarity transformation the problem was reduced to a free boundary value problem for a nonlinear ordinary differential equation that was approximately solved using adomian polynomials for certain recharge regimes the problem has exact solutions which the adomian procedure reproduced for other regimes moutsopoulos used a shooting type of procedure based on the runge kutta method to find the numerical solutions of the governing equation and compared them with the adomian polynomial solutions in the current work we consider the problem described in moutsopoulos 2009 but we use different methods and extend his work to include other types of boundary conditions in addition to a power law head condition at the inlet we consider exponential head power law flux and exponential flux conditions the exponential boundary conditions are shown to be the limiting cases of the corresponding power law conditions with the introduction of dimensionless variables we transform all of these problems into boundary value problems involving the same ordinary differential equation next we construct quadratic and cubic approximate solutions to these problems that are compared to numerical solutions obtained using a newly introduced modification of a method by shampine 1973 earlier in this introduction in addition to motivating the use of the forchheimer equation we mentioned a number of approximate analytical solutions for the forchheimer equation some were for the steady state case and some were for the transient case all together there are not many solutions to the forchheimer equation unlike for the boussinesq and generalized boussinesq equations the boussinesq and generalized boussinesq equations have been extensively studied since they describe many types of common flows in unconfined aquifers with the solutions presented in the later sections of this paper we provide one more approximate analytical approach to the analysis of transient forchheimer flows in the sections below we present the four flow problems one for each of the boundary conditions introduce dimensionless variables and convert the problems into boundary value problems involving the ordinary differential equation after this using the boundary conditions and properties of the ordinary differential equation we describe conditions that the actual solutions satisfy these conditions are used to determine the coefficients of the polynomial approximate solutions and the unknown wetting front position or penetration length the polynomials are determined exclusively by the stated conditions one set of conditions is used for the head boundary conditions at the inlet while a different set is used for the flux boundary conditions finally we describe our modification of shampine s method numerically compute solutions of the dimensionless equations and then compare these solutions to the polynomial approximate solutions 2 problem formulation we consider unconfined flow in an initially dry aquifer with a horizontal impermeable lower boundary as shown in fig 1 for each of four boundary conditions at the inlet we present the initial and boundary conditions the dimensionless variables and the reduced dimensionless form of each problem see moutsopoulos 2009 for the derivation of the governing equation the formulation of the power law head problem and the exact solutions to this problem when the bulk velocity q is positive and when viscous forces can be neglected under turbulent flow conditions moutsopoulos 2009 1 can be simplified to 2 q 1 b h x by using 2 in place of darcy s law in the conservation of mass equation the following groundwater flow equation can be derived 3 s h t x h 1 b h x 0 x 0 and t 0 here s is the specific yield and b is the quadratic coefficient from 1 in the current work we construct approximate solutions to 3 with four boundary conditions at the inlet power law head exponential head power law flux and exponential flux 2 1 problem i power law head boundary condition at the inlet the power law head problem consists of 3 with initial and boundary conditions 4 h x 0 0 for x 0 h 0 t σ t α and lim x h x t 0 for t 0 here σ is a non negative constant the case of α 1 2 corresponds to a free groundwater mound spreading into the aquifer moutsopoulos 2009 we consider values of α 1 2 so that the level of water in the reservoir for x 0 does not drop faster than water in the porous medium can drop this restriction prevents the formation of a seepage face with the flow in the upstream direction at the inlet for this problem using dimensional analysis the following dimensionless variables and parameters can be formed moutsopoulos 2009 5 ξ x β t α 2 1 3 6 β b s 2 σ α 2 3 2 and 7 h ξ h x t σ t α here ξ is the similarity variable and h ξ is the scaling function this choice of dimensionless variables transforms 3 into 8 d d ξ h d h d ξ ξ d h d ξ λ h 0 or equivalently 9 h 2 d 2 h d ξ 2 d h d ξ 2 ξ d h d ξ d h d ξ λ h d h d ξ 0 where 10 λ 3 α α 2 the case of a finite redistribution of water under the action of gravity in the aquifer corresponds to α 1 2 and λ 1 if the water level rises at the inlet α 0 and correspondingly λ 0 the initial and boundary conditions become 11 h 0 1 and lim ξ h ξ 0 two exact solutions were derived by moutsopoulos 2009 for this problem when λ 1 h ξ ξ 3 3 1 for 0 ξ 3 3 and h ξ 0 for ξ 3 3 second when λ 1 h ξ ξ 1 for 0 ξ 1 and h ξ 0 for ξ 1 2 2 problem ii exponential head boundary condition at the inlet the exponential head problem consists of 3 with initial and boundary conditions 12 h x 0 0 for x 0 h 0 t h 0 e k t for t 0 and lim x h x t 0 the parameter h 0 is a positive quantity representing the initial head at the inlet and k is the continuous rate of change of head at the inlet we choose the following dimensionless variables 13 ξ b k 2 s 2 9 h 0 e k t 1 3 x and 14 h ξ h x t h 0 e k t that are obtained using dimensional analysis and a time translation transformation barenblatt et al 1990 with this choice of variables 3 is transformed into 15 d d ξ h d h d ξ ξ d h d ξ 3 h 0 or equivalently 16 h 2 d 2 h d ξ 2 d h d ξ 2 ξ d h d ξ d h d ξ 3 h d h d ξ 0 with boundary conditions 17 h 0 1 and lim ξ h ξ 0 we note that 16 and 17 can be considered as the limiting case of the power law head problem since as α λ 3 in 10 2 3 problem iii power law flux boundary condition at the inlet the power law flux problem consists of 3 with initial and boundary conditions 18 h x 0 0 for x 0 h 0 t 1 b h x x 0 τ t γ and lim x h x t 0 for t 0 the second condition in 18 represents a power law flux condition at the inlet based on the forchheimer equation 2 we consider the cases of γ 1 3 and τ 0 due to the forms of the dimensionless variables below by selecting 19 ξ γ 3 4 3 4 b s 3 τ t γ 3 1 4 x and 20 h ξ 3 γ 1 4 1 4 s b τ 3 t 3 γ 1 1 4 h 3 is converted into 21 d d ξ h d h d ξ ξ d h d ξ λ h 0 or equivalently 22 h 2 d 2 h d ξ 2 d h d ξ 2 ξ d h d ξ d h d ξ λ h d h d ξ 0 with boundary conditions 23 h 0 d h d ξ ξ 0 1 and lim ξ h ξ 0 where 24 λ 3 γ 1 γ 3 since we consider the cases corresponding to γ 1 3 by 24 λ must be greater than 0 we note that when λ 1 this problem has an exact solution h ξ ξ 1 for ξ 1 and h ξ 0 otherwise this problem given by 21 24 is very similar to the problem for the power law head boundary condition given by 8 11 the only differences are in the condition at the inlet ξ 0 and the way in which λ is defined this fact will be used in the construction of the numerical solution to this problem 2 4 problem iv exponential flux boundary condition at the inlet the exponential flux problem consists of 3 with initial and boundary conditions 25 h x 0 0 for x 0 h 0 t 1 b h x x 0 h 1 e k t and lim x h x t 0 for t 0 the parameters h 1 and k are positive quantities representing the initial flux at the inlet and the continuous rate of increase of flux at the inlet respectively by selecting 26 ξ b k 3 s 3 64 h 1 e k t 1 4 x and 27 h ξ k s 4 b h 1 e k t 3 1 4 h 3 is converted into 28 d d ξ h d h d ξ ξ d h d ξ 3 h 0 or equivalently 29 h 2 d 2 h d ξ 2 d h d ξ 2 ξ d h d ξ d h d ξ 3 h d h d ξ 0 with boundary conditions 30 h 0 d h d ξ ξ 0 1 and lim ξ h ξ 0 this problem is the limiting case of the power law flux problem since as γ in 24 λ 3 3 conditions used for determining polynomial approximate solutions for the four problems that we introduced in section 2 we construct approximate analytical solutions in polynomial form for special values of the parameter λ some of the problems have exact polynomial solutions this makes polynomials the natural choice for the approximations in this paper to construct polynomial approximate solutions we state a number of conditions satisfied by the exact solutions the approximating polynomials are found by requiring that they satisfy these conditions even though these polynomials may not satisfy the governing differential equation itself this approach was introduced by lockington et al 2000 and extended by telyakovskiy and allen 2006 for the power law head and power law flux problems we construct quadratic and cubic approximate solutions of 8 9 and 21 22 of the forms 31 h q ξ a ξ 0 ξ b ξ 0 ξ 2 c and 32 h c ξ a ξ 0 ξ b ξ 0 ξ 2 c ξ 0 ξ 3 d the polynomial coefficients a through d depend on the parameter λ and on ξ 0 which in turn depends on λ by setting λ 3 when solving for the polynomial coefficients we will also generate approximate solutions to the exponential head and exponential flux problems we will construct the quadratic and cubic approximate solutions using the conditions listed below however instead of using the zero head condition at infinity we assume in condition 2 which follows that the dimensionless head is zero at a finite location ξ 0 which is not known a priori this ξ 0 exists because for an initially dry aquifer 21 and 9 produce a wetting front that propagates at a finite speed barenblatt 1952 in addition to the unknown polynomial coefficients this unknown ξ 0 must be obtained using the conditions listed below these conditions represent properties of the actual solution at the boundaries of the problem domain and at points between the boundaries this approach differs from using a taylor polynomial approximation in which the taylor coefficients depend on the solution properties at only one point here are the conditions that we use and their explanation appears below 33 c1 a h 0 1 b h 0 d h d ξ ξ 0 1 c2 h ξ 0 0 c3 d h d ξ ξ ξ 0 ξ 0 2 c4 a 1 2 0 ξ 0 ξ h d 2 h d ξ 2 d ξ 0 ξ 0 ξ d h d ξ 2 d ξ 0 ξ 0 ξ 2 d h d ξ d h d ξ d ξ λ 0 ξ 0 ξ h d h d ξ d ξ 0 b 1 2 0 ξ 0 h d 2 h d ξ 2 d ξ 0 ξ 0 d h d ξ 2 d ξ 0 ξ 0 ξ d h d ξ d h d ξ d ξ λ 0 ξ 0 h d h d ξ d ξ 0 c5 a 1 2 d 2 h d ξ 2 ξ 0 d h d ξ 2 ξ 0 λ d h d ξ ξ 0 0 b h 0 2 d 2 h d ξ 2 ξ 0 d h d ξ 2 ξ 0 λ 0 these conditions capture properties of the solutions to the dimensionless problems conditions 1 represent the boundary conditions at the inlet a is for the power law head condition and b is for the power law flux condition condition 2 represents the head being zero at the wetting front location ξ ξ 0 c3 follows from 9 when ξ ξ 0 it represents the slope of the phreatic surface near the wetting front c4a is obtained when 9 is multiplied by ξ and integrated over ξ 0 ξ 0 c4b which corresponds to the power law flux boundary condition is obtained by the direct integration of 22 over 0 ξ 0 conditions 4 capture global behavior of the solution over the problem domain finally conditions 5 are obtained from 9 and 22 in the limit as ξ 0 these conditions capture the limiting behavior of the solution near the inlet and incorporate conditions 1 again c5a corresponds to the power law head boundary condition and c5b corresponds to the power law flux boundary condition in appendix a we present an alternative formulation of conditions 4 based on 8 21 for the power law head problems we use four conditions c1a c2 c3 and c4a to determine the quadratic coefficients a b and c and the wetting front position ξ 0 in 31 we use five conditions c1a c2 c3 c4a and c5a to determine ξ 0 and the cubic coefficients a b c and d 32 the constant terms in hq and hc are zero due to c2 for the power law flux problems we use c1b c4b and c5b in place of c1a c4a and c5a we note that the exact solutions of the governing equations 21 and 9 satisfy the conditions described above we emphasize however that the constructed quadratic and cubic approximate solutions do not in general satisfy 21 and 9 3 1 polynomial approximate solutions to the power law head boundary problem 3 1 1 quadratic approximate solution to construct the quadratic polynomials hq 31 we must find four unknowns a b c and ξ 0 we use c1a c2 c3 and c4a from 33 by applying c2 hq can be written in the form 34 h q ξ a ξ 0 ξ b ξ 0 ξ 2 conditions c1a and c3 are used to determine a and b and c4a is used to find ξ 0 from c1a and c3 the coefficients a and b are 35 a ξ 0 2 and b 1 ξ 0 3 ξ 0 2 the polynomial hq can be rewritten in a normalized form as 36 h q z ξ 0 3 1 z 1 ξ 0 3 1 z 2 where z ξ ξ 0 condition c4a 33 written in terms of ξ 0 and z is 37 1 4 1 2 0 1 z d h q d z 2 d z ξ 0 3 2 0 1 z 2 d h q d z d h q d z d z λ ξ 0 3 2 0 1 z h q d h q d z d z 0 next we substitute hq 36 into 37 to find ξ 0 3 we note that 37 is a nonlinear equation in ξ 0 the wetting front position ξ 0 can be determined by numerically solving this algebraic equation we used the fsolve matlab routine that is based on the trust region dogleg method for the solution of this nonlinear algebraic equation it was necessary to use different initial guesses for the cases of λ 1 and λ 1 the case of λ 1 is the linear exact solution that this nonlinear equation reproduces the coefficients a and b are obtained from 35 results comparing this and the other polynomial approximate solutions that follow to the numerical solutions are given in section 5 3 1 2 cubic approximate solution for the cubic approximation hc 32 we use conditions c1a c2 c3 c4a and c5a 33 to find a b c d and ξ 0 application of condition c2 yields 38 h c ξ a ξ 0 ξ b ξ 0 ξ 2 c ξ 0 ξ 3 using c1a and c3 the coefficients a and b are found to be 39 a ξ 0 2 and b 1 ξ 0 3 c ξ 0 3 ξ 0 2 in normalized form 40 h c z ξ 0 3 1 z 1 ξ 0 3 c ξ 0 3 1 z 2 c ξ 0 3 1 z 3 where again z ξ ξ 0 conditions c4a and c5a shown below in terms of ξ 0 and z form a system of nonlinear algebraic equations that should be solved numerically to find c and ξ 0 41 1 4 1 2 0 1 z d h c d z 2 d z ξ 0 3 2 0 1 z 2 d h c d z d h c d z d z λ ξ 0 3 2 0 1 z h c d h c d z d z 0 and 42 d 2 h c d z 2 z 0 2 d h c dz z 0 2 2 λ ξ 0 3 2 d h c dz z 0 0 as in the quadratic case we use the fsolve routine from matlab the only difference is that we now solve a system of two nonlinear algebraic equations instead of just one nonlinear algebraic equation the c and ξ 0 solutions allow one to determine coefficients a and b in hc 38 the results are again presented in section 5 3 2 polynomial approximate solutions to the power law flux boundary problem the case of the power law flux boundary condition is treated similarly to the case of the power law head boundary condition we only need to use different conditions c1b c2 c3 c4b and c5b to construct the approximating quadratic and cubic polynomials 3 2 1 quadratic approximate solution to find the unknown coefficients a b c and ξ 0 in hq 31 we use conditions c1b c2 c3 and c4b when c2 is used 31 can be written as 43 h q ξ a ξ 0 ξ b ξ 0 ξ 2 now the remaining conditions c1b c3 and c4b will be used to find the rest of the unknowns using c3 we find that 44 a ξ 0 2 c1b leads to the following equation in b and ξ 0 45 ξ 0 3 ξ 0 2 b ξ 0 2 2 ξ 0 b 1 2 1 the polynomial hq can be written in normalized form as 46 h q z ξ 0 3 1 z ξ 0 2 b 1 z 2 where z ξ ξ 0 condition c4b written in terms of z is 47 h q 0 d h q d z z 0 0 1 d h q d z 2 d z 2 ξ 0 3 2 0 1 z d h q d z d h q d z d z 2 λ ξ 0 3 2 0 1 h q d h q d z d z 0 by substituting hq 46 into eq 47 we obtain a nonlinear algebraic equation in b and ξ 0 the values of b and ξ 0 can be determined by numerically solving the nonlinear system of algebraic equations formed by 45 and 47 as in the power law head case we relied on the fsolve routine in matlab again different initial guesses were needed when λ 1 and λ 1 the results are shown in section 5 3 2 2 cubic approximate solution to construct the cubic polynomial hc 32 in addition to the conditions used in the previous section we use condition c5b when c2 is used hc will be of the form 48 h c ξ a ξ 0 ξ b ξ 0 ξ 2 c ξ 0 ξ 3 we next use c1b c3 c4b and c5b to determine a b c and ξ 0 for hc 48 using c3 we find that 49 a ξ 0 2 condition c1b leads to the following equation in b c and ξ 0 50 ξ 0 3 ξ 0 2 b ξ 0 3 c ξ 0 2 2 ξ 0 b 3 ξ 0 2 c 1 2 1 the polynomial hc can now be written in normalized form as 51 h c z ξ 0 3 1 z ξ 0 2 b 1 z 2 ξ 0 3 c 1 z 3 where z ξ ξ 0 condition c4b written in terms of z is 52 h c 0 d h c d z z 0 0 1 d h c d z 2 d z 2 ξ 0 3 2 0 1 z d h c d z d h c d z d z 2 λ ξ 0 3 2 0 1 h c d h c d z d z 0 finally condition c5b shown below in terms of z is 53 h c 0 d 2 h c d z 2 z 0 2 d h c d z z 0 2 2 λ ξ 0 2 0 after we substitute hc 51 into 52 and 53 we obtain the system of nonlinear algebraic equations given by 50 52 and 53 and we solve it for b c and ξ 0 the numerical solution procedure is the same as in the quadratic case the only difference is that we now have three equations not two as before the value of a is obtained from ξ 0 the results for this approximation are presented in section 5 3 3 adomian polynomial approximate solutions to the four problems moutsopoulos 2009 used adomian polynomials of degree five to approximate solutions to the governing eq 9 for certain boundary conditions see moutsopoulos 2009 for a detailed explanation of the adomian approximation procedure following the same procedure degree two and three adomian approximate solutions can be derived for the four problems described in section 2 in the adomian procedure the solution function h is represented as a power series h ξ i 0 n c i ξ i and recursion relations for the coefficients ci for i 2 are established the first two relations which are sufficient for finding quadratic and cubic approximate solutions are 54 c 2 c 1 2 c 0 λ c 1 1 2 and 55 c 3 1 3 1 5 λ c 1 1 2 c 1 c 0 5 3 c 1 3 c 0 2 λ 2 3 for each problem the unknown coefficients and the wetting front position ξ 0 are found by solving a nonlinear system of equations formed by conditions c2 h ξ 0 0 and c3 d h d ξ ξ ξ 0 ξ 0 2 these equations for the cubic approximate solution functions are shown below for the quadratic approximations c 3 0 56 c 0 c 1 ξ 0 c 2 ξ 0 2 c 3 ξ 0 3 0 57 c 1 2 c 2 ξ 0 3 c 3 ξ 0 2 ξ 0 2 finally the system 56 and 57 is solved using the recurrence relations 54 and 55 and the inlet boundary condition c1 for the power law head problem c 0 1 due to the inlet boundary condition c1a h 0 1 the unknowns c 1 and ξ 0 can then be found for the power law flux problem the inlet boundary condition c1b is h 0 d h d ξ ξ 0 1 this leads to the relation c 0 c 1 1 or equivalently c 1 1 c 0 2 using this relation the unknowns c 0 and ξ 0 can be found 4 numerical solutions we solve the power law head problem 9 and 11 and the power law flux problem 22 and 23 using a modification of shampine s method shampine 1973 telyakovskiy and allen 2006 in this procedure the governing equation is solved numerically as an initial value problem by assuming that ξ 0 1 starting at ξ 0 the equation is solved back towards the inlet ξ 0 to yield a water surface profile to start the calculations we use a taylor series expansion of the solution about ξ 0 1 to step away from ξ 0 toward ξ 0 the taylor series expansion uses values of the derivatives of the solution function at ξ ξ 0 those derivatives are obtained from the governing eq 9 to solve 9 we write it as a first order system of differential equations and a runge kutta method is used since ξ 0 need not be one the intermediate numerical solution described above does not in general match the boundary condition at ξ 0 shampine s method exploits scale invariant properties of the governing equation to produce a solution that matches the inlet boundary condition the intermediate solution is rescaled to force it to satisfy this boundary condition the rescaling process also generates the true value of ξ 0 the details of the rescaling process are discussed below in the power law head problem 9 is invariant with respect to the transformations ξ l 1 3 ξ and h l h when l 0 if h 0 ξ is a solution of 9 then h 1 ξ l 0 h 0 l 0 1 3 ξ is also a solution in particular if h 0 is an intermediate solution such that h 0 1 0 we select l 0 so that h 1 will satisfy the inlet boundary condition c1a for the power law head boundary problem in this case l 0 h 0 0 1 the wetting front position for this problem is obtained by solving for ξ 0 plh in l 0 1 3 ξ 0 p l h 1 therefore ξ 0 p l h h 0 0 1 3 a similar rescaling process can be conducted to generate solutions to the power law flux boundary problem an intermediate solution h 0 to the power law flux problem such that h 0 1 0 can be used alternatively the solution h 1 to the power law head boundary problem can be used for the latter approach let us denote as h 2 the solution of the power law flux problem we rescale h 1 to produce a solution h 2 h 2 ξ l 1 h 1 l 1 1 3 ξ the scaling factor l 1 is selected so that h 2 satisfies the flux boundary condition c1b at the inlet in this case l 1 d h 1 d ξ ξ 0 3 10 the wetting front position is obtained by solving for ξ 0 plf in l 1 1 3 ξ 0 p l f ξ 0 p l h therefore ξ 0 p l f l 1 1 3 ξ 0 p l h numerical results for the power law head and power law flux problems are shown in tabular and graphical forms in section 5 these numerical results are compared with the polynomial approximate solutions 5 comparison of the polynomial approximate and numerical solutions for each of the four problems described above we compare the estimated positions of the dimensionless wetting front ξ 0 with the numerically calculated values these results are shown in tables 1 and 2 we also present the graphs of the polynomial approximate and numerical solutions in figs 2 and 3 the results for the exponential boundary conditions are special cases of the power law results for λ 3 we also show in appendix a how the form of the approximate solutions will change if we use 8 21 as the governing equations instead of 9 22 on which the derivations of sections 2 and 3 were based 5 1 power law head boundary problem the positions of the dimensionless wetting fronts ξ 0 as predicted by shampine s method and by the quadratic and cubic approximate solutions are shown in table 1 for various values of λ the case of λ 3 corresponds to the exponential head condition at the inlet this is the limiting case of the power law head boundary condition as the power law exponent α exact cubic and linear solutions exist for the cases of λ 1 and λ 1 respectively for all of the cases shown both polynomial approximate solutions provide reasonable predictions of the wetting front positions the quadratic and cubic adomian predictions are also shown in table 1 our polynomials produce more accurate predictions of the wetting front positions than the adomian polynomials of the same degrees we note that in moutsopoulos 2009 adomian polynomials of degree five were considered and they provide better estimates of the wetting front positions than our polynomials of lower degree the dimensionless scaling profiles are shown in fig 2 in each case the cubic approximate solution closely agrees with the numerical solution the cubic approximations also reproduce the exact solutions for λ 1 the quadratic polynomial solutions approximate reasonably well the numerical solutions except for the case of λ 1 in which the exact solution is a cubic polynomial overall the cubic approximate solutions match the numerical solutions better than the quadratic approximate solutions the polynomial coefficients for the approximate solutions are tabulated in appendix b a discussion of the difference between flows described by the two term forchheimer equation and those described by the one term forchheimer equation for the fully turbulent case considered in this paper is given in appendix c on this topic some results for the power law head boundary condition are given in moutsopoulos 2009 also in appendix c we present our findings for the case of the exponential head boundary condition 5 2 power law flux boundary problem in table 2 the positions of the dimensionless wetting fronts ξ 0 for various values of λ are shown the case of λ 3 corresponds to the exponential flux condition at the inlet this is the limiting case of the power law flux boundary condition as the power law exponent γ an exact linear solution exists for the case of λ 1 for the cases considered the polynomial approximate solutions provide reasonable predictions of the wetting front positions the cubic approximate solutions provide better estimates of the wetting front positions than the quadratic solutions the quadratic and cubic adomian predictions are also shown in table 2 as with the power law head boundary problem our polynomials produce more accurate predictions of the wetting front positions than the adomian polynomials of the same degree the dimensionless solution curves are shown in fig 3 in each case the cubic approximate solution closely agrees with the numerical solution and the quadratic approximate solution gives slightly worse values the quadratic and cubic approximations also reproduce the exact solution for λ 1 the polynomial coefficients for the approximate solutions are tabulated in appendix b as in the case of the head boundary conditions we analyze the difference between flows described by the two term forchheimer equation and those described by the one term forchheimer equation for the fully turbulent flow for flux boundary conditions our findings for the problems with the flux boundary conditions are given in appendix c 6 summary and conclusions we derived polynomial approximate solutions of a forchheimer groundwater flow equation for four types of boundary conditions at the inlet of a one dimensional initially dry unconfined aquifer the particular form of the forchheimer equation that we utilized represents turbulent flow in the aquifer for power law head and flux conditions at the inlet quadratic and cubic polynomial approximate solutions replicated accurately the numerical solutions of the equation the cubic solutions approximated well the numerical solutions for all cases considered moreover the cubic approximate solutions replicated the three exact solutions the quadratic approximate solutions approximated well the numerical solutions except in the case of a finite redistribution of water λ 1 in this case however the problem has an exact cubic solution the other two exact solutions were replicated by the quadratic approximate solutions the problems with exponential boundary conditions at the inlet were shown to be the limiting cases of the corresponding power law problems as the power law exponents increase without bound using the procedures presented in this work the process of constructing approximate solutions to the nonlinear ordinary differential equation is reduced to solving a nonlinear algebraic equation or system of nonlinear algebraic equations for the wetting front position and polynomial coefficients after these approximations have been constructed they can be used for different values of the constants appearing in the equation and the boundary conditions using a modification of a method of shampine we also numerically solved the equation using a procedure which exploited its scaling properties and showed that these numerical solutions can be validated using low degree polynomials this demonstrates the utility of the approximate solutions for validating numerical solutions when exact solutions do not exist more realistic problems appearing in applications are usually modeled with the more complicated forchheimer type equations the newly derived approximate analytical solutions in this paper can be used to test the validity and accuracy of numerical schemes we note that not many exact solutions are available for this purpose as a result approximate analytical solutions can be used to validate numerical solutions variations of shampine s method and of the methods used for the construction of the polynomial approximate solutions have been previously used with the boussinesq and porous medium equations in the current work the methods were extended to a different type of nonlinear groundwater flow equation the current work and work done for the boussinesq and porous medium equation show that approximate solutions can be constructed using only values of the solution function and its derivatives near the problem boundaries and one integral representing global behavior of the solution this information was sufficient for the polynomials to closely match the numerical solutions as evidenced by the polynomials close agreement to numerical solutions and their replication of the exact solutions finally our polynomials better predicted the wetting front positions than adomian polynomials of the same degree with additional terms the adomian method produces better results as one would expect acknowledgement this research did not receive any specific grant from funding agencies in the public commercial or not for profit sectors the authors thank the editor graham sander for his comments on this paper we also thank konstantinos moutsopoulos and the anonymous reviewer for multiple useful comments and suggestions that improved the quality of this paper appendix a in this appendix we present an alternative set of conditions 4 that can be used to determine the coefficients of the polynomial approximate solutions and the wetting front positions these alternative conditions are derived in the same manner as the original conditions 4 but 8 21 is used in place of 9 22 again c4a was obtained by multiplying 8 by ξ and integrating it over the problem domain while c4b was obtained by only integrating 21 over the problem domain conditions c1a and c1b were used respectively to simplify the forms of c4a and c4b that appear below the other conditions listed in 33 were not changed a 1 c4 a 0 ξ 0 h d h d ξ d ξ λ 2 0 ξ 0 ξ h d ξ 0 b 0 ξ 0 h d ξ 1 1 λ alternative power law head formulation for the power law head condition at the inlet conditions c1a c2 and c3 are used again to write the quadratic and cubic polynomials in normalized form as a 2 h q z ξ 0 3 1 z 1 ξ 0 3 1 z 2 and a 3 h c z ξ 0 3 1 z 1 ξ 0 3 ξ 0 3 c 1 z 2 ξ 0 3 c 1 z 3 where z ξ ξ 0 the alternative condition c4a a 1 can be written in terms of ξ 0 and the normalized variable z as a 4 0 1 h d h d z d z λ 2 ξ 0 3 2 0 1 z h d z 0 solving a 4 with the quadratic hq yields a solution for ξ 0 solving the system consisting of a 4 and c5a 42 with the cubic hc allows one to find c and ξ 0 the values of the coefficients a and b can then be found for the power law head problem the alternative quadratic approximate solution better approximates the wetting front position when λ 1 than the previous quadratic solution however the new solutions yield worse approximations when λ 1 when 9 was used as the governing equation the quadratic approximate solution did give the correct value of ξ 0 up to the specified precision for λ 1 however the alternative quadratic approximate solution did not give the correct value of ξ 0 in this case as shown in table a 1 the alternative cubic solutions produce similar results to those of the original cubic approximate solutions for the power law head problem the comparison is shown in table a 1 alternative power law flux formulation for the power law flux problem conditions c1b c2 and c3 are again used to write the quadratic and cubic polynomials in normalized form as a 5 h q z ξ 0 3 1 z ξ 0 2 b 1 z 2 and a 6 h c z ξ 0 3 1 z ξ 0 2 b 1 z 2 ξ 0 3 c 1 z 3 where z ξ ξ 0 the alternative condition c4b a 1 can be written in terms of ξ 0 and the normalized variable z as a 7 ξ 0 0 1 h d z 1 1 λ solving a 7 and the nonlinear eq 45 for c1b with the quadratic hq yields solutions for ξ 0 and b solving the system consisting of a 7 and conditions c1b and c5b with the cubic hc 50 and 53 allows one to solve for ξ 0 b and c the coefficient a can then be found the alternative formulation of c4b produces similar results to the original formulation but the calculations are somewhat easier appendix b in tables b1 and b2 we present the polynomial coefficients for the approximate solutions to the power law head and power law flux problems the wetting front positions ξ 0 for these problems are shown in tables 1 and 2 appendix c in this appendix we present numerical simulations conducted with the pdepe matlab subroutine for problems ii iii and iv of this paper the parameters for the numerical simulations are in many ways similar to those of moutsopoulos 2009 in his work he showed that fully turbulent flow is more likely to be observed for earlier times than for later times in our numerical results we observed similar phenomena for problems ii iii and iv which were not analyzed in moutsopoulos 2009 in moutsopoulos 2009 only problem i was analyzed for problem ii which represents the exponential head boundary condition at the inlet we did numerical simulations for the times 25 5 and 175 5 seconds we selected s 0 2 a 0 225 s m 1 and b 121 0 s 2 m 2 these parameters are the same as those of moutsopoulos 2009 for the boundary condition we used h 0 1 38 10 1 m and k 0 01 s 1 the results are presented in figs c 1 and c 2 in each figure there are two curves one is for the two term forchheimer equation and the second is for the fully turbulent flow considered in this paper for the power law flux boundary condition we consider flux increasing linearly at the inlet boundary for fully turbulent flow this form of the boundary term corresponds to the linear exact solution shown earlier in this paper the parameters used in this case were γ 1 and τ 3 321 10 3 m 2 s 2 numerical results for two instances of time 98 5 and 3 598 5 seconds are given in figs c 3 and c 4 we selected the same parameters as moutsopoulos 2009 forchheimer s1 means that the two term forchheimer equation was used to represent flux in both the p d e and in the boundary term we used a 0 137 s m 1 and b 1 666 s 2 m 2 the numerical results for the fully turbulent case shown in figs c 3 and c 4 represent the case considered in this paper they do not differ substantially from the forchheimer s2 case also presented in those figures in which the viscous term was significantly smaller than in the s1 case in the s2 case a 0 0137 s m 1 and b 1 666 s 2 m 2 all of these cases represent flow in fractures so s 1 for problem iv which represents the exponential flux boundary condition at the inlet we did similar calculations to those of the power law flux boundary condition the numerical results are presented in figs c 5 and c 6 the meaning of the curves is the same as before the main difference is that one of the times is different instead of 3 958 5 seconds we used 758 5 seconds the value of h 1 3 321 10 3 m 2 s 1 and k 0 01 s 1 we can see that the fully turbulent case over predicts the wetting front position while the two term forchheimer equation gives as expected higher values for the boundary head in the cases where the flux boundary condition is specified this occurs since in addition to the inertial term there is a viscous term in eq 1 that was neglected in the fully turbulent case 
719,transient storage models in combination with tracer tests are widely used to study solute transport dynamics in streams storage parameters included in such models are typically calibrated for one or more study reaches by monitoring solute concentrations and fitting breakthrough curve data since stream characteristics vary spatially and temporally it is challenging to generalize these calibrated parameters for another stream reach this study investigates the ability of simple regression models to predict transient storage parameters such as dispersion coefficient d transient storage area as and storage exchange coefficient α a meta analysis of 834 tracer studies from 67 published papers was used to develop parsimonious non linear regression models that relate storage parameters to easily available stream parameters such as discharge velocity flow width and flow depth correlation analysis showed moderate correlation of d with velocity depth and width and high correlation of as with the ratio of discharge to depth exchange coefficient α did not show significant correlation with available stream parameters the models were tested using a subset of meta analysis data and experimental tracer data from hubbard brook experimental forest located in the us and kielstau catchment located in germany we predicted storage and breakthrough curves with reasonable accuracy r2 0 5 by using new regression equations and incorporating it into an advection dispersion storage model these equations provide a viable alternative to approximate transient storage parameters in circumstances where time and cost intensive reach specific calibration is impossible therefore such regression based estimates of storage parameters can also form an integral part of larger watershed scale models by predicting solute transport and storage in stream reaches keywords transient storage parameters otis regression model solute transport nutrients 1 introduction streams are heterogeneous systems with complex hydrological and ecological dynamics natural and anthropogenic activities may cause pollutants to enter the streams and result in deteriorated water quality these pollutants interact with streambed and streambanks as they get transported downstream understanding solute transport is thus essential for predicting water quality and the associated risks transport models are widely used to forecast the timing and extent of contaminant spills simulate flood responses and characterize export of pollutants during extreme events mueller price et al 2014 ani et al 2009 transient storage models tsm simulate solute transport in streams and rivers bencala and walters 1983 runkel 1998 gooseff et al 2003 kelleher et al 2013 ward et al 2017 besides predicting conservative solute transport these models can also quantify reactive transport which is critical for nutrients and other pollutants edwardson et al 2003 harvey et al 1996 chen et al 2014 garcia et al 2017 the simplest tsm uses a one dimensional advection dispersion reaction equation to route stream solutes along the main channel while exchanging mass with a single transient storage zone the behavior of reactive solutes can then be simulated within the transient storage zone which is a conceptual representation of the immobile zones in a channel including zones associated with slow flow such as pools hyporheic flows boundary layers vegetation etc runkel and broshears 1991 the one dimensional transport with inflow and storage model otis runkel 1998 is one of the most commonly used implementations of tsms that uses finite differences to solve the model equations crank 1979 bencala and walters 1983 sheibley et al 2014 mueller price et al 2016 conservative tracers that do not undergo biochemical reactions are modeled solely using advection dispersion and transient storage exchange processes while reactive solutes are modeled by adding first order decay and sorption parameters this study focuses on transport of all stream solutes and is applicable to both conservative and reactive solutes the four major parameters in the hydraulic otis model dispersion coefficient d stream cross sectional area a storage zone area as and storage exchange coefficient α are either user defined or specifically calibrated for any given stream reach cross sectional area of the stream is usually a known or measured parameter however since it is difficult to directly measure the remaining three parameters tracer experiments are generally conducted to estimate their values wagener and gupta 2005 traditionally tracer tests are conducted by injecting a nonreactive tracer in a stream and measuring a breakthrough curve solute concentration versus time curve downstream for fitting model parameters stream solute workshop 1990 aris 1956 this can be done manually or using the calibration module in otis otis p both of these approaches may result in highly correlated parameter values practically infeasible values and or lead to equifinality issue where other different sets of parameters may yield similar or better fit scott et al 2003 ward et al 2017 therefore it is important to further analyze the model and parameter values for optimality another limitation associated with otis p is that when it does not converge referred to as false convergence due to initial model inputs or lack of sufficient measured data the resulting parameter values are unreliable kelleher et al 2013 considering that tsms are simple models used to represent complex stream processes past studies have recommended the need for major improvements to these models choi et al 2000 runkel 2000 moreover parameter values obtained using tsms usually reflect the magnitude of processes for a given stream reach and may not be applicable to a different reach or even the same reach under different ecohydrologic conditions kelleher et al 2013 in this context alternate metrics such as fmed fraction of median travel time due to transient storage and damkohler number dai were used to quantify and characterize the variability in transient storage exchange across different streams runkel 2002 wagner and harvey 1997 nevertheless for many applications that do not require precise process representation of complex biogeochemical reactions a simple one storage transient storage model like otis can reliably characterize the dominant physical processes choi et al 2000 the primary limitation of using otis for a large scale watershed study with multiple streams is that it requires extensive field experiments and calibration which results in more time and cost associated with these studies alternate methods to estimate transient storage parameters would avoid the need for reach specific calibration past efforts have tried to develop equations and relationships for predicting these parameters most of these studies were focused on developing equations for d using stream parameters like velocity shear velocity flow width and flow depth taylor 1954 elder 1959 fischer 1975 seo and cheong 1998 kashefipour and falconer 2002 deng et al 2001 mcquivey and keefer 1974 disley et al 2015 among these equations fischer s equation is one of the most popular and is used in many water quality models such as qual2e k brown and barnwell 1987 chapra et al 2008 jobson 1996 proposed a method to predict tracer response functions by using prediction equations that relate travel time and dispersion to river characteristics such as unit peak concentration reach slope discharge and drainage area this study attempts to adopt a similar methodology to develop regression equations for all transient storage parameters except cross sectional area which is typically a measured parameter to the best of our knowledge regression based estimates for all storage parameters have not been developed or applied to tsms because of the unique formulation of tsms we must also consider predictive capability for other parameters as and α but very little research has been done in this regard harvey and wagner 2000 have reported that a non linear relationship exists between as and the friction factor based on several tracer studies estimating both friction factor and shear velocity requires precise knowledge of channel slope and bed material which is not often known or measured approximation of channel slope for instance using digital elevation models dem introduces further uncertainty and may result in inaccurate prediction of dispersion coefficient and storage zone area using these methods the value of α is typically small 10 2 10 7 s 1 and it is difficult to estimate its value from correlations harvey and wagner 2000 expressing transient storage parameters in terms of readily available stream characteristics will provide modeling opportunities to users who are unable to conduct tracer tests for otis model calibration this can further enhance options to incorporate tsms in larger watershed scale models without the need for extensive calibration in addition regression based estimates of transient storage parameters are expected to overcome false convergence issues in otis p since regression modeling is based on actual stream variables and does not involve optimization of parameter values in this study we propose new regression equations for transient storage parameters based on a meta analysis of published values parsimonious regression models were developed for predicting transient storage parameters with the minimum number of independent and easily available stream variables specific goals of this study were 1 to develop regression equations for three transient storage parameters d as and α using readily available stream characteristics based on a meta analysis approach 2 to test their effectiveness in predicting parameter values and modeling solute breakthrough curves and 3 determine the accuracy and sensitivity of the parameter values based on expected ranges in stream characteristics the overarching goal of this study is thus to propose a complete solute transport model similar to otis but with no calibration required the proposed equations are not meant to replace the existing experimental parameter calibration but rather aim to provide approximate estimates of storage parameters in cases of data scarcity and help generalize tsms to all stream types 2 methodology we used literature reported otis fitted transient storage parameters to develop regression relationships additionally we validated the relationships using breakthrough curves and fitted parameter sets from 13 stream reaches in a forested catchment hubbard brook experimental forest hbef usa hall et al 2002 and two stream reaches in an agricultural catchment kielstau germany this study fohrer and schmalz 2012 all analyses were completed by replicating the otis algorithm in matlab in the following sections this replica model will be referred as the tsm 2 1 the otis model the otis model simulates solute transport in two zones the main stream channel and the storage zone runkel and broshears 1991 a solute is transported in the main stream channel using advection dispersion lateral inflow transient storage and first order decay fig 1 it uses a finite difference approach to calculate concentration of solute at different times along the stream governing equations ignoring decay and lateral flow components are given in eqs 1 and 2 eq 1 represents the change in solute concentration and processes within the main channel and eq 2 represents the transient storage zone dynamics 1 c t d 2 c x 2 u c x α c s c 2 c s t α a a s c s c where a stream channel cross sectional area m2 as storage zone cross sectional area m2 c in stream solute concentration mass m3 cs storage zone solute concentration mass m3 d dispersion coefficient m2 s q volumetric flowrate m3 s u average flow velocity m s α storage zone exchange coefficient s we used a matlab replica of calibration module in otis known as otis p to calibrate d a as and α based on an observed breakthrough curve obtained using tracer tests many tracer tests have been conducted in the past using both conservative and reactive tracers a meta analysis was done with 67 papers that reported calibrated or measured transient storage parameters based on tracer tests conducted around the world all the papers used for this meta analysis are listed in the supplementary information overall 834 individual parameter sets were logged into a database along with available ancillary data a wide range of parameter values from streams varying in hydrological and geomorphological characteristics were included fig 2 the storage parameters reported in the papers were obtained either using otis p or by using trial and error approach and not necessarily evaluated for optimal models this meta analysis is based on the assumption that the reported values are the best set of parameters for the particular reach in question furthermore the effect of different measurement methods used for measuring hydraulic variables was assumed to be negligible the dataset involves calibrated storage parameters from both pulse and constant rate tracer injection studies storage parameters typically show different sensitivities to these two experiment types with d showing higher sensitivity for pulse injection data and as showing higher sensitivity for constant rate injection data wlostowski et al 2013 however both types of injections were considered in the study to have a reasonable number of data points for both calibration and validation and to propose regression equations that are applicable to both experiment types similar to the otis model we mined the dataset to develop relationships connecting as d and α with independent variables including flow width w flow depth d velocity u discharge q and several combinations of these parameters existing equations to estimate storage parameters indicate that these parameters are rarely linear functions of hydraulic variables fischer 1975 harvey and wagner 2000 therefore transformed variables such as log exponential and inverse were also included in the analysis correlations of d as and α were tested with these independent variables and variables were eliminated if the absolute value of correlation coefficients were 0 1 although shear velocity is frequently reported as an important variable in predicting d it was ignored in our study due to 1 lack of data and 2 uncertainty induced by inaccurate channel slope measurement other channel metrics such as channel roughness or friction factor sinuosity and channel slope were also omitted from the analysis since these variables are not always readily available for many streams especially for large scale studies for each relationship developed only those studies were used which reported all relevant variables we kept the most parsimonious models without compromising on model performance instead of using the entire data for regression analysis the dataset was split randomly into two sets each for calibration and validation equations were first developed using calibration data and then validated for the remaining data our dataset included 309 data points for d 316 points for as and 280 points for α we randomly selected 200 data points for calibrating d and the remaining 109 points were used for validation similarly for as and α the number of calibration points were 200 and 180 respectively and 116 and 100 respectively for validation pearson s correlation coefficients between storage parameters and independent variables were used for approximating initial structure of equations subsequently a manual trial and error method was adopted to optimize the constants in the regression equations using the calibration data set for each storage parameter the widely used performance indicators r2 nash sutcliffe efficiency nse and percent bias pbias were used to choose models with optimum performance past studies that developed regression equations for dispersion coefficient yielded r2 in the range of 0 06 0 86 with fisher equation yielding an r2 of 0 44 disley et al 2015 seo and cheong 1998 power law fit between friction factor and as resulted in an r2 of 0 72 harvey and wagener 2000 considering these statistics we selected our models such that r2 and nse between observed and modeled values were 0 5 using these indicators would result in multiple equations with similar performance due to equifinality issues hence an additional criterion was utilized by visually inspecting scatter plots between observed and modeled parameter values among the best models obtained using performance indicators models that closely matches 1 1 regression line was chosen as the best fitted model in order to test the model for different geographical locations the developed regression models were also validated using two additional sets of tracer test data including breakthrough curves and fitted storage parameters from 1 streams draining forested catchments in the hubbard brook experimental forest hbef hall et al 2002 and 2 streams draining the agricultural kielstau catchment this study hall et al 2002 data was considered suitable for this study since it provided 35 sets of calibrated storage parameters and breakthrough curves generated from tracer experiments conducted in 13 different streams of the hbef in new hampshire usa besides this data would help validate the model for constant rate 1 3 h tracer injection tests experimental data collected from kielstau catchment in germany yielded 4 sets of breakthrough curves and storage parameters from two separate stream reaches detailed explanation of this experimental data is provided in section 2 2 data from hbef and kielstau were used to validate the regression models developed during the meta analysis phase of our study all the observed breakthrough curves were compared to the regression equations predictions we also compared our newly developed regression models for each of the three storage parameters as d and α to relationships commonly reported in the literature for as we used a relationship using friction factor harvey and wagner 2000 see fig 3 and the widely used fischer equation was used for d fischer 1975 see eq 3 shear velocity and friction factor are necessary inputs and were calculated using channel slope approximated from the dems of the corresponding watersheds since field measured values were unavailable 3 d d u 0 011 w d 2 u u 2 where d is dispersion coefficient m2 s d is average depth of flow m u is shear velocity m s w is average stream width m and u is average stream velocity m s since the variability in values of α is very small harvey and wagner 2000 it was hypothesized that a constant value of α will be a reasonable approximation with the available literature data α was normally distributed with a mean value of 3 6 and standard deviation of 0 82 on logarithmic scale fig 4 based on this distribution a value of α 2 5 10 4 s 1 was used to test the hypothesis by replacing the regression equation for α with this constant value besides graphical interpretation of observed and modeled breakthrough curves model performance was evaluated using multiple indicators such as r2 nse and percent bias pbias because parameters are broadly distributed we evaluated the model performance using logarithmic scales of predicted and measured values for better visualization and to avoid large relative error disley et al 2015 kashefipour and falconer 2002 2 2 experimental instream tracer test 2 2 1 study site we conducted four pulse tracer tests in the kielstau catchment fohrer and schmalz 2012 schmalz and fohrer 2010 wagner et al 2018 located in the federal state of schleswig holstein in northern germany fig 5 the kielstau river is 17 km long and the catchment covers an area of about 50 km2 the topography is relatively flat and the land use is predominantly agriculture with cropland 64 and grassland 20 urban 11 forest 3 and water 2 areas at considerable lower proportion the outlet of the watershed is located near the gauging station at soltfeld two instantaneous tracer injections were conducted in two similar order stream reaches towards the outlet of the watershed a a 120 m long reach at soltfeld gauging station and b a 135 m long reach at freienwill fig 5 table 1 freienwill and soltfeld stations have drainage areas of 48 km2 and 50 km2 respectively the experimental locations were chosen considering factors such as storage potential in terms of vegetation meandering nature of streams and accessibility for tracer injection and monitoring fig 6 2 2 2 tracer tests and calibration a salt solution was prepared with 8 kg of sodium chloride nacl and 30 l stream water and injected instantaneously at the upstream point of the reach at the downstream point specific conductivity was measured at 5 s intervals using ysi6600 v2 water quality sonde and salt concentrations calculated based on laboratory calibrations wetted widths during baseflow conditions at the time of the experiments were 3 5 m and 3 7 m at downstream monitoring stations in soltfeld and freienwill respectively at the same locations water depths measured from already installed stream gauges were 0 35 m and 0 4 m respectively table 1 the two tracer tests at freienwill were conducted on the same day during which the measured streamflow was 306 l s tracer tests at soltfeld were conducted on separate days with streamflows of 124 and 183 l s the two tests at freienwill were conducted for the exact same stream conditions to test our equipment and to verify that the observed tracer data is free from measurement errors the background nacl concentrations at soltfeld were 282 mg l and 298 2 mg l for the two test days and at freienwill it was 262 7 and 263 7 mg l since there were no observable seeps or concentrated flow paths along the stream reaches lateral inflow was assumed to be negligible for the short duration of the experiment we used automatic calibration functionality in the tsm model to determine transient storage parameters using the observed breakthrough curves from the two kielstau river reaches four sets of parameters were derived from this experiment for both hbef and kielstau data the fitted parameter values were compared to parameter estimates obtained using regression equations developed in this study besides breakthrough curves simulated using calibrated and estimated parameter values were also compared this was vital to evaluate the ability of regression equations to correctly predict key breakthrough curve characteristics such as peak concentration time to peak and time to return to background 3 results and discussion 3 1 meta analysis pearson s correlation coefficients between transient storage parameters and variables used for regression analysis show that u w and d are significantly correlated with the dispersion coefficient r 0 58 for u 0 37 for w and 0 38 for d p 0 001 table 2 storage zone area was highly correlated with q d and moderately correlated with width r 0 85 for q d and 0 30 for w p 0 001 storage exchange coefficient however had relatively smaller positive correlation with q r 0 31 p 0 001 and insignificant correlation with w and d r 0 11 p 0 06 transformations of variables did not yield better correlation coefficients and hence were ignored for further equation development based on these correlation relationships non linear regression analyses were carried out using various combinations of the correlated variables even though α did not appear to be strongly correlated with the selected variables all the three variables were retained to account for the most possible variance we used a trial and error approach to test different forms of equations based on correlation coefficients the formulae and constants were optimized to arrive at best fitting models using r2 nse and trend line in scatter plot as performance indicators eqs 4 5 and 6 are the newly proposed equations for d as and α 4 d 1 5 u w d 0 5 5 α 0 001 u w d 6 a s 0 1 0 1 w q d 1 2 where u is average velocity m s q is the average stream flow m3 s w is stream width m and d is depth of flow m performance of regression models were evaluated using log log plots of reported parameters versus parameter values using the new equations fig 7 table 3 for dispersion coefficient r2 nse and pbias values were 0 87 0 86 and 9 25 respectively in calibration for validation data equation for d performed equally well with r2 nse and pbias values of 0 86 0 87 and 4 42 respectively regression model for storage zone area yielded a reasonably fair calibration r2 0 74 nse 0 64 pbias 13 4 and validation r2 0 71 nse 0 67 pbias 15 9 considering the previously published r2 values for d and as disley et al 2015 harvey and wagener 2000 these models account for a large portion of the observed variance and could thus approximate storage parameters well equation for α yielded the lowest values of r2 0 52 in calibration 0 46 in validation and nse 0 39 in calibration 0 28 in validation among the three storage parameters this was expected based on the correlation analysis and supports our hypothesis that α is not very sensitive to flow and stream geometry as expected α values are clustered around the mean and the regression line is biased towards this value 3 2 experimental instream tracer test using data collected from tracer tests conducted in kielstau river four breakthrough curves were derived fig 10 the concentration of nacl reached a peak of 126 and 134 mg l above background at soltfeld and 184 and 200 mg l above background at freienwill for the first and second tracer tests respectively the concentrations returned to background conditions in approximately 20 30 min at soltfeld and within 15 min at freienwill the parameters calibrated using tsm showed relatively higher dispersion rate and storage exchange for freienwill compared to the reach at soltfeld storage area however was relatively higher for soltfeld reach table 4 this could be attributed to more geomorphic complexity vegetation large wood in the soltfeld reach data from hall et al 2002 and kielstau experiments were aggregated to get 39 sets of storage parameters a comparison was done using d values obtained using fischer equation as values obtained from friction factor relationship and a constant α value fig 8 for kielstau data our new equations performed relatively well in predicting as but did not perform well in predicting d and α the over prediction of d and under prediction of α with the new equation was possibly due to equifinality of the models as reported by previous researchers harvey and bencala 1993 harvey et al 1996 harvey and wagner 2000 wagener et al 2002 ward et al 2017 this means that several parameter sets can lead to the same model performance and calibrated storage parameters may not be represent intrinsic characteristic of a given stream for this study tsm calibrated values for kielstau were not evaluated in detail and tsm could have possibly generated a different optimal set of parameters with higher d and lower α value as predicted by the new equations for hbef data the new equations resulted in satisfactory prediction of all the three parameters considering the entire experimental dataset our new equation and fischer s equation behaved rather similarly in calculating d fig 8 a however the fischer equation consistently under predicted the low values of d as estimated by our new equation was mostly in agreement with observed values whereas values calculated using the friction factor relationship consistently over predicted as overall comparing observed and simulated values for both kielstau and hbef data the regression models performed well for d with an r2 0 66 nse 0 36 and pbias 17 compared to fischer s equation which yielded an r2 0 6 nse 4 13 and pbias 68 slight decrease in r2 compared to that obtained in calibration is possibly due to the few over predicted values of d in hbef and kielstau for as with the new equation percent bias was reduced to 22 as compared to 44 with friction factor relationship estimating d from fischer s equation and as from friction factor requires precise knowledge of channel slope and approximating the slope from dems may have led to the observed uncertainty this suggests that in situations when channel slope is not well constrained by field measurements predicting d and as using these existing methods may result in over or underestimation while the new regression equation for α seemed to have better predictive power that the constant value fig 8 c both the new equation and constant value yielded similar results in terms of performance indicators nse 0 14 and pbias 5 7 with new equation and nse 0 26 and pbias 5 9 with constant value low values of nse indicate that selected regression variables are not sufficient to explain the small variance in α and additional stream characteristics may influence exchange between main channel and transient storage zone an alternative explanation is that similar performance using both methods is due to little variation observed in range of α values selected therefore in scenarios where exchange coefficient does not vary significantly from the mean value a constant value of 2 5 10 4 s 1 could be used as a fair estimate provided no tracer data is available for precise calibration this supports our hypothesis that a constant α value could be sufficient for predicting transient storage for present test cases representative observed and modeled otis p and new regression equations breakthrough curves from hbef and kielstau catchments show reasonably good prediction fig 9 and 10 in most cases performance indicators were calculated using data points along observed and modeled breakthrough curves out of the 39 cases r2 was 0 75 for 97 of cases nse was 0 75 for 95 of the cases and pbias was within 5 of 77 of the cases our new models largely captured the peaks and dispersion of breakthrough curves in a few cases the curves were not well predicted experiments 16 in fig 9 which we attribute to under prediction of as even though we saw discrepancy in estimated values of α in regression plots fig 7 it does not seem to significantly affect the outcome in terms of breakthrough curves the curves modeled with constant value of α performed similarly to the ones predicted with the regression equation for the 39 test cases r2 values using the two α estimation methods differed very slightly within 0 09 and difference between nse values were within 0 1 slight deviation of breakthrough curves predicted with constant α value and regression equation was observed in a few cases experiments 18 and 29 in fig 9 this small deviation is seen for cases where the constant α value 2 5 10 4 s 1 is significantly different from the values estimated using the regression equation the negligible deviation again supports our hypothesis that a mean α value of 2 5 10 4 s 1 is adequate for predicting breakthrough curves with reasonable accuracy the model was able to capture the peaks well for soltfeld breakthrough curves based on visual observation of kielstau data fig 10 for freienwill there was slight under prediction of peak concentration values the key difference in observed and modeled curves near the recession limb come from low values of exchange coefficient predicted by the regression models although predictions of dispersion coefficients and exchange coefficients for kielstau data by the new equations were not as precise the observed and modeled breakthrough curves matched reasonably well with r2 and nse 0 87 and pbias within 2 for all the four test cases this validated the equifinality issue explained earlier breakthrough curves simulated using calibrated parameter values closely matched the observed curves in all cases due to complete calibration of the model since our study objective was to estimate the storage parameters with simple regression models we did not anticipate perfect fits of observed and modeled breakthrough curves using the new equations rather with our new regression equations we were able to predict the general behavior of solutes traveling through a diverse array of streams with very simple easily measurable attributes based on the outcomes the proposed new regression models does a fair job in approximately predicting the storage parameters especially the dispersion coefficient but cannot completely substitute the experimental calibration using tracer tests just like in any other tsm model before using the modelled parameters values users must cautiously evaluate the results to ensure that the values are reasonable for the stream under consideration 4 conclusions existing equations to calculate dispersion coefficient and storage area require accurate channel slope data and approximating the slope may lead to substantial discrepancies in prediction of d and as values the new regression models developed in this study used readily obtainable flow and channel characteristics including discharge velocity flow width and flow depth as independent variables a meta analysis of past tracer studies data showed that dispersion coefficient transient storage area and storage exchange coefficients have significant correlation with few of these stream parameters we used our regression equations to do forward modeling of breakthrough curves and show generally good agreement between modeled and observed data except for kielstau data when the exchange rate was particularly high α 0 002 performance indicators showed that our newly developed equations can predict d as and α better than other equations and with reasonable accuracy storage exchange coefficient was challenging to model with the available stream parameters indicating that it is either influenced by other factors or ill constrained during optimization a constant mean value of α when used in the tsm predicted the breakthrough curves similarly to the results obtained with the new equations this supported our hypothesis that since variation of α is small a mean value should be a good approximation to model breakthrough curves the fit between observed and a priori modeled breakthrough curves demonstrated that our equations could provide satisfactory approximation of storage parameters in many cases and that our method could thus be used where and when tracer data are not available in predicting storage parameters it is challenging to achieve high level of accuracy using simple regression models the goal of this study hence was to provide preliminary estimates of these parameters for conducting modeling studies where field experiments are impossible the equations proposed in this paper is not intended to replace experiments and calibration and may not yield satisfactory results in studies that require precise estimation of transient storage parameters in addition we did not essentially attempt to predict optimal storage parameters due to lack of sufficient studies reporting the same however these equations can prove useful for research that involves large scale solute transport modeling where parameter approximations are necessary the parsimony of our regression models makes it easy to apply to any existing water quality model where transport with storage is desired acknowledgements funding for this study was provided by united state department of agriculture national institute of food and agriculture regional research project s 1063 we would like to thank dr robert hall for generously sharing the data of tracer tests conducted at hubbard brook experimental forest we would also like to thank johannes fischer oliver tank and the lab staff at kiel university for their help in carrying out the tracer experiments supplementary materials supplementary material associated with this article can be found in the online version at doi 10 1016 j advwatres 2018 11 010 appendix supplementary materials image application 1 
719,transient storage models in combination with tracer tests are widely used to study solute transport dynamics in streams storage parameters included in such models are typically calibrated for one or more study reaches by monitoring solute concentrations and fitting breakthrough curve data since stream characteristics vary spatially and temporally it is challenging to generalize these calibrated parameters for another stream reach this study investigates the ability of simple regression models to predict transient storage parameters such as dispersion coefficient d transient storage area as and storage exchange coefficient α a meta analysis of 834 tracer studies from 67 published papers was used to develop parsimonious non linear regression models that relate storage parameters to easily available stream parameters such as discharge velocity flow width and flow depth correlation analysis showed moderate correlation of d with velocity depth and width and high correlation of as with the ratio of discharge to depth exchange coefficient α did not show significant correlation with available stream parameters the models were tested using a subset of meta analysis data and experimental tracer data from hubbard brook experimental forest located in the us and kielstau catchment located in germany we predicted storage and breakthrough curves with reasonable accuracy r2 0 5 by using new regression equations and incorporating it into an advection dispersion storage model these equations provide a viable alternative to approximate transient storage parameters in circumstances where time and cost intensive reach specific calibration is impossible therefore such regression based estimates of storage parameters can also form an integral part of larger watershed scale models by predicting solute transport and storage in stream reaches keywords transient storage parameters otis regression model solute transport nutrients 1 introduction streams are heterogeneous systems with complex hydrological and ecological dynamics natural and anthropogenic activities may cause pollutants to enter the streams and result in deteriorated water quality these pollutants interact with streambed and streambanks as they get transported downstream understanding solute transport is thus essential for predicting water quality and the associated risks transport models are widely used to forecast the timing and extent of contaminant spills simulate flood responses and characterize export of pollutants during extreme events mueller price et al 2014 ani et al 2009 transient storage models tsm simulate solute transport in streams and rivers bencala and walters 1983 runkel 1998 gooseff et al 2003 kelleher et al 2013 ward et al 2017 besides predicting conservative solute transport these models can also quantify reactive transport which is critical for nutrients and other pollutants edwardson et al 2003 harvey et al 1996 chen et al 2014 garcia et al 2017 the simplest tsm uses a one dimensional advection dispersion reaction equation to route stream solutes along the main channel while exchanging mass with a single transient storage zone the behavior of reactive solutes can then be simulated within the transient storage zone which is a conceptual representation of the immobile zones in a channel including zones associated with slow flow such as pools hyporheic flows boundary layers vegetation etc runkel and broshears 1991 the one dimensional transport with inflow and storage model otis runkel 1998 is one of the most commonly used implementations of tsms that uses finite differences to solve the model equations crank 1979 bencala and walters 1983 sheibley et al 2014 mueller price et al 2016 conservative tracers that do not undergo biochemical reactions are modeled solely using advection dispersion and transient storage exchange processes while reactive solutes are modeled by adding first order decay and sorption parameters this study focuses on transport of all stream solutes and is applicable to both conservative and reactive solutes the four major parameters in the hydraulic otis model dispersion coefficient d stream cross sectional area a storage zone area as and storage exchange coefficient α are either user defined or specifically calibrated for any given stream reach cross sectional area of the stream is usually a known or measured parameter however since it is difficult to directly measure the remaining three parameters tracer experiments are generally conducted to estimate their values wagener and gupta 2005 traditionally tracer tests are conducted by injecting a nonreactive tracer in a stream and measuring a breakthrough curve solute concentration versus time curve downstream for fitting model parameters stream solute workshop 1990 aris 1956 this can be done manually or using the calibration module in otis otis p both of these approaches may result in highly correlated parameter values practically infeasible values and or lead to equifinality issue where other different sets of parameters may yield similar or better fit scott et al 2003 ward et al 2017 therefore it is important to further analyze the model and parameter values for optimality another limitation associated with otis p is that when it does not converge referred to as false convergence due to initial model inputs or lack of sufficient measured data the resulting parameter values are unreliable kelleher et al 2013 considering that tsms are simple models used to represent complex stream processes past studies have recommended the need for major improvements to these models choi et al 2000 runkel 2000 moreover parameter values obtained using tsms usually reflect the magnitude of processes for a given stream reach and may not be applicable to a different reach or even the same reach under different ecohydrologic conditions kelleher et al 2013 in this context alternate metrics such as fmed fraction of median travel time due to transient storage and damkohler number dai were used to quantify and characterize the variability in transient storage exchange across different streams runkel 2002 wagner and harvey 1997 nevertheless for many applications that do not require precise process representation of complex biogeochemical reactions a simple one storage transient storage model like otis can reliably characterize the dominant physical processes choi et al 2000 the primary limitation of using otis for a large scale watershed study with multiple streams is that it requires extensive field experiments and calibration which results in more time and cost associated with these studies alternate methods to estimate transient storage parameters would avoid the need for reach specific calibration past efforts have tried to develop equations and relationships for predicting these parameters most of these studies were focused on developing equations for d using stream parameters like velocity shear velocity flow width and flow depth taylor 1954 elder 1959 fischer 1975 seo and cheong 1998 kashefipour and falconer 2002 deng et al 2001 mcquivey and keefer 1974 disley et al 2015 among these equations fischer s equation is one of the most popular and is used in many water quality models such as qual2e k brown and barnwell 1987 chapra et al 2008 jobson 1996 proposed a method to predict tracer response functions by using prediction equations that relate travel time and dispersion to river characteristics such as unit peak concentration reach slope discharge and drainage area this study attempts to adopt a similar methodology to develop regression equations for all transient storage parameters except cross sectional area which is typically a measured parameter to the best of our knowledge regression based estimates for all storage parameters have not been developed or applied to tsms because of the unique formulation of tsms we must also consider predictive capability for other parameters as and α but very little research has been done in this regard harvey and wagner 2000 have reported that a non linear relationship exists between as and the friction factor based on several tracer studies estimating both friction factor and shear velocity requires precise knowledge of channel slope and bed material which is not often known or measured approximation of channel slope for instance using digital elevation models dem introduces further uncertainty and may result in inaccurate prediction of dispersion coefficient and storage zone area using these methods the value of α is typically small 10 2 10 7 s 1 and it is difficult to estimate its value from correlations harvey and wagner 2000 expressing transient storage parameters in terms of readily available stream characteristics will provide modeling opportunities to users who are unable to conduct tracer tests for otis model calibration this can further enhance options to incorporate tsms in larger watershed scale models without the need for extensive calibration in addition regression based estimates of transient storage parameters are expected to overcome false convergence issues in otis p since regression modeling is based on actual stream variables and does not involve optimization of parameter values in this study we propose new regression equations for transient storage parameters based on a meta analysis of published values parsimonious regression models were developed for predicting transient storage parameters with the minimum number of independent and easily available stream variables specific goals of this study were 1 to develop regression equations for three transient storage parameters d as and α using readily available stream characteristics based on a meta analysis approach 2 to test their effectiveness in predicting parameter values and modeling solute breakthrough curves and 3 determine the accuracy and sensitivity of the parameter values based on expected ranges in stream characteristics the overarching goal of this study is thus to propose a complete solute transport model similar to otis but with no calibration required the proposed equations are not meant to replace the existing experimental parameter calibration but rather aim to provide approximate estimates of storage parameters in cases of data scarcity and help generalize tsms to all stream types 2 methodology we used literature reported otis fitted transient storage parameters to develop regression relationships additionally we validated the relationships using breakthrough curves and fitted parameter sets from 13 stream reaches in a forested catchment hubbard brook experimental forest hbef usa hall et al 2002 and two stream reaches in an agricultural catchment kielstau germany this study fohrer and schmalz 2012 all analyses were completed by replicating the otis algorithm in matlab in the following sections this replica model will be referred as the tsm 2 1 the otis model the otis model simulates solute transport in two zones the main stream channel and the storage zone runkel and broshears 1991 a solute is transported in the main stream channel using advection dispersion lateral inflow transient storage and first order decay fig 1 it uses a finite difference approach to calculate concentration of solute at different times along the stream governing equations ignoring decay and lateral flow components are given in eqs 1 and 2 eq 1 represents the change in solute concentration and processes within the main channel and eq 2 represents the transient storage zone dynamics 1 c t d 2 c x 2 u c x α c s c 2 c s t α a a s c s c where a stream channel cross sectional area m2 as storage zone cross sectional area m2 c in stream solute concentration mass m3 cs storage zone solute concentration mass m3 d dispersion coefficient m2 s q volumetric flowrate m3 s u average flow velocity m s α storage zone exchange coefficient s we used a matlab replica of calibration module in otis known as otis p to calibrate d a as and α based on an observed breakthrough curve obtained using tracer tests many tracer tests have been conducted in the past using both conservative and reactive tracers a meta analysis was done with 67 papers that reported calibrated or measured transient storage parameters based on tracer tests conducted around the world all the papers used for this meta analysis are listed in the supplementary information overall 834 individual parameter sets were logged into a database along with available ancillary data a wide range of parameter values from streams varying in hydrological and geomorphological characteristics were included fig 2 the storage parameters reported in the papers were obtained either using otis p or by using trial and error approach and not necessarily evaluated for optimal models this meta analysis is based on the assumption that the reported values are the best set of parameters for the particular reach in question furthermore the effect of different measurement methods used for measuring hydraulic variables was assumed to be negligible the dataset involves calibrated storage parameters from both pulse and constant rate tracer injection studies storage parameters typically show different sensitivities to these two experiment types with d showing higher sensitivity for pulse injection data and as showing higher sensitivity for constant rate injection data wlostowski et al 2013 however both types of injections were considered in the study to have a reasonable number of data points for both calibration and validation and to propose regression equations that are applicable to both experiment types similar to the otis model we mined the dataset to develop relationships connecting as d and α with independent variables including flow width w flow depth d velocity u discharge q and several combinations of these parameters existing equations to estimate storage parameters indicate that these parameters are rarely linear functions of hydraulic variables fischer 1975 harvey and wagner 2000 therefore transformed variables such as log exponential and inverse were also included in the analysis correlations of d as and α were tested with these independent variables and variables were eliminated if the absolute value of correlation coefficients were 0 1 although shear velocity is frequently reported as an important variable in predicting d it was ignored in our study due to 1 lack of data and 2 uncertainty induced by inaccurate channel slope measurement other channel metrics such as channel roughness or friction factor sinuosity and channel slope were also omitted from the analysis since these variables are not always readily available for many streams especially for large scale studies for each relationship developed only those studies were used which reported all relevant variables we kept the most parsimonious models without compromising on model performance instead of using the entire data for regression analysis the dataset was split randomly into two sets each for calibration and validation equations were first developed using calibration data and then validated for the remaining data our dataset included 309 data points for d 316 points for as and 280 points for α we randomly selected 200 data points for calibrating d and the remaining 109 points were used for validation similarly for as and α the number of calibration points were 200 and 180 respectively and 116 and 100 respectively for validation pearson s correlation coefficients between storage parameters and independent variables were used for approximating initial structure of equations subsequently a manual trial and error method was adopted to optimize the constants in the regression equations using the calibration data set for each storage parameter the widely used performance indicators r2 nash sutcliffe efficiency nse and percent bias pbias were used to choose models with optimum performance past studies that developed regression equations for dispersion coefficient yielded r2 in the range of 0 06 0 86 with fisher equation yielding an r2 of 0 44 disley et al 2015 seo and cheong 1998 power law fit between friction factor and as resulted in an r2 of 0 72 harvey and wagener 2000 considering these statistics we selected our models such that r2 and nse between observed and modeled values were 0 5 using these indicators would result in multiple equations with similar performance due to equifinality issues hence an additional criterion was utilized by visually inspecting scatter plots between observed and modeled parameter values among the best models obtained using performance indicators models that closely matches 1 1 regression line was chosen as the best fitted model in order to test the model for different geographical locations the developed regression models were also validated using two additional sets of tracer test data including breakthrough curves and fitted storage parameters from 1 streams draining forested catchments in the hubbard brook experimental forest hbef hall et al 2002 and 2 streams draining the agricultural kielstau catchment this study hall et al 2002 data was considered suitable for this study since it provided 35 sets of calibrated storage parameters and breakthrough curves generated from tracer experiments conducted in 13 different streams of the hbef in new hampshire usa besides this data would help validate the model for constant rate 1 3 h tracer injection tests experimental data collected from kielstau catchment in germany yielded 4 sets of breakthrough curves and storage parameters from two separate stream reaches detailed explanation of this experimental data is provided in section 2 2 data from hbef and kielstau were used to validate the regression models developed during the meta analysis phase of our study all the observed breakthrough curves were compared to the regression equations predictions we also compared our newly developed regression models for each of the three storage parameters as d and α to relationships commonly reported in the literature for as we used a relationship using friction factor harvey and wagner 2000 see fig 3 and the widely used fischer equation was used for d fischer 1975 see eq 3 shear velocity and friction factor are necessary inputs and were calculated using channel slope approximated from the dems of the corresponding watersheds since field measured values were unavailable 3 d d u 0 011 w d 2 u u 2 where d is dispersion coefficient m2 s d is average depth of flow m u is shear velocity m s w is average stream width m and u is average stream velocity m s since the variability in values of α is very small harvey and wagner 2000 it was hypothesized that a constant value of α will be a reasonable approximation with the available literature data α was normally distributed with a mean value of 3 6 and standard deviation of 0 82 on logarithmic scale fig 4 based on this distribution a value of α 2 5 10 4 s 1 was used to test the hypothesis by replacing the regression equation for α with this constant value besides graphical interpretation of observed and modeled breakthrough curves model performance was evaluated using multiple indicators such as r2 nse and percent bias pbias because parameters are broadly distributed we evaluated the model performance using logarithmic scales of predicted and measured values for better visualization and to avoid large relative error disley et al 2015 kashefipour and falconer 2002 2 2 experimental instream tracer test 2 2 1 study site we conducted four pulse tracer tests in the kielstau catchment fohrer and schmalz 2012 schmalz and fohrer 2010 wagner et al 2018 located in the federal state of schleswig holstein in northern germany fig 5 the kielstau river is 17 km long and the catchment covers an area of about 50 km2 the topography is relatively flat and the land use is predominantly agriculture with cropland 64 and grassland 20 urban 11 forest 3 and water 2 areas at considerable lower proportion the outlet of the watershed is located near the gauging station at soltfeld two instantaneous tracer injections were conducted in two similar order stream reaches towards the outlet of the watershed a a 120 m long reach at soltfeld gauging station and b a 135 m long reach at freienwill fig 5 table 1 freienwill and soltfeld stations have drainage areas of 48 km2 and 50 km2 respectively the experimental locations were chosen considering factors such as storage potential in terms of vegetation meandering nature of streams and accessibility for tracer injection and monitoring fig 6 2 2 2 tracer tests and calibration a salt solution was prepared with 8 kg of sodium chloride nacl and 30 l stream water and injected instantaneously at the upstream point of the reach at the downstream point specific conductivity was measured at 5 s intervals using ysi6600 v2 water quality sonde and salt concentrations calculated based on laboratory calibrations wetted widths during baseflow conditions at the time of the experiments were 3 5 m and 3 7 m at downstream monitoring stations in soltfeld and freienwill respectively at the same locations water depths measured from already installed stream gauges were 0 35 m and 0 4 m respectively table 1 the two tracer tests at freienwill were conducted on the same day during which the measured streamflow was 306 l s tracer tests at soltfeld were conducted on separate days with streamflows of 124 and 183 l s the two tests at freienwill were conducted for the exact same stream conditions to test our equipment and to verify that the observed tracer data is free from measurement errors the background nacl concentrations at soltfeld were 282 mg l and 298 2 mg l for the two test days and at freienwill it was 262 7 and 263 7 mg l since there were no observable seeps or concentrated flow paths along the stream reaches lateral inflow was assumed to be negligible for the short duration of the experiment we used automatic calibration functionality in the tsm model to determine transient storage parameters using the observed breakthrough curves from the two kielstau river reaches four sets of parameters were derived from this experiment for both hbef and kielstau data the fitted parameter values were compared to parameter estimates obtained using regression equations developed in this study besides breakthrough curves simulated using calibrated and estimated parameter values were also compared this was vital to evaluate the ability of regression equations to correctly predict key breakthrough curve characteristics such as peak concentration time to peak and time to return to background 3 results and discussion 3 1 meta analysis pearson s correlation coefficients between transient storage parameters and variables used for regression analysis show that u w and d are significantly correlated with the dispersion coefficient r 0 58 for u 0 37 for w and 0 38 for d p 0 001 table 2 storage zone area was highly correlated with q d and moderately correlated with width r 0 85 for q d and 0 30 for w p 0 001 storage exchange coefficient however had relatively smaller positive correlation with q r 0 31 p 0 001 and insignificant correlation with w and d r 0 11 p 0 06 transformations of variables did not yield better correlation coefficients and hence were ignored for further equation development based on these correlation relationships non linear regression analyses were carried out using various combinations of the correlated variables even though α did not appear to be strongly correlated with the selected variables all the three variables were retained to account for the most possible variance we used a trial and error approach to test different forms of equations based on correlation coefficients the formulae and constants were optimized to arrive at best fitting models using r2 nse and trend line in scatter plot as performance indicators eqs 4 5 and 6 are the newly proposed equations for d as and α 4 d 1 5 u w d 0 5 5 α 0 001 u w d 6 a s 0 1 0 1 w q d 1 2 where u is average velocity m s q is the average stream flow m3 s w is stream width m and d is depth of flow m performance of regression models were evaluated using log log plots of reported parameters versus parameter values using the new equations fig 7 table 3 for dispersion coefficient r2 nse and pbias values were 0 87 0 86 and 9 25 respectively in calibration for validation data equation for d performed equally well with r2 nse and pbias values of 0 86 0 87 and 4 42 respectively regression model for storage zone area yielded a reasonably fair calibration r2 0 74 nse 0 64 pbias 13 4 and validation r2 0 71 nse 0 67 pbias 15 9 considering the previously published r2 values for d and as disley et al 2015 harvey and wagener 2000 these models account for a large portion of the observed variance and could thus approximate storage parameters well equation for α yielded the lowest values of r2 0 52 in calibration 0 46 in validation and nse 0 39 in calibration 0 28 in validation among the three storage parameters this was expected based on the correlation analysis and supports our hypothesis that α is not very sensitive to flow and stream geometry as expected α values are clustered around the mean and the regression line is biased towards this value 3 2 experimental instream tracer test using data collected from tracer tests conducted in kielstau river four breakthrough curves were derived fig 10 the concentration of nacl reached a peak of 126 and 134 mg l above background at soltfeld and 184 and 200 mg l above background at freienwill for the first and second tracer tests respectively the concentrations returned to background conditions in approximately 20 30 min at soltfeld and within 15 min at freienwill the parameters calibrated using tsm showed relatively higher dispersion rate and storage exchange for freienwill compared to the reach at soltfeld storage area however was relatively higher for soltfeld reach table 4 this could be attributed to more geomorphic complexity vegetation large wood in the soltfeld reach data from hall et al 2002 and kielstau experiments were aggregated to get 39 sets of storage parameters a comparison was done using d values obtained using fischer equation as values obtained from friction factor relationship and a constant α value fig 8 for kielstau data our new equations performed relatively well in predicting as but did not perform well in predicting d and α the over prediction of d and under prediction of α with the new equation was possibly due to equifinality of the models as reported by previous researchers harvey and bencala 1993 harvey et al 1996 harvey and wagner 2000 wagener et al 2002 ward et al 2017 this means that several parameter sets can lead to the same model performance and calibrated storage parameters may not be represent intrinsic characteristic of a given stream for this study tsm calibrated values for kielstau were not evaluated in detail and tsm could have possibly generated a different optimal set of parameters with higher d and lower α value as predicted by the new equations for hbef data the new equations resulted in satisfactory prediction of all the three parameters considering the entire experimental dataset our new equation and fischer s equation behaved rather similarly in calculating d fig 8 a however the fischer equation consistently under predicted the low values of d as estimated by our new equation was mostly in agreement with observed values whereas values calculated using the friction factor relationship consistently over predicted as overall comparing observed and simulated values for both kielstau and hbef data the regression models performed well for d with an r2 0 66 nse 0 36 and pbias 17 compared to fischer s equation which yielded an r2 0 6 nse 4 13 and pbias 68 slight decrease in r2 compared to that obtained in calibration is possibly due to the few over predicted values of d in hbef and kielstau for as with the new equation percent bias was reduced to 22 as compared to 44 with friction factor relationship estimating d from fischer s equation and as from friction factor requires precise knowledge of channel slope and approximating the slope from dems may have led to the observed uncertainty this suggests that in situations when channel slope is not well constrained by field measurements predicting d and as using these existing methods may result in over or underestimation while the new regression equation for α seemed to have better predictive power that the constant value fig 8 c both the new equation and constant value yielded similar results in terms of performance indicators nse 0 14 and pbias 5 7 with new equation and nse 0 26 and pbias 5 9 with constant value low values of nse indicate that selected regression variables are not sufficient to explain the small variance in α and additional stream characteristics may influence exchange between main channel and transient storage zone an alternative explanation is that similar performance using both methods is due to little variation observed in range of α values selected therefore in scenarios where exchange coefficient does not vary significantly from the mean value a constant value of 2 5 10 4 s 1 could be used as a fair estimate provided no tracer data is available for precise calibration this supports our hypothesis that a constant α value could be sufficient for predicting transient storage for present test cases representative observed and modeled otis p and new regression equations breakthrough curves from hbef and kielstau catchments show reasonably good prediction fig 9 and 10 in most cases performance indicators were calculated using data points along observed and modeled breakthrough curves out of the 39 cases r2 was 0 75 for 97 of cases nse was 0 75 for 95 of the cases and pbias was within 5 of 77 of the cases our new models largely captured the peaks and dispersion of breakthrough curves in a few cases the curves were not well predicted experiments 16 in fig 9 which we attribute to under prediction of as even though we saw discrepancy in estimated values of α in regression plots fig 7 it does not seem to significantly affect the outcome in terms of breakthrough curves the curves modeled with constant value of α performed similarly to the ones predicted with the regression equation for the 39 test cases r2 values using the two α estimation methods differed very slightly within 0 09 and difference between nse values were within 0 1 slight deviation of breakthrough curves predicted with constant α value and regression equation was observed in a few cases experiments 18 and 29 in fig 9 this small deviation is seen for cases where the constant α value 2 5 10 4 s 1 is significantly different from the values estimated using the regression equation the negligible deviation again supports our hypothesis that a mean α value of 2 5 10 4 s 1 is adequate for predicting breakthrough curves with reasonable accuracy the model was able to capture the peaks well for soltfeld breakthrough curves based on visual observation of kielstau data fig 10 for freienwill there was slight under prediction of peak concentration values the key difference in observed and modeled curves near the recession limb come from low values of exchange coefficient predicted by the regression models although predictions of dispersion coefficients and exchange coefficients for kielstau data by the new equations were not as precise the observed and modeled breakthrough curves matched reasonably well with r2 and nse 0 87 and pbias within 2 for all the four test cases this validated the equifinality issue explained earlier breakthrough curves simulated using calibrated parameter values closely matched the observed curves in all cases due to complete calibration of the model since our study objective was to estimate the storage parameters with simple regression models we did not anticipate perfect fits of observed and modeled breakthrough curves using the new equations rather with our new regression equations we were able to predict the general behavior of solutes traveling through a diverse array of streams with very simple easily measurable attributes based on the outcomes the proposed new regression models does a fair job in approximately predicting the storage parameters especially the dispersion coefficient but cannot completely substitute the experimental calibration using tracer tests just like in any other tsm model before using the modelled parameters values users must cautiously evaluate the results to ensure that the values are reasonable for the stream under consideration 4 conclusions existing equations to calculate dispersion coefficient and storage area require accurate channel slope data and approximating the slope may lead to substantial discrepancies in prediction of d and as values the new regression models developed in this study used readily obtainable flow and channel characteristics including discharge velocity flow width and flow depth as independent variables a meta analysis of past tracer studies data showed that dispersion coefficient transient storage area and storage exchange coefficients have significant correlation with few of these stream parameters we used our regression equations to do forward modeling of breakthrough curves and show generally good agreement between modeled and observed data except for kielstau data when the exchange rate was particularly high α 0 002 performance indicators showed that our newly developed equations can predict d as and α better than other equations and with reasonable accuracy storage exchange coefficient was challenging to model with the available stream parameters indicating that it is either influenced by other factors or ill constrained during optimization a constant mean value of α when used in the tsm predicted the breakthrough curves similarly to the results obtained with the new equations this supported our hypothesis that since variation of α is small a mean value should be a good approximation to model breakthrough curves the fit between observed and a priori modeled breakthrough curves demonstrated that our equations could provide satisfactory approximation of storage parameters in many cases and that our method could thus be used where and when tracer data are not available in predicting storage parameters it is challenging to achieve high level of accuracy using simple regression models the goal of this study hence was to provide preliminary estimates of these parameters for conducting modeling studies where field experiments are impossible the equations proposed in this paper is not intended to replace experiments and calibration and may not yield satisfactory results in studies that require precise estimation of transient storage parameters in addition we did not essentially attempt to predict optimal storage parameters due to lack of sufficient studies reporting the same however these equations can prove useful for research that involves large scale solute transport modeling where parameter approximations are necessary the parsimony of our regression models makes it easy to apply to any existing water quality model where transport with storage is desired acknowledgements funding for this study was provided by united state department of agriculture national institute of food and agriculture regional research project s 1063 we would like to thank dr robert hall for generously sharing the data of tracer tests conducted at hubbard brook experimental forest we would also like to thank johannes fischer oliver tank and the lab staff at kiel university for their help in carrying out the tracer experiments supplementary materials supplementary material associated with this article can be found in the online version at doi 10 1016 j advwatres 2018 11 010 appendix supplementary materials image application 1 
