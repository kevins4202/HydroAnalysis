index,text
26335,deltaic and coastal ecosystems are changing in response to natural and anthropogenic forces that require ecosystem level restoration efforts to avoid habitat degradation or loss models that link ecosystem components of hydrodynamics morphodynamics nutrient and vegetation dynamics to represent essential processes and feedbacks are advancing the field of environmental modeling and are vital to inform coastal restoration decisions an integrated biophysical model was developed by creating a new vegetation dynamics component and linking it to other primary ecosystem components that included essential feedbacks the model performance was evaluated by applying it to a deltaic ecosystem that included marshes and estuaries the integrated biophysical model output captured the general temporal and spatial environmental trends of key variables this integrated model is capable to perform long term simulations to assess responses of deltaic and coastal systems to global change scenarios and can be used to inform restoration strategies in ecosystems worldwide keywords hydrodynamics nutrient dynamics vegetation dynamics morphodynamics global change numerical modeling 1 introduction deltaic and coastal ecosystems worldwide are rapidly changing bianchi and allison 2009 because of natural and anthropogenic activities that produce stressors such as increased nutrient runoff and eutrophication rabalais et al 2009 scheffer et al 2001 rising relative sea levels due to eustatic change and subsidence processes douglas 1991 syvitski et al 2009 as well as anthropogenic alterations to riverine sediment loads syvitski et al 2005 walling and fang 2003 ecosystem response to these stressors include loss of species diversity hooper et al 2012 an increase in harmful algal blooms anderson et al 2002 estuarine and coastal bottom water hypoxia diaz and rosenberg 2008 turner and rabalais 1991 and geomorphological changes such as wetland loss nicholls 2004 tweel and turner 2012 ecosystem responses may also alter ecosystem services to humans barbier et al 2011 changes in ecosystems and its services command the attention of resource managers at agencies that need to make urgent decisions about initiating large scale restoration projects aronson and alexander 2013 calmon et al 2011 lü et al 2012 decision support tools such as science based numerical models are helpful and needed for managers and planners savchuk et al 2012 numerical models can be used to quickly project possible outcomes arising from alternative restoration projects and allow for a science based assessment of whether or not projects are likely to meet their intended goals boesch 2006 reis et al 2015 van maren and cronin 2016 a comprehensive model of ecosystem dynamics is needed that extends the state of the art in two strategic ways the first advancement that is needed is development of a model that incorporates the components of hydrodynamics morphodynamics nutrient dynamics and vegetation dynamics previous models focused on a subset of these major components of a coastal ecosystem some studies focused on the interaction between the flow field and the morphologic processes e g edmonds and slingerland 2010 yuill et al 2016 while others focused on the interaction between hydrodynamics and vegetation dynamics e g collins et al 2004 d alpaos et al 2006 or hydrodynamics and nutrient dynamics e g das et al 2011 smits and van beek 2013 wang et al 2016 many of these linked models represent two or three of the major components of the coastal ecosystem where only one vegetation species is represented alizad et al 2016 or do not consider nutrient dynamics with morphodynamics and vegetation dynamics fagherazzi et al 2012 reyes et al 2000 there are few to no current ecosystem models that couple all four components to represent dynamic biophysical interactions over time the second advancement needed is to include feedbacks among the four main components representing a coastal ecosystem the typical approach when modeling both physical and ecological processes is for information to flow in one direction from the physical models to the ecological models this is based on the assumption that ecological processes do not significantly influence the dynamics of physical systems however plants can alter physical processes in a number of ways for example ecological state variables such as submerged or emergent vegetation can affect hydrodynamics by influencing drag and circulation ganju et al 2015 and in turn hydrodynamics can influence vegetation by producing flooding and salinity regimes that may alter plant community composition to incorporate these feedbacks we designed a model to allow transfer of information from one model to influence the dynamics of the others these feedbacks and components in a model are needed to better represent coastal ecosystems because the landscape is rapidly changing and coastal managers are being asked to make urgent decisions on protecting and restoring the coastlines the main objective for this study was to develop a validated integrated biophysical model that includes dynamic coupling and feedbacks to capture 1 morphological evolution resulting from sediment deposition into wetland areas 2 salinity and nutrient related effects on wetland vegetation soils and the estuarine open water conditions and 3 allow changes in nutrient and vegetation dynamics to affect hydrological and morphological dynamics an integrated state of the art modeling framework delft3d was improved and applied to mississippi river deltaic plain to represent the essential components of the ecosystem including the hydrodynamics morphodynamics nutrient dynamics and vegetation dynamics the hydrodynamics and morphodynamics components were existing delft3d models that were parameterized to represent local conditions the nutrient dynamics were based on the delft3d d waq model with modified algorithms that better reflected the ecology of coastal louisiana the vegetation dynamics component was a combination of an existing delft3d model and newly developed algorithms the existing models are briefly described here since they are extensively covered in literature lesser et al 2004 smits 2013 smits and van beek 2013 while the newly developed vegetation dynamic component is described in detail see also supplementary materials including fig sm1 2 development of integrated biophysical model 2 1 model component overview four main components represent the key receiving estuarine basin processes hydrodynamics morphodynamics vegetation dynamics and nutrient dynamics fig 1 the hydrodynamics component simulated the water salinity and temperature fields driven by tides river flows and time and space varying wind the morphodynamics component accounted for changes in riverine reaches receiving basin elevation and suspended sediment transport including the deltaic growth and decay both the hydrodynamics and morphodynamics components influenced the nutrient dynamics component which included the fate and transport of nutrients to open water sediment soil layers and vegetated areas submerged and emergent of the receiving basin the emergent vegetation component simulated the taxa distribution of the herbaceous marsh vegetation nutrient uptake and growth responses via allocation of above and belowground biomass the vegetation component influences the morphodynamics by trapping sediment while an increase in belowground biomass could additionally lead to an increase in bed levels components were integrated together to represent interactions and feedbacks for evaluating the performance of the integrated biophysical model fig 1 for example the hydrodynamics and nutrient dynamics components were coupled for model assessment of nutrient dynamics morphodynamics component was assessed with the linked hydrodynamics component the hydrodynamics nutrient dynamics and vegetation dynamics components were all linked to calibrate and validate the wetland vegetation processes the integrated biophysical model is composed of several delft3d models that represent the main components the hydrodynamics d flow and morphodynamics d flow sed online are computed with the delft3d flow package a widely used and well validated open source sediment transport model lesser et al 2004 nutrient dynamics including nutrients and phytoplankton biomass were handled by d waq of delft3d the existing vegetation biomass model vegmod within d waq was modified extensively see table 1 to quantify wetland vegetation biomass changes and was coupled with two new vegetation models one of the new models simulated changes in the taxa distribution of wetland vegetation lavegmod dm and the other captured the allocation of the above and belowground biomass lavegmod rootshoot finally this integrated biophysical model was developed and ran by an interdisciplinary team of scientists and engineers from various disciplines ecology geology and hydrology the smaller grey boxes within the hydrodynamics morphodynamics nutrient and vegetation dynamics represent the essential variables fig 1 nutrient dynamics and vegetation biomass diagram was modified from smits 2013 dotted lines indicate that the coupling between components was newly developed see table 1 2 2 general model set up the model domain 80 800 km2 and components were developed and applied to represent the lower mississippi river and its estuarine receiving basins all of which are located south of the city of new orleans la usa the receiving basins barataria and breton basins as well as the mississippi river delta are mainly composed of fresh to saline herbaceous wetlands with interspersed canals and estuarine shallow lakes and bays that drain into the northern gulf of mexico gom see fig 2 some of these estuarine open water areas are already eutrophic from nutrient sources that include local agricultural runoff mississippi river discharge and small sediment poor freshwater diversions caffrey and day 1986 lane et al 2007 lundberg et al 2014 ren et al 2009 the receiving basins are experiencing rapid and extensive wetland loss couvillion et al 2011 that requires large scale restoration efforts sustaining and creating new wetlands via placement of dredged material or proposed sediment diversions on the lower mississippi river are proposed as large scale restoration projects in louisiana s comprehensive master plan for a sustainable coast coastal protection and restoration authority cpra 2012 to represent such a large spatial domain at tractable computational costs the model landscape was subdivided into 14 domains using a domain decomposition technique providing a flexible technique for local grid refinement complex flow fields e g rapid changes to velocities and significant morphological changes are expected to occur near the outfalls of the proposed sediment diversions and therefore the resolution is highest here 100 100 m grid cells the grid resolution was gradually reduced with increasing distance from these outfall areas the total number of grid cells in the model is 334 685 and the largest grid cell size is 4 4 km the model routines were developed in fortran 90 python and c and individual model components were coupled by external matlab scripts see table 2 data sets from multiple sources were used to generate the bathymetry and topography for the hydrodynamic and morphological components these included the 2012 mississippi river channel multibeam bathymetry provided by the u s army corps of engineers usace 2012 lidar data of the breton and barataria basins provided by the u s geological survey usgs 2014 bathymetry data collected by the water institute of the gulf for waterways within the barataria and breton receiving basins and adcirc sl15v9 bathymetry data for the deeper gom e g shelf and slope area all bathymetry data were converted to the navd88 vertical datum expressed in meters m geoid 12a these 14 domains and underlying bathymetry were used by the hydrodynamic model to generate input for the nutrient dynamics vegetation dynamics and morphodynamics components of the model 2 3 feedbacks among coupled models the feedback and dynamic coupling of the various modeling component is one of the key objectives of this effort to represent essential ecosystem processes that influence the landscape the frequency of information passed among the coupled models depends on the nature of the ecosystem process table 2 for example nutrient dynamics are simulated at a 10 min time step to reflect the time sensitivity of the biogeochemistry of the water and sediment soils on the other end of the spectrum the spatial distribution of marsh vegetation is simulated at a one year time step to reflect vegetation succession a sequence of events was developed to allow for information to be passed among the models in order to develop the integrated biophysical model see supplementary materials table sm2 that had two main types of grid resolutions the finer grid of the hydrodynamics model hd grid and the coarse grid of the nutrient dynamics model nd grid in the first step the hydrodynamics and morphodynamics models calculated the parameters such as water elevation velocity salinity temperature sediment load and bed level changes dem change resulting from minerals contributions only for step 2 the water elevation and salinity information on the hd grid are passed to the vegetation species distribution model lavegmod dm that produces the vegetation spatial distribution for each vegetation taxa on the hd grid the third step involves passing essential information to the nutrient dynamics model which include all hydrodynamic information including salinity and temperature and vegetation coverage on the hd grid that are then aggregated into the nd grid the aggregated information is passed to nutrient dynamics model d waq and vegetation dynamics model vegmod to simulate nutrient and vegetation biomass dynamics specifically the vegetation dynamics model vegmod calculates the live and dead vegetation biomass with particulate organic matter pom in the soil layers the next steps involve post processing the information in step 4 the vegetation footprint e g wetland area is adjusted by considering grid cells that only have live vegetation biomass that also influences the pom accumulation distribution caused by vegetation mortality 2 4 hydrodynamics component the hydrodynamics component simulates the hydrodynamics on a curvilinear grid by solving unsteady shallow water equations in two dimensions 2d or three dimensions 3d lesser et al 2004 the greatest emphasis in the integrated biophysical model is on the relatively shallow 0 2 m and vertically mixed water bodies and therefore the model is run in 2d depth averaged mode which means all variables are averaged over the water column no storms including pressure and waves were included in the model the hydrodynamics in the gom were forced by 13 tidal constituents derived from topex poseidon ocean surface elevation data egbert et al 1994 mississippi river inflow discharge was derived from the usgs gauge at baton rouge usgs 07374000 the model also accounted for natural distributaries smaller freshwater diversions e g bonnet carré spillway caernarvon and davis pond in the lower mississippi river and for other rivers entering the modeled area e g amite tickfaw natalbany tangipahoa tchefuncte pearl pascagoula and mobile daily average water discharges were specified for these sources using data from the usgs gauging stations salinity time series boundary conditions were obtained from the national oceanographic data center nodc ocean archive system http www nodc noaa gov cgi bin oc5 gomclimatology gomregcl pl and were enforced at the open boundaries of the gom a spatially and time varying wind field obtained from the national oceanic and atmospheric administration noaa national climatic data center ncdc data portal was specified on a 5 5 km horizontal resolution water temperature was computed with the heat flux model ocean in delft3d flow with a meteorological model driven by relative humidity air temperature and cloud coverage noaa portal with a water temperature constant 25 c open water boundary condition a spatially varying excess rainfall map was based on daily precipitation data noaa based stage iii river forecast center operational nexrad database and monthly average evaporation data international water management institute s world water and climate data atlas iwmi 2014 a base roughness value was set up for the entire model domain open water and marsh areas the effect of vegetation induced friction in the marsh was parameterized with an additional bed roughness term added to the base roughness baptist et al 2007 this trachytope approach uses information on vegetation density stem diameter x number of stems area and the fractional area fa of a cell covered with vegetation see fig 3 vegetation distribution and fractional area per grid cell were provided by the species distribution model lavegmod dm resulting in a dynamic interaction between hydrodynamics and vegetation dynamics 2 5 morphodynamics component the erosion and transport of fine sediment silt clay is computed with the partheniades erosion formulation ariathurai and arulanandan 1978 and the advection diffusion equation lesser et al 2004 these silt and clay fractions are easily erodible with the clay fraction having a lower settling velocity and critical shear stress than the silt transport of sand as suspended load and bed load is computed with the van rijn formulations van rijn 2007a 2007b a stratigraphy model was used to parameterize the subsoil of the morphodynamics component soil cores reveal that the surficial sediment layer thickness of 1 m below navd88 was mostly organic marsh soil meselhe et al 2015 with a critical shear stress for erosion of 1 5 pa no data available based on expert judgment at substrate depths greater than 1 m below navd88 in both breton and barataria receiving basins coring data showed that sediment can be characterized as a consolidated clay the material was assigned a critical erosion shear stress of 4 pa to reflect this most of the open water in the receiving basins has a bed level of 1 1 5 m below navd88 and is therefore assigned the critical erosion shear stress of consolidated clay assuming that the marsh layer had never formed there or had been removed by wave erosion during conversion from marsh to open water this attribution was corroborated by selective coring in both basins of submerged areas sand content dominated the soil layers below the consolidated clay layer 10 m below navd88 and deeper stanley et al 1996 the bed composition in the mississippi river channel was based on a calibrated and validated regional scale river model designed based on field data allison et al 2013 overall five fractions were used in the morphodynamics component 1 a marsh soil fraction representing the top wetland sediment layer 2 consolidated clay representing the second wetland sediment layer 3 fine clay 4 silt representing the suspended sediment load in the mississippi river and 5 coarse sediment sand representing the substrate and suspended sediment load in the mississippi river the morphological update was done at every computational time step 0 5 min in this model application following lesser et al 2004 to reduce the simulation time a morphological acceleration technique was applied where the bed update is scaled with a factor mf at every computational time step roelvink 2006 the time scales associated with the hydrodynamics are typically two orders of magnitude shorter than with the morphodynamics resulting in mf values in the order of 1000 in relatively simple geometries whereas lower values 40 should be used in more complex geometries ranasinghe et al 2010 van der wegen et al 2008 2 6 nutrient dynamics component biogeochemical and ecological processes relevant to the louisiana coast but also to other coastal and deltaic systems e g light attenuation suspended sediment transport and deposition as well as phytoplankton growth and mortality were captured with the nutrient dynamics component fig 1 the water quality processes in the nutrient dynamics component included various biogeochemical transformations via nitrogen phosphorus and carbon pathways and included interactions between the nutrients components organic matter components and the electron acceptors in water and sediment soil smits 2013 smits and van beek 2013 the bloom model simulated phytoplankton growth and mortality smits 2013 given the wide range of salinities 0 20 ppt in the barataria and breton estuaries both freshwater phytoplankton e g chlorophytes diatoms and cyanobacteria including the potentially toxic microcystis spp and anabaena spp and marine phytoplankton e g dinoflagellates were modeled phytoplankton taxa and water quality constituents in the model are listed in table 3 interactions at the sediment soil water interface were simulated using a layered sediment approach smits and van beek 2013 parameterizing the top 40 cm of the sediment soil layer with seven sediment soil depth layers the upper layer was very thin 1 mm and the bottom layer was thicker at 200 mm the initial concentrations of constituents in the sediment soil layers were defined using 2014 and 2015 field data meselhe et al 2015 the water constituents loading was estimated based on discrete usgs water quality data from seven local rivers including the mississippi river the discrete data were used to construct rating curves between the water quality constituent concentrations and flow rates data were not available for all water quality constituents represented in the model thus conversion relationships between water quality constituents with available rating curves were defined to estimate the loading of the remainder of the water quality constituents meselhe et al 2015 2 7 vegetation dynamics component the vegetation dynamics component simulates emergent vegetation biomass production mortality and allocation as well as spatial distribution the formulations of the vegetation dynamics model are described in detail in the supplementary materials including fig sm1 seven emergent marsh vegetation taxa representing fresh intermediate brackish and saline marsh types were selected to represent the wetland conditions table 3 the 2010 land use land cover lulc dataset from the 2012 coastal master plan coastal protection and restoration authority of louisiana 2012 was used to determine the initial vegetated spatial distribution fig 3 shows the percentage vegetation coverage map for year 2010 2 7 1 vegetation biomass the vegetation biomass model vegmod simulates the change in vegetation biomass and includes the effects of nutrient uptake aboveground and belowground growth and mortality of vegetation of seven key representative taxa table 3 the vegetation biomass model from delft3d was extended with a formulation that incorporated 1 a seasonally varying biomass that accounts for the effect of nutrient availability on the total biomass 2 the distribution of the biomass between the aboveground and belowground compartments using the vegetation biomass allocation model 3 the incorporation of senescence turn over mortality and grazing related mortality to the existing mortality related to inundation and 4 the coupling of a vegetation species distribution model with the vegetation biomass model to consider spatial variation of vegetation coverage and taxa the existing vegetation biomass model calculates nutrient uptake and the pool of available nutrients smits 2013 nutrients n p and s are taken up by vegetation from the sediment within the root zone 30 cm the total uptake rates are computed using carbon to nutrient ratios c n c p c s for specific taxa asaeda et al 2002 frost et al 2009 gessner 2000 ket et al 2011 laursen 2004 negrin et al 2012 osgood and zieman 1993 qualls and richardson 2000 richards and ivey 2004 for simplicity the c n c p and c s values do not differ between the above and belowground biomass for each taxa the total uptake rates are distributed among the sediment layers within the rooting zone proportional to the quantities of the nutrients available in the layers mortality decreases the vegetation biomass and transfers living vegetation to particulate detritus fractions the mortality due to inundation was simulated as a first order decay process starting after water level has exceeded a critical depth and a critical duration these thresholds varied by plant taxa in the vegetation biomass model detritus from the aboveground biomass is transferred to the water layers and detritus from the belowground biomass enters the sediment soil layers the detritus release rates are taxa dependent and are based on the c n ratios of a taxa and the fraction of biomass allocated to a water or sediment soil layer this fraction was derived from vegetation height and rooting depth 2 7 2 species distribution of vegetation the louisiana vegetation model lavegmod developed for louisiana s 2012 coastal master plan was modified to provide the dynamics for seven taxa and integrate it with the other components of the delft3d system visser and duke sylvester 2017 visser et al 2013 the establishment and mortality rates that vary with annual mean salinity and the annual standard deviation of water depth were estimated for each of the seven taxa meselhe et al 2015 and the equations and general approach are described in detail in the supplementary materials including fig sm2 an example of an establishment table for spartina alterniflora is shown in table sm1 2 7 3 vegetation biomass allocation plant root shoot allocation is an important ecological process to determine how plants influence the hydrology and nitrogen cycling in wetland areas brouwer 1962 deegan et al 2012 mcconnaughay coleman 1999 overall plants take up nutrients their roots consolidate soils and their stem density can influence flow velocities and trapping of sediment the integrated biophysical model presented here takes an evolutionary perspective for the vegetation biomass allocation model lavegmod rootshoot and assumes that allocating biomass to below versus aboveground growth is a response that maximizes fitness over a range of nutrient concentrations hilbert 1990 johnson et al 1985 reynolds thornley 1982 thornley 1972 when soil nitrogen is abundant there is less demand to produce root biomass because existing root structures can obtain adequate quantities of nitrogen the excess biomass is instead allocated aboveground to increase the capacity for photosynthesis when soil nitrogen is scarce there is an increased demand to allocate resources to root structures to obtain adequate nitrogen needed to sustain growth the vegetation biomass allocation model was run concurrently with the other model components the ratio is then used within the vegetation biomass allocation model to allocate the total vegetation biomass above and belowground the equations and general approach are described in detail in the supplementary materials 3 model performance assessment model sensitivity analysis was conducted via the perturbation and derivatives method pianosi et al 2016 model calibration and validation effort focused on the main stem of the river channel and the receiving basins observations from years 2009 and 2011 were utilized for the calibration and year 2014 for validation for most of the components year 2011 was a wet year in the mississippi river basin with record levels of precipitation resulting in record river stage and flow conditions years 2009 and 2014 were more typical of average flow conditions in the mississippi river 3 1 sensitivity analyses the open water diffusion controls the hydrodynamics in the model delft3d calculates diffusion at the scale of the grid cell to resolve significant mixing that may occur at the sub grid spatial scale delft3d employs a diffusion coefficient parameter that adds a constant mixing rate to that already calculated to occur at the grid cell scale furthermore for depth averaged simulations the diffusion coefficient should also incorporate the dispersion effect caused by vertical flow shear hence the diffusion coefficient is one of the important parameters to adjust during the calibration phase of the hydrodynamics component for sensitivity tests four diffusion coefficient setups were considered 1 uniform value equal to 1 m2 s 1 in the entire domain 2 calibrated spatially variable diffusion coefficient 3 the calibrated spatially variable distribution multiply by 10 one order of magnitude greater 4 calibrated spatially variable distribution divided by 10 one order of magnitude lower hydrodynamic model runs occurred for one year 2010 for existing conditions and for existing conditions with a riverine point source from mississippi river into the mid barataria basin area model results indicate that the saline water barely penetrates into barataria bay when the diffusion coefficient is low uniform 1 or one order of magnitude lower in contrast too much saline water enters barataria bay when the diffusion coefficient was high one order of magnitude greater see supplementary materials figs sm2 and sm3 the perturbation and derivation method of sensitivity analysis was used to finally select the calibrated spatial distribution of diffusion coefficient for the model sensitivity analysis was also performed on the morphodynamic model the median diameter of coarse sediment d50 values of 100 150 200 and 250 μm was perturbed one at a time the impacts on the simulations were assessed via visual inspection by comparing the time series of total sand transport in the mississippi river near belle chasse fig 4 d50 of 200 μm was selected for providing the best agreement with the field data variation of the model output from the nutrient dynamics component was investigated to better understand how light penetration and phytoplankton biomass chl a are influenced by an uncertain model parameter of dissolved organic carbon doc that is mathematically derived from particulate organic carbon poc the parameter b poc2doc was adjusted and compared to field observations from year 2009 to investigate the model output sensitivity fig 5 the value of 0 10 was selected for b poc2doc because it closely aligned with the field data 3 2 calibration and validation the field measurement locations used to calibrate and validate the integrated biophysical model are shown in fig 6 manual tuning was preferred over automatic calibration because of the complexity of the coupled models which resulted in time constraints and computational demands our integrated model requires 24 48 h to complete a single year run attempting to use an automated calibration approach with such long run times was not possible given the time constraints placed on model development and deployment to support management decisions automated calibration algorithms trade the need for deep expertise with a model and its application for a degree of computationally expensive approach in the search for optima automated calibration algorithms can also spend time exploring local optima before finding better parameter combinations in many instances the computationally expensive approach of an automated search is acceptable however the long run time of our model makes that approach involved in automated algorithms impractical instead we applied our own expertise with the model and the ecosystem to guide the calibration process towards appropriate parameter values in a more efficient manner 3 2 1 hydrodynamic component the hydrodynamics component was calibrated against 40 stations measuring salinity water level temperature and velocity the calibration parameters were adjusted by sensitivity analysis until the model results showed reasonable agreement with the data the bed roughness chezy value was the main parameter used in the hydrodynamic calibration validation process and was iteratively adjusted until the simulated and observed data achieved a reasonable agreement the sensitivity of horizontal eddy diffusivity was also tested between the inner domains of the basins and the gulf of mexico the parameters and their ranges used for sensitivity test are listed in table 4 a sample of the model performance evaluations are shown here further details can be found in meselhe et al 2015 for the mississippi river channel the model output of flow and water level were compared to field measurements and fit statistics were performed meselhe and rodrigue 2013 the model results were well correlated with the observed water levels with correlation coefficients ranging between 0 84 and 0 99 fig 7 tables 5 and 6 see meselhe et al 2015 for further details and fit statistics were performed meselhe and rodrigue 2013 in addition comparisons were made for the flow distribution at various overbank and tributaries of the mississippi river delta table 6 against the rating curve data developed from previous studies allison et al 2012 comparison of observed and modeled tidal constituents for years 2009 and 2011 were conducted with 12 noaa stations located in the model domain harmonic analysis was performed on the time series of simulated water level to extract amplitude and phase of four tidal constituents principal lunar semidiurnal cycle m2 the principal solar semidiurnal cycle s2 the combined lunar and solar semidiurnal cycle k1 and lunar diurnal constituent o1 https tidesandcurrents noaa gov glossary html m which are the dominating tides at these stations approximately 50 of total tidal amplitude overall the model predicted the tidal amplitudes and phases well with the difference between the modeled and observed in tidal amplitude ranging between 0 3 cm and 1 4 cm and the difference in the phase ranging between 12 3 and 1 0 table 7 see meselhe et al 2015 for further details the model also captured the overall trend and reproduced the low frequency water level fluctuation resulting from storms and river floods at most of the stations in both basins for the years of 2009 and 2011 see meselhe et al 2015 for further details fig 8 demonstrates an example of the model derived water level comparison against field observations the computed salinity increases from the upper basin to the lower basin in both barataria and breton basins were in agreement with observed data for 2009 2011 and 2014 meselhe et al 2015 the reproduction of the horizontal salinity gradients suggests that the model captured the horizontal mixing of fresh and salt water an example of model results comparison is shown in fig 9 visual inspection of the comparisons and assessment via performance statistics demonstrate that the modeled salinity values correspond reasonably well to observations for most of the stations table 8 water temperature calibration and validation in the barataria and breton basins were performed by comparing the model results to usgs observed data in year 2009 2011 and 2014 meselhe et al 2015 the model represented well the seasonal change in water temperature in this system fig 10 table 9 3 2 2 morphodynamics component the sediment transport and morphology model was calibrated 2011 and validated 2014 with observational data in both riverine and coastal environments the governing processes for sediment dynamics within the mississippi river channel are different from those in the receiving basins for example fine sediments are easily transported and vertically well mixed in the mississippi river because of the high energy and unidirectional flow conversely fine particles are more likely to deposit in low energy areas of the receiving basins especially where vegetation exists calibration parameters for fine sediment includes critical shear stress tcr sediment erosion rate m and settling velocity vs settling velocity and the critical shear stress are the main calibration parameters adjusted in the calibration and validation process table 10 presents a summary of the calibrations parameters for fine sediment with their ranges used in sensitivity tests the computed sediment load was compared to the river s measured load see fig 11 the computed amount of sediment deposited in an existing non controlled sediment diversion west bay see fig 6 for location was compared to observations the computed annual sediment deposition corresponds well with observations fig 12 the discrepancy in the distribution of deposited sediment likely results from wave resuspension which is not represented in this integrated biophysical model 3 2 3 nutrient dynamics component the nutrient dynamics are driven by the flow field salinity and temperature computed in the hydrodynamic model through a direct link with the vegetation biomass model the nutrient dynamics component also simulates the biogeochemical processes for each constituent see table 3 in both the water column and the sediment soil layers the nutrient dynamics component was calibrated and validated by tuning and compared against observations in both basins for years 2009 calibration and 2014 validation model performance was evaluated by graphical comparison between modeled and observed data and statistical analysis i e bias rmse and correlation coefficient initial coefficient values were derived either from the literature or previous studies e g smits and van beek 2013 los 2009 the model calibration parameter values are summarized in table 11 fit statistics were calculated to help assess water quality model performance los and blaas 2010 the model results as shown in table 12 and fig 13 demonstrate that many of the model parameters agree well with the observations for further details see meselhe et al 2015 certain parameters such as chl a nh4 tss tp and po4 need to be improved in future modeling tasks in addition the confidence in the statistical assessment see table 12 of the model performance proves challenging when the sample size of observations are insufficient or small phytoplankton composition of the main phytoplankton groups was compared to summer observational data june and august 2014 data not shown two most common groups of phytoplankton during august were diatoms and chlorophytes and the model tended to reasonably capture these conditions in barataria basin however the model showed some limitation to determine the dominant phytoplankton groups during june and august in breton basin discrepancies between modeled and observed results may be due to the limited local understanding of critical parameters for different phytoplankton groups such as growth rates optimum temperature mortality rates at various salinities etc 3 2 4 vegetation dynamics component the vegetation biomass model simulates plant biomass dynamics for each of the seven taxa used in the model unfortunately there was no observed data for vegetation biomass in 2009 and 2011 vegetation data collected during 2014 meselhe et al 2015 were used as a reference with an assumption that seasonal vegetation biomass changes observed in 2014 are similar to those for 2009 and 2011 aboveground vegetation biomass data were collected at 24 sites 15 crms 5 mbb and 5 mbs sites in 2014 see map in fig 6 in barataria and breton basins and were compared to model results meselhe et al 2015 the vegetation total maximum biomass curves fig 14 vegetation growth and mortality rates for each vegetation taxa were used to calibrate the aboveground vegetation biomass dynamics table 13 lists the coefficients from model calibration vegetation biomass values were compared to observed data collected in 2014 at 24 sites table 14 both observed and simulated biomass values were converted to g c m 2 the correspondence between the model and observed biomass was mixed for site crms0136 fig 15 a which was in breton basin see fig 6 observed data indicated that most of the biomass is represented by sppa 327 g c m 2 with a smaller contribution from spal 53 g c m 2 and from non modeled species 49 g c m 2 like observed results the model predicts a large contribution from sppa 191 g c m 2 however the second tier of biomass contribution predicted by the model is different from observed data fig 15a fig 15b shows a comparison for site 4529 see fig 6 which is in the lower barataria basin the model results at this location correspond well to the observed biomass values the observed biomass totaled 375 g c m 2 and was all invested in a single species s alterniflora spal the vegetation models predicted a total biomass of 269 g c m 2 at this location with most of the biomass being invested in spal three other taxa phragmites spp phau7 s patens sppa and s lancifolia sala were also predicted to be present but they made relatively small contribution to the overall biomass see meselhe et al 2015 for vegetation biomass comparison results for seven vegetation taxa at crms sites in addition more information about the discrepancies can be found in section 4 0 discussion 3 3 coupled hydrodynamics nutrient dynamics and vegetation dynamics components the vegetation dynamics component biomass and species distribution was influenced by the hydrodynamics component through the effects of inundation related stressors to the marsh vegetation biomass as well as the niche characteristics salinity and water level of the vegetation taxa the vegetation height of each of the taxa simulated in biomass model dictates when a critical prescribed threshold of water depth was reached which results in the addition of an inundation mortality rate these processes influence the biomass production of the vegetation fig 16 a the feedbacks between the nutrient dynamics and vegetation dynamics component biomass and species distribution are incorporated into the model because of the importance of soil porewater nutrients to the growth of vegetation biomass and the effects plant nutrient uptake has on the availability of nutrients for other organisms such as phytoplankton in fig 16b during the growing season marsh vegetation spartina patens removes ammonium from the soil porewater and builds aboveground biomass resulting in a depletion of ammonium concentrations this results in an increase in the flux of particulate organic carbon to the top soil layers fig 16c once the vegetation biomass starts to senesce during the fall season the ammonium porewater concentrations return via organic matter remineralization fig 16b and c 3 4 coupled hydrodynamics morphodynamics and vegetation dynamics components as mentioned previously there is a strong bidirectional interaction between vegetation and hydrodynamics to demonstrate the influence of vegetation on the flow field and morphology a model experiment was performed with and without vegetation fig 17 shows the difference in the bed elevation in the simulation experiments with and without vegetation where the areas identified in cold colors reflect the additional sediment deposition due to the presence of vegetation the sediment deposited in the simulation experiment with vegetation would have been transported further out by the flow hence the hot colored areas shown in fig 17 4 discussion human and natural impacts on estuarine ecosystems can be quantified with various models including the effects of hydrodynamics nutrient dynamics vegetation dynamics and morphodynamics such models typically focus on one or few aspects hydrodynamics morphodynamics or vegetation dynamics while oversimplifying or omitting the others wolanski and elliot 2015 the integrated model presented here is a significant advancement in modeling deltaic and coastal systems because a it captures the interaction and feedback among various hydrologic morphologic and ecological processes and b it is applicable to large spatial ecosystems and at a long temporal scale decadal the benefits of using on line two way feedback include better representation of the natural environments because of the dynamic interactions however the limitations of this approach include a computationally heavy model that requires an interdisciplinary team to interact with and interpret its results 4 1 hydrodynamics and morphodynamics components the water levels discharges velocities and salinities at various sites along the lower mississippi river and the receiving basins were well captured further the sediment loads at belle chasse see fig 11 within the mississippi river channel and deposition patterns at the outfall area of the west bay sediment diversion see fig 6 for the location of these stations and areas also compared well against the available information in the literature or field measurements the model performance has been assessed in a quantitative manner using statistical tools defined in meselhe et al 2015 the model results captured the flow distribution through the passes reasonably well table 5 shows the model results and how they compare to data based rating curves in the upper and middle basins the modeled salinities compared well against the observations in the upper and middle of the basins but not as well in the lower portion of the basins this could be attributed to possible salinity stratification that would not be captured with this depth averaged model 2d and due to the scarcity of available open water measurements of salinity there are uncertainties related to the prescribed boundary conditions assigned currently the model includes the influence of wind driven resuspension and tidal circulation and how they redistribute sediment in the receiving basins future model versions should consider assessing the role of waves and weather events e g winter storms also known as cold fronts on redistribution of sediment in coastal areas and erosion of wetlands the model architecture allows a full coupling with the swan wave model but at this stage has not yet been included the impacts of storms including pressure and waves should be considered in future versions of this model because these events can have substantial effects on the wetland vegetation distribution of deposited sediment and morphological features including the physical destruction of storms on vegetated habitats would require a higher frequency of coupling less than annual to incorporate these potential drivers 4 2 nutrient dynamic component the nutrient dynamics component captured the general temporal and spatial nutrient dynamics and the model compared well against most of the field observations including the sediment soil layers in the model helped to represent the important nutrient fluxes between the sediment soil layers and the overlying water column in addition the coupling of the phytoplankton model within the nutrient dynamics model allowed for phytoplankton to respond via composition and biomass to nutrient enrichment and changes in salinity regimes integrating the nutrient dynamic model with a morphodynamic model also allows for investigating the impact of climate change e g sea level rise and subsidence and the associated increase in salinities and temperature on the ecological characteristics of these shallow coastal systems future improvements to the nutrient dynamics model include better representation of chl a nh4 tss tp and po4 concentrations that will likely require additional studies of the boundary conditions offshore point and non point sources fluxes through the estuarine passes as well as atmospheric deposition of nutrients 4 3 vegetation dynamic component the vegetation models were parameterized through field observations and an extensive review of the literature integration the vegetation models allowed for predicting reasonable patterns of species distribution composition and seasonal biomass dynamics driven by nutrients and hydrodynamics overall the predicted aboveground biomass results are encouraging the comparison for sites crms0135 and 4529 fig 15 suggests that the biomass predictions made by the collective action of the three vegetation models species distribution biomass and biomass allocation are consistent with the dynamics of the natural ecosystem at these two locations the dominant species identified by the model was consistent with observed results this suggests that the species distribution predicted by vegetation species distribution model the biomass predicted by vegetation biomass model and the allocation of biomass to aboveground predicted by vegetation biomass allocation model are individually and collectively reasonable while these comparisons do provide insight into performance of the models they must be interpreted with a degree of caution the spatial scale of data collection from the crms sites was not completely compatible with the predictions of the model the data was collected from a single 0 25 m2 quadrat while the models are predicting vegetation dynamics at a 0 25 km2 resolution therefore the model often predicts that a location contains several species on the other hand a single 0 25 m2 field quadrat was not likely to reflect the full diversity in plants found near the plot future work on the vegetation modeling might also include the responses of belowground biomass to wetland soil strength to help better understand how nutrient enrichment might influence erosional properties morris et al 2013 turner 2011 the integrated biophysical model presented here compares well with observations and captures the seasonal patterns of key processes there are still discrepancies between modeled and observed data that will require further improvements on how the various processes interact we recognize the temporal scales of the different components for example only the morphodynamics component is accelerated given the large time scale of sediment processes while the nutrient dynamics hydrodynamics and vegetation dynamics were simulated without the acceleration factor periodically feedbacks among the components were conducted to capture the collective changes to the landscape a sensitivity analysis was conducted on the appropriate acceleration factor to ensure that the morphologic processes were not altered strategic long term data collection is also needed to better understand the temporal and spatial scales and feedback among these key processes for example more measurements are needed to improve the ability of the model to accurately represent how live vegetation biomass is influenced by inundation the rate of biomass loss due to inundation how vegetation stem density affects sediment trapping how nutrient loading influences the vegetation above and belowground biomass and how the morphology of the landscape might be altered by these processes 5 conclusions integrated ecosystem models are advancing to encompass more of the complexity of natural resources because of a demand to better represent ecosystems and projected future conditions and processes of especial importance is capturing feedback among hydrodynamics nutrient dynamics vegetation dynamics and morphodynamics processes such transfer of information back and forth results in a better representation of ecosystems as a whole but have not been well developed for example various hydrodynamic and water quality models representing coastal systems often lack the integration of vegetation dynamics and morphodynamics components static assumptions are often made when the other components are missing such as either ignoring the temporal changes that would influence ecosystem processes or over or under estimating how the ecosystem responds to related environmental drivers the integrated biophysical model presented here advances the field of integrated ecosystem modeling by capturing these essential processes in coastal and deltaic systems that are often undergoing rapid change and need large scale restoration the model shows how salinity and water level variability affect the spatial distribution of vegetation taxa how inundation influences the vegetation biomass how the presence of vegetation results in added flow resistance and potential trapping of mineral sediment how organic matter accretion and mineral sediment deposition sustains wetlands how nutrients availability limitation affect the growth and how hydrodynamic forcings could cause wetland loss through erosion processes this integrated model can be a valuable tool to decision makers worldwide who are planning large scale coastal and deltaic restoration projects software availability name integrated biophysical model within delft3d framework developers ehab meselhe melissa m baustian hoonshin jung scott m duke sylvester jenneke visser dirk sebastiaan van maren johannes smits valesca harezlak michelle jeuken contact information emeselhe thewaterinstitute org hardware required general purpose computer software required mpich2 microsoft visual studio 2010 and intel fortran complier 11 1 or higher python programming language fortran 90 python c availability the models are open source and can be accessed via the repository of deltares http oss deltares nl contact the developers for details acknowledgements this work was supported by louisiana coastal protection and restoration authority cpra under the mississippi river hydrodynamic and delta management study under task order 27 1 the cpra project team provided guidance on the scope of work which included a freeman a feldbaum b vosburg c parsons richards d lindquist e haywood e davoli e jarrell j pahl j wray j favorite j mouton j leblanc s khalil k bollfrass a howard r raynie b gossman j troutman j merrifield k guillory m leadon m turner s langlois m coner r simoneaux j boudreaux b lezina l sharp and b haase acknowledgement goes to a khadka j smits and v harezlak for assistance in developing the model components thank you to the topical experts d justic ecosystem modeling j white biogeochemistry and m hester coastal vegetation ecology who attended work sessions to provide technical input on the data collection efforts as well as the modeling set up development and calibration and validation collecting and processing field and laboratory data required the assistance from many individuals including c perry gulf south research corporation a starr j mathurin louisiana state university lsu e jarrell a freeman a feldbaum cpra t carruthers b yuill k arceneaux b thompson d henson k vernon s matzke c pinsonat j heaton r clark a hijuelos s hemmerling j butler j pereira b garfield a owens k darnell b roth j roberts the water institute of the gulf d di leonardo m ramirez d stephens a cuesta and c esposito tulane university acknowledgement for providing background bathymetry data for planning purposes goes to moffatt nichol lake pontchartrain basin foundation lpbf and thad pratt from the u s army corps of engineers usace engineering research and development center coastal hydraulics laboratory erdc chl much appreciation goes to s piazza u s geological survey usgs d weifenbach cpra and m comeaux usgs for providing information about the coastwide reference monitoring system crms wetlands sites including querying the dominant marsh vegetation for determination of which crms sites to collect vegetation and soil samples acknowledgement goes to the many landowners in the region that gave us permission to sample on their land and to access their canals for the various data collection tasks boat services provided by a daugereaux the ecology center university of louisiana in lafayette ull m farizo delacroix corporation and louisiana universities marine consortium lumcon assisted in reaching some of the wetland and estuarine open water sites the authors thank d reed k costanza t carruthers k darnell k hastings t kimball p lafargue and d weathers for reviewing earlier drafts and anonymous reviewers for excellent input that strengthened this manuscript appendix a supplementary data the following is the supplementary data related to this article multimedia component 1 multimedia component 1 appendix a supplementary data supplementary data related to this article can be found at https doi org 10 1016 j envsoft 2018 05 019 supplementary video related to this article can be found at https doi org 10 1016 j envsoft 2018 05 019 the following is the supplementary data related to this article multimedia component 2 multimedia component 2 multimedia component 3 multimedia component 3 
26335,deltaic and coastal ecosystems are changing in response to natural and anthropogenic forces that require ecosystem level restoration efforts to avoid habitat degradation or loss models that link ecosystem components of hydrodynamics morphodynamics nutrient and vegetation dynamics to represent essential processes and feedbacks are advancing the field of environmental modeling and are vital to inform coastal restoration decisions an integrated biophysical model was developed by creating a new vegetation dynamics component and linking it to other primary ecosystem components that included essential feedbacks the model performance was evaluated by applying it to a deltaic ecosystem that included marshes and estuaries the integrated biophysical model output captured the general temporal and spatial environmental trends of key variables this integrated model is capable to perform long term simulations to assess responses of deltaic and coastal systems to global change scenarios and can be used to inform restoration strategies in ecosystems worldwide keywords hydrodynamics nutrient dynamics vegetation dynamics morphodynamics global change numerical modeling 1 introduction deltaic and coastal ecosystems worldwide are rapidly changing bianchi and allison 2009 because of natural and anthropogenic activities that produce stressors such as increased nutrient runoff and eutrophication rabalais et al 2009 scheffer et al 2001 rising relative sea levels due to eustatic change and subsidence processes douglas 1991 syvitski et al 2009 as well as anthropogenic alterations to riverine sediment loads syvitski et al 2005 walling and fang 2003 ecosystem response to these stressors include loss of species diversity hooper et al 2012 an increase in harmful algal blooms anderson et al 2002 estuarine and coastal bottom water hypoxia diaz and rosenberg 2008 turner and rabalais 1991 and geomorphological changes such as wetland loss nicholls 2004 tweel and turner 2012 ecosystem responses may also alter ecosystem services to humans barbier et al 2011 changes in ecosystems and its services command the attention of resource managers at agencies that need to make urgent decisions about initiating large scale restoration projects aronson and alexander 2013 calmon et al 2011 lü et al 2012 decision support tools such as science based numerical models are helpful and needed for managers and planners savchuk et al 2012 numerical models can be used to quickly project possible outcomes arising from alternative restoration projects and allow for a science based assessment of whether or not projects are likely to meet their intended goals boesch 2006 reis et al 2015 van maren and cronin 2016 a comprehensive model of ecosystem dynamics is needed that extends the state of the art in two strategic ways the first advancement that is needed is development of a model that incorporates the components of hydrodynamics morphodynamics nutrient dynamics and vegetation dynamics previous models focused on a subset of these major components of a coastal ecosystem some studies focused on the interaction between the flow field and the morphologic processes e g edmonds and slingerland 2010 yuill et al 2016 while others focused on the interaction between hydrodynamics and vegetation dynamics e g collins et al 2004 d alpaos et al 2006 or hydrodynamics and nutrient dynamics e g das et al 2011 smits and van beek 2013 wang et al 2016 many of these linked models represent two or three of the major components of the coastal ecosystem where only one vegetation species is represented alizad et al 2016 or do not consider nutrient dynamics with morphodynamics and vegetation dynamics fagherazzi et al 2012 reyes et al 2000 there are few to no current ecosystem models that couple all four components to represent dynamic biophysical interactions over time the second advancement needed is to include feedbacks among the four main components representing a coastal ecosystem the typical approach when modeling both physical and ecological processes is for information to flow in one direction from the physical models to the ecological models this is based on the assumption that ecological processes do not significantly influence the dynamics of physical systems however plants can alter physical processes in a number of ways for example ecological state variables such as submerged or emergent vegetation can affect hydrodynamics by influencing drag and circulation ganju et al 2015 and in turn hydrodynamics can influence vegetation by producing flooding and salinity regimes that may alter plant community composition to incorporate these feedbacks we designed a model to allow transfer of information from one model to influence the dynamics of the others these feedbacks and components in a model are needed to better represent coastal ecosystems because the landscape is rapidly changing and coastal managers are being asked to make urgent decisions on protecting and restoring the coastlines the main objective for this study was to develop a validated integrated biophysical model that includes dynamic coupling and feedbacks to capture 1 morphological evolution resulting from sediment deposition into wetland areas 2 salinity and nutrient related effects on wetland vegetation soils and the estuarine open water conditions and 3 allow changes in nutrient and vegetation dynamics to affect hydrological and morphological dynamics an integrated state of the art modeling framework delft3d was improved and applied to mississippi river deltaic plain to represent the essential components of the ecosystem including the hydrodynamics morphodynamics nutrient dynamics and vegetation dynamics the hydrodynamics and morphodynamics components were existing delft3d models that were parameterized to represent local conditions the nutrient dynamics were based on the delft3d d waq model with modified algorithms that better reflected the ecology of coastal louisiana the vegetation dynamics component was a combination of an existing delft3d model and newly developed algorithms the existing models are briefly described here since they are extensively covered in literature lesser et al 2004 smits 2013 smits and van beek 2013 while the newly developed vegetation dynamic component is described in detail see also supplementary materials including fig sm1 2 development of integrated biophysical model 2 1 model component overview four main components represent the key receiving estuarine basin processes hydrodynamics morphodynamics vegetation dynamics and nutrient dynamics fig 1 the hydrodynamics component simulated the water salinity and temperature fields driven by tides river flows and time and space varying wind the morphodynamics component accounted for changes in riverine reaches receiving basin elevation and suspended sediment transport including the deltaic growth and decay both the hydrodynamics and morphodynamics components influenced the nutrient dynamics component which included the fate and transport of nutrients to open water sediment soil layers and vegetated areas submerged and emergent of the receiving basin the emergent vegetation component simulated the taxa distribution of the herbaceous marsh vegetation nutrient uptake and growth responses via allocation of above and belowground biomass the vegetation component influences the morphodynamics by trapping sediment while an increase in belowground biomass could additionally lead to an increase in bed levels components were integrated together to represent interactions and feedbacks for evaluating the performance of the integrated biophysical model fig 1 for example the hydrodynamics and nutrient dynamics components were coupled for model assessment of nutrient dynamics morphodynamics component was assessed with the linked hydrodynamics component the hydrodynamics nutrient dynamics and vegetation dynamics components were all linked to calibrate and validate the wetland vegetation processes the integrated biophysical model is composed of several delft3d models that represent the main components the hydrodynamics d flow and morphodynamics d flow sed online are computed with the delft3d flow package a widely used and well validated open source sediment transport model lesser et al 2004 nutrient dynamics including nutrients and phytoplankton biomass were handled by d waq of delft3d the existing vegetation biomass model vegmod within d waq was modified extensively see table 1 to quantify wetland vegetation biomass changes and was coupled with two new vegetation models one of the new models simulated changes in the taxa distribution of wetland vegetation lavegmod dm and the other captured the allocation of the above and belowground biomass lavegmod rootshoot finally this integrated biophysical model was developed and ran by an interdisciplinary team of scientists and engineers from various disciplines ecology geology and hydrology the smaller grey boxes within the hydrodynamics morphodynamics nutrient and vegetation dynamics represent the essential variables fig 1 nutrient dynamics and vegetation biomass diagram was modified from smits 2013 dotted lines indicate that the coupling between components was newly developed see table 1 2 2 general model set up the model domain 80 800 km2 and components were developed and applied to represent the lower mississippi river and its estuarine receiving basins all of which are located south of the city of new orleans la usa the receiving basins barataria and breton basins as well as the mississippi river delta are mainly composed of fresh to saline herbaceous wetlands with interspersed canals and estuarine shallow lakes and bays that drain into the northern gulf of mexico gom see fig 2 some of these estuarine open water areas are already eutrophic from nutrient sources that include local agricultural runoff mississippi river discharge and small sediment poor freshwater diversions caffrey and day 1986 lane et al 2007 lundberg et al 2014 ren et al 2009 the receiving basins are experiencing rapid and extensive wetland loss couvillion et al 2011 that requires large scale restoration efforts sustaining and creating new wetlands via placement of dredged material or proposed sediment diversions on the lower mississippi river are proposed as large scale restoration projects in louisiana s comprehensive master plan for a sustainable coast coastal protection and restoration authority cpra 2012 to represent such a large spatial domain at tractable computational costs the model landscape was subdivided into 14 domains using a domain decomposition technique providing a flexible technique for local grid refinement complex flow fields e g rapid changes to velocities and significant morphological changes are expected to occur near the outfalls of the proposed sediment diversions and therefore the resolution is highest here 100 100 m grid cells the grid resolution was gradually reduced with increasing distance from these outfall areas the total number of grid cells in the model is 334 685 and the largest grid cell size is 4 4 km the model routines were developed in fortran 90 python and c and individual model components were coupled by external matlab scripts see table 2 data sets from multiple sources were used to generate the bathymetry and topography for the hydrodynamic and morphological components these included the 2012 mississippi river channel multibeam bathymetry provided by the u s army corps of engineers usace 2012 lidar data of the breton and barataria basins provided by the u s geological survey usgs 2014 bathymetry data collected by the water institute of the gulf for waterways within the barataria and breton receiving basins and adcirc sl15v9 bathymetry data for the deeper gom e g shelf and slope area all bathymetry data were converted to the navd88 vertical datum expressed in meters m geoid 12a these 14 domains and underlying bathymetry were used by the hydrodynamic model to generate input for the nutrient dynamics vegetation dynamics and morphodynamics components of the model 2 3 feedbacks among coupled models the feedback and dynamic coupling of the various modeling component is one of the key objectives of this effort to represent essential ecosystem processes that influence the landscape the frequency of information passed among the coupled models depends on the nature of the ecosystem process table 2 for example nutrient dynamics are simulated at a 10 min time step to reflect the time sensitivity of the biogeochemistry of the water and sediment soils on the other end of the spectrum the spatial distribution of marsh vegetation is simulated at a one year time step to reflect vegetation succession a sequence of events was developed to allow for information to be passed among the models in order to develop the integrated biophysical model see supplementary materials table sm2 that had two main types of grid resolutions the finer grid of the hydrodynamics model hd grid and the coarse grid of the nutrient dynamics model nd grid in the first step the hydrodynamics and morphodynamics models calculated the parameters such as water elevation velocity salinity temperature sediment load and bed level changes dem change resulting from minerals contributions only for step 2 the water elevation and salinity information on the hd grid are passed to the vegetation species distribution model lavegmod dm that produces the vegetation spatial distribution for each vegetation taxa on the hd grid the third step involves passing essential information to the nutrient dynamics model which include all hydrodynamic information including salinity and temperature and vegetation coverage on the hd grid that are then aggregated into the nd grid the aggregated information is passed to nutrient dynamics model d waq and vegetation dynamics model vegmod to simulate nutrient and vegetation biomass dynamics specifically the vegetation dynamics model vegmod calculates the live and dead vegetation biomass with particulate organic matter pom in the soil layers the next steps involve post processing the information in step 4 the vegetation footprint e g wetland area is adjusted by considering grid cells that only have live vegetation biomass that also influences the pom accumulation distribution caused by vegetation mortality 2 4 hydrodynamics component the hydrodynamics component simulates the hydrodynamics on a curvilinear grid by solving unsteady shallow water equations in two dimensions 2d or three dimensions 3d lesser et al 2004 the greatest emphasis in the integrated biophysical model is on the relatively shallow 0 2 m and vertically mixed water bodies and therefore the model is run in 2d depth averaged mode which means all variables are averaged over the water column no storms including pressure and waves were included in the model the hydrodynamics in the gom were forced by 13 tidal constituents derived from topex poseidon ocean surface elevation data egbert et al 1994 mississippi river inflow discharge was derived from the usgs gauge at baton rouge usgs 07374000 the model also accounted for natural distributaries smaller freshwater diversions e g bonnet carré spillway caernarvon and davis pond in the lower mississippi river and for other rivers entering the modeled area e g amite tickfaw natalbany tangipahoa tchefuncte pearl pascagoula and mobile daily average water discharges were specified for these sources using data from the usgs gauging stations salinity time series boundary conditions were obtained from the national oceanographic data center nodc ocean archive system http www nodc noaa gov cgi bin oc5 gomclimatology gomregcl pl and were enforced at the open boundaries of the gom a spatially and time varying wind field obtained from the national oceanic and atmospheric administration noaa national climatic data center ncdc data portal was specified on a 5 5 km horizontal resolution water temperature was computed with the heat flux model ocean in delft3d flow with a meteorological model driven by relative humidity air temperature and cloud coverage noaa portal with a water temperature constant 25 c open water boundary condition a spatially varying excess rainfall map was based on daily precipitation data noaa based stage iii river forecast center operational nexrad database and monthly average evaporation data international water management institute s world water and climate data atlas iwmi 2014 a base roughness value was set up for the entire model domain open water and marsh areas the effect of vegetation induced friction in the marsh was parameterized with an additional bed roughness term added to the base roughness baptist et al 2007 this trachytope approach uses information on vegetation density stem diameter x number of stems area and the fractional area fa of a cell covered with vegetation see fig 3 vegetation distribution and fractional area per grid cell were provided by the species distribution model lavegmod dm resulting in a dynamic interaction between hydrodynamics and vegetation dynamics 2 5 morphodynamics component the erosion and transport of fine sediment silt clay is computed with the partheniades erosion formulation ariathurai and arulanandan 1978 and the advection diffusion equation lesser et al 2004 these silt and clay fractions are easily erodible with the clay fraction having a lower settling velocity and critical shear stress than the silt transport of sand as suspended load and bed load is computed with the van rijn formulations van rijn 2007a 2007b a stratigraphy model was used to parameterize the subsoil of the morphodynamics component soil cores reveal that the surficial sediment layer thickness of 1 m below navd88 was mostly organic marsh soil meselhe et al 2015 with a critical shear stress for erosion of 1 5 pa no data available based on expert judgment at substrate depths greater than 1 m below navd88 in both breton and barataria receiving basins coring data showed that sediment can be characterized as a consolidated clay the material was assigned a critical erosion shear stress of 4 pa to reflect this most of the open water in the receiving basins has a bed level of 1 1 5 m below navd88 and is therefore assigned the critical erosion shear stress of consolidated clay assuming that the marsh layer had never formed there or had been removed by wave erosion during conversion from marsh to open water this attribution was corroborated by selective coring in both basins of submerged areas sand content dominated the soil layers below the consolidated clay layer 10 m below navd88 and deeper stanley et al 1996 the bed composition in the mississippi river channel was based on a calibrated and validated regional scale river model designed based on field data allison et al 2013 overall five fractions were used in the morphodynamics component 1 a marsh soil fraction representing the top wetland sediment layer 2 consolidated clay representing the second wetland sediment layer 3 fine clay 4 silt representing the suspended sediment load in the mississippi river and 5 coarse sediment sand representing the substrate and suspended sediment load in the mississippi river the morphological update was done at every computational time step 0 5 min in this model application following lesser et al 2004 to reduce the simulation time a morphological acceleration technique was applied where the bed update is scaled with a factor mf at every computational time step roelvink 2006 the time scales associated with the hydrodynamics are typically two orders of magnitude shorter than with the morphodynamics resulting in mf values in the order of 1000 in relatively simple geometries whereas lower values 40 should be used in more complex geometries ranasinghe et al 2010 van der wegen et al 2008 2 6 nutrient dynamics component biogeochemical and ecological processes relevant to the louisiana coast but also to other coastal and deltaic systems e g light attenuation suspended sediment transport and deposition as well as phytoplankton growth and mortality were captured with the nutrient dynamics component fig 1 the water quality processes in the nutrient dynamics component included various biogeochemical transformations via nitrogen phosphorus and carbon pathways and included interactions between the nutrients components organic matter components and the electron acceptors in water and sediment soil smits 2013 smits and van beek 2013 the bloom model simulated phytoplankton growth and mortality smits 2013 given the wide range of salinities 0 20 ppt in the barataria and breton estuaries both freshwater phytoplankton e g chlorophytes diatoms and cyanobacteria including the potentially toxic microcystis spp and anabaena spp and marine phytoplankton e g dinoflagellates were modeled phytoplankton taxa and water quality constituents in the model are listed in table 3 interactions at the sediment soil water interface were simulated using a layered sediment approach smits and van beek 2013 parameterizing the top 40 cm of the sediment soil layer with seven sediment soil depth layers the upper layer was very thin 1 mm and the bottom layer was thicker at 200 mm the initial concentrations of constituents in the sediment soil layers were defined using 2014 and 2015 field data meselhe et al 2015 the water constituents loading was estimated based on discrete usgs water quality data from seven local rivers including the mississippi river the discrete data were used to construct rating curves between the water quality constituent concentrations and flow rates data were not available for all water quality constituents represented in the model thus conversion relationships between water quality constituents with available rating curves were defined to estimate the loading of the remainder of the water quality constituents meselhe et al 2015 2 7 vegetation dynamics component the vegetation dynamics component simulates emergent vegetation biomass production mortality and allocation as well as spatial distribution the formulations of the vegetation dynamics model are described in detail in the supplementary materials including fig sm1 seven emergent marsh vegetation taxa representing fresh intermediate brackish and saline marsh types were selected to represent the wetland conditions table 3 the 2010 land use land cover lulc dataset from the 2012 coastal master plan coastal protection and restoration authority of louisiana 2012 was used to determine the initial vegetated spatial distribution fig 3 shows the percentage vegetation coverage map for year 2010 2 7 1 vegetation biomass the vegetation biomass model vegmod simulates the change in vegetation biomass and includes the effects of nutrient uptake aboveground and belowground growth and mortality of vegetation of seven key representative taxa table 3 the vegetation biomass model from delft3d was extended with a formulation that incorporated 1 a seasonally varying biomass that accounts for the effect of nutrient availability on the total biomass 2 the distribution of the biomass between the aboveground and belowground compartments using the vegetation biomass allocation model 3 the incorporation of senescence turn over mortality and grazing related mortality to the existing mortality related to inundation and 4 the coupling of a vegetation species distribution model with the vegetation biomass model to consider spatial variation of vegetation coverage and taxa the existing vegetation biomass model calculates nutrient uptake and the pool of available nutrients smits 2013 nutrients n p and s are taken up by vegetation from the sediment within the root zone 30 cm the total uptake rates are computed using carbon to nutrient ratios c n c p c s for specific taxa asaeda et al 2002 frost et al 2009 gessner 2000 ket et al 2011 laursen 2004 negrin et al 2012 osgood and zieman 1993 qualls and richardson 2000 richards and ivey 2004 for simplicity the c n c p and c s values do not differ between the above and belowground biomass for each taxa the total uptake rates are distributed among the sediment layers within the rooting zone proportional to the quantities of the nutrients available in the layers mortality decreases the vegetation biomass and transfers living vegetation to particulate detritus fractions the mortality due to inundation was simulated as a first order decay process starting after water level has exceeded a critical depth and a critical duration these thresholds varied by plant taxa in the vegetation biomass model detritus from the aboveground biomass is transferred to the water layers and detritus from the belowground biomass enters the sediment soil layers the detritus release rates are taxa dependent and are based on the c n ratios of a taxa and the fraction of biomass allocated to a water or sediment soil layer this fraction was derived from vegetation height and rooting depth 2 7 2 species distribution of vegetation the louisiana vegetation model lavegmod developed for louisiana s 2012 coastal master plan was modified to provide the dynamics for seven taxa and integrate it with the other components of the delft3d system visser and duke sylvester 2017 visser et al 2013 the establishment and mortality rates that vary with annual mean salinity and the annual standard deviation of water depth were estimated for each of the seven taxa meselhe et al 2015 and the equations and general approach are described in detail in the supplementary materials including fig sm2 an example of an establishment table for spartina alterniflora is shown in table sm1 2 7 3 vegetation biomass allocation plant root shoot allocation is an important ecological process to determine how plants influence the hydrology and nitrogen cycling in wetland areas brouwer 1962 deegan et al 2012 mcconnaughay coleman 1999 overall plants take up nutrients their roots consolidate soils and their stem density can influence flow velocities and trapping of sediment the integrated biophysical model presented here takes an evolutionary perspective for the vegetation biomass allocation model lavegmod rootshoot and assumes that allocating biomass to below versus aboveground growth is a response that maximizes fitness over a range of nutrient concentrations hilbert 1990 johnson et al 1985 reynolds thornley 1982 thornley 1972 when soil nitrogen is abundant there is less demand to produce root biomass because existing root structures can obtain adequate quantities of nitrogen the excess biomass is instead allocated aboveground to increase the capacity for photosynthesis when soil nitrogen is scarce there is an increased demand to allocate resources to root structures to obtain adequate nitrogen needed to sustain growth the vegetation biomass allocation model was run concurrently with the other model components the ratio is then used within the vegetation biomass allocation model to allocate the total vegetation biomass above and belowground the equations and general approach are described in detail in the supplementary materials 3 model performance assessment model sensitivity analysis was conducted via the perturbation and derivatives method pianosi et al 2016 model calibration and validation effort focused on the main stem of the river channel and the receiving basins observations from years 2009 and 2011 were utilized for the calibration and year 2014 for validation for most of the components year 2011 was a wet year in the mississippi river basin with record levels of precipitation resulting in record river stage and flow conditions years 2009 and 2014 were more typical of average flow conditions in the mississippi river 3 1 sensitivity analyses the open water diffusion controls the hydrodynamics in the model delft3d calculates diffusion at the scale of the grid cell to resolve significant mixing that may occur at the sub grid spatial scale delft3d employs a diffusion coefficient parameter that adds a constant mixing rate to that already calculated to occur at the grid cell scale furthermore for depth averaged simulations the diffusion coefficient should also incorporate the dispersion effect caused by vertical flow shear hence the diffusion coefficient is one of the important parameters to adjust during the calibration phase of the hydrodynamics component for sensitivity tests four diffusion coefficient setups were considered 1 uniform value equal to 1 m2 s 1 in the entire domain 2 calibrated spatially variable diffusion coefficient 3 the calibrated spatially variable distribution multiply by 10 one order of magnitude greater 4 calibrated spatially variable distribution divided by 10 one order of magnitude lower hydrodynamic model runs occurred for one year 2010 for existing conditions and for existing conditions with a riverine point source from mississippi river into the mid barataria basin area model results indicate that the saline water barely penetrates into barataria bay when the diffusion coefficient is low uniform 1 or one order of magnitude lower in contrast too much saline water enters barataria bay when the diffusion coefficient was high one order of magnitude greater see supplementary materials figs sm2 and sm3 the perturbation and derivation method of sensitivity analysis was used to finally select the calibrated spatial distribution of diffusion coefficient for the model sensitivity analysis was also performed on the morphodynamic model the median diameter of coarse sediment d50 values of 100 150 200 and 250 μm was perturbed one at a time the impacts on the simulations were assessed via visual inspection by comparing the time series of total sand transport in the mississippi river near belle chasse fig 4 d50 of 200 μm was selected for providing the best agreement with the field data variation of the model output from the nutrient dynamics component was investigated to better understand how light penetration and phytoplankton biomass chl a are influenced by an uncertain model parameter of dissolved organic carbon doc that is mathematically derived from particulate organic carbon poc the parameter b poc2doc was adjusted and compared to field observations from year 2009 to investigate the model output sensitivity fig 5 the value of 0 10 was selected for b poc2doc because it closely aligned with the field data 3 2 calibration and validation the field measurement locations used to calibrate and validate the integrated biophysical model are shown in fig 6 manual tuning was preferred over automatic calibration because of the complexity of the coupled models which resulted in time constraints and computational demands our integrated model requires 24 48 h to complete a single year run attempting to use an automated calibration approach with such long run times was not possible given the time constraints placed on model development and deployment to support management decisions automated calibration algorithms trade the need for deep expertise with a model and its application for a degree of computationally expensive approach in the search for optima automated calibration algorithms can also spend time exploring local optima before finding better parameter combinations in many instances the computationally expensive approach of an automated search is acceptable however the long run time of our model makes that approach involved in automated algorithms impractical instead we applied our own expertise with the model and the ecosystem to guide the calibration process towards appropriate parameter values in a more efficient manner 3 2 1 hydrodynamic component the hydrodynamics component was calibrated against 40 stations measuring salinity water level temperature and velocity the calibration parameters were adjusted by sensitivity analysis until the model results showed reasonable agreement with the data the bed roughness chezy value was the main parameter used in the hydrodynamic calibration validation process and was iteratively adjusted until the simulated and observed data achieved a reasonable agreement the sensitivity of horizontal eddy diffusivity was also tested between the inner domains of the basins and the gulf of mexico the parameters and their ranges used for sensitivity test are listed in table 4 a sample of the model performance evaluations are shown here further details can be found in meselhe et al 2015 for the mississippi river channel the model output of flow and water level were compared to field measurements and fit statistics were performed meselhe and rodrigue 2013 the model results were well correlated with the observed water levels with correlation coefficients ranging between 0 84 and 0 99 fig 7 tables 5 and 6 see meselhe et al 2015 for further details and fit statistics were performed meselhe and rodrigue 2013 in addition comparisons were made for the flow distribution at various overbank and tributaries of the mississippi river delta table 6 against the rating curve data developed from previous studies allison et al 2012 comparison of observed and modeled tidal constituents for years 2009 and 2011 were conducted with 12 noaa stations located in the model domain harmonic analysis was performed on the time series of simulated water level to extract amplitude and phase of four tidal constituents principal lunar semidiurnal cycle m2 the principal solar semidiurnal cycle s2 the combined lunar and solar semidiurnal cycle k1 and lunar diurnal constituent o1 https tidesandcurrents noaa gov glossary html m which are the dominating tides at these stations approximately 50 of total tidal amplitude overall the model predicted the tidal amplitudes and phases well with the difference between the modeled and observed in tidal amplitude ranging between 0 3 cm and 1 4 cm and the difference in the phase ranging between 12 3 and 1 0 table 7 see meselhe et al 2015 for further details the model also captured the overall trend and reproduced the low frequency water level fluctuation resulting from storms and river floods at most of the stations in both basins for the years of 2009 and 2011 see meselhe et al 2015 for further details fig 8 demonstrates an example of the model derived water level comparison against field observations the computed salinity increases from the upper basin to the lower basin in both barataria and breton basins were in agreement with observed data for 2009 2011 and 2014 meselhe et al 2015 the reproduction of the horizontal salinity gradients suggests that the model captured the horizontal mixing of fresh and salt water an example of model results comparison is shown in fig 9 visual inspection of the comparisons and assessment via performance statistics demonstrate that the modeled salinity values correspond reasonably well to observations for most of the stations table 8 water temperature calibration and validation in the barataria and breton basins were performed by comparing the model results to usgs observed data in year 2009 2011 and 2014 meselhe et al 2015 the model represented well the seasonal change in water temperature in this system fig 10 table 9 3 2 2 morphodynamics component the sediment transport and morphology model was calibrated 2011 and validated 2014 with observational data in both riverine and coastal environments the governing processes for sediment dynamics within the mississippi river channel are different from those in the receiving basins for example fine sediments are easily transported and vertically well mixed in the mississippi river because of the high energy and unidirectional flow conversely fine particles are more likely to deposit in low energy areas of the receiving basins especially where vegetation exists calibration parameters for fine sediment includes critical shear stress tcr sediment erosion rate m and settling velocity vs settling velocity and the critical shear stress are the main calibration parameters adjusted in the calibration and validation process table 10 presents a summary of the calibrations parameters for fine sediment with their ranges used in sensitivity tests the computed sediment load was compared to the river s measured load see fig 11 the computed amount of sediment deposited in an existing non controlled sediment diversion west bay see fig 6 for location was compared to observations the computed annual sediment deposition corresponds well with observations fig 12 the discrepancy in the distribution of deposited sediment likely results from wave resuspension which is not represented in this integrated biophysical model 3 2 3 nutrient dynamics component the nutrient dynamics are driven by the flow field salinity and temperature computed in the hydrodynamic model through a direct link with the vegetation biomass model the nutrient dynamics component also simulates the biogeochemical processes for each constituent see table 3 in both the water column and the sediment soil layers the nutrient dynamics component was calibrated and validated by tuning and compared against observations in both basins for years 2009 calibration and 2014 validation model performance was evaluated by graphical comparison between modeled and observed data and statistical analysis i e bias rmse and correlation coefficient initial coefficient values were derived either from the literature or previous studies e g smits and van beek 2013 los 2009 the model calibration parameter values are summarized in table 11 fit statistics were calculated to help assess water quality model performance los and blaas 2010 the model results as shown in table 12 and fig 13 demonstrate that many of the model parameters agree well with the observations for further details see meselhe et al 2015 certain parameters such as chl a nh4 tss tp and po4 need to be improved in future modeling tasks in addition the confidence in the statistical assessment see table 12 of the model performance proves challenging when the sample size of observations are insufficient or small phytoplankton composition of the main phytoplankton groups was compared to summer observational data june and august 2014 data not shown two most common groups of phytoplankton during august were diatoms and chlorophytes and the model tended to reasonably capture these conditions in barataria basin however the model showed some limitation to determine the dominant phytoplankton groups during june and august in breton basin discrepancies between modeled and observed results may be due to the limited local understanding of critical parameters for different phytoplankton groups such as growth rates optimum temperature mortality rates at various salinities etc 3 2 4 vegetation dynamics component the vegetation biomass model simulates plant biomass dynamics for each of the seven taxa used in the model unfortunately there was no observed data for vegetation biomass in 2009 and 2011 vegetation data collected during 2014 meselhe et al 2015 were used as a reference with an assumption that seasonal vegetation biomass changes observed in 2014 are similar to those for 2009 and 2011 aboveground vegetation biomass data were collected at 24 sites 15 crms 5 mbb and 5 mbs sites in 2014 see map in fig 6 in barataria and breton basins and were compared to model results meselhe et al 2015 the vegetation total maximum biomass curves fig 14 vegetation growth and mortality rates for each vegetation taxa were used to calibrate the aboveground vegetation biomass dynamics table 13 lists the coefficients from model calibration vegetation biomass values were compared to observed data collected in 2014 at 24 sites table 14 both observed and simulated biomass values were converted to g c m 2 the correspondence between the model and observed biomass was mixed for site crms0136 fig 15 a which was in breton basin see fig 6 observed data indicated that most of the biomass is represented by sppa 327 g c m 2 with a smaller contribution from spal 53 g c m 2 and from non modeled species 49 g c m 2 like observed results the model predicts a large contribution from sppa 191 g c m 2 however the second tier of biomass contribution predicted by the model is different from observed data fig 15a fig 15b shows a comparison for site 4529 see fig 6 which is in the lower barataria basin the model results at this location correspond well to the observed biomass values the observed biomass totaled 375 g c m 2 and was all invested in a single species s alterniflora spal the vegetation models predicted a total biomass of 269 g c m 2 at this location with most of the biomass being invested in spal three other taxa phragmites spp phau7 s patens sppa and s lancifolia sala were also predicted to be present but they made relatively small contribution to the overall biomass see meselhe et al 2015 for vegetation biomass comparison results for seven vegetation taxa at crms sites in addition more information about the discrepancies can be found in section 4 0 discussion 3 3 coupled hydrodynamics nutrient dynamics and vegetation dynamics components the vegetation dynamics component biomass and species distribution was influenced by the hydrodynamics component through the effects of inundation related stressors to the marsh vegetation biomass as well as the niche characteristics salinity and water level of the vegetation taxa the vegetation height of each of the taxa simulated in biomass model dictates when a critical prescribed threshold of water depth was reached which results in the addition of an inundation mortality rate these processes influence the biomass production of the vegetation fig 16 a the feedbacks between the nutrient dynamics and vegetation dynamics component biomass and species distribution are incorporated into the model because of the importance of soil porewater nutrients to the growth of vegetation biomass and the effects plant nutrient uptake has on the availability of nutrients for other organisms such as phytoplankton in fig 16b during the growing season marsh vegetation spartina patens removes ammonium from the soil porewater and builds aboveground biomass resulting in a depletion of ammonium concentrations this results in an increase in the flux of particulate organic carbon to the top soil layers fig 16c once the vegetation biomass starts to senesce during the fall season the ammonium porewater concentrations return via organic matter remineralization fig 16b and c 3 4 coupled hydrodynamics morphodynamics and vegetation dynamics components as mentioned previously there is a strong bidirectional interaction between vegetation and hydrodynamics to demonstrate the influence of vegetation on the flow field and morphology a model experiment was performed with and without vegetation fig 17 shows the difference in the bed elevation in the simulation experiments with and without vegetation where the areas identified in cold colors reflect the additional sediment deposition due to the presence of vegetation the sediment deposited in the simulation experiment with vegetation would have been transported further out by the flow hence the hot colored areas shown in fig 17 4 discussion human and natural impacts on estuarine ecosystems can be quantified with various models including the effects of hydrodynamics nutrient dynamics vegetation dynamics and morphodynamics such models typically focus on one or few aspects hydrodynamics morphodynamics or vegetation dynamics while oversimplifying or omitting the others wolanski and elliot 2015 the integrated model presented here is a significant advancement in modeling deltaic and coastal systems because a it captures the interaction and feedback among various hydrologic morphologic and ecological processes and b it is applicable to large spatial ecosystems and at a long temporal scale decadal the benefits of using on line two way feedback include better representation of the natural environments because of the dynamic interactions however the limitations of this approach include a computationally heavy model that requires an interdisciplinary team to interact with and interpret its results 4 1 hydrodynamics and morphodynamics components the water levels discharges velocities and salinities at various sites along the lower mississippi river and the receiving basins were well captured further the sediment loads at belle chasse see fig 11 within the mississippi river channel and deposition patterns at the outfall area of the west bay sediment diversion see fig 6 for the location of these stations and areas also compared well against the available information in the literature or field measurements the model performance has been assessed in a quantitative manner using statistical tools defined in meselhe et al 2015 the model results captured the flow distribution through the passes reasonably well table 5 shows the model results and how they compare to data based rating curves in the upper and middle basins the modeled salinities compared well against the observations in the upper and middle of the basins but not as well in the lower portion of the basins this could be attributed to possible salinity stratification that would not be captured with this depth averaged model 2d and due to the scarcity of available open water measurements of salinity there are uncertainties related to the prescribed boundary conditions assigned currently the model includes the influence of wind driven resuspension and tidal circulation and how they redistribute sediment in the receiving basins future model versions should consider assessing the role of waves and weather events e g winter storms also known as cold fronts on redistribution of sediment in coastal areas and erosion of wetlands the model architecture allows a full coupling with the swan wave model but at this stage has not yet been included the impacts of storms including pressure and waves should be considered in future versions of this model because these events can have substantial effects on the wetland vegetation distribution of deposited sediment and morphological features including the physical destruction of storms on vegetated habitats would require a higher frequency of coupling less than annual to incorporate these potential drivers 4 2 nutrient dynamic component the nutrient dynamics component captured the general temporal and spatial nutrient dynamics and the model compared well against most of the field observations including the sediment soil layers in the model helped to represent the important nutrient fluxes between the sediment soil layers and the overlying water column in addition the coupling of the phytoplankton model within the nutrient dynamics model allowed for phytoplankton to respond via composition and biomass to nutrient enrichment and changes in salinity regimes integrating the nutrient dynamic model with a morphodynamic model also allows for investigating the impact of climate change e g sea level rise and subsidence and the associated increase in salinities and temperature on the ecological characteristics of these shallow coastal systems future improvements to the nutrient dynamics model include better representation of chl a nh4 tss tp and po4 concentrations that will likely require additional studies of the boundary conditions offshore point and non point sources fluxes through the estuarine passes as well as atmospheric deposition of nutrients 4 3 vegetation dynamic component the vegetation models were parameterized through field observations and an extensive review of the literature integration the vegetation models allowed for predicting reasonable patterns of species distribution composition and seasonal biomass dynamics driven by nutrients and hydrodynamics overall the predicted aboveground biomass results are encouraging the comparison for sites crms0135 and 4529 fig 15 suggests that the biomass predictions made by the collective action of the three vegetation models species distribution biomass and biomass allocation are consistent with the dynamics of the natural ecosystem at these two locations the dominant species identified by the model was consistent with observed results this suggests that the species distribution predicted by vegetation species distribution model the biomass predicted by vegetation biomass model and the allocation of biomass to aboveground predicted by vegetation biomass allocation model are individually and collectively reasonable while these comparisons do provide insight into performance of the models they must be interpreted with a degree of caution the spatial scale of data collection from the crms sites was not completely compatible with the predictions of the model the data was collected from a single 0 25 m2 quadrat while the models are predicting vegetation dynamics at a 0 25 km2 resolution therefore the model often predicts that a location contains several species on the other hand a single 0 25 m2 field quadrat was not likely to reflect the full diversity in plants found near the plot future work on the vegetation modeling might also include the responses of belowground biomass to wetland soil strength to help better understand how nutrient enrichment might influence erosional properties morris et al 2013 turner 2011 the integrated biophysical model presented here compares well with observations and captures the seasonal patterns of key processes there are still discrepancies between modeled and observed data that will require further improvements on how the various processes interact we recognize the temporal scales of the different components for example only the morphodynamics component is accelerated given the large time scale of sediment processes while the nutrient dynamics hydrodynamics and vegetation dynamics were simulated without the acceleration factor periodically feedbacks among the components were conducted to capture the collective changes to the landscape a sensitivity analysis was conducted on the appropriate acceleration factor to ensure that the morphologic processes were not altered strategic long term data collection is also needed to better understand the temporal and spatial scales and feedback among these key processes for example more measurements are needed to improve the ability of the model to accurately represent how live vegetation biomass is influenced by inundation the rate of biomass loss due to inundation how vegetation stem density affects sediment trapping how nutrient loading influences the vegetation above and belowground biomass and how the morphology of the landscape might be altered by these processes 5 conclusions integrated ecosystem models are advancing to encompass more of the complexity of natural resources because of a demand to better represent ecosystems and projected future conditions and processes of especial importance is capturing feedback among hydrodynamics nutrient dynamics vegetation dynamics and morphodynamics processes such transfer of information back and forth results in a better representation of ecosystems as a whole but have not been well developed for example various hydrodynamic and water quality models representing coastal systems often lack the integration of vegetation dynamics and morphodynamics components static assumptions are often made when the other components are missing such as either ignoring the temporal changes that would influence ecosystem processes or over or under estimating how the ecosystem responds to related environmental drivers the integrated biophysical model presented here advances the field of integrated ecosystem modeling by capturing these essential processes in coastal and deltaic systems that are often undergoing rapid change and need large scale restoration the model shows how salinity and water level variability affect the spatial distribution of vegetation taxa how inundation influences the vegetation biomass how the presence of vegetation results in added flow resistance and potential trapping of mineral sediment how organic matter accretion and mineral sediment deposition sustains wetlands how nutrients availability limitation affect the growth and how hydrodynamic forcings could cause wetland loss through erosion processes this integrated model can be a valuable tool to decision makers worldwide who are planning large scale coastal and deltaic restoration projects software availability name integrated biophysical model within delft3d framework developers ehab meselhe melissa m baustian hoonshin jung scott m duke sylvester jenneke visser dirk sebastiaan van maren johannes smits valesca harezlak michelle jeuken contact information emeselhe thewaterinstitute org hardware required general purpose computer software required mpich2 microsoft visual studio 2010 and intel fortran complier 11 1 or higher python programming language fortran 90 python c availability the models are open source and can be accessed via the repository of deltares http oss deltares nl contact the developers for details acknowledgements this work was supported by louisiana coastal protection and restoration authority cpra under the mississippi river hydrodynamic and delta management study under task order 27 1 the cpra project team provided guidance on the scope of work which included a freeman a feldbaum b vosburg c parsons richards d lindquist e haywood e davoli e jarrell j pahl j wray j favorite j mouton j leblanc s khalil k bollfrass a howard r raynie b gossman j troutman j merrifield k guillory m leadon m turner s langlois m coner r simoneaux j boudreaux b lezina l sharp and b haase acknowledgement goes to a khadka j smits and v harezlak for assistance in developing the model components thank you to the topical experts d justic ecosystem modeling j white biogeochemistry and m hester coastal vegetation ecology who attended work sessions to provide technical input on the data collection efforts as well as the modeling set up development and calibration and validation collecting and processing field and laboratory data required the assistance from many individuals including c perry gulf south research corporation a starr j mathurin louisiana state university lsu e jarrell a freeman a feldbaum cpra t carruthers b yuill k arceneaux b thompson d henson k vernon s matzke c pinsonat j heaton r clark a hijuelos s hemmerling j butler j pereira b garfield a owens k darnell b roth j roberts the water institute of the gulf d di leonardo m ramirez d stephens a cuesta and c esposito tulane university acknowledgement for providing background bathymetry data for planning purposes goes to moffatt nichol lake pontchartrain basin foundation lpbf and thad pratt from the u s army corps of engineers usace engineering research and development center coastal hydraulics laboratory erdc chl much appreciation goes to s piazza u s geological survey usgs d weifenbach cpra and m comeaux usgs for providing information about the coastwide reference monitoring system crms wetlands sites including querying the dominant marsh vegetation for determination of which crms sites to collect vegetation and soil samples acknowledgement goes to the many landowners in the region that gave us permission to sample on their land and to access their canals for the various data collection tasks boat services provided by a daugereaux the ecology center university of louisiana in lafayette ull m farizo delacroix corporation and louisiana universities marine consortium lumcon assisted in reaching some of the wetland and estuarine open water sites the authors thank d reed k costanza t carruthers k darnell k hastings t kimball p lafargue and d weathers for reviewing earlier drafts and anonymous reviewers for excellent input that strengthened this manuscript appendix a supplementary data the following is the supplementary data related to this article multimedia component 1 multimedia component 1 appendix a supplementary data supplementary data related to this article can be found at https doi org 10 1016 j envsoft 2018 05 019 supplementary video related to this article can be found at https doi org 10 1016 j envsoft 2018 05 019 the following is the supplementary data related to this article multimedia component 2 multimedia component 2 multimedia component 3 multimedia component 3 
26336,in this paper we propose an algorithm for retrieving an arbitrary watershed boundary from a 2d flow direction grid the proposed algorithm and associated data model provides geometric speed increases in watershed boundary retrieval while keeping storage constraints linear in comparison to existing techniques the algorithm called watershed marching algorithm wma relies on an existing data structure the modified nested set model originally described by celko and applied to hydrodynamic models by haag and shokoufandeh in 2017 in contrast to existing algorithms that scale proportionally to the area of the underlying region the complexity of the wma algorithm is proportional to the boundary length results for a group of tested watersheds n 14 718 in the 36 000 km2 delaware river watershed show a reduction of between 0 and 99 in computational complexity using a 30 m dem vs existing techniques keywords watershed marching algorithm wma algorithm graph theory modified nested set algorithm watershed boundaries 1 introduction 1 1 watershed delineation environmental models and associated decision support systems dss rely on the retrieval and modelling of environmental objects and analysis to satisfy users data needs matthies et al 2007 returning relevant information in these support tools can be problematic due to the complexity of human and natural systems van delden et al 2007 this is a general trend and as better data and methods become available realism and relevance are increasing allowing direct support for management and policy development matthies et al 2007 dss systems allow resource managers to test a number of scenarios and their potential impact on natural cycles de kort and booij 2007 building these systems have been shown to contribute to the long term stability of economically important natural resources carrick and ostendorf 2007 to support the creation of dss with a focus on hydrological systems a sustained effort to organize and distribute hydrological data is ongoing ames et al 2012 and goodall et al 2008 worked on the development of a standard web based platform to facilitate hydrological data discovery visualization and analysis from disparate sources andrews et al 2011 worked on developing a collection of open source software packages for the analysis of hydrological data while castronova and goodall 2010 focused on a standard modelling interfaces for hydrologic systems lastly beran and piasecki 2009 describe techniques to discover existing hydrologic data resources from a variety of disparate sources this work demonstrates the need for more interconnected data models and standards to support integration of hydrological data watershed delineation and retrieval is the basic modelling element tesfa et al 2011 for hydrological problems and as such watershed boundaries are a key component in hydrologically focused dss watersheds are important for a number of areas of interest including biological daniel et al 2011 wang et al 1997 ecological daniel et al 2011 malvadkar et al 2015 infrastructure e g cadastral flood al sabhan et al 2003 and engineering because of their importance a number of software packages e g esri hydrological toolset esri 2017 taudem tarboton 2015 have been designed to support the creation of watersheds as polygonal boundaries for a given pour point e g a vector of coordinates that represent a polygon on a two dimensional planar surface watershed boundaries are currently represented in dss as either static pre calculated or cached boundaries vector from national or regional datasets e g national hydrography plus version 2 nhdplusv2 usgs hydrologic unit codes huc or hydrosheds or they are delineated on the fly based on user input from digital elevation models e g wikiwatersheds usgs stream stats iowa flood information system esri s watershed api and others these two approaches both exhibit shortcomings namely predefined watershed boundaries limit the users ability to obtain results on specific geographies of interest conversely retrieval of watershed boundaries on the fly is computationally prohibitive using existing published techniques in this manuscript we focus on data structures and algorithms to efficiently retrieve watershed boundaries from digital flow direction grids baker et al 2006 discussed standard practices to create polygonal watershed boundaries using a flow direction grid approach as 1 creating a digital elevation model dem 2 filling spurious sinks 3 creating a flow direction grid 4 burning in fluvial hydrological features e g streams and rivers and 5 using an accumulation of cell contributions across the landscape our proposed algorithm substitutes for the last step a general data structure and its corresponding vertex labelling called the modified nested set model mnsm as described in haag and shokoufandeh 2017 a novel algorithm as described in this manuscript watershed marching algorithm wma is then applied to retrieve watershed boundaries from the mnsm 1 2 watershed marching algorithm the wma belongs to a family of methods known as marching algorithm sethian 1999 describes the application of marching algorithms to problems in physics chemistry fluid mechanics combustion image processing and material science fundamentally marching algorithms separate surfaces into inside and outside components in biomedical image processing lorensen and cline 1987 describe a three dimensional marching algorithm also known as marching cubes that divides medical images into triangles and associated 3 d objects to identify and retrieve regions of interest e g organs or abnormalities efficient marching algorithms make local identity decisions as boolean conditions on the boundary or not on the boundary sethian 1999 to make a forward march therefore the application of marching algorithms to the watershed delineation problem requires a solution to the global problem of watershed inclusion given any input pour point local fdg and dem values are indeterminate for the global watershed identity problem the modified nested set labelling allows local determination of the global watershed identity problem for any grid cell with an associated linear increase of storage costs to the best of our knowledge the only other data model that allows local determination of watershed identity is the identity matrix as used in the swat model as described by olivera et al 2006 the identity matrix stores every cell to cell relationship and therefore storage costs scales quadraticly in comparison to our linear solution storage requirements for larger watersheds become too large to effectively use for example the amazon river basin results in a difference of 2 6 7 billion vs 6 7 billion 2 for the identity matrix vis à vis the nested set index with a 30 m grid cell size 2 notations and data 2 1 notation before describing the wma algorithm in detail we present the notation and structures used throughout the rest of the manuscript we use the set of natural numbers 0 1 2 3 for encoding cardinal directions north east south and west respectively we apply the wma algorithm to delineate watershed boundaries for any surface using a regularly spaced flow direction d 8 grid jenson and domingue 1988 as input within a d 8 structure every grid cell contains a value in 2 0 2 1 2 7 that denotes connectivity to one of its eight neighboring grid cells we treat this flow grid as a graph g v e whose vertex set v v 1 v 2 v n is congruent to grid cells and its directed edge set e v i v j 1 i j n is congruent to the flow direction values of individual vertices see fig 1 each node u v has exactly one d 8 corresponding to an outgoing flow to a cell v which will result in exactly one edge e u v in the edge set e additionally since each node in v v corresponds to a regular grid cell we can describe its location using index pair ρ v x v y v we create a secondary abstraction of the d 8 flow direction grid to denote the lattice corners of each grid cell v v specifically we use l λ γ to denote a regular square lattice with the set λ ℝ 2 denoting the set of lattice points and γ ℝ 2 ℝ 2 as the set of edges connecting lattice points similar to vertices of graph g each lattice point ℓ in λ is uniquely identified by an index pair x ℓ y ℓ we can assume without loss of generality that l is a periodic lattice a k step lattice walk from lattice point p 0 to lattice point p k is a sequence w p 0 p k of elements in λ such that i 0 k 1 p i p i 1 γ we define ℱ as the set of faces or cells of l and note that there is an equivalence between the vertex set v of graph g and the set of faces ℱ for lattice l we note that the boundary of any watershed for lattice l is a closed lattice walk lattice cycle i e p 0 p k given a lattice point ℓ l we use a ℓ b ℓ θ ℓ and δ ℓ if they exist to denote its four neighboring lattice faces in ℱ i e vertices in g see fig 2 conversely for a face u ℱ we use the α u β u δ u γ u to denote its four boundary lattice points see fig 3 as a pre processing step prior to running the hms algorithm we will construct the mns data structure for the d 8 grid as described in haag and shokoufandeh 2017 this algorithm will associate two additional attributes of discovery d v and finish time f v to each node v v the attribute d is unique for every grid cell while multiple grid cells may receive the same f value fig 4 illustrates a d 8 graph labelled with discovery and finish times under the mns data structure finally the marching algorithm takes as input any cell v v and returns its watershed boundary in the form of a closed lattice walk ω v made up of a list of lattice points in l 2 2 source data we applied the marching algorithm to the delaware river watershed using the flow direction grid provided as part of the national hydrography plus version 2 database this data set was downloaded for the mid atlantic version region 02 a epa and horizon systems the dem was a subset based on the watershed boundary for the delaware river watershed with the root node hydro sequence 200005438 and all stream reaches where the terminalpa 200005438 or the confluence of the delaware river with the delaware bay 75 35717 39 2753 this is the same study area used in our previous work haag and shokoufandeh 2017 this resulted in a study area of 36 000 km 2 fig 5 3 method our algorithm relies on certain structural properties of a large flow direction raster grid specifically we distinguish between root and internal cells of a flow grid the root cells are identified as grid cells that flow into cells with null values e g large bodies of water oceans and lakes or off the grid all other grid cells that flow to cells with valid flow directions are internal cells as we discussed earlier our marching algorithm utilizes an auxiliary data structure known as mns that captures the hierarchy and nested structure of watersheds i e the hierarchical complexity of a watershed will be captured using a pair of attributes d v and f v for each cell v in flow grid g the wma receives a vertex v belonging to the flow direction grid g as its staring cell it then builds the boundary of ω v a complete polygon of the watershed for all grid cells that drain through pour point v in an incremental fashion the polygonal chain ω v is a closed lattice walk defined on l the dual lattice for flow grid g the correctness of our incremental algorithm relies on the observations that every boundary grid cell of ω v with a valid flow direction value is guaranteed to have at least one adjacent neighbor that is not in its watershed for the initial cell v the wma is guaranteed to find adjacent lattice points belonging to ω v proposition 1 proposition 1 given an initial grid cell v with a valid flow direction in 2 0 2 2 2 4 2 6 the edge defined by the coincident lattice points between the initial vertex and the vertex it flows to defines a boundary on ω v without loss of generality assume outgoing flow from vertex v is 2 0 and therefore water is flowing to the east towards vertex s by definition of a d 8 flow direction grid see example fig 6 a therefore the fact that if v pours out to cell s s can not directly or indirectly pour to v otherwise a cycle will be formed therefore cell s does not belong to the watershed of v this in turn implies that the edge defined by coincident lattice points between v and s define a boundary on ω v since the cell on the western side is included inside the watershed and the cell on the other eastern side is outside the watershed proposition 2 given an initial grid vertex v with a valid flow direction in 2 1 2 3 2 5 2 7 the edge defined by the coincident lattice points between the initial vertex and the one it flows into marks a lattice location that is on the boundary of ω v further this lattice location can be used to identify a lattice edge that is on the boundary of ω v without loss of generality assume the flow direction out of vertex v is 2 1 i e water is flowing to the southeast towards vertex u by definition of a d 8 flow direction grid see fig 6b given that graph g is acyclic u can not directly or indirectly pour to the vertex v therefore u is not inside the watershed of v and the coincident lattice point between u and v is located on the boundary of ω v as a result cell u and v must have a common neighbor s located to the east of v and to the north of u in the case where vertex s belong to ω v the edge between u and s is on the boundary of ω v fig 6c if s does not belong to ω v then the edge between v and s is on the boundary of ω v fig 6d proposition 3 assuming that wma algorithm follows a counterclockwise march i e ω v is on the left hand side of every lattice edge for any lattice edge on ω v one of its four lattice neighbors can be used to create an edge that separates ω v moreover the advance step can be carried in constant time without loss of generality assume that an edge e coincident to ω v has been found separating vertices c and d we will also assume c is located to the east of d see fig 7 a the wma algorithm can now traverses 1 of 3 possible edges moving either east north or west it is not possible to move south since that would require crossing the same edge an action that is not allowed by design for the wma algorithm in the wma algorithm for any of the lattice edges on ω v depending on the inclusion of a and b in the watershed one of the four mutually exclusive states can exist the first three states see fig 7b 7c and 7d are trivial and the advance step can be carried in constant time by asking two questions about the status of cells a and b the fourth state occurs when cell a is not in watershed of ω v and cell b is in watershed of ω v we know that two flow directions can not cross each other at one lattice point this case in turn will yield to some sub cases that should be investigated in all sub cases we assume that the current lattice point 2 is being visited for the first time otherwise the selection of the edge is trivial because the other two edges coincident to the lattice point 2 have been visited and we only have one option to select the uncovered edge first without loss of generality assume the cells to the top left and top right of lattice edge 1 2 is not in ω v see fig 7b among the three possible edges incident to lattice location 2 only one is on the boundary of ω v i e the edge to the west next assume cells to the top left and top right of lattice edge 2 1 belongs to ω v see fig 7c of the three possible edges adjacent to lattice location 2 only one the edge to the east is on the boundary of ω v similarly assume the cells to the top left of lattice edge 2 1 belongs to ω v and the cell to the top right does not belong to ω v fig 7d in this case only the edge to the north of lattice location 2 belongs to the boundary of ω v next we will consider the cases where ω v self intersects again we assume that the boundary of ω v has reached vertex 2 from vertex 1 via an incoming edge 1 2 in what follows we will argue that the next viable vertex for extending ω v can not be located to the north of vertex 2 i e the algorithm needs to progress either east or west of vertex 2 to show this statement there must exist either a flow between cells a and d or between b and c otherwise if no flow crosses vertex 2 the outgoing flow from cells a and d creates a barrier between cells b and c the existence of this barrier is due to the fundamental structure of a sink filled d 8 flow direction grid specifically every cell is part of a path that ultimately flows to the edge of the fdg and this flow path creates a topological surface that cannot be crossed as a result if cells a and d do not flow into each other their respective flow paths create a barrier between the edge of the graph preventing cell b and c from flowing around either a or d this in turn implies if there is no flow between d and a that crosses vertex 2 a flow between cells b and c must cross vertex 2 a similar argument is true when there is no flow between cells b and c we also note that there can only exist a single flow that crosses vertex 2 by definition of a d 8 fdg this in turn proves the claim that the march will either progress to the east or west of vertex 2 the deciding factor on extending ω v to east or west largely depends on the direction of flow between cells a and d or b and c each resulting in a different case for the wma algorithm first consider the case where d flows to a the flow path from cell b must connect to the flow path from cell c by walking around cell d this flow path would create a barrier for the wma preventing an earlier visit of edge 1 2 from the lattice point to the north of vertex 2 this implies that vertex 2 was visited in a prior stage of the wma march as a result the march must make a left western turn at vertex 2 when d flows to a next assume that cell a flows to cell d consequently the outgoing flow from d will create a barrier separating cells c and b implying that the flow paths from c or b will need to go around cell a the algorithm will extend ω v to the west cutting out the incision that cell a creates within the watershed and ultimately reaching vertex 2 from the north there are two additional cases involving a flow between cells b and c first assume there exists a flow from cell b to c clearly this is the first time that ω v is reaching vertex 2 in this case the march will proceed to the east following the boundary edge adjacent between cells b and d the reason is that the barriers created by outgoing flows from cells a and d proceeding to west and then cell b resulting in an incorrect watershed finally when cell c flows to cell b an argument similar to the case where d flows to a implies vertex 2 was previously visited from the north in the construction of ω v as a result in a similar way to the previous case the wma algorithm would construct ω v by a turn to the east at vertex 2 proposition 4 each lattice point on ω v will be visited at most twice resulting in a o ω v complexity for the marching algorithm we note that the linearity o ω v complexity of the marching algorithm is immediate from the premise of proposition 4 i e each lattice point being visited at most twice we first argue that every edge belonging to the boundary of ω v is visited exactly once during the wma march consequently ω v can self intersect at one of its vertices u at most once other wise one of the adjacent edges to u will be visited more than once it remains to show that every edge on ω v is visited exactly once first we note that in every step the wma algorithm maintains the interior of the watershed to the left of the last visited edge while the area outside of the watershed is kept to its right this in turn implies that the edges of ω v can only ever be crossed in one direction by wma algorithm without loss of generality assume that the edge between cells c and d in sub figures of fig 8 is one such edge first we argue that the scenario depicted in fig 8a is impossible for a sink filled fdg this is an immediate consequence from the fact that the flow out of cell d can not cross over the flow between cells b and c and the structure of fdg prevents it from flowing to the boundary fig 8b shows the case where there is a flow from cell d to a in this case the lattice edge between cells c and d is visited while the algorithm carves the flow around cell b reaches cell d and makes an east turn around cell c never visiting the edge between cells c and d again next if there is a flow between cells b and c following the march across lattice edge between cells c and d the tour will have to proceed east and the flow from d towards the boundary of the fdg will create a barrier for ω v to revisit this edge for a second time see fig 8c finally during the construction of ω v every vertex will be visited at most twice with each visit taking a constant processing time see proposition 3 and no internal or external nodes will be visited during the march these observations in turn imply an o ω v complexity for the wma algorithm the above propositions allow us to efficiently identify boundary edges or connections between lattice points and extend the chain ω v specifically starting at grid cell v its outgoing edge d 8 v will be used to identify the lattice point s that share a boundary with v note that if d 8 v belongs to set 1 4 16 64 the cell v and the destination cell of the flow edge d 8 v share two lattice points while for d 8 v in 2 8 32 128 the cells share a single lattice point fig 6 at each step the algorithm identifies a new lattice edge to extend the march chain ω v based on the direction of the march clockwise or counterclockwise and the flow direction d 8 attribute of the starting grid cell while in every step of the algorithm we have chosen to use a consistent counterclockwise probe as the reference direction the algorithm is symmetric and would perform similarly irrespective of the consistent reference direction of incremental steps proposition 3 is a consequence of this consistent walk after identifying a starting lattice point the march will continue by examining the immediate counterclockwise lattice point with respect to the previous move for example if the march starts by moving to the top right and the the wma march is moving in the north direction cardinal direction with value 0 the next boundary check will occur to the east value 1 this first lattice march will identify the initial edge connection of two lattice points on ω v for the rest of the march the two grid value are used to determine the march direction see fig 7 the wma march after crossing an edge can move in one of three directions from it s current lattice location if the first edge is oriented north then the march can move to the west north or east the top left hand corner of fig 7 shows the state of the wma algorithm after it has crossed edge p 1 p 2 because the wma algorithm keeps the watershed on the left hand side grid v c is inside ω v a v d is outside ω v at this step in the algorithm v a and v b are not yet know in order to make the next step in the march the wma algorithm uses the boundarypoint function to query v a and v b returning four possible states the first shown in fig 7 at the top center graphic occurs when neither v a or v b are in the watershed in this case the march moves to the left of the previous move the second shown at the top right occurs when both v a or v b are in the watershed in this case the march moves to the right of the previous move the bottom left graphic shows what happens when v a is in the watershed and v b is not the march moves forward in the same direction as the previous step in the situation where v a is not in the watershed and v b is bottom center and bottom right a further piece of information is necessary because both lattice edges p 2 p 3 and p 2 p 4 are on the watershed boundary ω v to solve for this situation we query we note that the wma march should never cross a flow direction edge therefore if v a flows to v d or v d flows to v a we turn left if not we turn right in the worst case during each iteration of the march the algorithm will examine two grid values otherwise it would fold upon itself returning along the same edge it came in and proceeds to identify the next lattice point that is on the boundary of ω v the algorithm terminates when it returns to the first lattice edge crossed during the march identifying a closed polygon proposition 4 formalizes the computational complexity of the marching algorithm function 1 latticemove ℓ μ image 1 function 2 boundarypoint v i v image 2 algorithm 1 watershed marching algorithm g l v image 3 4 results 4 1 data model pre processing cost the computational cost for converting the original flow direction grid into the modified nested set model is linear based on the size of the grid haag and shokoufandeh 2017 the algorithm crosses every edge between grid cells exactly two times on the graph traversal the d 8 flow direction grid only allows one edge the downstream connection for every grid cell except for the root which has no edges therefore the application runs in exactly 2 n 1 where n is the number of grid cells the data structures g v e and lattice l can both be derived from outputs of the modified nested set algorithm and therefore require no further processing or storage resources 4 2 data model storage size we compare the size of the data model required to support the wma algorithm to the initial size of the input d 8 flow direction grid because the algorithm relies on the original data to initiate the march a reduction in size is not possible conversely because the attributes discovery d and finish f are stored for every cell location the size of the final data set is linear and constant with respect to the size of the initial grid cell 4 3 comparison to existing watershed delineation algorithms the proposed wma algorithm was compared to existing watershed creation algorithms for the 14 718 nhdplus v2 david et al 2011 catchments within the delaware river watershed for each catchment the total query complexity for the generic grid processing algorithms e g gage watershed from tarboton 2015 esri 2017 watershed function and saga hydrology module was compared to the proposed wma algorithm specifically the number of 30 m grid cells that was required to process to create ω v was compared between the two approaches we did not include in this comparison pre processing steps but rather we assume as inputs to the original algorithm a standard flow direction d 8 grid and to the wma algorithm the discovery and finish time grids from haag and shokoufandeh 2017 we believe that this is a valid approach because the conversion from raw dem data to the sink filed d 8 flow direction model requires multiple sweeps across the raw graph the conversion to the discovery and finish time grid as required for this algorithm require two more sweeps across the entire grid and therefore this preprocessing step will run in linear time in relation to existing steps fig 9 illustrates the results for the comparison between the 14 718 catchments the standard grid processing algorithm requires between 1 and 34 million while the proposed algorithm requires between 1 and 44 thousand vertices grid cells to be processed we fit a linear regression least squares model against the logarithm of y c x b ln y ln c b ln x resulting in y 0 1967 x 1 7986 with an r 2 value of 0 98 if we extend this equation to larger watersheds for example the 6 1 million km2 amazon river it would require 6 8 billion 30 m grids cells while wma would require 1 4 million marches this is a reduction of 99 97 read operations vs known algorithms 5 discussion 5 1 complexity reduction the observed reduction in computational complexity is consistent with the observation that the proposed algorithm has the same computational complexity as the size of watershed boundary or to put it another way in the length of the polygonal chain ω v in contrast existing algorithms scale in proportionality to the area of the watershed we expect that based on the watershed shape the proposed algorithm retrieval complexity would be geometrically smaller then existing techniques empirical tests conducted within the delaware river watershed show a geometric reduction in processing time fig 9 when we extend the empirical results to other watershed we predict considerable 99 9 reduction in computational complexity additionally the advantage that the wma algorithm has in comparison to existing techniques will become more prominent as dems continue to increase in resolution for example select parts of the conterminous united states already have 1 m dems as part of the usgs three dimensional elevation program survey 2017 this will result in a data set with 900 times the number of nodes that were used in this analysis when this resolution data becomes available for the amazon river basin it will turn the original 6 1 billion grid necessary to delineate the amazon basin into a 5 5 trillion grid this is due to the fact that dems increase in resolution quadraticaly e g the difference in size between 30 m dem and 1 m dem is 30 1 2 900 applying our linear regression model in fig 9 we estimate that the proposed algorithm would need to visit roughly 28 million grid cells the higher the dem resolution the larger the advantage the wma algorithm has compared to existing data structures 5 2 potential issues with this data model in this section we discuss a number of potential issues that could arise by using the proposed data model vs existing techniques the first involves endoheric basins e g the caspian sea or the great salt lake watershed in the situation where endoheric basins are completely surrounded by an exorheic basin s the wma algorithm would subsume the internal watershed to efficiently solve this problem a standard spatial intersection with the watershed produced by the wma algorithm vs the internal centroid for endoheric basins will determine if a watershed contains internal basins if a centroid for an endoheric basin is contained within the boundary returned by the wma then the boundary of the internal endoheric basin can be cut from the watershed the second potential issue arises within watersheds where stream flow is divergent e g oxbows or tidal areas this issue is discussed in more detail in haag and shokoufandeh 2017 we note that assuming water flow is one directional is common among watershed and stream routing models and in fact is an underlying structural assumption for the d 8 flow direction grid lastly we acknowledge that the techniques described in this manuscript will only work for terrestrial well behaved hydrologic systems situations where water flow is bi or multi directional will violate the tree like data structure that the wma depends on we believe that this constrained application is justified as a number of prominent software packages esri hydro tools and taudem decisions support tools usgs stream stats the national water model wiki watershed ifis and many others are based on the d8 flow direction grid model the d8 model explicitly assumes unidirectional water flow lastly modifications to the wma to retrieve watersheds from other types of flow direction grids e g d infinty may be possible but at this point are unknown 6 conclusions 1 this manuscript describes an algorithm named watershed marching algorithm wma to retrieve a watershed boundary from a d 8 flow direction grid 2 we show that the wma algorithm returns the same watershed boundary as existing grid searching techniques 3 the wma algorithm marches around the exterior boundary never entering the interior or exterior of the watershed 4 results for the de river watershed show a reduction from 35 million to 45 thousand read operations 5 testing on an ordinary desktop machine returned the boundary for the de river 36 000 km2 in less than 1 s 
26336,in this paper we propose an algorithm for retrieving an arbitrary watershed boundary from a 2d flow direction grid the proposed algorithm and associated data model provides geometric speed increases in watershed boundary retrieval while keeping storage constraints linear in comparison to existing techniques the algorithm called watershed marching algorithm wma relies on an existing data structure the modified nested set model originally described by celko and applied to hydrodynamic models by haag and shokoufandeh in 2017 in contrast to existing algorithms that scale proportionally to the area of the underlying region the complexity of the wma algorithm is proportional to the boundary length results for a group of tested watersheds n 14 718 in the 36 000 km2 delaware river watershed show a reduction of between 0 and 99 in computational complexity using a 30 m dem vs existing techniques keywords watershed marching algorithm wma algorithm graph theory modified nested set algorithm watershed boundaries 1 introduction 1 1 watershed delineation environmental models and associated decision support systems dss rely on the retrieval and modelling of environmental objects and analysis to satisfy users data needs matthies et al 2007 returning relevant information in these support tools can be problematic due to the complexity of human and natural systems van delden et al 2007 this is a general trend and as better data and methods become available realism and relevance are increasing allowing direct support for management and policy development matthies et al 2007 dss systems allow resource managers to test a number of scenarios and their potential impact on natural cycles de kort and booij 2007 building these systems have been shown to contribute to the long term stability of economically important natural resources carrick and ostendorf 2007 to support the creation of dss with a focus on hydrological systems a sustained effort to organize and distribute hydrological data is ongoing ames et al 2012 and goodall et al 2008 worked on the development of a standard web based platform to facilitate hydrological data discovery visualization and analysis from disparate sources andrews et al 2011 worked on developing a collection of open source software packages for the analysis of hydrological data while castronova and goodall 2010 focused on a standard modelling interfaces for hydrologic systems lastly beran and piasecki 2009 describe techniques to discover existing hydrologic data resources from a variety of disparate sources this work demonstrates the need for more interconnected data models and standards to support integration of hydrological data watershed delineation and retrieval is the basic modelling element tesfa et al 2011 for hydrological problems and as such watershed boundaries are a key component in hydrologically focused dss watersheds are important for a number of areas of interest including biological daniel et al 2011 wang et al 1997 ecological daniel et al 2011 malvadkar et al 2015 infrastructure e g cadastral flood al sabhan et al 2003 and engineering because of their importance a number of software packages e g esri hydrological toolset esri 2017 taudem tarboton 2015 have been designed to support the creation of watersheds as polygonal boundaries for a given pour point e g a vector of coordinates that represent a polygon on a two dimensional planar surface watershed boundaries are currently represented in dss as either static pre calculated or cached boundaries vector from national or regional datasets e g national hydrography plus version 2 nhdplusv2 usgs hydrologic unit codes huc or hydrosheds or they are delineated on the fly based on user input from digital elevation models e g wikiwatersheds usgs stream stats iowa flood information system esri s watershed api and others these two approaches both exhibit shortcomings namely predefined watershed boundaries limit the users ability to obtain results on specific geographies of interest conversely retrieval of watershed boundaries on the fly is computationally prohibitive using existing published techniques in this manuscript we focus on data structures and algorithms to efficiently retrieve watershed boundaries from digital flow direction grids baker et al 2006 discussed standard practices to create polygonal watershed boundaries using a flow direction grid approach as 1 creating a digital elevation model dem 2 filling spurious sinks 3 creating a flow direction grid 4 burning in fluvial hydrological features e g streams and rivers and 5 using an accumulation of cell contributions across the landscape our proposed algorithm substitutes for the last step a general data structure and its corresponding vertex labelling called the modified nested set model mnsm as described in haag and shokoufandeh 2017 a novel algorithm as described in this manuscript watershed marching algorithm wma is then applied to retrieve watershed boundaries from the mnsm 1 2 watershed marching algorithm the wma belongs to a family of methods known as marching algorithm sethian 1999 describes the application of marching algorithms to problems in physics chemistry fluid mechanics combustion image processing and material science fundamentally marching algorithms separate surfaces into inside and outside components in biomedical image processing lorensen and cline 1987 describe a three dimensional marching algorithm also known as marching cubes that divides medical images into triangles and associated 3 d objects to identify and retrieve regions of interest e g organs or abnormalities efficient marching algorithms make local identity decisions as boolean conditions on the boundary or not on the boundary sethian 1999 to make a forward march therefore the application of marching algorithms to the watershed delineation problem requires a solution to the global problem of watershed inclusion given any input pour point local fdg and dem values are indeterminate for the global watershed identity problem the modified nested set labelling allows local determination of the global watershed identity problem for any grid cell with an associated linear increase of storage costs to the best of our knowledge the only other data model that allows local determination of watershed identity is the identity matrix as used in the swat model as described by olivera et al 2006 the identity matrix stores every cell to cell relationship and therefore storage costs scales quadraticly in comparison to our linear solution storage requirements for larger watersheds become too large to effectively use for example the amazon river basin results in a difference of 2 6 7 billion vs 6 7 billion 2 for the identity matrix vis à vis the nested set index with a 30 m grid cell size 2 notations and data 2 1 notation before describing the wma algorithm in detail we present the notation and structures used throughout the rest of the manuscript we use the set of natural numbers 0 1 2 3 for encoding cardinal directions north east south and west respectively we apply the wma algorithm to delineate watershed boundaries for any surface using a regularly spaced flow direction d 8 grid jenson and domingue 1988 as input within a d 8 structure every grid cell contains a value in 2 0 2 1 2 7 that denotes connectivity to one of its eight neighboring grid cells we treat this flow grid as a graph g v e whose vertex set v v 1 v 2 v n is congruent to grid cells and its directed edge set e v i v j 1 i j n is congruent to the flow direction values of individual vertices see fig 1 each node u v has exactly one d 8 corresponding to an outgoing flow to a cell v which will result in exactly one edge e u v in the edge set e additionally since each node in v v corresponds to a regular grid cell we can describe its location using index pair ρ v x v y v we create a secondary abstraction of the d 8 flow direction grid to denote the lattice corners of each grid cell v v specifically we use l λ γ to denote a regular square lattice with the set λ ℝ 2 denoting the set of lattice points and γ ℝ 2 ℝ 2 as the set of edges connecting lattice points similar to vertices of graph g each lattice point ℓ in λ is uniquely identified by an index pair x ℓ y ℓ we can assume without loss of generality that l is a periodic lattice a k step lattice walk from lattice point p 0 to lattice point p k is a sequence w p 0 p k of elements in λ such that i 0 k 1 p i p i 1 γ we define ℱ as the set of faces or cells of l and note that there is an equivalence between the vertex set v of graph g and the set of faces ℱ for lattice l we note that the boundary of any watershed for lattice l is a closed lattice walk lattice cycle i e p 0 p k given a lattice point ℓ l we use a ℓ b ℓ θ ℓ and δ ℓ if they exist to denote its four neighboring lattice faces in ℱ i e vertices in g see fig 2 conversely for a face u ℱ we use the α u β u δ u γ u to denote its four boundary lattice points see fig 3 as a pre processing step prior to running the hms algorithm we will construct the mns data structure for the d 8 grid as described in haag and shokoufandeh 2017 this algorithm will associate two additional attributes of discovery d v and finish time f v to each node v v the attribute d is unique for every grid cell while multiple grid cells may receive the same f value fig 4 illustrates a d 8 graph labelled with discovery and finish times under the mns data structure finally the marching algorithm takes as input any cell v v and returns its watershed boundary in the form of a closed lattice walk ω v made up of a list of lattice points in l 2 2 source data we applied the marching algorithm to the delaware river watershed using the flow direction grid provided as part of the national hydrography plus version 2 database this data set was downloaded for the mid atlantic version region 02 a epa and horizon systems the dem was a subset based on the watershed boundary for the delaware river watershed with the root node hydro sequence 200005438 and all stream reaches where the terminalpa 200005438 or the confluence of the delaware river with the delaware bay 75 35717 39 2753 this is the same study area used in our previous work haag and shokoufandeh 2017 this resulted in a study area of 36 000 km 2 fig 5 3 method our algorithm relies on certain structural properties of a large flow direction raster grid specifically we distinguish between root and internal cells of a flow grid the root cells are identified as grid cells that flow into cells with null values e g large bodies of water oceans and lakes or off the grid all other grid cells that flow to cells with valid flow directions are internal cells as we discussed earlier our marching algorithm utilizes an auxiliary data structure known as mns that captures the hierarchy and nested structure of watersheds i e the hierarchical complexity of a watershed will be captured using a pair of attributes d v and f v for each cell v in flow grid g the wma receives a vertex v belonging to the flow direction grid g as its staring cell it then builds the boundary of ω v a complete polygon of the watershed for all grid cells that drain through pour point v in an incremental fashion the polygonal chain ω v is a closed lattice walk defined on l the dual lattice for flow grid g the correctness of our incremental algorithm relies on the observations that every boundary grid cell of ω v with a valid flow direction value is guaranteed to have at least one adjacent neighbor that is not in its watershed for the initial cell v the wma is guaranteed to find adjacent lattice points belonging to ω v proposition 1 proposition 1 given an initial grid cell v with a valid flow direction in 2 0 2 2 2 4 2 6 the edge defined by the coincident lattice points between the initial vertex and the vertex it flows to defines a boundary on ω v without loss of generality assume outgoing flow from vertex v is 2 0 and therefore water is flowing to the east towards vertex s by definition of a d 8 flow direction grid see example fig 6 a therefore the fact that if v pours out to cell s s can not directly or indirectly pour to v otherwise a cycle will be formed therefore cell s does not belong to the watershed of v this in turn implies that the edge defined by coincident lattice points between v and s define a boundary on ω v since the cell on the western side is included inside the watershed and the cell on the other eastern side is outside the watershed proposition 2 given an initial grid vertex v with a valid flow direction in 2 1 2 3 2 5 2 7 the edge defined by the coincident lattice points between the initial vertex and the one it flows into marks a lattice location that is on the boundary of ω v further this lattice location can be used to identify a lattice edge that is on the boundary of ω v without loss of generality assume the flow direction out of vertex v is 2 1 i e water is flowing to the southeast towards vertex u by definition of a d 8 flow direction grid see fig 6b given that graph g is acyclic u can not directly or indirectly pour to the vertex v therefore u is not inside the watershed of v and the coincident lattice point between u and v is located on the boundary of ω v as a result cell u and v must have a common neighbor s located to the east of v and to the north of u in the case where vertex s belong to ω v the edge between u and s is on the boundary of ω v fig 6c if s does not belong to ω v then the edge between v and s is on the boundary of ω v fig 6d proposition 3 assuming that wma algorithm follows a counterclockwise march i e ω v is on the left hand side of every lattice edge for any lattice edge on ω v one of its four lattice neighbors can be used to create an edge that separates ω v moreover the advance step can be carried in constant time without loss of generality assume that an edge e coincident to ω v has been found separating vertices c and d we will also assume c is located to the east of d see fig 7 a the wma algorithm can now traverses 1 of 3 possible edges moving either east north or west it is not possible to move south since that would require crossing the same edge an action that is not allowed by design for the wma algorithm in the wma algorithm for any of the lattice edges on ω v depending on the inclusion of a and b in the watershed one of the four mutually exclusive states can exist the first three states see fig 7b 7c and 7d are trivial and the advance step can be carried in constant time by asking two questions about the status of cells a and b the fourth state occurs when cell a is not in watershed of ω v and cell b is in watershed of ω v we know that two flow directions can not cross each other at one lattice point this case in turn will yield to some sub cases that should be investigated in all sub cases we assume that the current lattice point 2 is being visited for the first time otherwise the selection of the edge is trivial because the other two edges coincident to the lattice point 2 have been visited and we only have one option to select the uncovered edge first without loss of generality assume the cells to the top left and top right of lattice edge 1 2 is not in ω v see fig 7b among the three possible edges incident to lattice location 2 only one is on the boundary of ω v i e the edge to the west next assume cells to the top left and top right of lattice edge 2 1 belongs to ω v see fig 7c of the three possible edges adjacent to lattice location 2 only one the edge to the east is on the boundary of ω v similarly assume the cells to the top left of lattice edge 2 1 belongs to ω v and the cell to the top right does not belong to ω v fig 7d in this case only the edge to the north of lattice location 2 belongs to the boundary of ω v next we will consider the cases where ω v self intersects again we assume that the boundary of ω v has reached vertex 2 from vertex 1 via an incoming edge 1 2 in what follows we will argue that the next viable vertex for extending ω v can not be located to the north of vertex 2 i e the algorithm needs to progress either east or west of vertex 2 to show this statement there must exist either a flow between cells a and d or between b and c otherwise if no flow crosses vertex 2 the outgoing flow from cells a and d creates a barrier between cells b and c the existence of this barrier is due to the fundamental structure of a sink filled d 8 flow direction grid specifically every cell is part of a path that ultimately flows to the edge of the fdg and this flow path creates a topological surface that cannot be crossed as a result if cells a and d do not flow into each other their respective flow paths create a barrier between the edge of the graph preventing cell b and c from flowing around either a or d this in turn implies if there is no flow between d and a that crosses vertex 2 a flow between cells b and c must cross vertex 2 a similar argument is true when there is no flow between cells b and c we also note that there can only exist a single flow that crosses vertex 2 by definition of a d 8 fdg this in turn proves the claim that the march will either progress to the east or west of vertex 2 the deciding factor on extending ω v to east or west largely depends on the direction of flow between cells a and d or b and c each resulting in a different case for the wma algorithm first consider the case where d flows to a the flow path from cell b must connect to the flow path from cell c by walking around cell d this flow path would create a barrier for the wma preventing an earlier visit of edge 1 2 from the lattice point to the north of vertex 2 this implies that vertex 2 was visited in a prior stage of the wma march as a result the march must make a left western turn at vertex 2 when d flows to a next assume that cell a flows to cell d consequently the outgoing flow from d will create a barrier separating cells c and b implying that the flow paths from c or b will need to go around cell a the algorithm will extend ω v to the west cutting out the incision that cell a creates within the watershed and ultimately reaching vertex 2 from the north there are two additional cases involving a flow between cells b and c first assume there exists a flow from cell b to c clearly this is the first time that ω v is reaching vertex 2 in this case the march will proceed to the east following the boundary edge adjacent between cells b and d the reason is that the barriers created by outgoing flows from cells a and d proceeding to west and then cell b resulting in an incorrect watershed finally when cell c flows to cell b an argument similar to the case where d flows to a implies vertex 2 was previously visited from the north in the construction of ω v as a result in a similar way to the previous case the wma algorithm would construct ω v by a turn to the east at vertex 2 proposition 4 each lattice point on ω v will be visited at most twice resulting in a o ω v complexity for the marching algorithm we note that the linearity o ω v complexity of the marching algorithm is immediate from the premise of proposition 4 i e each lattice point being visited at most twice we first argue that every edge belonging to the boundary of ω v is visited exactly once during the wma march consequently ω v can self intersect at one of its vertices u at most once other wise one of the adjacent edges to u will be visited more than once it remains to show that every edge on ω v is visited exactly once first we note that in every step the wma algorithm maintains the interior of the watershed to the left of the last visited edge while the area outside of the watershed is kept to its right this in turn implies that the edges of ω v can only ever be crossed in one direction by wma algorithm without loss of generality assume that the edge between cells c and d in sub figures of fig 8 is one such edge first we argue that the scenario depicted in fig 8a is impossible for a sink filled fdg this is an immediate consequence from the fact that the flow out of cell d can not cross over the flow between cells b and c and the structure of fdg prevents it from flowing to the boundary fig 8b shows the case where there is a flow from cell d to a in this case the lattice edge between cells c and d is visited while the algorithm carves the flow around cell b reaches cell d and makes an east turn around cell c never visiting the edge between cells c and d again next if there is a flow between cells b and c following the march across lattice edge between cells c and d the tour will have to proceed east and the flow from d towards the boundary of the fdg will create a barrier for ω v to revisit this edge for a second time see fig 8c finally during the construction of ω v every vertex will be visited at most twice with each visit taking a constant processing time see proposition 3 and no internal or external nodes will be visited during the march these observations in turn imply an o ω v complexity for the wma algorithm the above propositions allow us to efficiently identify boundary edges or connections between lattice points and extend the chain ω v specifically starting at grid cell v its outgoing edge d 8 v will be used to identify the lattice point s that share a boundary with v note that if d 8 v belongs to set 1 4 16 64 the cell v and the destination cell of the flow edge d 8 v share two lattice points while for d 8 v in 2 8 32 128 the cells share a single lattice point fig 6 at each step the algorithm identifies a new lattice edge to extend the march chain ω v based on the direction of the march clockwise or counterclockwise and the flow direction d 8 attribute of the starting grid cell while in every step of the algorithm we have chosen to use a consistent counterclockwise probe as the reference direction the algorithm is symmetric and would perform similarly irrespective of the consistent reference direction of incremental steps proposition 3 is a consequence of this consistent walk after identifying a starting lattice point the march will continue by examining the immediate counterclockwise lattice point with respect to the previous move for example if the march starts by moving to the top right and the the wma march is moving in the north direction cardinal direction with value 0 the next boundary check will occur to the east value 1 this first lattice march will identify the initial edge connection of two lattice points on ω v for the rest of the march the two grid value are used to determine the march direction see fig 7 the wma march after crossing an edge can move in one of three directions from it s current lattice location if the first edge is oriented north then the march can move to the west north or east the top left hand corner of fig 7 shows the state of the wma algorithm after it has crossed edge p 1 p 2 because the wma algorithm keeps the watershed on the left hand side grid v c is inside ω v a v d is outside ω v at this step in the algorithm v a and v b are not yet know in order to make the next step in the march the wma algorithm uses the boundarypoint function to query v a and v b returning four possible states the first shown in fig 7 at the top center graphic occurs when neither v a or v b are in the watershed in this case the march moves to the left of the previous move the second shown at the top right occurs when both v a or v b are in the watershed in this case the march moves to the right of the previous move the bottom left graphic shows what happens when v a is in the watershed and v b is not the march moves forward in the same direction as the previous step in the situation where v a is not in the watershed and v b is bottom center and bottom right a further piece of information is necessary because both lattice edges p 2 p 3 and p 2 p 4 are on the watershed boundary ω v to solve for this situation we query we note that the wma march should never cross a flow direction edge therefore if v a flows to v d or v d flows to v a we turn left if not we turn right in the worst case during each iteration of the march the algorithm will examine two grid values otherwise it would fold upon itself returning along the same edge it came in and proceeds to identify the next lattice point that is on the boundary of ω v the algorithm terminates when it returns to the first lattice edge crossed during the march identifying a closed polygon proposition 4 formalizes the computational complexity of the marching algorithm function 1 latticemove ℓ μ image 1 function 2 boundarypoint v i v image 2 algorithm 1 watershed marching algorithm g l v image 3 4 results 4 1 data model pre processing cost the computational cost for converting the original flow direction grid into the modified nested set model is linear based on the size of the grid haag and shokoufandeh 2017 the algorithm crosses every edge between grid cells exactly two times on the graph traversal the d 8 flow direction grid only allows one edge the downstream connection for every grid cell except for the root which has no edges therefore the application runs in exactly 2 n 1 where n is the number of grid cells the data structures g v e and lattice l can both be derived from outputs of the modified nested set algorithm and therefore require no further processing or storage resources 4 2 data model storage size we compare the size of the data model required to support the wma algorithm to the initial size of the input d 8 flow direction grid because the algorithm relies on the original data to initiate the march a reduction in size is not possible conversely because the attributes discovery d and finish f are stored for every cell location the size of the final data set is linear and constant with respect to the size of the initial grid cell 4 3 comparison to existing watershed delineation algorithms the proposed wma algorithm was compared to existing watershed creation algorithms for the 14 718 nhdplus v2 david et al 2011 catchments within the delaware river watershed for each catchment the total query complexity for the generic grid processing algorithms e g gage watershed from tarboton 2015 esri 2017 watershed function and saga hydrology module was compared to the proposed wma algorithm specifically the number of 30 m grid cells that was required to process to create ω v was compared between the two approaches we did not include in this comparison pre processing steps but rather we assume as inputs to the original algorithm a standard flow direction d 8 grid and to the wma algorithm the discovery and finish time grids from haag and shokoufandeh 2017 we believe that this is a valid approach because the conversion from raw dem data to the sink filed d 8 flow direction model requires multiple sweeps across the raw graph the conversion to the discovery and finish time grid as required for this algorithm require two more sweeps across the entire grid and therefore this preprocessing step will run in linear time in relation to existing steps fig 9 illustrates the results for the comparison between the 14 718 catchments the standard grid processing algorithm requires between 1 and 34 million while the proposed algorithm requires between 1 and 44 thousand vertices grid cells to be processed we fit a linear regression least squares model against the logarithm of y c x b ln y ln c b ln x resulting in y 0 1967 x 1 7986 with an r 2 value of 0 98 if we extend this equation to larger watersheds for example the 6 1 million km2 amazon river it would require 6 8 billion 30 m grids cells while wma would require 1 4 million marches this is a reduction of 99 97 read operations vs known algorithms 5 discussion 5 1 complexity reduction the observed reduction in computational complexity is consistent with the observation that the proposed algorithm has the same computational complexity as the size of watershed boundary or to put it another way in the length of the polygonal chain ω v in contrast existing algorithms scale in proportionality to the area of the watershed we expect that based on the watershed shape the proposed algorithm retrieval complexity would be geometrically smaller then existing techniques empirical tests conducted within the delaware river watershed show a geometric reduction in processing time fig 9 when we extend the empirical results to other watershed we predict considerable 99 9 reduction in computational complexity additionally the advantage that the wma algorithm has in comparison to existing techniques will become more prominent as dems continue to increase in resolution for example select parts of the conterminous united states already have 1 m dems as part of the usgs three dimensional elevation program survey 2017 this will result in a data set with 900 times the number of nodes that were used in this analysis when this resolution data becomes available for the amazon river basin it will turn the original 6 1 billion grid necessary to delineate the amazon basin into a 5 5 trillion grid this is due to the fact that dems increase in resolution quadraticaly e g the difference in size between 30 m dem and 1 m dem is 30 1 2 900 applying our linear regression model in fig 9 we estimate that the proposed algorithm would need to visit roughly 28 million grid cells the higher the dem resolution the larger the advantage the wma algorithm has compared to existing data structures 5 2 potential issues with this data model in this section we discuss a number of potential issues that could arise by using the proposed data model vs existing techniques the first involves endoheric basins e g the caspian sea or the great salt lake watershed in the situation where endoheric basins are completely surrounded by an exorheic basin s the wma algorithm would subsume the internal watershed to efficiently solve this problem a standard spatial intersection with the watershed produced by the wma algorithm vs the internal centroid for endoheric basins will determine if a watershed contains internal basins if a centroid for an endoheric basin is contained within the boundary returned by the wma then the boundary of the internal endoheric basin can be cut from the watershed the second potential issue arises within watersheds where stream flow is divergent e g oxbows or tidal areas this issue is discussed in more detail in haag and shokoufandeh 2017 we note that assuming water flow is one directional is common among watershed and stream routing models and in fact is an underlying structural assumption for the d 8 flow direction grid lastly we acknowledge that the techniques described in this manuscript will only work for terrestrial well behaved hydrologic systems situations where water flow is bi or multi directional will violate the tree like data structure that the wma depends on we believe that this constrained application is justified as a number of prominent software packages esri hydro tools and taudem decisions support tools usgs stream stats the national water model wiki watershed ifis and many others are based on the d8 flow direction grid model the d8 model explicitly assumes unidirectional water flow lastly modifications to the wma to retrieve watersheds from other types of flow direction grids e g d infinty may be possible but at this point are unknown 6 conclusions 1 this manuscript describes an algorithm named watershed marching algorithm wma to retrieve a watershed boundary from a d 8 flow direction grid 2 we show that the wma algorithm returns the same watershed boundary as existing grid searching techniques 3 the wma algorithm marches around the exterior boundary never entering the interior or exterior of the watershed 4 results for the de river watershed show a reduction from 35 million to 45 thousand read operations 5 testing on an ordinary desktop machine returned the boundary for the de river 36 000 km2 in less than 1 s 
26337,the inowas platform provides a compilation of free web based tools for groundwater management all tools are running on a web server and can be accessed via standard web browsers the implemented analytical equations enable the assessment of saltwater intrusion induced by pumping or sea level rise the calculation of travel time through unconfined aquifers and the evaluation of pumping induced river drawdown the groundwater mounding calculator can be used to estimate the rise of groundwater levels underneath infiltration basins to determine the contaminant concentration downgradient of a constant source an analytical tool solving the advection dispersion equation can be utilized all tools are incorporated into a decision support environment the user is provided with detailed online support that contains the theoretical background of the tools possible applications and examples keywords cloud computing groundwater management analytical equations managed aquifer recharge software availability the inowas platform is accessible via web browser under https inowas hydro tu dresden de free user registration required 1 introduction groundwater is an important water supply resource in many regions that needs to be managed sustainably while meeting societal demands this is especially true with regard to the increasing pressure on groundwater caused by climate change urbanization and population growth flexible methods and tools are needed to assess quantitative and qualitative aspects of groundwater management besides numerical models empirical and analytical equations are frequently used to depict the underlying hydrogeological processes e g callander et al 2011 carleton 2010 halford and kuniansky 2002 to facilitate the use of these equations and to speed up the calculation various spreadsheets have been developed by researchers environmental service operators or governmental agencies these assess a wide range of groundwater related problems from basic hydrogeological investigations such as the estimation of hydraulic conductivity from grain size analysis devlin 2015 or the analysis of pumping and slug test data halford and kuniansky 2002 to more complex tools for the estimation of hydraulic gradients and flow velocities using groundwater head data beljin et al 2014 devlin 2003 and transient or time dependent groundwater modeling karahan and ayvaz 2005a 2005b spreadsheets are also used for specific problems such as the calculation of groundwater mounding underneath an infiltration basin carleton 2010 and the characterization of seawater intrusion in coastal aquifers callander et al 2011 despite their simplicity and high compatibility with personal computers they mostly run under different versions of microsoft excel spreadsheets for groundwater management have all the typical limitations of desktop based software including e g system dependence manual updating and software installation few attempts have been made to overcome this by developing web based tools recent advances in computational speed as well as improved computational networks and internet accessibility have also facilitated this development in contrast to desktop computing that uses existing computer programs and spreadsheets web tools hold the advantage of increased software availability device and location independence easy maintenance platform and hardware independence as well as resource pooling one key disadvantage is the dependence on an internet connection one such example is strmdepl08 1 1 https mi water usgs gov software groundwater calculatewell index html 19 06 2018 a web based version of a spreadsheet developed by the united states geological survey usgs that uses various analytical solutions to calculate the streamflow depletion caused by nearby pumping wells reeves 2008 the usgs web tool requires the input of various hydrogeological and operational parameters and provides a table of the streamflow depletion over time the environmental software online company 2 2 http www groundwatersoftware com calculator htm 19 06 2018 also provides various online calculators as preliminary screening tools the implemented tools include groundwater mounding calculations a one dimensional transport model based on the advection dispersion equation and hydraulic conductivity estimation from grain size analysis or slug tests valocchi and werth 2004 developed a web based interactive simulator for groundwater pollutant fate and transport for the application in introductory student courses the influence of variable contaminant inputs and groundwater age distributions on contaminant trends in wells or other groundwater discharges can be estimated using another usgs web tool called gamactt 3 3 https ca water usgs gov projects gamactt 19 06 2018 böhlke et al 2014 the tool is only designed for educational uses as the aquifer model and the calculations are highly simplified these web based tools represent an important step forward from classical desktop based spreadsheets and can be applied for educational purposes or as screening tools for various groundwater problems however their principle is quasi identical implying manual input of various parameters for the spreadsheet based calculation of an output value a major drawback of the available web based tools is that values cannot be stored and the later continuation of calculations is not possible the inowas platform presented in this paper closes this gap by combining the graphical representation of results commonly found in spreadsheets with the features and functionality of cloud based computing 2 inowas platform the inowas platform is a free web service aimed to solve groundwater related issues the particularities of the platform include account based simulations with the possibility to save the workflow at any time for later continuation the pooling of tools and open access availability aims to enhance usability of already existing applications the design of the tools is very intuitive with modern standardized graphical user interfaces gui the platform is freely accessible under the following link https inowas hydro tu dresden de user registration is required to access the full functionality of the inowas platform 2 1 architecture the technical infrastructure is based on two components fig 1 the client representing the terminal for the user with internet access via a web browser and the server that consists of a standard linux server hosted by the centre for information services and high performance computing zih of technische universität dresden germany the reactive web based user interface is based on the latest version of reactjs 4 4 https reactjs org 19 06 2018 and redux 5 5 https redux js org license 19 06 2018 two javascript libraries the communication to the server through http commands and rest api is only initiated if the user saves or opens existing tool instances implemented third party libraries such as d3 js 6 6 https d3js org 19 06 2018 help to calculate the analytical equations and visualize their results 2 2 features the core of the platform is the personal dashboard fig 2 with an overview of available tools and projects after selecting a tool from the left menu the user has several options a start a new project with the selected tool b open a previously saved project and continue working on it or c import duplicate a project and use it as basis for a new project for each tool run the system offers two types of confidentiality projects can be either saved as private available only to project owner or public any registered user can access and utilize the data in this way the user can control the access to the tool run and it is guaranteed that sensible or restricted data is protected this advanced dashboard is one of the key features of the inowas platform which is not available in any previously developed web tool furthermore a documentation containing the theoretical background including restrictions and equations a description of the default example and references is available for each tool from a link in the navigation bar 2 3 graphical user interface the web based gui of each tool is comprised of several components a tool sketch conceptual model used as basis for the tool b graph displaying the results and the calculated parameter s c data input panel with sliders for easy parameter input and d message box with additional information settings warning messages or results analysis fig 3 for each tool a default example is displayed upon creation of a new project which can be reset through a button a simplified sub menu allows to rename and save the actual project this standardized gui makes it is easy for the user to get familiar and apply new tools 3 inowas analytical tools the inowas platform was developed aiming to solve groundwater related issues with a particular focus on the planning management and optimization of managed aquifer recharge mar applications nevertheless the platform is not only restricted to mar and it can be applied to solve a wide range of groundwater problems the implemented tools cover a variety of issues that can be evaluated using analytical equations table 1 7 https inowas hydro tu dresden de the implemented tools were chosen as they were already partly implemented in other spreadsheets or web interfaces and fit the general purpose of the inowas platform the documentation pages of the inowas platform 7 or the provided supplementary material give a detailed description of the theoretical background of the implemented tools 3 1 groundwater mounding mar defined as the intentional recharge of water for later recovery or environmental benefits is a valuable tool for the sustainable management of groundwater dillon 2005 the impact of water recharge on the groundwater is an important aspect that needs to be evaluated before a new mar scheme can be implemented for surface infiltration systems the analytical hantush equation hantush 1967 can be used to calculate the groundwater mounding underneath an infiltration basin depending on the recharge rate and duration of recharge the infiltration basin size and aquifer parameters such as the initial groundwater level the specific yield and the hydraulic conductivity 3 2 simple saltwater intrusion equations simple saltwater intrusion equations can help to assess the location of the freshwater saltwater interface in coastal aquifers the tool is divided into five sub tools with the help of the ghyben herzberg relation callander et al 2011 the location of the interface between fresh and saltwater can be approximated under static hydraulic conditions the glover equation callander et al 2011 provides an indication of the shape and extent of the freshwater saltwater interface taking into account the freshwater gradient upconing of saltwater as a function of well pumping in a saline aquifer overlain by a freshwater aquifer can be approximated bear 1999 dagan and bear 1968 schmork and mercado 1969 the maximum well pumping rate where the upconed height does not exceed the critical elevation can be determined which avoids that saltwater intrudes the pumping well the critical well discharge which if exceeded creates an unstable situation where seawater is moving inland to the well can be calculated by the analytical equation of strack 1976 the effects of sea level rise on the migration of saltwater inland can be estimated using the analytical equations developed by werner and simmons 2009 if the coast can be approximated as a vertical cliff or chesnaux 2015 if an inclined coast exists the solution by werner and simmons 2009 underestimates seawater intrusion due to sea level rise if a low inclination of the sea shore exists and the sea boundary is not constant hence in cases where the sea level rise causes an inland progression of the sea boundary the application of the analytical solution developed by chesnaux 2015 is advised which considers the degree of inclination of the coast in addition werner and simmons 2009 assume either a constant head or constant flux boundary inland in the case of constant head groundwater throughflow and the offshore discharge will decrease in response to sea level rise if there is no constant head present the water table height will increase in response to sea level rise constant flux 3 3 pumping induced river drawdown pumping from wells besides streams also referred to as induced riverbank filtration lowers the groundwater level and reduces the surface water flow within the stream if hydraulically connected especially in small streams this can cause harmful effects on the stream and its flora and fauna an understanding of the interaction between groundwater and surface water can help to specify well locations and pumping schedules to minimize these effects hunt 1999 depending on the considered situation different analytical equations can be applied to calculate the stream depletion rate three different boundary condition types have been implemented on the inowas platform they specify whether the stream is fully or partially penetrating and whether streambed resistance is present table 1 3 4 travel time through unconfined aquifer travel times and capture zones are essential parameters to delineate groundwater and wellhead protection zones and to design groundwater remediation systems the travel time through an unconfined aquifer under selected boundary conditions can be calculated using equations developed by chapuis and chesnaux 2006 and chesnaux et al 2005 the solution can be applied to steady state saturated flow systems with a one dimensional horizontal flow according to the dupuit approximation haitjema 1995 kirkham 1967 the unconfined aquifer is recharged by constant surface infiltration and discharges to a fixed head boundary condition the bottom condition is an impervious layer the system is bound by constant head boundary conditions no flow boundaries or pumping wells table 1 the soil is assumed homogeneous and groundwater heads and velocities are assumed not to vary with depth 3 5 one dimensional transport equation ogata banks the knowledge about contaminant concentration distribution behavior along groundwater flow is important for groundwater quality assessment especially for mar applications such as aquifer storage transfer and recovery astr where water is injected into the aquifer through one well and is extracted by another well located some distance away the assessment of groundwater quality is of relevance besides many numerical models analytical models exist to describe the solute transport in groundwater the advection dispersion equation ogata and banks 1961 is a suitable model to describe the transport of solutes in groundwater it assumes primarily one dimensional semi infinity transport where solute concentration is horizontally and vertically well mixed and varies only in the longitudinal or downstream direction the analytical solution helps to determine the concentration of a contaminant down gradient from a constant source at a given distance and time in a homogeneous isotropic and porous aquifer with a constant velocity along the flow direction in addition the influence of retardation on the contaminant transport can be evaluated 4 example application of the inowas platform and validation the rise of groundwater heads below an infiltration basin is calculated using the inowas tool groundwater mounding and the result is validated against an existing excel spreadsheet carleton 2010 the construction of an infiltration basin of size 40 m 20 m is planned to increase groundwater storage the aquifer has a specific yield sy of 0 085 a hydraulic conductivity k of 1 8 md 1 and an initial aquifer thickness hi of 35 m the groundwater depth before the start of the infiltration is 15 m below land surface during infiltration the groundwater should not rise above 10 m below land surface the recharge rate w is projected to be 0 045 md 1 over a duration of 1 5 days with the help of the hantush equation hantush 1967 the aquifer mounding can be calculated on the inowas platform which equals 0 14 m therefore the groundwater table will rise to 14 88 m below land surface in the center of the recharge basin which is less than the maximum rise allowed fig 4 to validate the online implementation the same input parameters were used in the excel spreadsheet of carleton 2010 in contrast to the inowas web tool where metric si units are used the spreadsheet requires the input in feet the groundwater mounding calculated with the help of the excel spreadsheet is 0 471 feet which equals 0 14 m and is the same as the result of the inowas platform 5 conclusion the inowas platform is a compilation of various analytical equations providing open and easy access via standard web browsers which is freely available for noncommercial research and educational purposes the platform offers the user the ability to save tool runs to edit them later or to duplicate another user s tool run new releases and updates including the implementation of further tools and post processing capabilities such as the download of results are progressively integrated on the website advantages of the platform compared to conventional approaches are the cloud based accessibility of project data and the possibility of multi users collaboration through its web based implementation it further makes use of a combination of widely available open source tools and promotes the case based reasoning approach with additional support for parameter estimation and solution finding the compilation of tools into a web based platform allows users to solve various hydrogeological issues fast and easy online which would else been only possible by installing different computer programs on their personal computers compiling various tools into one framework replaces the tedious search for suitable equations the implemented tools can be used as a first rough estimate before other more extensive methods such as numerical modeling or field and laboratory experiments are used the possibility to collaborate with multiple researchers and stakeholders holds the potential to improve the decision making process as recognized by hayley 2017 the technological shift towards cloud computing holds a huge potential to have a positive impact on groundwater research and practice if used effectively the integration of further analytical tools is planned to increase applicability and user circles of the web based platform furthermore the implementation of a numerical groundwater flow model is underway to enhance the platform methodology and allow the application to more complex groundwater management problems glass et al 2017 acknowledgement this study was supported by the german federal ministry of education and research bmbf grant no 01ln1311a junior research group inowas appendix a supplementary data the following is the supplementary data related to this article supplementary material supplementary material appendix a supplementary data supplementary data related to this article can be found at https doi org 10 1016 j envsoft 2018 07 008 
26337,the inowas platform provides a compilation of free web based tools for groundwater management all tools are running on a web server and can be accessed via standard web browsers the implemented analytical equations enable the assessment of saltwater intrusion induced by pumping or sea level rise the calculation of travel time through unconfined aquifers and the evaluation of pumping induced river drawdown the groundwater mounding calculator can be used to estimate the rise of groundwater levels underneath infiltration basins to determine the contaminant concentration downgradient of a constant source an analytical tool solving the advection dispersion equation can be utilized all tools are incorporated into a decision support environment the user is provided with detailed online support that contains the theoretical background of the tools possible applications and examples keywords cloud computing groundwater management analytical equations managed aquifer recharge software availability the inowas platform is accessible via web browser under https inowas hydro tu dresden de free user registration required 1 introduction groundwater is an important water supply resource in many regions that needs to be managed sustainably while meeting societal demands this is especially true with regard to the increasing pressure on groundwater caused by climate change urbanization and population growth flexible methods and tools are needed to assess quantitative and qualitative aspects of groundwater management besides numerical models empirical and analytical equations are frequently used to depict the underlying hydrogeological processes e g callander et al 2011 carleton 2010 halford and kuniansky 2002 to facilitate the use of these equations and to speed up the calculation various spreadsheets have been developed by researchers environmental service operators or governmental agencies these assess a wide range of groundwater related problems from basic hydrogeological investigations such as the estimation of hydraulic conductivity from grain size analysis devlin 2015 or the analysis of pumping and slug test data halford and kuniansky 2002 to more complex tools for the estimation of hydraulic gradients and flow velocities using groundwater head data beljin et al 2014 devlin 2003 and transient or time dependent groundwater modeling karahan and ayvaz 2005a 2005b spreadsheets are also used for specific problems such as the calculation of groundwater mounding underneath an infiltration basin carleton 2010 and the characterization of seawater intrusion in coastal aquifers callander et al 2011 despite their simplicity and high compatibility with personal computers they mostly run under different versions of microsoft excel spreadsheets for groundwater management have all the typical limitations of desktop based software including e g system dependence manual updating and software installation few attempts have been made to overcome this by developing web based tools recent advances in computational speed as well as improved computational networks and internet accessibility have also facilitated this development in contrast to desktop computing that uses existing computer programs and spreadsheets web tools hold the advantage of increased software availability device and location independence easy maintenance platform and hardware independence as well as resource pooling one key disadvantage is the dependence on an internet connection one such example is strmdepl08 1 1 https mi water usgs gov software groundwater calculatewell index html 19 06 2018 a web based version of a spreadsheet developed by the united states geological survey usgs that uses various analytical solutions to calculate the streamflow depletion caused by nearby pumping wells reeves 2008 the usgs web tool requires the input of various hydrogeological and operational parameters and provides a table of the streamflow depletion over time the environmental software online company 2 2 http www groundwatersoftware com calculator htm 19 06 2018 also provides various online calculators as preliminary screening tools the implemented tools include groundwater mounding calculations a one dimensional transport model based on the advection dispersion equation and hydraulic conductivity estimation from grain size analysis or slug tests valocchi and werth 2004 developed a web based interactive simulator for groundwater pollutant fate and transport for the application in introductory student courses the influence of variable contaminant inputs and groundwater age distributions on contaminant trends in wells or other groundwater discharges can be estimated using another usgs web tool called gamactt 3 3 https ca water usgs gov projects gamactt 19 06 2018 böhlke et al 2014 the tool is only designed for educational uses as the aquifer model and the calculations are highly simplified these web based tools represent an important step forward from classical desktop based spreadsheets and can be applied for educational purposes or as screening tools for various groundwater problems however their principle is quasi identical implying manual input of various parameters for the spreadsheet based calculation of an output value a major drawback of the available web based tools is that values cannot be stored and the later continuation of calculations is not possible the inowas platform presented in this paper closes this gap by combining the graphical representation of results commonly found in spreadsheets with the features and functionality of cloud based computing 2 inowas platform the inowas platform is a free web service aimed to solve groundwater related issues the particularities of the platform include account based simulations with the possibility to save the workflow at any time for later continuation the pooling of tools and open access availability aims to enhance usability of already existing applications the design of the tools is very intuitive with modern standardized graphical user interfaces gui the platform is freely accessible under the following link https inowas hydro tu dresden de user registration is required to access the full functionality of the inowas platform 2 1 architecture the technical infrastructure is based on two components fig 1 the client representing the terminal for the user with internet access via a web browser and the server that consists of a standard linux server hosted by the centre for information services and high performance computing zih of technische universität dresden germany the reactive web based user interface is based on the latest version of reactjs 4 4 https reactjs org 19 06 2018 and redux 5 5 https redux js org license 19 06 2018 two javascript libraries the communication to the server through http commands and rest api is only initiated if the user saves or opens existing tool instances implemented third party libraries such as d3 js 6 6 https d3js org 19 06 2018 help to calculate the analytical equations and visualize their results 2 2 features the core of the platform is the personal dashboard fig 2 with an overview of available tools and projects after selecting a tool from the left menu the user has several options a start a new project with the selected tool b open a previously saved project and continue working on it or c import duplicate a project and use it as basis for a new project for each tool run the system offers two types of confidentiality projects can be either saved as private available only to project owner or public any registered user can access and utilize the data in this way the user can control the access to the tool run and it is guaranteed that sensible or restricted data is protected this advanced dashboard is one of the key features of the inowas platform which is not available in any previously developed web tool furthermore a documentation containing the theoretical background including restrictions and equations a description of the default example and references is available for each tool from a link in the navigation bar 2 3 graphical user interface the web based gui of each tool is comprised of several components a tool sketch conceptual model used as basis for the tool b graph displaying the results and the calculated parameter s c data input panel with sliders for easy parameter input and d message box with additional information settings warning messages or results analysis fig 3 for each tool a default example is displayed upon creation of a new project which can be reset through a button a simplified sub menu allows to rename and save the actual project this standardized gui makes it is easy for the user to get familiar and apply new tools 3 inowas analytical tools the inowas platform was developed aiming to solve groundwater related issues with a particular focus on the planning management and optimization of managed aquifer recharge mar applications nevertheless the platform is not only restricted to mar and it can be applied to solve a wide range of groundwater problems the implemented tools cover a variety of issues that can be evaluated using analytical equations table 1 7 https inowas hydro tu dresden de the implemented tools were chosen as they were already partly implemented in other spreadsheets or web interfaces and fit the general purpose of the inowas platform the documentation pages of the inowas platform 7 or the provided supplementary material give a detailed description of the theoretical background of the implemented tools 3 1 groundwater mounding mar defined as the intentional recharge of water for later recovery or environmental benefits is a valuable tool for the sustainable management of groundwater dillon 2005 the impact of water recharge on the groundwater is an important aspect that needs to be evaluated before a new mar scheme can be implemented for surface infiltration systems the analytical hantush equation hantush 1967 can be used to calculate the groundwater mounding underneath an infiltration basin depending on the recharge rate and duration of recharge the infiltration basin size and aquifer parameters such as the initial groundwater level the specific yield and the hydraulic conductivity 3 2 simple saltwater intrusion equations simple saltwater intrusion equations can help to assess the location of the freshwater saltwater interface in coastal aquifers the tool is divided into five sub tools with the help of the ghyben herzberg relation callander et al 2011 the location of the interface between fresh and saltwater can be approximated under static hydraulic conditions the glover equation callander et al 2011 provides an indication of the shape and extent of the freshwater saltwater interface taking into account the freshwater gradient upconing of saltwater as a function of well pumping in a saline aquifer overlain by a freshwater aquifer can be approximated bear 1999 dagan and bear 1968 schmork and mercado 1969 the maximum well pumping rate where the upconed height does not exceed the critical elevation can be determined which avoids that saltwater intrudes the pumping well the critical well discharge which if exceeded creates an unstable situation where seawater is moving inland to the well can be calculated by the analytical equation of strack 1976 the effects of sea level rise on the migration of saltwater inland can be estimated using the analytical equations developed by werner and simmons 2009 if the coast can be approximated as a vertical cliff or chesnaux 2015 if an inclined coast exists the solution by werner and simmons 2009 underestimates seawater intrusion due to sea level rise if a low inclination of the sea shore exists and the sea boundary is not constant hence in cases where the sea level rise causes an inland progression of the sea boundary the application of the analytical solution developed by chesnaux 2015 is advised which considers the degree of inclination of the coast in addition werner and simmons 2009 assume either a constant head or constant flux boundary inland in the case of constant head groundwater throughflow and the offshore discharge will decrease in response to sea level rise if there is no constant head present the water table height will increase in response to sea level rise constant flux 3 3 pumping induced river drawdown pumping from wells besides streams also referred to as induced riverbank filtration lowers the groundwater level and reduces the surface water flow within the stream if hydraulically connected especially in small streams this can cause harmful effects on the stream and its flora and fauna an understanding of the interaction between groundwater and surface water can help to specify well locations and pumping schedules to minimize these effects hunt 1999 depending on the considered situation different analytical equations can be applied to calculate the stream depletion rate three different boundary condition types have been implemented on the inowas platform they specify whether the stream is fully or partially penetrating and whether streambed resistance is present table 1 3 4 travel time through unconfined aquifer travel times and capture zones are essential parameters to delineate groundwater and wellhead protection zones and to design groundwater remediation systems the travel time through an unconfined aquifer under selected boundary conditions can be calculated using equations developed by chapuis and chesnaux 2006 and chesnaux et al 2005 the solution can be applied to steady state saturated flow systems with a one dimensional horizontal flow according to the dupuit approximation haitjema 1995 kirkham 1967 the unconfined aquifer is recharged by constant surface infiltration and discharges to a fixed head boundary condition the bottom condition is an impervious layer the system is bound by constant head boundary conditions no flow boundaries or pumping wells table 1 the soil is assumed homogeneous and groundwater heads and velocities are assumed not to vary with depth 3 5 one dimensional transport equation ogata banks the knowledge about contaminant concentration distribution behavior along groundwater flow is important for groundwater quality assessment especially for mar applications such as aquifer storage transfer and recovery astr where water is injected into the aquifer through one well and is extracted by another well located some distance away the assessment of groundwater quality is of relevance besides many numerical models analytical models exist to describe the solute transport in groundwater the advection dispersion equation ogata and banks 1961 is a suitable model to describe the transport of solutes in groundwater it assumes primarily one dimensional semi infinity transport where solute concentration is horizontally and vertically well mixed and varies only in the longitudinal or downstream direction the analytical solution helps to determine the concentration of a contaminant down gradient from a constant source at a given distance and time in a homogeneous isotropic and porous aquifer with a constant velocity along the flow direction in addition the influence of retardation on the contaminant transport can be evaluated 4 example application of the inowas platform and validation the rise of groundwater heads below an infiltration basin is calculated using the inowas tool groundwater mounding and the result is validated against an existing excel spreadsheet carleton 2010 the construction of an infiltration basin of size 40 m 20 m is planned to increase groundwater storage the aquifer has a specific yield sy of 0 085 a hydraulic conductivity k of 1 8 md 1 and an initial aquifer thickness hi of 35 m the groundwater depth before the start of the infiltration is 15 m below land surface during infiltration the groundwater should not rise above 10 m below land surface the recharge rate w is projected to be 0 045 md 1 over a duration of 1 5 days with the help of the hantush equation hantush 1967 the aquifer mounding can be calculated on the inowas platform which equals 0 14 m therefore the groundwater table will rise to 14 88 m below land surface in the center of the recharge basin which is less than the maximum rise allowed fig 4 to validate the online implementation the same input parameters were used in the excel spreadsheet of carleton 2010 in contrast to the inowas web tool where metric si units are used the spreadsheet requires the input in feet the groundwater mounding calculated with the help of the excel spreadsheet is 0 471 feet which equals 0 14 m and is the same as the result of the inowas platform 5 conclusion the inowas platform is a compilation of various analytical equations providing open and easy access via standard web browsers which is freely available for noncommercial research and educational purposes the platform offers the user the ability to save tool runs to edit them later or to duplicate another user s tool run new releases and updates including the implementation of further tools and post processing capabilities such as the download of results are progressively integrated on the website advantages of the platform compared to conventional approaches are the cloud based accessibility of project data and the possibility of multi users collaboration through its web based implementation it further makes use of a combination of widely available open source tools and promotes the case based reasoning approach with additional support for parameter estimation and solution finding the compilation of tools into a web based platform allows users to solve various hydrogeological issues fast and easy online which would else been only possible by installing different computer programs on their personal computers compiling various tools into one framework replaces the tedious search for suitable equations the implemented tools can be used as a first rough estimate before other more extensive methods such as numerical modeling or field and laboratory experiments are used the possibility to collaborate with multiple researchers and stakeholders holds the potential to improve the decision making process as recognized by hayley 2017 the technological shift towards cloud computing holds a huge potential to have a positive impact on groundwater research and practice if used effectively the integration of further analytical tools is planned to increase applicability and user circles of the web based platform furthermore the implementation of a numerical groundwater flow model is underway to enhance the platform methodology and allow the application to more complex groundwater management problems glass et al 2017 acknowledgement this study was supported by the german federal ministry of education and research bmbf grant no 01ln1311a junior research group inowas appendix a supplementary data the following is the supplementary data related to this article supplementary material supplementary material appendix a supplementary data supplementary data related to this article can be found at https doi org 10 1016 j envsoft 2018 07 008 
26338,this short communication describes a new open source implementation of the calvin model california value integrated network a large scale network flow optimization model of california s water supply system the model is cross platform uses common data formats and connects to several freely available linear programming solvers given inputs including hydrology urban agricultural demand curves and variable operating costs the model minimizes the systemwide cost of water scarcity and operations including surface and groundwater reservoirs wastewater reuse desalination environmental flow requirements and hydropower key outputs include water shortage costs and marginal economic values of water and infrastructure capacity we benchmark the scalability of different solvers up to roughly 5 million decision variables using shared memory parallelization on a high performance computing cluster runtimes are reduced by two orders of magnitude relative to the original model when no initial solution is provided in addition to the benefits such as accessibility and transparency that come with an open source platform while this model is specific to california the data and model structure are separated so a similar framework could be used in any system where water allocation has been formulated as a network flow problem keywords hydroeconomic modeling network flow optimization multi reservoir operations software availability name of software calvin python version description an open source hydroeconomic model that optimizes water allocation to agricultural and urban users in california originally developed by draper et al 2003 built on top of the pyomo library hart et al 2012 storage and demand nodes are connected in a network structure the dataset is hosted here https github com ucd cws calvin network data developers m dogan m fefer j herman q hart j merz funding source development was partially supported by the california energy commission 4th climate change assessment award em4cd3 04a and by nsf cybersees award 1539593 high performance computing resources provided by the uc davis college of engineering source language python 2 7 3 4 supported systems unix linux windows mac license mit license availability https github com ucd cws calvin 1 background 1 1 hydroeconomic modeling hydroeconomic models combine water resources systems engineering and economics where water allocations are driven by economic value and conversely economic costs and benefits are impacted by hydrology cai 2008 harou et al 2009 booker et al 2012 optimization models incorporating economic objectives have been used extensively to evaluate water resources planning and management decisions over the past decades labadie 2004 draper et al 2003 first introduced calvin california value integrated network a hydroeconomic model describing california s water supply infrastructure including surface and groundwater reservoirs urban and agricultural demands environmental flow requirements hydropower production wastewater reuse and desalination facilities plus urban and agricultural water conservation the model has since been used in numerous studies with topics ranging from climate adaptation to groundwater overdraft subsequent authors have updated the structure and parameters of the model to reflect changes in water demands and environmental requirements the economic optimization framework is unique among statewide california models and provides results such as willingness to pay for additional water delivery and marginal value of increased conveyance and storage capacities other large scale water resources studies in california have included contributions to groundwater modeling dogrul et al 2016 agricultural economics howitt et al 2012 winter et al 2017 and multi objective analysis quinn et al 2004 yang et al 2015 the vast improvements in computing power since calvin s inception and its ability to explore potential scenarios in california water supply provide an opportunity to move the network structure and data to a new optimization platform this short communication describes the outcome of this effort following some general design goals cross platform model should run on windows osx linux open data formats input and output data should use only non proprietary formats such as csv and json freely available programming language and solvers should be free and open source several solvers described in this work are cost free only for academic use but they are not strictly required separation of model and data the hobbes project https hobbes ucdavis edu stores the network dataset independent from any particular model allowing this work to use multiple state of the art solvers or models in the process of meeting these goals a few specific features are added as described in section 2 1 2 network flow optimization calvin is a network flow optimization model seeking to minimize statewide operating and water scarcity cost subject to physical and regulatory constraints network flow problems commonly appear in energy and transportation problems in addition to water references such as bazaraa et al 1977 provide detailed explanation and solution methods for network flow programming the physical system is represented by a set of nodes n and links a links are defined by i j k a where i is the source node j j i is the destination node and k is the index of the piecewise linear component for links each link has the following properties flow x i j k the decision variable unit cost c i j k lower bound l i j k upper bound u i j k and amplitude loss factor a i j k the objective function and constraints are 1 min x z i j k c i j k x i j k subject to 2 x i j k u i j k i j k a 3 x i j k l i j k i j k a 4 i k x j i k i k a i j k x i j k 0 j n the objective function equation 1 is a summation over all links i j k representing the total cost of flow conveyed in the network the constraints equations 2 4 enforce the upper and lower bounds on each link and the mass balance at each node respectively the lower bound constraints include non negativity l i j k 0 i j k the network flow formulation is a suitable model for large scale water supply operations but many other approaches have been proposed to model multi reservoir systems e g labadie 2004 matrosov et al 2011 li et al 2015 giuliani et al 2016 the version of the model published by draper et al 2003 and used in subsequent studies employs the hec prm solver created by the u s army corps of engineers hydrologic engineering center this solver uses the out of kilter method for network flow optimization and stores data in the binary hec dss format it is available for the windows operating system the calvin model requires approximately one week to solve using this software platform without an approximate initial solution 2 model description 2 1 california network dataset hobbes to implement the model equations 1 4 a set of nodes links and their properties must be provided as part of this work the database for california s water supply network has been migrated to the hobbes platform https hobbes ucdavis edu unlike previous large scale water resources optimization models the hobbes web based framework separates the network data from the model specific optimization method this approach is intended to facilitate data standardization and documentation increase transparency reduce overhead development costs and enhance modeling collaborations between academic industry government agencies and non governmental organizations medellín azuara et al 2013 similar benefits have been observed across a range of water resources web applications swain et al 2015 hobbes combines a web visualization of the network https hobbes ucdavis edu cwn with the underlying database and metadata in json format https github com ucd cws calvin network data the platform also includes automated scripts to export the database to a csv format compatible with most solvers the calvin github repository provides links to csv files that have been exported using this tool each row of the exported csv file represents one link the first two columns contain strings representing the names of the source and destination nodes i j the following columns contain the piecewise index k cost c amplitude a lower bound l and upper bound u the dataset currently covers the period 1922 2003 on a monthly timestep water scarcity costs are represented by piecewise linear functions for projected urban and agricultural demands in 2050 medellin azuara et al 2007 dogan et al in review the physical network contains approximately 1000 spatial nodes and 60 000 links selected types of which are shown in fig 1 the network model contains a copy of each node for each timestep where links between timesteps represent storage at surface and groundwater storage nodes therefore the size of the optimization problem increases linearly with the length of the model period a 1 year model run contains approximately 60 000 decision variables links while the full 82 year run contains over 5 million decision variables including piecewise linear water shortage and operating costs these values also include optional debug links to address potential infeasibilities in the optimization which are described in section 2 3 and account for roughly 40 of the links in the model 2 2 dependencies and installation the model requires the python programming language and its standard scientific libraries numpy scipy pandas we recommend the anaconda distribution https www continuum io downloads to easily download and maintain these standard packages beyond this the pyomo library hart et al 2012 is also required and is not included with the standard packages in the anaconda distribution pyomo provides a high level interface for problem formulation that can be linked to different solvers in the spirit of algebraic modeling languages such as gams and ampl solvers must be installed separately a simple method to install pyomo along with the glpk solver makhorin et al 2008 using a command line package manager is shown in the readme file of this repository in this short communication we also investigate the performance of the cbc forrest 2012 gurobi 2014 and cplex ibm 2009 solvers all of which are free for academic use glpk and cbc are also free for commercial use installing these solvers and connecting to pyomo must be done outside of the standard package managers and we refer the reader to their respective documentation the calvin model can be obtained by cloning or downloading the github repository linked in the software availability section hash a6a9fe7 may 2018 links to download the network data in csv format are provided in the readme 2 3 resolving infeasibilities the default model configurations should solve without issue following the steps to be described in section 2 5 however when parameters are changed for example hydrologic inputs the problem may become infeasible which the solvers will quickly recognize to locate and fix the constraints causing this problem the package includes the option to run in debug mode this is an automated version of a heuristic approach that has been developed in prior studies tanaka et al 2006 medellin azuara et al 2007 debug mode adds two additional nodes super source and super sink which are linked to all other nodes in the network at each timestep these links can respectively add or remove as much water as needed for the infeasible constraints to become feasible but at a very high cost values ranging from 10 6 10 10 per acre foot have been used orders of magnitude higher than any physically based cost in the network so the solver will only allow flow on the debug links necessary for feasibility the magnitude of these flows typically small is used to either decrease lower bound constraints increase upper bound constraints or otherwise identify input errors the numerical tolerance to identify debug flows can be set by the user the default tolerance is 10 7 acre feet per month the debug process also reports the total volume of constraint alterations when it is finished multiple iterations may be needed to eliminate all debug flows after which the debug links are removed and the model can be solved this debugging process increases the runtime substantially because the model must be solved an additional 5 10 times however it is a straightforward way to obtain a feasible solution for a large model with a modified set of input parameters 2 4 perfect vs limited foresight when optimizing over decades long time periods the operation of surface and groundwater storage can be determined with perfect foresight of future dry and wet years the limitations of this assumption have long been recognized e g newlin et al 2002 tanaka et al 2006 moving to a new software platform offers the flexibility to investigate the alternative assumption of limited foresight where sequential annual optimizations apply the end of period storage from each year as the initial condition for the following year the key challenge is defining optimization constraints or values for the end of period minimum carryover storage to analyze the effect of carryover storage constraints we vary them as a percentage of available surface reservoir capacity above dead pool from 0 to 50 in steps of 5 groundwater storage volumes are constrained to the optimal end of year storage from the full 82 year run with perfect foresight this assumption introduces more information into the limited foresight model but prevents the limited foresight model from overdrafting groundwater to compensate for periods of low surface water availability further it is a simplifying assumption that all of the large surface reservoirs would be operated for the same carryover targets as a percentage of their respective capacities this may increase costs relative to individually specified carryover targets more advanced methods to assign economic value to carryover storage at individual reservoirs are presented in draper 2001 draper and lund 2004 fig 2 a shows that a minimum carryover storage constraint of about 5 million acre feet maf or roughly 10 above dead pool results in the lowest average annual cost the average annual shortage cost is only three times that in the perfect foresight case beyond that point costs increase because storing too much for future years increases shortages in the current year the timeseries in fig 2b shows that the limited foresight optimization is prone to spikes in annual shortage cost during drought years when they normally occur whereas the perfect foresight model more evenly distributes cost over the period limited foresight reflects more realistic management since accurate forecasts of drought events are not available years in advance the annual timestep moves the model closer to a simulation model but one in which network flows within each year are optimized assuming perfect foresight we additionally expect the marginal value of storage capacity to increase under the limited foresight assumption reflected in the dual values on the reservoir capacity constraints limited foresight mode is a new addition to the calvin model which has been enabled by the move to a new software platform the impacts of limited foresight on water allocation and cost remain the subject of ongoing research section 2 5 contains an example of running connected annual optimizations in a loop 2 5 examples fig 3 shows how to run a 1 year optimization for water year 1922 beginning october 1921 the network data is imported from a csv file the model is first run in debug mode to eliminate infeasibilities the results from pyomo are postprocessed and stored in the directory example results results include a set of eight csv files flow csv the flow on each link taf month storage csv surface and groundwater storage volumes at the end of each month taf dual lower csv dual upper csv and dual node csv which are respectively the dual values shadow prices on the lower upper bound of each link and the dual values on the mass balance constraint at each node the final three files are shortage volume csv and shortage cost csv given on selected links and evaporation csv given at storage nodes all results files contain 1 row for each month of the model run and the columns are either link or node names as appropriate the csv output format allows the results to be analyzed and plotted using any standard software this 1 year example solves with glpk in approximately 1 5 min on a desktop computer including two iterations of debug mode fig 4 shows how the limited foresight model can be run with multiple connected annual optimizations at the start of each iteration the model is created with initial conditions taken from the previous period s ending storage the end of period constraint is set to 10 of available capacity above dead pool as suggested by the results in fig 2 each year is first run in debug mode which may require several iterations before solving for a feasible solution without debug mode results from each year are appended to the output csv files this example will require much more computing time than the 1 year run shown in fig 3 a rough estimate would be to multiply by the number of years but this will not be exact due to differences in the number of debug mode iterations between years the examples in figs 3 and 4 would not require much modification to run different experiments in fact the most common changes such as hydrologic inputs and network connections would be made in the network links data file csv and would not require any changes to the code advanced users seeking more information about the internal functions in the model should refer to the docstrings for each function on github 3 runtime benchmarks several state of the art linear programming solvers are available it is useful to compare how runtimes increase with the number of decision variables for this problem the number of decision variables can be controlled by the number of years used in the optimization here we experiment with model runs of 1 5 10 40 and 82 years and record the solver runtime required in each case in debug mode excluding time for file reading and writing only one debug iteration is needed because these historical runs do not contain infeasibilities four solvers are tested cbc cplex gurobi and glpk with 10 trials for each combination of solver and model size for a total of 200 model runs tests are performed on the uc davis hpc1 cluster which contains 60 nodes each with 64 gb of ram and two 8 core dual threaded cpus running at 2 4 ghz the cplex gurobi and cbc solvers use shared memory parallelization on 32 threads while glpk runs in serial fig 5 shows solver runtimes with increasing numbers of decision variables these results assume perfect foresight runtime analysis of the limited foresight model remains a subject of ongoing work gurobi takes the least amount of time to find an optimal solution for all model sizes gurobi requires roughly 30 min to solve the largest model with about five million decision variables in debug mode while glpk serial requires roughly 4 5 days the speedup is partially a function of parallelization but also the use of different techniques within each solver the hec prm solver used in the prior version of the model also runs in serial and requires roughly 7 days to solve without an initial solution glpk shows a comparable order of magnitude as indicated by the regression lines in fig 5 solver solution times show a polynomial relationship with the number of decision variables linear on a log log scale these relationships are all approximately quadratic though gurobi again displays the best result of o n 1 55 runtimes are consistent between trials with only one outlier for cplex with the largest model size a runtime of 1 day in fig 5 because the solution method is deterministic this outlier is likely due to a slowdown in either communication or file reading on the high performance computing system rather than the solver itself further runtime improvements for all four solvers may be obtained by providing an initial solution based on previous results a technique which has been used in previous studies these results provide an application focused runtime benchmark for large scale network problems 4 conclusion this short communication describes a new open source implementation of the calvin model a large scale network flow optimization model of california s water supply system the model is built on top of the pyomo library and connects to multiple linear programming solvers that are freely available for academic use the increased flexibility provided by this platform has enabled preliminary investigations into limited foresight optimization as well as runtime benchmarks for different solvers on a high performance computing cluster the model runs on any operating system compatible with python and uses only non proprietary data formats so that the input and output data can be easily analyzed this software contribution is intended to facilitate future studies by researchers interested in economically driven water resources allocation in california acknowledgments this work was partially supported by the california energy commission 4th climate change assessment award em4cd3 04a and by nsf cybersees award 1539593 high performance computing resources were provided by the uc davis college of engineering 
26338,this short communication describes a new open source implementation of the calvin model california value integrated network a large scale network flow optimization model of california s water supply system the model is cross platform uses common data formats and connects to several freely available linear programming solvers given inputs including hydrology urban agricultural demand curves and variable operating costs the model minimizes the systemwide cost of water scarcity and operations including surface and groundwater reservoirs wastewater reuse desalination environmental flow requirements and hydropower key outputs include water shortage costs and marginal economic values of water and infrastructure capacity we benchmark the scalability of different solvers up to roughly 5 million decision variables using shared memory parallelization on a high performance computing cluster runtimes are reduced by two orders of magnitude relative to the original model when no initial solution is provided in addition to the benefits such as accessibility and transparency that come with an open source platform while this model is specific to california the data and model structure are separated so a similar framework could be used in any system where water allocation has been formulated as a network flow problem keywords hydroeconomic modeling network flow optimization multi reservoir operations software availability name of software calvin python version description an open source hydroeconomic model that optimizes water allocation to agricultural and urban users in california originally developed by draper et al 2003 built on top of the pyomo library hart et al 2012 storage and demand nodes are connected in a network structure the dataset is hosted here https github com ucd cws calvin network data developers m dogan m fefer j herman q hart j merz funding source development was partially supported by the california energy commission 4th climate change assessment award em4cd3 04a and by nsf cybersees award 1539593 high performance computing resources provided by the uc davis college of engineering source language python 2 7 3 4 supported systems unix linux windows mac license mit license availability https github com ucd cws calvin 1 background 1 1 hydroeconomic modeling hydroeconomic models combine water resources systems engineering and economics where water allocations are driven by economic value and conversely economic costs and benefits are impacted by hydrology cai 2008 harou et al 2009 booker et al 2012 optimization models incorporating economic objectives have been used extensively to evaluate water resources planning and management decisions over the past decades labadie 2004 draper et al 2003 first introduced calvin california value integrated network a hydroeconomic model describing california s water supply infrastructure including surface and groundwater reservoirs urban and agricultural demands environmental flow requirements hydropower production wastewater reuse and desalination facilities plus urban and agricultural water conservation the model has since been used in numerous studies with topics ranging from climate adaptation to groundwater overdraft subsequent authors have updated the structure and parameters of the model to reflect changes in water demands and environmental requirements the economic optimization framework is unique among statewide california models and provides results such as willingness to pay for additional water delivery and marginal value of increased conveyance and storage capacities other large scale water resources studies in california have included contributions to groundwater modeling dogrul et al 2016 agricultural economics howitt et al 2012 winter et al 2017 and multi objective analysis quinn et al 2004 yang et al 2015 the vast improvements in computing power since calvin s inception and its ability to explore potential scenarios in california water supply provide an opportunity to move the network structure and data to a new optimization platform this short communication describes the outcome of this effort following some general design goals cross platform model should run on windows osx linux open data formats input and output data should use only non proprietary formats such as csv and json freely available programming language and solvers should be free and open source several solvers described in this work are cost free only for academic use but they are not strictly required separation of model and data the hobbes project https hobbes ucdavis edu stores the network dataset independent from any particular model allowing this work to use multiple state of the art solvers or models in the process of meeting these goals a few specific features are added as described in section 2 1 2 network flow optimization calvin is a network flow optimization model seeking to minimize statewide operating and water scarcity cost subject to physical and regulatory constraints network flow problems commonly appear in energy and transportation problems in addition to water references such as bazaraa et al 1977 provide detailed explanation and solution methods for network flow programming the physical system is represented by a set of nodes n and links a links are defined by i j k a where i is the source node j j i is the destination node and k is the index of the piecewise linear component for links each link has the following properties flow x i j k the decision variable unit cost c i j k lower bound l i j k upper bound u i j k and amplitude loss factor a i j k the objective function and constraints are 1 min x z i j k c i j k x i j k subject to 2 x i j k u i j k i j k a 3 x i j k l i j k i j k a 4 i k x j i k i k a i j k x i j k 0 j n the objective function equation 1 is a summation over all links i j k representing the total cost of flow conveyed in the network the constraints equations 2 4 enforce the upper and lower bounds on each link and the mass balance at each node respectively the lower bound constraints include non negativity l i j k 0 i j k the network flow formulation is a suitable model for large scale water supply operations but many other approaches have been proposed to model multi reservoir systems e g labadie 2004 matrosov et al 2011 li et al 2015 giuliani et al 2016 the version of the model published by draper et al 2003 and used in subsequent studies employs the hec prm solver created by the u s army corps of engineers hydrologic engineering center this solver uses the out of kilter method for network flow optimization and stores data in the binary hec dss format it is available for the windows operating system the calvin model requires approximately one week to solve using this software platform without an approximate initial solution 2 model description 2 1 california network dataset hobbes to implement the model equations 1 4 a set of nodes links and their properties must be provided as part of this work the database for california s water supply network has been migrated to the hobbes platform https hobbes ucdavis edu unlike previous large scale water resources optimization models the hobbes web based framework separates the network data from the model specific optimization method this approach is intended to facilitate data standardization and documentation increase transparency reduce overhead development costs and enhance modeling collaborations between academic industry government agencies and non governmental organizations medellín azuara et al 2013 similar benefits have been observed across a range of water resources web applications swain et al 2015 hobbes combines a web visualization of the network https hobbes ucdavis edu cwn with the underlying database and metadata in json format https github com ucd cws calvin network data the platform also includes automated scripts to export the database to a csv format compatible with most solvers the calvin github repository provides links to csv files that have been exported using this tool each row of the exported csv file represents one link the first two columns contain strings representing the names of the source and destination nodes i j the following columns contain the piecewise index k cost c amplitude a lower bound l and upper bound u the dataset currently covers the period 1922 2003 on a monthly timestep water scarcity costs are represented by piecewise linear functions for projected urban and agricultural demands in 2050 medellin azuara et al 2007 dogan et al in review the physical network contains approximately 1000 spatial nodes and 60 000 links selected types of which are shown in fig 1 the network model contains a copy of each node for each timestep where links between timesteps represent storage at surface and groundwater storage nodes therefore the size of the optimization problem increases linearly with the length of the model period a 1 year model run contains approximately 60 000 decision variables links while the full 82 year run contains over 5 million decision variables including piecewise linear water shortage and operating costs these values also include optional debug links to address potential infeasibilities in the optimization which are described in section 2 3 and account for roughly 40 of the links in the model 2 2 dependencies and installation the model requires the python programming language and its standard scientific libraries numpy scipy pandas we recommend the anaconda distribution https www continuum io downloads to easily download and maintain these standard packages beyond this the pyomo library hart et al 2012 is also required and is not included with the standard packages in the anaconda distribution pyomo provides a high level interface for problem formulation that can be linked to different solvers in the spirit of algebraic modeling languages such as gams and ampl solvers must be installed separately a simple method to install pyomo along with the glpk solver makhorin et al 2008 using a command line package manager is shown in the readme file of this repository in this short communication we also investigate the performance of the cbc forrest 2012 gurobi 2014 and cplex ibm 2009 solvers all of which are free for academic use glpk and cbc are also free for commercial use installing these solvers and connecting to pyomo must be done outside of the standard package managers and we refer the reader to their respective documentation the calvin model can be obtained by cloning or downloading the github repository linked in the software availability section hash a6a9fe7 may 2018 links to download the network data in csv format are provided in the readme 2 3 resolving infeasibilities the default model configurations should solve without issue following the steps to be described in section 2 5 however when parameters are changed for example hydrologic inputs the problem may become infeasible which the solvers will quickly recognize to locate and fix the constraints causing this problem the package includes the option to run in debug mode this is an automated version of a heuristic approach that has been developed in prior studies tanaka et al 2006 medellin azuara et al 2007 debug mode adds two additional nodes super source and super sink which are linked to all other nodes in the network at each timestep these links can respectively add or remove as much water as needed for the infeasible constraints to become feasible but at a very high cost values ranging from 10 6 10 10 per acre foot have been used orders of magnitude higher than any physically based cost in the network so the solver will only allow flow on the debug links necessary for feasibility the magnitude of these flows typically small is used to either decrease lower bound constraints increase upper bound constraints or otherwise identify input errors the numerical tolerance to identify debug flows can be set by the user the default tolerance is 10 7 acre feet per month the debug process also reports the total volume of constraint alterations when it is finished multiple iterations may be needed to eliminate all debug flows after which the debug links are removed and the model can be solved this debugging process increases the runtime substantially because the model must be solved an additional 5 10 times however it is a straightforward way to obtain a feasible solution for a large model with a modified set of input parameters 2 4 perfect vs limited foresight when optimizing over decades long time periods the operation of surface and groundwater storage can be determined with perfect foresight of future dry and wet years the limitations of this assumption have long been recognized e g newlin et al 2002 tanaka et al 2006 moving to a new software platform offers the flexibility to investigate the alternative assumption of limited foresight where sequential annual optimizations apply the end of period storage from each year as the initial condition for the following year the key challenge is defining optimization constraints or values for the end of period minimum carryover storage to analyze the effect of carryover storage constraints we vary them as a percentage of available surface reservoir capacity above dead pool from 0 to 50 in steps of 5 groundwater storage volumes are constrained to the optimal end of year storage from the full 82 year run with perfect foresight this assumption introduces more information into the limited foresight model but prevents the limited foresight model from overdrafting groundwater to compensate for periods of low surface water availability further it is a simplifying assumption that all of the large surface reservoirs would be operated for the same carryover targets as a percentage of their respective capacities this may increase costs relative to individually specified carryover targets more advanced methods to assign economic value to carryover storage at individual reservoirs are presented in draper 2001 draper and lund 2004 fig 2 a shows that a minimum carryover storage constraint of about 5 million acre feet maf or roughly 10 above dead pool results in the lowest average annual cost the average annual shortage cost is only three times that in the perfect foresight case beyond that point costs increase because storing too much for future years increases shortages in the current year the timeseries in fig 2b shows that the limited foresight optimization is prone to spikes in annual shortage cost during drought years when they normally occur whereas the perfect foresight model more evenly distributes cost over the period limited foresight reflects more realistic management since accurate forecasts of drought events are not available years in advance the annual timestep moves the model closer to a simulation model but one in which network flows within each year are optimized assuming perfect foresight we additionally expect the marginal value of storage capacity to increase under the limited foresight assumption reflected in the dual values on the reservoir capacity constraints limited foresight mode is a new addition to the calvin model which has been enabled by the move to a new software platform the impacts of limited foresight on water allocation and cost remain the subject of ongoing research section 2 5 contains an example of running connected annual optimizations in a loop 2 5 examples fig 3 shows how to run a 1 year optimization for water year 1922 beginning october 1921 the network data is imported from a csv file the model is first run in debug mode to eliminate infeasibilities the results from pyomo are postprocessed and stored in the directory example results results include a set of eight csv files flow csv the flow on each link taf month storage csv surface and groundwater storage volumes at the end of each month taf dual lower csv dual upper csv and dual node csv which are respectively the dual values shadow prices on the lower upper bound of each link and the dual values on the mass balance constraint at each node the final three files are shortage volume csv and shortage cost csv given on selected links and evaporation csv given at storage nodes all results files contain 1 row for each month of the model run and the columns are either link or node names as appropriate the csv output format allows the results to be analyzed and plotted using any standard software this 1 year example solves with glpk in approximately 1 5 min on a desktop computer including two iterations of debug mode fig 4 shows how the limited foresight model can be run with multiple connected annual optimizations at the start of each iteration the model is created with initial conditions taken from the previous period s ending storage the end of period constraint is set to 10 of available capacity above dead pool as suggested by the results in fig 2 each year is first run in debug mode which may require several iterations before solving for a feasible solution without debug mode results from each year are appended to the output csv files this example will require much more computing time than the 1 year run shown in fig 3 a rough estimate would be to multiply by the number of years but this will not be exact due to differences in the number of debug mode iterations between years the examples in figs 3 and 4 would not require much modification to run different experiments in fact the most common changes such as hydrologic inputs and network connections would be made in the network links data file csv and would not require any changes to the code advanced users seeking more information about the internal functions in the model should refer to the docstrings for each function on github 3 runtime benchmarks several state of the art linear programming solvers are available it is useful to compare how runtimes increase with the number of decision variables for this problem the number of decision variables can be controlled by the number of years used in the optimization here we experiment with model runs of 1 5 10 40 and 82 years and record the solver runtime required in each case in debug mode excluding time for file reading and writing only one debug iteration is needed because these historical runs do not contain infeasibilities four solvers are tested cbc cplex gurobi and glpk with 10 trials for each combination of solver and model size for a total of 200 model runs tests are performed on the uc davis hpc1 cluster which contains 60 nodes each with 64 gb of ram and two 8 core dual threaded cpus running at 2 4 ghz the cplex gurobi and cbc solvers use shared memory parallelization on 32 threads while glpk runs in serial fig 5 shows solver runtimes with increasing numbers of decision variables these results assume perfect foresight runtime analysis of the limited foresight model remains a subject of ongoing work gurobi takes the least amount of time to find an optimal solution for all model sizes gurobi requires roughly 30 min to solve the largest model with about five million decision variables in debug mode while glpk serial requires roughly 4 5 days the speedup is partially a function of parallelization but also the use of different techniques within each solver the hec prm solver used in the prior version of the model also runs in serial and requires roughly 7 days to solve without an initial solution glpk shows a comparable order of magnitude as indicated by the regression lines in fig 5 solver solution times show a polynomial relationship with the number of decision variables linear on a log log scale these relationships are all approximately quadratic though gurobi again displays the best result of o n 1 55 runtimes are consistent between trials with only one outlier for cplex with the largest model size a runtime of 1 day in fig 5 because the solution method is deterministic this outlier is likely due to a slowdown in either communication or file reading on the high performance computing system rather than the solver itself further runtime improvements for all four solvers may be obtained by providing an initial solution based on previous results a technique which has been used in previous studies these results provide an application focused runtime benchmark for large scale network problems 4 conclusion this short communication describes a new open source implementation of the calvin model a large scale network flow optimization model of california s water supply system the model is built on top of the pyomo library and connects to multiple linear programming solvers that are freely available for academic use the increased flexibility provided by this platform has enabled preliminary investigations into limited foresight optimization as well as runtime benchmarks for different solvers on a high performance computing cluster the model runs on any operating system compatible with python and uses only non proprietary data formats so that the input and output data can be easily analyzed this software contribution is intended to facilitate future studies by researchers interested in economically driven water resources allocation in california acknowledgments this work was partially supported by the california energy commission 4th climate change assessment award em4cd3 04a and by nsf cybersees award 1539593 high performance computing resources were provided by the uc davis college of engineering 
26339,cellular automata ca approaches in wildfire modelling are computationally more efficient than vector based methods despite this advantage these methods suffer from the lack of physical basis and distortion in simulated fire shapes to overcome these drawbacks and to perform a real time interactive crown fire simulation for training use a new ca model is proposed in which a new spread mechanism is introduced based on the physical equations of reaction and radiation then through a series of crown fire simulations in uniform and heterogeneous synthetic fuel beds the functional validation of the model and the sensitivity analyses on vegetation parameters are performed finally a case study is discussed to illustrate the application of the model with real world data without any mathematical correction this method is intrinsically free from the distortion problems found in several ca approaches keywords cellular automata crown fire behaviour shape distortion real time simulation software availability name of the software svica simulator developer yuxuan liu contact information yuxuan liu buaa edu cn hardware required general purpose computer with standalone graphics card software required unity 5 2 3 or higher programming languages c availability contact the developer year first available 2017 1 introduction forest fires play a dominant role in the renewal of plant communities and ecosystem regeneration jpa et al 2007 however uncontrolled forest fires are a critical natural hazard worldwide and cause enormous ecological destruction economic losses and significant casualties sun et al 2013 and their intensity has increased in recent years jellouli et al 2016 therefore these human and socioeconomic damages increase the demand to improve knowledge of fires collin et al 2010 particularly the modelling and simulation of forest fire behaviours before and after the disaster the simulation models could determine the fire risk of local artificial situations and evaluate the effects of different fire fighting policies based on historical data in the given area dunn 2007 fire suppression tactics could be deployed by water dropping helicopters and air tankers particularly seawater planes alexandridis et al 2011 but the inefficient use of aviation resources leads to an increase in suppression costs thompson et al 2013 additionally firefighting trainings could be realized in safe simulated environments with low costs to improve the efficiency of outfires in actual forests hence a real time interactive crown fire behaviour model is needed in recent decades with the increasing capabilities in remote sensing geographical information systems gis and computing power several simulation models have been developed to better understand the behaviours and effects of forest fires the most important models of wildland fire behaviour have been summarized and classified in studies by perry 1998 pastor et al 2003 and sullivan 2009a the classification of these models is listed below according to the fire types ground fire models the combustible target of the ground fire model is the vegetal stratum below the surface litter layer which is formed by fermentation and humus layers surface fire models the surface fire spreads through surface fuels consisting of small trees bushes herbaceous vegetation and fallen trunks which are less than 2 m high spotting fire models the spotting fire model comprises pieces of burning material transported by a convection column and carried beyond the main perimeter of the fire crown fire models the fuel bed of crown fires is formed by surface and aerial vegetation strata in particular an active crown fire is defined when the fire front spreads through the two strata as a unit and a passive crown fire is that in which tree crowns are individually ignited by the surface fire compared to other types of fires crown fires lead to high fire intensity and bring great destruction to forests according to the variables studied fire spread models these models focus on variables that directly influence the propagation of fire perimeters fire spread rate fire line intensity and fuel consumption are three important variables addressed in most of the models fire front properties models at the local scale the geometric and physical features of flames are studied such as flame height temperature etc according to the nature of mathematical functions physical models derived from laws of combustion heat transfer and fluid dynamics a physical model attempts to simulate both the physics and chemistry processes of wildland fires although physical models are widely studied two major drawbacks are inevitable first many input data of the model could not be measured in the field chandler 1983 thus the validation and numerical simulation of the model are extremely difficult to propose second the lack of knowledge on the complex chemicophysical processes still limits the development of the physical models quasi physical models developed from general and theoretical physics equations and completed by laboratory based or field based experimental data a quasi physical model represents only the physical processes one of the quasi physical models widely used in wildfire spread rate prediction is that developed by rothermel 1972 although the difficulty in input data acquisition is reduced to some degree compared with physical models many of the simulations adopting the quasi physical model have directly converted the one dimensional spread model to that of a two dimensional planar model empirical models involving no physical or chemical mechanism an empirical model comprises statistically and mathematically analogous descriptions from experimental or historical fire data however the lack of physical basis restricts the implementation of the model in different environments suggesting that the fuel bed conditions should be validated prior to application of the model quasi empirical models based on the physical framework a quasi empirical model is also built by statistical approaches different from empirical models physical framework is embedded so that the interaction between the fire model and external factors i e water dropped from helicopter during the simulation is feasible nevertheless geographical restrictions of the model still exist due to the dependence on the statistical data of fire behaviours in the given area according to the representation of the fire vector based models in vector based models the fire front line is considered as a closed curve of linked vertices described in the literature as a vector implementation huygens wavelet principle proposed by richards 1990 1995 is applied in the propagation of the fire perimeter in which each vertex is considered as a potential source of independent elliptical expansion using huygens principle as the fire growth model the farsite fire area simulator developed by finney 1998 incorporated existing fire behaviour models simulates past active and potential fires finney and andrews 1999 as a software tool in fire front prediction farsite is widely used in many studies to verify the simulated fire shape and evaluate the performance peterson et al 2009 trunfio et al 2011 avolio et al 2012 ghisu et al 2014 2015 to predict actual firing borders instead of burned area front lines the reaction models or equations are additionally required for existing vector based models raster based models in raster based models fires are treated as a group of globally contiguous cells in a grid described in the literature as a raster implementation several states are defined to each cell so that the propagation of fire is then transformed into the successive state transitions of cells in a raster grid as one of the most used raster implementations the cellular automata ca approach is computationally less intensive than that of the vector based method and has strong adaptability in heterogeneous fuel and meteorological conditions level set models in the level set model the fire front line similar to that in vector based models is regarded as a closed curve whose horizontal projection interface corresponds to the zero level set of one evolving function ϕ the expanding problem of the interface is then transformed to the evolution of ϕ in time adalsteinsson and sethian 1995 tiziano ghisu et al 2014 presented a level set algorithm for simulating wildfire spread compared with raster based models whose results show high accuracy in fire front prediction without any distortion similar to the vector based models based on supplementary reaction models or equations the burning time for each ignited cell could be easily determined therefore both the firing and burned out front lines could be simulated in the models summarized above aiming at surface fire spread modelling many researchers have proposed vector based or raster based methods with equations ranging from the purely physical to the purely empirical in which the formulation of fire front properties has been simplified or replaced by statistical analogues sullivan 2009b 2009c therefore these models are focused on the prediction of propagation and a unique model describing full chemicophysical processes of forest fire is still not computationally feasible collin et al 2010 moreover compared with surface fire other types of wildland fire are less studied pastor et al 2003 and in much of the literature wildfires were not classified to construct the interactive simulated environment for forest firefighting training based on the classification listed above the wildland fire behaviour model should be featured as a crown fire model a fire front properties model a quasi empirical model a raster based model active crown fire is targeted as the modelled fire type in the present study due to its intense destruction of forests the model should contain enough fire properties including the fire spread rate and front shape to realize additional interactions needed in future applications considering the difficulty in full chemicophysical modelling and initial data collection a quasi empirical framework is applied finally from the viewpoint of application the discrete nature of raster based models makes the implementation on digital computers easier than that of vector based models additionally compared with level set models and vector based models raster based models have the potential to embody the physical framework of forest fire propagation which has been demonstrated by collin et al 2010 to comprehensively fill in the blanks concerning the real time simulation of crown fire behaviours the ca approach appears to be an appropriate alternative thus the feasibility and necessity of a new ca approach are discussed below with a detailed review of previous works employing the ca method in fire modelling first introduced by karafyllidis and thanailakis 1997 the ca approach in forest fire spread prediction was broadly applied and considerably developed based on the ca model by karafyllidis and thanailakis 1997 and the modified fire spread model of rothermel 1972 berjak and hearne 2002 proposed an improved ca model in a spatially heterogeneous savanna system extended from the model of karafyllidis and thanailakis 1997 and berjak and hearne 2002 a hernández encinas et al 2007a introduced a new method to calculate the propagation factor from a diagonal adjacent cell however the simulated fire shapes of these ca models under constant wind and homogeneous landscape conditions suffer from significant distortion which is caused by the restriction that the fire in one grid cell could only propagate in limited directions even in actual landscape situations ghisu et al 2015 to improve the representation accuracy three strategies are adopted the first strategy is based on the traditional ca definition applying the adjustment in lattice and neighbourhood rules to mitigate the drawbacks of distortion l hernández encinas et al 2007b proposed a forest fire ca model in a regular hexagonal lattice and johnston et al 2008 even used an irregular grid in their model nevertheless the distortion problem remains then some fire spread ca models trunfio et al 2011 avolio et al 2012 ghisu et al 2015 increased the number of spread directions by enlarging the neighbourhood size from 8 to 24 and the distortion error was relatively reduced by notably increasing the computational costs the second strategy is the application of a new spread mechanism accepting the assumption of expanding ellipse green 1983 and huygens wavelet principle peterson et al 2009 improved the hfire model morais 2001 by adding an ellipse adjustment factor eaf in the calculation of the length to width ratio of the local predicted ellipse for each ignited cell however a regular octagonal fire shape instead of a circle is presented in zero wind speed and flat terrain conditions then trunfio et al 2011 and avolio et al 2012 devised two improved wildfire models in which the local fire source inside each cell was not restricted to the cell centre and the fire spread was not limited in eight directions although the relaxation of spread directions applied in these two models produced fire shapes relatively close to the theoretically elliptic shape the error due to the uncertainty is significant when the degree of freedom is superior based on the studies of peterson et al 2009 and johnston et al 2008 tiziano ghisu et al 2015 added five correction factors to the spread rate equations through the optimization of several combinations of eccentricity and equivalent wind directions or maximum spread direction the optimal values for the five correction factors are then obtained to construct a surrogate model using the rbf algorithm which is integrated in the ca solver under both uniform and non uniform conditions the proposed method obtains fire perimeters closely matching the optimized target shapes calculated by farsite the main ideology of these correction factors is to strengthen the directional dependency in spread rate calculation which is adopted in the present study to generate a new spread mechanism the last strategy is the combination of physical equations and the ca algorithm based on previous studies illustrating complete combustion by the reaction diffusion model séro guillaume and margerit 2002 margerit and séro guillaume 2002 collin et al 2010 demonstrated how a new ca model could be constructed from a physical model although the numerical simulation result of the model in zero wind and flat terrain conditions with uniform vegetation is consistent with the prediction of a circular fire perimeter the convolution integral calculating the radiative flux is computationally intensive while the wind and slope influences on fire propagation need further investigation ignoring this distortion problem many authors have presented faster than real time simulation systems of wildland fires with high fidelity fire behaviour inputs sun et al 2013 jellouli et al 2016 berjak and hearne 2002 yassemi et al 2008 additionally due to the lack of physical basis as previously mentioned few models have the potential to contain enough simulated fire properties except for the physical ca proposed by collin et al 2010 altogether these ca models suffer from two main drawbacks the distortion problem in simulated fire shapes and the lack of a physical basis in fire behaviour modelling based on previous studies a new ca approach named spread vector induced cellular automata svica is proposed in which the quasi physical equations of crown fire behaviours based on a simplified fuel bed and fire model are embedded one of the originalities of the present study is illustrated in the radiation model by a new spread mechanism termed the spread vector algorithm which can significantly minimize the distortion problem without mathematical correction owing to the physical framework used in model construction more fire front properties are simulated under both homogeneous and heterogeneous conditions particularly the simulation of the spatio temporal evolution of the fire band thus the model could then be implemented in a real time firefighting training system to perform fire behaviour simulation under the given conditions the present study is organized in the following manner the basic hypotheses and the framework of the svica model are presented in section 2 then the detailed derivation of the model is presented in section 3 to study the performance of the model several numerical simulations are performed and their results are shown in section 4 finally the discussion and the conclusions of the present study are highlighted in section 5 2 preliminary hypotheses and svica framework to specify the scale and the objective held throughout the present study several hypotheses and analyses have been made prior to the illustration of the svica framework the first assumption is that the crown fires modelled in the present study are active crown fires according to its definition fires that spread through surface ladder and canopy fuels could be regarded as a single unit thus the vertically stratified forest through which crown fires spread is simplified as a monolayer fuel bed the second assumption is that the radiative transfer due to flame radiation is the dominant heat transfer method along the fire front line where the convection and conduction effects are neglected the last assumption is that the heat loss is negligible over the heat gain during the ignition process and the ground is considered adiabatic from a global perspective the fire front and the fire rear are both a one dimensional line expanding in a two dimensional vegetal combustible surface influenced by the topography meteorology and other external factors the region between the corresponding fire front and fire rear lines is naturally defined as the fire band at this scale at instant t a certain perimeter element δ p t of the fire front line fig 1 is situated between two parts of the fuel bed surface unburn area and burning area the element is characterized by a normal vector n whose direction indicates the spread trend of the represented element after a short period δ t the fire front line changes its shape and in the direction of the normal vector of δ p t a corresponding perimeter element δ p t δ t exists belonging to the fire front line at instant t δ t hence the fire front line and the fire rear line can be discretized at both the time and space scales locally the specific pyrolysis and combustion of forest stratum are complex chemicophysical processes séro guillaume and margerit 2002 which should be simplified additionally the monolayer fuel bed mapped to the cellular lattice could divide the global fire propagation into a collection of local cellular fire behaviours which is illustrated by different cell states the fire band is then presented by a series of cells with the same burning state moreover the resolution of this presentation is limited by the size of the cell for accuracy the flame depth should be greater or equal to this characteristic size but in most cases the restriction could be relaxed cf section 3 2 therefore the advance of the fire front line within each cell is negligible compared to the inter cell fire propagation suggesting that vegetal combustion in one cell is considered homogeneous simultaneously heated and consumed with these analyses and hypotheses application of the ca approach to simulate crown fire is feasible and the framework of the svica model applied in the present study is summarized in fig 2 the svica model is basically developed from the traditional ca model by integrating the physical process of crown fire and the concept of spread vector with state definition and local state transition rules the description of the framework is as follows firstly spatial distribution rules of cells and neighbourhood rules define the basis of the svica model in the present study the cellular space consists of a bidimensional regular square lattice each cell of the lattice is sized by the square side length a and moore neighbourhood is applied so that the inter cell radiation is restricted to the immediate adjacent cells in fig 3 the centre cell is shown in blue and its eight neighbour cells named with azimuth are shown in red secondly using input mapping rules fuel bed properties cf section 3 1 together with the topography and meteorology data are projected to the specific cell for the initialization topography data of the studied area are presented by a digital elevation model dem and each cell is assigned a proper elevation value after the projection process as for the meteorology data ambient temperature and 20 ft winds are considered in the present study finally as the core component of the svica model framework the cell is discussed here using the state transition rules states of the cell are defined according to the state variables as part of the inputs the values of state variables are updated at every discrete time step with the reaction function cf section 3 2 corresponding to the current state outward radiation to neighbour cells is calculated by the radiation model cf section 3 3 and then adjusted by the spread vector algorithm however radiation received from other cells is summed up at each time step and serves as the heat resource in the reaction model while the radiation from each ignited cell is separately accumulated with time and used as the weight to compute the spread vector based on the framework illustrated above in the following section the detailed calculation and derivation of the key components of the svica model will initially be interpreted and then the integrated model description is proposed in section 3 5 3 svica model 3 1 fuel bed and fire model 3 1 1 idealized fuel bed inspired by simplified representation of the crown fire front pastor et al 2003 before discretization the stylized cross section of vegetal stratum along the fire spread direction under flat terrain and zero wind conditions is modelled and shown in fig 4 to inherit some concepts and conclusions on fire behaviour from previous studies alexander and cruz 2012 as assumed above the fuel bed is locally homogeneous with a characteristic depth h t which represents the average height of local trees the fire band is then considered uniform featuring s flame depth d f and flame height h f in addition flame length l f is defined as the distance between the tip of the flame and the surface of the remaining fuel rothermel and deeming 1980 furthermore l f is calculated at the fire front by the following equation 1 l f h f h t where the flame height h f derived from h t and l f is a key parameter in the radiation model thus by inserting mapped vegetal stratum data into each cell an idealized fuel bed in the horizontal cellular space cf fig 5 is constructed and the elevation information is implicit so far the feature variables that serve as inputs in the reaction and radiation models include actual dry fuel density ρ kg m 2 residual ash density ρ e x t kg m 2 relative fuel moisture h μ dimensionless average tree height h t m combustion calorific value q kj kg notably within each cell the local fuel bed is homogeneous with the feature variables listed above and the total fuel mass in one cell δ m is calculated as 2 δ m a 2 ρ h μ ρ 3 1 2 fire model for a fire front cell in an idealized fuel bed after a period of spreading one cell is defined as the burning state when the fire front line appears in the current cell range and the state ends once the fire rear line completely leaves the cell as previously mentioned local fire behaviours in each cell are considered to be simultaneous indicating that in a discrete cellular space fires discretely propagate from cell to cell the outer border of the fire band as the fire front line is interpreted as a cell chain notably the length of the fire front line in cellular space is proportional to the number of cells in the chain hence the length of the fire front element in each chain cell is considered as a then the fire model of these frontier cells should be studied and several concepts are proposed cf fig 6 crown fires in the border cell are regarded as a blackbody plane s f perpendicular to the cellular space the length of the hemline is equal to cell size a and the height of the plane is equal to the flame height h f equivalent fire surface s f situates in the centre of the cell and the fire direction is characterized by a unit normal vector s v the so called spread vector average distance of trees d t in real situations trees are separately distributed d t is proposed to represent the distribution density of trees thus fire discretely spreads from tree to tree within a cell and d t involves the propagation by the calculation of flame radiation cf section 3 3 in fig 6 the distance between the equivalent fire surface s f and nearest equivalent tree surface s t is equal to this average distance d t nearest equivalent tree surface s t to estimate maximum effective radiation power released from the flame and absorbed by the trees an ideal tree plane is defined assuming that the trees in each cell are uniformly distributed with average distance d t in the direction of s v a row of trees could be found while each tree in the row is apart from s f in the distance d t these trees form a plane parallel to s f as the so called nearest equivalent tree surface s t the hemline of s t equals a and the height equals the average tree height h t s t is the blackbody without any hole on the surface sub cell structure based on the concepts above the propagation of crown fires could be considered as successive ignitions of equivalent tree surfaces in the spread direction owing to the idealized fuel bed assumption the outward radiation power from a cell is constant thus by evaluating the radiation projected from s f to s t the whole effective radiation power released by a current burning cell is estimated cf section 3 3 however different from temperature changes and the water evaporation prior to ignition the fuel consumption of equivalent tree surfaces in one cell is coincident with another in the time scale suggesting that the simultaneous fuel consumption should be corrected thus the adjustment configuring the sub cell structure should be made once the uniform fuel bed hypothesis is considered cf section 2 3 considering the sub cell structure the concept of cell scale n is proposed as 3 n a d t this value represents the relative density of trees in the cell scale and equals the maximum number of equivalent tree surfaces a single cell could contain in addition in the time scale there is a minimum time during which the fire spreads from one cell to its neighbour as the shape of the cell is not centrosymmetric cell size a is used to characterize this minimum time t a 4 t a a r where r is the estimated fire spread rate in the current cell cf section 2 4 in the sub cell scale the time during which the fire spreads between two adjacent equivalent tree surfaces is indicated as t d t 5 t d t d t r t a n 3 1 3 end point and ignition point the fire model above is based on the assumption that the fire front line within a cell could be regarded as a segment whose length equals a in real cases fire front lines are not always closed and after the projection to the cellular space the two end cells of a no closed cell chain are no longer topologically a line in addition different from the frontier burning cells the ignition cell is naturally defined as a point therefore a point cell model should be considered for both the end points of fire front lines and ignition points in the present study a cell is defined as a point cell where the fire could spread towards eight potential neighbours in each direction the fire is regarded as an equivalent fire surface with the same size defined above and situated in the centre of the cell the identification of an end point cell from fire front cells will be illustrated at the end of section 3 3 2 then considering the ignition point once the neighbours of the cell are ignited they become new ignition points and the iteration continues until the fire front reaches the threshold distance of initial spread beyond this distance the fire model for the fire front could be applied to simulate the fire spread 3 2 reaction model based on the fuel bed and fire model above the reaction diffusion model collin et al 2010 is introduced and updated in the present study with several adjustments borrowing the hypotheses of collin collin et al 2010 and owing to the homogeneity of the fuel bed in each cell the following reaction equations are adopted in the present study 6 ρ c s h μ c l d t d t h t a t δ p r 0 ρ d h μ d t l e v δ t t e v p r 1 δ ρ ρ e x t d ρ d t φ ρ φ w t ρ a e e r t w h e n ρ ρ e x t a n d t t i g in the equations above t is the current temperature of the fuel bed in the cell and t a t e v and t i g represent the ambient evaporation and ignition threshold temperature respectively additionally ρ ρ e x t and h μ are important fuel bed features mentioned above and ρ 0 represents the initial fuel density c s corresponds to the heat capacity of the of the solid parts in vegetal combustible and c l is the heat capacity of water l e v is the evaporation latent heat of water and δ is the dirac symbol moreover h represents the heat transfer coefficient that is null when p r is positive and p r is the density of total radiation power absorbed by the current cell derived from arrhenius law a is the prefactor r the ideal gas constant and e the activation energy as for the fuel consumption correction factors φ ρ presents the adjustment due to the adoption of the sub cell structure and φ w t derives from the influences of the wind and terrain slope for simplification collin collin et al 2010 assumed that combustion occurred at a constant temperature t c the so called combustion temperature where t reached the ignition threshold temperature t i g thus only one of t h μ and ρ is time varying in a given cell state assuming weak variations of t h μ and ρ according to time the euler scheme is applied to approximate the derivative term in eqn 6 the reaction equations are discretized in time scale with little variation of time δ t 7 ρ c s h μ c l δ t δ t h t a t δ p r 0 ρ δ h μ δ t l e v δ t t e v p r 1 δ ρ ρ e x t δ ρ δ t φ ρ φ w t ρ a e e r t c w h e n ρ ρ e x t a n d c e l l i s i g n i t e d according to newton s law of cooling the heat transfer coefficient h is proportional to the residual fuel bed depth during the cooling process and the relation is presented by 8 h k h ρ e x t ρ 0 2 3 h t where k h is the average heat transfer coefficient in height and the term ρ e x t ρ 0 2 3 is used to evaluate the residual surface proportion of the fuel bed due to the difficulty in estimating the real h involving the effective surface of trees and air convection the assumption above is made to simplify the heat loss calculation with respect to the cooling law as previously mentioned the sub cell structure should be considered in the calculation of the correction factor φ ρ using eqn 6 the entire duration of combustion of one equivalent tree surface the so called residence time t r is estimated in the following equation 9 t r l n ρ 0 ρ e x t a e x p e r t c φ w t with eqn 9 the condition t r t d t should be satisfied to ensure the continuation of propagation in the sub cell scale moreover a stricter condition t r t a is posed to maintain a flame depth greater or equal to a in the global scale as mentioned in section 2 the restriction should be relaxed when the fire band is thinner than the cell size under this condition the first inequality is adopted so that the application scope of the model is expanded in sub cell scale the total duration of combustion in one cell t r is estimated as follows 10 t r t r t a where the propagation delay in a cell is considered and estimated by t a therefore the correction factor φ ρ could be calculated as 11 φ ρ t r t r 1 t a t r 1 when t a t r φ ρ tends to be 1 indicating that the sub cell structure is negligible if the spread speed is high enough however the sub cell structure should also be considered during the cooling process as burnout equivalent tree surfaces are non combustible the outer flame radiation is obstructed at the current cell border which is why the absorbed radiation power density in eqn 6 is neglected when ρ ρ e x t as one of the external factors mentioned in the model framework the water dropped from a fire fighting helicopter or plane in one cell is supposed to be a unit with ambient temperature t a compared with the cell temperature t different cases are listed below when t t e v water is evaporated immediately within a time step if the quantity of water is under the threshold to cool down the whole cell below t e v if the water dropped is beyond that limit and then part of the water is evaporated to reduce t from t c to t e v and the rest follows the rules below when t t e v the evaporation process is interrupted immediately and the relative fuel moisture h μ should be updated due to the augmented liquid water in the cell as t t e v the cell temperature is reduced according to the mass of the water within a time step and h μ is increased 3 3 radiation model 3 3 1 radiation power received and released the radiation power density p r mentioned in the reaction model is estimated in this section and the total radiation power received in cell p r is equal to a 2 p r where a 2 represents the area of the current cell p r is calculated as 12 p r n k ε ℕ p r k where ℕ represents the set of adjacent eight cells and p r k equals the radiation power received from the k th neighbour n k n k ℕ for the radiation generated by the flame in one ignited cell based on the fire model proposed above the total radiation power released by the front surface of s f is estimated by the stefan boltzmann law 13 p f σ t c 4 a f in eqn 13 σ is the stefan boltzmann constant a f is the area of equivalent fire surface s f which equals a h f and t c is the combustion temperature of the flame that is supposed to be constant thus the total generated radiation power from a burning cell is calculated by the following equation 14 p f σ a h f t c 4 the nearest equivalent tree surface s t is used now to estimate the angle factor of radiation heat transfer φ f t from s f to s t cf fig 7 which estimates the maximum outward radiation released from a burning cell in zero wind and flat terrain conditions by definition φ f t is calculated by 15 φ f t s f s t cos θ f cos θ t π r 2 d a t d a f a f where d a t and d a f indicate the infinitesimal area of s t and s f respectively vector r is defined from the position of d a f to the position of d a t thus θ f represents the angle between r and the normal vector of d a f pointing at s t comparatively θ t is the angle between r and the normal vector of d a t pointing towards s f the value of φ f t is influenced by the fuel bed features in analogy to the fuel spatial distribution and arrangement adjusted index k s sun et al 2013 which estimates the proportion of maximum outward radiation power p f t m a x to p f in real cases the porosity of trees leads to radiation leakage on equivalent tree surfaces evaluated by k p the porosity factor of the fuel bed then the effective outward radiation power p f t is 16 p f t k p p f t m a x k p φ f t p f k p σ a t c 4 φ f t h f using numerical integration the value of φ f t h f could be calculated with fixed d t and h t then the binary function φ f t h f f d t h t could be fitted by using a cubic polynomial cf appendix a 3 3 2 spread vector algorithm as mentioned above the spread vector s v is a unit normal vector of equivalent fire surface s f which indicates the spread tendency of the current ignited cell due to the nonuniqueness of s f in point cells the spread vector s v is viable only for fire front cells before the illustration of the spread vector algorithm several notations should be clarified the use of moore neighbours restricts the fire spread to eight potential directions at the centre of the cell in each neighbour direction a unit vector n k is attached and numbered with k cf fig 8 the angle from n k to spread vector s v is marked with θ k therefore all the unit vectors n k that satisfy θ k π 2 could constitute two orthogonal bases without a unit vector in common the following bi projection of s v is applied in these two bases once the current cell is ignited the bi projection of s v is executed to estimate the proportion of radiation power released in each potential direction as shown in fig 8 s v could be projected in two orthogonal bases n 8 n 2 and n 1 n 3 and the bi projection equation is as follows 17 s v 1 2 cos θ 8 n 8 cos θ 1 n 1 cos θ 2 n 2 cos θ 3 n 3 in addition the arrangement of neighbours for each cell is not centrosymmetric cf fig 9 and a distance correction factor should be added to each diagonal direction including n e s e s w and n w different from the fire front cells the point cells release the radiation uniformly in all directions hence under zero wind and flat terrain conditions the effective radiation power p k released from an ignited cell in the direction of n k k is odd is calculated by 18 p k 1 2 cos θ k p f t 1 2 cos θ k k p p f φ f t f i r e f r o n t c e l l p f t k p p f φ f t p o i n t c e l l the effective radiation power projected to the k th neighbour cell in diagonal direction n k k is even is evaluated by 19 p k 2 4 cos θ k p f t 2 4 cos θ k k p p f φ f t f i r e f r o n t c e l l 2 2 p f t 2 2 k p p f φ f t p o i n t c e l l for a point cell the allocation proportion of the state transition medium between normal and diagonal neighbour cells named the diagonal factor in the present study cf appendix b is 2 2 under the given fuel bed conditions then concerning the fire front cells the conservation of radiation power is examined in the form of radiation power work defined as the product of p k and the relative distance to s f the summation of the work in each potential direction n k remains constant the example shown in fig 8 is examined as follows 20 2 4 cos θ 8 2 2 a 2 4 cos θ 2 2 2 a 1 2 cos θ 1 2 a 1 2 cos θ 3 2 a p f t a p f t eqn 20 shows that the total radiation power work of the cell stays the same and equals a p f t therefore for any spread vector s v conservation of radiation power is verified in the sense of radiation power work the spread vector s v should be evaluated once the current cell is ignited based on accumulated radiation heat received from the neighbours the following equation illustrates the calculation of s v 21 s v σ ℕ n k q n k σ ℕ n k q n k where q n k is the accumulated radiation heat from the cell n k in the direction of n k and operator returns the module of a vector with the definition of the spread vector s v the vertical vector of s v is indicated as s v where s v s v 1 during the spread simulation as for a new ignited fire front cell the dot product between s v and n k for each ignited neighbour cell n k is calculated if these products are of the same sign then the new ignited cell is classified as a point cell and should follow the corresponding radiation rules 3 4 wind and slope effects the meteorology and topography data mentioned above consist of wind and terrain elevation information to simplify the complex interaction involving the flame wind and slope in each cell several hypotheses are made the effects derived from wind and slope are independent of each other wind considered in the present study is supposed to be spatially uniform the elevation of one cell is measured with altitude in metres with the above assumptions the final inputs of wind and slope that influence the fire behaviours are illustrated in section 3 4 1 and their detailed impacts on radiation heat transfer and fuel consumption rate are discussed below 3 4 1 wind and slope inputs a 20 ft wind is considered as the measurement of wind and the static wind field is supposed to be uniform the size of the 20 ft wind is presented by v 20 f t and v 20 f t is the unit vector indicating the direction of the wind in cellular space local winds driven by general winds aloft are slowed by surface friction near the top of the fuel bed andrews 2012 and then the midflame wind speed v m i d derived from v 20 f t is corrected by the wind adjustment factor waf where the midflame height is supposed to be h t thus based on the logarithmic wind profile the equation albini and baughman 1979 that evaluates the waf is 22 w a f v m i d v 20 f t 1 l n 6 096 0 36 h t 0 13 h t for the calculation of the local terrain slope digital elevation model dem data are used to assign an altitude h a l t to each cell the slope angle θ t k in the direction of n k is estimated by the following equation 23 θ t k a c t a n h a l t k h a l t a w h e n k i s o d d a c t a n h a l t k h a l t 2 a w h e n k i s e v e n where h a l t and h a l t k correspond to the altitude of the current cell and its k th neighbour cell n k respectively based on the elevation data above the curve indicating the relation between the slope heading direction and the corresponding slope angle is applied by using cubic polynomial fitting thus the slope angle θ t for any direction in cellular space could be evaluated 3 4 2 impacts on radiation heat transfer as the fire spread rate is proportional to the radiative heat transfer power the empirical equations that illustrate the spread speed changes influenced by wind and slope could be integrated into the radiation model for fire front cells the wind speed adjusted index k w different from waf and the slope adjusted index k t sun et al 2013 are adopted in the present study as 24 k w e x p k w v m i d c o s θ w k t e x p s g n θ t k t tan θ t 1 2 cos θ t where θ w represents the angle between v 20 f t and s v θ t is the slope angle in the direction of s v function s g n θ t returns 1 when θ t 0 and returns 1 when θ t 0 k w and k t are empirical constants and cos θ t is added in the present study due to the projection of the spread rate from the terrain surface into the horizontal cellular space therefore the final effective radiation released from the fire front cell and absorbed by its k th neighbour is determined as 25 p k 1 2 k w k t k p p f φ f t cos θ k w h e n k i s o d d a n d θ k π 2 2 4 k w k t k p p f φ f t cos θ k w h e n k i s e v e n a n d θ k π 2 0 w h e n θ k π 2 for the point cells the wind speed adjusted index k w k and the slope adjusted index k t k are calculated for the k th neighbour cell by using eqn 24 where θ w and θ t are replaced by θ w k and θ t k θ w k is the angle between v 20 f t and n k and θ t k represents the slope angle in the direction of n k hence the final effective radiation released from the point cell to the k th neighbour is calculated in the following equation 26 p k k w k k t k k p p f φ f t w h e n k i s o d d 2 2 k w k k t k k p p f φ f t w h e n k i e v e n 3 4 3 impacts on fuel consumption based on the fire model defined in section 3 1 the area of the fire surface is proportional to the flame height h f and the combustion is considered as uniform in real cases the influences of wind and slope on the fuel consumption rate are complex to simplify the process it is assumed that the wind and slope affect the fuel consumption only by changing the flame height h f to evaluate h f in each cell the simplified expression for fireline intensity i rothermel and deeming 1980 is applied as 27 i 258 l f 2 17 q ρ r the estimated fire spread rate r is measured as follows 28 r k w k t k p σ t c 4 φ f t h f ρ c s t i g t a h μ c l ρ t e v t a h μ ρ l e v where φ f t h f is estimated by binary function f d t h t cf appendix a and based on eqn 1 and eqn 27 h f is then calculated as 29 h f l f h t q ρ r 258 0 46 h t the fuel consumption adjustment factor φ w t is then evaluated as follows 30 φ w t h f h f w 0 t 0 k w k t h f w 0 t 0 h t 2 17 0 46 h t h f w 0 t 0 as the denominator h f w 0 t 0 is the origin flame height in zero wind and flat terrain conditions with the given fuel bed inputs 3 5 model description spread vector induced cellular automata svica the svica model is defined in a bi dimensional horizontal cellular space comprising grid cells with size a in lattice the description of the model is divided into four parts firstly the final inputs of each cell and the mapping rules are specified secondly the state variables and the states of the cell are defined then the local state transition rules are illustrated with detailed equations and judgement logic and finally the time step length δ t of simulation is discussed 3 5 1 cell inputs and mapping rules as illustrated in the framework cf fig 2 the fuel bed properties combined with topography and meteorology data constitute the inputs of each cell based on the component models introduced above the cell inputs are divided into two categories fuel bed properties and external factors the fuel bed properties include current temperature of the fuel bed t input constants t a t e v t i g and t c actual dry fuel density ρ input constants ρ 0 and ρ e x t relative fuel moisture h μ input constant initial relative fuel moisture h μ 0 average tree height h t average distance of trees d t porosity of trees k p combustion calorific value q average heat transfer coefficient in height k h external factors consist of ambient temperature t a altitude h a l t 20 ft wind intensity v 20 f t and unit wind direction vector v 20 f t mass of the water dropped in cell m w as shown in fig 10 cell inputs can be unfolded and regrouped vertically into several input spaces which is constituted by input data of the same type the resolution of each input space should equal that of the cellular space thus for each cell at position i j in the cellular space there are corresponding input data p k i j in input space k compared with the resolution of the cellular space original data maps such as the dem map vegetation distribution map wind field map etc could have different data precisions using data sampling and averaging original inputs of the same type are mapped into the corresponding input space with the same resolution as the cellular space these adjustment rules of resolution are called input mapping rules hence the reaction model and initiation of the radiation model can access and modify the input data by consulting the current cell position through cell inputs 3 5 2 state variables and state definition based on the reaction model three fuel bed properties are selected as the state variables t h μ and ρ depending on the variation of the three state variables cf table 1 seven states are defined and the key variables in the specific state transition are specified as follows state 1 s 1 initial state t is the key variable state 2 s 2 pre evaporation state t is the key variable state 3 s 3 evaporation state h μ is the key variable state 4 s 4 pyrolysis state t is the key variable state 5 s 5 burning state ρ is the key variable state 6 s 6 burnout cooling state t is the key variable state 7 s 7 burnout final state t is the key variable 3 5 3 local state transition rules by integrating the reaction and radiation model with the state definition the local state transition rules of the current cell are illustrated as follows s 1 and s 2 current temperature of the fuel bed in cell t is a key variable once heated by adjacent cell s in state s 5 t changes its value discretely at each time step δ t represents the variation of t from current time t to next time step instant t δ t and based on the eqn 7 δ t is calculated by 31 δ t p r a 2 h t a t t δ p r 0 a 2 ρ c s h μ t c l δ t where t t and h μ t represent the values taken at instant t by t and h μ respectively p r is estimated by eqn 12 and the heat loss is negligible when p r takes non null values at instant t if water with mass m w is dropped into the cell then t is changed to t m i x according to the conservation of the heat t m i x is evaluated by 32 t m i x t t a 2 ρ h μ t c l c s t a m w c l m w c l a 2 ρ h μ t c l c s therefore δ t is calculated by the following equation 33 δ t p r a 2 h t a t m i x δ p r 0 a 2 ρ c s h μ t c l m w c l δ t additionally starting from the next time step h μ t δ t changes its value and is calculated by 34 h μ t δ t m w h μ t a 2 ρ a 2 ρ based on the variation of t at the beginning of each time step the state transition rules are as follows if t a t t e v state is s 2 else if t t e v state changes to s 3 else state stays in s 1 s 3 the key variable of state s 3 is changed to h μ t maintains the value t e v and the variation of h μ from current time t to next time step instant t δ t is indicated as δ h μ based on eqn 7 δ h μ is calculated by 35 δ h μ p r l e v ρ a 2 δ t at instant t if water of mass m w is dropped into the cell then the process of evaporation is immediately interrupted and the cell state changes to s 2 additionally temperature t drops from t e v to t m i x which is calculated by the following equation 36 t m i x t e v a 2 ρ h μ t c l c s t a m w c l m w c l a 2 ρ h μ t c l c s before the next time step the value of h μ t δ t changes which is evaluated by eqn 34 the rules of state transition of s 3 are illustrated below if h μ 0 and p r 0 state changes to s 4 else if h μ 0 and p r 0 state changes to s 2 else state stay in s 3 s 4 in the pyrolysis state t is the key variable from t to t δ t and δ t is calculated by the following equation 37 δ t p r a 2 h t a t t δ p r 0 a 2 ρ c s δ t if water of mass m w is dropped in the cell at time t and evaporated at once then heat loss occurs and temperature t should drop from t t to t m i x where 38 t m i x t t a 2 ρ c s m w l e v c l t e v t a a 2 ρ c s if t m i x t e v state changes to s 2 and then based on the assumption in section 3 2 only part of the water m w is immediately evaporated which is calculated by 39 m w t t t e v a 2 ρ c s l e v c l t e v t a the rest of the water of temperature t a continues cooling down the fuel bed to the final temperature t m i x 40 t m i x t e v a 2 ρ c s t a c l m w m w a 2 ρ c s c l m w m w additionally from the next time step h μ appears again and equals 41 h μ m w m w a 2 ρ however if the t m i x t e v state remains in s 4 all water is evaporated for an instant and δ t is evaluated by eqn 37 where t t is replaced by t m i x at the beginning of each time step transition rules are executed if t reaches t i g then state changes to s 5 and the temperature immediately increases to t c the calculation of the spread vector is applied at this instant however if t e v t t i g then the state remains in s 4 the rules are discussed above s 5 in the burning state ρ is the key variable and its variation δ ρ from current time t to the next time step instant t δ t is estimated by the following equation 42 δ ρ φ ρ φ w t ρ t a e e r t c δ t where ρ t represents the value of ρ at instant t additionally if water of mass m w is dropped in the cell at time t then the supposed cooled temperature t m i x is calculated by eqn 38 where t t and ρ are replaced by t c and ρ t respectively the transition rules are as follows at the beginning of the time step if ρ decreases and reaches ρ e x t then the state changes to s 6 if ρ ρ e x t and t i g t m i x t c then the state remains in s 5 if ρ ρ e x t and t e v t m i x t i g then the fire is extinguished by water and the state changes to s 4 with t t δ t t m i x at the next time step if the fire is extinguished by part of the water and the cell is cooled down to s 2 m w is calculated by eqn 39 replacing t t and ρ as above the final mixed temperature t m i x is estimated by appling eqn 40 while ρ is replaced by ρ t in addition h μ is calculated by eqn 41 s 6 and s 7 in these two states t is the key variable as assumed in the reaction model in these two states p r equals zero and the heat loss is considered δ t is then calculated as follows 43 δ t ρ e x t ρ 0 2 3 h t a t t ρ e x t c s δ t considering the result due to the water dropped in the cell at instant t several cases are discussed below if t t t e v water is evaporated and the supposed cooled temperature t m i x is evaluated by the following equation 44 t m i x t t a 2 ρ e x t c s m w l e v c l t e v t a a 2 ρ e x t c s as discussed in s 5 if t m i x t e v then the final mixed temperature t m i x should be estimated on the condition that t t t e v water cools down the fuel bed and the cooled temperature t m i x is calculated as 45 t m i x t t a 2 ρ e x t c s t a m w c l m w c l a 2 ρ e x t c s therefore if water is dropped then δ t could still be evaluated by eqn 43 but t t is replaced by t m i x or t m i x according to the temperature of the cell t altogether the transition rules are cited below if t t a the state is s 6 alternatively when t reaches the ambient temperature t a the state is s 7 3 5 4 time step one of the most important parts of the ca algorithm is the time step length δ t which should be specified to guarantee the required simulation precision mathematically the discretization in time scale leads to the result that the variation of state variables is discontinuous on the one hand with determined time step judgment delay occurs when the key variable reached and exceeded the logic threshold before the judgment is made at the start of the next time step on the other hand the estimated spread distance during δ t is greater than the cell size a while the maximum spread speed that ca algorithm could realize is a δ t called the transition delay due to the two delays a shorter time step is applied and a more accurate fire shape will be generated at the cost of computation intensity augmentation sun et al 2013 therefore for a deterministic cell size a and mapped input spaces the estimated minimum spread time between cells t a is calculated and the condition δ t t a should be satisfied to avoid the transition delay furthermore to ensure that the judgment delay error is under 1 δ t 0 01 t a should be considered the real time cost by designated computer platform for each iteration is presented by t c o s t the time index η t i m e is defined as the ratio of δ t to t c o s t the simulation is called real time when η t i m e 1 faster than real time if η t i m e 1 and slower than real time when η t i m e 1 in the svica model t c o s t for one calculation step is measured and its value is assigned to δ t for the next time step to achieve the real time simulation 4 numerical simulations and results in this section the svica model is firstly applied in uniform fuel bed conditions where the vegetation studied in the present study is one type of the coniferous forest distributed near beijing the so called larix principis rupprechtii one dimensional and two dimensional fire spread cases are performed with particular inputs and the results of these numerical experiments were analysed to rapidly examine the implementation of the model on the computer referring to the physical properties and constants given by previous studies sun et al 2013 collin et al 2010 séro guillaume et al 2008 sun and niu 2012 wang et al 2010 a uniform fuel bed is constructed with the inputs listed in table 2 much of the development of technology for implementing the models in a numerical simulation environment has concentrated on methods for converting the one dimensional linear model of fire spread to that of two dimensional planar models of fire spread sullivan 2009a different from these methods the radiation model of the svica model is originally defined for two dimensional fire spread as a special case stable fire spread in one dimension is proposed to examine the variation of state variables and the spread rate changes influenced by different factors the general two dimensional fire spread in uniform fuel conditions is studied to illustrate the distortion problem and shape changes due to wind and slope and multi point ignition is preliminarily explored after a series of numerical simulations under uniform fuel bed conditions the svica model is applied in several synthetic forest tests where the vegetation properties of the fuel bed are heterogeneous to perform the sensitivity analyses on fuel bed parameters finally with the actual landscape data and synthetic inputs the wildfire on spetses island alexandridis et al 2008 in 1990 is studied the following simulations were performed on a personal computer with intel core i7 processor 8 gigabytes ram gtx 970 m gpu and running on windows 8 1 64 bit os these simulations were realized with unity unity a 3d game development platform using c language 4 1 1d fire spread in uniform fuel bed conditions in a two dimensional uniform fuel bed a fire line of infinite length could propagate stably at a constant spread rate called 1d fire spread under this stable condition the variation of the state variables is studied to examine the state transition process in each cell and the influences on fire behaviours could be analysed by changing several vegetation properties and external factors notably in the computer simulation environment the infinite fire line is inaccessible thus the topological structure of the cellular space should be transformed to satisfy the stable spreading conditions while the existing rules in each cell should remain unchanged the required structure of the cellular space is illustrated in fig 11 the finite cellular tube shown above illustrates the adjacency relationship between cells along the tube each subsection formed by three end to end cells is numbered from 0 to m m n except for both extreme subsections each cell of the tube possesses complete eight moore neighbours as for the initiation the state of cells labelled 0 is set to be s 7 and cells marked with 1 are at state s 5 as the ignition points the threshold distance of initial spread is a thus from cells numbered 2 a stable 1d fire spread along the tube is performed with a limited amount of cells and the experimental rate of the spread is estimated below by respectively recording the ignited time of number 2 and number n n m cells as t 2 and t n n m the experimental rate of the 1d fire spread r e x p is calculated by 46 r e x p a n 2 t n t 2 η t i m e to save the experiment time while maintaining the precision with the input data listed in table 2 a series of faster than real time simulations are executed below with η t i m e 10 and time cost per frame t c o s t set as 0 02 s as mentioned in section 3 5 4 δ t should be small enough to maintain simulation accuracy in unity the assignment statements of state variables are executed within a function named fixedupdate which is executed every 0 02 s if there is no overflow of calculation then all statements within the fixedupdate function for each cell are collected together for calculation in one frame time otherwise the physical calculation time exceeds the fixed frame time t c o s t due to augmentation of the calculation pressure the fps frames per second of the simulation will decrease to finish the calculation and thus the real t c o s t is not constant to compensate for this defect two strategies are applied in the present study the first strategy is a dynamic cellular space mechanism to reduce the calculation pressure one cell and its scripts are created and added in the simulation only when its neighbour cell is burning once the cell is burned up it will be deleted thus only the burning cells and the heated cells are considered in each frame the other strategy is a dynamic step time as the fire scale becomes immense the first strategy cannot stop the overflow in addition the real time cost of the last frame t l a s t could be provided by unity which is used to estimate t c o s t of the current frame for each frame the time step δ t is calculated by η t i m e t l a s t whether the fps decreases or not the time step can be estimated properly due to the discrete variations in time over judgment exists in the state transitions and under all condition statements using time varying variables the accuracy of the judgement is controlled by the variations of conditional variables in each time step δ t additionally single precision floating points are used to store most of the variables which increases the error because the maximum number of significant digits is fixed to seven it is suggested that the greater the integral part of the data the less precise the decimal part is additionally time index η t i m e is set to 10 to accelerate the simulation thus the changes of the variables are ten times greater than real time in each time step to estimate the error between the estimated spread rate r and experimental rate r e x p e r is defined as 47 e r r r e x p r 100 for example under zero wind and flat terrain conditions t a equals 96 09 s and r is estimated as 0 2081 m s 1 using eqn 46 where n is set to 4 the experimental rate r e x p is measured and equal to 0 2070 m s 1 in addition δ t 0 2 s 0 01 t a so the time precision mentioned above is guaranteed so that the error between the estimated and the experimental rate values is less than 1 thus the calulation precision in the simplest condition is satisfied 4 1 1 variation of state variables over time focus on one of the cells numbered 4 taking the instant when the cells are initially heated as the starting time the variation of three state variables t h μ and ρ is recorded in each time step and the fitted curves are shown as follows fig 12 a represents the variation of t and h μ with time and fig 12b represents the variation of t and ρ with time as for the temperature of the fuel bed t it reached t e v at 20 8 s and at 96 4 s t attained t i g so that the cell is ignited t remained the value of t c during the fire combustion and began to descend at 313 8 s the total combustion time t r equals 217 4 s the decline of the relative fuel moisture h μ occurred during the evaporation process and finished at 47 4 s when h μ reached 0 the actual dry fuel density ρ of the current cell maintained the initial value ρ 0 before the ignition and declined to ρ ext at 313 8 s the results show that the physical processes were reflected properly by the three state variables and that the propagation in the transformed fuel bed is persistent thus the spread rate can be studied under different inherent or external conditions 4 1 2 impacts of external factors on the spread rate in this subsection external factors including wind slope and ambient temperature are considered to examine the impact on the spread rate and the relative error e r is calculated to evaluate the prediction precision first a uniform wind field along the spread direction is proposed the waf is calculated as 0 4367 under the given fuel bed conditions with flat terrain assumption v 20 f t ranges from 20 m s 1 to 20 m s 1 and the result is shown in the figure below in fig 13 as the 20 ft wind speed v 20 f t rises within the test range the experimental spread rate r e x p shows exponential growth corresponding to eqn 24 in addition the relative error e r approximately increases with r e x p and its value is less than 5 therefore within the range of v 20 f t the relative error is tolerable fig 14 secondly focusing on the slope caused impacts to the spread rate in the same fuel bed conditions without wind when slope angle θ t is under 30 52 the condition t r t d t is not satisfied suggesting that the fire propagation is interrupted where r e x p and r are reduced to zero hence the range of slope angle is limited from 30 to 45 where the variation of r e x p is studied and the result is shown as follows the relative error e r increases exponentially with r e x p when θ t 45 e r attained 17 42 which is more than twice the value of the e r at θ t 45 thus with a large slope angle and time index the precision of the simulation should be verified with e r finally the ambient temperature t a is considered to analyse the impact on the spread rate the value range of t a is from 258 15 k 15 c to 308 15 k 35 c and the simulation is applied in zero wind and flat terrain conditions the result is shown in the following figure as shown in fig 15 r e x p approximately increases with the growth of t a the relative error e r is under 1 due to the lower value of r e x p compared to those influenced by wind and slope in conclusion under the given fuel bed conditions and within the given ranges the three external factors discussed above are rated by precision as follows t a v 20 ft and θ t the higher the experimental spread rate the larger is the relative error obtained in the simulation 4 1 3 effects of water dropped in a cell under zero wind and flat terrain conditions with t a 300 k during the combustion of the cell numbered 3 the minimum mass of dropped water m w to extinguish the fire is evaluated at different instant t b u r n and the result is as follows fig 16 shows that if the water dropped in cell is under the curve of m w propagation of fires will continue and the minimum mass of water to put out the fire decreases exponentially with ρ cf fig 12b then in the same condition at t b u r n 60 s water of mass m w 600 k g is dropped in the cell and the variation of the temperature t is studied the results are shown in fig 17 the experimental result shows that at 60 s part of the water was evaporated at once to put out the fire the surplus water cools down t under t e v and increases h μ which is supposed to be zero after the ignition but the cell is then heated by cells numbered 2 and re ignited the entire process verified the local state transition rules interacting with the dropped water 4 2 2d fire spread in uniform fuel bed conditions compared with 1d fire spread fires developed from limited ignition points can propagate through the same two dimensional uniform fuel bed which is defined as the 2d fire spread problem the topological evolution of the fireline will be studied in this section specifically the 2d fire spread ignited by a single point is proposed to study several problems including the distortion problem spread features and effects of wind and of slope then the multi points ignition cases are discussed to illustrate the combination of fires derived from different fire sources all simulations below are executed with η t i m e 10 and time cost per frame t c o s t is set to 0 02 s 4 2 1 distortion problem the distortion of fire shapes simulated by ca models could be evaluated in the simplest fire pattern where the fire grew from a single ignition source on a flat terrain with a uniform fuel bed and under calm atmosphere conditions alexander 1985 in this case the expected fire front shape should be circular and the ignition point is located at the circle centre which is widely adopted in several studies collin et al 2010 peterson et al 2009 trunfio et al 2011 ghisu et al 2015 karafyllidis and thanailakis 1997 berjak and hearne 2002 encinas et al 2007b séro guillaume et al 2008 alexander 1985 in addition the assumption of expanding ellipse green 1983 is not accepted in the present study hence the distortion problem is studied in the simplest fire pattern mentioned above to illustrate the performance of the svica model in distortion correction a cellular space consisting of a bidimensional regular square lattice is constructed where the side length a of each cell is set to be 20 m as a contrast in the same cellular space two more ca algorithms the point cell model of svica and the hfire model karafyllidis and thanailakis 1997 are simulated representing the two major distortion patterns cf appendix b the complete model and point cell model of svica take the data shown in table 2 to build the fuel bed as for the hfire model karafyllidis and thanailakis 1997 the spread rate is uniform and equals 10 m s 1 and the total burning time for each ignited cell is set as 3 s when the i th cell in the reference spread direction cf appendix b is ignited at instant t i the expected circle radius length equals i a the threshold distance of the initial spread for the svica model is set to be 2 a then 400 m is considered as the expanding step of the simulated fire front and the original shapes of the simulated fire band using three ca algorithms are recorded and shown in fig 18 without any image or data correction the profile of the bands using svica is approximately circular cf fig 18a while the fire front shapes derived from the point model of svica and the hfire model karafyllidis and thanailakis 1997 are regular octagonal to provide a quantitative measurement to illustrate the precision of simulated shapes the following metric ghisu et al 2015 is adopted 48 λ s e s e s e s where e represents the set of cells forming the expected fire shape s the set of cells defining the simulated fire shape and the operator returns the size of a set consequently λ s measures the level of disagreement between the two shapes to evaluate the size of s at a given instant t i all burnt and burning cells which form the simulated fire shape could be directly counted additionally a cell should belong to e when its centre falls inside the expected circular boundary defined with radius length i a during the dynamic propagation in the reference spread direction every 20 m that the expected fire front expands is calculated and recorded the results are shown as follows as shown in fig 19 with the growth of the expected radius λ s of svica approximately declines the fire further spreads and a more precise shape is presented comparatively the λ s of the svica point model keeps rising and approaches the upper limit 0 05196 which is calculated by assumption that the simulated profile of the fire band is a regular octagon and its inscribed circle is the expected shape additionally λ s of the hfire model karafyllidis and thanailakis 1997 is higher than the two other algorithms and approximately equals 0 1 when the expected radius exceeds 500 m the results also illustrated why the active accumulation category is selected in constructing the svica point model in addition when the expected radius is beyond 520 m λ s of svica is less than that of eca trunfio et al 2011 using 8 neighbours when the radius exceeds 820 m λ s is under 0 005 and the result is even better than that of eca using 24 neighbours hence the svica model relatively improved the distortion problem in this basic fire spread pattern 4 2 2 analysis of the spread data as for the propagation behaviours of the simulated single ignition fire above using svica the evolution of the radius of the fire band is studied as well as the variation of burned area against the time from the original ignition firstly as shown in fig 18a under zero wind and flat terrain conditions the fire front and fire rear line are approximately in a circle thus the spread distance in rsd cf appendix b is selected as the equivalent radius to measure the radius of the fire front and fire rear line the radius revolutions against time are shown in fig 20 and the origin cell is ignited at time zero the above result shows that the fire propagated in two phases an initial transient propagation and a quasi steady propagation within the unsteady stage the fire rear appeared in a delay of 217 4 s which is equal to the total combustion time t r in addition both the fire front and fire rear fluctuated at the radius of 40 m where the transition from the initial to non initial spread occurred beyond that the spread rate was accelerated and after the radius reached 100 m five times the size of a cell the propagation of the fire was quasi stable during the steady phase the rate of spread is approximately 0 1994 m s 1 a bit smaller than that of 1d fire spread under the same conditions moreover the fire depth presented by the vertical distance between fire front and fire rear line remained constant at 44 4 m the order of magnitude of the simulated spread rate is consistent with the simulation results wang et al 2010 with the same vegetation type then under the same conditions by counting the number of cells in state s 5 the burning area could be evaluated in addition the burnt area is calculated by summing up all cells in states s 5 s 6 and s 7 at a given time the results are shown in fig 21 below and it can be seen that with time the burning area increases linearly and the burnt area presents an analogous parabolic rise which corresponds to the linear growth of the fire band radius due to the discrete counting in the calculation of area and the simulated fire depth close to the cell size fluctuation exists in the curve of the burning area this deviation is tolerable and the results are consistent with the observations collin et al 2010 4 2 3 wind and slope effects different from the simple ellipse shape the combination of fuel distribution wind and slope conditions can produce various fire shapes alexander 1985 as the svica model was examined above in zero wind and flat terrain conditions the influences of the wind and slope on the fire shape are discussed below in the same uniform fuel bed a uniform 20 ft wind field is applied in cellular space and the direction of the wind is heading true north with v 20 f t ranging from 0 m s 1 to 20 m s 1 the original fire shapes are recorded one simulated hour after the initial ignition and the results are shown in the figure below in fig 22 with the growth of wind intensity the fire front line firstly changed its shape from circle to ellipse and then the shape became ovoid if the wind intensity continues rising then the fire front line is in the shape of a teardrop in addition the fire bandwidth of the back fire is narrower than that of the head fire this result is consistent with the conclusion of green 1983 to study the fire shapes in different wind directions v 20 f t is fixed at 10 m s 1 and wind direction α w i n d evaluated by the angle from v 20 f t to n 1 took values as 0 15 30 and 45 the original simulated shapes are shown in fig 23 the result shows that the simulated fire shapes can be transformed isotropically by the wind at different directions the fire band is closely bilaterally symmetric about its long major axis shown in the figure above where the axis passes through the ignition point and parallel to v 20 f t as for the slope influences in the given fuel bed conditions and without wind the gradient vector of the terrain in each cell should remain the same the angle from the gradient vector to n 1 is defined as the slope heading angle α s l o p e and the slope angle in the gradient direction is named θ g firstly with α s l o p e 0 and θ g ranging from 0 to 25 one hour after being ignited the original fire shapes with different θ g are shown below referring to the application of empirical adjusted indexes k t and k w which are all calculated by equations in natural exponential form cf eqn 24 the evolution of fire shapes with the growth of θ g is simular to that of the wind intensity v 20 f t indicating the variation rules for the bandwidth similar to α w i n d the isotropical transform of fire shapes with different α s l o p e should be verified then θ g is fixed at 15 and α s l o p e took values of 0 15 30 and 45 the original fire shapes one hour after the single ignition are illustrated in the following figure fig 24 the results shown in fig 25 examined the isotropic effect mentioned above with different slope heading angles which is similar to that with different wind directions 4 2 4 multi point ignition in some cases the fire shapes could be concave and the forest fires could be generated by several ignition points where the conjunction of fire lines occurs to examine the application of the svica model in these cases with the same fuel bed in flat terrain fires derived from two ignition points are studied as for the simplest condition without wind two cells with a distance of 1000 m are ignited simultaneously and the evolution of fire shapes is recorded every 20 simulated minutes cf fig 26 as shown in fig 26 both fire bands grow with time and fuse as a unit when the two fire lines encounter each other the entire burnt fire shape is the union of the two shapes derived from two ignition points then under the same conditions a uniform wind field with v 20 f t 10 m s 1 and α w i n d 45 is added to test the conjuntion of the fire bands in no isotropic spread the result is shown in fig 27 the result shows that the fusion of the fire band functions properly with the existence of wind referring to the similarity between the impacts of wind and of slope on the fire spread behaviour the same results were obtained under no flat terrain conditions 4 3 fire spread in heterogeneous fuel bed conditions 4 3 1 synthetic forest test with a uniform fuel bed the simulations shown above validated the basic functionalities of the model and analysed preliminarily the effects of inner and outer factors on the spread rate and fire front shapes in this section based on the variable controlling approach with the input data listed in table 2 a series of synthetic heterogeneous fuel beds on flat terrain are constructed to perform sensitivity analysis on fuel bed parameters referring to the synthetic tests made by peterson et al 2009 in a simulation environment a flat square terrain of 4096 m in length was built with two forest areas cf fig 28 and the fuel bed properties in each area are uniform in particular the vegetation properties in area 1 are precisely the same compared with the data listed in table 2 then in each test step to study the fire front propagation in the fuel transition process one of the vegetation properties in area 2 is selected as studied among these parameters the initial fuel density ρ 0 average tree height h t average distance of trees d t initial relative fuel moisture h μ 0 residual ash density ρ e x t and porosity of trees k p are considered whose values are multiplied by 0 5 and 2 except for k p which is multiplied by 0 25 and 0 5 due to its value range while the other values remain unvaried a uniform 20 ft wind field is applied where the wind is heading true north and v 20 f t is fixed at 10 m s 1 for time saving all tests below are executed with η t i m e 10 and the time cost per frame t c o s t is set as 0 02 s the evolution of the fire shapes is recorded every 15 simulated minutes and the results are shown in fig 30 compared with the control test with a uniform fuel bed cf fig 29 by comparing the control test cf fig 29 with the series of synthetic forest tests shown in fig 30 the tendencies of the value changes of the fire spread rate and fire bandwidth in the variation of each specific vegetation parameter are studied and summarized in table 3 near the control vegetation data the initial fuel density ρ 0 average tree height h t and porosity of trees k p are more sensitive to changes in the fire spread rate than the average distance of trees d t and initial relative fuel moisture h μ 0 while the variation of residual ash density ρ e x t has no impact on the spread rate as for the fire bandwidth variation the sensitivity of the average tree height h t and porosity of trees k p is greater than that of the average distance of trees d t and initial fuel density ρ 0 while the initial relative fuel moisture h μ 0 and residual ash density ρ e x t have the least impacts on the fire bandwidth as a complex system variation of the parameters will lead to changes in both the spread rate of the fire front and the total burn time of one front cell which finally affect the width of the fire band with these rules of parameter sensitivity in the next section a case study could be performed and adjusted to match the real conditions 4 3 2 case study to show the practical application of the svica model the case of the wildfire on spetses island in 1990 was used based on the previous studies of alexandridis et al 2008 and russo et al 2014 the density and the type map of vegetation as well as the real burned area map of spetses island are recreated into discrete states and shown in figs 31 and 34 in addition the meteorological conditions on august 1 1990 are listed in table 4 table 5 fig 32 by using worldcomposer doldersum the elevation map of spetses island was obtained in the same area n 37 13 18 12 n 37 17 29 76 e 23 5 8 16 e 23 10 27 48 with the density and type map the original resolution of the elevation map is 128 128 corresponding to land of 7787 m 7787 m based on the bicubic interpolation the elevation map resolution is changed to 512 512 cf fig 34 to over cover the cellular space of the area with a resolution of 390 390 the cell size a is fixed at 20 m due to the lack of vegetation data of spetses island aleppo pine pinus halepensis mill is considered and with the statistics of the sample trees mitsopoulos and dimitrakopoulos 2007 the mapping rules of vegetation inputs are adjusted empirically and listed in the following table due to the lack of information on the real ignition location based on the inputs empirical or arbitrary listed above and the physical constants in table 2 a series of faster than real time η t i m e 10 single source fire simulations was performed the real time for each test was 1 1 h corresponding to a total simulated time of 11 h by comparing the simulated results with the real results cf fig 34 the most fitting ignition point was determined which is different from the ignition point reported by alexandridis et al 2008 the corresponding fire band shapes are recorded every simulated hour and the result is shown in fig 33 the actual forest fire burned a total of 5 9 k m 2 in 11 h while the simulated result was 6 09 k m 2 in addition the shape of the final burned area predicted by simulation basically matches the real area the result shows that the svica model could be applied for real case simulation where the heterogeneous fuel bed conditions are more complex and occasionally incomplete once the empirical inputs are adapted and adjusted to match the real fire data in the given area the real time crown fire behaviour simulation environment was set up and ready for further use 5 discussion and conclusions in a faster than real time η t i m e 10 simulation environment the numerical results of the svica model show good accuracy between the estimated spread rate and the simulated rate in stable propagation in addition the impacts of external factors on the spread rate along with the interaction between the fires and the dropped water match the assumptions and the physical equations mentioned above furthermore in the given 2d uniform fuel bed the distortion problem is studied in zero wind and flat terrain conditions the circular fire front shapes and the spread data show that with the growth of fire perimeters the accuracy of fire shapes increases and the prediction error is not divergent without any mathematical correction the svica model can relatively improve the distortion problem by introducing the spread vector algorithm in radiation model then together with the multi points ignition tests the deformation effects on fire bands in the presence of wind and slope are investigated in detail and the evolutions of fire shapes correspond with the field observations after validating the basic functionalities further applications of the svica model in heterogeneous fuel bed conditions are applied to realize the sensitivity analysis of the six vegetation parameters to the spread rate and to the fire bandwidth finally with limited input data the case study demonstrated that the model has strong practicability and great adaptability in heterogeneous conditions compared with other ca approaches the svica model could provide more fire properties and relatively lower the distortion in simulated fire shapes the cost of the improvements the quasi empirical equations and the spread vector algorithm relatively increase the calculation pressure by applying the dynamic cellular space and dynamic time step mechanisms mentioned above the real calculation time can be tolerated in the balance between the accuracy and the simulation speed a large number of burning cells can lead to the decline in simulation precision while maintaining the simulation speed otherwise the computational time of each step is augmented as the price of the accuracy hence as for the simulations realized by unity the computational time is not a problem instead the calculation precision is altogether the application and the time performance of the svica model are still limited by the total number of the burning cells during the simulation as mentioned above the fundamental purpose of the development of the svica model is to create a real time interactive crown fire simulation for human in loop training thus the fire behaviours including the spatio temporal evolution of the fire band as well as the interaction between fire fighting water and the fire band are primary targets that have been studied and modelled as the prediction of the fire front line during the disaster is not the purpose for which the svica model is designed software such as farsite and other fire models ghisu et al 2014 2015 are more appropriate and sufficient in this circumstance however as a quasi empirical model the vegetation inputs and initial conditions of the model are difficult to collect and should be adjusted with historical fire data which limits the application of the model the extendibility of the model is presented in two parts on the one hand accepting the fuel bed and fire model more complete and precise physical equations for the radiation and combustion process could be applied in the model framework to further increase the accuracy and reliability of the fire behaviour model on the other hand due to the physical framework of the svica model more physical properties of crown fire i e fire intensity flame height flame depth etc have been added to other ca models with this additional information the visualization of the simulated fire propagation may be feasible in the future the proposed model has been integrated in a real time helicopter fire fighting training system which is still under development and a preliminary preview of the system running is shown in fig 35 future studies include model verification with more comprehensive vegetation inputs and real crown fire data the determination of the atmosphere fire interaction using real time cfd solvers is also needed appendix a the derivation of function f d t h t is illustrated below by dividing s f and s t into finite square elements with the same size φ f t is approximately calculated by using numerical integration of eqn 15 for example when the element size is fixed as 0 4 m 0 4 m d t 5 m h t 5 m and the cell size a 20 m the value of φ f t is 0 414 variable controlling is applied to characterize the relation among φ f t h f d t h t and h f for example when the element size is 1 m 1 m d t is fixed respectively at 1 and 5 m and the variations of φ f t h f with h f for different h t are shown as follows fig a 1 variations of φ f t h f versus h f with different h t f fig a 1 as shown in figure a 1 with the growth of h f the value of φ f t h f rapidly rises at the beginning and then tends to a superior limit the limit value of φ f t h f taken at h f 100 m is used to estimate the maximum value of p f t considering the ranges of inputs used in section 4 d t is sampled from 1 to 10 m and h t ranges from 1 to 30 m and then the series of φ f t h f is calculated by the method above the function f d t h t in cubic polynomial form is calculated as a 1 a 1 a 2 d t a 3 d t h t a 4 d t h t 2 a 5 d t 2 a 6 d t 2 h t a 7 d t 3 a 8 h t a 9 h t 2 a 10 h t 3 where parameters a 1 to a 10 are calculated by the least square method using the sample data above the fitted parameters in four significant digits are listed in the table below table a 1 fitted parameters of the cubic polynomial table a 1 a 1 0 2165 a 6 0 001672 a 2 0 1573 a 7 0 0005139 a 3 0 07302 a 8 0 9028 a 4 0 0003591 a 9 0 008363 a 5 0 01936 a 10 0 001664 with the approximate function the fast computation of p f t is achieved to avoid calculating the double integral cf eqn 15 appendix b the different distortion patterns of ca algorithms are illustrated below a ca algorithm is defined by five properties karafyllidis and thanailakis 1997 1 spatial dimensions of the cellular space 2 size of each dimension 3 neighbourhood rules 4 definition of cell state 5 state transition rules or cell local rules according to the framework mentioned in section 2 property 1 and property 2 are included in the spatial distribution rules of cells in addition the cellular space is fixed as a bidimensional regular square lattice and moore neighbourhood is applied additionally the fuel bed is supposed to be uniform and there is no wind by variable control the distortion patterns are studied in the given cellular space with different definitions of states and local rules based on previous studies peterson et al 2009 trunfio et al 2011 avolio et al 2012 ghisu et al 2015 karafyllidis and thanailakis 1997 berjak and hearne 2002 encinas et al 2007a the local rules of ca algorithms could be roughly divided into two categories the first category is active accumulation suggesting that each unburned ignitable cell could be ignited when its own key state variable exceeds the threshold the key variable is calculated by accumulating the corresponding transition medium from the neighbour cells in each iteration the ca models berjak and hearne 2002 encinas et al 2007a alexandridis et al 2008 belong to this category in the svica model the accumulated transition medium is radiation heat the second category is obviously passive accumulation in this state transition mode it is the burning cell that accumulates the spread distances in eight directions the neighbour cell will be ignited once the corresponding spread distance exceeds the specific inter cell distance the ca models peterson et al 2009 trunfio et al 2011 avolio et al 2012 ghisu et al 2015 in this category are illustrated based on the expanding ellipse assumptions in the present study the reference spread direction rsd is defined in fig b 1 the distance between the fire front cell passed through by rsd and the ignition cell is the radius of the circle that represents the expected fire front shapes fig b 1 definition of the reference spread direction 2 fig b 1 as for the active accumulation category the simulated fire shape is octagonal the allocation proportion of the state transition medium between the diagonal neighbour and normal adjacent cells is the diagonal factor f d i a the distortion patterns with different diagonal factors are shown in fig b 2 fig b 2 distortion patterns with different diagonal factors 3 fig b 2 the proportion between the diagonal side length and the normal side length grows with the diagonal factor f d i a moreover the simulated fire front forms a regular octagon when f d i a equals 2 2 which shows that the spread trend in eight directions is uniform this finding is why the point model originally takes 2 2 as the value of the diagonal factor cf section 3 3 2 considering previous studies the diagonal factor in the model proposed by i karafyllidis et al karafyllidis and thanailakis 1997 equals 0 83 s g berjak et al karafyllidis and thanailakis 1997 changed the value of f d i a to be 0 17 2 and a h encinas et al karafyllidis and thanailakis 1997 set the value as 0 785 as for the passive accumulation category as the basis of the subsequent improvement studies peterson et al 2009 trunfio et al 2011 avolio et al 2012 ghisu et al 2015 the hfire model karafyllidis and thanailakis 1997 is applied in the given cellular space and the simulated fire shape is shown in fig b 3 unlike the fire front shapes derived from the active accumulation category the regular octagon is inscribed in the expected circle and the vertices of the octagon are aligned with the directions of the grid fig b 3 distortion pattern of hfire 4 fig b 3 altogether the two major distortion patterns for ca algorithms are summarized above more detailed comparisons between the svica model and other ca models are made in section 4 2 1 
26339,cellular automata ca approaches in wildfire modelling are computationally more efficient than vector based methods despite this advantage these methods suffer from the lack of physical basis and distortion in simulated fire shapes to overcome these drawbacks and to perform a real time interactive crown fire simulation for training use a new ca model is proposed in which a new spread mechanism is introduced based on the physical equations of reaction and radiation then through a series of crown fire simulations in uniform and heterogeneous synthetic fuel beds the functional validation of the model and the sensitivity analyses on vegetation parameters are performed finally a case study is discussed to illustrate the application of the model with real world data without any mathematical correction this method is intrinsically free from the distortion problems found in several ca approaches keywords cellular automata crown fire behaviour shape distortion real time simulation software availability name of the software svica simulator developer yuxuan liu contact information yuxuan liu buaa edu cn hardware required general purpose computer with standalone graphics card software required unity 5 2 3 or higher programming languages c availability contact the developer year first available 2017 1 introduction forest fires play a dominant role in the renewal of plant communities and ecosystem regeneration jpa et al 2007 however uncontrolled forest fires are a critical natural hazard worldwide and cause enormous ecological destruction economic losses and significant casualties sun et al 2013 and their intensity has increased in recent years jellouli et al 2016 therefore these human and socioeconomic damages increase the demand to improve knowledge of fires collin et al 2010 particularly the modelling and simulation of forest fire behaviours before and after the disaster the simulation models could determine the fire risk of local artificial situations and evaluate the effects of different fire fighting policies based on historical data in the given area dunn 2007 fire suppression tactics could be deployed by water dropping helicopters and air tankers particularly seawater planes alexandridis et al 2011 but the inefficient use of aviation resources leads to an increase in suppression costs thompson et al 2013 additionally firefighting trainings could be realized in safe simulated environments with low costs to improve the efficiency of outfires in actual forests hence a real time interactive crown fire behaviour model is needed in recent decades with the increasing capabilities in remote sensing geographical information systems gis and computing power several simulation models have been developed to better understand the behaviours and effects of forest fires the most important models of wildland fire behaviour have been summarized and classified in studies by perry 1998 pastor et al 2003 and sullivan 2009a the classification of these models is listed below according to the fire types ground fire models the combustible target of the ground fire model is the vegetal stratum below the surface litter layer which is formed by fermentation and humus layers surface fire models the surface fire spreads through surface fuels consisting of small trees bushes herbaceous vegetation and fallen trunks which are less than 2 m high spotting fire models the spotting fire model comprises pieces of burning material transported by a convection column and carried beyond the main perimeter of the fire crown fire models the fuel bed of crown fires is formed by surface and aerial vegetation strata in particular an active crown fire is defined when the fire front spreads through the two strata as a unit and a passive crown fire is that in which tree crowns are individually ignited by the surface fire compared to other types of fires crown fires lead to high fire intensity and bring great destruction to forests according to the variables studied fire spread models these models focus on variables that directly influence the propagation of fire perimeters fire spread rate fire line intensity and fuel consumption are three important variables addressed in most of the models fire front properties models at the local scale the geometric and physical features of flames are studied such as flame height temperature etc according to the nature of mathematical functions physical models derived from laws of combustion heat transfer and fluid dynamics a physical model attempts to simulate both the physics and chemistry processes of wildland fires although physical models are widely studied two major drawbacks are inevitable first many input data of the model could not be measured in the field chandler 1983 thus the validation and numerical simulation of the model are extremely difficult to propose second the lack of knowledge on the complex chemicophysical processes still limits the development of the physical models quasi physical models developed from general and theoretical physics equations and completed by laboratory based or field based experimental data a quasi physical model represents only the physical processes one of the quasi physical models widely used in wildfire spread rate prediction is that developed by rothermel 1972 although the difficulty in input data acquisition is reduced to some degree compared with physical models many of the simulations adopting the quasi physical model have directly converted the one dimensional spread model to that of a two dimensional planar model empirical models involving no physical or chemical mechanism an empirical model comprises statistically and mathematically analogous descriptions from experimental or historical fire data however the lack of physical basis restricts the implementation of the model in different environments suggesting that the fuel bed conditions should be validated prior to application of the model quasi empirical models based on the physical framework a quasi empirical model is also built by statistical approaches different from empirical models physical framework is embedded so that the interaction between the fire model and external factors i e water dropped from helicopter during the simulation is feasible nevertheless geographical restrictions of the model still exist due to the dependence on the statistical data of fire behaviours in the given area according to the representation of the fire vector based models in vector based models the fire front line is considered as a closed curve of linked vertices described in the literature as a vector implementation huygens wavelet principle proposed by richards 1990 1995 is applied in the propagation of the fire perimeter in which each vertex is considered as a potential source of independent elliptical expansion using huygens principle as the fire growth model the farsite fire area simulator developed by finney 1998 incorporated existing fire behaviour models simulates past active and potential fires finney and andrews 1999 as a software tool in fire front prediction farsite is widely used in many studies to verify the simulated fire shape and evaluate the performance peterson et al 2009 trunfio et al 2011 avolio et al 2012 ghisu et al 2014 2015 to predict actual firing borders instead of burned area front lines the reaction models or equations are additionally required for existing vector based models raster based models in raster based models fires are treated as a group of globally contiguous cells in a grid described in the literature as a raster implementation several states are defined to each cell so that the propagation of fire is then transformed into the successive state transitions of cells in a raster grid as one of the most used raster implementations the cellular automata ca approach is computationally less intensive than that of the vector based method and has strong adaptability in heterogeneous fuel and meteorological conditions level set models in the level set model the fire front line similar to that in vector based models is regarded as a closed curve whose horizontal projection interface corresponds to the zero level set of one evolving function ϕ the expanding problem of the interface is then transformed to the evolution of ϕ in time adalsteinsson and sethian 1995 tiziano ghisu et al 2014 presented a level set algorithm for simulating wildfire spread compared with raster based models whose results show high accuracy in fire front prediction without any distortion similar to the vector based models based on supplementary reaction models or equations the burning time for each ignited cell could be easily determined therefore both the firing and burned out front lines could be simulated in the models summarized above aiming at surface fire spread modelling many researchers have proposed vector based or raster based methods with equations ranging from the purely physical to the purely empirical in which the formulation of fire front properties has been simplified or replaced by statistical analogues sullivan 2009b 2009c therefore these models are focused on the prediction of propagation and a unique model describing full chemicophysical processes of forest fire is still not computationally feasible collin et al 2010 moreover compared with surface fire other types of wildland fire are less studied pastor et al 2003 and in much of the literature wildfires were not classified to construct the interactive simulated environment for forest firefighting training based on the classification listed above the wildland fire behaviour model should be featured as a crown fire model a fire front properties model a quasi empirical model a raster based model active crown fire is targeted as the modelled fire type in the present study due to its intense destruction of forests the model should contain enough fire properties including the fire spread rate and front shape to realize additional interactions needed in future applications considering the difficulty in full chemicophysical modelling and initial data collection a quasi empirical framework is applied finally from the viewpoint of application the discrete nature of raster based models makes the implementation on digital computers easier than that of vector based models additionally compared with level set models and vector based models raster based models have the potential to embody the physical framework of forest fire propagation which has been demonstrated by collin et al 2010 to comprehensively fill in the blanks concerning the real time simulation of crown fire behaviours the ca approach appears to be an appropriate alternative thus the feasibility and necessity of a new ca approach are discussed below with a detailed review of previous works employing the ca method in fire modelling first introduced by karafyllidis and thanailakis 1997 the ca approach in forest fire spread prediction was broadly applied and considerably developed based on the ca model by karafyllidis and thanailakis 1997 and the modified fire spread model of rothermel 1972 berjak and hearne 2002 proposed an improved ca model in a spatially heterogeneous savanna system extended from the model of karafyllidis and thanailakis 1997 and berjak and hearne 2002 a hernández encinas et al 2007a introduced a new method to calculate the propagation factor from a diagonal adjacent cell however the simulated fire shapes of these ca models under constant wind and homogeneous landscape conditions suffer from significant distortion which is caused by the restriction that the fire in one grid cell could only propagate in limited directions even in actual landscape situations ghisu et al 2015 to improve the representation accuracy three strategies are adopted the first strategy is based on the traditional ca definition applying the adjustment in lattice and neighbourhood rules to mitigate the drawbacks of distortion l hernández encinas et al 2007b proposed a forest fire ca model in a regular hexagonal lattice and johnston et al 2008 even used an irregular grid in their model nevertheless the distortion problem remains then some fire spread ca models trunfio et al 2011 avolio et al 2012 ghisu et al 2015 increased the number of spread directions by enlarging the neighbourhood size from 8 to 24 and the distortion error was relatively reduced by notably increasing the computational costs the second strategy is the application of a new spread mechanism accepting the assumption of expanding ellipse green 1983 and huygens wavelet principle peterson et al 2009 improved the hfire model morais 2001 by adding an ellipse adjustment factor eaf in the calculation of the length to width ratio of the local predicted ellipse for each ignited cell however a regular octagonal fire shape instead of a circle is presented in zero wind speed and flat terrain conditions then trunfio et al 2011 and avolio et al 2012 devised two improved wildfire models in which the local fire source inside each cell was not restricted to the cell centre and the fire spread was not limited in eight directions although the relaxation of spread directions applied in these two models produced fire shapes relatively close to the theoretically elliptic shape the error due to the uncertainty is significant when the degree of freedom is superior based on the studies of peterson et al 2009 and johnston et al 2008 tiziano ghisu et al 2015 added five correction factors to the spread rate equations through the optimization of several combinations of eccentricity and equivalent wind directions or maximum spread direction the optimal values for the five correction factors are then obtained to construct a surrogate model using the rbf algorithm which is integrated in the ca solver under both uniform and non uniform conditions the proposed method obtains fire perimeters closely matching the optimized target shapes calculated by farsite the main ideology of these correction factors is to strengthen the directional dependency in spread rate calculation which is adopted in the present study to generate a new spread mechanism the last strategy is the combination of physical equations and the ca algorithm based on previous studies illustrating complete combustion by the reaction diffusion model séro guillaume and margerit 2002 margerit and séro guillaume 2002 collin et al 2010 demonstrated how a new ca model could be constructed from a physical model although the numerical simulation result of the model in zero wind and flat terrain conditions with uniform vegetation is consistent with the prediction of a circular fire perimeter the convolution integral calculating the radiative flux is computationally intensive while the wind and slope influences on fire propagation need further investigation ignoring this distortion problem many authors have presented faster than real time simulation systems of wildland fires with high fidelity fire behaviour inputs sun et al 2013 jellouli et al 2016 berjak and hearne 2002 yassemi et al 2008 additionally due to the lack of physical basis as previously mentioned few models have the potential to contain enough simulated fire properties except for the physical ca proposed by collin et al 2010 altogether these ca models suffer from two main drawbacks the distortion problem in simulated fire shapes and the lack of a physical basis in fire behaviour modelling based on previous studies a new ca approach named spread vector induced cellular automata svica is proposed in which the quasi physical equations of crown fire behaviours based on a simplified fuel bed and fire model are embedded one of the originalities of the present study is illustrated in the radiation model by a new spread mechanism termed the spread vector algorithm which can significantly minimize the distortion problem without mathematical correction owing to the physical framework used in model construction more fire front properties are simulated under both homogeneous and heterogeneous conditions particularly the simulation of the spatio temporal evolution of the fire band thus the model could then be implemented in a real time firefighting training system to perform fire behaviour simulation under the given conditions the present study is organized in the following manner the basic hypotheses and the framework of the svica model are presented in section 2 then the detailed derivation of the model is presented in section 3 to study the performance of the model several numerical simulations are performed and their results are shown in section 4 finally the discussion and the conclusions of the present study are highlighted in section 5 2 preliminary hypotheses and svica framework to specify the scale and the objective held throughout the present study several hypotheses and analyses have been made prior to the illustration of the svica framework the first assumption is that the crown fires modelled in the present study are active crown fires according to its definition fires that spread through surface ladder and canopy fuels could be regarded as a single unit thus the vertically stratified forest through which crown fires spread is simplified as a monolayer fuel bed the second assumption is that the radiative transfer due to flame radiation is the dominant heat transfer method along the fire front line where the convection and conduction effects are neglected the last assumption is that the heat loss is negligible over the heat gain during the ignition process and the ground is considered adiabatic from a global perspective the fire front and the fire rear are both a one dimensional line expanding in a two dimensional vegetal combustible surface influenced by the topography meteorology and other external factors the region between the corresponding fire front and fire rear lines is naturally defined as the fire band at this scale at instant t a certain perimeter element δ p t of the fire front line fig 1 is situated between two parts of the fuel bed surface unburn area and burning area the element is characterized by a normal vector n whose direction indicates the spread trend of the represented element after a short period δ t the fire front line changes its shape and in the direction of the normal vector of δ p t a corresponding perimeter element δ p t δ t exists belonging to the fire front line at instant t δ t hence the fire front line and the fire rear line can be discretized at both the time and space scales locally the specific pyrolysis and combustion of forest stratum are complex chemicophysical processes séro guillaume and margerit 2002 which should be simplified additionally the monolayer fuel bed mapped to the cellular lattice could divide the global fire propagation into a collection of local cellular fire behaviours which is illustrated by different cell states the fire band is then presented by a series of cells with the same burning state moreover the resolution of this presentation is limited by the size of the cell for accuracy the flame depth should be greater or equal to this characteristic size but in most cases the restriction could be relaxed cf section 3 2 therefore the advance of the fire front line within each cell is negligible compared to the inter cell fire propagation suggesting that vegetal combustion in one cell is considered homogeneous simultaneously heated and consumed with these analyses and hypotheses application of the ca approach to simulate crown fire is feasible and the framework of the svica model applied in the present study is summarized in fig 2 the svica model is basically developed from the traditional ca model by integrating the physical process of crown fire and the concept of spread vector with state definition and local state transition rules the description of the framework is as follows firstly spatial distribution rules of cells and neighbourhood rules define the basis of the svica model in the present study the cellular space consists of a bidimensional regular square lattice each cell of the lattice is sized by the square side length a and moore neighbourhood is applied so that the inter cell radiation is restricted to the immediate adjacent cells in fig 3 the centre cell is shown in blue and its eight neighbour cells named with azimuth are shown in red secondly using input mapping rules fuel bed properties cf section 3 1 together with the topography and meteorology data are projected to the specific cell for the initialization topography data of the studied area are presented by a digital elevation model dem and each cell is assigned a proper elevation value after the projection process as for the meteorology data ambient temperature and 20 ft winds are considered in the present study finally as the core component of the svica model framework the cell is discussed here using the state transition rules states of the cell are defined according to the state variables as part of the inputs the values of state variables are updated at every discrete time step with the reaction function cf section 3 2 corresponding to the current state outward radiation to neighbour cells is calculated by the radiation model cf section 3 3 and then adjusted by the spread vector algorithm however radiation received from other cells is summed up at each time step and serves as the heat resource in the reaction model while the radiation from each ignited cell is separately accumulated with time and used as the weight to compute the spread vector based on the framework illustrated above in the following section the detailed calculation and derivation of the key components of the svica model will initially be interpreted and then the integrated model description is proposed in section 3 5 3 svica model 3 1 fuel bed and fire model 3 1 1 idealized fuel bed inspired by simplified representation of the crown fire front pastor et al 2003 before discretization the stylized cross section of vegetal stratum along the fire spread direction under flat terrain and zero wind conditions is modelled and shown in fig 4 to inherit some concepts and conclusions on fire behaviour from previous studies alexander and cruz 2012 as assumed above the fuel bed is locally homogeneous with a characteristic depth h t which represents the average height of local trees the fire band is then considered uniform featuring s flame depth d f and flame height h f in addition flame length l f is defined as the distance between the tip of the flame and the surface of the remaining fuel rothermel and deeming 1980 furthermore l f is calculated at the fire front by the following equation 1 l f h f h t where the flame height h f derived from h t and l f is a key parameter in the radiation model thus by inserting mapped vegetal stratum data into each cell an idealized fuel bed in the horizontal cellular space cf fig 5 is constructed and the elevation information is implicit so far the feature variables that serve as inputs in the reaction and radiation models include actual dry fuel density ρ kg m 2 residual ash density ρ e x t kg m 2 relative fuel moisture h μ dimensionless average tree height h t m combustion calorific value q kj kg notably within each cell the local fuel bed is homogeneous with the feature variables listed above and the total fuel mass in one cell δ m is calculated as 2 δ m a 2 ρ h μ ρ 3 1 2 fire model for a fire front cell in an idealized fuel bed after a period of spreading one cell is defined as the burning state when the fire front line appears in the current cell range and the state ends once the fire rear line completely leaves the cell as previously mentioned local fire behaviours in each cell are considered to be simultaneous indicating that in a discrete cellular space fires discretely propagate from cell to cell the outer border of the fire band as the fire front line is interpreted as a cell chain notably the length of the fire front line in cellular space is proportional to the number of cells in the chain hence the length of the fire front element in each chain cell is considered as a then the fire model of these frontier cells should be studied and several concepts are proposed cf fig 6 crown fires in the border cell are regarded as a blackbody plane s f perpendicular to the cellular space the length of the hemline is equal to cell size a and the height of the plane is equal to the flame height h f equivalent fire surface s f situates in the centre of the cell and the fire direction is characterized by a unit normal vector s v the so called spread vector average distance of trees d t in real situations trees are separately distributed d t is proposed to represent the distribution density of trees thus fire discretely spreads from tree to tree within a cell and d t involves the propagation by the calculation of flame radiation cf section 3 3 in fig 6 the distance between the equivalent fire surface s f and nearest equivalent tree surface s t is equal to this average distance d t nearest equivalent tree surface s t to estimate maximum effective radiation power released from the flame and absorbed by the trees an ideal tree plane is defined assuming that the trees in each cell are uniformly distributed with average distance d t in the direction of s v a row of trees could be found while each tree in the row is apart from s f in the distance d t these trees form a plane parallel to s f as the so called nearest equivalent tree surface s t the hemline of s t equals a and the height equals the average tree height h t s t is the blackbody without any hole on the surface sub cell structure based on the concepts above the propagation of crown fires could be considered as successive ignitions of equivalent tree surfaces in the spread direction owing to the idealized fuel bed assumption the outward radiation power from a cell is constant thus by evaluating the radiation projected from s f to s t the whole effective radiation power released by a current burning cell is estimated cf section 3 3 however different from temperature changes and the water evaporation prior to ignition the fuel consumption of equivalent tree surfaces in one cell is coincident with another in the time scale suggesting that the simultaneous fuel consumption should be corrected thus the adjustment configuring the sub cell structure should be made once the uniform fuel bed hypothesis is considered cf section 2 3 considering the sub cell structure the concept of cell scale n is proposed as 3 n a d t this value represents the relative density of trees in the cell scale and equals the maximum number of equivalent tree surfaces a single cell could contain in addition in the time scale there is a minimum time during which the fire spreads from one cell to its neighbour as the shape of the cell is not centrosymmetric cell size a is used to characterize this minimum time t a 4 t a a r where r is the estimated fire spread rate in the current cell cf section 2 4 in the sub cell scale the time during which the fire spreads between two adjacent equivalent tree surfaces is indicated as t d t 5 t d t d t r t a n 3 1 3 end point and ignition point the fire model above is based on the assumption that the fire front line within a cell could be regarded as a segment whose length equals a in real cases fire front lines are not always closed and after the projection to the cellular space the two end cells of a no closed cell chain are no longer topologically a line in addition different from the frontier burning cells the ignition cell is naturally defined as a point therefore a point cell model should be considered for both the end points of fire front lines and ignition points in the present study a cell is defined as a point cell where the fire could spread towards eight potential neighbours in each direction the fire is regarded as an equivalent fire surface with the same size defined above and situated in the centre of the cell the identification of an end point cell from fire front cells will be illustrated at the end of section 3 3 2 then considering the ignition point once the neighbours of the cell are ignited they become new ignition points and the iteration continues until the fire front reaches the threshold distance of initial spread beyond this distance the fire model for the fire front could be applied to simulate the fire spread 3 2 reaction model based on the fuel bed and fire model above the reaction diffusion model collin et al 2010 is introduced and updated in the present study with several adjustments borrowing the hypotheses of collin collin et al 2010 and owing to the homogeneity of the fuel bed in each cell the following reaction equations are adopted in the present study 6 ρ c s h μ c l d t d t h t a t δ p r 0 ρ d h μ d t l e v δ t t e v p r 1 δ ρ ρ e x t d ρ d t φ ρ φ w t ρ a e e r t w h e n ρ ρ e x t a n d t t i g in the equations above t is the current temperature of the fuel bed in the cell and t a t e v and t i g represent the ambient evaporation and ignition threshold temperature respectively additionally ρ ρ e x t and h μ are important fuel bed features mentioned above and ρ 0 represents the initial fuel density c s corresponds to the heat capacity of the of the solid parts in vegetal combustible and c l is the heat capacity of water l e v is the evaporation latent heat of water and δ is the dirac symbol moreover h represents the heat transfer coefficient that is null when p r is positive and p r is the density of total radiation power absorbed by the current cell derived from arrhenius law a is the prefactor r the ideal gas constant and e the activation energy as for the fuel consumption correction factors φ ρ presents the adjustment due to the adoption of the sub cell structure and φ w t derives from the influences of the wind and terrain slope for simplification collin collin et al 2010 assumed that combustion occurred at a constant temperature t c the so called combustion temperature where t reached the ignition threshold temperature t i g thus only one of t h μ and ρ is time varying in a given cell state assuming weak variations of t h μ and ρ according to time the euler scheme is applied to approximate the derivative term in eqn 6 the reaction equations are discretized in time scale with little variation of time δ t 7 ρ c s h μ c l δ t δ t h t a t δ p r 0 ρ δ h μ δ t l e v δ t t e v p r 1 δ ρ ρ e x t δ ρ δ t φ ρ φ w t ρ a e e r t c w h e n ρ ρ e x t a n d c e l l i s i g n i t e d according to newton s law of cooling the heat transfer coefficient h is proportional to the residual fuel bed depth during the cooling process and the relation is presented by 8 h k h ρ e x t ρ 0 2 3 h t where k h is the average heat transfer coefficient in height and the term ρ e x t ρ 0 2 3 is used to evaluate the residual surface proportion of the fuel bed due to the difficulty in estimating the real h involving the effective surface of trees and air convection the assumption above is made to simplify the heat loss calculation with respect to the cooling law as previously mentioned the sub cell structure should be considered in the calculation of the correction factor φ ρ using eqn 6 the entire duration of combustion of one equivalent tree surface the so called residence time t r is estimated in the following equation 9 t r l n ρ 0 ρ e x t a e x p e r t c φ w t with eqn 9 the condition t r t d t should be satisfied to ensure the continuation of propagation in the sub cell scale moreover a stricter condition t r t a is posed to maintain a flame depth greater or equal to a in the global scale as mentioned in section 2 the restriction should be relaxed when the fire band is thinner than the cell size under this condition the first inequality is adopted so that the application scope of the model is expanded in sub cell scale the total duration of combustion in one cell t r is estimated as follows 10 t r t r t a where the propagation delay in a cell is considered and estimated by t a therefore the correction factor φ ρ could be calculated as 11 φ ρ t r t r 1 t a t r 1 when t a t r φ ρ tends to be 1 indicating that the sub cell structure is negligible if the spread speed is high enough however the sub cell structure should also be considered during the cooling process as burnout equivalent tree surfaces are non combustible the outer flame radiation is obstructed at the current cell border which is why the absorbed radiation power density in eqn 6 is neglected when ρ ρ e x t as one of the external factors mentioned in the model framework the water dropped from a fire fighting helicopter or plane in one cell is supposed to be a unit with ambient temperature t a compared with the cell temperature t different cases are listed below when t t e v water is evaporated immediately within a time step if the quantity of water is under the threshold to cool down the whole cell below t e v if the water dropped is beyond that limit and then part of the water is evaporated to reduce t from t c to t e v and the rest follows the rules below when t t e v the evaporation process is interrupted immediately and the relative fuel moisture h μ should be updated due to the augmented liquid water in the cell as t t e v the cell temperature is reduced according to the mass of the water within a time step and h μ is increased 3 3 radiation model 3 3 1 radiation power received and released the radiation power density p r mentioned in the reaction model is estimated in this section and the total radiation power received in cell p r is equal to a 2 p r where a 2 represents the area of the current cell p r is calculated as 12 p r n k ε ℕ p r k where ℕ represents the set of adjacent eight cells and p r k equals the radiation power received from the k th neighbour n k n k ℕ for the radiation generated by the flame in one ignited cell based on the fire model proposed above the total radiation power released by the front surface of s f is estimated by the stefan boltzmann law 13 p f σ t c 4 a f in eqn 13 σ is the stefan boltzmann constant a f is the area of equivalent fire surface s f which equals a h f and t c is the combustion temperature of the flame that is supposed to be constant thus the total generated radiation power from a burning cell is calculated by the following equation 14 p f σ a h f t c 4 the nearest equivalent tree surface s t is used now to estimate the angle factor of radiation heat transfer φ f t from s f to s t cf fig 7 which estimates the maximum outward radiation released from a burning cell in zero wind and flat terrain conditions by definition φ f t is calculated by 15 φ f t s f s t cos θ f cos θ t π r 2 d a t d a f a f where d a t and d a f indicate the infinitesimal area of s t and s f respectively vector r is defined from the position of d a f to the position of d a t thus θ f represents the angle between r and the normal vector of d a f pointing at s t comparatively θ t is the angle between r and the normal vector of d a t pointing towards s f the value of φ f t is influenced by the fuel bed features in analogy to the fuel spatial distribution and arrangement adjusted index k s sun et al 2013 which estimates the proportion of maximum outward radiation power p f t m a x to p f in real cases the porosity of trees leads to radiation leakage on equivalent tree surfaces evaluated by k p the porosity factor of the fuel bed then the effective outward radiation power p f t is 16 p f t k p p f t m a x k p φ f t p f k p σ a t c 4 φ f t h f using numerical integration the value of φ f t h f could be calculated with fixed d t and h t then the binary function φ f t h f f d t h t could be fitted by using a cubic polynomial cf appendix a 3 3 2 spread vector algorithm as mentioned above the spread vector s v is a unit normal vector of equivalent fire surface s f which indicates the spread tendency of the current ignited cell due to the nonuniqueness of s f in point cells the spread vector s v is viable only for fire front cells before the illustration of the spread vector algorithm several notations should be clarified the use of moore neighbours restricts the fire spread to eight potential directions at the centre of the cell in each neighbour direction a unit vector n k is attached and numbered with k cf fig 8 the angle from n k to spread vector s v is marked with θ k therefore all the unit vectors n k that satisfy θ k π 2 could constitute two orthogonal bases without a unit vector in common the following bi projection of s v is applied in these two bases once the current cell is ignited the bi projection of s v is executed to estimate the proportion of radiation power released in each potential direction as shown in fig 8 s v could be projected in two orthogonal bases n 8 n 2 and n 1 n 3 and the bi projection equation is as follows 17 s v 1 2 cos θ 8 n 8 cos θ 1 n 1 cos θ 2 n 2 cos θ 3 n 3 in addition the arrangement of neighbours for each cell is not centrosymmetric cf fig 9 and a distance correction factor should be added to each diagonal direction including n e s e s w and n w different from the fire front cells the point cells release the radiation uniformly in all directions hence under zero wind and flat terrain conditions the effective radiation power p k released from an ignited cell in the direction of n k k is odd is calculated by 18 p k 1 2 cos θ k p f t 1 2 cos θ k k p p f φ f t f i r e f r o n t c e l l p f t k p p f φ f t p o i n t c e l l the effective radiation power projected to the k th neighbour cell in diagonal direction n k k is even is evaluated by 19 p k 2 4 cos θ k p f t 2 4 cos θ k k p p f φ f t f i r e f r o n t c e l l 2 2 p f t 2 2 k p p f φ f t p o i n t c e l l for a point cell the allocation proportion of the state transition medium between normal and diagonal neighbour cells named the diagonal factor in the present study cf appendix b is 2 2 under the given fuel bed conditions then concerning the fire front cells the conservation of radiation power is examined in the form of radiation power work defined as the product of p k and the relative distance to s f the summation of the work in each potential direction n k remains constant the example shown in fig 8 is examined as follows 20 2 4 cos θ 8 2 2 a 2 4 cos θ 2 2 2 a 1 2 cos θ 1 2 a 1 2 cos θ 3 2 a p f t a p f t eqn 20 shows that the total radiation power work of the cell stays the same and equals a p f t therefore for any spread vector s v conservation of radiation power is verified in the sense of radiation power work the spread vector s v should be evaluated once the current cell is ignited based on accumulated radiation heat received from the neighbours the following equation illustrates the calculation of s v 21 s v σ ℕ n k q n k σ ℕ n k q n k where q n k is the accumulated radiation heat from the cell n k in the direction of n k and operator returns the module of a vector with the definition of the spread vector s v the vertical vector of s v is indicated as s v where s v s v 1 during the spread simulation as for a new ignited fire front cell the dot product between s v and n k for each ignited neighbour cell n k is calculated if these products are of the same sign then the new ignited cell is classified as a point cell and should follow the corresponding radiation rules 3 4 wind and slope effects the meteorology and topography data mentioned above consist of wind and terrain elevation information to simplify the complex interaction involving the flame wind and slope in each cell several hypotheses are made the effects derived from wind and slope are independent of each other wind considered in the present study is supposed to be spatially uniform the elevation of one cell is measured with altitude in metres with the above assumptions the final inputs of wind and slope that influence the fire behaviours are illustrated in section 3 4 1 and their detailed impacts on radiation heat transfer and fuel consumption rate are discussed below 3 4 1 wind and slope inputs a 20 ft wind is considered as the measurement of wind and the static wind field is supposed to be uniform the size of the 20 ft wind is presented by v 20 f t and v 20 f t is the unit vector indicating the direction of the wind in cellular space local winds driven by general winds aloft are slowed by surface friction near the top of the fuel bed andrews 2012 and then the midflame wind speed v m i d derived from v 20 f t is corrected by the wind adjustment factor waf where the midflame height is supposed to be h t thus based on the logarithmic wind profile the equation albini and baughman 1979 that evaluates the waf is 22 w a f v m i d v 20 f t 1 l n 6 096 0 36 h t 0 13 h t for the calculation of the local terrain slope digital elevation model dem data are used to assign an altitude h a l t to each cell the slope angle θ t k in the direction of n k is estimated by the following equation 23 θ t k a c t a n h a l t k h a l t a w h e n k i s o d d a c t a n h a l t k h a l t 2 a w h e n k i s e v e n where h a l t and h a l t k correspond to the altitude of the current cell and its k th neighbour cell n k respectively based on the elevation data above the curve indicating the relation between the slope heading direction and the corresponding slope angle is applied by using cubic polynomial fitting thus the slope angle θ t for any direction in cellular space could be evaluated 3 4 2 impacts on radiation heat transfer as the fire spread rate is proportional to the radiative heat transfer power the empirical equations that illustrate the spread speed changes influenced by wind and slope could be integrated into the radiation model for fire front cells the wind speed adjusted index k w different from waf and the slope adjusted index k t sun et al 2013 are adopted in the present study as 24 k w e x p k w v m i d c o s θ w k t e x p s g n θ t k t tan θ t 1 2 cos θ t where θ w represents the angle between v 20 f t and s v θ t is the slope angle in the direction of s v function s g n θ t returns 1 when θ t 0 and returns 1 when θ t 0 k w and k t are empirical constants and cos θ t is added in the present study due to the projection of the spread rate from the terrain surface into the horizontal cellular space therefore the final effective radiation released from the fire front cell and absorbed by its k th neighbour is determined as 25 p k 1 2 k w k t k p p f φ f t cos θ k w h e n k i s o d d a n d θ k π 2 2 4 k w k t k p p f φ f t cos θ k w h e n k i s e v e n a n d θ k π 2 0 w h e n θ k π 2 for the point cells the wind speed adjusted index k w k and the slope adjusted index k t k are calculated for the k th neighbour cell by using eqn 24 where θ w and θ t are replaced by θ w k and θ t k θ w k is the angle between v 20 f t and n k and θ t k represents the slope angle in the direction of n k hence the final effective radiation released from the point cell to the k th neighbour is calculated in the following equation 26 p k k w k k t k k p p f φ f t w h e n k i s o d d 2 2 k w k k t k k p p f φ f t w h e n k i e v e n 3 4 3 impacts on fuel consumption based on the fire model defined in section 3 1 the area of the fire surface is proportional to the flame height h f and the combustion is considered as uniform in real cases the influences of wind and slope on the fuel consumption rate are complex to simplify the process it is assumed that the wind and slope affect the fuel consumption only by changing the flame height h f to evaluate h f in each cell the simplified expression for fireline intensity i rothermel and deeming 1980 is applied as 27 i 258 l f 2 17 q ρ r the estimated fire spread rate r is measured as follows 28 r k w k t k p σ t c 4 φ f t h f ρ c s t i g t a h μ c l ρ t e v t a h μ ρ l e v where φ f t h f is estimated by binary function f d t h t cf appendix a and based on eqn 1 and eqn 27 h f is then calculated as 29 h f l f h t q ρ r 258 0 46 h t the fuel consumption adjustment factor φ w t is then evaluated as follows 30 φ w t h f h f w 0 t 0 k w k t h f w 0 t 0 h t 2 17 0 46 h t h f w 0 t 0 as the denominator h f w 0 t 0 is the origin flame height in zero wind and flat terrain conditions with the given fuel bed inputs 3 5 model description spread vector induced cellular automata svica the svica model is defined in a bi dimensional horizontal cellular space comprising grid cells with size a in lattice the description of the model is divided into four parts firstly the final inputs of each cell and the mapping rules are specified secondly the state variables and the states of the cell are defined then the local state transition rules are illustrated with detailed equations and judgement logic and finally the time step length δ t of simulation is discussed 3 5 1 cell inputs and mapping rules as illustrated in the framework cf fig 2 the fuel bed properties combined with topography and meteorology data constitute the inputs of each cell based on the component models introduced above the cell inputs are divided into two categories fuel bed properties and external factors the fuel bed properties include current temperature of the fuel bed t input constants t a t e v t i g and t c actual dry fuel density ρ input constants ρ 0 and ρ e x t relative fuel moisture h μ input constant initial relative fuel moisture h μ 0 average tree height h t average distance of trees d t porosity of trees k p combustion calorific value q average heat transfer coefficient in height k h external factors consist of ambient temperature t a altitude h a l t 20 ft wind intensity v 20 f t and unit wind direction vector v 20 f t mass of the water dropped in cell m w as shown in fig 10 cell inputs can be unfolded and regrouped vertically into several input spaces which is constituted by input data of the same type the resolution of each input space should equal that of the cellular space thus for each cell at position i j in the cellular space there are corresponding input data p k i j in input space k compared with the resolution of the cellular space original data maps such as the dem map vegetation distribution map wind field map etc could have different data precisions using data sampling and averaging original inputs of the same type are mapped into the corresponding input space with the same resolution as the cellular space these adjustment rules of resolution are called input mapping rules hence the reaction model and initiation of the radiation model can access and modify the input data by consulting the current cell position through cell inputs 3 5 2 state variables and state definition based on the reaction model three fuel bed properties are selected as the state variables t h μ and ρ depending on the variation of the three state variables cf table 1 seven states are defined and the key variables in the specific state transition are specified as follows state 1 s 1 initial state t is the key variable state 2 s 2 pre evaporation state t is the key variable state 3 s 3 evaporation state h μ is the key variable state 4 s 4 pyrolysis state t is the key variable state 5 s 5 burning state ρ is the key variable state 6 s 6 burnout cooling state t is the key variable state 7 s 7 burnout final state t is the key variable 3 5 3 local state transition rules by integrating the reaction and radiation model with the state definition the local state transition rules of the current cell are illustrated as follows s 1 and s 2 current temperature of the fuel bed in cell t is a key variable once heated by adjacent cell s in state s 5 t changes its value discretely at each time step δ t represents the variation of t from current time t to next time step instant t δ t and based on the eqn 7 δ t is calculated by 31 δ t p r a 2 h t a t t δ p r 0 a 2 ρ c s h μ t c l δ t where t t and h μ t represent the values taken at instant t by t and h μ respectively p r is estimated by eqn 12 and the heat loss is negligible when p r takes non null values at instant t if water with mass m w is dropped into the cell then t is changed to t m i x according to the conservation of the heat t m i x is evaluated by 32 t m i x t t a 2 ρ h μ t c l c s t a m w c l m w c l a 2 ρ h μ t c l c s therefore δ t is calculated by the following equation 33 δ t p r a 2 h t a t m i x δ p r 0 a 2 ρ c s h μ t c l m w c l δ t additionally starting from the next time step h μ t δ t changes its value and is calculated by 34 h μ t δ t m w h μ t a 2 ρ a 2 ρ based on the variation of t at the beginning of each time step the state transition rules are as follows if t a t t e v state is s 2 else if t t e v state changes to s 3 else state stays in s 1 s 3 the key variable of state s 3 is changed to h μ t maintains the value t e v and the variation of h μ from current time t to next time step instant t δ t is indicated as δ h μ based on eqn 7 δ h μ is calculated by 35 δ h μ p r l e v ρ a 2 δ t at instant t if water of mass m w is dropped into the cell then the process of evaporation is immediately interrupted and the cell state changes to s 2 additionally temperature t drops from t e v to t m i x which is calculated by the following equation 36 t m i x t e v a 2 ρ h μ t c l c s t a m w c l m w c l a 2 ρ h μ t c l c s before the next time step the value of h μ t δ t changes which is evaluated by eqn 34 the rules of state transition of s 3 are illustrated below if h μ 0 and p r 0 state changes to s 4 else if h μ 0 and p r 0 state changes to s 2 else state stay in s 3 s 4 in the pyrolysis state t is the key variable from t to t δ t and δ t is calculated by the following equation 37 δ t p r a 2 h t a t t δ p r 0 a 2 ρ c s δ t if water of mass m w is dropped in the cell at time t and evaporated at once then heat loss occurs and temperature t should drop from t t to t m i x where 38 t m i x t t a 2 ρ c s m w l e v c l t e v t a a 2 ρ c s if t m i x t e v state changes to s 2 and then based on the assumption in section 3 2 only part of the water m w is immediately evaporated which is calculated by 39 m w t t t e v a 2 ρ c s l e v c l t e v t a the rest of the water of temperature t a continues cooling down the fuel bed to the final temperature t m i x 40 t m i x t e v a 2 ρ c s t a c l m w m w a 2 ρ c s c l m w m w additionally from the next time step h μ appears again and equals 41 h μ m w m w a 2 ρ however if the t m i x t e v state remains in s 4 all water is evaporated for an instant and δ t is evaluated by eqn 37 where t t is replaced by t m i x at the beginning of each time step transition rules are executed if t reaches t i g then state changes to s 5 and the temperature immediately increases to t c the calculation of the spread vector is applied at this instant however if t e v t t i g then the state remains in s 4 the rules are discussed above s 5 in the burning state ρ is the key variable and its variation δ ρ from current time t to the next time step instant t δ t is estimated by the following equation 42 δ ρ φ ρ φ w t ρ t a e e r t c δ t where ρ t represents the value of ρ at instant t additionally if water of mass m w is dropped in the cell at time t then the supposed cooled temperature t m i x is calculated by eqn 38 where t t and ρ are replaced by t c and ρ t respectively the transition rules are as follows at the beginning of the time step if ρ decreases and reaches ρ e x t then the state changes to s 6 if ρ ρ e x t and t i g t m i x t c then the state remains in s 5 if ρ ρ e x t and t e v t m i x t i g then the fire is extinguished by water and the state changes to s 4 with t t δ t t m i x at the next time step if the fire is extinguished by part of the water and the cell is cooled down to s 2 m w is calculated by eqn 39 replacing t t and ρ as above the final mixed temperature t m i x is estimated by appling eqn 40 while ρ is replaced by ρ t in addition h μ is calculated by eqn 41 s 6 and s 7 in these two states t is the key variable as assumed in the reaction model in these two states p r equals zero and the heat loss is considered δ t is then calculated as follows 43 δ t ρ e x t ρ 0 2 3 h t a t t ρ e x t c s δ t considering the result due to the water dropped in the cell at instant t several cases are discussed below if t t t e v water is evaporated and the supposed cooled temperature t m i x is evaluated by the following equation 44 t m i x t t a 2 ρ e x t c s m w l e v c l t e v t a a 2 ρ e x t c s as discussed in s 5 if t m i x t e v then the final mixed temperature t m i x should be estimated on the condition that t t t e v water cools down the fuel bed and the cooled temperature t m i x is calculated as 45 t m i x t t a 2 ρ e x t c s t a m w c l m w c l a 2 ρ e x t c s therefore if water is dropped then δ t could still be evaluated by eqn 43 but t t is replaced by t m i x or t m i x according to the temperature of the cell t altogether the transition rules are cited below if t t a the state is s 6 alternatively when t reaches the ambient temperature t a the state is s 7 3 5 4 time step one of the most important parts of the ca algorithm is the time step length δ t which should be specified to guarantee the required simulation precision mathematically the discretization in time scale leads to the result that the variation of state variables is discontinuous on the one hand with determined time step judgment delay occurs when the key variable reached and exceeded the logic threshold before the judgment is made at the start of the next time step on the other hand the estimated spread distance during δ t is greater than the cell size a while the maximum spread speed that ca algorithm could realize is a δ t called the transition delay due to the two delays a shorter time step is applied and a more accurate fire shape will be generated at the cost of computation intensity augmentation sun et al 2013 therefore for a deterministic cell size a and mapped input spaces the estimated minimum spread time between cells t a is calculated and the condition δ t t a should be satisfied to avoid the transition delay furthermore to ensure that the judgment delay error is under 1 δ t 0 01 t a should be considered the real time cost by designated computer platform for each iteration is presented by t c o s t the time index η t i m e is defined as the ratio of δ t to t c o s t the simulation is called real time when η t i m e 1 faster than real time if η t i m e 1 and slower than real time when η t i m e 1 in the svica model t c o s t for one calculation step is measured and its value is assigned to δ t for the next time step to achieve the real time simulation 4 numerical simulations and results in this section the svica model is firstly applied in uniform fuel bed conditions where the vegetation studied in the present study is one type of the coniferous forest distributed near beijing the so called larix principis rupprechtii one dimensional and two dimensional fire spread cases are performed with particular inputs and the results of these numerical experiments were analysed to rapidly examine the implementation of the model on the computer referring to the physical properties and constants given by previous studies sun et al 2013 collin et al 2010 séro guillaume et al 2008 sun and niu 2012 wang et al 2010 a uniform fuel bed is constructed with the inputs listed in table 2 much of the development of technology for implementing the models in a numerical simulation environment has concentrated on methods for converting the one dimensional linear model of fire spread to that of two dimensional planar models of fire spread sullivan 2009a different from these methods the radiation model of the svica model is originally defined for two dimensional fire spread as a special case stable fire spread in one dimension is proposed to examine the variation of state variables and the spread rate changes influenced by different factors the general two dimensional fire spread in uniform fuel conditions is studied to illustrate the distortion problem and shape changes due to wind and slope and multi point ignition is preliminarily explored after a series of numerical simulations under uniform fuel bed conditions the svica model is applied in several synthetic forest tests where the vegetation properties of the fuel bed are heterogeneous to perform the sensitivity analyses on fuel bed parameters finally with the actual landscape data and synthetic inputs the wildfire on spetses island alexandridis et al 2008 in 1990 is studied the following simulations were performed on a personal computer with intel core i7 processor 8 gigabytes ram gtx 970 m gpu and running on windows 8 1 64 bit os these simulations were realized with unity unity a 3d game development platform using c language 4 1 1d fire spread in uniform fuel bed conditions in a two dimensional uniform fuel bed a fire line of infinite length could propagate stably at a constant spread rate called 1d fire spread under this stable condition the variation of the state variables is studied to examine the state transition process in each cell and the influences on fire behaviours could be analysed by changing several vegetation properties and external factors notably in the computer simulation environment the infinite fire line is inaccessible thus the topological structure of the cellular space should be transformed to satisfy the stable spreading conditions while the existing rules in each cell should remain unchanged the required structure of the cellular space is illustrated in fig 11 the finite cellular tube shown above illustrates the adjacency relationship between cells along the tube each subsection formed by three end to end cells is numbered from 0 to m m n except for both extreme subsections each cell of the tube possesses complete eight moore neighbours as for the initiation the state of cells labelled 0 is set to be s 7 and cells marked with 1 are at state s 5 as the ignition points the threshold distance of initial spread is a thus from cells numbered 2 a stable 1d fire spread along the tube is performed with a limited amount of cells and the experimental rate of the spread is estimated below by respectively recording the ignited time of number 2 and number n n m cells as t 2 and t n n m the experimental rate of the 1d fire spread r e x p is calculated by 46 r e x p a n 2 t n t 2 η t i m e to save the experiment time while maintaining the precision with the input data listed in table 2 a series of faster than real time simulations are executed below with η t i m e 10 and time cost per frame t c o s t set as 0 02 s as mentioned in section 3 5 4 δ t should be small enough to maintain simulation accuracy in unity the assignment statements of state variables are executed within a function named fixedupdate which is executed every 0 02 s if there is no overflow of calculation then all statements within the fixedupdate function for each cell are collected together for calculation in one frame time otherwise the physical calculation time exceeds the fixed frame time t c o s t due to augmentation of the calculation pressure the fps frames per second of the simulation will decrease to finish the calculation and thus the real t c o s t is not constant to compensate for this defect two strategies are applied in the present study the first strategy is a dynamic cellular space mechanism to reduce the calculation pressure one cell and its scripts are created and added in the simulation only when its neighbour cell is burning once the cell is burned up it will be deleted thus only the burning cells and the heated cells are considered in each frame the other strategy is a dynamic step time as the fire scale becomes immense the first strategy cannot stop the overflow in addition the real time cost of the last frame t l a s t could be provided by unity which is used to estimate t c o s t of the current frame for each frame the time step δ t is calculated by η t i m e t l a s t whether the fps decreases or not the time step can be estimated properly due to the discrete variations in time over judgment exists in the state transitions and under all condition statements using time varying variables the accuracy of the judgement is controlled by the variations of conditional variables in each time step δ t additionally single precision floating points are used to store most of the variables which increases the error because the maximum number of significant digits is fixed to seven it is suggested that the greater the integral part of the data the less precise the decimal part is additionally time index η t i m e is set to 10 to accelerate the simulation thus the changes of the variables are ten times greater than real time in each time step to estimate the error between the estimated spread rate r and experimental rate r e x p e r is defined as 47 e r r r e x p r 100 for example under zero wind and flat terrain conditions t a equals 96 09 s and r is estimated as 0 2081 m s 1 using eqn 46 where n is set to 4 the experimental rate r e x p is measured and equal to 0 2070 m s 1 in addition δ t 0 2 s 0 01 t a so the time precision mentioned above is guaranteed so that the error between the estimated and the experimental rate values is less than 1 thus the calulation precision in the simplest condition is satisfied 4 1 1 variation of state variables over time focus on one of the cells numbered 4 taking the instant when the cells are initially heated as the starting time the variation of three state variables t h μ and ρ is recorded in each time step and the fitted curves are shown as follows fig 12 a represents the variation of t and h μ with time and fig 12b represents the variation of t and ρ with time as for the temperature of the fuel bed t it reached t e v at 20 8 s and at 96 4 s t attained t i g so that the cell is ignited t remained the value of t c during the fire combustion and began to descend at 313 8 s the total combustion time t r equals 217 4 s the decline of the relative fuel moisture h μ occurred during the evaporation process and finished at 47 4 s when h μ reached 0 the actual dry fuel density ρ of the current cell maintained the initial value ρ 0 before the ignition and declined to ρ ext at 313 8 s the results show that the physical processes were reflected properly by the three state variables and that the propagation in the transformed fuel bed is persistent thus the spread rate can be studied under different inherent or external conditions 4 1 2 impacts of external factors on the spread rate in this subsection external factors including wind slope and ambient temperature are considered to examine the impact on the spread rate and the relative error e r is calculated to evaluate the prediction precision first a uniform wind field along the spread direction is proposed the waf is calculated as 0 4367 under the given fuel bed conditions with flat terrain assumption v 20 f t ranges from 20 m s 1 to 20 m s 1 and the result is shown in the figure below in fig 13 as the 20 ft wind speed v 20 f t rises within the test range the experimental spread rate r e x p shows exponential growth corresponding to eqn 24 in addition the relative error e r approximately increases with r e x p and its value is less than 5 therefore within the range of v 20 f t the relative error is tolerable fig 14 secondly focusing on the slope caused impacts to the spread rate in the same fuel bed conditions without wind when slope angle θ t is under 30 52 the condition t r t d t is not satisfied suggesting that the fire propagation is interrupted where r e x p and r are reduced to zero hence the range of slope angle is limited from 30 to 45 where the variation of r e x p is studied and the result is shown as follows the relative error e r increases exponentially with r e x p when θ t 45 e r attained 17 42 which is more than twice the value of the e r at θ t 45 thus with a large slope angle and time index the precision of the simulation should be verified with e r finally the ambient temperature t a is considered to analyse the impact on the spread rate the value range of t a is from 258 15 k 15 c to 308 15 k 35 c and the simulation is applied in zero wind and flat terrain conditions the result is shown in the following figure as shown in fig 15 r e x p approximately increases with the growth of t a the relative error e r is under 1 due to the lower value of r e x p compared to those influenced by wind and slope in conclusion under the given fuel bed conditions and within the given ranges the three external factors discussed above are rated by precision as follows t a v 20 ft and θ t the higher the experimental spread rate the larger is the relative error obtained in the simulation 4 1 3 effects of water dropped in a cell under zero wind and flat terrain conditions with t a 300 k during the combustion of the cell numbered 3 the minimum mass of dropped water m w to extinguish the fire is evaluated at different instant t b u r n and the result is as follows fig 16 shows that if the water dropped in cell is under the curve of m w propagation of fires will continue and the minimum mass of water to put out the fire decreases exponentially with ρ cf fig 12b then in the same condition at t b u r n 60 s water of mass m w 600 k g is dropped in the cell and the variation of the temperature t is studied the results are shown in fig 17 the experimental result shows that at 60 s part of the water was evaporated at once to put out the fire the surplus water cools down t under t e v and increases h μ which is supposed to be zero after the ignition but the cell is then heated by cells numbered 2 and re ignited the entire process verified the local state transition rules interacting with the dropped water 4 2 2d fire spread in uniform fuel bed conditions compared with 1d fire spread fires developed from limited ignition points can propagate through the same two dimensional uniform fuel bed which is defined as the 2d fire spread problem the topological evolution of the fireline will be studied in this section specifically the 2d fire spread ignited by a single point is proposed to study several problems including the distortion problem spread features and effects of wind and of slope then the multi points ignition cases are discussed to illustrate the combination of fires derived from different fire sources all simulations below are executed with η t i m e 10 and time cost per frame t c o s t is set to 0 02 s 4 2 1 distortion problem the distortion of fire shapes simulated by ca models could be evaluated in the simplest fire pattern where the fire grew from a single ignition source on a flat terrain with a uniform fuel bed and under calm atmosphere conditions alexander 1985 in this case the expected fire front shape should be circular and the ignition point is located at the circle centre which is widely adopted in several studies collin et al 2010 peterson et al 2009 trunfio et al 2011 ghisu et al 2015 karafyllidis and thanailakis 1997 berjak and hearne 2002 encinas et al 2007b séro guillaume et al 2008 alexander 1985 in addition the assumption of expanding ellipse green 1983 is not accepted in the present study hence the distortion problem is studied in the simplest fire pattern mentioned above to illustrate the performance of the svica model in distortion correction a cellular space consisting of a bidimensional regular square lattice is constructed where the side length a of each cell is set to be 20 m as a contrast in the same cellular space two more ca algorithms the point cell model of svica and the hfire model karafyllidis and thanailakis 1997 are simulated representing the two major distortion patterns cf appendix b the complete model and point cell model of svica take the data shown in table 2 to build the fuel bed as for the hfire model karafyllidis and thanailakis 1997 the spread rate is uniform and equals 10 m s 1 and the total burning time for each ignited cell is set as 3 s when the i th cell in the reference spread direction cf appendix b is ignited at instant t i the expected circle radius length equals i a the threshold distance of the initial spread for the svica model is set to be 2 a then 400 m is considered as the expanding step of the simulated fire front and the original shapes of the simulated fire band using three ca algorithms are recorded and shown in fig 18 without any image or data correction the profile of the bands using svica is approximately circular cf fig 18a while the fire front shapes derived from the point model of svica and the hfire model karafyllidis and thanailakis 1997 are regular octagonal to provide a quantitative measurement to illustrate the precision of simulated shapes the following metric ghisu et al 2015 is adopted 48 λ s e s e s e s where e represents the set of cells forming the expected fire shape s the set of cells defining the simulated fire shape and the operator returns the size of a set consequently λ s measures the level of disagreement between the two shapes to evaluate the size of s at a given instant t i all burnt and burning cells which form the simulated fire shape could be directly counted additionally a cell should belong to e when its centre falls inside the expected circular boundary defined with radius length i a during the dynamic propagation in the reference spread direction every 20 m that the expected fire front expands is calculated and recorded the results are shown as follows as shown in fig 19 with the growth of the expected radius λ s of svica approximately declines the fire further spreads and a more precise shape is presented comparatively the λ s of the svica point model keeps rising and approaches the upper limit 0 05196 which is calculated by assumption that the simulated profile of the fire band is a regular octagon and its inscribed circle is the expected shape additionally λ s of the hfire model karafyllidis and thanailakis 1997 is higher than the two other algorithms and approximately equals 0 1 when the expected radius exceeds 500 m the results also illustrated why the active accumulation category is selected in constructing the svica point model in addition when the expected radius is beyond 520 m λ s of svica is less than that of eca trunfio et al 2011 using 8 neighbours when the radius exceeds 820 m λ s is under 0 005 and the result is even better than that of eca using 24 neighbours hence the svica model relatively improved the distortion problem in this basic fire spread pattern 4 2 2 analysis of the spread data as for the propagation behaviours of the simulated single ignition fire above using svica the evolution of the radius of the fire band is studied as well as the variation of burned area against the time from the original ignition firstly as shown in fig 18a under zero wind and flat terrain conditions the fire front and fire rear line are approximately in a circle thus the spread distance in rsd cf appendix b is selected as the equivalent radius to measure the radius of the fire front and fire rear line the radius revolutions against time are shown in fig 20 and the origin cell is ignited at time zero the above result shows that the fire propagated in two phases an initial transient propagation and a quasi steady propagation within the unsteady stage the fire rear appeared in a delay of 217 4 s which is equal to the total combustion time t r in addition both the fire front and fire rear fluctuated at the radius of 40 m where the transition from the initial to non initial spread occurred beyond that the spread rate was accelerated and after the radius reached 100 m five times the size of a cell the propagation of the fire was quasi stable during the steady phase the rate of spread is approximately 0 1994 m s 1 a bit smaller than that of 1d fire spread under the same conditions moreover the fire depth presented by the vertical distance between fire front and fire rear line remained constant at 44 4 m the order of magnitude of the simulated spread rate is consistent with the simulation results wang et al 2010 with the same vegetation type then under the same conditions by counting the number of cells in state s 5 the burning area could be evaluated in addition the burnt area is calculated by summing up all cells in states s 5 s 6 and s 7 at a given time the results are shown in fig 21 below and it can be seen that with time the burning area increases linearly and the burnt area presents an analogous parabolic rise which corresponds to the linear growth of the fire band radius due to the discrete counting in the calculation of area and the simulated fire depth close to the cell size fluctuation exists in the curve of the burning area this deviation is tolerable and the results are consistent with the observations collin et al 2010 4 2 3 wind and slope effects different from the simple ellipse shape the combination of fuel distribution wind and slope conditions can produce various fire shapes alexander 1985 as the svica model was examined above in zero wind and flat terrain conditions the influences of the wind and slope on the fire shape are discussed below in the same uniform fuel bed a uniform 20 ft wind field is applied in cellular space and the direction of the wind is heading true north with v 20 f t ranging from 0 m s 1 to 20 m s 1 the original fire shapes are recorded one simulated hour after the initial ignition and the results are shown in the figure below in fig 22 with the growth of wind intensity the fire front line firstly changed its shape from circle to ellipse and then the shape became ovoid if the wind intensity continues rising then the fire front line is in the shape of a teardrop in addition the fire bandwidth of the back fire is narrower than that of the head fire this result is consistent with the conclusion of green 1983 to study the fire shapes in different wind directions v 20 f t is fixed at 10 m s 1 and wind direction α w i n d evaluated by the angle from v 20 f t to n 1 took values as 0 15 30 and 45 the original simulated shapes are shown in fig 23 the result shows that the simulated fire shapes can be transformed isotropically by the wind at different directions the fire band is closely bilaterally symmetric about its long major axis shown in the figure above where the axis passes through the ignition point and parallel to v 20 f t as for the slope influences in the given fuel bed conditions and without wind the gradient vector of the terrain in each cell should remain the same the angle from the gradient vector to n 1 is defined as the slope heading angle α s l o p e and the slope angle in the gradient direction is named θ g firstly with α s l o p e 0 and θ g ranging from 0 to 25 one hour after being ignited the original fire shapes with different θ g are shown below referring to the application of empirical adjusted indexes k t and k w which are all calculated by equations in natural exponential form cf eqn 24 the evolution of fire shapes with the growth of θ g is simular to that of the wind intensity v 20 f t indicating the variation rules for the bandwidth similar to α w i n d the isotropical transform of fire shapes with different α s l o p e should be verified then θ g is fixed at 15 and α s l o p e took values of 0 15 30 and 45 the original fire shapes one hour after the single ignition are illustrated in the following figure fig 24 the results shown in fig 25 examined the isotropic effect mentioned above with different slope heading angles which is similar to that with different wind directions 4 2 4 multi point ignition in some cases the fire shapes could be concave and the forest fires could be generated by several ignition points where the conjunction of fire lines occurs to examine the application of the svica model in these cases with the same fuel bed in flat terrain fires derived from two ignition points are studied as for the simplest condition without wind two cells with a distance of 1000 m are ignited simultaneously and the evolution of fire shapes is recorded every 20 simulated minutes cf fig 26 as shown in fig 26 both fire bands grow with time and fuse as a unit when the two fire lines encounter each other the entire burnt fire shape is the union of the two shapes derived from two ignition points then under the same conditions a uniform wind field with v 20 f t 10 m s 1 and α w i n d 45 is added to test the conjuntion of the fire bands in no isotropic spread the result is shown in fig 27 the result shows that the fusion of the fire band functions properly with the existence of wind referring to the similarity between the impacts of wind and of slope on the fire spread behaviour the same results were obtained under no flat terrain conditions 4 3 fire spread in heterogeneous fuel bed conditions 4 3 1 synthetic forest test with a uniform fuel bed the simulations shown above validated the basic functionalities of the model and analysed preliminarily the effects of inner and outer factors on the spread rate and fire front shapes in this section based on the variable controlling approach with the input data listed in table 2 a series of synthetic heterogeneous fuel beds on flat terrain are constructed to perform sensitivity analysis on fuel bed parameters referring to the synthetic tests made by peterson et al 2009 in a simulation environment a flat square terrain of 4096 m in length was built with two forest areas cf fig 28 and the fuel bed properties in each area are uniform in particular the vegetation properties in area 1 are precisely the same compared with the data listed in table 2 then in each test step to study the fire front propagation in the fuel transition process one of the vegetation properties in area 2 is selected as studied among these parameters the initial fuel density ρ 0 average tree height h t average distance of trees d t initial relative fuel moisture h μ 0 residual ash density ρ e x t and porosity of trees k p are considered whose values are multiplied by 0 5 and 2 except for k p which is multiplied by 0 25 and 0 5 due to its value range while the other values remain unvaried a uniform 20 ft wind field is applied where the wind is heading true north and v 20 f t is fixed at 10 m s 1 for time saving all tests below are executed with η t i m e 10 and the time cost per frame t c o s t is set as 0 02 s the evolution of the fire shapes is recorded every 15 simulated minutes and the results are shown in fig 30 compared with the control test with a uniform fuel bed cf fig 29 by comparing the control test cf fig 29 with the series of synthetic forest tests shown in fig 30 the tendencies of the value changes of the fire spread rate and fire bandwidth in the variation of each specific vegetation parameter are studied and summarized in table 3 near the control vegetation data the initial fuel density ρ 0 average tree height h t and porosity of trees k p are more sensitive to changes in the fire spread rate than the average distance of trees d t and initial relative fuel moisture h μ 0 while the variation of residual ash density ρ e x t has no impact on the spread rate as for the fire bandwidth variation the sensitivity of the average tree height h t and porosity of trees k p is greater than that of the average distance of trees d t and initial fuel density ρ 0 while the initial relative fuel moisture h μ 0 and residual ash density ρ e x t have the least impacts on the fire bandwidth as a complex system variation of the parameters will lead to changes in both the spread rate of the fire front and the total burn time of one front cell which finally affect the width of the fire band with these rules of parameter sensitivity in the next section a case study could be performed and adjusted to match the real conditions 4 3 2 case study to show the practical application of the svica model the case of the wildfire on spetses island in 1990 was used based on the previous studies of alexandridis et al 2008 and russo et al 2014 the density and the type map of vegetation as well as the real burned area map of spetses island are recreated into discrete states and shown in figs 31 and 34 in addition the meteorological conditions on august 1 1990 are listed in table 4 table 5 fig 32 by using worldcomposer doldersum the elevation map of spetses island was obtained in the same area n 37 13 18 12 n 37 17 29 76 e 23 5 8 16 e 23 10 27 48 with the density and type map the original resolution of the elevation map is 128 128 corresponding to land of 7787 m 7787 m based on the bicubic interpolation the elevation map resolution is changed to 512 512 cf fig 34 to over cover the cellular space of the area with a resolution of 390 390 the cell size a is fixed at 20 m due to the lack of vegetation data of spetses island aleppo pine pinus halepensis mill is considered and with the statistics of the sample trees mitsopoulos and dimitrakopoulos 2007 the mapping rules of vegetation inputs are adjusted empirically and listed in the following table due to the lack of information on the real ignition location based on the inputs empirical or arbitrary listed above and the physical constants in table 2 a series of faster than real time η t i m e 10 single source fire simulations was performed the real time for each test was 1 1 h corresponding to a total simulated time of 11 h by comparing the simulated results with the real results cf fig 34 the most fitting ignition point was determined which is different from the ignition point reported by alexandridis et al 2008 the corresponding fire band shapes are recorded every simulated hour and the result is shown in fig 33 the actual forest fire burned a total of 5 9 k m 2 in 11 h while the simulated result was 6 09 k m 2 in addition the shape of the final burned area predicted by simulation basically matches the real area the result shows that the svica model could be applied for real case simulation where the heterogeneous fuel bed conditions are more complex and occasionally incomplete once the empirical inputs are adapted and adjusted to match the real fire data in the given area the real time crown fire behaviour simulation environment was set up and ready for further use 5 discussion and conclusions in a faster than real time η t i m e 10 simulation environment the numerical results of the svica model show good accuracy between the estimated spread rate and the simulated rate in stable propagation in addition the impacts of external factors on the spread rate along with the interaction between the fires and the dropped water match the assumptions and the physical equations mentioned above furthermore in the given 2d uniform fuel bed the distortion problem is studied in zero wind and flat terrain conditions the circular fire front shapes and the spread data show that with the growth of fire perimeters the accuracy of fire shapes increases and the prediction error is not divergent without any mathematical correction the svica model can relatively improve the distortion problem by introducing the spread vector algorithm in radiation model then together with the multi points ignition tests the deformation effects on fire bands in the presence of wind and slope are investigated in detail and the evolutions of fire shapes correspond with the field observations after validating the basic functionalities further applications of the svica model in heterogeneous fuel bed conditions are applied to realize the sensitivity analysis of the six vegetation parameters to the spread rate and to the fire bandwidth finally with limited input data the case study demonstrated that the model has strong practicability and great adaptability in heterogeneous conditions compared with other ca approaches the svica model could provide more fire properties and relatively lower the distortion in simulated fire shapes the cost of the improvements the quasi empirical equations and the spread vector algorithm relatively increase the calculation pressure by applying the dynamic cellular space and dynamic time step mechanisms mentioned above the real calculation time can be tolerated in the balance between the accuracy and the simulation speed a large number of burning cells can lead to the decline in simulation precision while maintaining the simulation speed otherwise the computational time of each step is augmented as the price of the accuracy hence as for the simulations realized by unity the computational time is not a problem instead the calculation precision is altogether the application and the time performance of the svica model are still limited by the total number of the burning cells during the simulation as mentioned above the fundamental purpose of the development of the svica model is to create a real time interactive crown fire simulation for human in loop training thus the fire behaviours including the spatio temporal evolution of the fire band as well as the interaction between fire fighting water and the fire band are primary targets that have been studied and modelled as the prediction of the fire front line during the disaster is not the purpose for which the svica model is designed software such as farsite and other fire models ghisu et al 2014 2015 are more appropriate and sufficient in this circumstance however as a quasi empirical model the vegetation inputs and initial conditions of the model are difficult to collect and should be adjusted with historical fire data which limits the application of the model the extendibility of the model is presented in two parts on the one hand accepting the fuel bed and fire model more complete and precise physical equations for the radiation and combustion process could be applied in the model framework to further increase the accuracy and reliability of the fire behaviour model on the other hand due to the physical framework of the svica model more physical properties of crown fire i e fire intensity flame height flame depth etc have been added to other ca models with this additional information the visualization of the simulated fire propagation may be feasible in the future the proposed model has been integrated in a real time helicopter fire fighting training system which is still under development and a preliminary preview of the system running is shown in fig 35 future studies include model verification with more comprehensive vegetation inputs and real crown fire data the determination of the atmosphere fire interaction using real time cfd solvers is also needed appendix a the derivation of function f d t h t is illustrated below by dividing s f and s t into finite square elements with the same size φ f t is approximately calculated by using numerical integration of eqn 15 for example when the element size is fixed as 0 4 m 0 4 m d t 5 m h t 5 m and the cell size a 20 m the value of φ f t is 0 414 variable controlling is applied to characterize the relation among φ f t h f d t h t and h f for example when the element size is 1 m 1 m d t is fixed respectively at 1 and 5 m and the variations of φ f t h f with h f for different h t are shown as follows fig a 1 variations of φ f t h f versus h f with different h t f fig a 1 as shown in figure a 1 with the growth of h f the value of φ f t h f rapidly rises at the beginning and then tends to a superior limit the limit value of φ f t h f taken at h f 100 m is used to estimate the maximum value of p f t considering the ranges of inputs used in section 4 d t is sampled from 1 to 10 m and h t ranges from 1 to 30 m and then the series of φ f t h f is calculated by the method above the function f d t h t in cubic polynomial form is calculated as a 1 a 1 a 2 d t a 3 d t h t a 4 d t h t 2 a 5 d t 2 a 6 d t 2 h t a 7 d t 3 a 8 h t a 9 h t 2 a 10 h t 3 where parameters a 1 to a 10 are calculated by the least square method using the sample data above the fitted parameters in four significant digits are listed in the table below table a 1 fitted parameters of the cubic polynomial table a 1 a 1 0 2165 a 6 0 001672 a 2 0 1573 a 7 0 0005139 a 3 0 07302 a 8 0 9028 a 4 0 0003591 a 9 0 008363 a 5 0 01936 a 10 0 001664 with the approximate function the fast computation of p f t is achieved to avoid calculating the double integral cf eqn 15 appendix b the different distortion patterns of ca algorithms are illustrated below a ca algorithm is defined by five properties karafyllidis and thanailakis 1997 1 spatial dimensions of the cellular space 2 size of each dimension 3 neighbourhood rules 4 definition of cell state 5 state transition rules or cell local rules according to the framework mentioned in section 2 property 1 and property 2 are included in the spatial distribution rules of cells in addition the cellular space is fixed as a bidimensional regular square lattice and moore neighbourhood is applied additionally the fuel bed is supposed to be uniform and there is no wind by variable control the distortion patterns are studied in the given cellular space with different definitions of states and local rules based on previous studies peterson et al 2009 trunfio et al 2011 avolio et al 2012 ghisu et al 2015 karafyllidis and thanailakis 1997 berjak and hearne 2002 encinas et al 2007a the local rules of ca algorithms could be roughly divided into two categories the first category is active accumulation suggesting that each unburned ignitable cell could be ignited when its own key state variable exceeds the threshold the key variable is calculated by accumulating the corresponding transition medium from the neighbour cells in each iteration the ca models berjak and hearne 2002 encinas et al 2007a alexandridis et al 2008 belong to this category in the svica model the accumulated transition medium is radiation heat the second category is obviously passive accumulation in this state transition mode it is the burning cell that accumulates the spread distances in eight directions the neighbour cell will be ignited once the corresponding spread distance exceeds the specific inter cell distance the ca models peterson et al 2009 trunfio et al 2011 avolio et al 2012 ghisu et al 2015 in this category are illustrated based on the expanding ellipse assumptions in the present study the reference spread direction rsd is defined in fig b 1 the distance between the fire front cell passed through by rsd and the ignition cell is the radius of the circle that represents the expected fire front shapes fig b 1 definition of the reference spread direction 2 fig b 1 as for the active accumulation category the simulated fire shape is octagonal the allocation proportion of the state transition medium between the diagonal neighbour and normal adjacent cells is the diagonal factor f d i a the distortion patterns with different diagonal factors are shown in fig b 2 fig b 2 distortion patterns with different diagonal factors 3 fig b 2 the proportion between the diagonal side length and the normal side length grows with the diagonal factor f d i a moreover the simulated fire front forms a regular octagon when f d i a equals 2 2 which shows that the spread trend in eight directions is uniform this finding is why the point model originally takes 2 2 as the value of the diagonal factor cf section 3 3 2 considering previous studies the diagonal factor in the model proposed by i karafyllidis et al karafyllidis and thanailakis 1997 equals 0 83 s g berjak et al karafyllidis and thanailakis 1997 changed the value of f d i a to be 0 17 2 and a h encinas et al karafyllidis and thanailakis 1997 set the value as 0 785 as for the passive accumulation category as the basis of the subsequent improvement studies peterson et al 2009 trunfio et al 2011 avolio et al 2012 ghisu et al 2015 the hfire model karafyllidis and thanailakis 1997 is applied in the given cellular space and the simulated fire shape is shown in fig b 3 unlike the fire front shapes derived from the active accumulation category the regular octagon is inscribed in the expected circle and the vertices of the octagon are aligned with the directions of the grid fig b 3 distortion pattern of hfire 4 fig b 3 altogether the two major distortion patterns for ca algorithms are summarized above more detailed comparisons between the svica model and other ca models are made in section 4 2 1 
