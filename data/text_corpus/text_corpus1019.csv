index,text
5095,the formation and development of fog and low stratus clouds fls depend on meteorological and land surface conditions and their interactions with each other while analyses of temporal and spatial patterns of fls in europe exist the interactions between fls determinants underlying them have not been studied explicitly and quantitatively at a continental scale yet in this study a state of the art machine learning technique is applied to model fls occurrence over continental europe using meteorological and land surface parameters from geostationary satellite and reanalysis data spatially explicit model units are created to test for spatial and seasonal differences in model performance and fls sensitivities to changes in predictors and effects of different data preprocessing procedures are evaluated the statistical models show good performance in predicting fls occurrence during validation with r2 0 9 especially in winter high pressure situations the predictive skill of the models seems to be dependent on data availability data preprocessing time period and geographic characteristics it is shown that atmospheric proxies are more important determinants of fls presence than surface characteristics in particular mean sea level pressure near surface wind speed and evapotranspiration are crucial together with fls occurrence on the previous day higher wind speeds higher land surface temperatures and higher evapotranspiration tend to be negatively related to fls spatial patterns of feature importance show the dominant influence of mean sea level pressure on fls occurrence throughout the central european domain when only high pressure situations are considered wind speed in the western study region and evapotranspiration in the eastern study region gain importance highlighting the influence of moisture advection on fls occurrence in the western parts of the central european domain this study shows that fls occurrence can be accurately modeled using machine learning techniques in large spatial domains based on meteorological and land surface predictors the statistical models used in this study provide a novel analysis tool for investigating empirical relationships in the fls land surface system and possibly infer processes keywords fog low stratus machine learning land surface atmosphere land surface interactions europe 1 introduction fog influences several anthropogenic and natural systems it affects traffic at land sea and in the air leigh et al 1998 pagowski et al 2004 it plays an important role in climate processes vautard et al 2009 egli et al 2017 and is often vital for ecological systems since it can supply water and nutrients to ecosystems bruijnzeel et al 2006 gottlieb et al 2019 mitchell et al 2020 while fog is generally defined as a suspension of water droplets leading to visibilities 1000 m glickman 2000 it can be further classified based on its formation mechanisms in central europe radiation fog is the most frequent fog type fuzzi et al 1992 gultepe et al 2007 and especially prevalent during winter cermak et al 2009 egli et al 2017 radiation fog forms due to radiative cooling at the surface or at the near surface layer of the atmosphere price 2019 under clear skies typically encountered during anticyclonic conditions gultepe et al 2007 the formation of radiation fog is positively influenced by low temperatures low wind speeds and a stable boundary layer cuxart and jiménez 2012 pérez díaz et al 2017 price 2019 fog is a particular case of a low stratus cloud positioned directly at the earth surface from the satellite perspective radiation fog and other low stratus clouds are frequently treated together as a single category fog and low stratus fls cermak and bendix 2011 in addition to the contribution of atmospheric processes van oldenborgh et al 2010 fls occurrence is also heavily linked to surface atmosphere exchanges bergot et al 2005 these exchanges are classified here as two pathways of opposite directions 1 fog and low stratus influence on the land surface especially vegetation and 2 land surface influences on the formation properties and distribution of fls pathway 1 is mainly expressed via the supply of water through fog and by influencing the amount of nutrients reaching the vegetation this has been investigated in various ecosystems around the world such as coastal deserts eckardt et al 2013 ebner et al 2011 roth nebelsick et al 2012 mitchell et al 2020 lehnert et al 2018 tropical montane cloud forests berry et al 2015 and in the californian redwood forests dawson 1998 furthermore fog can influence the productivity in cultivated crops by modifying radiation e g leading to a higher water use efficiency in strawberries on foggy days baguskas et al 2018 for this study pathway 2 the influences of the land surface on fls formation properties and distribution is in the focus generally topography and landform can modify the influence of atmospheric dynamics on fls occurrence van oldenborgh et al 2010 advected fls can accumulate in steep windward slopes ball and tzanopoulos 2020 and lower advected fog densities are found in leeward locations ball and tzanopoulos 2020 torregrosa et al 2016 the formation and persistence of radiation fog can also be influenced by topographically induced drainage flows and turbulence price 2019 furthermore the growing phase of radiation fog is controlled by advection slightly above the fog layer which is strongly linked to the topography cuxart and jiménez 2012 besides topography turbulent mixing soil temperature and soil moisture fluxes influence fog formation and dissipation maronga and bosveld 2017 low wind speeds are necessary to generate turbulence for fls development klemm and wrzesinsky 2007 whereas modestly stronger wind above the nocturnal boundary layer can inhibit the development of radiation fog bergot and lestringant 2019 furthermore wind direction can also influence fls occurrence but is location specific blas et al 2002 klemm and wrzesinsky 2007 wrzesinsky and klemm 2000 fls occurrence is also strongly impacted by the availability of aerosols that can act as cloud condensation nuclei ccn ramanathan et al 2001 biovolatile organic compounds bvoc s emitted by vegetation can form secondary organic aerosols soa and act as ccn and thereby favor cloud formation pöschl et al 2010 shrivastava et al 2017 improvements in air quality have been observed to lead to a reduction in fog klemm and lin 2016 gray et al 2019 furthermore the land cover type influences fls with lower fls frequency over urban areas compared to rural areas e g in milan bendix 1994 in munich sachweh and koepke 1995 sachweh and koepke 1997 in delhi gautam and singh 2018 in multiple cities in the netherlands izett et al 2019 or california williams et al 2015 likely in parts due to the urban heat island effect the general patterns of fls occurrence in europe have been investigated using ground based observations and satellite data in the last few years egli et al 2017 found fls occurrence to be highest in winter with higher fls occurrence in the northeast of europe than in the mediterranean region using a hybrid approach with ground truth data and data from the spinning enhanced visible and infrared imager seviri on board meteosat second generation msg egli et al 2018 derived a 10 year climatology of ground fog showing high fog occurrences in mountainous areas in spring and summer and high values in lowlands and plains in winter egli et al 2018 cermak 2018 investigated fog and low cloud frequency using lidar light detection and ranging aboard calipso cloud aerosol lidar and pathfinder satellite observations data and found similar patterns with a general decrease of fls frequency from north to south and high values in the baltic sea regions fls processes take place across a large range of different scales from small scales of aerosol activation 10 7 m to synoptic scales 106 m while investigations about temporal and spatial fls patterns over europe exist as well as many insights on specific local and non local processes determining fls formation and development no explicit satellite based investigation of the determinants of fls development spanning multiple years and a large spatially coherent region exists to date the aim of this study is to quantitatively determine the relative importance of several land cover and meteorological parameters for fls occurrence in a large central european domain this is done by using a machine learning technique investigating its predictive performance concerning fls occurrence as well as model sensitivities the high occurrence frequencies of fls especially in central europe during winter provide a good database in conducting this analysis in this paper we would like to unravel the question what the main drivers of large scale spatial and temporal fls patterns in central europe are and how these drivers influence fls patterns 2 data and methods 2 1 study area the study is conducted in a large domain in continental europe from 48 to 53 n and 5 to 15 e including parts of the countries austria belarus belgium czech republic france germany luxembourg netherlands poland slovakia and ukraine see fig 1 this continental study area was chosen to allow for a focus on continental situations unimpaired by the effects of local circulations such as land sea and mountain breeze systems thus large mountain ranges such as the alps and areas close to the coast were excluded nonetheless small local topographic differences and smaller topography induced circulations still exist in the presented study area the effects of such local scale modulations on fls occurrence and fls land surface interactions are reduced by subdividing the study area into a number of smaller units in this study two model unit sizes are tested 10 10 and 15 15 seviri pixels which are further described below 2 2 data the fls product used in this study presented by egli et al 2017 is based on geostationary satellite data from the meteosat second generation platforms meteosat 8 9 and 10 the seviri system on board of the satellites scans the full hemisphere every 15 min the sub satellite resolution is 3 km in 11 spectral bands with an additional high resolution visible channel with 1 km resolution the fls product is a modification of the satellite based operational fog observation scheme sofos by cermak 2006 and covers the years 2006 to 2015 to produce a data set of daily fls occurrence the original 15 min product is locally averaged into fls hours day 1 which serves as the target quantity in this study the mean fls distribution for the chosen study area over the complete time period can be seen in fig 1 to describe the physical state of the land surface and its possible influence on fls distribution several land surface features are included in this study based on products from the eumetsat satellite application facility on land surface analysis lsa saf trigo et al 2011 all of these products are created using data from meteosat seviri and thus have the same spatial resolution as the fls product to describe temperature and moisture availability of the surface land surface temperature lst and evapotranspiration et are included additional land surface characteristics relevant for energy and moisture fluxes are described by the fraction of vegetation cover fvc and the bi hemispherical albedo for the total shortwave range alb to describe atmospheric conditions era5 reanalysis data from the european centre for medium range weather forecasts ecmwf is used era5 is the follow up of era interim dee et al 2011 and provides higher spatial resolution 0 25 hersbach 2016 which is especially useful for investigating land atmosphere interactions in this study mean sea level pressure msp and the u and v component of wind at 10 meters are included the u and v component of the wind are combined to calculate the near surface wind speed ws as a measure for the persistence of meteorological conditions that can lead to fls the fls value of the previous day flsprev is included additional information on the height above sea level geographical position or land cover type were tested but are not included in the final model as they did not lead to marked improvements in model performance and equally to a location id could lead to overfitting meyer et al 2018 meyer et al 2019 meyer et al 2019 further assume that using predictor variables that describe the spatial location prevent the model from making reliable spatial predictions as such the final models are based on 7 predictors alb et flsprev fvc lst msp ws to predict the duration of fls cover 2 3 methods interactions between the atmosphere and the land surface are often highly dimensional with machine learning non linear and complex multivariate problems can be handled lary et al 2016 olden et al 2008 especially for problems where theoretical knowledge is limited but the amount of available observational data is large machine learning can be an ideal tool for addressing these problems lary et al 2016 in this study a model was constructed using the machine learning technique gradient boosting regression trees gbrt aiming at predicting fls hours per day on the basis of the meteorological and surface predictors described above gbrts use an ensemble of weak base learners decision trees which follow the negative gradient of the loss function friedman 2001 natekin and knoll 2013 they are flexible when using categorical and numerical data and have large predictive power being able to represent nonlinear relationships between predictors and the predictand hastie et al 2001 furthermore one of the key strengths of this machine learning technique is its high level of interpretability since a number of interpretation methods exist for gbrts elith et al 2008 these properties have been exploited in recent studies to analyze complex atmospheric systems with gbrts fuchs et al 2018 stirnberg et al 2020 for this study the gbrt implementation of the scikit learn library in python was used pedregosa et al 2011 2 3 1 data preprocessing in a first step fig 2 i the era5 data sets are rescaled to the seviri pixel resolution of 3 3 km at nadir of the fls data set using a nearest neighbor approach as described above wind speed at 10 m height is calculated using the u and v components of the wind at 10 m height furthermore daily averages are calculated for fls lst et msp and ws fvc and alb are already in the form of daily means daily averages are used as the focus lies on the day to day variability of fls occurrence poor quality data and data with high error values e g due to adjacent cloud covered areas is excluded using the following data quality control steps for fvc only data that is free of snow and water and with reliable input ranges for the fvc algorithm is included as well as data with an absolute error smaller than 0 2 for alb data with an absolute error greater than 0 2 is excluded for et data where input variables for the et algorithm have insufficient quality or are missing is excluded for lst cloud filled pixels or pixels partly contaminated by clouds snow or ice are excluded since some cloud covered or cloud adjacent pixels with either implausible high or low surface temperatures are not caught by the quality flag they are removed by setting the valid lst range depending on the month for the full year the valid data range is set to 60 c to 60 c this range is then adjusted depending on the time of year the maximum is adjusted to 40 c from october to march and the minimum to 50 c from march to september with this plausible lst data at the upper or lower ends of the temperature range can be kept in each season the data excluded in the quality control as described above are marked as invalid in each data set any such flagging leads to the exclusion of the data point as the model only considers data points with valid data in all data sets since seasonal influence on fls as well as on numerous other parameters is large the models are run with two seasonality settings 1 the seasonality is kept in the data and 2 the seasonal cycle is subtracted from the data these two seasonality settings are used to investigate to what extent model performance and sensitivities are dependent on seasonal effects when removing the seasonality only the day to day variability is modeled whereas keeping the seasonality in the data also models the seasonal interactions of fls and its predictors here the seasonality is defined as the mean over the investigated time period for every pixel for every day of the year and then smoothing this time series using a savitzky golay filter savitzky and golay 1964 the seasonality is then subtracted from the data sets of each specific feature 2 3 2 model construction the study area is subdivided into spatially explicit model units in which data is treated summarily at the seviri resolution for training testing and sensitivity analyses compare fig 2ii two spatial sizes of the model units are tested with model units containing either 10 10 or 15 15 seviri pixels due to the high latitudinal position and the rather shallow satellite viewing angle of 45 in the study area one seviri pixel corresponds to about a width of 4 km and a height of 7 km eumetsat 2013 for the 10 10 model unit this leads to a mean model unit area of roughly 2800 km2 and 6300 km2 for the 15 15 unit respectively this model unit set up is chosen to account for regional differences in the study area while still choosing a unit size where some variability in land cover is present furthermore this set up allows for the evaluation of spatial differences in model performance and sensitivities thus the 15 15 pixel units contain more data for training and testing whereas the 10 10 units provide smaller and thus more homogeneous model units to account for seasonal differences seasonal model runs are conducted as well as full year runs these seasonal runs are winter december january and february djf spring march april and may mam summer june july and august jja and fall september october and november son in the considered time periods full year or seasons separate models are trained using either all data or only the 20 highest pressure situations in each model unit to focus on situations where fls is favored see section 1 the pressure threshold is calculated from the distribution of pressure values for every model unit and model time period separately in each model unit data is split into separate training and test data sets containing 70 and 30 of the data respectively to ensure that training and test data contain comparable fls distributions the test training split is coupled with a stratification of the fls data set in general the number of available data points varies from model unit to model unit e g due to cloud contamination e g for lst and fvc data but can be higher than 400 000 full year all pressure situations 15 15 pixel model unit size but also as low as 3800 seasonal model with pressure filter in a 10 10 pixel model unit considering different seasonality and pressure filters model unit sizes and modeling time periods seasons or full year 30 different model settings are investigated in this study 2 3 3 hyperparameter tuning hyperparameter tuning is conducted using grid search with a small range of possible values to avoid overfitting e g by using only low values for the maximum depth table 1 since grid search is computationally expensive it is conducted in every 5th model unit over a range of feature combinations and model settings to investigate the influence on the hyperparameters the hyperparameters proposed in the grid search are similar over model units feature combinations and model settings and the most common hyperparameters are used as the final settings 2 3 4 validation and sensitivity analysis to test the influence of different model settings on model performance and sensitivities the validation fig 2iii and sensitivity analysis fig 2iv are conducted for all model settings described above model performance is evaluated using the coefficient of determination r2 and the mean squared error mse between observed and predicted fls in each model unit the validation results are then evaluated concerning the differences between settings for each unit separately and over all units potential overfitting is analyzed by comparing r2 and mse for the test and training data sets correlations between variables are quantified using the spearman s rho coefficient to account for effects of outliers and non linearity in the investigated correlation to investigate the most important features for model performance the permutation feature importance is calculated for all model units the permutation feature importance measures the increase in prediction error after permuting randomly shuffling one feature breiman 2001 this breaks the relationship between the feature and the target thus indicating how much the model depends on that feature strobl et al 2007 molnar 2019 compared to the often used impurity based feature importance gini importance the permutation importance is not as strongly biased towards variables with many categories and the continuous variable strobl et al 2007 thus the term feature importance relates to permutation importance in this paper the mean feature importance is calculated over all model units but is also investigated for each model unit separately to improve comparability the permutation feature importance is scaled so the sum of permutation importance over all features equals 1 while the feature importance only displays the relative importance of a feature the sign and nonlinearity of the predictand response relative to changes of each predictor variable can be analyzed using the partial dependence in the context of this paper the partial dependencies quantify the average change of the predicted fls values relative to either one or two features one variable partial dependence and two variable partial dependence while accounting for the average effects of all other variables elith et al 2008 friedman 2001 fuchs et al 2018 the partial dependence is calculated by gridding the investigated feature and calculating the corresponding average fls prediction while the complement features are varied over their distribution molnar 2019 3 results 3 1 model performance as a first overview of model performance gbrt performance during training and validation with independent data is analyzed for all different model unit sizes as well as seasonality and pressure settings the results of this validation are shown in fig 3 r2 values are generally higher when filtering for high pressure situations but are similar for runs containing seasonality versus runs that use deseasonalized data the mean r2 values of the model units in the 15 15 runs tend to be lower than in the 10 10 runs the highest mean r2 averaged over all model units is found in the pressure filtered deseasonalized 10 10 spring run 0 94 but is similar high 0 93 in other runs e g in the pressure filtered 15 15 winter run with seasonality a clear seasonal pattern in model performance exists with skill generally lowest in summer and highest in winter albeit this seasonal pattern is weakened when only high pressure situations are considered the difference in r2 between the model runs with all pressure values fig 3a and c versus those considering only high pressure situations fig 3b and d is therefore lowest in winter the full year models feature the lowest r2 of runs without a pressure filter mean r2 0 6 0 7 but also reach values 0 9 in the pressure filtered runs the regional variability of model performance expressed as the spread in r2 values is highest in winter and for the full year run and lowest in spring and fall the training r2 is significantly p 0 01 higher than the test r2 indicating some level of overfitting in the statistical models depending on the season the training r2 is on average slightly 4 8 higher over all model units and smaller than that in the 15 15 and full year models still the high test r2 shows the ability of the models to generalize relationships between the predictors and fls patterns learned during training the difference between test and train r2 is higher in the 10 10 model units and lowest in the full year runs the model predictions do not feature a noticeable bias mean bias 0 0 median bias 0 3 mse patterns are similar to r2 with higher mse values thus worse performance in the 15 15 runs and a larger difference of mse between seasons than between model runs with different seasonality subtraction settings fig 10 this means that model performance is more dependent on the modeled season than on seasonality subtraction settings as the mse is dependent on the absolute values mse patterns are influenced by the seasonal fls distribution thus leading to high mse values in winter and fall and lower mse in spring and summer to investigate the reasons for overfitting the difference between training and test r2 and mse is correlated with the number of data points available for training and testing for the correlation with the absolute difference between training and test r2 the spearman s rho is approximately 0 5 p 0 01 especially in the full year and winter run for the mse correlation the spearman s rho is 0 5 p 0 01 in the full year spring and fall runs thus overfitting is partly controlled by the number of available data points and models generalize better when more data points are available for training and testing due to the good overall performance in the 10 10 model units and the higher spatial resolution only the results of the 10 10 model units are presented in the following sections where not specifically pointed out results of the 15 15 model units are similar though fig 4 shows spatial patterns of r2 relative to the domain average r2 for two different model settings full year models including seasonality with fig 4a and without fig 4b pressure filter this highlights model units that either have distinctly better or worse performance than the overall mean additionally in fig 4c a topographic map is shown for the study area together with two scatterplots of the r2 deviation with the mean height per model unit fig 4d for values west and east of 10 e separately the corresponding spearman s rho p value and r2 for the complete correlations negative and positive r2 deviation values together are added in the top right corner of the fig 4d plot the domain average r2 for the model run including all pressure situations is 0 71 for the model run using only high pressure situations it is 0 89 while the spatial patterns of skill are similar for both model settings the models using only high pressure situations feature a lower deviation from the domain average r2 generally in the north eastern part of the model region e g in poland and the central czech republic and the south eastern and north eastern parts of germany the r2 in the model units shows a positive deviation from the domain average in the western part of the model region western germany as well as in parts of the south western part of the model region northern parts of the vosges the upper rhine valley black forest the r2 is lower than the domain average this is also the case for the mountain ranges surrounding the czech republic as well as in the south eastern part of the model region high tatras the relationship between r2 deviation and topography is visible in a the visual relationship between the two e g compare fig 4a and c and b the correlation of the two fig 4d with a spearman s rho of 0 36 the latter is especially strong for values east of 10 e a correlation of a and b with the distance to the coastline produced a spearman s rho close to 0 with a p value 0 05 small differences between pressure settings are visible in the north eastern and south western part of the model region as well as the border triangle between germany poland and the czech republic at 15 e the apparent spatial patterns of skill are similar during all seasons and independent of skill measure r2 or mse and training or test data set 3 2 feature importance in fig 5 the domain average feature importance is shown for all seasons and specific model settings as stacked barplots the left hand panel fig 5a shows results for the model run that contains seasonality while the right hand panel shows the results of the deseasonalized model fig 5b in these subplots the darker colored bars on the left display the results of the model runs containing all pressure situations while the lighter colored bars on the right show the results of the model using only high pressure situations since results in the 15 15 model unit runs are similar only 10 10 model unit results are shown and described here in general clear similarities but also some distinct differences in mean feature importance are apparent msp flsprev ws and et are among the most important features in all model runs during winter and summer msp and ws are the most important features while in the spring fall and full year run et and flsprev gain importance when filtering for high pressure situations et becomes more important while the importance of msp decreases this is especially apparent in the spring fall and full year runs lst reaches its highest feature importance in summer but overall has little importance for model performance alb and fvc have little importance in all model runs however this is slightly increased when filtering for high pressure situations in summer differences between the model runs containing seasonality and the deseasonalized model runs are present in the exact values of feature importance but general patterns are similar the largest differences in feature importance are apparent between the different seasons and the pressure exclusion runs model unit size and subtraction of seasonality only produce small differences in the mean permutation feature importance over all model units 3 3 spatial patterns of relevant features in fig 6 the most important feature per model unit of the full year run is shown for four different model settings in general the spatial patterns of the most important feature show clear differences between the model runs using all pressure situations fig 6a and c versus those using the 20 highest pressure values fig 6b and d when all pressure situations are used msp is the most important feature in most model units this pattern is especially prevalent in the deseasonalized model run here msp is the most important feature in all model units except for some units in the eastern part of the study area where et is the most important feature in the model run that contains seasonality fig 6a et is the most important feature in numerous model units east of 10 e in parts of eastern germany most of the czech republic and parts of poland in three model units in the czech republic flsprev is the most important feature as expected in the high pressure filtered model runs msp is much less important instead et is the most important feature in large parts of the eastern study area other than et msp flsprev and ws are the most important features in numerous model units across both seasonality settings fig 6b and d msp is the dominant feature in most parts of western germany and eastern france and in some units in the czech republic and poland flsprev is dominant in the north western part of the czech republic western germany as well as parts of france and poland ws is the most important feature in some scattered model units of the model run including seasonality in the deseasonalized model run ws is dominant in more model units mostly in the western and the north western part of the study area the seasonal patterns of the most important feature fig 7 are similar to the patterns observed in the full year run in the model runs using all pressure values fig 7a msp is dominant over all seasons with only some exceptions in winter and fall in high pressure situations though seasonal differences are more pronounced fig 7b in winter flsprev is dominant in the western part of the study area germany and parts of france and ws is dominant in the eastern part of the study area msp is the most important feature in between ws and flsprev in central and north western parts of the study area other than these three et and lst are the most important features in some scattered model units as well in spring the most important features are flsprev in south western and et in north eastern parts of the study area other than that msp is dominant in most of the study region with some scattered model units where lst and ws are the most dominant features in summer msp is the most important feature in most model units with ws being dominant on the border of germany and france in poland in the czech republic and in some scattered model units in central germany apart from that only a few model units are dominated by flsprev and lst in fall msp is dominant in the western part of the study area and et is dominant in the eastern part of the study area east of 10 e ws is dominant in parts of eastern germany and poland and flsprev is the most important feature in some scattered model units in germany poland and the czech republic 3 4 one variable partial dependence in fig 8 the predictand responses relative to changes in all predictors are displayed as partial dependencies see section 2 3 4 for all considered time periods since the partial dependencies are calculated for each model unit separately the mean and the interquartile ranges of the partial dependencies of all model units are presented here additionally the distribution of values of each predictor is plotted below the corresponding partial dependence as a qualitative assessment of the representativeness of the obtained partial dependencies the partial dependencies presented here are from the 10 10 model unit run where seasonality and all pressure values are included since the partial dependencies are similar over model unit sizes seasonality and pressure exclusion settings the effect of the high pressure filter on the partial dependence of msp is shown in the bottom right panel all other partial dependencies of this run are similar to the ones shown the partial dependence can be understood as the deviation from the mean of the predictand here fls occurrence that can be attributed to a specific predictor thus a positive partial dependence at a given feature value indicates a positive influence on modeled fls occurrence similarly a negative partial dependence at a given feature value indicates a negative influence on modeled fls occurrence the magnitude of the partial dependence determines the magnitude of the influence a partial dependence close to zero indicates very little or no influence on modeled fls occurrence at the given feature value as a sensitivity measure the range of the mean partial dependence over all model units for the full year run is given in the text together with the corresponding slope direction of the partial dependence curve this provides a measure of influence on modeled fls occurrence for each feature over the corresponding value distribution with a greater sensitivity measure indicating a large positive or negative influence on modeled fls occurrence seasonal differences of sensitivity are shortly described the partial dependence of msp fig 8a is nonlinear following a clear pattern in low pressure situations 980 1005 hpa the partial dependence is low however not many cases fall into this value range in situations with 1005 hpa msp 1030 hpa where most of the cases occur the partial dependence increases substantially reaching its maximum at 1030 hpa or even higher pressure situations during winter before it decreases again for pressure situations around 1040 hpa however only a few cases most of them in winter exist with such high pressure of 1040 hpa the full year sensitivity of msp is 3 64 and the seasonal sensitivity is highest in winter and fall 3 63 and lowest in summer 1 73 fls on the previous day fig 8b shows the most pronounced partial dependence pattern over all seasons and the full year run with increasing values over the complete value distribution the minimum partial dependence is thus reached for small flsprev values and the maximum partial dependence for high flsprev values the sensitivity of flsprev also shows the strong influence of flsprev on modeled fls occurrence and lies at 7 04 for the full year run the flsprev sensitivity reaches its seasonal maximum in fall 7 94 and its minimum in spring 4 95 the pattern of partial dependence of fls on ws fig 8c is strongly dependent on season and the distribution of values at low wind speeds 0 2 m s 1 the partial dependence decreases in winter fall and the full year run in spring and summer it remains more or less constant at such low ws in summer it increases slowly in spring and the full year run it increases around 8 m s 1 and for the winter and fall run it remains more or less constant still it has to be considered that any ws values greater than 6 m s 1 are rare and the corresponding partial dependence pattern may not be as reliable and due to the low occurrence frequency not that relevant the full year sensitivity of ws is compared to msp and flsprev relatively low at 1 33 but reaches higher values in winter 4 75 the seasonal minimum of ws sensitivity is reached in spring 1 65 the partial dependencies of the et and lst are also both strongly dependent on the investigated season in summer the partial dependence of fls on et fig 8d is more or less constant at a partial dependence of 0 predicted fls h day 1 over the complete value distribution in all other seasons and the full year run the partial dependence decreases at et values from 0 0 to 0 1 mm h 1 in spring and the full year run it then slightly increases again at 0 4 mm h 1 due to the low distribution of et values greater than 0 3 mm h 1 the corresponding partial dependence values might be less reliable the full year sensitivity for et is at 2 90 the seasonal maximum of sensitivity is found in fall 4 09 and the minimum is found in summer 0 94 the partial dependence of fls on lst fig 8e is highest when lsts are below the freezing point reaching a maximum at around 10 c at higher lsts the partial dependence of fls on lst decreases in summer the lst value range and also these partial dependence patterns are shifted to higher temperatures the full year sensitivity of lst is similar to the et sensitivity at 2 93 the seasonal maximum of lst sensitivity is found in fall 3 06 the seasonal minimum is found in winter 1 85 similar to their low feature importance alb fig 8f and fvc fig 8g both have small partial dependence values the partial dependence of alb slightly increases over the complete value distribution of all seasons and the full year run the partial dependence of fvc is low and constant over all seasons interestingly the full year sensitivity of alb reaches 2 56 a similar high value to the sensitivity of et and lst the seasonal maximum is found in winter 2 19 and the minimum is found in summer 1 24 the full year sensitivity of fvc is at 0 87 and thus the lowest of all features the seasonal fvc sensitivity is highest in winter 0 73 and lowest in fall 0 19 in the pressure filtered model run all partial dependencies show a similar pattern except for the partial dependencies of msp fig 8h this is due to the reduced value range of the msp values thus only the decrease of the partial dependencies starting from around 1035 hpa is visible the msp sensitivity changes direction in the pressure filtered model and lies at 4 33 for the full year run and is strongest in winter 4 03 and lowest in spring 0 74 all in all the response in modeled fls occurrence is distinctive for the features flsprev et lst ws and msp with the latter showing a clear dependency on the application of the pressure filter for changes in fvc and alb the response in modeled fls occurrence is small these partial dependence patterns confirm the feature importance patterns discussed above with flsprev msp and et being important features for model performance 3 5 two variable partial dependence while the isolated impacts of individual features can be investigated with the one variable partial dependencies two variable partial dependence plots can show the combined effects of two variables on the response of modeled fls occurrence allowing for the analysis of possible co dependencies based on the one variable partial dependencies described above six combinations of the most important features are presented in fig 9 these are msp ws a flsprev msp b flsprev et c et msp d flsprev ws e and et lst f in fig 9 the two variable partial dependencies of the full year run using all pressure situations including the seasonality are shown similar to the one variable partial dependencies the exact data preprocessing pertaining to seasonality treatment or pressure filtering does not substantially influence the two variable partial dependencies to outline characteristics of the distribution of the considered features and as an assessment for the representativeness of the results two distribution borders are marked in the plots below inside the outer dashed line 99 of the data can be found inside the inner dashed line 75 of the data is present additionally on the equivalent axes of the feature combinations the 1st 50th and 99th percentiles are marked as short lines the two variable partial dependence of msp and ws is displayed in fig 9a the values of the partial dependence are low over the complete value range of both features a diagonal pattern where low wind speeds and high pressure values lead to higher predicted fls values is indicated the combined effects of flsprev and msp in fig 9b are stronger with flsprev being the more dominant variable still a weak combined effect of higher msp values and higher flsprev values leading to higher predicted fls is visible in fig 9c the combined effects of flsprev and et are visible while low flsprev values in combination with high et values have a negative effect on predicted fls a positive effect on predicted fls is visible for high flsprev and low et values the two variable partial dependence of et and msp fig 9d also shows a diagonal pattern of the combined effect of high msp values with low et values leading to higher predicted fls the combined effects of flsprev and ws fig 9e are similar to flsprev and msp flsprev dominates the combined effects with stronger influence of ws when flsprev values are higher indicated by the more diagonal patterns of the two variable partial dependence at flsprev values larger than 5 h day 1 for the two variable partial dependencies of et and lst fig 9f low et values with low lst values lead to high predicted fls values in general the seasonal differences of the two variable partial dependence are governed by the seasonal differences in fls occurrence as well as the range of values of the features since fls occurrence is higher in winter and fall the magnitude of the two variable partial dependence is higher in winter and fall furthermore the combined effects of msp and ws are stronger in fall and winter thus confirm the combination of high msp low ws leading to higher predicted fls indicated in the full year plot in summer and spring two variable partial dependencies are low considering the patterns seen in the one variable and two variable partial dependence plots flsprev shows the most pronounced and clear effect on modeled fls occurrence and dominates the combined effects in the two variable partial dependence plots this is especially interesting since msp is the most important feature in most model runs compare fig 5 4 discussion 4 1 model performance in general the statistical models are capable of accurately predicting fls using meteorological and land cover predictors while subtracting seasonality does not influence model performance substantially filtering for high pressure situations boosts model performance significantly filtering for high pressure situations also leads to a higher relative frequency of radiation fog situation which helps the model learn the relevant patterns and thus improves its performance performance is best in winter and worst in summer these patterns might both be due to more frequent high pressure situations in winter e g bartoszek 2017 which can also be seen by significantly higher msp values in winter compared to the other seasons winter mean msp being 5 hpa higher in the era5 data used in this study additionally filtering for high pressure values makes it easier for the model to generalize and predict fls in summer and when using all pressure values fls occurrence may be due to local processes more frequently such as orographic lifting egli et al 2019 and not specifically tied to large scale weather systems this is in line with the results shown in van oldenborgh et al 2010 who found that atmospheric dynamics contribute up to 40 to the variability of fog occurrences in winter whereas in summer the contribution of circulations on fog occurrence is more dependent on local factors the spatial differences of r2 show lower model performance in units with high topographic variability such as parts of the mountain ranges surrounding the czech republic and the high tatras furthermore the deviation from the mean r2 fig 4 and mse per model unit is greater in areas with greater height above sea level and with greater standard deviation of height in that model unit the correlation between the mean height above sea level and deviation from the mean r2 per model unit is especially prevalent east of 10 e with a stronger negative deviation from the mean r2 at larger heights compare fig 4d this correlation is strongest in spring and fall the decreasing performance in these either high altitude or topographically highly variable model units could be due to more pronounced small scale local processes that the model is not capable of reproducing this could be also due to the missing terrain information in the selected predictors e g according to cuxart and jiménez 2012 the advection flows generated by the topography are crucial for the growing phase of radiation fog as stated in the methods using static geolocation variables such as height above sea level or geographic position can lead to overfitting and might be useful in training but not in making spatial predictions as stated in meyer et al 2018 and meyer et al 2019 terrain information as height above sea level is left out for this reason besides the missing terrain information the low resolution of the era5 data might lead to worse performance in topographically highly variable model units in these units the era5 data might be less accurate in general due to grid averaging here the quality of the era5 may be improved by using a different interpolation technique like kriging or bicubic interpolation during data preprocessing however such a change is not expected to markedly change the results generally the model performance in the eastern parts of the study area is high likely due to rather low variability in terrain and a large influence of large scale circulation patterns on fog occurrence leading to mostly radiation or advection fog these processes are well captured by the chosen predictors and therefore well represented in the models interestingly the high pressure filter can also lead to lower performance in some model units in winter such as near the harz and in parts of poland this is not the case at any other time of year though two things might be responsible for this pattern first in the high pressure situations in winter available data for training and testing has been reduced strongly thus false predictions have a stronger influence on the r2 of the model unit when less predictions are made in general in model units with more available data points false predictions have less influence on the model unit r2 secondly the lower performance in these units may indicate that in these regions fog occurrence during winter may be caused by processes that are not inherently captured by the set of predictors for example terrain induced processes may play a role as stated above such as on the mt brocken at 1142 m asl which is immersed in clouds about 50 of the time acker et al 2002 a thorough investigation of the influence of the fls distribution on model performance shows that in model units with higher fls occurrence model performance is better the relationship of model performance and mean fls occurrence for each model unit over all seasons is strong spearman s rho 0 8 and significant p 0 01 especially in the model runs using all pressure situations this confirms the previously stated relationship of better performance in winter and worse performance in summer these findings underline the influence of data availability and distribution on model performance overfitting is apparent in all models with larger differences between test and training performance in the 10 10 units than in the 15 15 units this is likely due to the higher number of available data points in the 15 15 units for training and testing shown with the decreasing difference between training and test performance with increasing number of data available in the model unit more data thus makes it possible to learn more fls situations and the subsequent behavior of the predictor variables furthermore in a larger domain a model needs to be able to represent rather general fls patterns instead of specific local fls patterns a highly localized model might be also prone to overfitting this could be investigated in future studies by varying the model unit size while keeping the number of available training points constant the different model unit sizes show the conflict between sufficient data for training and testing and small enough regional models to model smaller scale regional fls patterns this conflict between data availability and spatial resolution is frequently encountered in observational studies conducting hyperparameter tuning in all model units for all model unit sizes in combination with regularization would lead to higher computation times but could reduce the observed overfitting 4 2 fls drivers and their temporal and spatial patterns generally fog formation and presence depend on multiple factors such as the synoptic situation smaller scale atmospheric circulations and local orographic factors pérez díaz et al 2017 the important role of the synoptic situation is underscored by the results of this study with the high feature importance of msp and ws which are used as proxies for atmospheric dynamics in high pressure situations often related to anticyclonic conditions an inversion can develop during nighttime which is a prerequisite for the formation of radiation fog the results obtained from the sensitivity analysis indicate that lower wind speed together with high pressure lead to a stronger stability and thus persisting fls this interplay of msp and ws is also visible in fig 9 the influence of low wind speeds on turbulence generation during fls development is not visible here as such phenomena occur below the spatial resolution of the era5 data wind direction has not been included in this study since creating a general fls land surface model with a low number of predictors and minimum amount of rescaling has been a priority in this study to first create a general model framework which can be further developed based on its first results in the future for example more detailed treatments of wind speed and direction in different atmospheric layers will be investigated in further studies in the investigated study area especially humid air masses from the west are important for fog occurrence blas et al 2002 wrzesinsky and klemm 2000 klemm and wrzesinsky 2007 the importance of atmospheric dynamics and air masses is also visible by the higher frequency of model units with ws and msp as the most important feature in the western parts of the study region which possibly indicates a decreasing relevance of westerly moist air masses with increasing continentality as noted above wind direction should thus be added as a predictor in further studies the positive relationship of fls cover with flsprev is most likely due to persisting fls over several days due to persisting atmospheric conditions additionally feedback processes between fls and the surface exist in the presence of fls surface heating due to solar radiation is reduced during daytime which leads to lower near surface temperatures in the subsequent night and a reduction of the difference between air and dew point temperature this relationship might be stronger in basins and valleys where fls tends to persist longer due to lower wind speeds inside the fls layer and inversions or cold pool situations that can last for several days cuxart and jiménez 2012 scherrer and appenzeller 2014 to investigate processes and sensitivities in larger river valleys model units could be delineated specifically considering topographic information in further studies in these larger model units shap shapley additive explanations values introduced by lundberg and lee 2017 could be investigated which allow for the investigation of individual predictions leading to a global understanding of the model lundberg et al 2020 providing a tool to distinguish and individually analyze different fls regimes two land surface based predictors that are closely related to each other due to the dependence of the saturation vapor pressure on temperature described by the clausius clapeyron equation are lst and et this means that higher land surface temperatures lead to higher evapotranspiration with the latter being constrained by moisture availability especially in summer but also by solar radiation as well as the vapor pressure deficit concerning fls processes one would expect lst to have a negative relationship with fls occurrence and et to have a positive influence on fls occurrence due to the moisture input into the boundary layer however in this study both lst and et show a negative relationship with modeled fls the latter one likely confounded by temperature but also winds fls occurrence might be lower in high et situations due to the larger vapor pressure deficit and thus drier air generally et is strongly influenced by the variability of atmospheric conditions teuling et al 2010 seneviratne et al 2012 e g with anticyclonic circulation patterns leading to high et values in poland bogawski and bednorz 2016 at the scales considered in this study the influence of atmospheric conditions on et fls patterns is likely larger than the effects of moisture input via et on fls formation in general temperature and humidity during fls formation are connected via the process of condensation cooling leads to a rise in relative humidity a reduction of the atmospheric saturation vapor pressure and once saturation is reached condensation of water vapor to available cloud condensation nuclei and fog formation bergot and lestringant 2019 steeneveld and de bode 2018 this effect is especially prevalent in winter where fog formation is favored by a higher frequency of low temperatures together with high relative humidity conditions wrzesinsky and klemm 2000 hunová et al 2018 list relative humidity and air pollutants as the most important features when modeling fog in the czech republic as the presented statistical model presents a general working ground a proxy for ccn has not been included yet but will be in further studies the negative influence of higher lst on fls cover in urban areas williams et al 2015 izett et al 2019 can be suspected here but is not visible in the results due to the size of the model units still compared to lst et plays a stronger role in this study especially in spring and fall where the combined effects of low temperatures favorable for fls and a higher soil moisture leading to moderate evapotranspiration are prevalent this is mainly visible in the eastern part of the study area where et is the most important feature in most model units in spring and fall in these units the moisture input by maritime westerly air masses might be limited which could lead to a higher importance of local moisture sources according to van oldenborgh et al 2010 fog during summer in the netherlands only forms when enough moisture is present with higher summer fog occurrences when moisture input in the preceding early summer or spring months has been larger here in high pressure situations day to day variations in et are more important for predicting fls occurrence than day to day variations in msp which is visible in the feature importance of et and msp in the deseasonalized model run in this study the influence of radiative properties of the surface on fls occurrence is only indicated by the small positive influence of increasing alb values on fls occurrence still the feature importance and partial dependence of alb is rather low and does not feature a clear pattern the small effect of alb on fls occurrence might also be due to the multiple directions in which alb might influence fls occurrence while surfaces with high alb absorb less radiation during daytime and thus might lead to a lower air temperature and higher relative humidity above these surfaces during nighttime when radiation fog usually forms darker surfaces might provide more moisture initially such as water bodies or forests furthermore fls reduces the incoming solar radiation thus masking some expected radiative effects of alb on fls occurrence in further studies the effects of radiation on fls occurrence could be further investigated by adding radiation fluxes as predictors to the model similar to alb the influence of fvc on fls occurrence is also not clearly visible in the results obtained from the study duynkerke 1991 lists vegetation as a driver for fls occurrence but this might not be visible here due to the spatial resolution and the stronger influence of meteorological drivers that mask such influences of the land surface and cover still with the exclusion of low pressure situations and subsequent decreasing the influence of atmospheric dynamics can help the investigation of the influence of land surface parameters on fls distribution filtering for specific weather situations as in egli et al 2019 could decrease the variability and influence of the considered atmospheric predictors and may help isolate the influence of land surface parameters on fls distribution under specific conditions as already stated certainly not all factors influencing fls distribution are considered in this study in part this study is limited by the spatial resolution of the data sets used as local and regional morphology are important drivers for fls occurrence e g blas et al 2002 furthermore the landform turbulent boundary layer mixing above cloud humidity and winds soil conductivity availability of ccn and the distance to the coast are listed as influential fls drivers e g blas et al 2002 blas et al 2010 steeneveld and de bode 2018 hunová et al 2018 in further studies the presented baseline model can be expanded by integrating these predictors to investigate their influence on model performance and sensitivities 5 conclusion in this study a machine learning technique gradient boosting regression trees was used to predict observed fls occurrence over continental europe using meteorological and land surface parameters as predictors to analyze spatial patterns of model skill and sensitivities spatially explicit 10 10 and 15 15 seviri pixel model units were created covering the entire study area additionally models were applied for different model setups and data preprocessing procedures the models were then applied to the entire full year data as well as in different seasons in general the statistical models were able to accurately predict fls occurrence in all regions of the study area with r2 values between 0 6 and 0 94 during validation with independent data model skill was observed to be highest in winter and lowest in the full year run model performance increases when only high pressure situations are considered and when smaller 10 10 seviri pixels model units are used some overfitting is apparent in all models and depends on model unit size with larger modeling domains featuring less overfitting using deseasonalized data only has a small effect on model performance analyses of feature importance reveal that features pertaining to atmospheric dynamics are more relevant to predict fls than surface characteristics the most important features for fls prediction are msp ws fls on the previous day et and to some extent lst albedo and fvc are less important in the statistical models when only considering high pressure situations msp becomes less important while et and ws gain importance the latter especially in spring and fall spatial patterns of the most important feature show the dominance of msp in most of the model units when using all pressure situations when only high pressure situations are considered et is dominant in central and eastern parts of the study area while ws flsprev and msp are dominant in western parts of the study area a sensitivity analysis was conducted with the statistical models using the partial dependence technique while there are some differences in partial dependencies when excluding low pressure situations seasonality and model unit size settings do not seem to have a marked influence a positive influence of flsprev and msp and a negative influence of et lst and ws on modeled fls were found these patterns are also confirmed in analyses of two variable partial dependencies which were used to study the combined effects of msp ws et lst and flsprev this analysis showed that especially the combination of high flsprev high msp and low ws values leads to high predicted fls values this is also the case for low lst and low et values considering the modeling framework there are several limitations that should be noted first of all using spatially explicit model units reduces the available number of data points for training and testing thus the available data puts a constraint on the spatial resolution at which such an analysis can be conducted still there is potential for future improvements creating larger model units could provide more data that could also be used for validation and reduce the risk of overfitting grid search or a different methodology for hyperparameter tuning could be applied in all units separately and with fewer model units less computing time would be consumed while the generalization of hyperparameters is useful in this model set up conducting a thorough grid search in all model units would lead to a more complete picture of ideal hyperparameters for the model but still may have little influence on model skill and overfitting it has to be noted that fls is influenced by a large number of parameters some of which are not represented in the model such as topography humidity wind direction soil moisture and aerosol loading additionally fls formation is also influenced by the state of higher atmospheric layers for example through moisture advection and mixing while the model set up presented here provides a general working ground these features may be integrated in more complex statistical frameworks in the future furthermore fls processes take place from small scales of aerosol activation 10 7 m to synoptic scales 106 m accurately addressing the issues concerning scales will thus be a critical aspect going forward specifically as processes that are not important on one scale might be crucial on a different scale to gain further insights into the relationship between fls and the land surface fls properties such as cloud top height and liquid water path can also be analyzed with the presented modeling framework while the model units can be varied in size they can also be grouped into areas of similar topography or land cover which could help in further analyzing fls land cover dependencies credit authorship contribution statement eva pauli conceptualization formal analysis investigation methodology visualization writing original draft writing review editing hendrik andersen methodology writing review editing jörg bendix writing review editing jan cermak conceptualization methodology writing review editing sebastian egli resources writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements lsa saf data were obtained from the lsa saf data catalogue https landsaf ipma pt en data catalogue last access 09 april 2019 era5 data were obtained from the copernicus climate data store https cds climate copernicus eu cdsapp dataset reanalysis era5 single levels tab overview last access 02 april 2020 eva pauli has been financially supported by the graduate funding from the german states the valuable comments of two anonymous reviewers and the editor helped improve the original manuscript appendix a mean squared error mse of all models 
5095,the formation and development of fog and low stratus clouds fls depend on meteorological and land surface conditions and their interactions with each other while analyses of temporal and spatial patterns of fls in europe exist the interactions between fls determinants underlying them have not been studied explicitly and quantitatively at a continental scale yet in this study a state of the art machine learning technique is applied to model fls occurrence over continental europe using meteorological and land surface parameters from geostationary satellite and reanalysis data spatially explicit model units are created to test for spatial and seasonal differences in model performance and fls sensitivities to changes in predictors and effects of different data preprocessing procedures are evaluated the statistical models show good performance in predicting fls occurrence during validation with r2 0 9 especially in winter high pressure situations the predictive skill of the models seems to be dependent on data availability data preprocessing time period and geographic characteristics it is shown that atmospheric proxies are more important determinants of fls presence than surface characteristics in particular mean sea level pressure near surface wind speed and evapotranspiration are crucial together with fls occurrence on the previous day higher wind speeds higher land surface temperatures and higher evapotranspiration tend to be negatively related to fls spatial patterns of feature importance show the dominant influence of mean sea level pressure on fls occurrence throughout the central european domain when only high pressure situations are considered wind speed in the western study region and evapotranspiration in the eastern study region gain importance highlighting the influence of moisture advection on fls occurrence in the western parts of the central european domain this study shows that fls occurrence can be accurately modeled using machine learning techniques in large spatial domains based on meteorological and land surface predictors the statistical models used in this study provide a novel analysis tool for investigating empirical relationships in the fls land surface system and possibly infer processes keywords fog low stratus machine learning land surface atmosphere land surface interactions europe 1 introduction fog influences several anthropogenic and natural systems it affects traffic at land sea and in the air leigh et al 1998 pagowski et al 2004 it plays an important role in climate processes vautard et al 2009 egli et al 2017 and is often vital for ecological systems since it can supply water and nutrients to ecosystems bruijnzeel et al 2006 gottlieb et al 2019 mitchell et al 2020 while fog is generally defined as a suspension of water droplets leading to visibilities 1000 m glickman 2000 it can be further classified based on its formation mechanisms in central europe radiation fog is the most frequent fog type fuzzi et al 1992 gultepe et al 2007 and especially prevalent during winter cermak et al 2009 egli et al 2017 radiation fog forms due to radiative cooling at the surface or at the near surface layer of the atmosphere price 2019 under clear skies typically encountered during anticyclonic conditions gultepe et al 2007 the formation of radiation fog is positively influenced by low temperatures low wind speeds and a stable boundary layer cuxart and jiménez 2012 pérez díaz et al 2017 price 2019 fog is a particular case of a low stratus cloud positioned directly at the earth surface from the satellite perspective radiation fog and other low stratus clouds are frequently treated together as a single category fog and low stratus fls cermak and bendix 2011 in addition to the contribution of atmospheric processes van oldenborgh et al 2010 fls occurrence is also heavily linked to surface atmosphere exchanges bergot et al 2005 these exchanges are classified here as two pathways of opposite directions 1 fog and low stratus influence on the land surface especially vegetation and 2 land surface influences on the formation properties and distribution of fls pathway 1 is mainly expressed via the supply of water through fog and by influencing the amount of nutrients reaching the vegetation this has been investigated in various ecosystems around the world such as coastal deserts eckardt et al 2013 ebner et al 2011 roth nebelsick et al 2012 mitchell et al 2020 lehnert et al 2018 tropical montane cloud forests berry et al 2015 and in the californian redwood forests dawson 1998 furthermore fog can influence the productivity in cultivated crops by modifying radiation e g leading to a higher water use efficiency in strawberries on foggy days baguskas et al 2018 for this study pathway 2 the influences of the land surface on fls formation properties and distribution is in the focus generally topography and landform can modify the influence of atmospheric dynamics on fls occurrence van oldenborgh et al 2010 advected fls can accumulate in steep windward slopes ball and tzanopoulos 2020 and lower advected fog densities are found in leeward locations ball and tzanopoulos 2020 torregrosa et al 2016 the formation and persistence of radiation fog can also be influenced by topographically induced drainage flows and turbulence price 2019 furthermore the growing phase of radiation fog is controlled by advection slightly above the fog layer which is strongly linked to the topography cuxart and jiménez 2012 besides topography turbulent mixing soil temperature and soil moisture fluxes influence fog formation and dissipation maronga and bosveld 2017 low wind speeds are necessary to generate turbulence for fls development klemm and wrzesinsky 2007 whereas modestly stronger wind above the nocturnal boundary layer can inhibit the development of radiation fog bergot and lestringant 2019 furthermore wind direction can also influence fls occurrence but is location specific blas et al 2002 klemm and wrzesinsky 2007 wrzesinsky and klemm 2000 fls occurrence is also strongly impacted by the availability of aerosols that can act as cloud condensation nuclei ccn ramanathan et al 2001 biovolatile organic compounds bvoc s emitted by vegetation can form secondary organic aerosols soa and act as ccn and thereby favor cloud formation pöschl et al 2010 shrivastava et al 2017 improvements in air quality have been observed to lead to a reduction in fog klemm and lin 2016 gray et al 2019 furthermore the land cover type influences fls with lower fls frequency over urban areas compared to rural areas e g in milan bendix 1994 in munich sachweh and koepke 1995 sachweh and koepke 1997 in delhi gautam and singh 2018 in multiple cities in the netherlands izett et al 2019 or california williams et al 2015 likely in parts due to the urban heat island effect the general patterns of fls occurrence in europe have been investigated using ground based observations and satellite data in the last few years egli et al 2017 found fls occurrence to be highest in winter with higher fls occurrence in the northeast of europe than in the mediterranean region using a hybrid approach with ground truth data and data from the spinning enhanced visible and infrared imager seviri on board meteosat second generation msg egli et al 2018 derived a 10 year climatology of ground fog showing high fog occurrences in mountainous areas in spring and summer and high values in lowlands and plains in winter egli et al 2018 cermak 2018 investigated fog and low cloud frequency using lidar light detection and ranging aboard calipso cloud aerosol lidar and pathfinder satellite observations data and found similar patterns with a general decrease of fls frequency from north to south and high values in the baltic sea regions fls processes take place across a large range of different scales from small scales of aerosol activation 10 7 m to synoptic scales 106 m while investigations about temporal and spatial fls patterns over europe exist as well as many insights on specific local and non local processes determining fls formation and development no explicit satellite based investigation of the determinants of fls development spanning multiple years and a large spatially coherent region exists to date the aim of this study is to quantitatively determine the relative importance of several land cover and meteorological parameters for fls occurrence in a large central european domain this is done by using a machine learning technique investigating its predictive performance concerning fls occurrence as well as model sensitivities the high occurrence frequencies of fls especially in central europe during winter provide a good database in conducting this analysis in this paper we would like to unravel the question what the main drivers of large scale spatial and temporal fls patterns in central europe are and how these drivers influence fls patterns 2 data and methods 2 1 study area the study is conducted in a large domain in continental europe from 48 to 53 n and 5 to 15 e including parts of the countries austria belarus belgium czech republic france germany luxembourg netherlands poland slovakia and ukraine see fig 1 this continental study area was chosen to allow for a focus on continental situations unimpaired by the effects of local circulations such as land sea and mountain breeze systems thus large mountain ranges such as the alps and areas close to the coast were excluded nonetheless small local topographic differences and smaller topography induced circulations still exist in the presented study area the effects of such local scale modulations on fls occurrence and fls land surface interactions are reduced by subdividing the study area into a number of smaller units in this study two model unit sizes are tested 10 10 and 15 15 seviri pixels which are further described below 2 2 data the fls product used in this study presented by egli et al 2017 is based on geostationary satellite data from the meteosat second generation platforms meteosat 8 9 and 10 the seviri system on board of the satellites scans the full hemisphere every 15 min the sub satellite resolution is 3 km in 11 spectral bands with an additional high resolution visible channel with 1 km resolution the fls product is a modification of the satellite based operational fog observation scheme sofos by cermak 2006 and covers the years 2006 to 2015 to produce a data set of daily fls occurrence the original 15 min product is locally averaged into fls hours day 1 which serves as the target quantity in this study the mean fls distribution for the chosen study area over the complete time period can be seen in fig 1 to describe the physical state of the land surface and its possible influence on fls distribution several land surface features are included in this study based on products from the eumetsat satellite application facility on land surface analysis lsa saf trigo et al 2011 all of these products are created using data from meteosat seviri and thus have the same spatial resolution as the fls product to describe temperature and moisture availability of the surface land surface temperature lst and evapotranspiration et are included additional land surface characteristics relevant for energy and moisture fluxes are described by the fraction of vegetation cover fvc and the bi hemispherical albedo for the total shortwave range alb to describe atmospheric conditions era5 reanalysis data from the european centre for medium range weather forecasts ecmwf is used era5 is the follow up of era interim dee et al 2011 and provides higher spatial resolution 0 25 hersbach 2016 which is especially useful for investigating land atmosphere interactions in this study mean sea level pressure msp and the u and v component of wind at 10 meters are included the u and v component of the wind are combined to calculate the near surface wind speed ws as a measure for the persistence of meteorological conditions that can lead to fls the fls value of the previous day flsprev is included additional information on the height above sea level geographical position or land cover type were tested but are not included in the final model as they did not lead to marked improvements in model performance and equally to a location id could lead to overfitting meyer et al 2018 meyer et al 2019 meyer et al 2019 further assume that using predictor variables that describe the spatial location prevent the model from making reliable spatial predictions as such the final models are based on 7 predictors alb et flsprev fvc lst msp ws to predict the duration of fls cover 2 3 methods interactions between the atmosphere and the land surface are often highly dimensional with machine learning non linear and complex multivariate problems can be handled lary et al 2016 olden et al 2008 especially for problems where theoretical knowledge is limited but the amount of available observational data is large machine learning can be an ideal tool for addressing these problems lary et al 2016 in this study a model was constructed using the machine learning technique gradient boosting regression trees gbrt aiming at predicting fls hours per day on the basis of the meteorological and surface predictors described above gbrts use an ensemble of weak base learners decision trees which follow the negative gradient of the loss function friedman 2001 natekin and knoll 2013 they are flexible when using categorical and numerical data and have large predictive power being able to represent nonlinear relationships between predictors and the predictand hastie et al 2001 furthermore one of the key strengths of this machine learning technique is its high level of interpretability since a number of interpretation methods exist for gbrts elith et al 2008 these properties have been exploited in recent studies to analyze complex atmospheric systems with gbrts fuchs et al 2018 stirnberg et al 2020 for this study the gbrt implementation of the scikit learn library in python was used pedregosa et al 2011 2 3 1 data preprocessing in a first step fig 2 i the era5 data sets are rescaled to the seviri pixel resolution of 3 3 km at nadir of the fls data set using a nearest neighbor approach as described above wind speed at 10 m height is calculated using the u and v components of the wind at 10 m height furthermore daily averages are calculated for fls lst et msp and ws fvc and alb are already in the form of daily means daily averages are used as the focus lies on the day to day variability of fls occurrence poor quality data and data with high error values e g due to adjacent cloud covered areas is excluded using the following data quality control steps for fvc only data that is free of snow and water and with reliable input ranges for the fvc algorithm is included as well as data with an absolute error smaller than 0 2 for alb data with an absolute error greater than 0 2 is excluded for et data where input variables for the et algorithm have insufficient quality or are missing is excluded for lst cloud filled pixels or pixels partly contaminated by clouds snow or ice are excluded since some cloud covered or cloud adjacent pixels with either implausible high or low surface temperatures are not caught by the quality flag they are removed by setting the valid lst range depending on the month for the full year the valid data range is set to 60 c to 60 c this range is then adjusted depending on the time of year the maximum is adjusted to 40 c from october to march and the minimum to 50 c from march to september with this plausible lst data at the upper or lower ends of the temperature range can be kept in each season the data excluded in the quality control as described above are marked as invalid in each data set any such flagging leads to the exclusion of the data point as the model only considers data points with valid data in all data sets since seasonal influence on fls as well as on numerous other parameters is large the models are run with two seasonality settings 1 the seasonality is kept in the data and 2 the seasonal cycle is subtracted from the data these two seasonality settings are used to investigate to what extent model performance and sensitivities are dependent on seasonal effects when removing the seasonality only the day to day variability is modeled whereas keeping the seasonality in the data also models the seasonal interactions of fls and its predictors here the seasonality is defined as the mean over the investigated time period for every pixel for every day of the year and then smoothing this time series using a savitzky golay filter savitzky and golay 1964 the seasonality is then subtracted from the data sets of each specific feature 2 3 2 model construction the study area is subdivided into spatially explicit model units in which data is treated summarily at the seviri resolution for training testing and sensitivity analyses compare fig 2ii two spatial sizes of the model units are tested with model units containing either 10 10 or 15 15 seviri pixels due to the high latitudinal position and the rather shallow satellite viewing angle of 45 in the study area one seviri pixel corresponds to about a width of 4 km and a height of 7 km eumetsat 2013 for the 10 10 model unit this leads to a mean model unit area of roughly 2800 km2 and 6300 km2 for the 15 15 unit respectively this model unit set up is chosen to account for regional differences in the study area while still choosing a unit size where some variability in land cover is present furthermore this set up allows for the evaluation of spatial differences in model performance and sensitivities thus the 15 15 pixel units contain more data for training and testing whereas the 10 10 units provide smaller and thus more homogeneous model units to account for seasonal differences seasonal model runs are conducted as well as full year runs these seasonal runs are winter december january and february djf spring march april and may mam summer june july and august jja and fall september october and november son in the considered time periods full year or seasons separate models are trained using either all data or only the 20 highest pressure situations in each model unit to focus on situations where fls is favored see section 1 the pressure threshold is calculated from the distribution of pressure values for every model unit and model time period separately in each model unit data is split into separate training and test data sets containing 70 and 30 of the data respectively to ensure that training and test data contain comparable fls distributions the test training split is coupled with a stratification of the fls data set in general the number of available data points varies from model unit to model unit e g due to cloud contamination e g for lst and fvc data but can be higher than 400 000 full year all pressure situations 15 15 pixel model unit size but also as low as 3800 seasonal model with pressure filter in a 10 10 pixel model unit considering different seasonality and pressure filters model unit sizes and modeling time periods seasons or full year 30 different model settings are investigated in this study 2 3 3 hyperparameter tuning hyperparameter tuning is conducted using grid search with a small range of possible values to avoid overfitting e g by using only low values for the maximum depth table 1 since grid search is computationally expensive it is conducted in every 5th model unit over a range of feature combinations and model settings to investigate the influence on the hyperparameters the hyperparameters proposed in the grid search are similar over model units feature combinations and model settings and the most common hyperparameters are used as the final settings 2 3 4 validation and sensitivity analysis to test the influence of different model settings on model performance and sensitivities the validation fig 2iii and sensitivity analysis fig 2iv are conducted for all model settings described above model performance is evaluated using the coefficient of determination r2 and the mean squared error mse between observed and predicted fls in each model unit the validation results are then evaluated concerning the differences between settings for each unit separately and over all units potential overfitting is analyzed by comparing r2 and mse for the test and training data sets correlations between variables are quantified using the spearman s rho coefficient to account for effects of outliers and non linearity in the investigated correlation to investigate the most important features for model performance the permutation feature importance is calculated for all model units the permutation feature importance measures the increase in prediction error after permuting randomly shuffling one feature breiman 2001 this breaks the relationship between the feature and the target thus indicating how much the model depends on that feature strobl et al 2007 molnar 2019 compared to the often used impurity based feature importance gini importance the permutation importance is not as strongly biased towards variables with many categories and the continuous variable strobl et al 2007 thus the term feature importance relates to permutation importance in this paper the mean feature importance is calculated over all model units but is also investigated for each model unit separately to improve comparability the permutation feature importance is scaled so the sum of permutation importance over all features equals 1 while the feature importance only displays the relative importance of a feature the sign and nonlinearity of the predictand response relative to changes of each predictor variable can be analyzed using the partial dependence in the context of this paper the partial dependencies quantify the average change of the predicted fls values relative to either one or two features one variable partial dependence and two variable partial dependence while accounting for the average effects of all other variables elith et al 2008 friedman 2001 fuchs et al 2018 the partial dependence is calculated by gridding the investigated feature and calculating the corresponding average fls prediction while the complement features are varied over their distribution molnar 2019 3 results 3 1 model performance as a first overview of model performance gbrt performance during training and validation with independent data is analyzed for all different model unit sizes as well as seasonality and pressure settings the results of this validation are shown in fig 3 r2 values are generally higher when filtering for high pressure situations but are similar for runs containing seasonality versus runs that use deseasonalized data the mean r2 values of the model units in the 15 15 runs tend to be lower than in the 10 10 runs the highest mean r2 averaged over all model units is found in the pressure filtered deseasonalized 10 10 spring run 0 94 but is similar high 0 93 in other runs e g in the pressure filtered 15 15 winter run with seasonality a clear seasonal pattern in model performance exists with skill generally lowest in summer and highest in winter albeit this seasonal pattern is weakened when only high pressure situations are considered the difference in r2 between the model runs with all pressure values fig 3a and c versus those considering only high pressure situations fig 3b and d is therefore lowest in winter the full year models feature the lowest r2 of runs without a pressure filter mean r2 0 6 0 7 but also reach values 0 9 in the pressure filtered runs the regional variability of model performance expressed as the spread in r2 values is highest in winter and for the full year run and lowest in spring and fall the training r2 is significantly p 0 01 higher than the test r2 indicating some level of overfitting in the statistical models depending on the season the training r2 is on average slightly 4 8 higher over all model units and smaller than that in the 15 15 and full year models still the high test r2 shows the ability of the models to generalize relationships between the predictors and fls patterns learned during training the difference between test and train r2 is higher in the 10 10 model units and lowest in the full year runs the model predictions do not feature a noticeable bias mean bias 0 0 median bias 0 3 mse patterns are similar to r2 with higher mse values thus worse performance in the 15 15 runs and a larger difference of mse between seasons than between model runs with different seasonality subtraction settings fig 10 this means that model performance is more dependent on the modeled season than on seasonality subtraction settings as the mse is dependent on the absolute values mse patterns are influenced by the seasonal fls distribution thus leading to high mse values in winter and fall and lower mse in spring and summer to investigate the reasons for overfitting the difference between training and test r2 and mse is correlated with the number of data points available for training and testing for the correlation with the absolute difference between training and test r2 the spearman s rho is approximately 0 5 p 0 01 especially in the full year and winter run for the mse correlation the spearman s rho is 0 5 p 0 01 in the full year spring and fall runs thus overfitting is partly controlled by the number of available data points and models generalize better when more data points are available for training and testing due to the good overall performance in the 10 10 model units and the higher spatial resolution only the results of the 10 10 model units are presented in the following sections where not specifically pointed out results of the 15 15 model units are similar though fig 4 shows spatial patterns of r2 relative to the domain average r2 for two different model settings full year models including seasonality with fig 4a and without fig 4b pressure filter this highlights model units that either have distinctly better or worse performance than the overall mean additionally in fig 4c a topographic map is shown for the study area together with two scatterplots of the r2 deviation with the mean height per model unit fig 4d for values west and east of 10 e separately the corresponding spearman s rho p value and r2 for the complete correlations negative and positive r2 deviation values together are added in the top right corner of the fig 4d plot the domain average r2 for the model run including all pressure situations is 0 71 for the model run using only high pressure situations it is 0 89 while the spatial patterns of skill are similar for both model settings the models using only high pressure situations feature a lower deviation from the domain average r2 generally in the north eastern part of the model region e g in poland and the central czech republic and the south eastern and north eastern parts of germany the r2 in the model units shows a positive deviation from the domain average in the western part of the model region western germany as well as in parts of the south western part of the model region northern parts of the vosges the upper rhine valley black forest the r2 is lower than the domain average this is also the case for the mountain ranges surrounding the czech republic as well as in the south eastern part of the model region high tatras the relationship between r2 deviation and topography is visible in a the visual relationship between the two e g compare fig 4a and c and b the correlation of the two fig 4d with a spearman s rho of 0 36 the latter is especially strong for values east of 10 e a correlation of a and b with the distance to the coastline produced a spearman s rho close to 0 with a p value 0 05 small differences between pressure settings are visible in the north eastern and south western part of the model region as well as the border triangle between germany poland and the czech republic at 15 e the apparent spatial patterns of skill are similar during all seasons and independent of skill measure r2 or mse and training or test data set 3 2 feature importance in fig 5 the domain average feature importance is shown for all seasons and specific model settings as stacked barplots the left hand panel fig 5a shows results for the model run that contains seasonality while the right hand panel shows the results of the deseasonalized model fig 5b in these subplots the darker colored bars on the left display the results of the model runs containing all pressure situations while the lighter colored bars on the right show the results of the model using only high pressure situations since results in the 15 15 model unit runs are similar only 10 10 model unit results are shown and described here in general clear similarities but also some distinct differences in mean feature importance are apparent msp flsprev ws and et are among the most important features in all model runs during winter and summer msp and ws are the most important features while in the spring fall and full year run et and flsprev gain importance when filtering for high pressure situations et becomes more important while the importance of msp decreases this is especially apparent in the spring fall and full year runs lst reaches its highest feature importance in summer but overall has little importance for model performance alb and fvc have little importance in all model runs however this is slightly increased when filtering for high pressure situations in summer differences between the model runs containing seasonality and the deseasonalized model runs are present in the exact values of feature importance but general patterns are similar the largest differences in feature importance are apparent between the different seasons and the pressure exclusion runs model unit size and subtraction of seasonality only produce small differences in the mean permutation feature importance over all model units 3 3 spatial patterns of relevant features in fig 6 the most important feature per model unit of the full year run is shown for four different model settings in general the spatial patterns of the most important feature show clear differences between the model runs using all pressure situations fig 6a and c versus those using the 20 highest pressure values fig 6b and d when all pressure situations are used msp is the most important feature in most model units this pattern is especially prevalent in the deseasonalized model run here msp is the most important feature in all model units except for some units in the eastern part of the study area where et is the most important feature in the model run that contains seasonality fig 6a et is the most important feature in numerous model units east of 10 e in parts of eastern germany most of the czech republic and parts of poland in three model units in the czech republic flsprev is the most important feature as expected in the high pressure filtered model runs msp is much less important instead et is the most important feature in large parts of the eastern study area other than et msp flsprev and ws are the most important features in numerous model units across both seasonality settings fig 6b and d msp is the dominant feature in most parts of western germany and eastern france and in some units in the czech republic and poland flsprev is dominant in the north western part of the czech republic western germany as well as parts of france and poland ws is the most important feature in some scattered model units of the model run including seasonality in the deseasonalized model run ws is dominant in more model units mostly in the western and the north western part of the study area the seasonal patterns of the most important feature fig 7 are similar to the patterns observed in the full year run in the model runs using all pressure values fig 7a msp is dominant over all seasons with only some exceptions in winter and fall in high pressure situations though seasonal differences are more pronounced fig 7b in winter flsprev is dominant in the western part of the study area germany and parts of france and ws is dominant in the eastern part of the study area msp is the most important feature in between ws and flsprev in central and north western parts of the study area other than these three et and lst are the most important features in some scattered model units as well in spring the most important features are flsprev in south western and et in north eastern parts of the study area other than that msp is dominant in most of the study region with some scattered model units where lst and ws are the most dominant features in summer msp is the most important feature in most model units with ws being dominant on the border of germany and france in poland in the czech republic and in some scattered model units in central germany apart from that only a few model units are dominated by flsprev and lst in fall msp is dominant in the western part of the study area and et is dominant in the eastern part of the study area east of 10 e ws is dominant in parts of eastern germany and poland and flsprev is the most important feature in some scattered model units in germany poland and the czech republic 3 4 one variable partial dependence in fig 8 the predictand responses relative to changes in all predictors are displayed as partial dependencies see section 2 3 4 for all considered time periods since the partial dependencies are calculated for each model unit separately the mean and the interquartile ranges of the partial dependencies of all model units are presented here additionally the distribution of values of each predictor is plotted below the corresponding partial dependence as a qualitative assessment of the representativeness of the obtained partial dependencies the partial dependencies presented here are from the 10 10 model unit run where seasonality and all pressure values are included since the partial dependencies are similar over model unit sizes seasonality and pressure exclusion settings the effect of the high pressure filter on the partial dependence of msp is shown in the bottom right panel all other partial dependencies of this run are similar to the ones shown the partial dependence can be understood as the deviation from the mean of the predictand here fls occurrence that can be attributed to a specific predictor thus a positive partial dependence at a given feature value indicates a positive influence on modeled fls occurrence similarly a negative partial dependence at a given feature value indicates a negative influence on modeled fls occurrence the magnitude of the partial dependence determines the magnitude of the influence a partial dependence close to zero indicates very little or no influence on modeled fls occurrence at the given feature value as a sensitivity measure the range of the mean partial dependence over all model units for the full year run is given in the text together with the corresponding slope direction of the partial dependence curve this provides a measure of influence on modeled fls occurrence for each feature over the corresponding value distribution with a greater sensitivity measure indicating a large positive or negative influence on modeled fls occurrence seasonal differences of sensitivity are shortly described the partial dependence of msp fig 8a is nonlinear following a clear pattern in low pressure situations 980 1005 hpa the partial dependence is low however not many cases fall into this value range in situations with 1005 hpa msp 1030 hpa where most of the cases occur the partial dependence increases substantially reaching its maximum at 1030 hpa or even higher pressure situations during winter before it decreases again for pressure situations around 1040 hpa however only a few cases most of them in winter exist with such high pressure of 1040 hpa the full year sensitivity of msp is 3 64 and the seasonal sensitivity is highest in winter and fall 3 63 and lowest in summer 1 73 fls on the previous day fig 8b shows the most pronounced partial dependence pattern over all seasons and the full year run with increasing values over the complete value distribution the minimum partial dependence is thus reached for small flsprev values and the maximum partial dependence for high flsprev values the sensitivity of flsprev also shows the strong influence of flsprev on modeled fls occurrence and lies at 7 04 for the full year run the flsprev sensitivity reaches its seasonal maximum in fall 7 94 and its minimum in spring 4 95 the pattern of partial dependence of fls on ws fig 8c is strongly dependent on season and the distribution of values at low wind speeds 0 2 m s 1 the partial dependence decreases in winter fall and the full year run in spring and summer it remains more or less constant at such low ws in summer it increases slowly in spring and the full year run it increases around 8 m s 1 and for the winter and fall run it remains more or less constant still it has to be considered that any ws values greater than 6 m s 1 are rare and the corresponding partial dependence pattern may not be as reliable and due to the low occurrence frequency not that relevant the full year sensitivity of ws is compared to msp and flsprev relatively low at 1 33 but reaches higher values in winter 4 75 the seasonal minimum of ws sensitivity is reached in spring 1 65 the partial dependencies of the et and lst are also both strongly dependent on the investigated season in summer the partial dependence of fls on et fig 8d is more or less constant at a partial dependence of 0 predicted fls h day 1 over the complete value distribution in all other seasons and the full year run the partial dependence decreases at et values from 0 0 to 0 1 mm h 1 in spring and the full year run it then slightly increases again at 0 4 mm h 1 due to the low distribution of et values greater than 0 3 mm h 1 the corresponding partial dependence values might be less reliable the full year sensitivity for et is at 2 90 the seasonal maximum of sensitivity is found in fall 4 09 and the minimum is found in summer 0 94 the partial dependence of fls on lst fig 8e is highest when lsts are below the freezing point reaching a maximum at around 10 c at higher lsts the partial dependence of fls on lst decreases in summer the lst value range and also these partial dependence patterns are shifted to higher temperatures the full year sensitivity of lst is similar to the et sensitivity at 2 93 the seasonal maximum of lst sensitivity is found in fall 3 06 the seasonal minimum is found in winter 1 85 similar to their low feature importance alb fig 8f and fvc fig 8g both have small partial dependence values the partial dependence of alb slightly increases over the complete value distribution of all seasons and the full year run the partial dependence of fvc is low and constant over all seasons interestingly the full year sensitivity of alb reaches 2 56 a similar high value to the sensitivity of et and lst the seasonal maximum is found in winter 2 19 and the minimum is found in summer 1 24 the full year sensitivity of fvc is at 0 87 and thus the lowest of all features the seasonal fvc sensitivity is highest in winter 0 73 and lowest in fall 0 19 in the pressure filtered model run all partial dependencies show a similar pattern except for the partial dependencies of msp fig 8h this is due to the reduced value range of the msp values thus only the decrease of the partial dependencies starting from around 1035 hpa is visible the msp sensitivity changes direction in the pressure filtered model and lies at 4 33 for the full year run and is strongest in winter 4 03 and lowest in spring 0 74 all in all the response in modeled fls occurrence is distinctive for the features flsprev et lst ws and msp with the latter showing a clear dependency on the application of the pressure filter for changes in fvc and alb the response in modeled fls occurrence is small these partial dependence patterns confirm the feature importance patterns discussed above with flsprev msp and et being important features for model performance 3 5 two variable partial dependence while the isolated impacts of individual features can be investigated with the one variable partial dependencies two variable partial dependence plots can show the combined effects of two variables on the response of modeled fls occurrence allowing for the analysis of possible co dependencies based on the one variable partial dependencies described above six combinations of the most important features are presented in fig 9 these are msp ws a flsprev msp b flsprev et c et msp d flsprev ws e and et lst f in fig 9 the two variable partial dependencies of the full year run using all pressure situations including the seasonality are shown similar to the one variable partial dependencies the exact data preprocessing pertaining to seasonality treatment or pressure filtering does not substantially influence the two variable partial dependencies to outline characteristics of the distribution of the considered features and as an assessment for the representativeness of the results two distribution borders are marked in the plots below inside the outer dashed line 99 of the data can be found inside the inner dashed line 75 of the data is present additionally on the equivalent axes of the feature combinations the 1st 50th and 99th percentiles are marked as short lines the two variable partial dependence of msp and ws is displayed in fig 9a the values of the partial dependence are low over the complete value range of both features a diagonal pattern where low wind speeds and high pressure values lead to higher predicted fls values is indicated the combined effects of flsprev and msp in fig 9b are stronger with flsprev being the more dominant variable still a weak combined effect of higher msp values and higher flsprev values leading to higher predicted fls is visible in fig 9c the combined effects of flsprev and et are visible while low flsprev values in combination with high et values have a negative effect on predicted fls a positive effect on predicted fls is visible for high flsprev and low et values the two variable partial dependence of et and msp fig 9d also shows a diagonal pattern of the combined effect of high msp values with low et values leading to higher predicted fls the combined effects of flsprev and ws fig 9e are similar to flsprev and msp flsprev dominates the combined effects with stronger influence of ws when flsprev values are higher indicated by the more diagonal patterns of the two variable partial dependence at flsprev values larger than 5 h day 1 for the two variable partial dependencies of et and lst fig 9f low et values with low lst values lead to high predicted fls values in general the seasonal differences of the two variable partial dependence are governed by the seasonal differences in fls occurrence as well as the range of values of the features since fls occurrence is higher in winter and fall the magnitude of the two variable partial dependence is higher in winter and fall furthermore the combined effects of msp and ws are stronger in fall and winter thus confirm the combination of high msp low ws leading to higher predicted fls indicated in the full year plot in summer and spring two variable partial dependencies are low considering the patterns seen in the one variable and two variable partial dependence plots flsprev shows the most pronounced and clear effect on modeled fls occurrence and dominates the combined effects in the two variable partial dependence plots this is especially interesting since msp is the most important feature in most model runs compare fig 5 4 discussion 4 1 model performance in general the statistical models are capable of accurately predicting fls using meteorological and land cover predictors while subtracting seasonality does not influence model performance substantially filtering for high pressure situations boosts model performance significantly filtering for high pressure situations also leads to a higher relative frequency of radiation fog situation which helps the model learn the relevant patterns and thus improves its performance performance is best in winter and worst in summer these patterns might both be due to more frequent high pressure situations in winter e g bartoszek 2017 which can also be seen by significantly higher msp values in winter compared to the other seasons winter mean msp being 5 hpa higher in the era5 data used in this study additionally filtering for high pressure values makes it easier for the model to generalize and predict fls in summer and when using all pressure values fls occurrence may be due to local processes more frequently such as orographic lifting egli et al 2019 and not specifically tied to large scale weather systems this is in line with the results shown in van oldenborgh et al 2010 who found that atmospheric dynamics contribute up to 40 to the variability of fog occurrences in winter whereas in summer the contribution of circulations on fog occurrence is more dependent on local factors the spatial differences of r2 show lower model performance in units with high topographic variability such as parts of the mountain ranges surrounding the czech republic and the high tatras furthermore the deviation from the mean r2 fig 4 and mse per model unit is greater in areas with greater height above sea level and with greater standard deviation of height in that model unit the correlation between the mean height above sea level and deviation from the mean r2 per model unit is especially prevalent east of 10 e with a stronger negative deviation from the mean r2 at larger heights compare fig 4d this correlation is strongest in spring and fall the decreasing performance in these either high altitude or topographically highly variable model units could be due to more pronounced small scale local processes that the model is not capable of reproducing this could be also due to the missing terrain information in the selected predictors e g according to cuxart and jiménez 2012 the advection flows generated by the topography are crucial for the growing phase of radiation fog as stated in the methods using static geolocation variables such as height above sea level or geographic position can lead to overfitting and might be useful in training but not in making spatial predictions as stated in meyer et al 2018 and meyer et al 2019 terrain information as height above sea level is left out for this reason besides the missing terrain information the low resolution of the era5 data might lead to worse performance in topographically highly variable model units in these units the era5 data might be less accurate in general due to grid averaging here the quality of the era5 may be improved by using a different interpolation technique like kriging or bicubic interpolation during data preprocessing however such a change is not expected to markedly change the results generally the model performance in the eastern parts of the study area is high likely due to rather low variability in terrain and a large influence of large scale circulation patterns on fog occurrence leading to mostly radiation or advection fog these processes are well captured by the chosen predictors and therefore well represented in the models interestingly the high pressure filter can also lead to lower performance in some model units in winter such as near the harz and in parts of poland this is not the case at any other time of year though two things might be responsible for this pattern first in the high pressure situations in winter available data for training and testing has been reduced strongly thus false predictions have a stronger influence on the r2 of the model unit when less predictions are made in general in model units with more available data points false predictions have less influence on the model unit r2 secondly the lower performance in these units may indicate that in these regions fog occurrence during winter may be caused by processes that are not inherently captured by the set of predictors for example terrain induced processes may play a role as stated above such as on the mt brocken at 1142 m asl which is immersed in clouds about 50 of the time acker et al 2002 a thorough investigation of the influence of the fls distribution on model performance shows that in model units with higher fls occurrence model performance is better the relationship of model performance and mean fls occurrence for each model unit over all seasons is strong spearman s rho 0 8 and significant p 0 01 especially in the model runs using all pressure situations this confirms the previously stated relationship of better performance in winter and worse performance in summer these findings underline the influence of data availability and distribution on model performance overfitting is apparent in all models with larger differences between test and training performance in the 10 10 units than in the 15 15 units this is likely due to the higher number of available data points in the 15 15 units for training and testing shown with the decreasing difference between training and test performance with increasing number of data available in the model unit more data thus makes it possible to learn more fls situations and the subsequent behavior of the predictor variables furthermore in a larger domain a model needs to be able to represent rather general fls patterns instead of specific local fls patterns a highly localized model might be also prone to overfitting this could be investigated in future studies by varying the model unit size while keeping the number of available training points constant the different model unit sizes show the conflict between sufficient data for training and testing and small enough regional models to model smaller scale regional fls patterns this conflict between data availability and spatial resolution is frequently encountered in observational studies conducting hyperparameter tuning in all model units for all model unit sizes in combination with regularization would lead to higher computation times but could reduce the observed overfitting 4 2 fls drivers and their temporal and spatial patterns generally fog formation and presence depend on multiple factors such as the synoptic situation smaller scale atmospheric circulations and local orographic factors pérez díaz et al 2017 the important role of the synoptic situation is underscored by the results of this study with the high feature importance of msp and ws which are used as proxies for atmospheric dynamics in high pressure situations often related to anticyclonic conditions an inversion can develop during nighttime which is a prerequisite for the formation of radiation fog the results obtained from the sensitivity analysis indicate that lower wind speed together with high pressure lead to a stronger stability and thus persisting fls this interplay of msp and ws is also visible in fig 9 the influence of low wind speeds on turbulence generation during fls development is not visible here as such phenomena occur below the spatial resolution of the era5 data wind direction has not been included in this study since creating a general fls land surface model with a low number of predictors and minimum amount of rescaling has been a priority in this study to first create a general model framework which can be further developed based on its first results in the future for example more detailed treatments of wind speed and direction in different atmospheric layers will be investigated in further studies in the investigated study area especially humid air masses from the west are important for fog occurrence blas et al 2002 wrzesinsky and klemm 2000 klemm and wrzesinsky 2007 the importance of atmospheric dynamics and air masses is also visible by the higher frequency of model units with ws and msp as the most important feature in the western parts of the study region which possibly indicates a decreasing relevance of westerly moist air masses with increasing continentality as noted above wind direction should thus be added as a predictor in further studies the positive relationship of fls cover with flsprev is most likely due to persisting fls over several days due to persisting atmospheric conditions additionally feedback processes between fls and the surface exist in the presence of fls surface heating due to solar radiation is reduced during daytime which leads to lower near surface temperatures in the subsequent night and a reduction of the difference between air and dew point temperature this relationship might be stronger in basins and valleys where fls tends to persist longer due to lower wind speeds inside the fls layer and inversions or cold pool situations that can last for several days cuxart and jiménez 2012 scherrer and appenzeller 2014 to investigate processes and sensitivities in larger river valleys model units could be delineated specifically considering topographic information in further studies in these larger model units shap shapley additive explanations values introduced by lundberg and lee 2017 could be investigated which allow for the investigation of individual predictions leading to a global understanding of the model lundberg et al 2020 providing a tool to distinguish and individually analyze different fls regimes two land surface based predictors that are closely related to each other due to the dependence of the saturation vapor pressure on temperature described by the clausius clapeyron equation are lst and et this means that higher land surface temperatures lead to higher evapotranspiration with the latter being constrained by moisture availability especially in summer but also by solar radiation as well as the vapor pressure deficit concerning fls processes one would expect lst to have a negative relationship with fls occurrence and et to have a positive influence on fls occurrence due to the moisture input into the boundary layer however in this study both lst and et show a negative relationship with modeled fls the latter one likely confounded by temperature but also winds fls occurrence might be lower in high et situations due to the larger vapor pressure deficit and thus drier air generally et is strongly influenced by the variability of atmospheric conditions teuling et al 2010 seneviratne et al 2012 e g with anticyclonic circulation patterns leading to high et values in poland bogawski and bednorz 2016 at the scales considered in this study the influence of atmospheric conditions on et fls patterns is likely larger than the effects of moisture input via et on fls formation in general temperature and humidity during fls formation are connected via the process of condensation cooling leads to a rise in relative humidity a reduction of the atmospheric saturation vapor pressure and once saturation is reached condensation of water vapor to available cloud condensation nuclei and fog formation bergot and lestringant 2019 steeneveld and de bode 2018 this effect is especially prevalent in winter where fog formation is favored by a higher frequency of low temperatures together with high relative humidity conditions wrzesinsky and klemm 2000 hunová et al 2018 list relative humidity and air pollutants as the most important features when modeling fog in the czech republic as the presented statistical model presents a general working ground a proxy for ccn has not been included yet but will be in further studies the negative influence of higher lst on fls cover in urban areas williams et al 2015 izett et al 2019 can be suspected here but is not visible in the results due to the size of the model units still compared to lst et plays a stronger role in this study especially in spring and fall where the combined effects of low temperatures favorable for fls and a higher soil moisture leading to moderate evapotranspiration are prevalent this is mainly visible in the eastern part of the study area where et is the most important feature in most model units in spring and fall in these units the moisture input by maritime westerly air masses might be limited which could lead to a higher importance of local moisture sources according to van oldenborgh et al 2010 fog during summer in the netherlands only forms when enough moisture is present with higher summer fog occurrences when moisture input in the preceding early summer or spring months has been larger here in high pressure situations day to day variations in et are more important for predicting fls occurrence than day to day variations in msp which is visible in the feature importance of et and msp in the deseasonalized model run in this study the influence of radiative properties of the surface on fls occurrence is only indicated by the small positive influence of increasing alb values on fls occurrence still the feature importance and partial dependence of alb is rather low and does not feature a clear pattern the small effect of alb on fls occurrence might also be due to the multiple directions in which alb might influence fls occurrence while surfaces with high alb absorb less radiation during daytime and thus might lead to a lower air temperature and higher relative humidity above these surfaces during nighttime when radiation fog usually forms darker surfaces might provide more moisture initially such as water bodies or forests furthermore fls reduces the incoming solar radiation thus masking some expected radiative effects of alb on fls occurrence in further studies the effects of radiation on fls occurrence could be further investigated by adding radiation fluxes as predictors to the model similar to alb the influence of fvc on fls occurrence is also not clearly visible in the results obtained from the study duynkerke 1991 lists vegetation as a driver for fls occurrence but this might not be visible here due to the spatial resolution and the stronger influence of meteorological drivers that mask such influences of the land surface and cover still with the exclusion of low pressure situations and subsequent decreasing the influence of atmospheric dynamics can help the investigation of the influence of land surface parameters on fls distribution filtering for specific weather situations as in egli et al 2019 could decrease the variability and influence of the considered atmospheric predictors and may help isolate the influence of land surface parameters on fls distribution under specific conditions as already stated certainly not all factors influencing fls distribution are considered in this study in part this study is limited by the spatial resolution of the data sets used as local and regional morphology are important drivers for fls occurrence e g blas et al 2002 furthermore the landform turbulent boundary layer mixing above cloud humidity and winds soil conductivity availability of ccn and the distance to the coast are listed as influential fls drivers e g blas et al 2002 blas et al 2010 steeneveld and de bode 2018 hunová et al 2018 in further studies the presented baseline model can be expanded by integrating these predictors to investigate their influence on model performance and sensitivities 5 conclusion in this study a machine learning technique gradient boosting regression trees was used to predict observed fls occurrence over continental europe using meteorological and land surface parameters as predictors to analyze spatial patterns of model skill and sensitivities spatially explicit 10 10 and 15 15 seviri pixel model units were created covering the entire study area additionally models were applied for different model setups and data preprocessing procedures the models were then applied to the entire full year data as well as in different seasons in general the statistical models were able to accurately predict fls occurrence in all regions of the study area with r2 values between 0 6 and 0 94 during validation with independent data model skill was observed to be highest in winter and lowest in the full year run model performance increases when only high pressure situations are considered and when smaller 10 10 seviri pixels model units are used some overfitting is apparent in all models and depends on model unit size with larger modeling domains featuring less overfitting using deseasonalized data only has a small effect on model performance analyses of feature importance reveal that features pertaining to atmospheric dynamics are more relevant to predict fls than surface characteristics the most important features for fls prediction are msp ws fls on the previous day et and to some extent lst albedo and fvc are less important in the statistical models when only considering high pressure situations msp becomes less important while et and ws gain importance the latter especially in spring and fall spatial patterns of the most important feature show the dominance of msp in most of the model units when using all pressure situations when only high pressure situations are considered et is dominant in central and eastern parts of the study area while ws flsprev and msp are dominant in western parts of the study area a sensitivity analysis was conducted with the statistical models using the partial dependence technique while there are some differences in partial dependencies when excluding low pressure situations seasonality and model unit size settings do not seem to have a marked influence a positive influence of flsprev and msp and a negative influence of et lst and ws on modeled fls were found these patterns are also confirmed in analyses of two variable partial dependencies which were used to study the combined effects of msp ws et lst and flsprev this analysis showed that especially the combination of high flsprev high msp and low ws values leads to high predicted fls values this is also the case for low lst and low et values considering the modeling framework there are several limitations that should be noted first of all using spatially explicit model units reduces the available number of data points for training and testing thus the available data puts a constraint on the spatial resolution at which such an analysis can be conducted still there is potential for future improvements creating larger model units could provide more data that could also be used for validation and reduce the risk of overfitting grid search or a different methodology for hyperparameter tuning could be applied in all units separately and with fewer model units less computing time would be consumed while the generalization of hyperparameters is useful in this model set up conducting a thorough grid search in all model units would lead to a more complete picture of ideal hyperparameters for the model but still may have little influence on model skill and overfitting it has to be noted that fls is influenced by a large number of parameters some of which are not represented in the model such as topography humidity wind direction soil moisture and aerosol loading additionally fls formation is also influenced by the state of higher atmospheric layers for example through moisture advection and mixing while the model set up presented here provides a general working ground these features may be integrated in more complex statistical frameworks in the future furthermore fls processes take place from small scales of aerosol activation 10 7 m to synoptic scales 106 m accurately addressing the issues concerning scales will thus be a critical aspect going forward specifically as processes that are not important on one scale might be crucial on a different scale to gain further insights into the relationship between fls and the land surface fls properties such as cloud top height and liquid water path can also be analyzed with the presented modeling framework while the model units can be varied in size they can also be grouped into areas of similar topography or land cover which could help in further analyzing fls land cover dependencies credit authorship contribution statement eva pauli conceptualization formal analysis investigation methodology visualization writing original draft writing review editing hendrik andersen methodology writing review editing jörg bendix writing review editing jan cermak conceptualization methodology writing review editing sebastian egli resources writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements lsa saf data were obtained from the lsa saf data catalogue https landsaf ipma pt en data catalogue last access 09 april 2019 era5 data were obtained from the copernicus climate data store https cds climate copernicus eu cdsapp dataset reanalysis era5 single levels tab overview last access 02 april 2020 eva pauli has been financially supported by the graduate funding from the german states the valuable comments of two anonymous reviewers and the editor helped improve the original manuscript appendix a mean squared error mse of all models 
5096,recent studies have reported that connected impervious areas those impervious surfaces that contribute directly to runoff in a storm network or stream are a better indicator of hydrologic response stream alteration and water quality than total impervious area however most methods for quantifying connected impervious areas require major assumptions regarding the definition of connection potentially over simplifying the role of variable climates slope gradients soils conditions and heterogeneous flow paths on impervious surface connectivity this study presents a new conceptual model and method for estimating hydrologically connected impervious areas hcia that explicitly considers the effect of landscape and storm variability the model separates impervious surfaces into two categories directly or physically connected a phys and variably connected a var impervious that drains to pervious of these categories we investigated the sensitivity of a var connectivity to varying soil conditions slope gradients rainfall properties and hillslope geometry using pyswmm a python interface for swmm5 simulations spanned a large parameter space with varying soil slope rainfall properties and geometries i e relationships between the impervious and downslope pervious areas pyswmm simulations were used to train and test a regression tree that predicts infiltration and connectivity of runoff from a var surfaces which provides excellent fidelity with pyswmm outcomes to enable use of these methods in practice we developed an arcgis tool that 1 delineates subcatchments 2 extracts the impervious surface categories a phys and a var 3 applies the regression tree algorithm to predict the fraction of incident rainfall that produces runoff across a var and 4 summarizes the resulting hcia by subcatchment analysis of the regression feature importance shows that in general a var connectivity is highly sensitive to the soil type rainfall depth area fraction and antecedent soil moisture conditions of the downslope pervious area we find that temporally varying parameters e g rainfall and antecedent soil moisture control a var connectivity in areas with low permeability soils while spatial flow path variability e g relative quantity of disconnecting pervious area controls a var connectivity in areas with highly permeable soils the methods developed in this study can be used to identify impervious surface connectivity more accurately in urban watersheds representing an important step forward for incorporating spatial heterogeneity in stormwater modeling and planning keywords hydrologically connected impervious areas urban runoff modeling regression tree analysis geospatial modeling swmm 1 introduction increased urbanization involves increased extent of impervious surfaces such as roads parking lots and rooftops these surfaces prevent infiltration of rainwater and instead shed water by surface runoff into streams increasing storm runoff for a given rainfall leopold 1968 thereby increasing the erosive force of stormflows which in turn causes erosion of stream beds and banks booth and jackson 1997 gillies et al 2003 walsh et al 2005 by eliminating infiltration and the filtering effect of rainwater flowing through soil pollutants accumulate on roads parking lots and rooftops and polluted runoff from these impervious surfaces flows directly untreated into receiving lakes bays and streams as non point source pollution arnold and gibbons 1996 by virtue of its easy quantification via mapping from aerial imagery total impervious area tia the total area occupied by impervious surfaces has long been used as an indicator of the degree of urbanization and consequent effects of urbanization on hydrologic conditions however tia does not distinguish between impervious areas that are directly connected to streams being adjacent or connected via stormwater pipes from those that are distant and whose runoff flows over pervious surfaces if runoff from such an impervious surface infiltrates prior to reaching the stream it is effectively disconnected as it does not contribute directly to storm response in the stream conversely if its runoff does not infiltrate but rather saturates the downslope pervious area and produces runoff that reaches the stream channel it is termed indirectly connected boyd et al 1993 tia lumps directly connected disconnected and indirectly connected together and thus is limited in its ability to predict runoff at local scales mcgrane 2016 crompton et al 2019 fletcher et al 2013 lim 2016 zhang and shuster 2014 the metric directly connected impervious area dcia was introduced to measure impervious areas that are physically connected to the stormwater network or stream channel and can be mapped directly though it may require information beyond that available from aerial imagery such as maps of storm drainage infrastructure e g hwang et al 2017 lee and heaney 2003 seo et al 2013 while the runoff from directly connected surfaces may be straightforward to measure and model runoff from indirectly connected impervious areas is more complicated because it depends on how much runoff is infiltrated into pervious areas before reaching a stream which depends on the flow path length and slope over pervious soils and their infiltration rate infiltration rate is affected by soil texture surface roughness vegetative cover and soil moisture content or saturation which is influenced by antecedent rainfall infiltration can also occur in surfaces that we consider to be impervious e g through cracks in asphalt or concrete in an attempt to account for the combined effect of these various factors the metric effective impervious area eia was introduced by miller 1978 epps and hathaway 2018 while eia and dcia are sometimes used interchangeably their methods of estimation differ rather than being mapped directly from surface features eia is typically back calculated from streamflow and rainfall e g boyd et al 1993 ebrahimian et al 2016 epps and hathaway 2019 han and burian 2009 roy and shuster 2009 walsh et al 2005 or determined through model calibration e g mcnamee et al 1994 sutherland 1995 eia therefore implicitly accounts for catchment characteristics affecting hydrologic response e g soils slope surface roughness spatial patterns and rainfall because eia relies on stream flow and rainfall inputs it is limited to the scale and locations at which these data are available which despite continuous efforts to accumulate hydrological data is lacking in most catchments of the world blöschl 2005 tegegne and kim 2018 dcia is mapped directly so its quantification does not depend on stream flow or rainfall data availability spatially explicit maps of impervious surface connection inherently assume that physical connectivity is indicative of hydrological connectivity these two types of connectivity may differ bracken and croke 2007 physical connectivity refers to the physical connection of points lines or polygons while hydrologic connectivity refers to the connectivity of water pathways across a landscape physical connectivity metrics such as dcia and tia do not implicitly account for hydrologic processes or interactions so they may or may not correlate with actual hydrologic connectivity bracken et al 2013 bracken and croke 2007 lexartza artza and wainwright 2009 for example impervious areas which are physically and hydrologically disconnected under certain rainfall scenarios may become hydrologically connected under more intense rainfall scenarios as downslope pervious patches become saturated the shortcomings of eia and dcia as reflected in the methods used to produce them present both a challenge and an opportunity to improve our understanding of controls on the hydrologic contribution of impervious surfaces across heterogeneous flow paths in this study we define a third metric hydrologically connected impervious areas hcia to refer to spatially explicit mapped estimates of the proportion of impervious surfaces that are hydrologically connected to the storm sewer system or stream network here we use impervious and pervious as contrasting terms but acknowledge that this is a simplification of the continuum of conditions that exist hcia depends on both the physical connectivity of impervious areas explicitly quantified by dcia and the hydro geomorphic conditions e g soil moisture conditions soil types rainfall rate geology which are implicitly incorporated in the quantification of eia current methods for spatially explicit eia estimation require rainfall and runoff datasets e g ebrahimian et al 2016 epps and hathaway 2018 the use of high resolution ecohydrological models easton et al 2007 miles and band 2015 or geo statistical analyses ebrahimian et al 2016 lim 2016 consequently these efforts are often site specific and extrapolation of their results to other watersheds is limited thus a generalizable approach for estimating hydrologically connected impervious areas is needed the incremental contribution of the present study is to i explicitly define controls on impervious surface hydrologic connectivity and ii to present a generalizable model to predict and map hydrologically connected impervious areas including indirectly connected impervious areas in this study we evaluated the controls on impervious surface runoff contribution by varying spatial arrangements of impervious pervious areas rainfall depth soil types and antecedent soil moisture conditions to facilitate dissemination into practice we developed a transferable arcgis tool that provides estimates of hcia across urban watersheds and we present a case study of the arcgis tool applied to a residential sewershed in colorado usa 2 conceptual model of hydrologically connected impervious areas we define total impervious area within a catchment by two impervious surface categories rooftops a roof and ground level impervious a ground so that tia a r o o f a g r o u n d fig 1 the portion of a roof and a ground that are both physically and hydrologically connected to the storm drainage system are considered physically contributing impervious a phys those portions of a roof and a ground that are not physically connected to the storm drainage network but rather produce runoff that flows as runon to pervious areas are considered variably contributing impervious a var the total hydrologically connected impervious areas hcia along the flow path shown in fig 1 can thus be described as 1 h c i a ϕ p h y s a p h y s ϕ v a r a v a r where ϕ phys and ϕ var refer to the fraction of incident rainfall that contributes to runoff response on physically connected surfaces a phys and variably connected surfaces a var respectively a phys and a var are further defined as 2 a p h y s a p h y s r o o f a p h y s g r o u n d 3 a v a r a v a r r o o f a v a r g r o u n d where a phys roof and a phys ground refer to the physically connected roof and ground level impervious areas and a var roof and a var ground refer to the variably connected roof and ground level impervious areas respectively 2 1 determining a phys and a var remote sensing data can be used to classify types of impervious surfaces into rooftop a roof and ground level impervious areas a ground ground level impervious areas can be further separated into a phys ground and a var ground using a combination of high resolution digital elevation models dem flow paths and drainage networks han and burian 2009 remote sensing datasets alone cannot directly discern physically or variably connected rooftop areas a phys roof or a var roof han and burian 2009 redfern et al 2016 because buildings may pipe roof runoff directly to the storm drainage system consequently determining an accurate estimate of a phys roof and a var roof may require site specific and time intensive surveys and field investigations han and burian 2009 roy and shuster 2009 the few studies that have endeavored in such time intensive surveys often report rooftop connectivity values by land use class e g alley and veenhuis 1983 lee and heaney 2003 these averages are sometimes applied to other study areas as an estimate of rooftop connection han and burian 2009 however there are a range of local variables e g land use history development codes local retrofit programs and homeowner preference that influence the connectivity of roof areas indeed there is a wide range of rooftop connectivity values even within specific land use categories reported in the literature ebrahimian et al 2016 suggesting that land use is a poor predictor of connectivity across different jurisdictions jurisdiction specific rooftop connectivity surveys however may provide a reasonable estimate for a phys roof or a var roof particularly if these surveys are paired with review of development codes and development history of the region 2 2 determining ϕ phys and ϕ var estimating the hydrologic contribution of a phys and a var presents a separate challenge because a phys does not encounter pervious areas en route to the stormwater network losses along its flow path are likely to be limited to storage depression and initial abstractions for simplicity we assume here that ϕ phys is some constant value 1 we note however that previous research has shown significant variability in the fraction of rainfall that produces runoff redfern et al 2016 with values ranging from 0 09 on brick areas mansell and rollet 2006 to 0 16 on deteriorated asphalt concrete to 0 74 on asphalt concrete in good condition ramier et al 2004 there are also cases in which ϕ phys may be greater than 1 for example if a rain event exceeds the capacity of the downstream drainage system overflow from a phys may be routed to a var in contrast a var surfaces are routed to pervious areas therefore their connectivity fractions ϕ var are likely to be subject to time varying infiltration loss and depend on factors like downslope pervious areas soil conditions slope and rainfall intensity crompton et al 2019 pappas et al 2008 shuster et al 2008 zhang and shuster 2014 the remainder of this study focuses first on defining the factors that influence ϕ var and second on developing geospatial methods for extracting areas of these impervious surface connectivity types a phys and a var applying respective connectivity fractions ϕ phys and ϕ var and estimating hcia for ungauged catchments 3 methods 3 1 overview our approach involves three main steps shown schematically in fig 2 and described below first we utilized a python interface for the stormwater management model pyswmm to model factors that could influence ϕ var we simulated infiltration and runoff across a range of pervious area fractions soil textures antecedent soil moisture conditions slopes and rainfall scenarios section 3 2 second we developed a generalized relationship for ϕ var as a function of these factors using a regression tree algorithm section 3 3 third we developed an arcgis tool that implements the proposed conceptual framework to estimate hcia by identifying the impervious surface categories a var and a phys and applying their respective connectivity fractions ϕ var and ϕ phys section 3 4 as a case study we tested this arcgis tool in the berkeley lake sewershed in colorado usa section 3 5 3 2 pyswmm modeling to evaluate controls on ϕ var to determine the sensitivity of a var connectivity to various landscape and storm parameters we considered only a var surfaces at the ground level temporarily ignoring effects of a roof and a phys we used pyswmm to simulate runoff and infiltration at the outlet of an idealized catchment consisting of an impervious area a var routed to a downslope pervious area a perv we conducted a total of 60 000 model simulations across two parameter sets 1 150 plausible rainfall soil moisture and soil texture scenarios and 2 400 geometric parameter combinations total area width pervious fraction and slope the 150 rainfall soil moisture and soil texture scenarios table 1 represent factorial combinations of ten pervious area soil textures four slopes five 24 hour rainfall depths and three antecedent soil moisture conditions asm we used the swmm modified green ampt infiltration model to simulate infiltration in pervious areas green ampt infiltration parameters saturated hydraulic conductivity k s suction head ψ f and porosity n for the ten different soil textures were taken from rawls et al 1983 initial moisture deficit imd the difference between initial soil moisture θ i and saturated soil moisture θ s varied according to the three asm conditions and the soil porosity n saturated soils imd 0 field capacity imd n θ i fc and wilting point imd n θ i wp table 2 see appendix section a 1 for additional detail on the swmm modified green ampt infiltration model we used the scs type ii 24 hr synthetic storm distribution which typifies high intensity rainstorms and applies to the majority of the us by land area usda 1986 the five rainfall depths p ranged from 5 mm to 102 mm 0 6 in to 4 in encompassing 95 percent of daily rainfall values across the us shrestha et al 2013 the 400 geometric parameter values represented combinations of total area a equal to a var a perv pervious fraction ϕ perv equal to a var a catchment width w and slope s a ϕ perv and w parameter values were generated from 100 random values with a ranging from 0 to 1 ha 0 to 10 000 square meters ϕ perv from 1 to 100 percent of the total area overland flow length l from 0 to 152 m or 500 feet the maximum likely overland flow length james et al 2010 and thus width w from 0 to a l slope ranged from 1 to 4 the limited slope range was selected because the majority of urban surfaces e g roads sidewalks parking lots have cross slopes less than 4 e g city of seattle 2020 jefferson county 2019 and because slope has been shown to have a limited effect on runoff volumes crompton et al 2019 manning s roughness values for impervious and pervious areas n imperv and n perv as well as depression storage values d store imperv and d store perv were held constant across simulations for each simulation we calculated ϕ var as 1 if runon where if runon was defined as the fraction of total a var runoff that infiltrates in the downslope a perv it is important to note that because the aim of this model was to simulate connectivity of impervious surfaces if runon does not represent the fraction of total inflow that infiltrates but rather the fraction of impervious runon that infiltrates see appendix section a 2 for additional detail the outcomes of the pyswmm simulations were compiled in python and the sensitivity of ϕ var to the different rainfall soil moisture soil texture scenarios and subcatchment characteristics were evaluated using boxplots 3 3 regression tree to predict ϕ var the large simulation space 60 000 simulations presented an opportunity to relate the predictor variables p asm soil texture s a ϕ perv w to the hydrologic outcome of interest ϕ var however as is the case with many hydrological variables iorgulescu and beven 2004 the relationships between these predictor variables and ϕ var is nonlinear and thus not well explained by global linear or polynomial regressions in which a single formula is expected to hold over the entire dataset supervised machine learning algorithms such as regression trees are being increasingly applied to hydrological science questions due to their ability to make predictions quickly and to distinguish sensitive variables from non sensitive variables iorgulescu and beven 2004 tyralis et al 2019 here we used a regression tree one such supervised machine learning algorithm to predict ϕ var from the predictor variables and to evaluate the relative importance of these variables for predicting ϕ var regression trees can be used to estimate a response variable from multiple input variables by building a set of decision rules on the predictor variables breiman 1984 prasad et al 2006 tyralis et al 2019 the decision rules apply recursive partitioning to the variable space lawrence and wright 2001 prasad et al 2006 subdividing the dataset into smaller more manageable chunks of data over which predictions can be made tyralis et al 2019 the number of tree branches leaf nodes and features considered when splitting a node are the tree hyperparameters which are tuned prior to training the regression tree the following sections describe the process used to develop the ϕ var regression tree 3 3 1 cross validation to avoid overfitting in machine learning algorithms such as regression trees a model should be validated using new testing data on which it has not been trained in cross validation the data is partitioned into n equal sized subsamples or folds for each of the n folds n 1 folds are used to train a model and the remaining fold is used for model validation this process is repeated a total of n times until each fold serves as the validation set thus the overall performance is evaluated on data that was not used to train the model with each observation contributing exactly once to validation reid et al 2015 after partitioning the pyswmm simulation outcomes into training and testing sets using a 70 30 split we used a 10 fold cross validation process on the training set to define the model hyperparameters section 3 3 2 select model features section 3 3 3 and evaluate the performance of the final model section 3 3 4 for each of the 10 folds we computed the mean square error mse between ϕ var as determined by the regression and pyswmm 4 m s e 1 m i 1 m y i y i 2 where yi is the pyswmm prediction for ϕ var taken as the observed value yi is the regression tree prediction for ϕ var taken as the predicted value and m is the number of predictions made within the fold the overall cross validated error msecv was computed as the average mse across the 10 folds 3 3 2 hyperparameter tuning regression tree hyperparameters control the regressor s flexibility and adaptability to the training data careful tuning of hyperparameters can improve generalizability of the model and prevent overfitting of the data we defined the hyperparameter grid composed of hyperparameter ranges then used a random search algorithm to sample 100 random values from the hyperparameter grid we performed 10 fold cross validation for each combination of grid values resulting in 1000 total fittings we then selected the set of hyperparameters that minimized msecv and used these as the hyperparameters in the final model details and results of the hyperparameter tuning process are included in appendix section a 3 3 3 3 feature importance and selection we computed the regression tree feature importance with the gini importance index to evaluate the relative significance of model features i e the independent variables in predicting ϕ var the gini importance index represents the mean decrease in node impurity resulting from splitting weighted by the probability of reaching a node tyralis et al 2019 the higher the feature importance the more significant that feature is relative to others for predicting response the feature importance values were then used to choose a parsimonious subset of the predictor variables model features that can predict the outcome with accuracy comparable to the performance of the complete input set but with greater computational efficiency 3 3 4 model performance we assessed performance of the regression tree model defined by tuned hyperparameters and selected features using 10 fold cross validation on the training dataset to confirm that the final regression tree performed consistently on data on which it was not trained we also evaluated the performance of the model on the held out testing dataset after estimating model performance we fit a regression tree with the entire dataset 60 000 simulations and then exported it into a format readable by arcpython for implementation in the arcgis tool see section 3 4 3 3 5 sub tree feature analysis the feature importance metric described in section 3 3 3 provided insight into how connectivity varies across different storms given by rainfall and landscape geometries given by geometric parameters or conditions given by soil type and antecedent soil moisture such an analysis does not provide insight into the relative importance of these features within a given storm or landscape for example which parameter s control hydrologic connectivity in a landscape with a specific soil type or for a particular storm to develop a better understanding of within storm landscape hydrologic controls we additionally trained and tested separate regression trees for specific subsets of the dataset table 3 which we refer to as sub trees and evaluated feature importance across these sub trees these sub trees were analyzed to illustrate potential within storm landscape controls on connectivity and were not used in any subsequent analysis or within the arcgis tool 3 4 arcgis tool the hcia arcgis tool consists of four main steps 1 dem processing and subcatchment delineation 2 extracting the impervious area connectivity types a phys and a var 3 defining connectivity fractions ϕ phys and ϕ var and 4 computing hcia for each subcatchment each step is summarized below and the hcia arcgis tool and its full documentation are available for download on github https github com anneliesesytsma hydro imperv 3 4 1 step 1 dem processing and delineating subcatchment inputs to this step are a high resolution e g 1 m digital elevation model dem raster stormwater inlets that represent the outlet of the subcatchment to be modeled e g catch basin or manhole points and a stormwater network of pipes and ditches polyline in this step the dem is processed to remove sinks compute the flow direction and flow accumulation rasters and extract the stream network the subcatchments draining to each stormwater inlet are delineated using archydro tools 3 4 2 step 2 classifying impervious areas a phys a var inputs to this step are the dem and subcatchments from step 1 as well as impervious surfaces separated into ground level impervious and rooftops shapefile in this step an iterative process is used to classify a phys and a var for ground surface impervious and rooftop impervious areas first an initial guess of physically connected impervious a phys o is made physical connectivity of rooftops is based on user input data from e g land use assumptions or field investigations and physically connected ground level impervious is based on intersection with the stormwater inlet points an initial guess of variably connected impervious a var roof o and a var ground o comprise the remaining a roof and a ground surfaces respectively pervious area flow paths downstream of a var roof o and a var ground o areas are quantified using cost distance allocation and cost path functions impervious areas with downslope flow paths over pervious areas are designated as a var this process assumes that the building downspouts are located on the downslope most edge of a var roof o areas the remaining a var roof o and a var ground o areas with no downslope pervious flow paths are then added to a phys o to give a phys 3 4 3 step 3 defining ϕ phys and ϕ var the next step in the hcia arcgis tool applies connectivity fractions ϕ phys and ϕ var to their respective areas within each subcatchment the user supplies a constant value for ϕ phys ranging from 0 to 1 and specifies the scenarios on which ϕ var is computed p asm and soil texture class ϕ phys is applied to all a phys surfaces including rooftops and ground level impervious a phys areas the regression tree algorithm is used to predict ϕ var for each a var as it depends on the user selected scenario as well as on the geometric characteristics of the a var and a perv surfaces determining the relevant geometric characteristics for the regression tree algorithm requires developing representative rectangular polygons from irregularly shaped a var and a perv surfaces the process used to represent a var and a perv as rectangles is shown in fig 3 first a characteristic width w is computed by dividing a var by its maximum overland flow path length l var next a perv is computed by multiplying w by the distance from the centroid of a var to the nearest downslope a phys l perv finally ϕ perv is computed by dividing a perv by the total area a var a perv 3 4 4 step 4 computing hcia the final step in the hcia arcgis tool involves computing the hcia within each subcatchment each a phys are is multiplied by ϕ phys and each a var area is multiplied by its computed value of ϕ var the sum of these products within each subcatchment comprises the subcatchment hcia see eqs 1 3 the percent hcia within each subcatchment is then calculated as the fraction of total impervious area comprised of hcia hcia tia 3 5 case study as a test case we applied the hcia arcgis tool to the berkeley neighborhood in northwest denver colorado fig 4 the study area is a 4 7 square kilometer sewershed in the berkeley neighborhood hereon referred to as the berkeley sewershed and is primarily comprised of single family residential land use 54 parks and recreation areas 18 and multifamily units 10 panos et al 2018 the majority of buildings in the study area were constructed between the early 1900s and the 1980s denver open data catalog 2020 though the neighborhood has been subject to intense infill development in recent years cherry et al 2019 panos et al 2018 impervious surfaces comprise 53 percent of the total sewershed area in 2014 the 2 year 5 year and 10 year 24 hour scs type ii storms for this area correspond to rainfall depths of 4 6 5 9 and 7 1 cm respectively panos et al 2020 no soil data are available for the area in the ssurgo nrcs soil survey but near by area soil textures are classified as c type clay and loam panos et al 2018 overland flow and stormwater pipes through the sewershed route stormwater runoff from the south elevation 1670 m to the north elevation 1630 m ultimately discharging into clear creek fig 5 3 5 1 input data shapefiles of stormwater inlet points manholes and catch basins the stormwater network and impervious surfaces were provided by the city and county of denver community planning and development department cpd as used in the modeling efforts performed by panos et al 2018 the impervious surface shapefile from cpd distinguishes roofs roads and other impervious areas these were summarized into roofs a roof and ground level impervious a ground a 1 m digital elevation model dem of the study area was downloaded from the u s geological survey usgs national elevation dataset u s geological survey 2017 flow paths and subcatchments draining to inlet points were delineated using the 1 meter dem 3 5 2 estimating a phys and a var to develop an initial estimate of roof connectivity a phys roof o we evaluated current and historical development codes in the city of denver for requirements pertaining to roof drainage gutters and downspouts the denver building code dbc of 1881 required that all buildings shall be provided with proper metallic leaders to conduct water from the roof which shall be connected with the sewer or street gutter 21 pp 11 denver building code 1881 which was modified in 1898 to no water shall be discharged from conductor pipe upon any sidewalk but shall be conducted underneath the walk in iron or tile pipes 145 pp 49 denver building code 1898 beginning in 1976 new construction was not permitted to pipe roof discharge directly to the street or storm sewer network rather external roof downspouts were to discharge to concrete blocks at least 12 in in width by 36 in in length except for roofs that drain to the interior of the building 3211 pp 32 12 denver building code 1976 interior roof drains are not common in residential development but are used for commercial and industrial development with flat or internally sloped roofs the 2018 international plumbing code adopted by the city of denver per the 2019 denver building and fire code denver building 2019 requires roof runoff from one and two family dwellings to discharge to flat areas such as lawns where possible 1101 2 international plumbing code 2018 visual inspection using google street views and google maps confirmed that most houses in the neighborhood have visible downspout extensions that route roof runoff to gardens or lawns while most commercial buildings with flat rooftops appear to use internal roof drainage visible from satellite imagery and no downspouts are visible from the outside therefore as an initial estimate of roof connectivity we assumed that all roof areas within commercial industrial land use are physically connected a phys roof o and all roofs within all other land use designations primarily residential are variably connected a var roof o ground level impervious surfaces that intersected with the drainage network were initially assumed to be physically connected a phys ground o all other ground level impervious were designated as a var ground o final estimates of a phys roof a var roof a phys ground and a var ground were then determined per the methods described in section 3 4 step 2 3 5 3 ϕ phys and ϕ var scenarios for simplicity we assumed that all a phys surfaces are 100 percent connected ϕ phys 1 but note that other values for ϕ phys could be applied in the hcia arcgis tool ϕ var estimation requires user input for the hcia scenario p asm and soil texture class step 3 lacking soil survey data in the catchment we used the near by area soil texture predominantly c type clay and loam panos et al 2018 to stay within the soil parameters used to develop the regression tree we assumed soil parameters that represent typical silty clay loam soils with k s of 1 mm h see table 2 since asm and p are temporally varying we computed hcia across 3 asm conditions and 5 p scenarios for a total of 15 estimates of hcia across the berkeley sewershed total hcia and percent hcia within each subcatchment were computed following methods outlined in section 3 4 step 4 for each of the 15 asm and p scenarios 4 results 4 1 connectivity of impervious surfaces is sensitive to soil texture soil moisture rainfall and pervious area fraction the sensitivity of ϕ var to soil texture soil moisture and rainfall scenarios soil texture asm and p and geometric parameters ϕ perv a w and s is shown in fig 6 soil texture given by k s is the most sensitive model parameter with median ϕ var values ranging from 0 to 0 98 fig 6a though not as sensitive as soil texture asm also affects ϕ var with saturated scenarios resulting in less infiltration median ϕ var 0 74 than soils at field capacity or wilting point fig 6c the five rainfall depths also resulted in a range of median ϕ var from 0 34 to 0 84 fig 6e with higher ϕ var resulting from higher rainfall depths of the geometric parameters tested ϕ var is highly sensitive to ϕ perv fig 6b but insensitive to s w and a fig 6d f and g these plots also illustrate the complex interactions and non linearity between these parameters and ϕ var for example even for very low ϕ perv values ϕ var ranges from 0 to 1 fig 6b suggesting a different parameter or combination of parameters controls ϕ var in these cases additionally while ϕ var generally decreases with increasingly permeable soils there are some cases in which ϕ var for high permeability soils e g k s 120 4 mm h exceeds that of lower permeability soils e g k s 0 3 mm h as indicated by the outlier points on fig 6a this suggests that the effect of low k s on ϕ var may be moderated or exacerbated by other sensitive parameters for example if k s 0 3 mm hr ϕ perv 0 8 asm wp and p 1 5 cm ϕ var could be relatively low despite the highly impermeable soils 4 2 importance of storm landscape features can vary across and within landscapes of the four features selected for the final model ϕ perv p asm and soil texture represented by k s the most important feature is soil texture followed by p ϕ perv and asm fig 7 a this suggests that across storm landscape scenarios ϕ var is primarily controlled by soil texture these results are consistent with the pyswmm sensitivity analysis section 4 1 which showed that ϕ perv soil texture p and asm are sensitive parameters while s a and w are relatively insensitive the final model which incorporates the four most important features and optimal hyperparameters resulted in an msecv of 0 003 and r2 of 0 97 fig 7b the importance of each of the final model features varies across the eight sub trees fig 8 illustrating the effects of within storm landscape variability on the features that control ϕ var for example for the sandy soil sub tree a regression tree trained only on simulations with sandy soils k s 120 4 mm h ϕ perv and to a lesser extent p are the most important features fig 8a note that soil texture or k s is not important in these scenarios as it is no longer varying however as k s decreases associated here with clay soil texture the importance of ϕ perv decreases and that of p increases fig 8a while k s is clearly the most important feature across all three antecedent soil moisture conditions it is more important for the case of saturated soils asm saturated it decreases in importance for drier soils asm wilting point while the importance of other parameters p and ϕ perv increases fig 8d 4 3 application of hcia arcgis tool to the berkeley sewershed across the berkeley sewershed subcatchments we found that ground level impervious a ground comprised 63 percent and rooftop impervious a roof comprised 37 percent of the total subcatchment impervious areas a total of 87 percent of a ground and 48 percent of a roof were found to be physically connected a phys therefore comprised the majority 73 percent of all impervious surfaces in the study area fig 9 shows the spatial variability in contribution of a var to hcia across the study area subcatchments for the three antecedent soil moisture conditions and five precipitation depths the contribution of a var to hcia generally increased with increasing p and increasingly saturated soils the standard deviation in a var contribution to hcia across subcatchments also generally increased with p and soil saturation this illustrates the divergence between subcatchments comprised of a var and those comprised mostly of a phys while a var contribution changed with p and asm a phys contribution remained constant interestingly the a var contribution to hcia did not vary between field capacity and wilting point soil conditions where p 2 5 cm suggesting that for higher storm depths and intensities the difference between various initially non saturated soil conditions may be negligible 5 discussion 5 1 controls on hydrologic connectivity we found that the factors that exhibit the strongest control on a var connectivity are rainfall depth p antecedent soil moisture asm pervious area soil texture represented by k s and the amount of downslope pervious area relative to total area given by ϕ perv fig 7a soil texture was the most important parameter across all simulations however we observed two key shifts in feature importance when different parameters such as soil texture are held constant first for impervious routed to highly permeable soils i e where soil k s rainfall intensity ϕ perv was the most important feature as shown for sand in fig 8a however with increasingly impermeable soils p became the most important feature this suggests that in urban areas with predominantly impermeable soils p controls connectivity of impervious areas more than ϕ perv these results are consistent with crompton et al 2019 who find similar variability in importance of ϕ perv where k s is greater than rainfall intensity ϕ perv closely predicts infiltration because the pervious areas infiltrate most of the runoff that runs onto them secondly the importance of soil texture decreased with increasing ϕ perv fig 8c and decreasing soil saturation fig 8d while it increased with p fig 8b these results make sense given our understanding of infiltration processes before soils are saturated infiltration occurs at a rate equal to the minimum of rainfall rate and infiltration capacity where infiltration capacity is defined by the infiltration model after saturation infiltration rate decreases to k s it follows that ϕ var would depend more strongly on k s for soils that begin at saturation whereas ϕ var would depend more strongly on p for soils that begin in unsaturated conditions our results indicate that ϕ var is not sensitive to slope total area or width it is important however to consider the modeling framework in which this was determined first the outcome of interest in this study ϕ var was defined by total runoff and infiltration volumes 1 if runon other hydrological outcomes such as peak flow and runoff timing may be more sensitive to slope and width parameters second changes in slope total area and width were simulated in tandem with changes to soil types pervious fractions and rainfall intensities all of which proved to be highly sensitive parameters one can imagine alternative modeling frameworks in which the slope total area and width would be sensitive for example if the pervious area width and thus flow path length were varied independently from the impervious area width 5 2 role of a var and ϕ var in the berkeley sewershed in the berkeley sewershed 27 percent of tia was comprised of a var but the percent of hcia comprised of a var varied depending on rainfall and soil saturation conditions for low rainfall and low soil saturation conditions a var contributed a small amount to overall hcia fig 9 top left conversely a var comprised a larger proportion of hcia for high rainfall and saturated soil conditions 23 percent on average across the study area and in some cases up to 100 percent of subcatchment hcia fig 9 bottom right this suggests that even in landscapes with low amounts of a var relative to other impervious areas and where soil types are assumed to be constant estimates of connected impervious area based only on a phys can significantly underestimate the impervious area that is hydrologically connected a second notable result from the berkeley sewershed case study is that the a var contribution to hcia varied across the precipitation and soil moisture conditions and this variability was not constant across increasing soil moisture conditions or precipitation scenarios a var contribution to hcia was low at low precipitation depths and increased rapidly with increasing precipitation and initial soil moisture conditions however as evidenced by the standard deviations in fig 9 the variability in a var contribution became more constant above moderate rainfall depths above 5 cm and initial soil saturation field capacity i e contribution of a var reaches a maximum as hcia approaches tia 5 3 implications for hydrologic modeling the importance of a var for hcia depends not only on the specific parameters tested in this study but also on the goal of the study or planning effort in areas with relatively low soil permeability such as the berkeley sewershed temporally variable parameters drive connectivity here the contribution of a var to hcia is significant for a wide range of rainfall and antecedent soil moisture conditions therefore both modeling and planning efforts should consider the effect of a var on hcia however in areas with higher soil permeability these temporally varying parameters are less influential relative to spatially varying parameters e g pervious areas downstream in these cases the contribution of a var to hcia across the watershed as a whole is likely to be minimal as ϕ var decreases with increasing permeability but the spatial variability in the contribution of a var to hcia across subcatchments may be significant therefore consideration of a var in these cases depends on the scale of the analysis a var may be less important for analyses concerned with watershed scale runoff in which the variation in a var contribution might average out across the watershed but could be important for those related to spatial variability in runoff or spatial distribution of stormwater controls this study demonstrates the potential to use hydrologic modeling and machine learning to quantify impervious surface connectivity for single event models however additional simulations are needed to cover the range of potential storm distributions and durations the hcia arcgis tool is currently limited to the 24 hr scs type ii rainfall distribution and five rainfall depths and preliminary comparisons indicate that different storm distributions and durations have the potential to significantly alter the resulting connectivity of impervious surfaces see appendix section a 4 the approach applied in this study could be replicated to test the sensitivity of ϕ var to different design storms and durations and the resulting regression tree could be applied in the hcia arcgis tool such an approach would essentially downscale single event swmm overland flow simulation to a quasi distributed hydrologic model in the form of an arcgis tool this would have clear benefits for planners and practitioners hoping to evaluate spatial distribution of overland flow at small subcatchment scales for e g siting distributed stormwater controls a common goal of current hydrological modelling efforts in urban settings while the concept of hcia presented in this study could be potentially useful to planners and practitioners interested in single event storm behavior it may not necessarily be appropriate for use in continuous simulation models by definition hcia is a time varying metric that like eia is storm and landscape specific dependent on storm depth duration land cover patterns soil texture and antecedent soil moisture a single static hcia value will not necessarily represent the impervious source area in a continuous simulation model therefore rather than claiming that the hcia metric presented in this study provides a better estimate of hcia that can or should be incorporated into continuous hydrologic models we offer an approach and complementary geospatial tool for practitioners to apply for event based hydrologic analysis 5 4 limitations and applications of the hcia arcgis tool this research focused on the hydrologic connectivity of impervious surfaces routed to downslope pervious areas and made several simplifying assumptions conceptually the hcia framework and modeling performed in this study presumes that runoff is generated as infiltration excess overland flow while this is a common assumption in urban areas dunne and leopold 1978 horton 1933 there is ample evidence that other runoff mechanisms e g shallow groundwater flow saturation excess overland flow can dominate in some urban areas bhaskar and welty 2015 easton et al 2007 miles and band 2015 practitioners and users of the hcia arcgis tool must be confident that the runoff in the study catchment is generated via infiltration excess rather than saturation excess or groundwater flow further the hcia arcgis tool does not account for effects of spatially varying rainfall which can have a significant effect on runoff chaubey et al 1999 singh 1997 thus the methods presented here may be are more suitable for small watersheds over which spatial variations in storm patterns are minimal secondly as a consequence of the presumed runoff generation mechanism and rainfall patterns this approach assumes that any variation in connectivity is due solely to heterogeneous flow paths and pervious area infiltration it does not consider the impact of depression storage or other non infiltration losses while this assumption may hold true where impervious areas have been recently constructed and have minimal depression storage the accuracy of hcia presented in this study could be further improved by incorporating variability in infiltration across impervious surfaces due to weathering e g potholes cracks and pavement type this variability can be modeled indirectly in the hcia arcgis tool through user specification of ϕ phys or the pyswmm modeling could be revised to include variable depression storage unfortunately however high resolution datasets of pavement condition and type are rare a potentially more fruitful path forward for determining the variability in hcia resulting from non infiltration losses would be to utilize the proposed hcia methods to constrain infiltration losses allowing for calibration of non infiltration losses the hcia framework and results presented here could conceivably be combined with prior research efforts to improve spatially explicit estimates of hcia by further constraining non infiltration losses through recursive validation epps and hathaway 2018 with observed streamflow and runoff data ebrahimian et al 2016 thirdly the hcia arcgis tool requires a user to designate roofs as physically connected or variably connected thus limiting its application in areas where such data is not readily available we present one method for estimating the rooftop physical connectivity via development code review and google maps analysis but acknowledge that lacking detailed site surveys such an analysis presents only an estimate while out of scope of the current study increased resolution of lidar and aerial imagery may give rise to datasets that could be used for the purposes of improving estimates of roof surface connectivity and pavement conditions lastly this study relies on theoretical modeling scenarios rather than empirical or observed data consequently the results of this study are limited to the specific storm and landscape conditions considered in the theoretical modeling scenarios further because these theoretical modeling scenarios are based on swmm overland flow routing non linear reservoir and infiltration green ampt models see appendix section a 1 the results and implications of this hcia arcgis tool are valid provided the assumptions of these runoff and infiltration schemes are met for example because non linear reservoir routing does not simulate surcharging or backflow results of the hcia arcgis tool may be invalid for cases where storm drainage networks are undersized relative to their inflow and surcharging results in backflow onto a phys and a var areas such cases require dynamic runoff routing and hydraulic considerations that are not included in this study while the runoff and infiltration schemes used here are clearly idealized previous studies have validated the non linear flow routing methods for overland flow akram et al 2014 xiong and melching 2005 and green ampt infiltration approach bouwer 1969 1976 childs and bybordi 1969 chu 1978 under a range of conditions despite these limitations the hcia arcgis tool has potential to improve siting and performance of distributed stormwater controls by providing spatially explicit estimates of hydrologically connected impervious area the effectiveness of such distributed stormwater controls depends on location within a watershed and in particular the location relative to heterogeneous flow paths fry and maxwell 2017 jarden et al 2016 di vittorio and ahiablame 2015 for example epps and hathaway 2019 show greater efficiency in runoff reduction from distributed stormwater controls when placed strategically to target hcia compared to more random placement strategies 6 conclusion previous work has defined urban runoff heterogeneity with the metrics dcia and eia however neither metric provides spatially explicit estimates of hydrologically connected impervious areas an inherent limitation of dcia is that it represents connectivity as binary and static i e connected or not connected an assumption which is at odds with the dynamic nature of hydrologic process and connectivity changes in hydrologic pathways and connectivity can occur over time e g with changes to rainfall intensity and space e g with changes in soil infiltration rate eia inherently accounts for these changes to hydrologic pathways but requires hydrologic data which are not always available for urban catchments we used a combination of hydrologic modeling in pyswmm machine learning and geospatial analysis to develop spatially explicit estimates of hydrologically connected impervious areas hcia in ungauged urban catchments that accounts for variability in hydrologic pathways that result from variability in soil types pervious and impervious areas rainfall events and soil moisture conditions study results shed light on variably connected impervious surfaces a var showing that for the storms and soils evaluated soil texture defined by saturated hydraulic conductivity k s is the most important feature determining the degree of impervious surface hydrological connectivity temporal forcing represented by rainfall and antecedent soil moisture control connectivity within watersheds with low permeability soils while spatial flow path variability represented by relative quantity of disconnecting pervious area controls connectivity within watersheds with highly permeable soils these results suggest that for catchments consisting of highly impermeable soils a var contributes to hcia such that hcia approaches tia but for catchments with highly permeable soils a var does not contribute significantly to hcia and thus dcia could be used as a suitable surrogate for hcia in between these two extremes however lies a wide range of conditions that call for detailed and spatially explicit estimates of a var connectivity credit authorship contribution statement anneliese sytsma conceptualization methodology visualization writing original draft writing review editing colin bell conceptualization writing review editing william eisenstein funding acquisition conceptualization supervision writing review editing terri hogue resources supervision writing review editing g mathias kondolf resources supervision writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this material is based upon work supported by the national science foundation s engineering research center for reinventing the nation s urban water infrastructure renuwit eec 1028968 as additional support was provided from the gledden fellowship university of western australia as global metropolitan studies university of california berkeley as and assistance agreement no r836174 awarded by the u s environmental protection agency th any use of trade firm or product names is for descriptive purposes only and does not imply endorsement by the u s government the manuscript has not been formally reviewed by the u s environmental protection agency the views expressed in this document are solely those of the authors and do not necessarily reflect those of the u s environmental protection agency we thank octavia crompton and dana lapides for their detailed review and feedback on this manuscript and chelsea panos for general support and providing the berkeley lake data sources additional thanks go to sally thompson john radke and iryna dronova for their support in development of these concepts and methods appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2020 125545 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
5096,recent studies have reported that connected impervious areas those impervious surfaces that contribute directly to runoff in a storm network or stream are a better indicator of hydrologic response stream alteration and water quality than total impervious area however most methods for quantifying connected impervious areas require major assumptions regarding the definition of connection potentially over simplifying the role of variable climates slope gradients soils conditions and heterogeneous flow paths on impervious surface connectivity this study presents a new conceptual model and method for estimating hydrologically connected impervious areas hcia that explicitly considers the effect of landscape and storm variability the model separates impervious surfaces into two categories directly or physically connected a phys and variably connected a var impervious that drains to pervious of these categories we investigated the sensitivity of a var connectivity to varying soil conditions slope gradients rainfall properties and hillslope geometry using pyswmm a python interface for swmm5 simulations spanned a large parameter space with varying soil slope rainfall properties and geometries i e relationships between the impervious and downslope pervious areas pyswmm simulations were used to train and test a regression tree that predicts infiltration and connectivity of runoff from a var surfaces which provides excellent fidelity with pyswmm outcomes to enable use of these methods in practice we developed an arcgis tool that 1 delineates subcatchments 2 extracts the impervious surface categories a phys and a var 3 applies the regression tree algorithm to predict the fraction of incident rainfall that produces runoff across a var and 4 summarizes the resulting hcia by subcatchment analysis of the regression feature importance shows that in general a var connectivity is highly sensitive to the soil type rainfall depth area fraction and antecedent soil moisture conditions of the downslope pervious area we find that temporally varying parameters e g rainfall and antecedent soil moisture control a var connectivity in areas with low permeability soils while spatial flow path variability e g relative quantity of disconnecting pervious area controls a var connectivity in areas with highly permeable soils the methods developed in this study can be used to identify impervious surface connectivity more accurately in urban watersheds representing an important step forward for incorporating spatial heterogeneity in stormwater modeling and planning keywords hydrologically connected impervious areas urban runoff modeling regression tree analysis geospatial modeling swmm 1 introduction increased urbanization involves increased extent of impervious surfaces such as roads parking lots and rooftops these surfaces prevent infiltration of rainwater and instead shed water by surface runoff into streams increasing storm runoff for a given rainfall leopold 1968 thereby increasing the erosive force of stormflows which in turn causes erosion of stream beds and banks booth and jackson 1997 gillies et al 2003 walsh et al 2005 by eliminating infiltration and the filtering effect of rainwater flowing through soil pollutants accumulate on roads parking lots and rooftops and polluted runoff from these impervious surfaces flows directly untreated into receiving lakes bays and streams as non point source pollution arnold and gibbons 1996 by virtue of its easy quantification via mapping from aerial imagery total impervious area tia the total area occupied by impervious surfaces has long been used as an indicator of the degree of urbanization and consequent effects of urbanization on hydrologic conditions however tia does not distinguish between impervious areas that are directly connected to streams being adjacent or connected via stormwater pipes from those that are distant and whose runoff flows over pervious surfaces if runoff from such an impervious surface infiltrates prior to reaching the stream it is effectively disconnected as it does not contribute directly to storm response in the stream conversely if its runoff does not infiltrate but rather saturates the downslope pervious area and produces runoff that reaches the stream channel it is termed indirectly connected boyd et al 1993 tia lumps directly connected disconnected and indirectly connected together and thus is limited in its ability to predict runoff at local scales mcgrane 2016 crompton et al 2019 fletcher et al 2013 lim 2016 zhang and shuster 2014 the metric directly connected impervious area dcia was introduced to measure impervious areas that are physically connected to the stormwater network or stream channel and can be mapped directly though it may require information beyond that available from aerial imagery such as maps of storm drainage infrastructure e g hwang et al 2017 lee and heaney 2003 seo et al 2013 while the runoff from directly connected surfaces may be straightforward to measure and model runoff from indirectly connected impervious areas is more complicated because it depends on how much runoff is infiltrated into pervious areas before reaching a stream which depends on the flow path length and slope over pervious soils and their infiltration rate infiltration rate is affected by soil texture surface roughness vegetative cover and soil moisture content or saturation which is influenced by antecedent rainfall infiltration can also occur in surfaces that we consider to be impervious e g through cracks in asphalt or concrete in an attempt to account for the combined effect of these various factors the metric effective impervious area eia was introduced by miller 1978 epps and hathaway 2018 while eia and dcia are sometimes used interchangeably their methods of estimation differ rather than being mapped directly from surface features eia is typically back calculated from streamflow and rainfall e g boyd et al 1993 ebrahimian et al 2016 epps and hathaway 2019 han and burian 2009 roy and shuster 2009 walsh et al 2005 or determined through model calibration e g mcnamee et al 1994 sutherland 1995 eia therefore implicitly accounts for catchment characteristics affecting hydrologic response e g soils slope surface roughness spatial patterns and rainfall because eia relies on stream flow and rainfall inputs it is limited to the scale and locations at which these data are available which despite continuous efforts to accumulate hydrological data is lacking in most catchments of the world blöschl 2005 tegegne and kim 2018 dcia is mapped directly so its quantification does not depend on stream flow or rainfall data availability spatially explicit maps of impervious surface connection inherently assume that physical connectivity is indicative of hydrological connectivity these two types of connectivity may differ bracken and croke 2007 physical connectivity refers to the physical connection of points lines or polygons while hydrologic connectivity refers to the connectivity of water pathways across a landscape physical connectivity metrics such as dcia and tia do not implicitly account for hydrologic processes or interactions so they may or may not correlate with actual hydrologic connectivity bracken et al 2013 bracken and croke 2007 lexartza artza and wainwright 2009 for example impervious areas which are physically and hydrologically disconnected under certain rainfall scenarios may become hydrologically connected under more intense rainfall scenarios as downslope pervious patches become saturated the shortcomings of eia and dcia as reflected in the methods used to produce them present both a challenge and an opportunity to improve our understanding of controls on the hydrologic contribution of impervious surfaces across heterogeneous flow paths in this study we define a third metric hydrologically connected impervious areas hcia to refer to spatially explicit mapped estimates of the proportion of impervious surfaces that are hydrologically connected to the storm sewer system or stream network here we use impervious and pervious as contrasting terms but acknowledge that this is a simplification of the continuum of conditions that exist hcia depends on both the physical connectivity of impervious areas explicitly quantified by dcia and the hydro geomorphic conditions e g soil moisture conditions soil types rainfall rate geology which are implicitly incorporated in the quantification of eia current methods for spatially explicit eia estimation require rainfall and runoff datasets e g ebrahimian et al 2016 epps and hathaway 2018 the use of high resolution ecohydrological models easton et al 2007 miles and band 2015 or geo statistical analyses ebrahimian et al 2016 lim 2016 consequently these efforts are often site specific and extrapolation of their results to other watersheds is limited thus a generalizable approach for estimating hydrologically connected impervious areas is needed the incremental contribution of the present study is to i explicitly define controls on impervious surface hydrologic connectivity and ii to present a generalizable model to predict and map hydrologically connected impervious areas including indirectly connected impervious areas in this study we evaluated the controls on impervious surface runoff contribution by varying spatial arrangements of impervious pervious areas rainfall depth soil types and antecedent soil moisture conditions to facilitate dissemination into practice we developed a transferable arcgis tool that provides estimates of hcia across urban watersheds and we present a case study of the arcgis tool applied to a residential sewershed in colorado usa 2 conceptual model of hydrologically connected impervious areas we define total impervious area within a catchment by two impervious surface categories rooftops a roof and ground level impervious a ground so that tia a r o o f a g r o u n d fig 1 the portion of a roof and a ground that are both physically and hydrologically connected to the storm drainage system are considered physically contributing impervious a phys those portions of a roof and a ground that are not physically connected to the storm drainage network but rather produce runoff that flows as runon to pervious areas are considered variably contributing impervious a var the total hydrologically connected impervious areas hcia along the flow path shown in fig 1 can thus be described as 1 h c i a ϕ p h y s a p h y s ϕ v a r a v a r where ϕ phys and ϕ var refer to the fraction of incident rainfall that contributes to runoff response on physically connected surfaces a phys and variably connected surfaces a var respectively a phys and a var are further defined as 2 a p h y s a p h y s r o o f a p h y s g r o u n d 3 a v a r a v a r r o o f a v a r g r o u n d where a phys roof and a phys ground refer to the physically connected roof and ground level impervious areas and a var roof and a var ground refer to the variably connected roof and ground level impervious areas respectively 2 1 determining a phys and a var remote sensing data can be used to classify types of impervious surfaces into rooftop a roof and ground level impervious areas a ground ground level impervious areas can be further separated into a phys ground and a var ground using a combination of high resolution digital elevation models dem flow paths and drainage networks han and burian 2009 remote sensing datasets alone cannot directly discern physically or variably connected rooftop areas a phys roof or a var roof han and burian 2009 redfern et al 2016 because buildings may pipe roof runoff directly to the storm drainage system consequently determining an accurate estimate of a phys roof and a var roof may require site specific and time intensive surveys and field investigations han and burian 2009 roy and shuster 2009 the few studies that have endeavored in such time intensive surveys often report rooftop connectivity values by land use class e g alley and veenhuis 1983 lee and heaney 2003 these averages are sometimes applied to other study areas as an estimate of rooftop connection han and burian 2009 however there are a range of local variables e g land use history development codes local retrofit programs and homeowner preference that influence the connectivity of roof areas indeed there is a wide range of rooftop connectivity values even within specific land use categories reported in the literature ebrahimian et al 2016 suggesting that land use is a poor predictor of connectivity across different jurisdictions jurisdiction specific rooftop connectivity surveys however may provide a reasonable estimate for a phys roof or a var roof particularly if these surveys are paired with review of development codes and development history of the region 2 2 determining ϕ phys and ϕ var estimating the hydrologic contribution of a phys and a var presents a separate challenge because a phys does not encounter pervious areas en route to the stormwater network losses along its flow path are likely to be limited to storage depression and initial abstractions for simplicity we assume here that ϕ phys is some constant value 1 we note however that previous research has shown significant variability in the fraction of rainfall that produces runoff redfern et al 2016 with values ranging from 0 09 on brick areas mansell and rollet 2006 to 0 16 on deteriorated asphalt concrete to 0 74 on asphalt concrete in good condition ramier et al 2004 there are also cases in which ϕ phys may be greater than 1 for example if a rain event exceeds the capacity of the downstream drainage system overflow from a phys may be routed to a var in contrast a var surfaces are routed to pervious areas therefore their connectivity fractions ϕ var are likely to be subject to time varying infiltration loss and depend on factors like downslope pervious areas soil conditions slope and rainfall intensity crompton et al 2019 pappas et al 2008 shuster et al 2008 zhang and shuster 2014 the remainder of this study focuses first on defining the factors that influence ϕ var and second on developing geospatial methods for extracting areas of these impervious surface connectivity types a phys and a var applying respective connectivity fractions ϕ phys and ϕ var and estimating hcia for ungauged catchments 3 methods 3 1 overview our approach involves three main steps shown schematically in fig 2 and described below first we utilized a python interface for the stormwater management model pyswmm to model factors that could influence ϕ var we simulated infiltration and runoff across a range of pervious area fractions soil textures antecedent soil moisture conditions slopes and rainfall scenarios section 3 2 second we developed a generalized relationship for ϕ var as a function of these factors using a regression tree algorithm section 3 3 third we developed an arcgis tool that implements the proposed conceptual framework to estimate hcia by identifying the impervious surface categories a var and a phys and applying their respective connectivity fractions ϕ var and ϕ phys section 3 4 as a case study we tested this arcgis tool in the berkeley lake sewershed in colorado usa section 3 5 3 2 pyswmm modeling to evaluate controls on ϕ var to determine the sensitivity of a var connectivity to various landscape and storm parameters we considered only a var surfaces at the ground level temporarily ignoring effects of a roof and a phys we used pyswmm to simulate runoff and infiltration at the outlet of an idealized catchment consisting of an impervious area a var routed to a downslope pervious area a perv we conducted a total of 60 000 model simulations across two parameter sets 1 150 plausible rainfall soil moisture and soil texture scenarios and 2 400 geometric parameter combinations total area width pervious fraction and slope the 150 rainfall soil moisture and soil texture scenarios table 1 represent factorial combinations of ten pervious area soil textures four slopes five 24 hour rainfall depths and three antecedent soil moisture conditions asm we used the swmm modified green ampt infiltration model to simulate infiltration in pervious areas green ampt infiltration parameters saturated hydraulic conductivity k s suction head ψ f and porosity n for the ten different soil textures were taken from rawls et al 1983 initial moisture deficit imd the difference between initial soil moisture θ i and saturated soil moisture θ s varied according to the three asm conditions and the soil porosity n saturated soils imd 0 field capacity imd n θ i fc and wilting point imd n θ i wp table 2 see appendix section a 1 for additional detail on the swmm modified green ampt infiltration model we used the scs type ii 24 hr synthetic storm distribution which typifies high intensity rainstorms and applies to the majority of the us by land area usda 1986 the five rainfall depths p ranged from 5 mm to 102 mm 0 6 in to 4 in encompassing 95 percent of daily rainfall values across the us shrestha et al 2013 the 400 geometric parameter values represented combinations of total area a equal to a var a perv pervious fraction ϕ perv equal to a var a catchment width w and slope s a ϕ perv and w parameter values were generated from 100 random values with a ranging from 0 to 1 ha 0 to 10 000 square meters ϕ perv from 1 to 100 percent of the total area overland flow length l from 0 to 152 m or 500 feet the maximum likely overland flow length james et al 2010 and thus width w from 0 to a l slope ranged from 1 to 4 the limited slope range was selected because the majority of urban surfaces e g roads sidewalks parking lots have cross slopes less than 4 e g city of seattle 2020 jefferson county 2019 and because slope has been shown to have a limited effect on runoff volumes crompton et al 2019 manning s roughness values for impervious and pervious areas n imperv and n perv as well as depression storage values d store imperv and d store perv were held constant across simulations for each simulation we calculated ϕ var as 1 if runon where if runon was defined as the fraction of total a var runoff that infiltrates in the downslope a perv it is important to note that because the aim of this model was to simulate connectivity of impervious surfaces if runon does not represent the fraction of total inflow that infiltrates but rather the fraction of impervious runon that infiltrates see appendix section a 2 for additional detail the outcomes of the pyswmm simulations were compiled in python and the sensitivity of ϕ var to the different rainfall soil moisture soil texture scenarios and subcatchment characteristics were evaluated using boxplots 3 3 regression tree to predict ϕ var the large simulation space 60 000 simulations presented an opportunity to relate the predictor variables p asm soil texture s a ϕ perv w to the hydrologic outcome of interest ϕ var however as is the case with many hydrological variables iorgulescu and beven 2004 the relationships between these predictor variables and ϕ var is nonlinear and thus not well explained by global linear or polynomial regressions in which a single formula is expected to hold over the entire dataset supervised machine learning algorithms such as regression trees are being increasingly applied to hydrological science questions due to their ability to make predictions quickly and to distinguish sensitive variables from non sensitive variables iorgulescu and beven 2004 tyralis et al 2019 here we used a regression tree one such supervised machine learning algorithm to predict ϕ var from the predictor variables and to evaluate the relative importance of these variables for predicting ϕ var regression trees can be used to estimate a response variable from multiple input variables by building a set of decision rules on the predictor variables breiman 1984 prasad et al 2006 tyralis et al 2019 the decision rules apply recursive partitioning to the variable space lawrence and wright 2001 prasad et al 2006 subdividing the dataset into smaller more manageable chunks of data over which predictions can be made tyralis et al 2019 the number of tree branches leaf nodes and features considered when splitting a node are the tree hyperparameters which are tuned prior to training the regression tree the following sections describe the process used to develop the ϕ var regression tree 3 3 1 cross validation to avoid overfitting in machine learning algorithms such as regression trees a model should be validated using new testing data on which it has not been trained in cross validation the data is partitioned into n equal sized subsamples or folds for each of the n folds n 1 folds are used to train a model and the remaining fold is used for model validation this process is repeated a total of n times until each fold serves as the validation set thus the overall performance is evaluated on data that was not used to train the model with each observation contributing exactly once to validation reid et al 2015 after partitioning the pyswmm simulation outcomes into training and testing sets using a 70 30 split we used a 10 fold cross validation process on the training set to define the model hyperparameters section 3 3 2 select model features section 3 3 3 and evaluate the performance of the final model section 3 3 4 for each of the 10 folds we computed the mean square error mse between ϕ var as determined by the regression and pyswmm 4 m s e 1 m i 1 m y i y i 2 where yi is the pyswmm prediction for ϕ var taken as the observed value yi is the regression tree prediction for ϕ var taken as the predicted value and m is the number of predictions made within the fold the overall cross validated error msecv was computed as the average mse across the 10 folds 3 3 2 hyperparameter tuning regression tree hyperparameters control the regressor s flexibility and adaptability to the training data careful tuning of hyperparameters can improve generalizability of the model and prevent overfitting of the data we defined the hyperparameter grid composed of hyperparameter ranges then used a random search algorithm to sample 100 random values from the hyperparameter grid we performed 10 fold cross validation for each combination of grid values resulting in 1000 total fittings we then selected the set of hyperparameters that minimized msecv and used these as the hyperparameters in the final model details and results of the hyperparameter tuning process are included in appendix section a 3 3 3 3 feature importance and selection we computed the regression tree feature importance with the gini importance index to evaluate the relative significance of model features i e the independent variables in predicting ϕ var the gini importance index represents the mean decrease in node impurity resulting from splitting weighted by the probability of reaching a node tyralis et al 2019 the higher the feature importance the more significant that feature is relative to others for predicting response the feature importance values were then used to choose a parsimonious subset of the predictor variables model features that can predict the outcome with accuracy comparable to the performance of the complete input set but with greater computational efficiency 3 3 4 model performance we assessed performance of the regression tree model defined by tuned hyperparameters and selected features using 10 fold cross validation on the training dataset to confirm that the final regression tree performed consistently on data on which it was not trained we also evaluated the performance of the model on the held out testing dataset after estimating model performance we fit a regression tree with the entire dataset 60 000 simulations and then exported it into a format readable by arcpython for implementation in the arcgis tool see section 3 4 3 3 5 sub tree feature analysis the feature importance metric described in section 3 3 3 provided insight into how connectivity varies across different storms given by rainfall and landscape geometries given by geometric parameters or conditions given by soil type and antecedent soil moisture such an analysis does not provide insight into the relative importance of these features within a given storm or landscape for example which parameter s control hydrologic connectivity in a landscape with a specific soil type or for a particular storm to develop a better understanding of within storm landscape hydrologic controls we additionally trained and tested separate regression trees for specific subsets of the dataset table 3 which we refer to as sub trees and evaluated feature importance across these sub trees these sub trees were analyzed to illustrate potential within storm landscape controls on connectivity and were not used in any subsequent analysis or within the arcgis tool 3 4 arcgis tool the hcia arcgis tool consists of four main steps 1 dem processing and subcatchment delineation 2 extracting the impervious area connectivity types a phys and a var 3 defining connectivity fractions ϕ phys and ϕ var and 4 computing hcia for each subcatchment each step is summarized below and the hcia arcgis tool and its full documentation are available for download on github https github com anneliesesytsma hydro imperv 3 4 1 step 1 dem processing and delineating subcatchment inputs to this step are a high resolution e g 1 m digital elevation model dem raster stormwater inlets that represent the outlet of the subcatchment to be modeled e g catch basin or manhole points and a stormwater network of pipes and ditches polyline in this step the dem is processed to remove sinks compute the flow direction and flow accumulation rasters and extract the stream network the subcatchments draining to each stormwater inlet are delineated using archydro tools 3 4 2 step 2 classifying impervious areas a phys a var inputs to this step are the dem and subcatchments from step 1 as well as impervious surfaces separated into ground level impervious and rooftops shapefile in this step an iterative process is used to classify a phys and a var for ground surface impervious and rooftop impervious areas first an initial guess of physically connected impervious a phys o is made physical connectivity of rooftops is based on user input data from e g land use assumptions or field investigations and physically connected ground level impervious is based on intersection with the stormwater inlet points an initial guess of variably connected impervious a var roof o and a var ground o comprise the remaining a roof and a ground surfaces respectively pervious area flow paths downstream of a var roof o and a var ground o areas are quantified using cost distance allocation and cost path functions impervious areas with downslope flow paths over pervious areas are designated as a var this process assumes that the building downspouts are located on the downslope most edge of a var roof o areas the remaining a var roof o and a var ground o areas with no downslope pervious flow paths are then added to a phys o to give a phys 3 4 3 step 3 defining ϕ phys and ϕ var the next step in the hcia arcgis tool applies connectivity fractions ϕ phys and ϕ var to their respective areas within each subcatchment the user supplies a constant value for ϕ phys ranging from 0 to 1 and specifies the scenarios on which ϕ var is computed p asm and soil texture class ϕ phys is applied to all a phys surfaces including rooftops and ground level impervious a phys areas the regression tree algorithm is used to predict ϕ var for each a var as it depends on the user selected scenario as well as on the geometric characteristics of the a var and a perv surfaces determining the relevant geometric characteristics for the regression tree algorithm requires developing representative rectangular polygons from irregularly shaped a var and a perv surfaces the process used to represent a var and a perv as rectangles is shown in fig 3 first a characteristic width w is computed by dividing a var by its maximum overland flow path length l var next a perv is computed by multiplying w by the distance from the centroid of a var to the nearest downslope a phys l perv finally ϕ perv is computed by dividing a perv by the total area a var a perv 3 4 4 step 4 computing hcia the final step in the hcia arcgis tool involves computing the hcia within each subcatchment each a phys are is multiplied by ϕ phys and each a var area is multiplied by its computed value of ϕ var the sum of these products within each subcatchment comprises the subcatchment hcia see eqs 1 3 the percent hcia within each subcatchment is then calculated as the fraction of total impervious area comprised of hcia hcia tia 3 5 case study as a test case we applied the hcia arcgis tool to the berkeley neighborhood in northwest denver colorado fig 4 the study area is a 4 7 square kilometer sewershed in the berkeley neighborhood hereon referred to as the berkeley sewershed and is primarily comprised of single family residential land use 54 parks and recreation areas 18 and multifamily units 10 panos et al 2018 the majority of buildings in the study area were constructed between the early 1900s and the 1980s denver open data catalog 2020 though the neighborhood has been subject to intense infill development in recent years cherry et al 2019 panos et al 2018 impervious surfaces comprise 53 percent of the total sewershed area in 2014 the 2 year 5 year and 10 year 24 hour scs type ii storms for this area correspond to rainfall depths of 4 6 5 9 and 7 1 cm respectively panos et al 2020 no soil data are available for the area in the ssurgo nrcs soil survey but near by area soil textures are classified as c type clay and loam panos et al 2018 overland flow and stormwater pipes through the sewershed route stormwater runoff from the south elevation 1670 m to the north elevation 1630 m ultimately discharging into clear creek fig 5 3 5 1 input data shapefiles of stormwater inlet points manholes and catch basins the stormwater network and impervious surfaces were provided by the city and county of denver community planning and development department cpd as used in the modeling efforts performed by panos et al 2018 the impervious surface shapefile from cpd distinguishes roofs roads and other impervious areas these were summarized into roofs a roof and ground level impervious a ground a 1 m digital elevation model dem of the study area was downloaded from the u s geological survey usgs national elevation dataset u s geological survey 2017 flow paths and subcatchments draining to inlet points were delineated using the 1 meter dem 3 5 2 estimating a phys and a var to develop an initial estimate of roof connectivity a phys roof o we evaluated current and historical development codes in the city of denver for requirements pertaining to roof drainage gutters and downspouts the denver building code dbc of 1881 required that all buildings shall be provided with proper metallic leaders to conduct water from the roof which shall be connected with the sewer or street gutter 21 pp 11 denver building code 1881 which was modified in 1898 to no water shall be discharged from conductor pipe upon any sidewalk but shall be conducted underneath the walk in iron or tile pipes 145 pp 49 denver building code 1898 beginning in 1976 new construction was not permitted to pipe roof discharge directly to the street or storm sewer network rather external roof downspouts were to discharge to concrete blocks at least 12 in in width by 36 in in length except for roofs that drain to the interior of the building 3211 pp 32 12 denver building code 1976 interior roof drains are not common in residential development but are used for commercial and industrial development with flat or internally sloped roofs the 2018 international plumbing code adopted by the city of denver per the 2019 denver building and fire code denver building 2019 requires roof runoff from one and two family dwellings to discharge to flat areas such as lawns where possible 1101 2 international plumbing code 2018 visual inspection using google street views and google maps confirmed that most houses in the neighborhood have visible downspout extensions that route roof runoff to gardens or lawns while most commercial buildings with flat rooftops appear to use internal roof drainage visible from satellite imagery and no downspouts are visible from the outside therefore as an initial estimate of roof connectivity we assumed that all roof areas within commercial industrial land use are physically connected a phys roof o and all roofs within all other land use designations primarily residential are variably connected a var roof o ground level impervious surfaces that intersected with the drainage network were initially assumed to be physically connected a phys ground o all other ground level impervious were designated as a var ground o final estimates of a phys roof a var roof a phys ground and a var ground were then determined per the methods described in section 3 4 step 2 3 5 3 ϕ phys and ϕ var scenarios for simplicity we assumed that all a phys surfaces are 100 percent connected ϕ phys 1 but note that other values for ϕ phys could be applied in the hcia arcgis tool ϕ var estimation requires user input for the hcia scenario p asm and soil texture class step 3 lacking soil survey data in the catchment we used the near by area soil texture predominantly c type clay and loam panos et al 2018 to stay within the soil parameters used to develop the regression tree we assumed soil parameters that represent typical silty clay loam soils with k s of 1 mm h see table 2 since asm and p are temporally varying we computed hcia across 3 asm conditions and 5 p scenarios for a total of 15 estimates of hcia across the berkeley sewershed total hcia and percent hcia within each subcatchment were computed following methods outlined in section 3 4 step 4 for each of the 15 asm and p scenarios 4 results 4 1 connectivity of impervious surfaces is sensitive to soil texture soil moisture rainfall and pervious area fraction the sensitivity of ϕ var to soil texture soil moisture and rainfall scenarios soil texture asm and p and geometric parameters ϕ perv a w and s is shown in fig 6 soil texture given by k s is the most sensitive model parameter with median ϕ var values ranging from 0 to 0 98 fig 6a though not as sensitive as soil texture asm also affects ϕ var with saturated scenarios resulting in less infiltration median ϕ var 0 74 than soils at field capacity or wilting point fig 6c the five rainfall depths also resulted in a range of median ϕ var from 0 34 to 0 84 fig 6e with higher ϕ var resulting from higher rainfall depths of the geometric parameters tested ϕ var is highly sensitive to ϕ perv fig 6b but insensitive to s w and a fig 6d f and g these plots also illustrate the complex interactions and non linearity between these parameters and ϕ var for example even for very low ϕ perv values ϕ var ranges from 0 to 1 fig 6b suggesting a different parameter or combination of parameters controls ϕ var in these cases additionally while ϕ var generally decreases with increasingly permeable soils there are some cases in which ϕ var for high permeability soils e g k s 120 4 mm h exceeds that of lower permeability soils e g k s 0 3 mm h as indicated by the outlier points on fig 6a this suggests that the effect of low k s on ϕ var may be moderated or exacerbated by other sensitive parameters for example if k s 0 3 mm hr ϕ perv 0 8 asm wp and p 1 5 cm ϕ var could be relatively low despite the highly impermeable soils 4 2 importance of storm landscape features can vary across and within landscapes of the four features selected for the final model ϕ perv p asm and soil texture represented by k s the most important feature is soil texture followed by p ϕ perv and asm fig 7 a this suggests that across storm landscape scenarios ϕ var is primarily controlled by soil texture these results are consistent with the pyswmm sensitivity analysis section 4 1 which showed that ϕ perv soil texture p and asm are sensitive parameters while s a and w are relatively insensitive the final model which incorporates the four most important features and optimal hyperparameters resulted in an msecv of 0 003 and r2 of 0 97 fig 7b the importance of each of the final model features varies across the eight sub trees fig 8 illustrating the effects of within storm landscape variability on the features that control ϕ var for example for the sandy soil sub tree a regression tree trained only on simulations with sandy soils k s 120 4 mm h ϕ perv and to a lesser extent p are the most important features fig 8a note that soil texture or k s is not important in these scenarios as it is no longer varying however as k s decreases associated here with clay soil texture the importance of ϕ perv decreases and that of p increases fig 8a while k s is clearly the most important feature across all three antecedent soil moisture conditions it is more important for the case of saturated soils asm saturated it decreases in importance for drier soils asm wilting point while the importance of other parameters p and ϕ perv increases fig 8d 4 3 application of hcia arcgis tool to the berkeley sewershed across the berkeley sewershed subcatchments we found that ground level impervious a ground comprised 63 percent and rooftop impervious a roof comprised 37 percent of the total subcatchment impervious areas a total of 87 percent of a ground and 48 percent of a roof were found to be physically connected a phys therefore comprised the majority 73 percent of all impervious surfaces in the study area fig 9 shows the spatial variability in contribution of a var to hcia across the study area subcatchments for the three antecedent soil moisture conditions and five precipitation depths the contribution of a var to hcia generally increased with increasing p and increasingly saturated soils the standard deviation in a var contribution to hcia across subcatchments also generally increased with p and soil saturation this illustrates the divergence between subcatchments comprised of a var and those comprised mostly of a phys while a var contribution changed with p and asm a phys contribution remained constant interestingly the a var contribution to hcia did not vary between field capacity and wilting point soil conditions where p 2 5 cm suggesting that for higher storm depths and intensities the difference between various initially non saturated soil conditions may be negligible 5 discussion 5 1 controls on hydrologic connectivity we found that the factors that exhibit the strongest control on a var connectivity are rainfall depth p antecedent soil moisture asm pervious area soil texture represented by k s and the amount of downslope pervious area relative to total area given by ϕ perv fig 7a soil texture was the most important parameter across all simulations however we observed two key shifts in feature importance when different parameters such as soil texture are held constant first for impervious routed to highly permeable soils i e where soil k s rainfall intensity ϕ perv was the most important feature as shown for sand in fig 8a however with increasingly impermeable soils p became the most important feature this suggests that in urban areas with predominantly impermeable soils p controls connectivity of impervious areas more than ϕ perv these results are consistent with crompton et al 2019 who find similar variability in importance of ϕ perv where k s is greater than rainfall intensity ϕ perv closely predicts infiltration because the pervious areas infiltrate most of the runoff that runs onto them secondly the importance of soil texture decreased with increasing ϕ perv fig 8c and decreasing soil saturation fig 8d while it increased with p fig 8b these results make sense given our understanding of infiltration processes before soils are saturated infiltration occurs at a rate equal to the minimum of rainfall rate and infiltration capacity where infiltration capacity is defined by the infiltration model after saturation infiltration rate decreases to k s it follows that ϕ var would depend more strongly on k s for soils that begin at saturation whereas ϕ var would depend more strongly on p for soils that begin in unsaturated conditions our results indicate that ϕ var is not sensitive to slope total area or width it is important however to consider the modeling framework in which this was determined first the outcome of interest in this study ϕ var was defined by total runoff and infiltration volumes 1 if runon other hydrological outcomes such as peak flow and runoff timing may be more sensitive to slope and width parameters second changes in slope total area and width were simulated in tandem with changes to soil types pervious fractions and rainfall intensities all of which proved to be highly sensitive parameters one can imagine alternative modeling frameworks in which the slope total area and width would be sensitive for example if the pervious area width and thus flow path length were varied independently from the impervious area width 5 2 role of a var and ϕ var in the berkeley sewershed in the berkeley sewershed 27 percent of tia was comprised of a var but the percent of hcia comprised of a var varied depending on rainfall and soil saturation conditions for low rainfall and low soil saturation conditions a var contributed a small amount to overall hcia fig 9 top left conversely a var comprised a larger proportion of hcia for high rainfall and saturated soil conditions 23 percent on average across the study area and in some cases up to 100 percent of subcatchment hcia fig 9 bottom right this suggests that even in landscapes with low amounts of a var relative to other impervious areas and where soil types are assumed to be constant estimates of connected impervious area based only on a phys can significantly underestimate the impervious area that is hydrologically connected a second notable result from the berkeley sewershed case study is that the a var contribution to hcia varied across the precipitation and soil moisture conditions and this variability was not constant across increasing soil moisture conditions or precipitation scenarios a var contribution to hcia was low at low precipitation depths and increased rapidly with increasing precipitation and initial soil moisture conditions however as evidenced by the standard deviations in fig 9 the variability in a var contribution became more constant above moderate rainfall depths above 5 cm and initial soil saturation field capacity i e contribution of a var reaches a maximum as hcia approaches tia 5 3 implications for hydrologic modeling the importance of a var for hcia depends not only on the specific parameters tested in this study but also on the goal of the study or planning effort in areas with relatively low soil permeability such as the berkeley sewershed temporally variable parameters drive connectivity here the contribution of a var to hcia is significant for a wide range of rainfall and antecedent soil moisture conditions therefore both modeling and planning efforts should consider the effect of a var on hcia however in areas with higher soil permeability these temporally varying parameters are less influential relative to spatially varying parameters e g pervious areas downstream in these cases the contribution of a var to hcia across the watershed as a whole is likely to be minimal as ϕ var decreases with increasing permeability but the spatial variability in the contribution of a var to hcia across subcatchments may be significant therefore consideration of a var in these cases depends on the scale of the analysis a var may be less important for analyses concerned with watershed scale runoff in which the variation in a var contribution might average out across the watershed but could be important for those related to spatial variability in runoff or spatial distribution of stormwater controls this study demonstrates the potential to use hydrologic modeling and machine learning to quantify impervious surface connectivity for single event models however additional simulations are needed to cover the range of potential storm distributions and durations the hcia arcgis tool is currently limited to the 24 hr scs type ii rainfall distribution and five rainfall depths and preliminary comparisons indicate that different storm distributions and durations have the potential to significantly alter the resulting connectivity of impervious surfaces see appendix section a 4 the approach applied in this study could be replicated to test the sensitivity of ϕ var to different design storms and durations and the resulting regression tree could be applied in the hcia arcgis tool such an approach would essentially downscale single event swmm overland flow simulation to a quasi distributed hydrologic model in the form of an arcgis tool this would have clear benefits for planners and practitioners hoping to evaluate spatial distribution of overland flow at small subcatchment scales for e g siting distributed stormwater controls a common goal of current hydrological modelling efforts in urban settings while the concept of hcia presented in this study could be potentially useful to planners and practitioners interested in single event storm behavior it may not necessarily be appropriate for use in continuous simulation models by definition hcia is a time varying metric that like eia is storm and landscape specific dependent on storm depth duration land cover patterns soil texture and antecedent soil moisture a single static hcia value will not necessarily represent the impervious source area in a continuous simulation model therefore rather than claiming that the hcia metric presented in this study provides a better estimate of hcia that can or should be incorporated into continuous hydrologic models we offer an approach and complementary geospatial tool for practitioners to apply for event based hydrologic analysis 5 4 limitations and applications of the hcia arcgis tool this research focused on the hydrologic connectivity of impervious surfaces routed to downslope pervious areas and made several simplifying assumptions conceptually the hcia framework and modeling performed in this study presumes that runoff is generated as infiltration excess overland flow while this is a common assumption in urban areas dunne and leopold 1978 horton 1933 there is ample evidence that other runoff mechanisms e g shallow groundwater flow saturation excess overland flow can dominate in some urban areas bhaskar and welty 2015 easton et al 2007 miles and band 2015 practitioners and users of the hcia arcgis tool must be confident that the runoff in the study catchment is generated via infiltration excess rather than saturation excess or groundwater flow further the hcia arcgis tool does not account for effects of spatially varying rainfall which can have a significant effect on runoff chaubey et al 1999 singh 1997 thus the methods presented here may be are more suitable for small watersheds over which spatial variations in storm patterns are minimal secondly as a consequence of the presumed runoff generation mechanism and rainfall patterns this approach assumes that any variation in connectivity is due solely to heterogeneous flow paths and pervious area infiltration it does not consider the impact of depression storage or other non infiltration losses while this assumption may hold true where impervious areas have been recently constructed and have minimal depression storage the accuracy of hcia presented in this study could be further improved by incorporating variability in infiltration across impervious surfaces due to weathering e g potholes cracks and pavement type this variability can be modeled indirectly in the hcia arcgis tool through user specification of ϕ phys or the pyswmm modeling could be revised to include variable depression storage unfortunately however high resolution datasets of pavement condition and type are rare a potentially more fruitful path forward for determining the variability in hcia resulting from non infiltration losses would be to utilize the proposed hcia methods to constrain infiltration losses allowing for calibration of non infiltration losses the hcia framework and results presented here could conceivably be combined with prior research efforts to improve spatially explicit estimates of hcia by further constraining non infiltration losses through recursive validation epps and hathaway 2018 with observed streamflow and runoff data ebrahimian et al 2016 thirdly the hcia arcgis tool requires a user to designate roofs as physically connected or variably connected thus limiting its application in areas where such data is not readily available we present one method for estimating the rooftop physical connectivity via development code review and google maps analysis but acknowledge that lacking detailed site surveys such an analysis presents only an estimate while out of scope of the current study increased resolution of lidar and aerial imagery may give rise to datasets that could be used for the purposes of improving estimates of roof surface connectivity and pavement conditions lastly this study relies on theoretical modeling scenarios rather than empirical or observed data consequently the results of this study are limited to the specific storm and landscape conditions considered in the theoretical modeling scenarios further because these theoretical modeling scenarios are based on swmm overland flow routing non linear reservoir and infiltration green ampt models see appendix section a 1 the results and implications of this hcia arcgis tool are valid provided the assumptions of these runoff and infiltration schemes are met for example because non linear reservoir routing does not simulate surcharging or backflow results of the hcia arcgis tool may be invalid for cases where storm drainage networks are undersized relative to their inflow and surcharging results in backflow onto a phys and a var areas such cases require dynamic runoff routing and hydraulic considerations that are not included in this study while the runoff and infiltration schemes used here are clearly idealized previous studies have validated the non linear flow routing methods for overland flow akram et al 2014 xiong and melching 2005 and green ampt infiltration approach bouwer 1969 1976 childs and bybordi 1969 chu 1978 under a range of conditions despite these limitations the hcia arcgis tool has potential to improve siting and performance of distributed stormwater controls by providing spatially explicit estimates of hydrologically connected impervious area the effectiveness of such distributed stormwater controls depends on location within a watershed and in particular the location relative to heterogeneous flow paths fry and maxwell 2017 jarden et al 2016 di vittorio and ahiablame 2015 for example epps and hathaway 2019 show greater efficiency in runoff reduction from distributed stormwater controls when placed strategically to target hcia compared to more random placement strategies 6 conclusion previous work has defined urban runoff heterogeneity with the metrics dcia and eia however neither metric provides spatially explicit estimates of hydrologically connected impervious areas an inherent limitation of dcia is that it represents connectivity as binary and static i e connected or not connected an assumption which is at odds with the dynamic nature of hydrologic process and connectivity changes in hydrologic pathways and connectivity can occur over time e g with changes to rainfall intensity and space e g with changes in soil infiltration rate eia inherently accounts for these changes to hydrologic pathways but requires hydrologic data which are not always available for urban catchments we used a combination of hydrologic modeling in pyswmm machine learning and geospatial analysis to develop spatially explicit estimates of hydrologically connected impervious areas hcia in ungauged urban catchments that accounts for variability in hydrologic pathways that result from variability in soil types pervious and impervious areas rainfall events and soil moisture conditions study results shed light on variably connected impervious surfaces a var showing that for the storms and soils evaluated soil texture defined by saturated hydraulic conductivity k s is the most important feature determining the degree of impervious surface hydrological connectivity temporal forcing represented by rainfall and antecedent soil moisture control connectivity within watersheds with low permeability soils while spatial flow path variability represented by relative quantity of disconnecting pervious area controls connectivity within watersheds with highly permeable soils these results suggest that for catchments consisting of highly impermeable soils a var contributes to hcia such that hcia approaches tia but for catchments with highly permeable soils a var does not contribute significantly to hcia and thus dcia could be used as a suitable surrogate for hcia in between these two extremes however lies a wide range of conditions that call for detailed and spatially explicit estimates of a var connectivity credit authorship contribution statement anneliese sytsma conceptualization methodology visualization writing original draft writing review editing colin bell conceptualization writing review editing william eisenstein funding acquisition conceptualization supervision writing review editing terri hogue resources supervision writing review editing g mathias kondolf resources supervision writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this material is based upon work supported by the national science foundation s engineering research center for reinventing the nation s urban water infrastructure renuwit eec 1028968 as additional support was provided from the gledden fellowship university of western australia as global metropolitan studies university of california berkeley as and assistance agreement no r836174 awarded by the u s environmental protection agency th any use of trade firm or product names is for descriptive purposes only and does not imply endorsement by the u s government the manuscript has not been formally reviewed by the u s environmental protection agency the views expressed in this document are solely those of the authors and do not necessarily reflect those of the u s environmental protection agency we thank octavia crompton and dana lapides for their detailed review and feedback on this manuscript and chelsea panos for general support and providing the berkeley lake data sources additional thanks go to sally thompson john radke and iryna dronova for their support in development of these concepts and methods appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2020 125545 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
5097,a lot of large hydropower plants have been built in china in the past few decades large capacity hydropower units usually have multiple prohibited operating zones pozs varying with the net head many cascade hydropower plants are hydraulically coupled because the distance between the upstream and downstream reservoirs is so small that the forebay water level of the downstream reservoir will influence the tailwater level of its immediate upstream reservoir the integrated consideration of the strong hydraulic coupling between cascade hydropower plants the head dependent pozs of individual units and other operation constraints make the daily operation of cascade hydropower plants very challenging for both operators and researchers therefore this paper has developed an accurate optimization model for determining the hourly generation scheduling of cascade hydropower plants with strong hydraulic coupling and head dependent pozs the objective is to maximize the total profits of the cascade hydropower plants from selling electricity in the day ahead market to solve such a complicated mathematical model with non convex and nonlinear features the model is converted into a mixed integer linear programming milp formulation using multiple linear approximation techniques so as to take full advantage of the effective and mature commercial solvers the milp formulation focuses mainly on addressing two nonlinearities namely the three dimensional tailwater level curves and head dependent pozs which are approximated through the piecewise linear interpolations based on the meshing and triangulation technique the developed model is applied to the optimal operation of the tianshengqiao cascade hydropower plants which are located on the hongshui river china the optimization results demonstrate that the proposed model is able to be applied in the short term generation scheduling of cascade hydropower plants in different hydrological conditions and the optimized total profits for the cascade hydropower plants on typical days in dry season and flood season are 1 809 842 usd and 1 856 964 usd respectively moreover the developed model is computationally efficient and produces more realistic and executable generation scheduling than the state of the art optimization model which only considers the head dependent characteristics of pozs without considering the strong hydraulic coupling keywords cascade hydropower plants strong hydraulic coupling head dependent prohibited operating zones mixed integer linear programming nomenclature sets and indices n i set and index of hydropower plants ji j set and index of units in hydropower plant i k index of prohibited operating zones of unit j in plant i t t set and index of time periods constants m a very large positive number mpt day ahead market clearing price in time period t usd mwh ii t forecasted inflow of reservoir i in time period t m3 s pi j max maximum power output of unit j in plant i mw qi j max maximum generating water flow of unit j in plant i m3 s qi max maximum total water discharge of plant i m3 s δ t duration of the tth time period h α i j βi j minimum required online and offline duration of unit j in plant i h zi begin initial forebay water level of reservoir i m zi max upper bound of the forebay water level of reservoir i m zi min lower bound of the forebay water level of reservoir i m zi end target forebay water level of reservoir i at the end of the scheduling horizon m variables hi j t net head of unit j in plant i in time period t m pi j t power output of unit j in plant i in time period t mw p i j k t upper bound of the kth prohibited operating zone of unit j in time period t mw p i j k t lower bound of the kth prohibited operating zone of unit j in time period t mw qi t total water discharge of plant i in time period t m3 s hli j t penstock head loss of unit j in plant i in time period t m q i j t generating water flow of unit j in plant i in time period t m3 s si t total spillage of plant i in time period t m3 s ui j t binary variable that equals 1 if unit j is online in time period t but equals 0 otherwise vi t water storage of reservoir i at the end of time period t m3 xi j t binary variable that equals 1 if unit j in plant i is started up in time period t yi j t binary variable that equals 1 if unit j in plant i is shut down in time period t zi t forebay water level of reservoir i at the end of time period t m zdi t tailwater level of reservoir i in time period t m functions fi zq tailwater level of reservoir i as a function of its total water discharge and the average forebay water level of its downstream reservoir fi zv forebay water level of reservoir i as a function of its water storage fi j pqh power production function of unit j with respect to its net head and generating water flow 1 introduction hydropower is a clean and renewable energy source and has huge untapped potential in china hence hydropower has developed rapidly and cascade hydropower plants have been built on most rivers in china in the past few decades li et al 2015 zhang et al 2011 zhou et al 2018 for large and medium sized river basins there is usually a large hydropower plant with good regulation performance and a large capacity reservoir as the leading hydropower plant in the upper reaches while in the lower reaches there are one or more hydropower plants with a small storage capacity but a large installed capacity this method of development can improve the hydro energy utilization efficiency and obtain greater power generation benefits from the cascade hydropower plants without significantly increasing the investment cost however it will bring great challenges to the daily operation of these cascade hydropower plants cheng et al 2012 2017 which can be largely summarized in the following three points 1 due to the poor regulation capacity of downstream reservoirs small changes in forebay water level in upstream reservoirs may lead to a large fluctuation of forebay water level in downstream reservoirs that is to say if the upstream and downstream reservoirs are not coordinated properly it can easily cause the hydropower curtailment of downstream reservoirs resulting in a great waste of water resources 2 large capacity hydropower units usually have multiple irregularly shaped prohibited operating zones pozs cheng et al 2012 2016 which are attributed to the physical limitations of individual unit components as shown in fig 1 a unlike common pozs whose shape is regular as shown in fig 1 b guan et al 1999 tong et al 2013 the range of irregularly shaped pozs varies with the net head for hydropower plants providing peak regulation services for power grids or participating in the day ahead electricity market conejo et al 2002 lez et al 2007 díaz et al 2011 the net head and power output of the individual hydropower unit usually varies greatly in a single day in this case the head dependent characteristic of pozs makes the power output easily fall into the pozs 3 many cascade hydropower plants are hydraulically coupled because the upstream and downstream reservoirs are very close to each other ma et al 2013 teegavarapu and simonovic 2000 2014 li et al 2014 this strong hydraulic coupling not only represents that the total water discharge of the upstream reservoir becomes an inflow into the immediate downstream reservoir but also shows that the forebay water level of the downstream reservoir will influence the tailwater level of its immediate upstream reservoir as shown in fig 2 considering that the net head is calculated based on the forebay water level and tailwater level the strong hydraulic coupling becomes an important aspect that needs to be taken into account when making the generation scheduling of cascade hydropower plants at present there are few studies on the strong hydraulic coupling between cascade hydropower plants and on the head dependent pozs of hydropower units for the first issue teegavarapu and simonovic teegavarapu and simonovic 2000 successfully addressed the strong hydraulic coupling between cascade hydropower plants through the development of a mixed integer linear programming milp formulation for the tailwater level curves later teegavarapu and simonovic teegavarapu and simonovic 2014 proposed a system simulation model to better describe the dynamic behavior of hydraulically coupled cascade reservoirs li et al 2014 used an iterative method to deal with the hydraulic coupling between the three gorges project and the gezhouba plant based on the assumption that the forebay water level of the gezhouba plant is known for the second issue cheng et al 2012 transformed the irregularly shaped pozs of each hydropower unit into a combined poz of the whole hydropower plant and then established a plant based scheduling model for the optimal operation of cascade hydropower plants with multiple pozs considering that it is not accurate to use the combined poz to represent the pozs of all units cheng et al 2016 then presented an milp formulation for the hydropower unit commitment with multiple head dependent pozs extending their work from plant based to unit based scheduling in their study the irregularly shaped pozs of each hydropower unit were converted into constraints on irregularly shaped feasible operating regions the feasible operating regions were then partitioned into several polygonal sub regions related to discretized net head interval finally each sub region was approximated via a linear formulation however all of these studies have only focused on one of the above mentioned issues to the best of the authors knowledge the research on the short term generation scheduling of cascade hydropower plants rarely considers both the strong hydraulic coupling and the head dependent characteristic of pozs meaning that the formulated optimization models cannot mirror the actual operational practice moreover existing models for the strong hydraulic coupling are based on some simplifications or assumptions which could potentially cause significant errors additionally existing models for the head dependent pozs require calculation of the slope and constant term of the upper and lower bounds of the pozs for each interval which makes them difficult to implement with low solution efficiency hence the development of a more accurate optimization model for the short term generation scheduling of cascade hydropower plants which can synergically and efficiently incorporate the strong hydraulic coupling and head dependent pozs is essential mathematically the daily operation of hydraulically coupled hydropower plants with multiple pozs is a very difficult problem due to its non convex nonlinear and noncontinuous features belotti et al 2013 conventional methods for the short term hydro generation scheduling sthgs problem including dynamic programming dp wu et al 2018 lei et al 2018 computational intelligence approaches shang et al 2017 cheng et al 2008 kumar and mohan 2011 chang et al 2010 fu et al 2011 mahor and rangnekar 2012 feng et al 2017 2019 linear programming lp yoo 2009 and nonlinear programming nlp approaches huang et al 2019 wang et al 2018 catalao et al 2009 all present significant difficulties in addressing the present problem as the cascade hydropower plants are hydraulically coupled dp would be a hindrance in formulating the present problem as a multi stage optimization problem the computational intelligence approaches such as genetic algorithm ga shang et al 2017 cheng et al 2008 kumar and mohan 2011 chang et al 2010 and particle swarm optimization pso fu et al 2011 mahor and rangnekar 2012 feng et al 2017 2019 would struggle to effectively handle the complex operation constraints and cannot guarantee a global optimal solution within finite iterations the lp and nlp formulations do not take into account the operation statuses of individual hydropower units and therefore are also unsuitable for solving the present problem in recent years milp has been widely applied to solve the sthgs problem cheng et al 2016 2018 tong et al 2013 li et al 2014 borghetti et al 2008 su et al 2019a 2019b due to its good performance in handling the complex operation constraints with the aid of efficient commercial solvers such as gurobi lingo and cplex researchers can concentrate on establishing the standard milp formulation and satisfactory results could be generally obtained within an acceptable computational time finardi et al 2016 ramos et al 2015 considering the above issues this paper aims to develop an accurate milp based optimization model for determining the short term generation scheduling of cascade hydropower plants with strong hydraulic coupling and multiple head dependent pozs the main contributions of this paper can be summarized as follows 1 in addition to the conventional hydraulic constraints and operation constraints of individual hydropower units the strong hydraulic coupling between the cascade plants and the head dependent pozs of individual units are also well considered in the developed model making the optimization model and obtained generation scheduling more accurate 2 a novel linearization method based on the meshing and triangulation technique is proposed to approximate the strong hydraulic coupling through the use of three dimensional tailwater level curves eight triangles are used to define the tailwater level curves of the upstream reservoir while taking into account the maximum water discharge limitations theoretically this piecewise linear approximation with continuous formulation is more accurate than that with discontinuous formulation which was proposed in the previous study 3 the head dependent characteristic of pozs of individual hydropower units is captured through using several triangles to approximate the irregularly shaped feasible operating regions the approximation technique does not need to calculate the slope and constant term of the upper and lower bound of pozs for each interval which makes it easy to understand and implement the remainder of this paper is organized as follows section 2 establishes the milp based mathematical formulation of the present problem optimization results obtained from real word case studies are presented in section 3 finally conclusions are drawn in section 4 2 mathematical formulation 2 1 problem description the goal of the optimization model developed in this paper is to maximize the total profits of the cascade hydropower plants from selling electricity in the day ahead market whilst considering various operation constraints this paper does not focus on putting forward the bidding strategy of cascade hydropower plants in the electricity market therefore for the sake of simplicity these hydropower plants are considered as price takers tong et al 2013 conejo et al 2002 lez et al 2007 díaz et al 2011 and the day ahead market clearing prices are assumed to be known tong et al 2013 conejo et al 2002 díaz et al 2011 in addition to the conventional hydraulic constraints operation constraints of individual hydropower units the strong hydraulic coupling between the cascade plants and the head dependent pozs are also well considered in the developed model in order to increase the accuracy of the optimization model moreover the forecasted inflow of reservoirs is assumed to be known and deterministic because the short term prediction accuracy of the runoff in large watersheds in china is relatively high the relative prediction error is generally within 10 jiang et al 2018a 2018b and the forecast error of inflow is usually dealt with in the real time scheduling phase jiang et al 2018 the daily operation of hydraulically coupled hydropower plants with multiple pozs is a very difficult problem due to its non convex nonlinear and noncontinuous features to solve such a complicated problem a natural idea is to approximate each nonlinear function by a series of linear ones the complex mixed integer nonlinear programming minlp problem will then be reformulated as a tractable milp formulation thereby taking full advantage of the effective and mature commercial solvers available the detailed mathematical model is introduced in the following subsections 2 2 objective function as mentioned above maximizing the total profits of the cascade hydropower plants is adopted as the objective of the proposed model which is presented as below 1 f max i 1 n j 1 j i t 1 t m p t p i j t δ t 2 3 constraints the operational constraints are presented as follows a hydraulic constraints 1 water balance constraints 2 v i t v i t 1 3600 i i t q i t δ t 3 i i t r i t q i 1 t 4 q i t j 1 j i q i j t s i t 2 water level constraints 5 z i min z i t z i max 6 z i 0 z i b e g i n z i t z i e n d 3 water discharge constraints 7 0 q i t q i max b individual unit constraints 1 generating water flow limits 8 0 q i j t u i j t q i j m a x 2 power output limits 9 0 p i j t u i j t p i j m a x 3 constraints on online and offline duration 10 x i j t η t 1 t α i j 1 y i j η 1 y i j t η t 1 t β i j 1 x i j η 1 x i j t y i j t 0 1 11 x i j t y i j t u i j t u i j t 1 x i j t y i j t 1 4 constraints on pozs 12 p i j t p i j k t p i j t p i j k t 0 note that if the pozs of unit j are regularly shaped both p i j k t and p i j k t are constants as shown in fig 1 otherwise p i j k t and p i j k t are variables that change over time 5 net head constraints 13 h i j t z i t 1 z i t 2 z d i t h l i j t 14 z i t f i z v v i t 15 z d i t f i z q q i t z i 1 t 1 z i 1 t 2 constraint 13 gives the expression of net head for each unit where the penstock head loss is considered as a fixed value for the sake of simplicity guan et al 1999 tong et al 2013 conejo et al 2002 lez et al 2007 díaz et al 2011 ma et al 2013 teegavarapu and simonovic 2000 2014 constraint 15 represents the strong hydraulic coupling between cascade hydropower plants through defining the relationship between the tailwater level total water discharge of the upstream reservoir and average forebay water level of the downstream reservoir 6 power production function 16 p i j t f i j p q h q i j t h i j t for hydropower units which participate in the day ahead electricity market the net head usually varies greatly over a day thus the head effect on power production is necessary to be fully considered 2 4 milp based model formulation there are four nonlinear constraints in the formulated model presented in section 2 2 i e constraints 12 14 15 and 16 considering that the optimal linear approximation of the relation function between forebay water level and water storage constraint 14 and the power production function constraint 16 have been well established in tong et al 2013 borghetti et al 2008 cheng et al 2018 this study mainly focuses on the linearization of the strong hydraulic coupling between cascade hydropower plants constraint 15 and the head dependent pozs of individual hydropower units constraint 12 2 4 1 linear approximation of the tailwater level curves as shown in eq 15 for cascade reservoirs with strong hydraulic coupling the tailwater level of the upstream reservoir at any given time is determined jointly by its total water discharge and the forebay water level of its downstream reservoir in practical engineering applications a cluster of nonlinear curves known as tailwater level curves is used to represent the relationship between the above three variables with each curve representing the relationship between tailwater level and total water discharge of the upstream reservoir under a specified forebay water level of the downstream reservoir an milp based formulation has been proposed in teegavarapu and simonovic 2000 to approximate the tailwater level curves the formulation includes three steps 1 discretizing the tailwater level curves of the upstream reservoir into a series of curves where each one relates to a specified forebay water level interval of the downstream reservoir 2 using multiple binary variables to determine the interval to which the average forebay water level of the downstream reservoir belongs 3 approximating each nonlinear curve using a piecewise linear formulation however this discontinuous approximation technique will cause significant error if the number of tailwater level curves is small different from the above method a novel linearization method based on a meshing and triangulation technique d ambrosio et al 2010 is developed in this subsection to accurately approximate the tailwater level curves as shown in fig 3 based on the upper and lower bound of forebay water level of the downstream reservoir three tailwater curves of the upstream reservoir are considered corresponding to high denoted as z i 1 h medium z i 1 m and low forebay water level z i 1 l of the downstream reservoir each nonlinear tailwater curve is approximated by two connected segments the maximum total water discharge of the upstream reservoir is also taken into account and is marked with dotted lines in fig 3 the two dimensional surface is then partitioned into eight triangles based on the fact that the coordinates of any point in a triangle can be uniquely determined by the coordinates of three vertices of the same triangle the linear formulation of the tailwater level curves can be obtained as follows 17 r i t l 0 1 l 1 2 8 18 l 1 8 r i t l 1 19 0 λ i t l v 1 v 1 2 3 a n d l 1 2 8 20 v 1 3 λ i t l v r i t l 21 z i 1 t z i 1 t 1 2 l 1 8 v 1 3 λ i t l v z i 1 l v 22 q i t l 1 8 v 1 3 λ i t l v q i l v 23 z d i t l 1 8 v 1 3 λ i t l v zd i l v the notations used in this linear interpolation are defined as below l index of triangles v index of the three vertices of each triangle z i 1 l v forebay water level of the downstream reservoir at the vth vertex of triangle l zd i l v tailwater level of the upstream reservoir at the vth vertex of triangle l q i l v total water discharge of the upstream reservoir at the vth vertex of triangle l r i t l binary variable that equals 1 if the combination of tailwater level total water discharge of the upstream reservoir and forebay water of the downstream reservoir in time period t is in triangle l and equals 0 otherwise λ i t l v weighing coefficients of the vth vertex of triangle l in time period t constraints 17 and 18 force the combination of tailwater level total water discharge of the upstream reservoir and forebay water of the downstream reservoir to be in only one of the triangles constraints 19 and 20 indicate that if triangle l is selected i e r i t l 1 the sum of the weighting coefficients of the three vertices in triangle l will be equal to 1 otherwise all weighting coefficients will be equal to 0 constraint 21 computes the interpolated value for average forebay water level of the downstream reservoir showing that the average forebay water level is equal to the sum of the weighted forebay water level of each vertex similarly constraint 22 computes the interpolation value for total water discharge of the upstream reservoir in fact constraints 17 22 are introduced to determine the weighing coefficients of each vertex the interpolated value for tailwater level of the upstream reservoir is then uniquely determined by 23 theoretically the proposed piecewise linear approximation method for the tailwater level curves is more accurate because it is a continuous approximation rather than the discontinuous one which is proposed in teegavarapu and simonovic 2000 besides the total water discharge limits of the upstream reservoir have already been taken into account in this linear formulation thus eq 7 which also represents the total water discharge limits need not be considered repeatedly and can be removed from the model accordingly 2 4 2 linear approximation of the head dependent pozs accurate modeling of the head dependent pozs of large hydropower units is challenging but crucial for the sthgs problem the difficulties stem from the disjoint feasible operating regions and the relationship between the range of pozs and the net head nevertheless the head dependent pozs have been modeled by a novel milp formulation in this subsection similar to the linear approximation method for the tailwater level curves the disjoint feasible operating regions are approximated by several triangles as shown in fig 4 to capture the feasible operating regions some additional variables were introduced as follows h i j l v net head of unit j in plant i at the vth vertex of triangle l p i j l v power output of unit j in plant i at the vth vertex of triangle l k i j t l binary variable that equals 1 if the combination of net head and power output of unit j in plant i in time period t is in triangle l and equals 0 otherwise γ i j t l v weighing coefficients of the vth vertex of triangle l in time period t accordingly the head dependent pozs can be formulated using the following linear constraints 24 k i j t l 0 1 l 1 2 l 25 l 1 l k i j t l u i j t 26 γ i j t l v 0 v 1 2 3 a n d l 1 2 l 27 v 1 3 γ i j t l v k i j t l 28 h i j t l 1 l v 1 3 γ i j t l v h i j l v 29 h i j t l 1 l v 1 3 γ i j t l v h i j l v m 1 u i j t 30 p i j t l 1 l v 1 3 γ i j t l v p i j l v constraints 24 27 ensure that the power output of each hydropower unit must be in one of the feasible operating sub regions as long as it is online constraints 28 and 29 compute the interpolated value for net head if unit j is running during time period t its net head must be equal to the sum of the weighted net head of each vertex otherwise these two constraints are considered to be invalid as the weighing coefficients of each vertex can be determined by constraints 24 29 the interpolated value for power output of unit j can be uniquely determined by constraint 30 the piecewise linear interpolation introduced in this subsection directly uses the values i e power output and net head of several datapoints to define the feasible operating regions and does not need to calculate the slope and constant term of the upper and lower bound of pozs for the interval 2 4 3 complete model solution process the milp formulation for the present problem can be established with aid of the above linearization techniques the complete solution process for the proposed optimization model is shown in fig 5 3 case studies the developed model was applied to the daily operation of the tianshengqiao i and tianshengqiao ii cascade hydropower plants these two hydropower plants are located in the upper reaches of the hongshui river in southwest china as shown in fig 6 the tianshengqiao i hydropower plant is the leading plant on the hongshui river and has an annual regulation reservoir it contains four identical generating units with a total installed capacity of 1200 mw the tianshengqiao ii hydropower plant which has a daily regulation reservoir is the downstream plant of tianshengqiao i this plant has six identical generating units and each unit has an installed capacity of 220 mw as the distance between the two hydropower plants is only approximately 7 km the forebay water level of the tianshengqiao ii plant inevitably has a huge impact on the tailwater level of the tianshengqiao i plant to verify the validity and robustness of the model the actual operation of the cascade plants was considered for two days april 17 2017 and august 20 2017 as references for the case studies 2017 is a normal year in which the annual runoff of the basin is very close to the multi year average runoff moreover the average forecasted local inflow of the tianshengqiao i plant on april 17 2017 and august 20 2017 corresponds to the 25th and 75th percentiles of the reservoir inflow for the entire year of continuous runoff record respectively hence these two days were used to represent the hydrological conditions in the dry season and flood season respectively due to sufficient reservoir inflow in flood season the electricity supply is very abundant resulting in low electricity prices during flood season in contrast electricity prices are relatively high during dry season the forecasted local inflow of the two plants and the day ahead market clearing price in these two case studies are shown in tables 1 and 2 respectively as can be seen there are significant differences in hydrological conditions and electricity prices between the two case studies the tailwater level curves of tianshengqiao i hydropower plant are shown in fig 7 the characteristic parameters of the two plants and their units are presented in tables 3 and 4 respectively considering that no spillage is expected for the hydrpower plnats due to china s renewable energy utilization policy s i t was set to 0 both in dry season and flood season in the case studies 1d was taken as the scheduling horizon and 1 h was taken as the time period the formulated models were solved by gurobi the gurobi optimizer is developed by gurobi optimization company and is a powerful mathematical optimization solver for a variety of mathematical programming problems including lp quadratic programming qp quadratically constrained programming qcp milp mixed integer quadratic programming miqp and mixed integer quadratically constrained programming miqcp gurobi optimizer 2020 due to its excellent computing performance it has been widely used in power system scheduling manufacturing finance and other fields the computing platform was an hp workstation containing four 3 20 ghz intel core cpus with 16 gb of ram as shown in table 5 the optimized total profits for the cascade hydropower plants in case study 1 and case study 2 are 1 809 842 usd and 1 856 964 usd respectively and it takes 736 s and 827 s to obtain the optimal solutions respectively the computation time is relatively long but is believed to be acceptable because the strong hydraulic coupling between cascade plants and head dependent pozs of individual hydropower units are fully considered in the developed model detailed generation scheduling of the tianshengqiao cascade plants are presented and analyzed in the following section 3 1 case study 1 optimal generation scheduling in dry season the total power generation of the tianshengqiao cascade plants in case study 1 is 39 618 mwh fig 9 illustrates the market clearing price and the power output of each hydropower plant in this case study it can be observed that the total power output of the cascade plants follows the trend of the market clearing price in order to obtain higher profits the two plants tend to generate more power during hours 7 15 and 19 22 when the electricity price is higher while producing little or even no electricity during periods of low electricity price fig 10 presents the forebay water level of the two hydropower plants in case study 1 it can be seen that the variation in the forebay water level of the tianshengqiao i plant is only 0 38 m over the whole scheduling horizon while the variation of the tianshengqiao ii plant reaches nearly 5 87 m due to its poor regulation performance besides the terminal forebay water level of the two plants are 750 57 m and 640 63 m respectively both within the allowable deviation range of the target forebay water level fig 11 shows the net head of unit 2 in tianshengqiao i and unit 3 in tianshengqiao ii for each time period in case study 1 it is evident that the net head of both units varies greatly over 24 h thus the head effect significantly impacts the power output and pozs of each unit and cannot be neglected it should be noted that the penstock head loss can usually be described as a quadratic function of the generating flow expressed as eq 31 cheng et al 2016 which can be obtained by fitting a large amount of historical operation data the actual penstock head loss for each unit at each time period was computed using eq 31 according to the optimized generating flow and the deviation between the actual penstock head loss and the simplified penstock head loss set in the proposed model was then calculated it was found that the relative error of the net head of each unit which is expressed as the ratio of the deviation to the net head obtained by the proposed model was only between 0 4 and 0 3 this verifies that the assumption of treating penstock head loss of each unit as a fixed value is reasonable 31 h l i j t a i j q i j t 2 b i j the power output of all units in tianshengqiao i plant in case study 1 is shown in fig 12 as can be seen the developed milp based formulation ensures that the power output of all generating units avoid the head dependent pozs and that all units meet the requirements for the minimum online and offline time durations 3 2 case study 2 optimal generation scheduling in flood season the local inflow of the hydropower plants and day ahead market clearing price are significantly different in flood season compared to those in dry season hence it is necessary to verify the validity of the developed model when it is applied to the short term scheduling in flood season the power output of each hydropower plant in case study 2 is illustrated in fig 13 it can be seen that the total power output of the cascade plants also tracks the trend of the market clearing price as in dry season the tianshengqiao i plant tends to generate more power during high price electricity periods and less power during low electricity price periods in order to obtain higher profits however the tianshengqiao ii plant has to operate at maximum capacity during the day to avoid water spillage as much as possible due to its poor regulation performance moreover although the total power generation of tianshengqiao cascade plants has reached 51 763 mwh and is much higher than that obtained in case study 1 the total profit is close to that obtained in case study 1 due to the low electricity price in flood season the forebay water level of the two hydropower plants and the power output of all units in tianshengqiao i plant are presented in fig 14 and 15 respectively as can be seen the forebay water level of the two hydropower plants does not exceed the upper and lower limits and the power output of generating units successfully avoid the head dependent pozs in summary the above two case studies with different hydrological conditions and electricity prices indicate that the proposed model is able to effectively solve the short term generation scheduling problem of cascade hydropower plants with strong hydraulic coupling and head dependent pozs 3 3 case study 3 comparison with the benchmark model in order to highlight the advancement of the milp model developed in this paper another milp model that only considered the head dependent characteristics of pozs without considering the strong hydraulic coupling was also established and was selected as a benchmark model for comparison this model only used one tailwater curve of the tianshengqiao i plant corresponding to the 641 m forebay water level of the tianshengqiao ii plant the linear formulation of the pozs referred to ref díaz et al 2011 and other calculation conditions of the model referred to case study 1 the obtained forebay water level of the tianshengqiao ii plant is compared to that obtained from the benchmark model as shown in fig 16 it is apparent that the forebay water level of the tianshengqiao ii plant obtained from the two different models is quite different this difference can be attributed to two points 1 without considering the dynamic tailwater effects the total water discharge of the tianshengqiao i plant is significantly different to that obtained from the proposed model even though the forebay water level shows little change 2 the regulation performance of the tianshengqiao ii plant is poor resulting in its forebay water level being very sensitive to the change of inflow based on the actual tailwater level curves the actual power output and pozs of all units in tianshengqiao i plant were recomputed using the generating water flow of each unit and the forebay water levels obtained from the benchmark model the comparisons between the actual power output of each unit and that obtained from the benchmark model are given in fig 17 it can be observed that the obtained power output of hydropower units based on the benchmark model is not realistic because the model does not consider the dynamic tailwater effects and therefore misestimates the net head moreover although the approximation technique of the head dependent pozs is appropriate the actual power output of all units still falls into their respective pozs during hours 10 14 and 19 22 suggesting that these units may operate in the pozs if the benchmark model is used to determine the generation scheduling of tianshengqiao cascade hydropower plants this also confirms that it s important to consider the operational constraints of cascade hydropower plants comprehensively to make the optimization model more accurate it s worth noting that the proposed model and the commercial solver gurobi can be integrated into the decision support system dss for determining the short term generation scheduling of tianshengqiao or other cascade hydropower plants in this case the operators of cascade hydropower plants only need to input the forecasted local inflow of the hydropower plants the forecasted day ahead market clearing price and the initial and target forebay water level of each reservoir into the dss and the scheduling results e g power output of each hydropower unit and forebay water level of each reservoir can then be obtained the system embedded with the proposed model and approach is believed to greatly reduce the workload of the operators and realize the accurate and optimal scheduling of the cascade hydropower plants 4 conclusion in this paper an milp based optimization model for the short term generation scheduling of cascaded hydropower plants was developed this model mainly focused on addressing two important issues namely the strong hydraulic coupling between cascade hydropower plants and the head dependent prohibited operating zones pozs of individual hydropower units the daily operation of the tianshengqiao cascade hydropower plants which are located in the hongshui river in the southwest of china was used to verify the performance of the developed model based on the obtained optimization results conclusions can be drawn as follows 1 the linear approximations of tailwater level curves and multiple irregularly shaped pozs have merit with respect to accurately describing the strong hydraulic coupling and the head dependent characteristics of pozs and can ensure considerable power generation benefits while maintaining the safe and stable operation of hydropower plants 2 generation scheduling obtained from the state of the art model that only considers the head dependent characteristics of pozs without considering the strong hydraulic coupling is significantly different from that obtained from the proposed model moreover it deviates from the actual operation of cascade plants to a large extent and is even infeasible compared with the state of the art optimization model the proposed model can produce more realistic and executable generation scheduling 3 the proposed milp model can be successfully applied to solve the very complicated problem of short term hydro generation scheduling in different operating conditions with the aid of efficient commercial solvers it can obtain a satisfied solution within an acceptable computation time as there are a lot of large cascade hydropower plants with strong hydraulic coupling and head dependent prohibited operating zones in southwestern china the research presented in this paper is believed to be of great significance and could provide an effective reference for the daily operation of these hydropower plants however it is still difficult to fully characterize the operating features of large scale hydropower systems due to the complex operational constraints and the limited solving techniques more operational constraints and the uncertain factors such as the uncertain electricity price and uncertain inflow need to be considered in future research to further increase the accuracy and the engineering application value of the proposed model besides model decomposition techniques and parallel techniques should be integrated into the solution method to further improve the solution efficiency credit authorship contribution statement chengguo su methodology software writing original draft wenlin yuan conceptualization funding acquisition chuntian cheng supervision writing review editing peilin wang data curation formal analysis lifei sun validation visualization taiheng zhang investigation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the work described in this paper was supported by the national natural science foundation of china no 51779229 and 91547201 and the scientific research projects of henan province no 202102310296 we also thanks to the anonymous reviewers whose comments have helped improve the quality of this paper 
5097,a lot of large hydropower plants have been built in china in the past few decades large capacity hydropower units usually have multiple prohibited operating zones pozs varying with the net head many cascade hydropower plants are hydraulically coupled because the distance between the upstream and downstream reservoirs is so small that the forebay water level of the downstream reservoir will influence the tailwater level of its immediate upstream reservoir the integrated consideration of the strong hydraulic coupling between cascade hydropower plants the head dependent pozs of individual units and other operation constraints make the daily operation of cascade hydropower plants very challenging for both operators and researchers therefore this paper has developed an accurate optimization model for determining the hourly generation scheduling of cascade hydropower plants with strong hydraulic coupling and head dependent pozs the objective is to maximize the total profits of the cascade hydropower plants from selling electricity in the day ahead market to solve such a complicated mathematical model with non convex and nonlinear features the model is converted into a mixed integer linear programming milp formulation using multiple linear approximation techniques so as to take full advantage of the effective and mature commercial solvers the milp formulation focuses mainly on addressing two nonlinearities namely the three dimensional tailwater level curves and head dependent pozs which are approximated through the piecewise linear interpolations based on the meshing and triangulation technique the developed model is applied to the optimal operation of the tianshengqiao cascade hydropower plants which are located on the hongshui river china the optimization results demonstrate that the proposed model is able to be applied in the short term generation scheduling of cascade hydropower plants in different hydrological conditions and the optimized total profits for the cascade hydropower plants on typical days in dry season and flood season are 1 809 842 usd and 1 856 964 usd respectively moreover the developed model is computationally efficient and produces more realistic and executable generation scheduling than the state of the art optimization model which only considers the head dependent characteristics of pozs without considering the strong hydraulic coupling keywords cascade hydropower plants strong hydraulic coupling head dependent prohibited operating zones mixed integer linear programming nomenclature sets and indices n i set and index of hydropower plants ji j set and index of units in hydropower plant i k index of prohibited operating zones of unit j in plant i t t set and index of time periods constants m a very large positive number mpt day ahead market clearing price in time period t usd mwh ii t forecasted inflow of reservoir i in time period t m3 s pi j max maximum power output of unit j in plant i mw qi j max maximum generating water flow of unit j in plant i m3 s qi max maximum total water discharge of plant i m3 s δ t duration of the tth time period h α i j βi j minimum required online and offline duration of unit j in plant i h zi begin initial forebay water level of reservoir i m zi max upper bound of the forebay water level of reservoir i m zi min lower bound of the forebay water level of reservoir i m zi end target forebay water level of reservoir i at the end of the scheduling horizon m variables hi j t net head of unit j in plant i in time period t m pi j t power output of unit j in plant i in time period t mw p i j k t upper bound of the kth prohibited operating zone of unit j in time period t mw p i j k t lower bound of the kth prohibited operating zone of unit j in time period t mw qi t total water discharge of plant i in time period t m3 s hli j t penstock head loss of unit j in plant i in time period t m q i j t generating water flow of unit j in plant i in time period t m3 s si t total spillage of plant i in time period t m3 s ui j t binary variable that equals 1 if unit j is online in time period t but equals 0 otherwise vi t water storage of reservoir i at the end of time period t m3 xi j t binary variable that equals 1 if unit j in plant i is started up in time period t yi j t binary variable that equals 1 if unit j in plant i is shut down in time period t zi t forebay water level of reservoir i at the end of time period t m zdi t tailwater level of reservoir i in time period t m functions fi zq tailwater level of reservoir i as a function of its total water discharge and the average forebay water level of its downstream reservoir fi zv forebay water level of reservoir i as a function of its water storage fi j pqh power production function of unit j with respect to its net head and generating water flow 1 introduction hydropower is a clean and renewable energy source and has huge untapped potential in china hence hydropower has developed rapidly and cascade hydropower plants have been built on most rivers in china in the past few decades li et al 2015 zhang et al 2011 zhou et al 2018 for large and medium sized river basins there is usually a large hydropower plant with good regulation performance and a large capacity reservoir as the leading hydropower plant in the upper reaches while in the lower reaches there are one or more hydropower plants with a small storage capacity but a large installed capacity this method of development can improve the hydro energy utilization efficiency and obtain greater power generation benefits from the cascade hydropower plants without significantly increasing the investment cost however it will bring great challenges to the daily operation of these cascade hydropower plants cheng et al 2012 2017 which can be largely summarized in the following three points 1 due to the poor regulation capacity of downstream reservoirs small changes in forebay water level in upstream reservoirs may lead to a large fluctuation of forebay water level in downstream reservoirs that is to say if the upstream and downstream reservoirs are not coordinated properly it can easily cause the hydropower curtailment of downstream reservoirs resulting in a great waste of water resources 2 large capacity hydropower units usually have multiple irregularly shaped prohibited operating zones pozs cheng et al 2012 2016 which are attributed to the physical limitations of individual unit components as shown in fig 1 a unlike common pozs whose shape is regular as shown in fig 1 b guan et al 1999 tong et al 2013 the range of irregularly shaped pozs varies with the net head for hydropower plants providing peak regulation services for power grids or participating in the day ahead electricity market conejo et al 2002 lez et al 2007 díaz et al 2011 the net head and power output of the individual hydropower unit usually varies greatly in a single day in this case the head dependent characteristic of pozs makes the power output easily fall into the pozs 3 many cascade hydropower plants are hydraulically coupled because the upstream and downstream reservoirs are very close to each other ma et al 2013 teegavarapu and simonovic 2000 2014 li et al 2014 this strong hydraulic coupling not only represents that the total water discharge of the upstream reservoir becomes an inflow into the immediate downstream reservoir but also shows that the forebay water level of the downstream reservoir will influence the tailwater level of its immediate upstream reservoir as shown in fig 2 considering that the net head is calculated based on the forebay water level and tailwater level the strong hydraulic coupling becomes an important aspect that needs to be taken into account when making the generation scheduling of cascade hydropower plants at present there are few studies on the strong hydraulic coupling between cascade hydropower plants and on the head dependent pozs of hydropower units for the first issue teegavarapu and simonovic teegavarapu and simonovic 2000 successfully addressed the strong hydraulic coupling between cascade hydropower plants through the development of a mixed integer linear programming milp formulation for the tailwater level curves later teegavarapu and simonovic teegavarapu and simonovic 2014 proposed a system simulation model to better describe the dynamic behavior of hydraulically coupled cascade reservoirs li et al 2014 used an iterative method to deal with the hydraulic coupling between the three gorges project and the gezhouba plant based on the assumption that the forebay water level of the gezhouba plant is known for the second issue cheng et al 2012 transformed the irregularly shaped pozs of each hydropower unit into a combined poz of the whole hydropower plant and then established a plant based scheduling model for the optimal operation of cascade hydropower plants with multiple pozs considering that it is not accurate to use the combined poz to represent the pozs of all units cheng et al 2016 then presented an milp formulation for the hydropower unit commitment with multiple head dependent pozs extending their work from plant based to unit based scheduling in their study the irregularly shaped pozs of each hydropower unit were converted into constraints on irregularly shaped feasible operating regions the feasible operating regions were then partitioned into several polygonal sub regions related to discretized net head interval finally each sub region was approximated via a linear formulation however all of these studies have only focused on one of the above mentioned issues to the best of the authors knowledge the research on the short term generation scheduling of cascade hydropower plants rarely considers both the strong hydraulic coupling and the head dependent characteristic of pozs meaning that the formulated optimization models cannot mirror the actual operational practice moreover existing models for the strong hydraulic coupling are based on some simplifications or assumptions which could potentially cause significant errors additionally existing models for the head dependent pozs require calculation of the slope and constant term of the upper and lower bounds of the pozs for each interval which makes them difficult to implement with low solution efficiency hence the development of a more accurate optimization model for the short term generation scheduling of cascade hydropower plants which can synergically and efficiently incorporate the strong hydraulic coupling and head dependent pozs is essential mathematically the daily operation of hydraulically coupled hydropower plants with multiple pozs is a very difficult problem due to its non convex nonlinear and noncontinuous features belotti et al 2013 conventional methods for the short term hydro generation scheduling sthgs problem including dynamic programming dp wu et al 2018 lei et al 2018 computational intelligence approaches shang et al 2017 cheng et al 2008 kumar and mohan 2011 chang et al 2010 fu et al 2011 mahor and rangnekar 2012 feng et al 2017 2019 linear programming lp yoo 2009 and nonlinear programming nlp approaches huang et al 2019 wang et al 2018 catalao et al 2009 all present significant difficulties in addressing the present problem as the cascade hydropower plants are hydraulically coupled dp would be a hindrance in formulating the present problem as a multi stage optimization problem the computational intelligence approaches such as genetic algorithm ga shang et al 2017 cheng et al 2008 kumar and mohan 2011 chang et al 2010 and particle swarm optimization pso fu et al 2011 mahor and rangnekar 2012 feng et al 2017 2019 would struggle to effectively handle the complex operation constraints and cannot guarantee a global optimal solution within finite iterations the lp and nlp formulations do not take into account the operation statuses of individual hydropower units and therefore are also unsuitable for solving the present problem in recent years milp has been widely applied to solve the sthgs problem cheng et al 2016 2018 tong et al 2013 li et al 2014 borghetti et al 2008 su et al 2019a 2019b due to its good performance in handling the complex operation constraints with the aid of efficient commercial solvers such as gurobi lingo and cplex researchers can concentrate on establishing the standard milp formulation and satisfactory results could be generally obtained within an acceptable computational time finardi et al 2016 ramos et al 2015 considering the above issues this paper aims to develop an accurate milp based optimization model for determining the short term generation scheduling of cascade hydropower plants with strong hydraulic coupling and multiple head dependent pozs the main contributions of this paper can be summarized as follows 1 in addition to the conventional hydraulic constraints and operation constraints of individual hydropower units the strong hydraulic coupling between the cascade plants and the head dependent pozs of individual units are also well considered in the developed model making the optimization model and obtained generation scheduling more accurate 2 a novel linearization method based on the meshing and triangulation technique is proposed to approximate the strong hydraulic coupling through the use of three dimensional tailwater level curves eight triangles are used to define the tailwater level curves of the upstream reservoir while taking into account the maximum water discharge limitations theoretically this piecewise linear approximation with continuous formulation is more accurate than that with discontinuous formulation which was proposed in the previous study 3 the head dependent characteristic of pozs of individual hydropower units is captured through using several triangles to approximate the irregularly shaped feasible operating regions the approximation technique does not need to calculate the slope and constant term of the upper and lower bound of pozs for each interval which makes it easy to understand and implement the remainder of this paper is organized as follows section 2 establishes the milp based mathematical formulation of the present problem optimization results obtained from real word case studies are presented in section 3 finally conclusions are drawn in section 4 2 mathematical formulation 2 1 problem description the goal of the optimization model developed in this paper is to maximize the total profits of the cascade hydropower plants from selling electricity in the day ahead market whilst considering various operation constraints this paper does not focus on putting forward the bidding strategy of cascade hydropower plants in the electricity market therefore for the sake of simplicity these hydropower plants are considered as price takers tong et al 2013 conejo et al 2002 lez et al 2007 díaz et al 2011 and the day ahead market clearing prices are assumed to be known tong et al 2013 conejo et al 2002 díaz et al 2011 in addition to the conventional hydraulic constraints operation constraints of individual hydropower units the strong hydraulic coupling between the cascade plants and the head dependent pozs are also well considered in the developed model in order to increase the accuracy of the optimization model moreover the forecasted inflow of reservoirs is assumed to be known and deterministic because the short term prediction accuracy of the runoff in large watersheds in china is relatively high the relative prediction error is generally within 10 jiang et al 2018a 2018b and the forecast error of inflow is usually dealt with in the real time scheduling phase jiang et al 2018 the daily operation of hydraulically coupled hydropower plants with multiple pozs is a very difficult problem due to its non convex nonlinear and noncontinuous features to solve such a complicated problem a natural idea is to approximate each nonlinear function by a series of linear ones the complex mixed integer nonlinear programming minlp problem will then be reformulated as a tractable milp formulation thereby taking full advantage of the effective and mature commercial solvers available the detailed mathematical model is introduced in the following subsections 2 2 objective function as mentioned above maximizing the total profits of the cascade hydropower plants is adopted as the objective of the proposed model which is presented as below 1 f max i 1 n j 1 j i t 1 t m p t p i j t δ t 2 3 constraints the operational constraints are presented as follows a hydraulic constraints 1 water balance constraints 2 v i t v i t 1 3600 i i t q i t δ t 3 i i t r i t q i 1 t 4 q i t j 1 j i q i j t s i t 2 water level constraints 5 z i min z i t z i max 6 z i 0 z i b e g i n z i t z i e n d 3 water discharge constraints 7 0 q i t q i max b individual unit constraints 1 generating water flow limits 8 0 q i j t u i j t q i j m a x 2 power output limits 9 0 p i j t u i j t p i j m a x 3 constraints on online and offline duration 10 x i j t η t 1 t α i j 1 y i j η 1 y i j t η t 1 t β i j 1 x i j η 1 x i j t y i j t 0 1 11 x i j t y i j t u i j t u i j t 1 x i j t y i j t 1 4 constraints on pozs 12 p i j t p i j k t p i j t p i j k t 0 note that if the pozs of unit j are regularly shaped both p i j k t and p i j k t are constants as shown in fig 1 otherwise p i j k t and p i j k t are variables that change over time 5 net head constraints 13 h i j t z i t 1 z i t 2 z d i t h l i j t 14 z i t f i z v v i t 15 z d i t f i z q q i t z i 1 t 1 z i 1 t 2 constraint 13 gives the expression of net head for each unit where the penstock head loss is considered as a fixed value for the sake of simplicity guan et al 1999 tong et al 2013 conejo et al 2002 lez et al 2007 díaz et al 2011 ma et al 2013 teegavarapu and simonovic 2000 2014 constraint 15 represents the strong hydraulic coupling between cascade hydropower plants through defining the relationship between the tailwater level total water discharge of the upstream reservoir and average forebay water level of the downstream reservoir 6 power production function 16 p i j t f i j p q h q i j t h i j t for hydropower units which participate in the day ahead electricity market the net head usually varies greatly over a day thus the head effect on power production is necessary to be fully considered 2 4 milp based model formulation there are four nonlinear constraints in the formulated model presented in section 2 2 i e constraints 12 14 15 and 16 considering that the optimal linear approximation of the relation function between forebay water level and water storage constraint 14 and the power production function constraint 16 have been well established in tong et al 2013 borghetti et al 2008 cheng et al 2018 this study mainly focuses on the linearization of the strong hydraulic coupling between cascade hydropower plants constraint 15 and the head dependent pozs of individual hydropower units constraint 12 2 4 1 linear approximation of the tailwater level curves as shown in eq 15 for cascade reservoirs with strong hydraulic coupling the tailwater level of the upstream reservoir at any given time is determined jointly by its total water discharge and the forebay water level of its downstream reservoir in practical engineering applications a cluster of nonlinear curves known as tailwater level curves is used to represent the relationship between the above three variables with each curve representing the relationship between tailwater level and total water discharge of the upstream reservoir under a specified forebay water level of the downstream reservoir an milp based formulation has been proposed in teegavarapu and simonovic 2000 to approximate the tailwater level curves the formulation includes three steps 1 discretizing the tailwater level curves of the upstream reservoir into a series of curves where each one relates to a specified forebay water level interval of the downstream reservoir 2 using multiple binary variables to determine the interval to which the average forebay water level of the downstream reservoir belongs 3 approximating each nonlinear curve using a piecewise linear formulation however this discontinuous approximation technique will cause significant error if the number of tailwater level curves is small different from the above method a novel linearization method based on a meshing and triangulation technique d ambrosio et al 2010 is developed in this subsection to accurately approximate the tailwater level curves as shown in fig 3 based on the upper and lower bound of forebay water level of the downstream reservoir three tailwater curves of the upstream reservoir are considered corresponding to high denoted as z i 1 h medium z i 1 m and low forebay water level z i 1 l of the downstream reservoir each nonlinear tailwater curve is approximated by two connected segments the maximum total water discharge of the upstream reservoir is also taken into account and is marked with dotted lines in fig 3 the two dimensional surface is then partitioned into eight triangles based on the fact that the coordinates of any point in a triangle can be uniquely determined by the coordinates of three vertices of the same triangle the linear formulation of the tailwater level curves can be obtained as follows 17 r i t l 0 1 l 1 2 8 18 l 1 8 r i t l 1 19 0 λ i t l v 1 v 1 2 3 a n d l 1 2 8 20 v 1 3 λ i t l v r i t l 21 z i 1 t z i 1 t 1 2 l 1 8 v 1 3 λ i t l v z i 1 l v 22 q i t l 1 8 v 1 3 λ i t l v q i l v 23 z d i t l 1 8 v 1 3 λ i t l v zd i l v the notations used in this linear interpolation are defined as below l index of triangles v index of the three vertices of each triangle z i 1 l v forebay water level of the downstream reservoir at the vth vertex of triangle l zd i l v tailwater level of the upstream reservoir at the vth vertex of triangle l q i l v total water discharge of the upstream reservoir at the vth vertex of triangle l r i t l binary variable that equals 1 if the combination of tailwater level total water discharge of the upstream reservoir and forebay water of the downstream reservoir in time period t is in triangle l and equals 0 otherwise λ i t l v weighing coefficients of the vth vertex of triangle l in time period t constraints 17 and 18 force the combination of tailwater level total water discharge of the upstream reservoir and forebay water of the downstream reservoir to be in only one of the triangles constraints 19 and 20 indicate that if triangle l is selected i e r i t l 1 the sum of the weighting coefficients of the three vertices in triangle l will be equal to 1 otherwise all weighting coefficients will be equal to 0 constraint 21 computes the interpolated value for average forebay water level of the downstream reservoir showing that the average forebay water level is equal to the sum of the weighted forebay water level of each vertex similarly constraint 22 computes the interpolation value for total water discharge of the upstream reservoir in fact constraints 17 22 are introduced to determine the weighing coefficients of each vertex the interpolated value for tailwater level of the upstream reservoir is then uniquely determined by 23 theoretically the proposed piecewise linear approximation method for the tailwater level curves is more accurate because it is a continuous approximation rather than the discontinuous one which is proposed in teegavarapu and simonovic 2000 besides the total water discharge limits of the upstream reservoir have already been taken into account in this linear formulation thus eq 7 which also represents the total water discharge limits need not be considered repeatedly and can be removed from the model accordingly 2 4 2 linear approximation of the head dependent pozs accurate modeling of the head dependent pozs of large hydropower units is challenging but crucial for the sthgs problem the difficulties stem from the disjoint feasible operating regions and the relationship between the range of pozs and the net head nevertheless the head dependent pozs have been modeled by a novel milp formulation in this subsection similar to the linear approximation method for the tailwater level curves the disjoint feasible operating regions are approximated by several triangles as shown in fig 4 to capture the feasible operating regions some additional variables were introduced as follows h i j l v net head of unit j in plant i at the vth vertex of triangle l p i j l v power output of unit j in plant i at the vth vertex of triangle l k i j t l binary variable that equals 1 if the combination of net head and power output of unit j in plant i in time period t is in triangle l and equals 0 otherwise γ i j t l v weighing coefficients of the vth vertex of triangle l in time period t accordingly the head dependent pozs can be formulated using the following linear constraints 24 k i j t l 0 1 l 1 2 l 25 l 1 l k i j t l u i j t 26 γ i j t l v 0 v 1 2 3 a n d l 1 2 l 27 v 1 3 γ i j t l v k i j t l 28 h i j t l 1 l v 1 3 γ i j t l v h i j l v 29 h i j t l 1 l v 1 3 γ i j t l v h i j l v m 1 u i j t 30 p i j t l 1 l v 1 3 γ i j t l v p i j l v constraints 24 27 ensure that the power output of each hydropower unit must be in one of the feasible operating sub regions as long as it is online constraints 28 and 29 compute the interpolated value for net head if unit j is running during time period t its net head must be equal to the sum of the weighted net head of each vertex otherwise these two constraints are considered to be invalid as the weighing coefficients of each vertex can be determined by constraints 24 29 the interpolated value for power output of unit j can be uniquely determined by constraint 30 the piecewise linear interpolation introduced in this subsection directly uses the values i e power output and net head of several datapoints to define the feasible operating regions and does not need to calculate the slope and constant term of the upper and lower bound of pozs for the interval 2 4 3 complete model solution process the milp formulation for the present problem can be established with aid of the above linearization techniques the complete solution process for the proposed optimization model is shown in fig 5 3 case studies the developed model was applied to the daily operation of the tianshengqiao i and tianshengqiao ii cascade hydropower plants these two hydropower plants are located in the upper reaches of the hongshui river in southwest china as shown in fig 6 the tianshengqiao i hydropower plant is the leading plant on the hongshui river and has an annual regulation reservoir it contains four identical generating units with a total installed capacity of 1200 mw the tianshengqiao ii hydropower plant which has a daily regulation reservoir is the downstream plant of tianshengqiao i this plant has six identical generating units and each unit has an installed capacity of 220 mw as the distance between the two hydropower plants is only approximately 7 km the forebay water level of the tianshengqiao ii plant inevitably has a huge impact on the tailwater level of the tianshengqiao i plant to verify the validity and robustness of the model the actual operation of the cascade plants was considered for two days april 17 2017 and august 20 2017 as references for the case studies 2017 is a normal year in which the annual runoff of the basin is very close to the multi year average runoff moreover the average forecasted local inflow of the tianshengqiao i plant on april 17 2017 and august 20 2017 corresponds to the 25th and 75th percentiles of the reservoir inflow for the entire year of continuous runoff record respectively hence these two days were used to represent the hydrological conditions in the dry season and flood season respectively due to sufficient reservoir inflow in flood season the electricity supply is very abundant resulting in low electricity prices during flood season in contrast electricity prices are relatively high during dry season the forecasted local inflow of the two plants and the day ahead market clearing price in these two case studies are shown in tables 1 and 2 respectively as can be seen there are significant differences in hydrological conditions and electricity prices between the two case studies the tailwater level curves of tianshengqiao i hydropower plant are shown in fig 7 the characteristic parameters of the two plants and their units are presented in tables 3 and 4 respectively considering that no spillage is expected for the hydrpower plnats due to china s renewable energy utilization policy s i t was set to 0 both in dry season and flood season in the case studies 1d was taken as the scheduling horizon and 1 h was taken as the time period the formulated models were solved by gurobi the gurobi optimizer is developed by gurobi optimization company and is a powerful mathematical optimization solver for a variety of mathematical programming problems including lp quadratic programming qp quadratically constrained programming qcp milp mixed integer quadratic programming miqp and mixed integer quadratically constrained programming miqcp gurobi optimizer 2020 due to its excellent computing performance it has been widely used in power system scheduling manufacturing finance and other fields the computing platform was an hp workstation containing four 3 20 ghz intel core cpus with 16 gb of ram as shown in table 5 the optimized total profits for the cascade hydropower plants in case study 1 and case study 2 are 1 809 842 usd and 1 856 964 usd respectively and it takes 736 s and 827 s to obtain the optimal solutions respectively the computation time is relatively long but is believed to be acceptable because the strong hydraulic coupling between cascade plants and head dependent pozs of individual hydropower units are fully considered in the developed model detailed generation scheduling of the tianshengqiao cascade plants are presented and analyzed in the following section 3 1 case study 1 optimal generation scheduling in dry season the total power generation of the tianshengqiao cascade plants in case study 1 is 39 618 mwh fig 9 illustrates the market clearing price and the power output of each hydropower plant in this case study it can be observed that the total power output of the cascade plants follows the trend of the market clearing price in order to obtain higher profits the two plants tend to generate more power during hours 7 15 and 19 22 when the electricity price is higher while producing little or even no electricity during periods of low electricity price fig 10 presents the forebay water level of the two hydropower plants in case study 1 it can be seen that the variation in the forebay water level of the tianshengqiao i plant is only 0 38 m over the whole scheduling horizon while the variation of the tianshengqiao ii plant reaches nearly 5 87 m due to its poor regulation performance besides the terminal forebay water level of the two plants are 750 57 m and 640 63 m respectively both within the allowable deviation range of the target forebay water level fig 11 shows the net head of unit 2 in tianshengqiao i and unit 3 in tianshengqiao ii for each time period in case study 1 it is evident that the net head of both units varies greatly over 24 h thus the head effect significantly impacts the power output and pozs of each unit and cannot be neglected it should be noted that the penstock head loss can usually be described as a quadratic function of the generating flow expressed as eq 31 cheng et al 2016 which can be obtained by fitting a large amount of historical operation data the actual penstock head loss for each unit at each time period was computed using eq 31 according to the optimized generating flow and the deviation between the actual penstock head loss and the simplified penstock head loss set in the proposed model was then calculated it was found that the relative error of the net head of each unit which is expressed as the ratio of the deviation to the net head obtained by the proposed model was only between 0 4 and 0 3 this verifies that the assumption of treating penstock head loss of each unit as a fixed value is reasonable 31 h l i j t a i j q i j t 2 b i j the power output of all units in tianshengqiao i plant in case study 1 is shown in fig 12 as can be seen the developed milp based formulation ensures that the power output of all generating units avoid the head dependent pozs and that all units meet the requirements for the minimum online and offline time durations 3 2 case study 2 optimal generation scheduling in flood season the local inflow of the hydropower plants and day ahead market clearing price are significantly different in flood season compared to those in dry season hence it is necessary to verify the validity of the developed model when it is applied to the short term scheduling in flood season the power output of each hydropower plant in case study 2 is illustrated in fig 13 it can be seen that the total power output of the cascade plants also tracks the trend of the market clearing price as in dry season the tianshengqiao i plant tends to generate more power during high price electricity periods and less power during low electricity price periods in order to obtain higher profits however the tianshengqiao ii plant has to operate at maximum capacity during the day to avoid water spillage as much as possible due to its poor regulation performance moreover although the total power generation of tianshengqiao cascade plants has reached 51 763 mwh and is much higher than that obtained in case study 1 the total profit is close to that obtained in case study 1 due to the low electricity price in flood season the forebay water level of the two hydropower plants and the power output of all units in tianshengqiao i plant are presented in fig 14 and 15 respectively as can be seen the forebay water level of the two hydropower plants does not exceed the upper and lower limits and the power output of generating units successfully avoid the head dependent pozs in summary the above two case studies with different hydrological conditions and electricity prices indicate that the proposed model is able to effectively solve the short term generation scheduling problem of cascade hydropower plants with strong hydraulic coupling and head dependent pozs 3 3 case study 3 comparison with the benchmark model in order to highlight the advancement of the milp model developed in this paper another milp model that only considered the head dependent characteristics of pozs without considering the strong hydraulic coupling was also established and was selected as a benchmark model for comparison this model only used one tailwater curve of the tianshengqiao i plant corresponding to the 641 m forebay water level of the tianshengqiao ii plant the linear formulation of the pozs referred to ref díaz et al 2011 and other calculation conditions of the model referred to case study 1 the obtained forebay water level of the tianshengqiao ii plant is compared to that obtained from the benchmark model as shown in fig 16 it is apparent that the forebay water level of the tianshengqiao ii plant obtained from the two different models is quite different this difference can be attributed to two points 1 without considering the dynamic tailwater effects the total water discharge of the tianshengqiao i plant is significantly different to that obtained from the proposed model even though the forebay water level shows little change 2 the regulation performance of the tianshengqiao ii plant is poor resulting in its forebay water level being very sensitive to the change of inflow based on the actual tailwater level curves the actual power output and pozs of all units in tianshengqiao i plant were recomputed using the generating water flow of each unit and the forebay water levels obtained from the benchmark model the comparisons between the actual power output of each unit and that obtained from the benchmark model are given in fig 17 it can be observed that the obtained power output of hydropower units based on the benchmark model is not realistic because the model does not consider the dynamic tailwater effects and therefore misestimates the net head moreover although the approximation technique of the head dependent pozs is appropriate the actual power output of all units still falls into their respective pozs during hours 10 14 and 19 22 suggesting that these units may operate in the pozs if the benchmark model is used to determine the generation scheduling of tianshengqiao cascade hydropower plants this also confirms that it s important to consider the operational constraints of cascade hydropower plants comprehensively to make the optimization model more accurate it s worth noting that the proposed model and the commercial solver gurobi can be integrated into the decision support system dss for determining the short term generation scheduling of tianshengqiao or other cascade hydropower plants in this case the operators of cascade hydropower plants only need to input the forecasted local inflow of the hydropower plants the forecasted day ahead market clearing price and the initial and target forebay water level of each reservoir into the dss and the scheduling results e g power output of each hydropower unit and forebay water level of each reservoir can then be obtained the system embedded with the proposed model and approach is believed to greatly reduce the workload of the operators and realize the accurate and optimal scheduling of the cascade hydropower plants 4 conclusion in this paper an milp based optimization model for the short term generation scheduling of cascaded hydropower plants was developed this model mainly focused on addressing two important issues namely the strong hydraulic coupling between cascade hydropower plants and the head dependent prohibited operating zones pozs of individual hydropower units the daily operation of the tianshengqiao cascade hydropower plants which are located in the hongshui river in the southwest of china was used to verify the performance of the developed model based on the obtained optimization results conclusions can be drawn as follows 1 the linear approximations of tailwater level curves and multiple irregularly shaped pozs have merit with respect to accurately describing the strong hydraulic coupling and the head dependent characteristics of pozs and can ensure considerable power generation benefits while maintaining the safe and stable operation of hydropower plants 2 generation scheduling obtained from the state of the art model that only considers the head dependent characteristics of pozs without considering the strong hydraulic coupling is significantly different from that obtained from the proposed model moreover it deviates from the actual operation of cascade plants to a large extent and is even infeasible compared with the state of the art optimization model the proposed model can produce more realistic and executable generation scheduling 3 the proposed milp model can be successfully applied to solve the very complicated problem of short term hydro generation scheduling in different operating conditions with the aid of efficient commercial solvers it can obtain a satisfied solution within an acceptable computation time as there are a lot of large cascade hydropower plants with strong hydraulic coupling and head dependent prohibited operating zones in southwestern china the research presented in this paper is believed to be of great significance and could provide an effective reference for the daily operation of these hydropower plants however it is still difficult to fully characterize the operating features of large scale hydropower systems due to the complex operational constraints and the limited solving techniques more operational constraints and the uncertain factors such as the uncertain electricity price and uncertain inflow need to be considered in future research to further increase the accuracy and the engineering application value of the proposed model besides model decomposition techniques and parallel techniques should be integrated into the solution method to further improve the solution efficiency credit authorship contribution statement chengguo su methodology software writing original draft wenlin yuan conceptualization funding acquisition chuntian cheng supervision writing review editing peilin wang data curation formal analysis lifei sun validation visualization taiheng zhang investigation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the work described in this paper was supported by the national natural science foundation of china no 51779229 and 91547201 and the scientific research projects of henan province no 202102310296 we also thanks to the anonymous reviewers whose comments have helped improve the quality of this paper 
5098,streamflow is the major factor influencing the evolution of solute concentration in river water and different modelling approaches exist to characterize the dependency of ion concentration to discharge the simplest are based on measurable quantities stream discharge and stream ion concentration but do not allow for an explicit physical flow path interpretation the more complex are based on mixing assumptions with different end members sources but require the knowledge of unmeasurable flow components we present here a new concentration discharge model which associates a classical concentration discharge relationship with a classical two component mixing equation the originality of our approach lies in the fact that we do not proceed in the usual way to perform the hydrograph separation we use an a priori assumption of the baseflow quickflow separation to infer the source concentration values contrarily to the usual inverse approach the other notable originality is that all the parameters of this model depend on the temporal variation of the stream discharge this combined model was tested on high frequency ion concentration series from the oracle orgeval observatory france this work demonstrates that high temporal resolution data allows for explicit testing of model performance across different hydrologic scales results show that the combined mixing model allows a better estimation of streamflow solute concentration series for most ions tested at inter annual scale except for nitrate which do not exhibit a clear c q relationship our results also confirm the advantage of coupling a time dynamic hydrological model with static c q relations for each of the flow components keywords concentration discharge relationships high frequency measurements mixing equations rdf hydrograph separation 1 introduction concentration discharge c q relationships are interesting for a variety of purposes and potential users and because they employ simple approaches to describe complex hydro chemical interactions hydrologists and geochemists have been using and exploring them for over 70 years see chanat et al 2002 durum 1953 hem 1948 johnson et al 1969 kirchner 2019 moatar et al 2017 the established relations can be purely empirical used to infill lacking concentration data and compute fluxes over long time periods or to characterize the regime export of chemical components in a number of catchments and empirically derive euristic patterns on a regional and global scale e g bieroza et al 2018 meybeck and moatar 2012 moatar et al 2017 in some cases the relations have been derived from a more complex model describing a physical representation of water circulation and composition from various mixing sources with the objective to derive relevant information on internal functionning johnson et al 1969 to model c q relationships two classical approaches exist the temporal c q patterns relationship i e fit parameters of c vs q musolff et al 2017 try to explain the processes controlling the mobilization and delivery of chemical elements into streams i e export regimes dilution flow enhancement or no variation at all see e g salmon et al 2001 as well as biogeochemical transformations in river networks minaudo et al 2019 these models are first and foremost based on observations of concentrations relatively stable over time as electro conductivity ec or chlorides durum 1953 hem 1948 often the main objective is to identify the groundwater contribution to streamflow durum 1953 these models are based on measurable quantities discharge and in stream chemical concentrations durum 1953 hem 1948 tunqui neira et al 2020 see example eq 1 and eq 2 in table 1 the more complex n component models have in addition the aim of quantifying the sources of the chemical concentrations measured in the river barthold et al 2011 introduced at the end of the 1960s hubert et al 1969 johnson et al 1969 pinder and jones 1969 they are based on the chemical contribution of hydrological sources i e groundwater runoff precipitation assuming each one can be characterized by a constant concentration and assuming the existence of a methodology to identify the relative contribution of each source to streamflow this mixing approach is based on the mass balance equation see its simplest expression eq 3 table 1 hall 1970 gives an exhaustive presentation of these models their different expressions and assumptions the mixing model was applied at different time scale from flood and event scale hubert et al 1969 pinder and jones 1969 to annual scale johnson et al 1969 and for different purposes such as hydrograph separation pinder and jones 1969 understanding of flowpaths in catchment johnson et al 1969 or the dynamics of the components of storm flow hubert et al 1969 despite their simplicity the power law models can yield excellent fits for some ions explaining up to 90 of the variance of the concentrations for this reason they are still widely used today barco et al 2008 godsey et al 2009 moatar and meybeck 2007 probst and bazerbachi 1986 however several authors have criticized the power law models underlining that they lump different hydro chemical processes and dynamics and do not allow for an explicit physical flow path interpretation moatar et al 2017 rose et al 2018 godsey et al 2009 compared different c q models and concluded that it is difficult to find simple generalizable models that accurately represent the typical shape of the c q relationship which are internally consistent and make plausible assumptions about catchment behavior the variability of c q relationships could be due to a large number of processes varying in space time and with the characteristics of the catchment the exact mechanisms leading to c q relations remain an open question both natural and anthropogenic factors affect the biogeochemical response of streams and while the majority of solutes show identifiable behaviors in individual catchments only a minority of behaviors can be generalized botter et al 2019 some recent studies attempt to differentiate two distinct behaviors chemodynamic and chemostasic export chemostasic export is defined as relatively small variations in concentrations compared to discharge musolff et al 2015 thompson et al 2011 chemostasis could be associated with constant rate of chemical weathering godsey et al 2009 a legacy storage of anthropogenic nutriment which buffer the variability in concentrations basu et al 2010 clow and mast 2010 or with a significant hydraulic residence time compared to weathering kinetics ameli et al 2017 maher 2011 chemostasic export processes could represent the long term trend of basin chemistry and can therefore be identified as an average of concentrations musolff et al 2015 chemodynamic patterns are characterized as high variations in concentrations compared to discharge caused by flushing enrichment behavior or dilution behavior musolff et al 2015 it can be controlled i by activation of solute sources heterogeneously distributed in space ii by threshold driven transport of constituents or iii high reactivity of constituents jones et al 2017 musolff et al 2015 vaughan et al 2017 zhang et al 2016 we could also note that zhang et al 2016 emphasized that temporal patterns c q models including the b parameter of eq 1 may vary over time or with season and a single b coefficient for the entire period of record is over simplification and potentially misleading the other difficulty of a generalization is also the difference in behavior and source of the different ions beyond the patterns changes can occur whether due to weathering meteorological or anthropic processes affecting one ion more than another knapp et al 2020 musolff et al 2017 rose et al 2018 zhi et al 2019 to deal with the non linearity of the c q relationship some authors have proposed to increase the number of hydrological components e g evans and davies 1998 probst 1985 make specific catchment calibration godsey et al 2009 consider flow classes e g low and high flows meybeck and moatar 2012 moatar et al 2017 or integrate significant time steps kirchner 2019 to gain insight into the linkages between chemical and hydrologic processes that yield the observed concentration discharge relationship research has often focused on only one of the modeling solutions i e on either power law model or mixing model the temporal patterns dilution constant enrichment or the mass balance end members mixing approaches are operational and widely used to describe c q relationships there are also other compound methods in the literature based on solute production models ibarra et al 2016 maher 2011 maher and chamberlain 2014 or on end members models bao et al 2017 bouchez et al 2017 zhi et al 2019 however none offers a parsimonious and generalized approach as proposed in this paper to date no simple conceptual model still allows combining a dynamic of concentrations with a dynamic of water flow the new model proposed in this paper is trying to solve this problem by combining the two approaches i e power law and mixing model the originality of our approach is that we do not proceed by assuming an end member concentration value to perform the baseflow quickflow separation but we use instead the inverse approach an a priori assumption of the baseflow quickflow using a hydrological hydrograph separation method to infer the source concentration values all the parameters of the model proposed depend on the temporal variation of the stream discharge using the high frequency series of concentrations and discharges observed during two years on the oracle orgeval observatory france we have tested the performances of this new model at different hydrological time scales and on a full range of flow and concentration the first aim of this paper is to present the model and its validation on one long high frequency time series the second aim is to discuss of its performances with regards to the classical models note that this paper is methodological it does not focus on the different hydro chemical processes involved in the composition of the stream solutes or on others watershed functioning considerations 2 the combined mixing model the combined model tested here associates a c q relationship with a two component mixing equation as c q relationship we use the two sided affine power scaling relationship 2s aps which we recently proposed to fit the c q relationship as a natural extension of the well known and widely used power law relationship see tunqui neira et al 2020 as mixing equation we use the simplest of the existing schemes i e a two component equation distinguishing base flow and quick flow e g pinder and jones 1969 to combine the 2s aps relationship with the two component mixing equation see eq 2 and eq 3 table 1 we propose to write the concentrations of each of components in eq 3 i e c b and c q as a function of total discharge using the same transformation c b a b b b q 1 n n c q a q b q q 1 n n the total discharge and not the discharge of each of the two hydraulic components was used to seek simplification not increasing too much the number of parameters we will discuss later the value of this simplification then the mixing equation becomes 4 c a b b b q 1 n n q b q a q b q q 1 n n q q q the combining procedure merges the two most used forms of equations of the hydro chemical literature i e eq 2 and eq 3 the advantage of this new model is to improve the mixing approach by introducing dynamic concentrations for the sources depending on the values taken by parameters a and b in eq 4 three schematic situations can be identified briefly described below and illustrated by fig 1 2 1 case 1 chemostatic components bb bq 0 in this case c b and c q are constant and independent of river discharge thus c is only influenced by the discharge components dynamics q b and q q see case 1 in fig 1 the case 1 represents the chemostatic export characterizing a catchment controlled by large legacy stores see musolff et al 2015 it corresponds to the assumption of the classical mixing equation approach where the c b and c q values can assume for example the average of concentrations measured respectively during the dry and wet seasons i e saraiva okello et al 2018 stewart et al 2007 zhang et al 2013 2 2 case 2 single 2s aps relationship ab aq a and bb bq b this case reduces to c b c q case 2 in fig 1 and to the simple c q relationship c a b q 1 n n the observed concentration is only a function of discharge 2 3 case 3 general case a and b are different this is the general case of the transformed mixing equation eq 4 unlike the classical mixing equation chemostatic components the c b and c q values are not constant but vary individually as a function of stream flow see case 3 in fig 1 the general case allows accounting for the temporal variation of the chemical components it allows connecting concentration with total discharge and the hydrograph separation components q b and q q i e with q q q q b see table 1 3 material and methods 3 1 study site and datasets the combined model eq 4 was applied to the high frequency hydro chemical dataset measured at the oracle orgeval observatory tallec et al 2015 by the river lab floury et al 2017 the oracle orgeval observatory is a small catchment located 70 km east of paris france it is subjected to a temperate and oceanic climate with annual average temperature of 11 1 c and a mean annual rainfall of 674 31 mm tallec et al 2013 the average measured streamflow at the avenelles outlet sub catchment of 46 km2 and location of the river lab on the oracle orgeval observatory is about 0 2 m3 s 1962 2017 with minimum flows in summer 0 1 m3 s and floods up to 10 m3 s in winter and spring with respect to geology the catchment is underlain entirely by limestone rocks with two aquifers the shallower aquifer of the brie limestone and the deeper champigny limestone aquifer mouhri et al 2013 land use is mostly agricultural with few villages and with intensive farming practices mainly based on mineral nitrogen fertilization garnier et al 2016 nearly 60 of the surface of the catchment is drained with tile drains among all ions measured every 30 min by the river lab laboratory we used 3 ions see table 2 whose behavior exhibit notable differences in the orgeval catchment sulfate nitrate and chloride chloride mainly come from rain inputs during the wet season and to a smaller extent from fertilizers floury et al 2018 sulfate comes from the chemical weathering of gypsum which makes it highly variable depending on the season and the leaching of concerned localized underground layers floury et al 2018 mouchel et al 2016 nitrate mostly come from agricultural activities and fertilizers inputs with specific seasonal leaching rates garnier et al 2016 finally we also used electro conductivity reflecting the presence of all ions in stream water ec see table 2 the main data set flow rates and chemical concentrations covers the period between june 2015 and march 2018 table 2 i e 20 700 measurements over 33 months to perform a split sample test according to klemeš 1986 we divided the dataset into two periods table 2 presents a first period used for the model calibration and a second period for the model validation 3 2 hydrograph separation to apply the combined mixing model eq 4 we have to separate the hydrograph in order to compute the values of base flow q b and quick flow q q to perform the baseflow quickflow separation because we do not know the source concentration values we use an a priori assumption of the baseflow quickflow separation to infer the source concentration values and not the usual inverse approach in this study we use the recursive digital filter rdf hydrograph separation approach the rdf approach adapted in the late 1970s from the signal processing theory is widely applied for hydrograph separation indeed rdf methods are computationally efficient easily automated and applied to long continuous streamflow records chapman 1991 eckhardt 2005 among all the rdf methods existing in literature brodie et al 2007 p 62 we used the well known lyne hollick method lh rdf method lyne and hollick 1979 nathan and mcmahon 1990 base flow is considered here as a low frequency signal and surface runoff as a high frequency signal by filtering out the high frequency signal the low frequency signal i e base flow can be revealed longobardi and loon 2018 nathan and mcmahon 1990 the lh rdf method is defined as follows 5 q b t 1 m i n α τ q b t 1 α τ 2 q t 1 q t q t where q b q α τ and t are respectively the baseflow the total flow the lh rdf filter parameter and the time iterative application of the filter allows smoothing data and nullifying phase distortion we have used the forward backward forward application proposed by nathan and mcmahon 1990 the lh rdf method is characterized by one parameter α τ which defines the speed of convergence of the filter it is a common practice e g longobardi et al 2016 zhang et al 2017 to adapt the filter parameter α τ to the hydrological recession time constant of the catchment τ otherwise either q b or q q would have an unwanted behavior on a seasonal time scale too slow convergence of q b or too fast decrease of q q during flood events another important reason for this adaptation is that the default value of α τ 0 925 proposed by nathan and mcmahon 1990 applied in small catchments controlled by the regional scale factors such as slope and shape has shown poor performance when computing q b ladson et al 2013 zhang et al 2017 during seasons without significant recharge stream flow may recess exponentially and follows the form 6 q t δ t q t e x p δ t τ q t k where k is the so called recession constant of the catchment the recession constant k can be obtained using the master recession curve mrc approach nathan and mcmahon 1990 a linear regression i e plot q t 1 vs q t see fig 2 a allows establishing the recession constant k which also represents the α τ parameter of lh rdf method eq 5 this analysis was applied on daily flow data of the avenelles station from january 1 2000 to september 2018 as follows the daily stream flow data of several seasons were overlapped according to the day of the year starting from the beginning of june and assuming that the stream flow decreases under a continuous recession process for the period june september the k value obtained about 0 90 has been calculated for a daily discharge see fig 2a however for high frequency discharge measurements i e time step of 30 min or 0 5 h this value must be transformed at the appropriate time step as proposed by eckhardt 2008 k 0 5 h k j 0 5 24 0 99 with the lh rdf method i e eq 5 and the calibrated value of k i e 0 99 for the avenelles catchment we computed the values of the base flow q b and the quick flow q q see example of the results fig 2b we should not fail to mention here that the baseflow quickflow methods have been widely criticized see e g beven 1991 for a vibrant indictment against them and the arguments raised by pelletier and andréassian 2019 in the discussion of their paper for a careful use of them we do not wish to enter this debate we will not claim to have identified a precise physical pathway and in this paper we will thus limit our ambition to the identification of what pelletier and andréassian 2020 have named the not too delayed and the delayed enough flow components baseflow and quickflow 3 3 calibration of n a a n d b parameters the combined mixing model eq 4 was applied with the baseflow calculated by the lh rdf method for each ion and the ec we used the parameter n previously determined by tunqui neira et al 2020 on the same data set but without flow separation the extremely large number of values in this high frequency dataset may cause problems for a robust identification of a b parameters over the full range of discharges using a simple linear regression indeed the largest discharge values are in small numbers in our dataset only 1 of discharge values are in the range 2 6 m3s 1 12 2 m3s 1 and they correspond to the lowest concentrations to address this question we successively tested a large number of a b pairs from eq 4 n remaining fixed each pair yields a series of simulated concentrations c sim that can be compared with the observed concentrations c obs among the many numerical criteria that could be used we chose the bounded version of the nash and sutcliffe 1970 efficiency criterion nseb mathevet et al 2006 which is commonly used in hydrological modeling nseb can be computed on concentrations or on discharge weighted concentrations which corresponds to the load we chose the average of both because we found that it allows more weight to be given to the lowest concentrations and thus to avoid the issue of under representation of high discharge low concentration measurement points if other criteria exists to test the model performances the nseb comb has the advantage to privilege neither the load nor the concentration and integrates both in a single criterion table 3 presents the formula for these numerical criteria we retained as optimal the pair of a b that yielded the highest nseb comb value we explored in a systematic fashion the range 1 5 for a and 1 2 1 2 for b for each ion and for ec table 4 presents the results obtained for the n a a n d b parameters calibrated for the avenelles sub catchment and their corresponding optimal nseb comb criterion although the parameters of the combined mixing model are shown here we will not discuss them in this paper indeed for now without generalized studies covering several catchments it is not possible to interpret them physically note that for these reasons we have chosen to present table 4 in this section and not in the results and discussion section 3 4 performances of the model we evaluate the combined model performance in calibration and validation mode due to the temporal density of the dataset we have tested the performances of the models in calibration mode on widely different discharge ranges over the entire calibration period and for selected storm events from june 2015 to july 2017 see table 2 chapter 3 1 in validation mode the performances have only been assessed over the entire period from august 2017 to march 2018 see table 2 chapter 3 1 the bias and the standardized root mean square error srmse allow assessing respectively accuracy and precision of the combined mixing model table 5 presents the formula for these numerical criteria 4 results and discussion 4 1 performance of the combined model over the entire period table 6 presents the evaluation of the combined mixing model in calibration and validation mode over the entire period whatever the mode calibration or validation and whatever the solute species considered the optimal srmse and bias values are obtained for the general case case 3 see table 6 the results also show that a single 2s aps relationship case 2 explains better the variations of the stream water concentrations than a mass balance equation with constant concentration components case 1 see srmse and bias values from case 1 to case 2 table 6 this means that within the adopted modelling framework and in as much as the hydrograph separation can be considered as hydrologically relevant the concentrations of the flow components cannot be considered constant across time i e the behavior of the avenelles catchment is non chemostatic the stream water quality of the avenelles sub catchment appears strongly influenced by discharge processes the most evident improvement of the case 3 model is observed for chloride and ec see srmse of 5 with a negative bias less than 0 5 in calibration mode table 6 less importantly sulfate srmse is also much improved when variable concentrations are introduced in the quick and slow components see srmse around 10 case 3 in calibration and validation mode table 6 in calibration mode the sulfate bias is comparable to that obtained for chloride and ec less than 0 5 see table 6 according to floury et al 2018 chloride would come from the brie aquifer with mainly external input from rainfall during the wet season according to mouchel et al 2016 the variability of sulfate concentrations is related to the spatial heterogeneity of gypsum lenses and to the temporary variability of the water table heights the spatial and temporal variability of sulfate and chloride concentrations is due to several chemo dynamical processes well modeled by the general case case 3 the lowest values of the general case are obtained for nitrate see srmse about 27 6 and a bias about 11 2 case 3 in calibration mode and both 100 in validation mode table 6 nitrate present the largest seasonal variability strongly related to farming practices garnier et al 2016 and chemo dynamic processes especially in the hyporheic zone floury et al 2018 this larger variability either environmental or anthropogenic cannot be simulated by our model whatever the case fig 3 illustrates the simulations of the models in the first period of calibration in regard with the observed time series as theoretically expected see fig 1 the simulated concentrations are more or less dispersed from linear case 2 to very dispersed case 1 see fig 3 the case 3 as shown previously by the srmse and the bias see table 6 is the one closest to the observed concentrations for the nitrate while cases 1 and 2 seem to overestimate the concentrations case 3 has the advantage despite its poor performance of covering all the nitrate concentration values a significant feature common to almost all ions except nitrate and sulfate and cases of the model is the lower c q concentration compared to c b see black lines vs pink lines fig 3 for the nitrate ion c q concentration becomes a more important contributor in the three cases until becoming preponderant in the case 3 see nitrate pink line fig 3 for sulfate c q is the main contributor to the stream concentration for discharges greater than 0 5 m3 s 1 see sulfate pink lines fig 3 this result confirm studies carried out at the orgeval oracle observatory billy et al 2013 floury et al 2018 garnier et al 2016 mouchel et al 2016 mouhri et al 2013 indeed according to the results the principal contributor to the stream concentration in the avenelles catchment would be first groundwater i e c b for chloride and ec during the wet season i e for the discharge beyond 0 5 m3 s 1 for the sulfate and whatever the season for nitrate the principal contributor is the quickflow concentrations i e c q however the combined mixing model does not seem to be able to consider the quickflow concentrations in a good way i e integrating either the variations of the sub surface hydrological compartment or the variations of concentrations linked to this compartment 4 2 performances of the combined model for selected storm events we selected two representative flood events of short duration at the end of fall november 2015 low groundwater level low soil moisture and no contribution of tile drains see fig 4 a and during winter february 2016 high groundwater level high soil moisture and tile drains contribution see fig 4b a longer wet season flood event of march 2016 well covered during 15 days by the concentration data set is also added see fig 4c fig 4 presents observed data and the three cases of simulations with the combined mixing model as a function of time for the three events for the three selected storm events table 7 presents the srmse and bias values obtained in a calibration mode with the three cases of the combined model at the event scale except for nitrate during the dry season we obtain the same results than with the entire period the case 3 shows the optimal srmse and bias values for all ions and ec see srmse and bias from case 1 to case 3 table 7 the potential advantage of the general case of the combined mixing model case 3 is to decouple rising and decreasing flow periods with changing q q q and q b q ratios see hydrograph separation fig 4 the recursive filter is efficient in separating the base flow from the quick flow it simulates a quick response of the quick flow at the beginning of flood periods and a progressive increase of the base flow during the second part of flood periods accordingly the two components model improves the simulation of complex concentration changes during flood events we notice that the best results are obtained for the longest flood period the performances of the case 3 are improved for the long event compared to short events see srmse and bias from short event to long event during wet period table 7 as shown in fig 4c because of the longer duration of the flood the recursive filter simulates important variations of the q q q b ratio during the event during most of peak flow period most of the discharge is due to the quick flow component while the quick flow component turns back to zero after day 10 as expected from the wider range of q q q b ratio the model simulates more difference between concentrations during the rising part of the event than the descending part fig 4c we also observe that during short events the simulated concentrations are slightly shifted compared to the observed concentration see example for ec fig 4 this comes from the limit of our hydrograph separation filter in a flood with a longer duration the bias due to the time lag is less significant and a wider distribution of the q q q b ratio as simulated by the rdf method is expected see fig 4 during the wet and dry hydrological seasons almost all ions behavior except for nitrates and ec show a dilution pattern with water of lower concentration followed by a step of increasing concentration see dotted black line c obs fig 4 a common pattern with three stages can be observed in most storm events during the first stage we observed a slight increase in concentration during the initial increase in the discharge then in the second stage which is generally short in time the concentrations strongly decrease while the discharges quickly increase in the third stage both concentrations increase again while discharges continue to decrease and once more reach a lower flow and higher concentration see fig 4 to discuss the performances obtained for each case of our combined model we use the stages outlied above the first stage would correspond to a pre event pattern during which the concentrations come mostly from the groundwater pool evans and davies 1998 rose et al 2018 the following stages correspond to the emergence of soil waters and or runoff mixing in varying proportions during the event evans and davies 1998 rose et al 2018 see fig 4 the contribution of these pools and the dilution that accompanies it persists for some time after the peak flow but in increasingly weaker proportions compared with those of the groundwater note that in the dry season for all ions and ec the soft dilution stage first stage is interrupted by rapid and abrupt dilution fig 4 this last dilution would correspond to a larger proportion of rain water it is indistinguishable during the wet season because rain water is mixed with water from tile drains during this period of the year billy et al 2013 in all storm events dry and wet for all ions except nitrate and ec case 3 best simulates the third stage of the storm event where the mixing of two end members is most evident see fig 4 in the second stage of the wet season storm events fig 4b and c we can observe that for the chloride and sulfate ions and ec the 3 cases have an adequate performance although none manages to simulate the maximum dilution point see fig 4 in the dry season storm event fig 4a the second stage of chloride and sulfate ions and ec is better simulated by case 2 followed nearby case 3 case 1 has the lowest performance of the simulations in this stage finally in the first stage of each of the storm events for the chloride ion sulfate ion and ec we note the same dynamics that occurred with the second stage for case 1 and 2 case 3 performs better c obs during the 2 storm events of the wet season and case 2 performs better in the storm event of the dry season see fig 4a from this analysis we can deduce that in the dry season fig 4a the first and second stages are almost completely dominated by the groundwater pool both in terms of concentration and discharge minimizing the other contributing pools i e soil runoff represented by c q and q q for this reason case 2 assuming total discharge q q groundwater has the better performance in simulating the c obs of chloride and sulfate ions in addition to ec however in the wet season events fig 4b and c and although in the first and second stage the groundwater pool is still the main contributor the contribution of the other pools i e soil runoff represented by c q and q q are much more notorious therefore case 3 has better performances for chloride and sulfate ions and ec in the case of nitrates we must acknowledge that the combined mixing model fails to fit the observed data whatever the event see nitrates fig 4 unlike other ions nitrates are more concentrated in soils and drain water than in groundwater or rainwater according to garnier et al 2014 in the avenelles sub catchment sub root nitrate concentrations average 22 mgn l 1 close to the average concentration observed in drains in the same area 26 mgn l 1 nitrate concentrations in the brie aquifer are only around 13 2 mgn l 1 whereas in rainfall they are about 0 75 mgn l 1 mouchel et al 2016 floury et al 2018 for nitrate ions a third component representing soil water would be needed as well as an appropriate parameterization of the seasonal nature of fertilizer applications several studies burns et al 2019 sebestyen et al 2014 have demonstrated that for nitrate ion more than two different concentration pools i e groundwater soil water etc are involved in rising and declining limbs of hydrograph 5 conclusions 5 1 synthesis the new concentration discharge model presented in this paper associates a classical concentration discharge relationship with a classical two component mixing equation the originality of our approach lies in the fact that we do not proceed in the usual way by assuming a source concentration value to perform the baseflow quickflow separation we use the inverse approach and use an a priori assumption of the baseflow quickflow separation to infer the source concentration values our approach allows a better estimation of streamflow ionic concentration series for most ions at inter annual scale except for nitrate which do not exhibit a clear c q relationship with improved bias and srmse criteria this shows the advantage of coupling a time dynamic hydrological model with static c q relations for each of the flow components 5 2 limits of our approach the first limit of our approach is apparent for the nitrate case nitrate are known to be poorly described by concentration discharge relationships and our model does not allow improving much the issue the two member hydrograph separation tested here may be a limiting factor for nitrate ions the two components hydrograph separation c q and c b seems to be inadequate while for sulfate chloride and ec it seems sufficient the base flow separation method used in this article carries naturally its share of uncertainties due to the arbitrary and speculative hypotheses used in its conception beven 1991 brutsaert 2008 cheng et al 2016 the simple separation into two components cannot explain the complexity of the behavior of the nitrate ions indeed several studies miller et al 2017 probst 1985 have shown that the introduction of a third component which would come to represent the soil pool component is a prerequisite to represent the behavior of nitrate we also need to underline that we acknowledge that our approach remains conceptual and we do not claim to have identified physically the water masses that produce the quick and base flow 5 3 further perspectives as the model does not simulate the decoupling of discharge and concentration patterns due to a short time lag explained by hydraulic mechanisms doing so would be an interesting extension of this work an isotope study would be helpful to this aim another priority would be to test the implementation of our model elsewhere especially on high frequency water quality stations kirchner et al 2004 different types of chemical signatures reflecting different types of hydrological and hydro chemical functions underlying the transfer processes could be studied in detail including different flow decomposition concepts and may be other c q relations possibly including specific seasonal features another alternative would be to test this new methodology with other hydrograph separation methods than the rdf lyne hollick to prove their validity e g the methods developed by eckhardt 2005 pelletier and andréassian 2020 if high frequency measurements become more and more available for science kirchner et al 2004 their implementation at large scale still difficult and low frequencies measurements i e daily weekly remain the rule moatar et al 2017 thus it remains important to continue methodological development through modelling which allow us with a limited number of measurements and a good representativeness to assess the quality of rivers in large scale in the framework of low frequency monitoring ultimately further developments of the combined mixing model should go in this direction credit authorship contribution statement josé manuel tunqui neira conceptualization methodology software writing original draft gaëlle tallec data curation writing review editing vazken andréassian conceptualization methodology writing review editing supervision jean marie mouchel writing review editing supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the first author acknowledges the peruvian scholarship cienciactiva of concytec grant no 099 2016 fondecyt de for supporting his phd study at inrae and the sorbonne university the authors acknowledge the equipex critex program grant no anr 11 eqpx 0011 for the data availability 
5098,streamflow is the major factor influencing the evolution of solute concentration in river water and different modelling approaches exist to characterize the dependency of ion concentration to discharge the simplest are based on measurable quantities stream discharge and stream ion concentration but do not allow for an explicit physical flow path interpretation the more complex are based on mixing assumptions with different end members sources but require the knowledge of unmeasurable flow components we present here a new concentration discharge model which associates a classical concentration discharge relationship with a classical two component mixing equation the originality of our approach lies in the fact that we do not proceed in the usual way to perform the hydrograph separation we use an a priori assumption of the baseflow quickflow separation to infer the source concentration values contrarily to the usual inverse approach the other notable originality is that all the parameters of this model depend on the temporal variation of the stream discharge this combined model was tested on high frequency ion concentration series from the oracle orgeval observatory france this work demonstrates that high temporal resolution data allows for explicit testing of model performance across different hydrologic scales results show that the combined mixing model allows a better estimation of streamflow solute concentration series for most ions tested at inter annual scale except for nitrate which do not exhibit a clear c q relationship our results also confirm the advantage of coupling a time dynamic hydrological model with static c q relations for each of the flow components keywords concentration discharge relationships high frequency measurements mixing equations rdf hydrograph separation 1 introduction concentration discharge c q relationships are interesting for a variety of purposes and potential users and because they employ simple approaches to describe complex hydro chemical interactions hydrologists and geochemists have been using and exploring them for over 70 years see chanat et al 2002 durum 1953 hem 1948 johnson et al 1969 kirchner 2019 moatar et al 2017 the established relations can be purely empirical used to infill lacking concentration data and compute fluxes over long time periods or to characterize the regime export of chemical components in a number of catchments and empirically derive euristic patterns on a regional and global scale e g bieroza et al 2018 meybeck and moatar 2012 moatar et al 2017 in some cases the relations have been derived from a more complex model describing a physical representation of water circulation and composition from various mixing sources with the objective to derive relevant information on internal functionning johnson et al 1969 to model c q relationships two classical approaches exist the temporal c q patterns relationship i e fit parameters of c vs q musolff et al 2017 try to explain the processes controlling the mobilization and delivery of chemical elements into streams i e export regimes dilution flow enhancement or no variation at all see e g salmon et al 2001 as well as biogeochemical transformations in river networks minaudo et al 2019 these models are first and foremost based on observations of concentrations relatively stable over time as electro conductivity ec or chlorides durum 1953 hem 1948 often the main objective is to identify the groundwater contribution to streamflow durum 1953 these models are based on measurable quantities discharge and in stream chemical concentrations durum 1953 hem 1948 tunqui neira et al 2020 see example eq 1 and eq 2 in table 1 the more complex n component models have in addition the aim of quantifying the sources of the chemical concentrations measured in the river barthold et al 2011 introduced at the end of the 1960s hubert et al 1969 johnson et al 1969 pinder and jones 1969 they are based on the chemical contribution of hydrological sources i e groundwater runoff precipitation assuming each one can be characterized by a constant concentration and assuming the existence of a methodology to identify the relative contribution of each source to streamflow this mixing approach is based on the mass balance equation see its simplest expression eq 3 table 1 hall 1970 gives an exhaustive presentation of these models their different expressions and assumptions the mixing model was applied at different time scale from flood and event scale hubert et al 1969 pinder and jones 1969 to annual scale johnson et al 1969 and for different purposes such as hydrograph separation pinder and jones 1969 understanding of flowpaths in catchment johnson et al 1969 or the dynamics of the components of storm flow hubert et al 1969 despite their simplicity the power law models can yield excellent fits for some ions explaining up to 90 of the variance of the concentrations for this reason they are still widely used today barco et al 2008 godsey et al 2009 moatar and meybeck 2007 probst and bazerbachi 1986 however several authors have criticized the power law models underlining that they lump different hydro chemical processes and dynamics and do not allow for an explicit physical flow path interpretation moatar et al 2017 rose et al 2018 godsey et al 2009 compared different c q models and concluded that it is difficult to find simple generalizable models that accurately represent the typical shape of the c q relationship which are internally consistent and make plausible assumptions about catchment behavior the variability of c q relationships could be due to a large number of processes varying in space time and with the characteristics of the catchment the exact mechanisms leading to c q relations remain an open question both natural and anthropogenic factors affect the biogeochemical response of streams and while the majority of solutes show identifiable behaviors in individual catchments only a minority of behaviors can be generalized botter et al 2019 some recent studies attempt to differentiate two distinct behaviors chemodynamic and chemostasic export chemostasic export is defined as relatively small variations in concentrations compared to discharge musolff et al 2015 thompson et al 2011 chemostasis could be associated with constant rate of chemical weathering godsey et al 2009 a legacy storage of anthropogenic nutriment which buffer the variability in concentrations basu et al 2010 clow and mast 2010 or with a significant hydraulic residence time compared to weathering kinetics ameli et al 2017 maher 2011 chemostasic export processes could represent the long term trend of basin chemistry and can therefore be identified as an average of concentrations musolff et al 2015 chemodynamic patterns are characterized as high variations in concentrations compared to discharge caused by flushing enrichment behavior or dilution behavior musolff et al 2015 it can be controlled i by activation of solute sources heterogeneously distributed in space ii by threshold driven transport of constituents or iii high reactivity of constituents jones et al 2017 musolff et al 2015 vaughan et al 2017 zhang et al 2016 we could also note that zhang et al 2016 emphasized that temporal patterns c q models including the b parameter of eq 1 may vary over time or with season and a single b coefficient for the entire period of record is over simplification and potentially misleading the other difficulty of a generalization is also the difference in behavior and source of the different ions beyond the patterns changes can occur whether due to weathering meteorological or anthropic processes affecting one ion more than another knapp et al 2020 musolff et al 2017 rose et al 2018 zhi et al 2019 to deal with the non linearity of the c q relationship some authors have proposed to increase the number of hydrological components e g evans and davies 1998 probst 1985 make specific catchment calibration godsey et al 2009 consider flow classes e g low and high flows meybeck and moatar 2012 moatar et al 2017 or integrate significant time steps kirchner 2019 to gain insight into the linkages between chemical and hydrologic processes that yield the observed concentration discharge relationship research has often focused on only one of the modeling solutions i e on either power law model or mixing model the temporal patterns dilution constant enrichment or the mass balance end members mixing approaches are operational and widely used to describe c q relationships there are also other compound methods in the literature based on solute production models ibarra et al 2016 maher 2011 maher and chamberlain 2014 or on end members models bao et al 2017 bouchez et al 2017 zhi et al 2019 however none offers a parsimonious and generalized approach as proposed in this paper to date no simple conceptual model still allows combining a dynamic of concentrations with a dynamic of water flow the new model proposed in this paper is trying to solve this problem by combining the two approaches i e power law and mixing model the originality of our approach is that we do not proceed by assuming an end member concentration value to perform the baseflow quickflow separation but we use instead the inverse approach an a priori assumption of the baseflow quickflow using a hydrological hydrograph separation method to infer the source concentration values all the parameters of the model proposed depend on the temporal variation of the stream discharge using the high frequency series of concentrations and discharges observed during two years on the oracle orgeval observatory france we have tested the performances of this new model at different hydrological time scales and on a full range of flow and concentration the first aim of this paper is to present the model and its validation on one long high frequency time series the second aim is to discuss of its performances with regards to the classical models note that this paper is methodological it does not focus on the different hydro chemical processes involved in the composition of the stream solutes or on others watershed functioning considerations 2 the combined mixing model the combined model tested here associates a c q relationship with a two component mixing equation as c q relationship we use the two sided affine power scaling relationship 2s aps which we recently proposed to fit the c q relationship as a natural extension of the well known and widely used power law relationship see tunqui neira et al 2020 as mixing equation we use the simplest of the existing schemes i e a two component equation distinguishing base flow and quick flow e g pinder and jones 1969 to combine the 2s aps relationship with the two component mixing equation see eq 2 and eq 3 table 1 we propose to write the concentrations of each of components in eq 3 i e c b and c q as a function of total discharge using the same transformation c b a b b b q 1 n n c q a q b q q 1 n n the total discharge and not the discharge of each of the two hydraulic components was used to seek simplification not increasing too much the number of parameters we will discuss later the value of this simplification then the mixing equation becomes 4 c a b b b q 1 n n q b q a q b q q 1 n n q q q the combining procedure merges the two most used forms of equations of the hydro chemical literature i e eq 2 and eq 3 the advantage of this new model is to improve the mixing approach by introducing dynamic concentrations for the sources depending on the values taken by parameters a and b in eq 4 three schematic situations can be identified briefly described below and illustrated by fig 1 2 1 case 1 chemostatic components bb bq 0 in this case c b and c q are constant and independent of river discharge thus c is only influenced by the discharge components dynamics q b and q q see case 1 in fig 1 the case 1 represents the chemostatic export characterizing a catchment controlled by large legacy stores see musolff et al 2015 it corresponds to the assumption of the classical mixing equation approach where the c b and c q values can assume for example the average of concentrations measured respectively during the dry and wet seasons i e saraiva okello et al 2018 stewart et al 2007 zhang et al 2013 2 2 case 2 single 2s aps relationship ab aq a and bb bq b this case reduces to c b c q case 2 in fig 1 and to the simple c q relationship c a b q 1 n n the observed concentration is only a function of discharge 2 3 case 3 general case a and b are different this is the general case of the transformed mixing equation eq 4 unlike the classical mixing equation chemostatic components the c b and c q values are not constant but vary individually as a function of stream flow see case 3 in fig 1 the general case allows accounting for the temporal variation of the chemical components it allows connecting concentration with total discharge and the hydrograph separation components q b and q q i e with q q q q b see table 1 3 material and methods 3 1 study site and datasets the combined model eq 4 was applied to the high frequency hydro chemical dataset measured at the oracle orgeval observatory tallec et al 2015 by the river lab floury et al 2017 the oracle orgeval observatory is a small catchment located 70 km east of paris france it is subjected to a temperate and oceanic climate with annual average temperature of 11 1 c and a mean annual rainfall of 674 31 mm tallec et al 2013 the average measured streamflow at the avenelles outlet sub catchment of 46 km2 and location of the river lab on the oracle orgeval observatory is about 0 2 m3 s 1962 2017 with minimum flows in summer 0 1 m3 s and floods up to 10 m3 s in winter and spring with respect to geology the catchment is underlain entirely by limestone rocks with two aquifers the shallower aquifer of the brie limestone and the deeper champigny limestone aquifer mouhri et al 2013 land use is mostly agricultural with few villages and with intensive farming practices mainly based on mineral nitrogen fertilization garnier et al 2016 nearly 60 of the surface of the catchment is drained with tile drains among all ions measured every 30 min by the river lab laboratory we used 3 ions see table 2 whose behavior exhibit notable differences in the orgeval catchment sulfate nitrate and chloride chloride mainly come from rain inputs during the wet season and to a smaller extent from fertilizers floury et al 2018 sulfate comes from the chemical weathering of gypsum which makes it highly variable depending on the season and the leaching of concerned localized underground layers floury et al 2018 mouchel et al 2016 nitrate mostly come from agricultural activities and fertilizers inputs with specific seasonal leaching rates garnier et al 2016 finally we also used electro conductivity reflecting the presence of all ions in stream water ec see table 2 the main data set flow rates and chemical concentrations covers the period between june 2015 and march 2018 table 2 i e 20 700 measurements over 33 months to perform a split sample test according to klemeš 1986 we divided the dataset into two periods table 2 presents a first period used for the model calibration and a second period for the model validation 3 2 hydrograph separation to apply the combined mixing model eq 4 we have to separate the hydrograph in order to compute the values of base flow q b and quick flow q q to perform the baseflow quickflow separation because we do not know the source concentration values we use an a priori assumption of the baseflow quickflow separation to infer the source concentration values and not the usual inverse approach in this study we use the recursive digital filter rdf hydrograph separation approach the rdf approach adapted in the late 1970s from the signal processing theory is widely applied for hydrograph separation indeed rdf methods are computationally efficient easily automated and applied to long continuous streamflow records chapman 1991 eckhardt 2005 among all the rdf methods existing in literature brodie et al 2007 p 62 we used the well known lyne hollick method lh rdf method lyne and hollick 1979 nathan and mcmahon 1990 base flow is considered here as a low frequency signal and surface runoff as a high frequency signal by filtering out the high frequency signal the low frequency signal i e base flow can be revealed longobardi and loon 2018 nathan and mcmahon 1990 the lh rdf method is defined as follows 5 q b t 1 m i n α τ q b t 1 α τ 2 q t 1 q t q t where q b q α τ and t are respectively the baseflow the total flow the lh rdf filter parameter and the time iterative application of the filter allows smoothing data and nullifying phase distortion we have used the forward backward forward application proposed by nathan and mcmahon 1990 the lh rdf method is characterized by one parameter α τ which defines the speed of convergence of the filter it is a common practice e g longobardi et al 2016 zhang et al 2017 to adapt the filter parameter α τ to the hydrological recession time constant of the catchment τ otherwise either q b or q q would have an unwanted behavior on a seasonal time scale too slow convergence of q b or too fast decrease of q q during flood events another important reason for this adaptation is that the default value of α τ 0 925 proposed by nathan and mcmahon 1990 applied in small catchments controlled by the regional scale factors such as slope and shape has shown poor performance when computing q b ladson et al 2013 zhang et al 2017 during seasons without significant recharge stream flow may recess exponentially and follows the form 6 q t δ t q t e x p δ t τ q t k where k is the so called recession constant of the catchment the recession constant k can be obtained using the master recession curve mrc approach nathan and mcmahon 1990 a linear regression i e plot q t 1 vs q t see fig 2 a allows establishing the recession constant k which also represents the α τ parameter of lh rdf method eq 5 this analysis was applied on daily flow data of the avenelles station from january 1 2000 to september 2018 as follows the daily stream flow data of several seasons were overlapped according to the day of the year starting from the beginning of june and assuming that the stream flow decreases under a continuous recession process for the period june september the k value obtained about 0 90 has been calculated for a daily discharge see fig 2a however for high frequency discharge measurements i e time step of 30 min or 0 5 h this value must be transformed at the appropriate time step as proposed by eckhardt 2008 k 0 5 h k j 0 5 24 0 99 with the lh rdf method i e eq 5 and the calibrated value of k i e 0 99 for the avenelles catchment we computed the values of the base flow q b and the quick flow q q see example of the results fig 2b we should not fail to mention here that the baseflow quickflow methods have been widely criticized see e g beven 1991 for a vibrant indictment against them and the arguments raised by pelletier and andréassian 2019 in the discussion of their paper for a careful use of them we do not wish to enter this debate we will not claim to have identified a precise physical pathway and in this paper we will thus limit our ambition to the identification of what pelletier and andréassian 2020 have named the not too delayed and the delayed enough flow components baseflow and quickflow 3 3 calibration of n a a n d b parameters the combined mixing model eq 4 was applied with the baseflow calculated by the lh rdf method for each ion and the ec we used the parameter n previously determined by tunqui neira et al 2020 on the same data set but without flow separation the extremely large number of values in this high frequency dataset may cause problems for a robust identification of a b parameters over the full range of discharges using a simple linear regression indeed the largest discharge values are in small numbers in our dataset only 1 of discharge values are in the range 2 6 m3s 1 12 2 m3s 1 and they correspond to the lowest concentrations to address this question we successively tested a large number of a b pairs from eq 4 n remaining fixed each pair yields a series of simulated concentrations c sim that can be compared with the observed concentrations c obs among the many numerical criteria that could be used we chose the bounded version of the nash and sutcliffe 1970 efficiency criterion nseb mathevet et al 2006 which is commonly used in hydrological modeling nseb can be computed on concentrations or on discharge weighted concentrations which corresponds to the load we chose the average of both because we found that it allows more weight to be given to the lowest concentrations and thus to avoid the issue of under representation of high discharge low concentration measurement points if other criteria exists to test the model performances the nseb comb has the advantage to privilege neither the load nor the concentration and integrates both in a single criterion table 3 presents the formula for these numerical criteria we retained as optimal the pair of a b that yielded the highest nseb comb value we explored in a systematic fashion the range 1 5 for a and 1 2 1 2 for b for each ion and for ec table 4 presents the results obtained for the n a a n d b parameters calibrated for the avenelles sub catchment and their corresponding optimal nseb comb criterion although the parameters of the combined mixing model are shown here we will not discuss them in this paper indeed for now without generalized studies covering several catchments it is not possible to interpret them physically note that for these reasons we have chosen to present table 4 in this section and not in the results and discussion section 3 4 performances of the model we evaluate the combined model performance in calibration and validation mode due to the temporal density of the dataset we have tested the performances of the models in calibration mode on widely different discharge ranges over the entire calibration period and for selected storm events from june 2015 to july 2017 see table 2 chapter 3 1 in validation mode the performances have only been assessed over the entire period from august 2017 to march 2018 see table 2 chapter 3 1 the bias and the standardized root mean square error srmse allow assessing respectively accuracy and precision of the combined mixing model table 5 presents the formula for these numerical criteria 4 results and discussion 4 1 performance of the combined model over the entire period table 6 presents the evaluation of the combined mixing model in calibration and validation mode over the entire period whatever the mode calibration or validation and whatever the solute species considered the optimal srmse and bias values are obtained for the general case case 3 see table 6 the results also show that a single 2s aps relationship case 2 explains better the variations of the stream water concentrations than a mass balance equation with constant concentration components case 1 see srmse and bias values from case 1 to case 2 table 6 this means that within the adopted modelling framework and in as much as the hydrograph separation can be considered as hydrologically relevant the concentrations of the flow components cannot be considered constant across time i e the behavior of the avenelles catchment is non chemostatic the stream water quality of the avenelles sub catchment appears strongly influenced by discharge processes the most evident improvement of the case 3 model is observed for chloride and ec see srmse of 5 with a negative bias less than 0 5 in calibration mode table 6 less importantly sulfate srmse is also much improved when variable concentrations are introduced in the quick and slow components see srmse around 10 case 3 in calibration and validation mode table 6 in calibration mode the sulfate bias is comparable to that obtained for chloride and ec less than 0 5 see table 6 according to floury et al 2018 chloride would come from the brie aquifer with mainly external input from rainfall during the wet season according to mouchel et al 2016 the variability of sulfate concentrations is related to the spatial heterogeneity of gypsum lenses and to the temporary variability of the water table heights the spatial and temporal variability of sulfate and chloride concentrations is due to several chemo dynamical processes well modeled by the general case case 3 the lowest values of the general case are obtained for nitrate see srmse about 27 6 and a bias about 11 2 case 3 in calibration mode and both 100 in validation mode table 6 nitrate present the largest seasonal variability strongly related to farming practices garnier et al 2016 and chemo dynamic processes especially in the hyporheic zone floury et al 2018 this larger variability either environmental or anthropogenic cannot be simulated by our model whatever the case fig 3 illustrates the simulations of the models in the first period of calibration in regard with the observed time series as theoretically expected see fig 1 the simulated concentrations are more or less dispersed from linear case 2 to very dispersed case 1 see fig 3 the case 3 as shown previously by the srmse and the bias see table 6 is the one closest to the observed concentrations for the nitrate while cases 1 and 2 seem to overestimate the concentrations case 3 has the advantage despite its poor performance of covering all the nitrate concentration values a significant feature common to almost all ions except nitrate and sulfate and cases of the model is the lower c q concentration compared to c b see black lines vs pink lines fig 3 for the nitrate ion c q concentration becomes a more important contributor in the three cases until becoming preponderant in the case 3 see nitrate pink line fig 3 for sulfate c q is the main contributor to the stream concentration for discharges greater than 0 5 m3 s 1 see sulfate pink lines fig 3 this result confirm studies carried out at the orgeval oracle observatory billy et al 2013 floury et al 2018 garnier et al 2016 mouchel et al 2016 mouhri et al 2013 indeed according to the results the principal contributor to the stream concentration in the avenelles catchment would be first groundwater i e c b for chloride and ec during the wet season i e for the discharge beyond 0 5 m3 s 1 for the sulfate and whatever the season for nitrate the principal contributor is the quickflow concentrations i e c q however the combined mixing model does not seem to be able to consider the quickflow concentrations in a good way i e integrating either the variations of the sub surface hydrological compartment or the variations of concentrations linked to this compartment 4 2 performances of the combined model for selected storm events we selected two representative flood events of short duration at the end of fall november 2015 low groundwater level low soil moisture and no contribution of tile drains see fig 4 a and during winter february 2016 high groundwater level high soil moisture and tile drains contribution see fig 4b a longer wet season flood event of march 2016 well covered during 15 days by the concentration data set is also added see fig 4c fig 4 presents observed data and the three cases of simulations with the combined mixing model as a function of time for the three events for the three selected storm events table 7 presents the srmse and bias values obtained in a calibration mode with the three cases of the combined model at the event scale except for nitrate during the dry season we obtain the same results than with the entire period the case 3 shows the optimal srmse and bias values for all ions and ec see srmse and bias from case 1 to case 3 table 7 the potential advantage of the general case of the combined mixing model case 3 is to decouple rising and decreasing flow periods with changing q q q and q b q ratios see hydrograph separation fig 4 the recursive filter is efficient in separating the base flow from the quick flow it simulates a quick response of the quick flow at the beginning of flood periods and a progressive increase of the base flow during the second part of flood periods accordingly the two components model improves the simulation of complex concentration changes during flood events we notice that the best results are obtained for the longest flood period the performances of the case 3 are improved for the long event compared to short events see srmse and bias from short event to long event during wet period table 7 as shown in fig 4c because of the longer duration of the flood the recursive filter simulates important variations of the q q q b ratio during the event during most of peak flow period most of the discharge is due to the quick flow component while the quick flow component turns back to zero after day 10 as expected from the wider range of q q q b ratio the model simulates more difference between concentrations during the rising part of the event than the descending part fig 4c we also observe that during short events the simulated concentrations are slightly shifted compared to the observed concentration see example for ec fig 4 this comes from the limit of our hydrograph separation filter in a flood with a longer duration the bias due to the time lag is less significant and a wider distribution of the q q q b ratio as simulated by the rdf method is expected see fig 4 during the wet and dry hydrological seasons almost all ions behavior except for nitrates and ec show a dilution pattern with water of lower concentration followed by a step of increasing concentration see dotted black line c obs fig 4 a common pattern with three stages can be observed in most storm events during the first stage we observed a slight increase in concentration during the initial increase in the discharge then in the second stage which is generally short in time the concentrations strongly decrease while the discharges quickly increase in the third stage both concentrations increase again while discharges continue to decrease and once more reach a lower flow and higher concentration see fig 4 to discuss the performances obtained for each case of our combined model we use the stages outlied above the first stage would correspond to a pre event pattern during which the concentrations come mostly from the groundwater pool evans and davies 1998 rose et al 2018 the following stages correspond to the emergence of soil waters and or runoff mixing in varying proportions during the event evans and davies 1998 rose et al 2018 see fig 4 the contribution of these pools and the dilution that accompanies it persists for some time after the peak flow but in increasingly weaker proportions compared with those of the groundwater note that in the dry season for all ions and ec the soft dilution stage first stage is interrupted by rapid and abrupt dilution fig 4 this last dilution would correspond to a larger proportion of rain water it is indistinguishable during the wet season because rain water is mixed with water from tile drains during this period of the year billy et al 2013 in all storm events dry and wet for all ions except nitrate and ec case 3 best simulates the third stage of the storm event where the mixing of two end members is most evident see fig 4 in the second stage of the wet season storm events fig 4b and c we can observe that for the chloride and sulfate ions and ec the 3 cases have an adequate performance although none manages to simulate the maximum dilution point see fig 4 in the dry season storm event fig 4a the second stage of chloride and sulfate ions and ec is better simulated by case 2 followed nearby case 3 case 1 has the lowest performance of the simulations in this stage finally in the first stage of each of the storm events for the chloride ion sulfate ion and ec we note the same dynamics that occurred with the second stage for case 1 and 2 case 3 performs better c obs during the 2 storm events of the wet season and case 2 performs better in the storm event of the dry season see fig 4a from this analysis we can deduce that in the dry season fig 4a the first and second stages are almost completely dominated by the groundwater pool both in terms of concentration and discharge minimizing the other contributing pools i e soil runoff represented by c q and q q for this reason case 2 assuming total discharge q q groundwater has the better performance in simulating the c obs of chloride and sulfate ions in addition to ec however in the wet season events fig 4b and c and although in the first and second stage the groundwater pool is still the main contributor the contribution of the other pools i e soil runoff represented by c q and q q are much more notorious therefore case 3 has better performances for chloride and sulfate ions and ec in the case of nitrates we must acknowledge that the combined mixing model fails to fit the observed data whatever the event see nitrates fig 4 unlike other ions nitrates are more concentrated in soils and drain water than in groundwater or rainwater according to garnier et al 2014 in the avenelles sub catchment sub root nitrate concentrations average 22 mgn l 1 close to the average concentration observed in drains in the same area 26 mgn l 1 nitrate concentrations in the brie aquifer are only around 13 2 mgn l 1 whereas in rainfall they are about 0 75 mgn l 1 mouchel et al 2016 floury et al 2018 for nitrate ions a third component representing soil water would be needed as well as an appropriate parameterization of the seasonal nature of fertilizer applications several studies burns et al 2019 sebestyen et al 2014 have demonstrated that for nitrate ion more than two different concentration pools i e groundwater soil water etc are involved in rising and declining limbs of hydrograph 5 conclusions 5 1 synthesis the new concentration discharge model presented in this paper associates a classical concentration discharge relationship with a classical two component mixing equation the originality of our approach lies in the fact that we do not proceed in the usual way by assuming a source concentration value to perform the baseflow quickflow separation we use the inverse approach and use an a priori assumption of the baseflow quickflow separation to infer the source concentration values our approach allows a better estimation of streamflow ionic concentration series for most ions at inter annual scale except for nitrate which do not exhibit a clear c q relationship with improved bias and srmse criteria this shows the advantage of coupling a time dynamic hydrological model with static c q relations for each of the flow components 5 2 limits of our approach the first limit of our approach is apparent for the nitrate case nitrate are known to be poorly described by concentration discharge relationships and our model does not allow improving much the issue the two member hydrograph separation tested here may be a limiting factor for nitrate ions the two components hydrograph separation c q and c b seems to be inadequate while for sulfate chloride and ec it seems sufficient the base flow separation method used in this article carries naturally its share of uncertainties due to the arbitrary and speculative hypotheses used in its conception beven 1991 brutsaert 2008 cheng et al 2016 the simple separation into two components cannot explain the complexity of the behavior of the nitrate ions indeed several studies miller et al 2017 probst 1985 have shown that the introduction of a third component which would come to represent the soil pool component is a prerequisite to represent the behavior of nitrate we also need to underline that we acknowledge that our approach remains conceptual and we do not claim to have identified physically the water masses that produce the quick and base flow 5 3 further perspectives as the model does not simulate the decoupling of discharge and concentration patterns due to a short time lag explained by hydraulic mechanisms doing so would be an interesting extension of this work an isotope study would be helpful to this aim another priority would be to test the implementation of our model elsewhere especially on high frequency water quality stations kirchner et al 2004 different types of chemical signatures reflecting different types of hydrological and hydro chemical functions underlying the transfer processes could be studied in detail including different flow decomposition concepts and may be other c q relations possibly including specific seasonal features another alternative would be to test this new methodology with other hydrograph separation methods than the rdf lyne hollick to prove their validity e g the methods developed by eckhardt 2005 pelletier and andréassian 2020 if high frequency measurements become more and more available for science kirchner et al 2004 their implementation at large scale still difficult and low frequencies measurements i e daily weekly remain the rule moatar et al 2017 thus it remains important to continue methodological development through modelling which allow us with a limited number of measurements and a good representativeness to assess the quality of rivers in large scale in the framework of low frequency monitoring ultimately further developments of the combined mixing model should go in this direction credit authorship contribution statement josé manuel tunqui neira conceptualization methodology software writing original draft gaëlle tallec data curation writing review editing vazken andréassian conceptualization methodology writing review editing supervision jean marie mouchel writing review editing supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the first author acknowledges the peruvian scholarship cienciactiva of concytec grant no 099 2016 fondecyt de for supporting his phd study at inrae and the sorbonne university the authors acknowledge the equipex critex program grant no anr 11 eqpx 0011 for the data availability 
5099,multispecies pollutant migration is most natural phenomenon frequently occurring in the polluted groundwater system and also evidently occurs in the nuclear repositories and sites having radioactive substances and chemical solvent modeling pollutant migration of reactive multispecies problem with variable transport parameters is quite a challenging issue necessary for better sightedness of fate and transport of reactive solutes and their geochemical growth in the geological formations at present most of the solutions for multispecies problem are corresponding to the constant parameters affecting the concentration distribution not for variable transport parameters because of the complexity of the modelled equation this paper dealt with the comparative study of multispecies pollutant transport problem in porous structure to analyse the effect of spatially and temporally varying hydrodynamic dispersion coefficient and transport velocity terms in more general form for mathematical elaboration two species transport problem is considered subjected to the concept of linear isotherm with both the parent and daughter species without using identical retardation factor and model is also incorporated with the first order decay term under spatially varying initial conditions homotopy analysis method ham is adopted to develop the series solution for the concentration segmentation of each species of the model the advantage of this method is that it is capable to overcome the limitation of existing transform methods for some cases of complex modelled problems the zeroth order deformation equation is derived by using ham to generate the semi analytical solution of the model under certain auxiliary linear operator the impact of distinct retardation factor for different species and effect of diversity in dependency of modelled parameters over space and time are graphically depicted for both the species and illustrated that it has a valuable impact over multispecies pollutant migration as there exist no analytical or numerical solution for such complex variable dependency of migration parameters over transport phenomenon these solutions may be helpful to deliver a better significant about the concentration variation due to space and time dependent transport parameters responsible for reactive multispecies migration in more natural way keywords multispecies pollutant transport linear isotherm homotopy analysis method series solution 1 introduction the solid waste management is one of the major issues in india due to the rapid evolution in the industrial areas and urbanization process the continuous population growth and increasing per person municipal solid waste generation make it much more difficult to accomplish sustainable advancement in solid waste management sanitary landfilling is always an effective and economical scheme for the disposal of the solid wastes but due to deterioration of the landfill liners in the older landfills it causes the transmission of leachate and its venomous components into underlying geological formations or its neighbouring rivers which is responsible for the spoilage of drinking water abbas et al 2009 kumar et al 2017 for its remediation process it is quite necessary to understand the behaviour of solute dispersion and its reactive processes in the aquifer systems the mathematical modelling can play an important role in the understanding of leachate migration and to simulate the pollutant migration in the aquifer the pollutant transport models based on classical convection dispersion equation are impressive tools for better perception and anticipation of biological and physical behaviour of reactive migration in geological formations with reactive pollutants like as chloride and sulphate solvents radioactive substances and various hydrocarbons batu 2006 over last few decades a large number of explorations have been made to investigate the pollutant migration phenomenon in the groundwater system based on theoretical and experimental studies bear 1972 sposito et al 1979 domenico 1987 clement 1999 2001 de simoni et al 2005 a short report about the available analytical and numerical solutions for pollutant transport problem under the assumption of different type of inlet and boundary conditions is provided below a comprehensive and comparative analysis of one dimensional pollutant transport models for single species migration have been formulated in the study van genuchten 1982 this study presented an adequate number of transport models incorporated with various parameters affecting the transport phenomenon and also with the consideration of different type of inlet and boundary conditions later van genuchten 1985 numerically formulated the analytical solution for transport model with sequential first order decay reactions to describe the simultaneous migration of four species involved in the chain reaction process using the laplace transform method afterwards yeh and tripathi 1991 simulated the migration of reactive pollutants by using coupled hydrogeochemical model the model was structured in such a way that it can simulate various type of reactive migration problem and applicable for saturated unsaturated heterogenous medium under steady or transient flow conditions both later lunn et al 1996 determined an analytical solution for multispecies contaminant movement based on the reactive model for three species incorporated with first order decay rates for all species and concept of linear isotherm with first species this investigation used the fourier transform method to obtain the solution for the model and suggested that this technique is more capable and easier to handle the model with much complicated inlet and boundary conditions as compare to technique involving laplace transform method used in the previously similar works cho 1971 van genuchten 1985 fujikawa and fukui 1990 chrysikopoulos et al 1990 to analyse the transport system for multispecies problem along with parallel or sequential first order reaction mechanism the study sun and clement 1999 developed general transformation method in which coupled multispecies system is decomposed into multiple self sufficient models for single species which make it easier to handle in term of analytical solution of the system later on sun et al 1999a sun et al 1999b used similar method to extend the solution of multispecies reactive system in case of multiple dimensional problem these solutions have been limited to justify the migration of multispecies system only for unidirectional flow in single porous structure corresponding to equal value of retardation coefficient for each species to overcome such limitation bauer et al 2001 derived solutions for unidirectional and radial steady state flow in case of identical and distinct retardation coefficient values both under the consideration of various form of boundary conditions in addition quezada et al 2004 and chamkha 2005 also used distinct values for retardation factor term for each species the laplace transform method was employed to get the solution romeiro et al 2007 employed linearization technique to present a comparative study of pollutant migration in multispecies reactive process for both cases system with distinct and similar retardation coefficient values furthermore slodicka and balazova 2008 slodicka and balazova 2010 developed new decomposition method to analyse multispecies problem which are modifies version of decomposition method used in the studies sun and clement 1999 sun et al 1999a 1999b to overcome their limitations over various transformations this technique slodicka and balazova 2010 is designed in such a way so that it is independent of any temporary transformations and also capable to extend the system for distinct retardation factors later natarajan and kumar 2010 presented an alternative approach of decomposition techniques used for analysing multispecies reactive systems based on finite difference method to overcome the limitations regarding the decoupling process of coupled equations of multispecies system previously numerical method based on computer code for simulating reactive multispecies transport in 3 dimentional groundwater system rt3d was employed by clement et al 1998 and clement 1999 to analyse the multispecies migration process in case of constant transport parameters chen et al 2012a applied the method based on laplace transform and generalized integral transform technique with respect to time and space respectively to derive the solution for multispecies problem in case of finite spatial domain which was one of the limitations of previously available decomposition methods this investigation considered constant boundary conditions to analyse the solution afterwards chen et al 2012b presented the solution for temporally varying source boundary condition with similar modelled problem chen et al 2012a a case study huo et al 2014 was presented to explore the multispecies reactive transport phenomenon by using decoupling approach for heterogeneous medium where the entire domain was further divided into various subdomains on the basis of different reactions taking place in the domain later simpson and ellery 2014 presented the exact series solutions for reactive migration systems for both single species and multispecies models this series solution method was capable to derive the solution corresponding to the general spatially dependent inlet conditions and has great freedom on their selection which overcome the limitations of previously available analytical solutions cho 1971 lunn et al 1996 arnold et al 2017 numerically investigated the result for fickian and nernst plank model for multispecies transport phenomenon in the privation of chemical reactions and also for the reactive hydrated portland cement and analyse that measurable difference can be depicted in the presence of nitrate solution furthermore spatial moment analysis was performed for the multispecies transport problem natarajan and kumar 2018 by using implicit finite difference approach later chen et al 2018 developed the analytical solution for more complicated sorption system in the multispecies reactive migration model to explore the impact of kinetic sorption over multispecies migration the above presented literature regarding the problems for multispecies reactive transport phenomenon has a common property that all are corresponding to constant transport parameters i e for constant dispersion and velocity term but to understand the pollutant dispersion behaviour in more natural and conventional way it is quite necessary to model the reactive system with variable dependent transport parameters it is quite difficult to formulate the analytical solutions corresponding to coupled multispecies pollutant transport problem in case of considered model along with variable dependent parameters because as compare to constant parameters their variable dependency makes the modelled system much more complex which is difficult to handle for deriving their analytical solutions that is the region for the existence of such studies to be very few to the best of our knowledge some multispecies models are developed for variable dependency of parameters chamkha 2005 chen et al 2012b natarajan 2016 suk 2016 but the investigation is performed either only for spatially varying parameters chamkha 2005 natarajan 2016 suk 2016 or only for temporally varying parameters natarajan 2016 suk 2016 not for spatially temporally varying parameters the study chamkha 2005 natarajan 2016 employed the numerical method based on implicit tri diagonal finite difference approach while suk 2016 presented the study by using generalized integral transform technique and validated the result by using the code based on two dimensional subsurface flow fate and transport of microbes and chemicals 2dfacmic also these studies are performed only for some particular type of functions like as linearly varying parameters not for general case while for the single species problem an adequate number of researches has been reported to justify the spatial and temporal effect of migration parameters over pollutant transport gao et al 2010 singh and das 2015 gharehbaghi 2016 singh and chatterjee 2016 sanskrityayn et al 2017 chaudhary et al 2020 the above review suggested that it is quite necessary to formulate an advanced model for multispecies reactive system equipped with more complicated variable dependent functions for transport parameters in this study to formulate the solution for the considered model of multispecies problem ham is taken into account which was first developed and proposed by liao 1992 this approximate series solution method is based on the idea of homotopy an elemental concept of differential geometry and topology which characterize a kind of continuous deformation as compare to other convenient asymptotic methods and perturbation techniques used for the formulation of the analytical solution of the non linear systems ham is designed in such a way that it is free from dependency of the method procedure over many large physical parameters responsible for the convergency of the solution liao 2012 the ham also provides more appropriate and much convenient procedure to ensure the convergency of the derived semi analytical solution by introducing the convergence control parameter which confer the researcher with a simple process to adjust and control the region of convergence of the series solution liao 1995 the ham has been successfully adopted for the formulation of the solutions of different type of nonlinear systems he 2005 babolian et al 2009 mahmood et al 2014 singh and chatterjee 2017 filobello nino et al 2017 beside this ham also gives great freedom to formulate the deformation equation for the problem and also to select the appropriate initial guess to handle the solution of the considered non linear system which helps the user to control the complexity of the mathematical procedure in much simpler way the main objective of this study is to present a comparative description of the multispecies pollutant migration system by analysing the effect of variable dependent migration parameters which are responsible for the pollutant migration in the groundwater system for this the effective dispersion coefficient and seepage velocity terms are considered to be constant dependent over space and also dependent over space and time both i e the system is analysed for both the cases steady and unsteady groundwater flow and also for the transient transport system for mathematical formulation of the problem two species reactive migration system is considered along with the first order decay terms in semi infinite medium the retardation factors are considered to be non identical for both the species the considered model is solved by using ham under some appropriate inlet and boundary conditions for both the species for the parent species some exponentially decreasing initial pollutant is considered and for the daughter species it is assumed to be zero solutions are formulated corresponding to the general time dependent function and for the graphical description of the temporal effect over multispecies problem the pictorial representation of concentration patterns for both species are made for different type of temporally varying functions like as exponentially increasing exponentially decreasing linear and asymptotically dependent functions derived ham solution of the model is validated with previously existing analytical solutions for both the species under the assumption of constant dispersion and velocity term and a good agreement is found between both the solutions also for the authentication of ham derived solutions for all three cases are further validated by using another existing method for non linear systems called variational iteration method and the error between both the solution is observed to be almost negligible this research work is organized as follows the next section 2 explains the governing equation for multispecies reactive migration system and presents a mathematical formulation for two species problem under certain inlet and boundary conditions section 3 addresses the formation of ham solution of the considered system in general form this section also comprises three subsections to present the ham solutions for parent and daughter species for all three considered cases a steady migration system in steady flow domain b transient migration system in steady flow domain and c transient migration system in unsteady flow domain respectively thereafter section 4 constitutes the graphical results and discussion based on concentration variation due to various type of dependency over transport parameters this section is followed by validation part of the derived solutions with previously available literature and solutions obtained by other methods presented in section 5 and the application part of the study is presented in the section 6 where one example based on nitrification chain migration system is reported finally the summary and conclusions drawn from the results are then briefly abbreviated in the conclusion section which is followed by reference section 2 mathematical formulation general form for a reactive transport system that describe multispecies migration phenomenon with spatially and temporally varying parameters responsible for the pollutant migration in the groundwater system along with sorption and first order decay rate and concept of distinct retardation factor value for each species in a one dimensional flow field is modelled as follows 1 r i c i t x d x t c i x v x t c i k i 1 c i 1 k i c i i 1 2 n where k 0 0 and n represents the number of species in the system c i m l 3 is the concentration strength for ith species d x t l 2 t 1 is the dispersion coefficient v x t l t 1 is the seepage velocity r i and k i t 1 are the retardation factor and decay rate coefficients for ith species respectively 2 1 problem for two species reactive system in this study two species one dimensional problem is considered to demonstrate the effect of spatially and temporally dependent transport parameters over pollutant migration behaviour also the problem is modelled for different retardation factor term for both the species 2a r 1 c 1 t x d x t c 1 x v x t c 1 k 1 c 1 2b r 2 c 2 t x d x t c 2 x v x t c 2 k 2 c 2 k 1 c 1 where c 1 m l 3 represents the pollutant concentration level for parent species and c 2 m l 3 is that for daughter species d x t and v x t are the dispersion coefficient and seepage velocity term which are assumed to be dependent on space and time both to visualize their effect on pollutant movement in more natural way also r 1 and r 2 are the retardation factor for parent and daughter species respectively k 1 t 1 and k 2 t 1 are the decay rate coefficients for both the species corresponding initial and boundary conditions for the considered two species model are assumed to be 3a c 1 x 0 f x c 1 0 t f 0 lim x c 1 x t 0 3b c 2 x 0 g x c 2 0 t g 0 lim x c 2 x t 0 where the functions f x and g x are considered as simpson and ellery 2014 4 f x a x exp b x g x 0 i e problem is formulated for the assumption that there exists some spatially dependent pre existing pollutant for parent species c 1 x t but for daughter species c 2 x t initial concentration is considered to be zero 3 solution by ham in this paper we used homotopy analysis method to obtain the desired solution of the two species system quezada et al 2004 natarajan and kumar 2010 simpson and ellery 2014 for this we first require some appropriate initial guesses for the solutions corresponding to both the species based on the considered initial conditions of both the species the initial approximation for parent and daughter species are considered as follows 5a c 1 0 x t a x exp b x 5b c 2 0 x t 0 and to get the solution of the considered model by ham the linear operators are introduced as 6 i 1 ϕ 1 x t q r 1 ϕ 1 x t q t and i 2 ϕ 2 x t q r 2 ϕ 2 x t q t which satisfy the property that i i p i 0 i 1 2 where p i being the integration constant where ϕ 1 x t q and ϕ 2 x t q are considered as the solution for both species and q 0 1 is the homotopy parameter also known as embedding parameter responsible for the deformation of the solution from the assumed initial guesses of the solution to the final solution of the system the system of non linear operators can be defined as 7a n 1 ϕ 1 x t q r 1 c 1 t x d x t c 1 x v x t c 1 k 1 c 1 7b n 2 ϕ 2 x t q r 2 c 2 t x d x t c 2 x v x t c 2 k 2 c 2 k 1 c 1 as suggested by liao 2012 the zeroth order deformation equations for both the species can be formulated as follows 8a 1 q n 1 ϕ 1 x t q c 1 0 x t h 1 q n 1 ϕ 1 x t q 8b 1 q n 2 ϕ 2 x t q c 2 0 x t h 2 q n 2 ϕ 2 x t q where h 1 and h 2 are the convergence control parameters from above deformation equations it is clearly verified that q 0 is corresponding to the initial guesses c 1 0 x t and c 2 0 x t while q 1 is corresponding to the final solutions c 1 x t and c 2 x t of the problem also the mth order deformation equations for both the species are defined as liao 2012 9a c 1 m x t χ m c 1 m 1 x t h 1 i 1 1 m 1 n 1 ϕ 1 x t q q m 1 q 0 9b c 2 m x t χ m c 2 m 1 x t h 2 i 1 1 m 1 n 2 ϕ 2 x t q q m 1 q 0 where χ m 0 m 1 1 m 1 thus by using above mth order deformation equations the mth term of the approximate solution for c 1 x t and c 2 x t can be obtained as follows 10a c 1 m x t χ m c 1 m 1 x t h 1 i 1 r 1 c 1 m 1 t x d x t c 1 m 1 x v x t c 1 m 1 k 1 c 1 m 1 10b c 2 m x t χ m c 2 m 1 x t h 2 i 1 r 2 c 2 m 1 t x d x t c 2 m 1 x v x t c 2 m 1 k 2 c 2 m 1 k 1 c 1 m 1 as the solution of the problem converges for q 1 thus approximate series solution for both the species based on homotopy maclaurin series can be obtained as follows liao 2012 11a c 1 x t c 1 0 x t m 1 c 1 m x t 11b c 2 x t c 2 0 x t m 1 c 2 m x t in general most of the solution for multispecies migration system are derived for constant dispersion and velocity term but here we are considering three different scenarios for spatial and temporal dependency of these parameters for extensive study of their impact over pollutant migration 3 1 case i steady migration system in steady flow domain let 12 d x t d 0 β α x 2 v x t v 0 β α x i e dispersion coefficient and transport velocity term both are considered to be spatially dependent to represent the steady migration phenomenon in the case of steady groundwater flow also the concept of general dispersion theory i e dispersion is directly proportional to the square of the velocity is considered batu 2006 d 0 l 2 t 1 and v 0 l t 1 are the initial dispersion and velocity terms respectively and α l 1 is the heterogeneity parameter as β 1 and α 0 i e for very small value of heterogeneity parameter α the system is for homogeneous medium means there is no effect of position over dispersion and transport velocity and higher value of α is responsible for the medium to be heterogeneous now from eq 10a the mth term of the approximate solution for parent species is defined as 13a c 1 m x t χ m c 1 m 1 x t h 1 i 1 r 1 c 1 m 1 t d 0 β α x 2 2 c 1 m 1 x 2 v 0 2 α d 0 β α x c 1 m 1 x k 1 α v 0 c 1 m 1 similarly mth term of the approximate solution for daughter species by using eq 10b is defined as 13b c 2 m x t χ m c 2 m 1 x t h 2 i 1 r 2 c 2 m 1 t d 0 β α x 2 2 c 2 m 1 x 2 v 0 2 α d 0 β α x c 2 m 1 x k 2 α v 0 c 2 m 1 k 1 c 1 m 1 3 1 1 solution for parent species by using the formula for mth term of the approximate solution given by eq 13a the successive terms of the approximation liao 2012 for the solution for parent species c 1 are derived as follows 14a c 1 0 x t a x exp b x 14b c 1 1 x t h 1 t r 1 d 0 β α x 2 a b 2 b x exp b x v 0 2 α d 0 β α x a 1 b x exp b x k 1 α v 0 ax exp b x 14c c 1 2 x t c 1 1 x t h 1 2 t r 1 d 0 β α x 2 a b 2 b x exp b x v 0 2 α d 0 β α x a 1 b x exp b x k 1 α v 0 ax exp b x h 1 2 t 2 2 r 1 2 d 0 2 β α x 4 a b 3 4 b x exp b x 2 d 0 v 0 4 α d 0 β α x 3 a b 2 3 b x exp b x v 0 2 α d 0 v 0 4 α d 0 2 d 0 2 α v 0 3 α 2 d 0 k 1 β α x 2 a b 2 b x exp b x v 0 2 α d 0 3 α v 0 2 α 2 d 0 2 k 1 β α x a 1 b x exp b x k 1 α v 0 2 ax exp b x 14d c 1 3 x t c 1 2 x t h 1 2 1 h 1 t r 1 d 0 β α x 2 a b 2 b x exp b x v 0 2 α d 0 β α x a 1 b x exp b x k 1 α d 0 ax exp b x h 1 2 1 2 h 1 t 2 2 r 1 2 d 0 2 β α x 4 a b 3 4 b x exp b x 2 d 0 v 0 8 α d 0 β α x 3 a b 2 3 b x exp b x v 0 2 α d 0 v 0 4 α d 0 2 d 0 2 α v 0 3 α 2 d 0 k 1 β α x 2 a b 2 b x exp b x v 0 2 α d 0 3 α v 0 2 α 2 d 0 2 k 1 β α x a 1 b x exp b x k 1 α d 0 2 ax exp b x h 1 3 t 3 6 r 1 3 d 0 3 β α x 6 a b 5 6 b x exp b x 3 d 0 2 v 0 6 α d 0 β α x 5 a b 4 5 b x exp b x d 0 v 0 4 α d 0 v 0 8 α d 0 2 d 0 v 0 2 α d 0 v 0 6 α d 0 d 0 2 11 α v 0 42 α 2 d 0 3 k 1 β α x 4 a b 3 4 b x exp b x v 0 4 α d 0 2 d 0 3 α v 0 10 α 2 d 0 k 1 v 0 2 α d 0 v 0 8 α d 0 d 0 v 0 2 α d 0 3 α v 0 2 α 2 d 0 2 k 1 2 d 0 v 0 6 α d 0 2 α v 0 3 α 2 d 0 k 1 β α x 3 a b 2 3 b x exp b x v 0 2 α d 0 v 0 4 α d 0 6 α v 0 8 α 2 d 0 3 k 1 2 d 0 3 α v 0 6 α 2 d 0 k 1 2 α v 0 3 α 2 d 0 k 1 d 0 k 1 α v 0 2 β α x 2 a b 2 b x exp b x v 0 2 α d 0 2 α v 0 2 α 2 d 0 k 1 3 α v 0 2 α 2 d 0 2 k 1 k 1 α v 0 2 v 0 2 α d 0 β α x 3 a 1 b x exp b x k 1 α v 0 3 ax exp b x 3 1 2 solution for daughter species by using the formula for mth term of the approximate solution given by eq 13b the successive terms for the solution for daughter species c 2 are derived as follows 15a c 2 0 x t 0 15b c 2 1 x t h 2 t r 2 k 1 ax exp b x 15c c 2 2 x t c 2 1 x t h 2 2 t r 2 k 1 ax exp b x h 2 2 t 2 2 r 2 2 k 1 d 0 β α x 2 a b 2 b x exp b x v 0 2 α d 0 β α x a 1 b x exp b x k 2 α d 0 ax exp b x h 1 h 2 t 2 2 r 1 r 2 k 1 d 0 β α x 2 a b 2 b x exp b x v 0 2 α d 0 β α x a 1 b x exp b x k 1 α v 0 ax exp b x 15d c 2 3 x t c 2 2 x t h 2 2 1 h 2 r 2 1 k 2 α v 0 2 r 2 t k 1 t h 2 2 2 r 2 h 1 k 1 α v 0 r 1 h 2 k 2 α v 0 r 2 1 k 2 α v 0 3 r 2 t k 1 t 2 h 1 h 2 1 h 1 2 r 1 r 2 k 1 k 1 α v 0 t 2 ax exp b x h 2 2 2 r 2 h 1 r 1 1 2 h 2 r 2 k 1 t 2 h 1 h 2 1 h 1 2 r 1 r 2 k 1 t 2 h 2 2 6 r 2 2 h 1 k 1 α v 0 r 1 h 2 k 2 α v 0 r 2 k 1 t 3 d 0 β α x 2 a b 2 b x exp b x v 0 2 α d 0 β α x a 1 b x exp b x h 2 2 6 r 2 2 h 1 r 1 h 2 r 2 k 1 t 3 d 0 2 β α x 4 a b 3 4 b x exp b x 2 d 0 v 0 4 α d 0 β α x 3 a b 2 3 b x exp b x d 0 2 α v 0 2 α 2 d 0 k 2 v 0 3 α d 0 v 0 4 α d 0 β α x 2 a b 2 b x exp b x v 0 2 α d 0 2 α v 0 2 α 2 d 0 k 2 β α x a 1 b x exp b x h 1 2 h 2 6 r 1 2 r 2 k 1 t 3 d 0 2 β α x 4 a b 3 4 b x exp b x 2 d 0 v 0 4 α d 0 β α x 3 a b 2 3 b x exp b x v 0 2 α d 0 v 0 4 α d 0 2 d 0 2 α v 0 3 α 2 d 0 k 1 β α x 2 a b 2 b x exp b x v 0 2 α d 0 3 α v 0 2 α 2 d 0 2 k 1 β α x a 1 b x exp b x k 1 α v 0 2 ax exp b x 3 2 case ii transient migration system in steady flow domain let 16 d x t d 0 β α x 2 ζ mt v x t v 0 β α x i e dispersion coefficient is considered to be spatially temporally dependent while velocity is considered to be spatially dependent only for temporal variation for dispersion term a general temporal function ζ mt is considered with dispersion which can further consider to be exponential linear asymptotic type function based on the medium type now from eq 10a the mth term of the approximate solution for parent species is defined as 17a c 1 m x t χ m c 1 m 1 x t h 1 i 1 r 1 c 1 m 1 t d 0 β α x 2 ζ mt 2 c 1 m 1 x 2 v 0 2 α d 0 ζ mt β α x c 1 m 1 x k 1 α v 0 c 1 m 1 similarly mth term of the approximate solution for daughter species by using eq 10b is defined as 17b c 2 m x t χ m c 2 m 1 x t h 2 i 1 r 2 c 2 m 1 t d 0 β α x 2 ζ mt 2 c 2 m 1 x 2 v 0 2 α d 0 ζ mt β α x c 2 m 1 x k 2 α v 0 c 2 m 1 k 1 c 1 m 1 3 2 1 solution for parent species by using the formula for mth term of the approximate solution given by eq 17a the successive terms for the solution for parent species c 1 are derived as follows 18a c 1 0 x t a x exp b x 18b c 1 1 x t h 1 r 1 d 0 β α x 2 a b 2 b x exp b x 0 t ζ m υ d υ v 0 t 2 α d 0 0 t ζ m υ d υ β α x a 1 b x exp b x k 1 α v 0 t ax exp b x 18c c 1 2 x t c 1 1 x t h 1 2 r 1 d 0 β α x 2 a b 2 b x exp b x 0 t ζ m υ d υ v 0 t 2 α d 0 0 t ζ m υ d υ β α x a 1 b x exp b x k 1 α v 0 t ax exp b x h 1 2 r 1 2 d 0 2 β α x 4 a b 3 4 b x exp b x 0 t ζ m υ 0 t ζ m υ d υ d υ h 1 2 r 1 2 v 0 d 0 0 t υ ζ m υ 0 t ζ m υ d υ d υ 8 α d 0 2 0 t ζ m υ 0 t ζ m υ d υ d υ β α x 3 a b 2 3 b x exp b x h 1 2 r 1 2 v 0 2 t 2 2 d 0 5 α v 0 k 1 0 t υ ζ m υ 0 t ζ m υ d υ d υ 14 α 2 d 0 2 0 t ζ m υ 0 t ζ m υ d υ d υ β α x 2 a b 2 b x exp b x h 1 2 r 1 2 v 0 3 α v 0 2 k 1 t 2 2 2 α d 0 2 α v 0 k 1 0 t υ ζ m υ 0 t ζ m υ d υ d υ 4 α 3 d 0 2 0 t ζ m υ 0 t ζ m υ d υ d υ β α x a 1 b x exp b x h 1 2 r 1 2 α v 0 k 1 2 t 2 2 ax exp b x 3 2 2 solution for daughter species by using the formula for mth term of the approximate solution given by eq 17b the successive terms for the solution for daughter species c 2 are derived as follows 19a c 2 0 x t 0 19b c 2 1 x t h 2 t r 2 k 1 ax exp b x 19c c 2 2 x t c 2 1 x t h 2 2 r 2 k 1 t ax exp b x h 2 2 r 2 2 k 1 d 0 β α x 2 a b 2 b x exp b x 0 t υ ζ m υ d υ v 0 t 2 2 2 α d 0 0 t υ ζ m υ d υ β α x a 1 b x exp b x k 2 α v 0 t 2 2 ax exp b x h 1 h 2 r 1 r 2 k 1 d 0 β α x 2 a b 2 b x exp b x 0 t 0 t ζ m υ d υ d υ v 0 t 2 2 2 α d 0 0 t 0 t ζ m υ d υ d υ β α x a 1 b x exp b x k 1 α v 0 t 2 2 ax exp b x 3 3 case iii transient migration system in unsteady flow domain let 20 d x t d 0 β α x 2 ψ 2 mt v x t v 0 β α x ψ mt i e dispersion and velocity both are considered to be spatially temporally dependent to justify the transient transport situation for the unsteady flow for spatial variation a linear function is considered while to represent temporal variation a general temporal function ψ mt is assumed where m t 1 is the flow resistance quantity as m 0 i e for very small value of temporal parameter m there will be no effect of time over dispersion and velocity so the state will be steady and for other value of m i e for m 0 it will represent the transient state the concept of general dispersion theory i e dispersion is directly proportional to the square of the velocity is considered for the assumption of dispersion and seepage velocity term batu 2006 now from eq 10a the mth term of the approximate solution for parent species is defined as 21a c 1 m x t χ m c 1 m 1 x t h 1 i 1 r 1 c 1 m 1 t d 0 β α x 2 ψ 2 mt 2 c 1 m 1 x 2 v 0 ψ mt 2 α d 0 ψ 2 mt β α x c 1 m 1 x k 1 α v 0 ψ mt c 1 m 1 similarly mth term of the approximate solution for daughter species by using eq 10b is defined as 21b c 2 m x t χ m c 2 m 1 x t h 2 i 1 r 2 c 2 m 1 t d 0 β α x 2 ψ 2 mt 2 c 2 m 1 x 2 v 0 ψ mt 2 α d 0 ψ 2 mt β α x c 2 m 1 x k 2 α v 0 ψ mt c 2 m 1 k 1 c 1 m 1 3 3 1 solution for parent species by using the formula for mth term of the approximate solution given by eq 21a the successive terms for the solution for parent species c 1 are derived as follows 22a c 1 0 x t a x exp b x 22b c 1 1 x t h 1 r 1 d 0 β α x 2 a b 2 b x exp b x 0 t ψ 2 m υ d υ v 0 0 t ψ m υ d υ 2 α d 0 0 t ψ 2 m υ d υ β α x a 1 b x exp b x k 1 t α v 0 0 t ψ m υ d υ ax exp b x 22c c 1 2 x t c 1 1 x t h 1 2 r 1 d 0 β α x 2 a b 2 b x exp b x 0 t ψ 2 m υ d υ v 0 0 t ψ m υ d υ 2 α d 0 0 t ψ 2 m υ d υ β α x a 1 b x exp b x k 1 t α v 0 0 t ψ m υ d υ ax exp b x h 1 2 r 1 2 d 0 2 β α x 4 a b 3 4 b x exp b x 0 t ψ 2 m υ 0 t ψ 2 m υ d υ d υ h 1 2 r 1 2 v 0 d 0 0 t ψ 2 m υ 0 t ψ m υ d υ ψ m υ 0 t ψ 2 m υ d υ d υ 8 α d 0 2 0 t ψ 2 m υ 0 t ψ 2 m υ d υ d υ β α x 3 a b 2 3 b x exp b x h 1 2 r 1 2 v 0 2 0 t ψ m υ 0 t ψ m υ d υ d υ 5 α v 0 d 0 0 t ψ m υ 0 t ψ 2 m υ d υ ψ 2 m υ 0 t ψ m υ d υ d υ k 1 d 0 0 t υ ψ 2 m υ 0 t ψ 2 m υ d υ d υ 14 α 2 d 0 2 0 t ψ 2 m υ 0 t ψ 2 m υ d υ d υ β α x 2 a b 2 b x exp b x h 1 2 r 1 2 k 1 v 0 0 t υ ψ m υ 0 t ψ m υ d υ d υ 2 α k 1 d 0 0 t υ ψ 2 m υ 0 t ψ 2 m υ d υ d υ 4 α 2 v 0 d 0 0 t ψ m υ 0 t ψ 2 m υ d υ ψ 2 m υ 0 t ψ m υ d υ d υ 3 α v 0 2 0 t ψ m υ 0 t ψ m υ d υ d υ 4 α 3 d 0 2 0 t ψ 2 m υ 0 t ψ 2 m υ d υ d υ β α x a 1 b x exp b x h 1 2 r 1 2 α 2 v 0 2 0 t ψ m υ 0 t ψ m υ d υ d υ α k 1 v 0 0 t υ ψ m υ 0 t ψ m υ d υ d υ k 1 2 t 2 2 ax exp b x 3 3 2 solution for daughter species by using the formula for mth term of the approximate solution given by eq 21b the successive terms for the solution for daughter species c 2 are derived as follows 23a c 2 0 x t 0 23b c 2 1 x t h 2 t r 2 k 1 ax exp b x 23c c 2 2 x t c 2 1 x t h 2 2 r 2 k 1 t ax exp b x h 2 2 r 2 2 k 1 d 0 β α x 2 a b 2 b x exp b x 0 t υ ψ 2 m υ d υ v 0 0 t υ ψ m υ d υ 2 α d 0 0 t υ ψ 2 m υ d υ β α x a 1 b x exp b x k 2 t 2 2 α v 0 0 t υ ψ m υ d υ ax exp b x h 1 h 2 r 1 r 2 k 1 d 0 β α x 2 a b 2 b x exp b x 0 t 0 t ψ 2 m υ d υ d υ v 0 0 t 0 t ψ m υ d υ d υ 2 α d 0 0 t 0 t ψ 2 m υ d υ d υ β α x a 1 b x exp b x k 1 t 2 2 α v 0 0 t 0 t ψ m υ d υ d υ ax exp b x 4 graphical results and discussion in this section the concentration distribution is graphically analysed for the derived series solutions by using homotopy analysis method ham for both the species in all three cases steady transport situation for steady groundwater flow transient transport situation for steady groundwater flow and transient transport situation for unsteady groundwater flow for the graphical illustration finite spatial and temporal domain i e 0 x cm 3000 and 0 t hr 40 are considered and also the following set of model parameters is adopted from the previously available literature simpson and ellery 2014 u 0 0 2 cm h r d 0 0 5 c m 2 h r k 1 0 05 h r k 2 0 01 h r a 2 b 0 0025 and the retardation factor values corresponding to both the species and the constants values responsible for spatial and temporal variation in transport parameters are assumed to be r 1 2 r 2 2 5 α 0 05 0 15 c m β 1 m 0 04 h r also for the prediction of variation over concentration strength distribution due to temporally varying dispersion and transport velocity term in two species migration system four different types of velocity profiles are taken into account i e the temporal functions ζ mt for case ii and ψ mt for case iii are considered to be a exponentially increasing exp mt b exponentially decreasing exp m t c linearly dependent mt λ and d asymptotically dependent 1 m t 1 m t as the solutions for the modelled two species problem for all three cases are derived by using ham where the convergency of the solutions are totally dependent on the prediction of suitable value of h 1 and h 2 the convergence control parameters which can be further adjusted and controlled by the h curves for both species liao 1992 1995 fig 1 presents the h curves for both the species which are drawn between h value and c tt x t at x t 0 1 for both concentration strengths c 1 x t and c 2 x t both the h 1 curve and h 2 curve have an horizontal line segment between 1 6 and 0 6 signifying the bounded range for values of h 1 and h 2 which confirms the convergency of the solutions for both species derived in case i in this case values are considered to be 0 1 and 0 2 for the convergence control parameters h 1 and h 2 respectively fig 2 provides the concentration strength distribution for both the species in case of different time domain t 0 20 40 hrs for steady transport in steady groundwater flow it is observed that the concentration strength for parent species c 1 decreases with increasing time up to certain distance and after a distance of x 2250 cm approx it changes its nature and become higher for larger temporal value while in case of daughter species c 2 the concentration pattern is quite different in nature it is higher for large temporal value at each point of the domain but for both the species the concentration strength increases with distance and attains its maximum concentration value and after reaching peak concentration strength it decreases with distance and reduces asymptotically to its minimum harmless concentration strength it is also observed that the concentration strength is zero at t 0 for c 2 x t because there is no production of daughter species from parent species at starting time the impact of spatial variation of model parameters over pollutant migration of both species in steady transport is depicted in fig 3 the concentration strength is analysed for fixed time domain t 40 hr and study is carried out for three different values of spatial parameter α 0 0 1 0 2 for the better visualization of significant impact of positionally dependent parameters over two species transport for α 0 the system represents the homogeneous medium as there will be no impact of position over model parameters similar type of dispersion and velocity profile are assumed in the previously available studies lunn et al 1996 quezada et al 2004 chen et al 2012a simpson and ellery 2014 and for α 0 1 and α 0 2 i e when the model parameters dependent over position system represents heterogeneous medium from fig 3 it is observed that the pollutant transport is significantly faster for α 0 i e for homogeneous medium as compare to α 0 1 and α 0 2 i e for heterogeneous medium in case of both the parent and daughter species this is due to the higher velocity at each of the spatial value in heterogeneous medium also the peak concentration strength is little higher for homogeneous medium as compare to heterogeneous medium for both the species due to the higher dispersion rate in the heterogeneous medium similar to fig 1f or case i fig 4 illustrates the h curves for both species to identify the bounded range for the values of h 1 and h 2 for the selection of their suitable values to ensure the convergency of the solution in case for transient transport in the steady groundwater flow the h curves are depicted for all four type of considered velocity profiles it is observed that the h curves for each type of velocity profile is quite different in nature but the horizontal lines responsible for suitable values of h 1 and h 2 are quite similar the range is observed to be 3 3 and for graphical description values of h 1 and h 2 are assumed to be 0 1 and 0 15 figs 5 and 6 exhibits the pollutant concentration distribution for transient transport phenomenon in steady groundwater flow for parent c 1 and daughter species c 2 respectively the impact of exponentially increasing exponentially decreasing linear and asymptotic type for transport parameters over pollutant transport is depicted it is observed that the concentration strength for both the species initially increases with the increasing position value and after attaining its peak value it changes its nature and start decreasing with position and attains its minimum harmless value in each case this observation is made for fixed temporal domain t 20 hr fig 7 presents the variation of concentration distribution profile for different time domain in case of both parent c 1 and daughter species c 2 for exponentially increasing type velocity pattern it is observed that under the considered model domain and migration parameters the concentration strength decreases with increasing time for parent species while for daughter species it increases with time also the peak concentration strength is observed to be higher for c 1 x t as compare to c 2 x t for any fixed temporal for example for a fixed time period t 20 hrs the peak concentration value for the parent species is observed to be 246 40 mg cm3 at spatial value x 410 cm while that for the daughter species is observed to be 43 30 mg cm3 at spatial value x 396 cm fig 8 presents the h curves for transient transport system in case of unsteady groundwater flow i e the phenomenon where the dispersion and velocity both are spatially temporally dependent h 1 and h 2 curves are analysed for all the four different type of considered temporal functions the suitable values of h 1 and h 2 are assumed to be 0 2 and 0 3 from the existing convergence range depicted as horizontal line in the h curves for the solution of both species the impact of all four types of time dependent parameters over concentration strength of c 1 x t and c 2 x t is observed in the figs 9 and 10 respectively it is depicted that there is no concentration strength for both the species at starting point i e at x 0 and with increasing position value the concentration strength increases and attains its maximum value and then decreases with distance for both the species also the concentration distribution is observed to be higher for linear velocity pattern and lower for exponentially increasing type of velocity pattern up to certain positional value and after that it completely changes its nature and become higher for exponentially increasing velocity pattern and lower for linear type of velocity pattern for both the concentration strength of c 1 x t and c 2 x t for c 1 x t it changes its nature after the distance x 1000 cm and for c 2 x t it changes its nature after the distance x 960 cm these observations are corresponding to fixed temporal value t 20 h fig 11 presents a comparative illustration of concentration distribution profile for different time t 10 20 30 h for both species in case of dispersion and velocity with exponential dependent functions over time at beginning the pollutant concentration increases with position within the domain x 500 cm for c 1 x t and c 2 x t both and thereafter the pollutant concentration for both species decreases with position and asymptotically approaches to zero concentration strength 5 validation of the solution 5 1 validation with the exact solution simpson and ellery 2014 in case of constant transport parameters for the validation of the solution the model is transformed for constant transport parameters i e constant dispersion coefficient and constant transport velocity also the two species pollutant migration system is considered with the assumption that concept of linear adsorption is incorporated only with parent species c 1 the governing equation for such migration system is modelled by setting d x t d 0 v x t v 0 and r 2 1 in eq 2a b described in section 2 1 thus we get 24a r 1 c 1 t d 0 2 c 1 x 2 v 0 c 1 x k 1 c 1 24b c 1 t d 0 2 c 1 x 2 v 0 c 1 x k 2 c 2 k 1 c 1 and initial and boundary condition for above system are considered similar to previously considered model given by eqs 3a b and 4 the above model is similar to the model presented by the study simpson and ellery 2014 which derived the exact solution of the two species system under similar assumption by using a different method based on laplace transform technique generating the power series solution of the system the ham solution of above two species system is obtained by setting α 0 β 1 and r 2 1 in the ham solution for steady transport phenomenon in steady groundwater flow discussed in the section 3 1 a comparison between derived ham solution and exact solution simpson and ellery 2014 for the concentration distribution pattern of both the species c 1 x t and c 2 x t is graphically depicted in the figs 12 and 13 for parent species c 1 concentration strength is validated for temporal domain t 0 20 40 hr and for daughter species c 2 concentration strength is validated for temporal domain t 0 10 20 hr the ham solution for both the species compares very well with the exact solution presented in the study simpson and ellery 2014 comparison between the numerical values of ham solution for concentration strength and the exact solution presented by simpson and ellery 2014 in case of constant transport parameter for parent and daughter species both are presented in tables 1 and 2 respectively 5 2 validation of ham solution for variable transport parameter cases for the authentication of derived ham solutions for all three variable dependent cases i e a steady migration system in steady flow domain b transient migration system in steady flow domain and c transient migration system in unsteady flow domain we have simulate the considered model in all cases by using matlab coding for the variational iteration method he 1997 1998a 1998b liu 2005 which is well established method for non linear systems and can provide the accurate solution to a rather wide class of nonlinear equations without linearization perturbation closure approximations or discretization methods generally occurs in massive numerical computation this method is a modified version of lagrange multiplier method inokuti et al 1978 which effectively provides the accurate solutions of non linear systems by using further approximations which converges to the exact solution of the system more rapidly it is generally based on the variational theory and general weighted residual method to simulate the problem first we formulate the correction functional he 1998b corresponding to our system of multispecies problem then identify the lagrange multiplier by using the variational theory finlayson 1972 he 1998b a comparison between derived solution by ham and solution obtained from variational iteration method vim is made for parent and daughter species both in all cases a good agreement is found between both the solution as depicted from figs 14 16 simulation is carried out for three different temporal values t 0 5 10 h for parent and daughter species both 6 application the theoretical structure for the considered model evolved from the consequences of the proposed study can be employed in the field of hydrology petroleum engineering geology environmental science and the fields related to waste radioactive decay also the derived solutions can be particularly advantageous to predict the dispersion of chemical pollutants and ionic species in the groundwater due to landfill leachate from various landfills and their nearby locations the variability of the parameters considered in the proposed study is helpful to predict the migration of reactive multispecies in the groundwater system as from the findings of various theoretical studies and field experiments it has been demonstrated that the recharge rate has an impact on pollutant distribution up to some significant extent and may partially describe the scale and time dependence of velocity and dispersion parameters sudicky 1986 dagan 1984 serrano 1992 batu 2006 singh and chatterjee 2016 sanskrityayn et al 2017 to depict the impact of variable dependent migration parameters over multispecies reactive migration system one example is considered based on nitrification chain migration problem n h 4 n o 2 n o 3 previously used by cho 1971 and guerrero et al 2009 as in our study the solution is presented for two species migration system by ham thus for graphical presentation of concentration variation n h 4 is treated as parent species c 1 x t of the system and n o 2 is assumed to be produced daughter species c 2 x t of the system in order to predict the concentration strength of both the species i e n h 4 and n o 2 under our considered model conditions the specific values of migration parameters are chosen as guerrero et al 2009 d 0 0 18 c m 2 h r u 0 1 cm h r k 1 0 01 h r k 2 0 1 h r r 1 2 r 2 1 the nitrification chain migration for n h 4 and n o 2 is analysed corresponding to modelled system under the initial and boundary conditions eqs 3a b 4 with space and time dependent transport parameters the numerical values for all the parameters responsible for spatial and temporal dependence are considered same as used in section 4 the variation of concentration strength for both species for constant parameter case and for variable parameter case is graphically depicted in the fig 17 the study is carried out for fixed time t 10 hr and for variable dependent case the spatial and temporal functions both are considered to be linear result for both species is also validated by using the solutions derived by variational iteration method this study is also helpful for the anticipation of the movement of the reactive species and their distribution in case of unsteady flow of the groundwater in the unsaturated soil system and further capable to describe the dispersion process of reactive species in the heterogenous aquifers the presented model can also be used as an elementary tool for analysing the attenuation of reactive species and their migration process in the presence of variable transport parameters in multispecies system 7 summary and conclusion in this article the impact of variable dependent migration parameters over multispecies reactive transport system is effectively analysed the homotopy analysis method is employed to develop the semi analytical solutions of the modelled problem for numerical interpretation of the system two species problem is adopted with different retardation factor values for both the species along with first order decay rate coefficients also the concept of linear adsorption is incorporated with the considered system study is carried out for three different scenario of transport system a steady migration system in steady flow domain b transient migration system in steady flow domain and c transient migration system in unsteady flow domain which are capable to describe the natural physical processes happening in the groundwater flow system for multispecies reactive transport phenomenon to justify the impact of spatially varying transport parameters the dispersion coefficient and the migration velocity term are considered with linear space dependent function and that for temporal variation four different type of functions exponentially increasing exponentially decreasing linear and asymptotically dependent are adopted as per author s knowledge for multispecies reactive transport system no other solution is in existence till now for both spatially and temporally dependent transport parameters results have been previously analysed either for constant parameters or only for space dependent parameters or only for time dependent parameters but not for both because of the complexity of the modelled system also in this study solutions are derived for general time dependent functions the key points of this study can be summarised as follows 1 the impact of variable dependent parameters over multispecies reactive system is graphically analysed and it is observed that the peak concentration strength is little higher for homogeneous medium as compare to that of heterogeneous medium for both the species due to the higher dispersion rate in the heterogeneous medium 2 the change in the value of concentration strength for both the species completely depends on the type of temporal dependence of the migration parameters a significant variation due to different type of temporal functions is graphically analysed for parent and daughter species both in the transient migration system 3 the homotopy analysis method is adopted to obtain the solution in all three cases the advantage of using ham is that ham is much stable and easy to use tool for nonlinear system and does not require small parameters to handle the solution of the system 4 ham is also capable to overcome the limitations of different types of decomposition and transformation methods related to complex modelled system of the problem and their complicated numerical procedure of solving the problem and also removes the issue regarding convergency of the solutions the ham contains the convergence control parameter which provides the user with an easier way to control and adjust the convergence region for the solution 5 the derived solution by ham is compared by previously available exact solution of same model in case of constant transport parameters based on an alternative method of laplace transform method simpson and ellery 2014 and the validation is also carried out for all the variable dependent cases by using variational iteration method he 1997 1998a 1998b liu 2005 in all cases a good agreement is found between both the solutions for parent and daughter species both 6 an application based on nitrification chain migration system is analysed corresponding to our considered model to authenticate the impact of variable dependent transport parameters over constant transport parameters case the proposed series solution of multispecies reactive system can confer a remarkable significance for the relative analysis regarding the impact of variable dependent migration parameter over multispecies reactive system and also used as the benchmark solution for the validation of numerical and theoretical studies on multispecies problems credit authorship contribution statement manish chaudhary conceptualization methodology writing original draft investigation validation formal analysis mritunjay kumar singh supervision writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the authors are thankful to the editor and anonymous reviewers for their valuable comments which contributed to the improvement in the presentation of the paper authors would also like to acknowledge iit ism dhanbad for supporting this work through jrf scheme this work is also partially supported by dst serb under the project no emr 2016 001628 
5099,multispecies pollutant migration is most natural phenomenon frequently occurring in the polluted groundwater system and also evidently occurs in the nuclear repositories and sites having radioactive substances and chemical solvent modeling pollutant migration of reactive multispecies problem with variable transport parameters is quite a challenging issue necessary for better sightedness of fate and transport of reactive solutes and their geochemical growth in the geological formations at present most of the solutions for multispecies problem are corresponding to the constant parameters affecting the concentration distribution not for variable transport parameters because of the complexity of the modelled equation this paper dealt with the comparative study of multispecies pollutant transport problem in porous structure to analyse the effect of spatially and temporally varying hydrodynamic dispersion coefficient and transport velocity terms in more general form for mathematical elaboration two species transport problem is considered subjected to the concept of linear isotherm with both the parent and daughter species without using identical retardation factor and model is also incorporated with the first order decay term under spatially varying initial conditions homotopy analysis method ham is adopted to develop the series solution for the concentration segmentation of each species of the model the advantage of this method is that it is capable to overcome the limitation of existing transform methods for some cases of complex modelled problems the zeroth order deformation equation is derived by using ham to generate the semi analytical solution of the model under certain auxiliary linear operator the impact of distinct retardation factor for different species and effect of diversity in dependency of modelled parameters over space and time are graphically depicted for both the species and illustrated that it has a valuable impact over multispecies pollutant migration as there exist no analytical or numerical solution for such complex variable dependency of migration parameters over transport phenomenon these solutions may be helpful to deliver a better significant about the concentration variation due to space and time dependent transport parameters responsible for reactive multispecies migration in more natural way keywords multispecies pollutant transport linear isotherm homotopy analysis method series solution 1 introduction the solid waste management is one of the major issues in india due to the rapid evolution in the industrial areas and urbanization process the continuous population growth and increasing per person municipal solid waste generation make it much more difficult to accomplish sustainable advancement in solid waste management sanitary landfilling is always an effective and economical scheme for the disposal of the solid wastes but due to deterioration of the landfill liners in the older landfills it causes the transmission of leachate and its venomous components into underlying geological formations or its neighbouring rivers which is responsible for the spoilage of drinking water abbas et al 2009 kumar et al 2017 for its remediation process it is quite necessary to understand the behaviour of solute dispersion and its reactive processes in the aquifer systems the mathematical modelling can play an important role in the understanding of leachate migration and to simulate the pollutant migration in the aquifer the pollutant transport models based on classical convection dispersion equation are impressive tools for better perception and anticipation of biological and physical behaviour of reactive migration in geological formations with reactive pollutants like as chloride and sulphate solvents radioactive substances and various hydrocarbons batu 2006 over last few decades a large number of explorations have been made to investigate the pollutant migration phenomenon in the groundwater system based on theoretical and experimental studies bear 1972 sposito et al 1979 domenico 1987 clement 1999 2001 de simoni et al 2005 a short report about the available analytical and numerical solutions for pollutant transport problem under the assumption of different type of inlet and boundary conditions is provided below a comprehensive and comparative analysis of one dimensional pollutant transport models for single species migration have been formulated in the study van genuchten 1982 this study presented an adequate number of transport models incorporated with various parameters affecting the transport phenomenon and also with the consideration of different type of inlet and boundary conditions later van genuchten 1985 numerically formulated the analytical solution for transport model with sequential first order decay reactions to describe the simultaneous migration of four species involved in the chain reaction process using the laplace transform method afterwards yeh and tripathi 1991 simulated the migration of reactive pollutants by using coupled hydrogeochemical model the model was structured in such a way that it can simulate various type of reactive migration problem and applicable for saturated unsaturated heterogenous medium under steady or transient flow conditions both later lunn et al 1996 determined an analytical solution for multispecies contaminant movement based on the reactive model for three species incorporated with first order decay rates for all species and concept of linear isotherm with first species this investigation used the fourier transform method to obtain the solution for the model and suggested that this technique is more capable and easier to handle the model with much complicated inlet and boundary conditions as compare to technique involving laplace transform method used in the previously similar works cho 1971 van genuchten 1985 fujikawa and fukui 1990 chrysikopoulos et al 1990 to analyse the transport system for multispecies problem along with parallel or sequential first order reaction mechanism the study sun and clement 1999 developed general transformation method in which coupled multispecies system is decomposed into multiple self sufficient models for single species which make it easier to handle in term of analytical solution of the system later on sun et al 1999a sun et al 1999b used similar method to extend the solution of multispecies reactive system in case of multiple dimensional problem these solutions have been limited to justify the migration of multispecies system only for unidirectional flow in single porous structure corresponding to equal value of retardation coefficient for each species to overcome such limitation bauer et al 2001 derived solutions for unidirectional and radial steady state flow in case of identical and distinct retardation coefficient values both under the consideration of various form of boundary conditions in addition quezada et al 2004 and chamkha 2005 also used distinct values for retardation factor term for each species the laplace transform method was employed to get the solution romeiro et al 2007 employed linearization technique to present a comparative study of pollutant migration in multispecies reactive process for both cases system with distinct and similar retardation coefficient values furthermore slodicka and balazova 2008 slodicka and balazova 2010 developed new decomposition method to analyse multispecies problem which are modifies version of decomposition method used in the studies sun and clement 1999 sun et al 1999a 1999b to overcome their limitations over various transformations this technique slodicka and balazova 2010 is designed in such a way so that it is independent of any temporary transformations and also capable to extend the system for distinct retardation factors later natarajan and kumar 2010 presented an alternative approach of decomposition techniques used for analysing multispecies reactive systems based on finite difference method to overcome the limitations regarding the decoupling process of coupled equations of multispecies system previously numerical method based on computer code for simulating reactive multispecies transport in 3 dimentional groundwater system rt3d was employed by clement et al 1998 and clement 1999 to analyse the multispecies migration process in case of constant transport parameters chen et al 2012a applied the method based on laplace transform and generalized integral transform technique with respect to time and space respectively to derive the solution for multispecies problem in case of finite spatial domain which was one of the limitations of previously available decomposition methods this investigation considered constant boundary conditions to analyse the solution afterwards chen et al 2012b presented the solution for temporally varying source boundary condition with similar modelled problem chen et al 2012a a case study huo et al 2014 was presented to explore the multispecies reactive transport phenomenon by using decoupling approach for heterogeneous medium where the entire domain was further divided into various subdomains on the basis of different reactions taking place in the domain later simpson and ellery 2014 presented the exact series solutions for reactive migration systems for both single species and multispecies models this series solution method was capable to derive the solution corresponding to the general spatially dependent inlet conditions and has great freedom on their selection which overcome the limitations of previously available analytical solutions cho 1971 lunn et al 1996 arnold et al 2017 numerically investigated the result for fickian and nernst plank model for multispecies transport phenomenon in the privation of chemical reactions and also for the reactive hydrated portland cement and analyse that measurable difference can be depicted in the presence of nitrate solution furthermore spatial moment analysis was performed for the multispecies transport problem natarajan and kumar 2018 by using implicit finite difference approach later chen et al 2018 developed the analytical solution for more complicated sorption system in the multispecies reactive migration model to explore the impact of kinetic sorption over multispecies migration the above presented literature regarding the problems for multispecies reactive transport phenomenon has a common property that all are corresponding to constant transport parameters i e for constant dispersion and velocity term but to understand the pollutant dispersion behaviour in more natural and conventional way it is quite necessary to model the reactive system with variable dependent transport parameters it is quite difficult to formulate the analytical solutions corresponding to coupled multispecies pollutant transport problem in case of considered model along with variable dependent parameters because as compare to constant parameters their variable dependency makes the modelled system much more complex which is difficult to handle for deriving their analytical solutions that is the region for the existence of such studies to be very few to the best of our knowledge some multispecies models are developed for variable dependency of parameters chamkha 2005 chen et al 2012b natarajan 2016 suk 2016 but the investigation is performed either only for spatially varying parameters chamkha 2005 natarajan 2016 suk 2016 or only for temporally varying parameters natarajan 2016 suk 2016 not for spatially temporally varying parameters the study chamkha 2005 natarajan 2016 employed the numerical method based on implicit tri diagonal finite difference approach while suk 2016 presented the study by using generalized integral transform technique and validated the result by using the code based on two dimensional subsurface flow fate and transport of microbes and chemicals 2dfacmic also these studies are performed only for some particular type of functions like as linearly varying parameters not for general case while for the single species problem an adequate number of researches has been reported to justify the spatial and temporal effect of migration parameters over pollutant transport gao et al 2010 singh and das 2015 gharehbaghi 2016 singh and chatterjee 2016 sanskrityayn et al 2017 chaudhary et al 2020 the above review suggested that it is quite necessary to formulate an advanced model for multispecies reactive system equipped with more complicated variable dependent functions for transport parameters in this study to formulate the solution for the considered model of multispecies problem ham is taken into account which was first developed and proposed by liao 1992 this approximate series solution method is based on the idea of homotopy an elemental concept of differential geometry and topology which characterize a kind of continuous deformation as compare to other convenient asymptotic methods and perturbation techniques used for the formulation of the analytical solution of the non linear systems ham is designed in such a way that it is free from dependency of the method procedure over many large physical parameters responsible for the convergency of the solution liao 2012 the ham also provides more appropriate and much convenient procedure to ensure the convergency of the derived semi analytical solution by introducing the convergence control parameter which confer the researcher with a simple process to adjust and control the region of convergence of the series solution liao 1995 the ham has been successfully adopted for the formulation of the solutions of different type of nonlinear systems he 2005 babolian et al 2009 mahmood et al 2014 singh and chatterjee 2017 filobello nino et al 2017 beside this ham also gives great freedom to formulate the deformation equation for the problem and also to select the appropriate initial guess to handle the solution of the considered non linear system which helps the user to control the complexity of the mathematical procedure in much simpler way the main objective of this study is to present a comparative description of the multispecies pollutant migration system by analysing the effect of variable dependent migration parameters which are responsible for the pollutant migration in the groundwater system for this the effective dispersion coefficient and seepage velocity terms are considered to be constant dependent over space and also dependent over space and time both i e the system is analysed for both the cases steady and unsteady groundwater flow and also for the transient transport system for mathematical formulation of the problem two species reactive migration system is considered along with the first order decay terms in semi infinite medium the retardation factors are considered to be non identical for both the species the considered model is solved by using ham under some appropriate inlet and boundary conditions for both the species for the parent species some exponentially decreasing initial pollutant is considered and for the daughter species it is assumed to be zero solutions are formulated corresponding to the general time dependent function and for the graphical description of the temporal effect over multispecies problem the pictorial representation of concentration patterns for both species are made for different type of temporally varying functions like as exponentially increasing exponentially decreasing linear and asymptotically dependent functions derived ham solution of the model is validated with previously existing analytical solutions for both the species under the assumption of constant dispersion and velocity term and a good agreement is found between both the solutions also for the authentication of ham derived solutions for all three cases are further validated by using another existing method for non linear systems called variational iteration method and the error between both the solution is observed to be almost negligible this research work is organized as follows the next section 2 explains the governing equation for multispecies reactive migration system and presents a mathematical formulation for two species problem under certain inlet and boundary conditions section 3 addresses the formation of ham solution of the considered system in general form this section also comprises three subsections to present the ham solutions for parent and daughter species for all three considered cases a steady migration system in steady flow domain b transient migration system in steady flow domain and c transient migration system in unsteady flow domain respectively thereafter section 4 constitutes the graphical results and discussion based on concentration variation due to various type of dependency over transport parameters this section is followed by validation part of the derived solutions with previously available literature and solutions obtained by other methods presented in section 5 and the application part of the study is presented in the section 6 where one example based on nitrification chain migration system is reported finally the summary and conclusions drawn from the results are then briefly abbreviated in the conclusion section which is followed by reference section 2 mathematical formulation general form for a reactive transport system that describe multispecies migration phenomenon with spatially and temporally varying parameters responsible for the pollutant migration in the groundwater system along with sorption and first order decay rate and concept of distinct retardation factor value for each species in a one dimensional flow field is modelled as follows 1 r i c i t x d x t c i x v x t c i k i 1 c i 1 k i c i i 1 2 n where k 0 0 and n represents the number of species in the system c i m l 3 is the concentration strength for ith species d x t l 2 t 1 is the dispersion coefficient v x t l t 1 is the seepage velocity r i and k i t 1 are the retardation factor and decay rate coefficients for ith species respectively 2 1 problem for two species reactive system in this study two species one dimensional problem is considered to demonstrate the effect of spatially and temporally dependent transport parameters over pollutant migration behaviour also the problem is modelled for different retardation factor term for both the species 2a r 1 c 1 t x d x t c 1 x v x t c 1 k 1 c 1 2b r 2 c 2 t x d x t c 2 x v x t c 2 k 2 c 2 k 1 c 1 where c 1 m l 3 represents the pollutant concentration level for parent species and c 2 m l 3 is that for daughter species d x t and v x t are the dispersion coefficient and seepage velocity term which are assumed to be dependent on space and time both to visualize their effect on pollutant movement in more natural way also r 1 and r 2 are the retardation factor for parent and daughter species respectively k 1 t 1 and k 2 t 1 are the decay rate coefficients for both the species corresponding initial and boundary conditions for the considered two species model are assumed to be 3a c 1 x 0 f x c 1 0 t f 0 lim x c 1 x t 0 3b c 2 x 0 g x c 2 0 t g 0 lim x c 2 x t 0 where the functions f x and g x are considered as simpson and ellery 2014 4 f x a x exp b x g x 0 i e problem is formulated for the assumption that there exists some spatially dependent pre existing pollutant for parent species c 1 x t but for daughter species c 2 x t initial concentration is considered to be zero 3 solution by ham in this paper we used homotopy analysis method to obtain the desired solution of the two species system quezada et al 2004 natarajan and kumar 2010 simpson and ellery 2014 for this we first require some appropriate initial guesses for the solutions corresponding to both the species based on the considered initial conditions of both the species the initial approximation for parent and daughter species are considered as follows 5a c 1 0 x t a x exp b x 5b c 2 0 x t 0 and to get the solution of the considered model by ham the linear operators are introduced as 6 i 1 ϕ 1 x t q r 1 ϕ 1 x t q t and i 2 ϕ 2 x t q r 2 ϕ 2 x t q t which satisfy the property that i i p i 0 i 1 2 where p i being the integration constant where ϕ 1 x t q and ϕ 2 x t q are considered as the solution for both species and q 0 1 is the homotopy parameter also known as embedding parameter responsible for the deformation of the solution from the assumed initial guesses of the solution to the final solution of the system the system of non linear operators can be defined as 7a n 1 ϕ 1 x t q r 1 c 1 t x d x t c 1 x v x t c 1 k 1 c 1 7b n 2 ϕ 2 x t q r 2 c 2 t x d x t c 2 x v x t c 2 k 2 c 2 k 1 c 1 as suggested by liao 2012 the zeroth order deformation equations for both the species can be formulated as follows 8a 1 q n 1 ϕ 1 x t q c 1 0 x t h 1 q n 1 ϕ 1 x t q 8b 1 q n 2 ϕ 2 x t q c 2 0 x t h 2 q n 2 ϕ 2 x t q where h 1 and h 2 are the convergence control parameters from above deformation equations it is clearly verified that q 0 is corresponding to the initial guesses c 1 0 x t and c 2 0 x t while q 1 is corresponding to the final solutions c 1 x t and c 2 x t of the problem also the mth order deformation equations for both the species are defined as liao 2012 9a c 1 m x t χ m c 1 m 1 x t h 1 i 1 1 m 1 n 1 ϕ 1 x t q q m 1 q 0 9b c 2 m x t χ m c 2 m 1 x t h 2 i 1 1 m 1 n 2 ϕ 2 x t q q m 1 q 0 where χ m 0 m 1 1 m 1 thus by using above mth order deformation equations the mth term of the approximate solution for c 1 x t and c 2 x t can be obtained as follows 10a c 1 m x t χ m c 1 m 1 x t h 1 i 1 r 1 c 1 m 1 t x d x t c 1 m 1 x v x t c 1 m 1 k 1 c 1 m 1 10b c 2 m x t χ m c 2 m 1 x t h 2 i 1 r 2 c 2 m 1 t x d x t c 2 m 1 x v x t c 2 m 1 k 2 c 2 m 1 k 1 c 1 m 1 as the solution of the problem converges for q 1 thus approximate series solution for both the species based on homotopy maclaurin series can be obtained as follows liao 2012 11a c 1 x t c 1 0 x t m 1 c 1 m x t 11b c 2 x t c 2 0 x t m 1 c 2 m x t in general most of the solution for multispecies migration system are derived for constant dispersion and velocity term but here we are considering three different scenarios for spatial and temporal dependency of these parameters for extensive study of their impact over pollutant migration 3 1 case i steady migration system in steady flow domain let 12 d x t d 0 β α x 2 v x t v 0 β α x i e dispersion coefficient and transport velocity term both are considered to be spatially dependent to represent the steady migration phenomenon in the case of steady groundwater flow also the concept of general dispersion theory i e dispersion is directly proportional to the square of the velocity is considered batu 2006 d 0 l 2 t 1 and v 0 l t 1 are the initial dispersion and velocity terms respectively and α l 1 is the heterogeneity parameter as β 1 and α 0 i e for very small value of heterogeneity parameter α the system is for homogeneous medium means there is no effect of position over dispersion and transport velocity and higher value of α is responsible for the medium to be heterogeneous now from eq 10a the mth term of the approximate solution for parent species is defined as 13a c 1 m x t χ m c 1 m 1 x t h 1 i 1 r 1 c 1 m 1 t d 0 β α x 2 2 c 1 m 1 x 2 v 0 2 α d 0 β α x c 1 m 1 x k 1 α v 0 c 1 m 1 similarly mth term of the approximate solution for daughter species by using eq 10b is defined as 13b c 2 m x t χ m c 2 m 1 x t h 2 i 1 r 2 c 2 m 1 t d 0 β α x 2 2 c 2 m 1 x 2 v 0 2 α d 0 β α x c 2 m 1 x k 2 α v 0 c 2 m 1 k 1 c 1 m 1 3 1 1 solution for parent species by using the formula for mth term of the approximate solution given by eq 13a the successive terms of the approximation liao 2012 for the solution for parent species c 1 are derived as follows 14a c 1 0 x t a x exp b x 14b c 1 1 x t h 1 t r 1 d 0 β α x 2 a b 2 b x exp b x v 0 2 α d 0 β α x a 1 b x exp b x k 1 α v 0 ax exp b x 14c c 1 2 x t c 1 1 x t h 1 2 t r 1 d 0 β α x 2 a b 2 b x exp b x v 0 2 α d 0 β α x a 1 b x exp b x k 1 α v 0 ax exp b x h 1 2 t 2 2 r 1 2 d 0 2 β α x 4 a b 3 4 b x exp b x 2 d 0 v 0 4 α d 0 β α x 3 a b 2 3 b x exp b x v 0 2 α d 0 v 0 4 α d 0 2 d 0 2 α v 0 3 α 2 d 0 k 1 β α x 2 a b 2 b x exp b x v 0 2 α d 0 3 α v 0 2 α 2 d 0 2 k 1 β α x a 1 b x exp b x k 1 α v 0 2 ax exp b x 14d c 1 3 x t c 1 2 x t h 1 2 1 h 1 t r 1 d 0 β α x 2 a b 2 b x exp b x v 0 2 α d 0 β α x a 1 b x exp b x k 1 α d 0 ax exp b x h 1 2 1 2 h 1 t 2 2 r 1 2 d 0 2 β α x 4 a b 3 4 b x exp b x 2 d 0 v 0 8 α d 0 β α x 3 a b 2 3 b x exp b x v 0 2 α d 0 v 0 4 α d 0 2 d 0 2 α v 0 3 α 2 d 0 k 1 β α x 2 a b 2 b x exp b x v 0 2 α d 0 3 α v 0 2 α 2 d 0 2 k 1 β α x a 1 b x exp b x k 1 α d 0 2 ax exp b x h 1 3 t 3 6 r 1 3 d 0 3 β α x 6 a b 5 6 b x exp b x 3 d 0 2 v 0 6 α d 0 β α x 5 a b 4 5 b x exp b x d 0 v 0 4 α d 0 v 0 8 α d 0 2 d 0 v 0 2 α d 0 v 0 6 α d 0 d 0 2 11 α v 0 42 α 2 d 0 3 k 1 β α x 4 a b 3 4 b x exp b x v 0 4 α d 0 2 d 0 3 α v 0 10 α 2 d 0 k 1 v 0 2 α d 0 v 0 8 α d 0 d 0 v 0 2 α d 0 3 α v 0 2 α 2 d 0 2 k 1 2 d 0 v 0 6 α d 0 2 α v 0 3 α 2 d 0 k 1 β α x 3 a b 2 3 b x exp b x v 0 2 α d 0 v 0 4 α d 0 6 α v 0 8 α 2 d 0 3 k 1 2 d 0 3 α v 0 6 α 2 d 0 k 1 2 α v 0 3 α 2 d 0 k 1 d 0 k 1 α v 0 2 β α x 2 a b 2 b x exp b x v 0 2 α d 0 2 α v 0 2 α 2 d 0 k 1 3 α v 0 2 α 2 d 0 2 k 1 k 1 α v 0 2 v 0 2 α d 0 β α x 3 a 1 b x exp b x k 1 α v 0 3 ax exp b x 3 1 2 solution for daughter species by using the formula for mth term of the approximate solution given by eq 13b the successive terms for the solution for daughter species c 2 are derived as follows 15a c 2 0 x t 0 15b c 2 1 x t h 2 t r 2 k 1 ax exp b x 15c c 2 2 x t c 2 1 x t h 2 2 t r 2 k 1 ax exp b x h 2 2 t 2 2 r 2 2 k 1 d 0 β α x 2 a b 2 b x exp b x v 0 2 α d 0 β α x a 1 b x exp b x k 2 α d 0 ax exp b x h 1 h 2 t 2 2 r 1 r 2 k 1 d 0 β α x 2 a b 2 b x exp b x v 0 2 α d 0 β α x a 1 b x exp b x k 1 α v 0 ax exp b x 15d c 2 3 x t c 2 2 x t h 2 2 1 h 2 r 2 1 k 2 α v 0 2 r 2 t k 1 t h 2 2 2 r 2 h 1 k 1 α v 0 r 1 h 2 k 2 α v 0 r 2 1 k 2 α v 0 3 r 2 t k 1 t 2 h 1 h 2 1 h 1 2 r 1 r 2 k 1 k 1 α v 0 t 2 ax exp b x h 2 2 2 r 2 h 1 r 1 1 2 h 2 r 2 k 1 t 2 h 1 h 2 1 h 1 2 r 1 r 2 k 1 t 2 h 2 2 6 r 2 2 h 1 k 1 α v 0 r 1 h 2 k 2 α v 0 r 2 k 1 t 3 d 0 β α x 2 a b 2 b x exp b x v 0 2 α d 0 β α x a 1 b x exp b x h 2 2 6 r 2 2 h 1 r 1 h 2 r 2 k 1 t 3 d 0 2 β α x 4 a b 3 4 b x exp b x 2 d 0 v 0 4 α d 0 β α x 3 a b 2 3 b x exp b x d 0 2 α v 0 2 α 2 d 0 k 2 v 0 3 α d 0 v 0 4 α d 0 β α x 2 a b 2 b x exp b x v 0 2 α d 0 2 α v 0 2 α 2 d 0 k 2 β α x a 1 b x exp b x h 1 2 h 2 6 r 1 2 r 2 k 1 t 3 d 0 2 β α x 4 a b 3 4 b x exp b x 2 d 0 v 0 4 α d 0 β α x 3 a b 2 3 b x exp b x v 0 2 α d 0 v 0 4 α d 0 2 d 0 2 α v 0 3 α 2 d 0 k 1 β α x 2 a b 2 b x exp b x v 0 2 α d 0 3 α v 0 2 α 2 d 0 2 k 1 β α x a 1 b x exp b x k 1 α v 0 2 ax exp b x 3 2 case ii transient migration system in steady flow domain let 16 d x t d 0 β α x 2 ζ mt v x t v 0 β α x i e dispersion coefficient is considered to be spatially temporally dependent while velocity is considered to be spatially dependent only for temporal variation for dispersion term a general temporal function ζ mt is considered with dispersion which can further consider to be exponential linear asymptotic type function based on the medium type now from eq 10a the mth term of the approximate solution for parent species is defined as 17a c 1 m x t χ m c 1 m 1 x t h 1 i 1 r 1 c 1 m 1 t d 0 β α x 2 ζ mt 2 c 1 m 1 x 2 v 0 2 α d 0 ζ mt β α x c 1 m 1 x k 1 α v 0 c 1 m 1 similarly mth term of the approximate solution for daughter species by using eq 10b is defined as 17b c 2 m x t χ m c 2 m 1 x t h 2 i 1 r 2 c 2 m 1 t d 0 β α x 2 ζ mt 2 c 2 m 1 x 2 v 0 2 α d 0 ζ mt β α x c 2 m 1 x k 2 α v 0 c 2 m 1 k 1 c 1 m 1 3 2 1 solution for parent species by using the formula for mth term of the approximate solution given by eq 17a the successive terms for the solution for parent species c 1 are derived as follows 18a c 1 0 x t a x exp b x 18b c 1 1 x t h 1 r 1 d 0 β α x 2 a b 2 b x exp b x 0 t ζ m υ d υ v 0 t 2 α d 0 0 t ζ m υ d υ β α x a 1 b x exp b x k 1 α v 0 t ax exp b x 18c c 1 2 x t c 1 1 x t h 1 2 r 1 d 0 β α x 2 a b 2 b x exp b x 0 t ζ m υ d υ v 0 t 2 α d 0 0 t ζ m υ d υ β α x a 1 b x exp b x k 1 α v 0 t ax exp b x h 1 2 r 1 2 d 0 2 β α x 4 a b 3 4 b x exp b x 0 t ζ m υ 0 t ζ m υ d υ d υ h 1 2 r 1 2 v 0 d 0 0 t υ ζ m υ 0 t ζ m υ d υ d υ 8 α d 0 2 0 t ζ m υ 0 t ζ m υ d υ d υ β α x 3 a b 2 3 b x exp b x h 1 2 r 1 2 v 0 2 t 2 2 d 0 5 α v 0 k 1 0 t υ ζ m υ 0 t ζ m υ d υ d υ 14 α 2 d 0 2 0 t ζ m υ 0 t ζ m υ d υ d υ β α x 2 a b 2 b x exp b x h 1 2 r 1 2 v 0 3 α v 0 2 k 1 t 2 2 2 α d 0 2 α v 0 k 1 0 t υ ζ m υ 0 t ζ m υ d υ d υ 4 α 3 d 0 2 0 t ζ m υ 0 t ζ m υ d υ d υ β α x a 1 b x exp b x h 1 2 r 1 2 α v 0 k 1 2 t 2 2 ax exp b x 3 2 2 solution for daughter species by using the formula for mth term of the approximate solution given by eq 17b the successive terms for the solution for daughter species c 2 are derived as follows 19a c 2 0 x t 0 19b c 2 1 x t h 2 t r 2 k 1 ax exp b x 19c c 2 2 x t c 2 1 x t h 2 2 r 2 k 1 t ax exp b x h 2 2 r 2 2 k 1 d 0 β α x 2 a b 2 b x exp b x 0 t υ ζ m υ d υ v 0 t 2 2 2 α d 0 0 t υ ζ m υ d υ β α x a 1 b x exp b x k 2 α v 0 t 2 2 ax exp b x h 1 h 2 r 1 r 2 k 1 d 0 β α x 2 a b 2 b x exp b x 0 t 0 t ζ m υ d υ d υ v 0 t 2 2 2 α d 0 0 t 0 t ζ m υ d υ d υ β α x a 1 b x exp b x k 1 α v 0 t 2 2 ax exp b x 3 3 case iii transient migration system in unsteady flow domain let 20 d x t d 0 β α x 2 ψ 2 mt v x t v 0 β α x ψ mt i e dispersion and velocity both are considered to be spatially temporally dependent to justify the transient transport situation for the unsteady flow for spatial variation a linear function is considered while to represent temporal variation a general temporal function ψ mt is assumed where m t 1 is the flow resistance quantity as m 0 i e for very small value of temporal parameter m there will be no effect of time over dispersion and velocity so the state will be steady and for other value of m i e for m 0 it will represent the transient state the concept of general dispersion theory i e dispersion is directly proportional to the square of the velocity is considered for the assumption of dispersion and seepage velocity term batu 2006 now from eq 10a the mth term of the approximate solution for parent species is defined as 21a c 1 m x t χ m c 1 m 1 x t h 1 i 1 r 1 c 1 m 1 t d 0 β α x 2 ψ 2 mt 2 c 1 m 1 x 2 v 0 ψ mt 2 α d 0 ψ 2 mt β α x c 1 m 1 x k 1 α v 0 ψ mt c 1 m 1 similarly mth term of the approximate solution for daughter species by using eq 10b is defined as 21b c 2 m x t χ m c 2 m 1 x t h 2 i 1 r 2 c 2 m 1 t d 0 β α x 2 ψ 2 mt 2 c 2 m 1 x 2 v 0 ψ mt 2 α d 0 ψ 2 mt β α x c 2 m 1 x k 2 α v 0 ψ mt c 2 m 1 k 1 c 1 m 1 3 3 1 solution for parent species by using the formula for mth term of the approximate solution given by eq 21a the successive terms for the solution for parent species c 1 are derived as follows 22a c 1 0 x t a x exp b x 22b c 1 1 x t h 1 r 1 d 0 β α x 2 a b 2 b x exp b x 0 t ψ 2 m υ d υ v 0 0 t ψ m υ d υ 2 α d 0 0 t ψ 2 m υ d υ β α x a 1 b x exp b x k 1 t α v 0 0 t ψ m υ d υ ax exp b x 22c c 1 2 x t c 1 1 x t h 1 2 r 1 d 0 β α x 2 a b 2 b x exp b x 0 t ψ 2 m υ d υ v 0 0 t ψ m υ d υ 2 α d 0 0 t ψ 2 m υ d υ β α x a 1 b x exp b x k 1 t α v 0 0 t ψ m υ d υ ax exp b x h 1 2 r 1 2 d 0 2 β α x 4 a b 3 4 b x exp b x 0 t ψ 2 m υ 0 t ψ 2 m υ d υ d υ h 1 2 r 1 2 v 0 d 0 0 t ψ 2 m υ 0 t ψ m υ d υ ψ m υ 0 t ψ 2 m υ d υ d υ 8 α d 0 2 0 t ψ 2 m υ 0 t ψ 2 m υ d υ d υ β α x 3 a b 2 3 b x exp b x h 1 2 r 1 2 v 0 2 0 t ψ m υ 0 t ψ m υ d υ d υ 5 α v 0 d 0 0 t ψ m υ 0 t ψ 2 m υ d υ ψ 2 m υ 0 t ψ m υ d υ d υ k 1 d 0 0 t υ ψ 2 m υ 0 t ψ 2 m υ d υ d υ 14 α 2 d 0 2 0 t ψ 2 m υ 0 t ψ 2 m υ d υ d υ β α x 2 a b 2 b x exp b x h 1 2 r 1 2 k 1 v 0 0 t υ ψ m υ 0 t ψ m υ d υ d υ 2 α k 1 d 0 0 t υ ψ 2 m υ 0 t ψ 2 m υ d υ d υ 4 α 2 v 0 d 0 0 t ψ m υ 0 t ψ 2 m υ d υ ψ 2 m υ 0 t ψ m υ d υ d υ 3 α v 0 2 0 t ψ m υ 0 t ψ m υ d υ d υ 4 α 3 d 0 2 0 t ψ 2 m υ 0 t ψ 2 m υ d υ d υ β α x a 1 b x exp b x h 1 2 r 1 2 α 2 v 0 2 0 t ψ m υ 0 t ψ m υ d υ d υ α k 1 v 0 0 t υ ψ m υ 0 t ψ m υ d υ d υ k 1 2 t 2 2 ax exp b x 3 3 2 solution for daughter species by using the formula for mth term of the approximate solution given by eq 21b the successive terms for the solution for daughter species c 2 are derived as follows 23a c 2 0 x t 0 23b c 2 1 x t h 2 t r 2 k 1 ax exp b x 23c c 2 2 x t c 2 1 x t h 2 2 r 2 k 1 t ax exp b x h 2 2 r 2 2 k 1 d 0 β α x 2 a b 2 b x exp b x 0 t υ ψ 2 m υ d υ v 0 0 t υ ψ m υ d υ 2 α d 0 0 t υ ψ 2 m υ d υ β α x a 1 b x exp b x k 2 t 2 2 α v 0 0 t υ ψ m υ d υ ax exp b x h 1 h 2 r 1 r 2 k 1 d 0 β α x 2 a b 2 b x exp b x 0 t 0 t ψ 2 m υ d υ d υ v 0 0 t 0 t ψ m υ d υ d υ 2 α d 0 0 t 0 t ψ 2 m υ d υ d υ β α x a 1 b x exp b x k 1 t 2 2 α v 0 0 t 0 t ψ m υ d υ d υ ax exp b x 4 graphical results and discussion in this section the concentration distribution is graphically analysed for the derived series solutions by using homotopy analysis method ham for both the species in all three cases steady transport situation for steady groundwater flow transient transport situation for steady groundwater flow and transient transport situation for unsteady groundwater flow for the graphical illustration finite spatial and temporal domain i e 0 x cm 3000 and 0 t hr 40 are considered and also the following set of model parameters is adopted from the previously available literature simpson and ellery 2014 u 0 0 2 cm h r d 0 0 5 c m 2 h r k 1 0 05 h r k 2 0 01 h r a 2 b 0 0025 and the retardation factor values corresponding to both the species and the constants values responsible for spatial and temporal variation in transport parameters are assumed to be r 1 2 r 2 2 5 α 0 05 0 15 c m β 1 m 0 04 h r also for the prediction of variation over concentration strength distribution due to temporally varying dispersion and transport velocity term in two species migration system four different types of velocity profiles are taken into account i e the temporal functions ζ mt for case ii and ψ mt for case iii are considered to be a exponentially increasing exp mt b exponentially decreasing exp m t c linearly dependent mt λ and d asymptotically dependent 1 m t 1 m t as the solutions for the modelled two species problem for all three cases are derived by using ham where the convergency of the solutions are totally dependent on the prediction of suitable value of h 1 and h 2 the convergence control parameters which can be further adjusted and controlled by the h curves for both species liao 1992 1995 fig 1 presents the h curves for both the species which are drawn between h value and c tt x t at x t 0 1 for both concentration strengths c 1 x t and c 2 x t both the h 1 curve and h 2 curve have an horizontal line segment between 1 6 and 0 6 signifying the bounded range for values of h 1 and h 2 which confirms the convergency of the solutions for both species derived in case i in this case values are considered to be 0 1 and 0 2 for the convergence control parameters h 1 and h 2 respectively fig 2 provides the concentration strength distribution for both the species in case of different time domain t 0 20 40 hrs for steady transport in steady groundwater flow it is observed that the concentration strength for parent species c 1 decreases with increasing time up to certain distance and after a distance of x 2250 cm approx it changes its nature and become higher for larger temporal value while in case of daughter species c 2 the concentration pattern is quite different in nature it is higher for large temporal value at each point of the domain but for both the species the concentration strength increases with distance and attains its maximum concentration value and after reaching peak concentration strength it decreases with distance and reduces asymptotically to its minimum harmless concentration strength it is also observed that the concentration strength is zero at t 0 for c 2 x t because there is no production of daughter species from parent species at starting time the impact of spatial variation of model parameters over pollutant migration of both species in steady transport is depicted in fig 3 the concentration strength is analysed for fixed time domain t 40 hr and study is carried out for three different values of spatial parameter α 0 0 1 0 2 for the better visualization of significant impact of positionally dependent parameters over two species transport for α 0 the system represents the homogeneous medium as there will be no impact of position over model parameters similar type of dispersion and velocity profile are assumed in the previously available studies lunn et al 1996 quezada et al 2004 chen et al 2012a simpson and ellery 2014 and for α 0 1 and α 0 2 i e when the model parameters dependent over position system represents heterogeneous medium from fig 3 it is observed that the pollutant transport is significantly faster for α 0 i e for homogeneous medium as compare to α 0 1 and α 0 2 i e for heterogeneous medium in case of both the parent and daughter species this is due to the higher velocity at each of the spatial value in heterogeneous medium also the peak concentration strength is little higher for homogeneous medium as compare to heterogeneous medium for both the species due to the higher dispersion rate in the heterogeneous medium similar to fig 1f or case i fig 4 illustrates the h curves for both species to identify the bounded range for the values of h 1 and h 2 for the selection of their suitable values to ensure the convergency of the solution in case for transient transport in the steady groundwater flow the h curves are depicted for all four type of considered velocity profiles it is observed that the h curves for each type of velocity profile is quite different in nature but the horizontal lines responsible for suitable values of h 1 and h 2 are quite similar the range is observed to be 3 3 and for graphical description values of h 1 and h 2 are assumed to be 0 1 and 0 15 figs 5 and 6 exhibits the pollutant concentration distribution for transient transport phenomenon in steady groundwater flow for parent c 1 and daughter species c 2 respectively the impact of exponentially increasing exponentially decreasing linear and asymptotic type for transport parameters over pollutant transport is depicted it is observed that the concentration strength for both the species initially increases with the increasing position value and after attaining its peak value it changes its nature and start decreasing with position and attains its minimum harmless value in each case this observation is made for fixed temporal domain t 20 hr fig 7 presents the variation of concentration distribution profile for different time domain in case of both parent c 1 and daughter species c 2 for exponentially increasing type velocity pattern it is observed that under the considered model domain and migration parameters the concentration strength decreases with increasing time for parent species while for daughter species it increases with time also the peak concentration strength is observed to be higher for c 1 x t as compare to c 2 x t for any fixed temporal for example for a fixed time period t 20 hrs the peak concentration value for the parent species is observed to be 246 40 mg cm3 at spatial value x 410 cm while that for the daughter species is observed to be 43 30 mg cm3 at spatial value x 396 cm fig 8 presents the h curves for transient transport system in case of unsteady groundwater flow i e the phenomenon where the dispersion and velocity both are spatially temporally dependent h 1 and h 2 curves are analysed for all the four different type of considered temporal functions the suitable values of h 1 and h 2 are assumed to be 0 2 and 0 3 from the existing convergence range depicted as horizontal line in the h curves for the solution of both species the impact of all four types of time dependent parameters over concentration strength of c 1 x t and c 2 x t is observed in the figs 9 and 10 respectively it is depicted that there is no concentration strength for both the species at starting point i e at x 0 and with increasing position value the concentration strength increases and attains its maximum value and then decreases with distance for both the species also the concentration distribution is observed to be higher for linear velocity pattern and lower for exponentially increasing type of velocity pattern up to certain positional value and after that it completely changes its nature and become higher for exponentially increasing velocity pattern and lower for linear type of velocity pattern for both the concentration strength of c 1 x t and c 2 x t for c 1 x t it changes its nature after the distance x 1000 cm and for c 2 x t it changes its nature after the distance x 960 cm these observations are corresponding to fixed temporal value t 20 h fig 11 presents a comparative illustration of concentration distribution profile for different time t 10 20 30 h for both species in case of dispersion and velocity with exponential dependent functions over time at beginning the pollutant concentration increases with position within the domain x 500 cm for c 1 x t and c 2 x t both and thereafter the pollutant concentration for both species decreases with position and asymptotically approaches to zero concentration strength 5 validation of the solution 5 1 validation with the exact solution simpson and ellery 2014 in case of constant transport parameters for the validation of the solution the model is transformed for constant transport parameters i e constant dispersion coefficient and constant transport velocity also the two species pollutant migration system is considered with the assumption that concept of linear adsorption is incorporated only with parent species c 1 the governing equation for such migration system is modelled by setting d x t d 0 v x t v 0 and r 2 1 in eq 2a b described in section 2 1 thus we get 24a r 1 c 1 t d 0 2 c 1 x 2 v 0 c 1 x k 1 c 1 24b c 1 t d 0 2 c 1 x 2 v 0 c 1 x k 2 c 2 k 1 c 1 and initial and boundary condition for above system are considered similar to previously considered model given by eqs 3a b and 4 the above model is similar to the model presented by the study simpson and ellery 2014 which derived the exact solution of the two species system under similar assumption by using a different method based on laplace transform technique generating the power series solution of the system the ham solution of above two species system is obtained by setting α 0 β 1 and r 2 1 in the ham solution for steady transport phenomenon in steady groundwater flow discussed in the section 3 1 a comparison between derived ham solution and exact solution simpson and ellery 2014 for the concentration distribution pattern of both the species c 1 x t and c 2 x t is graphically depicted in the figs 12 and 13 for parent species c 1 concentration strength is validated for temporal domain t 0 20 40 hr and for daughter species c 2 concentration strength is validated for temporal domain t 0 10 20 hr the ham solution for both the species compares very well with the exact solution presented in the study simpson and ellery 2014 comparison between the numerical values of ham solution for concentration strength and the exact solution presented by simpson and ellery 2014 in case of constant transport parameter for parent and daughter species both are presented in tables 1 and 2 respectively 5 2 validation of ham solution for variable transport parameter cases for the authentication of derived ham solutions for all three variable dependent cases i e a steady migration system in steady flow domain b transient migration system in steady flow domain and c transient migration system in unsteady flow domain we have simulate the considered model in all cases by using matlab coding for the variational iteration method he 1997 1998a 1998b liu 2005 which is well established method for non linear systems and can provide the accurate solution to a rather wide class of nonlinear equations without linearization perturbation closure approximations or discretization methods generally occurs in massive numerical computation this method is a modified version of lagrange multiplier method inokuti et al 1978 which effectively provides the accurate solutions of non linear systems by using further approximations which converges to the exact solution of the system more rapidly it is generally based on the variational theory and general weighted residual method to simulate the problem first we formulate the correction functional he 1998b corresponding to our system of multispecies problem then identify the lagrange multiplier by using the variational theory finlayson 1972 he 1998b a comparison between derived solution by ham and solution obtained from variational iteration method vim is made for parent and daughter species both in all cases a good agreement is found between both the solution as depicted from figs 14 16 simulation is carried out for three different temporal values t 0 5 10 h for parent and daughter species both 6 application the theoretical structure for the considered model evolved from the consequences of the proposed study can be employed in the field of hydrology petroleum engineering geology environmental science and the fields related to waste radioactive decay also the derived solutions can be particularly advantageous to predict the dispersion of chemical pollutants and ionic species in the groundwater due to landfill leachate from various landfills and their nearby locations the variability of the parameters considered in the proposed study is helpful to predict the migration of reactive multispecies in the groundwater system as from the findings of various theoretical studies and field experiments it has been demonstrated that the recharge rate has an impact on pollutant distribution up to some significant extent and may partially describe the scale and time dependence of velocity and dispersion parameters sudicky 1986 dagan 1984 serrano 1992 batu 2006 singh and chatterjee 2016 sanskrityayn et al 2017 to depict the impact of variable dependent migration parameters over multispecies reactive migration system one example is considered based on nitrification chain migration problem n h 4 n o 2 n o 3 previously used by cho 1971 and guerrero et al 2009 as in our study the solution is presented for two species migration system by ham thus for graphical presentation of concentration variation n h 4 is treated as parent species c 1 x t of the system and n o 2 is assumed to be produced daughter species c 2 x t of the system in order to predict the concentration strength of both the species i e n h 4 and n o 2 under our considered model conditions the specific values of migration parameters are chosen as guerrero et al 2009 d 0 0 18 c m 2 h r u 0 1 cm h r k 1 0 01 h r k 2 0 1 h r r 1 2 r 2 1 the nitrification chain migration for n h 4 and n o 2 is analysed corresponding to modelled system under the initial and boundary conditions eqs 3a b 4 with space and time dependent transport parameters the numerical values for all the parameters responsible for spatial and temporal dependence are considered same as used in section 4 the variation of concentration strength for both species for constant parameter case and for variable parameter case is graphically depicted in the fig 17 the study is carried out for fixed time t 10 hr and for variable dependent case the spatial and temporal functions both are considered to be linear result for both species is also validated by using the solutions derived by variational iteration method this study is also helpful for the anticipation of the movement of the reactive species and their distribution in case of unsteady flow of the groundwater in the unsaturated soil system and further capable to describe the dispersion process of reactive species in the heterogenous aquifers the presented model can also be used as an elementary tool for analysing the attenuation of reactive species and their migration process in the presence of variable transport parameters in multispecies system 7 summary and conclusion in this article the impact of variable dependent migration parameters over multispecies reactive transport system is effectively analysed the homotopy analysis method is employed to develop the semi analytical solutions of the modelled problem for numerical interpretation of the system two species problem is adopted with different retardation factor values for both the species along with first order decay rate coefficients also the concept of linear adsorption is incorporated with the considered system study is carried out for three different scenario of transport system a steady migration system in steady flow domain b transient migration system in steady flow domain and c transient migration system in unsteady flow domain which are capable to describe the natural physical processes happening in the groundwater flow system for multispecies reactive transport phenomenon to justify the impact of spatially varying transport parameters the dispersion coefficient and the migration velocity term are considered with linear space dependent function and that for temporal variation four different type of functions exponentially increasing exponentially decreasing linear and asymptotically dependent are adopted as per author s knowledge for multispecies reactive transport system no other solution is in existence till now for both spatially and temporally dependent transport parameters results have been previously analysed either for constant parameters or only for space dependent parameters or only for time dependent parameters but not for both because of the complexity of the modelled system also in this study solutions are derived for general time dependent functions the key points of this study can be summarised as follows 1 the impact of variable dependent parameters over multispecies reactive system is graphically analysed and it is observed that the peak concentration strength is little higher for homogeneous medium as compare to that of heterogeneous medium for both the species due to the higher dispersion rate in the heterogeneous medium 2 the change in the value of concentration strength for both the species completely depends on the type of temporal dependence of the migration parameters a significant variation due to different type of temporal functions is graphically analysed for parent and daughter species both in the transient migration system 3 the homotopy analysis method is adopted to obtain the solution in all three cases the advantage of using ham is that ham is much stable and easy to use tool for nonlinear system and does not require small parameters to handle the solution of the system 4 ham is also capable to overcome the limitations of different types of decomposition and transformation methods related to complex modelled system of the problem and their complicated numerical procedure of solving the problem and also removes the issue regarding convergency of the solutions the ham contains the convergence control parameter which provides the user with an easier way to control and adjust the convergence region for the solution 5 the derived solution by ham is compared by previously available exact solution of same model in case of constant transport parameters based on an alternative method of laplace transform method simpson and ellery 2014 and the validation is also carried out for all the variable dependent cases by using variational iteration method he 1997 1998a 1998b liu 2005 in all cases a good agreement is found between both the solutions for parent and daughter species both 6 an application based on nitrification chain migration system is analysed corresponding to our considered model to authenticate the impact of variable dependent transport parameters over constant transport parameters case the proposed series solution of multispecies reactive system can confer a remarkable significance for the relative analysis regarding the impact of variable dependent migration parameter over multispecies reactive system and also used as the benchmark solution for the validation of numerical and theoretical studies on multispecies problems credit authorship contribution statement manish chaudhary conceptualization methodology writing original draft investigation validation formal analysis mritunjay kumar singh supervision writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the authors are thankful to the editor and anonymous reviewers for their valuable comments which contributed to the improvement in the presentation of the paper authors would also like to acknowledge iit ism dhanbad for supporting this work through jrf scheme this work is also partially supported by dst serb under the project no emr 2016 001628 
