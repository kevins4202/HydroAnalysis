index,text
30,the classical two dimensional dam problem was solved analytically and independently by davison in 1932 and hamel in 1934 and involved double integrals in 1938 polubarinova kochina produced solutions involving single integrals and in 1940 showed that the davison hamel solutions could be reduced to ones obtained by her method missing from the conversion was a linkage between scale constants which is given in this paper initial calculations by these authors were difficult because of evaluations of elliptic integrals and numerical quadratures as a free boundary problem it is now a test case for a multitude of numerical methods surveying analytical and numerical approaches it is found that both are limited in accuracies and are overwhelmingly concerned with the location of the free boundary and its seepage point analytical expressions are here given for the gradients near the three critical points of free boundary entry and exit and the intersection of seepage face and tailwater new numerical results to six decimal places are given for tables and contours on and within the dam boundary for potential and stream functions and orthogonal potential gradients keywords groundwater free boundary dam problem polubarinova kochina elliptic integrals numerical methods data availability no data was used for the research described in the article 1 introduction in many groundwater situations the saturated surface is free to move this makes quantitative predictions difficult when subsurface behaviour is to be modelled analysed and numerically evaluated with the advent of digital computers there has been many applications of numerical methods for mathematical models of such problems with these methods comes the necessity of verification of solution accuracy the standard way of doing this is to compare with analytic solutions to problems when they are available one such case is the classical dam problem with known analytical solutions and the many publications of numerical models attempting to solve it the overall observation from these publications is that complete numerical values are not provided in both analytical solution evaluation and numerical methods and the accuracies of parts of the complete solution where presented are satisfactory for analytical evaluations but not so for numerical methods in consequence a major aim of this paper is to rectify this situation and provide benchmark numerical values from analytical solutions for future applications of numerical methods the classical dam problem mathematically represents a two dimensional 2d body as depicted in fig 1 with impermeable base free top boundary and vertical sides of entry headwater and exit seepage face and tailwater the material is a homogeneous isotropic porous medium obeying darcy s law the defining differential equation is laplace s equation for potential ϕ and boundary conditions given required to be found are the position of the free boundary and values within and on the boundary for ϕ its derivatives in two orthogonal directions and the stream function ψ linked to ϕ through the cauchy riemann equations secondary quantities are pore pressure and total flow across dam vertical sections the time period of this work starts from the analytical solutions and some numerical evaluations in the 1930s and continues to the present day with numerical methods the first solution to this problem in very compact form was given in 1932 by davison 1932 1936 in 1934 an independent solution of the same kind in much more detail was given by hamel 1934 both of these solutions involved double integrals containing complete elliptic integrals in the following year the first calculations were given by hamel and günther 1935 for approximations within two to three significant figures for one particular geometry configuration of side lengths h l h respectively headwater height base length tailwater height as in fig 1 before publication this work was sent to muskat who solved the same problem as well as five other geometries three of which had zero h values muskat 1935 according to emikh 2015 kochin the husband of polubarinova kochina pk henceforth reviewed a monograph khristianovich et al 1938 containing a section by davison and indicated to pk that a simpler solution might be found by application of the theory of differential equations this she did with her 1938 paper showing that solutions can be given in terms of single integrals still involving complete elliptic integrals pk 1938 in 1940 pk published a very important paper pk 1940 which showed how the davison hamel solutions can be analytically transformed into her solutions in that paper she also did calculations with her method comparing results with those of hamel and günther but not of muskat this russian paper appears not to have been appreciated none of the extensive list of papers referenced below nor any citations of it have been observed by the writer except for a very recent paper by liu eta al 2022 in section 4 a new numerical conversion between the methods is given something that pk apparently missed details of both methods of solution are given in crank 1984 pk s work appears in her book of 1952 translated into english in 1962 pk 1962 and further references in section 5 by 1980 crank and ozis 1980 commented that the classical dam problem was already over studied to the present time the problem now has been very well studied as evidenced by fig 2 which shows a cumulative number of publications with time of just numerical methods for the dam problem with tailwater nevertheless an important observation by cryer 1976 was the following the evaluation of the solutions of hamel and polubarinova kochina is a difficult task by hand but relatively simple on a computer it is therefore unfortunate that this work has been overlooked and that many authors have computed numerical solutions for the model problem without comparing their results with the exact solutions this situation mostly prevails today with a small percentage of publications providing seepage point values and analytical solution comparisons for a range of values of h l h particularly the work of hornung and krueger 1985 rarely being used it is important to note that the classical dam problem is not modelling a real dam headwater and tailwater sides are never vertical heterogeneity is always present and there is always an unsaturated region above the free boundary line at the top of the saturated region mavroulidou et al 2006 makes it quite clear in the case of a dam with trapezoidal cross section that the free boundary line in the variably saturated case is quite different to that of the fully saturated case which also will be true for a rectangular dam and excised portion of it which is fully saturated and representing the classical dam often rectangular dam is used incorrectly to describe the classical case which is a purely mathematical model although the classical problem is not realism it is expected to show the major seepage flow features that do occur but do any of the large number of listed references 1 1 the collection of references were obtained from the citations of each relevant article and its review of literature and reference list a laborious process moving forward and backward in publication date done many times this also included the same process for searches on references not listed here on topics of free surfaces heterogeneity inclusion of unsaturation no tailwater non rectangular dams and approximate dam solutions possibly some valuable articles have been missed represented in fig 2 with more than a dozen different geometries h l h make or recommend specific use of the classic results for other dam problems despite many introductions in these papers stating the importance of dam seepage analysis no linkage has been found to their calculations of the classic case this situation emphasises that the classic dam problem is a mathematical one and the specific values of h l h used are not important accurate solutions for any one geometry will have the same general patterns of solutions as any other this is even true of the critical points a b and e of fig 1 where the analyses in section 3 show that gradients are determined by logarithmic terms of ϕ x with x the horizontal coordinate as in fig 1 in the cited papers no reason is given for selecting a particular h l h other than referring to that chosen by previous authors because of this a choice has been made of 1 2 3 1 6 only to present new sets of tabulated and contour values this geometry is also the one most commonly chosen in the references is the first example of any numerical method calculations achieved by shaw and southwell 1941 using finite differences with the hand calculated relaxation method whose rare internal grid values are also reproduced by pk 1962 and whose accurate free boundary position has been made by elliott and ockendon 1982 the substance of the paper which now follows consists of problem definition analytical solutions including new analysis at critical points of headwater entry seepage point and intersection of seepage face and tailwater the new numerical connection of original analytical solutions of davison 1932 hamel 1934 and pk pk 1938 1940 survey of numerical methods based on differing geometries and accuracy of seepage point locations and benchmark results to six decimal places 2 the pk analytical solutions the analytical solutions are based on chapter 7 of the book of pk originally written in russian in 1952 and translated into english in 1962 pk 1962 a later version pk 1977 only in russian had minor rearrangements and some typographic corrections of this chapter but introduced new errors most of the geometrical lettering and mathematical symbols used here are those of pk the solutions will be stated in section 2 3 the details leading to the solutions may be found in pk 1938 pk 1962 crank 1984 and ridolfi 1995 but are omitted here because of the emphasis on numerical evaluations an essential part of the solutions is in mapping of the real plane of the dam to a complex plane and expressing three important parameters α β c of this plane in terms of the real geometry h l h most of the work done in numerical evaluations is in the complex plane although it may be natural to assign values of h l h finding α β c is an inverse and iterative process unsurprisingly pk chose the reverse process of assigning α β c and finding h l h directly this inevitably meant that with simple choices such as α 0 1 β 0 2 c 1 then h l h are not integer quantities this is the same general process adopted by hamel and günther 1935 and muskat 1935 in evaluating the davison hamel equations mentioned in the introduction pk s presentation of equations is directed towards boundary evaluations and mostly ignores the dam interior here pk s equations are presented for boundary and interior and geared towards natural assignments of h l h 2 1 statement of the problem the geometry of the problem is shown in fig 1 coordinate axes x and y originate at c the free boundary is ab with seepage point at a side bc of length h is entry headwater impermeable base cd is of length l side de of length h is exit tailwater and ea of length h 0 is the seepage face an additional length is useful to define as hs h h 0 height of seepage face above the base to be found is the position of the free boundary which includes h 0 in terms of a potential function or piezometric head ϕ once h l h have been assigned either directly or by defining α β c then determine values of ϕ ψ ϕ x ϕ y within the interior ω and on the boundary wherever they have not been already defined ψ is the stream function defined by the cauchy riemann equations 1 ϕ x ψ y ϕ y ψ x the extended 2d darcy s laws are 2 q x u x n u k ϕ x q y v y n v k ϕ y where qx qy ux v y are respective flow rates and average velocities in directions x and y and u v the pk velocities n and k are respective porosity and hydraulic conductivity with constant values pk uses the velocity potential symbol φ kϕ and the accompanying ψ pk kψ the preceding equations with the continuity equation u x v y 0 produce laplace s equations 3 2 ϕ 2 ϕ x 2 2 ϕ y 2 0 and 2 ψ 2 ψ x 2 2 ψ y 2 0 the boundary conditions for ϕ are 4 along the free boundary ab ϕ y and ϕ n 0 5 along headwater side bc ϕ h 6 along base cd ϕ y 0 7 along tailwater side de ϕ h 8 along seepage face ae ϕ y where n is the normal direction to the free boundary forming an angle ν relative to the x axis an additional quantity of interest is scaled pressure or pressure head p p ρ g p pressure ρ density within the permeable and homogeneous material of the dam and g gravity acceleration related to ϕ by 9 p ϕ y the free boundary boundary condition ϕ n 0 is that used in numerical methods pk uses instead the condition u 2 v 2 kv 0 ϕ x 2 ϕ y 2 ϕ y to show this equivalence assume ϕ n 0 then ϕ y cosν ϕ s ϕ x sinν ϕ s which when substituted in the pk condition produces ϕ s cos ν but cos ν δy δs δs 0 δϕ δs δs 0 ϕ s as required having used ϕ y on the free boundary 2 2 analytical solutions the solution to the problem by pk in her book pk 1962 consists of three general expressions in terms of the complex variable z x iy in the plane of the dam and the mapped complex variable ζ ξ i η in its upper half plane corresponding to that of the ξ η plane of fig 3 b these three equations are as follows a mapping relationship 10 d z d ζ z ζ a k ζ i k 1 ζ 1 ζ a ζ b ζ a relation for ϕ and ψ in θ ϕ i ψ 11 d θ d ζ f ζ a k 1 ζ 1 ζ a ζ b ζ and expressions for ϕ x and ϕ y 12 u k i v k ϕ x i ϕ y k 1 ζ k ζ i k 1 ζ k ζ is the complete elliptic integral of the first kind defined for complex argument ζ by 13 k ζ 0 π 2 1 1 ζ sin 2 t d t and by association a similar expression for k 1 ζ pk 1962 uses f ζ k f ζ in eq 11 the boundary conditions on ab are automatically satisfied for ϕ n u 2 v 2 k v 0 it follows immediately from eq 12 for the other condition eqs 10 and 11 produce y ξ ϕ ξ which integrates to y ϕ as required the constants a a b need to be determined by the geometry h l h or conversely be assigned to produce a specific geometry the appropriate equations will be given further on but first there are some useful transformation identities among the elliptic integrals 14 k ζ i k 1 ζ 1 ζ k 1 ζ i 1 ζ k 1 1 ζ 15 k 1 ζ 1 ζ k 1 1 ζ 1 1 ζ k 1 1 ζ i k 1 1 1 ζ for non russian textbooks up to 1970 fettis 1970 showed that the i in the first of eqs 14 had been given as the incorrect i the most important source being the compendium of erdélyi et al 1953 to obtain expressions for z and θ eqs 10 and 11 need to be integrated 16 z z 0 ζ 0 ζ z ζ d ζ 17 θ θ 0 ζ 0 ζ f ζ d ζ before making these integrals more specific with values of z z 0 ζ ζ0 it is useful to examine contoured figures which show the dam and its interior of the real plane in fig 3 a and its mapping to the real coordinate version of the complex plane given in fig 3 b 2 3 regional coordinate contours fig 3 a is the five segment boundary of fig 1 with contours of constant values of the complex coordinates ξ and η drawn upon it the associated fig 3 b shows corresponding points a b c d e at along the line η 0 with the interior of the dam corresponding to η 0 and constant value contours for x and y fig 3 a happens to be the geometry 1 2 3 1 6 as part of the new numerical results of this paper but is typical of any geometry h l h the calculations for these curves are based on eq 16 and eq 10 for z ζ with z 0 l i hs ζ0 0 i 0 for points a further details will be given in section 7 because the complex half plane function z ζ is analytic integration between any two points is path independent and to suit numerical integrations the path can consist of one or more steps of straight lines aligned with the ξ and iη axes but because of analyticity this translates to the same integrations in the real ξ η plane as an example to pass from the origin at a in the ξ η plane to a point q a two linear segments path is a 0 0 to p η1 0 then p to q η1 ξ1 the corresponding path in the real x y plane is nonlinear by this means any point within ω can be reached also any point r on the dam boundary can be reached with a corresponding straight line segment in the ξ η plane with constant ξ ξ2 from q to r ξ2 0 more efficient ways of relating points on the boundaries of the two planes can be made with other choices of z z 0 ζ ζ0 in eq 16 this is the substance of pk s focus and presented in the next section as far as the author is aware no results have been previously published to enable the drawing of the equivalents of figs 3 a and 3 b 2 4 boundary length equations pk s use of the transformation identities applied to z ζ was to make series expressions for elliptic integrals easier to handle for different ranges of ξ on the mapped boundary segments the second step of using trigonometric changes to the integration variable alleviated problems with the original square root functions in the denominators of the integrals these changes are adopted here the same kind of changes will also be made for the θ eq 17 in the next section expressions for coordinates and lengths of the five boundary segments are given now followed by the requirements for solving the unknown parameters which appear the substitutions as a result of the trigonometric variable changes produce 18 α 1 b β 1 a 0 α β 1 c 2 a a b along ab 0 ξ 1 θ 1 sin 1 ξ 19 x l a 0 ξ k ξ 1 ξ a ξ b ξ d ξ l c 0 θ 1 k sin 2 θ sin θ 1 α sin 2 θ 1 β sin 2 θ d θ 20 l a 0 1 k ξ 1 ξ a ξ b ξ d ξ c 0 π 2 k sin 2 θ sin θ 1 α sin 2 θ 1 β sin 2 θ d θ 21 y h s a 0 ξ k 1 ξ 1 ξ a ξ b ξ d ξ h s c 0 θ 1 k cos 2 θ sin θ 1 α sin 2 θ 1 β sin 2 θ d θ 22 h h s a 0 1 k 1 ξ 1 ξ a ξ b ξ d ξ h s c 0 π 2 k cos 2 θ sin θ 1 α sin 2 θ 1 β sin 2 θ d θ along bc 1 ξ a θ 1 sin 1 1 ξ β 1 β 23 y h a 1 ξ k 1 ξ ξ ξ 1 a ξ b ξ d ξ h c θ 1 π 2 k β 1 β sin 2 θ β α 1 β sin 2 θ d θ 24 h a 1 a k 1 ξ ξ ξ 1 a ξ b ξ d ξ c 0 π 2 k β 1 β sin 2 θ β α 1 β sin 2 θ d θ along cd a ξ b θ 1 sin 1 1 ξ α β α 25 x a a ξ k 1 ξ ξ ξ 1 ξ a b ξ d ξ c θ 1 π 2 k α β α sin 2 θ 1 α β α sin 2 θ d θ 26 l a a b k 1 ξ ξ ξ 1 ξ a b ξ d ξ c 0 π 2 k α β α sin 2 θ 1 α β α sin 2 θ d θ along de b ξ θ 1 sin 1 1 α ξ 27 y a ξ k 1 ξ ξ ξ 1 ξ a ξ b d ξ c α θ 1 π 2 k α sin 2 θ sin θ 1 α sin 2 θ β α sin 2 θ d θ 28 h a b k 1 ξ ξ ξ 1 ξ a ξ b d ξ c α 0 π 2 k α sin 2 θ sin θ 1 α sin 2 θ β α sin 2 θ d θ along ea ξ 0 θ 1 cos 1 1 1 ξ 29 y h a ξ k 1 1 ξ 1 ξ b ξ a ξ d ξ h c θ 1 π 2 k cos 2 θ sin θ cos θ 1 1 α sin 2 θ 1 1 β sin 2 θ d θ 30 h 0 a 0 k 1 1 ξ 1 ξ b ξ a ξ d ξ c 0 π 2 k cos 2 θ sin θ cos θ 1 1 α sin 2 θ 1 1 β sin 2 θ d θ h s h h 0 a symbolic summary of the preceding equations for side lengths involving c is 31 ab l c j l 1 α β 32 h c j h 1 α β c j h α β c j h 0 α β 33 bc h c j h 2 α β 34 cd l c j l 2 α β 35 de h c j h α β 36 ea h 0 c j h 0 α β where j are defined by associations with the right sides of eqs 19 30 essentially there are six unknowns α β c and h l h the expression for h 0 can be substituted into eq 32 with two equivalent choices for h and two for l which reduce to three equations for h l and h by selecting the j h2 and j l2 equations and eliminating c from three pairings of the equations there is the ratios relationship 37 h l h j h 2 j l 2 j h in order to solve these three equations it is necessary to prescribe three of the unknowns the two obvious choices are to prescribe h l h and determine indirectly α β c or conversely to prescribe α β c and determine directly h l h once all parameters are known then h 0 follows from eq 36 in the first choice α and β are solved from a pair of equations which have eliminated c such as l h j l 2 j h 2 and h h j h j h 2 and then c is found from any one of the original three equations in the second choice α and β are prescribed to produce directly h c l c h c in this case choosing any c does not affect the ratios equation and led to the statement by pk in her books pk 1962 1977 that c is arbitrary and can be assigned the value of unity unfortunately for the reader she does not state that α and β must be selected first for this to be true the same confusion exists in pk and falkovich 1951 where c does not appear at all pk s calculated results in pk 1962 1977 involve side ratios but actual side values are not given it is not necessary to make either of the previous choices any three of the six parameters may be prescribed an example of this is pk s choice of prescribing l α β in pk 1940 see section 4 2 5 equations for ϕ ψ and flow rates eq 17 for θ θ0 in more detail is 38 ϕ ϕ 0 i ψ ψ 0 a ζ 0 ζ k 1 ζ 1 ζ a ζ b ζ d ζ the stream function is set at ψ 0 along the base cd values of ϕ0 and ζ0 are dependent on the origins selected for regional values the origin for ζ is set at point a with ζ0 0 and the corresponding ϕ0 hs and ψ0 ψ b the complex integrations are performed along linear segments as in the previous section for boundary integrations with η 0 ζ ξ existing boundary eqs 4 8 imply that expressions for ψ are needed for sides cd de and ae only and for ϕ just the side cd the free boundary ab is a streamline and its stream function is deduced below from expressions of charny 1951 and a vertical section flowrate from eqs 17 and 11 and transformation identities eq 15 there are for ψ along bc 1 ξ a θ 1 sin 1 1 ξ β 1 β 39 ψ ψ b a 1 ξ k 1 1 ξ ξ ξ 1 ξ a ξ b d ξ ψ b c θ 1 π 2 k 1 β cos 2 θ β α 1 β sin 2 θ d θ 40 q h a 1 a k 1 1 ξ ξ ξ 1 ξ a ξ b d ξ c 0 π 2 k 1 β cos 2 θ β α 1 β sin 2 θ d θ along de b ξ θ 1 sin 1 1 α ξ 41 ψ a ξ k 1 1 ξ ξ ξ 1 ξ a ξ b d ξ c α θ 1 π 2 k 1 α sin 2 θ sin θ 1 α sin 2 θ β α sin 2 θ d θ 42 q h a b k 1 1 ξ ξ ξ 1 ξ a ξ b d ξ c α 0 π 2 k 1 α sin 2 θ sin θ 1 α sin 2 θ β α sin 2 θ d θ along ea ξ 0 θ 1 cos 1 1 1 ξ ψ ψ e a ξ k 1 1 1 ξ 1 ξ b ξ a ξ d ξ 43 ψ e c θ 1 π 2 k sin 2 θ sin θ cos θ 1 1 α sin 2 θ 1 1 β sin 2 θ d θ 44 q h 0 a 0 k 1 1 ξ 1 ξ b ξ a ξ d ξ c 0 π 2 k cos 2 θ sin θ cos θ 1 1 α sin 2 θ 1 1 β sin 2 θ d θ and for ϕ along cd a ξ b θ 1 sin 1 1 ξ α β α 45 ϕ h a a ξ k 1 1 ξ ξ ξ 1 ξ a b ξ d ξ h c θ 1 π 2 k 1 α β α sin 2 θ 1 α β α sin 2 θ d θ the vertical section flow rate quantities q above are derived from integration of the point flow rate q x k of eq 2 involving gradients ϕ x which are negative e g along the free boundary ϕ declines monotonically in the x direction from h to h 46 q y 1 y 2 y 1 y 2 q x k ϕ x ψ y d y ψ y 2 ψ y 1 these become q h ψ b along bc q h ψ e along de and q h 0 ψ b ψ e along ea so that q h q h q h 0 alternatively setting ξ 0 in eq 43 the left side becomes ψ b enabling ψ e to be calculated numerically the value of ψ ψ b for the free boundary is obtained from the simple result of charny 1951 derived in pk 1962 47 q h h 2 h 2 2 l and so ψ b h 2 h 2 2 l this means that from eq 40 there is the identity 48 h 2 h 2 2 l c 0 π 2 k 1 β cos 2 θ β α 1 β sin 2 θ d θ which is remarkable given that α β c are involved in nonlinear equations for h l h an alternative identity results by substituting in this equation integral expressions for h l h given in section 2 4 2 6 boundary expressions for ϕ x and ϕ y starting from eq 12 for u i v k the transformation identities eqs 14 and 15 in the limiting case of ζ ξ η 0 provide the following boundary expressions along ab 0 ξ 1 49 ϕ x k ξ k 1 ξ k 2 ξ k 2 1 ξ ϕ y k 2 1 ξ k 2 ξ k 2 1 ξ along bc cd de ξ 1 ϕ y 0 and 50 ϕ x k 1 1 ξ k 1 ξ along ae ξ 0 ϕ y 1 and 51 ϕ x k 1 1 1 ξ k 1 ξ 3 gradients near points a b and e near points a b and e steep gradients occur which are all driven by logarithmic behaviours of ϕ x analytical approximations are made in this section along the dam sides near the corner points a and b with the split ae and de near point e in all six approximations numerical evaluations are performed in section 7 key to these approximations are the expansions of the elliptic integral k z for real argument z 0 z 1 k z as z 0 is 52 k z π 2 1 z 4 9 64 z 2 and as z 1 an infinite value for k z 53 k z 1 2 1 1 4 1 z 9 64 1 z 2 log 16 1 z 1 4 1 z 1 21 32 1 z both expansions may be found in wolfram 2022 3 1 on the free boundary ab along the free boundary ab the appropriate expressions for d x d ξ d y d ξ and d y d x follow from eq 10 as 54 d x d ξ a k ξ 1 ξ a ξ b ξ 55 d y d ξ a k 1 ξ 1 ξ a ξ b ξ 56 d y d x k 1 ξ k ξ 3 1 1 point a near point a assume that x is given an estimate is then found for ξ from which estimates are found for y and d y d x from 54 with small ξ 57 d x d ξ a π 2 1 1 4 ξ a b 1 f a ξ o ξ 2 f a 1 2 1 α β so that 58 d x d ξ c π 4 1 g a ξ o ξ 2 g a f a 1 4 which integrates to 59 x 1 c π 4 ξ 1 1 2 g a ξ o ξ 2 with x 1 l x an inversion of 59 provides an approximation for ξ in terms of x 1 60 ξ 4 x 1 c π 1 g a 2 4 x 1 c π expression 55 for d y d ξ in terms of ξ becomes 61 d y d ξ c 4 1 1 4 ξ log 16 ξ 1 2 ξ 1 f a ξ o ξ 2 which integrates to the approximation 62 y 1 c 4 ξ 1 1 2 g a ξ log 16 ξ ξ 1 1 g a ξ 4 with y 1 y hs for the gradient of eq 56 63 d y d x 1 π 1 1 4 ξ 9 64 ξ 2 log 16 ξ 1 2 ξ 1 21 32 ξ 1 1 4 ξ 9 64 ξ 2 which simplifies to 64 d y d x 1 π log 16 ξ 1 2 ξ 1 13 32 ξ from eqs 49 expressions for ϕ x and ϕ y become 65 ϕ x k ξ k 1 ξ k 2 ξ k 2 1 ξ d y d x 1 d y d x 2 1 d y d x 0 ξ 0 66 ϕ y k 2 1 ξ k 2 ξ k 2 1 ξ d y d x 2 1 d y d x 2 1 ξ 0 if need be expressions of y and d y d x in terms of x can be found by substitutions with ξ in particular rougher approximations can be made by eliminating all α and β to coincide with the existing expression given by aitchison 1972 and independently by kochina and kochina 1988 and keady et al 1988 from 67 y 1 x 1 π log x 1 and by differentiation 68 d y d x 1 π 1 log x 1 these expressions are then available to any numerical method independent of the h l h geometry adopted 3 1 2 point b near point b in contrast to analysis near point a the most straightforward approach is to assume that y is given then from it an estimate of ξ is made followed by estimates of x and d x d y in terms of ξ first define the quantity ξ 1 ξ which is small as ξ 1 the square root term in the above equations can then be approximated by 69 1 ξ a ξ b ξ a b 1 α 1 β ξ 1 f b ξ where 70 f b 1 2 α 1 α β 1 β with this approximation and a small argument expansion for k ξ then eq 55 provides d y d ξ a π 2 a b 1 α 1 β 1 1 4 ξ ξ 1 f b ξ o ξ 5 2 71 π c 2 1 2 ξ 1 g b ξ o ξ 3 2 with 72 g b 1 4 f b and c 2 c 2 1 α 1 β integration of d y d ξ then gives 73 y 1 π c 2 ξ 1 1 3 g b ξ o ξ 5 2 y 1 h y with inversion to ξ there is the approximation 74 ξ y 1 π c 2 1 3 y 1 π c 2 3 turning to an expression for x in terms of ξ d x d ξ of eq 54 becomes 75 d x d ξ c 2 1 2 ξ 1 1 4 ξ log 16 ξ 1 2 ξ 1 f b ξ o ξ 5 2 leading to an approximation for x in terms of ξ 76 x c 2 ξ 1 1 3 g b ξ log 16 ξ 2 1 4 g b 3 36 ξ finally from eq 56 77 d x d y 1 π 1 1 4 ξ 1 1 4 ξ log 16 ξ 1 2 ξ o ξ 2 produces the approximation 78 d x d y 1 π log 16 ξ 1 2 ξ 1 1 4 ξ this term is negative near point b as expected from the free boundary shape from eqs 49 approximations for ϕ x and ϕ y are now 79 ϕ x 0 and ϕ y 0 ξ 1 3 2 point e for point e the ξ η plane of fig 3 b shows that it necessary to consider the two segments de and ae separately to analyse the behaviours of ϕ x on each segment both at x l 3 2 1 boundary segment de for segment de with ξ 80 d y d ξ a k 1 ξ ξ ξ 1 ξ a ξ b and 81 u k ϕ x k 1 1 ξ k 1 ξ from the first expression an approximation of 1 ξ in terms of y is to be found which is then inserted into a series expansion of ϕ x in terms of 1 ξ with similar treatment to that for points a and b 82 d y d ξ a π 2 1 ξ 2 g 1 ξ 3 o 1 ξ 4 g 1 3 4 1 2 a b which integrates to 83 y 1 a π 2 1 ξ 1 g 1 2 1 ξ o 1 ξ 3 y 1 h y and inversion approximation 84 1 ξ 2 y 1 a π 1 g 1 y 1 a π an expansion of 81 then gives the approximation 85 ϕ x 1 π log 16 ξ 1 2 π ξ 1 13 32 ξ which is then a function of a given y and can be used just below e 3 2 2 boundary segment ae for the segment ae with ξ 86 d y d ξ a k 1 1 ξ 1 ξ ξ a ξ b 87 u k ϕ x k 1 1 1 ξ k 1 1 ξ it is convenient to introduce ξ ξ and 1 ξ 1 ξ ξ1 with expansions in terms of 1 ξ 1 then 88 d y d ξ d y d ξ 1 a π 2 1 ξ 1 2 g 2 ξ 1 3 o 1 ξ 1 4 g 2 5 4 1 2 a b which integrates to 89 y 1 a π 2 1 ξ 1 g 2 2 ξ 1 2 o 1 ξ 1 3 y 1 y h and inversion approximation 90 1 ξ 1 2 y 1 a π 1 g 2 y 1 a π the approximation to ϕ x takes the same form as eq 85 91 ϕ x 1 π log 16 ξ 1 1 2 π ξ 1 1 13 32 ξ 1 then given y which provides ξ1 by eq 90 this expression can be used to approximate ϕ x just above e a rough approximation for either section de or ae independent of specific geometry involving a and b and following from the preceding equations is 92 ϕ x 1 π log h y this is a result found by liggett 1977 3 3 point b on side bc for ξ 1 near point b along side bc eq 10 with transfomations eq 14 provides 93 d y d ξ a k 1 ξ ξ ξ 1 a ξ b ξ defining ξ ξ 1 and proceeding in the normal way with series expansions followed by integration 94 h y a a 1 b 1 ξ 1 1 3 g 3 ξ log 16 ξ 1 18 3 4 g 3 ξ 3 2 with 95 g 3 5 4 1 a 1 1 b 1 there is no simple way of mathematically inverting this expression 94 to obtain ξ as a function of a given y but it is not difficult to do numerically from eq 50 the expression 96 ϕ x k 1 1 ξ k 1 ξ yields the approximation in terms of ξ 97 ϕ x π log 16 ξ 1 2 ξ 1 13 32 ξ 3 4 point a on boundary segment ae near point a on segment ae with ξ negative and ξ 0 eq 10 with transformations eq 14 provides 98 d y d ξ a k 1 1 ξ 1 ξ a ξ b ξ with definition ε ξ series expansions followed by integration produces the approximation 99 h y 1 4 c ε 1 1 2 g 4 ε log 16 ε 1 4 1 g 4 ε 2 with 100 g 4 3 4 1 2 1 a 1 b again eq 99 is not simple to invert mathematically but is so numerically to find ε for a given y the expression of eq 51 101 ϕ x k ξ 1 ξ k 1 1 ξ when expanded in terms of a series in ε becomes 102 ϕ x π log 16 ε 1 2 ε 1 13 32 ε 4 connecting the two analytical methods in her 1940 paper pk 1940 showed how the analytical solutions presented by davison 1932 and hamel 1934 could be transformed into her solutions this connection between the two solutions appears to be unknown in the non russian literature for example boast 1977 was evaluating hamel s solutions and towards the end of extensive supplementary information commented on the difference between hamel s solutions and pk 1962 solutions writing whether the discrepancy is due to in effect a great simplification in equations of hamel which has been made by polubarinova kochina and is due to an error in one or another treatment was not investigated nine years later boast 1986 reinforced this remark two analytical solutions are available for a dam with both faces vertical in one an elliptic function is used to transform the boundary of the flow medium into the hodograph plane to a straight line boast 1977 especially appendix a an apparently equivalent solution is much simpler in form polubarinova kochina 1962 there is also another closely related situation of seawater intrusion whose model can be formed by a simple transformation of the classical dam with no tailwater there is the work of henry 1959 1964 in the vein of hamel s work and more recently following pk 1962 the work of kacimov and obnosov 2016 which makes no mention of henry s work to the writer s knowledge there has been no further commentary on the differences and resolution of the two approaches when the tailwater exists both solutions use the same α β or b a but have different scaling constants to complete the connection between the two methods it is important to find the explicit connection between these constants here it shown how to do this something which pk did not demonstrate the main purpose of this exercise is to determine accurate solutions of the problem initiated by hamel and günther 1935 extended by muskat 1935 1937 and also done by pk 1940 where α 0 1 β 0 2 i e b 10 a 5 and the scaling parameter d 1 with results h l h 0 322 0 162 0 084 given by muskat with this connection between the two methods of solution and common usage of a and b the simpler method of pk can then be used for calculations the hamel expression for the base length l is given by 103 l d a b λ 1 λ λ a b λ e λ d μ k d λ d λ where 104 e λ e 3 2 π 0 1 γ s s λ d s γ s 2 arctan k 1 s k s μ k k 1 1 1 λ k 1 1 λ expressions for other side lengths of the dam and x and y coordinates take the same double integral form but with differing limits and all with d outside the integration davison 1932 1936 hamel 1935 muskat 1935 1937 crank 1984 in contrast to eq 103 there is the much simpler expression of pk eq 36 105 l a a b 1 ξ ξ 1 ξ a b ξ k 1 ξ d ξ the aim is to find a relationship between d and c 2 a a b now with the notation k k z and k k 1 z the differential equation for k wolfram 2022 is 106 z 1 z d 2 k d z 2 1 2 z d k d z 1 4 k 0 and the same equation for k replacing k a connection for the two solutions is the wronskian wolfram 2022 107 k d k d z k d k d z π 4 z 1 z which provides 108 d d z k k 1 k 2 k d k d z k d k d z π 4 z 1 z k 2 with this identity and the transformations 14 and 15 109 d d λ k 1 1 λ k 1 1 λ d d λ k 1 λ k 1 λ π 4 λ 1 k 2 1 λ the hamel integral now becomes 110 l d π 4 a b 1 λ λ 1 λ a b λ k 1 λ e λ k 3 1 λ d λ pk with the aid of work from davison s section of the book by khristianovich et al 1938 showed that 111 g e λ k 3 1 λ is independent of λ in the range a b more precisely she showed that e 1 3 λ k 1 λ is constant the 3 2 π in e λ becoming 1 2 π this was checked for various numerical values of λ and found to be true with the numerical value 112 g 0 258012 then by comparison with the pk integral 105 113 c π 2 a b g d the sought relationship this means that for given d then c is known and the pk solutions can be used to find accurate values of h l h as well as h 0 and hs for given a 1 β and b 1 α comparative numerical values are shown in table 1 for the solutions of hamel and günther 1935 with other authors results including the accurate solutions using eq 113 and pk integrals of section 2 4 pk assumed l 1 and calculated c 0 3580 compared with the accurate value of 0 358531 from eq 113 then took side ratio values as shown in the table according to footnotes in muskat 1935 1937 hamel provided muskat with the details of the hamel and günther paper before publication but muskat did not reproduce any of these results in his 1935 paper pk referenced and included in her 1940 paper the results of hamel and günther but made no reference to the work of muskat nor wyckroft and reid cryer 1976 has reported results from both hamel and günther muskat and wyckroft and reid but not pk 1940 the conclusions on relative accuracies are pk 1940 better than muskat 1935 slightly better than muskat 1937 and better than hamel and günther 1935 and the work of wyckroft and reid 1935 are on par with hamel and günther 1935 the results of pk 1940 better than hamel and günther and muskat suggest that evaluations of the single integrals in her analytical solutions are less prone to errors than the double integral representations of the davison hamel formulations muskat 1935 1937 provided another tailwater case with a 2 b 5 d 1 and 1935 results h l h h 0 0 6695 0 4439 0 15795 0 2019 compared with the new accurate results 0 677627 0 443053 0 168158 0 200689 there is a reasonable discrepancy in the h values possibly due to a muskat typographic error into the digital computer age boast 1977 provides an example with data a 2 b 4 95 d 1 and results l h h h h 0 h 0 653 0 250 0 295 compared with accurate values of 0 653136 0 249756 0 295125 a good confirmation of evaluations from the davison hamel method and the pk method for the seawater intrusion case equivalent to the zero tailwater case the linkage may be found by letting b in each of the two expressions for l in eqs 105 and 110 this produces the expression 114 c π 2 a g d and the integrand quantities b ξ 1 and b λ 1 a comparison of the four zero tailwater cases for different a values of muskat 1935 and accurate solutions using pk eqs 33 34 and 36 for respective calculations of h l h 0 and this new value of c with d 1 are given in table 2 5 calculation of analytical solutions the software required to evaluate the integral expressions of section 2 are numerical quadrature of integrals complete elliptic integrals of the first kind with real and complex arguments and algorithms for finding zeros the author uses double precision 14 significant figures fortran software from the nswc collection of routines morris 1993 dqags is used for gaussian adaptive quadrature and ck for the elliptic integrals with complex argument the latter routine has been tested for accuracy using quadrature of the integral expression for an elliptic integral eq 13 and comparisons with results from the arithmetic geometric mean approach for real argument abramowitz and stegun 1970 17 6 and complex argument morita and horiguchi 1973 the zero routines are initially required for finding α β from the pair of equations for l h and h h eqs 33 34 35 then c from any one of these equations this involves real arguments it is important to note that as l h increases and h h is fixed or increases then α 1 and β 1 and both parameters become difficult to calculate this trend is suggested by the last three entries of table 3 of section 6 2 calculations then may require the use of much higher than 14 significant figures precision within ω z is usually given from which ζ is to be found as in eq 16 which produces a pair of equations with complex arguments single equations with real arguments require ξ or η to be found from given respective x or y at points on the boundary also in the analytical expressions for points a and b in section 3 3 and 3 4 numerical inversions are required the software chosen for these zero finding equations is the iterative muller frank method muller 1956 frank 1958 mathews and fink 2004 for single equations extendable to paired equations fiziev and staicova 2011 this method converges almost as rapidly as the newton raphson method polynomial convergence order 1 84 2 but has the advantage of not requiring derivatives of functions moreover a crucial aspect is the solution of a quadratic equation which is suited not only to real coefficients but to complex coefficients the calculations performed in pk 1962 1977 were based on assuming values for α and β and then determining h l h h 0 assuming c 1 this assumption on c did not matter because tabulated values were presented based on ratios of lengths and the scaling constant c was then not involved the values of most interest presented in figures were coordinates of l h h 0 h and contours of h h coordinates h h h 0 h contours l h and q h h h contours l h computations are probably not better than three decimal places based on pk s 1940 results section 4 and her table 12 pk 1962 p 297 checked by keady et al 1988 this means that interpolating from her figures gives at best two to three significant digits other literature concerned with evaluating the pk solutions is rather meagre and is restricted to just the free boundary with seepage point height the best collection of results is that of hornung and kruger 1985 with tabulations of h 0 for ranges of h h 0 0 1 0 5 and l h 0 5 0 1 1 0 and also free boundary x and y values for h h l h 0 5 all results are given to six decimal places checked by the author and keady et al 1988 with just a few entries affected by rounding another set is by ridolfi 1995 with three decimal places for points on the free boundary and parameter ranges for h h 0 1 0 1 0 6 and h l 0 2 0 1 1 0 and 1 0 0 5 4 0 where there is overlap with the hornung and kruger values agreement is found some of the overlap parameters are noted in table 3 unfortunately ridolfi did not recognize the work of hornung and kruger and in return none of the publications in the list have recognized ridolfi neither of these two sets of results gave α β c values another source of six decimal place results is the monograph by elliott and ockendon 1982 who consider 24 16 4 and 3 22 1 62 0 84 giving free boundary values without α β c their values were checked and found correct and h 0 hs α β c values appear in table 3 bresciani 2012 extracted numerical method values from this work for 1 2 3 1 6 and recalculated free boundary values ignoring the correct values his results are not as accurate e g he gives 0 529409 compared with the true value 0 529413 for these two geometries liu et al 2022 calculated α β c specified at six decimal places using a random search algorithm but contained round off errors in some parameters the main function of this paper was to prepare a chart for determining α and β for given values of h h and l h but like the pk charts only two to three significant figures can be determined the only other works of interest are that of cryer 1976 and ozis in crank 1984 despite the quote from cryer in the introduction saying that the task of computer evaluation of analytical solutions is relatively simple cryer s calculations in his 1976 report are not very accurate his results for 24 16 4 are hs 12 7132 α 0 095126 β 0 465367 to be compared with accurate results of respective values 0 529413 24 12 705914 0 095284 0 465881 he also gives results for 0 322 0 162 0 084 of hs 0 204660 α 0 098554 β 0 199823 compared with the respective true values of 0 204385 0 098701 0 200904 according to crank 1984 pp 311 312 ozis used cryer s 1976 exact values of α β to obtain a seepage point height of 0 529459 x 24 12 7070 different from cryer s value apparently both cryer and ozis had difficulties with calculating either or both of complete elliptic integrals and numerical quadratures in the vein of pk s work of prescribed α β chapman 1957 used the work of muskat 1935 to present a chart for values of h 0 h and l h from prescribed values of a and b i e 1 β and 1 α leading to another chart to determine h h again only low order accuracies can be determined this way 6 survey of numerical methods there is a large literature on free surface problems not only for groundwater but also for other physical situations in both mathematical and numerical approaches the literature survey here is focused on just publications which have attempted to solve the classical dam problem with existing tailwater and which in principal can solve for ϕ thence numerically ψ ϕ x ϕ y in ω as well as on the boundary fig 2 shows the more than one hundred publications of numerical methods only accumulated with time from 1940 to the present the first numerical method paper was by shaw and southwell in 1941 using the hand calculated relaxation method for finite difference equations and not long after the first calculations of the davison hamel method in 1935 and the pk method in 1940 as discussed in section 4 the marked upturn in publication numbers in the 1960s and 1970s was driven by the availability of digital computers another factor sustaining the growth in numbers was the introduction of the variational inequality method by baoicchi in 1971 see e g cryer 1976 from which the numerical values for the dam problem were given first by commincioli et al 1971 and later impetus provided by the exposition of oden and kikuchi 1980 an even greater impetus was provided by the introduction of numerical methods already developed in other areas of applied sciences and engineering namely the finite element method e g cheng and li 1973 and boundary integral equation method e g liggett 1977 cryer s report of 1976 cryer 1976 is a good and detailed report of the mathematical and numerical status of the dam problem at that time within the focus on the classical dam problem a further restriction is made by examining how well numerical results have converged to true values thereby eliminating experimental results variable saturation and inhomogeneity although there are many numerical methods no discussion is devoted to their specific details nor superiority of approach instead methods are just represented by their abbreviations 6 1 abbreviations of methods bem boundary element method bi biot pore skeleton rigidity efm extended flux method epm extended pressure method fdm finite difference method fem finite element method fn fracture network approach fvm finite volume method hv hadamard variation iv interchange of variable lp linear programming lsm level set method mfs method of fundamental solutions nem natural element method nmm numerical manifold method odd overlapping domain decomposition pso particle swarm optimisation rbf radial basis functions sa simulated annealing so shape optimisation sph small particle hydrodynamics t transience tcf thiele continued fractions trm trefftz method vfm virtual flux method vib variational inequality method of baiocchi vnm virtual node method these abbreviations are selected for a particular publication as the most important component of solution even though more than one method may be involved for example aitchison 1977 contains a fdm extension of her earlier work aitchison 1972 but the main part of her paper is vib with fem moreover the classical problem may be the limit of a more general setting such as passing from transience to steady state or for a biot porous skeleton passing from a flexible to a rigid structure finally a general grouping of methods may be made in more traditional form of those with components satisfying exactly laplace s equation and approximating boundary conditions as in bem mfs and trm and the remaining and larger grouping which satisfy approximately both laplace s equation and boundary conditions designated as galerkin methods 6 2 numerical values for various geometries some 17 different h l h geometries have been used within the collection of numerical methods table 3 displays the pk α β c parameters for each h l h and the calculated seepage heights h 0 and hs using equations from section 2 the four references cited contain either h 0 values and or values along the free boundary they have been used as a check on accuracies no use has been made of the values of ridolfi 1995 in any of the cited publications following this table each geometry is considered in the same order as in the table for the accuracies of results from the numerical method works associated with each geometry the geometrical groups take the extended form h l h hs it is also worth mentioning that the logarithmic gradient behaviours at points a b and e have not been acknowledged let alone used by any of the publications except those of aitchison 1972 1977 for point a and liggett 1977 for point e 6 3 geometry 24 16 4 12 705914 of all geometries used in numerical method examples this is by far the most commonly used table 4 displays the seepage height hs by author and abbreviated method in some cases there are different methods and different geometries within the same publication authors bruch 1980 1988 hsiao et al 2004 and shahrokhabadi et al 2016 all use a comparative value of hs 12 95 deduced from the contour plots from pk 1962 a value which is not possible to determine to this accuracy in terms of truncating values the most accurate result is 12 72 achieved by aitchison 1977 and thatcher and askew 1982 a value which has not been bettered nor equalled in later publications with this or any other geometry despite great improvements in computer memory and speed the less stringent accuracy to rounded decimal places at a maximum of three was achieved by these previous authors plus andrab et al 2017 chen et al 2007 frolkovic 2012 fukuchi 2016 hsiao et al 2004 and shahrokhabadi et al 2016 there are additional publications in which no seepage point values were given but in most cases a calculated free boundary was displayed bermudez and durany vib 1988 chantasiriwan bem 2011 cheng and li t 1973 cividini and gioda fem 1989 2000 dai et al fem 2019 desai and baseghi fdm 1988 elliott and ockendon vib 1982 finnemore and perry fdm 1968 jiang et al odd 2005 ku et al t 2019b maione and martinole fem 1992 morland and geoda fem 1990 noseda fdm 1961 shahrokhabadi and toufigh nem 2013 sharma et al fem 2021 shaw and southwell fdm 1941 southwell fdm 1946 torabi and tajrishi fem 2000 wei et al fn 2021 westbrook vib 1985 xiao et al mfs 2017 yuan and zhong fem 2016 zhang and jiang vib 2012 zhang et al vib 2005 even though accurate values for free boundary locations and seepage point are in elliott and ockendon 1982 only bermudez and durany 1988 have made a comparison with these free boundary values but in their case have not determined the seepage height 6 4 geometry 3 22 1 62 0 84 2 043853 this geometry is an altered version of the original problem considered by hamel and günther 1935 and muskat 1935 there they set α 0 1 β 0 2 and found approximate values for h l h hs the accurate values determined in section 4 table 1 are respectively 3 18414 1 59863 0 83815 2 02361 in muskat 1937 the approximate values became 3 22 1 62 0 84 and an hs 2 06 these values of h l h then became the standard geometry and the accurate value of hs 2 043853 determined by eliott and ockendon 1982 became the key comparative value some authors call the dam problem of this geometry the muskat problem unfortunately due to a typographic error in the software users manual of galavi 2010 0 84 became 0 48 and several papers based their calculations on this number for the first value of 0 84 only commoncioli et al vib 1971 provide seepage point heights of 2 0611 and 2 0684 for two different grid geometries free boundary values were also provided all other papers with free boundary curves and no seepage height value are baiocchi et al vib 1973 chakib et al so 2002 chakib et al so 2003 chakib and nachaoui t 2005 nazemi et al lp 2008 othman et al hv 2010 othman et al vib 2011 suzuki and tsuchiya vib 2005 suzuki and tsuchiya bem 2011 craig and wood vib 1981 just gave written assurances that three decimal place accuracy was achieved at the free boundary for the value of 0 48 all publications now listed gave free boundary curves but none gave numerical values for them nor seepage point heights culebra and lópez querol fem 2012 galavi fem 2010 lian et al sph 2021 lópez querol et al bi 2011 navas et al bi 2014 navas et al bi 2016 6 5 geometry 10 5 5 6 623820 analytical numerical values are available for the free boundary and seepage height by hornung and krueger 1985 and given in their table 3 one other paper was found for this geometry it was by aharmouch and amaziane fem 2012 and graphically compared results with the accurate free boundary but provided no seepage point height 6 6 geometry 10 5 2 6 344551 the papers in this group are as follows ahmadi fem 2021 ahmadi et al t 2016 ahmadi et al efm 2018 ayvaz and karahan fdm 2007 ayvaz et al fdm 2005 bardet and tobita fdm 2002 bazyar and graili bem 2012 borja and kishnani fem 1991 çalamak et al fdm 2012 cheng and tsui fem 1993 darbandi et al fvm 2007 dou et al fem 2017 herreros et al lsm 2006 ji et al epm 2005 jie et al nem 2013 jun and liu vnm 2011 kazemzadeh parsi fem 2019 kazemzadeh parsi and daneshmand fem 2012 lacy and prevost fem 1987 liu et al fem 2018 navas and lópez querol bi 2013 oden and kikuchi vib 1980 peng et al sph 2015 rafiezadeh and ataie ashtiani bem 2004 sun et al nmm 2021 wang et al nmm 2014 yang et al nmm 2019 zhao et al lsm 2022 although graphical displays of the free boundary calculations were given comparisons were made with other results in the same group no numerical values were given for hs 6 7 geometry 10 10 n 1 2 2 5 3 4 5 6 the results from lee and leap fdm 1997 for hs with accurate values in braces are the following 10 10 1 3 85 3 446153 10 10 3 4 35 4 268554 10 10 4 4 85 4 740819 10 10 5 5 45 5 362427 cividini and geoda fem 1984 jun et al vfm 2019 li et al fem 2003 as well as navas and lópez querol bi 2013 considered 10 10 2 with a free boundary curve but no numerical values for 10 10 3 karageorghis mfs 1992 gave hs 4 273 a result on par with the best of the 24 16 4 group there is also liggett bem 1977 toufigh fem 2016 and wu et al bem 1996 with a free boundary curve but no numerical values given three final publications with free boundary curves but no numerical values given are 10 10 2 5 by gioda and gentile fem 1987 10 10 4 in niwa et al bem 1976 and 10 10 6 considered by cividini et al fem 1987 6 8 geometries miscellaneous these are the geometries at the bottom of table 3 all of the few publications provide free boundary curves but most give no values for seepage heights listing these first there are 20 5 4 wu et al fem 2013 1 6 1 0 0 6 marini and pietra vib 1986 6 5 1 kealy and williams fem 1971 10 20 3 cheng and li t 1973 21 25 26 56 1 37 szabo and mccaig fdm 1968 19 7 24 56 1 3 france et al fem 1971 szabo and mccaig 1968 compare their results with those from a private analogue computer they are later used for comparison by france et al 1971 for which analytical values for hs are similar and not given here those that do provide seepage height values with accurate values in braces are 10 20 3 bruch et al bem 1986 3 21 3 231934 and isaacs fem 1979 8 28 6 427580 6 9 geometry of leontiev and huacasi leontiev and huacasi bem 2001 is the standout paper from those in the preceding groups because it follows the procedure set out by pk 1962 of choosing α β c and determining the geometry from them these authors quote the pk expressions for h l h h 0 and evaluate the integrals with α β c 0 3 0 9 1 to obtain 6 3014 6 1592 1 2359 1 2868 in contrast the accurate values are 6 309053 6 164005 1 236991 1 2868235 the respective values of hs are 2 5225 2 523814 their bem results were compared with free boundary values excluding hs and were correct to two significant figures chaiyo et al mfs 2011 used the h l h h 0 values of leontiev and huacasi to compare free boundary curves no numerical values were given finally fukuchi fdm 2016 with the same approximate geometry found a value of hs 2 5391 6 10 interior values many of the publications have provided contours of ϕ throughout ω but only shaw and southwell fdm 1941 with pressure ϕ y and rushton and redshaw fdm 1979 provide numerical interior values for other quantities a handful have provided contours without numerical values flownets chaiyo et al mfs 2011 bardet and tobita fdm 2002 cividini et al fem 1987 fukuchi fdm 2016 and lacy and prevost fem 1987 pressure curves bermudez and durany vib 1988 darbandi et al fvm 2007 shaw and southwell fdm 1941 also southwell fdm 1946 and torabi and tajrishi fem 2000 and velocity fields directed by arrows bermudez and durany vib 1988 chaiyo et al mfs 2011 chung and kikuchi fem 1987 frolkovic lsm 2012 and navas et al fem 2014 on the headwater and tailwater boundaries niwa et al bem 1976 provided curves of ϕ x the preceding publications do not provide numerical values for their contours apart from shaw and southwell 1941 and the less accurate rushton and redshaw 1979 and their accuracies are not known a summary of this survey is that the measures of accuracy of these publications are mostly imprecise relying on the comparisons of different authors results for the free boundary curves in most cases the height of the seepage point hs has not been given but when this precise measure has been given it has not been bettered than the almost four decimal place accuracy achieved in 1977 and 1982 the interior results discussed in the previous paragraph are with two limited exceptions without numerical values for accuracy assessment 7 numerical tables and contour plots 7 1 numerical tests for software apart from comparisons with existing results for six decimal place values of α β c and hs already found by others namely elliott and ockendon 1982 hornung and krueger 1985 and mason 1985 there are several checks that can be made with analytical expressions there is the identity of eq 48 for flux rate q h involving the expression of charny 1951 and an integral dependent on α β c the equation q h q h q h 0 and the equivalence of the two different expressions for base length l from eqs 31 and 34 these all involve a check on software for numerical quadrature real argument elliptic integrals and zero finding for α β c in all three tests a minimum of eight significant figures was achieved the least accurate process being that of determining α β c another check for the same software but with complex argument elliptic integrals involves following a regional path integral as discussed in section 3 and depicted in figs 3 a and 3 b the integrations on the paths apqr in both figures produce a value at the boundary point r of x 0 31263024 when ξ 3 for the geometry 1 2 3 1 6 hs 0 52941308 and α β c 0 09528383 0 46588128 0 20609228 this is verified with the boundary integral of eq 25 and real argument elliptic integral based on these analytical checks for their numerical values all other calculations are assured of at least eight significant figures 7 2 numerical values based on the shaw and southwell grid the choice of exhibiting numerical results for the geometry 24 16 4 or its scaled form used for figs 3 a and 3 b is explained in the introduction and supported by the details of section 6 3 here all results are based on this scaled geometry of 1 2 3 1 6 shaw and southwell 1941 divided the dam domain into a grid of squares 24 vertically and 16 horizontally limited by the free boundary and provided values of the scaled pressure p at the grid points here the same grid is chosen and calculations are made for the analytical expressions of ϕ ψ ϕ x ϕ y and p given in section 2 1 all numerical values are based on x and y coordinates of fig 1 with increments 1 24 24x 0 1 2 3 16 24y 0 1 2 3 24 due to space limitations the x coordinates are reduced to 24x 0 2 4 16 in the tables which are given in the appendix with a prefix a before the table number however the full range of x values are given in the supplementary material and are used in constructing contour plots the tables all have six decimal place values the extensive and important tables underpinning the contour plots of figs 3 a 3 b and those for ϕ ψ p ϕ x ϕ y to come are placed in an appendix to provide easier reading of the text the tables are now designated tables a6 a12 rather than tables 6 12 essential to all values of functions at the grid points are the values there of ξ and η which are given in tables a6 and a7 in fig 3 a contours for constant values of ξ and of η are displayed at x y coordinates and in fig 3 b there are contours for constant x and y for coordinates ξ η these contours are obtained by path tracking at constant values along paths in contrast the contour plots for the quantities ϕ ψ ϕ x ϕ y and p are based on interpolations from grid points using the public domain software gnuplot williams kelley et al 1993 fig 4 displays contours of ϕ at levels 0 2 0 05 0 95 and orthogonal ψ at levels 0 05 0 05 0 7 with an additional top boundary value of ψ 35 48 0 729167 from eq 47 scaled by 24 the supporting tables for these figures are table a8 for ϕ and table a9 for ψ in addition to these tables boundary equations from section 2 were used to locate coordinates of contour values in fig 5 contours are shown for scaled pressure p linked to ϕ by eq 9 at levels 0 05 0 05 0 9 and an additional level 0 025 just below the top boundary the supporting grid values are derived from ϕ grid values of table a8 and given in table a10 fig 1 drawn to scale of the geometry 1 2 3 1 6 with accurate boundary curve ab and the contours of figs 4 and 5 bounded by the dam perimeter as well as all other contour plots below appear benign however gradients show considerable variations as the points a b and e are approached as already pointed out in section 3 this is born out by fig 6 for ϕ x with contour levels 0 05 0 05 2 1 and supporting table a11 and levels of 0 05 0 05 1 00 for ϕ y in fig 7 and supporting table a12 as point e is approached from all directions the contour spacings diminish in order to complete the contours for ϕ x a finer x y grid was created between 24x 13 and 16 and between 24y 0 and 6 by decreasing the grid increments eightfold to 1 192 this increased density of data is given in the supplementary material this high variability of gradients is also to be expected when examining fig 3 a the combination of ϕ x 2 ϕ y 2 1 2 as equivalent velocity magnitudes are isotachs exemplified by anakhaev 2016 in a real dam isotachs may be useful to predict regions of internal erosion an important set of values not presented in the preceding tables are those off the grid values on the free boundary ab table 13 gives values at x 0 1 2 16 24 for y ξ ϕ x ϕ y d y d x and normal angle ν all calculations are based on section 2 these values are useful for comparison of results from numerical methods in the important step of finding the free surface values 7 3 local behaviour near points a b and e in section 3 analytical expressions were given for gradients driven by ϕ x near points a b and e two sets of results for each point relating to the boundary segments forming each point these are now used in the construction of graphs and numerical tables fig 8 displays curves of ϕ y ϕ x and their ratio d y d x along ab the main features are already seen in papers by boast 1977 with geometry 0 653 0 250 0 295 and liu et al 2022 with geometry 24 16 0 for similar curves and by aitchison 1972 keady et al 1988 and pk 1988 for analysis near a more detailed analytical expressions near both end points a and b are given in section 3 1 and numerical values are given in tables 14 and 15 fig 9 shows curves for ϕ x along side cd and ϕ x along side segments ae and de similar curves were presented by anakhaev 2016 and muskat 1935 for the approximate geometry 0 3223 0 1619 0 0842 the approximation discussed in section 4 and also with the bem numerical approach by niwa et al 1976 with geometry 10 10 4 the analysis of section 3 2 provides the basis for numerical values of table 16 as point e is approached from above along ae and below along de both tabular values and plots show that although gradients approach due to logarithmic behaviour there is no symmetry of values about the line y 1 6 this asymmetry also exists in the ξ values for x y coordinates of table 6 near point a the curve of the gradient is relatively flat for moderate distances as supported by the analysis of section 3 4 and values of table 17 similar behaviour occurs near point b following from the analysis of section 3 3 and values in table 18 in making these calculations from analytical solutions at particular values of coordinate ξ and associated x or y values the limit of numerical quadratures for the true solutions is reached the analytical approximations of section 3 are then used to complete the curves as the critical point is approached 8 concluding remarks the large collection of numerical methods applied to the dam problem has been surveyed for accuracy of complete results for potential and stream functions and orthogonal potential gradients ϕ ψ ϕ x ϕ y on the boundary and interior of the dam although interior contours have been given for pressures flownets and velocity fields in a handful of publications there is an almost total lack of numerical values the best example for convergence to an exact seepage point height above the tailwater with close to four decimal place accuracy was achieved in 1977 equalled in 1982 and since then neither superseded nor equalled despite subsequent massive increases in computer storage and speed the existing analytical solutions have also been surveyed for numerical values for the complete set of functions ϕ ψ ϕ x ϕ y the initial calculations for side lengths and seepage points in 1935 by the davison hamel method and in 1940 by the pk method achieved 2 3 decimal place accuracy it was not until the 1980s that a few calculations were made to 6 decimal places but in none of these calculations were values given for ϕ ψ ϕ x ϕ y in the interior nor for quantities unspecified on the boundary and even with these values little use was made by authors of numerical methods to check their accuracies the important link between scale constants of the davison hamel and pk methods has been found with the implication that theoretical work based on the davison hamel approach is much easier with the pk approach for example the analyses provided for gradient behaviour near the three critical points of free boundary entry and exit and intersection of seepage face and tailwater is not obvious with the davison hamel method another useful result for the linkage is that it holds for the case of no tailwater where the original model can be converted simply to the important case of seawater intrusion and the two different methods by davison hamel and pk have remained unconnected until now in summary the main aim of this paper has been achieved new numerical values have been presented as a benchmark for any of the applicable numerical methods as a challenge to demonstrate convergence to an accuracy greater than that which prevails so that a method can then be used more confidently with other free boundary problems which do not have analytical solutions declaration of competing interest the author declares that he has no known competing financial interests or personal relationships that could have appeared to influnence the work reported in this paper acknowledgements the author gratefully acknowledges the assistance given to obtain some reference material oscar castro orgaz annamaria cividini anvar kacimov and the hydrologic institute of leningrad to obtain davison 1932 john knight marc robinson and jack sharp the suggestions by reviewers for inprovement in clarity of presentation is also appreciated supplementary materials supplementary material associated with this article can be found in the online version at doi 10 1016 j advwatres 2022 104356 appendix b supplementary materials image application 1 appendix tables for interior grid values numerical values of ξ η ϕ ψ p ϕ x ϕ η are presented in the following tables based on a rectangular grid 24 16 height x width of equal intervals 1 24 in the x y plane with top cut by the free boundary for the geometry 1 2 3 1 6 in table a6 the value of ξ is presented at 16 24 4 24 corresponding to point e the top of tailwater as just above e the value of ξ is just below it however exactly at e the value has been numerically calculated as ξ 3 53 fig a6x in the supplementary material shows curves indicating this value in this table are four decimal place values derived from shaw and southwell 1941 who multipled their original decimal place values by 6000 to produce integer values with savings of printed space two typographical errors were found in this data modified here at coordinates 7 24 10 24 where 589 should probably be 389 and at 13 24 3 24 1303 should probably be 1503 pk 1962 p 442 copied this data including the two errors but omitted the data in her 1977 book pk 1977 due to space limitations the y coordinate values also have been reduced to 24y 0 2 4 24 however the tabular values for complete x and y grid values are given in the supplementary material 
30,the classical two dimensional dam problem was solved analytically and independently by davison in 1932 and hamel in 1934 and involved double integrals in 1938 polubarinova kochina produced solutions involving single integrals and in 1940 showed that the davison hamel solutions could be reduced to ones obtained by her method missing from the conversion was a linkage between scale constants which is given in this paper initial calculations by these authors were difficult because of evaluations of elliptic integrals and numerical quadratures as a free boundary problem it is now a test case for a multitude of numerical methods surveying analytical and numerical approaches it is found that both are limited in accuracies and are overwhelmingly concerned with the location of the free boundary and its seepage point analytical expressions are here given for the gradients near the three critical points of free boundary entry and exit and the intersection of seepage face and tailwater new numerical results to six decimal places are given for tables and contours on and within the dam boundary for potential and stream functions and orthogonal potential gradients keywords groundwater free boundary dam problem polubarinova kochina elliptic integrals numerical methods data availability no data was used for the research described in the article 1 introduction in many groundwater situations the saturated surface is free to move this makes quantitative predictions difficult when subsurface behaviour is to be modelled analysed and numerically evaluated with the advent of digital computers there has been many applications of numerical methods for mathematical models of such problems with these methods comes the necessity of verification of solution accuracy the standard way of doing this is to compare with analytic solutions to problems when they are available one such case is the classical dam problem with known analytical solutions and the many publications of numerical models attempting to solve it the overall observation from these publications is that complete numerical values are not provided in both analytical solution evaluation and numerical methods and the accuracies of parts of the complete solution where presented are satisfactory for analytical evaluations but not so for numerical methods in consequence a major aim of this paper is to rectify this situation and provide benchmark numerical values from analytical solutions for future applications of numerical methods the classical dam problem mathematically represents a two dimensional 2d body as depicted in fig 1 with impermeable base free top boundary and vertical sides of entry headwater and exit seepage face and tailwater the material is a homogeneous isotropic porous medium obeying darcy s law the defining differential equation is laplace s equation for potential ϕ and boundary conditions given required to be found are the position of the free boundary and values within and on the boundary for ϕ its derivatives in two orthogonal directions and the stream function ψ linked to ϕ through the cauchy riemann equations secondary quantities are pore pressure and total flow across dam vertical sections the time period of this work starts from the analytical solutions and some numerical evaluations in the 1930s and continues to the present day with numerical methods the first solution to this problem in very compact form was given in 1932 by davison 1932 1936 in 1934 an independent solution of the same kind in much more detail was given by hamel 1934 both of these solutions involved double integrals containing complete elliptic integrals in the following year the first calculations were given by hamel and günther 1935 for approximations within two to three significant figures for one particular geometry configuration of side lengths h l h respectively headwater height base length tailwater height as in fig 1 before publication this work was sent to muskat who solved the same problem as well as five other geometries three of which had zero h values muskat 1935 according to emikh 2015 kochin the husband of polubarinova kochina pk henceforth reviewed a monograph khristianovich et al 1938 containing a section by davison and indicated to pk that a simpler solution might be found by application of the theory of differential equations this she did with her 1938 paper showing that solutions can be given in terms of single integrals still involving complete elliptic integrals pk 1938 in 1940 pk published a very important paper pk 1940 which showed how the davison hamel solutions can be analytically transformed into her solutions in that paper she also did calculations with her method comparing results with those of hamel and günther but not of muskat this russian paper appears not to have been appreciated none of the extensive list of papers referenced below nor any citations of it have been observed by the writer except for a very recent paper by liu eta al 2022 in section 4 a new numerical conversion between the methods is given something that pk apparently missed details of both methods of solution are given in crank 1984 pk s work appears in her book of 1952 translated into english in 1962 pk 1962 and further references in section 5 by 1980 crank and ozis 1980 commented that the classical dam problem was already over studied to the present time the problem now has been very well studied as evidenced by fig 2 which shows a cumulative number of publications with time of just numerical methods for the dam problem with tailwater nevertheless an important observation by cryer 1976 was the following the evaluation of the solutions of hamel and polubarinova kochina is a difficult task by hand but relatively simple on a computer it is therefore unfortunate that this work has been overlooked and that many authors have computed numerical solutions for the model problem without comparing their results with the exact solutions this situation mostly prevails today with a small percentage of publications providing seepage point values and analytical solution comparisons for a range of values of h l h particularly the work of hornung and krueger 1985 rarely being used it is important to note that the classical dam problem is not modelling a real dam headwater and tailwater sides are never vertical heterogeneity is always present and there is always an unsaturated region above the free boundary line at the top of the saturated region mavroulidou et al 2006 makes it quite clear in the case of a dam with trapezoidal cross section that the free boundary line in the variably saturated case is quite different to that of the fully saturated case which also will be true for a rectangular dam and excised portion of it which is fully saturated and representing the classical dam often rectangular dam is used incorrectly to describe the classical case which is a purely mathematical model although the classical problem is not realism it is expected to show the major seepage flow features that do occur but do any of the large number of listed references 1 1 the collection of references were obtained from the citations of each relevant article and its review of literature and reference list a laborious process moving forward and backward in publication date done many times this also included the same process for searches on references not listed here on topics of free surfaces heterogeneity inclusion of unsaturation no tailwater non rectangular dams and approximate dam solutions possibly some valuable articles have been missed represented in fig 2 with more than a dozen different geometries h l h make or recommend specific use of the classic results for other dam problems despite many introductions in these papers stating the importance of dam seepage analysis no linkage has been found to their calculations of the classic case this situation emphasises that the classic dam problem is a mathematical one and the specific values of h l h used are not important accurate solutions for any one geometry will have the same general patterns of solutions as any other this is even true of the critical points a b and e of fig 1 where the analyses in section 3 show that gradients are determined by logarithmic terms of ϕ x with x the horizontal coordinate as in fig 1 in the cited papers no reason is given for selecting a particular h l h other than referring to that chosen by previous authors because of this a choice has been made of 1 2 3 1 6 only to present new sets of tabulated and contour values this geometry is also the one most commonly chosen in the references is the first example of any numerical method calculations achieved by shaw and southwell 1941 using finite differences with the hand calculated relaxation method whose rare internal grid values are also reproduced by pk 1962 and whose accurate free boundary position has been made by elliott and ockendon 1982 the substance of the paper which now follows consists of problem definition analytical solutions including new analysis at critical points of headwater entry seepage point and intersection of seepage face and tailwater the new numerical connection of original analytical solutions of davison 1932 hamel 1934 and pk pk 1938 1940 survey of numerical methods based on differing geometries and accuracy of seepage point locations and benchmark results to six decimal places 2 the pk analytical solutions the analytical solutions are based on chapter 7 of the book of pk originally written in russian in 1952 and translated into english in 1962 pk 1962 a later version pk 1977 only in russian had minor rearrangements and some typographic corrections of this chapter but introduced new errors most of the geometrical lettering and mathematical symbols used here are those of pk the solutions will be stated in section 2 3 the details leading to the solutions may be found in pk 1938 pk 1962 crank 1984 and ridolfi 1995 but are omitted here because of the emphasis on numerical evaluations an essential part of the solutions is in mapping of the real plane of the dam to a complex plane and expressing three important parameters α β c of this plane in terms of the real geometry h l h most of the work done in numerical evaluations is in the complex plane although it may be natural to assign values of h l h finding α β c is an inverse and iterative process unsurprisingly pk chose the reverse process of assigning α β c and finding h l h directly this inevitably meant that with simple choices such as α 0 1 β 0 2 c 1 then h l h are not integer quantities this is the same general process adopted by hamel and günther 1935 and muskat 1935 in evaluating the davison hamel equations mentioned in the introduction pk s presentation of equations is directed towards boundary evaluations and mostly ignores the dam interior here pk s equations are presented for boundary and interior and geared towards natural assignments of h l h 2 1 statement of the problem the geometry of the problem is shown in fig 1 coordinate axes x and y originate at c the free boundary is ab with seepage point at a side bc of length h is entry headwater impermeable base cd is of length l side de of length h is exit tailwater and ea of length h 0 is the seepage face an additional length is useful to define as hs h h 0 height of seepage face above the base to be found is the position of the free boundary which includes h 0 in terms of a potential function or piezometric head ϕ once h l h have been assigned either directly or by defining α β c then determine values of ϕ ψ ϕ x ϕ y within the interior ω and on the boundary wherever they have not been already defined ψ is the stream function defined by the cauchy riemann equations 1 ϕ x ψ y ϕ y ψ x the extended 2d darcy s laws are 2 q x u x n u k ϕ x q y v y n v k ϕ y where qx qy ux v y are respective flow rates and average velocities in directions x and y and u v the pk velocities n and k are respective porosity and hydraulic conductivity with constant values pk uses the velocity potential symbol φ kϕ and the accompanying ψ pk kψ the preceding equations with the continuity equation u x v y 0 produce laplace s equations 3 2 ϕ 2 ϕ x 2 2 ϕ y 2 0 and 2 ψ 2 ψ x 2 2 ψ y 2 0 the boundary conditions for ϕ are 4 along the free boundary ab ϕ y and ϕ n 0 5 along headwater side bc ϕ h 6 along base cd ϕ y 0 7 along tailwater side de ϕ h 8 along seepage face ae ϕ y where n is the normal direction to the free boundary forming an angle ν relative to the x axis an additional quantity of interest is scaled pressure or pressure head p p ρ g p pressure ρ density within the permeable and homogeneous material of the dam and g gravity acceleration related to ϕ by 9 p ϕ y the free boundary boundary condition ϕ n 0 is that used in numerical methods pk uses instead the condition u 2 v 2 kv 0 ϕ x 2 ϕ y 2 ϕ y to show this equivalence assume ϕ n 0 then ϕ y cosν ϕ s ϕ x sinν ϕ s which when substituted in the pk condition produces ϕ s cos ν but cos ν δy δs δs 0 δϕ δs δs 0 ϕ s as required having used ϕ y on the free boundary 2 2 analytical solutions the solution to the problem by pk in her book pk 1962 consists of three general expressions in terms of the complex variable z x iy in the plane of the dam and the mapped complex variable ζ ξ i η in its upper half plane corresponding to that of the ξ η plane of fig 3 b these three equations are as follows a mapping relationship 10 d z d ζ z ζ a k ζ i k 1 ζ 1 ζ a ζ b ζ a relation for ϕ and ψ in θ ϕ i ψ 11 d θ d ζ f ζ a k 1 ζ 1 ζ a ζ b ζ and expressions for ϕ x and ϕ y 12 u k i v k ϕ x i ϕ y k 1 ζ k ζ i k 1 ζ k ζ is the complete elliptic integral of the first kind defined for complex argument ζ by 13 k ζ 0 π 2 1 1 ζ sin 2 t d t and by association a similar expression for k 1 ζ pk 1962 uses f ζ k f ζ in eq 11 the boundary conditions on ab are automatically satisfied for ϕ n u 2 v 2 k v 0 it follows immediately from eq 12 for the other condition eqs 10 and 11 produce y ξ ϕ ξ which integrates to y ϕ as required the constants a a b need to be determined by the geometry h l h or conversely be assigned to produce a specific geometry the appropriate equations will be given further on but first there are some useful transformation identities among the elliptic integrals 14 k ζ i k 1 ζ 1 ζ k 1 ζ i 1 ζ k 1 1 ζ 15 k 1 ζ 1 ζ k 1 1 ζ 1 1 ζ k 1 1 ζ i k 1 1 1 ζ for non russian textbooks up to 1970 fettis 1970 showed that the i in the first of eqs 14 had been given as the incorrect i the most important source being the compendium of erdélyi et al 1953 to obtain expressions for z and θ eqs 10 and 11 need to be integrated 16 z z 0 ζ 0 ζ z ζ d ζ 17 θ θ 0 ζ 0 ζ f ζ d ζ before making these integrals more specific with values of z z 0 ζ ζ0 it is useful to examine contoured figures which show the dam and its interior of the real plane in fig 3 a and its mapping to the real coordinate version of the complex plane given in fig 3 b 2 3 regional coordinate contours fig 3 a is the five segment boundary of fig 1 with contours of constant values of the complex coordinates ξ and η drawn upon it the associated fig 3 b shows corresponding points a b c d e at along the line η 0 with the interior of the dam corresponding to η 0 and constant value contours for x and y fig 3 a happens to be the geometry 1 2 3 1 6 as part of the new numerical results of this paper but is typical of any geometry h l h the calculations for these curves are based on eq 16 and eq 10 for z ζ with z 0 l i hs ζ0 0 i 0 for points a further details will be given in section 7 because the complex half plane function z ζ is analytic integration between any two points is path independent and to suit numerical integrations the path can consist of one or more steps of straight lines aligned with the ξ and iη axes but because of analyticity this translates to the same integrations in the real ξ η plane as an example to pass from the origin at a in the ξ η plane to a point q a two linear segments path is a 0 0 to p η1 0 then p to q η1 ξ1 the corresponding path in the real x y plane is nonlinear by this means any point within ω can be reached also any point r on the dam boundary can be reached with a corresponding straight line segment in the ξ η plane with constant ξ ξ2 from q to r ξ2 0 more efficient ways of relating points on the boundaries of the two planes can be made with other choices of z z 0 ζ ζ0 in eq 16 this is the substance of pk s focus and presented in the next section as far as the author is aware no results have been previously published to enable the drawing of the equivalents of figs 3 a and 3 b 2 4 boundary length equations pk s use of the transformation identities applied to z ζ was to make series expressions for elliptic integrals easier to handle for different ranges of ξ on the mapped boundary segments the second step of using trigonometric changes to the integration variable alleviated problems with the original square root functions in the denominators of the integrals these changes are adopted here the same kind of changes will also be made for the θ eq 17 in the next section expressions for coordinates and lengths of the five boundary segments are given now followed by the requirements for solving the unknown parameters which appear the substitutions as a result of the trigonometric variable changes produce 18 α 1 b β 1 a 0 α β 1 c 2 a a b along ab 0 ξ 1 θ 1 sin 1 ξ 19 x l a 0 ξ k ξ 1 ξ a ξ b ξ d ξ l c 0 θ 1 k sin 2 θ sin θ 1 α sin 2 θ 1 β sin 2 θ d θ 20 l a 0 1 k ξ 1 ξ a ξ b ξ d ξ c 0 π 2 k sin 2 θ sin θ 1 α sin 2 θ 1 β sin 2 θ d θ 21 y h s a 0 ξ k 1 ξ 1 ξ a ξ b ξ d ξ h s c 0 θ 1 k cos 2 θ sin θ 1 α sin 2 θ 1 β sin 2 θ d θ 22 h h s a 0 1 k 1 ξ 1 ξ a ξ b ξ d ξ h s c 0 π 2 k cos 2 θ sin θ 1 α sin 2 θ 1 β sin 2 θ d θ along bc 1 ξ a θ 1 sin 1 1 ξ β 1 β 23 y h a 1 ξ k 1 ξ ξ ξ 1 a ξ b ξ d ξ h c θ 1 π 2 k β 1 β sin 2 θ β α 1 β sin 2 θ d θ 24 h a 1 a k 1 ξ ξ ξ 1 a ξ b ξ d ξ c 0 π 2 k β 1 β sin 2 θ β α 1 β sin 2 θ d θ along cd a ξ b θ 1 sin 1 1 ξ α β α 25 x a a ξ k 1 ξ ξ ξ 1 ξ a b ξ d ξ c θ 1 π 2 k α β α sin 2 θ 1 α β α sin 2 θ d θ 26 l a a b k 1 ξ ξ ξ 1 ξ a b ξ d ξ c 0 π 2 k α β α sin 2 θ 1 α β α sin 2 θ d θ along de b ξ θ 1 sin 1 1 α ξ 27 y a ξ k 1 ξ ξ ξ 1 ξ a ξ b d ξ c α θ 1 π 2 k α sin 2 θ sin θ 1 α sin 2 θ β α sin 2 θ d θ 28 h a b k 1 ξ ξ ξ 1 ξ a ξ b d ξ c α 0 π 2 k α sin 2 θ sin θ 1 α sin 2 θ β α sin 2 θ d θ along ea ξ 0 θ 1 cos 1 1 1 ξ 29 y h a ξ k 1 1 ξ 1 ξ b ξ a ξ d ξ h c θ 1 π 2 k cos 2 θ sin θ cos θ 1 1 α sin 2 θ 1 1 β sin 2 θ d θ 30 h 0 a 0 k 1 1 ξ 1 ξ b ξ a ξ d ξ c 0 π 2 k cos 2 θ sin θ cos θ 1 1 α sin 2 θ 1 1 β sin 2 θ d θ h s h h 0 a symbolic summary of the preceding equations for side lengths involving c is 31 ab l c j l 1 α β 32 h c j h 1 α β c j h α β c j h 0 α β 33 bc h c j h 2 α β 34 cd l c j l 2 α β 35 de h c j h α β 36 ea h 0 c j h 0 α β where j are defined by associations with the right sides of eqs 19 30 essentially there are six unknowns α β c and h l h the expression for h 0 can be substituted into eq 32 with two equivalent choices for h and two for l which reduce to three equations for h l and h by selecting the j h2 and j l2 equations and eliminating c from three pairings of the equations there is the ratios relationship 37 h l h j h 2 j l 2 j h in order to solve these three equations it is necessary to prescribe three of the unknowns the two obvious choices are to prescribe h l h and determine indirectly α β c or conversely to prescribe α β c and determine directly h l h once all parameters are known then h 0 follows from eq 36 in the first choice α and β are solved from a pair of equations which have eliminated c such as l h j l 2 j h 2 and h h j h j h 2 and then c is found from any one of the original three equations in the second choice α and β are prescribed to produce directly h c l c h c in this case choosing any c does not affect the ratios equation and led to the statement by pk in her books pk 1962 1977 that c is arbitrary and can be assigned the value of unity unfortunately for the reader she does not state that α and β must be selected first for this to be true the same confusion exists in pk and falkovich 1951 where c does not appear at all pk s calculated results in pk 1962 1977 involve side ratios but actual side values are not given it is not necessary to make either of the previous choices any three of the six parameters may be prescribed an example of this is pk s choice of prescribing l α β in pk 1940 see section 4 2 5 equations for ϕ ψ and flow rates eq 17 for θ θ0 in more detail is 38 ϕ ϕ 0 i ψ ψ 0 a ζ 0 ζ k 1 ζ 1 ζ a ζ b ζ d ζ the stream function is set at ψ 0 along the base cd values of ϕ0 and ζ0 are dependent on the origins selected for regional values the origin for ζ is set at point a with ζ0 0 and the corresponding ϕ0 hs and ψ0 ψ b the complex integrations are performed along linear segments as in the previous section for boundary integrations with η 0 ζ ξ existing boundary eqs 4 8 imply that expressions for ψ are needed for sides cd de and ae only and for ϕ just the side cd the free boundary ab is a streamline and its stream function is deduced below from expressions of charny 1951 and a vertical section flowrate from eqs 17 and 11 and transformation identities eq 15 there are for ψ along bc 1 ξ a θ 1 sin 1 1 ξ β 1 β 39 ψ ψ b a 1 ξ k 1 1 ξ ξ ξ 1 ξ a ξ b d ξ ψ b c θ 1 π 2 k 1 β cos 2 θ β α 1 β sin 2 θ d θ 40 q h a 1 a k 1 1 ξ ξ ξ 1 ξ a ξ b d ξ c 0 π 2 k 1 β cos 2 θ β α 1 β sin 2 θ d θ along de b ξ θ 1 sin 1 1 α ξ 41 ψ a ξ k 1 1 ξ ξ ξ 1 ξ a ξ b d ξ c α θ 1 π 2 k 1 α sin 2 θ sin θ 1 α sin 2 θ β α sin 2 θ d θ 42 q h a b k 1 1 ξ ξ ξ 1 ξ a ξ b d ξ c α 0 π 2 k 1 α sin 2 θ sin θ 1 α sin 2 θ β α sin 2 θ d θ along ea ξ 0 θ 1 cos 1 1 1 ξ ψ ψ e a ξ k 1 1 1 ξ 1 ξ b ξ a ξ d ξ 43 ψ e c θ 1 π 2 k sin 2 θ sin θ cos θ 1 1 α sin 2 θ 1 1 β sin 2 θ d θ 44 q h 0 a 0 k 1 1 ξ 1 ξ b ξ a ξ d ξ c 0 π 2 k cos 2 θ sin θ cos θ 1 1 α sin 2 θ 1 1 β sin 2 θ d θ and for ϕ along cd a ξ b θ 1 sin 1 1 ξ α β α 45 ϕ h a a ξ k 1 1 ξ ξ ξ 1 ξ a b ξ d ξ h c θ 1 π 2 k 1 α β α sin 2 θ 1 α β α sin 2 θ d θ the vertical section flow rate quantities q above are derived from integration of the point flow rate q x k of eq 2 involving gradients ϕ x which are negative e g along the free boundary ϕ declines monotonically in the x direction from h to h 46 q y 1 y 2 y 1 y 2 q x k ϕ x ψ y d y ψ y 2 ψ y 1 these become q h ψ b along bc q h ψ e along de and q h 0 ψ b ψ e along ea so that q h q h q h 0 alternatively setting ξ 0 in eq 43 the left side becomes ψ b enabling ψ e to be calculated numerically the value of ψ ψ b for the free boundary is obtained from the simple result of charny 1951 derived in pk 1962 47 q h h 2 h 2 2 l and so ψ b h 2 h 2 2 l this means that from eq 40 there is the identity 48 h 2 h 2 2 l c 0 π 2 k 1 β cos 2 θ β α 1 β sin 2 θ d θ which is remarkable given that α β c are involved in nonlinear equations for h l h an alternative identity results by substituting in this equation integral expressions for h l h given in section 2 4 2 6 boundary expressions for ϕ x and ϕ y starting from eq 12 for u i v k the transformation identities eqs 14 and 15 in the limiting case of ζ ξ η 0 provide the following boundary expressions along ab 0 ξ 1 49 ϕ x k ξ k 1 ξ k 2 ξ k 2 1 ξ ϕ y k 2 1 ξ k 2 ξ k 2 1 ξ along bc cd de ξ 1 ϕ y 0 and 50 ϕ x k 1 1 ξ k 1 ξ along ae ξ 0 ϕ y 1 and 51 ϕ x k 1 1 1 ξ k 1 ξ 3 gradients near points a b and e near points a b and e steep gradients occur which are all driven by logarithmic behaviours of ϕ x analytical approximations are made in this section along the dam sides near the corner points a and b with the split ae and de near point e in all six approximations numerical evaluations are performed in section 7 key to these approximations are the expansions of the elliptic integral k z for real argument z 0 z 1 k z as z 0 is 52 k z π 2 1 z 4 9 64 z 2 and as z 1 an infinite value for k z 53 k z 1 2 1 1 4 1 z 9 64 1 z 2 log 16 1 z 1 4 1 z 1 21 32 1 z both expansions may be found in wolfram 2022 3 1 on the free boundary ab along the free boundary ab the appropriate expressions for d x d ξ d y d ξ and d y d x follow from eq 10 as 54 d x d ξ a k ξ 1 ξ a ξ b ξ 55 d y d ξ a k 1 ξ 1 ξ a ξ b ξ 56 d y d x k 1 ξ k ξ 3 1 1 point a near point a assume that x is given an estimate is then found for ξ from which estimates are found for y and d y d x from 54 with small ξ 57 d x d ξ a π 2 1 1 4 ξ a b 1 f a ξ o ξ 2 f a 1 2 1 α β so that 58 d x d ξ c π 4 1 g a ξ o ξ 2 g a f a 1 4 which integrates to 59 x 1 c π 4 ξ 1 1 2 g a ξ o ξ 2 with x 1 l x an inversion of 59 provides an approximation for ξ in terms of x 1 60 ξ 4 x 1 c π 1 g a 2 4 x 1 c π expression 55 for d y d ξ in terms of ξ becomes 61 d y d ξ c 4 1 1 4 ξ log 16 ξ 1 2 ξ 1 f a ξ o ξ 2 which integrates to the approximation 62 y 1 c 4 ξ 1 1 2 g a ξ log 16 ξ ξ 1 1 g a ξ 4 with y 1 y hs for the gradient of eq 56 63 d y d x 1 π 1 1 4 ξ 9 64 ξ 2 log 16 ξ 1 2 ξ 1 21 32 ξ 1 1 4 ξ 9 64 ξ 2 which simplifies to 64 d y d x 1 π log 16 ξ 1 2 ξ 1 13 32 ξ from eqs 49 expressions for ϕ x and ϕ y become 65 ϕ x k ξ k 1 ξ k 2 ξ k 2 1 ξ d y d x 1 d y d x 2 1 d y d x 0 ξ 0 66 ϕ y k 2 1 ξ k 2 ξ k 2 1 ξ d y d x 2 1 d y d x 2 1 ξ 0 if need be expressions of y and d y d x in terms of x can be found by substitutions with ξ in particular rougher approximations can be made by eliminating all α and β to coincide with the existing expression given by aitchison 1972 and independently by kochina and kochina 1988 and keady et al 1988 from 67 y 1 x 1 π log x 1 and by differentiation 68 d y d x 1 π 1 log x 1 these expressions are then available to any numerical method independent of the h l h geometry adopted 3 1 2 point b near point b in contrast to analysis near point a the most straightforward approach is to assume that y is given then from it an estimate of ξ is made followed by estimates of x and d x d y in terms of ξ first define the quantity ξ 1 ξ which is small as ξ 1 the square root term in the above equations can then be approximated by 69 1 ξ a ξ b ξ a b 1 α 1 β ξ 1 f b ξ where 70 f b 1 2 α 1 α β 1 β with this approximation and a small argument expansion for k ξ then eq 55 provides d y d ξ a π 2 a b 1 α 1 β 1 1 4 ξ ξ 1 f b ξ o ξ 5 2 71 π c 2 1 2 ξ 1 g b ξ o ξ 3 2 with 72 g b 1 4 f b and c 2 c 2 1 α 1 β integration of d y d ξ then gives 73 y 1 π c 2 ξ 1 1 3 g b ξ o ξ 5 2 y 1 h y with inversion to ξ there is the approximation 74 ξ y 1 π c 2 1 3 y 1 π c 2 3 turning to an expression for x in terms of ξ d x d ξ of eq 54 becomes 75 d x d ξ c 2 1 2 ξ 1 1 4 ξ log 16 ξ 1 2 ξ 1 f b ξ o ξ 5 2 leading to an approximation for x in terms of ξ 76 x c 2 ξ 1 1 3 g b ξ log 16 ξ 2 1 4 g b 3 36 ξ finally from eq 56 77 d x d y 1 π 1 1 4 ξ 1 1 4 ξ log 16 ξ 1 2 ξ o ξ 2 produces the approximation 78 d x d y 1 π log 16 ξ 1 2 ξ 1 1 4 ξ this term is negative near point b as expected from the free boundary shape from eqs 49 approximations for ϕ x and ϕ y are now 79 ϕ x 0 and ϕ y 0 ξ 1 3 2 point e for point e the ξ η plane of fig 3 b shows that it necessary to consider the two segments de and ae separately to analyse the behaviours of ϕ x on each segment both at x l 3 2 1 boundary segment de for segment de with ξ 80 d y d ξ a k 1 ξ ξ ξ 1 ξ a ξ b and 81 u k ϕ x k 1 1 ξ k 1 ξ from the first expression an approximation of 1 ξ in terms of y is to be found which is then inserted into a series expansion of ϕ x in terms of 1 ξ with similar treatment to that for points a and b 82 d y d ξ a π 2 1 ξ 2 g 1 ξ 3 o 1 ξ 4 g 1 3 4 1 2 a b which integrates to 83 y 1 a π 2 1 ξ 1 g 1 2 1 ξ o 1 ξ 3 y 1 h y and inversion approximation 84 1 ξ 2 y 1 a π 1 g 1 y 1 a π an expansion of 81 then gives the approximation 85 ϕ x 1 π log 16 ξ 1 2 π ξ 1 13 32 ξ which is then a function of a given y and can be used just below e 3 2 2 boundary segment ae for the segment ae with ξ 86 d y d ξ a k 1 1 ξ 1 ξ ξ a ξ b 87 u k ϕ x k 1 1 1 ξ k 1 1 ξ it is convenient to introduce ξ ξ and 1 ξ 1 ξ ξ1 with expansions in terms of 1 ξ 1 then 88 d y d ξ d y d ξ 1 a π 2 1 ξ 1 2 g 2 ξ 1 3 o 1 ξ 1 4 g 2 5 4 1 2 a b which integrates to 89 y 1 a π 2 1 ξ 1 g 2 2 ξ 1 2 o 1 ξ 1 3 y 1 y h and inversion approximation 90 1 ξ 1 2 y 1 a π 1 g 2 y 1 a π the approximation to ϕ x takes the same form as eq 85 91 ϕ x 1 π log 16 ξ 1 1 2 π ξ 1 1 13 32 ξ 1 then given y which provides ξ1 by eq 90 this expression can be used to approximate ϕ x just above e a rough approximation for either section de or ae independent of specific geometry involving a and b and following from the preceding equations is 92 ϕ x 1 π log h y this is a result found by liggett 1977 3 3 point b on side bc for ξ 1 near point b along side bc eq 10 with transfomations eq 14 provides 93 d y d ξ a k 1 ξ ξ ξ 1 a ξ b ξ defining ξ ξ 1 and proceeding in the normal way with series expansions followed by integration 94 h y a a 1 b 1 ξ 1 1 3 g 3 ξ log 16 ξ 1 18 3 4 g 3 ξ 3 2 with 95 g 3 5 4 1 a 1 1 b 1 there is no simple way of mathematically inverting this expression 94 to obtain ξ as a function of a given y but it is not difficult to do numerically from eq 50 the expression 96 ϕ x k 1 1 ξ k 1 ξ yields the approximation in terms of ξ 97 ϕ x π log 16 ξ 1 2 ξ 1 13 32 ξ 3 4 point a on boundary segment ae near point a on segment ae with ξ negative and ξ 0 eq 10 with transformations eq 14 provides 98 d y d ξ a k 1 1 ξ 1 ξ a ξ b ξ with definition ε ξ series expansions followed by integration produces the approximation 99 h y 1 4 c ε 1 1 2 g 4 ε log 16 ε 1 4 1 g 4 ε 2 with 100 g 4 3 4 1 2 1 a 1 b again eq 99 is not simple to invert mathematically but is so numerically to find ε for a given y the expression of eq 51 101 ϕ x k ξ 1 ξ k 1 1 ξ when expanded in terms of a series in ε becomes 102 ϕ x π log 16 ε 1 2 ε 1 13 32 ε 4 connecting the two analytical methods in her 1940 paper pk 1940 showed how the analytical solutions presented by davison 1932 and hamel 1934 could be transformed into her solutions this connection between the two solutions appears to be unknown in the non russian literature for example boast 1977 was evaluating hamel s solutions and towards the end of extensive supplementary information commented on the difference between hamel s solutions and pk 1962 solutions writing whether the discrepancy is due to in effect a great simplification in equations of hamel which has been made by polubarinova kochina and is due to an error in one or another treatment was not investigated nine years later boast 1986 reinforced this remark two analytical solutions are available for a dam with both faces vertical in one an elliptic function is used to transform the boundary of the flow medium into the hodograph plane to a straight line boast 1977 especially appendix a an apparently equivalent solution is much simpler in form polubarinova kochina 1962 there is also another closely related situation of seawater intrusion whose model can be formed by a simple transformation of the classical dam with no tailwater there is the work of henry 1959 1964 in the vein of hamel s work and more recently following pk 1962 the work of kacimov and obnosov 2016 which makes no mention of henry s work to the writer s knowledge there has been no further commentary on the differences and resolution of the two approaches when the tailwater exists both solutions use the same α β or b a but have different scaling constants to complete the connection between the two methods it is important to find the explicit connection between these constants here it shown how to do this something which pk did not demonstrate the main purpose of this exercise is to determine accurate solutions of the problem initiated by hamel and günther 1935 extended by muskat 1935 1937 and also done by pk 1940 where α 0 1 β 0 2 i e b 10 a 5 and the scaling parameter d 1 with results h l h 0 322 0 162 0 084 given by muskat with this connection between the two methods of solution and common usage of a and b the simpler method of pk can then be used for calculations the hamel expression for the base length l is given by 103 l d a b λ 1 λ λ a b λ e λ d μ k d λ d λ where 104 e λ e 3 2 π 0 1 γ s s λ d s γ s 2 arctan k 1 s k s μ k k 1 1 1 λ k 1 1 λ expressions for other side lengths of the dam and x and y coordinates take the same double integral form but with differing limits and all with d outside the integration davison 1932 1936 hamel 1935 muskat 1935 1937 crank 1984 in contrast to eq 103 there is the much simpler expression of pk eq 36 105 l a a b 1 ξ ξ 1 ξ a b ξ k 1 ξ d ξ the aim is to find a relationship between d and c 2 a a b now with the notation k k z and k k 1 z the differential equation for k wolfram 2022 is 106 z 1 z d 2 k d z 2 1 2 z d k d z 1 4 k 0 and the same equation for k replacing k a connection for the two solutions is the wronskian wolfram 2022 107 k d k d z k d k d z π 4 z 1 z which provides 108 d d z k k 1 k 2 k d k d z k d k d z π 4 z 1 z k 2 with this identity and the transformations 14 and 15 109 d d λ k 1 1 λ k 1 1 λ d d λ k 1 λ k 1 λ π 4 λ 1 k 2 1 λ the hamel integral now becomes 110 l d π 4 a b 1 λ λ 1 λ a b λ k 1 λ e λ k 3 1 λ d λ pk with the aid of work from davison s section of the book by khristianovich et al 1938 showed that 111 g e λ k 3 1 λ is independent of λ in the range a b more precisely she showed that e 1 3 λ k 1 λ is constant the 3 2 π in e λ becoming 1 2 π this was checked for various numerical values of λ and found to be true with the numerical value 112 g 0 258012 then by comparison with the pk integral 105 113 c π 2 a b g d the sought relationship this means that for given d then c is known and the pk solutions can be used to find accurate values of h l h as well as h 0 and hs for given a 1 β and b 1 α comparative numerical values are shown in table 1 for the solutions of hamel and günther 1935 with other authors results including the accurate solutions using eq 113 and pk integrals of section 2 4 pk assumed l 1 and calculated c 0 3580 compared with the accurate value of 0 358531 from eq 113 then took side ratio values as shown in the table according to footnotes in muskat 1935 1937 hamel provided muskat with the details of the hamel and günther paper before publication but muskat did not reproduce any of these results in his 1935 paper pk referenced and included in her 1940 paper the results of hamel and günther but made no reference to the work of muskat nor wyckroft and reid cryer 1976 has reported results from both hamel and günther muskat and wyckroft and reid but not pk 1940 the conclusions on relative accuracies are pk 1940 better than muskat 1935 slightly better than muskat 1937 and better than hamel and günther 1935 and the work of wyckroft and reid 1935 are on par with hamel and günther 1935 the results of pk 1940 better than hamel and günther and muskat suggest that evaluations of the single integrals in her analytical solutions are less prone to errors than the double integral representations of the davison hamel formulations muskat 1935 1937 provided another tailwater case with a 2 b 5 d 1 and 1935 results h l h h 0 0 6695 0 4439 0 15795 0 2019 compared with the new accurate results 0 677627 0 443053 0 168158 0 200689 there is a reasonable discrepancy in the h values possibly due to a muskat typographic error into the digital computer age boast 1977 provides an example with data a 2 b 4 95 d 1 and results l h h h h 0 h 0 653 0 250 0 295 compared with accurate values of 0 653136 0 249756 0 295125 a good confirmation of evaluations from the davison hamel method and the pk method for the seawater intrusion case equivalent to the zero tailwater case the linkage may be found by letting b in each of the two expressions for l in eqs 105 and 110 this produces the expression 114 c π 2 a g d and the integrand quantities b ξ 1 and b λ 1 a comparison of the four zero tailwater cases for different a values of muskat 1935 and accurate solutions using pk eqs 33 34 and 36 for respective calculations of h l h 0 and this new value of c with d 1 are given in table 2 5 calculation of analytical solutions the software required to evaluate the integral expressions of section 2 are numerical quadrature of integrals complete elliptic integrals of the first kind with real and complex arguments and algorithms for finding zeros the author uses double precision 14 significant figures fortran software from the nswc collection of routines morris 1993 dqags is used for gaussian adaptive quadrature and ck for the elliptic integrals with complex argument the latter routine has been tested for accuracy using quadrature of the integral expression for an elliptic integral eq 13 and comparisons with results from the arithmetic geometric mean approach for real argument abramowitz and stegun 1970 17 6 and complex argument morita and horiguchi 1973 the zero routines are initially required for finding α β from the pair of equations for l h and h h eqs 33 34 35 then c from any one of these equations this involves real arguments it is important to note that as l h increases and h h is fixed or increases then α 1 and β 1 and both parameters become difficult to calculate this trend is suggested by the last three entries of table 3 of section 6 2 calculations then may require the use of much higher than 14 significant figures precision within ω z is usually given from which ζ is to be found as in eq 16 which produces a pair of equations with complex arguments single equations with real arguments require ξ or η to be found from given respective x or y at points on the boundary also in the analytical expressions for points a and b in section 3 3 and 3 4 numerical inversions are required the software chosen for these zero finding equations is the iterative muller frank method muller 1956 frank 1958 mathews and fink 2004 for single equations extendable to paired equations fiziev and staicova 2011 this method converges almost as rapidly as the newton raphson method polynomial convergence order 1 84 2 but has the advantage of not requiring derivatives of functions moreover a crucial aspect is the solution of a quadratic equation which is suited not only to real coefficients but to complex coefficients the calculations performed in pk 1962 1977 were based on assuming values for α and β and then determining h l h h 0 assuming c 1 this assumption on c did not matter because tabulated values were presented based on ratios of lengths and the scaling constant c was then not involved the values of most interest presented in figures were coordinates of l h h 0 h and contours of h h coordinates h h h 0 h contours l h and q h h h contours l h computations are probably not better than three decimal places based on pk s 1940 results section 4 and her table 12 pk 1962 p 297 checked by keady et al 1988 this means that interpolating from her figures gives at best two to three significant digits other literature concerned with evaluating the pk solutions is rather meagre and is restricted to just the free boundary with seepage point height the best collection of results is that of hornung and kruger 1985 with tabulations of h 0 for ranges of h h 0 0 1 0 5 and l h 0 5 0 1 1 0 and also free boundary x and y values for h h l h 0 5 all results are given to six decimal places checked by the author and keady et al 1988 with just a few entries affected by rounding another set is by ridolfi 1995 with three decimal places for points on the free boundary and parameter ranges for h h 0 1 0 1 0 6 and h l 0 2 0 1 1 0 and 1 0 0 5 4 0 where there is overlap with the hornung and kruger values agreement is found some of the overlap parameters are noted in table 3 unfortunately ridolfi did not recognize the work of hornung and kruger and in return none of the publications in the list have recognized ridolfi neither of these two sets of results gave α β c values another source of six decimal place results is the monograph by elliott and ockendon 1982 who consider 24 16 4 and 3 22 1 62 0 84 giving free boundary values without α β c their values were checked and found correct and h 0 hs α β c values appear in table 3 bresciani 2012 extracted numerical method values from this work for 1 2 3 1 6 and recalculated free boundary values ignoring the correct values his results are not as accurate e g he gives 0 529409 compared with the true value 0 529413 for these two geometries liu et al 2022 calculated α β c specified at six decimal places using a random search algorithm but contained round off errors in some parameters the main function of this paper was to prepare a chart for determining α and β for given values of h h and l h but like the pk charts only two to three significant figures can be determined the only other works of interest are that of cryer 1976 and ozis in crank 1984 despite the quote from cryer in the introduction saying that the task of computer evaluation of analytical solutions is relatively simple cryer s calculations in his 1976 report are not very accurate his results for 24 16 4 are hs 12 7132 α 0 095126 β 0 465367 to be compared with accurate results of respective values 0 529413 24 12 705914 0 095284 0 465881 he also gives results for 0 322 0 162 0 084 of hs 0 204660 α 0 098554 β 0 199823 compared with the respective true values of 0 204385 0 098701 0 200904 according to crank 1984 pp 311 312 ozis used cryer s 1976 exact values of α β to obtain a seepage point height of 0 529459 x 24 12 7070 different from cryer s value apparently both cryer and ozis had difficulties with calculating either or both of complete elliptic integrals and numerical quadratures in the vein of pk s work of prescribed α β chapman 1957 used the work of muskat 1935 to present a chart for values of h 0 h and l h from prescribed values of a and b i e 1 β and 1 α leading to another chart to determine h h again only low order accuracies can be determined this way 6 survey of numerical methods there is a large literature on free surface problems not only for groundwater but also for other physical situations in both mathematical and numerical approaches the literature survey here is focused on just publications which have attempted to solve the classical dam problem with existing tailwater and which in principal can solve for ϕ thence numerically ψ ϕ x ϕ y in ω as well as on the boundary fig 2 shows the more than one hundred publications of numerical methods only accumulated with time from 1940 to the present the first numerical method paper was by shaw and southwell in 1941 using the hand calculated relaxation method for finite difference equations and not long after the first calculations of the davison hamel method in 1935 and the pk method in 1940 as discussed in section 4 the marked upturn in publication numbers in the 1960s and 1970s was driven by the availability of digital computers another factor sustaining the growth in numbers was the introduction of the variational inequality method by baoicchi in 1971 see e g cryer 1976 from which the numerical values for the dam problem were given first by commincioli et al 1971 and later impetus provided by the exposition of oden and kikuchi 1980 an even greater impetus was provided by the introduction of numerical methods already developed in other areas of applied sciences and engineering namely the finite element method e g cheng and li 1973 and boundary integral equation method e g liggett 1977 cryer s report of 1976 cryer 1976 is a good and detailed report of the mathematical and numerical status of the dam problem at that time within the focus on the classical dam problem a further restriction is made by examining how well numerical results have converged to true values thereby eliminating experimental results variable saturation and inhomogeneity although there are many numerical methods no discussion is devoted to their specific details nor superiority of approach instead methods are just represented by their abbreviations 6 1 abbreviations of methods bem boundary element method bi biot pore skeleton rigidity efm extended flux method epm extended pressure method fdm finite difference method fem finite element method fn fracture network approach fvm finite volume method hv hadamard variation iv interchange of variable lp linear programming lsm level set method mfs method of fundamental solutions nem natural element method nmm numerical manifold method odd overlapping domain decomposition pso particle swarm optimisation rbf radial basis functions sa simulated annealing so shape optimisation sph small particle hydrodynamics t transience tcf thiele continued fractions trm trefftz method vfm virtual flux method vib variational inequality method of baiocchi vnm virtual node method these abbreviations are selected for a particular publication as the most important component of solution even though more than one method may be involved for example aitchison 1977 contains a fdm extension of her earlier work aitchison 1972 but the main part of her paper is vib with fem moreover the classical problem may be the limit of a more general setting such as passing from transience to steady state or for a biot porous skeleton passing from a flexible to a rigid structure finally a general grouping of methods may be made in more traditional form of those with components satisfying exactly laplace s equation and approximating boundary conditions as in bem mfs and trm and the remaining and larger grouping which satisfy approximately both laplace s equation and boundary conditions designated as galerkin methods 6 2 numerical values for various geometries some 17 different h l h geometries have been used within the collection of numerical methods table 3 displays the pk α β c parameters for each h l h and the calculated seepage heights h 0 and hs using equations from section 2 the four references cited contain either h 0 values and or values along the free boundary they have been used as a check on accuracies no use has been made of the values of ridolfi 1995 in any of the cited publications following this table each geometry is considered in the same order as in the table for the accuracies of results from the numerical method works associated with each geometry the geometrical groups take the extended form h l h hs it is also worth mentioning that the logarithmic gradient behaviours at points a b and e have not been acknowledged let alone used by any of the publications except those of aitchison 1972 1977 for point a and liggett 1977 for point e 6 3 geometry 24 16 4 12 705914 of all geometries used in numerical method examples this is by far the most commonly used table 4 displays the seepage height hs by author and abbreviated method in some cases there are different methods and different geometries within the same publication authors bruch 1980 1988 hsiao et al 2004 and shahrokhabadi et al 2016 all use a comparative value of hs 12 95 deduced from the contour plots from pk 1962 a value which is not possible to determine to this accuracy in terms of truncating values the most accurate result is 12 72 achieved by aitchison 1977 and thatcher and askew 1982 a value which has not been bettered nor equalled in later publications with this or any other geometry despite great improvements in computer memory and speed the less stringent accuracy to rounded decimal places at a maximum of three was achieved by these previous authors plus andrab et al 2017 chen et al 2007 frolkovic 2012 fukuchi 2016 hsiao et al 2004 and shahrokhabadi et al 2016 there are additional publications in which no seepage point values were given but in most cases a calculated free boundary was displayed bermudez and durany vib 1988 chantasiriwan bem 2011 cheng and li t 1973 cividini and gioda fem 1989 2000 dai et al fem 2019 desai and baseghi fdm 1988 elliott and ockendon vib 1982 finnemore and perry fdm 1968 jiang et al odd 2005 ku et al t 2019b maione and martinole fem 1992 morland and geoda fem 1990 noseda fdm 1961 shahrokhabadi and toufigh nem 2013 sharma et al fem 2021 shaw and southwell fdm 1941 southwell fdm 1946 torabi and tajrishi fem 2000 wei et al fn 2021 westbrook vib 1985 xiao et al mfs 2017 yuan and zhong fem 2016 zhang and jiang vib 2012 zhang et al vib 2005 even though accurate values for free boundary locations and seepage point are in elliott and ockendon 1982 only bermudez and durany 1988 have made a comparison with these free boundary values but in their case have not determined the seepage height 6 4 geometry 3 22 1 62 0 84 2 043853 this geometry is an altered version of the original problem considered by hamel and günther 1935 and muskat 1935 there they set α 0 1 β 0 2 and found approximate values for h l h hs the accurate values determined in section 4 table 1 are respectively 3 18414 1 59863 0 83815 2 02361 in muskat 1937 the approximate values became 3 22 1 62 0 84 and an hs 2 06 these values of h l h then became the standard geometry and the accurate value of hs 2 043853 determined by eliott and ockendon 1982 became the key comparative value some authors call the dam problem of this geometry the muskat problem unfortunately due to a typographic error in the software users manual of galavi 2010 0 84 became 0 48 and several papers based their calculations on this number for the first value of 0 84 only commoncioli et al vib 1971 provide seepage point heights of 2 0611 and 2 0684 for two different grid geometries free boundary values were also provided all other papers with free boundary curves and no seepage height value are baiocchi et al vib 1973 chakib et al so 2002 chakib et al so 2003 chakib and nachaoui t 2005 nazemi et al lp 2008 othman et al hv 2010 othman et al vib 2011 suzuki and tsuchiya vib 2005 suzuki and tsuchiya bem 2011 craig and wood vib 1981 just gave written assurances that three decimal place accuracy was achieved at the free boundary for the value of 0 48 all publications now listed gave free boundary curves but none gave numerical values for them nor seepage point heights culebra and lópez querol fem 2012 galavi fem 2010 lian et al sph 2021 lópez querol et al bi 2011 navas et al bi 2014 navas et al bi 2016 6 5 geometry 10 5 5 6 623820 analytical numerical values are available for the free boundary and seepage height by hornung and krueger 1985 and given in their table 3 one other paper was found for this geometry it was by aharmouch and amaziane fem 2012 and graphically compared results with the accurate free boundary but provided no seepage point height 6 6 geometry 10 5 2 6 344551 the papers in this group are as follows ahmadi fem 2021 ahmadi et al t 2016 ahmadi et al efm 2018 ayvaz and karahan fdm 2007 ayvaz et al fdm 2005 bardet and tobita fdm 2002 bazyar and graili bem 2012 borja and kishnani fem 1991 çalamak et al fdm 2012 cheng and tsui fem 1993 darbandi et al fvm 2007 dou et al fem 2017 herreros et al lsm 2006 ji et al epm 2005 jie et al nem 2013 jun and liu vnm 2011 kazemzadeh parsi fem 2019 kazemzadeh parsi and daneshmand fem 2012 lacy and prevost fem 1987 liu et al fem 2018 navas and lópez querol bi 2013 oden and kikuchi vib 1980 peng et al sph 2015 rafiezadeh and ataie ashtiani bem 2004 sun et al nmm 2021 wang et al nmm 2014 yang et al nmm 2019 zhao et al lsm 2022 although graphical displays of the free boundary calculations were given comparisons were made with other results in the same group no numerical values were given for hs 6 7 geometry 10 10 n 1 2 2 5 3 4 5 6 the results from lee and leap fdm 1997 for hs with accurate values in braces are the following 10 10 1 3 85 3 446153 10 10 3 4 35 4 268554 10 10 4 4 85 4 740819 10 10 5 5 45 5 362427 cividini and geoda fem 1984 jun et al vfm 2019 li et al fem 2003 as well as navas and lópez querol bi 2013 considered 10 10 2 with a free boundary curve but no numerical values for 10 10 3 karageorghis mfs 1992 gave hs 4 273 a result on par with the best of the 24 16 4 group there is also liggett bem 1977 toufigh fem 2016 and wu et al bem 1996 with a free boundary curve but no numerical values given three final publications with free boundary curves but no numerical values given are 10 10 2 5 by gioda and gentile fem 1987 10 10 4 in niwa et al bem 1976 and 10 10 6 considered by cividini et al fem 1987 6 8 geometries miscellaneous these are the geometries at the bottom of table 3 all of the few publications provide free boundary curves but most give no values for seepage heights listing these first there are 20 5 4 wu et al fem 2013 1 6 1 0 0 6 marini and pietra vib 1986 6 5 1 kealy and williams fem 1971 10 20 3 cheng and li t 1973 21 25 26 56 1 37 szabo and mccaig fdm 1968 19 7 24 56 1 3 france et al fem 1971 szabo and mccaig 1968 compare their results with those from a private analogue computer they are later used for comparison by france et al 1971 for which analytical values for hs are similar and not given here those that do provide seepage height values with accurate values in braces are 10 20 3 bruch et al bem 1986 3 21 3 231934 and isaacs fem 1979 8 28 6 427580 6 9 geometry of leontiev and huacasi leontiev and huacasi bem 2001 is the standout paper from those in the preceding groups because it follows the procedure set out by pk 1962 of choosing α β c and determining the geometry from them these authors quote the pk expressions for h l h h 0 and evaluate the integrals with α β c 0 3 0 9 1 to obtain 6 3014 6 1592 1 2359 1 2868 in contrast the accurate values are 6 309053 6 164005 1 236991 1 2868235 the respective values of hs are 2 5225 2 523814 their bem results were compared with free boundary values excluding hs and were correct to two significant figures chaiyo et al mfs 2011 used the h l h h 0 values of leontiev and huacasi to compare free boundary curves no numerical values were given finally fukuchi fdm 2016 with the same approximate geometry found a value of hs 2 5391 6 10 interior values many of the publications have provided contours of ϕ throughout ω but only shaw and southwell fdm 1941 with pressure ϕ y and rushton and redshaw fdm 1979 provide numerical interior values for other quantities a handful have provided contours without numerical values flownets chaiyo et al mfs 2011 bardet and tobita fdm 2002 cividini et al fem 1987 fukuchi fdm 2016 and lacy and prevost fem 1987 pressure curves bermudez and durany vib 1988 darbandi et al fvm 2007 shaw and southwell fdm 1941 also southwell fdm 1946 and torabi and tajrishi fem 2000 and velocity fields directed by arrows bermudez and durany vib 1988 chaiyo et al mfs 2011 chung and kikuchi fem 1987 frolkovic lsm 2012 and navas et al fem 2014 on the headwater and tailwater boundaries niwa et al bem 1976 provided curves of ϕ x the preceding publications do not provide numerical values for their contours apart from shaw and southwell 1941 and the less accurate rushton and redshaw 1979 and their accuracies are not known a summary of this survey is that the measures of accuracy of these publications are mostly imprecise relying on the comparisons of different authors results for the free boundary curves in most cases the height of the seepage point hs has not been given but when this precise measure has been given it has not been bettered than the almost four decimal place accuracy achieved in 1977 and 1982 the interior results discussed in the previous paragraph are with two limited exceptions without numerical values for accuracy assessment 7 numerical tables and contour plots 7 1 numerical tests for software apart from comparisons with existing results for six decimal place values of α β c and hs already found by others namely elliott and ockendon 1982 hornung and krueger 1985 and mason 1985 there are several checks that can be made with analytical expressions there is the identity of eq 48 for flux rate q h involving the expression of charny 1951 and an integral dependent on α β c the equation q h q h q h 0 and the equivalence of the two different expressions for base length l from eqs 31 and 34 these all involve a check on software for numerical quadrature real argument elliptic integrals and zero finding for α β c in all three tests a minimum of eight significant figures was achieved the least accurate process being that of determining α β c another check for the same software but with complex argument elliptic integrals involves following a regional path integral as discussed in section 3 and depicted in figs 3 a and 3 b the integrations on the paths apqr in both figures produce a value at the boundary point r of x 0 31263024 when ξ 3 for the geometry 1 2 3 1 6 hs 0 52941308 and α β c 0 09528383 0 46588128 0 20609228 this is verified with the boundary integral of eq 25 and real argument elliptic integral based on these analytical checks for their numerical values all other calculations are assured of at least eight significant figures 7 2 numerical values based on the shaw and southwell grid the choice of exhibiting numerical results for the geometry 24 16 4 or its scaled form used for figs 3 a and 3 b is explained in the introduction and supported by the details of section 6 3 here all results are based on this scaled geometry of 1 2 3 1 6 shaw and southwell 1941 divided the dam domain into a grid of squares 24 vertically and 16 horizontally limited by the free boundary and provided values of the scaled pressure p at the grid points here the same grid is chosen and calculations are made for the analytical expressions of ϕ ψ ϕ x ϕ y and p given in section 2 1 all numerical values are based on x and y coordinates of fig 1 with increments 1 24 24x 0 1 2 3 16 24y 0 1 2 3 24 due to space limitations the x coordinates are reduced to 24x 0 2 4 16 in the tables which are given in the appendix with a prefix a before the table number however the full range of x values are given in the supplementary material and are used in constructing contour plots the tables all have six decimal place values the extensive and important tables underpinning the contour plots of figs 3 a 3 b and those for ϕ ψ p ϕ x ϕ y to come are placed in an appendix to provide easier reading of the text the tables are now designated tables a6 a12 rather than tables 6 12 essential to all values of functions at the grid points are the values there of ξ and η which are given in tables a6 and a7 in fig 3 a contours for constant values of ξ and of η are displayed at x y coordinates and in fig 3 b there are contours for constant x and y for coordinates ξ η these contours are obtained by path tracking at constant values along paths in contrast the contour plots for the quantities ϕ ψ ϕ x ϕ y and p are based on interpolations from grid points using the public domain software gnuplot williams kelley et al 1993 fig 4 displays contours of ϕ at levels 0 2 0 05 0 95 and orthogonal ψ at levels 0 05 0 05 0 7 with an additional top boundary value of ψ 35 48 0 729167 from eq 47 scaled by 24 the supporting tables for these figures are table a8 for ϕ and table a9 for ψ in addition to these tables boundary equations from section 2 were used to locate coordinates of contour values in fig 5 contours are shown for scaled pressure p linked to ϕ by eq 9 at levels 0 05 0 05 0 9 and an additional level 0 025 just below the top boundary the supporting grid values are derived from ϕ grid values of table a8 and given in table a10 fig 1 drawn to scale of the geometry 1 2 3 1 6 with accurate boundary curve ab and the contours of figs 4 and 5 bounded by the dam perimeter as well as all other contour plots below appear benign however gradients show considerable variations as the points a b and e are approached as already pointed out in section 3 this is born out by fig 6 for ϕ x with contour levels 0 05 0 05 2 1 and supporting table a11 and levels of 0 05 0 05 1 00 for ϕ y in fig 7 and supporting table a12 as point e is approached from all directions the contour spacings diminish in order to complete the contours for ϕ x a finer x y grid was created between 24x 13 and 16 and between 24y 0 and 6 by decreasing the grid increments eightfold to 1 192 this increased density of data is given in the supplementary material this high variability of gradients is also to be expected when examining fig 3 a the combination of ϕ x 2 ϕ y 2 1 2 as equivalent velocity magnitudes are isotachs exemplified by anakhaev 2016 in a real dam isotachs may be useful to predict regions of internal erosion an important set of values not presented in the preceding tables are those off the grid values on the free boundary ab table 13 gives values at x 0 1 2 16 24 for y ξ ϕ x ϕ y d y d x and normal angle ν all calculations are based on section 2 these values are useful for comparison of results from numerical methods in the important step of finding the free surface values 7 3 local behaviour near points a b and e in section 3 analytical expressions were given for gradients driven by ϕ x near points a b and e two sets of results for each point relating to the boundary segments forming each point these are now used in the construction of graphs and numerical tables fig 8 displays curves of ϕ y ϕ x and their ratio d y d x along ab the main features are already seen in papers by boast 1977 with geometry 0 653 0 250 0 295 and liu et al 2022 with geometry 24 16 0 for similar curves and by aitchison 1972 keady et al 1988 and pk 1988 for analysis near a more detailed analytical expressions near both end points a and b are given in section 3 1 and numerical values are given in tables 14 and 15 fig 9 shows curves for ϕ x along side cd and ϕ x along side segments ae and de similar curves were presented by anakhaev 2016 and muskat 1935 for the approximate geometry 0 3223 0 1619 0 0842 the approximation discussed in section 4 and also with the bem numerical approach by niwa et al 1976 with geometry 10 10 4 the analysis of section 3 2 provides the basis for numerical values of table 16 as point e is approached from above along ae and below along de both tabular values and plots show that although gradients approach due to logarithmic behaviour there is no symmetry of values about the line y 1 6 this asymmetry also exists in the ξ values for x y coordinates of table 6 near point a the curve of the gradient is relatively flat for moderate distances as supported by the analysis of section 3 4 and values of table 17 similar behaviour occurs near point b following from the analysis of section 3 3 and values in table 18 in making these calculations from analytical solutions at particular values of coordinate ξ and associated x or y values the limit of numerical quadratures for the true solutions is reached the analytical approximations of section 3 are then used to complete the curves as the critical point is approached 8 concluding remarks the large collection of numerical methods applied to the dam problem has been surveyed for accuracy of complete results for potential and stream functions and orthogonal potential gradients ϕ ψ ϕ x ϕ y on the boundary and interior of the dam although interior contours have been given for pressures flownets and velocity fields in a handful of publications there is an almost total lack of numerical values the best example for convergence to an exact seepage point height above the tailwater with close to four decimal place accuracy was achieved in 1977 equalled in 1982 and since then neither superseded nor equalled despite subsequent massive increases in computer storage and speed the existing analytical solutions have also been surveyed for numerical values for the complete set of functions ϕ ψ ϕ x ϕ y the initial calculations for side lengths and seepage points in 1935 by the davison hamel method and in 1940 by the pk method achieved 2 3 decimal place accuracy it was not until the 1980s that a few calculations were made to 6 decimal places but in none of these calculations were values given for ϕ ψ ϕ x ϕ y in the interior nor for quantities unspecified on the boundary and even with these values little use was made by authors of numerical methods to check their accuracies the important link between scale constants of the davison hamel and pk methods has been found with the implication that theoretical work based on the davison hamel approach is much easier with the pk approach for example the analyses provided for gradient behaviour near the three critical points of free boundary entry and exit and intersection of seepage face and tailwater is not obvious with the davison hamel method another useful result for the linkage is that it holds for the case of no tailwater where the original model can be converted simply to the important case of seawater intrusion and the two different methods by davison hamel and pk have remained unconnected until now in summary the main aim of this paper has been achieved new numerical values have been presented as a benchmark for any of the applicable numerical methods as a challenge to demonstrate convergence to an accuracy greater than that which prevails so that a method can then be used more confidently with other free boundary problems which do not have analytical solutions declaration of competing interest the author declares that he has no known competing financial interests or personal relationships that could have appeared to influnence the work reported in this paper acknowledgements the author gratefully acknowledges the assistance given to obtain some reference material oscar castro orgaz annamaria cividini anvar kacimov and the hydrologic institute of leningrad to obtain davison 1932 john knight marc robinson and jack sharp the suggestions by reviewers for inprovement in clarity of presentation is also appreciated supplementary materials supplementary material associated with this article can be found in the online version at doi 10 1016 j advwatres 2022 104356 appendix b supplementary materials image application 1 appendix tables for interior grid values numerical values of ξ η ϕ ψ p ϕ x ϕ η are presented in the following tables based on a rectangular grid 24 16 height x width of equal intervals 1 24 in the x y plane with top cut by the free boundary for the geometry 1 2 3 1 6 in table a6 the value of ξ is presented at 16 24 4 24 corresponding to point e the top of tailwater as just above e the value of ξ is just below it however exactly at e the value has been numerically calculated as ξ 3 53 fig a6x in the supplementary material shows curves indicating this value in this table are four decimal place values derived from shaw and southwell 1941 who multipled their original decimal place values by 6000 to produce integer values with savings of printed space two typographical errors were found in this data modified here at coordinates 7 24 10 24 where 589 should probably be 389 and at 13 24 3 24 1303 should probably be 1503 pk 1962 p 442 copied this data including the two errors but omitted the data in her 1977 book pk 1977 due to space limitations the y coordinate values also have been reduced to 24y 0 2 4 24 however the tabular values for complete x and y grid values are given in the supplementary material 
31,dissolution of porous media induces positive feedback between fluid transport and chemical reactions at mineral surfaces leading to the formation of wormhole like channels within the rock wormholes provide highly efficient flow and transport paths within rock and as such understanding their formation is critical for controlling contaminant migration or preventing co 2 leakage during geological carbon sequestration here using time resolved x ray tomography we capture the dynamics of wormhole propagation inaccessible by standard experimental methods we find a highly non trivial relationship between wormhole advancement and variations in permeability of the rock with extensive periods of steady advancement not reflected by significant change in permeability this is in contrast to most existing conceptual models where wormholes advance in a linear fashion we show that this is caused by the presence of highly cemented regions which act as barriers to flow as confirmed by multi scale analysis of the pore geometry based on tomographic ultra small angle neutron scattering and optical microscopy measurements these results demonstrate that time lapse captured wormhole dynamics can be used to probe the internal structure of the rock keywords reactive flow limestone dissolution permeability 4d x ray microtomography data availability codes and raw as well as processed data are available at https doi org 10 5281 zenodo 7558135 raw tomographic data are available at https doi org 10 5281 zenodo 7683242 1 introduction wormholes are intricate ramified channels formed due to dissolution of a soluble rock within a range of chemical and flow conditions wormholes were first described by petroleum engineers rowan 1959 who injected acid into oil wells to increase reservoir permeability allowing oil and gas to migrate more readily a more detailed investigation of this process followed usually accompanied by flow through experiments in rock cores and fractures daccord 1987 hoefner and fogler 1988 fredd and fogler 1998 buijse 1997 golfier et al 2002 detwiler et al 2003 mcduff et al 2010 li et al 2019 recently understanding of wormholing became important when assessing and mitigating the risk of leakage from potential co 2 sequestration sites particularly in limestone formations ott and oedai 2015 snippe et al 2020 luquot and gouze 2009 garcia rios et al 2014 2015 smith et al 2013 hao et al 2013 steefel et al 2013 elkhoury et al 2013 selvadurai et al 2017 al khulaifi et al 2019 carbon dioxide when mixed with water becomes aggressive and can dissolve carbonate seams or veins in the cap rock creating co 2 escape conduits during the sequestration process in addition to their practical importance wormholes are impressive examples of a pattern forming system driven by a strong nonlinear coupling between flow rate reactive transport and evolving geometry of channels at the large scale wormholing processes play a major role in the formation of cave passages and karst conduit networks szymczak and ladd 2009 surface karst features such as solution pipes lipar et al 2021 but also melt migration daines and kohlstedt 1994 aharonov et al 1995 kelemen et al 1995 spiegelman et al 2001 terra rosa formation merino and banerjee 2008 and dolomitization koeshidayatullah et al 2021 similar phenomena are involved in the formation and evolution of other branched structures including leaf venation river networks and even vascular systems fleury et al 2013 the growth of wormholes is usually shielded from our eyes due to rock mass surrounding the structure the first studies of wormholing were then limited to observing the openings at the inlet and outlet side of the sample where the channels emerged a step forward was to cast wood s metal into the formed wormhole use tomographic imaging techniques or a combination of the two daccord 1987 daccord and lenormand 1987 hoefner and fogler 1988 this allowed the visualization of the final network of wormholes formed in a rock as a result of acidization although the understanding of the growth dynamics was limited to measuring change in pressure permeability over the sample through the experiment these studies established that the geometry of the wormholes strongly depends on the flow rate of the fluid that etches the rock hoefner and fogler 1988 fredd and fogler 1998 daccord et al 1989 golfier et al 2002 cohen et al 2008 at relatively low flow rates typically one bulky wormhole forms within the sample this type of wormhole is conical in shape tapering towards the downstream end at higher flow rates wormholes become thinner and more tortuous with a clear dominant flow path through the sample finally at high injection rates wormholes become more ramified with a network of alternative flow paths spanning the sample uniformly alas these studies did not reveal the dynamics of the wormholing process itself beyond measuring macroscopic permeability evolution building on the use of x ray techniques a way forward here is to use time lapse 4d tomography which requires placing the reactive flow core holder inside a tomograph the pioneering study of this kind was performed by bazin et al 1996 however due to technology of the time acquisition times were long compared to wormhole growth thus imaging was limited to only a few low resolution 2d scans i e radiographs through the sample recently this technique has been used more frequently for wormhole studies ott and oedai 2015 al khulaifi et al 2019 menke et al 2018 snippe et al 2020 although with limited time resolution 30 min and usually only a few 3d scans per experiment by finding a compromise between the resolution and acquisition time we are able to make a detailed time resolved study of growing wormholes with as many as 130 supplementary material sec 1 scans per experiment and scan times down to five minutes this has given us an unprecedented insight into the progressive development of wormholes through the sample it is worth mentioning that the dynamics of dissolution process can also be studied with another non invasive method nuclear magnetic resonance nmr muljadi et al 2018 oliveira et al 2021 elsayed et al 2023 nmr studies allow for the measurement of the displacement of water molecules associated with the flow through the porous rock in this way one can quantify the evolving flow in a dissolving sample 2 materials and methods to interpret wormhole propagation through limestone cores we employ 4d tomography image processing a simplified numerical model and rock characterization with thin sections and scattering techniques small and ultra small neutron scattering this section provides a summary of experimental methods full details of methods employed such as image analysis and the numerical model are presented in appendix a 2 1 rock description and preparation the rock used in this study is pinczów limestone a local variety of the wider ranged leitha limestone obtained from a quarry in podłȩże poland pinczów limestone has well described facies studencki 1988 and petrographic and mechanical properties figarska warchoł and stańczak 2019 the variety of pinczów limestone from this location corresponds to type 100 as described by figarska warchoł and stańczak 2019 pinczów leitha limestone is of middle miocene age and has undergone little diagenesis limited to cementation and in some regions recrystallization of calcite due to limited diagenesis it has high primary porosity ca 25 35 and permeability for a limestone it is a packstone with grains dominated by foraminifera as well as echinoid spines and mud consisting of calcite and approximately 10 insoluble minerals solubles consist of approximately 60 clay and cement and 40 grains with sizes ranging from 5 μ m up to several millimeters mean grain size for the dominant grains foraminifera is 0 5 mm of note horizontal laminae and recrystallized 1 mm thick zones parallel to bedding were observed by figarska warchoł and stańczak 2019 for dissolution experiments cores 38 3 mm in diameter were prepared on a drill press using a coring bit cores used in dissolution experiments were scanned with high resolution x ray tomography before each experiment for further characterization one core was first imaged with x ray tomography at a resolution of 30 μ m followed by thin sectioning at 10 20 30 35 50 60 70 and 80 mm from a core face an additional axially oriented thin section was prepared from 0 40 mm details of thin section analysis methods are presented in a 3 samples were also prepared for ultra small angle neutron scattering u sans by crushing and sieving grains in the range 0 178 r 0 213 mm where r is the grain radius u sans measurements were performed using the sans instrument d11 and usans instrument s18 at the institut laue langevin grenoble details on u sans measurements are given in a 4 2 2 time lapse dissolution tomography experiments dissolution experiments were performed on limestone cores with the classic core flooding apparatus a 2 e g fredd and fogler 1998 the core holder used phoenix instruments supports cores 38 3 mm diameter and up to 140 mm in length the core in the experiment presented here is 115 mm long dissolved with 0 25m hydrochloric acid at a flow rate of 1ml min prior to dissolution this core was scanned at a resolution of 30 μ m during the dissolution experiment time lapse 4d tomography was performed on the dissolving core at 169 μ m resolution so chosen as to balance acquisition time and the ability to pick out the advancing tip of the wormhole details on how this value was chosen is presented in a 2 and supplementary material section 3 at this spatial resolution the imaging time is ca 5 min pressure drop across the cell was logged at an interval of 10 s an additional benchtop experiment showing characteristic pressure drop over time for pinczów limestone is shown in supplementary material sec 1 along with another 4d experiment performed on the combined neutron and x ray tomography next instrument at institut laue langevin grenoble in the additional 4d experiment 126 4d scans were taken of a dissolving 58 7 mm long core with a voxel size of 43 5 μ m and a temporal resolution of 7 min 20 s the acid used in this experiment was 0 1m hcl dissolved in d 2 o and the acidization flow rate was 0 5 ml min processing of static high resolution tomography and dynamic 4d imagery is detailed in a 3 along with processing of thin section imagery 3 results 3 1 4d tomography and permeability evolution fig 1 and associated videos s1 and s2 shows wormhole development in five minute scanning increments with a 169 μ m voxel resolution the wormhole shown here was formed in a core taken perpendicular to bedding of the relatively porous pińczów limestone primary porosity ca 25 35 figarska warchoł and stańczak 2019 from pińczów poland flushed with 0 25m hydrochloric acid at a flow rate of 1 ml min at such a flow rate a single wormhole forms in a sample in which most of the flow focuses it is the so called dominant wormhole regime according to the classification of fredd and fogler 1998 with the extent of the wormhole controlling the permeability of the sample the wormhole progress is highly nonuniform with a number of jumps branchings and sudden changes of direction what is however more intriguing is the apparent lack of correlation between the position of the tip and the changes of the permeability of the sample the latter is measured by the pressure curve fig 2 representing the pressure needed to pump fluid through the sample at a constant flow rate at which the experiment is carried out the pressure curve shows long plateaus interspersed with step like pressure decreases interpretation of this behavior is not straightforward the simplest but frequently used model of wormhole evolution argues that due to the high permeability of a wormhole the pressure drop along its length is negligible daccord 1987 daccord et al 1993 hill et al 1995 li et al 2019 following this and assuming that the rock in front of the wormhole tip is homogeneous hydraulic resistance of the rock core should drop linearly with the length of the wormhole r l z where z is the length of the wormhole and l is the total length of the system an immediate consequence of this model is that pressure should decrease linearly with the advancement of a wormhole δ p δ p 0 1 z l with δ p 0 standing for an initial pressure drop through the sample however fig 2 shows that this is not the case for our system during pressure plateaus the wormhole tip progresses noticeably with a nearly constant velocity such a behavior has been reported in only a few previous wormhole studies bazin et al 1995 izgec et al 2010 with the response being attributed to vugs where pressure drops are associated with wormhole vug intersection izgec et al 2010 pińczów limestone however is not vuggy figarska warchoł and stańczak 2019 and as such we seek another explanation for this effect we argue that such a behavior might be attributed to the presence of regions of very small porosity within the sample such regions restrict the flow and effectively act as permeability barriers using analogy with the flow of electric current the rock core would then resemble a circuit of resistors connected in series with regions of small resistance interspersed with regions of very high resistance if such a system was measured by an ohmmeter the net resistance would be overwhelmed by high resistance regions only when the wormhole tip reaches high resistance regions and begins to etch its way through them the permeability of the core changes in a noticeable manner 3 2 toy model the mechanism of permeability variations can be demonstrated using a simple model of porous medium of porosity φ 0 which contains bands of much smaller porosity φ 1 marked by light yellow bands in fig 3a we also introduced a small region of very high porosity near the inlet of the sample marked by a red rectangle to trigger wormhole formation at this point we then let the system dissolve using the numerical model described in a 5 and record the advancement of the tip and evolution of the pressure drop in time fig 3b shows marked similarities with the analogous results for the experimental system including long pressure plateaus during which the tip of the wormhole advances considerably interestingly and somewhat surprisingly the model calculations predict acceleration of the growth rate as the wormhole tip penetrates the impermeable layers in the model the cause of this is that within a packed layer it is harder for the wormhole to broaden because there is more mineral matter to dissolve around the perimeter petrus and szymczak 2016 a thinner wormhole results in higher flow velocities within it in turn leading to a larger propagation velocity of the wormhole tip 3 3 rock properties based on the 4d tomography results fig 2 and theoretical considerations fig 3 several questions arise what is the real bulk pore grain geometry of the sample are there any large scale structures that can block flow paths if so do such structures correlate spatially with the wormhole tip position jumps to address these questions an analysis of pore grain structure was performed on length scales between 8 nm and 1 cm combining ultra small angle neutron scattering u sans a 4 and image analysis of the tomography results obtained prior to the dissolution experiment a 3 fig 4 analysis of the smallest length scales used u sans to determine the pore size distribution neutron scattering data shows an approximate power law distribution linear in log log space of pore radii f r r β with β 3 12 0 2 in the size range between 8 nm 4 μ m this indicates an approximate self similar pore structure with the fractal dimension d f β 1 2 12 radlinski et al 2004a anovitz and cole 2015 for r 4 μ m the deviation from the power law is likely due to multiple scattering ji et al 2022 hence this range is excluded from the power law fit to quantify the larger 30 μ m pore and grain architecture in the sample we calculated the grayscale autocorrelation function on the tomographic data of the pre dissolved sample defined as 1 acf l g r l μ g r μ r g r μ 2 r where g r is a grayscale value at point r within a sample and r denotes averaging over r finally μ g r r is the average grayscale value while computing acf l we average over different orientations of the vector l which gives a scalar dependent function acf l further details of the computation of the autocorrelation function are given in appendix a 3 1 the autocorrelation function approach has previously been used to characterize the pore space by first segmenting pores from grains katz and thompson 1985 in this work however we utilize the grayscale values of the images to capture both pores and the potential source of permeability barriers the grains remarkably for a wide range of radii 100 μ m 1 mm the autocorrelation function also shows a power law behavior l α with an exponent α 0 8 0 01 fig 4 as it turns out the power law behavior of the autocorrelation function again implies fractal pore space geometry however the link between the exponent and the fractal dimension is now different d f 3 α katz and thompson 1985 remarkably for our sample it again gives d f 2 2 autocorrelation data from the experiment performed at institut laue langevin supplementary material fig 4 exhibit a similar power law behavior with d f 2 14 these values are very close to the fractal dimension estimated form the neutron scattering data d f 2 12 we can then conclude that combined u sans and acf data show a self similar structure over a remarkably wide range of five orders of magnitude in pore sizes 8 nm 1 mm however as seen in fig 4 at r 1 mm there is a transition to a different scaling behavior prevalent in the mm and cm range the crossover to higher correlations indicate the presence of large structures presumably fossil grain assemblages on the scale of 1 10 mm this is in full agreement with petrographic analyses of this rock type which report horizontal laminae and recrystallized 1 mm thick zones parallel to the bedding figarska warchoł and stańczak 2019 to determine if such large scale structures could be the permeability barriers postulated in our model fig 3 we calculate the average grayscale intensity for successive slices perpendicular to the core bedding axis using a high resolution 30 μ m voxels tomographic image of the core prior to dissolution taken outside of the core holder full image processing information described in a 3 in x ray tomography image intensity represents the attenuation of matter to x rays which is proportional to its atomic number and density therefore pixels of higher intensity correspond to regions with higher solid fraction or minerals with higher atomic numbers for a rock dominated by one mineral as is pińczów limestone a higher average intensity corresponds therefore to a higher grain density and thus lower porosity the data presented in fig 5c show quantifiable peaks as determined by an automated peak detection algorithm virtanen et al 2020 where average grayscale is higher than for the bulk of the rock when wormhole tip displacement is juxtaposed with the average grayscale diagram one notes that the wormhole propagation velocity increases in the peak regions otherwise maintaining a steady velocity in the bulk of the rock fig 5d this supports our hypothesis that wormhole propagation rate is controlled by the permeability barriers within the sample while a peak at z l 0 1 does not necessarily correlate to acceleration in the tip position and the acceleration at z l 0 7 does not seem to be correlated with a peak these two features are relatively narrow and thus the respective correlations might be harder to detect naturally projecting the grain content information on z axis as performed in fig 5c considerably smears out the data on the 3d configuration of pores grains and positions of the microcementation regions as a result the overall variations in the grain content remain relatively small on the level of a few percent this is much smaller than the ones used in the toy model of fig 3 when the porosity in the cemented regions was 10 times smaller than that in the bulk of the rock since both the pressure drops and the wormhole speedups recorded during the experiment are substantial fig 2 we conclude that the wormhole tip does encounter local highly cemented structures that it needs either to navigate around or dissolve its way through the coarse projection of fig 5c succeeds in picking up the most extended of these regions but as already mentioned misses a thinner one at z 0 7 as marked in fig 2 finally to investigate what rock textures correspond to the regions of permeability barriers we analyze thin sections taken from another core of the same rock eight perpendicular and one parallel to the core axis which is perpendicular to the bedding at varying positions petrography of pińczów limestone is briefly summarized in section 2 1 fig 6 shows two representative images of the thin sections in crossed polar light xpl to highlight mineralogical and textural differences thin section a is taken from the bulk region corresponding to relatively low grayscale pixel intensity it contains abundant calcite mud brown regions interspersed with fossil grains with no well connected large scale structures between and within fossil grains are numerous visible pores in contrast thin section b corresponding to what we hypothesize to be a permeability barrier contains a larger amount of fossils less mud and pores and an abundance of microcrystalline spar indicated by gray and high birefringence colors crystalline spar and grains in this case are of similar appearance mineralogy have low porosity and make up larger cemented together structures the grayscale autocorrelation function was calculated from two dimensional plane polarized light ppl images of the thin sections as a single material appears on such scans as the same grayscale value unlike xpl the acf shows that both thin sections have similar fractal dimensions for linear scales 30 μ m l 0 5 mm with d f 2 19 0 03 for thin section a and d f 2 15 0 03 for thin section b for scales 0 5 mm the fractal dimension increases for thin section b to d f 2 39 0 12 with larger features i e the cemented spar and grains being better correlated whereas d f remains unchanged for all feature sizes for thin section a this confirms that the volume averaged transition from d f 2 1 2 2 to d f 2 55 observed in the grayscale correlation function for the original sample fig 4 is associated with microstructural features of the low porosity regions peaks in the mean grayscale intensity can thus be interpreted as the result of low porosity layers dominated by grains cemented by calcite spar which act as permeability barriers full data on all thin sections is presented in supplementary material sec 2 4 discussion and conclusions the data presented in this paper demonstrate the benefit of high temporal and spatial resolution tomography in reactive flow studies in particular our results reveal that growth of wormholes in a real limestone rock can be more complex than simple proportionality of the driving pressure and tip displacement predicted by a typical model which assumes micro structural homogeneity daccord 1987 daccord and lenormand 1987 hill et al 1995 li et al 2019 in our samples we observe temporal plateaus of little pressure change alternated with larger drops in pressure which correlate well with the predictions of a conceptual model that assumes a layered porosity distribution our numerical results reproduce the general character of the observed pressure curve fig 3 and predict jumps in wormhole tip position the high temporal resolution of the 4d tomography technique used here enabled the capture of wormhole growth characteristics corresponding to temporal variation of the driving pressure this made it possible to test the permeability barrier model and show that tip velocity increases as the wormhole penetrates the barrier we note that the finite duration of tomographic scans 5 min results in temporal averaging of tip velocities which may obscure the presence of relatively narrow high density layers as at z l 0 1 in fig 5 this demonstrates that 4d tomography is a trade off in spatial versus temporal resolution as well as the volume of data if one wanted to capture very fine tip advancement in small layers it is advised to observe the time scales at which the pressure jumps occur in samples of a particular kind and tune scanning time to allow for multiple scans over that time scale additionally the time scales can be adjusted by decreasing acid concentration however this increases experimental time and the amount of image data collected the micro geometric characteristics of pińczów limestone sample obtained from the results of sans and usans high resolution tomography and thin section polarized microscopy measurements provided key insights allowing the analysis and interpretation of the kinetics of wormhole propagation through the rock each of these methods revealed a fractal geometry of the pore rock matrix interface characterized by a surface fractal dimension d f 2 1 2 2 jointly extending across many orders of magnitude from nanometers to 0 5 1 mm with a switch over to a larger fractal dimension d f 2 55 at scales corresponding to the average fossil grain size in the rock 0 5 1 mm the observed spatial correlation of wormhole tip propagation velocity with average grayscale intensity indicates that regions which contain these large structures act as barriers to reactive flow as in the presented numerical model tip velocity increases as the wormhole penetrates these barriers the speedup of the wormhole tip as it goes through the cemented regions has been observed before petrus and szymczak 2016 but only a qualitative explanation of this phenomenon was given since there is a larger amount of material to dissolve to broaden the wormhole its radius remains relatively small due to the conservation of mass a smaller radius implies larger flow velocities within the wormhole and hence also faster propagation speeds of its tip this qualitative picture is in agreement with the results of numerical simulations petrus and szymczak 2016 though an explicit formula linking the wormhole radius with the physical and chemical properties of the surrounding rock is lacking such a formula would have allowed for estimating the porosity contrast between the cementation regions and the bulk of the sample based on the tip advancement data which would be an important complement to the present study another complementary approach would be to analyze the evolving flow field associated with these wormholing patterns as shown in petrus and szymczak 2016 the movement of the tip of the wormhole into and out of the packed layers is associated with significant changes in the flow patterns as the tip of the wormhole enters a cemented layer the flow near the tip becomes strongly focused with diminished transverse components on the other hand as the wormhole emerges from the layer the flow spreads out from the wormhole tip analogously to the flow created by the point source at the wall these effects should be detectable with the flow imaging techniques such as nmr muljadi et al 2018 oliveira et al 2021 elsayed et al 2023 finally let us note that cemented regions in the core can have yet another impact on the wormhole advancement as the wormhole might try to avoid the low permeability crystalline portions by progressing laterally in essence the wormhole searches for an easiest to dissolve pathway that would lead it through the barrier this is a three dimensional effect not possible to represent in terms of our 1d toy model since in the latter there is no possibility of bypassing the packed layers in our experiment this happens between frames 13 15 30 31 and 33 35 i e just before the encounter with the cemented region in the first and third case 13 15 and 33 35 this lateral movement is also accompanied by an intense branching of the wormhole as if it is probing different ways through the obstacle before finding the most effective one see e g frame 34 in fig 1 the quantification of the lateral movement of the wormhole is provided by fig 5 in the supplementary material which compares the axial movement of the wormhole tip along z with the total movement as observed in the regions where z t plot is almost flat no axial advancement there is still a noticeable advancement in the absolute length of the wormhole l w t note that the vertical scale on the two plots are different due to the large tortuosity of the wormhole its absolute length is about two times larger than its extent in z direction thus the real slopes of the l w t line are about twice larger than the z t as we already mentioned there are limited other wormhole studies reporting a similar type of pressure curve with plateaus and jumps attributed to vugs izgec et al 2010 we do not see an abundance of vugs in pińczów limestone indicated in either thin sections or tomographic images furthermore tomographic images of areas containing vugs would show a smaller than average pixel intensity therefore the wormhole tip velocity jumps would then be correlated to troughs rather than peaks of pixel intensity despite the differences highlighted above both models converge in their emphasis on the importance of rock heterogeneity both vugs and permeability barriers are possible structural heterogeneities in limestone whereas most wormhole propagation models assume full homogeneity consequently the rate of the wormhole tip propagation extracted from 4d tomography can be used to detect and analyze the micro scale heterogeneities embedded in the rock since the growth is driven by an imposed flow the dynamics of the wormhole is sensitive to the local connectivity of competing reactive flow paths making it possible to detect micro laminations and structural discontinuities which are hard to identify with other methods finally the data from 4d tomography provides a perfect testing ground for numerical simulation of reactive flow in porous rocks molins et al 2020 ladd and szymczak 2021 particularly multi scale approaches molins et al 2012 yang et al 2013 hao et al 2013 soulaine et al 2017 ferreira et al 2020 agrawal et al 2020 noiriel et al 2021 which attempt to bridge the scales between the pore scale processes and formation of large scale patterns wormholing analyzed in this study is a striking example of such a process flow evolution in the sample results from the coupling between the large scale properties of a wormhole as a whole with local interactions of its tip with the small scale heterogeneities in the rock an in depth understanding of the coupling between these processes is crucial for the prediction of wormhole propagation speed and permeability evolution at the reservoir scale for the systems where wormholing is of a practical importance such as controlling contaminant migration or preventing co 2 leakage during geological carbon sequestration credit authorship contribution statement max p cooper designed and conducted the experiments prepared cores performed data analysis and curation developed python scripts and co wrote the manuscript including production of figures rishabh p sharma helped conduct experiments write python scripts and perform data analysis silvana magni helped with core preparation and conducting experiments tomasz p blach co designed the initial experimental apparatus and helped conduct acidization experiments acquired beamtime and prepared samples for u sans measurements and conducted those measurements andrzej p radlinski designed the experimental apparatus and initial protocol helped acquire funding and materials designed the lab at university of warsaw helped conduct the acidization experiments acquired beamtime and prepared samples for u sans measurements conducted those measurements and performed data analysis wrote u sans methods for the initial manuscript and greatly helped in establishing relationships with inig pib and ill katarzyna drabik acquired and reconstructed tomography data at inig pib alessandro tengattini helped run experiments set up data acquisition and reconstructed tomography data on the next instrument and edited the initial manuscript piotr szymczak designed experiments and helped conduct them acquired funding and materials supervised the group performed numerical simulations co wrote the manuscript including production of figures and noticed the unique behavior in experiments that led to this article declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work was supported by the national science center poland under research grant no 2016 21 b st3 01373 we acknowledge the institut laue langevin for the allocated beam time on d11 s18 and next we would like to thank the instrument scientists for the u sans instruments at institut laue lanvgevin ralf schweins sans instrument d11 and hartmut lemmel usans instrument s18 phung n h vu for aiding in u sans experiments and marek dohnalik for aiding with tomography at inig pib additionally we would like to thank anna poszytek for high resolution imaging of the thin sections eric cooper for creating thin section masks and jacek łata of marmur płytki pińczów poland for the donation of a pińczów limestone block used in this study finally we thank mariusz białecki for his valuable suggestions for figure improvements appendix a extended methods a 1 rock preparation a 1 1 cores cores of pińczów limestone were prepared using a coring bit attached to a drill press designed for rock cutting the coring bit used in the experiment presented here produces samples with a diameter of 38 3 mm and lengths 150 mm taken perpendicular to the bedding direction cores are then further cut to length with a diamond bladed trim saw the typical length of cores prepared and the length in the experiment presented in the main text is 115 mm a 1 2 sans and usans the pińczów limestone sample measured by sans and usans was in the form of nearly monodisperse coarse grains gently crushed by hand and sieved to the fraction 0 355 mm d 0 425 mm where d is grain diameter the size of the grains is optimized in such a way that scattering measurements provide information averaged over the orientation of the grains this sample was confined in an aluminum container with an internal volume of 0 123 cm 3 and an internal thickness of 1 mm the volume filling factor determined by weighing was 0 589 mineralogically the sample was nearly pure calcite with matrix skeleton density of 2 71 g cm 3 the nominal porosity of the measured pińczów limestone sample was 30 a 2 time lapse dissolution tomography experiments in this article we present an experiment with a high temporal resolution of five minutes per scan over five hours during active wormhole formation this experiment was performed at the oil and gas institute national research institute inig pib in krakow poland the experimental apparatus setup is that of a classic core flooding experiment e g fredd and fogler 1998 cylindrical cores along with ceramic disks soilmoisture 0 5 bar high flow plates machined to 38 3 mm diameter to ensure uniform flow are placed inside a viton sleeve and mounted in a high pressure core holder phoenix instruments with the maximal core diameter 1 5 inch 38 3 mm and length 5 5 inches 140 mm core lengths are adjustable by filling the remaining length of the core holder with cylindrical ptfe spacers confinement pressure was supplied by an external source of pressurized nitrogen flow rate of water hcl solution 0 25m for the presented experiment was controlled using a computer controlled high pressure dual piston pump vindum engineering inc vp 3k and a back pressure regulator equilibar u3l0 used to prevent phase separation of co 2 generated during dissolution a control and monitoring system of valves and a pressure transducer keller series pd 39x enable monitoring the pressure drop across the cell the appropriate back pressure was adjusted to acid concentration using henry s law sander 2015 and the confinement pressure was set to the sum of the back pressure and the initial pressure drop across the sample plus a 10 overhead all fluids were degassed under dynamic vacuum prior to an experiment and all fluid lines as well as the core were pre saturated with deionized water to ensure single phase flow through the entire system during an experiment the pressure is logged at an interval of 10 s we also log the starting and stopping time for each scan for visualization quality a rolling average over 20 pressure samples is applied for fig 2 to obtain the time series scans the cell is placed in a tomograph the tomograph at inig is a model rxct geotek ltd machine which is designed specifically to scan long cores in a horizontal orientation with the x ray source thermo kevex microfocus 45 to 130 kv 4 to 65 w and detector varian paxscan 2520dx 1920 1536 16 bit pixels rotating around the core this machine can select from a variety of voxel resolutions 30 350 μ m depending on the distance between source and detector and pixel binning on the detector in normal operation cores are held in a plexiglass tube that is attached to motorized manipulator arms capable of repeatable positioning as to allow cores longer than the field of view to be scanned to scan actively dissolving cores the fluid and confining gas lines are routed into one of the arm housings through the cable ingress hole and the core holder is attached to the arms with machined adapters to determine the optimal acquisition settings using the tomograph at inig pib an imaging experiment was performed prior to the dissolution experiment three static scans were performed with a partially dissolved core within the core holder at 42 μ m 84 5 μ m and 169 μ m voxel resolution with decreasing magnification obtained by adjusting the source to detector distance 42 to 84 5 μ m or increasing the binning factor 2 2 binning of 84 5 μ m to produce 169 μ m voxels which tightens the grayscale distribution supplementary material fig 15 and shifts threshold values for pores supplementary material table 2 as voxel size increases the acquisition time decreases as fewer images are taken per scan these scans take 10 6 and 5 min respectively this includes the tomography itself plus the rotation of the detector source back to the initial position as the core is longer than the field of view the arm moves the entire core holder and imaging rotation is repeated for the upper half of the core for example for acquisition at 169 μ m the first tomography lasts 60 s followed by a gap consisting of re positioning the core holder and rotation back to the 0 degree position 70 s the second tomography 60 s and a period resetting to the initial configuration and processing 105 s after reconstruction these two separate image stacks are joined together due to this stacking the upper portion of the core is not time synchronous with the lower half however the time elapsed between acquisitions of a given half is equal between captures this imaging experiment reveals that there is a trade off between the image acquisition time temporal resolution and spatial resolution however the measurement of interest the tip position versus time can still be carried out with an acceptable accuracy supplementary material sec 3 other parameters such as wormhole volume are not as robust to changes in voxel size due to tightening of the grayscale distribution and additional noise as seen in table 2 and fig 15 in the supplementary material since the wormhole growth is highly dynamic we have decided to maximize the temporal resolution and consequently the five minute duration 169 μ m voxel resolution scans are used in addition to the time lapse scans high resolution 30 μ m scans of both the initial and final core outside of the dissolution cell are taken an additional pressure log of a benchtop experiment as well as another experiment that was scanned with 4d tomography are presented in supplementary material sec 1 this 4d experiment was performed on the combined neutron and x ray tomography instrument next at institut laue langevin grenoble france tengattini et al 2020 here the x ray source hamamatsu l12161 07 and detector varex paxscan 2530he 1792 2176 16 bit pixels are stationary with rotation provided by a motorized high accuracy table to which the cell holder is attached in a vertical orientation a 3 image processing processing of all tomographic and microscopy images were performed in fiji imagej and a series of python scripts utilizing the numpy harris et al 2020 scipy virtanen et al 2020 and scikit image van der walt et al 2014 libraries a 3 1 static tomography analysis several analyses of the pore and grain geometry on the initial high resolution tomography were performed to prepare the reconstructed tomography for automated analyses first the 3d stack of tiff formatted images were cropped to a size that included the entire core but minimal surrounding areas to remove excess surrounding data essentially empty space and the plexiglass tube the core was placed in a mask was prepared in imagej by first setting a grayscale threshold then using the analyze particles feature with a large 1 0 5 minimum size this gives a mask where voxels within the core have a value of 1 and all other voxels are 0 multiplication by this mask results in a 3d image stack of the core surrounded by voxels with a grayscale value of zero before measuring the grayscale autocorrelation function acf l the data is further corrected to remove any beam hardening artefacts by another cropping step to leave just the central part of the core which is less affected by this artefact as beam hardening affects each slice of the core equally the full core is used in average intensity measurements the grayscale autocorrelation function acf l which is essentially the density density autocorrelation function was computed for a variety of lengths l between 30 μ m and 1 cm on the initial high resolution scan computation of acf l was performed in a python script with the main computation step performed in cython firstly the average grayscale over the number of non zero non masked voxels is calculated and subtracted from the 3d image in the masked region the main computation step then loops over each voxel adding the voxel grayscale values l distance away in the x y and z directions unless such a voxel lies outside the image boundary acf l is then computed using eq 1 which is fully described in the main text curves were fit to this data with linear regression in scipy to determine fractal dimensions to calculate average intensities in successive x y slices perpendicular to the core axis z axis a python script was used that sums every grayscale value in a slice and divides by the number of non zero non masked pixels in that slice to determine peaks of high intensity in the profile automatically a peak detection algorithm is employed utilizing the signal library within scipy virtanen et al 2020 prior to peak detection a gaussian filter with a standard deviation of 50 and a size of 15 is convolved with the average intensity array to reduce the number of lesser local maxima for fig 5 of the main text peak finding parameters are a height greater than the average intensity at least 80 slices apart and a peak prominence of 5 in addition to the analysis of the static initial scan wormhole extraction from static final scans of a partially dissolved core was performed during the imaging experiment used to determine acquisition parameters to extract the wormhole a grayscale threshold dependent on voxel resolution supplementary material table 2 was applied to the tomographic image in python resulting in a binary image following binarization the wormhole was isolated from pores by choosing a seed point within the wormhole and applying an algorithm that saves pixels of the same grayscale value or within a threshold that are connected to that seed point termed the flood fill algorithm in scikit image van der walt et al 2014 a 3 2 dynamic tomography analysis the 4d tomographic data was processed by a series of python scripts to extract wormhole geometry for visualization and automatic tip position measurement after cropping each scan was subtracted from the initial scan within the core holder of same resolution as other scans in the 4d sequence in order to isolate the areas that had transitioned from grain to pore for high contrast visualization purposes in video s1 fig 1 and fig 2 wormholes were extracted using the method described for the imaging experiment as there are multiple initial wormholes multiple seed points were chosen manually and the flood fill algorithm was applied to each time series image for automatic tip position measurement the subtracted images were skeletonized to obtain a volume where each wormhole branch is indicated by a single pixel per slice these images allow combined with filtering a straightforward identification of tip position prior to skeletonization a median filter with a 3 3 3 window is applied followed by a binary threshold where grayscale intensities greater than 500 are represented by a true value and a hole filling algorithm is applied in scipy virtanen et al 2020 the image is then skeletonized using the 3d skeletonize function in scikit image van der walt et al 2014 to remove any remaining noise a 9 9 9 kernel of all ones is convolved with the skeletonized image to count the number of skeleton voxels surrounding a particular voxel skeleton voxels with fewer than 5 neighbors are then removed from the selection to minimize the effect of randomness deriving from the unavoidable noise of the high speed tomographic imaging and subsequent treatments the value of 5 derives from the fact that a wormhole will have either 4 voxels ahead of the center voxel at the root of the wormhole 4 voxels behind the center voxel at the tip or to any side in a 9 9 9 window a second pass is performed with a 3 3 3 ones kernel to remove single voxel skeletons finally isolated skeletons are removed from the stack if there is no skeleton present 5 slices behind in the z direction following filtering the presence of skeleton was evaluated by summing pixels in each x y slice the largest non zero index of this count array is taken to be the tip position for the 4d experiment presented in sec 1 of the supplementary material the same procedure is used however with a grayscale threshold value of 15000 a 3 3 thin section image analysis thin sections were imaged in crossed polar and plane polar light xpl and ppl on a nikon eclipse lv100n pol polarized light microscope with a motorized stage märzhäuser wetzlar and nikon ds 5mc camera to image the entire thin section resulting in color rgb tiff images with 8 bits per color channel thin sections at 10 20 30 and 35 mm were imaged at 4x magnification resulting in a pixel size of 1 7 μ m while 50 60 70 and 80 mm sections were imaged at 2x magnification 3 4 μ m per pixel thin sections were visually inspected for their mineralogy and matrix grain content images were converted to 8 bit grayscale in fiji imagej and masks were created in adobe photoshop for acf l computation by creating a new layer painting pixels that are not within the rock portion of the image white selecting the white portion with the wand tool to fill it with black giving a value of 0 where there is no thin section then inverting the selection and filling with white value of 1 where the thin section is present grayscale autocorrelation was computed using the same code as in tomographic images however only in the x and y directions a 4 sans and usans measurements small angle neutron scattering measurements were conducted using sans instrument d11 lindner and schweins 2010 and usans instrument s18 hainbuchner et al 2000 at the institut laue langevin grenoble data were collected in the q range 2 99 10 5 å 1 q 1 10 3 å 1 for usans and 2 10 3 å 1 q 3 13 10 2 å 1 for sans i e in the combined q range of 2 99 10 5 å 1 q 3 13 10 2 å 1 where q 4 π λ s i n θ is the modulus of the scattering vector 2 θ is the scattering angle and λ is the neutron wavelength acquired raw data were processed using data reduction protocols described in the literature e g gu and mildner 2018 radlinski 2006 to obtain the pore size distribution expressed as a histogram using the polydisperse spheres pdsp model implemented in prinsas software hinde 2004 radlinski et al 2004b such a q range of scattering vectors corresponds to the range of pore sizes d 5 q from 16 nm to 17 μ m radlinski et al 2000 scattering length density of 4 69 10 10 cm 2 was calculated from the mineral composition pure caco 3 and physical density of the rock matrix 2 71 g cm 3 a 5 numerical model of rock acidization the numerical model of rock acidization is based on the coupled equation for flow reactant transport and porosity evolution at the darcy scale ladd and szymczak 2021 the darcy equation for the steady state flow is solved first followed by an advection diffusion reaction equation for reactant transport assuming one component linear reaction kinetics finally we increase the porosity in proportion to the reactive flux in a given point of the sample these equations are solved using the finite difference porous package developed by upadhyay et al 2015 which utilizes finite difference methods with a parallel multigrid linear solver hypre falgout and yang 2002 the details of the particular implementation of this model used in the present study can be found in upadhyay et al 2015 the simulations presented in fig 3 are run on a regular 200 1000 mesh with the initial porosity equal to 0 3 throughout the sample except in two horizontal strips fig 3 where it is equal to 0 03 the permeability was assumed to depend on porosity as k φ φ 3 which corresponds to the carman kozeny law with a constant surface area szymczak and ladd 2014 the linear reaction rate was assumed r k c s with a constant reactive surface area s appendix b supplementary data supplementary material related to this article can be found online at https doi org 10 1016 j advwatres 2023 104407 it contains two videos of wormhole development and pdf with additional experimental data appendix b supplementary data the following is the supplementary material related to this article video s1 video illustrating wormhole development created using connected component extraction video s2 video illustrating wormhole development without connected component extraction mmc s1 supplementary pdf with further experimental data 
31,dissolution of porous media induces positive feedback between fluid transport and chemical reactions at mineral surfaces leading to the formation of wormhole like channels within the rock wormholes provide highly efficient flow and transport paths within rock and as such understanding their formation is critical for controlling contaminant migration or preventing co 2 leakage during geological carbon sequestration here using time resolved x ray tomography we capture the dynamics of wormhole propagation inaccessible by standard experimental methods we find a highly non trivial relationship between wormhole advancement and variations in permeability of the rock with extensive periods of steady advancement not reflected by significant change in permeability this is in contrast to most existing conceptual models where wormholes advance in a linear fashion we show that this is caused by the presence of highly cemented regions which act as barriers to flow as confirmed by multi scale analysis of the pore geometry based on tomographic ultra small angle neutron scattering and optical microscopy measurements these results demonstrate that time lapse captured wormhole dynamics can be used to probe the internal structure of the rock keywords reactive flow limestone dissolution permeability 4d x ray microtomography data availability codes and raw as well as processed data are available at https doi org 10 5281 zenodo 7558135 raw tomographic data are available at https doi org 10 5281 zenodo 7683242 1 introduction wormholes are intricate ramified channels formed due to dissolution of a soluble rock within a range of chemical and flow conditions wormholes were first described by petroleum engineers rowan 1959 who injected acid into oil wells to increase reservoir permeability allowing oil and gas to migrate more readily a more detailed investigation of this process followed usually accompanied by flow through experiments in rock cores and fractures daccord 1987 hoefner and fogler 1988 fredd and fogler 1998 buijse 1997 golfier et al 2002 detwiler et al 2003 mcduff et al 2010 li et al 2019 recently understanding of wormholing became important when assessing and mitigating the risk of leakage from potential co 2 sequestration sites particularly in limestone formations ott and oedai 2015 snippe et al 2020 luquot and gouze 2009 garcia rios et al 2014 2015 smith et al 2013 hao et al 2013 steefel et al 2013 elkhoury et al 2013 selvadurai et al 2017 al khulaifi et al 2019 carbon dioxide when mixed with water becomes aggressive and can dissolve carbonate seams or veins in the cap rock creating co 2 escape conduits during the sequestration process in addition to their practical importance wormholes are impressive examples of a pattern forming system driven by a strong nonlinear coupling between flow rate reactive transport and evolving geometry of channels at the large scale wormholing processes play a major role in the formation of cave passages and karst conduit networks szymczak and ladd 2009 surface karst features such as solution pipes lipar et al 2021 but also melt migration daines and kohlstedt 1994 aharonov et al 1995 kelemen et al 1995 spiegelman et al 2001 terra rosa formation merino and banerjee 2008 and dolomitization koeshidayatullah et al 2021 similar phenomena are involved in the formation and evolution of other branched structures including leaf venation river networks and even vascular systems fleury et al 2013 the growth of wormholes is usually shielded from our eyes due to rock mass surrounding the structure the first studies of wormholing were then limited to observing the openings at the inlet and outlet side of the sample where the channels emerged a step forward was to cast wood s metal into the formed wormhole use tomographic imaging techniques or a combination of the two daccord 1987 daccord and lenormand 1987 hoefner and fogler 1988 this allowed the visualization of the final network of wormholes formed in a rock as a result of acidization although the understanding of the growth dynamics was limited to measuring change in pressure permeability over the sample through the experiment these studies established that the geometry of the wormholes strongly depends on the flow rate of the fluid that etches the rock hoefner and fogler 1988 fredd and fogler 1998 daccord et al 1989 golfier et al 2002 cohen et al 2008 at relatively low flow rates typically one bulky wormhole forms within the sample this type of wormhole is conical in shape tapering towards the downstream end at higher flow rates wormholes become thinner and more tortuous with a clear dominant flow path through the sample finally at high injection rates wormholes become more ramified with a network of alternative flow paths spanning the sample uniformly alas these studies did not reveal the dynamics of the wormholing process itself beyond measuring macroscopic permeability evolution building on the use of x ray techniques a way forward here is to use time lapse 4d tomography which requires placing the reactive flow core holder inside a tomograph the pioneering study of this kind was performed by bazin et al 1996 however due to technology of the time acquisition times were long compared to wormhole growth thus imaging was limited to only a few low resolution 2d scans i e radiographs through the sample recently this technique has been used more frequently for wormhole studies ott and oedai 2015 al khulaifi et al 2019 menke et al 2018 snippe et al 2020 although with limited time resolution 30 min and usually only a few 3d scans per experiment by finding a compromise between the resolution and acquisition time we are able to make a detailed time resolved study of growing wormholes with as many as 130 supplementary material sec 1 scans per experiment and scan times down to five minutes this has given us an unprecedented insight into the progressive development of wormholes through the sample it is worth mentioning that the dynamics of dissolution process can also be studied with another non invasive method nuclear magnetic resonance nmr muljadi et al 2018 oliveira et al 2021 elsayed et al 2023 nmr studies allow for the measurement of the displacement of water molecules associated with the flow through the porous rock in this way one can quantify the evolving flow in a dissolving sample 2 materials and methods to interpret wormhole propagation through limestone cores we employ 4d tomography image processing a simplified numerical model and rock characterization with thin sections and scattering techniques small and ultra small neutron scattering this section provides a summary of experimental methods full details of methods employed such as image analysis and the numerical model are presented in appendix a 2 1 rock description and preparation the rock used in this study is pinczów limestone a local variety of the wider ranged leitha limestone obtained from a quarry in podłȩże poland pinczów limestone has well described facies studencki 1988 and petrographic and mechanical properties figarska warchoł and stańczak 2019 the variety of pinczów limestone from this location corresponds to type 100 as described by figarska warchoł and stańczak 2019 pinczów leitha limestone is of middle miocene age and has undergone little diagenesis limited to cementation and in some regions recrystallization of calcite due to limited diagenesis it has high primary porosity ca 25 35 and permeability for a limestone it is a packstone with grains dominated by foraminifera as well as echinoid spines and mud consisting of calcite and approximately 10 insoluble minerals solubles consist of approximately 60 clay and cement and 40 grains with sizes ranging from 5 μ m up to several millimeters mean grain size for the dominant grains foraminifera is 0 5 mm of note horizontal laminae and recrystallized 1 mm thick zones parallel to bedding were observed by figarska warchoł and stańczak 2019 for dissolution experiments cores 38 3 mm in diameter were prepared on a drill press using a coring bit cores used in dissolution experiments were scanned with high resolution x ray tomography before each experiment for further characterization one core was first imaged with x ray tomography at a resolution of 30 μ m followed by thin sectioning at 10 20 30 35 50 60 70 and 80 mm from a core face an additional axially oriented thin section was prepared from 0 40 mm details of thin section analysis methods are presented in a 3 samples were also prepared for ultra small angle neutron scattering u sans by crushing and sieving grains in the range 0 178 r 0 213 mm where r is the grain radius u sans measurements were performed using the sans instrument d11 and usans instrument s18 at the institut laue langevin grenoble details on u sans measurements are given in a 4 2 2 time lapse dissolution tomography experiments dissolution experiments were performed on limestone cores with the classic core flooding apparatus a 2 e g fredd and fogler 1998 the core holder used phoenix instruments supports cores 38 3 mm diameter and up to 140 mm in length the core in the experiment presented here is 115 mm long dissolved with 0 25m hydrochloric acid at a flow rate of 1ml min prior to dissolution this core was scanned at a resolution of 30 μ m during the dissolution experiment time lapse 4d tomography was performed on the dissolving core at 169 μ m resolution so chosen as to balance acquisition time and the ability to pick out the advancing tip of the wormhole details on how this value was chosen is presented in a 2 and supplementary material section 3 at this spatial resolution the imaging time is ca 5 min pressure drop across the cell was logged at an interval of 10 s an additional benchtop experiment showing characteristic pressure drop over time for pinczów limestone is shown in supplementary material sec 1 along with another 4d experiment performed on the combined neutron and x ray tomography next instrument at institut laue langevin grenoble in the additional 4d experiment 126 4d scans were taken of a dissolving 58 7 mm long core with a voxel size of 43 5 μ m and a temporal resolution of 7 min 20 s the acid used in this experiment was 0 1m hcl dissolved in d 2 o and the acidization flow rate was 0 5 ml min processing of static high resolution tomography and dynamic 4d imagery is detailed in a 3 along with processing of thin section imagery 3 results 3 1 4d tomography and permeability evolution fig 1 and associated videos s1 and s2 shows wormhole development in five minute scanning increments with a 169 μ m voxel resolution the wormhole shown here was formed in a core taken perpendicular to bedding of the relatively porous pińczów limestone primary porosity ca 25 35 figarska warchoł and stańczak 2019 from pińczów poland flushed with 0 25m hydrochloric acid at a flow rate of 1 ml min at such a flow rate a single wormhole forms in a sample in which most of the flow focuses it is the so called dominant wormhole regime according to the classification of fredd and fogler 1998 with the extent of the wormhole controlling the permeability of the sample the wormhole progress is highly nonuniform with a number of jumps branchings and sudden changes of direction what is however more intriguing is the apparent lack of correlation between the position of the tip and the changes of the permeability of the sample the latter is measured by the pressure curve fig 2 representing the pressure needed to pump fluid through the sample at a constant flow rate at which the experiment is carried out the pressure curve shows long plateaus interspersed with step like pressure decreases interpretation of this behavior is not straightforward the simplest but frequently used model of wormhole evolution argues that due to the high permeability of a wormhole the pressure drop along its length is negligible daccord 1987 daccord et al 1993 hill et al 1995 li et al 2019 following this and assuming that the rock in front of the wormhole tip is homogeneous hydraulic resistance of the rock core should drop linearly with the length of the wormhole r l z where z is the length of the wormhole and l is the total length of the system an immediate consequence of this model is that pressure should decrease linearly with the advancement of a wormhole δ p δ p 0 1 z l with δ p 0 standing for an initial pressure drop through the sample however fig 2 shows that this is not the case for our system during pressure plateaus the wormhole tip progresses noticeably with a nearly constant velocity such a behavior has been reported in only a few previous wormhole studies bazin et al 1995 izgec et al 2010 with the response being attributed to vugs where pressure drops are associated with wormhole vug intersection izgec et al 2010 pińczów limestone however is not vuggy figarska warchoł and stańczak 2019 and as such we seek another explanation for this effect we argue that such a behavior might be attributed to the presence of regions of very small porosity within the sample such regions restrict the flow and effectively act as permeability barriers using analogy with the flow of electric current the rock core would then resemble a circuit of resistors connected in series with regions of small resistance interspersed with regions of very high resistance if such a system was measured by an ohmmeter the net resistance would be overwhelmed by high resistance regions only when the wormhole tip reaches high resistance regions and begins to etch its way through them the permeability of the core changes in a noticeable manner 3 2 toy model the mechanism of permeability variations can be demonstrated using a simple model of porous medium of porosity φ 0 which contains bands of much smaller porosity φ 1 marked by light yellow bands in fig 3a we also introduced a small region of very high porosity near the inlet of the sample marked by a red rectangle to trigger wormhole formation at this point we then let the system dissolve using the numerical model described in a 5 and record the advancement of the tip and evolution of the pressure drop in time fig 3b shows marked similarities with the analogous results for the experimental system including long pressure plateaus during which the tip of the wormhole advances considerably interestingly and somewhat surprisingly the model calculations predict acceleration of the growth rate as the wormhole tip penetrates the impermeable layers in the model the cause of this is that within a packed layer it is harder for the wormhole to broaden because there is more mineral matter to dissolve around the perimeter petrus and szymczak 2016 a thinner wormhole results in higher flow velocities within it in turn leading to a larger propagation velocity of the wormhole tip 3 3 rock properties based on the 4d tomography results fig 2 and theoretical considerations fig 3 several questions arise what is the real bulk pore grain geometry of the sample are there any large scale structures that can block flow paths if so do such structures correlate spatially with the wormhole tip position jumps to address these questions an analysis of pore grain structure was performed on length scales between 8 nm and 1 cm combining ultra small angle neutron scattering u sans a 4 and image analysis of the tomography results obtained prior to the dissolution experiment a 3 fig 4 analysis of the smallest length scales used u sans to determine the pore size distribution neutron scattering data shows an approximate power law distribution linear in log log space of pore radii f r r β with β 3 12 0 2 in the size range between 8 nm 4 μ m this indicates an approximate self similar pore structure with the fractal dimension d f β 1 2 12 radlinski et al 2004a anovitz and cole 2015 for r 4 μ m the deviation from the power law is likely due to multiple scattering ji et al 2022 hence this range is excluded from the power law fit to quantify the larger 30 μ m pore and grain architecture in the sample we calculated the grayscale autocorrelation function on the tomographic data of the pre dissolved sample defined as 1 acf l g r l μ g r μ r g r μ 2 r where g r is a grayscale value at point r within a sample and r denotes averaging over r finally μ g r r is the average grayscale value while computing acf l we average over different orientations of the vector l which gives a scalar dependent function acf l further details of the computation of the autocorrelation function are given in appendix a 3 1 the autocorrelation function approach has previously been used to characterize the pore space by first segmenting pores from grains katz and thompson 1985 in this work however we utilize the grayscale values of the images to capture both pores and the potential source of permeability barriers the grains remarkably for a wide range of radii 100 μ m 1 mm the autocorrelation function also shows a power law behavior l α with an exponent α 0 8 0 01 fig 4 as it turns out the power law behavior of the autocorrelation function again implies fractal pore space geometry however the link between the exponent and the fractal dimension is now different d f 3 α katz and thompson 1985 remarkably for our sample it again gives d f 2 2 autocorrelation data from the experiment performed at institut laue langevin supplementary material fig 4 exhibit a similar power law behavior with d f 2 14 these values are very close to the fractal dimension estimated form the neutron scattering data d f 2 12 we can then conclude that combined u sans and acf data show a self similar structure over a remarkably wide range of five orders of magnitude in pore sizes 8 nm 1 mm however as seen in fig 4 at r 1 mm there is a transition to a different scaling behavior prevalent in the mm and cm range the crossover to higher correlations indicate the presence of large structures presumably fossil grain assemblages on the scale of 1 10 mm this is in full agreement with petrographic analyses of this rock type which report horizontal laminae and recrystallized 1 mm thick zones parallel to the bedding figarska warchoł and stańczak 2019 to determine if such large scale structures could be the permeability barriers postulated in our model fig 3 we calculate the average grayscale intensity for successive slices perpendicular to the core bedding axis using a high resolution 30 μ m voxels tomographic image of the core prior to dissolution taken outside of the core holder full image processing information described in a 3 in x ray tomography image intensity represents the attenuation of matter to x rays which is proportional to its atomic number and density therefore pixels of higher intensity correspond to regions with higher solid fraction or minerals with higher atomic numbers for a rock dominated by one mineral as is pińczów limestone a higher average intensity corresponds therefore to a higher grain density and thus lower porosity the data presented in fig 5c show quantifiable peaks as determined by an automated peak detection algorithm virtanen et al 2020 where average grayscale is higher than for the bulk of the rock when wormhole tip displacement is juxtaposed with the average grayscale diagram one notes that the wormhole propagation velocity increases in the peak regions otherwise maintaining a steady velocity in the bulk of the rock fig 5d this supports our hypothesis that wormhole propagation rate is controlled by the permeability barriers within the sample while a peak at z l 0 1 does not necessarily correlate to acceleration in the tip position and the acceleration at z l 0 7 does not seem to be correlated with a peak these two features are relatively narrow and thus the respective correlations might be harder to detect naturally projecting the grain content information on z axis as performed in fig 5c considerably smears out the data on the 3d configuration of pores grains and positions of the microcementation regions as a result the overall variations in the grain content remain relatively small on the level of a few percent this is much smaller than the ones used in the toy model of fig 3 when the porosity in the cemented regions was 10 times smaller than that in the bulk of the rock since both the pressure drops and the wormhole speedups recorded during the experiment are substantial fig 2 we conclude that the wormhole tip does encounter local highly cemented structures that it needs either to navigate around or dissolve its way through the coarse projection of fig 5c succeeds in picking up the most extended of these regions but as already mentioned misses a thinner one at z 0 7 as marked in fig 2 finally to investigate what rock textures correspond to the regions of permeability barriers we analyze thin sections taken from another core of the same rock eight perpendicular and one parallel to the core axis which is perpendicular to the bedding at varying positions petrography of pińczów limestone is briefly summarized in section 2 1 fig 6 shows two representative images of the thin sections in crossed polar light xpl to highlight mineralogical and textural differences thin section a is taken from the bulk region corresponding to relatively low grayscale pixel intensity it contains abundant calcite mud brown regions interspersed with fossil grains with no well connected large scale structures between and within fossil grains are numerous visible pores in contrast thin section b corresponding to what we hypothesize to be a permeability barrier contains a larger amount of fossils less mud and pores and an abundance of microcrystalline spar indicated by gray and high birefringence colors crystalline spar and grains in this case are of similar appearance mineralogy have low porosity and make up larger cemented together structures the grayscale autocorrelation function was calculated from two dimensional plane polarized light ppl images of the thin sections as a single material appears on such scans as the same grayscale value unlike xpl the acf shows that both thin sections have similar fractal dimensions for linear scales 30 μ m l 0 5 mm with d f 2 19 0 03 for thin section a and d f 2 15 0 03 for thin section b for scales 0 5 mm the fractal dimension increases for thin section b to d f 2 39 0 12 with larger features i e the cemented spar and grains being better correlated whereas d f remains unchanged for all feature sizes for thin section a this confirms that the volume averaged transition from d f 2 1 2 2 to d f 2 55 observed in the grayscale correlation function for the original sample fig 4 is associated with microstructural features of the low porosity regions peaks in the mean grayscale intensity can thus be interpreted as the result of low porosity layers dominated by grains cemented by calcite spar which act as permeability barriers full data on all thin sections is presented in supplementary material sec 2 4 discussion and conclusions the data presented in this paper demonstrate the benefit of high temporal and spatial resolution tomography in reactive flow studies in particular our results reveal that growth of wormholes in a real limestone rock can be more complex than simple proportionality of the driving pressure and tip displacement predicted by a typical model which assumes micro structural homogeneity daccord 1987 daccord and lenormand 1987 hill et al 1995 li et al 2019 in our samples we observe temporal plateaus of little pressure change alternated with larger drops in pressure which correlate well with the predictions of a conceptual model that assumes a layered porosity distribution our numerical results reproduce the general character of the observed pressure curve fig 3 and predict jumps in wormhole tip position the high temporal resolution of the 4d tomography technique used here enabled the capture of wormhole growth characteristics corresponding to temporal variation of the driving pressure this made it possible to test the permeability barrier model and show that tip velocity increases as the wormhole penetrates the barrier we note that the finite duration of tomographic scans 5 min results in temporal averaging of tip velocities which may obscure the presence of relatively narrow high density layers as at z l 0 1 in fig 5 this demonstrates that 4d tomography is a trade off in spatial versus temporal resolution as well as the volume of data if one wanted to capture very fine tip advancement in small layers it is advised to observe the time scales at which the pressure jumps occur in samples of a particular kind and tune scanning time to allow for multiple scans over that time scale additionally the time scales can be adjusted by decreasing acid concentration however this increases experimental time and the amount of image data collected the micro geometric characteristics of pińczów limestone sample obtained from the results of sans and usans high resolution tomography and thin section polarized microscopy measurements provided key insights allowing the analysis and interpretation of the kinetics of wormhole propagation through the rock each of these methods revealed a fractal geometry of the pore rock matrix interface characterized by a surface fractal dimension d f 2 1 2 2 jointly extending across many orders of magnitude from nanometers to 0 5 1 mm with a switch over to a larger fractal dimension d f 2 55 at scales corresponding to the average fossil grain size in the rock 0 5 1 mm the observed spatial correlation of wormhole tip propagation velocity with average grayscale intensity indicates that regions which contain these large structures act as barriers to reactive flow as in the presented numerical model tip velocity increases as the wormhole penetrates these barriers the speedup of the wormhole tip as it goes through the cemented regions has been observed before petrus and szymczak 2016 but only a qualitative explanation of this phenomenon was given since there is a larger amount of material to dissolve to broaden the wormhole its radius remains relatively small due to the conservation of mass a smaller radius implies larger flow velocities within the wormhole and hence also faster propagation speeds of its tip this qualitative picture is in agreement with the results of numerical simulations petrus and szymczak 2016 though an explicit formula linking the wormhole radius with the physical and chemical properties of the surrounding rock is lacking such a formula would have allowed for estimating the porosity contrast between the cementation regions and the bulk of the sample based on the tip advancement data which would be an important complement to the present study another complementary approach would be to analyze the evolving flow field associated with these wormholing patterns as shown in petrus and szymczak 2016 the movement of the tip of the wormhole into and out of the packed layers is associated with significant changes in the flow patterns as the tip of the wormhole enters a cemented layer the flow near the tip becomes strongly focused with diminished transverse components on the other hand as the wormhole emerges from the layer the flow spreads out from the wormhole tip analogously to the flow created by the point source at the wall these effects should be detectable with the flow imaging techniques such as nmr muljadi et al 2018 oliveira et al 2021 elsayed et al 2023 finally let us note that cemented regions in the core can have yet another impact on the wormhole advancement as the wormhole might try to avoid the low permeability crystalline portions by progressing laterally in essence the wormhole searches for an easiest to dissolve pathway that would lead it through the barrier this is a three dimensional effect not possible to represent in terms of our 1d toy model since in the latter there is no possibility of bypassing the packed layers in our experiment this happens between frames 13 15 30 31 and 33 35 i e just before the encounter with the cemented region in the first and third case 13 15 and 33 35 this lateral movement is also accompanied by an intense branching of the wormhole as if it is probing different ways through the obstacle before finding the most effective one see e g frame 34 in fig 1 the quantification of the lateral movement of the wormhole is provided by fig 5 in the supplementary material which compares the axial movement of the wormhole tip along z with the total movement as observed in the regions where z t plot is almost flat no axial advancement there is still a noticeable advancement in the absolute length of the wormhole l w t note that the vertical scale on the two plots are different due to the large tortuosity of the wormhole its absolute length is about two times larger than its extent in z direction thus the real slopes of the l w t line are about twice larger than the z t as we already mentioned there are limited other wormhole studies reporting a similar type of pressure curve with plateaus and jumps attributed to vugs izgec et al 2010 we do not see an abundance of vugs in pińczów limestone indicated in either thin sections or tomographic images furthermore tomographic images of areas containing vugs would show a smaller than average pixel intensity therefore the wormhole tip velocity jumps would then be correlated to troughs rather than peaks of pixel intensity despite the differences highlighted above both models converge in their emphasis on the importance of rock heterogeneity both vugs and permeability barriers are possible structural heterogeneities in limestone whereas most wormhole propagation models assume full homogeneity consequently the rate of the wormhole tip propagation extracted from 4d tomography can be used to detect and analyze the micro scale heterogeneities embedded in the rock since the growth is driven by an imposed flow the dynamics of the wormhole is sensitive to the local connectivity of competing reactive flow paths making it possible to detect micro laminations and structural discontinuities which are hard to identify with other methods finally the data from 4d tomography provides a perfect testing ground for numerical simulation of reactive flow in porous rocks molins et al 2020 ladd and szymczak 2021 particularly multi scale approaches molins et al 2012 yang et al 2013 hao et al 2013 soulaine et al 2017 ferreira et al 2020 agrawal et al 2020 noiriel et al 2021 which attempt to bridge the scales between the pore scale processes and formation of large scale patterns wormholing analyzed in this study is a striking example of such a process flow evolution in the sample results from the coupling between the large scale properties of a wormhole as a whole with local interactions of its tip with the small scale heterogeneities in the rock an in depth understanding of the coupling between these processes is crucial for the prediction of wormhole propagation speed and permeability evolution at the reservoir scale for the systems where wormholing is of a practical importance such as controlling contaminant migration or preventing co 2 leakage during geological carbon sequestration credit authorship contribution statement max p cooper designed and conducted the experiments prepared cores performed data analysis and curation developed python scripts and co wrote the manuscript including production of figures rishabh p sharma helped conduct experiments write python scripts and perform data analysis silvana magni helped with core preparation and conducting experiments tomasz p blach co designed the initial experimental apparatus and helped conduct acidization experiments acquired beamtime and prepared samples for u sans measurements and conducted those measurements andrzej p radlinski designed the experimental apparatus and initial protocol helped acquire funding and materials designed the lab at university of warsaw helped conduct the acidization experiments acquired beamtime and prepared samples for u sans measurements conducted those measurements and performed data analysis wrote u sans methods for the initial manuscript and greatly helped in establishing relationships with inig pib and ill katarzyna drabik acquired and reconstructed tomography data at inig pib alessandro tengattini helped run experiments set up data acquisition and reconstructed tomography data on the next instrument and edited the initial manuscript piotr szymczak designed experiments and helped conduct them acquired funding and materials supervised the group performed numerical simulations co wrote the manuscript including production of figures and noticed the unique behavior in experiments that led to this article declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work was supported by the national science center poland under research grant no 2016 21 b st3 01373 we acknowledge the institut laue langevin for the allocated beam time on d11 s18 and next we would like to thank the instrument scientists for the u sans instruments at institut laue lanvgevin ralf schweins sans instrument d11 and hartmut lemmel usans instrument s18 phung n h vu for aiding in u sans experiments and marek dohnalik for aiding with tomography at inig pib additionally we would like to thank anna poszytek for high resolution imaging of the thin sections eric cooper for creating thin section masks and jacek łata of marmur płytki pińczów poland for the donation of a pińczów limestone block used in this study finally we thank mariusz białecki for his valuable suggestions for figure improvements appendix a extended methods a 1 rock preparation a 1 1 cores cores of pińczów limestone were prepared using a coring bit attached to a drill press designed for rock cutting the coring bit used in the experiment presented here produces samples with a diameter of 38 3 mm and lengths 150 mm taken perpendicular to the bedding direction cores are then further cut to length with a diamond bladed trim saw the typical length of cores prepared and the length in the experiment presented in the main text is 115 mm a 1 2 sans and usans the pińczów limestone sample measured by sans and usans was in the form of nearly monodisperse coarse grains gently crushed by hand and sieved to the fraction 0 355 mm d 0 425 mm where d is grain diameter the size of the grains is optimized in such a way that scattering measurements provide information averaged over the orientation of the grains this sample was confined in an aluminum container with an internal volume of 0 123 cm 3 and an internal thickness of 1 mm the volume filling factor determined by weighing was 0 589 mineralogically the sample was nearly pure calcite with matrix skeleton density of 2 71 g cm 3 the nominal porosity of the measured pińczów limestone sample was 30 a 2 time lapse dissolution tomography experiments in this article we present an experiment with a high temporal resolution of five minutes per scan over five hours during active wormhole formation this experiment was performed at the oil and gas institute national research institute inig pib in krakow poland the experimental apparatus setup is that of a classic core flooding experiment e g fredd and fogler 1998 cylindrical cores along with ceramic disks soilmoisture 0 5 bar high flow plates machined to 38 3 mm diameter to ensure uniform flow are placed inside a viton sleeve and mounted in a high pressure core holder phoenix instruments with the maximal core diameter 1 5 inch 38 3 mm and length 5 5 inches 140 mm core lengths are adjustable by filling the remaining length of the core holder with cylindrical ptfe spacers confinement pressure was supplied by an external source of pressurized nitrogen flow rate of water hcl solution 0 25m for the presented experiment was controlled using a computer controlled high pressure dual piston pump vindum engineering inc vp 3k and a back pressure regulator equilibar u3l0 used to prevent phase separation of co 2 generated during dissolution a control and monitoring system of valves and a pressure transducer keller series pd 39x enable monitoring the pressure drop across the cell the appropriate back pressure was adjusted to acid concentration using henry s law sander 2015 and the confinement pressure was set to the sum of the back pressure and the initial pressure drop across the sample plus a 10 overhead all fluids were degassed under dynamic vacuum prior to an experiment and all fluid lines as well as the core were pre saturated with deionized water to ensure single phase flow through the entire system during an experiment the pressure is logged at an interval of 10 s we also log the starting and stopping time for each scan for visualization quality a rolling average over 20 pressure samples is applied for fig 2 to obtain the time series scans the cell is placed in a tomograph the tomograph at inig is a model rxct geotek ltd machine which is designed specifically to scan long cores in a horizontal orientation with the x ray source thermo kevex microfocus 45 to 130 kv 4 to 65 w and detector varian paxscan 2520dx 1920 1536 16 bit pixels rotating around the core this machine can select from a variety of voxel resolutions 30 350 μ m depending on the distance between source and detector and pixel binning on the detector in normal operation cores are held in a plexiglass tube that is attached to motorized manipulator arms capable of repeatable positioning as to allow cores longer than the field of view to be scanned to scan actively dissolving cores the fluid and confining gas lines are routed into one of the arm housings through the cable ingress hole and the core holder is attached to the arms with machined adapters to determine the optimal acquisition settings using the tomograph at inig pib an imaging experiment was performed prior to the dissolution experiment three static scans were performed with a partially dissolved core within the core holder at 42 μ m 84 5 μ m and 169 μ m voxel resolution with decreasing magnification obtained by adjusting the source to detector distance 42 to 84 5 μ m or increasing the binning factor 2 2 binning of 84 5 μ m to produce 169 μ m voxels which tightens the grayscale distribution supplementary material fig 15 and shifts threshold values for pores supplementary material table 2 as voxel size increases the acquisition time decreases as fewer images are taken per scan these scans take 10 6 and 5 min respectively this includes the tomography itself plus the rotation of the detector source back to the initial position as the core is longer than the field of view the arm moves the entire core holder and imaging rotation is repeated for the upper half of the core for example for acquisition at 169 μ m the first tomography lasts 60 s followed by a gap consisting of re positioning the core holder and rotation back to the 0 degree position 70 s the second tomography 60 s and a period resetting to the initial configuration and processing 105 s after reconstruction these two separate image stacks are joined together due to this stacking the upper portion of the core is not time synchronous with the lower half however the time elapsed between acquisitions of a given half is equal between captures this imaging experiment reveals that there is a trade off between the image acquisition time temporal resolution and spatial resolution however the measurement of interest the tip position versus time can still be carried out with an acceptable accuracy supplementary material sec 3 other parameters such as wormhole volume are not as robust to changes in voxel size due to tightening of the grayscale distribution and additional noise as seen in table 2 and fig 15 in the supplementary material since the wormhole growth is highly dynamic we have decided to maximize the temporal resolution and consequently the five minute duration 169 μ m voxel resolution scans are used in addition to the time lapse scans high resolution 30 μ m scans of both the initial and final core outside of the dissolution cell are taken an additional pressure log of a benchtop experiment as well as another experiment that was scanned with 4d tomography are presented in supplementary material sec 1 this 4d experiment was performed on the combined neutron and x ray tomography instrument next at institut laue langevin grenoble france tengattini et al 2020 here the x ray source hamamatsu l12161 07 and detector varex paxscan 2530he 1792 2176 16 bit pixels are stationary with rotation provided by a motorized high accuracy table to which the cell holder is attached in a vertical orientation a 3 image processing processing of all tomographic and microscopy images were performed in fiji imagej and a series of python scripts utilizing the numpy harris et al 2020 scipy virtanen et al 2020 and scikit image van der walt et al 2014 libraries a 3 1 static tomography analysis several analyses of the pore and grain geometry on the initial high resolution tomography were performed to prepare the reconstructed tomography for automated analyses first the 3d stack of tiff formatted images were cropped to a size that included the entire core but minimal surrounding areas to remove excess surrounding data essentially empty space and the plexiglass tube the core was placed in a mask was prepared in imagej by first setting a grayscale threshold then using the analyze particles feature with a large 1 0 5 minimum size this gives a mask where voxels within the core have a value of 1 and all other voxels are 0 multiplication by this mask results in a 3d image stack of the core surrounded by voxels with a grayscale value of zero before measuring the grayscale autocorrelation function acf l the data is further corrected to remove any beam hardening artefacts by another cropping step to leave just the central part of the core which is less affected by this artefact as beam hardening affects each slice of the core equally the full core is used in average intensity measurements the grayscale autocorrelation function acf l which is essentially the density density autocorrelation function was computed for a variety of lengths l between 30 μ m and 1 cm on the initial high resolution scan computation of acf l was performed in a python script with the main computation step performed in cython firstly the average grayscale over the number of non zero non masked voxels is calculated and subtracted from the 3d image in the masked region the main computation step then loops over each voxel adding the voxel grayscale values l distance away in the x y and z directions unless such a voxel lies outside the image boundary acf l is then computed using eq 1 which is fully described in the main text curves were fit to this data with linear regression in scipy to determine fractal dimensions to calculate average intensities in successive x y slices perpendicular to the core axis z axis a python script was used that sums every grayscale value in a slice and divides by the number of non zero non masked pixels in that slice to determine peaks of high intensity in the profile automatically a peak detection algorithm is employed utilizing the signal library within scipy virtanen et al 2020 prior to peak detection a gaussian filter with a standard deviation of 50 and a size of 15 is convolved with the average intensity array to reduce the number of lesser local maxima for fig 5 of the main text peak finding parameters are a height greater than the average intensity at least 80 slices apart and a peak prominence of 5 in addition to the analysis of the static initial scan wormhole extraction from static final scans of a partially dissolved core was performed during the imaging experiment used to determine acquisition parameters to extract the wormhole a grayscale threshold dependent on voxel resolution supplementary material table 2 was applied to the tomographic image in python resulting in a binary image following binarization the wormhole was isolated from pores by choosing a seed point within the wormhole and applying an algorithm that saves pixels of the same grayscale value or within a threshold that are connected to that seed point termed the flood fill algorithm in scikit image van der walt et al 2014 a 3 2 dynamic tomography analysis the 4d tomographic data was processed by a series of python scripts to extract wormhole geometry for visualization and automatic tip position measurement after cropping each scan was subtracted from the initial scan within the core holder of same resolution as other scans in the 4d sequence in order to isolate the areas that had transitioned from grain to pore for high contrast visualization purposes in video s1 fig 1 and fig 2 wormholes were extracted using the method described for the imaging experiment as there are multiple initial wormholes multiple seed points were chosen manually and the flood fill algorithm was applied to each time series image for automatic tip position measurement the subtracted images were skeletonized to obtain a volume where each wormhole branch is indicated by a single pixel per slice these images allow combined with filtering a straightforward identification of tip position prior to skeletonization a median filter with a 3 3 3 window is applied followed by a binary threshold where grayscale intensities greater than 500 are represented by a true value and a hole filling algorithm is applied in scipy virtanen et al 2020 the image is then skeletonized using the 3d skeletonize function in scikit image van der walt et al 2014 to remove any remaining noise a 9 9 9 kernel of all ones is convolved with the skeletonized image to count the number of skeleton voxels surrounding a particular voxel skeleton voxels with fewer than 5 neighbors are then removed from the selection to minimize the effect of randomness deriving from the unavoidable noise of the high speed tomographic imaging and subsequent treatments the value of 5 derives from the fact that a wormhole will have either 4 voxels ahead of the center voxel at the root of the wormhole 4 voxels behind the center voxel at the tip or to any side in a 9 9 9 window a second pass is performed with a 3 3 3 ones kernel to remove single voxel skeletons finally isolated skeletons are removed from the stack if there is no skeleton present 5 slices behind in the z direction following filtering the presence of skeleton was evaluated by summing pixels in each x y slice the largest non zero index of this count array is taken to be the tip position for the 4d experiment presented in sec 1 of the supplementary material the same procedure is used however with a grayscale threshold value of 15000 a 3 3 thin section image analysis thin sections were imaged in crossed polar and plane polar light xpl and ppl on a nikon eclipse lv100n pol polarized light microscope with a motorized stage märzhäuser wetzlar and nikon ds 5mc camera to image the entire thin section resulting in color rgb tiff images with 8 bits per color channel thin sections at 10 20 30 and 35 mm were imaged at 4x magnification resulting in a pixel size of 1 7 μ m while 50 60 70 and 80 mm sections were imaged at 2x magnification 3 4 μ m per pixel thin sections were visually inspected for their mineralogy and matrix grain content images were converted to 8 bit grayscale in fiji imagej and masks were created in adobe photoshop for acf l computation by creating a new layer painting pixels that are not within the rock portion of the image white selecting the white portion with the wand tool to fill it with black giving a value of 0 where there is no thin section then inverting the selection and filling with white value of 1 where the thin section is present grayscale autocorrelation was computed using the same code as in tomographic images however only in the x and y directions a 4 sans and usans measurements small angle neutron scattering measurements were conducted using sans instrument d11 lindner and schweins 2010 and usans instrument s18 hainbuchner et al 2000 at the institut laue langevin grenoble data were collected in the q range 2 99 10 5 å 1 q 1 10 3 å 1 for usans and 2 10 3 å 1 q 3 13 10 2 å 1 for sans i e in the combined q range of 2 99 10 5 å 1 q 3 13 10 2 å 1 where q 4 π λ s i n θ is the modulus of the scattering vector 2 θ is the scattering angle and λ is the neutron wavelength acquired raw data were processed using data reduction protocols described in the literature e g gu and mildner 2018 radlinski 2006 to obtain the pore size distribution expressed as a histogram using the polydisperse spheres pdsp model implemented in prinsas software hinde 2004 radlinski et al 2004b such a q range of scattering vectors corresponds to the range of pore sizes d 5 q from 16 nm to 17 μ m radlinski et al 2000 scattering length density of 4 69 10 10 cm 2 was calculated from the mineral composition pure caco 3 and physical density of the rock matrix 2 71 g cm 3 a 5 numerical model of rock acidization the numerical model of rock acidization is based on the coupled equation for flow reactant transport and porosity evolution at the darcy scale ladd and szymczak 2021 the darcy equation for the steady state flow is solved first followed by an advection diffusion reaction equation for reactant transport assuming one component linear reaction kinetics finally we increase the porosity in proportion to the reactive flux in a given point of the sample these equations are solved using the finite difference porous package developed by upadhyay et al 2015 which utilizes finite difference methods with a parallel multigrid linear solver hypre falgout and yang 2002 the details of the particular implementation of this model used in the present study can be found in upadhyay et al 2015 the simulations presented in fig 3 are run on a regular 200 1000 mesh with the initial porosity equal to 0 3 throughout the sample except in two horizontal strips fig 3 where it is equal to 0 03 the permeability was assumed to depend on porosity as k φ φ 3 which corresponds to the carman kozeny law with a constant surface area szymczak and ladd 2014 the linear reaction rate was assumed r k c s with a constant reactive surface area s appendix b supplementary data supplementary material related to this article can be found online at https doi org 10 1016 j advwatres 2023 104407 it contains two videos of wormhole development and pdf with additional experimental data appendix b supplementary data the following is the supplementary material related to this article video s1 video illustrating wormhole development created using connected component extraction video s2 video illustrating wormhole development without connected component extraction mmc s1 supplementary pdf with further experimental data 
32,regional groundwater flow forecasting is frequently accomplished using model equations based on darcy s law the continuity equation and kinematic and dynamic boundary conditions for a time dependent water table to predict hydraulic heads and fluxes for homogeneous and isotropic aquifers the model reduces to laplace s equation for the hydraulic head and a transient non linear free surface boundary condition these equations are solved in the literature and in computer packages by a variety of numerical methods including finite difference finite element and boundary element methods the solution of this model is not simple and subject to instability problems computations in a vertical plane using finite difference methods are not easy due to the irregular mesh needed near a highly curved water table frequently involving smoothing of the numerical results to ensure stability a technique to avoid the complications related to mesh generation near a curved boundary and its tracking entails using mappings to produce transformed domains however this is not so frequent to compute unsteady seepages in particular the so called sigma mapping is widely used to model irrotational water waves it applies to any flow involving a time dependent free surface boundary this mapping transforms the domain into a rectangle so that the free surface becomes static in the transformed plane there is close similarity between the mathematical model describing irrotational water waves and that of unsteady seepage flow e g both are governed by laplace s equation involving relevant boundary conditions at the moving boundary both moving free surfaces are different in character e g the seepage is dissipative whereas the water wave is dispersive however it is possible to transfer mathematical approximations between both fields of research this transfer is exploited in this work and the sigma mapping is newly and successfully applied to seepage flows involving both a steady and unsteady water table either receiving or not a recharge from rainfall or an artificial source keywords groundwater recharge seepage flow sigma mapping time dependent water table data availability no data were used for the research described in the article 1 introduction an important problem of groundwater hydrology is the determination of the mathematical quantities necessary for regional management as the hydraulic heads and fluxes wang and anderson 1982 rushton 2003 serrano 2003 anderson et al 2015 flow in unconfined aquifers is governed by an elliptic partial differential equation which reduces to laplace s equation for homogeneous and isotropic aquifers and a complex transient non linear partial differential equation describing the position of the phreatic surface the solution of the general groundwater flow problem with a non linear free surface boundary condition is not simple methods to attack the problem include numerical modeling using finite difference finite element and boundary element methods analytical methods using complex variables and simplified dimension reduced models applying the well known dupuit forchheimer theory bear 1972 strack 1989 2017 anderson et al 2015 there are widely used modern computer packages based on finite elements and finite difference methods which permit the modeler to tackle complicated real problems of groundwater flow that cannot be handled using analytical methods examples are feflow which uses finite elements diersch 2014 and modflow which is based on finite differences harbaugh 2005 anderson et al 2015 complex variables and conformal mappings are widely applied in the groundwater literature to solve steady two dimensional 2d flows for simplified geometries and constant groundwater parameters muskat 1942 polubarinova kochina 1962 harr 1962 bear 1972 boast 1977 boast and baveye 1989 strack 2017 whereas linearizations and the dupuit forcheimer theory are frequently used to solve simplified versions of the equations governing unsteady seepage bear 1972 analytical methods based on complex variables are important to get insights on groundwater flow phenomena and to check the correctness of numerical models of the full equations crank 1984 strack 2017 graphical and analogue methods are currently not frequently used in most cases a time dependent full three dimensional 3d solution or even 2d is only feasible by resorting to numerical methods rushton and redshaw 1979 wang and anderson 1982 the focus of this work is to solve such problems involving a time dependent water table in the vertical plane solving the full equations thus dupuit s bear 1972 and higher order approximations knight 2005 castro orgaz et al 2012 are not considered the solution of the full groundwater flow problem in a vertical plane was accomplished in the literature using several methods including finite differences finnemore and perry 1968 todsen 1971 verma and brutsaert 1971 singh 1976 wang and anderson 1982 miles 1986 chakib and nachaoui 2005 harbaugh 2005 finite elements neuman and witherspoon 1970 1971 wang and anderson 1982 diersch 2014 and boundary elements liu and liggett 1979 1980 bruch 1991 methods possibly the simplest yet very useful method is that of finite differences pinder and bredehoeft 1968 rushton and redshaw 1979 wang and anderson 1982 harbaugh 2005 anderson et al 2015 the solution of the exact equations by this technique is prone to some difficulties miles 1986 related to the presence of a highly curved water table whose position is unknown in advance near a curved boundary the standard discretization of laplace s equation involving a computational stencil with 4 equi spaced nodes in a regular mesh thom and apelt 1961 rushton and redshaw 1979 wang and anderson 1982 is not valid a taylor expansion can be used to produce special finite difference formulae for the internal nodes just below the water table miles 1986 but its tracking becomes complicated and the accuracy of the finite difference formulae decreases finnemore and perry 1968 todsen 1971 lapidus and pinder 1982 this may produce instability problems during the solution if the nearest node adjacent to the water table is too close to it miles 1986 or even failure if the computed drawdown is larger than one cell rushton and redshaw 1979 a possible means to avoid such complications is to use transformed domains chu 1971 oberkampf 1976 crank 1984 jie et al 2004 for the solution of an unsteady seepage but these are not so frequent and most of the solution procedures available are directly applied to the physical plane other methods are available for steady flow including the hodograph method with numerical conformal mapping bakker 1997 axisymmetric flow to a well with seepage face luther and haitjema 1999 3d flow to radial collector wells bakker et al 2005 and separation of variables ameli and craig 2014 the solution of the laplace equation for a potential function is a classical problem of hydrodynamics liggett 1994 serrano 2003 irrotational water waves are described by laplace s equation for the internal flow field supplemented with relevant boundary conditions vallentine 1969 at the free surface the moving boundary is described by a kinematic boundary condition plus a dynamic boundary condition the bernoulli equation vallentine 1969 liggett 1994 katopodes 2019 flow in a homogeneous incompressible and isotropic phreatic aquifer is also described in terms of the laplace equation for the internal flow field below the water table or phreatic surface which is at atmospheric pressure bear 1972 the kinematic boundary condition at a water table expressed in terms of the water depth and velocity components is identical to that of the water waves problem a major difference in the solution of moving boundary value problems in water waves and seepage flows stems from the dynamic boundary condition which in the case of seepage flow is an algebraic identity equating the potential to the elevation bear 1972 liggett 1994 there is also a special boundary condition in seepage flows which does not appear in irrotational water waves the so called surface of seepage where the water exits from the saturated soil at atmospheric pressure despite the mathematical models describing water waves and seepage flows being similar there are significant physical differences between both flows the sign of the potential function in water waves problems and groundwater hydraulics is opposite serrano 2003 and the dissipative character of seepage flows contrasts with the dispersive feature in water waves tao 2020 however given that the mathematical model describing irrotational water waves is similar to that describing unsteady seepage flows with the main difference stemming from the dynamic boundary condition at the moving boundary it seems logical to seek extrapolation from one field of mathematical procedures to another liggett 1994 here we follow this motivation and propose in this work the widely used σ mapping in the field of water wave modeling problems haussling and van eseltine 1975 li and fleming 1997 bestehorn and tyvand 2009 bihs et al 2020 tao 2020 to seepage flows this produces a transformed domain where the tracking of a highly curved free surface is simple the σ mapping is a coordinate transformation used to solve water waves problems haussling and van eseltine 1975 li and fleming 1997 bestehorn and tyvand 2009 bihs et al 2020 tao 2020 where the governing equations and boundary conditions are transformed to a simplified rectangular domain there the moving boundary remains fixed during the time dependent movement apparently this method is not considered in the literature of groundwater hydrology and thus the present work aims at presenting its details and applications to several key problems of this discipline it transforms the time dependent water table into a stationary boundary the domain is thus mapped in a rectangle where second order finite differences apply free surface computations using a locally irregular mesh which reduce the accuracy to first order and introduce instabilities are thus fully avoided the method was found to be very simple and it is applied in the ensuing sections to problems involving both a steady and unsteady seepage receiving or not a recharge from the rainfall or artificially as shown the sigma mapping method provides the groundwater flow modeler with an alternative technique to those currently used 2 sigma mapping for flow in phreatic aquifers 2 1 fundamental equations and boundary conditions we consider that 2d flow in the vertical plane x z of a homogeneous and isotropic porous media can be described in terms of the seepage or darcy velocity components u and w in the x and z directions fig 1 by respectively bear 1972 rushton and redshaw 1979 strack 1989 kacimov and obnosov 2019 kacimov et al 2020 1 u k ϕ x w k ϕ z here k is the saturated hydraulic conductivity and ϕ the potential function for seepage flow in porous media the potential function has a clear physical meaning namely the piezometric pressure head or hydraulic head obtained by summing the pressure head p ρg to the elevation z bear 1972 2 ϕ x z t p x z t ρ g z in hydrodynamics however e g as in water waves problems the potential function is an abstract quantity used only to obtain the kinematic field by differentiation liggett 1994 inserting eq 1 into the continuity equation for a rigid aquifer considering that the water is incompressible u x w z 0 produces the laplace equation in terms of ϕ as muskat 1942 rushton 2003 serrano 2003 kacimov and obnosov 2019 kacimov et al 2020 3 2 ϕ 2 ϕ x 2 2 ϕ z 2 0 eq 3 is the fundamental differential equation describing the flow in a homogeneous isotropic and rigid aquifer storing water assuming it is incompressible i e neglecting the specific storage effects bear 1972 raudkivi and callander 1976 rushton and redshaw 1979 strack 1989 to formulate a well posed problem boundary conditions are required we assume that the aquifer bed a d is impervious and horizontal thus the no flow condition normal to it results in 4 ϕ z 0 this is the kinematic bottom boundary condition at the phreatic surface b c boundary conditions are not simple the position of this boundary is in general time dependent and it may receive a recharge rate n fig 1 as usual in moving boundary value problems an unknown boundary requires two boundary conditions to locate it crank 1984 typically one kinematic and the other dynamic liggett 1994 the kinematic boundary condition describing the time evolution of the phreatic surface may be stated as todsen 1971 bear 1972 rushton and redshaw 1979 5 n e k h t ϕ z ϕ x h x n k here ne is the effective porosity or specific yield and h is the saturated thickness or water depth fig 1 this relation is basically an evolution equation for the water table position at the water table another unknown is the potential ϕ mathematically determined by a dynamic condition in water waves hydrodynamics the dynamic equation is given by bernoulli s law vallentine 1969 liggett 1994 in porous media given that the potential function is the piezometric pressure and that the pressure at the water table surface is zero one finds the simpler dynamic boundary condition bear 1972 liggett 1994 6 ϕ x z t z at a surface of seepage boundary condition the pressure is atmospheric and eq 6 is also the relevant boundary condition there polubarinova kochina 1962 harr 1962 bear 1972 eqs 5 and 6 are used simultaneously to determine the position of the moving water table lateral boundary conditions are necessary and will be described specifically in each of the test cases conducted in ensuing sections e g the distributions ϕ 0 z t and ϕ l z t a numerical solution of eqs 3 6 in the x z plane by a finite difference method involves a special treatment to locate the position of the water table in both steady shaw and southwell 1941 finnemore and perry 1968 khan and rushton 1996a and unsteady todsen 1971 verma and brutsaert 1971 singh 1976 guvanasen and volker 1980 brock 1982 khan and rushton 1996b flows frequently involving a smoothing of numerical results in the next section we describe the σ mapping to avoid such free surface tracking complications note that time derivatives appear only in eq 5 2 2 σ transformation in this section we employ a technique to map a general flow domain a b c d a fig 1 into a rectangle the mapping needed is called sigma mapping and it is given by the coordinate transformation z σ 7 σ x z t z h x t referring to fig 1 it observed that the moving boundary maps into the line σ 1 therefore a moving boundary value problem is transformed into a steady boundary value problem the sigma mapping is not new it was originally developed by phillips 1957 for numerical weather forecasting this mapping has been successfully applied in hydrodynamics and it is a particular case of more general coordinate transformations chu 1971 oberkampf 1976 in water waves problems the σ mapping is a widely used tool in models for solving irrotational wave motion the first application in this field was possibly by haussling and van eseltine 1975 in these water waves models the laplace equation and boundary conditions are transformed using the sigma mapping prior to the numerical discretization haussling and van eseltine 1975 li and fleming 1997 bingham and zhang 2007 engsig karup et al 2009 bestehorn and tyvand 2009 bihs et al 2020 wang et al 2022 however to the authors knowledge this mapping has so far not been applied to flow in porous media given the similarities between the model equations for irrotational water waves and flow in porous media liggett 1994 and the successful results applying the sigma mapping in the former field this section presents the σ mapping for porous media flows the laplace eq 3 will be transformed to the sigma plane in the sigma transformation the z coordinate is replaced using z σh where σ is the new independent variable representing the vertical dimension using this transformation in the potential function reads 8 ϕ x z t ϕ x σ h t ϕ x σ x z t h x t t in the sigma plane the independent variables are x σ t on inspecting eq 8 note that the water table h is only a function of x t therefore one may also write the following functional identity from eq 8 9 ϕ x z t ϕ x σ t now the transformation requires computing the partial derivatives of the potential function in eq 9 with respect to x z using the chain rule the following statements link the first spatial derivatives in the x z and σ x planes 10 ϕ x ϕ x ϕ σ σ x ϕ z ϕ σ σ z differentiation of the coordinate transformation eq 7 produces 11 σ x z h 2 h x σ z 1 h inserting eqs 11 in eq 10 yields the desired transformation of derivatives between planes 12 ϕ x ϕ x σ h ϕ σ h x ϕ z 1 h ϕ σ the same procedure is used for computing the second spatial derivatives resulting in 13 2 ϕ x 2 x ϕ x σ h ϕ σ h x σ ϕ x σ h ϕ σ h x σ x 2 ϕ x 2 σ 2 h x h 2 h x x h ϕ σ 2 σ h x h 2 ϕ x σ σ 2 h x h 2 2 ϕ σ 2 2 ϕ z 2 σ ϕ σ σ z σ z 1 h 2 2 ϕ σ 2 where hx h x and hxx 2 h x 2 using eqs 13 the laplace eq 3 reads on the σ x plane dropping the tildes for simplicity of notation haussling and van eseltine 1975 li and fleming 1997 bingham and zhang 2007 engsig karup et al 2009 bestehorn and tyvand 2009 bihs et al 2020 wang et al 2022 14 h 2 2 ϕ x 2 1 σ h x 2 2 ϕ σ 2 2 σ h h x 2 ϕ x σ 2 σ h x 2 σ h h x x ϕ σ 0 note that mathematically the σ transformation introduces singularities in the laplace equation if hx or hxx or both simultaneously this is a limitation caused by the mapping at least one case is realistic in groundwater flow problems namely hx at the intersection of the water table and a seepage surface bear 1972 this case is discussed in more detail in following sections but it is relevant to introduce it here this kind of singularity occurs at a boundary section of the aquifer where the distribution of ϕ is known therefore laplace s equation is not solved at that section so the singularity does not affect it however the position of the water table at that boundary section is unknown and shall be computed as part of the solution using eqs 11 12 the kinematic boundary condition eq 5 transforms to 15 n e k h t 1 h x 2 1 h ϕ σ σ 1 ϕ x σ 1 h x n k along the line σ 1 representing the water table eq 6 shall also be satisfied therefore one may write in the σ x plane ϕ x hx resulting in the following form of the kinematic boundary condition 16 n e k h t 1 h x 2 1 h ϕ σ σ 1 h x 2 n k this equation also suffers from a singularity at hx therefore it cannot be used to track the position of the water table at its intersection with a seepage surface normalized variables are introduced now as follows 17 x z h ϕ l 1 h o x z h ϕ l u w 1 k u w t k n e h o t where ho is a scaling length to be defined in each test the use of these normalizations does not alter the form of the laplace eq 14 whereas eq 16 simplifies to 18 h t 1 h x 2 1 h ϕ σ σ 1 h x 2 n k f x σ t where hats have been dropped for the sake of simplicity the bottom kinematic condition eq 4 and the free surface dynamic condition eq 6 remain unaltered after introducing the scalings a numerical method to solve eqs 4 6 14 18 and the relevant lateral boundary conditions ϕ 0 z t and ϕ l z t is needed this task is accomplished in the next section 2 3 numerical method a simple finite difference method is employed in the σ x plane haussling and van eseltine 1975 li and fleming 1997 bestehorn and tyvand 2009 bihs et al 2020 the x axis i index is discretized using m mesh points whereas j mesh points are used along the σ axis j index the step sizes of the mesh in the x and σ directions are x l m 1 and σ 1 j 1 respectively second order accurate finite differences abramowitz and stegun 1972 are used to approximate the derivatives of the potential as follows 19 ϕ σ ϕ i j 1 ϕ i j 1 2 δ σ 20 2 ϕ x 2 ϕ i 1 j 2 ϕ i j ϕ i 1 j δ x 2 21 2 ϕ σ 2 ϕ i j 1 2 ϕ i j ϕ i j 1 δ σ 2 22 2 ϕ x σ ϕ i 1 j 1 ϕ i 1 j 1 ϕ i 1 j 1 ϕ i 1 j 1 4 δ x δ σ the spatial water table derivatives are similarly given by 23 h x h i 1 h i 1 2 δ x 24 2 h x 2 h i 1 2 h i h i 1 δ x 2 inserting eqs 19 24 into the laplace eq 14 an algebraic system of linear equations is obtained for the potential at each i j node of the mesh the system of linear equations can be solved by efficient methods like the conjugate gradient method or by a multigrid method katopodes 2019 we employ a less efficient but simpler alternative namely a successive over relaxation method sor thom and apelt 1961 rushton and redshaw 1979 wang and anderson 1982 crank 1984 katopodes 2019 for a known distribution of the potential along the boundaries the method produces the solution of the internal potentials iteratively in the sigma mapping method the same discretizations are used for all the internal nodes of the finite difference mesh in contrast the numerical solution of the laplace equation in the x z plane involves the use of irregular computational stencils near a curved water table finnemore and perry 1968 todsen 1971 verma and brutsaert 1971 singh 1976 guvanasen and volker 1980 the resulting finite difference formulae to apply for the internal nodes close to this curved boundary is first order accurate lapidus and pinder 1982 and can produce stability problems miles 1986 in the sigma mapping the vertical mesh coordinate follows the free surface changes in the time dependent simulation but the number of mesh points in each vertical is fixed a careful specification of the potential at the boundaries is needed during the iteration process lateral distributions of potential are assumed to be known in the ensuing discussion e g ϕ 1 j and ϕ m j for j 2 to j 1 at the bottom a second order discretization of eq 4 produces 25 ϕ σ σ 0 3 ϕ i 1 4 ϕ i 2 ϕ i 3 2 δ σ 0 ϕ i 1 from which the bottom potential is determined as function of adjacent interior values in a vertical discretization of eq 18 the only equation with a time derivative is a critical aspect that shall be accomplished carefully the vertical gradient of the potential at the free surface is a crucial quantity approximated with second order accuracy as 26 ϕ σ σ 1 3 ϕ i j 4 ϕ i j 1 ϕ i j 2 2 δ σ inserting eqs 23 and 26 into eq 18 produces a semi discrete system of odes for each free surface node as follows 27 h t i f i j using eq 27 the water table position at time k 1 is determined from its position at time k as liggett 1977 liu and liggett 1980 diersch 2014 28 h i k 1 h i k θ f k 1 1 θ f k δ t here θ is a weighting factor positioning the evaluation of the water table derivative between times t k t and t t k 1 t liu and liggett 1980 recommended the optimum interval 0 5 θ 0 6 for stability and accuracy of solutions for θ 0 one gets the euler forward time stepping which is not accurate and prone to stability limitations whereas a fully implicit method results from θ 1 the value θ ½ corresponds to the second order crank nicolson method guvanasen and volker 1980 diersch 2014 which is the approximation used in this work to preserve second order time accuracy diersch 2014 the stability of solutions has been a source of ample debate miles 1986 todsen 1971 suggesting t 1 whereas guvanasen and volker 1980 proposing t 1 3 liu and liggett 1980 found that a small t is needed to guarantee the accuracy of the solution bruch 1991 proposed to set θ 0 7 based on liu and liggett 1980 and developed an implicit relation to determine an optimum t based on the prescribed θ value here we have adopted a simple procedure to determine t based on the courant friedrichs lewy condition hirt et al 1975 katopodes 2019 wang et al 2022 as follows 29 δ t cfl min δ x max u δ σ max w we have used throughout this work cfl 0 2 to reduce truncation errors during the time integration liu and liggett 1980 as previously remarked a singularity occurs at the intersection between the water table and a seepage face with the dam problem fig 2 as a typical case polubarinova kochina 1962 aitchison 1972 rushton and redshaw 1979 see point d in fig 2 let us denote the steady dam velocity components along the water table as us ws it can be demonstrated that the kinematic condition transforms to polubarinova kochina 1962 bear 1972 us 2 ws 2 kws 0 representing the dam problem in the hodograph plane fig 2b this equation is a circle at point d of the circle us 0 and ws k e g there is no singularity in the darcian velocity components considering now the kinematic statement ws us h x one deduces that at point d h x the well known singularity in the water table profile this singularity occurs in the σ mapping model presented here and in general in all models using the kinematic condition ws us h x to track the water table position the consequence is clear eq 28 cannot be applied to locate the water table in this case consider that the singularity occurs at x l here we use a simple linear extrapolation of the interior solution at any instant of time as follows todsen 1971 rushton and redshaw 1979 miles 1986 30 h m 2 h m 1 h m 2 this approximation although crude was found to produce results of enough practical accuracy this is further discussed in the next section using as test case the dam problem a similar procedure is used for a seepage face at the upstream section x 0 use of a parabolic extrapolation produced a small variation in the results once the water table position is determined the surface potential is computed from 31 ϕ i j h i given that the f function is evaluated at time k 1 in eq 28 the determination of the distribution of potentials and the water table position at this instant of time is iterative the solution process starts with a guessed solution of h i and ϕ i j for k 1 typically the values of the former time step k then the distribution of internal potentials is updated by applying sor the bottom potential using eq 25 the water table position using eq 28 and the surface potential using eq 31 the process is iteratively conducted at each time instant until convergence is achieved it is determined using the condition 32 1 m j i j m j ϕ i j new ϕ i j ε where ε 10 12 was used to ensure accuracy the sor weighting factor ω was determined by numerical trial and error experiments and it was fixed to 1 8 during our computations once the converged distribution of potentials is available at time k 1 the normalized seepage velocities from eq 1 are determined now from 33 u ϕ x σ h ϕ σ h x w 1 h ϕ σ using second order finite differences and the time step is adjusted using eq 29 initial conditions h x 0 and ϕ x z 0 are necessary to have a well posed initial boundary value problem these are stated below for each test case conducted the time integration described above is conducted until reaching a target time the procedure permits to compute both unsteady and steady seepage as the limiting condition for t 3 test cases 3 1 polubarinova kochina dam problem the polubarinova kochina rectangular dam problem consists in the steady filtration of water through a homogeneous and isotropic porous medium with vertical boundaries polubarinova kochina 1940 muskat 1942 chapman 1957 polubarinova kochina 1962 boast 1977 kacimov and obnosov 2016 liu et al 2022 the geometry of the problem and boundary conditions are depicted in fig 2 muskat 1942 bear 1972 rushton and redshaw 1979 and the singularity at d was previously discussed for a steady seepage h t 0 in the water table kinematic condition fig 2a this is one of the few cases in seepage hydraulics where exact solutions are available in this section the solution generated using the sigma mapping will be compared to the exact solution described below the analytical solution of the steady dam problem by polubarinova kochina 1962 consists in the conformal mapping of the physical and hodograph planes into the upper half plane by applying the analytic theory of linear differential equations polubarinova kochina 1938 1940 the resulting integral relations for l hd ho and hs and the water table profile are available elsewhere polubarinova kochina 1962 crank 1984 hornung and krueger 1985a we have used the newton raphson method with a numerical jacobian matrix to solve the polubarinova kochina equations the maximum magnitudes of residual errors in our solution were 10 10 the results of our numerical solver were compared with hornung and krueger 1985a resulting in a perfect match up to the 6th decimal digit in their computations the exact solutions for three test cases with l 0 25 0 5 and 1 for hd 0 are plotted in fig 3 hd 0 was selected given the stronger drawdown for a given l than using hd 0 the ensuing conclusions remain unaltered by considering hd 0 numerical solutions obtained with the sigma mapping are also plotted in fig 3 these were obtained solving the initial boundary value problem fig 2a with the initial condition h x 0 1 for the numerical solutions of the sigma model 80 horizontal divisions and 50 vertical divisions were used the model was run until steady flow conditions established computations were absent from any stability problem as previously reported by todsen 1971 and finnemore and perry 1968 we remark that no smoothing algorithms were necessary in our numerical implementation as previously required in other models in general the numerical solutions of the sigma mapping are in good agreement with the exact solutions on inspecting fig 3 note that the surface of seepage is adequately predicted confirming that a linear extrapolation of the interior solution is accurate enough for practical computations there are few works in the literature presenting details on predicted internal flow variables in the dam problem polubarinova kochina 1962 is a notable exception as she presented the details of a 2d finite difference solution for a dam test case with l 2 3 and hd 1 6 like in the former tests a mesh with 80 50 horizontal and vertical divisions is used in the sigma model the computed water table profiles by the sigma model and that reported by polubarinova kochina 1962 are in good agreement fig 4a use of a mesh with 160 100 horizontal and vertical divisions does not produce a significant variation in the water table the distribution of the potential function ϕ x z given by polubarinova kochina 1962 was used to compute by using second order finite differences the vertical profiles of the horizontal velocity u for four representative locations shown in fig 4b including the boundary section at x 2 3 these results of polubarinova kochina are compared in the same figure with the predictions of the sigma mapping model resulting in an excellent match our computed velocity profile at the seepage face is in qualitative agreement with the shape reported by muskat 1942 of relevance is the non removable singularity in the u velocity component at x 2 3 see point c in fig 2 whose behavior is easily observed in the hodograph fig 2b computations with the finer mesh of 160 100 horizontal and vertical divisions resulted in a better resolved velocity profile near the singularity the unit discharge q crossing a vertical section was determined by numerical integration of the computed velocity profiles the results are plotted in fig 4a where the exact result given by dupuit s equation polubarinova kochina 1962 bear 1972 q k 2l ho 2 hd 2 is also available the computed discharge and the corresponding errors for the four positions where the velocity profiles are plotted in fig 4 b are reported in table 1 note that the numerical error is small with the outflow boundary section as the position with the largest error to further explore it an inset in fig 4a shows the behavior of the integrated discharge near x 2 3 as observed there is some growth of the errors near that section as expected from the approximate determination of the water table position there the results for a mesh of 160 100 horizontal and vertical divisions are plotted in the same inset as a dotted line showing a significant reduction of the error near x 2 3 as reported in table 1 the discharge error at x 2 3 for this refined mesh is reduced an alternative check of the accuracy of the water table determination is presented in fig 4c where the hodograph for the water table is plotted along with the free surface data pairs us ws computed with the sigma model note that the agreement of this check is also good a water table fall unsteady test case is considered in fig 5 the initial condition is a horizontal water table h x 0 1 at time t 0 the tailwater depth hd drops instantaneously below h x 0 thereby starting an unsteady drainage process todsen 1971 rushton and redshaw 1979 we considered the test previously conducted by cheng and li 1973 for l 2 3 and hd 1 6 the unsteady water table obtained with the sigma mapping method is compared in fig 5 with the results found by cheng and li 1973 using the finite element method at different times resulting generally in a good agreement the steady result of cheng and li 1973 is slightly lower than our result but the sigma mapping is in good agreement with the exact steady solution 3 2 drainage of recharge with symmetrical boundaries the problem of drainage of recharge with symmetrical boundaries consists in the steady filtration of water through a homogeneous and isotropic porous medium receiving steady vertical recharge n with tailwater depths hd at the vertical boundaries rusthon and youngs 2010 castro orgaz et al 2012 monfared et al 2022 by symmetry only half of the problem is considered the geometry and boundary conditions are depicted in fig 6 rusthon and youngs 2010 solved the recharge problem as a steady state boundary value problem their solution considered the methods and algorithms described in rusthon and redshaw 1979 in their approach to compute a steady seepage the water table position is determined iteratively assuming that the free surface is represented by a series of steps the position of the water table in each vertical column is adjusted until the pressure is atmospheric our solution with the sigma mapping considers the initial boundary value problem stated in fig 6 the initial condition assumed is static water in the porous medium equal to the length of the domain h x 0 l then the steady recharge n is introduced to the system at t 0 the tailwater depth drops to hd and the time variant flow adjustment occurs until reaching a steady state our results using 50 vertical and 80 horizontal divisions are compared with those of rushton and youngs 2010 in fig 7 for a water table profile involving n k 0 4 and hd l 0 2 both solutions are in good agreement yet the sigma mapping solution yields a maximum water depth at the symmetry axis x 0 slightly above that of rushton and youngs 2010 the sigma mapping solution preserves second order accuracy in all numerical discretizations including those related to the water table boundary therefore the method is especially suitable for strongly curved water tables as is this case the sigma mapping results are further compared with hornung and krueger s 1985b results for two water table profiles with n k 0 4 and 0 1 under hd 0 fig 8 achieving an excellent match of both sets of results the accuracy of the results by hornung and krueger 1985b is thus similar to that of the present method the variations of the maximum groundwater depth hm at the symmetry plane and the minimum groundwater depth hs at the seepage face are considered in fig 9 a as function of the normalized recharge n k for dry tailwater channels hd 0 there is an excellent match of our results with hornung and krueger 1985b and minute deviations from the results of rushton and youngs 2010 the case involving hd l 0 5 n k is shown in fig 9b where our results are also very close to rushton and youngs 2010 3 3 growth of groundwater ridges the growth of groundwater ridges consists in the rise of a mouth of groundwater in response to a steady percolation n in a finite strip l of an infinite aquifer in the x direction only half of the problem is considered by symmetry the geometry and boundary conditions are depicted in fig 10 marino 1967 initially the water depth is ho in all the domain percolation n then starts at t 0 initiating the time dependent drainage process the length of the computational domain ab is 15ho in this test and the mesh used had 50 and 350 vertical and horizontal divisions respectively the aquifer is infinite in the x direction thus the vertical equipotential cb is taken for the computations far away from the recharge strip l in section cb there is not any portion in contact with the atmosphere given that it is just a truncation of the infinite x domain therefore seepage faces are not formed initially the saturated thickness in the aquifer is constant and equal to ho and the water is static these computational conditions mimic the experiments by marino 1967 a test case by marino 1967 is considered in fig 11 where the water table profiles obtained at times t 2 23 11 15 and 20 07 in a hele shaw experimental device are plotted in this test n k 0 1334 and l ho 2 106 the sigma mapping solution is plotted in the same figure and compared with the boundary element solution by bruch 1991 the present results are generally in very good agreement with bruch 1991 as well with liu and liggett 1979 results not included to keep the figure clean the predictions of both the sigma mapping and the boundary element method are in excellent agreement with the hele shaw results for t 2 23 yet some deviations are noted at later times especially in the recharge strip these deviations were previously reported in the literature and attributed to problems with the experimental device liu and liggett 1979 bruch 1991 4 discussion of results and limitations the sigma mapping was used in this work to transform the mathematical equations for an initial boundary value problem involving a moving water table in porous media the transformation is not new but it was newly applied to groundwater flows it was found that the water table determination with the proposed method is simple the sigma model produced results in conformity with former solutions available in the literature involving the use of the finite element method boundary element method and finite difference method in the physical plane numerical smoothing during computations was not needed stability problems were absent contrary to some of former numerical implementations the sigma mapping transformation proposed was applied to problems in the vertical plane x z however its application to 3d flows x y z is straightforward and does not entail any different conceptual treatment harbaugh 2005 for details see li and flemming 1997 the aquifer was considered homogeneous and isotropic thus the mass conservation equation for the interior of the aquifer simplifies to laplace s equation for the hydraulic head the modeling of groundwater flow as 2d saturated flow in homogeneous aquifers is a widely used tool serrano 2003 kacimov and obnosov 2019 kacimov et al 2020 extension to heterogeneous and anisotropic conditions is in principle not a difficult task in the finite difference set up it involves a more general form of the mass conservation equation introducing the variations of the hydraulic conductivity bear 1972 rushton 2003 anderson et al 2015 the aquifer was assumed to be rigid and the water incompressible thus the mass conservation equation lacks a time derivative if these effects are accounted for by introducing the specific storage effect pinder and bredehoeft 1968 bear 1972 harbaugh 2005 barua and alam 2013 anderson et al 2015 the resulting equation can also be transformed using the sigma mapping and included in the time stepping procedure inclusion of an uneven bathymetry is another straightforward generalization of the method by defining the sigma mapping as 34 σ x y z t z z b x y h x y t where y is the lateral coordinate and zb x y is the aquifer bed bathymetry it further involves a redefinition of the kinematic bottom boundary condition which is again straightforward the bottom profile is defined by σ 0 and the water table by σ 1 a limitation of the sigma mapping is that it is not valid for hx given that this derivative appears in the laplace eq 14 and the kinematic surface condition eq 18 this situation occurs at the intersection of the water table and the seepage face see point d in fig 2 boast 1977 discussed that although hx is the exact condition at point d in practical computations the water table slope there is finite thus the linear extrapolation that we used is justified for practical purposes there is a theoretical limitation of the proposed model at point d but from a practical view point the limitation is not strong as previously analyzed in fig 4 another interesting mapping previously used is that of boadway 1976 applied by crank and ozis 1980 for steady seepage flow in the rectangular dam problem substituting the functional dependence ϕ ϕ x z by x x ϕ z it was applied only to steady flows and there is not a simple transformed domain into a rectangle as in the sigma mapping the main purpose of this research is to present the σ mapping and its application to several important cases of porous media flows we have used a finite difference method which is simple with parameter values of θ 0 5 cfl 0 2 ε 10 12 and ω 1 8 that produced accurate solutions in a reasonable running time on a personal computer these values are by no means universal and the optimum numerical set up was not investigated being outside the scope of the work these may be optimized by the modeler other numerical implementations including a different spatial discretization e g using finite elements neuman and witherspoon 1970 1971 diersch 2014 and time stepping approaches with a multistep method e g a runge kutta scheme katopodes 2019 may be adopted 5 concluding remarks in this work a widely used mapping technique in water waves problems is newly applied to the mathematical equations describing an unsteady water table movement in isotropic and homogeneous aquifer the proposed σ mapping transforms the time dependent and curved water table in the vertical plane x z into a straight line σ 1 in the plane x σ thus a moving boundary value problem transform into a fixed boundary value problem the proposed method was compared with solutions available in the literature either using finite difference finite element or boundary element methods resulting in general agreement the method was equally applied to steady and unsteady seepage problems the solutions were found to be in excellent agreement with the exact polubarinova kochina solution for the dam problem the method can thus produce solutions as good as those found with former models in the literature the proposed method is especially advantageous for highly curved water tables given that this boundary is mapped into a horizontal line in the transformed domain and second order accuracy is therefore preserved complicated finite difference approximations near a curved water table which may induce instabilities are not necessary in the sigma mapping method it is not intended to disregard the use of former mathematical approximations proposed in the literature they are good and can be equally used however the sigma mapping is proposed as an alternative method in the portfolio of the groundwater flow modeler which is as good as other methods simple to implement and accurate for a highly curved water table either steady or unsteady the sigma mapping is a widely used and highly successful technique in the water waves problems where the governing equations are germane to those of unsteady seepage problems considered here directions for further generalizations encompass anisotropy and heterogeneous conditions for 3d flows over a general bathymetry as is pointed out in the paper author statement all the authors of this article have equally contributed to all the stages of its development declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have influenced this research acknowledgments oscar castro orgaz would like to thank prof michael bestehorn brandenburg university of technology cottbus germany for his kind advice and support during this research he also thanks dr neville i robinson flinders university australia for the interesting discussions on the polubarinova kochina rectangular dam problem the work of o castro orgaz was supported by the spanish project pid2020 114688rb i00 and grant maría de maeztu for centers and units of excellence in r d ref cex2019 000968 m fncc was funded by mcin aei 10 13039 501100011033 and the nextgeneration eu prtr through the juan de la cierva program ijc2020 042646 i 
32,regional groundwater flow forecasting is frequently accomplished using model equations based on darcy s law the continuity equation and kinematic and dynamic boundary conditions for a time dependent water table to predict hydraulic heads and fluxes for homogeneous and isotropic aquifers the model reduces to laplace s equation for the hydraulic head and a transient non linear free surface boundary condition these equations are solved in the literature and in computer packages by a variety of numerical methods including finite difference finite element and boundary element methods the solution of this model is not simple and subject to instability problems computations in a vertical plane using finite difference methods are not easy due to the irregular mesh needed near a highly curved water table frequently involving smoothing of the numerical results to ensure stability a technique to avoid the complications related to mesh generation near a curved boundary and its tracking entails using mappings to produce transformed domains however this is not so frequent to compute unsteady seepages in particular the so called sigma mapping is widely used to model irrotational water waves it applies to any flow involving a time dependent free surface boundary this mapping transforms the domain into a rectangle so that the free surface becomes static in the transformed plane there is close similarity between the mathematical model describing irrotational water waves and that of unsteady seepage flow e g both are governed by laplace s equation involving relevant boundary conditions at the moving boundary both moving free surfaces are different in character e g the seepage is dissipative whereas the water wave is dispersive however it is possible to transfer mathematical approximations between both fields of research this transfer is exploited in this work and the sigma mapping is newly and successfully applied to seepage flows involving both a steady and unsteady water table either receiving or not a recharge from rainfall or an artificial source keywords groundwater recharge seepage flow sigma mapping time dependent water table data availability no data were used for the research described in the article 1 introduction an important problem of groundwater hydrology is the determination of the mathematical quantities necessary for regional management as the hydraulic heads and fluxes wang and anderson 1982 rushton 2003 serrano 2003 anderson et al 2015 flow in unconfined aquifers is governed by an elliptic partial differential equation which reduces to laplace s equation for homogeneous and isotropic aquifers and a complex transient non linear partial differential equation describing the position of the phreatic surface the solution of the general groundwater flow problem with a non linear free surface boundary condition is not simple methods to attack the problem include numerical modeling using finite difference finite element and boundary element methods analytical methods using complex variables and simplified dimension reduced models applying the well known dupuit forchheimer theory bear 1972 strack 1989 2017 anderson et al 2015 there are widely used modern computer packages based on finite elements and finite difference methods which permit the modeler to tackle complicated real problems of groundwater flow that cannot be handled using analytical methods examples are feflow which uses finite elements diersch 2014 and modflow which is based on finite differences harbaugh 2005 anderson et al 2015 complex variables and conformal mappings are widely applied in the groundwater literature to solve steady two dimensional 2d flows for simplified geometries and constant groundwater parameters muskat 1942 polubarinova kochina 1962 harr 1962 bear 1972 boast 1977 boast and baveye 1989 strack 2017 whereas linearizations and the dupuit forcheimer theory are frequently used to solve simplified versions of the equations governing unsteady seepage bear 1972 analytical methods based on complex variables are important to get insights on groundwater flow phenomena and to check the correctness of numerical models of the full equations crank 1984 strack 2017 graphical and analogue methods are currently not frequently used in most cases a time dependent full three dimensional 3d solution or even 2d is only feasible by resorting to numerical methods rushton and redshaw 1979 wang and anderson 1982 the focus of this work is to solve such problems involving a time dependent water table in the vertical plane solving the full equations thus dupuit s bear 1972 and higher order approximations knight 2005 castro orgaz et al 2012 are not considered the solution of the full groundwater flow problem in a vertical plane was accomplished in the literature using several methods including finite differences finnemore and perry 1968 todsen 1971 verma and brutsaert 1971 singh 1976 wang and anderson 1982 miles 1986 chakib and nachaoui 2005 harbaugh 2005 finite elements neuman and witherspoon 1970 1971 wang and anderson 1982 diersch 2014 and boundary elements liu and liggett 1979 1980 bruch 1991 methods possibly the simplest yet very useful method is that of finite differences pinder and bredehoeft 1968 rushton and redshaw 1979 wang and anderson 1982 harbaugh 2005 anderson et al 2015 the solution of the exact equations by this technique is prone to some difficulties miles 1986 related to the presence of a highly curved water table whose position is unknown in advance near a curved boundary the standard discretization of laplace s equation involving a computational stencil with 4 equi spaced nodes in a regular mesh thom and apelt 1961 rushton and redshaw 1979 wang and anderson 1982 is not valid a taylor expansion can be used to produce special finite difference formulae for the internal nodes just below the water table miles 1986 but its tracking becomes complicated and the accuracy of the finite difference formulae decreases finnemore and perry 1968 todsen 1971 lapidus and pinder 1982 this may produce instability problems during the solution if the nearest node adjacent to the water table is too close to it miles 1986 or even failure if the computed drawdown is larger than one cell rushton and redshaw 1979 a possible means to avoid such complications is to use transformed domains chu 1971 oberkampf 1976 crank 1984 jie et al 2004 for the solution of an unsteady seepage but these are not so frequent and most of the solution procedures available are directly applied to the physical plane other methods are available for steady flow including the hodograph method with numerical conformal mapping bakker 1997 axisymmetric flow to a well with seepage face luther and haitjema 1999 3d flow to radial collector wells bakker et al 2005 and separation of variables ameli and craig 2014 the solution of the laplace equation for a potential function is a classical problem of hydrodynamics liggett 1994 serrano 2003 irrotational water waves are described by laplace s equation for the internal flow field supplemented with relevant boundary conditions vallentine 1969 at the free surface the moving boundary is described by a kinematic boundary condition plus a dynamic boundary condition the bernoulli equation vallentine 1969 liggett 1994 katopodes 2019 flow in a homogeneous incompressible and isotropic phreatic aquifer is also described in terms of the laplace equation for the internal flow field below the water table or phreatic surface which is at atmospheric pressure bear 1972 the kinematic boundary condition at a water table expressed in terms of the water depth and velocity components is identical to that of the water waves problem a major difference in the solution of moving boundary value problems in water waves and seepage flows stems from the dynamic boundary condition which in the case of seepage flow is an algebraic identity equating the potential to the elevation bear 1972 liggett 1994 there is also a special boundary condition in seepage flows which does not appear in irrotational water waves the so called surface of seepage where the water exits from the saturated soil at atmospheric pressure despite the mathematical models describing water waves and seepage flows being similar there are significant physical differences between both flows the sign of the potential function in water waves problems and groundwater hydraulics is opposite serrano 2003 and the dissipative character of seepage flows contrasts with the dispersive feature in water waves tao 2020 however given that the mathematical model describing irrotational water waves is similar to that describing unsteady seepage flows with the main difference stemming from the dynamic boundary condition at the moving boundary it seems logical to seek extrapolation from one field of mathematical procedures to another liggett 1994 here we follow this motivation and propose in this work the widely used σ mapping in the field of water wave modeling problems haussling and van eseltine 1975 li and fleming 1997 bestehorn and tyvand 2009 bihs et al 2020 tao 2020 to seepage flows this produces a transformed domain where the tracking of a highly curved free surface is simple the σ mapping is a coordinate transformation used to solve water waves problems haussling and van eseltine 1975 li and fleming 1997 bestehorn and tyvand 2009 bihs et al 2020 tao 2020 where the governing equations and boundary conditions are transformed to a simplified rectangular domain there the moving boundary remains fixed during the time dependent movement apparently this method is not considered in the literature of groundwater hydrology and thus the present work aims at presenting its details and applications to several key problems of this discipline it transforms the time dependent water table into a stationary boundary the domain is thus mapped in a rectangle where second order finite differences apply free surface computations using a locally irregular mesh which reduce the accuracy to first order and introduce instabilities are thus fully avoided the method was found to be very simple and it is applied in the ensuing sections to problems involving both a steady and unsteady seepage receiving or not a recharge from the rainfall or artificially as shown the sigma mapping method provides the groundwater flow modeler with an alternative technique to those currently used 2 sigma mapping for flow in phreatic aquifers 2 1 fundamental equations and boundary conditions we consider that 2d flow in the vertical plane x z of a homogeneous and isotropic porous media can be described in terms of the seepage or darcy velocity components u and w in the x and z directions fig 1 by respectively bear 1972 rushton and redshaw 1979 strack 1989 kacimov and obnosov 2019 kacimov et al 2020 1 u k ϕ x w k ϕ z here k is the saturated hydraulic conductivity and ϕ the potential function for seepage flow in porous media the potential function has a clear physical meaning namely the piezometric pressure head or hydraulic head obtained by summing the pressure head p ρg to the elevation z bear 1972 2 ϕ x z t p x z t ρ g z in hydrodynamics however e g as in water waves problems the potential function is an abstract quantity used only to obtain the kinematic field by differentiation liggett 1994 inserting eq 1 into the continuity equation for a rigid aquifer considering that the water is incompressible u x w z 0 produces the laplace equation in terms of ϕ as muskat 1942 rushton 2003 serrano 2003 kacimov and obnosov 2019 kacimov et al 2020 3 2 ϕ 2 ϕ x 2 2 ϕ z 2 0 eq 3 is the fundamental differential equation describing the flow in a homogeneous isotropic and rigid aquifer storing water assuming it is incompressible i e neglecting the specific storage effects bear 1972 raudkivi and callander 1976 rushton and redshaw 1979 strack 1989 to formulate a well posed problem boundary conditions are required we assume that the aquifer bed a d is impervious and horizontal thus the no flow condition normal to it results in 4 ϕ z 0 this is the kinematic bottom boundary condition at the phreatic surface b c boundary conditions are not simple the position of this boundary is in general time dependent and it may receive a recharge rate n fig 1 as usual in moving boundary value problems an unknown boundary requires two boundary conditions to locate it crank 1984 typically one kinematic and the other dynamic liggett 1994 the kinematic boundary condition describing the time evolution of the phreatic surface may be stated as todsen 1971 bear 1972 rushton and redshaw 1979 5 n e k h t ϕ z ϕ x h x n k here ne is the effective porosity or specific yield and h is the saturated thickness or water depth fig 1 this relation is basically an evolution equation for the water table position at the water table another unknown is the potential ϕ mathematically determined by a dynamic condition in water waves hydrodynamics the dynamic equation is given by bernoulli s law vallentine 1969 liggett 1994 in porous media given that the potential function is the piezometric pressure and that the pressure at the water table surface is zero one finds the simpler dynamic boundary condition bear 1972 liggett 1994 6 ϕ x z t z at a surface of seepage boundary condition the pressure is atmospheric and eq 6 is also the relevant boundary condition there polubarinova kochina 1962 harr 1962 bear 1972 eqs 5 and 6 are used simultaneously to determine the position of the moving water table lateral boundary conditions are necessary and will be described specifically in each of the test cases conducted in ensuing sections e g the distributions ϕ 0 z t and ϕ l z t a numerical solution of eqs 3 6 in the x z plane by a finite difference method involves a special treatment to locate the position of the water table in both steady shaw and southwell 1941 finnemore and perry 1968 khan and rushton 1996a and unsteady todsen 1971 verma and brutsaert 1971 singh 1976 guvanasen and volker 1980 brock 1982 khan and rushton 1996b flows frequently involving a smoothing of numerical results in the next section we describe the σ mapping to avoid such free surface tracking complications note that time derivatives appear only in eq 5 2 2 σ transformation in this section we employ a technique to map a general flow domain a b c d a fig 1 into a rectangle the mapping needed is called sigma mapping and it is given by the coordinate transformation z σ 7 σ x z t z h x t referring to fig 1 it observed that the moving boundary maps into the line σ 1 therefore a moving boundary value problem is transformed into a steady boundary value problem the sigma mapping is not new it was originally developed by phillips 1957 for numerical weather forecasting this mapping has been successfully applied in hydrodynamics and it is a particular case of more general coordinate transformations chu 1971 oberkampf 1976 in water waves problems the σ mapping is a widely used tool in models for solving irrotational wave motion the first application in this field was possibly by haussling and van eseltine 1975 in these water waves models the laplace equation and boundary conditions are transformed using the sigma mapping prior to the numerical discretization haussling and van eseltine 1975 li and fleming 1997 bingham and zhang 2007 engsig karup et al 2009 bestehorn and tyvand 2009 bihs et al 2020 wang et al 2022 however to the authors knowledge this mapping has so far not been applied to flow in porous media given the similarities between the model equations for irrotational water waves and flow in porous media liggett 1994 and the successful results applying the sigma mapping in the former field this section presents the σ mapping for porous media flows the laplace eq 3 will be transformed to the sigma plane in the sigma transformation the z coordinate is replaced using z σh where σ is the new independent variable representing the vertical dimension using this transformation in the potential function reads 8 ϕ x z t ϕ x σ h t ϕ x σ x z t h x t t in the sigma plane the independent variables are x σ t on inspecting eq 8 note that the water table h is only a function of x t therefore one may also write the following functional identity from eq 8 9 ϕ x z t ϕ x σ t now the transformation requires computing the partial derivatives of the potential function in eq 9 with respect to x z using the chain rule the following statements link the first spatial derivatives in the x z and σ x planes 10 ϕ x ϕ x ϕ σ σ x ϕ z ϕ σ σ z differentiation of the coordinate transformation eq 7 produces 11 σ x z h 2 h x σ z 1 h inserting eqs 11 in eq 10 yields the desired transformation of derivatives between planes 12 ϕ x ϕ x σ h ϕ σ h x ϕ z 1 h ϕ σ the same procedure is used for computing the second spatial derivatives resulting in 13 2 ϕ x 2 x ϕ x σ h ϕ σ h x σ ϕ x σ h ϕ σ h x σ x 2 ϕ x 2 σ 2 h x h 2 h x x h ϕ σ 2 σ h x h 2 ϕ x σ σ 2 h x h 2 2 ϕ σ 2 2 ϕ z 2 σ ϕ σ σ z σ z 1 h 2 2 ϕ σ 2 where hx h x and hxx 2 h x 2 using eqs 13 the laplace eq 3 reads on the σ x plane dropping the tildes for simplicity of notation haussling and van eseltine 1975 li and fleming 1997 bingham and zhang 2007 engsig karup et al 2009 bestehorn and tyvand 2009 bihs et al 2020 wang et al 2022 14 h 2 2 ϕ x 2 1 σ h x 2 2 ϕ σ 2 2 σ h h x 2 ϕ x σ 2 σ h x 2 σ h h x x ϕ σ 0 note that mathematically the σ transformation introduces singularities in the laplace equation if hx or hxx or both simultaneously this is a limitation caused by the mapping at least one case is realistic in groundwater flow problems namely hx at the intersection of the water table and a seepage surface bear 1972 this case is discussed in more detail in following sections but it is relevant to introduce it here this kind of singularity occurs at a boundary section of the aquifer where the distribution of ϕ is known therefore laplace s equation is not solved at that section so the singularity does not affect it however the position of the water table at that boundary section is unknown and shall be computed as part of the solution using eqs 11 12 the kinematic boundary condition eq 5 transforms to 15 n e k h t 1 h x 2 1 h ϕ σ σ 1 ϕ x σ 1 h x n k along the line σ 1 representing the water table eq 6 shall also be satisfied therefore one may write in the σ x plane ϕ x hx resulting in the following form of the kinematic boundary condition 16 n e k h t 1 h x 2 1 h ϕ σ σ 1 h x 2 n k this equation also suffers from a singularity at hx therefore it cannot be used to track the position of the water table at its intersection with a seepage surface normalized variables are introduced now as follows 17 x z h ϕ l 1 h o x z h ϕ l u w 1 k u w t k n e h o t where ho is a scaling length to be defined in each test the use of these normalizations does not alter the form of the laplace eq 14 whereas eq 16 simplifies to 18 h t 1 h x 2 1 h ϕ σ σ 1 h x 2 n k f x σ t where hats have been dropped for the sake of simplicity the bottom kinematic condition eq 4 and the free surface dynamic condition eq 6 remain unaltered after introducing the scalings a numerical method to solve eqs 4 6 14 18 and the relevant lateral boundary conditions ϕ 0 z t and ϕ l z t is needed this task is accomplished in the next section 2 3 numerical method a simple finite difference method is employed in the σ x plane haussling and van eseltine 1975 li and fleming 1997 bestehorn and tyvand 2009 bihs et al 2020 the x axis i index is discretized using m mesh points whereas j mesh points are used along the σ axis j index the step sizes of the mesh in the x and σ directions are x l m 1 and σ 1 j 1 respectively second order accurate finite differences abramowitz and stegun 1972 are used to approximate the derivatives of the potential as follows 19 ϕ σ ϕ i j 1 ϕ i j 1 2 δ σ 20 2 ϕ x 2 ϕ i 1 j 2 ϕ i j ϕ i 1 j δ x 2 21 2 ϕ σ 2 ϕ i j 1 2 ϕ i j ϕ i j 1 δ σ 2 22 2 ϕ x σ ϕ i 1 j 1 ϕ i 1 j 1 ϕ i 1 j 1 ϕ i 1 j 1 4 δ x δ σ the spatial water table derivatives are similarly given by 23 h x h i 1 h i 1 2 δ x 24 2 h x 2 h i 1 2 h i h i 1 δ x 2 inserting eqs 19 24 into the laplace eq 14 an algebraic system of linear equations is obtained for the potential at each i j node of the mesh the system of linear equations can be solved by efficient methods like the conjugate gradient method or by a multigrid method katopodes 2019 we employ a less efficient but simpler alternative namely a successive over relaxation method sor thom and apelt 1961 rushton and redshaw 1979 wang and anderson 1982 crank 1984 katopodes 2019 for a known distribution of the potential along the boundaries the method produces the solution of the internal potentials iteratively in the sigma mapping method the same discretizations are used for all the internal nodes of the finite difference mesh in contrast the numerical solution of the laplace equation in the x z plane involves the use of irregular computational stencils near a curved water table finnemore and perry 1968 todsen 1971 verma and brutsaert 1971 singh 1976 guvanasen and volker 1980 the resulting finite difference formulae to apply for the internal nodes close to this curved boundary is first order accurate lapidus and pinder 1982 and can produce stability problems miles 1986 in the sigma mapping the vertical mesh coordinate follows the free surface changes in the time dependent simulation but the number of mesh points in each vertical is fixed a careful specification of the potential at the boundaries is needed during the iteration process lateral distributions of potential are assumed to be known in the ensuing discussion e g ϕ 1 j and ϕ m j for j 2 to j 1 at the bottom a second order discretization of eq 4 produces 25 ϕ σ σ 0 3 ϕ i 1 4 ϕ i 2 ϕ i 3 2 δ σ 0 ϕ i 1 from which the bottom potential is determined as function of adjacent interior values in a vertical discretization of eq 18 the only equation with a time derivative is a critical aspect that shall be accomplished carefully the vertical gradient of the potential at the free surface is a crucial quantity approximated with second order accuracy as 26 ϕ σ σ 1 3 ϕ i j 4 ϕ i j 1 ϕ i j 2 2 δ σ inserting eqs 23 and 26 into eq 18 produces a semi discrete system of odes for each free surface node as follows 27 h t i f i j using eq 27 the water table position at time k 1 is determined from its position at time k as liggett 1977 liu and liggett 1980 diersch 2014 28 h i k 1 h i k θ f k 1 1 θ f k δ t here θ is a weighting factor positioning the evaluation of the water table derivative between times t k t and t t k 1 t liu and liggett 1980 recommended the optimum interval 0 5 θ 0 6 for stability and accuracy of solutions for θ 0 one gets the euler forward time stepping which is not accurate and prone to stability limitations whereas a fully implicit method results from θ 1 the value θ ½ corresponds to the second order crank nicolson method guvanasen and volker 1980 diersch 2014 which is the approximation used in this work to preserve second order time accuracy diersch 2014 the stability of solutions has been a source of ample debate miles 1986 todsen 1971 suggesting t 1 whereas guvanasen and volker 1980 proposing t 1 3 liu and liggett 1980 found that a small t is needed to guarantee the accuracy of the solution bruch 1991 proposed to set θ 0 7 based on liu and liggett 1980 and developed an implicit relation to determine an optimum t based on the prescribed θ value here we have adopted a simple procedure to determine t based on the courant friedrichs lewy condition hirt et al 1975 katopodes 2019 wang et al 2022 as follows 29 δ t cfl min δ x max u δ σ max w we have used throughout this work cfl 0 2 to reduce truncation errors during the time integration liu and liggett 1980 as previously remarked a singularity occurs at the intersection between the water table and a seepage face with the dam problem fig 2 as a typical case polubarinova kochina 1962 aitchison 1972 rushton and redshaw 1979 see point d in fig 2 let us denote the steady dam velocity components along the water table as us ws it can be demonstrated that the kinematic condition transforms to polubarinova kochina 1962 bear 1972 us 2 ws 2 kws 0 representing the dam problem in the hodograph plane fig 2b this equation is a circle at point d of the circle us 0 and ws k e g there is no singularity in the darcian velocity components considering now the kinematic statement ws us h x one deduces that at point d h x the well known singularity in the water table profile this singularity occurs in the σ mapping model presented here and in general in all models using the kinematic condition ws us h x to track the water table position the consequence is clear eq 28 cannot be applied to locate the water table in this case consider that the singularity occurs at x l here we use a simple linear extrapolation of the interior solution at any instant of time as follows todsen 1971 rushton and redshaw 1979 miles 1986 30 h m 2 h m 1 h m 2 this approximation although crude was found to produce results of enough practical accuracy this is further discussed in the next section using as test case the dam problem a similar procedure is used for a seepage face at the upstream section x 0 use of a parabolic extrapolation produced a small variation in the results once the water table position is determined the surface potential is computed from 31 ϕ i j h i given that the f function is evaluated at time k 1 in eq 28 the determination of the distribution of potentials and the water table position at this instant of time is iterative the solution process starts with a guessed solution of h i and ϕ i j for k 1 typically the values of the former time step k then the distribution of internal potentials is updated by applying sor the bottom potential using eq 25 the water table position using eq 28 and the surface potential using eq 31 the process is iteratively conducted at each time instant until convergence is achieved it is determined using the condition 32 1 m j i j m j ϕ i j new ϕ i j ε where ε 10 12 was used to ensure accuracy the sor weighting factor ω was determined by numerical trial and error experiments and it was fixed to 1 8 during our computations once the converged distribution of potentials is available at time k 1 the normalized seepage velocities from eq 1 are determined now from 33 u ϕ x σ h ϕ σ h x w 1 h ϕ σ using second order finite differences and the time step is adjusted using eq 29 initial conditions h x 0 and ϕ x z 0 are necessary to have a well posed initial boundary value problem these are stated below for each test case conducted the time integration described above is conducted until reaching a target time the procedure permits to compute both unsteady and steady seepage as the limiting condition for t 3 test cases 3 1 polubarinova kochina dam problem the polubarinova kochina rectangular dam problem consists in the steady filtration of water through a homogeneous and isotropic porous medium with vertical boundaries polubarinova kochina 1940 muskat 1942 chapman 1957 polubarinova kochina 1962 boast 1977 kacimov and obnosov 2016 liu et al 2022 the geometry of the problem and boundary conditions are depicted in fig 2 muskat 1942 bear 1972 rushton and redshaw 1979 and the singularity at d was previously discussed for a steady seepage h t 0 in the water table kinematic condition fig 2a this is one of the few cases in seepage hydraulics where exact solutions are available in this section the solution generated using the sigma mapping will be compared to the exact solution described below the analytical solution of the steady dam problem by polubarinova kochina 1962 consists in the conformal mapping of the physical and hodograph planes into the upper half plane by applying the analytic theory of linear differential equations polubarinova kochina 1938 1940 the resulting integral relations for l hd ho and hs and the water table profile are available elsewhere polubarinova kochina 1962 crank 1984 hornung and krueger 1985a we have used the newton raphson method with a numerical jacobian matrix to solve the polubarinova kochina equations the maximum magnitudes of residual errors in our solution were 10 10 the results of our numerical solver were compared with hornung and krueger 1985a resulting in a perfect match up to the 6th decimal digit in their computations the exact solutions for three test cases with l 0 25 0 5 and 1 for hd 0 are plotted in fig 3 hd 0 was selected given the stronger drawdown for a given l than using hd 0 the ensuing conclusions remain unaltered by considering hd 0 numerical solutions obtained with the sigma mapping are also plotted in fig 3 these were obtained solving the initial boundary value problem fig 2a with the initial condition h x 0 1 for the numerical solutions of the sigma model 80 horizontal divisions and 50 vertical divisions were used the model was run until steady flow conditions established computations were absent from any stability problem as previously reported by todsen 1971 and finnemore and perry 1968 we remark that no smoothing algorithms were necessary in our numerical implementation as previously required in other models in general the numerical solutions of the sigma mapping are in good agreement with the exact solutions on inspecting fig 3 note that the surface of seepage is adequately predicted confirming that a linear extrapolation of the interior solution is accurate enough for practical computations there are few works in the literature presenting details on predicted internal flow variables in the dam problem polubarinova kochina 1962 is a notable exception as she presented the details of a 2d finite difference solution for a dam test case with l 2 3 and hd 1 6 like in the former tests a mesh with 80 50 horizontal and vertical divisions is used in the sigma model the computed water table profiles by the sigma model and that reported by polubarinova kochina 1962 are in good agreement fig 4a use of a mesh with 160 100 horizontal and vertical divisions does not produce a significant variation in the water table the distribution of the potential function ϕ x z given by polubarinova kochina 1962 was used to compute by using second order finite differences the vertical profiles of the horizontal velocity u for four representative locations shown in fig 4b including the boundary section at x 2 3 these results of polubarinova kochina are compared in the same figure with the predictions of the sigma mapping model resulting in an excellent match our computed velocity profile at the seepage face is in qualitative agreement with the shape reported by muskat 1942 of relevance is the non removable singularity in the u velocity component at x 2 3 see point c in fig 2 whose behavior is easily observed in the hodograph fig 2b computations with the finer mesh of 160 100 horizontal and vertical divisions resulted in a better resolved velocity profile near the singularity the unit discharge q crossing a vertical section was determined by numerical integration of the computed velocity profiles the results are plotted in fig 4a where the exact result given by dupuit s equation polubarinova kochina 1962 bear 1972 q k 2l ho 2 hd 2 is also available the computed discharge and the corresponding errors for the four positions where the velocity profiles are plotted in fig 4 b are reported in table 1 note that the numerical error is small with the outflow boundary section as the position with the largest error to further explore it an inset in fig 4a shows the behavior of the integrated discharge near x 2 3 as observed there is some growth of the errors near that section as expected from the approximate determination of the water table position there the results for a mesh of 160 100 horizontal and vertical divisions are plotted in the same inset as a dotted line showing a significant reduction of the error near x 2 3 as reported in table 1 the discharge error at x 2 3 for this refined mesh is reduced an alternative check of the accuracy of the water table determination is presented in fig 4c where the hodograph for the water table is plotted along with the free surface data pairs us ws computed with the sigma model note that the agreement of this check is also good a water table fall unsteady test case is considered in fig 5 the initial condition is a horizontal water table h x 0 1 at time t 0 the tailwater depth hd drops instantaneously below h x 0 thereby starting an unsteady drainage process todsen 1971 rushton and redshaw 1979 we considered the test previously conducted by cheng and li 1973 for l 2 3 and hd 1 6 the unsteady water table obtained with the sigma mapping method is compared in fig 5 with the results found by cheng and li 1973 using the finite element method at different times resulting generally in a good agreement the steady result of cheng and li 1973 is slightly lower than our result but the sigma mapping is in good agreement with the exact steady solution 3 2 drainage of recharge with symmetrical boundaries the problem of drainage of recharge with symmetrical boundaries consists in the steady filtration of water through a homogeneous and isotropic porous medium receiving steady vertical recharge n with tailwater depths hd at the vertical boundaries rusthon and youngs 2010 castro orgaz et al 2012 monfared et al 2022 by symmetry only half of the problem is considered the geometry and boundary conditions are depicted in fig 6 rusthon and youngs 2010 solved the recharge problem as a steady state boundary value problem their solution considered the methods and algorithms described in rusthon and redshaw 1979 in their approach to compute a steady seepage the water table position is determined iteratively assuming that the free surface is represented by a series of steps the position of the water table in each vertical column is adjusted until the pressure is atmospheric our solution with the sigma mapping considers the initial boundary value problem stated in fig 6 the initial condition assumed is static water in the porous medium equal to the length of the domain h x 0 l then the steady recharge n is introduced to the system at t 0 the tailwater depth drops to hd and the time variant flow adjustment occurs until reaching a steady state our results using 50 vertical and 80 horizontal divisions are compared with those of rushton and youngs 2010 in fig 7 for a water table profile involving n k 0 4 and hd l 0 2 both solutions are in good agreement yet the sigma mapping solution yields a maximum water depth at the symmetry axis x 0 slightly above that of rushton and youngs 2010 the sigma mapping solution preserves second order accuracy in all numerical discretizations including those related to the water table boundary therefore the method is especially suitable for strongly curved water tables as is this case the sigma mapping results are further compared with hornung and krueger s 1985b results for two water table profiles with n k 0 4 and 0 1 under hd 0 fig 8 achieving an excellent match of both sets of results the accuracy of the results by hornung and krueger 1985b is thus similar to that of the present method the variations of the maximum groundwater depth hm at the symmetry plane and the minimum groundwater depth hs at the seepage face are considered in fig 9 a as function of the normalized recharge n k for dry tailwater channels hd 0 there is an excellent match of our results with hornung and krueger 1985b and minute deviations from the results of rushton and youngs 2010 the case involving hd l 0 5 n k is shown in fig 9b where our results are also very close to rushton and youngs 2010 3 3 growth of groundwater ridges the growth of groundwater ridges consists in the rise of a mouth of groundwater in response to a steady percolation n in a finite strip l of an infinite aquifer in the x direction only half of the problem is considered by symmetry the geometry and boundary conditions are depicted in fig 10 marino 1967 initially the water depth is ho in all the domain percolation n then starts at t 0 initiating the time dependent drainage process the length of the computational domain ab is 15ho in this test and the mesh used had 50 and 350 vertical and horizontal divisions respectively the aquifer is infinite in the x direction thus the vertical equipotential cb is taken for the computations far away from the recharge strip l in section cb there is not any portion in contact with the atmosphere given that it is just a truncation of the infinite x domain therefore seepage faces are not formed initially the saturated thickness in the aquifer is constant and equal to ho and the water is static these computational conditions mimic the experiments by marino 1967 a test case by marino 1967 is considered in fig 11 where the water table profiles obtained at times t 2 23 11 15 and 20 07 in a hele shaw experimental device are plotted in this test n k 0 1334 and l ho 2 106 the sigma mapping solution is plotted in the same figure and compared with the boundary element solution by bruch 1991 the present results are generally in very good agreement with bruch 1991 as well with liu and liggett 1979 results not included to keep the figure clean the predictions of both the sigma mapping and the boundary element method are in excellent agreement with the hele shaw results for t 2 23 yet some deviations are noted at later times especially in the recharge strip these deviations were previously reported in the literature and attributed to problems with the experimental device liu and liggett 1979 bruch 1991 4 discussion of results and limitations the sigma mapping was used in this work to transform the mathematical equations for an initial boundary value problem involving a moving water table in porous media the transformation is not new but it was newly applied to groundwater flows it was found that the water table determination with the proposed method is simple the sigma model produced results in conformity with former solutions available in the literature involving the use of the finite element method boundary element method and finite difference method in the physical plane numerical smoothing during computations was not needed stability problems were absent contrary to some of former numerical implementations the sigma mapping transformation proposed was applied to problems in the vertical plane x z however its application to 3d flows x y z is straightforward and does not entail any different conceptual treatment harbaugh 2005 for details see li and flemming 1997 the aquifer was considered homogeneous and isotropic thus the mass conservation equation for the interior of the aquifer simplifies to laplace s equation for the hydraulic head the modeling of groundwater flow as 2d saturated flow in homogeneous aquifers is a widely used tool serrano 2003 kacimov and obnosov 2019 kacimov et al 2020 extension to heterogeneous and anisotropic conditions is in principle not a difficult task in the finite difference set up it involves a more general form of the mass conservation equation introducing the variations of the hydraulic conductivity bear 1972 rushton 2003 anderson et al 2015 the aquifer was assumed to be rigid and the water incompressible thus the mass conservation equation lacks a time derivative if these effects are accounted for by introducing the specific storage effect pinder and bredehoeft 1968 bear 1972 harbaugh 2005 barua and alam 2013 anderson et al 2015 the resulting equation can also be transformed using the sigma mapping and included in the time stepping procedure inclusion of an uneven bathymetry is another straightforward generalization of the method by defining the sigma mapping as 34 σ x y z t z z b x y h x y t where y is the lateral coordinate and zb x y is the aquifer bed bathymetry it further involves a redefinition of the kinematic bottom boundary condition which is again straightforward the bottom profile is defined by σ 0 and the water table by σ 1 a limitation of the sigma mapping is that it is not valid for hx given that this derivative appears in the laplace eq 14 and the kinematic surface condition eq 18 this situation occurs at the intersection of the water table and the seepage face see point d in fig 2 boast 1977 discussed that although hx is the exact condition at point d in practical computations the water table slope there is finite thus the linear extrapolation that we used is justified for practical purposes there is a theoretical limitation of the proposed model at point d but from a practical view point the limitation is not strong as previously analyzed in fig 4 another interesting mapping previously used is that of boadway 1976 applied by crank and ozis 1980 for steady seepage flow in the rectangular dam problem substituting the functional dependence ϕ ϕ x z by x x ϕ z it was applied only to steady flows and there is not a simple transformed domain into a rectangle as in the sigma mapping the main purpose of this research is to present the σ mapping and its application to several important cases of porous media flows we have used a finite difference method which is simple with parameter values of θ 0 5 cfl 0 2 ε 10 12 and ω 1 8 that produced accurate solutions in a reasonable running time on a personal computer these values are by no means universal and the optimum numerical set up was not investigated being outside the scope of the work these may be optimized by the modeler other numerical implementations including a different spatial discretization e g using finite elements neuman and witherspoon 1970 1971 diersch 2014 and time stepping approaches with a multistep method e g a runge kutta scheme katopodes 2019 may be adopted 5 concluding remarks in this work a widely used mapping technique in water waves problems is newly applied to the mathematical equations describing an unsteady water table movement in isotropic and homogeneous aquifer the proposed σ mapping transforms the time dependent and curved water table in the vertical plane x z into a straight line σ 1 in the plane x σ thus a moving boundary value problem transform into a fixed boundary value problem the proposed method was compared with solutions available in the literature either using finite difference finite element or boundary element methods resulting in general agreement the method was equally applied to steady and unsteady seepage problems the solutions were found to be in excellent agreement with the exact polubarinova kochina solution for the dam problem the method can thus produce solutions as good as those found with former models in the literature the proposed method is especially advantageous for highly curved water tables given that this boundary is mapped into a horizontal line in the transformed domain and second order accuracy is therefore preserved complicated finite difference approximations near a curved water table which may induce instabilities are not necessary in the sigma mapping method it is not intended to disregard the use of former mathematical approximations proposed in the literature they are good and can be equally used however the sigma mapping is proposed as an alternative method in the portfolio of the groundwater flow modeler which is as good as other methods simple to implement and accurate for a highly curved water table either steady or unsteady the sigma mapping is a widely used and highly successful technique in the water waves problems where the governing equations are germane to those of unsteady seepage problems considered here directions for further generalizations encompass anisotropy and heterogeneous conditions for 3d flows over a general bathymetry as is pointed out in the paper author statement all the authors of this article have equally contributed to all the stages of its development declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have influenced this research acknowledgments oscar castro orgaz would like to thank prof michael bestehorn brandenburg university of technology cottbus germany for his kind advice and support during this research he also thanks dr neville i robinson flinders university australia for the interesting discussions on the polubarinova kochina rectangular dam problem the work of o castro orgaz was supported by the spanish project pid2020 114688rb i00 and grant maría de maeztu for centers and units of excellence in r d ref cex2019 000968 m fncc was funded by mcin aei 10 13039 501100011033 and the nextgeneration eu prtr through the juan de la cierva program ijc2020 042646 i 
33,a spur dike is an in stream structure one end of which is situated on the bank of a channel while the other extends into the current its primary functions include protecting stream banks and enhancing aquatic habitats the motivation of this study stems from the hypothesis that a wake parameter defined as the product of the length to depth ratio of spur dikes and the bottom friction factor serves as the key parameter in characterizing the flow pattern around these structures the objectives of this study are two fold 1 to determine the critical value of a wake parameter for the transition from three to two dimensional flow fields around spur dikes and 2 to examine the bed shear stress distributions around spur dikes with varying length to depth ratios flow visualization experiments and large eddy simulations less were conducted with length to depth ratios ranging from 1 to 7 5 corresponding to wake parameter values between 0 005 and 0 075 the experimental and numerical results revealed various flow structures around and in the wake of the spur dike when the length to depth ratio was close to 1 the two and three dimensional flow patterns coexisted around the spur dike however as the length to depth ratio increased the three dimensional flow structures diminished and the two dimensional flow structures became more pronounced for an length to depth ratio of 7 5 the flow pattern showed fully two dimensional structures featured by an upstream and a pair of downstream recirculation regions with negligible secondary flows a horseshoe vortex and a free surface vortex a horseshoe vortex system contributed to a significant increase in both mean and root mean square bed shear stresses near the tip of spur dikes especially when the wake parameter values were low the upstream recirculation zone was associated with very low bed shear stress at high values of the wake parameter the results of this study corroborated that the flow around the spur dikes becomes fully two dimensional when a wake parameter exceeds a critical value of approximately 0 04 keywords river restoration river flow flow modeling environmental fluid mechanics data availability data will be made available on request 1 introduction the rectangular in stream structures attached to channel banks known as spur dikes or groynes have been widely employed for the protection of river bank erosion spur dikes are also used for increasing the water depth for navigation purposes and for creating a pool to enhance aquatic habitats although several studies have been conducted on the flow mechanism and sediment transport processes around these structures our current understanding remains incomplete this is largely owing to the challenging measurement and prediction of three dimensional and turbulent flow patterns around these structures even at moderate reynolds numbers the existing research on the three dimensional turbulent flow fields around these structures is insufficient and a reliable design method that accounts for the complex flow physics around the spur dikes has yet to be developed to better understand the flow patterns around spur dikes it is essential to identify the relevant dimensionless parameters dimensional analysis will reveal that the dimensionless parameters that characterize the flow around emergent obstacles in an open channel are the reynolds number r e u h ν froude number f r u g h relative roughness height ϵ h length to flow depth l h ratio and channel length to width l w or blockage ratio where h is the depth u is the velocity g is the gravitational acceleration ν is the kinematic viscosity l is the obstacle length w is the channel width and ϵ is the roughness height the effect of f r may be ignored for flows with a low f r assuming that the free surface deformation is not significant in addition if the blockage effect is assumed to be negligible the l w ratio can be ignored then the remaining parameters are l h r e and ϵ h chen and jirka 1995 introduced a shallow wake parameter s to determine the flow characteristics around emergent or non submerged structures in open channels this parameter was defined as s c f l h where c f 2 u u 0 2 is the bottom friction factor that is a function of r e and ϵ h u 0 represents the characteristic velocity and u denotes the shear velocity chen and jirka 1995 and jirka 2001 performed laboratory experiments to explore the wake characteristics around various emergent bluff bodies in an open channel for instance for a bottom mounted circular cylinder they demonstrated that different wake structures exist depending on the value of s the vortex street type with an oscillating vortex shedding mechanism s 0 2 the unsteady bubble wake type with a downstream recirculation bubble having flow instabilities growing downstream 0 2 s 0 5 and the steady bubble wake type without the flow instabilities s 0 5 the shallow wake parameter was originally proposed for bluff bodies located away from a sidewall however it may also be used to characterize the flow patterns around a spur dike because both flows have the same dimensionless parameter groups therefore s is also hypothesized to be a key parameter that governs the flow patterns around a spur dike for a smooth bed channel where ϵ h 0 s is dependent on c f and l h values as stated by jirka 2001 c f is approximately 0 005 and 0 01 under field and laboratory conditions respectively this indicates that the value of c f varies within a relatively narrow range of approximately 0 005 to 0 01 considering this limited variability l h emerges as a more dominant factor than c f in determining the wake parameter s thus far few studies have investigated three dimensional flow patterns around spur dikes in relation to the l h ratio jeon et al 2018 and kang et al 2021b investigated the flow around the spur dikes with an l h ratio of 1 4 by conducting flume experiments and numerical simulations respectively jeon et al 2018 performed velocity measurements around a spur dike with an l h ratio of 1 4 using acoustic doppler velocimetry adv and observed three dimensional flow structures including a free surface vortex fsv a horseshoe vortex hsv and complex secondary flows kang et al 2021b conducted numerical simulations for the same spur dike revealing that the flow around the spur dike exhibits both two and three dimensional flow characteristics simultaneously in their study three distinct flow features were observed in the vicinity of the spur dike two dimensional vortex shedding originating from the tip of the structure as well as an fsv and an hsv upstream of the structure both with axes perpendicular to the channel sidewall additionally their study unveiled a two dimensional recirculating flow extending across the entire wake and a three dimensional recirculating flow situated in the corner region between the downstream surface of the spur dike and bed duan 2009 duan et al 2009 measured the flow around spur dikes with l h ratios of 0 9 and 1 25 respectively in the laboratory the measurements showed the existence of flow separation zones and secondary flows downstream of the spur dikes koken and constantinescu 2008 2009 2011 conducted numerical simulations for spur dikes with an l h ratio of 1 5 they investigated an hsv system around the spur dikes and demonstrated that the flow past a spur dike can exhibit highly three dimensional flow structures much higher l h ratios have been considered in a few other studies for instance higham et al 2017 measured the velocity fields around a rectangular groyne with an l h ratio of 6 25 using particle image velocimetry piv in a laboratory flume the measurements showed significantly different flow patterns compared with those for an l h ratio less than 2 they observed a two dimensional wake structure consisting of a pair of counter rotating recirculation regions downstream of the groyne and a small two dimensional recirculation region in the upstream corner between the groyne and sidewall of the channel paik and sotiropoulos 2005 investigated the flow around a rectangular block with an l h ratio of 27 using numerical simulations they observed flow patterns that were very similar to those reported by higham et al 2017 and comprised a pair of two dimensional counter rotating eddies downstream of the block and another two dimensional recirculation region upstream of the block other researchers investigated the flow field around bridge abutments which exhibit similar geometries to spur dikes kwan and melville 1994 employed the hydrogen bubble technique to measure the flow field around a bridge abutment model with l h ratios ranging from 2 4 to 9 5 on a mobile bed they observed that a primary vortex resulting from the upstream downflow was the main cause of scour at the abutments ahmed and rajaratnam 2000 measured the velocity profiles around an abutment model with an l h ratio of 0 55 on a fixed bed they found that the approach flow was deflected and skewed near the abutment and the bed shear stress increased approximately 3 6 times in the vicinity of the abutment nose dey and barbhuiya 2010 used adv to measure the velocity field near an abutment model with an l h ratio of 0 6 on a mobile bed most of the aforementioned studies on bridge abutments primarily focused on measuring scour or velocity profiles near abutments without significant consideration of three dimensional flow patterns a review of the aforementioned studies reveals that spur dikes can exhibit different flow patterns depending on l h ratio thereby indicating a possible dependence of the flow patterns on the the value of s nevertheless care must be taken before drawing any firm conclusion about this dependence because the flow patterns for different s values under similar flow conditions have not yet been compared three dimensional flow field data both near and in the wake of spur dikes need to be obtained for various s values for an effective comparison obtaining these data especially for the entire wake region with an length of 10 l 12 l in the downstream direction koken 2011 jeon et al 2018 kang et al 2021b using flow measurements will be time consuming an alternative method is to perform numerical simulations numerical models that solve the full three dimensional navier stokes equations combined with turbulence closure models are widely recognized for simulating complex open channel flows in particular three dimensional flow models based on advanced turbulence closure models such as large eddy simulation les or detached eddy simulation des have been successful in the prediction of complex flows involving unsteady vortex shedding flow separation vortex formation etc previous les or des studies in which the flow past spur dikes was investigated are summarized in table 1 in the majority of these studies wake patterns were not given much attention this is likely because of the considerations related to computational costs as shown in the table most of the previous studies employed fewer than 10 million grid points which may be insufficient for resolving the entire wake region however kang et al 2021b recently conducted an les study to examine the flow structures in the entire wake regions of a spur dike this les resolved the wake of a spur dike with an l h ratio of 1 4 using approximately 160 million grid nodes and grid spacing ranging from 0 8 to 70 wall units the computed velocity and turbulence fields both in the vicinity and far wake were in strong agreement with the adv measurements and flow visualization results reported by jeon et al 2018 this study has two primary objectives 1 to identify the critical value of s for the transition from three to two dimensional flow fields around spur dikes and 2 to examine the bed shear stress distributions around spur dikes at varying l h ratios to these ends we perform flow visualization experiments for spur dikes with l h ratios ranging from 1 to 7 5 as well as less for two selected cases l h ratios of 3 and 7 5 with grid resolutions comparable to those used in our previous les for an l h ratio of 1 4 kang et al 2021b by analyzing these results we examine the three dimensional flow structure turbulence characteristics and bed shear stress distributions around and in the wake of the spur dikes to the best of our knowledge this study is the first systematic exploration of the flow patterns and bed shear stress distributions around spur dikes at different l h ratios 2 flow visualization experiment 2 1 experimental set up flow visualization experiments were conducted in an open channel flume at hanyang university seoul south korea the flume was 18 m long 0 9 m wide and 0 4 m deep with a flat bed the sidewalls and bed were made of glass and polyvinyl chloride pvc respectively similar to the experiment conducted by jeon et al 2018 a rectangular spur dike model was attached to the bed and one of the sidewalls the lengths of the spur dike in the spanwise streamwise and vertical directions were 0 3 m 0 04 m and 0 4 m respectively the experiments were performed by sprinkling small styrofoam particles upstream of the obstacle and subsequently photographing their trajectories on the free surface using a digital camera with variable exposure times approximately between 10 15 s similar experimental techniques were successfully used by chrisohoides et al 2003 kang and sotiropoulos 2012 kang et al 2021b to identify the flow patterns around obstacles in open channels eight experiments were performed and the experimental conditions are presented in table 2 all experiments were run at a bulk velocity u 0 of approximately 0 2 m s in case 8 however a slightly lower u 0 was used to keep the froude number f r below 0 3 for cases 1 to 8 the l h ratio was gradually increased from approximately 1 to 7 5 by decreasing the h the reynolds number based on h r e h varied between 0 7 1 0 4 and 5 7 1 0 4 whereas the reynolds number based on l r e l varied between 5 0 1 0 4 and 6 0 1 0 4 in the experiments the value of r e h was not maintained constant instead it decreased incrementally from case 1 to case 8 this variation was because of the practical impossibility of maintaining a low f r number while keeping the r e h value constant particularly in cases with a small h value notably when the f r number exceeded 0 4 significant deformation of the free surface occurred in the vicinity of the spur dike chen and jirka 1995 also observed this difficulty while conducting flume experiments on wakes generated by circular cylinders they were unable to perform experiments for cases with both high r e h and s values where h was small and f r was high owing to the wave like free surface instabilities around the cylinders nevertheless they concluded from their measurement results that the classification of wake characteristics behind cylinders is uniquely dependent on the value of s provided that the ambient flow is fully turbulent i e r e h 1500 in the present study the minimum r e h value was approximately 6800 resulting in a fully turbulent wake this suggests that the wake behind the spur dike in the current study is also governed by the s value it should be noted that the value of c f must be known beforehand to obtain the value of s chen and jirka 1995 estimated the values of c f using the smooth wall relation from the moody friction diagram an approach ingram and chu 1987 also employed in experiments on wakes behind flat plates in the present study rather than using the moody diagram which was originally developed for pipe flows wall resolving les computations were performed for cases 1 8 to estimate the c f values the les computations were performed using 8 to 47 million grid points maintaining the same reynolds number as presented in table 2 further details on these les computations can be found in appendix the s values derived from the les computed c f values are listed in table 2 2 2 results the flow visualization results for cases 1 to 8 are presented in fig 1 arched flow trajectories marked with dashed lines can be seen around the spur dike jeon et al 2018 observed similar flow trajectories for a spur dike with an l h ratio of 1 4 and an s value of 0 01 c f 0 007 installed in the same channel they found that the trajectory was created by the collision of the incoming flow with a reversed flow region directly upstream of the spur dike see the arrows in case 1 subsequently kang et al 2021b performed numerical simulations to demonstrate that the reversed flow region was associated with an fsv i e a vortex system that was developed underneath the free surface upstream of the spur dike fig 1 reveals that the trajectories for cases 1 and 2 where 1 l h 1 5 and 0 005 s 0 01 are always located away from the upstream surface of the spur dike and they move significantly with time this movement was presumably associated with the low frequency streamwise oscillatory motion of the fsv that was discovered by kang et al 2021b for a spur dike with an l h ratio of 1 4 they using numerical simulation demonstrated that the fsv produced a spectral peak at the strouhal frequency of 0 02 in the velocity spectra thereby indicating the existence of low frequency oscillatory motion cases 7 and 8 where 0 047 s 0 075 displayed significantly different flow trajectory patterns to cases 1 and 2 where 0 005 s 0 01 first the arched trajectory was almost attached to the upstream tip of the obstacle indicating that the size of the fsv had decreased significantly second the position of the arched trajectory remained almost constant over time this was possibly associated with the weakened fsv in cases 7 and 8 third a two dimensional clockwise eddy was observed in the upstream corner region between the spur dike and the sidewall based on the above comparisons it can be inferred that at low s values three dimensional flow structures e g the fsv become more pronounced whereas at high s values two dimensional flow patterns e g clockwise eddy become more pronounced this result clearly indicates the decrease in the flow three dimensionality with respect to the s value further the comparison of the results for cases 1 8 indicates that the critical value of s that will lead to the formation of a two dimensional clockwise eddy at the free surface may be approximately 0 04 3 large eddy simulation 3 1 numerical methods the spatially filtered continuity and navier stokes equations for incompressible viscous fluids are written in cartesian coordinates as follows 1 u j x j 0 2 u i t u j u i x j 1 ρ p x i 1 ρ τ i j t x j where t is time u i is the filtered velocity vector p is the filtered pressure ρ is the density and μ is the dynamic viscosity τ i j t is the total stress tensor that is the sum of the viscous and sub grid scale sgs stresses 3 τ i j t μ u i x j τ i j s g s where τ i j s g s is the sub grid scale sgs stress tensor the les was performed using the numerical model developed by kang et al 2011 in which the above spatially filtered continuity and navier stokes equations eqs 1 and 2 were formulated in generalized curvilinear coordinates and the sgs terms were modeled using the dynamic smagorinsky model germano et al 1991 the les model employed the curvilinear immersed boundary curvib method ge and sotiropoulos 2007 implemented for turbulent flow simulations in open channels kang et al 2011 the curvib method allowed the handling of arbitrarily complex geometries such as those associated with irregular bathymetry and complex in stream structures without costly re meshing processes the method employs two different grid systems boundary fitted three dimensional curvilinear grids for a background flow domain and immersed boundary grids comprising triangular surface meshes for solid objects the present les model combined with the curvib method was successfully applied to solve various open channel flow problems kang et al 2016 khosronejad et al 2019 kang et al 2020 2021a 3 2 computational set up in kang et al 2021b the les was performed for a spur dike with an l h ratio of 1 4 here two additional less were conducted for l h ratios of 3 case 5 and 7 5 case 8 the computational parameters are presented in table 3 the less for cases 5 and 8 are hereafter referred to as les 1 and les 2 respectively fig 2 shows the coordinate system and computational domain as well as the spur dike that was treated using the curvib method the x y and z denote the streamwise spanwise and vertical directions respectively as illustrated in the figure the vertical dimensions of the computational domain for the les 1 and les 2 are different owing to the different l h ratios les 1 and les 2 were conducted on a computational domain with approximately 152 and 70 million grid nodes respectively in both cases the minimum and maximum grid spacings were 1 and 120 wall units respectively in the previous less kang et al 2021b used two different grids of approximately 57 million and 162 million grid nodes with the grid spacings of 3 to 226 and 1 to 70 wall units respectively they demonstrated that both grids produced nearly identical results that were in excellent agreement with the adv measurements thereby indicating that the coarser grid with 57 million points was sufficient to produce accurate and grid converged results the spatial resolution in the present les 1 120 wall units was much finer than that of the coarser grid 3 226 wall units of kang et al 2021b therefore the grid resolution in the les 1 and les 2 can be assumed to be sufficient to obtain a grid converged solution this was the reason for omitting grid convergence tests in the present study as table 1 shows the current less used more than 10 times the number of grid nodes than those reported by most other researchers similar to the previous les with an l h ratio of 1 4 kang et al 2021b the free surface was treated using the rigid lid approximation leschziner and rodi 1979 where the free surface was assumed to be a flat plane with zero shear stress this method was successfully applied to simulate free surface flows with low to moderate f r numbers calmet and magnaudet 2003 mccoy et al 2008 kang et al 2011 koken 2011 le et al 2019 a fully developed instantaneous turbulent velocity field obtained from a separate precursor simulation in a domain with streamwise periodicity was fed at the inlet x l 5 of the computational domain a zero gradient condition was imposed for the instantaneous velocities at the outlet x l 23 33 a no slip velocity condition was imposed at the bed z 0 and the sidewalls y l 0 and 3 because the near wall grid spacing 1 wall unit was sufficiently small to resolve the viscous sublayer velocity and shear stress boundary conditions were imposed at the immersed boundary nodes using the near wall model proposed by kang 2015 the less were first performed until the total instantaneous kinetic energy in the computational domain reached a steady state that required approximately 8 0 1 0 5 time steps subsequently the instantaneous flow field was averaged over time at each grid point for 2 4 1 0 5 time steps corresponding to 240 s in physical time the computations were performed on 400 cores of a linux cluster supercomputer comprising intel xeon e5 2650 v3 2 3 ghz cpus that were interconnected using fourteen data rate 56 gb s infiniband mellanox adapters and a switch the computation times for les 1 and les 2 were approximately 120 and 60 days respectively 3 3 results in this section the results of the les 1 and les 2 are presented and compared with those of the les for an l h ratio of 1 4 performed by kang et al 2021b a comparison of the flow parameters for the three less is shown in table 1 in the remainder of this study u v and w denote the instantaneous velocity components in the x y and z directions see fig 2 for the coordinates respectively τ indicates the bed shear stress magnitude q means the time averaged value of a time dependent variable q and q q q means the temporal fluctuation the turbulence kinetic energy tke is defined as k 0 5 u u v v w w fig 3 shows the instantaneous vortical structures around the spur dike visualized using the λ 2 criterion method jeong and hussain 1995 there are three distinct vortical structures the fsv hsv and shear layer vortex slv the slvs are apparently generated by the two dimensional vortex shedding from the upstream edge of the spur dike as the l h ratio increases the arrangement of the vortical structures remains similar but the fsv and hsv decrease in size and move closer to the spur dike a similar trend was observed in the flow visualization experiment in section 2 2 where the arched flow trajectory was observed to move close to the spur dike with an increasing l h ratio in fig 4 the vortical structures are viewed from above the obstacle for three different depth regions z h 0 4 near bed region 0 4 z h 0 8 mid depth region and z h 0 8 free surface region a comparison between the vortical structures in the free surface region and the flow visualization result is shown on the right side of the figure for an l h ratio of 1 4 both the hsv and fsv are clearly observed in the near bed and free surface regions both forming arched trajectories slvs are observed in all three regions and are attached to the tip of the spur dike at an l h ratio of 3 the hsv and fsv move closer to the spur dike but the location of the slvs remains unchanged compared to the case where the l h ratio is 1 4 at an l h ratio of 7 5 the hsv and fsv almost merge with the slvs these results demonstrate that the slv which is a two dimensional flow feature is observed for all depth regions regardless of the l h ratio however the hsv and fsv that are three dimensional flow features diminish in size with an increasing l h ratio the computed vortical structures in the free surface region and the flow visualization results are in excellent agreement thereby demonstrating the accuracy of the les results figs 3 and 4 showed markedly different instantaneous coherent structures for the three l h ratios this difference likely results from the competition between the two and three dimensional flow structures which can be influenced by the l h ratio and the wake parameter s it is plausible to assume that the parameters l and h are related to the maximum size of two dimensional in the x y plane and three dimensional coherent structures respectively therefore the l h ratio can be interpreted as a relative size or strength of two dimensional coherent structures compared to that of three dimensional structures it should be noted that the l h ratios for the three less were altered by varying the depth h while maintaining the length l constant this implies that the size of two dimensional coherent structures will remain similar across all three less whereas the size of the three dimensional structures will decrease as the l h ratio increases this accounts for the reduced thickness of the hsv and fsv observed at an l h ratio of 7 5 compared to the other two cases consequently it can be anticipated that at a sufficiently large l h ratio the hsv and fsv structures will become negligible in size and the flow field around a spur dike will become virtually two dimensional fig 5 displays the computed instantaneous y component vorticity ω y contours and streamlines at the y l 1 plane in the les for an l h ratio of 1 4 kang et al 2021b large positive and negative vorticity pockets near the bed and the free surface represent the hsv and fsv structures respectively the chaotic small scale vortical structures around them indicate the turbulent flow structures of the incoming flow the hsv system can be observed to not only oscillate back and forth but also expand and contract over time the instantaneous streamline plots reveal that the hsv system consists of one primary and several secondary vortices which seem to collide and merge with each other the primary hsv is observed to oscillate back and forth across a distance of approximately 0 1 l and these oscillations are likely to intensify the turbulent fluctuations of bed shear stress the time averaged flow fields are examined in the remainder of this section the mean flow and turbulence fields on x y and x z planes are presented in figs 6 and 7 respectively and the mean bed shear stress field is displayed in fig 8 fig 6 shows the mean dimensionless streamwise velocity u u 0 contours and two dimensional streamlines at z h free surface plane 0 5 h mid depth plane and 0 01 h near bed plane figs 6 a c and d show the results for l h ratios of 1 4 3 and 7 5 respectively the adv measured flow fields jeon et al 2018 and the measurement points in the mid depth and near bed planes are displayed in fig 6 b the computed and adv measured velocity fields and streamline patterns are observed to be in excellent agreement demonstrating the accuracy and reliability of the les results in fig 6 a the fsv and hsv are observed to exhibit converging streamlines forming arched trajectories and the slvs create diverging streamlines emanating from the tip these streamline patterns indicate that the fsv and hsv create helical flow structures between the converging and diverging streamlines near the bed and the free surface in the mid depth plane however only the converging streamlines a characteristic of the slv are observed the different streamline and velocity patterns in the three x y planes suggest that the velocity gradient in the vertical direction may be significant in the wake region thereby indicating the existence of three dimensional and secondary flow structures figs 6 c and 6 d show that the influence of the fsv and hsv weakens with an increasing l h ratio at an l h ratio of 7 5 the fsv and hsv almost merge with the slv upstream of the spur dike thus almost identical streamline structures are observed across the three different planes namely one small 0 5 l in the y direction recirculation zone directly upstream of the spur dike and two counter rotating recirculation zones in the wake region the upstream recirculation region or the clockwise eddy was also observed in case 8 fig 1 with a similar spanwise length of approximately 0 5 l flow patterns similar to the above were also documented by higham et al 2017 and paik and sotiropoulos 2005 for rectangular obstacles with l h ratios of 6 25 and 27 respectively in other words similar two dimensional wake structures were observed for l h ratios slightly smaller and much larger than 7 5 this strongly suggests that a two dimensional flow pattern that is independent of s values develops when the s value exceeds a certain critical value the flow visualization in fig 1 showed that the two dimensional recirculation region was clearly observed in the upstream corner in cases 7 and 8 where the s value was greater than 0 04 these results indicate that the critical value of s may be approximately 0 04 as depicted in fig 7 the tke contours and two dimensional streamline patterns are investigated for the planes at y l 0 25 0 5 0 75 and 1 the flow field in the x z planes can show the flow structures associated with the fsv and hsv upstream of the spur dike in detail the fsv and hsv are clearly observed upstream of the spur dike and there is another vortex downstream the downstream vortex was identified experimentally by jeon et al 2018 and numerically by kang et al 2021b for an l h ratio of 1 4 and was found to result in three dimensional flow structures in the near wake region the tke distribution in the figure shows that the downstream vortex is associated with very low tke levels in fig 7 a the fsv and hsv are observed to exhibit significant levels of tke at an l h ratio of 1 4 the peak levels of the tke for the fsv and hsv tend to increase with a decreasing l h ratio and with increasing distance from the sidewall the peak tke levels for the fsv and hsv are associated with the intensity of their low frequency oscillatory motion in the streamwise direction kang et al 2021b these results show that the fsv and hsv oscillate more energetically with an decreasing l h ratio and increasing distance from the sidewall although the hsv is much larger in size than the fsv for l h ratios of 1 4 and 3 they both become similar and negligible in size at an l h ratio of 7 5 previous studies on bottom mounted cylindrical obstacles devenport and simpson 1990 apsilidis et al 2015 schanderl et al 2017 paik et al 2007 escauriaza and sotiropoulos 2011 and rectangular spur dikes koken and constantinescu 2008 2009 suggest that the hsvs around bluff bodies can exhibit low frequency oscillations resulting in bimodal probability density functions for velocity fluctuations these bimodal oscillations are known to cause an order of magnitude increase in turbulent stresses devenport and simpson 1990 and therefore have significant implications for sediment transport a typical signature of an hsv system s bimodal oscillations is a c shaped distribution of tke contours apsilidis et al 2015 schanderl et al 2017 paik et al 2007 escauriaza and sotiropoulos 2011 in fig 7 a l h 1 4 the c shape distribution is clearly visible at the planes y l 0 5 0 75 and 1 this indicates that the streamwise oscillations of the hsv system observed in fig 5 are presumably associated with the bimodal oscillations the c shape distribution remains visible at an l h ratio of 3 but nearly vanishes at an l h ratio of 7 5 these findings indicate that the oscillations of the hsv intensify with decreasing values of s and increasing distance from the sidewall another important flow parameter worth investigating is the local bed shear stress that is directly relevant to the sediment erosion or deposition around the in stream structures in mobile bed conditions the local bed shear stress distribution in a fix bed condition can provide useful insights regarding the local scour processes around the in stream structures especially during the initial stages of the scour however obtaining direct measurements of the bed shear stress even at a single point in turbulent boundary layers is a very difficult task and it is nearly impossible to obtain such measurements at hundreds of thousands points alternatively the bed shear stress can be estimated using indirect methods based on a logarithmic velocity law or reynolds shear stress distribution biron et al 2004 but a reliable indirect method applicable to complex flows involving flow separation and vortex shedding has yet to be proposed predicting the bed shear stress using numerical simulation is also challenging despite the presence of advanced turbulence models such as les it is because the grid resolution near the wall should be sufficiently small to resolve the viscous sublayer to accurately compute the velocity gradients at the wall owing to the sufficiently small near wall grid spacing 1 wall unit used in the less presented in this study the bed shear stress τ can be calculated with a good accuracy without introducing any empirical wall modeling in fig 8 the dimensionless mean and root mean square bed shear stress distributions are plotted alongside the mean streamlines the two dashed lines indicate the converging and diverging streamlines that outline the extent of the hsv system on the bed it can be seen that the hsv significantly increases both mean and root mean square bed shear stresses the maximum bed shear stress occurs near the tip of the spur dike whereas a very low mean bed shear stress is observed in the two dimensional corner eddy region see the arrows in most areas away from the spur dike τ is observed to be greater than τ r m s however near the hsv region and the tip of the spur dike τ r m s becomes comparable to or even surpasses τ particularly at an l h ratio of 1 4 this implies that fluctuating bed shear stress in the hsv region and near the tip can be significant which will be further discussed in fig 9 the observed bed shear stress distributions above suggest that the scour hole around the spur dike may grow differently over time depending on s values when s values are approximately 0 01 a scour hole is likely to begin forming near the tip of the spur dike and gradually expand toward the sidewall over time in this instance owing to the absence of a two dimensional recirculation region in the upstream corner there may be considerable bank erosion potential near the sidewall when s values exceed a critical threshold a scour hole might only form in the vicinity of the tip without extending toward the sidewall as the two dimensional corner eddy reduces the bed shear stress fig 9 displays the streamwise profiles of τ τ r m s and τ r m s τ at y l 0 75 τ r m s τ represents the relative fluctuation of the bed shear stress cheng et al 2004 indicating the turbulence effects on bed shear stress as seen the τ profiles exhibit a single peak within the hsv region however the τ r m s profiles display two peaks near the upstream and downstream boundaries of the hsv region the occurrence of these two peaks near the hsv boundary is likely associated with the back and forth oscillations of the hsv system observed in fig 5 the profiles of τ r m s τ also exhibit two peaks and the peak values increase with a decreasing l h ratio at an l h ratio of 1 4 the peak values of τ r m s τ even exceed 1 it should be noted that most of the existing sediment transport models neglect these effects τ r m s 0 on bed load transport and some stochastic models account for these effects by assuming a constant τ r m s τ ratio for instance paintal 1971 and gessler 1970 assumed τ r m s τ values of 0 5 and 0 57 respectively the large and rapidly varying τ r m s τ ratio observed near the hsv system suggests that sediment transport models assuming either zero or constant τ r m s τ ratio may significantly underestimate the bed load transport rate in these regions especially when the l h ratio is small 4 summary and conclusion in this study the flow patterns around a spur dike in an open channel flume were investigated using flow visualization and numerical simulations the flow visualization experiments for l h ratios between 1 and 7 5 0 005 s 0 075 revealed the formation of an arched flow trajectory around the spur dike oscillating back and forth in time at a low l h ratio this trajectory was owing to the fsv the size of the fsv structure at the free surface was estimated based on the distance between this trajectory and the upstream surface of the spur dike as the l h ratio decreased the flow trajectory moved away from the spur dike while the oscillation increased thereby indicating a large size and strong effect of the fsv as the l h ratio increased the trajectory moved toward the spur dike when the l h ratio exceeded approximately 5 the trajectory became almost attached to the upstream surface and a recirculation region with a clockwise eddy emerged in the upstream corner region this eddy had a spanwise dimension of approximately 0 5 l high resolution less were performed for l h ratios of 3 and 7 5 s 0 024 and 0 075 respectively and the results were compared with the previous les result for an l h of 1 4 s 0 01 kang et al 2021b the comparisons revealed that the flow near the spur dikes comprised the fsv hsv and slv regardless the l h ratio in addition the location and size of the fsv and hsv changed significantly with the l h ratio whereas the those of the slv were nearly unaffected by the l h ratio that is the three dimensional flow features the fsv and hsv around the spur dike were suppressed with an increasing s value whereas the two dimensional flow pattern the slvs was not this finding leads to the conclusion that the three dimensionality of the flow around a bank attached structure decreases with an increasing s value in addition the instantaneous vorticity fields and streamline plots revealed that the hsv system around the spur dike consisted of one primary and multiple secondary vortices the primary vortex was found to oscillated back and forth and changed in size over time in the flow visualization result and les computed mean flow field for an l h ratio of 7 5 s 0 075 nearly two dimensional flow structures were observed both upstream and downstream of the spur dike namely one eddy formed in the upstream corner region and two counter rotating eddies in the wake region when viewed from above similar flow patterns have also been observed in other studies for l h ratios of 6 25 higham et al 2017 and 27 paik and sotiropoulos 2005 chrisohoides and sotiropoulos 2003 the spanwise dimension of the upstream eddy observed in the present study for an l h of 7 5 fig 8 c was 0 5 l and this was almost equal to those observed by chrisohoides and sotiropoulos 2003 and paik and sotiropoulos 2005 0 51 l this suggested that above a certain s value the two dimensional flow structure did not change with changes in the s value the les results indicated that both the three and two dimensional flow structures existed simultaneously when the s value was below a critical value however when the s value exceeded a critical value the flow became fully two dimensional and the flow pattern seldom changed with an increasing s value fig 10 illustrates the characteristics of flow patterns around spur dikes for s values below and above the critical value the les and flow visualization results presented in this study provide compelling evidence that under smooth bed conditions a critical wake parameter of approximately 0 04 results in a fully two dimensional flow it remains unclear whether this value changes under rough bed conditions or at different reynolds numbers necessitating further investigation the mean and root mean square bed shearf stress distributions near the spur dike revealed that the maximum τ occurred near the upstream tip of the spur dike irrespective of the s value additionally an elevation in bed shear stress was observed below the trajectory of the hsv this indicates that the hsv is the key mechanism for creating a local scour around the spur dike furthermore the region of the increased bed shear stress expanded toward the sidewall with a decreasing s value thereby increasing the bed shear stress in the corner between the upstream surface of the spur dike and the sidewall further examination is required for the mobile bed conditions as the elevated bed shear stress in this region can lead to significant bank erosion and potentially result in the failure of in stream structures another notable finding was the rapid increase in the τ r m s τ ratio near the boundary of the hsv region which exceeded 1 when the l h ratio was 1 4 s 0 01 this implies that the fluctuating bed shear stress can surpass the mean bed shear stress near the hsv system when the s value is very low consequently conventional sediment transport models which disregard or assume constant values for the τ r m s τ ratio may substantially underestimate bed shear stress and bed load transport rate in these regions the present study revealed a clear dependence of the flow field around the spur dike on the value of s and the mechanism of the changes in the two and three dimensional flow patterns with a varying s value nevertheless this study was performed for low f r and r e flows in a smooth bed channel and care should be taken when extrapolating the results to other conditions for instance the critical value of s can change for rough bed channels high r e flows or high f r supercritical flows with large free surface deformation these issues should be addressed in the future studies the effect of the value of s on the local scour patterns in a mobile bed channel should also be investigated credit authorship contribution statement seokkoo kang writing formal analysis conceptualization supervision jiyong lee investigation youngkyu kim investigation ali khosronejad formal analysis declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work was supported by a grant 21ctap c163624 01 from the infrastructure and transportation technology promotion research program funded by the ministry of land infrastructure and transport republic of korea and the national research foundation of korea nrf grants funded by the korea government msit no nrf 2022r1a2c2006915 and nrf 2022r1a4a3032838 appendix calculation of the bottom friction factor for cases 1 8 less were carried out to estimate the bottom friction factors c f for cases 1 8 the computations were performed under the same flow conditions as listed in table 2 table a 4 presents the details of the computational parameters used in the less a periodic boundary condition was applied in the streamwise direction and the no slip boundary condition was applied at the side and bottom walls additionally the rigid lid approximation with zero shear stress condition was imposed at the top plane after running the less long enough to attain a steady state kinetic energy in the computational domain the instantaneous flow field was averaged over 1 0 5 time steps owing to the fine wall normal grid spacing which was sufficient to resolve the viscous sublayer the wall shear stress could be directly evaluated by examining the wall normal gradient of the streamwise velocity at the walls the mean bottom c f and sidewall c f s friction factors obtained from the time averaged velocity fields are listed in table a 5 the les computed instantaneous and mean streamwise velocity fields are depicted in fig a 11 
33,a spur dike is an in stream structure one end of which is situated on the bank of a channel while the other extends into the current its primary functions include protecting stream banks and enhancing aquatic habitats the motivation of this study stems from the hypothesis that a wake parameter defined as the product of the length to depth ratio of spur dikes and the bottom friction factor serves as the key parameter in characterizing the flow pattern around these structures the objectives of this study are two fold 1 to determine the critical value of a wake parameter for the transition from three to two dimensional flow fields around spur dikes and 2 to examine the bed shear stress distributions around spur dikes with varying length to depth ratios flow visualization experiments and large eddy simulations less were conducted with length to depth ratios ranging from 1 to 7 5 corresponding to wake parameter values between 0 005 and 0 075 the experimental and numerical results revealed various flow structures around and in the wake of the spur dike when the length to depth ratio was close to 1 the two and three dimensional flow patterns coexisted around the spur dike however as the length to depth ratio increased the three dimensional flow structures diminished and the two dimensional flow structures became more pronounced for an length to depth ratio of 7 5 the flow pattern showed fully two dimensional structures featured by an upstream and a pair of downstream recirculation regions with negligible secondary flows a horseshoe vortex and a free surface vortex a horseshoe vortex system contributed to a significant increase in both mean and root mean square bed shear stresses near the tip of spur dikes especially when the wake parameter values were low the upstream recirculation zone was associated with very low bed shear stress at high values of the wake parameter the results of this study corroborated that the flow around the spur dikes becomes fully two dimensional when a wake parameter exceeds a critical value of approximately 0 04 keywords river restoration river flow flow modeling environmental fluid mechanics data availability data will be made available on request 1 introduction the rectangular in stream structures attached to channel banks known as spur dikes or groynes have been widely employed for the protection of river bank erosion spur dikes are also used for increasing the water depth for navigation purposes and for creating a pool to enhance aquatic habitats although several studies have been conducted on the flow mechanism and sediment transport processes around these structures our current understanding remains incomplete this is largely owing to the challenging measurement and prediction of three dimensional and turbulent flow patterns around these structures even at moderate reynolds numbers the existing research on the three dimensional turbulent flow fields around these structures is insufficient and a reliable design method that accounts for the complex flow physics around the spur dikes has yet to be developed to better understand the flow patterns around spur dikes it is essential to identify the relevant dimensionless parameters dimensional analysis will reveal that the dimensionless parameters that characterize the flow around emergent obstacles in an open channel are the reynolds number r e u h ν froude number f r u g h relative roughness height ϵ h length to flow depth l h ratio and channel length to width l w or blockage ratio where h is the depth u is the velocity g is the gravitational acceleration ν is the kinematic viscosity l is the obstacle length w is the channel width and ϵ is the roughness height the effect of f r may be ignored for flows with a low f r assuming that the free surface deformation is not significant in addition if the blockage effect is assumed to be negligible the l w ratio can be ignored then the remaining parameters are l h r e and ϵ h chen and jirka 1995 introduced a shallow wake parameter s to determine the flow characteristics around emergent or non submerged structures in open channels this parameter was defined as s c f l h where c f 2 u u 0 2 is the bottom friction factor that is a function of r e and ϵ h u 0 represents the characteristic velocity and u denotes the shear velocity chen and jirka 1995 and jirka 2001 performed laboratory experiments to explore the wake characteristics around various emergent bluff bodies in an open channel for instance for a bottom mounted circular cylinder they demonstrated that different wake structures exist depending on the value of s the vortex street type with an oscillating vortex shedding mechanism s 0 2 the unsteady bubble wake type with a downstream recirculation bubble having flow instabilities growing downstream 0 2 s 0 5 and the steady bubble wake type without the flow instabilities s 0 5 the shallow wake parameter was originally proposed for bluff bodies located away from a sidewall however it may also be used to characterize the flow patterns around a spur dike because both flows have the same dimensionless parameter groups therefore s is also hypothesized to be a key parameter that governs the flow patterns around a spur dike for a smooth bed channel where ϵ h 0 s is dependent on c f and l h values as stated by jirka 2001 c f is approximately 0 005 and 0 01 under field and laboratory conditions respectively this indicates that the value of c f varies within a relatively narrow range of approximately 0 005 to 0 01 considering this limited variability l h emerges as a more dominant factor than c f in determining the wake parameter s thus far few studies have investigated three dimensional flow patterns around spur dikes in relation to the l h ratio jeon et al 2018 and kang et al 2021b investigated the flow around the spur dikes with an l h ratio of 1 4 by conducting flume experiments and numerical simulations respectively jeon et al 2018 performed velocity measurements around a spur dike with an l h ratio of 1 4 using acoustic doppler velocimetry adv and observed three dimensional flow structures including a free surface vortex fsv a horseshoe vortex hsv and complex secondary flows kang et al 2021b conducted numerical simulations for the same spur dike revealing that the flow around the spur dike exhibits both two and three dimensional flow characteristics simultaneously in their study three distinct flow features were observed in the vicinity of the spur dike two dimensional vortex shedding originating from the tip of the structure as well as an fsv and an hsv upstream of the structure both with axes perpendicular to the channel sidewall additionally their study unveiled a two dimensional recirculating flow extending across the entire wake and a three dimensional recirculating flow situated in the corner region between the downstream surface of the spur dike and bed duan 2009 duan et al 2009 measured the flow around spur dikes with l h ratios of 0 9 and 1 25 respectively in the laboratory the measurements showed the existence of flow separation zones and secondary flows downstream of the spur dikes koken and constantinescu 2008 2009 2011 conducted numerical simulations for spur dikes with an l h ratio of 1 5 they investigated an hsv system around the spur dikes and demonstrated that the flow past a spur dike can exhibit highly three dimensional flow structures much higher l h ratios have been considered in a few other studies for instance higham et al 2017 measured the velocity fields around a rectangular groyne with an l h ratio of 6 25 using particle image velocimetry piv in a laboratory flume the measurements showed significantly different flow patterns compared with those for an l h ratio less than 2 they observed a two dimensional wake structure consisting of a pair of counter rotating recirculation regions downstream of the groyne and a small two dimensional recirculation region in the upstream corner between the groyne and sidewall of the channel paik and sotiropoulos 2005 investigated the flow around a rectangular block with an l h ratio of 27 using numerical simulations they observed flow patterns that were very similar to those reported by higham et al 2017 and comprised a pair of two dimensional counter rotating eddies downstream of the block and another two dimensional recirculation region upstream of the block other researchers investigated the flow field around bridge abutments which exhibit similar geometries to spur dikes kwan and melville 1994 employed the hydrogen bubble technique to measure the flow field around a bridge abutment model with l h ratios ranging from 2 4 to 9 5 on a mobile bed they observed that a primary vortex resulting from the upstream downflow was the main cause of scour at the abutments ahmed and rajaratnam 2000 measured the velocity profiles around an abutment model with an l h ratio of 0 55 on a fixed bed they found that the approach flow was deflected and skewed near the abutment and the bed shear stress increased approximately 3 6 times in the vicinity of the abutment nose dey and barbhuiya 2010 used adv to measure the velocity field near an abutment model with an l h ratio of 0 6 on a mobile bed most of the aforementioned studies on bridge abutments primarily focused on measuring scour or velocity profiles near abutments without significant consideration of three dimensional flow patterns a review of the aforementioned studies reveals that spur dikes can exhibit different flow patterns depending on l h ratio thereby indicating a possible dependence of the flow patterns on the the value of s nevertheless care must be taken before drawing any firm conclusion about this dependence because the flow patterns for different s values under similar flow conditions have not yet been compared three dimensional flow field data both near and in the wake of spur dikes need to be obtained for various s values for an effective comparison obtaining these data especially for the entire wake region with an length of 10 l 12 l in the downstream direction koken 2011 jeon et al 2018 kang et al 2021b using flow measurements will be time consuming an alternative method is to perform numerical simulations numerical models that solve the full three dimensional navier stokes equations combined with turbulence closure models are widely recognized for simulating complex open channel flows in particular three dimensional flow models based on advanced turbulence closure models such as large eddy simulation les or detached eddy simulation des have been successful in the prediction of complex flows involving unsteady vortex shedding flow separation vortex formation etc previous les or des studies in which the flow past spur dikes was investigated are summarized in table 1 in the majority of these studies wake patterns were not given much attention this is likely because of the considerations related to computational costs as shown in the table most of the previous studies employed fewer than 10 million grid points which may be insufficient for resolving the entire wake region however kang et al 2021b recently conducted an les study to examine the flow structures in the entire wake regions of a spur dike this les resolved the wake of a spur dike with an l h ratio of 1 4 using approximately 160 million grid nodes and grid spacing ranging from 0 8 to 70 wall units the computed velocity and turbulence fields both in the vicinity and far wake were in strong agreement with the adv measurements and flow visualization results reported by jeon et al 2018 this study has two primary objectives 1 to identify the critical value of s for the transition from three to two dimensional flow fields around spur dikes and 2 to examine the bed shear stress distributions around spur dikes at varying l h ratios to these ends we perform flow visualization experiments for spur dikes with l h ratios ranging from 1 to 7 5 as well as less for two selected cases l h ratios of 3 and 7 5 with grid resolutions comparable to those used in our previous les for an l h ratio of 1 4 kang et al 2021b by analyzing these results we examine the three dimensional flow structure turbulence characteristics and bed shear stress distributions around and in the wake of the spur dikes to the best of our knowledge this study is the first systematic exploration of the flow patterns and bed shear stress distributions around spur dikes at different l h ratios 2 flow visualization experiment 2 1 experimental set up flow visualization experiments were conducted in an open channel flume at hanyang university seoul south korea the flume was 18 m long 0 9 m wide and 0 4 m deep with a flat bed the sidewalls and bed were made of glass and polyvinyl chloride pvc respectively similar to the experiment conducted by jeon et al 2018 a rectangular spur dike model was attached to the bed and one of the sidewalls the lengths of the spur dike in the spanwise streamwise and vertical directions were 0 3 m 0 04 m and 0 4 m respectively the experiments were performed by sprinkling small styrofoam particles upstream of the obstacle and subsequently photographing their trajectories on the free surface using a digital camera with variable exposure times approximately between 10 15 s similar experimental techniques were successfully used by chrisohoides et al 2003 kang and sotiropoulos 2012 kang et al 2021b to identify the flow patterns around obstacles in open channels eight experiments were performed and the experimental conditions are presented in table 2 all experiments were run at a bulk velocity u 0 of approximately 0 2 m s in case 8 however a slightly lower u 0 was used to keep the froude number f r below 0 3 for cases 1 to 8 the l h ratio was gradually increased from approximately 1 to 7 5 by decreasing the h the reynolds number based on h r e h varied between 0 7 1 0 4 and 5 7 1 0 4 whereas the reynolds number based on l r e l varied between 5 0 1 0 4 and 6 0 1 0 4 in the experiments the value of r e h was not maintained constant instead it decreased incrementally from case 1 to case 8 this variation was because of the practical impossibility of maintaining a low f r number while keeping the r e h value constant particularly in cases with a small h value notably when the f r number exceeded 0 4 significant deformation of the free surface occurred in the vicinity of the spur dike chen and jirka 1995 also observed this difficulty while conducting flume experiments on wakes generated by circular cylinders they were unable to perform experiments for cases with both high r e h and s values where h was small and f r was high owing to the wave like free surface instabilities around the cylinders nevertheless they concluded from their measurement results that the classification of wake characteristics behind cylinders is uniquely dependent on the value of s provided that the ambient flow is fully turbulent i e r e h 1500 in the present study the minimum r e h value was approximately 6800 resulting in a fully turbulent wake this suggests that the wake behind the spur dike in the current study is also governed by the s value it should be noted that the value of c f must be known beforehand to obtain the value of s chen and jirka 1995 estimated the values of c f using the smooth wall relation from the moody friction diagram an approach ingram and chu 1987 also employed in experiments on wakes behind flat plates in the present study rather than using the moody diagram which was originally developed for pipe flows wall resolving les computations were performed for cases 1 8 to estimate the c f values the les computations were performed using 8 to 47 million grid points maintaining the same reynolds number as presented in table 2 further details on these les computations can be found in appendix the s values derived from the les computed c f values are listed in table 2 2 2 results the flow visualization results for cases 1 to 8 are presented in fig 1 arched flow trajectories marked with dashed lines can be seen around the spur dike jeon et al 2018 observed similar flow trajectories for a spur dike with an l h ratio of 1 4 and an s value of 0 01 c f 0 007 installed in the same channel they found that the trajectory was created by the collision of the incoming flow with a reversed flow region directly upstream of the spur dike see the arrows in case 1 subsequently kang et al 2021b performed numerical simulations to demonstrate that the reversed flow region was associated with an fsv i e a vortex system that was developed underneath the free surface upstream of the spur dike fig 1 reveals that the trajectories for cases 1 and 2 where 1 l h 1 5 and 0 005 s 0 01 are always located away from the upstream surface of the spur dike and they move significantly with time this movement was presumably associated with the low frequency streamwise oscillatory motion of the fsv that was discovered by kang et al 2021b for a spur dike with an l h ratio of 1 4 they using numerical simulation demonstrated that the fsv produced a spectral peak at the strouhal frequency of 0 02 in the velocity spectra thereby indicating the existence of low frequency oscillatory motion cases 7 and 8 where 0 047 s 0 075 displayed significantly different flow trajectory patterns to cases 1 and 2 where 0 005 s 0 01 first the arched trajectory was almost attached to the upstream tip of the obstacle indicating that the size of the fsv had decreased significantly second the position of the arched trajectory remained almost constant over time this was possibly associated with the weakened fsv in cases 7 and 8 third a two dimensional clockwise eddy was observed in the upstream corner region between the spur dike and the sidewall based on the above comparisons it can be inferred that at low s values three dimensional flow structures e g the fsv become more pronounced whereas at high s values two dimensional flow patterns e g clockwise eddy become more pronounced this result clearly indicates the decrease in the flow three dimensionality with respect to the s value further the comparison of the results for cases 1 8 indicates that the critical value of s that will lead to the formation of a two dimensional clockwise eddy at the free surface may be approximately 0 04 3 large eddy simulation 3 1 numerical methods the spatially filtered continuity and navier stokes equations for incompressible viscous fluids are written in cartesian coordinates as follows 1 u j x j 0 2 u i t u j u i x j 1 ρ p x i 1 ρ τ i j t x j where t is time u i is the filtered velocity vector p is the filtered pressure ρ is the density and μ is the dynamic viscosity τ i j t is the total stress tensor that is the sum of the viscous and sub grid scale sgs stresses 3 τ i j t μ u i x j τ i j s g s where τ i j s g s is the sub grid scale sgs stress tensor the les was performed using the numerical model developed by kang et al 2011 in which the above spatially filtered continuity and navier stokes equations eqs 1 and 2 were formulated in generalized curvilinear coordinates and the sgs terms were modeled using the dynamic smagorinsky model germano et al 1991 the les model employed the curvilinear immersed boundary curvib method ge and sotiropoulos 2007 implemented for turbulent flow simulations in open channels kang et al 2011 the curvib method allowed the handling of arbitrarily complex geometries such as those associated with irregular bathymetry and complex in stream structures without costly re meshing processes the method employs two different grid systems boundary fitted three dimensional curvilinear grids for a background flow domain and immersed boundary grids comprising triangular surface meshes for solid objects the present les model combined with the curvib method was successfully applied to solve various open channel flow problems kang et al 2016 khosronejad et al 2019 kang et al 2020 2021a 3 2 computational set up in kang et al 2021b the les was performed for a spur dike with an l h ratio of 1 4 here two additional less were conducted for l h ratios of 3 case 5 and 7 5 case 8 the computational parameters are presented in table 3 the less for cases 5 and 8 are hereafter referred to as les 1 and les 2 respectively fig 2 shows the coordinate system and computational domain as well as the spur dike that was treated using the curvib method the x y and z denote the streamwise spanwise and vertical directions respectively as illustrated in the figure the vertical dimensions of the computational domain for the les 1 and les 2 are different owing to the different l h ratios les 1 and les 2 were conducted on a computational domain with approximately 152 and 70 million grid nodes respectively in both cases the minimum and maximum grid spacings were 1 and 120 wall units respectively in the previous less kang et al 2021b used two different grids of approximately 57 million and 162 million grid nodes with the grid spacings of 3 to 226 and 1 to 70 wall units respectively they demonstrated that both grids produced nearly identical results that were in excellent agreement with the adv measurements thereby indicating that the coarser grid with 57 million points was sufficient to produce accurate and grid converged results the spatial resolution in the present les 1 120 wall units was much finer than that of the coarser grid 3 226 wall units of kang et al 2021b therefore the grid resolution in the les 1 and les 2 can be assumed to be sufficient to obtain a grid converged solution this was the reason for omitting grid convergence tests in the present study as table 1 shows the current less used more than 10 times the number of grid nodes than those reported by most other researchers similar to the previous les with an l h ratio of 1 4 kang et al 2021b the free surface was treated using the rigid lid approximation leschziner and rodi 1979 where the free surface was assumed to be a flat plane with zero shear stress this method was successfully applied to simulate free surface flows with low to moderate f r numbers calmet and magnaudet 2003 mccoy et al 2008 kang et al 2011 koken 2011 le et al 2019 a fully developed instantaneous turbulent velocity field obtained from a separate precursor simulation in a domain with streamwise periodicity was fed at the inlet x l 5 of the computational domain a zero gradient condition was imposed for the instantaneous velocities at the outlet x l 23 33 a no slip velocity condition was imposed at the bed z 0 and the sidewalls y l 0 and 3 because the near wall grid spacing 1 wall unit was sufficiently small to resolve the viscous sublayer velocity and shear stress boundary conditions were imposed at the immersed boundary nodes using the near wall model proposed by kang 2015 the less were first performed until the total instantaneous kinetic energy in the computational domain reached a steady state that required approximately 8 0 1 0 5 time steps subsequently the instantaneous flow field was averaged over time at each grid point for 2 4 1 0 5 time steps corresponding to 240 s in physical time the computations were performed on 400 cores of a linux cluster supercomputer comprising intel xeon e5 2650 v3 2 3 ghz cpus that were interconnected using fourteen data rate 56 gb s infiniband mellanox adapters and a switch the computation times for les 1 and les 2 were approximately 120 and 60 days respectively 3 3 results in this section the results of the les 1 and les 2 are presented and compared with those of the les for an l h ratio of 1 4 performed by kang et al 2021b a comparison of the flow parameters for the three less is shown in table 1 in the remainder of this study u v and w denote the instantaneous velocity components in the x y and z directions see fig 2 for the coordinates respectively τ indicates the bed shear stress magnitude q means the time averaged value of a time dependent variable q and q q q means the temporal fluctuation the turbulence kinetic energy tke is defined as k 0 5 u u v v w w fig 3 shows the instantaneous vortical structures around the spur dike visualized using the λ 2 criterion method jeong and hussain 1995 there are three distinct vortical structures the fsv hsv and shear layer vortex slv the slvs are apparently generated by the two dimensional vortex shedding from the upstream edge of the spur dike as the l h ratio increases the arrangement of the vortical structures remains similar but the fsv and hsv decrease in size and move closer to the spur dike a similar trend was observed in the flow visualization experiment in section 2 2 where the arched flow trajectory was observed to move close to the spur dike with an increasing l h ratio in fig 4 the vortical structures are viewed from above the obstacle for three different depth regions z h 0 4 near bed region 0 4 z h 0 8 mid depth region and z h 0 8 free surface region a comparison between the vortical structures in the free surface region and the flow visualization result is shown on the right side of the figure for an l h ratio of 1 4 both the hsv and fsv are clearly observed in the near bed and free surface regions both forming arched trajectories slvs are observed in all three regions and are attached to the tip of the spur dike at an l h ratio of 3 the hsv and fsv move closer to the spur dike but the location of the slvs remains unchanged compared to the case where the l h ratio is 1 4 at an l h ratio of 7 5 the hsv and fsv almost merge with the slvs these results demonstrate that the slv which is a two dimensional flow feature is observed for all depth regions regardless of the l h ratio however the hsv and fsv that are three dimensional flow features diminish in size with an increasing l h ratio the computed vortical structures in the free surface region and the flow visualization results are in excellent agreement thereby demonstrating the accuracy of the les results figs 3 and 4 showed markedly different instantaneous coherent structures for the three l h ratios this difference likely results from the competition between the two and three dimensional flow structures which can be influenced by the l h ratio and the wake parameter s it is plausible to assume that the parameters l and h are related to the maximum size of two dimensional in the x y plane and three dimensional coherent structures respectively therefore the l h ratio can be interpreted as a relative size or strength of two dimensional coherent structures compared to that of three dimensional structures it should be noted that the l h ratios for the three less were altered by varying the depth h while maintaining the length l constant this implies that the size of two dimensional coherent structures will remain similar across all three less whereas the size of the three dimensional structures will decrease as the l h ratio increases this accounts for the reduced thickness of the hsv and fsv observed at an l h ratio of 7 5 compared to the other two cases consequently it can be anticipated that at a sufficiently large l h ratio the hsv and fsv structures will become negligible in size and the flow field around a spur dike will become virtually two dimensional fig 5 displays the computed instantaneous y component vorticity ω y contours and streamlines at the y l 1 plane in the les for an l h ratio of 1 4 kang et al 2021b large positive and negative vorticity pockets near the bed and the free surface represent the hsv and fsv structures respectively the chaotic small scale vortical structures around them indicate the turbulent flow structures of the incoming flow the hsv system can be observed to not only oscillate back and forth but also expand and contract over time the instantaneous streamline plots reveal that the hsv system consists of one primary and several secondary vortices which seem to collide and merge with each other the primary hsv is observed to oscillate back and forth across a distance of approximately 0 1 l and these oscillations are likely to intensify the turbulent fluctuations of bed shear stress the time averaged flow fields are examined in the remainder of this section the mean flow and turbulence fields on x y and x z planes are presented in figs 6 and 7 respectively and the mean bed shear stress field is displayed in fig 8 fig 6 shows the mean dimensionless streamwise velocity u u 0 contours and two dimensional streamlines at z h free surface plane 0 5 h mid depth plane and 0 01 h near bed plane figs 6 a c and d show the results for l h ratios of 1 4 3 and 7 5 respectively the adv measured flow fields jeon et al 2018 and the measurement points in the mid depth and near bed planes are displayed in fig 6 b the computed and adv measured velocity fields and streamline patterns are observed to be in excellent agreement demonstrating the accuracy and reliability of the les results in fig 6 a the fsv and hsv are observed to exhibit converging streamlines forming arched trajectories and the slvs create diverging streamlines emanating from the tip these streamline patterns indicate that the fsv and hsv create helical flow structures between the converging and diverging streamlines near the bed and the free surface in the mid depth plane however only the converging streamlines a characteristic of the slv are observed the different streamline and velocity patterns in the three x y planes suggest that the velocity gradient in the vertical direction may be significant in the wake region thereby indicating the existence of three dimensional and secondary flow structures figs 6 c and 6 d show that the influence of the fsv and hsv weakens with an increasing l h ratio at an l h ratio of 7 5 the fsv and hsv almost merge with the slv upstream of the spur dike thus almost identical streamline structures are observed across the three different planes namely one small 0 5 l in the y direction recirculation zone directly upstream of the spur dike and two counter rotating recirculation zones in the wake region the upstream recirculation region or the clockwise eddy was also observed in case 8 fig 1 with a similar spanwise length of approximately 0 5 l flow patterns similar to the above were also documented by higham et al 2017 and paik and sotiropoulos 2005 for rectangular obstacles with l h ratios of 6 25 and 27 respectively in other words similar two dimensional wake structures were observed for l h ratios slightly smaller and much larger than 7 5 this strongly suggests that a two dimensional flow pattern that is independent of s values develops when the s value exceeds a certain critical value the flow visualization in fig 1 showed that the two dimensional recirculation region was clearly observed in the upstream corner in cases 7 and 8 where the s value was greater than 0 04 these results indicate that the critical value of s may be approximately 0 04 as depicted in fig 7 the tke contours and two dimensional streamline patterns are investigated for the planes at y l 0 25 0 5 0 75 and 1 the flow field in the x z planes can show the flow structures associated with the fsv and hsv upstream of the spur dike in detail the fsv and hsv are clearly observed upstream of the spur dike and there is another vortex downstream the downstream vortex was identified experimentally by jeon et al 2018 and numerically by kang et al 2021b for an l h ratio of 1 4 and was found to result in three dimensional flow structures in the near wake region the tke distribution in the figure shows that the downstream vortex is associated with very low tke levels in fig 7 a the fsv and hsv are observed to exhibit significant levels of tke at an l h ratio of 1 4 the peak levels of the tke for the fsv and hsv tend to increase with a decreasing l h ratio and with increasing distance from the sidewall the peak tke levels for the fsv and hsv are associated with the intensity of their low frequency oscillatory motion in the streamwise direction kang et al 2021b these results show that the fsv and hsv oscillate more energetically with an decreasing l h ratio and increasing distance from the sidewall although the hsv is much larger in size than the fsv for l h ratios of 1 4 and 3 they both become similar and negligible in size at an l h ratio of 7 5 previous studies on bottom mounted cylindrical obstacles devenport and simpson 1990 apsilidis et al 2015 schanderl et al 2017 paik et al 2007 escauriaza and sotiropoulos 2011 and rectangular spur dikes koken and constantinescu 2008 2009 suggest that the hsvs around bluff bodies can exhibit low frequency oscillations resulting in bimodal probability density functions for velocity fluctuations these bimodal oscillations are known to cause an order of magnitude increase in turbulent stresses devenport and simpson 1990 and therefore have significant implications for sediment transport a typical signature of an hsv system s bimodal oscillations is a c shaped distribution of tke contours apsilidis et al 2015 schanderl et al 2017 paik et al 2007 escauriaza and sotiropoulos 2011 in fig 7 a l h 1 4 the c shape distribution is clearly visible at the planes y l 0 5 0 75 and 1 this indicates that the streamwise oscillations of the hsv system observed in fig 5 are presumably associated with the bimodal oscillations the c shape distribution remains visible at an l h ratio of 3 but nearly vanishes at an l h ratio of 7 5 these findings indicate that the oscillations of the hsv intensify with decreasing values of s and increasing distance from the sidewall another important flow parameter worth investigating is the local bed shear stress that is directly relevant to the sediment erosion or deposition around the in stream structures in mobile bed conditions the local bed shear stress distribution in a fix bed condition can provide useful insights regarding the local scour processes around the in stream structures especially during the initial stages of the scour however obtaining direct measurements of the bed shear stress even at a single point in turbulent boundary layers is a very difficult task and it is nearly impossible to obtain such measurements at hundreds of thousands points alternatively the bed shear stress can be estimated using indirect methods based on a logarithmic velocity law or reynolds shear stress distribution biron et al 2004 but a reliable indirect method applicable to complex flows involving flow separation and vortex shedding has yet to be proposed predicting the bed shear stress using numerical simulation is also challenging despite the presence of advanced turbulence models such as les it is because the grid resolution near the wall should be sufficiently small to resolve the viscous sublayer to accurately compute the velocity gradients at the wall owing to the sufficiently small near wall grid spacing 1 wall unit used in the less presented in this study the bed shear stress τ can be calculated with a good accuracy without introducing any empirical wall modeling in fig 8 the dimensionless mean and root mean square bed shear stress distributions are plotted alongside the mean streamlines the two dashed lines indicate the converging and diverging streamlines that outline the extent of the hsv system on the bed it can be seen that the hsv significantly increases both mean and root mean square bed shear stresses the maximum bed shear stress occurs near the tip of the spur dike whereas a very low mean bed shear stress is observed in the two dimensional corner eddy region see the arrows in most areas away from the spur dike τ is observed to be greater than τ r m s however near the hsv region and the tip of the spur dike τ r m s becomes comparable to or even surpasses τ particularly at an l h ratio of 1 4 this implies that fluctuating bed shear stress in the hsv region and near the tip can be significant which will be further discussed in fig 9 the observed bed shear stress distributions above suggest that the scour hole around the spur dike may grow differently over time depending on s values when s values are approximately 0 01 a scour hole is likely to begin forming near the tip of the spur dike and gradually expand toward the sidewall over time in this instance owing to the absence of a two dimensional recirculation region in the upstream corner there may be considerable bank erosion potential near the sidewall when s values exceed a critical threshold a scour hole might only form in the vicinity of the tip without extending toward the sidewall as the two dimensional corner eddy reduces the bed shear stress fig 9 displays the streamwise profiles of τ τ r m s and τ r m s τ at y l 0 75 τ r m s τ represents the relative fluctuation of the bed shear stress cheng et al 2004 indicating the turbulence effects on bed shear stress as seen the τ profiles exhibit a single peak within the hsv region however the τ r m s profiles display two peaks near the upstream and downstream boundaries of the hsv region the occurrence of these two peaks near the hsv boundary is likely associated with the back and forth oscillations of the hsv system observed in fig 5 the profiles of τ r m s τ also exhibit two peaks and the peak values increase with a decreasing l h ratio at an l h ratio of 1 4 the peak values of τ r m s τ even exceed 1 it should be noted that most of the existing sediment transport models neglect these effects τ r m s 0 on bed load transport and some stochastic models account for these effects by assuming a constant τ r m s τ ratio for instance paintal 1971 and gessler 1970 assumed τ r m s τ values of 0 5 and 0 57 respectively the large and rapidly varying τ r m s τ ratio observed near the hsv system suggests that sediment transport models assuming either zero or constant τ r m s τ ratio may significantly underestimate the bed load transport rate in these regions especially when the l h ratio is small 4 summary and conclusion in this study the flow patterns around a spur dike in an open channel flume were investigated using flow visualization and numerical simulations the flow visualization experiments for l h ratios between 1 and 7 5 0 005 s 0 075 revealed the formation of an arched flow trajectory around the spur dike oscillating back and forth in time at a low l h ratio this trajectory was owing to the fsv the size of the fsv structure at the free surface was estimated based on the distance between this trajectory and the upstream surface of the spur dike as the l h ratio decreased the flow trajectory moved away from the spur dike while the oscillation increased thereby indicating a large size and strong effect of the fsv as the l h ratio increased the trajectory moved toward the spur dike when the l h ratio exceeded approximately 5 the trajectory became almost attached to the upstream surface and a recirculation region with a clockwise eddy emerged in the upstream corner region this eddy had a spanwise dimension of approximately 0 5 l high resolution less were performed for l h ratios of 3 and 7 5 s 0 024 and 0 075 respectively and the results were compared with the previous les result for an l h of 1 4 s 0 01 kang et al 2021b the comparisons revealed that the flow near the spur dikes comprised the fsv hsv and slv regardless the l h ratio in addition the location and size of the fsv and hsv changed significantly with the l h ratio whereas the those of the slv were nearly unaffected by the l h ratio that is the three dimensional flow features the fsv and hsv around the spur dike were suppressed with an increasing s value whereas the two dimensional flow pattern the slvs was not this finding leads to the conclusion that the three dimensionality of the flow around a bank attached structure decreases with an increasing s value in addition the instantaneous vorticity fields and streamline plots revealed that the hsv system around the spur dike consisted of one primary and multiple secondary vortices the primary vortex was found to oscillated back and forth and changed in size over time in the flow visualization result and les computed mean flow field for an l h ratio of 7 5 s 0 075 nearly two dimensional flow structures were observed both upstream and downstream of the spur dike namely one eddy formed in the upstream corner region and two counter rotating eddies in the wake region when viewed from above similar flow patterns have also been observed in other studies for l h ratios of 6 25 higham et al 2017 and 27 paik and sotiropoulos 2005 chrisohoides and sotiropoulos 2003 the spanwise dimension of the upstream eddy observed in the present study for an l h of 7 5 fig 8 c was 0 5 l and this was almost equal to those observed by chrisohoides and sotiropoulos 2003 and paik and sotiropoulos 2005 0 51 l this suggested that above a certain s value the two dimensional flow structure did not change with changes in the s value the les results indicated that both the three and two dimensional flow structures existed simultaneously when the s value was below a critical value however when the s value exceeded a critical value the flow became fully two dimensional and the flow pattern seldom changed with an increasing s value fig 10 illustrates the characteristics of flow patterns around spur dikes for s values below and above the critical value the les and flow visualization results presented in this study provide compelling evidence that under smooth bed conditions a critical wake parameter of approximately 0 04 results in a fully two dimensional flow it remains unclear whether this value changes under rough bed conditions or at different reynolds numbers necessitating further investigation the mean and root mean square bed shearf stress distributions near the spur dike revealed that the maximum τ occurred near the upstream tip of the spur dike irrespective of the s value additionally an elevation in bed shear stress was observed below the trajectory of the hsv this indicates that the hsv is the key mechanism for creating a local scour around the spur dike furthermore the region of the increased bed shear stress expanded toward the sidewall with a decreasing s value thereby increasing the bed shear stress in the corner between the upstream surface of the spur dike and the sidewall further examination is required for the mobile bed conditions as the elevated bed shear stress in this region can lead to significant bank erosion and potentially result in the failure of in stream structures another notable finding was the rapid increase in the τ r m s τ ratio near the boundary of the hsv region which exceeded 1 when the l h ratio was 1 4 s 0 01 this implies that the fluctuating bed shear stress can surpass the mean bed shear stress near the hsv system when the s value is very low consequently conventional sediment transport models which disregard or assume constant values for the τ r m s τ ratio may substantially underestimate bed shear stress and bed load transport rate in these regions the present study revealed a clear dependence of the flow field around the spur dike on the value of s and the mechanism of the changes in the two and three dimensional flow patterns with a varying s value nevertheless this study was performed for low f r and r e flows in a smooth bed channel and care should be taken when extrapolating the results to other conditions for instance the critical value of s can change for rough bed channels high r e flows or high f r supercritical flows with large free surface deformation these issues should be addressed in the future studies the effect of the value of s on the local scour patterns in a mobile bed channel should also be investigated credit authorship contribution statement seokkoo kang writing formal analysis conceptualization supervision jiyong lee investigation youngkyu kim investigation ali khosronejad formal analysis declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work was supported by a grant 21ctap c163624 01 from the infrastructure and transportation technology promotion research program funded by the ministry of land infrastructure and transport republic of korea and the national research foundation of korea nrf grants funded by the korea government msit no nrf 2022r1a2c2006915 and nrf 2022r1a4a3032838 appendix calculation of the bottom friction factor for cases 1 8 less were carried out to estimate the bottom friction factors c f for cases 1 8 the computations were performed under the same flow conditions as listed in table 2 table a 4 presents the details of the computational parameters used in the less a periodic boundary condition was applied in the streamwise direction and the no slip boundary condition was applied at the side and bottom walls additionally the rigid lid approximation with zero shear stress condition was imposed at the top plane after running the less long enough to attain a steady state kinetic energy in the computational domain the instantaneous flow field was averaged over 1 0 5 time steps owing to the fine wall normal grid spacing which was sufficient to resolve the viscous sublayer the wall shear stress could be directly evaluated by examining the wall normal gradient of the streamwise velocity at the walls the mean bottom c f and sidewall c f s friction factors obtained from the time averaged velocity fields are listed in table a 5 the les computed instantaneous and mean streamwise velocity fields are depicted in fig a 11 
34,imbibition plays a central role during multiphase flows in geological media yet our understanding of imbibition dynamics across the multiscale features of rocks including fractures microcracks and heterogeneous matrices is limited here we deployed a unique combination of micro and clinical x ray ct imaging to probe directly the spatiotemporal evolution of imbibition in a natural multiscale shale sample the method enabled unraveling of mixed imbibition behavior with spontaneous imbibition rates in the matrix pores and microcracks driven by capillarity proceeding as t 1 2 whereas pressure driven flows in the macroscopic fractures yield apparent imbibition rates with t 1 scaling regardless of the aperture we showed that spontaneous imbibition proceeds uniformly away from the fractures the effects of microcracks are further investigated by comparing the dynamics of the imbibition fronts with and without microcracks these results highlight the paramount role of microcracks on anomalous front roughening and the need to account for microcracks appropriately in the development of predictive theoretical models graphical abstract keywords spontaneous imbibition forced imbibition multiscale imaging nanoporous shale fractures microcracks data availability all static and dynamic ct datasets acquired in this work may be obtained from the stanford digital repository using the following link https doi org 10 25740 nj176bd5255 kurotori et al 2022 1 introduction fractures natural or engineered are prevalent in many domains especially subsurface geological systems such as aquifers geothermal reservoirs and shale formations fountain and walder 1998 mayer and sharp 1998 curtis 2002 jourdain et al 2014 mcclure and horne 2014 caulk et al 2016 berre et al 2019 fractures are physical discontinuities in geological media created by normal or shear stress exceeding the rock strength despite their discrete volumetric extent fractures may act as dominant flow conduits during co 2 sequestration h 2 storage nuclear waste disposal geothermal energy extraction and hydrocarbon recovery bachu 2008 tarkowski 2019 eia 2021 viswanathan et al 2022 the discontinuous nature of fractured geological media is challenging to characterize because it produces multi length scale domains with complex flow and transport behavior across spatial and temporal scales mehmani et al 2021 this is especially true for low permeability tight geological media such as shale that contain both pores on the order of 10 nanometers froute and kovscek 2020 and fractures as large as meters in scale houben et al 2017 while geothermal and shale formations supply primary energy in the united states gaps in understanding of fluid flow in fractured systems lead to sub optimal utilization of these essential resources for example approximately 2 million gallons of water is used for the generation of every mw of power from geothermal formations clark et al 2010 the us geological survey also reports that 1 5 to 16 million gallons of water is injected per well to stimulate low permeability shale formations chen and carter 2016 usgs 2019 large volumes of this injected water remain in the reservoir with low flowback efficiency lan et al 2014 ge et al 2015 epa 2021 resulting in efficiency as low as 5 of the total injected volume ghanbari and dehghanpour 2016 improved understanding of fluid rock interaction is key for reducing water usage and improving the efficiency of energy recovery imbibition controls the advancement of wetting fluid in many everyday materials such as biscuits clothes floors and rocks among numerous examples akin et al 2000 alava et al 2004 gruener et al 2012 imbibition is typically characterized as co current or countercurrent and spontaneous or forced co current imbibition is when the two fluids move in the same direction as opposed to moving past each other as in counter current imbibition spontaneous imbibition often dominates fluid flow in partially saturated unconventional formations due to the significant capillary suction pressure in nanoporous shale matrices takahashi and kovscek 2010 makhanov et al 2012 roychaudhuri et al 2013 forced imbibition is dominant in large fractures where flow is driven by fluid pressure gradients mechanisms that drive imbibition control how multiphase fluid displacement advances across temporal scales spontaneous imbibition in a one dimensional capillary dominated porous medium may be represented by a relationship between imbibition distance or rate and square root of time washburn 1921 mcwhorter and sunada 1990 akin et al 2000 yang et al 2021 while this analytical scaling expression has also been validated for low permeability nanoporous shale through several experimental and simulation observations zhou et al 2002 2016 zahasky and benson 2019 early time imbibition in fractured shales has been observed to deviate from this behavior as spontaneous imbibition progresses in fractured systems the time dependent behavior of matrix uptake of wetting fluid is determined by the rate of filling of fractures and the geometry of wetting fluid in fractures rangel german and kovscek 2002 square root of time scaling emerges for systems where fractures are filled more rapidly than the matrix imbibes transition from early to late time imbibition occurs when the fluid reaches a flow boundary reis and cil 2000 show an exponential time model for late stage imbibition while past literature has shown the isolated imbibition characteristics of fractured porous media lack of understanding still exists in the interplay of fractures of varying length the rate of advance of wetting fluid through fractures and uptake by matrix pores to promote imbibition across spatial and temporal scales this study focuses upon clearly distinguishing the multiscale features of a naturally fractured shale including matrix pores microcracks and fractures as they undergo imbibition the novelty of this work rests in the delineation of mixed imbibition characteristics of fractures and matrix from early to late time using nondestructive x ray computed tomography ct the ct images reveal definitively mixed imbibition microscopic spontaneous imbibition with square root of time scaling in shale matrix and macroscopic forced imbibition with close to linear time scaling in fractures while imbibition in fractures reaches steady state at early stage from wetting fluid completely imbibing fracture volume imbibition in matrix transitions from square root of time scaling to a nearly exponential decrease in imbibition rate at late times as brine contacts the outer boundary additionally the distinction from sub micrometer to mm scale fractures allows us to elucidate the significant contribution of micro cracks in promoting imbibition in unconventional rocks 2 experimental this section describes the experimental techniques and materials considered in this work including the core flooding set up experimental procedures and the rock sample used 2 1 experimental set up the fluid displacement experiments were performed using the system depicted in fig 1 the high pressure aluminum core holder accommodates core samples with diameter d 2 54 cm and lengths up to 10 cm the set up features three high pressure syringe pumps teledyne isco that allow for i continuous delivery of fluids from the inlet face of the sample model 500d ii maintenance of a fixed confining pressure model 500d as well as iii back pressure regulation to keep pore pressure at a set condition model 100dm the set up also consists of two high accuracy pressure transducers precise sensors inc range 0 6 9 mpa that are connected through the tubing located at the inlet and outlet faces of the sample as described in the following sections a vacuum pump leybold model d16b ultimate pressure 1 10 4 mbar was introduced to prepare the core in a vacuum state two erosion resistant high pressure vessels whitey swagelok model 304l hdf4 500 were mounted at the discharge end of the injection pump to store the wetting phase fluid brine used for the imbibition experiment and n decane to separate brine from di water in the isco pump additionally a back pressure regulator mity mite model s91xw was installed prior to the back pressure pump they serve to minimize the contact of brine solution with the isco pumps 2 2 sample preparation prior to the experiments the core sample was dried for at least 120 h in a vacuum oven at 45 c the sample was then sealed between an inlet and an outlet flow distribution end cap using high strength heat shrink fep plastic tubing and a foil diffusion barrier to prevent communication between the confining fluid di water and pore fluids e g co 2 and brine we pressure tested the seal for at least 24 h the initial condition of the sample for all characterization and injection study was at vacuum state 2 3 helium pulse decay the effective pressure confining pressure pore pressure was set at 1 72 mpa 250 psi throughout pulse decay as shown in the supplementary information si fig s1 pulse decay has an upstream volume at the inlet and downstream volume at the outlet of sample helium was injected at successive pressure at the upstream side we recorded the transient pressure as the downstream reservoir volume was opened to communicate with the upstream reservoir volume at each step we calculated the permeability as shown by brace et al 1968 alnoaimi 2016 and elkady and kovscek 2020 2 4 krypton saturated porosity the core was fully saturated with krypton gas 99 999 purity at 2 07 mpa 300 psi and confining pressure equivalent to 3 79 mpa 550 psi for a period of 7 days until the average ct intensity of the sample ceases to increase the core was imaged at vacuum and krypton saturated state using a ge lightspeed ct scanner operated at 140 kv 120 ma with voxel size of 195 195 625 μ m 3 krypton attenuates x rays significantly at this energy and is an excellent penetrant for imaging porosity vega et al 2014 further details on the ct scanning parameters are reported in table s1 the porosity was calculated based on the linear scaling method presented in akin and kovscek 2003 and is further explained in section 3 2 5 brine injection the core was first saturated with co 2 100 purity at 2 07 mpa 300 psi and confining pressure of 3 79 mpa 550 psi we injected brine equilibrated with the rock as developed by khan et al 2022 with the composition shown in table 1 into the sample at 3 65 mpa 530 psi with a backpressure of 3 17 mpa 460 psi and confining pressure of 4 83 mpa 700 psi we obtained eight repeated ct images at vacuum state co 2 saturated state and brine saturated state we collected several temporal ct images during the duration of brine imbibition for 12 days until the average ct intensity of the core ceases to increase and stabilizes the experiments were carried out at room temperature 2 6 rock sample a cylindrical wolfcamp shale core diameter 25 mm length 58 mm permian basin usa from a depth of 2867 m was used as shown in table 2 the sample composition is primarily quartz feldspar and plagioclase at nearly 67 7 wt followed by clay illite smectite and mica at 25 8 wt and calcite at 3 9 wt the sample also consists of small amount of organic matter and pyrite mineral at 2 7 wt and 2 6 wt respectively the mean permeability of the sample was 1 97 1 0 17 m 2 20 μ d using the pressure pulse decay method brace et al 1968 see fig s2 for details the core average porosity is ϕ m 0 102 0 006 at the voxel resolution v vox 2 4 1 0 2 mm 3 a 3d porosity map of the sample is presented in fig 2 together with the 2d cross sectional maps at three different axial locations the figure shows that each slice possesses multiple fractures that are non uniformly distributed throughout the entire 3d volume of the sample when compared against the corresponding micro ct μ ct tomograms at identical locations fig 2b 2 we observe that the sample also contains a large fraction of microfractures that are not discretely resolvable using ct note that while ct scans were collected to provide structural information on the spatial bulk porosity at the sub mm scale μ ct tomograms of the dry core were acquired at a much finer resolution v vox 2 0 1 0 5 mm 3 thereby providing a clear distinction between the bulk structure of matrix and the fractures while the matrix porosity remains relatively uniform at about 0 10 along the length of the core with a standard deviation of 9 9 1 0 4 fig 2c top panel there is significant variability in the fracture distribution the number of isolated fractures spans from 2 to 7 depending on the slice location fig 2c bottom panel it is important to highlight that the sample exhibits complicated multiscale features with macroscopic fractures that are sample spanning and disconnected micro cracks that act as additional sources for matrix imbibition accurate interpretation of fluid transport behavior on these intermediate scale geological samples is needed to address scale effects and generate data for validation of upscaling techniques mehmani et al 2021 3 image analysis methods the spatial distribution of the total voxel porosity ϕ was obtained using the classic linear scaling expression akin and kovscek 2003 1 ϕ x ct 1 r n x ct 2 r n x ct 1 ct 2 where x is the spatial coordinate x x y z ct 1 r and ct 2 r refer to the measured ct number in hounsfield units of the rock sample fully saturated with two inert fluid phases a gaseous pair air and krypton were used as the two calibration fluids because of their large diffusivities and small viscosities compared to liquids in addition krypton offers significant attenuation to x ray energies as compared to air thereby providing a sufficient contrast for porosity measurements vega et al 2014 krypton adsorption was considered negligible due to comparatively small amount of organic matter carried by the rock core aljamaan et al 2017 however additional investigation may be necessary to validate fully this assumption because the pore surface can still contain a non trivial amount of absorbents because the density of organic matter is substantially smaller than other minerals such as quartz the denominator in eq 1 refers to the ct numbers of the pure fluids that have been measured from a calibration of the scanner air 1000 hu and krypton 441 hu the superscript n denotes the number of repeated scans performed in the experiments the dynamic ct scans were computed in terms of volume of brine imbibed per unit voxel i 2 i x t s x t ϕ x v vox where s v wet v p is the wetting phase brine saturation and ϕ v p v vox is the total voxel porosity v vox v wet and v p are the volumes associated with the voxel brine and pore space respectively the wetting phase saturation is given by akin and kovscek 2003 3 s x t ct 12 r x t ct 1 r n x ϕ x ct 2 ct 1 where ct 12 r is the ct number of the core during brine injection and δ ct ct 12 r x t ct 1 r n x the subscripts 1 and 2 refer to the non wetting air and wetting brine phase respectively and t is the time coordinate combining eqs 1 3 yield the following expression for the ct imbibed volume 4 i x t ct 12 r x t ct 1 r n x ct 2 ct 1 v vox the voxel size for all the 3d maps presented are computed as 195 195 625 μ m 3 n 4 has been considered to optimize the quality of the imaging datasets full details of the ct image optimization and error analysis are provided in section s1 of the si file 4 results and discussion this section presents an analysis of the dynamic images of the wolfcamp sample to portray multidimensional observations of matrix fracture interactions during imbibition the role of micrometer sized fractures on imbibition as well as the macroscopic imbibition characteristics of fractures versus matrix at early and late times are also discussed 4 1 multidimensional observations of matrix fracture interactions fig 3 depicts the dynamic 3d maps of a synthetic reservoir brine flowing into a naturally fractured sample with pore spaces and fractures initially filled with co 2 the 2d cross sectional maps at three different slice locations namely 7 5 mm 28 mm and 55 mm from the inlet face of the core are also presented the ct imaging technique not only provides the required ct contrast for the fluid rock and fluid fluid interactions but it does so at sufficient spatial and temporal resolution thereby allowing for the visualization of multiple imbibition fronts penetrating simultaneously from fractures of disparate aperture sizes the figure illustrates that the injected brine quickly flows into the more permeable open fracture located throughout the core length suggesting that the fracture network is interconnected from the inlet to the outlet face of the core the interconnectivity of the fractures through which brine flowed is also highlighted in fig s3 the brine within these fractures then gradually imbibes into the matrix producing an exceptionally heterogeneous aqueous fluid distribution in the rock core when the dynamic profiles are reconstructed on a 1d slice averaged basis fig s4b the overall shape of the curve remains similar during the entire imbibition process suggesting that matrix imbibition is effectively taking place from the fracture networks simultaneously at all spatial locations along the direction of flow see the schematic diagram depicted in fig s4c notably the existence of multiple and well connected fractures is a key characteristic responsible for accelerating the imbibition time scale in the nanoporous shale capillary equilibrium of matrix with fracture fluid was reached in o 200 h see fig s4a as the core averaged ct number remained unchanged for another 100 h 40 pore volumes of steady brine injection at capillary equilibrium the total imbibed volume i e i tot σ i vox is 1 51 1 0 3 mm 3 this is smaller than the total void space pore and fractures available in the medium v void 2 90 1 0 3 mm 3 v core ϕ m the resulting average brine saturation is s w i tot v void 0 52 the value obtained is similar to the results from direct pore scale modeling of imbibition under similar experimental and geometric settings i e s 0 4 0 6 bakhshian et al 2020 this finding enables us to draw two key conclusions first the majority of co 2 in the small pores remains residually trapped and is not displaced by the water this result implies the strong affinity of the rock sample to the aqueous phase fluid that can result in the formation of a substantial amount of co 2 ganglia due to pore scale processes such as snap off events and bypass trapping mehmani et al 2019 these events are readily demonstrated in the literature at the pore scale through direct observations using 2d micro models mehmani et al 2019 and 3d micro ct imaging singh et al 2017 following the imbibition of water in consolidated porous media second brine imbibition provides the potential to immobilize a large amount of co 2 in the wolfcamp shale the trapped gas saturation found is greater than those reported for sandstones and carbonates rocks for co 2 water system residual trapping of co 2 10 40 depending on the initial co 2 saturation prior to imbibition krevor et al 2012 el maghraby and blunt 2012 krevor et al 2015 al menhali and krevor 2016 offering a significant potential for co 2 storage applications another important finding is that the presence of sub micrometer sized fractures significantly enhances the spatial extent of imbibition as an example of general validity the 2d imbibition maps depicted in fig 3b at 28 mm from the inlet reveal signs of brine penetrating into the rock matrix predominantly from the two discrete vertical fractures one located on the left and another located on the right hand side of the cross sectional slice we note that these two fractures possess very different aperture sizes as demonstrated in the middle panel of fig 2b 1 the aperture on the left is quantified using the calibration free missing attenuation cfma method huo et al 2016 wenning et al 2019 as d m 47 μ m on the other hand the vertical fracture located on the right is barely resolvable even from the corresponding μ ct image fig 2b 2 middle panel with much better spatial resolution i e v vox ct v vox μ ct 400 another example is given at 50 mm from the inlet where imbibition takes place simultaneously from six different fractures of very different apertures fig 3b bottom panel further interpretations are discussed in the next section these results highlight the important value of acquiring time lapse ct scans because they enable the identification of both fluid saturation evolution and geometric properties of the small fractures that would otherwise not be possible with steady state scans taken at the same spatial resolution the role of sub resolution fractures was measured because imaging the spatial evolution of imbibition is very effective at tracking the progress of multiphase fluid displacement irrespective of the size of the apertures 4 2 the importance of micrometer sized fractures to imbibition the prominent impact of small scale apertures in advancing imbibition evolution into the shale matrix is evident in fig 4a that depicts the slice averaged 1d saturation profiles of water uptake from position c to c over eight distinct time intervals two sharp peaks are observed at locations 3 mm and 19 mm from the left corresponding to the responses from the bigger d m 1 47 μ m and the ct unresolved vertical fractures respectively the smaller apertures are estimated from the figure by comparing the relative size of the two peaks at equilibrium i e α a frac 2 a frac 1 0 083 accordingly d m 2 d m 1 α 3 9 μ m is obtained for the smaller fracture we note that the two imbibition fronts evolve into the matrix from their respective fractures at the same speed where they eventually meet at the center location between the two fractures when the 1d profiles are plotted at each individual voxel location perpendicular to the fractures fig s5 we notice that the local displacement produces a rather piston like front in agreement with the literature observations for water gas systems in siliceous shale akin et al 2000 zhou et al 2002 sandstones fernø et al 2015 zhao et al 2017 zahasky and benson 2022 and carbonates alyafei et al 2016 singh et al 2022 at other locations so called anomalous roughening buldyrev et al 1992 is also evidenced this may be attributed to the variability in the local topology permeability and capillary pressure properties akin et al 2000 gruener et al 2012 but we also find the presence of micro cracks largely interferes the displacement fronts as discussed below the behavior of wetting front displacement is additionally controlled by the existence of short micro cracks in the rock sample this is shown from fig 2b 2 that the system also contains notable amounts of micro cracks in addition to the fractures by spatially mapping the location of these cracks to the dynamic images we provide direct observations of the spatial and temporal changes in the progress of imbibition during matrix fracture interactions caused by the presence of these micro cracks for example we indicate that a micro crack located adjacent to the large fracture at 28 mm slice fig 2b 2 denoted as ② played a dominant role in heterogenization of the spatial extent of the imbibition front fig 3b notably these micro cracks contributed enormously towards speeding up the extent of wetting front displacement thereby significantly accelerating the time scale to reach equilibrium between fracture and matrix this is indicated in fig 4b where saturation is plotted over time at each spatial position perpendicular to the fractures for the 28 mm slice by considering two clusters of curves orange lines correspond to the top section with two fractures d m 1 47 μ m d m 2 3 9 μ m and a micro crack whereas the cloud of purple lines are the perpendicular transects with no micro crack present steady state is readily reached within 100 h of brine imbibition contrary to the locations with no micro cracks that take about 200 h we note that the sample was used as received all of the micro cracks and fractures are pre existing in the sample that is the effects of water adsorption in these experiments were not sufficient to introduce new micro cracks or result in noticeable micro crack propagation as can be confirmed by a comparison of the dynamic images fig 3b with the reference μ ct scans acquired prior to the experiments fig 2b this is primarily because the synthetic brine used in the experiments is equilibrated with the rock minerals moreover there is a limited amount of expansive clay minerals present in the wolfcamp core i e smectite 1wt see table 2 that may otherwise lead to a permeability increase through swelling induced micro cracking dehghanpour et al 2013 the result from this study makes clear that the evolution of imbibition can be substantially intensified for shales that contains high expandable clay contents as shown by the pore scale simulation of bakhshian et al 2020 failure to account for the microscopic features of the rock leads to underestimation of the broadening dynamics of the imbibition interface this is because theoretical models that consider an effective property often result in a dampening effect on the local propagation of the imbibition front gruener et al 2012 however the application of pore scale modeling frameworks at scales of 1 cm and above is still out of reach because of the associated computational costs xiong et al 2016 recent advances in the upscaling of solute transport and reaction in multiscale fractured systems include the uses of machine learning techniques mehmani et al 2021 these studies require extensive datasets of both static and dynamic images that serve as training datasets as well as model results validation the datasets presented in this work can thus be used as benchmarks for the development of more advanced tools for predicting imbibition dynamics 4 3 macroscopic imbibition dynamics fig 5a and b evaluate the evolution of imbibition over time for the entire core sample with v core 28 5 cm 3 within the host matrix and within the fractures respectively the circles are the core averaged values whereas the cloud of grey curves reflect variations in the slice averaged quantities interestingly we note that the local variations in the matrix imbibition on a slice by slice basis is rather small this suggests that the matrix properties that affect imbibition such as pore sizes are similar throughout spatial locations within the core this further implies that the deviations from an ideal displacement front observed in the previous section are most likely dominated by the existence of micro cracks in the shale core in fact it was shown in fig 2 that the rock sample is characterized by an approximately homogeneous porosity distribution across the matrix while matrix imbibition is completed at about t eq 200 h for all the slice locations we find that the imbibition time scale is much faster within the fractures i e t eq 23 h the imbibition rate i rate is obtained by taking the derivative of the volume of water imbibed with respect to time δ i i t n i t n 1 δ t t n t n 1 the results are given in fig 5c and d for the matrix and fracture flows respectively as expected the overall imbibition rate decreases over time for both matrix and fracture this is due to i the increase in viscous resistance as the more viscous wetting phase fluid imbibes the matrix traveling farther from the fractures and ii the decrease in capillary forces as the brine phase saturation increases locally notably matrix imbibition initially proceeds at a rate proportional to t 1 2 solid line fig 5c in accordance with the scaling expression presented in the literature for capillary driven flow lucas 1918 washburn 1921 at later times t 23 h the matrix imbibition rate decays more rapidly than the square root of time behavior similar to the experimental observations reported for non fractured porous media li and firoozabadi 2000 zahasky and benson 2019 farrokhrouz et al 2021 it was shown in these studies that the imbibition front reaching the outlet face of the sample is responsible for the late time effects at which point the imbibition rate can be significantly reduced standnes et al 2020 reis and cil 2000 also show through experimental and analytical solutions that imbibition declines exponentially during late time periods for naturally fractured porous media in our experimental setting the deviation from semi infinite scaling during fracture matrix flows occurs when the imbibition front reaches the peripheral boundary of the core at about 23 h see fig 3b boundaries act as flow barriers to inhibit greatly the progress of the imbibition process for fracture flows imbibition is pressure driven i e forced and we obtain an apparent imbibition rate that declines inversely with time consistent with darcy s law solid line fig 5 d fig s3 shows that breakthrough of water to the outlet occurred in less than 0 1 h and that the water saturation in the fractures at the core inlet stabilized in less than 4 1 h steady saturation in the fractures emerged in roughly 23 h accordingly the imbibition rate in fractures evolves quickly after breakthrough steady water saturation in the fractures is reached at 20 to 25 h and the rate transitions to 0 we attribute the behavior after about 20 h in fig 5 d to noise that oscillates around 0 and decreases in time we initially expected that the fracture imbibition rate would scale as t 1 2 because the injection rate is constant and fractures transfer wetting fluid to the matrix at a rate that initially scales as t 1 2 completion of imbibition in fractures requires about a tenth of the time needed in the matrix leading to few data points to describe imbibition behavior in fractures the order of magnitude difference in time to completion of imbibition in fractures compared to matrix thereby leads to poor resolution of the fracture imbibition rate with respect to time this observation may account for the fracture imbibition rate appearing to be proportional to 1 t until the fracture is filled with water additionally rangel german and kovscek 2002 show that multidimensional imbibition as well as imbibition occurring through combined forced and spontaneous processes yields complex time scaling deviating from classical t 1 2 results hence additional studies are recommended taken together these results provide direct quantitative observations that reveal mixed imbibition phenomena in multiscale fractured rock cores capillary driven imbibition occurs within the microscopic pore spaces and macroscopic forced imbibition is driven by the applied pressure gradient in the fracture apertures 5 conclusion imbibition spontaneous or forced is fundamental to fluid flow processes in porous media this study unveils the dynamics of mixed imbibition processes in a complex heterogeneous naturally fractured nanoporous medium initially saturated with co 2 using nondestructive x ray ct imaging spontaneous imbibition and corresponding square root of time scaling is found at early time in shale matrix with a transition to nearly exponential decrease in imbibition rate as the brine contacts flow boundaries at later times the fractures display pressure driven forced imbibition the time lapse ct images during imbibition expose the prevalence of cracks that exist below imaging resolution the identified micro cracks contribute significantly to the heterogenization and acceleration of the spatial extent of imbibition fronts substantial nonwetting phase is trapped during imbibition in this unconventional sample with a final gas saturation of 48 characterization of dynamic multiscale transport physics is essential to realizing the potential of subsurface energy and storage formation resources such characterization is achieved here in macroscopic sized samples of natural nanoporous media the distinction among mixed imbibition processes at various length and temporal scales is relevant to co 2 storage reinjection of spent geothermal fluids and stimulation of unconventional low permeability formations to increase heat and or natural gas recovery credit authorship contribution statement takeshi kurotori conceptualization methodology software formal analysis investigation writing original draft writing review editing manju pharkavi murugesu conceptualization methodology data curation formal analysis investigation writing original draft writing review editing christopher zahasky conceptualization methodology investigation writing original draft writing review editing bolivia vega conceptualization methodology investigation writing original draft jennifer l druhan conceptualization methodology investigation writing original draft writing review editing sally m benson conceptualization methodology supervision anthony r kovscek conceptualization methodology supervision writing original draft writing review editing project administration funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work was supported as part of the center for mechanistic control of unconventional formations cmc uf an energy frontier research center funded by the u s department of energy office of science under doe bes award de sc0019165 μ ct imaging was performed at the stanford nano shared facilities snsf supported by the national science foundation under award eccs 2026822 we thank hasan khan for the insightful discussions appendix a supplementary data supplementary material related to this article can be found online at https doi org 10 1016 j advwatres 2023 104429 appendix a supplementary data the following is the supplementary material related to this article s1 supplementary raw research data and analysis 
34,imbibition plays a central role during multiphase flows in geological media yet our understanding of imbibition dynamics across the multiscale features of rocks including fractures microcracks and heterogeneous matrices is limited here we deployed a unique combination of micro and clinical x ray ct imaging to probe directly the spatiotemporal evolution of imbibition in a natural multiscale shale sample the method enabled unraveling of mixed imbibition behavior with spontaneous imbibition rates in the matrix pores and microcracks driven by capillarity proceeding as t 1 2 whereas pressure driven flows in the macroscopic fractures yield apparent imbibition rates with t 1 scaling regardless of the aperture we showed that spontaneous imbibition proceeds uniformly away from the fractures the effects of microcracks are further investigated by comparing the dynamics of the imbibition fronts with and without microcracks these results highlight the paramount role of microcracks on anomalous front roughening and the need to account for microcracks appropriately in the development of predictive theoretical models graphical abstract keywords spontaneous imbibition forced imbibition multiscale imaging nanoporous shale fractures microcracks data availability all static and dynamic ct datasets acquired in this work may be obtained from the stanford digital repository using the following link https doi org 10 25740 nj176bd5255 kurotori et al 2022 1 introduction fractures natural or engineered are prevalent in many domains especially subsurface geological systems such as aquifers geothermal reservoirs and shale formations fountain and walder 1998 mayer and sharp 1998 curtis 2002 jourdain et al 2014 mcclure and horne 2014 caulk et al 2016 berre et al 2019 fractures are physical discontinuities in geological media created by normal or shear stress exceeding the rock strength despite their discrete volumetric extent fractures may act as dominant flow conduits during co 2 sequestration h 2 storage nuclear waste disposal geothermal energy extraction and hydrocarbon recovery bachu 2008 tarkowski 2019 eia 2021 viswanathan et al 2022 the discontinuous nature of fractured geological media is challenging to characterize because it produces multi length scale domains with complex flow and transport behavior across spatial and temporal scales mehmani et al 2021 this is especially true for low permeability tight geological media such as shale that contain both pores on the order of 10 nanometers froute and kovscek 2020 and fractures as large as meters in scale houben et al 2017 while geothermal and shale formations supply primary energy in the united states gaps in understanding of fluid flow in fractured systems lead to sub optimal utilization of these essential resources for example approximately 2 million gallons of water is used for the generation of every mw of power from geothermal formations clark et al 2010 the us geological survey also reports that 1 5 to 16 million gallons of water is injected per well to stimulate low permeability shale formations chen and carter 2016 usgs 2019 large volumes of this injected water remain in the reservoir with low flowback efficiency lan et al 2014 ge et al 2015 epa 2021 resulting in efficiency as low as 5 of the total injected volume ghanbari and dehghanpour 2016 improved understanding of fluid rock interaction is key for reducing water usage and improving the efficiency of energy recovery imbibition controls the advancement of wetting fluid in many everyday materials such as biscuits clothes floors and rocks among numerous examples akin et al 2000 alava et al 2004 gruener et al 2012 imbibition is typically characterized as co current or countercurrent and spontaneous or forced co current imbibition is when the two fluids move in the same direction as opposed to moving past each other as in counter current imbibition spontaneous imbibition often dominates fluid flow in partially saturated unconventional formations due to the significant capillary suction pressure in nanoporous shale matrices takahashi and kovscek 2010 makhanov et al 2012 roychaudhuri et al 2013 forced imbibition is dominant in large fractures where flow is driven by fluid pressure gradients mechanisms that drive imbibition control how multiphase fluid displacement advances across temporal scales spontaneous imbibition in a one dimensional capillary dominated porous medium may be represented by a relationship between imbibition distance or rate and square root of time washburn 1921 mcwhorter and sunada 1990 akin et al 2000 yang et al 2021 while this analytical scaling expression has also been validated for low permeability nanoporous shale through several experimental and simulation observations zhou et al 2002 2016 zahasky and benson 2019 early time imbibition in fractured shales has been observed to deviate from this behavior as spontaneous imbibition progresses in fractured systems the time dependent behavior of matrix uptake of wetting fluid is determined by the rate of filling of fractures and the geometry of wetting fluid in fractures rangel german and kovscek 2002 square root of time scaling emerges for systems where fractures are filled more rapidly than the matrix imbibes transition from early to late time imbibition occurs when the fluid reaches a flow boundary reis and cil 2000 show an exponential time model for late stage imbibition while past literature has shown the isolated imbibition characteristics of fractured porous media lack of understanding still exists in the interplay of fractures of varying length the rate of advance of wetting fluid through fractures and uptake by matrix pores to promote imbibition across spatial and temporal scales this study focuses upon clearly distinguishing the multiscale features of a naturally fractured shale including matrix pores microcracks and fractures as they undergo imbibition the novelty of this work rests in the delineation of mixed imbibition characteristics of fractures and matrix from early to late time using nondestructive x ray computed tomography ct the ct images reveal definitively mixed imbibition microscopic spontaneous imbibition with square root of time scaling in shale matrix and macroscopic forced imbibition with close to linear time scaling in fractures while imbibition in fractures reaches steady state at early stage from wetting fluid completely imbibing fracture volume imbibition in matrix transitions from square root of time scaling to a nearly exponential decrease in imbibition rate at late times as brine contacts the outer boundary additionally the distinction from sub micrometer to mm scale fractures allows us to elucidate the significant contribution of micro cracks in promoting imbibition in unconventional rocks 2 experimental this section describes the experimental techniques and materials considered in this work including the core flooding set up experimental procedures and the rock sample used 2 1 experimental set up the fluid displacement experiments were performed using the system depicted in fig 1 the high pressure aluminum core holder accommodates core samples with diameter d 2 54 cm and lengths up to 10 cm the set up features three high pressure syringe pumps teledyne isco that allow for i continuous delivery of fluids from the inlet face of the sample model 500d ii maintenance of a fixed confining pressure model 500d as well as iii back pressure regulation to keep pore pressure at a set condition model 100dm the set up also consists of two high accuracy pressure transducers precise sensors inc range 0 6 9 mpa that are connected through the tubing located at the inlet and outlet faces of the sample as described in the following sections a vacuum pump leybold model d16b ultimate pressure 1 10 4 mbar was introduced to prepare the core in a vacuum state two erosion resistant high pressure vessels whitey swagelok model 304l hdf4 500 were mounted at the discharge end of the injection pump to store the wetting phase fluid brine used for the imbibition experiment and n decane to separate brine from di water in the isco pump additionally a back pressure regulator mity mite model s91xw was installed prior to the back pressure pump they serve to minimize the contact of brine solution with the isco pumps 2 2 sample preparation prior to the experiments the core sample was dried for at least 120 h in a vacuum oven at 45 c the sample was then sealed between an inlet and an outlet flow distribution end cap using high strength heat shrink fep plastic tubing and a foil diffusion barrier to prevent communication between the confining fluid di water and pore fluids e g co 2 and brine we pressure tested the seal for at least 24 h the initial condition of the sample for all characterization and injection study was at vacuum state 2 3 helium pulse decay the effective pressure confining pressure pore pressure was set at 1 72 mpa 250 psi throughout pulse decay as shown in the supplementary information si fig s1 pulse decay has an upstream volume at the inlet and downstream volume at the outlet of sample helium was injected at successive pressure at the upstream side we recorded the transient pressure as the downstream reservoir volume was opened to communicate with the upstream reservoir volume at each step we calculated the permeability as shown by brace et al 1968 alnoaimi 2016 and elkady and kovscek 2020 2 4 krypton saturated porosity the core was fully saturated with krypton gas 99 999 purity at 2 07 mpa 300 psi and confining pressure equivalent to 3 79 mpa 550 psi for a period of 7 days until the average ct intensity of the sample ceases to increase the core was imaged at vacuum and krypton saturated state using a ge lightspeed ct scanner operated at 140 kv 120 ma with voxel size of 195 195 625 μ m 3 krypton attenuates x rays significantly at this energy and is an excellent penetrant for imaging porosity vega et al 2014 further details on the ct scanning parameters are reported in table s1 the porosity was calculated based on the linear scaling method presented in akin and kovscek 2003 and is further explained in section 3 2 5 brine injection the core was first saturated with co 2 100 purity at 2 07 mpa 300 psi and confining pressure of 3 79 mpa 550 psi we injected brine equilibrated with the rock as developed by khan et al 2022 with the composition shown in table 1 into the sample at 3 65 mpa 530 psi with a backpressure of 3 17 mpa 460 psi and confining pressure of 4 83 mpa 700 psi we obtained eight repeated ct images at vacuum state co 2 saturated state and brine saturated state we collected several temporal ct images during the duration of brine imbibition for 12 days until the average ct intensity of the core ceases to increase and stabilizes the experiments were carried out at room temperature 2 6 rock sample a cylindrical wolfcamp shale core diameter 25 mm length 58 mm permian basin usa from a depth of 2867 m was used as shown in table 2 the sample composition is primarily quartz feldspar and plagioclase at nearly 67 7 wt followed by clay illite smectite and mica at 25 8 wt and calcite at 3 9 wt the sample also consists of small amount of organic matter and pyrite mineral at 2 7 wt and 2 6 wt respectively the mean permeability of the sample was 1 97 1 0 17 m 2 20 μ d using the pressure pulse decay method brace et al 1968 see fig s2 for details the core average porosity is ϕ m 0 102 0 006 at the voxel resolution v vox 2 4 1 0 2 mm 3 a 3d porosity map of the sample is presented in fig 2 together with the 2d cross sectional maps at three different axial locations the figure shows that each slice possesses multiple fractures that are non uniformly distributed throughout the entire 3d volume of the sample when compared against the corresponding micro ct μ ct tomograms at identical locations fig 2b 2 we observe that the sample also contains a large fraction of microfractures that are not discretely resolvable using ct note that while ct scans were collected to provide structural information on the spatial bulk porosity at the sub mm scale μ ct tomograms of the dry core were acquired at a much finer resolution v vox 2 0 1 0 5 mm 3 thereby providing a clear distinction between the bulk structure of matrix and the fractures while the matrix porosity remains relatively uniform at about 0 10 along the length of the core with a standard deviation of 9 9 1 0 4 fig 2c top panel there is significant variability in the fracture distribution the number of isolated fractures spans from 2 to 7 depending on the slice location fig 2c bottom panel it is important to highlight that the sample exhibits complicated multiscale features with macroscopic fractures that are sample spanning and disconnected micro cracks that act as additional sources for matrix imbibition accurate interpretation of fluid transport behavior on these intermediate scale geological samples is needed to address scale effects and generate data for validation of upscaling techniques mehmani et al 2021 3 image analysis methods the spatial distribution of the total voxel porosity ϕ was obtained using the classic linear scaling expression akin and kovscek 2003 1 ϕ x ct 1 r n x ct 2 r n x ct 1 ct 2 where x is the spatial coordinate x x y z ct 1 r and ct 2 r refer to the measured ct number in hounsfield units of the rock sample fully saturated with two inert fluid phases a gaseous pair air and krypton were used as the two calibration fluids because of their large diffusivities and small viscosities compared to liquids in addition krypton offers significant attenuation to x ray energies as compared to air thereby providing a sufficient contrast for porosity measurements vega et al 2014 krypton adsorption was considered negligible due to comparatively small amount of organic matter carried by the rock core aljamaan et al 2017 however additional investigation may be necessary to validate fully this assumption because the pore surface can still contain a non trivial amount of absorbents because the density of organic matter is substantially smaller than other minerals such as quartz the denominator in eq 1 refers to the ct numbers of the pure fluids that have been measured from a calibration of the scanner air 1000 hu and krypton 441 hu the superscript n denotes the number of repeated scans performed in the experiments the dynamic ct scans were computed in terms of volume of brine imbibed per unit voxel i 2 i x t s x t ϕ x v vox where s v wet v p is the wetting phase brine saturation and ϕ v p v vox is the total voxel porosity v vox v wet and v p are the volumes associated with the voxel brine and pore space respectively the wetting phase saturation is given by akin and kovscek 2003 3 s x t ct 12 r x t ct 1 r n x ϕ x ct 2 ct 1 where ct 12 r is the ct number of the core during brine injection and δ ct ct 12 r x t ct 1 r n x the subscripts 1 and 2 refer to the non wetting air and wetting brine phase respectively and t is the time coordinate combining eqs 1 3 yield the following expression for the ct imbibed volume 4 i x t ct 12 r x t ct 1 r n x ct 2 ct 1 v vox the voxel size for all the 3d maps presented are computed as 195 195 625 μ m 3 n 4 has been considered to optimize the quality of the imaging datasets full details of the ct image optimization and error analysis are provided in section s1 of the si file 4 results and discussion this section presents an analysis of the dynamic images of the wolfcamp sample to portray multidimensional observations of matrix fracture interactions during imbibition the role of micrometer sized fractures on imbibition as well as the macroscopic imbibition characteristics of fractures versus matrix at early and late times are also discussed 4 1 multidimensional observations of matrix fracture interactions fig 3 depicts the dynamic 3d maps of a synthetic reservoir brine flowing into a naturally fractured sample with pore spaces and fractures initially filled with co 2 the 2d cross sectional maps at three different slice locations namely 7 5 mm 28 mm and 55 mm from the inlet face of the core are also presented the ct imaging technique not only provides the required ct contrast for the fluid rock and fluid fluid interactions but it does so at sufficient spatial and temporal resolution thereby allowing for the visualization of multiple imbibition fronts penetrating simultaneously from fractures of disparate aperture sizes the figure illustrates that the injected brine quickly flows into the more permeable open fracture located throughout the core length suggesting that the fracture network is interconnected from the inlet to the outlet face of the core the interconnectivity of the fractures through which brine flowed is also highlighted in fig s3 the brine within these fractures then gradually imbibes into the matrix producing an exceptionally heterogeneous aqueous fluid distribution in the rock core when the dynamic profiles are reconstructed on a 1d slice averaged basis fig s4b the overall shape of the curve remains similar during the entire imbibition process suggesting that matrix imbibition is effectively taking place from the fracture networks simultaneously at all spatial locations along the direction of flow see the schematic diagram depicted in fig s4c notably the existence of multiple and well connected fractures is a key characteristic responsible for accelerating the imbibition time scale in the nanoporous shale capillary equilibrium of matrix with fracture fluid was reached in o 200 h see fig s4a as the core averaged ct number remained unchanged for another 100 h 40 pore volumes of steady brine injection at capillary equilibrium the total imbibed volume i e i tot σ i vox is 1 51 1 0 3 mm 3 this is smaller than the total void space pore and fractures available in the medium v void 2 90 1 0 3 mm 3 v core ϕ m the resulting average brine saturation is s w i tot v void 0 52 the value obtained is similar to the results from direct pore scale modeling of imbibition under similar experimental and geometric settings i e s 0 4 0 6 bakhshian et al 2020 this finding enables us to draw two key conclusions first the majority of co 2 in the small pores remains residually trapped and is not displaced by the water this result implies the strong affinity of the rock sample to the aqueous phase fluid that can result in the formation of a substantial amount of co 2 ganglia due to pore scale processes such as snap off events and bypass trapping mehmani et al 2019 these events are readily demonstrated in the literature at the pore scale through direct observations using 2d micro models mehmani et al 2019 and 3d micro ct imaging singh et al 2017 following the imbibition of water in consolidated porous media second brine imbibition provides the potential to immobilize a large amount of co 2 in the wolfcamp shale the trapped gas saturation found is greater than those reported for sandstones and carbonates rocks for co 2 water system residual trapping of co 2 10 40 depending on the initial co 2 saturation prior to imbibition krevor et al 2012 el maghraby and blunt 2012 krevor et al 2015 al menhali and krevor 2016 offering a significant potential for co 2 storage applications another important finding is that the presence of sub micrometer sized fractures significantly enhances the spatial extent of imbibition as an example of general validity the 2d imbibition maps depicted in fig 3b at 28 mm from the inlet reveal signs of brine penetrating into the rock matrix predominantly from the two discrete vertical fractures one located on the left and another located on the right hand side of the cross sectional slice we note that these two fractures possess very different aperture sizes as demonstrated in the middle panel of fig 2b 1 the aperture on the left is quantified using the calibration free missing attenuation cfma method huo et al 2016 wenning et al 2019 as d m 47 μ m on the other hand the vertical fracture located on the right is barely resolvable even from the corresponding μ ct image fig 2b 2 middle panel with much better spatial resolution i e v vox ct v vox μ ct 400 another example is given at 50 mm from the inlet where imbibition takes place simultaneously from six different fractures of very different apertures fig 3b bottom panel further interpretations are discussed in the next section these results highlight the important value of acquiring time lapse ct scans because they enable the identification of both fluid saturation evolution and geometric properties of the small fractures that would otherwise not be possible with steady state scans taken at the same spatial resolution the role of sub resolution fractures was measured because imaging the spatial evolution of imbibition is very effective at tracking the progress of multiphase fluid displacement irrespective of the size of the apertures 4 2 the importance of micrometer sized fractures to imbibition the prominent impact of small scale apertures in advancing imbibition evolution into the shale matrix is evident in fig 4a that depicts the slice averaged 1d saturation profiles of water uptake from position c to c over eight distinct time intervals two sharp peaks are observed at locations 3 mm and 19 mm from the left corresponding to the responses from the bigger d m 1 47 μ m and the ct unresolved vertical fractures respectively the smaller apertures are estimated from the figure by comparing the relative size of the two peaks at equilibrium i e α a frac 2 a frac 1 0 083 accordingly d m 2 d m 1 α 3 9 μ m is obtained for the smaller fracture we note that the two imbibition fronts evolve into the matrix from their respective fractures at the same speed where they eventually meet at the center location between the two fractures when the 1d profiles are plotted at each individual voxel location perpendicular to the fractures fig s5 we notice that the local displacement produces a rather piston like front in agreement with the literature observations for water gas systems in siliceous shale akin et al 2000 zhou et al 2002 sandstones fernø et al 2015 zhao et al 2017 zahasky and benson 2022 and carbonates alyafei et al 2016 singh et al 2022 at other locations so called anomalous roughening buldyrev et al 1992 is also evidenced this may be attributed to the variability in the local topology permeability and capillary pressure properties akin et al 2000 gruener et al 2012 but we also find the presence of micro cracks largely interferes the displacement fronts as discussed below the behavior of wetting front displacement is additionally controlled by the existence of short micro cracks in the rock sample this is shown from fig 2b 2 that the system also contains notable amounts of micro cracks in addition to the fractures by spatially mapping the location of these cracks to the dynamic images we provide direct observations of the spatial and temporal changes in the progress of imbibition during matrix fracture interactions caused by the presence of these micro cracks for example we indicate that a micro crack located adjacent to the large fracture at 28 mm slice fig 2b 2 denoted as ② played a dominant role in heterogenization of the spatial extent of the imbibition front fig 3b notably these micro cracks contributed enormously towards speeding up the extent of wetting front displacement thereby significantly accelerating the time scale to reach equilibrium between fracture and matrix this is indicated in fig 4b where saturation is plotted over time at each spatial position perpendicular to the fractures for the 28 mm slice by considering two clusters of curves orange lines correspond to the top section with two fractures d m 1 47 μ m d m 2 3 9 μ m and a micro crack whereas the cloud of purple lines are the perpendicular transects with no micro crack present steady state is readily reached within 100 h of brine imbibition contrary to the locations with no micro cracks that take about 200 h we note that the sample was used as received all of the micro cracks and fractures are pre existing in the sample that is the effects of water adsorption in these experiments were not sufficient to introduce new micro cracks or result in noticeable micro crack propagation as can be confirmed by a comparison of the dynamic images fig 3b with the reference μ ct scans acquired prior to the experiments fig 2b this is primarily because the synthetic brine used in the experiments is equilibrated with the rock minerals moreover there is a limited amount of expansive clay minerals present in the wolfcamp core i e smectite 1wt see table 2 that may otherwise lead to a permeability increase through swelling induced micro cracking dehghanpour et al 2013 the result from this study makes clear that the evolution of imbibition can be substantially intensified for shales that contains high expandable clay contents as shown by the pore scale simulation of bakhshian et al 2020 failure to account for the microscopic features of the rock leads to underestimation of the broadening dynamics of the imbibition interface this is because theoretical models that consider an effective property often result in a dampening effect on the local propagation of the imbibition front gruener et al 2012 however the application of pore scale modeling frameworks at scales of 1 cm and above is still out of reach because of the associated computational costs xiong et al 2016 recent advances in the upscaling of solute transport and reaction in multiscale fractured systems include the uses of machine learning techniques mehmani et al 2021 these studies require extensive datasets of both static and dynamic images that serve as training datasets as well as model results validation the datasets presented in this work can thus be used as benchmarks for the development of more advanced tools for predicting imbibition dynamics 4 3 macroscopic imbibition dynamics fig 5a and b evaluate the evolution of imbibition over time for the entire core sample with v core 28 5 cm 3 within the host matrix and within the fractures respectively the circles are the core averaged values whereas the cloud of grey curves reflect variations in the slice averaged quantities interestingly we note that the local variations in the matrix imbibition on a slice by slice basis is rather small this suggests that the matrix properties that affect imbibition such as pore sizes are similar throughout spatial locations within the core this further implies that the deviations from an ideal displacement front observed in the previous section are most likely dominated by the existence of micro cracks in the shale core in fact it was shown in fig 2 that the rock sample is characterized by an approximately homogeneous porosity distribution across the matrix while matrix imbibition is completed at about t eq 200 h for all the slice locations we find that the imbibition time scale is much faster within the fractures i e t eq 23 h the imbibition rate i rate is obtained by taking the derivative of the volume of water imbibed with respect to time δ i i t n i t n 1 δ t t n t n 1 the results are given in fig 5c and d for the matrix and fracture flows respectively as expected the overall imbibition rate decreases over time for both matrix and fracture this is due to i the increase in viscous resistance as the more viscous wetting phase fluid imbibes the matrix traveling farther from the fractures and ii the decrease in capillary forces as the brine phase saturation increases locally notably matrix imbibition initially proceeds at a rate proportional to t 1 2 solid line fig 5c in accordance with the scaling expression presented in the literature for capillary driven flow lucas 1918 washburn 1921 at later times t 23 h the matrix imbibition rate decays more rapidly than the square root of time behavior similar to the experimental observations reported for non fractured porous media li and firoozabadi 2000 zahasky and benson 2019 farrokhrouz et al 2021 it was shown in these studies that the imbibition front reaching the outlet face of the sample is responsible for the late time effects at which point the imbibition rate can be significantly reduced standnes et al 2020 reis and cil 2000 also show through experimental and analytical solutions that imbibition declines exponentially during late time periods for naturally fractured porous media in our experimental setting the deviation from semi infinite scaling during fracture matrix flows occurs when the imbibition front reaches the peripheral boundary of the core at about 23 h see fig 3b boundaries act as flow barriers to inhibit greatly the progress of the imbibition process for fracture flows imbibition is pressure driven i e forced and we obtain an apparent imbibition rate that declines inversely with time consistent with darcy s law solid line fig 5 d fig s3 shows that breakthrough of water to the outlet occurred in less than 0 1 h and that the water saturation in the fractures at the core inlet stabilized in less than 4 1 h steady saturation in the fractures emerged in roughly 23 h accordingly the imbibition rate in fractures evolves quickly after breakthrough steady water saturation in the fractures is reached at 20 to 25 h and the rate transitions to 0 we attribute the behavior after about 20 h in fig 5 d to noise that oscillates around 0 and decreases in time we initially expected that the fracture imbibition rate would scale as t 1 2 because the injection rate is constant and fractures transfer wetting fluid to the matrix at a rate that initially scales as t 1 2 completion of imbibition in fractures requires about a tenth of the time needed in the matrix leading to few data points to describe imbibition behavior in fractures the order of magnitude difference in time to completion of imbibition in fractures compared to matrix thereby leads to poor resolution of the fracture imbibition rate with respect to time this observation may account for the fracture imbibition rate appearing to be proportional to 1 t until the fracture is filled with water additionally rangel german and kovscek 2002 show that multidimensional imbibition as well as imbibition occurring through combined forced and spontaneous processes yields complex time scaling deviating from classical t 1 2 results hence additional studies are recommended taken together these results provide direct quantitative observations that reveal mixed imbibition phenomena in multiscale fractured rock cores capillary driven imbibition occurs within the microscopic pore spaces and macroscopic forced imbibition is driven by the applied pressure gradient in the fracture apertures 5 conclusion imbibition spontaneous or forced is fundamental to fluid flow processes in porous media this study unveils the dynamics of mixed imbibition processes in a complex heterogeneous naturally fractured nanoporous medium initially saturated with co 2 using nondestructive x ray ct imaging spontaneous imbibition and corresponding square root of time scaling is found at early time in shale matrix with a transition to nearly exponential decrease in imbibition rate as the brine contacts flow boundaries at later times the fractures display pressure driven forced imbibition the time lapse ct images during imbibition expose the prevalence of cracks that exist below imaging resolution the identified micro cracks contribute significantly to the heterogenization and acceleration of the spatial extent of imbibition fronts substantial nonwetting phase is trapped during imbibition in this unconventional sample with a final gas saturation of 48 characterization of dynamic multiscale transport physics is essential to realizing the potential of subsurface energy and storage formation resources such characterization is achieved here in macroscopic sized samples of natural nanoporous media the distinction among mixed imbibition processes at various length and temporal scales is relevant to co 2 storage reinjection of spent geothermal fluids and stimulation of unconventional low permeability formations to increase heat and or natural gas recovery credit authorship contribution statement takeshi kurotori conceptualization methodology software formal analysis investigation writing original draft writing review editing manju pharkavi murugesu conceptualization methodology data curation formal analysis investigation writing original draft writing review editing christopher zahasky conceptualization methodology investigation writing original draft writing review editing bolivia vega conceptualization methodology investigation writing original draft jennifer l druhan conceptualization methodology investigation writing original draft writing review editing sally m benson conceptualization methodology supervision anthony r kovscek conceptualization methodology supervision writing original draft writing review editing project administration funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work was supported as part of the center for mechanistic control of unconventional formations cmc uf an energy frontier research center funded by the u s department of energy office of science under doe bes award de sc0019165 μ ct imaging was performed at the stanford nano shared facilities snsf supported by the national science foundation under award eccs 2026822 we thank hasan khan for the insightful discussions appendix a supplementary data supplementary material related to this article can be found online at https doi org 10 1016 j advwatres 2023 104429 appendix a supplementary data the following is the supplementary material related to this article s1 supplementary raw research data and analysis 
