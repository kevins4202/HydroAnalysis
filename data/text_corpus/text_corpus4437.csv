index,text
22185,flow induced motion fim is an important issue for deep draft floating platforms reducing the fatigue life of mooring and riser systems tension leg platforms tlps with a smaller mass ratio m r the ratio of the platform mass to the displacement may experience more pronounced fim responses in current to investigate the fim behavior of tlps in towing tests this research adopts an air bearing system mainly composed of low friction air bearings and a smooth flat plate to accurately simulate the mass ratio the results demonstrated that in the range of 0 64 m r 0 90 the transverse amplitudes did not decrease with an increase in the mass ratio because the scruton number s c did not exceed 0 1 through model tests the effect of appendages on the fim of tlps was also examined the results of the screening tests from 0 to 360 with an interval of 22 5 indicated that the transverse response is characterized by symmetry with a cycle of 90 while the yaw motion exhibits asymmetry owing to the effect of appendages the largest transverse amplitude was obtained at 90 with a value of a y d 0 408 occurring at u r 7 in comparison with the bare hull platform the transverse amplitude of the tlp with appendages significantly decreased by approximately 82 in the range of 6 u r 8 at 45 overall these substantial results are expected to improve the understanding of the fim characteristics of tlps and to provide benchmark data for design and numerical prediction as well keywords flow induced motion experimental study tension leg platform mass ratio appendages current incidence 1 introduction a bluff body exposed to a current generates a fluctuating pressure difference behind it owing to eddies or vortexes that are alternatively formed and shed on both sides for large multicolumn floating moored structures this behavior induces a phenomenon called flow induced motion fim when the vortex shedding frequency coincides with the structural response frequency a phenomenon referred to as lock in occurs fim has been a hot topic in the academic and engineering fields because it may reduce the fatigue life of mooring and riser systems and even severely affect the safety of a platform as reported by sagrilo et al 2009 the large fim may induce low frequency stress variations in steel catenary risers scrs this could account for the fatigue damage to risers of monocolumn platforms magee et al 2003 cueva et al 2006 and irani et al 2008 also pointed out the damage of fim to the riser and mooring systems of spars a similar phenomenon was observed in multicolumn platforms waals et al 2007 first discovered that multicolumn platforms generate fim from model tests and indicated that it may affect the global analysis of mooring and riser systems later as described in rijken and leverette 2008 the fim of a deep draft semisubmersible may affect the fatigue life of mooring and riser systems in addition the fatigue damage to mooring and riser systems can be directly related to the major axis response amplitude distribution as reported in zou et al 2014 in some cases this can account for up to 90 of the predicted scr fatigue damage extensive research studies have been accomplished to explore fim characteristics by carrying out model tests and numerical simulations these showed that fim behavior depends on many factors including current incidences appendages and mass ratios specific to tension leg platforms tlps gonçalves et al 2012b experimentally studied the effects of current incidences and hull appendages on the fim characteristics of four square columns in model tests hull appendages were composed of riser supports located at the pontoons fairleads and mooring stretches located vertically at the external column faces and hard pipes located vertically at the internal column faces eight current incidences including 0 15 30 45 180 195 210 and 225 were taken into consideration this showed that the largest transverse amplitudes were about 40 of the column width for current incidences of 30 and 45 in addition the hull appendages located at columns had the greatest influence on the fim response of the semisubmersible rosetti et al 2016 compared the fim responses of two semisubmersibles at current incidences of 0 and 45 using cfd simulations it was confirmed that the 0 current incidence resulted in larger motions than the 45 current incidence case for the semisubmersible with circular cylinders in contrast to the fim behavior of the semisubmersible with square columns gonçalves et al 2018a experimentally validated the above conclusions and demonstrated that a lock in region of transverse motion could be well defined for models with square and circular columns at all incidence angles except for the model with square columns at 0 on the other hand the yaw motions presented a precise lock in range only for the model with circular columns at 22 5 and 45 in addition research studies about the effect of appendages are also referred initially the appendages were mainly employed in spars the most typical appendages are helical strakes wang et al 2009 holmes 2008 and lefevre et al 2013 all demonstrated that the fim responses were reduced significantly for spars with helical strakes gonçalves et al 2010 performed model tests to check the influence of many factors on fim including suppression elements such as spoiler plates the spoiler plates did not perform as well as expected in suppressing fim on the monocolumn platform the authors recognized that more detailed study concerning the placement geometry of the plates may be needed later gonçalves et al 2012a adopted a new analysis methodology hilbert huang transform hht method to obtain more reliable results than those of traditional methods when investigating fim for multicolumn floating platforms xu 2011 and xu et al 2012 proposed a method to increase the projection of the columns to disturb the continuity of vortex shedding in the direction of expansion tan et al 2014 concluded that the fim responses of tlp without appendages exhibited higher responses and more fim like behaviors in comparison with those of the tlp with appendages a comparative experimental study was conducted to identify the differences in fim response under the absence and presence of hull appendages by rijken et al 2011 the results revealed that an increased amount of detail on the hull especially in the vertical faces of the hull likely contributed to the smaller fim responses however these tests were only performed at several current incidences and did not completely cover current incidences from 0 to 360 the mass ratio m r is an important parameter that influences the fim response and is defined as the ratio of the platform mass m to the displacement δ 1 m r m δ for semisubmersibles the mass ratio is close to unity in general while it is less than unity for tlps waals et al 2007 experimentally investigated the influence of mass ratios on fim responses between different platforms with square columns by conducting towing tests the results revealed that a lower mass ratio of the tlp results in a higher maximum response at a wider reduced velocity range in addition the authors considered that the effect of the mass ratio on floating structures is consistent with that of vortex induced vibration viv on risers such as in reports by vandiver 1993 khalak and williamson 1999 and bahmani and akbari 2010 published later in recent years some studies related to the influence of mass ratios of multicolumn platforms were completed rijken 2014 examined the effect of the mass ratio of a semisubmersible through cfd analyses in a 2d environment the sway responses of a semisubmersible were presented for mass ratios of 1 5 and 0 8 the results showed nearly identical responses under these two mass ratios the authors considered that this was because the scruton number s c π 2 m r ζ did not exceed 0 1 where ζ represents the damping ratio by contrast the reduction of fim amplitudes was achieved by increasing the mass ratio in williamson and govardhan 2004 where the scruton number s c was higher than 0 1 maximiano et al 2016 pointed out the tested mass ratios m r 0 86 1 05 and 1 10 showed a slight impact on the fim response of the semisubmersibles with a variation almost below 5 compared with those of semisubmersibles only several experimental studies investigated the fim of tlps kou et al 2016 conducted towing tests with respect to the fim behaviors of a tlp with appendages including anodes tendon porches and other pipelike structures attached to the hull gonçalves et al 2018b experimentally investigated the effect of the spacing ratio on fim responses for three different arrays of four floating cylinders in a towing tank in the case of the tlp the accurate simulation and adjustment of vertical loads arising from tendons and top tensioned rises ttrs are crucial in the model test in addition for platforms servicing in a real sea state they are covered with various appendages on the surfaces of the columns and pontoons such as anodes a variety of pipes and tendon porches hence it is necessary to adopt a tlp with appendages in the model test to reveal the real motion in this study a low friction air bearing system was developed to accurately simulate the mass ratio of tlps and a model with detailed appendages was employed in a towing test to examine the fim behavior in previous studies only investigations of fim behavior at specific current incidences were conducted nevertheless in consideration of the asymmetry of the appendages screening tests from 0 to 360 with an interval of 22 5 were conducted to comprehensively recognize the characteristics of fim for tlps then specific current incidences were selected to investigate the effects of appendages and mass ratios on the fim of tlps 2 experimental program experimental tests were conducted in a towing tank with a length of 130 0 m breadth of 6 0 m and depth of 3 0 m a towing tank can provide steady uniform velocity inlet conditions avoiding the unexpected impact of current turbulence 2 1 tlp model the tlp model was built accurately with regard to its geometry including appendages such as anodes tendon porches fenders supports caissons and other pipelike structures running on the hull to investigate the effect of the appendages a bare hull model was also built the two tlp models are depicted in fig 1 with the same particulars as presented in table 1 the model scale is 1 50 2 2 model test setup an important parameter the mass ratio m r must be accurately simulated in the model test an air bearing system was employed to achieve this goal considering that the fim behavior is mainly under the action of currents the superstructure has little impact and thus an aluminum deck with sufficient strength was fabricated to support the air bearing system the air bearing system was composed of three low friction air bearings sliding along a smooth flat plate supported by a towing carriage a smooth plate can guarantee that the model moves freely in the horizontal plane while vertical motions are restricted the model test setup is illustrated in fig 2 to model the required mass ratios the vertical pretension was applied by pushing the model into the water without restricting horizontal motions in the process of altering the mass ratio the mass of the platform was correspondingly changed while the drafts remained the same i e the vertical loads acting on the air bearing system were adjusted to ensure that the air bearing system did not cause extra damping on the entire system free decay tests without the tlp model in the inline and transverse directions were performed in air unlike the arrangement in the towing tank the smooth horizontal plate and the air bearings were placed upside down as depicted in fig 3 the loads acting on the air bearing system were approximately equal to the vertical force of the tlp thus the damping induced from the air bearing system was nearly the same in the air decay test and in the towing test the decay results of the inline and transverse motion accelerations measured in the air are presented in fig 4 the results demonstrate that the damping coefficients in the inline and transverse directions were measured to be approximately 0 6 and 0 3 of the critical damping respectively indicating that the low friction influence was sufficiently small owing to the air bearing system and the smooth flat plate a horizontal mooring system with four springs was applied to represent the horizontal restoring forces arising from tendons and ttrs in actual tlp platforms this provided the restoring force and matched the natural period of the system in the horizontal plane one end of each horizontal line with a load cell was fixed on the carriage and the other end was fixed on the deck of the model the o xy coordinate system was earth fixed a number of angles of current incidence were considered in the experiment and the rotation of the model represented the change in the current incidence a schematic diagram of the horizontal mooring system at different current incidences is depicted in fig 5 the angle between each horizontal mooring line and horizontal axes was 45 the stiffness of each spring was 54 283 n m and each pretension was 68 670 n the fairlead of each spring was a circle with a radius of 0 526 m and the anode of each spring was a circle with a radius of 2 871 m in addition the total stiffness in the transverse direction k y and the total stiffness in the inline direction k x were both 174 443 n m fig 6 depicts the definition of the incidence angles α 2 3 test program prior to the fim tests static offset tests and free decay tests in calm water were conducted to check the experimental setup and the entire system the natural periods of the transverse motion and the yaw were primary targets table 2 presents the natural periods of the tlp with and without appendages one of the most significant parameters in the fim tests was the reduced velocity u r commonly defined as 2 u r u t n d where u represents the current velocity replaced by the towing speed in the model test t n represents the natural period of the transverse motion as shown in table 2 and d is the diameter of the column the model test conditions are presented in table 3 first screening tests were performed for current incidences from 0 to 360 with an interval of 22 5 at u r 6 8 critical current incidences were selected to cover the range of 4 u r 12 at 90 100 337 5 and 347 5 the cases at current incidences of 90 337 5 and 45 were conducted to investigate the effect of appendages on the tlp considering the sensitivity study of another representative parameter m r the cases at current incidences of 0 and 45 were performed for the tlp without appendages the towing speed ranged from 0 834 m s to 0 420 m s in the model tests correspondingly the reynolds number was below 3 1 0 5 therefore the uncertainties associated with the transitional flow were avoided the sampling frequency was 25 hz to obtain reliable fim responses the data records were truncated when the towing speed was initially accelerating and finally decelerating then the data records containing 10 15 periods were chosen to analyze the fim statistics 2 4 data analysis the nominal amplitudes of the transverse motion and the yaw motion are defined as 3 a y d n o m i n a l 2 s t d d e v a y d 4 a y a w n o m i n a l 2 s t d d e v a y a w where a y and a y a w denote the amplitudes of the transverse motion and the yaw motion respectively the total hydrodynamic forces including the drag force in the inline direction and the lift force in the transverse direction can be derived from the following motion equations which are also employed in sarpkaya 2004 5 m x t c x t k x x t f x t 6 m y t c y t k y y t f y t where c is the structural damping coefficient and k x and k y represent the linear spring constants in the inline and transverse directions respectively the second term of the equation can be disregarded owing to its small magnitude compared with the others as described by gonçalves et al 2012b therefore the total hydrodynamic forces are the summation of the inertial the first term of the equation and restoring forces the last term of the equation in general the hydrodynamic forces are represented by the force coefficients including the drag force coefficient and the lift force coefficient they are defined as 7 c d t f x t 1 2 ρ a p u 2 8 c l t f y t 1 2 ρ a p u 2 where ρ is the fluid density and a p is the submerged projected area of the model as presented in table 2 to better understand the fim characteristics the average drag force coefficient c d and the root mean square rms value of the lift coefficient c l r m s are discussed 3 experimental results and discussions 3 1 effect of appendages floating platforms serving in the exploitation of offshore oil and gas are covered with various appurtenances which are often asymmetrically collected based on their respective functional requirements therefore screening tests from 0 to 360 with an interval of 22 5 were performed to comprehensively understand the fim characteristics of the tlp m r 0 64 with appendages at different current incidences fig 7 presents the results of the nominal amplitudes of the transverse motion and yaw responses measured in the screening tests at critical reduced velocities u r 6 8 in which range the peak values are often obtained according to previous studies by waals et al 2007 and martin and rijken 2012 although the maximum amplitudes were obtained at different reduced velocities for different current incidences it can be obviously seen that for all current incidences the larger transverse amplitudes occurred at 0 90 180 and 270 overall it can be clearly seen that 90 is a cycle starting from 0 to 360 in addition considerable transverse amplitudes were observed at 22 5 67 5 112 5 247 5 and 337 5 it appears that 45 is a cycle from 22 5 to 337 5 except for 157 5 202 5 and 292 5 this occurs owing to the asymmetry of the appendages by contrast small transverse amplitudes with values lower than 0 2 were obtained at 45 135 225 and 315 this also showed a symmetry with a circle of 90 overall the transverse amplitudes presented a symmetry that was generally related to the current incidences and the effect of the asymmetry of the appendages was slight it can be seen from fig 7 b that the yaw amplitudes increased with reduced velocity at all current incidences with the values not exceeding 3 in the range of 6 u r 8 different from the responses in the transverse direction the yaw amplitudes exhibited asymmetry for different current incidences the variant moments owing to the asymmetry appendages was responsible for this result based on the results from the screening tests the two most critical current incidences 90 and 337 5 and their respective 10 were selected to examine the sensitivity of the current incidence to the fim response of the tlp transverse amplitudes in the range of 4 u r 12 at 90 100 337 5 and 347 5 are depicted in fig 8 a it is clear that the maximum nominal transverse amplitude was a y d 0 408 which occurred at u r 7 at a current incidence of 90 the largest transverse amplitudes were nearly identical for current incidences of 337 5 and 347 5 with the value of a y d 0 36 at u r 7 overall the peak values were obtained in the range of 6 u r 8 which is called the lock in scenario this is similar to that of semisubmersibles as depicted by liu et al 2017 in the pre lock in range the transverse amplitudes increased with reduced velocities by contrast the transverse amplitudes decreased with reduced velocities in the post lock in range fig 8 b presents the yaw amplitudes at critical current incidences the largest yaw amplitude was obtained at u r 12 with the value of a y a w 5 11 4 at the current incidence of 100 the trends and values of yaw amplitudes with reduced velocities at 90 and 100 were similar i e the yaw amplitudes increased with reduced velocities for the other two current incidences the largest yaw amplitude was a y a w 3 37 1 and occurred at u r 11 for 347 5 these considerable responses at 90 100 and 347 5 could be identified waals et al 2007 and gonçalves et al 2012b also identified considerable yaw motions in their experiments however the presence of the galloping phenomenon could not be confirmed for reduced velocities of lower than 14 in the present tests there was a comparative difference in that the yaw amplitudes decreased drastically when the reduced velocity was higher than 10 at 337 5 with a peak value of a y a w 1 96 4 these results confirm the presence of a synchronization regime of the yaw this occurs when the vortex shedding frequency is close to the natural frequency of the yaw motion it is important to highlight that the largest amplitudes of yaw motion occurred at a higher reduced velocity than that for the peak value of the transverse amplitudes owing to the smaller natural period of the yaw motion to investigate the effect of appendages on the fim behaviors of tlps the nominal transverse amplitudes of tlps m r 0 64 with and without appendages for typical current incidences i e 90 337 5 and 45 are depicted in fig 9 compared with the transverse amplitudes of the bare hull shown in fig 9 a it can be seen that the transverse amplitudes of the tlp with appendages decreased significantly in the range of 6 u r 8 at the current incidence of 45 with a maximum reduction of approximately 82 this is because the vortex shedding was destroyed owing to the existence of the appurtenance by contrast a small decrease of 15 was obtained when the largest transverse amplitude occurred at the current incidence of 337 5 at the current incidence of 90 the transverse amplitudes of the tlp with appendages were larger than those of the bare hull when 7 u r 11 likely the appendages generated a larger fluctuating lift force at 90 when the reduced velocities were higher than 11 the transverse amplitudes increased as well waals et al 2007 mentioned that for high reduced velocities the galloping phenomenon may occur possibly however this behavior was not confirmed until u r 14 herein galloping is different from viv and vim which are low frequency responses the vortex shedding frequency was much higher than the structural response frequency in addition the displacement was in phase with the velocity for the galloping behavior as described in gonçalves et al 2012b however the galloping phenomenon was not observed in the present study owing to smaller reduced velocities the galloping behavior will be investigated numerically in the future fig 9 b depicts the yaw amplitudes of the tlp with and without appendages at 90 337 5 and 45 it can be seen that for the bare hull a clear lock in range of the yaw motions was obtained i e 8 u r 12 this lags behind that of the transverse motions as a result of a smaller natural period of the yaw motions an increase in the yaw responses was obviously found at 337 5 with the absence of the appendages especially in the lock in range which reached 37 at u r 11 however the existence of appendages had a slight effect on the yaw amplitudes at 90 the rms of the lift force coefficient and average drag force coefficient for the tlp with and without appendages are shown in fig 10 a and fig 10 b respectively in general the curve tendency of the rms of the lift force coefficient was consistent with that of the transverse amplitudes which implies that the transverse motions were induced by the fluctuating lift forces furthermore the rms of the lift force coefficient of the platform with appendages was smaller than that of the bare hull at all current incidences especially at 45 the rms of the lift force coefficient decreased by around 54 in the range of the lock in the reduction also reached 27 at 90 for the average drag force coefficient c d the values for the tlp with appendages were larger than those of the tlp without appendages at all current incidences the maximum increase was around 28 at u r 6 for 337 5 in general the curves presented a stable tendency at high reduced velocities while an obvious increase was observed in the lock in range owing to the significant motion figs 11 and 12 show the time history and spectral analysis of the transverse motion and lift force coefficient for the tlp with and without appendages respectively it can be observed that the curve tendencies of the transverse motion were accordant with those of the lift force coefficient further proving that the transverse motion was induced by the lift force additionally it can be seen that in fig 12 b and c for 6 u r 8 both the transverse motion and the lift force coefficient presented a characteristic periodicity and an identical dominant frequency moreover the frequency of the transverse motion was close to the natural frequency which demonstrates the resonance of the transverse motion in this reduced velocity range in the pre lock in range corresponding to a region before synchronization in the transverse direction i e fig 12 a the transverse motions and the lift force coefficient did not show periodic features and no obvious dominant frequency was observed in addition fig 12 d shows the range after the lock in scenario this is called the post lock in range similarly no single dominant frequency of the transverse response or lift force coefficient occurred in fig 11 b and c a frequency close to the natural frequency was observed similar to that of the bare hull in the post lock in range the response frequency in the transverse direction was higher than the natural frequency while no well defined oscillation frequency was obtained for the lift force coefficient examples of spectral analyses for the yaw motion of the tlp with and without appendages at 90 are depicted in figs 13 and 14 in comparison with the responses in the transverse direction the yaw responses were irregular in the range of 4 u r 8 for the tlp with and without appendages at u r 12 for the tlp with appendages a dominant frequency could be defined close to the natural frequency of the yaw motion which corroborates the resonance behavior of the yaw motion for the tlp without appendages there was no obvious dominant frequency corresponding to the smaller yaw responses at u r 12 3 2 effect of mass ratio a bare hull was employed to examine the effect of mass ratios on the fim of the tlp fig 15 presents the nominal transverse amplitudes of the tlp at current incidences of 0 and 45 for different mass ratios m r 0 64 0 80 and 0 90 it can be clearly seen that the largest transverse amplitude occurred at 0 for each mass ratio the transverse amplitudes for the three mass ratios were rather similar in trend and attained their peak values in the same range 6 u r 8 this confirms that the resonance occurred for all three mass ratios this was regarded as the lock in scenario for m r 0 80 the peak value of a y d 0 45 occurred at 0 for m r 0 64 and m r 0 9 the largest transverse responses were both around a y d 0 40 with a decrease of approximately 10 from that of m r 0 80 for 45 the most significant transverse motions attained a peak value of approximately a y d 0 30 similarly the transverse amplitudes did not decrease with an increase in the mass ratios the literature indicates that a higher mass ratio may reduce the fim response however in this research the reduction of transverse amplitudes was not realized with an increase in the mass ratios which is similar to that observed in rijken 2014 this is probably because the scruton number did not exceed 0 1 because the damping ratio was on the order of 0 2 1 in addition uncertainties in the experiments may be responsible as well figs 12 16 and 17 depict the time history and spectral analysis of the transverse motion and lift force coefficient at three mass ratios m r 0 64 0 80 and 0 90 respectively it is essential to highlight that for the tlp without appendages the current incidence of 90 was equal to 0 almost identical curves were obtained for these mass ratios in the lock in range the motion amplitudes exhibited periodicity characteristics which were similar to those of the lift force coefficient curves the dominant frequency was close to the natural frequency of the transverse motion confirming the occurrence of the resonance behavior for the tlp at these mass ratios however in the post lock in range the curve tendencies of the transverse motion were inconsistent with those of the lift force coefficient implying that the transverse motion was probably affected by other modes of motion fig 18 shows the yaw amplitudes of the tlp at 0 and 45 for different mass ratios m r 0 64 0 80 and 0 90 respectively all the mass ratios reached their peak values in the same range 8 u r 12 with nearly identical values of a y a w 4 5 at two current incidences this confirms the resonance of the yaw motions of the tlp for different mass ratios owing to smaller natural periods of the yaw motions than those of the transverse motions the range of resonance was logically delayed it is also worth noting that for m r 0 80 the yaw response was most significant at 0 while the peak value was lowest at 45 figs 14 19 and 20 show the spectral analysis of the yaw motions at three mass ratios m r 0 64 0 80 and 0 90 at 0 respectively at u r 4 93 a dominant frequency around the respective natural frequency of the yaw motion f n y a w was observed both for m r 0 80 and 0 90 which contributes to larger responses than those of u r 6 for 6 u r 8 no obvious dominant frequency was obtained corresponding to lower responses in this range however at approximately u r 12 there was a dominant frequency close to the respective natural frequency of the yaw motion for all of the mass ratios this confirms the resonance behavior of the yaw motion at these mass ratios which occurred at higher reduced velocities than that of the transverse motion the motion trajectories at the current incidence of 0 for the three mass ratios are depicted in fig 21 it can be seen that the motion trajectories were similar in tendency at corresponding reduced velocities for all the mass ratios in the lock in range the motion trajectories presented a linear type with large spans this was different from those of the spars which exhibited motion trajectories as eight shaped as described in rosetti et al 2009 and fujarra et al 2009 in the pre lock in range the motions were limited and exhibited a small magnitude however the motion trajectories became chaotic covering a wider range of motion in the inline direction in the post lock in range 4 conclusions effects of appendages and mass ratios on the fim of tlps were investigated experimentally an air bearing system composed of low friction air bearings and a smooth flat plate were developed to model mass ratios lower than 1 0 without affecting the horizontal motions the results of screening tests from 0 to 360 with an interval of 22 5 indicated that the transverse motion is characterized by symmetry for a cycle of 90 while the yaw motion exhibits an asymmetry owing to the effect of the appendages the maximum transverse amplitude was observed at 90 with a value of a y d 0 408 at u r 7 in comparison with a bare hull the transverse amplitude of a tlp with appendages significantly decreased by approximately 82 in the range of 6 u r 8 at 45 in this range the frequency of the transverse motion was close to the natural frequency confirming that resonance occurred i e a lock in scenario was produced the effect of the mass ratio m r 0 64 0 80 and 0 90 on the fim of tlps without appendages was also investigated at 0 and 45 regardless of the mass ratio the largest transverse amplitude was obtained at 0 and lock in scenarios were observed however it was observed that the transverse motions did not decrease with an increase in the mass ratios because the scruton number did not exceed 0 1 this can be attributed to the uncertainties in the experimental tests motion trajectories demonstrated that linear shapes with large spans were exhibited in the lock in range whereas in the post lock in range the motion trajectories were chaotic overall this study provided a series of referable test results for evaluating the fim response of tlps declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the authors acknowledge the support of the national natural science foundation of china grant no 51909158 the support of the subproject of the important national science technology specific projects 2016zx05028 002 004 ministry of industry and information technology of china project no 2016 23 and open foundation of state key laboratory of ocean engineering project no 1808 
22185,flow induced motion fim is an important issue for deep draft floating platforms reducing the fatigue life of mooring and riser systems tension leg platforms tlps with a smaller mass ratio m r the ratio of the platform mass to the displacement may experience more pronounced fim responses in current to investigate the fim behavior of tlps in towing tests this research adopts an air bearing system mainly composed of low friction air bearings and a smooth flat plate to accurately simulate the mass ratio the results demonstrated that in the range of 0 64 m r 0 90 the transverse amplitudes did not decrease with an increase in the mass ratio because the scruton number s c did not exceed 0 1 through model tests the effect of appendages on the fim of tlps was also examined the results of the screening tests from 0 to 360 with an interval of 22 5 indicated that the transverse response is characterized by symmetry with a cycle of 90 while the yaw motion exhibits asymmetry owing to the effect of appendages the largest transverse amplitude was obtained at 90 with a value of a y d 0 408 occurring at u r 7 in comparison with the bare hull platform the transverse amplitude of the tlp with appendages significantly decreased by approximately 82 in the range of 6 u r 8 at 45 overall these substantial results are expected to improve the understanding of the fim characteristics of tlps and to provide benchmark data for design and numerical prediction as well keywords flow induced motion experimental study tension leg platform mass ratio appendages current incidence 1 introduction a bluff body exposed to a current generates a fluctuating pressure difference behind it owing to eddies or vortexes that are alternatively formed and shed on both sides for large multicolumn floating moored structures this behavior induces a phenomenon called flow induced motion fim when the vortex shedding frequency coincides with the structural response frequency a phenomenon referred to as lock in occurs fim has been a hot topic in the academic and engineering fields because it may reduce the fatigue life of mooring and riser systems and even severely affect the safety of a platform as reported by sagrilo et al 2009 the large fim may induce low frequency stress variations in steel catenary risers scrs this could account for the fatigue damage to risers of monocolumn platforms magee et al 2003 cueva et al 2006 and irani et al 2008 also pointed out the damage of fim to the riser and mooring systems of spars a similar phenomenon was observed in multicolumn platforms waals et al 2007 first discovered that multicolumn platforms generate fim from model tests and indicated that it may affect the global analysis of mooring and riser systems later as described in rijken and leverette 2008 the fim of a deep draft semisubmersible may affect the fatigue life of mooring and riser systems in addition the fatigue damage to mooring and riser systems can be directly related to the major axis response amplitude distribution as reported in zou et al 2014 in some cases this can account for up to 90 of the predicted scr fatigue damage extensive research studies have been accomplished to explore fim characteristics by carrying out model tests and numerical simulations these showed that fim behavior depends on many factors including current incidences appendages and mass ratios specific to tension leg platforms tlps gonçalves et al 2012b experimentally studied the effects of current incidences and hull appendages on the fim characteristics of four square columns in model tests hull appendages were composed of riser supports located at the pontoons fairleads and mooring stretches located vertically at the external column faces and hard pipes located vertically at the internal column faces eight current incidences including 0 15 30 45 180 195 210 and 225 were taken into consideration this showed that the largest transverse amplitudes were about 40 of the column width for current incidences of 30 and 45 in addition the hull appendages located at columns had the greatest influence on the fim response of the semisubmersible rosetti et al 2016 compared the fim responses of two semisubmersibles at current incidences of 0 and 45 using cfd simulations it was confirmed that the 0 current incidence resulted in larger motions than the 45 current incidence case for the semisubmersible with circular cylinders in contrast to the fim behavior of the semisubmersible with square columns gonçalves et al 2018a experimentally validated the above conclusions and demonstrated that a lock in region of transverse motion could be well defined for models with square and circular columns at all incidence angles except for the model with square columns at 0 on the other hand the yaw motions presented a precise lock in range only for the model with circular columns at 22 5 and 45 in addition research studies about the effect of appendages are also referred initially the appendages were mainly employed in spars the most typical appendages are helical strakes wang et al 2009 holmes 2008 and lefevre et al 2013 all demonstrated that the fim responses were reduced significantly for spars with helical strakes gonçalves et al 2010 performed model tests to check the influence of many factors on fim including suppression elements such as spoiler plates the spoiler plates did not perform as well as expected in suppressing fim on the monocolumn platform the authors recognized that more detailed study concerning the placement geometry of the plates may be needed later gonçalves et al 2012a adopted a new analysis methodology hilbert huang transform hht method to obtain more reliable results than those of traditional methods when investigating fim for multicolumn floating platforms xu 2011 and xu et al 2012 proposed a method to increase the projection of the columns to disturb the continuity of vortex shedding in the direction of expansion tan et al 2014 concluded that the fim responses of tlp without appendages exhibited higher responses and more fim like behaviors in comparison with those of the tlp with appendages a comparative experimental study was conducted to identify the differences in fim response under the absence and presence of hull appendages by rijken et al 2011 the results revealed that an increased amount of detail on the hull especially in the vertical faces of the hull likely contributed to the smaller fim responses however these tests were only performed at several current incidences and did not completely cover current incidences from 0 to 360 the mass ratio m r is an important parameter that influences the fim response and is defined as the ratio of the platform mass m to the displacement δ 1 m r m δ for semisubmersibles the mass ratio is close to unity in general while it is less than unity for tlps waals et al 2007 experimentally investigated the influence of mass ratios on fim responses between different platforms with square columns by conducting towing tests the results revealed that a lower mass ratio of the tlp results in a higher maximum response at a wider reduced velocity range in addition the authors considered that the effect of the mass ratio on floating structures is consistent with that of vortex induced vibration viv on risers such as in reports by vandiver 1993 khalak and williamson 1999 and bahmani and akbari 2010 published later in recent years some studies related to the influence of mass ratios of multicolumn platforms were completed rijken 2014 examined the effect of the mass ratio of a semisubmersible through cfd analyses in a 2d environment the sway responses of a semisubmersible were presented for mass ratios of 1 5 and 0 8 the results showed nearly identical responses under these two mass ratios the authors considered that this was because the scruton number s c π 2 m r ζ did not exceed 0 1 where ζ represents the damping ratio by contrast the reduction of fim amplitudes was achieved by increasing the mass ratio in williamson and govardhan 2004 where the scruton number s c was higher than 0 1 maximiano et al 2016 pointed out the tested mass ratios m r 0 86 1 05 and 1 10 showed a slight impact on the fim response of the semisubmersibles with a variation almost below 5 compared with those of semisubmersibles only several experimental studies investigated the fim of tlps kou et al 2016 conducted towing tests with respect to the fim behaviors of a tlp with appendages including anodes tendon porches and other pipelike structures attached to the hull gonçalves et al 2018b experimentally investigated the effect of the spacing ratio on fim responses for three different arrays of four floating cylinders in a towing tank in the case of the tlp the accurate simulation and adjustment of vertical loads arising from tendons and top tensioned rises ttrs are crucial in the model test in addition for platforms servicing in a real sea state they are covered with various appendages on the surfaces of the columns and pontoons such as anodes a variety of pipes and tendon porches hence it is necessary to adopt a tlp with appendages in the model test to reveal the real motion in this study a low friction air bearing system was developed to accurately simulate the mass ratio of tlps and a model with detailed appendages was employed in a towing test to examine the fim behavior in previous studies only investigations of fim behavior at specific current incidences were conducted nevertheless in consideration of the asymmetry of the appendages screening tests from 0 to 360 with an interval of 22 5 were conducted to comprehensively recognize the characteristics of fim for tlps then specific current incidences were selected to investigate the effects of appendages and mass ratios on the fim of tlps 2 experimental program experimental tests were conducted in a towing tank with a length of 130 0 m breadth of 6 0 m and depth of 3 0 m a towing tank can provide steady uniform velocity inlet conditions avoiding the unexpected impact of current turbulence 2 1 tlp model the tlp model was built accurately with regard to its geometry including appendages such as anodes tendon porches fenders supports caissons and other pipelike structures running on the hull to investigate the effect of the appendages a bare hull model was also built the two tlp models are depicted in fig 1 with the same particulars as presented in table 1 the model scale is 1 50 2 2 model test setup an important parameter the mass ratio m r must be accurately simulated in the model test an air bearing system was employed to achieve this goal considering that the fim behavior is mainly under the action of currents the superstructure has little impact and thus an aluminum deck with sufficient strength was fabricated to support the air bearing system the air bearing system was composed of three low friction air bearings sliding along a smooth flat plate supported by a towing carriage a smooth plate can guarantee that the model moves freely in the horizontal plane while vertical motions are restricted the model test setup is illustrated in fig 2 to model the required mass ratios the vertical pretension was applied by pushing the model into the water without restricting horizontal motions in the process of altering the mass ratio the mass of the platform was correspondingly changed while the drafts remained the same i e the vertical loads acting on the air bearing system were adjusted to ensure that the air bearing system did not cause extra damping on the entire system free decay tests without the tlp model in the inline and transverse directions were performed in air unlike the arrangement in the towing tank the smooth horizontal plate and the air bearings were placed upside down as depicted in fig 3 the loads acting on the air bearing system were approximately equal to the vertical force of the tlp thus the damping induced from the air bearing system was nearly the same in the air decay test and in the towing test the decay results of the inline and transverse motion accelerations measured in the air are presented in fig 4 the results demonstrate that the damping coefficients in the inline and transverse directions were measured to be approximately 0 6 and 0 3 of the critical damping respectively indicating that the low friction influence was sufficiently small owing to the air bearing system and the smooth flat plate a horizontal mooring system with four springs was applied to represent the horizontal restoring forces arising from tendons and ttrs in actual tlp platforms this provided the restoring force and matched the natural period of the system in the horizontal plane one end of each horizontal line with a load cell was fixed on the carriage and the other end was fixed on the deck of the model the o xy coordinate system was earth fixed a number of angles of current incidence were considered in the experiment and the rotation of the model represented the change in the current incidence a schematic diagram of the horizontal mooring system at different current incidences is depicted in fig 5 the angle between each horizontal mooring line and horizontal axes was 45 the stiffness of each spring was 54 283 n m and each pretension was 68 670 n the fairlead of each spring was a circle with a radius of 0 526 m and the anode of each spring was a circle with a radius of 2 871 m in addition the total stiffness in the transverse direction k y and the total stiffness in the inline direction k x were both 174 443 n m fig 6 depicts the definition of the incidence angles α 2 3 test program prior to the fim tests static offset tests and free decay tests in calm water were conducted to check the experimental setup and the entire system the natural periods of the transverse motion and the yaw were primary targets table 2 presents the natural periods of the tlp with and without appendages one of the most significant parameters in the fim tests was the reduced velocity u r commonly defined as 2 u r u t n d where u represents the current velocity replaced by the towing speed in the model test t n represents the natural period of the transverse motion as shown in table 2 and d is the diameter of the column the model test conditions are presented in table 3 first screening tests were performed for current incidences from 0 to 360 with an interval of 22 5 at u r 6 8 critical current incidences were selected to cover the range of 4 u r 12 at 90 100 337 5 and 347 5 the cases at current incidences of 90 337 5 and 45 were conducted to investigate the effect of appendages on the tlp considering the sensitivity study of another representative parameter m r the cases at current incidences of 0 and 45 were performed for the tlp without appendages the towing speed ranged from 0 834 m s to 0 420 m s in the model tests correspondingly the reynolds number was below 3 1 0 5 therefore the uncertainties associated with the transitional flow were avoided the sampling frequency was 25 hz to obtain reliable fim responses the data records were truncated when the towing speed was initially accelerating and finally decelerating then the data records containing 10 15 periods were chosen to analyze the fim statistics 2 4 data analysis the nominal amplitudes of the transverse motion and the yaw motion are defined as 3 a y d n o m i n a l 2 s t d d e v a y d 4 a y a w n o m i n a l 2 s t d d e v a y a w where a y and a y a w denote the amplitudes of the transverse motion and the yaw motion respectively the total hydrodynamic forces including the drag force in the inline direction and the lift force in the transverse direction can be derived from the following motion equations which are also employed in sarpkaya 2004 5 m x t c x t k x x t f x t 6 m y t c y t k y y t f y t where c is the structural damping coefficient and k x and k y represent the linear spring constants in the inline and transverse directions respectively the second term of the equation can be disregarded owing to its small magnitude compared with the others as described by gonçalves et al 2012b therefore the total hydrodynamic forces are the summation of the inertial the first term of the equation and restoring forces the last term of the equation in general the hydrodynamic forces are represented by the force coefficients including the drag force coefficient and the lift force coefficient they are defined as 7 c d t f x t 1 2 ρ a p u 2 8 c l t f y t 1 2 ρ a p u 2 where ρ is the fluid density and a p is the submerged projected area of the model as presented in table 2 to better understand the fim characteristics the average drag force coefficient c d and the root mean square rms value of the lift coefficient c l r m s are discussed 3 experimental results and discussions 3 1 effect of appendages floating platforms serving in the exploitation of offshore oil and gas are covered with various appurtenances which are often asymmetrically collected based on their respective functional requirements therefore screening tests from 0 to 360 with an interval of 22 5 were performed to comprehensively understand the fim characteristics of the tlp m r 0 64 with appendages at different current incidences fig 7 presents the results of the nominal amplitudes of the transverse motion and yaw responses measured in the screening tests at critical reduced velocities u r 6 8 in which range the peak values are often obtained according to previous studies by waals et al 2007 and martin and rijken 2012 although the maximum amplitudes were obtained at different reduced velocities for different current incidences it can be obviously seen that for all current incidences the larger transverse amplitudes occurred at 0 90 180 and 270 overall it can be clearly seen that 90 is a cycle starting from 0 to 360 in addition considerable transverse amplitudes were observed at 22 5 67 5 112 5 247 5 and 337 5 it appears that 45 is a cycle from 22 5 to 337 5 except for 157 5 202 5 and 292 5 this occurs owing to the asymmetry of the appendages by contrast small transverse amplitudes with values lower than 0 2 were obtained at 45 135 225 and 315 this also showed a symmetry with a circle of 90 overall the transverse amplitudes presented a symmetry that was generally related to the current incidences and the effect of the asymmetry of the appendages was slight it can be seen from fig 7 b that the yaw amplitudes increased with reduced velocity at all current incidences with the values not exceeding 3 in the range of 6 u r 8 different from the responses in the transverse direction the yaw amplitudes exhibited asymmetry for different current incidences the variant moments owing to the asymmetry appendages was responsible for this result based on the results from the screening tests the two most critical current incidences 90 and 337 5 and their respective 10 were selected to examine the sensitivity of the current incidence to the fim response of the tlp transverse amplitudes in the range of 4 u r 12 at 90 100 337 5 and 347 5 are depicted in fig 8 a it is clear that the maximum nominal transverse amplitude was a y d 0 408 which occurred at u r 7 at a current incidence of 90 the largest transverse amplitudes were nearly identical for current incidences of 337 5 and 347 5 with the value of a y d 0 36 at u r 7 overall the peak values were obtained in the range of 6 u r 8 which is called the lock in scenario this is similar to that of semisubmersibles as depicted by liu et al 2017 in the pre lock in range the transverse amplitudes increased with reduced velocities by contrast the transverse amplitudes decreased with reduced velocities in the post lock in range fig 8 b presents the yaw amplitudes at critical current incidences the largest yaw amplitude was obtained at u r 12 with the value of a y a w 5 11 4 at the current incidence of 100 the trends and values of yaw amplitudes with reduced velocities at 90 and 100 were similar i e the yaw amplitudes increased with reduced velocities for the other two current incidences the largest yaw amplitude was a y a w 3 37 1 and occurred at u r 11 for 347 5 these considerable responses at 90 100 and 347 5 could be identified waals et al 2007 and gonçalves et al 2012b also identified considerable yaw motions in their experiments however the presence of the galloping phenomenon could not be confirmed for reduced velocities of lower than 14 in the present tests there was a comparative difference in that the yaw amplitudes decreased drastically when the reduced velocity was higher than 10 at 337 5 with a peak value of a y a w 1 96 4 these results confirm the presence of a synchronization regime of the yaw this occurs when the vortex shedding frequency is close to the natural frequency of the yaw motion it is important to highlight that the largest amplitudes of yaw motion occurred at a higher reduced velocity than that for the peak value of the transverse amplitudes owing to the smaller natural period of the yaw motion to investigate the effect of appendages on the fim behaviors of tlps the nominal transverse amplitudes of tlps m r 0 64 with and without appendages for typical current incidences i e 90 337 5 and 45 are depicted in fig 9 compared with the transverse amplitudes of the bare hull shown in fig 9 a it can be seen that the transverse amplitudes of the tlp with appendages decreased significantly in the range of 6 u r 8 at the current incidence of 45 with a maximum reduction of approximately 82 this is because the vortex shedding was destroyed owing to the existence of the appurtenance by contrast a small decrease of 15 was obtained when the largest transverse amplitude occurred at the current incidence of 337 5 at the current incidence of 90 the transverse amplitudes of the tlp with appendages were larger than those of the bare hull when 7 u r 11 likely the appendages generated a larger fluctuating lift force at 90 when the reduced velocities were higher than 11 the transverse amplitudes increased as well waals et al 2007 mentioned that for high reduced velocities the galloping phenomenon may occur possibly however this behavior was not confirmed until u r 14 herein galloping is different from viv and vim which are low frequency responses the vortex shedding frequency was much higher than the structural response frequency in addition the displacement was in phase with the velocity for the galloping behavior as described in gonçalves et al 2012b however the galloping phenomenon was not observed in the present study owing to smaller reduced velocities the galloping behavior will be investigated numerically in the future fig 9 b depicts the yaw amplitudes of the tlp with and without appendages at 90 337 5 and 45 it can be seen that for the bare hull a clear lock in range of the yaw motions was obtained i e 8 u r 12 this lags behind that of the transverse motions as a result of a smaller natural period of the yaw motions an increase in the yaw responses was obviously found at 337 5 with the absence of the appendages especially in the lock in range which reached 37 at u r 11 however the existence of appendages had a slight effect on the yaw amplitudes at 90 the rms of the lift force coefficient and average drag force coefficient for the tlp with and without appendages are shown in fig 10 a and fig 10 b respectively in general the curve tendency of the rms of the lift force coefficient was consistent with that of the transverse amplitudes which implies that the transverse motions were induced by the fluctuating lift forces furthermore the rms of the lift force coefficient of the platform with appendages was smaller than that of the bare hull at all current incidences especially at 45 the rms of the lift force coefficient decreased by around 54 in the range of the lock in the reduction also reached 27 at 90 for the average drag force coefficient c d the values for the tlp with appendages were larger than those of the tlp without appendages at all current incidences the maximum increase was around 28 at u r 6 for 337 5 in general the curves presented a stable tendency at high reduced velocities while an obvious increase was observed in the lock in range owing to the significant motion figs 11 and 12 show the time history and spectral analysis of the transverse motion and lift force coefficient for the tlp with and without appendages respectively it can be observed that the curve tendencies of the transverse motion were accordant with those of the lift force coefficient further proving that the transverse motion was induced by the lift force additionally it can be seen that in fig 12 b and c for 6 u r 8 both the transverse motion and the lift force coefficient presented a characteristic periodicity and an identical dominant frequency moreover the frequency of the transverse motion was close to the natural frequency which demonstrates the resonance of the transverse motion in this reduced velocity range in the pre lock in range corresponding to a region before synchronization in the transverse direction i e fig 12 a the transverse motions and the lift force coefficient did not show periodic features and no obvious dominant frequency was observed in addition fig 12 d shows the range after the lock in scenario this is called the post lock in range similarly no single dominant frequency of the transverse response or lift force coefficient occurred in fig 11 b and c a frequency close to the natural frequency was observed similar to that of the bare hull in the post lock in range the response frequency in the transverse direction was higher than the natural frequency while no well defined oscillation frequency was obtained for the lift force coefficient examples of spectral analyses for the yaw motion of the tlp with and without appendages at 90 are depicted in figs 13 and 14 in comparison with the responses in the transverse direction the yaw responses were irregular in the range of 4 u r 8 for the tlp with and without appendages at u r 12 for the tlp with appendages a dominant frequency could be defined close to the natural frequency of the yaw motion which corroborates the resonance behavior of the yaw motion for the tlp without appendages there was no obvious dominant frequency corresponding to the smaller yaw responses at u r 12 3 2 effect of mass ratio a bare hull was employed to examine the effect of mass ratios on the fim of the tlp fig 15 presents the nominal transverse amplitudes of the tlp at current incidences of 0 and 45 for different mass ratios m r 0 64 0 80 and 0 90 it can be clearly seen that the largest transverse amplitude occurred at 0 for each mass ratio the transverse amplitudes for the three mass ratios were rather similar in trend and attained their peak values in the same range 6 u r 8 this confirms that the resonance occurred for all three mass ratios this was regarded as the lock in scenario for m r 0 80 the peak value of a y d 0 45 occurred at 0 for m r 0 64 and m r 0 9 the largest transverse responses were both around a y d 0 40 with a decrease of approximately 10 from that of m r 0 80 for 45 the most significant transverse motions attained a peak value of approximately a y d 0 30 similarly the transverse amplitudes did not decrease with an increase in the mass ratios the literature indicates that a higher mass ratio may reduce the fim response however in this research the reduction of transverse amplitudes was not realized with an increase in the mass ratios which is similar to that observed in rijken 2014 this is probably because the scruton number did not exceed 0 1 because the damping ratio was on the order of 0 2 1 in addition uncertainties in the experiments may be responsible as well figs 12 16 and 17 depict the time history and spectral analysis of the transverse motion and lift force coefficient at three mass ratios m r 0 64 0 80 and 0 90 respectively it is essential to highlight that for the tlp without appendages the current incidence of 90 was equal to 0 almost identical curves were obtained for these mass ratios in the lock in range the motion amplitudes exhibited periodicity characteristics which were similar to those of the lift force coefficient curves the dominant frequency was close to the natural frequency of the transverse motion confirming the occurrence of the resonance behavior for the tlp at these mass ratios however in the post lock in range the curve tendencies of the transverse motion were inconsistent with those of the lift force coefficient implying that the transverse motion was probably affected by other modes of motion fig 18 shows the yaw amplitudes of the tlp at 0 and 45 for different mass ratios m r 0 64 0 80 and 0 90 respectively all the mass ratios reached their peak values in the same range 8 u r 12 with nearly identical values of a y a w 4 5 at two current incidences this confirms the resonance of the yaw motions of the tlp for different mass ratios owing to smaller natural periods of the yaw motions than those of the transverse motions the range of resonance was logically delayed it is also worth noting that for m r 0 80 the yaw response was most significant at 0 while the peak value was lowest at 45 figs 14 19 and 20 show the spectral analysis of the yaw motions at three mass ratios m r 0 64 0 80 and 0 90 at 0 respectively at u r 4 93 a dominant frequency around the respective natural frequency of the yaw motion f n y a w was observed both for m r 0 80 and 0 90 which contributes to larger responses than those of u r 6 for 6 u r 8 no obvious dominant frequency was obtained corresponding to lower responses in this range however at approximately u r 12 there was a dominant frequency close to the respective natural frequency of the yaw motion for all of the mass ratios this confirms the resonance behavior of the yaw motion at these mass ratios which occurred at higher reduced velocities than that of the transverse motion the motion trajectories at the current incidence of 0 for the three mass ratios are depicted in fig 21 it can be seen that the motion trajectories were similar in tendency at corresponding reduced velocities for all the mass ratios in the lock in range the motion trajectories presented a linear type with large spans this was different from those of the spars which exhibited motion trajectories as eight shaped as described in rosetti et al 2009 and fujarra et al 2009 in the pre lock in range the motions were limited and exhibited a small magnitude however the motion trajectories became chaotic covering a wider range of motion in the inline direction in the post lock in range 4 conclusions effects of appendages and mass ratios on the fim of tlps were investigated experimentally an air bearing system composed of low friction air bearings and a smooth flat plate were developed to model mass ratios lower than 1 0 without affecting the horizontal motions the results of screening tests from 0 to 360 with an interval of 22 5 indicated that the transverse motion is characterized by symmetry for a cycle of 90 while the yaw motion exhibits an asymmetry owing to the effect of the appendages the maximum transverse amplitude was observed at 90 with a value of a y d 0 408 at u r 7 in comparison with a bare hull the transverse amplitude of a tlp with appendages significantly decreased by approximately 82 in the range of 6 u r 8 at 45 in this range the frequency of the transverse motion was close to the natural frequency confirming that resonance occurred i e a lock in scenario was produced the effect of the mass ratio m r 0 64 0 80 and 0 90 on the fim of tlps without appendages was also investigated at 0 and 45 regardless of the mass ratio the largest transverse amplitude was obtained at 0 and lock in scenarios were observed however it was observed that the transverse motions did not decrease with an increase in the mass ratios because the scruton number did not exceed 0 1 this can be attributed to the uncertainties in the experimental tests motion trajectories demonstrated that linear shapes with large spans were exhibited in the lock in range whereas in the post lock in range the motion trajectories were chaotic overall this study provided a series of referable test results for evaluating the fim response of tlps declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the authors acknowledge the support of the national natural science foundation of china grant no 51909158 the support of the subproject of the important national science technology specific projects 2016zx05028 002 004 ministry of industry and information technology of china project no 2016 23 and open foundation of state key laboratory of ocean engineering project no 1808 
22186,an efficient pressure based segregated finite volume solution method for two phase free surface flow simulations including compressibility effects is presented in this paper incompressible treatment of the heavier phase enables efficient long evolutions of wave fields without the need for a separate solver air is treated as an ideal gas undergoing isentropic compression expansion removing the need for an additional energy equation and related numerical difficulties the discontinuity in properties at the free surface between the two phases is treated using the ghost fluid method correctly accounting for the abrupt change in density and compressibility detailed verification and validation is conduced on three simple test cases comprising a liquid piston free fall impact of a horizontal water column and a regular wave propagation to test the stability and accuracy for cases with and without significant compressibility effects the present approach is compared with the incompressible formulation for industrial grade simulations showing that the same level of accuracy can be achieved without significant overhead in computational time finally a compressible wave breaking impact from a large scale experimental campaign is reproduced showing that the method is capable of capturing trapped air cushioning effects with good accuracy keywords compressible two phase model finite volume pressure based wave impact green sea ghost fluid method 1 introduction in the field of computational naval hydrodynamics the issue of compressible two phase flow presents a significant computational challenge application of computational fluid dynamics cfd for resolving violent events where air compressibility plays an important role is becoming more popular where the simulation objective is to assess structural loads of exposed structures typical problems involving air compressibility are sloshing slamming and violent wave impacts in such events compressible behaviour of air entrained between the water and structure has an important influence in the overall structural loading obhrai et al 2004 bullock et al 2007 thus numerical methods have been developed in order to address this problem numerous approaches exist with two most prominent groups being the smoothed particle hydrodynamics sph and the finite volume fv approach an abundance of sph methods have been successfully applied to two phase compressible flow producing realistic and accurate results when compared to experimental and analytical data guilcher et al 2013 investigated scale effects on a wave impact against a wall with trapped air pockets successfully applying the compressible sph method in another publication guilcher et al 2014 showed a validation of the approach on benchmark cases namely the liquid piston case and free falling water column which will be used in this study as well luo et al 2016 and luo and koh 2017 used a consistent particle method to simulate wave breaking with trapped air pocket and sloshing in two connected tanks showing good agreement with the experiment rostami and ketabdari 2016 validated their weakly compressible sph method on a 2d dam break with horizontal column impact however no trapped air pockets were investigated lind et al 2016 showed a novel sph method with a sharp interface treatment validated on a dam break case with a trapped air pocket despite the fact that sph method can be used to effectively simulate aerated wave impacts and related phenomena it remains computationally expensive for industrial applications furthermore simulating complex geometries such as ships with superstructure becomes a problem as well as accurate integration of 6 degrees of freedom motion of a floating object due to difficulties in treating of impermeable boundary conditions for this reason the industry and research increasingly focuses their effort in developing fv based methods which are computationally more efficient for this type of application and allow consistent treatment of boundary conditions while automatic grid generation tools provide body fitted grids for the most intricate geometries fv based methods have their respective challenges and problems which must be recognised treatment of an infinitesimally sharp interface between the two phases poses the most challenging issue nonetheless there is an increasing number of publications dealing with development and application of fv methods for compressible two phase flow in naval hydrodynamics braeunig et al 2009 used a fv based numerical method to explore the possibility of exact scaling between model scale and full scale lng sloshing and derived the gas properties that should be used in model scale to ensure good quality scaling dumbser 2011 developed a pressure based higher order weno fv method for compressible two phase flow the method is validated on a number of dam break cases comparing the results to experiments and shallow water flow theory plumerault et al 2012 developed a pressure based two phase compressible method that allows aerated water flow which can be very important in highly violent wave impacts the method is validated against experimental results for a wave impact against a wall with entrained air costes et al 2013 used a nonlinear potential flow based numerical method in conjunction with a compressible two phase fv method to simulate wave impact with trapped air pocket the potential flow solver is used to propagate the wave field while the more expensive fv compressible method is used only in the vicinity of the structure miller et al 2013 developed a compressible pressure based two phase method specialised for simulating underwater explosions where both air and water compressibility play an important role mixture momentum formulation is used where compressibility properties are smeared across the interface using the vof field a three dimensional shallow water explosion simulation is shown where mass is not fully conserved ma et al 2014 developed a higher order fv method for handling aerated two phase wave impacts where the dispersion of air in water is handled with the volume of fluid approach the method proved accurate for fundamental cases as well as for a 2d wave impact case with trapped air pocket the approach was also used to study rigid plate entry ma et al 2016a where the influence of aeration was investigated experimentally and numerically showing good agreement between the two sets of results furthermore sloshing with trapped air effects is investigated in a de pressurised tank with experimental comparison ma et al 2016b showing once more the accuracy of the presented numerical approach however the drawback of higher order numerical schemes is that they generally suffer from instabilities and are computationally more expensive calderón sánchez et al 2015 investigated a free fall of a horizontal water column with rectangular cross section using openfoam software where the compressibility is explicitly accounted for the ability of the code to capture compressible impact effects on this simple canonical case is demonstrated for various density ratios between the two phases zou et al 2015 used a commercial software fluent to investigate the effects of viscosity and air compressibility on violent sloshing events concluding that lower impact pressures are obtained when a compressible air model is used as opposed to the incompressible model lyu et al 2017 investigated different interface capturing methods in a fv framework for simulating sloshing impacts where both compressible and incompressible methods are used they concluded that volume of fluid vof based interface capturing is the most suitable to predict the motion of the liquid and pressure loads the objective of this study is to devise a two phase flow model based on the fv method where one phase is a compressible gas while the other is an incompressible liquid which could tackle industrial grade simulations in terms of stability efficiency and accuracy the framework is designed in a way to provide a variety of computational features in a single programme to enable performing simulations that include wave propagation rigid body motion of floating objects and compressible wave impact effects in addition in cases where compressibility effects are negligible the method should perform equivalently to its incompressible counterpart vukčević et al 2017 in this manner a single code can be applied to a wide variety of problems in naval hydrodynamics it is for this reason that the present numerical framework will be tested on realistic 3d cases such as seakeeping of a container vessel in head seas in addition to canonical cases which will be used for verification and validation of the method the numerical model presented in this paper is based on the two phase incompressible flow model developed by vukčević et al 2017 which uses the ghost fluid method gfm to implicitly discretise the free surface boundary conditions across the interface the formulation provides a numerically sharp interface which handles the jump in pressure gradient and density across the interface the approach offers a balanced treatment of pressure and density gradient terms in the momentum and the pressure equation which removes the problem of spurious air velocities since air is considered compressible in this study additional effort is employed to formulate a compressible gfm formulation in order to account for the abrupt change in compressibility of the two phases the mathematical derivation and numerical implementation of the compressible gfm are described in detail in the two following sections the gas phase is modelled as an isentropic ideal gas to produce a stable formulation of the pressure equation in low mach number regimes and removes the need to solve the conditional energy equation this assumption is justified for the following reasons that are specific to naval hydrodynamics compressibility effects in naval hydrodynamics of interest here are related to volumetric compression of air by the liquid phase this type of phenomena are highly transient a few hundred milliseconds in duration bullock et al 2007 rendering any heat transfer between the trapped air pocket and the surrounding water negligible heat transfer rate between air and water is low for problems under consideration thus a large temperature difference is needed to drive significant amount of heat from one fluid to the other in the event of trapped air pocket the temperature rise is not significant ma et al 2016b in the event when there is sufficient time for significant heat transfer there is no temperature difference between air and water to drive it since in most naval hydrodynamic phenomena the temperature difference between air and water is small or zero for cases where significant heat flux could exist due to e g large temperature increase during a very high pressure impact this approach will be on the safe side concerning pressure loads the inability of the compressed trapped air pocket to dissipate heat in the surrounding liquid results in smaller temperature and pressure drop leading to higher pressure loads the liquid phase is considered ideally incompressible which facilitates the handling of mass conservation and avoids a plethora of numerical problems related to high speed of sound in liquids the present approach is focused on volumetric compressibility effects that are important in naval hydrodynamics thus pressure shock propagation in the liquid is not considered since it is not relevant for applications in this field furthermore resolving pressure shocks requires temporal and spatial resolution that are prohibitive for everyday industrial use the present numerical framework enables running the simulations at courant numbers well above one as will be demonstrated in section 4 2 in the second section of the paper the mathematical model of the two phase incompressible compressible formulation is presented the numerical model is explained in detail in the appendix where the derivation of the specialised interface corrected discretisation schemes is shown in the fv framework the third section is dedicated to verification and validation where three canonical cases are conducted i liquid piston 1d case testing the basic capability of the code to correctly account for compression of air and to conserve energy and mass ii a falling water column 2d case is performed with a high pressure impact in order to assure that the present approach can tackle violent compressibility effects iii in the third test case the accuracy and precision of the code to propagate a regular wave field is tested where no compressibility effects are present including an extensive grid and time step convergence study the fourth section is dedicated to testing the numerical framework for more complex three dimensional cases that are more realistic in terms of industrial application two cases are considered here a green sea loading case where pressure results are compared to experiments and to the solution of the incompressible solution and a head waves seakeeping case of a container vessel comparing motion and total resistance to incompressible solution and experimental results computational time is also compared between compressible and incompressible formulation showing no significant overhead finally a compressible breaking wave impact is simulated where the results are compared to a large scale experimental data the paper is completed with an overview of the study and conclusions 2 mathematical model in this section the governing equations of viscous turbulent two phase flow with compressible gas phase and incompressible liquid phase which are mutually immiscible are given the equations governing both phases are combined into a single set of equations where the ghost fluid method gfm fedkiw et al 1999 kang et al 2000 desjardins et al 2008 huang et al 2007 bo and grove 2014 kaneda et al 2014 lalanne et al 2015 is employed to account for the discontinuity of fluid properties across the interface the mathematical model presented in this section represents an extension of the gfm for incompressible two phase model shown in vukčević et al 2017 to a special case where one phase is compressible and the other incompressible in the following text governing equations for incompressible and compressible phase will be considered separately followed by a description of the unified mathematical model for both phases finally the mathematical formulation of the jump conditions at the free surface is given 2 1 incompressible phase for single phase incompressible viscous and turbulent flow used in this study the mass conservation equation reads 1 u 0 where u denotes the velocity field following vukčević et al 2017 the momentum equation can be written as 2 u t u u r 1 ρ i p g where r stands for the reynolds stress tensor accounting for general turbulence modelling ρ i is the constant density field of the incompressible fluid g is gravitational acceleration while p stands for pressure field for simulations in this study reynolds averaged navier stokes model is used yielding the following momentum conservation equation 3 u t u u ν e u 1 ρ i p g where ν e stands for effective kinematic viscosity comprised of fluid kinematic viscosity and turbulent viscosity 2 2 compressible phase for general compressible flow the mass conservation equation states 4 ρ c t ρ c u 0 where ρ c denotes the density field of the compressible fluid 4 can be written in the following form 5 u 1 ρ c ρ c t u ρ c note that the right hand side of eq 5 presents the difference between the compressible and incompressible conservation of mass the momentum conservation equation for the compressible phase can be written as 6 ρ c u t ρ c u u u μ e μ e u p ρ c g where μ e stands for effective dynamic viscosity following vukčević et al 2017 pressure is decomposed into dynamic and static part 7 p p d ρ c g x where x stands for the position vector introducing eq 7 into eq 6 reads 8 ρ c u t ρ c u u u μ e μ e u p d ρ c g x by applying the chain rule on eq 8 introducing eq 5 and normalising with ρ c the following form is obtained 9 u t u u 1 ρ c u μ e 1 ρ c μ e u u u 1 ρ c p d 1 ρ c ρ c g x in order to close the system of equations governing the compressible flow i e eqs 5 and 9 appropriate equation of state must be chosen an ideal gas model is employed for the lighter phase since this is considered to be sufficiently accurate for the problems at hand furthermore to avoid an additional energy conservation equation isentropic compression expansion of the gas phase is assumed under these assumptions the equation of state for an ideal gas undergoing adiabatic pressure compression expansion reads 10 p ρ c γ a c c o n s t where γ denotes the constant ratio of specific heats while a c stands for isentropic constant capturing compressible pressure waves is not of importance in naval hydrodynamics instead the volumetric compressible events are of interest thus the goal is to be able to capture air compressibility in events of trapped gas pockets where the gas is compressed due to a reduction of volume under the influence of forces acting on its boundary having this in mind a pressure based method is developed in this study where pressure related operators in eq 5 need to be reformulated in terms of pressure as a working variable a derivative of ρ c is expressed as 11 ρ c p 1 a c γ p a c 1 γ γ assuming isentropic compression expansion of an ideal gas by applying the relations ρ c t ρ c p p t and ρ c ρ c p p on eq 11 the following expression is obtained 12 u 1 ρ c ρ c p p t u p substituting eq 7 into eq 12 results in the final form of the compressible mass conservation equation 13 u 1 ρ c ρ c p p d t p d u p d u ρ c g x t u ρ c g x 2 3 two phase formulation in order to model two phase flow above equations need to be combined into a single equation set volume of fluid vof method rusche 2002 hirt and nicholls 1981 is employed to handle interface capturing where volume fraction fields α k are used to differentiate between individual phases here k is the phase index i for incompressible phase and c for compressible the conservation of mass for both phases states 14 α k ρ k t α k ρ k u 0 by definition α k is 1 when the cell is fully occupied by fluid k and 0 when no fluid k is present in the cell for two phase flow it follows that α c 1 α i thus it is only necessary to convect one fraction field while the other is defined algebraically in this study only the incompressible phase fraction field α i is convected since it ensures mass conservation because the convecting velocity satisfies eq 1 applying eq 1 and ρ i c o n s t to eq 14 yields 15 α i t α i u 0 finally the combined two phase equations are obtained by multiplying equations for two phases with corresponding volume fraction fields and superimposing them the combined two phase conservation of mass equation is obtained by combining eqs 1 and 13 16 u 1 α i 1 ρ c ρ c p p d t p d u p d u ρ c g x t u ρ c g x note that the velocity field is considered continuous across the interface i e u c u i the momentum equation is obtained in the same manner using eqs 3 and 9 17 u t u u 1 ρ u μ e 1 ρ μ e δ u 1 ρ p d 1 α i 1 ρ c ρ c g x u u where ρ α i ρ i 1 α c ρ c eqs 16 17 15 and 10 make a closed system of equations which model a two phase liquid incompressible gas compressible fluid in order for the model to be numerically stable and robust the discontinuities at the interface need to be accounted for 2 4 interface discontinuities and jump conditions in the presence of phase compressibility across the interface ρ and ρ c p have a discontinuity which is non trivial for numerical treatment in this study the discontinuities are taken into account by employing the gfm developed by vukčević et al 2017 and extending the implemented method for treatment of a compressible gas phase the discontinuities or the jump conditions can be written as desjardins et al 2008 huang et al 2007 18 ρ ρ ρ 19 ρ p ρ p ρ p where denotes values infinitesimally close to the interface at the liquid side and at the gas side note that ρ p 0 since the liquid phase is considered incompressible in effect eq 19 expresses the jump in compressibility across the interface although viscosity has a jump across the interface as well it will be considered continuous across the interface as discussed in vukčević et al 2017 which is justified for high reynolds number flows that are of interest apart from the discontinuities of fluid properties additional jump conditions arise from kinematic and dynamic free surface boundary conditions if the surface tension effects are neglected dynamic free surface boundary condition states that pressure must be continuous across the interface 20 p 0 since the governing equations are written in terms of dynamic pressure p d eqs 20 18 and 7 are combined to yield 21 p d ρ g x the kinematic free surface boundary condition states that the velocity field must be continuous across the interface 22 u u u 0 in addition to the above jump conditions additional conditions arise from the jump of governing equations themselves desjardins et al 2008 huang et al 2007 queutey and visonneau 2007 as shown by vukčević et al 2017 by applying the jump operator on eq 3 an additional jump condition for incompressible flow is obtained 23 1 ρ p d 0 which states that the dynamic pressure gradient divided with density must remain continuous across the interface for the combined momentum equation eq 17 applying the jump operator yields the following expression which is valid for compressible flow 24 1 ρ p d u u u u 1 ρ ρ g x where viscous terms vanished due to the assumption mentioned above the jump of temporal term reduces to zero since the velocity is continuous across the interface expanding the right hand side with the jump operator and taking into account that u u 0 and ρ i 0 yields 25 1 ρ p d u u u u 1 ρ c ρ c g x according to eq 24 the gradient of dynamic pressure divided by the density has a discontinuity across the interface stemming from the compressibility of the gas phase the third term on the right hand side represents the jump due to possible nonlinear hydrostatic pressure caused by non zero density gradient in the gas phase the second term is proportional to divergence in the gas phase which is a measure of compressibility of gas it is straightforward to prove that u u is not zero i e u u u u if the jump operator is applied on eq 16 the following is obtained 26 u 1 ρ c ρ c t u ρ c despite the fact that the velocity field is continuous across the interface the divergence of velocity has a jump due to compressibility of the gas phase generally convection jump in eq 25 is non zero as well and must be taken into account dynamic pressure gradient convection and divergence of velocity jumps are interdependent and have a nonlinear relationship thus an iterative approach must be employed in order to resolve the free surface boundary problem in this study existing nonlinear loops used to couple equations eq 17 and eq 16 are also used to converge the jump conditions as well the above equations present a set of conditions that need to be imposed on the governing equations whenever a mathematical operation is performed which uses informations from both sides of the interface the numerical implementation of the above mathematical model is presented in appendix 3 verification and validation three verification and validation cases are presented in this section the first test case consists of a 1d liquid piston where the basic capability of the approach to simulate compression of the air phase is tested in the second test case a free falling horizontal water column impact is simulated where impact pressures are compared to other numerical methods in the literature the third test case verifies that the approach can be used for regular wave propagation with negligible compressibility effects 3 1 liquid piston the liquid piston case is a basic test for compressible two phase flow solvers the test corresponds to fig a 3 it is a one dimensional problem where the layer of water is suspended between two air pockets the water oscillates under the influence of interchanging gravitational energy and internal energy of the air phase if the domain boundaries permit no mass or heat flux and if both fluids are considered inviscid the process is adiabatic thus the oscillation of the water column should persist indefinitely this test case was used as a benchmark by ma et al 2014 and guilcher et al 2014 and the results of this implementation will be compared to theirs for validation the schematic representation of the test case with dimensions is shown in fig 1 the density of water is set to 1000 kg m 3 density of air to 1 kg m 3 while the initial pressure of air is set to p 1 bar values γ 1 4 and a c 100 000 are used for the air phase here and in the test cases below both phases are considered inviscid second order temporal scheme is used for all temporal derivatives for convection of velocity and dynamic pressure second order linear scheme is used for interface convection a second order accurate van leer bounded scheme is used with deferred correction verification study is performed by systematically varying spatial and temporal resolution where the procedure suggested by eça and hoekstra 2008 2014 for unsteady flows is employed a code based on these procedures is used which is freely available marin 2018 the convergence study is performed with respect to the maximum pressure value during the first period of oscillation on the bottom boundary see fig 3 table 1 shows the results for the entire test matrix used for the verification where the number of cells and time step size are marked note that the result for 240 cells with 0 04 s time step is not available since the simulation diverged due to a large courant number the output of the uncertainty calculation code is presented in table 2 the case is validated against results obtained by ma et al 2014 and guilcher et al 2014 comparison of pressure on the bottom boundary in time is shown on fig 2 the three signals are in good agreement without notable differences to check the conservation of energy a 10 s simulation time is performed figs 3 and 4 show pressure and density time signals at the top and bottom boundary respectively pressure and density oscillations does not decay in time proving that the conservation of energy is achieved 3 2 free fall of a water column in this test case a free fall impact of a horizontal square cross section water is simulated where impact pressure against a horizontal impermeable wall is measured fig 5 shows the schematic representation of the case same initial pressure air and water properties are used as in the liquid piston case initial velocity field in the entire domain is set to zero first order euler temporal scheme is used for time integration while velocity and dynamic pressure convection are discretised using first order upwind scheme for interface convection a second order accurate van leer bounded scheme is used as in the previous test case the domain is discretised using 200 cells in the horizontal direction and 1 200 cells in the vertical direction a fixed courant number of 0 9 is maintained during the simulation by varying the time step size the time step varied between 0 005 s at the beginning of the simulation reducing to 2 5 1 0 4 during the impact pressure measured at the bottom boundary at the centre of the domain is compared to results obtained by braeunig et al 2009 ma et al 2014 and guilcher et al 2014 the comparison of pressure signals is presented in fig 6 the peak of the pressure signal obtained with the present approach corresponds well with the results obtained by guilcher et al the coarse grid result by ma et al and the result obtained by braeunig et al predict lower pressure values while the fine grid result by ma et al gives a significantly larger pressure peak of 34 bars comparing to the remaining results which range between 22 6 to 25 4 bars this is an outlier fig 7 shows the variation of the air density entrained in the cavity at the bottom boundary in the centre the geometry of the free surface with visualisation of the velocity and pressure fields is shown in figs 8 and 9 for several time instances where the colour grading indicates the pressure field while the velocity field is depicted with the streamlines after the first impact shown on fig 8c a pocket of air gets entrained underneath the water column the cavity first expands as seen in figs 8d and e and then compresses as visible in figs 8f 9a and b then the cavity expands again as shown in figs 9c and d despite the symmetric initial condition asymmetric flow pattern is observed in figs 8 and 9 which is expected in this sort of very violent impact phenomenon the oscillation can be seen in the complete pressure signal shown in fig 10 where a second compression of the cavity can be observed around t 0 875 s 3 3 regular wave propagation the goal of this study is to devise a compressible two phase flow model that can be applied to a large variety of problems in the field of naval hydrodynamics for that end it is important to assure that wave propagation can be handled accurately and efficiently when phase compressibility effects are negligible in this section a detailed verification and validation is performed for propagation of a regular wave the regular wave is initialised using the stream function wave theory with a period t 3 s height h 0 1 m and wave length λ 13 93 m a two dimensional domain is 60 m long 6 m deep and 0 3 m high above the free surface inlet and outlet implicit relaxation zones jasak et al 2015 are placed at the edges of the domain with a length of 22 m leaving 16 m of unaffected length in the middle of the domain fig 11 shows the velocity field in the simulation where the black vertical lines indicate the end of the inlet and outlet relaxation zones the waves propagate from left to right same discretisation schemes are used as in the liquid piston case thus second order accuracy is expected all simulations are performed for 10 wave periods i e for 30 s for verification and validation surface elevation signal measured in the middle of the domain denoted with a white vertical line in fig 11 is used first and second order harmonic amplitudes η 1 and η 2 are obtained by using fast fourier transform of the surface elevation measured in the last wave period i e from t 27 to t 30 fig 12 shows the time evolution of the surface elevation verification is performed using the same procedure as in section 3 1 by systematically varying spatial and temporal resolution the grid is non uniformly distributed along the vertical and horizontal axis in order to optimise the number of cells in the vertical direction uniform cell size is used 0 1 m above and below the free surface while linear grading is applied outside by enlarging the cells towards the bottom and the top boundary similar meshing strategy is applied in the horizontal direction where uniformly distributed cells are placed in the middle of domain extending 8 m to each side while linear grading is applied from that point towards the inlet and outlet boundaries the verification test matrix with results for the first order amplitude is presented in table 3 where the number of cells corresponds to the number of cells in the vertical direction in the uniformly distributed region around the interface the number of cells in the horizontal direction in the central uniformly distributed region is obtained by multiplying this number with 1 5 results for second order harmonic amplitude are shown in table 4 note that the second order amplitude is two orders of magnitude smaller comparing to the first order amplitude due to a relatively linear wave the output of the numerical uncertainty analysis is shown in table 5 second order accuracy in space is achieved for η 1 while the order of convergence in time of 1 61 is achieved for η 2 second order accuracy in space is achieved as well while first and second order exponents are used in time eça and hoekstra 2014 the grid uncertainty for η 1 is low being 0 4 while for second order it is relatively higher i e 10 9 the second order amplitude is only 0 5 mm while the cell height on the finest grid is δ z 0 2 64 0 003 m i e 3 mm thus given that the second order amplitude is six times smaller than the finest cell the obtained uncertainty is acceptable numerical results are validated against the solution of the stream function wave theory comparison of surface elevation signals are shown in fig 12 while the harmonic amplitudes are compared in table 6 the error between the stream function solution and numerical results is calculated as e r r η s f η c f d η s f for the first order amplitude the error is 0 25 while the second order amplitude exhibited relative error of 8 7 which is acceptable considering the magnitude of η 2 compared to the cell height overall this test case proves that the present model is capable of simulating wave propagation accurately and precisely in order to compare the computational efficiency with the counterpart incompressible numerical model two simulations are carried out with equivalent settings on the same computer a single core of a intel core i7 4820k cpu 3 70 ghz it took 785 s of wall clock time to finish 30 s of simulation with 11 700 cells grid using the compressible solver while it took 760 s with the incompressible thus the two approaches are almost equivalent in terms of computational efficiency 4 industrial cases validation validation of industrially relevant cases is performed in this section where numerical results are compared to experimental data additionally numerical results obtained with the present approach are compared to the its counterpart incompressible formulation vukčević et al 2017 in terms of accuracy and performance two test cases are considered a green sea loading case and a seakeeping case of a container vessel in regular head waves 4 1 green sea loading wave on deck or green sea phenomenon can often include violent wave impacts against vertical structures such as breakwaters it is important to ensure that the present model can be used to accurately predict such loads in this section a benchmark case is used to validate the method against experimental data published by lee et al 2012 a detailed verification and validation of the incompressible framework has been performed in the past gatin et al 2018 using the same experimental data where nine different incident regular waves are considered however only the most severe incident wave will be considered here where the result will be compared to the experimental data and numerical results from gatin et al 2018 in order to study the influence of compressibility on the results the incident wave corresponds to wave id 9 from gatin et al 2018 with wave length λ 3 75 m amplitude a 0 1125 m period t 1 55 s with a resulting wave steepness of k a 0 188 where k denotes the wave number the water depth is d 3 5 metres a simplified fixed model of a fpso floating production storage and offloading vessel termed rect0 lee et al 2012 is considered with geometry shown in fig 13a pressure probes are positioned at ten locations on the horizontal deck arranged as shown in fig 13b computational domain used in the simulation is shown in fig 14 implicit relaxation zones are placed on the inlet outlet starboard and portside boundaries in order to facilitate the wave generation and to prevent wave reflection the regular wave is generated using the stream function theory a computational grid with 3 45 million cells was used corresponding to the finest grid level in gatin et al 2018 grid characteristics are shown in table 7 where l denotes the domain length l r indicates the length of inlet and outlet relaxation zones while λ δ x and a δ z denote the number of cells per wave length and wave amplitude respectively h stands for the height of the domain above the deck in metres note that the freeboard height is 0 045 m above the free surface lee et al 2012 δ z d e c k stands for the height of the cell above the deck in order to provide a fair comparison same numerical settings are used for the simulation with the present compressible model with respect to the incompressible simulation performed in gatin et al 2018 a geometric interface capturing vof method called isoadvector roenby et al 2016 is employed to provide a sharp interface definition a fixed courant number of c o 0 75 is used resulting in average time step of around 0 001 s following gatin et al 2018 the compared items are average pressure peak p m a x and average pressure integral over one wave period p which are calculated as 27 p m a x i 1 n c p i m a x n c 28 p i 1 n c 0 t p i t d t n c where p i m a x denotes the pressure peak during i th wave period while n c stands for the number of wave periods additionally periodic uncertainty is calculated for both items as 29 u c p ϕ m a x ϕ m i n n c where ϕ denotes either p m a x or p comparison of average pressure peaks between experimental and compressible and incompressible numerical results is shown in fig 15 the differences between incompressible and compressible two phase models are negligible which draws two conclusions first the compressibility effects such as trapped air are not present in this case and second the compressible formulation gives equivalent results to the incompressible model when no compressibility effects are present gatin et al 2018 assumed that the large overestimation of the pressure peak with respect to experimental results for pressure gauge id 7 could be a consequence of compressibility effects which are not accounted for in the numerical model here that assumption is proved to be wrong another reason that might cause the overshooting of the pressure peak is the fact that the breakwater is considered perfectly rigid in the simulation while in the experiment a plexiglas wall is used the dynamic response of the plexiglas could have an influence on the reduction of the pressure peak further efforts will be employed to detect the source of discrepancy nonetheless for the remaining pressure gauges the comparison is acceptably accurate the comparison of pressure integrals in time is shown in fig 16 where a similar agreement between the incompressible and compressible results is achieved as for pressure peaks in terms of computational time the incompressible simulation took 45 7 h using 32 cores of a intel xeon processor e5 2637 v3 15m cache 3 50 ghz while the compressible took 27 7 h on 64 cores of the same processor showing comparable computational requirements 4 2 seakeeping a ship sailing in waves can be subjected to compressible wave loading effects due to slamming and green water phenomena in order to be able to effectively predict such loading the motion of the ship in waves must be accurately calculated to that end a seakeeping simulation is performed in this section where a kriso container ship kcs model is considered sailing in regular head waves wave characteristics ship speed and scale correspond to the c5 case from the tokyo workshop on cfd in ship hydrodynamics larsson et al 2015 where experimental results can be found as well model length is l p p 6 05 m breadth b 0 85 m and draught t 0 285 m a regular incident wave with wave length λ 11 84 m and wave height h 0 196 m is imposed using the stream function wave theory infinite depth is modelled by using a bottom boundary condition which mimics the remained of the fluid below the bottom boundary by imposing the wave velocity field at the boundary unstructured computational grid is used with 950 000 cells shown in fig 17 k ω sst turbulence model is used in this simulation wall functions are used on the ship s boundary while the average y is around 40 on the hull fluid structure interaction occurring between the wave field and the ship is resolved using an enhanced coupling algorithm gatin et al 2017 wave generation and absorption is performed using implicit relaxation zones which are placed at the inlet and outlet boundaries implicit algebraic vof method is used in this case as opposed to explicit isoadvector method permitting larger courant numbers since no violent free surface effects are expected the high resolution provided by isoadvetor is not necessary the inlet relaxation zone has a length of λ 2 while the outlet has a length of λ the domain boundaries are positioned 1 l p p in front of the fore perpendicular 2 l p p from the aft perpendicular 1 5 l p p from the side and 1 l p p from the free surface downwards a fixed time step is used resulting in 400 time steps per encounter wave period i e δ t 0 0046 seconds during the simulation the maximum courant number ranges between 9 and 18 the time signal of heave motion is shown in fig 18 where incompressible and compressible formulations are compared the two methods offer identical results in order to provide a quantitative comparison the last period of heave pitch and total resistance signals are transformed into frequency space via fft table 8 shows the comparison of zeroth and first order harmonic amplitudes and phase shift of the first order harmonic for heave z pitch ϕ and total resistance coefficient c t the present compressible and its counterpart incompressible models give very similar results confirming that the two models are equivalent when the compressibility effects are absent both results compare well to experimental results showing under 1 5 error for total resistance and up to 5 5 error for first order amplitudes of motion note that relative errors are not presented for phase shifts since they depend on the arbitrary choice of the incident wave phase shift the phase shifts differences range from 0 8 for heave motion to 4 for pitch motion in order to establish the overhead resulting from the compressible formulation the computational time is compared for the two approaches both simulations were carried out on desktop computers the incompressible simulation was performed on a intel core i5 3570k cpu at 3 40 ghz while the compressible one was performed on intel core i7 4820k cpu at 3 70 ghz it takes 4 7 h of computational time per one wave period with the incompressible version while it takes 3 6 h with the compressible formulation note that the computer used for the compressible simulations has superior processor characteristics thus the required computational resources are comparable between two formulations rendering the present approach relevant for industrial applications 5 breaking wave impact with a trapped air bubble this section presents the final test for the present model a violent breaking wave impact with a trapped air bubble presented by bullock et al 2007 an extensive experimental campaign was conducted where large scale regular wave impacts against a vertical and inclined wall were measured for this comparison a wave with height h 1 25 m period of t 8 s at calm water level depth of d c 1 m in front of the wall is selected which results in a high aeration impact bullock et al 2007 where a large air bubble is trapped between the wave front and the vertical wall the waves are travelling through water depth of 4 m before encountering a slope that reduces the depth to 1 m the experiments were conducted in a 350 m long 5 m wide and 7 m deep grosser wellenkanal at the forschungszentrum küste in hannover germany simulation is conduced in a 2d domain that included 121 metres in front of the vertical wall where the first 50 metres are the inlet relaxation zone where the regular waves are initialised another 54 m of the domain is included behind the wall to provide comparable conditions to the experiment where the wave was spilling over the wall the height of the domain is 8 m corresponding to the depth of the wave tank the bottom is placed at z 0 m while the undisturbed free surface level is at z 4 m the depth d c 1 m refers to water depth in front of the vertical wall i e on the top of the mound fig 19 shows the view of the simulation domain where the vertical wall and the slope are indicated the domain is discretised using 127 120 cells with refinement near the vertical wall presented on fig 20 isoadvector method is used for interface capturing roenby et al 2016 nonlinear stream function wave theory is used to initialise the wave field and impose the oncoming waves at the domain inlet relaxation zone the initial condition of the free surface is shown in fig 21 a fixed courant number of 0 9 is used in order to resolve the violent wave impact three wave periods are simulated where the third one resulted in a breaking event with a trapped air bubble it takes two wave periods for the reflected wave against the wall to interact with the oncoming waves creating a breaking event in front of the wall equivalent event was selected in the experimental results i e the first period that resulted in a breaking event with trapped air bubble due to the longer domain it took 5 periods in the experiment to obtain a breaking wave pressure acting on the vertical wall is measured at positions corresponding to the experimental set up the vertical positions in metres of pressure gauges at the wall with respect to the bottom of the wave tank are 3 49 3 65 3 74 3 90 4 04 4 20 4 39 4 55 4 70 4 74 4 90 4 94 5 10 5 14 5 30 5 54 5 70 and 5 89 in order to smooth out the noise present in pressure signals both in experiments and simulations the integral of pressure is compared the integral is calculated using the trapezoidal integration rule where pressure values from the pressure gauges are assumed to be constant in the transversal direction figs 22 and 23 show the impact of the breaking wave with trapped air in the simulation the initial air bubble separates into two parts where one travels upwards while the second remains trapped in the bottom corner during the impact after the impact the run up collapses creating a second breaking event travelling against incoming waves fig 24 shows the comparison of the force acting on the vertical wall during the impact against the measured force in the experiment the first peak after the impact agrees well with experimental measurements as well as the first pressure drop where sub atmospheric pressure is recorded resulting in a negative force from that point onwards around t 11 32 s the force measured in the experiments damps within another period of oscillation while in the simulation the pressure oscillation continues for another 7 8 periods there are several possible reasons for discrepancy in energy loss of the oscillating air bubble the simulation is 2d thus any 3d effects are not influencing the impact however from the report and videos of the experimental campaign it can be concluded that 3d effects did not play a significant role in the first impact in the simulation the wall and the surrounding structure are considered perfectly rigid i e no energy transfer is possible from the fluid to the structure according to bullock et al 2007 a significant structural response was noticed during the experiment where the impacts generated forces that caused both the caisson and the reinforced concrete walls of the channel to vibrate page 605 the transfer of energy from the wave to the caisson and the channel walls could be responsible for the damping of the bubble oscillation in the experiment the vertical wall had equally spaced holes bored through the entire thickness of the wall to permit the water level to equalise on both sides of the wall there were six columns of holes with three holes in each where the holes had a circular cross section with a diameter of around 10 cm fig 25 shows a photograph of the vertical wall where the holes are visible in an event of a breaking wave impact with trapped air the air could escape from the bubble through the holes due to the large pressure difference the escaping air would deflate the trapped bubble reducing the subsequent pressure oscillations the effect of holes will be examined in future studies by performing a 3d simulation with the exact geometry of the wall including holes from the structural response point of view the first force peak and through are more important than the force tail since they carry a large amount of energy due to high values acting on a large surface over an extended amount of time bullock et al 2007 thus the present approach proves to be accurate with this respect and can be used to accurately assess compressible wave impact loads 6 conclusion a two phase flow model with incompressible liquid and a compressible gas phase based on fv method intended primarily for various applications in marine engineering is presented in this paper the implementation is performed in the naval hydro pack software library based on foam extend cfd software the sharp change in fluid properties across the free surface is taken into account using the ghost fluid method where specialised discretisation schemes are developed for arbitrary polyhedral unstructured grids in this study the gfm is extended to take into account the jump in compressibility of the two phases allowing the liquid phase to be considered incompressible which avoids problems related with high speed of sound in water making the approach computationally inexpensive verification and validation of the present approach is conducted on a 1d liquid piston case a free fall impact of a horizontal water column and regular wave propagation the method proved to be accurate in capturing air compression and expansion effects compressible impacts and simple wave propagation where compressibility effects are negligible the aspect of industrial application of the method is tested on two test cases a green water loading case and container vessel seakeeping in regular head waves the method shows good correspondence with experimental results for both cases while showing equivalent computational demands to its incompressible counterpart finally the ability of the method to capture wave impacts with trapped air effects is tested by comparing the simulation results to a large scale experimental campaign the present approach managed to reproduce the force peak exerted on a vertical wall whereas the force oscillation after the first peak is overestimated the possible reasons for the underestimated energy dissipation of the trapped air bubble oscillation will be studied in the future where the most likely cause of discrepancy are the holes in the vertical wall present in the experiment which were not modelled in the simulation the air bubble can deflate through these holes damping the pressure oscillation overall the present approach accurately and precisely models compressibility effects in two phase flows characteristic for marine engineering the method also proved to be applicable to realistic industrial cases with unstructured body fitted grids and wave induced body motion without an overhead in computational time future study will be focused on studying compressible breaking wave impacts in more details acknowledgements the numerical research performed for this study was sponsored by bureau veritas paris france under the administration of dr šime malenica and dr quentin derbanne the authors would like to acknowledge prof c obhrai from university of stavanger norway for providing access to experimental data related to breaking wave impacts appendix numerical model in this section the complete numerical model developed in this study is presented first discretisation of governing equations will be outlined creating a basis for further development of numerical operators which satisfy the jump conditions implementation of all operators requiring jump conditions is also described a 1 discretisation of governing equations collocated fv method is used to discretise governing equations eqs 17 16 and 15 jasak and gosman 2001 the notation in the following text adheres to vukčević et al 2017 as shown in fig a 1 s f is the surface area vector of a face while d f stands for the vector from cell centre p to cell centre n where p and n represent two adjacent cells that share a face terms enclosed in curly braces indicate that implicit fv discretisation is used while explicit evaluation is used for the remaining terms for details on fv discretisation used in foam extend the reader is directed to jasak 1996 and rusche 2002 the discretised form of eq 17 states a 1 u t u u 1 ρ u μ e 1 ρ μ e u 1 ρ p d 1 α i 1 ρ c ρ c g x u u as stated in section 2 4 temporal and viscous terms are continuous across the interface and do not require special treatment convection dynamic pressure gradient density gradient and u u terms require special treatment when calculated across the interface for the conservation of mass eq 16 the discretised form can be written as a 2 u 1 α i 1 ρ c ρ c p p d t p d u p d u ρ c g x t u ρ c g x due to the discontinuities across the free surface all terms in eq a 2 require special treatment the pressure equation is obtained from eq a 2 following jasak 1996 discretised left hand side of conservation of mass eq a 2 in integral form reads a 3 c v u d v c v d s u f s f u f where c v stands for the control volume v is the cell volume f is the control volume face index d s is the infinitesimal surface normal vector while s f stands for the face area vector cell centred velocity is expressed by using the semi discretised form of the momentum equation jasak 1996 a 4 u p h u n a p 1 ρ a p p d ρ g x where a p denotes the summed diagonal coefficient for cell p while h u n represents a linearised operator containing off diagonal and source contribution resulting from the discretisation of implicit velocity operators in order to substitute face centred velocity u f using eq a 4 it must be interpolated to cell faces a 5 u f h u n f a p f 1 a p f 1 ρ f γ p d f γ ρ f γ g x where index f γ denotes terms that need special attention across the interface by substituting eq a 5 into eq a 3 the discretised conservation of mass can be written as a 6 f s f 1 a p f 1 ρ f γ p d f γ f s f h u n f a p f 1 ρ f γ ρ f γ g x c v f c p d ρ d v where a 7 f c p d ρ 1 α i 1 ρ c ρ c p p d t p d u p d u ρ c g x t u ρ c g x below is a summary of all terms in eqs a 1 a 6 and a 7 with comments on their treatment at the free surface 1 from the momentum equation eq a 1 u t is a cell centred temporal derivative operator for the velocity field which is continuous across the interface no special treatment is needed u u generally has a jump across the interface as indicated in eq 24 which needs to be taken into account 1 ρ u μ e is continuous across the interface due to the assumptions made on the viscosity across the interface except for the 1 ρ term however since the present method takes into account the discontinuity of ρ the cell centred value which is used in this term will be exact i e it will not be smeared instead either the value corresponding to liquid will be used or the value corresponding to gas near the interface therefore although this term has a jump it requires no special attention in the numerical implementation of operators μ e u has no special treatment in this study due to assumptions of continuous viscosity field 1 ρ p d has a jump across the free surface as shown in eq 24 which needs to be accounted for in the explicit operator 1 ρ c ρ c g x is discontinuous since ρ has a discontinuity across the interface and because the gradient of density is zero in the incompressible phase while in the compressible phase it can be non zero thus the explicit density gradient operator needs special treatment at the interface u u is discontinuous across the interface since u is discontinuous as indicated in eq 26 2 from the conservation of mass eq a 6 1 a p f is the inverse diagonal coefficient of the momentum equation interpolated on cell faces it is continuous across the interface and can be interpolated using ordinary linear interpolation 1 ρ f γ is the inverse of the density field interpolated on faces due to discontinuity of density across the interface interpolation cannot be performed linearly p d f γ is an implicit surface normal gradient operator which requires special treatment across the interface due to the jump condition stated in eq 24 this term is a part of the pressure laplacian operator and will be analysed in the remainder of the text h u n f arises from the off diagonal and source contribution of terms in the momentum equation since h u n f is a function of velocity which is continuous across the interface it requires no special attention during interpolation ρ f γ is an explicit surface normal gradient operator of density since neither density nor gradient of density are continuous across the interface special attention is needed f c p d ρ contains 1 α i rendering it inactive in the incompressible phase thus the entire term has a jump over the interface in order to handle the jump consistently the term is set zero for all cells where α i 0 5 i e for all dry cells appendix a 2 while the 1 α i term is removed even though the term is not active in the incompressible phase operators within the term require compact stencil information requiring special attention at the interface 3 from eq a 7 which is active only in the compressible phase p d t is a cell centred operator requiring no compact stencil information however due to the jump of p d across the interface eq 21 the term requires special attention in the case when the interface crosses a cell centre in time i e when an incompressible cell becomes compressible note that the opposite case is not relevant due to the multiplication of the whole term with 1 α i p d u represents convection of dynamic pressure due to the jump of dynamic pressure across the interface the term requires special treatment across the interface p d u term contains a two fold discontinuity at the interface both p d and u are discontinuous however p d is a cell centred value and since the present method resolves a sharp p d field no special attention is needed u requires special attention as indicated earlier ρ c g x t presents a temporal change of hydrostatic pressure it requires special attention when an incompressible cell becomes compressible u ρ c g x contains cell centred gradient of density which needs special attention near the interface due to the discontinuity of density and density gradient in the following section the gfm interpolation is described while appendix a 3 presents a detailed analysis of discretisation of terms requiring special attention at the interface as listed above a 2 the ghost fluid method in gfm mathematical operations for cells that are close to the interface are performed by extrapolating the fields to the cells across the interface the computational stencil is never in two phases at once which is achieved by treating the cells in the other phase as ghost cells of the same phase this prevents the errors that occur when interpolation across the interface is performed using second or higher order accuracy where the true shape of the gradient containing a step change is not accounted for the discontinuity of variables across the interface presents a singularity in the gradient which is numerically difficult to treat detailed description of the gfm is shown in vukčević et al 2017 while the basic notation is repeated here for convenience since this study deals with a combination of an incompressible liquid and a compressible gas phase the cells occupied by water will be referred as wet cells while those occupied by air dry cells wet and dry cells are detected using the vof liquid fraction field representing the incompressible phase cell p is considered wet if α i 0 5 and vice versa the second order accurate fv method which is used in this study is characterised by a compact computational stencil meaning that only the cells sharing a face with cell p will be used to evaluate discretisation operators therefore only the cells that are the closest to the interface will require special attention a face between a wet and a dry cell is called interface face any interpolation on the interface face requires special treatment if the interpolated field contains a discontinuity in this study dynamic pressure and density fields are extrapolated using the gfm while the jump in velocity operators is taken into account through volumetric flux discontinuity see appendix a 3 7 two scenarios need to be covered when extrapolating a general scalar variable ϕ using gfm first when the owner cell p is wet and neighbour cell n is dry and second when the owner cell p is dry and n is wet extrapolation starts by assessing the values on both sides of the interface denoted as ϕ and ϕ which are governed by the jump conditions once ϕ and ϕ are calculated they are used to extrapolate cell centred values across the interface with the following expressions vukčević et al 2017 p is wet and n is dry a 8 ϕ n γ ϕ 1 λ λ ϕ ϕ p a 9 ϕ p γ ϕ λ 1 λ ϕ ϕ n p is dry and n is wet a 10 ϕ n γ ϕ 1 λ λ ϕ ϕ p a 11 ϕ p γ ϕ λ 1 λ ϕ ϕ n here ϕ n γ indicates the extrapolated value in cell n of the variable ϕ on the liquid side it will be used to interpolate values at the interface face between cells p and n when performing the operations for wet cell p ϕ p γ ϕ n γ and ϕ p γ have analogue meanings λ stands for a dimensionless distance between cell centre p and location of the interface along vector d f connecting the two cell centres for details see vukčević et al 2017 in the vof framework it is calculated as a 12 λ α p 0 5 α p α n in this study extrapolation of dynamic pressure using gfm described in vukčević et al 2017 is extended by taking into account the altered jump conditions expressed by the right hand side of eq 25 in the following text the gfm extrapolation derived in vukčević et al 2017 is repeated for convenience followed by the extension for incompressible compressible two phase flow a 2 1 dynamic pressure extrapolation for incompressible flow in order to extrapolate the dynamic pressure to cell centres across the interface using eqs a 10 and a 11 values p d and p d must first be determined discretising eq 23 and using eq 21 expressions for p d and p d are obtained see vukčević 2016 for full derivation p is wet and n is dry a 13 p d λ β β w p d n 1 λ β β w p d p λ β β w h a 14 p d λ β β w p d n 1 λ β β w p d p λ β β w h p is dry and n is wet a 15 p d λ β β d p d n 1 λ β β d p d p λ β β d h a 16 p d λ β β d p d n 1 λ β β d p d p λ β β d h where the following substitutions are used to adhere to vukčević et al 2017 a 17 β 1 ρ a 18 h p d p d p d ρ ρ g x γ a 19 β w λ β 1 λ β a 20 β d λ β 1 λ β where x γ denotes the radii vector of the intersection of vector d f and the free surface see fig a 2 substituting eqs a 13 a 16 to eqs a 8 a 11 extrapolated dynamic pressure values can be expressed in terms of cell centred values p is wet and n is dry a 21 p d n γ β β w p d n 1 β β w p d p β β w h a 22 p d p γ β β w p d p 1 β β w p d n β β w h p is dry and n is wet a 23 p d n γ β β d p d n 1 β β d p d p β β d h a 24 p d p γ β β d p d p 1 β β d p d n β β d h extrapolated values defined by eqs a 21 to a 24 are used in the discretisation of dynamic pressure gradient for cells next to the interface which will be shown in detail later they are used in following cases vukčević et al 2017 p d n γ used when p is wet n is dry for the discretisation of cell p p d p γ used when p is wet n is dry for the discretisation of cell n p d n γ used when p is dry n is wet for the discretisation of cell p p d p γ used when p is dry n is wet for the discretisation of cell n a 2 2 dynamic pressure extrapolation for incompressible compressible flow in appendix a 2 1 expressions for the gfm interpolation of the dynamic pressure across the interface are given for the case when both phases divided by a sharp interface are incompressible these expressions will serve as a basis for the numerical model developed in this study where the liquid phase is considered incompressible while the gas phase is considered compressible in order to derive the expressions for the dynamic pressure for incompressible compressible two phase model eq 25 is discretised and combined with eq 21 to obtain p d and p d values near the interface the derivation is performed in the same fashion as for the incompressible mixture shown in vukčević et al 2017 vukčević 2016 the resulting expressions are as follows p is wet and n is dry a 25 p d λ β β w p d n 1 λ β β w p d p λ β β w h d f λ 1 λ β w u u u u λ β β w ρ n ρ g x a 26 p d λ β β w p d n 1 λ β β w p d p λ β β w h d f λ 1 λ β w u u u u λ β β w ρ n ρ g x p is dry and n is wet a 27 p d λ β β d p d n 1 λ β β d p d p λ β β d h d f λ 1 λ β d u u u u 1 λ β β d ρ ρ p g x a 28 p d λ β β d p d n 1 λ β β d p d p λ β β d h d f λ 1 λ β d u u u u 1 λ β β d ρ ρ p g x additional terms occurring in eqs a 25 a 28 are proportional to effects of compressibility in the gas phase the term u u represents the jump in the convection term from the momentum equation which is intentionally left under the jump operator since it is calculated indirectly using volumetric flux jump see appendix a 3 7 the term u u represents transport of velocity divergence on the compressible side of the interface it will be shown later that first order assumption is made in evaluation of this term where the value calculated at the dry cell centre will be used the last term is proportional to the gradient of hydrostatic pressure caused by the change of density of the compressible phase in space all three additional terms vanish in case when compressibility effects are negligible which renders the method effective in low mach conditions without volumetric compressibility effects without these three terms eqs a 25 a 28 correctly reduce to their incompressible counterparts eqs a 13 a 16 as shown later in the paper this permits running complex flow simulations including large time scale wave evolution and small time scale volumetric compressibility effects in a single run without the need of interchanging incompressible and compressible flow models substituting eqs a 25 a 28 into eqs a 8 a 11 extrapolated dynamic pressure values are expressed in terms of cell centred values p is wet and n is dry a 29 p d n γ β β w p d n 1 β β w p d p β β w h d f 1 λ β w u u u u β β w ρ n ρ g x a 30 p d p γ β β w p d p 1 β β w p d n β β w h d f λ β w u u u u λ β 1 λ β w ρ n ρ g x p is dry and n is wet a 31 p d n γ β β d p d n 1 β β d p d p β β d h d f 1 λ β d u u u u 1 λ β λ β d ρ ρ p g x a 32 p d p γ β β d p d p 1 β β d p d n β β d h d f λ β d u u u u β β d ρ ρ p g x cell centred extrapolation of dynamic pressure expressed with eqs a 29 a 32 is used for discretisation in the same manner as for the incompressible two phase flow depending on whether p is dry or wet and from which cell the discretisation is being carried out the corresponding expression is used see appendix a 2 1 a 2 3 density extrapolation for incompressible compressible flow apart from dynamic pressure extrapolation the density field must also be extrapolated using the gfm in order to correctly evaluate the discontinuous gradient of density in order to extrapolate the density field using eqs a 8 a 11 values close to the interface in both phases ρ and ρ must be determined since the liquid phase is considered incompressible its density is constant in space and time i e ρ ρ i c o n s t on the other hand density in the gas phase is not known and must be calculated pressure and density of the gas phase are related by eq 10 if p is known ρ can easily be calculated as a 33 ρ p a c 1 γ p d ρ g x a c 1 γ where eq 7 is employed to substitute p note that eq a 33 is nonlinear with respect to ρ the nonlinearity can be avoided by remembering that p p eq 20 a 34 ρ p a c 1 γ p d ρ g x a c 1 γ where ρ is constant in order to calculate ρ p d must first be evaluated using eq a 25 or eq a 27 depending on whether cell p is wet or dry note that eqs a 25 and a 27 depend on ρ themselves requiring a nonlinear loop in order to converge once ρ is determined it can be used to extrapolate the density of the gas phase across the interface to the wet cell centre using eqs a 9 and a 10 extrapolating density of the liquid phase is not necessary since ρ i c o n s t a 3 interface corrected discretisation schemes in appendix a 1 implications of the jump conditions on individual terms from the governing equations are analysed in this section discretisation of each of these terms that require special attention on the interface is presented there are three distinct groups of operators that need to be addressed 1 temporal terms when a cell switches to compressible from incompressible from one time step to another special treatment needs to be applied in order to prevent unphysically large temporal change 2 scalar gradient terms both cell centred and face normal gradients of dynamic pressure and density need to be addressed where gfm extrapolation shown in appendix a 2 will be used while cell centred gradients are explicit face normal gradient of dynamic pressure is implicit since it is a part of the implicit pressure laplacian operator special attention will be given to this term 3 velocity operators convection and divergence of velocity are handled using volumetric flux jump that arises from the pressure equation both implicit and explicit versions of the convection operator need to be devised while the divergence operator is always explicit a 3 1 dynamic pressure temporal derivative discretisation temporal derivative of density and dynamic pressure contains a singularity for cells that change phase due to the motion of the interface within a time step since both terms exist only in the compressible phase only the scenario when the cell changes from the incompressible to compressible phase needs to be addressed in the opposite case the temporal change is simply zero due to incompressibility temporal derivative of dynamic pressure can be discretised using the implicit first order euler method as a 35 p d t p d n p d o δ t where n stands for the current time step value and o for the old time step value for cells that were wet in the old time step and are dry in the current termed new dry cells hereafter dynamic pressure jump eq 21 needs to be added to the old time step value a 36 p d t γ p d n p d o ρ i ρ c g x δ t the new dry cells are marked using the following criteria a 37 α i o α i n 0 5 note that the density from the compressible phase is not present in the previous time step and current time step value is used instead since the density difference between air and water which are relevant for marine applications is four or more orders of magnitude larger than the temporal change in air density this assumption has a negligible influence on accuracy in order to achieve second order accuracy in time backward scheme is used a 38 p d t 1 δ t 3 2 p d n 2 p d o 1 2 p d o o where p d o o stands for the dynamic pressure from the second last time step before the current one in this case there are three possible combinations that require special treatment due to conditions in the dynamic pressure n corresponds to a dry cell while o and o o correspond to a wet cell in this case a jump must be added in dynamic pressure for both o and o o values of dynamic pressure a 39 p d t γ 1 δ t 3 2 p d n 2 p d o ρ i ρ c g x 1 2 p d o o ρ i ρ c g x n and o correspond to a dry cell while o o correspond to a wet cell in this case dynamic pressure value from o o must be corrected a 40 p d t γ 1 δ t 3 2 p d n 2 p d o 1 2 p d o o ρ i ρ c g x n and o o correspond to a dry cell while o corresponds to a wet cell here p d o needs to be corrected a 41 p d t γ 1 δ t 3 2 p d n 2 p d o ρ i ρ c g x 1 2 p d o o in the case when p d n corresponds to a wet cell no special treatment is necessary since the temporal change of dynamic pressure is not assessed for the incompressible phase also if the cell has been dry during the last three time steps no special treatment is needed since no jump in dynamic pressure occurred a 3 2 density temporal derivative discretisation another temporal derivative term that needs special treatment is the rate of change of ρ in time for the incompressible phase this term is zero and requires no special attention in cases when a wet cell becomes a dry special treatment is needed in order to assess the temporal change of density in cells for which old time step density values are not available eq 5 is utilised a 42 ρ t γ ρ u u ρ where terms on the right hand side are evaluated using the jump conditions as described in the following text eq a 42 can be used in this manner since ρ is not implicitly solved for instead it is calculated using the equation of state eq 10 a 3 3 discretisation of dynamic pressure gradient term explicit cell centred gradient operator for dynamic pressure can be written in the following form using the gauss theorem jasak et al 2015 a 43 p d 1 v p c v p d d v 1 v p c v p d d s 1 v p f s f p d f where p d f stands for the face interpolated dynamic pressure which requires special attention at the interface by using a central differencing interpolation dynamic pressure gradient for cell p reads a 44 p d p 1 v p f s f f x p d p 1 f x p d n where f x is the interpolation weight for central differencing defined as f x f n p n where f n denotes a vector from cell centre p to face centre f while p n is the vector connecting the two cell centres f denotes summation over cell faces for interface cells the sum over cell faces need to be separated for ordinary and interface faces since interface faces require special attention a 45 1 v p f γ s f f x p d p 1 f x p d n γ where denotes the sum over ordinary faces while f γ stands for the sum over interface faces p d n γ presents the extrapolated dynamic pressure value obtained using eq a 29 or a 31 depending on whether p is wet or dry respectively for the gradient calculated in the neighbour cell n across the interface equivalent expression is used where extrapolated values for p d p γ are used instead a 3 4 discretisation of the density gradient term interface corrected explicit cell centred density gradient is discretised in the same manner as the dynamic pressure gradient shown in appendix a 3 3 a 46 1 v p f γ s f f x ρ p 1 f x ρ n γ note that ρ n γ is used instead of ρ n γ since the gfm extrapolation will be used only from the dry side as the gradient of density is zero in the incompressible phase ρ n γ is determined using eq a 10 in conjunction with eq a 34 when discretising terms for a dry cell n eq a 9 is used to determine ρ p γ a 3 5 discretisation of the pressure laplacian term the term on the left hand side of eq a 6 represents the pressure laplacian term and requires special attention for incompressible two phase flow the implicit treatment is achieved by extrapolating the dynamic pressure values with respect to cell centred values using eqs a 21 a 24 it is shown by vukčević et al 2017 that for incompressible two phase flow the pressure equation remains symmetric notwithstanding the jump conditions for the incompressible compressible mixture the extrapolated values have additional terms see eqs a 29 a 32 which are explicit with respect to dynamic pressure while the implicit portion remains unchanged thus the implicit interface corrected pressure laplacian developed by vukčević et al 2017 is supplemented with the explicit sources due to jump of compressibility across the interface the implicit portion of the jump conditions remains symmetric however the pressure equation is no longer symmetric due to implicit treatment of dynamic pressure convection the explicit compressible jump conditions are also not symmetric which leads to a jump in the source of the pressure laplacian as shown below the pressure laplacian left hand side of eq a 6 is discretised as a 47 f s f 1 a p f β f γ p d f γ f 1 a p f β f γ s f p d n p d p γ d f f k 1 a p f β p d f o where k stands for the non orthogonal correction vector which is obtained using the over relaxed approach jasak 1996 the second term on the right hand side is explicit and contributes to the source of the pressure laplacian and the respective conservative flux the first term is implicit face normal gradient contribution which requires special treatment due to jump conditions note that eq a 47 holds no assumptions on the compressibility of either of the phases thus it is identical to the expressions in vukčević et al 2017 for a wet interface cell p the first term on the right hand side can be divided into two sums f 1 a p f β f γ s f p d n p d p γ d f a 48 f γ 1 a p f β f γ s f p d n γ p d p d f to examine the contribution of one interface face for the mixture of compressible and incompressible fluid the second sum is expanded by substituting p d n γ with eq a 29 a 49 1 a p f β f γ s f p d n γ p d p d f 1 a p f s f d f β β β w p d n p d p h d f 1 λ β u u u u ρ n ρ g x where β f γ is replaced with β since the density in the liquid phase is constant the last two terms in eq a 49 arise from the compressible jump conditions while the first three correspond to the implicit jump condition and the explicit hydrostatic jump condition which are the same as for the incompressible two phase flow the treatment and matrix contribution of the implicit and hydrostatic jump conditions is shown in details by vukčević et al 2017 and will not be repeated here instead only the source contribution from the compressible portion of the jump condition will be examined in detail the compressible portion of the source contribution for a wet p cell can be written as a 50 s p 1 a p f s f d f β β β w d f 1 λ β u u u u n ρ n ρ g x as mentioned earlier the term u u is the jump in the convection term which is calculated using the volumetric flux jump see below the term u u is replaced with u u n i e first order accurate evaluation of this term is used by writing the equivalent of eq a 48 a 50 for the neighbouring dry cell n and employing eq a 30 the source contribution for cell n is expressed as a 51 s n 1 a n f s f d f β β β w d f λ β u u u u n λ 1 λ ρ n ρ g x where β f γ is replaced with β assuming first order accuracy since β c o n s t unlike the implicit and hydrostatic part of the pressure laplacian the compressible jump conditions result in asymmetric source terms since s p s n in other words interface cells p and n will have a different source contribution from the same face equations for a dry p and wet n cell can be derived analogously to above equations and will be omitted for sake of brevity a 3 6 discretisation of surface normal density gradient term as described in appendix a 1 eq a 6 requires explicit evaluation of the surface normal density gradient on cell faces ordinary second order accurate discretisation of this term assuming orthogonal grid reads a 52 ρ f ρ n ρ p d f for non orthogonal grids an explicit correction is applied similarly as described in appendix a 3 5 for interface faces gfm extrapolation is used in order to correct for the jump in density for a wet cell p the following expression is used a 53 ρ f γ ρ n γ ρ p d f while for a dry cell n the surface gradient reads a 54 ρ f γ ρ n ρ p γ d f here ρ n γ and ρ p γ are determined as described in appendix a 3 4 above expressions take into account the jump in density when evaluating surface normal gradient of the density field however the jump in the gradient itself is handled through the discretisation of the pressure laplacian due to the third term on the right hand side of eq 25 see appendix a 3 5 for details in other words the surface normal density gradient is not unique for interface faces instead wet and dry cells will get different contributions from this term wet cells will have no equivalent contribution since the density gradient is zero in the incompressible phase while the dry cell contribution can be non zero a 3 7 volumetric flux jump using eq a 5 volumetric flux for face f can be written as a 55 f f s f u f s f h u n f a p f s f n f 1 a p f β f γ p d f γ ρ f γ g x where n f denotes face normal vector evaluation of volumetric flux must be corrected at the interface since both face normal dynamic pressure and density gradients in eq a 55 are discontinuous looking from the wet cell p side the volumetric flux on an interface face reads f f γ p s f u f a 56 where the density gradient vanishes due to incompressibility of the liquid phase substituting p d n γ with eq a 29 yields a 57 f f γ p s f h u n f a p f s f n f 1 a p f β β β w 1 d f p d n p d p h d f 1 λ β u u u u ρ n ρ g x looking from the dry cell n side the volumetric flux on an interface face reads a 58 f f γ n s f u f s f h u n f a p f s f n f 1 a p f β p d n p d p γ d f ρ n ρ p γ d f g x substituting p d p γ with eq a 30 and ρ p γ with eq a 10 yields a 59 f f γ n s f h u n f a p f s f n f 1 a p f β β β w 1 d f p d n p d p h d f λ β u u u u ρ n ρ g x comparing eqs a 57 and a 59 it follows that the flux on the same face has a different magnitude depending on whether the discretisation is performed from the side of cell p or cell n this means that there is a volumetric flux jump equal to a 60 f f f f γ p f f γ n s f n f 1 a p f β β w d f d f u u u u the jump of volumetric flux should be taken into account in convection and divergence terms by correcting the face interpolated fluxes with eq a 60 note that the jump in flux is present only numerically across the interface face since the ghost cells change the actual phase of the opposing cell physically the flux jump across the interface is zero due to eq 22 consequently the velocity itself has no jump for cell centred operations in order to clarify the meaning of the volumetric flux jump fig a 3shows a schematic representation of a one dimensional liquid piston case discretised with five control volumes cells there is no mass or heat flux through domain boundaries the bottom two cell centres are denoted with p and n the vertical piston is divided into three layers where two pockets of air top and bottom are separated by a layer of water the water moves downwards under the influence of gravity compressing the bottom air pocket while expanding the top one at the bottom part of the piston the interface is located somewhere between cell centre p and face f 2 the interface denoted by γ in the figure moves with velocity u f since water is modelled as incompressible velocity at face f 1 must be equal to the interface velocity to satisfy the continuity equation for cell p the continuity equation can be discretised as a 61 u p 1 v p c v u d v 1 v p c v n u d s 1 v p f s f n f u f 1 v p s f 1 n f 1 u f 1 s f 2 n f 2 u f 2 0 where the remaining faces of cell p have no contribution since the flux is zero the above equation yields the following condition a 62 u f 1 u f 2 since a 63 s f 1 s f 2 a 64 n f 1 n f 2 a 65 n f 1 u f 1 u f 1 a 66 n f 2 u f 2 u f 2 eq a 62 states that the velocity i e volumetric flux on face f 2 must be equal to the one on f 1 in order to satisfy the continuity equation for cell p however from the physical point of view the flux through the imaginary face f 2 is not equal to the flux across f 1 due to the compression of air phase between the interface and face f 2 the jump in flux described by eq a 60 handles this difference by applying a correction which is proportional to the divergence of velocity in the air phase the correction fills the space between the interface and face f 2 with water as well as cell n looking from the air side a similar correction is applied filling the space between the interface and face f 1 with air in order to correctly calculate the flux on face f 2 note that the magnitude of the correction is affected by the actual position of the interface due to term β β w in eq a 60 the closer the interface to cell p the larger the correction a 3 8 discretisation of the dynamic pressure convection term convection of dynamic pressure in eq a 7 is implicit with respect to dynamic pressure it has a two fold discontinuity across the interface due to the discontinuity of the convective flux see appendix a 3 7 and the discontinuity in dynamic pressure prescribed with eq 21 ordinary second order accurate discretisation for cell p using gauss theorem states a 67 u p d p 1 v p c v u p d d v 1 v p c v p d d s u 1 v p f s f u f p d f 1 v p f f f p d f where f f denotes volumetric face flux dividing the sum over all cell faces for interface cells yields a 68 1 v p f γ f f p γ f x p d p 1 f x p d n γ where f f p γ stands for the interface face volumetric flux that contains the jump arising from jump conditions in eq 25 see eq a 57 for cell n f f p γ is used instead note that convection of dynamic pressure term is active only in the compressible gas phase rendering extrapolation from the incompressible phase unnecessary therefore p d n γ is used instead of p d n γ in the above expressions a 3 9 discretisation of velocity convection term velocity convection term in the momentum equation eq 17 is treated implicitly ordinary fv discretisation states a 69 u u p 1 v p c v u u d v 1 v p c v n u u d s 1 v p f s f u f u f 1 v p f f f u f dividing the sum over all cell faces for interface cells yields a 70 1 v p f γ f f p γ f x u p 1 f x u n apart from the implicit convection term the explicit interface jump u u of convection also needs to be defined for an interface face dividing cell p and cell n the jump can be written as a 71 u u 1 v p f f p γ f x u p 1 f x u n 1 v n f f n γ f x u p 1 f x u n 1 v p f f p γ 1 v n f f n γ f x u p 1 f x u n where f f p γ and f f n γ are defined by eqs a 57 and a 59 note that u u and the volumetric flux jump are interdependent and require nonlinear iterations to converge since the jump also depends on the solution of the pressure equation the algorithm relies on the segregated solution procedure to couple the pressure and momentum equations and to converge the jump conditions a 3 10 discretisation of the velocity divergence term divergence of velocity is discretised as a 72 u p 1 v p c v u d v 1 v p c v d s u 1 v p f s f u f 1 v p f f f for interface cells the sum is divided for internal and interface faces a 73 where f f n γ is used for the neighbouring interface cell n 
22186,an efficient pressure based segregated finite volume solution method for two phase free surface flow simulations including compressibility effects is presented in this paper incompressible treatment of the heavier phase enables efficient long evolutions of wave fields without the need for a separate solver air is treated as an ideal gas undergoing isentropic compression expansion removing the need for an additional energy equation and related numerical difficulties the discontinuity in properties at the free surface between the two phases is treated using the ghost fluid method correctly accounting for the abrupt change in density and compressibility detailed verification and validation is conduced on three simple test cases comprising a liquid piston free fall impact of a horizontal water column and a regular wave propagation to test the stability and accuracy for cases with and without significant compressibility effects the present approach is compared with the incompressible formulation for industrial grade simulations showing that the same level of accuracy can be achieved without significant overhead in computational time finally a compressible wave breaking impact from a large scale experimental campaign is reproduced showing that the method is capable of capturing trapped air cushioning effects with good accuracy keywords compressible two phase model finite volume pressure based wave impact green sea ghost fluid method 1 introduction in the field of computational naval hydrodynamics the issue of compressible two phase flow presents a significant computational challenge application of computational fluid dynamics cfd for resolving violent events where air compressibility plays an important role is becoming more popular where the simulation objective is to assess structural loads of exposed structures typical problems involving air compressibility are sloshing slamming and violent wave impacts in such events compressible behaviour of air entrained between the water and structure has an important influence in the overall structural loading obhrai et al 2004 bullock et al 2007 thus numerical methods have been developed in order to address this problem numerous approaches exist with two most prominent groups being the smoothed particle hydrodynamics sph and the finite volume fv approach an abundance of sph methods have been successfully applied to two phase compressible flow producing realistic and accurate results when compared to experimental and analytical data guilcher et al 2013 investigated scale effects on a wave impact against a wall with trapped air pockets successfully applying the compressible sph method in another publication guilcher et al 2014 showed a validation of the approach on benchmark cases namely the liquid piston case and free falling water column which will be used in this study as well luo et al 2016 and luo and koh 2017 used a consistent particle method to simulate wave breaking with trapped air pocket and sloshing in two connected tanks showing good agreement with the experiment rostami and ketabdari 2016 validated their weakly compressible sph method on a 2d dam break with horizontal column impact however no trapped air pockets were investigated lind et al 2016 showed a novel sph method with a sharp interface treatment validated on a dam break case with a trapped air pocket despite the fact that sph method can be used to effectively simulate aerated wave impacts and related phenomena it remains computationally expensive for industrial applications furthermore simulating complex geometries such as ships with superstructure becomes a problem as well as accurate integration of 6 degrees of freedom motion of a floating object due to difficulties in treating of impermeable boundary conditions for this reason the industry and research increasingly focuses their effort in developing fv based methods which are computationally more efficient for this type of application and allow consistent treatment of boundary conditions while automatic grid generation tools provide body fitted grids for the most intricate geometries fv based methods have their respective challenges and problems which must be recognised treatment of an infinitesimally sharp interface between the two phases poses the most challenging issue nonetheless there is an increasing number of publications dealing with development and application of fv methods for compressible two phase flow in naval hydrodynamics braeunig et al 2009 used a fv based numerical method to explore the possibility of exact scaling between model scale and full scale lng sloshing and derived the gas properties that should be used in model scale to ensure good quality scaling dumbser 2011 developed a pressure based higher order weno fv method for compressible two phase flow the method is validated on a number of dam break cases comparing the results to experiments and shallow water flow theory plumerault et al 2012 developed a pressure based two phase compressible method that allows aerated water flow which can be very important in highly violent wave impacts the method is validated against experimental results for a wave impact against a wall with entrained air costes et al 2013 used a nonlinear potential flow based numerical method in conjunction with a compressible two phase fv method to simulate wave impact with trapped air pocket the potential flow solver is used to propagate the wave field while the more expensive fv compressible method is used only in the vicinity of the structure miller et al 2013 developed a compressible pressure based two phase method specialised for simulating underwater explosions where both air and water compressibility play an important role mixture momentum formulation is used where compressibility properties are smeared across the interface using the vof field a three dimensional shallow water explosion simulation is shown where mass is not fully conserved ma et al 2014 developed a higher order fv method for handling aerated two phase wave impacts where the dispersion of air in water is handled with the volume of fluid approach the method proved accurate for fundamental cases as well as for a 2d wave impact case with trapped air pocket the approach was also used to study rigid plate entry ma et al 2016a where the influence of aeration was investigated experimentally and numerically showing good agreement between the two sets of results furthermore sloshing with trapped air effects is investigated in a de pressurised tank with experimental comparison ma et al 2016b showing once more the accuracy of the presented numerical approach however the drawback of higher order numerical schemes is that they generally suffer from instabilities and are computationally more expensive calderón sánchez et al 2015 investigated a free fall of a horizontal water column with rectangular cross section using openfoam software where the compressibility is explicitly accounted for the ability of the code to capture compressible impact effects on this simple canonical case is demonstrated for various density ratios between the two phases zou et al 2015 used a commercial software fluent to investigate the effects of viscosity and air compressibility on violent sloshing events concluding that lower impact pressures are obtained when a compressible air model is used as opposed to the incompressible model lyu et al 2017 investigated different interface capturing methods in a fv framework for simulating sloshing impacts where both compressible and incompressible methods are used they concluded that volume of fluid vof based interface capturing is the most suitable to predict the motion of the liquid and pressure loads the objective of this study is to devise a two phase flow model based on the fv method where one phase is a compressible gas while the other is an incompressible liquid which could tackle industrial grade simulations in terms of stability efficiency and accuracy the framework is designed in a way to provide a variety of computational features in a single programme to enable performing simulations that include wave propagation rigid body motion of floating objects and compressible wave impact effects in addition in cases where compressibility effects are negligible the method should perform equivalently to its incompressible counterpart vukčević et al 2017 in this manner a single code can be applied to a wide variety of problems in naval hydrodynamics it is for this reason that the present numerical framework will be tested on realistic 3d cases such as seakeeping of a container vessel in head seas in addition to canonical cases which will be used for verification and validation of the method the numerical model presented in this paper is based on the two phase incompressible flow model developed by vukčević et al 2017 which uses the ghost fluid method gfm to implicitly discretise the free surface boundary conditions across the interface the formulation provides a numerically sharp interface which handles the jump in pressure gradient and density across the interface the approach offers a balanced treatment of pressure and density gradient terms in the momentum and the pressure equation which removes the problem of spurious air velocities since air is considered compressible in this study additional effort is employed to formulate a compressible gfm formulation in order to account for the abrupt change in compressibility of the two phases the mathematical derivation and numerical implementation of the compressible gfm are described in detail in the two following sections the gas phase is modelled as an isentropic ideal gas to produce a stable formulation of the pressure equation in low mach number regimes and removes the need to solve the conditional energy equation this assumption is justified for the following reasons that are specific to naval hydrodynamics compressibility effects in naval hydrodynamics of interest here are related to volumetric compression of air by the liquid phase this type of phenomena are highly transient a few hundred milliseconds in duration bullock et al 2007 rendering any heat transfer between the trapped air pocket and the surrounding water negligible heat transfer rate between air and water is low for problems under consideration thus a large temperature difference is needed to drive significant amount of heat from one fluid to the other in the event of trapped air pocket the temperature rise is not significant ma et al 2016b in the event when there is sufficient time for significant heat transfer there is no temperature difference between air and water to drive it since in most naval hydrodynamic phenomena the temperature difference between air and water is small or zero for cases where significant heat flux could exist due to e g large temperature increase during a very high pressure impact this approach will be on the safe side concerning pressure loads the inability of the compressed trapped air pocket to dissipate heat in the surrounding liquid results in smaller temperature and pressure drop leading to higher pressure loads the liquid phase is considered ideally incompressible which facilitates the handling of mass conservation and avoids a plethora of numerical problems related to high speed of sound in liquids the present approach is focused on volumetric compressibility effects that are important in naval hydrodynamics thus pressure shock propagation in the liquid is not considered since it is not relevant for applications in this field furthermore resolving pressure shocks requires temporal and spatial resolution that are prohibitive for everyday industrial use the present numerical framework enables running the simulations at courant numbers well above one as will be demonstrated in section 4 2 in the second section of the paper the mathematical model of the two phase incompressible compressible formulation is presented the numerical model is explained in detail in the appendix where the derivation of the specialised interface corrected discretisation schemes is shown in the fv framework the third section is dedicated to verification and validation where three canonical cases are conducted i liquid piston 1d case testing the basic capability of the code to correctly account for compression of air and to conserve energy and mass ii a falling water column 2d case is performed with a high pressure impact in order to assure that the present approach can tackle violent compressibility effects iii in the third test case the accuracy and precision of the code to propagate a regular wave field is tested where no compressibility effects are present including an extensive grid and time step convergence study the fourth section is dedicated to testing the numerical framework for more complex three dimensional cases that are more realistic in terms of industrial application two cases are considered here a green sea loading case where pressure results are compared to experiments and to the solution of the incompressible solution and a head waves seakeeping case of a container vessel comparing motion and total resistance to incompressible solution and experimental results computational time is also compared between compressible and incompressible formulation showing no significant overhead finally a compressible breaking wave impact is simulated where the results are compared to a large scale experimental data the paper is completed with an overview of the study and conclusions 2 mathematical model in this section the governing equations of viscous turbulent two phase flow with compressible gas phase and incompressible liquid phase which are mutually immiscible are given the equations governing both phases are combined into a single set of equations where the ghost fluid method gfm fedkiw et al 1999 kang et al 2000 desjardins et al 2008 huang et al 2007 bo and grove 2014 kaneda et al 2014 lalanne et al 2015 is employed to account for the discontinuity of fluid properties across the interface the mathematical model presented in this section represents an extension of the gfm for incompressible two phase model shown in vukčević et al 2017 to a special case where one phase is compressible and the other incompressible in the following text governing equations for incompressible and compressible phase will be considered separately followed by a description of the unified mathematical model for both phases finally the mathematical formulation of the jump conditions at the free surface is given 2 1 incompressible phase for single phase incompressible viscous and turbulent flow used in this study the mass conservation equation reads 1 u 0 where u denotes the velocity field following vukčević et al 2017 the momentum equation can be written as 2 u t u u r 1 ρ i p g where r stands for the reynolds stress tensor accounting for general turbulence modelling ρ i is the constant density field of the incompressible fluid g is gravitational acceleration while p stands for pressure field for simulations in this study reynolds averaged navier stokes model is used yielding the following momentum conservation equation 3 u t u u ν e u 1 ρ i p g where ν e stands for effective kinematic viscosity comprised of fluid kinematic viscosity and turbulent viscosity 2 2 compressible phase for general compressible flow the mass conservation equation states 4 ρ c t ρ c u 0 where ρ c denotes the density field of the compressible fluid 4 can be written in the following form 5 u 1 ρ c ρ c t u ρ c note that the right hand side of eq 5 presents the difference between the compressible and incompressible conservation of mass the momentum conservation equation for the compressible phase can be written as 6 ρ c u t ρ c u u u μ e μ e u p ρ c g where μ e stands for effective dynamic viscosity following vukčević et al 2017 pressure is decomposed into dynamic and static part 7 p p d ρ c g x where x stands for the position vector introducing eq 7 into eq 6 reads 8 ρ c u t ρ c u u u μ e μ e u p d ρ c g x by applying the chain rule on eq 8 introducing eq 5 and normalising with ρ c the following form is obtained 9 u t u u 1 ρ c u μ e 1 ρ c μ e u u u 1 ρ c p d 1 ρ c ρ c g x in order to close the system of equations governing the compressible flow i e eqs 5 and 9 appropriate equation of state must be chosen an ideal gas model is employed for the lighter phase since this is considered to be sufficiently accurate for the problems at hand furthermore to avoid an additional energy conservation equation isentropic compression expansion of the gas phase is assumed under these assumptions the equation of state for an ideal gas undergoing adiabatic pressure compression expansion reads 10 p ρ c γ a c c o n s t where γ denotes the constant ratio of specific heats while a c stands for isentropic constant capturing compressible pressure waves is not of importance in naval hydrodynamics instead the volumetric compressible events are of interest thus the goal is to be able to capture air compressibility in events of trapped gas pockets where the gas is compressed due to a reduction of volume under the influence of forces acting on its boundary having this in mind a pressure based method is developed in this study where pressure related operators in eq 5 need to be reformulated in terms of pressure as a working variable a derivative of ρ c is expressed as 11 ρ c p 1 a c γ p a c 1 γ γ assuming isentropic compression expansion of an ideal gas by applying the relations ρ c t ρ c p p t and ρ c ρ c p p on eq 11 the following expression is obtained 12 u 1 ρ c ρ c p p t u p substituting eq 7 into eq 12 results in the final form of the compressible mass conservation equation 13 u 1 ρ c ρ c p p d t p d u p d u ρ c g x t u ρ c g x 2 3 two phase formulation in order to model two phase flow above equations need to be combined into a single equation set volume of fluid vof method rusche 2002 hirt and nicholls 1981 is employed to handle interface capturing where volume fraction fields α k are used to differentiate between individual phases here k is the phase index i for incompressible phase and c for compressible the conservation of mass for both phases states 14 α k ρ k t α k ρ k u 0 by definition α k is 1 when the cell is fully occupied by fluid k and 0 when no fluid k is present in the cell for two phase flow it follows that α c 1 α i thus it is only necessary to convect one fraction field while the other is defined algebraically in this study only the incompressible phase fraction field α i is convected since it ensures mass conservation because the convecting velocity satisfies eq 1 applying eq 1 and ρ i c o n s t to eq 14 yields 15 α i t α i u 0 finally the combined two phase equations are obtained by multiplying equations for two phases with corresponding volume fraction fields and superimposing them the combined two phase conservation of mass equation is obtained by combining eqs 1 and 13 16 u 1 α i 1 ρ c ρ c p p d t p d u p d u ρ c g x t u ρ c g x note that the velocity field is considered continuous across the interface i e u c u i the momentum equation is obtained in the same manner using eqs 3 and 9 17 u t u u 1 ρ u μ e 1 ρ μ e δ u 1 ρ p d 1 α i 1 ρ c ρ c g x u u where ρ α i ρ i 1 α c ρ c eqs 16 17 15 and 10 make a closed system of equations which model a two phase liquid incompressible gas compressible fluid in order for the model to be numerically stable and robust the discontinuities at the interface need to be accounted for 2 4 interface discontinuities and jump conditions in the presence of phase compressibility across the interface ρ and ρ c p have a discontinuity which is non trivial for numerical treatment in this study the discontinuities are taken into account by employing the gfm developed by vukčević et al 2017 and extending the implemented method for treatment of a compressible gas phase the discontinuities or the jump conditions can be written as desjardins et al 2008 huang et al 2007 18 ρ ρ ρ 19 ρ p ρ p ρ p where denotes values infinitesimally close to the interface at the liquid side and at the gas side note that ρ p 0 since the liquid phase is considered incompressible in effect eq 19 expresses the jump in compressibility across the interface although viscosity has a jump across the interface as well it will be considered continuous across the interface as discussed in vukčević et al 2017 which is justified for high reynolds number flows that are of interest apart from the discontinuities of fluid properties additional jump conditions arise from kinematic and dynamic free surface boundary conditions if the surface tension effects are neglected dynamic free surface boundary condition states that pressure must be continuous across the interface 20 p 0 since the governing equations are written in terms of dynamic pressure p d eqs 20 18 and 7 are combined to yield 21 p d ρ g x the kinematic free surface boundary condition states that the velocity field must be continuous across the interface 22 u u u 0 in addition to the above jump conditions additional conditions arise from the jump of governing equations themselves desjardins et al 2008 huang et al 2007 queutey and visonneau 2007 as shown by vukčević et al 2017 by applying the jump operator on eq 3 an additional jump condition for incompressible flow is obtained 23 1 ρ p d 0 which states that the dynamic pressure gradient divided with density must remain continuous across the interface for the combined momentum equation eq 17 applying the jump operator yields the following expression which is valid for compressible flow 24 1 ρ p d u u u u 1 ρ ρ g x where viscous terms vanished due to the assumption mentioned above the jump of temporal term reduces to zero since the velocity is continuous across the interface expanding the right hand side with the jump operator and taking into account that u u 0 and ρ i 0 yields 25 1 ρ p d u u u u 1 ρ c ρ c g x according to eq 24 the gradient of dynamic pressure divided by the density has a discontinuity across the interface stemming from the compressibility of the gas phase the third term on the right hand side represents the jump due to possible nonlinear hydrostatic pressure caused by non zero density gradient in the gas phase the second term is proportional to divergence in the gas phase which is a measure of compressibility of gas it is straightforward to prove that u u is not zero i e u u u u if the jump operator is applied on eq 16 the following is obtained 26 u 1 ρ c ρ c t u ρ c despite the fact that the velocity field is continuous across the interface the divergence of velocity has a jump due to compressibility of the gas phase generally convection jump in eq 25 is non zero as well and must be taken into account dynamic pressure gradient convection and divergence of velocity jumps are interdependent and have a nonlinear relationship thus an iterative approach must be employed in order to resolve the free surface boundary problem in this study existing nonlinear loops used to couple equations eq 17 and eq 16 are also used to converge the jump conditions as well the above equations present a set of conditions that need to be imposed on the governing equations whenever a mathematical operation is performed which uses informations from both sides of the interface the numerical implementation of the above mathematical model is presented in appendix 3 verification and validation three verification and validation cases are presented in this section the first test case consists of a 1d liquid piston where the basic capability of the approach to simulate compression of the air phase is tested in the second test case a free falling horizontal water column impact is simulated where impact pressures are compared to other numerical methods in the literature the third test case verifies that the approach can be used for regular wave propagation with negligible compressibility effects 3 1 liquid piston the liquid piston case is a basic test for compressible two phase flow solvers the test corresponds to fig a 3 it is a one dimensional problem where the layer of water is suspended between two air pockets the water oscillates under the influence of interchanging gravitational energy and internal energy of the air phase if the domain boundaries permit no mass or heat flux and if both fluids are considered inviscid the process is adiabatic thus the oscillation of the water column should persist indefinitely this test case was used as a benchmark by ma et al 2014 and guilcher et al 2014 and the results of this implementation will be compared to theirs for validation the schematic representation of the test case with dimensions is shown in fig 1 the density of water is set to 1000 kg m 3 density of air to 1 kg m 3 while the initial pressure of air is set to p 1 bar values γ 1 4 and a c 100 000 are used for the air phase here and in the test cases below both phases are considered inviscid second order temporal scheme is used for all temporal derivatives for convection of velocity and dynamic pressure second order linear scheme is used for interface convection a second order accurate van leer bounded scheme is used with deferred correction verification study is performed by systematically varying spatial and temporal resolution where the procedure suggested by eça and hoekstra 2008 2014 for unsteady flows is employed a code based on these procedures is used which is freely available marin 2018 the convergence study is performed with respect to the maximum pressure value during the first period of oscillation on the bottom boundary see fig 3 table 1 shows the results for the entire test matrix used for the verification where the number of cells and time step size are marked note that the result for 240 cells with 0 04 s time step is not available since the simulation diverged due to a large courant number the output of the uncertainty calculation code is presented in table 2 the case is validated against results obtained by ma et al 2014 and guilcher et al 2014 comparison of pressure on the bottom boundary in time is shown on fig 2 the three signals are in good agreement without notable differences to check the conservation of energy a 10 s simulation time is performed figs 3 and 4 show pressure and density time signals at the top and bottom boundary respectively pressure and density oscillations does not decay in time proving that the conservation of energy is achieved 3 2 free fall of a water column in this test case a free fall impact of a horizontal square cross section water is simulated where impact pressure against a horizontal impermeable wall is measured fig 5 shows the schematic representation of the case same initial pressure air and water properties are used as in the liquid piston case initial velocity field in the entire domain is set to zero first order euler temporal scheme is used for time integration while velocity and dynamic pressure convection are discretised using first order upwind scheme for interface convection a second order accurate van leer bounded scheme is used as in the previous test case the domain is discretised using 200 cells in the horizontal direction and 1 200 cells in the vertical direction a fixed courant number of 0 9 is maintained during the simulation by varying the time step size the time step varied between 0 005 s at the beginning of the simulation reducing to 2 5 1 0 4 during the impact pressure measured at the bottom boundary at the centre of the domain is compared to results obtained by braeunig et al 2009 ma et al 2014 and guilcher et al 2014 the comparison of pressure signals is presented in fig 6 the peak of the pressure signal obtained with the present approach corresponds well with the results obtained by guilcher et al the coarse grid result by ma et al and the result obtained by braeunig et al predict lower pressure values while the fine grid result by ma et al gives a significantly larger pressure peak of 34 bars comparing to the remaining results which range between 22 6 to 25 4 bars this is an outlier fig 7 shows the variation of the air density entrained in the cavity at the bottom boundary in the centre the geometry of the free surface with visualisation of the velocity and pressure fields is shown in figs 8 and 9 for several time instances where the colour grading indicates the pressure field while the velocity field is depicted with the streamlines after the first impact shown on fig 8c a pocket of air gets entrained underneath the water column the cavity first expands as seen in figs 8d and e and then compresses as visible in figs 8f 9a and b then the cavity expands again as shown in figs 9c and d despite the symmetric initial condition asymmetric flow pattern is observed in figs 8 and 9 which is expected in this sort of very violent impact phenomenon the oscillation can be seen in the complete pressure signal shown in fig 10 where a second compression of the cavity can be observed around t 0 875 s 3 3 regular wave propagation the goal of this study is to devise a compressible two phase flow model that can be applied to a large variety of problems in the field of naval hydrodynamics for that end it is important to assure that wave propagation can be handled accurately and efficiently when phase compressibility effects are negligible in this section a detailed verification and validation is performed for propagation of a regular wave the regular wave is initialised using the stream function wave theory with a period t 3 s height h 0 1 m and wave length λ 13 93 m a two dimensional domain is 60 m long 6 m deep and 0 3 m high above the free surface inlet and outlet implicit relaxation zones jasak et al 2015 are placed at the edges of the domain with a length of 22 m leaving 16 m of unaffected length in the middle of the domain fig 11 shows the velocity field in the simulation where the black vertical lines indicate the end of the inlet and outlet relaxation zones the waves propagate from left to right same discretisation schemes are used as in the liquid piston case thus second order accuracy is expected all simulations are performed for 10 wave periods i e for 30 s for verification and validation surface elevation signal measured in the middle of the domain denoted with a white vertical line in fig 11 is used first and second order harmonic amplitudes η 1 and η 2 are obtained by using fast fourier transform of the surface elevation measured in the last wave period i e from t 27 to t 30 fig 12 shows the time evolution of the surface elevation verification is performed using the same procedure as in section 3 1 by systematically varying spatial and temporal resolution the grid is non uniformly distributed along the vertical and horizontal axis in order to optimise the number of cells in the vertical direction uniform cell size is used 0 1 m above and below the free surface while linear grading is applied outside by enlarging the cells towards the bottom and the top boundary similar meshing strategy is applied in the horizontal direction where uniformly distributed cells are placed in the middle of domain extending 8 m to each side while linear grading is applied from that point towards the inlet and outlet boundaries the verification test matrix with results for the first order amplitude is presented in table 3 where the number of cells corresponds to the number of cells in the vertical direction in the uniformly distributed region around the interface the number of cells in the horizontal direction in the central uniformly distributed region is obtained by multiplying this number with 1 5 results for second order harmonic amplitude are shown in table 4 note that the second order amplitude is two orders of magnitude smaller comparing to the first order amplitude due to a relatively linear wave the output of the numerical uncertainty analysis is shown in table 5 second order accuracy in space is achieved for η 1 while the order of convergence in time of 1 61 is achieved for η 2 second order accuracy in space is achieved as well while first and second order exponents are used in time eça and hoekstra 2014 the grid uncertainty for η 1 is low being 0 4 while for second order it is relatively higher i e 10 9 the second order amplitude is only 0 5 mm while the cell height on the finest grid is δ z 0 2 64 0 003 m i e 3 mm thus given that the second order amplitude is six times smaller than the finest cell the obtained uncertainty is acceptable numerical results are validated against the solution of the stream function wave theory comparison of surface elevation signals are shown in fig 12 while the harmonic amplitudes are compared in table 6 the error between the stream function solution and numerical results is calculated as e r r η s f η c f d η s f for the first order amplitude the error is 0 25 while the second order amplitude exhibited relative error of 8 7 which is acceptable considering the magnitude of η 2 compared to the cell height overall this test case proves that the present model is capable of simulating wave propagation accurately and precisely in order to compare the computational efficiency with the counterpart incompressible numerical model two simulations are carried out with equivalent settings on the same computer a single core of a intel core i7 4820k cpu 3 70 ghz it took 785 s of wall clock time to finish 30 s of simulation with 11 700 cells grid using the compressible solver while it took 760 s with the incompressible thus the two approaches are almost equivalent in terms of computational efficiency 4 industrial cases validation validation of industrially relevant cases is performed in this section where numerical results are compared to experimental data additionally numerical results obtained with the present approach are compared to the its counterpart incompressible formulation vukčević et al 2017 in terms of accuracy and performance two test cases are considered a green sea loading case and a seakeeping case of a container vessel in regular head waves 4 1 green sea loading wave on deck or green sea phenomenon can often include violent wave impacts against vertical structures such as breakwaters it is important to ensure that the present model can be used to accurately predict such loads in this section a benchmark case is used to validate the method against experimental data published by lee et al 2012 a detailed verification and validation of the incompressible framework has been performed in the past gatin et al 2018 using the same experimental data where nine different incident regular waves are considered however only the most severe incident wave will be considered here where the result will be compared to the experimental data and numerical results from gatin et al 2018 in order to study the influence of compressibility on the results the incident wave corresponds to wave id 9 from gatin et al 2018 with wave length λ 3 75 m amplitude a 0 1125 m period t 1 55 s with a resulting wave steepness of k a 0 188 where k denotes the wave number the water depth is d 3 5 metres a simplified fixed model of a fpso floating production storage and offloading vessel termed rect0 lee et al 2012 is considered with geometry shown in fig 13a pressure probes are positioned at ten locations on the horizontal deck arranged as shown in fig 13b computational domain used in the simulation is shown in fig 14 implicit relaxation zones are placed on the inlet outlet starboard and portside boundaries in order to facilitate the wave generation and to prevent wave reflection the regular wave is generated using the stream function theory a computational grid with 3 45 million cells was used corresponding to the finest grid level in gatin et al 2018 grid characteristics are shown in table 7 where l denotes the domain length l r indicates the length of inlet and outlet relaxation zones while λ δ x and a δ z denote the number of cells per wave length and wave amplitude respectively h stands for the height of the domain above the deck in metres note that the freeboard height is 0 045 m above the free surface lee et al 2012 δ z d e c k stands for the height of the cell above the deck in order to provide a fair comparison same numerical settings are used for the simulation with the present compressible model with respect to the incompressible simulation performed in gatin et al 2018 a geometric interface capturing vof method called isoadvector roenby et al 2016 is employed to provide a sharp interface definition a fixed courant number of c o 0 75 is used resulting in average time step of around 0 001 s following gatin et al 2018 the compared items are average pressure peak p m a x and average pressure integral over one wave period p which are calculated as 27 p m a x i 1 n c p i m a x n c 28 p i 1 n c 0 t p i t d t n c where p i m a x denotes the pressure peak during i th wave period while n c stands for the number of wave periods additionally periodic uncertainty is calculated for both items as 29 u c p ϕ m a x ϕ m i n n c where ϕ denotes either p m a x or p comparison of average pressure peaks between experimental and compressible and incompressible numerical results is shown in fig 15 the differences between incompressible and compressible two phase models are negligible which draws two conclusions first the compressibility effects such as trapped air are not present in this case and second the compressible formulation gives equivalent results to the incompressible model when no compressibility effects are present gatin et al 2018 assumed that the large overestimation of the pressure peak with respect to experimental results for pressure gauge id 7 could be a consequence of compressibility effects which are not accounted for in the numerical model here that assumption is proved to be wrong another reason that might cause the overshooting of the pressure peak is the fact that the breakwater is considered perfectly rigid in the simulation while in the experiment a plexiglas wall is used the dynamic response of the plexiglas could have an influence on the reduction of the pressure peak further efforts will be employed to detect the source of discrepancy nonetheless for the remaining pressure gauges the comparison is acceptably accurate the comparison of pressure integrals in time is shown in fig 16 where a similar agreement between the incompressible and compressible results is achieved as for pressure peaks in terms of computational time the incompressible simulation took 45 7 h using 32 cores of a intel xeon processor e5 2637 v3 15m cache 3 50 ghz while the compressible took 27 7 h on 64 cores of the same processor showing comparable computational requirements 4 2 seakeeping a ship sailing in waves can be subjected to compressible wave loading effects due to slamming and green water phenomena in order to be able to effectively predict such loading the motion of the ship in waves must be accurately calculated to that end a seakeeping simulation is performed in this section where a kriso container ship kcs model is considered sailing in regular head waves wave characteristics ship speed and scale correspond to the c5 case from the tokyo workshop on cfd in ship hydrodynamics larsson et al 2015 where experimental results can be found as well model length is l p p 6 05 m breadth b 0 85 m and draught t 0 285 m a regular incident wave with wave length λ 11 84 m and wave height h 0 196 m is imposed using the stream function wave theory infinite depth is modelled by using a bottom boundary condition which mimics the remained of the fluid below the bottom boundary by imposing the wave velocity field at the boundary unstructured computational grid is used with 950 000 cells shown in fig 17 k ω sst turbulence model is used in this simulation wall functions are used on the ship s boundary while the average y is around 40 on the hull fluid structure interaction occurring between the wave field and the ship is resolved using an enhanced coupling algorithm gatin et al 2017 wave generation and absorption is performed using implicit relaxation zones which are placed at the inlet and outlet boundaries implicit algebraic vof method is used in this case as opposed to explicit isoadvector method permitting larger courant numbers since no violent free surface effects are expected the high resolution provided by isoadvetor is not necessary the inlet relaxation zone has a length of λ 2 while the outlet has a length of λ the domain boundaries are positioned 1 l p p in front of the fore perpendicular 2 l p p from the aft perpendicular 1 5 l p p from the side and 1 l p p from the free surface downwards a fixed time step is used resulting in 400 time steps per encounter wave period i e δ t 0 0046 seconds during the simulation the maximum courant number ranges between 9 and 18 the time signal of heave motion is shown in fig 18 where incompressible and compressible formulations are compared the two methods offer identical results in order to provide a quantitative comparison the last period of heave pitch and total resistance signals are transformed into frequency space via fft table 8 shows the comparison of zeroth and first order harmonic amplitudes and phase shift of the first order harmonic for heave z pitch ϕ and total resistance coefficient c t the present compressible and its counterpart incompressible models give very similar results confirming that the two models are equivalent when the compressibility effects are absent both results compare well to experimental results showing under 1 5 error for total resistance and up to 5 5 error for first order amplitudes of motion note that relative errors are not presented for phase shifts since they depend on the arbitrary choice of the incident wave phase shift the phase shifts differences range from 0 8 for heave motion to 4 for pitch motion in order to establish the overhead resulting from the compressible formulation the computational time is compared for the two approaches both simulations were carried out on desktop computers the incompressible simulation was performed on a intel core i5 3570k cpu at 3 40 ghz while the compressible one was performed on intel core i7 4820k cpu at 3 70 ghz it takes 4 7 h of computational time per one wave period with the incompressible version while it takes 3 6 h with the compressible formulation note that the computer used for the compressible simulations has superior processor characteristics thus the required computational resources are comparable between two formulations rendering the present approach relevant for industrial applications 5 breaking wave impact with a trapped air bubble this section presents the final test for the present model a violent breaking wave impact with a trapped air bubble presented by bullock et al 2007 an extensive experimental campaign was conducted where large scale regular wave impacts against a vertical and inclined wall were measured for this comparison a wave with height h 1 25 m period of t 8 s at calm water level depth of d c 1 m in front of the wall is selected which results in a high aeration impact bullock et al 2007 where a large air bubble is trapped between the wave front and the vertical wall the waves are travelling through water depth of 4 m before encountering a slope that reduces the depth to 1 m the experiments were conducted in a 350 m long 5 m wide and 7 m deep grosser wellenkanal at the forschungszentrum küste in hannover germany simulation is conduced in a 2d domain that included 121 metres in front of the vertical wall where the first 50 metres are the inlet relaxation zone where the regular waves are initialised another 54 m of the domain is included behind the wall to provide comparable conditions to the experiment where the wave was spilling over the wall the height of the domain is 8 m corresponding to the depth of the wave tank the bottom is placed at z 0 m while the undisturbed free surface level is at z 4 m the depth d c 1 m refers to water depth in front of the vertical wall i e on the top of the mound fig 19 shows the view of the simulation domain where the vertical wall and the slope are indicated the domain is discretised using 127 120 cells with refinement near the vertical wall presented on fig 20 isoadvector method is used for interface capturing roenby et al 2016 nonlinear stream function wave theory is used to initialise the wave field and impose the oncoming waves at the domain inlet relaxation zone the initial condition of the free surface is shown in fig 21 a fixed courant number of 0 9 is used in order to resolve the violent wave impact three wave periods are simulated where the third one resulted in a breaking event with a trapped air bubble it takes two wave periods for the reflected wave against the wall to interact with the oncoming waves creating a breaking event in front of the wall equivalent event was selected in the experimental results i e the first period that resulted in a breaking event with trapped air bubble due to the longer domain it took 5 periods in the experiment to obtain a breaking wave pressure acting on the vertical wall is measured at positions corresponding to the experimental set up the vertical positions in metres of pressure gauges at the wall with respect to the bottom of the wave tank are 3 49 3 65 3 74 3 90 4 04 4 20 4 39 4 55 4 70 4 74 4 90 4 94 5 10 5 14 5 30 5 54 5 70 and 5 89 in order to smooth out the noise present in pressure signals both in experiments and simulations the integral of pressure is compared the integral is calculated using the trapezoidal integration rule where pressure values from the pressure gauges are assumed to be constant in the transversal direction figs 22 and 23 show the impact of the breaking wave with trapped air in the simulation the initial air bubble separates into two parts where one travels upwards while the second remains trapped in the bottom corner during the impact after the impact the run up collapses creating a second breaking event travelling against incoming waves fig 24 shows the comparison of the force acting on the vertical wall during the impact against the measured force in the experiment the first peak after the impact agrees well with experimental measurements as well as the first pressure drop where sub atmospheric pressure is recorded resulting in a negative force from that point onwards around t 11 32 s the force measured in the experiments damps within another period of oscillation while in the simulation the pressure oscillation continues for another 7 8 periods there are several possible reasons for discrepancy in energy loss of the oscillating air bubble the simulation is 2d thus any 3d effects are not influencing the impact however from the report and videos of the experimental campaign it can be concluded that 3d effects did not play a significant role in the first impact in the simulation the wall and the surrounding structure are considered perfectly rigid i e no energy transfer is possible from the fluid to the structure according to bullock et al 2007 a significant structural response was noticed during the experiment where the impacts generated forces that caused both the caisson and the reinforced concrete walls of the channel to vibrate page 605 the transfer of energy from the wave to the caisson and the channel walls could be responsible for the damping of the bubble oscillation in the experiment the vertical wall had equally spaced holes bored through the entire thickness of the wall to permit the water level to equalise on both sides of the wall there were six columns of holes with three holes in each where the holes had a circular cross section with a diameter of around 10 cm fig 25 shows a photograph of the vertical wall where the holes are visible in an event of a breaking wave impact with trapped air the air could escape from the bubble through the holes due to the large pressure difference the escaping air would deflate the trapped bubble reducing the subsequent pressure oscillations the effect of holes will be examined in future studies by performing a 3d simulation with the exact geometry of the wall including holes from the structural response point of view the first force peak and through are more important than the force tail since they carry a large amount of energy due to high values acting on a large surface over an extended amount of time bullock et al 2007 thus the present approach proves to be accurate with this respect and can be used to accurately assess compressible wave impact loads 6 conclusion a two phase flow model with incompressible liquid and a compressible gas phase based on fv method intended primarily for various applications in marine engineering is presented in this paper the implementation is performed in the naval hydro pack software library based on foam extend cfd software the sharp change in fluid properties across the free surface is taken into account using the ghost fluid method where specialised discretisation schemes are developed for arbitrary polyhedral unstructured grids in this study the gfm is extended to take into account the jump in compressibility of the two phases allowing the liquid phase to be considered incompressible which avoids problems related with high speed of sound in water making the approach computationally inexpensive verification and validation of the present approach is conducted on a 1d liquid piston case a free fall impact of a horizontal water column and regular wave propagation the method proved to be accurate in capturing air compression and expansion effects compressible impacts and simple wave propagation where compressibility effects are negligible the aspect of industrial application of the method is tested on two test cases a green water loading case and container vessel seakeeping in regular head waves the method shows good correspondence with experimental results for both cases while showing equivalent computational demands to its incompressible counterpart finally the ability of the method to capture wave impacts with trapped air effects is tested by comparing the simulation results to a large scale experimental campaign the present approach managed to reproduce the force peak exerted on a vertical wall whereas the force oscillation after the first peak is overestimated the possible reasons for the underestimated energy dissipation of the trapped air bubble oscillation will be studied in the future where the most likely cause of discrepancy are the holes in the vertical wall present in the experiment which were not modelled in the simulation the air bubble can deflate through these holes damping the pressure oscillation overall the present approach accurately and precisely models compressibility effects in two phase flows characteristic for marine engineering the method also proved to be applicable to realistic industrial cases with unstructured body fitted grids and wave induced body motion without an overhead in computational time future study will be focused on studying compressible breaking wave impacts in more details acknowledgements the numerical research performed for this study was sponsored by bureau veritas paris france under the administration of dr šime malenica and dr quentin derbanne the authors would like to acknowledge prof c obhrai from university of stavanger norway for providing access to experimental data related to breaking wave impacts appendix numerical model in this section the complete numerical model developed in this study is presented first discretisation of governing equations will be outlined creating a basis for further development of numerical operators which satisfy the jump conditions implementation of all operators requiring jump conditions is also described a 1 discretisation of governing equations collocated fv method is used to discretise governing equations eqs 17 16 and 15 jasak and gosman 2001 the notation in the following text adheres to vukčević et al 2017 as shown in fig a 1 s f is the surface area vector of a face while d f stands for the vector from cell centre p to cell centre n where p and n represent two adjacent cells that share a face terms enclosed in curly braces indicate that implicit fv discretisation is used while explicit evaluation is used for the remaining terms for details on fv discretisation used in foam extend the reader is directed to jasak 1996 and rusche 2002 the discretised form of eq 17 states a 1 u t u u 1 ρ u μ e 1 ρ μ e u 1 ρ p d 1 α i 1 ρ c ρ c g x u u as stated in section 2 4 temporal and viscous terms are continuous across the interface and do not require special treatment convection dynamic pressure gradient density gradient and u u terms require special treatment when calculated across the interface for the conservation of mass eq 16 the discretised form can be written as a 2 u 1 α i 1 ρ c ρ c p p d t p d u p d u ρ c g x t u ρ c g x due to the discontinuities across the free surface all terms in eq a 2 require special treatment the pressure equation is obtained from eq a 2 following jasak 1996 discretised left hand side of conservation of mass eq a 2 in integral form reads a 3 c v u d v c v d s u f s f u f where c v stands for the control volume v is the cell volume f is the control volume face index d s is the infinitesimal surface normal vector while s f stands for the face area vector cell centred velocity is expressed by using the semi discretised form of the momentum equation jasak 1996 a 4 u p h u n a p 1 ρ a p p d ρ g x where a p denotes the summed diagonal coefficient for cell p while h u n represents a linearised operator containing off diagonal and source contribution resulting from the discretisation of implicit velocity operators in order to substitute face centred velocity u f using eq a 4 it must be interpolated to cell faces a 5 u f h u n f a p f 1 a p f 1 ρ f γ p d f γ ρ f γ g x where index f γ denotes terms that need special attention across the interface by substituting eq a 5 into eq a 3 the discretised conservation of mass can be written as a 6 f s f 1 a p f 1 ρ f γ p d f γ f s f h u n f a p f 1 ρ f γ ρ f γ g x c v f c p d ρ d v where a 7 f c p d ρ 1 α i 1 ρ c ρ c p p d t p d u p d u ρ c g x t u ρ c g x below is a summary of all terms in eqs a 1 a 6 and a 7 with comments on their treatment at the free surface 1 from the momentum equation eq a 1 u t is a cell centred temporal derivative operator for the velocity field which is continuous across the interface no special treatment is needed u u generally has a jump across the interface as indicated in eq 24 which needs to be taken into account 1 ρ u μ e is continuous across the interface due to the assumptions made on the viscosity across the interface except for the 1 ρ term however since the present method takes into account the discontinuity of ρ the cell centred value which is used in this term will be exact i e it will not be smeared instead either the value corresponding to liquid will be used or the value corresponding to gas near the interface therefore although this term has a jump it requires no special attention in the numerical implementation of operators μ e u has no special treatment in this study due to assumptions of continuous viscosity field 1 ρ p d has a jump across the free surface as shown in eq 24 which needs to be accounted for in the explicit operator 1 ρ c ρ c g x is discontinuous since ρ has a discontinuity across the interface and because the gradient of density is zero in the incompressible phase while in the compressible phase it can be non zero thus the explicit density gradient operator needs special treatment at the interface u u is discontinuous across the interface since u is discontinuous as indicated in eq 26 2 from the conservation of mass eq a 6 1 a p f is the inverse diagonal coefficient of the momentum equation interpolated on cell faces it is continuous across the interface and can be interpolated using ordinary linear interpolation 1 ρ f γ is the inverse of the density field interpolated on faces due to discontinuity of density across the interface interpolation cannot be performed linearly p d f γ is an implicit surface normal gradient operator which requires special treatment across the interface due to the jump condition stated in eq 24 this term is a part of the pressure laplacian operator and will be analysed in the remainder of the text h u n f arises from the off diagonal and source contribution of terms in the momentum equation since h u n f is a function of velocity which is continuous across the interface it requires no special attention during interpolation ρ f γ is an explicit surface normal gradient operator of density since neither density nor gradient of density are continuous across the interface special attention is needed f c p d ρ contains 1 α i rendering it inactive in the incompressible phase thus the entire term has a jump over the interface in order to handle the jump consistently the term is set zero for all cells where α i 0 5 i e for all dry cells appendix a 2 while the 1 α i term is removed even though the term is not active in the incompressible phase operators within the term require compact stencil information requiring special attention at the interface 3 from eq a 7 which is active only in the compressible phase p d t is a cell centred operator requiring no compact stencil information however due to the jump of p d across the interface eq 21 the term requires special attention in the case when the interface crosses a cell centre in time i e when an incompressible cell becomes compressible note that the opposite case is not relevant due to the multiplication of the whole term with 1 α i p d u represents convection of dynamic pressure due to the jump of dynamic pressure across the interface the term requires special treatment across the interface p d u term contains a two fold discontinuity at the interface both p d and u are discontinuous however p d is a cell centred value and since the present method resolves a sharp p d field no special attention is needed u requires special attention as indicated earlier ρ c g x t presents a temporal change of hydrostatic pressure it requires special attention when an incompressible cell becomes compressible u ρ c g x contains cell centred gradient of density which needs special attention near the interface due to the discontinuity of density and density gradient in the following section the gfm interpolation is described while appendix a 3 presents a detailed analysis of discretisation of terms requiring special attention at the interface as listed above a 2 the ghost fluid method in gfm mathematical operations for cells that are close to the interface are performed by extrapolating the fields to the cells across the interface the computational stencil is never in two phases at once which is achieved by treating the cells in the other phase as ghost cells of the same phase this prevents the errors that occur when interpolation across the interface is performed using second or higher order accuracy where the true shape of the gradient containing a step change is not accounted for the discontinuity of variables across the interface presents a singularity in the gradient which is numerically difficult to treat detailed description of the gfm is shown in vukčević et al 2017 while the basic notation is repeated here for convenience since this study deals with a combination of an incompressible liquid and a compressible gas phase the cells occupied by water will be referred as wet cells while those occupied by air dry cells wet and dry cells are detected using the vof liquid fraction field representing the incompressible phase cell p is considered wet if α i 0 5 and vice versa the second order accurate fv method which is used in this study is characterised by a compact computational stencil meaning that only the cells sharing a face with cell p will be used to evaluate discretisation operators therefore only the cells that are the closest to the interface will require special attention a face between a wet and a dry cell is called interface face any interpolation on the interface face requires special treatment if the interpolated field contains a discontinuity in this study dynamic pressure and density fields are extrapolated using the gfm while the jump in velocity operators is taken into account through volumetric flux discontinuity see appendix a 3 7 two scenarios need to be covered when extrapolating a general scalar variable ϕ using gfm first when the owner cell p is wet and neighbour cell n is dry and second when the owner cell p is dry and n is wet extrapolation starts by assessing the values on both sides of the interface denoted as ϕ and ϕ which are governed by the jump conditions once ϕ and ϕ are calculated they are used to extrapolate cell centred values across the interface with the following expressions vukčević et al 2017 p is wet and n is dry a 8 ϕ n γ ϕ 1 λ λ ϕ ϕ p a 9 ϕ p γ ϕ λ 1 λ ϕ ϕ n p is dry and n is wet a 10 ϕ n γ ϕ 1 λ λ ϕ ϕ p a 11 ϕ p γ ϕ λ 1 λ ϕ ϕ n here ϕ n γ indicates the extrapolated value in cell n of the variable ϕ on the liquid side it will be used to interpolate values at the interface face between cells p and n when performing the operations for wet cell p ϕ p γ ϕ n γ and ϕ p γ have analogue meanings λ stands for a dimensionless distance between cell centre p and location of the interface along vector d f connecting the two cell centres for details see vukčević et al 2017 in the vof framework it is calculated as a 12 λ α p 0 5 α p α n in this study extrapolation of dynamic pressure using gfm described in vukčević et al 2017 is extended by taking into account the altered jump conditions expressed by the right hand side of eq 25 in the following text the gfm extrapolation derived in vukčević et al 2017 is repeated for convenience followed by the extension for incompressible compressible two phase flow a 2 1 dynamic pressure extrapolation for incompressible flow in order to extrapolate the dynamic pressure to cell centres across the interface using eqs a 10 and a 11 values p d and p d must first be determined discretising eq 23 and using eq 21 expressions for p d and p d are obtained see vukčević 2016 for full derivation p is wet and n is dry a 13 p d λ β β w p d n 1 λ β β w p d p λ β β w h a 14 p d λ β β w p d n 1 λ β β w p d p λ β β w h p is dry and n is wet a 15 p d λ β β d p d n 1 λ β β d p d p λ β β d h a 16 p d λ β β d p d n 1 λ β β d p d p λ β β d h where the following substitutions are used to adhere to vukčević et al 2017 a 17 β 1 ρ a 18 h p d p d p d ρ ρ g x γ a 19 β w λ β 1 λ β a 20 β d λ β 1 λ β where x γ denotes the radii vector of the intersection of vector d f and the free surface see fig a 2 substituting eqs a 13 a 16 to eqs a 8 a 11 extrapolated dynamic pressure values can be expressed in terms of cell centred values p is wet and n is dry a 21 p d n γ β β w p d n 1 β β w p d p β β w h a 22 p d p γ β β w p d p 1 β β w p d n β β w h p is dry and n is wet a 23 p d n γ β β d p d n 1 β β d p d p β β d h a 24 p d p γ β β d p d p 1 β β d p d n β β d h extrapolated values defined by eqs a 21 to a 24 are used in the discretisation of dynamic pressure gradient for cells next to the interface which will be shown in detail later they are used in following cases vukčević et al 2017 p d n γ used when p is wet n is dry for the discretisation of cell p p d p γ used when p is wet n is dry for the discretisation of cell n p d n γ used when p is dry n is wet for the discretisation of cell p p d p γ used when p is dry n is wet for the discretisation of cell n a 2 2 dynamic pressure extrapolation for incompressible compressible flow in appendix a 2 1 expressions for the gfm interpolation of the dynamic pressure across the interface are given for the case when both phases divided by a sharp interface are incompressible these expressions will serve as a basis for the numerical model developed in this study where the liquid phase is considered incompressible while the gas phase is considered compressible in order to derive the expressions for the dynamic pressure for incompressible compressible two phase model eq 25 is discretised and combined with eq 21 to obtain p d and p d values near the interface the derivation is performed in the same fashion as for the incompressible mixture shown in vukčević et al 2017 vukčević 2016 the resulting expressions are as follows p is wet and n is dry a 25 p d λ β β w p d n 1 λ β β w p d p λ β β w h d f λ 1 λ β w u u u u λ β β w ρ n ρ g x a 26 p d λ β β w p d n 1 λ β β w p d p λ β β w h d f λ 1 λ β w u u u u λ β β w ρ n ρ g x p is dry and n is wet a 27 p d λ β β d p d n 1 λ β β d p d p λ β β d h d f λ 1 λ β d u u u u 1 λ β β d ρ ρ p g x a 28 p d λ β β d p d n 1 λ β β d p d p λ β β d h d f λ 1 λ β d u u u u 1 λ β β d ρ ρ p g x additional terms occurring in eqs a 25 a 28 are proportional to effects of compressibility in the gas phase the term u u represents the jump in the convection term from the momentum equation which is intentionally left under the jump operator since it is calculated indirectly using volumetric flux jump see appendix a 3 7 the term u u represents transport of velocity divergence on the compressible side of the interface it will be shown later that first order assumption is made in evaluation of this term where the value calculated at the dry cell centre will be used the last term is proportional to the gradient of hydrostatic pressure caused by the change of density of the compressible phase in space all three additional terms vanish in case when compressibility effects are negligible which renders the method effective in low mach conditions without volumetric compressibility effects without these three terms eqs a 25 a 28 correctly reduce to their incompressible counterparts eqs a 13 a 16 as shown later in the paper this permits running complex flow simulations including large time scale wave evolution and small time scale volumetric compressibility effects in a single run without the need of interchanging incompressible and compressible flow models substituting eqs a 25 a 28 into eqs a 8 a 11 extrapolated dynamic pressure values are expressed in terms of cell centred values p is wet and n is dry a 29 p d n γ β β w p d n 1 β β w p d p β β w h d f 1 λ β w u u u u β β w ρ n ρ g x a 30 p d p γ β β w p d p 1 β β w p d n β β w h d f λ β w u u u u λ β 1 λ β w ρ n ρ g x p is dry and n is wet a 31 p d n γ β β d p d n 1 β β d p d p β β d h d f 1 λ β d u u u u 1 λ β λ β d ρ ρ p g x a 32 p d p γ β β d p d p 1 β β d p d n β β d h d f λ β d u u u u β β d ρ ρ p g x cell centred extrapolation of dynamic pressure expressed with eqs a 29 a 32 is used for discretisation in the same manner as for the incompressible two phase flow depending on whether p is dry or wet and from which cell the discretisation is being carried out the corresponding expression is used see appendix a 2 1 a 2 3 density extrapolation for incompressible compressible flow apart from dynamic pressure extrapolation the density field must also be extrapolated using the gfm in order to correctly evaluate the discontinuous gradient of density in order to extrapolate the density field using eqs a 8 a 11 values close to the interface in both phases ρ and ρ must be determined since the liquid phase is considered incompressible its density is constant in space and time i e ρ ρ i c o n s t on the other hand density in the gas phase is not known and must be calculated pressure and density of the gas phase are related by eq 10 if p is known ρ can easily be calculated as a 33 ρ p a c 1 γ p d ρ g x a c 1 γ where eq 7 is employed to substitute p note that eq a 33 is nonlinear with respect to ρ the nonlinearity can be avoided by remembering that p p eq 20 a 34 ρ p a c 1 γ p d ρ g x a c 1 γ where ρ is constant in order to calculate ρ p d must first be evaluated using eq a 25 or eq a 27 depending on whether cell p is wet or dry note that eqs a 25 and a 27 depend on ρ themselves requiring a nonlinear loop in order to converge once ρ is determined it can be used to extrapolate the density of the gas phase across the interface to the wet cell centre using eqs a 9 and a 10 extrapolating density of the liquid phase is not necessary since ρ i c o n s t a 3 interface corrected discretisation schemes in appendix a 1 implications of the jump conditions on individual terms from the governing equations are analysed in this section discretisation of each of these terms that require special attention on the interface is presented there are three distinct groups of operators that need to be addressed 1 temporal terms when a cell switches to compressible from incompressible from one time step to another special treatment needs to be applied in order to prevent unphysically large temporal change 2 scalar gradient terms both cell centred and face normal gradients of dynamic pressure and density need to be addressed where gfm extrapolation shown in appendix a 2 will be used while cell centred gradients are explicit face normal gradient of dynamic pressure is implicit since it is a part of the implicit pressure laplacian operator special attention will be given to this term 3 velocity operators convection and divergence of velocity are handled using volumetric flux jump that arises from the pressure equation both implicit and explicit versions of the convection operator need to be devised while the divergence operator is always explicit a 3 1 dynamic pressure temporal derivative discretisation temporal derivative of density and dynamic pressure contains a singularity for cells that change phase due to the motion of the interface within a time step since both terms exist only in the compressible phase only the scenario when the cell changes from the incompressible to compressible phase needs to be addressed in the opposite case the temporal change is simply zero due to incompressibility temporal derivative of dynamic pressure can be discretised using the implicit first order euler method as a 35 p d t p d n p d o δ t where n stands for the current time step value and o for the old time step value for cells that were wet in the old time step and are dry in the current termed new dry cells hereafter dynamic pressure jump eq 21 needs to be added to the old time step value a 36 p d t γ p d n p d o ρ i ρ c g x δ t the new dry cells are marked using the following criteria a 37 α i o α i n 0 5 note that the density from the compressible phase is not present in the previous time step and current time step value is used instead since the density difference between air and water which are relevant for marine applications is four or more orders of magnitude larger than the temporal change in air density this assumption has a negligible influence on accuracy in order to achieve second order accuracy in time backward scheme is used a 38 p d t 1 δ t 3 2 p d n 2 p d o 1 2 p d o o where p d o o stands for the dynamic pressure from the second last time step before the current one in this case there are three possible combinations that require special treatment due to conditions in the dynamic pressure n corresponds to a dry cell while o and o o correspond to a wet cell in this case a jump must be added in dynamic pressure for both o and o o values of dynamic pressure a 39 p d t γ 1 δ t 3 2 p d n 2 p d o ρ i ρ c g x 1 2 p d o o ρ i ρ c g x n and o correspond to a dry cell while o o correspond to a wet cell in this case dynamic pressure value from o o must be corrected a 40 p d t γ 1 δ t 3 2 p d n 2 p d o 1 2 p d o o ρ i ρ c g x n and o o correspond to a dry cell while o corresponds to a wet cell here p d o needs to be corrected a 41 p d t γ 1 δ t 3 2 p d n 2 p d o ρ i ρ c g x 1 2 p d o o in the case when p d n corresponds to a wet cell no special treatment is necessary since the temporal change of dynamic pressure is not assessed for the incompressible phase also if the cell has been dry during the last three time steps no special treatment is needed since no jump in dynamic pressure occurred a 3 2 density temporal derivative discretisation another temporal derivative term that needs special treatment is the rate of change of ρ in time for the incompressible phase this term is zero and requires no special attention in cases when a wet cell becomes a dry special treatment is needed in order to assess the temporal change of density in cells for which old time step density values are not available eq 5 is utilised a 42 ρ t γ ρ u u ρ where terms on the right hand side are evaluated using the jump conditions as described in the following text eq a 42 can be used in this manner since ρ is not implicitly solved for instead it is calculated using the equation of state eq 10 a 3 3 discretisation of dynamic pressure gradient term explicit cell centred gradient operator for dynamic pressure can be written in the following form using the gauss theorem jasak et al 2015 a 43 p d 1 v p c v p d d v 1 v p c v p d d s 1 v p f s f p d f where p d f stands for the face interpolated dynamic pressure which requires special attention at the interface by using a central differencing interpolation dynamic pressure gradient for cell p reads a 44 p d p 1 v p f s f f x p d p 1 f x p d n where f x is the interpolation weight for central differencing defined as f x f n p n where f n denotes a vector from cell centre p to face centre f while p n is the vector connecting the two cell centres f denotes summation over cell faces for interface cells the sum over cell faces need to be separated for ordinary and interface faces since interface faces require special attention a 45 1 v p f γ s f f x p d p 1 f x p d n γ where denotes the sum over ordinary faces while f γ stands for the sum over interface faces p d n γ presents the extrapolated dynamic pressure value obtained using eq a 29 or a 31 depending on whether p is wet or dry respectively for the gradient calculated in the neighbour cell n across the interface equivalent expression is used where extrapolated values for p d p γ are used instead a 3 4 discretisation of the density gradient term interface corrected explicit cell centred density gradient is discretised in the same manner as the dynamic pressure gradient shown in appendix a 3 3 a 46 1 v p f γ s f f x ρ p 1 f x ρ n γ note that ρ n γ is used instead of ρ n γ since the gfm extrapolation will be used only from the dry side as the gradient of density is zero in the incompressible phase ρ n γ is determined using eq a 10 in conjunction with eq a 34 when discretising terms for a dry cell n eq a 9 is used to determine ρ p γ a 3 5 discretisation of the pressure laplacian term the term on the left hand side of eq a 6 represents the pressure laplacian term and requires special attention for incompressible two phase flow the implicit treatment is achieved by extrapolating the dynamic pressure values with respect to cell centred values using eqs a 21 a 24 it is shown by vukčević et al 2017 that for incompressible two phase flow the pressure equation remains symmetric notwithstanding the jump conditions for the incompressible compressible mixture the extrapolated values have additional terms see eqs a 29 a 32 which are explicit with respect to dynamic pressure while the implicit portion remains unchanged thus the implicit interface corrected pressure laplacian developed by vukčević et al 2017 is supplemented with the explicit sources due to jump of compressibility across the interface the implicit portion of the jump conditions remains symmetric however the pressure equation is no longer symmetric due to implicit treatment of dynamic pressure convection the explicit compressible jump conditions are also not symmetric which leads to a jump in the source of the pressure laplacian as shown below the pressure laplacian left hand side of eq a 6 is discretised as a 47 f s f 1 a p f β f γ p d f γ f 1 a p f β f γ s f p d n p d p γ d f f k 1 a p f β p d f o where k stands for the non orthogonal correction vector which is obtained using the over relaxed approach jasak 1996 the second term on the right hand side is explicit and contributes to the source of the pressure laplacian and the respective conservative flux the first term is implicit face normal gradient contribution which requires special treatment due to jump conditions note that eq a 47 holds no assumptions on the compressibility of either of the phases thus it is identical to the expressions in vukčević et al 2017 for a wet interface cell p the first term on the right hand side can be divided into two sums f 1 a p f β f γ s f p d n p d p γ d f a 48 f γ 1 a p f β f γ s f p d n γ p d p d f to examine the contribution of one interface face for the mixture of compressible and incompressible fluid the second sum is expanded by substituting p d n γ with eq a 29 a 49 1 a p f β f γ s f p d n γ p d p d f 1 a p f s f d f β β β w p d n p d p h d f 1 λ β u u u u ρ n ρ g x where β f γ is replaced with β since the density in the liquid phase is constant the last two terms in eq a 49 arise from the compressible jump conditions while the first three correspond to the implicit jump condition and the explicit hydrostatic jump condition which are the same as for the incompressible two phase flow the treatment and matrix contribution of the implicit and hydrostatic jump conditions is shown in details by vukčević et al 2017 and will not be repeated here instead only the source contribution from the compressible portion of the jump condition will be examined in detail the compressible portion of the source contribution for a wet p cell can be written as a 50 s p 1 a p f s f d f β β β w d f 1 λ β u u u u n ρ n ρ g x as mentioned earlier the term u u is the jump in the convection term which is calculated using the volumetric flux jump see below the term u u is replaced with u u n i e first order accurate evaluation of this term is used by writing the equivalent of eq a 48 a 50 for the neighbouring dry cell n and employing eq a 30 the source contribution for cell n is expressed as a 51 s n 1 a n f s f d f β β β w d f λ β u u u u n λ 1 λ ρ n ρ g x where β f γ is replaced with β assuming first order accuracy since β c o n s t unlike the implicit and hydrostatic part of the pressure laplacian the compressible jump conditions result in asymmetric source terms since s p s n in other words interface cells p and n will have a different source contribution from the same face equations for a dry p and wet n cell can be derived analogously to above equations and will be omitted for sake of brevity a 3 6 discretisation of surface normal density gradient term as described in appendix a 1 eq a 6 requires explicit evaluation of the surface normal density gradient on cell faces ordinary second order accurate discretisation of this term assuming orthogonal grid reads a 52 ρ f ρ n ρ p d f for non orthogonal grids an explicit correction is applied similarly as described in appendix a 3 5 for interface faces gfm extrapolation is used in order to correct for the jump in density for a wet cell p the following expression is used a 53 ρ f γ ρ n γ ρ p d f while for a dry cell n the surface gradient reads a 54 ρ f γ ρ n ρ p γ d f here ρ n γ and ρ p γ are determined as described in appendix a 3 4 above expressions take into account the jump in density when evaluating surface normal gradient of the density field however the jump in the gradient itself is handled through the discretisation of the pressure laplacian due to the third term on the right hand side of eq 25 see appendix a 3 5 for details in other words the surface normal density gradient is not unique for interface faces instead wet and dry cells will get different contributions from this term wet cells will have no equivalent contribution since the density gradient is zero in the incompressible phase while the dry cell contribution can be non zero a 3 7 volumetric flux jump using eq a 5 volumetric flux for face f can be written as a 55 f f s f u f s f h u n f a p f s f n f 1 a p f β f γ p d f γ ρ f γ g x where n f denotes face normal vector evaluation of volumetric flux must be corrected at the interface since both face normal dynamic pressure and density gradients in eq a 55 are discontinuous looking from the wet cell p side the volumetric flux on an interface face reads f f γ p s f u f a 56 where the density gradient vanishes due to incompressibility of the liquid phase substituting p d n γ with eq a 29 yields a 57 f f γ p s f h u n f a p f s f n f 1 a p f β β β w 1 d f p d n p d p h d f 1 λ β u u u u ρ n ρ g x looking from the dry cell n side the volumetric flux on an interface face reads a 58 f f γ n s f u f s f h u n f a p f s f n f 1 a p f β p d n p d p γ d f ρ n ρ p γ d f g x substituting p d p γ with eq a 30 and ρ p γ with eq a 10 yields a 59 f f γ n s f h u n f a p f s f n f 1 a p f β β β w 1 d f p d n p d p h d f λ β u u u u ρ n ρ g x comparing eqs a 57 and a 59 it follows that the flux on the same face has a different magnitude depending on whether the discretisation is performed from the side of cell p or cell n this means that there is a volumetric flux jump equal to a 60 f f f f γ p f f γ n s f n f 1 a p f β β w d f d f u u u u the jump of volumetric flux should be taken into account in convection and divergence terms by correcting the face interpolated fluxes with eq a 60 note that the jump in flux is present only numerically across the interface face since the ghost cells change the actual phase of the opposing cell physically the flux jump across the interface is zero due to eq 22 consequently the velocity itself has no jump for cell centred operations in order to clarify the meaning of the volumetric flux jump fig a 3shows a schematic representation of a one dimensional liquid piston case discretised with five control volumes cells there is no mass or heat flux through domain boundaries the bottom two cell centres are denoted with p and n the vertical piston is divided into three layers where two pockets of air top and bottom are separated by a layer of water the water moves downwards under the influence of gravity compressing the bottom air pocket while expanding the top one at the bottom part of the piston the interface is located somewhere between cell centre p and face f 2 the interface denoted by γ in the figure moves with velocity u f since water is modelled as incompressible velocity at face f 1 must be equal to the interface velocity to satisfy the continuity equation for cell p the continuity equation can be discretised as a 61 u p 1 v p c v u d v 1 v p c v n u d s 1 v p f s f n f u f 1 v p s f 1 n f 1 u f 1 s f 2 n f 2 u f 2 0 where the remaining faces of cell p have no contribution since the flux is zero the above equation yields the following condition a 62 u f 1 u f 2 since a 63 s f 1 s f 2 a 64 n f 1 n f 2 a 65 n f 1 u f 1 u f 1 a 66 n f 2 u f 2 u f 2 eq a 62 states that the velocity i e volumetric flux on face f 2 must be equal to the one on f 1 in order to satisfy the continuity equation for cell p however from the physical point of view the flux through the imaginary face f 2 is not equal to the flux across f 1 due to the compression of air phase between the interface and face f 2 the jump in flux described by eq a 60 handles this difference by applying a correction which is proportional to the divergence of velocity in the air phase the correction fills the space between the interface and face f 2 with water as well as cell n looking from the air side a similar correction is applied filling the space between the interface and face f 1 with air in order to correctly calculate the flux on face f 2 note that the magnitude of the correction is affected by the actual position of the interface due to term β β w in eq a 60 the closer the interface to cell p the larger the correction a 3 8 discretisation of the dynamic pressure convection term convection of dynamic pressure in eq a 7 is implicit with respect to dynamic pressure it has a two fold discontinuity across the interface due to the discontinuity of the convective flux see appendix a 3 7 and the discontinuity in dynamic pressure prescribed with eq 21 ordinary second order accurate discretisation for cell p using gauss theorem states a 67 u p d p 1 v p c v u p d d v 1 v p c v p d d s u 1 v p f s f u f p d f 1 v p f f f p d f where f f denotes volumetric face flux dividing the sum over all cell faces for interface cells yields a 68 1 v p f γ f f p γ f x p d p 1 f x p d n γ where f f p γ stands for the interface face volumetric flux that contains the jump arising from jump conditions in eq 25 see eq a 57 for cell n f f p γ is used instead note that convection of dynamic pressure term is active only in the compressible gas phase rendering extrapolation from the incompressible phase unnecessary therefore p d n γ is used instead of p d n γ in the above expressions a 3 9 discretisation of velocity convection term velocity convection term in the momentum equation eq 17 is treated implicitly ordinary fv discretisation states a 69 u u p 1 v p c v u u d v 1 v p c v n u u d s 1 v p f s f u f u f 1 v p f f f u f dividing the sum over all cell faces for interface cells yields a 70 1 v p f γ f f p γ f x u p 1 f x u n apart from the implicit convection term the explicit interface jump u u of convection also needs to be defined for an interface face dividing cell p and cell n the jump can be written as a 71 u u 1 v p f f p γ f x u p 1 f x u n 1 v n f f n γ f x u p 1 f x u n 1 v p f f p γ 1 v n f f n γ f x u p 1 f x u n where f f p γ and f f n γ are defined by eqs a 57 and a 59 note that u u and the volumetric flux jump are interdependent and require nonlinear iterations to converge since the jump also depends on the solution of the pressure equation the algorithm relies on the segregated solution procedure to couple the pressure and momentum equations and to converge the jump conditions a 3 10 discretisation of the velocity divergence term divergence of velocity is discretised as a 72 u p 1 v p c v u d v 1 v p c v d s u 1 v p f s f u f 1 v p f f f for interface cells the sum is divided for internal and interface faces a 73 where f f n γ is used for the neighbouring interface cell n 
22187,position force control of an intervention autonomous underwater vehicle i auv is essential to many underwater intervention tasks e g marine equipment maintenance underwater welding and so on and is challenging due to unknown fluid disturbances and model uncertainties this paper applies the sliding mode impedance control smic to the full contact intervention of an i auv from non contact phase to contact phase both computational simulations and practical experiments are conducted to investigate the performance of smic in simulations considering model uncertainties and detailed fluid disturbances accurate position and force tracking can be achieved with the position tracking errors within 3 10 3m and a root mean square error rmse of 4 10 2n in tracking the desired contact force of 10n for the purpose of experimental validation the smic is implemented on an i auv developed in the university of technology sydney uts the experimental results demonstrate the smic s good performance in the contact intervention of the i auv with the position tracking errors within 1 6 10 2 m and a rmse of 0 97n in maintaining the desired contact force of 10n keywords i auv contact intervention force control position control 1 introduction with the development of intervention autonomous underwater vehicles i auvs in the last few decades the demand for accuracy robustness and efficiency in i auv s underwater intervention tasks is ever increasing most of the intervention tasks such as maintenance of ships and subsea pipeline underwater welding oil and gas searching require the end effector ee of the manipulator mounted on an autonomous underwater vehicle auv to contact and interact with the underwater object or environment heshmati alamdari et al 2017 where the accurate interaction control of the ee is highly desired however an i auv operated underwater may be exposed to an unknown operation environment where the fluid disturbance and the object interacted with are normally unknown or difficult to be measured or estimated in addition an i auv is usually a complex system with model uncertainties and inaccurate control signals obtained using the uncertain model can badly affect the ee s performance in both position and contact force tracking motivated by the demands and challenges stated above significant research efforts have been made in auvs and robotic intervention for the first time the alive project evans et al 2003 achieved the field demonstration of underwater robotic intervention where an auv docked to a subsea panel and performed valve turning this is followed by the triton project palomeras et al 2014 in which the similar fixed base underwater manipulations were presented then the sauvim project marani and yuh 2014 first demonstrated the underwater intervention by a hovering vehicle where an i auv grasped and recovered an object from the seabed next in the trident project simetti et al 2014 the girona500 vehicle was used to perform multipurpose intervention i e underwater object search and recovery finally the maris project simetti et al 2017 presented the experimental demonstration of object recognition and collection using a customized three finger gripper the projects listed above mainly focused on the intervention tasks such as valve manipulation and object recovery where the accurate position control of ee on a docked or hovering auv was highly desired e g control an ee to approach and grasp an underwater object although force torque sensors were used on some i auvs but they were only for the purpose of contact detection which assisted with manipulating or grasping an object jamali et al 2015 simetti et al 2017 there are rare projects focusing on the field demonstration of an intervention task that requires both accurate position and contact force control at the ee of an i auv such as subsea pipe inspection cieslak and ridao 2018 however some research works with computational simulations are available in the literature in cui et al 1999 the impedance control ic was applied on an underwater vehicle manipulator system uvms to achieve position force control at ee then authors in farivarnejad and moosavian 2014 proposed a multiple ic scheme for a dual manipulator of an auv in antonelli et al 2001 gierlak and szuster 2017 and taira et al 2018 various force controllers were demonstrated for contact interventions of i auvs although the above methods are promising they do not take the fluid disturbances and or model uncertainties into account assuming still water operating environments in simulations in heshmati alamdari et al 2016 2017 robust control methods were proposed for an uvms interacting with underwater environment considering the fluid disturbances as small forces i e less than 0 15 n acting on the vehicle body however the above fluid disturbances considered in simulations are not realistic in practice as the fluid usually disturbs both the vehicle body and manipulator of an uvms in the form of velocities and accelerations as a kind of position force control scheme the parallel control closes position and force loops in all task space directions however the closed loops are not decoupled which causes mutual disturbance of position and force variables during the transient from the non contact stage to the contact stage antonelli 2018 the hybrid position force control can structurally decouple the force and position controllers and thus can achieve both force and motion control of a manipulator however this control scheme neglects the mechanical work between the system and environment cui and yuh 2003 which makes it challenging to achieve smooth contact against the environment the position force control of an i auv normally involves three phases namely unconstrained or non contact phase transient phase and constrained or contact phase cui and yuh 2003 where the unconstrained phase indicates the stage before the contact happens constrained phase refers to the stage that the ee maintains contact with the environment and the transient phase is the instantaneous moment from unconstrained phase to constrained phase a smooth contact during the transient phase is highly required to avoid the force surge in contact which poses challenges to the controller design of a manipulator with base fixed on the ground let alone an i auv with hovering body subjected to external disturbance and interaction force from the environment thus for contact intervention of i auvs most existing control methods are verified through simulations and experimental results addressing the control across all three phases are rarely available in barbalata et al 2018 a position force sliding mode sm controller was proposed for an underwater manipulator with experimental data for validation however the work focuses on the scenario where the manipulator s base is fixed above the waterline for i auvs the experimental validation of position force control was presented in heshmati alamdari et al 2018 however the method can only achieve the intervention at constrained phase considering that the ee has already contacted with the environment before the implement of control the first and only documented experimental example of autonomous underwater hovering intervention with contact force control across all three phases was recently presented in cieslak and ridao 2018 the work combined a task priority tp kinematic control method with ic method to achieve simultaneous tracking of ee configuration and contact force against an pipe in still water however due to the detection error between ee and the pipe a desired path on a virtual pipe inside the real pipe was used to ensure the contact and thus the path tracking performance was not able to be evaluated in addition as reported because of the manipulator used and poor velocity control of the vehicle i e girona500 i auv in heave direction the overall performance of the system was severely limited therefore up to now the position force control for the contact interventions of i auvs remains a challenging problem that has not yet been effectively addressed in this work we propose to apply the sliding mode impedance control smic method in the position force control of an i auv which is expected to conduct intervention task against underwater structures our contributions are threefold performance verification of smic in the underwater intervention of an i auv in computational simulations considering both fluid disturbances and model uncertainties achievement of both position and force control at the ee of an i auv across all three intervention phases i e from non contact phase to contact phase real time experimental validation of underwater intervention on an i auv consist of an underwater vehicle and an ee the paper is organized as follows section 2 describes the i auv system models including frame definition kinematic model and dynamic model the control methodology is presented in section 3 simulation and experimental results are presented in section 4 and section 5 respectively then discussions for experiments are provided in section 6 finally conclusions are given in section 7 2 mathematical modeling in this work to comprehensively represent an i auv s dynamic behaviors subjected to underwater environment an i auv dynamic model using kane s method is built for simulation compared with newton euler n e and euler lagrange e l methods that are most commonly used in i auv modeling kane s method is more direct in eliminating the link interaction forces associated with the n e method and in avoiding the need to develop an energy function associated with the e l method tarn et al 1996 in this section the frame definition of mathematical modeling is firstly given then the i auv modeling is presented including a kinematic model and a full dynamic model used for computational simulations finally without considering the fluid effects a simplified dynamic model of i auv is presented which is applied in the design of controller for both computational simulations and real world experiments 2 1 frame definition for system modeling without loss of generality an i auv can be decomposed into n 1 links associated with different coordinate frames in fig 1 where the vehicle is represented by link 0 and the manipulator is composed by n links and an ee the vehicle fixed frame frame 0 is coincide with the center of mass cm of the vehicle whereas inertial frame frame i is a north east down coordinate system note that a variable of format x j i denotes the quantity x of link j with respect to w r t frame i 2 2 i auv modeling the kinematics of vehicle s cm and or manipulator s ee are essential for the control of an i auv in performing underwater tasks according to the definition of frames in fig 1 we can define the i auv generalized states as η p e e t p t θ t t r 9 where p e e x e e y e e z e e t p x y z t and θ θ x θ y θ z t are vectors for ee position vehicle position and vehicle orientation defined in task space w r t frame i respectively thus we have antonelli 2018 1 η j g θ q ζ where 2 j g θ q j e e θ q 3 6 n j t θ 3 3 o 3 3 n o 3 3 j r θ 3 3 o 3 n r 9 6 n is the geometric jacobian matrix including j t θ r 3 3 and j r θ r 3 3 for transforming vehicle linear and angular velocities from frame 0 to frame i with detailed expressions in cui et al 1999 j e e θ q r 3 6 n is the jacobian matrix for obtaining the ee velocities p e e x e e y e e z e e t expressed in frame i where p e e j e e θ q ζ o indicates the zero matrix ζ v t ω t q t t r 6 n is the generalized velocity where v v x v y v z t and ω ω x ω y ω z t are vehicle linear and angular velocities expressed in frame 0 and q q 1 q n t is the vector of joint velocities it is assumed that j g θ q is nonsingular in frame i to simulate the dynamic behaviors of an i auv being subjected to underwater operation environment a full i auv dynamic model including fluid effects is desired using the kane s method tarn et al 1996 the dynamic equations of the i auv w r t frame 0 can be derived and formulated as a matrix form in 3 m q ζ c θ q ζ f e θ q ζ f c b τ c where m denotes the inertia matrix including added mass c represents the sum of coriolis and centripetal terms including added mass f e is the vector of external forces i e gravity force buoyancy force fluid acceleration force and fluid drag force f c b indicates the vector of interaction forces on the environment exerted by the ee w r t frame 0 and τ c denotes the vector of control forces and torques w r t frame 0 the detailed expressions for all terms in 3 are presented in appendix a 2 3 simplified dynamic model for controller design as a comprehensive model 3 cannot be used directly in designing a controller since it includes the fluid effects i e v f 0 and a f 0 in a 4 and a 6 that are difficult to be measured or estimated in practice thus a simplified dynamic model without considering these fluid effects is desirable to facilitate the design of controller and verify the robustness of control system note that this model simplification is based on the assumption to be given in 12 which is considered in the controller design to be presented section 3 removing the fluid effects in a 4 and a 6 3 can be simplified and rewritten in frame 0 as follows 4 m q ζ c θ q ζ ζ f e θ q f c b τ c where m c and f e are estimated values of m c and f e in 3 respectively as a force controller is normally designed in task space cui et al 1999 it is necessary to further rewrite the dynamic model in 4 w r t frame i differentiating 1 we have 5 η j g ζ j g ζ where as η p e e t p t θ t t r 9 a particular solution can always be obtained if n 3 note that the system becomes kinematically redundant when n 3 using the pseudoinverse of the jacobian matrix as in whitney 1969 6 ζ j g η j g ζ where j g j g t j g j g t 1 is named moore penrose pseudoinverse of j g and j g j g 1 when n 3 similarly in terms of kinematics we can also obtain 7 ζ j g η substituting 6 and 7 into 4 the i auv dynamic model including η and η w r t frame i can be obtained in 8 m i q η c i θ q ζ η f e i θ q γ c γ e where 9 m i q j g t m q j g c i θ q ζ j g t c θ q ζ m q j g j g j g f e i θ q j g t f e θ q γ c j g t τ c γ e j g t f c b j g t j e e t f c note that f c r 3 is the vector of contact forces at ee in frame i which is defined in a 9 for 8 there are two properties that will be used in controller design yao et al 1992 property 1 m i q is a symmetric positive definite matrix and there exist p 1 0 and p 2 0 such that 10 p 1 i 6 n 6 n m i q p 2 i 6 n 6 n property 2 the matrix m i q 2 c i θ q ζ is a skew symmetric matrix that satisfies 11 1 2 h t m i q h h t c i θ q ζ h h r 6 n even for the simplified model given in 8 the exact values of m i q c i θ q ζ and f e i θ q are usually unknown due to parametric uncertainties it is assumed that the modeling errors are bounded as follows chan and chen 2001 12 m i m i m i δ m i c i c i c i δ c i f e i f e i f e i δ f e i where denotes the modeling error of and ˆ represents the estimated values of the positive scalars δ m i δ c i and δ f e i are bound of modeling errors 3 controller design as a robust control method smic has been applied in the interaction control of fixed base robotic manipulator chan and chen 2001 teleoperation system vafaei and yazdanpanah 2013 the mobile ground vehicle equipped with a manipulator salehi and vossoughi 2008 and the unmanned aerial vehicle uav with a robotic arm lippiello and ruggiero 2012 as a combination of impedance control ic and sliding mode control smc smic is advantageous in both achieving smooth contact by the mechanical impedance of ic scheme and handling the uncertainties and disturbances by the smc scheme included in addition smic utilizes a dynamic compensator to include the desired impedance into the design of sliding surface thereby achieving the interaction control between an ee and an environment without loss of robustness against uncertainties and external disturbances in this work smic is extended to the position force control of an i auv given the task space η the desired impedance for an i auv can be specified as anderson and spong 1988 13 m d e p b d e p k d e p k f e f e p η η d e f γ e γ c d γ c d j g t j e e t f c d where m d b d and k d are the desired inertia damping and stiffness of the impedance η d denotes the vector of reference motion trajectories for η γ e is the vector of interaction forces given in 9 and γ c d is the vector of reference interaction forces w r t frame i f c d f c d x f c d y f c d z t is the vector of reference forces for f c in 9 with elements parallel to x y and z axis of frame i respectively note that m d b d k d and k f are usually chosen as diagonal matrices for obtaining decoupled response to track trajectories η d and f c d a robust model reaching control law can be designed so as to drive the i auv model in 8 to achieve the desired impedance in 13 with the presence of fluid disturbances i e v f 0 and a f 0 in 3 that are not included in 8 and modeling errors in 12 in this work smic is applied in the design of control law where a dynamic compensator is firstly introduced as chan and chen 2001 14 z a z k p z e p k v z e p k f z e f where z is the state vector of the compensator a is a any semi negative definite matrix and k p z k v z and k f z are constant matrices for shaping the dynamic sliding mode that can achieve the desired impedance in 13 using the compensator in 14 a switching function and its derivative can be formed as 15 σ e p f 1 e p f 2 z σ e p f 1 e p f 2 z where f 1 and f 2 are constant matrices and f 2 is non singular combining 14 and 15 we have 16 e p f 1 f 2 a f 2 1 f 2 k v z e p f 2 k p z f 2 a f 2 1 f 1 e p f 2 k f z e f σ f 2 a f 2 1 σ which can be rewritten as 17 m d e p b d e p k d e p k f e f m d σ f 2 a f 2 1 σ k f e f r σ σ by selecting 18 k p z f 2 1 m d 1 k d f 2 a f 2 1 f 1 k v z f 2 1 m d 1 b d f 1 f 2 a f 2 1 k f z f 2 1 m d 1 k f with r σ σ converging to 0 i e σ 0 and σ 0 during the sliding motion 17 will be identical to 13 thereby achieving the desired impedance theorem 1 for the i auv described by 8 with modeling uncertainties in 12 the system achieves the desired impedance in 13 with the control law 19 γ c m i η e q c i η e q f e i γ e k s σ d sgn σ where 20 η e q η d f 1 e p f 2 z η e q η d f 1 e p f 2 z k s is a positive definite matrix sgn is a sign function and d is a positive scalar satisfying 21 ε 0 d δ m i η e q δ c i η e q δ f e i ε proof see appendix b the sign function sgn in 19 makes the control law discontinuous thereby resulting in the chattering phenomenon around the sliding surface to eliminate the chattering effects one effective method is to replace sgn by a linear saturation function in edwards and spurgeon 1998 22 sat σ sat σ 1 sat σ 6 n with 23 sat σ i sgn σ i σ i ξ i σ i ξ i σ i ξ i i 1 6 n where the positive constant ξ i denotes the thickness of the boundary layer for σ i replacing sgn σ by sat σ in 19 the final controller applied in this work becomes 24 γ c m i η e q c i η e q f e i γ e k s σ d sat σ which does not violate the convergence and stability of the system out of the sliding surface boundary layers i e σ i ξ i as demonstrated from b 1 to b 9 in appendix b and eliminates chattering effects inside the boundary layers i e σ i ξ i 4 simulation results 4 1 case study and scenario the whole i auv system studied in simulation consists of a 6 dof vehicle and a 3 dof manipulator composed by a pan tilt unit and a linear actuator with cad model and frame definition illustrated in fig 2 a and fig 2 b respectively as shown in fig 2 a the 8 thrusters of vehicle are denoted by t i i 1 8 it is assumed that there exists a wall normal to x of frame i shown in fig 2 b with known location and unknown stiffness k w given the reference trajectories for both vehicle and ee i e η d p e e d t p d t θ d t t the simulated i auv is expected to follow these trajectories and track the contact force profiles i e f c d f c d x 0 0 t r 3 in 13 after contacting with the wall at the ee with the assumption that the wall is smooth and there are no friction forces along y and z directions of frame i 4 2 simulation setup the simulation was performed in simulink of matlab 2018 using the full i auv dynamic model for simulation in 3 simplified model for controller design in 8 and the controller given in 24 note that the use of two different models aims to verify the validity and robustness of control methodology by model uncertainties the i auv started at p 0 0 0 t in the cm of the vehicle facing a wall located at p w 0 376 0 0 t which was within the operation space of the manipulator thus the vehicle body was expected to be stabilized at p d 0 0 0 t and θ d 0 0 0 t with zero reference velocities i e p d and θ d and accelerations i e p d and θ d starting at p e e 0 276 0 0 37 t with initial joint positions q 0 0 5 π 0 32 t the ee was expected to move toward the wall until contacting it at the point 0 376 0 0 37 t and then draw a straight line ending at the point 0 376 0 0 62 t the whole process was expected to be finished in 10 s and the trajectory generation method using high order bézier curves was applied to generate the smooth position velocity and acceleration trajectories used in this work dai and katupitiya 2015 similarly this method was also used to generate interaction force profile i e f c d x f c d which started from 0 n at the contact point and increased to 10 n in 0 5 s and then maintained at 10 n for the rest of the process in this work the unknown fluid disturbance i e v f 0 and a f 0 in a 4 was simulated using periodic functions as in 25 v f 0 b sin ω f t a f 0 b ω f cos ω f t where b and ω f are magnitude and frequency of the fluid disturbance and were specified as 0 2 0 2 0 2 t m s and 0 4 π rad s in the simulation respectively the contact force i e f c in a 9 and 9 between the ee and the environment is usually difficult to model in this work a simple model that relates the contact force to the deformation of the environment was used as follows antonelli et al 1999 26 f c k e p e e p w k e k e x 0 0 0 k e y 0 0 0 k e z where k e is environment stiffness matrix and f c is the vector of contact forces that are assumed to be accurately measured using a force sensor installed at the ee in this work it is assumed that there is no obstacles to interact with ee along y and z directions of frame i i e k e y k e z 0 to verify the controller s robustness a varying environment stiffness k e x in 26 was applied which increased from 1 1 0 4 n m i e soft wall at 0 376 0 0 37 t to 1 1 0 5 n m i e stiff wall at 0 376 0 0 62 t with expression in 27 k e x 10000 360000 p e e z 0 37 the values of parameters in simulation are listed in tables 1 and 2 which are obtained from the real i auv developed at the uts considering the parametric uncertainties the inertia matrix m in 3 is different from m in 4 which was reflected by mass errors in table 1 and inertia errors in table 2 note that in table 1 l x l y and l z are geometric parameters of i auv denoting the length width and height of the vehicle body respectively the controller parameters are presented in table 3 4 3 simulation results the reference trajectories of ee generated by bézier curves are presented in fig 3 where the continuous and smooth position velocity and acceleration profiles can facilitate the position force control performance of the ee note that as the trajectories in y axis of frame i always stay at 0 they are not plotted in fig 3 according to the simulation setup presented in section 4 2 the i auv has 9 control inputs including force inputs f x f y f z t for vehicle torque inputs t x t y t z t for vehicle and torque and force inputs t m 1 t m 2 f m 3 t for manipulator thus the system control inputs τ c given in a 10 can be formulated as τ c f x f y f z t x t y t z t m 1 t m 2 f m 3 t under the fluid disturbance given in 25 the generated control inputs τ c are plotted in fig 4 under the control inputs shown in fig 4 the simulation results for position and orientation tracking i e η d r 9 are presented in fig 5 including ee position errors shown in fig 5 a vehicle position errors shown in fig 5 b and vehicle orientation errors shown in fig 5 c using the control method smic good position tracking performance can be achieved with position and orientation errors within 3 10 3 m or rad the force tracking performance is shown in fig 6 where the reference force profile f c d x is generated using bézier curve as soon as the ee contacts with the wall at 2 67 s it is evident that the contact force f c x almost overlaps with f c d x after steady contact from 3 s onwards the force tracking error locates within 0 03 0 1 n and has a root mean square error rmse of 0 04 n i e 0 4 w r t 10 n 5 experimental results 5 1 experimental setup to verify the validity of the control methodology applied in this work the experiments were conducted on submerged pile inspection robot spir 3 0 which is an i auv developed in the centre for autonomous systems cas of uts for the maintenance of bridge piles note that as shown in fig 2 a and fig 7 a spir3 0 equips with a 3 dof manipulator used for non contact operation and thus not suitable for force control as an alternative a force sensing device shown in fig 7 a acts as a compliant spring based ee to interact with the underwater wall and measures the contact force therefore in the experiments spir3 0 was considered as an underwater vehicle with 6 dof i e η c p e e t θ t t r 6 including surge sway heave roll pitch and yaw being controlled in task space η i e η p e e t p t θ t t r 9 note that p e e t x e e y e e z e e t in η c denotes the position at the end of the compliant ee that interacts with the underwater wall and can be obtained from vehicle position p t using the transition matrix to achieve position force control of spir3 0 a 6 dof smic with the formation presented in 24 was designed and implemented it has to be pointed out that the above simplifications in experimental setup and controller design do not violate the control law of smic given in section 3 the experiments were carried out in the lab of cas using a water tank shown in fig 7 b with dimensions 6 m 4 m 2 m as shown in fig 2 a spir3 0 is driven by 8 on board thrusters with the model number of bluerobotics t200 to obtain accurate position and orientation measurements i e p and θ as shown in fig 7 b an augmented reality ar marker localization system is applied including a marker pasted on the underwater wall of the tank and a digital camera i e bluerobotics low light hd usb camera mounted on the vehicle as a high performance inertial measurement unit imu from advanced navigation spatial imu is used to measure the vehicle angular velocities ω whereas the vehicle linear velocities v are estimated by kalman filters designed in this work finally the vehicle state measurements estimations and proposed smic were all conducted in robot operating system ros of spir3 0 which operated at a low frequency of 20 hz 5 2 experimental results this subsection presents the experimental results achieved by smic based on the setup described in section 5 1 to verify the validity of the smic controller designed in this work experimental results of two cases with different desired contact forces i e f c d x are presented 5 2 1 case study i in this case study the compliant ee started at an initial position and orientation i e η c x e e y e e z e e θ x θ y θ z t 0 510 0 065 0 081 0 020 0 013 0 083 t and was supposed to approach and interact with the wall at the desired position and orientation η d 1 000 0 0 050 0 0 0 t defined in frame i the desired contact force i e f c d x was set as 5 n according to the experimental setup presented in section 5 1 spir3 0 has 6 control inputs including the forces for surge sway and heave i e f x f y f z t as well as torques for roll pitch and yaw i e t x t y t z t thus the system control input τ c in a 10 is expressed as τ c f x f y f z t x t y t z t as can be seen in the force control inputs plotted in fig 8 a the surge force f x maintains above 30 n after ee contacting with the wall i e after around 40 s whereas the desired contact force is only 5 n this phenomenon is mainly caused by the two front thrusters i e t 1 and t 2 shown in fig 2 a when spir3 0 approaches to the underwater wall the water current generated by these two thrusters causes reflection flow from the wall which in turn acts on the vehicle body as a disturbance and tends to push the vehicle away from the wall therefore to overcome the above disturbance and achieve the contact with the wall a surge force f x larger than the desired contact force is needed as shown in the torque inputs given in fig 8 b a nearly constant pitch torque t y is maintained after the contact which overcomes the torque generated by the contact force on the vehicle body it is interesting to note that after the contact the yaw torque t z fluctuates below 0 which tends to eliminate the orientation error e θ z that will be presented in fig 10 the position control performance is evaluated by the position and orientation errors between η c and η d as demonstrated by the position tracking performance shown in fig 9 spir3 0 approaches and contacts the underwater wall with ee at 40 8 s indicated by the vertical dash line in fig 9 with position errors of ee i e e x e e e y e e and e z e e for surge sway and heave respectively being maintained within 0 008 0 007 m after the steady contact i e from 46 8 s onwards after the contact the rmses for e x e e e y e e and e z e e are 0 0019 m 0 0047 m and 0 0061 m respectively note that during the contact phase after 40 8 s shown in fig 9 the position error e x e e in surge direction is not null since the compliant spring based ee was assumed to be rigid when the ee position p e e t was obtained from the measured vehicle position p t using transition matrix however in practice e x e e within the smic controller was set to 0 when a non zero contact force was detected as the force sensor is more reliable than the ar marker localization system in the contact detection the orientation tracking performance of spir3 0 is presented in fig 10 where the orientation errors i e e θ x e θ y and e θ z for roll pitch and yaw respectively all approach to 0 before contact i e before 40 8 s during the contact phase after 40 8 s with the existing mounting position of ee at spir3 0 the resultant contact force applied at the ee may not cross spir3 0 s center of mass which results in external torque disturbances on roll pitch and yaw i e θ x θ y and θ z of vehicle body that need to be properly compensated by the controller however given the thruster allocation shown in fig 2 a and thrusters limited capabilities it is challenging to maintain the desired contact force while perfectly overcoming the external torque disturbance in the control of orientations thus in this work the force control is considered to have priority over position control after contact which is realized by decreasing the gains for position control i e k p z and k v z in 14 during the contact phase even with reduced gains in position control after contact as can be seen from fig 10 the orientation errors are still kept within acceptable range from 40 8 s onwards where e θ x e θ y and e θ z all locate within 0 057 0 042 rad i e 3 266 2 406 with rmses of 0 0158 rad 0 0347 rad and 0 0398 rad respectively for the evaluation of force control performance as shown in fig 11 the force reference f c d x is generated when the contact happens with desired constant force of 5 n from 40 8 s onwards at the beginning of contact there exists force fluctuations within the region where f c x increases from 0 n to 11 33 n which is caused by the inertia effect of the vehicle that contacts with the wall at non zero longitudinal speed however f c x tends to steadily track f c d x from around 46 8 s onwards with tracking error falling within 1 60 1 53 n and a rmse of 0 59 n i e 11 8 w r t 5 n note that f c x is a component of measured force from force sensor within ee which is along the x axis of frame i 5 2 2 case study ii in case study ii the ee started at a different initial position and orientation i e η c x e e y e e z e e θ x θ y θ z t 0 615 0 272 0 207 0 014 0 049 0 203 t and was supposed to contact with the wall at the same destination i e η d 1 000 0 0 050 0 0 0 t used in case study i in this case study to demonstrate the controller s capability of maintaining different contact forces against an underwater object the desired contact was set as 10 n the system control inputs i e τ c f x f y f z t x t y t z t for case study ii are presented in fig 12 due to the increase of desired contact force after the contact the surge force f x shown in fig 12 a and pitch torque t y shown in fig 12 b are larger as compared with those shown in fig 8 under the control inputs given in fig 12 the position errors i e e x e e e y e e and e z e e shown in fig 13 tend to approach 0 before the contact that happens at 29 1 s and are kept within 0 010 0 016 m from the beginning of the contact until the end of intervention with rmses of 0 0014 m 0 006 m and 0 0128 m for e x e e e y e e and e z e e respectively meanwhile as can be seen from orientation tracking performance presented in fig 14 all orientation errors i e e θ x e θ y and e θ z shrink towards to 0 before the contact and are kept within 0 049 0 024 rad i e 2 807 1 375 even when spir3 0 is being subjected to external force from the wall after the contact after the contact the rmses for e θ x e θ y and e θ z are 0 0167 rad 0 0131 rad and 0 0330 rad respectively in contact force tracking at ee as can be seen from fig 15 after a short period of fluctuation at the beginning of the contact the actual contact force tends to maintain the desired constant force of 10 n from about 33 2 s onwards with tracking errors falling within 3 11 1 80 n and a rmse of 0 97 n i e 9 7 w r t 10 n 6 discussions in this work an i auv composed by a 6 dof vehicle and a 3 dof manipulator has been considered in computational simulation with simulation results given in section 4 3 as a suitable underwater manipulator is not available at the moment only a 6 dof vehicle i e spir3 0 and an ee i e force measurement device were considered in experiments with experimental results of two case studies presented in section 5 2 however as stated in section 5 1 the above simplification in the experimental setup does not violate the control law of smic presented in section 3 compared with the ee used on spir3 0 a fully actuated manipulator may generate more internal disturbances on the vehicle body during operation which will make the position force control more challenging for the purpose of further verifying the validity of smic controller presented in this work integrating a feasible manipulator to spir3 0 and carrying out comprehensive experimental studies will be one of our future works that will be presented in section 7 in experiments as can be seen in figs 9 and 13 spir3 0 operates at low speed while approaching to the underwater wall the reasons of low operation speed are threefold firstly spir3 0 was designed to be an underwater system operating at low speed with robot operating system ros that operated at low frequency of 20 hz secondly the maximum operating speed of spir3 0 was further reduced by the controller during experiments so as to protect the force sensor within the ee from damage at the moment of contact finally operating at low speed also helps to achieve accurate position and force control as the inertia effects of vehicle body are effectively limited however it has to be pointed out that the low operation speed affects the spir3 0 s efficiency in practice therefore increasing the operation speed before the contact phase will be another interesting future work that will be discussed in section 7 as illustrated in section 5 1 an ar marker localization system was applied to achieve position and orientation measurements the main disadvantage of this ar system lays on the limited effective range of measurement which depends on the size of the marker on the wall in experiments the maximum size of the marker was selected so that the marker occupied the majority of camera view window when the ee contacted with the wall limited by this fixed marker size the accuracy of position and orientation measurements will drop with the increase of initial distance between the marker and the camera which will further affect the accuracy in the estimation of vehicle linear velocities by kalman filters therefore in two case studies in section 5 2 the initial distance between the ee and the wall was set around 0 5 m where accurate position and orientation measurements were obtained although the existing ar system still works in demonstrating the position and force control of spir3 0 throughout all three phases i e from unconstrained phase to constrained phase the improvements in localization system are still desired to expand the operation space of spir3 0 which is another future work that will be included in section 7 7 conclusions this work applies a position force control method smic in an i auv to achieve underwater intervention considering the fluid disturbance and model uncertainties an i auv dynamic model using kane s method is derived and used for simulation whereas a simplified dynamic model is presented for the controller design according to both simulation and experimental results the controller is robust against the disturbances and uncertainties that an i auv is normally subjected to and can achieve good performances in position force control during the whole intervention process from unconstrained phase to constrained phase considering the hardware limitations of the existing experimental platform there are still some future works to be done firstly continuous work will focus on experimentally validating smic on a full i auv system consist of the spir3 0 and a fully actuated manipulator once a suitable manipulator is available for underwater intervention secondly increasing the i auv operation speed before the contact phase to improve the operation efficiency in practice thirdly improving the existing localization system so as to expand the i auv operation space finally in addition to the static interaction experiment presented in this work the experimental validation of dynamic interaction e g the ee tracks a path on the wall while maintaining the desired contact force will be another interesting work to be conducted in the future declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work was supported in part by the australian research council arc linkage project lp150100935 the roads and maritime services of nsw australia and the centre for autonomous systems cas at the university of technology sydney appendix a expressions of terms in i auv dynamic model based on the kane s method tarn et al 1996 the velocities and accelerations of link j w r t frame 0 can be derived and summarized as a 1 v j 0 j j v ζ r 3 ω j 0 j j ω ζ r 3 and a 2 a j 0 j j a ζ ζ j j a ζ ζ r 3 α j 0 j j α ζ ζ j j α ζ ζ r 3 where v j 0 ω j 0 a j 0 and α j 0 are vectors of linear velocities angular velocities linear accelerations and angular accelerations of link j w r t frame 0 respectively meanwhile j j v j j ω j j a ζ j j α ζ j j a ζ and j j α ζ are corresponding jacobian matrices for velocity and acceleration transformations using a 1 and a 2 all terms in the dynamic model 3 i e m c f e f c b and τ c can be derived and listed as follows a 3 m j 0 n j j v j j ω t m j j j a ζ i j 0 j j α ζ i a j 0 j j a ζ j j α ζ where m j is the mass of link j i j 0 is the inertia matrix of link j and i a j 0 is the added mass matrix w r t frame 0 a 4 c j 0 n j j v j j ω t c 1 c 2 c 3 where c 1 indicates terms generated by all links whereas c 2 and c 3 denote those caused by added mass as in a 5a c 1 m j j j a ζ i j 0 j j α ζ s j j ω ζ i j 0 j j ω ζ a 5b c 2 i a j 0 j j a ζ ζ a f 0 s j 0 ω ζ j j v ζ v f 0 j j α ζ s j 0 ω ζ j j ω a 5c c 3 s j j ω ζ o 3 3 s j j v ζ v f 0 s j j ω ζ i a j 0 j j v v f 0 j j ω where s is the skew symmetric matrix meanwhile v f 0 and a f 0 are the fluid velocity and fluid acceleration w r t frame 0 respectively a 6 f e j 0 n j j v j j ω t f e 1 j j 0 v j 0 ω t f e 2 j 1 n j j v j j ω t f e 3 j where f e 1 j j 0 n denotes the sum of gravity buoyancy and fluid acceleration forces exerting on link j f e 2 represents the fluid drag force acting on vehicle body i e link 0 and f e 3 j j 1 n is the fluid drag force acting on each link of manipulator with expressions in a 7a f e 1 j m j g 0 ρ v j g 0 a f 0 o 3 1 a 7b f e 2 π 2 ρ c d 0 r 0 2 j 0 v ζ v f 0 j 0 v ζ v f 0 o 3 1 a 7c f e 3 j ρ c d j r j l j v f j v f j 1 2 ρ c d j r j l j 2 v f j s r j 0 z j j v f j where g 0 is the gravitational acceleration w r t frame 0 v j l j r j and c d j are the volume length radius and drag coefficient of link j respectively the fluid density is denoted by ρ the relative velocity of link j w r t the fluid normal to the link along the length of the link is represented by v f j as in a 8 v f j j j v ζ v f 0 j j v ζ v f 0 r j 0 z j j r j 0 z j j where r j 0 is the rotation matrix from frame j to frame 0 and z j j 0 0 1 t is the unit vector of z axis note that the in a 8 indicates the dot product of the two adjacent items a 9 f c b j e e θ q t f c where f c f c x f c y f c z t is the vector of contact forces with elements parallel to x y and z axis of frame i respectively j e e θ q is the jacobian matrix in 2 a 10 τ c τ v t τ m t t where τ v 6 dof is the vector of control forces and torques acting on the cm of the vehicle and τ m n dof is the vector of control inputs for the joints of the manipulator appendix b proof of theorem 1 considering property 1 a lyapunov candidate function v can be defined as b 1 v 1 2 σ t m i σ using property 1 there exists b 2 p 1 2 σ 2 v p 2 2 σ 2 combining 15 and 20 leads to b 3 σ η η e q σ η η e q applying property 2 the derivative of v is obtained as b 4 v σ t m i σ 1 2 σ t m i σ σ t m i σ σ t c i σ substituting b 3 into b 4 and considering 8 yields b 5 v σ t γ c γ e m i η e q c i η e q f e i substituting 19 into b 5 and considering bounds in 12 b 6 v d σ σ t k s σ m i η e q c i η e q f e i σ t k s σ d σ σ δ m i η e q δ c i η e q δ f e i considering 21 b 6 becomes b 7 v λ m i n k s σ 2 ε σ where λ m i n is the minimum eigenvalue operator using b 2 b 7 becomes b 8 v λ m i n k s σ 2 ε σ k 1 v k 2 v where k 1 2 λ m i n k s p 2 and k 2 ε 2 p 2 thus we can write b 9 v v 0 k 2 k 1 e k 1 t 2 k 2 k 1 which means that in finite time σ 0 and σ 0 and the i auv system presented in 8 is stable under control law given in 19 while achieving the desired impedance in 13 appendix c supplementary data supplementary material related to this article can be found online at https doi org 10 1016 j oceaneng 2019 106855 appendix c supplementary data the following is the supplementary material related to this article video s1 experimental video and results for contact interventions of an i auv 
22187,position force control of an intervention autonomous underwater vehicle i auv is essential to many underwater intervention tasks e g marine equipment maintenance underwater welding and so on and is challenging due to unknown fluid disturbances and model uncertainties this paper applies the sliding mode impedance control smic to the full contact intervention of an i auv from non contact phase to contact phase both computational simulations and practical experiments are conducted to investigate the performance of smic in simulations considering model uncertainties and detailed fluid disturbances accurate position and force tracking can be achieved with the position tracking errors within 3 10 3m and a root mean square error rmse of 4 10 2n in tracking the desired contact force of 10n for the purpose of experimental validation the smic is implemented on an i auv developed in the university of technology sydney uts the experimental results demonstrate the smic s good performance in the contact intervention of the i auv with the position tracking errors within 1 6 10 2 m and a rmse of 0 97n in maintaining the desired contact force of 10n keywords i auv contact intervention force control position control 1 introduction with the development of intervention autonomous underwater vehicles i auvs in the last few decades the demand for accuracy robustness and efficiency in i auv s underwater intervention tasks is ever increasing most of the intervention tasks such as maintenance of ships and subsea pipeline underwater welding oil and gas searching require the end effector ee of the manipulator mounted on an autonomous underwater vehicle auv to contact and interact with the underwater object or environment heshmati alamdari et al 2017 where the accurate interaction control of the ee is highly desired however an i auv operated underwater may be exposed to an unknown operation environment where the fluid disturbance and the object interacted with are normally unknown or difficult to be measured or estimated in addition an i auv is usually a complex system with model uncertainties and inaccurate control signals obtained using the uncertain model can badly affect the ee s performance in both position and contact force tracking motivated by the demands and challenges stated above significant research efforts have been made in auvs and robotic intervention for the first time the alive project evans et al 2003 achieved the field demonstration of underwater robotic intervention where an auv docked to a subsea panel and performed valve turning this is followed by the triton project palomeras et al 2014 in which the similar fixed base underwater manipulations were presented then the sauvim project marani and yuh 2014 first demonstrated the underwater intervention by a hovering vehicle where an i auv grasped and recovered an object from the seabed next in the trident project simetti et al 2014 the girona500 vehicle was used to perform multipurpose intervention i e underwater object search and recovery finally the maris project simetti et al 2017 presented the experimental demonstration of object recognition and collection using a customized three finger gripper the projects listed above mainly focused on the intervention tasks such as valve manipulation and object recovery where the accurate position control of ee on a docked or hovering auv was highly desired e g control an ee to approach and grasp an underwater object although force torque sensors were used on some i auvs but they were only for the purpose of contact detection which assisted with manipulating or grasping an object jamali et al 2015 simetti et al 2017 there are rare projects focusing on the field demonstration of an intervention task that requires both accurate position and contact force control at the ee of an i auv such as subsea pipe inspection cieslak and ridao 2018 however some research works with computational simulations are available in the literature in cui et al 1999 the impedance control ic was applied on an underwater vehicle manipulator system uvms to achieve position force control at ee then authors in farivarnejad and moosavian 2014 proposed a multiple ic scheme for a dual manipulator of an auv in antonelli et al 2001 gierlak and szuster 2017 and taira et al 2018 various force controllers were demonstrated for contact interventions of i auvs although the above methods are promising they do not take the fluid disturbances and or model uncertainties into account assuming still water operating environments in simulations in heshmati alamdari et al 2016 2017 robust control methods were proposed for an uvms interacting with underwater environment considering the fluid disturbances as small forces i e less than 0 15 n acting on the vehicle body however the above fluid disturbances considered in simulations are not realistic in practice as the fluid usually disturbs both the vehicle body and manipulator of an uvms in the form of velocities and accelerations as a kind of position force control scheme the parallel control closes position and force loops in all task space directions however the closed loops are not decoupled which causes mutual disturbance of position and force variables during the transient from the non contact stage to the contact stage antonelli 2018 the hybrid position force control can structurally decouple the force and position controllers and thus can achieve both force and motion control of a manipulator however this control scheme neglects the mechanical work between the system and environment cui and yuh 2003 which makes it challenging to achieve smooth contact against the environment the position force control of an i auv normally involves three phases namely unconstrained or non contact phase transient phase and constrained or contact phase cui and yuh 2003 where the unconstrained phase indicates the stage before the contact happens constrained phase refers to the stage that the ee maintains contact with the environment and the transient phase is the instantaneous moment from unconstrained phase to constrained phase a smooth contact during the transient phase is highly required to avoid the force surge in contact which poses challenges to the controller design of a manipulator with base fixed on the ground let alone an i auv with hovering body subjected to external disturbance and interaction force from the environment thus for contact intervention of i auvs most existing control methods are verified through simulations and experimental results addressing the control across all three phases are rarely available in barbalata et al 2018 a position force sliding mode sm controller was proposed for an underwater manipulator with experimental data for validation however the work focuses on the scenario where the manipulator s base is fixed above the waterline for i auvs the experimental validation of position force control was presented in heshmati alamdari et al 2018 however the method can only achieve the intervention at constrained phase considering that the ee has already contacted with the environment before the implement of control the first and only documented experimental example of autonomous underwater hovering intervention with contact force control across all three phases was recently presented in cieslak and ridao 2018 the work combined a task priority tp kinematic control method with ic method to achieve simultaneous tracking of ee configuration and contact force against an pipe in still water however due to the detection error between ee and the pipe a desired path on a virtual pipe inside the real pipe was used to ensure the contact and thus the path tracking performance was not able to be evaluated in addition as reported because of the manipulator used and poor velocity control of the vehicle i e girona500 i auv in heave direction the overall performance of the system was severely limited therefore up to now the position force control for the contact interventions of i auvs remains a challenging problem that has not yet been effectively addressed in this work we propose to apply the sliding mode impedance control smic method in the position force control of an i auv which is expected to conduct intervention task against underwater structures our contributions are threefold performance verification of smic in the underwater intervention of an i auv in computational simulations considering both fluid disturbances and model uncertainties achievement of both position and force control at the ee of an i auv across all three intervention phases i e from non contact phase to contact phase real time experimental validation of underwater intervention on an i auv consist of an underwater vehicle and an ee the paper is organized as follows section 2 describes the i auv system models including frame definition kinematic model and dynamic model the control methodology is presented in section 3 simulation and experimental results are presented in section 4 and section 5 respectively then discussions for experiments are provided in section 6 finally conclusions are given in section 7 2 mathematical modeling in this work to comprehensively represent an i auv s dynamic behaviors subjected to underwater environment an i auv dynamic model using kane s method is built for simulation compared with newton euler n e and euler lagrange e l methods that are most commonly used in i auv modeling kane s method is more direct in eliminating the link interaction forces associated with the n e method and in avoiding the need to develop an energy function associated with the e l method tarn et al 1996 in this section the frame definition of mathematical modeling is firstly given then the i auv modeling is presented including a kinematic model and a full dynamic model used for computational simulations finally without considering the fluid effects a simplified dynamic model of i auv is presented which is applied in the design of controller for both computational simulations and real world experiments 2 1 frame definition for system modeling without loss of generality an i auv can be decomposed into n 1 links associated with different coordinate frames in fig 1 where the vehicle is represented by link 0 and the manipulator is composed by n links and an ee the vehicle fixed frame frame 0 is coincide with the center of mass cm of the vehicle whereas inertial frame frame i is a north east down coordinate system note that a variable of format x j i denotes the quantity x of link j with respect to w r t frame i 2 2 i auv modeling the kinematics of vehicle s cm and or manipulator s ee are essential for the control of an i auv in performing underwater tasks according to the definition of frames in fig 1 we can define the i auv generalized states as η p e e t p t θ t t r 9 where p e e x e e y e e z e e t p x y z t and θ θ x θ y θ z t are vectors for ee position vehicle position and vehicle orientation defined in task space w r t frame i respectively thus we have antonelli 2018 1 η j g θ q ζ where 2 j g θ q j e e θ q 3 6 n j t θ 3 3 o 3 3 n o 3 3 j r θ 3 3 o 3 n r 9 6 n is the geometric jacobian matrix including j t θ r 3 3 and j r θ r 3 3 for transforming vehicle linear and angular velocities from frame 0 to frame i with detailed expressions in cui et al 1999 j e e θ q r 3 6 n is the jacobian matrix for obtaining the ee velocities p e e x e e y e e z e e t expressed in frame i where p e e j e e θ q ζ o indicates the zero matrix ζ v t ω t q t t r 6 n is the generalized velocity where v v x v y v z t and ω ω x ω y ω z t are vehicle linear and angular velocities expressed in frame 0 and q q 1 q n t is the vector of joint velocities it is assumed that j g θ q is nonsingular in frame i to simulate the dynamic behaviors of an i auv being subjected to underwater operation environment a full i auv dynamic model including fluid effects is desired using the kane s method tarn et al 1996 the dynamic equations of the i auv w r t frame 0 can be derived and formulated as a matrix form in 3 m q ζ c θ q ζ f e θ q ζ f c b τ c where m denotes the inertia matrix including added mass c represents the sum of coriolis and centripetal terms including added mass f e is the vector of external forces i e gravity force buoyancy force fluid acceleration force and fluid drag force f c b indicates the vector of interaction forces on the environment exerted by the ee w r t frame 0 and τ c denotes the vector of control forces and torques w r t frame 0 the detailed expressions for all terms in 3 are presented in appendix a 2 3 simplified dynamic model for controller design as a comprehensive model 3 cannot be used directly in designing a controller since it includes the fluid effects i e v f 0 and a f 0 in a 4 and a 6 that are difficult to be measured or estimated in practice thus a simplified dynamic model without considering these fluid effects is desirable to facilitate the design of controller and verify the robustness of control system note that this model simplification is based on the assumption to be given in 12 which is considered in the controller design to be presented section 3 removing the fluid effects in a 4 and a 6 3 can be simplified and rewritten in frame 0 as follows 4 m q ζ c θ q ζ ζ f e θ q f c b τ c where m c and f e are estimated values of m c and f e in 3 respectively as a force controller is normally designed in task space cui et al 1999 it is necessary to further rewrite the dynamic model in 4 w r t frame i differentiating 1 we have 5 η j g ζ j g ζ where as η p e e t p t θ t t r 9 a particular solution can always be obtained if n 3 note that the system becomes kinematically redundant when n 3 using the pseudoinverse of the jacobian matrix as in whitney 1969 6 ζ j g η j g ζ where j g j g t j g j g t 1 is named moore penrose pseudoinverse of j g and j g j g 1 when n 3 similarly in terms of kinematics we can also obtain 7 ζ j g η substituting 6 and 7 into 4 the i auv dynamic model including η and η w r t frame i can be obtained in 8 m i q η c i θ q ζ η f e i θ q γ c γ e where 9 m i q j g t m q j g c i θ q ζ j g t c θ q ζ m q j g j g j g f e i θ q j g t f e θ q γ c j g t τ c γ e j g t f c b j g t j e e t f c note that f c r 3 is the vector of contact forces at ee in frame i which is defined in a 9 for 8 there are two properties that will be used in controller design yao et al 1992 property 1 m i q is a symmetric positive definite matrix and there exist p 1 0 and p 2 0 such that 10 p 1 i 6 n 6 n m i q p 2 i 6 n 6 n property 2 the matrix m i q 2 c i θ q ζ is a skew symmetric matrix that satisfies 11 1 2 h t m i q h h t c i θ q ζ h h r 6 n even for the simplified model given in 8 the exact values of m i q c i θ q ζ and f e i θ q are usually unknown due to parametric uncertainties it is assumed that the modeling errors are bounded as follows chan and chen 2001 12 m i m i m i δ m i c i c i c i δ c i f e i f e i f e i δ f e i where denotes the modeling error of and ˆ represents the estimated values of the positive scalars δ m i δ c i and δ f e i are bound of modeling errors 3 controller design as a robust control method smic has been applied in the interaction control of fixed base robotic manipulator chan and chen 2001 teleoperation system vafaei and yazdanpanah 2013 the mobile ground vehicle equipped with a manipulator salehi and vossoughi 2008 and the unmanned aerial vehicle uav with a robotic arm lippiello and ruggiero 2012 as a combination of impedance control ic and sliding mode control smc smic is advantageous in both achieving smooth contact by the mechanical impedance of ic scheme and handling the uncertainties and disturbances by the smc scheme included in addition smic utilizes a dynamic compensator to include the desired impedance into the design of sliding surface thereby achieving the interaction control between an ee and an environment without loss of robustness against uncertainties and external disturbances in this work smic is extended to the position force control of an i auv given the task space η the desired impedance for an i auv can be specified as anderson and spong 1988 13 m d e p b d e p k d e p k f e f e p η η d e f γ e γ c d γ c d j g t j e e t f c d where m d b d and k d are the desired inertia damping and stiffness of the impedance η d denotes the vector of reference motion trajectories for η γ e is the vector of interaction forces given in 9 and γ c d is the vector of reference interaction forces w r t frame i f c d f c d x f c d y f c d z t is the vector of reference forces for f c in 9 with elements parallel to x y and z axis of frame i respectively note that m d b d k d and k f are usually chosen as diagonal matrices for obtaining decoupled response to track trajectories η d and f c d a robust model reaching control law can be designed so as to drive the i auv model in 8 to achieve the desired impedance in 13 with the presence of fluid disturbances i e v f 0 and a f 0 in 3 that are not included in 8 and modeling errors in 12 in this work smic is applied in the design of control law where a dynamic compensator is firstly introduced as chan and chen 2001 14 z a z k p z e p k v z e p k f z e f where z is the state vector of the compensator a is a any semi negative definite matrix and k p z k v z and k f z are constant matrices for shaping the dynamic sliding mode that can achieve the desired impedance in 13 using the compensator in 14 a switching function and its derivative can be formed as 15 σ e p f 1 e p f 2 z σ e p f 1 e p f 2 z where f 1 and f 2 are constant matrices and f 2 is non singular combining 14 and 15 we have 16 e p f 1 f 2 a f 2 1 f 2 k v z e p f 2 k p z f 2 a f 2 1 f 1 e p f 2 k f z e f σ f 2 a f 2 1 σ which can be rewritten as 17 m d e p b d e p k d e p k f e f m d σ f 2 a f 2 1 σ k f e f r σ σ by selecting 18 k p z f 2 1 m d 1 k d f 2 a f 2 1 f 1 k v z f 2 1 m d 1 b d f 1 f 2 a f 2 1 k f z f 2 1 m d 1 k f with r σ σ converging to 0 i e σ 0 and σ 0 during the sliding motion 17 will be identical to 13 thereby achieving the desired impedance theorem 1 for the i auv described by 8 with modeling uncertainties in 12 the system achieves the desired impedance in 13 with the control law 19 γ c m i η e q c i η e q f e i γ e k s σ d sgn σ where 20 η e q η d f 1 e p f 2 z η e q η d f 1 e p f 2 z k s is a positive definite matrix sgn is a sign function and d is a positive scalar satisfying 21 ε 0 d δ m i η e q δ c i η e q δ f e i ε proof see appendix b the sign function sgn in 19 makes the control law discontinuous thereby resulting in the chattering phenomenon around the sliding surface to eliminate the chattering effects one effective method is to replace sgn by a linear saturation function in edwards and spurgeon 1998 22 sat σ sat σ 1 sat σ 6 n with 23 sat σ i sgn σ i σ i ξ i σ i ξ i σ i ξ i i 1 6 n where the positive constant ξ i denotes the thickness of the boundary layer for σ i replacing sgn σ by sat σ in 19 the final controller applied in this work becomes 24 γ c m i η e q c i η e q f e i γ e k s σ d sat σ which does not violate the convergence and stability of the system out of the sliding surface boundary layers i e σ i ξ i as demonstrated from b 1 to b 9 in appendix b and eliminates chattering effects inside the boundary layers i e σ i ξ i 4 simulation results 4 1 case study and scenario the whole i auv system studied in simulation consists of a 6 dof vehicle and a 3 dof manipulator composed by a pan tilt unit and a linear actuator with cad model and frame definition illustrated in fig 2 a and fig 2 b respectively as shown in fig 2 a the 8 thrusters of vehicle are denoted by t i i 1 8 it is assumed that there exists a wall normal to x of frame i shown in fig 2 b with known location and unknown stiffness k w given the reference trajectories for both vehicle and ee i e η d p e e d t p d t θ d t t the simulated i auv is expected to follow these trajectories and track the contact force profiles i e f c d f c d x 0 0 t r 3 in 13 after contacting with the wall at the ee with the assumption that the wall is smooth and there are no friction forces along y and z directions of frame i 4 2 simulation setup the simulation was performed in simulink of matlab 2018 using the full i auv dynamic model for simulation in 3 simplified model for controller design in 8 and the controller given in 24 note that the use of two different models aims to verify the validity and robustness of control methodology by model uncertainties the i auv started at p 0 0 0 t in the cm of the vehicle facing a wall located at p w 0 376 0 0 t which was within the operation space of the manipulator thus the vehicle body was expected to be stabilized at p d 0 0 0 t and θ d 0 0 0 t with zero reference velocities i e p d and θ d and accelerations i e p d and θ d starting at p e e 0 276 0 0 37 t with initial joint positions q 0 0 5 π 0 32 t the ee was expected to move toward the wall until contacting it at the point 0 376 0 0 37 t and then draw a straight line ending at the point 0 376 0 0 62 t the whole process was expected to be finished in 10 s and the trajectory generation method using high order bézier curves was applied to generate the smooth position velocity and acceleration trajectories used in this work dai and katupitiya 2015 similarly this method was also used to generate interaction force profile i e f c d x f c d which started from 0 n at the contact point and increased to 10 n in 0 5 s and then maintained at 10 n for the rest of the process in this work the unknown fluid disturbance i e v f 0 and a f 0 in a 4 was simulated using periodic functions as in 25 v f 0 b sin ω f t a f 0 b ω f cos ω f t where b and ω f are magnitude and frequency of the fluid disturbance and were specified as 0 2 0 2 0 2 t m s and 0 4 π rad s in the simulation respectively the contact force i e f c in a 9 and 9 between the ee and the environment is usually difficult to model in this work a simple model that relates the contact force to the deformation of the environment was used as follows antonelli et al 1999 26 f c k e p e e p w k e k e x 0 0 0 k e y 0 0 0 k e z where k e is environment stiffness matrix and f c is the vector of contact forces that are assumed to be accurately measured using a force sensor installed at the ee in this work it is assumed that there is no obstacles to interact with ee along y and z directions of frame i i e k e y k e z 0 to verify the controller s robustness a varying environment stiffness k e x in 26 was applied which increased from 1 1 0 4 n m i e soft wall at 0 376 0 0 37 t to 1 1 0 5 n m i e stiff wall at 0 376 0 0 62 t with expression in 27 k e x 10000 360000 p e e z 0 37 the values of parameters in simulation are listed in tables 1 and 2 which are obtained from the real i auv developed at the uts considering the parametric uncertainties the inertia matrix m in 3 is different from m in 4 which was reflected by mass errors in table 1 and inertia errors in table 2 note that in table 1 l x l y and l z are geometric parameters of i auv denoting the length width and height of the vehicle body respectively the controller parameters are presented in table 3 4 3 simulation results the reference trajectories of ee generated by bézier curves are presented in fig 3 where the continuous and smooth position velocity and acceleration profiles can facilitate the position force control performance of the ee note that as the trajectories in y axis of frame i always stay at 0 they are not plotted in fig 3 according to the simulation setup presented in section 4 2 the i auv has 9 control inputs including force inputs f x f y f z t for vehicle torque inputs t x t y t z t for vehicle and torque and force inputs t m 1 t m 2 f m 3 t for manipulator thus the system control inputs τ c given in a 10 can be formulated as τ c f x f y f z t x t y t z t m 1 t m 2 f m 3 t under the fluid disturbance given in 25 the generated control inputs τ c are plotted in fig 4 under the control inputs shown in fig 4 the simulation results for position and orientation tracking i e η d r 9 are presented in fig 5 including ee position errors shown in fig 5 a vehicle position errors shown in fig 5 b and vehicle orientation errors shown in fig 5 c using the control method smic good position tracking performance can be achieved with position and orientation errors within 3 10 3 m or rad the force tracking performance is shown in fig 6 where the reference force profile f c d x is generated using bézier curve as soon as the ee contacts with the wall at 2 67 s it is evident that the contact force f c x almost overlaps with f c d x after steady contact from 3 s onwards the force tracking error locates within 0 03 0 1 n and has a root mean square error rmse of 0 04 n i e 0 4 w r t 10 n 5 experimental results 5 1 experimental setup to verify the validity of the control methodology applied in this work the experiments were conducted on submerged pile inspection robot spir 3 0 which is an i auv developed in the centre for autonomous systems cas of uts for the maintenance of bridge piles note that as shown in fig 2 a and fig 7 a spir3 0 equips with a 3 dof manipulator used for non contact operation and thus not suitable for force control as an alternative a force sensing device shown in fig 7 a acts as a compliant spring based ee to interact with the underwater wall and measures the contact force therefore in the experiments spir3 0 was considered as an underwater vehicle with 6 dof i e η c p e e t θ t t r 6 including surge sway heave roll pitch and yaw being controlled in task space η i e η p e e t p t θ t t r 9 note that p e e t x e e y e e z e e t in η c denotes the position at the end of the compliant ee that interacts with the underwater wall and can be obtained from vehicle position p t using the transition matrix to achieve position force control of spir3 0 a 6 dof smic with the formation presented in 24 was designed and implemented it has to be pointed out that the above simplifications in experimental setup and controller design do not violate the control law of smic given in section 3 the experiments were carried out in the lab of cas using a water tank shown in fig 7 b with dimensions 6 m 4 m 2 m as shown in fig 2 a spir3 0 is driven by 8 on board thrusters with the model number of bluerobotics t200 to obtain accurate position and orientation measurements i e p and θ as shown in fig 7 b an augmented reality ar marker localization system is applied including a marker pasted on the underwater wall of the tank and a digital camera i e bluerobotics low light hd usb camera mounted on the vehicle as a high performance inertial measurement unit imu from advanced navigation spatial imu is used to measure the vehicle angular velocities ω whereas the vehicle linear velocities v are estimated by kalman filters designed in this work finally the vehicle state measurements estimations and proposed smic were all conducted in robot operating system ros of spir3 0 which operated at a low frequency of 20 hz 5 2 experimental results this subsection presents the experimental results achieved by smic based on the setup described in section 5 1 to verify the validity of the smic controller designed in this work experimental results of two cases with different desired contact forces i e f c d x are presented 5 2 1 case study i in this case study the compliant ee started at an initial position and orientation i e η c x e e y e e z e e θ x θ y θ z t 0 510 0 065 0 081 0 020 0 013 0 083 t and was supposed to approach and interact with the wall at the desired position and orientation η d 1 000 0 0 050 0 0 0 t defined in frame i the desired contact force i e f c d x was set as 5 n according to the experimental setup presented in section 5 1 spir3 0 has 6 control inputs including the forces for surge sway and heave i e f x f y f z t as well as torques for roll pitch and yaw i e t x t y t z t thus the system control input τ c in a 10 is expressed as τ c f x f y f z t x t y t z t as can be seen in the force control inputs plotted in fig 8 a the surge force f x maintains above 30 n after ee contacting with the wall i e after around 40 s whereas the desired contact force is only 5 n this phenomenon is mainly caused by the two front thrusters i e t 1 and t 2 shown in fig 2 a when spir3 0 approaches to the underwater wall the water current generated by these two thrusters causes reflection flow from the wall which in turn acts on the vehicle body as a disturbance and tends to push the vehicle away from the wall therefore to overcome the above disturbance and achieve the contact with the wall a surge force f x larger than the desired contact force is needed as shown in the torque inputs given in fig 8 b a nearly constant pitch torque t y is maintained after the contact which overcomes the torque generated by the contact force on the vehicle body it is interesting to note that after the contact the yaw torque t z fluctuates below 0 which tends to eliminate the orientation error e θ z that will be presented in fig 10 the position control performance is evaluated by the position and orientation errors between η c and η d as demonstrated by the position tracking performance shown in fig 9 spir3 0 approaches and contacts the underwater wall with ee at 40 8 s indicated by the vertical dash line in fig 9 with position errors of ee i e e x e e e y e e and e z e e for surge sway and heave respectively being maintained within 0 008 0 007 m after the steady contact i e from 46 8 s onwards after the contact the rmses for e x e e e y e e and e z e e are 0 0019 m 0 0047 m and 0 0061 m respectively note that during the contact phase after 40 8 s shown in fig 9 the position error e x e e in surge direction is not null since the compliant spring based ee was assumed to be rigid when the ee position p e e t was obtained from the measured vehicle position p t using transition matrix however in practice e x e e within the smic controller was set to 0 when a non zero contact force was detected as the force sensor is more reliable than the ar marker localization system in the contact detection the orientation tracking performance of spir3 0 is presented in fig 10 where the orientation errors i e e θ x e θ y and e θ z for roll pitch and yaw respectively all approach to 0 before contact i e before 40 8 s during the contact phase after 40 8 s with the existing mounting position of ee at spir3 0 the resultant contact force applied at the ee may not cross spir3 0 s center of mass which results in external torque disturbances on roll pitch and yaw i e θ x θ y and θ z of vehicle body that need to be properly compensated by the controller however given the thruster allocation shown in fig 2 a and thrusters limited capabilities it is challenging to maintain the desired contact force while perfectly overcoming the external torque disturbance in the control of orientations thus in this work the force control is considered to have priority over position control after contact which is realized by decreasing the gains for position control i e k p z and k v z in 14 during the contact phase even with reduced gains in position control after contact as can be seen from fig 10 the orientation errors are still kept within acceptable range from 40 8 s onwards where e θ x e θ y and e θ z all locate within 0 057 0 042 rad i e 3 266 2 406 with rmses of 0 0158 rad 0 0347 rad and 0 0398 rad respectively for the evaluation of force control performance as shown in fig 11 the force reference f c d x is generated when the contact happens with desired constant force of 5 n from 40 8 s onwards at the beginning of contact there exists force fluctuations within the region where f c x increases from 0 n to 11 33 n which is caused by the inertia effect of the vehicle that contacts with the wall at non zero longitudinal speed however f c x tends to steadily track f c d x from around 46 8 s onwards with tracking error falling within 1 60 1 53 n and a rmse of 0 59 n i e 11 8 w r t 5 n note that f c x is a component of measured force from force sensor within ee which is along the x axis of frame i 5 2 2 case study ii in case study ii the ee started at a different initial position and orientation i e η c x e e y e e z e e θ x θ y θ z t 0 615 0 272 0 207 0 014 0 049 0 203 t and was supposed to contact with the wall at the same destination i e η d 1 000 0 0 050 0 0 0 t used in case study i in this case study to demonstrate the controller s capability of maintaining different contact forces against an underwater object the desired contact was set as 10 n the system control inputs i e τ c f x f y f z t x t y t z t for case study ii are presented in fig 12 due to the increase of desired contact force after the contact the surge force f x shown in fig 12 a and pitch torque t y shown in fig 12 b are larger as compared with those shown in fig 8 under the control inputs given in fig 12 the position errors i e e x e e e y e e and e z e e shown in fig 13 tend to approach 0 before the contact that happens at 29 1 s and are kept within 0 010 0 016 m from the beginning of the contact until the end of intervention with rmses of 0 0014 m 0 006 m and 0 0128 m for e x e e e y e e and e z e e respectively meanwhile as can be seen from orientation tracking performance presented in fig 14 all orientation errors i e e θ x e θ y and e θ z shrink towards to 0 before the contact and are kept within 0 049 0 024 rad i e 2 807 1 375 even when spir3 0 is being subjected to external force from the wall after the contact after the contact the rmses for e θ x e θ y and e θ z are 0 0167 rad 0 0131 rad and 0 0330 rad respectively in contact force tracking at ee as can be seen from fig 15 after a short period of fluctuation at the beginning of the contact the actual contact force tends to maintain the desired constant force of 10 n from about 33 2 s onwards with tracking errors falling within 3 11 1 80 n and a rmse of 0 97 n i e 9 7 w r t 10 n 6 discussions in this work an i auv composed by a 6 dof vehicle and a 3 dof manipulator has been considered in computational simulation with simulation results given in section 4 3 as a suitable underwater manipulator is not available at the moment only a 6 dof vehicle i e spir3 0 and an ee i e force measurement device were considered in experiments with experimental results of two case studies presented in section 5 2 however as stated in section 5 1 the above simplification in the experimental setup does not violate the control law of smic presented in section 3 compared with the ee used on spir3 0 a fully actuated manipulator may generate more internal disturbances on the vehicle body during operation which will make the position force control more challenging for the purpose of further verifying the validity of smic controller presented in this work integrating a feasible manipulator to spir3 0 and carrying out comprehensive experimental studies will be one of our future works that will be presented in section 7 in experiments as can be seen in figs 9 and 13 spir3 0 operates at low speed while approaching to the underwater wall the reasons of low operation speed are threefold firstly spir3 0 was designed to be an underwater system operating at low speed with robot operating system ros that operated at low frequency of 20 hz secondly the maximum operating speed of spir3 0 was further reduced by the controller during experiments so as to protect the force sensor within the ee from damage at the moment of contact finally operating at low speed also helps to achieve accurate position and force control as the inertia effects of vehicle body are effectively limited however it has to be pointed out that the low operation speed affects the spir3 0 s efficiency in practice therefore increasing the operation speed before the contact phase will be another interesting future work that will be discussed in section 7 as illustrated in section 5 1 an ar marker localization system was applied to achieve position and orientation measurements the main disadvantage of this ar system lays on the limited effective range of measurement which depends on the size of the marker on the wall in experiments the maximum size of the marker was selected so that the marker occupied the majority of camera view window when the ee contacted with the wall limited by this fixed marker size the accuracy of position and orientation measurements will drop with the increase of initial distance between the marker and the camera which will further affect the accuracy in the estimation of vehicle linear velocities by kalman filters therefore in two case studies in section 5 2 the initial distance between the ee and the wall was set around 0 5 m where accurate position and orientation measurements were obtained although the existing ar system still works in demonstrating the position and force control of spir3 0 throughout all three phases i e from unconstrained phase to constrained phase the improvements in localization system are still desired to expand the operation space of spir3 0 which is another future work that will be included in section 7 7 conclusions this work applies a position force control method smic in an i auv to achieve underwater intervention considering the fluid disturbance and model uncertainties an i auv dynamic model using kane s method is derived and used for simulation whereas a simplified dynamic model is presented for the controller design according to both simulation and experimental results the controller is robust against the disturbances and uncertainties that an i auv is normally subjected to and can achieve good performances in position force control during the whole intervention process from unconstrained phase to constrained phase considering the hardware limitations of the existing experimental platform there are still some future works to be done firstly continuous work will focus on experimentally validating smic on a full i auv system consist of the spir3 0 and a fully actuated manipulator once a suitable manipulator is available for underwater intervention secondly increasing the i auv operation speed before the contact phase to improve the operation efficiency in practice thirdly improving the existing localization system so as to expand the i auv operation space finally in addition to the static interaction experiment presented in this work the experimental validation of dynamic interaction e g the ee tracks a path on the wall while maintaining the desired contact force will be another interesting work to be conducted in the future declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work was supported in part by the australian research council arc linkage project lp150100935 the roads and maritime services of nsw australia and the centre for autonomous systems cas at the university of technology sydney appendix a expressions of terms in i auv dynamic model based on the kane s method tarn et al 1996 the velocities and accelerations of link j w r t frame 0 can be derived and summarized as a 1 v j 0 j j v ζ r 3 ω j 0 j j ω ζ r 3 and a 2 a j 0 j j a ζ ζ j j a ζ ζ r 3 α j 0 j j α ζ ζ j j α ζ ζ r 3 where v j 0 ω j 0 a j 0 and α j 0 are vectors of linear velocities angular velocities linear accelerations and angular accelerations of link j w r t frame 0 respectively meanwhile j j v j j ω j j a ζ j j α ζ j j a ζ and j j α ζ are corresponding jacobian matrices for velocity and acceleration transformations using a 1 and a 2 all terms in the dynamic model 3 i e m c f e f c b and τ c can be derived and listed as follows a 3 m j 0 n j j v j j ω t m j j j a ζ i j 0 j j α ζ i a j 0 j j a ζ j j α ζ where m j is the mass of link j i j 0 is the inertia matrix of link j and i a j 0 is the added mass matrix w r t frame 0 a 4 c j 0 n j j v j j ω t c 1 c 2 c 3 where c 1 indicates terms generated by all links whereas c 2 and c 3 denote those caused by added mass as in a 5a c 1 m j j j a ζ i j 0 j j α ζ s j j ω ζ i j 0 j j ω ζ a 5b c 2 i a j 0 j j a ζ ζ a f 0 s j 0 ω ζ j j v ζ v f 0 j j α ζ s j 0 ω ζ j j ω a 5c c 3 s j j ω ζ o 3 3 s j j v ζ v f 0 s j j ω ζ i a j 0 j j v v f 0 j j ω where s is the skew symmetric matrix meanwhile v f 0 and a f 0 are the fluid velocity and fluid acceleration w r t frame 0 respectively a 6 f e j 0 n j j v j j ω t f e 1 j j 0 v j 0 ω t f e 2 j 1 n j j v j j ω t f e 3 j where f e 1 j j 0 n denotes the sum of gravity buoyancy and fluid acceleration forces exerting on link j f e 2 represents the fluid drag force acting on vehicle body i e link 0 and f e 3 j j 1 n is the fluid drag force acting on each link of manipulator with expressions in a 7a f e 1 j m j g 0 ρ v j g 0 a f 0 o 3 1 a 7b f e 2 π 2 ρ c d 0 r 0 2 j 0 v ζ v f 0 j 0 v ζ v f 0 o 3 1 a 7c f e 3 j ρ c d j r j l j v f j v f j 1 2 ρ c d j r j l j 2 v f j s r j 0 z j j v f j where g 0 is the gravitational acceleration w r t frame 0 v j l j r j and c d j are the volume length radius and drag coefficient of link j respectively the fluid density is denoted by ρ the relative velocity of link j w r t the fluid normal to the link along the length of the link is represented by v f j as in a 8 v f j j j v ζ v f 0 j j v ζ v f 0 r j 0 z j j r j 0 z j j where r j 0 is the rotation matrix from frame j to frame 0 and z j j 0 0 1 t is the unit vector of z axis note that the in a 8 indicates the dot product of the two adjacent items a 9 f c b j e e θ q t f c where f c f c x f c y f c z t is the vector of contact forces with elements parallel to x y and z axis of frame i respectively j e e θ q is the jacobian matrix in 2 a 10 τ c τ v t τ m t t where τ v 6 dof is the vector of control forces and torques acting on the cm of the vehicle and τ m n dof is the vector of control inputs for the joints of the manipulator appendix b proof of theorem 1 considering property 1 a lyapunov candidate function v can be defined as b 1 v 1 2 σ t m i σ using property 1 there exists b 2 p 1 2 σ 2 v p 2 2 σ 2 combining 15 and 20 leads to b 3 σ η η e q σ η η e q applying property 2 the derivative of v is obtained as b 4 v σ t m i σ 1 2 σ t m i σ σ t m i σ σ t c i σ substituting b 3 into b 4 and considering 8 yields b 5 v σ t γ c γ e m i η e q c i η e q f e i substituting 19 into b 5 and considering bounds in 12 b 6 v d σ σ t k s σ m i η e q c i η e q f e i σ t k s σ d σ σ δ m i η e q δ c i η e q δ f e i considering 21 b 6 becomes b 7 v λ m i n k s σ 2 ε σ where λ m i n is the minimum eigenvalue operator using b 2 b 7 becomes b 8 v λ m i n k s σ 2 ε σ k 1 v k 2 v where k 1 2 λ m i n k s p 2 and k 2 ε 2 p 2 thus we can write b 9 v v 0 k 2 k 1 e k 1 t 2 k 2 k 1 which means that in finite time σ 0 and σ 0 and the i auv system presented in 8 is stable under control law given in 19 while achieving the desired impedance in 13 appendix c supplementary data supplementary material related to this article can be found online at https doi org 10 1016 j oceaneng 2019 106855 appendix c supplementary data the following is the supplementary material related to this article video s1 experimental video and results for contact interventions of an i auv 
22188,the present study aims to evaluate the free surface effect on the maneuverability of an axisymmetric underwater vehicle uv in the horizontal plane therefore the hydrodynamic captive tests including the straight ahead resistance drift and rotating arm tests are performed over various submergence depths by using urans equations with a reynolds stress turbulence model available in the commercial code starccm to assess the maneuverability the forces and moments generated by the velocity components which are obtained from captive tests are implemented in the maneuvering equations moreover analytical equations are used to calculate the loads arising from the uv accelerations thrust and rudder which are all assumed to remain constant with respect to depth the results show that the behavior of the lateral force and yaw moment generated by the uv stern region reduces significantly the uv stability over the entire range of depths the results further show that as the uv approaches the free surface the behavior of the lateral force and yaw moment induced by the region between the uv midlength and aft shoulder increases the uv stability which consequently decreases the maneuverability keywords free surface effect dynamic stability maneuverability hydrodynamic forces and moments underwater vehicle uv suboff geometry urans equations 1 introduction menuvering simulations of underwater vehicles uvs in six degrees of freedom are usually performed by using the standard equations of motion proposed by gertler and hagen 1967 in this mathematical model which is considered as the first official dynamic model to perform the maneuverability tests of the uvs the hydrodynamic forces and moments acting on the uv hull constitute the heart of the model these forces and moments are classified into two general categories forces and moments arising from the uv velocities and forces and moments generated by the uv accelerations gertler and hagen 1967 to improve the maneuverability predictions of the uvs the model proposed by gertler and hagen 1967 has been followed by a series of modifications to account for several effects such as the effect of the interaction between the sail trailing vortex and the hull feldman 1979 the effect of the slipstream of propeller on the control surfaces smith et al 1978 and recently the effect of the presence of the calm water free surface polis et al 2013 which all are neglected in the original model in this respect due to a significant increase in the strategic requirement for uvs to operate in the littoral and near surface environments the evaluation of the free surface effect on the hydrodynamics and dynamics of the uvs has stimulated extensive studies in hydrodynamics polis et al 2013 saout and ananthakrishnan 2011 dawson 2014 jagadeesh and murali 2010 mansoorzadeh and javanmard 2014 nematollahi et al 2015 salari and rava 2017 broglia et al 2006 carrica et al 2016 dubbioso et al 2017 shariati and mousavizadegan 2017 and amiri et al 2018 2019b a an immediate consequence of a uv traversing close to the calm water free surface is the creation of surface gravity waves that are stationary with respect to the body as is well known from newman 1977 the energy required for the creation of this surface wave system leads to an increase in the hydrodynamic forces generated by the velocity components on a shallowly submerged uv likewise as shown by amiri et al 2018 2019b the increase in the hydrodynamic forces arising from the velocity components with a decrease in submergence depth can also be explained through the effect of the free surface deformations on the dynamic pressure distribution around the uv hull in this regard as demonstrated by amiri et al 2018 2019b the crests and troughs of the self induced wave system of a shallowly submerged uv modify the dynamic pressure distribution around the uv hull by creating local regions of high and low dynamic pressure respectively along the body length the degree of modification introduced by the free surface deformations into the dynamic pressure distribution around the uv hull depends on the submergence depth the less the submergence depth the more will be the free surface deformations which consequently increases the free surface effect on the dynamic pressure distribution amiri et al 2018 2019b thus from a theoretical point of view all of the external forces and moments acting on a uv traveling beneath the free surface are subject to change in response to decreasing the submergence depth therefore the calm water free surface effect on a shallowly submerged uv hydrodynamics maneuverability and operations can be significant consequently a well founded understanding of the hydrodynamics and dynamics of a shallowly submerged uv traveling in a close proximity to the free surface is required to enable the prediction of the uv maneuverability with the presence of the free surface in the previous studies the evaluation of the free surface uv interaction has been restricted mainly to the uvs traveling with a constant advance velocity along a straight path with little attention paid to the maneuverability evaluation of the uvs with the presence of the free surface polis et al 2013 saout and ananthakrishnan 2011 dawson 2014 jagadeesh and murali 2010 mansoorzadeh and javanmard 2014 nematollahi et al 2015 salari and rava 2017 broglia et al 2006 carrica et al 2016 dubbioso et al 2017 shariati and mousavizadegan 2017 and amiri et al 2018 2019b a the studies performed by saout and ananthakrishnan 2011 carrica et al 2016 and dubbioso et al 2017 are among the few works conducted to evaluate the dynamic stability and maneuverability of a uv traveling close to the free surface in this regard saout and ananthakrishnan 2011 evaluates the dynamic stability of a uv traveling in the horizontal plane both at infinite depth and close to the free surface at a submergence depth equal to h 1 5 d d uv maximum diameter by conducting the corresponding planar motion mechanism pmm tests using a potential solver the results indicate that the presence of the free surface increases the dynamic stability of uvs in the horizontal plane which is associated with the radiation damping effect induced by the surface generated waves moreover carrica et al 2016 performs the free running self propulsion experiments and simulations of a uv operating over various submergence depths the simulations are carried out by using urans equations coupled with k ε and k ω turbulence models the obtained results show that cfd is generally able to predict the behavior of a uv traversing beneath the free surface additionally the numerical and experimental results of the free running self propulsion tests near the free surface demonstrate the presence of a strong upward lift force acting on the uv aft part which produces a bow down moment over the hull furthermore dubbioso et al 2017 performs the free running turning maneuvers of a uv in the horizontal plane by using rans equations with the one equation turbulence model of spalart and allmaras at submergence depths of h 1 75 d d uv maximum diameter for various rudder deflections the obtained results demonstrate that for the depths considered the presence of the free surface has negligible effect on the turning maneuver of a uv therefore the results obtained by dubbioso et al 2017 somehow contradict the results presented by saout and ananthakrishnan 2011 since it is shown by saout and ananthakrishnan 2011 that the free surface increases the dynamic stability of uvs which certainly affects the maneuverability of the vehicles from the literature review just presented it is clear that very few works have been performed toward the maneuverability evaluation of the uvs with the presence of the free surface however a good knowledge of the free surface effect on the maneuverability is extremely useful especially in case of the uvs in which this knowledge can be effectively employed to fine tune the motion controllers before missions in littoral and near surface environments accordingly the main objective of the current study is to evaluate the free surface effect on the maneuverability of an axisymmetric uv traveling close to the free surface in the horizontal plane for simplicity the free surface effect is investigated only on the hydrodynamic forces and moments arising from the uv velocity components therefore the hydrodynamic captive tests including the straight ahead resistance tests drift tests and rotating arm tests are performed by using numerical simulations based on urans equations coupled with a reynolds stress turbulence model these tests are carried out over various submergence depths and proper ranges of uv surge sway and yaw velocity components the numerical simulations are conducted in the commercial code starccm 2014 in this work for the purpose of dynamic stability evaluation of the uv in the horizontal plane over various submergence depths the forces and moments obtained from the simulations of the drift tests and rotating arm tests are used to calculate the linear hydrodynamic coefficients over various submergence depths by using the linear least squares method in addition for the purpose of maneuverability evaluation over various submergence depths the hydrodynamic forces and moments obtained from the simulations of the hydrodynamic captive tests are implemented in the standard equations of motion proposed by gertler and hagen 1967 further analytical equations are used to calculate the forces and moments due to the uv accelerations thrust and rudder which are all assumed to remain constant with respect to submergence depth in this work a 1 1 scale of the bare hull axisymmetric suboff geometry with principal dimensions presented by groves et al 1989 is used to fulfill the main objective of this study various experiments were planned and conducted for the model such as etebari et al 2008 wilson haffenden et al 2010 and roddy 1990 the data obtained from these experiments are used to validate the numerical hydrodynamic captive tests performed in the present study 2 methodology 2 1 dynamics of uvs 2 1 1 maneuvering equations for totally submerged uvs in the horizontal plane the body fixed s x 0 y 0 z 0 and the earth fixed o x y z coordinate systems that are used to analyze the dynamics of a uv are shown in fig 1 origin o of the earth fixed coordinate system coincides with the calm water free surface level and positive z axis points downward additionally origin s of the body fixed frame is located at the axial location of 0 462 l from the nose with positive x 0 axis points toward the bow and y 0 axis points positively toward the starboard herein l denotes the uv overall length in the horizontal plane the position of the uv relative to the earth fixed reference frame is expressed by x and y while the orientation is defined by ψ about z axis see fig 1 fossen 1994 u v and r are the axial lateral and yaw angular velocity components respectively relative to the body fixed frame fossen 1994 see fig 1 also x y and n are used to describe the forces and moment acting on the vehicle in the body fixed frame in the horizontal plane fossen 1994 in this regard x indicates the axial force y the lateral force and n the yawing moment the standard equations of motion in non dimensional form proposed by gertler and hagen 1967 for maneuvering predictions of totally submerged uvs in the horizontal plane can be written as follows surge 1 m u v r x g r 2 x u u x u u u u x v v v v x r r r r x δ r δ r δ r 2 t 1 t sway 2 m v u r x g r y v v y r r y v v y v v v v y r r y r r r r y δ r δ r yaw 3 i z r m x g v u r n v v n r r n v v n v v v v n r r n r r r r n δ r δ r where the primed symbols imply the dimensionless variables note that the nondimensionalisation is carried out based on lewis 1988 in this regard to obtain the nondimensional form the force terms are divided by 0 5 ρ u 2 l 2 while the moment terms are divided by 0 5 ρ u 2 l 3 where u indicates the velocity magnitude in the horizontal plane i e u u 2 v 2 in these equations x g is the dimensionless x 0 coordinate of the center of gravity m is the dimensionless uv mass and i z is the dimensionless moment of inertia about z 0 axis it is further assumed that the axis through s x 0 y 0 z 0 are the principal axes of inertia and y 0 and z 0 coordinates of the center of gravity are zero i e y g z g 0 similarly x u y v y r n v and n r are the dimensionless hydrodynamic added mass coefficients moreover x u u x v v y v y v v n v n v v x r r y r y r r n r and n r r are the dimensionless hydrodynamic coefficients arising from the velocity components furthermore x δ r δ r y δ r and n δ r are the dimensionless hydrodynamic coefficients of the rudder and δ r is the effective angle of rudder deflection relative to the inflow velocity also t is the thrust deduction factor and t is the dimensionless thrust force generated by the propeller as can be seen in eqs 1 3 the external forces and moments right hand side of these equations are considered as a superposition of several forces and moments i e the forces and moments generated by the uv velocity and acceleration components control surfaces and propeller the hydrodynamic forces and moments exerted on a uv due to acceleration or deceleration are assumed to be linear with respect to the uv acceleration components in this study these forces and moments are further assumed to remain constant with respect to depth and thus are estimated using the analytical equations proposed by humphreys and watkinson 1978 which are obtained for a prolate spheroid moving through an infinite volume of stationary ideal fluid in this regard the uv is assumed to be a prolate spheroid with axes equal to the length and maximum diameter of the uv accordingly the following expressions are given by humphreys and watkinson 1978 to estimate the hydrodynamic added mass coefficients 4 x u k 1 m 5 y v k 2 m 6 n r k i z 7 y r x b x g y v 8 n v x b x g y v where x b indicates the dimensionless x 0 coordinate of the center of buoyancy relative to the body fixed reference frame the definition of k factors in eqs 4 6 can be found in humphreys and watkinson 1978 additionally based on eqs 1 3 the relationship between the x force and u is expressed by a purely odd quadratic polynomial function on the other hand the x force in terms of v and r velocity components is approximated by purely even quadratic polynomial functions moreover purely odd quadratic polynomial functions are used to approximate the lateral y force and yaw n moment arising from both the lateral velocity v and the angular yaw velocity r note that the axial hydrodynamic x force arising from the axial velocity u can be obtained through performing the straight ahead resistance tests over a range of u velocities lewis 1988 the axial hydrodynamic coefficient x u u given in eq 1 is then estimated by fitting the polynomial function to the axial x forces obtained from the straight ahead resistance tests via the linear least squares method in addition the hydrodynamic forces and moments arising from the lateral velocity v can be obtained through performing the static drift tests as shown in fig 2 over a range of lateral velocities which are defined as v u sin β with β being the drift angle fig 2 lewis 1988 the hydrodynamic coefficients x v v y v y v v n v and n v v given in eqs 1 3 are then estimated by fitting the polynomials to the x forces y forces and n moments obtained from the drift tests via the linear least squares method likewise the hydrodynamic forces and moment generated by the yaw rate r can be obtained by performing the rotating arm tests as shown in fig 3 over a range of yaw rates r feldman 1995 and lewis 1988 the yaw hydrodynamic coefficients x r r y r y r r n r and n r r given in eqs 1 3 are then estimated by fitting the polynomials to the x forces y forces and n moments obtained from the rotating arm tests via the linear least squares method in this study it is assumed that the uv under consideration is equipped only with a vertical rudder in the aft region which is used for maneuvering in the horizontal plane fig 4 as can be seen in eqs 1 3 the relationship between the x force and the effective angle of rudder deflection δ r is purely even while this relationship for the y force and n moment is purely odd the effective angle of rudder deflection δ r is equal to the sum of the user defined deflection δ r 0 and the deflection formed due to both the linear lateral and angular yaw velocity components δ r fig 5 9 δ r δ r 0 δ r where δ r is defined as 10 δ r atan x r r v u where x r is the distance between the rudder s location and the center of the local coordinate system in this paper it is assumed that the loads generated by the rudder remain unchanged with respect to depth further to calculate the forces and moments generated by the rudder at an effective angle of deflection δ r the semi empirical methods presented by de barros et al 2008 and field 2000 are used in this regard according to field 2000 to calculate the hydrodynamic forces and moments related to the rudder first the lift coefficient c l of the rudder is estimated as 11 c l 1 8 π a r e 1 8 cos γ p 4 a r e 2 cos γ p 4 where a r e is the effective aspect ratio a r e is defined as a function of the rudder span and hull radius at the rudder location and is estimated from the curves presented by de barros et al 2008 as a percentage of the geometrical aspect ratio of the isolated rudder γ p is the sweep angle at one fourth of the chord length after the calculation of c l the x force y force and n moment produced by the rudder are quantified as 12 y 0 5 ρ s r u d i r b c l u 2 δ r 13 x 0 5 ρ s r u d i r b 1 0 9 π a r e c l 2 u 2 δ r 2 14 n 0 5 ρ s r u d x r i r b c l u 2 δ r where ρ is the fluid density and s r u d is the rudder surface area i r b is an empirical coefficient proposed by de barros et al 2008 to account for the interference effect between the body and rudder i r b is also defined as a function of the rudder span and hull radius at the rudder location and is determined from the curves provided by de barros et al 2008 eqs 12 14 are applicable for δ r 25 moreover the contribution of the thrust force to the axial x force is expressed as t 1 t herein the thrust force is estimated as follows 15 t k t j ρ n 2 d p 4 where n is the propeller rotation rate d p the propeller diameter and k t j the normalized thrust coefficient which is expressed as a function of advance velocity ratio j the thrust coefficient can be obtained from the open water propeller performance curves in this regard the following thrust coefficient k t j of the generic seven bladed propeller e1619 which has a diameter equal to d p 0 262 m sezen et al 2018 is used to estimate the thrust force 16 k t j 0 1941 j 2 0 2437 j 0 5375 where j is defined as 17 j u a n d p with u a being the mean flow velocity at the propeller plane u a is related to u through the following equation 18 u a u 1 w where w is referred to as the wake fraction as suggested by triantafyllou and hover 2003 a value of 0 1 is considered for the wake fraction w and a value of 0 2 is assigned to the thrust deduction factor t note that eqs 1 3 lack the hydrodynamic forces and moments related to the coupling effects between the sway and yaw degrees of freedom such as x v r v r since the presence of these terms requires the dedication of much significant time to determine the external forces and moments resulting from them while yet as shown by gao et al 2018 these coupling effects show limited influence on the total forces and moments and therefore can be eliminated 2 1 2 free surface effect on the hydrodynamic forces and moments an immediate consequence of a uv traversing near the free surface is the creation of surface gravity waves that are stationary with respect to the body the creation of this gravity wave system is attributed to the interaction between the dynamic pressure distribution around the hull and the free surface as is well known from newman 1977 the energy required for the creation of the surface wave system generally leads to an increase in the hydrodynamic forces generated by the velocity components likewise as shown by amiri et al 2018 2019b the increase in the forces induced by the velocity components with a decrease in submergence depth can also be explained through the effect of the free surface deformations on the dynamic pressure distribution around the uv hull in this regard as demonstrated by amiri et al 2018 2019b the crests and troughs of the self induced wave system of a shallowly submerged uv modify the dynamic pressure distribution around the uv hull by creating local regions of high and low dynamic pressure respectively along the uv length the degree of modification introduced into the dynamic pressure distribution around the uv hull by the free surface deformations depends on the submergence depth the less the submergence depth the more will be the free surface deformations which consequently increases the free surface effect on the dynamic pressure distribution around the hull amiri et al 2018 2019b therefore from a theoretical point of view all of the external forces and moments on the right hand side of eqs 1 3 are subject to change in response to decreasing the submergence depth however to simplify the free surface effect is considered only on the hydrodynamic forces and moments arising from the velocity components therefore for a shallowly submerged uv these forces and moments are considered as functions of both the velocity components and submergence depth h as can be inferred from the previous section for a totally submerged uv the hydrodynamic forces and moments arising from the velocity components are approximated as quadratic polynomial functions in terms of the velocity components besides as mentioned earlier the change in the hydrodynamic forces and moments with respect to depth is inevitable therefore to account for the free surface effect on the uv maneuverability the question may come up that whether to maintain the equations of motion for a totally submerged uv given in eqs 1 3 with the hydrodynamic forces and moments obtained for a specific submergence depth or to formulate a new set of equations of motion with the hydrodynamic forces and moments defined explicitly in terms of both the velocity components and submergence depth in this regard extending the quadratic polynomial functions which approximate the hydrodynamic forces and moments in terms of the uv velocities to account explicitly for the submergence depth effect increases notably the regression problem with considerable identification effort since as shown by dawson 2014 and amiri et al 2018 the free surface effect on the hydrodynamic forces and moments induced by the velocity components increases exponentially with a decrease in submergence depth h thus in this research for simplicity and also to fulfill the main purpose of this study the maneuverability analysis is performed using eqs 1 3 with the hydrodynamic forces and moments arising from the velocity components obtained at several submergence depths beneath the free surface therefore in this research an attempt is made to propose appropriate functions that approximate the hydrodynamic forces and moments acting on a shallowly submerged uv in terms of each velocity component at a desired submergence depth beneath the free surface for this purpose the forces and moments resulting from each velocity component are closely examined as follows axial x force due to axial velocity component u in case of a shallowly submerged uv traveling beneath the free surface the axial x force has an oscillatory behavior with respect to the axial velocity component which emanates from the interference effects between the dominant wave systems inside the submarine wake amiri et al 2018 therefore in this case the utilization of a quadratic polynomial function in terms of u velocity component as given in eq 1 may not adequately represent the axial force as a function of u thus the axial force exerted on a shallowly submerged uv is stored in a one dimensional tabular form at various submergence depths as x f u h and a cubic interpolation is used to express the axial x force as a function of axial velocity u for a desired submergence depth in the maneuvering equations hydrodynamic forces and moment due to the lateral velocity component v in this case the advent of the wave making resistance probably modifies the forces and moment arising from the lateral velocity v however as is shown later in the result section the forces and moment arising from the lateral velocity component v acting on a shallowly submerged uv the same as those acting on a totally submerged one are approximated reasonably well by using quadratic polynomial functions in terms of sway velocity v this is due to the negligible interference effects between the wave systems generated by the sway velocity component v at points along the body length which unlike the axial force resulting from the u velocity component does not provoke an oscillatory behavior in the forces and moment generated by the lateral velocity therefore in this case the hydrodynamic forces and moment are expressed as follows 19 x x v v h v v 20 y y v h v y v v h v v 21 n n v h v n v v h v v where x v v h y v h y v v h n v h and n v v h are the dimensionless hydrodynamic coefficients as a function of submergence depth h which are obtained at several submergence depths in a range of h m i n h hydrodynamic forces and moment due to the angular yaw velocity component r in this case again as is shown later in the result section the forces and moment generated by the angular yaw velocity component r on a shallowly submerged uv the same as those acting on a totally submerged one are approximated reasonably well using quadratic polynomial functions in terms of r this is also due to the negligible interference effects between the wave systems generated by the yaw velocity component r at points along the body length which contrary to the axial force resulting from the u velocity component does not provoke an oscillatory behavior in the forces and moment produced by the angular yaw velocity therefore in this case the hydrodynamic forces and moment are expressed as follows 22 x x r r h r r 23 y y r h r y r r h r r 24 n n r h r n r r h r r where x r r h y r h y r r h n r h and n r r h are the dimensionless hydrodynamic coefficients as a function of submergence depth h which are obtained at several submergence depths in a range of h m i n h therefore the maneuvering equations for a shallowly submerged uv in the horizontal plane are closely similar to the maneuvering equations for the deeply submerged one given in eqs 1 3 however the forces and moments generated by the velocity components are obtained at several submergence depths in a range of h m i n h to reflect the effect of the presence of the free surface on the maneuverability of the uv in the horizontal plane 2 1 3 dynamic stability of uvs in the horizontal plane to evaluate the dynamic stability of uvs in the horizontal plane herein the classical criterion given by lewis 1988 is used this criterion is written as follows 25 n r m x g y r m n v y v 0 eq 25 is obtained from the linearized equations of motion in sway and yaw directions in this equation the first term corresponds to the lever of the hydrodynamic moment generated by the angular yaw velocity component l r and the second term corresponds to the lever of the hydrodynamic moment generated by the lateral velocity component l v consequently the stability criterion states that for the uv to be stable the l r must be larger than the l v mathematically it is written as 26 l r l v 0 taking into account the contribution of the rudder into the linear hydrodynamic coefficients as shown by lewis 1988 eq 25 can be rewritten as follows 27 n r m x g x r n δ r y r m x r y δ r n v n δ r y v y δ r 0 note that n δ r is always negative and y δ r is always positive lewis 1988 accordingly as mentioned by lewis 1988 it can be inferred that the rudder always acts to stabilize the uv even when it has no deflection in other words based on eq 27 it can be clearly seen that the rudder contributes to the stabilizing force and moment generated by the yaw rate while it diminishes the destabilizing effect caused by the force and moment induced by the sway velocity thus in cases where the uvs are inherently unstable a proper adjustment of rudder size can stabilize the uvs to a desirable level more generally the dynamic stability criterion sc given in eq 27 for a uv traveling in the horizontal plane at a submergence depth h is written as follows 28 sc n r h m x g x r n δ r y r h m x r y δ r n v h n δ r y v h y δ r 0 where the coefficients n r h y r h n v h and y v h are obtained at several submergence depths in a range of h m i n h beneath the free surface to reflect the free surface effect on the dynamic stability of uvs for various submergence depths 2 2 geometry and computational conditions in this work a 1 1 scale of the bare hull axisymmetric suboff geometry with principal dimensions given in groves et al 1989 is used fig 6 shows the bare hull suboff model along with the body fixed coordinate system the center of the body fixed coordinate system is located at the axial location of 0 462 l from the nose as can be seen in fig 6 the model possesses a bow part a parallel middle part and a stern part the model has a length to diameter ratio equal to l d 8 575 the submergence depth h is defined as the distance between the x 0 s y 0 plane and the calm water free surface level i e the z coordinate of the x 0 s y 0 plane fig 1 in this study to obtain the hydrodynamic axial force acting on the suboff the straight ahead resistance tests are performed over froude numbers and submergence depths ranging from f n 0 205 to f n 0 512 and from h 1 1 d to h respectively similarly to estimate the hydrodynamic forces and moment arising from the lateral velocity the drift tests are carried out at a constant advance velocity based on f n 0 512 for submergence depths and drift angles ranging from h 1 1 d to h and from β 0 v 0 to β 18 11 v 0 31 respectively moreover to calculate the forces and moment generated by the angular yaw velocity the rotating arm tests are performed at a constant advance velocity based on f n 0 512 over submergence depths and yaw angular velocities ranging from h 1 1 d to h and from r 0 05 to r 0 4 respectively the validation of the straight ahead resistance tests is performed using the experimental resistance force data provided by wilson haffenden et al 2010 the experiments of wilson haffenden et al 2010 are performed on a 1 2 8 scale suboff model over submergence depths and froude numbers ranging from h 1 1 d to h 3 3 d and from f n 0 128 to f n 0 640 respectively moreover to support the suboff model during the experiments a mounting device composed of a vertical post and a horizontal sting is used wilson haffenden et al 2010 also to validate the drift tests the experimental data of the forces and moment acting on a 1 1 scale suboff model given by roddy 1990 is used the experiments are performed for h at a constant advance velocity based on f n 0 512 over drift angles ranging from β 0 v 0 to β 18 11 v 0 31 additionally to support the suboff model during the experiments two naca0015 struts are used furthermore the validation of the rotating arm tests is performed using the experimental data of the forces and moment acting on a 1 1 scale suboff model provided by etebari et al 2008 the experiments are carried out for h at a constant advance velocity based on f n 0 236 over drift angles and yaw angular velocities ranging from β 3 8 to β 16 5 and from r 0 3577 to r 0 3702 respectively during the experiments while the suboff is supported using the same technique as that used by wilson haffenden et al 2010 it undergoes a turning motion at different yaw angular velocities and drift angles note that the utilization of the horizontal sting to support the suboff during the experiments conducted by etebari et al 2008 and wilson haffenden et al 2010 requires the truncation of the model in the stern region therefore the presence of the sting due to a reduction in the hull surface area together with the modification that it introduces into the pressure distribution over the stern region affects the forces and moments acting on the uv amiri et al 2018 accordingly in this work to validate the rotating arm tests using the data provided by etebari et al 2008 the simulations are performed with the presence of the support as shown in fig 7 nonetheless modeling the shallowly submerged suboff uv with the presence of the support used during the experiments conducted by wilson haffenden et al 2010 results in a remarkable increase in the computational effort therefore the simulations of the straight ahead resistance tests are performed without the presence of the support however it is worthwhile mentioning that as shown by amiri et al 2018 the presence of the support used by wilson haffenden et al 2010 increases approximately 10 the resistance force experienced by the suboff when it travels in a close proximity to the free surface 2 3 numerical model as the average values of the forces and moments are sufficient to fulfill the main objective of the present study herein the incompressible fluid motion is modeled using the urans equations coupled with the reynolds stress turbulence model proposed by speziale et al 1991 moreover in the simulations with the presence of the free surface to model the sharp interface between the water and air volume of fluid vof method along with the high resolution interface capturing scheme hric is employed hirt and nichols 1981 as mentioned earlier the simulations are performed in the commercial code starccm which discretizes the integral form of the governing equations by using the finite volume method the simulations without the presence of the free surface are conducted as steady while the simulations with the presence of the free surface are conducted as unsteady in both steady and unsteady simulations the convection and diffusion terms are discretized by using second order schemes additionally in the unsteady simulations a first order implicit scheme is used to discretize the transient term as recommended by starccm 2014 in the simulations with the presence of the free surface the time step size is calculated by wave period number of cells per wavelength to calculate the wave period and wavelength of the uv wave system as shown by amiri et al 2019b the dispersion relation of linear surface waves in a deep water condition is used moreover a simple type solver is used to control the overall solution starccm 2014 in this work it is assumed that the convergence of the simulations is achieved once the mean value of the forces and moments converges to nearly constant value with oscillations within 2 3 of the mean value accordingly using this criterion the convergence of the steady simulations is achieved after about 1400 iterations while the simulation duration for the convergence of the unsteady simulations is about 25 s 2 4 computational domains boundary conditions and grids in the current study to perform the straight ahead resistance tests along with the drift tests the computational domain is considered as a rectangular box while to conduct the rotating arm tests a computational domain in a circular form with a rectangular cross section is used fig 8 shows the computational domain used to perform the straight ahead resistance and drift tests at h and figs 9 and 10 show the computational domains used to perform the same tests while with the presence of the free surface i e for 1 1 d h 3 3 d in the simulations of the straight ahead resistance and drift test for h together with the simulations of the straight ahead resistance tests for 1 1 d h 3 3 d due to the symmetry of the fluid flowing around the suboff only half of the uv is modeled while in the drift tests with the presence of the free surface due to a possible asymmetry in the fluid flowing around the suboff the uv model is fully simulated the upstream boundary is consistently considered as a velocity inlet where a uniform velocity is specified based on froude number and the downstream boundary is considered as a pressure outlet for h a relative pressure equal to zero is prescribed at the downstream boundary while for 1 1 d h 3 3 d a hydrostatic pressure is specified in this boundary in the totally submerged simulations the side bottom and top boundaries are treated as symmetry walls while in the simulations with the presence of the free surface to reduce the fluid reflection from the top and bottom boundaries a velocity inlet is used at these boundaries also for 1 1 d h 3 3 d the boundaries at two sides the same as that used for h are treated as symmetry boundaries in the simulations with the presence of the free surface to eliminate the wave reflections at the boundaries located at the downstream and two side s a damping zone is established next to these boundaries as can be seen in figs 9 a and 10 a in this zone a source term which acts as a resistance force is added to the momentum equation of the vertical velocity component to cancel this velocity component over the damping zone in this study a linear source term as a function of vertical velocity component with a coefficient defined as f 1 π ω is added to the momentum equation of the vertical velocity component over the damping zone which has a thickness equal to the length of the uv generated wave system this configuration for the source term and the damping zone thickness is recommended by perić and abdel maksoud 2016 for simple flow phenomena and as shown by amiri et al 2018 works satisfactory in the present simulations note that ω is the frequency of the wave system generated by the uv finally fig 11 a and b depict the computational domains used to simulate the rotating arm tests for h and for 1 1 d h 3 3 d respectively for h due to the symmetry of the problem regarding the x 0 s y 0 plane only half of the uv is modeled while for 1 1 d h 3 3 d the suboff uv is fully simulated note that in both cases the distances of the boundaries from the suboff are considered the same as those used to perform the straight ahead resistance and drift tests furthermore the boundary conditions are predominantly the same as those used to carry out the straight ahead resistance and drift tests except for the boundaries located at two sides of the domain in this regard to prevent any fluid reflection a velocity inlet is also used at the two boundaries located at two sides which as a result facilitates the iterative convergence of the simulations related to the rotating arm tests it is worthy to mention that in this study the rotational motion is implemented by rotating the flow around the stationary suboff uv which is the same approach used in the research conducted by toxopeus et al 2012 therefore since a rotating coordinate system is adopted to perform the simulations of the rotating arm tests the coriolis and centrifugal forces resulting from the computation in a rotating reference frame are added to the momentum equations as source terms note that in all the simulations in this study a no slip boundary condition is imposed over the suboff model it is also worthwhile mentioning that the dimensions of the computational domains have been set based on the results given by amiri et al 2019c which demonstrate that the dimensions used for the computational domains in the present study have negligible influence on the global variables the grid in this study is generated automatically by starccm using two different methods prism layer and trimmer the trimmer mesh is used to discretize almost the entire computational domain except for the region close to the body surface this mesh is mainly composed of hexahedral cells with a small number of trimmed cells next to the uv hull to accommodate the body additionally the prism layer mesh which is constructed from orthogonal prismatic cells is employed to capture near wall turbulence in this mesh a geometric progression with an expansion factor of 1 1 is used to increase progressively the thickness of the prismatic cells from the inner cell immediately next to the uv hull to the outer cells furthermore as the turbulence model used in this study employs the standard wall function the first cell immediately next to the body surface resides within the logarithmic region of the boundary layer this corresponds to y values in a range from 30 to 100 moreover to capture properly the wave system generated by the uv together with the pressure drop in the wake region of the suboff local mesh refinements are utilized for instance to capture adequately the wave system generated by the uv at least 15 cells per wave height in the direction normal to the undisturbed free surface and 80 cells per wavelength in the direction parallel to the undisturbed free surface discretize the free surface in this regard figs 12 14 show the grids used to simulate the straight ahead resistance tests drift tests and rotating arm tests respectively local mesh refinements applied during the mesh generation process can be clearly identified in these figures 3 verification and validation 3 1 grid convergence study the grid convergence study is carried out over three grids namely i i i and i i i for each hydrodynamic test at two different computational conditions without and with the presence of the free surface i e for h and h 1 1 d in this regard the grid is uniformly refined using a refinement factor equal to 1 2 in all the dimensional directions accordingly the grid convergence study for the straight ahead resistance tests is carried for h and f n 0 466 and for h 1 1 d and f n 0 462 between three grids i i i and i i i as shown in table 1 moreover this study for the drift tests is carried out for h f n 0 512 and β 18 11 v 0 31 and for h 1 1 d f n 0 512 and β 18 11 v 0 31 between three grids i i i and i i i as shown in table 2 furthermore the grid convergence study for the rotating arm tests is performed for h f n 0 236 r 0 3702 and β 16 5 and for h 1 1 d f n 0 512 and r 0 4 between three grids i i i and i i i as shown in table 3 note that the simulations at h are performed with the presence of the support used in the experiments conducted by etebari et al 2008 in the simulations with the presence of the free surface i e for h 1 1 d the spatial grid refinement is accompanied by a temporal refinement however since the orders of accuracy are different in space and time the temporal refinement factor is defined in such a manner so as to obtain the same order of error reduction in both the temporal and spatial discretizations richards 1997 accordingly as a second order scheme is used for spatial discretization and a first order one for temporal discretization temporal refinement factor is chosen as the square of the spatial refinement factor richards 1997 in this regard in the simulations at h 1 1 d the time step size for grid i i is calculated as wave period number of cells per wavelength and then is adjusted in the corresponding grids i and i i i based on the square of the spatial refinement factor as mentioned above table 4 shows the time steps used in the simulations of the static tests at h 1 1 d therefore using the sets of grids presented above the simulations are performed to calculate the x force from the straight ahead resistance tests for h and h 1 1 d additionally from the drift tests for h and h 1 1 d the x force y force and n moment are calculated furthermore the simulations of the rotating arm tests are performed for h and h 1 1 d to estimate the x force y force and n moment tables 5 7 show the normalized values of the forces and moments obtained from the corresponding simulations the grid convergence ratio which is required for the estimation of the order of discretization p g together with the grid uncertainty u g is estimated as follows 29 r g ε g 32 ε g 21 where ε g 32 s i i i s i i is the variation in the forces moments between grids i i and i i i and ε g 21 s i i s i is the variation in the forces moments between grids i and i i the values of r g indicate the following four conditions stern et al 2006 1 0 r g 1 monotonic convergence 2 1 r g 0 oscillatory convergence 3 r g 1 monotonic divergence 4 r g 1 oscillatory divergence for conditions 3 and 4 where the grid divergence occurs no order of discretization and uncertainty can be calculated for condition 2 only the uncertainty is calculated as 30 u g 1 2 s u s l where s u and s l are the maximums and minimums of the oscillations of the forces and moments stern et al 2006 for condition 1 where the grid convergence occurs and the forces and moments show asymptotic monotonic convergence the generalized richardson extrapolation based on the procedure proposed by mchale and friedman 2009 which is used recently by the present authors in amiri et al 2018 2019b is employed to calculate the order of discretization and grid uncertainty the values of r g p g and u g related to the forces and moments obtained from grids i i for h 1 1 d and h are given in tables 8 10 based on the values of r g almost all the forces and moments show an asymptotic monotonic convergence behavior except for the x force obtained from the simulation of the rotating arm tests at h 1 1 d which shows an oscillatory convergence behavior in cases with super convergence of the observed order of discretization i e p g 2 the theoretical value of p g i e 2 is used instead of the observed p g to calculate the grid uncertainty as recommended by eça and hoekstra 2009 since according to eça and hoekstra 2009 the super convergence of the observed p g is unreliable and is only the consequence of several factors such as the boundary conditions non linearities exist in the problem turbulence modeling and mesh quality generally the small values of the u g demonstrate the negligible sensitivity of the solutions to the grid resolution finally as the changes in the forces and moments between grids i i and i i i are indeed smaller than the changes in the forces and moments between grids i and i i the grids i i are chosen to perform the rest of the simulations in this study 3 2 validation to validate the simulations of the straight ahead resistance tests the normalized x force obtained from these simulations is compared against the measured one given in wilson haffenden et al 2010 for 1 1 d h 3 3 d the uncertainty in the measurement of the x force in the experiments conducted by wilson haffenden et al 2010 is reported to be within 3 1 note that the uncertainty reported by wilson haffenden et al 2010 does not include the contribution of the support used during the experiments fig 15 depicts the normalized calculated and measured x forces the general trends of the calculated x force are similar to those of the measured one the average comparative difference between the calculated and measured x forces is about 10 27 this relatively large difference is attributed to the presence of the support used in the experiments which as shown by amiri et al 2018 considering its effect increases the x force prediction by about 10 and consequently reduces this difference to a point where it falls within the experimental uncertainty bound to validate the simulations of the drift tests the normalized x force y force and n moment obtained from these simulations are compared against the experimental data given by roddy 1990 for h the uncertainty in the measurements of the x force y force and n moment is reported to be 10 which does not include the contribution of the mounting device fig 16 a b and c depict the normalized calculated and measured x forces y forces and n moments respectively the calculated forces and moment are found to be in a fairly good agreement with the measured ones the average comparative differences between the numerical and experimental x forces y forces and n moments are about 4 01 7 07 and 5 58 respectively therefore the calculated x force y force and n moment are well within the experimental uncertainty bound finally to validate the simulations of the rotating arm tests the normalized x force y force and n moment obtained from these simulations are compared against the experimental data given by etebari et al 2008 for h as mentioned earlier the simulations are performed with the presence of the support shown in fig 7 the experiments incorporate two captive tests the rotating arm and drift tests in a single test which is the case of a uv undergoing a steady turning maneuver the uncertainty in the measurements of the x force y force and n moment in the experiments is reported to be within 8 1 4 9 and 4 1 respectively fig 17 a b and c show the normalized calculated and measured x forces y forces and n moments as can be seen the numerical model captures reasonably well the general trend of the experimental data the average comparative differences between the calculated and measured x forces y forces and n moments are approximately 4 32 4 78 and 4 04 respectively thus the calculated x force y force and n moment fall within the experimental uncertainty bound 4 results and discussion 4 1 hydrodynamic forces and moments arising from the velocity components acting on the suboff over various submergence depths fig 18 exhibits the hydrodynamic forces and moments acting on the suboff in the horizontal plane for various uv velocity components and submergence depths in this regard fig 18 a shows the normalized hydrodynamic axial x force for various axial velocities and submergence depths significant increase is observed in the x force with a decrease in submergence depth which as is well known arises from the advent of the wave making resistance component newman 1977 at the shallowest submergence depth the oscillatory behavior of the x force mainly has to do with the interference effects between the dominant bow and aft shoulder waves inside the uv wake on the free surface as shown by amiri et al 2018 2019a fig 19 a shows the free surface elevation in straight ahead test for h 1 1 d and f n 0 512 as can be seen at this condition the uv generated wave system closely resembles the classical kelvin wave pattern additionally fig 18 b c and d show the normalized hydrodynamic x force y force and n moment for various lateral velocities and submergence depths as the uv approaches the free surface a significant increase is observed in the x force and y force over the entire range of lateral velocities as mentioned earlier this is due to the advent of the wave making resistance component newman 1977 at the shallowest submergence depth an increase in the lateral velocity gives rise to an increase in the x force whereas at larger submergence depths increase in this velocity component results in a reduction in the x force as shown by amiri et al 2019b this has to do with the interaction between the free surface and the vortical flow structure formed on the leeward side of the uv at a drift angle in this regard at the shallowest submergence depth this interaction causes an increase in the free surface deformations which consequently increases the x force due to an increase in the wave making resistance component nonetheless at large submergence depths the influence of the leeward vortical flow structure on the free surface deformations diminishes drastically amiri et al 2019b moreover over the entire range of submergence depths the y force increases with respect to the lateral velocity which is associated with an increase in the pressure difference between the leeward side and windward side of the uv on the other hand unlike the x force and y force a decrease in submergence depth appears to cause a decrease in the n moment especially at large lateral velocities this behavior of the n moment based on amiri et al 2019b is due to an increase in the y force acting over the aft region of the uv as it approaches the free surface in this regard the y force acting over the aft region induces an n moment in the opposite direction of the total n moment accordingly as with a decrease in submergence depth the y force acting on the aft half part goes up the total n moment acting on the uv undergoes a reduction amiri et al 2019b fig 19 b shows the free surface elevation during the drift test for h 1 1 d f n 0 512 and v 0 31 β 18 11 an asymmetry in the wave pattern about the centerline due to the lateral velocity is noticeable moreover fig 18 e f and g present the normalized hydrodynamic x force y force and n moment for various angular yaw velocities and submergence depths with a decrease in submergence depth a significant increase is observed in the values of the x force y force and n moment over the entire range of yaw velocities which is due to the advent of the wave making resistance component newman 1977 over the entire range of submergence depths while both the y force and n moment increase with respect to the yaw rate the x force appears to remain nearly constant with an increase in the angular yaw velocity further it is observed that the n moment arising from the yaw rate contrary to that arising from the lateral velocity v experiences an increase with a decrease in submergence depth fig 19 c shows the free surface elevation during the rotating arm test for h 1 1 d f n 0 512 and r 0 4 note that due to the negligible interference effects between the wave systems generated by the lateral velocity v and yaw velocity r at points along the suboff length the hydrodynamic forces and moments arising from these velocity components show no periodic behavior with respect to the lateral velocity and angular yaw velocity components see fig 18 b c d e f and g as mentioned correctly in section 2 1 2 4 2 hydrodynamic coefficients in the horizontal plane over various submergence depths this section presents the hydrodynamic coefficients used to express the external forces and moments in the maneuvering equations for various submergence depths accordingly the hydrodynamic coefficients due to velocity components are obtained by fitting the polynomial functions given in eqs 1 3 to the hydrodynamic forces and moments represented in fig 18 via the linear least squares method fig 18 exhibits the fitted polynomial functions to the hydrodynamic forces and moments generated by the uv velocity components besides the added mass coefficients are estimated by using eqs 4 8 furthermore to calculate the hydrodynamic coefficients related to the rudder eqs 12 14 are used table 11 presents the predicted hydrodynamic coefficients for various submergence depths additionally fig 20 shows the behavior of the sway and yaw hydrodynamic coefficients with respect to submergence depth in this figure h 5 5 d corresponds to h since for h d 5 the free surface effect completely vanishes dawson 2014 as can be inferred from table 11 and fig 20 a decrease in submergence depth generally causes a nonlinear increase in the hydrodynamic coefficients except for n v y r r and n r r which reduce as the uv approaches the free surface it is further observed in fig 20 that with an increase in submergence depth the hydrodynamic coefficients appear to approach asymptotically their equivalent totally submerged values 4 3 dynamic stability analysis of the suboff in the horizontal plane over various submergence depths in this section the dynamic stability of the suboff uv is examined over various submergence depths by using eq 28 furthermore to analyze the contribution of the size of the rudder to the dynamic stability the rudder span b v is changed from zero to 2 378 b v 0 where b v 0 is the initial rudder span in this regard fig 21 shows the stability criterion sc eq 28 for various submergence depths and rudder spans it can be inferred from this figure that without the presence of the rudder b v b v 0 0 the suboff uv is inherently unstable for the entire range of submergence depths however at this condition with a decrease in submergence depth the stability increases remarkably this is due mainly to a decrease in the n moment produced by the lateral velocity v and an increase in the y force generated by the same velocity component see fig 18 c and d which results in a decrease in the lever of the hydrodynamic moment generated by the lateral velocity l v in this regard fig 22 shows the values of l v and l r of the suboff bare hull geometry as defined in eq 25 over various submergence depths in this figure h 5 5 d corresponds to h since for h d 5 the free surface effect completely vanishes dawson 2014 as can be inferred from fig 22 while l r slightly increases with a decrease in submergence depth l v undergoes a significant decrease as submergence depth is decreased this largely explains the increase in the dynamic stability as the uv approaches the free surface further details about the dynamic stability of the bare hull axisymmetric suboff uv are presented in the next section by adding the rudder b v b v 0 1 the dynamic stability of the suboff uv is predicted to increase for all the submergence depths however despite the inclusion of the rudder the suboff uv is still predicted to have a negative sc based on fig 21 fortunately it is observed that an increase in the rudder span gives rise to an almost linear increase in the sc values for the entire range of submergence depths noteworthy in fig 21 is the marginal difference between the values of sc at various submergence depths for b v b v 0 1 which indicates the dominance of the rudder in the dynamic stability of the uv the stability is achieved for b v b v 0 1 5 over the entire range of submergence depths based on humphreys and watkinson 1992 a value of sc close to 1 0 means that the uv is overly stable and therefore has a poor maneuverability as recommended by humphreys and watkinson 1992 a value of sc larger than 0 2 and smaller than 0 7 provides the uv with a reasonable level of stability in this regard it is observed that a value of 1 79 b v 0 for the rudder span provides an sc approximately equal to 0 56 0 31 0 29 and 0 28 for h 1 1 d h 2 2 d h 3 3 d and h respectively although the sc values for various submergence depths appear to be within the range recommended by humphreys and watkinson 1992 at large depths the uv possesses a very low level of stability which during the open loop maneuvering simulations leads to kinematic variables well outside the ranges of the ones used to obtain the hydrodynamic forces and moments therefore herein to simulate the maneuvering of the suboff in the horizontal plane a value of 2 18 b v 0 was chosen for the rudder span which is predicted to provide an sc approximately equal to 0 78 0 51 0 48 and 0 47 for h 1 1 d h 2 2 d h 3 3 d and h respectively 4 4 a detailed analysis of the dynamic stability of the bare hull suboff axisymmetric uv in the horizontal plane for various submergence depths in the previous section it is observed that for h the bare hull suboff axisymmetric uv is highly unstable this high level of instability may be due to both a small magnitude of the lever of the hydrodynamic moment generated by the yaw rate l r and a large magnitude of the lever of the hydrodynamic moment produced by the lateral velocity l v in this work it is shown that over the whole range of submergence depths the uv stern region gives rise to both an increase in the l v and a decrease in the l r first the influence of the stern region on the l v is investigated the large magnitude of the l v emanates from either a large value of the n moment or a small value of the y force or even both of which in this regard consider figs 23 and 24 showing the distributions of the y force and n moment respectively generated by the lateral velocity v along the suboff length for v 0 31 over various submergence depths as the suboff has a negative lateral velocity v 0 31 it is expected that all the stations along the uv length generate a positive lateral force however it is seen in fig 23 that an unexpected negative lateral force is generated at the stern region of the suboff over the entire range of submergence depths to investigate the reason for this behavior fig 25 shows the dynamic pressure distribution in x 0 s y 0 plane around the suboff at v 0 31 for various submergence depths from the pressure distributions shown in fig 25 five common fluid flow characteristics over the whole range of submergence depths stand out first is the shift of the bow stagnation region toward the windward side due to the lateral velocity component secondly this shift causes both an increase in the dynamic pressure at the windward forward shoulder and a decrease in the dynamic pressure at the leeward bow region third is the drop in the dynamic pressure at the windward aft shoulder which is attributed to an increase in the velocity of the fluid flowing at this region fourth is the leeward shift of the aft stagnation region which is caused by the drop in the dynamic pressure at the windward aft shoulder finally fifth is the drop in the dynamic pressure at the leeward aft region caused by the leeward vortical flow structure as can be seen in fig 25 over the whole range of submergence depths the decrease in the pressure at the windward aft shoulder region together with the leeward shift of the aft stagnation region is responsible for the windward suction y force exerted over the stern region of the suboff see fig 23 for this reason according to fig 23 the stern region over the whole range of submergence depths generates consistently a large y force in the opposite direction of the total y force which results in a reduction in the total y force acting on the uv furthermore based on fig 24 it is seen that over the whole range of submergence depths the largest magnitude of the n moment along the suboff length is consistently produced by the stern region thus it is observed that for h the stern region is predominantly responsible for the comparatively large value of the l v through increasing the n moment while reducing the y force moreover as can be inferred from figs 23 and 24 approaching the free surface has negligible effect on the y force and n moment generated by the stern and bow regions in this regard the reason for the reduction of the l v with a decrease in submergence depth see fig 22 is mainly attributed to the behavior of the y force and n moment exerted over the region located between the uv midlength and the aft shoulder in this regard over the region located between the uv midlength and the aft shoulder as shown by amiri et al 2019b the rising and depression of the free surface above the windward stagnation region and the leeward low pressure region created by the crossflow respectively give rise to an increase the pressure difference between the windward and leeward sides this consequently increases the total y force see fig 23 while reduces the total n moment see fig 24 since a positive y force acting on the aft region produces a negative n moment therefore the reason for the reduction in the l v with a decrease in submergence depth is due largely to the increase in the y force exerted over the region located between the uv midlength and the aft shoulder which induces an n moment in the opposite direction of the total n moment secondly the influence of the stern region on the l r is evaluated the small magnitude of the l r over the whole range of h may be due to either a small value of the n moment or a large value of the y force or even both of which to shed more light on this consider figs 26 and 27 showing the distributions of the y force and n moment respectively generated by the yaw rate r along the suboff length for r 0 4 over various submergence depths note that when a uv is moving ahead with a linear velocity u and an angular yaw velocity r is imposed on the body a linear distribution of lateral velocity v is developed along the length of the uv for instance fig 28 shows the lateral velocity distribution v x 0 r x 0 along the length of the suboff uv undergoing a steady turning motion at an angular yaw velocity r 0 4 about the z 0 axis therefore due to the lateral velocity reversal the starboard and port sides of the suboff uv act as a combination of both windward side and leeward side in this regard based on fig 28 the starboard side at the fore half part of the suboff is the leeward side while it becomes the windward side at the aft half part on the other hand the portside at the fore half part of the suboff is the windward side while it turns into the leeward side over the aft half part thus based on the lateral velocity distribution along the length of the uv see fig 28 it is expected that a positive y force is induced on the fore half part of the suboff while a negative y force is produced by the aft half part however as shown in fig 26 only a small region close to the bow in the fore half part generates a positive y force and surprisingly over a considerable region in the fore half part a negative y force is induced similarly the stern region in spite of a positive lateral velocity over the aft half part see fig 28 also produces a positive y force thus both the bow and stern regions generate a positive y force which is in the opposite direction of the total y force exerted on the uv accordingly the main contribution to the y force is from the region between the fore and aft shoulders in this region a negative y force is induced on the uv hull which is in the same direction of the total y force acting on the uv hull to establish a relationship between the dynamic pressure distribution and the distribution of the y force along the uv fig 29 shows the dynamic pressure distribution around the suboff at x 0 s y 0 plane and r 0 4 for various submergence depths from fig 29 four common important fluid flow characteristics over the whole range of submergence depths can be highlighted first is the shift of the bow stagnation region toward the windward side due to the negative lateral velocity this shift gives rise to a decrease in the dynamic pressure at the leeward bow region second which is the most crucial feature and is responsible for the total negative lateral force exerted on the suboff is the drop in the dynamic pressure in the region between the windward fore shoulder and leeward aft shoulder although the windward fore shoulder is expected to experience an increase in the pressure this value decreases which is due mainly to the dominant role of the axial velocity compared to the small negative lateral velocity at this region see fig 28 furthermore the drop in the dynamic pressure at the region between the uv midlength and the leeward aft shoulder is due to the crossflow direction in this region which is in the opposite direction of y 0 axis third is the drop in the dynamic pressure at the windward aft shoulder which is attributed to an increase in the fluid flow velocity at this region finally fourth is the leeward shift of the aft stagnation region which is due to the drop in the dynamic pressure at the windward aft shoulder based on the fluid flow characteristics presented above it can be inferred that over the whole range of submergence depths the drop in the dynamic pressure at the windward aft shoulder together with the leeward shift of the aft stagnation region is again largely responsible for the positive y force exerted at the stern region of the suboff uv thus for the entire range of submergence depths the stern generates a y force in the opposite direction of the total y force which results in an increase in the l r on the other hand as can be inferred from fig 27 the n moment generated by the stern region at all the submergence depths acts in the opposite direction of the total n moment which consequently reduces this moment component thus it is observed that for the whole range of submergence depths although the stern region causes an increase in the y force it gives rise to a reduction in the n moment accordingly the stern region is partially responsible for the relatively small value of the l r through decreasing the n moment in this case again based on figs 26 and 27 approaching the free surface has negligible effect on the y force and n moment generated by the yaw rate on the stern and bow regions in this regard as can be inferred from figs 26 and 27 the increase in the total y force and n moment exerted on the suboff with a decrease in submergence depth is due to both an increase in the negative y force exerted over the region between the uv midlength and the aft shoulder and a decrease in the positive y force experienced by the aft shoulder region to explain further consider fig 19 c which shows the suboff generated wave system during the steady turning motion at the yaw angular velocity r 0 4 over submergence depth h 1 1 d based on this figure the reason for the concurrent increase in the negative y force exerted over the region between the uv midlength and the aft shoulder and decrease in the positive y force experienced by the aft shoulder region may be the depression of the free surface above the aft leeward low pressure region created by the crossflow at this region to establish a relationship between the dynamic pressure distribution and the y force generated by the yaw rate on the aft half part fig 30 shows the dynamic pressure distribution at two axial locations x 0 1 0362 m and x 0 1 4718 m for various submergence depths and r 0 4 this figure clearly shows that with a decrease in submergence depth the free surface is depressed above the aft leeward low pressure region created by the crossflow accordingly the depression of the free surface above the aft leeward low pressure region results in a more decrease in the dynamic pressure at this region this consequently is largely responsible for both the increase in the negative y force exerted over the region between the uv midlength and the aft shoulder and the decrease in the positive y force experienced by the aft shoulder region the decrease in the dynamic pressure at the aft of the suboff especially at the aft leeward side and the stern region as the uv approaches the free surface can also be clearly observed in fig 29 likewise the free surface effect on the dynamic pressure distribution around the aft half part of the uv can also be seen quantitatively in fig 31 which displays the dynamic pressure distribution at two axial locations x 0 1 0362 m and x 0 1 4718 m for various submergence depths and r 0 4 note that ϕ is the circumferential coordinate and its definition is shown in fig 32 it is evident from this figure that as the uv approaches the free surface the dynamic pressure on the aft half part particularly on the aft leeward side ϕ 90 reduces significantly however based on fig 18 f and g as a decrease in submergence depth causes a simultaneous increase in both the y force and n moment generated by the yaw rate the l r undergoes merely a small increase as the uv approaches the free surface in this section it is shown that the low level of the dynamic stability of the suboff axisymmetric uv is largely associated with the stern region of the suboff uv accordingly the discussion given above demonstrates that the stern region plays a decisive role in the dynamic stability of an axisymmetric uv in the horizontal plane it is further observed that the behavior of the y force and n moment generated by the lateral and yaw velocities on the region located between the midlength and the aft shoulder of the suboff is largely responsible for the concurrent increase in the l r and decrease in the l v as the uv approaches the free surface 4 5 maneuverability analysis of the suboff in the horizontal plane over various submergence depths to evaluate the free surface effect on the maneuverability of the suboff uv in the horizontal plane the turning and zigzag standard maneuvers are performed for various submergence depths this evaluation is carried out by integrating numerically the eqs 1 3 based on the second order improved euler method the numerical integration is performed using a time step size equal to 0 01 s the numerical computations demonstrate that this time step size is small enough to give sufficiently precise responses for the maneuvering analysis the simulations rely on the hydrodynamic coefficients presented in table 11 for various submergence depths furthermore in the maneuvering simulations with the presence of the free surface a cubic interpolation is used to express the axial hydrodynamic force x f u h in the equations of motion as this force component is stored in a one dimensional tabular form at various submergence depths furthermore to model the thrust force eqs 15 and 16 are used however as no data of free running maneuvering tests are available merely qualitative conclusions are drawn 4 5 1 turning maneuver the turning maneuvers are performed with a rudder deflection of δ r 0 10 at an approach velocity of u 0 3 344 m s which is the underlying reference velocity used to calculate the hydrodynamic forces and moments arising from the uv velocity components in this regard the rudder was executed with a deflection rate equal to 10 1 s after the uv attains the steady approach velocity fig 33 shows the trajectories of the suboff uv over various submergence depths this figure reveals that advance transfer tactical diameter and turning diameter all undergo an increase with a decrease in submergence depth the increase in these quantities is attributed to an increase in the uv damping characteristics which is reflected in the behavior of the hydrodynamic forces and moments generated by the uv velocity components as shown in fig 18 accordingly the increased damping characteristics of the uv with a decrease in submergence depth in return decreases the maneuverability of the uv fig 34 presents the time histories of the rudder deflection angle drift angle yaw rate and the uv speed based on fig 34 b the drift angle reduces with a decrease in submergence depth to explain the reason for the decrease in drift angle consider fig 35 which shows schematically the suboff uv undergoing a turning maneuver at a rudder deflection of δ r 0 as can be seen in this figure during a turning maneuver the n moment generated by the lateral velocity v tends to increase the drift angle while the n moment produced by the yaw rate r tends to decrease this angle accordingly based on fig 18 as with a decrease in submergence depth the n moment generated by the v undergoes a reduction while the n moment induced by the r goes up the drift angle decreases the increase in the n moment generated by the yaw rate r with a decrease in submergence depth is apparent in the evolution of the yaw rate which reduces as the uv approaches the free surface as shown in fig 34 c furthermore the evolution of the uv speed u with respect to the steady approach speed u 0 as shown in fig 34 d demonstrates that as the uv approaches the free surface the speed loss reduces which is associated with a decrease in the drift angle see fig 34 b 4 5 2 zigzag maneuver in this section a 10 10 zigzag maneuver is performed at an approach velocity of u 0 3 344 m s which is the underlying reference velocity used to calculate the hydrodynamic forces and moments arising from the uv velocity components in this regard the rudder was executed with a deflection rate equal to 10 1 s after the uv attains the steady approach velocity fig 36 shows the evolution of the rudder deflection angle δ r 0 and the yaw angle ψ of the suboff uv during the zigzag maneuver over various submergence depths this figure clearly emphasizes the overriding effect of the increased damping characteristics of the uv with a decrease in submergence depth as can be seen in this figure the overshoot angles diminish with a decrease in submergence depth the decrease in these quantities is attributed to an increase in the damping characteristics of the uv which is reflected in the plots of the hydrodynamic forces and moments in terms of the uv velocity components shown in fig 18 this in return increases the course stability of the suboff with a decrease in submergence depth additionally fig 37 exhibits the time histories of the drift angle yaw rate and uv speed as mentioned earlier with a decrease in submergence depth both the decrease in the n moment produced by the lateral velocity v and the increase in the n moment induced by the yaw rate r are responsible for the reduction in drift angle shown in fig 37 a in this case again the increase in the n moment generated by the yaw rate r with a decrease in submergence depth is apparent in the evolution of the yaw rate which undergoes a reduction as shown in fig 37 b furthermore the evolution of the uv speed u with respect to the steady approach speed u 0 as shown in fig 37 c demonstrates a reduction in speed loss as the uv approaches the free surface which is attributed to a decrease in the drift angle moreover fig 38 shows the suboff trajectory during the 10 10 zigzag maneuver for various submergence depths as can be expected the increase in the damping characteristics of the uv and consequently in the course stability of the uv with a decrease in submergence depth gives rise to a decrease in the distance traveled by the uv 5 conclusions the main objective of the present study is to evaluate the free surface effect on the maneuverability of the axisymmetric suboff uv traveling close to the free surface in the horizontal plane for this purpose the free surface effect on the hydrodynamic forces and moments resulting from the uv velocity components is investigated therefore the hydrodynamic captive tests including the straight ahead resistance tests drift tests and rotating arm tests are performed by using numerical simulations based on urans equations coupled with a reynolds stress turbulence model these tests are carried out for various submergence depths and proper ranges of uv surge sway and yaw velocity components the numerical simulations are conducted in the commercial code starccm for the purpose of maneuverability evaluation over various submergence depths the hydrodynamic forces and moments obtained from the simulations of the hydrodynamic captive tests are implemented in the equations of motion in this regard the axial resistance force obtained from the straight ahead resistance tests with the presence of the free surface is stored in a one dimensional tabular form and a cubic interpolation is used to express this force component in the maneuvering equations the reason behind using this approach is the oscillatory behavior of this force component with respect to the axial velocity component which questions the use of the usual quadratic odd polynomial function in terms of the axial velocity the rest of the hydrodynamic forces and moments arising from the uv velocities are implemented in the maneuvering equations by fitting them to quadratic polynomial functions in terms of the uv velocity components additionally analytical equations are used to calculate the forces and moments related to the accelerations thrust and rudder which all are assumed to remain constant with respect to submergence depth the results obtained from the numerical simulations of the hydrodynamic captive tests demonstrate that the stern region of the suboff uv has a crucial effect on the y force and n moment for various submergence depths accordingly it is observed that at the entire range of submergence depths over this region an unexpected y force in the opposite direction of the total y force is induced by both the lateral and angular yaw velocities this consequently gives rise to an increase in the total n moment arising from the lateral velocity while results in a decrease in the total n moment produced by the yaw rate it is further observed that approaching the free surface has a negligible effect on the y force and n moment generated by the stern and bow regions in this regard with a decrease in submergence depth the region between the uv midlength and the aft shoulder is mainly responsible for the increase or decrease in the total y force and n moment with a decrease in submergence depth the effect of this region on the y force and n moment generated by each velocity component is as follows as the uv approaches the free surface the increase in the y force and decrease in the n moment both arising from the lateral velocity are mainly attributed to a growing pressure difference between the windward and leeward sides located in the region between the uv midlength and the aft shoulder since the y force generated by the region between the uv midlength and the aft shoulder acts in the same direction of the total y force while it generates an n moment in the opposite direction of the total n moment with a decrease in submergence depth the concurrent increase in the y force and the n moment both arising from the yaw rate is primarily attributed to the depression of the free surface above the aft leeward low pressure region created by the crossflow accordingly the depression of the free surface above the aft leeward low pressure region results in a more decrease in the dynamic pressure in this region this is largely responsible for both an increase in the y force exerted over the region between the uv midlength and the aft shoulder which acts in the same direction of the total y force and a decrease in the y force experienced by the aft shoulder region which acts in the opposite direction of the total y force this accordingly gives rise to an increase in both the total y force and the total n moment since the y force exerted over the region between the uv midlength and the aft shoulder generates an n moment in the same direction of the total n moment while the y force exerted over the aft shoulder region generates an n moment in the opposite direction of the total n moment additionally it is seen that the totally submerged bare hull suboff axisymmetric uv is highly unstable this high level of instability is attributed to the stern region in this regard as mentioned earlier an unexpected y force in the opposite direction of the total y force is induced by both the lateral and yaw velocities over the stern region this consequently gives rise to an increase in the total n moment arising from the lateral velocity while results in a decrease in the total n moment produced by the yaw rate this accordingly leads to an increase in the l v while a decrease in the l r which consequently results in an extremely low level of dynamic stability for the suboff uv moreover it is observed that with a decrease in submergence depth the dynamic stability increases remarkably in this regard as mentioned earlier a decrease in submergence depth has negligible effect on the y force and n moment generated by the bow and stern regions accordingly the increase in the dynamic stability as the uv approaches the free surface is associated with the behavior of the y force and n moment generated by the region located between the uv midlength and the aft shoulder of the suboff in this regard the behavior of the y force and n moment generated by the region located between the uv midlength and the aft shoulder is largely responsible for the concurrent increase in the l r and decrease in the l v as the uv approaches the free surface which gives rise to an increase in the uv dynamic stability moreover during the turning maneuver advance transfer tactical diameter and turning diameter all undergo an increase with a decrease in submergence depth this is due to an increase in the damping characteristics of the uv which in return decreases the maneuverability with a decrease in submergence depth additionally in zigzag maneuver the overshoot angles undergo a decrease with a reduction in submergence depth which is attributed to the improved course stability as the uv approaches the free surface furthermore the decrease in the n moment produced by the lateral velocity and the increase in the n moment generated by the yaw rate with a decrease in submergence depth lead to a decrease in the uv drift angle during the maneuvers which consequently causes a decrease in the uv speed loss besides the increase in the n moment generated by the yaw rate with a decrease in submergence depth gives rise to a reduction in the yaw rate during the suboff maneuvers declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the authors would like to thank the brazilian national council for scientific and technological development cnpq and the brazilian funding agency anp prh3 for their support 
22188,the present study aims to evaluate the free surface effect on the maneuverability of an axisymmetric underwater vehicle uv in the horizontal plane therefore the hydrodynamic captive tests including the straight ahead resistance drift and rotating arm tests are performed over various submergence depths by using urans equations with a reynolds stress turbulence model available in the commercial code starccm to assess the maneuverability the forces and moments generated by the velocity components which are obtained from captive tests are implemented in the maneuvering equations moreover analytical equations are used to calculate the loads arising from the uv accelerations thrust and rudder which are all assumed to remain constant with respect to depth the results show that the behavior of the lateral force and yaw moment generated by the uv stern region reduces significantly the uv stability over the entire range of depths the results further show that as the uv approaches the free surface the behavior of the lateral force and yaw moment induced by the region between the uv midlength and aft shoulder increases the uv stability which consequently decreases the maneuverability keywords free surface effect dynamic stability maneuverability hydrodynamic forces and moments underwater vehicle uv suboff geometry urans equations 1 introduction menuvering simulations of underwater vehicles uvs in six degrees of freedom are usually performed by using the standard equations of motion proposed by gertler and hagen 1967 in this mathematical model which is considered as the first official dynamic model to perform the maneuverability tests of the uvs the hydrodynamic forces and moments acting on the uv hull constitute the heart of the model these forces and moments are classified into two general categories forces and moments arising from the uv velocities and forces and moments generated by the uv accelerations gertler and hagen 1967 to improve the maneuverability predictions of the uvs the model proposed by gertler and hagen 1967 has been followed by a series of modifications to account for several effects such as the effect of the interaction between the sail trailing vortex and the hull feldman 1979 the effect of the slipstream of propeller on the control surfaces smith et al 1978 and recently the effect of the presence of the calm water free surface polis et al 2013 which all are neglected in the original model in this respect due to a significant increase in the strategic requirement for uvs to operate in the littoral and near surface environments the evaluation of the free surface effect on the hydrodynamics and dynamics of the uvs has stimulated extensive studies in hydrodynamics polis et al 2013 saout and ananthakrishnan 2011 dawson 2014 jagadeesh and murali 2010 mansoorzadeh and javanmard 2014 nematollahi et al 2015 salari and rava 2017 broglia et al 2006 carrica et al 2016 dubbioso et al 2017 shariati and mousavizadegan 2017 and amiri et al 2018 2019b a an immediate consequence of a uv traversing close to the calm water free surface is the creation of surface gravity waves that are stationary with respect to the body as is well known from newman 1977 the energy required for the creation of this surface wave system leads to an increase in the hydrodynamic forces generated by the velocity components on a shallowly submerged uv likewise as shown by amiri et al 2018 2019b the increase in the hydrodynamic forces arising from the velocity components with a decrease in submergence depth can also be explained through the effect of the free surface deformations on the dynamic pressure distribution around the uv hull in this regard as demonstrated by amiri et al 2018 2019b the crests and troughs of the self induced wave system of a shallowly submerged uv modify the dynamic pressure distribution around the uv hull by creating local regions of high and low dynamic pressure respectively along the body length the degree of modification introduced by the free surface deformations into the dynamic pressure distribution around the uv hull depends on the submergence depth the less the submergence depth the more will be the free surface deformations which consequently increases the free surface effect on the dynamic pressure distribution amiri et al 2018 2019b thus from a theoretical point of view all of the external forces and moments acting on a uv traveling beneath the free surface are subject to change in response to decreasing the submergence depth therefore the calm water free surface effect on a shallowly submerged uv hydrodynamics maneuverability and operations can be significant consequently a well founded understanding of the hydrodynamics and dynamics of a shallowly submerged uv traveling in a close proximity to the free surface is required to enable the prediction of the uv maneuverability with the presence of the free surface in the previous studies the evaluation of the free surface uv interaction has been restricted mainly to the uvs traveling with a constant advance velocity along a straight path with little attention paid to the maneuverability evaluation of the uvs with the presence of the free surface polis et al 2013 saout and ananthakrishnan 2011 dawson 2014 jagadeesh and murali 2010 mansoorzadeh and javanmard 2014 nematollahi et al 2015 salari and rava 2017 broglia et al 2006 carrica et al 2016 dubbioso et al 2017 shariati and mousavizadegan 2017 and amiri et al 2018 2019b a the studies performed by saout and ananthakrishnan 2011 carrica et al 2016 and dubbioso et al 2017 are among the few works conducted to evaluate the dynamic stability and maneuverability of a uv traveling close to the free surface in this regard saout and ananthakrishnan 2011 evaluates the dynamic stability of a uv traveling in the horizontal plane both at infinite depth and close to the free surface at a submergence depth equal to h 1 5 d d uv maximum diameter by conducting the corresponding planar motion mechanism pmm tests using a potential solver the results indicate that the presence of the free surface increases the dynamic stability of uvs in the horizontal plane which is associated with the radiation damping effect induced by the surface generated waves moreover carrica et al 2016 performs the free running self propulsion experiments and simulations of a uv operating over various submergence depths the simulations are carried out by using urans equations coupled with k ε and k ω turbulence models the obtained results show that cfd is generally able to predict the behavior of a uv traversing beneath the free surface additionally the numerical and experimental results of the free running self propulsion tests near the free surface demonstrate the presence of a strong upward lift force acting on the uv aft part which produces a bow down moment over the hull furthermore dubbioso et al 2017 performs the free running turning maneuvers of a uv in the horizontal plane by using rans equations with the one equation turbulence model of spalart and allmaras at submergence depths of h 1 75 d d uv maximum diameter for various rudder deflections the obtained results demonstrate that for the depths considered the presence of the free surface has negligible effect on the turning maneuver of a uv therefore the results obtained by dubbioso et al 2017 somehow contradict the results presented by saout and ananthakrishnan 2011 since it is shown by saout and ananthakrishnan 2011 that the free surface increases the dynamic stability of uvs which certainly affects the maneuverability of the vehicles from the literature review just presented it is clear that very few works have been performed toward the maneuverability evaluation of the uvs with the presence of the free surface however a good knowledge of the free surface effect on the maneuverability is extremely useful especially in case of the uvs in which this knowledge can be effectively employed to fine tune the motion controllers before missions in littoral and near surface environments accordingly the main objective of the current study is to evaluate the free surface effect on the maneuverability of an axisymmetric uv traveling close to the free surface in the horizontal plane for simplicity the free surface effect is investigated only on the hydrodynamic forces and moments arising from the uv velocity components therefore the hydrodynamic captive tests including the straight ahead resistance tests drift tests and rotating arm tests are performed by using numerical simulations based on urans equations coupled with a reynolds stress turbulence model these tests are carried out over various submergence depths and proper ranges of uv surge sway and yaw velocity components the numerical simulations are conducted in the commercial code starccm 2014 in this work for the purpose of dynamic stability evaluation of the uv in the horizontal plane over various submergence depths the forces and moments obtained from the simulations of the drift tests and rotating arm tests are used to calculate the linear hydrodynamic coefficients over various submergence depths by using the linear least squares method in addition for the purpose of maneuverability evaluation over various submergence depths the hydrodynamic forces and moments obtained from the simulations of the hydrodynamic captive tests are implemented in the standard equations of motion proposed by gertler and hagen 1967 further analytical equations are used to calculate the forces and moments due to the uv accelerations thrust and rudder which are all assumed to remain constant with respect to submergence depth in this work a 1 1 scale of the bare hull axisymmetric suboff geometry with principal dimensions presented by groves et al 1989 is used to fulfill the main objective of this study various experiments were planned and conducted for the model such as etebari et al 2008 wilson haffenden et al 2010 and roddy 1990 the data obtained from these experiments are used to validate the numerical hydrodynamic captive tests performed in the present study 2 methodology 2 1 dynamics of uvs 2 1 1 maneuvering equations for totally submerged uvs in the horizontal plane the body fixed s x 0 y 0 z 0 and the earth fixed o x y z coordinate systems that are used to analyze the dynamics of a uv are shown in fig 1 origin o of the earth fixed coordinate system coincides with the calm water free surface level and positive z axis points downward additionally origin s of the body fixed frame is located at the axial location of 0 462 l from the nose with positive x 0 axis points toward the bow and y 0 axis points positively toward the starboard herein l denotes the uv overall length in the horizontal plane the position of the uv relative to the earth fixed reference frame is expressed by x and y while the orientation is defined by ψ about z axis see fig 1 fossen 1994 u v and r are the axial lateral and yaw angular velocity components respectively relative to the body fixed frame fossen 1994 see fig 1 also x y and n are used to describe the forces and moment acting on the vehicle in the body fixed frame in the horizontal plane fossen 1994 in this regard x indicates the axial force y the lateral force and n the yawing moment the standard equations of motion in non dimensional form proposed by gertler and hagen 1967 for maneuvering predictions of totally submerged uvs in the horizontal plane can be written as follows surge 1 m u v r x g r 2 x u u x u u u u x v v v v x r r r r x δ r δ r δ r 2 t 1 t sway 2 m v u r x g r y v v y r r y v v y v v v v y r r y r r r r y δ r δ r yaw 3 i z r m x g v u r n v v n r r n v v n v v v v n r r n r r r r n δ r δ r where the primed symbols imply the dimensionless variables note that the nondimensionalisation is carried out based on lewis 1988 in this regard to obtain the nondimensional form the force terms are divided by 0 5 ρ u 2 l 2 while the moment terms are divided by 0 5 ρ u 2 l 3 where u indicates the velocity magnitude in the horizontal plane i e u u 2 v 2 in these equations x g is the dimensionless x 0 coordinate of the center of gravity m is the dimensionless uv mass and i z is the dimensionless moment of inertia about z 0 axis it is further assumed that the axis through s x 0 y 0 z 0 are the principal axes of inertia and y 0 and z 0 coordinates of the center of gravity are zero i e y g z g 0 similarly x u y v y r n v and n r are the dimensionless hydrodynamic added mass coefficients moreover x u u x v v y v y v v n v n v v x r r y r y r r n r and n r r are the dimensionless hydrodynamic coefficients arising from the velocity components furthermore x δ r δ r y δ r and n δ r are the dimensionless hydrodynamic coefficients of the rudder and δ r is the effective angle of rudder deflection relative to the inflow velocity also t is the thrust deduction factor and t is the dimensionless thrust force generated by the propeller as can be seen in eqs 1 3 the external forces and moments right hand side of these equations are considered as a superposition of several forces and moments i e the forces and moments generated by the uv velocity and acceleration components control surfaces and propeller the hydrodynamic forces and moments exerted on a uv due to acceleration or deceleration are assumed to be linear with respect to the uv acceleration components in this study these forces and moments are further assumed to remain constant with respect to depth and thus are estimated using the analytical equations proposed by humphreys and watkinson 1978 which are obtained for a prolate spheroid moving through an infinite volume of stationary ideal fluid in this regard the uv is assumed to be a prolate spheroid with axes equal to the length and maximum diameter of the uv accordingly the following expressions are given by humphreys and watkinson 1978 to estimate the hydrodynamic added mass coefficients 4 x u k 1 m 5 y v k 2 m 6 n r k i z 7 y r x b x g y v 8 n v x b x g y v where x b indicates the dimensionless x 0 coordinate of the center of buoyancy relative to the body fixed reference frame the definition of k factors in eqs 4 6 can be found in humphreys and watkinson 1978 additionally based on eqs 1 3 the relationship between the x force and u is expressed by a purely odd quadratic polynomial function on the other hand the x force in terms of v and r velocity components is approximated by purely even quadratic polynomial functions moreover purely odd quadratic polynomial functions are used to approximate the lateral y force and yaw n moment arising from both the lateral velocity v and the angular yaw velocity r note that the axial hydrodynamic x force arising from the axial velocity u can be obtained through performing the straight ahead resistance tests over a range of u velocities lewis 1988 the axial hydrodynamic coefficient x u u given in eq 1 is then estimated by fitting the polynomial function to the axial x forces obtained from the straight ahead resistance tests via the linear least squares method in addition the hydrodynamic forces and moments arising from the lateral velocity v can be obtained through performing the static drift tests as shown in fig 2 over a range of lateral velocities which are defined as v u sin β with β being the drift angle fig 2 lewis 1988 the hydrodynamic coefficients x v v y v y v v n v and n v v given in eqs 1 3 are then estimated by fitting the polynomials to the x forces y forces and n moments obtained from the drift tests via the linear least squares method likewise the hydrodynamic forces and moment generated by the yaw rate r can be obtained by performing the rotating arm tests as shown in fig 3 over a range of yaw rates r feldman 1995 and lewis 1988 the yaw hydrodynamic coefficients x r r y r y r r n r and n r r given in eqs 1 3 are then estimated by fitting the polynomials to the x forces y forces and n moments obtained from the rotating arm tests via the linear least squares method in this study it is assumed that the uv under consideration is equipped only with a vertical rudder in the aft region which is used for maneuvering in the horizontal plane fig 4 as can be seen in eqs 1 3 the relationship between the x force and the effective angle of rudder deflection δ r is purely even while this relationship for the y force and n moment is purely odd the effective angle of rudder deflection δ r is equal to the sum of the user defined deflection δ r 0 and the deflection formed due to both the linear lateral and angular yaw velocity components δ r fig 5 9 δ r δ r 0 δ r where δ r is defined as 10 δ r atan x r r v u where x r is the distance between the rudder s location and the center of the local coordinate system in this paper it is assumed that the loads generated by the rudder remain unchanged with respect to depth further to calculate the forces and moments generated by the rudder at an effective angle of deflection δ r the semi empirical methods presented by de barros et al 2008 and field 2000 are used in this regard according to field 2000 to calculate the hydrodynamic forces and moments related to the rudder first the lift coefficient c l of the rudder is estimated as 11 c l 1 8 π a r e 1 8 cos γ p 4 a r e 2 cos γ p 4 where a r e is the effective aspect ratio a r e is defined as a function of the rudder span and hull radius at the rudder location and is estimated from the curves presented by de barros et al 2008 as a percentage of the geometrical aspect ratio of the isolated rudder γ p is the sweep angle at one fourth of the chord length after the calculation of c l the x force y force and n moment produced by the rudder are quantified as 12 y 0 5 ρ s r u d i r b c l u 2 δ r 13 x 0 5 ρ s r u d i r b 1 0 9 π a r e c l 2 u 2 δ r 2 14 n 0 5 ρ s r u d x r i r b c l u 2 δ r where ρ is the fluid density and s r u d is the rudder surface area i r b is an empirical coefficient proposed by de barros et al 2008 to account for the interference effect between the body and rudder i r b is also defined as a function of the rudder span and hull radius at the rudder location and is determined from the curves provided by de barros et al 2008 eqs 12 14 are applicable for δ r 25 moreover the contribution of the thrust force to the axial x force is expressed as t 1 t herein the thrust force is estimated as follows 15 t k t j ρ n 2 d p 4 where n is the propeller rotation rate d p the propeller diameter and k t j the normalized thrust coefficient which is expressed as a function of advance velocity ratio j the thrust coefficient can be obtained from the open water propeller performance curves in this regard the following thrust coefficient k t j of the generic seven bladed propeller e1619 which has a diameter equal to d p 0 262 m sezen et al 2018 is used to estimate the thrust force 16 k t j 0 1941 j 2 0 2437 j 0 5375 where j is defined as 17 j u a n d p with u a being the mean flow velocity at the propeller plane u a is related to u through the following equation 18 u a u 1 w where w is referred to as the wake fraction as suggested by triantafyllou and hover 2003 a value of 0 1 is considered for the wake fraction w and a value of 0 2 is assigned to the thrust deduction factor t note that eqs 1 3 lack the hydrodynamic forces and moments related to the coupling effects between the sway and yaw degrees of freedom such as x v r v r since the presence of these terms requires the dedication of much significant time to determine the external forces and moments resulting from them while yet as shown by gao et al 2018 these coupling effects show limited influence on the total forces and moments and therefore can be eliminated 2 1 2 free surface effect on the hydrodynamic forces and moments an immediate consequence of a uv traversing near the free surface is the creation of surface gravity waves that are stationary with respect to the body the creation of this gravity wave system is attributed to the interaction between the dynamic pressure distribution around the hull and the free surface as is well known from newman 1977 the energy required for the creation of the surface wave system generally leads to an increase in the hydrodynamic forces generated by the velocity components likewise as shown by amiri et al 2018 2019b the increase in the forces induced by the velocity components with a decrease in submergence depth can also be explained through the effect of the free surface deformations on the dynamic pressure distribution around the uv hull in this regard as demonstrated by amiri et al 2018 2019b the crests and troughs of the self induced wave system of a shallowly submerged uv modify the dynamic pressure distribution around the uv hull by creating local regions of high and low dynamic pressure respectively along the uv length the degree of modification introduced into the dynamic pressure distribution around the uv hull by the free surface deformations depends on the submergence depth the less the submergence depth the more will be the free surface deformations which consequently increases the free surface effect on the dynamic pressure distribution around the hull amiri et al 2018 2019b therefore from a theoretical point of view all of the external forces and moments on the right hand side of eqs 1 3 are subject to change in response to decreasing the submergence depth however to simplify the free surface effect is considered only on the hydrodynamic forces and moments arising from the velocity components therefore for a shallowly submerged uv these forces and moments are considered as functions of both the velocity components and submergence depth h as can be inferred from the previous section for a totally submerged uv the hydrodynamic forces and moments arising from the velocity components are approximated as quadratic polynomial functions in terms of the velocity components besides as mentioned earlier the change in the hydrodynamic forces and moments with respect to depth is inevitable therefore to account for the free surface effect on the uv maneuverability the question may come up that whether to maintain the equations of motion for a totally submerged uv given in eqs 1 3 with the hydrodynamic forces and moments obtained for a specific submergence depth or to formulate a new set of equations of motion with the hydrodynamic forces and moments defined explicitly in terms of both the velocity components and submergence depth in this regard extending the quadratic polynomial functions which approximate the hydrodynamic forces and moments in terms of the uv velocities to account explicitly for the submergence depth effect increases notably the regression problem with considerable identification effort since as shown by dawson 2014 and amiri et al 2018 the free surface effect on the hydrodynamic forces and moments induced by the velocity components increases exponentially with a decrease in submergence depth h thus in this research for simplicity and also to fulfill the main purpose of this study the maneuverability analysis is performed using eqs 1 3 with the hydrodynamic forces and moments arising from the velocity components obtained at several submergence depths beneath the free surface therefore in this research an attempt is made to propose appropriate functions that approximate the hydrodynamic forces and moments acting on a shallowly submerged uv in terms of each velocity component at a desired submergence depth beneath the free surface for this purpose the forces and moments resulting from each velocity component are closely examined as follows axial x force due to axial velocity component u in case of a shallowly submerged uv traveling beneath the free surface the axial x force has an oscillatory behavior with respect to the axial velocity component which emanates from the interference effects between the dominant wave systems inside the submarine wake amiri et al 2018 therefore in this case the utilization of a quadratic polynomial function in terms of u velocity component as given in eq 1 may not adequately represent the axial force as a function of u thus the axial force exerted on a shallowly submerged uv is stored in a one dimensional tabular form at various submergence depths as x f u h and a cubic interpolation is used to express the axial x force as a function of axial velocity u for a desired submergence depth in the maneuvering equations hydrodynamic forces and moment due to the lateral velocity component v in this case the advent of the wave making resistance probably modifies the forces and moment arising from the lateral velocity v however as is shown later in the result section the forces and moment arising from the lateral velocity component v acting on a shallowly submerged uv the same as those acting on a totally submerged one are approximated reasonably well by using quadratic polynomial functions in terms of sway velocity v this is due to the negligible interference effects between the wave systems generated by the sway velocity component v at points along the body length which unlike the axial force resulting from the u velocity component does not provoke an oscillatory behavior in the forces and moment generated by the lateral velocity therefore in this case the hydrodynamic forces and moment are expressed as follows 19 x x v v h v v 20 y y v h v y v v h v v 21 n n v h v n v v h v v where x v v h y v h y v v h n v h and n v v h are the dimensionless hydrodynamic coefficients as a function of submergence depth h which are obtained at several submergence depths in a range of h m i n h hydrodynamic forces and moment due to the angular yaw velocity component r in this case again as is shown later in the result section the forces and moment generated by the angular yaw velocity component r on a shallowly submerged uv the same as those acting on a totally submerged one are approximated reasonably well using quadratic polynomial functions in terms of r this is also due to the negligible interference effects between the wave systems generated by the yaw velocity component r at points along the body length which contrary to the axial force resulting from the u velocity component does not provoke an oscillatory behavior in the forces and moment produced by the angular yaw velocity therefore in this case the hydrodynamic forces and moment are expressed as follows 22 x x r r h r r 23 y y r h r y r r h r r 24 n n r h r n r r h r r where x r r h y r h y r r h n r h and n r r h are the dimensionless hydrodynamic coefficients as a function of submergence depth h which are obtained at several submergence depths in a range of h m i n h therefore the maneuvering equations for a shallowly submerged uv in the horizontal plane are closely similar to the maneuvering equations for the deeply submerged one given in eqs 1 3 however the forces and moments generated by the velocity components are obtained at several submergence depths in a range of h m i n h to reflect the effect of the presence of the free surface on the maneuverability of the uv in the horizontal plane 2 1 3 dynamic stability of uvs in the horizontal plane to evaluate the dynamic stability of uvs in the horizontal plane herein the classical criterion given by lewis 1988 is used this criterion is written as follows 25 n r m x g y r m n v y v 0 eq 25 is obtained from the linearized equations of motion in sway and yaw directions in this equation the first term corresponds to the lever of the hydrodynamic moment generated by the angular yaw velocity component l r and the second term corresponds to the lever of the hydrodynamic moment generated by the lateral velocity component l v consequently the stability criterion states that for the uv to be stable the l r must be larger than the l v mathematically it is written as 26 l r l v 0 taking into account the contribution of the rudder into the linear hydrodynamic coefficients as shown by lewis 1988 eq 25 can be rewritten as follows 27 n r m x g x r n δ r y r m x r y δ r n v n δ r y v y δ r 0 note that n δ r is always negative and y δ r is always positive lewis 1988 accordingly as mentioned by lewis 1988 it can be inferred that the rudder always acts to stabilize the uv even when it has no deflection in other words based on eq 27 it can be clearly seen that the rudder contributes to the stabilizing force and moment generated by the yaw rate while it diminishes the destabilizing effect caused by the force and moment induced by the sway velocity thus in cases where the uvs are inherently unstable a proper adjustment of rudder size can stabilize the uvs to a desirable level more generally the dynamic stability criterion sc given in eq 27 for a uv traveling in the horizontal plane at a submergence depth h is written as follows 28 sc n r h m x g x r n δ r y r h m x r y δ r n v h n δ r y v h y δ r 0 where the coefficients n r h y r h n v h and y v h are obtained at several submergence depths in a range of h m i n h beneath the free surface to reflect the free surface effect on the dynamic stability of uvs for various submergence depths 2 2 geometry and computational conditions in this work a 1 1 scale of the bare hull axisymmetric suboff geometry with principal dimensions given in groves et al 1989 is used fig 6 shows the bare hull suboff model along with the body fixed coordinate system the center of the body fixed coordinate system is located at the axial location of 0 462 l from the nose as can be seen in fig 6 the model possesses a bow part a parallel middle part and a stern part the model has a length to diameter ratio equal to l d 8 575 the submergence depth h is defined as the distance between the x 0 s y 0 plane and the calm water free surface level i e the z coordinate of the x 0 s y 0 plane fig 1 in this study to obtain the hydrodynamic axial force acting on the suboff the straight ahead resistance tests are performed over froude numbers and submergence depths ranging from f n 0 205 to f n 0 512 and from h 1 1 d to h respectively similarly to estimate the hydrodynamic forces and moment arising from the lateral velocity the drift tests are carried out at a constant advance velocity based on f n 0 512 for submergence depths and drift angles ranging from h 1 1 d to h and from β 0 v 0 to β 18 11 v 0 31 respectively moreover to calculate the forces and moment generated by the angular yaw velocity the rotating arm tests are performed at a constant advance velocity based on f n 0 512 over submergence depths and yaw angular velocities ranging from h 1 1 d to h and from r 0 05 to r 0 4 respectively the validation of the straight ahead resistance tests is performed using the experimental resistance force data provided by wilson haffenden et al 2010 the experiments of wilson haffenden et al 2010 are performed on a 1 2 8 scale suboff model over submergence depths and froude numbers ranging from h 1 1 d to h 3 3 d and from f n 0 128 to f n 0 640 respectively moreover to support the suboff model during the experiments a mounting device composed of a vertical post and a horizontal sting is used wilson haffenden et al 2010 also to validate the drift tests the experimental data of the forces and moment acting on a 1 1 scale suboff model given by roddy 1990 is used the experiments are performed for h at a constant advance velocity based on f n 0 512 over drift angles ranging from β 0 v 0 to β 18 11 v 0 31 additionally to support the suboff model during the experiments two naca0015 struts are used furthermore the validation of the rotating arm tests is performed using the experimental data of the forces and moment acting on a 1 1 scale suboff model provided by etebari et al 2008 the experiments are carried out for h at a constant advance velocity based on f n 0 236 over drift angles and yaw angular velocities ranging from β 3 8 to β 16 5 and from r 0 3577 to r 0 3702 respectively during the experiments while the suboff is supported using the same technique as that used by wilson haffenden et al 2010 it undergoes a turning motion at different yaw angular velocities and drift angles note that the utilization of the horizontal sting to support the suboff during the experiments conducted by etebari et al 2008 and wilson haffenden et al 2010 requires the truncation of the model in the stern region therefore the presence of the sting due to a reduction in the hull surface area together with the modification that it introduces into the pressure distribution over the stern region affects the forces and moments acting on the uv amiri et al 2018 accordingly in this work to validate the rotating arm tests using the data provided by etebari et al 2008 the simulations are performed with the presence of the support as shown in fig 7 nonetheless modeling the shallowly submerged suboff uv with the presence of the support used during the experiments conducted by wilson haffenden et al 2010 results in a remarkable increase in the computational effort therefore the simulations of the straight ahead resistance tests are performed without the presence of the support however it is worthwhile mentioning that as shown by amiri et al 2018 the presence of the support used by wilson haffenden et al 2010 increases approximately 10 the resistance force experienced by the suboff when it travels in a close proximity to the free surface 2 3 numerical model as the average values of the forces and moments are sufficient to fulfill the main objective of the present study herein the incompressible fluid motion is modeled using the urans equations coupled with the reynolds stress turbulence model proposed by speziale et al 1991 moreover in the simulations with the presence of the free surface to model the sharp interface between the water and air volume of fluid vof method along with the high resolution interface capturing scheme hric is employed hirt and nichols 1981 as mentioned earlier the simulations are performed in the commercial code starccm which discretizes the integral form of the governing equations by using the finite volume method the simulations without the presence of the free surface are conducted as steady while the simulations with the presence of the free surface are conducted as unsteady in both steady and unsteady simulations the convection and diffusion terms are discretized by using second order schemes additionally in the unsteady simulations a first order implicit scheme is used to discretize the transient term as recommended by starccm 2014 in the simulations with the presence of the free surface the time step size is calculated by wave period number of cells per wavelength to calculate the wave period and wavelength of the uv wave system as shown by amiri et al 2019b the dispersion relation of linear surface waves in a deep water condition is used moreover a simple type solver is used to control the overall solution starccm 2014 in this work it is assumed that the convergence of the simulations is achieved once the mean value of the forces and moments converges to nearly constant value with oscillations within 2 3 of the mean value accordingly using this criterion the convergence of the steady simulations is achieved after about 1400 iterations while the simulation duration for the convergence of the unsteady simulations is about 25 s 2 4 computational domains boundary conditions and grids in the current study to perform the straight ahead resistance tests along with the drift tests the computational domain is considered as a rectangular box while to conduct the rotating arm tests a computational domain in a circular form with a rectangular cross section is used fig 8 shows the computational domain used to perform the straight ahead resistance and drift tests at h and figs 9 and 10 show the computational domains used to perform the same tests while with the presence of the free surface i e for 1 1 d h 3 3 d in the simulations of the straight ahead resistance and drift test for h together with the simulations of the straight ahead resistance tests for 1 1 d h 3 3 d due to the symmetry of the fluid flowing around the suboff only half of the uv is modeled while in the drift tests with the presence of the free surface due to a possible asymmetry in the fluid flowing around the suboff the uv model is fully simulated the upstream boundary is consistently considered as a velocity inlet where a uniform velocity is specified based on froude number and the downstream boundary is considered as a pressure outlet for h a relative pressure equal to zero is prescribed at the downstream boundary while for 1 1 d h 3 3 d a hydrostatic pressure is specified in this boundary in the totally submerged simulations the side bottom and top boundaries are treated as symmetry walls while in the simulations with the presence of the free surface to reduce the fluid reflection from the top and bottom boundaries a velocity inlet is used at these boundaries also for 1 1 d h 3 3 d the boundaries at two sides the same as that used for h are treated as symmetry boundaries in the simulations with the presence of the free surface to eliminate the wave reflections at the boundaries located at the downstream and two side s a damping zone is established next to these boundaries as can be seen in figs 9 a and 10 a in this zone a source term which acts as a resistance force is added to the momentum equation of the vertical velocity component to cancel this velocity component over the damping zone in this study a linear source term as a function of vertical velocity component with a coefficient defined as f 1 π ω is added to the momentum equation of the vertical velocity component over the damping zone which has a thickness equal to the length of the uv generated wave system this configuration for the source term and the damping zone thickness is recommended by perić and abdel maksoud 2016 for simple flow phenomena and as shown by amiri et al 2018 works satisfactory in the present simulations note that ω is the frequency of the wave system generated by the uv finally fig 11 a and b depict the computational domains used to simulate the rotating arm tests for h and for 1 1 d h 3 3 d respectively for h due to the symmetry of the problem regarding the x 0 s y 0 plane only half of the uv is modeled while for 1 1 d h 3 3 d the suboff uv is fully simulated note that in both cases the distances of the boundaries from the suboff are considered the same as those used to perform the straight ahead resistance and drift tests furthermore the boundary conditions are predominantly the same as those used to carry out the straight ahead resistance and drift tests except for the boundaries located at two sides of the domain in this regard to prevent any fluid reflection a velocity inlet is also used at the two boundaries located at two sides which as a result facilitates the iterative convergence of the simulations related to the rotating arm tests it is worthy to mention that in this study the rotational motion is implemented by rotating the flow around the stationary suboff uv which is the same approach used in the research conducted by toxopeus et al 2012 therefore since a rotating coordinate system is adopted to perform the simulations of the rotating arm tests the coriolis and centrifugal forces resulting from the computation in a rotating reference frame are added to the momentum equations as source terms note that in all the simulations in this study a no slip boundary condition is imposed over the suboff model it is also worthwhile mentioning that the dimensions of the computational domains have been set based on the results given by amiri et al 2019c which demonstrate that the dimensions used for the computational domains in the present study have negligible influence on the global variables the grid in this study is generated automatically by starccm using two different methods prism layer and trimmer the trimmer mesh is used to discretize almost the entire computational domain except for the region close to the body surface this mesh is mainly composed of hexahedral cells with a small number of trimmed cells next to the uv hull to accommodate the body additionally the prism layer mesh which is constructed from orthogonal prismatic cells is employed to capture near wall turbulence in this mesh a geometric progression with an expansion factor of 1 1 is used to increase progressively the thickness of the prismatic cells from the inner cell immediately next to the uv hull to the outer cells furthermore as the turbulence model used in this study employs the standard wall function the first cell immediately next to the body surface resides within the logarithmic region of the boundary layer this corresponds to y values in a range from 30 to 100 moreover to capture properly the wave system generated by the uv together with the pressure drop in the wake region of the suboff local mesh refinements are utilized for instance to capture adequately the wave system generated by the uv at least 15 cells per wave height in the direction normal to the undisturbed free surface and 80 cells per wavelength in the direction parallel to the undisturbed free surface discretize the free surface in this regard figs 12 14 show the grids used to simulate the straight ahead resistance tests drift tests and rotating arm tests respectively local mesh refinements applied during the mesh generation process can be clearly identified in these figures 3 verification and validation 3 1 grid convergence study the grid convergence study is carried out over three grids namely i i i and i i i for each hydrodynamic test at two different computational conditions without and with the presence of the free surface i e for h and h 1 1 d in this regard the grid is uniformly refined using a refinement factor equal to 1 2 in all the dimensional directions accordingly the grid convergence study for the straight ahead resistance tests is carried for h and f n 0 466 and for h 1 1 d and f n 0 462 between three grids i i i and i i i as shown in table 1 moreover this study for the drift tests is carried out for h f n 0 512 and β 18 11 v 0 31 and for h 1 1 d f n 0 512 and β 18 11 v 0 31 between three grids i i i and i i i as shown in table 2 furthermore the grid convergence study for the rotating arm tests is performed for h f n 0 236 r 0 3702 and β 16 5 and for h 1 1 d f n 0 512 and r 0 4 between three grids i i i and i i i as shown in table 3 note that the simulations at h are performed with the presence of the support used in the experiments conducted by etebari et al 2008 in the simulations with the presence of the free surface i e for h 1 1 d the spatial grid refinement is accompanied by a temporal refinement however since the orders of accuracy are different in space and time the temporal refinement factor is defined in such a manner so as to obtain the same order of error reduction in both the temporal and spatial discretizations richards 1997 accordingly as a second order scheme is used for spatial discretization and a first order one for temporal discretization temporal refinement factor is chosen as the square of the spatial refinement factor richards 1997 in this regard in the simulations at h 1 1 d the time step size for grid i i is calculated as wave period number of cells per wavelength and then is adjusted in the corresponding grids i and i i i based on the square of the spatial refinement factor as mentioned above table 4 shows the time steps used in the simulations of the static tests at h 1 1 d therefore using the sets of grids presented above the simulations are performed to calculate the x force from the straight ahead resistance tests for h and h 1 1 d additionally from the drift tests for h and h 1 1 d the x force y force and n moment are calculated furthermore the simulations of the rotating arm tests are performed for h and h 1 1 d to estimate the x force y force and n moment tables 5 7 show the normalized values of the forces and moments obtained from the corresponding simulations the grid convergence ratio which is required for the estimation of the order of discretization p g together with the grid uncertainty u g is estimated as follows 29 r g ε g 32 ε g 21 where ε g 32 s i i i s i i is the variation in the forces moments between grids i i and i i i and ε g 21 s i i s i is the variation in the forces moments between grids i and i i the values of r g indicate the following four conditions stern et al 2006 1 0 r g 1 monotonic convergence 2 1 r g 0 oscillatory convergence 3 r g 1 monotonic divergence 4 r g 1 oscillatory divergence for conditions 3 and 4 where the grid divergence occurs no order of discretization and uncertainty can be calculated for condition 2 only the uncertainty is calculated as 30 u g 1 2 s u s l where s u and s l are the maximums and minimums of the oscillations of the forces and moments stern et al 2006 for condition 1 where the grid convergence occurs and the forces and moments show asymptotic monotonic convergence the generalized richardson extrapolation based on the procedure proposed by mchale and friedman 2009 which is used recently by the present authors in amiri et al 2018 2019b is employed to calculate the order of discretization and grid uncertainty the values of r g p g and u g related to the forces and moments obtained from grids i i for h 1 1 d and h are given in tables 8 10 based on the values of r g almost all the forces and moments show an asymptotic monotonic convergence behavior except for the x force obtained from the simulation of the rotating arm tests at h 1 1 d which shows an oscillatory convergence behavior in cases with super convergence of the observed order of discretization i e p g 2 the theoretical value of p g i e 2 is used instead of the observed p g to calculate the grid uncertainty as recommended by eça and hoekstra 2009 since according to eça and hoekstra 2009 the super convergence of the observed p g is unreliable and is only the consequence of several factors such as the boundary conditions non linearities exist in the problem turbulence modeling and mesh quality generally the small values of the u g demonstrate the negligible sensitivity of the solutions to the grid resolution finally as the changes in the forces and moments between grids i i and i i i are indeed smaller than the changes in the forces and moments between grids i and i i the grids i i are chosen to perform the rest of the simulations in this study 3 2 validation to validate the simulations of the straight ahead resistance tests the normalized x force obtained from these simulations is compared against the measured one given in wilson haffenden et al 2010 for 1 1 d h 3 3 d the uncertainty in the measurement of the x force in the experiments conducted by wilson haffenden et al 2010 is reported to be within 3 1 note that the uncertainty reported by wilson haffenden et al 2010 does not include the contribution of the support used during the experiments fig 15 depicts the normalized calculated and measured x forces the general trends of the calculated x force are similar to those of the measured one the average comparative difference between the calculated and measured x forces is about 10 27 this relatively large difference is attributed to the presence of the support used in the experiments which as shown by amiri et al 2018 considering its effect increases the x force prediction by about 10 and consequently reduces this difference to a point where it falls within the experimental uncertainty bound to validate the simulations of the drift tests the normalized x force y force and n moment obtained from these simulations are compared against the experimental data given by roddy 1990 for h the uncertainty in the measurements of the x force y force and n moment is reported to be 10 which does not include the contribution of the mounting device fig 16 a b and c depict the normalized calculated and measured x forces y forces and n moments respectively the calculated forces and moment are found to be in a fairly good agreement with the measured ones the average comparative differences between the numerical and experimental x forces y forces and n moments are about 4 01 7 07 and 5 58 respectively therefore the calculated x force y force and n moment are well within the experimental uncertainty bound finally to validate the simulations of the rotating arm tests the normalized x force y force and n moment obtained from these simulations are compared against the experimental data given by etebari et al 2008 for h as mentioned earlier the simulations are performed with the presence of the support shown in fig 7 the experiments incorporate two captive tests the rotating arm and drift tests in a single test which is the case of a uv undergoing a steady turning maneuver the uncertainty in the measurements of the x force y force and n moment in the experiments is reported to be within 8 1 4 9 and 4 1 respectively fig 17 a b and c show the normalized calculated and measured x forces y forces and n moments as can be seen the numerical model captures reasonably well the general trend of the experimental data the average comparative differences between the calculated and measured x forces y forces and n moments are approximately 4 32 4 78 and 4 04 respectively thus the calculated x force y force and n moment fall within the experimental uncertainty bound 4 results and discussion 4 1 hydrodynamic forces and moments arising from the velocity components acting on the suboff over various submergence depths fig 18 exhibits the hydrodynamic forces and moments acting on the suboff in the horizontal plane for various uv velocity components and submergence depths in this regard fig 18 a shows the normalized hydrodynamic axial x force for various axial velocities and submergence depths significant increase is observed in the x force with a decrease in submergence depth which as is well known arises from the advent of the wave making resistance component newman 1977 at the shallowest submergence depth the oscillatory behavior of the x force mainly has to do with the interference effects between the dominant bow and aft shoulder waves inside the uv wake on the free surface as shown by amiri et al 2018 2019a fig 19 a shows the free surface elevation in straight ahead test for h 1 1 d and f n 0 512 as can be seen at this condition the uv generated wave system closely resembles the classical kelvin wave pattern additionally fig 18 b c and d show the normalized hydrodynamic x force y force and n moment for various lateral velocities and submergence depths as the uv approaches the free surface a significant increase is observed in the x force and y force over the entire range of lateral velocities as mentioned earlier this is due to the advent of the wave making resistance component newman 1977 at the shallowest submergence depth an increase in the lateral velocity gives rise to an increase in the x force whereas at larger submergence depths increase in this velocity component results in a reduction in the x force as shown by amiri et al 2019b this has to do with the interaction between the free surface and the vortical flow structure formed on the leeward side of the uv at a drift angle in this regard at the shallowest submergence depth this interaction causes an increase in the free surface deformations which consequently increases the x force due to an increase in the wave making resistance component nonetheless at large submergence depths the influence of the leeward vortical flow structure on the free surface deformations diminishes drastically amiri et al 2019b moreover over the entire range of submergence depths the y force increases with respect to the lateral velocity which is associated with an increase in the pressure difference between the leeward side and windward side of the uv on the other hand unlike the x force and y force a decrease in submergence depth appears to cause a decrease in the n moment especially at large lateral velocities this behavior of the n moment based on amiri et al 2019b is due to an increase in the y force acting over the aft region of the uv as it approaches the free surface in this regard the y force acting over the aft region induces an n moment in the opposite direction of the total n moment accordingly as with a decrease in submergence depth the y force acting on the aft half part goes up the total n moment acting on the uv undergoes a reduction amiri et al 2019b fig 19 b shows the free surface elevation during the drift test for h 1 1 d f n 0 512 and v 0 31 β 18 11 an asymmetry in the wave pattern about the centerline due to the lateral velocity is noticeable moreover fig 18 e f and g present the normalized hydrodynamic x force y force and n moment for various angular yaw velocities and submergence depths with a decrease in submergence depth a significant increase is observed in the values of the x force y force and n moment over the entire range of yaw velocities which is due to the advent of the wave making resistance component newman 1977 over the entire range of submergence depths while both the y force and n moment increase with respect to the yaw rate the x force appears to remain nearly constant with an increase in the angular yaw velocity further it is observed that the n moment arising from the yaw rate contrary to that arising from the lateral velocity v experiences an increase with a decrease in submergence depth fig 19 c shows the free surface elevation during the rotating arm test for h 1 1 d f n 0 512 and r 0 4 note that due to the negligible interference effects between the wave systems generated by the lateral velocity v and yaw velocity r at points along the suboff length the hydrodynamic forces and moments arising from these velocity components show no periodic behavior with respect to the lateral velocity and angular yaw velocity components see fig 18 b c d e f and g as mentioned correctly in section 2 1 2 4 2 hydrodynamic coefficients in the horizontal plane over various submergence depths this section presents the hydrodynamic coefficients used to express the external forces and moments in the maneuvering equations for various submergence depths accordingly the hydrodynamic coefficients due to velocity components are obtained by fitting the polynomial functions given in eqs 1 3 to the hydrodynamic forces and moments represented in fig 18 via the linear least squares method fig 18 exhibits the fitted polynomial functions to the hydrodynamic forces and moments generated by the uv velocity components besides the added mass coefficients are estimated by using eqs 4 8 furthermore to calculate the hydrodynamic coefficients related to the rudder eqs 12 14 are used table 11 presents the predicted hydrodynamic coefficients for various submergence depths additionally fig 20 shows the behavior of the sway and yaw hydrodynamic coefficients with respect to submergence depth in this figure h 5 5 d corresponds to h since for h d 5 the free surface effect completely vanishes dawson 2014 as can be inferred from table 11 and fig 20 a decrease in submergence depth generally causes a nonlinear increase in the hydrodynamic coefficients except for n v y r r and n r r which reduce as the uv approaches the free surface it is further observed in fig 20 that with an increase in submergence depth the hydrodynamic coefficients appear to approach asymptotically their equivalent totally submerged values 4 3 dynamic stability analysis of the suboff in the horizontal plane over various submergence depths in this section the dynamic stability of the suboff uv is examined over various submergence depths by using eq 28 furthermore to analyze the contribution of the size of the rudder to the dynamic stability the rudder span b v is changed from zero to 2 378 b v 0 where b v 0 is the initial rudder span in this regard fig 21 shows the stability criterion sc eq 28 for various submergence depths and rudder spans it can be inferred from this figure that without the presence of the rudder b v b v 0 0 the suboff uv is inherently unstable for the entire range of submergence depths however at this condition with a decrease in submergence depth the stability increases remarkably this is due mainly to a decrease in the n moment produced by the lateral velocity v and an increase in the y force generated by the same velocity component see fig 18 c and d which results in a decrease in the lever of the hydrodynamic moment generated by the lateral velocity l v in this regard fig 22 shows the values of l v and l r of the suboff bare hull geometry as defined in eq 25 over various submergence depths in this figure h 5 5 d corresponds to h since for h d 5 the free surface effect completely vanishes dawson 2014 as can be inferred from fig 22 while l r slightly increases with a decrease in submergence depth l v undergoes a significant decrease as submergence depth is decreased this largely explains the increase in the dynamic stability as the uv approaches the free surface further details about the dynamic stability of the bare hull axisymmetric suboff uv are presented in the next section by adding the rudder b v b v 0 1 the dynamic stability of the suboff uv is predicted to increase for all the submergence depths however despite the inclusion of the rudder the suboff uv is still predicted to have a negative sc based on fig 21 fortunately it is observed that an increase in the rudder span gives rise to an almost linear increase in the sc values for the entire range of submergence depths noteworthy in fig 21 is the marginal difference between the values of sc at various submergence depths for b v b v 0 1 which indicates the dominance of the rudder in the dynamic stability of the uv the stability is achieved for b v b v 0 1 5 over the entire range of submergence depths based on humphreys and watkinson 1992 a value of sc close to 1 0 means that the uv is overly stable and therefore has a poor maneuverability as recommended by humphreys and watkinson 1992 a value of sc larger than 0 2 and smaller than 0 7 provides the uv with a reasonable level of stability in this regard it is observed that a value of 1 79 b v 0 for the rudder span provides an sc approximately equal to 0 56 0 31 0 29 and 0 28 for h 1 1 d h 2 2 d h 3 3 d and h respectively although the sc values for various submergence depths appear to be within the range recommended by humphreys and watkinson 1992 at large depths the uv possesses a very low level of stability which during the open loop maneuvering simulations leads to kinematic variables well outside the ranges of the ones used to obtain the hydrodynamic forces and moments therefore herein to simulate the maneuvering of the suboff in the horizontal plane a value of 2 18 b v 0 was chosen for the rudder span which is predicted to provide an sc approximately equal to 0 78 0 51 0 48 and 0 47 for h 1 1 d h 2 2 d h 3 3 d and h respectively 4 4 a detailed analysis of the dynamic stability of the bare hull suboff axisymmetric uv in the horizontal plane for various submergence depths in the previous section it is observed that for h the bare hull suboff axisymmetric uv is highly unstable this high level of instability may be due to both a small magnitude of the lever of the hydrodynamic moment generated by the yaw rate l r and a large magnitude of the lever of the hydrodynamic moment produced by the lateral velocity l v in this work it is shown that over the whole range of submergence depths the uv stern region gives rise to both an increase in the l v and a decrease in the l r first the influence of the stern region on the l v is investigated the large magnitude of the l v emanates from either a large value of the n moment or a small value of the y force or even both of which in this regard consider figs 23 and 24 showing the distributions of the y force and n moment respectively generated by the lateral velocity v along the suboff length for v 0 31 over various submergence depths as the suboff has a negative lateral velocity v 0 31 it is expected that all the stations along the uv length generate a positive lateral force however it is seen in fig 23 that an unexpected negative lateral force is generated at the stern region of the suboff over the entire range of submergence depths to investigate the reason for this behavior fig 25 shows the dynamic pressure distribution in x 0 s y 0 plane around the suboff at v 0 31 for various submergence depths from the pressure distributions shown in fig 25 five common fluid flow characteristics over the whole range of submergence depths stand out first is the shift of the bow stagnation region toward the windward side due to the lateral velocity component secondly this shift causes both an increase in the dynamic pressure at the windward forward shoulder and a decrease in the dynamic pressure at the leeward bow region third is the drop in the dynamic pressure at the windward aft shoulder which is attributed to an increase in the velocity of the fluid flowing at this region fourth is the leeward shift of the aft stagnation region which is caused by the drop in the dynamic pressure at the windward aft shoulder finally fifth is the drop in the dynamic pressure at the leeward aft region caused by the leeward vortical flow structure as can be seen in fig 25 over the whole range of submergence depths the decrease in the pressure at the windward aft shoulder region together with the leeward shift of the aft stagnation region is responsible for the windward suction y force exerted over the stern region of the suboff see fig 23 for this reason according to fig 23 the stern region over the whole range of submergence depths generates consistently a large y force in the opposite direction of the total y force which results in a reduction in the total y force acting on the uv furthermore based on fig 24 it is seen that over the whole range of submergence depths the largest magnitude of the n moment along the suboff length is consistently produced by the stern region thus it is observed that for h the stern region is predominantly responsible for the comparatively large value of the l v through increasing the n moment while reducing the y force moreover as can be inferred from figs 23 and 24 approaching the free surface has negligible effect on the y force and n moment generated by the stern and bow regions in this regard the reason for the reduction of the l v with a decrease in submergence depth see fig 22 is mainly attributed to the behavior of the y force and n moment exerted over the region located between the uv midlength and the aft shoulder in this regard over the region located between the uv midlength and the aft shoulder as shown by amiri et al 2019b the rising and depression of the free surface above the windward stagnation region and the leeward low pressure region created by the crossflow respectively give rise to an increase the pressure difference between the windward and leeward sides this consequently increases the total y force see fig 23 while reduces the total n moment see fig 24 since a positive y force acting on the aft region produces a negative n moment therefore the reason for the reduction in the l v with a decrease in submergence depth is due largely to the increase in the y force exerted over the region located between the uv midlength and the aft shoulder which induces an n moment in the opposite direction of the total n moment secondly the influence of the stern region on the l r is evaluated the small magnitude of the l r over the whole range of h may be due to either a small value of the n moment or a large value of the y force or even both of which to shed more light on this consider figs 26 and 27 showing the distributions of the y force and n moment respectively generated by the yaw rate r along the suboff length for r 0 4 over various submergence depths note that when a uv is moving ahead with a linear velocity u and an angular yaw velocity r is imposed on the body a linear distribution of lateral velocity v is developed along the length of the uv for instance fig 28 shows the lateral velocity distribution v x 0 r x 0 along the length of the suboff uv undergoing a steady turning motion at an angular yaw velocity r 0 4 about the z 0 axis therefore due to the lateral velocity reversal the starboard and port sides of the suboff uv act as a combination of both windward side and leeward side in this regard based on fig 28 the starboard side at the fore half part of the suboff is the leeward side while it becomes the windward side at the aft half part on the other hand the portside at the fore half part of the suboff is the windward side while it turns into the leeward side over the aft half part thus based on the lateral velocity distribution along the length of the uv see fig 28 it is expected that a positive y force is induced on the fore half part of the suboff while a negative y force is produced by the aft half part however as shown in fig 26 only a small region close to the bow in the fore half part generates a positive y force and surprisingly over a considerable region in the fore half part a negative y force is induced similarly the stern region in spite of a positive lateral velocity over the aft half part see fig 28 also produces a positive y force thus both the bow and stern regions generate a positive y force which is in the opposite direction of the total y force exerted on the uv accordingly the main contribution to the y force is from the region between the fore and aft shoulders in this region a negative y force is induced on the uv hull which is in the same direction of the total y force acting on the uv hull to establish a relationship between the dynamic pressure distribution and the distribution of the y force along the uv fig 29 shows the dynamic pressure distribution around the suboff at x 0 s y 0 plane and r 0 4 for various submergence depths from fig 29 four common important fluid flow characteristics over the whole range of submergence depths can be highlighted first is the shift of the bow stagnation region toward the windward side due to the negative lateral velocity this shift gives rise to a decrease in the dynamic pressure at the leeward bow region second which is the most crucial feature and is responsible for the total negative lateral force exerted on the suboff is the drop in the dynamic pressure in the region between the windward fore shoulder and leeward aft shoulder although the windward fore shoulder is expected to experience an increase in the pressure this value decreases which is due mainly to the dominant role of the axial velocity compared to the small negative lateral velocity at this region see fig 28 furthermore the drop in the dynamic pressure at the region between the uv midlength and the leeward aft shoulder is due to the crossflow direction in this region which is in the opposite direction of y 0 axis third is the drop in the dynamic pressure at the windward aft shoulder which is attributed to an increase in the fluid flow velocity at this region finally fourth is the leeward shift of the aft stagnation region which is due to the drop in the dynamic pressure at the windward aft shoulder based on the fluid flow characteristics presented above it can be inferred that over the whole range of submergence depths the drop in the dynamic pressure at the windward aft shoulder together with the leeward shift of the aft stagnation region is again largely responsible for the positive y force exerted at the stern region of the suboff uv thus for the entire range of submergence depths the stern generates a y force in the opposite direction of the total y force which results in an increase in the l r on the other hand as can be inferred from fig 27 the n moment generated by the stern region at all the submergence depths acts in the opposite direction of the total n moment which consequently reduces this moment component thus it is observed that for the whole range of submergence depths although the stern region causes an increase in the y force it gives rise to a reduction in the n moment accordingly the stern region is partially responsible for the relatively small value of the l r through decreasing the n moment in this case again based on figs 26 and 27 approaching the free surface has negligible effect on the y force and n moment generated by the yaw rate on the stern and bow regions in this regard as can be inferred from figs 26 and 27 the increase in the total y force and n moment exerted on the suboff with a decrease in submergence depth is due to both an increase in the negative y force exerted over the region between the uv midlength and the aft shoulder and a decrease in the positive y force experienced by the aft shoulder region to explain further consider fig 19 c which shows the suboff generated wave system during the steady turning motion at the yaw angular velocity r 0 4 over submergence depth h 1 1 d based on this figure the reason for the concurrent increase in the negative y force exerted over the region between the uv midlength and the aft shoulder and decrease in the positive y force experienced by the aft shoulder region may be the depression of the free surface above the aft leeward low pressure region created by the crossflow at this region to establish a relationship between the dynamic pressure distribution and the y force generated by the yaw rate on the aft half part fig 30 shows the dynamic pressure distribution at two axial locations x 0 1 0362 m and x 0 1 4718 m for various submergence depths and r 0 4 this figure clearly shows that with a decrease in submergence depth the free surface is depressed above the aft leeward low pressure region created by the crossflow accordingly the depression of the free surface above the aft leeward low pressure region results in a more decrease in the dynamic pressure at this region this consequently is largely responsible for both the increase in the negative y force exerted over the region between the uv midlength and the aft shoulder and the decrease in the positive y force experienced by the aft shoulder region the decrease in the dynamic pressure at the aft of the suboff especially at the aft leeward side and the stern region as the uv approaches the free surface can also be clearly observed in fig 29 likewise the free surface effect on the dynamic pressure distribution around the aft half part of the uv can also be seen quantitatively in fig 31 which displays the dynamic pressure distribution at two axial locations x 0 1 0362 m and x 0 1 4718 m for various submergence depths and r 0 4 note that ϕ is the circumferential coordinate and its definition is shown in fig 32 it is evident from this figure that as the uv approaches the free surface the dynamic pressure on the aft half part particularly on the aft leeward side ϕ 90 reduces significantly however based on fig 18 f and g as a decrease in submergence depth causes a simultaneous increase in both the y force and n moment generated by the yaw rate the l r undergoes merely a small increase as the uv approaches the free surface in this section it is shown that the low level of the dynamic stability of the suboff axisymmetric uv is largely associated with the stern region of the suboff uv accordingly the discussion given above demonstrates that the stern region plays a decisive role in the dynamic stability of an axisymmetric uv in the horizontal plane it is further observed that the behavior of the y force and n moment generated by the lateral and yaw velocities on the region located between the midlength and the aft shoulder of the suboff is largely responsible for the concurrent increase in the l r and decrease in the l v as the uv approaches the free surface 4 5 maneuverability analysis of the suboff in the horizontal plane over various submergence depths to evaluate the free surface effect on the maneuverability of the suboff uv in the horizontal plane the turning and zigzag standard maneuvers are performed for various submergence depths this evaluation is carried out by integrating numerically the eqs 1 3 based on the second order improved euler method the numerical integration is performed using a time step size equal to 0 01 s the numerical computations demonstrate that this time step size is small enough to give sufficiently precise responses for the maneuvering analysis the simulations rely on the hydrodynamic coefficients presented in table 11 for various submergence depths furthermore in the maneuvering simulations with the presence of the free surface a cubic interpolation is used to express the axial hydrodynamic force x f u h in the equations of motion as this force component is stored in a one dimensional tabular form at various submergence depths furthermore to model the thrust force eqs 15 and 16 are used however as no data of free running maneuvering tests are available merely qualitative conclusions are drawn 4 5 1 turning maneuver the turning maneuvers are performed with a rudder deflection of δ r 0 10 at an approach velocity of u 0 3 344 m s which is the underlying reference velocity used to calculate the hydrodynamic forces and moments arising from the uv velocity components in this regard the rudder was executed with a deflection rate equal to 10 1 s after the uv attains the steady approach velocity fig 33 shows the trajectories of the suboff uv over various submergence depths this figure reveals that advance transfer tactical diameter and turning diameter all undergo an increase with a decrease in submergence depth the increase in these quantities is attributed to an increase in the uv damping characteristics which is reflected in the behavior of the hydrodynamic forces and moments generated by the uv velocity components as shown in fig 18 accordingly the increased damping characteristics of the uv with a decrease in submergence depth in return decreases the maneuverability of the uv fig 34 presents the time histories of the rudder deflection angle drift angle yaw rate and the uv speed based on fig 34 b the drift angle reduces with a decrease in submergence depth to explain the reason for the decrease in drift angle consider fig 35 which shows schematically the suboff uv undergoing a turning maneuver at a rudder deflection of δ r 0 as can be seen in this figure during a turning maneuver the n moment generated by the lateral velocity v tends to increase the drift angle while the n moment produced by the yaw rate r tends to decrease this angle accordingly based on fig 18 as with a decrease in submergence depth the n moment generated by the v undergoes a reduction while the n moment induced by the r goes up the drift angle decreases the increase in the n moment generated by the yaw rate r with a decrease in submergence depth is apparent in the evolution of the yaw rate which reduces as the uv approaches the free surface as shown in fig 34 c furthermore the evolution of the uv speed u with respect to the steady approach speed u 0 as shown in fig 34 d demonstrates that as the uv approaches the free surface the speed loss reduces which is associated with a decrease in the drift angle see fig 34 b 4 5 2 zigzag maneuver in this section a 10 10 zigzag maneuver is performed at an approach velocity of u 0 3 344 m s which is the underlying reference velocity used to calculate the hydrodynamic forces and moments arising from the uv velocity components in this regard the rudder was executed with a deflection rate equal to 10 1 s after the uv attains the steady approach velocity fig 36 shows the evolution of the rudder deflection angle δ r 0 and the yaw angle ψ of the suboff uv during the zigzag maneuver over various submergence depths this figure clearly emphasizes the overriding effect of the increased damping characteristics of the uv with a decrease in submergence depth as can be seen in this figure the overshoot angles diminish with a decrease in submergence depth the decrease in these quantities is attributed to an increase in the damping characteristics of the uv which is reflected in the plots of the hydrodynamic forces and moments in terms of the uv velocity components shown in fig 18 this in return increases the course stability of the suboff with a decrease in submergence depth additionally fig 37 exhibits the time histories of the drift angle yaw rate and uv speed as mentioned earlier with a decrease in submergence depth both the decrease in the n moment produced by the lateral velocity v and the increase in the n moment induced by the yaw rate r are responsible for the reduction in drift angle shown in fig 37 a in this case again the increase in the n moment generated by the yaw rate r with a decrease in submergence depth is apparent in the evolution of the yaw rate which undergoes a reduction as shown in fig 37 b furthermore the evolution of the uv speed u with respect to the steady approach speed u 0 as shown in fig 37 c demonstrates a reduction in speed loss as the uv approaches the free surface which is attributed to a decrease in the drift angle moreover fig 38 shows the suboff trajectory during the 10 10 zigzag maneuver for various submergence depths as can be expected the increase in the damping characteristics of the uv and consequently in the course stability of the uv with a decrease in submergence depth gives rise to a decrease in the distance traveled by the uv 5 conclusions the main objective of the present study is to evaluate the free surface effect on the maneuverability of the axisymmetric suboff uv traveling close to the free surface in the horizontal plane for this purpose the free surface effect on the hydrodynamic forces and moments resulting from the uv velocity components is investigated therefore the hydrodynamic captive tests including the straight ahead resistance tests drift tests and rotating arm tests are performed by using numerical simulations based on urans equations coupled with a reynolds stress turbulence model these tests are carried out for various submergence depths and proper ranges of uv surge sway and yaw velocity components the numerical simulations are conducted in the commercial code starccm for the purpose of maneuverability evaluation over various submergence depths the hydrodynamic forces and moments obtained from the simulations of the hydrodynamic captive tests are implemented in the equations of motion in this regard the axial resistance force obtained from the straight ahead resistance tests with the presence of the free surface is stored in a one dimensional tabular form and a cubic interpolation is used to express this force component in the maneuvering equations the reason behind using this approach is the oscillatory behavior of this force component with respect to the axial velocity component which questions the use of the usual quadratic odd polynomial function in terms of the axial velocity the rest of the hydrodynamic forces and moments arising from the uv velocities are implemented in the maneuvering equations by fitting them to quadratic polynomial functions in terms of the uv velocity components additionally analytical equations are used to calculate the forces and moments related to the accelerations thrust and rudder which all are assumed to remain constant with respect to submergence depth the results obtained from the numerical simulations of the hydrodynamic captive tests demonstrate that the stern region of the suboff uv has a crucial effect on the y force and n moment for various submergence depths accordingly it is observed that at the entire range of submergence depths over this region an unexpected y force in the opposite direction of the total y force is induced by both the lateral and angular yaw velocities this consequently gives rise to an increase in the total n moment arising from the lateral velocity while results in a decrease in the total n moment produced by the yaw rate it is further observed that approaching the free surface has a negligible effect on the y force and n moment generated by the stern and bow regions in this regard with a decrease in submergence depth the region between the uv midlength and the aft shoulder is mainly responsible for the increase or decrease in the total y force and n moment with a decrease in submergence depth the effect of this region on the y force and n moment generated by each velocity component is as follows as the uv approaches the free surface the increase in the y force and decrease in the n moment both arising from the lateral velocity are mainly attributed to a growing pressure difference between the windward and leeward sides located in the region between the uv midlength and the aft shoulder since the y force generated by the region between the uv midlength and the aft shoulder acts in the same direction of the total y force while it generates an n moment in the opposite direction of the total n moment with a decrease in submergence depth the concurrent increase in the y force and the n moment both arising from the yaw rate is primarily attributed to the depression of the free surface above the aft leeward low pressure region created by the crossflow accordingly the depression of the free surface above the aft leeward low pressure region results in a more decrease in the dynamic pressure in this region this is largely responsible for both an increase in the y force exerted over the region between the uv midlength and the aft shoulder which acts in the same direction of the total y force and a decrease in the y force experienced by the aft shoulder region which acts in the opposite direction of the total y force this accordingly gives rise to an increase in both the total y force and the total n moment since the y force exerted over the region between the uv midlength and the aft shoulder generates an n moment in the same direction of the total n moment while the y force exerted over the aft shoulder region generates an n moment in the opposite direction of the total n moment additionally it is seen that the totally submerged bare hull suboff axisymmetric uv is highly unstable this high level of instability is attributed to the stern region in this regard as mentioned earlier an unexpected y force in the opposite direction of the total y force is induced by both the lateral and yaw velocities over the stern region this consequently gives rise to an increase in the total n moment arising from the lateral velocity while results in a decrease in the total n moment produced by the yaw rate this accordingly leads to an increase in the l v while a decrease in the l r which consequently results in an extremely low level of dynamic stability for the suboff uv moreover it is observed that with a decrease in submergence depth the dynamic stability increases remarkably in this regard as mentioned earlier a decrease in submergence depth has negligible effect on the y force and n moment generated by the bow and stern regions accordingly the increase in the dynamic stability as the uv approaches the free surface is associated with the behavior of the y force and n moment generated by the region located between the uv midlength and the aft shoulder of the suboff in this regard the behavior of the y force and n moment generated by the region located between the uv midlength and the aft shoulder is largely responsible for the concurrent increase in the l r and decrease in the l v as the uv approaches the free surface which gives rise to an increase in the uv dynamic stability moreover during the turning maneuver advance transfer tactical diameter and turning diameter all undergo an increase with a decrease in submergence depth this is due to an increase in the damping characteristics of the uv which in return decreases the maneuverability with a decrease in submergence depth additionally in zigzag maneuver the overshoot angles undergo a decrease with a reduction in submergence depth which is attributed to the improved course stability as the uv approaches the free surface furthermore the decrease in the n moment produced by the lateral velocity and the increase in the n moment generated by the yaw rate with a decrease in submergence depth lead to a decrease in the uv drift angle during the maneuvers which consequently causes a decrease in the uv speed loss besides the increase in the n moment generated by the yaw rate with a decrease in submergence depth gives rise to a reduction in the yaw rate during the suboff maneuvers declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the authors would like to thank the brazilian national council for scientific and technological development cnpq and the brazilian funding agency anp prh3 for their support 
22189,this paper presents autonomous docking of an industry standard work class rov to both static and dynamic docking station tether management system tms using visual based pose estimation techniques this is the first time autonomous docking to a dynamic docking station has been presented furthermore the presented system does not require a specially designed docking station but uses a conventional cage type tms the paper presents and discusses real world environmental tests successfully completed during january 2019 in the north atlantic ocean to validate the performance of the system a commercial state of the art underwater navigation system has been used the results demonstrate a significant advancement in resident rov automation and capabilities and represents a system which can be retrofitted to the current rov fleet keywords resident rov autonomous docking computer vision 1 introduction and background there is constant growth in the world s energy consumption and an ever increasing focus on energy security and diversification with an emphasis on having energy production within home territorial regions with expansion comes increased demand for all fuels and we have seen all variants except coal and hydroelectricity grow at above average rates dudley 2018 in recent years the trend in offshore power generation both in oil gas o g and marine renewable energy mre is to move production platforms further offshore where significant energy potential exists w europe 2017 this trend comes from a number of contributing factors including need for increased energy farm footprint technological advancements in rov auv industry and significant savings in deep water capital expenditure capex and operational expenditure opex costs compared to 2014 levels intelligence 2019 however and although higher energy potential and cost savings have resulted in deep water sites becoming commercially viable the costs associated with operations maintenance and repair are inevitably increasing with the move into deeper offshore regions in downtime failures due to the remoteness of the production platform and associated transit times weather windows for inspection maintenance and repair imr operations are significantly reduced this represents a substantial issue in reducing and maintaining projected opex costs this may not be overcome simply through predictive maintenance due to the growth in infrastructure planned within the future offshore blue economy one of the primary opex costs including rov deployment is support vessel day rates the day rate of an offshore maintenance vessel with a crew and equipped with rov typically reaches at 100 000 or more statoil 2017 christ and sr 2013 while production platform downtime can cause considerable costs in the o g industry geographic spread of infrastructure assets creates additional concerns within the mre sector which is currently undergoing huge expansion floating offshore mre farms consist of seabed infrastructure anchoring systems flexible cable risers floating platforms towers and distributed buoys sensors that can be spread over an area of 100 km 2 or more imr tasks on a huge area demand more vessels thus introducing higher opex furthermore weather conditions onsite are more adverse further offshore and considering that mre sites are by their nature located in strong wind current tide areas there can be narrow windows for imr operations the primary restriction in terms of rov operations and associated operational weather windows is in the launch and recovery of the vehicle and the most demanding time for the pilot is within the first 15 m of water depth these restrictions are recognised within the industry particularly within the offshore wind sector and as a solution to the problems resident permanently deployed underwater vehicles are emerging as a potential solution to overcome these problems expand operation weather windows and reduce opex costs using a permanently deployed vehicle real time weather independent onsite remote piloting is possible this opens the path to year round operations without the need for expensive vessels onsite and with reduced personnel transfers osj 2018 rovs have been the workhorse of the oil gas industry since their introduction in the early 1970s however the resident rov concept is only recent being born out of unprecedented cost saving demand for o g and global expansion of the offshore wind sector there are various research and development projects globally investigating this concept some with significant collaboration and investment from both the oil gas and the mre industry sector two major investments in work class resident rov systems are led by oceaneering and ikm oceaneering developed the resident rov solution e rov equinor 2019 for equinor formerly statoil the e rov system consists of a work class rov and tether management system tms stationed on the seabed with a fully integrated communication system buoy on the surface the power is supplied through submerged battery pack which can be scaled up or down depending on operational requirements oceaneering 2019 osj 2018 this system represents an intervention rov system which is mobile and can be redeployed relatively easily based on e rov oceaneering also released details of a new vehicle called freedom currently under development freedom represents a concept move towards a system in a hybrid rov auv format while in auv mode this system would be primarily mobile through the limited onboard power while moving between multiple sites spread around operational field after freedom approaches the site it reconnects to a subsea charging and communication station and allows for a real time rov piloting the other major industrial research project in resident systems is ongoing between equinor and ikm through this collaboration ikm developed a large resident system for heavy intervention in an o g field called r rov it consists of a launch and recovery system lars and power supply system deployed on a floating platform e g o g platform with a tms and docking station deployed to the seabed ut2 2018 ikm subsea 2018 the communication channel to the shore based rov operating centre is provided through satellite uplink downlink robinson et al 2018 4g mobile network or in some cases fibre optic cable piggybacked on existing pipeline infrastructure there are several examples of resident hybrid rov auv projects based around vehicle platforms which can transition between rov and auv mode which are in different stages of development and technology readiness level trl phases the primary advantage of this hybrid concept is that it can unplug itself operate in auv mode and autonomously move location to a second subsea resident station covering relatively long distances with the onboard battery pack once a resident station is reached the rov reconnects saipem is working on the hydrone family of resident rovs ut2 2018 while eelume is focused on a snake like rov for navigating through tight places liljebäck and mills 2017 another example is the rov clean sea project developed by eni and based on the use of the saab sabertooth commercial rov auv grasso et al 2016 with the objective of environmental monitoring in offshore o g fields buffagni et al 2014 in general there has been a significant uptake of commercial interest in resident rov systems with various research targeting different problems within the field reported omerdic et al 2014 ferri and djapic 2013 this has resulted in significant investment into development of early phase trl projects however many of the examples in the literature fail to address some of the fundamental barriers to the rollout of this technology into commercial sectors fundamentally resident rovs operating from shore demand a high bandwidth low latency communication link which is in most cases unavailable therefore to achieve the level of agility needed for resident rovs in subsea domains and within time critical tasks these communication issues need to be addressed high levels of automation through onboard sensor technologies machine learning computer vision and advanced control and navigation approaches can provide an alternate to the high bandwidth communication link requirements for remote on shore piloting solution dooly et al 2016 one of the critical tasks in resident rov operations is the docking of the system back into the docking station ds at the end of a mission this is a particularly crucial part of all rov operations and likely represents the primary task which will dictate the full system operating window research in the literature on the automation of subsea vehicle docking procedures has been focused on auv platforms allowing for recharging and data exchange without recovering to surface estimation of the relative position between the vehicle and the docking station includes approaches such as an electromagnetic homing systems feezor et al 2001 and an optical terminal guidance systems cowen et al 1997 autonomous docking based on use of an ultra short baseline usbl system was demonstrated in allen et al 2006 while visual based pose estimation has also been recorded krupinski et al 2008 gracias et al 2015 bosch et al 2016 zhong et al 2019 similar problems are faced in space industry for spacecraft docking fehse 2003 targeted with different visual pose estimation methods mokuno and kawano 2011 yu et al 2014 liu et al 2019b 1 1 scope of work this paper presents autonomous docking of an industry standard work class rov to both a static and b suspended tms using a visual based pose estimation approach evaluation of the system has been demonstrated through completion of offshore trials in the north atlantic ocean in january 2019 although docking of auvs with pose estimation based on image acquisition already exists park et al 2009 li et al 2015 vallicrosa et al 2016 research in the literature mainly focuses on development and docking to a static docking station usually attached to the seabed while systems facing with the docking of vehicle to moving docking stations are reported fornai et al 2013 conte et al 2016 liu et al 2019a to our knowledge this is the first autonomous docking of an rov system to a suspended tms within the water column furthermore the approach taken does not require specific narrowing entry funnel shape designs on the docking station this approach has the dual benefit of minimising mechanical complexity and footprint needed and enabling the possibility to retrofit to the existing rov fleet in comparison to the funnel shaped auv receptacle allen et al 2006 park et al 2009 vallicrosa et al 2016 a significant difference lies in the vehicle to ds entrance size ratio the entrance nozzle of auv docking stations is 4 to 5 vehicle diameters allen et al 2006 palomeras et al 2018 whereas entrance of the tms used as a docking station in this paper is approximately 1 3 times the vehicle size accurate position sensing and advanced rov control described herein allows for this docking manoeuvre 2 rov docking docking of a rov system is one of the fundamental tasks which dictates operation weather windows it takes a pilot s full concentration and skill with decisions being undertaken in a fraction of a second while controlling the rov there are two major types of tms systems a top hat tms and a cage type tms christ and sr 2013 a cage type tms was used during the trials reported in this paper 2 1 manual rov docking manual docking into a cage type tms starts with the rov stern facing the entrance of the tms as illustrated in fig 1 during the docking procedure a pilot first matches heading depth and lateral alignment of the vehicle relative to the tms the vehicle approaches the entrance of the tms slowly while still in front of the tms the pilot estimates the amount of heaving motion at this moment there is a low amount of tension present in the tether connecting the tms and rov since work class rovs are generally not agile enough to match tms heaving motion due to large inertia the pilot waits for the right moment when the entrance of the tms and the rov are aligned at the appropriate moment a light forward thrust is applied to the rov while a tether in command is given the light rov forward thrust keeps the tether under tension as the rov is docked with taut tether the rov moves backwards as we start tethering in due to the tether tension it may seem counterintuitive but the forward thrust is applied to maintain a constant tension on the tether which allows for best spooling performance and lowers the risk of tangling the tether three major disturbances potentially act upon a tms during such a docking procedure the sea current wave motion the tether pulling force between the rov and the tms rolling and heaving motion of the surface ship translated to the tms through the launch and recovery system lars as a heaving motion the sea current is a disturbance usually in a horizontal direction that acts upon the tether tms and the rov since the tms acts as a clump weight as well it absorbs the cross section drag thus the rov is relieved of the tether drag from the surface to the working depth therefore the rov needs to compensate only for vehicle drag and tether drag introduced on soft tether between tms and the vehicle however since the tms is suspended in one point the sea current generally rotates the tms around the yaw axis to an orientation that creates the least amount of drag the tms stays in such yaw orientation as long as tension in the tether connecting the rov and the tms do not cause a rotating moment the tension in tether can produce a swinging pendulum motion of the tms in the direction of the rov there are two sources of tms heave motion since the tms is suspended from a ship the amount of heave introduced to a ship through waves directly translates to the tms as shown in fig 2 the tms was deployed from the starboard side of the ship therefore a roll motion of the ship generates a tms heave motion through the lars acting as a lever arm a tms heave motion can be reduced if a heave compensating winch is employed which was not available during the trials one of the main objectives of the lars is to move the rov and tms through the splash zone safely to the working depth close to the surface the rov could easily be overpowered by the waves this would lead to possible contact between the rov tms and the ship hull to avoid direct impact of waves on the tms and the rov which could possibly lead to severe damage the docking is generally performed below the splash zone at depths of 20 m or more in summary the relative motion of the rov and tms may have a combination of heave yaw and pendulum swing motion it is generally not possible to compensate for all the motion thus docking regularly involves a rough contact bump between the rov and tms which are designed for such 3 hardware fig 2 shows the experimental setup used for autonomous docking the industry standard equipment was used with upgraded in house developed control systems the centre for robotics and intelligent systems cris university of limerick rov system consists of a control cabin launch and recovery system lars tether management system tms and the remotely operated vehicle rov étaín itself technical specifications of the system components are given in table 1 the research vessel rv celtic explorer m institute 2019 was used throughout the offshore trials the rov is controlled from a control cabin used as the control centre aboard the research vessel power is supplied from the ship while the connection between the cabin and the tms and rov is established through 2 2 km of steel reinforced umbilical with embedded fibre optic cable the lars is a conventional a frame type hydraulically operated unit 3 1 rov and tms rov étaín is a sub atlantic fully electric comanche rov with onboard hydraulic power used for manipulators and tooling the rov is equipped with an inertial navigation system coupled with a doppler velocity log dvl and an additional ultra short baseline usbl system to eliminate navigation drift solution the vehicle is equipped with four horizontal and three vertical thrusters and can achieve a maximum speed of 2 5 knots the rov buoyancy was trimmed to be slightly positive which in case of severe damage would bring the rov to the surface the rov weights approximately 1650 kg in the air and it is docked to a cage type side entry tms which is used as a docking station fig 3 shows an overview of the tms and rov system with the overall dimensions relevant for docking the tms is a conventional comanche rov tms and is not designed to operate as an auto docking station the rov fits tightly within the tms the red shaded area in the figure shows the funnel shaped tms entrance which helps to physically guide the vehicle the entrance allows only for a small misalignment during the docking procedure thus makes the auto docking task more challenging to accommodate one of the planned tests that of docking to a static docking station the tms has been slightly modified fig 4 shows four legs mounted on each corner of the tms to create clearance of the tms from the seabed and thus allow static docking manoeuvres the legs are 0 8 m long which is enough to safely operate the rov without disturbing the stability of the tms 3 2 navigational lights for docking to complete testing of algorithms for lights recognition and pose estimation prior to any mobilisation for offshore missions a simple rig to test the developed software was built a plywood board was used as the rig body with 100 100 mm inscribed squares which form a raster for the different light patterns and configurations that were tested an optimal light beacons arrangement has been achieved taking into account the camera field of view fov robustness to light saturation and possible camera mounting positions on the rov conventional off the shelf led light bulbs were used the light beacons have been arranged asymmetrically to uniquely define the orientation of the light marker the vision system does not necessarily require the overall marker to be asymmetrical in that case the orientation of the vehicle has to be assumed or measured with additional sensor for example if rectangular marker is used the vehicle orientation is not uniquely defined and there are two possible solutions the rov is either oriented normally or it is rotated 180 around roll axis to determine the rov orientation a measurement from the onboard ins system can be used otherwise the orientation can be assumed based on the mechanical properties and the design of the rov since the rov centre of buoyancy is above the centre of gravity positive longitudinal and lateral stability is achieved therefore the vehicle is stable on the pitch and roll axis and the orientation of the vehicle can be assumed with certain probability yielding unique solution fig 5 shows the test rig with light beacons attached to it forming different asymmetrical patterns the analysis of the propagation of the light through seawater is a well established area of research duntley 1963 haltrin 1999 the research shows that the red spectre of light is highly attenuated in deep ocean water while the blue light attenuates at much less degree low attenuation property can be shifted towards the green light in coastal areas with yellow solutes which result from the plant and animal materials decomposition therefore the property of blue light penetration in sea water is often used in subsea wireless optical communications field pontbriand et al 2008 caiti et al 2016 for auv visual based docking cowen et al 1997 liu et al 2018 and underwater object detection and tracking lee et al 2012 however the scope of the paper is to use existing industry standard technology thus the lights used for the visual pose estimation are conventional off the shelf bowtech led k 3200 dc underwater lights rated to 3000 m this type of lights is typically used on the tms systems rovs trenchers and other subsea structures for better visibility in a dark or turbid environment therefore the existing tms lights were remounted to form an asymmetrical pattern which is to be recognised by the camera the lights are mounted at the back of the tms using aluminium profiles 3 3 camera the machine vision camera used for testing and trials is a power over ethernet poe ids ueye ui527xcp c gige with sony 1 1 8 cmos imx265 sensor the maximum resolution of the camera is 2056 1542 pixels horizontal and vertical subsampling is used to reduce network overload and to achieve a higher sample rate the camera is enclosed in a subsea housing rated to 2000 m as shown in fig 6 a lensagon bm4518s lens with fixed focus is used the camera housing has a flat port and the lens is not wide angle thus the fov is reduced significantly due to light refraction in water to achieve the widest possible fov the authors suggest using dome ports and wide angle lenses the acquired image is sent via the rov network to a dedicated topside pc where image processing is done the physical network layer consists of an optical fibre enclosed in 2 2 km steel reinforced umbilical connecting the rov cabin with the tms and 400 m of soft tether connecting the tms and the rov the gigabit network uses the tcp ip protocol due to the rov design which requires reversing into the tms while docking the camera is mounted at the stern of the rov and faces backwards 4 autonomous docking this section describes the auto docking methods developed for the experiment image acquisition and processing was implemented on the surface using a dedicated computer the rov control is part of the oceanrings omerdic et al 2013 sivčev et al 2018 rossi et al 2018 software developed within the research group the image processing pc and the rov control pc communicate through the network using the udp protocol 4 1 camera calibration the camera must be calibrated before the beginning of the experiment and although methods to pre calibrate in air exist łuczyński et al 2017 the best practice is to acquire calibration parameters on site the calibration panel used for the calibration process is a 7 10 chessboard pattern printed on an a4 sized pvc board the panel was mounted on the port side of the tms and deployed in water the rov was manually manoeuvred around the tms while images of the panel were acquired from different angles the images were processed and intrinsic camera parameters derived the calibration algorithm assumes a pinhole camera model hartley and zisserman 2004 fig 7 shows images with a chessboard pattern attached to the tms approximately 50 images were taken from different angle and distance combinations acquired lens distortion and intrinsic parameters of the camera are used to correct image distortion thus providing better pose estimation since the emphasis of the paper is on rov docking procedures in the remainder of this paper term docking station ds is used for tms 4 2 image acquisition and pose estimation image acquisition and processing software has been implemented in matlab on a dedicated computer located in the rov control cabin an interface between the camera used during the trials and matlab does not exist thus a mex file based on ueye camera interface in matlab 2016 was created in order to use the c sdk provided by the camera manufacturer the term mex stands for matlab executable the relative position between the rov and the docking station ds is estimated using a single camera and a light marker of a known size the light marker consists of four light beacons mounted on the aluminium frame the frame with the marker is mounted on the ds as shown previously in fig 5 to avoid ambiguity the light beacons were mounted asymmetrically thus creating a unique light marker a similar approach was used in palomeras et al 2018 where active light beacons with known blinking patterns were used in order to avoid the same problem the image processing steps are shown in fig 8 the process starts with image acquisition a distortion is then removed based on known camera intrinsic parameters obtained through the camera calibration b to avoid problems related to light scatter as mentioned in park et al 2009 camera exposure is set to a value where only strong sources of light relative to surroundings can be detected a gaussian filter is used to blur the image in the next step c image blur is used as a low pass filter which averages out the pixel intensities although by adding blur more detail is being removed the position of the brightest objects in the image light beacons is not changed thus the precision is not reduced while robustness is achieved additionally salt and pepper noise could occur during the image acquisition and transmission and affect the binarization of the image in the last step in that case a non linear filter from the group of median filters should be used chan et al 2005 esakkirajan et al 2011 in the last step the image is thresholded and the centres of the four detected disc shaped objects are calculated d the image threshold function returns a binary image from a greyscale image by replacing all values that are above a globally determined threshold with the value 1 while setting all other values to 0 if the image is not blurred small reflections from metal objects or the rov tether can be detected as shown in 8 e ideally the binary image returns four perfectly disc shaped objects with calculated centres of objects matching the centres of the real light beacons based on the known distance between the centres of the four light beacons and known camera parameters a transformation matrix between two planes can be computed providing information about all six degrees of freedom the coordinate systems used in this section are shown in fig 9 the docking station ds reference frame is considered the fixed world frame and it is defined by four light beacons with the xy plane being coplanar with the plane passing through the centres of the light beacons the origin of ds frame can be arbitrary point in that plane once the origin of the frame is chosen the relative distance between the light beacons and the origin is measured as shown in fig 10 the measured distances present a world coordinates of light beacons b ds in practice the origin of ds frame is chosen to align with the camera frame when rov is docked and latched given the world coordinates of light beacons b ds their corresponding image coordinates i b and intrinsic camera parameters k the extrinsic camera parameters are calculated as 1 r cam ds t cam ds e b ds i b k where b ds is an m 3 matrix with at least m 4 coplanar points i b is a corresponding m 3 matrix r cam ds is a 3 d rotation matrix and t cam ds is a 3 d translation vector the transformation of points from the docking station frame to the camera frame therefore is 2 p n cam p n ds r cam ds t cam ds where p n cam is the position vector of point n in the camera frame with coordinates x n cam y n cam z n cam and p n ds is the position vector of point n in the ds frame the vehicle control system is designed to operate in the rov coordinate frame the rov frame is defined as the intersection of lines connecting the centres of diagonally placed thrusters the transformation of any point n from camera frame to rov frame is defined as 3 p n ds p n cam r rov cam t rov cam the position error between the docking point dp and the origin of the rov frame is used to calculate setpoints for position and speed controllers when dp overlaps with the origin of the rov frame the vehicle is considered docked therefore given the docking point dp in the ds frame the position error vector e in the rov frame used as feedback for the vehicle position control loop is calculated as 4 p dp cam p dp ds r cam ds t cam ds e p dp cam r rov cam t rov cam where e x e y e z e 4 3 rov control system setpoints for rov surge sway depth and heading control are fed into oceanrings low level controllers llc oceanrings is a suite of smart technologies for rov control and subsea operations continuously being developed in house at the centre for robotics and intelligent systems cris oceanrings consists of speed depth and heading controllers for subsea navigation and dynamic positioning and various pilot interfaces with visualisation and situation awareness omerdic and toal 2012 toal et al 2012 the system is designed as a 3 layer rov control system omerdic et al 2013 low level controllers with fault tolerant control allocation algorithms are part of the bottom layer capocci et al 2018 an interface between an rov and other supporting platforms is part of the middle layer e g supporting vessels tms image acquisition pc while supervision monitoring and mission planning tools are part of the top layer based on the camera pose estimation control parameters are sent to the rov low level controllers six llcs control the rov each for one degree of freedom dof surge and sway controllers are velocity controllers while heave roll pitch and yaw are position controllers the internal structure of an llc loop is shown in fig 11 modified pid controllers with normalised outputs were used to control the rov the difference between setpoints sps acquired from the image acquisition pc and process variables pvs are used to generate a manipulated variable mv the manipulated variable is applied to drive actuators if a controller is disabled the corresponding mv is set to zero in the case of a time varying sp feed forward ff input is used to improve tracking performance to avoid problems related to integrator saturation vector s p offset is used individual controller outputs are bundled into a vector of normalised forces and moments τ llc since the instruments and equipment onboard are likely to be removed added or replaced during the trials the dynamic properties of the rov change therefore for the optimal controller performance autotuning of the low level controllers is necessary the relay output is used for the llc autotuning with two developed autotuning algorithms the recorded force speed static characteristic is utilised for the velocity controllers tuning while position controllers use self oscillations approach the autotuning algorithms and process are explained in more detail in omerdic et al 2013 4 4 additional considerations 4 4 1 light marker coverage in the instance of full or partial occlusion of one or more light beacons pose estimation is not viable such a situation is shown in fig 12 with the light beacons fully covered by the rov tether and the tms frame such a situation can also occur due to other factors such as fish or curious mammals e g seals dolphins during the docking procedure the rov trajectory is always towards the entrance of the tms thus it always moves towards the area with better optical marker visibility as shown in fig 13 the algorithms have been implemented to filter pose estimation errors and to protect the system in case such errors become too large in case of full coverage of one of the light beacons fig 12 the pose cannot be estimated thus the last known pose is used to align and guide the rov towards the entrance of the ds therefore by increasing the proximity to the ds the probability to acquire an image with all markers rises in the next iteration if the pose cannot be estimated after multiple iterations the rov docking manoeuvre is aborted due to the slow dynamics of the rov and low speeds 0 4 knots the motion between two consecutive iteration is small making the described algorithm suitable for this application partial light beacon coverage causes significant pose error thus every calculated position in step n is compared with the position calculated in step n 1 if an unrealistic change in position between two iterations is detected the algorithm assumes inadequate pose estimation in which case the last known position is used an additional light search algorithm is considered to be implemented for future operations 4 4 2 low angle measurement sensitivity although the discussed pose estimation method provides information on the ds relative orientation and position initial tests showed low sensitivity to angle measurements as shown in fig 14 the relative heading α ds between the ds and the rov maps in the camera projection plane as a perspective distortion of the light marker for relatively small angles α ds 1 0 the perspective distortion in the camera plane is minimal and it is not sufficiently detected due to the camera resolution the error in the estimation of the angle α ds reflects as rov pose estimation error within close range to the docking station these errors can be neglected due to the angle estimation errors the rov depth and heading control based on visual pose estimation can cause docking failures in order to improve autonomous docking performance the data from the ds heading and depth sensors was used to avoid rov heading and depth control 4 4 3 the tms deployment process for static docking to test docking to a static target the tms was deployed to the seabed although static docking is less complicated in terms of control of the vehicle the risk of damaging equipment was significantly higher since the tms and the lars used for the experiment are not designed for such operation deployment of assets is a complicated procedure and many factors should be taken into account waves sea currents and tides act upon the tms during the deployment process the tms used during the trials was not designed for deployment to the seabed thus additional precaution had to be taken the deployment of the tms to the seabed was a challenging task because of the numerous problems that can occur and cause severe damage to the system the main challenges were heaving and rolling motion of the ship transferred through the lars can cause a heavy impact between the tms and the seabed in the last few metres before touchdown thus causing damage the umbilical connecting the lars and the tms should not be loose because its armour can unwind the horizontal movement of the ship must be minimised in order to avoid flipping and damaging the tms operating from a station keeping vessel introduces the risk of umbilical and ship thruster entanglement when deploying assets to the seabed in high sea states different techniques can be used to compensate for heave motion there are active and passive heave compensation systems christ and sr 2013 in active systems the amount of heave is measured with motion sensors depending on the measurement the winch pays out or takes in the umbilical in passive systems the umbilical tension is held constant since the lars used in this case did not have automatic heave compensation the tms was deployed during a window of relatively good weather conditions a few metres of umbilical slack was allowed to compensate for the heaving motion of the ship once the tms was on the seabed attention had to be paid not to release too much umbilical in order to avoid entanglement with the tms and interference with the rov operation the slack also had to be continuously trimmed over time for tidal change the umbilical connecting the lars and the tms is armoured and it is designed for a constant tension load suspended tms if a long part of the umbilical gets loose there is a possibility of armour unwinding which could cause severe damage to the lars tms and the rov therefore static docking operations were limited to shallow waters with a few metres of slack and a relatively short distance between the ship and the tms horizontal movement of the ship should not exceed a few metres to avoid flipping the tms over or dragging it on the seabed to compensate for that the ship was using its station keeping system in the highest precision mode while using station keeping the ship s thrusters are active thus additional caution should be taken to avoid contact between loose umbilical and the thrusters the motion of the ship was within the radius of five metres which allowed us to successfully perform the static docking experiment to deploy the tms on the seabed the tms with the rov inside it was lowered down to 20 m of depth altitude was approximately 10 m the pilot then flew the rov out of the tms which was slowly lowered down while a continuous general visual inspection of the umbilical seabed and the tms was being carried out once the tms was safe on the seabed experiment was ready to proceed 5 results this section presents the results of offshore docking experiments video material of the trials is available on the cris youtube channel cris ul 2019 results indicated that visual pose estimation based autonomous docking of a work class rov and tms in a real world environment is possible both static and dynamic docking experiments were performed during the trials although initial camera pose estimation tests were performed earlier trslic et al 2018 the camera pose estimation for rov control and autonomous docking has never been tested before thus it was necessary to determine the system performance first to validate the performance of the system the rov position was measured simultaneously using two different techniques camera pose estimation was used for the rov control as described in section 4 3 the usbl underwater acoustic positioning system was used for qualitative comparison and monitoring such a system consists of an inertial navigational system ins coupled with a doppler velocity log dvl and usbl transponder all mounted on the rov and a usbl transceiver mounted on the ship the rov position measured with the usbl ins is considered as ground truth with a measured standard deviation between 0 2 and 0 3 m at all times during the experiment in this section the results of both static and dynamic docking are shown and the rov approaching procedure for dynamic docking is explained 5 1 static docking to be able to measure the performance of camera estimated relative distance between the rov and the docking station with the usbl the position of both must be known the ds position was recorded prior to the static docking experiment since only one usbl beacon attached to the vehicle for continuous monitoring was provided during the trials as shown in fig 15 it is assumed that the ds position did not change over time the experiment started with the rov placed 4 5 m in front of the ds entrance the start position was randomly chosen while the light beacons were kept in the camera s fov the maximum rov speed during the experiment was limited to 0 4 knots the docking station was placed on a rocky seabed at a water depth of approximately 25 m fig 16 shows the distance x d and z d and the relative heading α ds between the origin of the rov frame and the docking point dp during the docking experiment the orientation of coordinate frames is shown in fig 9 fig 16 a shows the distance between the rov and docking point in xz plane the red line with triangles represents the camera pose estimation while the blue line with circles represents the pose measured with usbl and ins systems the position standard deviation of the usbl ins system is showed by blue shaded area throughout the experiment the deviation was between 0 22 and 0 25 m a disparity between the estimated and the true position is present at greater distances but as the rov gets closer to the ds the estimated and true position converge the disparity is due to the low angle measurement sensitivity as explained in section 4 4 2 which is reflected as pose estimation error particularly in the x d axis the distance z d and x d plotted against time are shown in b and c estimation of z d shows good performance during the experiment with the estimated position within 0 2 m from the ground truth position at all times due to the partial light beacon coverage discussed in section 4 4 pose estimation errors were present and are shown as spikes in the graphs in case of a not feasible estimated pose or velocity in step n the measurement is neglected and the pose estimated in step n 1 is used for rov control as explained in fig 13 estimated and true relative heading α ds between the rov and the ds is shown in d images e 1 3 show the rov approaching the ds entrance the images were acquired with the camera mounted on the ds at different times during the experiment the rov heading is aligned with the ds heading during the approach the relative heading α ds should be 5 deg before the rov enters the ds e 4 in order to dock successfully once the rov stern entered the ds entirely e 5 there is only one dof between the rov and the ds left since the narrow camera fov does not allow for pose estimation from a closer distance and moving the rov along the z axis in this position is trivial the docking experiment is considered successful multiple successful dockings were performed during the trials fig 17 shows the rov distance from the dp in the xz plane during five different dockings each docking experiment started from a different position and with a different orientation the red rectangle shows a region within 0 2 m from the centre of the dp frame when the centre of the rov coordinate frame is within the region the dock is considered successful as mentioned previously low angle measurement sensitivity at bigger distances from the light marker reflects as a position error particularly in the x d axis fig 18 a shows visual pose estimation error distribution of x d depending on the relative heading α ds and distance from the docking station z d while position error is minimal at the closer distances up to 3 m light green dots and it does not depend on the relative heading at longer distances z d error grows significantly fig 18 b shows folded normal distribution of position error x d err for range of z d between 0 and 1 5 m with corresponding mean and standard deviation value the position error for the range between 1 5 and 3 m is shown in b while the distribution of position error in the range between 3 and 4 5 m is shown in c 5 2 dynamic docking the rov position and relative heading in the dp frame during a dynamic docking experiment are shown in fig 19 the operating depth was approximately 20 m throughout the experiment since one usbl beacon was provided the comparison between camera pose estimation and usbl position was not viable because of the inability to measure the ds position continuously the docking procedure started approximately 2 5 m from the ds entrance e 1 partial light beacon coverage caused an error which was detected and the vehicle continued moving towards the ds entrance the contact between the vehicle and the ds was established e 2 the rov position was aligned with the docking station e 3 and the rov was docked successfully e 4 during the experiment the ds was suspended and exposed to the disturbances previously shown in fig 1 thus the docking approach was changed compared to the static docking due to inertia larger mass vehicles react slowly to thruster output thus it was not feasible to compensate fully for the ds heave motion therefore while static docking was performed with minimal contact between the vehicle and the ds during dynamic docking the contact is inevitable fig 20 shows the ds heave motion during the experiment the peak to peak amplitude was approximately 1 1 m with a period of 8 5 s to dock the vehicle successfully an average ds depth was calculated and used as the setpoint for rov depth there is a limit using this approach for the ds system used during the trials the maximum peak to peak amplitude must be lower than the ds entrance height to avoid tether damage rovs are designed for harsh environments and able to handle mechanical stress but it is crucial not to damage the tether fig 21 shows a series of images during the docking manoeuvre the rov in initial docking position starts with the docking manoeuvre 1 and approaches the ds 2 3 the ds heading has the tendency to change if an external force acts upon it e g contact between the rov and the ds after the contact 4 it is important to maintain reverse thrust on the vehicle the reverse thrust creates momentum around the ds yaw axis and helps with the rov heading alignment 5 6 7 the rov position is thus aligned in 8 9 while the vehicle was still reversing back completely aligned the ds depth changed due to the heave motion and the rov docked in 10 11 12 the presented docking manoeuvre is the worst case docking scenario since the ds used in these experiments is underactuated the ds position and orientation are not controllable while ds pitch and roll are stable the ds has a tendency to yaw since the ds is equipped with an onboard magnetic compass by adding two thrusters it would be possible to control the ds yaw motion and hence its heading if the ds heading is controlled and an active heave compensation lars system is used to compensate for heave motion the dynamic docking practically reverts to a static docking problem 6 conclusion and discussion subsea navigation being used in residential rovs is manual control from the support vessel or from shore based control centres with an existing fleet of vehicles and experienced rov pilots as an in field proven solution the offshore industry is still hugely dependent on manual pilot skill however a transition towards automation in the resident rov field can provide significant advantages and can specifically increase operational weather windows for the marine imr sectors to close this gap while acknowledging the traditional risk adverse nature of the sector and to accelerate uptake in resident rov technology the existing industry hardware fleet with software upgrades should be utilised the autonomy needed for a resident rov should be achieved incrementally through automating specific tasks while the rov pilot role transitions towards supervisory as more and more tasks are automated one of the most critical operations is the docking of the rov at the end of a mission which was the targeted operation for automation in this paper and research a machine vision based docking system was developed around subsea camera pose estimation the system has been developed for standard work class rov systems found throughout the sector deployed from suspended cage type tms the relative position between the rov and the docking station ds was estimated using a single camera and a known light marker pattern the rov speed and position controllers coupled with camera pose estimation provided a strong platform for such operations a multi step pipeline of image acquisition distortion removal exposure estimation gaussian filter blur and image thresholding allows for the centres of each light beacon within the light marker to be estimated with a high level of precision the centre points and distances between each beacon then allow for pose estimation of the rov to the docking station the position error between docking point dp and origin of the rov frame is used to calculate setpoints for position and speed controllers which are fed into rov low level controllers llc when the dp overlaps with the origin of the rov frame the vehicle is considered docked the system has been tested and demonstrated in a real world environment during january 2019 in the north atlantic ocean the reference system used for comparison is commercial state of the art underwater navigation system based on the ixblue phins ins coupled with nortek 500 dvl and teledyne ranger 2 usbl and results have shown to be comparable the accuracy of the developed pose sensor has been shown to be a function of distance from the docking station it has been shown to be capable of accurately measuring the pose distances and angle up to distances of 4 m in close proximity within 1 metre the differences with the ins solution ixblue unit were minimal the full system including the rov automated navigational control was trialled first using a static docking station and the results were within tolerances to allow multiple successful dockings this system was further tested using a dynamic docking station suspended from surface vessel and the results achieved were sufficient to dock multiple times in heave disturbances due to wave motion of 1 1 m to dock the vehicle successfully the maximum peak to peak amplitude was found must be lower than 2 m to avoid damaging the rov tether to the author s knowledge this is the first autonomous docking of an rov system to a dynamic docking station and represents a significant contribution towards robustness and viability of resident rovs operated using satellite communication channels and overcoming issues such as latency the paper presents a visual pose estimation for autonomous docking when in close range up to 8 m from a docking station while visual pose estimation performed well during the trials in a low to medium water turbidity with higher water turbidity an operation range of the optical sensing becomes limited in highly turbid water where a visual pose estimation is unavailable the acoustic pose estimation based on usbl lbl technology should be used since the precision of acoustic based positioning systems is lower than vision based systems the docking station entrance should be modified the extended funnel shaped entrance allows for a larger position error and helps to physically guide the vehicle future developments within the automated docking system are focused on the quality of camera pose estimation and suspended tms motion replication relying on the work of rossi et al 2018 palomeras et al 2018 sivčev et al 2018 the method based on a stereo camera pair using the stereofusion algorithm for real time 3d dense reconstruction and camera tracking will improve position estimation quality and overcome the marker detection problem due to the light beacon occlusion fusing data from the onboard inertial navigation system with vision based navigation will contribute to system robustness and accuracy while a tms motion replication could partially compensate for suspended tms heave motion allowing for faster and smoother docking additional thrusters could be attached to the tms for better yaw motion stability while a wide angle camera lens and a dome port on the camera housing should be used to expand the camera s fov declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this material is based upon works supported by science foundation ireland and industry partners shannon foynes port company and the commissioners of irish lights ireland under the marei research centres awards 12 rc 2302 p2 14 sp 2740 robovaas eu era net co fund award through irish marine institute and eu horizon 2020 research and innovation programme project eumarinerobots under grant agreement 731103 
22189,this paper presents autonomous docking of an industry standard work class rov to both static and dynamic docking station tether management system tms using visual based pose estimation techniques this is the first time autonomous docking to a dynamic docking station has been presented furthermore the presented system does not require a specially designed docking station but uses a conventional cage type tms the paper presents and discusses real world environmental tests successfully completed during january 2019 in the north atlantic ocean to validate the performance of the system a commercial state of the art underwater navigation system has been used the results demonstrate a significant advancement in resident rov automation and capabilities and represents a system which can be retrofitted to the current rov fleet keywords resident rov autonomous docking computer vision 1 introduction and background there is constant growth in the world s energy consumption and an ever increasing focus on energy security and diversification with an emphasis on having energy production within home territorial regions with expansion comes increased demand for all fuels and we have seen all variants except coal and hydroelectricity grow at above average rates dudley 2018 in recent years the trend in offshore power generation both in oil gas o g and marine renewable energy mre is to move production platforms further offshore where significant energy potential exists w europe 2017 this trend comes from a number of contributing factors including need for increased energy farm footprint technological advancements in rov auv industry and significant savings in deep water capital expenditure capex and operational expenditure opex costs compared to 2014 levels intelligence 2019 however and although higher energy potential and cost savings have resulted in deep water sites becoming commercially viable the costs associated with operations maintenance and repair are inevitably increasing with the move into deeper offshore regions in downtime failures due to the remoteness of the production platform and associated transit times weather windows for inspection maintenance and repair imr operations are significantly reduced this represents a substantial issue in reducing and maintaining projected opex costs this may not be overcome simply through predictive maintenance due to the growth in infrastructure planned within the future offshore blue economy one of the primary opex costs including rov deployment is support vessel day rates the day rate of an offshore maintenance vessel with a crew and equipped with rov typically reaches at 100 000 or more statoil 2017 christ and sr 2013 while production platform downtime can cause considerable costs in the o g industry geographic spread of infrastructure assets creates additional concerns within the mre sector which is currently undergoing huge expansion floating offshore mre farms consist of seabed infrastructure anchoring systems flexible cable risers floating platforms towers and distributed buoys sensors that can be spread over an area of 100 km 2 or more imr tasks on a huge area demand more vessels thus introducing higher opex furthermore weather conditions onsite are more adverse further offshore and considering that mre sites are by their nature located in strong wind current tide areas there can be narrow windows for imr operations the primary restriction in terms of rov operations and associated operational weather windows is in the launch and recovery of the vehicle and the most demanding time for the pilot is within the first 15 m of water depth these restrictions are recognised within the industry particularly within the offshore wind sector and as a solution to the problems resident permanently deployed underwater vehicles are emerging as a potential solution to overcome these problems expand operation weather windows and reduce opex costs using a permanently deployed vehicle real time weather independent onsite remote piloting is possible this opens the path to year round operations without the need for expensive vessels onsite and with reduced personnel transfers osj 2018 rovs have been the workhorse of the oil gas industry since their introduction in the early 1970s however the resident rov concept is only recent being born out of unprecedented cost saving demand for o g and global expansion of the offshore wind sector there are various research and development projects globally investigating this concept some with significant collaboration and investment from both the oil gas and the mre industry sector two major investments in work class resident rov systems are led by oceaneering and ikm oceaneering developed the resident rov solution e rov equinor 2019 for equinor formerly statoil the e rov system consists of a work class rov and tether management system tms stationed on the seabed with a fully integrated communication system buoy on the surface the power is supplied through submerged battery pack which can be scaled up or down depending on operational requirements oceaneering 2019 osj 2018 this system represents an intervention rov system which is mobile and can be redeployed relatively easily based on e rov oceaneering also released details of a new vehicle called freedom currently under development freedom represents a concept move towards a system in a hybrid rov auv format while in auv mode this system would be primarily mobile through the limited onboard power while moving between multiple sites spread around operational field after freedom approaches the site it reconnects to a subsea charging and communication station and allows for a real time rov piloting the other major industrial research project in resident systems is ongoing between equinor and ikm through this collaboration ikm developed a large resident system for heavy intervention in an o g field called r rov it consists of a launch and recovery system lars and power supply system deployed on a floating platform e g o g platform with a tms and docking station deployed to the seabed ut2 2018 ikm subsea 2018 the communication channel to the shore based rov operating centre is provided through satellite uplink downlink robinson et al 2018 4g mobile network or in some cases fibre optic cable piggybacked on existing pipeline infrastructure there are several examples of resident hybrid rov auv projects based around vehicle platforms which can transition between rov and auv mode which are in different stages of development and technology readiness level trl phases the primary advantage of this hybrid concept is that it can unplug itself operate in auv mode and autonomously move location to a second subsea resident station covering relatively long distances with the onboard battery pack once a resident station is reached the rov reconnects saipem is working on the hydrone family of resident rovs ut2 2018 while eelume is focused on a snake like rov for navigating through tight places liljebäck and mills 2017 another example is the rov clean sea project developed by eni and based on the use of the saab sabertooth commercial rov auv grasso et al 2016 with the objective of environmental monitoring in offshore o g fields buffagni et al 2014 in general there has been a significant uptake of commercial interest in resident rov systems with various research targeting different problems within the field reported omerdic et al 2014 ferri and djapic 2013 this has resulted in significant investment into development of early phase trl projects however many of the examples in the literature fail to address some of the fundamental barriers to the rollout of this technology into commercial sectors fundamentally resident rovs operating from shore demand a high bandwidth low latency communication link which is in most cases unavailable therefore to achieve the level of agility needed for resident rovs in subsea domains and within time critical tasks these communication issues need to be addressed high levels of automation through onboard sensor technologies machine learning computer vision and advanced control and navigation approaches can provide an alternate to the high bandwidth communication link requirements for remote on shore piloting solution dooly et al 2016 one of the critical tasks in resident rov operations is the docking of the system back into the docking station ds at the end of a mission this is a particularly crucial part of all rov operations and likely represents the primary task which will dictate the full system operating window research in the literature on the automation of subsea vehicle docking procedures has been focused on auv platforms allowing for recharging and data exchange without recovering to surface estimation of the relative position between the vehicle and the docking station includes approaches such as an electromagnetic homing systems feezor et al 2001 and an optical terminal guidance systems cowen et al 1997 autonomous docking based on use of an ultra short baseline usbl system was demonstrated in allen et al 2006 while visual based pose estimation has also been recorded krupinski et al 2008 gracias et al 2015 bosch et al 2016 zhong et al 2019 similar problems are faced in space industry for spacecraft docking fehse 2003 targeted with different visual pose estimation methods mokuno and kawano 2011 yu et al 2014 liu et al 2019b 1 1 scope of work this paper presents autonomous docking of an industry standard work class rov to both a static and b suspended tms using a visual based pose estimation approach evaluation of the system has been demonstrated through completion of offshore trials in the north atlantic ocean in january 2019 although docking of auvs with pose estimation based on image acquisition already exists park et al 2009 li et al 2015 vallicrosa et al 2016 research in the literature mainly focuses on development and docking to a static docking station usually attached to the seabed while systems facing with the docking of vehicle to moving docking stations are reported fornai et al 2013 conte et al 2016 liu et al 2019a to our knowledge this is the first autonomous docking of an rov system to a suspended tms within the water column furthermore the approach taken does not require specific narrowing entry funnel shape designs on the docking station this approach has the dual benefit of minimising mechanical complexity and footprint needed and enabling the possibility to retrofit to the existing rov fleet in comparison to the funnel shaped auv receptacle allen et al 2006 park et al 2009 vallicrosa et al 2016 a significant difference lies in the vehicle to ds entrance size ratio the entrance nozzle of auv docking stations is 4 to 5 vehicle diameters allen et al 2006 palomeras et al 2018 whereas entrance of the tms used as a docking station in this paper is approximately 1 3 times the vehicle size accurate position sensing and advanced rov control described herein allows for this docking manoeuvre 2 rov docking docking of a rov system is one of the fundamental tasks which dictates operation weather windows it takes a pilot s full concentration and skill with decisions being undertaken in a fraction of a second while controlling the rov there are two major types of tms systems a top hat tms and a cage type tms christ and sr 2013 a cage type tms was used during the trials reported in this paper 2 1 manual rov docking manual docking into a cage type tms starts with the rov stern facing the entrance of the tms as illustrated in fig 1 during the docking procedure a pilot first matches heading depth and lateral alignment of the vehicle relative to the tms the vehicle approaches the entrance of the tms slowly while still in front of the tms the pilot estimates the amount of heaving motion at this moment there is a low amount of tension present in the tether connecting the tms and rov since work class rovs are generally not agile enough to match tms heaving motion due to large inertia the pilot waits for the right moment when the entrance of the tms and the rov are aligned at the appropriate moment a light forward thrust is applied to the rov while a tether in command is given the light rov forward thrust keeps the tether under tension as the rov is docked with taut tether the rov moves backwards as we start tethering in due to the tether tension it may seem counterintuitive but the forward thrust is applied to maintain a constant tension on the tether which allows for best spooling performance and lowers the risk of tangling the tether three major disturbances potentially act upon a tms during such a docking procedure the sea current wave motion the tether pulling force between the rov and the tms rolling and heaving motion of the surface ship translated to the tms through the launch and recovery system lars as a heaving motion the sea current is a disturbance usually in a horizontal direction that acts upon the tether tms and the rov since the tms acts as a clump weight as well it absorbs the cross section drag thus the rov is relieved of the tether drag from the surface to the working depth therefore the rov needs to compensate only for vehicle drag and tether drag introduced on soft tether between tms and the vehicle however since the tms is suspended in one point the sea current generally rotates the tms around the yaw axis to an orientation that creates the least amount of drag the tms stays in such yaw orientation as long as tension in the tether connecting the rov and the tms do not cause a rotating moment the tension in tether can produce a swinging pendulum motion of the tms in the direction of the rov there are two sources of tms heave motion since the tms is suspended from a ship the amount of heave introduced to a ship through waves directly translates to the tms as shown in fig 2 the tms was deployed from the starboard side of the ship therefore a roll motion of the ship generates a tms heave motion through the lars acting as a lever arm a tms heave motion can be reduced if a heave compensating winch is employed which was not available during the trials one of the main objectives of the lars is to move the rov and tms through the splash zone safely to the working depth close to the surface the rov could easily be overpowered by the waves this would lead to possible contact between the rov tms and the ship hull to avoid direct impact of waves on the tms and the rov which could possibly lead to severe damage the docking is generally performed below the splash zone at depths of 20 m or more in summary the relative motion of the rov and tms may have a combination of heave yaw and pendulum swing motion it is generally not possible to compensate for all the motion thus docking regularly involves a rough contact bump between the rov and tms which are designed for such 3 hardware fig 2 shows the experimental setup used for autonomous docking the industry standard equipment was used with upgraded in house developed control systems the centre for robotics and intelligent systems cris university of limerick rov system consists of a control cabin launch and recovery system lars tether management system tms and the remotely operated vehicle rov étaín itself technical specifications of the system components are given in table 1 the research vessel rv celtic explorer m institute 2019 was used throughout the offshore trials the rov is controlled from a control cabin used as the control centre aboard the research vessel power is supplied from the ship while the connection between the cabin and the tms and rov is established through 2 2 km of steel reinforced umbilical with embedded fibre optic cable the lars is a conventional a frame type hydraulically operated unit 3 1 rov and tms rov étaín is a sub atlantic fully electric comanche rov with onboard hydraulic power used for manipulators and tooling the rov is equipped with an inertial navigation system coupled with a doppler velocity log dvl and an additional ultra short baseline usbl system to eliminate navigation drift solution the vehicle is equipped with four horizontal and three vertical thrusters and can achieve a maximum speed of 2 5 knots the rov buoyancy was trimmed to be slightly positive which in case of severe damage would bring the rov to the surface the rov weights approximately 1650 kg in the air and it is docked to a cage type side entry tms which is used as a docking station fig 3 shows an overview of the tms and rov system with the overall dimensions relevant for docking the tms is a conventional comanche rov tms and is not designed to operate as an auto docking station the rov fits tightly within the tms the red shaded area in the figure shows the funnel shaped tms entrance which helps to physically guide the vehicle the entrance allows only for a small misalignment during the docking procedure thus makes the auto docking task more challenging to accommodate one of the planned tests that of docking to a static docking station the tms has been slightly modified fig 4 shows four legs mounted on each corner of the tms to create clearance of the tms from the seabed and thus allow static docking manoeuvres the legs are 0 8 m long which is enough to safely operate the rov without disturbing the stability of the tms 3 2 navigational lights for docking to complete testing of algorithms for lights recognition and pose estimation prior to any mobilisation for offshore missions a simple rig to test the developed software was built a plywood board was used as the rig body with 100 100 mm inscribed squares which form a raster for the different light patterns and configurations that were tested an optimal light beacons arrangement has been achieved taking into account the camera field of view fov robustness to light saturation and possible camera mounting positions on the rov conventional off the shelf led light bulbs were used the light beacons have been arranged asymmetrically to uniquely define the orientation of the light marker the vision system does not necessarily require the overall marker to be asymmetrical in that case the orientation of the vehicle has to be assumed or measured with additional sensor for example if rectangular marker is used the vehicle orientation is not uniquely defined and there are two possible solutions the rov is either oriented normally or it is rotated 180 around roll axis to determine the rov orientation a measurement from the onboard ins system can be used otherwise the orientation can be assumed based on the mechanical properties and the design of the rov since the rov centre of buoyancy is above the centre of gravity positive longitudinal and lateral stability is achieved therefore the vehicle is stable on the pitch and roll axis and the orientation of the vehicle can be assumed with certain probability yielding unique solution fig 5 shows the test rig with light beacons attached to it forming different asymmetrical patterns the analysis of the propagation of the light through seawater is a well established area of research duntley 1963 haltrin 1999 the research shows that the red spectre of light is highly attenuated in deep ocean water while the blue light attenuates at much less degree low attenuation property can be shifted towards the green light in coastal areas with yellow solutes which result from the plant and animal materials decomposition therefore the property of blue light penetration in sea water is often used in subsea wireless optical communications field pontbriand et al 2008 caiti et al 2016 for auv visual based docking cowen et al 1997 liu et al 2018 and underwater object detection and tracking lee et al 2012 however the scope of the paper is to use existing industry standard technology thus the lights used for the visual pose estimation are conventional off the shelf bowtech led k 3200 dc underwater lights rated to 3000 m this type of lights is typically used on the tms systems rovs trenchers and other subsea structures for better visibility in a dark or turbid environment therefore the existing tms lights were remounted to form an asymmetrical pattern which is to be recognised by the camera the lights are mounted at the back of the tms using aluminium profiles 3 3 camera the machine vision camera used for testing and trials is a power over ethernet poe ids ueye ui527xcp c gige with sony 1 1 8 cmos imx265 sensor the maximum resolution of the camera is 2056 1542 pixels horizontal and vertical subsampling is used to reduce network overload and to achieve a higher sample rate the camera is enclosed in a subsea housing rated to 2000 m as shown in fig 6 a lensagon bm4518s lens with fixed focus is used the camera housing has a flat port and the lens is not wide angle thus the fov is reduced significantly due to light refraction in water to achieve the widest possible fov the authors suggest using dome ports and wide angle lenses the acquired image is sent via the rov network to a dedicated topside pc where image processing is done the physical network layer consists of an optical fibre enclosed in 2 2 km steel reinforced umbilical connecting the rov cabin with the tms and 400 m of soft tether connecting the tms and the rov the gigabit network uses the tcp ip protocol due to the rov design which requires reversing into the tms while docking the camera is mounted at the stern of the rov and faces backwards 4 autonomous docking this section describes the auto docking methods developed for the experiment image acquisition and processing was implemented on the surface using a dedicated computer the rov control is part of the oceanrings omerdic et al 2013 sivčev et al 2018 rossi et al 2018 software developed within the research group the image processing pc and the rov control pc communicate through the network using the udp protocol 4 1 camera calibration the camera must be calibrated before the beginning of the experiment and although methods to pre calibrate in air exist łuczyński et al 2017 the best practice is to acquire calibration parameters on site the calibration panel used for the calibration process is a 7 10 chessboard pattern printed on an a4 sized pvc board the panel was mounted on the port side of the tms and deployed in water the rov was manually manoeuvred around the tms while images of the panel were acquired from different angles the images were processed and intrinsic camera parameters derived the calibration algorithm assumes a pinhole camera model hartley and zisserman 2004 fig 7 shows images with a chessboard pattern attached to the tms approximately 50 images were taken from different angle and distance combinations acquired lens distortion and intrinsic parameters of the camera are used to correct image distortion thus providing better pose estimation since the emphasis of the paper is on rov docking procedures in the remainder of this paper term docking station ds is used for tms 4 2 image acquisition and pose estimation image acquisition and processing software has been implemented in matlab on a dedicated computer located in the rov control cabin an interface between the camera used during the trials and matlab does not exist thus a mex file based on ueye camera interface in matlab 2016 was created in order to use the c sdk provided by the camera manufacturer the term mex stands for matlab executable the relative position between the rov and the docking station ds is estimated using a single camera and a light marker of a known size the light marker consists of four light beacons mounted on the aluminium frame the frame with the marker is mounted on the ds as shown previously in fig 5 to avoid ambiguity the light beacons were mounted asymmetrically thus creating a unique light marker a similar approach was used in palomeras et al 2018 where active light beacons with known blinking patterns were used in order to avoid the same problem the image processing steps are shown in fig 8 the process starts with image acquisition a distortion is then removed based on known camera intrinsic parameters obtained through the camera calibration b to avoid problems related to light scatter as mentioned in park et al 2009 camera exposure is set to a value where only strong sources of light relative to surroundings can be detected a gaussian filter is used to blur the image in the next step c image blur is used as a low pass filter which averages out the pixel intensities although by adding blur more detail is being removed the position of the brightest objects in the image light beacons is not changed thus the precision is not reduced while robustness is achieved additionally salt and pepper noise could occur during the image acquisition and transmission and affect the binarization of the image in the last step in that case a non linear filter from the group of median filters should be used chan et al 2005 esakkirajan et al 2011 in the last step the image is thresholded and the centres of the four detected disc shaped objects are calculated d the image threshold function returns a binary image from a greyscale image by replacing all values that are above a globally determined threshold with the value 1 while setting all other values to 0 if the image is not blurred small reflections from metal objects or the rov tether can be detected as shown in 8 e ideally the binary image returns four perfectly disc shaped objects with calculated centres of objects matching the centres of the real light beacons based on the known distance between the centres of the four light beacons and known camera parameters a transformation matrix between two planes can be computed providing information about all six degrees of freedom the coordinate systems used in this section are shown in fig 9 the docking station ds reference frame is considered the fixed world frame and it is defined by four light beacons with the xy plane being coplanar with the plane passing through the centres of the light beacons the origin of ds frame can be arbitrary point in that plane once the origin of the frame is chosen the relative distance between the light beacons and the origin is measured as shown in fig 10 the measured distances present a world coordinates of light beacons b ds in practice the origin of ds frame is chosen to align with the camera frame when rov is docked and latched given the world coordinates of light beacons b ds their corresponding image coordinates i b and intrinsic camera parameters k the extrinsic camera parameters are calculated as 1 r cam ds t cam ds e b ds i b k where b ds is an m 3 matrix with at least m 4 coplanar points i b is a corresponding m 3 matrix r cam ds is a 3 d rotation matrix and t cam ds is a 3 d translation vector the transformation of points from the docking station frame to the camera frame therefore is 2 p n cam p n ds r cam ds t cam ds where p n cam is the position vector of point n in the camera frame with coordinates x n cam y n cam z n cam and p n ds is the position vector of point n in the ds frame the vehicle control system is designed to operate in the rov coordinate frame the rov frame is defined as the intersection of lines connecting the centres of diagonally placed thrusters the transformation of any point n from camera frame to rov frame is defined as 3 p n ds p n cam r rov cam t rov cam the position error between the docking point dp and the origin of the rov frame is used to calculate setpoints for position and speed controllers when dp overlaps with the origin of the rov frame the vehicle is considered docked therefore given the docking point dp in the ds frame the position error vector e in the rov frame used as feedback for the vehicle position control loop is calculated as 4 p dp cam p dp ds r cam ds t cam ds e p dp cam r rov cam t rov cam where e x e y e z e 4 3 rov control system setpoints for rov surge sway depth and heading control are fed into oceanrings low level controllers llc oceanrings is a suite of smart technologies for rov control and subsea operations continuously being developed in house at the centre for robotics and intelligent systems cris oceanrings consists of speed depth and heading controllers for subsea navigation and dynamic positioning and various pilot interfaces with visualisation and situation awareness omerdic and toal 2012 toal et al 2012 the system is designed as a 3 layer rov control system omerdic et al 2013 low level controllers with fault tolerant control allocation algorithms are part of the bottom layer capocci et al 2018 an interface between an rov and other supporting platforms is part of the middle layer e g supporting vessels tms image acquisition pc while supervision monitoring and mission planning tools are part of the top layer based on the camera pose estimation control parameters are sent to the rov low level controllers six llcs control the rov each for one degree of freedom dof surge and sway controllers are velocity controllers while heave roll pitch and yaw are position controllers the internal structure of an llc loop is shown in fig 11 modified pid controllers with normalised outputs were used to control the rov the difference between setpoints sps acquired from the image acquisition pc and process variables pvs are used to generate a manipulated variable mv the manipulated variable is applied to drive actuators if a controller is disabled the corresponding mv is set to zero in the case of a time varying sp feed forward ff input is used to improve tracking performance to avoid problems related to integrator saturation vector s p offset is used individual controller outputs are bundled into a vector of normalised forces and moments τ llc since the instruments and equipment onboard are likely to be removed added or replaced during the trials the dynamic properties of the rov change therefore for the optimal controller performance autotuning of the low level controllers is necessary the relay output is used for the llc autotuning with two developed autotuning algorithms the recorded force speed static characteristic is utilised for the velocity controllers tuning while position controllers use self oscillations approach the autotuning algorithms and process are explained in more detail in omerdic et al 2013 4 4 additional considerations 4 4 1 light marker coverage in the instance of full or partial occlusion of one or more light beacons pose estimation is not viable such a situation is shown in fig 12 with the light beacons fully covered by the rov tether and the tms frame such a situation can also occur due to other factors such as fish or curious mammals e g seals dolphins during the docking procedure the rov trajectory is always towards the entrance of the tms thus it always moves towards the area with better optical marker visibility as shown in fig 13 the algorithms have been implemented to filter pose estimation errors and to protect the system in case such errors become too large in case of full coverage of one of the light beacons fig 12 the pose cannot be estimated thus the last known pose is used to align and guide the rov towards the entrance of the ds therefore by increasing the proximity to the ds the probability to acquire an image with all markers rises in the next iteration if the pose cannot be estimated after multiple iterations the rov docking manoeuvre is aborted due to the slow dynamics of the rov and low speeds 0 4 knots the motion between two consecutive iteration is small making the described algorithm suitable for this application partial light beacon coverage causes significant pose error thus every calculated position in step n is compared with the position calculated in step n 1 if an unrealistic change in position between two iterations is detected the algorithm assumes inadequate pose estimation in which case the last known position is used an additional light search algorithm is considered to be implemented for future operations 4 4 2 low angle measurement sensitivity although the discussed pose estimation method provides information on the ds relative orientation and position initial tests showed low sensitivity to angle measurements as shown in fig 14 the relative heading α ds between the ds and the rov maps in the camera projection plane as a perspective distortion of the light marker for relatively small angles α ds 1 0 the perspective distortion in the camera plane is minimal and it is not sufficiently detected due to the camera resolution the error in the estimation of the angle α ds reflects as rov pose estimation error within close range to the docking station these errors can be neglected due to the angle estimation errors the rov depth and heading control based on visual pose estimation can cause docking failures in order to improve autonomous docking performance the data from the ds heading and depth sensors was used to avoid rov heading and depth control 4 4 3 the tms deployment process for static docking to test docking to a static target the tms was deployed to the seabed although static docking is less complicated in terms of control of the vehicle the risk of damaging equipment was significantly higher since the tms and the lars used for the experiment are not designed for such operation deployment of assets is a complicated procedure and many factors should be taken into account waves sea currents and tides act upon the tms during the deployment process the tms used during the trials was not designed for deployment to the seabed thus additional precaution had to be taken the deployment of the tms to the seabed was a challenging task because of the numerous problems that can occur and cause severe damage to the system the main challenges were heaving and rolling motion of the ship transferred through the lars can cause a heavy impact between the tms and the seabed in the last few metres before touchdown thus causing damage the umbilical connecting the lars and the tms should not be loose because its armour can unwind the horizontal movement of the ship must be minimised in order to avoid flipping and damaging the tms operating from a station keeping vessel introduces the risk of umbilical and ship thruster entanglement when deploying assets to the seabed in high sea states different techniques can be used to compensate for heave motion there are active and passive heave compensation systems christ and sr 2013 in active systems the amount of heave is measured with motion sensors depending on the measurement the winch pays out or takes in the umbilical in passive systems the umbilical tension is held constant since the lars used in this case did not have automatic heave compensation the tms was deployed during a window of relatively good weather conditions a few metres of umbilical slack was allowed to compensate for the heaving motion of the ship once the tms was on the seabed attention had to be paid not to release too much umbilical in order to avoid entanglement with the tms and interference with the rov operation the slack also had to be continuously trimmed over time for tidal change the umbilical connecting the lars and the tms is armoured and it is designed for a constant tension load suspended tms if a long part of the umbilical gets loose there is a possibility of armour unwinding which could cause severe damage to the lars tms and the rov therefore static docking operations were limited to shallow waters with a few metres of slack and a relatively short distance between the ship and the tms horizontal movement of the ship should not exceed a few metres to avoid flipping the tms over or dragging it on the seabed to compensate for that the ship was using its station keeping system in the highest precision mode while using station keeping the ship s thrusters are active thus additional caution should be taken to avoid contact between loose umbilical and the thrusters the motion of the ship was within the radius of five metres which allowed us to successfully perform the static docking experiment to deploy the tms on the seabed the tms with the rov inside it was lowered down to 20 m of depth altitude was approximately 10 m the pilot then flew the rov out of the tms which was slowly lowered down while a continuous general visual inspection of the umbilical seabed and the tms was being carried out once the tms was safe on the seabed experiment was ready to proceed 5 results this section presents the results of offshore docking experiments video material of the trials is available on the cris youtube channel cris ul 2019 results indicated that visual pose estimation based autonomous docking of a work class rov and tms in a real world environment is possible both static and dynamic docking experiments were performed during the trials although initial camera pose estimation tests were performed earlier trslic et al 2018 the camera pose estimation for rov control and autonomous docking has never been tested before thus it was necessary to determine the system performance first to validate the performance of the system the rov position was measured simultaneously using two different techniques camera pose estimation was used for the rov control as described in section 4 3 the usbl underwater acoustic positioning system was used for qualitative comparison and monitoring such a system consists of an inertial navigational system ins coupled with a doppler velocity log dvl and usbl transponder all mounted on the rov and a usbl transceiver mounted on the ship the rov position measured with the usbl ins is considered as ground truth with a measured standard deviation between 0 2 and 0 3 m at all times during the experiment in this section the results of both static and dynamic docking are shown and the rov approaching procedure for dynamic docking is explained 5 1 static docking to be able to measure the performance of camera estimated relative distance between the rov and the docking station with the usbl the position of both must be known the ds position was recorded prior to the static docking experiment since only one usbl beacon attached to the vehicle for continuous monitoring was provided during the trials as shown in fig 15 it is assumed that the ds position did not change over time the experiment started with the rov placed 4 5 m in front of the ds entrance the start position was randomly chosen while the light beacons were kept in the camera s fov the maximum rov speed during the experiment was limited to 0 4 knots the docking station was placed on a rocky seabed at a water depth of approximately 25 m fig 16 shows the distance x d and z d and the relative heading α ds between the origin of the rov frame and the docking point dp during the docking experiment the orientation of coordinate frames is shown in fig 9 fig 16 a shows the distance between the rov and docking point in xz plane the red line with triangles represents the camera pose estimation while the blue line with circles represents the pose measured with usbl and ins systems the position standard deviation of the usbl ins system is showed by blue shaded area throughout the experiment the deviation was between 0 22 and 0 25 m a disparity between the estimated and the true position is present at greater distances but as the rov gets closer to the ds the estimated and true position converge the disparity is due to the low angle measurement sensitivity as explained in section 4 4 2 which is reflected as pose estimation error particularly in the x d axis the distance z d and x d plotted against time are shown in b and c estimation of z d shows good performance during the experiment with the estimated position within 0 2 m from the ground truth position at all times due to the partial light beacon coverage discussed in section 4 4 pose estimation errors were present and are shown as spikes in the graphs in case of a not feasible estimated pose or velocity in step n the measurement is neglected and the pose estimated in step n 1 is used for rov control as explained in fig 13 estimated and true relative heading α ds between the rov and the ds is shown in d images e 1 3 show the rov approaching the ds entrance the images were acquired with the camera mounted on the ds at different times during the experiment the rov heading is aligned with the ds heading during the approach the relative heading α ds should be 5 deg before the rov enters the ds e 4 in order to dock successfully once the rov stern entered the ds entirely e 5 there is only one dof between the rov and the ds left since the narrow camera fov does not allow for pose estimation from a closer distance and moving the rov along the z axis in this position is trivial the docking experiment is considered successful multiple successful dockings were performed during the trials fig 17 shows the rov distance from the dp in the xz plane during five different dockings each docking experiment started from a different position and with a different orientation the red rectangle shows a region within 0 2 m from the centre of the dp frame when the centre of the rov coordinate frame is within the region the dock is considered successful as mentioned previously low angle measurement sensitivity at bigger distances from the light marker reflects as a position error particularly in the x d axis fig 18 a shows visual pose estimation error distribution of x d depending on the relative heading α ds and distance from the docking station z d while position error is minimal at the closer distances up to 3 m light green dots and it does not depend on the relative heading at longer distances z d error grows significantly fig 18 b shows folded normal distribution of position error x d err for range of z d between 0 and 1 5 m with corresponding mean and standard deviation value the position error for the range between 1 5 and 3 m is shown in b while the distribution of position error in the range between 3 and 4 5 m is shown in c 5 2 dynamic docking the rov position and relative heading in the dp frame during a dynamic docking experiment are shown in fig 19 the operating depth was approximately 20 m throughout the experiment since one usbl beacon was provided the comparison between camera pose estimation and usbl position was not viable because of the inability to measure the ds position continuously the docking procedure started approximately 2 5 m from the ds entrance e 1 partial light beacon coverage caused an error which was detected and the vehicle continued moving towards the ds entrance the contact between the vehicle and the ds was established e 2 the rov position was aligned with the docking station e 3 and the rov was docked successfully e 4 during the experiment the ds was suspended and exposed to the disturbances previously shown in fig 1 thus the docking approach was changed compared to the static docking due to inertia larger mass vehicles react slowly to thruster output thus it was not feasible to compensate fully for the ds heave motion therefore while static docking was performed with minimal contact between the vehicle and the ds during dynamic docking the contact is inevitable fig 20 shows the ds heave motion during the experiment the peak to peak amplitude was approximately 1 1 m with a period of 8 5 s to dock the vehicle successfully an average ds depth was calculated and used as the setpoint for rov depth there is a limit using this approach for the ds system used during the trials the maximum peak to peak amplitude must be lower than the ds entrance height to avoid tether damage rovs are designed for harsh environments and able to handle mechanical stress but it is crucial not to damage the tether fig 21 shows a series of images during the docking manoeuvre the rov in initial docking position starts with the docking manoeuvre 1 and approaches the ds 2 3 the ds heading has the tendency to change if an external force acts upon it e g contact between the rov and the ds after the contact 4 it is important to maintain reverse thrust on the vehicle the reverse thrust creates momentum around the ds yaw axis and helps with the rov heading alignment 5 6 7 the rov position is thus aligned in 8 9 while the vehicle was still reversing back completely aligned the ds depth changed due to the heave motion and the rov docked in 10 11 12 the presented docking manoeuvre is the worst case docking scenario since the ds used in these experiments is underactuated the ds position and orientation are not controllable while ds pitch and roll are stable the ds has a tendency to yaw since the ds is equipped with an onboard magnetic compass by adding two thrusters it would be possible to control the ds yaw motion and hence its heading if the ds heading is controlled and an active heave compensation lars system is used to compensate for heave motion the dynamic docking practically reverts to a static docking problem 6 conclusion and discussion subsea navigation being used in residential rovs is manual control from the support vessel or from shore based control centres with an existing fleet of vehicles and experienced rov pilots as an in field proven solution the offshore industry is still hugely dependent on manual pilot skill however a transition towards automation in the resident rov field can provide significant advantages and can specifically increase operational weather windows for the marine imr sectors to close this gap while acknowledging the traditional risk adverse nature of the sector and to accelerate uptake in resident rov technology the existing industry hardware fleet with software upgrades should be utilised the autonomy needed for a resident rov should be achieved incrementally through automating specific tasks while the rov pilot role transitions towards supervisory as more and more tasks are automated one of the most critical operations is the docking of the rov at the end of a mission which was the targeted operation for automation in this paper and research a machine vision based docking system was developed around subsea camera pose estimation the system has been developed for standard work class rov systems found throughout the sector deployed from suspended cage type tms the relative position between the rov and the docking station ds was estimated using a single camera and a known light marker pattern the rov speed and position controllers coupled with camera pose estimation provided a strong platform for such operations a multi step pipeline of image acquisition distortion removal exposure estimation gaussian filter blur and image thresholding allows for the centres of each light beacon within the light marker to be estimated with a high level of precision the centre points and distances between each beacon then allow for pose estimation of the rov to the docking station the position error between docking point dp and origin of the rov frame is used to calculate setpoints for position and speed controllers which are fed into rov low level controllers llc when the dp overlaps with the origin of the rov frame the vehicle is considered docked the system has been tested and demonstrated in a real world environment during january 2019 in the north atlantic ocean the reference system used for comparison is commercial state of the art underwater navigation system based on the ixblue phins ins coupled with nortek 500 dvl and teledyne ranger 2 usbl and results have shown to be comparable the accuracy of the developed pose sensor has been shown to be a function of distance from the docking station it has been shown to be capable of accurately measuring the pose distances and angle up to distances of 4 m in close proximity within 1 metre the differences with the ins solution ixblue unit were minimal the full system including the rov automated navigational control was trialled first using a static docking station and the results were within tolerances to allow multiple successful dockings this system was further tested using a dynamic docking station suspended from surface vessel and the results achieved were sufficient to dock multiple times in heave disturbances due to wave motion of 1 1 m to dock the vehicle successfully the maximum peak to peak amplitude was found must be lower than 2 m to avoid damaging the rov tether to the author s knowledge this is the first autonomous docking of an rov system to a dynamic docking station and represents a significant contribution towards robustness and viability of resident rovs operated using satellite communication channels and overcoming issues such as latency the paper presents a visual pose estimation for autonomous docking when in close range up to 8 m from a docking station while visual pose estimation performed well during the trials in a low to medium water turbidity with higher water turbidity an operation range of the optical sensing becomes limited in highly turbid water where a visual pose estimation is unavailable the acoustic pose estimation based on usbl lbl technology should be used since the precision of acoustic based positioning systems is lower than vision based systems the docking station entrance should be modified the extended funnel shaped entrance allows for a larger position error and helps to physically guide the vehicle future developments within the automated docking system are focused on the quality of camera pose estimation and suspended tms motion replication relying on the work of rossi et al 2018 palomeras et al 2018 sivčev et al 2018 the method based on a stereo camera pair using the stereofusion algorithm for real time 3d dense reconstruction and camera tracking will improve position estimation quality and overcome the marker detection problem due to the light beacon occlusion fusing data from the onboard inertial navigation system with vision based navigation will contribute to system robustness and accuracy while a tms motion replication could partially compensate for suspended tms heave motion allowing for faster and smoother docking additional thrusters could be attached to the tms for better yaw motion stability while a wide angle camera lens and a dome port on the camera housing should be used to expand the camera s fov declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this material is based upon works supported by science foundation ireland and industry partners shannon foynes port company and the commissioners of irish lights ireland under the marei research centres awards 12 rc 2302 p2 14 sp 2740 robovaas eu era net co fund award through irish marine institute and eu horizon 2020 research and innovation programme project eumarinerobots under grant agreement 731103 
