index,text
25010,in pursuit of a more robust provenance in the field of species distribution modelling an extensive literature search was undertaken to find the typical default values and the range of values for configuration settings of a large number of the most commonly used statistical algorithms available for constructing species distribution models sdm as implemented in the r script packages such as dismo and biomod2 or other species distribution modelling programs like maxent we found that documentation of sdm algorithm configuration option settings in the sdm literature is overall very uncommon and the justifications for these settings were minimal when present such settings were often the r default values or were the result of trial and error this is potentially concerning since i it detracts from the robustness of the provenance for such sdm studies ii a lack of documentation of configuration option settings in a paper prevents the replication of an experiment which contravenes one of the main tenets of the scientific method iii inappropriate or uninformed configuration option settings are particularly concerning if they represent a poorly understood ecological variable or process and if the algorithm is sensitive to such settings this could result in erroneous and or unrealistic sdms therefore this study sets out to comprehensively test the sensitivity of eight widely used sdm algorithms to variation in configuration options settings maxent artificial neural network ann generalized linear model glm generalized additive model gam multivariate adaptive regression splines mars flexible discriminant analysis fda surface range envelope sre and classification tree analysis cta a process of expert elicitation was used to derive a range of appropriate values with which to test the sensitivity of our algorithms we chose to use species occurrence records for two species koala phascolartos cinereus and thorny devil moloch horridus in order to investigate how algorithm sensitivity depends on the species being modelled results were assessed by comparing the modelled distribution of the control sdm default settings to the modelled distribution from each sensitivity test sdm i e non default configuration settings this was done using the visual and statistical measures of predictive performance available in the biodiversity and climate change virtual laboratory bccvl including the area under the receiver operating characteristic curve the aim of our study was to be able to draw conclusions as to how the sensitivity of sdm algorithms to their configuration option settings may detract from the reliability of sdm results given the often unjustified and unscrutinized use of the default settings and generally infrequent and largely perfunctory attendance to this issue in most of the published sdm literature our results indicate that all of the algorithms tested showed sensitivity to alternative non default values for some of their configuration settings and that often this sensitivity is species dependent therefore we can conclude that the choice of configuration settings in these widely used sdm algorithms can have a large impact on the resulting projected distribution this has important ramifications for decision making and policy outcomes wherever sdms are used to inform species and biodiversity management plans and policy settings this study demonstrates that assigning suitable values for these settings is a very important consideration and as such should always be published along with the model documenting all configuration settings is necessary to increase the scientific robustness transparency and reproducibility of species distribution modelling studies keywords configuration option settings provenance transparency koala thorny devil maxent ann glm gam mars fda sre cta 1 introduction progress made in computational science in recent years has produced concomitant gains and exciting developments in many scientific disciplines many researchers in the computational sciences have increasingly advocated for reproducibility of research which involves the data and computer code used in a published study to be made available to others as a minimum standard when assessing the validity of scientific claims cassey and blackburn 2006 have argued that in order for a scientific study to be acceptable for publication it should be reproducible nrc 2003 they contend that reproducibility is increasingly being requested by journals this standard of reproducibility is based on the theoretically available detailed log of every action taken using computers which underlies every computational experiment if this code were available for scrutiny such transparency in research would surpass the analogous non computational experimental descriptions printed in journals using a human language peng 2011 for scientific fields which inform policy and management decisions and in which there is difficulty in reproducing field experiments and techniques due to the non replicable nature of environmental conditions there is a critical need to track the provenance of derived data products and scientific results provenance which is defined as information about entities activities and people involved in producing a piece of data or thing can be used to form assessments about the quality reliability or trustworthiness w3c working group 2013 of scientific results provenance should cover initial data collection quality assurance analyses modelling and publication reichman et al 2011 it was with a view towards more robust provenance in the field of species distribution modelling sdm that a literature search was undertaken to find the typical default values and an appropriate range of values for configuration option settings in ten algorithms available for constructing species distribution models in the biodiversity and climate change virtual laboratory bccvl hallgren et al 2016 the results of this literature search were summarized in hallgren and mackey 2014 the bccvl www bccvl org au is an online cloud based virtual laboratory which brings together a multitude of datasets sdm algorithms and several different modelling experiment types to create a highly accessible modelling platform which can be used to investigate the impact of climate change and other driving variables on species distributions species traits and several measures of biodiversity in australia and around the world hallgren et al 2016 the sources of the default values of packages in r r core team 2017 which provided the specific implementation of the algorithms used in the bccvl were also investigated hallgren and mackey 2014 found that most sdm studies do not publish sdm configuration option settings and if they do then justifications for these parameter values are minimal and often rely on the r default values or are the result of trial and error consequently we contend that it is advisable to document and publish the rationale for sdm configuration option settings for the sdm algorithms implemented in the r script packages such as dismo hijmans and elith 2013 and biomod2 thuiller et al 2009 or other species distribution modelling programs like maxent phillips et al 2006 if no information for sdm configuration option settings is provided in a publication it makes the sdm experiments unable to be replicated which contravenes one of the main tenets of the scientific method and presents a barrier to good provenance therefore we argue that the explicit documentation of settings is critical for the provenance of a modelling study it is also good scientific practice as it promotes methodological transparency and reproducability both of which are critical to progress in this field greater transparency of model configuration settings may be useful in identifying settings which might be inappropriate or unrealistic which would be particularly concerning if they represent a poorly understood ecological or physical process or if the algorithm was sensitive to such settings thus we also argue that it is important to know how sensitive the modelling algorithm is to its configuration settings without knowing how sensitive an algorithm is to it s configuration settings inappropriately assigned values i e values without reasonable scientific justification could possibly lead to erroneous and or unrealistic sdm results furthermore the use of inappropriate and or uninformed configuration settings which the algorithm is sensitive to could compromise the rigour of the modelling process and the validity of the results within the considerable body of sdm literature there have only been a small number of studies which investigate the sensitivity of sdm algorithms and usually to one aspect of the modelling process e g sensitivity to pseudoabsence selection in seven different sdm barbet massin et al 2012 or sensitivity to input data pirathiban et al 2015 merow et al 2013 provides a user s guide to maxent s model settings background data features regularization and sampling bias and provides broad guidelines on how to set these at the start of the modelling process however it doesn t go into specific detail about the sensitivity of maxent to different values for these settings although they recommend that would be users always explore how different setting choices affect predictions and report these if predictions show substantial differences across settings it is critical to have a strong justification for the specific setting choice merow et al 2013 1067 elith et al 2008 used a large dataset to illustrate the effects of several settings of brt related to model fitting elith et al 2011 provide a valuable discussion on the mechanics of model fitting e g feature selection constraints and regularization in maxent and some exploration of how differences in these settings e g background points and feature types can influence the results however they don t explore the sensitivity of maxent to different settings of these configuration options elith and graham 2009 tested the effect of changing the parameter settings in random forest pertaining to how many variables are randomly selected for evaluation at each split of the tree and how many trees are allowed in the ensemble they also briefly acknowledged the potential impact of changes in parameterization on performance in maxent brt and glm but only provide information on an analysis of the sensitivity to different sampling and weighting of pseudoabsence data in glm and brt anderson and gonzalez 2011 tested the sensitivity of maxent to geographic sampling bias model complexity by varying the linear and quadratic feature types and level of regularization syfert et al 2013 tested the sensitivity maxent sdms to the effects of sampling bias and model complexity via fitting a wide variety of environmental response curves i e functions in maxent convertino et al 2011a b investigated the output variability related to species sample size accuracy of sample resolution of environmental factors and set of predictors while convertino et al 2014 applied a morris method sensitivity analysis to maxent to investigate the importance of a species distributions drivers in space and time including intrinsic and exogenous input factors such as parameter settings beaumont et al 2016 tested a range of sdms regarding the sensitivity to projected climate change scenarios in terms of their likelihood to simulate extreme changes in projected future distribution jarnevicha et al 2017 evaluated combinations of five different algorithms simple and complex generalized linear models multivariate adaptive regression splines maxent boosted regression trees and random forest and background or pseudoabsence methods random minimum convex polygon and continuous and binary kernel density estimator to assess the sensitivity of model outcomes to choices made iturbide et al 2018 tested the sensitivity of glm random forest and mars to pseudo absence sampling in terms of the uncertainty in future projections of their target species derived from ten pseudo absence realizations however to date there has been no systematic investigation of sensitivity to a wide range of configuration option settings for a wide range of sdm algorithms this study reports on research designed to address this gap and expands upon the work started by hallgren et al 2017 which focused on analyzing the sensitivity of boosted regression trees and random forests to configuration settings to eight more species distribution modelling algorithms this study aims to 1 comprehensively test the sensitivity of eight algorithms which are commonly used in species distribution modelling to variation in their configuration option settings 2 draw conclusions as to how the sensitivity of sdm algorithms may impact on the reliability of sdm results given the frequently unjustified nature of the default algorithm settings and the generally low level of awareness of and attendance to this issue in much of the published literature keeping in mind that this reliability is determined by a number of factors including the algorithm chosen the available occurrence data and the objective of the modelling study 3 articulate why setting reasonable and justifiable settings is important for the algorithms tested and which configuration options it is most important to be careful setting given the algorithm s sensitivity to them 2 methodology 2 1 data used occurrence presence datasets for the koala phascolartos cinereus and thorny devil moloch horridus were downloaded from the ala and cleaned the koala dataset used in this study consists of 80 938 records and the thorny devil dataset has 759 records as for hallgren et al 2017 we chose the koala to test algorithm sensitivity to configuration settings due to its well known distribution in this study we chose the thorny devil as a second species to test the algorithm s sensitivity to configuration settings in order to understand how dependent algorithm sensitivity is to the species studied we specifically chose the thorny devil as it has a completely different and non overlapping observed distribution to the koala is far less prevalent and it is in an entirely different class of animal reptilia as opposed to mammalia habitat predictor variables were chosen as input into the species distribution models according to the method used by hallgren et al 2017 for the koala so as to be able to compare our results to this previous study these predictor variables comprised the worldclim current climate hijmans et al 2005 bioclimatic variables 5 max temperature of warmest month 9 mean temperature of driest quarter 10 mean temperature of warmest quarter 12 annual precipitation 14 precipitation of driest month and 17 precipitation of driest quarter all of these were available in the bccvl for the thorny devil after initially modelling its distribution using all 19 worldclim variables we chose predictor variables based on the variable importance plots and response curves derived from the bccvl sdm output for this species this was done due to the paucity of literature on ecophysiology and climatic drivers specific to the thorny devil this approach is similar to that of phillips et al 2006 who advocate including all reasonable predictors in the model maxent and letting the algorithm decide which ones are important merow et al 2013 twelve variables were found to be important across the range of algorithms and hence used in our sensitivity tests these were the worldclim bioclimatic variables 1 annual mean temperature 3 isothermality 4 temperature seasonality 9 mean temperature of the driest quarter 10 mean temperature of the warmest quarter 11 mean temperature of the coldest quarter 12 annual precipitation 13 precipitation of the wettest month 14 precipitation of the driest month 16 precipitation of the wettest quarter 17 precipitation of the driest quarter 18 precipitation of the warmest quarter and 19 precipitation of the coldest quarter 2 2 algorithms tested since different statistical models of vastly different forms may fit the same process equally well with each providing a different perspective or angle onto the same phenomenon it is not possible to know ahead of time for a particular species which shape or template for a sdm will fit well for this reason we control for this uncertainty by investigating more than one sdm algorithm for our modelled species hallgren et al 2017 examined two machine learning algorithms for sdm franklin 2010 which are both extensions of classification trees ct breiman et al 1984 boosted regression trees brt breiman 2001 and random forests rf breiman 1999 2001 this study examines eight more algorithms commonly used for species distribution models all of which are implemented in the bccvl as listed in table 1 maxent phillips et al 2006 phillips and dudík 2008 artificial neural networks ann hopfield 1982 lek and guégan 1999 generalized linear model glm mccullagh and nelder 1989 guisan et al 2002 generalized additive model gam guisan et al 2002 flexible discriminant analysis fda hastie et al 1994 trevor et al 1994 surface range envelope sre busby 1991 jiguet et al 2011 multivariate adaptive regression splines mars friedman 1991 and classification tree analysis cta breiman 1984 along with the two algorithms investigated in hallgren et al 2017 these eight algorithms were found to be widely used in the sdm literature maxent maximum entropy modelling is a machine learning algorithm that uses presence data together with background locations maxent predicts species occurrences by finding the environmental profiles that lead to predictions that best differentiates presence from background while taking into account the limits of the environmental variables of known locations maxent was tested for sensitivity to 12 configurable options in the bccvl artificial neural networks refers to a large group of models that are inspired by biological neural networks in particular the brain which consists of extremely large interconnected networks of neurons to process information artificial neural networks consist of a large number of nodes and connections which are typically organised in layers with an input layer in which the data is fed into the model a number of hidden layers and the output layer which represents the result of the model the most commonly used anns in ecology are single hidden layer feed forward artificial neural networks that are trained by back propagation ann glm gam and mars use both presence and absence or pseudoabsence data as well as environmental data and can handle both continuous and categorical predictors ann as implemented in the bccvl was tested for sensitivity to 2 configurable options generalized linear models glm are an extension of simple linear regression models which predict the response variable as a weighted linear function of multiple predictor variables unlike simple linear regression glms are able to deal with binary data such as presence absence data as implemented in the bccvl glms find the weights that make the species absence presence data most likely across the range of the environmental variables maximum likelihood in the bccvl linear or quadratic effects are available glm was tested for sensitivity to 4 configurable options generalized additive models gams are an extension of glms in such a way that predictor variables can be modeled non parametrically instead of being restricted like glm to solely linear and polynomial terms for predictors therefore gams tend to provide a close fit to the data which can make them less transferrable but is useful when the relationship between the variables are expected to be of a more complex form not easily fitted by standard sdms or where there is no a priori reason for using a particular model gam was tested for sensitivity to 7 configurable options multivariate adaptive regression splines mars is a non parametric regression method that builds a decision tree with each branch comprising a linear regression model it does this by partitioning the data and runs a linear regression model on each different partition the mars algorithm is an extension of linear models that makes no assumptions about the form of the relationship between the response variable and the predictor variables while glms and gams assume that the coefficients of the predictor variables are constant across all values of a predictor the mars algorithm specifically takes into account that this is often not the case but the mars algorithm has similarities to machine learning models such as tree based models because it achieves good fit by tuning predictive performance via cross validation mars was tested for sensitivity to 7 configurable options flexible discriminant analysis fda is a classification model based on a mixture of linear regression models which uses optimal scoring to transform the weights in the regression for better linear separation and multiple adaptive regression splines to generate the discriminant surface fda employs both presence and absence or pseudoabsence data surface range envelope sre is an envelope style method similar to bioclim nix 1986 it uses presence only data and the environmental conditions of locations of occurrence data to profile the environments where a species have been found the envelope is defined by the minimum and maximum values of the environmental variables for all occurrences any location with environmental conditions that falls within this envelope is included in the potential range for a species to avoid the overpredictive effect of outliers the envelope can be reduced to have limits at specified percentiles or standard deviations from the mean both fda and sre were tested for sensitivity to 3 configurable options classification tree analysis cta is a tree based model these models partition species data into increasingly homogeneous groups of presence or absence based on a sequence of decision rules branches to define their relationship to a set of environmental variables the predictor variables each path through the tree following different branches arrives at a different environmental profile and probability of species presence each branch is defined by different ranges of one environmental predictor the single classification tree is the most basic form of a decision tree model as the name suggests classification trees resemble a tree and consist of three different types of nodes connected by directed edges branches root nodes internal nodes and leaf nodes cta was tested for sensitivity to 6 configurable options within the bccvl for each of the algorithms tested different configuration options needed a different strategy for choosing values depending on their type for instance configuration option settings involving positive real and natural numbers were both better assessed at increasing orders of magnitude rather than on some linear scale some settings were categorical e g whether to prune mars is dichotomous some settings manage computational overheads and are therefore only considered if the model provides poor fit similarly to hallgren et al 2017 we used australia wide sdms so as to be able compare results in the case of the koala sensitivity tests with the published literature also in accordance with hallgren et al 2017 the experimental design for our sensitivity analyses is relatively simple control models of koala and thorny devil distribution were built using the default configuration option settings for each of the eight algorithms used in this study then the algorithms were tested for their sensitivity to different settings of each of their configuration options that are configurable within the bccvl the method of choosing combinations of the configuration option settings for the sensitivity testing was the one at a time or oat method hamby 1994 this involved changing one configuration option setting at a time for a particular algorithm keeping all other configuration options for that algorithm at the default values this method was chosen as it allows for the pinpointing of sensitivity to individual configuration options for each algorithm so that our results can be used as a guide as to which configuration options require the most care when setting only species occurrence records presence points for both the koala and thorny devil were used in our sensitivity tests as no true absence data was available for our study thus pseudo absences were calculated in the bccvl using the random setting for this configuration option which is the default in the bccvl all sdm experiments were implemented with ecologically relevant domain constraints to encompass the observed distribution of koala and thorny devil a convex hull around the eastern southeastern and southern distribution of koalas and a convex hull surrounding the observed distribution of thorny devil in the arid centre and west of the continent this is to constrain the placement of pseudo absence points generated by the bccvl a process of expert elicitation was used to derive a range of appropriate values with which to test the sensitivity of our algorithms alkhairy et al 2017 the same expert as for the hallgren et al 2017 study for each algorithm the first step in preparing elicitation low choy et al 2009 ecology was to identify the configurable option settings available through bccvl it was necessary to cross reference the arguments required of the embedded call from the biomod package and the underlying r algorithms in multiple packages as noted in the bccvl provenance www bccvl org au this process was straightforward for several algorithms where the models fitting and r settings are all clearly documented in the same place glm gam mars cta ann and fda hastie et al 2009 documentation for maxent was dispersed in multiple publications as detailed in alkhairy et al 2019 unpublished manuscript elicitation then proceeded following a similar process used for eliciting variable selection pirathiban et al 2015 by prioritizing the settings for inclusion in the sensitivity analysis based on the expert s experience with using these algorithms in contexts involving sdm or otherwise and with sdms in particular finally in the third stage the expert was asked for numerical estimates by nominating a sensible range of values for each settings again based on their experience these values were chosen to detect major shifts in the mapped predictions and performance of sdms the sensitivity analysis carried out in our study reflects a common range finding situation with use of the virtual laboratory where the modeller is initially exploring the wide range of possible settings values table 1 lists each algorithm and the configuration options that were tested in the bccvl as well as the value of the test settings a brief description of the configuration options tested in this study for each of these algorithms is given in appendix 1 to evaluate the difference between the control sdms i e those using default configuration options settings and altered settings sdms we have visually assessed the results by comparing the geospatial distribution of the control sdm and the altered settings sdm we have also noted the differences between the control model and altered settings models in terms of how changing the configuration settings affects the area under the receiver operating characteristic roc curve auc and the accuracy and positive predictive value ppv statistics all of which are calculated within the bccvl when running a species distribution model table 2 the roc plot is a graph with the false positive rate 1 specificity on the x axis and the true positive rate sensitivity on the y axis plotted across the range of threshold probability values where the area under the curve auc statistic is calculated by summing the area under the roc curve area under the receiver operator curve auc is a threshold independent measure of predictive accuracy based on the ranking of locations it is one of the most popular metric of model evaluation and especially in the maxent literature and can be interpreted as the probability that a randomly chosen presence location is ranked higher than a randomly chosen background point merow et al 2013 jarnevich 2015 the auc can range from 0 to 1 although the practical range is from 0 5 to 1 0 since an auc value of 0 5 represents a model that is no better than random jarnevich 2015 the auc represents a value that is used to evaluate the resulting sdm and to compare the performance among different algorithms although essentially we are using the auc and the accuracy and ppv statistic as a diagnostic tool to assess an algorithm s sensitivity to alternate configuration settings roc curves and the auc statistic have been widely used in many fields such as medicine and psychology for many decades and more recently in other areas such as machine learning data mining and ecological modelling phillips et al 2006 santana et al 2008 a few authors have advocated calculating multiple evaluation statistics to assess model performance rather than relying on a single statistic and we argue that the same approach should be used when evaluating the sensitivity of an algorithm since each metric quantifies a difference aspect of predictive performance or sensitivity lobo et al 2008 jarnevich et al 2015 elith and graham 2009 the ppv is the proportion of correctly predicted presences and the accuracy statistic is the proportion of correctly predicted cases these metrics were chosen among a range of statistical outputs generated by the bccvl mainly for their simplicity and ease of interpretation details of these evaluation metrics are in appendix 2 3 results and discussion 3 1 sensitivity shown by maxent to configuration option settings when modelling koala distribution the maxent algorithm showed minor but noticeable sensitivity to the weighted response weights wrw setting throughout the entire east coast and more so when settings were lower in value compared to the bccvl default at higher wrw settings the auc value was marginally higher 0 95 compared to 0 94 when wrw was set to 0 25 fig 1 a the modelled probability of koala occurrence increased throughout the western extent of its range in new south wales nsw and marginally in parts of victoria vic but decreased visibly throughout its range when wrw was set to 0 33 more marginal decreases in probability of occurrence resulted from values of 0 66 and 0 75 see table 1 for all test settings maxent also showed sensitivity to the maximum number of iterations option when set to lower than default values of 10 and 100 fig 1 a showing slight decreases in the probability of koala occurrence in the bccvl every feature threshold option or feature type is set to yes by default sensitivity was tested by selecting no for linear first then adding a no selection for quadratic keeping linear as no then progressively adding the no selection for product threshold and hinge options keeping all previous options checked as no decreased probability of occurrence resulted when the linear option was set to no and when both the linear and quadratic options were both set to no fig 1 a minor changes in distribution resulted from the combined linear quadratic and threshold options being set to no and slightly higher probability of occurrence but negligible changes in extent resulted from the combination of the product feature threshold being set to 40 the quadratic feature threshold being set to 5 and the hinge feature threshold being set to 8 table 1 the changes in koala distribution seen as a result of these sensitivity tests are noticeable at regional levels in terms of probability of occurrence although the overall spatial pattern of koala distribution along the southern and eastern vic and eastern nsw does not change noticeably this result corroborates syfert et al 2013 who found that the choice of feature type had negligible effects on predictive performance of their target species at continental scale in terms of the regularization options for maxent the threshold categorical linear quadratic product and hinge feature regularization options showed very minor sensitivity to altered settings see for example the result for threshold feature regularization in fig 1 anderson and gonzalez 2011 found that their sdm results varied greatly according to the level of regularization which indicates that stronger sensitivity was shown to this configuration option compared to that indicated by our study the threshold feature regularization option shows changes in distribution that are discernable at regional levels in terms of changes to the probability of occurrence with only very minor changes in range alternative values for the configuration settings only produced very minor changes to the auc value and the ppv and accuracy statistics the accuracy statistic shows more sensitivity than the other statistics to changes in the configuration settings with the most sensitivity being shown to the threshold feature regularization the linear quadratic product feature regularization and the combination of the product quadratic and hinge feature threshold being set to 40 5 and 8 respectively table 2 it is clear that there were differences in the sensitivity to configuration settings that are attributable to the different species being modelled the thorny devil sensitivity testing of maxent revealed only very minor changes in distribution with lower values of the wrw setting fig a1 in appendix 3 having the prevalence linear and quadratic threshold and linear quadratic and threshold settings set to no also produced minor but still noticeable changes in distribution with the latter affecting the smoothness of the distribution much more markedly in the thorny devil tests compared to the koala tests moreover the thorny devil tests indicate some sensitivity when the threshold feature regularization is altered away from the control setting unlike the case for the koala tests but minimal to no discernible sensitivity to changes in the value of the categorical and hinge feature regularization nor when the linear quadratic and product feature regularization options were changed together away from the default value as was the case for the koala tests of all the evaluation metrics the auc showed the least sensitivity to alternative configuration settings showing minimal sensitivity to the threshold feature regularization linear quadratic linear quadratic threshold and prevalence options in contrast the ppv and accuracy statistics showed some and often much greater sensitivity to all configuration options table a1 in appendix 3 these results contrast with convertino et al 2014 whose sensitivity analysis results indicate that the beta hinge feature parameter tended to score highly in terms of factor importance and beta categorical the maximum number of iterations beta threshold l2lq threshold convergence threshold hinge threshold and beta multiplier settings scored lower in order of importance according to the average habitat suitability result in table 2 of convertino et al 2014 3 2 sensitivity shown by ann to configuration option settings the ann algorithm was tested for sensitivity to non default values of wrw and the number of cross validations to find best size and decay parameters nbcv high sensitivity was seen to non default values for both configuration options fig 1 b in the case of wrw only values higher than the control 0 5 resulted in altered distributions there was both a moderately expanded range inland from southeast qld to southeast sa but a smaller range in northern qld and a higher probability of occurrence within that range for wrw values of 0 66 and 0 75 however with values of 0 9 and above the was an expanded range all over especially in eastern qld for nbcv a value of 10 resulted in changes in the probability of occurrence in the southern parts of the range but a contracted range in northern qld for a value of 20 there was a slight expansion of range except in southeast qld which encompassed areas of slightly lower probability of occurrence ann showed minor sensitivity to altered values for the wrw and the nbcv settings in terms of the modelled distribution and this was reflected in the evaluation statistics for the sensitivity tests which showed mostly minor changes to the auc ppv and accuracy values table 2 the thorny devil sensitivity testing using ann produced results that indicated a noticeable increase in distribution as wrw increased changes only up to 0 66 were able to be determined for the thorny devil tests the modelled distribution of thorny devil noticeably decreased as nbcv increased from 10 to 20 whereas in the koala sensitivity tests the modelled distribution noticeably increased as nbcv increased fig a1 appendix 3 in addition the thorny devil sensitivity tests of ann showed a noticeably larger impact on the evaluation metrics with the auc ppv and accuracy all showing higher sensitivity to changes in the configuration settings compared to the koala sensitivity tests table a1 appendix 3 this indicates that the sensitivity of ann to configuration options differs according to the species modelled 3 3 sensitivity shown by glm to configuration option settings the glm algorithm was tested for sensitivity to non default values of the wrw type interaction level and test configuration options high sensitivity was seen in the modelled distribution maps to non default values for the wrw option with greater sensitivity the higher the value for this setting fig 1 c considerable sensitivity was also shown to other settings for the type configuration option with the polynomial setting resulting in a more westward distribution of the koala population fig 1 c glm showed strong sensitivity to the interaction level with greater values resulting in expanded koala populations in some areas northern nsw vic and contracted population lower occurrence probability in other areas southern nsw along the northern qld coast parts of eastern vic fig 1 c no noticeable sensitivity was shown to alternative settings of the test configuration option altered values for the type and the interaction level settings produced minor increases in the auc and accuracy values and slightly larger increases in the ppv values table 2 indicating generally low sensitivity of glm according to these evaluation metrics for the koala sensitivity tests the thorny devil tests indicate that glm shows more sensitivity to changes in configuration settings than is the case in the koala tests this is true for the wrw type particularly for the simple type setting interaction level and test settings with the bic setting for the test configuration option showing noticeably different distribution compared to the control aic setting fig a1 the evaluation statistics for the thorny devil sensitivity tests indicates that gam is sensitive to all four configuration options tested according to the auc and accuracy statistic both of which for example decrease with increasing wrw values the ppv metric indicates sensitivity only to the type and interaction level configuration options table a1 the metrics we investigated corroborate the modelled distribution results in showing that glm shows more sensitivity when tested with the thorny devil dataset than with the koala dataset 3 4 sensitivity shown by gam to configuration option settings the gam algorithm was tested for sensitivity to non default values of numerous configuration options the change in koala distribution increased in terms of probability of occurrence when the value of the wrw was increased to 0 6 from the control value of 0 5 values of 0 9 and 0 99 resulted in not only increases in the probability of occurrence but also a larger extent of koala distribution inland from the observed distribution in qld nsw vic and south australia sa fig 1 d as values of the interaction level setting increased from the control to 1 and 2 there were areas within the koala distribution which showed lower probability of occurrence and at a value of 2 there is a contraction of koala range in southeast nsw and eastern vic fig 1 d changes in the value of the epsilon setting produced only very minute almost imperceptible changes in koala distribution there were no discernible changes in koala distribution for test values of irls reg from 0 1 to 0 9 max mle iterations from 50 to 200 convergence tolerance from 1 e 5 to 1 e 6 and number of halvings from 5 to 30 only alternative higher than default values for the wrw configuration option resulted in a very small increase in the ppv and accuracy statistic and the auc indicated no sensitivity to any alternative configuration values for the koala sensitivity tests table 2 for the thorny devil sensitivity tests minimal but perhaps locally significant sensitivity was shown to increases in wrw up to 0 6 sensitivity to higher values was indeterminable some sensitivity was shown to interaction level from 1 to 2 particularly in northwest wa but noticeably more sensitivity was shown by gam to increasing values of irls reg and epsilon in the thorny devil sensitivity tests compared to that shown in the koala tests the thorny devil sensitivity tests resulted in quite minimal but still noticeable sensitivity of gam to increases in the value of max mle iterations convergence tolerance and number of halvings fig a1 the evaluation statistics for the thorny devil tests indicate gam is sensitive to altered values for all of the configuration settings tested according to the auc and ppv statistic the latter showing more sensitivity the accuracy statistic showed less sensitivity both in terms of the number of configuration options and the magnitude of sensitivity shown table a1 appendix 3 certainly these statistics reveal that gam is more sensitive to alternative configuration settings when modelling the distribution of the thorny devil compared to the distribution of the koala 3 5 sensitivity shown by mars to configuration option settings mars sensitivity testing showed a higher probability of occurrence and expanded range with higher values of wrw than the default at 0 6 there is higher probability of occurrence within the range produced by the default and patches of higher probability of occurrence outside that range at 0 9 and above there is a much expanded range with moderate probability of occurrence fig 1 e moderate sensitivity was shown by mars to non default values of nk maximum number of terms there was a decreased probability of occurrence at the western edge of the range and an expanded range in northern qld when nk was set to 5 and 10 fig 1 e and minimal changes resulting from settings of 15 20 and 100 minimal but still noticeable sensitivity was seen to the thresh option when it was set to 0 01 and 0 005 however the eastern and southern population contracted and northern population expended with higher values of 0 05 values for penalty which were lower than the default elicited some sensitivity when set to 2 5 there is a slightly expanded range in northeast nsw and slightly less in the high country in nsw vic fig 1 e for extremely high values for resampling i e when set to 100 the koala distribution shows a slightly altered range in nsw and a slightly expanded range in qld fig 1 e no noticeable sensitivity was shown to the prune setting altered values for the nk and the thresh settings produced decreased auc ppv and accuracy values table 2 increased values of the wrw option caused decreased values for all these metrics overall the ppv statistic was the most sensitive to changes in the configuration options tested and auc the least sensitive metric in terms of the number of options that showed sensitivity and the magnitude of the sensitivity shown the thorny devil tests indicate that mars shows more sensitivity to changes in some configuration settings than the koala tests there is considerable sensitivity shown to altered values of the nk option with low values nk 5 increasing the area which has any probability of distribution of thorny devil markedly and with high values nk 100 reducing the extent of modelled thorny devil occurrence there is also noticeable sensitivity to penalty setting with an increasing extent of occurrence as values increase which is not the case for the koala high sensitivity was shown by mars to the thresh option with increasing extent of occurrence with higher values similarly to the koala tests but the sensitivity was higher in the thorny devil tests as with the koala tests mars showed high sensitivity and a larger extent of occurrence to increasing values of wrw and more sensitivity to increasing values of resampling than the koala tests indicate fig a1 appendix 3 the evaluation statistics for the thorny devil sensitivity tests indicate that mars shows more sensitivity to configuration settings when simulating the thorny devil compared to the results of the koala sensitivity tests with more configuration options showing a greater magnitude of sensitivity to altered settings and in the case of mars it is the ppv and auc statistics which indicate greater sensitivity compared to the accuracy statistic table 1 appendix 3 the nk and thresh options showed the greatest sensitivity across all three metrics in the thorny devil tests 3 6 sensitivity shown by fda to configuration option settings for the koala sensitivity testing of the fda algorithm very high sensitivity was seen to higher than default values for wrw with both higher probability of occurrence and a much larger extent of distribution above wrw values of 0 6 or higher fig 1 f fda showed moderate sensitivity to alternative values of the method configuration option in terms of the probability of occurrence compared to the predicted range resulting from the default setting the polyridge setting for the method option resulted in higher probability of occurrence and for the bruto setting they resulted in lower probabilities of occurrence fig 1 f negligible sensitivity was seen for alternative values of the resampling option at the continental scale altered values for the wrw and the method settings produced both increased and decreased auc ppv and accuracy values table 2 the ppv statistic showed higher sensitivity to these and was also quite sensitive to the resampling configuration option the thorny devil sensitivity tests revealed high sensitivity in the modelled distributions to changes in the value of wrw resampling and method configuration options with the latter two showing more sensitivity in the thorny devil tests compared to the koala tests fig a1 the evaluation statistics also revealed high sensitivity to changes in the value of the three configuration options and showed higher sensitivity than the evaluation statistics from the koala sensitivity tests particularly the resampling and method options table a1 3 7 sensitivity shown by sre to configuration option settings the sre algorithm was tested for sensitivity to alternative values of the wrw resampling and quantile configuration options high sensitivity was seen to non default values for the quantile option with an expanded koala range seen at a value of 0 01 and an increasingly contracted range seen for values of 0 05 and 0 1 fig 1 g no noticeable sensitivity was shown to the wrw and resampling settings these results were reflected in the evaluation statistics with only the quantile option exhibiting any sensitivity increasing quantile values resulted in decreasing values of auc and accuracy but higher values of ppv table 2 there was a similar decrease in the extent of modelled thorny devil distribution with increasing values of the quantile configuration setting as for the koala fig a1 no change in distribution was seen with increasing values of resampling or wrw the quantile setting showed a similar pattern of sensitivity in the evaluation statistics to that seen in the koala sensitivity tests however the thorny devil tests also indicated sensitivity to the wrw setting in terms of altered auc ppv and accuracy values and also sensitivity to the resampling setting in terms of altered auc values these results indicate the sre algorithm shows more sensitivity when tested with the thorny devil dataset compared to the koala dataset table a1 3 8 sensitivity shown by cta to configuration option settings the cta algorithm s modelled distribution showed high sensitivity to the wrw option fig 1 h with higher values resulting in an expanded koala range and higher probability of occurrence in many areas within that range high sensitivity was also shown to changes in the setting of the complexity parameter option showing a much increased probability of koala occurrence in western vic when the value is 0 025 and an increase in range and probability of occurrence again when the value is 0 05 fig 1 h compared with the default value of 0 01 cta was also moderately sensitive to different settings of the maximum depth option particularly when the value is set to 40 i e higher than the default fig 1 h the cta algorithm showed minor sensitivity to the minimum bucket setting there was a minor decrease in the probability of occurrence in western victoria when minimum bucket was set to 50 but no other alternative settings produced different distributions from the control 20 no noticeable sensitivity was seen to the cross validation folds and minimum split configuration options all evaluation statistics showed sensitivity to the wrw complexity parameter and minimum bucket settings table 2 the ppv statistic showed more sensitivity to alternative configuration settings than either the auc or accuracy statistic particularly the wrw setting the thorny devil tests indicate that cta shows more sensitivity to changes in configuration settings than is the case in the koala tests this is true for wrw cross validation folds minimum bucket minimum split and maximum depth configuration options the thorny devil tests indicate high sensitivity of cta to the complexity parameter as with the koala tests fig a1 the cta algorithm also showed more sensitivity in the thorny devil sensitivity tests than the koala tests in terms of the impact of the alternative configuration settings on the evaluation statistics in these tests the auc exhibited greater sensitivity than either the ppv statistic in terms of the number of options that showed sensitivity or the accuracy statistic in terms of the magnitude of the sensitivity displayed by most of the configuration options table a1 4 summary and conclusions our study aimed to comprehensively test the sensitivity of eight algorithms that are widely used in species distribution modelling to variation in their configuration settings in addition to the two algorithms which were tested for sensitivity to configuration settings in terms of differences in koala distribution in hallgren et al 2017 there are now eight more sdm algorithms which have been comprehensively tested and have been shown to exhibit sensitivity in terms of how differently configured algorithms can result in different and often remarkably different modelled distributions and evaluation metrics for two species the koala and the thorny devil our results indicate that for many of the algorithm tested in this study not all configuration options show the same sensitivity as might be expected of the eight algorithms tested the most flexible ones mars cta fda gam sre showed greater sensitivity to more of their alternative configuration settings which were tested in this study in terms of changes in the modelled probability of occurrence of the species koala or thorny devil or the range in the species distribution this is understandable given that many of these settings govern the flexibility in terms of how closely the model fits the data hastie et al 2009 maxent and glm have fewer configuration settings but also showed less sensitivity to their settings this can be explained since these approaches are more model based austin 2002 so that rather than having many small decisions regarding model flexibility there are fewer major decisions on model complexity these can be more strongly related to ecological theory e g austin 2002 low choy and huijbers 2017 meaning algorithm sensitivity can be under the control of the modeller with some ecological knowledge our research shows that for many of the configuration options investigated particularly those for mars cta sre ann and fda the choice of settings for these options can impact the resulting modelled distribution markedly as well as the auc ppv and accuracy statistics it is likely that other evaluation statistics would also show some sensitivity but this needs empirically verifying hence appropriate care must be taken to choose sensible and justifiable values for these algorithms our research also indicates that algorithm sensitivity to configuration settings differs according to the species modelled and that this differential sensitivity is greater in some algorithms than others algorithm sensitivity is also somewhat dependent on type of model output distribution map evaluation metric used to diagnose this sensitivity some evaluation statistics reveal more or less sensitivity of the algorithm to alternative configuration settings our finding of the differential sensitivity of the different evaluation statistics to alternative sdm configuration settings and this justifies our use of more than one them in this study to evaluate the sensitivity of the algorithms this aspect of our results supports a growing chorus which indicates that it is not wise to rely on the auc as a measure of model skill e g townsend peterson et al 2008 lobo et al 2008 one of the aims of our study was to draw conclusions as to how the sensitivity of sdm algorithms may impact on the reliability of sdm results given the frequently unjustified nature of the default algorithm settings and the generally low level of awareness of and attendance to this issue in much of the published literature keeping in mind that this reliability is determined by a number of factors including the algorithm chosen the available occurrence data and the objective of the modelling study with respect to an algorithm s configuration we suggest that sdm studies that have not carefully chosen configuration settings may yield results that are inaccurate or inappropriate to the desired ecological scale to the extent that the algorithm is sensitive to those settings at the very least this source of uncertainty should be acknowledged in published sdm studies another aim of this study was to define which configuration options need setting thoughtfully given an algorithm s sensitivity to them in terms of how the projected distribution was affected we found that all algorithms tested were sensitive to sampling weights particularly the wrw configuration option except sre this sensitivity confirms that the samples provided are not exhaustive of the complex australian environment and sampling effort appears to have varied with environment this is important since it signals to bccvl users that they need to check the data they are putting into sdms in terms of the sampling weights which means changing the wtw setting for the algorithms are very sensitive to this our results suggest that for maxent care must also be taken when configuring the linear and quadratic settings the threshold feature regularization and the maximum number of iterations due to the sensitivity of the modelled distribution to these configuration options for ann care should be taken when setting the nbcv option for glm the configuration options to set most carefully are the type and test settings and for gam care must be taken when setting the interaction level the most sensitive configuration options for the mars algorithm that need to be set carefully are the resampling prune nk penalty and thresh for fda the resampling and method configuration options require careful setting for sre the quantile setting is the most sensitive and therefore needs most care when setting and for cta care should be taken when setting the minimum bucket and the maximum depth configuration options we believe our results demonstrate unequivocally the importance of the configuration settings of algorithms used for species distribution modelling given the sensitivity to such settings furthermore the documentation of these settings is necessary to increase the scientific robustness transparency and reproducibility of species distribution modelling studies as noted in hastie et al 2009 while only a brief description of the configuration options tested in this study is given in appendix 1 in light of our results we believe that it is necessary to have a good understanding of an algorithms configuration options in order to be able to justify the settings used and to understand the impact each configuration setting has on the model and resulting species distribution and evaluation statistics we note that all sensitivities are relative to the control model chosen and are also dependent upon the test values chosen which is why great care was taken to choose test values based on expert knowledge of the algorithms and which were numerically and statistically appropriate for the algorithm tested nevertheless for the configuration option values to which certain algorithms did not show much sensitivity to there remains the possibility that sensitivity could potentially be shown to a broader range of test values lastly while the sensitivity we have documented to the algorithms we have investigated in this study may not hold for other locations or species we have demonstrated that our methodology can be used to effectively and efficiently investigate the sensitivity of sdm algorithms to their configuration settings for any sdm study acknowledgments the bccvl is supported by the australian research data commons ardc the ardc is supported by the australian government through the national collaborative research infrastructure strategy ncris griffith university provided the research funding to conduct this study no co authors have any conflicts of interests to declare appendix 1 configuration option descriptions for algorithms used in the sensitivity analysis testing descriptions obtained from literature where cited or the bccvl org au algorithm configuration options description of configuration options classification tree analysis cta weight response weights wrw allows users to give more or less weight to particular observations if the default setting is used i e null each observation presence or absence has the same weight regardless of the number of presences and absences if the value is set below 0 5 absences are given more weight whereas a value above 0 5 gives more weight to presences resampling the number of permutations to estimate the importance of each variable if a value larger than 0 is used the algorithm will produce an object called variableimportance full csv high values of which mean that the predictor variable has a high importance whereas values close to 0 indicate that the predictor variable has no importance method the method to be used to fit the decision tree classification or regression for categorical data such as the presence absence of species the class method should be used which is the default for this option cross validation folds the function of cross validation folds that should be created for training cv 1 and testing 1 the default number of cross validations is 10 which means that the datasets is divided into 10 subsets using 9 subsets as training data to calibrate the model and 1 subset as test data this process is repeated for all possible combinations of training and test subsets a total of 10 times and then the error rates can be used to prune the tree using the standard 1 se rule which states that the tree with the most nodes should be selected as long as the corresponding cross validation error is within one standard deviation of the minimum cross validation error the corresponding complexity parameter value can then be specified to generate an optimally pruned tree minimum bucket the minimum number of observation that needs to be present in any terminal node minimum split the minimum number of observations that must exist in a node for a split to be attempted this is a good way to limit the growing of the tree when a node contains too few observations further splitting will result in overfitting the optimum minimum split depends on the number of observations and predictor variables in a dataset with a limited number of observations and predictor variables stopping early will result in no tree at all with a lot of observations a cta can stop early and still obtain a large enough decision tree the more predictor variables in a dataset there is a larger possibility of having some accidental relationship between one of the variables and the response so with a lot of variables it is advisable to stop earlier complexity parameter the complexity measure is a combination of the size of a tree and the ability of the tree to separate the classes of the response variable if the next best split in growing a tree does not reduce the tree s overall complexity by the value of this option the algorithm will terminate the growing process a complexity parameter value of 1 will always result in a tree with no splits while a value of 0 will build a tree with the maximum possible complexity which can potentially be very complex maximum depth the maximum number of splits of the tree this is a limit to stop further splitting of nodes when the specified tree depth has been reached during the building of the initial decision tree random seed random seed is a number which is used to generate a set of pseudorandom numbers by some algorithms generalized linear model glm wrw as for cta resampling as for cta type the type of regression model to use this can be either a linear option simple a quadratic or a polynomial model the default for this option is quadratic which creates a curved model with one hump i e a u or inverted u shape interaction level the number of interactions between predictor variables that need to be considered a value of 1 will fit an additive model a value of 2 will result in a model with 2 way interactions etc test the biomod2 package uses an automatic stepwise selection procedure which means that the model is built by sequentially adding or dropping predictor variables and testing whether they improve the fit of the model predictors that do not improve the fit of the model will be dropped the test option indicates which criteria should be used to test the fit of the model the akaike information criterion aic which is the default or the bayesian information criteria bic by selecting none the stepwise procedure will be switched off resulting in a model in which all predictor variables are retained family the description of the error distribution of the response variable and the link function used in the model for binary data such as presence absence of species the binomial family should be used which is the default for this option mustart starting values of the vector of means epsilon the positive convergence tolerance maximum mle iterations the maximum number of iwls iterations to find the maximum likelihood estimates mle iteration output determines whether output should be produced for each iwls iteration the default is no but if yes is selected the rout log file in the bccvl sdm experiment results will show the fit of the model for each iteration random seed as for cta artificial neural network ann wrw as for glm nbcv the number of cross validations cross validation processes the data by dividing it into training sets and test sets each training set is used once to train the data maximum entropy model maxent wrw as for cta maximum number of iterations the number of iterations of the optimization algorithm after which training is stopped linear quadratic product threshold hinge feature thresholds this set of configurations include 5 different features of maxent the linear feature class ensures that the mean value of a predictor e g rainfall where the species is predicted to occur approximates the value the mean value for where it is observed to occur merow et al 2013 used when a species niche is truncated one side of the unimodal curve is not part of the background sample a quadratic feature constrains the variance in a predictor where the species is predicted to occur to match observation merow et al 2013 a product feature constrains the covariance of a predictor with other predictors it is equivalent to interaction terms in regression when linear features are also included merow et al 2013 threshold features make a continuous predictor binary by generating a feature whose value is 0 below the threshold and 1 above merow et al 2013 used when a physiological tolerance limit exists hinge features are like threshold features except that a linear function is used instead of a step function merow et al 2013 used when complex but smoothed response curves like gam are produced regularisation options threshold feature categorical feature linear quadratic product feature hinge feature regularization multiplier this parameter is denoted by lambda in equations 3 4 in elith et al 2011 diversity and distributions and also explained denoted in beta in equation 9 of merow smith and silander 2013 it is the penalty for over parameterisation in the gain function related to the likelihood ratio of the average presence to the average background point for the size of the coefficients that accompany feature functions phillips et al 2006 phillips and dudík 2008 in the linear predictor higher values mean that there is more penalty on the size of coefficients and hence penalizes feature functions that exhibit greater variability prevalence overall prevalence of the species throughout the study region i e probability of presence at ordinary occurrence points it depends on resolution and on the study region in what proportion of rasters is the species presumed present enables inverting probability output by maxent generized additive model gam wrw as for glm interaction level as for glm irls reg the size of the ridge regression penalty to the model to impose identifiability this should be 0 for most models the iteratively re weighted least squares method by which gams are fitted can fail to converge in some circumstances epsilon as for glm used for judging the conversion of the glm irls loop in gam max mle iterations maximum number of iwls iterations to find the maximum likelihood estimates convergence tolerance the convergence tolerance parameter to use in the gcv ubre optimization number of halvings if a step of the gcv ubre optimization method leads to a worse gcv ubre score then the step length is halved this is the number of halvings to try before giving up surface range envelope sre wrw as for glm resampling as for cta quantile the quantileused to remove the most extreme values of each environmental variable for determining tolerance boundaries the default is set to 0 025 which corresponds to a 95 confidence interval in normal distributions flexible discriminant analysis fda wrw as for glm resampling as for cta number of permutations to estimate the relative importance of each variable method as for cta the regression method used in optimal scaling multivariate adaptive regression splines mars nk max no of terms the maximum number of terms in the model before pruning occurs in mars there have a set m to collect the best production pair this configuration is used to limit the size of set m β m 1 ˆ h l x x j t β m 2 ˆ h l x t x j h l m h x x j t t is the value of a knot in every piecewise mars will add the products to m set until the number nk which we preset penalty the generalized cross validation penalty per knot mars uses generalized cross validation gcv to prune some terms to improve the result accuracy the prune is used to limit gcv g c v σ i 1 n y i f σ ˆ x i 2 1 m σ n 2 m σ r c k c is penalty trevor et al 2009 thresh forward stepwise stopping threshold the forward pass terminates if adding a term changes rsq by less than the threshold prune in this experiment in bccvl there are two configurations 1 prune method including backward no prune exhaustive forward seqrep and cv to prune terms to improve the accuracy prune model terms preset the maximum size of set m after prune wrw as for glm resampling as for cta appendix 2 further details of the formulation of the evaluation metrics used to diagnose the sensitivity shown by algorithms to alternative configuration values 1 the positive predictive value ppv is the proportion of correctly predicted presences 1 ppv tp tp fp where tp is true presences or the number of presences which are modelled correctly and fp is false presences i e number of observed absences which are modelled as presences www bccvl org au support 1 accuracy is the proportion of correctly predicted cases 2 accuracy tp tn total where tp is true presences and tn is true negatives the number of correctly modelled absences www bccvl org au support appendix 3 results of the thorny devil sensitivity tests 
25010,in pursuit of a more robust provenance in the field of species distribution modelling an extensive literature search was undertaken to find the typical default values and the range of values for configuration settings of a large number of the most commonly used statistical algorithms available for constructing species distribution models sdm as implemented in the r script packages such as dismo and biomod2 or other species distribution modelling programs like maxent we found that documentation of sdm algorithm configuration option settings in the sdm literature is overall very uncommon and the justifications for these settings were minimal when present such settings were often the r default values or were the result of trial and error this is potentially concerning since i it detracts from the robustness of the provenance for such sdm studies ii a lack of documentation of configuration option settings in a paper prevents the replication of an experiment which contravenes one of the main tenets of the scientific method iii inappropriate or uninformed configuration option settings are particularly concerning if they represent a poorly understood ecological variable or process and if the algorithm is sensitive to such settings this could result in erroneous and or unrealistic sdms therefore this study sets out to comprehensively test the sensitivity of eight widely used sdm algorithms to variation in configuration options settings maxent artificial neural network ann generalized linear model glm generalized additive model gam multivariate adaptive regression splines mars flexible discriminant analysis fda surface range envelope sre and classification tree analysis cta a process of expert elicitation was used to derive a range of appropriate values with which to test the sensitivity of our algorithms we chose to use species occurrence records for two species koala phascolartos cinereus and thorny devil moloch horridus in order to investigate how algorithm sensitivity depends on the species being modelled results were assessed by comparing the modelled distribution of the control sdm default settings to the modelled distribution from each sensitivity test sdm i e non default configuration settings this was done using the visual and statistical measures of predictive performance available in the biodiversity and climate change virtual laboratory bccvl including the area under the receiver operating characteristic curve the aim of our study was to be able to draw conclusions as to how the sensitivity of sdm algorithms to their configuration option settings may detract from the reliability of sdm results given the often unjustified and unscrutinized use of the default settings and generally infrequent and largely perfunctory attendance to this issue in most of the published sdm literature our results indicate that all of the algorithms tested showed sensitivity to alternative non default values for some of their configuration settings and that often this sensitivity is species dependent therefore we can conclude that the choice of configuration settings in these widely used sdm algorithms can have a large impact on the resulting projected distribution this has important ramifications for decision making and policy outcomes wherever sdms are used to inform species and biodiversity management plans and policy settings this study demonstrates that assigning suitable values for these settings is a very important consideration and as such should always be published along with the model documenting all configuration settings is necessary to increase the scientific robustness transparency and reproducibility of species distribution modelling studies keywords configuration option settings provenance transparency koala thorny devil maxent ann glm gam mars fda sre cta 1 introduction progress made in computational science in recent years has produced concomitant gains and exciting developments in many scientific disciplines many researchers in the computational sciences have increasingly advocated for reproducibility of research which involves the data and computer code used in a published study to be made available to others as a minimum standard when assessing the validity of scientific claims cassey and blackburn 2006 have argued that in order for a scientific study to be acceptable for publication it should be reproducible nrc 2003 they contend that reproducibility is increasingly being requested by journals this standard of reproducibility is based on the theoretically available detailed log of every action taken using computers which underlies every computational experiment if this code were available for scrutiny such transparency in research would surpass the analogous non computational experimental descriptions printed in journals using a human language peng 2011 for scientific fields which inform policy and management decisions and in which there is difficulty in reproducing field experiments and techniques due to the non replicable nature of environmental conditions there is a critical need to track the provenance of derived data products and scientific results provenance which is defined as information about entities activities and people involved in producing a piece of data or thing can be used to form assessments about the quality reliability or trustworthiness w3c working group 2013 of scientific results provenance should cover initial data collection quality assurance analyses modelling and publication reichman et al 2011 it was with a view towards more robust provenance in the field of species distribution modelling sdm that a literature search was undertaken to find the typical default values and an appropriate range of values for configuration option settings in ten algorithms available for constructing species distribution models in the biodiversity and climate change virtual laboratory bccvl hallgren et al 2016 the results of this literature search were summarized in hallgren and mackey 2014 the bccvl www bccvl org au is an online cloud based virtual laboratory which brings together a multitude of datasets sdm algorithms and several different modelling experiment types to create a highly accessible modelling platform which can be used to investigate the impact of climate change and other driving variables on species distributions species traits and several measures of biodiversity in australia and around the world hallgren et al 2016 the sources of the default values of packages in r r core team 2017 which provided the specific implementation of the algorithms used in the bccvl were also investigated hallgren and mackey 2014 found that most sdm studies do not publish sdm configuration option settings and if they do then justifications for these parameter values are minimal and often rely on the r default values or are the result of trial and error consequently we contend that it is advisable to document and publish the rationale for sdm configuration option settings for the sdm algorithms implemented in the r script packages such as dismo hijmans and elith 2013 and biomod2 thuiller et al 2009 or other species distribution modelling programs like maxent phillips et al 2006 if no information for sdm configuration option settings is provided in a publication it makes the sdm experiments unable to be replicated which contravenes one of the main tenets of the scientific method and presents a barrier to good provenance therefore we argue that the explicit documentation of settings is critical for the provenance of a modelling study it is also good scientific practice as it promotes methodological transparency and reproducability both of which are critical to progress in this field greater transparency of model configuration settings may be useful in identifying settings which might be inappropriate or unrealistic which would be particularly concerning if they represent a poorly understood ecological or physical process or if the algorithm was sensitive to such settings thus we also argue that it is important to know how sensitive the modelling algorithm is to its configuration settings without knowing how sensitive an algorithm is to it s configuration settings inappropriately assigned values i e values without reasonable scientific justification could possibly lead to erroneous and or unrealistic sdm results furthermore the use of inappropriate and or uninformed configuration settings which the algorithm is sensitive to could compromise the rigour of the modelling process and the validity of the results within the considerable body of sdm literature there have only been a small number of studies which investigate the sensitivity of sdm algorithms and usually to one aspect of the modelling process e g sensitivity to pseudoabsence selection in seven different sdm barbet massin et al 2012 or sensitivity to input data pirathiban et al 2015 merow et al 2013 provides a user s guide to maxent s model settings background data features regularization and sampling bias and provides broad guidelines on how to set these at the start of the modelling process however it doesn t go into specific detail about the sensitivity of maxent to different values for these settings although they recommend that would be users always explore how different setting choices affect predictions and report these if predictions show substantial differences across settings it is critical to have a strong justification for the specific setting choice merow et al 2013 1067 elith et al 2008 used a large dataset to illustrate the effects of several settings of brt related to model fitting elith et al 2011 provide a valuable discussion on the mechanics of model fitting e g feature selection constraints and regularization in maxent and some exploration of how differences in these settings e g background points and feature types can influence the results however they don t explore the sensitivity of maxent to different settings of these configuration options elith and graham 2009 tested the effect of changing the parameter settings in random forest pertaining to how many variables are randomly selected for evaluation at each split of the tree and how many trees are allowed in the ensemble they also briefly acknowledged the potential impact of changes in parameterization on performance in maxent brt and glm but only provide information on an analysis of the sensitivity to different sampling and weighting of pseudoabsence data in glm and brt anderson and gonzalez 2011 tested the sensitivity of maxent to geographic sampling bias model complexity by varying the linear and quadratic feature types and level of regularization syfert et al 2013 tested the sensitivity maxent sdms to the effects of sampling bias and model complexity via fitting a wide variety of environmental response curves i e functions in maxent convertino et al 2011a b investigated the output variability related to species sample size accuracy of sample resolution of environmental factors and set of predictors while convertino et al 2014 applied a morris method sensitivity analysis to maxent to investigate the importance of a species distributions drivers in space and time including intrinsic and exogenous input factors such as parameter settings beaumont et al 2016 tested a range of sdms regarding the sensitivity to projected climate change scenarios in terms of their likelihood to simulate extreme changes in projected future distribution jarnevicha et al 2017 evaluated combinations of five different algorithms simple and complex generalized linear models multivariate adaptive regression splines maxent boosted regression trees and random forest and background or pseudoabsence methods random minimum convex polygon and continuous and binary kernel density estimator to assess the sensitivity of model outcomes to choices made iturbide et al 2018 tested the sensitivity of glm random forest and mars to pseudo absence sampling in terms of the uncertainty in future projections of their target species derived from ten pseudo absence realizations however to date there has been no systematic investigation of sensitivity to a wide range of configuration option settings for a wide range of sdm algorithms this study reports on research designed to address this gap and expands upon the work started by hallgren et al 2017 which focused on analyzing the sensitivity of boosted regression trees and random forests to configuration settings to eight more species distribution modelling algorithms this study aims to 1 comprehensively test the sensitivity of eight algorithms which are commonly used in species distribution modelling to variation in their configuration option settings 2 draw conclusions as to how the sensitivity of sdm algorithms may impact on the reliability of sdm results given the frequently unjustified nature of the default algorithm settings and the generally low level of awareness of and attendance to this issue in much of the published literature keeping in mind that this reliability is determined by a number of factors including the algorithm chosen the available occurrence data and the objective of the modelling study 3 articulate why setting reasonable and justifiable settings is important for the algorithms tested and which configuration options it is most important to be careful setting given the algorithm s sensitivity to them 2 methodology 2 1 data used occurrence presence datasets for the koala phascolartos cinereus and thorny devil moloch horridus were downloaded from the ala and cleaned the koala dataset used in this study consists of 80 938 records and the thorny devil dataset has 759 records as for hallgren et al 2017 we chose the koala to test algorithm sensitivity to configuration settings due to its well known distribution in this study we chose the thorny devil as a second species to test the algorithm s sensitivity to configuration settings in order to understand how dependent algorithm sensitivity is to the species studied we specifically chose the thorny devil as it has a completely different and non overlapping observed distribution to the koala is far less prevalent and it is in an entirely different class of animal reptilia as opposed to mammalia habitat predictor variables were chosen as input into the species distribution models according to the method used by hallgren et al 2017 for the koala so as to be able to compare our results to this previous study these predictor variables comprised the worldclim current climate hijmans et al 2005 bioclimatic variables 5 max temperature of warmest month 9 mean temperature of driest quarter 10 mean temperature of warmest quarter 12 annual precipitation 14 precipitation of driest month and 17 precipitation of driest quarter all of these were available in the bccvl for the thorny devil after initially modelling its distribution using all 19 worldclim variables we chose predictor variables based on the variable importance plots and response curves derived from the bccvl sdm output for this species this was done due to the paucity of literature on ecophysiology and climatic drivers specific to the thorny devil this approach is similar to that of phillips et al 2006 who advocate including all reasonable predictors in the model maxent and letting the algorithm decide which ones are important merow et al 2013 twelve variables were found to be important across the range of algorithms and hence used in our sensitivity tests these were the worldclim bioclimatic variables 1 annual mean temperature 3 isothermality 4 temperature seasonality 9 mean temperature of the driest quarter 10 mean temperature of the warmest quarter 11 mean temperature of the coldest quarter 12 annual precipitation 13 precipitation of the wettest month 14 precipitation of the driest month 16 precipitation of the wettest quarter 17 precipitation of the driest quarter 18 precipitation of the warmest quarter and 19 precipitation of the coldest quarter 2 2 algorithms tested since different statistical models of vastly different forms may fit the same process equally well with each providing a different perspective or angle onto the same phenomenon it is not possible to know ahead of time for a particular species which shape or template for a sdm will fit well for this reason we control for this uncertainty by investigating more than one sdm algorithm for our modelled species hallgren et al 2017 examined two machine learning algorithms for sdm franklin 2010 which are both extensions of classification trees ct breiman et al 1984 boosted regression trees brt breiman 2001 and random forests rf breiman 1999 2001 this study examines eight more algorithms commonly used for species distribution models all of which are implemented in the bccvl as listed in table 1 maxent phillips et al 2006 phillips and dudík 2008 artificial neural networks ann hopfield 1982 lek and guégan 1999 generalized linear model glm mccullagh and nelder 1989 guisan et al 2002 generalized additive model gam guisan et al 2002 flexible discriminant analysis fda hastie et al 1994 trevor et al 1994 surface range envelope sre busby 1991 jiguet et al 2011 multivariate adaptive regression splines mars friedman 1991 and classification tree analysis cta breiman 1984 along with the two algorithms investigated in hallgren et al 2017 these eight algorithms were found to be widely used in the sdm literature maxent maximum entropy modelling is a machine learning algorithm that uses presence data together with background locations maxent predicts species occurrences by finding the environmental profiles that lead to predictions that best differentiates presence from background while taking into account the limits of the environmental variables of known locations maxent was tested for sensitivity to 12 configurable options in the bccvl artificial neural networks refers to a large group of models that are inspired by biological neural networks in particular the brain which consists of extremely large interconnected networks of neurons to process information artificial neural networks consist of a large number of nodes and connections which are typically organised in layers with an input layer in which the data is fed into the model a number of hidden layers and the output layer which represents the result of the model the most commonly used anns in ecology are single hidden layer feed forward artificial neural networks that are trained by back propagation ann glm gam and mars use both presence and absence or pseudoabsence data as well as environmental data and can handle both continuous and categorical predictors ann as implemented in the bccvl was tested for sensitivity to 2 configurable options generalized linear models glm are an extension of simple linear regression models which predict the response variable as a weighted linear function of multiple predictor variables unlike simple linear regression glms are able to deal with binary data such as presence absence data as implemented in the bccvl glms find the weights that make the species absence presence data most likely across the range of the environmental variables maximum likelihood in the bccvl linear or quadratic effects are available glm was tested for sensitivity to 4 configurable options generalized additive models gams are an extension of glms in such a way that predictor variables can be modeled non parametrically instead of being restricted like glm to solely linear and polynomial terms for predictors therefore gams tend to provide a close fit to the data which can make them less transferrable but is useful when the relationship between the variables are expected to be of a more complex form not easily fitted by standard sdms or where there is no a priori reason for using a particular model gam was tested for sensitivity to 7 configurable options multivariate adaptive regression splines mars is a non parametric regression method that builds a decision tree with each branch comprising a linear regression model it does this by partitioning the data and runs a linear regression model on each different partition the mars algorithm is an extension of linear models that makes no assumptions about the form of the relationship between the response variable and the predictor variables while glms and gams assume that the coefficients of the predictor variables are constant across all values of a predictor the mars algorithm specifically takes into account that this is often not the case but the mars algorithm has similarities to machine learning models such as tree based models because it achieves good fit by tuning predictive performance via cross validation mars was tested for sensitivity to 7 configurable options flexible discriminant analysis fda is a classification model based on a mixture of linear regression models which uses optimal scoring to transform the weights in the regression for better linear separation and multiple adaptive regression splines to generate the discriminant surface fda employs both presence and absence or pseudoabsence data surface range envelope sre is an envelope style method similar to bioclim nix 1986 it uses presence only data and the environmental conditions of locations of occurrence data to profile the environments where a species have been found the envelope is defined by the minimum and maximum values of the environmental variables for all occurrences any location with environmental conditions that falls within this envelope is included in the potential range for a species to avoid the overpredictive effect of outliers the envelope can be reduced to have limits at specified percentiles or standard deviations from the mean both fda and sre were tested for sensitivity to 3 configurable options classification tree analysis cta is a tree based model these models partition species data into increasingly homogeneous groups of presence or absence based on a sequence of decision rules branches to define their relationship to a set of environmental variables the predictor variables each path through the tree following different branches arrives at a different environmental profile and probability of species presence each branch is defined by different ranges of one environmental predictor the single classification tree is the most basic form of a decision tree model as the name suggests classification trees resemble a tree and consist of three different types of nodes connected by directed edges branches root nodes internal nodes and leaf nodes cta was tested for sensitivity to 6 configurable options within the bccvl for each of the algorithms tested different configuration options needed a different strategy for choosing values depending on their type for instance configuration option settings involving positive real and natural numbers were both better assessed at increasing orders of magnitude rather than on some linear scale some settings were categorical e g whether to prune mars is dichotomous some settings manage computational overheads and are therefore only considered if the model provides poor fit similarly to hallgren et al 2017 we used australia wide sdms so as to be able compare results in the case of the koala sensitivity tests with the published literature also in accordance with hallgren et al 2017 the experimental design for our sensitivity analyses is relatively simple control models of koala and thorny devil distribution were built using the default configuration option settings for each of the eight algorithms used in this study then the algorithms were tested for their sensitivity to different settings of each of their configuration options that are configurable within the bccvl the method of choosing combinations of the configuration option settings for the sensitivity testing was the one at a time or oat method hamby 1994 this involved changing one configuration option setting at a time for a particular algorithm keeping all other configuration options for that algorithm at the default values this method was chosen as it allows for the pinpointing of sensitivity to individual configuration options for each algorithm so that our results can be used as a guide as to which configuration options require the most care when setting only species occurrence records presence points for both the koala and thorny devil were used in our sensitivity tests as no true absence data was available for our study thus pseudo absences were calculated in the bccvl using the random setting for this configuration option which is the default in the bccvl all sdm experiments were implemented with ecologically relevant domain constraints to encompass the observed distribution of koala and thorny devil a convex hull around the eastern southeastern and southern distribution of koalas and a convex hull surrounding the observed distribution of thorny devil in the arid centre and west of the continent this is to constrain the placement of pseudo absence points generated by the bccvl a process of expert elicitation was used to derive a range of appropriate values with which to test the sensitivity of our algorithms alkhairy et al 2017 the same expert as for the hallgren et al 2017 study for each algorithm the first step in preparing elicitation low choy et al 2009 ecology was to identify the configurable option settings available through bccvl it was necessary to cross reference the arguments required of the embedded call from the biomod package and the underlying r algorithms in multiple packages as noted in the bccvl provenance www bccvl org au this process was straightforward for several algorithms where the models fitting and r settings are all clearly documented in the same place glm gam mars cta ann and fda hastie et al 2009 documentation for maxent was dispersed in multiple publications as detailed in alkhairy et al 2019 unpublished manuscript elicitation then proceeded following a similar process used for eliciting variable selection pirathiban et al 2015 by prioritizing the settings for inclusion in the sensitivity analysis based on the expert s experience with using these algorithms in contexts involving sdm or otherwise and with sdms in particular finally in the third stage the expert was asked for numerical estimates by nominating a sensible range of values for each settings again based on their experience these values were chosen to detect major shifts in the mapped predictions and performance of sdms the sensitivity analysis carried out in our study reflects a common range finding situation with use of the virtual laboratory where the modeller is initially exploring the wide range of possible settings values table 1 lists each algorithm and the configuration options that were tested in the bccvl as well as the value of the test settings a brief description of the configuration options tested in this study for each of these algorithms is given in appendix 1 to evaluate the difference between the control sdms i e those using default configuration options settings and altered settings sdms we have visually assessed the results by comparing the geospatial distribution of the control sdm and the altered settings sdm we have also noted the differences between the control model and altered settings models in terms of how changing the configuration settings affects the area under the receiver operating characteristic roc curve auc and the accuracy and positive predictive value ppv statistics all of which are calculated within the bccvl when running a species distribution model table 2 the roc plot is a graph with the false positive rate 1 specificity on the x axis and the true positive rate sensitivity on the y axis plotted across the range of threshold probability values where the area under the curve auc statistic is calculated by summing the area under the roc curve area under the receiver operator curve auc is a threshold independent measure of predictive accuracy based on the ranking of locations it is one of the most popular metric of model evaluation and especially in the maxent literature and can be interpreted as the probability that a randomly chosen presence location is ranked higher than a randomly chosen background point merow et al 2013 jarnevich 2015 the auc can range from 0 to 1 although the practical range is from 0 5 to 1 0 since an auc value of 0 5 represents a model that is no better than random jarnevich 2015 the auc represents a value that is used to evaluate the resulting sdm and to compare the performance among different algorithms although essentially we are using the auc and the accuracy and ppv statistic as a diagnostic tool to assess an algorithm s sensitivity to alternate configuration settings roc curves and the auc statistic have been widely used in many fields such as medicine and psychology for many decades and more recently in other areas such as machine learning data mining and ecological modelling phillips et al 2006 santana et al 2008 a few authors have advocated calculating multiple evaluation statistics to assess model performance rather than relying on a single statistic and we argue that the same approach should be used when evaluating the sensitivity of an algorithm since each metric quantifies a difference aspect of predictive performance or sensitivity lobo et al 2008 jarnevich et al 2015 elith and graham 2009 the ppv is the proportion of correctly predicted presences and the accuracy statistic is the proportion of correctly predicted cases these metrics were chosen among a range of statistical outputs generated by the bccvl mainly for their simplicity and ease of interpretation details of these evaluation metrics are in appendix 2 3 results and discussion 3 1 sensitivity shown by maxent to configuration option settings when modelling koala distribution the maxent algorithm showed minor but noticeable sensitivity to the weighted response weights wrw setting throughout the entire east coast and more so when settings were lower in value compared to the bccvl default at higher wrw settings the auc value was marginally higher 0 95 compared to 0 94 when wrw was set to 0 25 fig 1 a the modelled probability of koala occurrence increased throughout the western extent of its range in new south wales nsw and marginally in parts of victoria vic but decreased visibly throughout its range when wrw was set to 0 33 more marginal decreases in probability of occurrence resulted from values of 0 66 and 0 75 see table 1 for all test settings maxent also showed sensitivity to the maximum number of iterations option when set to lower than default values of 10 and 100 fig 1 a showing slight decreases in the probability of koala occurrence in the bccvl every feature threshold option or feature type is set to yes by default sensitivity was tested by selecting no for linear first then adding a no selection for quadratic keeping linear as no then progressively adding the no selection for product threshold and hinge options keeping all previous options checked as no decreased probability of occurrence resulted when the linear option was set to no and when both the linear and quadratic options were both set to no fig 1 a minor changes in distribution resulted from the combined linear quadratic and threshold options being set to no and slightly higher probability of occurrence but negligible changes in extent resulted from the combination of the product feature threshold being set to 40 the quadratic feature threshold being set to 5 and the hinge feature threshold being set to 8 table 1 the changes in koala distribution seen as a result of these sensitivity tests are noticeable at regional levels in terms of probability of occurrence although the overall spatial pattern of koala distribution along the southern and eastern vic and eastern nsw does not change noticeably this result corroborates syfert et al 2013 who found that the choice of feature type had negligible effects on predictive performance of their target species at continental scale in terms of the regularization options for maxent the threshold categorical linear quadratic product and hinge feature regularization options showed very minor sensitivity to altered settings see for example the result for threshold feature regularization in fig 1 anderson and gonzalez 2011 found that their sdm results varied greatly according to the level of regularization which indicates that stronger sensitivity was shown to this configuration option compared to that indicated by our study the threshold feature regularization option shows changes in distribution that are discernable at regional levels in terms of changes to the probability of occurrence with only very minor changes in range alternative values for the configuration settings only produced very minor changes to the auc value and the ppv and accuracy statistics the accuracy statistic shows more sensitivity than the other statistics to changes in the configuration settings with the most sensitivity being shown to the threshold feature regularization the linear quadratic product feature regularization and the combination of the product quadratic and hinge feature threshold being set to 40 5 and 8 respectively table 2 it is clear that there were differences in the sensitivity to configuration settings that are attributable to the different species being modelled the thorny devil sensitivity testing of maxent revealed only very minor changes in distribution with lower values of the wrw setting fig a1 in appendix 3 having the prevalence linear and quadratic threshold and linear quadratic and threshold settings set to no also produced minor but still noticeable changes in distribution with the latter affecting the smoothness of the distribution much more markedly in the thorny devil tests compared to the koala tests moreover the thorny devil tests indicate some sensitivity when the threshold feature regularization is altered away from the control setting unlike the case for the koala tests but minimal to no discernible sensitivity to changes in the value of the categorical and hinge feature regularization nor when the linear quadratic and product feature regularization options were changed together away from the default value as was the case for the koala tests of all the evaluation metrics the auc showed the least sensitivity to alternative configuration settings showing minimal sensitivity to the threshold feature regularization linear quadratic linear quadratic threshold and prevalence options in contrast the ppv and accuracy statistics showed some and often much greater sensitivity to all configuration options table a1 in appendix 3 these results contrast with convertino et al 2014 whose sensitivity analysis results indicate that the beta hinge feature parameter tended to score highly in terms of factor importance and beta categorical the maximum number of iterations beta threshold l2lq threshold convergence threshold hinge threshold and beta multiplier settings scored lower in order of importance according to the average habitat suitability result in table 2 of convertino et al 2014 3 2 sensitivity shown by ann to configuration option settings the ann algorithm was tested for sensitivity to non default values of wrw and the number of cross validations to find best size and decay parameters nbcv high sensitivity was seen to non default values for both configuration options fig 1 b in the case of wrw only values higher than the control 0 5 resulted in altered distributions there was both a moderately expanded range inland from southeast qld to southeast sa but a smaller range in northern qld and a higher probability of occurrence within that range for wrw values of 0 66 and 0 75 however with values of 0 9 and above the was an expanded range all over especially in eastern qld for nbcv a value of 10 resulted in changes in the probability of occurrence in the southern parts of the range but a contracted range in northern qld for a value of 20 there was a slight expansion of range except in southeast qld which encompassed areas of slightly lower probability of occurrence ann showed minor sensitivity to altered values for the wrw and the nbcv settings in terms of the modelled distribution and this was reflected in the evaluation statistics for the sensitivity tests which showed mostly minor changes to the auc ppv and accuracy values table 2 the thorny devil sensitivity testing using ann produced results that indicated a noticeable increase in distribution as wrw increased changes only up to 0 66 were able to be determined for the thorny devil tests the modelled distribution of thorny devil noticeably decreased as nbcv increased from 10 to 20 whereas in the koala sensitivity tests the modelled distribution noticeably increased as nbcv increased fig a1 appendix 3 in addition the thorny devil sensitivity tests of ann showed a noticeably larger impact on the evaluation metrics with the auc ppv and accuracy all showing higher sensitivity to changes in the configuration settings compared to the koala sensitivity tests table a1 appendix 3 this indicates that the sensitivity of ann to configuration options differs according to the species modelled 3 3 sensitivity shown by glm to configuration option settings the glm algorithm was tested for sensitivity to non default values of the wrw type interaction level and test configuration options high sensitivity was seen in the modelled distribution maps to non default values for the wrw option with greater sensitivity the higher the value for this setting fig 1 c considerable sensitivity was also shown to other settings for the type configuration option with the polynomial setting resulting in a more westward distribution of the koala population fig 1 c glm showed strong sensitivity to the interaction level with greater values resulting in expanded koala populations in some areas northern nsw vic and contracted population lower occurrence probability in other areas southern nsw along the northern qld coast parts of eastern vic fig 1 c no noticeable sensitivity was shown to alternative settings of the test configuration option altered values for the type and the interaction level settings produced minor increases in the auc and accuracy values and slightly larger increases in the ppv values table 2 indicating generally low sensitivity of glm according to these evaluation metrics for the koala sensitivity tests the thorny devil tests indicate that glm shows more sensitivity to changes in configuration settings than is the case in the koala tests this is true for the wrw type particularly for the simple type setting interaction level and test settings with the bic setting for the test configuration option showing noticeably different distribution compared to the control aic setting fig a1 the evaluation statistics for the thorny devil sensitivity tests indicates that gam is sensitive to all four configuration options tested according to the auc and accuracy statistic both of which for example decrease with increasing wrw values the ppv metric indicates sensitivity only to the type and interaction level configuration options table a1 the metrics we investigated corroborate the modelled distribution results in showing that glm shows more sensitivity when tested with the thorny devil dataset than with the koala dataset 3 4 sensitivity shown by gam to configuration option settings the gam algorithm was tested for sensitivity to non default values of numerous configuration options the change in koala distribution increased in terms of probability of occurrence when the value of the wrw was increased to 0 6 from the control value of 0 5 values of 0 9 and 0 99 resulted in not only increases in the probability of occurrence but also a larger extent of koala distribution inland from the observed distribution in qld nsw vic and south australia sa fig 1 d as values of the interaction level setting increased from the control to 1 and 2 there were areas within the koala distribution which showed lower probability of occurrence and at a value of 2 there is a contraction of koala range in southeast nsw and eastern vic fig 1 d changes in the value of the epsilon setting produced only very minute almost imperceptible changes in koala distribution there were no discernible changes in koala distribution for test values of irls reg from 0 1 to 0 9 max mle iterations from 50 to 200 convergence tolerance from 1 e 5 to 1 e 6 and number of halvings from 5 to 30 only alternative higher than default values for the wrw configuration option resulted in a very small increase in the ppv and accuracy statistic and the auc indicated no sensitivity to any alternative configuration values for the koala sensitivity tests table 2 for the thorny devil sensitivity tests minimal but perhaps locally significant sensitivity was shown to increases in wrw up to 0 6 sensitivity to higher values was indeterminable some sensitivity was shown to interaction level from 1 to 2 particularly in northwest wa but noticeably more sensitivity was shown by gam to increasing values of irls reg and epsilon in the thorny devil sensitivity tests compared to that shown in the koala tests the thorny devil sensitivity tests resulted in quite minimal but still noticeable sensitivity of gam to increases in the value of max mle iterations convergence tolerance and number of halvings fig a1 the evaluation statistics for the thorny devil tests indicate gam is sensitive to altered values for all of the configuration settings tested according to the auc and ppv statistic the latter showing more sensitivity the accuracy statistic showed less sensitivity both in terms of the number of configuration options and the magnitude of sensitivity shown table a1 appendix 3 certainly these statistics reveal that gam is more sensitive to alternative configuration settings when modelling the distribution of the thorny devil compared to the distribution of the koala 3 5 sensitivity shown by mars to configuration option settings mars sensitivity testing showed a higher probability of occurrence and expanded range with higher values of wrw than the default at 0 6 there is higher probability of occurrence within the range produced by the default and patches of higher probability of occurrence outside that range at 0 9 and above there is a much expanded range with moderate probability of occurrence fig 1 e moderate sensitivity was shown by mars to non default values of nk maximum number of terms there was a decreased probability of occurrence at the western edge of the range and an expanded range in northern qld when nk was set to 5 and 10 fig 1 e and minimal changes resulting from settings of 15 20 and 100 minimal but still noticeable sensitivity was seen to the thresh option when it was set to 0 01 and 0 005 however the eastern and southern population contracted and northern population expended with higher values of 0 05 values for penalty which were lower than the default elicited some sensitivity when set to 2 5 there is a slightly expanded range in northeast nsw and slightly less in the high country in nsw vic fig 1 e for extremely high values for resampling i e when set to 100 the koala distribution shows a slightly altered range in nsw and a slightly expanded range in qld fig 1 e no noticeable sensitivity was shown to the prune setting altered values for the nk and the thresh settings produced decreased auc ppv and accuracy values table 2 increased values of the wrw option caused decreased values for all these metrics overall the ppv statistic was the most sensitive to changes in the configuration options tested and auc the least sensitive metric in terms of the number of options that showed sensitivity and the magnitude of the sensitivity shown the thorny devil tests indicate that mars shows more sensitivity to changes in some configuration settings than the koala tests there is considerable sensitivity shown to altered values of the nk option with low values nk 5 increasing the area which has any probability of distribution of thorny devil markedly and with high values nk 100 reducing the extent of modelled thorny devil occurrence there is also noticeable sensitivity to penalty setting with an increasing extent of occurrence as values increase which is not the case for the koala high sensitivity was shown by mars to the thresh option with increasing extent of occurrence with higher values similarly to the koala tests but the sensitivity was higher in the thorny devil tests as with the koala tests mars showed high sensitivity and a larger extent of occurrence to increasing values of wrw and more sensitivity to increasing values of resampling than the koala tests indicate fig a1 appendix 3 the evaluation statistics for the thorny devil sensitivity tests indicate that mars shows more sensitivity to configuration settings when simulating the thorny devil compared to the results of the koala sensitivity tests with more configuration options showing a greater magnitude of sensitivity to altered settings and in the case of mars it is the ppv and auc statistics which indicate greater sensitivity compared to the accuracy statistic table 1 appendix 3 the nk and thresh options showed the greatest sensitivity across all three metrics in the thorny devil tests 3 6 sensitivity shown by fda to configuration option settings for the koala sensitivity testing of the fda algorithm very high sensitivity was seen to higher than default values for wrw with both higher probability of occurrence and a much larger extent of distribution above wrw values of 0 6 or higher fig 1 f fda showed moderate sensitivity to alternative values of the method configuration option in terms of the probability of occurrence compared to the predicted range resulting from the default setting the polyridge setting for the method option resulted in higher probability of occurrence and for the bruto setting they resulted in lower probabilities of occurrence fig 1 f negligible sensitivity was seen for alternative values of the resampling option at the continental scale altered values for the wrw and the method settings produced both increased and decreased auc ppv and accuracy values table 2 the ppv statistic showed higher sensitivity to these and was also quite sensitive to the resampling configuration option the thorny devil sensitivity tests revealed high sensitivity in the modelled distributions to changes in the value of wrw resampling and method configuration options with the latter two showing more sensitivity in the thorny devil tests compared to the koala tests fig a1 the evaluation statistics also revealed high sensitivity to changes in the value of the three configuration options and showed higher sensitivity than the evaluation statistics from the koala sensitivity tests particularly the resampling and method options table a1 3 7 sensitivity shown by sre to configuration option settings the sre algorithm was tested for sensitivity to alternative values of the wrw resampling and quantile configuration options high sensitivity was seen to non default values for the quantile option with an expanded koala range seen at a value of 0 01 and an increasingly contracted range seen for values of 0 05 and 0 1 fig 1 g no noticeable sensitivity was shown to the wrw and resampling settings these results were reflected in the evaluation statistics with only the quantile option exhibiting any sensitivity increasing quantile values resulted in decreasing values of auc and accuracy but higher values of ppv table 2 there was a similar decrease in the extent of modelled thorny devil distribution with increasing values of the quantile configuration setting as for the koala fig a1 no change in distribution was seen with increasing values of resampling or wrw the quantile setting showed a similar pattern of sensitivity in the evaluation statistics to that seen in the koala sensitivity tests however the thorny devil tests also indicated sensitivity to the wrw setting in terms of altered auc ppv and accuracy values and also sensitivity to the resampling setting in terms of altered auc values these results indicate the sre algorithm shows more sensitivity when tested with the thorny devil dataset compared to the koala dataset table a1 3 8 sensitivity shown by cta to configuration option settings the cta algorithm s modelled distribution showed high sensitivity to the wrw option fig 1 h with higher values resulting in an expanded koala range and higher probability of occurrence in many areas within that range high sensitivity was also shown to changes in the setting of the complexity parameter option showing a much increased probability of koala occurrence in western vic when the value is 0 025 and an increase in range and probability of occurrence again when the value is 0 05 fig 1 h compared with the default value of 0 01 cta was also moderately sensitive to different settings of the maximum depth option particularly when the value is set to 40 i e higher than the default fig 1 h the cta algorithm showed minor sensitivity to the minimum bucket setting there was a minor decrease in the probability of occurrence in western victoria when minimum bucket was set to 50 but no other alternative settings produced different distributions from the control 20 no noticeable sensitivity was seen to the cross validation folds and minimum split configuration options all evaluation statistics showed sensitivity to the wrw complexity parameter and minimum bucket settings table 2 the ppv statistic showed more sensitivity to alternative configuration settings than either the auc or accuracy statistic particularly the wrw setting the thorny devil tests indicate that cta shows more sensitivity to changes in configuration settings than is the case in the koala tests this is true for wrw cross validation folds minimum bucket minimum split and maximum depth configuration options the thorny devil tests indicate high sensitivity of cta to the complexity parameter as with the koala tests fig a1 the cta algorithm also showed more sensitivity in the thorny devil sensitivity tests than the koala tests in terms of the impact of the alternative configuration settings on the evaluation statistics in these tests the auc exhibited greater sensitivity than either the ppv statistic in terms of the number of options that showed sensitivity or the accuracy statistic in terms of the magnitude of the sensitivity displayed by most of the configuration options table a1 4 summary and conclusions our study aimed to comprehensively test the sensitivity of eight algorithms that are widely used in species distribution modelling to variation in their configuration settings in addition to the two algorithms which were tested for sensitivity to configuration settings in terms of differences in koala distribution in hallgren et al 2017 there are now eight more sdm algorithms which have been comprehensively tested and have been shown to exhibit sensitivity in terms of how differently configured algorithms can result in different and often remarkably different modelled distributions and evaluation metrics for two species the koala and the thorny devil our results indicate that for many of the algorithm tested in this study not all configuration options show the same sensitivity as might be expected of the eight algorithms tested the most flexible ones mars cta fda gam sre showed greater sensitivity to more of their alternative configuration settings which were tested in this study in terms of changes in the modelled probability of occurrence of the species koala or thorny devil or the range in the species distribution this is understandable given that many of these settings govern the flexibility in terms of how closely the model fits the data hastie et al 2009 maxent and glm have fewer configuration settings but also showed less sensitivity to their settings this can be explained since these approaches are more model based austin 2002 so that rather than having many small decisions regarding model flexibility there are fewer major decisions on model complexity these can be more strongly related to ecological theory e g austin 2002 low choy and huijbers 2017 meaning algorithm sensitivity can be under the control of the modeller with some ecological knowledge our research shows that for many of the configuration options investigated particularly those for mars cta sre ann and fda the choice of settings for these options can impact the resulting modelled distribution markedly as well as the auc ppv and accuracy statistics it is likely that other evaluation statistics would also show some sensitivity but this needs empirically verifying hence appropriate care must be taken to choose sensible and justifiable values for these algorithms our research also indicates that algorithm sensitivity to configuration settings differs according to the species modelled and that this differential sensitivity is greater in some algorithms than others algorithm sensitivity is also somewhat dependent on type of model output distribution map evaluation metric used to diagnose this sensitivity some evaluation statistics reveal more or less sensitivity of the algorithm to alternative configuration settings our finding of the differential sensitivity of the different evaluation statistics to alternative sdm configuration settings and this justifies our use of more than one them in this study to evaluate the sensitivity of the algorithms this aspect of our results supports a growing chorus which indicates that it is not wise to rely on the auc as a measure of model skill e g townsend peterson et al 2008 lobo et al 2008 one of the aims of our study was to draw conclusions as to how the sensitivity of sdm algorithms may impact on the reliability of sdm results given the frequently unjustified nature of the default algorithm settings and the generally low level of awareness of and attendance to this issue in much of the published literature keeping in mind that this reliability is determined by a number of factors including the algorithm chosen the available occurrence data and the objective of the modelling study with respect to an algorithm s configuration we suggest that sdm studies that have not carefully chosen configuration settings may yield results that are inaccurate or inappropriate to the desired ecological scale to the extent that the algorithm is sensitive to those settings at the very least this source of uncertainty should be acknowledged in published sdm studies another aim of this study was to define which configuration options need setting thoughtfully given an algorithm s sensitivity to them in terms of how the projected distribution was affected we found that all algorithms tested were sensitive to sampling weights particularly the wrw configuration option except sre this sensitivity confirms that the samples provided are not exhaustive of the complex australian environment and sampling effort appears to have varied with environment this is important since it signals to bccvl users that they need to check the data they are putting into sdms in terms of the sampling weights which means changing the wtw setting for the algorithms are very sensitive to this our results suggest that for maxent care must also be taken when configuring the linear and quadratic settings the threshold feature regularization and the maximum number of iterations due to the sensitivity of the modelled distribution to these configuration options for ann care should be taken when setting the nbcv option for glm the configuration options to set most carefully are the type and test settings and for gam care must be taken when setting the interaction level the most sensitive configuration options for the mars algorithm that need to be set carefully are the resampling prune nk penalty and thresh for fda the resampling and method configuration options require careful setting for sre the quantile setting is the most sensitive and therefore needs most care when setting and for cta care should be taken when setting the minimum bucket and the maximum depth configuration options we believe our results demonstrate unequivocally the importance of the configuration settings of algorithms used for species distribution modelling given the sensitivity to such settings furthermore the documentation of these settings is necessary to increase the scientific robustness transparency and reproducibility of species distribution modelling studies as noted in hastie et al 2009 while only a brief description of the configuration options tested in this study is given in appendix 1 in light of our results we believe that it is necessary to have a good understanding of an algorithms configuration options in order to be able to justify the settings used and to understand the impact each configuration setting has on the model and resulting species distribution and evaluation statistics we note that all sensitivities are relative to the control model chosen and are also dependent upon the test values chosen which is why great care was taken to choose test values based on expert knowledge of the algorithms and which were numerically and statistically appropriate for the algorithm tested nevertheless for the configuration option values to which certain algorithms did not show much sensitivity to there remains the possibility that sensitivity could potentially be shown to a broader range of test values lastly while the sensitivity we have documented to the algorithms we have investigated in this study may not hold for other locations or species we have demonstrated that our methodology can be used to effectively and efficiently investigate the sensitivity of sdm algorithms to their configuration settings for any sdm study acknowledgments the bccvl is supported by the australian research data commons ardc the ardc is supported by the australian government through the national collaborative research infrastructure strategy ncris griffith university provided the research funding to conduct this study no co authors have any conflicts of interests to declare appendix 1 configuration option descriptions for algorithms used in the sensitivity analysis testing descriptions obtained from literature where cited or the bccvl org au algorithm configuration options description of configuration options classification tree analysis cta weight response weights wrw allows users to give more or less weight to particular observations if the default setting is used i e null each observation presence or absence has the same weight regardless of the number of presences and absences if the value is set below 0 5 absences are given more weight whereas a value above 0 5 gives more weight to presences resampling the number of permutations to estimate the importance of each variable if a value larger than 0 is used the algorithm will produce an object called variableimportance full csv high values of which mean that the predictor variable has a high importance whereas values close to 0 indicate that the predictor variable has no importance method the method to be used to fit the decision tree classification or regression for categorical data such as the presence absence of species the class method should be used which is the default for this option cross validation folds the function of cross validation folds that should be created for training cv 1 and testing 1 the default number of cross validations is 10 which means that the datasets is divided into 10 subsets using 9 subsets as training data to calibrate the model and 1 subset as test data this process is repeated for all possible combinations of training and test subsets a total of 10 times and then the error rates can be used to prune the tree using the standard 1 se rule which states that the tree with the most nodes should be selected as long as the corresponding cross validation error is within one standard deviation of the minimum cross validation error the corresponding complexity parameter value can then be specified to generate an optimally pruned tree minimum bucket the minimum number of observation that needs to be present in any terminal node minimum split the minimum number of observations that must exist in a node for a split to be attempted this is a good way to limit the growing of the tree when a node contains too few observations further splitting will result in overfitting the optimum minimum split depends on the number of observations and predictor variables in a dataset with a limited number of observations and predictor variables stopping early will result in no tree at all with a lot of observations a cta can stop early and still obtain a large enough decision tree the more predictor variables in a dataset there is a larger possibility of having some accidental relationship between one of the variables and the response so with a lot of variables it is advisable to stop earlier complexity parameter the complexity measure is a combination of the size of a tree and the ability of the tree to separate the classes of the response variable if the next best split in growing a tree does not reduce the tree s overall complexity by the value of this option the algorithm will terminate the growing process a complexity parameter value of 1 will always result in a tree with no splits while a value of 0 will build a tree with the maximum possible complexity which can potentially be very complex maximum depth the maximum number of splits of the tree this is a limit to stop further splitting of nodes when the specified tree depth has been reached during the building of the initial decision tree random seed random seed is a number which is used to generate a set of pseudorandom numbers by some algorithms generalized linear model glm wrw as for cta resampling as for cta type the type of regression model to use this can be either a linear option simple a quadratic or a polynomial model the default for this option is quadratic which creates a curved model with one hump i e a u or inverted u shape interaction level the number of interactions between predictor variables that need to be considered a value of 1 will fit an additive model a value of 2 will result in a model with 2 way interactions etc test the biomod2 package uses an automatic stepwise selection procedure which means that the model is built by sequentially adding or dropping predictor variables and testing whether they improve the fit of the model predictors that do not improve the fit of the model will be dropped the test option indicates which criteria should be used to test the fit of the model the akaike information criterion aic which is the default or the bayesian information criteria bic by selecting none the stepwise procedure will be switched off resulting in a model in which all predictor variables are retained family the description of the error distribution of the response variable and the link function used in the model for binary data such as presence absence of species the binomial family should be used which is the default for this option mustart starting values of the vector of means epsilon the positive convergence tolerance maximum mle iterations the maximum number of iwls iterations to find the maximum likelihood estimates mle iteration output determines whether output should be produced for each iwls iteration the default is no but if yes is selected the rout log file in the bccvl sdm experiment results will show the fit of the model for each iteration random seed as for cta artificial neural network ann wrw as for glm nbcv the number of cross validations cross validation processes the data by dividing it into training sets and test sets each training set is used once to train the data maximum entropy model maxent wrw as for cta maximum number of iterations the number of iterations of the optimization algorithm after which training is stopped linear quadratic product threshold hinge feature thresholds this set of configurations include 5 different features of maxent the linear feature class ensures that the mean value of a predictor e g rainfall where the species is predicted to occur approximates the value the mean value for where it is observed to occur merow et al 2013 used when a species niche is truncated one side of the unimodal curve is not part of the background sample a quadratic feature constrains the variance in a predictor where the species is predicted to occur to match observation merow et al 2013 a product feature constrains the covariance of a predictor with other predictors it is equivalent to interaction terms in regression when linear features are also included merow et al 2013 threshold features make a continuous predictor binary by generating a feature whose value is 0 below the threshold and 1 above merow et al 2013 used when a physiological tolerance limit exists hinge features are like threshold features except that a linear function is used instead of a step function merow et al 2013 used when complex but smoothed response curves like gam are produced regularisation options threshold feature categorical feature linear quadratic product feature hinge feature regularization multiplier this parameter is denoted by lambda in equations 3 4 in elith et al 2011 diversity and distributions and also explained denoted in beta in equation 9 of merow smith and silander 2013 it is the penalty for over parameterisation in the gain function related to the likelihood ratio of the average presence to the average background point for the size of the coefficients that accompany feature functions phillips et al 2006 phillips and dudík 2008 in the linear predictor higher values mean that there is more penalty on the size of coefficients and hence penalizes feature functions that exhibit greater variability prevalence overall prevalence of the species throughout the study region i e probability of presence at ordinary occurrence points it depends on resolution and on the study region in what proportion of rasters is the species presumed present enables inverting probability output by maxent generized additive model gam wrw as for glm interaction level as for glm irls reg the size of the ridge regression penalty to the model to impose identifiability this should be 0 for most models the iteratively re weighted least squares method by which gams are fitted can fail to converge in some circumstances epsilon as for glm used for judging the conversion of the glm irls loop in gam max mle iterations maximum number of iwls iterations to find the maximum likelihood estimates convergence tolerance the convergence tolerance parameter to use in the gcv ubre optimization number of halvings if a step of the gcv ubre optimization method leads to a worse gcv ubre score then the step length is halved this is the number of halvings to try before giving up surface range envelope sre wrw as for glm resampling as for cta quantile the quantileused to remove the most extreme values of each environmental variable for determining tolerance boundaries the default is set to 0 025 which corresponds to a 95 confidence interval in normal distributions flexible discriminant analysis fda wrw as for glm resampling as for cta number of permutations to estimate the relative importance of each variable method as for cta the regression method used in optimal scaling multivariate adaptive regression splines mars nk max no of terms the maximum number of terms in the model before pruning occurs in mars there have a set m to collect the best production pair this configuration is used to limit the size of set m β m 1 ˆ h l x x j t β m 2 ˆ h l x t x j h l m h x x j t t is the value of a knot in every piecewise mars will add the products to m set until the number nk which we preset penalty the generalized cross validation penalty per knot mars uses generalized cross validation gcv to prune some terms to improve the result accuracy the prune is used to limit gcv g c v σ i 1 n y i f σ ˆ x i 2 1 m σ n 2 m σ r c k c is penalty trevor et al 2009 thresh forward stepwise stopping threshold the forward pass terminates if adding a term changes rsq by less than the threshold prune in this experiment in bccvl there are two configurations 1 prune method including backward no prune exhaustive forward seqrep and cv to prune terms to improve the accuracy prune model terms preset the maximum size of set m after prune wrw as for glm resampling as for cta appendix 2 further details of the formulation of the evaluation metrics used to diagnose the sensitivity shown by algorithms to alternative configuration values 1 the positive predictive value ppv is the proportion of correctly predicted presences 1 ppv tp tp fp where tp is true presences or the number of presences which are modelled correctly and fp is false presences i e number of observed absences which are modelled as presences www bccvl org au support 1 accuracy is the proportion of correctly predicted cases 2 accuracy tp tn total where tp is true presences and tn is true negatives the number of correctly modelled absences www bccvl org au support appendix 3 results of the thorny devil sensitivity tests 
25011,aim complex biotic interactions are notably excluded from species distribution models sdms as they are often difficult to quantify and accommodate in a traditional modeling framework especially those with a temporal component the territorial nature of breeding cactus wren is well documented and typically involves nest usurping i e destruction of conspecifics due to their similar nesting ecology breeding verdin are frequently the target of such behavior and are often forced to move or abandon nests using the verdin cactus wren system as a case study our goal was to evaluate the performance of sdms that include only environmental predictors with sdms that also include biotic relationships as predictors location east foundation s san antonio viejo ranch in south texas methods we built sdms maxent boosted regression tree brt and random forest rf to project verdin distribution during the early april through mid may peak mid may through mid june and late mid june through mid july breeding periods using occurrence data collected during the 2015 and 2016 breeding seasons we ran parallel analyses using relevant environmental features alone as predictors and then environmental features with observed cactus wren density results random forest rf produced the highest predictive performance sdms for all three breeding periods auc 0 81 0 99 tss 0 23 0 73 all models improved in predictive power δ auc 0 01 0 10 and model sensitivity δ tss 0 09 0 66 with the inclusion of cactus wren density as a predictor of verdin presence main conclusions our results indicate that sdm performance is improved by the inclusion of biotic relationships as predictors incorporating biotic interactions as well as their temporal trends is essential in efforts to monitor or conserve bird species with similar nesting ecologies further modeling algorithms that can accommodate complex non linear relationships e g random forest should be preferred in sdm development and application keywords biotic interactions birds cactus wren competition nesting species distribution model predation verdin 1 introduction traditionally species distribution models sdms which statistically associate a species occurrence with a suite of geospatial predictors use resource variables resources that the animal consumes or requires to persist in an area e g shrub density water availability to define and project a species niche and distribution austin and niel 2011 elith and leathwick 2009 indirect variables which are features the animal does not consume or require for persistence but with which it may still interact e g competition or predation are often not included in sdms due to the difficulty in identifying the variable ecologically quantifying the relationship or in managing collinearity issues adding an interaction factor to a traditional sdm framework may contribute austin and niel 2011 however recent advances in machine learning algorithms e g random forest have enabled us to include indirect variables or biotic relationships such as competitive exclusion in sdms miller 2010 complex biotic interactions are notably excluded from sdms as they are often difficult to quantify and accommodate in a traditional modeling framework especially those with a temporal component i e an interaction or relationship that changes through time in this study we use the ecological relationships between two bird species as a case study of the potential value of incorporating biotic interactions into sdms competition between sympatric species often include contest for limited resources e g territory food mates in birds availability of nesting space or materials presents a unique competitive challenge in that the degree of contest between species has a temporal aspect namely the breeding seasons for example competition for nest sites is often observed in sympatric bird species with similar nesting ecology that would otherwise partition resources the remainder of the year martin 1993 macarthur 1958 inferior competitors are then frequently pushed to alternative nest sites that may be more vulnerable to predation or exposure newton 1994 one such example is the relationship between breeding cactus wren campylorhynchus brunneicapillus a large 32 47 g territorial wren native to the desert southwestern united states and verdin auriparus flaviceps a small 5 8 g penduline tit native to the southwestern united states and northern mexico anderson and anderson 1973 lockwood and freeman 2004 williamson 2000 most of the year the disparity in size and general morphology of these two species allows for territorial and food resource partitioning anderson and anderson 1973 wise gervais 2005 however both the cactus wren and verdin prefer areas of dense cholla cacti opuntia spp for nesting but will also utilize palo verde cercidium spp large mottes of mixed cacti and other spiny plants anderson and anderson 1973 wise gervais 2005 the territorial nature of breeding cactus wren is well documented and typically involves nest usurping i e destruction with the verdin frequently the target of such behavior and are often forced to retreat to alternative nest sites mcgee 1985 simons and simons 1990 our main objective was to evaluate the performance of sdms that include only environmental predictors with sdms that also include biotic relationships as predictors more specifically as a proof of concept we evaluated the ability of sdms of verdin that included only environmental predictors with sdms that also included the density of cactus wren as a predictor we also evaluated the ability of sdms incorporating cactus wren to detect differences in the relative influence of this biotic predictor among early peak and late portions of the verdin breeding season 2 methods 2 1 study site we conducted our study on the east foundation s 61 000 ha san antonio viejo ranch sav located approximately 25 km south of hebbronville texas in jim hogg and starr counties sav is located within the south texas plains ecoregion and is one of six properties of the east foundation that are managed as a living laboratory to support wildlife conservation and other public benefits of ranching and private land stewardship vegetation composition and structure within our study area is characteristic of this ecoregion and consists of a mosaic of grassland and thornscrub sav is representative of south texas rangeland ecosystems and encompasses the coastal sand plain and texas tamulipan thronscrub ecoregions low growing woody plants dense shrubs prosopis glandulosa acacia greggii celtis ehrenbergiana colubrina texensis aloysia gratissima lantana urticoides and cacti opuntia engelmannii var lindheimeri opuntia leptocaulis dominate the vegetation in this area mean annual temperature within our study site is 22 6 c and mean annual precipitation is 502 5 mm prism climate group 2018 mean monthly temperature during our study period april july 2015 and 2016 was 27 2 c with a maximum daily high of 32 8 c prism climate group 2018 mean monthly precipitation during our study period was 77 1 mm with a maximum daily high of 93 1 mm prism climate group 2018 2 2 environmental predictors we used canopy height shrub density water proximity grass spp coverage and cacti spp coverage recorded from ground surveys as well as local topographic relief and an optimized soil adjusted vegetation index osavi calculated using remotely sensed imagery in 2015 and 2016 as environmental predictors in sdms specific workflow and processing details for each environmental predictor can be found in appendix a 2 3 bird occurrence data avian point counts consisted of 25 12 point transects arranged in a stratified random design across sav stratified by vegetation type each transect was surveyed 3 times throughout the breeding season first visit between april and mid may second visit between mid may and mid june and third visit between mid june and mid july we used point count data collected from april to july 2015 and 2016 to build baseline sdms each point was located 400 m apart and 2 observers recorded visual and auditory occurrences of birds within 200 m of each point simultaneously yet independently we used a traditional framework in which each occurrence was counted as a presence record at each point omitting the duplicate records from the double observer design and resampling the data by a 200 m cell size this granted us a finer spatial resolution of the data set to thoroughly investigate the influence of conspecific cactus wren density on the presence of verdin cactus wren density was calculated using observed abundance at each transect point divided by the total space surveyed 200 m2 we used the occurrence of verdin and the calculated density of cactus wren during the breeding seasons of 2015 and 2016 for sdms 2 4 data processing and analysis we exported the rasters of all predictors as geotiffs and read these into the r statistical language as raster layers r core team 2013 all layers were stacked to create the occurrence predictor stack for sdms parallel analyses were also performed by time period within the breeding season early april through mid may peak mid may through mid june and late mid june through mid july to investigate temporal changes in cactus wren influence on verdin distribution bird occurrence data were subset by season we imported occurrence data for verdin into r and used the predictor raster stack to build sdms using three different algorithms maxent boosted regression tree brt and random forest rf table 1 outlines the basic mathematical approach of each modeling algorithm and provides a comparison of the advantages of each model in the occupancy framework we generated background data to produce the non presence class required by the logistic models background data do not attempt to guess at absence locations but instead are used to characterize the study region phillips and elith 2011 phillips et al 2009 ward et al 2009 background data represent the environmental domain of the study and are independent of occurrence data while presence data establish the conditions under which a species is more likely to be present than a null or completely random model would predict after building baseline sdms we added the raster representing cactus wren density to the occurrence predictor raster stack and re ran the models to assess any improvement or degradation in the predictive performance and sensitivity of each algorithm for each breeding period we also calculated relative influence and significance of each predictor using a mixed model approach we calculated relative influence of each predictor on verdin presence using a brt analysis and the significance of highly influential variables through logit generalized linear regression analyses the brt has the unique advantage to accommodate collinearity among predictors and fit complex nonlinear relationships between response and predictor variables making it ideal for determining the relative contribution of each predictor elith et al 2008 franklin 2010 generalized linear models based on generalized multiple linear regression also accommodate non linear relationships through use of the link function in which predictors can be transformed based on response data distribution austin and cunningham 1981 franklin 2010 margules et al 1987 we used the logit distribution binary response or presence absence to determine significance of each predictor prior to building sdms we performed preliminary analyses to ensure only predictors that added to the explanatory power of the models and did not add to the overall deviance were used in each sdm this included the use of a priori gradient boosting machine gbm analyses and step wise regression variable dropping and selection for each model and time period we also performed time fixed effects fe regression analysis to identify any significant effects between years in occurrence response to predictor variables there was no significant effect in verdin occurrence response to predictor variables between years p 0 79 thus eliminating the need to separate data per year or accommodate for time fe in sdms occurrence data were pooled for the 2015 and 2016 breeding seasons 2 5 model evaluation we evaluated performance of each model using the area under the receiver operator curve auroc or auc and true sensitivity statistic tss the auc range from 0 to 1 is a measure of rank correlation in unbiased data a higher auc value indicates that areas with high predicted suitability values tend to be sites of known presence phillips et al 2006 the tss is an approach based on maximizing the sum of sensitivity and specificity independent of species prevalence liu et al 2013 many distributional model evaluation approaches e g kappa are threshold dependent a value above a user set threshold indicates a prediction of presence and a value below the threshold indicates absence however different models assign different weight to false absences or false presences making it hard to compare models directly the tss is considered an alternative to the traditionally used kappa to assess model performance since it has the advantage of being threshold and prevalence independent 3 results we recorded a total of 981 occurrences of verdin throughout the 2015 and 2016 breeding seasons 351 during the early breeding period april through mid may 322 during the peak breeding period mid may through mid june and 308 during the late breeding period mid june through mid july we also recorded a total of 788 occurences of cactus wren throughout the 2015 and 2016 breeding seasons 332 during the early breeding period 278 during the peak breeding period and 178 during the late breeding period estimated cactus wren densities ranged from 0 06 to 2 9 individuals per 200 m2 of the three algorithms used random forest rf produced the highest predictive performance sdms for all three breeding periods table 2 boosted regression tree brt produced the lowest performing model overall for the early breeding period both in terms of predictive power auc 0 60 0 63 with and without cactus wren density included a predictor respectively and model sensitivity tss 0 02 0 15 with and without cactus wren density included as predictor respectively all models improved in both predictive power δ auc 0 01 0 10 and model sensitivity δ tss 0 09 0 66 with the inclusion of cactus wren density as a predictor of verdin presence table 2 however magnitude of improvement in model performance varied by breeding period during the early breeding period april through mid may sdms that included cactus wren density as a predictor performed only slightly better than those that included environmental features alone maxent δ auc 0 02 δ tss 0 09 brt δ auc 0 03 δ tss 0 17 rf δ auc 0 01 δ tss 0 24 sdms that included cactus wren density as a predictor for the peak breeding season mid may through mid june as opposed to those including environmental features only produced larger increases in model performance relative to the early breeding period maxent δ auc 0 09 δ tss 0 20 brt δ auc 0 06 δ tss 0 25 rf δ auc 0 10 δ tss 0 08 sdms built for the late breeding period mid june through mid july produced similar yet less pronounced improvements in performance for models that included cactus wren density as a predictor as opposed to environmental features alone maxent δ auc 0 05 δ tss 0 66 brt δ auc 0 04 δ tss 0 15 rf δ auc 0 10 δ tss 0 14 water proximity was the most influential feature in predicting verdin presence during the early breeding period fig 1 verdin presence during the peak breeding season was most influenced by cactus wren density and green biomass represented by the osavi cactus wren density and green biomass remained influential in the late breeding period however shrub density and cactus spp coverage also became influential predictors for verdin presence 4 discussion our findings indicate inclusion of a biotic relationship into a traditional sdm framework improves model predictive power and model sensitivity incorporating these biotic interactions as well as their temporal trends is essential in efforts to monitor or conserve bird species with similar nesting ecologies ecologists should not only consider the environmental requirements for species persistence but also the presence of conspecifics with which they are known to interact during various life history stages e g fledging periods nest site selection or initiation modeling algorithms that can accommodate complex non linear relationships e g random forest should be preferred in sdm development and application random forest routinely outperforms other machine learning and linear algorithms both in our study and others involving non normal data distribution and complex predictor interactions breiman 2001 mi et al 2014 prasad et al 2006 although our objective was not to thoroughly examine interactions between these two bird species our results demonstrate how sdms can be used to investigate potential competitive interactions between animal species for example cactus wren density had a significant negative influence on the distribution of verdin during the peak mid may through mid june and late mid june through mid july breeding season however cactus wren density was not a negatively correlated predictor for verdin presence during the early breeding season april through mid may this may have biologically meaningful implications for understanding how these two conspecifics interact during nest site selection more specifically this suggests that optimal nest site selection may not necessarily be the source of the observed competition pressure observational studies suggest that cactus wren usurp conspecific nests in an effort to maximize predator free nest space mcgee 1985 simons and simons 1990 our findings support this assertion as the potential source of competitive pressure since verdin presence was not negatively affected by cactus wren density until after the initial breeding period further predation is the primary cause of nest failure in birds so it is reasonable to expect species able to minimize predation pressure will have a substantial competitive advantage davis 2017 newton 1994 it is imperative we include such biotic relationships as well as their temporal components in the modelling framework for accurate sdms biosketch the focus of our research is improving distribution models by incorporating complex biotic interactions through the use of various algorithms data transformation and generation and remotely sensed imagery data we continue to investigate new ways to include temporal influence and biotic relationships into a traditional predictive modeling framework to create more accurate and inclusive species distribution models data accessibility all environmental gis layers and remotely sensed imagery generated for this study are available as raster grids from the joint national aeronautics and space administration nasa and u s geological survey usgs database for landsat imagery data at landsat usgs gov climate data generated for this study are available as band interleaved by line formatted imagery convertible for raster grids from the prism climate group database at prism oregonstate edu acknowledgment we offer our gratitude to the east foundation for their generous funding and access to the san antonio viejo ranch as well as the many field technicians that aided in the ground surveys this is manuscript number 037 of the east foundation appendix a we collected vegetation composition and structure data from 141 permanent 20 m transects in october 2016 we allocated transects proportional to the area of ecological sites that occur in each pasture using stratified sampling resulting in 12 16 transects per pasture bonham 2013 we marked each transect start and collected data in a random predetermined direction n s e w on each transect we sampled 5 20 50 cm quadrats 5 m spacing randomly placed at either 0 0 5 1 1 5 2 or 2 5 m from the left side of the tape and facing away from the transect start visually recording percent cover of woody and herbaceous later classified by grass spp in each quadrat we also documented woody canopy cover along each of the 20 m transects by visually recording the amount of the ground in centimeters covered by woody plant materials leaves and branches and succulent cacti that intercepted the line transect by species canfield 1941 higgins et al 1996 if a gap in the canopy exceeded 0 5 m for an individual we recorded separate cover measurements we calculated percent canopy cover by summing the intercept measurements for an individual species dividing by total line length and converting to a cover percentage we calculated total percent cover by adding cover percentages for all species which sometimes exceeded 100 when overlapping canopies by different species were recorded coulloudon et al 1999 locations of water sources e g livestock wells within the study site were provided by the east foundation to calculate water proximity we gridded the spatial extent of the sav ranch into a fishnet 30 m2 resolution we performed a proximity analysis on each pixel centroid using the near tool in arcmap 10 5 to determine distance of each centroid to location of nearest water source usually a livestock well and holding tank as no natural surface water exists within the study site and very little exists on the coastal sand plain region of texas as a whole snelgrove et al 2013 we made considerations for seasonality as not all groundwater pumps are operational year round on large south texas cattle ranches and ensured only those wells known to be active during the summer of 2015 and 2016 were used in the analysis we imported values for each predictor canopy height shrub density water proximity grass spp coverage and cacti spp coverage into arcmap 10 5 and used kriging interpolation to minimize spatial sampling bias and create continuous surface layers of environmental predictor values kriging is a geostatistical method through which interpolated values are modeled by a gaussian process governed by covariances this method of spatial interpolation estimates a continuous surface of values directly based on values at surrounding points weighted according to spatial covariance van beers and kleijnen 2004 the kriging interpolation algorithm is optimal for most eco spatial modeling because it produces an unbiased prediction and calculates the spatial distribution of uncertainty allowing for an accurate estimate of error at any particular point mahmoudabadi and briggs 2016 we then calculated the mean values for each predictor within the 2015 and 2016 study periods using the raster algebra tool in arcmap 10 5 we acquired one landsat 8 oli tile 6 cloud cover that encompassed the study area courtesy of u s geological survey for each year 2015 and 2016 and processed this in envi 5 1 nasa landsat program 2015 2016 we corrected for atmospheric conditions and converted the original image format of digital numbers dn to radiance and then surface reflectance we first resized the images to the rectangular extent of the sav and then extracted by the study area mask in esri arcgis arcmap 10 5 we then spatially subset each extracted image by bands 2 5 corresponding to landsat 8 oli band designations blue green red and nir bands were stacked and the osavi was calculated using the band math tool in envi 5 1 for each image this index for lai follows the standard formula nir red nir red 0 16 and uses a reflectance constant of 0 16 to adjust for high background reflectance e g areas with sparse vegetation and high soil reflectance rondeaux et al 1996 in south texas specifically this vegetation index outperforms other more common vegetation indices e g normalized difference vegetation index ndvi in both overall image classification accuracy and herbaceous coverage estimations fern et al 2018 we calculated the mean osavi values for the 2015 and 2016 study periods using the raster algebra tool in arcmap 10 5 
25011,aim complex biotic interactions are notably excluded from species distribution models sdms as they are often difficult to quantify and accommodate in a traditional modeling framework especially those with a temporal component the territorial nature of breeding cactus wren is well documented and typically involves nest usurping i e destruction of conspecifics due to their similar nesting ecology breeding verdin are frequently the target of such behavior and are often forced to move or abandon nests using the verdin cactus wren system as a case study our goal was to evaluate the performance of sdms that include only environmental predictors with sdms that also include biotic relationships as predictors location east foundation s san antonio viejo ranch in south texas methods we built sdms maxent boosted regression tree brt and random forest rf to project verdin distribution during the early april through mid may peak mid may through mid june and late mid june through mid july breeding periods using occurrence data collected during the 2015 and 2016 breeding seasons we ran parallel analyses using relevant environmental features alone as predictors and then environmental features with observed cactus wren density results random forest rf produced the highest predictive performance sdms for all three breeding periods auc 0 81 0 99 tss 0 23 0 73 all models improved in predictive power δ auc 0 01 0 10 and model sensitivity δ tss 0 09 0 66 with the inclusion of cactus wren density as a predictor of verdin presence main conclusions our results indicate that sdm performance is improved by the inclusion of biotic relationships as predictors incorporating biotic interactions as well as their temporal trends is essential in efforts to monitor or conserve bird species with similar nesting ecologies further modeling algorithms that can accommodate complex non linear relationships e g random forest should be preferred in sdm development and application keywords biotic interactions birds cactus wren competition nesting species distribution model predation verdin 1 introduction traditionally species distribution models sdms which statistically associate a species occurrence with a suite of geospatial predictors use resource variables resources that the animal consumes or requires to persist in an area e g shrub density water availability to define and project a species niche and distribution austin and niel 2011 elith and leathwick 2009 indirect variables which are features the animal does not consume or require for persistence but with which it may still interact e g competition or predation are often not included in sdms due to the difficulty in identifying the variable ecologically quantifying the relationship or in managing collinearity issues adding an interaction factor to a traditional sdm framework may contribute austin and niel 2011 however recent advances in machine learning algorithms e g random forest have enabled us to include indirect variables or biotic relationships such as competitive exclusion in sdms miller 2010 complex biotic interactions are notably excluded from sdms as they are often difficult to quantify and accommodate in a traditional modeling framework especially those with a temporal component i e an interaction or relationship that changes through time in this study we use the ecological relationships between two bird species as a case study of the potential value of incorporating biotic interactions into sdms competition between sympatric species often include contest for limited resources e g territory food mates in birds availability of nesting space or materials presents a unique competitive challenge in that the degree of contest between species has a temporal aspect namely the breeding seasons for example competition for nest sites is often observed in sympatric bird species with similar nesting ecology that would otherwise partition resources the remainder of the year martin 1993 macarthur 1958 inferior competitors are then frequently pushed to alternative nest sites that may be more vulnerable to predation or exposure newton 1994 one such example is the relationship between breeding cactus wren campylorhynchus brunneicapillus a large 32 47 g territorial wren native to the desert southwestern united states and verdin auriparus flaviceps a small 5 8 g penduline tit native to the southwestern united states and northern mexico anderson and anderson 1973 lockwood and freeman 2004 williamson 2000 most of the year the disparity in size and general morphology of these two species allows for territorial and food resource partitioning anderson and anderson 1973 wise gervais 2005 however both the cactus wren and verdin prefer areas of dense cholla cacti opuntia spp for nesting but will also utilize palo verde cercidium spp large mottes of mixed cacti and other spiny plants anderson and anderson 1973 wise gervais 2005 the territorial nature of breeding cactus wren is well documented and typically involves nest usurping i e destruction with the verdin frequently the target of such behavior and are often forced to retreat to alternative nest sites mcgee 1985 simons and simons 1990 our main objective was to evaluate the performance of sdms that include only environmental predictors with sdms that also include biotic relationships as predictors more specifically as a proof of concept we evaluated the ability of sdms of verdin that included only environmental predictors with sdms that also included the density of cactus wren as a predictor we also evaluated the ability of sdms incorporating cactus wren to detect differences in the relative influence of this biotic predictor among early peak and late portions of the verdin breeding season 2 methods 2 1 study site we conducted our study on the east foundation s 61 000 ha san antonio viejo ranch sav located approximately 25 km south of hebbronville texas in jim hogg and starr counties sav is located within the south texas plains ecoregion and is one of six properties of the east foundation that are managed as a living laboratory to support wildlife conservation and other public benefits of ranching and private land stewardship vegetation composition and structure within our study area is characteristic of this ecoregion and consists of a mosaic of grassland and thornscrub sav is representative of south texas rangeland ecosystems and encompasses the coastal sand plain and texas tamulipan thronscrub ecoregions low growing woody plants dense shrubs prosopis glandulosa acacia greggii celtis ehrenbergiana colubrina texensis aloysia gratissima lantana urticoides and cacti opuntia engelmannii var lindheimeri opuntia leptocaulis dominate the vegetation in this area mean annual temperature within our study site is 22 6 c and mean annual precipitation is 502 5 mm prism climate group 2018 mean monthly temperature during our study period april july 2015 and 2016 was 27 2 c with a maximum daily high of 32 8 c prism climate group 2018 mean monthly precipitation during our study period was 77 1 mm with a maximum daily high of 93 1 mm prism climate group 2018 2 2 environmental predictors we used canopy height shrub density water proximity grass spp coverage and cacti spp coverage recorded from ground surveys as well as local topographic relief and an optimized soil adjusted vegetation index osavi calculated using remotely sensed imagery in 2015 and 2016 as environmental predictors in sdms specific workflow and processing details for each environmental predictor can be found in appendix a 2 3 bird occurrence data avian point counts consisted of 25 12 point transects arranged in a stratified random design across sav stratified by vegetation type each transect was surveyed 3 times throughout the breeding season first visit between april and mid may second visit between mid may and mid june and third visit between mid june and mid july we used point count data collected from april to july 2015 and 2016 to build baseline sdms each point was located 400 m apart and 2 observers recorded visual and auditory occurrences of birds within 200 m of each point simultaneously yet independently we used a traditional framework in which each occurrence was counted as a presence record at each point omitting the duplicate records from the double observer design and resampling the data by a 200 m cell size this granted us a finer spatial resolution of the data set to thoroughly investigate the influence of conspecific cactus wren density on the presence of verdin cactus wren density was calculated using observed abundance at each transect point divided by the total space surveyed 200 m2 we used the occurrence of verdin and the calculated density of cactus wren during the breeding seasons of 2015 and 2016 for sdms 2 4 data processing and analysis we exported the rasters of all predictors as geotiffs and read these into the r statistical language as raster layers r core team 2013 all layers were stacked to create the occurrence predictor stack for sdms parallel analyses were also performed by time period within the breeding season early april through mid may peak mid may through mid june and late mid june through mid july to investigate temporal changes in cactus wren influence on verdin distribution bird occurrence data were subset by season we imported occurrence data for verdin into r and used the predictor raster stack to build sdms using three different algorithms maxent boosted regression tree brt and random forest rf table 1 outlines the basic mathematical approach of each modeling algorithm and provides a comparison of the advantages of each model in the occupancy framework we generated background data to produce the non presence class required by the logistic models background data do not attempt to guess at absence locations but instead are used to characterize the study region phillips and elith 2011 phillips et al 2009 ward et al 2009 background data represent the environmental domain of the study and are independent of occurrence data while presence data establish the conditions under which a species is more likely to be present than a null or completely random model would predict after building baseline sdms we added the raster representing cactus wren density to the occurrence predictor raster stack and re ran the models to assess any improvement or degradation in the predictive performance and sensitivity of each algorithm for each breeding period we also calculated relative influence and significance of each predictor using a mixed model approach we calculated relative influence of each predictor on verdin presence using a brt analysis and the significance of highly influential variables through logit generalized linear regression analyses the brt has the unique advantage to accommodate collinearity among predictors and fit complex nonlinear relationships between response and predictor variables making it ideal for determining the relative contribution of each predictor elith et al 2008 franklin 2010 generalized linear models based on generalized multiple linear regression also accommodate non linear relationships through use of the link function in which predictors can be transformed based on response data distribution austin and cunningham 1981 franklin 2010 margules et al 1987 we used the logit distribution binary response or presence absence to determine significance of each predictor prior to building sdms we performed preliminary analyses to ensure only predictors that added to the explanatory power of the models and did not add to the overall deviance were used in each sdm this included the use of a priori gradient boosting machine gbm analyses and step wise regression variable dropping and selection for each model and time period we also performed time fixed effects fe regression analysis to identify any significant effects between years in occurrence response to predictor variables there was no significant effect in verdin occurrence response to predictor variables between years p 0 79 thus eliminating the need to separate data per year or accommodate for time fe in sdms occurrence data were pooled for the 2015 and 2016 breeding seasons 2 5 model evaluation we evaluated performance of each model using the area under the receiver operator curve auroc or auc and true sensitivity statistic tss the auc range from 0 to 1 is a measure of rank correlation in unbiased data a higher auc value indicates that areas with high predicted suitability values tend to be sites of known presence phillips et al 2006 the tss is an approach based on maximizing the sum of sensitivity and specificity independent of species prevalence liu et al 2013 many distributional model evaluation approaches e g kappa are threshold dependent a value above a user set threshold indicates a prediction of presence and a value below the threshold indicates absence however different models assign different weight to false absences or false presences making it hard to compare models directly the tss is considered an alternative to the traditionally used kappa to assess model performance since it has the advantage of being threshold and prevalence independent 3 results we recorded a total of 981 occurrences of verdin throughout the 2015 and 2016 breeding seasons 351 during the early breeding period april through mid may 322 during the peak breeding period mid may through mid june and 308 during the late breeding period mid june through mid july we also recorded a total of 788 occurences of cactus wren throughout the 2015 and 2016 breeding seasons 332 during the early breeding period 278 during the peak breeding period and 178 during the late breeding period estimated cactus wren densities ranged from 0 06 to 2 9 individuals per 200 m2 of the three algorithms used random forest rf produced the highest predictive performance sdms for all three breeding periods table 2 boosted regression tree brt produced the lowest performing model overall for the early breeding period both in terms of predictive power auc 0 60 0 63 with and without cactus wren density included a predictor respectively and model sensitivity tss 0 02 0 15 with and without cactus wren density included as predictor respectively all models improved in both predictive power δ auc 0 01 0 10 and model sensitivity δ tss 0 09 0 66 with the inclusion of cactus wren density as a predictor of verdin presence table 2 however magnitude of improvement in model performance varied by breeding period during the early breeding period april through mid may sdms that included cactus wren density as a predictor performed only slightly better than those that included environmental features alone maxent δ auc 0 02 δ tss 0 09 brt δ auc 0 03 δ tss 0 17 rf δ auc 0 01 δ tss 0 24 sdms that included cactus wren density as a predictor for the peak breeding season mid may through mid june as opposed to those including environmental features only produced larger increases in model performance relative to the early breeding period maxent δ auc 0 09 δ tss 0 20 brt δ auc 0 06 δ tss 0 25 rf δ auc 0 10 δ tss 0 08 sdms built for the late breeding period mid june through mid july produced similar yet less pronounced improvements in performance for models that included cactus wren density as a predictor as opposed to environmental features alone maxent δ auc 0 05 δ tss 0 66 brt δ auc 0 04 δ tss 0 15 rf δ auc 0 10 δ tss 0 14 water proximity was the most influential feature in predicting verdin presence during the early breeding period fig 1 verdin presence during the peak breeding season was most influenced by cactus wren density and green biomass represented by the osavi cactus wren density and green biomass remained influential in the late breeding period however shrub density and cactus spp coverage also became influential predictors for verdin presence 4 discussion our findings indicate inclusion of a biotic relationship into a traditional sdm framework improves model predictive power and model sensitivity incorporating these biotic interactions as well as their temporal trends is essential in efforts to monitor or conserve bird species with similar nesting ecologies ecologists should not only consider the environmental requirements for species persistence but also the presence of conspecifics with which they are known to interact during various life history stages e g fledging periods nest site selection or initiation modeling algorithms that can accommodate complex non linear relationships e g random forest should be preferred in sdm development and application random forest routinely outperforms other machine learning and linear algorithms both in our study and others involving non normal data distribution and complex predictor interactions breiman 2001 mi et al 2014 prasad et al 2006 although our objective was not to thoroughly examine interactions between these two bird species our results demonstrate how sdms can be used to investigate potential competitive interactions between animal species for example cactus wren density had a significant negative influence on the distribution of verdin during the peak mid may through mid june and late mid june through mid july breeding season however cactus wren density was not a negatively correlated predictor for verdin presence during the early breeding season april through mid may this may have biologically meaningful implications for understanding how these two conspecifics interact during nest site selection more specifically this suggests that optimal nest site selection may not necessarily be the source of the observed competition pressure observational studies suggest that cactus wren usurp conspecific nests in an effort to maximize predator free nest space mcgee 1985 simons and simons 1990 our findings support this assertion as the potential source of competitive pressure since verdin presence was not negatively affected by cactus wren density until after the initial breeding period further predation is the primary cause of nest failure in birds so it is reasonable to expect species able to minimize predation pressure will have a substantial competitive advantage davis 2017 newton 1994 it is imperative we include such biotic relationships as well as their temporal components in the modelling framework for accurate sdms biosketch the focus of our research is improving distribution models by incorporating complex biotic interactions through the use of various algorithms data transformation and generation and remotely sensed imagery data we continue to investigate new ways to include temporal influence and biotic relationships into a traditional predictive modeling framework to create more accurate and inclusive species distribution models data accessibility all environmental gis layers and remotely sensed imagery generated for this study are available as raster grids from the joint national aeronautics and space administration nasa and u s geological survey usgs database for landsat imagery data at landsat usgs gov climate data generated for this study are available as band interleaved by line formatted imagery convertible for raster grids from the prism climate group database at prism oregonstate edu acknowledgment we offer our gratitude to the east foundation for their generous funding and access to the san antonio viejo ranch as well as the many field technicians that aided in the ground surveys this is manuscript number 037 of the east foundation appendix a we collected vegetation composition and structure data from 141 permanent 20 m transects in october 2016 we allocated transects proportional to the area of ecological sites that occur in each pasture using stratified sampling resulting in 12 16 transects per pasture bonham 2013 we marked each transect start and collected data in a random predetermined direction n s e w on each transect we sampled 5 20 50 cm quadrats 5 m spacing randomly placed at either 0 0 5 1 1 5 2 or 2 5 m from the left side of the tape and facing away from the transect start visually recording percent cover of woody and herbaceous later classified by grass spp in each quadrat we also documented woody canopy cover along each of the 20 m transects by visually recording the amount of the ground in centimeters covered by woody plant materials leaves and branches and succulent cacti that intercepted the line transect by species canfield 1941 higgins et al 1996 if a gap in the canopy exceeded 0 5 m for an individual we recorded separate cover measurements we calculated percent canopy cover by summing the intercept measurements for an individual species dividing by total line length and converting to a cover percentage we calculated total percent cover by adding cover percentages for all species which sometimes exceeded 100 when overlapping canopies by different species were recorded coulloudon et al 1999 locations of water sources e g livestock wells within the study site were provided by the east foundation to calculate water proximity we gridded the spatial extent of the sav ranch into a fishnet 30 m2 resolution we performed a proximity analysis on each pixel centroid using the near tool in arcmap 10 5 to determine distance of each centroid to location of nearest water source usually a livestock well and holding tank as no natural surface water exists within the study site and very little exists on the coastal sand plain region of texas as a whole snelgrove et al 2013 we made considerations for seasonality as not all groundwater pumps are operational year round on large south texas cattle ranches and ensured only those wells known to be active during the summer of 2015 and 2016 were used in the analysis we imported values for each predictor canopy height shrub density water proximity grass spp coverage and cacti spp coverage into arcmap 10 5 and used kriging interpolation to minimize spatial sampling bias and create continuous surface layers of environmental predictor values kriging is a geostatistical method through which interpolated values are modeled by a gaussian process governed by covariances this method of spatial interpolation estimates a continuous surface of values directly based on values at surrounding points weighted according to spatial covariance van beers and kleijnen 2004 the kriging interpolation algorithm is optimal for most eco spatial modeling because it produces an unbiased prediction and calculates the spatial distribution of uncertainty allowing for an accurate estimate of error at any particular point mahmoudabadi and briggs 2016 we then calculated the mean values for each predictor within the 2015 and 2016 study periods using the raster algebra tool in arcmap 10 5 we acquired one landsat 8 oli tile 6 cloud cover that encompassed the study area courtesy of u s geological survey for each year 2015 and 2016 and processed this in envi 5 1 nasa landsat program 2015 2016 we corrected for atmospheric conditions and converted the original image format of digital numbers dn to radiance and then surface reflectance we first resized the images to the rectangular extent of the sav and then extracted by the study area mask in esri arcgis arcmap 10 5 we then spatially subset each extracted image by bands 2 5 corresponding to landsat 8 oli band designations blue green red and nir bands were stacked and the osavi was calculated using the band math tool in envi 5 1 for each image this index for lai follows the standard formula nir red nir red 0 16 and uses a reflectance constant of 0 16 to adjust for high background reflectance e g areas with sparse vegetation and high soil reflectance rondeaux et al 1996 in south texas specifically this vegetation index outperforms other more common vegetation indices e g normalized difference vegetation index ndvi in both overall image classification accuracy and herbaceous coverage estimations fern et al 2018 we calculated the mean osavi values for the 2015 and 2016 study periods using the raster algebra tool in arcmap 10 5 
25012,phytoplankton species are among the most abundant and diverse organisms in marine ecosystems and are highly sensitive to physical chemical variable changes so they show high spatial and temporal variability related to environmental changes this study applied generalized additive models gam to describe the effect of environmental factors on abundance of four phytoplankton genera recorded in a small coastal water body of northwestern mexico the most influential variables in order of importance were sea surface temperature chlorophyll a concentration ph salinity and dissolved oxygen predictions of the gam suggested that abundance had strong spatial and seasonal variability abundance of tripos and gymnodinium was higher in spring apr jun and lower in summer jul sep prorocentrum was higher in autumn oct dec and lower in winter jan mar pseudo nitzschia was higher in winter and lower in autumn the approach in this study represents one of the first efforts to use species distribution models sdm in phytoplankton communities using high spatial resolution environmental factors that derived from landsat imagery therefore this technique could be a useful tool with the potential to transform environmental monitoring and serve as a valuable resource in the study and application of management strategies in a wide range of activities in coastal environments such as aquaculture fisheries and public health keywords species distribution models phytoplankton coastal environment landsat 8 generalized additive models 1 introduction in the marine ecosystem phytoplankton plays an important role as the main source of a food web that contributes to the world s main fishery resources however our limited quantitative understanding of global distribution and abundance of most groups hinders the ability to incorporate phytoplankton diversity into various studies or applications to understand their contribution to ecosystem functioning flombaum et al 2013 consequently information on community and composition spatiotemporal variability is necessary to understand ecological and biogeochemical functions mcclain 2009 the community structure composition and diversity of phytoplankton species are determined by several environmental factors such as temperature salinity ph nitrate nitrite ammonia silicates phosphorus and so on madhu et al 2007 vajravelu et al 2018 wang et al 2014 however phytoplankton species can be very sensitive to small changes in their environment responding quickly to variations of one or more environmental factors and exhibiting a differential effect on distribution and abundance of many species in this context knowledge of the environmental factors that modulate spatial distribution and abundance of phytoplankton species and communities is an essential requirement to understand the mechanisms and processes that influence the domain of a given population within ecosystems reiss et al 2011 smayda and reynolds 2001 these requirements have frequently been addressed with fragmented information on species and habitats mainly in marine environments where information is more difficult to control thus the regression method is a widely used tool to make quantitative predictions of species distributions austin 2007 reiss et al 2011 species distribution models sdm are widely used in ecology to describe geographical distribution of the species and their environmental preferences and they have been applied in marine environments for several organisms such as phytoplankton barton et al 2016 irwin et al 2012 jensen et al 2017 krug et al 2018 sdm have evolved from the application of simple linear models to more complex methods they have increased the number of studies comparing performance and prediction models by multiple methods demonstrating that it is possible to provide reliable spatial and temporal predictions grenouillet et al 2011 jensen et al 2017 this study modeled spatiotemporal distribution of abundance and environmental preferences of four phytoplankton genera that formed algal proliferations using generalized additive models gam since environmental factors that derived from landsat imagery in gam were used seasonal distribution maps of four phytoplankton genera were predicted with high spatial resolution 30 m in a small coastal body located in northwestern mexico the methodology applied in this study could be used to describe habitat preferences of phytoplankton communities and develop a monitoring program for detecting algal proliferation events in other parts of the world 2 method 2 1 study area the study area is located within the bahía de la paz on the western coast of the state of baja california sur mexico between 24 09 and 24 47 n and 110 45 and 110 18 w fig 1 it is a coastal water body of about 90 km long and 60 km wide with 4500 km2 and two water mouths that connect it with the western region of the gulf of california the main water mouth is wide with a depth of 300 m and located to the northwest while the one to the east small mouth or the san lorenzo canal is narrow and shallow associated with 20 m deep channels álvarez arellano et al 1997 the ensenada de la paz is a coastal lagoon located in the southern part of the bahía de la paz between 24 06 and 24 11 n and 110 19 and 110 25 w it is a protected coastal water body separated from the bahía de la paz by a sandy barrier of marine origin called el mogote approximately 11 km long in east westward direction and 2 7 km in its widest part cervantes duarte and guerrero godínez 1987 the ensenada de la paz has 12 km in length 5 km in width and an area of 45 km2 with respect to sea level average morphologically speaking the water mouth is formed by two parallel channels in their connection with the bahía de la paz of approximately 4 km in length and 0 6 km in width in total with an average depth of 7 0 m jiménez illescas et al 2008 2 2 conceptual modeling approach fig 2 summarizes the methodology applied in this study we used environmental data collected in situ and landsat 8 imagery to estimate environmental data with high spatial resolution 30 m derived from landsat 8 imagery using multiple linear regression models environmental models were validated splitting data into training and test datasets using in situ collected environmental and phytoplankton data during a year of monitoring 2016 2017 model development gam and validation was carried out to describe the effects of environmental variables on phytoplankton abundance finally the best fitted model for each genus and environmental factors derived from landsat imagery were used to describe spatiotemporal variability of each phytoplankton group analyzed 2 3 field data collection twelve field campaigns were performed over one year of monitoring from august 2016 to july 2017 field trips were not performed in some dates of the period of study due to bad weather the in situ data collection was synchronized with the overpass of the landsat 8 satellite which crosses this zone every 16 days at approximately 17 47 utc a total of 55 stations were sampled in nearshore waters in the bahia de la paz fig 1 environmental parameters such as sea surface temperature sst chlorophyll a chl a salinity sal ph and dissolved oxygen concentration do were measured near the surface 50 cm depth with the multiparameter sensor rbr master model xrx 420 rbr ltd ottawa can 2 4 identification of phytoplankton plankton samples n 55 were obtained in surface waters by horizontal trawls for 60 s at approximately 1 m s speed boat thus every trawl was covering a distance of approximately 60 m with a 20 μm mesh light size and preserved in lugol solution for further analysis qualitative and quantitative analyses of phytoplankton were carried out using an olympus bx43 olympus corp tokyo jp microscope with magnifications of 20 and 40 phytoplankton quantification was performed using a sedgewick rafter counting chamber and phytoplankton species were identified at the lowest possible level using taxonomic guides balech 1988 kofoid and swezy 1921 licea et al 1995 moreno et al 1996 round et al 1990 tomas 1996 the total number of cells of each genus present in 1 ml of sample was estimated with the following formula 1 n c 1000 s where n is the total number of phytoplankton cells c e l m l 1 c is the number of counted cells in 1 ml and s is the number of grids counted 150 to obtain cellular abundance the volume of filtered water was estimated by means of formula 2 and subsequently abundance was estimated by formula 3 sournia 1978 transformed to cel l 1 2 v 1 a d f c where v1 is volume of filtered water by plankton net during the towed a is mouth area of the mesh 0 0025 m2 d is the distance the plankton net was towed approximately 60 m and fc is filtration coefficient 0 9 ratio of the volume of water passed through the net in relation to the volume of water which would pass if there were no resistance to water flow 3 a b u n d a n c e n v 2 v 1 v 3 where n is the total number of phytoplankton cells c e l m l 1 v1 is volume of filtered water by plankton net during the tow v2 is the volume of the sample collected in the net bucket container situated at the cod end of the plankton net where the phytoplankton is deposited 150 ml and v3 is an aliquot of 1 ml of the sample for counting in sedgwick rafter chamber 2 5 landsat the landsat 8 level 1 data products used in this study were included in the landsat 8 oli tirs c1 level 1 data set and downloaded from the us geological survey server usgs https www usgs gov using earth explorer platform https earthexplorer usgs gov landsat 8 has two sensors onboard operational land imager oli and thermal infrared sensor tirs in total these sensors had 11 spectral bands nine of the oli sensor and two of the tirs sensor the spatial resolution of bands 1 7 and 9 was 30 m band 8 panchromatic was 15 m and 100 m for bands 10 11 table 1 the study area was in the landsat id scene lc08 l1tp 034043 path 34 row 43 the images were acquired from 2016 06 05 to 2017 05 23 and only were those without cloud cover selected and cropped to highlight the study area fig 1 landsat 8 images were imported and processed with the raster library hijmans 2018 from programming language r r core team 2018 version 3 5 1 to obtain water pixel remote sensing reflectance of each one of the selected bands which was calculated by using the equations in landsat 8 user manual zanter 2015 2 6 environmental factors derived from landsat imagery environmental factors were estimated from landsat 8 using multiple regression models mrm where response variables were seawater parameters chl a do ph sal and sst measured in situ and predictor variables were spectral bands of landsat 8 table 1 best fitted mrm table 2 were constructed using forward stepwise selection which began with a model containing no predictors null model and then adding them to the model one at a time until the best predictors were in the best fitted model a best fitted model is defined as the model with the highest adjusted r2 adj r2 and the lowest akaike information criterion aic zuur et al 2007 the environmental factors on the study area for the period 2013 to 2018 were predicted with the best fitted mrm with the spatial seasonal predictions winter jan mar spring may jun summer jul sep autumn oct dec averages of environmental factors were computed with a spatial resolution of 30 m 2 7 phytoplankton model development and validation this study used generalized additives models gam to describe the relationship between predictor sst chl a sal ph and do and response variables estimated abundance of selected genera gam was used because this method can describe complex and non linear relationships between response and predictor variables since response variables are integer and positive the family of error distribution used in gam was poisson with log as link function thus avoiding negative values when predicting relative abundance of each genus the level of smoothing i e number of basis k in smoothing functions for each predictor variable was restricted to 4 to avoid overfitting statistical modeling was performed in programming language r r core team 2018 for gam using mgcv library wood 2017 the forward approach was used to select the best fitted model for each single genus which consisted of building the null model the overall mean then adding a single predictor variable and evaluating if its contribution was significant to the new model contribution of the predictor variable was evaluated with the adj r2 and the aic to evaluate predictive performance of the models in situ collected data was split in two datasets training and testing the training dataset 75 was used to build the model and test dataset 25 to evaluate the predictive performance of the model with the correlation coefficient r obtained by comparing the observed and predicted values and root mean square error rmse the models with the highest values of r and the lowest values of rmse were selected as the best models once validated the full dataset was used to build the models that described the relationship between response and predictor variables to describe the effects of predictor variables on response variable we used effect plots in these plots response variable was on the scale of the linear predictor variables 2 8 spatiotemporal variability of phytoplankton abundance to describe spatiotemporal variability of phytoplankton abundance in the study area the spatial distribution of each phytoplankton group was predicted using the best fitted gam for each one and the seasonal average of environmental factors for the period 2013 2018 3 results 3 1 environmental variables fig 3 shows seasonal variability of the environmental parameters measured in situ during the period of study where sst showed a well defined seasonal pattern that ranged from 18 91 c in winter to 30 13 c in summer salinity varied little among seasons with minimum values of 34 99 and maximum of 37 97 in spring with no seasonal differences the ph ranged from 7 58 in summer to 8 29 in spring with differences observed between seasons do ranged from 3 63 to 12 83 m g l 1 with minimum values during summer and maximum during winter finally chl a showed relatively low values that ranged from 0 136 to 2 714 μ g l 1 values were higher during summer while the lowest ones were reported in winter without seasonal variations 3 2 species composition of phytoplankton a total of 86 phytoplankton species were identified during the study period representing five classes bacillariophyceae 56 8 dinophyceae 34 1 cyanophyceae 4 5 spirotrichea 2 3 and chrysophyceae 2 3 the most representative genera were protoperidinium rhizosolenia tripos prorocentrum chaetoceros pleurosigma and navicula where chaetoceros was the most frequent in all seasons the composition of phytoplankton species was more diverse during spring of which dinoflagellates were the most dominant group fig 4 3 3 model goodness of fit table 3 shows the best fitted model for each phytoplankton group the order of the predictor variables was defined considering the contribution of each single predictor variable thus the most influential predictor variable was added to the null model in the first step the results indicated that the best fitted gam were those that included all environmental factors table 3 the highest values of adjusted r2 were obtained for the gymnodinium 0 99 and pseudo nitzschia 0 96 genera as well as deviance values greater than 80 on the other hand the models constructed for the genera prorocentrum and tripos showed the values of adj r2 and the lowest ones explained deviance of the data 60 5 and 63 8 respectively 3 4 environmental preferences of phytoplankton the response plots of gam fig 5 were used to describe the relationships between response phytoplankton abundance and predictor variables environmental factors the highest abundance of tripos was expected to occur in waters with sst from 22 to 28 c low chl a values 1 μg l 1 low sal values 35 5 psu ph from 7 5 to 8 1 and low do 4 5 mg l 1 fig 5a for prorocentrum the highest abundance was expected to occur in waters with sst from 24 to 29 c ph from 7 7 to 8 1 sal from 35 5 to 37 psu high do 4 5 mg l 1 and low chl a values 0 5 μg l 1 fig 5b the highest relative abundance of pseudo nitzschia was expected to occur in waters with low ph values 7 7 low sal 36 5 psu chl a from 0 5 to 2 μg l 1 do from 4 5 to 5 5 mg l 1 and low sst 24 c fig 5c finally the highest abundance of gymnodinium was expected to occur in waters with high chl a 1 μg l 1 sst from 22 to 26 c sal from 35 to 36 5 psu high ph values 7 8 and do lower than 5 5 fig 5d 3 5 spatial prediction of phytoplankton fig 6 represents the seasonal distribution patterns estimated for each genus analyzed at a spatial resolution of 30 m the results indicated that tripos was present throughout the year showing higher abundances from autumn to spring with values from 250 to 1000 cell 1 mainly in the offshore region of the bahía de la paz where the highest values were recorded likewise during summer the presence of this genus decreased fig 6a the seasonal distribution patterns estimated for prorocentrum suggested that suitable environmental conditions for their presence would occur from spring to autumn and increase during summer in the offshore region the highest relative abundances were recorded during autumn in the coastal zone fig 6b the seasonal distribution patterns estimated for pseudo nitzschia suggested that suitable environmental conditions for the presence of this genus occurred from winter to summer with an offshore distribution during winter and spring months on the other hand during summer the distribution area decreased and high abundance values were recorded in coastal areas mainly in the channel and the transition zone between the cove and the bahía de la paz fig 6c with respect to the genus gymnodinium fig 6d shows the estimated seasonal distribution patterns where the results suggested that suitable environmental conditions for the presence of this genus occurred from autumn to spring in autumn high probabilities of occurrence were observed within the ensenada whereas a mainly coastal distribution was observed in winter finally the distribution area increased throughout the study area during spring recording the highest concentrations of abundance in the region known as el mogote and the interior of the ensenada 4 discussion 4 1 spatial prediction phytoplankton studies have been performed for over several decades in the gulf of california see gárate lizárraga 2013 gárate lizárraga et al 2006 where the seasonal structure of the phytoplankton community has been associated with upwelling and water mixing layers martínez lópez et al 2001 reporting main genera such as dinoflagellates diatoms raphidophytes cyanobacteria and coccolithophores which agree with the main genus recorded in this study fig 4 despite the large number of studies on phytoplankton in the bahía de la paz very few of them analyze the effect of environmental variables on probable distribution of each species the results obtained from spatial and temporal predictions for the genus prorocentrum indicated that its presence was observed from spring to autumn with the highest probability of occurrence in autumn these results were consistent with the main reports of the proliferation events that have been recorded for the gulf of california where the highest abundances for species of the genus prorocentrum p minimum p lima p rhathymum and p dentatum p micans and p gracile were found associated with temperature values from 23 5 to 33 c and salinities from 28 to 40 from the end of summer and during autumn cortés altamirano and agraz 1994 gárate lizárraga and martínez lópez 1997 sierra beltrán et al 2005 these value ranges were similar to those observed in the charts of partial effects fig 5b sst 24 28 c sal 35 37 where a negative correlation was observed as described by sierra beltrán et al 2005 according to the results the optimal ph values were within a range from 7 6 to 8 nonetheless the smoothed form of the curve suggested an intertwined relationship with the rest of the variables which could give us a higher range of values because previous studies have shown that prorocentrum species have a tolerance to high ph values 9 and this adaptation helps in competition over other species pedersen and hansen 2003 sierra beltrán et al 2005 the spatial and temporal predictions of pseudo nitzschia indicated that the presence of this genus in the bahía de la paz occurred mainly from winter to summer with the highest presence probability during summer these results were supported by literature reports of proliferation events which started from january to july in the gulf of california gárate lizárraga et al 2013 lópez cortés et al 2015 sierra beltrán et al 1997 likewise rivera vilarelle et al 2013 found similar results in the central mexican pacific where the maximum diversity and abundance were observed during spring tending to decrease in autumn the model predicted that suitable environmental conditions for the presence of this genus were when sst was low 20 c and a negative correlation existed with this variable fig 5c these data obtained were similar to those previously published for the gulf of california where sst values were reported in a range from 18 to 19 c during a proliferation event when sst increased 27 28c a decline in abundance was observed gárate lizárraga et al 2007 lópez cortés et al 2015 rivera vilarelle et al 2013 in addition these results also agreed with studies reported in different parts of the world which recorded pseudo nitzschia abundances associated with low temperature high salinity trainer et al 2012 2000 and low ph values lundholm et al 2004 based on the results of the gam models for the genus gymnodinium five variables were strong predictors for modeling spatial and temporal distribution of this genus fig 5d our results predicted that suitable environmental conditions for the presence of this genus were when sst was in a range from 20 to 26 c a similar pattern was observed during various proliferation events in the gulf of california where temperatures were recorded in a range from 19 to 26 c gárate lizárraga et al 2004a garcía hernández et al 2005 hernández sandoval et al 2009 lópez cortés et al 2011 this range of values has also been reported from various areas of the mexican pacific mee et al 1986 on the other hand some discrepancies were observed comparing the results in this study and some variables recorded in the literature some studies have reported a range of salinity from 34 to 38 garcía hernández et al 2005 graham 1943 high concentrations of do 2 10 garcía hernández et al 2005 hernández sandoval et al 2009 and chl a from 2 to 7 mg m 3 gárate lizárraga et al 2009 lópez cortés et al 2011 the spatial and temporal predictions of the genus gymnodinium indicated that the presence of this genus in the bahía de la paz occurred from autumn to winter observing the highest presence probability in spring these results were consistent with the main reports of proliferation events for the study area particularly with gárate lizárraga et al 2004b b who monitored the bahía de la paz for one year recording gymnodinium catenatum in five months october and december autumn march winter and april and june spring 5 conclusions the results obtained in this study from the gam and environmental factors estimated from satellite images with high spatial resolution seem to be a promising technique for describing the spatiotemporal variability of phytoplankton at microscale 30 m in coastal water bodies the smd applied to the main phytoplankton genera suggested that the community structure of phytoplankton in the bahía de la paz was defined by predictable seasonal changes the variations in the community were explained significantly by the environmental variables which offer the possibility of detecting changes in response to these environmental variables in most models the variables that provided the most significant information and governed their spatial and temporal distributions were in order of importance sst chl a ph salt and do the results suggested that the environmental conditions obtained from gam were adequate to predict the presence of opportunistic species starting to proliferate by dominating others nevertheless it cannot be affirmed that each of the values were optimal for a proliferation event since when gam were applied the variables were intertwined and very likely the response of the organisms was associated with some other effect related to these variables limitations still exist when using remote sensing tools for the study of algal proliferation events mainly due to the ephemeral nature of these events nevertheless the approach applied in this study represents one of the first efforts to use mds in phytoplankton communities with high spatial resolution environmental factors derived from landsat imagery therefore this technique could be a useful tool with the potential to transform environmental monitoring and serve as a valuable resource in the study and application of management strategies in a wide range of activities in coastal environments such as aquaculture fisheries and public health future goals for this research study include more field data as well as the analysis of historical satellite data to reconstruct and study previous events understand the seasonality and or interannual variability of phytoplankton enable the model to detect the genera studied more precisely and many others that were not included in this research funding this study was supported by conacyt pd cpn 213849 that also provided a scholarship to the first author mamh the funder had no role in study design data collection and analysis decision to prepare or publish the manuscript credit authorship contribution statement miguel ángel matus hernández conceptualization formal analysis methodology writing original draft raúl octavio martínez rincón conceptualization formal analysis methodology supervision writing original draft rosa judith aviña hernández conceptualization formal analysis methodology writing original draft norma yolanda hernández saavedra conceptualization funding acquisition project administration supervision writing original draft acknowledgments the authors thank mario cota castro for help provided during sampling survey and diana fischer for editing and improving english quality of this manuscript first author would like to thank consejo nacional de ciencia y tecnología conacyt for the scholarship provided 
25012,phytoplankton species are among the most abundant and diverse organisms in marine ecosystems and are highly sensitive to physical chemical variable changes so they show high spatial and temporal variability related to environmental changes this study applied generalized additive models gam to describe the effect of environmental factors on abundance of four phytoplankton genera recorded in a small coastal water body of northwestern mexico the most influential variables in order of importance were sea surface temperature chlorophyll a concentration ph salinity and dissolved oxygen predictions of the gam suggested that abundance had strong spatial and seasonal variability abundance of tripos and gymnodinium was higher in spring apr jun and lower in summer jul sep prorocentrum was higher in autumn oct dec and lower in winter jan mar pseudo nitzschia was higher in winter and lower in autumn the approach in this study represents one of the first efforts to use species distribution models sdm in phytoplankton communities using high spatial resolution environmental factors that derived from landsat imagery therefore this technique could be a useful tool with the potential to transform environmental monitoring and serve as a valuable resource in the study and application of management strategies in a wide range of activities in coastal environments such as aquaculture fisheries and public health keywords species distribution models phytoplankton coastal environment landsat 8 generalized additive models 1 introduction in the marine ecosystem phytoplankton plays an important role as the main source of a food web that contributes to the world s main fishery resources however our limited quantitative understanding of global distribution and abundance of most groups hinders the ability to incorporate phytoplankton diversity into various studies or applications to understand their contribution to ecosystem functioning flombaum et al 2013 consequently information on community and composition spatiotemporal variability is necessary to understand ecological and biogeochemical functions mcclain 2009 the community structure composition and diversity of phytoplankton species are determined by several environmental factors such as temperature salinity ph nitrate nitrite ammonia silicates phosphorus and so on madhu et al 2007 vajravelu et al 2018 wang et al 2014 however phytoplankton species can be very sensitive to small changes in their environment responding quickly to variations of one or more environmental factors and exhibiting a differential effect on distribution and abundance of many species in this context knowledge of the environmental factors that modulate spatial distribution and abundance of phytoplankton species and communities is an essential requirement to understand the mechanisms and processes that influence the domain of a given population within ecosystems reiss et al 2011 smayda and reynolds 2001 these requirements have frequently been addressed with fragmented information on species and habitats mainly in marine environments where information is more difficult to control thus the regression method is a widely used tool to make quantitative predictions of species distributions austin 2007 reiss et al 2011 species distribution models sdm are widely used in ecology to describe geographical distribution of the species and their environmental preferences and they have been applied in marine environments for several organisms such as phytoplankton barton et al 2016 irwin et al 2012 jensen et al 2017 krug et al 2018 sdm have evolved from the application of simple linear models to more complex methods they have increased the number of studies comparing performance and prediction models by multiple methods demonstrating that it is possible to provide reliable spatial and temporal predictions grenouillet et al 2011 jensen et al 2017 this study modeled spatiotemporal distribution of abundance and environmental preferences of four phytoplankton genera that formed algal proliferations using generalized additive models gam since environmental factors that derived from landsat imagery in gam were used seasonal distribution maps of four phytoplankton genera were predicted with high spatial resolution 30 m in a small coastal body located in northwestern mexico the methodology applied in this study could be used to describe habitat preferences of phytoplankton communities and develop a monitoring program for detecting algal proliferation events in other parts of the world 2 method 2 1 study area the study area is located within the bahía de la paz on the western coast of the state of baja california sur mexico between 24 09 and 24 47 n and 110 45 and 110 18 w fig 1 it is a coastal water body of about 90 km long and 60 km wide with 4500 km2 and two water mouths that connect it with the western region of the gulf of california the main water mouth is wide with a depth of 300 m and located to the northwest while the one to the east small mouth or the san lorenzo canal is narrow and shallow associated with 20 m deep channels álvarez arellano et al 1997 the ensenada de la paz is a coastal lagoon located in the southern part of the bahía de la paz between 24 06 and 24 11 n and 110 19 and 110 25 w it is a protected coastal water body separated from the bahía de la paz by a sandy barrier of marine origin called el mogote approximately 11 km long in east westward direction and 2 7 km in its widest part cervantes duarte and guerrero godínez 1987 the ensenada de la paz has 12 km in length 5 km in width and an area of 45 km2 with respect to sea level average morphologically speaking the water mouth is formed by two parallel channels in their connection with the bahía de la paz of approximately 4 km in length and 0 6 km in width in total with an average depth of 7 0 m jiménez illescas et al 2008 2 2 conceptual modeling approach fig 2 summarizes the methodology applied in this study we used environmental data collected in situ and landsat 8 imagery to estimate environmental data with high spatial resolution 30 m derived from landsat 8 imagery using multiple linear regression models environmental models were validated splitting data into training and test datasets using in situ collected environmental and phytoplankton data during a year of monitoring 2016 2017 model development gam and validation was carried out to describe the effects of environmental variables on phytoplankton abundance finally the best fitted model for each genus and environmental factors derived from landsat imagery were used to describe spatiotemporal variability of each phytoplankton group analyzed 2 3 field data collection twelve field campaigns were performed over one year of monitoring from august 2016 to july 2017 field trips were not performed in some dates of the period of study due to bad weather the in situ data collection was synchronized with the overpass of the landsat 8 satellite which crosses this zone every 16 days at approximately 17 47 utc a total of 55 stations were sampled in nearshore waters in the bahia de la paz fig 1 environmental parameters such as sea surface temperature sst chlorophyll a chl a salinity sal ph and dissolved oxygen concentration do were measured near the surface 50 cm depth with the multiparameter sensor rbr master model xrx 420 rbr ltd ottawa can 2 4 identification of phytoplankton plankton samples n 55 were obtained in surface waters by horizontal trawls for 60 s at approximately 1 m s speed boat thus every trawl was covering a distance of approximately 60 m with a 20 μm mesh light size and preserved in lugol solution for further analysis qualitative and quantitative analyses of phytoplankton were carried out using an olympus bx43 olympus corp tokyo jp microscope with magnifications of 20 and 40 phytoplankton quantification was performed using a sedgewick rafter counting chamber and phytoplankton species were identified at the lowest possible level using taxonomic guides balech 1988 kofoid and swezy 1921 licea et al 1995 moreno et al 1996 round et al 1990 tomas 1996 the total number of cells of each genus present in 1 ml of sample was estimated with the following formula 1 n c 1000 s where n is the total number of phytoplankton cells c e l m l 1 c is the number of counted cells in 1 ml and s is the number of grids counted 150 to obtain cellular abundance the volume of filtered water was estimated by means of formula 2 and subsequently abundance was estimated by formula 3 sournia 1978 transformed to cel l 1 2 v 1 a d f c where v1 is volume of filtered water by plankton net during the towed a is mouth area of the mesh 0 0025 m2 d is the distance the plankton net was towed approximately 60 m and fc is filtration coefficient 0 9 ratio of the volume of water passed through the net in relation to the volume of water which would pass if there were no resistance to water flow 3 a b u n d a n c e n v 2 v 1 v 3 where n is the total number of phytoplankton cells c e l m l 1 v1 is volume of filtered water by plankton net during the tow v2 is the volume of the sample collected in the net bucket container situated at the cod end of the plankton net where the phytoplankton is deposited 150 ml and v3 is an aliquot of 1 ml of the sample for counting in sedgwick rafter chamber 2 5 landsat the landsat 8 level 1 data products used in this study were included in the landsat 8 oli tirs c1 level 1 data set and downloaded from the us geological survey server usgs https www usgs gov using earth explorer platform https earthexplorer usgs gov landsat 8 has two sensors onboard operational land imager oli and thermal infrared sensor tirs in total these sensors had 11 spectral bands nine of the oli sensor and two of the tirs sensor the spatial resolution of bands 1 7 and 9 was 30 m band 8 panchromatic was 15 m and 100 m for bands 10 11 table 1 the study area was in the landsat id scene lc08 l1tp 034043 path 34 row 43 the images were acquired from 2016 06 05 to 2017 05 23 and only were those without cloud cover selected and cropped to highlight the study area fig 1 landsat 8 images were imported and processed with the raster library hijmans 2018 from programming language r r core team 2018 version 3 5 1 to obtain water pixel remote sensing reflectance of each one of the selected bands which was calculated by using the equations in landsat 8 user manual zanter 2015 2 6 environmental factors derived from landsat imagery environmental factors were estimated from landsat 8 using multiple regression models mrm where response variables were seawater parameters chl a do ph sal and sst measured in situ and predictor variables were spectral bands of landsat 8 table 1 best fitted mrm table 2 were constructed using forward stepwise selection which began with a model containing no predictors null model and then adding them to the model one at a time until the best predictors were in the best fitted model a best fitted model is defined as the model with the highest adjusted r2 adj r2 and the lowest akaike information criterion aic zuur et al 2007 the environmental factors on the study area for the period 2013 to 2018 were predicted with the best fitted mrm with the spatial seasonal predictions winter jan mar spring may jun summer jul sep autumn oct dec averages of environmental factors were computed with a spatial resolution of 30 m 2 7 phytoplankton model development and validation this study used generalized additives models gam to describe the relationship between predictor sst chl a sal ph and do and response variables estimated abundance of selected genera gam was used because this method can describe complex and non linear relationships between response and predictor variables since response variables are integer and positive the family of error distribution used in gam was poisson with log as link function thus avoiding negative values when predicting relative abundance of each genus the level of smoothing i e number of basis k in smoothing functions for each predictor variable was restricted to 4 to avoid overfitting statistical modeling was performed in programming language r r core team 2018 for gam using mgcv library wood 2017 the forward approach was used to select the best fitted model for each single genus which consisted of building the null model the overall mean then adding a single predictor variable and evaluating if its contribution was significant to the new model contribution of the predictor variable was evaluated with the adj r2 and the aic to evaluate predictive performance of the models in situ collected data was split in two datasets training and testing the training dataset 75 was used to build the model and test dataset 25 to evaluate the predictive performance of the model with the correlation coefficient r obtained by comparing the observed and predicted values and root mean square error rmse the models with the highest values of r and the lowest values of rmse were selected as the best models once validated the full dataset was used to build the models that described the relationship between response and predictor variables to describe the effects of predictor variables on response variable we used effect plots in these plots response variable was on the scale of the linear predictor variables 2 8 spatiotemporal variability of phytoplankton abundance to describe spatiotemporal variability of phytoplankton abundance in the study area the spatial distribution of each phytoplankton group was predicted using the best fitted gam for each one and the seasonal average of environmental factors for the period 2013 2018 3 results 3 1 environmental variables fig 3 shows seasonal variability of the environmental parameters measured in situ during the period of study where sst showed a well defined seasonal pattern that ranged from 18 91 c in winter to 30 13 c in summer salinity varied little among seasons with minimum values of 34 99 and maximum of 37 97 in spring with no seasonal differences the ph ranged from 7 58 in summer to 8 29 in spring with differences observed between seasons do ranged from 3 63 to 12 83 m g l 1 with minimum values during summer and maximum during winter finally chl a showed relatively low values that ranged from 0 136 to 2 714 μ g l 1 values were higher during summer while the lowest ones were reported in winter without seasonal variations 3 2 species composition of phytoplankton a total of 86 phytoplankton species were identified during the study period representing five classes bacillariophyceae 56 8 dinophyceae 34 1 cyanophyceae 4 5 spirotrichea 2 3 and chrysophyceae 2 3 the most representative genera were protoperidinium rhizosolenia tripos prorocentrum chaetoceros pleurosigma and navicula where chaetoceros was the most frequent in all seasons the composition of phytoplankton species was more diverse during spring of which dinoflagellates were the most dominant group fig 4 3 3 model goodness of fit table 3 shows the best fitted model for each phytoplankton group the order of the predictor variables was defined considering the contribution of each single predictor variable thus the most influential predictor variable was added to the null model in the first step the results indicated that the best fitted gam were those that included all environmental factors table 3 the highest values of adjusted r2 were obtained for the gymnodinium 0 99 and pseudo nitzschia 0 96 genera as well as deviance values greater than 80 on the other hand the models constructed for the genera prorocentrum and tripos showed the values of adj r2 and the lowest ones explained deviance of the data 60 5 and 63 8 respectively 3 4 environmental preferences of phytoplankton the response plots of gam fig 5 were used to describe the relationships between response phytoplankton abundance and predictor variables environmental factors the highest abundance of tripos was expected to occur in waters with sst from 22 to 28 c low chl a values 1 μg l 1 low sal values 35 5 psu ph from 7 5 to 8 1 and low do 4 5 mg l 1 fig 5a for prorocentrum the highest abundance was expected to occur in waters with sst from 24 to 29 c ph from 7 7 to 8 1 sal from 35 5 to 37 psu high do 4 5 mg l 1 and low chl a values 0 5 μg l 1 fig 5b the highest relative abundance of pseudo nitzschia was expected to occur in waters with low ph values 7 7 low sal 36 5 psu chl a from 0 5 to 2 μg l 1 do from 4 5 to 5 5 mg l 1 and low sst 24 c fig 5c finally the highest abundance of gymnodinium was expected to occur in waters with high chl a 1 μg l 1 sst from 22 to 26 c sal from 35 to 36 5 psu high ph values 7 8 and do lower than 5 5 fig 5d 3 5 spatial prediction of phytoplankton fig 6 represents the seasonal distribution patterns estimated for each genus analyzed at a spatial resolution of 30 m the results indicated that tripos was present throughout the year showing higher abundances from autumn to spring with values from 250 to 1000 cell 1 mainly in the offshore region of the bahía de la paz where the highest values were recorded likewise during summer the presence of this genus decreased fig 6a the seasonal distribution patterns estimated for prorocentrum suggested that suitable environmental conditions for their presence would occur from spring to autumn and increase during summer in the offshore region the highest relative abundances were recorded during autumn in the coastal zone fig 6b the seasonal distribution patterns estimated for pseudo nitzschia suggested that suitable environmental conditions for the presence of this genus occurred from winter to summer with an offshore distribution during winter and spring months on the other hand during summer the distribution area decreased and high abundance values were recorded in coastal areas mainly in the channel and the transition zone between the cove and the bahía de la paz fig 6c with respect to the genus gymnodinium fig 6d shows the estimated seasonal distribution patterns where the results suggested that suitable environmental conditions for the presence of this genus occurred from autumn to spring in autumn high probabilities of occurrence were observed within the ensenada whereas a mainly coastal distribution was observed in winter finally the distribution area increased throughout the study area during spring recording the highest concentrations of abundance in the region known as el mogote and the interior of the ensenada 4 discussion 4 1 spatial prediction phytoplankton studies have been performed for over several decades in the gulf of california see gárate lizárraga 2013 gárate lizárraga et al 2006 where the seasonal structure of the phytoplankton community has been associated with upwelling and water mixing layers martínez lópez et al 2001 reporting main genera such as dinoflagellates diatoms raphidophytes cyanobacteria and coccolithophores which agree with the main genus recorded in this study fig 4 despite the large number of studies on phytoplankton in the bahía de la paz very few of them analyze the effect of environmental variables on probable distribution of each species the results obtained from spatial and temporal predictions for the genus prorocentrum indicated that its presence was observed from spring to autumn with the highest probability of occurrence in autumn these results were consistent with the main reports of the proliferation events that have been recorded for the gulf of california where the highest abundances for species of the genus prorocentrum p minimum p lima p rhathymum and p dentatum p micans and p gracile were found associated with temperature values from 23 5 to 33 c and salinities from 28 to 40 from the end of summer and during autumn cortés altamirano and agraz 1994 gárate lizárraga and martínez lópez 1997 sierra beltrán et al 2005 these value ranges were similar to those observed in the charts of partial effects fig 5b sst 24 28 c sal 35 37 where a negative correlation was observed as described by sierra beltrán et al 2005 according to the results the optimal ph values were within a range from 7 6 to 8 nonetheless the smoothed form of the curve suggested an intertwined relationship with the rest of the variables which could give us a higher range of values because previous studies have shown that prorocentrum species have a tolerance to high ph values 9 and this adaptation helps in competition over other species pedersen and hansen 2003 sierra beltrán et al 2005 the spatial and temporal predictions of pseudo nitzschia indicated that the presence of this genus in the bahía de la paz occurred mainly from winter to summer with the highest presence probability during summer these results were supported by literature reports of proliferation events which started from january to july in the gulf of california gárate lizárraga et al 2013 lópez cortés et al 2015 sierra beltrán et al 1997 likewise rivera vilarelle et al 2013 found similar results in the central mexican pacific where the maximum diversity and abundance were observed during spring tending to decrease in autumn the model predicted that suitable environmental conditions for the presence of this genus were when sst was low 20 c and a negative correlation existed with this variable fig 5c these data obtained were similar to those previously published for the gulf of california where sst values were reported in a range from 18 to 19 c during a proliferation event when sst increased 27 28c a decline in abundance was observed gárate lizárraga et al 2007 lópez cortés et al 2015 rivera vilarelle et al 2013 in addition these results also agreed with studies reported in different parts of the world which recorded pseudo nitzschia abundances associated with low temperature high salinity trainer et al 2012 2000 and low ph values lundholm et al 2004 based on the results of the gam models for the genus gymnodinium five variables were strong predictors for modeling spatial and temporal distribution of this genus fig 5d our results predicted that suitable environmental conditions for the presence of this genus were when sst was in a range from 20 to 26 c a similar pattern was observed during various proliferation events in the gulf of california where temperatures were recorded in a range from 19 to 26 c gárate lizárraga et al 2004a garcía hernández et al 2005 hernández sandoval et al 2009 lópez cortés et al 2011 this range of values has also been reported from various areas of the mexican pacific mee et al 1986 on the other hand some discrepancies were observed comparing the results in this study and some variables recorded in the literature some studies have reported a range of salinity from 34 to 38 garcía hernández et al 2005 graham 1943 high concentrations of do 2 10 garcía hernández et al 2005 hernández sandoval et al 2009 and chl a from 2 to 7 mg m 3 gárate lizárraga et al 2009 lópez cortés et al 2011 the spatial and temporal predictions of the genus gymnodinium indicated that the presence of this genus in the bahía de la paz occurred from autumn to winter observing the highest presence probability in spring these results were consistent with the main reports of proliferation events for the study area particularly with gárate lizárraga et al 2004b b who monitored the bahía de la paz for one year recording gymnodinium catenatum in five months october and december autumn march winter and april and june spring 5 conclusions the results obtained in this study from the gam and environmental factors estimated from satellite images with high spatial resolution seem to be a promising technique for describing the spatiotemporal variability of phytoplankton at microscale 30 m in coastal water bodies the smd applied to the main phytoplankton genera suggested that the community structure of phytoplankton in the bahía de la paz was defined by predictable seasonal changes the variations in the community were explained significantly by the environmental variables which offer the possibility of detecting changes in response to these environmental variables in most models the variables that provided the most significant information and governed their spatial and temporal distributions were in order of importance sst chl a ph salt and do the results suggested that the environmental conditions obtained from gam were adequate to predict the presence of opportunistic species starting to proliferate by dominating others nevertheless it cannot be affirmed that each of the values were optimal for a proliferation event since when gam were applied the variables were intertwined and very likely the response of the organisms was associated with some other effect related to these variables limitations still exist when using remote sensing tools for the study of algal proliferation events mainly due to the ephemeral nature of these events nevertheless the approach applied in this study represents one of the first efforts to use mds in phytoplankton communities with high spatial resolution environmental factors derived from landsat imagery therefore this technique could be a useful tool with the potential to transform environmental monitoring and serve as a valuable resource in the study and application of management strategies in a wide range of activities in coastal environments such as aquaculture fisheries and public health future goals for this research study include more field data as well as the analysis of historical satellite data to reconstruct and study previous events understand the seasonality and or interannual variability of phytoplankton enable the model to detect the genera studied more precisely and many others that were not included in this research funding this study was supported by conacyt pd cpn 213849 that also provided a scholarship to the first author mamh the funder had no role in study design data collection and analysis decision to prepare or publish the manuscript credit authorship contribution statement miguel ángel matus hernández conceptualization formal analysis methodology writing original draft raúl octavio martínez rincón conceptualization formal analysis methodology supervision writing original draft rosa judith aviña hernández conceptualization formal analysis methodology writing original draft norma yolanda hernández saavedra conceptualization funding acquisition project administration supervision writing original draft acknowledgments the authors thank mario cota castro for help provided during sampling survey and diana fischer for editing and improving english quality of this manuscript first author would like to thank consejo nacional de ciencia y tecnología conacyt for the scholarship provided 
25013,the different methodological tools for ecological homologation are commonly based around the controversial inference of the species fundamental niche coming from its effective niche this being considered the medium in which the species lives bounded by the quantification of a set of environmental variables parameters that define it the methodologies and models developed in this field are generally aimed at evaluating the suitability homologation of a species for a given site based on its proximity to the observed range of variation associated with its optimal ecological response this usually means the center of gravity the centroid of the point cloud etc in contrast little research has been directed towards developing methodologies which fix the reference at the limit values of the recorded variation range and which define the conditions of ecological marginality at site scale conditions of species marginality with respect to the physical environment threaten its establishment development and perpetuation and therefore its ecological stability based on the hypothesis that these conditions of marginality are focused on the edges of the parametric hypervolume that defines the fundamental niche of each species a set of indicators has been designed to evaluate the degree of ecological marginality of a given site in terms of the specific species requirements the application of the model to study episodes of vegetative decline in aleppo pine stands has produced ecologically coherent results showing a satisfactory capacity to identify the most important site aspects influencing the observed ecological behavior it is therefore an easily implemented transparent white box model methodological tool providing a valuable means to explore the key characteristics of complex relationships between species and the physical environment in which they are found keywords ecological niche ecological marginality parametric autoecology ecological instability physical environment aleppo pine 1 introduction the set of environmental requirements of species as defined by hutchinson 1957 from the niche conception postulated by grinnell in 1917 are included in the notion of the ecological niche which is a central concept in the wider field of autoecology austin 2002 guisan and thuiller 2005 soberón and peterson 2005 over the natural range of a species the interaction of biotic and abiotic factors generates a complex pattern of more or less suitable environments which in any case have allowed the species to maintain a viable population that is one which is capable of subsisting without immigration pulliam 2000 sexton et al 2009 abeli et al 2014 hence the ecological niche corresponds to the volume within the environmental space defined by the range of variation in the environmental variables that allows a positive population growth hirzel and lay 2008 suitability models can be considered operational applications of this ecological niche idea since they generally use environmental variables to predict the presence absence or abundance of a species over a given study area mateo et al 2011 this approach to biogeography and ecology at species level has been among the most widely discussed topics in ecological literature over recent decades araujo and peterson 2012 reviews of various studies that relate habitat suitability models to ecological niche theory can be found in guisan and zimmermann 2000 elith et al 2006 hirzel and lay 2008 or araujo and peterson 2012 these models adopt the general thesis that the best indicator of the environmental requirements of a given species is its current distribution guisan and zimmermann 2000 pearson and dawson 2003 the suitability therefore is given by the mathematical or statistical relationship between the known real distribution and a set of independent variables that are used as explanatory variables ecogeographic variables in the case of hirzel et al 2002 especially climatic and topographical variables while the edaphic information is often ignored thuiller 2013 due to the large amount of work involved and the economic cost of the sampling and analysis once this relationship is identified it is possible to obtain a value for each place that is usually interpreted as the probability of species presence at that point although in reality the value only indicates the environmental similarity homologation of each location to the areas where that species is currently present the probability of presence as a measure of environmental similarity should therefore be interpreted rather as a value indicating the degree of suitability of a location for the development of the species mateo et al 2011 in many cases the evaluation of the suitability homologation of a site for a given species is based on its proximity to the observed range of values associated with an optimal ecological response of the species usually according to the proximity of the center of gravity or the centroid of the corresponding point cloud soberón et al 2017 in contrast conditions that are not optimal for the ecological status of the species and which make up the environmental space associated with the idea of environmental marginality have received much less attention in particular the condition of marginality is not a specifically defined attribute the study of which has mainly been addressed through species distribution models while scarce research has been directed towards ecological niche models the difference between the two types of model can be explained by hutchinson s duality 1957 correspondence between the geographic space occupied by a species and the abstract multi dimensional niche space with which it is associated guisan and zimmermann 2000 soberón and peterson 2005 soberón et al 2017 in this way it is possible to distinguish two types of marginality geographic marginality determined by the spatial position of a population at the edge of its natural distribution and an ecological marginality which arises in environmental niche spaces of areas which are ecologically different in terms of the optimal conditions and consequently the populations display signs of ecological restriction to a greater or lesser extent as regards geographical marginality the abundant center hypothesis postulates that the population abundance of a species is greater at the center of its geographic distribution and decreases towards the limits where the context for peripheral populations differs from that of optimal ecological conditions for the species sagarin and gaines 2002 sexton et al 2009 populations at the edge tend to be smaller less dense and have lower genetic diversity than central populations abeli et al 2014 this hypothesis has been the focus of continuous debate since the 1980s essentially because empirical studies have revealed unequal patterns pironon et al 2014 coro et al 2016 papuga et al 2018 other approaches to determining geographic marginality are those based on the relative occurrence area hirzel et al 2002 define marginality as the ecological distance between the species optimum and the average habitat within the reference area this estimate of the degree of deviation of the conditions inhabited by the species from the average environmental conditions of the region studied is directly related to geographic marginality the use of this conceptualization of marginality highlights the effect of the extension occupied in the model results which is caused by the autocorrelated spatial structure of nature dormann et al 2007 jiménez valverde et al 2008 as the distribution area depends on a high heterogeneous number of factors more than those that define the fundamental niche of the species soberón et al 2017 geographic marginality does not correspond entirely with ecological marginality de medeiros et al 2018 in addition the species performance is not necessarily better at the center of its geographical distribution but rather in areas with optimum environmental conditions or those that present greater environmental stability over time abeli et al 2014 the differences in ecological niche conditions between peripheral and central populations have received less empirical attention than the previously mentioned issues pironon et al 2014 so approaches to define and explicitly evaluate ecological marginality are particularly scarce hence ecological marginality focuses on the proximity to the edges of the environmental space that defines the niche niche envelope at these limits the ecophysiological stability growth of the populations of the species decreases to the point where it becomes nil theoretically the null net growth isocline then defines the niche shape in such a way that beyond it the mortality rates exceed the birth rates mainly as a consequence of inadequate habitat and interspecific competition hirzel and lay 2008 recent research concerning methods for the identification of hypervolume shapes and sizes can be found in swanson et al 2015 blonder et al 2017 or junker et al 2016 in the case of plant species the diversity of the environmental factors involved and the complexity of their interactions make the delineation of their ecological niche a sensitive issue pulliam 2000 in the main the research into plant species over recent decades has focused on the identification of the climatic niche at continental or regional scale thus by not using the appropriate scale to identify the precise fundamental niche of the plants miller and hobbs 2007 information is not provided on how fine scale population processes can vary within the boundaries of the environmental niche and what the ecological significance of it is there is an evident need to develop site scale modeling that allows sufficiently explicit descriptions to be made of the set of resources and environmental conditions which permit the establishment growth and reproduction of plants papuga et al 2018 within this challenge marginality is presented as an attribute of undoubted ecological significance as it compromises the ecological stability at a given site hence it is of particular interest to develop new modeling initiatives that facilitate evaluation and promote the ecological interpretation of this marginality in this paper the concepts ideas and hypotheses underlying the model developed for this purpose are presented describing the mathematical development of the model and providing an example of its application to a singular situation of vegetative decline observed in an aleppo pine stand 2 methods there is no precise definition of ecological marginality from the postulates of the ecological niche theory it can be considered as those environmental spaces physical environment in which a population or individual displays a high degree of ecophysiological restrictions these restrictions lead to a decrease in growth and reproduction rates which leads to difficulty in achieving effective establishment positive population growth 2 1 underlying assumptions and limitations in order to perform the evaluation the starting hypothesis is that the condition of marginality occurs in spaces of the environmental hypervolume defined by values that are generally distant from the ecological optimum considering that this optimum corresponds to the environment of the center of gravity or to the cloud centroid of observation points delimiting the environmental space of a species no possible internal marginalities caused by the presence of holes in the hypervolume blonder et al 2017 are assumed within the environmental niche the marginality addressed being exclusively that associated with proximity to the edges of the realized niche of each species specific environmental coordinates locate a given site at a specific distance from the edge of the environmental hypervolume that is assumed invariant the physiological tolerances inherited from the species to the environmental factors are conserved that is the fundamental niche does not change in the temporal spatial framework considered araujo and peterson 2012 in turn for plant species it is assumed that they are in a state of pseudo equilibrium with the environment where the change is slow in relation to the span of the biota austin 2002 guisan and thuiller 2005 in this way a static geometric model is sufficient to describe the environmental hypervolume if it is assumed that there is independence from the biotic context and it is accepted that it is the abiotic conditions that impose physiological limits on the ability of the species to persist at a given site soberón and peterson 2005 the basic information is the range of variation recorded for each component variable or parameters that make up the n dimensional environmental space of a specific species the hypervolume assumes that the n axes that define the system are fixed represent continuous variables necessary to work within the definition of a euclidean hyperspace and all contribute independently and equally to the metrics that characterize it euclidean distances and volumes these fundamental assumptions which arise from mathematics are relevant to the definition of a hypervolume since they highlight the conceptual limitations that are important in determining the relevance and applicability of hypervolumes for any particular question blonder 2018 it is further assumed that the data represent the fundamental niche of the species defined by simple independent limits on each axis it is therefore acceptable according to blonder 2018 to fit a range box model without the need to directly delineate a geometric shape within the range observed for a given parameter potential hypervolume axis the condition of marginality begins beyond a certain value threshold value this condition is expected to grow as it moves away from said value towards the limit slowly at first and reaching the highest rates of change at the observed limit value of the parameter once this is exceeded marginality decreases progressively finally reaching extreme conditions which are incompatible with the viable presence of the species the mathematical translation of this behavior is a 4 parameter logistic curve upper asymptote of value 1 lower asymptote of value 0 mid range point at the limit value and growth parameter as that which allows the greater proportion of the marginality variation to be concentrated in the central third of the variation range in which the parameter presents marginality using this approach the range of variation of marginality cannot be restricted to the difference between the limit and the corresponding threshold this makes it necessary to extend a range equivalent to said difference beyond the limit values in this way it is possible to identify two types of marginality a higher marginality centered around the highest observed value of the parameter upper limit and a lower marginality which uses the minimum value observed lower limit as a reference point for both marginalities the range of marginality variation is defined by twice the difference between the limit and the corresponding threshold centered on the limit fig 1 the identification of the corresponding threshold values which delimit the conditions of centrality and marginality is based on the use of percentiles gandullo and sánchez 1994 booth et al 2014 junker et al 2016 in this case a dominant unimodal behavior and not necessarily gaussian is assumed in the ecophysiological response curves to environmental gradients in plant species oksanen and minchin 2002 rydgren et al 2003 thus the condition of marginality in the observed range is focused on the lowest 10 of values in the range of variation lower marginality or the highest 10 of values higher marginality of each parameter consequently marginality corresponds to 20 of the recorded extreme values with the 10 percentile marking the lower threshold while the 90 percentile sets the upper threshold it is usual for the characterization of the environmental requirements of a given species to be done by collecting very varied parametric information which includes variables that show different degrees of dependence among them and that are often redundant in their ecophysiological significance according to hirzel and lay 2008 this circumstance means that it is desirable to group the parameters in conceptually and metrically related groups i e parameters of thermal regime rainfall regime etc thus for a given season the condition of species marginality is considered to result from the evaluation of a set of environmental attributes that have proven ecophysiological significance the selection of which parameters best evaluate these attributes depends above all on the ecology of the species in question and the available environmental information thus the set of parameters that characterize the environmental hypervolume of a species must be reclassified using expert knowledge guisan and zimmermann 2000 hirzel and lay 2008 variables parameters must be identified and estimated for each of the groups defined in order to generate a known and relatively homogenous ecophysiological incidence with sufficiently similar metrics thus favoring their ecological interpretation to avoid the expected effect of high multicollinearity and redundancy only the variable with values furthest from the ecological optimum will be considered for each group as with liebig s law of minimum but with absolute maximum values this value is expected to have the greatest effect on the ecophysiological constraints associated with marginality likewise intergroup independence relationships must be guaranteed as far as possible if this circumstance is fulfilled it is possible to assume a cumulative behavior of the marginality corresponding to each group of defined parameters this additive behavior makes it possible to avoid the instability problems that especially low values of marginality in one or several groups would generate in the integrated value if a multiplicative model were used 2 2 the algorithm and its properties in accordance with these premises a set of indicators was developed that allow the degree of ecological marginality of a given site to be evaluated hierarchically in terms of species specific requirements hence the name ecomarginal model for a given species the degree of marginality of parameter i which belongs to the group of parameters j mi j at a given site can then be approximated using the following algorithm m i j f x 1 si x 2 ll lt 1 1 e 5 55 l t x l t l l 1 1 si 2 ll lt x lt 0 si lt x ut 1 1 1 e 5 55 x u t u l u t 1 si ut x 2 ul ut 1 si x 2 ul ut where mi j is the marginality index of the parameter i belonging to group j x is value of the parameter at the site regarding the range of variation of parameter i for the species ll is the lower limit lt is the lower threshold ut is the upper threshold ul is the upper limit once the degree of marginality for each of the parameters considered within the delimited realized niche of the species is established it is integrated in a hierarchical manner in two differentiated phases first the marginality of group j of related parameters m j is established in accordance with the expression m j m a x i 1 n m j i at the next level of integration the marginality assessment for a large group k of parameters i e climatic edaphic physiographic etc gives the value m k which is calculated using the following expression m k j 1 j m j this set of mathematical relationships conform a model for evaluating the ecological marginality conditions of a site for a given species the main properties of the model are 1 the range of variation in the marginality index mi j is unequivocally defined and is delimited between the values 1 and 1 this property is particularly desirable in a modeled variable li and wu 2004 because it facilitates the interpretation and comparison of results 2 marginality values are situated in the environment of the extreme values of the observed parameter range limits two types of marginality are then differentiated superior and inferior based on whether the index is positive or negative for superior for inferior 3 the index shows greater marginality as we approach the limits of the observed range increasing rapidly as the limits are reached logistic function monotonously increasing the position of the site parameter is therefore relative to the limit since beyond the limit the highest absolute values of marginality greater than 0 5 are obtained 4 the model overcomes the limitation of considering the niche with fixed invariable limits avoiding evaluation as unviable situations those with values exceeding these limits at site scale species adapt specialization to the combination of environmental variables that define the physical environment rather than to each variable independently hirzel et al 2002 in this way specialization to non optimal values depends on the interaction between variables which causes marginality behavior to vary over a relatively broad range around the observed limit 5 the marginality range is not the same for all parameters the range of variation of the marginality of each parameter depends on the registered range that is it depends on the observed probability of values close to the extreme values interquartile range this means that the evaluation of marginality is independent of the response curve type oksanen and minchin 2002 associated with the parameter in question 6 high influence is given to the real extreme observations in realized niche of the species because these indicate physiological tolerances that should not be ignored thus making the method especially robust for outliers 7 the way in which the different indices obtained for each parameter included in a given group are integrated allows the main effects of spurious correlations between them to be avoided for each group of parameters considering only the maximum absolute values of the marginality index guarantees 1 the selection of the least number of parameters that produce the greatest effect according to blonder 2018 data with low dimensionality and sufficient number of observations are valid for use with concepts related to hypervolume 2 the reduction in multicollinearity and parametric redundancy 3 the identification of those parameters that are most crucial for determining the ecological marginality of the site the interpretability of the model is one of the fundamental requirements when choosing a certain modeling technique guisan and thuiller 2005 8 the determination of marginality is not limited by the type of data from the available physical or autoecological means any attribute expressed as a continuous variable parameter is viable without the need for transformation 9 the marginality value can be computed as raster data or as vector data which enables cartographic implementation through the use of sigs 10 based on autoecological knowledge it is possible by applying the model to evaluate the degree of marginality that different species present at a given site provided that the corresponding hypervolumes have the same number and identity of axes this information is especially useful to detect possible conditions of environmental instability for the different species evaluated this being an ecological aspect that may compromise their effective establishment 11 the proposed model was developed with an emphasis on applicability so it might seem oversimplified the approach developed represents a starting point providing a tool to explore the key characteristics of complex relationships between species and the environment but which is not intended to replace other more complex approaches to ecological modeling that address aspects related to the concept of ecological niche 2 3 application case the comunitat valenciana is a region which is especially representative of the spanish mediterranean area among the plant communities that make up its current landscape the formations of aleppo pine pinus halepensis mill are a common element presenting a rich variety in terms of origin maturity and state of vegetative vigor unfortunately in recent years there have been notable episodes of vegetative decline that have caused in the most extreme cases the complete disappearance of aleppo pine cover in some locations this fact was especially evident in the 2014 hydrological year when the total amount of rainfall collected only reached values of between 24 and 40 of those considered normal falling in some locations orihuela to a record low of 60 mm total rainfall when the usual amount is 269 mm over the hydrological year garcía de la serrana et al 2015 this unexpected and undesirable situation must be analyzed in order to establish silvicultural management measures to mitigate or minimize the processes that lead to the vegetative decline of these stands and anticipate possible negative effects under future scenarios of climate change gracia et al 2005 serrada et al 2011 the peculiarities of the site scale physical environment are presented as a clear factor predisposing the site to episodes of vegetative decline western et al 2002 das et al 2008 galiano et al 2010 anderegg et al 2012 gea izquierdo et al 2014 this predisposition is considered to be directly related to the degree of ecological marginality of the site allen et al 2010 so that the processes of decline observed cannot be interpreted correctly in the absence of appropriate characterization hence the ecomarginal model was applied in order to facilitate the elaboration of an ecological diagnosis on the role of local physical environmental conditions in the processes of vegetative decline in pine stands the territorial scope of the study was therefore the set of forest stands of aleppo pine in the comunitat valenciana spain where differing degrees of mortality have been registered in recent years especially in 2014 a total of 10 study sites were established within these stands table 1 in each of these sites two markedly different situations were selected 1 stands with a good vegetative state and absence of notable recent mortality 2 stands presenting a certain degree of vegetative decline or evidence of recent mortality and which were physiographically and geographically proximate to the stands with good vegetative state this double sampling at each location allowed an analysis of the small scale variability of the site conditions to be conducted in which differences found in the edaphic characteristics could be especially important in the process of forest decline fig 2 shows the total areas affected by forest decline at the end of 2015 together with the position of the all the inventoried plots the forest status in the analyzed stands is relatively heterogeneous across all the locations as a whole however the forest stands reached similar dominant heights in both types of plot with and without mortality at each location meaning that significant differences in site quality cannot be assumed furthermore there appears to be no relationship between mortality and the initial stand density the episodes of mortality seem to have resulted from the effects extraordinary processes in intensity and duration on trees predisposed to the effects of such processes that is to say trees which present some degree of environmental marginality the climatic and edaphic characterization of the areas associated with the different inventoried sites was carried out by determining 28 parameters 17 climatic and 11 edaphic widely recognized as evaluators of the influence of the physical environment on plant response gandullo and sánchez 1994 the basic climatological information required to determine these parameter values was that provided by the state meteorological agency through the iberian climatic atlas aemet 2011 which at a resolution of 1 km2 provides average values of thermopluviometric variables for the period 1971 2000 the edaphic characterization was carried out by full profile sampling laboratory analysis of the extracted samples and evaluation of the results the environmental requirements of pinus halepensis mill are those set out by montero 2016 table 2 from the parameter range habitat recorded throughout the spanish peninsula by means of a standardized sampling of sites with effective species establishment realized niche defined from empirical observations of individuals that reproduce successfully and therefore support a positive growth rate for the entire population guisan and thuiller 2005 3 results the results obtained through applying the ecological marginality estimation model to the different sites analyzed present a range of variation which a priori allows us to assess the relationship between the marginality conditions evaluated and the observed mortality episodes and to identify different characteristics at site scale that may have predisposed the trees to succumbing to such episodes table 3 shows the marginality values corresponding to the different groups of climatic and edaphic variables the highest values for climatic marginality were found at orihuela and can be classified as severe this situation is associated with very high values of physiological drought pd in response to low values of annual rainfall ar and high thermal efficiency of the climate pet the situation becomes extreme at the site which shows very high mortality and reaches the highest value of climatic marginality among all those obtained in contrast the values for edaphic marginality are small associated with low values for fine earth fe in the plot where mortality was recorded whereas in the plot where no decline is evident the total carbonate tc content is noteworthy the jijona alicante location shows moderate climate marginality values especially at the site with high mortality resulting from the low values for annual water surplus ms as regards edaphic factors the site in which mortality is present is also that which has the greatest edaphic marginality maximum value due to a particularly low water retention capacity wrc and high presence of carbonates tc all the other locations show weak climatic marginality values this value being zero at jalance at this location due to the particularly low values for fine earth fe at the site where mortality is present far lower than those observed for the species the edaphic marginality can be considered severe no notable differences in edaphic marginality between the sites with and without mortality were identified at the sagunto guadassuar or lliria locations in the first two cases the marginality is only slight caused by the high presence of carbonates ct while in the case of lliria the low values for water retention capacity wrc lead to notable edaphic marginality finally the edaphic marginality values for the locations of almenara soneja gilet sagunto and villamarxant reveal no differences between the sites showing signs of vegetative decline and those that do not at these locations the sites where mortality is not present have particularly low edaphic marginality values with the exception of the site at gilet sagunto where the value for carbonates is at the observed limit for the species in contrast sites where decline is evident present high values of edaphic marginality this is a consequence of the particularly low ph in water values phw in the case of the sites at almenara and gilet sagunto or due to a combination of reduced surface organic matter oms and high presence of active carbonates ac as is the case at villamarxant and soneja in the case of the latter the situation is worsened by the reduced water retention capacity wrc 4 discussion the ecological marginality of a site for given species is a singularly complex attribute that lacks defined metrics and reference data its evaluation is therefore a particularly difficult task which has rarely been addressed in the numerous models developed based on the ecological niche idea moreover no specific methodologies have been developed in this regard so it is not possible to compare the results of the model with others that are sufficiently homologous hence it was not possible to validate the model directly however the validation can be performed indirectly by analyzing and evaluating the degree of association or correlation with other variables or environmental aspects that are directly linked to the effect of ecological marginality such as the phenomenon of forest vegetative decline the processes of decline in forest stands are particularly complex since they are driven by a set of highly varied factors allen et al 2010 del cacho and lloret 2012 the common causal factors involved in recent episodes of die off are high temperature and or water stress some studies that confirm this can be reviewed in peñuelas et al 2001 gitlin et al 2006 allen et al 2010 and hartmann et al 2005 mortality patterns in response to these factors are complex ranging from modest short term increases in the mortality context to acute episodes of rapid death at regional level which often but not always include outbreaks of biotic agents such as insects garcía de la serrana et al 2015 according to the decline spiral model manion and lachace 1992 stress due to drought and or warming acts as a trigger which can lead to mortality of the trees that are in a state of predisposition as a result of the combination of age conditions and stand density as well as specific site conditions physical environment contributing factors such as boring insects and pathogenic fungi frequently end the decline process which can lead to large scale mortality episodes mcdowell et al 2008 hartmann et al 2015 mortality in forests related to drought has been recorded in marginal geographical areas where climatic factors especially water stress are often considered limiting de cáceres et al 2015 particularly vulnerable to multiple mortality factors are areas of pine reforestation in the mediterranean basin especially as some of these plantations are in marginal locations where the densities are unnatural and excessive pausas et al 2004 and the genetic origin of the trees is unknown allen et al 2010 in the specific case of aleppo pine pinus halepensis mill a thermophilic mediterranean species with a markedly isohydric behavior the most limiting factor for its growth is water availability modulated by atmospheric water demand which is directly correlated with air temperature klein et al 2011 nadal sala et al 2017 all of the locations studied for this species present a genuine mediterranean type climate with a dry period that in all cases extends beyond three months coinciding with the period of highest temperatures summer months furthermore the entire geographical area suffered a particularly severe episode of meteorological drought in the 2014 hydrological year garcía de la serrana et al 2015 which may have triggered the observed cases of decline in terms of altitude the analyzed locations range from practically sea level almenara to more than 750 m jalance due to this range of altitudes the climatic conditions and consequently the degree of climatic marginality varies from one site to another the specific conditions at each site are further modified by the degree of edaphic marginality giving rise to a varied set of physical environments that play a determining role in the spatial pattern of the analyzed decline episodes at fine scales the physiological synergies associated with edaphic marginality and catalyzed by situations of low rainfall droughts such as those experienced in recent years lead to patterns of tree mortality that are frequently quite irregular distributed across the synoptic region in which the drought occurs the results obtained from the model application reveal variability that allows an ecological interpretation consistent with the observed situations of forest decline the descriptive capacity and precision as regards identifying the different degrees of marginality in the physical environment allow us to distinguish satisfactorily between the sites with and without evident mortality fig 3 provides a clear graphical representation of this assessment the differences detected can be attributed to a varied set of physical environmental aspects that define the particular conditions of environmental marginality in each case only one of the locations shows no climatic marginality of any type this corresponds to the one which is highest above sea level which means that the climatic conditions at this location are consistent with those found throughout the natural distribution of the species in peninsular spain gandullo and sánchez 1994 montero 2016 values reflecting certain climatic marginality were obtained for the locations with a thermal regime slightly exceeding that observed for the species in the iberian peninsula this is therefore a marginality of marked thermal character accompanied by unusually low levels of natural presence of aleppo pine the global increase in temperature may be a common driver of climate induced mortality in tree formations according to observations not only in semi arid regions but also in mesic forests mcdowell et al 2008 hartmann et al 2015 at the other extreme the locations that present a high degree of climatic marginality are those found in areas near the southernmost geographical distribution close to the semi arid parts of the iberian peninsula in which the climatic conditions are so severe that the development of stable tree formations is not viable the high marginality values obtained are related to the very high thermal efficiency of the climate pet accompanied in some cases by lower water availability ms due to low spring rainfall this leads to a marked water deficit and intense physiological drought much greater than that observed over the natural distribution area of the species in the iberian peninsula additionally site scale soil characteristics especially depth and porosity are key to the survival of the plant populations given that along with other factors they determine the capacity of the soil to store water and maintain its availability for biological processes so that water availability does not depend exclusively on the pattern of rainfall nadal sala et al 2017 at sites with marked marginal climatic conditions the persistence of aleppo pine populations up to the start of the 2014 drought episode is due to human intervention all populations analyzed are of artificial origin and to the existence of adequate soil conditions hence reduced values of edaphic marginality as soil water availability is not only dependent on the rainfall regime but also on the soil characteristics as described in the previous paragraph the availability of water during periods of maximum water deficit lloret et al 2004 galiano et al 2012 candel pérez et al 2012 results in the trees hydraulically over extending their root systems a circumstance which makes them especially vulnerable to drought episodes brunner et al 2009 furthermore if the soils show a low degree of development reduced effective depth the risk of instability due to drought in trees growing where the worst local conditions as regards water balance exist unfavorable microtopography absence of cracks is considerably high oberhuber 2001 dobbertin et al 2005 the possibility for roots to explore for nutrition and water consumption is quite limited which favors the inherent water stress of all the analyzed soils those with a lower degree of development display the highest edaphic marginality presenting particularly low values for water retention capacity in some cases this situation coexists with an abundant presence of coarse elements particularly low fine earth fe values which means that the edaphic marginality values are the highest of those obtained additionally very low surface or whole profile organic matter values are associated with an unsuitable edaphic structure with reduced water retention capacity this situation was detected at some of the sites which are identified as having notable edaphic marginalities in the group of variables related to soil biochemistry moreover as regards the soil chemistry different properties especially the presence of carbonates ac and tc and soil reaction phw with unusual values as regards natural soils for the species can result in functional imbalances that lead to negative metabolic synergies for the stability of the populations these situations are identified with notable edaphic marginality values 5 conclusions the methodological approach proposed is based on the ecological niche concept which is central to the field of ecology applying this methodology provides a key evaluation measure of the niche of the species of interest that is the degree of ecological marginality in a purely descriptive way in order to indirectly facilitate the identification of causality relationships therefore the results from the model have an intuitive ecological meaning and in the worst cases provide important evidence with regard to the conditions of ecological instability as well as allowing direct comparisons with the niches of different species the case study application described above produced coherent results with a very satisfactory capacity to identify important site limitations to the ecological behavior of the species analyzed this information is especially important in order to justify and guide the decision making process aimed at mitigating the effects of ecological instability episodes both current and future and to effectively restore the sites affected by them consequently the proposed model provides a useful starting point to address the complex challenge of assessing ecological marginality in natural systems at site scale it offers easily implemented transparent tool white box model which can provide a valuable means to explore the key features of complex relationships between species and the environment acknowledgments the study of vegetative decline in stands of pinus halepensis mill in the comunitat valenciana was made possible by the initiative and economic support of the servicio de ordenación y gestiónforestal de la consellería d infraestructures territori i medi ambient de la generalitat valenciana i would like to thank emilio gonzález and eduardo pérez laorga promoters of the study for their special interest along with the staff and service agents who carry out forest health related functions in vaersa and in the consellería for their help facilitating the field work i also wish to thank my colleagues and friends rafael serrada and juan ignacio garcía viñas as necessary copartners in this study 
25013,the different methodological tools for ecological homologation are commonly based around the controversial inference of the species fundamental niche coming from its effective niche this being considered the medium in which the species lives bounded by the quantification of a set of environmental variables parameters that define it the methodologies and models developed in this field are generally aimed at evaluating the suitability homologation of a species for a given site based on its proximity to the observed range of variation associated with its optimal ecological response this usually means the center of gravity the centroid of the point cloud etc in contrast little research has been directed towards developing methodologies which fix the reference at the limit values of the recorded variation range and which define the conditions of ecological marginality at site scale conditions of species marginality with respect to the physical environment threaten its establishment development and perpetuation and therefore its ecological stability based on the hypothesis that these conditions of marginality are focused on the edges of the parametric hypervolume that defines the fundamental niche of each species a set of indicators has been designed to evaluate the degree of ecological marginality of a given site in terms of the specific species requirements the application of the model to study episodes of vegetative decline in aleppo pine stands has produced ecologically coherent results showing a satisfactory capacity to identify the most important site aspects influencing the observed ecological behavior it is therefore an easily implemented transparent white box model methodological tool providing a valuable means to explore the key characteristics of complex relationships between species and the physical environment in which they are found keywords ecological niche ecological marginality parametric autoecology ecological instability physical environment aleppo pine 1 introduction the set of environmental requirements of species as defined by hutchinson 1957 from the niche conception postulated by grinnell in 1917 are included in the notion of the ecological niche which is a central concept in the wider field of autoecology austin 2002 guisan and thuiller 2005 soberón and peterson 2005 over the natural range of a species the interaction of biotic and abiotic factors generates a complex pattern of more or less suitable environments which in any case have allowed the species to maintain a viable population that is one which is capable of subsisting without immigration pulliam 2000 sexton et al 2009 abeli et al 2014 hence the ecological niche corresponds to the volume within the environmental space defined by the range of variation in the environmental variables that allows a positive population growth hirzel and lay 2008 suitability models can be considered operational applications of this ecological niche idea since they generally use environmental variables to predict the presence absence or abundance of a species over a given study area mateo et al 2011 this approach to biogeography and ecology at species level has been among the most widely discussed topics in ecological literature over recent decades araujo and peterson 2012 reviews of various studies that relate habitat suitability models to ecological niche theory can be found in guisan and zimmermann 2000 elith et al 2006 hirzel and lay 2008 or araujo and peterson 2012 these models adopt the general thesis that the best indicator of the environmental requirements of a given species is its current distribution guisan and zimmermann 2000 pearson and dawson 2003 the suitability therefore is given by the mathematical or statistical relationship between the known real distribution and a set of independent variables that are used as explanatory variables ecogeographic variables in the case of hirzel et al 2002 especially climatic and topographical variables while the edaphic information is often ignored thuiller 2013 due to the large amount of work involved and the economic cost of the sampling and analysis once this relationship is identified it is possible to obtain a value for each place that is usually interpreted as the probability of species presence at that point although in reality the value only indicates the environmental similarity homologation of each location to the areas where that species is currently present the probability of presence as a measure of environmental similarity should therefore be interpreted rather as a value indicating the degree of suitability of a location for the development of the species mateo et al 2011 in many cases the evaluation of the suitability homologation of a site for a given species is based on its proximity to the observed range of values associated with an optimal ecological response of the species usually according to the proximity of the center of gravity or the centroid of the corresponding point cloud soberón et al 2017 in contrast conditions that are not optimal for the ecological status of the species and which make up the environmental space associated with the idea of environmental marginality have received much less attention in particular the condition of marginality is not a specifically defined attribute the study of which has mainly been addressed through species distribution models while scarce research has been directed towards ecological niche models the difference between the two types of model can be explained by hutchinson s duality 1957 correspondence between the geographic space occupied by a species and the abstract multi dimensional niche space with which it is associated guisan and zimmermann 2000 soberón and peterson 2005 soberón et al 2017 in this way it is possible to distinguish two types of marginality geographic marginality determined by the spatial position of a population at the edge of its natural distribution and an ecological marginality which arises in environmental niche spaces of areas which are ecologically different in terms of the optimal conditions and consequently the populations display signs of ecological restriction to a greater or lesser extent as regards geographical marginality the abundant center hypothesis postulates that the population abundance of a species is greater at the center of its geographic distribution and decreases towards the limits where the context for peripheral populations differs from that of optimal ecological conditions for the species sagarin and gaines 2002 sexton et al 2009 populations at the edge tend to be smaller less dense and have lower genetic diversity than central populations abeli et al 2014 this hypothesis has been the focus of continuous debate since the 1980s essentially because empirical studies have revealed unequal patterns pironon et al 2014 coro et al 2016 papuga et al 2018 other approaches to determining geographic marginality are those based on the relative occurrence area hirzel et al 2002 define marginality as the ecological distance between the species optimum and the average habitat within the reference area this estimate of the degree of deviation of the conditions inhabited by the species from the average environmental conditions of the region studied is directly related to geographic marginality the use of this conceptualization of marginality highlights the effect of the extension occupied in the model results which is caused by the autocorrelated spatial structure of nature dormann et al 2007 jiménez valverde et al 2008 as the distribution area depends on a high heterogeneous number of factors more than those that define the fundamental niche of the species soberón et al 2017 geographic marginality does not correspond entirely with ecological marginality de medeiros et al 2018 in addition the species performance is not necessarily better at the center of its geographical distribution but rather in areas with optimum environmental conditions or those that present greater environmental stability over time abeli et al 2014 the differences in ecological niche conditions between peripheral and central populations have received less empirical attention than the previously mentioned issues pironon et al 2014 so approaches to define and explicitly evaluate ecological marginality are particularly scarce hence ecological marginality focuses on the proximity to the edges of the environmental space that defines the niche niche envelope at these limits the ecophysiological stability growth of the populations of the species decreases to the point where it becomes nil theoretically the null net growth isocline then defines the niche shape in such a way that beyond it the mortality rates exceed the birth rates mainly as a consequence of inadequate habitat and interspecific competition hirzel and lay 2008 recent research concerning methods for the identification of hypervolume shapes and sizes can be found in swanson et al 2015 blonder et al 2017 or junker et al 2016 in the case of plant species the diversity of the environmental factors involved and the complexity of their interactions make the delineation of their ecological niche a sensitive issue pulliam 2000 in the main the research into plant species over recent decades has focused on the identification of the climatic niche at continental or regional scale thus by not using the appropriate scale to identify the precise fundamental niche of the plants miller and hobbs 2007 information is not provided on how fine scale population processes can vary within the boundaries of the environmental niche and what the ecological significance of it is there is an evident need to develop site scale modeling that allows sufficiently explicit descriptions to be made of the set of resources and environmental conditions which permit the establishment growth and reproduction of plants papuga et al 2018 within this challenge marginality is presented as an attribute of undoubted ecological significance as it compromises the ecological stability at a given site hence it is of particular interest to develop new modeling initiatives that facilitate evaluation and promote the ecological interpretation of this marginality in this paper the concepts ideas and hypotheses underlying the model developed for this purpose are presented describing the mathematical development of the model and providing an example of its application to a singular situation of vegetative decline observed in an aleppo pine stand 2 methods there is no precise definition of ecological marginality from the postulates of the ecological niche theory it can be considered as those environmental spaces physical environment in which a population or individual displays a high degree of ecophysiological restrictions these restrictions lead to a decrease in growth and reproduction rates which leads to difficulty in achieving effective establishment positive population growth 2 1 underlying assumptions and limitations in order to perform the evaluation the starting hypothesis is that the condition of marginality occurs in spaces of the environmental hypervolume defined by values that are generally distant from the ecological optimum considering that this optimum corresponds to the environment of the center of gravity or to the cloud centroid of observation points delimiting the environmental space of a species no possible internal marginalities caused by the presence of holes in the hypervolume blonder et al 2017 are assumed within the environmental niche the marginality addressed being exclusively that associated with proximity to the edges of the realized niche of each species specific environmental coordinates locate a given site at a specific distance from the edge of the environmental hypervolume that is assumed invariant the physiological tolerances inherited from the species to the environmental factors are conserved that is the fundamental niche does not change in the temporal spatial framework considered araujo and peterson 2012 in turn for plant species it is assumed that they are in a state of pseudo equilibrium with the environment where the change is slow in relation to the span of the biota austin 2002 guisan and thuiller 2005 in this way a static geometric model is sufficient to describe the environmental hypervolume if it is assumed that there is independence from the biotic context and it is accepted that it is the abiotic conditions that impose physiological limits on the ability of the species to persist at a given site soberón and peterson 2005 the basic information is the range of variation recorded for each component variable or parameters that make up the n dimensional environmental space of a specific species the hypervolume assumes that the n axes that define the system are fixed represent continuous variables necessary to work within the definition of a euclidean hyperspace and all contribute independently and equally to the metrics that characterize it euclidean distances and volumes these fundamental assumptions which arise from mathematics are relevant to the definition of a hypervolume since they highlight the conceptual limitations that are important in determining the relevance and applicability of hypervolumes for any particular question blonder 2018 it is further assumed that the data represent the fundamental niche of the species defined by simple independent limits on each axis it is therefore acceptable according to blonder 2018 to fit a range box model without the need to directly delineate a geometric shape within the range observed for a given parameter potential hypervolume axis the condition of marginality begins beyond a certain value threshold value this condition is expected to grow as it moves away from said value towards the limit slowly at first and reaching the highest rates of change at the observed limit value of the parameter once this is exceeded marginality decreases progressively finally reaching extreme conditions which are incompatible with the viable presence of the species the mathematical translation of this behavior is a 4 parameter logistic curve upper asymptote of value 1 lower asymptote of value 0 mid range point at the limit value and growth parameter as that which allows the greater proportion of the marginality variation to be concentrated in the central third of the variation range in which the parameter presents marginality using this approach the range of variation of marginality cannot be restricted to the difference between the limit and the corresponding threshold this makes it necessary to extend a range equivalent to said difference beyond the limit values in this way it is possible to identify two types of marginality a higher marginality centered around the highest observed value of the parameter upper limit and a lower marginality which uses the minimum value observed lower limit as a reference point for both marginalities the range of marginality variation is defined by twice the difference between the limit and the corresponding threshold centered on the limit fig 1 the identification of the corresponding threshold values which delimit the conditions of centrality and marginality is based on the use of percentiles gandullo and sánchez 1994 booth et al 2014 junker et al 2016 in this case a dominant unimodal behavior and not necessarily gaussian is assumed in the ecophysiological response curves to environmental gradients in plant species oksanen and minchin 2002 rydgren et al 2003 thus the condition of marginality in the observed range is focused on the lowest 10 of values in the range of variation lower marginality or the highest 10 of values higher marginality of each parameter consequently marginality corresponds to 20 of the recorded extreme values with the 10 percentile marking the lower threshold while the 90 percentile sets the upper threshold it is usual for the characterization of the environmental requirements of a given species to be done by collecting very varied parametric information which includes variables that show different degrees of dependence among them and that are often redundant in their ecophysiological significance according to hirzel and lay 2008 this circumstance means that it is desirable to group the parameters in conceptually and metrically related groups i e parameters of thermal regime rainfall regime etc thus for a given season the condition of species marginality is considered to result from the evaluation of a set of environmental attributes that have proven ecophysiological significance the selection of which parameters best evaluate these attributes depends above all on the ecology of the species in question and the available environmental information thus the set of parameters that characterize the environmental hypervolume of a species must be reclassified using expert knowledge guisan and zimmermann 2000 hirzel and lay 2008 variables parameters must be identified and estimated for each of the groups defined in order to generate a known and relatively homogenous ecophysiological incidence with sufficiently similar metrics thus favoring their ecological interpretation to avoid the expected effect of high multicollinearity and redundancy only the variable with values furthest from the ecological optimum will be considered for each group as with liebig s law of minimum but with absolute maximum values this value is expected to have the greatest effect on the ecophysiological constraints associated with marginality likewise intergroup independence relationships must be guaranteed as far as possible if this circumstance is fulfilled it is possible to assume a cumulative behavior of the marginality corresponding to each group of defined parameters this additive behavior makes it possible to avoid the instability problems that especially low values of marginality in one or several groups would generate in the integrated value if a multiplicative model were used 2 2 the algorithm and its properties in accordance with these premises a set of indicators was developed that allow the degree of ecological marginality of a given site to be evaluated hierarchically in terms of species specific requirements hence the name ecomarginal model for a given species the degree of marginality of parameter i which belongs to the group of parameters j mi j at a given site can then be approximated using the following algorithm m i j f x 1 si x 2 ll lt 1 1 e 5 55 l t x l t l l 1 1 si 2 ll lt x lt 0 si lt x ut 1 1 1 e 5 55 x u t u l u t 1 si ut x 2 ul ut 1 si x 2 ul ut where mi j is the marginality index of the parameter i belonging to group j x is value of the parameter at the site regarding the range of variation of parameter i for the species ll is the lower limit lt is the lower threshold ut is the upper threshold ul is the upper limit once the degree of marginality for each of the parameters considered within the delimited realized niche of the species is established it is integrated in a hierarchical manner in two differentiated phases first the marginality of group j of related parameters m j is established in accordance with the expression m j m a x i 1 n m j i at the next level of integration the marginality assessment for a large group k of parameters i e climatic edaphic physiographic etc gives the value m k which is calculated using the following expression m k j 1 j m j this set of mathematical relationships conform a model for evaluating the ecological marginality conditions of a site for a given species the main properties of the model are 1 the range of variation in the marginality index mi j is unequivocally defined and is delimited between the values 1 and 1 this property is particularly desirable in a modeled variable li and wu 2004 because it facilitates the interpretation and comparison of results 2 marginality values are situated in the environment of the extreme values of the observed parameter range limits two types of marginality are then differentiated superior and inferior based on whether the index is positive or negative for superior for inferior 3 the index shows greater marginality as we approach the limits of the observed range increasing rapidly as the limits are reached logistic function monotonously increasing the position of the site parameter is therefore relative to the limit since beyond the limit the highest absolute values of marginality greater than 0 5 are obtained 4 the model overcomes the limitation of considering the niche with fixed invariable limits avoiding evaluation as unviable situations those with values exceeding these limits at site scale species adapt specialization to the combination of environmental variables that define the physical environment rather than to each variable independently hirzel et al 2002 in this way specialization to non optimal values depends on the interaction between variables which causes marginality behavior to vary over a relatively broad range around the observed limit 5 the marginality range is not the same for all parameters the range of variation of the marginality of each parameter depends on the registered range that is it depends on the observed probability of values close to the extreme values interquartile range this means that the evaluation of marginality is independent of the response curve type oksanen and minchin 2002 associated with the parameter in question 6 high influence is given to the real extreme observations in realized niche of the species because these indicate physiological tolerances that should not be ignored thus making the method especially robust for outliers 7 the way in which the different indices obtained for each parameter included in a given group are integrated allows the main effects of spurious correlations between them to be avoided for each group of parameters considering only the maximum absolute values of the marginality index guarantees 1 the selection of the least number of parameters that produce the greatest effect according to blonder 2018 data with low dimensionality and sufficient number of observations are valid for use with concepts related to hypervolume 2 the reduction in multicollinearity and parametric redundancy 3 the identification of those parameters that are most crucial for determining the ecological marginality of the site the interpretability of the model is one of the fundamental requirements when choosing a certain modeling technique guisan and thuiller 2005 8 the determination of marginality is not limited by the type of data from the available physical or autoecological means any attribute expressed as a continuous variable parameter is viable without the need for transformation 9 the marginality value can be computed as raster data or as vector data which enables cartographic implementation through the use of sigs 10 based on autoecological knowledge it is possible by applying the model to evaluate the degree of marginality that different species present at a given site provided that the corresponding hypervolumes have the same number and identity of axes this information is especially useful to detect possible conditions of environmental instability for the different species evaluated this being an ecological aspect that may compromise their effective establishment 11 the proposed model was developed with an emphasis on applicability so it might seem oversimplified the approach developed represents a starting point providing a tool to explore the key characteristics of complex relationships between species and the environment but which is not intended to replace other more complex approaches to ecological modeling that address aspects related to the concept of ecological niche 2 3 application case the comunitat valenciana is a region which is especially representative of the spanish mediterranean area among the plant communities that make up its current landscape the formations of aleppo pine pinus halepensis mill are a common element presenting a rich variety in terms of origin maturity and state of vegetative vigor unfortunately in recent years there have been notable episodes of vegetative decline that have caused in the most extreme cases the complete disappearance of aleppo pine cover in some locations this fact was especially evident in the 2014 hydrological year when the total amount of rainfall collected only reached values of between 24 and 40 of those considered normal falling in some locations orihuela to a record low of 60 mm total rainfall when the usual amount is 269 mm over the hydrological year garcía de la serrana et al 2015 this unexpected and undesirable situation must be analyzed in order to establish silvicultural management measures to mitigate or minimize the processes that lead to the vegetative decline of these stands and anticipate possible negative effects under future scenarios of climate change gracia et al 2005 serrada et al 2011 the peculiarities of the site scale physical environment are presented as a clear factor predisposing the site to episodes of vegetative decline western et al 2002 das et al 2008 galiano et al 2010 anderegg et al 2012 gea izquierdo et al 2014 this predisposition is considered to be directly related to the degree of ecological marginality of the site allen et al 2010 so that the processes of decline observed cannot be interpreted correctly in the absence of appropriate characterization hence the ecomarginal model was applied in order to facilitate the elaboration of an ecological diagnosis on the role of local physical environmental conditions in the processes of vegetative decline in pine stands the territorial scope of the study was therefore the set of forest stands of aleppo pine in the comunitat valenciana spain where differing degrees of mortality have been registered in recent years especially in 2014 a total of 10 study sites were established within these stands table 1 in each of these sites two markedly different situations were selected 1 stands with a good vegetative state and absence of notable recent mortality 2 stands presenting a certain degree of vegetative decline or evidence of recent mortality and which were physiographically and geographically proximate to the stands with good vegetative state this double sampling at each location allowed an analysis of the small scale variability of the site conditions to be conducted in which differences found in the edaphic characteristics could be especially important in the process of forest decline fig 2 shows the total areas affected by forest decline at the end of 2015 together with the position of the all the inventoried plots the forest status in the analyzed stands is relatively heterogeneous across all the locations as a whole however the forest stands reached similar dominant heights in both types of plot with and without mortality at each location meaning that significant differences in site quality cannot be assumed furthermore there appears to be no relationship between mortality and the initial stand density the episodes of mortality seem to have resulted from the effects extraordinary processes in intensity and duration on trees predisposed to the effects of such processes that is to say trees which present some degree of environmental marginality the climatic and edaphic characterization of the areas associated with the different inventoried sites was carried out by determining 28 parameters 17 climatic and 11 edaphic widely recognized as evaluators of the influence of the physical environment on plant response gandullo and sánchez 1994 the basic climatological information required to determine these parameter values was that provided by the state meteorological agency through the iberian climatic atlas aemet 2011 which at a resolution of 1 km2 provides average values of thermopluviometric variables for the period 1971 2000 the edaphic characterization was carried out by full profile sampling laboratory analysis of the extracted samples and evaluation of the results the environmental requirements of pinus halepensis mill are those set out by montero 2016 table 2 from the parameter range habitat recorded throughout the spanish peninsula by means of a standardized sampling of sites with effective species establishment realized niche defined from empirical observations of individuals that reproduce successfully and therefore support a positive growth rate for the entire population guisan and thuiller 2005 3 results the results obtained through applying the ecological marginality estimation model to the different sites analyzed present a range of variation which a priori allows us to assess the relationship between the marginality conditions evaluated and the observed mortality episodes and to identify different characteristics at site scale that may have predisposed the trees to succumbing to such episodes table 3 shows the marginality values corresponding to the different groups of climatic and edaphic variables the highest values for climatic marginality were found at orihuela and can be classified as severe this situation is associated with very high values of physiological drought pd in response to low values of annual rainfall ar and high thermal efficiency of the climate pet the situation becomes extreme at the site which shows very high mortality and reaches the highest value of climatic marginality among all those obtained in contrast the values for edaphic marginality are small associated with low values for fine earth fe in the plot where mortality was recorded whereas in the plot where no decline is evident the total carbonate tc content is noteworthy the jijona alicante location shows moderate climate marginality values especially at the site with high mortality resulting from the low values for annual water surplus ms as regards edaphic factors the site in which mortality is present is also that which has the greatest edaphic marginality maximum value due to a particularly low water retention capacity wrc and high presence of carbonates tc all the other locations show weak climatic marginality values this value being zero at jalance at this location due to the particularly low values for fine earth fe at the site where mortality is present far lower than those observed for the species the edaphic marginality can be considered severe no notable differences in edaphic marginality between the sites with and without mortality were identified at the sagunto guadassuar or lliria locations in the first two cases the marginality is only slight caused by the high presence of carbonates ct while in the case of lliria the low values for water retention capacity wrc lead to notable edaphic marginality finally the edaphic marginality values for the locations of almenara soneja gilet sagunto and villamarxant reveal no differences between the sites showing signs of vegetative decline and those that do not at these locations the sites where mortality is not present have particularly low edaphic marginality values with the exception of the site at gilet sagunto where the value for carbonates is at the observed limit for the species in contrast sites where decline is evident present high values of edaphic marginality this is a consequence of the particularly low ph in water values phw in the case of the sites at almenara and gilet sagunto or due to a combination of reduced surface organic matter oms and high presence of active carbonates ac as is the case at villamarxant and soneja in the case of the latter the situation is worsened by the reduced water retention capacity wrc 4 discussion the ecological marginality of a site for given species is a singularly complex attribute that lacks defined metrics and reference data its evaluation is therefore a particularly difficult task which has rarely been addressed in the numerous models developed based on the ecological niche idea moreover no specific methodologies have been developed in this regard so it is not possible to compare the results of the model with others that are sufficiently homologous hence it was not possible to validate the model directly however the validation can be performed indirectly by analyzing and evaluating the degree of association or correlation with other variables or environmental aspects that are directly linked to the effect of ecological marginality such as the phenomenon of forest vegetative decline the processes of decline in forest stands are particularly complex since they are driven by a set of highly varied factors allen et al 2010 del cacho and lloret 2012 the common causal factors involved in recent episodes of die off are high temperature and or water stress some studies that confirm this can be reviewed in peñuelas et al 2001 gitlin et al 2006 allen et al 2010 and hartmann et al 2005 mortality patterns in response to these factors are complex ranging from modest short term increases in the mortality context to acute episodes of rapid death at regional level which often but not always include outbreaks of biotic agents such as insects garcía de la serrana et al 2015 according to the decline spiral model manion and lachace 1992 stress due to drought and or warming acts as a trigger which can lead to mortality of the trees that are in a state of predisposition as a result of the combination of age conditions and stand density as well as specific site conditions physical environment contributing factors such as boring insects and pathogenic fungi frequently end the decline process which can lead to large scale mortality episodes mcdowell et al 2008 hartmann et al 2015 mortality in forests related to drought has been recorded in marginal geographical areas where climatic factors especially water stress are often considered limiting de cáceres et al 2015 particularly vulnerable to multiple mortality factors are areas of pine reforestation in the mediterranean basin especially as some of these plantations are in marginal locations where the densities are unnatural and excessive pausas et al 2004 and the genetic origin of the trees is unknown allen et al 2010 in the specific case of aleppo pine pinus halepensis mill a thermophilic mediterranean species with a markedly isohydric behavior the most limiting factor for its growth is water availability modulated by atmospheric water demand which is directly correlated with air temperature klein et al 2011 nadal sala et al 2017 all of the locations studied for this species present a genuine mediterranean type climate with a dry period that in all cases extends beyond three months coinciding with the period of highest temperatures summer months furthermore the entire geographical area suffered a particularly severe episode of meteorological drought in the 2014 hydrological year garcía de la serrana et al 2015 which may have triggered the observed cases of decline in terms of altitude the analyzed locations range from practically sea level almenara to more than 750 m jalance due to this range of altitudes the climatic conditions and consequently the degree of climatic marginality varies from one site to another the specific conditions at each site are further modified by the degree of edaphic marginality giving rise to a varied set of physical environments that play a determining role in the spatial pattern of the analyzed decline episodes at fine scales the physiological synergies associated with edaphic marginality and catalyzed by situations of low rainfall droughts such as those experienced in recent years lead to patterns of tree mortality that are frequently quite irregular distributed across the synoptic region in which the drought occurs the results obtained from the model application reveal variability that allows an ecological interpretation consistent with the observed situations of forest decline the descriptive capacity and precision as regards identifying the different degrees of marginality in the physical environment allow us to distinguish satisfactorily between the sites with and without evident mortality fig 3 provides a clear graphical representation of this assessment the differences detected can be attributed to a varied set of physical environmental aspects that define the particular conditions of environmental marginality in each case only one of the locations shows no climatic marginality of any type this corresponds to the one which is highest above sea level which means that the climatic conditions at this location are consistent with those found throughout the natural distribution of the species in peninsular spain gandullo and sánchez 1994 montero 2016 values reflecting certain climatic marginality were obtained for the locations with a thermal regime slightly exceeding that observed for the species in the iberian peninsula this is therefore a marginality of marked thermal character accompanied by unusually low levels of natural presence of aleppo pine the global increase in temperature may be a common driver of climate induced mortality in tree formations according to observations not only in semi arid regions but also in mesic forests mcdowell et al 2008 hartmann et al 2015 at the other extreme the locations that present a high degree of climatic marginality are those found in areas near the southernmost geographical distribution close to the semi arid parts of the iberian peninsula in which the climatic conditions are so severe that the development of stable tree formations is not viable the high marginality values obtained are related to the very high thermal efficiency of the climate pet accompanied in some cases by lower water availability ms due to low spring rainfall this leads to a marked water deficit and intense physiological drought much greater than that observed over the natural distribution area of the species in the iberian peninsula additionally site scale soil characteristics especially depth and porosity are key to the survival of the plant populations given that along with other factors they determine the capacity of the soil to store water and maintain its availability for biological processes so that water availability does not depend exclusively on the pattern of rainfall nadal sala et al 2017 at sites with marked marginal climatic conditions the persistence of aleppo pine populations up to the start of the 2014 drought episode is due to human intervention all populations analyzed are of artificial origin and to the existence of adequate soil conditions hence reduced values of edaphic marginality as soil water availability is not only dependent on the rainfall regime but also on the soil characteristics as described in the previous paragraph the availability of water during periods of maximum water deficit lloret et al 2004 galiano et al 2012 candel pérez et al 2012 results in the trees hydraulically over extending their root systems a circumstance which makes them especially vulnerable to drought episodes brunner et al 2009 furthermore if the soils show a low degree of development reduced effective depth the risk of instability due to drought in trees growing where the worst local conditions as regards water balance exist unfavorable microtopography absence of cracks is considerably high oberhuber 2001 dobbertin et al 2005 the possibility for roots to explore for nutrition and water consumption is quite limited which favors the inherent water stress of all the analyzed soils those with a lower degree of development display the highest edaphic marginality presenting particularly low values for water retention capacity in some cases this situation coexists with an abundant presence of coarse elements particularly low fine earth fe values which means that the edaphic marginality values are the highest of those obtained additionally very low surface or whole profile organic matter values are associated with an unsuitable edaphic structure with reduced water retention capacity this situation was detected at some of the sites which are identified as having notable edaphic marginalities in the group of variables related to soil biochemistry moreover as regards the soil chemistry different properties especially the presence of carbonates ac and tc and soil reaction phw with unusual values as regards natural soils for the species can result in functional imbalances that lead to negative metabolic synergies for the stability of the populations these situations are identified with notable edaphic marginality values 5 conclusions the methodological approach proposed is based on the ecological niche concept which is central to the field of ecology applying this methodology provides a key evaluation measure of the niche of the species of interest that is the degree of ecological marginality in a purely descriptive way in order to indirectly facilitate the identification of causality relationships therefore the results from the model have an intuitive ecological meaning and in the worst cases provide important evidence with regard to the conditions of ecological instability as well as allowing direct comparisons with the niches of different species the case study application described above produced coherent results with a very satisfactory capacity to identify important site limitations to the ecological behavior of the species analyzed this information is especially important in order to justify and guide the decision making process aimed at mitigating the effects of ecological instability episodes both current and future and to effectively restore the sites affected by them consequently the proposed model provides a useful starting point to address the complex challenge of assessing ecological marginality in natural systems at site scale it offers easily implemented transparent tool white box model which can provide a valuable means to explore the key features of complex relationships between species and the environment acknowledgments the study of vegetative decline in stands of pinus halepensis mill in the comunitat valenciana was made possible by the initiative and economic support of the servicio de ordenación y gestiónforestal de la consellería d infraestructures territori i medi ambient de la generalitat valenciana i would like to thank emilio gonzález and eduardo pérez laorga promoters of the study for their special interest along with the staff and service agents who carry out forest health related functions in vaersa and in the consellería for their help facilitating the field work i also wish to thank my colleagues and friends rafael serrada and juan ignacio garcía viñas as necessary copartners in this study 
25014,species coexistence in the plankton community which is also known as the plankton paradox has been extensively discussed in studies of the aquatic ecosystem theoretical work also proves that seasonal variation can produce population chaos which can reduce species extinction however there is still a lack of empirical research to analyze how both species interactions and seasonal forcing affect both species coexistence and system stability in the plankton community in this work we model plankton system via combining both seasonal temperature and a food web model with prey preference and further use the markov chain monte carlo mcmc algorithms to estimate model parameters theoretical predictions show both internal factor intraspecific competition coefficient of calanoid copepods and external factor seasonal temperature are the key factors which can produce population chaos meanwhile phase space reconstruction method shows lyapunov exponents of empirical data are positive both theoretical predictions and empirical data show the plankton community presents the chaotic dynamics which reduce species extinction and may help understand the plankton paradox keywords species coexistence plankton paradox seasonal forcing lyapunov exponent mcmc food web model 1 introduction the relationship between biodiversity and system stability has always been a controversial topic in ecological research may 1973 pimm 1985 mccann 2000 ives and carpenter 2007 ives ives 2005 systematically discusses three kinds of viewpoints of diversity stability diversity increases community stability diversity decreases community stability and diversity increases whole community stability but decreases individual species stability traditional theory predicts that diversity and complexity can cause community instability may 1973 however how does it explain the opposite effect of community and population levels earlier theoretical research showed that the chaotic dynamic of the population can decrease species extinction and promote species diversity allen et al 1993 károlyi et al 2000 since the discovery of chaotic dynamics in ecology using simple population models by may may 1974 much research based on mathematical models showed that chaos can arise in many different ecological processes including predator prey interactions gilpin 1979 scheffer 1991 vandermeer 1993 food chain dynamics hastings and powell 1991 multispecies competition for limiting resources huisman and weissing 1999 and plant herbivore fluctuations abbott and dwyer 2007 at the same time the field evidence of chaos also gradually accumulated tilman and wedin 1991 hanski et al 1993 turchin and ellner 2000 benincà et al 2015 so chaos may be commonplace in ecological system hastings et al 1993 in the aquatic ecosystem the biodiversity puzzle is known as the plankton paradox hutchinson 1961 which is particularly troublesome only a few resources are potentially limiting for phytoplankton however there are dozens of phytoplankton species coexisting in natural waters in essence the plankton paradox is assigned to the argument of diversity stability complexity in the plankton community plankton communities are a classic example of ecological chaos in nature sugihara and may 1990 scheffer 1991 both empirical research horwood 1995 and theoretical research huisman and weissing 1999 discussed the chaotic dynamics in the plankton community huisman and weissing huisman and weissing 1999 established a resource competition model to try to solve the plankton paradox and the theoretical results showed that when the nutrient concentrations are low the chaotic dynamics of phytoplankton abundance favor the coexistence of more species and enhance species diversity after this the chaotic dynamics of the plankton community were extensively discussed in the theoretical research clodong and blasius 2004 benincà et al 2008 klausmeier and litchman 2012 and chaotic dynamics may be the intrinsic properties of complex community hastings et al 1993 seasonal variation eg temperature will have an important influence on population dynamics in the plankton community clodong and blasius 2004 dakos et al 2009 seasonal induced chaos can be found in the rocky intertidal community benincà et al 2015 temperature fluctuates every season in most ecosystems and therefore chaotic dynamics may also be driven by temperature although beninca et al benincà et al 2008 tested temperature in their empirical analysis of plankton dynamics we still lack research which combines empirical data and theoretical models to interpret how seasonal forcing affects population dynamics in the plankton community species interaction induced chaos can be found in the plankton community huisman and weissing 1999 benincà et al 2008 2009 benincà et al benincà et al 2008 2009 collected time series data of nutrition and plankton nutrition nitrogen and phosphorus plankton ten species such as cyanobacteria and rotifers 2319 days of tracking records to investigate chaotic population dynamics first they calculated a chaotic property of empirical data of both species and nutrient and then used a neural network method to predict data benincà et al 2008 however this work did not involve the dynamic mechanism modeling of the plankton community so we cannot understand the intrinsic mechanism of chaotic dynamics in the plankton community to solve this problem benincà et al benincà et al 2009 established a theoretical model to analyze the chaotic population dynamics however parameter estimation of the model is not derived from the experimental data what s more they only chose a two trophic interactions only four species and neglected the influences of nutrient and top predator in plankton community in this study we will introduce seasonal temperature into the plankton system by combining empirical data with a food web model we aim to explore the relationship between species diversity and system stability in the plankton community and examine whether seasonal temperature and species interactions create chaos our work will help enhance the understanding of complex population dynamics in the plankton community 2 methods 2 1 study system and experimental data the long term experiment of a plankton community isolated from the baltic sea 54 26 n 12 42 e and the population abundances of the species were counted twice a week from 12 july 1990 to 20 october 1997 heerkloss and klinkenberg 1998 the plankton community and original data were published online by benincà benincà et al 2008 which includes two nutrients nitrogen n and phosphorus one detritus pool and ten species picophytoplankton pp nanophytoplankton np filamentous diatoms protozoa rotifers ro calanoid copepods ca cyclopoid cy heterotrophic bacteria ostracods harpacticoid copepods however different from the previous work benincà et al 2008 2009 we will combine a theoretical model with empirical data to study the population dynamics in the plankton community due to the biomass of some species eg protozoa and filamentous diatoms having too many zeros we neglected the interactions of these species and obtained a new system fig 1 this system includes three trophic levels and six state variables abiotic nutrition n producers pp np consumers ro ca and a top predator cy we dealt with the original data with the piecewise cubic hermite interpolating polynomial then we performed corresponding transformation eg ln 1 x for each column of time series data x 90 day 2658 day 2 2 food web model in order to systematically study the dynamic behaviour of the plankton community fig 1 we established a mechanistic model to analyze the complex species interactions the earlier research benincà et al 2009 used the type ii functional response term to build a simple food web model with two trophic levels and four species in our work we added both nutrient and an extra trophic level top predator in the simple food webs meanwhile we considered the choice preference of one consumer rotifers to two resources picophytoplankton nanophytoplankton for facilitating parameter estimation we adopted the type i functional response in a new food web model 1a d x d t a 1 s x a 2 x y 1 a 3 x y 2 1b d y 1 d t b 1 x y 1 1 α 1 y 1 β 1 y 2 π b 2 y 1 z 1 b 3 y 1 1 z 2 l 1c d y 2 d t c 1 x y 2 1 α 2 y 2 β 2 y 1 1 π c 2 y 2 z 1 c 3 y 2 z 2 1d d z 1 d t d 1 π y 1 d 2 1 π y 2 z 1 1 α 3 z 1 β 3 z 2 m 1 f t z 1 d 3 z 1 w 1e d z 2 d t e 1 y 1 e 2 y 2 z 2 1 α 4 z 2 β 4 z 1 m 2 f t z 2 1f d w d t f z 1 w 1 w k m 3 f t w where the six state variables x n y1 pp y2 np z1 ro z2 ca w cy a1 resource turnover rate s resource supply a2 a3 resource consumption rate b1 c1 d1 d2 e1 e2 f development rate l threshold value b2 b3 c2 c3 d3 predation rate α j β j j 1 4 intraspecific and interspecific competition coefficient k capacity mi i 1 3 morality rate we set prey preference function post et al 2000 π θ y 1 θ y 1 1 θ y 2 and θ is the preference θ 0 1 of z1 preys on y1 1 θ is the preference of z1 preys on y2 similar to an earlier method benincà et al 2015 we assumed that the natural mortality of consumer z1 z2 and top predator w are forced by seasonal temperature fluctuations ft 1 r tmax tmean cos 2 π t 377 365 where the scaling coefficient r represents the strength of seasonal forcing tmean is the mean temperature of 20 28 c measured at the research site and tmax is the temperature of 25 9 c measured on the warmest day of the year at t 377 day benincà et al 2008 both state variables and parameters of the food web model can be found in table 1 in eq 1a a 1 s x is the addition of nitrogen from the outside a 2 x y 1 and a 3 x y 2 represent a reduction in nitrogen due to the consumption by consumers in eq 1b b 1 x y 1 1 α 1 y 1 β 1 y 2 is the potential growth of y1 π b 2 y 1 z 1 represents a reduction in pp due to the predation of z1 b 3 y 1 1 z 2 l represents a reduction in pp due to the predation of z2 and l is the threshold value if z2 l it has a negative relation such as predation between y1 and z2 while if z2 l due to z2 having a rather large population density there is a stronger competition between z1 and z2 it will indirectly decrease the predation of z1 to y1 so it could have a positive relation between z2 and y1 in eq 1c c 1 x y 2 1 α 2 y 2 β 2 y 1 is the potential growth of y2 1 π c 2 y 2 z 1 and c 3 y 2 z 2 represent a reduction in np due to the predation of z1 and z2 respectively in eq 1d d 1 π y 1 d 2 1 π y 2 z 1 1 α 3 z 1 β 3 z 2 is the potential growth of z1 due to consuming y1 and y2 m 1 z 1 is the natural mortality of z1 d 3 z 1 w represents a reduction in z1 due to the predation of w in eq 1e e 1 y 1 e 2 y 2 z 2 1 α 4 z 2 β 4 z 1 is the potential growth of z2 due to consuming y1 and y2 m 2 z 2 is the natural mortality of z2 in eq 1f f z 1 w 1 w k is the potential growth of w due to consuming z1 m 3 w is the natural mortality of w 2 3 model and empirical data analyses we first set a constant environment ft 1 and used the markov chain monte carlo mcmc algorithms haario et al 2006 to calculate model parameters because with many parameters 30 in our case global estimation methods such as mcmc provide higher accuracy than local estimate methods such as the least square method then we did the bifurcation analyses by changing both one and two parameters at a time for the empirical data to verify the chaotic fluctuation of populations first the autocorrelation method was used to calculate the time delay τ rosenstein et al 1993 then the radial basis function rbf neural networks method was conducted to predict the suitable embedding dimension m li and wang 2002 combining τ with m we calculated the largest lyapunov exponent le by reconstructing the attractor dynamics from a single data set wolf et al 1985 finally we compared with lyapunov exponent between theoretical model and empirical data 3 results 3 1 theoretical predictions parameter estimation of the mcmc algorithms has been presented in table s1 the geweke test showed that the markov chain has good convergency geweke value of most parameters approaches to 1 meanwhile the values of both standard deviation std and evaluated error mc err are very small which mean the mcmc algorithms have good estimation effects of model parameters based on the results of parameter estimation fig s1 and the second column in table s1 all species biomass showed damped oscillations over time when seasonal forcing was not included r 0 in the food web model c1 0 1565 α4 0 8502 fig 2 a then when we take into account seasonal forcing r 0 16 in the food web model the population biomass showed sustained irregular oscillations of chaotic systems when c 1 is changed c1 0 055 fig 2b or α4 α4 0 3 fig 2c through a large number of numerical simulations fig s2 we found that the chaotic population dynamics only emerged by changing the value of c1 or α4 in our food web model for each figure in fig s2 the results showed that except for two key parameters c1 and α4 adjusting most parameters will not result in a drastic change of dynamic behaviour such as transition from nonchaos to chaos and vice versa all the changes of population biomass have a continuous process when we change each parameter so our food web model has a good robustness next we analyzed the biomass and stability change with c1 and α4 under seasonal or without seasonal forcing environment fig 3 without seasonal forcing r 0 the food web model will not exhibit chaotic dynamics fig 3a b as c1 or α4 increases the le value is always lower than zero fig s3a s3b with seasonal forcing r 0 16 population chaos emerged under a narrow parameter range of c1 fig 3c and α4 fig 3d as c1 or α4 increases population biomass of each state variable will firstly undergo chaotic dynamics then inverse period doubling bifurcation with a continuous reducing the amplitudes finally reaches a regular oscillation the food web model can produce chaos le 0 when both c1 and α4 have lower values fig s3c s3d the above analyses fig 3 only consider a single parameter c1 or α4 in the food web model then we obtained the two parameter bifurcation analysis fig 4 in fig 4 for six state variables the irregular oscillation regions will decrease when we increase the value of α4 what s more as c1 increases the irregular oscillation regions also decrease when α4 0 5 each biomass will easily produce the irregular oscillation no matter the value of c1 is however when α4 0 5 1 each population biomass will present two kinds of pattern when c1 0 023 0 171 for one thing the irregular oscillation will produce in the lower left regions for another the regular pattern regions can be obtained in the diagonal and top right corner regions from comparing these two approaches we suggest that decreasing the value of α4 is the main reason for the chaotic dynamics in our plankton community model 3 2 comparison between theoretical predictions and empirical data theoretical predictions show that population chaos le 0 can be found in our food web model fig s3c s3d then we calculated the largest lyapunov exponent of the experimental data first the time delay τ 2 was calculated for five state variables n pp np ro and cy and τ 4 for ca table s2 due to the plankton community having been cultivated for more than 2650 days this system has a fixed time delay τ for each species and nutrition benincà et al 2008 so we set τ 2 for all six state variables second we obtained the embedding dimension m 12 the total relative error of each variable has a small value for the plankton community table s2 finally by combining τ 2 with m 12 we calculated the lyapunov exponents of each time series table 2 which were similar to the earlier results benincà et al 2008 the lyapunov exponent of both the food web model and empirical data were greater than zero so we found chaotic behviour in our food web model and empirical data 4 discussion in this study we combined empirical data with food web model to analyze the population dynamics of the plankton community that included one nutrient pool two producers two consumers and a top predator the maximum lyapunov exponents of empirical data were positive table 1 which were similar to the earlier research benincà et al 2008 at the same time we calculated the lyapunov exponent with varying c1 and α4 the result showed that the positive lyapunov exponent of model calculation fig s3c s3d is lower than experimental data table 1 the partly reasons are that the time span of field data is shorter than iteration time of model simulation while time horizon is inversely proportional to the lyapunov exponent strogatz 1994 the results of both empirical data analysis and model simulation showed that there may exist the chaotic dynamics in the plankton system 4 1 seasonal variability in plankton community as an intrinsic property one of the main reasons for finding chaotic dynamics in our model was the introduction of seasonal fluctuations we took into account the effects of seasonal fluctuations on the mortality of consumers and top predator our model simulation fig 3 show that this mechanism of seasonally entrained chaos positive le can easily create seasonal variability in species composition in fact seasonal variability can be a natural property of the plankton community dakos et al 2009 each autumn species enter the winter season in different proportions thus the species composition from the previous autumn affects the species composition of the next spring bloom the earlier research consider that the magnitude of the le is not influenced by the strength of seasonal fluctuations dakos et al 2009 while the predictability of time horizon is inversely proportional to the le strogatz 1994 thus seasonality does not necessarily influence the time horizon for prediction of changes in the plankton community structure 4 2 top down control can produce the chaos another reason that our model can produce chaotic dynamics is that we change the intraspecific competition coefficient of a consumer when we decreased the intraspecific competition strength of calanoid copepods we found chaos in the plankton community due to the lack of a predator of calanoid copepods in our system fig 1 decreasing the intraspecific competition increased the population biomass of calanoid copepods and strengthened the top down control in the food web model both theoretical abrams 1999 and empirical research snyder and ives 2003 ishii and shimada 2012 proved that the predator can mediate coexistence by using the top down control the food web model also presented chaotic dynamics when we decreased the value of nitrogen absorptivity of the nanophytoplankton thus we can infer that regulating the nitrogen uptake rate of np will play an important role in the dynamic change of the plankton community compared the two parameter bifurcation analyses fig 4 we maintain that decreasing the intraspecific competition strength of calanoid copepods is the main reason for the chaotic dynamics in the plankton community that is top down control can promote species coexistence and change system stability 5 conclusion species coexistence in the plankton community which is considered as the plankton paradox hutchinson 1961 has been extensively discussed in studying of the aquatic ecosystem huisman and weissing 1999 both empirical benincà et al 2008 and theoretical benincà et al 2009 research showed that chaotic population dynamics emerged in the plankton community and theoretical work clodong and blasius 2004 also proved that seasonal variation produce population chaos to reduce species extinction however there is still a lack of empirical research to analyze how both seasonal forcing and species interactions affect species coexistence and system stability in the plankton community in this work both data analysis and model simulation showed that population chaos is indeed in the plankton system we found both the intraspecific competition coefficient of calanoid copepods predator and seasonal forcing are the key factors which can produce chaotic population dynamics in the plankton system meanwhile earlier research showed the chaotic dynamics prevent species extinction allen et al 1993 and maintain biodiversity huisman and weissing 1999 vandermeer 2006 brose 2008 our work re evaluate how both internal factor species interactions and external factor seasonal forcing affect species coexistence and system stability in the plankton community which may provide a new approach to uncover the plankton paradox authors contributions x y s and r w w conceived the study and all authors participated in study design y t analyzed the experimental data and l w carried out model analyses y t and l w wrote the first draft of the paper all authors contributed substantially to revisions funding this work was supported by graduate creative innovation seed fund zz2017237 of northwestern polytechnical university to y t acknowledgements the authors would like to thank christopher j greyson gaito and jennifer meunier for comments on earlier versions of the manuscript and two anonymous referees and santanu ray for many useful suggestions that improved the quality of this article appendix a supplementary data supplementary material related to this article can be found in the online version at doi https doi org 10 1016 j ecolmodel 2019 108721 appendix a supplementary data the following are supplementary data to this article 
25014,species coexistence in the plankton community which is also known as the plankton paradox has been extensively discussed in studies of the aquatic ecosystem theoretical work also proves that seasonal variation can produce population chaos which can reduce species extinction however there is still a lack of empirical research to analyze how both species interactions and seasonal forcing affect both species coexistence and system stability in the plankton community in this work we model plankton system via combining both seasonal temperature and a food web model with prey preference and further use the markov chain monte carlo mcmc algorithms to estimate model parameters theoretical predictions show both internal factor intraspecific competition coefficient of calanoid copepods and external factor seasonal temperature are the key factors which can produce population chaos meanwhile phase space reconstruction method shows lyapunov exponents of empirical data are positive both theoretical predictions and empirical data show the plankton community presents the chaotic dynamics which reduce species extinction and may help understand the plankton paradox keywords species coexistence plankton paradox seasonal forcing lyapunov exponent mcmc food web model 1 introduction the relationship between biodiversity and system stability has always been a controversial topic in ecological research may 1973 pimm 1985 mccann 2000 ives and carpenter 2007 ives ives 2005 systematically discusses three kinds of viewpoints of diversity stability diversity increases community stability diversity decreases community stability and diversity increases whole community stability but decreases individual species stability traditional theory predicts that diversity and complexity can cause community instability may 1973 however how does it explain the opposite effect of community and population levels earlier theoretical research showed that the chaotic dynamic of the population can decrease species extinction and promote species diversity allen et al 1993 károlyi et al 2000 since the discovery of chaotic dynamics in ecology using simple population models by may may 1974 much research based on mathematical models showed that chaos can arise in many different ecological processes including predator prey interactions gilpin 1979 scheffer 1991 vandermeer 1993 food chain dynamics hastings and powell 1991 multispecies competition for limiting resources huisman and weissing 1999 and plant herbivore fluctuations abbott and dwyer 2007 at the same time the field evidence of chaos also gradually accumulated tilman and wedin 1991 hanski et al 1993 turchin and ellner 2000 benincà et al 2015 so chaos may be commonplace in ecological system hastings et al 1993 in the aquatic ecosystem the biodiversity puzzle is known as the plankton paradox hutchinson 1961 which is particularly troublesome only a few resources are potentially limiting for phytoplankton however there are dozens of phytoplankton species coexisting in natural waters in essence the plankton paradox is assigned to the argument of diversity stability complexity in the plankton community plankton communities are a classic example of ecological chaos in nature sugihara and may 1990 scheffer 1991 both empirical research horwood 1995 and theoretical research huisman and weissing 1999 discussed the chaotic dynamics in the plankton community huisman and weissing huisman and weissing 1999 established a resource competition model to try to solve the plankton paradox and the theoretical results showed that when the nutrient concentrations are low the chaotic dynamics of phytoplankton abundance favor the coexistence of more species and enhance species diversity after this the chaotic dynamics of the plankton community were extensively discussed in the theoretical research clodong and blasius 2004 benincà et al 2008 klausmeier and litchman 2012 and chaotic dynamics may be the intrinsic properties of complex community hastings et al 1993 seasonal variation eg temperature will have an important influence on population dynamics in the plankton community clodong and blasius 2004 dakos et al 2009 seasonal induced chaos can be found in the rocky intertidal community benincà et al 2015 temperature fluctuates every season in most ecosystems and therefore chaotic dynamics may also be driven by temperature although beninca et al benincà et al 2008 tested temperature in their empirical analysis of plankton dynamics we still lack research which combines empirical data and theoretical models to interpret how seasonal forcing affects population dynamics in the plankton community species interaction induced chaos can be found in the plankton community huisman and weissing 1999 benincà et al 2008 2009 benincà et al benincà et al 2008 2009 collected time series data of nutrition and plankton nutrition nitrogen and phosphorus plankton ten species such as cyanobacteria and rotifers 2319 days of tracking records to investigate chaotic population dynamics first they calculated a chaotic property of empirical data of both species and nutrient and then used a neural network method to predict data benincà et al 2008 however this work did not involve the dynamic mechanism modeling of the plankton community so we cannot understand the intrinsic mechanism of chaotic dynamics in the plankton community to solve this problem benincà et al benincà et al 2009 established a theoretical model to analyze the chaotic population dynamics however parameter estimation of the model is not derived from the experimental data what s more they only chose a two trophic interactions only four species and neglected the influences of nutrient and top predator in plankton community in this study we will introduce seasonal temperature into the plankton system by combining empirical data with a food web model we aim to explore the relationship between species diversity and system stability in the plankton community and examine whether seasonal temperature and species interactions create chaos our work will help enhance the understanding of complex population dynamics in the plankton community 2 methods 2 1 study system and experimental data the long term experiment of a plankton community isolated from the baltic sea 54 26 n 12 42 e and the population abundances of the species were counted twice a week from 12 july 1990 to 20 october 1997 heerkloss and klinkenberg 1998 the plankton community and original data were published online by benincà benincà et al 2008 which includes two nutrients nitrogen n and phosphorus one detritus pool and ten species picophytoplankton pp nanophytoplankton np filamentous diatoms protozoa rotifers ro calanoid copepods ca cyclopoid cy heterotrophic bacteria ostracods harpacticoid copepods however different from the previous work benincà et al 2008 2009 we will combine a theoretical model with empirical data to study the population dynamics in the plankton community due to the biomass of some species eg protozoa and filamentous diatoms having too many zeros we neglected the interactions of these species and obtained a new system fig 1 this system includes three trophic levels and six state variables abiotic nutrition n producers pp np consumers ro ca and a top predator cy we dealt with the original data with the piecewise cubic hermite interpolating polynomial then we performed corresponding transformation eg ln 1 x for each column of time series data x 90 day 2658 day 2 2 food web model in order to systematically study the dynamic behaviour of the plankton community fig 1 we established a mechanistic model to analyze the complex species interactions the earlier research benincà et al 2009 used the type ii functional response term to build a simple food web model with two trophic levels and four species in our work we added both nutrient and an extra trophic level top predator in the simple food webs meanwhile we considered the choice preference of one consumer rotifers to two resources picophytoplankton nanophytoplankton for facilitating parameter estimation we adopted the type i functional response in a new food web model 1a d x d t a 1 s x a 2 x y 1 a 3 x y 2 1b d y 1 d t b 1 x y 1 1 α 1 y 1 β 1 y 2 π b 2 y 1 z 1 b 3 y 1 1 z 2 l 1c d y 2 d t c 1 x y 2 1 α 2 y 2 β 2 y 1 1 π c 2 y 2 z 1 c 3 y 2 z 2 1d d z 1 d t d 1 π y 1 d 2 1 π y 2 z 1 1 α 3 z 1 β 3 z 2 m 1 f t z 1 d 3 z 1 w 1e d z 2 d t e 1 y 1 e 2 y 2 z 2 1 α 4 z 2 β 4 z 1 m 2 f t z 2 1f d w d t f z 1 w 1 w k m 3 f t w where the six state variables x n y1 pp y2 np z1 ro z2 ca w cy a1 resource turnover rate s resource supply a2 a3 resource consumption rate b1 c1 d1 d2 e1 e2 f development rate l threshold value b2 b3 c2 c3 d3 predation rate α j β j j 1 4 intraspecific and interspecific competition coefficient k capacity mi i 1 3 morality rate we set prey preference function post et al 2000 π θ y 1 θ y 1 1 θ y 2 and θ is the preference θ 0 1 of z1 preys on y1 1 θ is the preference of z1 preys on y2 similar to an earlier method benincà et al 2015 we assumed that the natural mortality of consumer z1 z2 and top predator w are forced by seasonal temperature fluctuations ft 1 r tmax tmean cos 2 π t 377 365 where the scaling coefficient r represents the strength of seasonal forcing tmean is the mean temperature of 20 28 c measured at the research site and tmax is the temperature of 25 9 c measured on the warmest day of the year at t 377 day benincà et al 2008 both state variables and parameters of the food web model can be found in table 1 in eq 1a a 1 s x is the addition of nitrogen from the outside a 2 x y 1 and a 3 x y 2 represent a reduction in nitrogen due to the consumption by consumers in eq 1b b 1 x y 1 1 α 1 y 1 β 1 y 2 is the potential growth of y1 π b 2 y 1 z 1 represents a reduction in pp due to the predation of z1 b 3 y 1 1 z 2 l represents a reduction in pp due to the predation of z2 and l is the threshold value if z2 l it has a negative relation such as predation between y1 and z2 while if z2 l due to z2 having a rather large population density there is a stronger competition between z1 and z2 it will indirectly decrease the predation of z1 to y1 so it could have a positive relation between z2 and y1 in eq 1c c 1 x y 2 1 α 2 y 2 β 2 y 1 is the potential growth of y2 1 π c 2 y 2 z 1 and c 3 y 2 z 2 represent a reduction in np due to the predation of z1 and z2 respectively in eq 1d d 1 π y 1 d 2 1 π y 2 z 1 1 α 3 z 1 β 3 z 2 is the potential growth of z1 due to consuming y1 and y2 m 1 z 1 is the natural mortality of z1 d 3 z 1 w represents a reduction in z1 due to the predation of w in eq 1e e 1 y 1 e 2 y 2 z 2 1 α 4 z 2 β 4 z 1 is the potential growth of z2 due to consuming y1 and y2 m 2 z 2 is the natural mortality of z2 in eq 1f f z 1 w 1 w k is the potential growth of w due to consuming z1 m 3 w is the natural mortality of w 2 3 model and empirical data analyses we first set a constant environment ft 1 and used the markov chain monte carlo mcmc algorithms haario et al 2006 to calculate model parameters because with many parameters 30 in our case global estimation methods such as mcmc provide higher accuracy than local estimate methods such as the least square method then we did the bifurcation analyses by changing both one and two parameters at a time for the empirical data to verify the chaotic fluctuation of populations first the autocorrelation method was used to calculate the time delay τ rosenstein et al 1993 then the radial basis function rbf neural networks method was conducted to predict the suitable embedding dimension m li and wang 2002 combining τ with m we calculated the largest lyapunov exponent le by reconstructing the attractor dynamics from a single data set wolf et al 1985 finally we compared with lyapunov exponent between theoretical model and empirical data 3 results 3 1 theoretical predictions parameter estimation of the mcmc algorithms has been presented in table s1 the geweke test showed that the markov chain has good convergency geweke value of most parameters approaches to 1 meanwhile the values of both standard deviation std and evaluated error mc err are very small which mean the mcmc algorithms have good estimation effects of model parameters based on the results of parameter estimation fig s1 and the second column in table s1 all species biomass showed damped oscillations over time when seasonal forcing was not included r 0 in the food web model c1 0 1565 α4 0 8502 fig 2 a then when we take into account seasonal forcing r 0 16 in the food web model the population biomass showed sustained irregular oscillations of chaotic systems when c 1 is changed c1 0 055 fig 2b or α4 α4 0 3 fig 2c through a large number of numerical simulations fig s2 we found that the chaotic population dynamics only emerged by changing the value of c1 or α4 in our food web model for each figure in fig s2 the results showed that except for two key parameters c1 and α4 adjusting most parameters will not result in a drastic change of dynamic behaviour such as transition from nonchaos to chaos and vice versa all the changes of population biomass have a continuous process when we change each parameter so our food web model has a good robustness next we analyzed the biomass and stability change with c1 and α4 under seasonal or without seasonal forcing environment fig 3 without seasonal forcing r 0 the food web model will not exhibit chaotic dynamics fig 3a b as c1 or α4 increases the le value is always lower than zero fig s3a s3b with seasonal forcing r 0 16 population chaos emerged under a narrow parameter range of c1 fig 3c and α4 fig 3d as c1 or α4 increases population biomass of each state variable will firstly undergo chaotic dynamics then inverse period doubling bifurcation with a continuous reducing the amplitudes finally reaches a regular oscillation the food web model can produce chaos le 0 when both c1 and α4 have lower values fig s3c s3d the above analyses fig 3 only consider a single parameter c1 or α4 in the food web model then we obtained the two parameter bifurcation analysis fig 4 in fig 4 for six state variables the irregular oscillation regions will decrease when we increase the value of α4 what s more as c1 increases the irregular oscillation regions also decrease when α4 0 5 each biomass will easily produce the irregular oscillation no matter the value of c1 is however when α4 0 5 1 each population biomass will present two kinds of pattern when c1 0 023 0 171 for one thing the irregular oscillation will produce in the lower left regions for another the regular pattern regions can be obtained in the diagonal and top right corner regions from comparing these two approaches we suggest that decreasing the value of α4 is the main reason for the chaotic dynamics in our plankton community model 3 2 comparison between theoretical predictions and empirical data theoretical predictions show that population chaos le 0 can be found in our food web model fig s3c s3d then we calculated the largest lyapunov exponent of the experimental data first the time delay τ 2 was calculated for five state variables n pp np ro and cy and τ 4 for ca table s2 due to the plankton community having been cultivated for more than 2650 days this system has a fixed time delay τ for each species and nutrition benincà et al 2008 so we set τ 2 for all six state variables second we obtained the embedding dimension m 12 the total relative error of each variable has a small value for the plankton community table s2 finally by combining τ 2 with m 12 we calculated the lyapunov exponents of each time series table 2 which were similar to the earlier results benincà et al 2008 the lyapunov exponent of both the food web model and empirical data were greater than zero so we found chaotic behviour in our food web model and empirical data 4 discussion in this study we combined empirical data with food web model to analyze the population dynamics of the plankton community that included one nutrient pool two producers two consumers and a top predator the maximum lyapunov exponents of empirical data were positive table 1 which were similar to the earlier research benincà et al 2008 at the same time we calculated the lyapunov exponent with varying c1 and α4 the result showed that the positive lyapunov exponent of model calculation fig s3c s3d is lower than experimental data table 1 the partly reasons are that the time span of field data is shorter than iteration time of model simulation while time horizon is inversely proportional to the lyapunov exponent strogatz 1994 the results of both empirical data analysis and model simulation showed that there may exist the chaotic dynamics in the plankton system 4 1 seasonal variability in plankton community as an intrinsic property one of the main reasons for finding chaotic dynamics in our model was the introduction of seasonal fluctuations we took into account the effects of seasonal fluctuations on the mortality of consumers and top predator our model simulation fig 3 show that this mechanism of seasonally entrained chaos positive le can easily create seasonal variability in species composition in fact seasonal variability can be a natural property of the plankton community dakos et al 2009 each autumn species enter the winter season in different proportions thus the species composition from the previous autumn affects the species composition of the next spring bloom the earlier research consider that the magnitude of the le is not influenced by the strength of seasonal fluctuations dakos et al 2009 while the predictability of time horizon is inversely proportional to the le strogatz 1994 thus seasonality does not necessarily influence the time horizon for prediction of changes in the plankton community structure 4 2 top down control can produce the chaos another reason that our model can produce chaotic dynamics is that we change the intraspecific competition coefficient of a consumer when we decreased the intraspecific competition strength of calanoid copepods we found chaos in the plankton community due to the lack of a predator of calanoid copepods in our system fig 1 decreasing the intraspecific competition increased the population biomass of calanoid copepods and strengthened the top down control in the food web model both theoretical abrams 1999 and empirical research snyder and ives 2003 ishii and shimada 2012 proved that the predator can mediate coexistence by using the top down control the food web model also presented chaotic dynamics when we decreased the value of nitrogen absorptivity of the nanophytoplankton thus we can infer that regulating the nitrogen uptake rate of np will play an important role in the dynamic change of the plankton community compared the two parameter bifurcation analyses fig 4 we maintain that decreasing the intraspecific competition strength of calanoid copepods is the main reason for the chaotic dynamics in the plankton community that is top down control can promote species coexistence and change system stability 5 conclusion species coexistence in the plankton community which is considered as the plankton paradox hutchinson 1961 has been extensively discussed in studying of the aquatic ecosystem huisman and weissing 1999 both empirical benincà et al 2008 and theoretical benincà et al 2009 research showed that chaotic population dynamics emerged in the plankton community and theoretical work clodong and blasius 2004 also proved that seasonal variation produce population chaos to reduce species extinction however there is still a lack of empirical research to analyze how both seasonal forcing and species interactions affect species coexistence and system stability in the plankton community in this work both data analysis and model simulation showed that population chaos is indeed in the plankton system we found both the intraspecific competition coefficient of calanoid copepods predator and seasonal forcing are the key factors which can produce chaotic population dynamics in the plankton system meanwhile earlier research showed the chaotic dynamics prevent species extinction allen et al 1993 and maintain biodiversity huisman and weissing 1999 vandermeer 2006 brose 2008 our work re evaluate how both internal factor species interactions and external factor seasonal forcing affect species coexistence and system stability in the plankton community which may provide a new approach to uncover the plankton paradox authors contributions x y s and r w w conceived the study and all authors participated in study design y t analyzed the experimental data and l w carried out model analyses y t and l w wrote the first draft of the paper all authors contributed substantially to revisions funding this work was supported by graduate creative innovation seed fund zz2017237 of northwestern polytechnical university to y t acknowledgements the authors would like to thank christopher j greyson gaito and jennifer meunier for comments on earlier versions of the manuscript and two anonymous referees and santanu ray for many useful suggestions that improved the quality of this article appendix a supplementary data supplementary material related to this article can be found in the online version at doi https doi org 10 1016 j ecolmodel 2019 108721 appendix a supplementary data the following are supplementary data to this article 
