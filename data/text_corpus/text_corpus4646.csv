index,text
23230,modular adaptable ships have received growing attention in recent decades as a promising approach to handling uncertainty in future operating contexts a modular adaptable ship can be used for multiple purposes by changing its module configuration this configuration change is based on the ship s operation platform which is used as a common basis for multiple module configurations the design of an operation platform is a multi objective problem in which designers have to deal with the conflicting requirements of multiple missions and carefully determine the interfaces that affect the configurability and flexibility of the modules in this paper we present an optimization model for the design of an operation platform this determines the optimal platform design that best meets the desired capabilities of multiple missions while considering its expected lifecycle cost a platform s capabilities are evaluated based on its multiple module configurations for individual missions the evaluation of lifecycle cost uses operation scenarios due to its sensitivity we implemented the model in a case study involving an offshore support vessel for which an operation platform was designed to compete with inflexible multi purpose ships the results give insights into the platform design problem with opportunities for further improvement of the design keywords modular adaptable ship configure to order strategy operation platform design optimization lifecycle evaluation 1 introduction modular adaptable ship mas design is an approach to designing value robust ships that can maintain their value throughout the lifecycle mass can change their configuration based on modularity which is a particular structure in which tasks and parameters are interdependent within modules and independent across them baldwin and clark 2000 modules can be combined and separated efficiently which provides decision makers with strategic options for handling contextual uncertainty one example is the option to delay investment decisions until the need for particular modules is realized in a future operating context this is referred to as evolutionary acquisition which has been applied to the ship acquisition process of the us navy abbott et al 2008 another option is flexible mission selection because mass can change their functions through ship reconfiguration decision makers can use them for multiple purposes to maximize profit more related research works can be found in other works abbott et al 2008 doerry 2014 choi and erikstad 2017 choi et al 2017 rehn et al 2018 fig 1 illustrates the concepts of evolutionary acquisition and mission flexibility mas design can have potential synergy with the configure to order cto strategy the cto strategy is a bottom up development approach in which a design team creates prototype designs by configuring predeveloped standard modules this allows for reduced development time and cost as well as improved design reliability with proven technologies moreover rapid prototyping allows for better communication with customers which is essential for defining the appropriate key performance indicators for projects in ship design the standard modules comprise ship modules and task related modules erikstad and levander 2012 for instance ship modules include the main hull deckhouse bridge and tanks and voids which serve basic functions for ship operation such as buoyancy transition storage and accommodation examples of task related modules include weapons and sensor systems in navy ship design as well as topside modules such as well intervention towers cranes remotely operated vehicles rovs and saturated systems in offshore support vessel osv design in the cto strategy ship design projects can be defined by module configuration evaluation and selection to best meet individual customers needs fig 2 illustrates the process of ship design projects based on the cto strategy there are standard task related modules available for ship designers that are provided by third party vendors this enables ship designers to focus on the design of ship modules and the configuration of standard modules there are also approaches to module configuration and evaluation for mass the design building blocks andrews 2011 and packing approach van oers 2011 are available design synthesis approaches for mass these approaches create design alternatives using independent chunks which are referred to as blocks and objects respectively sødal et al 2008 present an evaluation method for flexible ships and compare the economic value of a multi purpose carrier with that of specialized carriers page 2012 uses a monte carlo simulation for evaluating the lifecycle cost of flexible naval ships pettersen and erikstad 2017 present a lifecycle evaluation model for flexible offshore construction vessels and estimate the value of flexibility by benchmarking the flexible designs against inflexible designs choi and erikstad 2017 focus on integration of module configuration and lifecycle evaluation and present an optimization model that determines the optimal initial module configuration based on the lifecycle value the lifecycle value in evaluations is defined by the net present value npv which includes the economic value of operational flexibility resulting from modularity this is the value of evolutionary acquisition and mission flexibility along these lines choi et al 2017 present a hybrid method for considering contextual uncertainty in a module configuration this approach uses both optimization and simulation the optimization determines the initial module configurations designs and the simulation evaluates them based on contract scenarios the simulation proceeds in a rolling horizon manner in which contextual information is gradually revealed during the simulation run and operational decisions are made in response to the information doerry and koenig 2017 present a framework for the design of mass that also considers contextual uncertainty in mas design the main difference between this method and the hybrid method by choi et al 2017 is the way that uncertainty is modeled while the hybrid method represents uncertainty as a set of deterministic scenarios doerry and koenig s 2017 framework represents uncertainty as a markov chain in a discrete time domain compared with the standardization of task related modules the standardization of ship modules has received less attention in the commercial sector there can be several possible explanations but one of the prime reasons could be the failure case of japanese shipyards in the 2000s major japanese shipyards focused on ship standardization however in the context of high oil prices customers were more interested in maximizing revenue rather than minimizing costs so they preferred customized ships for individual projects this caused the japanese shipyards to lose their market share to major korean shipyards which focused on high end customized ships park and hong 2015 however since 2014 the sharp drop in oil prices has changed the market situation in the context of low oil prices the low break even point makes the reduction of capital expenditure and operating expenditure more important as a result there is growing interest in the standardization of ships and even offshore production units which are generally considered as high end customized products agussol and lavagna 2017 wyllie et al 2017 the ship modules of a mas serve as an operation platform in the general context of engineering systems design the term platform or product platform indicates common parts components and modules from which a stream of derivative products can be created efficiently meyer and lehnerd 1997 however as rehn et al 2018 state these terms should be distinguished carefully while a product platform is a common basis for multiple products for mass customization an operation platform is a common basis for multiple configurations of a flexible product corl et al 2014 present an optimization model for the problem of ship platform design this model determines the optimal platform design for two different classes of navy ships the objective function is a multi objective function that comprises the mission effectiveness of each ship class and cost savings due to the commonality mission effectiveness is used instead of net profit because the navy ships are not designed for making profits in the analysis of cost savings the model considers savings from larger bulk purchases of components and the construction learning curve however this model is more related to the design of product platforms rather than operation platforms in this paper we present an optimization model for the design of a standard operation platform for mass this problem has multiple objectives due to the inherent nature of operation platforms in which a number of requirements of multiple missions conflict with each other and designers need to consider platform reconfiguration the model determines the optimal balancing point in terms of both capability and economic aspects the model considers platform interfaces that determine the configurability of task related modules and their operational flexibility for platform reconfiguration the rest of this paper is organized as follows in section 2 we describe the model in more detail and the underlying assumptions section 3 presents the mathematical concepts of the model in section 4 we implement the model in a case study and section 5 describes the results in section 6 we conclude the paper with a summary and future work 2 operation platform design for modular adaptable ships the presented model is a goal programming model in which the objective is to minimize the deviation between the desired capabilities of multiple missions and the achieved capabilities of the platform it is assumed that there is a given set of target missions or markets of the operation platform and given standard requirements for each mission in practice the mission set is defined strategically based on the company s portfolio the standard requirements are defined based on both quantitative and qualitative analyses such as the most likely or average values in platform design research defining the market set is referred to as platform strategy formulation for which a market segmentation grid meyer and lehnerd 1997 is often used the model calculates the platform s capabilities based on its best derivative designs the best derivative designs indicate ship designs that can be derived from the operation platform with the optimal module configurations for individual missions the optimal configurations are determined based on the lifecycle cost and the achieved capabilities the lifecycle cost includes the platform acquisition cost and expected costs of module acquisition and platform reconfiguration we use the term expected in this case because these costs are dependent on the operation scenario the model includes three types of decision variables basic variables slot interface variables and configuration variables respectively one underlying assumption is that the basic variables and slot variables are considered as platform variables which affect the capabilities and costs of all of the derivative designs the basic variables are related to ship modules and determine the basic capabilities of derivative designs for instance the length l breadth b depth d draught t and block coefficient c b are basic variables that have a great effect on the ship s basic capabilities such as the deck area deadweight tonnage dwt ship resistance stability and gross tonnage gt the slot variables determine the level of spatial energy material and signal support and are associated with the configurability of task related modules the slot variables also determine the configuration flexibility of the modules in the operation phase the model is based on an assumption that the task related modules basically have configuration flexibility in the design phase but whether they have the flexibility in the operation phase is dependent on the slot variables the configuration variables are used to determine the best derivative designs the configurability of modules is dependent on the slot variables so the values of the configuration variables are determined together with those of the platform variables during the optimization process fig 3 illustrates the relationship between the ship modules defined as the main body slots and task related modules using a class diagram described by the unified modeling language uml the main body has one or more slots and each slot has one or more alternatives the properties of the slot are determined based on the selected alternative a slot has a module list which comprises a set of task related modules each slot has a module and an empty slot is represented by assigning a dummy module each number of the class relationship represents the quantity that a class instance can have and the black and white diamonds represent physical and conceptual relationships respectively clark and evans 1997 provide a more detailed explanation of uml 3 mathematical model this section presents the mathematical concepts of the model the following is a description of the sets parameters and variables involved sets n set of missions indexed by n s set of slots indexed by s m s set of modules of slot s indexed by m a s set of slot alternatives of slot s indexed by a p set of capabilities indexed by p x set of basic variables indexed by x i y set of slot variables indexed by y s a z set of configuration variables indexed by z n s m parameters b n p goal value of capability p of mission n w n p weight that penalizes negative deviation of capability p in mission n w n p weight that penalizes positive deviation of capability p in mission n r p normalization factor of capability p l i x lower boundary of basic variable x i u i x upper boundary of basic variable x i n e c number of equality constraints n i c number of inequality constraints f s a 1 if slot alternative a of slot s allows for flexible module configuration 0 otherwise h s a m 1 if slot alternative a of slot s allows for configuration of module m 0 otherwise variables x i i th basic variable y s a 1 if slot alternative a is selected for slot s 0 otherwise z n s m 1 if module alternative m is configured to slot s in mission n 0 otherwise d n p negative deviation between goal and achieved capability p in mission n d n p positive deviation between goal and achieved capability p in mission n model 1 minimize n n p p w n p r p d n p n n p p w n p r p d n p 2 s t f n p u x y z d n p d n p b n p n n p p 3 d n p d n p 0 n n p p 4 y s a z n s m h s a m n n s s m m s a a s 5 1 f s a y s a z n 1 s m 1 f s a y s a z n 2 s m n 1 n 2 n s s m m s a a s 6 a a s y s a 1 s s 7 m m s z n s m 1 n n s s 8 g n j x y z 0 n n j 1 n e c 9 k n k x y z 0 n n k 1 n i c 10 x i 0 1 if x i is a binary variable i 1 x l i x x i u i x otherwise 11 y s a 0 1 s s a a s 12 z n s m 0 1 n n s s m m s equation 1 is the objective function which minimizes the deviation between the goal and achieved capabilities in multiple missions a negative deviation d n p and positive deviation d n p are penalized by weight w n p and weight w n p respectively the deviations are normalized by r p due to the different scales of each capability equations 2 and 3 define the deviations the achieved capability p in mission n is calculated by function f n p u x y z equation 4 allows for only feasible module configurations which are dependent on slot variables y an element of matrix h s a m is 1 if the configuration of module m is feasible when alternative a is selected for slot s otherwise it is 0 equation 5 allows only flexible slots to change their module configuration this is also dependent on slot variables y equation 6 ensures that only one slot alternative is selected for a slot equation 7 ensures that every slot is assigned one module equations 8 and 9 are equality and inequality constraints that ensure that the designs derived from the operation platform meet given physical and economic constraints examples are the constraint of metacentric height gm for intact stability and the constraint of expected lifecycle cost the economic constraint makes sure that the derivative ships have a competitive price compared with competing ships the costs include the costs to exercise options such as additional module acquisition and ship reconfiguration costs the lifecycle costs are evaluated based on a set of scenarios because they are dependent on the operation scenario equations 10 12 define the basic slot and configuration variables 4 case study we applied the model to the design of modular adaptable osvs the goal is to design a standard multi purpose platform that best meets the market requirements with affordability the derivative designs of the platform would compete with conventional inflexible multi purpose vessels which are not designed for vessel reconfiguration in operation the target market is medium size multi purpose vessels generally from 4000 to 6000 dwt the mission set is defined by platform supply ps diving support ds offshore construction and installation oci and inspection maintenance and repair imr missions the key capabilities are defined by dwt deck area maximum speed crane capability the number of divers moonpool size the number of rovs and dynamic positioning dp class fig 4 illustrates the requirements of each mission which are defined by the goal capabilities b n p in this platform design problem we use asymmetric penalty weights where negative deviations are more weighted than positive deviations table 1 provides information about weights w n p and w n p the sum of all weights is 1 the platform is defined by six basic variables x and three slot variables y table 2 describes the basic variables basic variable x 5 is an integer variable that determines the moonpool size if x 5 1 the platform does not have a moonpool if x 5 2 or 3 the platform has a moonpool with a size of 49 m 2 or 81 m 2 respectively the platform has a rov slot s 1 ds system slot s 2 and crane slot s 3 and each slot has four alternatives a 1 2 3 or 4 the higher number of slot alternatives indicates the higher level of spatial structural and energy support for the configuration of modules alternative 3 of ds system slot for instance indicates a larger deck space with higher strength than that of alternative 1 and 2 this enables the slot to configure a wider range of ds modules but increases the platform acquisition cost as well alternative 4 of each slot is designed for configuration flexibility in the operation phase the slot alternative is designed based on alternative 3 assuming that the additional effort on the development of the configuration flexibility increases the platform acquisition cost table 3 describes the configuration flexibility and the cost of alternatives of each slot which are defined by f s a and c s a s l respectively for instance the selection of slot alternative 4 of ds system slot y 24 1 indicates that the slot is designed for configuration flexibility f 24 1 and the cost is 1 2m c 24 s l 1 2 each slot has a list of module alternatives table 4 describes the module information the achieved capability p by the configuration of module m of slot s is defined by u s m p m d and the module acquisition cost is defined by c s m m d the configuration of module 2 of ds system slot in imr mission z 422 1 for instance provides a capability of 12 divers u 225 m d 12 while it causes the loss of dwt of 76 tonnes u 221 m d 76 and a deck area of 48 m 2 u 222 m d 48 the first module alternative of each slot is a dummy module for which the value is 0 for cost and capabilities table 5 presents the values of matrix h s a m the matrix value is 1 if module alternative m can be configured to slot s when alternative a is selected for the slot otherwise the value is 0 in this case study the normalization factor r p is always greater than the goal and achieved capabilities thus the normalized deviations have a value between 0 and 1 table 6 describes the normalization factors the objective is to minimize the deviations the achieved value of capability p in mission n is calculated by the function f n p u x y z equations 13 18 describe the functions equation 13 calculates the net dwt of a derivative design which is calculated by deducting the weight of configured modules from the dwt of the platform equation 14 calculates the net deck area which is calculated by deducting the area of modules and moonpool size from the deck area of the platform the moonpool size is determined by basic variable x 5 which is defined in equation 18 equation 15 also calculates the maximum speed of the derivative design and equations 16 17 and 19 calculate the crane ds and rov capabilities these capabilities are determined based on the configured modules described in table 4 equation 20 calculates the dp class of a derivative design which is determined by basic variable x 6 13 f n 1 u x y z 0 3824 1 027 x 1 x 2 x 3 c b 503 8 s s m m s u s m 1 m d z n s m 14 f n 2 u x y z 0 547 x 1 x 2 39 8 s s m m s u s m 2 m d z n s m f n 6 u x y z 15 f n 3 u x y z x 3 16 f n 4 u x y z m m s u 3 m 4 m d z n 3 m 17 f n 5 u x y z m m s u 2 m 5 m d z n 2 m 18 f n 6 u x y z 0 i f x 5 1 49 i f x 5 2 81 i f x 5 3 19 f n 7 u x y z m m s u 1 m 7 m d z n 1 m 20 f n 8 u x y z x 6 physical constraints are described in equations 21 24 equation 21 does not allow for fat platform designs which have a relatively short length compared with their breadth and block coefficient equation 22 ensures that hull designs have feasible and intact stability equation 23 ensures that hull designs have a required freeboard of 1 6 m and equation 24 enables hull designs to have the recommended c b according to watson and gilfillan 1977 21 c b l b 0 15 22 g m 0 15 23 d t 1 6 24 c b 0 7 0 0125 tan 1 23 100 fn 4 we used a set of 60 operation scenarios for evaluating the lifecycle cost a single scenario is defined by e and its set is defined by e each scenario comprises a series of missions in 4 time periods we assume that the operation time of the platform is 20 years which makes each time period is 5 years the lifecycle cost is calculated by aggregating the platform acquisition cost and the expected cost of module acquisition and platform reconfiguration the function f e l c x y z e in equation 25 calculates the lifecycle cost in a single scenario e the function f p c x y calculates the platform acquisition cost with the assumption that the cost is not affected by the operation scenario equation 26 defines f p c x y the cost is proportional to the product of dwt and the maximum speed of the platform including moonpool cost c x 5 m p dp system cost c x 6 d p and slot cost s a c s a s l y s a the cost of different sizes of moonpools and dp systems is presented in table 7 equation 27 defines the function f e m c z e which calculates the module acquisition cost based on operation scenario e the function f e s m m a z e returns 1 if module m of slot s is used in operation scenario e otherwise it returns 0 the module cost c s m m d is presented in table 4 equation 28 defines the function f e r c z e which calculates the platform reconfiguration cost in operation scenario e c r c is a fixed platform reconfiguration cost for each time for which we used 1 5m the function f e n r z e returns the number of reconfigurations in operation scenario e this number is dependent on the configuration variables z and the operation scenario e we also assume that if the module configuration is the same in two missions there is no platform reconfiguration cost for transition between the missions 25 f e l c x y z e f p c x y z f e m c z e f e r c z e 26 f p c x y 0 000402 0 3824 1 027 x 1 x 2 x 3 c b 503 8 f f n 3 u x y z 1 572 c x 5 m p c x 6 d p s s a a s c s a s l y s a 27 f e m c z e s s m m s c s m m d f e s m m a z e 28 f e r c z e c r c f e n r z e 5 numerical simulation results we used a genetic algorithm ga to solve the optimization problem because of its effectiveness in combinatorial optimization problems juan et al 2015 the ga used 100 chromosomes of populations and the termination criterion was reaching the 2000 th iteration the optimization time was approximately 25 s on an intel r core tm i7 2600 3 40 ghz cpu with 16 0 gb of ram the optimal platform design x and y and the optimal module configuration z in each mission are presented in tables 8 and 9 respectively the derivative designs of the platform are compared with an inflexible multi purpose ship which was created using the same optimization model without considering ship reconfiguration the inflexible ship was used as a benchmark ship with which the derivative designs would compete with in the market hence the cost of the benchmark ship was used as the lifecycle cost limit in the design of the operation platform see table 10 fig 5 compares the capabilities of the designs as shown in table 9 both the inflexible and flexible designs have the same module configurations in ds oci and imr missions this occurs because platform reconfiguration cost of the flexible design can be reduced if it has the same module configuration in the missions however in a ps mission the flexible platform removes the rov ds and crane modules for additional dwt and deck area thus the flexible design can have more dwt compared with the inflexible design although it has a shorter breadth most of the deviations of the flexible design are small but there are also some large deviations such as in the moonpool size in the ps mission and the dwt in the oci mission these large deviations occur because the moonpool size and dwt cannot be adjusted by a flexible module configuration although the ga determines the optimal balancing point within the limit of the lifecycle cost the deviation of the number of divers in oci and imr missions occurs because the penalty weights on the positive deviations are relatively small 0 001 and 0 respectively the identified problems involving large deviations could also be opportunities for developing the design further for instance the deviation of the moonpool size in the ps mission could be reduced by considering a moonpool ready system the system has doors on the top and bottom so it can serve as a moonpool or storage space according to the demand this may increase the acquisition cost of the operation platform but it would be valuable for further investigating the benefits and costs the target mission list could also be redefined based on the design results for instance the oci mission requires a relatively high dwt and deck area compared to other missions thus it is difficult to meet the requirements of the oci mission because the increased dwt and deck area have negative effects on other missions instead we can consider excluding the oci mission from the target mission list and including another mission that better fits the other missions 6 conclusions in this paper we have discussed the cto strategy and standard modules for efficient design of mass we presented an optimization model for the design of a standard operation platform which is a common basis for multiple module configurations of mass in this goal programming model the objective is to minimize the deviation between the goal and achieved capabilities in multiple missions regarding the lifecycle cost the model uses slot variables that are associated with the configurability of modules and determine whether to have reconfiguration options that can be exercised in the operation phase in evaluating platforms the model considers the best derivative designs using configuration variables and the designs are determined in terms of both capability and economic aspects the model was implemented in a case study in which we designed a standard operation platform for the design of modular adaptable osvs we compared the derivative designs with an inflexible multi purpose ship as a benchmark ship we assumed that the derivative designs would compete with the benchmark ship in the market and thus used the acquisition cost of the inflexible design as a cost limit in the design problem the design results provide insights into the design problem with opportunities to improve the design we defined deterministic goals based on the average demand of the target missions however it can be difficult to use the average values when a customer has particular preferences to address this a scalable design could be one solution in which one or more design variables are scalable that is the derivative designs can have a wider range of capabilities to satisfy particular preferences for instance scalable hulls have received attention for economies of scale in ship design and the technology is mature doerry 2014 however scalability can also decrease the reliability of knowledge on the standard design more specifically only some of the knowledge from previous projects is reusable if the scalable variables change the design significantly for example hull resistance is sensitive to changes in the hull dimensions therefore it would be difficult to reuse previous experiment results if there are major changes in the hull dimensions more research on this issue would be valuable in future studies goal programming models have generic difficulties in determining the normalization factors and weights thus although the optimization model proposes a platform design in a quantitative manner designers need to investigate the design further they should be aware that the design results are highly dependent on the given requirements preferences weights and operation scenarios one example is the penalty weights of the crane capability in the case study when we used symmetric weights that equally penalize the negative and positive deviations of the crane capability the ga determined an unacceptable design that switches its crane module in each individual mission although one crane can be used for multiple missions this occurs because we used improper penalty weights on the positive deviation of the crane capability in ship design the weights can be determined based on the effect of capabilities on the economic or utility value of designs however in many cases it is difficult to analyze the effect due to the complexity instead decision makers can use the relative importance of the capabilities in determining the weights analytical hierarchy process ahp for example can be used to determine the weights by comparison based on decision makers preference knowledge and experience we used a static module list in evaluating platform designs however the module list will evolve throughout the platform s lifecycle in particular there is high uncertainty in the future module list in the design of open architecture systems that share module interfaces with third party vendors although uncertainty is often considered as a negative risk it can also bring about significant potential benefits that increase the value of design mcmanus and hastings 2005 thus it is necessary to investigate the effects of future modules on the value of operation platforms 
23230,modular adaptable ships have received growing attention in recent decades as a promising approach to handling uncertainty in future operating contexts a modular adaptable ship can be used for multiple purposes by changing its module configuration this configuration change is based on the ship s operation platform which is used as a common basis for multiple module configurations the design of an operation platform is a multi objective problem in which designers have to deal with the conflicting requirements of multiple missions and carefully determine the interfaces that affect the configurability and flexibility of the modules in this paper we present an optimization model for the design of an operation platform this determines the optimal platform design that best meets the desired capabilities of multiple missions while considering its expected lifecycle cost a platform s capabilities are evaluated based on its multiple module configurations for individual missions the evaluation of lifecycle cost uses operation scenarios due to its sensitivity we implemented the model in a case study involving an offshore support vessel for which an operation platform was designed to compete with inflexible multi purpose ships the results give insights into the platform design problem with opportunities for further improvement of the design keywords modular adaptable ship configure to order strategy operation platform design optimization lifecycle evaluation 1 introduction modular adaptable ship mas design is an approach to designing value robust ships that can maintain their value throughout the lifecycle mass can change their configuration based on modularity which is a particular structure in which tasks and parameters are interdependent within modules and independent across them baldwin and clark 2000 modules can be combined and separated efficiently which provides decision makers with strategic options for handling contextual uncertainty one example is the option to delay investment decisions until the need for particular modules is realized in a future operating context this is referred to as evolutionary acquisition which has been applied to the ship acquisition process of the us navy abbott et al 2008 another option is flexible mission selection because mass can change their functions through ship reconfiguration decision makers can use them for multiple purposes to maximize profit more related research works can be found in other works abbott et al 2008 doerry 2014 choi and erikstad 2017 choi et al 2017 rehn et al 2018 fig 1 illustrates the concepts of evolutionary acquisition and mission flexibility mas design can have potential synergy with the configure to order cto strategy the cto strategy is a bottom up development approach in which a design team creates prototype designs by configuring predeveloped standard modules this allows for reduced development time and cost as well as improved design reliability with proven technologies moreover rapid prototyping allows for better communication with customers which is essential for defining the appropriate key performance indicators for projects in ship design the standard modules comprise ship modules and task related modules erikstad and levander 2012 for instance ship modules include the main hull deckhouse bridge and tanks and voids which serve basic functions for ship operation such as buoyancy transition storage and accommodation examples of task related modules include weapons and sensor systems in navy ship design as well as topside modules such as well intervention towers cranes remotely operated vehicles rovs and saturated systems in offshore support vessel osv design in the cto strategy ship design projects can be defined by module configuration evaluation and selection to best meet individual customers needs fig 2 illustrates the process of ship design projects based on the cto strategy there are standard task related modules available for ship designers that are provided by third party vendors this enables ship designers to focus on the design of ship modules and the configuration of standard modules there are also approaches to module configuration and evaluation for mass the design building blocks andrews 2011 and packing approach van oers 2011 are available design synthesis approaches for mass these approaches create design alternatives using independent chunks which are referred to as blocks and objects respectively sødal et al 2008 present an evaluation method for flexible ships and compare the economic value of a multi purpose carrier with that of specialized carriers page 2012 uses a monte carlo simulation for evaluating the lifecycle cost of flexible naval ships pettersen and erikstad 2017 present a lifecycle evaluation model for flexible offshore construction vessels and estimate the value of flexibility by benchmarking the flexible designs against inflexible designs choi and erikstad 2017 focus on integration of module configuration and lifecycle evaluation and present an optimization model that determines the optimal initial module configuration based on the lifecycle value the lifecycle value in evaluations is defined by the net present value npv which includes the economic value of operational flexibility resulting from modularity this is the value of evolutionary acquisition and mission flexibility along these lines choi et al 2017 present a hybrid method for considering contextual uncertainty in a module configuration this approach uses both optimization and simulation the optimization determines the initial module configurations designs and the simulation evaluates them based on contract scenarios the simulation proceeds in a rolling horizon manner in which contextual information is gradually revealed during the simulation run and operational decisions are made in response to the information doerry and koenig 2017 present a framework for the design of mass that also considers contextual uncertainty in mas design the main difference between this method and the hybrid method by choi et al 2017 is the way that uncertainty is modeled while the hybrid method represents uncertainty as a set of deterministic scenarios doerry and koenig s 2017 framework represents uncertainty as a markov chain in a discrete time domain compared with the standardization of task related modules the standardization of ship modules has received less attention in the commercial sector there can be several possible explanations but one of the prime reasons could be the failure case of japanese shipyards in the 2000s major japanese shipyards focused on ship standardization however in the context of high oil prices customers were more interested in maximizing revenue rather than minimizing costs so they preferred customized ships for individual projects this caused the japanese shipyards to lose their market share to major korean shipyards which focused on high end customized ships park and hong 2015 however since 2014 the sharp drop in oil prices has changed the market situation in the context of low oil prices the low break even point makes the reduction of capital expenditure and operating expenditure more important as a result there is growing interest in the standardization of ships and even offshore production units which are generally considered as high end customized products agussol and lavagna 2017 wyllie et al 2017 the ship modules of a mas serve as an operation platform in the general context of engineering systems design the term platform or product platform indicates common parts components and modules from which a stream of derivative products can be created efficiently meyer and lehnerd 1997 however as rehn et al 2018 state these terms should be distinguished carefully while a product platform is a common basis for multiple products for mass customization an operation platform is a common basis for multiple configurations of a flexible product corl et al 2014 present an optimization model for the problem of ship platform design this model determines the optimal platform design for two different classes of navy ships the objective function is a multi objective function that comprises the mission effectiveness of each ship class and cost savings due to the commonality mission effectiveness is used instead of net profit because the navy ships are not designed for making profits in the analysis of cost savings the model considers savings from larger bulk purchases of components and the construction learning curve however this model is more related to the design of product platforms rather than operation platforms in this paper we present an optimization model for the design of a standard operation platform for mass this problem has multiple objectives due to the inherent nature of operation platforms in which a number of requirements of multiple missions conflict with each other and designers need to consider platform reconfiguration the model determines the optimal balancing point in terms of both capability and economic aspects the model considers platform interfaces that determine the configurability of task related modules and their operational flexibility for platform reconfiguration the rest of this paper is organized as follows in section 2 we describe the model in more detail and the underlying assumptions section 3 presents the mathematical concepts of the model in section 4 we implement the model in a case study and section 5 describes the results in section 6 we conclude the paper with a summary and future work 2 operation platform design for modular adaptable ships the presented model is a goal programming model in which the objective is to minimize the deviation between the desired capabilities of multiple missions and the achieved capabilities of the platform it is assumed that there is a given set of target missions or markets of the operation platform and given standard requirements for each mission in practice the mission set is defined strategically based on the company s portfolio the standard requirements are defined based on both quantitative and qualitative analyses such as the most likely or average values in platform design research defining the market set is referred to as platform strategy formulation for which a market segmentation grid meyer and lehnerd 1997 is often used the model calculates the platform s capabilities based on its best derivative designs the best derivative designs indicate ship designs that can be derived from the operation platform with the optimal module configurations for individual missions the optimal configurations are determined based on the lifecycle cost and the achieved capabilities the lifecycle cost includes the platform acquisition cost and expected costs of module acquisition and platform reconfiguration we use the term expected in this case because these costs are dependent on the operation scenario the model includes three types of decision variables basic variables slot interface variables and configuration variables respectively one underlying assumption is that the basic variables and slot variables are considered as platform variables which affect the capabilities and costs of all of the derivative designs the basic variables are related to ship modules and determine the basic capabilities of derivative designs for instance the length l breadth b depth d draught t and block coefficient c b are basic variables that have a great effect on the ship s basic capabilities such as the deck area deadweight tonnage dwt ship resistance stability and gross tonnage gt the slot variables determine the level of spatial energy material and signal support and are associated with the configurability of task related modules the slot variables also determine the configuration flexibility of the modules in the operation phase the model is based on an assumption that the task related modules basically have configuration flexibility in the design phase but whether they have the flexibility in the operation phase is dependent on the slot variables the configuration variables are used to determine the best derivative designs the configurability of modules is dependent on the slot variables so the values of the configuration variables are determined together with those of the platform variables during the optimization process fig 3 illustrates the relationship between the ship modules defined as the main body slots and task related modules using a class diagram described by the unified modeling language uml the main body has one or more slots and each slot has one or more alternatives the properties of the slot are determined based on the selected alternative a slot has a module list which comprises a set of task related modules each slot has a module and an empty slot is represented by assigning a dummy module each number of the class relationship represents the quantity that a class instance can have and the black and white diamonds represent physical and conceptual relationships respectively clark and evans 1997 provide a more detailed explanation of uml 3 mathematical model this section presents the mathematical concepts of the model the following is a description of the sets parameters and variables involved sets n set of missions indexed by n s set of slots indexed by s m s set of modules of slot s indexed by m a s set of slot alternatives of slot s indexed by a p set of capabilities indexed by p x set of basic variables indexed by x i y set of slot variables indexed by y s a z set of configuration variables indexed by z n s m parameters b n p goal value of capability p of mission n w n p weight that penalizes negative deviation of capability p in mission n w n p weight that penalizes positive deviation of capability p in mission n r p normalization factor of capability p l i x lower boundary of basic variable x i u i x upper boundary of basic variable x i n e c number of equality constraints n i c number of inequality constraints f s a 1 if slot alternative a of slot s allows for flexible module configuration 0 otherwise h s a m 1 if slot alternative a of slot s allows for configuration of module m 0 otherwise variables x i i th basic variable y s a 1 if slot alternative a is selected for slot s 0 otherwise z n s m 1 if module alternative m is configured to slot s in mission n 0 otherwise d n p negative deviation between goal and achieved capability p in mission n d n p positive deviation between goal and achieved capability p in mission n model 1 minimize n n p p w n p r p d n p n n p p w n p r p d n p 2 s t f n p u x y z d n p d n p b n p n n p p 3 d n p d n p 0 n n p p 4 y s a z n s m h s a m n n s s m m s a a s 5 1 f s a y s a z n 1 s m 1 f s a y s a z n 2 s m n 1 n 2 n s s m m s a a s 6 a a s y s a 1 s s 7 m m s z n s m 1 n n s s 8 g n j x y z 0 n n j 1 n e c 9 k n k x y z 0 n n k 1 n i c 10 x i 0 1 if x i is a binary variable i 1 x l i x x i u i x otherwise 11 y s a 0 1 s s a a s 12 z n s m 0 1 n n s s m m s equation 1 is the objective function which minimizes the deviation between the goal and achieved capabilities in multiple missions a negative deviation d n p and positive deviation d n p are penalized by weight w n p and weight w n p respectively the deviations are normalized by r p due to the different scales of each capability equations 2 and 3 define the deviations the achieved capability p in mission n is calculated by function f n p u x y z equation 4 allows for only feasible module configurations which are dependent on slot variables y an element of matrix h s a m is 1 if the configuration of module m is feasible when alternative a is selected for slot s otherwise it is 0 equation 5 allows only flexible slots to change their module configuration this is also dependent on slot variables y equation 6 ensures that only one slot alternative is selected for a slot equation 7 ensures that every slot is assigned one module equations 8 and 9 are equality and inequality constraints that ensure that the designs derived from the operation platform meet given physical and economic constraints examples are the constraint of metacentric height gm for intact stability and the constraint of expected lifecycle cost the economic constraint makes sure that the derivative ships have a competitive price compared with competing ships the costs include the costs to exercise options such as additional module acquisition and ship reconfiguration costs the lifecycle costs are evaluated based on a set of scenarios because they are dependent on the operation scenario equations 10 12 define the basic slot and configuration variables 4 case study we applied the model to the design of modular adaptable osvs the goal is to design a standard multi purpose platform that best meets the market requirements with affordability the derivative designs of the platform would compete with conventional inflexible multi purpose vessels which are not designed for vessel reconfiguration in operation the target market is medium size multi purpose vessels generally from 4000 to 6000 dwt the mission set is defined by platform supply ps diving support ds offshore construction and installation oci and inspection maintenance and repair imr missions the key capabilities are defined by dwt deck area maximum speed crane capability the number of divers moonpool size the number of rovs and dynamic positioning dp class fig 4 illustrates the requirements of each mission which are defined by the goal capabilities b n p in this platform design problem we use asymmetric penalty weights where negative deviations are more weighted than positive deviations table 1 provides information about weights w n p and w n p the sum of all weights is 1 the platform is defined by six basic variables x and three slot variables y table 2 describes the basic variables basic variable x 5 is an integer variable that determines the moonpool size if x 5 1 the platform does not have a moonpool if x 5 2 or 3 the platform has a moonpool with a size of 49 m 2 or 81 m 2 respectively the platform has a rov slot s 1 ds system slot s 2 and crane slot s 3 and each slot has four alternatives a 1 2 3 or 4 the higher number of slot alternatives indicates the higher level of spatial structural and energy support for the configuration of modules alternative 3 of ds system slot for instance indicates a larger deck space with higher strength than that of alternative 1 and 2 this enables the slot to configure a wider range of ds modules but increases the platform acquisition cost as well alternative 4 of each slot is designed for configuration flexibility in the operation phase the slot alternative is designed based on alternative 3 assuming that the additional effort on the development of the configuration flexibility increases the platform acquisition cost table 3 describes the configuration flexibility and the cost of alternatives of each slot which are defined by f s a and c s a s l respectively for instance the selection of slot alternative 4 of ds system slot y 24 1 indicates that the slot is designed for configuration flexibility f 24 1 and the cost is 1 2m c 24 s l 1 2 each slot has a list of module alternatives table 4 describes the module information the achieved capability p by the configuration of module m of slot s is defined by u s m p m d and the module acquisition cost is defined by c s m m d the configuration of module 2 of ds system slot in imr mission z 422 1 for instance provides a capability of 12 divers u 225 m d 12 while it causes the loss of dwt of 76 tonnes u 221 m d 76 and a deck area of 48 m 2 u 222 m d 48 the first module alternative of each slot is a dummy module for which the value is 0 for cost and capabilities table 5 presents the values of matrix h s a m the matrix value is 1 if module alternative m can be configured to slot s when alternative a is selected for the slot otherwise the value is 0 in this case study the normalization factor r p is always greater than the goal and achieved capabilities thus the normalized deviations have a value between 0 and 1 table 6 describes the normalization factors the objective is to minimize the deviations the achieved value of capability p in mission n is calculated by the function f n p u x y z equations 13 18 describe the functions equation 13 calculates the net dwt of a derivative design which is calculated by deducting the weight of configured modules from the dwt of the platform equation 14 calculates the net deck area which is calculated by deducting the area of modules and moonpool size from the deck area of the platform the moonpool size is determined by basic variable x 5 which is defined in equation 18 equation 15 also calculates the maximum speed of the derivative design and equations 16 17 and 19 calculate the crane ds and rov capabilities these capabilities are determined based on the configured modules described in table 4 equation 20 calculates the dp class of a derivative design which is determined by basic variable x 6 13 f n 1 u x y z 0 3824 1 027 x 1 x 2 x 3 c b 503 8 s s m m s u s m 1 m d z n s m 14 f n 2 u x y z 0 547 x 1 x 2 39 8 s s m m s u s m 2 m d z n s m f n 6 u x y z 15 f n 3 u x y z x 3 16 f n 4 u x y z m m s u 3 m 4 m d z n 3 m 17 f n 5 u x y z m m s u 2 m 5 m d z n 2 m 18 f n 6 u x y z 0 i f x 5 1 49 i f x 5 2 81 i f x 5 3 19 f n 7 u x y z m m s u 1 m 7 m d z n 1 m 20 f n 8 u x y z x 6 physical constraints are described in equations 21 24 equation 21 does not allow for fat platform designs which have a relatively short length compared with their breadth and block coefficient equation 22 ensures that hull designs have feasible and intact stability equation 23 ensures that hull designs have a required freeboard of 1 6 m and equation 24 enables hull designs to have the recommended c b according to watson and gilfillan 1977 21 c b l b 0 15 22 g m 0 15 23 d t 1 6 24 c b 0 7 0 0125 tan 1 23 100 fn 4 we used a set of 60 operation scenarios for evaluating the lifecycle cost a single scenario is defined by e and its set is defined by e each scenario comprises a series of missions in 4 time periods we assume that the operation time of the platform is 20 years which makes each time period is 5 years the lifecycle cost is calculated by aggregating the platform acquisition cost and the expected cost of module acquisition and platform reconfiguration the function f e l c x y z e in equation 25 calculates the lifecycle cost in a single scenario e the function f p c x y calculates the platform acquisition cost with the assumption that the cost is not affected by the operation scenario equation 26 defines f p c x y the cost is proportional to the product of dwt and the maximum speed of the platform including moonpool cost c x 5 m p dp system cost c x 6 d p and slot cost s a c s a s l y s a the cost of different sizes of moonpools and dp systems is presented in table 7 equation 27 defines the function f e m c z e which calculates the module acquisition cost based on operation scenario e the function f e s m m a z e returns 1 if module m of slot s is used in operation scenario e otherwise it returns 0 the module cost c s m m d is presented in table 4 equation 28 defines the function f e r c z e which calculates the platform reconfiguration cost in operation scenario e c r c is a fixed platform reconfiguration cost for each time for which we used 1 5m the function f e n r z e returns the number of reconfigurations in operation scenario e this number is dependent on the configuration variables z and the operation scenario e we also assume that if the module configuration is the same in two missions there is no platform reconfiguration cost for transition between the missions 25 f e l c x y z e f p c x y z f e m c z e f e r c z e 26 f p c x y 0 000402 0 3824 1 027 x 1 x 2 x 3 c b 503 8 f f n 3 u x y z 1 572 c x 5 m p c x 6 d p s s a a s c s a s l y s a 27 f e m c z e s s m m s c s m m d f e s m m a z e 28 f e r c z e c r c f e n r z e 5 numerical simulation results we used a genetic algorithm ga to solve the optimization problem because of its effectiveness in combinatorial optimization problems juan et al 2015 the ga used 100 chromosomes of populations and the termination criterion was reaching the 2000 th iteration the optimization time was approximately 25 s on an intel r core tm i7 2600 3 40 ghz cpu with 16 0 gb of ram the optimal platform design x and y and the optimal module configuration z in each mission are presented in tables 8 and 9 respectively the derivative designs of the platform are compared with an inflexible multi purpose ship which was created using the same optimization model without considering ship reconfiguration the inflexible ship was used as a benchmark ship with which the derivative designs would compete with in the market hence the cost of the benchmark ship was used as the lifecycle cost limit in the design of the operation platform see table 10 fig 5 compares the capabilities of the designs as shown in table 9 both the inflexible and flexible designs have the same module configurations in ds oci and imr missions this occurs because platform reconfiguration cost of the flexible design can be reduced if it has the same module configuration in the missions however in a ps mission the flexible platform removes the rov ds and crane modules for additional dwt and deck area thus the flexible design can have more dwt compared with the inflexible design although it has a shorter breadth most of the deviations of the flexible design are small but there are also some large deviations such as in the moonpool size in the ps mission and the dwt in the oci mission these large deviations occur because the moonpool size and dwt cannot be adjusted by a flexible module configuration although the ga determines the optimal balancing point within the limit of the lifecycle cost the deviation of the number of divers in oci and imr missions occurs because the penalty weights on the positive deviations are relatively small 0 001 and 0 respectively the identified problems involving large deviations could also be opportunities for developing the design further for instance the deviation of the moonpool size in the ps mission could be reduced by considering a moonpool ready system the system has doors on the top and bottom so it can serve as a moonpool or storage space according to the demand this may increase the acquisition cost of the operation platform but it would be valuable for further investigating the benefits and costs the target mission list could also be redefined based on the design results for instance the oci mission requires a relatively high dwt and deck area compared to other missions thus it is difficult to meet the requirements of the oci mission because the increased dwt and deck area have negative effects on other missions instead we can consider excluding the oci mission from the target mission list and including another mission that better fits the other missions 6 conclusions in this paper we have discussed the cto strategy and standard modules for efficient design of mass we presented an optimization model for the design of a standard operation platform which is a common basis for multiple module configurations of mass in this goal programming model the objective is to minimize the deviation between the goal and achieved capabilities in multiple missions regarding the lifecycle cost the model uses slot variables that are associated with the configurability of modules and determine whether to have reconfiguration options that can be exercised in the operation phase in evaluating platforms the model considers the best derivative designs using configuration variables and the designs are determined in terms of both capability and economic aspects the model was implemented in a case study in which we designed a standard operation platform for the design of modular adaptable osvs we compared the derivative designs with an inflexible multi purpose ship as a benchmark ship we assumed that the derivative designs would compete with the benchmark ship in the market and thus used the acquisition cost of the inflexible design as a cost limit in the design problem the design results provide insights into the design problem with opportunities to improve the design we defined deterministic goals based on the average demand of the target missions however it can be difficult to use the average values when a customer has particular preferences to address this a scalable design could be one solution in which one or more design variables are scalable that is the derivative designs can have a wider range of capabilities to satisfy particular preferences for instance scalable hulls have received attention for economies of scale in ship design and the technology is mature doerry 2014 however scalability can also decrease the reliability of knowledge on the standard design more specifically only some of the knowledge from previous projects is reusable if the scalable variables change the design significantly for example hull resistance is sensitive to changes in the hull dimensions therefore it would be difficult to reuse previous experiment results if there are major changes in the hull dimensions more research on this issue would be valuable in future studies goal programming models have generic difficulties in determining the normalization factors and weights thus although the optimization model proposes a platform design in a quantitative manner designers need to investigate the design further they should be aware that the design results are highly dependent on the given requirements preferences weights and operation scenarios one example is the penalty weights of the crane capability in the case study when we used symmetric weights that equally penalize the negative and positive deviations of the crane capability the ga determined an unacceptable design that switches its crane module in each individual mission although one crane can be used for multiple missions this occurs because we used improper penalty weights on the positive deviation of the crane capability in ship design the weights can be determined based on the effect of capabilities on the economic or utility value of designs however in many cases it is difficult to analyze the effect due to the complexity instead decision makers can use the relative importance of the capabilities in determining the weights analytical hierarchy process ahp for example can be used to determine the weights by comparison based on decision makers preference knowledge and experience we used a static module list in evaluating platform designs however the module list will evolve throughout the platform s lifecycle in particular there is high uncertainty in the future module list in the design of open architecture systems that share module interfaces with third party vendors although uncertainty is often considered as a negative risk it can also bring about significant potential benefits that increase the value of design mcmanus and hastings 2005 thus it is necessary to investigate the effects of future modules on the value of operation platforms 
23231,effects of pitching motion profile on energy harvesting performance of a semi active flapping foil using immersed boundary method weizhong li a wen quan wang a yan yan a fang bao tian b a department of engineering mechanics faulty of civil engineering and mechanics kunming university of science and technology kunming yunnan 650500 china department of engineering mechanics faulty of civil engineering and mechanics kunming university of science and technology kunming yunnan 650500 china b school of engineering and information technology university of new south wales canberra act 2600 australia school of engineering and information technology university of new south wales canberra act 2600 australia corresponding author effects of pitching motion profile on energy harvesting performance of a semi active flapping foil are numerically studied using immersed boundary method firstly the numerical method is validated by considering a sinusoidal pitching semi active flapping foil at re 1000 and a uniform flow over a stationary foil at reynolds number re 500 then we consider a semi active flapping foil with reynolds number re 1000 and study the effect of sine like and cosine like pitching motion on the energy harvesting performance at reduced frequency f 0 16 we study the pitching with a gradual change from a sinusoid cosinusoid to a square wave as β is increased from one we found that increasing the value of β is ineffective to enhance energy harvesting efficiency for sine like pitching motion which is in agreement with the results of deng et al 2015 and teng et al 2016 however for cosine like pitching motion the highest energy harvesting efficiency of 51 81 is recorded for pitching amplitude θ 0 60 and β 2 0 meanwhile we observed that cosinusoidal pitching motion is more efficient for energy harvesting than sinusoidal pitching motion and non cosinusoidal pitching motion can enhance the harvesting efficiency compared to cosinusoidal pitching motion in detail we report the different performances of the sine like and cosine like pitching motion to study the mechanical mechanism of enhancing energy harvesting efficiency keywords projected immersed boundary method semi active flapping foil energy harvesting performance sine like pitching motion cosine like pitching motion 1 introduction in the new century the prominent problems of energy sources and environment are more and more severe using the renewable and zero pollution energy such as solar energy wind energy source and hydro energy instead of unregenerate energy sources such as coal natural gas and oil plays an important role in protecting natural environment olabi 2012 karbasian et al 2015 improving human s living and developing renewable energy economy antonio et al 2018 paiva et al 2018 and so on as a kind of green energy solar power technologies have emerged as a sustainable energy solution khan and arsalan 2016 there are many mature thermal energy storage materials solar energy conversion and its application methods in solar energy field enable dispatch ability in generation of electricity and home space heating requirements alva et al 2017 guney 2016 wind is the indirect form of solar energy and is caused by differential heating of the earth s surface by the sun wind energy exploitation has a long history work on the main issues of global market facts technology economics and environmental performance kaldellis and zafirakis 2011 there are also many advanced wind energy technologies and reliability evaluation models for design control systems and economics of wind energy conversion system many progresses islam et al 2013 were obtained and has been estimated that roughly 10 million mw of energy are continuously available in the earth s wind herbert et al 2007 although the solar energy and wind energy source are being extensively explored and had been applied in generating electricity extracting the energy from the ocean through the hydrodynamic machinery is still the most important way to capture energy in general the flow energy harvester with rotating pump turbines is used for capturing energy from water as an alternative way to extract power from flowing fluid flow energy harvester based on a flapping foil is a novel design inspired by aquatic animals insects and birds which has become a major focus for renewable energy research such a flapping foil turbines promise some key potential advantages including lower foil velocities and hence lower noise and wildlife impact shao and pan 2011 and more effective small scale and shallow water operation young et al 2014 wu 1971 wu and chwang 1975 first proposed the concept of extracting flow energy from the unsteady flow fields through an oscillating wing the application of a flapping foil to extract flow energy from uniform flows was first proposed by mckinney and delaurier 1981 lindsey 2002 studied the feasibility of oscillating wing power generators their work suggests that a wing mill could compete with conventional windmills in generating power flow energy harvesters based on flapping foils are investigated by many researchers as prescribed by reviews young et al 2014 xiao and zhu 2014 usually the device of a flapping foil used for energy harvesting undergoes heaving motion h t and pitching motion θ t according to the activating mechanism of the device the energy converters can be classified into three categories which are active system semi active system and passive system respectively the performance of an energy harvester depends on foil kinematics models frequencies amplitudes and time histories of motion foil and system geometry shape configuration and structural flexibility and flow physics effects reynolds number and turbulence shear flows and ground effect for fully active system the heaving motion h t and the pitching motion θ t are prescribed the models are simple and easy to formulate mathematically the results obtained can provide some useful theoretical insights and guidance for real devices design many extensive works have been carried out on fully active systems jones and platzer 1997 dumas and kinsey 2006 kinsey and dumas 2008 2011 studied the power extraction efficiency of a single oscillating airfoil with different reduced frequency and different pitching amplitude in which the efficiency reached as high as 35 esfahani et al 2015 and karbasian and kim 2016 have found that the motion trajectory of flapping foil would influence the flowing structure and change the vortex shedding pattern and wake zone behind the airfoil zhu 2011 reported that the energy harvesting efficiency of a flapping foil is related to the stability of the wake behind it karbasian et al 2016 have considered the effect of swill arm length on the performance of flapping foil hydrokinetic turbine and the amount of power the found that the swill arm mode may increase the amount of extracted power and improve the performance of hydrokinetic turbine non sinusoidal oscillating motions have also been introduced to enhance the efficiency of energy harvesting system xiao et al 2012 adopted a trapezoidal like pitching motion they found that there exists an optimal pitching motion which was proved to dramatically increase the output power coefficient and total output efficiency as high as 63 and 50 lu et al 2014 studied the effects of different non sinusoidal motion on the flapping foil energy extraction performance they found that energy extraction performance can be significantly improved with an appropriate combination of non sinusoidal pitching and non sinusoidal plunging motion moreover karbasian et al 2015 investigated the power extraction possibility by a number of flapping hydrofoils in tandem formation they have obtained higher power efficiency at low reynolds number and flapping frequency the fully active system need input much power since both the heaving motion h t and the pitching motion θ t are all actuated by extern electricity therefore some researcher put their eyes on the study of the semi active system in which only need to control actuated the pitching motion θ t the pitching motion is activated by input energy and energy harvesting is achieved through the resulting heaving motion generated by fluid dynamic lifting force we extract positive net energy if the energy harvesting is higher than energy input the performance of a semi active flapping foil energy harvester has been numerical investigated by zhu and peng 2009 and experimental researched by cochard et al 2012 they suggested that the performance depended on mechanical parameters including the magnitude of the damping and the location of the pitching axis as well as operational parameters e g the pitching frequency and pitching amplitude deng et al 2015 studied the effects of efficiency enhancement by sinusoidal motion for different reduced frequency f and pitching amplitude θ 0 they identified the optimal combination of the parameters of pitching amplitude θ 0 75 and reduced frequency f 0 16 which obtained the highest total energy efficiency more than 33 teng et al 2016 also researched the effects of efficiency enhancement by non sinusoidal motion for different reduced frequency f and different adjustable parameter β one can gradually change the designed pitching profile from sinusoidal β 1 0 to a square wave β they also pointed out that the optimal combination of the parameters is pitching amplitude θ 0 75 and reduced frequency f 0 16 with the highest total energy efficiency of 32 moreover they found that the increasing of β is ineffective in semi active system when θ 0 and f approaching its optimal value as pointed out by teng et al 2016 that the increasing effect of non sinusoidal pitching amplitude on efficiency was weak as θ 0 approaching its optimal value compared to semi active system passive system is more simplified on mechanical design in which the oscillatory motion in heaving and pitching directions are all actuated by the flow induced instabilities the subsequent energy extraction is positive since no actuation system is needed peng and zhu 2009 examined a fully passive flapping foil system by mounting a flapping foil on a damper and a rotational spring four different responses were recorded and stable energy could be obtained when periodic pitching and heaving motion were both periodically excited zhu 2012 also investigated the response of a purely passive flapping foil flow energy harvester in a linear shear flow it was indicated that in shear flows the devices were still capable of undergoing periodic responses as in uniform flows which was essential for reliable energy harvesting wang et al 2017 numerically investigated the structural response and energy extraction of a foil undergoing two degree of freedom fully passive flapping motions in a two dimensional flow at re 400 in the parametric space of flow reduced velocity and pivot location investigated five response regimes and the highest cycle averaged power efficiency 32 are identified young et al 2013 studied a fully passive flapping foil declaring an efficiency as high as 41 also some literature regard that structure flexibility may have significant effect on the energy harvesting performance tian et al 2014 wu et al 2015a b liu et al 2017 as described above extensive work has been researched on fully active system and obtained the highest energy harvesting efficiency of 50 in according to the study xiao et al 2012 however only a few of work has been studied on fully passive system and semi active system with the highest energy harvesting efficiency of 41 and 33 respectively inspired by the study xiao et al 2012 we are interested in combining the prescribed cosine like pitching motion with heaving motion determined by unsteady hydrodynamic forcing on the foil can enhance the energy harvesting efficiency or not therefore in the present work we employed numerical code based on projected immersed boundary method to solve the two dimensional navier stokes equations the flow by a semi active flapping foil is simulated with prescribed sinusoidal non sinusoidal cosinusoidal and non cosinusoidal pitching trajectories while the heaving motion is determined by the hydrodynamic force acting on the foil by tuning an adjustable parameter β one can gradually change the designed pitching profile from sinusoid cosine profile β 1 0 to a square wave β this study is therefore concerned on the difference of how motion trajectory affects power extraction performance we consider a two dimensional naca0012 oscillating foil with the reynolds number of 1000 calculated by the incoming flow velocity the chord length and the properties of the fluid computations will be simulated for a sinusoidal pitching trajectory with a series of β values along with pitching amplitude θ 0 75 and reduced frequency f 0 16 another pitching trajectory is computed with a series of β values along with different pitching amplitudes θ 0 and reduced frequency f 0 16 the rest of this paper is organized as follows the governing equations and the basic steps of the solution will be simply described in section 2 then the validation of the pibm is shown in section 3 in section 4 the numerical results of sine like and cosine like pitching motions for flapping foil are discussed and compared finally the paper is concluded by closing remarks in section 5 2 mathematical formulation and numerical method 2 1 projected immersed boundary method for fluid the problem is formulated by using cartesian coordinate system and the flow field is simulated by projected immersed boundary method pibm taira and colonius 2007 the reynolds number based upon the foil chord length a and upstream flow velocity u is 1000 and no turbulence model is used assuming the flow is incompressible the governing equations expressed as 1 u t u u p 1 r e 2 u f 2 u 0 where u is the fluid velocity p is the pressure r e ρ u l μ is the reynolds number u l and μ are incoming velocity the characteristic length of structure in our paper the chord length of hydrofoil is used and dynamic viscosity of fluid respectively f is the force density and solved by implicit force method ren et al 2012 the time dependent governing equations 1 and 2 are solved using the projected method which is also called pibm in the following we summarize the primary steps of this approach firstly we need to compute one predicted velocity field u without the terms of pressure and force density which is expressed as 3 u u n δ t u n u n 1 r e 2 u n where u n is the velocity field at the n th time step δ t is time step then we will solve a pressure poisson equation to get the pressure field p n 1 at n 1 th time step 4 2 p n 1 1 δ t u in the next two steps we will update the velocity filed twice employed pressure p n 1 and force density f n 1 at n 1 th time step respectively which are expressed as following 5 u u δ t p n 1 6 δ u δ t f n 1 finally we can obtain the velocity field u n 1 at n 1 th time step namely 7 u n 1 u δ u here the space discretizations are quick format for convection term and central difference for diffusive term respectively discrete delta function of the information transfer between the fluid grids and solid boundary meshes is a 4 point piecewise function namely 8 ϕ r 1 8 3 2 r 1 4 r 4 r 2 0 r 1 1 8 5 2 r 7 12 r 4 r 2 1 r 2 0 2 r according to the study results of yang et al 2009 some small numerical oscillations may be occur using eq 8 mainly due to the fact that the derivatives of the regular discrete delta functions do not satisfy certain moment conditions a smoothing technique for discrete delta functions can partly suppress the non physical oscillations in the volume forces however a 4 point piecewise function has been widely employed by many researches and verified that it is reliability although there is a small non physical oscillation to some cases so in our paper we still use eq 8 as information transfer function 2 2 mathematical formulation and solution for solid in this study a two dimensional naca0012 airfoil was adopted as shown in fig 1 the chord length of the foil is a the pivoting point is located at the center line of the foil with a distance b 0 3a from the leading edge the upstream flow velocity is denoted by u the foil performs combined motions of pitching and heaving the pitching angle is denoted by θ t the heaving displacement of the pivoting point from the origin in y direction is h and h a the displacement of heaving motion is denoted by h t the pitching motions θ t are prescribed through an actuating system the sine like and cosine like pitching profile are expressed as equation 9 and equation 10 respectively 9 θ θ 0 s i n β ω t 0 t π 2 β ω θ 0 π 2 β ω t π 2 ω 2 1 β θ 0 s i n β ω t π 1 β π 2 ω 2 1 β t π 2 ω 2 1 β θ 0 π 2 ω 2 1 β t π 2 ω 4 1 β θ 0 s i n β ω t 2 π 1 β π 2 ω 4 1 β t 2 π ω 10 θ θ 0 0 t π 2 ω 1 1 β θ 0 s i n β ω t π 1 β 2 π 2 ω 1 1 β t π 2 ω 1 1 β θ 0 π 2 ω 1 1 β t π 2 ω 3 1 β θ 0 s i n β ω t π 2 3 β 2 π 2 ω 3 1 β t π 2 ω 3 1 β θ 0 π 2 ω 3 1 β t 2 π ω where ω 2πf is the angular flapping frequency f fa u is reduced frequency the heaving motion h t is then activated by the fluid force acting on the foil and is determined by 11 m h c h f y where m represents the mass of the foil c represents the constant damping and f y represents the total force acting on the foil in y direction the definition of m c is same as teng et al 2016 the explicit fourth order runge kutta method kinsey and dumas 2008 is used to compute the transverse displacement and the heaving displacement and velocity of the foil can be expressed respectively as 12 h n 1 h n 1 6 k 1 k 2 k 3 k 4 δ t and 13 v y t h n 1 h n 1 6 l 1 l 2 l 3 l 4 δ t where 14 k 1 h n l 1 c m k 1 f y m k 2 h n δ t 2 l 1 l 2 c m k 2 f y m k 3 h n δ t 2 l 2 l 3 c m k 3 f y m k 4 h n δ t l 3 l 4 c m k 4 f y m through an actuating system a pitching motion θ t is activated the heaving motion is then generated as h h t assuming that the inertia of the foil is negligible the external torque me m required to actuate the pitching mode the instantaneous power input into the system is p i t me t θ t m t θ t where m t is the torque about the pivoting point and θ t is the angular velocity of the foil the power output is obtained by the damper c which can expressed as p o t c h 2 the instantaneous net power output is given by p t p o t p i t the mean power input power output and net power output are defined as 15 p i t 1 t t 0 t 0 t p i t d t p o t 1 t t 0 t 0 t p 0 t d t p p o t p i t where t 2π ω is the period of the system dimensionless coefficients for force torque power input power output net power and total energy harvesting efficiency are defined as 16 c y f y 0 5 ρ u 2 b a c m m 0 5 ρ u 2 b a 2 c p i p i 0 5 ρ u 3 b a 17 c p o p o 0 5 ρ u 3 b a c p p 0 5 ρ u 3 b a η p 0 5 ρ u 3 b d where ρ is density of the fluid b is the foil span d is the overall vertical extent of the foil motion calculated as the distance between the highest vertical position and the lowest vertical position reached by the trailing edges 3 validation 3 1 spacial and temporal resolutions analysis of the solver for a flapping foil the validation of the fluid solid interaction with moving boundary solver developed in section 2 will be presented in this section the pitching profile is expressed in eq 9 and the time variation of the pitching profile θ t θ 0 for different β as shown in fig 2 the foil pitches sinusoidally when β 1 0 a rectangular domain with dimensionless size of 15a 10a is taken for numerical simulation for spacial resolution analysis the time step of 1 10 3 a u 6 25 103 steps per cycle is examined for three sets of mesh size a coarse mesh of 2 4 105 a medium mesh of 5 4 105 and a fine mesh of 9 6 105 corresponding to 100 114 and 143 nodes on the foil surface respectively as shown in fig 3 the medium mesh resolution of the pitching moment coefficients c m t and heaving velocity v y t of the pivoting point are nearly coincide with the fine mesh table 1 shows the time average power input coefficient power output coefficient efficiency and relative error of efficiency for different mesh sizes it is shown that the medium mesh resolution provides satisfactory accuracy in space to compromise consider between the accuracy and computational time we choose the medium mesh of 5 4 105 for simulation in the following section a mesh of 5 4 105 cells is used for the temporal resolution analysis with three time steps 1 10 3 a u 6 25 103 steps per cycle 5 10 4 a u 1 25 104 steps per cycle and 1 10 4 a u 6 25 104 steps per cycle we plot the pitching moment coefficients and lift force coefficients over time as shown in fig 4 a and b respectively we can see that the results are nearly agreement among different time steps therefore the time step of 1 10 3 a u is employed in the next study then three different sinusoidal pitching amplitudes of 70 75 and 80 are simulated time mean power output c po power input c pi and total energy harvesting efficiency η are shown in table 2 we can see that the energy harvesting efficiency are 32 12 32 18 and 32 21 respectively it clarified that the effects of change pitching amplitude on energy harvesting efficiency is small when pitching amplitude is approach to optimal amplitude 3 2 flow over a stationary naca0012 airfoil the incompressible flow past a stationary naca0012 airfoil with the angle of attack α 0 is first chosen to validate the accuracy of pibm the origin of coordinates lies in the center of chord line of the airfoil the reynolds number is 500 based upon the foil chord length a and upstream flow velocity u the computational domain is 5a 10a 5a 5a with the uniform mesh size of 900 600 the dirichlet boundary condition is applied at the inlet boundary and natural boundary conditions are used on others the airfoil is represented by 160 lagrangian points with a uniform distribution fig 5 indicates the velocity profiles of the boundary layer at x 0 5 0 25 and 0 5 respectively we can find that these numerical results agree well with the results obtained by lockard et al 2002 in this work the drag coefficients are c d 0 179 which are also close to c d 0 176 by imamura et al 2005 and c d 0 172 by lockard et al 2002 4 results and analysis 4 1 non sinusoidal pitching profile energy harvesting performance for different β at f 0 16 θ 0 75 are computed the total energy harvesting efficiency at β 1 0 β 1 5 β 2 0 β 2 5 and β 3 0 are 32 18 29 02 17 63 14 21 and 10 81 respectively we can see that increasing the value of β is ineffective to enhance energy harvesting efficiency which is agreement with the results of deng et al 2015 and teng et al 2016 in order to explain increasing value of β is ineffective to enhance energy harvesting efficiency fig 6 a d show the lift force coefficients c y t the pitching moment coefficients c m t the heaving velocity v y t and heaving displacement h t over one period the seventh period for different β at f 0 16 θ 0 75 respectively from fig 6 d we can see that the heaving motion of the foil is steady after a few cycles when β 2 5 and the balanced positions of the vibrating foil descend a distance relative to the original balanced position the variations of heaving displacement h t are v like profiles and the most largest displacement appears when the foil arrives to the balanced location similarly the change of lift force coefficients c y t the pitching moment coefficients c m t and the heaving velocity v y t are periodicity after a few cycles when β 2 5 but it is not when β 2 5 meanwhile we also can see that the increasing rate of pitching moment coefficients c m t as shown in fig 6 b are more than that of heaving velocity v y t as shown in fig 6 c with the rising of β which is contributed to the drop of the energy harvesting efficiency with the rising of β fig 7 shows the evolution of vortex topology and pressure coefficient the pressure coefficients c p p p 0 5 ρ u 2 where p is pressure p are the upstream pressure from fig 7 it is clearly shown the evolving process of leading and trailing vortex and the strong vortex is always corresponding to low pressure center further leading to the changes of force and moment acting on the foil we can also see that the pressure on the upper surface of foil is larger than the down surface when the foil shift down during t t 0 1 2 where fluid dynamics prompt foil heaving movement which is beneficial to extract the flow energy however it is harmful to the upward pitching motion during t t 0 1 4 we need to input much energy to drive the foil and it is helpful for downward pitching motion during t t 1 4 1 2 so that we need to input a little energy to drive the foil as shown in fig 6 b the pitching moment coefficients c m t are negative in this case and the time averaged moment coefficients c m t is larger for t t 0 1 4 than for t t 1 4 1 2 similarly the pressure on the upper surface of foil is smaller than the down surface when the foil rise up during t t 1 2 1 the lift force is also beneficial to extract the flow energy while it is harmful to the downward pitching motion during t t 1 2 3 4 4 2 cosinusoidal pitching profile in this part we will focus on the energy extraction performance of semi active flapping foil with a cosinusoidal pitching motion the cosine like pitching profile is expressed as eq 10 and the time variation of the pitching profile θ t for different β as shown in fig 8 the foil pitches cosine curve when β 1 0 here a series of simulations were implemented for a wide range of maximum pitching amplitudes θ 0 15o 90 at f 0 16 and β 1 0 fig 9 illustrates the lift force coefficients pitching moment coefficients heaving velocity and vertical displacement for different θ 0 at f 0 16 β 1 0 we can see that from fig 9 a and b the peak values of lift force coefficient and pitching moment coefficient are all rising with the increasing of θ 0 the peak heaving velocity in fig 9 c is rising with the increasing of θ 0 when θ 0 is lower than 60 and a little reducing when θ 0 is higher than 60 as shown in fig 9 d the balanced position of the vibrating foil ascend a little distance relative to the original balanced position in a period but the upshift distance is nearly to zero when maximum pitching amplitude equals 60 and 75 so we concluded that the heaving motion is relative easy to steady when maximum pitching amplitude is equal to 60 and 75 compared with other cases fig 10 gives the variations of time mean power input c pi power output c p0 and total energy harvesting efficiency η for different θ 0 the total energy harvesting efficiency η is increasing with the rising of θ 0 when θ 0 changes from 15 to 45 while it is decreasing with the rising of θ 0 when θ 0 changes from 45 to 90 therefore the highest total energy harvesting efficiency η 44 22 is confirmed when the θ 0 60 since the motions of the system is stable only for θ 0 60 and θ 0 75 4 3 non cosinusoidal pitching profile for sake of researching the effects of non cosinusoidal pitching potion on the stability of the heaving motion figss 11 13 give the heaving displacement h t lift force coefficients c y t and velocity v y t for two typical pitching amplitudes of θ 0 45 and θ 0 60 respectively from fig 11 we find that the heaving motion is unstable when the pitching amplitudes is θ 0 45 for non cosinusoidal pitching however the heaving motion can reach stable state at θ 0 60 when the value of β is less than 3 0 the variations of vertical displacement h t are adverse sinusoid like profiles more obvious with the increasing of value of β from fig 12 and fig 13 we observe that the variations of lift force coefficients c y t are not anti symmetrical characteristic and the variations of velocity v y t have not good symmetrical characteristic for entire value of β at θ 0 45 and for the case of β 3 0 at θ 0 60 that s to say the anti symmetry of the variations of lift force coefficients c y t and the symmetry of the variations of velocity v y t in a period are requirement to guarantee the stability of the heaving motion of the hydrofoil the time mean power input c pi power output c p0 and total energy harvesting efficiency η under different β for θ 0 60 are plotted in fig 14 we can see that non cosinusoidal pitching motion is effective to enhance the energy harvesting efficiency with the increasing of β and the highest energy harvesting efficiency of 51 81 was obtained at β 2 0 and θ 0 60 to understand physical mechanism of the effect of variation of β in fig 15 we plot the vorticity contours of nine instants over one period the corresponding pressure contours are shown in fig 16 first we notice that low pressure is always generated in the fields of leading edge vortex lev and lev generates below the foil during t t 0 1 4 and t t 3 4 1 and above the hydrofoil during t t 1 4 3 4 when the heaving motion of the foil is shifting from high pressure zone toward to low pressure zone the distribution of vortex and pressure are helpful to the heaving motion over one period therefore the lev is contributed to the energy harvesting we also noticed that the scale of lev increases with rising of β such as apparently shown in fig 15 at t t 1 8 the scale of lev is larger for β 2 0 than for β 1 0 corresponding the low pressure zone is more large for β 2 0 than for β 1 0 this distribution of vortex and pressure are helpful for heaving motion over one period meanwhile there is a small trailing edge vortex formed which is more obvious for β 2 0 than β 1 0 but the scale and intense are far lower than the lev for such distributions of vortex and pressure the pitching motion is activated during t t 0 1 4 and t t 1 2 3 4 and it is resisted by the unsteady hydrodynamics during t t 1 4 1 2 and t t 3 4 1 as shown as in fig 15 b for β 1 5 and β 2 0 the lift force changes rapidly during t t 1 8 3 8 and t t 5 8 7 8 because actual stall happens as shown in fig 8 according to the discussion above the evolution of vortex and pressure remind us that the flow over a foil is strongly related to unsteady hydrodynamics a better performance of this energy generator by turning sinusoidal pitching to cosinusoidal pitching profile is achieved in which the unsteady hydrodynamic force is good for driving the heaving motion of the foil and turning the flow to an appropriate forming of the leading vortex and a good timing of its shedding from the foil 4 4 comparison between sine like and cosine like pitching profile in this section we father compare the maximum energy harvesting performance of sine like β 1 0 and θ 0 75 and cosine like pitching profile β 2 0 θ 0 60 for a semi active flapping foil with the reduce frequency f 0 16 corresponding to the maximum energy harvesting efficiency 32 18 and 51 81 respectively fig 17 gives the variations of force coefficient and kinematics for sinusoidal pitching profile for β 1 0 at f 0 16 θ 0 75 as shown in fig 17 b and c the variations of vertical velocity v y t and vertical displacement h t of the pivot are similar to but not cosinusoidal profile fig 18 gives the variations of force coefficient and kinematics for non cosinusoidal pitching profile for β 2 0 at f 0 16 θ 0 60 as shown in fig 18 b and c the variations of vertical velocity v y t of the pivot are inverse to cosine like pitching profile and the variations of vertical displacement h t of the pivot are inverse sinusoidal profile we observed that the variations of vertical velocity v y t of the pivot are similar to the pitching profile and the variations of vertical displacement h t of the pivot are authentic trigonometric function profile which is good for increasing the energy harvesting efficiency fig 19 a and b show the evolution of pressure of sinusoidal pitching profile for β 1 0 at f 0 16 θ 0 75 and non cosinusoidal pitching profile for β 2 0 at f 0 16 θ 0 60 respectively from the figures we observed that the foil always moves from the high pressure zone to the low pressure zone as shown in fig 19 a the foil pitching to the direction of higher pressure on the surface of the foil when t t 0 1 4 t t 1 2 3 4 which is not helpful to decrease the power input and the foil pitching to low pressure field when t t 1 4 1 2 t t 3 4 1 which is favorable for decreasing the power input similarity as shown in fig 19 b we can see that the foil pitching to the direction of lower pressure on the surface of the foil when t t 0 1 4 t t 1 2 3 4 which is good for decreasing the power input and the foil pitching to higher pressure field when t t 1 4 1 2 t t 3 4 1 which is not helpful to decrease the power input that s to say that there is not much difference between power input for sine like and cosine like pitching profile however the value of lift force coefficients c y t and vertical velocity v y t for cosine like pitching profile are larger than that of sine like pitching profile which is attributed to that the effect attack angle for cosine like profile is more close to the optimal attack angle of the foil than that for sine like profile therefore cosine like pitching profile is better than sine like pitching profile for energy extracting efficiency in the present semi active energy harvesting system 5 conclusions the fluid solid interaction model based on projected immersed boundary implicit direct force method is used to study the effects of pitching motion on energy extraction performance of a flapping foil the numerical method is firstly verified by two numerical tests namely flow over a stationary naca0012 airfoil and a semi active flapping foil with sinusoidal like pitch movement the conclusions agree well with the achievement which obtained by other literature then the effects of cosine like pitching profile on energy extraction performance with different pitching amplitudes change from θ 0 15 to θ 0 90 at flapping frequency f 0 16 were studied we observed that the balanced position of the oscillating foil ascend a distance relative to the original balanced position and the variations of heaving displacement h t are adverse sinusoidal like profile it clarified that the heaving motion are steady only in small scale of the maximum pitching amplitude transform from about θ 0 60 to θ 0 75 and the maximum of total energy harvesting efficiency η 44 22 is confirmed for θ 0 60 that is to say the cosinusoidal pitching profile for a semi active flapping foil can enhance the energy extraction performance comparison with the sinusoidal pitching profile in which the energy harvesting efficiency is η 32 18 meanwhile we researched the effects of non cosinusoidal pitching motion on the stability of the heaving motion and the energy extraction performance we found that the stability of heaving motion is worse with the increasing of value of β for θ 0 45 and it is better with the increasing of β from 1 0 to 2 5 for θ 0 60 it is effective to enhance the energy harvesting efficiency with the increasing of β and the highest energy harvesting efficiency 51 81 was obtained at β 2 0 for θ 0 60 finally we made a comparison between the sine like and cosine like pitching profiles for a semi active flapping foil with the reduce frequency f 0 16 in which the optimal combination of parameters are β 1 0 θ 0 75 for sine like pitching profile and β 2 0 θ 0 60 for cosine like pitching profile respectively we observed that cosine like pitching profile is better than sine like pitching profile for energy extracting efficiency in the present semi active energy harvesting system acknowledgements the work described in this paper is funded by the research grant from the natural science foundation of china grant nos 51479085 and 11262008 and the fok ying tung education foundation project no 141120 f b tian is the recipient of an australian research council discovery early career researcher award project no de160101098 
23231,effects of pitching motion profile on energy harvesting performance of a semi active flapping foil using immersed boundary method weizhong li a wen quan wang a yan yan a fang bao tian b a department of engineering mechanics faulty of civil engineering and mechanics kunming university of science and technology kunming yunnan 650500 china department of engineering mechanics faulty of civil engineering and mechanics kunming university of science and technology kunming yunnan 650500 china b school of engineering and information technology university of new south wales canberra act 2600 australia school of engineering and information technology university of new south wales canberra act 2600 australia corresponding author effects of pitching motion profile on energy harvesting performance of a semi active flapping foil are numerically studied using immersed boundary method firstly the numerical method is validated by considering a sinusoidal pitching semi active flapping foil at re 1000 and a uniform flow over a stationary foil at reynolds number re 500 then we consider a semi active flapping foil with reynolds number re 1000 and study the effect of sine like and cosine like pitching motion on the energy harvesting performance at reduced frequency f 0 16 we study the pitching with a gradual change from a sinusoid cosinusoid to a square wave as β is increased from one we found that increasing the value of β is ineffective to enhance energy harvesting efficiency for sine like pitching motion which is in agreement with the results of deng et al 2015 and teng et al 2016 however for cosine like pitching motion the highest energy harvesting efficiency of 51 81 is recorded for pitching amplitude θ 0 60 and β 2 0 meanwhile we observed that cosinusoidal pitching motion is more efficient for energy harvesting than sinusoidal pitching motion and non cosinusoidal pitching motion can enhance the harvesting efficiency compared to cosinusoidal pitching motion in detail we report the different performances of the sine like and cosine like pitching motion to study the mechanical mechanism of enhancing energy harvesting efficiency keywords projected immersed boundary method semi active flapping foil energy harvesting performance sine like pitching motion cosine like pitching motion 1 introduction in the new century the prominent problems of energy sources and environment are more and more severe using the renewable and zero pollution energy such as solar energy wind energy source and hydro energy instead of unregenerate energy sources such as coal natural gas and oil plays an important role in protecting natural environment olabi 2012 karbasian et al 2015 improving human s living and developing renewable energy economy antonio et al 2018 paiva et al 2018 and so on as a kind of green energy solar power technologies have emerged as a sustainable energy solution khan and arsalan 2016 there are many mature thermal energy storage materials solar energy conversion and its application methods in solar energy field enable dispatch ability in generation of electricity and home space heating requirements alva et al 2017 guney 2016 wind is the indirect form of solar energy and is caused by differential heating of the earth s surface by the sun wind energy exploitation has a long history work on the main issues of global market facts technology economics and environmental performance kaldellis and zafirakis 2011 there are also many advanced wind energy technologies and reliability evaluation models for design control systems and economics of wind energy conversion system many progresses islam et al 2013 were obtained and has been estimated that roughly 10 million mw of energy are continuously available in the earth s wind herbert et al 2007 although the solar energy and wind energy source are being extensively explored and had been applied in generating electricity extracting the energy from the ocean through the hydrodynamic machinery is still the most important way to capture energy in general the flow energy harvester with rotating pump turbines is used for capturing energy from water as an alternative way to extract power from flowing fluid flow energy harvester based on a flapping foil is a novel design inspired by aquatic animals insects and birds which has become a major focus for renewable energy research such a flapping foil turbines promise some key potential advantages including lower foil velocities and hence lower noise and wildlife impact shao and pan 2011 and more effective small scale and shallow water operation young et al 2014 wu 1971 wu and chwang 1975 first proposed the concept of extracting flow energy from the unsteady flow fields through an oscillating wing the application of a flapping foil to extract flow energy from uniform flows was first proposed by mckinney and delaurier 1981 lindsey 2002 studied the feasibility of oscillating wing power generators their work suggests that a wing mill could compete with conventional windmills in generating power flow energy harvesters based on flapping foils are investigated by many researchers as prescribed by reviews young et al 2014 xiao and zhu 2014 usually the device of a flapping foil used for energy harvesting undergoes heaving motion h t and pitching motion θ t according to the activating mechanism of the device the energy converters can be classified into three categories which are active system semi active system and passive system respectively the performance of an energy harvester depends on foil kinematics models frequencies amplitudes and time histories of motion foil and system geometry shape configuration and structural flexibility and flow physics effects reynolds number and turbulence shear flows and ground effect for fully active system the heaving motion h t and the pitching motion θ t are prescribed the models are simple and easy to formulate mathematically the results obtained can provide some useful theoretical insights and guidance for real devices design many extensive works have been carried out on fully active systems jones and platzer 1997 dumas and kinsey 2006 kinsey and dumas 2008 2011 studied the power extraction efficiency of a single oscillating airfoil with different reduced frequency and different pitching amplitude in which the efficiency reached as high as 35 esfahani et al 2015 and karbasian and kim 2016 have found that the motion trajectory of flapping foil would influence the flowing structure and change the vortex shedding pattern and wake zone behind the airfoil zhu 2011 reported that the energy harvesting efficiency of a flapping foil is related to the stability of the wake behind it karbasian et al 2016 have considered the effect of swill arm length on the performance of flapping foil hydrokinetic turbine and the amount of power the found that the swill arm mode may increase the amount of extracted power and improve the performance of hydrokinetic turbine non sinusoidal oscillating motions have also been introduced to enhance the efficiency of energy harvesting system xiao et al 2012 adopted a trapezoidal like pitching motion they found that there exists an optimal pitching motion which was proved to dramatically increase the output power coefficient and total output efficiency as high as 63 and 50 lu et al 2014 studied the effects of different non sinusoidal motion on the flapping foil energy extraction performance they found that energy extraction performance can be significantly improved with an appropriate combination of non sinusoidal pitching and non sinusoidal plunging motion moreover karbasian et al 2015 investigated the power extraction possibility by a number of flapping hydrofoils in tandem formation they have obtained higher power efficiency at low reynolds number and flapping frequency the fully active system need input much power since both the heaving motion h t and the pitching motion θ t are all actuated by extern electricity therefore some researcher put their eyes on the study of the semi active system in which only need to control actuated the pitching motion θ t the pitching motion is activated by input energy and energy harvesting is achieved through the resulting heaving motion generated by fluid dynamic lifting force we extract positive net energy if the energy harvesting is higher than energy input the performance of a semi active flapping foil energy harvester has been numerical investigated by zhu and peng 2009 and experimental researched by cochard et al 2012 they suggested that the performance depended on mechanical parameters including the magnitude of the damping and the location of the pitching axis as well as operational parameters e g the pitching frequency and pitching amplitude deng et al 2015 studied the effects of efficiency enhancement by sinusoidal motion for different reduced frequency f and pitching amplitude θ 0 they identified the optimal combination of the parameters of pitching amplitude θ 0 75 and reduced frequency f 0 16 which obtained the highest total energy efficiency more than 33 teng et al 2016 also researched the effects of efficiency enhancement by non sinusoidal motion for different reduced frequency f and different adjustable parameter β one can gradually change the designed pitching profile from sinusoidal β 1 0 to a square wave β they also pointed out that the optimal combination of the parameters is pitching amplitude θ 0 75 and reduced frequency f 0 16 with the highest total energy efficiency of 32 moreover they found that the increasing of β is ineffective in semi active system when θ 0 and f approaching its optimal value as pointed out by teng et al 2016 that the increasing effect of non sinusoidal pitching amplitude on efficiency was weak as θ 0 approaching its optimal value compared to semi active system passive system is more simplified on mechanical design in which the oscillatory motion in heaving and pitching directions are all actuated by the flow induced instabilities the subsequent energy extraction is positive since no actuation system is needed peng and zhu 2009 examined a fully passive flapping foil system by mounting a flapping foil on a damper and a rotational spring four different responses were recorded and stable energy could be obtained when periodic pitching and heaving motion were both periodically excited zhu 2012 also investigated the response of a purely passive flapping foil flow energy harvester in a linear shear flow it was indicated that in shear flows the devices were still capable of undergoing periodic responses as in uniform flows which was essential for reliable energy harvesting wang et al 2017 numerically investigated the structural response and energy extraction of a foil undergoing two degree of freedom fully passive flapping motions in a two dimensional flow at re 400 in the parametric space of flow reduced velocity and pivot location investigated five response regimes and the highest cycle averaged power efficiency 32 are identified young et al 2013 studied a fully passive flapping foil declaring an efficiency as high as 41 also some literature regard that structure flexibility may have significant effect on the energy harvesting performance tian et al 2014 wu et al 2015a b liu et al 2017 as described above extensive work has been researched on fully active system and obtained the highest energy harvesting efficiency of 50 in according to the study xiao et al 2012 however only a few of work has been studied on fully passive system and semi active system with the highest energy harvesting efficiency of 41 and 33 respectively inspired by the study xiao et al 2012 we are interested in combining the prescribed cosine like pitching motion with heaving motion determined by unsteady hydrodynamic forcing on the foil can enhance the energy harvesting efficiency or not therefore in the present work we employed numerical code based on projected immersed boundary method to solve the two dimensional navier stokes equations the flow by a semi active flapping foil is simulated with prescribed sinusoidal non sinusoidal cosinusoidal and non cosinusoidal pitching trajectories while the heaving motion is determined by the hydrodynamic force acting on the foil by tuning an adjustable parameter β one can gradually change the designed pitching profile from sinusoid cosine profile β 1 0 to a square wave β this study is therefore concerned on the difference of how motion trajectory affects power extraction performance we consider a two dimensional naca0012 oscillating foil with the reynolds number of 1000 calculated by the incoming flow velocity the chord length and the properties of the fluid computations will be simulated for a sinusoidal pitching trajectory with a series of β values along with pitching amplitude θ 0 75 and reduced frequency f 0 16 another pitching trajectory is computed with a series of β values along with different pitching amplitudes θ 0 and reduced frequency f 0 16 the rest of this paper is organized as follows the governing equations and the basic steps of the solution will be simply described in section 2 then the validation of the pibm is shown in section 3 in section 4 the numerical results of sine like and cosine like pitching motions for flapping foil are discussed and compared finally the paper is concluded by closing remarks in section 5 2 mathematical formulation and numerical method 2 1 projected immersed boundary method for fluid the problem is formulated by using cartesian coordinate system and the flow field is simulated by projected immersed boundary method pibm taira and colonius 2007 the reynolds number based upon the foil chord length a and upstream flow velocity u is 1000 and no turbulence model is used assuming the flow is incompressible the governing equations expressed as 1 u t u u p 1 r e 2 u f 2 u 0 where u is the fluid velocity p is the pressure r e ρ u l μ is the reynolds number u l and μ are incoming velocity the characteristic length of structure in our paper the chord length of hydrofoil is used and dynamic viscosity of fluid respectively f is the force density and solved by implicit force method ren et al 2012 the time dependent governing equations 1 and 2 are solved using the projected method which is also called pibm in the following we summarize the primary steps of this approach firstly we need to compute one predicted velocity field u without the terms of pressure and force density which is expressed as 3 u u n δ t u n u n 1 r e 2 u n where u n is the velocity field at the n th time step δ t is time step then we will solve a pressure poisson equation to get the pressure field p n 1 at n 1 th time step 4 2 p n 1 1 δ t u in the next two steps we will update the velocity filed twice employed pressure p n 1 and force density f n 1 at n 1 th time step respectively which are expressed as following 5 u u δ t p n 1 6 δ u δ t f n 1 finally we can obtain the velocity field u n 1 at n 1 th time step namely 7 u n 1 u δ u here the space discretizations are quick format for convection term and central difference for diffusive term respectively discrete delta function of the information transfer between the fluid grids and solid boundary meshes is a 4 point piecewise function namely 8 ϕ r 1 8 3 2 r 1 4 r 4 r 2 0 r 1 1 8 5 2 r 7 12 r 4 r 2 1 r 2 0 2 r according to the study results of yang et al 2009 some small numerical oscillations may be occur using eq 8 mainly due to the fact that the derivatives of the regular discrete delta functions do not satisfy certain moment conditions a smoothing technique for discrete delta functions can partly suppress the non physical oscillations in the volume forces however a 4 point piecewise function has been widely employed by many researches and verified that it is reliability although there is a small non physical oscillation to some cases so in our paper we still use eq 8 as information transfer function 2 2 mathematical formulation and solution for solid in this study a two dimensional naca0012 airfoil was adopted as shown in fig 1 the chord length of the foil is a the pivoting point is located at the center line of the foil with a distance b 0 3a from the leading edge the upstream flow velocity is denoted by u the foil performs combined motions of pitching and heaving the pitching angle is denoted by θ t the heaving displacement of the pivoting point from the origin in y direction is h and h a the displacement of heaving motion is denoted by h t the pitching motions θ t are prescribed through an actuating system the sine like and cosine like pitching profile are expressed as equation 9 and equation 10 respectively 9 θ θ 0 s i n β ω t 0 t π 2 β ω θ 0 π 2 β ω t π 2 ω 2 1 β θ 0 s i n β ω t π 1 β π 2 ω 2 1 β t π 2 ω 2 1 β θ 0 π 2 ω 2 1 β t π 2 ω 4 1 β θ 0 s i n β ω t 2 π 1 β π 2 ω 4 1 β t 2 π ω 10 θ θ 0 0 t π 2 ω 1 1 β θ 0 s i n β ω t π 1 β 2 π 2 ω 1 1 β t π 2 ω 1 1 β θ 0 π 2 ω 1 1 β t π 2 ω 3 1 β θ 0 s i n β ω t π 2 3 β 2 π 2 ω 3 1 β t π 2 ω 3 1 β θ 0 π 2 ω 3 1 β t 2 π ω where ω 2πf is the angular flapping frequency f fa u is reduced frequency the heaving motion h t is then activated by the fluid force acting on the foil and is determined by 11 m h c h f y where m represents the mass of the foil c represents the constant damping and f y represents the total force acting on the foil in y direction the definition of m c is same as teng et al 2016 the explicit fourth order runge kutta method kinsey and dumas 2008 is used to compute the transverse displacement and the heaving displacement and velocity of the foil can be expressed respectively as 12 h n 1 h n 1 6 k 1 k 2 k 3 k 4 δ t and 13 v y t h n 1 h n 1 6 l 1 l 2 l 3 l 4 δ t where 14 k 1 h n l 1 c m k 1 f y m k 2 h n δ t 2 l 1 l 2 c m k 2 f y m k 3 h n δ t 2 l 2 l 3 c m k 3 f y m k 4 h n δ t l 3 l 4 c m k 4 f y m through an actuating system a pitching motion θ t is activated the heaving motion is then generated as h h t assuming that the inertia of the foil is negligible the external torque me m required to actuate the pitching mode the instantaneous power input into the system is p i t me t θ t m t θ t where m t is the torque about the pivoting point and θ t is the angular velocity of the foil the power output is obtained by the damper c which can expressed as p o t c h 2 the instantaneous net power output is given by p t p o t p i t the mean power input power output and net power output are defined as 15 p i t 1 t t 0 t 0 t p i t d t p o t 1 t t 0 t 0 t p 0 t d t p p o t p i t where t 2π ω is the period of the system dimensionless coefficients for force torque power input power output net power and total energy harvesting efficiency are defined as 16 c y f y 0 5 ρ u 2 b a c m m 0 5 ρ u 2 b a 2 c p i p i 0 5 ρ u 3 b a 17 c p o p o 0 5 ρ u 3 b a c p p 0 5 ρ u 3 b a η p 0 5 ρ u 3 b d where ρ is density of the fluid b is the foil span d is the overall vertical extent of the foil motion calculated as the distance between the highest vertical position and the lowest vertical position reached by the trailing edges 3 validation 3 1 spacial and temporal resolutions analysis of the solver for a flapping foil the validation of the fluid solid interaction with moving boundary solver developed in section 2 will be presented in this section the pitching profile is expressed in eq 9 and the time variation of the pitching profile θ t θ 0 for different β as shown in fig 2 the foil pitches sinusoidally when β 1 0 a rectangular domain with dimensionless size of 15a 10a is taken for numerical simulation for spacial resolution analysis the time step of 1 10 3 a u 6 25 103 steps per cycle is examined for three sets of mesh size a coarse mesh of 2 4 105 a medium mesh of 5 4 105 and a fine mesh of 9 6 105 corresponding to 100 114 and 143 nodes on the foil surface respectively as shown in fig 3 the medium mesh resolution of the pitching moment coefficients c m t and heaving velocity v y t of the pivoting point are nearly coincide with the fine mesh table 1 shows the time average power input coefficient power output coefficient efficiency and relative error of efficiency for different mesh sizes it is shown that the medium mesh resolution provides satisfactory accuracy in space to compromise consider between the accuracy and computational time we choose the medium mesh of 5 4 105 for simulation in the following section a mesh of 5 4 105 cells is used for the temporal resolution analysis with three time steps 1 10 3 a u 6 25 103 steps per cycle 5 10 4 a u 1 25 104 steps per cycle and 1 10 4 a u 6 25 104 steps per cycle we plot the pitching moment coefficients and lift force coefficients over time as shown in fig 4 a and b respectively we can see that the results are nearly agreement among different time steps therefore the time step of 1 10 3 a u is employed in the next study then three different sinusoidal pitching amplitudes of 70 75 and 80 are simulated time mean power output c po power input c pi and total energy harvesting efficiency η are shown in table 2 we can see that the energy harvesting efficiency are 32 12 32 18 and 32 21 respectively it clarified that the effects of change pitching amplitude on energy harvesting efficiency is small when pitching amplitude is approach to optimal amplitude 3 2 flow over a stationary naca0012 airfoil the incompressible flow past a stationary naca0012 airfoil with the angle of attack α 0 is first chosen to validate the accuracy of pibm the origin of coordinates lies in the center of chord line of the airfoil the reynolds number is 500 based upon the foil chord length a and upstream flow velocity u the computational domain is 5a 10a 5a 5a with the uniform mesh size of 900 600 the dirichlet boundary condition is applied at the inlet boundary and natural boundary conditions are used on others the airfoil is represented by 160 lagrangian points with a uniform distribution fig 5 indicates the velocity profiles of the boundary layer at x 0 5 0 25 and 0 5 respectively we can find that these numerical results agree well with the results obtained by lockard et al 2002 in this work the drag coefficients are c d 0 179 which are also close to c d 0 176 by imamura et al 2005 and c d 0 172 by lockard et al 2002 4 results and analysis 4 1 non sinusoidal pitching profile energy harvesting performance for different β at f 0 16 θ 0 75 are computed the total energy harvesting efficiency at β 1 0 β 1 5 β 2 0 β 2 5 and β 3 0 are 32 18 29 02 17 63 14 21 and 10 81 respectively we can see that increasing the value of β is ineffective to enhance energy harvesting efficiency which is agreement with the results of deng et al 2015 and teng et al 2016 in order to explain increasing value of β is ineffective to enhance energy harvesting efficiency fig 6 a d show the lift force coefficients c y t the pitching moment coefficients c m t the heaving velocity v y t and heaving displacement h t over one period the seventh period for different β at f 0 16 θ 0 75 respectively from fig 6 d we can see that the heaving motion of the foil is steady after a few cycles when β 2 5 and the balanced positions of the vibrating foil descend a distance relative to the original balanced position the variations of heaving displacement h t are v like profiles and the most largest displacement appears when the foil arrives to the balanced location similarly the change of lift force coefficients c y t the pitching moment coefficients c m t and the heaving velocity v y t are periodicity after a few cycles when β 2 5 but it is not when β 2 5 meanwhile we also can see that the increasing rate of pitching moment coefficients c m t as shown in fig 6 b are more than that of heaving velocity v y t as shown in fig 6 c with the rising of β which is contributed to the drop of the energy harvesting efficiency with the rising of β fig 7 shows the evolution of vortex topology and pressure coefficient the pressure coefficients c p p p 0 5 ρ u 2 where p is pressure p are the upstream pressure from fig 7 it is clearly shown the evolving process of leading and trailing vortex and the strong vortex is always corresponding to low pressure center further leading to the changes of force and moment acting on the foil we can also see that the pressure on the upper surface of foil is larger than the down surface when the foil shift down during t t 0 1 2 where fluid dynamics prompt foil heaving movement which is beneficial to extract the flow energy however it is harmful to the upward pitching motion during t t 0 1 4 we need to input much energy to drive the foil and it is helpful for downward pitching motion during t t 1 4 1 2 so that we need to input a little energy to drive the foil as shown in fig 6 b the pitching moment coefficients c m t are negative in this case and the time averaged moment coefficients c m t is larger for t t 0 1 4 than for t t 1 4 1 2 similarly the pressure on the upper surface of foil is smaller than the down surface when the foil rise up during t t 1 2 1 the lift force is also beneficial to extract the flow energy while it is harmful to the downward pitching motion during t t 1 2 3 4 4 2 cosinusoidal pitching profile in this part we will focus on the energy extraction performance of semi active flapping foil with a cosinusoidal pitching motion the cosine like pitching profile is expressed as eq 10 and the time variation of the pitching profile θ t for different β as shown in fig 8 the foil pitches cosine curve when β 1 0 here a series of simulations were implemented for a wide range of maximum pitching amplitudes θ 0 15o 90 at f 0 16 and β 1 0 fig 9 illustrates the lift force coefficients pitching moment coefficients heaving velocity and vertical displacement for different θ 0 at f 0 16 β 1 0 we can see that from fig 9 a and b the peak values of lift force coefficient and pitching moment coefficient are all rising with the increasing of θ 0 the peak heaving velocity in fig 9 c is rising with the increasing of θ 0 when θ 0 is lower than 60 and a little reducing when θ 0 is higher than 60 as shown in fig 9 d the balanced position of the vibrating foil ascend a little distance relative to the original balanced position in a period but the upshift distance is nearly to zero when maximum pitching amplitude equals 60 and 75 so we concluded that the heaving motion is relative easy to steady when maximum pitching amplitude is equal to 60 and 75 compared with other cases fig 10 gives the variations of time mean power input c pi power output c p0 and total energy harvesting efficiency η for different θ 0 the total energy harvesting efficiency η is increasing with the rising of θ 0 when θ 0 changes from 15 to 45 while it is decreasing with the rising of θ 0 when θ 0 changes from 45 to 90 therefore the highest total energy harvesting efficiency η 44 22 is confirmed when the θ 0 60 since the motions of the system is stable only for θ 0 60 and θ 0 75 4 3 non cosinusoidal pitching profile for sake of researching the effects of non cosinusoidal pitching potion on the stability of the heaving motion figss 11 13 give the heaving displacement h t lift force coefficients c y t and velocity v y t for two typical pitching amplitudes of θ 0 45 and θ 0 60 respectively from fig 11 we find that the heaving motion is unstable when the pitching amplitudes is θ 0 45 for non cosinusoidal pitching however the heaving motion can reach stable state at θ 0 60 when the value of β is less than 3 0 the variations of vertical displacement h t are adverse sinusoid like profiles more obvious with the increasing of value of β from fig 12 and fig 13 we observe that the variations of lift force coefficients c y t are not anti symmetrical characteristic and the variations of velocity v y t have not good symmetrical characteristic for entire value of β at θ 0 45 and for the case of β 3 0 at θ 0 60 that s to say the anti symmetry of the variations of lift force coefficients c y t and the symmetry of the variations of velocity v y t in a period are requirement to guarantee the stability of the heaving motion of the hydrofoil the time mean power input c pi power output c p0 and total energy harvesting efficiency η under different β for θ 0 60 are plotted in fig 14 we can see that non cosinusoidal pitching motion is effective to enhance the energy harvesting efficiency with the increasing of β and the highest energy harvesting efficiency of 51 81 was obtained at β 2 0 and θ 0 60 to understand physical mechanism of the effect of variation of β in fig 15 we plot the vorticity contours of nine instants over one period the corresponding pressure contours are shown in fig 16 first we notice that low pressure is always generated in the fields of leading edge vortex lev and lev generates below the foil during t t 0 1 4 and t t 3 4 1 and above the hydrofoil during t t 1 4 3 4 when the heaving motion of the foil is shifting from high pressure zone toward to low pressure zone the distribution of vortex and pressure are helpful to the heaving motion over one period therefore the lev is contributed to the energy harvesting we also noticed that the scale of lev increases with rising of β such as apparently shown in fig 15 at t t 1 8 the scale of lev is larger for β 2 0 than for β 1 0 corresponding the low pressure zone is more large for β 2 0 than for β 1 0 this distribution of vortex and pressure are helpful for heaving motion over one period meanwhile there is a small trailing edge vortex formed which is more obvious for β 2 0 than β 1 0 but the scale and intense are far lower than the lev for such distributions of vortex and pressure the pitching motion is activated during t t 0 1 4 and t t 1 2 3 4 and it is resisted by the unsteady hydrodynamics during t t 1 4 1 2 and t t 3 4 1 as shown as in fig 15 b for β 1 5 and β 2 0 the lift force changes rapidly during t t 1 8 3 8 and t t 5 8 7 8 because actual stall happens as shown in fig 8 according to the discussion above the evolution of vortex and pressure remind us that the flow over a foil is strongly related to unsteady hydrodynamics a better performance of this energy generator by turning sinusoidal pitching to cosinusoidal pitching profile is achieved in which the unsteady hydrodynamic force is good for driving the heaving motion of the foil and turning the flow to an appropriate forming of the leading vortex and a good timing of its shedding from the foil 4 4 comparison between sine like and cosine like pitching profile in this section we father compare the maximum energy harvesting performance of sine like β 1 0 and θ 0 75 and cosine like pitching profile β 2 0 θ 0 60 for a semi active flapping foil with the reduce frequency f 0 16 corresponding to the maximum energy harvesting efficiency 32 18 and 51 81 respectively fig 17 gives the variations of force coefficient and kinematics for sinusoidal pitching profile for β 1 0 at f 0 16 θ 0 75 as shown in fig 17 b and c the variations of vertical velocity v y t and vertical displacement h t of the pivot are similar to but not cosinusoidal profile fig 18 gives the variations of force coefficient and kinematics for non cosinusoidal pitching profile for β 2 0 at f 0 16 θ 0 60 as shown in fig 18 b and c the variations of vertical velocity v y t of the pivot are inverse to cosine like pitching profile and the variations of vertical displacement h t of the pivot are inverse sinusoidal profile we observed that the variations of vertical velocity v y t of the pivot are similar to the pitching profile and the variations of vertical displacement h t of the pivot are authentic trigonometric function profile which is good for increasing the energy harvesting efficiency fig 19 a and b show the evolution of pressure of sinusoidal pitching profile for β 1 0 at f 0 16 θ 0 75 and non cosinusoidal pitching profile for β 2 0 at f 0 16 θ 0 60 respectively from the figures we observed that the foil always moves from the high pressure zone to the low pressure zone as shown in fig 19 a the foil pitching to the direction of higher pressure on the surface of the foil when t t 0 1 4 t t 1 2 3 4 which is not helpful to decrease the power input and the foil pitching to low pressure field when t t 1 4 1 2 t t 3 4 1 which is favorable for decreasing the power input similarity as shown in fig 19 b we can see that the foil pitching to the direction of lower pressure on the surface of the foil when t t 0 1 4 t t 1 2 3 4 which is good for decreasing the power input and the foil pitching to higher pressure field when t t 1 4 1 2 t t 3 4 1 which is not helpful to decrease the power input that s to say that there is not much difference between power input for sine like and cosine like pitching profile however the value of lift force coefficients c y t and vertical velocity v y t for cosine like pitching profile are larger than that of sine like pitching profile which is attributed to that the effect attack angle for cosine like profile is more close to the optimal attack angle of the foil than that for sine like profile therefore cosine like pitching profile is better than sine like pitching profile for energy extracting efficiency in the present semi active energy harvesting system 5 conclusions the fluid solid interaction model based on projected immersed boundary implicit direct force method is used to study the effects of pitching motion on energy extraction performance of a flapping foil the numerical method is firstly verified by two numerical tests namely flow over a stationary naca0012 airfoil and a semi active flapping foil with sinusoidal like pitch movement the conclusions agree well with the achievement which obtained by other literature then the effects of cosine like pitching profile on energy extraction performance with different pitching amplitudes change from θ 0 15 to θ 0 90 at flapping frequency f 0 16 were studied we observed that the balanced position of the oscillating foil ascend a distance relative to the original balanced position and the variations of heaving displacement h t are adverse sinusoidal like profile it clarified that the heaving motion are steady only in small scale of the maximum pitching amplitude transform from about θ 0 60 to θ 0 75 and the maximum of total energy harvesting efficiency η 44 22 is confirmed for θ 0 60 that is to say the cosinusoidal pitching profile for a semi active flapping foil can enhance the energy extraction performance comparison with the sinusoidal pitching profile in which the energy harvesting efficiency is η 32 18 meanwhile we researched the effects of non cosinusoidal pitching motion on the stability of the heaving motion and the energy extraction performance we found that the stability of heaving motion is worse with the increasing of value of β for θ 0 45 and it is better with the increasing of β from 1 0 to 2 5 for θ 0 60 it is effective to enhance the energy harvesting efficiency with the increasing of β and the highest energy harvesting efficiency 51 81 was obtained at β 2 0 for θ 0 60 finally we made a comparison between the sine like and cosine like pitching profiles for a semi active flapping foil with the reduce frequency f 0 16 in which the optimal combination of parameters are β 1 0 θ 0 75 for sine like pitching profile and β 2 0 θ 0 60 for cosine like pitching profile respectively we observed that cosine like pitching profile is better than sine like pitching profile for energy extracting efficiency in the present semi active energy harvesting system acknowledgements the work described in this paper is funded by the research grant from the natural science foundation of china grant nos 51479085 and 11262008 and the fok ying tung education foundation project no 141120 f b tian is the recipient of an australian research council discovery early career researcher award project no de160101098 
23232,general arrangement and distributed system design is a complex problem that is a fundamental aspect of ship design current approaches to this design problem employ a paradigm of using automated tools to generate and analyze potential vessel solutions these approaches rely on the generation and optimization of vessel models based on design parameters created vessel models are then evaluated and compared to understand how parameters influence possible vessel characteristics this process is time and resource intensive which limits its application in early stage design when many critical arrangement and distributed system design decisions are made in this paper a new approach is proposed to complement the automated tool based paradigm for a vessel with a defined set of systems to be arranged and connected the approach measures the probabilistic arrangement and distributed system configuration without generating vessel models this efficiently provides leading indicators of the expected design outcomes and resultant vessel characteristics which can help guide early stage decisions and lead to better applications of resource intensive design tools in this paper methods supporting this approach are presented and application is demonstrated on a naval frigate concept design keywords early stage ship design distributed system design complex systems network science statistical mechanics bayes theorem 1 introduction designing a ship s arrangement and distributed system configuration is a complex and integral step of the ship design activity andrews 1998 carlson and fireman 1987 it requires designers to layout compartments and components as well as integrate multiple systems the resulting solution needs to arrange all of the vital components and compartments and connect all of the interdependent components through the distributed system configuration in early stage design developing arrangements and system configurations plays a fundamental role in helping designers understand and refine requirements andrews 2012a however because designing arrangements and systems is difficult designers often rely on automated tools to develop solutions in order to use these tools significant modeling design and computation effort is required this can make automated tools difficult to implement and inflexible when used in novel ship design these issues are detrimental in early stage design when arrangement and system configuration alternatives are best explored quickly and fluidly this paper proposes a faster and more flexible way to explore general arrangements and distributed system configurations in early stage design the presented method is analytic and determines how early stage arrangement decisions will affect the rest of the arrangement and distributed system configuration design the approach blends statistical mechanics methods from network science and bayesian probability to infer how a design is likely to change from design decisions given some design decisions for example where a space will be located the method determines the expected arrangement and system configuration based on the possible design permutations considering the expected design can provide new insights into the complex interdependencies between arrangement and system configurations relative to automated arrangement tools the analysis can be computed quickly and requires significantly less modeling and design effort to execute additionally it provides information about the distributed system configuration that is not typically provided by automated methods the insight this provides can inform critical early stage design decisions that heavily influence the vessel s cost and performance andrews 1986 during early stage design vessel layouts and distributed systems are considered at low fidelities to measure concept feasibility and requirement satisfaction andrews 2011 2016 this allows designers to make sizing and layout decisions with confidence that an acceptable distributed system can be designed for the vessel to facilitate decision making designers typically generate and analyze many models of potential vessels they use the models to develop a credible theory about the overall design problem r j pawling and andrews 2011 for example a designer might use the results of ship synthesis to narrow in on a machinery room location or to eliminate a ship concept because it has a high risk of being infeasible this approach is exemplified by the use of design space exploration dse and optimization method that generate solutions to the ship arrangement problem there has been a proliferation of automated and semi automated design tool including intelligent ship arrangements daniels et al 2010 parsons et al 2008 design building block approach andrews 2012b andrews et al 2006 mcdonald 2009 r pawling 2007 bin packing duchateau 2016 b j van oers 2011 b van oers et al 2010 and others brown and thomas 1998 brown and waltham sajdak 2015 in distributed system design there is a growing a suite of semi automated design and analysis tools for example chalfant 2015 chalfant et al 2012 chalfant et al 2015 fiedel et al 2011 trapp 2015 there are a limited set of automated tools that consider both arrangements and distributed system design explicitly for instance the tools described brown and waltham sajdak 2015 there are three fundamental drawbacks to trying to understand the ship design problem by creating and analyzing possible solutions first many solutions need to be created analyzed and differentiated to inform decisions the tools that create a solution are often complex and may be biased by implicit design drivers in their structures or databases gillespie 2012 this means that new methods and tools need to be developed every time a novel vessel is designed second it is resource intensive to establish the modeling algorithms and analysis method that generate solutions because the process is intensive designer may resort to making design decisions that facilitate the reuse of existing tools anecdotally this has been observed to be a significant decision driver in naval design and can artificially constrain the design of novel vessels third most automated methods do not address both the arrangement and distributed system design problems explicitly in arrangement methods the impact of distributed system design is typically implicit in distributed system design methods arrangements are usually provided as input in both cases the interdependence between arrangements and distributed system design is not rigorously investigated these three drawbacks mean that the information provided by dse and similar approaches often require detail and resources that are incompatible with early stage design and may not capture the interdependencies driving design outcomes this paper proposes a new and complementary approach for considering arrangement and distributed system design the approach considers how a decision will influence the expected physical system solution without requiring the population of vessel solutions the physical system solution describes an arrangement of components within the vessel and the distributed system connectivity between them brefort et al 2018 the presented analysis assesses the probability of a particular physical system solution occurring given the uncertainty and ambiguity in existing vessel design given a vessel concept a network representation is used to evaluate the expected properties of vessel solution ensembles as a function of interdependent arrangement and distributed system design decisions here a solution ensemble represents the set of all physical system solutions that are possible given the vessel s mathematically plausible arrangements and distributed system configurations applying analysis from the statistical mechanics of random walks the properties of solution ensembles can be calculated analytically from this analysis different arrangement concepts can be compared based on their ensemble properties determining and comparing the characteristics of solution ensembles provides a leading indicator for solution characteristics the results can help characterize the relationships between early stage arrangement decisions and expect design solutions using this information designers can guide decision making towards more desirable solutions and lead to more efficient application of resource intensive design tools this approach can efficiently provide feedback on the expected outcomes of early stage decisions while addressing the arrangement and distributed system design interdependence the proposed approach is an extension of other network based analysis for early stage ship design at its core the employed network representation relies on the relational models of ship arrangements in gillespie gillespie et al 2013 and distributed systems in rigterink rigterink 2014 shields et al shields et al 2017 shields et al 2016 combined these methods to generate and analyzed distributed system routing ensembles in those applications ensembles helped elicit the relationships between arrangements and distributed system configuration characteristics however the methods were limited to the shortest path routings of distributed system connectivity furthermore potential solutions had to be generated and evaluated individually to estimate the solution ensemble characteristics the presented method eliminates these limitations making the ensemble results more general reliable and efficient to create the remainder of this paper provides and demonstrates the modeling and analysis framework that facilitates finding the expected design solution the results illustrate that the impact of early stage decisions on the vessel s arrangement and distribution system configuration can be measured before design solutions are generated the outline of this paper is as follows in section 2 the network representation for vessel arrangements and distributed systems is defined in section 3 the ensemble analysis approach is detailed first the analysis for a single path in the vessel between two spaces is defined second multiple path results are combined to measure the probability of component arrangements within the vessel third the probabilistic arrangements are used with path results to calculate the expectation of the distributed system configuration in section 4 the proposed method is applied to an artificial example to demonstrate the analysis and results and then the method is applied to a frigate concept design section 5 concludes the paper 2 network representation for arrangements and distributed systems network science provides a powerful toolset for describing and analyzing arrangements and distributed systems in early stage design to facilitate a network centric approach arrangements and distributed systems are broken down into interdependent architectures as described in brefort et al 2018 the physical architecture describes spatial relationships in a system s environment the logical architecture describes systems and system connectivity applied to the naval case the physical architecture typically represents zone decks in the vessel and the usable connections between them the logical architecture represents the systems components and their functional relationships e g an electrical generator is functionally related to a fan room through the power the generator provides the physical system solution is a configuration of the logical architecture connectivity within the physical architecture for example the cable routing from the electrical generator to the fan room the physical system solution is a mapping of nodes and edges in the logical architecture graph to nodes and edges in the physical architecture graph using notation from kurant and thiran 2006 this mapping is denoted as m s an example is sketched in fig 1 for this work the physical architecture network represents zone decks within a vessel zone deck are represented as nodes and the usable adjacencies between zone decks are edges the logical architecture is multi layered where each network layer represents a different system type in a layer critical components or functional spaces that contain critical components e g the machinery room are represented as component nodes functional connections between component nodes are represented as edges within a layer for example a generator and fan room are represented as nodes in the electrical power and chill water distribution layers in the electrical power layer an edge between them denotes that they are functionally related in the chill water distribution layer the generator and fan room would not have an edge because the neither the generator or fan room produce chill water that the other uses feasible vessel arrangements and distributed system configurations require a definition of a satisfactory mapping of the logical architecture to the physical architecture depending on the stage of the design there may be a near infinite number of possible mappings that need to be evaluated however regardless of the design stage each possible mapping is a composite of paths in the physical architecture that facilitate the relationships in the logical architecture shields et al 2017 physical system solution mappings can be broken into the mapping of individual nodes and edges in the logical architecture to the physical architecture nodes in the logical architecture map to nodes in the physical architecture this represents the location of that component in the environment to denote this mapping the ith component node c i s is mapped to its corresponding location node u i g by the mapping m c i edges in the logical architecture map to paths in the physical architecture this represents the route through the physical architecture that connects two components on a logical architecture edge to denote this mapping the edge between the ith and jth components c i c j in layer l of s is called e l the mapping m e l is the path through g that connects the respective locations u i and u j that correspond to c i and c j to generate a physical system solution each component or functional space node in s is mapped to a location node in g then every logical architecture edge e l c i c j in each layer s l is mapped to a path in g the mapping of a system layer s l is called m s l and the mapping of the complete logical architecture is called m s once m s generated it represents a physical system solution for the defined logical and physical architectures in early stage design the mappings of components and paths is often ambiguous or uncertain for example component and functional space mappings may be ambiguous if the designer has not assessed the possible locations it could be placed if the mapping had been assessed but there was not a selection between locations the mapping may be uncertain e g 75 chance it goes to one location and 25 it goes to another to account for this mappings can be looked at from a probabilistic perspective the probability that some set of node and edge elements e in the logical architecture maps to a location node i in the physical architecture is called p i e and the mapping to edge i j in the physical architecture network is called p i j e if the probability of the mapping is unknown it is denoted as p i j e x where x is an unknown probability fig 2 sketches a probabilistic mapping of component nodes to locations 3 evaluating solution ensembles the objective of this paper is to assess the expected outcomes of the physical system solution ensemble given the logical and physical architectures the desired values are the probability that a physical system solution for the physical and logical architectures use the individual elements of the physical architecture this represents the probability that a randomly drawn solution would use each part of the physical architecture the following methodology will use ensemble analysis to explore three cases of distributed system design when there is a known arrangement an uncertain arrangement and an ambiguous arrangement the first case occurs when each component represented by nodes in s is mapped to a location represented by a node in g this describes a case where the designer is able to define the arrangement of components within the vessel the second case occurs when components may be mapped to more than one location with varying probability this describes when the designer is uncertain as to exact location of components for instance when a component is equally likely to be two adjacent zone decks but the exact location is not decided the third case occurs when components may be mapped to more than one location with unknown probability this describes when the designer knows possible locations but does not know care where the component will be placed ensemble characteristics of possible solutions for logical and physical architecture can be investigated by enumerating each path m e l for all edges in s and then creating solutions from all combinations of paths however it is not practical to implement an enumeration because the number of possible solutions quickly becomes intractable when g and s are non trivial thus for complex vessel design it is not possible to exhaustively evaluate the ensemble properties to remedy this issue a probabilistic approach is used in the probabilistic approach an ensemble perspective of the solutions is built up from the ensemble characteristic of each path m e l that makes up the physical system solution first the probability of each path in m s using an element in g is calculated for a given path between two nodes in g this measures how likely that path is to pass over each node and edge in g second the probabilistic path results are combined to provide the probabilistic mapping for any ambiguous arrangement mappings third the complete set of arrangement mappings are combined with results from the first step to calculate the probabilities that any physical system solution uses each node and edge in g this provides the probability of an arrangement and distributed system design given the logical and physical architecture the supporting analysis follows the first step determining the probability distribution of a path through g is facilitated by the mechanics of random walks if a path between two nodes in g can be described as a random walk then the probability that the path uses a given node or edge in g can be calculated by analyzing the structure of g given a path from node u to node v excluding paths that do not lead from u to v the probability that the path uses a node element i is defined as p i u v the probability that any path from u to v uses edge i j is defined as p i j u v newman 2005 showed that these probabilities can be found by evaluating the flow of electrical current from u to v over the network g assuming that each edge in the network has resistance ω 1 the steps for the calculation as defined by newman 2005 are 1 construct the matrix d g where d is the diagonal matrix of node degrees and g is the adjacency matrix 2 remove any single row and its corresponding column from the matrix for example the last row and column 3 invert the resulting matrix and then add back in a new row and column consisting of all zeros in the position from which the row and column were previously removed e g the last row and column call the resulting matrix t with elements t i j 4 calculate p i i u v for each node in g as p i u v 1 2 j a i j t i u t i v t j s t j t for i u v 5 set p u u v 1 and p v u v 1 to denote that the walk must include the beginning and ending nodes 6 calculate p i j u v for each edge in g as p i j u v a i j t i u t i v t j s t j t the probability of path routing can be extended to account for uncertainty in vessel arrangements mathematically this is uncertainty in the mapping of nodes in s to locations in g for example node c k in s may have 50 chance of being located at both node u and v in g i e p u c k p v c k 0 5 another node c l in s is located at w in g in this case the probability of the path between c k and c l using an element in g would be the weighted sum of probabilities for each combinations of locations c k u c l w and c k v c l w p i j c k c l 0 5 p i j u w 0 5 p i j v w this can be generalized to p i j c k c l c k c l p u c k p v c l p i j u v where the summation over c k and c l are over their possible locations and p i j u v is calculated as described previously this is the foundational calculation for determining the ensemble characteristics of the physical solution mapping next it will be applied to find the probabilistic mapping of components with ambiguous locations in the vessel the second part of combining the path results is to combine the probability distributions for the individual paths and resolve ambiguous mappings in the physical system solution in this case the possible nodes that u can map to may be known but the probabilities those mapping may be unknown for example node c k in s could be mapped to node u or v but the designer has not chosen the likelihood of either event in order to analyze this case the physical architecture network must be temporarily altered to evaluate the probabilities p u c i and p v c i for m c i to evaluate the case where the mapping m c k is unknown but could go to many possible nodes in u k g first a supernode s is added to g with edges to each possible node in u k e g s u for u u k this alteration allows the probability that a distributed system routed to the supernode through each of the edges s u for u u k to be calculated these probabilities p s u c i c j represent the probability that each logical architecture edge c k c l maps c k to u thus single edge probabilities can be treated as evidence that the component is mapped to a location this evidence can combined using bayes thereom to find the overall mapping probability given every edge in the logical architecture that involves node c k assuming that each edge routing is independent and there is no initial preference for the mapping the probability of component c k mapping to node u is p u c k c l c m p s u c l c m v c l c m p s v c l c m for v u k and for all edges c l c m containing c k in s where p s i c k c l can include uncertain mappings as described previously if multiple ambiguous mappings exist then supernodes are added to g for each such mapping the calculation of p s i c k c l between two ambiguous mappings is calculated using the respective supernodes instead of v once ambiguous mappings are resolved the probabilities of each mapping location are used to combine the individual path results to get the probabilistic mapping of the physical system solution here the objective is to calculate for each node and edge in g the probability that the physical system solution uses that element this generalizes to the probability that a subset of logical architecture edges e s maps to the elements of g the probability of the mapping m e to an element is called p i j e and is calculated using the probability that any edge mapping m c k c l e uses i j g however due to the uncertainty in component locations this needs to be summed over the set of possible component arrangements and the probability of that arrangement occurring using the complement of the probability that no edge uses the element i j the complete summation is p i j e u 0 u 0 u n u n p u 0 c 0 p u n c n 1 c k c l e 1 p i j u k u l where u k is the location of component c k given its possible locations u k g and p u k c k is the probability that c k is located at u k if e contains all edges in s then p i j e gives the probability that element i j g is used in the physical solution mapping m s smaller subset such as the edges in logical architecture layer e s l give the probability that the system mapping m s l uses i j applied to every element in the physical architecture this give the desired probabilistic mapping of the vessel s arrangement and distributed system design to summarize the method for calculating the ensemble probabilities of an arrangement and physical system solution which is the expectation of finding each component and the distributed system at each location in vessel is as follows 1 calculate the probability of locations each ambiguous mapping 2 calculate p i j u k u l for each pair of component locations u k u l that exists between connected components in the logical architecture 3 combine the probabilities of each logical architecture edge in layer l to calculate p i j e for e s l 4 combine the probabilities of each logical architecture layer in s to calculate p i j e for e s 4 examples and applications in this section a number of examples are provided to illustrate the properties and use of the expected design outcomes approach to vessel arrangement and distributed system design 4 1 simple example first a small case demonstrates the application of this approach on a 3 by 3 physical architecture and a logical architecture with three components the components in the logical architecture have fixed uncertain and ambiguous mappings to the physical architecture the physical architecture logical architecture and results for by system types are sketched in fig 3 it should be noted that the logical architecture network is unweighted as the method does not consider the relative strength or importance of connections between component nodes probabilistic mapping results for the individual systems m s l and the overall logical architecture m s are shown in table 1 as the figure and table show the ensemble analysis provides a picture of expected distributed system configuration and arrangement this quickly provides information about the likely characteristics of the physical system solution it can also generate valuable insight into the expected design outcomes for example using the logical architecture mapping an underlying distribution for component b s location is calculated without ensemble design analysis component b s location would remain ambiguous or be incorrectly assumed as uniformly distributed between its possible locations furthermore generating the routing information would require an enumeration of all possible component arrangements and distributed system configurations even for this seemingly trivial case there are 4884 possible solutions if only paths without repeated nodes are considered and many more if random walks are considered this illustrates why the enumeratation approach is impractical in more complex applications 4 2 ship design example now an early stage ship design examples is given the example is based off of the bin packing automated arrangement approach and provides a comparison of automated tools and the proposed analytic approach comparing bin packing results to the probabilistic mappings demonstrates how the probabilistic mapping can effectively characterize design problem outcomes van oers introduced the automated bin packing as a method generate vessel arrangements in b van oers et al 2010 he demonstrated the method on a simplified frigate shown in fig 4 in the demonstration he explored how the frigate s arrangement changed when the location of certain components was altered specifically he showed the vessel s baseline configuration with the flight deck in the aft and an alternative arrangement with the flight deck towards the bow the frigate arrangements were generated by seeding a genetic algorithm with initial positions for primary system components locations this is an example of using automated tools to understand the design problem many possible arrangements are generated evaluated and improved upon to understand how a decision will change a vessel design using the analytic methods presented here some of the same arrangement relationships as well as distributed system design relationships can be elicited directly instead of inferred from vessel models first the frigate is converted into its physical and logical architectures the physical architecture describes the relationship between zone decks in the vessel this is modeled with only the longitudinal relationships between zones but three dimensional arrangements can be modeled by including transverse zone decks and their relationships the logical architecture describes the primary system components and their relationships in terms of the electrical power data network and equipment movement e g helicopters from the hangar to flight deck second the probability of creating either arrangement is investigated each component is mapped to their locations in both the flight deck aft arrangement and flight deck forward arrangement the probability of each mapping is left ambiguous to see if there is a tendency to map toward one arrangement or the other the network representations are shown in fig 5 results of the probabilistic mapping in fig 6 show that given the architectures there is not a significant difference in probability of the flight deck being forward or aft in the bin packing demonstration the two solutions placed components close to the initial locations given to the genetic algorithm this suggests that component locations are not strongly driven to one arrangement or the other if true this matches the ensemble results that the two solutions are almost equally likely to occur across a random draw while the bin packing results are influenced by naval architecture considerations the ensemble analyses suggest that there is a preference for the propulsion plant location which could arise from the implicit distributed system considerations fig 6 shows that there is a high probability 51 that the propulsion plant is located in the position closest to the bow this also appears to coincide with the bin packing solutions in the baseline configuration the propulsion plant is located at the zone deck represented by the highest probability mapping in the flight deck forward configuration the propulsion plant is initially seeded at the stern of the ship 10 m but is placed near midships 40 m this distance between initial seeding and final component location in the bin packing solution indicates that the propulsion plant is drawn forward in the bin packing arrangements the distributed system configuration is not generated in the bin packing demonstration but can be investigated with the proposed methods fig 6 shows the probabilities of system mappings for electrical power systems mapping results near the propulsion plant indicates that there is an 65 chance that the electrical power distribution exists on the vertical edge over the most forward propulsion this is 11 percentage points higher than the next highest propulsion plant location additionally there is a high probability of the distribution system existing along the keel one zone deck higher the probability of transverse routing is on average 21 percentage points lower this suggests vertical cable trunk from the propulsion plant is likely to be needed forward in the vessel and is expected to route transversely along the keel and then vertically probabilities higher up in the vessel show that certain areas in the physical architecture are highly likely to have the electrical power system mapped to them regardless of the exact arrangement these areas should be designed to accommodate electrical cabling in contrast the regions near the bow and stern on lower in the vessel are relatively unlikely to have the electrical power system located there variations to the logical architectures would affect the characterized design outcomes for example loops in the logical architecture would increase the probability that the components in the loops are close to each other furthermore the loops would increase the probability that distributed systems exist in the physical architecture network between the looped components also a propeller is not included in the model if it was included it would increase the probability of the propulsion plant being placed at the aft nodes in the physical architecture network in terms of the electrical power distribution system design results in figs 6 and 7 estimate the design characteristics despite the arrangement uncertainty and limited distributed system information the influence of a design change can also be evaluated to demonstrate watertight subdivision is enforced with transverse bulkheads that prevent system routings between zone decks on the lowest three decks results for the electrical power system mapping in fig 8 show that this creates a high probability of transverse routings directly over the subdivisions from a distributed system design perspective the high probabilities suggest where the electrical power distribution bus should be located furthermore the probabilities indicate this bus location is invariant with respect to the flight deck forward and flight deck aft arrangements while this is intuitive from a ship systems design perspective it is notable that the analytical approach replicates design intuition the subdivision also influences the arrangement probabilities while there is still no discernable preference towards the flight deck forward or flight deck aft arrangement the propulsion plant location is more evenly distributed across its possible location in the subdivision example the largest difference between propulsion plant locations is 23 percentage points in comparison there is a 44 percentage point difference without subdivision this suggests that subdivision decisions can significantly influence the propulsion plant location by constraining its connectivity with other components in the vessel subdivisions also shift the probabilistic location of the bridge in the subdivision case the bridge has a 40 chance of being located at its forward most location versus a 28 chance without subdivision when the subdivisions constrain connectivity with the propulsion plant the bridge and propulsion plant are more likely to be arranged closer together because there is less variation in the routings in effect limiting the routing variations from the propulsion plant to the bridge pulls the two node locations in line with one another this effect is compounded by the coupling between the bridge and propulsion plant in both the information and electrical power system these results indicate that the interdependence of distributed systems and arrangements create a relationship between the zone deck subdivision the distributed system design and the arrangement of the propulsion plant and bridge because the probabilistic outcome analysis accounts of the interdependence of arrangements and distributed systems these design relationships and their influence on the solution can be efficiently identified and measured considering these interdependencies provides new and useful information to designers for instance the coupling between the bridge and propulsion plant location 5 conclusions design of vessel arrangement and distributed systems is complex task with many constraints numerous interdependencies and near infinite possible solutions traditional naval architecture design employs automated tools to enumerate many of these possible solutions and interrogate them to identify design decisions that produce desirable designs in novel vessel design the automated approach is often overly case specific and too resource intensive to be used in concept design in this paper an analysis approach which finds the expected vessel arrangements and distributed system configuration is proposed this approach considers the potential outcomes of a design without generating vessel models to help guide design decision making and higher fidelity investigations the proposed approach employs a network model of a vessel s physical and logical relationships to create a probabilistic mapping of arrangements and distributed systems in essence this provides the probability of an arrangement and distributed system configuration randomly occurring using this information the vessel design can be characterized despite design uncertainty and ambiguity in the future this approach will be tested on more difficult problems including those in 3 dimensions and multi hull configurations in these more difficult problems the design characterizations may be less pronounced than in the small design example in this paper developing methods to apply statistical analyses such as hierarchical clustering on the mappings of individual layers and edges may help elicit the influence of components on one another in addition sampling arrangements and system configurations from the probabilistic mapping would allow performance metrics to be evaluated for example this would allow complexity such as the knowledge based complexity shields 2017 or functional requirements to be considered other analyses may address incompatibilities between systems and spaces as well as traditional naval architecture analyses the approach taken in this paper can help mitigate the design risks that arise from making early stage design decisions the probabilistic approach provides new information about what to expect from one of the most complex and influential aspects of ship design a number of examples demonstrate the value of addressing early stage arrangements and distributed system configurations with this approach moreover the authors hope that the approach of analyzing the structure of a design problem to indicate what designers should expect from its solutions will be expanded into other realms of the ship design activity acknowledgements we would like to thank kelly cooper from the office of naval research for providing support for this project this work was funded under grant number n000141410712 additionally this work received government support under contract fa9550 11 c0028 awarded by the department of defense air force office of scientific research national defense science and engineering graduate ndseg fellowship 32 cfr 168a 
23232,general arrangement and distributed system design is a complex problem that is a fundamental aspect of ship design current approaches to this design problem employ a paradigm of using automated tools to generate and analyze potential vessel solutions these approaches rely on the generation and optimization of vessel models based on design parameters created vessel models are then evaluated and compared to understand how parameters influence possible vessel characteristics this process is time and resource intensive which limits its application in early stage design when many critical arrangement and distributed system design decisions are made in this paper a new approach is proposed to complement the automated tool based paradigm for a vessel with a defined set of systems to be arranged and connected the approach measures the probabilistic arrangement and distributed system configuration without generating vessel models this efficiently provides leading indicators of the expected design outcomes and resultant vessel characteristics which can help guide early stage decisions and lead to better applications of resource intensive design tools in this paper methods supporting this approach are presented and application is demonstrated on a naval frigate concept design keywords early stage ship design distributed system design complex systems network science statistical mechanics bayes theorem 1 introduction designing a ship s arrangement and distributed system configuration is a complex and integral step of the ship design activity andrews 1998 carlson and fireman 1987 it requires designers to layout compartments and components as well as integrate multiple systems the resulting solution needs to arrange all of the vital components and compartments and connect all of the interdependent components through the distributed system configuration in early stage design developing arrangements and system configurations plays a fundamental role in helping designers understand and refine requirements andrews 2012a however because designing arrangements and systems is difficult designers often rely on automated tools to develop solutions in order to use these tools significant modeling design and computation effort is required this can make automated tools difficult to implement and inflexible when used in novel ship design these issues are detrimental in early stage design when arrangement and system configuration alternatives are best explored quickly and fluidly this paper proposes a faster and more flexible way to explore general arrangements and distributed system configurations in early stage design the presented method is analytic and determines how early stage arrangement decisions will affect the rest of the arrangement and distributed system configuration design the approach blends statistical mechanics methods from network science and bayesian probability to infer how a design is likely to change from design decisions given some design decisions for example where a space will be located the method determines the expected arrangement and system configuration based on the possible design permutations considering the expected design can provide new insights into the complex interdependencies between arrangement and system configurations relative to automated arrangement tools the analysis can be computed quickly and requires significantly less modeling and design effort to execute additionally it provides information about the distributed system configuration that is not typically provided by automated methods the insight this provides can inform critical early stage design decisions that heavily influence the vessel s cost and performance andrews 1986 during early stage design vessel layouts and distributed systems are considered at low fidelities to measure concept feasibility and requirement satisfaction andrews 2011 2016 this allows designers to make sizing and layout decisions with confidence that an acceptable distributed system can be designed for the vessel to facilitate decision making designers typically generate and analyze many models of potential vessels they use the models to develop a credible theory about the overall design problem r j pawling and andrews 2011 for example a designer might use the results of ship synthesis to narrow in on a machinery room location or to eliminate a ship concept because it has a high risk of being infeasible this approach is exemplified by the use of design space exploration dse and optimization method that generate solutions to the ship arrangement problem there has been a proliferation of automated and semi automated design tool including intelligent ship arrangements daniels et al 2010 parsons et al 2008 design building block approach andrews 2012b andrews et al 2006 mcdonald 2009 r pawling 2007 bin packing duchateau 2016 b j van oers 2011 b van oers et al 2010 and others brown and thomas 1998 brown and waltham sajdak 2015 in distributed system design there is a growing a suite of semi automated design and analysis tools for example chalfant 2015 chalfant et al 2012 chalfant et al 2015 fiedel et al 2011 trapp 2015 there are a limited set of automated tools that consider both arrangements and distributed system design explicitly for instance the tools described brown and waltham sajdak 2015 there are three fundamental drawbacks to trying to understand the ship design problem by creating and analyzing possible solutions first many solutions need to be created analyzed and differentiated to inform decisions the tools that create a solution are often complex and may be biased by implicit design drivers in their structures or databases gillespie 2012 this means that new methods and tools need to be developed every time a novel vessel is designed second it is resource intensive to establish the modeling algorithms and analysis method that generate solutions because the process is intensive designer may resort to making design decisions that facilitate the reuse of existing tools anecdotally this has been observed to be a significant decision driver in naval design and can artificially constrain the design of novel vessels third most automated methods do not address both the arrangement and distributed system design problems explicitly in arrangement methods the impact of distributed system design is typically implicit in distributed system design methods arrangements are usually provided as input in both cases the interdependence between arrangements and distributed system design is not rigorously investigated these three drawbacks mean that the information provided by dse and similar approaches often require detail and resources that are incompatible with early stage design and may not capture the interdependencies driving design outcomes this paper proposes a new and complementary approach for considering arrangement and distributed system design the approach considers how a decision will influence the expected physical system solution without requiring the population of vessel solutions the physical system solution describes an arrangement of components within the vessel and the distributed system connectivity between them brefort et al 2018 the presented analysis assesses the probability of a particular physical system solution occurring given the uncertainty and ambiguity in existing vessel design given a vessel concept a network representation is used to evaluate the expected properties of vessel solution ensembles as a function of interdependent arrangement and distributed system design decisions here a solution ensemble represents the set of all physical system solutions that are possible given the vessel s mathematically plausible arrangements and distributed system configurations applying analysis from the statistical mechanics of random walks the properties of solution ensembles can be calculated analytically from this analysis different arrangement concepts can be compared based on their ensemble properties determining and comparing the characteristics of solution ensembles provides a leading indicator for solution characteristics the results can help characterize the relationships between early stage arrangement decisions and expect design solutions using this information designers can guide decision making towards more desirable solutions and lead to more efficient application of resource intensive design tools this approach can efficiently provide feedback on the expected outcomes of early stage decisions while addressing the arrangement and distributed system design interdependence the proposed approach is an extension of other network based analysis for early stage ship design at its core the employed network representation relies on the relational models of ship arrangements in gillespie gillespie et al 2013 and distributed systems in rigterink rigterink 2014 shields et al shields et al 2017 shields et al 2016 combined these methods to generate and analyzed distributed system routing ensembles in those applications ensembles helped elicit the relationships between arrangements and distributed system configuration characteristics however the methods were limited to the shortest path routings of distributed system connectivity furthermore potential solutions had to be generated and evaluated individually to estimate the solution ensemble characteristics the presented method eliminates these limitations making the ensemble results more general reliable and efficient to create the remainder of this paper provides and demonstrates the modeling and analysis framework that facilitates finding the expected design solution the results illustrate that the impact of early stage decisions on the vessel s arrangement and distribution system configuration can be measured before design solutions are generated the outline of this paper is as follows in section 2 the network representation for vessel arrangements and distributed systems is defined in section 3 the ensemble analysis approach is detailed first the analysis for a single path in the vessel between two spaces is defined second multiple path results are combined to measure the probability of component arrangements within the vessel third the probabilistic arrangements are used with path results to calculate the expectation of the distributed system configuration in section 4 the proposed method is applied to an artificial example to demonstrate the analysis and results and then the method is applied to a frigate concept design section 5 concludes the paper 2 network representation for arrangements and distributed systems network science provides a powerful toolset for describing and analyzing arrangements and distributed systems in early stage design to facilitate a network centric approach arrangements and distributed systems are broken down into interdependent architectures as described in brefort et al 2018 the physical architecture describes spatial relationships in a system s environment the logical architecture describes systems and system connectivity applied to the naval case the physical architecture typically represents zone decks in the vessel and the usable connections between them the logical architecture represents the systems components and their functional relationships e g an electrical generator is functionally related to a fan room through the power the generator provides the physical system solution is a configuration of the logical architecture connectivity within the physical architecture for example the cable routing from the electrical generator to the fan room the physical system solution is a mapping of nodes and edges in the logical architecture graph to nodes and edges in the physical architecture graph using notation from kurant and thiran 2006 this mapping is denoted as m s an example is sketched in fig 1 for this work the physical architecture network represents zone decks within a vessel zone deck are represented as nodes and the usable adjacencies between zone decks are edges the logical architecture is multi layered where each network layer represents a different system type in a layer critical components or functional spaces that contain critical components e g the machinery room are represented as component nodes functional connections between component nodes are represented as edges within a layer for example a generator and fan room are represented as nodes in the electrical power and chill water distribution layers in the electrical power layer an edge between them denotes that they are functionally related in the chill water distribution layer the generator and fan room would not have an edge because the neither the generator or fan room produce chill water that the other uses feasible vessel arrangements and distributed system configurations require a definition of a satisfactory mapping of the logical architecture to the physical architecture depending on the stage of the design there may be a near infinite number of possible mappings that need to be evaluated however regardless of the design stage each possible mapping is a composite of paths in the physical architecture that facilitate the relationships in the logical architecture shields et al 2017 physical system solution mappings can be broken into the mapping of individual nodes and edges in the logical architecture to the physical architecture nodes in the logical architecture map to nodes in the physical architecture this represents the location of that component in the environment to denote this mapping the ith component node c i s is mapped to its corresponding location node u i g by the mapping m c i edges in the logical architecture map to paths in the physical architecture this represents the route through the physical architecture that connects two components on a logical architecture edge to denote this mapping the edge between the ith and jth components c i c j in layer l of s is called e l the mapping m e l is the path through g that connects the respective locations u i and u j that correspond to c i and c j to generate a physical system solution each component or functional space node in s is mapped to a location node in g then every logical architecture edge e l c i c j in each layer s l is mapped to a path in g the mapping of a system layer s l is called m s l and the mapping of the complete logical architecture is called m s once m s generated it represents a physical system solution for the defined logical and physical architectures in early stage design the mappings of components and paths is often ambiguous or uncertain for example component and functional space mappings may be ambiguous if the designer has not assessed the possible locations it could be placed if the mapping had been assessed but there was not a selection between locations the mapping may be uncertain e g 75 chance it goes to one location and 25 it goes to another to account for this mappings can be looked at from a probabilistic perspective the probability that some set of node and edge elements e in the logical architecture maps to a location node i in the physical architecture is called p i e and the mapping to edge i j in the physical architecture network is called p i j e if the probability of the mapping is unknown it is denoted as p i j e x where x is an unknown probability fig 2 sketches a probabilistic mapping of component nodes to locations 3 evaluating solution ensembles the objective of this paper is to assess the expected outcomes of the physical system solution ensemble given the logical and physical architectures the desired values are the probability that a physical system solution for the physical and logical architectures use the individual elements of the physical architecture this represents the probability that a randomly drawn solution would use each part of the physical architecture the following methodology will use ensemble analysis to explore three cases of distributed system design when there is a known arrangement an uncertain arrangement and an ambiguous arrangement the first case occurs when each component represented by nodes in s is mapped to a location represented by a node in g this describes a case where the designer is able to define the arrangement of components within the vessel the second case occurs when components may be mapped to more than one location with varying probability this describes when the designer is uncertain as to exact location of components for instance when a component is equally likely to be two adjacent zone decks but the exact location is not decided the third case occurs when components may be mapped to more than one location with unknown probability this describes when the designer knows possible locations but does not know care where the component will be placed ensemble characteristics of possible solutions for logical and physical architecture can be investigated by enumerating each path m e l for all edges in s and then creating solutions from all combinations of paths however it is not practical to implement an enumeration because the number of possible solutions quickly becomes intractable when g and s are non trivial thus for complex vessel design it is not possible to exhaustively evaluate the ensemble properties to remedy this issue a probabilistic approach is used in the probabilistic approach an ensemble perspective of the solutions is built up from the ensemble characteristic of each path m e l that makes up the physical system solution first the probability of each path in m s using an element in g is calculated for a given path between two nodes in g this measures how likely that path is to pass over each node and edge in g second the probabilistic path results are combined to provide the probabilistic mapping for any ambiguous arrangement mappings third the complete set of arrangement mappings are combined with results from the first step to calculate the probabilities that any physical system solution uses each node and edge in g this provides the probability of an arrangement and distributed system design given the logical and physical architecture the supporting analysis follows the first step determining the probability distribution of a path through g is facilitated by the mechanics of random walks if a path between two nodes in g can be described as a random walk then the probability that the path uses a given node or edge in g can be calculated by analyzing the structure of g given a path from node u to node v excluding paths that do not lead from u to v the probability that the path uses a node element i is defined as p i u v the probability that any path from u to v uses edge i j is defined as p i j u v newman 2005 showed that these probabilities can be found by evaluating the flow of electrical current from u to v over the network g assuming that each edge in the network has resistance ω 1 the steps for the calculation as defined by newman 2005 are 1 construct the matrix d g where d is the diagonal matrix of node degrees and g is the adjacency matrix 2 remove any single row and its corresponding column from the matrix for example the last row and column 3 invert the resulting matrix and then add back in a new row and column consisting of all zeros in the position from which the row and column were previously removed e g the last row and column call the resulting matrix t with elements t i j 4 calculate p i i u v for each node in g as p i u v 1 2 j a i j t i u t i v t j s t j t for i u v 5 set p u u v 1 and p v u v 1 to denote that the walk must include the beginning and ending nodes 6 calculate p i j u v for each edge in g as p i j u v a i j t i u t i v t j s t j t the probability of path routing can be extended to account for uncertainty in vessel arrangements mathematically this is uncertainty in the mapping of nodes in s to locations in g for example node c k in s may have 50 chance of being located at both node u and v in g i e p u c k p v c k 0 5 another node c l in s is located at w in g in this case the probability of the path between c k and c l using an element in g would be the weighted sum of probabilities for each combinations of locations c k u c l w and c k v c l w p i j c k c l 0 5 p i j u w 0 5 p i j v w this can be generalized to p i j c k c l c k c l p u c k p v c l p i j u v where the summation over c k and c l are over their possible locations and p i j u v is calculated as described previously this is the foundational calculation for determining the ensemble characteristics of the physical solution mapping next it will be applied to find the probabilistic mapping of components with ambiguous locations in the vessel the second part of combining the path results is to combine the probability distributions for the individual paths and resolve ambiguous mappings in the physical system solution in this case the possible nodes that u can map to may be known but the probabilities those mapping may be unknown for example node c k in s could be mapped to node u or v but the designer has not chosen the likelihood of either event in order to analyze this case the physical architecture network must be temporarily altered to evaluate the probabilities p u c i and p v c i for m c i to evaluate the case where the mapping m c k is unknown but could go to many possible nodes in u k g first a supernode s is added to g with edges to each possible node in u k e g s u for u u k this alteration allows the probability that a distributed system routed to the supernode through each of the edges s u for u u k to be calculated these probabilities p s u c i c j represent the probability that each logical architecture edge c k c l maps c k to u thus single edge probabilities can be treated as evidence that the component is mapped to a location this evidence can combined using bayes thereom to find the overall mapping probability given every edge in the logical architecture that involves node c k assuming that each edge routing is independent and there is no initial preference for the mapping the probability of component c k mapping to node u is p u c k c l c m p s u c l c m v c l c m p s v c l c m for v u k and for all edges c l c m containing c k in s where p s i c k c l can include uncertain mappings as described previously if multiple ambiguous mappings exist then supernodes are added to g for each such mapping the calculation of p s i c k c l between two ambiguous mappings is calculated using the respective supernodes instead of v once ambiguous mappings are resolved the probabilities of each mapping location are used to combine the individual path results to get the probabilistic mapping of the physical system solution here the objective is to calculate for each node and edge in g the probability that the physical system solution uses that element this generalizes to the probability that a subset of logical architecture edges e s maps to the elements of g the probability of the mapping m e to an element is called p i j e and is calculated using the probability that any edge mapping m c k c l e uses i j g however due to the uncertainty in component locations this needs to be summed over the set of possible component arrangements and the probability of that arrangement occurring using the complement of the probability that no edge uses the element i j the complete summation is p i j e u 0 u 0 u n u n p u 0 c 0 p u n c n 1 c k c l e 1 p i j u k u l where u k is the location of component c k given its possible locations u k g and p u k c k is the probability that c k is located at u k if e contains all edges in s then p i j e gives the probability that element i j g is used in the physical solution mapping m s smaller subset such as the edges in logical architecture layer e s l give the probability that the system mapping m s l uses i j applied to every element in the physical architecture this give the desired probabilistic mapping of the vessel s arrangement and distributed system design to summarize the method for calculating the ensemble probabilities of an arrangement and physical system solution which is the expectation of finding each component and the distributed system at each location in vessel is as follows 1 calculate the probability of locations each ambiguous mapping 2 calculate p i j u k u l for each pair of component locations u k u l that exists between connected components in the logical architecture 3 combine the probabilities of each logical architecture edge in layer l to calculate p i j e for e s l 4 combine the probabilities of each logical architecture layer in s to calculate p i j e for e s 4 examples and applications in this section a number of examples are provided to illustrate the properties and use of the expected design outcomes approach to vessel arrangement and distributed system design 4 1 simple example first a small case demonstrates the application of this approach on a 3 by 3 physical architecture and a logical architecture with three components the components in the logical architecture have fixed uncertain and ambiguous mappings to the physical architecture the physical architecture logical architecture and results for by system types are sketched in fig 3 it should be noted that the logical architecture network is unweighted as the method does not consider the relative strength or importance of connections between component nodes probabilistic mapping results for the individual systems m s l and the overall logical architecture m s are shown in table 1 as the figure and table show the ensemble analysis provides a picture of expected distributed system configuration and arrangement this quickly provides information about the likely characteristics of the physical system solution it can also generate valuable insight into the expected design outcomes for example using the logical architecture mapping an underlying distribution for component b s location is calculated without ensemble design analysis component b s location would remain ambiguous or be incorrectly assumed as uniformly distributed between its possible locations furthermore generating the routing information would require an enumeration of all possible component arrangements and distributed system configurations even for this seemingly trivial case there are 4884 possible solutions if only paths without repeated nodes are considered and many more if random walks are considered this illustrates why the enumeratation approach is impractical in more complex applications 4 2 ship design example now an early stage ship design examples is given the example is based off of the bin packing automated arrangement approach and provides a comparison of automated tools and the proposed analytic approach comparing bin packing results to the probabilistic mappings demonstrates how the probabilistic mapping can effectively characterize design problem outcomes van oers introduced the automated bin packing as a method generate vessel arrangements in b van oers et al 2010 he demonstrated the method on a simplified frigate shown in fig 4 in the demonstration he explored how the frigate s arrangement changed when the location of certain components was altered specifically he showed the vessel s baseline configuration with the flight deck in the aft and an alternative arrangement with the flight deck towards the bow the frigate arrangements were generated by seeding a genetic algorithm with initial positions for primary system components locations this is an example of using automated tools to understand the design problem many possible arrangements are generated evaluated and improved upon to understand how a decision will change a vessel design using the analytic methods presented here some of the same arrangement relationships as well as distributed system design relationships can be elicited directly instead of inferred from vessel models first the frigate is converted into its physical and logical architectures the physical architecture describes the relationship between zone decks in the vessel this is modeled with only the longitudinal relationships between zones but three dimensional arrangements can be modeled by including transverse zone decks and their relationships the logical architecture describes the primary system components and their relationships in terms of the electrical power data network and equipment movement e g helicopters from the hangar to flight deck second the probability of creating either arrangement is investigated each component is mapped to their locations in both the flight deck aft arrangement and flight deck forward arrangement the probability of each mapping is left ambiguous to see if there is a tendency to map toward one arrangement or the other the network representations are shown in fig 5 results of the probabilistic mapping in fig 6 show that given the architectures there is not a significant difference in probability of the flight deck being forward or aft in the bin packing demonstration the two solutions placed components close to the initial locations given to the genetic algorithm this suggests that component locations are not strongly driven to one arrangement or the other if true this matches the ensemble results that the two solutions are almost equally likely to occur across a random draw while the bin packing results are influenced by naval architecture considerations the ensemble analyses suggest that there is a preference for the propulsion plant location which could arise from the implicit distributed system considerations fig 6 shows that there is a high probability 51 that the propulsion plant is located in the position closest to the bow this also appears to coincide with the bin packing solutions in the baseline configuration the propulsion plant is located at the zone deck represented by the highest probability mapping in the flight deck forward configuration the propulsion plant is initially seeded at the stern of the ship 10 m but is placed near midships 40 m this distance between initial seeding and final component location in the bin packing solution indicates that the propulsion plant is drawn forward in the bin packing arrangements the distributed system configuration is not generated in the bin packing demonstration but can be investigated with the proposed methods fig 6 shows the probabilities of system mappings for electrical power systems mapping results near the propulsion plant indicates that there is an 65 chance that the electrical power distribution exists on the vertical edge over the most forward propulsion this is 11 percentage points higher than the next highest propulsion plant location additionally there is a high probability of the distribution system existing along the keel one zone deck higher the probability of transverse routing is on average 21 percentage points lower this suggests vertical cable trunk from the propulsion plant is likely to be needed forward in the vessel and is expected to route transversely along the keel and then vertically probabilities higher up in the vessel show that certain areas in the physical architecture are highly likely to have the electrical power system mapped to them regardless of the exact arrangement these areas should be designed to accommodate electrical cabling in contrast the regions near the bow and stern on lower in the vessel are relatively unlikely to have the electrical power system located there variations to the logical architectures would affect the characterized design outcomes for example loops in the logical architecture would increase the probability that the components in the loops are close to each other furthermore the loops would increase the probability that distributed systems exist in the physical architecture network between the looped components also a propeller is not included in the model if it was included it would increase the probability of the propulsion plant being placed at the aft nodes in the physical architecture network in terms of the electrical power distribution system design results in figs 6 and 7 estimate the design characteristics despite the arrangement uncertainty and limited distributed system information the influence of a design change can also be evaluated to demonstrate watertight subdivision is enforced with transverse bulkheads that prevent system routings between zone decks on the lowest three decks results for the electrical power system mapping in fig 8 show that this creates a high probability of transverse routings directly over the subdivisions from a distributed system design perspective the high probabilities suggest where the electrical power distribution bus should be located furthermore the probabilities indicate this bus location is invariant with respect to the flight deck forward and flight deck aft arrangements while this is intuitive from a ship systems design perspective it is notable that the analytical approach replicates design intuition the subdivision also influences the arrangement probabilities while there is still no discernable preference towards the flight deck forward or flight deck aft arrangement the propulsion plant location is more evenly distributed across its possible location in the subdivision example the largest difference between propulsion plant locations is 23 percentage points in comparison there is a 44 percentage point difference without subdivision this suggests that subdivision decisions can significantly influence the propulsion plant location by constraining its connectivity with other components in the vessel subdivisions also shift the probabilistic location of the bridge in the subdivision case the bridge has a 40 chance of being located at its forward most location versus a 28 chance without subdivision when the subdivisions constrain connectivity with the propulsion plant the bridge and propulsion plant are more likely to be arranged closer together because there is less variation in the routings in effect limiting the routing variations from the propulsion plant to the bridge pulls the two node locations in line with one another this effect is compounded by the coupling between the bridge and propulsion plant in both the information and electrical power system these results indicate that the interdependence of distributed systems and arrangements create a relationship between the zone deck subdivision the distributed system design and the arrangement of the propulsion plant and bridge because the probabilistic outcome analysis accounts of the interdependence of arrangements and distributed systems these design relationships and their influence on the solution can be efficiently identified and measured considering these interdependencies provides new and useful information to designers for instance the coupling between the bridge and propulsion plant location 5 conclusions design of vessel arrangement and distributed systems is complex task with many constraints numerous interdependencies and near infinite possible solutions traditional naval architecture design employs automated tools to enumerate many of these possible solutions and interrogate them to identify design decisions that produce desirable designs in novel vessel design the automated approach is often overly case specific and too resource intensive to be used in concept design in this paper an analysis approach which finds the expected vessel arrangements and distributed system configuration is proposed this approach considers the potential outcomes of a design without generating vessel models to help guide design decision making and higher fidelity investigations the proposed approach employs a network model of a vessel s physical and logical relationships to create a probabilistic mapping of arrangements and distributed systems in essence this provides the probability of an arrangement and distributed system configuration randomly occurring using this information the vessel design can be characterized despite design uncertainty and ambiguity in the future this approach will be tested on more difficult problems including those in 3 dimensions and multi hull configurations in these more difficult problems the design characterizations may be less pronounced than in the small design example in this paper developing methods to apply statistical analyses such as hierarchical clustering on the mappings of individual layers and edges may help elicit the influence of components on one another in addition sampling arrangements and system configurations from the probabilistic mapping would allow performance metrics to be evaluated for example this would allow complexity such as the knowledge based complexity shields 2017 or functional requirements to be considered other analyses may address incompatibilities between systems and spaces as well as traditional naval architecture analyses the approach taken in this paper can help mitigate the design risks that arise from making early stage design decisions the probabilistic approach provides new information about what to expect from one of the most complex and influential aspects of ship design a number of examples demonstrate the value of addressing early stage arrangements and distributed system configurations with this approach moreover the authors hope that the approach of analyzing the structure of a design problem to indicate what designers should expect from its solutions will be expanded into other realms of the ship design activity acknowledgements we would like to thank kelly cooper from the office of naval research for providing support for this project this work was funded under grant number n000141410712 additionally this work received government support under contract fa9550 11 c0028 awarded by the department of defense air force office of scientific research national defense science and engineering graduate ndseg fellowship 32 cfr 168a 
23233,a two dimensional numerical wave tank nwt is developed to simulate in the time domain fully nonlinear propagation of ocean waves in uniform currents fully nonlinear free surface motion is modeled using mixed eulerian lagrangian mel scheme and non uniform rational b spline nurbs formulation the potential theory and laplace equation are solved in the eulerian frame using a high order formulation of boundary elements method bem at each time step the distribution of boundary values is defined based on nurbs to discretize the boundary integral equation the spatial derivatives of the boundary values are computed precisely based on nurbs material node approach and fourth order runge kutta time integration are employed to update the free surface boundary conditions propagation of robust nonlinear wave is simulated to examine the accuracy and convergence of the present fully nonlinear numerical procedure propagation the nonlinear regular waves in the uniform flows are also studied and the solutions are compared with the theoretical results propagation of the irregular nonlinear waves is studied to compare with the analytical solutions furthermore fully nonlinear irregular wave in the uniform currents is simulated keywords non uniform rational b spline numerical wave tank irregular wave uniform current 1 introduction time domain simulation of the fully nonlinear propagation of the ocean waves in the ocean currents is an important problem in ocean engineering several analytical and numerical attempts have been conducted to solve the flow field due to waves interactions with ocean currents rusu and guedes soares 2011 used swan model to solve current wave interaction problem they compared the numerical results with experimental data presented by guedes soares and de pablo 2006 in addition the wave propagation and wave current interaction were studied in the tagus estuary numerically by rusu et al 2011 rankine source method was used by takagi 1991 to study the linear interaction of waves and current wave propagation across shearing current was studied by mckee 2006 using linear theory doppler effect of steady and uniform currents on a directional wave field has been studied by zhang and zhang 2004 they extended a directional hybrid wave model based on at least three fixed point wave records which has been used to predict a directional wave field deterministically a computational numerical method was developed by nwogu 2009 to study the nonlinear interactions between the surface gravity waves and depth varying ocean currents an analytical solution has been proposed by zaman and baddour 2011 to model the interaction of a current free monochromatic surface wave field with a wave free uniform current field several numerical wave tanks have been developed to simulate free surface flows in the time domain a viscous numerical wave basin has been developed to model time domain wave current flows by silva et al 2016 and zhang et al 2014 moreover propagation of linear irregular wave within a viscous numerical wave tank has been conducted by finnegan and gogginsa 2015 to predict wave structure interaction incompressible smoothed particle hydrodynamics was used to develop a potential numerical wave tank by farhadia et al 2016 for simulating the solitary wave propagation along the fixed depth channel on the other hand bem and mel approaches have been widely used to develop the potential numerical wave tank for solving time domain free surface problems the wave current interaction problem was modeled by ryu et al 2003 using a two dimensional potential nwt they used the constant element bem to solve flows in the eulerian frame the linear bem were applied to study wave body interaction in the potential nwt by koo and kim 2004 ganesan and sen 2015 and büchmann et al 1998 the curvilinear element bem polynomial elements formulation was used by ning and teng 2006 to simulate irregular wave propagation within an nwt furthermore a high order bem nurbs elements formulation was applied in an nwt to model irregular wave propagation and wave transmission over a submerged bar by abbasnia and ghiasi 2014b the wave body interaction problem was simulated by maniar and newman 1996 lee et al 1996 kring et al 2004 abbasnia and ghiasi 2014a 2013 datta and sen 2006 and abbasnia and guedes soares 2017 using nurbs elements kinematics of the free surface nodal points are obtained from the solutions of the boundary value problem based on mel approach then the free surface boundary values are updated in the lagrangian manner at each time step mel approach was proposed by longuet higgins and cokelet 1976 to implement the fully nonlinear free surface boundary conditions in the time domain simulation the computational nodes on the exact free surface move freely with the free surface fluid particles in the lagrangian manner based on the material node approach to update the free surface boundary values low order time integration schemes such as first order and second order finite difference formulations have been used in nwts by wu et al 2005 and xiao et al 2009 high order time integration schemes such as fourth order runge kutta method fifth order runge kutta gil method and fourth order adams bashforth moulton method have been used to make more accurate solutions by koo 2003 and zhang et al 2005 to retain the open water condition a wavemaker on the upstream wall and a damping zone sponge layer on the downstream wall should be adopted the wavemakers act as a disturbance source of the computational domain and the sponge layer dissipates the reflected wave due to the presence of the rigid end wall tank several wavemakers and sponge layers were reviewed by tanizawa 2000 and newman 2010 an artificial damping zone was proposed by cointe 1990 which implemented on the exact free surface boundary it has comprised the adding damping term added to the fully nonlinear free surface boundary conditions a nonphysical sawtooth instability due to variable mesh size may arise during the simulation different smoothing schemes have been employed to remove the so called sawtooth instability such as chebyshev five point smoothing scheme used by koo and kim 2004 and the b spline smoothing scheme proposed by tanizawa 2000 the intersection of the exact free surface with the rigid tank walls corner points is the main source of instability in numerical wave tanks kinematics of fluid particles on the corner points should be evaluated accurately to avoid the spike instability double node approach proposed by grilli and svendsen 1990 has been accomplished to remove corner problem in a two dimensional numerical wave tank sen 1995 presented an additional condition to enforce continuous velocity through a geometric corner point beside of the continuity condition of the velocity potential this alternative approach was used by maiti and sen 2001a b to simulate nonlinear wave body interaction in the time domain in this study a desingularized direct boundary integral equation is used to solve the potential flow field at each time step in the eulerian frame the nurbs formulation is applied to describe the fully nonlinear motions of the exact free surface boundary and the distribution of the boundary values as a high order scheme time marching scheme composed mel material node approach and fourth order runge kutta is implemented to update the fully nonlinear evolution of the free surface and its boundary values moreover the spatial derivatives of the free surface boundary values are obtained accurately using nurbs an artificial wavemaker is adopted on the fixed upstream boundary hence the normal flux of the theoretical incident wave potential is specified on the inflow boundary values an artificial damping zone is deployed on the exact free surface in front of the end wall of the tank to absorb the reflected wave due to the presence of the rigid wall the double node approach is used to obtain kinematics of the free surface particles on the corner points inevitable numerical instabilities are avoided using chebyshev five point smoothing scheme regular wave and fully developed the wave in the uniform currents are propagated within the tank to verify the present numerical procedure hence the accuracy and the convergence of the present numerical procedure are studied for different orders of meshes different mesh sizes and different time steps the numerical solutions are compared with the analytical solutions propagation of irregular wave is compared with the theoretical solutions the propagation of irregular waves in the uniform currents is studied in nurbs 2 mathematical formulation a cartesian coordinate system o x z is chosen for the nwt computational domain as shown in fig 1 the origin of the coordinate system is located on the still water line and the positive z axis is upwards it is assumed that the fluid is homogeneous incompressible and inviscid and the flow is irrotational hence the potential theory is used to explain the flow field 1 2 ϕ 0 in ω t the fully developed wave interacted with the uniform flow is described as 2 φ x z t ϕ 0 ϕ x z t where φ is total potential and ϕ 0 is the velocity potential of the uniform flow u which can be directed in x axis ϕ is the perturbation velocity potential due to the disturbance of upstream boundary both terms of the total potential satisfy the laplace equation the artificial wavemaker on the input boundary excites the computational domain hence the normal flux of velocity potential should be defined as 3 φ n ϕ 0 x ϕ i w x ϕ n ϕ i w x on s 1 where ϕ i w is theoretical velocity potential of the fully developed waves in the uniform flow on the rigid bottom boundary the boundary condition is the impermeable condition written as 4 φ n 0 ϕ n ϕ 0 n 0 on s 2 the boundary condition on the rigid wall tank assigned as 5 φ n ϕ 0 x ϕ n 0 on s 3 a solution of the flow field should be satisfied in both free surface boundary conditions on the exact free surface s 4 fully nonlinear kinematics and dynamics free surface boundary conditions are defined as 6 η t φ z φ η ϕ z ϕ η ϕ 0 x η x φ t g η 1 2 φ 2 p a ρ ϕ t g η 1 2 ϕ 2 ϕ 0 x ϕ x 1 2 ϕ 0 2 on s 4 where η x t is wave elevation and p a is the atmospheric pressure on the free surface which is equal to zero g is the gravitational acceleration and t is the time of simulation nevertheless to solve the time domain boundary value problem initial conditions should be assigned as 7 η x t 0 0 ϕ x z t 0 0 on s 4 boundary integral equation based on second green identity is employed to solve the boundary value problem as 8 c q ϕ q γ g q p ϕ p n ϕ p g q p n d γ where c q is the solid angle of the source point q γ s 1 s 2 s 3 s 4 is the boundary of the computational domain and p shows the field points on the computational boundaries when the source point is positioned outside inside or upon the computational boundary the solid angle equal to zero 1 and 1 2 for a smooth boundary respectively the green function is defined for two dimensional problems as 9 g q p 1 2 π ln 1 r q p where 10 r χ q χ p χ q and χ p are the positions of the source point and the field point respectively 3 numerical implementation 3 1 material node approach the fully nonlinear free surface boundary conditions are applied to the time depend boundary value problem using the mixed eulerian lagrangian method hence the boundary value problem is solved in the eulerian frame at each time step and the solution is used to update free surface boundary conditions in the lagrangian manner material node approach and fourth order runge kutta method are chosen to find the exact motions of the computational nodes on the free surface therefore collocation points on the free surface are permitted to move freely with fluid particles on the exact free surface and the fully nonlinear free surface boundary conditions are reformulated in the lagrangian frame as 11 δ η δ t ϕ z δ ϕ δ t g η 1 2 ϕ 2 1 2 ϕ 0 2 on s 4 where δ δ t is total derivatives operator 3 2 artificial damping zone to retain the accuracy of the numerical solution during the long time simulation an artificial damping zone sponge layer should be adopted at the end wall of the tank to mitigate the wave reflection the wave energy dissipation is carried out using adding an artificial damping term to the fully nonlinear free surface boundary conditions on the restricted region of the exact free surface adjacent to the end wall the fully nonlinear free surface boundary conditions with damping coefficient are formulated as 12 δ χ δ t ϕ ν x χ χ e δ ϕ δ t g η 1 2 ϕ ϕ 1 2 ϕ 0 ϕ 0 ν x ϕ ϕ e on s 4 where the subscript e corresponds to the reference configuration for the fluid flow the function ν x is damping coefficient addressed as 13 ν x α ω k 2 π x x 0 2 x 0 x x 1 x 0 2 π β k in which ω 2 π f is the characteristic angular wave frequency f 1 t is the wave frequency and t is the wave period k 2 π l is a characteristic wave number and l is the wavelength to control the strength and the broadness of the damping zone the parameters α and β are calibrated respectively and x 0 and x 1 indicate the edges of the damping zone length on the free surface the terms ϕ e and χ e are the reference values when reference values are set to the calm water condition ϕ e 0 η 0 the damping zone acts as a simple sponge layer the damping coefficient equals zero except in the damping zone x 0 x x 1 which is a continuous and the differentiation of the function is continuous 3 3 the non uniform rational b spline scheme the fully nonlinear evolution of the exact free surface is explained parametrically to find the motions of nodal points precisely the parametric interpolation functions such as bezier b spline and non uniform rational b spline curve or surface were summarized by piegl and tiller 1997 the nurbs curve is a piecewise function given as 14 χ u x u z u i 1 m n i p u p i w i i 1 m n i p u w i where 0 u 1 is the parametric value of the b spline curve m is the number of control points p i and w i is the weighted function n i p is the b spline basis function with a degree of p written as 15 n i 0 u 1 f o r u i u u i 1 0 o t h e r w i s e n i p u u u i u i p u i n i p 1 u u i p 1 u u i p 1 u i 1 n i 1 p 1 u where u i is the knot vector the curve should be represented by a set of nodal points x j j 1 m as shown in fig 2 eventually a system of m linear equations is provided to obtain the unknown control points p i i 1 m as 16 i 1 m ℜ i p u j p i x j j 1 m where 17 ℜ i p u n i p u w i ℓ 0 m n ℓ p u w j and u j is the value of knots given as 18 u j u j 1 x j x j 1 q j 2 m 1 and q j 1 m x j x j 1 the unit tangent vector s for every nodal point in the u direction can be defined as 19 s s x i s z k t u t u where t u x u z u is the tangential vector along the u direction the unit normal vector can be written as 20 n z u i x u k t u discretization of boundary integral is conducted based on choosing arbitrary curve points the spatial derivatives and the spatial integration of the collocation points properties are computed precisely based on the nurbs description 3 4 implementation of the boundary integral equation the variation of the boundary geometry and boundary values over the boundary are prescribed based on nurbs as 21 χ l u j 1 n l ℜ j p l u p j l 22 ϕ l u j 1 n l ℜ j p l u φ j l 23 ϕ n l u j 1 n l ℜ j p l u ψ j l where n l is the number of control points on each boundary l 1 2 3 4 and ℜ j p l is the rational b spline basis function of the boundary l with degree p also p j l φ j l and ψ j l are nets of control points the velocity potential and the normal fluxes of the velocity potential over each boundary l respectively the boundary integral equation in equation 8 is discretized based on the isoparametric elements which can be written as 24 c i l j 1 n l ℜ j p l u i l φ j l k 1 4 j 1 n k s k φ j k ℜ j p k u g n χ k χ i l j k u d u k 1 4 j 1 n k s k ψ j k ℜ j p k u g χ k χ i l j k u d u where u i l is the specific knot of control points and j k u represents jacobian of the geometry transformation obtained as 25 j k u d x k d u 2 d z k d u 2 s k shows the integrating domain of each boundary and c i l is the internal solid angle index of source point i on the boundary l gauss quadrature integration method is chosen for numerical integration if gaussian points and the collocation points are coinciding equation 24 can be written as 26 c i l j 1 n l ℜ j p l u i l φ j l k 1 4 j 1 n k m 1 n g k φ j k ℜ j p k u m k g n χ m k χ i l j k u m l ϖ m k k 1 4 j 1 n k m 1 n g k ψ j k ℜ j p k u m k g χ m k χ i l j k u m l ϖ m k where n g k and ϖ m k are the number of gaussian points and their weights on each boundary respectively two terms are defined to compose a linear system of equations for all collocation points as below 27 ϕ m k d i m l k j 1 n k φ j k ℜ j p k u m k g n χ m k χ i l j k u m l ϖ m k 28 ϕ m k n s i m l k j 1 n k ψ j k ℜ j p k u m k g χ m k χ i l j k u m l ϖ m k hence equation 26 can be written as 29 c i l ϕ i l k 1 4 m 1 n g k ϕ m k d i m l k k 1 4 m 1 n g k ϕ m k n s i m l k the rigid mode method addressed by brebbia 1978 is chosen to compute the coefficient c i l indirectly based on the corner point on the enclosed boundary hence a constant and uniform homogenous dirichlet problem is considered over the whole boundary and the normal gradient boundary value becomes zero therefore equation 29 is simplified to 30 c i l ϕ i l k 1 4 m 1 n g k ϕ m k d i m l k k 1 4 m 1 n g k ϕ m k d i m l k 0 where 31 d m k d i m l k w h e n o t h e r w i s e d i m l k c i l w h e n k l n i using isolating the diagonal terms on lhs of equation 30 it can be written as 32 d i i l l k 1 4 m 1 n g k d i m l k m i i n g l to yield a linear system of equations the given values are kept on rhs of equation 29 the unknown boundary values are moved to lhs of the equation the given potential on the free surface is shown by ϕ m 4 and the known normal flux of potential on the other boundary is represented by ϕ m k n finally equation 29 can be written as 33 k 1 3 m 1 n g k ϕ m k d i m l k m 1 n g 4 ϕ m 4 n s i m l 4 k 1 3 m 1 n g k ϕ m k n s i m l k m 1 n g 4 ϕ m 4 d i m l 4 for i n g l l 1 2 3 4 equation 33 is used to compose the linear algebraic system of equations 3 5 corner point problem in time stepping scheme to update the free surface the partial derivatives of velocity potential are achieved from the solution of the velocity potential field and the time derivatives of the velocity potential are obtained from the dynamic free surface boundary condition on the exact free surface the normal flux of the velocity potential is achieved from the boundary integral solution and the tangential derivative of the velocity potential ϕ s is obtained precisely using nurbs eventually the spatial derivative of the velocity potential in the cartesian coordinate system is computed as 34 ϕ x ϕ z x s z s z s x s ϕ s ϕ n where x s and z s are determined by nurbs curve the normal flux of the velocity potential is not continuous at the intersection of the free surface and the rigid walls corner points to find the unique spatial derivatives of the velocity potential at the corner points in the cartesian coordinate system the double nodes approach addressed by grilli and svendsen 1990 is applied to keep the stability of the numerical procedure the tangential derivative of the velocity potential at the corner points on the exact free surface is obtained as 35 ϕ 4 s ϕ 4 n cos θ m θ 4 sin θ m θ 4 ϕ m n 1 sin θ m θ 4 where m 1 3 corresponded to inflow wall and outflow wall respectively and 36 tan θ 4 z x which can be computed by nurbs formulation on the free surface for inflow boundary θ 1 π 2 and for the end wall θ 3 3 π 2 ϕ 4 n and ϕ m n are the normal flux of the velocity potential on the corner points correspond to the free surface and the inflow boundary or the end wall respectively 4 numerical applications and results 4 1 regular wave propagation of regular nonlinear wave in the uniform currents within the nurbs nwt is studied to examine the numerical stability and the convergence of the present numerical procedure to study the convergence and the accuracy of the solution root mean square rms error of the free surface evolution is defined as 37 r m s 1 n i t r i 1 n i t r η i e x a c t η i n u m η i e x a c t 2 where n i t r is the number of the iteration that should be passed to complete a wave period when the incident wave is fully propagated within the tank regarding the ability of the present numerical procedure to model fully nonlinear free surface motion the fifth order stokes wave addressed by fenton 1988 is chosen to propagate within the tank with the length 6 l characteristics of the damping term are α 1 and β 2 a numerical wave probe at 3 l is deployed to record the wave elevation numerically three mesh sizes δ x l 30 l 45 l 60 and different orders of b spline basis function are considered to check the accuracy of the solution the numerical solutions are compared with the theoretical solutions in table 1 the computational procedure is run using a laptop pc intel core i7 cpu 2 00 2 66 ghz and 8 00 gb of ram for all runs the time step δ t is set to t 60 the inflow and outflow boundary is discretized into linear elements with d 40 mesh size and the bottom boundary is divided using linear elements with l 20 mesh size the incident wave characteristic is a g t 2 0 0035 and d g t 2 0 01 where a is the wave amplitude it is shown that when the order of b spline basis function is increased the error of solution does not decrease necessarily for δ x l 60 the fourth order b spline basis function is more accurate than the fifth order one the finer mesh size increases the accuracy of the solution meanwhile the cpu time increases strictly the mesh size δ x l 60 and fourth order b spline basis function are considered to examine the convergence of the solution for the different time step sizes hence three sizes of the time step δ t t 30 t 60 t 90 are chosen to compare rms error of time stepping scheme as shown in fig 3 the rms error is decreased significantly when the time step is decreased from δ t t 30 to δ t t 60 whereas the accuracy of the solution is not improved for δ t t 90 numerical solution of the fifth order stokes wave propagation within nurbs nwt recorded by the numerical wave probe is compared with the analytical results in fig 4 the mesh size is l 60 and the time step size is t 60 the third order b spline basis function is chosen in the numerical procedure it shows that the present numerical solution is in good agreement with the analytical solution the normal flux of the second order stokes wave s velocity potential given as 38 ϕ i w x g a k ω cosh k z d cosh k d cos k x ω t 3 4 a 2 ω k cosh 2 k z d sinh 4 k d cos 2 k x ω t is chosen to propagate within the tank presence of uniform current propagation of the nonlinear regular wave k a 0 0250 interacted with the uniform currents is simulated as shown in fig 5 the following and the opposing uniform currents u 0 313 m s 1 are chosen to compare the numerical solutions with the analytical results hsu et al 2009 the agreement between the numerical simulation and the analytical results verify the numerical procedure of the nurbs nwt for both cases a snapshot of the free surface evolution along the numerical wave tank is shown at t 41 7 s in fig 6 the fully interacted incident wave with the uniform currents u 0 313 m s 1 is compared with the incident wave without current it shows that the wave height is increased when the wave interacts with the opposing uniform current as expected in fact the wave crest becomes sharper with the deeper wave tough when the current direction is opposite of the wave propagation direction in addition the wave celerity is decreased when the wave interacts with the opposing uniform currents the nurbs formulation is successful to simulate the nonlinearity of the free surface moreover it shows that the damping zone is properly diminishing the reflected waves due to the presence of the end wall the velocity of water particle on the exact free surface mid depth and bottom are obtained for the following current and the opposing current hence four phase angles are considered to verify the present solutions in fig 7 please noted that the clockwise rotation is positive direction and the magnitude of vertical velocity is maximum at the phase angles 0 and π whereas the horizontal velocity is magnified at π 2 and 3 π 2 it shows that the numerical solution has good agreement with the analytical results 4 2 irregular wave the irregular ocean wave can be decomposed in several regular waves second order stokes wave components were addressed by ning et al 2009 forristall 2000 and dalzell 1999 as a nonlinear uni directional wave group hence the superposition of the second order stokes wave components velocity potentials is substituted in the inflow boundary values the resultant second order irregular wave velocity potential flux is defined as 39 ϕ i w x ϕ i w 1 x ϕ i w 2 x and the following wave profile can be found as 40 η i w η i w 1 η i w 2 where ϕ i w 1 and η i w 1 indicate the first order velocity potential and the wave profile respectively and ϕ i w 2 and η i w 2 represent the second order wave characteristics the first order velocity potential function and the wave elevation are defined as 41 ϕ i w 1 x i 1 n i w a i g k i ω i cosh k i z d cosh k i d cos k i x x 0 ω i t t 0 ε i 42 η i w 1 i 1 n i w a i cos k i x x 0 ω i t t 0 ε i and the second order components can be given as 43 ϕ i w 2 x i 1 n i w j i a i a j k i k j g ω i ω j cosh k i k j z d d ω i ω j cosh k i k j d cos k i k j x x 0 ω i ω j t t 0 ε i ε j i 1 n i w j i a i a j k i k j g ω i ω j cosh k i k j z d d ω i ω j cosh k i k j d cos k i k j x x 0 ω i ω j t t 0 ε i ε j i 1 n i w a i 2 k i g ω i ω j cosh 2 k i z d d ω i ω j cosh 2 k i d sin 2 k i x x 0 ω i t t 0 ε i 44 η i w 2 i 1 n i w j i a i a j h ω i ω j cos k i k j x x 0 ω i ω j t t 0 ε i ε j i 1 n i w j i a i a j h ω i ω j cos k i k j x x 0 ω i ω j t t 0 ε i ε j i 1 n i w a i 2 h ω i ω j cos 2 k i x x 0 ω i t t 0 ε i in which n i w is the number of wave components ω i j is the angular wave frequency k i j is the wave number and ε i j is the phase angle of each wave component and also 45 d ω i ω j ω i ω j 2 g k i k j tanh k i k j d 46 g ω i ω j g 2 k i 2 2 ω i cosh 2 k i d k j 2 2 ω j cosh 2 k j d k i k j ω i ω j ω i ω j 1 tanh k i d tanh k j d 47 h ω i ω j ω i ω j g g d 1 2 k i tanh k i d k j tanh k j d g 2 k i k j ω i ω j cosh 2 k i k j d cosh k i d cosh k j d where x indicates the longitudinal position of wavemaker and x 0 and t 0 show the focus location and time respectively which is set to zero the tma shallow water wave spectrum presented by bouws et al 1985 is chosen to specify on the inflow boundary as 48 s f d σ 1 g 2 f 5 2 π 4 φ 2 π f d exp 1 25 f f p 4 exp f f p 1 2 2 σ 0 2 where the spectral parameter σ 1 is 7 57 10 4 is the frequency spreading parameter f p is peak frequency σ 0 0 07 when f f p and σ 0 0 09 for f f p to integrate the water depth the kitaigordskii shape function φ 2 π f d is used as 49 φ 2 π f d 1 2 ω d 2 f o r ω d 1 1 1 2 2 ω d 2 f o r 1 ω d 2 1 f o r ω d 2 where ω d 2 π f d g 1 2 two spectra a narrow frequency spectrum and a broad frequency spectrum are chosen to specify on the inflow boundary for the narrowband spectrum frequency interval is 0 67 h z 1 00 h z and the frequency spreading parameter is 20 for the broad spectrum the frequency is limited to 0 59 h z 1 63 h z and 2 the peak frequency is 0 767 h z for both spectrum substitution of the incident wave spectrum on the inflow boundary is conducted by decomposition of the spectra into n i w components the characteristics of each component are the frequency f i ω i 2 π and the wave amplitude a i which can be obtained as 50 f i 1 f i δ f i where 51 δ f i f n i w f 1 1 n i w 1 1 f i and 52 a i 2 s f i δ f i in the equation f 1 is the lowest frequency f n i w represents the highest frequency the wave number of each component k i is estimated by the dispersion relation and the phase angle is chosen randomly between 0 and 2 π the length of the nurbs nwt is 6 l max the depth of water is d 0 313 m and the length of the sponge layer is 2 l max where l max indicates wavelength of the lowest frequency the mesh size is δ x l max 60 the time step is δ t t p 60 and fourth order b spline basis function is used to model the free surface evolution the numerical wave probe is deployed at 3 l max to record the wave elevation propagations of both wave spectra are modeled and the numerical solutions are compared with the theoretical wave spectrums in fig 8 the second order wave components are used to describe the irregular wave for the narrow band wave spectrum the number of components is n i w 131 and the number of components for the broadband wave spectrum is n i w 144 comparisons show that there is good agreement between the present solutions and the analytical results moreover the convergence of the numerical procedure is retained for both wave frequency intervals on the other hand there is the insignificant difference between the numerical computation and the wave spectrum on peak frequency region in the narrow band wave spectrum it shows that when the wave steepness is increased the nonlinearity of the free surface becomes stronger propagations of both irregular wave spectra which fully developed with uniform flows are studied in fig 9 the uniform currents are u 0 1 m s 1 directed in the following and the opposing of the waves propagation it shows the wave height is magnified when both irregular waves interact with the opposing uniform current and the wave steepness is decreased when the current is following whereas the nonlinearity of the free surface is stronger when the wave height is increased the numerical stability of the present numerical procedure is conserved to model fully free surface simulation for opposing current there is no experimental data and prior numerical record to compare with the present solutions 5 conclusion the fully nonlinear propagation of the irregular wave fully interacted with the uniform flow was modeled using a nurbs nwt the potential theory and mel approach were used to solve the time domain boundary value problem a high order boundary integral equation based on green second identity was formulated to compute the flow field in the eulerian frame at each time step the boundary geometry and the distribution of the boundary values were defined based on the nurbs curve the material node approach and fourth order runge kutta time integration were used as a high order time marching scheme to update the free surface to conserve the open sea condition an artificial wavemaker was deployed on the inflow boundary to disturb the computational domain and a damping zone was adopted behind the end wall tank to dissipate the wave reflection due to the rigid end wall fully propagation of the nonlinear irregular waves in the uniform currents was modeled as a novel application of nurbs nwt the propagation of the fifth order stokes wave was solved to examine convergence and accuracy of the numerical procedure comparison of the rms errors of the solutions for different mesh sizes different time step sizes and the different orders of the b spline basis functions showed that the higher order of the b spline basis function does not ensure the accuracy of the solution moreover the accuracy sensitivity of the numerical procedure for different mesh sizes is stronger than the time step sizes the propagation of the second order stokes wave interaction in the uniform currents was compared with the analytical results regarding the examination of nurbs nwt for modeling fully nonlinear wave propagation a snapshot of the free surface evolutions due to the incident wave propagation in different directions of a uniform current was shown in the following the tma shallow water wave spectrum was considered to propagate in the uniform current both frequency bands were chosen to generate the irregular waves with different wave steepness the solutions of irregular waves in absence of uniform current were compared with the theoretical spectra these showed that there was good agreement between the present computations and the analytical solutions also the propagation of the nonlinear irregular waves in the uniform flow was modeled the records of the wave spectra for the following and the opposing uniform flows were compared the increment of wave height for the opposing uniform current and the decrement of wave height for the following uniform current were approved acknowledgments this work was performed within the strategic research plan of the centre for marine technology and ocean engineering centec which is financed by portuguese foundation for science and technology fundação para a ciência e tecnologia fct uid multi 00134 2013 lisboa 01 0145 feder 007629 
23233,a two dimensional numerical wave tank nwt is developed to simulate in the time domain fully nonlinear propagation of ocean waves in uniform currents fully nonlinear free surface motion is modeled using mixed eulerian lagrangian mel scheme and non uniform rational b spline nurbs formulation the potential theory and laplace equation are solved in the eulerian frame using a high order formulation of boundary elements method bem at each time step the distribution of boundary values is defined based on nurbs to discretize the boundary integral equation the spatial derivatives of the boundary values are computed precisely based on nurbs material node approach and fourth order runge kutta time integration are employed to update the free surface boundary conditions propagation of robust nonlinear wave is simulated to examine the accuracy and convergence of the present fully nonlinear numerical procedure propagation the nonlinear regular waves in the uniform flows are also studied and the solutions are compared with the theoretical results propagation of the irregular nonlinear waves is studied to compare with the analytical solutions furthermore fully nonlinear irregular wave in the uniform currents is simulated keywords non uniform rational b spline numerical wave tank irregular wave uniform current 1 introduction time domain simulation of the fully nonlinear propagation of the ocean waves in the ocean currents is an important problem in ocean engineering several analytical and numerical attempts have been conducted to solve the flow field due to waves interactions with ocean currents rusu and guedes soares 2011 used swan model to solve current wave interaction problem they compared the numerical results with experimental data presented by guedes soares and de pablo 2006 in addition the wave propagation and wave current interaction were studied in the tagus estuary numerically by rusu et al 2011 rankine source method was used by takagi 1991 to study the linear interaction of waves and current wave propagation across shearing current was studied by mckee 2006 using linear theory doppler effect of steady and uniform currents on a directional wave field has been studied by zhang and zhang 2004 they extended a directional hybrid wave model based on at least three fixed point wave records which has been used to predict a directional wave field deterministically a computational numerical method was developed by nwogu 2009 to study the nonlinear interactions between the surface gravity waves and depth varying ocean currents an analytical solution has been proposed by zaman and baddour 2011 to model the interaction of a current free monochromatic surface wave field with a wave free uniform current field several numerical wave tanks have been developed to simulate free surface flows in the time domain a viscous numerical wave basin has been developed to model time domain wave current flows by silva et al 2016 and zhang et al 2014 moreover propagation of linear irregular wave within a viscous numerical wave tank has been conducted by finnegan and gogginsa 2015 to predict wave structure interaction incompressible smoothed particle hydrodynamics was used to develop a potential numerical wave tank by farhadia et al 2016 for simulating the solitary wave propagation along the fixed depth channel on the other hand bem and mel approaches have been widely used to develop the potential numerical wave tank for solving time domain free surface problems the wave current interaction problem was modeled by ryu et al 2003 using a two dimensional potential nwt they used the constant element bem to solve flows in the eulerian frame the linear bem were applied to study wave body interaction in the potential nwt by koo and kim 2004 ganesan and sen 2015 and büchmann et al 1998 the curvilinear element bem polynomial elements formulation was used by ning and teng 2006 to simulate irregular wave propagation within an nwt furthermore a high order bem nurbs elements formulation was applied in an nwt to model irregular wave propagation and wave transmission over a submerged bar by abbasnia and ghiasi 2014b the wave body interaction problem was simulated by maniar and newman 1996 lee et al 1996 kring et al 2004 abbasnia and ghiasi 2014a 2013 datta and sen 2006 and abbasnia and guedes soares 2017 using nurbs elements kinematics of the free surface nodal points are obtained from the solutions of the boundary value problem based on mel approach then the free surface boundary values are updated in the lagrangian manner at each time step mel approach was proposed by longuet higgins and cokelet 1976 to implement the fully nonlinear free surface boundary conditions in the time domain simulation the computational nodes on the exact free surface move freely with the free surface fluid particles in the lagrangian manner based on the material node approach to update the free surface boundary values low order time integration schemes such as first order and second order finite difference formulations have been used in nwts by wu et al 2005 and xiao et al 2009 high order time integration schemes such as fourth order runge kutta method fifth order runge kutta gil method and fourth order adams bashforth moulton method have been used to make more accurate solutions by koo 2003 and zhang et al 2005 to retain the open water condition a wavemaker on the upstream wall and a damping zone sponge layer on the downstream wall should be adopted the wavemakers act as a disturbance source of the computational domain and the sponge layer dissipates the reflected wave due to the presence of the rigid end wall tank several wavemakers and sponge layers were reviewed by tanizawa 2000 and newman 2010 an artificial damping zone was proposed by cointe 1990 which implemented on the exact free surface boundary it has comprised the adding damping term added to the fully nonlinear free surface boundary conditions a nonphysical sawtooth instability due to variable mesh size may arise during the simulation different smoothing schemes have been employed to remove the so called sawtooth instability such as chebyshev five point smoothing scheme used by koo and kim 2004 and the b spline smoothing scheme proposed by tanizawa 2000 the intersection of the exact free surface with the rigid tank walls corner points is the main source of instability in numerical wave tanks kinematics of fluid particles on the corner points should be evaluated accurately to avoid the spike instability double node approach proposed by grilli and svendsen 1990 has been accomplished to remove corner problem in a two dimensional numerical wave tank sen 1995 presented an additional condition to enforce continuous velocity through a geometric corner point beside of the continuity condition of the velocity potential this alternative approach was used by maiti and sen 2001a b to simulate nonlinear wave body interaction in the time domain in this study a desingularized direct boundary integral equation is used to solve the potential flow field at each time step in the eulerian frame the nurbs formulation is applied to describe the fully nonlinear motions of the exact free surface boundary and the distribution of the boundary values as a high order scheme time marching scheme composed mel material node approach and fourth order runge kutta is implemented to update the fully nonlinear evolution of the free surface and its boundary values moreover the spatial derivatives of the free surface boundary values are obtained accurately using nurbs an artificial wavemaker is adopted on the fixed upstream boundary hence the normal flux of the theoretical incident wave potential is specified on the inflow boundary values an artificial damping zone is deployed on the exact free surface in front of the end wall of the tank to absorb the reflected wave due to the presence of the rigid wall the double node approach is used to obtain kinematics of the free surface particles on the corner points inevitable numerical instabilities are avoided using chebyshev five point smoothing scheme regular wave and fully developed the wave in the uniform currents are propagated within the tank to verify the present numerical procedure hence the accuracy and the convergence of the present numerical procedure are studied for different orders of meshes different mesh sizes and different time steps the numerical solutions are compared with the analytical solutions propagation of irregular wave is compared with the theoretical solutions the propagation of irregular waves in the uniform currents is studied in nurbs 2 mathematical formulation a cartesian coordinate system o x z is chosen for the nwt computational domain as shown in fig 1 the origin of the coordinate system is located on the still water line and the positive z axis is upwards it is assumed that the fluid is homogeneous incompressible and inviscid and the flow is irrotational hence the potential theory is used to explain the flow field 1 2 ϕ 0 in ω t the fully developed wave interacted with the uniform flow is described as 2 φ x z t ϕ 0 ϕ x z t where φ is total potential and ϕ 0 is the velocity potential of the uniform flow u which can be directed in x axis ϕ is the perturbation velocity potential due to the disturbance of upstream boundary both terms of the total potential satisfy the laplace equation the artificial wavemaker on the input boundary excites the computational domain hence the normal flux of velocity potential should be defined as 3 φ n ϕ 0 x ϕ i w x ϕ n ϕ i w x on s 1 where ϕ i w is theoretical velocity potential of the fully developed waves in the uniform flow on the rigid bottom boundary the boundary condition is the impermeable condition written as 4 φ n 0 ϕ n ϕ 0 n 0 on s 2 the boundary condition on the rigid wall tank assigned as 5 φ n ϕ 0 x ϕ n 0 on s 3 a solution of the flow field should be satisfied in both free surface boundary conditions on the exact free surface s 4 fully nonlinear kinematics and dynamics free surface boundary conditions are defined as 6 η t φ z φ η ϕ z ϕ η ϕ 0 x η x φ t g η 1 2 φ 2 p a ρ ϕ t g η 1 2 ϕ 2 ϕ 0 x ϕ x 1 2 ϕ 0 2 on s 4 where η x t is wave elevation and p a is the atmospheric pressure on the free surface which is equal to zero g is the gravitational acceleration and t is the time of simulation nevertheless to solve the time domain boundary value problem initial conditions should be assigned as 7 η x t 0 0 ϕ x z t 0 0 on s 4 boundary integral equation based on second green identity is employed to solve the boundary value problem as 8 c q ϕ q γ g q p ϕ p n ϕ p g q p n d γ where c q is the solid angle of the source point q γ s 1 s 2 s 3 s 4 is the boundary of the computational domain and p shows the field points on the computational boundaries when the source point is positioned outside inside or upon the computational boundary the solid angle equal to zero 1 and 1 2 for a smooth boundary respectively the green function is defined for two dimensional problems as 9 g q p 1 2 π ln 1 r q p where 10 r χ q χ p χ q and χ p are the positions of the source point and the field point respectively 3 numerical implementation 3 1 material node approach the fully nonlinear free surface boundary conditions are applied to the time depend boundary value problem using the mixed eulerian lagrangian method hence the boundary value problem is solved in the eulerian frame at each time step and the solution is used to update free surface boundary conditions in the lagrangian manner material node approach and fourth order runge kutta method are chosen to find the exact motions of the computational nodes on the free surface therefore collocation points on the free surface are permitted to move freely with fluid particles on the exact free surface and the fully nonlinear free surface boundary conditions are reformulated in the lagrangian frame as 11 δ η δ t ϕ z δ ϕ δ t g η 1 2 ϕ 2 1 2 ϕ 0 2 on s 4 where δ δ t is total derivatives operator 3 2 artificial damping zone to retain the accuracy of the numerical solution during the long time simulation an artificial damping zone sponge layer should be adopted at the end wall of the tank to mitigate the wave reflection the wave energy dissipation is carried out using adding an artificial damping term to the fully nonlinear free surface boundary conditions on the restricted region of the exact free surface adjacent to the end wall the fully nonlinear free surface boundary conditions with damping coefficient are formulated as 12 δ χ δ t ϕ ν x χ χ e δ ϕ δ t g η 1 2 ϕ ϕ 1 2 ϕ 0 ϕ 0 ν x ϕ ϕ e on s 4 where the subscript e corresponds to the reference configuration for the fluid flow the function ν x is damping coefficient addressed as 13 ν x α ω k 2 π x x 0 2 x 0 x x 1 x 0 2 π β k in which ω 2 π f is the characteristic angular wave frequency f 1 t is the wave frequency and t is the wave period k 2 π l is a characteristic wave number and l is the wavelength to control the strength and the broadness of the damping zone the parameters α and β are calibrated respectively and x 0 and x 1 indicate the edges of the damping zone length on the free surface the terms ϕ e and χ e are the reference values when reference values are set to the calm water condition ϕ e 0 η 0 the damping zone acts as a simple sponge layer the damping coefficient equals zero except in the damping zone x 0 x x 1 which is a continuous and the differentiation of the function is continuous 3 3 the non uniform rational b spline scheme the fully nonlinear evolution of the exact free surface is explained parametrically to find the motions of nodal points precisely the parametric interpolation functions such as bezier b spline and non uniform rational b spline curve or surface were summarized by piegl and tiller 1997 the nurbs curve is a piecewise function given as 14 χ u x u z u i 1 m n i p u p i w i i 1 m n i p u w i where 0 u 1 is the parametric value of the b spline curve m is the number of control points p i and w i is the weighted function n i p is the b spline basis function with a degree of p written as 15 n i 0 u 1 f o r u i u u i 1 0 o t h e r w i s e n i p u u u i u i p u i n i p 1 u u i p 1 u u i p 1 u i 1 n i 1 p 1 u where u i is the knot vector the curve should be represented by a set of nodal points x j j 1 m as shown in fig 2 eventually a system of m linear equations is provided to obtain the unknown control points p i i 1 m as 16 i 1 m ℜ i p u j p i x j j 1 m where 17 ℜ i p u n i p u w i ℓ 0 m n ℓ p u w j and u j is the value of knots given as 18 u j u j 1 x j x j 1 q j 2 m 1 and q j 1 m x j x j 1 the unit tangent vector s for every nodal point in the u direction can be defined as 19 s s x i s z k t u t u where t u x u z u is the tangential vector along the u direction the unit normal vector can be written as 20 n z u i x u k t u discretization of boundary integral is conducted based on choosing arbitrary curve points the spatial derivatives and the spatial integration of the collocation points properties are computed precisely based on the nurbs description 3 4 implementation of the boundary integral equation the variation of the boundary geometry and boundary values over the boundary are prescribed based on nurbs as 21 χ l u j 1 n l ℜ j p l u p j l 22 ϕ l u j 1 n l ℜ j p l u φ j l 23 ϕ n l u j 1 n l ℜ j p l u ψ j l where n l is the number of control points on each boundary l 1 2 3 4 and ℜ j p l is the rational b spline basis function of the boundary l with degree p also p j l φ j l and ψ j l are nets of control points the velocity potential and the normal fluxes of the velocity potential over each boundary l respectively the boundary integral equation in equation 8 is discretized based on the isoparametric elements which can be written as 24 c i l j 1 n l ℜ j p l u i l φ j l k 1 4 j 1 n k s k φ j k ℜ j p k u g n χ k χ i l j k u d u k 1 4 j 1 n k s k ψ j k ℜ j p k u g χ k χ i l j k u d u where u i l is the specific knot of control points and j k u represents jacobian of the geometry transformation obtained as 25 j k u d x k d u 2 d z k d u 2 s k shows the integrating domain of each boundary and c i l is the internal solid angle index of source point i on the boundary l gauss quadrature integration method is chosen for numerical integration if gaussian points and the collocation points are coinciding equation 24 can be written as 26 c i l j 1 n l ℜ j p l u i l φ j l k 1 4 j 1 n k m 1 n g k φ j k ℜ j p k u m k g n χ m k χ i l j k u m l ϖ m k k 1 4 j 1 n k m 1 n g k ψ j k ℜ j p k u m k g χ m k χ i l j k u m l ϖ m k where n g k and ϖ m k are the number of gaussian points and their weights on each boundary respectively two terms are defined to compose a linear system of equations for all collocation points as below 27 ϕ m k d i m l k j 1 n k φ j k ℜ j p k u m k g n χ m k χ i l j k u m l ϖ m k 28 ϕ m k n s i m l k j 1 n k ψ j k ℜ j p k u m k g χ m k χ i l j k u m l ϖ m k hence equation 26 can be written as 29 c i l ϕ i l k 1 4 m 1 n g k ϕ m k d i m l k k 1 4 m 1 n g k ϕ m k n s i m l k the rigid mode method addressed by brebbia 1978 is chosen to compute the coefficient c i l indirectly based on the corner point on the enclosed boundary hence a constant and uniform homogenous dirichlet problem is considered over the whole boundary and the normal gradient boundary value becomes zero therefore equation 29 is simplified to 30 c i l ϕ i l k 1 4 m 1 n g k ϕ m k d i m l k k 1 4 m 1 n g k ϕ m k d i m l k 0 where 31 d m k d i m l k w h e n o t h e r w i s e d i m l k c i l w h e n k l n i using isolating the diagonal terms on lhs of equation 30 it can be written as 32 d i i l l k 1 4 m 1 n g k d i m l k m i i n g l to yield a linear system of equations the given values are kept on rhs of equation 29 the unknown boundary values are moved to lhs of the equation the given potential on the free surface is shown by ϕ m 4 and the known normal flux of potential on the other boundary is represented by ϕ m k n finally equation 29 can be written as 33 k 1 3 m 1 n g k ϕ m k d i m l k m 1 n g 4 ϕ m 4 n s i m l 4 k 1 3 m 1 n g k ϕ m k n s i m l k m 1 n g 4 ϕ m 4 d i m l 4 for i n g l l 1 2 3 4 equation 33 is used to compose the linear algebraic system of equations 3 5 corner point problem in time stepping scheme to update the free surface the partial derivatives of velocity potential are achieved from the solution of the velocity potential field and the time derivatives of the velocity potential are obtained from the dynamic free surface boundary condition on the exact free surface the normal flux of the velocity potential is achieved from the boundary integral solution and the tangential derivative of the velocity potential ϕ s is obtained precisely using nurbs eventually the spatial derivative of the velocity potential in the cartesian coordinate system is computed as 34 ϕ x ϕ z x s z s z s x s ϕ s ϕ n where x s and z s are determined by nurbs curve the normal flux of the velocity potential is not continuous at the intersection of the free surface and the rigid walls corner points to find the unique spatial derivatives of the velocity potential at the corner points in the cartesian coordinate system the double nodes approach addressed by grilli and svendsen 1990 is applied to keep the stability of the numerical procedure the tangential derivative of the velocity potential at the corner points on the exact free surface is obtained as 35 ϕ 4 s ϕ 4 n cos θ m θ 4 sin θ m θ 4 ϕ m n 1 sin θ m θ 4 where m 1 3 corresponded to inflow wall and outflow wall respectively and 36 tan θ 4 z x which can be computed by nurbs formulation on the free surface for inflow boundary θ 1 π 2 and for the end wall θ 3 3 π 2 ϕ 4 n and ϕ m n are the normal flux of the velocity potential on the corner points correspond to the free surface and the inflow boundary or the end wall respectively 4 numerical applications and results 4 1 regular wave propagation of regular nonlinear wave in the uniform currents within the nurbs nwt is studied to examine the numerical stability and the convergence of the present numerical procedure to study the convergence and the accuracy of the solution root mean square rms error of the free surface evolution is defined as 37 r m s 1 n i t r i 1 n i t r η i e x a c t η i n u m η i e x a c t 2 where n i t r is the number of the iteration that should be passed to complete a wave period when the incident wave is fully propagated within the tank regarding the ability of the present numerical procedure to model fully nonlinear free surface motion the fifth order stokes wave addressed by fenton 1988 is chosen to propagate within the tank with the length 6 l characteristics of the damping term are α 1 and β 2 a numerical wave probe at 3 l is deployed to record the wave elevation numerically three mesh sizes δ x l 30 l 45 l 60 and different orders of b spline basis function are considered to check the accuracy of the solution the numerical solutions are compared with the theoretical solutions in table 1 the computational procedure is run using a laptop pc intel core i7 cpu 2 00 2 66 ghz and 8 00 gb of ram for all runs the time step δ t is set to t 60 the inflow and outflow boundary is discretized into linear elements with d 40 mesh size and the bottom boundary is divided using linear elements with l 20 mesh size the incident wave characteristic is a g t 2 0 0035 and d g t 2 0 01 where a is the wave amplitude it is shown that when the order of b spline basis function is increased the error of solution does not decrease necessarily for δ x l 60 the fourth order b spline basis function is more accurate than the fifth order one the finer mesh size increases the accuracy of the solution meanwhile the cpu time increases strictly the mesh size δ x l 60 and fourth order b spline basis function are considered to examine the convergence of the solution for the different time step sizes hence three sizes of the time step δ t t 30 t 60 t 90 are chosen to compare rms error of time stepping scheme as shown in fig 3 the rms error is decreased significantly when the time step is decreased from δ t t 30 to δ t t 60 whereas the accuracy of the solution is not improved for δ t t 90 numerical solution of the fifth order stokes wave propagation within nurbs nwt recorded by the numerical wave probe is compared with the analytical results in fig 4 the mesh size is l 60 and the time step size is t 60 the third order b spline basis function is chosen in the numerical procedure it shows that the present numerical solution is in good agreement with the analytical solution the normal flux of the second order stokes wave s velocity potential given as 38 ϕ i w x g a k ω cosh k z d cosh k d cos k x ω t 3 4 a 2 ω k cosh 2 k z d sinh 4 k d cos 2 k x ω t is chosen to propagate within the tank presence of uniform current propagation of the nonlinear regular wave k a 0 0250 interacted with the uniform currents is simulated as shown in fig 5 the following and the opposing uniform currents u 0 313 m s 1 are chosen to compare the numerical solutions with the analytical results hsu et al 2009 the agreement between the numerical simulation and the analytical results verify the numerical procedure of the nurbs nwt for both cases a snapshot of the free surface evolution along the numerical wave tank is shown at t 41 7 s in fig 6 the fully interacted incident wave with the uniform currents u 0 313 m s 1 is compared with the incident wave without current it shows that the wave height is increased when the wave interacts with the opposing uniform current as expected in fact the wave crest becomes sharper with the deeper wave tough when the current direction is opposite of the wave propagation direction in addition the wave celerity is decreased when the wave interacts with the opposing uniform currents the nurbs formulation is successful to simulate the nonlinearity of the free surface moreover it shows that the damping zone is properly diminishing the reflected waves due to the presence of the end wall the velocity of water particle on the exact free surface mid depth and bottom are obtained for the following current and the opposing current hence four phase angles are considered to verify the present solutions in fig 7 please noted that the clockwise rotation is positive direction and the magnitude of vertical velocity is maximum at the phase angles 0 and π whereas the horizontal velocity is magnified at π 2 and 3 π 2 it shows that the numerical solution has good agreement with the analytical results 4 2 irregular wave the irregular ocean wave can be decomposed in several regular waves second order stokes wave components were addressed by ning et al 2009 forristall 2000 and dalzell 1999 as a nonlinear uni directional wave group hence the superposition of the second order stokes wave components velocity potentials is substituted in the inflow boundary values the resultant second order irregular wave velocity potential flux is defined as 39 ϕ i w x ϕ i w 1 x ϕ i w 2 x and the following wave profile can be found as 40 η i w η i w 1 η i w 2 where ϕ i w 1 and η i w 1 indicate the first order velocity potential and the wave profile respectively and ϕ i w 2 and η i w 2 represent the second order wave characteristics the first order velocity potential function and the wave elevation are defined as 41 ϕ i w 1 x i 1 n i w a i g k i ω i cosh k i z d cosh k i d cos k i x x 0 ω i t t 0 ε i 42 η i w 1 i 1 n i w a i cos k i x x 0 ω i t t 0 ε i and the second order components can be given as 43 ϕ i w 2 x i 1 n i w j i a i a j k i k j g ω i ω j cosh k i k j z d d ω i ω j cosh k i k j d cos k i k j x x 0 ω i ω j t t 0 ε i ε j i 1 n i w j i a i a j k i k j g ω i ω j cosh k i k j z d d ω i ω j cosh k i k j d cos k i k j x x 0 ω i ω j t t 0 ε i ε j i 1 n i w a i 2 k i g ω i ω j cosh 2 k i z d d ω i ω j cosh 2 k i d sin 2 k i x x 0 ω i t t 0 ε i 44 η i w 2 i 1 n i w j i a i a j h ω i ω j cos k i k j x x 0 ω i ω j t t 0 ε i ε j i 1 n i w j i a i a j h ω i ω j cos k i k j x x 0 ω i ω j t t 0 ε i ε j i 1 n i w a i 2 h ω i ω j cos 2 k i x x 0 ω i t t 0 ε i in which n i w is the number of wave components ω i j is the angular wave frequency k i j is the wave number and ε i j is the phase angle of each wave component and also 45 d ω i ω j ω i ω j 2 g k i k j tanh k i k j d 46 g ω i ω j g 2 k i 2 2 ω i cosh 2 k i d k j 2 2 ω j cosh 2 k j d k i k j ω i ω j ω i ω j 1 tanh k i d tanh k j d 47 h ω i ω j ω i ω j g g d 1 2 k i tanh k i d k j tanh k j d g 2 k i k j ω i ω j cosh 2 k i k j d cosh k i d cosh k j d where x indicates the longitudinal position of wavemaker and x 0 and t 0 show the focus location and time respectively which is set to zero the tma shallow water wave spectrum presented by bouws et al 1985 is chosen to specify on the inflow boundary as 48 s f d σ 1 g 2 f 5 2 π 4 φ 2 π f d exp 1 25 f f p 4 exp f f p 1 2 2 σ 0 2 where the spectral parameter σ 1 is 7 57 10 4 is the frequency spreading parameter f p is peak frequency σ 0 0 07 when f f p and σ 0 0 09 for f f p to integrate the water depth the kitaigordskii shape function φ 2 π f d is used as 49 φ 2 π f d 1 2 ω d 2 f o r ω d 1 1 1 2 2 ω d 2 f o r 1 ω d 2 1 f o r ω d 2 where ω d 2 π f d g 1 2 two spectra a narrow frequency spectrum and a broad frequency spectrum are chosen to specify on the inflow boundary for the narrowband spectrum frequency interval is 0 67 h z 1 00 h z and the frequency spreading parameter is 20 for the broad spectrum the frequency is limited to 0 59 h z 1 63 h z and 2 the peak frequency is 0 767 h z for both spectrum substitution of the incident wave spectrum on the inflow boundary is conducted by decomposition of the spectra into n i w components the characteristics of each component are the frequency f i ω i 2 π and the wave amplitude a i which can be obtained as 50 f i 1 f i δ f i where 51 δ f i f n i w f 1 1 n i w 1 1 f i and 52 a i 2 s f i δ f i in the equation f 1 is the lowest frequency f n i w represents the highest frequency the wave number of each component k i is estimated by the dispersion relation and the phase angle is chosen randomly between 0 and 2 π the length of the nurbs nwt is 6 l max the depth of water is d 0 313 m and the length of the sponge layer is 2 l max where l max indicates wavelength of the lowest frequency the mesh size is δ x l max 60 the time step is δ t t p 60 and fourth order b spline basis function is used to model the free surface evolution the numerical wave probe is deployed at 3 l max to record the wave elevation propagations of both wave spectra are modeled and the numerical solutions are compared with the theoretical wave spectrums in fig 8 the second order wave components are used to describe the irregular wave for the narrow band wave spectrum the number of components is n i w 131 and the number of components for the broadband wave spectrum is n i w 144 comparisons show that there is good agreement between the present solutions and the analytical results moreover the convergence of the numerical procedure is retained for both wave frequency intervals on the other hand there is the insignificant difference between the numerical computation and the wave spectrum on peak frequency region in the narrow band wave spectrum it shows that when the wave steepness is increased the nonlinearity of the free surface becomes stronger propagations of both irregular wave spectra which fully developed with uniform flows are studied in fig 9 the uniform currents are u 0 1 m s 1 directed in the following and the opposing of the waves propagation it shows the wave height is magnified when both irregular waves interact with the opposing uniform current and the wave steepness is decreased when the current is following whereas the nonlinearity of the free surface is stronger when the wave height is increased the numerical stability of the present numerical procedure is conserved to model fully free surface simulation for opposing current there is no experimental data and prior numerical record to compare with the present solutions 5 conclusion the fully nonlinear propagation of the irregular wave fully interacted with the uniform flow was modeled using a nurbs nwt the potential theory and mel approach were used to solve the time domain boundary value problem a high order boundary integral equation based on green second identity was formulated to compute the flow field in the eulerian frame at each time step the boundary geometry and the distribution of the boundary values were defined based on the nurbs curve the material node approach and fourth order runge kutta time integration were used as a high order time marching scheme to update the free surface to conserve the open sea condition an artificial wavemaker was deployed on the inflow boundary to disturb the computational domain and a damping zone was adopted behind the end wall tank to dissipate the wave reflection due to the rigid end wall fully propagation of the nonlinear irregular waves in the uniform currents was modeled as a novel application of nurbs nwt the propagation of the fifth order stokes wave was solved to examine convergence and accuracy of the numerical procedure comparison of the rms errors of the solutions for different mesh sizes different time step sizes and the different orders of the b spline basis functions showed that the higher order of the b spline basis function does not ensure the accuracy of the solution moreover the accuracy sensitivity of the numerical procedure for different mesh sizes is stronger than the time step sizes the propagation of the second order stokes wave interaction in the uniform currents was compared with the analytical results regarding the examination of nurbs nwt for modeling fully nonlinear wave propagation a snapshot of the free surface evolutions due to the incident wave propagation in different directions of a uniform current was shown in the following the tma shallow water wave spectrum was considered to propagate in the uniform current both frequency bands were chosen to generate the irregular waves with different wave steepness the solutions of irregular waves in absence of uniform current were compared with the theoretical spectra these showed that there was good agreement between the present computations and the analytical solutions also the propagation of the nonlinear irregular waves in the uniform flow was modeled the records of the wave spectra for the following and the opposing uniform flows were compared the increment of wave height for the opposing uniform current and the decrement of wave height for the following uniform current were approved acknowledgments this work was performed within the strategic research plan of the centre for marine technology and ocean engineering centec which is financed by portuguese foundation for science and technology fundação para a ciência e tecnologia fct uid multi 00134 2013 lisboa 01 0145 feder 007629 
23234,during recent decades there has been open debate about a possible increase in the number and magnitude of more energetic hurricanes in the atlantic including their causes and implications in this work changes in extreme wave heights induced by hurricanes in the caribbean sea are analyzed a non stationary model is employed to study possible changes in the frequency of occurrence and magnitude of extreme waves from an hourly time series during the period of 1979 2012 the results indicate an increase in the occurrence of extreme wave events in the eastern and central caribbean and consequently a positive long term trend for 30yr return values the zone of the highest trends is observed in the western basin in the middle of the caribbean sea towards the gulf of mexico a final rate of approximately 2 events year for 2012 is found throughout the yucatan basin keywords hurricane waves extreme values caribbean sea non stationary model colombian caribbean 1 introduction in the caribbean sea the climate is strongly influenced by the northeast trade winds which characterize the wave climate for most of the year however these dynamics are altered during the last months of the year by the occurrence of the hurricane season in the atlantic despite having a lower intensity than hurricanes in areas such as the united states the economic impact associated with hurricanes in the caribbean is significant the most affected regions are puerto rico cuba the dominican republic and haiti a considerable amount of research has been dedicated to assessing hurricane behavior in the atlantic basin as a whole but there are few studies of the caribbean sea as an enclosed basin employing a parametric hurricane wind wave model and the spectral swan model ortiz 2009 researched the maximum wave height generated by the passing of hurricane lenny in the colombian caribbean and analyzed which zones are most vulnerable to a hurricane event ortiz 2011 presented an analysis of the storms which have passed through the colombian caribbean since 1900 the main objective was to identify the most vulnerable zones along the colombian continental coast rubiera 2005 carried out research for the caribbean sea showing that some of the most active hurricanes were observed during the first half of the twentieth century ortiz royero et al 2013 showed that other meteorological phenomena such as cold fronts may induce extreme wave events in the caribbean sea ortiz royero et al 2015 presented an analysis of the most important hurricane inducing extreme waves thought the coastal areas of the san andres island in the colombian caribbean sea results shows that the most vulnerable areas are located toward the southeastern where the insular shelf is narrow and low presence of coral reefs are observed calverley et al 2002 researched wave climate variability during hurricane conditions in the caribbean for a long term period of 79 years they used a peak over threshold extremal analysis of separate populations of hindcast sea state peaks for hurricanes in the cold and warm years in the caribbean there is limited availability of buoys with long periods of instrumental records there is also a high dispersion and lack of availability of wave data recorded by observation ships vos during extreme wave conditions furthermore the length of satellite data is short and extreme events are rarely captured these problems make the use of wave data obtained from numerical modeling an important alternative for long term climate analysis vinoth and young 2011 bertinelli et al 2016 used synthetic information from hurricane tracks in the caribbean sea and local income proxies to investigate the expected risk and losses associated to prevailing climate behavior for a future period of 30 years the main topic of this paper is not related to the knowledge of interannual and interdecadal variability of hurricane activity in the atlantic basin instead modeled wave time series from 1979 to 2012 are employed to analyze changes in extreme waves induced by hurricanes in the caribbean sea during recent decades the corrected ncep ncar reanalysis i winds proposed by montoya and osorio 2014 as a forcing for medium winds and blended winds in hurricane conditions proposed by montoya et al 2013 are used to obtain time series of significant wave height for 278 virtual buoys hereafter vbs these vbs correspond to locations defined strategically throughout the domain in some locations where buoys do not operate this allows a comprehensive spatial analysis to be performed that is not possible using in situ buoy data the peak over threshold pot method is used to investigate the spatial behavior of significant wave height peaks during hurricane conditions this paper is organized as follows section 2 describes the extreme and average wave data sets employed for the study area and describes the non stationary model section 3 presents the main results for hurricane spatial trends in the caribbean sea the summary and conclusions are given in the last section 2 material and methods 2 1 wave data time series methodology extreme and average conditions there is a significant difference between atmospheric conditions during hurricane occurrence and so called average conditions in the caribbean sea hurricane conditions include strong pressure gradients strong convection between the atmosphere and sea surface vorticity and vertical wind speed alterations moderated mainly by african easterly waves aews agudelo et al 2011 the strong perturbation of the pressure field produces a zone of strong rotating winds rotary circulation counter clockwise in the northern hemisphere and a strong debilitation of the wind fields in areas far from the hurricane eye in contrast so called average conditions are mainly affected by the movement of the inter tropical convergence zone itcz and the trade winds through the equatorial region for ocean wind wave models the wind speed is the most important forcing the strong spatial and temporal differences in wind speed during extreme and average conditions requires calibration and validation techniques to be employed separately for this research a procedure to obtain the hourly continuous time series of significant wave height for both conditions is presented in the fig 1 and summarized as follows 2 1 1 time series during average conditions light and moderate winds average time series of the main wave parameters from 1948 to 2012 for 278 virtual buoys vbs see fig 2 in the space domain were generated employing corrected ncep ncar reanalysis i hereafter ncepr1 meridional v and zonal u winds as forcings of the wavewatch iii hereafter wwiii 3 14 version model tolman 2009 the wwiii model is a third generation spectral wind wave model that solves the spectral action density balance equation for the wave number direction spectrum f k θ in cases without currents the variance energy of a wave package is a conserved quantity in cases with currents the energy or variance of a spectral component is no longer conserved due to the work done by the current on the mean momentum transfer of waves longuet higgins and stewart 1961 1962 however the wave action density a e σ is conserved this creates the wave action density spectrum n k θ f k θ σ which is the one selected in the model tolman 2009 these winds were corrected using the methodology proposed by montoya and osorio 2014 who showed that the wind speed during light and moderate wind conditions was strongly underestimated for ncep r1 near the cartagena and barranquilla region of the colombian caribbean sea when compared with quick scatterometer quikscat satellite data this underestimation in ncep r1 wind speed near tropical zones has been observed by several authors mcnoldy et al 2004 caires et al 2004 meissner et al 2001 feng et al 2006 simionato et al 2006 2 1 2 time series during hurricane conditions most of the reanalysis databases do not allow adequate representation of the wind field during hurricane conditions their coarse resolution impedes the adequate representation of the high wind variability near the hurricane eye and underestimates winds near the maximum wind speed zone even the most accurate scatterometer satellite data presents underestimations for strong winds above approximately 30 m s preventing the possibility of using methodologies based on satellite data such as that proposed by montoya and osorio 2014 for light and moderate winds this problem can be solved using blended winds in which the extremes are well reproduced based on this idea several authors have proposed corrections to wind speed during hurricane occurrence as mentioned by montoya et al 2013 swail and cox 2000 chao and tolman 2001 liu et al 2007 stockdon et al 2007 among others the time series of the main wave parameters during hurricane conditions were generated by employing the blended winds suggested by montoya et al 2013 as forcings of the wavewatch iii 3 14 version model for all the virtual buoys 278 as proposed for average conditions however the corrected ncepr1 reanalysis i employed for average conditions was used to calculate environmental winds instead of the north american regional reanalysis narr dataset for the preliminary analysis approximately 96 hurricanes were modeled from 1979 to 2012 montoya et al 2013 employed 10 buoys and hurricane katrina in the gulf of mexico and compared the main wave parameters such as the significant wave height hs peak direction and the directional spectrum based on the quadrant location for the storm track they performed a comparison between the available parameterizations included in the multigrid version 3 14 of the wavewatch iii model the available parameterizations employed for comparisons were tolman and chalikov 1996 hereafter tc with and without limited drag referred as tcflx3 and tcflx2 respectively in the user manual the baj parameterization from bidlot et al 2005 the wam4 parameterization proposed by gunther et al 1992 and acc350 proposed by ardhuin et al 2009 for this research the best global performance was obtained by the tolman and chalikov 1996 parameterization without limited drag tcflx2 considering tolman and chalikov 1996 as the best parameterization to describe the main wave parameters and directional spectrum structure and given the spatial complexity of wind speed during hurricane conditions a new calibration process was performed for the caribbean sea employing this parameterization the results obtained show the best parameterization to be that of tolman and chalikov 1996 without the lineal growth from cavaleri and malanotte rizzoli 1981 but with limited drag tcflx3 for high winds for average conditions a similar methodology to that proposed by montoya et al 2013 was employed using three noaa in situ buoys 42056 42058 and 42057 see fig 2 all the parameterizations available in the multigrid 3 14 version were tested the results obtained show better behavior of the tolman and chalikov 1996 parameterization for stable and nonlinear growth there were very small differences in wave parameters for most of the domain located in intermediate depth and deep water for both limited tcflx3 and unlimited tcflx2 drag for all simulations performed given these results and the fact that extreme wind is not expected during average conditions in the caribbean sea the tcflx2 without limited drag was employed for average conditions using the selected parameterization for both conditions a comprehensive sensitivity analysis calibration and validation were performed employing in situ and satellite data several factors were employed to obtain the optimal parameters such as time step grid resolution boundary conditions numerical parameterizations and current interactions for the tolman and chalikov 1996 parameterization an optimization process employing an adaptive random search method ars was employed for the most sensitive parameter stabsh c0 representing the wind speed correction factor proposed by tolman 2002f the optimized parameters employed to obtain the time series in the caribbean sea were 1 242 and 1 04 for average and extreme conditions respectively the parameters obtained in the calibration validation and optimization processes for both climatic conditions were employed for the modeling of all hurricanes and average conditions in the caribbean sea given the few buoys available in the caribbean sea near the most likely hurricane passing few hurricanes are fully captured fig 3 shows the modeled and measured significant wave height hs for hurricanes emily and wilma 2005 occurring during 2005 the results show the good performance of the calibrated wavewatch iii model when compare against in situ noaa buoy data 2 1 3 blended time series in order to merge the time series of average and extreme conditions a simple physical approach was undertaken the blended methodology proposed during hurricane conditions montoya et al 2013 allows the full zonal and meridional wind speed components to be obtained for hurricane conditions it assumes that the hypothesis is true that states the hurricane wind model performs well near the hurricane eye and the corrected ncepr1 reanalysis i wind components perform well far from the eye where very light and moderate winds are expected this means that throughout the whole simulation time when hurricanes have an influence on the wind environment the blended wind speed for the full space domain performs the best it also implies that the time series for wave parameters for each virtual buoy could be replaced by the extreme time series generated during extreme conditions 2 2 extreme model for significant wave height hs the peak over threshold pot method was used to investigate the peaks of the independent events associated to the exceedances y hs u over a threshold u the main assumption is that a number of episodes over the level u follow a poisson distribution with a rate of occurrence ν 0 year 1 the threshold excesses y 0 are modeled using the generalized pareto distribution gpd menendez et al 2008 méndez et al 2006 given the high temporal variability of hurricanes in the atlantic ocean and the caribbean sea there is a clear need to use a non stationary model instead of a traditional stationary one a parametric non stationary model as presented by menendez et al 2008 was used in which the main modifications to the traditional stationary model were made the technique employed was still the maximum likehood ml method and shuffled complex evolution optimization algorithm sce duan et al 1992 menendez 2008 was also utilized to obtain a greater efficiency in the parameter estimation it is assumed that the rate of occurrence of extreme values of significant wave height follows a non homogeneous poisson process luceño et al 2006 menendez et al 2008 cid et al 2015 this model involves a distribution related to the time interval between consecutive events given by the following distribution f t i t i 1 1 exp t i 1 t i v t d t where ν t is the rate of occurrence if ν t does not vary over time it is said that the poisson process is homogeneous and its parameter is given by λ νt if ν t varies over time it is said the poisson process is non homogeneous the non stationary model here is proposed to vary over time using the following expression ν t β 0 β 1 t it is further assumed that the magnitude of extreme wave events during hurricane conditions is a pareto distribution given by g x σ t ζ 1 1 ζ x u σ t 1 ζ where u is the threshold x is the aleatory variable here significant wave height or hs σt is the scale parameter and ξ is the shape parameter for the non stationary model it is considered that the scale parameter can vary in time by the following expression σ t t α 0 α 1 t adjusting a non stationary model cannot be performed by techniques such as probability plotting methods or moments however the maximum likelihood technique mle has a high adaptability to the structural changes in these models allowing them to be time dependent menendez et al 2008 parameter estimation β 0 β 1 α 0 α 1 ζ is done by adjusting the maximum likelihood method mlm the significance of parameters indicative of trends in the magnitude or frequency of extreme hs events is calculated by a likelihood profile coles 2001 menendez et al 2008 the mle technique is based on maximizing the log likelihood function l x θ to obtain the maximum likelihood estimators of the vector parameters θ if n exceedances y1 y2 y n are detected during a t year period for the generalized pareto distribution gpd poisson model the likelihood function is given by the following equation méndez et al 2006 l n y υ σ ξ υ t n e υ t n i 1 n g y i σ ξ for the non stationary model a non homogeneous poisson process is included in the generalized pareto distribution gpd poisson model as follows l y θ t i i 1 n log p n λ t i g y i σ t i ξ t i g is differentiated with respect to y g and the log likelihood function to be maximized see méndez et al 2006 and menendez et al 2008 2 3 events associated with the return period to estimate the quantiles related to the exceedance probability it is necessary to scale the return period tr to annual units the scale factor λ is considered to be the mean number of exceedances over the threshold u per year given by the expression λ n u n where nu is the total number of extreme values obtained by the pot method during n years of the observed sample the quantiles or events associated to a given return period tr are given by the expression x t r u σ ξ 1 λ t r ξ p a r a ξ 0 u σ log λ t r p a r a ξ 0 x t r t θ x q μ t σ t ξ t u σ t ξ t 1 λ t t r ξ t p a r a ξ 0 u σ t log λ t t r p a r a ξ 0 although the shape parameter ξ can vary with time for this research it is assumed to be constant and fixed to minimum and maximum values of 0 45 and 0 8 respectively this assumption has been tested by several authors méndez et al 2006 menendez et al 2008 northrop 2011 and has shown good results for the physical interpretation of the results the parameters β 0 β 1 α 0 α 1 ζ are defined as ξ shape parameter which shows the behavior of the most extreme values negative values mean that the most extreme value that can be reached is delimited while positive values occur when the decaying tail of the distribution is a function of power menendez 2008 a high value for the temporal variation of hurricanes in the caribbean sea is expected with a strong increasing trend for recent decades α0 the scale parameter shows the mean value of the exceedances over the threshold m α1 the scale parameter trend represents the trends observed in the magnitude of the events m year β0 the rate of occurrence shows the mean value of the rate of occurrence events year or energy evolution β1 the rate of occurrence trend shows the trend in the rate of occurrence or energy trend evolution over the threshold events year year 2 4 threshold selection analysis according to the research of de zea bermudeza and kotzb 2010 and scarrott and macdonald 2012 the threshold choice must consider the balance between the bias and the variance the asymptotes underlying the gdp approximation are valid and the bias is reduced only if the threshold selected is high enough however as the number of extreme events are reduced the variance of the parameter estimates is increased and the confidence interval becomes too wide neelamani 2009 confirmed the importance of threshold selection and researched its influence on extreme significant wave height estimates with threshold variations wang 2017 discussed the need for a high threshold at the tail of the distribution to have approximately the standardized form and the problems related to the lack of observations this included a declustering algorithm that proposed an optimal threshold selection method sigauke and bere 2017 discussed the methods employed for threshold selection and proposed a time varying threshold using a cubic smoothing spline with a constant shift factor other researchers who looked at threshold selection methods for different engineering applications are mailhot et al 2013 thevasiyani and perera 2014 campbell et al 2016 in this study a restriction for each virtual buoy was applied to avoid the inclusion of extreme events associated to other climatic conditions apart from hurricane induced waves such conditions may be cold fronts ortiz royero et al 2013 or movement of the inter tropical convergence zone itcz through the equatorial region which gives strong winds during the dry seasons december january february and june july august the threshold selection procedure applied is summarized through the following steps 1 for all the hurricanes occurring in the caribbean sea track information was time interpolated hourly the original information is available every six hours for most cases 2 a threshold value was estimated for each hourly time series of significant wave height and each virtual buoy a common threshold criterion was defined based on the 98 percentile since the database that compounded the virtual buoys is homogeneous for the 1979 2012 historical period analyzed the selection of the 98 percentile was based on a sweeping analysis based on several percentiles a high threshold tries to capture most hurricane conditions for a specific point given that we are interested in extreme waves in hurricanes a high threshold permits most of these events to be captured for the zones of high hurricane activity located in the tail of the distribution then the maxima value peak over consecutive values was selected 3 for each virtual buoy and the information obtained in steps 1 and 2 an automatic script was run the script selects the coincident events year month day and hour between the hourly hurricane tracks and the extreme events for a specific percentile this occurs for all the hourly periods inside an area defined by a circle with a radius r in degrees the procedure only obtained extreme events associated with hurricane activity and ensured that the statistical model only represents the spatial and temporal variability rate of occurrence and magnitude of ocean wave trends associated with this kind of phenomenon several radiuses were tested 2 3 and 4 that considered the physical patterns of the maximum waves around the eye of the hurricane the distance to a specific point and the number of events captured the best results were obtained using a value of four degrees r 4 giving more events captured without the gamma value and reaching the maximum set at 0 8 despite the broad range of values of dt seen in the literature dt minimum independence between consecutive events such as those shown by méndez et al 2006 the dt for this research was selected as three 3 days this was based on the values proposed by menendez et al 2008 ortego et al 2014 cid et al 2015 according to the physical behavior of the hurricane environment this value is considered to be acceptable 3 results and discussion fig 4 a shows the time series for a number of hurricanes in the caribbean sea from 1915 to 2012 highlighting the strong linear trend for recent decades fig 4b shows the time series of hs u values obtained using the peak over threshold method for a virtual buoy bv located at 16 n 75 w for a percentile of 98 00 fig 4c shows the results obtained for the fit to the pareto poisson distribution for the same point percentile 98 00 and shape parameter maximum ξ 0 8 in fig 3c the green line represents the variation in the rate of occurrence annual scale poisson parameter and the black line represents the quantile associated to variation in a specific return value tr through time the blue line represents the threshold μ and the blue dots are exceedances over the threshold for the aforementioned specific point β0 0 36 event year and β1 0 022 event year year giving a final rate of occurrence of 1 06 events year for 2012 fig 4a shows the oscillatory behavior of a number of hurricanes in the caribbean and is similar to the results obtained by other authors such as chylek and lesins 2008 for the entire atlantic basin the statistical results show no statistically significant trends during the periods of 1915 2012 and 1944 2012 however from 1979 to 2012 a strong statistically significant trend in the number of hurricanes is observed as confirmed by the results presented in fig 4b the spatial behavior of the final parameters selected for the maximum shape parameter ξ 0 8 and a percentile of 98 00 are presented in fig 5 for average wave values over the threshold α0 parameters the greatest values were observed in the north near the islands of cuba jamaica puerto rico the dominican republic and haiti and toward the middle of the caribbean sea in the east these results are consistent with most hurricanes passing through the caribbean sea the results show highly concentrated areas near the south and northeast of cuba and jamaica south of the dominican republic and haiti west of jamaica and in the coastal area of the yucatan peninsula regarding trends in the magnitude parameter α1 several isolated zones were observed i an area towards the northeast of the caribbean in the atlantic basin with positive trends reaching 0 16 m year ii an area located in the more energetic region of the yucatan basin in the cayman trough between the yucatan peninsula cuba honduras and jamaica with the highest values at around 0 20 m year approximately 6 m at the end of the simulation period and iii other specific areas located near haiti and toward the south near the coast of la guajira in colombia and the coastal area of venezuela values varying by around 0 08 m year most of the domain has low average values for the rate of occurrence of threshold excesses for hurricane events β0 lower values are coincident with the most energetic areas such areas are found towards the north close to puerto rico the dominican republic cuba jamaica and haiti toward the south of the caribbean sea in the continental areas of nicaragua costa rica panama and colombia where low hurricane activity is expected around 0 13 hurricanes year and toward the east from the lesser antilles to the dominican republic and haiti values of around 0 20 hurricanes year the highest rate of hurricane occurrence β0 in the caribbean sea was observed between the most energetic areas in the north and the least energetic areas in the southeast stretching from near the lesser antilles to the northwest close to the yucatan peninsula values vary between 0 45 hurricanes year in the east to maximums of around 0 8 hurricanes year in the northwest close to the yucatan basin and the cayman trench analysis of trends in the number of hurricanes per year shows that one of the largest areas with a high rate of occurrence parameter β1 was observed toward the east around the lesser antilles where most hurricanes enter the caribbean sea a high rate of occurrence was also seen slightly toward the north above approximately 17 near puerto rico and south of haiti and the dominican republic for this region there are high values of occurrence of around 0 037 hurricanes year values decrease toward the southeast of the caribbean sea to close to 0 01 hurricanes year the highest trends were observed towards the south of cuba above 18 n and the yucatan peninsula in the northwest for the zones of highest hurricane activity the trend in the rate of occurrence varies from around 0 05 events year year towards the northwest between 18 n and 21 n in the yucatan basin to approximately 0 03 events year year near the south of cuba at around 18 n towards the south of the caribbean sea near the colombian caribbean coast and close to other countries such as panama costa rica and venezuela no trend for extreme waves was observed to see the evolution in the rate of occurrence for extreme events in the caribbean sea associated to hurricane activity fig 6 shows the spatial behavior of the rate of occurrence for 2012 ν 2012 estimated employing the equation ν t β 0 β 1 t the results agree with those obtained for β 0 and β 1 showing that the highest rate of occurrence is toward the east near the lesser antilles this behavior is associated with the main zone of hurricane formation that enters the caribbean sea through the lesser antilles located in the main development region mdr in the eastern part of the atlantic redraw by goldenberg and shapiro 1996 for this region the results show values close to 1 7 hurricanes year these values decrease towards the north around puerto rico and the dominican republic where they reach around 0 9 and 1 4 hurricanes year respectively and towards the south of the caribbean sea where there are around 1 0 hurricanes year towards the west around the southeast of cuba and jamaica the recurrence of hurricane events for 2012 above 15 n decreases slightly reaching values of around 0 7 to 1 3 hurricanes year the recurrence of events then increases in a zone of high activity located near the coast of cuba and the yucatan peninsula with maximum values of approximately 2 hurricanes year the highest rate of occurrence in the caribbean sea is observed passing through the lesser antilles and crossing the yucatan basin generating a wide southeast northwest orientated band towards the south below 15 and near the coastal zone of the colombian caribbean sea the frequency of occurrence of extreme events is reduced the pot model reproduces the active zone near the coast of nicaragua where several historic hurricanes have been observed here the pareto poisson model gives a rate of occurrence of at least 1 hurricane year for the colombian caribbean coast the highest values for the rate of occurrence are located near the northeast of san andres island see fig 2 with values close to 0 35 hurricanes year regarding the coast of south america the most active zone with the highest rate of occurrence is observed near the coast of venezuela crossing through the important tourism islands of aruba bonaire curacao margarita venezuela and trinidad and tobago part of the lesser antilles in terms of colombia the highest rate of recurrence showing a probability of at least 1 hurricane per year appears toward the northeast of the colombian caribbean sea in the guajira region to compare the results obtained for spatial distribution of the number of hurricanes observed for the non stationary model during 2012 against actual number of hurricanes occurring in the caribbean sea the fig 7 shows the hurricane passing through the caribbean sea per year since 2012 to 2017 four points are located toward the most likely hurricanes passage and high rate of occurrence for year 2012 for the point p1 located toward the east near the lesser antiques lat 15 lon 63 the results shows the occurrence of the occurrence of two 2 hurricanes year around the influence area during 2012 the average number of hurricanes year since 2012 to 2017 was 1 7 hurricane year equal to the results obtained by the non stationary model around this area 1 7 hurricane year the number of hurricanes thought the six year 2012 2017 varies between 1 hurricane year to 4 hurricanes year during 2017 toward the west around puerto rico and the dominican republic p2 the average number of hurricanes decrease with values around 1 3 hurricane year similar to obtained for non stationary model around 0 9 and 1 4 during 2012 as mentioned earlier towards the west around cuba and jamaica the recurrence of hurricane events for 2012 above 15 n decreases slightly reaching values of around 0 7 to 1 3 hurricanes year this values are coherent with the average values observed for point p3 in recent years 2012 2017 around 0 7 hurricanes year toward the west around cuba and the yucatan peninsula with maximum values of approximately 2 hurricanes year for the non stationary model during 2012 the results obtained since 2012 to 2017 shows slightly low average values 1 2 hurricanes year in general the non stationary model presents a good agreement with the actual hurricane activity in the caribbean sea 4 summary and conclusions the peak over threshold method was applied to a significant wave height hs time series in the caribbean sea to identify the most energetic zones associated to hurricane activity the highest trends in the rate of occurrence energy evolution were observed near the coasts of the dominican republic haiti and puerto rico and toward the east where most hurricanes enter the caribbean sea another area of high occurrence high energy was observed toward the northwest of the caribbean sea in the yucatan basin and near the yucatan peninsula and cuba with values of around 2 hurricanes year employing the non stationary model it is possible to estimate events associated to a given return period tr that varies with time however taking spatial analysis as the main focus the results of significant wave height averaged over time for a return period tr of thirty years 30 were obtained for the time series of the peak over threshold method and the pareto poisson distribution they show that the highest waves with maximum values of around 12 m are found toward the east and the northwest of the caribbean sea toward the south of haiti the dominican republic and puerto rico and around cuba and the yucatan peninsula these results are consistent with the spatial behavior of the rate of occurrence hurricanes year based on the information acquired for recent decades this research presents the spatial behavior of previously unobserved trends in the rate of occurrence and the magnitude of extreme waves in the caribbean sea the results show that although there is not a generalized trend in magnitude in the caribbean there were some highly concentrated areas towards the northwest and the atlantic basin with slightly higher trends in the former 0 2 m year and 0 16 m year for the atlantic for a 32 year horizon these trends represent increments in significant wave height of around 6 m and 4 8 m respectively the most important pattern of extreme waves in the caribbean sea was obtained for the rate of occurrence of hurricane events a generalized trend was observed over a wide band across the caribbean sea this behavior shows a higher trend around the lesser antilles and the whole eastern region of the caribbean sea around 15 n with values of around 0 040 hurricanes year year giving a final rate of occurrence of approximately 1 4 events year during 2012 the zone of the highest trends is located in the western basin in the middle of the caribbean sea between 18 n and 22 n and 79 w 87 w towards the gulf of mexico through the yucatan basin there are higher coastal values for jamaica haiti and the dominican republic the spatial distribution of trends showing the rate of hurricane occurrence in the caribbean sea agrees with the behavior of hurricane activity in the whole basin during the last three decades as shown in fig 3a results for coastal areas located toward the north around the passage of the most frequent hurricanes show a high probability of occurrence of at least one hurricane per year for recent years after 2012 critical areas are around haiti the yucatan peninsula and the northwest coast of cuba acknowledgments the authors would like to thank the hurricane research division hrd that made the hurricane data employed in this research freely available furthermore they wish to thank dr fernando mendez and the ocean waves group from ih cantabria for their support with the methodology the main author would like to thank colciencias and the universidad de medellin for their economic support during the research process the main topic of this project was developed during ruben dario montoya s doctorate the author a f osorio is grateful to the colombian administrative department of science technology and innovation colciencias project extreme oceanic events in the insular coastal ecosystems ofthe colombian pacific and caribbean eventos oceanicos extremos en ecosistemas costeros insulares del pacífico y el caribe colombianos for financial support 
23234,during recent decades there has been open debate about a possible increase in the number and magnitude of more energetic hurricanes in the atlantic including their causes and implications in this work changes in extreme wave heights induced by hurricanes in the caribbean sea are analyzed a non stationary model is employed to study possible changes in the frequency of occurrence and magnitude of extreme waves from an hourly time series during the period of 1979 2012 the results indicate an increase in the occurrence of extreme wave events in the eastern and central caribbean and consequently a positive long term trend for 30yr return values the zone of the highest trends is observed in the western basin in the middle of the caribbean sea towards the gulf of mexico a final rate of approximately 2 events year for 2012 is found throughout the yucatan basin keywords hurricane waves extreme values caribbean sea non stationary model colombian caribbean 1 introduction in the caribbean sea the climate is strongly influenced by the northeast trade winds which characterize the wave climate for most of the year however these dynamics are altered during the last months of the year by the occurrence of the hurricane season in the atlantic despite having a lower intensity than hurricanes in areas such as the united states the economic impact associated with hurricanes in the caribbean is significant the most affected regions are puerto rico cuba the dominican republic and haiti a considerable amount of research has been dedicated to assessing hurricane behavior in the atlantic basin as a whole but there are few studies of the caribbean sea as an enclosed basin employing a parametric hurricane wind wave model and the spectral swan model ortiz 2009 researched the maximum wave height generated by the passing of hurricane lenny in the colombian caribbean and analyzed which zones are most vulnerable to a hurricane event ortiz 2011 presented an analysis of the storms which have passed through the colombian caribbean since 1900 the main objective was to identify the most vulnerable zones along the colombian continental coast rubiera 2005 carried out research for the caribbean sea showing that some of the most active hurricanes were observed during the first half of the twentieth century ortiz royero et al 2013 showed that other meteorological phenomena such as cold fronts may induce extreme wave events in the caribbean sea ortiz royero et al 2015 presented an analysis of the most important hurricane inducing extreme waves thought the coastal areas of the san andres island in the colombian caribbean sea results shows that the most vulnerable areas are located toward the southeastern where the insular shelf is narrow and low presence of coral reefs are observed calverley et al 2002 researched wave climate variability during hurricane conditions in the caribbean for a long term period of 79 years they used a peak over threshold extremal analysis of separate populations of hindcast sea state peaks for hurricanes in the cold and warm years in the caribbean there is limited availability of buoys with long periods of instrumental records there is also a high dispersion and lack of availability of wave data recorded by observation ships vos during extreme wave conditions furthermore the length of satellite data is short and extreme events are rarely captured these problems make the use of wave data obtained from numerical modeling an important alternative for long term climate analysis vinoth and young 2011 bertinelli et al 2016 used synthetic information from hurricane tracks in the caribbean sea and local income proxies to investigate the expected risk and losses associated to prevailing climate behavior for a future period of 30 years the main topic of this paper is not related to the knowledge of interannual and interdecadal variability of hurricane activity in the atlantic basin instead modeled wave time series from 1979 to 2012 are employed to analyze changes in extreme waves induced by hurricanes in the caribbean sea during recent decades the corrected ncep ncar reanalysis i winds proposed by montoya and osorio 2014 as a forcing for medium winds and blended winds in hurricane conditions proposed by montoya et al 2013 are used to obtain time series of significant wave height for 278 virtual buoys hereafter vbs these vbs correspond to locations defined strategically throughout the domain in some locations where buoys do not operate this allows a comprehensive spatial analysis to be performed that is not possible using in situ buoy data the peak over threshold pot method is used to investigate the spatial behavior of significant wave height peaks during hurricane conditions this paper is organized as follows section 2 describes the extreme and average wave data sets employed for the study area and describes the non stationary model section 3 presents the main results for hurricane spatial trends in the caribbean sea the summary and conclusions are given in the last section 2 material and methods 2 1 wave data time series methodology extreme and average conditions there is a significant difference between atmospheric conditions during hurricane occurrence and so called average conditions in the caribbean sea hurricane conditions include strong pressure gradients strong convection between the atmosphere and sea surface vorticity and vertical wind speed alterations moderated mainly by african easterly waves aews agudelo et al 2011 the strong perturbation of the pressure field produces a zone of strong rotating winds rotary circulation counter clockwise in the northern hemisphere and a strong debilitation of the wind fields in areas far from the hurricane eye in contrast so called average conditions are mainly affected by the movement of the inter tropical convergence zone itcz and the trade winds through the equatorial region for ocean wind wave models the wind speed is the most important forcing the strong spatial and temporal differences in wind speed during extreme and average conditions requires calibration and validation techniques to be employed separately for this research a procedure to obtain the hourly continuous time series of significant wave height for both conditions is presented in the fig 1 and summarized as follows 2 1 1 time series during average conditions light and moderate winds average time series of the main wave parameters from 1948 to 2012 for 278 virtual buoys vbs see fig 2 in the space domain were generated employing corrected ncep ncar reanalysis i hereafter ncepr1 meridional v and zonal u winds as forcings of the wavewatch iii hereafter wwiii 3 14 version model tolman 2009 the wwiii model is a third generation spectral wind wave model that solves the spectral action density balance equation for the wave number direction spectrum f k θ in cases without currents the variance energy of a wave package is a conserved quantity in cases with currents the energy or variance of a spectral component is no longer conserved due to the work done by the current on the mean momentum transfer of waves longuet higgins and stewart 1961 1962 however the wave action density a e σ is conserved this creates the wave action density spectrum n k θ f k θ σ which is the one selected in the model tolman 2009 these winds were corrected using the methodology proposed by montoya and osorio 2014 who showed that the wind speed during light and moderate wind conditions was strongly underestimated for ncep r1 near the cartagena and barranquilla region of the colombian caribbean sea when compared with quick scatterometer quikscat satellite data this underestimation in ncep r1 wind speed near tropical zones has been observed by several authors mcnoldy et al 2004 caires et al 2004 meissner et al 2001 feng et al 2006 simionato et al 2006 2 1 2 time series during hurricane conditions most of the reanalysis databases do not allow adequate representation of the wind field during hurricane conditions their coarse resolution impedes the adequate representation of the high wind variability near the hurricane eye and underestimates winds near the maximum wind speed zone even the most accurate scatterometer satellite data presents underestimations for strong winds above approximately 30 m s preventing the possibility of using methodologies based on satellite data such as that proposed by montoya and osorio 2014 for light and moderate winds this problem can be solved using blended winds in which the extremes are well reproduced based on this idea several authors have proposed corrections to wind speed during hurricane occurrence as mentioned by montoya et al 2013 swail and cox 2000 chao and tolman 2001 liu et al 2007 stockdon et al 2007 among others the time series of the main wave parameters during hurricane conditions were generated by employing the blended winds suggested by montoya et al 2013 as forcings of the wavewatch iii 3 14 version model for all the virtual buoys 278 as proposed for average conditions however the corrected ncepr1 reanalysis i employed for average conditions was used to calculate environmental winds instead of the north american regional reanalysis narr dataset for the preliminary analysis approximately 96 hurricanes were modeled from 1979 to 2012 montoya et al 2013 employed 10 buoys and hurricane katrina in the gulf of mexico and compared the main wave parameters such as the significant wave height hs peak direction and the directional spectrum based on the quadrant location for the storm track they performed a comparison between the available parameterizations included in the multigrid version 3 14 of the wavewatch iii model the available parameterizations employed for comparisons were tolman and chalikov 1996 hereafter tc with and without limited drag referred as tcflx3 and tcflx2 respectively in the user manual the baj parameterization from bidlot et al 2005 the wam4 parameterization proposed by gunther et al 1992 and acc350 proposed by ardhuin et al 2009 for this research the best global performance was obtained by the tolman and chalikov 1996 parameterization without limited drag tcflx2 considering tolman and chalikov 1996 as the best parameterization to describe the main wave parameters and directional spectrum structure and given the spatial complexity of wind speed during hurricane conditions a new calibration process was performed for the caribbean sea employing this parameterization the results obtained show the best parameterization to be that of tolman and chalikov 1996 without the lineal growth from cavaleri and malanotte rizzoli 1981 but with limited drag tcflx3 for high winds for average conditions a similar methodology to that proposed by montoya et al 2013 was employed using three noaa in situ buoys 42056 42058 and 42057 see fig 2 all the parameterizations available in the multigrid 3 14 version were tested the results obtained show better behavior of the tolman and chalikov 1996 parameterization for stable and nonlinear growth there were very small differences in wave parameters for most of the domain located in intermediate depth and deep water for both limited tcflx3 and unlimited tcflx2 drag for all simulations performed given these results and the fact that extreme wind is not expected during average conditions in the caribbean sea the tcflx2 without limited drag was employed for average conditions using the selected parameterization for both conditions a comprehensive sensitivity analysis calibration and validation were performed employing in situ and satellite data several factors were employed to obtain the optimal parameters such as time step grid resolution boundary conditions numerical parameterizations and current interactions for the tolman and chalikov 1996 parameterization an optimization process employing an adaptive random search method ars was employed for the most sensitive parameter stabsh c0 representing the wind speed correction factor proposed by tolman 2002f the optimized parameters employed to obtain the time series in the caribbean sea were 1 242 and 1 04 for average and extreme conditions respectively the parameters obtained in the calibration validation and optimization processes for both climatic conditions were employed for the modeling of all hurricanes and average conditions in the caribbean sea given the few buoys available in the caribbean sea near the most likely hurricane passing few hurricanes are fully captured fig 3 shows the modeled and measured significant wave height hs for hurricanes emily and wilma 2005 occurring during 2005 the results show the good performance of the calibrated wavewatch iii model when compare against in situ noaa buoy data 2 1 3 blended time series in order to merge the time series of average and extreme conditions a simple physical approach was undertaken the blended methodology proposed during hurricane conditions montoya et al 2013 allows the full zonal and meridional wind speed components to be obtained for hurricane conditions it assumes that the hypothesis is true that states the hurricane wind model performs well near the hurricane eye and the corrected ncepr1 reanalysis i wind components perform well far from the eye where very light and moderate winds are expected this means that throughout the whole simulation time when hurricanes have an influence on the wind environment the blended wind speed for the full space domain performs the best it also implies that the time series for wave parameters for each virtual buoy could be replaced by the extreme time series generated during extreme conditions 2 2 extreme model for significant wave height hs the peak over threshold pot method was used to investigate the peaks of the independent events associated to the exceedances y hs u over a threshold u the main assumption is that a number of episodes over the level u follow a poisson distribution with a rate of occurrence ν 0 year 1 the threshold excesses y 0 are modeled using the generalized pareto distribution gpd menendez et al 2008 méndez et al 2006 given the high temporal variability of hurricanes in the atlantic ocean and the caribbean sea there is a clear need to use a non stationary model instead of a traditional stationary one a parametric non stationary model as presented by menendez et al 2008 was used in which the main modifications to the traditional stationary model were made the technique employed was still the maximum likehood ml method and shuffled complex evolution optimization algorithm sce duan et al 1992 menendez 2008 was also utilized to obtain a greater efficiency in the parameter estimation it is assumed that the rate of occurrence of extreme values of significant wave height follows a non homogeneous poisson process luceño et al 2006 menendez et al 2008 cid et al 2015 this model involves a distribution related to the time interval between consecutive events given by the following distribution f t i t i 1 1 exp t i 1 t i v t d t where ν t is the rate of occurrence if ν t does not vary over time it is said that the poisson process is homogeneous and its parameter is given by λ νt if ν t varies over time it is said the poisson process is non homogeneous the non stationary model here is proposed to vary over time using the following expression ν t β 0 β 1 t it is further assumed that the magnitude of extreme wave events during hurricane conditions is a pareto distribution given by g x σ t ζ 1 1 ζ x u σ t 1 ζ where u is the threshold x is the aleatory variable here significant wave height or hs σt is the scale parameter and ξ is the shape parameter for the non stationary model it is considered that the scale parameter can vary in time by the following expression σ t t α 0 α 1 t adjusting a non stationary model cannot be performed by techniques such as probability plotting methods or moments however the maximum likelihood technique mle has a high adaptability to the structural changes in these models allowing them to be time dependent menendez et al 2008 parameter estimation β 0 β 1 α 0 α 1 ζ is done by adjusting the maximum likelihood method mlm the significance of parameters indicative of trends in the magnitude or frequency of extreme hs events is calculated by a likelihood profile coles 2001 menendez et al 2008 the mle technique is based on maximizing the log likelihood function l x θ to obtain the maximum likelihood estimators of the vector parameters θ if n exceedances y1 y2 y n are detected during a t year period for the generalized pareto distribution gpd poisson model the likelihood function is given by the following equation méndez et al 2006 l n y υ σ ξ υ t n e υ t n i 1 n g y i σ ξ for the non stationary model a non homogeneous poisson process is included in the generalized pareto distribution gpd poisson model as follows l y θ t i i 1 n log p n λ t i g y i σ t i ξ t i g is differentiated with respect to y g and the log likelihood function to be maximized see méndez et al 2006 and menendez et al 2008 2 3 events associated with the return period to estimate the quantiles related to the exceedance probability it is necessary to scale the return period tr to annual units the scale factor λ is considered to be the mean number of exceedances over the threshold u per year given by the expression λ n u n where nu is the total number of extreme values obtained by the pot method during n years of the observed sample the quantiles or events associated to a given return period tr are given by the expression x t r u σ ξ 1 λ t r ξ p a r a ξ 0 u σ log λ t r p a r a ξ 0 x t r t θ x q μ t σ t ξ t u σ t ξ t 1 λ t t r ξ t p a r a ξ 0 u σ t log λ t t r p a r a ξ 0 although the shape parameter ξ can vary with time for this research it is assumed to be constant and fixed to minimum and maximum values of 0 45 and 0 8 respectively this assumption has been tested by several authors méndez et al 2006 menendez et al 2008 northrop 2011 and has shown good results for the physical interpretation of the results the parameters β 0 β 1 α 0 α 1 ζ are defined as ξ shape parameter which shows the behavior of the most extreme values negative values mean that the most extreme value that can be reached is delimited while positive values occur when the decaying tail of the distribution is a function of power menendez 2008 a high value for the temporal variation of hurricanes in the caribbean sea is expected with a strong increasing trend for recent decades α0 the scale parameter shows the mean value of the exceedances over the threshold m α1 the scale parameter trend represents the trends observed in the magnitude of the events m year β0 the rate of occurrence shows the mean value of the rate of occurrence events year or energy evolution β1 the rate of occurrence trend shows the trend in the rate of occurrence or energy trend evolution over the threshold events year year 2 4 threshold selection analysis according to the research of de zea bermudeza and kotzb 2010 and scarrott and macdonald 2012 the threshold choice must consider the balance between the bias and the variance the asymptotes underlying the gdp approximation are valid and the bias is reduced only if the threshold selected is high enough however as the number of extreme events are reduced the variance of the parameter estimates is increased and the confidence interval becomes too wide neelamani 2009 confirmed the importance of threshold selection and researched its influence on extreme significant wave height estimates with threshold variations wang 2017 discussed the need for a high threshold at the tail of the distribution to have approximately the standardized form and the problems related to the lack of observations this included a declustering algorithm that proposed an optimal threshold selection method sigauke and bere 2017 discussed the methods employed for threshold selection and proposed a time varying threshold using a cubic smoothing spline with a constant shift factor other researchers who looked at threshold selection methods for different engineering applications are mailhot et al 2013 thevasiyani and perera 2014 campbell et al 2016 in this study a restriction for each virtual buoy was applied to avoid the inclusion of extreme events associated to other climatic conditions apart from hurricane induced waves such conditions may be cold fronts ortiz royero et al 2013 or movement of the inter tropical convergence zone itcz through the equatorial region which gives strong winds during the dry seasons december january february and june july august the threshold selection procedure applied is summarized through the following steps 1 for all the hurricanes occurring in the caribbean sea track information was time interpolated hourly the original information is available every six hours for most cases 2 a threshold value was estimated for each hourly time series of significant wave height and each virtual buoy a common threshold criterion was defined based on the 98 percentile since the database that compounded the virtual buoys is homogeneous for the 1979 2012 historical period analyzed the selection of the 98 percentile was based on a sweeping analysis based on several percentiles a high threshold tries to capture most hurricane conditions for a specific point given that we are interested in extreme waves in hurricanes a high threshold permits most of these events to be captured for the zones of high hurricane activity located in the tail of the distribution then the maxima value peak over consecutive values was selected 3 for each virtual buoy and the information obtained in steps 1 and 2 an automatic script was run the script selects the coincident events year month day and hour between the hourly hurricane tracks and the extreme events for a specific percentile this occurs for all the hourly periods inside an area defined by a circle with a radius r in degrees the procedure only obtained extreme events associated with hurricane activity and ensured that the statistical model only represents the spatial and temporal variability rate of occurrence and magnitude of ocean wave trends associated with this kind of phenomenon several radiuses were tested 2 3 and 4 that considered the physical patterns of the maximum waves around the eye of the hurricane the distance to a specific point and the number of events captured the best results were obtained using a value of four degrees r 4 giving more events captured without the gamma value and reaching the maximum set at 0 8 despite the broad range of values of dt seen in the literature dt minimum independence between consecutive events such as those shown by méndez et al 2006 the dt for this research was selected as three 3 days this was based on the values proposed by menendez et al 2008 ortego et al 2014 cid et al 2015 according to the physical behavior of the hurricane environment this value is considered to be acceptable 3 results and discussion fig 4 a shows the time series for a number of hurricanes in the caribbean sea from 1915 to 2012 highlighting the strong linear trend for recent decades fig 4b shows the time series of hs u values obtained using the peak over threshold method for a virtual buoy bv located at 16 n 75 w for a percentile of 98 00 fig 4c shows the results obtained for the fit to the pareto poisson distribution for the same point percentile 98 00 and shape parameter maximum ξ 0 8 in fig 3c the green line represents the variation in the rate of occurrence annual scale poisson parameter and the black line represents the quantile associated to variation in a specific return value tr through time the blue line represents the threshold μ and the blue dots are exceedances over the threshold for the aforementioned specific point β0 0 36 event year and β1 0 022 event year year giving a final rate of occurrence of 1 06 events year for 2012 fig 4a shows the oscillatory behavior of a number of hurricanes in the caribbean and is similar to the results obtained by other authors such as chylek and lesins 2008 for the entire atlantic basin the statistical results show no statistically significant trends during the periods of 1915 2012 and 1944 2012 however from 1979 to 2012 a strong statistically significant trend in the number of hurricanes is observed as confirmed by the results presented in fig 4b the spatial behavior of the final parameters selected for the maximum shape parameter ξ 0 8 and a percentile of 98 00 are presented in fig 5 for average wave values over the threshold α0 parameters the greatest values were observed in the north near the islands of cuba jamaica puerto rico the dominican republic and haiti and toward the middle of the caribbean sea in the east these results are consistent with most hurricanes passing through the caribbean sea the results show highly concentrated areas near the south and northeast of cuba and jamaica south of the dominican republic and haiti west of jamaica and in the coastal area of the yucatan peninsula regarding trends in the magnitude parameter α1 several isolated zones were observed i an area towards the northeast of the caribbean in the atlantic basin with positive trends reaching 0 16 m year ii an area located in the more energetic region of the yucatan basin in the cayman trough between the yucatan peninsula cuba honduras and jamaica with the highest values at around 0 20 m year approximately 6 m at the end of the simulation period and iii other specific areas located near haiti and toward the south near the coast of la guajira in colombia and the coastal area of venezuela values varying by around 0 08 m year most of the domain has low average values for the rate of occurrence of threshold excesses for hurricane events β0 lower values are coincident with the most energetic areas such areas are found towards the north close to puerto rico the dominican republic cuba jamaica and haiti toward the south of the caribbean sea in the continental areas of nicaragua costa rica panama and colombia where low hurricane activity is expected around 0 13 hurricanes year and toward the east from the lesser antilles to the dominican republic and haiti values of around 0 20 hurricanes year the highest rate of hurricane occurrence β0 in the caribbean sea was observed between the most energetic areas in the north and the least energetic areas in the southeast stretching from near the lesser antilles to the northwest close to the yucatan peninsula values vary between 0 45 hurricanes year in the east to maximums of around 0 8 hurricanes year in the northwest close to the yucatan basin and the cayman trench analysis of trends in the number of hurricanes per year shows that one of the largest areas with a high rate of occurrence parameter β1 was observed toward the east around the lesser antilles where most hurricanes enter the caribbean sea a high rate of occurrence was also seen slightly toward the north above approximately 17 near puerto rico and south of haiti and the dominican republic for this region there are high values of occurrence of around 0 037 hurricanes year values decrease toward the southeast of the caribbean sea to close to 0 01 hurricanes year the highest trends were observed towards the south of cuba above 18 n and the yucatan peninsula in the northwest for the zones of highest hurricane activity the trend in the rate of occurrence varies from around 0 05 events year year towards the northwest between 18 n and 21 n in the yucatan basin to approximately 0 03 events year year near the south of cuba at around 18 n towards the south of the caribbean sea near the colombian caribbean coast and close to other countries such as panama costa rica and venezuela no trend for extreme waves was observed to see the evolution in the rate of occurrence for extreme events in the caribbean sea associated to hurricane activity fig 6 shows the spatial behavior of the rate of occurrence for 2012 ν 2012 estimated employing the equation ν t β 0 β 1 t the results agree with those obtained for β 0 and β 1 showing that the highest rate of occurrence is toward the east near the lesser antilles this behavior is associated with the main zone of hurricane formation that enters the caribbean sea through the lesser antilles located in the main development region mdr in the eastern part of the atlantic redraw by goldenberg and shapiro 1996 for this region the results show values close to 1 7 hurricanes year these values decrease towards the north around puerto rico and the dominican republic where they reach around 0 9 and 1 4 hurricanes year respectively and towards the south of the caribbean sea where there are around 1 0 hurricanes year towards the west around the southeast of cuba and jamaica the recurrence of hurricane events for 2012 above 15 n decreases slightly reaching values of around 0 7 to 1 3 hurricanes year the recurrence of events then increases in a zone of high activity located near the coast of cuba and the yucatan peninsula with maximum values of approximately 2 hurricanes year the highest rate of occurrence in the caribbean sea is observed passing through the lesser antilles and crossing the yucatan basin generating a wide southeast northwest orientated band towards the south below 15 and near the coastal zone of the colombian caribbean sea the frequency of occurrence of extreme events is reduced the pot model reproduces the active zone near the coast of nicaragua where several historic hurricanes have been observed here the pareto poisson model gives a rate of occurrence of at least 1 hurricane year for the colombian caribbean coast the highest values for the rate of occurrence are located near the northeast of san andres island see fig 2 with values close to 0 35 hurricanes year regarding the coast of south america the most active zone with the highest rate of occurrence is observed near the coast of venezuela crossing through the important tourism islands of aruba bonaire curacao margarita venezuela and trinidad and tobago part of the lesser antilles in terms of colombia the highest rate of recurrence showing a probability of at least 1 hurricane per year appears toward the northeast of the colombian caribbean sea in the guajira region to compare the results obtained for spatial distribution of the number of hurricanes observed for the non stationary model during 2012 against actual number of hurricanes occurring in the caribbean sea the fig 7 shows the hurricane passing through the caribbean sea per year since 2012 to 2017 four points are located toward the most likely hurricanes passage and high rate of occurrence for year 2012 for the point p1 located toward the east near the lesser antiques lat 15 lon 63 the results shows the occurrence of the occurrence of two 2 hurricanes year around the influence area during 2012 the average number of hurricanes year since 2012 to 2017 was 1 7 hurricane year equal to the results obtained by the non stationary model around this area 1 7 hurricane year the number of hurricanes thought the six year 2012 2017 varies between 1 hurricane year to 4 hurricanes year during 2017 toward the west around puerto rico and the dominican republic p2 the average number of hurricanes decrease with values around 1 3 hurricane year similar to obtained for non stationary model around 0 9 and 1 4 during 2012 as mentioned earlier towards the west around cuba and jamaica the recurrence of hurricane events for 2012 above 15 n decreases slightly reaching values of around 0 7 to 1 3 hurricanes year this values are coherent with the average values observed for point p3 in recent years 2012 2017 around 0 7 hurricanes year toward the west around cuba and the yucatan peninsula with maximum values of approximately 2 hurricanes year for the non stationary model during 2012 the results obtained since 2012 to 2017 shows slightly low average values 1 2 hurricanes year in general the non stationary model presents a good agreement with the actual hurricane activity in the caribbean sea 4 summary and conclusions the peak over threshold method was applied to a significant wave height hs time series in the caribbean sea to identify the most energetic zones associated to hurricane activity the highest trends in the rate of occurrence energy evolution were observed near the coasts of the dominican republic haiti and puerto rico and toward the east where most hurricanes enter the caribbean sea another area of high occurrence high energy was observed toward the northwest of the caribbean sea in the yucatan basin and near the yucatan peninsula and cuba with values of around 2 hurricanes year employing the non stationary model it is possible to estimate events associated to a given return period tr that varies with time however taking spatial analysis as the main focus the results of significant wave height averaged over time for a return period tr of thirty years 30 were obtained for the time series of the peak over threshold method and the pareto poisson distribution they show that the highest waves with maximum values of around 12 m are found toward the east and the northwest of the caribbean sea toward the south of haiti the dominican republic and puerto rico and around cuba and the yucatan peninsula these results are consistent with the spatial behavior of the rate of occurrence hurricanes year based on the information acquired for recent decades this research presents the spatial behavior of previously unobserved trends in the rate of occurrence and the magnitude of extreme waves in the caribbean sea the results show that although there is not a generalized trend in magnitude in the caribbean there were some highly concentrated areas towards the northwest and the atlantic basin with slightly higher trends in the former 0 2 m year and 0 16 m year for the atlantic for a 32 year horizon these trends represent increments in significant wave height of around 6 m and 4 8 m respectively the most important pattern of extreme waves in the caribbean sea was obtained for the rate of occurrence of hurricane events a generalized trend was observed over a wide band across the caribbean sea this behavior shows a higher trend around the lesser antilles and the whole eastern region of the caribbean sea around 15 n with values of around 0 040 hurricanes year year giving a final rate of occurrence of approximately 1 4 events year during 2012 the zone of the highest trends is located in the western basin in the middle of the caribbean sea between 18 n and 22 n and 79 w 87 w towards the gulf of mexico through the yucatan basin there are higher coastal values for jamaica haiti and the dominican republic the spatial distribution of trends showing the rate of hurricane occurrence in the caribbean sea agrees with the behavior of hurricane activity in the whole basin during the last three decades as shown in fig 3a results for coastal areas located toward the north around the passage of the most frequent hurricanes show a high probability of occurrence of at least one hurricane per year for recent years after 2012 critical areas are around haiti the yucatan peninsula and the northwest coast of cuba acknowledgments the authors would like to thank the hurricane research division hrd that made the hurricane data employed in this research freely available furthermore they wish to thank dr fernando mendez and the ocean waves group from ih cantabria for their support with the methodology the main author would like to thank colciencias and the universidad de medellin for their economic support during the research process the main topic of this project was developed during ruben dario montoya s doctorate the author a f osorio is grateful to the colombian administrative department of science technology and innovation colciencias project extreme oceanic events in the insular coastal ecosystems ofthe colombian pacific and caribbean eventos oceanicos extremos en ecosistemas costeros insulares del pacífico y el caribe colombianos for financial support 
