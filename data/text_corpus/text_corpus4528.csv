index,text
22640,this paper contributes to improving the limitations of traditional failure mode and effect analysis this paper proposes a novel risk assessment approach using intuitionistic fuzzy numbers based quality function deployment qfd and vikor visekriterijumska optimizacija i kom promisno resenje approach qfd approach based on intuitionistic fuzzy numbers handles the correlation among design requirements drs correlation among customer requirements crs relationship between crs and drs for each criterion occurrence severity and detection intuitionistic fuzzy numbers ensure an advantage to present more accurate and easier the judgments of the experts this paper examines occupational accidents related failure modes in shipbuilding so that occupational accidents and failure modes mean crs and drs respectively qfd approach introduces an advantage to handle the relation between occupational accidents and failure modes qfd approach defines the weights of drs for each criterion the weights of occurrence severity and detection are determined by using intuitionistic fuzzy numbers to the judgments of experts these weights are integrated in vikor approach based on intuitionistic fuzzy numbers the result of vikor approach presents the ranking of the occupational accidents related failure modes in shipbuilding the highest risky failure mode in shipbuilding is defined as the lack of nets on ship scaffolds keywords risk evaluation failure mode and effect analysis shipbuilding vikor qfd intuitionistic fuzzy set 1 introduction the main elements of maritime transport which have disappearing boundaries and increasing international competition are sea vehicles and ports the vessels carrying the transports in the ports have a great contribution to the national economy by domestic abroad and transit transportation they fulfill the transportation of industrial raw materials in large quantities at a time the cost of maritime transportation is three and a half times seven times and 22 times cheaper according to the railway highway and airline respectively it is one of the important advantages of maritime transportation gümüş 2011 the shipbuilding industry is essentially an assembly industry in other words the products of many industries which are steel industry machinery manufacturing industry electrical electronics industry paint industry and rubber plastic industry are brought together in the shipyards based on a certain systematic and discipline on a scientific and technological basis the ship is the product of this industry storch et al 1988 this sector which has a labor intensive character has always been seen as an employment potential in countries it has contributed significantly to its development of other industries such as the iron and steel industry machinery manufacturing industry chemical and paint industry as a locomotive bakacak 2007 the shipbuilding industry is a heavy industry branch that shows the development based on world trade volume it is estimated that approximately 95 of the world trade is realized through maritime transportation it is understood that this sector is a very dangerous heavy industry area in terms of occupational health and safety ohs due to the works and working environment the operations such as utilization of scaffolding and working platforms frequently other works at height welding operations at all locations transportation of heavy materials with large cranes a large number of jobs that could cause fire and explosion or electric shock carrying heavy materials with manpower are available in the shipyard environment this issue increases the importance of ohs management in this industry risk assessment and risk management in a workplace where has many risk factors that lead to work accidents is a great requirement technically and humanly okumuş and barlas 2016 the workers perform various operations such as welding cutting and painting on the scaffoldings and structures so they can fall from the height or drop the employed materials and hand tools from the height the biggest reason for the falls is that the employees do not wear the seat belt that connects the bodies to the scaffold the other factors that are effective in falls are the insomnia of the employees working more than 3 h continuously on the scaffold fatigue defect of vision and loss of balance the materials immobilizing to the ground by an extension rope cause to fall the material from height this damages the workers on the working ground because they do not wear helmets and do not use protective equipment gas leakages in oxygen and acetylene sources cause in gas poisoning explosion and fire high quality chemical materials must be used for cleaning and gas free to prevent explosion and fire the body becomes conductive in electricity sources due to perspiration the electric shock occurs as a result of contact with high electric current during welding bakacak 2007 risk can occur as a natural result of production activity it is not possible to say that all risks can be destroyed but it is possible to decrease the risk to an acceptable level a risk assessment is performed using appropriate techniques to prevent unexpected errors vahdani vd 2015 failure mode and effects analysis fmea is a management technique for the product development and operation process it defines the probability and severity of possible failure modes in a system an effective fmea study allows the identification of the failure modes according to past experiences of similar products or processes it ensures to eliminate these failure modes from the system with minimum resource utilization and effort efe et al 2016 fmea is realized by using bs en 60812 2006 standard presents guidance as to how fmea may be implemented to obtain various reliability objectives fmea aims to define identify and eliminate the possible failures before they reach the customer fmea which is a proactive approach is utilized as a risk assessment approach to define and eliminate potential failures in systems and processes of service and manufacturing the other risk assessment methods present the solutions for the failure modes fm after accidents occur this situation provides to regulate the current programs use the suggested activities to reduce the likelihood of failure modes and prevent dangerous accidents it is defined as failure mode when the design requirements of a system could not meet a failure mode can trigger the occurring of the other failure modes efe et al 2017 eq 1 presents the risk priority number rpn by using the multiplication of occurrence o severity s and detection d criteria the terms of o s and d are the probability the severity and the detectability of the failure respectively liu et al 2014 1 r p n o s d the papers in the literature criticized the traditional fmea approach due to the below causes liu et al 2014 efe et al 2017 three parameters in the traditional fmea are o s and d the weights of these parameters are accepted as equal this issue realizes some mistakes in fmea application to real life the value of rpn for two different failure modes can be found the same in the traditional fmea for example o s and d are 3 2 4 and 2 4 3 for two failure modes respectively the value of rpn for two failure modes is 24 and the same fmea aims to define the riskiest failure mode the limitation of traditional fmea causes loss of time and resource determining the values of o s d in the traditional fmea is difficult by using 1 10 scale it causes loss of information due to multiplication of parameters in rpn the calculation of rpn is achieved by multiplication of o s and d it has no justification for the multiplication of them to obtain rpn this study aims to examine the relationship between occupational accidents oa and fm in shipbuilding the limitations of traditional fmea are presented in the literature review section this paper purposes to overcome these drawbacks of traditional fmea by using a novel approach this paper contains five parts the second part introduces the literature review the proposed qfd vikor methods intuitionistic fuzzy numbers and ifwa operator are given in part three part four handles a real life implementation comparison and sensitivity analysis the conclusions acquired from the study are presented in the last part 2 literature review various approaches in table 1 have been introduced in the literature to cope with the mentioned limitations qfd and vikor methods based on intuitionistic fuzzy numbers utilized in this paper were handled in some papers in the literature yu et al 2018 handled an integrated interval valued intuitionistic fuzzy sets and choquet integral based fuzzy qfd approach efe et al 2018 combined qfd and fuzzy linear programming methods for ergonomic product design efe et al 2017 used intuitionistic fuzzy numbers based vikor approach to rank the failure modes risk priority number in the traditional fmea is achieved by multiplying the values of o s and d the existing papers focused on to overcome the drawbacks of traditional fmea they took no account of the relationship between occupational accidents and failure modes this study proposed qfd approach to overcome this limitation qfd approach handles the correlation among drs correlation among crs relationship between crs and drs in this paper drs and crs state occupational accidents and failure modes respectively this study ensures to handle the relation between occupational accidents and failure modes for each risk criterion o s and d by using qfd approach unlike other studies qfd method provides three different rankings of failure modes due to three risk criteria o s and d intuitionistic fuzzy numbers based vikor method integrates three rankings and obtains unique ranking intuitionistic fuzzy numbers are used in vikor and qfd methods to collect the judgments of the experts intuitionistic fuzzy numbers include the membership degree non membership degree and hesitant degree of the judgments experts can introduce their opinions by using intuitionistic fuzzy numbers easily this paper also presents a novel approach which integrates qfd and vikor methods under intuitionistic fuzzy set for risk evaluation based fmea in shipbuilding this work contributes to fmea and risk evaluation in shipbuilding literature due to these benefits this paper examines the ranking of the occupational accidents related failure modes in shipbuilding decision makers present their opinions about correlation among design requirements drs correlation among customer requirements crs relationship between crs and drs for each criterion o s and d by using intuitionistic fuzzy numbers ifwa intuitionistic fuzzy weighted averaging operator is utilized to aggregate the judgments based on intuitionistic fuzzy numbers ifns of each expert priority values of failure modes for each criterion o s and d are determined by employing quality function deployment qfd method based on ifns these priority values are used for criteria based failure modes in intuitionistic fuzzy numbers based vikor visekriterijumska optimizacija i kom promisno resenje approach in this study intuitionistic fuzzy numbers based vikor approach is used to rank the failure modes the literature lacks papers about risk evaluation in shipbuilding by using ifns based qfd and vikor approach 3 the proposed approach 3 1 intuitionistic fuzzy sets ifs intuitionistic fuzzy numbers ifns include the membership degree μ non membership degree v and hesitant degree π eqs 2 5 are mathematical operations using a crisp number λ two ifns α 1 μ α 1 v α 1 and α 2 μ α 2 v α 2 2 α 1 α 2 μ α 1 μ α 2 μ α 1 μ α 2 v α 1 v α 2 3 α 1 α 2 μ α 1 μ α 2 v α 1 v α 2 v α 1 v α 2 4 λ α 1 1 μ α λ v α λ λ 0 5 α λ μ α λ 1 1 v α λ λ 0 ifwa operator which is developed by xu 2007 is presented in eq 6 and employed to combine the judgments of experts based on ifns 6 r i j i f w a λ r i j 1 r i j 2 r i j t λ 1 r i j 1 λ 2 r i j 2 λ t r i j t 1 k 1 t 1 μ i j k λ k k 1 t v i j k λ k k 1 t 1 μ i j k λ k k 1 t v i j k λ k 3 2 quality function deployment qfd is a complex approach to identify crs and to translate them into drs the house of quality hoq in fig 1 is the basic structure of qfd and contains the following elements the relationship matrix between crs and drs crs importance degrees and the correlation matrix for drs crs the first stage of hoq is the recognition of customer needs crs present the first data to the hoq and consider product characterizations demanded by customers drs it focuses on the product requirements which is are related to crs the weights of crs are defined by using different methods because their weights are not the same according to the customers relationship matrix between crs and drs shows the degree to which each dr influences its related cr the weights of drs are calculated by using the results obtained from the previous stages the hoq is implemented in practical and theoretical literature because it is importantly suitable to improve the previous stages it examines the feedback of the customers and ensures to use for the designers as useful information they can provide many advantages when the firms implement qfd approach which focuses on customer ensures to integrate big verbal data the model proposed by chen and chen 2014 calculating the relationship between n design requirements and m customer requirements is shown in eqs 7 9 7 r i j n o r m k 1 n γ k j r i j j 1 n k 1 n γ k j r i j γ k j indicates the degree of correlation between jth design requirement and kth design requirement rij indicates the degree of relationship between the ith customer requirement and kth design requirement r i j n o r m indicates the normalized degree of relationship between the ith customer requirement and kth design requirement γ k j and r ij are interval type 2 fuzzy numbers r i j n o r m is crisp number and shows relationship between ith customer requirement and jth design requirement 8 i r i l 1 m β i l d i i 1 m l 1 m β i l d i i 1 2 m βil shows the correlation between ith and jth customer requirements di is the importance degree of ith customer requirement β i l and d i are interval type 2 fuzzy numbers ir i is crisp number and shows importance degree of ith customer requirement based correlation the score for each design requirement can be calculated as follows 9 a s j i 1 m r i j n o r m i r i j 1 2 3 n a s j is the absolute score of jth design requirement ir i is the importance degree with correlation of ith customer requirement each as j is utilized as the importance degree of the criteria to assess the criteria based alternative in interval type 2 fuzzy number based topsis approach the priorities of each design requirement in the qfd can be obtained by assigning according to ascending order 3 3 intuitionistic fuzzy vikor method vikor approach which was presented by opricovic 1998 deals with ranking the alternatives ifvikor method is introduced in eqs 10 17 and means vikor method based on ifns efe et al 2017 the steps of ifvikor method are identified in fig 2 10 f j max i r i j f o r b e n e f i t c r i t e r i a min i r i j f o r cos t c r i t e r i a i 1 2 m 11 f j min i r i j f o r b e n e f i t c r i t e r i a max i r i j f o r cos t c r i t e r i a i 1 2 m 12 d i j d f j r i j d f j f j 13 d f j r i j 1 2 μ j μ i j 2 v j v i j 2 π j π i j 2 14 d f j f j 1 2 μ j μ j 2 v j v j 2 π j π j 2 15 s i j 1 n w j d i j 16 r i max j w j d i j 17 q i v s i s s s 1 v r i r r r 4 practical application for risk assessment the risk assessment process contains determining experts defining fm defining criteria that handled in assessment stages weighting the o s and d criteria and assessing failure modes phases fig 3 shows the phases of the proposed method a real life implementation in shipbuilding is introduced to ensure the applicability of the presented method the managers of the firm want to eliminate the occupational accidents related failure modes in shipbuilding in terms of ohs so the managers select the three experts in ohs area this expert group detects fourteen failure modes for further evaluation three experts e1 e2 and e3 responded to a survey to determine the occupational accidents related to the highest risky failure mode for shipbuilding e1 is an ohs expert while e2 and e3 are shipbuilding engineers they realized various shipbuilding projects for minimum of 10 years so that they have sufficient information and experience about risk assessment fourteen failure modes according to the experts opinions are fm1 working without a work permit fm2 working at height without safety belt fm3 establishing the inappropriate scaffolding fm4 utilization the inappropriate ladders fm5 utilization of crush and scrape cables fm6 irregularity of the paint tank fm7 lack of safety for tilting over of the tubes fm8 lack of warning plates fm9 noise warning device malfunctions for lifting equipment fm10 lack of identification and conformity control of hoists fm11 empty fire extinguishers fm12 open channel doors fm13 lack of nets on ship scaffolds fm14 lack of ventilation fan protection occupational accidents oa in shipbuilding are oa1 falling from height oa2 falling a heavy load on worker oa3 electric shock oa4 heat treatment and explosion 4 1 result and discussion the criteria o and s denote cost criteria and criterion d denotes the benefit criterion in traditional fmea uses rpn method which is the multiplication of the values of risk criteria o s and d it has been criticized to have several drawbacks this paper handled intuitionistic fuzzy numbers to evaluate the rating of each failure mode and weights of o s and d risk factors the weights of e1 e2 and e3 experts can be determined as 0 25 0 40 0 35 respectively experts introduce by using linguistic values the subjective opinions about the importance degrees of o s and d criteria the subjective opinions of the experts are combined to determine the importance degrees of the o s and d criteria this paper aims to provide an approach to define the most important failure mode among potential failure modes in shipbuilding in the literature various multi criteria decision making methods were considered to overcome the drawbacks of fmea there is no study about risk assessment using the qfd based vikor method under intuitionistic fuzzy set qfd approach provides to define the weight of each failure mode based on each criterion o s and d qfd approach includes three parts which are correlation among crs correlation among drs relationship between crs and drs in this study crs and drs mean occupational accidents and failure modes respectively the subjective opinions of experts are collected to achieve the weights of criteria and to assess the failure modes by using the linguistic terms which is shown in table 2 table 3 shows the correlation among drs failure modes for each criterion o s and d table 4 shows the correlation among crs occupational accidents for each criterion o s and d table 5 shows the relationship between crs occupational accidents and drs failure modes for each criterion o s and d ifwa operator is employed to aggregate the opinions of the experts in tables 3 5 this paper presents the weights of crs without correlation according to o s and d criteria as showing in table 6 the weights of crs with correlation according to o s and d criteria are obtained by using data in tables 4 and 6 and the results are illustrated in table 7 the weight of cr2 with correlation for o criterion is calculated by using eqs 2 and 3 and linguistic terms for cr2 of o criterion in tables 4 and 6 as follows 1 1 0 25 0 25 1 0 5 0 4 1 0 25 0 35 0 362 μ 0 65 0 25 0 4 0 4 0 65 0 35 0 535 v 0 362 0 535 0 103 0 5 0 4 0 1 0 181 0 721 0 098 0 5 0 4 0 1 0 181 0 721 0 098 0 591 0 288 0 121 the judgments of three experts in table 3 are aggregated by using ifwa operator the correlation between dr2 and dr3 for o criterion is calculated as follows 1 1 0 75 0 25 1 0 5 0 4 1 0 5 0 35 0 580 μ 0 15 0 25 0 4 0 4 0 4 0 35 0 313 v the judgments of three experts in table 5 are aggregated by using ifwa operator the aggregated relationship between cr2 and dr1 for o criterion is defined as follows 1 1 0 5 0 25 1 0 25 0 4 1 0 5 0 35 0 412 μ 0 4 0 25 0 65 0 4 0 4 0 35 0 486 v the result of qfd approach ensures the weights of drs and is presented in table 8 the weight of dr1 is calculated for an example 0 412 0 176 0 072 0 412 0 072 0 412 0 072 0 455 0 455 0 591 0 268 μ 0 486 0 757 0 486 0 757 0 875 0 486 0 875 0 425 0 425 0 288 0 425 0 288 0 591 v the importance degrees of o s and d according to expert 1 are h h and h respectively the importance degrees of o s and d according to expert 2 are vh h and m respectively the importance degrees of o s and d according to expert 3 are h m and m respectively the importance degrees of o s and d according to three experts are obtained by using ifwa operator the weights of o s and d are 0 8687 0 0967 0 0347 0 6814 0 2114 0 1072 and 0 5796 0 3130 0 1074 respectively the weight of o criterion is presented as an example 1 1 0 75 0 25 1 0 95 0 4 1 0 75 0 35 0 869 μ 0 15 0 25 0 05 0 4 0 15 0 35 0 097 v data in table 8 and the weights of o s and d are used in ifvikor method the ranking of occupational accidents related failure modes in shipbuilding is achieved by using ifvikor method and the results are introduced in table 9 drs in qfd approach are shown as failure modes in table 9 the highest risky failure mode is defined as fm 13 the lack of nets on ship scaffolds according to the proposed method the normalized intuitionistic fuzzy difference d 1 o of o criterion based a1 is introduced as an example 0 869 0 268 0 233 μ 0 097 0 591 0 097 0 591 0 630 v d f o r 1 o 1 2 0 233 0 127 2 0 630 0 756 2 0 136 0 117 2 0 117 d f o f o 1 2 0 690 0 127 2 0 170 0 756 2 0 140 0 117 2 0 575 d 1 o 0 117 0 575 0 204 s r and q values for a1 are calculated below s 1 0 204 0 391 0 847 3 0 481 r 1 max 0 204 0 391 0 847 0 847 q 1 0 5 0 481 0 313 0 671 0 313 0 5 0 847 0 565 1 000 0 565 0 558 various scaffolds are installed to perform many operations in shipbuilding the scaffold is constructed according to the purpose of use the weight to be carried and the operations to be performed on it breaking slippage and slumps occurring in randomly constructed scaffoldings and other structures cause injuries and deaths of employees and their surroundings as a result of the various works such as welding cutting and painting on the scaffolding and the high buildings the workers can fall from the height when employees drop material or hand tools from the height the employees at further down height can suffer from various accidents according to the result of this paper the most important four failure modes in shipbuilding were defined as lack of nets on ship scaffolds 1st rank utilization of the inappropriate ladders 2nd rank and working at height without safety belt 4th rank serious fires occur during maintenance repair and installation of machinery and electrical systems other fire risks are the non conforming electrical equipment in the workshops the expansion of the gas or liquid inside the pressure tubes due to the inappropriate storage conditions and equipping the environment with materials that will cause the fire to spread rapidly during a fire according to the result of this study the other important failure mode in shipbuilding is empty fire extinguishers 3rd rank 4 2 comparison crisp number type 1 fuzzy number interval type 2 fuzzy number and neutrosophic fuzzy number based qfd methods are also examined to show the effectiveness of the proposed approach the results of the other methods are presented in table 10 the results of the proposed approach and crisp number based qfd method are the same except dr5 dr6 and dr10 the results of the proposed approach and type 1 fuzzy number based qfd method are the same except dr5 and dr10 the results of the proposed approach and interval type 2 fuzzy number based qfd method are the same crisp number and type 1 fuzzy number are insufficient to obtain the judgments of experts this causes a loss of information about evaluation the obtained results of crisp and type 1 fuzzy numbers show this situation the level of this loss can be neglected because only three and two drs for crisp number and type 1 fuzzy number based qfd are different from the proposed method respectively the results of the proposed approach and neutrosophic fuzzy number based qfd method are the same it2f numbers use the interval among two membership degrees so it2f numbers provide more information than type 1 fuzzy numbers neutrosophic fuzzy number includes truth falsehood indeterminacy parameters the proposed method uses intuitionistic fuzzy numbers which include the membership degree non membership degree and hesitant degree the experts can present their judgments more accurately and easily by using intuitionistic fuzzy number 4 3 sensitivity analysis the sensitivity analysis is to aim to exchange each decision maker s importance degree with importance degree of another expert 6 different combinations are realized with three decision makers this sensitivity analysis examines the impact of exchanging of each decision maker s importance degree on the ranking of drs the importance degrees of expert 1 expert 2 and expert 3 in the original form of the study are 0 25 0 40 and 0 35 respectively in the sensitivity analysis e231 means that the weights of expert 1 expert 2 and expert 3 are 0 40 0 35 and 0 25 respectively new q values of drs are shown in fig 4 new q values of dr2 and dr7 have some deviations for 6 calculations the biggest deviation is 0 219 for q value of dr2 but the other deviations are very low the deviation of dr13 for q value is zero according to 6 calculations new rankings of drs are shown in fig 5 the biggest deviation for ranking of drs is 4 for dr3 the ranking of dr3 according to e231 and e132 is 5 and 9 respectively the difference between 5 and 9 is 4 the deviations for the rankings of dr10 and dr13 are zero 5 conclusion the presented approach has significant managerial successes for ohs policy according to the results of the paper firstly the study is realized in the fuzzy environment which overcomes the uncertainty of failure modes evaluation information the suggested approach ensures a flexible and suitable model for fmea based risk evaluation because intuitionistic fuzzy numbers provide us to define the hesitation of decision makers about evaluation secondly the weights of the risk criteria o s and d are defined by utilizing the intuitionistic fuzzy number operations this situation provides a more solid evaluation for the final risk ranking of the failure modes thirdly this paper proposed the intuitionistic fuzzy numbers based qfd method to determine the weights of the failure modes for each risk criterion o s and d in more accurately and effectively finally this paper proposes vikor method to rank the occupational accident related failure modes in shipbuilding this study suggests a new approach to risk evaluation literature based on fmea this study purposes to introduce a new method to overcome the limitation of traditional fmea all opinions of experts are collected based on linguistic terms these opinions are transformed to the intuitionistic fuzzy numbers ifwa operator aims to combine the judgments of experts about the weights of o s and d criteria qfd and vikor evaluations intuitionistic fuzzy numbers based qfd approach defines the weights of drs for each criterion o s and d the importance degrees of criteria and the weights of drs for o s and d are combined in intuitionistic fuzzy numbers based vikor approach which ranks the occupational accidents related failure modes in shipbuilding the highest risky failure mode in shipbuilding is defined as the lack of nets on ship scaffolds according to the result of intuitionistic fuzzy numbers based qfd and vikor methods intuitionistic fuzzy numbers based qfd and vikor methods have a big advantage of success for risk evaluation issue because they also examine the hesitation opinions of experts the other advantage of this study is to accomplish the drawbacks of the traditional fmea risk priority number in the traditional failure mode and effect analysis fmea is achieved by multiplying the values of o s and d it has been criticized due to several drawbacks this study handled the linguistic terms instead of crisp terms for the weights of criteria in fmea the decision makers can present their judgments more easily the subjective opinions of the experts are combined to define the importance degrees of these risk factors the presented approach is implemented for risk assessment in shipbuilding by using fmea in future papers the presented method can be utilized to accomplish the hesitation under intuitonistic fuzzy set environment in different applications such as personnel selection software selection and supplier selection acknowledgements the author would like to thank to the editor and anonymous reviewers whose insightful and constructive comments have improved the paper greatly 
22640,this paper contributes to improving the limitations of traditional failure mode and effect analysis this paper proposes a novel risk assessment approach using intuitionistic fuzzy numbers based quality function deployment qfd and vikor visekriterijumska optimizacija i kom promisno resenje approach qfd approach based on intuitionistic fuzzy numbers handles the correlation among design requirements drs correlation among customer requirements crs relationship between crs and drs for each criterion occurrence severity and detection intuitionistic fuzzy numbers ensure an advantage to present more accurate and easier the judgments of the experts this paper examines occupational accidents related failure modes in shipbuilding so that occupational accidents and failure modes mean crs and drs respectively qfd approach introduces an advantage to handle the relation between occupational accidents and failure modes qfd approach defines the weights of drs for each criterion the weights of occurrence severity and detection are determined by using intuitionistic fuzzy numbers to the judgments of experts these weights are integrated in vikor approach based on intuitionistic fuzzy numbers the result of vikor approach presents the ranking of the occupational accidents related failure modes in shipbuilding the highest risky failure mode in shipbuilding is defined as the lack of nets on ship scaffolds keywords risk evaluation failure mode and effect analysis shipbuilding vikor qfd intuitionistic fuzzy set 1 introduction the main elements of maritime transport which have disappearing boundaries and increasing international competition are sea vehicles and ports the vessels carrying the transports in the ports have a great contribution to the national economy by domestic abroad and transit transportation they fulfill the transportation of industrial raw materials in large quantities at a time the cost of maritime transportation is three and a half times seven times and 22 times cheaper according to the railway highway and airline respectively it is one of the important advantages of maritime transportation gümüş 2011 the shipbuilding industry is essentially an assembly industry in other words the products of many industries which are steel industry machinery manufacturing industry electrical electronics industry paint industry and rubber plastic industry are brought together in the shipyards based on a certain systematic and discipline on a scientific and technological basis the ship is the product of this industry storch et al 1988 this sector which has a labor intensive character has always been seen as an employment potential in countries it has contributed significantly to its development of other industries such as the iron and steel industry machinery manufacturing industry chemical and paint industry as a locomotive bakacak 2007 the shipbuilding industry is a heavy industry branch that shows the development based on world trade volume it is estimated that approximately 95 of the world trade is realized through maritime transportation it is understood that this sector is a very dangerous heavy industry area in terms of occupational health and safety ohs due to the works and working environment the operations such as utilization of scaffolding and working platforms frequently other works at height welding operations at all locations transportation of heavy materials with large cranes a large number of jobs that could cause fire and explosion or electric shock carrying heavy materials with manpower are available in the shipyard environment this issue increases the importance of ohs management in this industry risk assessment and risk management in a workplace where has many risk factors that lead to work accidents is a great requirement technically and humanly okumuş and barlas 2016 the workers perform various operations such as welding cutting and painting on the scaffoldings and structures so they can fall from the height or drop the employed materials and hand tools from the height the biggest reason for the falls is that the employees do not wear the seat belt that connects the bodies to the scaffold the other factors that are effective in falls are the insomnia of the employees working more than 3 h continuously on the scaffold fatigue defect of vision and loss of balance the materials immobilizing to the ground by an extension rope cause to fall the material from height this damages the workers on the working ground because they do not wear helmets and do not use protective equipment gas leakages in oxygen and acetylene sources cause in gas poisoning explosion and fire high quality chemical materials must be used for cleaning and gas free to prevent explosion and fire the body becomes conductive in electricity sources due to perspiration the electric shock occurs as a result of contact with high electric current during welding bakacak 2007 risk can occur as a natural result of production activity it is not possible to say that all risks can be destroyed but it is possible to decrease the risk to an acceptable level a risk assessment is performed using appropriate techniques to prevent unexpected errors vahdani vd 2015 failure mode and effects analysis fmea is a management technique for the product development and operation process it defines the probability and severity of possible failure modes in a system an effective fmea study allows the identification of the failure modes according to past experiences of similar products or processes it ensures to eliminate these failure modes from the system with minimum resource utilization and effort efe et al 2016 fmea is realized by using bs en 60812 2006 standard presents guidance as to how fmea may be implemented to obtain various reliability objectives fmea aims to define identify and eliminate the possible failures before they reach the customer fmea which is a proactive approach is utilized as a risk assessment approach to define and eliminate potential failures in systems and processes of service and manufacturing the other risk assessment methods present the solutions for the failure modes fm after accidents occur this situation provides to regulate the current programs use the suggested activities to reduce the likelihood of failure modes and prevent dangerous accidents it is defined as failure mode when the design requirements of a system could not meet a failure mode can trigger the occurring of the other failure modes efe et al 2017 eq 1 presents the risk priority number rpn by using the multiplication of occurrence o severity s and detection d criteria the terms of o s and d are the probability the severity and the detectability of the failure respectively liu et al 2014 1 r p n o s d the papers in the literature criticized the traditional fmea approach due to the below causes liu et al 2014 efe et al 2017 three parameters in the traditional fmea are o s and d the weights of these parameters are accepted as equal this issue realizes some mistakes in fmea application to real life the value of rpn for two different failure modes can be found the same in the traditional fmea for example o s and d are 3 2 4 and 2 4 3 for two failure modes respectively the value of rpn for two failure modes is 24 and the same fmea aims to define the riskiest failure mode the limitation of traditional fmea causes loss of time and resource determining the values of o s d in the traditional fmea is difficult by using 1 10 scale it causes loss of information due to multiplication of parameters in rpn the calculation of rpn is achieved by multiplication of o s and d it has no justification for the multiplication of them to obtain rpn this study aims to examine the relationship between occupational accidents oa and fm in shipbuilding the limitations of traditional fmea are presented in the literature review section this paper purposes to overcome these drawbacks of traditional fmea by using a novel approach this paper contains five parts the second part introduces the literature review the proposed qfd vikor methods intuitionistic fuzzy numbers and ifwa operator are given in part three part four handles a real life implementation comparison and sensitivity analysis the conclusions acquired from the study are presented in the last part 2 literature review various approaches in table 1 have been introduced in the literature to cope with the mentioned limitations qfd and vikor methods based on intuitionistic fuzzy numbers utilized in this paper were handled in some papers in the literature yu et al 2018 handled an integrated interval valued intuitionistic fuzzy sets and choquet integral based fuzzy qfd approach efe et al 2018 combined qfd and fuzzy linear programming methods for ergonomic product design efe et al 2017 used intuitionistic fuzzy numbers based vikor approach to rank the failure modes risk priority number in the traditional fmea is achieved by multiplying the values of o s and d the existing papers focused on to overcome the drawbacks of traditional fmea they took no account of the relationship between occupational accidents and failure modes this study proposed qfd approach to overcome this limitation qfd approach handles the correlation among drs correlation among crs relationship between crs and drs in this paper drs and crs state occupational accidents and failure modes respectively this study ensures to handle the relation between occupational accidents and failure modes for each risk criterion o s and d by using qfd approach unlike other studies qfd method provides three different rankings of failure modes due to three risk criteria o s and d intuitionistic fuzzy numbers based vikor method integrates three rankings and obtains unique ranking intuitionistic fuzzy numbers are used in vikor and qfd methods to collect the judgments of the experts intuitionistic fuzzy numbers include the membership degree non membership degree and hesitant degree of the judgments experts can introduce their opinions by using intuitionistic fuzzy numbers easily this paper also presents a novel approach which integrates qfd and vikor methods under intuitionistic fuzzy set for risk evaluation based fmea in shipbuilding this work contributes to fmea and risk evaluation in shipbuilding literature due to these benefits this paper examines the ranking of the occupational accidents related failure modes in shipbuilding decision makers present their opinions about correlation among design requirements drs correlation among customer requirements crs relationship between crs and drs for each criterion o s and d by using intuitionistic fuzzy numbers ifwa intuitionistic fuzzy weighted averaging operator is utilized to aggregate the judgments based on intuitionistic fuzzy numbers ifns of each expert priority values of failure modes for each criterion o s and d are determined by employing quality function deployment qfd method based on ifns these priority values are used for criteria based failure modes in intuitionistic fuzzy numbers based vikor visekriterijumska optimizacija i kom promisno resenje approach in this study intuitionistic fuzzy numbers based vikor approach is used to rank the failure modes the literature lacks papers about risk evaluation in shipbuilding by using ifns based qfd and vikor approach 3 the proposed approach 3 1 intuitionistic fuzzy sets ifs intuitionistic fuzzy numbers ifns include the membership degree μ non membership degree v and hesitant degree π eqs 2 5 are mathematical operations using a crisp number λ two ifns α 1 μ α 1 v α 1 and α 2 μ α 2 v α 2 2 α 1 α 2 μ α 1 μ α 2 μ α 1 μ α 2 v α 1 v α 2 3 α 1 α 2 μ α 1 μ α 2 v α 1 v α 2 v α 1 v α 2 4 λ α 1 1 μ α λ v α λ λ 0 5 α λ μ α λ 1 1 v α λ λ 0 ifwa operator which is developed by xu 2007 is presented in eq 6 and employed to combine the judgments of experts based on ifns 6 r i j i f w a λ r i j 1 r i j 2 r i j t λ 1 r i j 1 λ 2 r i j 2 λ t r i j t 1 k 1 t 1 μ i j k λ k k 1 t v i j k λ k k 1 t 1 μ i j k λ k k 1 t v i j k λ k 3 2 quality function deployment qfd is a complex approach to identify crs and to translate them into drs the house of quality hoq in fig 1 is the basic structure of qfd and contains the following elements the relationship matrix between crs and drs crs importance degrees and the correlation matrix for drs crs the first stage of hoq is the recognition of customer needs crs present the first data to the hoq and consider product characterizations demanded by customers drs it focuses on the product requirements which is are related to crs the weights of crs are defined by using different methods because their weights are not the same according to the customers relationship matrix between crs and drs shows the degree to which each dr influences its related cr the weights of drs are calculated by using the results obtained from the previous stages the hoq is implemented in practical and theoretical literature because it is importantly suitable to improve the previous stages it examines the feedback of the customers and ensures to use for the designers as useful information they can provide many advantages when the firms implement qfd approach which focuses on customer ensures to integrate big verbal data the model proposed by chen and chen 2014 calculating the relationship between n design requirements and m customer requirements is shown in eqs 7 9 7 r i j n o r m k 1 n γ k j r i j j 1 n k 1 n γ k j r i j γ k j indicates the degree of correlation between jth design requirement and kth design requirement rij indicates the degree of relationship between the ith customer requirement and kth design requirement r i j n o r m indicates the normalized degree of relationship between the ith customer requirement and kth design requirement γ k j and r ij are interval type 2 fuzzy numbers r i j n o r m is crisp number and shows relationship between ith customer requirement and jth design requirement 8 i r i l 1 m β i l d i i 1 m l 1 m β i l d i i 1 2 m βil shows the correlation between ith and jth customer requirements di is the importance degree of ith customer requirement β i l and d i are interval type 2 fuzzy numbers ir i is crisp number and shows importance degree of ith customer requirement based correlation the score for each design requirement can be calculated as follows 9 a s j i 1 m r i j n o r m i r i j 1 2 3 n a s j is the absolute score of jth design requirement ir i is the importance degree with correlation of ith customer requirement each as j is utilized as the importance degree of the criteria to assess the criteria based alternative in interval type 2 fuzzy number based topsis approach the priorities of each design requirement in the qfd can be obtained by assigning according to ascending order 3 3 intuitionistic fuzzy vikor method vikor approach which was presented by opricovic 1998 deals with ranking the alternatives ifvikor method is introduced in eqs 10 17 and means vikor method based on ifns efe et al 2017 the steps of ifvikor method are identified in fig 2 10 f j max i r i j f o r b e n e f i t c r i t e r i a min i r i j f o r cos t c r i t e r i a i 1 2 m 11 f j min i r i j f o r b e n e f i t c r i t e r i a max i r i j f o r cos t c r i t e r i a i 1 2 m 12 d i j d f j r i j d f j f j 13 d f j r i j 1 2 μ j μ i j 2 v j v i j 2 π j π i j 2 14 d f j f j 1 2 μ j μ j 2 v j v j 2 π j π j 2 15 s i j 1 n w j d i j 16 r i max j w j d i j 17 q i v s i s s s 1 v r i r r r 4 practical application for risk assessment the risk assessment process contains determining experts defining fm defining criteria that handled in assessment stages weighting the o s and d criteria and assessing failure modes phases fig 3 shows the phases of the proposed method a real life implementation in shipbuilding is introduced to ensure the applicability of the presented method the managers of the firm want to eliminate the occupational accidents related failure modes in shipbuilding in terms of ohs so the managers select the three experts in ohs area this expert group detects fourteen failure modes for further evaluation three experts e1 e2 and e3 responded to a survey to determine the occupational accidents related to the highest risky failure mode for shipbuilding e1 is an ohs expert while e2 and e3 are shipbuilding engineers they realized various shipbuilding projects for minimum of 10 years so that they have sufficient information and experience about risk assessment fourteen failure modes according to the experts opinions are fm1 working without a work permit fm2 working at height without safety belt fm3 establishing the inappropriate scaffolding fm4 utilization the inappropriate ladders fm5 utilization of crush and scrape cables fm6 irregularity of the paint tank fm7 lack of safety for tilting over of the tubes fm8 lack of warning plates fm9 noise warning device malfunctions for lifting equipment fm10 lack of identification and conformity control of hoists fm11 empty fire extinguishers fm12 open channel doors fm13 lack of nets on ship scaffolds fm14 lack of ventilation fan protection occupational accidents oa in shipbuilding are oa1 falling from height oa2 falling a heavy load on worker oa3 electric shock oa4 heat treatment and explosion 4 1 result and discussion the criteria o and s denote cost criteria and criterion d denotes the benefit criterion in traditional fmea uses rpn method which is the multiplication of the values of risk criteria o s and d it has been criticized to have several drawbacks this paper handled intuitionistic fuzzy numbers to evaluate the rating of each failure mode and weights of o s and d risk factors the weights of e1 e2 and e3 experts can be determined as 0 25 0 40 0 35 respectively experts introduce by using linguistic values the subjective opinions about the importance degrees of o s and d criteria the subjective opinions of the experts are combined to determine the importance degrees of the o s and d criteria this paper aims to provide an approach to define the most important failure mode among potential failure modes in shipbuilding in the literature various multi criteria decision making methods were considered to overcome the drawbacks of fmea there is no study about risk assessment using the qfd based vikor method under intuitionistic fuzzy set qfd approach provides to define the weight of each failure mode based on each criterion o s and d qfd approach includes three parts which are correlation among crs correlation among drs relationship between crs and drs in this study crs and drs mean occupational accidents and failure modes respectively the subjective opinions of experts are collected to achieve the weights of criteria and to assess the failure modes by using the linguistic terms which is shown in table 2 table 3 shows the correlation among drs failure modes for each criterion o s and d table 4 shows the correlation among crs occupational accidents for each criterion o s and d table 5 shows the relationship between crs occupational accidents and drs failure modes for each criterion o s and d ifwa operator is employed to aggregate the opinions of the experts in tables 3 5 this paper presents the weights of crs without correlation according to o s and d criteria as showing in table 6 the weights of crs with correlation according to o s and d criteria are obtained by using data in tables 4 and 6 and the results are illustrated in table 7 the weight of cr2 with correlation for o criterion is calculated by using eqs 2 and 3 and linguistic terms for cr2 of o criterion in tables 4 and 6 as follows 1 1 0 25 0 25 1 0 5 0 4 1 0 25 0 35 0 362 μ 0 65 0 25 0 4 0 4 0 65 0 35 0 535 v 0 362 0 535 0 103 0 5 0 4 0 1 0 181 0 721 0 098 0 5 0 4 0 1 0 181 0 721 0 098 0 591 0 288 0 121 the judgments of three experts in table 3 are aggregated by using ifwa operator the correlation between dr2 and dr3 for o criterion is calculated as follows 1 1 0 75 0 25 1 0 5 0 4 1 0 5 0 35 0 580 μ 0 15 0 25 0 4 0 4 0 4 0 35 0 313 v the judgments of three experts in table 5 are aggregated by using ifwa operator the aggregated relationship between cr2 and dr1 for o criterion is defined as follows 1 1 0 5 0 25 1 0 25 0 4 1 0 5 0 35 0 412 μ 0 4 0 25 0 65 0 4 0 4 0 35 0 486 v the result of qfd approach ensures the weights of drs and is presented in table 8 the weight of dr1 is calculated for an example 0 412 0 176 0 072 0 412 0 072 0 412 0 072 0 455 0 455 0 591 0 268 μ 0 486 0 757 0 486 0 757 0 875 0 486 0 875 0 425 0 425 0 288 0 425 0 288 0 591 v the importance degrees of o s and d according to expert 1 are h h and h respectively the importance degrees of o s and d according to expert 2 are vh h and m respectively the importance degrees of o s and d according to expert 3 are h m and m respectively the importance degrees of o s and d according to three experts are obtained by using ifwa operator the weights of o s and d are 0 8687 0 0967 0 0347 0 6814 0 2114 0 1072 and 0 5796 0 3130 0 1074 respectively the weight of o criterion is presented as an example 1 1 0 75 0 25 1 0 95 0 4 1 0 75 0 35 0 869 μ 0 15 0 25 0 05 0 4 0 15 0 35 0 097 v data in table 8 and the weights of o s and d are used in ifvikor method the ranking of occupational accidents related failure modes in shipbuilding is achieved by using ifvikor method and the results are introduced in table 9 drs in qfd approach are shown as failure modes in table 9 the highest risky failure mode is defined as fm 13 the lack of nets on ship scaffolds according to the proposed method the normalized intuitionistic fuzzy difference d 1 o of o criterion based a1 is introduced as an example 0 869 0 268 0 233 μ 0 097 0 591 0 097 0 591 0 630 v d f o r 1 o 1 2 0 233 0 127 2 0 630 0 756 2 0 136 0 117 2 0 117 d f o f o 1 2 0 690 0 127 2 0 170 0 756 2 0 140 0 117 2 0 575 d 1 o 0 117 0 575 0 204 s r and q values for a1 are calculated below s 1 0 204 0 391 0 847 3 0 481 r 1 max 0 204 0 391 0 847 0 847 q 1 0 5 0 481 0 313 0 671 0 313 0 5 0 847 0 565 1 000 0 565 0 558 various scaffolds are installed to perform many operations in shipbuilding the scaffold is constructed according to the purpose of use the weight to be carried and the operations to be performed on it breaking slippage and slumps occurring in randomly constructed scaffoldings and other structures cause injuries and deaths of employees and their surroundings as a result of the various works such as welding cutting and painting on the scaffolding and the high buildings the workers can fall from the height when employees drop material or hand tools from the height the employees at further down height can suffer from various accidents according to the result of this paper the most important four failure modes in shipbuilding were defined as lack of nets on ship scaffolds 1st rank utilization of the inappropriate ladders 2nd rank and working at height without safety belt 4th rank serious fires occur during maintenance repair and installation of machinery and electrical systems other fire risks are the non conforming electrical equipment in the workshops the expansion of the gas or liquid inside the pressure tubes due to the inappropriate storage conditions and equipping the environment with materials that will cause the fire to spread rapidly during a fire according to the result of this study the other important failure mode in shipbuilding is empty fire extinguishers 3rd rank 4 2 comparison crisp number type 1 fuzzy number interval type 2 fuzzy number and neutrosophic fuzzy number based qfd methods are also examined to show the effectiveness of the proposed approach the results of the other methods are presented in table 10 the results of the proposed approach and crisp number based qfd method are the same except dr5 dr6 and dr10 the results of the proposed approach and type 1 fuzzy number based qfd method are the same except dr5 and dr10 the results of the proposed approach and interval type 2 fuzzy number based qfd method are the same crisp number and type 1 fuzzy number are insufficient to obtain the judgments of experts this causes a loss of information about evaluation the obtained results of crisp and type 1 fuzzy numbers show this situation the level of this loss can be neglected because only three and two drs for crisp number and type 1 fuzzy number based qfd are different from the proposed method respectively the results of the proposed approach and neutrosophic fuzzy number based qfd method are the same it2f numbers use the interval among two membership degrees so it2f numbers provide more information than type 1 fuzzy numbers neutrosophic fuzzy number includes truth falsehood indeterminacy parameters the proposed method uses intuitionistic fuzzy numbers which include the membership degree non membership degree and hesitant degree the experts can present their judgments more accurately and easily by using intuitionistic fuzzy number 4 3 sensitivity analysis the sensitivity analysis is to aim to exchange each decision maker s importance degree with importance degree of another expert 6 different combinations are realized with three decision makers this sensitivity analysis examines the impact of exchanging of each decision maker s importance degree on the ranking of drs the importance degrees of expert 1 expert 2 and expert 3 in the original form of the study are 0 25 0 40 and 0 35 respectively in the sensitivity analysis e231 means that the weights of expert 1 expert 2 and expert 3 are 0 40 0 35 and 0 25 respectively new q values of drs are shown in fig 4 new q values of dr2 and dr7 have some deviations for 6 calculations the biggest deviation is 0 219 for q value of dr2 but the other deviations are very low the deviation of dr13 for q value is zero according to 6 calculations new rankings of drs are shown in fig 5 the biggest deviation for ranking of drs is 4 for dr3 the ranking of dr3 according to e231 and e132 is 5 and 9 respectively the difference between 5 and 9 is 4 the deviations for the rankings of dr10 and dr13 are zero 5 conclusion the presented approach has significant managerial successes for ohs policy according to the results of the paper firstly the study is realized in the fuzzy environment which overcomes the uncertainty of failure modes evaluation information the suggested approach ensures a flexible and suitable model for fmea based risk evaluation because intuitionistic fuzzy numbers provide us to define the hesitation of decision makers about evaluation secondly the weights of the risk criteria o s and d are defined by utilizing the intuitionistic fuzzy number operations this situation provides a more solid evaluation for the final risk ranking of the failure modes thirdly this paper proposed the intuitionistic fuzzy numbers based qfd method to determine the weights of the failure modes for each risk criterion o s and d in more accurately and effectively finally this paper proposes vikor method to rank the occupational accident related failure modes in shipbuilding this study suggests a new approach to risk evaluation literature based on fmea this study purposes to introduce a new method to overcome the limitation of traditional fmea all opinions of experts are collected based on linguistic terms these opinions are transformed to the intuitionistic fuzzy numbers ifwa operator aims to combine the judgments of experts about the weights of o s and d criteria qfd and vikor evaluations intuitionistic fuzzy numbers based qfd approach defines the weights of drs for each criterion o s and d the importance degrees of criteria and the weights of drs for o s and d are combined in intuitionistic fuzzy numbers based vikor approach which ranks the occupational accidents related failure modes in shipbuilding the highest risky failure mode in shipbuilding is defined as the lack of nets on ship scaffolds according to the result of intuitionistic fuzzy numbers based qfd and vikor methods intuitionistic fuzzy numbers based qfd and vikor methods have a big advantage of success for risk evaluation issue because they also examine the hesitation opinions of experts the other advantage of this study is to accomplish the drawbacks of the traditional fmea risk priority number in the traditional failure mode and effect analysis fmea is achieved by multiplying the values of o s and d it has been criticized due to several drawbacks this study handled the linguistic terms instead of crisp terms for the weights of criteria in fmea the decision makers can present their judgments more easily the subjective opinions of the experts are combined to define the importance degrees of these risk factors the presented approach is implemented for risk assessment in shipbuilding by using fmea in future papers the presented method can be utilized to accomplish the hesitation under intuitonistic fuzzy set environment in different applications such as personnel selection software selection and supplier selection acknowledgements the author would like to thank to the editor and anonymous reviewers whose insightful and constructive comments have improved the paper greatly 
22641,the paper proposes certain improvements in the setup of the critical wave groups method which has been introduced in the past for calculating the probability of extreme roll responses moreover a precise mathematical formulation of the critical wave groups concept is presented and the selection of key parameters for its computational setting is discussed the most significant development concerns the hitherto assumption of zero initial conditions of the vessel at the instant of a wave group encounter which is now removed through probabilistic treatment of ship s initial state the improved method is evaluated for its potential to produce accurate estimates in the various regions of roll response distribution including the tail where the efficiency of direct monte carlo simulations is very low in the range of intermediate responses it is demonstrated that the method becomes more effective when employing the expected wave sequences given a sea state instead of regular waveforms for determining critical for ship stability wave episodes lastly two alternative implementations of the critical wave groups concept are assessed one empirical where the distributions of main parameters such as the wave period and height are deduced from simulations of the wave field and one where they are calculated directly from the spectrum graphical abstract comparison of different implementations of the improved critical wave groups cwg method and comparison with direct monte carlo simulations of roll motion mc image 1 keywords wave group probability nonlinear roll dynamics resonance rare events 1 introduction a state of art scientific challenge in stochastic mechanics is the setting up of a method that can accurately determine the statistics of the rare and strongly nonlinear extremes which can appear in the behaviour of certain engineering dynamical systems this particular focus is motivated by the very nature of the extremes which sometimes represent unsafe or even catastrophic events such a priority is embedded also in the modern studies of ship capsize a ship capsize event should be extremely rare or better completely impossible also by its nature as a transition to an unsafe state ship capsize is a dynamic event involving the entire range of stability of a ship and even beyond it the complex character of ship dynamics at large angles is well known it is inherited by the ubiquitous strongly nonlinear character of a ship s roll restoring moment ensuring that an extremely low probability of capsize is built in through design entails capability to involve lucidly the ship design variables and parameters into the calculation of this probability however the very desire of controlling this probability in order to be kept very low creates the need for a theory focused specifically on the rare extremes that could require several system lifetimes to be realised once it becomes apparent that the derivation of reliable estimates of ship capsize statistics using standard tools based on brute force time domain simulation suffers from a number of deficiencies first the accuracy of a direct counting definition of probability becomes questionable when dealing with events rarely realized second due to the possibility of system escape from its safety domain meaning loss of the capability to return towards the upright condition the customary assumption of stationarity quality for ship rolling can hold only in an approximate sense e g roberts and vasta 2000 a category of approaches holding promise to overcome these deficiencies employ the so called principle of separation which can be used in various ways for disassembling the ship response problem into sub problems one possibility is to separate the non rare from the rare part the objective of the former could be to determine the distribution of the initial conditions that can lead to the occurrence of extreme events as for the rare part it can target the conditional probability of extreme events given that specific initial conditions are met the concept of separation has been demonstrated in several studies and different techniques have been developed regarding its implementation for ship stability assessment e g belenky et al 2012 campbell et al 2016 mohamad and sapsis 2016 based on the same principle the critical wave groups method quantifies instability tendency through calculation of the probability of encountering any wave formation that could provoke the examined mode of ship instability now focusing on the rare sub problem another type of separation is applied in order to distinguish the identification of the critical wave encounters from the calculation of their probability of occurrence the first part is essentially deterministic and in general it is easily handled computationally by using a mathematical model of ship motions the second is probabilistic involving however calculations based on the wave field only targeting the probability of encountering critical wave sequences in the original formulation of the method regular wave trains had been employed in the deterministic part in order to identify height thresholds for the critical waveforms themelis and spyrou 2007 then in the probabilistic part the probability of encountering any group exceeding the specified height thresholds was calculated using distributions of wave heights and periods derived from spectral methods recently the critical wave groups method was implemented using irregular wave group excitations anastopoulos and spyrou 2017 these irregular groups were derived as the expected wave group forms per given sea state anastopoulos et al 2016 the idea of assessing ship stability under deterministic multi chromatic wave sequences has also been discussed in malara et al 2014 in their study a method was presented for calculating the maximum roll angle that a vessel would obtain if excited by a wave group with very special shape according to the theory of quasi determinism boccotti 2000 this wave group form is under certain conditions the most probable to be realized in the vicinity of an exceptionally high wave in fact the theory is exact for infinitely high waves despite that it is believed that it is still applicable at more realistic levels then however the main issue is the definition of the quasi deterministic waveform itself since the waveform is expressed in terms of the autocorrelation function of the wave elevation process it naturally exhibits a very specific structure that is impossible to be modified in practical applications though having the flexibility to control the characteristics i e heights and periods of individual waves of a wave group is very desirable particularly when studying instability modes due to resonant behavior this was our motivation for generating a class of very probable wave groups covering a range of possible shapes for a given sea state anastopoulos et al 2016 interestingly the highest wave group of this class has been shown to agree with the predictions of the quasi determinism theory in the present paper we investigate how the assumption of zero initial conditions i e ϕ 0 0 and ϕ 0 0 of the vessel at the instant of a group encounter adopted in anastopoulos and spyrou 2017 affects the probability value for a moderate sea state where capsize can still be considered as a rare event at the same time our effort towards improving the deterministic part of the critical wave groups method is continued by modifying the method developed by anastopoulos et al 2016 in order to construct the expected wave groups of a sea state given that their periods vary within a specified range therefore we propose a new formulation of the critical wave groups calculation scheme and its performance for predicting extreme roll motions in beam seas is tested against the earlier one of themelis and spyrou 2007 to validate the calculation procedure followed in the probabilistic part distributions of heights and periods are derived directly from simulations of the wave field and the results are compared with those obtained when the same distributions are approximated by established models having some background on the theoretical wave envelope process spectral methods lastly and more importantly we demonstrate that the method can effectively produce response statistics in the tail region where the accuracy of monte carlo simulations is weak 2 the critical wave groups method in the field of ocean and coastal engineering wave groups are traditionally considered as sequences of waves with heights exceeding a certain preset level and slightly varying periods masson and chandler 1993 ochi 1998 despite that several threshold based definitions have been utilized in the past for quantifying wave groupiness one would argue that from a ship dynamic stability perspective critical wave groups are sequences of waves which are sufficiently high for provoking instability 2 1 mathematical formulation let us assume that we are interested in estimating the probability that a vessel exceeds a roll angle threshold ϕ c r i t the key idea of the critical wave groups method is to first identify the wave events that cause the exceedance and then calculate the probability of encountering them the mathematical formulation of the method is presented below yet the equations have been slightly modified compared to our earlier work anastopoulos and spyrou 2017 to illustrate more clearly the essence of the approach 1 p ϕ ϕ c r i t k p ϕ ϕ c r i t q w g k q i c k 1 p q w g k q i c k where w g k q is a wave group event with characteristics q which would lead to ϕ ϕ c r i t if the ship was at the k t h initial state i c k ϕ 0 ϕ 0 at the moment of the encounter therefore the problem reduces to the estimation of the second term in eq 1 2 p q w g k q i c k p q w g k q i c k p i c k a significant challenge in eq 2 is to ensure that wave groups that provoke exceedance of ϕ c r i t form a set of mutually exclusive and collectively exhaustive events to avoid possible overlaps in the calculations it is convenient to classify wave groups with respect to characteristic groupiness measures such as the run length j which is the number of consecutive heights exceeding a critical threshold and the range of variability of the wave period groupings m 3 p q w g k q i c k m p j w g m j k in the above w g m j k is an instability causing wave group composed by j waves with periods varying within the m t h range determined for the k t h set of initial conditions i c k ϕ 0 ϕ 0 of the vessel at the moment of the group encounter the summation implies that ranges of period variability are selected in a non intersecting sense for sufficiently large roll angle thresholds we assume that dangerous wave group occurrences w g m j k are rare events and thus statistically independent from each other this enables us to rewrite the union of instability causing wave groups with different run lengths j in eq 3 using the following transformation rule known as de morgan s law e g papoulis and pillai 2002 4 p j w g m j k 1 p j w g m j k 1 p j w g m j k 1 j 1 p w g m j k where the overbar denotes the complement of an event eventually the calculation of the last probability in eq 4 is decomposed in two parts a purely deterministic one focused on the identification of the critical wave groups i e those wave successions leading to infinitesimal exceedance of ϕ c r i t and a probabilistic part for calculating the probability of encountering any wave group featuring heights of participating waves larger than the corresponding heights of the determined critical wave group 5 p w g m j k p h j h c r j k t j t c r m h j h 1 h j and t j t 1 t j are vectors of random variables referring respectively to the heights h n and periods t n of a wave group event with run length j 1 n j h c r j h c r 1 h c r j is a deterministic vector containing the heights of a critical wave group with run length j and t c r m is the m t h range m 1 2 m within which the critical periods t c r j t c r 1 t c r j are considered to vary in this way for a given run length j critical height thresholds are determined for each of the t c r m segments which have been used to discretize the whole range of periods that could be met in a real sea themelis and spyrou 2007 the width of the period segments δ t is a key parameter which controls the probability of a critical wave group encounter and should reflect the extent up to which period variations are truly responsible for the occurrence of instabilities from eq 5 it becomes evident that the accuracy of the critical wave groups method depends explicitly on the shape of the critical wave groups which are in fact height thresholds for the wave events that result in ϕ ϕ c r i t 2 2 construction of realistic wave groups modelling of wave successions as markov chains has been one of the most successful approaches in wave group theory kimura 1980 was the first to elaborate on wave group statistics assuming that wave heights and related periods are markov processes ever since the concept has been tested several times against numerical simulations and real wave field measurements with remarkable success e g stansell et al 2002 anastopoulos et al 2016 improved the markovian model of kimura 1980 to develop a method for the systematic construction of irregular wave group profiles characterized by high probability of occurrence later it became apparent that the construction algorithm needed to be modified since the produced waveforms had periods varying only in the vicinity of the mean period of the assumed sea state anastopoulos and spyrou 2017 thus here we have revised the method of anastopoulos et al 2016 to determine critical wave events in terms of the expected wave groups with periods varying in a defined range t c r m given some sea state again the height h c and the period t c of the highest wave of the group are utilized in order to initiate the following iterative scheme 6 t n 1 p t n t c r m t n f t n h n 1 t n 1 t n h n 1 t n 1 d t n where 7 p t n t c r m f t n h n 1 t n 1 t n h n 1 t n 1 d t n 8 h n 0 h n f h n t n h n 1 t n 1 h n t n h n 1 t n 1 d h n now consider that we are interested in generating a sequence of j wave group heights with related periods in a range of interest t c r m assuming that h c and t c occupy the n t h position in the sequence 1 n j forward application of eqs 6 8 will provide the heights and periods of the waves succeeding the initial highest one the most expected past outcomes are identified by applying the same procedure backwards in time the calculation of the conditional expectation in eq 6 precedes that of eq 8 so as to take into account the correlation between the height and the period of a predicted wave the kernels of the integrals are the transition probability density functions pdfs of the markovian process and details regarding their derivation are given in anastopoulos et al 2016 the final step is to construct the continuous time counterpart of a generated sequence to this end we opt for a representation of water surface elevation η of the form 9 η x t i 0 5 j a i f i x t then the objective is to determine the coefficients a i so that eq 9 satisfies a set of geometrical constraints which ensure that the shape of the produced waveform is compatible with the predictions of eqs 6 and 8 the number of terms kept in eq 9 naturally depends on the run length j and it is selected so that the uniqueness of the solution is guaranteed in our earlier studies the f i basis functions of the expansion had been modelled by wavelets and they were derived from the application of the karhunen loève theorem sclavounos 2012 here aiming to reduce the computational cost due to the solution of the karhunen loève eigen problem we employ fourier basis functions i e trigonometric functions another advantage of this approach is that closed forms for the a i parameters are readily available from the existing literature e g nathan 1975 it should be noted however that the truncation order in eq 9 is lower than the originally recommended 6 j since it was recently observed that desired waveforms could be generated even if the constraints for the time instants of zero down crossings were removed more details on this part of the construction process can be found e g in anastopoulos and spyrou 2016 2 3 equation of roll motion to determine a set of critical wave groups time domain simulations are performed using the following simple uncoupled equation written in terms of the relative roll angle ϕ 10 i 44 a 44 ϕ d ϕ g δ g z ϕ m t with i 44 and a 44 being the roll moment of inertia and the added moment of inertia respectively δ is the ship displacement g is the gravitational acceleration and d is the damping moment 11 d ϕ b 1 ϕ b 2 ϕ ϕ the restoring arm in still water is given as 12 g z ϕ c 1 ϕ c 3 ϕ 3 the energy spectrum of the wave induced moment is estimated from the water surface elevation spectrum s η η using the roll moment amplitude operator f r o l l 13 s m m ω f r o l l ω 2 s η η ω dividing eq 10 by i 44 a 44 we finally obtain 14 ϕ b 1 ϕ b 2 ϕ ϕ c 1 ϕ c 3 ϕ 3 m t 2 4 solution to the rare sub problem the probability of encountering dangerous wave groups with certain specifications as in eq 5 is calculated by once again employing the concept of markov chains according to the following procedure 15 p h j h c r j t j t c r m p 0 n 2 j p 1 n p 2 n p 01 n 1 p 02 n 1 where in the left hand side of eq 15 the k superscript has been dropped to simplify notation and 16 p 1 n t c r m f t n t n 1 h n t n t n 1 h n h c r n d t n d t n 1 17 p 2 n h c r n h c r n 1 f h n h n 1 h n h n 1 d h n d h n 1 18 p 0 p 01 1 p 02 1 the probabilities appearing in the denominator of the product operator in eq 15 are obtained using the marginal pdfs of the bivariate models defined in eqs 16 and 17 respectively in the context of spectral methods tayfun 1993 observed that a bivariate gaussian distribution is a good approximation for the pdf of successive wave periods appearing in eq 16 given the associated heights h n h n h n 1 exceed a certain level h c r n h c r n h c r n 1 for the distribution of two consecutive wave heights f h n h n 1 in eq 17 kimura 1980 proposed the bivariate rayleigh distribution 2 5 solution to the non rare sub problem attempts to validate the critical wave groups method have been based mostly on the assumption that the ship has zero initial conditions ϕ 0 ϕ 0 0 0 when approached by a wave group e g anastopoulos and spyrou 2017 shigunov et al 2019 although this can somehow be acceptable from a ship roll dynamics perspective rainey and thompson 1991 the matter needs to be thoroughly investigated however the idea of treating probabilistically the initial conditions via the computation of the second term in eq 2 had already been demonstrated in themelis and spyrou 2008 in their study the joint pdf of initial conditions had been modelled by a gaussian distribution and by further assuming that the roll angle and velocity are independent random variables in the following section the distribution of initial conditions is estimated directly from monte carlo simulations of roll motion using eq 14 to evaluate the assumptions of gaussianity and independence the obtained empirical distribution is compared with a bivariate gaussian distribution that is fitted to the generated data 3 results and discussion below the critical wave groups method is applied to a small ocean surveillance ship with main parameters listed in table 1 to calculate the probability of exceedance for a number of roll angle thresholds ϕ c r i t the concept of separation as expressed through eq 2 is illustrated in fig 1 where the gz curve of the vessel is divided in two sub regions representing the rare and non rare sub problems the boundary of the sub regions is indicated by a vertical line and justification for its location will be provided later in this section for comparison reasons our method is implemented using first regular and then irregular wave group excitations in both cases the results are tested against monte carlo simulations of roll motion to assess the performance of the approach when spectral methods are employed desired distributions in eqs 16 and 17 are also estimated using simulations of the wave field anastopoulos and spyrou 2017 3 1 monte carlo simulations the ship is assumed to operate in a sea state described by the modified pierson moskowitz spectrum with significant wave height h s 3 m and peak period t p 11 s 19 s η η ω 5 058 g 2 h s 2 ω 5 t p 4 exp 5 4 ω p ω 4 were ω p is the peak frequency the wave induced moment was modelled using eq 13 and information for the roll moment amplitude operator f r o l l of the vessel was found in su 2012 for the simulation of a stationary and ergodic gaussian wave field the following model was adopted st denis and pierson 1953 20 η t n 2 s η η ω n d ω cos ω n t ε n where ε n are random variables uniformly distributed over 0 2π ω n are the frequencies of the wave components and d ω is the frequency resolution in total 175132 waves were analyzed from a set of 16 records of 24 h statistics of roll motion were collected without assuming the ergodic property for the roll response for a discussion on the ergodicity problem see belenky et al 1998 as a corollary the analysis was made on an ensemble of 3 10 6 short duration realizations sampled at a fixed time instant t s 150 s there are several aspects concerning the selection of the t s value that are worth deeper discussion particularly because they are related to the general problem of setting up monte carlo experiments in a mathematically consistent and at the same time efficient way first generated time series should be long enough to ensure that the effect of ship s state at t 0 s will have faded before reaching t s in such case the very same set of ϕ 0 ϕ 0 values can be utilized for initiating all simulations e g here zero initial conditions were assumed moreover ensemble averages may need several cycles depending on the system to converge to their true values in this regard one could perform a small number of preliminary runs to detect the transient part in the time evolution of the targeted response statistics and then select t s accordingly in fig 2 the results of our investigation are presented as shown after 75s the ensemble mean and variance of the roll process are practically time invariant while similar behavior was noticed also for the 3rd and 4th order statistical moments not included here for brevity reasons from the same figure it is evident that the autocorrelation functions here normalized by the variance of the angle and velocity processes oscillate very close to zero in light of the above t s could have been set exactly at 75s to minimize the computational cost of the procedure however here time histories being essentially twice as long as the transient part 0s 75s were intentionally produced to demonstrate the validity of our eventual t s 150 s choice more clearly in fig 3 the joint pdf of roll angle and velocity as obtained from the monte carlo simulations is compared with a bivariate gaussian distribution that was fitted to the generated data the standard deviation of roll angle was σ 1 6 4 while for the velocity it was σ 2 6 3 s the correlation between these two random variables was estimated using pierson s parameter and was found zero although this does not necessarily imply statistical independence one could argue that in a first approximation it is sufficient to consider the joint distribution of roll angle and velocity as the product of the respective marginal distributions themelis and spyrou 2008 it is should be noted that in fig 3 comparisons are limited in the region of high probability levels just because in the critical wave groups framework the gaussian model is used only for computing the second term in eq 2 considering that any state of the system ϕ ϕ can be regarded as the time evolution of an initial state ϕ 0 ϕ 0 this calculation requires in fact knowledge of the distribution of non rare roll responses in our current setup the non rare sub problem corresponds to regimes where ship response is approximately linear while no assumption is needed to be made on the shape of the distribution associated with the nonlinear rare part therefore the intention of fig 3 is to verify our calculation scheme i e that according to the way we set up the problem fig 1 statistics of initial conditions below 16 truly have the expected gaussian character finally it is worth mentioning that the parameters of the fitted distribution could have been estimated with fair accuracy using a much smaller number of simulations or even without performing any simulations at all since it is straightforward to approximate non rare response statistics theoretically by elaborating on only the linear part of eq 14 3 2 regular wave groups in principle wave groupiness is a phenomenon related to multi chromatic seas essentially because wave group generation is based on local focusing of individual wave components in eq 20 at some point the term regular wave group is used here to express the idea of themelis and spyrou 2007 to employ monochromatic harmonic wave trains for identifying critical height thresholds in eq 5 in this respect regular wave groups should be considered only as sequences of waves with equal heights and periods as shown in fig 4 this artificial feature though is expected to affect the accuracy of the critical wave groups method the magnitude of this effect is investigated in the following in this context we present the results obtained when regular wave groups with j j max 5 are utilized and for two cases of critical period range widths δ t 1 s fig 5 and δ t 2 s fig 6 critical wave groups were determined for 81 cases of initial conditions of the vessel spanning the domains 16 16 and 16 s 16 s with a fixed step the probability of exceedance p e was calculated for 8 different roll angle thresholds from 20 up to 55 with a step of 5 the thresholds are implied as possible capsize limits given that eq 14 is a very simple roll model and it does not contain design information about deck submergence downflooding angles etc in this regard produced estimates are considered to be referring to a parameterized capsize limit in figs 5 and 6 diamonds indicate that critical wave groups were determined only for zero initial conditions ϕ 0 ϕ 0 and probabilistic calculations were carried out using wave distributions derived from simulations of the wave field circles and dots refer to the synthesized solutions of the non rare and rare sub problems when distributions of heights and periods in eqs 16 and 17 are estimated from simulations cwg sim and spectral methods cwg spe respectively the results of monte carlo simulations mc are overlaid on the same plots solid lines the selection of an appropriate grid of initial conditions is a matter of importance for the implementation of the method as discussed earlier the grid should be located in the linear regime due to the type of separation that is tried here indeed fig 3 shows that for the examined sea conditions ship response exhibits an almost gaussian behaviour in the considered domain 16 16 16 s 16 s consequently with the boundary of rarity nonlinearity being at 16 fig 1 it is rather natural to produce the first estimate of the rare solution with respect to a somewhat higher roll angle threshold e g 20 at the same time though critical wave groups determined for initial conditions within this domain should be statistically independent as required by eq 4 to detect the limits of application one could exploit the issue of rarity defining the point where the mc curve stops due to lack of data e g 30 in figs 5 and 6 based on the above the performance of the current calculation scheme can be tested against the results of the monte carlo simulations in the range 20 30 definitely estimating the probability of exceeding very low roll levels goes beyond the scope of eq 4 given that the method targets the identification of critical wave groups that are sufficiently rare for this reason and since roll dynamics below 16 are essentially linear fig 1 our method utilizes a gaussian distribution with zero mean and standard deviation σ 1 6 4 as computed for fig 3 however in figs 5 and 6 the gaussian model is not included because it was observed that it is almost identical with the derived mc curve in the entire range 0 30 this is attributed to the rarity of extreme events meaning that for the specific sea state nonlinearity is not visible in the statistics because the dynamical system spends most of the time close to the stable equilibrium which contributes the main probability mass of the response pdf see also belenky et al 2016 as illustrated in figs 5 and 6 the synthesized solution of the method cwg sim and cwg spe extends the estimates of the monte carlo simulations up to the region of extreme responses the predictions for the below 30 region are an order of magnitude greater than those of the simulations and thus we would assume that the method generally overestimates the probability of exceedance when regular wave groups are utilized moreover it should be noted that the problem of rarity is not completely solved in the case of cwg sim because the pdfs in eqs 16 and 17 were empirically estimated from limited data the amount of generated data becomes even smaller for exceptionally high waves and thus sample estimates naturally fail to converge to the true population values this justifies why cwg sim predicts lower probability levels than the cwg spe scheme in the tail region hence the deviation of the cwg spe and the cwg sim curves of figs 5 and 6 for roll angles above 35 can lead to the conclusion that the spectral method is more effective another advantage of the cwg spe approach is that the pdfs in eqs 16 and 17 exist in closed forms which makes them more attractive for practical applications finally from figs 5 and 6 it is obvious that the simplified approach cwg 0 using only zero initial conditions consistently underestimates the probability of exceedance this fact along with the sensitivity of the results to the selection of δ t were reported also in our previous study anastopoulos and spyrou 2017 where the same ship model was studied yet for a different sea state it is interesting to note however that the effect of δ t becomes weaker when more initial conditions ϕ 0 ϕ 0 are taken into account for properly tuning the δ t parameter we shall refer to the work of boccotti 2000 according to data collected from real wave field measurements period variations tend to asymptotically vanish in the limit of infinitely high waves additional evidence could be produced from the wave data that were generated for the purposes of the present study assuming a number of possible height thresholds for the definition of wave groups more specifically wave successions with heights above a pre selected level were extracted from each of the 16 records and statistics for δ t were calculated considering that δ t t max t min with t max being the maximum and t min the minimum period observed within each of these wave groups in fig 7 we have plotted the variation of the mean dots and standard deviation circles of δ t as a function of the utilized height threshold the results verify boccotti s 2000 argument that for increasing heights δ t 0 in the critical wave groups framework δ t essentially determines the difference between the upper and lower limit of integration in eq 16 therefore allowing for more variability in the periods of dangerous wave episodes δ t 2 s when ship instability is triggered by very steep waves artificially increases the deduced probabilities p e considering also that in the case of resonance we are not certain if critical wave groups with δ t 2 s would still provoke exceedance of a large ϕ c r i t we conclude that δ t 1 s could be more consistent for the implementation of the proposed method 3 3 irregular wave groups in figs 8 and 9 the results of the critical wave groups method with irregular wave groups are displayed using the same parameters as before j max 5 δ t 1 s and δ t 2 s the notation is the same as in figs 5 and 6 for this application critical wave groups were identified so that exceedance of a roll angle threshold was always recorded during the encounter of the highest wave in this way waves succeeding the highest one were excluded from the probability calculations and the occurrence of instabilities was explicitly related to the characteristics of the highest wave which uniquely defines the structure of a realistic wave group anastopoulos et al 2016 regarding the construction of irregular wave group shapes the transition probabilities in eqs 6 8 were calculated according to the method described in anastopoulos et al 2016 with the only difference that the necessary correlation parameters were estimated from the generated wave data in this way the efficiency of the markov model for determining the expected wave height and period sequences is enhanced from figs 8 and 9 we see that for moderate roll angle thresholds the results of the new approach are almost identical with the monte carlo estimates in the tail region the predictions extend smoothly from the non rare part for both the examined values of the δ t parameter the success of the approach is possibly due to the wave groups construction method which naturally avoids producing wave groups with unusual specifications because they are very unlikely to be encountered with this feature not being present in the case of regular waveforms abnormally high wave trains may be utilized for a given period since their probability of occurrence is really low they affect mostly the tail of the response distribution again the rarity of extreme events is more effectively treated when spectral methods are employed and it is confirmed that treating the initial conditions in a probabilistic context is an essential part of the current methodology although detecting critical wave groups for many initial conditions is more computationally intensive the time needed for the 81 scenarios considered here is still less than an hour on a modern laptop moreover probabilistic calculations take only few minutes since they involve a moderate number of pdf integrations that are performed numerically the main computational burden in the overall critical wave groups procedure comes at the moment at least from the derivation of these irregular wave group forms it is indicative that for the examined sea conditions the construction of wave trains with parameters h c t c and j in the entire domain of interest requires a few hours on a modern desktop however this work has to be done only once per sea state given that wave group data could be stored in a database for future applications the idea of using fewer cases of initial conditions with acceptable accuracy will be investigated in the future while distributing the computations to many processors or even parallelizing them more efficiently e g in a graphics processing unit gpu seem also promising directions finally the rate of convergence of the critical wave groups estimates to a satisfactory precision level can be utilized for further reducing the computational cost of the method from eq 4 we realize that the maximum run length j max involved in the calculations should control the precision of the predictions regardless of the shape of the excitation regular irregular in general it is anticipated that the larger the j max the higher the precision in fig 10 we evaluate the impact of j max on the probability of exceedance p e related to ϕ c r i t 40 and ϕ c r i t 50 in fact the results were produced using wave distributions derived from spectral methods cwg spe and correspond to δ t 1 s upper panel and δ t 2 s lower panel interestingly p e converges after j max 3 for both the examined roll angle thresholds ϕ c r i t when irregular wave groups are considered circles while for regular wave groups it monotonically decreases dots consequently determining critical ship responses in terms of realistic wave groups improves also the efficiency of the critical wave groups concept since one would obtain precise results even by examining fewer wave scenarios e g for ϕ c r i t 50 we could have set j max 3 4 conclusions in this study an improved critical wave groups calculation scheme was developed further and it was applied for estimating the probability of large amplitude roll motions in beam seas the method separates ship roll response into sub regions with distinct dynamics which are studied individually extreme ship motions were analysed under the influence of realistic wave group excitations and critical for ship stability wave events were determined for a number of initial conditions of the vessel the tail of the response distribution was obtained by calculating the probability of encountering such events conditioning on the initial conditions at the moment of the encounter to complete the solution the distribution of initial conditions assumed concerning mainly the linear region of the gz curve was approximated by a gaussian model that was fitted to a set of data derived from a limited number of time domain simulations comparisons with pertinent monte carlo simulations of roll motion demonstrate the good potential of the approach in terms of efficiency and accuracy regarding the shape of design wave groups it is revealed that considering only the most expected representatives of a given sea state may be adequate for producing reliable results since they extend smoothly the monte carlo based predictions as for the ship capsize problem the big strength of the critical wave groups approach is that it can target the probability of this event separately without having to first determine the underlying distribution law of the response process provided that rolling beyond some critical realistic roll angle is most likely to provoke flooding due to immersed opening having a method that can directly target and effectively calculate the probability of particular threshold exceedances is very desirable in fact dealing with only one threshold essentially related to stability failure would also reduce the required computational time it is noted that the times reported earlier corresponded to 8 different roll angle thresholds i e they referred to a wider scope of study than the one required for a specific ship testing the performance of the proposed critical wave groups scheme more extensively is in our future plans however before taking this important step several elements needed to be examined such as the appropriate shape of the critical wave groups and their probabilistic description the importance and the method of considering the initial state of the vessel at the moment of the group encounter in a probabilistic context and the selection of various parameters affecting the implementation e g δ t and j max these were the true focal points of the paper and we are pleased that certain milestones were reached in this respect it should be finally remarked that the sea state considered in this paper is a kind of limiting one for the vessel in the sense that at 4 m significant wave height frequent escapes were found hence beyond the 3 m significant wave height critical wave groups may not be realized so rarely and this fact should be efficiently accounted by the computational scheme acknowledgements the work of panayiotis a anastopoulos has been supported by ntua s special account for research grants elke 
22641,the paper proposes certain improvements in the setup of the critical wave groups method which has been introduced in the past for calculating the probability of extreme roll responses moreover a precise mathematical formulation of the critical wave groups concept is presented and the selection of key parameters for its computational setting is discussed the most significant development concerns the hitherto assumption of zero initial conditions of the vessel at the instant of a wave group encounter which is now removed through probabilistic treatment of ship s initial state the improved method is evaluated for its potential to produce accurate estimates in the various regions of roll response distribution including the tail where the efficiency of direct monte carlo simulations is very low in the range of intermediate responses it is demonstrated that the method becomes more effective when employing the expected wave sequences given a sea state instead of regular waveforms for determining critical for ship stability wave episodes lastly two alternative implementations of the critical wave groups concept are assessed one empirical where the distributions of main parameters such as the wave period and height are deduced from simulations of the wave field and one where they are calculated directly from the spectrum graphical abstract comparison of different implementations of the improved critical wave groups cwg method and comparison with direct monte carlo simulations of roll motion mc image 1 keywords wave group probability nonlinear roll dynamics resonance rare events 1 introduction a state of art scientific challenge in stochastic mechanics is the setting up of a method that can accurately determine the statistics of the rare and strongly nonlinear extremes which can appear in the behaviour of certain engineering dynamical systems this particular focus is motivated by the very nature of the extremes which sometimes represent unsafe or even catastrophic events such a priority is embedded also in the modern studies of ship capsize a ship capsize event should be extremely rare or better completely impossible also by its nature as a transition to an unsafe state ship capsize is a dynamic event involving the entire range of stability of a ship and even beyond it the complex character of ship dynamics at large angles is well known it is inherited by the ubiquitous strongly nonlinear character of a ship s roll restoring moment ensuring that an extremely low probability of capsize is built in through design entails capability to involve lucidly the ship design variables and parameters into the calculation of this probability however the very desire of controlling this probability in order to be kept very low creates the need for a theory focused specifically on the rare extremes that could require several system lifetimes to be realised once it becomes apparent that the derivation of reliable estimates of ship capsize statistics using standard tools based on brute force time domain simulation suffers from a number of deficiencies first the accuracy of a direct counting definition of probability becomes questionable when dealing with events rarely realized second due to the possibility of system escape from its safety domain meaning loss of the capability to return towards the upright condition the customary assumption of stationarity quality for ship rolling can hold only in an approximate sense e g roberts and vasta 2000 a category of approaches holding promise to overcome these deficiencies employ the so called principle of separation which can be used in various ways for disassembling the ship response problem into sub problems one possibility is to separate the non rare from the rare part the objective of the former could be to determine the distribution of the initial conditions that can lead to the occurrence of extreme events as for the rare part it can target the conditional probability of extreme events given that specific initial conditions are met the concept of separation has been demonstrated in several studies and different techniques have been developed regarding its implementation for ship stability assessment e g belenky et al 2012 campbell et al 2016 mohamad and sapsis 2016 based on the same principle the critical wave groups method quantifies instability tendency through calculation of the probability of encountering any wave formation that could provoke the examined mode of ship instability now focusing on the rare sub problem another type of separation is applied in order to distinguish the identification of the critical wave encounters from the calculation of their probability of occurrence the first part is essentially deterministic and in general it is easily handled computationally by using a mathematical model of ship motions the second is probabilistic involving however calculations based on the wave field only targeting the probability of encountering critical wave sequences in the original formulation of the method regular wave trains had been employed in the deterministic part in order to identify height thresholds for the critical waveforms themelis and spyrou 2007 then in the probabilistic part the probability of encountering any group exceeding the specified height thresholds was calculated using distributions of wave heights and periods derived from spectral methods recently the critical wave groups method was implemented using irregular wave group excitations anastopoulos and spyrou 2017 these irregular groups were derived as the expected wave group forms per given sea state anastopoulos et al 2016 the idea of assessing ship stability under deterministic multi chromatic wave sequences has also been discussed in malara et al 2014 in their study a method was presented for calculating the maximum roll angle that a vessel would obtain if excited by a wave group with very special shape according to the theory of quasi determinism boccotti 2000 this wave group form is under certain conditions the most probable to be realized in the vicinity of an exceptionally high wave in fact the theory is exact for infinitely high waves despite that it is believed that it is still applicable at more realistic levels then however the main issue is the definition of the quasi deterministic waveform itself since the waveform is expressed in terms of the autocorrelation function of the wave elevation process it naturally exhibits a very specific structure that is impossible to be modified in practical applications though having the flexibility to control the characteristics i e heights and periods of individual waves of a wave group is very desirable particularly when studying instability modes due to resonant behavior this was our motivation for generating a class of very probable wave groups covering a range of possible shapes for a given sea state anastopoulos et al 2016 interestingly the highest wave group of this class has been shown to agree with the predictions of the quasi determinism theory in the present paper we investigate how the assumption of zero initial conditions i e ϕ 0 0 and ϕ 0 0 of the vessel at the instant of a group encounter adopted in anastopoulos and spyrou 2017 affects the probability value for a moderate sea state where capsize can still be considered as a rare event at the same time our effort towards improving the deterministic part of the critical wave groups method is continued by modifying the method developed by anastopoulos et al 2016 in order to construct the expected wave groups of a sea state given that their periods vary within a specified range therefore we propose a new formulation of the critical wave groups calculation scheme and its performance for predicting extreme roll motions in beam seas is tested against the earlier one of themelis and spyrou 2007 to validate the calculation procedure followed in the probabilistic part distributions of heights and periods are derived directly from simulations of the wave field and the results are compared with those obtained when the same distributions are approximated by established models having some background on the theoretical wave envelope process spectral methods lastly and more importantly we demonstrate that the method can effectively produce response statistics in the tail region where the accuracy of monte carlo simulations is weak 2 the critical wave groups method in the field of ocean and coastal engineering wave groups are traditionally considered as sequences of waves with heights exceeding a certain preset level and slightly varying periods masson and chandler 1993 ochi 1998 despite that several threshold based definitions have been utilized in the past for quantifying wave groupiness one would argue that from a ship dynamic stability perspective critical wave groups are sequences of waves which are sufficiently high for provoking instability 2 1 mathematical formulation let us assume that we are interested in estimating the probability that a vessel exceeds a roll angle threshold ϕ c r i t the key idea of the critical wave groups method is to first identify the wave events that cause the exceedance and then calculate the probability of encountering them the mathematical formulation of the method is presented below yet the equations have been slightly modified compared to our earlier work anastopoulos and spyrou 2017 to illustrate more clearly the essence of the approach 1 p ϕ ϕ c r i t k p ϕ ϕ c r i t q w g k q i c k 1 p q w g k q i c k where w g k q is a wave group event with characteristics q which would lead to ϕ ϕ c r i t if the ship was at the k t h initial state i c k ϕ 0 ϕ 0 at the moment of the encounter therefore the problem reduces to the estimation of the second term in eq 1 2 p q w g k q i c k p q w g k q i c k p i c k a significant challenge in eq 2 is to ensure that wave groups that provoke exceedance of ϕ c r i t form a set of mutually exclusive and collectively exhaustive events to avoid possible overlaps in the calculations it is convenient to classify wave groups with respect to characteristic groupiness measures such as the run length j which is the number of consecutive heights exceeding a critical threshold and the range of variability of the wave period groupings m 3 p q w g k q i c k m p j w g m j k in the above w g m j k is an instability causing wave group composed by j waves with periods varying within the m t h range determined for the k t h set of initial conditions i c k ϕ 0 ϕ 0 of the vessel at the moment of the group encounter the summation implies that ranges of period variability are selected in a non intersecting sense for sufficiently large roll angle thresholds we assume that dangerous wave group occurrences w g m j k are rare events and thus statistically independent from each other this enables us to rewrite the union of instability causing wave groups with different run lengths j in eq 3 using the following transformation rule known as de morgan s law e g papoulis and pillai 2002 4 p j w g m j k 1 p j w g m j k 1 p j w g m j k 1 j 1 p w g m j k where the overbar denotes the complement of an event eventually the calculation of the last probability in eq 4 is decomposed in two parts a purely deterministic one focused on the identification of the critical wave groups i e those wave successions leading to infinitesimal exceedance of ϕ c r i t and a probabilistic part for calculating the probability of encountering any wave group featuring heights of participating waves larger than the corresponding heights of the determined critical wave group 5 p w g m j k p h j h c r j k t j t c r m h j h 1 h j and t j t 1 t j are vectors of random variables referring respectively to the heights h n and periods t n of a wave group event with run length j 1 n j h c r j h c r 1 h c r j is a deterministic vector containing the heights of a critical wave group with run length j and t c r m is the m t h range m 1 2 m within which the critical periods t c r j t c r 1 t c r j are considered to vary in this way for a given run length j critical height thresholds are determined for each of the t c r m segments which have been used to discretize the whole range of periods that could be met in a real sea themelis and spyrou 2007 the width of the period segments δ t is a key parameter which controls the probability of a critical wave group encounter and should reflect the extent up to which period variations are truly responsible for the occurrence of instabilities from eq 5 it becomes evident that the accuracy of the critical wave groups method depends explicitly on the shape of the critical wave groups which are in fact height thresholds for the wave events that result in ϕ ϕ c r i t 2 2 construction of realistic wave groups modelling of wave successions as markov chains has been one of the most successful approaches in wave group theory kimura 1980 was the first to elaborate on wave group statistics assuming that wave heights and related periods are markov processes ever since the concept has been tested several times against numerical simulations and real wave field measurements with remarkable success e g stansell et al 2002 anastopoulos et al 2016 improved the markovian model of kimura 1980 to develop a method for the systematic construction of irregular wave group profiles characterized by high probability of occurrence later it became apparent that the construction algorithm needed to be modified since the produced waveforms had periods varying only in the vicinity of the mean period of the assumed sea state anastopoulos and spyrou 2017 thus here we have revised the method of anastopoulos et al 2016 to determine critical wave events in terms of the expected wave groups with periods varying in a defined range t c r m given some sea state again the height h c and the period t c of the highest wave of the group are utilized in order to initiate the following iterative scheme 6 t n 1 p t n t c r m t n f t n h n 1 t n 1 t n h n 1 t n 1 d t n where 7 p t n t c r m f t n h n 1 t n 1 t n h n 1 t n 1 d t n 8 h n 0 h n f h n t n h n 1 t n 1 h n t n h n 1 t n 1 d h n now consider that we are interested in generating a sequence of j wave group heights with related periods in a range of interest t c r m assuming that h c and t c occupy the n t h position in the sequence 1 n j forward application of eqs 6 8 will provide the heights and periods of the waves succeeding the initial highest one the most expected past outcomes are identified by applying the same procedure backwards in time the calculation of the conditional expectation in eq 6 precedes that of eq 8 so as to take into account the correlation between the height and the period of a predicted wave the kernels of the integrals are the transition probability density functions pdfs of the markovian process and details regarding their derivation are given in anastopoulos et al 2016 the final step is to construct the continuous time counterpart of a generated sequence to this end we opt for a representation of water surface elevation η of the form 9 η x t i 0 5 j a i f i x t then the objective is to determine the coefficients a i so that eq 9 satisfies a set of geometrical constraints which ensure that the shape of the produced waveform is compatible with the predictions of eqs 6 and 8 the number of terms kept in eq 9 naturally depends on the run length j and it is selected so that the uniqueness of the solution is guaranteed in our earlier studies the f i basis functions of the expansion had been modelled by wavelets and they were derived from the application of the karhunen loève theorem sclavounos 2012 here aiming to reduce the computational cost due to the solution of the karhunen loève eigen problem we employ fourier basis functions i e trigonometric functions another advantage of this approach is that closed forms for the a i parameters are readily available from the existing literature e g nathan 1975 it should be noted however that the truncation order in eq 9 is lower than the originally recommended 6 j since it was recently observed that desired waveforms could be generated even if the constraints for the time instants of zero down crossings were removed more details on this part of the construction process can be found e g in anastopoulos and spyrou 2016 2 3 equation of roll motion to determine a set of critical wave groups time domain simulations are performed using the following simple uncoupled equation written in terms of the relative roll angle ϕ 10 i 44 a 44 ϕ d ϕ g δ g z ϕ m t with i 44 and a 44 being the roll moment of inertia and the added moment of inertia respectively δ is the ship displacement g is the gravitational acceleration and d is the damping moment 11 d ϕ b 1 ϕ b 2 ϕ ϕ the restoring arm in still water is given as 12 g z ϕ c 1 ϕ c 3 ϕ 3 the energy spectrum of the wave induced moment is estimated from the water surface elevation spectrum s η η using the roll moment amplitude operator f r o l l 13 s m m ω f r o l l ω 2 s η η ω dividing eq 10 by i 44 a 44 we finally obtain 14 ϕ b 1 ϕ b 2 ϕ ϕ c 1 ϕ c 3 ϕ 3 m t 2 4 solution to the rare sub problem the probability of encountering dangerous wave groups with certain specifications as in eq 5 is calculated by once again employing the concept of markov chains according to the following procedure 15 p h j h c r j t j t c r m p 0 n 2 j p 1 n p 2 n p 01 n 1 p 02 n 1 where in the left hand side of eq 15 the k superscript has been dropped to simplify notation and 16 p 1 n t c r m f t n t n 1 h n t n t n 1 h n h c r n d t n d t n 1 17 p 2 n h c r n h c r n 1 f h n h n 1 h n h n 1 d h n d h n 1 18 p 0 p 01 1 p 02 1 the probabilities appearing in the denominator of the product operator in eq 15 are obtained using the marginal pdfs of the bivariate models defined in eqs 16 and 17 respectively in the context of spectral methods tayfun 1993 observed that a bivariate gaussian distribution is a good approximation for the pdf of successive wave periods appearing in eq 16 given the associated heights h n h n h n 1 exceed a certain level h c r n h c r n h c r n 1 for the distribution of two consecutive wave heights f h n h n 1 in eq 17 kimura 1980 proposed the bivariate rayleigh distribution 2 5 solution to the non rare sub problem attempts to validate the critical wave groups method have been based mostly on the assumption that the ship has zero initial conditions ϕ 0 ϕ 0 0 0 when approached by a wave group e g anastopoulos and spyrou 2017 shigunov et al 2019 although this can somehow be acceptable from a ship roll dynamics perspective rainey and thompson 1991 the matter needs to be thoroughly investigated however the idea of treating probabilistically the initial conditions via the computation of the second term in eq 2 had already been demonstrated in themelis and spyrou 2008 in their study the joint pdf of initial conditions had been modelled by a gaussian distribution and by further assuming that the roll angle and velocity are independent random variables in the following section the distribution of initial conditions is estimated directly from monte carlo simulations of roll motion using eq 14 to evaluate the assumptions of gaussianity and independence the obtained empirical distribution is compared with a bivariate gaussian distribution that is fitted to the generated data 3 results and discussion below the critical wave groups method is applied to a small ocean surveillance ship with main parameters listed in table 1 to calculate the probability of exceedance for a number of roll angle thresholds ϕ c r i t the concept of separation as expressed through eq 2 is illustrated in fig 1 where the gz curve of the vessel is divided in two sub regions representing the rare and non rare sub problems the boundary of the sub regions is indicated by a vertical line and justification for its location will be provided later in this section for comparison reasons our method is implemented using first regular and then irregular wave group excitations in both cases the results are tested against monte carlo simulations of roll motion to assess the performance of the approach when spectral methods are employed desired distributions in eqs 16 and 17 are also estimated using simulations of the wave field anastopoulos and spyrou 2017 3 1 monte carlo simulations the ship is assumed to operate in a sea state described by the modified pierson moskowitz spectrum with significant wave height h s 3 m and peak period t p 11 s 19 s η η ω 5 058 g 2 h s 2 ω 5 t p 4 exp 5 4 ω p ω 4 were ω p is the peak frequency the wave induced moment was modelled using eq 13 and information for the roll moment amplitude operator f r o l l of the vessel was found in su 2012 for the simulation of a stationary and ergodic gaussian wave field the following model was adopted st denis and pierson 1953 20 η t n 2 s η η ω n d ω cos ω n t ε n where ε n are random variables uniformly distributed over 0 2π ω n are the frequencies of the wave components and d ω is the frequency resolution in total 175132 waves were analyzed from a set of 16 records of 24 h statistics of roll motion were collected without assuming the ergodic property for the roll response for a discussion on the ergodicity problem see belenky et al 1998 as a corollary the analysis was made on an ensemble of 3 10 6 short duration realizations sampled at a fixed time instant t s 150 s there are several aspects concerning the selection of the t s value that are worth deeper discussion particularly because they are related to the general problem of setting up monte carlo experiments in a mathematically consistent and at the same time efficient way first generated time series should be long enough to ensure that the effect of ship s state at t 0 s will have faded before reaching t s in such case the very same set of ϕ 0 ϕ 0 values can be utilized for initiating all simulations e g here zero initial conditions were assumed moreover ensemble averages may need several cycles depending on the system to converge to their true values in this regard one could perform a small number of preliminary runs to detect the transient part in the time evolution of the targeted response statistics and then select t s accordingly in fig 2 the results of our investigation are presented as shown after 75s the ensemble mean and variance of the roll process are practically time invariant while similar behavior was noticed also for the 3rd and 4th order statistical moments not included here for brevity reasons from the same figure it is evident that the autocorrelation functions here normalized by the variance of the angle and velocity processes oscillate very close to zero in light of the above t s could have been set exactly at 75s to minimize the computational cost of the procedure however here time histories being essentially twice as long as the transient part 0s 75s were intentionally produced to demonstrate the validity of our eventual t s 150 s choice more clearly in fig 3 the joint pdf of roll angle and velocity as obtained from the monte carlo simulations is compared with a bivariate gaussian distribution that was fitted to the generated data the standard deviation of roll angle was σ 1 6 4 while for the velocity it was σ 2 6 3 s the correlation between these two random variables was estimated using pierson s parameter and was found zero although this does not necessarily imply statistical independence one could argue that in a first approximation it is sufficient to consider the joint distribution of roll angle and velocity as the product of the respective marginal distributions themelis and spyrou 2008 it is should be noted that in fig 3 comparisons are limited in the region of high probability levels just because in the critical wave groups framework the gaussian model is used only for computing the second term in eq 2 considering that any state of the system ϕ ϕ can be regarded as the time evolution of an initial state ϕ 0 ϕ 0 this calculation requires in fact knowledge of the distribution of non rare roll responses in our current setup the non rare sub problem corresponds to regimes where ship response is approximately linear while no assumption is needed to be made on the shape of the distribution associated with the nonlinear rare part therefore the intention of fig 3 is to verify our calculation scheme i e that according to the way we set up the problem fig 1 statistics of initial conditions below 16 truly have the expected gaussian character finally it is worth mentioning that the parameters of the fitted distribution could have been estimated with fair accuracy using a much smaller number of simulations or even without performing any simulations at all since it is straightforward to approximate non rare response statistics theoretically by elaborating on only the linear part of eq 14 3 2 regular wave groups in principle wave groupiness is a phenomenon related to multi chromatic seas essentially because wave group generation is based on local focusing of individual wave components in eq 20 at some point the term regular wave group is used here to express the idea of themelis and spyrou 2007 to employ monochromatic harmonic wave trains for identifying critical height thresholds in eq 5 in this respect regular wave groups should be considered only as sequences of waves with equal heights and periods as shown in fig 4 this artificial feature though is expected to affect the accuracy of the critical wave groups method the magnitude of this effect is investigated in the following in this context we present the results obtained when regular wave groups with j j max 5 are utilized and for two cases of critical period range widths δ t 1 s fig 5 and δ t 2 s fig 6 critical wave groups were determined for 81 cases of initial conditions of the vessel spanning the domains 16 16 and 16 s 16 s with a fixed step the probability of exceedance p e was calculated for 8 different roll angle thresholds from 20 up to 55 with a step of 5 the thresholds are implied as possible capsize limits given that eq 14 is a very simple roll model and it does not contain design information about deck submergence downflooding angles etc in this regard produced estimates are considered to be referring to a parameterized capsize limit in figs 5 and 6 diamonds indicate that critical wave groups were determined only for zero initial conditions ϕ 0 ϕ 0 and probabilistic calculations were carried out using wave distributions derived from simulations of the wave field circles and dots refer to the synthesized solutions of the non rare and rare sub problems when distributions of heights and periods in eqs 16 and 17 are estimated from simulations cwg sim and spectral methods cwg spe respectively the results of monte carlo simulations mc are overlaid on the same plots solid lines the selection of an appropriate grid of initial conditions is a matter of importance for the implementation of the method as discussed earlier the grid should be located in the linear regime due to the type of separation that is tried here indeed fig 3 shows that for the examined sea conditions ship response exhibits an almost gaussian behaviour in the considered domain 16 16 16 s 16 s consequently with the boundary of rarity nonlinearity being at 16 fig 1 it is rather natural to produce the first estimate of the rare solution with respect to a somewhat higher roll angle threshold e g 20 at the same time though critical wave groups determined for initial conditions within this domain should be statistically independent as required by eq 4 to detect the limits of application one could exploit the issue of rarity defining the point where the mc curve stops due to lack of data e g 30 in figs 5 and 6 based on the above the performance of the current calculation scheme can be tested against the results of the monte carlo simulations in the range 20 30 definitely estimating the probability of exceeding very low roll levels goes beyond the scope of eq 4 given that the method targets the identification of critical wave groups that are sufficiently rare for this reason and since roll dynamics below 16 are essentially linear fig 1 our method utilizes a gaussian distribution with zero mean and standard deviation σ 1 6 4 as computed for fig 3 however in figs 5 and 6 the gaussian model is not included because it was observed that it is almost identical with the derived mc curve in the entire range 0 30 this is attributed to the rarity of extreme events meaning that for the specific sea state nonlinearity is not visible in the statistics because the dynamical system spends most of the time close to the stable equilibrium which contributes the main probability mass of the response pdf see also belenky et al 2016 as illustrated in figs 5 and 6 the synthesized solution of the method cwg sim and cwg spe extends the estimates of the monte carlo simulations up to the region of extreme responses the predictions for the below 30 region are an order of magnitude greater than those of the simulations and thus we would assume that the method generally overestimates the probability of exceedance when regular wave groups are utilized moreover it should be noted that the problem of rarity is not completely solved in the case of cwg sim because the pdfs in eqs 16 and 17 were empirically estimated from limited data the amount of generated data becomes even smaller for exceptionally high waves and thus sample estimates naturally fail to converge to the true population values this justifies why cwg sim predicts lower probability levels than the cwg spe scheme in the tail region hence the deviation of the cwg spe and the cwg sim curves of figs 5 and 6 for roll angles above 35 can lead to the conclusion that the spectral method is more effective another advantage of the cwg spe approach is that the pdfs in eqs 16 and 17 exist in closed forms which makes them more attractive for practical applications finally from figs 5 and 6 it is obvious that the simplified approach cwg 0 using only zero initial conditions consistently underestimates the probability of exceedance this fact along with the sensitivity of the results to the selection of δ t were reported also in our previous study anastopoulos and spyrou 2017 where the same ship model was studied yet for a different sea state it is interesting to note however that the effect of δ t becomes weaker when more initial conditions ϕ 0 ϕ 0 are taken into account for properly tuning the δ t parameter we shall refer to the work of boccotti 2000 according to data collected from real wave field measurements period variations tend to asymptotically vanish in the limit of infinitely high waves additional evidence could be produced from the wave data that were generated for the purposes of the present study assuming a number of possible height thresholds for the definition of wave groups more specifically wave successions with heights above a pre selected level were extracted from each of the 16 records and statistics for δ t were calculated considering that δ t t max t min with t max being the maximum and t min the minimum period observed within each of these wave groups in fig 7 we have plotted the variation of the mean dots and standard deviation circles of δ t as a function of the utilized height threshold the results verify boccotti s 2000 argument that for increasing heights δ t 0 in the critical wave groups framework δ t essentially determines the difference between the upper and lower limit of integration in eq 16 therefore allowing for more variability in the periods of dangerous wave episodes δ t 2 s when ship instability is triggered by very steep waves artificially increases the deduced probabilities p e considering also that in the case of resonance we are not certain if critical wave groups with δ t 2 s would still provoke exceedance of a large ϕ c r i t we conclude that δ t 1 s could be more consistent for the implementation of the proposed method 3 3 irregular wave groups in figs 8 and 9 the results of the critical wave groups method with irregular wave groups are displayed using the same parameters as before j max 5 δ t 1 s and δ t 2 s the notation is the same as in figs 5 and 6 for this application critical wave groups were identified so that exceedance of a roll angle threshold was always recorded during the encounter of the highest wave in this way waves succeeding the highest one were excluded from the probability calculations and the occurrence of instabilities was explicitly related to the characteristics of the highest wave which uniquely defines the structure of a realistic wave group anastopoulos et al 2016 regarding the construction of irregular wave group shapes the transition probabilities in eqs 6 8 were calculated according to the method described in anastopoulos et al 2016 with the only difference that the necessary correlation parameters were estimated from the generated wave data in this way the efficiency of the markov model for determining the expected wave height and period sequences is enhanced from figs 8 and 9 we see that for moderate roll angle thresholds the results of the new approach are almost identical with the monte carlo estimates in the tail region the predictions extend smoothly from the non rare part for both the examined values of the δ t parameter the success of the approach is possibly due to the wave groups construction method which naturally avoids producing wave groups with unusual specifications because they are very unlikely to be encountered with this feature not being present in the case of regular waveforms abnormally high wave trains may be utilized for a given period since their probability of occurrence is really low they affect mostly the tail of the response distribution again the rarity of extreme events is more effectively treated when spectral methods are employed and it is confirmed that treating the initial conditions in a probabilistic context is an essential part of the current methodology although detecting critical wave groups for many initial conditions is more computationally intensive the time needed for the 81 scenarios considered here is still less than an hour on a modern laptop moreover probabilistic calculations take only few minutes since they involve a moderate number of pdf integrations that are performed numerically the main computational burden in the overall critical wave groups procedure comes at the moment at least from the derivation of these irregular wave group forms it is indicative that for the examined sea conditions the construction of wave trains with parameters h c t c and j in the entire domain of interest requires a few hours on a modern desktop however this work has to be done only once per sea state given that wave group data could be stored in a database for future applications the idea of using fewer cases of initial conditions with acceptable accuracy will be investigated in the future while distributing the computations to many processors or even parallelizing them more efficiently e g in a graphics processing unit gpu seem also promising directions finally the rate of convergence of the critical wave groups estimates to a satisfactory precision level can be utilized for further reducing the computational cost of the method from eq 4 we realize that the maximum run length j max involved in the calculations should control the precision of the predictions regardless of the shape of the excitation regular irregular in general it is anticipated that the larger the j max the higher the precision in fig 10 we evaluate the impact of j max on the probability of exceedance p e related to ϕ c r i t 40 and ϕ c r i t 50 in fact the results were produced using wave distributions derived from spectral methods cwg spe and correspond to δ t 1 s upper panel and δ t 2 s lower panel interestingly p e converges after j max 3 for both the examined roll angle thresholds ϕ c r i t when irregular wave groups are considered circles while for regular wave groups it monotonically decreases dots consequently determining critical ship responses in terms of realistic wave groups improves also the efficiency of the critical wave groups concept since one would obtain precise results even by examining fewer wave scenarios e g for ϕ c r i t 50 we could have set j max 3 4 conclusions in this study an improved critical wave groups calculation scheme was developed further and it was applied for estimating the probability of large amplitude roll motions in beam seas the method separates ship roll response into sub regions with distinct dynamics which are studied individually extreme ship motions were analysed under the influence of realistic wave group excitations and critical for ship stability wave events were determined for a number of initial conditions of the vessel the tail of the response distribution was obtained by calculating the probability of encountering such events conditioning on the initial conditions at the moment of the encounter to complete the solution the distribution of initial conditions assumed concerning mainly the linear region of the gz curve was approximated by a gaussian model that was fitted to a set of data derived from a limited number of time domain simulations comparisons with pertinent monte carlo simulations of roll motion demonstrate the good potential of the approach in terms of efficiency and accuracy regarding the shape of design wave groups it is revealed that considering only the most expected representatives of a given sea state may be adequate for producing reliable results since they extend smoothly the monte carlo based predictions as for the ship capsize problem the big strength of the critical wave groups approach is that it can target the probability of this event separately without having to first determine the underlying distribution law of the response process provided that rolling beyond some critical realistic roll angle is most likely to provoke flooding due to immersed opening having a method that can directly target and effectively calculate the probability of particular threshold exceedances is very desirable in fact dealing with only one threshold essentially related to stability failure would also reduce the required computational time it is noted that the times reported earlier corresponded to 8 different roll angle thresholds i e they referred to a wider scope of study than the one required for a specific ship testing the performance of the proposed critical wave groups scheme more extensively is in our future plans however before taking this important step several elements needed to be examined such as the appropriate shape of the critical wave groups and their probabilistic description the importance and the method of considering the initial state of the vessel at the moment of the group encounter in a probabilistic context and the selection of various parameters affecting the implementation e g δ t and j max these were the true focal points of the paper and we are pleased that certain milestones were reached in this respect it should be finally remarked that the sea state considered in this paper is a kind of limiting one for the vessel in the sense that at 4 m significant wave height frequent escapes were found hence beyond the 3 m significant wave height critical wave groups may not be realized so rarely and this fact should be efficiently accounted by the computational scheme acknowledgements the work of panayiotis a anastopoulos has been supported by ntua s special account for research grants elke 
22642,this paper proposes a method of dynamic modeling and a modified sliding mode control algorithm applied on multi link underwater manipulators firstly combining lagrange equation with morison formula we establish the dynamic model of a 3 dof underwater manipulator in hydrostatic environment water resistance additional mass force and buoyancy are calculated to discuss the influences to all joints working in underwater environment next we presented an improved sliding mode control strategy for the accurate trajectory tracking control of underwater manipulator to address the issue of chattering problem for sliding mode control and unavailable normalization factor an adaptive fuzzy sliding mode is proposed in order to validate the effectiveness of the presented controller two simulations are conducted the results are compared with other control algorithm and show that no matter in convergence rate or control accuracy the proposed controller has better control effect keywords underwater manipulator dynamic modeling trajectory tracking adaptive fuzzy control sliding mode control 1 introduction along with the rapid expansion of industrial scale manipulators are widely applied in a variety of field especially in underwater world due to the abundant ocean resources the difficulty of underwater operation and other factors nowadays the underwater manipulators can be mounted not only on the underwater vehicles but also on diversified types of platforms flexibly to execute cleaning surfaces pipe inspection mine disposal cable laying and repair salvage of sunken objects rope cutting and so on compared with traditional industrial manipulators underwater manipulator are more complex and difficult to control due to their time varying dynamics and non linear nature external disturbances and hydrodynamic impacts they are mainly faced with the challenges from the accurate dynamic modeling of underwater manipulators and high precision control of moving joints cjjbrown and khosla 1997 cui and sarkar 2001 marani et al 2009 the dynamic model of underwater manipulator plays a significant role in its motion simulation structure analysis and control algorithm design the dynamic calculation mainly involves two aspects the first is to establish the dynamic model in the air the second is to build a hydrodynamic model for the underwater manipulator lagrange and newton euler formulas are two commonly used conventional methods padois et al 2007 established a dynamic model of wheeled mobile vehicle and sub manipulator based on the traditional lagrange formula providing theoretical solution to complex operation tasks mohan and saha 2007 proposed a numerical recursive simulation algorithm for serial manipulator and validated correctness of the results by simulation oki et al 2010 deduced the dynamic model for space robot system applied on the newton euler dynamics and angular momentum conservation hwang 2003 hwang and wang 2002 presented the recursive equations of kinematics and dynamics to establish the kinematics position velocity and acceleration equations for flexible manipulators to provide systematical approach to the hydrodynamics of manipulator many semi empirical and semi theoretical methods were adopted mclain and rock 1998 proposed to calculate the hydrodynamic of a single manipulator through combination of theoretical analysis flow measurement and torque sensor measurement to calculate the hydrodynamic of a single manipulator armenio 1998 build digital pool using the mac method and analyzed the hydrodynamic force of the object in the water shen et al 2009 solved the navier stokes equation using the immersion boundary method and calculated the hydrodynamic forces of the object the complexity of the working environment put forward high requirements for the control algorithms of underwater manipulators faced with the challenges from hydrodynamic impacts non linear model and other external disturbances etc some effective control algorithms have been presented such as sliding mode control adaptive control model reference control non linear feedback control and so on esmaeili et al 2017 applied the sliding mode control algorithm on the trajectory tracking problem of wheeled robot successfully demonstrating the effectiveness of the sliding mode control meeting the accuracy requirements sarfraz et al 2017 presented an improved control algorithm in which the robust control algorithm was combined with the adaptive sliding mode control algorithm to control the auvs this control algorithm was proved by simulations to have high robustness anti disturbances to reduce the influence of external disturbances wang and xu 2017 proposed a neural network algorithm which was applied on a cooperative robot platform combined with the sliding mode control chen and wang 2015 designed a sliding mode controller with feedforward fuzzy compensator which was found to solve chattering problem of sliding mode control and eliminate the hydrodynamic effects in an effective manner the sliding mode control algorithm realized high precise control of manipulator through its strong anti disturbance capacity a discrete time resolved acceleration control law was proposed in reference sagara et al 2006 and applied on direct observer liang et al 2016 presented a backstepping based sliding mode control algorithm which was verified on the auvs the neuro fuzzy pd control algorithm presented by pandian and sakagami 2008 was applied on the underwater manipulator the fuzzy gain tuning method was used to adapt to underwater environment with uncertainties and disturbances and the neural network was utilized for approximating the dynamic model of the underwater manipulator and adding the feedforward compensation to the pd controller nowadays the hydrodynamic model has been regarded as the interfering signal in most of the papers which however has greatly impacts on the accuracy of the underwater manipulator dynamic model in this paper combining lagrange equation with morison formula an accurate dynamic model of a 3 dof underwater manipulator in hydrostatic environment was established an improved sliding mode control strategy was then presented which is embedded with fuzzy adaptive algorithm for the accuracy trajectory tracking control applied on the underwater manipulator the fuzzy gain tuning is used to eliminate underwater disturbance and solve the chattering problem while the sliding mode control algorithm is to achieve the accurate calculation of the dynamic model accurately the results of some numerical tests and simulations fully demonstrate the effectiveness and efficiency of the improved sliding mode control algorithm this paper is organized as follows in section 2 we describe the mathematical method of dynamic modeling for underwater manipulator in section 3 a fuzzy adaptive sliding mode control algorithm is proposed simulation and results analysis are provided in section 4 finally the conclusions are given in section 5 2 dynamic modeling of underwater manipulator 2 1 lagrange theory to manipulator according to the lagrange theory the dynamic equations of multi joint manipulators can be expressed as follow 1 m q q c q q q g q f q τ d τ this equation describes the rigid dynamic model of a manipulator it s also called inverse dynamics where m q δ m i j c q q δ q t c 1 q t c n g q δ g 1 g n τ δ τ 1 τ n where q q q is the vector of joint displacement velocity and acceleration respectively m r n n represents the inertia matrix of joint space c r n denotes the coriolis and centripetal force g r n represents the gravity term f q r n denotes the interference factors including friction force and other disturbances τ r n represents the joint torque and τ d r n is the hydrodynamic parameter equation of each joint in addition the manipulator system also has the following dynamic characteristics which is very important to controller designing 1 m q 2 c q q is a skew symmetric matrix 2 the inertia matrix m q is symmetric positive definite matrix and there exist scalars m 1 m 2 such that m 1 x 2 x t m q x m 2 x 2 3 there is a parameter vector that depends on the parameters of the rigid manipulator and make m q c q q g q satisfy the following linear relation m q q c q q q g q f q τ d ψ q q q p ˆ p where ψ q q q p ˆ represents regression matrix based on joints variables p denotes constant parameter vector for the quality characteristic of the manipulator 2 2 hydrodynamic equation model of underwater manipulator in the underwater environment each joint of underwater manipulator will be affected by its self motion and uniform flow due to unpredictable movement of water only self motion is taken into account here fig 1 demonstrates the motion of a single object in the water according to the hydrodynamics the interaction force between the unit length of object and water can be described as follow 2 d f d l d f d d l d f m d l d f l d l d f f d l where f d represents the water resistance f m denotes the additional mass force f l represents the lift and f f denotes the buoyancy lift f l exist due to the airfoil structure of object the impact of lift is not considered because underwater manipulator has no such a structure the morison formula is used to calculate the water resistance and the additional mass force commonly the wave forces on the rigid body is calculated as 3 d f d f d d f m 1 2 ρ c d d v v d l ρ c m a v d l where c d is the resistance coefficient c m is inertia force coefficient ρ is fluid density a is the projected area that perpendicular to the direction of the incoming flow velocity d is the cross sectional area of object in general c d and c m are obtained by experiments in this study the empirical values of c d 1 0 and c m 2 0 are used as shown in fig 1 the object is rotating around the axes of t 1 t 2 to form a combined rotational motion which is a common rotating motion of manipulator the o x y z is the base coordinate system of the manipulator a 1 is the angle between the axis of the object and the x o z plane a 2 is that between the axis of the object and the x o y plane the angular velocities of the object rotating around the two axes are ω 1 θ 1 ω 2 θ 2 respectively then the object is divided into several mini segments the direction vectors from one mini segment to the two axes are represented by r 1 r 2 respectively then the velocity and torque are obtained as 4 v ω 1 r 1 ω 2 r 2 ω 1 l cos a 2 ω 2 l 5 t t 1 t 2 1 2 ρ c d 0 l 1 l cos θ 2 ω 1 l cos θ 2 ω 1 l cos θ 2 l ω 2 l ω 2 l d 1 d l ρ c m 0 l 1 l cos θ 2 ω 1 l cos θ 2 ω 1 l sin θ 2 ω 2 l ω 2 l d 1 d 2 d l where l 1 is the length of object d 1 d 2 are the area of axle cross section and direction of flow respectively buoyancy formula is expressed as 6 f g i m l i g v l i ρ g m l i 1 ρ ρ m where m l i is the quality of link i v l i is the effective volume of rigid link i ρ is the water density ρ m is the density of link i 3 adaptive fuzzy sliding mode control 3 1 traditional sliding mode control in order to design the controller more convenient we add the hydrodynamic parameter equation τ d into the interference term f q define the tracking error and the sliding variable as follow 7 e q d q 8 s e λ e where λ d i a g λ 1 λ n λ i 0 and 9 q r q s q d λ e q r q s q d λ e so we can design the traditional sliding mode control as below 10 τ τ ˆ k sgn s τ ˆ m ˆ q r c ˆ q r g ˆ f ˆ a s where m ˆ c ˆ g ˆ f ˆ are the estimated values of m c g f respectively k d i a g k 11 k i i k n n and a d i a g a 1 a i a n are positive definite matrixs substituting 9 into 1 we can figure out 11 m s c a s δ f k sgn s where δ f δ m q r δ c q r δ g δ f δ m m ˆ m δ c c ˆ c δ g g ˆ g δ f f ˆ f assume δ f i δ f i b o u n d and k i i is bound such that 12 k i i δ f i b o u n d define the lyapunov function candidate 13 v 1 2 s t m s differentiating 12 and using 10 11 we can obtain that v s t m s 1 2 s t m s s t c a s δ f k sgn s c s s t a s δ f k sgn s s t δ f k sgn s s t a s i 1 n s i δ f i k i i sgn s s t a s s t a s 0 we can figure out that the lyapunov function is positive definite and its derivatives is negative definite so we can prove the stability of the system 3 2 fuzzy system the results of many studies can show that the fuzzy logic system can approximate any well define nonlinear function accurately so we use the fuzzy gain to solve the chattering of sliding mode control and to adapt the uncertainties disturbances by using singleton fuzzifier product inference and centeraverage defuzzifier strategies the output of fuzzy system can be expressed as 14 y m 1 m θ m i 1 n μ a i m x i m 1 m i 1 n μ a i m x i θ t ψ x where θ θ 1 θ m θ m t ψ x ψ 1 x ψ m x ψ m x t ψ m x i 1 n μ a i m x i m 1 m i 1 n μ a i m x i m is the number of fuzzy rules 3 3 adaptive fuzzy sliding mode control according to the fuzzy logic system and sliding mode control we can design the controller 15 τ m ˆ q r c ˆ q r g ˆ f ˆ a s k where k k 1 k i k n k i is the output of the ith of the fuzzy system if we do not use fuzzy logic system we can define the lyapunov function as follow 16 v 1 2 s t m s so v 1 2 s t m s s t m s s t m s s t c a s δ f k c s s t a s δ f k s t δ f k s t a s i 1 n s i δ f i s i k i s t a s in order to maintain the stability of the system we need to keep the v being negative so we should keep s i k i 0 and ensure s i k i having the same sign on the other hand considering the s i δ f i s i k i when s i is large we should keep k i being large to maintain the stability of the system next we design the fuzzy system which input is s i and output is k i the fuzzy rules can be expressed as follow i f s i i s a i m t h e n k i i s b i m where a i m b i m are the rule bases of input and output respectively see table 1 where n b n s z e p s p b is the five rule bases which denote negative large negative small zero positive small positive large respectively in this paper we select the gauss function as the membership function for fuzzy base fig 2 shows the rule of the gauss function substituting 13 into 10 18 m s c a s δ f k where k i θ k i d t ψ k i s i according to the universal approximation principle there is χ i 0 maintaining 19 δ f i θ k i d t ψ k i s i χ i and we can obtain the adaptive law as below 20 θ k i s i ψ k i s i define lyapunov function v 1 2 s t m s 1 2 i 1 n θ k i t θ k i where θ k i θ k i θ k i d so v 1 2 s t m s s t m s s t m s 1 2 i 1 n θ k i t θ k i θ k i t θ k i 1 2 2 s t m s s t m s i 1 n θ k i t θ k i s t m s c s i 1 n θ k i t θ k i s t c a s δ f k c s i 1 n θ k i t θ k i s t a s δ f k i 1 n θ k i t θ k i s t a s s t δ f k i 1 n θ k i t θ k i s t a s i 1 n s i δ f i k i i 1 n θ k i t θ k i because of k i θ k i t ψ k i s i θ k i d t ψ k i s i v s t a s i 1 n s i δ f i θ k i t ψ k i s i θ k i d t ψ k i s i i 1 n θ k i t θ k i s t a s i 1 n s i δ f i θ k i d t ψ k i s i i 1 n s i θ k i t ψ k i s i θ k i t θ k i s t a s i 1 n s i δ f i θ k i d t ψ k i s i i 1 n θ k i t s i ψ k i s i θ k i t substituting 20 into v we have v s t a s i 1 n s i δ f i θ k i d t ψ k i s i existing a series of positive constants γ i make 19 satisfy δ f i θ k i d t ψ k i s i χ i γ i s i where 0 γ i 1 so s i δ f i θ k i d t ψ k i s i γ i s i 2 γ i s i 2 v s t a s i 1 n γ i s i 2 i 1 n α i s i 2 γ i s i 2 i 1 n γ i α i s i 2 0 where γ d i a g γ 1 γ i γ n α i γ i when s 0 v 0 so the adaptive law will be progressive convergence the same as l i m t s l i m t e λ e 0 l i m t q q d l i m t q q d fig 3 shows the block diagram of the controller 4 simulation results 4 1 impacts of hydrodynamic on manipulator to research the motion effect of hydrodynamics simulation and analysis are conducted based on the underwater manipulator fig 4 shows the structure of manipulator the parametric equations of dynamic model and hydrodynamic model based on the underwater manipulator are described in the appendix numerical analysis and quantitative research are proposed for hydrodynamic analysis of underwater manipulator laying a basis for dynamic compensation and model simplification in the simulation of manipulator control the parameters of each link of the manipulator are shown in table 2 when the manipulator works in the air the influence of the water resistance additional mass force and other disturbance on the joint should not considered in its dynamic equation the torque changes of three joints are obtained by numerical simulation as shown in fig 5 by contrast under the water three joints of the manipulator tend to be affected by additional mass torque water resistance torque and buoyancy torque which will be discussed separately the first is the impact of former torque the second goes to the impact of the last torque the simulation results of above three types of torques are shown in fig 6 it was concluded from the above simulation results that the value of the buoyancy torque is generally 1 3 of the gravity term larger than that of additional mass torque and water resistance torque though having less values than the motion torque of the joints in the air the three types of torques still exerted a great impact on the trajectory tracking simulation next the influence of hydrodynamic torque on the motion of the joints is obtained to facilitate the research the pd control strategy is adopted to control three joints of the underwater manipulator with the desired trajectories of three joints expressed as q d sin π t then motion simulation is carried out fig 7 shows the impacts of the water resistance and additional mass torque on the trajectory tracking of joints fig 8 shows those of the buoyancy torque on the trajectory tracking due to the joint torque coupling of the manipulator and the limitation of pd control the three joints could not rotate along the desired trajectory this problem is not the focus of this section and hence ignored the simulation results indicated the great impact of hydrodynamic on trajectory tracking at the beginning of the simulation the situations of trajectory tracking in two different environments is similar however with the continuation of simulation bigger errors is generated under influence of the hydrodynamics the impact of the buoyancy is more serious than water resistance and additional mass force as a result to offset the influence of hydrodynamic became necessary 4 2 the simulation of fuzzy adaptive sliding mode control combining the control algorithm with the dynamic model of underwater manipulator the simulation is carried out first the desired joint trajectories are expressed as below q d 1 3 cos t 2 sin 3 t q d 2 sin 2 t 2 cos t q d 3 2 cos 2 t sin t where the parameter setting in controller is λ d i a g 15 15 15 the domain setting of fuzzy system is π 4 π 4 the adaptive fuzzy sliding mode control is compared with the traditional sliding mode control to illustrate its superiority the simulation results are shown in figs 9 and 10 presenting the tracking performances of traditional sliding mode control and adaptive fuzzy sliding mode control respectively firstly the performances of the traditional sliding mode control are analyzed joint 1 obtains the best trajectory tracking result of all three joints at the beginning of the simulation the first joint rotates along with the desired trajectory with its actual trajectory almost fitted to the desired trajectory at around 1 5s the range of error is 0 5 nevertheless some disadvantages are found through the simulations of joint 2 and joint 3 in specific although the two joints rotate with the desired trajectory chattering problem still appeared this led to the actual trajectory fluctuating frequently on both sides of the desired trajectory the chattering problem seriously impact on the stability and reliability of the manipulator in contrast the adaptive fuzzy sliding mode control algorithm perform better regarding convergence rate and control precision with the error ranging 0 1 in addition the chattering problem of sliding mode control is eliminated the results of angular velocity tracking for the two controllers are shown in figs 11 and 12 figs 11 and 12 present that actual trajectory obtain better performances under the control of the adaptive fuzzy sliding mode algorithm especially regarding the chattering problem for easy comparison velocity and displacement tracking errors in two controllers are computed by the following equations 21 e d 1 n i 1 n q d i q i 2 r a d 2 22 e v 1 n i 1 n q d i q i 2 r a d 2 where e d and e v are the error of trajectory and velocity tracking respectively q d i and q d i are the desired trajectory and velocity after 1s q i and q i are the actual trajectory and velocity after 1s n is the number of element then the performance of the proposed afsmc has been compared with the control algorithm in reference mohammad et al 2015 to prove the superiority if this algorithm see table 3 it is then concluded that the proposed afsmc exhibited better control efficiency and the ability of solving chattering problem than smc and the control algorithm in reference mohammad et al 2015 in addition the simulation results of end effector on trajectory tracking are shown in fig 13 indicating that control system obtain good control effect and achieve the expected goal in real application see fig 13 5 conclusions this paper proposes a method of dynamic modeling and a modified sliding mode control based on multi link underwater manipulators combining lagrange equation with morison formula a completely dynamic model of underwater manipulator is established to solve chattering problem for sliding mode control and unavailable normalization factor an adaptive fuzzy sliding mode is introduced the simulation results demonstrate great ability of the afsmc algorithm to eliminate the chattering and other disturbances acknowledgement this study was supported by the the fundamental research funds for the central universities of china gk2070260140 appendix water resistance torque t d t d 1 1 2 ρ c d d 0 l x 0 0 v n x v n x d l 1 2 ρ c d d 1 0 l 1 l θ 1 l θ 1 l d l 1 2 ρ c d d 2 0 l 2 l cos θ 2 θ 1 l cos θ 2 θ 1 l cos θ 2 d l 1 2 ρ c d d 3 0 l 3 l 2 cos θ 2 l cos θ 2 θ 3 θ 1 l 2 cos θ 2 l cos θ 2 θ 3 θ 1 l 2 cos θ 2 l cos θ 2 θ 3 d l t d 2 1 2 ρ c d d 2 0 l 2 l θ 2 l θ 2 l d l 1 2 ρ c d d 3 0 l 3 l 2 2 l 2 2 l 2 l cos θ 3 cos β θ 2 l 2 2 l 2 2 l 2 l cos θ 3 θ 2 l 2 2 l 2 2 l 2 l cos θ 3 d l 1 2 ρ c d d 3 0 l 3 l 2 2 l 2 2 l 2 l cos θ 3 cos β θ 3 l θ 3 l d l t d 3 1 2 ρ c d d 3 0 l 3 l θ 3 l θ 3 l d l 1 2 ρ c d d 3 0 l 3 l cos β θ 2 l 2 2 l 2 2 l 2 l cos θ 3 θ 2 l 2 2 l 2 2 l 2 l cos θ 3 d l where β arccos l 2 2 r 3 2 2 l 2 2 l 2 r 3 2 additional mass torque t m t m 1 ρ c m a 0 l x 0 0 d v n x d t d l ρ c m a 1 0 l 1 l θ 1 l d l ρ c m a 2 0 l 2 l cos θ 2 θ 1 l cos θ 2 θ 1 θ 2 l sin θ 2 d l ρ c m a 3 0 l 3 l 2 cos θ 2 l cos θ 2 θ 3 θ 1 l 2 cos θ 2 l cos θ 2 θ 3 θ 1 l 2 sin θ 2 θ 2 l sin θ 2 θ 3 θ 2 θ 3 d l t m 2 ρ c m a 2 0 l 2 l θ 2 l d l ρ c m a 3 0 l 3 l 2 2 l 2 2 l 2 l cos θ 3 cos β θ 3 l d l ρ c m a 3 0 l 3 l 2 2 l 2 2 l 2 l cos θ 3 cos β θ 2 l 2 2 l 2 2 l 2 l cos θ 3 θ 2 l 2 l sin θ 3 θ 3 l 2 2 l 2 2 l 2 l cos θ 3 d l t m 3 ρ c m a 3 0 l 3 l d ω 3 r 3 3 d t d l ρ c m a 3 0 l 3 l d ω 2 r 3 2 d t d l ρ c m a 3 0 l 3 l θ 3 l d l ρ c m a 3 0 l 3 l cos β θ 2 l 2 2 l 2 2 l 2 l cos θ 3 θ 2 l 2 l sin θ 3 θ 3 l 2 2 l 2 2 l 2 l cos θ 3 d l buoyancy force g g 1 0 g 2 a 2 m 2 g c 2 m 3 g a 3 c 23 l 2 c 2 1 ρ ρ m g 3 a 3 m 3 g c 23 1 ρ ρ m 
22642,this paper proposes a method of dynamic modeling and a modified sliding mode control algorithm applied on multi link underwater manipulators firstly combining lagrange equation with morison formula we establish the dynamic model of a 3 dof underwater manipulator in hydrostatic environment water resistance additional mass force and buoyancy are calculated to discuss the influences to all joints working in underwater environment next we presented an improved sliding mode control strategy for the accurate trajectory tracking control of underwater manipulator to address the issue of chattering problem for sliding mode control and unavailable normalization factor an adaptive fuzzy sliding mode is proposed in order to validate the effectiveness of the presented controller two simulations are conducted the results are compared with other control algorithm and show that no matter in convergence rate or control accuracy the proposed controller has better control effect keywords underwater manipulator dynamic modeling trajectory tracking adaptive fuzzy control sliding mode control 1 introduction along with the rapid expansion of industrial scale manipulators are widely applied in a variety of field especially in underwater world due to the abundant ocean resources the difficulty of underwater operation and other factors nowadays the underwater manipulators can be mounted not only on the underwater vehicles but also on diversified types of platforms flexibly to execute cleaning surfaces pipe inspection mine disposal cable laying and repair salvage of sunken objects rope cutting and so on compared with traditional industrial manipulators underwater manipulator are more complex and difficult to control due to their time varying dynamics and non linear nature external disturbances and hydrodynamic impacts they are mainly faced with the challenges from the accurate dynamic modeling of underwater manipulators and high precision control of moving joints cjjbrown and khosla 1997 cui and sarkar 2001 marani et al 2009 the dynamic model of underwater manipulator plays a significant role in its motion simulation structure analysis and control algorithm design the dynamic calculation mainly involves two aspects the first is to establish the dynamic model in the air the second is to build a hydrodynamic model for the underwater manipulator lagrange and newton euler formulas are two commonly used conventional methods padois et al 2007 established a dynamic model of wheeled mobile vehicle and sub manipulator based on the traditional lagrange formula providing theoretical solution to complex operation tasks mohan and saha 2007 proposed a numerical recursive simulation algorithm for serial manipulator and validated correctness of the results by simulation oki et al 2010 deduced the dynamic model for space robot system applied on the newton euler dynamics and angular momentum conservation hwang 2003 hwang and wang 2002 presented the recursive equations of kinematics and dynamics to establish the kinematics position velocity and acceleration equations for flexible manipulators to provide systematical approach to the hydrodynamics of manipulator many semi empirical and semi theoretical methods were adopted mclain and rock 1998 proposed to calculate the hydrodynamic of a single manipulator through combination of theoretical analysis flow measurement and torque sensor measurement to calculate the hydrodynamic of a single manipulator armenio 1998 build digital pool using the mac method and analyzed the hydrodynamic force of the object in the water shen et al 2009 solved the navier stokes equation using the immersion boundary method and calculated the hydrodynamic forces of the object the complexity of the working environment put forward high requirements for the control algorithms of underwater manipulators faced with the challenges from hydrodynamic impacts non linear model and other external disturbances etc some effective control algorithms have been presented such as sliding mode control adaptive control model reference control non linear feedback control and so on esmaeili et al 2017 applied the sliding mode control algorithm on the trajectory tracking problem of wheeled robot successfully demonstrating the effectiveness of the sliding mode control meeting the accuracy requirements sarfraz et al 2017 presented an improved control algorithm in which the robust control algorithm was combined with the adaptive sliding mode control algorithm to control the auvs this control algorithm was proved by simulations to have high robustness anti disturbances to reduce the influence of external disturbances wang and xu 2017 proposed a neural network algorithm which was applied on a cooperative robot platform combined with the sliding mode control chen and wang 2015 designed a sliding mode controller with feedforward fuzzy compensator which was found to solve chattering problem of sliding mode control and eliminate the hydrodynamic effects in an effective manner the sliding mode control algorithm realized high precise control of manipulator through its strong anti disturbance capacity a discrete time resolved acceleration control law was proposed in reference sagara et al 2006 and applied on direct observer liang et al 2016 presented a backstepping based sliding mode control algorithm which was verified on the auvs the neuro fuzzy pd control algorithm presented by pandian and sakagami 2008 was applied on the underwater manipulator the fuzzy gain tuning method was used to adapt to underwater environment with uncertainties and disturbances and the neural network was utilized for approximating the dynamic model of the underwater manipulator and adding the feedforward compensation to the pd controller nowadays the hydrodynamic model has been regarded as the interfering signal in most of the papers which however has greatly impacts on the accuracy of the underwater manipulator dynamic model in this paper combining lagrange equation with morison formula an accurate dynamic model of a 3 dof underwater manipulator in hydrostatic environment was established an improved sliding mode control strategy was then presented which is embedded with fuzzy adaptive algorithm for the accuracy trajectory tracking control applied on the underwater manipulator the fuzzy gain tuning is used to eliminate underwater disturbance and solve the chattering problem while the sliding mode control algorithm is to achieve the accurate calculation of the dynamic model accurately the results of some numerical tests and simulations fully demonstrate the effectiveness and efficiency of the improved sliding mode control algorithm this paper is organized as follows in section 2 we describe the mathematical method of dynamic modeling for underwater manipulator in section 3 a fuzzy adaptive sliding mode control algorithm is proposed simulation and results analysis are provided in section 4 finally the conclusions are given in section 5 2 dynamic modeling of underwater manipulator 2 1 lagrange theory to manipulator according to the lagrange theory the dynamic equations of multi joint manipulators can be expressed as follow 1 m q q c q q q g q f q τ d τ this equation describes the rigid dynamic model of a manipulator it s also called inverse dynamics where m q δ m i j c q q δ q t c 1 q t c n g q δ g 1 g n τ δ τ 1 τ n where q q q is the vector of joint displacement velocity and acceleration respectively m r n n represents the inertia matrix of joint space c r n denotes the coriolis and centripetal force g r n represents the gravity term f q r n denotes the interference factors including friction force and other disturbances τ r n represents the joint torque and τ d r n is the hydrodynamic parameter equation of each joint in addition the manipulator system also has the following dynamic characteristics which is very important to controller designing 1 m q 2 c q q is a skew symmetric matrix 2 the inertia matrix m q is symmetric positive definite matrix and there exist scalars m 1 m 2 such that m 1 x 2 x t m q x m 2 x 2 3 there is a parameter vector that depends on the parameters of the rigid manipulator and make m q c q q g q satisfy the following linear relation m q q c q q q g q f q τ d ψ q q q p ˆ p where ψ q q q p ˆ represents regression matrix based on joints variables p denotes constant parameter vector for the quality characteristic of the manipulator 2 2 hydrodynamic equation model of underwater manipulator in the underwater environment each joint of underwater manipulator will be affected by its self motion and uniform flow due to unpredictable movement of water only self motion is taken into account here fig 1 demonstrates the motion of a single object in the water according to the hydrodynamics the interaction force between the unit length of object and water can be described as follow 2 d f d l d f d d l d f m d l d f l d l d f f d l where f d represents the water resistance f m denotes the additional mass force f l represents the lift and f f denotes the buoyancy lift f l exist due to the airfoil structure of object the impact of lift is not considered because underwater manipulator has no such a structure the morison formula is used to calculate the water resistance and the additional mass force commonly the wave forces on the rigid body is calculated as 3 d f d f d d f m 1 2 ρ c d d v v d l ρ c m a v d l where c d is the resistance coefficient c m is inertia force coefficient ρ is fluid density a is the projected area that perpendicular to the direction of the incoming flow velocity d is the cross sectional area of object in general c d and c m are obtained by experiments in this study the empirical values of c d 1 0 and c m 2 0 are used as shown in fig 1 the object is rotating around the axes of t 1 t 2 to form a combined rotational motion which is a common rotating motion of manipulator the o x y z is the base coordinate system of the manipulator a 1 is the angle between the axis of the object and the x o z plane a 2 is that between the axis of the object and the x o y plane the angular velocities of the object rotating around the two axes are ω 1 θ 1 ω 2 θ 2 respectively then the object is divided into several mini segments the direction vectors from one mini segment to the two axes are represented by r 1 r 2 respectively then the velocity and torque are obtained as 4 v ω 1 r 1 ω 2 r 2 ω 1 l cos a 2 ω 2 l 5 t t 1 t 2 1 2 ρ c d 0 l 1 l cos θ 2 ω 1 l cos θ 2 ω 1 l cos θ 2 l ω 2 l ω 2 l d 1 d l ρ c m 0 l 1 l cos θ 2 ω 1 l cos θ 2 ω 1 l sin θ 2 ω 2 l ω 2 l d 1 d 2 d l where l 1 is the length of object d 1 d 2 are the area of axle cross section and direction of flow respectively buoyancy formula is expressed as 6 f g i m l i g v l i ρ g m l i 1 ρ ρ m where m l i is the quality of link i v l i is the effective volume of rigid link i ρ is the water density ρ m is the density of link i 3 adaptive fuzzy sliding mode control 3 1 traditional sliding mode control in order to design the controller more convenient we add the hydrodynamic parameter equation τ d into the interference term f q define the tracking error and the sliding variable as follow 7 e q d q 8 s e λ e where λ d i a g λ 1 λ n λ i 0 and 9 q r q s q d λ e q r q s q d λ e so we can design the traditional sliding mode control as below 10 τ τ ˆ k sgn s τ ˆ m ˆ q r c ˆ q r g ˆ f ˆ a s where m ˆ c ˆ g ˆ f ˆ are the estimated values of m c g f respectively k d i a g k 11 k i i k n n and a d i a g a 1 a i a n are positive definite matrixs substituting 9 into 1 we can figure out 11 m s c a s δ f k sgn s where δ f δ m q r δ c q r δ g δ f δ m m ˆ m δ c c ˆ c δ g g ˆ g δ f f ˆ f assume δ f i δ f i b o u n d and k i i is bound such that 12 k i i δ f i b o u n d define the lyapunov function candidate 13 v 1 2 s t m s differentiating 12 and using 10 11 we can obtain that v s t m s 1 2 s t m s s t c a s δ f k sgn s c s s t a s δ f k sgn s s t δ f k sgn s s t a s i 1 n s i δ f i k i i sgn s s t a s s t a s 0 we can figure out that the lyapunov function is positive definite and its derivatives is negative definite so we can prove the stability of the system 3 2 fuzzy system the results of many studies can show that the fuzzy logic system can approximate any well define nonlinear function accurately so we use the fuzzy gain to solve the chattering of sliding mode control and to adapt the uncertainties disturbances by using singleton fuzzifier product inference and centeraverage defuzzifier strategies the output of fuzzy system can be expressed as 14 y m 1 m θ m i 1 n μ a i m x i m 1 m i 1 n μ a i m x i θ t ψ x where θ θ 1 θ m θ m t ψ x ψ 1 x ψ m x ψ m x t ψ m x i 1 n μ a i m x i m 1 m i 1 n μ a i m x i m is the number of fuzzy rules 3 3 adaptive fuzzy sliding mode control according to the fuzzy logic system and sliding mode control we can design the controller 15 τ m ˆ q r c ˆ q r g ˆ f ˆ a s k where k k 1 k i k n k i is the output of the ith of the fuzzy system if we do not use fuzzy logic system we can define the lyapunov function as follow 16 v 1 2 s t m s so v 1 2 s t m s s t m s s t m s s t c a s δ f k c s s t a s δ f k s t δ f k s t a s i 1 n s i δ f i s i k i s t a s in order to maintain the stability of the system we need to keep the v being negative so we should keep s i k i 0 and ensure s i k i having the same sign on the other hand considering the s i δ f i s i k i when s i is large we should keep k i being large to maintain the stability of the system next we design the fuzzy system which input is s i and output is k i the fuzzy rules can be expressed as follow i f s i i s a i m t h e n k i i s b i m where a i m b i m are the rule bases of input and output respectively see table 1 where n b n s z e p s p b is the five rule bases which denote negative large negative small zero positive small positive large respectively in this paper we select the gauss function as the membership function for fuzzy base fig 2 shows the rule of the gauss function substituting 13 into 10 18 m s c a s δ f k where k i θ k i d t ψ k i s i according to the universal approximation principle there is χ i 0 maintaining 19 δ f i θ k i d t ψ k i s i χ i and we can obtain the adaptive law as below 20 θ k i s i ψ k i s i define lyapunov function v 1 2 s t m s 1 2 i 1 n θ k i t θ k i where θ k i θ k i θ k i d so v 1 2 s t m s s t m s s t m s 1 2 i 1 n θ k i t θ k i θ k i t θ k i 1 2 2 s t m s s t m s i 1 n θ k i t θ k i s t m s c s i 1 n θ k i t θ k i s t c a s δ f k c s i 1 n θ k i t θ k i s t a s δ f k i 1 n θ k i t θ k i s t a s s t δ f k i 1 n θ k i t θ k i s t a s i 1 n s i δ f i k i i 1 n θ k i t θ k i because of k i θ k i t ψ k i s i θ k i d t ψ k i s i v s t a s i 1 n s i δ f i θ k i t ψ k i s i θ k i d t ψ k i s i i 1 n θ k i t θ k i s t a s i 1 n s i δ f i θ k i d t ψ k i s i i 1 n s i θ k i t ψ k i s i θ k i t θ k i s t a s i 1 n s i δ f i θ k i d t ψ k i s i i 1 n θ k i t s i ψ k i s i θ k i t substituting 20 into v we have v s t a s i 1 n s i δ f i θ k i d t ψ k i s i existing a series of positive constants γ i make 19 satisfy δ f i θ k i d t ψ k i s i χ i γ i s i where 0 γ i 1 so s i δ f i θ k i d t ψ k i s i γ i s i 2 γ i s i 2 v s t a s i 1 n γ i s i 2 i 1 n α i s i 2 γ i s i 2 i 1 n γ i α i s i 2 0 where γ d i a g γ 1 γ i γ n α i γ i when s 0 v 0 so the adaptive law will be progressive convergence the same as l i m t s l i m t e λ e 0 l i m t q q d l i m t q q d fig 3 shows the block diagram of the controller 4 simulation results 4 1 impacts of hydrodynamic on manipulator to research the motion effect of hydrodynamics simulation and analysis are conducted based on the underwater manipulator fig 4 shows the structure of manipulator the parametric equations of dynamic model and hydrodynamic model based on the underwater manipulator are described in the appendix numerical analysis and quantitative research are proposed for hydrodynamic analysis of underwater manipulator laying a basis for dynamic compensation and model simplification in the simulation of manipulator control the parameters of each link of the manipulator are shown in table 2 when the manipulator works in the air the influence of the water resistance additional mass force and other disturbance on the joint should not considered in its dynamic equation the torque changes of three joints are obtained by numerical simulation as shown in fig 5 by contrast under the water three joints of the manipulator tend to be affected by additional mass torque water resistance torque and buoyancy torque which will be discussed separately the first is the impact of former torque the second goes to the impact of the last torque the simulation results of above three types of torques are shown in fig 6 it was concluded from the above simulation results that the value of the buoyancy torque is generally 1 3 of the gravity term larger than that of additional mass torque and water resistance torque though having less values than the motion torque of the joints in the air the three types of torques still exerted a great impact on the trajectory tracking simulation next the influence of hydrodynamic torque on the motion of the joints is obtained to facilitate the research the pd control strategy is adopted to control three joints of the underwater manipulator with the desired trajectories of three joints expressed as q d sin π t then motion simulation is carried out fig 7 shows the impacts of the water resistance and additional mass torque on the trajectory tracking of joints fig 8 shows those of the buoyancy torque on the trajectory tracking due to the joint torque coupling of the manipulator and the limitation of pd control the three joints could not rotate along the desired trajectory this problem is not the focus of this section and hence ignored the simulation results indicated the great impact of hydrodynamic on trajectory tracking at the beginning of the simulation the situations of trajectory tracking in two different environments is similar however with the continuation of simulation bigger errors is generated under influence of the hydrodynamics the impact of the buoyancy is more serious than water resistance and additional mass force as a result to offset the influence of hydrodynamic became necessary 4 2 the simulation of fuzzy adaptive sliding mode control combining the control algorithm with the dynamic model of underwater manipulator the simulation is carried out first the desired joint trajectories are expressed as below q d 1 3 cos t 2 sin 3 t q d 2 sin 2 t 2 cos t q d 3 2 cos 2 t sin t where the parameter setting in controller is λ d i a g 15 15 15 the domain setting of fuzzy system is π 4 π 4 the adaptive fuzzy sliding mode control is compared with the traditional sliding mode control to illustrate its superiority the simulation results are shown in figs 9 and 10 presenting the tracking performances of traditional sliding mode control and adaptive fuzzy sliding mode control respectively firstly the performances of the traditional sliding mode control are analyzed joint 1 obtains the best trajectory tracking result of all three joints at the beginning of the simulation the first joint rotates along with the desired trajectory with its actual trajectory almost fitted to the desired trajectory at around 1 5s the range of error is 0 5 nevertheless some disadvantages are found through the simulations of joint 2 and joint 3 in specific although the two joints rotate with the desired trajectory chattering problem still appeared this led to the actual trajectory fluctuating frequently on both sides of the desired trajectory the chattering problem seriously impact on the stability and reliability of the manipulator in contrast the adaptive fuzzy sliding mode control algorithm perform better regarding convergence rate and control precision with the error ranging 0 1 in addition the chattering problem of sliding mode control is eliminated the results of angular velocity tracking for the two controllers are shown in figs 11 and 12 figs 11 and 12 present that actual trajectory obtain better performances under the control of the adaptive fuzzy sliding mode algorithm especially regarding the chattering problem for easy comparison velocity and displacement tracking errors in two controllers are computed by the following equations 21 e d 1 n i 1 n q d i q i 2 r a d 2 22 e v 1 n i 1 n q d i q i 2 r a d 2 where e d and e v are the error of trajectory and velocity tracking respectively q d i and q d i are the desired trajectory and velocity after 1s q i and q i are the actual trajectory and velocity after 1s n is the number of element then the performance of the proposed afsmc has been compared with the control algorithm in reference mohammad et al 2015 to prove the superiority if this algorithm see table 3 it is then concluded that the proposed afsmc exhibited better control efficiency and the ability of solving chattering problem than smc and the control algorithm in reference mohammad et al 2015 in addition the simulation results of end effector on trajectory tracking are shown in fig 13 indicating that control system obtain good control effect and achieve the expected goal in real application see fig 13 5 conclusions this paper proposes a method of dynamic modeling and a modified sliding mode control based on multi link underwater manipulators combining lagrange equation with morison formula a completely dynamic model of underwater manipulator is established to solve chattering problem for sliding mode control and unavailable normalization factor an adaptive fuzzy sliding mode is introduced the simulation results demonstrate great ability of the afsmc algorithm to eliminate the chattering and other disturbances acknowledgement this study was supported by the the fundamental research funds for the central universities of china gk2070260140 appendix water resistance torque t d t d 1 1 2 ρ c d d 0 l x 0 0 v n x v n x d l 1 2 ρ c d d 1 0 l 1 l θ 1 l θ 1 l d l 1 2 ρ c d d 2 0 l 2 l cos θ 2 θ 1 l cos θ 2 θ 1 l cos θ 2 d l 1 2 ρ c d d 3 0 l 3 l 2 cos θ 2 l cos θ 2 θ 3 θ 1 l 2 cos θ 2 l cos θ 2 θ 3 θ 1 l 2 cos θ 2 l cos θ 2 θ 3 d l t d 2 1 2 ρ c d d 2 0 l 2 l θ 2 l θ 2 l d l 1 2 ρ c d d 3 0 l 3 l 2 2 l 2 2 l 2 l cos θ 3 cos β θ 2 l 2 2 l 2 2 l 2 l cos θ 3 θ 2 l 2 2 l 2 2 l 2 l cos θ 3 d l 1 2 ρ c d d 3 0 l 3 l 2 2 l 2 2 l 2 l cos θ 3 cos β θ 3 l θ 3 l d l t d 3 1 2 ρ c d d 3 0 l 3 l θ 3 l θ 3 l d l 1 2 ρ c d d 3 0 l 3 l cos β θ 2 l 2 2 l 2 2 l 2 l cos θ 3 θ 2 l 2 2 l 2 2 l 2 l cos θ 3 d l where β arccos l 2 2 r 3 2 2 l 2 2 l 2 r 3 2 additional mass torque t m t m 1 ρ c m a 0 l x 0 0 d v n x d t d l ρ c m a 1 0 l 1 l θ 1 l d l ρ c m a 2 0 l 2 l cos θ 2 θ 1 l cos θ 2 θ 1 θ 2 l sin θ 2 d l ρ c m a 3 0 l 3 l 2 cos θ 2 l cos θ 2 θ 3 θ 1 l 2 cos θ 2 l cos θ 2 θ 3 θ 1 l 2 sin θ 2 θ 2 l sin θ 2 θ 3 θ 2 θ 3 d l t m 2 ρ c m a 2 0 l 2 l θ 2 l d l ρ c m a 3 0 l 3 l 2 2 l 2 2 l 2 l cos θ 3 cos β θ 3 l d l ρ c m a 3 0 l 3 l 2 2 l 2 2 l 2 l cos θ 3 cos β θ 2 l 2 2 l 2 2 l 2 l cos θ 3 θ 2 l 2 l sin θ 3 θ 3 l 2 2 l 2 2 l 2 l cos θ 3 d l t m 3 ρ c m a 3 0 l 3 l d ω 3 r 3 3 d t d l ρ c m a 3 0 l 3 l d ω 2 r 3 2 d t d l ρ c m a 3 0 l 3 l θ 3 l d l ρ c m a 3 0 l 3 l cos β θ 2 l 2 2 l 2 2 l 2 l cos θ 3 θ 2 l 2 l sin θ 3 θ 3 l 2 2 l 2 2 l 2 l cos θ 3 d l buoyancy force g g 1 0 g 2 a 2 m 2 g c 2 m 3 g a 3 c 23 l 2 c 2 1 ρ ρ m g 3 a 3 m 3 g c 23 1 ρ ρ m 
22643,hydrodynamic behavior of an independent escape capsule from a disabled submarine is a complex six degrees of freedom motion in which added mass effect is strong and variable constraint conditions happen in this paper loosely or weakly coupled scheme is adopted to solve this fluid structure interaction problem flow field is simulated by fluent version 13 0 1 and motion equations are solved by the fourth order runge kutta method separately unstructured dynamic mesh technology is used to trace the trajectory of capsule hydrodynamic force is decomposed into resistance and added mass force and new motion equations are derived in order to handle the huge added mass the surfaces of capsule and its chamber come into contact randomly the variable constraint conditions are analyzed and their corresponding kinematical equations are introduced this loosely coupled scheme is applied to study the hydrodynamic behavior of a two dimensional capsule from a narrow space into an open domain under different ocean currents hydrodynamic force motion characteristics and trajectory are obtained the simulation indicates that the velocity and direction of flow strongly affect the motion of capsule and the contact force leads to the jamming problem of capsule during its ejection process keywords fluid structure interaction hydrodynamic motion added mass effect various constraint conditions independent escape capsule 1 introduction the independent escape capsule plays an important role in rescuing crews when submarine wrecks underwater however research works about hydrodynamic motion of independent escape capsule from its chamber are rarely seen in published literature ascending characteristics of a modular escape capsule after departing from a submerged submarine were discussed through a computer program modsec developed by cadcom inc 1970 zhang et al 2017 studied ejection process of capsule in still water by a numerical simulation platform motion characteristics and trajectory of capsule were obtained the methods used in these two studies are fundamentally dynamic models adopted in ship and autonomous underwater vehicle maneuverability predication abkowitz 1964 gertler and hagen 1967 ogawa and kasai 1978 sayyaadi and ura 1999 fang et al 2008 michalski 2009 the key point is to obtain hydrodynamic force coefficient beforehand and then motion equations are solved fluid structure interaction fsi refers to problems that deal with mutual interaction of fluid flow and a moving or deforming structure naseri et al 2018 so hydrodynamic behavior of capsule during ejection process from its chamber involves fluid structure interaction in order to track real time fluid structure interaction and evolution of flow field loosely couple scheme is widely used a coupled computational fluid dynamic rigid body dynamics cfd rbd model was applied to calculate the fixed axis autorotation of a flat plate hargreaves et al 2014 as well as the aerodynamic behavior of sub launched projectiles sahu and fresconi 2013 silton et al 2015 the open source computational dynamic model reef3d was used to calculate motion characteristics of a vertically falling wedge kamath et al 2017 a numerical simulation platform that combines a hybrid finite volume finite element computational fluid dynamics cfd solver with a nonlinear finite element computational structural dynamics csd solver was adopted to simulate the flapping motion of a fin and joint system chung et al 2018 so in this paper loosely coupled scheme is tried to solve the problem of hydrodynamic motion of capsule from its chamber loosely coupled scheme is not only widely used in problems relating to compressible fluid such as aeroelastic simulation farhat et al 2006 van brummelen 2009 but also applied in incompressible fluid such as water entry of cylinder mnasri et al 2010 however it is found that loosely coupled scheme is unstable for some incompressible flow problem especially when added mass effect is strong coincidently hydrodynamic behavior of capsule is a movement from a narrow space into an open domain in which added mass of capsule is huge in order to simulate fluid structure interaction problem with strong added mass effect some solutions were proposed causin et al 2005 explained the numerical instabilities encountered in the simulation of fluid structure interaction when using loosely coupled scheme and a simulation of blood flow was conducted liu et al 2014 presented a stable second order scheme and its accuracy was validated by numerical experiments on elastic semi circular cylinder problem yvin et al 2018 used a relaxation operator based on an artificial added mass technique to handle the fluid structure interaction problem with large added mass effect for the loosely couple scheme adopted in this paper hydrodynamic force on capsule is decomposed into resistance and added mass force and new motion equations are established with added mass force being added to both sides of motion equations used by 6dof solver in fluent sas ip 2010 furthermore capsule inevitably contacts its chamber during ejection process especially under ocean currents so the ejection problem of capsule also involves variable constraint conditions in which the time of contact and the value of contact force are unpredictable the solutions to contact and collision problems in multibody dynamics should be introduced into this ejection problem eberhard and schiehlen 2006 described contact and collision problems in multibody dynamics featherstone 2008 introduced the numerical algorithms of contact problems for both open and close loop multibody systems in this paper capsule and its chamber are treated as two rigid bodies contact force is consists of normal pressure force and shear force the most simple contact model is adopted which is expressed as any normal pressure force can be transmitted when contact occurs and shear force is equals to friction coefficient times normal pressure force the content of this paper is organized as follows in section 2 the governing equations of the fluid and derivation process of new motion equations considering strong added mass effect are introduced as well as the variable constraint conditions during ejection process of capsule section 3 presents the calculation of added mass of capsule and added mass curves are obtained loosely coupled scheme that adopts new motion equations with consideration of added mass effect is validated in section 4 in section 5 loosely coupled scheme is adopted to investigate the ejection process of capsule inside different chambers under different currents motion characteristics and trajectory of capsule are obtained the major conclusions are presented in section 6 2 numerical model loosely or weakly coupled scheme is applied to solve the dynamic behavior of independent escape capsule consisting of fluid flow interacting with moving rigid body under variable constraint conditions flow field and motion equations are solved separately at each time step flow field simulation provides hydrodynamic force on capsule for the calculation of motion equations the motion characteristics obtained offer boundary conditions for flow field simulation in return fig 1 displays the flow chart of loosely coupled scheme used in this paper two additional procedures the calculation of added mass of capsule and contact force are needed due to the particularity of fluid structure interaction problem of hydrodynamic motion of capsule 2 1 flow field calculation the two dimensional reynolds averaged navier stokes equations for incompressible and homogeneous flow field contain one mass conservation equation and one momentum equation 1 u i x i 0 2 ρ u i t ρ u i u j x i ρ g i p x i x j μ u i x j u j x i x j ρ u i u j where u i is the velocity ρ is density of incompressible fluid ρ 998 2 k g m 3 p is pressure g i is gravitational acceleration μ is dynamic viscous coefficient ρ u i u j is the reynolds stress subscripts i j 1 2 represent x y axes in cartesian coordinates superscripts denote ensemble average of the physical variables dynamic mesh method is applied to trace the position of the independent escape capsule at each time step specifically both spring based smoothing method and local cell remeshing method are adopted when the displacement of the capsule is smaller than mesh size spring based smoothing method treats the connect edges between different nodes as interconnected springs the elastic forces induced by the movements of some nodes are balanced and eventually a new equilibrium position of grid system is obtained at each time step if the displacement exceeds mesh size the smoothing cells can no longer satisfy the skewness or size criteria of the spring based smoothing method those cells are then agglomerated and locally remeshed by local cell remeshing method standard wall functions are used to calculate the variables at near wall cells the standard k epsilon turbulence model is applied for the computation of turbulent flow and equation closure a pressure based solver is adopted to solve governing equations pressure velocity coupling is calculated by simple algorithm second order upwind is used for the spatial discretization of momentum turbulent kinetic energy and turbulent dissipation rate 2 2 motion equations considering strong added mass effect the kinetic equations of six degrees of freedom in capsule fixed coordinate can be expressed as 3a m v x ω y v z ω z v y f x 3b m v y ω z v x ω x v z f y 3c m v z ω x v y ω y v x f z 4a i x ω x i z i y ω y ω z m x 4b i y ω y i x i z ω z ω x m y 4c i z ω z i y i x ω x ω y m z where subscripts x y and z represent the axes in the capsule fixed coordinate m is mass i is inertia moment v and ω are the spatial and angular accelerations respectively v and ω are the spatial and angular velocities respectively f and m are the resultant force and moment on the capsule respectively for the motion in x y plane the equations have three degrees of freedom the motion equations of capsule in x y plane with consideration of fluid structure interaction can be expressed as 5a m v x ω z v y f x f b g f h n 5b m v y ω z v x f y f b g f h n 6 i z ω z m z f b g f h n where force on capsule in the right side of equations is consist of buoyancy f b gravity g hydrodynamic force f h and contact force n fourth order runge kutta method is used to compute those differential equations reserve buoyancy mass and inertia of capsule are easy to obtain it can be seen from eqs 5 and 6 that those three equations contain five unknown variables v x v y ω z f h and n so the key to getting an accurate solution is how to obtain reasonable hydrodynamic force and contact force contact force is discussed in details in the next section capsule undergoes variable accelerated motion during ejection process hydrodynamic force on capsule can be decomposed into resistance f r t and dynamic reaction force f a t 7 f h t f r t f a t 8 f a t λ t a t where λ is added mass so dynamic reaction force is also called added mass force eqs 7 and 8 are substituted into eq 5a the momentum equation in x axis of capsule fixed coordinate at t t δ t is 9 m v x ω z v y t δ t m a x t δ t f b x g x f h x n x f b x g x f r x t δ t λ 11 t δ t a x t δ t n x t δ t eq 9 is the real time kinetic equation of capsule but the equation solved by loosely coupled scheme is 10 m v x ω z v y t δ t m a x l t δ t f b x g x f h x n x f b x g x f r x t δ t λ 11 t δ t a x t n x t δ t where a x l t δ t represents acceleration at t t δ t solved by loosely coupled scheme in order to distinguish it from acceleration a x t δ t computed by eq 9 reserve buoyancy drives capsule to move and capsule undergoes variable acceleration motion with the action of hydrodynamic force its acceleration reduces to zero gradually which means a x t a x t δ t 0 as is known to all added mass λ 11 of capsule in narrow space is much larger than mass of capsule it would lead to a situation that 11 λ 11 t δ t a x t λ 11 t δ t a x t δ t m a x t δ t eqs 9 and 11 are substituted into eq 10 12 m a x l t δ t f b x g x f r x t δ t λ 11 t δ t a x t δ t m a x t δ t n x t δ t 0 it can be seen from eq 12 that hydrodynamic force is larger than reserve buoyancy a x l t δ t solved by loosely coupled scheme is smaller than zero which is inconsistent with physical facts in order to overcome this problem a new motion equation is derived from eq 10 13 m a x l t δ t λ 11 t δ t a x t f b x g x f r x t δ t n x t δ t f b x g x f h x t δ t λ 11 t δ t a x t n x t δ t it is reasonable to assume that a x t a x l t δ t a x t δ t in consideration of little change of acceleration at two consecutive time steps eq 13 changes to 14a m λ 11 t δ t a x l t δ t f b x g x f h x t δ t λ 11 t δ t a x t n x t δ t the derivation process is the same in motion equations along y axis and around z axis of capsule fixed coordinate 14b m λ 22 t δ t a y l t δ t f b y g y f h y t δ t λ 22 t δ t a y t n y t δ t 15 i z λ 66 t δ t ω z l t δ t m b z t δ t m g z t δ t m h z t δ t λ 66 t δ t ω z t m n z t δ t new motion equations of capsule in x y plane are established with consideration of strong added mass effect 2 3 variable constraint conditions kinematical equations of capsule are implemented to obtain contact force three coordinate systems are applied to build kinematical equations of capsule which are earth coordinate o ε η chamber fixed coordinate o x y and capsule fixed coordinate o x y fig 2 displays the possible contact points during the ejection process of independent escape capsule as well as forces on capsule fig 2a b d and e represent the possible situations of one contact point and fig 2c and f displays the situations of two contact points the friction coefficient is set as 0 1 and shear tangential force is equals to the value of normal pressure force times friction coefficient the kinematical conditions of two kinds of contact points in fig 2c are introduced in sequence the constraint condition of contact point p1 can be expressed as if contact occurs capsule can not penetrate the surface of chamber when contact loses or surfaces of capsule and chamber separate contact force reduces to zero 16 point 1 δ x 0 contact occurs or n x 0 contact loses where δ x is the spatial displacement of contact point p1 in chamber fixed coordinate contact force n x is perpendicular to contact surface the spatial displacements of contact point δ x p δ y p t in chamber fixed coordinate can be obtained through coordinate transformation 17 δ x p δ y p t t c o δ x δ y t δ x o δ y o t 18 t c o cos θ sin θ sin θ cos θ where δ x and δ y are the spatial displacements of contact point in two axial directions of capsule fixed coordinate δ x o and δ y o are the spatial displacements of origin of capsule fixed coordinate which is also reference point of capsule the coordinate transformation matrix from the capsule fixed coordinate to the chamber fixed coordinate is t c o θ is rotational displacement of capsule the velocity vector v p of contact point in capsule fixed coordinate can be obtained through the rotational velocity vector ω of reference point o and their relative position vector o p 19 v p v p x v p y t ω o p 0 0 ω z t x o p y o p 0 t 20a δ x v p x δ t 0 5 v p x δ t 2 ω z y o p δ t 0 5 ω z y o p δ t 2 20b δ y v p y δ t 0 5 v p y δ t 2 ω z x o p δ t 0 5 ω z x o p δ t 2 21a δ x o v o x δ t 0 5 v o x δ t 2 v x δ t 0 5 v x δ t 2 21b δ y o v o y δ t 0 5 v o y δ t 2 v y δ t 0 5 v y δ t 2 where δ t is time step v p x and v p y are velocity components of contact point in capsule fixed coordinate v p x and v p y are the corresponding accelerations of contact point 22 δ x p ω z y o p δ t 0 5 ω z y o p δ t 2 cos θ v x δ t 0 5 v x δ t 2 cos θ ω z x o p δ t 0 5 ω z x o p δ t 2 sin θ v y δ t 0 5 v y δ t 2 sin θ some parameters are defined as k 1 0 5 δ t 2 cos θ k 2 0 5 δ t 2 sin θ k 3 0 5 δ t 2 x o p sin θ y o p cos θ c c 1 ω z y o p δ t cos θ v x δ t cos θ ω z x o p δ t sin θ v y δ t sin θ then eq 22 is rearranged 23 δ x p k 1 v x k 2 v y k 3 ω z c c 1 0 the constraint condition of contact point p2 can be expressed as if contact occurs capsule goes through point c when contact loses contact force reduces to zero 24 point 2 x p y p t x c y c t contact occurs or n x 0 contact loses where x p y p t and x c y c t are the positions of two contact points p2 on capsule and c on chamber in chamber fixed coordinate n x is contact force in capsule fixed coordinate the equation of line connecting two points pt and pb is 25 a t x b t y c t 0 x p y p t x c y c t is substituted into eq 25 26 a t x c b t y c c t 0 at two consecutive time steps t and t δ t 27 x p t y p t t δ t t x p t y p t t t δ x p t δ y p t t 28 x p b y p b t δ t t x p b y p b t t δ x p b δ y p b t 29 a t δ t y p t t δ t y p b t δ t a t δ y p t δ y p b 30 b t δ t x p t t δ t x p b t δ t b t δ x p t δ x p b 31 c t δ t a t δ t x p t t δ t b t δ t y p t t δ t eqs 27 31 are substituted into eq 26 32 a t δ y p t δ y p b x c x p t t δ x p t b t δ x p t δ x p b y c y p t t δ y p t 0 δ x p t δ x p b δ y p t δ y p b can be obtained from eq 17 33 δ x p t 0 5 δ t 2 cos θ v x 0 5 δ t 2 sin θ v y 0 5 δ t 2 x p t sin θ y p t cos θ ω z ω z y p t δ t cos θ v x δ t cos θ ω z x p t δ t sin θ v y δ t sin θ 34 δ y p t 0 5 δ t 2 sin θ v x 0 5 δ t 2 cos θ v y 0 5 δ t 2 y p t sin θ x p t cos θ ω z ω z y p t δ t sin θ v x δ t sin θ ω z x p t δ t cos θ v y δ t cos θ 35 δ y p t δ y p b y p t y p b ω z δ t 0 5 ω z δ t 2 cos θ 36 δ x p t δ x p b y p t y p b ω z δ t 0 5 ω z δ t 2 sin θ some parameters are defined as e 0 x c x p t t e 1 y c y p t t k 4 0 5 δ t 2 x p t sin θ y p t cos θ k 5 0 5 δ t 2 y p t sin θ x p t cos θ c c 2 ω z y p t δ t cos θ v x δ t cos θ ω z x p t δ t sin θ v y δ t sin θ c c 3 ω z y p t δ t sin θ v x δ t sin θ ω z x p t δ t cos θ v y δ t cos θ then eq 32 is rearranged 37 a t y p t y p b ω z δ t 0 5 ω z δ t 2 cos θ e 0 k 1 v x k 2 v y k 4 ω z c c 2 b t y p t y p b ω z δ t 0 5 ω z δ t 2 sin θ e 1 k 2 v x k 1 v y k 5 ω z c c 3 0 neglecting o δ t 4 and set n e 0 a t e 0 y p t y p b ω z δ t sin θ e 1 b t e 1 y p t y p b ω z δ t cos θ c c 2 a t c c 2 y p t y p b ω z δ t sin θ c c 3 b t c c 3 y p t y p b ω z δ t cos θ m 1 k 1 a t k 2 b t m 2 k 2 a t k 1 a t 0 5 δ t 2 y p t y p b ω z δ t m 3 0 5 δ t 2 y p t y p b e 0 sin θ e 1 cos θ x p t ω z δ t c c 2 sin θ c c 3 cos θ k 4 a t k 5 b t then eq 37 changes to 38 m 1 v x m 2 v y m 3 ω z n 0 3 added mass calculation ejection process of an independent escape capsule from the disabled submarine is a movement from a narrow space into an open flow field an independent escape capsule is commonly a symmetrical structure if ocean currents are in its symmetrical plane hydrodynamic motion of the capsule is also in this plane two dimensional simulation is implemented in consideration of the plane motion of capsule as well as computation resources the descriptions of physical model and computational domain are shown in fig 3 the capsule is a finite cylinder with two hemi ellipsoidal end caps the height h and outside diameter d of capsule are 2 5 m and 0 5 m respectively the lengths of major axis a and minor axis b of ellipsoid are 0 5 m and 0 25 m respectively the actual inside diameter of chamber is 0 56 m but its breadth b1 in the two dimensional computation domain is set as 0 6 m in order to avoid negative cell volume when contact occurs the additional 0 04 m 0 02 m in each side is used to guarantee that there are at least three layers of cells between surfaces of capsule and its chamber by which reasonable flow field can be obtained the density of capsule is 930 95 kg m3 the top bottom and lateral surfaces of computational domain are set as non slip wall boundary condition hybrid mesh method is applied to discrete the flow field unstructured triangular meshes are in the dynamic zone around capsule and structured quadrilateral meshes are formed outside the dynamic zone interface is applied in the overlapping edges between unstructured and structured meshes for flow data transmission in consideration of standard wall functions and standard k epsilon turbulence model used in flow field calculation the value of y ranges from 30 to 300 in order to capture the boundary layer development sas ip 2010 pan and kinnas 2011 sun et al 2015 the height of first layer of mesh around capsule is set as 4 mm yvin et al 2018 pointed out that added mass depends on the spatial configuration such as confinement when the fluid domain is not infinite one of the main techniques to eliminate the instability and non convergent problem included by the added mass effect is the artificial added mass method förster et al 2007 dunbar et al 2015 yvin et al 2018 and the simulation indicated that a good convergence behavior would be obtained if the artificial added mass is close to the physical added mass in loosely coupled scheme the computation of added mass is always performed once before simulation or at different times if necessary in this paper the shape of flow field changes as the movement of capsule which leads to variable physical added masses the calculation of those real time physical added masses of the capsule during ejection process is a heavy work and impossible the main changes of flow field are induced by the movement of the capsule in its axis direction y axis in fig 3 and are considered to approach the physical added mass of the capsule at different positions during the ejection process fig 4 illustrates the flow fields of capsule at four different positions y0 0 m y0 0 2 m y0 2 4 m and y0 2 6 m added masses of three different degrees of freedom two translational added masses in x and y axes and one rotational added mass around z axis are calculated user defined function udf in fluent is applied to define the movement of capsule v x t v y t or ω z t which means that capsule undergoes uniformly accelerated motion spring based smoothing and local cell remeshing methods are adopted to update mesh time step δt 0 001s is chosen in this grid system seen in fig 3c in order to make sure that cell courant number is less than 1 the stability and convergence of simulation are satisfactory added mass is the mass of fluid that accelerated with the capsule fig 4 gives the corresponding velocity contour around the capsule at four different positions in three different degrees of freedom it can be seen that the velocity of flow in calculation of added mass along x axis seen in fig 4a is the largest which is followed by that around z axis seen in fig 4c and the velocity of fluid along y axis seen in fig 4b is the smallest the fluid around top cap spreads around as capsule departs from chamber gradually from y0 0 m in left to y0 2 6 m in right and the velocity of fluid falls with the decrease of the blockage effect of chamber fig 5 a c and e show hydrodynamic force curves of the capsule at four different positions in calculation of its added masses λ11 λ22 and λ66 respectively the value of hydrodynamic force converges within 20 iterations hydrodynamic force f h on the capsule is divided into resistance f r and added mass force f a according to eq 7 the steady component resistance could be omitted due to the negligible speed of the capsule such as v x max 0 02 m s zhang et al 2017 validated this method by calculating the added mass of a sphere so the added masses of the capsule could be obtained by λ 11 f h x a x λ 22 f h y a y λ 66 m h z ω z defining c the ratio between the added mass and its mass 39 c 11 λ 11 m c 22 λ 11 m c 66 λ 66 i z where the mass m and inertia i z of capsule are 1138 715 kg and 616 417 kg m2 respectively table 1 lists the ratios in three degrees of freedom fitting method is adopted to form the ratio curves of capsule seen in fig 5b d and f the corresponding fitting formulas are 40 c 11 y 0 47 025 24 812 y 0 0 y 0 0 2 10 942 y 0 2 43 808 y 0 50 387 0 2 y 0 1 2 22 101 7 107 y 0 1 2 y 0 1 8 13 915 2 558 y 0 1 8 y 0 2 6 7 263 2 6 y 0 41 c 22 y 0 5 377 0 682 y 0 0 y 0 0 2 5 658 2 089 y 0 0 2 y 0 2 4 3 201 1 064 y 0 2 4 y 0 2 686 0 341 2 686 y 0 42 c 66 y 0 9 204 5 896 y 0 0 y 0 0 4 7 096 0 626 y 0 0 4 y 0 1 1 11 464 4 596 y 0 1 1 y 0 2 0 4 272 1 000 y 0 2 0 y 0 2 6 1 671 2 6 y 0 4 validation of loosely coupled scheme considering added mass effect in this section the convergence and accuracy of results by new motion equations considering added mass effect proposed in section 2 2 are introduced through comparative studies with the numerical simulation results of a free floating capsule and experimental data of a free falling sphere respectively 4 1 convergence hydrodynamic behavior of a free floating capsule in still water is simulated through new motion equations proposed in section 2 2 and 6dof solver in fluent respectively sas ip 2010 introduced the details of 6dof solver in fluent in which the translational and angular motions of an object were solved by eqs 3 and 4 without considering the added mass effect computational domain and boundary conditions of the free floating capsule refer to fig 3 the capsule undergoes translational motion in y axis under reserve buoyancy without action of ocean currents the added mass calculation results in table 1 indicate that the maximum ratio c22 of added mass and mass of capsule in y axis is over 5 the added mass effect of this free floating capsule inside its chamber is strong firstly three different mesh densities and three different time steps are tested for the simulation using new motion equations the coarse medium and fine meshes are made up of 51 504 177 064 and 660 217 cells respectively the medium mesh is presented in fig 3c three different time steps are 0 01s 0 001s and 0 0005s respectively the simulation results in fig 6 indicate that the displacement is sensitive to mesh density and time step the medium and fine meshes produce similar values and time step of 0 001s approaches the convergence results then the same mesh densities and time steps are adopted in the numerical simulation by 6dof solver in fluent the results are unstable and divergent fig 7 gives the acceleration and displacement of the capsule obtained by 6dof solver in fluent using medium mesh and time step 0 001s as well as those by new motion equations the figure has double x axes and double y axes in which red and black curves represent results obtained by 6dof solver and new motion equations respectively fig 7a shows that the red acceleration curve obtained by 6dof solver oscillates between positive and negative values the value of the acceleration soars to 60000m s2 at t 0 007s which means it diverges rapidly within 7 iterations besides the red displacement curve in fig 7b indicates that the capsule moves upward and downward along its y direction at two consecutive time steps this phenomenon is inconsistent with physical facts while the simulation results shown by black curves are of good convergence the black acceleration curve seen in fig 7a decreases from 0 1m s2 at t 0s to nearly 0m s2 at about t 7s then it increases slowly to about 0 01m s2 at t 9s a sudden drop from 0 01m s2 at t 9s to 0 166m s2 at t 9 6s is seen which is followed by a sharp increase to 0 400m s2 at t 10s at last the acceleration of capsule decreases again and at the meantime the capsule departs from chamber and its displacement is larger than 2 5 m seen in fig 7b the comparative study of vertical ejection process of capsule in still water indicates that new proposed motion equations could solve the divergence problem of the 6dof solver in simulating the fluid structure interaction problem with strong added mass effect 4 2 accuracy accuracy of numerical simulation results by new motion equations is introduced through comparing to experimental data of a free falling sphere fackrell 2011 the diameter of sphere is d 0 0254 m the mass is 0 01912 kg it undergoes free falling motion under negative reserve buoyancy in still water three dimensional simulation is implemented as shown in fig 8 computational domain is a cube with dimensions of 0 3 m by 0 3 m by 0 38 m sphere is suspended at 4 5 diameters below the top surface of domain the surfaces of domain are set as non slip wall boundary condition hybrid mesh method is applied to discrete computational domain unstructured tetrahedron meshes are formed inside dynamic zone and structured hexahedron meshes are outside dynamic zone interface is set in their overlapping surfaces for flow data transmission three different mesh densities and three different time steps are studied for the simulation using new motion equations the coarse medium and fine meshes are made up of about 0 504 1 494 and 2 055 millions cells respectively the medium mesh is presented in fig 8b the first mesh height around sphere is 1 mm which satisfies the requirement of y time steps are 0 002s 0 001s and 0 0005s respectively added mass of a sphere derived through potential flow theory is half mass of its displaced fluid sarpkaya and issacson 1981 this value is adopted in new proposed motion equations fig 9 shows acceleration curve of the sphere with respect to non dimensional displacement z d where d is the diameter of sphere the simulation results are sensitive to mesh density and time step the calculation results obtained by the coarse and medium meshes or time steps of 0 002s and 0 001s have some spikes stable and convergence acceleration curves are obtained with denser mesh and smaller time step acceleration of the capsule decreases during free fall in still water the numerical simulation results fit well with experimental data especially after z d 0 6 5 hydrodynamic motion of capsule under variable constraint conditions ejection process of an independent escape capsule from the disabled submarine under ocean currents is a more common hydrodynamic behavior in engineering application rather than its movement in still water the lateral force of ocean currents inevitable affects the movement of capsule it rotates the capsule during its ejection process and leads to the contact of capsule and its chamber this contact behavior is random which means the chamber provides variable constraint conditions for the ejected capsule the fluid structure interaction problem under variable constraint conditions is studied here as well as the application of new proposed motion equations to the three degrees of freedom plane movement the loosely coupled scheme considering strong added mass effect is validated by introducing experimental data of a free floating sphere in still water above so the numerical verifications of the ejected capsule under variable constraint conditions by the proposed loosely coupled scheme are introduced through mesh and time step sensitive studies firstly then vertical ejection process of capsule in two different ocean currents is discussed at last ejection process of capsule at a different angle 45 is introduced this case represents the ejection performance of capsule inside a disabled submarine that its hovering attitude is hard to maintain 5 1 sensitive study the hydrodynamic motion of vertically ejected capsule under ocean currents 0 5144 m s is studied the computational domain and boundary conditions are shown in fig 10 a boundary conditions of velocity inlet pressure outlet and non slip wall are applied in the simulation a funnel shaped dynamic zone is applied in order to avoid negative cell volume when capsule rotates under the action of current force unstructured triangular meshes are formed in the dynamic zone around capsule and structured quadrilateral meshes are used outside the dynamic zone interface is applied in the overlapping edges between unstructured and structured meshes for flow data transmission numerical simulations are performed by using three different mesh densities and three different time steps the coarse medium and fine meshes contain 91 441 307 661 and 1 258 242 cells respectively fig 10b displays medium meshes around two end caps of capsule three different time steps are 0 002s 0 001s and 0 0005s respectively before the simulation of hydrodynamic behavior of capsule a reasonable initial flow field is needed the transient calculation of initial flow field with capsule keeping still is applied fig 11 gives the stable initial flow field details of capsule under ocean currents 0 5144 m s using medium mesh the pressure on the right surface of capsule is larger than that on the left surface of capsule some eddy is seen around top cap of capsule from the velocity vector detail hydrodynamic force is obtained by the integral of pressure on the surface of capsule the hydrodynamic force curves are given in fig 12 it shows that hydrodynamic force components convergence to stable values at the end of calculation negative component means flow exerts an opposing force in its corresponding axis in earth coordinate the negative lateral force fε is in the opposite direction of ocean currents the lift force fη is slightly larger than 0 which helps pulse capsule out of its chamber moment m rotates capsule around z axis loosely coupled scheme is implemented after the initial flow field is obtained at each time step flow field is calculated firstly hydrodynamic force obtained is substituted into the new proposed motion equations considering huge added mass of the capsule obtained in section 3 the trajectory of capsule is computed through coordinate transformation between three different coordinate systems earth coordinate chamber fixed coordinate and capsule fixed coordinate as seen in fig 10a the trajectory in chamber fixed coordinate is applied to judge whether contact occurs or not then the mathematic expressions for constraint condition eq 23 and 38 are used to calculate the contact force finally fourth order runge kutta method is used to calculate those differential equations in x y plane the obtained motion characteristics provide boundary conditions of flow calculation in return at next time step simulations of vertically ejected process of capsule under ocean currents 0 5144 m s are performed and the results are compared as shown in fig 13 the displacements obtained by the loosely coupled scheme are convergent with increasing mesh densities fig 13a and decreasing time step fig 13b with small differences between solutions by medium and fine meshes or time steps of 0 001s and 0 0005s the medium mesh and time step of 0 001s produce convergent solutions thereby be applied in the following studies 5 2 vertical ejection under ocean currents 90 another velocity 0 3 m s of ocean currents is studied by the verified loosely coupled scheme fig 14 gives hydrodynamic force on capsule during vertical ejection process hydrodynamic force can be divided into lateral force fh ε lift force fh η and moment mh the lateral force fluctuates at the beginning of calculation this unstable results are caused by the strong added mass effect which can be seen from table 1 that ratios of added mass and mass of capsule in x axis is over 40 when y0 0 2 m lateral force at most time steps are larger than zero which is consistent with the direction of currents negative lift force hinders the vertically ejected movement of capsule and negative moment rotates capsule around z axis the severe oscillation of hydrodynamic force is seen when the sudden changes of velocity of the capsule happens hydrodynamic force hinders the change of motion states of capsule when contact occurs fig 15 compares motion characteristics of vertically ejected capsule under two different ocean currents 0 5144 m s and 0 3 m s vε and vη are translational velocities of reference point of capsule o as seen in fig 10a in earth coordinate ε η and θ are its corresponding spatial displacements vε fluctuates around zero vη increases gradually with some sudden decreases when the value of vη falls into zero it is recognized that capsule gets stuck in its chamber and the calculation ceases ε is smaller than zero from t 0 5s to about t 2s then it increases with time under ocean currents 0 5144 m s despite of some fluctuations while ε under ocean currents 0 3 m s increases until t 5s which is followed by oscillations between 0 03 m and 0 03 m η increases nonlinearly the maximum η jamming length under ocean currents 0 5144 m s is 1 257 m and that under ocean currents 0 3 m s is 1 601 m θ from t 0 5s to t 5s under two ocean currents shows similar decreasing trend after that θ fluctuates its value under ocean currents 0 5144 m s is smaller than zero while its value under ocean currents 0 3 m s changes between positive and negative numbers several times these changes mean that the attitudes of capsule under different current velocities are different during ejection process which can be also seen in fig 16 fig 16a shows the positions of capsule under ocean currents 0 5144 m s when contact occurs the times that contact occurs are consistent with inflection points of rotational displacement curve in fig 15c some different contact positions under currents 0 3 m s are chosen to shown in fig 16b it is clear that the attitude of capsule under currents 0 5144 m s keeps similar with various inclined angle during whole ejection process while capsule under smaller current velocity 0 3 m s bounces back and forth inside chamber this indicates that current force 0 5144 m s rapidly remove the action of contact force while contact force affects the movement of capsule more under current 0 3 m s 5 3 ejection process of capsule inside a disable submarine 45 the effect of two different flow velocities on vertically ejected capsule is discussed above however the upright floating hovering attitude is hard to maintain when a submarine wrecks so this section studies hydrodynamic behavior of capsule under different directions of currents the description of an ejected capsule inside an inclined chamber under ocean currents is shown in fig 17 a the inclined angle 45 of chamber is expressed by the angle between earth coordinate o ε η and chamber fixed coordinate o x y consequently two different current directions are calculated which are 135 and 45 respectively the current direction is expressed by the angle between y axis in capsule fixed coordinate and flow velocity the current velocity is 0 5144 m s the computational domain and boundary conditions are also shown in fig 17a fig 17b gives medium meshes around two end caps of capsule fig 18 gives hydrodynamic force on capsule inside an inclined chamber during its ejection process it can be seen that hydrodynamic force on capsule oscillates frequently from t 4 2s to t 6s under currents 135 and from t 3 2s to t 6 5s under currents 45 which indicates that capsule contacts with its chamber during these times it is also noted that although currents flow from left to right moment on capsule under currents 135 from t 0 5s to t 3 503s has positive value so rotational displacement of capsule is larger than zero as shown in fig 19 c fig 19 gives motion characteristics of ejected capsule inside a chamber with inclined angle of 45 under ocean currents 135 and 45 vε and vη are translational velocities of reference point of capsule o as seen in fig 17a in earth coordinate ε η and θ are its corresponding spatial displacements it is commonly recognized that capsule in an inclined chamber would float vertically at beginning with vε and ε equals to zero however it is can be seen from fig 19 that vε and ε have values as big as vη and η this is because that added mass of capsule in x axis is much larger than that in y axis as seen in table 1 and then the movement of capsule in x axis induced by the component of reserve buoyancy along x axis is pretty smaller capsule in an inclined chamber undergoes movement along its y axis as vertically ejected capsule does vε vη and ε η can be obtained from vx vy and x y through matrix transformation between capsule fixed coordinate and earth coordinate vε and vη increase with some fluctuations induced by contact force vη is larger than zero which indicates that capsule move upwards vε is smaller than zero which indicates that capsule moves along ε axis different from calculation of vertical ejection process of capsule only if both vε and vη fall into zero it is recognized that capsule in an inclined chamber gets stuck and the calculation ceases so the calculation carries on at about t 7 5s in fig 19a and t 7 6s in fig 19b ε and η increase nonlinearly with time the maximum ε and η jamming lengths under currents 135 are 0 901 m and 0 889 m which are smaller than the maximum ε 1 357 m and η 1 288 m of capsule under currents 45 respectively θ of capsule under currents 135 increases from 0 rad at t 0 5s to 0 0139 rad at t 2 337s then it shows a decreasing trend with big oscillations after 7s θ of capsule under currents 45 decreases from 0 rad at t 0 5s to 0 005 rad at t 1 588s which followed by an increase to 0 008 rad at t 2 344s then it shows a decreasing trend with big oscillations after 6 5s due to contact force fig 20 compares some positions of capsule inside an inclined chamber under ocean currents 135 and 45 when contact occurs capsule bounces back and force inside the inclined chamber during ejection process capsule under currents 45 has larger rotational displacement than that under currents 135 6 conclusions fluid structure interaction and multibody dynamics are involved in the ejection problem of independent escape capsule from a disabled submarine under ocean currents which is an interdisciplinary subject the present contribution is concerned with the proposed loosely coupled scheme for this fsi problem udf in the fluent is applied for secondary development in which new motion equations with consideration of strong added mass effect and variable constraint conditions are implemented flow field is calculated by fluent and motion characteristics are solved by udf separately at each time step unstructured dynamic mesh technology is used to update mesh firstly this loosely coupled scheme is applied to study the vertical ejection process of a two dimensional capsule from a narrow space into an open domain under two different ocean currents 0 5144 m s and 0 3 m s then hydrodynamic motion of the capsule inside a inclined chamber under two different currents 135 and 45 is calculated hydrodynamic force motion characteristics and trajectory are obtained capsule bounces back and forth inside its chamber during ejection process comparative analyses indicate that the velocity and direction of flow strongly affect the movement of capsule and the contact force leads to the jamming problem during the ejection process of capsule the jamming length of capsule under currents 0 5144 m s is shorter than that under currents 0 3 m s the jamming length of capsule under ocean 135 is smaller than that under currents 45 this presented loosely coupled scheme could be easily extended to calculate the ejection process of any three dimensional capsule from a disabled submarine only requiring larger computation sources in the future we plan to implement model test of the ejected capsule to validate the accuracy of the convergent solutions obtained by the loosely coupled scheme considering variable constraint conditions during its ejection process acknowledgement the authors gratefully acknowledge the financial support from the national natural science foundation of china nsfc under project number 51679097 and the china postdoctoral science foundation under project number 2019m652650 
22643,hydrodynamic behavior of an independent escape capsule from a disabled submarine is a complex six degrees of freedom motion in which added mass effect is strong and variable constraint conditions happen in this paper loosely or weakly coupled scheme is adopted to solve this fluid structure interaction problem flow field is simulated by fluent version 13 0 1 and motion equations are solved by the fourth order runge kutta method separately unstructured dynamic mesh technology is used to trace the trajectory of capsule hydrodynamic force is decomposed into resistance and added mass force and new motion equations are derived in order to handle the huge added mass the surfaces of capsule and its chamber come into contact randomly the variable constraint conditions are analyzed and their corresponding kinematical equations are introduced this loosely coupled scheme is applied to study the hydrodynamic behavior of a two dimensional capsule from a narrow space into an open domain under different ocean currents hydrodynamic force motion characteristics and trajectory are obtained the simulation indicates that the velocity and direction of flow strongly affect the motion of capsule and the contact force leads to the jamming problem of capsule during its ejection process keywords fluid structure interaction hydrodynamic motion added mass effect various constraint conditions independent escape capsule 1 introduction the independent escape capsule plays an important role in rescuing crews when submarine wrecks underwater however research works about hydrodynamic motion of independent escape capsule from its chamber are rarely seen in published literature ascending characteristics of a modular escape capsule after departing from a submerged submarine were discussed through a computer program modsec developed by cadcom inc 1970 zhang et al 2017 studied ejection process of capsule in still water by a numerical simulation platform motion characteristics and trajectory of capsule were obtained the methods used in these two studies are fundamentally dynamic models adopted in ship and autonomous underwater vehicle maneuverability predication abkowitz 1964 gertler and hagen 1967 ogawa and kasai 1978 sayyaadi and ura 1999 fang et al 2008 michalski 2009 the key point is to obtain hydrodynamic force coefficient beforehand and then motion equations are solved fluid structure interaction fsi refers to problems that deal with mutual interaction of fluid flow and a moving or deforming structure naseri et al 2018 so hydrodynamic behavior of capsule during ejection process from its chamber involves fluid structure interaction in order to track real time fluid structure interaction and evolution of flow field loosely couple scheme is widely used a coupled computational fluid dynamic rigid body dynamics cfd rbd model was applied to calculate the fixed axis autorotation of a flat plate hargreaves et al 2014 as well as the aerodynamic behavior of sub launched projectiles sahu and fresconi 2013 silton et al 2015 the open source computational dynamic model reef3d was used to calculate motion characteristics of a vertically falling wedge kamath et al 2017 a numerical simulation platform that combines a hybrid finite volume finite element computational fluid dynamics cfd solver with a nonlinear finite element computational structural dynamics csd solver was adopted to simulate the flapping motion of a fin and joint system chung et al 2018 so in this paper loosely coupled scheme is tried to solve the problem of hydrodynamic motion of capsule from its chamber loosely coupled scheme is not only widely used in problems relating to compressible fluid such as aeroelastic simulation farhat et al 2006 van brummelen 2009 but also applied in incompressible fluid such as water entry of cylinder mnasri et al 2010 however it is found that loosely coupled scheme is unstable for some incompressible flow problem especially when added mass effect is strong coincidently hydrodynamic behavior of capsule is a movement from a narrow space into an open domain in which added mass of capsule is huge in order to simulate fluid structure interaction problem with strong added mass effect some solutions were proposed causin et al 2005 explained the numerical instabilities encountered in the simulation of fluid structure interaction when using loosely coupled scheme and a simulation of blood flow was conducted liu et al 2014 presented a stable second order scheme and its accuracy was validated by numerical experiments on elastic semi circular cylinder problem yvin et al 2018 used a relaxation operator based on an artificial added mass technique to handle the fluid structure interaction problem with large added mass effect for the loosely couple scheme adopted in this paper hydrodynamic force on capsule is decomposed into resistance and added mass force and new motion equations are established with added mass force being added to both sides of motion equations used by 6dof solver in fluent sas ip 2010 furthermore capsule inevitably contacts its chamber during ejection process especially under ocean currents so the ejection problem of capsule also involves variable constraint conditions in which the time of contact and the value of contact force are unpredictable the solutions to contact and collision problems in multibody dynamics should be introduced into this ejection problem eberhard and schiehlen 2006 described contact and collision problems in multibody dynamics featherstone 2008 introduced the numerical algorithms of contact problems for both open and close loop multibody systems in this paper capsule and its chamber are treated as two rigid bodies contact force is consists of normal pressure force and shear force the most simple contact model is adopted which is expressed as any normal pressure force can be transmitted when contact occurs and shear force is equals to friction coefficient times normal pressure force the content of this paper is organized as follows in section 2 the governing equations of the fluid and derivation process of new motion equations considering strong added mass effect are introduced as well as the variable constraint conditions during ejection process of capsule section 3 presents the calculation of added mass of capsule and added mass curves are obtained loosely coupled scheme that adopts new motion equations with consideration of added mass effect is validated in section 4 in section 5 loosely coupled scheme is adopted to investigate the ejection process of capsule inside different chambers under different currents motion characteristics and trajectory of capsule are obtained the major conclusions are presented in section 6 2 numerical model loosely or weakly coupled scheme is applied to solve the dynamic behavior of independent escape capsule consisting of fluid flow interacting with moving rigid body under variable constraint conditions flow field and motion equations are solved separately at each time step flow field simulation provides hydrodynamic force on capsule for the calculation of motion equations the motion characteristics obtained offer boundary conditions for flow field simulation in return fig 1 displays the flow chart of loosely coupled scheme used in this paper two additional procedures the calculation of added mass of capsule and contact force are needed due to the particularity of fluid structure interaction problem of hydrodynamic motion of capsule 2 1 flow field calculation the two dimensional reynolds averaged navier stokes equations for incompressible and homogeneous flow field contain one mass conservation equation and one momentum equation 1 u i x i 0 2 ρ u i t ρ u i u j x i ρ g i p x i x j μ u i x j u j x i x j ρ u i u j where u i is the velocity ρ is density of incompressible fluid ρ 998 2 k g m 3 p is pressure g i is gravitational acceleration μ is dynamic viscous coefficient ρ u i u j is the reynolds stress subscripts i j 1 2 represent x y axes in cartesian coordinates superscripts denote ensemble average of the physical variables dynamic mesh method is applied to trace the position of the independent escape capsule at each time step specifically both spring based smoothing method and local cell remeshing method are adopted when the displacement of the capsule is smaller than mesh size spring based smoothing method treats the connect edges between different nodes as interconnected springs the elastic forces induced by the movements of some nodes are balanced and eventually a new equilibrium position of grid system is obtained at each time step if the displacement exceeds mesh size the smoothing cells can no longer satisfy the skewness or size criteria of the spring based smoothing method those cells are then agglomerated and locally remeshed by local cell remeshing method standard wall functions are used to calculate the variables at near wall cells the standard k epsilon turbulence model is applied for the computation of turbulent flow and equation closure a pressure based solver is adopted to solve governing equations pressure velocity coupling is calculated by simple algorithm second order upwind is used for the spatial discretization of momentum turbulent kinetic energy and turbulent dissipation rate 2 2 motion equations considering strong added mass effect the kinetic equations of six degrees of freedom in capsule fixed coordinate can be expressed as 3a m v x ω y v z ω z v y f x 3b m v y ω z v x ω x v z f y 3c m v z ω x v y ω y v x f z 4a i x ω x i z i y ω y ω z m x 4b i y ω y i x i z ω z ω x m y 4c i z ω z i y i x ω x ω y m z where subscripts x y and z represent the axes in the capsule fixed coordinate m is mass i is inertia moment v and ω are the spatial and angular accelerations respectively v and ω are the spatial and angular velocities respectively f and m are the resultant force and moment on the capsule respectively for the motion in x y plane the equations have three degrees of freedom the motion equations of capsule in x y plane with consideration of fluid structure interaction can be expressed as 5a m v x ω z v y f x f b g f h n 5b m v y ω z v x f y f b g f h n 6 i z ω z m z f b g f h n where force on capsule in the right side of equations is consist of buoyancy f b gravity g hydrodynamic force f h and contact force n fourth order runge kutta method is used to compute those differential equations reserve buoyancy mass and inertia of capsule are easy to obtain it can be seen from eqs 5 and 6 that those three equations contain five unknown variables v x v y ω z f h and n so the key to getting an accurate solution is how to obtain reasonable hydrodynamic force and contact force contact force is discussed in details in the next section capsule undergoes variable accelerated motion during ejection process hydrodynamic force on capsule can be decomposed into resistance f r t and dynamic reaction force f a t 7 f h t f r t f a t 8 f a t λ t a t where λ is added mass so dynamic reaction force is also called added mass force eqs 7 and 8 are substituted into eq 5a the momentum equation in x axis of capsule fixed coordinate at t t δ t is 9 m v x ω z v y t δ t m a x t δ t f b x g x f h x n x f b x g x f r x t δ t λ 11 t δ t a x t δ t n x t δ t eq 9 is the real time kinetic equation of capsule but the equation solved by loosely coupled scheme is 10 m v x ω z v y t δ t m a x l t δ t f b x g x f h x n x f b x g x f r x t δ t λ 11 t δ t a x t n x t δ t where a x l t δ t represents acceleration at t t δ t solved by loosely coupled scheme in order to distinguish it from acceleration a x t δ t computed by eq 9 reserve buoyancy drives capsule to move and capsule undergoes variable acceleration motion with the action of hydrodynamic force its acceleration reduces to zero gradually which means a x t a x t δ t 0 as is known to all added mass λ 11 of capsule in narrow space is much larger than mass of capsule it would lead to a situation that 11 λ 11 t δ t a x t λ 11 t δ t a x t δ t m a x t δ t eqs 9 and 11 are substituted into eq 10 12 m a x l t δ t f b x g x f r x t δ t λ 11 t δ t a x t δ t m a x t δ t n x t δ t 0 it can be seen from eq 12 that hydrodynamic force is larger than reserve buoyancy a x l t δ t solved by loosely coupled scheme is smaller than zero which is inconsistent with physical facts in order to overcome this problem a new motion equation is derived from eq 10 13 m a x l t δ t λ 11 t δ t a x t f b x g x f r x t δ t n x t δ t f b x g x f h x t δ t λ 11 t δ t a x t n x t δ t it is reasonable to assume that a x t a x l t δ t a x t δ t in consideration of little change of acceleration at two consecutive time steps eq 13 changes to 14a m λ 11 t δ t a x l t δ t f b x g x f h x t δ t λ 11 t δ t a x t n x t δ t the derivation process is the same in motion equations along y axis and around z axis of capsule fixed coordinate 14b m λ 22 t δ t a y l t δ t f b y g y f h y t δ t λ 22 t δ t a y t n y t δ t 15 i z λ 66 t δ t ω z l t δ t m b z t δ t m g z t δ t m h z t δ t λ 66 t δ t ω z t m n z t δ t new motion equations of capsule in x y plane are established with consideration of strong added mass effect 2 3 variable constraint conditions kinematical equations of capsule are implemented to obtain contact force three coordinate systems are applied to build kinematical equations of capsule which are earth coordinate o ε η chamber fixed coordinate o x y and capsule fixed coordinate o x y fig 2 displays the possible contact points during the ejection process of independent escape capsule as well as forces on capsule fig 2a b d and e represent the possible situations of one contact point and fig 2c and f displays the situations of two contact points the friction coefficient is set as 0 1 and shear tangential force is equals to the value of normal pressure force times friction coefficient the kinematical conditions of two kinds of contact points in fig 2c are introduced in sequence the constraint condition of contact point p1 can be expressed as if contact occurs capsule can not penetrate the surface of chamber when contact loses or surfaces of capsule and chamber separate contact force reduces to zero 16 point 1 δ x 0 contact occurs or n x 0 contact loses where δ x is the spatial displacement of contact point p1 in chamber fixed coordinate contact force n x is perpendicular to contact surface the spatial displacements of contact point δ x p δ y p t in chamber fixed coordinate can be obtained through coordinate transformation 17 δ x p δ y p t t c o δ x δ y t δ x o δ y o t 18 t c o cos θ sin θ sin θ cos θ where δ x and δ y are the spatial displacements of contact point in two axial directions of capsule fixed coordinate δ x o and δ y o are the spatial displacements of origin of capsule fixed coordinate which is also reference point of capsule the coordinate transformation matrix from the capsule fixed coordinate to the chamber fixed coordinate is t c o θ is rotational displacement of capsule the velocity vector v p of contact point in capsule fixed coordinate can be obtained through the rotational velocity vector ω of reference point o and their relative position vector o p 19 v p v p x v p y t ω o p 0 0 ω z t x o p y o p 0 t 20a δ x v p x δ t 0 5 v p x δ t 2 ω z y o p δ t 0 5 ω z y o p δ t 2 20b δ y v p y δ t 0 5 v p y δ t 2 ω z x o p δ t 0 5 ω z x o p δ t 2 21a δ x o v o x δ t 0 5 v o x δ t 2 v x δ t 0 5 v x δ t 2 21b δ y o v o y δ t 0 5 v o y δ t 2 v y δ t 0 5 v y δ t 2 where δ t is time step v p x and v p y are velocity components of contact point in capsule fixed coordinate v p x and v p y are the corresponding accelerations of contact point 22 δ x p ω z y o p δ t 0 5 ω z y o p δ t 2 cos θ v x δ t 0 5 v x δ t 2 cos θ ω z x o p δ t 0 5 ω z x o p δ t 2 sin θ v y δ t 0 5 v y δ t 2 sin θ some parameters are defined as k 1 0 5 δ t 2 cos θ k 2 0 5 δ t 2 sin θ k 3 0 5 δ t 2 x o p sin θ y o p cos θ c c 1 ω z y o p δ t cos θ v x δ t cos θ ω z x o p δ t sin θ v y δ t sin θ then eq 22 is rearranged 23 δ x p k 1 v x k 2 v y k 3 ω z c c 1 0 the constraint condition of contact point p2 can be expressed as if contact occurs capsule goes through point c when contact loses contact force reduces to zero 24 point 2 x p y p t x c y c t contact occurs or n x 0 contact loses where x p y p t and x c y c t are the positions of two contact points p2 on capsule and c on chamber in chamber fixed coordinate n x is contact force in capsule fixed coordinate the equation of line connecting two points pt and pb is 25 a t x b t y c t 0 x p y p t x c y c t is substituted into eq 25 26 a t x c b t y c c t 0 at two consecutive time steps t and t δ t 27 x p t y p t t δ t t x p t y p t t t δ x p t δ y p t t 28 x p b y p b t δ t t x p b y p b t t δ x p b δ y p b t 29 a t δ t y p t t δ t y p b t δ t a t δ y p t δ y p b 30 b t δ t x p t t δ t x p b t δ t b t δ x p t δ x p b 31 c t δ t a t δ t x p t t δ t b t δ t y p t t δ t eqs 27 31 are substituted into eq 26 32 a t δ y p t δ y p b x c x p t t δ x p t b t δ x p t δ x p b y c y p t t δ y p t 0 δ x p t δ x p b δ y p t δ y p b can be obtained from eq 17 33 δ x p t 0 5 δ t 2 cos θ v x 0 5 δ t 2 sin θ v y 0 5 δ t 2 x p t sin θ y p t cos θ ω z ω z y p t δ t cos θ v x δ t cos θ ω z x p t δ t sin θ v y δ t sin θ 34 δ y p t 0 5 δ t 2 sin θ v x 0 5 δ t 2 cos θ v y 0 5 δ t 2 y p t sin θ x p t cos θ ω z ω z y p t δ t sin θ v x δ t sin θ ω z x p t δ t cos θ v y δ t cos θ 35 δ y p t δ y p b y p t y p b ω z δ t 0 5 ω z δ t 2 cos θ 36 δ x p t δ x p b y p t y p b ω z δ t 0 5 ω z δ t 2 sin θ some parameters are defined as e 0 x c x p t t e 1 y c y p t t k 4 0 5 δ t 2 x p t sin θ y p t cos θ k 5 0 5 δ t 2 y p t sin θ x p t cos θ c c 2 ω z y p t δ t cos θ v x δ t cos θ ω z x p t δ t sin θ v y δ t sin θ c c 3 ω z y p t δ t sin θ v x δ t sin θ ω z x p t δ t cos θ v y δ t cos θ then eq 32 is rearranged 37 a t y p t y p b ω z δ t 0 5 ω z δ t 2 cos θ e 0 k 1 v x k 2 v y k 4 ω z c c 2 b t y p t y p b ω z δ t 0 5 ω z δ t 2 sin θ e 1 k 2 v x k 1 v y k 5 ω z c c 3 0 neglecting o δ t 4 and set n e 0 a t e 0 y p t y p b ω z δ t sin θ e 1 b t e 1 y p t y p b ω z δ t cos θ c c 2 a t c c 2 y p t y p b ω z δ t sin θ c c 3 b t c c 3 y p t y p b ω z δ t cos θ m 1 k 1 a t k 2 b t m 2 k 2 a t k 1 a t 0 5 δ t 2 y p t y p b ω z δ t m 3 0 5 δ t 2 y p t y p b e 0 sin θ e 1 cos θ x p t ω z δ t c c 2 sin θ c c 3 cos θ k 4 a t k 5 b t then eq 37 changes to 38 m 1 v x m 2 v y m 3 ω z n 0 3 added mass calculation ejection process of an independent escape capsule from the disabled submarine is a movement from a narrow space into an open flow field an independent escape capsule is commonly a symmetrical structure if ocean currents are in its symmetrical plane hydrodynamic motion of the capsule is also in this plane two dimensional simulation is implemented in consideration of the plane motion of capsule as well as computation resources the descriptions of physical model and computational domain are shown in fig 3 the capsule is a finite cylinder with two hemi ellipsoidal end caps the height h and outside diameter d of capsule are 2 5 m and 0 5 m respectively the lengths of major axis a and minor axis b of ellipsoid are 0 5 m and 0 25 m respectively the actual inside diameter of chamber is 0 56 m but its breadth b1 in the two dimensional computation domain is set as 0 6 m in order to avoid negative cell volume when contact occurs the additional 0 04 m 0 02 m in each side is used to guarantee that there are at least three layers of cells between surfaces of capsule and its chamber by which reasonable flow field can be obtained the density of capsule is 930 95 kg m3 the top bottom and lateral surfaces of computational domain are set as non slip wall boundary condition hybrid mesh method is applied to discrete the flow field unstructured triangular meshes are in the dynamic zone around capsule and structured quadrilateral meshes are formed outside the dynamic zone interface is applied in the overlapping edges between unstructured and structured meshes for flow data transmission in consideration of standard wall functions and standard k epsilon turbulence model used in flow field calculation the value of y ranges from 30 to 300 in order to capture the boundary layer development sas ip 2010 pan and kinnas 2011 sun et al 2015 the height of first layer of mesh around capsule is set as 4 mm yvin et al 2018 pointed out that added mass depends on the spatial configuration such as confinement when the fluid domain is not infinite one of the main techniques to eliminate the instability and non convergent problem included by the added mass effect is the artificial added mass method förster et al 2007 dunbar et al 2015 yvin et al 2018 and the simulation indicated that a good convergence behavior would be obtained if the artificial added mass is close to the physical added mass in loosely coupled scheme the computation of added mass is always performed once before simulation or at different times if necessary in this paper the shape of flow field changes as the movement of capsule which leads to variable physical added masses the calculation of those real time physical added masses of the capsule during ejection process is a heavy work and impossible the main changes of flow field are induced by the movement of the capsule in its axis direction y axis in fig 3 and are considered to approach the physical added mass of the capsule at different positions during the ejection process fig 4 illustrates the flow fields of capsule at four different positions y0 0 m y0 0 2 m y0 2 4 m and y0 2 6 m added masses of three different degrees of freedom two translational added masses in x and y axes and one rotational added mass around z axis are calculated user defined function udf in fluent is applied to define the movement of capsule v x t v y t or ω z t which means that capsule undergoes uniformly accelerated motion spring based smoothing and local cell remeshing methods are adopted to update mesh time step δt 0 001s is chosen in this grid system seen in fig 3c in order to make sure that cell courant number is less than 1 the stability and convergence of simulation are satisfactory added mass is the mass of fluid that accelerated with the capsule fig 4 gives the corresponding velocity contour around the capsule at four different positions in three different degrees of freedom it can be seen that the velocity of flow in calculation of added mass along x axis seen in fig 4a is the largest which is followed by that around z axis seen in fig 4c and the velocity of fluid along y axis seen in fig 4b is the smallest the fluid around top cap spreads around as capsule departs from chamber gradually from y0 0 m in left to y0 2 6 m in right and the velocity of fluid falls with the decrease of the blockage effect of chamber fig 5 a c and e show hydrodynamic force curves of the capsule at four different positions in calculation of its added masses λ11 λ22 and λ66 respectively the value of hydrodynamic force converges within 20 iterations hydrodynamic force f h on the capsule is divided into resistance f r and added mass force f a according to eq 7 the steady component resistance could be omitted due to the negligible speed of the capsule such as v x max 0 02 m s zhang et al 2017 validated this method by calculating the added mass of a sphere so the added masses of the capsule could be obtained by λ 11 f h x a x λ 22 f h y a y λ 66 m h z ω z defining c the ratio between the added mass and its mass 39 c 11 λ 11 m c 22 λ 11 m c 66 λ 66 i z where the mass m and inertia i z of capsule are 1138 715 kg and 616 417 kg m2 respectively table 1 lists the ratios in three degrees of freedom fitting method is adopted to form the ratio curves of capsule seen in fig 5b d and f the corresponding fitting formulas are 40 c 11 y 0 47 025 24 812 y 0 0 y 0 0 2 10 942 y 0 2 43 808 y 0 50 387 0 2 y 0 1 2 22 101 7 107 y 0 1 2 y 0 1 8 13 915 2 558 y 0 1 8 y 0 2 6 7 263 2 6 y 0 41 c 22 y 0 5 377 0 682 y 0 0 y 0 0 2 5 658 2 089 y 0 0 2 y 0 2 4 3 201 1 064 y 0 2 4 y 0 2 686 0 341 2 686 y 0 42 c 66 y 0 9 204 5 896 y 0 0 y 0 0 4 7 096 0 626 y 0 0 4 y 0 1 1 11 464 4 596 y 0 1 1 y 0 2 0 4 272 1 000 y 0 2 0 y 0 2 6 1 671 2 6 y 0 4 validation of loosely coupled scheme considering added mass effect in this section the convergence and accuracy of results by new motion equations considering added mass effect proposed in section 2 2 are introduced through comparative studies with the numerical simulation results of a free floating capsule and experimental data of a free falling sphere respectively 4 1 convergence hydrodynamic behavior of a free floating capsule in still water is simulated through new motion equations proposed in section 2 2 and 6dof solver in fluent respectively sas ip 2010 introduced the details of 6dof solver in fluent in which the translational and angular motions of an object were solved by eqs 3 and 4 without considering the added mass effect computational domain and boundary conditions of the free floating capsule refer to fig 3 the capsule undergoes translational motion in y axis under reserve buoyancy without action of ocean currents the added mass calculation results in table 1 indicate that the maximum ratio c22 of added mass and mass of capsule in y axis is over 5 the added mass effect of this free floating capsule inside its chamber is strong firstly three different mesh densities and three different time steps are tested for the simulation using new motion equations the coarse medium and fine meshes are made up of 51 504 177 064 and 660 217 cells respectively the medium mesh is presented in fig 3c three different time steps are 0 01s 0 001s and 0 0005s respectively the simulation results in fig 6 indicate that the displacement is sensitive to mesh density and time step the medium and fine meshes produce similar values and time step of 0 001s approaches the convergence results then the same mesh densities and time steps are adopted in the numerical simulation by 6dof solver in fluent the results are unstable and divergent fig 7 gives the acceleration and displacement of the capsule obtained by 6dof solver in fluent using medium mesh and time step 0 001s as well as those by new motion equations the figure has double x axes and double y axes in which red and black curves represent results obtained by 6dof solver and new motion equations respectively fig 7a shows that the red acceleration curve obtained by 6dof solver oscillates between positive and negative values the value of the acceleration soars to 60000m s2 at t 0 007s which means it diverges rapidly within 7 iterations besides the red displacement curve in fig 7b indicates that the capsule moves upward and downward along its y direction at two consecutive time steps this phenomenon is inconsistent with physical facts while the simulation results shown by black curves are of good convergence the black acceleration curve seen in fig 7a decreases from 0 1m s2 at t 0s to nearly 0m s2 at about t 7s then it increases slowly to about 0 01m s2 at t 9s a sudden drop from 0 01m s2 at t 9s to 0 166m s2 at t 9 6s is seen which is followed by a sharp increase to 0 400m s2 at t 10s at last the acceleration of capsule decreases again and at the meantime the capsule departs from chamber and its displacement is larger than 2 5 m seen in fig 7b the comparative study of vertical ejection process of capsule in still water indicates that new proposed motion equations could solve the divergence problem of the 6dof solver in simulating the fluid structure interaction problem with strong added mass effect 4 2 accuracy accuracy of numerical simulation results by new motion equations is introduced through comparing to experimental data of a free falling sphere fackrell 2011 the diameter of sphere is d 0 0254 m the mass is 0 01912 kg it undergoes free falling motion under negative reserve buoyancy in still water three dimensional simulation is implemented as shown in fig 8 computational domain is a cube with dimensions of 0 3 m by 0 3 m by 0 38 m sphere is suspended at 4 5 diameters below the top surface of domain the surfaces of domain are set as non slip wall boundary condition hybrid mesh method is applied to discrete computational domain unstructured tetrahedron meshes are formed inside dynamic zone and structured hexahedron meshes are outside dynamic zone interface is set in their overlapping surfaces for flow data transmission three different mesh densities and three different time steps are studied for the simulation using new motion equations the coarse medium and fine meshes are made up of about 0 504 1 494 and 2 055 millions cells respectively the medium mesh is presented in fig 8b the first mesh height around sphere is 1 mm which satisfies the requirement of y time steps are 0 002s 0 001s and 0 0005s respectively added mass of a sphere derived through potential flow theory is half mass of its displaced fluid sarpkaya and issacson 1981 this value is adopted in new proposed motion equations fig 9 shows acceleration curve of the sphere with respect to non dimensional displacement z d where d is the diameter of sphere the simulation results are sensitive to mesh density and time step the calculation results obtained by the coarse and medium meshes or time steps of 0 002s and 0 001s have some spikes stable and convergence acceleration curves are obtained with denser mesh and smaller time step acceleration of the capsule decreases during free fall in still water the numerical simulation results fit well with experimental data especially after z d 0 6 5 hydrodynamic motion of capsule under variable constraint conditions ejection process of an independent escape capsule from the disabled submarine under ocean currents is a more common hydrodynamic behavior in engineering application rather than its movement in still water the lateral force of ocean currents inevitable affects the movement of capsule it rotates the capsule during its ejection process and leads to the contact of capsule and its chamber this contact behavior is random which means the chamber provides variable constraint conditions for the ejected capsule the fluid structure interaction problem under variable constraint conditions is studied here as well as the application of new proposed motion equations to the three degrees of freedom plane movement the loosely coupled scheme considering strong added mass effect is validated by introducing experimental data of a free floating sphere in still water above so the numerical verifications of the ejected capsule under variable constraint conditions by the proposed loosely coupled scheme are introduced through mesh and time step sensitive studies firstly then vertical ejection process of capsule in two different ocean currents is discussed at last ejection process of capsule at a different angle 45 is introduced this case represents the ejection performance of capsule inside a disabled submarine that its hovering attitude is hard to maintain 5 1 sensitive study the hydrodynamic motion of vertically ejected capsule under ocean currents 0 5144 m s is studied the computational domain and boundary conditions are shown in fig 10 a boundary conditions of velocity inlet pressure outlet and non slip wall are applied in the simulation a funnel shaped dynamic zone is applied in order to avoid negative cell volume when capsule rotates under the action of current force unstructured triangular meshes are formed in the dynamic zone around capsule and structured quadrilateral meshes are used outside the dynamic zone interface is applied in the overlapping edges between unstructured and structured meshes for flow data transmission numerical simulations are performed by using three different mesh densities and three different time steps the coarse medium and fine meshes contain 91 441 307 661 and 1 258 242 cells respectively fig 10b displays medium meshes around two end caps of capsule three different time steps are 0 002s 0 001s and 0 0005s respectively before the simulation of hydrodynamic behavior of capsule a reasonable initial flow field is needed the transient calculation of initial flow field with capsule keeping still is applied fig 11 gives the stable initial flow field details of capsule under ocean currents 0 5144 m s using medium mesh the pressure on the right surface of capsule is larger than that on the left surface of capsule some eddy is seen around top cap of capsule from the velocity vector detail hydrodynamic force is obtained by the integral of pressure on the surface of capsule the hydrodynamic force curves are given in fig 12 it shows that hydrodynamic force components convergence to stable values at the end of calculation negative component means flow exerts an opposing force in its corresponding axis in earth coordinate the negative lateral force fε is in the opposite direction of ocean currents the lift force fη is slightly larger than 0 which helps pulse capsule out of its chamber moment m rotates capsule around z axis loosely coupled scheme is implemented after the initial flow field is obtained at each time step flow field is calculated firstly hydrodynamic force obtained is substituted into the new proposed motion equations considering huge added mass of the capsule obtained in section 3 the trajectory of capsule is computed through coordinate transformation between three different coordinate systems earth coordinate chamber fixed coordinate and capsule fixed coordinate as seen in fig 10a the trajectory in chamber fixed coordinate is applied to judge whether contact occurs or not then the mathematic expressions for constraint condition eq 23 and 38 are used to calculate the contact force finally fourth order runge kutta method is used to calculate those differential equations in x y plane the obtained motion characteristics provide boundary conditions of flow calculation in return at next time step simulations of vertically ejected process of capsule under ocean currents 0 5144 m s are performed and the results are compared as shown in fig 13 the displacements obtained by the loosely coupled scheme are convergent with increasing mesh densities fig 13a and decreasing time step fig 13b with small differences between solutions by medium and fine meshes or time steps of 0 001s and 0 0005s the medium mesh and time step of 0 001s produce convergent solutions thereby be applied in the following studies 5 2 vertical ejection under ocean currents 90 another velocity 0 3 m s of ocean currents is studied by the verified loosely coupled scheme fig 14 gives hydrodynamic force on capsule during vertical ejection process hydrodynamic force can be divided into lateral force fh ε lift force fh η and moment mh the lateral force fluctuates at the beginning of calculation this unstable results are caused by the strong added mass effect which can be seen from table 1 that ratios of added mass and mass of capsule in x axis is over 40 when y0 0 2 m lateral force at most time steps are larger than zero which is consistent with the direction of currents negative lift force hinders the vertically ejected movement of capsule and negative moment rotates capsule around z axis the severe oscillation of hydrodynamic force is seen when the sudden changes of velocity of the capsule happens hydrodynamic force hinders the change of motion states of capsule when contact occurs fig 15 compares motion characteristics of vertically ejected capsule under two different ocean currents 0 5144 m s and 0 3 m s vε and vη are translational velocities of reference point of capsule o as seen in fig 10a in earth coordinate ε η and θ are its corresponding spatial displacements vε fluctuates around zero vη increases gradually with some sudden decreases when the value of vη falls into zero it is recognized that capsule gets stuck in its chamber and the calculation ceases ε is smaller than zero from t 0 5s to about t 2s then it increases with time under ocean currents 0 5144 m s despite of some fluctuations while ε under ocean currents 0 3 m s increases until t 5s which is followed by oscillations between 0 03 m and 0 03 m η increases nonlinearly the maximum η jamming length under ocean currents 0 5144 m s is 1 257 m and that under ocean currents 0 3 m s is 1 601 m θ from t 0 5s to t 5s under two ocean currents shows similar decreasing trend after that θ fluctuates its value under ocean currents 0 5144 m s is smaller than zero while its value under ocean currents 0 3 m s changes between positive and negative numbers several times these changes mean that the attitudes of capsule under different current velocities are different during ejection process which can be also seen in fig 16 fig 16a shows the positions of capsule under ocean currents 0 5144 m s when contact occurs the times that contact occurs are consistent with inflection points of rotational displacement curve in fig 15c some different contact positions under currents 0 3 m s are chosen to shown in fig 16b it is clear that the attitude of capsule under currents 0 5144 m s keeps similar with various inclined angle during whole ejection process while capsule under smaller current velocity 0 3 m s bounces back and forth inside chamber this indicates that current force 0 5144 m s rapidly remove the action of contact force while contact force affects the movement of capsule more under current 0 3 m s 5 3 ejection process of capsule inside a disable submarine 45 the effect of two different flow velocities on vertically ejected capsule is discussed above however the upright floating hovering attitude is hard to maintain when a submarine wrecks so this section studies hydrodynamic behavior of capsule under different directions of currents the description of an ejected capsule inside an inclined chamber under ocean currents is shown in fig 17 a the inclined angle 45 of chamber is expressed by the angle between earth coordinate o ε η and chamber fixed coordinate o x y consequently two different current directions are calculated which are 135 and 45 respectively the current direction is expressed by the angle between y axis in capsule fixed coordinate and flow velocity the current velocity is 0 5144 m s the computational domain and boundary conditions are also shown in fig 17a fig 17b gives medium meshes around two end caps of capsule fig 18 gives hydrodynamic force on capsule inside an inclined chamber during its ejection process it can be seen that hydrodynamic force on capsule oscillates frequently from t 4 2s to t 6s under currents 135 and from t 3 2s to t 6 5s under currents 45 which indicates that capsule contacts with its chamber during these times it is also noted that although currents flow from left to right moment on capsule under currents 135 from t 0 5s to t 3 503s has positive value so rotational displacement of capsule is larger than zero as shown in fig 19 c fig 19 gives motion characteristics of ejected capsule inside a chamber with inclined angle of 45 under ocean currents 135 and 45 vε and vη are translational velocities of reference point of capsule o as seen in fig 17a in earth coordinate ε η and θ are its corresponding spatial displacements it is commonly recognized that capsule in an inclined chamber would float vertically at beginning with vε and ε equals to zero however it is can be seen from fig 19 that vε and ε have values as big as vη and η this is because that added mass of capsule in x axis is much larger than that in y axis as seen in table 1 and then the movement of capsule in x axis induced by the component of reserve buoyancy along x axis is pretty smaller capsule in an inclined chamber undergoes movement along its y axis as vertically ejected capsule does vε vη and ε η can be obtained from vx vy and x y through matrix transformation between capsule fixed coordinate and earth coordinate vε and vη increase with some fluctuations induced by contact force vη is larger than zero which indicates that capsule move upwards vε is smaller than zero which indicates that capsule moves along ε axis different from calculation of vertical ejection process of capsule only if both vε and vη fall into zero it is recognized that capsule in an inclined chamber gets stuck and the calculation ceases so the calculation carries on at about t 7 5s in fig 19a and t 7 6s in fig 19b ε and η increase nonlinearly with time the maximum ε and η jamming lengths under currents 135 are 0 901 m and 0 889 m which are smaller than the maximum ε 1 357 m and η 1 288 m of capsule under currents 45 respectively θ of capsule under currents 135 increases from 0 rad at t 0 5s to 0 0139 rad at t 2 337s then it shows a decreasing trend with big oscillations after 7s θ of capsule under currents 45 decreases from 0 rad at t 0 5s to 0 005 rad at t 1 588s which followed by an increase to 0 008 rad at t 2 344s then it shows a decreasing trend with big oscillations after 6 5s due to contact force fig 20 compares some positions of capsule inside an inclined chamber under ocean currents 135 and 45 when contact occurs capsule bounces back and force inside the inclined chamber during ejection process capsule under currents 45 has larger rotational displacement than that under currents 135 6 conclusions fluid structure interaction and multibody dynamics are involved in the ejection problem of independent escape capsule from a disabled submarine under ocean currents which is an interdisciplinary subject the present contribution is concerned with the proposed loosely coupled scheme for this fsi problem udf in the fluent is applied for secondary development in which new motion equations with consideration of strong added mass effect and variable constraint conditions are implemented flow field is calculated by fluent and motion characteristics are solved by udf separately at each time step unstructured dynamic mesh technology is used to update mesh firstly this loosely coupled scheme is applied to study the vertical ejection process of a two dimensional capsule from a narrow space into an open domain under two different ocean currents 0 5144 m s and 0 3 m s then hydrodynamic motion of the capsule inside a inclined chamber under two different currents 135 and 45 is calculated hydrodynamic force motion characteristics and trajectory are obtained capsule bounces back and forth inside its chamber during ejection process comparative analyses indicate that the velocity and direction of flow strongly affect the movement of capsule and the contact force leads to the jamming problem during the ejection process of capsule the jamming length of capsule under currents 0 5144 m s is shorter than that under currents 0 3 m s the jamming length of capsule under ocean 135 is smaller than that under currents 45 this presented loosely coupled scheme could be easily extended to calculate the ejection process of any three dimensional capsule from a disabled submarine only requiring larger computation sources in the future we plan to implement model test of the ejected capsule to validate the accuracy of the convergent solutions obtained by the loosely coupled scheme considering variable constraint conditions during its ejection process acknowledgement the authors gratefully acknowledge the financial support from the national natural science foundation of china nsfc under project number 51679097 and the china postdoctoral science foundation under project number 2019m652650 
22644,in this paper a robust and fast self alignment method under an undesirable non periodic unidirectional vessel motion is proposed the proposed method is based on the attitude determination technique which transforms the alignment procedure into an attitude determination problem by creating infinite vector observations the method implements the quaternion estimator quest attitude determination technique which reduces the computational complexity in practical implementations and accomplishes the alignment task more robustly and accurately compared with the kalman filter based alignment methods in a specific time interval simulation and also experimental results show that the proposed technique has more accurate and faster responses compared to the conventional methods based on the kalman filter keywords initial self alignment attitude determination strapdown inertial navigation system compensation of the lever arm effect vessel body motion 1 introduction in the initial alignment phase the attitude matrix between the inertial measurement unit imu frame and local navigation frame is computed over a limited time the initial alignment in strapdown inertial navigation systems sins and inertial compass systems is a significant step which must be performed before the navigation phase the performance of sins is related to the accuracy and rapidity of the initial alignment process therefore most of the researches have been focused on these two factors gao et al 2011 2015 the initial alignment is accomplished by utilizing external attitude information or independently which is referred by transfer or autonomous alignment respectively gong et al 2018 zou et al 2018 xu et al 2017 the autonomous alignment methods perform the alignment phase using two different approaches accordingly in the first approach the sins uses the position and velocity information of external sensors to accomplish the initial alignment process xu et al 2017 chang et al 2017 in the second approach the self alignment is performed by a stationary or quasi stationary model assuming that the vehicle is fixed with respect to the earth silva et al 2017 li et al 2018 self alignment often consists of two consecutive stages coarse alignment and fine alignment titterton et al 2004 noureldin et al 2013 in the coarse alignment stage the attitude matrix between the body and navigation frames is estimated approximately and then it is used as the initial value in the fine alignment phase the coarse alignment duration can be varied due to the warm up time of the inertial sensors the application and imu design in the fine alignment the attitude matrix is obtained accurately in the conventional kalman filter kf based alignment the differences between s1ns s computed outputs and measurement reference data is utilized as the measurement vector to accomplish the alignment task the kf estimates the position velocity and attitude errors by using the dynamic error model and the stochastic model of sensors the kf based self alignment methods are model based approaches titterton et al 2004 noureldin et al 2013 ben et al 2016 rahgoshay et al 2017 accordingly the performance of these methods is highly dependent on proper modeling therefore the performance of the kf based self alignment method is considerably related to the coarse alignment accuracy adjustment of the initial parameters the type of maneuvers and motions of the vehicle sun et al 2015 shao et al 2018 allottaet al 2016 lever arm error in sins is the result of the distance between the sins and the reference locations which adversely affects the performance of the alignment process wang et al 2017 accordingly to reduce the impact of the lever arm effect it is better to mount the sins near the reference such as gps antenna or doppler velocity log sensors which is impossible in practical applications in the self alignment methods the outputs of sins are compared with the stationary and quasi stationary models with the assumption that the sins is mounted in the center of gravity of the vessel however the sinss are not usually installed in the center of gravity of the vessel due to location constraints self alignment of sins in the presence of undesirable vessel motions is a critical issue especially when no external aided sensors are used in practical marine applications the sins might experience non periodic and unidirectional body motions which lead to performance degradation of the initial alignment especially when the alignment time is short in the rough sea conditions measurement errors which are the result of the lever arm in vessel maneuvers will act as a reliable input and mislead the self alignment process titterton et al 2004 the self alignment methods have been presented with the assumption that the vessel has periodic motion along three axes of roll pitch and yaw so the lever arm is ineffective in alignment interval constantin and kieffer 2000 iso8728 2014 wu et al 2011 these papers assume that the integration of the angular and linear disturbing forces in the time interval of the alignment is near zero gao et al 2011 gu et al 2008 yueyang et al 2009 nevertheless in some practical cases unlike the periodic motions of roll and pitch axes the yaw axis of the vessel experiences a non periodic continuous unidirectional motion caused by the sea waves regarding unexpected linear velocities caused by disturbing forces the performance of self alignment techniques have a considerable reduction in the rough sea conditions therefore choosing a proper self alignment technique is an important issue to perform the alignment faster and more accurate in this condition accordingly in recent years attitude matrix decomposition based methods have been proposed for the vehicles under swaying or maneuvering conditions for alignment by using the attitude determination methods silson 2011 wu and pan 2012 zhang et al 2018 chang et al 2015a 2015b these methods transform the alignment procedure into an attitude determination problem using infinite vector observations they accomplish the alignment task more robustly and accurately compared with the kf alignment methods in a specific time interval however these methods have some disadvantages such as high memory usage chang et al 2015a 2015b the rigorous computational burden in real world implementation and unbounded growth in matrix calculations and consequently eigenvalues related to the attitude determination method wu et al 2011 wu and pan 2012 usually the vessel motion during the alignment is under the mooring or swinging due to the berthing at the pier before the move but the condition will be different when the sins is restarted in the middle of the sea or the vessel is separated from the pier due to the rush before the end of the alignment phase additionally the alignment will be difficult in a variety of applications where the sins system directly enters into the water for example hydroacoustic aided inertial navigation hain remotely operated underwater vehicle rov dredging sonar motion reference and so on this paper proposes a robust self alignment rsa method for marine sins in the presence of undesirable and incidental motion of the vessel we call this non periodic continuous unidirectional motion as continuous rotation away yaw axis craya the proposed self alignment is based on the attitude matrix decomposition technique in attitude determination problem the rsa algorithm performs the initial alignment process without using any aided external sources this method is based on the formation of infinite vector observations through inertial sensors and accurate grand geometric information until the present time accordingly extraction is a continuous method for determining the real time attitude in the dynamic form to reduce the computational complexity in the attitude determination methods in addition to normalizing the vector observations the rsa algorithm performs a continuing attitude determination by using the quaternion estimator quest method shuster and oh 1981 shuster 2006 markley and mortari 2000 unlike conventional attitude determination methods used in the alignment procedure of sins the proposed technique represents a robust and simple structure solution and aims to overcome the mentioned disadvantages the simulation and experimental results show that the proposed self alignment under craya motion condition presents a faster and more accurate solution compared with the conventional kf based methods additionally to compensate the lever arm effect the vector observations are calculated and introduced the rest of this paper is organized as follows in section 2 the craya motion is introduced the rsa is proposed in section 3 section 4 investigates the compensation of the lever arm effect in section 5 the superiority of the proposed method is shown by the results of simulation and also experimental tests finally conclusions are drawn in section 6 2 introducing the craya motion a vessel may experience different types of motions under various sea conditions these movements are divided into two types of linear and rotational motions see fig 1 the linear movements include three species which are called surge sway and heave and rotational motions consist of three types namely roll pitch and yaw zhou et al 2019 wang et al 2018 as previously mentioned it is assumed that the integration of the angular and linear disturbing forces in the time interval of the alignment is near zero in the craya motion it is assumed that the vessel experiences periodic and zero mean linear movements along the body axes on the other hand unlike the periodic and zero mean angular motions along the horizontal body axes the vessel has a non periodic continuous unidirectional motion along the z axis which is affected by the sea waves the amplitude and period of the roll and pitch motions are varied due to the dimensions of the vessel and the force of the sea waves lawther and griffin 1986 for example a huge vessel has fewer changes in pitching angles than a small one the amplitude and period of the roll and pitch motions are selected according to iso dis 8728 standard constantin and kieffer 2000 i 8728 2014 according to this standard the yaw axis is constant during the test of settling time on a scorsby table moreover the roll and pitch axes have the following periodic and zero mean motions roll axis peak amplitude 5 o 1 o period 15 s 1 s pitch axis peak amplitude 5 o 1 o period 6 s 1 s then the gyrocompass or sins should perform the initial alignment under this dynamic motion but according to fig 1 in craya motion in addition to the roll and pitch axes the yaw axis is also changed generally in the yaw axis several types of dynamics can be considered as follows the value of the yaw axis is the same as the test expressed in the iso dis 8728 standard the value of the yaw axis such as the scorsby test in the iso dis 8728 standard changes as a simple harmonic motion with a zero mean the value of the yaw axis is changed in a harmonic motion but the mean is non zero and variable the amount of yaw axis is continuously increasing or decreasing initial alignment with the last assumption is a critical and challenging problem in the self alignment of marine sins the craya motion is also considered as this type of yaw dynamic which has a harmonic motion in the roll and pitch axes 3 the proposed robust self alignment method in this section a robust self alignment rsa algorithm is presented and performed without external aid sources the rsa method is based on the formation of unlimited vector observations through inertial sensors and accurate ground geometric information until the present time accordingly extraction is a continuous method for determining the real time attitude in the dynamic form these infinite vectors are used only to define an attitude vector that in fact is paused at the beginning of alignment on the other hand due to the plurality of vectors a memory method must be used to determine the initial attitude in the real world therefore the rsa has used a continuing attitude determination method based on quest method in the following the rsa algorithm is introduced in two parts including the construction of the observation vectors and quest method to solve the wahba s problem 3 1 construction of the observation vectors unlike the kf based self alignment methods the attitude matrix is determined directly without using the error state model it is assumed that the imu frame coincides the body frame of the vessel perfectly the purpose of sins initial self alignment is to determine the transformation matrix c b n t where t 0 t f b and n represent the body frame and the local navigation frame respectively in accordance with the chain rule of the transformation matrix the c b n t can be decomposed into three parts as 1 c b n t c n 0 n t c b 0 n 0 c b t b 0 c n 0 n t c b n 0 c b t b 0 where b 0 and n 0 are inertial frames of body and navigation at the start of the initial self alignment the c b 0 b t and c n 0 n t describe the changes in body frame and the navigation frame from starting time to moment t respectively their rate equations are 2 c b t b 0 c b t b 0 ω i b b 3 c n t n 0 c n t n 0 ω i n n where x denotes the skew symmetric matrix of x the ω i b b is the vessel angular rate of the body frame with respect to the inertial frame measured by the gyroscopes note that 4 ω i n n ω i e n ω e n n in which ω e n n is the angular rate of the navigation frame with respect to the earth frame and ω i e n denotes the earth rotation rate with respect to the inertial frame and can be expressed as 5 ω i e n 0 ω i e cos φ ω i e sin φ t 6 ω e n n v n r n h v e r e h v e tan φ r e h t where ω i e denotes the earth rotational rate and φ denotes the geographic latitude v n and v e denote the north and east velocities respectively r n and r e denote the north and east earth radiuses respectively and h is the altitude the velocity equation formulated in the navigation frame is given by 7 v n c b n f b 2 ω i e n ω e n n v n g n where f b denotes the specific force vector which is described in the body frame v n denotes the linear velocity vector in the navigation frame and g n is the gravity vector in the navigation frame which can be expressed as 8 g n 0 0 g t where 9 g g w g s 0 1 g w g s 1 sin 2 φ 1 ε 2 sin 2 φ where according to wgs 84 ellipsoid constants g w g s 0 9 7803267714 m s 2 g w g s 1 0 00193185138639 and ε 0 0818191908426 are gravity at the equator gravity formula constant and first eccentricity respectively rogers 2007 performing zero velocity update zupt equations 4 and 7 change as follows 10 ω i n n 0 ω i e cos φ ω i e sin φ t 11 c b n t f b g n substituting 1 into 11 yields 12 c n 0 n t c b n 0 c b t b 0 f b g n multiplying c n t n 0 on both sides of 12 results in 13 c b n 0 c b t b 0 f b c n t n 0 g n assuming that 14 b t c b t b 0 f b r t c n t n 0 g n equation 13 can be rewritten as the vector observations based measurement model for c b n 0 as 15 c b n 0 b t r t where b t and r t are vectors measured in the body and reference frames respectively therefore when the sensor data is updated at any moment a new pair of vector observations will be added in order to perform the self alignment it is first necessary to determine c b n 0 by solving equation 15 and then using equation 1 to solve equation 15 the vector observations b t and r t are computed at each instant in the self alignment r t can be accurately calculated at any moment due to its independence from the external sources on the other hand b t depends on the values of accelerometers and gyroscopes measurements therefore at any moment it is varied due to the linear and rotational disturbances an effective method to reduce the effects of disturbances is performing the integration over the entire alignment time interval however due to accumulative errors in alignment the integration over the entire time interval is not proper for low cost sins such as mems since in rsa the purpose of self alignment is for navigation grade sins the integration is obtained from the beginning to the moment t therefore vector observations are calculated as 16 b i n i b i n i 1 c b i 1 t b 0 0 t f b d t 1 2 0 t ω i b b d t 0 t f b d t 2 3 0 t 2 ω i b b d t t 2 t f b d t 0 t 2 f b d t t 2 t ω i b b d t 17 r i n i r i n i 1 c n i 1 t n 0 t i t 2 2 ω i n n g n where i is an integer for the current sampling data i e i t t and t is the time interval between the two sampling data the initial values are assumed to be b i n 0 r i n 0 0 3 1 and c b b 0 c n n 0 i 3 3 according to equations 2 and 3 c b i 1 b 0 and c n i 1 n 0 are calculated as 18 c b i 1 t b 0 c b i t b 0 exp i t i 1 t ω i b b d t c b i t b 0 exp σ b 19 c n i 1 t n 0 c n i t n 0 exp i t i 1 t ω i n n d t c n i t n 0 exp σ n where c n 0 n 0 c b 0 b 0 i 3 3 the σ n can be calculated as follows due to the slow time varying characteristic of the vector ω i n n 20 σ n i t i 1 t ω i n n d t t ω i n n on the other hand the vector ω i b b can be variant in space over the time intervals and consequently σ b is obtained as follows 21 σ b i t i 1 t ω i b b d t 2 3 i t i t t 2 ω i b b d t i t t 2 i 1 t ω i b b d t equation 21 is proposed to compensate the effect of ω i b b variations over the time intervals exp σ x can be calculated as 22 exp σ x i σ x σ x 2 2 σ x 3 3 i 1 σ x 2 3 σ x 4 5 σ x 1 2 σ x 2 4 σ x 4 6 σ x 2 i sin σ x σ x σ x 1 cos σ x σ x 2 σ x 2 as a remark the integrals represented in equations 16 and 21 are incremental values the outputs of high grade inertial sensors are represented in incremental form ordinarily so these values are usually available directly otherwise to achieve the linear velocity and the angle of rotation in short intervals t the integration of the output of inertial sensors should be performed additionally the integration of the entire alignment time causes the eigenvalues of the k matrix in the quest method to greatly enlarge therefore the normal vector observations are necessary at any moment and the eigenvalues will be close to one the vector observations are expressed as 23 b i b i n i b i n i r i r i n i r i n i where i is written as the subscript for the sake of simplicity since c b n 0 is a constant equation 15 is rewritten as 24 c b n 0 b i r i knowing the values of b i and r i we can obtain the c b n 0 though in this case the vector observations are received over time infinitely and continuously when the number of vector observations increases it is necessary to solve the wahba s problem to obtain the orthogonal matrix wahba 1965 mortari 1997 wahba formulated the following cost function 25 j c 1 2 i 1 n α i b i c r i 2 where α i is a non negative weight and is the euclidean norm b i is a set of n unit vectors measured in the body frame r i is the corresponding unit vectors in the reference frame navigation frame and c is transformation matrix the wahba cost function can also be written as shuster 2009 26 j c const l c where l c is the gain function given by 27 l c tr b t c and the attitude profile matrix b is defined by 28 b i 1 n α i b i r i t the optimal matrix c b n 0 is obtained by solving the wahba s problem attitude matrix can be computed at each moment by updating c b n 0 in equation 1 3 2 quest method to solve the wahba s problem in this part the quest method is suggested as a real time solution to wahba s problem let the quaternion be denoted as 29 q q 1 q 2 q 3 q 4 e q where e q 1 q 2 q 2 t and q q 4 are the vector and scalar parts respectively according to equations 28 and 29 equation 27 can be rewritten as 30 l c q i 1 n α i b i t c q r i i 1 n α i b i t ξ t q ψ t q r i where 31 ψ q q i 3 e e t q 4 q 3 q 2 q 1 q 3 q 4 q 1 q 2 q 2 q 1 q 4 q 3 and 32 ξ q q i 3 e e t q 4 q 3 q 2 q 1 q 3 q 4 q 1 q 2 q 2 q 1 q 4 q 3 after some manipulations equation 30 can be obtained as 33 l c q i 1 n α i b i 0 t q t q r i 0 i n α i b i q t r i q q t i n α i b i t r i q q t k b q where 34 q ψ q q 35 q ξ q q 36 q q q e q e e e q q e e 37 q q q e q e e e q q e e and k b is the symmetric traceless matrix 38 k b b b t t r b i 3 z t z t r b with 39 z b 23 b 32 b 31 b 13 b 12 b 21 t i 1 n α i b i r i the quaternion satisfies a single constraint which is q t q 1 this constraint can be taken into account by the method of lagrange multipliers a new gain function φ c q can be defined as 40 φ c q q t k b q λ q t q through the solution of equation 40 by straightforward differentiation we have 41 φ q k b λ i q 0 so 42 k b q λ q thus q b n 0 must be an eigenvector of k b and l c q will be maximized if q b n 0 is chosen to be the eigenvector of k b belonging to the largest eigenvalue of k b therefore 43 k b q b n 0 λ max q b n 0 is the desired result in the next step it is essential to use a suitable method to obtain the λ max due to the high output rate of the inertial sensors there is a short time to perform the calculation of the existing algorithms in the real time practical implementation the quest method is a useful way to solve wahba s problem in the real world therefore in this paper the quest is applied as a continuous problem nevertheless according to equation 38 the k b can be calculated in the real time as 44 k b i k b i 1 α i b i r i t b i r i t t t r b i r i t i 3 b i r i t b i r i t r b i r i t where k b 0 0 and 45 b i b i 1 α i b i r i t where b 0 0 3 3 according to equation 29 38 and 43 46 b i b i t t r b i i 3 z i t z i t r b i e b n 0 q b n 0 λ max e b n 0 q b n 0 0 where e b n 0 and q b n 0 are vector and scalar parts of the q b n 0 respectively and 47 z i z i 1 α i b i r i where z 0 0 3 1 equation 46 is equivalent to the two equations 48 s i ζ i i 3 e b n 0 z i q b n 0 0 z i t e b n 0 t r b i λ max q b n 0 0 where 49 s i b i b i t 50 ζ i t r b i λ max from 48 one can obtain 51 e b n 0 q b n 0 ζ i i 3 s i 1 z i q b n 0 υ i γ i where 52 υ i adj ζ i i 3 s i z i γ i det ζ i i 3 s i according to q t q 1 the optimal quaternion can be expressed as 53 q b n 0 1 γ i 2 υ i t υ i υ i γ i therefore if λ max is known q b n 0 can be obtained according to equation 53 substituting 51 in 48 one can obtain 54 p λ max λ max 4 a 1 a 2 λ max 2 a 3 λ max a 1 a 2 a 3 t r b i a 4 where a 1 t r b i 2 t r adj s i a 2 t r b i 2 z i t z i a 3 det s i z i t s i z i and a 4 z i t s i 2 z i to solve the polynomial equation 54 the newton raphson iteration is used as 55 λ max i 1 λ max i p λ max i d p λ max d λ λ λ i λ 0 1 according to equations 54 and 55 λ max is close to λ 0 therefore one step iteration for λmax is always sufficient markley and mortari 2000 the algorithm of the rsa is shown in fig 2 as a block diagram in this block diagram the steps to get the body and reference measurement vectors are shown with orange and purple respectively the steps for obtaining the initial rotation matrix from the vector observations are indicated in green and the real time attitude is depicted in red 4 compensation of the lever arm effect in the proposed rsa method as explained in sections 2 and 3 the rsa is performed for no aided external source e g gps or speed log on the other hand in craya motion due to the lever arm disturbing forces are created and the accelerometers are measured at any moments therefore in this section the lever arm effect compensation is studied as a remark amateur users usually do not know the amount of the lever arm or it is not considered correctly in the real world therefore the purpose of the rsa is to provide a robust method against the velocity error caused by the lever arm in the rough sea conditions therefore in section 5 all of the results will be without lever arm compensation nevertheless for eliminating the effect of the lever arm the vector observations are derived in theorem 2 so in practice the system designer can implement rsa by compensating the lever arm effect in theorem 2 if the lever arm is known approximation of the linear velocity at the sins location will be possible according to theorem 1 consequently the approximated velocity vector can be used as an aiding velocity measurement in fact by performing this procedure the lever arm effect is compensated for the self alignment lemma 1 noureldin et al 2013 the rate of change of directional cosine matrix dcm in general is given as 56 c k m c k m ω m k k theorem 1 the velocity error under the influence of lever arm in self alignment is δ v n c b n ω i b b d b where the vector d b d x d y d z is the value of lever arm in meters and ω i b b t is given as 57 ω i b b 0 ω z ω y ω z 0 ω x ω y ω x 0 where the values of ω x ω y and ω z are the angular velocities measured by the gyroscopes in the x y and z axes of the body frame respectively proof the positioning equation in the inertial device is defined as 58 r s i n s i r c g i d i where r s i n s i and r c g i are the position vectors relative to the inertial frame to the designated location for sins and the center of gravity location respectively d i is the distance from the center of gravity to the sins the time rate of change of 58 defines the relationship between velocities relative to the inertial frame at the sins and center of gravity 59 v s i n s i v c g i d i by transforming to n frame axes multiplying c i n on both sides results in 60 v s i n s n v c g n c i n d i assuming that v c g n 0 we have 61 δ v n c i n d i given that d i c b i d b the equation 61 is rewritten as 62 δ v n c i n c b i d b c b i d b assuming that the value of d b is constant and using lemma 1 we have 63 δ v n c b n ω i b b d b therefore the proof is completed if theorem 1 is used in the rsa this method will not be optimal therefore theorem 2 is proposed theorem 2 to compensate for the lever arm effect in the rsa method the vector observations are determined as follows 64 b l a i b l a i b l a i r l a i r l a i r l a i where b l a i and r l a i are given as 65 b l a i c b i t b 0 f b ω i b b 2 ω i b b d b r l a i c n i t n 0 g n proof substituting 63 into 7 yields 66 c b i ω i b b d b c b n ω i b b d b c b n ω i b b d b c b n f b 2 ω i e n ω e n n c b n ω i b b d b g n d b is constant using lemma 1 and transferring the 2 ω i e n ω e n n to the body frame results in 67 c b n ω i b b ω i b b d b c b n ω i b b d b c b n f b c b n 2 ω i e b ω e n b c b n ω i b b d b g n where ω i e b and ω e n b are respectively the rotation rate of the earth with respect to the inertial frame and the rotation rate of the navigation frame with respect to the earth frame expressed in the body frame after simplification 68 c b n f b 2 ω i e b ω e n b c b n ω i b b ω i b b 2 ω i b b d b g n by substituting the value of c b n from the equation 1 and multiplying c n i t n 0 on both sides one has 69 c b n 0 c b i t b 0 f b 2 ω i e b ω e n b c b n ω i b b ω i b b 2 ω i b b d b c n i t n 0 g n the effect of the lever arm is not important in a stationary state in rotation state the value of 2 ω i e b ω e n b is much less than ω i b b so the 2 ω i e b ω e n b in equation 69 is ignored therefore equation 69 is converted to 70 c b n 0 c b i t b 0 f b ω i b b 2 ω i b b d b c n i t n 0 g n with respect to equation 15 the values of b l a i and r l a i are obtained therefore the proof is completed 5 simulations and experiments in this section we carry out simulations and experimental tests of the craya motion for sins the proposed initial self alignment method has been compared with the conventional extended kalman filter ekf and cubature kalman filter ckf self alignment method to show its performance in the presence of the craya motion the duration of 30 seconds has been assigned to carry out the coarse alignment phase for using ekf and ckf the gravity in the inertial frame has been used as a reference measurement vector in the coarse alignment phase gu et al 2008 this method has a good performance in sea mooring condition the state and measurement equations are extracted to implement a filtering algorithm in the literature the velocity error vector δ v and the misalignment angles vector ϕ in the navigation frame are considered as the states of the fine self alignment method the nonlinear model of dynamic error of sins has been expressed in 71 zhang et al 2013 zhanxin et al 2007 71 x f x w z h x η where x is the state vector consisting of six states as follows 72 x δ v n δ v e δ v d ϕ n ϕ e ϕ d t in which subscripts n e and d represent north east and down in the navigation frame respectively with the zupt measurements the design matrix will be 73 h 1 0 0 0 0 0 0 1 0 0 0 0 0 0 1 0 0 0 therefore the system and measurement equations are rewritten as follows 74 δ v n δ v e δ v d ϕ n ϕ e ϕ d x cos ϕ d 1 f n sin ϕ d f e 2 ω i e cos φ δ v d g ϕ e sin ϕ d ϕ n sin ϕ d 2 ω i e sin φ δ v e sin ϕ d f n cos ϕ d 1 f e g ϕ e sin ϕ d ϕ n sin ϕ d 2 ω i e sin φ δ v n ϕ e f n ϕ n f e 2 ω i e sin φ δ v n sin ϕ d ω i e cos φ ϕ e ω i e sin φ δ v e r cos ϕ d 1 ω i e cos φ ϕ n ω i e sin φ δ v n r ϕ e ω i e sin ϕ d ϕ n cos ϕ d ω i e cos φ δ v n tan φ r f x n e d ε n ε e ε d w 75 v n 0 v n i n s v e 0 v e i n s v d 0 v d i n s z 1 0 0 0 0 0 0 1 0 0 0 0 0 0 1 0 0 0 x h δ η v n δ η v e δ η v d η where f n f e f d are specific forces φ is the latitude of the vessel ω i e r are rotation speed and radius of the earth respectively n e d ε n ε e ε d are the projection of accelerometers and gyroscopes instability biases into the navigation frame respectively v n 0 v e 0 v d 0 are the zero update velocities which can be modeled either as zeros or as very tiny values v n i n s v e i n s v d i n s are the ins output velocities δ η v n δ η v e δ η v d are the uncertainties around the zero velocity the filtering parameters x 0 p 0 and r are considered identical for both ekf and ckf approaches as follows 76 x 0 0 1 3 coarse alignment outputs 1 3 t 77 p 0 d i a g 0 1 m s 2 0 1 m s 2 0 1 m s 2 1 o 2 1 o 2 10 o 2 78 r d i a g 0 01 m s 2 0 01 m s 2 0 01 m s 2 where x 0 is initial state estimate p 0 is the initial covariance of the estimation error and r is the measurement noise covariance the interval of the time update and measurement update for both simulation and experimental results are five millisecond and one second respectively furthermore the same parameters are used in the implementation of the ekf and ckf simon 2006 arasaratnam et al 2010 in the simulation study in addition to the craya motion it is assumed that the lever arm exists and the lever arm value is not set by the user in sins in the experimental study due to the limitation of the rotary table dimensions the lever arm is applied only for a few centimeters 5 1 simulation study there are two scenarios in this subsection both the roll and pitch axes are moved according to the explanation in section 2 in the first scenario it is assumed that the yaw axis rotation and the lever arm value are balanced but in the second scenario these values are severe the two scenarios are as follows first scenario the yaw axis rotation is equal to 0 5 deg sec and the lever arm is equivalent to 10 4 2 t m second scenario the yaw axis rotation is equal to 2 deg sec and the lever arm is equivalent to 40 7 5 t m it is assumed that the bias stability and angular random walk of gyroscope sensors are 0 01 deg hr and 0 001 deg hr respectively furthermore the bias stability and velocity random walk of accelerometer sensors are assumed to be 20 μ g and 0 02 m s hr respectively fig 3 shows the true north and heading angles obtained from the ekf ckf and rsa methods and their errors the error and convergence rate of the heading angle achieved from the proposed rsa are better than that of the ekf and ckf roll and pitch angles are plotted in fig 4 furthermore table 1 shows the mean standard deviation std and root mean square rms of heading error for the first scenario therefore the proposed rsa approach is clearly better fig 5 indicates the heading angle with its error and fig 6 shows the error in the roll and pitch angles of the second scenario in this scenario due to the large disturbing forces the 5 min alignment time is not enough to achieve the desired accuracy of the alignment process so the simulation time duration is 20 min the purpose of this dramatic scenario is to compare the performance of the proposed rsa method with ekf and ckf with no time constraint the initial self alignment in less than 5 min in this scenario is not considered in the ekf and ckf self alignment methods the estimated heading angle accuracy does not meet the desired value even after 20 min in the proposed rsa method the error of the heading angle fluctuates around zero after 5 min and reaches about 0 2 in 20 min in addition using the rsa method convergence and accuracy of the roll and pitch angles clearly outperform the ekf and the ckf furthermore the same as the first scenario table 2 shows a quantitative comparison for heading error of the second scenario therefore the rsa method is truly robust against velocity errors and undesirable accelerations 5 2 experimental results in this section experimental tests are conducted to show the efficiency and effectiveness of the proposed self alignment method the ekf ckf and rsa methods are executed on the same data and their results have been compared to each other a fog based imu consisting of three gyroscopes with a bias stability of 0 05 deg hr and an angular random walk of 0 005 deg hr are used in these tests in addition three accelerometers with a bias stability of 100 μ g and a velocity random walk of 0 08 m s hr have been used to apply the craya motion to the imu a 3 axis rate table of the uoo model has been used see fig 7 and fig 8 using the iso dis 8728 standard roll and pitch axes swing are as follows iso8728 2014 roll axis peak amplitude 5 o 1 o period 15 s 1 s pitch axis peak amplitude 5 o 1 o period 6 s 1 s and the yaw axis rotates continuously the tests are performed in ten different scenarios at various angular velocities about the yaw axis these values are 0 1 0 2 0 5 1 and 2deg sec the negative angular velocities of these values are also considered to examine the results of the tests it is necessary to draw the difference between the output of the sins and the rate table so the imu s outputs and the rate table are stored for offline computations it is essential to synchronize the stored data of the imu and the rate table there are two main problems with the storage of data in the data synchronization the first problem is the difference between imu and rotation table output rates and the second problem is that the data storage is also performed with an undesirable delay in computers for solving these problems a data acquisition board has been used with a delay of less than 10μs according to fig 7 this electronic board is able to add a precise timestamp to the beginning of the data sentences as soon as they receive then it sends information to the computer for storage finally interpolation is used to equalize the output rate as shown in fig 8 the imu is installed at a maximum distance from the center of the rate table it will cause the same effect as sensor sizing making the situation a little harder the imu distance from the center of the rate table is far less than the imu distance from the center of gravity of the vessel in this test therefore this distance cannot be a lever arm and is more like the sensor sizing effect this distance is approximately d b 8 10 0 t c m the value of true north is very closely matched to the value of the outer axis or the yaw axis of the rate table but due to the placement of the imu at the corner of the inner axis of the rate table the imu frame has slightly changed to the rate table frame therefore there exist errors between the angles of roll pitch and heading of the sins and the inner axis the middle axis and the outer axis of the rate table respectively to eliminate this offset the imu set is statically positioned at eight different angles to the yaw axis in each direction it is turned on for 20 min and its data is stored by using the stored data the exact amount of euler angles is calculated in all directions then the mean of the differences between the rate table orientation information and the sins computed outputs in all directions is considered as the installation offset error in dynamic tests the installation error value of these tests is zero for the roll axis and pitch axis and 0 09 for the yaw axis therefore the installation offset value must be compensated the installation offset error value can be applied in two ways by applying a simple method these values can be reduced directly from the euler angle output in this simple method the difference between the output of the sins and the rate table is associated with the error due to the non conformance of the imu frame and the rate table frame see fig 9 in the proposed method to eliminate the effect of the installation error on the difference between the euler angles of sins and the rate table the virtual imu frame should be transferred to the rate table frame therefore according to equation 79 the output of the accelerometers and gyroscopes are multiplied by the transformation matrix c s b by performing this the location of the inertial sensors from the imu frame is moved virtually to the rate table frame 79 f b c s b f s ω i b b c s b ω i s s where f s and ω i s s are respectively the output of accelerometers and gyroscopes in the imu frame the transformation matrix c s b is according to equation 80 80 c s b cos ψ o s sin ψ o s 0 sin ψ o s cos ψ o s 0 0 0 1 cos θ o s 0 sin θ o s 0 1 0 sin θ o s 0 cos θ o s 1 0 0 0 cos ϕ o s sin ϕ o s 0 sin ϕ o s cos ϕ o s cos θ o s cos ψ o s cos ϕ o s sin ψ o s sin ϕ o s sin θ o s cos ψ o s sin ϕ o s sin ψ o s cos ϕ o s sin θ o s cos ψ o s cos θ o s sin ψ o s cos ϕ o s cos ψ o s sin ϕ o s sin θ o s sin ψ o s sin ϕ o s cos ψ o s cos ϕ o s sin θ o s sin ψ o s sin θ o s sin ϕ o s cos θ o s cos ϕ o s cos θ o s where ψ o s θ o s and ϕ o s are the offset between the yaw pitch and roll angles of the sins and the outer middle and inner axes of the rate table respectively in practice it is not possible to install the sins on a vessel accurately the role of the rate table frame in this experiment is similar to that of the vessel body frame therefore this method can be used in the practical implementation of sins on a vessel the result of reducing the error obtained through the proposed method is shown in fig 9 in the following initial self alignment is performed under the craya motion conditions by the ekf ckf and rsa methods fig 10 shows the true north and heading angle changes using the ekf ckf and rsa methods in this test the angular velocity of the yaw axis is equal to 0 5deg sec furthermore the heading angle error for both methods is calculated and plotted by equation 81 at each instant 81 ψ e r r o r t ψ t a b l e t ψ s i n s t in this equation ψ t a b l e t is the output value of the yaw axis of the rate table which is equivalent to the true north value ψ s i n s t is the value of the heading angle calculated by sins which can be calculated from different methods according to fig 10 and table 3 the performance superiority of the proposed method is clearly visible compared to the traditional methods and the heading angle obtained by the rsa method is much better than that of the ekf and ckf methods in the rsa method the heading angle converges rapidly in less than 100 seconds fig 11 and fig 12 show the changes in roll and pitch angles along with their errors the values of ϕ e r r o r t and θ e r r o r t are obtained similarly as in equation 81 not only the rsa fluctuations are less than that of the ekf and ckf but also its convergence is faster for more detailed analysis ten tests were performed in these tests the yaw axis has rotated at 0 1 0 2 0 5 1 2 deg sec because all the test results cannot be plotted the rms errors associated with the yaw angle of all tests for the ekf ckf and rsa methods at each instant t are calculated by the following equation 82 r m s e ψ t 1 n i 1 n ψ e r r o r i t 2 where i is the ith test and n represents the total number of tests the rmse values for roll and pitch angles are also calculated as in 82 the rmse value of the heading roll and pitch angles at any time are shown in fig 13 and fig 14 it is clear that the convergence and accuracy of the heading angle in the tests of rsa have better results than that of the ekf and ckf methods furthermore the roll and pitch angles for rsa have fewer fluctuations and better accuracy in less than 100 seconds 6 conclusions the best self alignment method should have the highest precision in a short time in all sea conditions this paper introduced a non periodic continuous unidirectional motion called craya motion in practice the self alignment of a marine sins under the craya motion is a challenging problem to overcome this problem an effective rsa method without the external aiding sensors was introduced the rsa extracts the attitude matrix based on the matrix decomposition technique according to this vector observations are generated and the attitude matrix in the first moment is achieved by solving the wahba s problem furthermore vector observations are investigated for compensating the lever arm effect simulations and experiments in the presence of craya motion and without compensating the lever arm effect showed that the proposed rsa method effectively performs a faster and more accurate self alignment compared with the conventional self alignment methods 
22644,in this paper a robust and fast self alignment method under an undesirable non periodic unidirectional vessel motion is proposed the proposed method is based on the attitude determination technique which transforms the alignment procedure into an attitude determination problem by creating infinite vector observations the method implements the quaternion estimator quest attitude determination technique which reduces the computational complexity in practical implementations and accomplishes the alignment task more robustly and accurately compared with the kalman filter based alignment methods in a specific time interval simulation and also experimental results show that the proposed technique has more accurate and faster responses compared to the conventional methods based on the kalman filter keywords initial self alignment attitude determination strapdown inertial navigation system compensation of the lever arm effect vessel body motion 1 introduction in the initial alignment phase the attitude matrix between the inertial measurement unit imu frame and local navigation frame is computed over a limited time the initial alignment in strapdown inertial navigation systems sins and inertial compass systems is a significant step which must be performed before the navigation phase the performance of sins is related to the accuracy and rapidity of the initial alignment process therefore most of the researches have been focused on these two factors gao et al 2011 2015 the initial alignment is accomplished by utilizing external attitude information or independently which is referred by transfer or autonomous alignment respectively gong et al 2018 zou et al 2018 xu et al 2017 the autonomous alignment methods perform the alignment phase using two different approaches accordingly in the first approach the sins uses the position and velocity information of external sensors to accomplish the initial alignment process xu et al 2017 chang et al 2017 in the second approach the self alignment is performed by a stationary or quasi stationary model assuming that the vehicle is fixed with respect to the earth silva et al 2017 li et al 2018 self alignment often consists of two consecutive stages coarse alignment and fine alignment titterton et al 2004 noureldin et al 2013 in the coarse alignment stage the attitude matrix between the body and navigation frames is estimated approximately and then it is used as the initial value in the fine alignment phase the coarse alignment duration can be varied due to the warm up time of the inertial sensors the application and imu design in the fine alignment the attitude matrix is obtained accurately in the conventional kalman filter kf based alignment the differences between s1ns s computed outputs and measurement reference data is utilized as the measurement vector to accomplish the alignment task the kf estimates the position velocity and attitude errors by using the dynamic error model and the stochastic model of sensors the kf based self alignment methods are model based approaches titterton et al 2004 noureldin et al 2013 ben et al 2016 rahgoshay et al 2017 accordingly the performance of these methods is highly dependent on proper modeling therefore the performance of the kf based self alignment method is considerably related to the coarse alignment accuracy adjustment of the initial parameters the type of maneuvers and motions of the vehicle sun et al 2015 shao et al 2018 allottaet al 2016 lever arm error in sins is the result of the distance between the sins and the reference locations which adversely affects the performance of the alignment process wang et al 2017 accordingly to reduce the impact of the lever arm effect it is better to mount the sins near the reference such as gps antenna or doppler velocity log sensors which is impossible in practical applications in the self alignment methods the outputs of sins are compared with the stationary and quasi stationary models with the assumption that the sins is mounted in the center of gravity of the vessel however the sinss are not usually installed in the center of gravity of the vessel due to location constraints self alignment of sins in the presence of undesirable vessel motions is a critical issue especially when no external aided sensors are used in practical marine applications the sins might experience non periodic and unidirectional body motions which lead to performance degradation of the initial alignment especially when the alignment time is short in the rough sea conditions measurement errors which are the result of the lever arm in vessel maneuvers will act as a reliable input and mislead the self alignment process titterton et al 2004 the self alignment methods have been presented with the assumption that the vessel has periodic motion along three axes of roll pitch and yaw so the lever arm is ineffective in alignment interval constantin and kieffer 2000 iso8728 2014 wu et al 2011 these papers assume that the integration of the angular and linear disturbing forces in the time interval of the alignment is near zero gao et al 2011 gu et al 2008 yueyang et al 2009 nevertheless in some practical cases unlike the periodic motions of roll and pitch axes the yaw axis of the vessel experiences a non periodic continuous unidirectional motion caused by the sea waves regarding unexpected linear velocities caused by disturbing forces the performance of self alignment techniques have a considerable reduction in the rough sea conditions therefore choosing a proper self alignment technique is an important issue to perform the alignment faster and more accurate in this condition accordingly in recent years attitude matrix decomposition based methods have been proposed for the vehicles under swaying or maneuvering conditions for alignment by using the attitude determination methods silson 2011 wu and pan 2012 zhang et al 2018 chang et al 2015a 2015b these methods transform the alignment procedure into an attitude determination problem using infinite vector observations they accomplish the alignment task more robustly and accurately compared with the kf alignment methods in a specific time interval however these methods have some disadvantages such as high memory usage chang et al 2015a 2015b the rigorous computational burden in real world implementation and unbounded growth in matrix calculations and consequently eigenvalues related to the attitude determination method wu et al 2011 wu and pan 2012 usually the vessel motion during the alignment is under the mooring or swinging due to the berthing at the pier before the move but the condition will be different when the sins is restarted in the middle of the sea or the vessel is separated from the pier due to the rush before the end of the alignment phase additionally the alignment will be difficult in a variety of applications where the sins system directly enters into the water for example hydroacoustic aided inertial navigation hain remotely operated underwater vehicle rov dredging sonar motion reference and so on this paper proposes a robust self alignment rsa method for marine sins in the presence of undesirable and incidental motion of the vessel we call this non periodic continuous unidirectional motion as continuous rotation away yaw axis craya the proposed self alignment is based on the attitude matrix decomposition technique in attitude determination problem the rsa algorithm performs the initial alignment process without using any aided external sources this method is based on the formation of infinite vector observations through inertial sensors and accurate grand geometric information until the present time accordingly extraction is a continuous method for determining the real time attitude in the dynamic form to reduce the computational complexity in the attitude determination methods in addition to normalizing the vector observations the rsa algorithm performs a continuing attitude determination by using the quaternion estimator quest method shuster and oh 1981 shuster 2006 markley and mortari 2000 unlike conventional attitude determination methods used in the alignment procedure of sins the proposed technique represents a robust and simple structure solution and aims to overcome the mentioned disadvantages the simulation and experimental results show that the proposed self alignment under craya motion condition presents a faster and more accurate solution compared with the conventional kf based methods additionally to compensate the lever arm effect the vector observations are calculated and introduced the rest of this paper is organized as follows in section 2 the craya motion is introduced the rsa is proposed in section 3 section 4 investigates the compensation of the lever arm effect in section 5 the superiority of the proposed method is shown by the results of simulation and also experimental tests finally conclusions are drawn in section 6 2 introducing the craya motion a vessel may experience different types of motions under various sea conditions these movements are divided into two types of linear and rotational motions see fig 1 the linear movements include three species which are called surge sway and heave and rotational motions consist of three types namely roll pitch and yaw zhou et al 2019 wang et al 2018 as previously mentioned it is assumed that the integration of the angular and linear disturbing forces in the time interval of the alignment is near zero in the craya motion it is assumed that the vessel experiences periodic and zero mean linear movements along the body axes on the other hand unlike the periodic and zero mean angular motions along the horizontal body axes the vessel has a non periodic continuous unidirectional motion along the z axis which is affected by the sea waves the amplitude and period of the roll and pitch motions are varied due to the dimensions of the vessel and the force of the sea waves lawther and griffin 1986 for example a huge vessel has fewer changes in pitching angles than a small one the amplitude and period of the roll and pitch motions are selected according to iso dis 8728 standard constantin and kieffer 2000 i 8728 2014 according to this standard the yaw axis is constant during the test of settling time on a scorsby table moreover the roll and pitch axes have the following periodic and zero mean motions roll axis peak amplitude 5 o 1 o period 15 s 1 s pitch axis peak amplitude 5 o 1 o period 6 s 1 s then the gyrocompass or sins should perform the initial alignment under this dynamic motion but according to fig 1 in craya motion in addition to the roll and pitch axes the yaw axis is also changed generally in the yaw axis several types of dynamics can be considered as follows the value of the yaw axis is the same as the test expressed in the iso dis 8728 standard the value of the yaw axis such as the scorsby test in the iso dis 8728 standard changes as a simple harmonic motion with a zero mean the value of the yaw axis is changed in a harmonic motion but the mean is non zero and variable the amount of yaw axis is continuously increasing or decreasing initial alignment with the last assumption is a critical and challenging problem in the self alignment of marine sins the craya motion is also considered as this type of yaw dynamic which has a harmonic motion in the roll and pitch axes 3 the proposed robust self alignment method in this section a robust self alignment rsa algorithm is presented and performed without external aid sources the rsa method is based on the formation of unlimited vector observations through inertial sensors and accurate ground geometric information until the present time accordingly extraction is a continuous method for determining the real time attitude in the dynamic form these infinite vectors are used only to define an attitude vector that in fact is paused at the beginning of alignment on the other hand due to the plurality of vectors a memory method must be used to determine the initial attitude in the real world therefore the rsa has used a continuing attitude determination method based on quest method in the following the rsa algorithm is introduced in two parts including the construction of the observation vectors and quest method to solve the wahba s problem 3 1 construction of the observation vectors unlike the kf based self alignment methods the attitude matrix is determined directly without using the error state model it is assumed that the imu frame coincides the body frame of the vessel perfectly the purpose of sins initial self alignment is to determine the transformation matrix c b n t where t 0 t f b and n represent the body frame and the local navigation frame respectively in accordance with the chain rule of the transformation matrix the c b n t can be decomposed into three parts as 1 c b n t c n 0 n t c b 0 n 0 c b t b 0 c n 0 n t c b n 0 c b t b 0 where b 0 and n 0 are inertial frames of body and navigation at the start of the initial self alignment the c b 0 b t and c n 0 n t describe the changes in body frame and the navigation frame from starting time to moment t respectively their rate equations are 2 c b t b 0 c b t b 0 ω i b b 3 c n t n 0 c n t n 0 ω i n n where x denotes the skew symmetric matrix of x the ω i b b is the vessel angular rate of the body frame with respect to the inertial frame measured by the gyroscopes note that 4 ω i n n ω i e n ω e n n in which ω e n n is the angular rate of the navigation frame with respect to the earth frame and ω i e n denotes the earth rotation rate with respect to the inertial frame and can be expressed as 5 ω i e n 0 ω i e cos φ ω i e sin φ t 6 ω e n n v n r n h v e r e h v e tan φ r e h t where ω i e denotes the earth rotational rate and φ denotes the geographic latitude v n and v e denote the north and east velocities respectively r n and r e denote the north and east earth radiuses respectively and h is the altitude the velocity equation formulated in the navigation frame is given by 7 v n c b n f b 2 ω i e n ω e n n v n g n where f b denotes the specific force vector which is described in the body frame v n denotes the linear velocity vector in the navigation frame and g n is the gravity vector in the navigation frame which can be expressed as 8 g n 0 0 g t where 9 g g w g s 0 1 g w g s 1 sin 2 φ 1 ε 2 sin 2 φ where according to wgs 84 ellipsoid constants g w g s 0 9 7803267714 m s 2 g w g s 1 0 00193185138639 and ε 0 0818191908426 are gravity at the equator gravity formula constant and first eccentricity respectively rogers 2007 performing zero velocity update zupt equations 4 and 7 change as follows 10 ω i n n 0 ω i e cos φ ω i e sin φ t 11 c b n t f b g n substituting 1 into 11 yields 12 c n 0 n t c b n 0 c b t b 0 f b g n multiplying c n t n 0 on both sides of 12 results in 13 c b n 0 c b t b 0 f b c n t n 0 g n assuming that 14 b t c b t b 0 f b r t c n t n 0 g n equation 13 can be rewritten as the vector observations based measurement model for c b n 0 as 15 c b n 0 b t r t where b t and r t are vectors measured in the body and reference frames respectively therefore when the sensor data is updated at any moment a new pair of vector observations will be added in order to perform the self alignment it is first necessary to determine c b n 0 by solving equation 15 and then using equation 1 to solve equation 15 the vector observations b t and r t are computed at each instant in the self alignment r t can be accurately calculated at any moment due to its independence from the external sources on the other hand b t depends on the values of accelerometers and gyroscopes measurements therefore at any moment it is varied due to the linear and rotational disturbances an effective method to reduce the effects of disturbances is performing the integration over the entire alignment time interval however due to accumulative errors in alignment the integration over the entire time interval is not proper for low cost sins such as mems since in rsa the purpose of self alignment is for navigation grade sins the integration is obtained from the beginning to the moment t therefore vector observations are calculated as 16 b i n i b i n i 1 c b i 1 t b 0 0 t f b d t 1 2 0 t ω i b b d t 0 t f b d t 2 3 0 t 2 ω i b b d t t 2 t f b d t 0 t 2 f b d t t 2 t ω i b b d t 17 r i n i r i n i 1 c n i 1 t n 0 t i t 2 2 ω i n n g n where i is an integer for the current sampling data i e i t t and t is the time interval between the two sampling data the initial values are assumed to be b i n 0 r i n 0 0 3 1 and c b b 0 c n n 0 i 3 3 according to equations 2 and 3 c b i 1 b 0 and c n i 1 n 0 are calculated as 18 c b i 1 t b 0 c b i t b 0 exp i t i 1 t ω i b b d t c b i t b 0 exp σ b 19 c n i 1 t n 0 c n i t n 0 exp i t i 1 t ω i n n d t c n i t n 0 exp σ n where c n 0 n 0 c b 0 b 0 i 3 3 the σ n can be calculated as follows due to the slow time varying characteristic of the vector ω i n n 20 σ n i t i 1 t ω i n n d t t ω i n n on the other hand the vector ω i b b can be variant in space over the time intervals and consequently σ b is obtained as follows 21 σ b i t i 1 t ω i b b d t 2 3 i t i t t 2 ω i b b d t i t t 2 i 1 t ω i b b d t equation 21 is proposed to compensate the effect of ω i b b variations over the time intervals exp σ x can be calculated as 22 exp σ x i σ x σ x 2 2 σ x 3 3 i 1 σ x 2 3 σ x 4 5 σ x 1 2 σ x 2 4 σ x 4 6 σ x 2 i sin σ x σ x σ x 1 cos σ x σ x 2 σ x 2 as a remark the integrals represented in equations 16 and 21 are incremental values the outputs of high grade inertial sensors are represented in incremental form ordinarily so these values are usually available directly otherwise to achieve the linear velocity and the angle of rotation in short intervals t the integration of the output of inertial sensors should be performed additionally the integration of the entire alignment time causes the eigenvalues of the k matrix in the quest method to greatly enlarge therefore the normal vector observations are necessary at any moment and the eigenvalues will be close to one the vector observations are expressed as 23 b i b i n i b i n i r i r i n i r i n i where i is written as the subscript for the sake of simplicity since c b n 0 is a constant equation 15 is rewritten as 24 c b n 0 b i r i knowing the values of b i and r i we can obtain the c b n 0 though in this case the vector observations are received over time infinitely and continuously when the number of vector observations increases it is necessary to solve the wahba s problem to obtain the orthogonal matrix wahba 1965 mortari 1997 wahba formulated the following cost function 25 j c 1 2 i 1 n α i b i c r i 2 where α i is a non negative weight and is the euclidean norm b i is a set of n unit vectors measured in the body frame r i is the corresponding unit vectors in the reference frame navigation frame and c is transformation matrix the wahba cost function can also be written as shuster 2009 26 j c const l c where l c is the gain function given by 27 l c tr b t c and the attitude profile matrix b is defined by 28 b i 1 n α i b i r i t the optimal matrix c b n 0 is obtained by solving the wahba s problem attitude matrix can be computed at each moment by updating c b n 0 in equation 1 3 2 quest method to solve the wahba s problem in this part the quest method is suggested as a real time solution to wahba s problem let the quaternion be denoted as 29 q q 1 q 2 q 3 q 4 e q where e q 1 q 2 q 2 t and q q 4 are the vector and scalar parts respectively according to equations 28 and 29 equation 27 can be rewritten as 30 l c q i 1 n α i b i t c q r i i 1 n α i b i t ξ t q ψ t q r i where 31 ψ q q i 3 e e t q 4 q 3 q 2 q 1 q 3 q 4 q 1 q 2 q 2 q 1 q 4 q 3 and 32 ξ q q i 3 e e t q 4 q 3 q 2 q 1 q 3 q 4 q 1 q 2 q 2 q 1 q 4 q 3 after some manipulations equation 30 can be obtained as 33 l c q i 1 n α i b i 0 t q t q r i 0 i n α i b i q t r i q q t i n α i b i t r i q q t k b q where 34 q ψ q q 35 q ξ q q 36 q q q e q e e e q q e e 37 q q q e q e e e q q e e and k b is the symmetric traceless matrix 38 k b b b t t r b i 3 z t z t r b with 39 z b 23 b 32 b 31 b 13 b 12 b 21 t i 1 n α i b i r i the quaternion satisfies a single constraint which is q t q 1 this constraint can be taken into account by the method of lagrange multipliers a new gain function φ c q can be defined as 40 φ c q q t k b q λ q t q through the solution of equation 40 by straightforward differentiation we have 41 φ q k b λ i q 0 so 42 k b q λ q thus q b n 0 must be an eigenvector of k b and l c q will be maximized if q b n 0 is chosen to be the eigenvector of k b belonging to the largest eigenvalue of k b therefore 43 k b q b n 0 λ max q b n 0 is the desired result in the next step it is essential to use a suitable method to obtain the λ max due to the high output rate of the inertial sensors there is a short time to perform the calculation of the existing algorithms in the real time practical implementation the quest method is a useful way to solve wahba s problem in the real world therefore in this paper the quest is applied as a continuous problem nevertheless according to equation 38 the k b can be calculated in the real time as 44 k b i k b i 1 α i b i r i t b i r i t t t r b i r i t i 3 b i r i t b i r i t r b i r i t where k b 0 0 and 45 b i b i 1 α i b i r i t where b 0 0 3 3 according to equation 29 38 and 43 46 b i b i t t r b i i 3 z i t z i t r b i e b n 0 q b n 0 λ max e b n 0 q b n 0 0 where e b n 0 and q b n 0 are vector and scalar parts of the q b n 0 respectively and 47 z i z i 1 α i b i r i where z 0 0 3 1 equation 46 is equivalent to the two equations 48 s i ζ i i 3 e b n 0 z i q b n 0 0 z i t e b n 0 t r b i λ max q b n 0 0 where 49 s i b i b i t 50 ζ i t r b i λ max from 48 one can obtain 51 e b n 0 q b n 0 ζ i i 3 s i 1 z i q b n 0 υ i γ i where 52 υ i adj ζ i i 3 s i z i γ i det ζ i i 3 s i according to q t q 1 the optimal quaternion can be expressed as 53 q b n 0 1 γ i 2 υ i t υ i υ i γ i therefore if λ max is known q b n 0 can be obtained according to equation 53 substituting 51 in 48 one can obtain 54 p λ max λ max 4 a 1 a 2 λ max 2 a 3 λ max a 1 a 2 a 3 t r b i a 4 where a 1 t r b i 2 t r adj s i a 2 t r b i 2 z i t z i a 3 det s i z i t s i z i and a 4 z i t s i 2 z i to solve the polynomial equation 54 the newton raphson iteration is used as 55 λ max i 1 λ max i p λ max i d p λ max d λ λ λ i λ 0 1 according to equations 54 and 55 λ max is close to λ 0 therefore one step iteration for λmax is always sufficient markley and mortari 2000 the algorithm of the rsa is shown in fig 2 as a block diagram in this block diagram the steps to get the body and reference measurement vectors are shown with orange and purple respectively the steps for obtaining the initial rotation matrix from the vector observations are indicated in green and the real time attitude is depicted in red 4 compensation of the lever arm effect in the proposed rsa method as explained in sections 2 and 3 the rsa is performed for no aided external source e g gps or speed log on the other hand in craya motion due to the lever arm disturbing forces are created and the accelerometers are measured at any moments therefore in this section the lever arm effect compensation is studied as a remark amateur users usually do not know the amount of the lever arm or it is not considered correctly in the real world therefore the purpose of the rsa is to provide a robust method against the velocity error caused by the lever arm in the rough sea conditions therefore in section 5 all of the results will be without lever arm compensation nevertheless for eliminating the effect of the lever arm the vector observations are derived in theorem 2 so in practice the system designer can implement rsa by compensating the lever arm effect in theorem 2 if the lever arm is known approximation of the linear velocity at the sins location will be possible according to theorem 1 consequently the approximated velocity vector can be used as an aiding velocity measurement in fact by performing this procedure the lever arm effect is compensated for the self alignment lemma 1 noureldin et al 2013 the rate of change of directional cosine matrix dcm in general is given as 56 c k m c k m ω m k k theorem 1 the velocity error under the influence of lever arm in self alignment is δ v n c b n ω i b b d b where the vector d b d x d y d z is the value of lever arm in meters and ω i b b t is given as 57 ω i b b 0 ω z ω y ω z 0 ω x ω y ω x 0 where the values of ω x ω y and ω z are the angular velocities measured by the gyroscopes in the x y and z axes of the body frame respectively proof the positioning equation in the inertial device is defined as 58 r s i n s i r c g i d i where r s i n s i and r c g i are the position vectors relative to the inertial frame to the designated location for sins and the center of gravity location respectively d i is the distance from the center of gravity to the sins the time rate of change of 58 defines the relationship between velocities relative to the inertial frame at the sins and center of gravity 59 v s i n s i v c g i d i by transforming to n frame axes multiplying c i n on both sides results in 60 v s i n s n v c g n c i n d i assuming that v c g n 0 we have 61 δ v n c i n d i given that d i c b i d b the equation 61 is rewritten as 62 δ v n c i n c b i d b c b i d b assuming that the value of d b is constant and using lemma 1 we have 63 δ v n c b n ω i b b d b therefore the proof is completed if theorem 1 is used in the rsa this method will not be optimal therefore theorem 2 is proposed theorem 2 to compensate for the lever arm effect in the rsa method the vector observations are determined as follows 64 b l a i b l a i b l a i r l a i r l a i r l a i where b l a i and r l a i are given as 65 b l a i c b i t b 0 f b ω i b b 2 ω i b b d b r l a i c n i t n 0 g n proof substituting 63 into 7 yields 66 c b i ω i b b d b c b n ω i b b d b c b n ω i b b d b c b n f b 2 ω i e n ω e n n c b n ω i b b d b g n d b is constant using lemma 1 and transferring the 2 ω i e n ω e n n to the body frame results in 67 c b n ω i b b ω i b b d b c b n ω i b b d b c b n f b c b n 2 ω i e b ω e n b c b n ω i b b d b g n where ω i e b and ω e n b are respectively the rotation rate of the earth with respect to the inertial frame and the rotation rate of the navigation frame with respect to the earth frame expressed in the body frame after simplification 68 c b n f b 2 ω i e b ω e n b c b n ω i b b ω i b b 2 ω i b b d b g n by substituting the value of c b n from the equation 1 and multiplying c n i t n 0 on both sides one has 69 c b n 0 c b i t b 0 f b 2 ω i e b ω e n b c b n ω i b b ω i b b 2 ω i b b d b c n i t n 0 g n the effect of the lever arm is not important in a stationary state in rotation state the value of 2 ω i e b ω e n b is much less than ω i b b so the 2 ω i e b ω e n b in equation 69 is ignored therefore equation 69 is converted to 70 c b n 0 c b i t b 0 f b ω i b b 2 ω i b b d b c n i t n 0 g n with respect to equation 15 the values of b l a i and r l a i are obtained therefore the proof is completed 5 simulations and experiments in this section we carry out simulations and experimental tests of the craya motion for sins the proposed initial self alignment method has been compared with the conventional extended kalman filter ekf and cubature kalman filter ckf self alignment method to show its performance in the presence of the craya motion the duration of 30 seconds has been assigned to carry out the coarse alignment phase for using ekf and ckf the gravity in the inertial frame has been used as a reference measurement vector in the coarse alignment phase gu et al 2008 this method has a good performance in sea mooring condition the state and measurement equations are extracted to implement a filtering algorithm in the literature the velocity error vector δ v and the misalignment angles vector ϕ in the navigation frame are considered as the states of the fine self alignment method the nonlinear model of dynamic error of sins has been expressed in 71 zhang et al 2013 zhanxin et al 2007 71 x f x w z h x η where x is the state vector consisting of six states as follows 72 x δ v n δ v e δ v d ϕ n ϕ e ϕ d t in which subscripts n e and d represent north east and down in the navigation frame respectively with the zupt measurements the design matrix will be 73 h 1 0 0 0 0 0 0 1 0 0 0 0 0 0 1 0 0 0 therefore the system and measurement equations are rewritten as follows 74 δ v n δ v e δ v d ϕ n ϕ e ϕ d x cos ϕ d 1 f n sin ϕ d f e 2 ω i e cos φ δ v d g ϕ e sin ϕ d ϕ n sin ϕ d 2 ω i e sin φ δ v e sin ϕ d f n cos ϕ d 1 f e g ϕ e sin ϕ d ϕ n sin ϕ d 2 ω i e sin φ δ v n ϕ e f n ϕ n f e 2 ω i e sin φ δ v n sin ϕ d ω i e cos φ ϕ e ω i e sin φ δ v e r cos ϕ d 1 ω i e cos φ ϕ n ω i e sin φ δ v n r ϕ e ω i e sin ϕ d ϕ n cos ϕ d ω i e cos φ δ v n tan φ r f x n e d ε n ε e ε d w 75 v n 0 v n i n s v e 0 v e i n s v d 0 v d i n s z 1 0 0 0 0 0 0 1 0 0 0 0 0 0 1 0 0 0 x h δ η v n δ η v e δ η v d η where f n f e f d are specific forces φ is the latitude of the vessel ω i e r are rotation speed and radius of the earth respectively n e d ε n ε e ε d are the projection of accelerometers and gyroscopes instability biases into the navigation frame respectively v n 0 v e 0 v d 0 are the zero update velocities which can be modeled either as zeros or as very tiny values v n i n s v e i n s v d i n s are the ins output velocities δ η v n δ η v e δ η v d are the uncertainties around the zero velocity the filtering parameters x 0 p 0 and r are considered identical for both ekf and ckf approaches as follows 76 x 0 0 1 3 coarse alignment outputs 1 3 t 77 p 0 d i a g 0 1 m s 2 0 1 m s 2 0 1 m s 2 1 o 2 1 o 2 10 o 2 78 r d i a g 0 01 m s 2 0 01 m s 2 0 01 m s 2 where x 0 is initial state estimate p 0 is the initial covariance of the estimation error and r is the measurement noise covariance the interval of the time update and measurement update for both simulation and experimental results are five millisecond and one second respectively furthermore the same parameters are used in the implementation of the ekf and ckf simon 2006 arasaratnam et al 2010 in the simulation study in addition to the craya motion it is assumed that the lever arm exists and the lever arm value is not set by the user in sins in the experimental study due to the limitation of the rotary table dimensions the lever arm is applied only for a few centimeters 5 1 simulation study there are two scenarios in this subsection both the roll and pitch axes are moved according to the explanation in section 2 in the first scenario it is assumed that the yaw axis rotation and the lever arm value are balanced but in the second scenario these values are severe the two scenarios are as follows first scenario the yaw axis rotation is equal to 0 5 deg sec and the lever arm is equivalent to 10 4 2 t m second scenario the yaw axis rotation is equal to 2 deg sec and the lever arm is equivalent to 40 7 5 t m it is assumed that the bias stability and angular random walk of gyroscope sensors are 0 01 deg hr and 0 001 deg hr respectively furthermore the bias stability and velocity random walk of accelerometer sensors are assumed to be 20 μ g and 0 02 m s hr respectively fig 3 shows the true north and heading angles obtained from the ekf ckf and rsa methods and their errors the error and convergence rate of the heading angle achieved from the proposed rsa are better than that of the ekf and ckf roll and pitch angles are plotted in fig 4 furthermore table 1 shows the mean standard deviation std and root mean square rms of heading error for the first scenario therefore the proposed rsa approach is clearly better fig 5 indicates the heading angle with its error and fig 6 shows the error in the roll and pitch angles of the second scenario in this scenario due to the large disturbing forces the 5 min alignment time is not enough to achieve the desired accuracy of the alignment process so the simulation time duration is 20 min the purpose of this dramatic scenario is to compare the performance of the proposed rsa method with ekf and ckf with no time constraint the initial self alignment in less than 5 min in this scenario is not considered in the ekf and ckf self alignment methods the estimated heading angle accuracy does not meet the desired value even after 20 min in the proposed rsa method the error of the heading angle fluctuates around zero after 5 min and reaches about 0 2 in 20 min in addition using the rsa method convergence and accuracy of the roll and pitch angles clearly outperform the ekf and the ckf furthermore the same as the first scenario table 2 shows a quantitative comparison for heading error of the second scenario therefore the rsa method is truly robust against velocity errors and undesirable accelerations 5 2 experimental results in this section experimental tests are conducted to show the efficiency and effectiveness of the proposed self alignment method the ekf ckf and rsa methods are executed on the same data and their results have been compared to each other a fog based imu consisting of three gyroscopes with a bias stability of 0 05 deg hr and an angular random walk of 0 005 deg hr are used in these tests in addition three accelerometers with a bias stability of 100 μ g and a velocity random walk of 0 08 m s hr have been used to apply the craya motion to the imu a 3 axis rate table of the uoo model has been used see fig 7 and fig 8 using the iso dis 8728 standard roll and pitch axes swing are as follows iso8728 2014 roll axis peak amplitude 5 o 1 o period 15 s 1 s pitch axis peak amplitude 5 o 1 o period 6 s 1 s and the yaw axis rotates continuously the tests are performed in ten different scenarios at various angular velocities about the yaw axis these values are 0 1 0 2 0 5 1 and 2deg sec the negative angular velocities of these values are also considered to examine the results of the tests it is necessary to draw the difference between the output of the sins and the rate table so the imu s outputs and the rate table are stored for offline computations it is essential to synchronize the stored data of the imu and the rate table there are two main problems with the storage of data in the data synchronization the first problem is the difference between imu and rotation table output rates and the second problem is that the data storage is also performed with an undesirable delay in computers for solving these problems a data acquisition board has been used with a delay of less than 10μs according to fig 7 this electronic board is able to add a precise timestamp to the beginning of the data sentences as soon as they receive then it sends information to the computer for storage finally interpolation is used to equalize the output rate as shown in fig 8 the imu is installed at a maximum distance from the center of the rate table it will cause the same effect as sensor sizing making the situation a little harder the imu distance from the center of the rate table is far less than the imu distance from the center of gravity of the vessel in this test therefore this distance cannot be a lever arm and is more like the sensor sizing effect this distance is approximately d b 8 10 0 t c m the value of true north is very closely matched to the value of the outer axis or the yaw axis of the rate table but due to the placement of the imu at the corner of the inner axis of the rate table the imu frame has slightly changed to the rate table frame therefore there exist errors between the angles of roll pitch and heading of the sins and the inner axis the middle axis and the outer axis of the rate table respectively to eliminate this offset the imu set is statically positioned at eight different angles to the yaw axis in each direction it is turned on for 20 min and its data is stored by using the stored data the exact amount of euler angles is calculated in all directions then the mean of the differences between the rate table orientation information and the sins computed outputs in all directions is considered as the installation offset error in dynamic tests the installation error value of these tests is zero for the roll axis and pitch axis and 0 09 for the yaw axis therefore the installation offset value must be compensated the installation offset error value can be applied in two ways by applying a simple method these values can be reduced directly from the euler angle output in this simple method the difference between the output of the sins and the rate table is associated with the error due to the non conformance of the imu frame and the rate table frame see fig 9 in the proposed method to eliminate the effect of the installation error on the difference between the euler angles of sins and the rate table the virtual imu frame should be transferred to the rate table frame therefore according to equation 79 the output of the accelerometers and gyroscopes are multiplied by the transformation matrix c s b by performing this the location of the inertial sensors from the imu frame is moved virtually to the rate table frame 79 f b c s b f s ω i b b c s b ω i s s where f s and ω i s s are respectively the output of accelerometers and gyroscopes in the imu frame the transformation matrix c s b is according to equation 80 80 c s b cos ψ o s sin ψ o s 0 sin ψ o s cos ψ o s 0 0 0 1 cos θ o s 0 sin θ o s 0 1 0 sin θ o s 0 cos θ o s 1 0 0 0 cos ϕ o s sin ϕ o s 0 sin ϕ o s cos ϕ o s cos θ o s cos ψ o s cos ϕ o s sin ψ o s sin ϕ o s sin θ o s cos ψ o s sin ϕ o s sin ψ o s cos ϕ o s sin θ o s cos ψ o s cos θ o s sin ψ o s cos ϕ o s cos ψ o s sin ϕ o s sin θ o s sin ψ o s sin ϕ o s cos ψ o s cos ϕ o s sin θ o s sin ψ o s sin θ o s sin ϕ o s cos θ o s cos ϕ o s cos θ o s where ψ o s θ o s and ϕ o s are the offset between the yaw pitch and roll angles of the sins and the outer middle and inner axes of the rate table respectively in practice it is not possible to install the sins on a vessel accurately the role of the rate table frame in this experiment is similar to that of the vessel body frame therefore this method can be used in the practical implementation of sins on a vessel the result of reducing the error obtained through the proposed method is shown in fig 9 in the following initial self alignment is performed under the craya motion conditions by the ekf ckf and rsa methods fig 10 shows the true north and heading angle changes using the ekf ckf and rsa methods in this test the angular velocity of the yaw axis is equal to 0 5deg sec furthermore the heading angle error for both methods is calculated and plotted by equation 81 at each instant 81 ψ e r r o r t ψ t a b l e t ψ s i n s t in this equation ψ t a b l e t is the output value of the yaw axis of the rate table which is equivalent to the true north value ψ s i n s t is the value of the heading angle calculated by sins which can be calculated from different methods according to fig 10 and table 3 the performance superiority of the proposed method is clearly visible compared to the traditional methods and the heading angle obtained by the rsa method is much better than that of the ekf and ckf methods in the rsa method the heading angle converges rapidly in less than 100 seconds fig 11 and fig 12 show the changes in roll and pitch angles along with their errors the values of ϕ e r r o r t and θ e r r o r t are obtained similarly as in equation 81 not only the rsa fluctuations are less than that of the ekf and ckf but also its convergence is faster for more detailed analysis ten tests were performed in these tests the yaw axis has rotated at 0 1 0 2 0 5 1 2 deg sec because all the test results cannot be plotted the rms errors associated with the yaw angle of all tests for the ekf ckf and rsa methods at each instant t are calculated by the following equation 82 r m s e ψ t 1 n i 1 n ψ e r r o r i t 2 where i is the ith test and n represents the total number of tests the rmse values for roll and pitch angles are also calculated as in 82 the rmse value of the heading roll and pitch angles at any time are shown in fig 13 and fig 14 it is clear that the convergence and accuracy of the heading angle in the tests of rsa have better results than that of the ekf and ckf methods furthermore the roll and pitch angles for rsa have fewer fluctuations and better accuracy in less than 100 seconds 6 conclusions the best self alignment method should have the highest precision in a short time in all sea conditions this paper introduced a non periodic continuous unidirectional motion called craya motion in practice the self alignment of a marine sins under the craya motion is a challenging problem to overcome this problem an effective rsa method without the external aiding sensors was introduced the rsa extracts the attitude matrix based on the matrix decomposition technique according to this vector observations are generated and the attitude matrix in the first moment is achieved by solving the wahba s problem furthermore vector observations are investigated for compensating the lever arm effect simulations and experiments in the presence of craya motion and without compensating the lever arm effect showed that the proposed rsa method effectively performs a faster and more accurate self alignment compared with the conventional self alignment methods 
