index,text
20800,this paper employs numerical simulation to study the hydrodynamics of porpoising behavior in dolphins the virtual swimmer is a three dimensional dolphin like body with prescribed kinematics a four stage model of this behavior is proposed including underwater acceleration upward leap air glide and downward dive when the dolphin goes through these four stages the time history of its displacement velocity force and energy could be solved to elucidate the rules by varying oscillating frequency f and escape angle α various behaviors of the swimmer are simulated to obtain their porpoising performance which are evaluated by maximum leap height h max maximum leap distance d max and leap efficiency η the results show that both h max and d max are increasing functions of f but their trend with α is not monotonic for peak h max generation α occurs at 90 while for peak d max α is ranging from 45 to 60 and nears 50 as for efficiency η increases slowly with the increase of α and first increases and then decreases with the increase of f at a critical value between 7 hz and 8 hz the findings may provide an important hydrodynamics basis for the biomimetic vehicle designs that mimic the porpoising motion of dolphins keywords porpoising behavior dolphins swimming hydrodynamics numerical simulation 1 introduction many aquatic animals perform aerial maneuvers in which they leap from water into air as a typical aerial maneuver manner porpoising behavior has been hypothesized as a strategy for energy economy weihs 2002 the first analysis of this behavior au and weihs 1980 showed that above a critical velocity this behavior is energetically advantageous as the reduction in drag due to glide in the air becomes greater than the added cost of leap this behavior is often performed by fast mammal swimmers such as dolphins au and weihs 1980 gordon 1980 dolphins are thought to be evolved remarkable porpoising abilities to escape predators which are intuitively attractive since the predators may lose sight of the dolphins when they leap into air fish 1993 meanwhile dolphins are treated as high speed and agile swimmers it can swim at speeds up to 20 m s and even leap to heights of over 5 m above the water surface yu et al 2016 to complete the porpoising behavior the dolphin must reach sufficient underwater velocity and momentum to overcome the effects of gravity when it leaves the water this behavior involves the water exit and reentry of a dolphin like flexible body which is essentially a problem of the fluid structure interactions on free surface this problem is also a classic issue in many practical applications i e ship and ocean engineering and physical oceanography the porpoising behavior of dolphins could be divided to four distinct stages an underwater acceleration stage an upward leap stage an air glide stage and a downward dive stage during the entire process the dolphin accelerates and rises to the maximum leap height and then dives back into the water performing a combination of translational and rotational motion the mass center follows a parabolic trajectory which is depending on the critical emergence velocity and the critical emergence angle just before the dolphin leaves the water some early literatures au and weihs 1980 gordon 1980 taylor et al 2003 weihs 2004 fish et al 2006 reported that the emergence angles of leaps by dolphins were widely distributed between 30 for the maximum velocity and 90 for the maximum height au au and weihs 1980 assumed that dolphins would maximize the leap distance by using 45 emergence angle these results provide some guidance for the porpoising dynamics nevertheless all of these studies have focused on experimentally analyzing some discrete leaping cases of dolphins and systematic numerical studies on the hydrodynamics of the porpoising behavior in dolphins are relatively few numerous experiments drucker and lauder 2002 tytell and lauder 2004 muller et al 2008 dewey et al 2012 fish et al 2014 maia et al 2017 had provided a wealth of data in terms of swimming hydrodynamics of live fish however carrying out controlled experiments of various porpoising behaviors is almost impossible in live dolphins this fact emphasizes the difficulties for experimental method alone to provide conclusive findings fortunately such insights can be obtained by using the numerical simulations zhu and shoele 2008 borazjani and sotiropoulos 2010 in the past decade numerical studies on fish swimming have developed rapidly many representative studies have appeared successively zhu and shoele 2008 borazjani and sotiropoulos 2010 bergmann and iollo 2016 li and dong 2016 liu et al 2017 deng et al 2019 khalid et al 2018 including the studies of the propulsion mechanism of certain fin units i e pectoral fin caudal fin dorsal fin etc of fish zhu and shoele 2008 liu et al 2017 and the hydrodynamics studies of different propulsion modes of the whole fish i e anguilliform mode carangiform mode thunniform mode etc borazjani and sotiropoulos 2010 deng et al 2019 and the study of the fish school interaction mechanism khalid et al 2018 furthermore some other scholars have studied the hydrodynamics of the water exit and reentry of the rigid cylinders zhang et al 2010 ni et al 2015 these studies have produced a lot of important findings on the mechanisms of aquatic swimming or water exit and reentry of the rigid body however the hydrodynamics of the porpoising behavior in dolphins which refers to the problems of the water exit and reentry of the flexible body have yet to be reported a major contribution of the present work is to explore a numerical method to solve the problem of the water exit and reentry of the dolphin like flexible body the possibility of the porpoising behavior in dolphins is examined numerically the four stage model is proposed in which the dolphin leaps out of water with the critical emergence velocity at the end of the underwater acceleration stage and then glides in the air and finally dives into the water the hydrodynamics of the dolphin s porpoising behavior are presented in detail and the transient evolutions of the fluid structures are also revealed the findings in this work could provide an important hydrodynamics foundation for biomimetic vehicle designs that mimic the porpoising motion of dolphins 2 physical model and kinematics 2 1 physical model for comparison with the robotic dolphin prototype developed in the laboratory here we use a small dolphin like model as the virtual swimmer which is composed of a main body with a smooth profile and a crescent shaped caudal fin with cross sections of naca 0024 while all minor fins are neglected to match with the robotic dolphin the size of the swimmer x y z is set to 0 72 m 0 16 m 0 2 m as shown in fig 1 the body coordinate system o b x b y b z b and the caudal fin coordinate system o cf x cf y cf z cf are established respectively the origin of the o b x b y b z b is located at the head and that of the o cf x cf y cf z cf is located at the caudal peduncle at the place 0 85 times the swimmer length measured from the head for these two relative coordinate systems x axis y axis and z axis are along the longitudinal direction the vertical direction and the transverse direction of the body respectively to describe the porpoising motion of the swimmer as shown in fig 2 the four stage model is proposed 1 the underwater acceleration stage characterized by high thrust swimming motion under the water until the last moment at which the critical emergence velocity and the critical emergence angle are achieved 2 the upward leap stage i e the water exit stage during the time starting from the emergence of the head till the trailing edge of the tail leaving the water 3 the air glide stage during which rotating the body freely in the air until the time the head starting to fall back to the water with the center of mass following the parabolic path 4 the downward dive stage i e the water reentry stage during the time the swimmer reentering the water with the head first and then the tail and the next loop will be prepared as shown in fig 2 an absolute coordinate system oxyz is also established in which ox axis points to the right in the horizontal direction oy axis points to the top in the vertical direction and oz axis points to the front and forms a right handed system with ox and oy axes at the beginning of the leap stage the swimmer launches itself with the critical emergence velocity and tries the best to accelerate oscillating its body to obtain sufficient ascending velocity and rotational angular momentum and then the majority of the body leaves the water surface and the posterior body does not contribute to thrust production any longer at the end of the leap stage during the glide stage the swimmer is all out of the water and no longer oscillates up and down but straightens the body to keep it straight and rotates itself uniformly around the center of mass under the action of the angular momentum thereby reducing the drag and the energy consumption in the air the swimmer tries to achieve the maximum leap height or the maximum leap distance or other aerial postures and then dives back into the water 2 2 kinematics for porpoising behavior during the porpoising motion the swimmer propels itself by dorsal ventral oscillations of the body the specific kinematics for this behavior consists of two parts i e the undulation of the body and the composite motion of the caudal fin shoele and zhu 2015 the body undulation can be abstracted into a column of traveling wave that spreads from the head to the tail which is described as 1 y x t a t a x sin 2 π t t x λ where y x t is the vertical displacement of the body a t is the time dependent control function during the entire porpoising process a x is the amplitude envelope x is the x axis coordinate t is the time t is the undulation cycle and λ is the wavelength among them the time dependent control function a t is proposed as 2 a t 0 t t 0 t t 0 t 1 t 0 1 2 π sin 2 π t t 0 t 1 t 0 t 0 t t 1 1 t 1 t t 2 1 t t 2 t 3 t 2 1 2 π sin 2 π t t 2 t 3 t 2 t 2 t t 3 0 t 3 t t 4 t t 4 t 5 t 4 1 2 π sin 2 π t t 4 t 5 t 4 t 4 t t 5 1 t t 5 where t 0 is the time at which the swimmer turns from stationary state to start oscillating t 1 is the time from the end of start oscillation to accelerated swimming t 2 is the time from the end of accelerated swimming to start straightening the body t 3 is the time from the end of straightening the body to start gliding in the air t 4 is the time from the end of gliding in the air to start water reentering and t 5 is the time from the end of water reentering to accelerated swimming under the water again in addition the amplitude envelope a x used here is based on the experimental reports in fish fish et al 2006 and romanenko 2002 which can be described as 3 a x a max 0 21 0 66 x 1 1 x 2 0 35 x 8 where a max is the vertical motion amplitude of the caudal peduncle the composite motion of the caudal fin consists of a heave motion and a pitch motion and its kinematics can be depicted as 4 y c f t a t a max sin 2 π t t l b λ θ t a t θ max sin 2 π t t l b λ ϕ where y cf t is the vertical displacement of the heave motion θ t is the angular displacement of the pitch motion and θ max is its amplitude l b is the body length of the swimmer measured from the head to the caudal peduncle and ϕ is the phase difference of the heave motion ahead of the pitch motion 3 numerical method 3 1 governing equations of fluid we consider a three dimensional 3d flow over the dolphin undergoing the porpoising motion the governing equations of the fluid include the mass conservation equation and the navier stokes energy conservation equation written as 5 u i x i 0 6 ρ u i t ρ u i u j x i p x i x i μ μ t u i x j u j x i f i where u i i 1 2 3 are the fluid velocity components in the x i i 1 2 3 i e x y z directions ρ is the density p is the pressure μ is the dynamic viscosity μ t is the turbulent viscosity and f i is the momentum forcing related to the surface tension along the x i direction to solve the equations in a domain containing the virtual dolphin a no slip boundary condition is needed to be imposed on the moving interface with the fluid velocity ζ and the dolphin velocity x written as 7 ζ x since the shape of the dolphin is complex and the curvature gradient changes quickly the flow around the dolphin is a highly complex 3d flow when the dolphin undergoes the porpoising motion the reynolds number re may reach very high close to 105 this value of re is within the inertial regime where turbulence flow dominates the dynamics thus the choice of turbulence model has direct impact on the accuracy of the numerical solution of the flow field both rng k ε and sst k ω turbulence model have good computational performance in the flow involving separation which is an important issue in the numerical simulation of dolphins swimming where separation always occurs in the tail part zhang et al 2010 han and krajnovic 2013 in this work the rng k ε turbulence model is chosen the turbulent kinetic energy k and the turbulent dissipation rate ε are given as 8 ρ k t ρ u i k t x i α k μ μ t k x i ρ g k ε 9 ρ ε t ρ u i ε x i x i α ε μ μ t ε x i c ε 1 ε k g k c ε 2 ρ ε 2 k where g k is the turbulent energy component generated by the velocity gradient α k and α ε are the reciprocals of the effective turbulent prandtl numbers of the k and the ε respectively c ε1 and c ε2 are the model constants 3 2 governing equations of free surface due to the steep density and viscosity gradients on the water surface excessive numerical diffusion is experienced in the computation of the viscous flow here the level set method is used to capture the interface between the two phases zhang et al 2010 the evolution of the level set function γ is governed by 10 γ t u i γ x i 0 the solution of the navier stokes equations will produce undesirable instability at the interface if the density and the viscosity are not continuous there to overcome this a region of limited thickness at the interface is introduced where a smooth but rapid change in density and viscosity occurs zhang et al 2010 this can be achieved by defining a smooth heaviside function h γ given by 11 h γ 0 γ δ γ δ 2 δ 1 2 π sin π γ δ δ γ δ 1 γ δ where δ is the scale parameter related to the grid size the governing equations are associated with different fluid properties by the heaviside function using this function the fluid properties can be calculated as 12 β 1 h β 1 h β 2 where β can be the density viscosity or other properties at the interface 3 3 governing equations of dolphin the motion of the dolphin is in turn described by the newton s equations of motion as 13 m x c f 14 i z φ c i z φ c m z where f is the fluid force vector m z is the fluid torque along the z axis acting on the dolphin m is the dolphin mass which is depicted as the body volume multiplied by the water density x c is the swimming acceleration vector which is time dependent due to the fluid force φ c and φ c are the angular velocity and the angular acceleration which are time dependent due to the fluid torque i z is the inertial moment around the pitch axis i e i z s x 2 y 2 x t d s which is changing in time due to the body deformation and could be obtained by integration and i z is the time derivative of the inertial moment i z it is necessary to note that both spinning and rolling motion of the body are not considered here therefore the feedback of the torque is limited to the pitch axis to simplify the computations the fluid force f and the fluid torque component m z are computed as 15 f s σ n d s 16 m z s σ n x x c e 3 d s where σ is the normal stress vector n is the unit vector along the normal direction x c is the displacement of the mass center ds is the differential unit area along the dolphin surface e 3 is the unit vector along the z direction 3 4 numerical method and computational grid farsighted scholars have developed some successful methods to solve the problems of the free surface interactions shen shen and chan 2008 and peng peng et al 2012 used the immersed boundary method ibm and the volume of fluid vof models to simulate the free surface interaction with the submerged solid body their studies validated the ability of the methods to handle the submerged solid surfaces and to capture the evolution process lin 2007 used the vof one phase model and the cut cell technique to simulate the water entry and exit of the cylinder in this work we applied the vof method with the heaviside function to solve the flow problems the commercial package fluent with the pressure based transient solver is used the deformation motion of the dolphin is realized by using an in house define grid motion macro which is hooked to the main code of the solver the solution of the newton s equations governing the dolphin motion is carried out by an in house user defined function note that the rng k ε model is used here which differs from the standard turbulence model as it includes an additional sink term in the turbulence dissipation equation to account for the non equilibrium strain rates han and krajnovic 2013 therefore the rng k ε model can deal with the flows with high strain rate and large curvature such as the water exit and reentry of the dolphin during the solving process the navier stokes equations are discretized using the finite volume method where a second order crank nicolson scheme is used for the unsteady term a second order upwind scheme is adopted for the convective term and a second order central differencing scheme is employed for the diffusion term pressure velocity coupling of the continuity equation is achieved using the piso algorithm the computational domain is a 12 m 8 m 4 m cubic tank with the water depth 5 m as shown in fig 3 the head of the dolphin is 2 5 m below the water surface the inlet boundary and outlet boundary are defined as a pressure inlet and an outflow condition respectively and 1 atm is throughout taken as the reference pressure and the no slip wall boundary condition is imposed on the top bottom front and back of the domain unstructured tetrahedral grids are chosen to handle the large deformations due to the dolphin s porpoising motion as shown in fig 4 the overall computational domain is discretized with the unstructured mesh including nearly 1 2 107 grids the computational domain includes a background mesh enclosing the entire solution domain and a small overset mesh a small cubic box containing the virtual dolphin the overset mesh moves with the dolphin the surface of the dolphin is discretized to triangular grids with 0 001 m edge lengths and the surface of the cubic box is divided into triangular grids with 0 002 m edge lengths while the surface of the computational domain is separated into triangular grids with 0 01 m edge lengths the volume between the surface of the dolphin the cubic box surface and the computational domain surface is all discretized into the tetrahedral control volumes it is important to note that the mesh grids are locally refined near the dolphin region inside the small cubic box to ensure the requirement of y plus of the wall function at any time if the value of y plus is in the proper range it means that the grid of the first boundary near the wall is reasonable if the value of y plus is not reasonable the boundary grid needs to be readjusted an enhanced wall function is adopted here to simulate the flow near the wall which is due to that han han and krajnovic 2013 once reported that the application of the k ε turbulence model with the enhanced wall function in the region of y plus 5 can accurately simulate the flow near the wall 3 5 sensitivity study a grid sensitivity study is carried out using three successively grids including 3 7 106 1 2 107 and 4 5 107 grids respectively the uniform edge length for the three different grids is 0 02 m 0 01 m and 0 005 m corresponding to 3 7 106 coarse 1 2 107 nominal and 4 5 107 fine grid cells respectively the grid sensitivity study is carried out for the oscillating frequency of 8 hz unchanged and the escape angle ranging from 30 to 90 for each grid the domain size time step and boundary conditions are the same as those used for the nominal grid which is the grid used for all simulation cases fig 5 shows the variations of the maximum leap distance with the escape angle for three different grid cells it is evident from this figure that both the nominal and fine grids give reasonable results which are very close to each other while the coarse grid is not sufficiently accurate to obtain the reasonable results then we conclude that the results obtained on the nominal grid are insensitive to further grid refinement and therefore this is the grid size selected for all simulation results reported in this work furthermore it is necessary to point out that if the time step is too small it will take up a lot of computing resources especially in the case of 3d dynamic mesh simulation conversely if the time step is too large the displacement of the grid node in each time step exceeds the scale of the grid itself and the grid may cause negative volume or excessively large aspect ratio which is not conducive to the simulation a sensitivity study on the time step is also carried out using three different time steps of t 80 t 200 and t 500 with the nominal grid to be consistent with the above the porpoising behaviors of the dolphin are simulated at the oscillating frequency of 8 hz unchanged and the escape angle ranging from 30 to 90 the variations of the maximum leap distance with the escape angle for three different time steps are given in table 1 where δt t 200 proved to be suitable consequently the setup with the nominal grid and the time step of δt t 200 allows a satisfactory computation and it is chosen for all simulations of the porpoising behavior in dolphins in this work 3 6 validation test the numerical method has been validated to simulate the water exit and entry of the cylinder here the same parameters are used as those in the ref zhang et al 2010 the cylinder of r 1 m is placed in calm water in a cubic tank and the distance of its center to the free surface is d 1 25 m the cylinder is given a constant upward velocity v 0 39 m s thus the dimensionless time is defined as τ vt d snapshots of the interaction between the cylinder and the interface are shown in fig 6 as the cylinder moves upward two shear layers are developing along left and right sides two vortices shed from these two shear layers and interact with the free surface the computed results are compared with the results reported by ref zhang et al 2010 very good agreement is observed for the case of the water entry the same parameters are used as reported by ref zhang et al 2010 the cylinder starts its downward motion from the height of 1 25 m to the calm water with the constant velocity v 1 0 m s snapshots of six different instants are shown in fig 7 the free surface is captured very well as the cylinder moves close to the free surface a small gap is observed between the free surface and the cylinder and causing the free surface to deform as the cylinder moves further downward a large amount of water is pulled down when the cylinder is fully submerged in the water there is a water jet in the center of the water surface these findings are very close to the results reported in ref zhang et al 2010 as the cylinder undergoes the water entry process the slamming coefficient could be defined as c s f ρrv 2 where f is the total vertical hydrodynamic force r is the radius of the cylinder and v is the entry velocity for validation we choose the case performed at the same parameters as used in the ref zhang et al 2010 for which numerical results have been reported the total vertical hydrodynamic force on the cylinder has been calculated and compared in a dimensionless form fig 8 shows the comparison of the slamming coefficient and the penetration depth between the present results and the numerical results of the ref zhang et al 2010 and the ref kleefsman et al 2005 it is clear that the calculated slamming coefficient is in reasonable agreement with the previous results 3 7 porpoising performance parameters it is significant to define the leap distance or the leap height to evaluate the performance of dolphin s porpoising motion note that the maximum leap distance of the dolphin measured from the leaping point to the diving point along the horizontal direction is denoted as d max the time spent out of water is expressed as t out when the dolphin has leaped out of the water and is undergoing the glide stance the maximum leap height measured from the water surface to the highest point reached in the vertical direction is described as h max these performance parameters could be calculated by 17 d max v c e 2 g sin 2 α c e t out 2 v c e g sin α c e h max v c e 2 2 g sin 2 α c e where v ce is the critical emergence velocity g is the acceleration of gravity and α ce is the critical emergence angle the energy changes in the dolphin s porpoising motion are very complex in the acceleration stage the dolphin gains its own energy by continuously overcoming the fluid force and the torque during the upward leap stage the dolphin will lose the energy of the water attached to the body and into the air in the air glide stage ignoring the tiny air resistance to do work the energy of the dolphin is almost unchanged when the dolphin reenters the water the dolphin needs to accelerate the energy of the water attached to the body and into the water after the dolphin is completely underwater it gains energy by oscillating itself again during the whole porpoising process the velocity of the dolphin is constantly changing and then its kinetic energy function e k t can be expressed as 18 e k t 1 2 m v x 2 t v y 2 t where vx t and vy t are the x and y velocity components of the dolphin at time t when the dolphin is swimming underwater since the density of the dolphin is assumed to be the same as the density of the water the gravity of the dolphin and the buoyancy of the water acting on the dolphin are also equal therefore the gravity potential energy of the dolphin at any time and any position is equal under the water in this sense we can assume that the water surface is the zero potential energy surface of the dolphin when the dolphin is leaping or reentering the water part of its body is underwater and the other part is in the air so it is simultaneously affected by the gravity and the water buoyancy at this time the gravity and the buoyancy are not equal so the gravitational potential energy ep t can be described as 19 e p t 0 t g f b u o t v y t d t where g is the gravity of the dolphin fbuo t is the buoyancy at time t which can be computed as 20 f b u o t ρ w g v d o l 0 t t 2 ρ a g v d o l a t ρ w g v d o l v d o l a t t 2 t t 3 ρ a g v d o l t 3 t t 4 ρ w g v d o l w t ρ a g v d o l v d o l w t t 4 t t 5 ρ w g v d o l t t 5 where ρ w and ρ a are the density of water and air respectively v dol is the volume of the dolphin v dola t is the volume exposed to the air when the dolphin leaps and is related to the geometric parameters of the dolphin the y displacement and the emergence angle during the leap v dolw t is the volume of the dolphin immersed in the water when it reenters and is determined by the geometric parameters of the dolphin the y displacement and the entry angle when reentering the definitions of t 2 t 5 are the same as above in the whole process of the porpoising movement the energy obtained by the dolphin includes two parts one part is the kinetic energy e k t and the other part is the gravitational potential energy ep t therefore the total energy obtained e ob t by the dolphin can be expressed as 21 e o b t e k t e p t the total energy consumed by the dolphin also consists of two parts the work to overcome the fluid reaction force and the work to overcome the fluid reaction torque therefore the total energy consumed e con t during the dolphin s porpoising motion can be given as 22 e c o n t σ x d s d t σ x x c φ d s d t where x and φ are the velocity vector and the angular velocity vector of the ds on the surface of the dolphin the dolphin could achieve the porpoising behavior by overcoming the reaction force and the reaction torque and consume lots of energy at the same time the dolphin also gains part of the energy it has been confirmed in the following results that during the air gliding stage both the total energy obtained and the total energy consumed reach the maximum values at the same time and they are nearly constant which can be expressed as e o b m and e c o n m respectively therefore the efficiency η of the dolphin s porpoising movement could be defined as 23 η e o b m e c o n m 4 results and discussion note that most dolphins may use the appropriate emergence velocity or emergence angle to complete their porpoising behavior to achieve the predicted performance the critical emergence velocity and critical emergence angle are determined by its own kinematic parameters such as oscillating frequency oscillating amplitude and escape angle etc in this work both the oscillating frequency and the escape angle are selected to study their effects on the yielding hydrodynamics performance of the porpoising motion by extracting the transient flow structures around the dolphin the hydrodynamics mechanisms of this behavior could be revealed physically 4 1 time history of displacement velocity and force of porpoising behavior to study the time history rules the porpoising behavior is simulated at the oscillating frequency of 8 hz and the escape angle of 45 where the gravity is always along the y direction in the absolute coordinate system the swimming displacement velocity and fluid force acting on the dolphin are solved at each time step fig 9 shows the time history of the displacement velocity and force during the porpoising process in fig 9 a for t 1 0s the dolphin is in the acceleration stage under the water denoted as the area i while at t 1 0s the y direction displacement of the dolphin is 2 5 m with its head just reaching the water surface for 1 0s t 1 16s the dolphin is in the upward leap stage starting from the emergence of head first till the tail leaving the water denoted as the area ii at t 1 16s the y direction displacement is 3 03 m with the dolphin just leaving the water surface completely for 1 16s t 1 84s the dolphin is in the glide stage rotating the body freely in the air until the time going back to the water denoted as the area iii particularly when t 1 48s the dolphin reaches the highest point at 3 58 m at t 1 84s the y direction displacement goes down to 2 92 m with the dolphin just hitting the water surface from the air for t 1 84s the dolphin is in the downward dive stage during which reentering the water with the head first and then the tail and prepares the accelerated swimming again denoted as the area iv in the area i the dolphin is in the underwater acceleration stage both the x direction and y direction fluid forces f x and f y in the absolute coordinate system acting on the dolphin fluctuate around some certain values as shown in fig 9 b c the results show the average value of f x f y over a cycle is negative positive and the negative value of f x signifies the thrust force acting on the dolphin therefore the x direction and y direction swimming velocity v x and v y of the dolphin fluctuate as well but increase gradually as time goes in the area ii the dolphin is in the upward leap stage during this time both the x direction and y direction fluid forces f x and f y acting on the dolphin reach the peak values due to the free surface wave the x direction velocity v x and y direction velocity v y both vary irregularly at this time as the dolphin is leaping out of the water surface which are indicated as the two inflection points shown in fig 9 d e in the area iii the dolphin is in the air glide stage as the dolphin leaves the water surface the air resistance and the buoyancy are both negligible thus both the x direction force f x and y direction force f y remain constant roughly which are close to zero and the gravity respectively as a result the x direction velocity v x is almost unchanged while the y direction velocity v y decreases linearly due to the gravity in the area iv the dolphin is in the downward dive stage it can be seen from fig 9 b c that when the dolphin just hits the water surface both the x direction and y direction forces f x and f y change dramatically this is due to the relatively large resistance which is opposite to the dolphin s swimming velocity as it is reentering the water as shown in fig 9 d e both the x direction and y direction velocity v x and v y of the dolphin decrease obviously at this time due to the water resistance as the dolphin further dives into the water both the x direction and y direction forces f x and f y fluctuate around some negative values therefore the values of the x direction and y direction velocity v x and v y both increase reversely and fluctuate around the mean 4 2 time history of energy variations of porpoising behavior the energy variations of the porpoising behavior are also revealed under the same condition fig 10 a plots the changes in kinetic energy of the dolphin over time during the porpoising process in the underwater acceleration stage denoted as the area i the kinetic energy fluctuates but the overall trend is gradually increasing it can be seen from fig 9 b c that the thrust of the dolphin in the x and y directions is greater than the resistance at this stage so the velocity gradually increases and the trend of the kinetic energy is gradually increasing in the upward leap stage denoted as the area ii the dolphin is partly underwater and partly in the air at this time the kinetic energy continues to increase and reaches a peak and then begins to decrease in the area iii during the ascent stage of gliding the kinetic energy is continuously decreased due to the negative work done by the gravity and the air resistance on the dolphin during the descent stage of gliding the dolphin receives the positive work done by the gravity and the negative work done by the air resistance but the negative work is far less than the positive work thus the kinetic energy begins to increase close inspection revealed that the energy change curves of these two stages are basically symmetrical in the downward dive stage denoted as the area iv the dolphin undergoes greater resistance to reenter to the water and the fluid force does negative work on the dolphin and thus the kinetic energy is reduced when all the body dives into the water and starts to swim faster the kinetic energy fluctuates and the overall trend is increasing gradually this phenomenon is similar to the underwater acceleration stage fig 10 b presents the changes of gravitational potential energy with time during the porpoising process it can be seen from fig 10 b that in the underwater acceleration stage the gravitational potential energy of the dolphin is zero when the dolphin gradually emerges from the water the gravitational potential energy gradually increases due to the combined action of gravity and buoyancy when the dolphin is completely out of the water the increase in the dolphin s gravitational potential energy is only related to its y direction velocity during the ascent stage of gliding the y direction velocity decreases thus the magnitude of the increase of the gravitational potential energy decreases during the descent stage of gliding the decrease of the gravitational potential energy is also related to the y direction velocity the magnitude of the decrease of the gravitational potential energy gradually decreases with the increase of the y direction velocity when the dolphin starts to reenter the water again it is affected by gravity and buoyancy at the same time and the gravitational potential energy gradually decreases when the dolphin is completely under the water the gravitational potential energy returns to zero again fig 10 c reflects the changes of the total energy obtained by the dolphin over time during the porpoising process it is observed from the figure that in the underwater acceleration stage the total energy obtained is the kinetic energy when the dolphin leaps due to the positive work done by the fluid force the total energy obtained rises sharply when the dolphin glides in the air the negative work done by the air resistance is very small so the total energy obtained is basically unchanged when the dolphin is reentering the water the negative work done by the fluid resistance is greater so the total energy obtained drops sharply when the dolphin is completely underwater the work done by the fluid resistance is still large and then the underwater acceleration stage starts again fig 10 d shows the change of the total energy consumed by the dolphin over time during the porpoising process in the underwater acceleration and the leaping stages the dolphin continuously overcomes the fluid force and the fluid torque and consumes the energy so the total energy consumed gradually increases with time when the dolphin glides in the air the body has been kept straight and rotated around the center of mass which will consume a little energy maybe this energy is very small and could be ignored when the dolphin reenters the water again and accelerates underwater it starts to overcome the fluid force and the fluid torque and consumes the energy again thus the total energy consumed increases gradually to the best of our knowledge this may be the first time that the time history variations of displacement velocity fluid force and energy function during the porpoising movement of the dolphin are so clearly demonstrated 4 3 transient variation of flow field to reveal the mechanisms of the porpoising behavior it is necessary to explore the transient variation of the flow field by extracting the phase diagrams we could monitor the transient information of the dolphin motion fig 11 presents the phase diagrams of the dolphin at multiple discrete instants it can be observed that the dolphin is in different positions at different stages fig 12 shows the pressure distribution of the flow field which is affected only in the region around the dolphin as the dolphin accelerates under the water leaps out of the water glides in the air and dives into the water again the entire porpoising process of the dolphin starts at t 0s and ends at t 2 58s this process has been divided into four stages which are presented as four areas in figs 9 and 10 it is evident from fig 12 that the pressure distribution of the flow filed is uniform and zero at t 0s due to initialization while at other times the underwater pressure has a significant gradient distribution for more detailed information please see the video files s1 animation of phase diagram and s2 animation of pressure contour available online as the dolphin starts to accelerate swimming under the water in the area i there is always a high pressure core located at the forehead when the tail of the dolphin is at its upmost position at time t 0 63s fig 12 shows that a high pressure core is located at the upper side of the body while a low pressure core is located at the lower side as shown in fig 9 b the dolphin experiences a thrust force at this point this thrust force arises due to the local forward positive pressure gradient existing on the tail is stronger than the backward negative pressure gradient around the head close inspection shows that for the dolphin swimming during the down stroke a high pressure core occurs on the lower surface of the body and a low pressure core exists on the upper side as the dolphin travels at the down stroke both the high pressure core and the low pressure core gradually move toward the trailing edge and then shed from the tail and form the wakes the imbalances in the pressure distribution around the dolphin result in either ascending or descending thrust force moreover the fluctuation of the thrust force is due to the fact that the movement of the pressure core leads to the alternate variations of the pressure difference around the dolphin as the wakes are formed by the shedding of the pressure cores from the tail a new pair of the pressure cores is formed at the leading edge of the dolphin similar observations can be found in the ref fish et al 2014 xia et al 2015 park et al 2016 as the dolphin travels during the up stroke the pressure distributions mirror the pattern observed in the down stroke during the leap stage of the dolphin in the area ii as seen from the phase diagram in fig 11 and the pressure contour in fig 12 at t 1 06s the dolphin has certain effect on the water surface as it moves out of the water then the water surface appears some waves which subsequently act on the dolphin via the fluid effects causing severe force changes instantly on the dolphin at this time the high pressure core located at the forehead of the dolphin disappears this is due to that the air density is about 1 800 of the water which produces a very small inertia effect on the forehead during the glide stage of the dolphin in the area iii as seen from the phase diagram in fig 11 and the pressure contour in fig 12 at t 1 22s t 1 48s and t 1 78s certain amount of water adheres to the dolphin s body as the dolphin has just departed from the water surface which also confirms the force changes on the dolphin shown in fig 9 the pressure distribution around the dolphin roughly stays unchanged and the water surface restores its equilibrium during this process at the same time the dolphin rotates itself at a constant angular velocity around the center of mass under the action of the fluid torque generated at the previous leap stage as the dolphin dives into the water in the area iv at t 1 91s the phase diagram in fig 11 shows the waves produced again around the water surface and the high pressure core near the forehead of the dolphin is formed as well in the pressure contour shown in fig 12 after the dolphin fully reenters the water and starts its accelerated swimming such as at t 2 30s the pressure distribution of the body changes periodically again 4 4 effect of kinematic parameters on porpoising performance to evaluate the porpoising performance the critical emergence velocity the maximum leap height the maximum leap distance and the energy functions are chosen to quantify the effects of the kinematic parameters on them first of all we carry out several porpoising simulations to find the critical emergence velocity v ce resulting from various kinematic parameters i e the escape angle α changing from 30 to 90 and the oscillating frequency f ranging from 5 hz to 10 hz fig 13 a shows the relationship between the v ce v cex v cey denotes the component of v ce along x y axis respectively and α for a given value of f 5 hz as the dolphin just leaps out of the water from fig 13 a it can be seen that with the increase of α the v cex decreases and the rate of decrease is relatively large conversely the v cey increase as α increase and the higher α is and the slower the increasing speed is the combined velocity v ce decreases slowly as α increase therefore this figure underscores the effect of the escape angle on the critical emergence velocity for leaps the similar conclusion had been made by gordon 1980 actually fast mammal swimmers may try to maintain their forward velocity by using the emergence angle of 30 in nature au and weihs 1980 fish 1993 close inspection of fig 13 a shows that the dolphin has relatively good motion ability in the horizontal vertical direction when the value of α is 30 90 fig 13 b presents the v ce corresponding to different f when α 75 is given it can be observed from fig 13 b that with the increase of f the v cex gradually increases and the rate of increase is small the v cey and the combined velocity v ce have obvious increase comparing fig 13 a and b it could be found that the increase of f is more conducive to the increase of v ce than the increase of α even though fig 13 shows results only for this case similar plots for other parameters not shown exhibit essentially all the qualitative trends secondly it is important to evaluate the maximum leap height h max and the maximum leap distance d max fig 14 a plots the variations of h max as functions of α and f it can be seen that for a given value of f h max increase as α increases from 30 to 90 and the higher α is and the slower the increasing speed is this is due to the fact that v cey increases monotonically as α increases and the increase rate is gradually decreasing as shown in fig 13 a meanwhile for a fixed α h max increases monotonically as f increases from 5 hz to 10 hz and the rate of increase is almost linear this is because v cey increases linearly as f increases as shown in fig 13 b it should be noted that compared with the increase of α the increase of f is more beneficial to the increase of h max fig 14 b plots the variations of d max as functions of α and f both α and f are changed at the same range to match to the above results for h max in fig 14 b it is clearly observed that for a given f the trend of d max initially increases as α is increasing with a critical point of slightly greater than 45 and then decreases as α is increased further the peak of d max occurs between 45 and 60 in all simulated groups in addition for a given α the values of d max increase monotonically as f increases from 5 hz to 10 hz and the higher f is and the faster the increasing speed is closer inspection of fig 14 b reveals that the critical point of α to reach the peak values of d max is in the range of 45 α 60 and nears 50 for all given values of f maybe the effect of α on the leap distance d max has never been illustrated elsewhere before for the porpoising behavior of dolphins to further illustrate the effect of the kinematic parameters on the energy functions fig 15 a shows the relationship between the maximum energy obtained by the dolphin e o b m and the escape angle α and the oscillating frequency f it can be seen from the figure that for a given f e o b m does not change significantly at different α the basic trend is that e o b m decreases slightly as α increases given α e o b m increases with the increase of f and the higher f is and the faster the increasing speed is fig 15 b plots the changing rules of the maximum energy consumed by the dolphin e c o n m with α and f in this figure e c o n m decreases with the increase of α for a given f this is because the larger the α the shorter the distance the dolphin swim underwater and thus the less energy it consumes given α e c o n m increases with the increase of f and the increase rate gradually increases fig 15 c reflects the relationship between the porpoising efficiency η and the escape angle α and the oscillating frequency f it can be seen from the figure that for a given f η increases with the increase of α and the higher α is and the slower the increasing speed is at the same α the trend of η initially increases as f is increasing with a critical point of slightly greater than 7 hz and then decreases as f is increased further the peak of η occurs between 7 hz and 8 hz in all simulated groups closer inspection finds that when f increases both e o b m and e c o n m increase but they increase in different magnitudes that is the dolphin obtains an increase in energy by increasing its own consumption and thus the efficiency changes non monotonously 4 5 discussion to further discuss the dependences of the porpoising performance on the kinematic parameters compared with the results in figs 13 and 14 show that for maximum leap velocity generation the escape angle is 30 and for maximum leap height achieved the escape angle is 90 this finding is in agreement with previous experimental results for dolphins swimming weihs 2002 2004 au and weihs 1980 gordon 1980 early studies concluded that the emergence angles of leaps by dolphins were widely distributed from 30 to 90 au and weihs 1980 gordon 1980 this qualitative trend had been predicted in early dolphins swimming experiments however the quantitative variations of the leap performance parameters based on the variations of the dolphin kinematics have never been obtained before for the porpoising movement perhaps this work is the first numerical attempt for the hydrodynamics study on the porpoising behavior of dolphins it is necessary to note that in order to achieve the maximum leap distance the escape angle should be within the range of 45 60 and close to 50 to achieve the maximum leap height the escape angle should be 90 another valuable suggestion is that the dolphin could employ the oscillating frequency between 7 hz and 8 hz close to 7 hz to complete its porpoising motion and then obtain better porpoising efficiency 5 conclusions in the present study we constructed a virtual dolphin and employed it to elucidate the hydrodynamics of the porpoising behavior and clarify the previous experimental results with live dolphins a four stage model is proposed to illustrate the maneuver process the virtual dolphin allowed us to perform controlled numerical experiments by systematically changing the oscillating frequency and the escape angle while keeping other parameters fixed various kinematic behaviors are simulated to obtain their porpoising performance the most important findings are summarized as follows 1 when the dolphin is in the underwater acceleration stage f x f y fluctuates around some negative positive mean values thus v x and v y fluctuate as well and increase gradually as time goes when the dolphin is in the upward leap stage both f x and f y reach the peak due to the free surface wave v x and v y vary irregularly at this time and two inflection points appear when the dolphin is in the air glide stage the drag and the buoyancy are negligible therefore f x and f y remain unchanged approximately which are close to zero and gravity and thus v x is almost unchanged and v y decreases linearly when the dolphin is in the downward dive stage both f x and f y change dramatically due to the relatively large drag as it is entering the water thus v x and v y decrease obviously at this time as the dolphin further reenters into the water both f x and f y fluctuate around some negative values and v x and v y increase reversely and fluctuate around the mean correspondingly 2 for a given f the results show that with the increase of α v cex decreases rapidly but v cey increases to some extent so the combined velocity v ce decreases slowly in this sense the dolphin has relatively good motion ability in the horizontal vertical direction when the value of α is 30 90 this finding is consisting with the fact that fast swimming animals try to maintain their forward velocity by using an emergence angle of 30 in nature in addition for a fixed α as f increases v cex gradually increases and the increase rate is small v cey and v ce has obvious increase and the increase rate is relatively large close inspection reveals that the increase of f is more beneficial to increasing the v ce than the increase of α 3 both the maximum leap height h max and the maximum leap distance d max are chosen to evaluate the porpoising performance quantitatively for a given value of f h max increase as α increases and the higher α is and the slower the increasing speed is for a fixed α h max increases monotonically as f increases and the rate of increase is almost linear note that increase of f is more beneficial to increasing the h max than the increase of α furthermore for a given f the trend of d max initially increases as α is increasing with a critical point of slightly greater than 45 and then decreases as α is increased further at a given α the values of d max increase monotonically as f increases and the higher f is the faster the increasing speed is it is important to noted that the critical point of α to reach the peak values of d max is in the range of 45 α 60 and nears 50 for all given values of f 4 the maximum energy obtained e o b m the maximum energy consumed e c o n m and the efficiency η of the dolphin are used to evaluate the energy functions of the porpoising behavior for a given f e o b m decreases slightly as α increases given α e o b m increases with the increase of f and the higher f is and the faster the increasing speed is moreover e c o n m decreases with the increase of α for a given f given α e c o n m increases with the increase of f and the increase rate gradually increases as for efficiency given f η increases with the increase of α and the higher α is and the slower the increasing speed is at the same α the trend of η initially increases as f is increasing with a critical point of slightly greater than 7 hz and then decreases as f is increased further the peak of η occurs between 7 hz and 8 hz in all simulated groups finally we have to mention that in addition to the kinematics parameters we considered here there are other morphological and kinematics parameters that could affect the porpoising performance of the dolphin maybe additional studies will be needed to investigate and quantify the effects of them another aspect that we did not address in this study is the dimensionless of the hydrodynamics parameters these issues however were not studied in the present work so that we can focus on exploring the feasibility of solving the hydrodynamics problem of the dolphin performing this complex behavior and further clarifying the effect of the kinematics on the porpoising performance numerically in conclusion in spite of several novel insights into the hydrodynamics of the porpoising behavior of dolphins we have contributed in this work many important issues remain to be explored credit author statement dan xia qifeng yin and weishan chen conceived the idea of the porpoising behavior of dolphins zhihan li and yunde shi constructed the theoretical model dan xia qifeng yin and jianping dou developed the user defined function procedures dan xia qifeng yin and zhihan li performed the numerical simulation all authors analysed the data and wrote the manuscript declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work was supported by national natural science foundation of china grant number 51875101 state key laboratory of robotics and system hit grant number sklrs 2018 kf 11 and the natural science foundation of jiangsu province of china grant number bk20170690 the authors greatly appreciate the referees for their helpful comments and suggestions which help improve this paper appendix a supplementary data the following are the supplementary data to this article multimedia component 1 multimedia component 1 multimedia component 2 multimedia component 2 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j oceaneng 2021 108985 
20800,this paper employs numerical simulation to study the hydrodynamics of porpoising behavior in dolphins the virtual swimmer is a three dimensional dolphin like body with prescribed kinematics a four stage model of this behavior is proposed including underwater acceleration upward leap air glide and downward dive when the dolphin goes through these four stages the time history of its displacement velocity force and energy could be solved to elucidate the rules by varying oscillating frequency f and escape angle α various behaviors of the swimmer are simulated to obtain their porpoising performance which are evaluated by maximum leap height h max maximum leap distance d max and leap efficiency η the results show that both h max and d max are increasing functions of f but their trend with α is not monotonic for peak h max generation α occurs at 90 while for peak d max α is ranging from 45 to 60 and nears 50 as for efficiency η increases slowly with the increase of α and first increases and then decreases with the increase of f at a critical value between 7 hz and 8 hz the findings may provide an important hydrodynamics basis for the biomimetic vehicle designs that mimic the porpoising motion of dolphins keywords porpoising behavior dolphins swimming hydrodynamics numerical simulation 1 introduction many aquatic animals perform aerial maneuvers in which they leap from water into air as a typical aerial maneuver manner porpoising behavior has been hypothesized as a strategy for energy economy weihs 2002 the first analysis of this behavior au and weihs 1980 showed that above a critical velocity this behavior is energetically advantageous as the reduction in drag due to glide in the air becomes greater than the added cost of leap this behavior is often performed by fast mammal swimmers such as dolphins au and weihs 1980 gordon 1980 dolphins are thought to be evolved remarkable porpoising abilities to escape predators which are intuitively attractive since the predators may lose sight of the dolphins when they leap into air fish 1993 meanwhile dolphins are treated as high speed and agile swimmers it can swim at speeds up to 20 m s and even leap to heights of over 5 m above the water surface yu et al 2016 to complete the porpoising behavior the dolphin must reach sufficient underwater velocity and momentum to overcome the effects of gravity when it leaves the water this behavior involves the water exit and reentry of a dolphin like flexible body which is essentially a problem of the fluid structure interactions on free surface this problem is also a classic issue in many practical applications i e ship and ocean engineering and physical oceanography the porpoising behavior of dolphins could be divided to four distinct stages an underwater acceleration stage an upward leap stage an air glide stage and a downward dive stage during the entire process the dolphin accelerates and rises to the maximum leap height and then dives back into the water performing a combination of translational and rotational motion the mass center follows a parabolic trajectory which is depending on the critical emergence velocity and the critical emergence angle just before the dolphin leaves the water some early literatures au and weihs 1980 gordon 1980 taylor et al 2003 weihs 2004 fish et al 2006 reported that the emergence angles of leaps by dolphins were widely distributed between 30 for the maximum velocity and 90 for the maximum height au au and weihs 1980 assumed that dolphins would maximize the leap distance by using 45 emergence angle these results provide some guidance for the porpoising dynamics nevertheless all of these studies have focused on experimentally analyzing some discrete leaping cases of dolphins and systematic numerical studies on the hydrodynamics of the porpoising behavior in dolphins are relatively few numerous experiments drucker and lauder 2002 tytell and lauder 2004 muller et al 2008 dewey et al 2012 fish et al 2014 maia et al 2017 had provided a wealth of data in terms of swimming hydrodynamics of live fish however carrying out controlled experiments of various porpoising behaviors is almost impossible in live dolphins this fact emphasizes the difficulties for experimental method alone to provide conclusive findings fortunately such insights can be obtained by using the numerical simulations zhu and shoele 2008 borazjani and sotiropoulos 2010 in the past decade numerical studies on fish swimming have developed rapidly many representative studies have appeared successively zhu and shoele 2008 borazjani and sotiropoulos 2010 bergmann and iollo 2016 li and dong 2016 liu et al 2017 deng et al 2019 khalid et al 2018 including the studies of the propulsion mechanism of certain fin units i e pectoral fin caudal fin dorsal fin etc of fish zhu and shoele 2008 liu et al 2017 and the hydrodynamics studies of different propulsion modes of the whole fish i e anguilliform mode carangiform mode thunniform mode etc borazjani and sotiropoulos 2010 deng et al 2019 and the study of the fish school interaction mechanism khalid et al 2018 furthermore some other scholars have studied the hydrodynamics of the water exit and reentry of the rigid cylinders zhang et al 2010 ni et al 2015 these studies have produced a lot of important findings on the mechanisms of aquatic swimming or water exit and reentry of the rigid body however the hydrodynamics of the porpoising behavior in dolphins which refers to the problems of the water exit and reentry of the flexible body have yet to be reported a major contribution of the present work is to explore a numerical method to solve the problem of the water exit and reentry of the dolphin like flexible body the possibility of the porpoising behavior in dolphins is examined numerically the four stage model is proposed in which the dolphin leaps out of water with the critical emergence velocity at the end of the underwater acceleration stage and then glides in the air and finally dives into the water the hydrodynamics of the dolphin s porpoising behavior are presented in detail and the transient evolutions of the fluid structures are also revealed the findings in this work could provide an important hydrodynamics foundation for biomimetic vehicle designs that mimic the porpoising motion of dolphins 2 physical model and kinematics 2 1 physical model for comparison with the robotic dolphin prototype developed in the laboratory here we use a small dolphin like model as the virtual swimmer which is composed of a main body with a smooth profile and a crescent shaped caudal fin with cross sections of naca 0024 while all minor fins are neglected to match with the robotic dolphin the size of the swimmer x y z is set to 0 72 m 0 16 m 0 2 m as shown in fig 1 the body coordinate system o b x b y b z b and the caudal fin coordinate system o cf x cf y cf z cf are established respectively the origin of the o b x b y b z b is located at the head and that of the o cf x cf y cf z cf is located at the caudal peduncle at the place 0 85 times the swimmer length measured from the head for these two relative coordinate systems x axis y axis and z axis are along the longitudinal direction the vertical direction and the transverse direction of the body respectively to describe the porpoising motion of the swimmer as shown in fig 2 the four stage model is proposed 1 the underwater acceleration stage characterized by high thrust swimming motion under the water until the last moment at which the critical emergence velocity and the critical emergence angle are achieved 2 the upward leap stage i e the water exit stage during the time starting from the emergence of the head till the trailing edge of the tail leaving the water 3 the air glide stage during which rotating the body freely in the air until the time the head starting to fall back to the water with the center of mass following the parabolic path 4 the downward dive stage i e the water reentry stage during the time the swimmer reentering the water with the head first and then the tail and the next loop will be prepared as shown in fig 2 an absolute coordinate system oxyz is also established in which ox axis points to the right in the horizontal direction oy axis points to the top in the vertical direction and oz axis points to the front and forms a right handed system with ox and oy axes at the beginning of the leap stage the swimmer launches itself with the critical emergence velocity and tries the best to accelerate oscillating its body to obtain sufficient ascending velocity and rotational angular momentum and then the majority of the body leaves the water surface and the posterior body does not contribute to thrust production any longer at the end of the leap stage during the glide stage the swimmer is all out of the water and no longer oscillates up and down but straightens the body to keep it straight and rotates itself uniformly around the center of mass under the action of the angular momentum thereby reducing the drag and the energy consumption in the air the swimmer tries to achieve the maximum leap height or the maximum leap distance or other aerial postures and then dives back into the water 2 2 kinematics for porpoising behavior during the porpoising motion the swimmer propels itself by dorsal ventral oscillations of the body the specific kinematics for this behavior consists of two parts i e the undulation of the body and the composite motion of the caudal fin shoele and zhu 2015 the body undulation can be abstracted into a column of traveling wave that spreads from the head to the tail which is described as 1 y x t a t a x sin 2 π t t x λ where y x t is the vertical displacement of the body a t is the time dependent control function during the entire porpoising process a x is the amplitude envelope x is the x axis coordinate t is the time t is the undulation cycle and λ is the wavelength among them the time dependent control function a t is proposed as 2 a t 0 t t 0 t t 0 t 1 t 0 1 2 π sin 2 π t t 0 t 1 t 0 t 0 t t 1 1 t 1 t t 2 1 t t 2 t 3 t 2 1 2 π sin 2 π t t 2 t 3 t 2 t 2 t t 3 0 t 3 t t 4 t t 4 t 5 t 4 1 2 π sin 2 π t t 4 t 5 t 4 t 4 t t 5 1 t t 5 where t 0 is the time at which the swimmer turns from stationary state to start oscillating t 1 is the time from the end of start oscillation to accelerated swimming t 2 is the time from the end of accelerated swimming to start straightening the body t 3 is the time from the end of straightening the body to start gliding in the air t 4 is the time from the end of gliding in the air to start water reentering and t 5 is the time from the end of water reentering to accelerated swimming under the water again in addition the amplitude envelope a x used here is based on the experimental reports in fish fish et al 2006 and romanenko 2002 which can be described as 3 a x a max 0 21 0 66 x 1 1 x 2 0 35 x 8 where a max is the vertical motion amplitude of the caudal peduncle the composite motion of the caudal fin consists of a heave motion and a pitch motion and its kinematics can be depicted as 4 y c f t a t a max sin 2 π t t l b λ θ t a t θ max sin 2 π t t l b λ ϕ where y cf t is the vertical displacement of the heave motion θ t is the angular displacement of the pitch motion and θ max is its amplitude l b is the body length of the swimmer measured from the head to the caudal peduncle and ϕ is the phase difference of the heave motion ahead of the pitch motion 3 numerical method 3 1 governing equations of fluid we consider a three dimensional 3d flow over the dolphin undergoing the porpoising motion the governing equations of the fluid include the mass conservation equation and the navier stokes energy conservation equation written as 5 u i x i 0 6 ρ u i t ρ u i u j x i p x i x i μ μ t u i x j u j x i f i where u i i 1 2 3 are the fluid velocity components in the x i i 1 2 3 i e x y z directions ρ is the density p is the pressure μ is the dynamic viscosity μ t is the turbulent viscosity and f i is the momentum forcing related to the surface tension along the x i direction to solve the equations in a domain containing the virtual dolphin a no slip boundary condition is needed to be imposed on the moving interface with the fluid velocity ζ and the dolphin velocity x written as 7 ζ x since the shape of the dolphin is complex and the curvature gradient changes quickly the flow around the dolphin is a highly complex 3d flow when the dolphin undergoes the porpoising motion the reynolds number re may reach very high close to 105 this value of re is within the inertial regime where turbulence flow dominates the dynamics thus the choice of turbulence model has direct impact on the accuracy of the numerical solution of the flow field both rng k ε and sst k ω turbulence model have good computational performance in the flow involving separation which is an important issue in the numerical simulation of dolphins swimming where separation always occurs in the tail part zhang et al 2010 han and krajnovic 2013 in this work the rng k ε turbulence model is chosen the turbulent kinetic energy k and the turbulent dissipation rate ε are given as 8 ρ k t ρ u i k t x i α k μ μ t k x i ρ g k ε 9 ρ ε t ρ u i ε x i x i α ε μ μ t ε x i c ε 1 ε k g k c ε 2 ρ ε 2 k where g k is the turbulent energy component generated by the velocity gradient α k and α ε are the reciprocals of the effective turbulent prandtl numbers of the k and the ε respectively c ε1 and c ε2 are the model constants 3 2 governing equations of free surface due to the steep density and viscosity gradients on the water surface excessive numerical diffusion is experienced in the computation of the viscous flow here the level set method is used to capture the interface between the two phases zhang et al 2010 the evolution of the level set function γ is governed by 10 γ t u i γ x i 0 the solution of the navier stokes equations will produce undesirable instability at the interface if the density and the viscosity are not continuous there to overcome this a region of limited thickness at the interface is introduced where a smooth but rapid change in density and viscosity occurs zhang et al 2010 this can be achieved by defining a smooth heaviside function h γ given by 11 h γ 0 γ δ γ δ 2 δ 1 2 π sin π γ δ δ γ δ 1 γ δ where δ is the scale parameter related to the grid size the governing equations are associated with different fluid properties by the heaviside function using this function the fluid properties can be calculated as 12 β 1 h β 1 h β 2 where β can be the density viscosity or other properties at the interface 3 3 governing equations of dolphin the motion of the dolphin is in turn described by the newton s equations of motion as 13 m x c f 14 i z φ c i z φ c m z where f is the fluid force vector m z is the fluid torque along the z axis acting on the dolphin m is the dolphin mass which is depicted as the body volume multiplied by the water density x c is the swimming acceleration vector which is time dependent due to the fluid force φ c and φ c are the angular velocity and the angular acceleration which are time dependent due to the fluid torque i z is the inertial moment around the pitch axis i e i z s x 2 y 2 x t d s which is changing in time due to the body deformation and could be obtained by integration and i z is the time derivative of the inertial moment i z it is necessary to note that both spinning and rolling motion of the body are not considered here therefore the feedback of the torque is limited to the pitch axis to simplify the computations the fluid force f and the fluid torque component m z are computed as 15 f s σ n d s 16 m z s σ n x x c e 3 d s where σ is the normal stress vector n is the unit vector along the normal direction x c is the displacement of the mass center ds is the differential unit area along the dolphin surface e 3 is the unit vector along the z direction 3 4 numerical method and computational grid farsighted scholars have developed some successful methods to solve the problems of the free surface interactions shen shen and chan 2008 and peng peng et al 2012 used the immersed boundary method ibm and the volume of fluid vof models to simulate the free surface interaction with the submerged solid body their studies validated the ability of the methods to handle the submerged solid surfaces and to capture the evolution process lin 2007 used the vof one phase model and the cut cell technique to simulate the water entry and exit of the cylinder in this work we applied the vof method with the heaviside function to solve the flow problems the commercial package fluent with the pressure based transient solver is used the deformation motion of the dolphin is realized by using an in house define grid motion macro which is hooked to the main code of the solver the solution of the newton s equations governing the dolphin motion is carried out by an in house user defined function note that the rng k ε model is used here which differs from the standard turbulence model as it includes an additional sink term in the turbulence dissipation equation to account for the non equilibrium strain rates han and krajnovic 2013 therefore the rng k ε model can deal with the flows with high strain rate and large curvature such as the water exit and reentry of the dolphin during the solving process the navier stokes equations are discretized using the finite volume method where a second order crank nicolson scheme is used for the unsteady term a second order upwind scheme is adopted for the convective term and a second order central differencing scheme is employed for the diffusion term pressure velocity coupling of the continuity equation is achieved using the piso algorithm the computational domain is a 12 m 8 m 4 m cubic tank with the water depth 5 m as shown in fig 3 the head of the dolphin is 2 5 m below the water surface the inlet boundary and outlet boundary are defined as a pressure inlet and an outflow condition respectively and 1 atm is throughout taken as the reference pressure and the no slip wall boundary condition is imposed on the top bottom front and back of the domain unstructured tetrahedral grids are chosen to handle the large deformations due to the dolphin s porpoising motion as shown in fig 4 the overall computational domain is discretized with the unstructured mesh including nearly 1 2 107 grids the computational domain includes a background mesh enclosing the entire solution domain and a small overset mesh a small cubic box containing the virtual dolphin the overset mesh moves with the dolphin the surface of the dolphin is discretized to triangular grids with 0 001 m edge lengths and the surface of the cubic box is divided into triangular grids with 0 002 m edge lengths while the surface of the computational domain is separated into triangular grids with 0 01 m edge lengths the volume between the surface of the dolphin the cubic box surface and the computational domain surface is all discretized into the tetrahedral control volumes it is important to note that the mesh grids are locally refined near the dolphin region inside the small cubic box to ensure the requirement of y plus of the wall function at any time if the value of y plus is in the proper range it means that the grid of the first boundary near the wall is reasonable if the value of y plus is not reasonable the boundary grid needs to be readjusted an enhanced wall function is adopted here to simulate the flow near the wall which is due to that han han and krajnovic 2013 once reported that the application of the k ε turbulence model with the enhanced wall function in the region of y plus 5 can accurately simulate the flow near the wall 3 5 sensitivity study a grid sensitivity study is carried out using three successively grids including 3 7 106 1 2 107 and 4 5 107 grids respectively the uniform edge length for the three different grids is 0 02 m 0 01 m and 0 005 m corresponding to 3 7 106 coarse 1 2 107 nominal and 4 5 107 fine grid cells respectively the grid sensitivity study is carried out for the oscillating frequency of 8 hz unchanged and the escape angle ranging from 30 to 90 for each grid the domain size time step and boundary conditions are the same as those used for the nominal grid which is the grid used for all simulation cases fig 5 shows the variations of the maximum leap distance with the escape angle for three different grid cells it is evident from this figure that both the nominal and fine grids give reasonable results which are very close to each other while the coarse grid is not sufficiently accurate to obtain the reasonable results then we conclude that the results obtained on the nominal grid are insensitive to further grid refinement and therefore this is the grid size selected for all simulation results reported in this work furthermore it is necessary to point out that if the time step is too small it will take up a lot of computing resources especially in the case of 3d dynamic mesh simulation conversely if the time step is too large the displacement of the grid node in each time step exceeds the scale of the grid itself and the grid may cause negative volume or excessively large aspect ratio which is not conducive to the simulation a sensitivity study on the time step is also carried out using three different time steps of t 80 t 200 and t 500 with the nominal grid to be consistent with the above the porpoising behaviors of the dolphin are simulated at the oscillating frequency of 8 hz unchanged and the escape angle ranging from 30 to 90 the variations of the maximum leap distance with the escape angle for three different time steps are given in table 1 where δt t 200 proved to be suitable consequently the setup with the nominal grid and the time step of δt t 200 allows a satisfactory computation and it is chosen for all simulations of the porpoising behavior in dolphins in this work 3 6 validation test the numerical method has been validated to simulate the water exit and entry of the cylinder here the same parameters are used as those in the ref zhang et al 2010 the cylinder of r 1 m is placed in calm water in a cubic tank and the distance of its center to the free surface is d 1 25 m the cylinder is given a constant upward velocity v 0 39 m s thus the dimensionless time is defined as τ vt d snapshots of the interaction between the cylinder and the interface are shown in fig 6 as the cylinder moves upward two shear layers are developing along left and right sides two vortices shed from these two shear layers and interact with the free surface the computed results are compared with the results reported by ref zhang et al 2010 very good agreement is observed for the case of the water entry the same parameters are used as reported by ref zhang et al 2010 the cylinder starts its downward motion from the height of 1 25 m to the calm water with the constant velocity v 1 0 m s snapshots of six different instants are shown in fig 7 the free surface is captured very well as the cylinder moves close to the free surface a small gap is observed between the free surface and the cylinder and causing the free surface to deform as the cylinder moves further downward a large amount of water is pulled down when the cylinder is fully submerged in the water there is a water jet in the center of the water surface these findings are very close to the results reported in ref zhang et al 2010 as the cylinder undergoes the water entry process the slamming coefficient could be defined as c s f ρrv 2 where f is the total vertical hydrodynamic force r is the radius of the cylinder and v is the entry velocity for validation we choose the case performed at the same parameters as used in the ref zhang et al 2010 for which numerical results have been reported the total vertical hydrodynamic force on the cylinder has been calculated and compared in a dimensionless form fig 8 shows the comparison of the slamming coefficient and the penetration depth between the present results and the numerical results of the ref zhang et al 2010 and the ref kleefsman et al 2005 it is clear that the calculated slamming coefficient is in reasonable agreement with the previous results 3 7 porpoising performance parameters it is significant to define the leap distance or the leap height to evaluate the performance of dolphin s porpoising motion note that the maximum leap distance of the dolphin measured from the leaping point to the diving point along the horizontal direction is denoted as d max the time spent out of water is expressed as t out when the dolphin has leaped out of the water and is undergoing the glide stance the maximum leap height measured from the water surface to the highest point reached in the vertical direction is described as h max these performance parameters could be calculated by 17 d max v c e 2 g sin 2 α c e t out 2 v c e g sin α c e h max v c e 2 2 g sin 2 α c e where v ce is the critical emergence velocity g is the acceleration of gravity and α ce is the critical emergence angle the energy changes in the dolphin s porpoising motion are very complex in the acceleration stage the dolphin gains its own energy by continuously overcoming the fluid force and the torque during the upward leap stage the dolphin will lose the energy of the water attached to the body and into the air in the air glide stage ignoring the tiny air resistance to do work the energy of the dolphin is almost unchanged when the dolphin reenters the water the dolphin needs to accelerate the energy of the water attached to the body and into the water after the dolphin is completely underwater it gains energy by oscillating itself again during the whole porpoising process the velocity of the dolphin is constantly changing and then its kinetic energy function e k t can be expressed as 18 e k t 1 2 m v x 2 t v y 2 t where vx t and vy t are the x and y velocity components of the dolphin at time t when the dolphin is swimming underwater since the density of the dolphin is assumed to be the same as the density of the water the gravity of the dolphin and the buoyancy of the water acting on the dolphin are also equal therefore the gravity potential energy of the dolphin at any time and any position is equal under the water in this sense we can assume that the water surface is the zero potential energy surface of the dolphin when the dolphin is leaping or reentering the water part of its body is underwater and the other part is in the air so it is simultaneously affected by the gravity and the water buoyancy at this time the gravity and the buoyancy are not equal so the gravitational potential energy ep t can be described as 19 e p t 0 t g f b u o t v y t d t where g is the gravity of the dolphin fbuo t is the buoyancy at time t which can be computed as 20 f b u o t ρ w g v d o l 0 t t 2 ρ a g v d o l a t ρ w g v d o l v d o l a t t 2 t t 3 ρ a g v d o l t 3 t t 4 ρ w g v d o l w t ρ a g v d o l v d o l w t t 4 t t 5 ρ w g v d o l t t 5 where ρ w and ρ a are the density of water and air respectively v dol is the volume of the dolphin v dola t is the volume exposed to the air when the dolphin leaps and is related to the geometric parameters of the dolphin the y displacement and the emergence angle during the leap v dolw t is the volume of the dolphin immersed in the water when it reenters and is determined by the geometric parameters of the dolphin the y displacement and the entry angle when reentering the definitions of t 2 t 5 are the same as above in the whole process of the porpoising movement the energy obtained by the dolphin includes two parts one part is the kinetic energy e k t and the other part is the gravitational potential energy ep t therefore the total energy obtained e ob t by the dolphin can be expressed as 21 e o b t e k t e p t the total energy consumed by the dolphin also consists of two parts the work to overcome the fluid reaction force and the work to overcome the fluid reaction torque therefore the total energy consumed e con t during the dolphin s porpoising motion can be given as 22 e c o n t σ x d s d t σ x x c φ d s d t where x and φ are the velocity vector and the angular velocity vector of the ds on the surface of the dolphin the dolphin could achieve the porpoising behavior by overcoming the reaction force and the reaction torque and consume lots of energy at the same time the dolphin also gains part of the energy it has been confirmed in the following results that during the air gliding stage both the total energy obtained and the total energy consumed reach the maximum values at the same time and they are nearly constant which can be expressed as e o b m and e c o n m respectively therefore the efficiency η of the dolphin s porpoising movement could be defined as 23 η e o b m e c o n m 4 results and discussion note that most dolphins may use the appropriate emergence velocity or emergence angle to complete their porpoising behavior to achieve the predicted performance the critical emergence velocity and critical emergence angle are determined by its own kinematic parameters such as oscillating frequency oscillating amplitude and escape angle etc in this work both the oscillating frequency and the escape angle are selected to study their effects on the yielding hydrodynamics performance of the porpoising motion by extracting the transient flow structures around the dolphin the hydrodynamics mechanisms of this behavior could be revealed physically 4 1 time history of displacement velocity and force of porpoising behavior to study the time history rules the porpoising behavior is simulated at the oscillating frequency of 8 hz and the escape angle of 45 where the gravity is always along the y direction in the absolute coordinate system the swimming displacement velocity and fluid force acting on the dolphin are solved at each time step fig 9 shows the time history of the displacement velocity and force during the porpoising process in fig 9 a for t 1 0s the dolphin is in the acceleration stage under the water denoted as the area i while at t 1 0s the y direction displacement of the dolphin is 2 5 m with its head just reaching the water surface for 1 0s t 1 16s the dolphin is in the upward leap stage starting from the emergence of head first till the tail leaving the water denoted as the area ii at t 1 16s the y direction displacement is 3 03 m with the dolphin just leaving the water surface completely for 1 16s t 1 84s the dolphin is in the glide stage rotating the body freely in the air until the time going back to the water denoted as the area iii particularly when t 1 48s the dolphin reaches the highest point at 3 58 m at t 1 84s the y direction displacement goes down to 2 92 m with the dolphin just hitting the water surface from the air for t 1 84s the dolphin is in the downward dive stage during which reentering the water with the head first and then the tail and prepares the accelerated swimming again denoted as the area iv in the area i the dolphin is in the underwater acceleration stage both the x direction and y direction fluid forces f x and f y in the absolute coordinate system acting on the dolphin fluctuate around some certain values as shown in fig 9 b c the results show the average value of f x f y over a cycle is negative positive and the negative value of f x signifies the thrust force acting on the dolphin therefore the x direction and y direction swimming velocity v x and v y of the dolphin fluctuate as well but increase gradually as time goes in the area ii the dolphin is in the upward leap stage during this time both the x direction and y direction fluid forces f x and f y acting on the dolphin reach the peak values due to the free surface wave the x direction velocity v x and y direction velocity v y both vary irregularly at this time as the dolphin is leaping out of the water surface which are indicated as the two inflection points shown in fig 9 d e in the area iii the dolphin is in the air glide stage as the dolphin leaves the water surface the air resistance and the buoyancy are both negligible thus both the x direction force f x and y direction force f y remain constant roughly which are close to zero and the gravity respectively as a result the x direction velocity v x is almost unchanged while the y direction velocity v y decreases linearly due to the gravity in the area iv the dolphin is in the downward dive stage it can be seen from fig 9 b c that when the dolphin just hits the water surface both the x direction and y direction forces f x and f y change dramatically this is due to the relatively large resistance which is opposite to the dolphin s swimming velocity as it is reentering the water as shown in fig 9 d e both the x direction and y direction velocity v x and v y of the dolphin decrease obviously at this time due to the water resistance as the dolphin further dives into the water both the x direction and y direction forces f x and f y fluctuate around some negative values therefore the values of the x direction and y direction velocity v x and v y both increase reversely and fluctuate around the mean 4 2 time history of energy variations of porpoising behavior the energy variations of the porpoising behavior are also revealed under the same condition fig 10 a plots the changes in kinetic energy of the dolphin over time during the porpoising process in the underwater acceleration stage denoted as the area i the kinetic energy fluctuates but the overall trend is gradually increasing it can be seen from fig 9 b c that the thrust of the dolphin in the x and y directions is greater than the resistance at this stage so the velocity gradually increases and the trend of the kinetic energy is gradually increasing in the upward leap stage denoted as the area ii the dolphin is partly underwater and partly in the air at this time the kinetic energy continues to increase and reaches a peak and then begins to decrease in the area iii during the ascent stage of gliding the kinetic energy is continuously decreased due to the negative work done by the gravity and the air resistance on the dolphin during the descent stage of gliding the dolphin receives the positive work done by the gravity and the negative work done by the air resistance but the negative work is far less than the positive work thus the kinetic energy begins to increase close inspection revealed that the energy change curves of these two stages are basically symmetrical in the downward dive stage denoted as the area iv the dolphin undergoes greater resistance to reenter to the water and the fluid force does negative work on the dolphin and thus the kinetic energy is reduced when all the body dives into the water and starts to swim faster the kinetic energy fluctuates and the overall trend is increasing gradually this phenomenon is similar to the underwater acceleration stage fig 10 b presents the changes of gravitational potential energy with time during the porpoising process it can be seen from fig 10 b that in the underwater acceleration stage the gravitational potential energy of the dolphin is zero when the dolphin gradually emerges from the water the gravitational potential energy gradually increases due to the combined action of gravity and buoyancy when the dolphin is completely out of the water the increase in the dolphin s gravitational potential energy is only related to its y direction velocity during the ascent stage of gliding the y direction velocity decreases thus the magnitude of the increase of the gravitational potential energy decreases during the descent stage of gliding the decrease of the gravitational potential energy is also related to the y direction velocity the magnitude of the decrease of the gravitational potential energy gradually decreases with the increase of the y direction velocity when the dolphin starts to reenter the water again it is affected by gravity and buoyancy at the same time and the gravitational potential energy gradually decreases when the dolphin is completely under the water the gravitational potential energy returns to zero again fig 10 c reflects the changes of the total energy obtained by the dolphin over time during the porpoising process it is observed from the figure that in the underwater acceleration stage the total energy obtained is the kinetic energy when the dolphin leaps due to the positive work done by the fluid force the total energy obtained rises sharply when the dolphin glides in the air the negative work done by the air resistance is very small so the total energy obtained is basically unchanged when the dolphin is reentering the water the negative work done by the fluid resistance is greater so the total energy obtained drops sharply when the dolphin is completely underwater the work done by the fluid resistance is still large and then the underwater acceleration stage starts again fig 10 d shows the change of the total energy consumed by the dolphin over time during the porpoising process in the underwater acceleration and the leaping stages the dolphin continuously overcomes the fluid force and the fluid torque and consumes the energy so the total energy consumed gradually increases with time when the dolphin glides in the air the body has been kept straight and rotated around the center of mass which will consume a little energy maybe this energy is very small and could be ignored when the dolphin reenters the water again and accelerates underwater it starts to overcome the fluid force and the fluid torque and consumes the energy again thus the total energy consumed increases gradually to the best of our knowledge this may be the first time that the time history variations of displacement velocity fluid force and energy function during the porpoising movement of the dolphin are so clearly demonstrated 4 3 transient variation of flow field to reveal the mechanisms of the porpoising behavior it is necessary to explore the transient variation of the flow field by extracting the phase diagrams we could monitor the transient information of the dolphin motion fig 11 presents the phase diagrams of the dolphin at multiple discrete instants it can be observed that the dolphin is in different positions at different stages fig 12 shows the pressure distribution of the flow field which is affected only in the region around the dolphin as the dolphin accelerates under the water leaps out of the water glides in the air and dives into the water again the entire porpoising process of the dolphin starts at t 0s and ends at t 2 58s this process has been divided into four stages which are presented as four areas in figs 9 and 10 it is evident from fig 12 that the pressure distribution of the flow filed is uniform and zero at t 0s due to initialization while at other times the underwater pressure has a significant gradient distribution for more detailed information please see the video files s1 animation of phase diagram and s2 animation of pressure contour available online as the dolphin starts to accelerate swimming under the water in the area i there is always a high pressure core located at the forehead when the tail of the dolphin is at its upmost position at time t 0 63s fig 12 shows that a high pressure core is located at the upper side of the body while a low pressure core is located at the lower side as shown in fig 9 b the dolphin experiences a thrust force at this point this thrust force arises due to the local forward positive pressure gradient existing on the tail is stronger than the backward negative pressure gradient around the head close inspection shows that for the dolphin swimming during the down stroke a high pressure core occurs on the lower surface of the body and a low pressure core exists on the upper side as the dolphin travels at the down stroke both the high pressure core and the low pressure core gradually move toward the trailing edge and then shed from the tail and form the wakes the imbalances in the pressure distribution around the dolphin result in either ascending or descending thrust force moreover the fluctuation of the thrust force is due to the fact that the movement of the pressure core leads to the alternate variations of the pressure difference around the dolphin as the wakes are formed by the shedding of the pressure cores from the tail a new pair of the pressure cores is formed at the leading edge of the dolphin similar observations can be found in the ref fish et al 2014 xia et al 2015 park et al 2016 as the dolphin travels during the up stroke the pressure distributions mirror the pattern observed in the down stroke during the leap stage of the dolphin in the area ii as seen from the phase diagram in fig 11 and the pressure contour in fig 12 at t 1 06s the dolphin has certain effect on the water surface as it moves out of the water then the water surface appears some waves which subsequently act on the dolphin via the fluid effects causing severe force changes instantly on the dolphin at this time the high pressure core located at the forehead of the dolphin disappears this is due to that the air density is about 1 800 of the water which produces a very small inertia effect on the forehead during the glide stage of the dolphin in the area iii as seen from the phase diagram in fig 11 and the pressure contour in fig 12 at t 1 22s t 1 48s and t 1 78s certain amount of water adheres to the dolphin s body as the dolphin has just departed from the water surface which also confirms the force changes on the dolphin shown in fig 9 the pressure distribution around the dolphin roughly stays unchanged and the water surface restores its equilibrium during this process at the same time the dolphin rotates itself at a constant angular velocity around the center of mass under the action of the fluid torque generated at the previous leap stage as the dolphin dives into the water in the area iv at t 1 91s the phase diagram in fig 11 shows the waves produced again around the water surface and the high pressure core near the forehead of the dolphin is formed as well in the pressure contour shown in fig 12 after the dolphin fully reenters the water and starts its accelerated swimming such as at t 2 30s the pressure distribution of the body changes periodically again 4 4 effect of kinematic parameters on porpoising performance to evaluate the porpoising performance the critical emergence velocity the maximum leap height the maximum leap distance and the energy functions are chosen to quantify the effects of the kinematic parameters on them first of all we carry out several porpoising simulations to find the critical emergence velocity v ce resulting from various kinematic parameters i e the escape angle α changing from 30 to 90 and the oscillating frequency f ranging from 5 hz to 10 hz fig 13 a shows the relationship between the v ce v cex v cey denotes the component of v ce along x y axis respectively and α for a given value of f 5 hz as the dolphin just leaps out of the water from fig 13 a it can be seen that with the increase of α the v cex decreases and the rate of decrease is relatively large conversely the v cey increase as α increase and the higher α is and the slower the increasing speed is the combined velocity v ce decreases slowly as α increase therefore this figure underscores the effect of the escape angle on the critical emergence velocity for leaps the similar conclusion had been made by gordon 1980 actually fast mammal swimmers may try to maintain their forward velocity by using the emergence angle of 30 in nature au and weihs 1980 fish 1993 close inspection of fig 13 a shows that the dolphin has relatively good motion ability in the horizontal vertical direction when the value of α is 30 90 fig 13 b presents the v ce corresponding to different f when α 75 is given it can be observed from fig 13 b that with the increase of f the v cex gradually increases and the rate of increase is small the v cey and the combined velocity v ce have obvious increase comparing fig 13 a and b it could be found that the increase of f is more conducive to the increase of v ce than the increase of α even though fig 13 shows results only for this case similar plots for other parameters not shown exhibit essentially all the qualitative trends secondly it is important to evaluate the maximum leap height h max and the maximum leap distance d max fig 14 a plots the variations of h max as functions of α and f it can be seen that for a given value of f h max increase as α increases from 30 to 90 and the higher α is and the slower the increasing speed is this is due to the fact that v cey increases monotonically as α increases and the increase rate is gradually decreasing as shown in fig 13 a meanwhile for a fixed α h max increases monotonically as f increases from 5 hz to 10 hz and the rate of increase is almost linear this is because v cey increases linearly as f increases as shown in fig 13 b it should be noted that compared with the increase of α the increase of f is more beneficial to the increase of h max fig 14 b plots the variations of d max as functions of α and f both α and f are changed at the same range to match to the above results for h max in fig 14 b it is clearly observed that for a given f the trend of d max initially increases as α is increasing with a critical point of slightly greater than 45 and then decreases as α is increased further the peak of d max occurs between 45 and 60 in all simulated groups in addition for a given α the values of d max increase monotonically as f increases from 5 hz to 10 hz and the higher f is and the faster the increasing speed is closer inspection of fig 14 b reveals that the critical point of α to reach the peak values of d max is in the range of 45 α 60 and nears 50 for all given values of f maybe the effect of α on the leap distance d max has never been illustrated elsewhere before for the porpoising behavior of dolphins to further illustrate the effect of the kinematic parameters on the energy functions fig 15 a shows the relationship between the maximum energy obtained by the dolphin e o b m and the escape angle α and the oscillating frequency f it can be seen from the figure that for a given f e o b m does not change significantly at different α the basic trend is that e o b m decreases slightly as α increases given α e o b m increases with the increase of f and the higher f is and the faster the increasing speed is fig 15 b plots the changing rules of the maximum energy consumed by the dolphin e c o n m with α and f in this figure e c o n m decreases with the increase of α for a given f this is because the larger the α the shorter the distance the dolphin swim underwater and thus the less energy it consumes given α e c o n m increases with the increase of f and the increase rate gradually increases fig 15 c reflects the relationship between the porpoising efficiency η and the escape angle α and the oscillating frequency f it can be seen from the figure that for a given f η increases with the increase of α and the higher α is and the slower the increasing speed is at the same α the trend of η initially increases as f is increasing with a critical point of slightly greater than 7 hz and then decreases as f is increased further the peak of η occurs between 7 hz and 8 hz in all simulated groups closer inspection finds that when f increases both e o b m and e c o n m increase but they increase in different magnitudes that is the dolphin obtains an increase in energy by increasing its own consumption and thus the efficiency changes non monotonously 4 5 discussion to further discuss the dependences of the porpoising performance on the kinematic parameters compared with the results in figs 13 and 14 show that for maximum leap velocity generation the escape angle is 30 and for maximum leap height achieved the escape angle is 90 this finding is in agreement with previous experimental results for dolphins swimming weihs 2002 2004 au and weihs 1980 gordon 1980 early studies concluded that the emergence angles of leaps by dolphins were widely distributed from 30 to 90 au and weihs 1980 gordon 1980 this qualitative trend had been predicted in early dolphins swimming experiments however the quantitative variations of the leap performance parameters based on the variations of the dolphin kinematics have never been obtained before for the porpoising movement perhaps this work is the first numerical attempt for the hydrodynamics study on the porpoising behavior of dolphins it is necessary to note that in order to achieve the maximum leap distance the escape angle should be within the range of 45 60 and close to 50 to achieve the maximum leap height the escape angle should be 90 another valuable suggestion is that the dolphin could employ the oscillating frequency between 7 hz and 8 hz close to 7 hz to complete its porpoising motion and then obtain better porpoising efficiency 5 conclusions in the present study we constructed a virtual dolphin and employed it to elucidate the hydrodynamics of the porpoising behavior and clarify the previous experimental results with live dolphins a four stage model is proposed to illustrate the maneuver process the virtual dolphin allowed us to perform controlled numerical experiments by systematically changing the oscillating frequency and the escape angle while keeping other parameters fixed various kinematic behaviors are simulated to obtain their porpoising performance the most important findings are summarized as follows 1 when the dolphin is in the underwater acceleration stage f x f y fluctuates around some negative positive mean values thus v x and v y fluctuate as well and increase gradually as time goes when the dolphin is in the upward leap stage both f x and f y reach the peak due to the free surface wave v x and v y vary irregularly at this time and two inflection points appear when the dolphin is in the air glide stage the drag and the buoyancy are negligible therefore f x and f y remain unchanged approximately which are close to zero and gravity and thus v x is almost unchanged and v y decreases linearly when the dolphin is in the downward dive stage both f x and f y change dramatically due to the relatively large drag as it is entering the water thus v x and v y decrease obviously at this time as the dolphin further reenters into the water both f x and f y fluctuate around some negative values and v x and v y increase reversely and fluctuate around the mean correspondingly 2 for a given f the results show that with the increase of α v cex decreases rapidly but v cey increases to some extent so the combined velocity v ce decreases slowly in this sense the dolphin has relatively good motion ability in the horizontal vertical direction when the value of α is 30 90 this finding is consisting with the fact that fast swimming animals try to maintain their forward velocity by using an emergence angle of 30 in nature in addition for a fixed α as f increases v cex gradually increases and the increase rate is small v cey and v ce has obvious increase and the increase rate is relatively large close inspection reveals that the increase of f is more beneficial to increasing the v ce than the increase of α 3 both the maximum leap height h max and the maximum leap distance d max are chosen to evaluate the porpoising performance quantitatively for a given value of f h max increase as α increases and the higher α is and the slower the increasing speed is for a fixed α h max increases monotonically as f increases and the rate of increase is almost linear note that increase of f is more beneficial to increasing the h max than the increase of α furthermore for a given f the trend of d max initially increases as α is increasing with a critical point of slightly greater than 45 and then decreases as α is increased further at a given α the values of d max increase monotonically as f increases and the higher f is the faster the increasing speed is it is important to noted that the critical point of α to reach the peak values of d max is in the range of 45 α 60 and nears 50 for all given values of f 4 the maximum energy obtained e o b m the maximum energy consumed e c o n m and the efficiency η of the dolphin are used to evaluate the energy functions of the porpoising behavior for a given f e o b m decreases slightly as α increases given α e o b m increases with the increase of f and the higher f is and the faster the increasing speed is moreover e c o n m decreases with the increase of α for a given f given α e c o n m increases with the increase of f and the increase rate gradually increases as for efficiency given f η increases with the increase of α and the higher α is and the slower the increasing speed is at the same α the trend of η initially increases as f is increasing with a critical point of slightly greater than 7 hz and then decreases as f is increased further the peak of η occurs between 7 hz and 8 hz in all simulated groups finally we have to mention that in addition to the kinematics parameters we considered here there are other morphological and kinematics parameters that could affect the porpoising performance of the dolphin maybe additional studies will be needed to investigate and quantify the effects of them another aspect that we did not address in this study is the dimensionless of the hydrodynamics parameters these issues however were not studied in the present work so that we can focus on exploring the feasibility of solving the hydrodynamics problem of the dolphin performing this complex behavior and further clarifying the effect of the kinematics on the porpoising performance numerically in conclusion in spite of several novel insights into the hydrodynamics of the porpoising behavior of dolphins we have contributed in this work many important issues remain to be explored credit author statement dan xia qifeng yin and weishan chen conceived the idea of the porpoising behavior of dolphins zhihan li and yunde shi constructed the theoretical model dan xia qifeng yin and jianping dou developed the user defined function procedures dan xia qifeng yin and zhihan li performed the numerical simulation all authors analysed the data and wrote the manuscript declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work was supported by national natural science foundation of china grant number 51875101 state key laboratory of robotics and system hit grant number sklrs 2018 kf 11 and the natural science foundation of jiangsu province of china grant number bk20170690 the authors greatly appreciate the referees for their helpful comments and suggestions which help improve this paper appendix a supplementary data the following are the supplementary data to this article multimedia component 1 multimedia component 1 multimedia component 2 multimedia component 2 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j oceaneng 2021 108985 
20801,hull girder damage degree identification by dynamic parameter change mainly solves the stiffness loss while ship safety assessment mainly aims at strength loss issues in this paper a novel method is proposed to calculate strength loss based on stiffness loss section modulus is taken as the strength index to reveal that the stiffness loss of hull girder after damage is not always equivalent to its strength loss and the theory for unequivalence between stiffness loss and strength loss unss is validated by 13 common cross sections a simplified hull section is taken as the research object to verify the theory by different damage cases finally the strength loss correction formulas based on stiffness loss under different damage conditions are summarized by the proportional relationship derived from neutral axis shift and stiffness loss results show that the shift of neutral axis is the main reason for unss different damage conditions will show different unss characteristics the new method concluded for calculating the strength loss of hull girder can help check the hull girder strength keywords hull girder damage stiffness loss strength loss unequivalence qualitative and quantitative research 1 introduction the strength of a ship after damage is a key concern of scholars feng et al 2020 lindemann et al 2020 alie and latumahina 2019 for civil ships grounding kim et al 2019 wang et al 2002 and collision can lead to damage of different degrees to hull girder for military ships ship viability can be severely weakened after they are damaged by anti ship weapons under natural environmental loads such as waves ships may even break off and capsize therefore it is hoped that the residual strength of the damaged ship can be accurately obtained in time after the occurrence of damage which is of great significance to assess the ship condition and ensure the life safety of crew for this purpose zhang zhang et al 2020 proposed a novel method by using the change of dynamic characteristic parameters of hull girder before and after damage to locate and quantify the damage in zhang s work the final results of stiffness loss identified cannot be generally used to assess the hull girder health condition so the purpose of this paper is to explore the relationship between stiffness and strength of the damaged hull girder there are few studies to investigate this issue and this work will generate fresh insight into the research of hull girder strength issues in the study of residual strength of hull girders a variety of strength based indexes were put forward by the methods of theory numerical simulation and experiments jiang 2017 to examine hull girder strength under different conditions a campanile campanile et al 2015 investigated time variant residual strength of bulk carriers under corrosion wastage and studied relevant incidence on hull girder residual strength finally the residual strength factor distribution vs time is determined together with relevant lower upper bound values with certain non exceedance probability level that in turn depends on correlation among corrosion wastages of all structural members rules based approaches are also frequently used by scholars rodrigues et al 2015 the residual strength of three double hull tankers designed according to the new international association of classification societies iacs common structural rules csr was studied by a w hussein hussein and guedes soares 2009 different damage scenarios at side and bottom are considered with different damage size to define a lower limit of strength which might be accounted for during design the residual strength is calculated using progressive collapse method pcm and applying the failure modes defined in the new rules the longitudinal strength of ships with damages due to grounding or collision accidents was investigated by wang g wang et al 2002 he derived analytical equations for the residual hull girder strength and the analytical equations were verified with direct calculations of sample commercial ships for a broad spectrum of accidents hull girder ultimate strengths of these sample vessels under sagging and hogging conditions are also calculated based on which correlation equations are proposed luis r m luis and teixeira 2006 used the first order reliability method to study the reliability analysis of a damaged suezmax double hull tanker subjected to accidental grounding the ultimate strength of the damaged tanker to be used in the formulation was calculated by means of a specific structural code in which the damage is simulated by the removal of the damaged elements different sizes of the damage are analyzed and a relationship was established with the reliability index related to the ultimate strength jeom kee paik paik et al 2003 proposed a set of the time dependent corrosion wastage models for 23 different member locations categories of bulk carriers and studied the effect of time variant corrosion wastage on the ultimate hull girder strength as well as the section moduli the criteria for repair and maintenance of heavily corroded structural members so as to keep the ultimate longitudinal strength at an acceptable level are discussed for some extremely harsh environments the ship s strength analysis is very important ehlers s ehlers sbenson and misirlis 2013 analyzed the ultimate strength of an intact and damaged lng vessel subjected to sub zero temperature szt due to cold climate he introduced damage to the hull girder to simulate the ship collision and thereby compared the ultimate strength between an intact and a damaged hull girder a simplified method was also used in order to calculate the ultimate strength based on the individual panel contributions both for the intact and damaged conditions as a result the sensitivity of the hull girder ultimate strength safety level to the materials temperature is assessed finite element method fem josko et al 2020 is also used by parunov j to simulate the damage and then analyze the ultimate hull girder strength in his work damaged elements were removed from the finite element model of the midship section of the struck ship and progressive finite element collapse analysis was then performed to determine residual strength index rsi of damaged ship in addition probabilistic analysis of rsi was performed by approximating damage shape as rectangular box based on imo and golads project artjoms kuznecovs kuznecovs et al 2020 presented a comparison between nonlinear finite element analysis fea and the smith method of fujikubo et al fujikubo and takemura 2012 the objective was to compare the accuracy and computation effort of the two methods for a double hull tanker under biaxial bending and various ship conditions results from ultimate strength analyses of the collision damaged hull structures showed that both methods captured the expected asymmetric ultimate strength response due to asymmetric damage for the rapid calculation of residual ultimate strength evaluation parunov j parunov et al 2017 developed residual strength diagrams for a rapid residual ultimate longitudinal strength assessment in both sagging and hogging and accounting for correction factor because of the rotation of neutral axis and the results of this study could be used for reference by classification societies in a rules development process in the risk assessment studies of the maritime transportation and for a quick calculation of the hull girder residual strength of a damaged ship in the situation requiring emergency response action based on the smith method wang tian wang 2014 developed the calculation method of the ultimate strength of hull structure with time changing in the whole life cycle and made in depth discussion and analysis on the time varying factors affecting the ultimate strength of hull from the past literature section modulus based and ultimate bending moment based indexes were widely used for hull girder strength check most studies mentioned above had only focused on direct hull girder strength calculation by means of finite element analysis and software programming analysis and the calculation processes on the hull girder residual strength will take a good part of time to do mechanical modeling and mechanics calculation the finite element model involved and the unique self programmed program were only limited to the current cases analysis which means that repetitive modeling and calculation work should be carried out when facing other damage cases in this paper a novel method to calculate the hull girder residual strength is proposed based on the stiffness loss section modulus is introduced to characterize hull girder strength the relationships between stiffness loss and strength loss after damage are studied and discussed by 13 common cross sections then the unss is investigated and validated qualitatively and quantitatively by different hull girder damage cases different from the shift of neutral axis defined in literature wang et al 2002 quantitative calculation of the shift of neutral axis is made through stiffness loss so as to better construct equations between strength loss and stiffness loss the strength loss is expressed only as the function of the stiffness loss and therefore has no other independent variables which will make it more convenient to get the strength loss once the stiffness loss is given with the development of dynamic parameters based damage identification applied for hull girder strength identification issues this paper attempts to reveal the unss phenomenon of these issues and the stiffness based methodology presented here provides an innovative way to indirectly obtain the strength loss to check the hull girder safety 2 hull girder strength check ships as complex structures in order to check residual strength it is necessary to determine the damage forms and the main parameters to characterize damage degree wang and liu 2009 for civilian ships accidental grounding and collision are the relatively common sources of damage for military ships damage forms of ship structure can be divided into the following types according to the damage payloads of anti ship weapons 1 damage caused by blast wave load the damage form of the ship structure is the damage of total longitudinal strength caused by the dynamic response of ship longitudinal bending caused by the blast wave load the main load forms are overpressure of air explosion shock wave underwater explosion shock wave kicinski and szturomski 2020 de camargo and vannucchi 2019 and bubble pulsation pressure cui et al 2016 2 damage caused by contact explosions under the effect of contact explosion ming et al 2016 rajendran and narasimhan 2001 the ship will have a large breach damage see fig 1 which will cause the loss of longitudinal strength of ship structure 3 local plastic deformation under non contact explosion ramajeyathilagam and vendhan 2004 olson et al 1993 ramajeyathilagam et al 2001 under non contact air or underwater explosion shock wave the local structure of ships will produce dynamic response which can result in local plastic deformation or plastic dynamic instability damage of ship structures the residual strength of ship structure will be reduced due to local deformation at the same time when damage occurs at different positions fig 2 the impact on various strength indexes also varies greatly in the strength analysis of hull girder the residual strength assessment index can be used to assess the strength the evaluation index based on section modulus is defined as 1 f s w w 0 where w is the effective section modulus of the damaged hull section w 0 is the effective section modulus of the intact hull section in this paper the strength loss is defined as 2 q 1 f s 100 3 proofs of the unss 3 1 cases study of common cross sections section modulus w is selected to describe the strength characteristics of the structure and the stiffness characteristics of the structure can be expressed as the product of elastic modulus e and moment of inertia i namely ei in this paper it is assumed that the elastic modulus of the structure will not change when the breach or plastic deformation damage exists the hull girder subjected to external loads will undergo plastic deformation or breach which is actually manifested as the damage of load bearing components in the damaged area it is the damage of these load bearing components that lead to the strength loss of hull girder therefore before exploring the unss of hull girder the paper cites a total of 13 commonly used hull components the damage is simulated by cutting its sectional area see fig 3 the circular blank area represents the damage table 1 shows the shape and moment of inertia i damaged i 0 intact the longest distance between the neutralization axis and the boundary z damaged z 0 intact the minimum section modulus w damaged and w 0 intact 3 2 theoretical proof of unss in order to further explain the unss shown in table 1 a theoretical study of this phenomenon is given as follows the geometric characteristics of the cross sections are defined as shown in fig 4 assuming that the x axis is the horizontal neutral axis of the cross section it can be seen that the neutral axis divides the section into the upper and lower regions there the distance between the neutral axis and the furthest side is defined as h 1 and the distance from the other side is defined as h 2 when damage occurs in the area shown in fig 4 a we define it as d a m a g e h 2 0 for damage shown in fig 4 b we define it as d a m a g e 0 h 1 the shift of neutral axis δ δ is positive when the neutral axis moves towards the original region 0 h 1 and negative when the neutral axis moves towards the original region h 2 0 table 2 shows the stiffness loss strength loss and the shift of neutral axis of the 13 sections after damage it can be seen that the stiffness and strength are reduced to different values and the stiffness loss of each section is not equal to its strength loss the stiffness loss of section 1 3 6 13 is less than the strength loss and the stiffness loss of section 4 and 5 is greater than the strength loss correspondingly the changes in the neutral axis of section 1 3 6 13 are all negative and all positive for section 4 5 in order to explain the unss of each section k is defined as the stiffness loss of the structure the following equation can be obtained 3 k e 0 i 0 e 0 i e 0 i 0 100 1 i i 0 100 q is defined as the strength loss of the structure 4 q w 0 w w 0 100 1 w w 0 100 according to ship mechanics we get 5 w 0 i 0 z 0 when the damage occurs 6 w i z i z 0 δ δ here by the definition of the shift of neutral axis if d a m a g e h 2 0 δ δ 0 if d a m a g e 0 h 1 δ δ 0 substituting equation 5 6 into equation 4 gives 7 q 1 i z 0 δ δ z 0 i 0 1 i i 0 z 0 z 0 δ δ to compare the relationship between stiffness loss k and strength loss q the difference between k and q is calculated 8 k q i i 0 δ δ z 0 δ δ it can be seen from equation 8 that the relationship between k and q depends on δ δ if δ δ 0 k q if δ δ 0 k q from fig 5 and fig 6 for section 1 3 6 13 d a m a g e 0 h 1 and δ δ 0 for section 4 and 5 d a m a g e h 2 0 and δ δ 0 according to the above theory for section 1 3 and 6 13 the stiffness loss is less than the strength loss for section 4 5 the stiffness loss of is greater than the strength loss according to the above results it can be concluded that the shift of the neutral axis is the main reason for the unss this paper introduces 13 common sections to reveal the unss phenomenon and demonstrate it by section modulus based theory the analysis and application of this theory to hull girder are given as follows 4 hull girder strength check a simplified hull girder section as shown in fig 7 is designed to discuss the unss of hull girder the red dotted line represents the neutral axis of the hull girder section the hull girder section is divided into two areas by definition namely 0 h 1 and h 2 0 the main dimensions are shown in table 3 4 1 damage conditions in this paper the hull girder damage is simplified and simulated by cut down the section area twelve damage conditions marked in red as shown in fig 8 are set different degrees of damage to the top b k l m side damage e d a m a g e 0 h 1 side damage f symmetric about the neutral axis multiple damages g different degrees of damage to the bottom c d h i j 4 2 analysis of unss of hull girder the section properties of intact and damaged hull section were calculated respectively see table 4 the moment of inertia and section modulus are all reduced due to damage correspondingly the damage also resulted in the movement of the neutral axis of the hull section it can be seen from fig 8 that for case b and e d a m a g e 0 h 1 according to the above theory the neutral axis will move towards the area h 2 0 and the change in the neutral axis is negative fig 9 the stiffness loss of hull girder is less than its strength loss under these working conditions fig 10 for case c d h i and j d a m a g e h 2 0 the neutral axis will move towards the area 0 h 1 the change in the neutral axis is negative and the stiffness loss of hull girder is greater than its strength loss under these working conditions for case f the damage occurs near the neutral axis and to a certain extent is symmetric about the neutralization axis under this condition the neutral axis almost does not deviate the stiffness loss and the strength loss remain unchanged as for case g it includes two damages respectively at the top and at the bottom similar to case f case g does not cause the movement of the neutral axis which makes the stiffness loss almost equal to the strength loss by comparing case c d h i and j it can be concluded that the stiffness and strength loss of hull girder are positively correlated with the damage area case e and f show that when the damage occurs near the neutral axis it will lead to a small deviation of the neutral axis the stiffness loss and strength loss of the hull girder will be small fig 10 all the data support the above derived theory 4 3 strength loss quantitative study based on stiffness loss according to eq 8 the difference between stiffness and strength is 9 k q i i 0 δ δ z 0 δ δ then 10 q k i i 0 δ δ z 0 δ δ because 11 i 0 i i 0 k substituting eq 11 into eq 10 gives 12 q z 0 k δ δ z 0 δ δ eq 12 is a quantitative calculation formula of strength loss based on stiffness loss where z 0 which is easily available is the distance between the neutral axis and the farthest side of the intact hull section k also a known value is the stiffness loss that can been identified through structural dynamic parameters δ δ is the deviation of hull section neutral axis after damage and it needs to be solved the following will explore the relationship between the shift of neutral axis and stiffness loss it can be seen from table 4 that if damage occurs at the top there is a negative correlation between shift of neutral axis and stiffness loss if damage occurs at the bottom they are positively correlated therefore in this paper the neutral axis shift and stiffness loss under these two conditions are respectively fitted linearly to explore the relationship between the two and the results are shown in fig 11 and fig 12 the fitting results are as follows as for damage occurs at the top 13 δ δ 2 04 k as for damage occurs at the bottom 14 δ δ 6 13 k from eq 13 and eq 14 it is easy to find that there is a proportional relationship between the two parameters in literature wang et al 2002 the shift of the neutral axis is defined as 15 δ δ c r 1 r where r δ a a δ a is the cross sectional area of the lost structure a is the cross sectional area of the intact structure its center is c from the neutral axis of the intact hull the moment of inertia of the damaged hull becomes 16 i i 0 a c 2 r 1 r the stiffness loss can be written as 17 k a c 2 r 1 r i 0 substituting eq 15 into eq 17 gives 18 δ δ i 0 a c k eq 18 suggests that there is a directly proportional relationship between stiffness and neutral axis shift once c is given and the relationship between stiffness loss and neutral axis shift can be obtained to further get the correction formula between stiffness loss and strength loss by substituting eq 18 into eq 12 the strength loss under the two damage conditions can be obtained namely 19 q 10 24 k 8 2 2 04 k t o p d a m a g e 2 07 k 8 2 6 13 k b o t t o m d a m a g e for the hull section studied in this paper when the shipboard suffers damage the strength loss is almost equivalent to the stiffness loss namely 20 q k fig 13 shows different correction relationships between stiffness loss and strength loss under different damage conditions it is much clear that strength loss will not equal to stiffness loss for the damage occurs at the top or bottom area of the ship when damage occurs at the top strength loss is greater than stiffness loss different from top damage strength loss is far less than stiffness loss for bottom damage when multiple damages occur eq 19 and eq 20 can be used to conduct separate studies on each injury and superposition method can be applied so as to obtain the strength loss of the hull section under multiple injuries i e 21 q q 1 q 2 q 3 for the object of this paper eqs 19 21 provide a novel calculation method to obtain strength loss of damaged hull girder with the application of modal parameters based technology in ship damage identification this method provides an indirect way to obtain residual strength and will help check hull girder strength 5 conclusions in this paper it is revealed that the stiffness loss and strength loss are not equal when the structure is damaged and the unss will be particularly evident when the damage appears away from the neutral axis based on the section modulus index this paper studies the source and criterion of the unss and validates it by 13 different cross sections finally the relationship between the neutral axis shift and the stiffness loss is obtained to further discuss quantitative calculation of strength loss under different damage conditions on the basis of this theory the unss of hull girder is discussed and the correction formula of strength loss derived from stiffness loss under different working conditions is summarized the main conclusions are as follows 1 when section modulus is used to check the hull girder strength the shift of neutral axis is the main reason for the unss 2 the difference between stiffness loss and strength loss depends on the location of damage 3 the relationship between stiffness loss and neutral axis shift is proportional once the center of the lost area is given and then the quantitative expression of strength loss can be obtained 6 future works this paper preliminarily puts forward the unss phenomenon and establishes the relationship between stiffness loss and strength loss when hull girder is damaged we suppose that the ship components will not be able to effectively bear the bending moment load when ship longitudinal components occur buckling and instability and then the hull girder ultimate strength will be reduced however the buckling and unstable ship components remain longitudinally continuous and still can provide effective stiffness therefore it is believed that the buckling and instability characteristics of ship components should be the fundamental reason for the unss which needs further investigation based on the buckling and instability characteristics of ship longitudinal components the unss will also be discussed in depth by other strength indexes credit authorship contribution statement yin zhang methodology writing original draft development or design of methodology creation of models preparation creation and or presentation of the published work specifically writing the initial draft including substantive translation jun guo oversight and leadership responsibility for the research activity planning and execution including mentorship external to the core team jiang xu visualization data curation preparation creation and or presentation of the published work specifically visualization data presentation shun li reproducibility of results and other research outputs junjie yang management and coordination responsibility for the research activity planning and execution declaration of competing interest the authors declare that they have no conflicts of interest acknowledgments this study was funded by national science and technology major project 2017 v 0002 0051 
20801,hull girder damage degree identification by dynamic parameter change mainly solves the stiffness loss while ship safety assessment mainly aims at strength loss issues in this paper a novel method is proposed to calculate strength loss based on stiffness loss section modulus is taken as the strength index to reveal that the stiffness loss of hull girder after damage is not always equivalent to its strength loss and the theory for unequivalence between stiffness loss and strength loss unss is validated by 13 common cross sections a simplified hull section is taken as the research object to verify the theory by different damage cases finally the strength loss correction formulas based on stiffness loss under different damage conditions are summarized by the proportional relationship derived from neutral axis shift and stiffness loss results show that the shift of neutral axis is the main reason for unss different damage conditions will show different unss characteristics the new method concluded for calculating the strength loss of hull girder can help check the hull girder strength keywords hull girder damage stiffness loss strength loss unequivalence qualitative and quantitative research 1 introduction the strength of a ship after damage is a key concern of scholars feng et al 2020 lindemann et al 2020 alie and latumahina 2019 for civil ships grounding kim et al 2019 wang et al 2002 and collision can lead to damage of different degrees to hull girder for military ships ship viability can be severely weakened after they are damaged by anti ship weapons under natural environmental loads such as waves ships may even break off and capsize therefore it is hoped that the residual strength of the damaged ship can be accurately obtained in time after the occurrence of damage which is of great significance to assess the ship condition and ensure the life safety of crew for this purpose zhang zhang et al 2020 proposed a novel method by using the change of dynamic characteristic parameters of hull girder before and after damage to locate and quantify the damage in zhang s work the final results of stiffness loss identified cannot be generally used to assess the hull girder health condition so the purpose of this paper is to explore the relationship between stiffness and strength of the damaged hull girder there are few studies to investigate this issue and this work will generate fresh insight into the research of hull girder strength issues in the study of residual strength of hull girders a variety of strength based indexes were put forward by the methods of theory numerical simulation and experiments jiang 2017 to examine hull girder strength under different conditions a campanile campanile et al 2015 investigated time variant residual strength of bulk carriers under corrosion wastage and studied relevant incidence on hull girder residual strength finally the residual strength factor distribution vs time is determined together with relevant lower upper bound values with certain non exceedance probability level that in turn depends on correlation among corrosion wastages of all structural members rules based approaches are also frequently used by scholars rodrigues et al 2015 the residual strength of three double hull tankers designed according to the new international association of classification societies iacs common structural rules csr was studied by a w hussein hussein and guedes soares 2009 different damage scenarios at side and bottom are considered with different damage size to define a lower limit of strength which might be accounted for during design the residual strength is calculated using progressive collapse method pcm and applying the failure modes defined in the new rules the longitudinal strength of ships with damages due to grounding or collision accidents was investigated by wang g wang et al 2002 he derived analytical equations for the residual hull girder strength and the analytical equations were verified with direct calculations of sample commercial ships for a broad spectrum of accidents hull girder ultimate strengths of these sample vessels under sagging and hogging conditions are also calculated based on which correlation equations are proposed luis r m luis and teixeira 2006 used the first order reliability method to study the reliability analysis of a damaged suezmax double hull tanker subjected to accidental grounding the ultimate strength of the damaged tanker to be used in the formulation was calculated by means of a specific structural code in which the damage is simulated by the removal of the damaged elements different sizes of the damage are analyzed and a relationship was established with the reliability index related to the ultimate strength jeom kee paik paik et al 2003 proposed a set of the time dependent corrosion wastage models for 23 different member locations categories of bulk carriers and studied the effect of time variant corrosion wastage on the ultimate hull girder strength as well as the section moduli the criteria for repair and maintenance of heavily corroded structural members so as to keep the ultimate longitudinal strength at an acceptable level are discussed for some extremely harsh environments the ship s strength analysis is very important ehlers s ehlers sbenson and misirlis 2013 analyzed the ultimate strength of an intact and damaged lng vessel subjected to sub zero temperature szt due to cold climate he introduced damage to the hull girder to simulate the ship collision and thereby compared the ultimate strength between an intact and a damaged hull girder a simplified method was also used in order to calculate the ultimate strength based on the individual panel contributions both for the intact and damaged conditions as a result the sensitivity of the hull girder ultimate strength safety level to the materials temperature is assessed finite element method fem josko et al 2020 is also used by parunov j to simulate the damage and then analyze the ultimate hull girder strength in his work damaged elements were removed from the finite element model of the midship section of the struck ship and progressive finite element collapse analysis was then performed to determine residual strength index rsi of damaged ship in addition probabilistic analysis of rsi was performed by approximating damage shape as rectangular box based on imo and golads project artjoms kuznecovs kuznecovs et al 2020 presented a comparison between nonlinear finite element analysis fea and the smith method of fujikubo et al fujikubo and takemura 2012 the objective was to compare the accuracy and computation effort of the two methods for a double hull tanker under biaxial bending and various ship conditions results from ultimate strength analyses of the collision damaged hull structures showed that both methods captured the expected asymmetric ultimate strength response due to asymmetric damage for the rapid calculation of residual ultimate strength evaluation parunov j parunov et al 2017 developed residual strength diagrams for a rapid residual ultimate longitudinal strength assessment in both sagging and hogging and accounting for correction factor because of the rotation of neutral axis and the results of this study could be used for reference by classification societies in a rules development process in the risk assessment studies of the maritime transportation and for a quick calculation of the hull girder residual strength of a damaged ship in the situation requiring emergency response action based on the smith method wang tian wang 2014 developed the calculation method of the ultimate strength of hull structure with time changing in the whole life cycle and made in depth discussion and analysis on the time varying factors affecting the ultimate strength of hull from the past literature section modulus based and ultimate bending moment based indexes were widely used for hull girder strength check most studies mentioned above had only focused on direct hull girder strength calculation by means of finite element analysis and software programming analysis and the calculation processes on the hull girder residual strength will take a good part of time to do mechanical modeling and mechanics calculation the finite element model involved and the unique self programmed program were only limited to the current cases analysis which means that repetitive modeling and calculation work should be carried out when facing other damage cases in this paper a novel method to calculate the hull girder residual strength is proposed based on the stiffness loss section modulus is introduced to characterize hull girder strength the relationships between stiffness loss and strength loss after damage are studied and discussed by 13 common cross sections then the unss is investigated and validated qualitatively and quantitatively by different hull girder damage cases different from the shift of neutral axis defined in literature wang et al 2002 quantitative calculation of the shift of neutral axis is made through stiffness loss so as to better construct equations between strength loss and stiffness loss the strength loss is expressed only as the function of the stiffness loss and therefore has no other independent variables which will make it more convenient to get the strength loss once the stiffness loss is given with the development of dynamic parameters based damage identification applied for hull girder strength identification issues this paper attempts to reveal the unss phenomenon of these issues and the stiffness based methodology presented here provides an innovative way to indirectly obtain the strength loss to check the hull girder safety 2 hull girder strength check ships as complex structures in order to check residual strength it is necessary to determine the damage forms and the main parameters to characterize damage degree wang and liu 2009 for civilian ships accidental grounding and collision are the relatively common sources of damage for military ships damage forms of ship structure can be divided into the following types according to the damage payloads of anti ship weapons 1 damage caused by blast wave load the damage form of the ship structure is the damage of total longitudinal strength caused by the dynamic response of ship longitudinal bending caused by the blast wave load the main load forms are overpressure of air explosion shock wave underwater explosion shock wave kicinski and szturomski 2020 de camargo and vannucchi 2019 and bubble pulsation pressure cui et al 2016 2 damage caused by contact explosions under the effect of contact explosion ming et al 2016 rajendran and narasimhan 2001 the ship will have a large breach damage see fig 1 which will cause the loss of longitudinal strength of ship structure 3 local plastic deformation under non contact explosion ramajeyathilagam and vendhan 2004 olson et al 1993 ramajeyathilagam et al 2001 under non contact air or underwater explosion shock wave the local structure of ships will produce dynamic response which can result in local plastic deformation or plastic dynamic instability damage of ship structures the residual strength of ship structure will be reduced due to local deformation at the same time when damage occurs at different positions fig 2 the impact on various strength indexes also varies greatly in the strength analysis of hull girder the residual strength assessment index can be used to assess the strength the evaluation index based on section modulus is defined as 1 f s w w 0 where w is the effective section modulus of the damaged hull section w 0 is the effective section modulus of the intact hull section in this paper the strength loss is defined as 2 q 1 f s 100 3 proofs of the unss 3 1 cases study of common cross sections section modulus w is selected to describe the strength characteristics of the structure and the stiffness characteristics of the structure can be expressed as the product of elastic modulus e and moment of inertia i namely ei in this paper it is assumed that the elastic modulus of the structure will not change when the breach or plastic deformation damage exists the hull girder subjected to external loads will undergo plastic deformation or breach which is actually manifested as the damage of load bearing components in the damaged area it is the damage of these load bearing components that lead to the strength loss of hull girder therefore before exploring the unss of hull girder the paper cites a total of 13 commonly used hull components the damage is simulated by cutting its sectional area see fig 3 the circular blank area represents the damage table 1 shows the shape and moment of inertia i damaged i 0 intact the longest distance between the neutralization axis and the boundary z damaged z 0 intact the minimum section modulus w damaged and w 0 intact 3 2 theoretical proof of unss in order to further explain the unss shown in table 1 a theoretical study of this phenomenon is given as follows the geometric characteristics of the cross sections are defined as shown in fig 4 assuming that the x axis is the horizontal neutral axis of the cross section it can be seen that the neutral axis divides the section into the upper and lower regions there the distance between the neutral axis and the furthest side is defined as h 1 and the distance from the other side is defined as h 2 when damage occurs in the area shown in fig 4 a we define it as d a m a g e h 2 0 for damage shown in fig 4 b we define it as d a m a g e 0 h 1 the shift of neutral axis δ δ is positive when the neutral axis moves towards the original region 0 h 1 and negative when the neutral axis moves towards the original region h 2 0 table 2 shows the stiffness loss strength loss and the shift of neutral axis of the 13 sections after damage it can be seen that the stiffness and strength are reduced to different values and the stiffness loss of each section is not equal to its strength loss the stiffness loss of section 1 3 6 13 is less than the strength loss and the stiffness loss of section 4 and 5 is greater than the strength loss correspondingly the changes in the neutral axis of section 1 3 6 13 are all negative and all positive for section 4 5 in order to explain the unss of each section k is defined as the stiffness loss of the structure the following equation can be obtained 3 k e 0 i 0 e 0 i e 0 i 0 100 1 i i 0 100 q is defined as the strength loss of the structure 4 q w 0 w w 0 100 1 w w 0 100 according to ship mechanics we get 5 w 0 i 0 z 0 when the damage occurs 6 w i z i z 0 δ δ here by the definition of the shift of neutral axis if d a m a g e h 2 0 δ δ 0 if d a m a g e 0 h 1 δ δ 0 substituting equation 5 6 into equation 4 gives 7 q 1 i z 0 δ δ z 0 i 0 1 i i 0 z 0 z 0 δ δ to compare the relationship between stiffness loss k and strength loss q the difference between k and q is calculated 8 k q i i 0 δ δ z 0 δ δ it can be seen from equation 8 that the relationship between k and q depends on δ δ if δ δ 0 k q if δ δ 0 k q from fig 5 and fig 6 for section 1 3 6 13 d a m a g e 0 h 1 and δ δ 0 for section 4 and 5 d a m a g e h 2 0 and δ δ 0 according to the above theory for section 1 3 and 6 13 the stiffness loss is less than the strength loss for section 4 5 the stiffness loss of is greater than the strength loss according to the above results it can be concluded that the shift of the neutral axis is the main reason for the unss this paper introduces 13 common sections to reveal the unss phenomenon and demonstrate it by section modulus based theory the analysis and application of this theory to hull girder are given as follows 4 hull girder strength check a simplified hull girder section as shown in fig 7 is designed to discuss the unss of hull girder the red dotted line represents the neutral axis of the hull girder section the hull girder section is divided into two areas by definition namely 0 h 1 and h 2 0 the main dimensions are shown in table 3 4 1 damage conditions in this paper the hull girder damage is simplified and simulated by cut down the section area twelve damage conditions marked in red as shown in fig 8 are set different degrees of damage to the top b k l m side damage e d a m a g e 0 h 1 side damage f symmetric about the neutral axis multiple damages g different degrees of damage to the bottom c d h i j 4 2 analysis of unss of hull girder the section properties of intact and damaged hull section were calculated respectively see table 4 the moment of inertia and section modulus are all reduced due to damage correspondingly the damage also resulted in the movement of the neutral axis of the hull section it can be seen from fig 8 that for case b and e d a m a g e 0 h 1 according to the above theory the neutral axis will move towards the area h 2 0 and the change in the neutral axis is negative fig 9 the stiffness loss of hull girder is less than its strength loss under these working conditions fig 10 for case c d h i and j d a m a g e h 2 0 the neutral axis will move towards the area 0 h 1 the change in the neutral axis is negative and the stiffness loss of hull girder is greater than its strength loss under these working conditions for case f the damage occurs near the neutral axis and to a certain extent is symmetric about the neutralization axis under this condition the neutral axis almost does not deviate the stiffness loss and the strength loss remain unchanged as for case g it includes two damages respectively at the top and at the bottom similar to case f case g does not cause the movement of the neutral axis which makes the stiffness loss almost equal to the strength loss by comparing case c d h i and j it can be concluded that the stiffness and strength loss of hull girder are positively correlated with the damage area case e and f show that when the damage occurs near the neutral axis it will lead to a small deviation of the neutral axis the stiffness loss and strength loss of the hull girder will be small fig 10 all the data support the above derived theory 4 3 strength loss quantitative study based on stiffness loss according to eq 8 the difference between stiffness and strength is 9 k q i i 0 δ δ z 0 δ δ then 10 q k i i 0 δ δ z 0 δ δ because 11 i 0 i i 0 k substituting eq 11 into eq 10 gives 12 q z 0 k δ δ z 0 δ δ eq 12 is a quantitative calculation formula of strength loss based on stiffness loss where z 0 which is easily available is the distance between the neutral axis and the farthest side of the intact hull section k also a known value is the stiffness loss that can been identified through structural dynamic parameters δ δ is the deviation of hull section neutral axis after damage and it needs to be solved the following will explore the relationship between the shift of neutral axis and stiffness loss it can be seen from table 4 that if damage occurs at the top there is a negative correlation between shift of neutral axis and stiffness loss if damage occurs at the bottom they are positively correlated therefore in this paper the neutral axis shift and stiffness loss under these two conditions are respectively fitted linearly to explore the relationship between the two and the results are shown in fig 11 and fig 12 the fitting results are as follows as for damage occurs at the top 13 δ δ 2 04 k as for damage occurs at the bottom 14 δ δ 6 13 k from eq 13 and eq 14 it is easy to find that there is a proportional relationship between the two parameters in literature wang et al 2002 the shift of the neutral axis is defined as 15 δ δ c r 1 r where r δ a a δ a is the cross sectional area of the lost structure a is the cross sectional area of the intact structure its center is c from the neutral axis of the intact hull the moment of inertia of the damaged hull becomes 16 i i 0 a c 2 r 1 r the stiffness loss can be written as 17 k a c 2 r 1 r i 0 substituting eq 15 into eq 17 gives 18 δ δ i 0 a c k eq 18 suggests that there is a directly proportional relationship between stiffness and neutral axis shift once c is given and the relationship between stiffness loss and neutral axis shift can be obtained to further get the correction formula between stiffness loss and strength loss by substituting eq 18 into eq 12 the strength loss under the two damage conditions can be obtained namely 19 q 10 24 k 8 2 2 04 k t o p d a m a g e 2 07 k 8 2 6 13 k b o t t o m d a m a g e for the hull section studied in this paper when the shipboard suffers damage the strength loss is almost equivalent to the stiffness loss namely 20 q k fig 13 shows different correction relationships between stiffness loss and strength loss under different damage conditions it is much clear that strength loss will not equal to stiffness loss for the damage occurs at the top or bottom area of the ship when damage occurs at the top strength loss is greater than stiffness loss different from top damage strength loss is far less than stiffness loss for bottom damage when multiple damages occur eq 19 and eq 20 can be used to conduct separate studies on each injury and superposition method can be applied so as to obtain the strength loss of the hull section under multiple injuries i e 21 q q 1 q 2 q 3 for the object of this paper eqs 19 21 provide a novel calculation method to obtain strength loss of damaged hull girder with the application of modal parameters based technology in ship damage identification this method provides an indirect way to obtain residual strength and will help check hull girder strength 5 conclusions in this paper it is revealed that the stiffness loss and strength loss are not equal when the structure is damaged and the unss will be particularly evident when the damage appears away from the neutral axis based on the section modulus index this paper studies the source and criterion of the unss and validates it by 13 different cross sections finally the relationship between the neutral axis shift and the stiffness loss is obtained to further discuss quantitative calculation of strength loss under different damage conditions on the basis of this theory the unss of hull girder is discussed and the correction formula of strength loss derived from stiffness loss under different working conditions is summarized the main conclusions are as follows 1 when section modulus is used to check the hull girder strength the shift of neutral axis is the main reason for the unss 2 the difference between stiffness loss and strength loss depends on the location of damage 3 the relationship between stiffness loss and neutral axis shift is proportional once the center of the lost area is given and then the quantitative expression of strength loss can be obtained 6 future works this paper preliminarily puts forward the unss phenomenon and establishes the relationship between stiffness loss and strength loss when hull girder is damaged we suppose that the ship components will not be able to effectively bear the bending moment load when ship longitudinal components occur buckling and instability and then the hull girder ultimate strength will be reduced however the buckling and unstable ship components remain longitudinally continuous and still can provide effective stiffness therefore it is believed that the buckling and instability characteristics of ship components should be the fundamental reason for the unss which needs further investigation based on the buckling and instability characteristics of ship longitudinal components the unss will also be discussed in depth by other strength indexes credit authorship contribution statement yin zhang methodology writing original draft development or design of methodology creation of models preparation creation and or presentation of the published work specifically writing the initial draft including substantive translation jun guo oversight and leadership responsibility for the research activity planning and execution including mentorship external to the core team jiang xu visualization data curation preparation creation and or presentation of the published work specifically visualization data presentation shun li reproducibility of results and other research outputs junjie yang management and coordination responsibility for the research activity planning and execution declaration of competing interest the authors declare that they have no conflicts of interest acknowledgments this study was funded by national science and technology major project 2017 v 0002 0051 
20802,we present a smooth particle hydrodynamics sph formulation that captures the sloshing frequencies of tanks and accurately simulates long duration violent sloshing in partially filled tanks of arbitrary shape the sph simulations are performed using a modified version of the open source code dualsphysics that incorporates a density based stabilization δ sph and imposes wall boundary conditions via ghost particles in order to achieve pressure fields without spurious spatial oscillations and to reduce non physical energy dissipation we verify the sph scheme by showing that calculated sloshing wave heights forces and natural sloshing frequencies of tanks of simple shapes namely rectangular cylindrical upright and spherical match the analytical values given by the potential theory in the linear regime the scheme is then validated by predicting the sloshing frequencies obtained experimentally in a toroidal tank and in a pill shaped tank finally we present a study of a pill shaped tank subject to a long period of external forcing comparing simulated sloshing forces to experimental values obtained by esa estac the simulation is shown to fairly accurately reproduce the sloshing forces and predict the transition to swirling wave motion analysis of the frequency range further showed good agreement of the dominant frequencies between the experimental and simulated forces keywords smooth particle hydrodynamics sph dualsphysics non linear sloshing natural sloshing frequency general tank geometries verification and validation 1 introduction prediction of the forces caused by the motion of a liquid within a moving tank known as sloshing is of fundamental importance for the design and operation of vehicles carrying these tanks coupling of the modes of motion of the liquid and the vehicle could adversely affect the stability of the trajectory of the vehicle and its control further if the forces generated during sloshing are significant the structural integrity of the tank could also be detrimentally affected examples of the relevance of sloshing in various engineering fields can be consulted in the textbook by faltinsen and timokha 2009 however sloshing is a complex dynamic phenomenon that exhibits free surfaces and if several phases are present moving interfaces analytical methods exist and are extensively discussed in classical treatises abramson 1966 dodge 2000 and in textbooks ibrahim 2005 faltinsen and timokha 2009 these are mostly based on linear theories and are thus limited in scope experiments whenever feasible provide physical fidelity but at considerable cost and tend to be used sparsely lacapere et al 2009 souto iglesias et al 2011 on the other hand verified and validated computational fluid dynamics cfd tools offer the possibility to accurately predict slosh dynamics with a view to reducing its negative impact on vehicle performance and also to eventually simulate situations e g micro gravity effects which are beyond the reach of ground based experimental facilities abramson 1966 snyder 1999 one of the main problems to tackle in the cfd simulation of fluid sloshing is that of numerically modelling moving free surfaces and interfaces broadly speaking there are two groups of such modelling techniques particle based or meshless and mesh based in particle based methods such as sph monaghan 2012 or moving least squares trask et al 2016 the discretization is attached to particles which are advected with the flow and the description of the interfaces no matter how complicated is the result of their motion the interested reader could consult reference gotoh and khayyer 2018 for a review of the use of particle methods in modelling for coastal and ocean engineering on the other hand in mesh based methods the interface is approximated on a mesh that is either fixed eulerian approach or advecting with the flow lagrangian approach in this last case large motions of the interface might lead to severe mesh distortions that in turn could result in numerical inaccuracies and instabilities even though mixed methods such the arbitrary lagrangian eulerian or ale technique that attempt to get the best qualities of both approaches have also been proposed braess and wriggers 2000 the most popular approach is to track the interface as it travels across a fixed mesh using the volume of fluid vof method hirt and nichols 1981 with piecewise linear interface calculation plic rider and kothe 1998 this approach is used in several commercial and academic cfd codes 1 1 for instance commercial codes such as flow 3d https www flow3d com ansys fluent https www ansys com converge https convergecfd com and siemens star ccm https www plm automation siemens com and open source codes such as gerris http gfs sourceforge net and openfoam https www openfoam com websites accessed 10 august 2020 an alternative representation of the interface on a fixed mesh is as a level set osher and sethian 1988 for instance such an approach has been used for modelling sloshing in references bai et al 2015 bihs et al 2016 sph is a popular particle based method for modelling free surface problems such as sloshing due its lagrangian nature it is able to represent sharp interfaces without the need for high order advection schemes or explicit interface reconstruction discontinuities can develop naturally from the movement of the particles and in the weakly compressible sph formulation there is no need to impose boundary conditions at the free surface colagrossi et al 2009 sph is able to handle complex phenomena such as liquid break up and complex geometries and it has been successfully used to simulate violent sloshing the basis evolution and recent progress of sph and its various applications can be consulted in a few past and recent review articles liu and liu 2010 monaghan 2012 violeau and rogers 2016 ye et al 2019 lind et al 2020 focusing on the application of sph to problems of interest in ocean engineering sph was used in simulations of passive anti roll tanks by comparing computed and experimental values of the phase lag for the roll moment for different fillings and roll amplitudes souto iglesias et al 2004 reference colagrossi et al validated sph models against an experimental setup of a rigid body rectangular tank and pure sway motion these were followed by sph analyses of sloshing loads in carriers tankers delorme and souto iglesias a rectangular tank in rolling motion delorme and souto iglesias and tuned liquid dampers bulian et al 2010 as well as studies of the violent sloshing phenomenon khayyer and gotoh 2009 colagrossi et al 2010 an overview of the state of the art up to 2010 in modelling sloshing using sph is given in reference gómez gesteira et al 2010 a set of experimental tests specifically selected for the validation of the sph methodology was proposed in reference souto iglesias et al 2011 the sph methodology has been applied to the simulation of liquid sloshing in tanks vorobyev et al 2011 in tanks with obstacles inside rafiee et al 2011 and in tanks with baffles of various degrees of complexity bai et al 2013 zheng et al 2018 further instances of modelling of sloshing via sph worth mentioning are the analysis of shallow depth sloshing for sway bouscasse et al 2013 the simulation of sloshing seakeeping coupling problems serván camas et al 2016 and the incorporation of fluid structure interaction concerns such as these resulting from roll motion and pressure impact in a tank bulian and cercos pita 2018 or from the interaction of sloshing and external waves for a damaged ship cao et al 2019 a more detailed review of sph for the simulation wave breaking and sloshing can be consulted in section 8 3 1 of the recent article by r a ibrahim 2020 here we aim to undertake a comparison of sph simulations with experimental sloshing data gathered by the estec test centre of esa on a test campaign using their hydraulic powered shaker table with the objective of providing reference data on surface elevations and forces for cfd code validation this campaign is briefly described in reference lada et al and involved two sloshing experiments on partially filled tanks subject to large amplitude horizontal excitation the main distinctive features of the experiments were the presence of strong nonlinear free surface phenomena and unlike previously reported experiments the long duration of the excitation the tank was subject to the first experiment was carried out on a rectangular tank with very low fill ratio and its purpose was to reproduce a previous experiment by reed et al 1998 preliminary comparisons of cfd results versus experimental data were reported by lada et al lada et al laine and our own attempt at matching that experimental data using sph has been reported elsewhere green and peiró 2018 the geometry of the second experiment was a pill shaped tank which is the shape more commonly used in spacecraft fuel tanks with high fill ratios representative of flight again reference lada et al laine presents preliminary comparisons with short cfd simulations which show their ability of matching reasonably well the first sloshing modes and qualitatively capture the amplification trends at low frequencies the purpose of this work is to perform long duration sph simulations on this geometry to compare them with the experimental data of reference lada et al and to discuss their suitability for simulating long duration violent three dimensional sloshing in tanks of complex geometry to achieve this we will first verify the sph formulation by calculating the forces and wave heights of simple geometry tanks under a low frequency high amplitude excitation where an analytical solution for linear sloshing exists a rectangular tank and an upright cylindrical tank next we will numerically evaluate the first natural sloshing frequency and verify the results against values from analytical theory for rectangular upright cylindrical and spherical tanks we will then validate the formulation by comparing the variation of natural frequencies with respect to fill ratio obtained computationally and experimentally for tanks of more complex shapes a pill shaped tank and a torus these cases are highly relevant for the design and optimisation of fuel tanks of irregular shapes for which the prediction of their natural frequencies is a difficult problem finally we will conduct a comparison of the sph simulation against the esa estec experimental data for the pill shaped tank and discuss the suitability of the proposed sph implementation as a tool for evaluating the dominant modes in the forces due to sloshing 2 sph formulation this section describes the basic sph scheme and provides a brief description of the choices of wall boundary condition treatment numerical dissipation and time stepping schemes only the features which are strictly used in this work are described leaving out other available options which form part of the original schemes that have been used for a complete description of the formulation the reader is referred to green and peiró 2018 where a more substantial discussion justifying each of these formulation choices can be found 2 1 governing equations a compressible inviscid flow can be described in lagrangian form as d ρ d t ρ v 1 d u d t 1 ρ p i g d x d t v where d d t is the material derivative ρ is the density of v is the velocity x is the position i is the identity matrix g the external force per unit mass such as gravity p is the pressure which can be obtained by the equation of state here we use tait s equation of state batchelor 1973 to obtain the pressure from density given as 2 p ρ c 0 2 ρ 0 γ ρ ρ 0 γ 1 where γ is the polytropic constant ρ 0 is the reference density and c 0 is a reference speed of sound chosen to correspond to a nominal low mach number for instance ma 0 1 to satisfy the weakly compressible formulation of sph 2 2 sph discretization the fluid domain can be discretized into integration points of equal mass in a lagrangian frame of reference which we refer to as particles doing so the semi discrete sph form of the lagrangian governing equations can be written for a particle a as 3 d ρ a d t ρ a v a m a 4 d v a d t 1 ρ a p a f e f a 5 d x a d t v a 6 p a c 0 2 ρ 0 γ ρ a ρ 0 γ 1 where f e represents all the external forces per unit mass applied such as gravity or the excitation of the fluid domain in a moving frame of reference the right hand side terms m a and f a can be expressed in conservative form see e g violeau 2012 as 7 m a ρ a b v b v a v b a w a b d a 8 f a 1 ρ a b v b p a p b a w a b π a f e where w a b w x a x b h is the sph kernel function and h is its smoothing length a w a b is the spatial gradient of kernel evaluated at the location of particle a and v b m b ρ b is the volume associated to particle b the variables d a and π a represent diffusion terms acting on particle a from the contribution of all neighbouring partles described in the next section for the simulations described here we have selected the quintic wendland kernel wendland 1995 given by 9 w x x h α d h d 2 q 1 1 q 2 4 0 q 2 where q 1 h x x d is the number of dimensions of the problem and the values of the coefficient α d are 7 4 π and 21 16 π in two and three dimensions respectively accordingly the kernel derivative gives 10 w x x h α d h d 1 5 q 1 q 2 3 x x x x 0 q 2 2 3 dissipation dissipation in sph as in most numerical methods has two sources physical diffusion arising from the viscosity of the fluid and numerical dissipation used to stabilise the numerical scheme in the present work only inviscid models were considered and hence only numerical dissipation is of interest the sph discretization is essentially a weighted average of centred difference approximations which suffer from some spurious modes resulting in unphysical oscillations natural disordering of lagrangian particles leads to a noisy density field especially under a high frequency low amplitude oscillation molteni and colagrossi 2009 hence numerical dissipation terms are used to reduce these spurious numerical fluctuations also referred to as checkerboarding modes and stabilise the numerical scheme such dissipative terms can be placed in either the continuity equation 7 the momentum equation 8 or both due to the long duration nature of these sloshing problems green and peiró 2018 the δ sph scheme antuono et al 2010 is selected the δ sph scheme adds a dissipation term d a in the continuity equation 7 that is conservative and is of a fourth order nature antuono et al 2012 hence eliminating the checkerboarding modes the dissipation term is defined as 11 d a 2 δ h c 0 b v b ψ b a x b x a a w a b x b x a 2 with ψ b a of the form 12 ψ b a δ ρ b ρ a 1 2 ρ a c ρ b c x b x a where ρ a c and ρ b c are the corrected density gradients for particles a and b respectively and δ is a tuning coefficient typically taken in the range of 0 1 0 2 in the current work δ 0 1 is set for all the cases following antuono et al 2010 the density gradients in equation 12 are obtained by a sph corrected interpolation randles and libersky 1996 as 13 ρ a c b ρ b ρ a l a a w a b with 14 l a b x b x a a w a b 1 where the symbol denotes a vector cross product this scheme is capable of dissipating the spatial pressure oscillations and keep the conservation of total fluid volume additionally depending on the errors introduced by the solid boundary treatment it is capable of stabilising the sph scheme on its own green and peiró 2018 for this reason we do not need to add dissipation in the momentum equation i e we set π a 0 in equation 8 and thus its possible formulation will not be described here for the sake of the interested reader we will mention that one such popular term is the monaghan artificial viscosity that is described in reference monaghan 1994 2 4 solid boundary condition the solid boundaries treatment is based on the fixed ghost particle formulation of adami et al 2012 where three layers of fixed ghost particles are placed on the outer side of a solid boundary to assure that fluid particles always have a full kernel support a fixed ratio of the smoothing length to particle spacing of h 1 5 δ x is set where δ x is the initial particle spacing this value used throughout this work with no exceptions produced 114 particles within the kernel s support domain in the initial configuration the ghost particles have a constant mass taken to be equal to the initial mass of a fluid particle their pressure is obtained by balancing the force on either side of the solid wall which ensures that the fluid pressure field adjacent to the solid walls remains smooth it reads 15 p w f p f w w f f ρ f g a s x w x f w w f f w w f where the subscripts f and w denote the fluid and the ghost particles respectively g is the gravity vector and a s is the specified wall acceleration i e a s 0 when the wall is assumed fixed accordingly density is obtained from the equation of state 6 as 16 ρ w ρ 0 p w c 0 2 restricting the formulation to inviscid with free slip boundary conditions no velocity terms appear in the momentum conservation equation 8 the velocity of the ghost particles in the continuity equation is simply set to the specified wall velocity which assuming it is fixed is v s 0 for a fuller description of the solid boundary treatment the reader is referred to reference adami et al 2012 2 5 time integration scheme an explicit predictor corrector second order symplectic scheme gómez gesteira et al 2012 was adopted for time stepping symplectic schemes are particularly suitable to this type of work due to their ability to retain geometric properties of the flow of differential equations and being time reversible in inviscid flows the predictor step is given by 17 ρ a n 1 2 ρ a n δ t 2 m a n 18 v a n 1 2 v a n δ t 2 f a n 19 x a n 1 2 x a n δ t 2 v a n and the corrector step is 20 ρ a n 1 ρ a n 2 ε 2 ε ε δ t m a ρ a n 1 2 21 v a n 1 v a n 1 2 δ t 2 f a n 1 2 22 x a n 1 x a n 1 2 δ t 2 v a n 1 the explicit nature of the scheme requires the following stability conditions to be satisfied monaghan and kos 1999 23 δ t f cfl min δ t f δ t c v 24 δ t f min a h f a 25 δ t c v min a h c s max b h v a b x a b x a b 2 η 2 where δ t f depends on the force per unit mass f a and δ t c v is the combination of convective and viscous time step constraints 3 linear sloshing the sph formulation described in section 2 is first verified by comparing simulations of free surface elevation and force exerted by the fluid on the tank with analytical solutions for 3d linear sloshing presented in reference faltinsen and timokha 2009 we consider two tank geometries a rectangular tank and an upright cylindrical tank schematics of the tanks are depicted in fig 1 the rectangular tank has width depth and height of dimensions l x 1 m l y 0 2 m and l z 0 5 m respectively filled with fluid to a height of h w 0 1 m the low filling ratio has been identified in reference green and peiró 2018 to be a particularly challenging shallow water test to highlight the capabilities as well as flaws of the sph scheme it is noted that the flow in this geometry is 2d in nature and the use of a 3d geometry is selected purely for the purpose of validating the 3d implementation on a know test case the dimensions of the cylindrical tank are similarly selected in order to verify the code in a more realistic 3d geometry its geometry consists of a circular base with radius r 0 5 m and height of l z 0 5 m with water filled to a level h w 0 1 m in what follows the fluid is treated as water with density ρ 0 1000 kg m 3 and polytropic constant γ 7 subject to gravitational acceleration in the negative z axis direction of magnitude g 9 81 m s 2 following the analytical solution the fluid is modelled as inviscid 3 1 natural frequencies following reference faltinsen and timokha 2009 the analytically obtained first natural frequency for the rectangular tank in this setup is given by 26 f 1 g 4 π l x tanh π l x h w which gives the first natural frequency as f 1 0 4873 hz the first natural frequency for the circular cylinder is 27 f 1 g ι 1 1 4 π 2 r tanh ι 1 1 r h w where ι 1 1 1 841 is the first root of the derivative of the bessel function of the first mode this gives a first natural frequency for the circular cylinder tank of f 1 0 5679 hz 3 2 numerical simulations in these simulations and all the simulations that follow we employ a non inertial frame of reference attached to the tank so that its motion is modelled through a forced excitation term f x this leads to a forcing term of the form f e f x 0 g in equation 8 additional numerical parameters are the numerical speed of sound chosen as c 0 20 g h w and the cfl number which is set to 0 2 both tanks were subjected to a lateral excitation along the x axis with a frequency set to f w 0 3 f 1 for a duration of two excitation periods 2 t w 2 f w that is 28 f x a sin 2 π f w t 0 t 2 t w where the force excitation amplitude is a 0 5 m s 2 the selected excitation amplitude provides a sizeable water elevation which can be more accurately captured despite stretching the assumptions of linear sloshing whilst the chosen frequency ensures that resonance does not occur we note that the natural frequency of both these cases depends on the ratio of the width of the tank to its filling ratio this ratio was deliberately chosen to be the same in both cases which resulted in an almost identical free surface behaviour this allowed us to comparatively assess the performance of the code in dealing with geometries containing either sharp corners or curved walls here and in the examples that follow we are assuming that particles are initially equally spaced with a distance of δ x in a cartesian lattice a mesh convergence analysis of the spacing between particles required to achieve adequate resolution of the simulations which is described in appendix a led us to select a value h w δ x 20 this discretization produced 147 459 fluid particles out of a total of 437 745 particles for the rectangular tank and 590 007 fluid particles out of a total of 1 022 549 particles for the cylindrical tank the total number of particles includes all the particles generated by the pre processor both fluid and ghost particles including those ghost particles which are not activated i e without fluid neighbours in the simulation wave heights at the left wall and the sloshing forces i e the forces exerted by the fluid onto the container are monitored and post processed the forces are calculated by means of a simplified version of equation 8 where the subscript a corresponds to every boundary particle that makes up the wall and b corresponds to all fluid particles inside the smoothing length of that boundary particle obviously the external acceleration f e is not considered in this case the calculation is performed by the post processing tool measuretool which is part of the dualsphysics solver suite 2 2 a more detailed description of the calculation methodology can be consulted in the document entitled post processing calculations how to numerically compute free surface elevation velocity presure and forces that is distributed with the documentation of the current version of dualsphysics crespo et al 2015 both simulations are consistent with the analytical solution predicting the wave elevation and forces fairly accurately as observed in figs 2 and 3 no large over or under estimates of the recorded quantities were observed and the global sloshing frequencies stayed in phase with the analytical solutions throughout with the fluid domain remaining fairly smooth the simulations however exhibited some degree of over smoothing in the force evaluation compared to the analytical results without specifically capturing the small movement at the local extremal points similarly a local phase shift in the elevation is observed in the same vicinity these discrepancies grow over time and are possibly due to the simulations exhibiting some non linear behaviour that cannot be captured under the linear assumptions of the analytical solution we noted similar observations in 2d as discussed in reference green and peiró 2018 despite that these cases show that the proposed sph scheme proves as capable of simulating linear sloshing in 3d as it is in 2d further these discrepancies exhibit almost identical behaviour in both simulations despite the different geometries this highlights the ability of the solid wall boundary treatment in dealing with curved geometries 4 evaluation of natural sloshing frequency when a tank partially filled with fluid is excited at a frequency close to its natural frequency the sloshing motion resonates with the motion of the tank and the fluid exhibits violent behaviour which produces strong forces on the tank structure itself hence knowing the natural frequency of a partially filled tank allows for designing it in a way that its expected excitation frequencies and natural frequencies will be far apart however for complex three dimensional tank geometries finding their natural frequencies is a non trivial task analytical solutions exist only for simple geometries and experiments can be very time consuming and costly for this reason determining the natural frequencies by means of simulation offers significant advantages and its study deemed as a suitable case for verification and validation of the proposed sph methodology to evaluate the natural frequencies we propose the following computational procedure based on the idea that a fluid in a tank oscillates at its natural frequency unless an external force is acting on the tank this means that if a tank is subject to an initial external excitation that is subsequently withdrawn then after a transitory phase with a high frequency content the fluid will reach a decay phase exhibiting oscillations at the natural frequency in its return to a steady state of rest this can be exploited to devise a simulation to determine the natural sloshing frequency of partially filled tanks the external excitation is applied in a moving frame of reference to avoid the additional complexities associated with a stationary frame of reference with moving solid boundaries to the best of our knowledge there have not been many previous investigations of natural frequencies for the purposes of sph validation one exception is the seminal work of reference souto iglesias et al 2004 but they used forced motion tests instead of decay ones we will verify and validate this method using a set of shapes of varying geometrical complexity firstly we will consider the sloshing on rectangular upright cylindrical and spherical tanks for which analytical expressions of the natural frequencies are available then we will attempt to match the sph simulations to experimental data for more complex shapes a pill shaped tank and a torus 4 1 methodology the natural frequency is determined based on the hydrodynamic force over time which offers smooth and reliable data in these cases and is the only monitored value in these simulations the fluid forces as exerted on the tank walls during the simulation are recorded over the time interval when the frequency of the fluid motion has stabilised the data is analysed by means of the power spectral density psd i e the power content of the signal as a function of the frequencies and these are obtained by fast fourier transform fft psd is an effective method to identify the dominant frequencies in data signals stoica and moses 2005 here we use the matlab fft routine to obtain the psd as described in mathworks 2019 further details of the post processing showing the time histories of the forces on the tank the fft window used to process them and the plots of the psd estimates obtained can be found in appendix b all the analytical values used for the verification tests were obtained via potential flow theory following faltinsen and timokha 2009 where the analytical solutions are described in detail the experimentally obtained values used for the validations tests were found in the references cited in the relevant section 4 2 verification simulations capturing the natural frequency of two tanks of simple shape that have analytical solutions are presented a rectangular and an upright cylindrical tank additionally a spherical tank is also included where an approximate analytical solution exists sketches for all three geometries are depicted in fig 4 the tanks were subjected to a sinusoidal excitation with an excitation amplitude of 0 5 m s 2 and frequency f w 1 5 f 1 where f 1 is the first natural frequency of the respective case the excitation was applied for a duration of two periods i e 2 t w 2 f w after which it was withdrawn to allow the fluid to settle the rectangular tank has width depth and height dimensions of l x 1 m l y 0 2 m and l z 1 5 m respectively with water filled to a depth of h w 1 m using the expression in equation 26 its first natural frequency is f 1 0 8819 hz similarly to the linear sloshing case the flow in the rectangular tank is 2d in nature the use of a 3d geometry is chosen only for validation of the 3d implementation the initial particle spacing in the simulation is chosen to be h w δ x 50 which gives rise to 54 975 particles the simulation exhibited a dominant frequency in hydrodynamic forces from 4 38 s and tracked for a further 38 periods the cylindrical tank has a radius r 0 5 m and height l z 1 2 m and it is filled with water to a depth of h w 1 m which using the expression in equation 27 results in a first natural frequency of f 1 0 9560 hz as in the rectangular tank the initial particle spacing in the simulation is chosen to be h w δ x 50 which gives rise to 142 547 particles the hydrodynamic force was tracked for 35 periods starting at 4 05 s which is the time when the frequency was deemed to be constant the radius of the spherical tank is r 0 5 m and the water depth is h w 0 5 m an exact analytical solution for the first natural frequency does not exist for a sphere so a rigorously validated approximate solution based on numerically solving integral equations reformulated from an eigenvalue problem in a bipolar coordinate system where the tank wall and free surface coincide with the coordinate lines faltinsen and timokha 2009 mciver 1989 can be used instead this results in an approximate first natural mode given by 29 f 1 κ g 2 π where κ 3 125 is the non dimensional eigenvalue for a spheroid as a function of the ratio h w r extracted from reference mciver 1989 this gives a first natural frequency as f 1 0 8812 hz using the same spatial resolution of the rectangular and cylindrical tanks the initial non dimensional particle spacing is h w δ x 25 which gives rise to 66 106 particles the hydrodynamic force was tracked for 31 periods starting at 4 43 s the results for all cases are summarised in table 1 they show an overall good agreement between the simulated and analytical natural frequency values the error reported in the table is calculated as 30 f 1 ana f 1 sim f 1 ana where f 1 ana is the analytical first natural frequency and f 1 sim is the sph simulated first natural frequency obtained by the psd these tests provide good evidence that the proposed methodology is suitable for determining the natural frequency further investigation of the sources of these errors would be desirable but it is beyond the scope of this work 4 3 validation two validation tests are presented where the proposed methodology is used to evaluate the natural sloshing frequencies in more complex 3d geometries namely in a pill shaped and a toroidal shaped tank and the evaluated natural frequencies compared against those obtained via experiments these tests provide an insight into the ability of the code to deal with more general 3d shapes abramson 1966 the toroidal tank experiment was conducted by nasa in 1960 mccarty et al 1960 where extracting the natural frequencies was one of the main research focal points the pill shaped tank case uses the same geometry and fill ratios as the experiment conducted by esa estec lada et al laine this setting allows us to both assess the code s capabilities for simulating the case study of interest as well as independently verify the provided natural frequencies values which were obtained via interpolation of a different experimental source in reference dodge 2000 4 3 1 toroidal tank following the nasa experiment mccarty et al 1960 sloshing in a toroidal tank filled with water to various depths was investigated the tank has an outer radius of r 0 30226 m and inner radius of r 0 14986 m as specified in fig 5 the natural frequencies of the experiment were extracted from fig 6 of reference mccarty et al 1960 and piecewise cubic interpolation in matlab was used to fit a curve for display purposes three filling ratios were selected 25 50 and 75 which have first natural frequencies f 1 values as extracted from the experimental data of 0 3835 0 562 and 0 753 hz respectively to determine the natural frequencies computationally the tank was subjected to a lateral excitation with a forcing amplitude of 0 2 m s 2 and a frequency of f w 1 5 f 1 at each filling ratio the excitation was applied for a duration of two periods 2 f w after which the lateral excitation was withdrawn and the tank remained static and the computation carried out until the fluid motion stopped the initial particle spacing was set to δ x 0 005 m which in non dimensional form gives h w δ x 15 h w δ x 30 and h w δ x 45 for the respective filling ratios which resulted in 185 114 457 448 and 782 625 fluid particles for the filling ratios of 25 50 and 75 respectively and 315 278 boundary particles for all cases frequencies from the simulation were obtained by means of the psd method described in section 4 1 using a whole number of periods after reaching the decay phase of the motion these corresponded to the time intervals 21 37 29 35s 16 88 29 53s and 12 62 22 29s for the filling ratios of 25 50 and 75 respectively these times were carefully chosen due to the rapid decay of the sloshing force in the torodial tank for further information the time histories of the force and the psd plots for all three cases can be consulted in appendix b the first natural frequencies for all fill levels follow the fitted curve from the experiment quite closely as seen in fig 6 and summarised in table 2 the largest error of 3 97 occurs for a 75 filling ratio however the nature of the experimental measurements in which the frequency was captured manually by visual inspection and using a stop watch could play a role in this discrepancy interestingly this was also the only case where the second natural frequency was captured by the simulation producing a value of f 2 sim 1 86 hz compared to the experimental value of f 2 ref 1 874 hz an error of only 0 75 this unexpected result highlights the ability of the code to capture the complex fluid behaviour exhibited by the lower amplitude higher frequency secondary wave motion 4 3 2 pill shaped tank the final natural frequency evaluation tests are performed on the experimental sloshing setup provided by esa estec which is the subject of this paper the experiment was conducted in a pill shaped tank with two different filling levels as described in reference lada et al laine which were chosen to represent realistic filling ratios in space flight conditions the full experimental setup is described in more detail in section 5 here only the tank geometry and the reported natural frequencies for the two filling levels are given the pill shaped tank consists of two half spheres on each end connected by a cylinder of radius r 0 144 m and height h c 0 6 m a schematic of the tank is given in fig 7 the two filling levels tested h w 1 0 2 m and h w 2 0 5 m are reported in reference lada et al laine to have first natural frequencies of 1 77 and 1 78 hz respectively these values were obtained by lada et al lada et al laine by interpolation from experimental data by mikishev and dorozhkin reported in page 47 of reference abramson 1966 in both cases the tank was subjected to an initial lateral excitation with force amplitude of 0 5 m s 2 and a frequency of f w 1 5 f 1 for each filling level for a duration of two periods after the force was withdrawn the simulation was allowed to continue for a total duration of 30s an initial particle spacing of δ x 0 005 m was selected which in non dimensional form gives h w 1 δ x 40 and h w 2 δ x 100 that generated 72 980 and 131 953 fluid particles for h w 1 0 2 m and h w 2 0 5 m respectively and 131 953 boundary particles table 3 shows the comparison between the reference values and those obtained via the psd of the simulated sloshing forces using the proposed sph scheme reasonable agreement is again found between experimental and simulated values with an almost perfect agreement at the lower filling level due to the lack of detail regarding the accuracy of the experimental values we will refrain from overvaluing the quality of the results however a maximum error of 1 85 is very small and gives us some confidence that the method simulates sloshing fairly accurately in this geometry to conclude we have verified and validated the proposed sph methodology by numerically determining the first natural frequency of a variety of tank geometries the verification of the sph method has been carried out using a rectangular an upright cylinder and a spherical tank filled with water to 50 filling ratio and its validation by comparison with experimental data available for a toroidal and a pill shaped tank with a range of filling ratios all the verification results matched the analytical solutions from the literature faltinsen and timokha 2009 with errors in the range of 0 2 to 2 2 the errors in the validation studies were in the range of 0 17 to 3 97 these results are reasonably accurate albeit inconsistent the source of these errors is yet to be understood which is compounded by the limited understanding of the accuracy of experimental values cited for this study further in one specific case of the toroidal tank with a 75 filling ratio the second natural frequency has also been determined therefore sph has proven to be capable of estimating natural frequencies in 3d tanks to a varying degree of accuracy it is however clear that both further experimentation and improvements to the sph methodology will be required to obtain a higher reliability of these estimates 5 application to the esa experiment this experiment conducted by the estec test centre of esa lada et al laine investigates the sloshing behaviour of the fluid close to its natural frequencies and assesses the fluid forces extracted on the pill shaped tank the geometry of which is described in section 4 3 2 for this geometry aside from the second hand quoted experimental values of natural frequencies of reference abramson 1966 the only available guidance to the understanding of this problem is that of the analysis of the similar behaviour of a fluid subject to lateral sloshing in vertical cylinders the first contribution in this area is the seminal work by abramson 1966 also notable is the recent experimental work described in reference royon lebeaud et al 2007 which is also referred to and complemented by theoretical analysis in section 9 3 of reference faltinsen and timokha 2009 according to these references the parameters governing the phenomenon are the fluid viscosity or viscous damping the fluid depth to radius of cylinder ratio and the ratio of oscillation to natural frequencies the experiment was performed for a fixed value of filled height and our model neglects viscosity therefore the only parameter we are concerned with is the ratio of forcing to natural frequencies f ω f i the experiments reported in reference royon lebeaud et al 2007 indicate that taking the lowest natural frequency f 1 as reference a variety of scenarios planar waves swirling waves chaotic sloshing and breaking waves are obtained as the forcing frequency f ω is varied in particular when the forcing frequency is slightly below the first natural frequency the planar wave bifurcates to a swirling wave even though the geometry of the pill shaped tank in the experiment considered here is different due to the presence of a spherical bottom as opposed to a planar one we anticipate a similar behaviour to emerge where the lateral forcing gives rise to asymmetric gravity wave motions in the experiment a pill shaped tank with two different filling levels was laterally excited on a multi axis hydraulic shaker lada et al laine forces were recorded via triaxial force sensors attached to the supporting frame of the tank a video recording of the fluid motion is also available but offers less accurate data for qualitative comparison the forces created by the fluid impinging on the tank are of particular relevance since they can alter the dynamic motion of a vehicle e g a ship lorry or spacecraft carrying the tank a range of frequencies were tested in an increasing sweeping motion dwelling on each for a period of time before sweeping up to the next frequency here only the higher filling level of h w 0 5 is considered in this case frequencies ranging from f w 1 4 hz to f w 2 67 hz over a duration of 11 min and with a maximal displacement value of d 20 mm were considered several frequencies starting at a frequency f w 1 5 hz were dwelt on for a period of 60s each before moving on to the next one in a continuous sweeping as seen in fig 8 the approach used previously to capture the natural frequencies of the fluid motion was deemed inadequate since the sloshing flow did not exhibit any perceptible decaying phase throughout the experiment hence the first 100s of the experiment were simulated in full using the same displacement and frequency data as provided directly from the experimental setup this time period includes the initial buildup of the excitation from rest and the first dwelling frequency the tank sweeps through frequencies ranging from f w 1 4 hz to f w 1 5 hz with an increasing displacement starting from rest and reaching d 20 mm after approximately 28s where it dwells as shown in fig 9 during this period the fluid behaviour transitions from still into violent sloshing exhibiting wave breaks swirling and periods of low motion in between providing an excellent case for assessing the ability of the sph scheme to capture all these different phenomena and validating the code further details of the experimental setup and methodology are given in lada et al laine the simulation was run with a resolution of h w δ x 125 resulting in 459 020 fluid particles due to the more violent nature of the fluid flow the cfl number was set to 0 1 while all other simulation parameters are identical to the verification and validation cases above the simulation required approximately 1 34 10 7 time steps for the 100 simulated seconds and took approximately 123 h to run on a nvidia titan v gpu card fig 10 shows the three cartesian components of the force denoted as f x f y and f z for the full duration of the simulation due to the complexity of the flow and the inherent difficulty in measuring quantities such water heights it is not feasible to establish an exact one to one correspondence however many important features are still captured we note that the forces were not calculated directly in the simulation but obtained by post processing outputs from the simulation using the same process explained in 3 2 the outputs were written at intervals of 0 1s to reduce the number of files saved since the distance between samples of the forces is significantly larger than the computational time step this coarser sampling could be thought of as a form of filtering however we note that no other form of filtering has been applied the first feature is the build up from low sloshing motion into violent sloshing occurring during the increase in the displacement amplitude from approximately 10s 37s during this time interval shown in fig 11 stronger waves are gradually generated in a simple sway motion aligned with the x axis from around 20s when the waves grow larger f z also shows good agreement meanwhile f y shows very little change as the motion was contained in the x z plane with no swirl present the second notable feature and possibly the most significant is the transition from the simple sway motion into breaking waves and the triggering of the swirling motion this transition occurred in both the simulation and experiment in the time interval between 37s and 38s fig 12 shows that at this time f x and f z exhibit a sudden decline in amplitude while f y suddenly grows this sudden increase indicates the triggering of the swirling motion as the flow is no longer contained in the x z plane the frequency of f y is somewhat out of phase but with similar magnitude while f z has the correct frequency but shows a different pattern in the collapse of the amplitude after the transition the component f x is still dominated by the motion of the tank and shows a strong resemblance between the simulation and experiment apart from some slight deviation in the amplitude the simulated force components f y and f z also show a large momentary spike in amplitude around 38s which appears to be numerical in nature and unrelated to the underlying sph methodology employed the issue seems to be restricted to a small number of particles which do not affect the overall behaviour of the fluid only the force calculations in post processing such spikes were not observed in the remainder of the simulation to better visualise this transition snapshots from the experiment and simulation from 36 8 to 37 6 s are shown side by side in fig 13 the wave breaking which triggers the swirling motion is clearly observed these images show a strong resemblance in fluid shape and reinforce the interpretation of the flow phenomena obtained from the force data the typical behaviour observed after the transition into swirling as seen in for instance during the last 20s of the simulation depicted in fig 14 shows however some discrepancies between simulation and experiment the flow is characterised by a violent fluid motion with swirling that frequently switches rotational direction short periods where the fluid exhibits less violent features during the transition are also observed in both the simulation and the video recording of the experiment these flow features are hard to observe in the time histories of the force component but nonetheless some further analysis is provided hereafter the behaviour of the force component f x stays similar as it is driven by the external forcing but the components f y and f z go in and out of phase as the simulation and the experiment take different rotational directions the amplitude of f y is overall similar between the simulation and experiments with the frequencies switching quickly from being synchronised to being in an opposite phase on the other hand the component f z exhibits many peaks and troughs which are assumed to be related to instances of wave build up and break down respectively as the transition in rotational direction takes place while the overall amplitudes of f z are similar the experiment appears to shows slightly more regular sequences of peaks and troughs than the simulation we also note a small under prediction in the simulated values of f x compared to the experiment throughout the simulation this discrepancy however has no discernible effect on the timing of the transition into violent flow the triggering of the swirling motion or the values of the dominant frequencies and it can arguably be considered negligible further investigation is required to elucidate the reason behind this behaviour to better understand this observation we analyse the frequency content of the fluid forces fig 15 compares the computed and experimental psd of for each force component due to the complex temporal dynamics of the sloshing motion and its wide range of frequencies the use a single window for obtaining the psd in the ffts based methodology described in section 4 1 makes it difficult to discriminate between frequencies in the psd instead we employ welch s power spectral density estimate which uses averaged moving and overlapping windows to obtain a smoother psd with more discernible frequency peaks which is easier to interpret we use the intrinsic matlab function mathworks 2020 using the default settings for both the experimental and the simulated force components the frequency spectrum of f x shows an almost perfect agreement of peak frequencies of 1 5 hz which is to be expected as it is the forcing excitation along the x axis a more interesting finding is that f y and f z show very similar frequency content despite the slight discrepancies observed in time histories as seen in figs 10 14 the f y component which corresponds to the forces due to swirling shows the experimental dominant frequency in the range of 1 68 hz 1 719 hz while the dominant frequency range in the simulation is 1 641 hz 1 68 hz interestingly this frequency is much closer to the natural frequency cited as 1 77 hz by reference lada et al laine and obtained numerically as 1 84 hz see section 4 3 2 than to the forcing frequency however investigating this relationship is beyond the scope of this validation test the f z component which corresponds to the vertical slamming of the waves exhibits two dominant peaks a stronger one reading 2 77 hz in the experiment and 2 73 hz in the sph simulation and a second one with a reading of 3 0 hz in both experiment and computation which is exactly twice the forcing frequency as is to be expected due to the vertical motion of the waves since the dominant frequencies of the f y and f z force components are not driven by the external force this strong agreement between simulation and experiment obtained in the frequency domain analysis provides strong evidence of the ability of the proposed sph method to accurately capture the important features of such complex flows however the simulation does show slightly more contribution from the less dominant frequencies than those in the experiment for all three force components this can be inferred from the higher power of the frequencies away from the peaks in the psd analysis shown in fig 15 while these lower power frequencies are of lesser importance a better understanding of this discrepancy is still desired and is left for future work 6 conclusions a carefully curated selection of sph features was shown in green and peiró 2018 to provide a useful tool for modelling liquid sloshing in simple rectangular tanks these include a fixed ghost particle solid boundary treatment the use of the δ sph scheme and the capability to run on a gpu in this work the same set of features was used to demonstrate the ability of the sph methodology to simulate more challenging sloshing phenomena in complex 3d geometries this was shown in particular by replicating an experiment conducted by esa estec of long duration sloshing in a pill shaped tank a study of extracting the natural sloshing frequencies in various tank geometries was conducted as a means of verifying and validating the sph code a good agreement with the values obtained analytically and experimentally was found including the second mode in the case of the toroidal tank with a high filling ratio this study is itself of great interest as the ability to accurately determine the natural sloshing frequencies in arbitrary tank geometries is fundamental to the design of any partially filled container following the verification and validation of the code a reproduction of the pill shaped tank sloshing experiment conducted the estec test centre of esa was attempted in the experiment a partially filled pill shaped tank underwent lateral excitation in the x axis direction starting from rest the amplitude and frequency increased over time until it dwelt on a specified setting for some duration albeit without reaching a steady state the fluid inside the tank started with purely sway motion until such a time when swirling motion was triggered from that point the flow exhibited rapid changes in the amplitude of the waves and the rotational direction of the swirls force components in the x y and z axis were recorded along with a video of the fluid two significant observations from the simulation were made the first is the capture of the moment when the swirling wave motion was triggered both the forces and the shape of the free surface showed a strong resemblance between the experiment and simulation at that critical moment the other is a strong agreement in the spectral power density of the frequency domain particularly at the peak frequencies while this was expected for the x axis direction which corresponds to the direction of the excitation it was also observed in the y and z axis components which correspond to the swirling motion and wave elevation respectively the agreement is found despite noticeable differences in their time histories this data shows the ability of the proposed sph scheme to accurately obtain the critical information of the sloshing motion and the impact of the forces on the tank credit authorship contribution statement mashy d green software simulations methodology verification and validation writing original draft visualization writing review editing final manuscript preparation yipeng zhou simulations verification and validation visualization writing review editing josé m dominguez software writing review editing moncho g gesteira supervision writing review editing joaquim peiró supervision methodology writing review editing final manuscript preparation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements we would like to express our gratitude to dr josé longo andrea passaro and chiara lada of esa estec for their advice on sloshing phenomena for making the experimental data on the pill shaped tank available to us for helping us with their interpretation and for granting us permission to publish it appendix a mesh convergence analysis this appendix presents a spatial resolution or mesh convergence study for the linear sloshing of a cylindrical tank problem described in section 3 the mesh convergence study is performed with a fixed kernel support to particle spacing ratio h δ x as a result the truncation error of the integral of the kernel support is the dominant error quinlan et al 2006 and leads to a lower convergence rate on the other hand the method consistently decreases the smoothing error with increased resolution the choice of a fixed kernel support ratio ensures a full kernel support in our treatment of the wall boundary conditions green and peiró 2018 the dimensions of the tank are the same but here the tank is filled with water to a level h w 0 5 m rather than the filling level h w 0 1 m used for the validation test in section 3 we do this purely for display purposes since using a higher value of the water elevation permits a better visual comparison of the computed and the analytical water displacement particularly at lower resolutions following equation 27 the first natural frequency now is f 1 0 9328 hz the tank undergoes forced sinusoidal excitation in the x axis direction with a forcing frequency f w 0 3 f 1 0 2798 hz and a displacement amplitude a 0 3 m this displacement amplitude gives rise to a forcing amplitude a f a 2 π f w 2 0 9275 the particle spacing is varied according to h w δ x 25 2 n for n 0 1 2 3 the error is calculated as the l 2 norm of the difference between the computed and the analytical solution of the sloshing model taken from reference faltinsen and timokha 2009 the accumulated error was evaluated by integrating the analytical and computed forces over a full sloshing period t 3 57 s the force time histories depicted in figure a 1 a clearly indicate the computed forces are getting closer to the reference solution as the mesh resolution increases the calculated rate of convergence coc is defined as coc log ε n ε n 1 log 2 where ε n is the accumulated error of case n figure a 1 b shows that the convergence rate gradually reduces from 0 7145 to 0 588 there are clear signs of convergence as the accumulated error decreases although the value of the coc is lower than 1 and it decreases with n which is expected in such cases this convergence rate is also significantly higher than that found for the 2d cases presented in green and peiró 2018 fig a 1 mesh convergence analysis a force histories for different mesh resolutions and comparison with the analytical solution b accumulated error versus mesh resolution on a log scale and calculated rate of convergence coc fig a 1 appendix b natural frequency data this appendix describes how to extract the sloshing natural frequencies from time histories of the forces acting on the tank using the periodogram this is a nonparametric power spectral density psd estimate obtained by discrete sampling the time history using a fast fourier transform fft the examples shown in this appendix use the matlab implementation mathworks 2019 the main assumption of the procedure is that after the tank has been subject to an initial excitation the fluid settles into a decaying phase where the fluid oscillates with a few ideally one or two dominant natural frequencies the simulation is run until such a decaying phase is reached the time history of the forces is then visually inspected to select a time frame or window within the decaying phase region where the natural frequencies are present in multiples of full periods the fft routine is then run on an exact number of sloshing periods to identify the dominant frequencies it should be noted that this approach is viable because of the small number of frequencies present in the time history of the force and that the correct selection of the window is of paramount importance towards obtaining the correct set of frequencies examples of the application of the process to the rectangular cylindrical and spherical tanks are depicted in figure b 2 that shows the windows used for sampling the time history of the forces and compares the analytical and computed values of the natural frequencies figure b 3 shows similar results for the simulation of sloshing in a toroidal tank at filling ratios of 25 50 and 75 here it is worth observing the presence of a second natural frequency at the filling ratio of 75 consistent with the qualitative and quantitative experimental observations finally figure b 4 further illustrates the procedure and the good agreement of computed and experimental natural frequencies for the sloshing in a pill tank with filling heights of 0 2 and 0 5 m we end this appendix with a clarification in the application to the esa experiment in section 5 the psd estimates used the alternative welch s method mathworks 2020 and the full duration of the simulation from 0 1s to 100s for the calculation of the periodogram the reason for this is that our objective was to calculate the frequency spectrum of a long duration transient signal not the dominant frequencies of the decaying phase and welch s method is better suited for such purpose fig b 2 time histories of the force on the tank for the full duration of the simulation a rectangular c cylindrical and e spherical the time period between the dashed red lines represent the duration over which the power spectral density psd mathworks 2019 is estimated the psd estimates for the respective tank geometries are depicted in figures b d and f fig b 2 fig b 3 force time histories of the full duration of the simulation for the toroidal tank at filling ratios of a 25 c 50 and e 75 the time period between the dashed red lines represent the duration over which the power spectral density psd mathworks 2019 is estimated the psd estimates for the respective filling ratios are depicted in figures b d and f fig b 3 fig b 4 force time histories of the full duration of the simulation for the pill tank at filling heights of a 0 2m and c 0 5m the time period between the dashed red lines represent the duration over which the power spectral density psd mathworks 2019 is estimated the psd estimates for the respective filling heights are depicted in figures figures b and d fig b 4 
20802,we present a smooth particle hydrodynamics sph formulation that captures the sloshing frequencies of tanks and accurately simulates long duration violent sloshing in partially filled tanks of arbitrary shape the sph simulations are performed using a modified version of the open source code dualsphysics that incorporates a density based stabilization δ sph and imposes wall boundary conditions via ghost particles in order to achieve pressure fields without spurious spatial oscillations and to reduce non physical energy dissipation we verify the sph scheme by showing that calculated sloshing wave heights forces and natural sloshing frequencies of tanks of simple shapes namely rectangular cylindrical upright and spherical match the analytical values given by the potential theory in the linear regime the scheme is then validated by predicting the sloshing frequencies obtained experimentally in a toroidal tank and in a pill shaped tank finally we present a study of a pill shaped tank subject to a long period of external forcing comparing simulated sloshing forces to experimental values obtained by esa estac the simulation is shown to fairly accurately reproduce the sloshing forces and predict the transition to swirling wave motion analysis of the frequency range further showed good agreement of the dominant frequencies between the experimental and simulated forces keywords smooth particle hydrodynamics sph dualsphysics non linear sloshing natural sloshing frequency general tank geometries verification and validation 1 introduction prediction of the forces caused by the motion of a liquid within a moving tank known as sloshing is of fundamental importance for the design and operation of vehicles carrying these tanks coupling of the modes of motion of the liquid and the vehicle could adversely affect the stability of the trajectory of the vehicle and its control further if the forces generated during sloshing are significant the structural integrity of the tank could also be detrimentally affected examples of the relevance of sloshing in various engineering fields can be consulted in the textbook by faltinsen and timokha 2009 however sloshing is a complex dynamic phenomenon that exhibits free surfaces and if several phases are present moving interfaces analytical methods exist and are extensively discussed in classical treatises abramson 1966 dodge 2000 and in textbooks ibrahim 2005 faltinsen and timokha 2009 these are mostly based on linear theories and are thus limited in scope experiments whenever feasible provide physical fidelity but at considerable cost and tend to be used sparsely lacapere et al 2009 souto iglesias et al 2011 on the other hand verified and validated computational fluid dynamics cfd tools offer the possibility to accurately predict slosh dynamics with a view to reducing its negative impact on vehicle performance and also to eventually simulate situations e g micro gravity effects which are beyond the reach of ground based experimental facilities abramson 1966 snyder 1999 one of the main problems to tackle in the cfd simulation of fluid sloshing is that of numerically modelling moving free surfaces and interfaces broadly speaking there are two groups of such modelling techniques particle based or meshless and mesh based in particle based methods such as sph monaghan 2012 or moving least squares trask et al 2016 the discretization is attached to particles which are advected with the flow and the description of the interfaces no matter how complicated is the result of their motion the interested reader could consult reference gotoh and khayyer 2018 for a review of the use of particle methods in modelling for coastal and ocean engineering on the other hand in mesh based methods the interface is approximated on a mesh that is either fixed eulerian approach or advecting with the flow lagrangian approach in this last case large motions of the interface might lead to severe mesh distortions that in turn could result in numerical inaccuracies and instabilities even though mixed methods such the arbitrary lagrangian eulerian or ale technique that attempt to get the best qualities of both approaches have also been proposed braess and wriggers 2000 the most popular approach is to track the interface as it travels across a fixed mesh using the volume of fluid vof method hirt and nichols 1981 with piecewise linear interface calculation plic rider and kothe 1998 this approach is used in several commercial and academic cfd codes 1 1 for instance commercial codes such as flow 3d https www flow3d com ansys fluent https www ansys com converge https convergecfd com and siemens star ccm https www plm automation siemens com and open source codes such as gerris http gfs sourceforge net and openfoam https www openfoam com websites accessed 10 august 2020 an alternative representation of the interface on a fixed mesh is as a level set osher and sethian 1988 for instance such an approach has been used for modelling sloshing in references bai et al 2015 bihs et al 2016 sph is a popular particle based method for modelling free surface problems such as sloshing due its lagrangian nature it is able to represent sharp interfaces without the need for high order advection schemes or explicit interface reconstruction discontinuities can develop naturally from the movement of the particles and in the weakly compressible sph formulation there is no need to impose boundary conditions at the free surface colagrossi et al 2009 sph is able to handle complex phenomena such as liquid break up and complex geometries and it has been successfully used to simulate violent sloshing the basis evolution and recent progress of sph and its various applications can be consulted in a few past and recent review articles liu and liu 2010 monaghan 2012 violeau and rogers 2016 ye et al 2019 lind et al 2020 focusing on the application of sph to problems of interest in ocean engineering sph was used in simulations of passive anti roll tanks by comparing computed and experimental values of the phase lag for the roll moment for different fillings and roll amplitudes souto iglesias et al 2004 reference colagrossi et al validated sph models against an experimental setup of a rigid body rectangular tank and pure sway motion these were followed by sph analyses of sloshing loads in carriers tankers delorme and souto iglesias a rectangular tank in rolling motion delorme and souto iglesias and tuned liquid dampers bulian et al 2010 as well as studies of the violent sloshing phenomenon khayyer and gotoh 2009 colagrossi et al 2010 an overview of the state of the art up to 2010 in modelling sloshing using sph is given in reference gómez gesteira et al 2010 a set of experimental tests specifically selected for the validation of the sph methodology was proposed in reference souto iglesias et al 2011 the sph methodology has been applied to the simulation of liquid sloshing in tanks vorobyev et al 2011 in tanks with obstacles inside rafiee et al 2011 and in tanks with baffles of various degrees of complexity bai et al 2013 zheng et al 2018 further instances of modelling of sloshing via sph worth mentioning are the analysis of shallow depth sloshing for sway bouscasse et al 2013 the simulation of sloshing seakeeping coupling problems serván camas et al 2016 and the incorporation of fluid structure interaction concerns such as these resulting from roll motion and pressure impact in a tank bulian and cercos pita 2018 or from the interaction of sloshing and external waves for a damaged ship cao et al 2019 a more detailed review of sph for the simulation wave breaking and sloshing can be consulted in section 8 3 1 of the recent article by r a ibrahim 2020 here we aim to undertake a comparison of sph simulations with experimental sloshing data gathered by the estec test centre of esa on a test campaign using their hydraulic powered shaker table with the objective of providing reference data on surface elevations and forces for cfd code validation this campaign is briefly described in reference lada et al and involved two sloshing experiments on partially filled tanks subject to large amplitude horizontal excitation the main distinctive features of the experiments were the presence of strong nonlinear free surface phenomena and unlike previously reported experiments the long duration of the excitation the tank was subject to the first experiment was carried out on a rectangular tank with very low fill ratio and its purpose was to reproduce a previous experiment by reed et al 1998 preliminary comparisons of cfd results versus experimental data were reported by lada et al lada et al laine and our own attempt at matching that experimental data using sph has been reported elsewhere green and peiró 2018 the geometry of the second experiment was a pill shaped tank which is the shape more commonly used in spacecraft fuel tanks with high fill ratios representative of flight again reference lada et al laine presents preliminary comparisons with short cfd simulations which show their ability of matching reasonably well the first sloshing modes and qualitatively capture the amplification trends at low frequencies the purpose of this work is to perform long duration sph simulations on this geometry to compare them with the experimental data of reference lada et al and to discuss their suitability for simulating long duration violent three dimensional sloshing in tanks of complex geometry to achieve this we will first verify the sph formulation by calculating the forces and wave heights of simple geometry tanks under a low frequency high amplitude excitation where an analytical solution for linear sloshing exists a rectangular tank and an upright cylindrical tank next we will numerically evaluate the first natural sloshing frequency and verify the results against values from analytical theory for rectangular upright cylindrical and spherical tanks we will then validate the formulation by comparing the variation of natural frequencies with respect to fill ratio obtained computationally and experimentally for tanks of more complex shapes a pill shaped tank and a torus these cases are highly relevant for the design and optimisation of fuel tanks of irregular shapes for which the prediction of their natural frequencies is a difficult problem finally we will conduct a comparison of the sph simulation against the esa estec experimental data for the pill shaped tank and discuss the suitability of the proposed sph implementation as a tool for evaluating the dominant modes in the forces due to sloshing 2 sph formulation this section describes the basic sph scheme and provides a brief description of the choices of wall boundary condition treatment numerical dissipation and time stepping schemes only the features which are strictly used in this work are described leaving out other available options which form part of the original schemes that have been used for a complete description of the formulation the reader is referred to green and peiró 2018 where a more substantial discussion justifying each of these formulation choices can be found 2 1 governing equations a compressible inviscid flow can be described in lagrangian form as d ρ d t ρ v 1 d u d t 1 ρ p i g d x d t v where d d t is the material derivative ρ is the density of v is the velocity x is the position i is the identity matrix g the external force per unit mass such as gravity p is the pressure which can be obtained by the equation of state here we use tait s equation of state batchelor 1973 to obtain the pressure from density given as 2 p ρ c 0 2 ρ 0 γ ρ ρ 0 γ 1 where γ is the polytropic constant ρ 0 is the reference density and c 0 is a reference speed of sound chosen to correspond to a nominal low mach number for instance ma 0 1 to satisfy the weakly compressible formulation of sph 2 2 sph discretization the fluid domain can be discretized into integration points of equal mass in a lagrangian frame of reference which we refer to as particles doing so the semi discrete sph form of the lagrangian governing equations can be written for a particle a as 3 d ρ a d t ρ a v a m a 4 d v a d t 1 ρ a p a f e f a 5 d x a d t v a 6 p a c 0 2 ρ 0 γ ρ a ρ 0 γ 1 where f e represents all the external forces per unit mass applied such as gravity or the excitation of the fluid domain in a moving frame of reference the right hand side terms m a and f a can be expressed in conservative form see e g violeau 2012 as 7 m a ρ a b v b v a v b a w a b d a 8 f a 1 ρ a b v b p a p b a w a b π a f e where w a b w x a x b h is the sph kernel function and h is its smoothing length a w a b is the spatial gradient of kernel evaluated at the location of particle a and v b m b ρ b is the volume associated to particle b the variables d a and π a represent diffusion terms acting on particle a from the contribution of all neighbouring partles described in the next section for the simulations described here we have selected the quintic wendland kernel wendland 1995 given by 9 w x x h α d h d 2 q 1 1 q 2 4 0 q 2 where q 1 h x x d is the number of dimensions of the problem and the values of the coefficient α d are 7 4 π and 21 16 π in two and three dimensions respectively accordingly the kernel derivative gives 10 w x x h α d h d 1 5 q 1 q 2 3 x x x x 0 q 2 2 3 dissipation dissipation in sph as in most numerical methods has two sources physical diffusion arising from the viscosity of the fluid and numerical dissipation used to stabilise the numerical scheme in the present work only inviscid models were considered and hence only numerical dissipation is of interest the sph discretization is essentially a weighted average of centred difference approximations which suffer from some spurious modes resulting in unphysical oscillations natural disordering of lagrangian particles leads to a noisy density field especially under a high frequency low amplitude oscillation molteni and colagrossi 2009 hence numerical dissipation terms are used to reduce these spurious numerical fluctuations also referred to as checkerboarding modes and stabilise the numerical scheme such dissipative terms can be placed in either the continuity equation 7 the momentum equation 8 or both due to the long duration nature of these sloshing problems green and peiró 2018 the δ sph scheme antuono et al 2010 is selected the δ sph scheme adds a dissipation term d a in the continuity equation 7 that is conservative and is of a fourth order nature antuono et al 2012 hence eliminating the checkerboarding modes the dissipation term is defined as 11 d a 2 δ h c 0 b v b ψ b a x b x a a w a b x b x a 2 with ψ b a of the form 12 ψ b a δ ρ b ρ a 1 2 ρ a c ρ b c x b x a where ρ a c and ρ b c are the corrected density gradients for particles a and b respectively and δ is a tuning coefficient typically taken in the range of 0 1 0 2 in the current work δ 0 1 is set for all the cases following antuono et al 2010 the density gradients in equation 12 are obtained by a sph corrected interpolation randles and libersky 1996 as 13 ρ a c b ρ b ρ a l a a w a b with 14 l a b x b x a a w a b 1 where the symbol denotes a vector cross product this scheme is capable of dissipating the spatial pressure oscillations and keep the conservation of total fluid volume additionally depending on the errors introduced by the solid boundary treatment it is capable of stabilising the sph scheme on its own green and peiró 2018 for this reason we do not need to add dissipation in the momentum equation i e we set π a 0 in equation 8 and thus its possible formulation will not be described here for the sake of the interested reader we will mention that one such popular term is the monaghan artificial viscosity that is described in reference monaghan 1994 2 4 solid boundary condition the solid boundaries treatment is based on the fixed ghost particle formulation of adami et al 2012 where three layers of fixed ghost particles are placed on the outer side of a solid boundary to assure that fluid particles always have a full kernel support a fixed ratio of the smoothing length to particle spacing of h 1 5 δ x is set where δ x is the initial particle spacing this value used throughout this work with no exceptions produced 114 particles within the kernel s support domain in the initial configuration the ghost particles have a constant mass taken to be equal to the initial mass of a fluid particle their pressure is obtained by balancing the force on either side of the solid wall which ensures that the fluid pressure field adjacent to the solid walls remains smooth it reads 15 p w f p f w w f f ρ f g a s x w x f w w f f w w f where the subscripts f and w denote the fluid and the ghost particles respectively g is the gravity vector and a s is the specified wall acceleration i e a s 0 when the wall is assumed fixed accordingly density is obtained from the equation of state 6 as 16 ρ w ρ 0 p w c 0 2 restricting the formulation to inviscid with free slip boundary conditions no velocity terms appear in the momentum conservation equation 8 the velocity of the ghost particles in the continuity equation is simply set to the specified wall velocity which assuming it is fixed is v s 0 for a fuller description of the solid boundary treatment the reader is referred to reference adami et al 2012 2 5 time integration scheme an explicit predictor corrector second order symplectic scheme gómez gesteira et al 2012 was adopted for time stepping symplectic schemes are particularly suitable to this type of work due to their ability to retain geometric properties of the flow of differential equations and being time reversible in inviscid flows the predictor step is given by 17 ρ a n 1 2 ρ a n δ t 2 m a n 18 v a n 1 2 v a n δ t 2 f a n 19 x a n 1 2 x a n δ t 2 v a n and the corrector step is 20 ρ a n 1 ρ a n 2 ε 2 ε ε δ t m a ρ a n 1 2 21 v a n 1 v a n 1 2 δ t 2 f a n 1 2 22 x a n 1 x a n 1 2 δ t 2 v a n 1 the explicit nature of the scheme requires the following stability conditions to be satisfied monaghan and kos 1999 23 δ t f cfl min δ t f δ t c v 24 δ t f min a h f a 25 δ t c v min a h c s max b h v a b x a b x a b 2 η 2 where δ t f depends on the force per unit mass f a and δ t c v is the combination of convective and viscous time step constraints 3 linear sloshing the sph formulation described in section 2 is first verified by comparing simulations of free surface elevation and force exerted by the fluid on the tank with analytical solutions for 3d linear sloshing presented in reference faltinsen and timokha 2009 we consider two tank geometries a rectangular tank and an upright cylindrical tank schematics of the tanks are depicted in fig 1 the rectangular tank has width depth and height of dimensions l x 1 m l y 0 2 m and l z 0 5 m respectively filled with fluid to a height of h w 0 1 m the low filling ratio has been identified in reference green and peiró 2018 to be a particularly challenging shallow water test to highlight the capabilities as well as flaws of the sph scheme it is noted that the flow in this geometry is 2d in nature and the use of a 3d geometry is selected purely for the purpose of validating the 3d implementation on a know test case the dimensions of the cylindrical tank are similarly selected in order to verify the code in a more realistic 3d geometry its geometry consists of a circular base with radius r 0 5 m and height of l z 0 5 m with water filled to a level h w 0 1 m in what follows the fluid is treated as water with density ρ 0 1000 kg m 3 and polytropic constant γ 7 subject to gravitational acceleration in the negative z axis direction of magnitude g 9 81 m s 2 following the analytical solution the fluid is modelled as inviscid 3 1 natural frequencies following reference faltinsen and timokha 2009 the analytically obtained first natural frequency for the rectangular tank in this setup is given by 26 f 1 g 4 π l x tanh π l x h w which gives the first natural frequency as f 1 0 4873 hz the first natural frequency for the circular cylinder is 27 f 1 g ι 1 1 4 π 2 r tanh ι 1 1 r h w where ι 1 1 1 841 is the first root of the derivative of the bessel function of the first mode this gives a first natural frequency for the circular cylinder tank of f 1 0 5679 hz 3 2 numerical simulations in these simulations and all the simulations that follow we employ a non inertial frame of reference attached to the tank so that its motion is modelled through a forced excitation term f x this leads to a forcing term of the form f e f x 0 g in equation 8 additional numerical parameters are the numerical speed of sound chosen as c 0 20 g h w and the cfl number which is set to 0 2 both tanks were subjected to a lateral excitation along the x axis with a frequency set to f w 0 3 f 1 for a duration of two excitation periods 2 t w 2 f w that is 28 f x a sin 2 π f w t 0 t 2 t w where the force excitation amplitude is a 0 5 m s 2 the selected excitation amplitude provides a sizeable water elevation which can be more accurately captured despite stretching the assumptions of linear sloshing whilst the chosen frequency ensures that resonance does not occur we note that the natural frequency of both these cases depends on the ratio of the width of the tank to its filling ratio this ratio was deliberately chosen to be the same in both cases which resulted in an almost identical free surface behaviour this allowed us to comparatively assess the performance of the code in dealing with geometries containing either sharp corners or curved walls here and in the examples that follow we are assuming that particles are initially equally spaced with a distance of δ x in a cartesian lattice a mesh convergence analysis of the spacing between particles required to achieve adequate resolution of the simulations which is described in appendix a led us to select a value h w δ x 20 this discretization produced 147 459 fluid particles out of a total of 437 745 particles for the rectangular tank and 590 007 fluid particles out of a total of 1 022 549 particles for the cylindrical tank the total number of particles includes all the particles generated by the pre processor both fluid and ghost particles including those ghost particles which are not activated i e without fluid neighbours in the simulation wave heights at the left wall and the sloshing forces i e the forces exerted by the fluid onto the container are monitored and post processed the forces are calculated by means of a simplified version of equation 8 where the subscript a corresponds to every boundary particle that makes up the wall and b corresponds to all fluid particles inside the smoothing length of that boundary particle obviously the external acceleration f e is not considered in this case the calculation is performed by the post processing tool measuretool which is part of the dualsphysics solver suite 2 2 a more detailed description of the calculation methodology can be consulted in the document entitled post processing calculations how to numerically compute free surface elevation velocity presure and forces that is distributed with the documentation of the current version of dualsphysics crespo et al 2015 both simulations are consistent with the analytical solution predicting the wave elevation and forces fairly accurately as observed in figs 2 and 3 no large over or under estimates of the recorded quantities were observed and the global sloshing frequencies stayed in phase with the analytical solutions throughout with the fluid domain remaining fairly smooth the simulations however exhibited some degree of over smoothing in the force evaluation compared to the analytical results without specifically capturing the small movement at the local extremal points similarly a local phase shift in the elevation is observed in the same vicinity these discrepancies grow over time and are possibly due to the simulations exhibiting some non linear behaviour that cannot be captured under the linear assumptions of the analytical solution we noted similar observations in 2d as discussed in reference green and peiró 2018 despite that these cases show that the proposed sph scheme proves as capable of simulating linear sloshing in 3d as it is in 2d further these discrepancies exhibit almost identical behaviour in both simulations despite the different geometries this highlights the ability of the solid wall boundary treatment in dealing with curved geometries 4 evaluation of natural sloshing frequency when a tank partially filled with fluid is excited at a frequency close to its natural frequency the sloshing motion resonates with the motion of the tank and the fluid exhibits violent behaviour which produces strong forces on the tank structure itself hence knowing the natural frequency of a partially filled tank allows for designing it in a way that its expected excitation frequencies and natural frequencies will be far apart however for complex three dimensional tank geometries finding their natural frequencies is a non trivial task analytical solutions exist only for simple geometries and experiments can be very time consuming and costly for this reason determining the natural frequencies by means of simulation offers significant advantages and its study deemed as a suitable case for verification and validation of the proposed sph methodology to evaluate the natural frequencies we propose the following computational procedure based on the idea that a fluid in a tank oscillates at its natural frequency unless an external force is acting on the tank this means that if a tank is subject to an initial external excitation that is subsequently withdrawn then after a transitory phase with a high frequency content the fluid will reach a decay phase exhibiting oscillations at the natural frequency in its return to a steady state of rest this can be exploited to devise a simulation to determine the natural sloshing frequency of partially filled tanks the external excitation is applied in a moving frame of reference to avoid the additional complexities associated with a stationary frame of reference with moving solid boundaries to the best of our knowledge there have not been many previous investigations of natural frequencies for the purposes of sph validation one exception is the seminal work of reference souto iglesias et al 2004 but they used forced motion tests instead of decay ones we will verify and validate this method using a set of shapes of varying geometrical complexity firstly we will consider the sloshing on rectangular upright cylindrical and spherical tanks for which analytical expressions of the natural frequencies are available then we will attempt to match the sph simulations to experimental data for more complex shapes a pill shaped tank and a torus 4 1 methodology the natural frequency is determined based on the hydrodynamic force over time which offers smooth and reliable data in these cases and is the only monitored value in these simulations the fluid forces as exerted on the tank walls during the simulation are recorded over the time interval when the frequency of the fluid motion has stabilised the data is analysed by means of the power spectral density psd i e the power content of the signal as a function of the frequencies and these are obtained by fast fourier transform fft psd is an effective method to identify the dominant frequencies in data signals stoica and moses 2005 here we use the matlab fft routine to obtain the psd as described in mathworks 2019 further details of the post processing showing the time histories of the forces on the tank the fft window used to process them and the plots of the psd estimates obtained can be found in appendix b all the analytical values used for the verification tests were obtained via potential flow theory following faltinsen and timokha 2009 where the analytical solutions are described in detail the experimentally obtained values used for the validations tests were found in the references cited in the relevant section 4 2 verification simulations capturing the natural frequency of two tanks of simple shape that have analytical solutions are presented a rectangular and an upright cylindrical tank additionally a spherical tank is also included where an approximate analytical solution exists sketches for all three geometries are depicted in fig 4 the tanks were subjected to a sinusoidal excitation with an excitation amplitude of 0 5 m s 2 and frequency f w 1 5 f 1 where f 1 is the first natural frequency of the respective case the excitation was applied for a duration of two periods i e 2 t w 2 f w after which it was withdrawn to allow the fluid to settle the rectangular tank has width depth and height dimensions of l x 1 m l y 0 2 m and l z 1 5 m respectively with water filled to a depth of h w 1 m using the expression in equation 26 its first natural frequency is f 1 0 8819 hz similarly to the linear sloshing case the flow in the rectangular tank is 2d in nature the use of a 3d geometry is chosen only for validation of the 3d implementation the initial particle spacing in the simulation is chosen to be h w δ x 50 which gives rise to 54 975 particles the simulation exhibited a dominant frequency in hydrodynamic forces from 4 38 s and tracked for a further 38 periods the cylindrical tank has a radius r 0 5 m and height l z 1 2 m and it is filled with water to a depth of h w 1 m which using the expression in equation 27 results in a first natural frequency of f 1 0 9560 hz as in the rectangular tank the initial particle spacing in the simulation is chosen to be h w δ x 50 which gives rise to 142 547 particles the hydrodynamic force was tracked for 35 periods starting at 4 05 s which is the time when the frequency was deemed to be constant the radius of the spherical tank is r 0 5 m and the water depth is h w 0 5 m an exact analytical solution for the first natural frequency does not exist for a sphere so a rigorously validated approximate solution based on numerically solving integral equations reformulated from an eigenvalue problem in a bipolar coordinate system where the tank wall and free surface coincide with the coordinate lines faltinsen and timokha 2009 mciver 1989 can be used instead this results in an approximate first natural mode given by 29 f 1 κ g 2 π where κ 3 125 is the non dimensional eigenvalue for a spheroid as a function of the ratio h w r extracted from reference mciver 1989 this gives a first natural frequency as f 1 0 8812 hz using the same spatial resolution of the rectangular and cylindrical tanks the initial non dimensional particle spacing is h w δ x 25 which gives rise to 66 106 particles the hydrodynamic force was tracked for 31 periods starting at 4 43 s the results for all cases are summarised in table 1 they show an overall good agreement between the simulated and analytical natural frequency values the error reported in the table is calculated as 30 f 1 ana f 1 sim f 1 ana where f 1 ana is the analytical first natural frequency and f 1 sim is the sph simulated first natural frequency obtained by the psd these tests provide good evidence that the proposed methodology is suitable for determining the natural frequency further investigation of the sources of these errors would be desirable but it is beyond the scope of this work 4 3 validation two validation tests are presented where the proposed methodology is used to evaluate the natural sloshing frequencies in more complex 3d geometries namely in a pill shaped and a toroidal shaped tank and the evaluated natural frequencies compared against those obtained via experiments these tests provide an insight into the ability of the code to deal with more general 3d shapes abramson 1966 the toroidal tank experiment was conducted by nasa in 1960 mccarty et al 1960 where extracting the natural frequencies was one of the main research focal points the pill shaped tank case uses the same geometry and fill ratios as the experiment conducted by esa estec lada et al laine this setting allows us to both assess the code s capabilities for simulating the case study of interest as well as independently verify the provided natural frequencies values which were obtained via interpolation of a different experimental source in reference dodge 2000 4 3 1 toroidal tank following the nasa experiment mccarty et al 1960 sloshing in a toroidal tank filled with water to various depths was investigated the tank has an outer radius of r 0 30226 m and inner radius of r 0 14986 m as specified in fig 5 the natural frequencies of the experiment were extracted from fig 6 of reference mccarty et al 1960 and piecewise cubic interpolation in matlab was used to fit a curve for display purposes three filling ratios were selected 25 50 and 75 which have first natural frequencies f 1 values as extracted from the experimental data of 0 3835 0 562 and 0 753 hz respectively to determine the natural frequencies computationally the tank was subjected to a lateral excitation with a forcing amplitude of 0 2 m s 2 and a frequency of f w 1 5 f 1 at each filling ratio the excitation was applied for a duration of two periods 2 f w after which the lateral excitation was withdrawn and the tank remained static and the computation carried out until the fluid motion stopped the initial particle spacing was set to δ x 0 005 m which in non dimensional form gives h w δ x 15 h w δ x 30 and h w δ x 45 for the respective filling ratios which resulted in 185 114 457 448 and 782 625 fluid particles for the filling ratios of 25 50 and 75 respectively and 315 278 boundary particles for all cases frequencies from the simulation were obtained by means of the psd method described in section 4 1 using a whole number of periods after reaching the decay phase of the motion these corresponded to the time intervals 21 37 29 35s 16 88 29 53s and 12 62 22 29s for the filling ratios of 25 50 and 75 respectively these times were carefully chosen due to the rapid decay of the sloshing force in the torodial tank for further information the time histories of the force and the psd plots for all three cases can be consulted in appendix b the first natural frequencies for all fill levels follow the fitted curve from the experiment quite closely as seen in fig 6 and summarised in table 2 the largest error of 3 97 occurs for a 75 filling ratio however the nature of the experimental measurements in which the frequency was captured manually by visual inspection and using a stop watch could play a role in this discrepancy interestingly this was also the only case where the second natural frequency was captured by the simulation producing a value of f 2 sim 1 86 hz compared to the experimental value of f 2 ref 1 874 hz an error of only 0 75 this unexpected result highlights the ability of the code to capture the complex fluid behaviour exhibited by the lower amplitude higher frequency secondary wave motion 4 3 2 pill shaped tank the final natural frequency evaluation tests are performed on the experimental sloshing setup provided by esa estec which is the subject of this paper the experiment was conducted in a pill shaped tank with two different filling levels as described in reference lada et al laine which were chosen to represent realistic filling ratios in space flight conditions the full experimental setup is described in more detail in section 5 here only the tank geometry and the reported natural frequencies for the two filling levels are given the pill shaped tank consists of two half spheres on each end connected by a cylinder of radius r 0 144 m and height h c 0 6 m a schematic of the tank is given in fig 7 the two filling levels tested h w 1 0 2 m and h w 2 0 5 m are reported in reference lada et al laine to have first natural frequencies of 1 77 and 1 78 hz respectively these values were obtained by lada et al lada et al laine by interpolation from experimental data by mikishev and dorozhkin reported in page 47 of reference abramson 1966 in both cases the tank was subjected to an initial lateral excitation with force amplitude of 0 5 m s 2 and a frequency of f w 1 5 f 1 for each filling level for a duration of two periods after the force was withdrawn the simulation was allowed to continue for a total duration of 30s an initial particle spacing of δ x 0 005 m was selected which in non dimensional form gives h w 1 δ x 40 and h w 2 δ x 100 that generated 72 980 and 131 953 fluid particles for h w 1 0 2 m and h w 2 0 5 m respectively and 131 953 boundary particles table 3 shows the comparison between the reference values and those obtained via the psd of the simulated sloshing forces using the proposed sph scheme reasonable agreement is again found between experimental and simulated values with an almost perfect agreement at the lower filling level due to the lack of detail regarding the accuracy of the experimental values we will refrain from overvaluing the quality of the results however a maximum error of 1 85 is very small and gives us some confidence that the method simulates sloshing fairly accurately in this geometry to conclude we have verified and validated the proposed sph methodology by numerically determining the first natural frequency of a variety of tank geometries the verification of the sph method has been carried out using a rectangular an upright cylinder and a spherical tank filled with water to 50 filling ratio and its validation by comparison with experimental data available for a toroidal and a pill shaped tank with a range of filling ratios all the verification results matched the analytical solutions from the literature faltinsen and timokha 2009 with errors in the range of 0 2 to 2 2 the errors in the validation studies were in the range of 0 17 to 3 97 these results are reasonably accurate albeit inconsistent the source of these errors is yet to be understood which is compounded by the limited understanding of the accuracy of experimental values cited for this study further in one specific case of the toroidal tank with a 75 filling ratio the second natural frequency has also been determined therefore sph has proven to be capable of estimating natural frequencies in 3d tanks to a varying degree of accuracy it is however clear that both further experimentation and improvements to the sph methodology will be required to obtain a higher reliability of these estimates 5 application to the esa experiment this experiment conducted by the estec test centre of esa lada et al laine investigates the sloshing behaviour of the fluid close to its natural frequencies and assesses the fluid forces extracted on the pill shaped tank the geometry of which is described in section 4 3 2 for this geometry aside from the second hand quoted experimental values of natural frequencies of reference abramson 1966 the only available guidance to the understanding of this problem is that of the analysis of the similar behaviour of a fluid subject to lateral sloshing in vertical cylinders the first contribution in this area is the seminal work by abramson 1966 also notable is the recent experimental work described in reference royon lebeaud et al 2007 which is also referred to and complemented by theoretical analysis in section 9 3 of reference faltinsen and timokha 2009 according to these references the parameters governing the phenomenon are the fluid viscosity or viscous damping the fluid depth to radius of cylinder ratio and the ratio of oscillation to natural frequencies the experiment was performed for a fixed value of filled height and our model neglects viscosity therefore the only parameter we are concerned with is the ratio of forcing to natural frequencies f ω f i the experiments reported in reference royon lebeaud et al 2007 indicate that taking the lowest natural frequency f 1 as reference a variety of scenarios planar waves swirling waves chaotic sloshing and breaking waves are obtained as the forcing frequency f ω is varied in particular when the forcing frequency is slightly below the first natural frequency the planar wave bifurcates to a swirling wave even though the geometry of the pill shaped tank in the experiment considered here is different due to the presence of a spherical bottom as opposed to a planar one we anticipate a similar behaviour to emerge where the lateral forcing gives rise to asymmetric gravity wave motions in the experiment a pill shaped tank with two different filling levels was laterally excited on a multi axis hydraulic shaker lada et al laine forces were recorded via triaxial force sensors attached to the supporting frame of the tank a video recording of the fluid motion is also available but offers less accurate data for qualitative comparison the forces created by the fluid impinging on the tank are of particular relevance since they can alter the dynamic motion of a vehicle e g a ship lorry or spacecraft carrying the tank a range of frequencies were tested in an increasing sweeping motion dwelling on each for a period of time before sweeping up to the next frequency here only the higher filling level of h w 0 5 is considered in this case frequencies ranging from f w 1 4 hz to f w 2 67 hz over a duration of 11 min and with a maximal displacement value of d 20 mm were considered several frequencies starting at a frequency f w 1 5 hz were dwelt on for a period of 60s each before moving on to the next one in a continuous sweeping as seen in fig 8 the approach used previously to capture the natural frequencies of the fluid motion was deemed inadequate since the sloshing flow did not exhibit any perceptible decaying phase throughout the experiment hence the first 100s of the experiment were simulated in full using the same displacement and frequency data as provided directly from the experimental setup this time period includes the initial buildup of the excitation from rest and the first dwelling frequency the tank sweeps through frequencies ranging from f w 1 4 hz to f w 1 5 hz with an increasing displacement starting from rest and reaching d 20 mm after approximately 28s where it dwells as shown in fig 9 during this period the fluid behaviour transitions from still into violent sloshing exhibiting wave breaks swirling and periods of low motion in between providing an excellent case for assessing the ability of the sph scheme to capture all these different phenomena and validating the code further details of the experimental setup and methodology are given in lada et al laine the simulation was run with a resolution of h w δ x 125 resulting in 459 020 fluid particles due to the more violent nature of the fluid flow the cfl number was set to 0 1 while all other simulation parameters are identical to the verification and validation cases above the simulation required approximately 1 34 10 7 time steps for the 100 simulated seconds and took approximately 123 h to run on a nvidia titan v gpu card fig 10 shows the three cartesian components of the force denoted as f x f y and f z for the full duration of the simulation due to the complexity of the flow and the inherent difficulty in measuring quantities such water heights it is not feasible to establish an exact one to one correspondence however many important features are still captured we note that the forces were not calculated directly in the simulation but obtained by post processing outputs from the simulation using the same process explained in 3 2 the outputs were written at intervals of 0 1s to reduce the number of files saved since the distance between samples of the forces is significantly larger than the computational time step this coarser sampling could be thought of as a form of filtering however we note that no other form of filtering has been applied the first feature is the build up from low sloshing motion into violent sloshing occurring during the increase in the displacement amplitude from approximately 10s 37s during this time interval shown in fig 11 stronger waves are gradually generated in a simple sway motion aligned with the x axis from around 20s when the waves grow larger f z also shows good agreement meanwhile f y shows very little change as the motion was contained in the x z plane with no swirl present the second notable feature and possibly the most significant is the transition from the simple sway motion into breaking waves and the triggering of the swirling motion this transition occurred in both the simulation and experiment in the time interval between 37s and 38s fig 12 shows that at this time f x and f z exhibit a sudden decline in amplitude while f y suddenly grows this sudden increase indicates the triggering of the swirling motion as the flow is no longer contained in the x z plane the frequency of f y is somewhat out of phase but with similar magnitude while f z has the correct frequency but shows a different pattern in the collapse of the amplitude after the transition the component f x is still dominated by the motion of the tank and shows a strong resemblance between the simulation and experiment apart from some slight deviation in the amplitude the simulated force components f y and f z also show a large momentary spike in amplitude around 38s which appears to be numerical in nature and unrelated to the underlying sph methodology employed the issue seems to be restricted to a small number of particles which do not affect the overall behaviour of the fluid only the force calculations in post processing such spikes were not observed in the remainder of the simulation to better visualise this transition snapshots from the experiment and simulation from 36 8 to 37 6 s are shown side by side in fig 13 the wave breaking which triggers the swirling motion is clearly observed these images show a strong resemblance in fluid shape and reinforce the interpretation of the flow phenomena obtained from the force data the typical behaviour observed after the transition into swirling as seen in for instance during the last 20s of the simulation depicted in fig 14 shows however some discrepancies between simulation and experiment the flow is characterised by a violent fluid motion with swirling that frequently switches rotational direction short periods where the fluid exhibits less violent features during the transition are also observed in both the simulation and the video recording of the experiment these flow features are hard to observe in the time histories of the force component but nonetheless some further analysis is provided hereafter the behaviour of the force component f x stays similar as it is driven by the external forcing but the components f y and f z go in and out of phase as the simulation and the experiment take different rotational directions the amplitude of f y is overall similar between the simulation and experiments with the frequencies switching quickly from being synchronised to being in an opposite phase on the other hand the component f z exhibits many peaks and troughs which are assumed to be related to instances of wave build up and break down respectively as the transition in rotational direction takes place while the overall amplitudes of f z are similar the experiment appears to shows slightly more regular sequences of peaks and troughs than the simulation we also note a small under prediction in the simulated values of f x compared to the experiment throughout the simulation this discrepancy however has no discernible effect on the timing of the transition into violent flow the triggering of the swirling motion or the values of the dominant frequencies and it can arguably be considered negligible further investigation is required to elucidate the reason behind this behaviour to better understand this observation we analyse the frequency content of the fluid forces fig 15 compares the computed and experimental psd of for each force component due to the complex temporal dynamics of the sloshing motion and its wide range of frequencies the use a single window for obtaining the psd in the ffts based methodology described in section 4 1 makes it difficult to discriminate between frequencies in the psd instead we employ welch s power spectral density estimate which uses averaged moving and overlapping windows to obtain a smoother psd with more discernible frequency peaks which is easier to interpret we use the intrinsic matlab function mathworks 2020 using the default settings for both the experimental and the simulated force components the frequency spectrum of f x shows an almost perfect agreement of peak frequencies of 1 5 hz which is to be expected as it is the forcing excitation along the x axis a more interesting finding is that f y and f z show very similar frequency content despite the slight discrepancies observed in time histories as seen in figs 10 14 the f y component which corresponds to the forces due to swirling shows the experimental dominant frequency in the range of 1 68 hz 1 719 hz while the dominant frequency range in the simulation is 1 641 hz 1 68 hz interestingly this frequency is much closer to the natural frequency cited as 1 77 hz by reference lada et al laine and obtained numerically as 1 84 hz see section 4 3 2 than to the forcing frequency however investigating this relationship is beyond the scope of this validation test the f z component which corresponds to the vertical slamming of the waves exhibits two dominant peaks a stronger one reading 2 77 hz in the experiment and 2 73 hz in the sph simulation and a second one with a reading of 3 0 hz in both experiment and computation which is exactly twice the forcing frequency as is to be expected due to the vertical motion of the waves since the dominant frequencies of the f y and f z force components are not driven by the external force this strong agreement between simulation and experiment obtained in the frequency domain analysis provides strong evidence of the ability of the proposed sph method to accurately capture the important features of such complex flows however the simulation does show slightly more contribution from the less dominant frequencies than those in the experiment for all three force components this can be inferred from the higher power of the frequencies away from the peaks in the psd analysis shown in fig 15 while these lower power frequencies are of lesser importance a better understanding of this discrepancy is still desired and is left for future work 6 conclusions a carefully curated selection of sph features was shown in green and peiró 2018 to provide a useful tool for modelling liquid sloshing in simple rectangular tanks these include a fixed ghost particle solid boundary treatment the use of the δ sph scheme and the capability to run on a gpu in this work the same set of features was used to demonstrate the ability of the sph methodology to simulate more challenging sloshing phenomena in complex 3d geometries this was shown in particular by replicating an experiment conducted by esa estec of long duration sloshing in a pill shaped tank a study of extracting the natural sloshing frequencies in various tank geometries was conducted as a means of verifying and validating the sph code a good agreement with the values obtained analytically and experimentally was found including the second mode in the case of the toroidal tank with a high filling ratio this study is itself of great interest as the ability to accurately determine the natural sloshing frequencies in arbitrary tank geometries is fundamental to the design of any partially filled container following the verification and validation of the code a reproduction of the pill shaped tank sloshing experiment conducted the estec test centre of esa was attempted in the experiment a partially filled pill shaped tank underwent lateral excitation in the x axis direction starting from rest the amplitude and frequency increased over time until it dwelt on a specified setting for some duration albeit without reaching a steady state the fluid inside the tank started with purely sway motion until such a time when swirling motion was triggered from that point the flow exhibited rapid changes in the amplitude of the waves and the rotational direction of the swirls force components in the x y and z axis were recorded along with a video of the fluid two significant observations from the simulation were made the first is the capture of the moment when the swirling wave motion was triggered both the forces and the shape of the free surface showed a strong resemblance between the experiment and simulation at that critical moment the other is a strong agreement in the spectral power density of the frequency domain particularly at the peak frequencies while this was expected for the x axis direction which corresponds to the direction of the excitation it was also observed in the y and z axis components which correspond to the swirling motion and wave elevation respectively the agreement is found despite noticeable differences in their time histories this data shows the ability of the proposed sph scheme to accurately obtain the critical information of the sloshing motion and the impact of the forces on the tank credit authorship contribution statement mashy d green software simulations methodology verification and validation writing original draft visualization writing review editing final manuscript preparation yipeng zhou simulations verification and validation visualization writing review editing josé m dominguez software writing review editing moncho g gesteira supervision writing review editing joaquim peiró supervision methodology writing review editing final manuscript preparation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements we would like to express our gratitude to dr josé longo andrea passaro and chiara lada of esa estec for their advice on sloshing phenomena for making the experimental data on the pill shaped tank available to us for helping us with their interpretation and for granting us permission to publish it appendix a mesh convergence analysis this appendix presents a spatial resolution or mesh convergence study for the linear sloshing of a cylindrical tank problem described in section 3 the mesh convergence study is performed with a fixed kernel support to particle spacing ratio h δ x as a result the truncation error of the integral of the kernel support is the dominant error quinlan et al 2006 and leads to a lower convergence rate on the other hand the method consistently decreases the smoothing error with increased resolution the choice of a fixed kernel support ratio ensures a full kernel support in our treatment of the wall boundary conditions green and peiró 2018 the dimensions of the tank are the same but here the tank is filled with water to a level h w 0 5 m rather than the filling level h w 0 1 m used for the validation test in section 3 we do this purely for display purposes since using a higher value of the water elevation permits a better visual comparison of the computed and the analytical water displacement particularly at lower resolutions following equation 27 the first natural frequency now is f 1 0 9328 hz the tank undergoes forced sinusoidal excitation in the x axis direction with a forcing frequency f w 0 3 f 1 0 2798 hz and a displacement amplitude a 0 3 m this displacement amplitude gives rise to a forcing amplitude a f a 2 π f w 2 0 9275 the particle spacing is varied according to h w δ x 25 2 n for n 0 1 2 3 the error is calculated as the l 2 norm of the difference between the computed and the analytical solution of the sloshing model taken from reference faltinsen and timokha 2009 the accumulated error was evaluated by integrating the analytical and computed forces over a full sloshing period t 3 57 s the force time histories depicted in figure a 1 a clearly indicate the computed forces are getting closer to the reference solution as the mesh resolution increases the calculated rate of convergence coc is defined as coc log ε n ε n 1 log 2 where ε n is the accumulated error of case n figure a 1 b shows that the convergence rate gradually reduces from 0 7145 to 0 588 there are clear signs of convergence as the accumulated error decreases although the value of the coc is lower than 1 and it decreases with n which is expected in such cases this convergence rate is also significantly higher than that found for the 2d cases presented in green and peiró 2018 fig a 1 mesh convergence analysis a force histories for different mesh resolutions and comparison with the analytical solution b accumulated error versus mesh resolution on a log scale and calculated rate of convergence coc fig a 1 appendix b natural frequency data this appendix describes how to extract the sloshing natural frequencies from time histories of the forces acting on the tank using the periodogram this is a nonparametric power spectral density psd estimate obtained by discrete sampling the time history using a fast fourier transform fft the examples shown in this appendix use the matlab implementation mathworks 2019 the main assumption of the procedure is that after the tank has been subject to an initial excitation the fluid settles into a decaying phase where the fluid oscillates with a few ideally one or two dominant natural frequencies the simulation is run until such a decaying phase is reached the time history of the forces is then visually inspected to select a time frame or window within the decaying phase region where the natural frequencies are present in multiples of full periods the fft routine is then run on an exact number of sloshing periods to identify the dominant frequencies it should be noted that this approach is viable because of the small number of frequencies present in the time history of the force and that the correct selection of the window is of paramount importance towards obtaining the correct set of frequencies examples of the application of the process to the rectangular cylindrical and spherical tanks are depicted in figure b 2 that shows the windows used for sampling the time history of the forces and compares the analytical and computed values of the natural frequencies figure b 3 shows similar results for the simulation of sloshing in a toroidal tank at filling ratios of 25 50 and 75 here it is worth observing the presence of a second natural frequency at the filling ratio of 75 consistent with the qualitative and quantitative experimental observations finally figure b 4 further illustrates the procedure and the good agreement of computed and experimental natural frequencies for the sloshing in a pill tank with filling heights of 0 2 and 0 5 m we end this appendix with a clarification in the application to the esa experiment in section 5 the psd estimates used the alternative welch s method mathworks 2020 and the full duration of the simulation from 0 1s to 100s for the calculation of the periodogram the reason for this is that our objective was to calculate the frequency spectrum of a long duration transient signal not the dominant frequencies of the decaying phase and welch s method is better suited for such purpose fig b 2 time histories of the force on the tank for the full duration of the simulation a rectangular c cylindrical and e spherical the time period between the dashed red lines represent the duration over which the power spectral density psd mathworks 2019 is estimated the psd estimates for the respective tank geometries are depicted in figures b d and f fig b 2 fig b 3 force time histories of the full duration of the simulation for the toroidal tank at filling ratios of a 25 c 50 and e 75 the time period between the dashed red lines represent the duration over which the power spectral density psd mathworks 2019 is estimated the psd estimates for the respective filling ratios are depicted in figures b d and f fig b 3 fig b 4 force time histories of the full duration of the simulation for the pill tank at filling heights of a 0 2m and c 0 5m the time period between the dashed red lines represent the duration over which the power spectral density psd mathworks 2019 is estimated the psd estimates for the respective filling heights are depicted in figures figures b and d fig b 4 
20803,recently adcock and taylor 2009 devised a method to estimate the underlying directional spreading from a single point measurement subsequently this method has been successfully applied to sea states with frequency independent directional spreading in contrast the present work has applied this method to synthetic sea states generated with an underlying frequency dependent spreading however in the application of the method it was assumed that the underlying sea states have a frequency independent spreading it was found that applying this method in this manner predicts directional spreading that is close to the spectrally averaged spreading re computing the widely used velocity reduction factor vrf based on the predictions from the new method showed that it agreed within 1 5 with the actual value showing that a reasonable estimate of the directional spreading can be obtained by the new method even under the restrictive assumption of frequency independent spreading the major implication of these findings is that a reasonable estimate of the directional spreading function can be obtained for sea states with complex spreading from a single point measurement even with the assumption of frequency dependent spreading keywords directional spectrum mixed seas frequency dependent spreading 1 introduction in the modelling of realistic ocean waves incorporating the directional distribution of wave energy is an important pre requisite for accurate prediction of wave properties and in turn the forces caused by them this is due to the fact that loads computed assuming uni directional propagation of wave energy can differ dramatically when compared to the predictions assuming a directional spread of wave energy directional distribution of wave energy is typically undertaken by augmenting the uni directional wave spectrum with a directional spreading function dsf leading to a directional wave spectrum that is a function of both wave frequency and direction of propagation the relatively simple empirical functional forms of the dsf that are used in modelling realistic sea states are typically derived from measured field data analysing field data to deduce the underlying dsf is not a trivial task this is because to get directional information one requires concurrent measurements of wave properties such as surface elevation or wave particle kinematics at a large number of spatial locations however considering all available measured data the vast majority of these correspond to a single or at most 2 5 point measurements of the surface elevation in contrast most of the directional analysis are performed using the limited waveraider buoy measurements which can record 3 5 wave properties concurrently and can include a combination of surface displacement surface slopes and vertical acceleration with these limited concurrently measured wave properties the conventionally applied directional analysis methods involve the application of advanced statistical techniques to compute the likeliest dsf by minimizing a statistical measure such as the least square errors or entropy of these the most widely used methods include maximum likelihood method mlm after isobe et al 1984 extended maximum entropy method emep after hashimoto et al 1994 and bayesian directional method bdm after hashimoto et al 1987 it should be stressed that waveraider buoy data are not as commonly available as point surface elevation measurements in addition the aforementioned conventional directional estimation methods can not be used with a point measurement of a single quantity more recently adcock and taylor 2009 formulated a method hereafter referred to as edm that can predict the underlying dsf from a single point measurement following that mcallister et al 2017 applied this method to the analysis of field data from north sea comparisons between predictions from edm hindcast data and conventional methods for instances when data from multiple spatial locations were available showed that all three matched closely with minor deviations despite the accuracy for data that mcallister et al 2017 analysed it should be highlighted that an important assumption made by adcock and taylor 2009 and mcallister et al 2017 when applying edm is that the dsf is independent of wave frequency while this maybe a reasonable assumption in most cases the work by donelan et al 1985 and ewans 1998 amongst others show that this may not be the case more importantly there is mounting evidence see gibson and swan 2007 and adcock et al 2012 that nonlinear wave energy transfers that occurs when the steepest wave events evolve lead to frequency dependent spreading this implies that for the steepest sea states which are of most interest from an engineering perspective frequency dependent spreading could be inherent another practical situation where this assumption breaks down is the case of mixed seas such as that of wind swell seas in these situations typically the swell component has a narrower directional distribution compared to the more broadbanded wind component a mix of wind swell is not the only scenario where mixed seas arise two wind sea systems may cross at a point giving rise to what is known as a crossing sea recently there have been some evidence see adcock et al 2011 that indicate that rogue waves such as the famous draupner wave arose in such a crossing sea it should also be highlighted that in the original edm paper adcock and taylor 2009 one of the cases that was analysed was the draupner wave event if one were to apply edm to obtain the underlying directional spread from the most commonly available single surface elevation point measurements assumption of a frequency independent dsf is the only rational choice this is related to the fact that edm is based upon a trial and error procedure that tries different spreading functions to find the one that gives the best fit to the low frequency second order difference components of measured data if a frequency dependent spread is to be assumed in this trial and error procedure an unlimited number of dsf each with a different variation with frequency must be trialled at the same time for some locations worldwide only single point measurements are available and edm is the method available for computing the underlying dsf however despite the assumption of frequency independent spread being the only rational choice some of these sea states may have a frequency dependent dsf or may be mixed seas therefore it is important to understand what edm will predict for sea states with such complex spreading under the restrictive assumption of frequency independent spreading the main aim of the present work is to investigate the dsf that edm predicts for mixed seas and sea states with a complex dsf when it is applied with the assumption of frequency independent spreading this was achieved by employing synthetic data for which the inputs are well known a priori usage of synthetic time histories allowed a detailed study of the predictions from edm the paper continues in 2 where a summary of edm is provided along with a brief background on mixed seas and directional spectrum the main results of this study are provided in 3 the practical implications of the findings are also discussed before providing concluding remarks and some directions for future work 2 background power spectral density function s η η ω of the surface elevation η is typically used to describe a uni directional sea state for real sea states this function is formulated using a number of empirically fitted co efficients for wind seas which are generated directly by storms the most widely used spectral density function is the jonswap spectrum given by 1 s w η η ω 2 π 4 α g 2 ω 5 exp β ω p 4 ω 4 γ exp ω ω p 2 2 ω p 2 σ 2 where ω p is the circular wave frequency corresponding to the spectral peak period t p γ is the peak enhancement factor α is the phillips parameter β 1 25 σ 0 07 for ω ω p and 0 09 for ω ω p and η is the surface elevation for swell seas which consists of wave energy that have moved into a given location from storms generated elsewhere a commonly used form of the spectrum is 2 s s η η ω 0 25 h s 2 σ 2 π exp ω ω p 2 2 σ 2 where σ is the standard deviation of the resulting gaussian spectrum to account for the directional distribution of the wave energy s η η is modified by introducing a directional spreading function dsf d θ as 3 g ω θ d θ s η η ω the two most commonly adopted forms of the dsf are the cos n type given by 4 d θ a cos 2 s θ θ m 2 where θ is the angle of propagation of the given wave component θ m is the mean direction s is a parameter determining the level of spreading and a is a normalising co efficient and the wrapped normal distribution given by 5 d ω θ a σ θ 2 π exp θ θ m 2 2 σ θ 2 where a is again a normalising coefficient and σ θ is the standard deviation of the gaussian function the parameters s and θ in these distributions determine the degree of spreading with larger σ θ and smaller s values associated with comparatively larger proportion of wave energy propagating at angles larger than the mean direction of propagation although s and σ θ are used to characterise two different functional forms of a dsf the following relation holds 6 s 2 σ θ 2 1 an important assumption typically made about the spreading parameter is that they are independent of frequency in other words the same dsf is applied to all of the frequency components in a spectrum however work by ewans 1998 donelan et al 1985 and boukhanovsky and guedes soares 2009 among others show that this is not a universal representation analysis of storm data by ewans 1998 showed that the spreading parameter is a function of frequency with the peak of the spectrum having a narrower dsf the parametrisation suggested by ewans 1998 is 7 s 15 5 f f p 9 47 f f p 1 13 1 f f p 1 94 f f p 1 a plot demonstrating this spread is provided in fig 1 as a non dimensional plot clearly demonstrating the lower directional spread around the peak frequency 2 1 eulerian directional method edm conventionally the underlying dsf is inferred using sophisticated statistical methods on concurrently measured wave properties such as surface elevation and water particle kinematics for these methods the more time histories that are available the better the prediction the most commonly used methods include the maximum likelihood method isobe et al 1984 maximum entropy method hashimoto et al 1994 and bayesian directional method hashimoto et al 1987 which are named after the powerful statistical techniques underlying these methods a relatively simple method that only uses the phase information from measurements undertaken at just three points after boccotti 2004 also exists more recently adcock and taylor 2009 established edm that only requires a single surface elevation time history to estimate the underlying dsf this method resulted from the observation that the magnitude of second order difference bound wave terms that arise when two freely propagating waves interact is a function of the angle of propagation between the two interacting wave components for a wave spectrum containing multiple wave components second order bound waves can be obtained by summing contributions from each pair of free wave components after sharma and dean 1981 as 8 η 2 η η 1 4 i 1 j 1 a i a j k cos ψ i ψ j k cos ψ i ψ j where a i are amplitudes of individual components and ψ i is the usual phase function in terms of k ω and θ in this summation the term k correspond to the frequency sum terms η while k correspond to the frequency difference bound wave term η and is given by 9 k d i j k i k j r i r j r i r j r i r j here d i j and r i are known functions of k ω water depth d θ and are provided in sharma and dean 1981 noting that amplitudes of individual components are given by 10 a i j g ω i θ j δ ω δ θ and a fourier transform of a point measurement of the surface elevation provides exactly a i ω and in turn s η η ω i η can be obtained by assuming a functional form of d θ with a corresponding spreading parameter the computed η is then compared to the measured η that can readily be isolated by simple low pass filtering of measured η t denoting this discrepancy between computed difference terms for an assumed value of s or σ θ and the measured difference term as 11 l w d calculated measured 2 measured 2 formally the procedure for obtaining d θ becomes a search for σ θ or s that minimizes lwd before kick starting this procedure the measured time history is low pass filtered to isolate η and high pass filtered and processed further to obtain the underlying free waves the details of which are provided in walker et al 2004 adcock and taylor 2009 and mcallister et al 2017 while the application of edm so far in the literature assumes a frequency independent dsf and searches for the corresponding s or σ θ that minimizes lwd there is no such restriction imposed by the overall methodology however in the absence of any data other than a single point measurement this becomes the only rational choice fig 2 provides the variation of lwd with σ θ for a synthetic time history generated using a typical jonswap spectrum with t p 16 s h s 15 m γ 2 5 and has been spread using equation 5 with σ θ 20 the synthetic time history for this case was generated using second order random wave theory the time history was further processed to obtain the underlying η and the free wave spectrum the lwd attains a sharp minimum at σ θ 20 exhibiting how well edm works 3 results the simplest sea state for which the assumption of frequency independent directional spreading does not hold is the commonly encountered wind swell sea state swell usually tend to have a narrower directional spreading while the opposite is true for the wind component the first sub section that follows addresses this case while the other two sub sections addresses frequency dependent directional spreading after ewans 1998 and the implications of findings on design calculations respectively 3 1 mixed seas to study the predictions from edm when it is applied assuming a frequency independent directional spread for mixed sea states synthetic time histories were generated for a range of sea states for all sea states considered in this sub section a wrapped normal type dsf with σ θ 15 for swell and σ θ 25 for the wind component were chosen the spectrum was discretised with δ ω 9 82 10 3 rad s and δ θ 5 over 90 θ 90 the spectral shape for the swell component was gaussian with σ 15 s 1 and t p 14 s while that for the wind component was jonswap with γ 2 5 and t p 16 s the total h s 15 m for the whole sea state was maintained while the proportion of swell and wind in the spectrum was varied the ratio of the relative strength of the two components was defined as 12 α h s w h s s where h s w refers to the h s of the wind component while h s s correspond to the swell component for the sea states considered in the present study α was varied from 0 3 10 0 fig 3 a and b provides the frequency direction spectrum for α 10 and 0 3 respectively the frequency axis has been normalised by the peak frequency associated with the swell component in both figures as expected for α 10 where the wind component dominates the spectrum is much broader in both frequency and direction with a large spread of energy compared to the α 0 3 case where the narrower swell component dominates fig 3 c and d provides the corresponding frequency spectrum for α 10 and 0 3 respectively the individual wave systems are also plotted in the two sub figures for all of these cases edm was applied to the synthetic time histories generated using second order random wave theory by assuming that the underlying dsf is independent of frequency fig 4 provides the long wave discrepancy as a function of σ θ for α 10 1 0 and 0 3 respectively for all the three cases the lwd function attains a minimum which is marked with a square in the sub figures it is apparent from the location of this square marker that the σ θ of the dsf that is predicted by edm is biased towards the σ θ value of the dominant wave system for example taking fig 4 a which corresponds to α 10 σ θ 24 5 here the wind component dominates and for this component σ θ 25 motivated by this observation a weighted spreading was defined as 13 σ w i 1 n f σ θ ω s η η ω i 1 n f s η η ω where n f is the number of frequency components in the discretised frequency spectrum fig 5 provides a comparison between σ w and the σ θ associated with the minimum lwd for each α overall a good agreement is obtained with differences of a few degrees this shows that when edm is applied under the assumption of frequency independent directional spreading the prediction for mixed sea states is the weighted average σ θ of the two wave systems so far the edm has been applied to the mixed sea states by assuming that the dsf is the same for both wind and swell components however sophisticated techniques exist for separating the swell and wind components see ewans et al 2006 from a point measurement therefore it is practically possible to assign an individual dsf to the two components in a mixed sea for the α 1 0 case edm was applied in this manner since the two wave systems are known no attempt was made to separate them using an advanced technique from the synthetic time history for computing lwd σ θ was varied for both the swell and wind components separately and computed for each possible pair of σ θ fig 6 provides the lwd obtained for all the pairs of σ θ a sharp minimum in lwd is obtained for σ θ 15 for the swell component and σ θ 25 for the wind component which coincides with the input this provides a proof of concept that edm can be applied to mixed sea states and the directional spreading for individual components can be ascertained accurately however it should be highlighted that the number of computationally intensive second order calculations goes up dramatically as a large number of pairs of σ θ values needs to be considered in addition this procedure is still subject to the accurate separation of wind and swell components 3 2 frequency dependent spreading to investigate the predictions from edm when the underlying dsf is frequency dependent a number of synthetic time histories were again generated using second order random wave theory just like what was adopted in 3 1 the underlying spectrum was discretised with δ ω 9 82 10 3 rad s and δ θ 5 also a jonswap spectrum with h s 15 m and t p 16 s was used to generate the time histories the peak enhancement factor γ was varied from 1 0 to 7 0 and for each case a wrapped normal type dsf was adopted with σ θ f provided by equation 7 for each case edm was applied under the assumption of frequency independent directional spread fig 7 provides a comparison between σ θ predicted by edm for each γ and the spectrally averaged σ θ computed from equation 13 just like that for mixed seas fig 5 the two lines are in close agreement with the maximum difference lower than 1 taking these results for ewans spread and mixed sea states previous sub section as a whole it can be concluded that when edm is applied with the assumption of frequency independent spreading the dsf that is predicted is close to that of the spectrally averaged dsf 3 3 implications for design having confirmed that the prediction from edm relate to the spectrally averaged spreading value it is important to investigate the practical implication of this finding in this investigation the commonly adopted velocity reduction factor vrf was used vrf is defined as 14 v r f rms in line velocity in directional sea rms velocity in a uni directional sea for design problems such as computation of forces on structures which require the water particle kinematics vrf provides a quick way of modifying the corresponding uni directional quantities in fact the same procedures that are used for uni directional waves can readily be used by modifying the water particles kinematics with the vrf hence accurate values for vrf are important from the perspective of designers for both the mixed and ewans spread sea states vrf was computed using equation 14 and will be denoted as vrf a vrf was also computed for the spectrally averaged σ θ and also that predicted by edm and will be denoted by vrf p in the subsequent discussion fig 8 provides a comparison of the ratio v r f a v r f p for the spectrally averaged σ θ and that predicted by edm for both mixed seas and ewans spread seas vrf based upon the spectrally averaged σ θ provides excellent agreement with the true vrf with differences less than 0 5 similarly vrf based upon σ θ predicted by edm is also in close agreement with the true vrf the errors for mixed sea states are lower and remain within 0 5 while that for ewans spread cases are slightly higher at 1 5 4 conclusions edm is a relatively new and powerful method that can resolve the underlying directional spread from a single point measurement of the surface elevation the application of this method to field data have been undertaken so far by assuming that the underlying directional spreading is independent of frequency in the present work edm has been applied under the assumption of frequency independent directional spreading to two cases with frequency dependent directional spreading mixed wind swell sea and sea state with ewans 1998 spreading for the mixed wind swell sea states edm predicted σ θ that remained close to the σ θ value of the dominant component of the mixed sea state further investigation showed that in fact the predictions tallied well with the spectrally averaged σ θ values another important finding for mixed sea states was that edm can be successfully applied by assigning different σ θ values for swell and wind components this is an important finding as once field data from a point measurement has been decomposed into swell and wind components edm can be applied to ascertain the spreading of individual wave systems this is of immense interest to regions such as southern south china sea where the swell component can be dominant see amurol and ewans 2019 and latheef et al 2020 similar to the mixed seas application of edm to sea states with frequency dependent ewans 1998 spreading predicted σ θ values that tallied well with the spectrally averaged σ θ values therefore it can be concluded that when edm is applied under the assumption of frequency independent spreading the dsf it produces is very close to the spectrally averaged dsf to investigate the implication of using σ θ predicted by edm under the assumption of a frequency independent directional spreading the commonly used v r f was used as a measure it was found that the real vrf values computed based upon the input directional spectrum agreed well with those based upon the dsf predicted from edm in fact vrf values remained within 1 5 therefore it is reasonable for typical design applications to be based upon the dsf predicted by edm under the assumption of frequency independent spreading the results in this paper are based upon synthetic time histories for which the inputs are known rather well in addition these data do not suffer from typical artefacts in real data such as noise for future work as a first step it is suggested that edm be applied to field data for mixed sea states in fact the authors have access to such data recorded in southern south china sea along with corresponding validated hindcast predictions the work is underway and will be reported in a future publication credit authorship contribution statement mohamed latheef data analysis part of writing up do kyun kim data analysis part of writing up funding this research is funded by yutp grant no 015lc0 096 declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper 
20803,recently adcock and taylor 2009 devised a method to estimate the underlying directional spreading from a single point measurement subsequently this method has been successfully applied to sea states with frequency independent directional spreading in contrast the present work has applied this method to synthetic sea states generated with an underlying frequency dependent spreading however in the application of the method it was assumed that the underlying sea states have a frequency independent spreading it was found that applying this method in this manner predicts directional spreading that is close to the spectrally averaged spreading re computing the widely used velocity reduction factor vrf based on the predictions from the new method showed that it agreed within 1 5 with the actual value showing that a reasonable estimate of the directional spreading can be obtained by the new method even under the restrictive assumption of frequency independent spreading the major implication of these findings is that a reasonable estimate of the directional spreading function can be obtained for sea states with complex spreading from a single point measurement even with the assumption of frequency dependent spreading keywords directional spectrum mixed seas frequency dependent spreading 1 introduction in the modelling of realistic ocean waves incorporating the directional distribution of wave energy is an important pre requisite for accurate prediction of wave properties and in turn the forces caused by them this is due to the fact that loads computed assuming uni directional propagation of wave energy can differ dramatically when compared to the predictions assuming a directional spread of wave energy directional distribution of wave energy is typically undertaken by augmenting the uni directional wave spectrum with a directional spreading function dsf leading to a directional wave spectrum that is a function of both wave frequency and direction of propagation the relatively simple empirical functional forms of the dsf that are used in modelling realistic sea states are typically derived from measured field data analysing field data to deduce the underlying dsf is not a trivial task this is because to get directional information one requires concurrent measurements of wave properties such as surface elevation or wave particle kinematics at a large number of spatial locations however considering all available measured data the vast majority of these correspond to a single or at most 2 5 point measurements of the surface elevation in contrast most of the directional analysis are performed using the limited waveraider buoy measurements which can record 3 5 wave properties concurrently and can include a combination of surface displacement surface slopes and vertical acceleration with these limited concurrently measured wave properties the conventionally applied directional analysis methods involve the application of advanced statistical techniques to compute the likeliest dsf by minimizing a statistical measure such as the least square errors or entropy of these the most widely used methods include maximum likelihood method mlm after isobe et al 1984 extended maximum entropy method emep after hashimoto et al 1994 and bayesian directional method bdm after hashimoto et al 1987 it should be stressed that waveraider buoy data are not as commonly available as point surface elevation measurements in addition the aforementioned conventional directional estimation methods can not be used with a point measurement of a single quantity more recently adcock and taylor 2009 formulated a method hereafter referred to as edm that can predict the underlying dsf from a single point measurement following that mcallister et al 2017 applied this method to the analysis of field data from north sea comparisons between predictions from edm hindcast data and conventional methods for instances when data from multiple spatial locations were available showed that all three matched closely with minor deviations despite the accuracy for data that mcallister et al 2017 analysed it should be highlighted that an important assumption made by adcock and taylor 2009 and mcallister et al 2017 when applying edm is that the dsf is independent of wave frequency while this maybe a reasonable assumption in most cases the work by donelan et al 1985 and ewans 1998 amongst others show that this may not be the case more importantly there is mounting evidence see gibson and swan 2007 and adcock et al 2012 that nonlinear wave energy transfers that occurs when the steepest wave events evolve lead to frequency dependent spreading this implies that for the steepest sea states which are of most interest from an engineering perspective frequency dependent spreading could be inherent another practical situation where this assumption breaks down is the case of mixed seas such as that of wind swell seas in these situations typically the swell component has a narrower directional distribution compared to the more broadbanded wind component a mix of wind swell is not the only scenario where mixed seas arise two wind sea systems may cross at a point giving rise to what is known as a crossing sea recently there have been some evidence see adcock et al 2011 that indicate that rogue waves such as the famous draupner wave arose in such a crossing sea it should also be highlighted that in the original edm paper adcock and taylor 2009 one of the cases that was analysed was the draupner wave event if one were to apply edm to obtain the underlying directional spread from the most commonly available single surface elevation point measurements assumption of a frequency independent dsf is the only rational choice this is related to the fact that edm is based upon a trial and error procedure that tries different spreading functions to find the one that gives the best fit to the low frequency second order difference components of measured data if a frequency dependent spread is to be assumed in this trial and error procedure an unlimited number of dsf each with a different variation with frequency must be trialled at the same time for some locations worldwide only single point measurements are available and edm is the method available for computing the underlying dsf however despite the assumption of frequency independent spread being the only rational choice some of these sea states may have a frequency dependent dsf or may be mixed seas therefore it is important to understand what edm will predict for sea states with such complex spreading under the restrictive assumption of frequency independent spreading the main aim of the present work is to investigate the dsf that edm predicts for mixed seas and sea states with a complex dsf when it is applied with the assumption of frequency independent spreading this was achieved by employing synthetic data for which the inputs are well known a priori usage of synthetic time histories allowed a detailed study of the predictions from edm the paper continues in 2 where a summary of edm is provided along with a brief background on mixed seas and directional spectrum the main results of this study are provided in 3 the practical implications of the findings are also discussed before providing concluding remarks and some directions for future work 2 background power spectral density function s η η ω of the surface elevation η is typically used to describe a uni directional sea state for real sea states this function is formulated using a number of empirically fitted co efficients for wind seas which are generated directly by storms the most widely used spectral density function is the jonswap spectrum given by 1 s w η η ω 2 π 4 α g 2 ω 5 exp β ω p 4 ω 4 γ exp ω ω p 2 2 ω p 2 σ 2 where ω p is the circular wave frequency corresponding to the spectral peak period t p γ is the peak enhancement factor α is the phillips parameter β 1 25 σ 0 07 for ω ω p and 0 09 for ω ω p and η is the surface elevation for swell seas which consists of wave energy that have moved into a given location from storms generated elsewhere a commonly used form of the spectrum is 2 s s η η ω 0 25 h s 2 σ 2 π exp ω ω p 2 2 σ 2 where σ is the standard deviation of the resulting gaussian spectrum to account for the directional distribution of the wave energy s η η is modified by introducing a directional spreading function dsf d θ as 3 g ω θ d θ s η η ω the two most commonly adopted forms of the dsf are the cos n type given by 4 d θ a cos 2 s θ θ m 2 where θ is the angle of propagation of the given wave component θ m is the mean direction s is a parameter determining the level of spreading and a is a normalising co efficient and the wrapped normal distribution given by 5 d ω θ a σ θ 2 π exp θ θ m 2 2 σ θ 2 where a is again a normalising coefficient and σ θ is the standard deviation of the gaussian function the parameters s and θ in these distributions determine the degree of spreading with larger σ θ and smaller s values associated with comparatively larger proportion of wave energy propagating at angles larger than the mean direction of propagation although s and σ θ are used to characterise two different functional forms of a dsf the following relation holds 6 s 2 σ θ 2 1 an important assumption typically made about the spreading parameter is that they are independent of frequency in other words the same dsf is applied to all of the frequency components in a spectrum however work by ewans 1998 donelan et al 1985 and boukhanovsky and guedes soares 2009 among others show that this is not a universal representation analysis of storm data by ewans 1998 showed that the spreading parameter is a function of frequency with the peak of the spectrum having a narrower dsf the parametrisation suggested by ewans 1998 is 7 s 15 5 f f p 9 47 f f p 1 13 1 f f p 1 94 f f p 1 a plot demonstrating this spread is provided in fig 1 as a non dimensional plot clearly demonstrating the lower directional spread around the peak frequency 2 1 eulerian directional method edm conventionally the underlying dsf is inferred using sophisticated statistical methods on concurrently measured wave properties such as surface elevation and water particle kinematics for these methods the more time histories that are available the better the prediction the most commonly used methods include the maximum likelihood method isobe et al 1984 maximum entropy method hashimoto et al 1994 and bayesian directional method hashimoto et al 1987 which are named after the powerful statistical techniques underlying these methods a relatively simple method that only uses the phase information from measurements undertaken at just three points after boccotti 2004 also exists more recently adcock and taylor 2009 established edm that only requires a single surface elevation time history to estimate the underlying dsf this method resulted from the observation that the magnitude of second order difference bound wave terms that arise when two freely propagating waves interact is a function of the angle of propagation between the two interacting wave components for a wave spectrum containing multiple wave components second order bound waves can be obtained by summing contributions from each pair of free wave components after sharma and dean 1981 as 8 η 2 η η 1 4 i 1 j 1 a i a j k cos ψ i ψ j k cos ψ i ψ j where a i are amplitudes of individual components and ψ i is the usual phase function in terms of k ω and θ in this summation the term k correspond to the frequency sum terms η while k correspond to the frequency difference bound wave term η and is given by 9 k d i j k i k j r i r j r i r j r i r j here d i j and r i are known functions of k ω water depth d θ and are provided in sharma and dean 1981 noting that amplitudes of individual components are given by 10 a i j g ω i θ j δ ω δ θ and a fourier transform of a point measurement of the surface elevation provides exactly a i ω and in turn s η η ω i η can be obtained by assuming a functional form of d θ with a corresponding spreading parameter the computed η is then compared to the measured η that can readily be isolated by simple low pass filtering of measured η t denoting this discrepancy between computed difference terms for an assumed value of s or σ θ and the measured difference term as 11 l w d calculated measured 2 measured 2 formally the procedure for obtaining d θ becomes a search for σ θ or s that minimizes lwd before kick starting this procedure the measured time history is low pass filtered to isolate η and high pass filtered and processed further to obtain the underlying free waves the details of which are provided in walker et al 2004 adcock and taylor 2009 and mcallister et al 2017 while the application of edm so far in the literature assumes a frequency independent dsf and searches for the corresponding s or σ θ that minimizes lwd there is no such restriction imposed by the overall methodology however in the absence of any data other than a single point measurement this becomes the only rational choice fig 2 provides the variation of lwd with σ θ for a synthetic time history generated using a typical jonswap spectrum with t p 16 s h s 15 m γ 2 5 and has been spread using equation 5 with σ θ 20 the synthetic time history for this case was generated using second order random wave theory the time history was further processed to obtain the underlying η and the free wave spectrum the lwd attains a sharp minimum at σ θ 20 exhibiting how well edm works 3 results the simplest sea state for which the assumption of frequency independent directional spreading does not hold is the commonly encountered wind swell sea state swell usually tend to have a narrower directional spreading while the opposite is true for the wind component the first sub section that follows addresses this case while the other two sub sections addresses frequency dependent directional spreading after ewans 1998 and the implications of findings on design calculations respectively 3 1 mixed seas to study the predictions from edm when it is applied assuming a frequency independent directional spread for mixed sea states synthetic time histories were generated for a range of sea states for all sea states considered in this sub section a wrapped normal type dsf with σ θ 15 for swell and σ θ 25 for the wind component were chosen the spectrum was discretised with δ ω 9 82 10 3 rad s and δ θ 5 over 90 θ 90 the spectral shape for the swell component was gaussian with σ 15 s 1 and t p 14 s while that for the wind component was jonswap with γ 2 5 and t p 16 s the total h s 15 m for the whole sea state was maintained while the proportion of swell and wind in the spectrum was varied the ratio of the relative strength of the two components was defined as 12 α h s w h s s where h s w refers to the h s of the wind component while h s s correspond to the swell component for the sea states considered in the present study α was varied from 0 3 10 0 fig 3 a and b provides the frequency direction spectrum for α 10 and 0 3 respectively the frequency axis has been normalised by the peak frequency associated with the swell component in both figures as expected for α 10 where the wind component dominates the spectrum is much broader in both frequency and direction with a large spread of energy compared to the α 0 3 case where the narrower swell component dominates fig 3 c and d provides the corresponding frequency spectrum for α 10 and 0 3 respectively the individual wave systems are also plotted in the two sub figures for all of these cases edm was applied to the synthetic time histories generated using second order random wave theory by assuming that the underlying dsf is independent of frequency fig 4 provides the long wave discrepancy as a function of σ θ for α 10 1 0 and 0 3 respectively for all the three cases the lwd function attains a minimum which is marked with a square in the sub figures it is apparent from the location of this square marker that the σ θ of the dsf that is predicted by edm is biased towards the σ θ value of the dominant wave system for example taking fig 4 a which corresponds to α 10 σ θ 24 5 here the wind component dominates and for this component σ θ 25 motivated by this observation a weighted spreading was defined as 13 σ w i 1 n f σ θ ω s η η ω i 1 n f s η η ω where n f is the number of frequency components in the discretised frequency spectrum fig 5 provides a comparison between σ w and the σ θ associated with the minimum lwd for each α overall a good agreement is obtained with differences of a few degrees this shows that when edm is applied under the assumption of frequency independent directional spreading the prediction for mixed sea states is the weighted average σ θ of the two wave systems so far the edm has been applied to the mixed sea states by assuming that the dsf is the same for both wind and swell components however sophisticated techniques exist for separating the swell and wind components see ewans et al 2006 from a point measurement therefore it is practically possible to assign an individual dsf to the two components in a mixed sea for the α 1 0 case edm was applied in this manner since the two wave systems are known no attempt was made to separate them using an advanced technique from the synthetic time history for computing lwd σ θ was varied for both the swell and wind components separately and computed for each possible pair of σ θ fig 6 provides the lwd obtained for all the pairs of σ θ a sharp minimum in lwd is obtained for σ θ 15 for the swell component and σ θ 25 for the wind component which coincides with the input this provides a proof of concept that edm can be applied to mixed sea states and the directional spreading for individual components can be ascertained accurately however it should be highlighted that the number of computationally intensive second order calculations goes up dramatically as a large number of pairs of σ θ values needs to be considered in addition this procedure is still subject to the accurate separation of wind and swell components 3 2 frequency dependent spreading to investigate the predictions from edm when the underlying dsf is frequency dependent a number of synthetic time histories were again generated using second order random wave theory just like what was adopted in 3 1 the underlying spectrum was discretised with δ ω 9 82 10 3 rad s and δ θ 5 also a jonswap spectrum with h s 15 m and t p 16 s was used to generate the time histories the peak enhancement factor γ was varied from 1 0 to 7 0 and for each case a wrapped normal type dsf was adopted with σ θ f provided by equation 7 for each case edm was applied under the assumption of frequency independent directional spread fig 7 provides a comparison between σ θ predicted by edm for each γ and the spectrally averaged σ θ computed from equation 13 just like that for mixed seas fig 5 the two lines are in close agreement with the maximum difference lower than 1 taking these results for ewans spread and mixed sea states previous sub section as a whole it can be concluded that when edm is applied with the assumption of frequency independent spreading the dsf that is predicted is close to that of the spectrally averaged dsf 3 3 implications for design having confirmed that the prediction from edm relate to the spectrally averaged spreading value it is important to investigate the practical implication of this finding in this investigation the commonly adopted velocity reduction factor vrf was used vrf is defined as 14 v r f rms in line velocity in directional sea rms velocity in a uni directional sea for design problems such as computation of forces on structures which require the water particle kinematics vrf provides a quick way of modifying the corresponding uni directional quantities in fact the same procedures that are used for uni directional waves can readily be used by modifying the water particles kinematics with the vrf hence accurate values for vrf are important from the perspective of designers for both the mixed and ewans spread sea states vrf was computed using equation 14 and will be denoted as vrf a vrf was also computed for the spectrally averaged σ θ and also that predicted by edm and will be denoted by vrf p in the subsequent discussion fig 8 provides a comparison of the ratio v r f a v r f p for the spectrally averaged σ θ and that predicted by edm for both mixed seas and ewans spread seas vrf based upon the spectrally averaged σ θ provides excellent agreement with the true vrf with differences less than 0 5 similarly vrf based upon σ θ predicted by edm is also in close agreement with the true vrf the errors for mixed sea states are lower and remain within 0 5 while that for ewans spread cases are slightly higher at 1 5 4 conclusions edm is a relatively new and powerful method that can resolve the underlying directional spread from a single point measurement of the surface elevation the application of this method to field data have been undertaken so far by assuming that the underlying directional spreading is independent of frequency in the present work edm has been applied under the assumption of frequency independent directional spreading to two cases with frequency dependent directional spreading mixed wind swell sea and sea state with ewans 1998 spreading for the mixed wind swell sea states edm predicted σ θ that remained close to the σ θ value of the dominant component of the mixed sea state further investigation showed that in fact the predictions tallied well with the spectrally averaged σ θ values another important finding for mixed sea states was that edm can be successfully applied by assigning different σ θ values for swell and wind components this is an important finding as once field data from a point measurement has been decomposed into swell and wind components edm can be applied to ascertain the spreading of individual wave systems this is of immense interest to regions such as southern south china sea where the swell component can be dominant see amurol and ewans 2019 and latheef et al 2020 similar to the mixed seas application of edm to sea states with frequency dependent ewans 1998 spreading predicted σ θ values that tallied well with the spectrally averaged σ θ values therefore it can be concluded that when edm is applied under the assumption of frequency independent spreading the dsf it produces is very close to the spectrally averaged dsf to investigate the implication of using σ θ predicted by edm under the assumption of a frequency independent directional spreading the commonly used v r f was used as a measure it was found that the real vrf values computed based upon the input directional spectrum agreed well with those based upon the dsf predicted from edm in fact vrf values remained within 1 5 therefore it is reasonable for typical design applications to be based upon the dsf predicted by edm under the assumption of frequency independent spreading the results in this paper are based upon synthetic time histories for which the inputs are known rather well in addition these data do not suffer from typical artefacts in real data such as noise for future work as a first step it is suggested that edm be applied to field data for mixed sea states in fact the authors have access to such data recorded in southern south china sea along with corresponding validated hindcast predictions the work is underway and will be reported in a future publication credit authorship contribution statement mohamed latheef data analysis part of writing up do kyun kim data analysis part of writing up funding this research is funded by yutp grant no 015lc0 096 declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper 
20804,an adaptive control design for dynamic positioning of unmanned surface vessels having actuator dynamics baris bidikli conceptualization methodology software formal analysis investigation writing original draft writing review editing department of mechatronics engineering faculty of engineering and architecture izmir katip celebi university izmir 35620 turkey department of mechatronics engineering faculty of engineering and architecture izmir katip celebi university izmir 35620 turkey department of mechatronics engineering izmir katip celebi university izmir 35620 turkey an adaptive control design for dynamic positioning dp of unmanned surface vessels is addressed in this study the control design is realized by taking actuator dynamics into account for obtaining a dp system where distribution of generalized forces to the actuators is considered owing to this approach dp system is made suitable for unmanned surface vessels having actuators equal to or more than number of generalized forces all parameters of the surface vessel s body and actuator dynamics except thrust configuration matrix are assumed to be uncertain for the proposed control design the parametric uncertainties are coped with adaptive compensation rules while the designed controller is equipped with a term that provides the robustness of the designed controller against disturbances including internal and external unmodeled effects backstepping control design approach is preferred for the control design process by considering the appropriateness of this approach for the system model of unmanned surface vessels include actuator dynamics theoretical proof of the designed controller is realized via lyapunov based arguments simulation studies where the efficiency of the designed controller is observed for both of aforementioned cases are conducted for the performance demonstration of the designed controller keywords surface vessels actuator dynamics dynamic positioning adaptive control backstepping control 1 introduction systems used to keep surface vessels on a predetermined position and heading via appropriate thruster and propeller actions are called as dynamic positioning dp systems owing to their advantages such as working properly in deep sea high positioning accuracy and avoiding damaging seabed they have been frequently preferred in offshore operations i e offshore oil and gas drilling underwater cable and pipe laying wreck investigation and etc since the mid 1960s fossen 2011 du et al 2016 the mentioned advantages especially high positioning accuracy are directly related with efficiency of the dp control system moreover when the other effects involved in control process are considered it can be decided that dp control system design is a challenging task this challenge and the ongoing need in the ship industry make dp control system design an attractive topic in the research area of control an efficient dp system must be robust against uncertain system dynamics and must be able to compensate environmental forces and other disturbances including internal and external unmodeled effects in fossen 2011 it was clearly indicated that these are the most important design requirements and the designed full state feedback controller cannot work properly unless these requirements are met when the literature about this subject is examined it is seen that almost all available dp control systems were designed by considering these design requirements while linear control techniques such as proportional integral derivative pid controller supported with low pass or notch filters had been preferred at the beginning of the subject than more advanced output control techniques such as optimal control supported with kalman filtering techniques started to dominate the literature in these type of studies kalman filtering technique was generally preferred as disturbance and or environmental effect estimator balchen et al 1976 balchen et al 1980 grimble and johnson 1988 fossen 1994 mandzuka and vukic 1995 sorensen et al 1996 katebi et al 1997 moreover some nonlinear control techniques such as fuzzy controller chang et al 2002 nonlinear pid controller torsetnes et al 2004 proposed as dp control systems by considering nonlinear ship dynamics can be encountered in relatively older studies nonlinear control approaches that meet the mentioned design requirements were preferred much more in recent studies in benetazzo et al 2015 fault tolerant control supported with multirate extended kalman filter for wave compensation was used for dp of an offshore supply vessel vectorial backstepping method was used in the adaptive fuzzy controller for dp system of vessels in hu et al 2015 model predictive control was another preferred control technique that meet the aforementioned design requirements for dp control system veksler et al 2016 in bidikli et al 2016 dp of an unactuated surface vessel directed via multiple unidirectional tugboats was provided via a full state feedback nonlinear robust controller another robust nonlinear controller design that is able to provide dp of ships in the presence of disturbances and input saturation was presented in du et al 2016 in hassani et al 2017 mixed μ synthesis modeling based robust dp control design for offshore vessels was presented a robust nonlinear control design for dp of marine vessels was presented in hu and du 2018 in the mentioned study a robust nonlinear controller that is able to cope with uncertain system dynamics and environmental disturbances was designed by including thruster dynamics for dp of marine vessels for the mentioned design it was assumed that the nominal values of the system parameters and actuator model are perfectly known and number of thrusters is equal to number of generalized control forces in li et al 2020 dp of ships was provided via robust adaptive prescribed performance control in the presence of unknown disturbance and input constraints a robust neural event triggered control design that is able to cope with actuator faults was proposed in zhang et al 2020 for providing dp of unmanned surface vessels in wang et al 2020 an adaptive fuzzy controller was proposed for dp of unmanned surface vessels almost all of the aforementioned studies and many of the studies in the literature directly focused on designing generalized control forces to provide dp of marine vessels however in fossen 2011 it was clearly indicated that distributing these forces to the actuators is one of the main necessities for dp control system design taking the actuator dynamics into account is one of the most feasible way to realize this distribution in addition to this it was also indicated that although the most of the control designs for marine vessels were done under the assumption that the actuator dynamics are negligible this assumption is restrictive for most of the ships when these facts are considered it can be reached that taking the actuator dynamics into account is a feasible way to obtain a realistic control design however the control problem becomes more complicated in this case according the number of actuators in compare to number of generalized control forces effective on the ship the distribution of generalized forces may need to be made on actuators equal to or more than the number of generalized forces in the limited number of studies where the actuators dynamics were taken into account only the case where number of generalized forces and number of actuators are equal was considered since the input gain matrix contains configuration of thrusters and propellers becomes a square matrix control design process is relatively less complex for this case however designing a controller by considering both of aforementioned cases is a more feasible approach and can be considered as a good contribution for this literature designing an adaptive controller that provides aforementioned design requirements for dp system of unmanned surface vessels is the main purpose of this study the control design is realized in the presence of actuator dynamics and owing to its generalized structure it can be used for both of the aforementioned force distribution scenarios the designed controller is based on the assumption that all parameters of the surface vessel are uncertain except thrust configuration matrix which is available for all commercial vessels owing to this approach a control design that can be used for dp of different type of commercial surface vessels is obtained the parametric uncertainties are coped with via adaptive compensations of uncertain system parameters theoretical analysis of the designed controller is realized via lyapunov based arguments while its performance is verified via simulation results these simulations is realized for the cases where generalized forces of 3 degree of freedom dof unmanned surface vessel are distributed on 3 and 6 actuators respectively presenting the efficiency of the main contribution of the designed controller is the main purpose of realizing simulation studies for two different cases 2 system model and properties theorem 1 the dynamic model of 3 dof unmanned surface vessel includes actuator dynamics is given as fossen 1994 fossen and berge 1997 fossen 2011 1 η r η ν 2 m ν c η ν d ν g η b u 3 t u u u c in this model surface vessel s body dynamics are given in 1 and 2 in these equations the position and body fixed velocity vectors are denoted by η x y ψ t and ν u v r t r 3 respectively the rotation matrix in yaw is represented by r η r 3 3 while the inertia matrix including hydrodynamic added mass effect coriolis sentripetal matrix including hydrodynamic added inertia and hydrodynamic damping matrix are denoted by m c η and d r 3 3 respectively moreover g η r 3 represents the vector of gravitational and buoyancy forces the constant matrix b r 3 n represents the thrust configuration matrix and u r n denotes the vector of actuator states in the actuator dynamics given in 3 t r n n denotes the diagonal and constant matrix of actuator time constants and u c r n denotes the vector of control inputs terms of the given dynamic model satisfy the following properties fossen 1994 fossen and berge 1997 fossen 2011 property 1 inertia matrix m is a positive definite i e x t m x 0 x r 3 and symmetric matrix i e m t m property 2 coriolis sentripetal matrix c is a skew symmetric matrix i e c t c and satisfies the property given as x t c x 0 x r 3 property 3 thrust configuration matrix b in 2 is known for all commercial unmanned surface vessels and b b t is a nonsingular matrix property 4 measurements of all states including actuator states are available and can be used in control design remark 1 at this point it should be noted that properties 1 4 are standard properties for these type of surface vessels and they can be reached from many studies about mathematical modeling an d control of such systems all of the remaining properties and designs presented in this study are based on these standard properties by considering their validity and generalizability the surface vessel s body dynamics in 1 and 2 can be arranged as follows by substituting the time derivative of 1 into 2 and by taking the external and internal disturbance effects into account 4 j η η c η η η η f η η g η η f d t r η b u where the orthogonality of the rotation matrix is utilized and the dynamic terms j η c η η η f η r 3 3 and g η η r 3 are defined as 5 j η r η m r η t 6 c η η η r η m r η t r η c η r η t 7 f η r η d r η t 8 g η η r η g η in 4 f d t r 3 denotes a function that represents slowly varying forces due to ocean currents second order wave drift forces unmodeled dynamics and other disturbances in the control of marine vessels all of the mentioned effects appear as uncertain but bounded effects and this situation makes f d t is an uncertain but a bounded function fossen 2011 when their structures are examined it can be seen that terms of the dynamical model in 5 8 satisfy the following properties property 5 the j and c η matrices satisfy the following skew symmetry property 9 x t 1 2 j c η x 0 x r 3 property 6 the terms of the dynamic model in 4 j c η f and g η satisfy the following bounds 10 j φ i b j 1 11 j φ j φ i b j 2 φ φ 12 c η φ φ i b c φ 13 f φ i b f 1 14 f φ f φ i b f 2 φ φ 15 g η φ g η φ i b g φ φ φ i φ γ r 3 in 10 15 i denotes the induced infinity norm and the positive bounding constants are denoted by b j 1 b j 2 b c b f 1 b f 2 and b g r property 7 the mathematical model in 4 can be written in the following linearly parametrized form 16 y 1 η η η θ 1 f d t r η b u where y 1 r 3 r 1 represents the regression matrix while θ 1 r r 1 represents the vector of uncertain system parameters the term y 1 η η η θ 1 is defined as 17 y 1 η η η θ 1 j η η c η η η η f η η g η η the linearly parametrized form of the mathematical model is presented in a detailed manner in section 8 1 property 8 the model of actuator dynamics in 3 can be written in the following linearly parametrized form 18 y 2 u u θ 2 u c where y 2 r r r 2 represents the regression matrix while θ 2 r r 2 represents the vector of uncertain parameters of actuator dynamics 3 error system development the error between the predetermined position and heading and the measured position and heading is denoted by e 1 t r and defined as 19 e 1 η d η where η d r 3 denotes the vector of desired position and heading where the surface vessel is needed to be kept constant the additional auxiliary errors e 2 t r n and r t r 3 are defined as 20 e 2 u v u 21 r e 1 α e 1 where u v r n denotes the virtual control input and α r 3 3 denotes the positive definite diagonal and constant gain matrix remark 2 in the backstepping control design approach first the virtual control input is designed and it is theoretically shown that zero convergence of the tracking error can be obtained when the virtual control input is used instead of one of the system states then the actual control input is designed to cope with the error between the virtual control input and the mentioned state as a result a control input that can be used to obtain the zero convergence of the tracking error is obtained since the design of the control input is theoretically based on the design of virtual control input it is not wrong to say that the virtual control input defined in 20 has a great importance in the control design in this study the virtual control input u v is used instead of vector of actuator state s u to obtain the zero convergence of the error in 19 therefore the auxiliary error e 2 is defined as the difference between virtual control input and the vector of actuator states remark 3 another point that should be noted about the virtual control input at this point is that it does not have any effect onto the control process it does not provide any advantage or disadvantage and affect transient state and or steady state into the application although the virtual control input does not have any effect into the application it provides a theoretical base for the design of the actual control input that is directly applied to the system into the application in other meaning design of the virtual control input is a step in the control design and analysis process with an important theoretical aspect the adaptive and system parameters independent structure of the designed controller is provided via adaptive compensations of vector of uncertain parameters denoted by θ ˆ 1 r r 1 and θ ˆ 2 r r 2 the adaptive compensation errors denoted by θ 1 r r 1 and θ 2 r r 2 are defined as follows by considering this purpose 22 θ 1 θ ˆ 1 θ 1 23 θ 2 θ ˆ 2 θ 2 4 control design the control design approach is presented in a detailed manner in this section firstly the design process of a virtual control input is introduced and as it is stated in remark 2 it is shown that zero convergence of the tracking error can be satisfied when the virtual control input is used instead of vector of actuator states u however as it can be seen from the structure of the system s model in 1 3 u is not an input but another state for surface vessels and it can be controlled via an actual control input u c in the continuing part of the design the actual control input is designed to guarantee that vector of actuator states u converge to virtual control input u v as a result an actual control input that guarantees the zero convergence of e 1 is obtained to obtain the open loop error dynamics for the virtual control input design time derivative of 21 is pre multiplied with j η 24 j η r j η η d c η η η η f η η g η η f d t r η b u j η α e 1 where 4 19 and 21 are utilized the virtual control input is designed as 25 u v b t b b t 1 r t y 1 d θ ˆ 1 k 1 r φ f d tanh r where k 1 r 3 3 denotes a positive definite diagonal and constant gain matrix φ f d r 3 3 denotes a positive definite diagonal and constant matrix whose diagonal entries are positive bounding terms of f d tanh represents hyperbolic tangent function and θ ˆ 1 is updated according the rule given as 26 θ ˆ 1 y 1 d t r at this point it should be noted that the matrix y 1 d η d η d η d r 3 r 1 is obtained by replacing η η and η with the desired position and its time derivatives into the regression matrix y 1 defined in 16 remark 4 for the completeness of the demonstration the terms η d and η d are used in the brackets of y 1 d in the above notation however since the desired position is selected as a constant term time derivatives of the desired position are obtained as vector of zeros in dp control systems the multiplication of y 1 d with θ 1 is defined as 27 y 1 d θ 1 j η d η d c η η d η d η d f η d η d g η η d where 17 is utilized the closed loop error dynamics of this part can be obtained as follows when the virtual control input design in 25 is written instead of u in 24 and 22 is utilized 28 j η r χ 1 c η η η r y 1 d θ 1 k 1 r f d φ f d tanh r where χ 1 r 3 is an auxiliary function defined as 29 χ 1 j η j η d η d g η η d g η η c η η η c η η d η d η d c η η η d α e 1 f η f η d η d f η η η d α j η r α e 1 remark 5 at this point it should be stated that the following upper bound can be satisfied for χ 1 30 χ 1 ρ 1 e 1 e 1 ρ 2 e 1 r ρ 3 where ρ 1 e 1 and ρ 2 e 1 r are positive nondecreasing functions of their arguments ρ 3 r is a positive bounding constant and 10 15 19 and 21 are utilized proof 1 see section 8 2 for the proof for the preliminary analysis the nonnegative auxiliary function v 1 e 1 r θ 1 r is defined as 31 v 1 1 2 e 1 t e 1 1 2 r t j r 1 2 θ 1 t θ 1 the time derivative of 31 is obtained as 32 v 1 e 1 t e 1 1 2 r t j r r t j r θ 1 t θ 1 the above equation can be rearranged as follows by substituting e 1 from 21 θ 1 from time derivative of 22 and j r from 28 33 v 1 e 1 t α e 1 r t k 1 r e 1 t r r t χ 1 θ 1 t θ ˆ 1 y 1 d t r r t f d φ f d tanh r where the term 1 2 r t j r is canceled with the term r t c η r that is obtained from 28 owing to the skew symmetry property given in 9 from the aforementioned analysis it can be seen that its validity directly depends on the zero convergence of the auxiliary error e 2 the analysis presented after this point is realized to show that u converges to u v during the control process the open loop error dynamics can be obtained by premultiplying of the time derivative of 20 with t and rearranging the resulting equation as 34 t e 2 t u v u c u where 3 is utilized the control input is designed as 35 u c y 2 v θ ˆ 2 k 2 e 2 where k 2 r n n denotes a positive definite diagonal and constant gain matrix and θ ˆ 2 is updated according the rule given as 36 θ ˆ 2 y 2 v t e 2 at this point it should be noted that the matrix y 2 v u v u v r n r 1 is obtained by replacing u v and u v with vector of actuator states and its time derivative into the regression matrix y 2 defined in 18 remark 6 in fossen 2011 it was clearly indicated that the dynamic positioning system must be capable to compensate the bounded disturbances including environmental unmodeled internal and external effects since the full state feedback controllers may not work properly in the presence of these effects all of the mentioned effects are expressed via disturbance function f d in 4 by equipping the virtual control design in 25 with an extra term i e φ f d t a n h r and by using this virtual control input into the actual control input design a controller that is able to cope with the mentioned effects is obtained remark 7 3 dof unmanned surface vessels may have more than 3 actuators 3 actuators or 2 actuators for the last case dp control system design is realized with a completely different approach in this approach a path planning is realized where one position and heading are directly controlled while the remaining position is indirectly controlled according to the planned path however for the remaining cases a slightly different system model is obtained where the dimensions of thrust configuration matrix b change although this may seem like a minor change if it cannot be taken into account in the control design it prevents the design from being usable in either case for providing the efficient distribution of the generalized forces to the actuators for both of these cases b t b b t 1 term is used in the virtual control design and than the actual controller is designed by including the virtual control design according to the authors best knowledge this approach is the most important contribution that distinguishes this study from its counterparts in the literature the closed loop error dynamics can be arranged as follows by substituting 35 into 34 and utilizing 20 and 23 into the resulting equation 37 t e 2 y 2 v θ 2 k 2 i n e 2 where i n r n n denotes the standard identity matrix 5 stability analysis theorem 2 the semi global asymptotic stability of error terms e 1 t e 2 t and r t that can mathematically be shown as 38 e 1 t e 2 t r t 0 a s t and the boundedness of all signals under the closed loop operation can be provided by using the control input design in 35 with the virtual control input design in 25 and the update laws of θ ˆ 1 and θ ˆ 2 given in 26 and 36 respectively proof 2 the nonnegative lyapunov function candidate v e 1 e 2 r θ 1 θ 2 r is selected as 39 v v 1 1 2 e 2 t t e 2 θ 2 t θ 2 time derivative of 39 is obtained as 40 v e 1 t α e 1 r t k 1 r e 1 t r r t χ 1 r t f d φ f d t a n h r e 2 t k 2 i r e 2 θ 1 t θ ˆ 1 y 1 d t r θ 2 t θ ˆ 2 y 2 v t e 2 where 23 33 and 37 are utilized from 40 it can be seen that if θ ˆ 1 and θ ˆ 2 are updated according to the rules given in 26 and 36 the final form of 39 is obtained as 41 v e 1 t α e 1 r t k 1 r e 1 t r r t χ 1 r t f d φ f d t a n h r e 2 t k 2 i r e 2 final form of the time derivative of the lyapunov function candidate v in 41 can be upper bounded as 42 v λ m i n α 1 2 1 4 ρ 1 2 e 1 2 λ m i n k 1 5 2 ρ 2 r 2 1 4 ρ 3 2 r t f d φ f d t a n h r λ m i n k 2 1 e 2 2 1 2 ρ 1 e 1 r 2 1 2 ρ 3 r 2 1 4 ρ 3 2 r t f d φ f d t a n h r where the fact x 1 t x 2 1 2 x 1 2 1 2 x 2 2 x 1 x 2 r p is utilized and 1 4 ρ 3 2 is added to both sides from the above inequality it can be seen that for the following selections of constant gains 43 α ℓ 1 2 1 4 ρ 1 2 44 k 1 ℓ 5 2 1 4 ρ 2 45 k 2 ℓ 1 and for the sufficiently high selection of φ f d a more compact form of 42 can be written as 46 v β 1 z 2 β 2 where a ℓ denotes the ℓ t h diagonal element of the matrix denoted by a in 42 β 1 r denotes a positive constant selected as 47 β 1 min λ m i n α 1 2 1 4 ρ 1 2 λ m i n k 1 5 2 ρ 2 λ m i n k 2 1 and β 2 r is an another auxiliary positive constant selected as 48 β 2 1 2 ρ 1 e 1 r 2 1 2 ρ 3 r 2 1 4 ρ 3 2 r t f d φ f d tanh r and vector of combined errors z t r 6 n is defined as 49 z e 1 t e 2 t r t t from 41 and 46 it can be guaranteed that e 1 t e 2 t r t θ 1 t and θ 2 t l after integrating 46 the resulting expression is obtained as 50 t 0 z σ 2 d σ v 1 t 0 β 1 from the statement in 50 it is seen that z t l 2 boundedness of all of the remaining signals under the closed loop operation including the time derivative of z t can be shown via standard signal chasing arguments barbalat s lemma krstic et al 1995 can be used along with the boundedness of z t and z t l 2 l information to guarantee that z t 0 as t this result can be used with 49 to show that error terms e 1 t e 2 t and r t asymptotically converge to zero 6 simulation results simulations were conducted for the same nonlinear supply vessel for two different scenarios in the first scenario it was assumed that the desired position and heading were tried to be reached via 6 actuators and in the second scenario it was assumed that the control purpose is tried to be provided via 3 actuators bis scaling model parameters of the nonlinear supply vessel used in simulation studies are given as fossen 2011 51 m 1 1274 0 0 0 1 8902 0 0744 0 0 0744 0 1278 52 c ν 0 0 0 0 1 8902 v 0 0744 r 1 1274 u 1 8902 v 0 0744 r 1 1274 u 0 53 d 0 0414 0 0 0 0 1775 0 0141 0 0 1073 0 0568 54 r η cos ψ sin ψ 0 sin ψ cos ψ 0 0 0 1 the transformation between bis scaled states and physical quantities was realized according to following formulas 55 η d i a g 76 2 76 2 1 η 56 v d i a g 746 8 746 8 0 13 ν the desired position was selected as 57 η d 10 m 5 m 10 d e g t for observing that the designed controller can be efficiently used to reach the control purpose in the presence of different kinds of disturbances a sinusoidal perturbation having the following structure 58 f d 0 5 sin 20 π t 0 25 sin 20 π t 0 5 sin 20 π t t and additive white gaussian noise with 110 signal to noise ratio were applied to the system simultaneously for the case the surface vessel having 6 actuators thrust configuration and actuator matrices are given as b 10 3 13 13 0 0 0 0 11 6 11 6 0 0 4 6 4 6 59 0 0 6 6 7 2 7 2 2 60 t 1 7964 i 6 for a vessel with a length of 76 2 m at this point it should stated that the above bis scaled matrices were given in accordance with the nonlinear supply vessel model presented in this section and by considering that the actuator time constants of all thrusters and propellers were chosen as 5 s control gains were selected as 61 a d i a g 1 1 1 62 φ f d d i a g 2 5 7 5 2 5 63 k 1 d i a g 1 5 2 5 1 64 k 2 d i a g 5 1 1 1 1 1 as a result of the simulations positioning results were obtained as in fig 1 while positioning errors can be seen from fig 2 from these figures it can be observed that dynamic positioning was performed in approximately 3 s and then the position can be maintained under the effect of disturbances by considering these issues it can be said that the control purpose was efficiently met the control inputs and the forces acting on the surface vessel as a result of the application of these control inputs can be seen from figs 3 and 5 respectively moreover changes of control inputs and forces in the first 3 s are given in figs 4 and 6 respectively observing the change of control inputs in the period from beginning of control process to time when dynamic positioning was achieved is the main purpose of giving these figures from these figures it can be seen that since the error between the predetermined position and the initial conditions was too much the control inputs tried to reduce the difference by giving sudden reactions as the error value decreases the interval in which the control inputs change also decreases it can be seen from figs 3 and 5 that after dynamic positioning was achieved the control inputs change in a very small interval compared to the initial interval and continue to maintain the position of the surface vessel for the case surface vessel having 3 actuators thrust configuration and actuator matrices are given as 65 b 10 3 26 0 0 0 23 2 13 7 0 9 2 4 9 66 t 1 7964 i 3 for a vessel with a length of 76 2 m at this point it should stated that the above bis scaled matrices were given in accordance with the nonlinear supply vessel model presented in this section and by considering that the actuator time constants of all thrusters and propellers were chosen as 5 s control gains were selected as 67 a d i a g 1 1 1 68 φ f d d i a g 2 5 8 5 2 5 69 k 1 d i a g 1 1 2 9 1 70 k 2 d i a g 5 1 1 as a result of the simulations positioning results were obtained as in fig 7 while positioning errors can be seen from fig 8 from these figures it can be observed that as in the previous scenario the control objective was effciently met in this scenario the control inputs and the forces acting on the surface vessel as a result of the application of these control inputs can be seen from figs 9 and 11 respectively moreover changes of control inputs and forces in the first 3 s are given in figs 10 and 12 respectively observing the change of control inputs in the period from beginning of control process to time when dynamic positioning was achieved is the main purpose of giving these figures from these figures it can be observed that similar results to the previous case were also obtained for this case this is an expected result as the simulations were performed on the same surface vessel having a slightly modified actuator model and similar interpretations are also valid for this case 7 conclusions in this study an adaptive nonlinear controller was designed for dp of unmanned surface vessels in the presence of actuator dynamics for this design it was assumed that all system parameters are uncertain except the thrust configuration matrix the parametric uncertainties were coped with adaptive compensation rules while the controller was designed by basing on these rules and the full state feedback in contrast to many dp studies available in the literature actuator dynamics were taken into account in the control design owing to this approach a design which is considered as one of the basic needs of dp control system design was presented in which the distribution of control forces can be performed efficiently by including the actuator dynamics in the model and making the necessary arrangements a two stage model was obtained for unmanned surface vessels backstepping control design approach which is considered as a feasible control design approach for such systems was utilized for the control design in this approach firstly the force input that must be applied to bring the unmanned surface vessel to the desired position and heading was obtained then the actual control input that provides an appropriate distribution of these forces to actuators to produce it efficiently was designed for providing another main necessity of dp control system design the controller was equipped with a term that is able to compensate the effects of disturbances in contrast to the limited number of studies available in the literature where actuator dynamics were taken into account this design was implemented in such a way that can provide the dp of the surface vessels whose actuator numbers are equal to the number of generalized forces and greater than the number of generalized forces since both of these cases can be encountered in commercial dp systems designing a controller that can be used for both of these cases can be considered as the main contribution of this study the theoretical proof of the designed controller was realized via lyapunov based arguments while its performance was demonstrated via numerical simulation results providing a controller that can be used for different type of unmanned surface vessels was one of the main goals while performing the control design and the presented controller can be used for all commercial surface vessels where the full state feedback is available however while almost all large and medium sized unmanned surface vessels have measurement devices that provide full state feedback some small unmanned surface vessels especially are not equipped with these type of measurement devices designing a version of this controller that does not require full state feedback is considered as a possible future work to make this control design available for these type of unmanned surface vessels taking the actuator dynamics into account and designing a controller for this scenario is one of the main contributions of this study however partial knowledge of the actuator model was utilized while reaching the control purpose although the known model parameters are assumed to be available for all commercial surface vessels designing a controller that is completely independent from system and model parameters may become much better in terms of generalizability and applicability of the designed controller designing this type of controller and comparing its control performance onto the dynamic positioning of more than one surface vessels having different actuator dynamics is considered as another future work experimental verification is also aimed credit authorship contribution statement baris bidikli conceptualization methodology software formal analysis investigation writing original draft writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper 8 appendices 8 1 linear parametrization of body dynamics of 3 dof surface vessels general forms of rigid body dynamics of 3 dof surface vessels defined in 1 and 2 are given as 72 m m 11 0 0 0 m 22 m 23 0 m 32 m 33 73 c ν 0 0 0 0 c 1 v c 2 r c 3 u c 1 v c 2 r c 3 u 0 74 d d 11 0 0 0 d 22 d 23 0 d 32 d 33 75 r η cos ψ sin ψ 0 sin ψ cos ψ 0 0 0 1 where m 11 m 33 r are constant terms of inertia matrix c 1 c 3 r are constant coefficients of coriolis sentripetal matrix d 11 d 33 r are constant terms of hydrodynamic damping matrix and since the gravitational and buoyancy forces are outbalanced by each other vector of gravitational and buoyancy forces is given as g η 0 3 if the linearly parametrized form in 17 is applied with the dynamics in 72 75 elements of the regression matrix y 1 η η η r 3 13 are obtained as 76 y 1 11 x y ψ cos ψ 2 y x ψ sin ψ cos ψ 77 y 1 12 x y ψ sin ψ 2 y x ψ sin ψ cos ψ 78 y 1 13 0 79 y 1 14 ψ sin ψ 80 y 1 15 0 81 y 1 16 ψ cos ψ v 82 y 1 17 ψ cos ψ r 83 y 1 18 ψ sin ψ u 84 y 1 19 x cos ψ 2 y sin ψ cos ψ 85 y 1 110 x sin ψ 2 y sin ψ cos ψ 86 y 1 111 ψ sin ψ 87 y 1 112 0 88 y 1 113 0 89 y 1 21 x y ψ sin ψ cos ψ y x ψ sin ψ 2 90 y 1 22 x y ψ sin ψ cos ψ y x ψ cos ψ 2 91 y 1 23 ψ cos ψ 92 y 1 24 0 93 y 1 25 0 94 y 1 26 ψ sin ψ v 95 y 1 27 ψ sin ψ r 96 y 1 28 ψ sin ψ u 97 y 1 29 x sin ψ cos ψ y sin ψ 2 98 y 1 210 x sin ψ cos ψ y cos ψ 2 99 y 1 211 ψ cos ψ 100 y 1 212 0 101 y 1 213 0 102 y 1 31 0 103 y 1 32 0 104 y 1 33 0 105 y 1 34 x sin ψ y cos ψ x ψ cos ψ y ψ sin ψ 106 y 1 35 ψ 107 y 1 36 x cos ψ y sin ψ v 108 y 1 37 x cos ψ y sin ψ r 109 y 1 38 x cos ψ y sin ψ u 110 y 1 39 0 111 y 1 310 0 112 y 1 311 0 113 y 1 312 x sin ψ 114 y 1 313 ψ where y 1 i j r denotes the element of y 1 placed in j t h column of i t h row at this point it should be noted that since terms of body fixed velocity vector can be expressed as follows by utilizing 1 and 75 115 u x cos ψ y sin ψ 116 v x sin ψ y cos ψ 117 r ψ all elements of the regression matrix can be expressed in terms of elements of η η and η for the above terms of regression matrix vector of uncertain system parameters θ 1 r 13 can be obtained as 118 θ 1 m 11 m 22 m 23 m 32 m 33 c 1 c 2 c 3 d 11 d 22 d 23 d 32 d 33 t 8 2 proof of bound of χ 1 according to the definition of χ 1 in 29 its norm can be upper bounded as 119 χ 1 b j 2 η d e 1 b g e 1 b c η d α e 1 r η d α e 1 b c η d 2 b f 2 η d e 1 b f 1 r α e 1 α b j 1 r α e 1 b j 2 η d b g b c 2 η d α b f 2 η d b f 1 α b j 1 α 2 e 1 b c η d α e 1 b f 1 b j 1 α r 2 b c η d 2 upper bound in 30 can be obtained by considering the following definitions 120 ρ 1 e 1 b j 2 η d b g b c 2 η d α b f 2 η d b f 1 α b j 1 α 2 b c α 2 ρ 2 e 1 b c η d α e 1 b f 1 b j 1 α ρ 3 2 b c η d 2 where 10 15 19 and 21 are utilized 
20804,an adaptive control design for dynamic positioning of unmanned surface vessels having actuator dynamics baris bidikli conceptualization methodology software formal analysis investigation writing original draft writing review editing department of mechatronics engineering faculty of engineering and architecture izmir katip celebi university izmir 35620 turkey department of mechatronics engineering faculty of engineering and architecture izmir katip celebi university izmir 35620 turkey department of mechatronics engineering izmir katip celebi university izmir 35620 turkey an adaptive control design for dynamic positioning dp of unmanned surface vessels is addressed in this study the control design is realized by taking actuator dynamics into account for obtaining a dp system where distribution of generalized forces to the actuators is considered owing to this approach dp system is made suitable for unmanned surface vessels having actuators equal to or more than number of generalized forces all parameters of the surface vessel s body and actuator dynamics except thrust configuration matrix are assumed to be uncertain for the proposed control design the parametric uncertainties are coped with adaptive compensation rules while the designed controller is equipped with a term that provides the robustness of the designed controller against disturbances including internal and external unmodeled effects backstepping control design approach is preferred for the control design process by considering the appropriateness of this approach for the system model of unmanned surface vessels include actuator dynamics theoretical proof of the designed controller is realized via lyapunov based arguments simulation studies where the efficiency of the designed controller is observed for both of aforementioned cases are conducted for the performance demonstration of the designed controller keywords surface vessels actuator dynamics dynamic positioning adaptive control backstepping control 1 introduction systems used to keep surface vessels on a predetermined position and heading via appropriate thruster and propeller actions are called as dynamic positioning dp systems owing to their advantages such as working properly in deep sea high positioning accuracy and avoiding damaging seabed they have been frequently preferred in offshore operations i e offshore oil and gas drilling underwater cable and pipe laying wreck investigation and etc since the mid 1960s fossen 2011 du et al 2016 the mentioned advantages especially high positioning accuracy are directly related with efficiency of the dp control system moreover when the other effects involved in control process are considered it can be decided that dp control system design is a challenging task this challenge and the ongoing need in the ship industry make dp control system design an attractive topic in the research area of control an efficient dp system must be robust against uncertain system dynamics and must be able to compensate environmental forces and other disturbances including internal and external unmodeled effects in fossen 2011 it was clearly indicated that these are the most important design requirements and the designed full state feedback controller cannot work properly unless these requirements are met when the literature about this subject is examined it is seen that almost all available dp control systems were designed by considering these design requirements while linear control techniques such as proportional integral derivative pid controller supported with low pass or notch filters had been preferred at the beginning of the subject than more advanced output control techniques such as optimal control supported with kalman filtering techniques started to dominate the literature in these type of studies kalman filtering technique was generally preferred as disturbance and or environmental effect estimator balchen et al 1976 balchen et al 1980 grimble and johnson 1988 fossen 1994 mandzuka and vukic 1995 sorensen et al 1996 katebi et al 1997 moreover some nonlinear control techniques such as fuzzy controller chang et al 2002 nonlinear pid controller torsetnes et al 2004 proposed as dp control systems by considering nonlinear ship dynamics can be encountered in relatively older studies nonlinear control approaches that meet the mentioned design requirements were preferred much more in recent studies in benetazzo et al 2015 fault tolerant control supported with multirate extended kalman filter for wave compensation was used for dp of an offshore supply vessel vectorial backstepping method was used in the adaptive fuzzy controller for dp system of vessels in hu et al 2015 model predictive control was another preferred control technique that meet the aforementioned design requirements for dp control system veksler et al 2016 in bidikli et al 2016 dp of an unactuated surface vessel directed via multiple unidirectional tugboats was provided via a full state feedback nonlinear robust controller another robust nonlinear controller design that is able to provide dp of ships in the presence of disturbances and input saturation was presented in du et al 2016 in hassani et al 2017 mixed μ synthesis modeling based robust dp control design for offshore vessels was presented a robust nonlinear control design for dp of marine vessels was presented in hu and du 2018 in the mentioned study a robust nonlinear controller that is able to cope with uncertain system dynamics and environmental disturbances was designed by including thruster dynamics for dp of marine vessels for the mentioned design it was assumed that the nominal values of the system parameters and actuator model are perfectly known and number of thrusters is equal to number of generalized control forces in li et al 2020 dp of ships was provided via robust adaptive prescribed performance control in the presence of unknown disturbance and input constraints a robust neural event triggered control design that is able to cope with actuator faults was proposed in zhang et al 2020 for providing dp of unmanned surface vessels in wang et al 2020 an adaptive fuzzy controller was proposed for dp of unmanned surface vessels almost all of the aforementioned studies and many of the studies in the literature directly focused on designing generalized control forces to provide dp of marine vessels however in fossen 2011 it was clearly indicated that distributing these forces to the actuators is one of the main necessities for dp control system design taking the actuator dynamics into account is one of the most feasible way to realize this distribution in addition to this it was also indicated that although the most of the control designs for marine vessels were done under the assumption that the actuator dynamics are negligible this assumption is restrictive for most of the ships when these facts are considered it can be reached that taking the actuator dynamics into account is a feasible way to obtain a realistic control design however the control problem becomes more complicated in this case according the number of actuators in compare to number of generalized control forces effective on the ship the distribution of generalized forces may need to be made on actuators equal to or more than the number of generalized forces in the limited number of studies where the actuators dynamics were taken into account only the case where number of generalized forces and number of actuators are equal was considered since the input gain matrix contains configuration of thrusters and propellers becomes a square matrix control design process is relatively less complex for this case however designing a controller by considering both of aforementioned cases is a more feasible approach and can be considered as a good contribution for this literature designing an adaptive controller that provides aforementioned design requirements for dp system of unmanned surface vessels is the main purpose of this study the control design is realized in the presence of actuator dynamics and owing to its generalized structure it can be used for both of the aforementioned force distribution scenarios the designed controller is based on the assumption that all parameters of the surface vessel are uncertain except thrust configuration matrix which is available for all commercial vessels owing to this approach a control design that can be used for dp of different type of commercial surface vessels is obtained the parametric uncertainties are coped with via adaptive compensations of uncertain system parameters theoretical analysis of the designed controller is realized via lyapunov based arguments while its performance is verified via simulation results these simulations is realized for the cases where generalized forces of 3 degree of freedom dof unmanned surface vessel are distributed on 3 and 6 actuators respectively presenting the efficiency of the main contribution of the designed controller is the main purpose of realizing simulation studies for two different cases 2 system model and properties theorem 1 the dynamic model of 3 dof unmanned surface vessel includes actuator dynamics is given as fossen 1994 fossen and berge 1997 fossen 2011 1 η r η ν 2 m ν c η ν d ν g η b u 3 t u u u c in this model surface vessel s body dynamics are given in 1 and 2 in these equations the position and body fixed velocity vectors are denoted by η x y ψ t and ν u v r t r 3 respectively the rotation matrix in yaw is represented by r η r 3 3 while the inertia matrix including hydrodynamic added mass effect coriolis sentripetal matrix including hydrodynamic added inertia and hydrodynamic damping matrix are denoted by m c η and d r 3 3 respectively moreover g η r 3 represents the vector of gravitational and buoyancy forces the constant matrix b r 3 n represents the thrust configuration matrix and u r n denotes the vector of actuator states in the actuator dynamics given in 3 t r n n denotes the diagonal and constant matrix of actuator time constants and u c r n denotes the vector of control inputs terms of the given dynamic model satisfy the following properties fossen 1994 fossen and berge 1997 fossen 2011 property 1 inertia matrix m is a positive definite i e x t m x 0 x r 3 and symmetric matrix i e m t m property 2 coriolis sentripetal matrix c is a skew symmetric matrix i e c t c and satisfies the property given as x t c x 0 x r 3 property 3 thrust configuration matrix b in 2 is known for all commercial unmanned surface vessels and b b t is a nonsingular matrix property 4 measurements of all states including actuator states are available and can be used in control design remark 1 at this point it should be noted that properties 1 4 are standard properties for these type of surface vessels and they can be reached from many studies about mathematical modeling an d control of such systems all of the remaining properties and designs presented in this study are based on these standard properties by considering their validity and generalizability the surface vessel s body dynamics in 1 and 2 can be arranged as follows by substituting the time derivative of 1 into 2 and by taking the external and internal disturbance effects into account 4 j η η c η η η η f η η g η η f d t r η b u where the orthogonality of the rotation matrix is utilized and the dynamic terms j η c η η η f η r 3 3 and g η η r 3 are defined as 5 j η r η m r η t 6 c η η η r η m r η t r η c η r η t 7 f η r η d r η t 8 g η η r η g η in 4 f d t r 3 denotes a function that represents slowly varying forces due to ocean currents second order wave drift forces unmodeled dynamics and other disturbances in the control of marine vessels all of the mentioned effects appear as uncertain but bounded effects and this situation makes f d t is an uncertain but a bounded function fossen 2011 when their structures are examined it can be seen that terms of the dynamical model in 5 8 satisfy the following properties property 5 the j and c η matrices satisfy the following skew symmetry property 9 x t 1 2 j c η x 0 x r 3 property 6 the terms of the dynamic model in 4 j c η f and g η satisfy the following bounds 10 j φ i b j 1 11 j φ j φ i b j 2 φ φ 12 c η φ φ i b c φ 13 f φ i b f 1 14 f φ f φ i b f 2 φ φ 15 g η φ g η φ i b g φ φ φ i φ γ r 3 in 10 15 i denotes the induced infinity norm and the positive bounding constants are denoted by b j 1 b j 2 b c b f 1 b f 2 and b g r property 7 the mathematical model in 4 can be written in the following linearly parametrized form 16 y 1 η η η θ 1 f d t r η b u where y 1 r 3 r 1 represents the regression matrix while θ 1 r r 1 represents the vector of uncertain system parameters the term y 1 η η η θ 1 is defined as 17 y 1 η η η θ 1 j η η c η η η η f η η g η η the linearly parametrized form of the mathematical model is presented in a detailed manner in section 8 1 property 8 the model of actuator dynamics in 3 can be written in the following linearly parametrized form 18 y 2 u u θ 2 u c where y 2 r r r 2 represents the regression matrix while θ 2 r r 2 represents the vector of uncertain parameters of actuator dynamics 3 error system development the error between the predetermined position and heading and the measured position and heading is denoted by e 1 t r and defined as 19 e 1 η d η where η d r 3 denotes the vector of desired position and heading where the surface vessel is needed to be kept constant the additional auxiliary errors e 2 t r n and r t r 3 are defined as 20 e 2 u v u 21 r e 1 α e 1 where u v r n denotes the virtual control input and α r 3 3 denotes the positive definite diagonal and constant gain matrix remark 2 in the backstepping control design approach first the virtual control input is designed and it is theoretically shown that zero convergence of the tracking error can be obtained when the virtual control input is used instead of one of the system states then the actual control input is designed to cope with the error between the virtual control input and the mentioned state as a result a control input that can be used to obtain the zero convergence of the tracking error is obtained since the design of the control input is theoretically based on the design of virtual control input it is not wrong to say that the virtual control input defined in 20 has a great importance in the control design in this study the virtual control input u v is used instead of vector of actuator state s u to obtain the zero convergence of the error in 19 therefore the auxiliary error e 2 is defined as the difference between virtual control input and the vector of actuator states remark 3 another point that should be noted about the virtual control input at this point is that it does not have any effect onto the control process it does not provide any advantage or disadvantage and affect transient state and or steady state into the application although the virtual control input does not have any effect into the application it provides a theoretical base for the design of the actual control input that is directly applied to the system into the application in other meaning design of the virtual control input is a step in the control design and analysis process with an important theoretical aspect the adaptive and system parameters independent structure of the designed controller is provided via adaptive compensations of vector of uncertain parameters denoted by θ ˆ 1 r r 1 and θ ˆ 2 r r 2 the adaptive compensation errors denoted by θ 1 r r 1 and θ 2 r r 2 are defined as follows by considering this purpose 22 θ 1 θ ˆ 1 θ 1 23 θ 2 θ ˆ 2 θ 2 4 control design the control design approach is presented in a detailed manner in this section firstly the design process of a virtual control input is introduced and as it is stated in remark 2 it is shown that zero convergence of the tracking error can be satisfied when the virtual control input is used instead of vector of actuator states u however as it can be seen from the structure of the system s model in 1 3 u is not an input but another state for surface vessels and it can be controlled via an actual control input u c in the continuing part of the design the actual control input is designed to guarantee that vector of actuator states u converge to virtual control input u v as a result an actual control input that guarantees the zero convergence of e 1 is obtained to obtain the open loop error dynamics for the virtual control input design time derivative of 21 is pre multiplied with j η 24 j η r j η η d c η η η η f η η g η η f d t r η b u j η α e 1 where 4 19 and 21 are utilized the virtual control input is designed as 25 u v b t b b t 1 r t y 1 d θ ˆ 1 k 1 r φ f d tanh r where k 1 r 3 3 denotes a positive definite diagonal and constant gain matrix φ f d r 3 3 denotes a positive definite diagonal and constant matrix whose diagonal entries are positive bounding terms of f d tanh represents hyperbolic tangent function and θ ˆ 1 is updated according the rule given as 26 θ ˆ 1 y 1 d t r at this point it should be noted that the matrix y 1 d η d η d η d r 3 r 1 is obtained by replacing η η and η with the desired position and its time derivatives into the regression matrix y 1 defined in 16 remark 4 for the completeness of the demonstration the terms η d and η d are used in the brackets of y 1 d in the above notation however since the desired position is selected as a constant term time derivatives of the desired position are obtained as vector of zeros in dp control systems the multiplication of y 1 d with θ 1 is defined as 27 y 1 d θ 1 j η d η d c η η d η d η d f η d η d g η η d where 17 is utilized the closed loop error dynamics of this part can be obtained as follows when the virtual control input design in 25 is written instead of u in 24 and 22 is utilized 28 j η r χ 1 c η η η r y 1 d θ 1 k 1 r f d φ f d tanh r where χ 1 r 3 is an auxiliary function defined as 29 χ 1 j η j η d η d g η η d g η η c η η η c η η d η d η d c η η η d α e 1 f η f η d η d f η η η d α j η r α e 1 remark 5 at this point it should be stated that the following upper bound can be satisfied for χ 1 30 χ 1 ρ 1 e 1 e 1 ρ 2 e 1 r ρ 3 where ρ 1 e 1 and ρ 2 e 1 r are positive nondecreasing functions of their arguments ρ 3 r is a positive bounding constant and 10 15 19 and 21 are utilized proof 1 see section 8 2 for the proof for the preliminary analysis the nonnegative auxiliary function v 1 e 1 r θ 1 r is defined as 31 v 1 1 2 e 1 t e 1 1 2 r t j r 1 2 θ 1 t θ 1 the time derivative of 31 is obtained as 32 v 1 e 1 t e 1 1 2 r t j r r t j r θ 1 t θ 1 the above equation can be rearranged as follows by substituting e 1 from 21 θ 1 from time derivative of 22 and j r from 28 33 v 1 e 1 t α e 1 r t k 1 r e 1 t r r t χ 1 θ 1 t θ ˆ 1 y 1 d t r r t f d φ f d tanh r where the term 1 2 r t j r is canceled with the term r t c η r that is obtained from 28 owing to the skew symmetry property given in 9 from the aforementioned analysis it can be seen that its validity directly depends on the zero convergence of the auxiliary error e 2 the analysis presented after this point is realized to show that u converges to u v during the control process the open loop error dynamics can be obtained by premultiplying of the time derivative of 20 with t and rearranging the resulting equation as 34 t e 2 t u v u c u where 3 is utilized the control input is designed as 35 u c y 2 v θ ˆ 2 k 2 e 2 where k 2 r n n denotes a positive definite diagonal and constant gain matrix and θ ˆ 2 is updated according the rule given as 36 θ ˆ 2 y 2 v t e 2 at this point it should be noted that the matrix y 2 v u v u v r n r 1 is obtained by replacing u v and u v with vector of actuator states and its time derivative into the regression matrix y 2 defined in 18 remark 6 in fossen 2011 it was clearly indicated that the dynamic positioning system must be capable to compensate the bounded disturbances including environmental unmodeled internal and external effects since the full state feedback controllers may not work properly in the presence of these effects all of the mentioned effects are expressed via disturbance function f d in 4 by equipping the virtual control design in 25 with an extra term i e φ f d t a n h r and by using this virtual control input into the actual control input design a controller that is able to cope with the mentioned effects is obtained remark 7 3 dof unmanned surface vessels may have more than 3 actuators 3 actuators or 2 actuators for the last case dp control system design is realized with a completely different approach in this approach a path planning is realized where one position and heading are directly controlled while the remaining position is indirectly controlled according to the planned path however for the remaining cases a slightly different system model is obtained where the dimensions of thrust configuration matrix b change although this may seem like a minor change if it cannot be taken into account in the control design it prevents the design from being usable in either case for providing the efficient distribution of the generalized forces to the actuators for both of these cases b t b b t 1 term is used in the virtual control design and than the actual controller is designed by including the virtual control design according to the authors best knowledge this approach is the most important contribution that distinguishes this study from its counterparts in the literature the closed loop error dynamics can be arranged as follows by substituting 35 into 34 and utilizing 20 and 23 into the resulting equation 37 t e 2 y 2 v θ 2 k 2 i n e 2 where i n r n n denotes the standard identity matrix 5 stability analysis theorem 2 the semi global asymptotic stability of error terms e 1 t e 2 t and r t that can mathematically be shown as 38 e 1 t e 2 t r t 0 a s t and the boundedness of all signals under the closed loop operation can be provided by using the control input design in 35 with the virtual control input design in 25 and the update laws of θ ˆ 1 and θ ˆ 2 given in 26 and 36 respectively proof 2 the nonnegative lyapunov function candidate v e 1 e 2 r θ 1 θ 2 r is selected as 39 v v 1 1 2 e 2 t t e 2 θ 2 t θ 2 time derivative of 39 is obtained as 40 v e 1 t α e 1 r t k 1 r e 1 t r r t χ 1 r t f d φ f d t a n h r e 2 t k 2 i r e 2 θ 1 t θ ˆ 1 y 1 d t r θ 2 t θ ˆ 2 y 2 v t e 2 where 23 33 and 37 are utilized from 40 it can be seen that if θ ˆ 1 and θ ˆ 2 are updated according to the rules given in 26 and 36 the final form of 39 is obtained as 41 v e 1 t α e 1 r t k 1 r e 1 t r r t χ 1 r t f d φ f d t a n h r e 2 t k 2 i r e 2 final form of the time derivative of the lyapunov function candidate v in 41 can be upper bounded as 42 v λ m i n α 1 2 1 4 ρ 1 2 e 1 2 λ m i n k 1 5 2 ρ 2 r 2 1 4 ρ 3 2 r t f d φ f d t a n h r λ m i n k 2 1 e 2 2 1 2 ρ 1 e 1 r 2 1 2 ρ 3 r 2 1 4 ρ 3 2 r t f d φ f d t a n h r where the fact x 1 t x 2 1 2 x 1 2 1 2 x 2 2 x 1 x 2 r p is utilized and 1 4 ρ 3 2 is added to both sides from the above inequality it can be seen that for the following selections of constant gains 43 α ℓ 1 2 1 4 ρ 1 2 44 k 1 ℓ 5 2 1 4 ρ 2 45 k 2 ℓ 1 and for the sufficiently high selection of φ f d a more compact form of 42 can be written as 46 v β 1 z 2 β 2 where a ℓ denotes the ℓ t h diagonal element of the matrix denoted by a in 42 β 1 r denotes a positive constant selected as 47 β 1 min λ m i n α 1 2 1 4 ρ 1 2 λ m i n k 1 5 2 ρ 2 λ m i n k 2 1 and β 2 r is an another auxiliary positive constant selected as 48 β 2 1 2 ρ 1 e 1 r 2 1 2 ρ 3 r 2 1 4 ρ 3 2 r t f d φ f d tanh r and vector of combined errors z t r 6 n is defined as 49 z e 1 t e 2 t r t t from 41 and 46 it can be guaranteed that e 1 t e 2 t r t θ 1 t and θ 2 t l after integrating 46 the resulting expression is obtained as 50 t 0 z σ 2 d σ v 1 t 0 β 1 from the statement in 50 it is seen that z t l 2 boundedness of all of the remaining signals under the closed loop operation including the time derivative of z t can be shown via standard signal chasing arguments barbalat s lemma krstic et al 1995 can be used along with the boundedness of z t and z t l 2 l information to guarantee that z t 0 as t this result can be used with 49 to show that error terms e 1 t e 2 t and r t asymptotically converge to zero 6 simulation results simulations were conducted for the same nonlinear supply vessel for two different scenarios in the first scenario it was assumed that the desired position and heading were tried to be reached via 6 actuators and in the second scenario it was assumed that the control purpose is tried to be provided via 3 actuators bis scaling model parameters of the nonlinear supply vessel used in simulation studies are given as fossen 2011 51 m 1 1274 0 0 0 1 8902 0 0744 0 0 0744 0 1278 52 c ν 0 0 0 0 1 8902 v 0 0744 r 1 1274 u 1 8902 v 0 0744 r 1 1274 u 0 53 d 0 0414 0 0 0 0 1775 0 0141 0 0 1073 0 0568 54 r η cos ψ sin ψ 0 sin ψ cos ψ 0 0 0 1 the transformation between bis scaled states and physical quantities was realized according to following formulas 55 η d i a g 76 2 76 2 1 η 56 v d i a g 746 8 746 8 0 13 ν the desired position was selected as 57 η d 10 m 5 m 10 d e g t for observing that the designed controller can be efficiently used to reach the control purpose in the presence of different kinds of disturbances a sinusoidal perturbation having the following structure 58 f d 0 5 sin 20 π t 0 25 sin 20 π t 0 5 sin 20 π t t and additive white gaussian noise with 110 signal to noise ratio were applied to the system simultaneously for the case the surface vessel having 6 actuators thrust configuration and actuator matrices are given as b 10 3 13 13 0 0 0 0 11 6 11 6 0 0 4 6 4 6 59 0 0 6 6 7 2 7 2 2 60 t 1 7964 i 6 for a vessel with a length of 76 2 m at this point it should stated that the above bis scaled matrices were given in accordance with the nonlinear supply vessel model presented in this section and by considering that the actuator time constants of all thrusters and propellers were chosen as 5 s control gains were selected as 61 a d i a g 1 1 1 62 φ f d d i a g 2 5 7 5 2 5 63 k 1 d i a g 1 5 2 5 1 64 k 2 d i a g 5 1 1 1 1 1 as a result of the simulations positioning results were obtained as in fig 1 while positioning errors can be seen from fig 2 from these figures it can be observed that dynamic positioning was performed in approximately 3 s and then the position can be maintained under the effect of disturbances by considering these issues it can be said that the control purpose was efficiently met the control inputs and the forces acting on the surface vessel as a result of the application of these control inputs can be seen from figs 3 and 5 respectively moreover changes of control inputs and forces in the first 3 s are given in figs 4 and 6 respectively observing the change of control inputs in the period from beginning of control process to time when dynamic positioning was achieved is the main purpose of giving these figures from these figures it can be seen that since the error between the predetermined position and the initial conditions was too much the control inputs tried to reduce the difference by giving sudden reactions as the error value decreases the interval in which the control inputs change also decreases it can be seen from figs 3 and 5 that after dynamic positioning was achieved the control inputs change in a very small interval compared to the initial interval and continue to maintain the position of the surface vessel for the case surface vessel having 3 actuators thrust configuration and actuator matrices are given as 65 b 10 3 26 0 0 0 23 2 13 7 0 9 2 4 9 66 t 1 7964 i 3 for a vessel with a length of 76 2 m at this point it should stated that the above bis scaled matrices were given in accordance with the nonlinear supply vessel model presented in this section and by considering that the actuator time constants of all thrusters and propellers were chosen as 5 s control gains were selected as 67 a d i a g 1 1 1 68 φ f d d i a g 2 5 8 5 2 5 69 k 1 d i a g 1 1 2 9 1 70 k 2 d i a g 5 1 1 as a result of the simulations positioning results were obtained as in fig 7 while positioning errors can be seen from fig 8 from these figures it can be observed that as in the previous scenario the control objective was effciently met in this scenario the control inputs and the forces acting on the surface vessel as a result of the application of these control inputs can be seen from figs 9 and 11 respectively moreover changes of control inputs and forces in the first 3 s are given in figs 10 and 12 respectively observing the change of control inputs in the period from beginning of control process to time when dynamic positioning was achieved is the main purpose of giving these figures from these figures it can be observed that similar results to the previous case were also obtained for this case this is an expected result as the simulations were performed on the same surface vessel having a slightly modified actuator model and similar interpretations are also valid for this case 7 conclusions in this study an adaptive nonlinear controller was designed for dp of unmanned surface vessels in the presence of actuator dynamics for this design it was assumed that all system parameters are uncertain except the thrust configuration matrix the parametric uncertainties were coped with adaptive compensation rules while the controller was designed by basing on these rules and the full state feedback in contrast to many dp studies available in the literature actuator dynamics were taken into account in the control design owing to this approach a design which is considered as one of the basic needs of dp control system design was presented in which the distribution of control forces can be performed efficiently by including the actuator dynamics in the model and making the necessary arrangements a two stage model was obtained for unmanned surface vessels backstepping control design approach which is considered as a feasible control design approach for such systems was utilized for the control design in this approach firstly the force input that must be applied to bring the unmanned surface vessel to the desired position and heading was obtained then the actual control input that provides an appropriate distribution of these forces to actuators to produce it efficiently was designed for providing another main necessity of dp control system design the controller was equipped with a term that is able to compensate the effects of disturbances in contrast to the limited number of studies available in the literature where actuator dynamics were taken into account this design was implemented in such a way that can provide the dp of the surface vessels whose actuator numbers are equal to the number of generalized forces and greater than the number of generalized forces since both of these cases can be encountered in commercial dp systems designing a controller that can be used for both of these cases can be considered as the main contribution of this study the theoretical proof of the designed controller was realized via lyapunov based arguments while its performance was demonstrated via numerical simulation results providing a controller that can be used for different type of unmanned surface vessels was one of the main goals while performing the control design and the presented controller can be used for all commercial surface vessels where the full state feedback is available however while almost all large and medium sized unmanned surface vessels have measurement devices that provide full state feedback some small unmanned surface vessels especially are not equipped with these type of measurement devices designing a version of this controller that does not require full state feedback is considered as a possible future work to make this control design available for these type of unmanned surface vessels taking the actuator dynamics into account and designing a controller for this scenario is one of the main contributions of this study however partial knowledge of the actuator model was utilized while reaching the control purpose although the known model parameters are assumed to be available for all commercial surface vessels designing a controller that is completely independent from system and model parameters may become much better in terms of generalizability and applicability of the designed controller designing this type of controller and comparing its control performance onto the dynamic positioning of more than one surface vessels having different actuator dynamics is considered as another future work experimental verification is also aimed credit authorship contribution statement baris bidikli conceptualization methodology software formal analysis investigation writing original draft writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper 8 appendices 8 1 linear parametrization of body dynamics of 3 dof surface vessels general forms of rigid body dynamics of 3 dof surface vessels defined in 1 and 2 are given as 72 m m 11 0 0 0 m 22 m 23 0 m 32 m 33 73 c ν 0 0 0 0 c 1 v c 2 r c 3 u c 1 v c 2 r c 3 u 0 74 d d 11 0 0 0 d 22 d 23 0 d 32 d 33 75 r η cos ψ sin ψ 0 sin ψ cos ψ 0 0 0 1 where m 11 m 33 r are constant terms of inertia matrix c 1 c 3 r are constant coefficients of coriolis sentripetal matrix d 11 d 33 r are constant terms of hydrodynamic damping matrix and since the gravitational and buoyancy forces are outbalanced by each other vector of gravitational and buoyancy forces is given as g η 0 3 if the linearly parametrized form in 17 is applied with the dynamics in 72 75 elements of the regression matrix y 1 η η η r 3 13 are obtained as 76 y 1 11 x y ψ cos ψ 2 y x ψ sin ψ cos ψ 77 y 1 12 x y ψ sin ψ 2 y x ψ sin ψ cos ψ 78 y 1 13 0 79 y 1 14 ψ sin ψ 80 y 1 15 0 81 y 1 16 ψ cos ψ v 82 y 1 17 ψ cos ψ r 83 y 1 18 ψ sin ψ u 84 y 1 19 x cos ψ 2 y sin ψ cos ψ 85 y 1 110 x sin ψ 2 y sin ψ cos ψ 86 y 1 111 ψ sin ψ 87 y 1 112 0 88 y 1 113 0 89 y 1 21 x y ψ sin ψ cos ψ y x ψ sin ψ 2 90 y 1 22 x y ψ sin ψ cos ψ y x ψ cos ψ 2 91 y 1 23 ψ cos ψ 92 y 1 24 0 93 y 1 25 0 94 y 1 26 ψ sin ψ v 95 y 1 27 ψ sin ψ r 96 y 1 28 ψ sin ψ u 97 y 1 29 x sin ψ cos ψ y sin ψ 2 98 y 1 210 x sin ψ cos ψ y cos ψ 2 99 y 1 211 ψ cos ψ 100 y 1 212 0 101 y 1 213 0 102 y 1 31 0 103 y 1 32 0 104 y 1 33 0 105 y 1 34 x sin ψ y cos ψ x ψ cos ψ y ψ sin ψ 106 y 1 35 ψ 107 y 1 36 x cos ψ y sin ψ v 108 y 1 37 x cos ψ y sin ψ r 109 y 1 38 x cos ψ y sin ψ u 110 y 1 39 0 111 y 1 310 0 112 y 1 311 0 113 y 1 312 x sin ψ 114 y 1 313 ψ where y 1 i j r denotes the element of y 1 placed in j t h column of i t h row at this point it should be noted that since terms of body fixed velocity vector can be expressed as follows by utilizing 1 and 75 115 u x cos ψ y sin ψ 116 v x sin ψ y cos ψ 117 r ψ all elements of the regression matrix can be expressed in terms of elements of η η and η for the above terms of regression matrix vector of uncertain system parameters θ 1 r 13 can be obtained as 118 θ 1 m 11 m 22 m 23 m 32 m 33 c 1 c 2 c 3 d 11 d 22 d 23 d 32 d 33 t 8 2 proof of bound of χ 1 according to the definition of χ 1 in 29 its norm can be upper bounded as 119 χ 1 b j 2 η d e 1 b g e 1 b c η d α e 1 r η d α e 1 b c η d 2 b f 2 η d e 1 b f 1 r α e 1 α b j 1 r α e 1 b j 2 η d b g b c 2 η d α b f 2 η d b f 1 α b j 1 α 2 e 1 b c η d α e 1 b f 1 b j 1 α r 2 b c η d 2 upper bound in 30 can be obtained by considering the following definitions 120 ρ 1 e 1 b j 2 η d b g b c 2 η d α b f 2 η d b f 1 α b j 1 α 2 b c α 2 ρ 2 e 1 b c η d α e 1 b f 1 b j 1 α ρ 3 2 b c η d 2 where 10 15 19 and 21 are utilized 
