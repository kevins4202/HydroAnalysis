index,text
22900,ships underwater radiated noise is a subject of great and increasing interest in naval architecture because of its impacts on the environment and on the on board comfort among the different noise sources the propeller is usually the dominant one especially when it cavitates for this reason a lot of efforts have been spent in studying the cavitation noise spectra in order to be able to predict its main characteristics at design stage nowadays in order to reach this goal the state of the art solution is to perform model scale experiments unfortunately this requires time consuming tests in a cavitation tunnel with a model of the propeller and results are affected by scale effects that must be correctly interpreted for these reasons in this paper authors propose a hybrid approach which may be adopted to predict the main characteristics of the cavitation noise spectra without requiring an actual experiment moreover the same approach may be used also in order to overcome typical model scale problems for this purpose a hybrid modelling approach able to exploit both the physical knowledge of the problem and the real data obtained from many cavitation tunnel experiments performed on different propellers in different working conditions have been developed results on real data in both interpolation and extrapolation tasks will support the validity and the effectiveness of the proposal keywords marine propeller cavitation noise prediction spectra parametrization data driven model hybrid model 1 introduction in recent years ships underwater radiated noise urn has become subject of great interest because of the increasing attention to the environmental impact of human activities council of european union 2008 and the improved sensibility to the on board comfort imo 2012 in this context much effort has been spent in the study of propeller noise since it represents the dominating noise source on ships especially when it cavitates ross 1976 the prediction of propeller cavitation noise can be addressed by means of different approaches as summarized in fig 1 the approach based on computational fluid dynamics cfd models bensow and bark 2010b a is able to predict directly the full scale fs noise knowing hull and propeller geometry and ship s operating conditions cfd based models even if showing promising capabilities are still under development and their high computational requirements limit their use to the field of research making it impractical in a conventional propeller design loop the second approach is the adoption of model scale tests mst which are mainly carried out in cavitation tunnels this approach is still largely considered the most reliable method for cavitation noise prediction mst makes use of a model of the propeller manufactured using the geometry from the design which is tested reproducing cavitation conditions in order to measure the model scale ms noise scale effects must be carefully taken into account in order to retrieve the full scale noise in particular the development of tip vortex cavitation tvc is significantly influenced by the reynolds number as remarked by mccormick 1962 the onset of tvc in model scale occurs at significantly lower cavitation number than on the full scale propeller as a consequence for some ship operational conditions it is not trivial to correctly reproduce the cavitation pattern in mst moreover mst are quite expensive and time consuming it is not feasible to include them in the early stage of the design as a consequence it is of interest to replace mst with a tool that is able to predict the propeller noise by having only the information about the propeller geometry the inflow wake and cavitation behaviour in fact these characteristics are all known in the design stage or may be predicted e g by means of cfd calculations without mst these tools can be built with different approaches the most common one is to build simplified physical models pms combined with empirical relations defined from experimental data examples of such approaches in the study of propeller cavitation noise are represented by the work of raestad 1996 and bosschers 2018 the limitation of these pms lies in the fact that due to the undergoing simplifications they are not able to accurately describe the phenomenon of cavitation noise taking into account all the complex aspects involved and the complete cavities dynamics consequently the quality of the results may not be completely satisfactory requiring an ad hoc tuning on experimental data by means of fitting parameters for this reason in this paper the authors propose to employ data driven models ddms vapnik 1998 gy√∂rfi et al 2006 which are able to build models exploiting robust statistical inference procedures and data collected in previous experiments in order to make predictions about previously unseen cases a possible advantage of these methods is represented by the fact that there is no need of any a priory knowledge about the underlying physical system furthermore thanks to the nature of these approaches it is possible to exploit even data regarding particular phenomena that cannot be easily modelled with a pm ddms have proved to be valuable instruments in many marine applications petersen et al 2012 smith et al 2013 coraddu et al 2017 cipollini et al 2018 and recently aktas 2017 proposed a promising artificial neural network approach for the prediction of the propeller cavitation noise in full scale given a number of design parameters and a large collection of noise samples from cavitation tunnel tests however ddms usually produce black box non parametric models that are not supported by any physical interpretation this despite representing a possible advantage as mentioned above may limit the capability of the models themselves without exploiting important knowledge about the phenomena of interest moreover in general a great amount of historical data is necessary in order to build reliable models for these reasons in this paper authors propose a hybrid approach namely hybrid models hms in order to take advantage of the best characteristics of both pms and ddms by combining them together in fact hms are able to combine the statistical information acquired by analyzing the collected data with the physical equations describing the occurring phenomenon thus considering both the theoretical and the empirical sides of an experiment hms are widely used in those contexts were the experience on the field brought by pms can enhance the ddms prediction coraddu et al 2017 both ddms and hms require the availability of a significant amount of data in order to model the ship radiated noise full scale measurements carried out during sea trials should be used however this kind of data presents some practical issues one of the major problem is that the availability of such data is very limited in addition it is not trivial to identify and separately study the propeller contribution in full scale measurements on the other hand msts provide the opportunity to collect a large amount of data from dedicated experiments in a controlled environment hence suitable for the definition of a cavitation noise model which can replace an actual mst in the cavitation tunnel for these reasons it was decided to define models based on mst data such a model is able to replace mst and predict ms noise which must then be extrapolated to fs using suitable scaling formulas according to this approach also scale effects are modelled hence they are not automatically eliminated however as it will be shown the proposed approach allows also to deal with some of these unwanted effects in order to develop and test the models proposed in this paper authors have first collected a dataset by means of an extensive set of cavitation tunnel mst of two controllable pitch propellers of twin screw ships then the propeller urn has been parameterized with a simple procedure which allows to extract its main characteristics the modelization of only the continuous spectrum broadband of cavitation noise is addressed in this work neglecting tonal components different models pms ddms and hms have been developed for predicting these main characteristics based on quantities that can be estimated without performing any mst this is done with the aim in the future to obtain a prediction tool for the estimation of the propeller noise once a larger set of data will be available in parallel to this the same tool may be adopted in order to predict propeller noise in correspondence to conditions which cannot be reproduced in model scale with these two objectives the models have been validated with the real data in two different scenarios interpolation scenario in this case models try to predict the propeller noise spectra main characteristics in various but different working conditions within the ones exploited for building the model extrapolation scenario in this case models try to predict the propeller noise spectra main characteristics in groups of working conditions where the cavitation intensity is different w r t the one exploited for building the model these extrapolation tests are useful to test the capability of the models to predict the noise related to cavitation patterns which cannot be correctly reproduced at model scale results show that the proposed hms accuracies are remarkably higher than the ones of pms and ddms both in interpolation and extrapolation scenarios the rest of the paper is organized as follows section 2 describes the mst performed in the cavitation tunnel the data collected during the experiments and the cavitation noise spectra parametrization method section 3 reports the adopted pms and ddms and the proposed hms the validation of pms ddms and hms in the two scenarios described above are reported in section 4 finally section 5 concludes the paper due to confidentiality issues sensitive data like propeller geometry and working conditions will be omitted or altered by means of appropriate reference values kept constant for the whole article 2 model scale tests in this section a general description of the mst performed in the cavitation tunnel and the collected data is reported in particular in section 2 1 the experimental setup is described reporting main propellers and wake characteristics and configuration in the cavitation tunnel in section 2 2 the criteria adopted for the choice of the measuring points are reported together with the parameters chosen for characterising the propeller functioning and the simplification of the noise spectrum finally in section 2 3 some examples of typical outcomes of the measurements are reported experiments have been performed at the cavitation tunnel of the university of genoa for a detailed description of the facility see tani et al 2017 mst have been performed for a total of 425 propeller loading conditions chosen in order to properly explore the variables domain each test corresponds to a row of the dataset matrix 2 1 experimental setup all mst have been performed on two controllable pitch propellers respectively referred as propeller 1 p1 and propeller 2 p2 tested at various pitch settings the main characteristics are reported in table 1 one single wake field has been considered for each propeller the axial wake fields are simulated by means of a mock up of the shaft line with brackets and a small dummy hull on which wake screens are mounted to better reproduce typical wake fields of twin screw vessels shaft inclination is adopted in order to reproduce the significant upward velocity component present in twin screw ships as shown in fig 2 the axial wake fields reproduced in the cavitation tunnel for the p1 and the p2 are respectively shown in fig 3 on left and right sides in fig 3 z r and y r are respectively the vertical and the transversal coordinate w r t the propeller centerline both normalized to the propeller radius r the axial wake 1 w x is the ratio between the axial velocity v a in the propeller disk and the undisturbed one v namely 1 w x v a v for each propeller a complete set of tests has been performed cavitation bucket cavitation observations pressure pulses and propeller radiated noise measurements in a large set of operational conditions all these measurements provide detailed information about cavitation typologies present and their extensions for a wide range of operational conditions to allow correlating measured noise with these values radiated noise measurements were carried out with two hydrophones respectively referred as h1 and h2 in fig 2 h1 is located inside a tank full of water attached to the plexiglas window under the propeller h2 is mounted on a fin immersed in the tunnel flow outside of the propeller slipstream only data acquired by the latter have been used in this work because of the better signal to noise ratio the propeller loading conditions for model tests are defined according to the identity of the thrust coefficient k t and the cavitation number based on rotational speed œÉ n the first coefficient represents the kinematic condition of the propeller while the cavitation number defines a cavitation similarity criterion noise measurements have been performed mainly following the international towing tank conference ittc model scale noise measurement guidelines ittc specialist committee on hydrodynamic noise 2017 data used for the following analyses are spectra of the radiated noise levels rnl at the distance of 1 m from the propeller center disk obtained after having applied the background noise correction the transfer function correction for the confined environment effect tani et al 2016 brian√ßon et al 2013 is identical for all the noise measurements considered in present work hence it has not been applied here since it does not affect the analysis of the modelling approaches considered thus the developed models describe the characteristics of noise spectra measured inside the cavitation tunnel in order to compute free field noise spectra transfer function corrections could be applied to noise spectra predicted by the models the application of transfer functions to noise spectra used in building the model is needed when considering results of tests carried out with different configurations or from different institutes e g aktas et al 2018 activities which may represent possible future improvement of this work as a consequence transfer functions will be considered for future activities 2 2 dataset creation the working conditions for which noise samples are collected have been chosen in order to provide an exhaustive characterization of cavitation noise furthermore within all possible cavitation typologies the attention is voluntarily focused on those phenomena which provide a deeper insight on the real propeller functioning the most important phenomenon is probably the tvc since it is usually the first cavitation type occurring on a full scale propeller and the most difficult to be avoided also for those propellers suitably designed to limit cavitation other phenomena of practical relevance are the suction side sheet cavitation and pressure side cavitation models presented in this work are developed using a subset of these working conditions characterized by the presence of only suction side cavitation and not affected by unwanted phenomena like remarkable bubble cavitation accordingly samples have been reduced to 164 the characterization of propeller cavitation is represented by the cavitation bucket in fig 4 the cavitation bucket for the p2 at design pitch is reported as an example while others are not presented for the sake of shortness nevertheless the following considerations are valid for the whole data collection the cavitation bucket reports the inception of different cavitation phenomena as function of the thrust coefficient and cavitation number in particular the curves on the right part of the figure higher propeller loading correspond to phenomena originated on the suction side of the blade whereas the curves on the left part correspond to pressure side ones these can be divided by cavitation typologies in vortices tvc vortex from sheet face sheet cavitation and bubbles moreover the same phenomenon may be further subdivided considering its location as an example the labels tvc 90 and detached tvc refer to tip vortex cavitation occurring at angular positions between 90 and 180 connected to the blade in the first case present only downstream in the second in such positions the vortex is usually rather stable and its noise is not very high the tvc 0 referring to tip vortex cavitation occurring where the blades encounter the hull wake is significantly more unstable and noisy the general criterion is to pick noise up in correspondence to a series of functioning points identified from the analysis of the cavitation bucket in order to characterize the propeller behaviour in different conditions in particular as mentioned large attention has been given to tvc with this aim an attempt has been made to collect many measurements for functioning conditions with the presence of tvc alone in order to achieve this it has been necessary to include also very off design conditions that are points identified by values of the thrust coefficient significantly different from those corresponding to the real functioning of the propeller actually moving to overloaded conditions the tip vortex inception index increases remarkably and it is possible to analyze tip vortex noise at different degrees of development before the onset of other phenomena quantities collected for the working points defined above are summarized in table 2 these values represent the features considered as possible input for the model developed as it will be described in section 3 the features include some characteristics of the propeller geometry the characteristics of propeller inflow and the propeller working conditions in terms of kinematic conditions propeller loading and cavitation all these quantities are usually available at the propeller design phase exception made for the inception indices which may be estimated anyway by dedicated cfd simulations with reasonable accuracy see gaggero et al 2014 as an example it has to be remarked that the cfd simulations needed to obtain the inception indices are much more accurate and computationally inexpensive than those required to estimate directly the model scale noise the propeller cavitation pattern is described by the parameter œÉ n œÉ n i n c that is the ratio between the actual cavitation number based on the tip peripheral speed v r e f n d and the inception index for the phenomenon both measured w r t the static pressure on the shaft line these parameters indicate if a certain phenomenon is present and provide an indication about its extension other two definitions of the cavitation index have been considered œÉ v is the cavitation number again evaluated at the shaft line based on the advance speed v r e f v a œÉ n t i p is the index based on peripheral speed v r e f n d but w r t the static pressure at the blade tip all the propeller working parameters are defined according to ittc guidelines ittc specialist committee on hydrodynamic noise 2017 the wake characteristics taken into account are shown in fig 5 and consider two radial positions namely 0 7 r and 0 9 r since these two positions are relevant for sheet cavitation both suction side and pressure side and tvc parameters used to describe the propeller inflow have been defined partially following odaba≈üi and fitzsimmons 1978 the maximum and minimum derivatives of the wake w r t the angular position Œ∏ represent the rate of variation of blades load during revolution the wake width is the angular sector where the wake fraction is greater than 0 05 other important features like the average wake fraction and the wake depth are implicitly included in the parameters describing the angle of attack of the blades the angle of attack describes the hydrodynamic functioning of blade sections taking into account the effects of the pitch setting combined with the advance ratio and the characteristics of the inflow including also the shaft inclination since the propeller self induced velocities are not known a priori the geometric angle of attack Œ± g is defined by eq 2 according to ittc propulsion committee 2008 as the difference between the advance angle Œ≤ of a blade section determined by eq 1 and the local pitch angle œÜ 1 Œ≤ r Œ∏ v a 1 w œÄ d n r r v a s i n Œ± s i n Œ∏ in eq 1 Œ± is the shaft angle d the propeller diameter n the shaft revolution rate r the radial section coordinate w the wake fraction and Œ∏ is the angular blade position 2 Œ± g r Œ∏ œÜ r Œ≤ r Œ∏ as expected the minimum Œ± g is always located at 270 because of the effect of the inclined shaft while the maximum Œ± g is in correspondence to the decelerated wake peak in case of less pronounced wake peak and significant shaft inclination it may be located also at 90 as shown in fig 1 the output data of the system built in the present work is represented by the spectra of measured propeller noise and in particular the continuous part of the spectrum associated with cavitation noise spectra are usually analysed in one third octave band or in narrowband representation however the trends featured by single spectral rows may be rather complex and not so meaningful especially if compared to the general trends observed in the experiments in addition modelling the complete spectra would increase significantly the computational time due to this a simplified description of the spectra is defined keeping only the information of physical and practical relevance the adopted simplification shown in fig 6 reproduces the spectral shapes typical of cavitation noise which are described in subsection 2 3 this simplified spectrum is defined by the knowledge of the frequency and level of only five points these frequencies and levels summarized also in table 3 are the target of the developed models target frequencies are expressed in terms of logarithm of the frequency to keep the logarithmic sensitivity of noise to frequency the first portion of the spectrum from the starting point to the first break point is dominated by background noise or by tonal noise components hence not of interest in the present work the part of the simplified spectrum which can be reasonably considered representative of cavitation noise is identified by frequencies higher than those of the first break point hence the starting point is neglected in the following analyses besides starting and ending frequencies are constant and they do not need to be modelled hence the models targets are f bp 1 rnl bp 1 f c rnl c f bp 2 rnl bp 2 and rnl b 2 3 dataset exploration in this section some examples of cavitation noise measured during the present campaign are shown in order to analyze the main characteristics of noise spectra and the global trends which have to be modelled only an overview of results is presented focusing on one propeller pitch configuration namely the p2 at design pitch all the considerations reported in the following are valid for the whole data collection two subsets of operational conditions are considered and corresponding noise spectra are reported in fig 7 a and b these subsets are characterized respectively by a propeller load higher and similar to that corresponding to the real functioning of the propeller these plots allow correlating noise spectra with the cavitation index i e the cavitation extension all spectra are characterized by some common characteristics at very low frequency some thin and very prominent peaks are visible these are tones located at the blade passage frequency and its multiples and are not discussed in the context of the present work after these tones the continuous spectrum associated to cavitation is visible it is usually characterized by a maximum located at a mid low frequency and a mid high frequency spectrum with an almost constant decay depending on the characteristics of cavitation the maximum of the continuous spectrum may appear as a prominent peak in such a case the peak is typically due to the noise generated by the pulsation of the tip vortex cavity and it is of utmost importance in the study of ships radiated noise since it may characterize the signature of the full scale ships see as examples noise measurements reported in lloyd et al 2018 significantly affecting also on board noise and vibration levels this typical feature of tip vortex noise has been largely studied thomson 1880 morozov 1974 bosschers 2009 according to the theory the characteristic frequency of the peak corresponds to the resonance frequency of the vortex and decreases with increasing dimensions i e the vortex cavitating radius in addition to this cavitating vortices produce noise also through the evolution of the cavity volume driven by the inflow and through the presence of impulsive events like collapses rebounds and bursts the medium high frequency part of the spectrum may be associated again to tvc but also to other phenomena like sheet and bubble cavitation which usually become dominant if present the levels and the decay law of this component depend again on cavitation dimensions and dynamics for current cases tvc is always present and its behaviour is rather unstable because of the characteristics of the propeller inflow when the vortex dimensions are significant at higher propeller loading as in fig 8 a it becomes more stable and a prominent peak is observed in the spectrum see fig 7 a the central frequencies of these peaks tend to decrease when cavitation extent gets larger on the contrary when a thinner vortex is present as in fig 8 b the prominence of the peak is reduced and the characteristic frequencies of the spectrum may be less influenced by the cavity size see fig 7 b these trends qualitatively described above characterize all the noise measurements carried out in regimes of prevalent suction side cavitation an overall view of these trends in terms of frequency of the peak and correspondent level is shown in fig 9 a and b considering all the measurements carried out on the p2 at design pitch for confidentiality reasons frequencies and noise levels have been made non dimensional using as reference values the maximum value of the peak central frequency and the minimum value of the peak amplitude for the p2 dataset as it can be seen the frequency decreases moving to lower œÉ n œÉ n r e f and higher k t k t r e f hence moving from points characterized by weaker tvc to those featuring larger tvc extensions furthermore the dependency of the frequency on the cavitation extension is more evident for overloaded conditions while reducing propeller load variations w r t the cavitation number are considerably lower confirming what observed previously the amplitude of the peak presents higher levels where cavitation is more intense both tip vortex and sheet cavitation it is worth noticing that in correspondence to high loading conditions the peak amplitude increases up to a certain value while cavitation grows then it starts decreasing this phenomenon is not completely new and may be related to different causes like the more stationary behaviour of very large cavities or the interaction between sheet and vortex cavitation in general these contour plots demonstrate that the main features of noise spectra depend on propeller loading and cavitation extensions in good agreement with theories of cavitation noise 3 modelization in the proposed context a general modelization framework can be defined characterized by an input space x ‚Ñù d an output space y ‚Ñù and an unknown relation Œº x y to be learned for what concerns this work x is composed by the features reported in table 2 while the output space y refers to the cavitation noise spectrum frequencies and levels reported in table 3 in this context the authors define as model h x y an artificial simplification of Œº the model h can be obtained with different kinds of techniques for example requiring some physical knowledge of the problem as in pms or the acquisition of large amount of data as in ddms or both of them as in hms independently of the adopted technique any model h requires some data in order to be tuned or learned on the problem specificity and to be validated or tested on a real world scenario for these purposes two separate sets of data d n x 1 y 1 x n y n and t m x 1 t y 1 t x m t y m t need to be exploited to respectively tune h and evaluate its performances it is important to note that t m is needed since the error that h would commit over d n would be too optimistically biased since d n has been used to tune h hence the error that h commits on t m in approximating the real process is usually measured with reference to different indexes of performance ghelardoni et al 2013 the mean absolute error mae is computed by taking the absolute loss value of h over t m mae h 1 m i 1 m h x i t y i t the mean absolute percentage error mape is computed by taking the absolute loss value of h over t m in percentage mape h 100 m i 1 m h x i t y i t y i t the pearson product moment correlation coefficient ppmcc measures the linear dependency between h x i t and y i t with i 1 m ppmcc i 1 m y i t y h x i t y ÀÜ i 1 m y i t y 2 i 1 m h x i t y ÀÜ 2 where y 1 m i 1 m y i t and y ÀÜ 1 m i 1 m h x i t other state of the art measures of error exist such as r squared and or the mean square error but in this work these three are kept because from a physical point of view they give a complete description of the quality of the model and moreover adding more measures would make the results less readable in the following sections the authors will describe the possible modelling of the proposed input output relationships considering pms ddms and hms 3 1 physical models in the present work some physics based models for f c and rnl c are derived with a twofold objective provide a benchmark for comparison with ddms and provide features for the hms the tuning of parameters for the physical models is done by fitting on the whole data set hence no distinction between d n and t m has been done the frequency and the maximum level of the peak in the spectrum of tip vortex noise have been computed with an approach similar to the one presented in bosschers 2009 for the vortex resonance frequency and in raestad 1996 for the sound pressure level according to the approach used the vortex strength is assumed to be proportional to the thrust coefficient by means of the coefficient œÑ which represents the relative tip loading and it is here assumed to be dependent only on propeller geometry and wake field the vortex cavitating radius is then computed using the potential vortex model by making use of the experimental data presented in maines and arndt 1997 and formulations based on theoretical considerations it is possible to derive the resonance frequency of the vortex as given by eq 3 3 f c 0 45 œÄ 2 œÉ tip n z œÑ k t the cavitation index œÉ tip is based on the resultant velocity at the blade tip v r e f v a 2 œÄ n d 2 and z is the blades number by doing this the only unknown parameter is the coefficient œÑ which can be obtained by means of fitting the data collected in current experiments values obtained are reported in table 4 all the values are made non dimensional w r t the value of the parameter tuned on the whole dataset as explained below more in detail as expected the coefficient œÑ for a given propeller decreases while reducing the pitch indicating the overall reduced load for what regards the amplitude of the spectral peak the prediction is based on raestad 1996 and the relation between sound pressure levels and propeller functioning parameters is given by 4 rnl c a p 20 log 10 œÑ k t z œÉ n k z according to the work of raestad 1996 the value of the exponent k should be 2 however as pointed out also in bosschers 2018 the fitting with data is improved considering higher values for the present work the parameter k has been chosen equal to 3 the value of a p is instead directly estimated by fitting to experimental data when a new propeller is considered the values of a p and œÑ cannot be estimated from data fitting before experimental results are available hence it is important to define procedures for their estimation before experimental tests are carried out this problem could be overcome using procedures like that proposed in bosschers 2018 according to which the vortex strength is directly derived by boundary element methods bem computations and consequently the knowledge of œÑ is no more needed alternatively the value of these parameters may be correlated with available geometric or hydrodynamic characteristics of the propellers obviously the latter solution requires the availability of a significant number of test cases in case this is not possible the average values of the two coefficients obtained from previous experiments may be used as a first rough estimate in order to check how the accuracy of the pm is affected by this possible rough assumption the coefficients have been hence calculated also on the total set of tests available without differentiating among different propellers and pitch settings the values of these latter fitting coefficients have been used to make non dimensional those obtained for the different cases as in table 4 in the following two pms are considered the first one pm1 makes use of all the values of coefficients a p and œÑ derived for each propeller configuration the second one pm2 uses only values resulting from the fitting on the complete dataset without propeller and pitch setting distinction a schema of the pm is reported in fig 10 as a resume of the operations executed 3 2 data driven models the problem here considered from the data science point of view can be straightforwardly mapped in a typical machine learning ml regression problem vapnik 1998 shawe taylor and cristianini 2004 in fact ml techniques aim at estimating the unknown relationship Œº between input and output through a learning algorithm a h which exploits the data in d n to learn h and where h is a set of hyperparameters which characterizes the generalization performance of a oneto 2018 in this paper a method from the ml kernel methods family called kernel regularized least squares krls has been adopted in order to estimate the relation between f bp 1 rnl bp 1 f c rnl c f bp 2 rnl bp 2 and rnl b and the variables of table 2 the idea behind krls is quite simple during the training phase the quality of the learned function h x is measured according to a loss function ‚Ñì h x y rosasco et al 2004 with the empirical error 5 l ÀÜ n h 1 n i 1 n ‚Ñì h x i y i a simple criterion for selecting the final model during the training phase could then consist in simply choosing the approximating function that minimizes the empirical error l ÀÜ n h this approach is known as empirical risk minimization erm vapnik 1998 however erm is usually avoided in ml as it leads to severe overfitting of the model on the training dataset as a matter of fact in this case the training process could choose a model complicated enough to perfectly describe all the training samples including noise which afflicts them in other words erm implies memorization of data rather than learning from them a more effective approach is to minimize a cost function where the tradeoff between accuracy on the training data and a measure of the complexity of the selected model is achieved tikhonov and arsenin 1979 implementing the simple occam s razor principle 6 h min h l ÀÜ n h Œª c h in other words the best approximating function h is chosen as the one that is complicated enough to learn from data without overfitting them in particular c is a complexity measure depending on the exploited ml approach different measures are realized instead Œª 0 is a hyperparameter that must be aprioristically set and is not obtained as an output of the optimization procedure it regulates the trade off between the overfitting tendency related to the minimization of the empirical error and the underfitting tendency related to the minimization of c the optimal value for Œª is problem dependent and tuning this hyperparameter is a non trivial task as it will be discussed later in this section in krls models are defined as 7 h x w t œï x where œï is an aprioristically defined feature mapping fm shalev shwartz and ben david 2014 which strongly depends on the particular problem under examination and will be described later in this section allowing to keep the structure of h x linear the complexity of the models in krls is measured as 8 c h w 2 i e the euclidean norm of the set of weights describing the regressor which is a quite standard complexity measure in ml shalev shwartz and ben david 2014 regarding the loss function the square loss is typically adopted because of its convexity smoothness and statistical properties rosasco et al 2004 9 l ÀÜ n h 1 n i 1 n ‚Ñì h x i y i 1 n i 1 n h x i y i 2 consequently problem 6 can be reformulated as 10 w min w i 1 n w t œï x y i 2 Œª w 2 by exploiting the representer theorem sch√∂lkopf et al 2001 the solution h of the rls problem 10 can be expressed as a linear combination of the samples projected in the space defined by œï 11 h x i 1 n Œ± i œï x i t œï x it is worth underlining that according to the kernel trick it is possible to reformulate h x without an explicit knowledge of œï and consequently avoiding the course of dimensionality of computing œï by using a proper kernel function k x i x œï x i t œï x 12 h x i 1 n Œ± i k x i x several kernel functions can be retrieved in literature scholkopf 2001 cristianini and shawe taylor 2000 each one with a particular property that can be exploited based on the problem under exam the krls problem of eq 10 can be reformulated by exploiting kernels as 13 Œ± min Œ± q Œ± y 2 Œª Œ± t q Œ± where y y 1 y n t Œ± Œ± 1 Œ± n t the matrix q such that q i j k x j x i and the identity matrix i ‚Ñù n n by setting equal to zero the gradient w r t Œ± it is possible to state that 14 q Œª i Œ± y that is a linear system for which effective solvers have been developed over the years allowing coping with even very large sets of training data young 2003 the problems that still have to be faced is how to choose œï the kernel k and how to set up the hyperparameter Œª it is possible to start by setting œï and the kernel k generally the input features of d n are subject to a process of transformation this process is usually referred as fm shalev shwartz and ben david 2014 since the input features are mapped from an initial input space x to a new input space œà in this way the fm procedure allows to find a new suitable representation œï x œà of the data x x by defining a function œï x œà mapping x to a new feature space where it is possible to then learn a simple linear model like the one defined by the krls fm is usually adopted since the new feature space œà could enhance the performance capability of the predictor depending on the values of x and y in this work the adopted fm was selected considering the acquired expertise and knowledge of the cavitation noise phenomenon by applying the following fm 15 œï x i 1 5 d v i k i i 1 5 d k i j j 0 1 p t ‚Ñù j 0 p 5 d j v x 1 x d 1 x 1 1 x d ln x 1 ln x d e x 1 e x d e x 1 e x d t ‚Ñù 5 d in fact based on this fm it is possible to represents with a simple linear combination all the possible functions with an opportune value of p and where each feature is a physically plausible term of the function the problem of the fm of eq 15 is that its computation is computationally unfeasible if d or p are large since the problem is np hard nevertheless remembering that in krls it is possible to exploit the kernel trick and noting that the proposed fm can be expressed with a simple polynomial kernel 16 œï a t œï b v a t v b c p k a b v a a 1 a d 1 a 1 1 a d ln a 1 ln a d e a 1 e a d e a 1 e a d v b b 1 b d 1 b 1 1 b d ln b 1 ln b d e b 1 e b d e b 1 e b d it is possible to avoid the np hard problem and use the desired fm note that p 0 1 is the desired degree of the polynomial and c 0 is a parameter trading off the influence of higher order versus lower order terms in the polynomial p and c together with Œª are hyperparameters that need to be tuned in order to optimize the performance of the final model unfortunately during the fm many unnecessary features have been generated which are either redundant or not informative as a result a feature selection phase is required in order to increase the generalization performance of the model by selecting only the most informative features which best represent the problem to be solved and discarding the others guyon and elisseeff 2003 for this purpose authors will adopt the backward elimination techniques described in guyon and elisseeff 2003 the last problem that it is possible to solve is how to tune the hyperparameters p c and Œª of the proposed method since every ml model is characterized by a set of hyperparameters h influencing their ability to estimate Œº a proper model selection ms procedure needs to be adopted oneto 2018 several methods exist for ms purpose but resampling methods like the well known k fold cross validation kcv kohavi et al 1995 or the nonparametric bootstrap bts efron and tibshirani 1994 approaches represent the state of the art ms approaches when targeting real world applications resampling methods rely on a simple idea the original dataset d n is resampled once or many n r times with or without replacement to build two independent datasets called training and validation sets respectively l l r and v v r with r 1 n r note that l l r v v r l l r v v r d n then in order to select the best combination the hyperparameters h in a set of possible ones ‚Ñå h 1 h 2 for the algorithm a h or in other words to perform the ms phase the following procedure has to be applied 17 h min h ‚Ñå 1 n r r 1 n r 1 v x i y i v v r ‚Ñì a h l l r x i y i where a h l l r is a model built with the algorithm a with its set of hyperparameters h and with the data l l r since the data in l l r are independent from the ones in v v r the idea is that h should be the set of hyperparameters which allows to achieve a small error on a data set that is independent from the training set in this work authors will exploit the bts procedure and consequently r 500 if l n and the resampling must be done with replacement oneto 2018 a schema of the ddm is reported in fig 11 as a resume of the operations executed 3 3 hybrid models the problem that authors want to face here is how to construct a model able to both take into account the physical knowledge about the problem encapsulated in the pms of section 3 1 and the information hidden in the available data as the ddms of section 3 2 for this purpose authors will start from a simple observation a hm based on the previous observation should be able to learn from the data without being too different or far away from the pm from the data science point of view this requirement can be straightforwardly mapped in a typical ml multi task learning mtl problem baxter 2000 caruana 1997 evgeniou and pontil 2004 bakker and heskes 2003 argyriou et al 2008 caruana 1997 1997 mtl aims at contemporary learning two concepts in this case the pm and the available data through a learning algorithm a h which exploits the data in d n to learn a function h which is both close to the observation the data d n and the pm namely its forecasts since for building a hm also a pm is needed authors will develop a model to estimate the relation between f c and rnl c and the variables of table 2 since the pm is only available for f c and rnl c consequently in this case a slightly different scenario is presented where the dataset is composed by a triple of points d n x 1 y 1 p 1 x n y n p n where p i is the output of the pm in the point x n with i 1 n the target is to learn a function able to approximate both Œº namely the relation between the input x x and the output y y and the pm namely the relation between the input and the output of the pm basically two tasks have to be learned for this purpose there are two main approaches the first approach is called shared task learning stl and the second independent task learning itl while the latter independently learns a different model for each task the former aims to learn a model that is common between all tasks a well known weakness of these methods is that they tend to generalize poorly on one of the two tasks baxter 2000 in this paper authors show that an appealing approach to overcome such limitations is provided by mtl baxter 2000 caruana 1997 evgeniou and pontil 2004 bakker and heskes 2003 argyriou et al 2008 this methodology leverages on the information between the tasks to learn more accurate models in order to apply the mtl approach to this case it is possible to basically just modify the krls problem of eq 10 in order to contemporary learn a shared model and a task specific model which should be close to the shared model in this way authors obtain a model which is able to contemporary learn the two tasks the model that authors are interested in is the first one while the task specific models are just used as a tool a shared model is defined as 18 h x w t œï x and two task specific models as 19 h i x w i t œï x i y p then it is possible to state the mtl version of eq 10 20 w w y w p min w w y w p i 1 n w t œï x y i 2 w t œï x p i 2 i 1 n w y t œï x y i 2 w p t œï x p i 2 Œª w 2 Œ∏ w w y 2 w w p 2 where Œª is the usual regularization of krls and Œ∏ 0 instead is another hyperparameter that forces the shared model to be close to the task specific models basically the mtl problem of eq 20 is a concatenation of three learning problems solved with krls plus a term which tries to keep related all the three different problems by exploiting the kernel trick as in krls it is possible to reformulate problem 20 as follows 21 Œ± min Œ± q q 0 0 q q 0 0 0 0 q 0 0 0 0 q 2 Œ± t Œª 2 Œ∏ q Œª 2 Œ∏ q Œ∏ q Œ∏ q Œª 2 Œ∏ q Œª 2 Œ∏ q Œ∏ q Œ∏ q Œ∏ q Œ∏ q Œ∏ q 0 Œ∏ q Œ∏ q 0 Œ∏ q Œ± where p p 1 p n t the solution of this problem is again equivalent to solving a simple linear system 22 q Œª 2 Œ∏ i q Œª 2 Œ∏ i Œ∏ i Œ∏ i q Œª 2 Œ∏ i q Œª 2 Œ∏ i Œ∏ i Œ∏ i Œ∏ i Œ∏ i q Œ∏ i 0 Œ∏ i Œ∏ i 0 q Œ∏ i Œ± y p y p the function that authors are interested in the shared one can be expressed as follows 23 h x w t œï x i 1 n Œ± i Œ± i n k x i x by exploiting the same fm and feature selection of the ddms see section 3 2 the hms are obtained what changes is the ms phase where Œª c and p have been tuned as for the ddms but also Œ∏ a schema of the hm is reported in fig 12 as a resume of the operations executed 4 results and discussion in this section the performances of the pms ddms and hms see sections 3 1 3 2 and 3 3 will be tested and compared by means of the data described in section 2 in two different scenarios interpolation scenario in this case models try to predict the propeller noise spectra main characteristics in various but different working conditions within the ones exploited for building the model these tests are useful to check the capability of the model to provide predictions starting from the knowledge of the characteristics and the cavitating behaviour of the propeller extrapolation scenario in this case models try to predict the propeller noise spectra main characteristics in groups of working conditions where the cavitation intensity is very different w r t the one exploited for building the model these tests are useful to check the capability of the models to predict the noise related to cavitation patterns which cannot be reproduced at model scale basically the two scenarios just differ in the way d n and t m have been built in other words the two scenarios differ in the subset of data exploited for building and testing the models for what concerns the pms the pm1 and pm2 described in section 3 1 will be considered as described in section 3 1 pm1 and pm2 are just able to predict f c and rnl c based on a subset of the input variables described in table 2 for what regards the ddms the custom algorithm described in section 3 2 will be used ddms are able to predict f bp 1 rnl bp 1 f c rnl c f bp 2 rnl bp 2 and rnl b based on all the input variables reported in table 2 the set of hyperparameters tuned during the ms phase are h p c Œª chosen in ‚Ñå 1 2 10 10 4 10 3 10 4 10 4 0 10 3 8 10 4 0 for the hms the custom algorithm described in section 3 3 will be exploited hms are able to predict just f c and rnl c based on all the input variables reported in table 2 and the pms of section 3 1 the values of f bp 1 rnl bp 1 f bp 2 rnl bp 2 and rnl b cannot be predicted by hms since no pms are available for these features and consequently ddms have to be used finally since two pms are available two hms hm1 and hm2 will be considered exploiting respectively the pm1 and the pm2 the set of hyperparameters tuned during the ms phase are h p c Œª Œ∏ chosen in ‚Ñå 1 2 10 10 4 10 3 10 4 10 4 0 10 3 8 10 4 0 10 4 0 10 3 8 10 4 0 all the tests have been repeated 30 times and the average results are reported together with their t student 95 confidence interval in order to ensure the statistical consistency of the results the indexes of performance for the frequencies are reported in h z 4 1 interpolation scenario the interpolation case is the simplest one in this scenario d n and t m have been created by splitting randomly the whole 164 samples keeping 90 of the data in d n and the remaining 10 in t m in this way the models have been tested in their ability to predict the propeller noise spectra main characteristics in various but different working conditions within the ones exploited for building the model in table 5 the performance of pms ddms and hms in predicting the noise spectra main characteristics are reported the performance are measured with the mae the mape and the ppmcc the table reports the full set of results for completeness the best performing models are underlined in bold from the table it is clear how the hms are in the most cases the best performing ones followed by the ddms the pms are usually the worse performing models unfortunately the full table is not easy to interpret nor very informative and for this reason in the next sections a series of scatter plots is used to give a better interpretation of the results 4 1 1 physical models results fig 13 reports the scatter plots of the measured and predicted values of f c and rnl c for both pm1 and pm2 from fig 13 it is possible to observe that there is a significant variance of the results depending on the different tests especially for f c data points tend to distribute with an angle between the measured and predicted values which is slightly different from 45 clearly underlining a problem in the pm adopted as expected the accuracy of the pm1 model is significantly better than the one of the model pm2 however from a qualitative point of view results reported in the scatter plots evidence the same problems in both cases the pm implemented in this work seems to provide only a rough approximation of the dependency of f c and rnl c on the input parameters in the case of the pm1 the values of the parameter œÑ have been tuned on the available experiments assuming its value is not dependent on the operational conditions but only on propeller configuration while for pm2 œÑ it is assumed constant on the whole data set the observed results point out also the limits of these assumptions furthermore one of the main problems related to pms is that in some cases the noise spectra within the available data present a behaviour similar to the one schematized by the pm whereas in other cases a significantly different behaviour is observed with the frequency of the maximum weakly depending on cavitation size the pm is not able to discriminate between these different situations and its accuracy decreases when the cavitation noise is not mainly driven by the tip vortex pulsation e g when the propeller pitch is lower this may contribute to the significant variance observed 4 1 2 data driven models results fig 14 reports the scatter plots of the measured and predicted values of f bp 1 rnl bp 1 f c rnl c f bp 2 rnl bp 2 and rnl b for the ddms from fig 14 it is possible to observe that considered targets are predicted with a reasonable accuracy by the model demonstrating that trends present in the experimental data can be effectively modelled by the ddms the ddms seems to correctly predict the targets considering also the different behaviours of cavitation noise spectra observed which represented one of the limits of the considered pms the results show significantly different trends depending on the considered target a reasonable agreement between measured and predicted data is observed for targets f c rnl c and rnl b even if some variance is present a good agreement is observed also for the target rnl bp 1 but in this case there seems to be a deterioration of the prediction performance for the highest values in the distribution the distributions of points on the scatter diagrams highlight some problems for what regards targets f bp 1 f bp 2 and rnl bp 2 points are partially clustered around certain values with a significant number of samples spread over the plot without a clear tendency these results point out some limits of the definition of the targets for the prediction of noise spectra the simplified spectral shape adopted effectively succeeds in modelling measured noise spectra even considering both spectral shapes observed namely with and without prominent peak the issues may be related to the definition of the parameters used to describe the simplified spectra namely frequencies and levels of the points actually the frequency and levels of the two breakpoints used to define the simplified shape do not feature a clear physical meaning and consequently they are not characterized by clear tendencies as other targets the first break point roughly corresponds to the frequency above which the cavitation noise spectrum is perceived over the background noise as a consequence the frequency of this point and its corresponding level depends not only on the characteristics of cavitation noise but also on the spectrum of the background noise in the tunnel the second break point divides the spectrum into two regions characterized by different decay ratio of noise w r t frequency the decreasing part of the peak when present with a larger decay ratio and the high frequency spectrum with lower decay these two regions are clearly distinguished only when a prominent peak is identified otherwise an almost constant decay is observed from the maximum point of the spectrum towards higher frequencies in the latter case the definition of the break point is uncertain and consequently f bp 2 and rnl bp 2 may assume anomalous values these issues might be overcome in different ways modifying the simplified representation of spectra or simply employing different parameters to describe it as an example the decay ratio i e the slopes of the curve in the two mentioned regions of the spectrum could be considered in place of the break point actually these parameters should allow to correctly describe the spectra as well and they should not present anomalous values even when the distinction between the two regions becomes meaningless the adoption of alternative parameters and its effect will be subject of future activities evaluating the performance of the ddms in terms of accuracy is just the first step toward understanding them in fact these models are black box and consequently the learned relation between inputs and outputs is not explicitly known since kernel methods were exploited to extract the explicit form of the model evaluating the relationship between inputs and outputs would be in most cases impossible while in some cases computational intractable shawe taylor and cristianini 2004 in order to overcome this limitation it was decided to perform a feature ranking fr procedure guyon and elisseeff 2003 liu and motoda 2007 which allows to rank the features based on their effect on the model output for this purpose a very statistically sound and robust approach called permutation test was exploited good 2013 fran√ßois et al 2006 table 6 reports the result of the fr procedure on the models which predict f c and rnl c before analyzing the result of the fr procedure in details it is worth noting that most of the considered features are strongly dependent or even redundant e g propeller thrust and torque or the alternative definitions of the cavitation number this means that fr can detect as important just one or all of this strongly correlated features some of them or all of them which basically contain the same information in fact one has to remember that the fr procedure is a statistical procedure and consequently subject to uncertainties and statistical fluctuations and consequently it does not make sense to make very specific comments while it is more reasonable to observe global trends having said this it is possible observe that not surprisingly the inception indexes of the driving phenomena i e tip vortex at 0 detached tip vortex and suction side sheet at 0 are always in the top 3 this confirms the strong relation between measured noise and the cavitation intensity the knowledge summarized in eq 3 about the resonance frequency of the vortex can be found also in the fr indeed the torque coefficient in place of the thrust coefficient the relative pressure in place of the cavitation index and the propeller rotational speed are in the top 10 features for importance similarly the sound pressure level of the vortex peak whose theoretical expression of eq 4 identifies in the propeller load and the cavitation index the most valuable parameters is checked by fr in general it can be observed the most influencing variables in the noise generation are among the most important ones according to the fr furthermore it is interesting to notice the absence in the top positions of features assumed to be strongly related to the cavitation noise as an example the wake parameters this can be justified recalling that some features such as the cavitation inception directly depend on the wake or some others as the angle of attack are derived from it hence wake features could be redundant 4 1 3 hybrid models results fig 15 reports the scatter plots of the measured and predicted values of f c and rnl c for both hm1 and hm2 from fig 15 it is possible to observe that there is a significant enhancing of the performances of the ddms by using the pms moreover the results show that the use of a more generic set of coefficients pm2 does not lead to a noticeable degradation of the performance of the hms making them very attractive and promising in view of future enlargements of the experimental dataset 4 2 extrapolation scenario from a practical point of view it is of great interest to test the capability of the models to predict radiated noise for cases not included in the variable domain of the data used to build them actually new cases of interest might be characterized by values of the input variables not included between those considered but still similar to them this may be the case of a new propeller designed with operating requirements different from those considered as already anticipated another important application of the models developed is related to those ship operational conditions for which the cavitation pattern cannot be correctly reproduced in model scale requiring an extrapolation in order to better present the problem the typical cavitation bucket of a model scale propeller is schematized in fig 16 the full scale working point is characterized by the values of the thrust coefficient and cavitation number of the full scale propeller in some cases for this combination of values the model scale propeller does not cavitate because of viscous scale effects affecting the development of vortices however applying scaling formulas like those proposed by mccormick 1962 or shen et al 2009 it is possible to assess if tvc is present in full scale and roughly estimate its extension by means of the œÉ n œÉ n i n c ratio or similar quantities in order to reproduce the same cavitation extension in model scale some scaling criterion must be applied such as the identity of the ratio œÉ n œÉ n i n c the test conditions obtained following this approach i e the scaled working point in the example are in some cases located on the bucket in the hatched area in this area the presence of unwanted phenomena like bubble cavitation or other measuring issues e g bubble scattering may alter the measured noise and also the development of the vortex cavitation itself as a consequence the direct measurement in such conditions is deemed not meaningful radiated noise in the hatched area should be predicted eliminating the unwanted effects thus obtaining a sort of ideal model scale experiment the proposed approach basically consists in developing a model based only on operational conditions without unwanted phenomena these conditions correspond to the areas identified by numbers from g1 to g6 in fig 16 these areas are defined by combinations of the quantities k t k t r e f and œÉ n œÉ n i n c of the tvc the model based on these data is able to predict noise for different extensions of tvc and different combination of input parameters without modelling the unwanted phenomena the target conditions in the hatched area are characterized by a combination of input parameters not included in the set of data used to define the model hence an extrapolation is needed since validation data for the target region is not available it is not possible to directly test the capability of the model to extrapolate in this area in order to obtain an indication of such capability the extrapolation performance between different subsets of data corresponding to the numbered areas in fig 16 has been assessed in particular the extrapolation test consists in including in d n only five of the six groups and use the sixth group as t m from the point of view of the physical problem here summarized i e the prediction of the hatched area the most interesting extrapolation cases are those for which t m is represented by points belonging to the zones 1 2 and 3 in table 7 analogously to table 5 in section 4 1 the full set of results are reported and they are complemented with a series of scatter plots in order to better comment them note that in this case the results are not checked based on the propeller characteristics but based on the group membership see fig 16 looking at table 7 it is clear that the ddms and the hms are able to effectively make predictions in the extrapolation setting and to provide estimation which can be reliable in a real world application of the method showing their ability to extrapolate and not just interpolate figs 17 19 analogously to figs 13 15 in section 4 1 report the scatter plots of the measured and predicted values of f bp 1 rnl bp 1 f c rnl c f bp 2 rnl bp 2 and rnl b for the pms if available the ddms and the hms if available respectively the extrapolation performance of the ddms and hms are promising and related results seem to confirm the validity of the proposed approach the accuracy of the extrapolation is remarkable for all the groups except g5 for which however results are still acceptable anyway it has to be remarked that for the sake of extrapolation to critical conditions previously described the extrapolation of group g5 is not so important presenting this group the highest deviations in terms of cavitating behaviour from the design conditions on the contrary results obtained for the extrapolation of groups g1 g2 and g3 are definitely encouraging 5 conclusions in this paper a procedure to estimate propeller cavitation noise by means of numerical models has been presented the goal is to predict the significant characteristics of the cavitation noise spectra using data available at propeller design stage this will help the designer to implement suitable countermeasures to mitigate the generation of unwanted noise limiting one of the major sources of anthropogenic noise with this purpose in mind a simplification of the propeller noise spectra has been proposed and a model able to predict its features on the base of quantities that can be estimated at design stage has been developed three different modelization strategies have been presented one based on the physical knowledge of the problem one based on data science and one based on a hybrid approach able to exploit both the two sources of information an extensive set of cavitation tunnel tests performed with different propellers and different configurations allowed the creation of a database exploited for developing and testing the different models an in depth comparison of the performance of the different models has been performed in particular two sets of evaluations have been carried out in the first set the capability of the models to predict the propeller noise spectra main characteristics in working conditions within the ones exploited for building the model has been analysed in all cases conditions different from those used to build the model have been used for the test but always remaining inside the initial domain in the second set of trials instead the capability of the models to predict the propeller noise spectra main characteristics in groups of working conditions where the cavitation intensity is different w r t the one exploited for building the model has been tested in both scenarios hms have shown remarkable and promising results opening the way to future works in this direction next steps of the research here presented will include several improvements of the promising modelling procedure including some aspects summarized in the following the presented analysis has been limited only to a class of similar propellers and configurations deemed of remarkable interest in order to generate a collection of data with a tolerable variance it is planned for future activities to enlarge the data collection considering further propellers and wake fields this will require the use of an enlarged set of features including more parameters describing propeller geometries e g expanded area ratio camber chord etc furthermore transfer function corrections will be added to the procedure in order to allow the modelling of different propeller hydrophones configurations most important transfer functions will allow including in the model the effect of the confined environment providing an estimate of propeller source levels in free field conditions furthermore results obtained with the hybrid model suggest investigating this approach considering also other physical models or semi empirical formulations available in literature with the aim of further improve the already remarkable results of the developed models acknowledgements the authors wish to express their gratitude to fincantieri mm arc office which kindly provided the propeller models used in the present work appendix a supplementary data the following is the supplementary data to this article multimedia component 1 multimedia component 1 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j oceaneng 2019 02 002 
22900,ships underwater radiated noise is a subject of great and increasing interest in naval architecture because of its impacts on the environment and on the on board comfort among the different noise sources the propeller is usually the dominant one especially when it cavitates for this reason a lot of efforts have been spent in studying the cavitation noise spectra in order to be able to predict its main characteristics at design stage nowadays in order to reach this goal the state of the art solution is to perform model scale experiments unfortunately this requires time consuming tests in a cavitation tunnel with a model of the propeller and results are affected by scale effects that must be correctly interpreted for these reasons in this paper authors propose a hybrid approach which may be adopted to predict the main characteristics of the cavitation noise spectra without requiring an actual experiment moreover the same approach may be used also in order to overcome typical model scale problems for this purpose a hybrid modelling approach able to exploit both the physical knowledge of the problem and the real data obtained from many cavitation tunnel experiments performed on different propellers in different working conditions have been developed results on real data in both interpolation and extrapolation tasks will support the validity and the effectiveness of the proposal keywords marine propeller cavitation noise prediction spectra parametrization data driven model hybrid model 1 introduction in recent years ships underwater radiated noise urn has become subject of great interest because of the increasing attention to the environmental impact of human activities council of european union 2008 and the improved sensibility to the on board comfort imo 2012 in this context much effort has been spent in the study of propeller noise since it represents the dominating noise source on ships especially when it cavitates ross 1976 the prediction of propeller cavitation noise can be addressed by means of different approaches as summarized in fig 1 the approach based on computational fluid dynamics cfd models bensow and bark 2010b a is able to predict directly the full scale fs noise knowing hull and propeller geometry and ship s operating conditions cfd based models even if showing promising capabilities are still under development and their high computational requirements limit their use to the field of research making it impractical in a conventional propeller design loop the second approach is the adoption of model scale tests mst which are mainly carried out in cavitation tunnels this approach is still largely considered the most reliable method for cavitation noise prediction mst makes use of a model of the propeller manufactured using the geometry from the design which is tested reproducing cavitation conditions in order to measure the model scale ms noise scale effects must be carefully taken into account in order to retrieve the full scale noise in particular the development of tip vortex cavitation tvc is significantly influenced by the reynolds number as remarked by mccormick 1962 the onset of tvc in model scale occurs at significantly lower cavitation number than on the full scale propeller as a consequence for some ship operational conditions it is not trivial to correctly reproduce the cavitation pattern in mst moreover mst are quite expensive and time consuming it is not feasible to include them in the early stage of the design as a consequence it is of interest to replace mst with a tool that is able to predict the propeller noise by having only the information about the propeller geometry the inflow wake and cavitation behaviour in fact these characteristics are all known in the design stage or may be predicted e g by means of cfd calculations without mst these tools can be built with different approaches the most common one is to build simplified physical models pms combined with empirical relations defined from experimental data examples of such approaches in the study of propeller cavitation noise are represented by the work of raestad 1996 and bosschers 2018 the limitation of these pms lies in the fact that due to the undergoing simplifications they are not able to accurately describe the phenomenon of cavitation noise taking into account all the complex aspects involved and the complete cavities dynamics consequently the quality of the results may not be completely satisfactory requiring an ad hoc tuning on experimental data by means of fitting parameters for this reason in this paper the authors propose to employ data driven models ddms vapnik 1998 gy√∂rfi et al 2006 which are able to build models exploiting robust statistical inference procedures and data collected in previous experiments in order to make predictions about previously unseen cases a possible advantage of these methods is represented by the fact that there is no need of any a priory knowledge about the underlying physical system furthermore thanks to the nature of these approaches it is possible to exploit even data regarding particular phenomena that cannot be easily modelled with a pm ddms have proved to be valuable instruments in many marine applications petersen et al 2012 smith et al 2013 coraddu et al 2017 cipollini et al 2018 and recently aktas 2017 proposed a promising artificial neural network approach for the prediction of the propeller cavitation noise in full scale given a number of design parameters and a large collection of noise samples from cavitation tunnel tests however ddms usually produce black box non parametric models that are not supported by any physical interpretation this despite representing a possible advantage as mentioned above may limit the capability of the models themselves without exploiting important knowledge about the phenomena of interest moreover in general a great amount of historical data is necessary in order to build reliable models for these reasons in this paper authors propose a hybrid approach namely hybrid models hms in order to take advantage of the best characteristics of both pms and ddms by combining them together in fact hms are able to combine the statistical information acquired by analyzing the collected data with the physical equations describing the occurring phenomenon thus considering both the theoretical and the empirical sides of an experiment hms are widely used in those contexts were the experience on the field brought by pms can enhance the ddms prediction coraddu et al 2017 both ddms and hms require the availability of a significant amount of data in order to model the ship radiated noise full scale measurements carried out during sea trials should be used however this kind of data presents some practical issues one of the major problem is that the availability of such data is very limited in addition it is not trivial to identify and separately study the propeller contribution in full scale measurements on the other hand msts provide the opportunity to collect a large amount of data from dedicated experiments in a controlled environment hence suitable for the definition of a cavitation noise model which can replace an actual mst in the cavitation tunnel for these reasons it was decided to define models based on mst data such a model is able to replace mst and predict ms noise which must then be extrapolated to fs using suitable scaling formulas according to this approach also scale effects are modelled hence they are not automatically eliminated however as it will be shown the proposed approach allows also to deal with some of these unwanted effects in order to develop and test the models proposed in this paper authors have first collected a dataset by means of an extensive set of cavitation tunnel mst of two controllable pitch propellers of twin screw ships then the propeller urn has been parameterized with a simple procedure which allows to extract its main characteristics the modelization of only the continuous spectrum broadband of cavitation noise is addressed in this work neglecting tonal components different models pms ddms and hms have been developed for predicting these main characteristics based on quantities that can be estimated without performing any mst this is done with the aim in the future to obtain a prediction tool for the estimation of the propeller noise once a larger set of data will be available in parallel to this the same tool may be adopted in order to predict propeller noise in correspondence to conditions which cannot be reproduced in model scale with these two objectives the models have been validated with the real data in two different scenarios interpolation scenario in this case models try to predict the propeller noise spectra main characteristics in various but different working conditions within the ones exploited for building the model extrapolation scenario in this case models try to predict the propeller noise spectra main characteristics in groups of working conditions where the cavitation intensity is different w r t the one exploited for building the model these extrapolation tests are useful to test the capability of the models to predict the noise related to cavitation patterns which cannot be correctly reproduced at model scale results show that the proposed hms accuracies are remarkably higher than the ones of pms and ddms both in interpolation and extrapolation scenarios the rest of the paper is organized as follows section 2 describes the mst performed in the cavitation tunnel the data collected during the experiments and the cavitation noise spectra parametrization method section 3 reports the adopted pms and ddms and the proposed hms the validation of pms ddms and hms in the two scenarios described above are reported in section 4 finally section 5 concludes the paper due to confidentiality issues sensitive data like propeller geometry and working conditions will be omitted or altered by means of appropriate reference values kept constant for the whole article 2 model scale tests in this section a general description of the mst performed in the cavitation tunnel and the collected data is reported in particular in section 2 1 the experimental setup is described reporting main propellers and wake characteristics and configuration in the cavitation tunnel in section 2 2 the criteria adopted for the choice of the measuring points are reported together with the parameters chosen for characterising the propeller functioning and the simplification of the noise spectrum finally in section 2 3 some examples of typical outcomes of the measurements are reported experiments have been performed at the cavitation tunnel of the university of genoa for a detailed description of the facility see tani et al 2017 mst have been performed for a total of 425 propeller loading conditions chosen in order to properly explore the variables domain each test corresponds to a row of the dataset matrix 2 1 experimental setup all mst have been performed on two controllable pitch propellers respectively referred as propeller 1 p1 and propeller 2 p2 tested at various pitch settings the main characteristics are reported in table 1 one single wake field has been considered for each propeller the axial wake fields are simulated by means of a mock up of the shaft line with brackets and a small dummy hull on which wake screens are mounted to better reproduce typical wake fields of twin screw vessels shaft inclination is adopted in order to reproduce the significant upward velocity component present in twin screw ships as shown in fig 2 the axial wake fields reproduced in the cavitation tunnel for the p1 and the p2 are respectively shown in fig 3 on left and right sides in fig 3 z r and y r are respectively the vertical and the transversal coordinate w r t the propeller centerline both normalized to the propeller radius r the axial wake 1 w x is the ratio between the axial velocity v a in the propeller disk and the undisturbed one v namely 1 w x v a v for each propeller a complete set of tests has been performed cavitation bucket cavitation observations pressure pulses and propeller radiated noise measurements in a large set of operational conditions all these measurements provide detailed information about cavitation typologies present and their extensions for a wide range of operational conditions to allow correlating measured noise with these values radiated noise measurements were carried out with two hydrophones respectively referred as h1 and h2 in fig 2 h1 is located inside a tank full of water attached to the plexiglas window under the propeller h2 is mounted on a fin immersed in the tunnel flow outside of the propeller slipstream only data acquired by the latter have been used in this work because of the better signal to noise ratio the propeller loading conditions for model tests are defined according to the identity of the thrust coefficient k t and the cavitation number based on rotational speed œÉ n the first coefficient represents the kinematic condition of the propeller while the cavitation number defines a cavitation similarity criterion noise measurements have been performed mainly following the international towing tank conference ittc model scale noise measurement guidelines ittc specialist committee on hydrodynamic noise 2017 data used for the following analyses are spectra of the radiated noise levels rnl at the distance of 1 m from the propeller center disk obtained after having applied the background noise correction the transfer function correction for the confined environment effect tani et al 2016 brian√ßon et al 2013 is identical for all the noise measurements considered in present work hence it has not been applied here since it does not affect the analysis of the modelling approaches considered thus the developed models describe the characteristics of noise spectra measured inside the cavitation tunnel in order to compute free field noise spectra transfer function corrections could be applied to noise spectra predicted by the models the application of transfer functions to noise spectra used in building the model is needed when considering results of tests carried out with different configurations or from different institutes e g aktas et al 2018 activities which may represent possible future improvement of this work as a consequence transfer functions will be considered for future activities 2 2 dataset creation the working conditions for which noise samples are collected have been chosen in order to provide an exhaustive characterization of cavitation noise furthermore within all possible cavitation typologies the attention is voluntarily focused on those phenomena which provide a deeper insight on the real propeller functioning the most important phenomenon is probably the tvc since it is usually the first cavitation type occurring on a full scale propeller and the most difficult to be avoided also for those propellers suitably designed to limit cavitation other phenomena of practical relevance are the suction side sheet cavitation and pressure side cavitation models presented in this work are developed using a subset of these working conditions characterized by the presence of only suction side cavitation and not affected by unwanted phenomena like remarkable bubble cavitation accordingly samples have been reduced to 164 the characterization of propeller cavitation is represented by the cavitation bucket in fig 4 the cavitation bucket for the p2 at design pitch is reported as an example while others are not presented for the sake of shortness nevertheless the following considerations are valid for the whole data collection the cavitation bucket reports the inception of different cavitation phenomena as function of the thrust coefficient and cavitation number in particular the curves on the right part of the figure higher propeller loading correspond to phenomena originated on the suction side of the blade whereas the curves on the left part correspond to pressure side ones these can be divided by cavitation typologies in vortices tvc vortex from sheet face sheet cavitation and bubbles moreover the same phenomenon may be further subdivided considering its location as an example the labels tvc 90 and detached tvc refer to tip vortex cavitation occurring at angular positions between 90 and 180 connected to the blade in the first case present only downstream in the second in such positions the vortex is usually rather stable and its noise is not very high the tvc 0 referring to tip vortex cavitation occurring where the blades encounter the hull wake is significantly more unstable and noisy the general criterion is to pick noise up in correspondence to a series of functioning points identified from the analysis of the cavitation bucket in order to characterize the propeller behaviour in different conditions in particular as mentioned large attention has been given to tvc with this aim an attempt has been made to collect many measurements for functioning conditions with the presence of tvc alone in order to achieve this it has been necessary to include also very off design conditions that are points identified by values of the thrust coefficient significantly different from those corresponding to the real functioning of the propeller actually moving to overloaded conditions the tip vortex inception index increases remarkably and it is possible to analyze tip vortex noise at different degrees of development before the onset of other phenomena quantities collected for the working points defined above are summarized in table 2 these values represent the features considered as possible input for the model developed as it will be described in section 3 the features include some characteristics of the propeller geometry the characteristics of propeller inflow and the propeller working conditions in terms of kinematic conditions propeller loading and cavitation all these quantities are usually available at the propeller design phase exception made for the inception indices which may be estimated anyway by dedicated cfd simulations with reasonable accuracy see gaggero et al 2014 as an example it has to be remarked that the cfd simulations needed to obtain the inception indices are much more accurate and computationally inexpensive than those required to estimate directly the model scale noise the propeller cavitation pattern is described by the parameter œÉ n œÉ n i n c that is the ratio between the actual cavitation number based on the tip peripheral speed v r e f n d and the inception index for the phenomenon both measured w r t the static pressure on the shaft line these parameters indicate if a certain phenomenon is present and provide an indication about its extension other two definitions of the cavitation index have been considered œÉ v is the cavitation number again evaluated at the shaft line based on the advance speed v r e f v a œÉ n t i p is the index based on peripheral speed v r e f n d but w r t the static pressure at the blade tip all the propeller working parameters are defined according to ittc guidelines ittc specialist committee on hydrodynamic noise 2017 the wake characteristics taken into account are shown in fig 5 and consider two radial positions namely 0 7 r and 0 9 r since these two positions are relevant for sheet cavitation both suction side and pressure side and tvc parameters used to describe the propeller inflow have been defined partially following odaba≈üi and fitzsimmons 1978 the maximum and minimum derivatives of the wake w r t the angular position Œ∏ represent the rate of variation of blades load during revolution the wake width is the angular sector where the wake fraction is greater than 0 05 other important features like the average wake fraction and the wake depth are implicitly included in the parameters describing the angle of attack of the blades the angle of attack describes the hydrodynamic functioning of blade sections taking into account the effects of the pitch setting combined with the advance ratio and the characteristics of the inflow including also the shaft inclination since the propeller self induced velocities are not known a priori the geometric angle of attack Œ± g is defined by eq 2 according to ittc propulsion committee 2008 as the difference between the advance angle Œ≤ of a blade section determined by eq 1 and the local pitch angle œÜ 1 Œ≤ r Œ∏ v a 1 w œÄ d n r r v a s i n Œ± s i n Œ∏ in eq 1 Œ± is the shaft angle d the propeller diameter n the shaft revolution rate r the radial section coordinate w the wake fraction and Œ∏ is the angular blade position 2 Œ± g r Œ∏ œÜ r Œ≤ r Œ∏ as expected the minimum Œ± g is always located at 270 because of the effect of the inclined shaft while the maximum Œ± g is in correspondence to the decelerated wake peak in case of less pronounced wake peak and significant shaft inclination it may be located also at 90 as shown in fig 1 the output data of the system built in the present work is represented by the spectra of measured propeller noise and in particular the continuous part of the spectrum associated with cavitation noise spectra are usually analysed in one third octave band or in narrowband representation however the trends featured by single spectral rows may be rather complex and not so meaningful especially if compared to the general trends observed in the experiments in addition modelling the complete spectra would increase significantly the computational time due to this a simplified description of the spectra is defined keeping only the information of physical and practical relevance the adopted simplification shown in fig 6 reproduces the spectral shapes typical of cavitation noise which are described in subsection 2 3 this simplified spectrum is defined by the knowledge of the frequency and level of only five points these frequencies and levels summarized also in table 3 are the target of the developed models target frequencies are expressed in terms of logarithm of the frequency to keep the logarithmic sensitivity of noise to frequency the first portion of the spectrum from the starting point to the first break point is dominated by background noise or by tonal noise components hence not of interest in the present work the part of the simplified spectrum which can be reasonably considered representative of cavitation noise is identified by frequencies higher than those of the first break point hence the starting point is neglected in the following analyses besides starting and ending frequencies are constant and they do not need to be modelled hence the models targets are f bp 1 rnl bp 1 f c rnl c f bp 2 rnl bp 2 and rnl b 2 3 dataset exploration in this section some examples of cavitation noise measured during the present campaign are shown in order to analyze the main characteristics of noise spectra and the global trends which have to be modelled only an overview of results is presented focusing on one propeller pitch configuration namely the p2 at design pitch all the considerations reported in the following are valid for the whole data collection two subsets of operational conditions are considered and corresponding noise spectra are reported in fig 7 a and b these subsets are characterized respectively by a propeller load higher and similar to that corresponding to the real functioning of the propeller these plots allow correlating noise spectra with the cavitation index i e the cavitation extension all spectra are characterized by some common characteristics at very low frequency some thin and very prominent peaks are visible these are tones located at the blade passage frequency and its multiples and are not discussed in the context of the present work after these tones the continuous spectrum associated to cavitation is visible it is usually characterized by a maximum located at a mid low frequency and a mid high frequency spectrum with an almost constant decay depending on the characteristics of cavitation the maximum of the continuous spectrum may appear as a prominent peak in such a case the peak is typically due to the noise generated by the pulsation of the tip vortex cavity and it is of utmost importance in the study of ships radiated noise since it may characterize the signature of the full scale ships see as examples noise measurements reported in lloyd et al 2018 significantly affecting also on board noise and vibration levels this typical feature of tip vortex noise has been largely studied thomson 1880 morozov 1974 bosschers 2009 according to the theory the characteristic frequency of the peak corresponds to the resonance frequency of the vortex and decreases with increasing dimensions i e the vortex cavitating radius in addition to this cavitating vortices produce noise also through the evolution of the cavity volume driven by the inflow and through the presence of impulsive events like collapses rebounds and bursts the medium high frequency part of the spectrum may be associated again to tvc but also to other phenomena like sheet and bubble cavitation which usually become dominant if present the levels and the decay law of this component depend again on cavitation dimensions and dynamics for current cases tvc is always present and its behaviour is rather unstable because of the characteristics of the propeller inflow when the vortex dimensions are significant at higher propeller loading as in fig 8 a it becomes more stable and a prominent peak is observed in the spectrum see fig 7 a the central frequencies of these peaks tend to decrease when cavitation extent gets larger on the contrary when a thinner vortex is present as in fig 8 b the prominence of the peak is reduced and the characteristic frequencies of the spectrum may be less influenced by the cavity size see fig 7 b these trends qualitatively described above characterize all the noise measurements carried out in regimes of prevalent suction side cavitation an overall view of these trends in terms of frequency of the peak and correspondent level is shown in fig 9 a and b considering all the measurements carried out on the p2 at design pitch for confidentiality reasons frequencies and noise levels have been made non dimensional using as reference values the maximum value of the peak central frequency and the minimum value of the peak amplitude for the p2 dataset as it can be seen the frequency decreases moving to lower œÉ n œÉ n r e f and higher k t k t r e f hence moving from points characterized by weaker tvc to those featuring larger tvc extensions furthermore the dependency of the frequency on the cavitation extension is more evident for overloaded conditions while reducing propeller load variations w r t the cavitation number are considerably lower confirming what observed previously the amplitude of the peak presents higher levels where cavitation is more intense both tip vortex and sheet cavitation it is worth noticing that in correspondence to high loading conditions the peak amplitude increases up to a certain value while cavitation grows then it starts decreasing this phenomenon is not completely new and may be related to different causes like the more stationary behaviour of very large cavities or the interaction between sheet and vortex cavitation in general these contour plots demonstrate that the main features of noise spectra depend on propeller loading and cavitation extensions in good agreement with theories of cavitation noise 3 modelization in the proposed context a general modelization framework can be defined characterized by an input space x ‚Ñù d an output space y ‚Ñù and an unknown relation Œº x y to be learned for what concerns this work x is composed by the features reported in table 2 while the output space y refers to the cavitation noise spectrum frequencies and levels reported in table 3 in this context the authors define as model h x y an artificial simplification of Œº the model h can be obtained with different kinds of techniques for example requiring some physical knowledge of the problem as in pms or the acquisition of large amount of data as in ddms or both of them as in hms independently of the adopted technique any model h requires some data in order to be tuned or learned on the problem specificity and to be validated or tested on a real world scenario for these purposes two separate sets of data d n x 1 y 1 x n y n and t m x 1 t y 1 t x m t y m t need to be exploited to respectively tune h and evaluate its performances it is important to note that t m is needed since the error that h would commit over d n would be too optimistically biased since d n has been used to tune h hence the error that h commits on t m in approximating the real process is usually measured with reference to different indexes of performance ghelardoni et al 2013 the mean absolute error mae is computed by taking the absolute loss value of h over t m mae h 1 m i 1 m h x i t y i t the mean absolute percentage error mape is computed by taking the absolute loss value of h over t m in percentage mape h 100 m i 1 m h x i t y i t y i t the pearson product moment correlation coefficient ppmcc measures the linear dependency between h x i t and y i t with i 1 m ppmcc i 1 m y i t y h x i t y ÀÜ i 1 m y i t y 2 i 1 m h x i t y ÀÜ 2 where y 1 m i 1 m y i t and y ÀÜ 1 m i 1 m h x i t other state of the art measures of error exist such as r squared and or the mean square error but in this work these three are kept because from a physical point of view they give a complete description of the quality of the model and moreover adding more measures would make the results less readable in the following sections the authors will describe the possible modelling of the proposed input output relationships considering pms ddms and hms 3 1 physical models in the present work some physics based models for f c and rnl c are derived with a twofold objective provide a benchmark for comparison with ddms and provide features for the hms the tuning of parameters for the physical models is done by fitting on the whole data set hence no distinction between d n and t m has been done the frequency and the maximum level of the peak in the spectrum of tip vortex noise have been computed with an approach similar to the one presented in bosschers 2009 for the vortex resonance frequency and in raestad 1996 for the sound pressure level according to the approach used the vortex strength is assumed to be proportional to the thrust coefficient by means of the coefficient œÑ which represents the relative tip loading and it is here assumed to be dependent only on propeller geometry and wake field the vortex cavitating radius is then computed using the potential vortex model by making use of the experimental data presented in maines and arndt 1997 and formulations based on theoretical considerations it is possible to derive the resonance frequency of the vortex as given by eq 3 3 f c 0 45 œÄ 2 œÉ tip n z œÑ k t the cavitation index œÉ tip is based on the resultant velocity at the blade tip v r e f v a 2 œÄ n d 2 and z is the blades number by doing this the only unknown parameter is the coefficient œÑ which can be obtained by means of fitting the data collected in current experiments values obtained are reported in table 4 all the values are made non dimensional w r t the value of the parameter tuned on the whole dataset as explained below more in detail as expected the coefficient œÑ for a given propeller decreases while reducing the pitch indicating the overall reduced load for what regards the amplitude of the spectral peak the prediction is based on raestad 1996 and the relation between sound pressure levels and propeller functioning parameters is given by 4 rnl c a p 20 log 10 œÑ k t z œÉ n k z according to the work of raestad 1996 the value of the exponent k should be 2 however as pointed out also in bosschers 2018 the fitting with data is improved considering higher values for the present work the parameter k has been chosen equal to 3 the value of a p is instead directly estimated by fitting to experimental data when a new propeller is considered the values of a p and œÑ cannot be estimated from data fitting before experimental results are available hence it is important to define procedures for their estimation before experimental tests are carried out this problem could be overcome using procedures like that proposed in bosschers 2018 according to which the vortex strength is directly derived by boundary element methods bem computations and consequently the knowledge of œÑ is no more needed alternatively the value of these parameters may be correlated with available geometric or hydrodynamic characteristics of the propellers obviously the latter solution requires the availability of a significant number of test cases in case this is not possible the average values of the two coefficients obtained from previous experiments may be used as a first rough estimate in order to check how the accuracy of the pm is affected by this possible rough assumption the coefficients have been hence calculated also on the total set of tests available without differentiating among different propellers and pitch settings the values of these latter fitting coefficients have been used to make non dimensional those obtained for the different cases as in table 4 in the following two pms are considered the first one pm1 makes use of all the values of coefficients a p and œÑ derived for each propeller configuration the second one pm2 uses only values resulting from the fitting on the complete dataset without propeller and pitch setting distinction a schema of the pm is reported in fig 10 as a resume of the operations executed 3 2 data driven models the problem here considered from the data science point of view can be straightforwardly mapped in a typical machine learning ml regression problem vapnik 1998 shawe taylor and cristianini 2004 in fact ml techniques aim at estimating the unknown relationship Œº between input and output through a learning algorithm a h which exploits the data in d n to learn h and where h is a set of hyperparameters which characterizes the generalization performance of a oneto 2018 in this paper a method from the ml kernel methods family called kernel regularized least squares krls has been adopted in order to estimate the relation between f bp 1 rnl bp 1 f c rnl c f bp 2 rnl bp 2 and rnl b and the variables of table 2 the idea behind krls is quite simple during the training phase the quality of the learned function h x is measured according to a loss function ‚Ñì h x y rosasco et al 2004 with the empirical error 5 l ÀÜ n h 1 n i 1 n ‚Ñì h x i y i a simple criterion for selecting the final model during the training phase could then consist in simply choosing the approximating function that minimizes the empirical error l ÀÜ n h this approach is known as empirical risk minimization erm vapnik 1998 however erm is usually avoided in ml as it leads to severe overfitting of the model on the training dataset as a matter of fact in this case the training process could choose a model complicated enough to perfectly describe all the training samples including noise which afflicts them in other words erm implies memorization of data rather than learning from them a more effective approach is to minimize a cost function where the tradeoff between accuracy on the training data and a measure of the complexity of the selected model is achieved tikhonov and arsenin 1979 implementing the simple occam s razor principle 6 h min h l ÀÜ n h Œª c h in other words the best approximating function h is chosen as the one that is complicated enough to learn from data without overfitting them in particular c is a complexity measure depending on the exploited ml approach different measures are realized instead Œª 0 is a hyperparameter that must be aprioristically set and is not obtained as an output of the optimization procedure it regulates the trade off between the overfitting tendency related to the minimization of the empirical error and the underfitting tendency related to the minimization of c the optimal value for Œª is problem dependent and tuning this hyperparameter is a non trivial task as it will be discussed later in this section in krls models are defined as 7 h x w t œï x where œï is an aprioristically defined feature mapping fm shalev shwartz and ben david 2014 which strongly depends on the particular problem under examination and will be described later in this section allowing to keep the structure of h x linear the complexity of the models in krls is measured as 8 c h w 2 i e the euclidean norm of the set of weights describing the regressor which is a quite standard complexity measure in ml shalev shwartz and ben david 2014 regarding the loss function the square loss is typically adopted because of its convexity smoothness and statistical properties rosasco et al 2004 9 l ÀÜ n h 1 n i 1 n ‚Ñì h x i y i 1 n i 1 n h x i y i 2 consequently problem 6 can be reformulated as 10 w min w i 1 n w t œï x y i 2 Œª w 2 by exploiting the representer theorem sch√∂lkopf et al 2001 the solution h of the rls problem 10 can be expressed as a linear combination of the samples projected in the space defined by œï 11 h x i 1 n Œ± i œï x i t œï x it is worth underlining that according to the kernel trick it is possible to reformulate h x without an explicit knowledge of œï and consequently avoiding the course of dimensionality of computing œï by using a proper kernel function k x i x œï x i t œï x 12 h x i 1 n Œ± i k x i x several kernel functions can be retrieved in literature scholkopf 2001 cristianini and shawe taylor 2000 each one with a particular property that can be exploited based on the problem under exam the krls problem of eq 10 can be reformulated by exploiting kernels as 13 Œ± min Œ± q Œ± y 2 Œª Œ± t q Œ± where y y 1 y n t Œ± Œ± 1 Œ± n t the matrix q such that q i j k x j x i and the identity matrix i ‚Ñù n n by setting equal to zero the gradient w r t Œ± it is possible to state that 14 q Œª i Œ± y that is a linear system for which effective solvers have been developed over the years allowing coping with even very large sets of training data young 2003 the problems that still have to be faced is how to choose œï the kernel k and how to set up the hyperparameter Œª it is possible to start by setting œï and the kernel k generally the input features of d n are subject to a process of transformation this process is usually referred as fm shalev shwartz and ben david 2014 since the input features are mapped from an initial input space x to a new input space œà in this way the fm procedure allows to find a new suitable representation œï x œà of the data x x by defining a function œï x œà mapping x to a new feature space where it is possible to then learn a simple linear model like the one defined by the krls fm is usually adopted since the new feature space œà could enhance the performance capability of the predictor depending on the values of x and y in this work the adopted fm was selected considering the acquired expertise and knowledge of the cavitation noise phenomenon by applying the following fm 15 œï x i 1 5 d v i k i i 1 5 d k i j j 0 1 p t ‚Ñù j 0 p 5 d j v x 1 x d 1 x 1 1 x d ln x 1 ln x d e x 1 e x d e x 1 e x d t ‚Ñù 5 d in fact based on this fm it is possible to represents with a simple linear combination all the possible functions with an opportune value of p and where each feature is a physically plausible term of the function the problem of the fm of eq 15 is that its computation is computationally unfeasible if d or p are large since the problem is np hard nevertheless remembering that in krls it is possible to exploit the kernel trick and noting that the proposed fm can be expressed with a simple polynomial kernel 16 œï a t œï b v a t v b c p k a b v a a 1 a d 1 a 1 1 a d ln a 1 ln a d e a 1 e a d e a 1 e a d v b b 1 b d 1 b 1 1 b d ln b 1 ln b d e b 1 e b d e b 1 e b d it is possible to avoid the np hard problem and use the desired fm note that p 0 1 is the desired degree of the polynomial and c 0 is a parameter trading off the influence of higher order versus lower order terms in the polynomial p and c together with Œª are hyperparameters that need to be tuned in order to optimize the performance of the final model unfortunately during the fm many unnecessary features have been generated which are either redundant or not informative as a result a feature selection phase is required in order to increase the generalization performance of the model by selecting only the most informative features which best represent the problem to be solved and discarding the others guyon and elisseeff 2003 for this purpose authors will adopt the backward elimination techniques described in guyon and elisseeff 2003 the last problem that it is possible to solve is how to tune the hyperparameters p c and Œª of the proposed method since every ml model is characterized by a set of hyperparameters h influencing their ability to estimate Œº a proper model selection ms procedure needs to be adopted oneto 2018 several methods exist for ms purpose but resampling methods like the well known k fold cross validation kcv kohavi et al 1995 or the nonparametric bootstrap bts efron and tibshirani 1994 approaches represent the state of the art ms approaches when targeting real world applications resampling methods rely on a simple idea the original dataset d n is resampled once or many n r times with or without replacement to build two independent datasets called training and validation sets respectively l l r and v v r with r 1 n r note that l l r v v r l l r v v r d n then in order to select the best combination the hyperparameters h in a set of possible ones ‚Ñå h 1 h 2 for the algorithm a h or in other words to perform the ms phase the following procedure has to be applied 17 h min h ‚Ñå 1 n r r 1 n r 1 v x i y i v v r ‚Ñì a h l l r x i y i where a h l l r is a model built with the algorithm a with its set of hyperparameters h and with the data l l r since the data in l l r are independent from the ones in v v r the idea is that h should be the set of hyperparameters which allows to achieve a small error on a data set that is independent from the training set in this work authors will exploit the bts procedure and consequently r 500 if l n and the resampling must be done with replacement oneto 2018 a schema of the ddm is reported in fig 11 as a resume of the operations executed 3 3 hybrid models the problem that authors want to face here is how to construct a model able to both take into account the physical knowledge about the problem encapsulated in the pms of section 3 1 and the information hidden in the available data as the ddms of section 3 2 for this purpose authors will start from a simple observation a hm based on the previous observation should be able to learn from the data without being too different or far away from the pm from the data science point of view this requirement can be straightforwardly mapped in a typical ml multi task learning mtl problem baxter 2000 caruana 1997 evgeniou and pontil 2004 bakker and heskes 2003 argyriou et al 2008 caruana 1997 1997 mtl aims at contemporary learning two concepts in this case the pm and the available data through a learning algorithm a h which exploits the data in d n to learn a function h which is both close to the observation the data d n and the pm namely its forecasts since for building a hm also a pm is needed authors will develop a model to estimate the relation between f c and rnl c and the variables of table 2 since the pm is only available for f c and rnl c consequently in this case a slightly different scenario is presented where the dataset is composed by a triple of points d n x 1 y 1 p 1 x n y n p n where p i is the output of the pm in the point x n with i 1 n the target is to learn a function able to approximate both Œº namely the relation between the input x x and the output y y and the pm namely the relation between the input and the output of the pm basically two tasks have to be learned for this purpose there are two main approaches the first approach is called shared task learning stl and the second independent task learning itl while the latter independently learns a different model for each task the former aims to learn a model that is common between all tasks a well known weakness of these methods is that they tend to generalize poorly on one of the two tasks baxter 2000 in this paper authors show that an appealing approach to overcome such limitations is provided by mtl baxter 2000 caruana 1997 evgeniou and pontil 2004 bakker and heskes 2003 argyriou et al 2008 this methodology leverages on the information between the tasks to learn more accurate models in order to apply the mtl approach to this case it is possible to basically just modify the krls problem of eq 10 in order to contemporary learn a shared model and a task specific model which should be close to the shared model in this way authors obtain a model which is able to contemporary learn the two tasks the model that authors are interested in is the first one while the task specific models are just used as a tool a shared model is defined as 18 h x w t œï x and two task specific models as 19 h i x w i t œï x i y p then it is possible to state the mtl version of eq 10 20 w w y w p min w w y w p i 1 n w t œï x y i 2 w t œï x p i 2 i 1 n w y t œï x y i 2 w p t œï x p i 2 Œª w 2 Œ∏ w w y 2 w w p 2 where Œª is the usual regularization of krls and Œ∏ 0 instead is another hyperparameter that forces the shared model to be close to the task specific models basically the mtl problem of eq 20 is a concatenation of three learning problems solved with krls plus a term which tries to keep related all the three different problems by exploiting the kernel trick as in krls it is possible to reformulate problem 20 as follows 21 Œ± min Œ± q q 0 0 q q 0 0 0 0 q 0 0 0 0 q 2 Œ± t Œª 2 Œ∏ q Œª 2 Œ∏ q Œ∏ q Œ∏ q Œª 2 Œ∏ q Œª 2 Œ∏ q Œ∏ q Œ∏ q Œ∏ q Œ∏ q Œ∏ q 0 Œ∏ q Œ∏ q 0 Œ∏ q Œ± where p p 1 p n t the solution of this problem is again equivalent to solving a simple linear system 22 q Œª 2 Œ∏ i q Œª 2 Œ∏ i Œ∏ i Œ∏ i q Œª 2 Œ∏ i q Œª 2 Œ∏ i Œ∏ i Œ∏ i Œ∏ i Œ∏ i q Œ∏ i 0 Œ∏ i Œ∏ i 0 q Œ∏ i Œ± y p y p the function that authors are interested in the shared one can be expressed as follows 23 h x w t œï x i 1 n Œ± i Œ± i n k x i x by exploiting the same fm and feature selection of the ddms see section 3 2 the hms are obtained what changes is the ms phase where Œª c and p have been tuned as for the ddms but also Œ∏ a schema of the hm is reported in fig 12 as a resume of the operations executed 4 results and discussion in this section the performances of the pms ddms and hms see sections 3 1 3 2 and 3 3 will be tested and compared by means of the data described in section 2 in two different scenarios interpolation scenario in this case models try to predict the propeller noise spectra main characteristics in various but different working conditions within the ones exploited for building the model these tests are useful to check the capability of the model to provide predictions starting from the knowledge of the characteristics and the cavitating behaviour of the propeller extrapolation scenario in this case models try to predict the propeller noise spectra main characteristics in groups of working conditions where the cavitation intensity is very different w r t the one exploited for building the model these tests are useful to check the capability of the models to predict the noise related to cavitation patterns which cannot be reproduced at model scale basically the two scenarios just differ in the way d n and t m have been built in other words the two scenarios differ in the subset of data exploited for building and testing the models for what concerns the pms the pm1 and pm2 described in section 3 1 will be considered as described in section 3 1 pm1 and pm2 are just able to predict f c and rnl c based on a subset of the input variables described in table 2 for what regards the ddms the custom algorithm described in section 3 2 will be used ddms are able to predict f bp 1 rnl bp 1 f c rnl c f bp 2 rnl bp 2 and rnl b based on all the input variables reported in table 2 the set of hyperparameters tuned during the ms phase are h p c Œª chosen in ‚Ñå 1 2 10 10 4 10 3 10 4 10 4 0 10 3 8 10 4 0 for the hms the custom algorithm described in section 3 3 will be exploited hms are able to predict just f c and rnl c based on all the input variables reported in table 2 and the pms of section 3 1 the values of f bp 1 rnl bp 1 f bp 2 rnl bp 2 and rnl b cannot be predicted by hms since no pms are available for these features and consequently ddms have to be used finally since two pms are available two hms hm1 and hm2 will be considered exploiting respectively the pm1 and the pm2 the set of hyperparameters tuned during the ms phase are h p c Œª Œ∏ chosen in ‚Ñå 1 2 10 10 4 10 3 10 4 10 4 0 10 3 8 10 4 0 10 4 0 10 3 8 10 4 0 all the tests have been repeated 30 times and the average results are reported together with their t student 95 confidence interval in order to ensure the statistical consistency of the results the indexes of performance for the frequencies are reported in h z 4 1 interpolation scenario the interpolation case is the simplest one in this scenario d n and t m have been created by splitting randomly the whole 164 samples keeping 90 of the data in d n and the remaining 10 in t m in this way the models have been tested in their ability to predict the propeller noise spectra main characteristics in various but different working conditions within the ones exploited for building the model in table 5 the performance of pms ddms and hms in predicting the noise spectra main characteristics are reported the performance are measured with the mae the mape and the ppmcc the table reports the full set of results for completeness the best performing models are underlined in bold from the table it is clear how the hms are in the most cases the best performing ones followed by the ddms the pms are usually the worse performing models unfortunately the full table is not easy to interpret nor very informative and for this reason in the next sections a series of scatter plots is used to give a better interpretation of the results 4 1 1 physical models results fig 13 reports the scatter plots of the measured and predicted values of f c and rnl c for both pm1 and pm2 from fig 13 it is possible to observe that there is a significant variance of the results depending on the different tests especially for f c data points tend to distribute with an angle between the measured and predicted values which is slightly different from 45 clearly underlining a problem in the pm adopted as expected the accuracy of the pm1 model is significantly better than the one of the model pm2 however from a qualitative point of view results reported in the scatter plots evidence the same problems in both cases the pm implemented in this work seems to provide only a rough approximation of the dependency of f c and rnl c on the input parameters in the case of the pm1 the values of the parameter œÑ have been tuned on the available experiments assuming its value is not dependent on the operational conditions but only on propeller configuration while for pm2 œÑ it is assumed constant on the whole data set the observed results point out also the limits of these assumptions furthermore one of the main problems related to pms is that in some cases the noise spectra within the available data present a behaviour similar to the one schematized by the pm whereas in other cases a significantly different behaviour is observed with the frequency of the maximum weakly depending on cavitation size the pm is not able to discriminate between these different situations and its accuracy decreases when the cavitation noise is not mainly driven by the tip vortex pulsation e g when the propeller pitch is lower this may contribute to the significant variance observed 4 1 2 data driven models results fig 14 reports the scatter plots of the measured and predicted values of f bp 1 rnl bp 1 f c rnl c f bp 2 rnl bp 2 and rnl b for the ddms from fig 14 it is possible to observe that considered targets are predicted with a reasonable accuracy by the model demonstrating that trends present in the experimental data can be effectively modelled by the ddms the ddms seems to correctly predict the targets considering also the different behaviours of cavitation noise spectra observed which represented one of the limits of the considered pms the results show significantly different trends depending on the considered target a reasonable agreement between measured and predicted data is observed for targets f c rnl c and rnl b even if some variance is present a good agreement is observed also for the target rnl bp 1 but in this case there seems to be a deterioration of the prediction performance for the highest values in the distribution the distributions of points on the scatter diagrams highlight some problems for what regards targets f bp 1 f bp 2 and rnl bp 2 points are partially clustered around certain values with a significant number of samples spread over the plot without a clear tendency these results point out some limits of the definition of the targets for the prediction of noise spectra the simplified spectral shape adopted effectively succeeds in modelling measured noise spectra even considering both spectral shapes observed namely with and without prominent peak the issues may be related to the definition of the parameters used to describe the simplified spectra namely frequencies and levels of the points actually the frequency and levels of the two breakpoints used to define the simplified shape do not feature a clear physical meaning and consequently they are not characterized by clear tendencies as other targets the first break point roughly corresponds to the frequency above which the cavitation noise spectrum is perceived over the background noise as a consequence the frequency of this point and its corresponding level depends not only on the characteristics of cavitation noise but also on the spectrum of the background noise in the tunnel the second break point divides the spectrum into two regions characterized by different decay ratio of noise w r t frequency the decreasing part of the peak when present with a larger decay ratio and the high frequency spectrum with lower decay these two regions are clearly distinguished only when a prominent peak is identified otherwise an almost constant decay is observed from the maximum point of the spectrum towards higher frequencies in the latter case the definition of the break point is uncertain and consequently f bp 2 and rnl bp 2 may assume anomalous values these issues might be overcome in different ways modifying the simplified representation of spectra or simply employing different parameters to describe it as an example the decay ratio i e the slopes of the curve in the two mentioned regions of the spectrum could be considered in place of the break point actually these parameters should allow to correctly describe the spectra as well and they should not present anomalous values even when the distinction between the two regions becomes meaningless the adoption of alternative parameters and its effect will be subject of future activities evaluating the performance of the ddms in terms of accuracy is just the first step toward understanding them in fact these models are black box and consequently the learned relation between inputs and outputs is not explicitly known since kernel methods were exploited to extract the explicit form of the model evaluating the relationship between inputs and outputs would be in most cases impossible while in some cases computational intractable shawe taylor and cristianini 2004 in order to overcome this limitation it was decided to perform a feature ranking fr procedure guyon and elisseeff 2003 liu and motoda 2007 which allows to rank the features based on their effect on the model output for this purpose a very statistically sound and robust approach called permutation test was exploited good 2013 fran√ßois et al 2006 table 6 reports the result of the fr procedure on the models which predict f c and rnl c before analyzing the result of the fr procedure in details it is worth noting that most of the considered features are strongly dependent or even redundant e g propeller thrust and torque or the alternative definitions of the cavitation number this means that fr can detect as important just one or all of this strongly correlated features some of them or all of them which basically contain the same information in fact one has to remember that the fr procedure is a statistical procedure and consequently subject to uncertainties and statistical fluctuations and consequently it does not make sense to make very specific comments while it is more reasonable to observe global trends having said this it is possible observe that not surprisingly the inception indexes of the driving phenomena i e tip vortex at 0 detached tip vortex and suction side sheet at 0 are always in the top 3 this confirms the strong relation between measured noise and the cavitation intensity the knowledge summarized in eq 3 about the resonance frequency of the vortex can be found also in the fr indeed the torque coefficient in place of the thrust coefficient the relative pressure in place of the cavitation index and the propeller rotational speed are in the top 10 features for importance similarly the sound pressure level of the vortex peak whose theoretical expression of eq 4 identifies in the propeller load and the cavitation index the most valuable parameters is checked by fr in general it can be observed the most influencing variables in the noise generation are among the most important ones according to the fr furthermore it is interesting to notice the absence in the top positions of features assumed to be strongly related to the cavitation noise as an example the wake parameters this can be justified recalling that some features such as the cavitation inception directly depend on the wake or some others as the angle of attack are derived from it hence wake features could be redundant 4 1 3 hybrid models results fig 15 reports the scatter plots of the measured and predicted values of f c and rnl c for both hm1 and hm2 from fig 15 it is possible to observe that there is a significant enhancing of the performances of the ddms by using the pms moreover the results show that the use of a more generic set of coefficients pm2 does not lead to a noticeable degradation of the performance of the hms making them very attractive and promising in view of future enlargements of the experimental dataset 4 2 extrapolation scenario from a practical point of view it is of great interest to test the capability of the models to predict radiated noise for cases not included in the variable domain of the data used to build them actually new cases of interest might be characterized by values of the input variables not included between those considered but still similar to them this may be the case of a new propeller designed with operating requirements different from those considered as already anticipated another important application of the models developed is related to those ship operational conditions for which the cavitation pattern cannot be correctly reproduced in model scale requiring an extrapolation in order to better present the problem the typical cavitation bucket of a model scale propeller is schematized in fig 16 the full scale working point is characterized by the values of the thrust coefficient and cavitation number of the full scale propeller in some cases for this combination of values the model scale propeller does not cavitate because of viscous scale effects affecting the development of vortices however applying scaling formulas like those proposed by mccormick 1962 or shen et al 2009 it is possible to assess if tvc is present in full scale and roughly estimate its extension by means of the œÉ n œÉ n i n c ratio or similar quantities in order to reproduce the same cavitation extension in model scale some scaling criterion must be applied such as the identity of the ratio œÉ n œÉ n i n c the test conditions obtained following this approach i e the scaled working point in the example are in some cases located on the bucket in the hatched area in this area the presence of unwanted phenomena like bubble cavitation or other measuring issues e g bubble scattering may alter the measured noise and also the development of the vortex cavitation itself as a consequence the direct measurement in such conditions is deemed not meaningful radiated noise in the hatched area should be predicted eliminating the unwanted effects thus obtaining a sort of ideal model scale experiment the proposed approach basically consists in developing a model based only on operational conditions without unwanted phenomena these conditions correspond to the areas identified by numbers from g1 to g6 in fig 16 these areas are defined by combinations of the quantities k t k t r e f and œÉ n œÉ n i n c of the tvc the model based on these data is able to predict noise for different extensions of tvc and different combination of input parameters without modelling the unwanted phenomena the target conditions in the hatched area are characterized by a combination of input parameters not included in the set of data used to define the model hence an extrapolation is needed since validation data for the target region is not available it is not possible to directly test the capability of the model to extrapolate in this area in order to obtain an indication of such capability the extrapolation performance between different subsets of data corresponding to the numbered areas in fig 16 has been assessed in particular the extrapolation test consists in including in d n only five of the six groups and use the sixth group as t m from the point of view of the physical problem here summarized i e the prediction of the hatched area the most interesting extrapolation cases are those for which t m is represented by points belonging to the zones 1 2 and 3 in table 7 analogously to table 5 in section 4 1 the full set of results are reported and they are complemented with a series of scatter plots in order to better comment them note that in this case the results are not checked based on the propeller characteristics but based on the group membership see fig 16 looking at table 7 it is clear that the ddms and the hms are able to effectively make predictions in the extrapolation setting and to provide estimation which can be reliable in a real world application of the method showing their ability to extrapolate and not just interpolate figs 17 19 analogously to figs 13 15 in section 4 1 report the scatter plots of the measured and predicted values of f bp 1 rnl bp 1 f c rnl c f bp 2 rnl bp 2 and rnl b for the pms if available the ddms and the hms if available respectively the extrapolation performance of the ddms and hms are promising and related results seem to confirm the validity of the proposed approach the accuracy of the extrapolation is remarkable for all the groups except g5 for which however results are still acceptable anyway it has to be remarked that for the sake of extrapolation to critical conditions previously described the extrapolation of group g5 is not so important presenting this group the highest deviations in terms of cavitating behaviour from the design conditions on the contrary results obtained for the extrapolation of groups g1 g2 and g3 are definitely encouraging 5 conclusions in this paper a procedure to estimate propeller cavitation noise by means of numerical models has been presented the goal is to predict the significant characteristics of the cavitation noise spectra using data available at propeller design stage this will help the designer to implement suitable countermeasures to mitigate the generation of unwanted noise limiting one of the major sources of anthropogenic noise with this purpose in mind a simplification of the propeller noise spectra has been proposed and a model able to predict its features on the base of quantities that can be estimated at design stage has been developed three different modelization strategies have been presented one based on the physical knowledge of the problem one based on data science and one based on a hybrid approach able to exploit both the two sources of information an extensive set of cavitation tunnel tests performed with different propellers and different configurations allowed the creation of a database exploited for developing and testing the different models an in depth comparison of the performance of the different models has been performed in particular two sets of evaluations have been carried out in the first set the capability of the models to predict the propeller noise spectra main characteristics in working conditions within the ones exploited for building the model has been analysed in all cases conditions different from those used to build the model have been used for the test but always remaining inside the initial domain in the second set of trials instead the capability of the models to predict the propeller noise spectra main characteristics in groups of working conditions where the cavitation intensity is different w r t the one exploited for building the model has been tested in both scenarios hms have shown remarkable and promising results opening the way to future works in this direction next steps of the research here presented will include several improvements of the promising modelling procedure including some aspects summarized in the following the presented analysis has been limited only to a class of similar propellers and configurations deemed of remarkable interest in order to generate a collection of data with a tolerable variance it is planned for future activities to enlarge the data collection considering further propellers and wake fields this will require the use of an enlarged set of features including more parameters describing propeller geometries e g expanded area ratio camber chord etc furthermore transfer function corrections will be added to the procedure in order to allow the modelling of different propeller hydrophones configurations most important transfer functions will allow including in the model the effect of the confined environment providing an estimate of propeller source levels in free field conditions furthermore results obtained with the hybrid model suggest investigating this approach considering also other physical models or semi empirical formulations available in literature with the aim of further improve the already remarkable results of the developed models acknowledgements the authors wish to express their gratitude to fincantieri mm arc office which kindly provided the propeller models used in the present work appendix a supplementary data the following is the supplementary data to this article multimedia component 1 multimedia component 1 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j oceaneng 2019 02 002 
22901,wave farms i e arrays of wave energy converters wecs have recently been proven to be effective in fulfilling the dual function of carbon free energy generation and coastal protection in this paper these dual function wave farms are referred as dual wave farms the objective of this work is to investigate the influence of the wec configuration on the performance of these dual wave farms through a case study a dual wave farm consisting of wavecat wecs deployed off an eroding beach wavecat is a floating overtopping wec consisting of two hulls joined by their stern forming a wedge two configurations are considered with wedge angles of 30 and 60 to characterize wave wec interaction laboratory tests of a 1 30 wavecat model are conducted using the two configurations and low mid and high energy sea states characteristic of the study area the reflection and transmission coefficients obtained from the laboratory tests are inputted into a suite of numerical models to investigate the hydro and morphodynamics of the beach we find that the smaller wedge angle 30 wecs afford more less coastal protection quantified in terms of dry beach area availability for short long peak periods than wecs with 60 these results allow us to conclude that for optimum performance of dual wave farms wec geometry should be adapted dynamically to the sea state keywords ocean energy wave farm laboratory experiments numerical modelling device design 1 introduction the development of renewable energy is one of the most relevant targets confronting society in the coming decades european commission 2007 2009 due to the finite nature of fossil fuels their high costs and last but not least the environmental impacts of their exploration and use asif and muneer 2007 shafiee and topal 2009 among the carbon free energy sources marine energy resources offer a vast potential and comparatively low effects on the environment falnes 2007 cornett 2008 cruz 2008 panwar et al 2011 rinaldi et al 2017 in particular the worldwide potential of wave energy was assessed as 17 tw h year lund 2007 these facts contrast with the low degree of development and utilization of wave energy compared to other renewable sources such as hydroelectric biomass or wind energy u e i administrationet al 2011 eurostat 2016 for these reasons increasing research efforts have focused on wave energy over the last years the objectives of the investigations carried out so far have been 1 the assessment and characterization of wave energy resources iglesias et al 2009 iglesias and carballo 2011 vicinanza et al 2013a carballo et al 2015 2018 contestabile et al 2015 l√≥pez et al 2015a silva et al 2015 veigas et al 2014 2015 iuppa et al 2015a viviano et al 2016 prieto et al 2019 2 the study and optimization of possible locations carballo et al 2014 iuppa et al 2015b l√≥pez ruiz et al 2016 2018a 2018b elginoz and bas 2017 alifdini et al 2018 khojasteh et al 2018 3 the economic viability of wave energy astariz and iglesias 2015a 2016a astariz et al 2015a contestabile et al 2017a frost et al 2018 4 the combined implementation with other ocean energies most notably wind azzellino et al 2013 astariz and iglesias 2015b 2016b astariz et al 2015b p√©rez collazo et al 2015 wang et al 2018 and 5 the development of wave energy technologies and devices viviano et al 2016 vicinanza et al 2012 2013b 2014 falc√£o 2007 margheritini et al 2009 fernandez et al 2012a l√≥pez et al 2014 2015b 2015c 2016 2017a 2017b 2018 2018 l√≥pez and iglesias 2014 day et al 2015 buccino et al 2015 contestabile et al 2017b elhanafi et al 2017 medina l√≥pez et al 2017 2019 l√≥pez et al 2018 mo√±ino et al 2018 ramos et al 2018 barambones et al 2018 chao et al 2018 do et al 2018 halder et al 2018 kolios et al 2018 sergiienko et al 2018 wu et al 2018 yang et al 2018 zheng and zhang 2018 one of the wave energy converters wecs under development is wavecat iglesias et al 2009 2011 a floating overtopping wec it comprises two hulls joined at the stern by a hinge for a detailed description of the device the reader is referred to fernandez et al 2012a 2012b wave farms consisting of wavecat wecs have been proven to fulfil a dual function as wave energy generators and coastal defence elements on both sandy beaches abanades et al 2014a 2014b 2015 2018 and gravel dominated coasts bergillos et al 2018a 2019 rodriguez delgado et al 2018a 2018b 2019 so far the effects of the wec configuration on the hydro and morphodynamics of the coast in the lee of the wave farm have not been studied the main objective of the present research is to analyse the effects of the configuration of wavecat in particular the wedge angle or angle between the twin hulls on wave propagation longshore sediment transport lst and shoreline dynamics considering the varying transmission and reflection coefficients obtained from laboratory experiments under different sea states the laboratory experiments were conducted in the ocean basin of the university of plymouth section 3 1 in addition this research involved the application of a wave propagation model section 3 2 1 an lst formulation section 3 2 2 and a one line model section 3 2 3 to a study site in southern spain section 2 2 study site playa granada is a gravel dominated deltaic beach located on the mediterranean coastline of southern spain fig 1 a the beach which is bounded by the guadalfeo river mouth to the west and by punta del santo to the east fig 1b has been experiencing shoreline retreat and terminal erosion in recent years bergillos et al 2015a 2016a 2018b partly due to anthropogenic interventions in the guadalfeo river basin bergillos et al 2015b 2016b bergillos and ortega s√°nchez 2017 two incoming wave directions are predominant at the study site fig 1c south west sw and south east se the values of deep water significant wave height which are not exceeded 50 90 99 and 99 9 of the time are 0 5 m 1 2 m 2 1 m and 3 1 m respectively bergillos et al 2016c the astronomical tidal range is 0 6 m ortega s√°nchez et al 2017 and surge levels under storm conditions frequently exceed 0 5 m bergillos et al 2016d 3 methods 3 1 laboratory experiments laboratory tests were performed in the ocean basin of the university of plymouth to measure the reflection k r and transmission k t coefficients for two different wedge angles i e angles between the hulls of wavecat Œ± 30 and Œ± 60 fig 2 the experiments were carried out at a 1 30 scale and the dimensions of the model were 3 m length and 0 6 m height fig 2 the selection of the two wedge angle values was done to represent two different types of operation of wavecat corresponding to two different types of sea state one in which the length of the incoming wave front that is harnessed by the device is maximised Œ± 60 given that the wave power per linear metre of wave front is limited low energy sea state and another in which the amount of wave power per linear meter of wave front is substantial high energy sea state and therefore harnessing a shorter stretch of wave front is sufficient to reach the rated power of the device Œ± 30 twelve different sea states were tested with values of the significant wave height h m 0 between 0 03 m and 0 1 m 1 m and 3 m in the model prototype the tested values of the spectral peak period t p mod ranged from 1 28 s to 2 37 s representing real values t p prot from 7 s to 13 s froude similarity these sea states are representative of the wave conditions in playa granada fig 1c the tested sea states along with the measured reflection and transmission coefficients are summarized in table 1 a detailed description of the laboratory experiments can be found in allen et al 2016 2018 3 2 numerical modelling 3 2 1 swan model the swan model was used to propagate the sea states in the prototype scale detailed in section 3 1 from deep water toward the coast for the two prevailing directions at the study zone fig 1c sw 238 and se 107 the model was previously calibrated for the study area by bergillos et al 2017a through comparison with field data the wave farm location shown in fig 1b was selected based on the results from previous studies which have demonstrated that it is the best site in terms of wave energy potential l√≥pez ruiz et al 2016 and coastal protection rodriguez delgado et al 2018b the wave farm layout consisting of 11 wavecat wecs spaced by a distance of 180 m and arranged in two rows was also chosen on the basis of recent works at the study site rodriguez delgado et al 2018a 2019 two numerical grids were defined and used fig 1d a coarse grid covering the entire deltaic region and extending from deep to shallow waters and a nested grid covering the nearshore region including the wave farm area with higher resolution to properly model the wave farm effects the wecs were introduced in swan as artificial obstacles specifying their reflection and transmission coefficients hereafter denoted by k r and k t respectively for each sea state and wedge angle table 1 the results provided by swan were utilized to obtain wave variables at breaking conditions through the fraction breaking variable and on this basis apply the lst formulation below 3 2 2 longshore sediment transport formulation lst was obtained through the formulation proposed by van rijn 2014 which was found in previous work bergillos et al 2017a to provide good estimates of the measured lst rates at the study site the following expression was used 1 q 0 00018 k œÅ s g 0 5 tan Œ≤ 0 4 d 50 0 6 h m b r 3 1 sin 2 Œ∏ b r where q is the lst rate œÅ s is the sediment density g the gravity acceleration tan Œ≤ the beach slope of the surf zone d 50 the grain size h m b r Œ∏ b r the breaking significant wave height wave angle respect to shore normal and the coefficient k considers the effect of wave period on lst 3 2 3 one line model the lst rates obtained with the equation of van rijn 2014 and detailed in the previous section were used to calculate the changes in the shoreline position through the application of a one line model pelnard consid√®re 1956 which is based on the following equation 2 y s t 1 d q x s where y s and x s are the coordinates of the shoreline t is the time and d is the sum of the height of the berm and the closure depth bergillos et al 2017a proved that the joint application of the swan model the lst formulation of van rijn 2014 and the one line model replicates the coastline changes in playa granada 4 results 4 1 significant wave heights at breaking this section details the influence of the wave farm on wave propagation in particular on the significant wave heights at breaking depending on the wedge of the wecs the alongshore variation of the differences between breaking significant wave heights for Œ± 30 and Œ± 60 Œ¥ h m b r are indicated in fig 3 under sw waves it is shown that the differences are generally negative for short wave periods t p 7 s and positive for long periods t p 11 s and t p 13 s in all the cases the maximum differences are reached at the eastern part of the coast influenced by the location of the wave farm shown in fig 1 and its effects in the leeward wave propagation patterns for all the h m 0 the alongshore averaged values of Œ¥ h m b r for sw waves increase with increasing values of t p fig 4 thus in terms of wave energy at the breaking zone the wave farm composed by devices with the 30 configuration provides more less protection for short long t p than that with the 60 configuration this is a result of the different k r and k t of both configurations table 1 for given values of t p the differences in breaking wave heights between both angles decrease for increasing values of h m 0 fig 4 under incoming se waves the differences are also negative positive for short long t p although in this case they extend along most of the study stretch fig 3 for constant values of h m 0 the alongshore averaged Œ¥ h m b r under se waves is greater for longer t p fig 4 it is also due to the differences in k r and k t between both devices table 1 thus the greater the values of t p the lower the protection provided by devices with Œ± 30 compared to those with Œ± 60 the differences in significant wave height at breaking between both devices under se wave conditions are generally greater than those under sw waves fig 4 with maximum negative positive alongshore averaged values of Œ¥ h m b r equal to 0 82 cm 0 77 cm for low energy waves h m 0 1 m 0 77 cm 0 55 cm for mid energy waves h m 0 2 m and 0 71 cm 0 61 cm for high energy waves h m 0 3 m 4 2 longshore sediment transport rates the differences in lst rates between the wecs with Œ± 30 and Œ± 60 are analysed in this section fig 5 depicts the alongshore distribution of these differences for all the sea states considered under sw waves the differences are generally greater for higher values of h m 0 and lower values of t p i e the greater the wave steepness the higher the differences in lst rates between the farms with both angles the differences are more significant in the western eastern stretch of the coast for short long peak periods fig 5 under se wave conditions the greater differences are located in the eastern part of the study section fig 5 i e in the lee of the wave farm fig 1 for short periods t p 7 s the differences are negative in the eastern end of the stretch of beach and become positive toward the west whereas the opposite occurs for long periods t p 11 s and t p 13 s in general the differences are greater as the h m 0 values increase table 2 the differences in lst rates between the farms composed by both devices under se wave conditions are greater than those under sw waves table 2 and fig 6 this is influenced by both the higher differences in breaking significant wave heights section 4 1 and the higher angles from shore normal for se waves which increase the lst rates and differences 4 3 shoreline geometry the lst rates obtained in the previous section were used to compute the variations in the shoreline morphology over a one month period for h m 0 1 m h m 0 2 m and h m 0 3 m representing low mid and high energy conditions respectively the differences between the final shorelines for Œ± 30 and Œ± 60 under both sw and se waves are shown in fig 7 for sw waves and short peak periods t p 7 s the maximum differences are negative and concentrated in the central stretch of beach where the main occupations are located indicating that the wave farm with Œ± 30 provides greater protection at this location on the contrary the differences in the western part of the beach are positive fig 7 i e the farm with Œ± 60 leads to greater accretion near the river mouth for short wave periods this section has experienced acute shoreline retreat in recent years due to river damming bergillos et al 2016b for long wave periods t p 11 s and t p 13 s the maximum differences under sw waves are positive and located in the central stretch of beach in addition the alongshore averaged values are positive for low mid and high energy conditions table 3 thus under sw waves with long periods the wave farm with Œ± 60 provides greater protection against shoreline erosion this leads to a higher efficiency in terms of dry beach area section 4 4 on the other hand under se waves the greatest differences are concentrated along the eastern section of the coastline this is caused by the farm location fig 1 and the resulting greater differences in lst between both angles at this stretch of beach fig 5 the differences in final shoreline positions are generally negative positive for short long peak periods indicating that the wave farm composed by wecs with Œ± 30 Œ± 60 provides more protection for short long wave periods fig 5 and table 3 for all the sea states considered the differences in the final shoreline geometries between devices with Œ± 30 and Œ± 60 under se wave conditions are higher than those under sw waves these differences determine the dry beach area availability as explained in the following section 4 4 dry beach area the differences between the final and initial dry beach areas for all the sea states analysed and for both angles between the hulls are depicted in fig 8 it may be observed that these differences are always positive i e beach accretion occurs in all cases this confirms the efficiency of wave farms as protection elements against coastline erosion as shown in fig 8 the accretion is more pronounced under se waves this is in agreement with the observed morphological response of the coastline since sw waves contribute to erode the beach and se waves lead to beach recovery bergillos et al 2017a 2017b in this case the presence of the farm increases the beach accretion under se waves and reverts the coastline response from erosion to accretion under sw wave conditions the dry beach area differences are generally greater with increasing values of h m 0 and t p fig 8 the comparison of the results obtained for both angles between hulls allow concluding that under sw waves the farm composed by devices with Œ± 60 is more efficient in terms of coastal protection for all the cases except four of them associated to mild conditions h m 0 1 m t p 7 s h m 0 1 m t p 9 s h m 0 2 m t p 7 s and h m 0 2 m t p 9 s table 4 and fig 9 under se waves the wavecat devices with Œ± 30 are more efficient for the shortest peak period t p 7 s whereas those with Œ± 60 lead to greater accretion values for the rest of wave conditions table 4 the results of this section indicate that for the best performance in terms of coastal protection the geometry of the wecs should be adjusted dynamically to the sea state if this is not possible i e if a fixed configuration constant wedge angle must be adopted then this configuration should be chosen on the basis of a detailed analysis of the wave climate at the site of interest with a view to optimizing the coastal protection performance under the prevailing sea states the methodology presented in this work which combines laboratory tests with different wec configurations and numerical modelling may be used for other geometries and beaches to investigate the optimum configuration for a wave farm project 5 conclusions wave energy is one of the renewables with the greatest potential for development due to the resource availability and low visual pollution recent research has highlighted the possibility of using wave farms for a dual function i e renewable energy generation and coastal protection this paper presents the first study on the influence of wec configuration on the performance of dual wave farms in particular the effects of two values of the wedge angle i e the angle between the twin hulls of wavecat wecs Œ± 30 and Œ± 60 on significant wave height at breaking lst rates shoreline geometry and dry beach area were analysed for this purpose the transmission and reflection coefficients were determined for relevant sea states based on laboratory experiments in a wave tank and these values were used to model the wave farm induced morphological variations on a gravel dominated beach the results indicate that under both sw and se waves the wave farm composed by wavecat devices with Œ± 30 provides more less protection for short long peak periods quantified in terms of breaking wave heights this is down to the different values of the transmission and reflection coefficients corresponding to the two configurations the differences in significant wave height at breaking between the two wec configurations under se waves are generally greater than those under sw waves this along with the more oblique incidence for se waves leads to greater differences in lst rates between the two configurations under se waves the lst rates thus obtained were used to compute the changes in shoreline geometry and dry beach area the results confirm the efficiency of wave farms in coastal protection indeed accretion occurs under all the sea states considered the gains in dry beach area obtained with the 60 wec configuration were generally greater for long peak periods t p 11 s and t p 13 s and lower for the shortest peak period t p 7 s we conclude that the performance of dual wave farms depends on both the wec configuration and the sea state in other words the optimum configuration depends on the sea state therefore for maximum performance of the wave farm in coastal erosion protection the wec geometry should be adjusted dynamically to the sea state this dynamic adaptation strategy leads to a greater dry beach area with the methodology presented in this paper this benefit may be quantified for any beach of interest and compared with the cost of the dynamic adaptation strategy versus a constant geometry strategy in order to establish which is more appropriate future research should focus on the assessment of the role of wec configuration in power production investigating the optimum pair angle draft that maximises power production acknowledgements this paper was carried out in the framework of research grants waveimpact pcig 13 ga 2013 618556 european commission marie curie fellowship fellow gi and ice intelligent community energy european commision contract no 5025 rb was funded by the spanish ministry of science innovation and universities programa juan de la cierva 2017 fjci 2017 31781 wave and bathymetric data were provided by puertos del estado spain and the spanish ministry of agriculture fisheries and food respectively we thank two anonymous reviewers for their improvements to this work 
22901,wave farms i e arrays of wave energy converters wecs have recently been proven to be effective in fulfilling the dual function of carbon free energy generation and coastal protection in this paper these dual function wave farms are referred as dual wave farms the objective of this work is to investigate the influence of the wec configuration on the performance of these dual wave farms through a case study a dual wave farm consisting of wavecat wecs deployed off an eroding beach wavecat is a floating overtopping wec consisting of two hulls joined by their stern forming a wedge two configurations are considered with wedge angles of 30 and 60 to characterize wave wec interaction laboratory tests of a 1 30 wavecat model are conducted using the two configurations and low mid and high energy sea states characteristic of the study area the reflection and transmission coefficients obtained from the laboratory tests are inputted into a suite of numerical models to investigate the hydro and morphodynamics of the beach we find that the smaller wedge angle 30 wecs afford more less coastal protection quantified in terms of dry beach area availability for short long peak periods than wecs with 60 these results allow us to conclude that for optimum performance of dual wave farms wec geometry should be adapted dynamically to the sea state keywords ocean energy wave farm laboratory experiments numerical modelling device design 1 introduction the development of renewable energy is one of the most relevant targets confronting society in the coming decades european commission 2007 2009 due to the finite nature of fossil fuels their high costs and last but not least the environmental impacts of their exploration and use asif and muneer 2007 shafiee and topal 2009 among the carbon free energy sources marine energy resources offer a vast potential and comparatively low effects on the environment falnes 2007 cornett 2008 cruz 2008 panwar et al 2011 rinaldi et al 2017 in particular the worldwide potential of wave energy was assessed as 17 tw h year lund 2007 these facts contrast with the low degree of development and utilization of wave energy compared to other renewable sources such as hydroelectric biomass or wind energy u e i administrationet al 2011 eurostat 2016 for these reasons increasing research efforts have focused on wave energy over the last years the objectives of the investigations carried out so far have been 1 the assessment and characterization of wave energy resources iglesias et al 2009 iglesias and carballo 2011 vicinanza et al 2013a carballo et al 2015 2018 contestabile et al 2015 l√≥pez et al 2015a silva et al 2015 veigas et al 2014 2015 iuppa et al 2015a viviano et al 2016 prieto et al 2019 2 the study and optimization of possible locations carballo et al 2014 iuppa et al 2015b l√≥pez ruiz et al 2016 2018a 2018b elginoz and bas 2017 alifdini et al 2018 khojasteh et al 2018 3 the economic viability of wave energy astariz and iglesias 2015a 2016a astariz et al 2015a contestabile et al 2017a frost et al 2018 4 the combined implementation with other ocean energies most notably wind azzellino et al 2013 astariz and iglesias 2015b 2016b astariz et al 2015b p√©rez collazo et al 2015 wang et al 2018 and 5 the development of wave energy technologies and devices viviano et al 2016 vicinanza et al 2012 2013b 2014 falc√£o 2007 margheritini et al 2009 fernandez et al 2012a l√≥pez et al 2014 2015b 2015c 2016 2017a 2017b 2018 2018 l√≥pez and iglesias 2014 day et al 2015 buccino et al 2015 contestabile et al 2017b elhanafi et al 2017 medina l√≥pez et al 2017 2019 l√≥pez et al 2018 mo√±ino et al 2018 ramos et al 2018 barambones et al 2018 chao et al 2018 do et al 2018 halder et al 2018 kolios et al 2018 sergiienko et al 2018 wu et al 2018 yang et al 2018 zheng and zhang 2018 one of the wave energy converters wecs under development is wavecat iglesias et al 2009 2011 a floating overtopping wec it comprises two hulls joined at the stern by a hinge for a detailed description of the device the reader is referred to fernandez et al 2012a 2012b wave farms consisting of wavecat wecs have been proven to fulfil a dual function as wave energy generators and coastal defence elements on both sandy beaches abanades et al 2014a 2014b 2015 2018 and gravel dominated coasts bergillos et al 2018a 2019 rodriguez delgado et al 2018a 2018b 2019 so far the effects of the wec configuration on the hydro and morphodynamics of the coast in the lee of the wave farm have not been studied the main objective of the present research is to analyse the effects of the configuration of wavecat in particular the wedge angle or angle between the twin hulls on wave propagation longshore sediment transport lst and shoreline dynamics considering the varying transmission and reflection coefficients obtained from laboratory experiments under different sea states the laboratory experiments were conducted in the ocean basin of the university of plymouth section 3 1 in addition this research involved the application of a wave propagation model section 3 2 1 an lst formulation section 3 2 2 and a one line model section 3 2 3 to a study site in southern spain section 2 2 study site playa granada is a gravel dominated deltaic beach located on the mediterranean coastline of southern spain fig 1 a the beach which is bounded by the guadalfeo river mouth to the west and by punta del santo to the east fig 1b has been experiencing shoreline retreat and terminal erosion in recent years bergillos et al 2015a 2016a 2018b partly due to anthropogenic interventions in the guadalfeo river basin bergillos et al 2015b 2016b bergillos and ortega s√°nchez 2017 two incoming wave directions are predominant at the study site fig 1c south west sw and south east se the values of deep water significant wave height which are not exceeded 50 90 99 and 99 9 of the time are 0 5 m 1 2 m 2 1 m and 3 1 m respectively bergillos et al 2016c the astronomical tidal range is 0 6 m ortega s√°nchez et al 2017 and surge levels under storm conditions frequently exceed 0 5 m bergillos et al 2016d 3 methods 3 1 laboratory experiments laboratory tests were performed in the ocean basin of the university of plymouth to measure the reflection k r and transmission k t coefficients for two different wedge angles i e angles between the hulls of wavecat Œ± 30 and Œ± 60 fig 2 the experiments were carried out at a 1 30 scale and the dimensions of the model were 3 m length and 0 6 m height fig 2 the selection of the two wedge angle values was done to represent two different types of operation of wavecat corresponding to two different types of sea state one in which the length of the incoming wave front that is harnessed by the device is maximised Œ± 60 given that the wave power per linear metre of wave front is limited low energy sea state and another in which the amount of wave power per linear meter of wave front is substantial high energy sea state and therefore harnessing a shorter stretch of wave front is sufficient to reach the rated power of the device Œ± 30 twelve different sea states were tested with values of the significant wave height h m 0 between 0 03 m and 0 1 m 1 m and 3 m in the model prototype the tested values of the spectral peak period t p mod ranged from 1 28 s to 2 37 s representing real values t p prot from 7 s to 13 s froude similarity these sea states are representative of the wave conditions in playa granada fig 1c the tested sea states along with the measured reflection and transmission coefficients are summarized in table 1 a detailed description of the laboratory experiments can be found in allen et al 2016 2018 3 2 numerical modelling 3 2 1 swan model the swan model was used to propagate the sea states in the prototype scale detailed in section 3 1 from deep water toward the coast for the two prevailing directions at the study zone fig 1c sw 238 and se 107 the model was previously calibrated for the study area by bergillos et al 2017a through comparison with field data the wave farm location shown in fig 1b was selected based on the results from previous studies which have demonstrated that it is the best site in terms of wave energy potential l√≥pez ruiz et al 2016 and coastal protection rodriguez delgado et al 2018b the wave farm layout consisting of 11 wavecat wecs spaced by a distance of 180 m and arranged in two rows was also chosen on the basis of recent works at the study site rodriguez delgado et al 2018a 2019 two numerical grids were defined and used fig 1d a coarse grid covering the entire deltaic region and extending from deep to shallow waters and a nested grid covering the nearshore region including the wave farm area with higher resolution to properly model the wave farm effects the wecs were introduced in swan as artificial obstacles specifying their reflection and transmission coefficients hereafter denoted by k r and k t respectively for each sea state and wedge angle table 1 the results provided by swan were utilized to obtain wave variables at breaking conditions through the fraction breaking variable and on this basis apply the lst formulation below 3 2 2 longshore sediment transport formulation lst was obtained through the formulation proposed by van rijn 2014 which was found in previous work bergillos et al 2017a to provide good estimates of the measured lst rates at the study site the following expression was used 1 q 0 00018 k œÅ s g 0 5 tan Œ≤ 0 4 d 50 0 6 h m b r 3 1 sin 2 Œ∏ b r where q is the lst rate œÅ s is the sediment density g the gravity acceleration tan Œ≤ the beach slope of the surf zone d 50 the grain size h m b r Œ∏ b r the breaking significant wave height wave angle respect to shore normal and the coefficient k considers the effect of wave period on lst 3 2 3 one line model the lst rates obtained with the equation of van rijn 2014 and detailed in the previous section were used to calculate the changes in the shoreline position through the application of a one line model pelnard consid√®re 1956 which is based on the following equation 2 y s t 1 d q x s where y s and x s are the coordinates of the shoreline t is the time and d is the sum of the height of the berm and the closure depth bergillos et al 2017a proved that the joint application of the swan model the lst formulation of van rijn 2014 and the one line model replicates the coastline changes in playa granada 4 results 4 1 significant wave heights at breaking this section details the influence of the wave farm on wave propagation in particular on the significant wave heights at breaking depending on the wedge of the wecs the alongshore variation of the differences between breaking significant wave heights for Œ± 30 and Œ± 60 Œ¥ h m b r are indicated in fig 3 under sw waves it is shown that the differences are generally negative for short wave periods t p 7 s and positive for long periods t p 11 s and t p 13 s in all the cases the maximum differences are reached at the eastern part of the coast influenced by the location of the wave farm shown in fig 1 and its effects in the leeward wave propagation patterns for all the h m 0 the alongshore averaged values of Œ¥ h m b r for sw waves increase with increasing values of t p fig 4 thus in terms of wave energy at the breaking zone the wave farm composed by devices with the 30 configuration provides more less protection for short long t p than that with the 60 configuration this is a result of the different k r and k t of both configurations table 1 for given values of t p the differences in breaking wave heights between both angles decrease for increasing values of h m 0 fig 4 under incoming se waves the differences are also negative positive for short long t p although in this case they extend along most of the study stretch fig 3 for constant values of h m 0 the alongshore averaged Œ¥ h m b r under se waves is greater for longer t p fig 4 it is also due to the differences in k r and k t between both devices table 1 thus the greater the values of t p the lower the protection provided by devices with Œ± 30 compared to those with Œ± 60 the differences in significant wave height at breaking between both devices under se wave conditions are generally greater than those under sw waves fig 4 with maximum negative positive alongshore averaged values of Œ¥ h m b r equal to 0 82 cm 0 77 cm for low energy waves h m 0 1 m 0 77 cm 0 55 cm for mid energy waves h m 0 2 m and 0 71 cm 0 61 cm for high energy waves h m 0 3 m 4 2 longshore sediment transport rates the differences in lst rates between the wecs with Œ± 30 and Œ± 60 are analysed in this section fig 5 depicts the alongshore distribution of these differences for all the sea states considered under sw waves the differences are generally greater for higher values of h m 0 and lower values of t p i e the greater the wave steepness the higher the differences in lst rates between the farms with both angles the differences are more significant in the western eastern stretch of the coast for short long peak periods fig 5 under se wave conditions the greater differences are located in the eastern part of the study section fig 5 i e in the lee of the wave farm fig 1 for short periods t p 7 s the differences are negative in the eastern end of the stretch of beach and become positive toward the west whereas the opposite occurs for long periods t p 11 s and t p 13 s in general the differences are greater as the h m 0 values increase table 2 the differences in lst rates between the farms composed by both devices under se wave conditions are greater than those under sw waves table 2 and fig 6 this is influenced by both the higher differences in breaking significant wave heights section 4 1 and the higher angles from shore normal for se waves which increase the lst rates and differences 4 3 shoreline geometry the lst rates obtained in the previous section were used to compute the variations in the shoreline morphology over a one month period for h m 0 1 m h m 0 2 m and h m 0 3 m representing low mid and high energy conditions respectively the differences between the final shorelines for Œ± 30 and Œ± 60 under both sw and se waves are shown in fig 7 for sw waves and short peak periods t p 7 s the maximum differences are negative and concentrated in the central stretch of beach where the main occupations are located indicating that the wave farm with Œ± 30 provides greater protection at this location on the contrary the differences in the western part of the beach are positive fig 7 i e the farm with Œ± 60 leads to greater accretion near the river mouth for short wave periods this section has experienced acute shoreline retreat in recent years due to river damming bergillos et al 2016b for long wave periods t p 11 s and t p 13 s the maximum differences under sw waves are positive and located in the central stretch of beach in addition the alongshore averaged values are positive for low mid and high energy conditions table 3 thus under sw waves with long periods the wave farm with Œ± 60 provides greater protection against shoreline erosion this leads to a higher efficiency in terms of dry beach area section 4 4 on the other hand under se waves the greatest differences are concentrated along the eastern section of the coastline this is caused by the farm location fig 1 and the resulting greater differences in lst between both angles at this stretch of beach fig 5 the differences in final shoreline positions are generally negative positive for short long peak periods indicating that the wave farm composed by wecs with Œ± 30 Œ± 60 provides more protection for short long wave periods fig 5 and table 3 for all the sea states considered the differences in the final shoreline geometries between devices with Œ± 30 and Œ± 60 under se wave conditions are higher than those under sw waves these differences determine the dry beach area availability as explained in the following section 4 4 dry beach area the differences between the final and initial dry beach areas for all the sea states analysed and for both angles between the hulls are depicted in fig 8 it may be observed that these differences are always positive i e beach accretion occurs in all cases this confirms the efficiency of wave farms as protection elements against coastline erosion as shown in fig 8 the accretion is more pronounced under se waves this is in agreement with the observed morphological response of the coastline since sw waves contribute to erode the beach and se waves lead to beach recovery bergillos et al 2017a 2017b in this case the presence of the farm increases the beach accretion under se waves and reverts the coastline response from erosion to accretion under sw wave conditions the dry beach area differences are generally greater with increasing values of h m 0 and t p fig 8 the comparison of the results obtained for both angles between hulls allow concluding that under sw waves the farm composed by devices with Œ± 60 is more efficient in terms of coastal protection for all the cases except four of them associated to mild conditions h m 0 1 m t p 7 s h m 0 1 m t p 9 s h m 0 2 m t p 7 s and h m 0 2 m t p 9 s table 4 and fig 9 under se waves the wavecat devices with Œ± 30 are more efficient for the shortest peak period t p 7 s whereas those with Œ± 60 lead to greater accretion values for the rest of wave conditions table 4 the results of this section indicate that for the best performance in terms of coastal protection the geometry of the wecs should be adjusted dynamically to the sea state if this is not possible i e if a fixed configuration constant wedge angle must be adopted then this configuration should be chosen on the basis of a detailed analysis of the wave climate at the site of interest with a view to optimizing the coastal protection performance under the prevailing sea states the methodology presented in this work which combines laboratory tests with different wec configurations and numerical modelling may be used for other geometries and beaches to investigate the optimum configuration for a wave farm project 5 conclusions wave energy is one of the renewables with the greatest potential for development due to the resource availability and low visual pollution recent research has highlighted the possibility of using wave farms for a dual function i e renewable energy generation and coastal protection this paper presents the first study on the influence of wec configuration on the performance of dual wave farms in particular the effects of two values of the wedge angle i e the angle between the twin hulls of wavecat wecs Œ± 30 and Œ± 60 on significant wave height at breaking lst rates shoreline geometry and dry beach area were analysed for this purpose the transmission and reflection coefficients were determined for relevant sea states based on laboratory experiments in a wave tank and these values were used to model the wave farm induced morphological variations on a gravel dominated beach the results indicate that under both sw and se waves the wave farm composed by wavecat devices with Œ± 30 provides more less protection for short long peak periods quantified in terms of breaking wave heights this is down to the different values of the transmission and reflection coefficients corresponding to the two configurations the differences in significant wave height at breaking between the two wec configurations under se waves are generally greater than those under sw waves this along with the more oblique incidence for se waves leads to greater differences in lst rates between the two configurations under se waves the lst rates thus obtained were used to compute the changes in shoreline geometry and dry beach area the results confirm the efficiency of wave farms in coastal protection indeed accretion occurs under all the sea states considered the gains in dry beach area obtained with the 60 wec configuration were generally greater for long peak periods t p 11 s and t p 13 s and lower for the shortest peak period t p 7 s we conclude that the performance of dual wave farms depends on both the wec configuration and the sea state in other words the optimum configuration depends on the sea state therefore for maximum performance of the wave farm in coastal erosion protection the wec geometry should be adjusted dynamically to the sea state this dynamic adaptation strategy leads to a greater dry beach area with the methodology presented in this paper this benefit may be quantified for any beach of interest and compared with the cost of the dynamic adaptation strategy versus a constant geometry strategy in order to establish which is more appropriate future research should focus on the assessment of the role of wec configuration in power production investigating the optimum pair angle draft that maximises power production acknowledgements this paper was carried out in the framework of research grants waveimpact pcig 13 ga 2013 618556 european commission marie curie fellowship fellow gi and ice intelligent community energy european commision contract no 5025 rb was funded by the spanish ministry of science innovation and universities programa juan de la cierva 2017 fjci 2017 31781 wave and bathymetric data were provided by puertos del estado spain and the spanish ministry of agriculture fisheries and food respectively we thank two anonymous reviewers for their improvements to this work 
22902,in the simulations of a water entry problem by sph smoothed particle hydrodynamics method there has not been much research on the interaction between the elastomer and fluid in sph because it is difficult to accurately handle the movable and deformable interface in this work we address this problem in the following three aspects to obtain a better simulation result 1 to weaken the pressure oscillations which would lead to numerical instability in violent flows the godunov sph method based on a riemann solver is used for the fluid 2 fpm finite particle method can improve the kernel estimation accuracy of the sph however the accuracy is decreased when fpm encounters discontinuous problems therefore dfpm discontinuous fpm is presented to preserve the estimation accuracy 3 generally a large number of particles are usually used to describe the interface precisely giving rise to high computational cost to decrease the cost the dynamic particle refinement strategy is applied to the water entry of an elastomer the slamming force stress and deformation of the elastomer and the pressure of the fluid are shown to demonstrate the advantages of the above three aspects for dealing with the water entry of an elastomer keywords elastomer godunov sph smoothed particle hydrodynamics dfpm discontinuous fpm dynamic refinement water entry 1 introduction with the use of various materials in aviation spaceflight and ships the elastic behavior of a structure when it slams into water has become increasingly important because of the nonlinearity factors and the complex coupling process an exact theoretical solution for the water entry of an elastomer does not exist as a fully lagrangian particle method sph smoothed particle hydrodynamics is advantageous for addressing the fsi fluid structure interaction problem because the highly nonlinear behavior of the moving interface can be implicitly captured even with a complex interface oger et al 2005 studied the wedge slamming into the water with a free surface by the fem sph coupling method campbell and vignjevic 2012 applied the fem sph coupling method to study the damage of the helicopter metal floor when it slammed into the water as well as the response of the life buoy in the wave in the same year panciroli et al 2012 still used fem sph coupling method to simulate the deformable wedge in all of these studies the deformable structures are represented by fem meshes and the fluid is scattered by sph particles nevertheless fem and sph methods are completely different numerical methods in the calculation it is necessary to use two solvers and provide the additional management to connect the two methods leading to a complicated computational process if both the fluid and the structure are represented by sph particles only one uniform solver can be used and is easy to implement the gpu hardware acceleration moreover the mesh dependency which is a defect of the fem in problems involving large strains also would be improved by sph method lin et al 2014 therefore in this paper the sph method was used to simulate both the deformable structure and the fluid in the explicit computation of hydrodynamic problems the weakly compressible sph wcsph method assumes that the fluid is weakly compressible with a small variation of the density monaghan 1994 when we simulate a violent free surface with breaking the pressure which is evaluated through the density exhibits spurious oscillations that may lead to numerical instability lee et al 2008 to suppress the pressure oscillations monaghan and gingold 1983 proposed an artificial viscosity term in the momentum equation however this term may lead to excessive dissipation that affects the physical flow characteristics colagrossi and landrini 2003 suggested the use of a moving least squares mls interpolation method to filter the density field and smooth the pressure this approach gives good results but is rather computationally expensive moussa 2006 developed an sph method based on solving a riemann problem to enhance numerical stability similar ideas using riemann solvers were also proposed in monaghan 1997 inutsuka 2002 parshikov and medin 2002 for the wcsph method zhang et al 2017 proposed a low dissipation riemann solver to simulate violent flows since the speed of the structure is high and the violent flows may appear we will apply a riemann solver zhang et al 2017 to the fluid flow to weaken the pressure oscillations sph has a disadvantage of the lower kernel estimation accuracy at the boundary where the supported domain of the particle is truncated to address this issue chen and beraun 2000 proposed a normalization corrected smooth particle method cspm and liu and liu 2006 proposed the finite particle method fpm and was applied into the fsi problem huang et al 2018 they recovered the estimation accuracy at the boundary based on the taylor series expansion compared to sph fpm is relaxed in the selection of the kernel function and at the boundary region fpm has a higher accuracy compared to cspm fpm can simultaneously estimate both the function and its derivative reducing the accumulation error caused by the low order derivative however the accuracy of the fpm method is greatly reduced when dealing with the discontinuous physical field wang et al 2018a to improve this disadvantage dfpm discontinuous fpm will be proposed for the discontinuous problem in this paper and we will apply it to the structure as a carrier to transmit the interaction the deformable interface between the fluid and elastomer must be captured precisely in each time step and a large number of particles need to be involved in capturing the interface particle dynamic refinement can adaptively improve the spatial resolution and reduce the computational cost to some extent wang et al 2018b and will be applied to describe the interface with the expansion of this application for sph various refinement criteria and forms have appeared monaghan and varnas 1988 martin et al 2005 feldman and bonet 2010 yan et al 2009 reyes et al 2013 in ref wang et al 2018b a two phase refinement criterion is proposed for fsi and its applicability just for the rigid structure was demonstrated in this paper we could use the two phase refinement criterion and propose the particle dynamic refinement strategy for the water entry of the elastomer the rest of the paper is organized as follows the second section introduces gd sph sph with gsph and dfpm methods formulas for the water entry of an elastomer the third section describes the numerical simulation model and results obtained for the entry of an elastomer into water in the fourth section the particle dynamic refinement strategy is presented and applied to the water entry problem a summary is given in the fifth section 2 gd sph formulas for water entry of an elastomer 2 1 standard sph formulas for water entry of an elastomer 2 1 1 standard sph formulas for water as generally assumed in the sph scheme water is considered to be weakly compressible in consideration of the computational complexity and the control equations for water in the lagrangian form are 1 a d œÅ d t œÅ d i v v b œÅ d v d t p f v f s f b c p c 0 f 2 œÅ œÅ 0 f d d r d t v where œÅ p r and v are the density pressure position and velocity of the water respectively œÅ 0f and c 0f are the density at the free surface and the reference sound speed in eq 1 c f v f s and f b are the viscous force surface tension and body force respectively surface tension f s could be neglected when the air is not involved and the surface tension does not dominate in the momentum equation in the sph methodology the derivative of f r at particle i f r i is obtained by following expressions monaghan 2012 2 f r i j 1 n m j œÅ j f r j f r i w i j 3 f r i œÅ i j 1 n m j f r i f r j œÅ i œÅ j w i j where œÅ i and r i are the density and position of the particle i respectively j runs over the particles within the supported domain of the water particle i with mass m j density œÅ j and position r j the values of f r at particle i and j are denoted by f r i and f r j the function w i j w r i j h with the notation r ij r i r j is the sph kernel function and h is the smoothing length considering momentum conservation we use eqs 2 and 3 to discrete eqs 1 a and 1 b respectively and the discrete control equations for a fluid particle f in the sph method are given by 4 a d œÅ f d t œÅ f j m j œÅ j v f v j w f j b d v f d t j m j p f p j œÅ f œÅ j œÄ f j w f j s f r f s m s f s w f s g c p f c 0 f 2 œÅ f œÅ 0 d d r f d t v f where œÅ f v f m f p f and r f are the density velocity mass pressure and position of the fluid particle f j runs over the particles within the supported domain of the water particle f s is the structure particle within the supported domain of the particle f g is gravity œÄ fj and œÄ fs proposed by monaghan and gingold 1983 are the artificial viscosity force between particle f and particles j and s respectively f r f s is the force per unit mass on the water particle f due to particle s monaghan and kajtar 2009 2 1 2 standard sph formulas for elastomer similarly the discrete control equations for the elastomer particle s are given by 5 a d œÅ s d t œÅ s j m j œÅ j v s v j w s j b d v s d t j m j œÉ s Œ± Œ≤ œÉ j Œ± Œ≤ œÅ s œÅ j s j w s j f f r s f m f s f w s f g c p s c 0 s 2 œÅ s œÅ 0 d d r s d t v s where œÅ s v s m s œÉ s Œ±Œ≤ c 0s and r s are the density velocity mass total stress tensor reference sound speed and position of the structure particle s j runs over the particles within the supported domain of the elastomer particle s f is the fluid particle within the supported domain of particle s œÄ sj and œÄ sf also are artificial viscosity terms and generally included in the momentum equation for stability monaghan and gingold 1983 f r s f is the force per unit mass on the structure particle s due to particle f and m s f r s f m f f r f s œÉ Œ±Œ≤ is the total stress tensor and roman letters Œ± Œ≤ are the Œ± th and Œ≤ th components œÉ Œ±Œ≤ contains deviatoric stress s Œ±Œ≤ and isotropic pressure p which are given by 7 6 œÉ Œ± Œ≤ s Œ± Œ≤ Œ¥ Œ± Œ≤ p Œ¥ Œ± Œ≤ 1 Œ± Œ≤ 0 Œ± Œ≤ an equation that determines the deviatoric stress s Œ±Œ≤ is necessary the deviatoric stress rate in jaumann rate form is given by 7 d s Œ± Œ≤ d t 2 Œº Œµ Œ± Œ≤ 1 3 Œ¥ Œ± Œ≤ Œµ Œ± Œ≤ s Œ± Œ≥ œâ Œ≤ Œ≥ œâ Œ± Œ≥ s Œ≥ Œ≤ where Œº is the shear modulus Œµ Œ± Œ≤ is the strain rate tensor and œâ Œ±Œ≤ is the rotation tensor Œµ Œ± Œ≤ and œâ Œ±Œ≤ are given by eqs 8 and 9 8 Œµ Œ± Œ≤ 1 2 v Œ± x Œ≤ v Œ≤ x Œ± 9 œâ Œ± Œ≤ 1 2 v Œ± x Œ≤ v Œ≤ x Œ± 2 1 3 the kernel function the kernel function we use is the cubic spline function for a space of two dimensions monaghan 1992 and is given by 10 w r h 15 7 œÄ h 2 2 3 r 2 1 2 r 3 0 r 1 1 6 2 r 3 1 r 2 0 r 2 where r r h for the kernel between two particle i and j the kernel uses the average smoothing length defined by 1 2 h i h j the initial value of h is 1 2 Œ¥ p where Œ¥ p is the initial particle spacing 2 1 4 the artificial viscosity the artificial viscosity term not only reflects the conversion of kinetic energy into heat but also eliminates numerical oscillations and provides the necessary dissipation in impact problems monaghan and gingold 1983 the most widely used artificial viscosity is included in the momentum equations eq 4 b and eq 5 b 11 œÄ i j Œ± œÄ c i j œï i j Œ≤ œÄ œï i j 2 œÅ i j v i j r i j 0 0 v i j r i j 0 œï i j h i j v i j r i j r i j 2 œÜ 2 v i j v i v j r i j r i r j œÜ 0 1 h c i j 1 2 c i c j œÅ i j 1 2 œÅ i œÅ j h i j 1 2 h i h j where c i j œÅ i j and h i j are the average sound speed the average density and the average smoothing length of particle i and j respectively Œ± œÄ and Œ≤ œÄ are constant values which are chosen appropriately for numerical stability Œ± œÄ 0 1 and Œ≤ œÄ 0 1 for water bui et al 2008 and Œ± œÄ 1 0 and Œ≤ œÄ 1 0 for elastomer monaghan and gingold 1983 herein are assigned 2 1 5 interaction between fluid and elastomer the interaction between the water and structure could be considered as the sph boundary treatment there are several approaches to implement the rigid boundary in sph such as virtual particle adami et al 2012 oger et al 2006 boundary integral kulasegaram et al 2004 repulsive force monaghan and kajtar 2009 etc however when the structure is an elastomer some approaches may become inapplicable or complicated due to the moving and deformable boundary herein the repulsive force will be used because there is no need to calculate the normal of the interface which makes the interaction easy to be implemented f r f s in eq 4 b is given by 12 f r f s 0 01 c 0 f 2 r f s r f s 2 w r f s 2 m s m f m s where r fs is the vector from particle s to particle f m s is the mass of particle s 2 1 6 time integration to solve the sph discrete equations the leapfrog lf time integration scheme bui et al 2008 is applied due to its low storage requirement and high efficiency the basic equations for a fluid particle f 13 t t Œ¥ t œÅ f t Œ¥ t 2 œÅ f t Œ¥ t 2 Œ¥ t d œÅ f d t v f t Œ¥ t 2 v f t Œ¥ t 2 Œ¥ t d v f d t r f t Œ¥ t r f t Œ¥ t v f t Œ¥ t 2 in order to keep the consistent at each subsequent time step the density and the velocity need to be predicted half a time step ahead to coincide the position the stability of the above lf integration scheme is governed by the courant friedrichs levy condition which limits a time step proportional to the smoothing length in this work the following condition is used to determine the size of time step 14 Œ¥ t c f l h i c 0 i where cfl is chosen to be 0 2 if the fluid and the elastomer have different time steps of Œ¥ t f and Œ¥ t s a smaller value is selected 15 Œ¥ t min Œ¥ t f Œ¥ t s 2 2 godunov sph for fluid godunov sph is a modification of sph with a riemann solver when the structure slams into the water violent and breaking flows will appear using the weakly compressible state equation eq 4 c the pressure oscillation may lead to numerical instability gsph is an effective method to dampen the oscillation without excessive dissipation zhang et al 2017 for eq 4 a the standard wcsph discretization of the continuity equation can be expressed by 16 d œÅ f d t œÅ f j m j œÅ j v f v j w r f r j 2 œÅ f j m j œÅ j v f v f j w r f r j where v f j v f v j 2 is the average velocity between particles f and j for eq 4 b the standard discretization of the momentum equation without taking account artificial viscosity can also be written as 17 d v f d t j m j p f p j œÅ f œÅ j w r f r j s f r f s g 2 j m j p f j œÅ f œÅ j w r f r j s f r f s g where p f j p f p j 2 is the average pressure between particles f and j as shown in fig 1 for the sph method based on riemann solvers monaghan 1997 an interparticle riemann problem is constructed along a unit vector e fj r fj r fj pointing from particle f to particle j in this riemann problem the initial left and right states are on particle f and j respectively and the discontinuity is at the middle point r f j r f r j 2 the l and r states are 18 œÅ l u l p l œÅ f v f e f j p f œÅ r u r p r œÅ j v j e f j p j a linearized riemann problem solver toro 2009 i e u and p for smooth flows can be expressed by 19 u u l œÅ l c l u r œÅ r c r p l p r œÅ l c l œÅ r c r p p r œÅ l c l p l œÅ r c r œÅ l c l œÅ r c r u l u r œÅ l c l œÅ r c r where c l c r c 0 c 0 is the sound speed of the fluid then u is transformed into vector v v u e f j v f j u e f j where u u l u r 2 is interparticle average with the solution of the riemann problem v f j and p f j are replaced by v p and the godunov sph discretization equations are obtained as 20 d œÅ f d t 2 œÅ f j m j œÅ j v f v w r f r j 21 d v f d t 2 j m j p œÅ f œÅ j w r f r j s f r f s g 2 3 dfpm for solid 2 3 1 dfpm basic equation in a solid boundary the supported domain of the particle is truncated the incomplete supported domain will lead to the unsatisfactory normalization of the kernel function fpm that enforces the normalized kernel and improves the accuracy of the boundary was proposed by liu and liu 2006 however the accuracy of the fpm method is not sufficient when solving the interface in the discontinuous problems therefore in this section the dfpm method is proposed to improve the accuracy of the fpm a discontinuous problem in one dimension is shown in fig 2 where d is the discontinuous point œâ 1 œâ 2 d œâ region is the supported domain of the particle x i and x k is the particle located in the œâ2 d b region sph is based on the continuous field and integration estimation should be implemented at œâ1 and œâ2 regions respectively liu et al 2003 the following equations are easily obtained 22 œâ f x w i x dx œâ 1 f x w i x dx œâ 2 f x w i x dx 23 œâ f x w i x x dx œâ 1 f x w i x x dx œâ 2 f x w i x x dx where w i x w x x i h w i x d w i d x then f x is expanded at point x i with region œâ1 and expanded at point x k with region œâ2 by a taylor series expansion the second order and above derivatives are ignored 24 œâ 1 f x w i x dx œâ 2 f x w i x dx œâ 1 f x i x x i f x i w i x dx œâ 2 f x k x x k f x k w i x dx f x i œâ 1 w i x dx f x k œâ 2 w i x dx f x i œâ 1 x x i w i x dx f x k œâ 2 x x k w i x dx 25 œâ 1 f x w i x x dx œâ 2 f x w i x x dx œâ 1 f x i x x i f x i w i x x dx œâ 2 f x k x x k f x k w i x x dx f x i œâ 1 w i x x dx f x k œâ 2 w i x x dx f x i œâ 1 x x i w i x x dx f x k œâ 2 x x k w i x x dx the above equations can be written in a matrix form 26 œâ 1 w i x dx œâ 1 x x i w i x dx œâ 1 w i x x dx œâ 1 x x i w i x x dx f x i f x i œâ f x w i x dx f x k œâ 2 w i x dx f x k œâ 2 x x k w i x dx œâ f x w i x x dx f x k œâ 2 w i x x dx f x k œâ 2 x x k w i x x dx as shown in fig 3 if we divide the œâ2 region into a number of smaller subdomains œâp i i 1 p p is the number of the subdomains and each subdomain only contains one particle x p xu et al 2013 then the above equation can be converted to 27 œâ 1 w i x dx œâ 1 x x i w i x dx œâ 1 w i x x dx œâ 1 x x i w i x x dx f x i f x i œâ f x w i x dx p f x p œâ p i w i x dx p f x p œâ p i x x p w i x dx œâ f x w i x x dx p f x p œâ p i w i x x dx p f x p œâ p i x x p w i x x dx with the constant field for each subdomains œâp i the derivative of f x p is zero then eq 27 is transformed into 28 œâ 1 w i x dx œâ 1 x x i w i x dx œâ 1 w i x x dx œâ 1 x x i w i x x dx f x i f x i œâ f x w i x dx p œâ p i f x p w i x dx œâ f x w i x x dx p œâ p i f x p w i x x dx 29 œâ 1 w i x dx œâ 1 x x i w i x dx œâ 1 w i x x dx œâ 1 x x i w i x x dx f x i f x i œâ f x w i x dx œâ 2 f x w i x dx œâ f x w i x x dx œâ 2 f x w i x dx œâ 1 f x w i x dx œâ 1 f x w i x x dx 30 œâ 1 w i x dx œâ 1 x x i w i x dx œâ 1 w i x x dx œâ 1 x x i w i x x dx f x i f x i œâ 1 f x w i x dx œâ 1 f x w i x x dx eq 30 is similar to that of the equation of the fpm liu and liu 2006 the difference is that in the fpm method integration is implemented over the entire region of the supported domain of the particle x i œâ while in eq 30 integration is implemented over the subdomain of the supported domain œâ1 eq 30 is the integral form of the dfpm method in one dimension similarly in the two dimensional case as shown in fig 4 the entire supported domain of the particle x i has subdomains œâ1 and œâ2 and the interface d œâ1 œâ2 d œâ the following equation can be obtained 31 œâ 1 w i x d x œâ 1 x x i w i x d x œâ 1 y y i w i x d x œâ 1 w i x x d x œâ 1 x x i w i x x d x œâ 1 y y i w i x x d x œâ 1 w i y x d x œâ 1 x x i w i y x d x œâ 1 y y i w i y x d x f x i f x x i f y x i œâ f x w i x d x f x k œâ 2 w i x d x f x x k œâ 2 x x k w i x d x f y x k œâ 2 y y k w i x d x œâ f x w i x x d x f x k œâ 2 w i x x d x f x x k œâ 2 x x k w i x x d x f y x k œâ 2 y y k w i x x d x œâ f x w i y x d x f x k œâ 2 w i y x d x f x x k œâ 2 x x k w i y x d x f y x k œâ 2 y y k w i y x d x where w i x w i x w i y w i y similar to the one dimensional case as shown in fig 5 œâ2 is divided into a number of smaller subdomains œâp i and each subdomain only contains one particle x p then eq 32 is obtained 32 œâ 1 w i x d x œâ 1 x x i w i x d x œâ 1 y y i w i x d x œâ 1 w i x x d x œâ 1 x x i w i x x d x œâ 1 y y i w i x x d x œâ 1 w i y x d x œâ 1 x x i w i y x d x œâ 1 y y i w i y x d x f x i f x x i f y x i œâ 1 f x w i x d x œâ 1 f x w i x x d x œâ 1 f x w i y x d x eq 32 is the integral form of the dfpm method in two dimensions and particle estimation of dfpm method is also given by eqs 33 and 34 only the particles that are located at œâ1 are considered in the formulas the function and its derivative are obtained simultaneously avoiding the accumulation error of the higher order derivative calculation 33 f x i f x i j œâ 1 m j œÅ j w i j j œâ 1 m j œÅ j x j x i w i j j œâ 1 m j œÅ j w i j x j œâ 1 m j œÅ j x j x i w i j x 1 j œâ 1 m j œÅ j f x j w i j j œâ 1 m j œÅ j f x j w i j x 34 f x i f x x i f y x i j œâ 1 m j œÅ j w i j j œâ 1 m j œÅ j w i j x j x i j œâ 1 m j œÅ j w i j y j y i j œâ 1 m j œÅ j w i j x j œâ 1 m j œÅ j w i j x x j x i j œâ 1 m j œÅ j w i j x y j y i j œâ 1 m j œÅ j w i j y j œâ 1 m j œÅ j w i j y x j x i j œâ 1 m j œÅ j w i j y y j y i 1 j œâ 1 m j œÅ j f x j w i j j œâ 1 m j œÅ j f x j w i j x j œâ 1 m j œÅ j f x j w i j y 2 3 2 estimate accuracy and convergence of dfpm 2 3 2 1 estimate accuracy of dfpm in this section discontinuous polynomials with different orders will be estimated to illustrate the approximation accuracy of dfpm figs 6 and 7 show the function error Œ∏ and its derivative error Œ∏ obtained by the estimation of dfpm for discontinuous constant linear and quadratic functions the functions are respectively x 2 x 0 5 5 x 0 5 x 2 x 0 x 0 5 5 x 0 5 x 1 x 2 x 2 2 0 x 0 5 5 x 2 5 0 5 x 1 the particle spacing Œ¥ p is 0 02 and the smoothing length h is 1 2 Œ¥ p from figs 6 and 7 it is observed that dfpm accurately estimates the discontinuous constant and linear functions however the discontinuous quadratic function was not reproduced accurately therefore dfpm is accurate to second order only this is because in the process of dfpm derivation the taylor series expansion is only retained to first order and the higher order terms are neglected if the taylor series is expanded to include the higher order terms dfpm with a higher order accuracy can be obtained reflecting the high order scalability of dfpm 2 3 2 2 convergence of dfpm as shown in 2 3 2 1 dfpm is not able to reproduce discontinuous quadratic functions accurately to verify that the accuracy of dfpm can be controlled when dealing with the high order problems in this section the convergence of dfpm is analyzed the discontinuous quadratic function in 2 3 2 1 is still considered and the cubic function x 2 x 3 2 0 x 0 5 5 x 3 5 0 5 x 1 is also estimated fig 8 shows the mean square error mse of the calculated error by dfpm for the discontinuous quadratic and cubic functions with different particle numbers for clarity the horizontal and vertical axis data are shown on the logarithmic scale it is observed that the mse decreases with increasing number of particles y for both the quadratic and cubic functions the slope is the same and is about 4 showing that the accuracy of dfpm is controllable and high accuracy can be obtained by increasing the number of particles 3 simulation of the water entry of an elastomer 3 1 numerical simulation model this section studies the water entry of an elastic aluminum beam at both ends with a constant speed the model of the beam is shown in fig 9 some elastic beam parameters are shown in table 1 both ends of the beam are constantly forced to move with a constant downward speed u both the beam and water are represented by sph particles the particle spacing Œ¥ p is 0 01 m the water density œÅ is 1000 kg m3 reynolds number r e œÅ v d Œº 100 in standard sph simulation the artificial viscosity is used for the numerical stability instead of the actual water viscosity Œº dynamic viscosity coefficient is approximatively Œº 0 125 Œ± œÄ c i j h i j œÅ i j monaghan and gingold 1983 v and d are the characteristic velocity of flow and the characteristic length respectively froude number f r v 2 g d 150 where g is the gravity acceleration when the elastomer velocity u 30 m s non negligible compressibility effects would be present fourey et al 2010 thus the real sound speed of water is performed in the simulation of fluid structure interaction the numerical model is based on the following assumptions 1 water is weakly compressible and the free surface is initially stationary 2 the surface tension the cavitation and the air cushion effect are ignored since the air is not considered in the model 3 2 results and discussion 3 2 1 gsph method to show the effect of the gsph method for water the pressure distributions of the water without and with gsph are compared in fig 10 as shown in fig 10 a with no gsph method applied the fluid shows an obvious pressure oscillation at the root of the elastic beam this is because 1 one of the inherent defects of the sph method is that the accuracy of the boundary is not sufficiently high chen and beraun 2000 liu and liu 2006 2 at the root of the elastic beam a higher velocity jet may appear the fluid is assumed to be a weakly compressible fluid and the pressure in the state eq 4 c is proportional to the square of the sound speed which is as high as 1480 m s therefore a small change in the density of the fluid will produce a large pressure change the pressure is very sensitive to the density change as shown in fig 1 in the gsph method an imaginary interface is present between particles f and j zhang et al 2017 and the approximate riemann solution is obtained as the intermediate quantity it has an obvious effect for the large gradient physics field toro 2009 as shown in fig 10 b the gsph method greatly decreases the pressure oscillation additionally the nonphysical phenomenon of negative pressure is absent it is concluded that the gsph method is an effective method for treating the high speed flow 3 2 2 dfpm method to demonstrate the advantages of the dfpm method the stress components in the x direction of the elastomer distributions without and with dfpm are compared in fig 11 it is observed that when dfpm method is not applied to the elastomer the stress distribution is messy while when the dfpm method is used the stress is well distributed the upper middle of the beam is in tension while compression effects are present in the bottom middle region of the beam fig 12 compares the stress components in the x direction of the middle of the beam point s fig 9 without and with dfpm when the dfpm method is not used the stress magnitude changes sharply and violent oscillation appears when the dfpm is used the stress curves are smooth the point s first bears compression stress and then tension stress finally stress maintains a certain range and presents a vibration state around the zero stress dotted line 3 2 3 comparison among gd sph fem sph fourey et al 2010 and theory scolan 2004 from section 3 2 1 and 3 2 2 it is concluded that gsph and dfpm indeed improve the quality of the modeling of the water entry of the elastomer next we will compare the results obtained using gd sph sph with gsph and dfpm methods fem sph fourey et al 2010 and theory scolan 2004 in the fem sph method water is represented by sph particles and the elastomer is simulated by fem 3 2 3 1 slamming force fig 13 shows the slamming force imposing on the elastomer as obtained by gd sph fem sph fourey et al 2010 and theory scolan 2004 compared to fem sph the trend of the slamming force obtained by gd sph is consistent with the results obtained by fem sph in the a b segment the slamming force remains constant because the tension and compression forces are imposed on the upper and lower surface of the beam alternately making the slamming force almost unchanged in the c d segment after the maximal deflection the beam starts to recover the deflection and the force remains balanced the peak value obtained in the gd sph simulation is slightly smaller than that obtained in the sph fem simulation the reason may be that there are different space resolutions in gd sph and fem sph in gd sph the initial particle spacing is 0 01m while in fem sph fourey et al 2010 the particle spacing of the fluid is smaller comparison of the slamming force among the gd sph fem sph fourey et al 2010 and theory scolan 2004 methods shows that in the a b segment the balanced force value obtained by gd sph is in better agreement with the theory values than that obtained by sph fem additionally the increasing rate of the slamming force by gd sph is more consistent with the theory than that of sph fem this demonstrates the effectiveness of the gd sph method if the elastomer is changed to a rigid body simulation strategy of the rigid body can be found in reference monaghan and kajtar 2009 the slamming force imposed on the rigid body is shown in dotted line as shown in fig 13 from the rigid body and the elastomer results the increasing rates of the slamming force are close however slamming force imposed on the rigid body is larger than that on the elastomer this may be due to the kinetic energy is partly transformed into the strain energy stored in the elastic body which mitigates the slamming force for the elastomer and the a b or c d segment is the feature of the slamming force imposed on the elastomer while the a b or c d segment state disappears for the rigid body because of the non deformation 3 2 3 2 deflection of the beam when the elastic beam slams into the water the external force from the water will deform the beam the deflection curves at the middle point of the beam fig 9 as functions of time are compared in fig 14 with the illustrations of the deformed beam at the maximal and minimal deformation values obtained by gd sph shown in the insets the deflection curve obtained by gd sph agrees with that of sph fem and theory while its maximal value is slightly smaller than those of the other methods with the difference of approximately 12 it is observed from the deflection curves that the middle of the beam first curves upward and then downward finally the beam presents a vibration state around the zero deflection dotted line which is consistent with the stress tendency shown in fig 12 3 2 3 3 stress distribution fig 15 shows the figures for the x direction stress components stress x of the beam and pressure p of the water obtained by gd sph and fem sph simulations at 0 5 2 5 and 4 5 ms a symmetric boundary condition is used in fem sph to decrease the computational cost on the other hand in the gd sph simulation the symmetry condition is not adopted in order to obtain an accurate comparison of the results since the sph simulation is implemented using gpus the computational time is acceptable generally the stress component in the x direction of the elastomer and the pressure of water obtained by gd sph are in good agreement with the results obtained using the fem sph coupling method it is observed from fig 15 that at 0 5 ms when the beam first enters the water the beam stress is larger at the root of the beam than other position at approximately 2 5 ms the beam comes into full contact with the water and the slamming force and the deflection of the beam almost reach their peak values the stress value is high and the beam is bent upward at 4 5 ms it is observed from the deflection curve fig 14 that the beam is bent down and reach its nadir the beam stress also reflects this phenomenon from fig 15 a 15 c showing the pressure of the water it is observed that the water in contact with the root of the beam has high pressure and the high pressure evolves with the beam entering the water with the deepening of water entry the high pressure moves to the latest splash position and the range of high pressure increases gradually with the continuous water entry the high pressure gradually disappears 4 dynamic refinement in sph due to the deformable structure the interface between the structure and water is also deformable and movable to capture the interface accurately in the framework of the gsph and dfpm methods we apply the dynamic refinement strategy in the water entry of an elastomer the dynamic refinement in sph is usually carried on locally with the evolution of the physical field to implement dynamic refinement into the sph framework four main considerations must be dealt with first an appropriate criterion that efficiently identifies the candidate particles for refinement is highly necessary second the refinement formulation should preserve the basic properties of the entire system third the interaction between the coarse particles and fine particles should be consistent fourth better computational accuracy and efficiency are required based on the above considerations we provide a general dynamic refinement strategy including the criterion algorithm and the interaction between the coarse particles and fine particles 4 1 criterion for refinement generally the candidate particle for refinement is identified depending on the type of the simulation case for the water entry problem f r s f and f r f s reflecting the interaction between water and structure play a dominant role we select the nonzero interaction force as the criterion as shown in eq 35 when f r s f 0 or f r f s 0 the particle is translated into a candidate particle for refinement this criterion can separate the particles located at the vicinity of the interface application of this criterion will describe the fluid solid interaction with high accuracy 35 f r s f 0 or f r f s 0 4 2 refinement algorithm we denote the candidate refinement coarse particle as a and its mass position velocity and smoothing length are defined as m a x a v a and h a respectively the daughter fine particle of a is denoted as a and its mass position velocity and smoothing length are defined as m a x a v a and h a respectively particle refinement must meet the system conservation criteria such as quality angular momentum linear momentum kinetic energy and potential energy conservation a splitting form satisfying the above properties is given as follows 1 after splitting the mass is evenly distributed among the fine particles 2 the velocity remains unchanged 3 the positions of the daughter particles are symmetrical about the position of the coarse particle generally m a x a v a and h a are determined by 36 m a 1 m m a v a v a h a Œ± h a d a Œµ d a where m is the number of fine particles generated from a single coarse particle Œµ is a separation parameter that determines the distance between the daughter particles and Œ± is a radius ratio parameter that defines the smoothing length of the daughter particles in this paper a square split form is employed as shown in fig 16 where d a is the initial particle spacing of the coarse particle a coarse particle is split into four daughter particles m 4 according to eq 36 a square field constituted by four daughter particles is a constant velocity field although this form maintains the momentum and energy conservation its accuracy is insufficient chiron et al 2018 therefore the velocity field is changed into a linear field using eqs 37 and 38 37 v a v a v a x a x a 38 v a j m j œÅ j v a v j w a j 4 3 interaction between the coarse particle and fine particle it is apparent that the smoothing lengths of the fine particle and the coarse particle are different in the mutual searching region it is possible to violate newton s third law so that the smoothing length must be taken as the average of h a and h a h a h a 2 this average implementation of the different smoothing lengths conserves the interactions between the coarse and fine particles 4 4 a dynamic refinement strategy for water entry of an elastomer to ensure that the repulsive force between water and structure is smooth and stable a square split form is used and the daughter particles are space with an equal spacing Œµ 0 5 2 according to the description of the implementation of the dynamic refinement strategy in section 4 1 4 3 when water and structure particles enter into each other s supported domains the particles are split respectively the split form of the elastomer particle is slightly different from that of a rigid particle as shown in fig 17 the split degree Œ± 0 for a rigid particle i is constant while for the elastomer particle the split degree Œ± i must be updated at each time step because of the deformation of the elastomer the split degree Œ± i must guarantee that the connection between two fine daughter particles is always vertical to the normal direction n ÀÜ of the coarse particle i located at the elastomer based on the maximal value of the beam deflection Œ± i and Œ± 0 may differ by approximately 10 next we introduce the calculation of the normal direction n ÀÜ of the elastomer 4 4 1 calculation of the normal direction n ÀÜ of the elastomer the normal direction n ÀÜ of the elastomer must be confirmed at the beginning of each time step according to adami et al 2010 the normal direction n ÀÜ is calculated by defining an index number c i for the elastomer particle i c i is given by 39 c i 1 i œà 0 i œà where œà is the sph elastomer particle domain by calculating the gradient of c i the unit normal n ÀÜ is obtained as 40 n ÀÜ n n c i c i where c i is calculated by 41 c i j m j œÅ j c j c i w i j j is the particle adjacent to the particle i eq 41 is suitable for calculating the normal direction n ÀÜ of the multiphase flow interface used in ref adami et al 2010 however in this work the elastomer at the slam stage has not fully contacted the water so eq 41 may not be accurate for the calculation of the normal direction n ÀÜ of the elastomer marked by black circles in fig 18 the normal direction n ÀÜ in the black circle domain should be accurately calculated because the particle in this domain is split and the split degree is directly related to n ÀÜ we propose eq 42 to calculate n ÀÜ where s is the elastomer particle adjacent to the particle i thus regardless of whether the elastomer contacts the water or not the normal direction of the elastomer can be obtained r w i s is the correction kernel gradient fig 19 shows the large deformation structure normal direction n ÀÜ calculated by eq 42 with the correction kernel gradient r w i s and the standard kernel gradient w i s the correction kernel gradient r w i s improves the accuracy of n ÀÜ at the boundary of the elastomer fig 20 shows the normal direction n ÀÜ of the elastic beam and it is observed that the obtained result is better than that shown in fig 18 42 c i s m s œÅ s c s r w i s 43 r w i s s m s œÅ s r s r i w i s 1 w i s 4 5 results and discussion 4 5 1 slamming force the slamming forces obtained by gd sph with no refinement by gd sph with the dynamic refinement and the theory scolan 2004 are shown in fig 21 compared to the no refinement results the slamming force curve obtained by the dynamic refinement changes a little later this may be due to the smaller smoothing length of the daughter particles the force for the dynamic refinement method is larger than that for the no refinement method because more particles are involved in the calculation of the repulsive force comparison of the dynamic refinement and theory results shows that the dynamic refinement results are closer to the theory additionally the slope of two curves prior to the maximal slamming force point are very close 4 5 2 deflection curve of the beam the results for the deflection at the middle of the beam in the gd sph simulation with dynamic refinement are presented in fig 22 comparison of figs 22 and 14 shows that the deflection curve obtained by the dynamic refinement method is in better agreement with the sph fem coupling and theory results the difference in the peak value between the dynamic refinement and theory results is only 5 demonstrating the effectiveness of the dynamic refinement method 4 5 3 stress distribution the x direction stress component of the beam and pressure of the water obtained by gd sph with dynamic refinement at 2 5 ms is shown in fig 23 the result in fig 23 is in good agreement with the result shown in fig 15 b the enlarged graph shows that the elastomer and water particles are split near the interface and the increased number of particles used in the dynamic refinement describe the stress of the elastomer and the pressure of the water as well as other physical variables such as velocity and density in more detail thus we could extract the physical variables and their gradients more accurately 4 5 4 computational efficiency to measure the efficiency of the dynamic refinement strategy we designed the total refinement model which is identical to the no refinement model with the initial particle spacing matching the daughter fine particles spacing of the dynamic refinement fig 24 shows the slamming force of the dynamic refinement and total refinement by gd sph and the results are same table 2 gives the computational time of gd sph simulations with no refinement dynamic refinement and total refinement indicating that with an equivalent computational accuracy the cost of the dynamic refinement approach is only 26 of the cost of the total refinement method 5 conclusions in this paper we propose the gd sph method to simulate the water entry of an elastomer gsph suppresses the pressure oscillation in the violent flow and the dfpm method can recover the interface accuracy comparison of the results of gd sph sph fem and theory shows that gd sph can effectively simulate the slamming force deflection and stress of the elastomer gd sph also can describe the a b and c d sections of the slamming force and the extremum of the deflection and stress changes of the elastomer clearly moreover the particle dynamic refinement strategy is proposed and applied to the entry of the elastomer into water a split form and its applicability for the elastic structure are also demonstrated particle dynamic refinement describes the physical variables in more detail and also increases the accuracy of the slamming force and deflection the dynamic refinement strategy also shows high efficiency with an accuracy equivalent to that of total refinement acknowledgments this paper is supported by the national natural science foundation of china grant no 11272266 the national natural science foundation for young scientists of china no 11702220 the aeronautical science foundation of china grant no 2016zd53038 and the fundamental research funds for the central universities grant no 3102017zy066 
22902,in the simulations of a water entry problem by sph smoothed particle hydrodynamics method there has not been much research on the interaction between the elastomer and fluid in sph because it is difficult to accurately handle the movable and deformable interface in this work we address this problem in the following three aspects to obtain a better simulation result 1 to weaken the pressure oscillations which would lead to numerical instability in violent flows the godunov sph method based on a riemann solver is used for the fluid 2 fpm finite particle method can improve the kernel estimation accuracy of the sph however the accuracy is decreased when fpm encounters discontinuous problems therefore dfpm discontinuous fpm is presented to preserve the estimation accuracy 3 generally a large number of particles are usually used to describe the interface precisely giving rise to high computational cost to decrease the cost the dynamic particle refinement strategy is applied to the water entry of an elastomer the slamming force stress and deformation of the elastomer and the pressure of the fluid are shown to demonstrate the advantages of the above three aspects for dealing with the water entry of an elastomer keywords elastomer godunov sph smoothed particle hydrodynamics dfpm discontinuous fpm dynamic refinement water entry 1 introduction with the use of various materials in aviation spaceflight and ships the elastic behavior of a structure when it slams into water has become increasingly important because of the nonlinearity factors and the complex coupling process an exact theoretical solution for the water entry of an elastomer does not exist as a fully lagrangian particle method sph smoothed particle hydrodynamics is advantageous for addressing the fsi fluid structure interaction problem because the highly nonlinear behavior of the moving interface can be implicitly captured even with a complex interface oger et al 2005 studied the wedge slamming into the water with a free surface by the fem sph coupling method campbell and vignjevic 2012 applied the fem sph coupling method to study the damage of the helicopter metal floor when it slammed into the water as well as the response of the life buoy in the wave in the same year panciroli et al 2012 still used fem sph coupling method to simulate the deformable wedge in all of these studies the deformable structures are represented by fem meshes and the fluid is scattered by sph particles nevertheless fem and sph methods are completely different numerical methods in the calculation it is necessary to use two solvers and provide the additional management to connect the two methods leading to a complicated computational process if both the fluid and the structure are represented by sph particles only one uniform solver can be used and is easy to implement the gpu hardware acceleration moreover the mesh dependency which is a defect of the fem in problems involving large strains also would be improved by sph method lin et al 2014 therefore in this paper the sph method was used to simulate both the deformable structure and the fluid in the explicit computation of hydrodynamic problems the weakly compressible sph wcsph method assumes that the fluid is weakly compressible with a small variation of the density monaghan 1994 when we simulate a violent free surface with breaking the pressure which is evaluated through the density exhibits spurious oscillations that may lead to numerical instability lee et al 2008 to suppress the pressure oscillations monaghan and gingold 1983 proposed an artificial viscosity term in the momentum equation however this term may lead to excessive dissipation that affects the physical flow characteristics colagrossi and landrini 2003 suggested the use of a moving least squares mls interpolation method to filter the density field and smooth the pressure this approach gives good results but is rather computationally expensive moussa 2006 developed an sph method based on solving a riemann problem to enhance numerical stability similar ideas using riemann solvers were also proposed in monaghan 1997 inutsuka 2002 parshikov and medin 2002 for the wcsph method zhang et al 2017 proposed a low dissipation riemann solver to simulate violent flows since the speed of the structure is high and the violent flows may appear we will apply a riemann solver zhang et al 2017 to the fluid flow to weaken the pressure oscillations sph has a disadvantage of the lower kernel estimation accuracy at the boundary where the supported domain of the particle is truncated to address this issue chen and beraun 2000 proposed a normalization corrected smooth particle method cspm and liu and liu 2006 proposed the finite particle method fpm and was applied into the fsi problem huang et al 2018 they recovered the estimation accuracy at the boundary based on the taylor series expansion compared to sph fpm is relaxed in the selection of the kernel function and at the boundary region fpm has a higher accuracy compared to cspm fpm can simultaneously estimate both the function and its derivative reducing the accumulation error caused by the low order derivative however the accuracy of the fpm method is greatly reduced when dealing with the discontinuous physical field wang et al 2018a to improve this disadvantage dfpm discontinuous fpm will be proposed for the discontinuous problem in this paper and we will apply it to the structure as a carrier to transmit the interaction the deformable interface between the fluid and elastomer must be captured precisely in each time step and a large number of particles need to be involved in capturing the interface particle dynamic refinement can adaptively improve the spatial resolution and reduce the computational cost to some extent wang et al 2018b and will be applied to describe the interface with the expansion of this application for sph various refinement criteria and forms have appeared monaghan and varnas 1988 martin et al 2005 feldman and bonet 2010 yan et al 2009 reyes et al 2013 in ref wang et al 2018b a two phase refinement criterion is proposed for fsi and its applicability just for the rigid structure was demonstrated in this paper we could use the two phase refinement criterion and propose the particle dynamic refinement strategy for the water entry of the elastomer the rest of the paper is organized as follows the second section introduces gd sph sph with gsph and dfpm methods formulas for the water entry of an elastomer the third section describes the numerical simulation model and results obtained for the entry of an elastomer into water in the fourth section the particle dynamic refinement strategy is presented and applied to the water entry problem a summary is given in the fifth section 2 gd sph formulas for water entry of an elastomer 2 1 standard sph formulas for water entry of an elastomer 2 1 1 standard sph formulas for water as generally assumed in the sph scheme water is considered to be weakly compressible in consideration of the computational complexity and the control equations for water in the lagrangian form are 1 a d œÅ d t œÅ d i v v b œÅ d v d t p f v f s f b c p c 0 f 2 œÅ œÅ 0 f d d r d t v where œÅ p r and v are the density pressure position and velocity of the water respectively œÅ 0f and c 0f are the density at the free surface and the reference sound speed in eq 1 c f v f s and f b are the viscous force surface tension and body force respectively surface tension f s could be neglected when the air is not involved and the surface tension does not dominate in the momentum equation in the sph methodology the derivative of f r at particle i f r i is obtained by following expressions monaghan 2012 2 f r i j 1 n m j œÅ j f r j f r i w i j 3 f r i œÅ i j 1 n m j f r i f r j œÅ i œÅ j w i j where œÅ i and r i are the density and position of the particle i respectively j runs over the particles within the supported domain of the water particle i with mass m j density œÅ j and position r j the values of f r at particle i and j are denoted by f r i and f r j the function w i j w r i j h with the notation r ij r i r j is the sph kernel function and h is the smoothing length considering momentum conservation we use eqs 2 and 3 to discrete eqs 1 a and 1 b respectively and the discrete control equations for a fluid particle f in the sph method are given by 4 a d œÅ f d t œÅ f j m j œÅ j v f v j w f j b d v f d t j m j p f p j œÅ f œÅ j œÄ f j w f j s f r f s m s f s w f s g c p f c 0 f 2 œÅ f œÅ 0 d d r f d t v f where œÅ f v f m f p f and r f are the density velocity mass pressure and position of the fluid particle f j runs over the particles within the supported domain of the water particle f s is the structure particle within the supported domain of the particle f g is gravity œÄ fj and œÄ fs proposed by monaghan and gingold 1983 are the artificial viscosity force between particle f and particles j and s respectively f r f s is the force per unit mass on the water particle f due to particle s monaghan and kajtar 2009 2 1 2 standard sph formulas for elastomer similarly the discrete control equations for the elastomer particle s are given by 5 a d œÅ s d t œÅ s j m j œÅ j v s v j w s j b d v s d t j m j œÉ s Œ± Œ≤ œÉ j Œ± Œ≤ œÅ s œÅ j s j w s j f f r s f m f s f w s f g c p s c 0 s 2 œÅ s œÅ 0 d d r s d t v s where œÅ s v s m s œÉ s Œ±Œ≤ c 0s and r s are the density velocity mass total stress tensor reference sound speed and position of the structure particle s j runs over the particles within the supported domain of the elastomer particle s f is the fluid particle within the supported domain of particle s œÄ sj and œÄ sf also are artificial viscosity terms and generally included in the momentum equation for stability monaghan and gingold 1983 f r s f is the force per unit mass on the structure particle s due to particle f and m s f r s f m f f r f s œÉ Œ±Œ≤ is the total stress tensor and roman letters Œ± Œ≤ are the Œ± th and Œ≤ th components œÉ Œ±Œ≤ contains deviatoric stress s Œ±Œ≤ and isotropic pressure p which are given by 7 6 œÉ Œ± Œ≤ s Œ± Œ≤ Œ¥ Œ± Œ≤ p Œ¥ Œ± Œ≤ 1 Œ± Œ≤ 0 Œ± Œ≤ an equation that determines the deviatoric stress s Œ±Œ≤ is necessary the deviatoric stress rate in jaumann rate form is given by 7 d s Œ± Œ≤ d t 2 Œº Œµ Œ± Œ≤ 1 3 Œ¥ Œ± Œ≤ Œµ Œ± Œ≤ s Œ± Œ≥ œâ Œ≤ Œ≥ œâ Œ± Œ≥ s Œ≥ Œ≤ where Œº is the shear modulus Œµ Œ± Œ≤ is the strain rate tensor and œâ Œ±Œ≤ is the rotation tensor Œµ Œ± Œ≤ and œâ Œ±Œ≤ are given by eqs 8 and 9 8 Œµ Œ± Œ≤ 1 2 v Œ± x Œ≤ v Œ≤ x Œ± 9 œâ Œ± Œ≤ 1 2 v Œ± x Œ≤ v Œ≤ x Œ± 2 1 3 the kernel function the kernel function we use is the cubic spline function for a space of two dimensions monaghan 1992 and is given by 10 w r h 15 7 œÄ h 2 2 3 r 2 1 2 r 3 0 r 1 1 6 2 r 3 1 r 2 0 r 2 where r r h for the kernel between two particle i and j the kernel uses the average smoothing length defined by 1 2 h i h j the initial value of h is 1 2 Œ¥ p where Œ¥ p is the initial particle spacing 2 1 4 the artificial viscosity the artificial viscosity term not only reflects the conversion of kinetic energy into heat but also eliminates numerical oscillations and provides the necessary dissipation in impact problems monaghan and gingold 1983 the most widely used artificial viscosity is included in the momentum equations eq 4 b and eq 5 b 11 œÄ i j Œ± œÄ c i j œï i j Œ≤ œÄ œï i j 2 œÅ i j v i j r i j 0 0 v i j r i j 0 œï i j h i j v i j r i j r i j 2 œÜ 2 v i j v i v j r i j r i r j œÜ 0 1 h c i j 1 2 c i c j œÅ i j 1 2 œÅ i œÅ j h i j 1 2 h i h j where c i j œÅ i j and h i j are the average sound speed the average density and the average smoothing length of particle i and j respectively Œ± œÄ and Œ≤ œÄ are constant values which are chosen appropriately for numerical stability Œ± œÄ 0 1 and Œ≤ œÄ 0 1 for water bui et al 2008 and Œ± œÄ 1 0 and Œ≤ œÄ 1 0 for elastomer monaghan and gingold 1983 herein are assigned 2 1 5 interaction between fluid and elastomer the interaction between the water and structure could be considered as the sph boundary treatment there are several approaches to implement the rigid boundary in sph such as virtual particle adami et al 2012 oger et al 2006 boundary integral kulasegaram et al 2004 repulsive force monaghan and kajtar 2009 etc however when the structure is an elastomer some approaches may become inapplicable or complicated due to the moving and deformable boundary herein the repulsive force will be used because there is no need to calculate the normal of the interface which makes the interaction easy to be implemented f r f s in eq 4 b is given by 12 f r f s 0 01 c 0 f 2 r f s r f s 2 w r f s 2 m s m f m s where r fs is the vector from particle s to particle f m s is the mass of particle s 2 1 6 time integration to solve the sph discrete equations the leapfrog lf time integration scheme bui et al 2008 is applied due to its low storage requirement and high efficiency the basic equations for a fluid particle f 13 t t Œ¥ t œÅ f t Œ¥ t 2 œÅ f t Œ¥ t 2 Œ¥ t d œÅ f d t v f t Œ¥ t 2 v f t Œ¥ t 2 Œ¥ t d v f d t r f t Œ¥ t r f t Œ¥ t v f t Œ¥ t 2 in order to keep the consistent at each subsequent time step the density and the velocity need to be predicted half a time step ahead to coincide the position the stability of the above lf integration scheme is governed by the courant friedrichs levy condition which limits a time step proportional to the smoothing length in this work the following condition is used to determine the size of time step 14 Œ¥ t c f l h i c 0 i where cfl is chosen to be 0 2 if the fluid and the elastomer have different time steps of Œ¥ t f and Œ¥ t s a smaller value is selected 15 Œ¥ t min Œ¥ t f Œ¥ t s 2 2 godunov sph for fluid godunov sph is a modification of sph with a riemann solver when the structure slams into the water violent and breaking flows will appear using the weakly compressible state equation eq 4 c the pressure oscillation may lead to numerical instability gsph is an effective method to dampen the oscillation without excessive dissipation zhang et al 2017 for eq 4 a the standard wcsph discretization of the continuity equation can be expressed by 16 d œÅ f d t œÅ f j m j œÅ j v f v j w r f r j 2 œÅ f j m j œÅ j v f v f j w r f r j where v f j v f v j 2 is the average velocity between particles f and j for eq 4 b the standard discretization of the momentum equation without taking account artificial viscosity can also be written as 17 d v f d t j m j p f p j œÅ f œÅ j w r f r j s f r f s g 2 j m j p f j œÅ f œÅ j w r f r j s f r f s g where p f j p f p j 2 is the average pressure between particles f and j as shown in fig 1 for the sph method based on riemann solvers monaghan 1997 an interparticle riemann problem is constructed along a unit vector e fj r fj r fj pointing from particle f to particle j in this riemann problem the initial left and right states are on particle f and j respectively and the discontinuity is at the middle point r f j r f r j 2 the l and r states are 18 œÅ l u l p l œÅ f v f e f j p f œÅ r u r p r œÅ j v j e f j p j a linearized riemann problem solver toro 2009 i e u and p for smooth flows can be expressed by 19 u u l œÅ l c l u r œÅ r c r p l p r œÅ l c l œÅ r c r p p r œÅ l c l p l œÅ r c r œÅ l c l œÅ r c r u l u r œÅ l c l œÅ r c r where c l c r c 0 c 0 is the sound speed of the fluid then u is transformed into vector v v u e f j v f j u e f j where u u l u r 2 is interparticle average with the solution of the riemann problem v f j and p f j are replaced by v p and the godunov sph discretization equations are obtained as 20 d œÅ f d t 2 œÅ f j m j œÅ j v f v w r f r j 21 d v f d t 2 j m j p œÅ f œÅ j w r f r j s f r f s g 2 3 dfpm for solid 2 3 1 dfpm basic equation in a solid boundary the supported domain of the particle is truncated the incomplete supported domain will lead to the unsatisfactory normalization of the kernel function fpm that enforces the normalized kernel and improves the accuracy of the boundary was proposed by liu and liu 2006 however the accuracy of the fpm method is not sufficient when solving the interface in the discontinuous problems therefore in this section the dfpm method is proposed to improve the accuracy of the fpm a discontinuous problem in one dimension is shown in fig 2 where d is the discontinuous point œâ 1 œâ 2 d œâ region is the supported domain of the particle x i and x k is the particle located in the œâ2 d b region sph is based on the continuous field and integration estimation should be implemented at œâ1 and œâ2 regions respectively liu et al 2003 the following equations are easily obtained 22 œâ f x w i x dx œâ 1 f x w i x dx œâ 2 f x w i x dx 23 œâ f x w i x x dx œâ 1 f x w i x x dx œâ 2 f x w i x x dx where w i x w x x i h w i x d w i d x then f x is expanded at point x i with region œâ1 and expanded at point x k with region œâ2 by a taylor series expansion the second order and above derivatives are ignored 24 œâ 1 f x w i x dx œâ 2 f x w i x dx œâ 1 f x i x x i f x i w i x dx œâ 2 f x k x x k f x k w i x dx f x i œâ 1 w i x dx f x k œâ 2 w i x dx f x i œâ 1 x x i w i x dx f x k œâ 2 x x k w i x dx 25 œâ 1 f x w i x x dx œâ 2 f x w i x x dx œâ 1 f x i x x i f x i w i x x dx œâ 2 f x k x x k f x k w i x x dx f x i œâ 1 w i x x dx f x k œâ 2 w i x x dx f x i œâ 1 x x i w i x x dx f x k œâ 2 x x k w i x x dx the above equations can be written in a matrix form 26 œâ 1 w i x dx œâ 1 x x i w i x dx œâ 1 w i x x dx œâ 1 x x i w i x x dx f x i f x i œâ f x w i x dx f x k œâ 2 w i x dx f x k œâ 2 x x k w i x dx œâ f x w i x x dx f x k œâ 2 w i x x dx f x k œâ 2 x x k w i x x dx as shown in fig 3 if we divide the œâ2 region into a number of smaller subdomains œâp i i 1 p p is the number of the subdomains and each subdomain only contains one particle x p xu et al 2013 then the above equation can be converted to 27 œâ 1 w i x dx œâ 1 x x i w i x dx œâ 1 w i x x dx œâ 1 x x i w i x x dx f x i f x i œâ f x w i x dx p f x p œâ p i w i x dx p f x p œâ p i x x p w i x dx œâ f x w i x x dx p f x p œâ p i w i x x dx p f x p œâ p i x x p w i x x dx with the constant field for each subdomains œâp i the derivative of f x p is zero then eq 27 is transformed into 28 œâ 1 w i x dx œâ 1 x x i w i x dx œâ 1 w i x x dx œâ 1 x x i w i x x dx f x i f x i œâ f x w i x dx p œâ p i f x p w i x dx œâ f x w i x x dx p œâ p i f x p w i x x dx 29 œâ 1 w i x dx œâ 1 x x i w i x dx œâ 1 w i x x dx œâ 1 x x i w i x x dx f x i f x i œâ f x w i x dx œâ 2 f x w i x dx œâ f x w i x x dx œâ 2 f x w i x dx œâ 1 f x w i x dx œâ 1 f x w i x x dx 30 œâ 1 w i x dx œâ 1 x x i w i x dx œâ 1 w i x x dx œâ 1 x x i w i x x dx f x i f x i œâ 1 f x w i x dx œâ 1 f x w i x x dx eq 30 is similar to that of the equation of the fpm liu and liu 2006 the difference is that in the fpm method integration is implemented over the entire region of the supported domain of the particle x i œâ while in eq 30 integration is implemented over the subdomain of the supported domain œâ1 eq 30 is the integral form of the dfpm method in one dimension similarly in the two dimensional case as shown in fig 4 the entire supported domain of the particle x i has subdomains œâ1 and œâ2 and the interface d œâ1 œâ2 d œâ the following equation can be obtained 31 œâ 1 w i x d x œâ 1 x x i w i x d x œâ 1 y y i w i x d x œâ 1 w i x x d x œâ 1 x x i w i x x d x œâ 1 y y i w i x x d x œâ 1 w i y x d x œâ 1 x x i w i y x d x œâ 1 y y i w i y x d x f x i f x x i f y x i œâ f x w i x d x f x k œâ 2 w i x d x f x x k œâ 2 x x k w i x d x f y x k œâ 2 y y k w i x d x œâ f x w i x x d x f x k œâ 2 w i x x d x f x x k œâ 2 x x k w i x x d x f y x k œâ 2 y y k w i x x d x œâ f x w i y x d x f x k œâ 2 w i y x d x f x x k œâ 2 x x k w i y x d x f y x k œâ 2 y y k w i y x d x where w i x w i x w i y w i y similar to the one dimensional case as shown in fig 5 œâ2 is divided into a number of smaller subdomains œâp i and each subdomain only contains one particle x p then eq 32 is obtained 32 œâ 1 w i x d x œâ 1 x x i w i x d x œâ 1 y y i w i x d x œâ 1 w i x x d x œâ 1 x x i w i x x d x œâ 1 y y i w i x x d x œâ 1 w i y x d x œâ 1 x x i w i y x d x œâ 1 y y i w i y x d x f x i f x x i f y x i œâ 1 f x w i x d x œâ 1 f x w i x x d x œâ 1 f x w i y x d x eq 32 is the integral form of the dfpm method in two dimensions and particle estimation of dfpm method is also given by eqs 33 and 34 only the particles that are located at œâ1 are considered in the formulas the function and its derivative are obtained simultaneously avoiding the accumulation error of the higher order derivative calculation 33 f x i f x i j œâ 1 m j œÅ j w i j j œâ 1 m j œÅ j x j x i w i j j œâ 1 m j œÅ j w i j x j œâ 1 m j œÅ j x j x i w i j x 1 j œâ 1 m j œÅ j f x j w i j j œâ 1 m j œÅ j f x j w i j x 34 f x i f x x i f y x i j œâ 1 m j œÅ j w i j j œâ 1 m j œÅ j w i j x j x i j œâ 1 m j œÅ j w i j y j y i j œâ 1 m j œÅ j w i j x j œâ 1 m j œÅ j w i j x x j x i j œâ 1 m j œÅ j w i j x y j y i j œâ 1 m j œÅ j w i j y j œâ 1 m j œÅ j w i j y x j x i j œâ 1 m j œÅ j w i j y y j y i 1 j œâ 1 m j œÅ j f x j w i j j œâ 1 m j œÅ j f x j w i j x j œâ 1 m j œÅ j f x j w i j y 2 3 2 estimate accuracy and convergence of dfpm 2 3 2 1 estimate accuracy of dfpm in this section discontinuous polynomials with different orders will be estimated to illustrate the approximation accuracy of dfpm figs 6 and 7 show the function error Œ∏ and its derivative error Œ∏ obtained by the estimation of dfpm for discontinuous constant linear and quadratic functions the functions are respectively x 2 x 0 5 5 x 0 5 x 2 x 0 x 0 5 5 x 0 5 x 1 x 2 x 2 2 0 x 0 5 5 x 2 5 0 5 x 1 the particle spacing Œ¥ p is 0 02 and the smoothing length h is 1 2 Œ¥ p from figs 6 and 7 it is observed that dfpm accurately estimates the discontinuous constant and linear functions however the discontinuous quadratic function was not reproduced accurately therefore dfpm is accurate to second order only this is because in the process of dfpm derivation the taylor series expansion is only retained to first order and the higher order terms are neglected if the taylor series is expanded to include the higher order terms dfpm with a higher order accuracy can be obtained reflecting the high order scalability of dfpm 2 3 2 2 convergence of dfpm as shown in 2 3 2 1 dfpm is not able to reproduce discontinuous quadratic functions accurately to verify that the accuracy of dfpm can be controlled when dealing with the high order problems in this section the convergence of dfpm is analyzed the discontinuous quadratic function in 2 3 2 1 is still considered and the cubic function x 2 x 3 2 0 x 0 5 5 x 3 5 0 5 x 1 is also estimated fig 8 shows the mean square error mse of the calculated error by dfpm for the discontinuous quadratic and cubic functions with different particle numbers for clarity the horizontal and vertical axis data are shown on the logarithmic scale it is observed that the mse decreases with increasing number of particles y for both the quadratic and cubic functions the slope is the same and is about 4 showing that the accuracy of dfpm is controllable and high accuracy can be obtained by increasing the number of particles 3 simulation of the water entry of an elastomer 3 1 numerical simulation model this section studies the water entry of an elastic aluminum beam at both ends with a constant speed the model of the beam is shown in fig 9 some elastic beam parameters are shown in table 1 both ends of the beam are constantly forced to move with a constant downward speed u both the beam and water are represented by sph particles the particle spacing Œ¥ p is 0 01 m the water density œÅ is 1000 kg m3 reynolds number r e œÅ v d Œº 100 in standard sph simulation the artificial viscosity is used for the numerical stability instead of the actual water viscosity Œº dynamic viscosity coefficient is approximatively Œº 0 125 Œ± œÄ c i j h i j œÅ i j monaghan and gingold 1983 v and d are the characteristic velocity of flow and the characteristic length respectively froude number f r v 2 g d 150 where g is the gravity acceleration when the elastomer velocity u 30 m s non negligible compressibility effects would be present fourey et al 2010 thus the real sound speed of water is performed in the simulation of fluid structure interaction the numerical model is based on the following assumptions 1 water is weakly compressible and the free surface is initially stationary 2 the surface tension the cavitation and the air cushion effect are ignored since the air is not considered in the model 3 2 results and discussion 3 2 1 gsph method to show the effect of the gsph method for water the pressure distributions of the water without and with gsph are compared in fig 10 as shown in fig 10 a with no gsph method applied the fluid shows an obvious pressure oscillation at the root of the elastic beam this is because 1 one of the inherent defects of the sph method is that the accuracy of the boundary is not sufficiently high chen and beraun 2000 liu and liu 2006 2 at the root of the elastic beam a higher velocity jet may appear the fluid is assumed to be a weakly compressible fluid and the pressure in the state eq 4 c is proportional to the square of the sound speed which is as high as 1480 m s therefore a small change in the density of the fluid will produce a large pressure change the pressure is very sensitive to the density change as shown in fig 1 in the gsph method an imaginary interface is present between particles f and j zhang et al 2017 and the approximate riemann solution is obtained as the intermediate quantity it has an obvious effect for the large gradient physics field toro 2009 as shown in fig 10 b the gsph method greatly decreases the pressure oscillation additionally the nonphysical phenomenon of negative pressure is absent it is concluded that the gsph method is an effective method for treating the high speed flow 3 2 2 dfpm method to demonstrate the advantages of the dfpm method the stress components in the x direction of the elastomer distributions without and with dfpm are compared in fig 11 it is observed that when dfpm method is not applied to the elastomer the stress distribution is messy while when the dfpm method is used the stress is well distributed the upper middle of the beam is in tension while compression effects are present in the bottom middle region of the beam fig 12 compares the stress components in the x direction of the middle of the beam point s fig 9 without and with dfpm when the dfpm method is not used the stress magnitude changes sharply and violent oscillation appears when the dfpm is used the stress curves are smooth the point s first bears compression stress and then tension stress finally stress maintains a certain range and presents a vibration state around the zero stress dotted line 3 2 3 comparison among gd sph fem sph fourey et al 2010 and theory scolan 2004 from section 3 2 1 and 3 2 2 it is concluded that gsph and dfpm indeed improve the quality of the modeling of the water entry of the elastomer next we will compare the results obtained using gd sph sph with gsph and dfpm methods fem sph fourey et al 2010 and theory scolan 2004 in the fem sph method water is represented by sph particles and the elastomer is simulated by fem 3 2 3 1 slamming force fig 13 shows the slamming force imposing on the elastomer as obtained by gd sph fem sph fourey et al 2010 and theory scolan 2004 compared to fem sph the trend of the slamming force obtained by gd sph is consistent with the results obtained by fem sph in the a b segment the slamming force remains constant because the tension and compression forces are imposed on the upper and lower surface of the beam alternately making the slamming force almost unchanged in the c d segment after the maximal deflection the beam starts to recover the deflection and the force remains balanced the peak value obtained in the gd sph simulation is slightly smaller than that obtained in the sph fem simulation the reason may be that there are different space resolutions in gd sph and fem sph in gd sph the initial particle spacing is 0 01m while in fem sph fourey et al 2010 the particle spacing of the fluid is smaller comparison of the slamming force among the gd sph fem sph fourey et al 2010 and theory scolan 2004 methods shows that in the a b segment the balanced force value obtained by gd sph is in better agreement with the theory values than that obtained by sph fem additionally the increasing rate of the slamming force by gd sph is more consistent with the theory than that of sph fem this demonstrates the effectiveness of the gd sph method if the elastomer is changed to a rigid body simulation strategy of the rigid body can be found in reference monaghan and kajtar 2009 the slamming force imposed on the rigid body is shown in dotted line as shown in fig 13 from the rigid body and the elastomer results the increasing rates of the slamming force are close however slamming force imposed on the rigid body is larger than that on the elastomer this may be due to the kinetic energy is partly transformed into the strain energy stored in the elastic body which mitigates the slamming force for the elastomer and the a b or c d segment is the feature of the slamming force imposed on the elastomer while the a b or c d segment state disappears for the rigid body because of the non deformation 3 2 3 2 deflection of the beam when the elastic beam slams into the water the external force from the water will deform the beam the deflection curves at the middle point of the beam fig 9 as functions of time are compared in fig 14 with the illustrations of the deformed beam at the maximal and minimal deformation values obtained by gd sph shown in the insets the deflection curve obtained by gd sph agrees with that of sph fem and theory while its maximal value is slightly smaller than those of the other methods with the difference of approximately 12 it is observed from the deflection curves that the middle of the beam first curves upward and then downward finally the beam presents a vibration state around the zero deflection dotted line which is consistent with the stress tendency shown in fig 12 3 2 3 3 stress distribution fig 15 shows the figures for the x direction stress components stress x of the beam and pressure p of the water obtained by gd sph and fem sph simulations at 0 5 2 5 and 4 5 ms a symmetric boundary condition is used in fem sph to decrease the computational cost on the other hand in the gd sph simulation the symmetry condition is not adopted in order to obtain an accurate comparison of the results since the sph simulation is implemented using gpus the computational time is acceptable generally the stress component in the x direction of the elastomer and the pressure of water obtained by gd sph are in good agreement with the results obtained using the fem sph coupling method it is observed from fig 15 that at 0 5 ms when the beam first enters the water the beam stress is larger at the root of the beam than other position at approximately 2 5 ms the beam comes into full contact with the water and the slamming force and the deflection of the beam almost reach their peak values the stress value is high and the beam is bent upward at 4 5 ms it is observed from the deflection curve fig 14 that the beam is bent down and reach its nadir the beam stress also reflects this phenomenon from fig 15 a 15 c showing the pressure of the water it is observed that the water in contact with the root of the beam has high pressure and the high pressure evolves with the beam entering the water with the deepening of water entry the high pressure moves to the latest splash position and the range of high pressure increases gradually with the continuous water entry the high pressure gradually disappears 4 dynamic refinement in sph due to the deformable structure the interface between the structure and water is also deformable and movable to capture the interface accurately in the framework of the gsph and dfpm methods we apply the dynamic refinement strategy in the water entry of an elastomer the dynamic refinement in sph is usually carried on locally with the evolution of the physical field to implement dynamic refinement into the sph framework four main considerations must be dealt with first an appropriate criterion that efficiently identifies the candidate particles for refinement is highly necessary second the refinement formulation should preserve the basic properties of the entire system third the interaction between the coarse particles and fine particles should be consistent fourth better computational accuracy and efficiency are required based on the above considerations we provide a general dynamic refinement strategy including the criterion algorithm and the interaction between the coarse particles and fine particles 4 1 criterion for refinement generally the candidate particle for refinement is identified depending on the type of the simulation case for the water entry problem f r s f and f r f s reflecting the interaction between water and structure play a dominant role we select the nonzero interaction force as the criterion as shown in eq 35 when f r s f 0 or f r f s 0 the particle is translated into a candidate particle for refinement this criterion can separate the particles located at the vicinity of the interface application of this criterion will describe the fluid solid interaction with high accuracy 35 f r s f 0 or f r f s 0 4 2 refinement algorithm we denote the candidate refinement coarse particle as a and its mass position velocity and smoothing length are defined as m a x a v a and h a respectively the daughter fine particle of a is denoted as a and its mass position velocity and smoothing length are defined as m a x a v a and h a respectively particle refinement must meet the system conservation criteria such as quality angular momentum linear momentum kinetic energy and potential energy conservation a splitting form satisfying the above properties is given as follows 1 after splitting the mass is evenly distributed among the fine particles 2 the velocity remains unchanged 3 the positions of the daughter particles are symmetrical about the position of the coarse particle generally m a x a v a and h a are determined by 36 m a 1 m m a v a v a h a Œ± h a d a Œµ d a where m is the number of fine particles generated from a single coarse particle Œµ is a separation parameter that determines the distance between the daughter particles and Œ± is a radius ratio parameter that defines the smoothing length of the daughter particles in this paper a square split form is employed as shown in fig 16 where d a is the initial particle spacing of the coarse particle a coarse particle is split into four daughter particles m 4 according to eq 36 a square field constituted by four daughter particles is a constant velocity field although this form maintains the momentum and energy conservation its accuracy is insufficient chiron et al 2018 therefore the velocity field is changed into a linear field using eqs 37 and 38 37 v a v a v a x a x a 38 v a j m j œÅ j v a v j w a j 4 3 interaction between the coarse particle and fine particle it is apparent that the smoothing lengths of the fine particle and the coarse particle are different in the mutual searching region it is possible to violate newton s third law so that the smoothing length must be taken as the average of h a and h a h a h a 2 this average implementation of the different smoothing lengths conserves the interactions between the coarse and fine particles 4 4 a dynamic refinement strategy for water entry of an elastomer to ensure that the repulsive force between water and structure is smooth and stable a square split form is used and the daughter particles are space with an equal spacing Œµ 0 5 2 according to the description of the implementation of the dynamic refinement strategy in section 4 1 4 3 when water and structure particles enter into each other s supported domains the particles are split respectively the split form of the elastomer particle is slightly different from that of a rigid particle as shown in fig 17 the split degree Œ± 0 for a rigid particle i is constant while for the elastomer particle the split degree Œ± i must be updated at each time step because of the deformation of the elastomer the split degree Œ± i must guarantee that the connection between two fine daughter particles is always vertical to the normal direction n ÀÜ of the coarse particle i located at the elastomer based on the maximal value of the beam deflection Œ± i and Œ± 0 may differ by approximately 10 next we introduce the calculation of the normal direction n ÀÜ of the elastomer 4 4 1 calculation of the normal direction n ÀÜ of the elastomer the normal direction n ÀÜ of the elastomer must be confirmed at the beginning of each time step according to adami et al 2010 the normal direction n ÀÜ is calculated by defining an index number c i for the elastomer particle i c i is given by 39 c i 1 i œà 0 i œà where œà is the sph elastomer particle domain by calculating the gradient of c i the unit normal n ÀÜ is obtained as 40 n ÀÜ n n c i c i where c i is calculated by 41 c i j m j œÅ j c j c i w i j j is the particle adjacent to the particle i eq 41 is suitable for calculating the normal direction n ÀÜ of the multiphase flow interface used in ref adami et al 2010 however in this work the elastomer at the slam stage has not fully contacted the water so eq 41 may not be accurate for the calculation of the normal direction n ÀÜ of the elastomer marked by black circles in fig 18 the normal direction n ÀÜ in the black circle domain should be accurately calculated because the particle in this domain is split and the split degree is directly related to n ÀÜ we propose eq 42 to calculate n ÀÜ where s is the elastomer particle adjacent to the particle i thus regardless of whether the elastomer contacts the water or not the normal direction of the elastomer can be obtained r w i s is the correction kernel gradient fig 19 shows the large deformation structure normal direction n ÀÜ calculated by eq 42 with the correction kernel gradient r w i s and the standard kernel gradient w i s the correction kernel gradient r w i s improves the accuracy of n ÀÜ at the boundary of the elastomer fig 20 shows the normal direction n ÀÜ of the elastic beam and it is observed that the obtained result is better than that shown in fig 18 42 c i s m s œÅ s c s r w i s 43 r w i s s m s œÅ s r s r i w i s 1 w i s 4 5 results and discussion 4 5 1 slamming force the slamming forces obtained by gd sph with no refinement by gd sph with the dynamic refinement and the theory scolan 2004 are shown in fig 21 compared to the no refinement results the slamming force curve obtained by the dynamic refinement changes a little later this may be due to the smaller smoothing length of the daughter particles the force for the dynamic refinement method is larger than that for the no refinement method because more particles are involved in the calculation of the repulsive force comparison of the dynamic refinement and theory results shows that the dynamic refinement results are closer to the theory additionally the slope of two curves prior to the maximal slamming force point are very close 4 5 2 deflection curve of the beam the results for the deflection at the middle of the beam in the gd sph simulation with dynamic refinement are presented in fig 22 comparison of figs 22 and 14 shows that the deflection curve obtained by the dynamic refinement method is in better agreement with the sph fem coupling and theory results the difference in the peak value between the dynamic refinement and theory results is only 5 demonstrating the effectiveness of the dynamic refinement method 4 5 3 stress distribution the x direction stress component of the beam and pressure of the water obtained by gd sph with dynamic refinement at 2 5 ms is shown in fig 23 the result in fig 23 is in good agreement with the result shown in fig 15 b the enlarged graph shows that the elastomer and water particles are split near the interface and the increased number of particles used in the dynamic refinement describe the stress of the elastomer and the pressure of the water as well as other physical variables such as velocity and density in more detail thus we could extract the physical variables and their gradients more accurately 4 5 4 computational efficiency to measure the efficiency of the dynamic refinement strategy we designed the total refinement model which is identical to the no refinement model with the initial particle spacing matching the daughter fine particles spacing of the dynamic refinement fig 24 shows the slamming force of the dynamic refinement and total refinement by gd sph and the results are same table 2 gives the computational time of gd sph simulations with no refinement dynamic refinement and total refinement indicating that with an equivalent computational accuracy the cost of the dynamic refinement approach is only 26 of the cost of the total refinement method 5 conclusions in this paper we propose the gd sph method to simulate the water entry of an elastomer gsph suppresses the pressure oscillation in the violent flow and the dfpm method can recover the interface accuracy comparison of the results of gd sph sph fem and theory shows that gd sph can effectively simulate the slamming force deflection and stress of the elastomer gd sph also can describe the a b and c d sections of the slamming force and the extremum of the deflection and stress changes of the elastomer clearly moreover the particle dynamic refinement strategy is proposed and applied to the entry of the elastomer into water a split form and its applicability for the elastic structure are also demonstrated particle dynamic refinement describes the physical variables in more detail and also increases the accuracy of the slamming force and deflection the dynamic refinement strategy also shows high efficiency with an accuracy equivalent to that of total refinement acknowledgments this paper is supported by the national natural science foundation of china grant no 11272266 the national natural science foundation for young scientists of china no 11702220 the aeronautical science foundation of china grant no 2016zd53038 and the fundamental research funds for the central universities grant no 3102017zy066 
22903,in the present study an reasonable numerical method based on the potential flow theory and boundary element method bem for solving time domain ship motion coupling with sloshing is proposed ship motion is solved based on the three dimensional 3d time domain potential flow theory with forward speed using the bem the 3d fully nonlinear time domain potential flow theory and bem are also adopted to simulate the nonlinear sloshing phenomenon and then numerically coupled with ship motion in a same time step a corresponding parallel numerical solver is also developed to investigate the coupling effects between 6 degrees of freedom dof ship motion and internal sloshing to validate the numerical solver and better understand these coupling effects numerical research on liquid level and forward speed effects is conducted the developed numerical solver is also validated from previous model experimental results computational and experimental results of ship motion response amplitude operators raos are in reasonable agreement for both 15000 gt and s175 models with liquid tank the natural frequency of sloshing varies with changes in liquid levels and coupling effects become more obvious when the natural frequency of sloshing is close to excited frequency of a ship our accurate numerical results on the liquid level effects of roll motions indicate that the numerical method proposed can solve the engineering problem related to liquefied natural gas lng and liquefied petroleum gas lpg ships traveling through ocean waves the numerical behavior of a coupling system with forward speed shows that a liquid tank can reduces the resonance frequency of roll motion and has a limited effect on pitch motion however as forward speeds increase such effects follow a gradually increasing trend keywords tank sloshing boundary element method time domain potential flow theory forward speed coupled roll and ptich motion 1 introduction when a ship equipped with partially loaded liquid tanks travels across the ocean sloshing phenomena are excited by multiple degrees of freedom dof motions of ship motion due to the features of surrounding environment e g ocean surface waves meanwhile sloshing flow induced hydrodynamic loads acting on a liquid tank wall can affect ship motions with the development of lng and lpg carriers interactions and coupling effects observed between ship motion and sloshing phenomena have been emphasized over the last decade ballard et al 2003 faltinsen and rognebakke 2000 violent sloshing can seriously damage a ship body particularly a partially loaded liquid tank hydrodynamic loads induced by large amplitude sloshing phenomena can also incur serious damages to a ship structure kim 2002 interactions and coupling effects observed between ship motion and sloshing are important factors to consider during the design and operation of liquid loaded ships many studies have been carried out on the coupling effects between ship motion and sloshing kim et al 2003 in general according to potential flow theory studies can be categorized into two groups those using the frequency domain method where sloshing flow behavior is under the linear assumption kim et al 2004 and those using the time domain method which can handle a certain level of nonlinear sloshing flow behavior lee and newman 2005 numerical models based on the bem can always be employed to analyze internal sloshing loads acting on ships in the frequency domain where experimental results are also presented for comparison to prove feasibility levels newman 2005 rognebakke and faltinsen 2003 hu et al 2016 the linearized ship motion equation has been proven efficient and its numerical implemention in the time domain can be performed based on frequency domain results using the impulse response function irf method the irf has been used as a traditional means to obtain time domain motion results without solving the time domain velocity potential directly by transferring hydrodynamic coefficients of the frequency domain into a retard function as the left side of the time domain motion equations frequency domain to time domain fttm with high efficiency and acceptable accuracy for engineering applications for instance irf is widely adopted in mainstream commercial software such as wamit aqwa and hydrostar however the tradiational irf method relies on a boundary value problem without considering forward speed in the frequency domain as well as the k r a m e r s k r o n i g relation of the so called velocity correction method thus the traditional irf can only be applied to ships traveling at relatively low speeds e g f r 0 15 with an increase in ship speed differences between velocity correction with irf method and the time domain method also increase especailly on the retard function regardless of how accurate the frequency domain results kim and shin kim and shin 2008 presented a frequency model with forward speed to investigates coupling lng system with forward speed in frequency domain but the numerical model they proposed works in frequency domain normally sloshing is a typical nonlinear hydrodynamic problem which is not able to be well considered by frequency domain model especially for the low filling level condition for example the free surface elevation is not small compare with sloshing wave length which means the sloshing waves are normally nonlinear waves which cannot be well dealt with by the linear assumption adopted in frequency domain model compare to traditional velocity correction and irf methods used in a large number of industrial applications the time domain method remains an important academical issue as related theories and their implementation are relatively complex the 3d time domain green function is a classic and useful tool used to solve time domain ship motion problems beck 1994 zhu et al 2008 but it has not received enough attention in relation to engineering applications due to its high frequency oscillations and shortcomings in regard to divergence calculations of flare form floating bodies currently owing to its flexibility the rankine panel bem has become widely used time domain analysis and simulation method because it more easily takes nonlinearity into consideration better estimates the retard function and is relatively convenient to code kim and kim 2008 chen 2011 tang et al 2014a according to current research the constant vaule distribution of source strength of the rankine source bem can be used to obtain ship motion raos with acceptable accuracy in the time domain with forward speed after comparisons to experimental results are made in addition to the potential flow theory based model the computational fluid dynamics cfd method can better reproduce complex sloshing behaviors many studies have adopted a combination of potential flow based linear ship motion equation and cfd solvers on sloshing to simulate coupling processes of ship motion and sloshing huang et al 2012 hunter pullan ibrahim jiang et al 2015 the sola scheme can also be used to simulate sloshing in liquid tanks for the analysis of a liquid loaded vessel kim 2011 kim et al 2007 lee et al 2007 furthermore an open source cfd platform openfoam has been adopted to investigate sloshing and coupling with linear vessel motions in the time domain li et al 2012 nonlinear ship motions and sloshing have also been examined using nonlinear ship motion simulation program with six degrees of freedom shixdof and with a cfd approach based on the smoothed particle hydrodynamics sph solver hara and watanabeb 2016 ardakani 2016 camasa and pita 2016 recently sloshing effects on added resistance problem have also been studied seo and kim 2017 transient green function based method for ship motions coupled with cfd solution for the interior sloshing was proposed and this 3d ship motion solvers can also account for nonlinearities as well as forward speed saripilli and sen 2018a saripilli and sen the above studies on coupling between ship and sloshing consider a number of different platforms and theories which are not straightforward to implement for example the combination of the fvm method and bem method involves applying completely different theoretical and numerical apporaches which will result in the numerical solver is relatively difficult to design and to code by using different coding language such as fortran which is usually adopted by bem while c is adopted by openfoam examining forward speeds is also difficult as the frequency domain to time domain fttm with forward speed involves accuratly calculating the hydrodynamic coefficient based on a frequency domain boundary value problem this boundary value problem involves forward speed in the 3d frequency domain which is always difficult in relation to ship hydrodynamics due to green function calculation issue cfd solvers perform well in sloshing simulation but they consume considerable computational resources especially when addressing problems involving real scale conditions of both the ship and sloshing furthermore cfd solvers are less efficient addressing varying liquid level and wave conditions during simulation comparatively the potential flow theory based numerical solver consumes less computational resources and is relatively easy to apply zhao et al 2014 therefore a uniform and easily implementable platform in time domain is necessary to apply to address engineering problems sloshing is a classic problem of hydrodynamics and many numerical methods such as finite element method fem finite difference method fdm boundary element method bem can be adopted to address sloshing numerically normally fully nonlinear time domain potential flow theory is adopted by using bem it is worth to mention here that so called fully nonlinear means present numerical model adopts fully nonlinear free surface conditions which directly deduced from lagrange cauchy integral and total differentiation of free surface deformation which already contains all possible nonlinear factors that is the so called fully nonlinear means in the potential flow region compare with n s equation due to the viscosity and vortex was omitted of course the nonlinear parts are not completely considered in potential flow region but it was the restriction of potential flow until now there has lots of sloshing research completed by potential flow theory since it still is a powerful tool to reveal the details of fluid motion of sloshing and reducing computational resource unlike fem and fdm the bem converts the 3d volume integral into a two dimensional 2d surface integral to simplify problems and less computing time normally artificial damping has been introduced into bem simulation to account for the viscous damping effects of sloshing in terms of sloshing effects on vessel motion responses potential flow based methods efficiently generate strong results zhao et al 2018 in the present study a numerical method of inner and outer flow fields is established by applying the time domain potential flow theory and bem the main objective and contribution of this study is development of a whole 3d direct time domain potential flow based parallel numerical solver which is able to manage the coupling interaction of sloshing and ship motions with relatively high forward speed in time domain with acceptable accuracy mathematical formulations are listed in section 2 in section 3 is the validation of adopteded and proposed numerical method based on the proposed numerical method the liquid level effect for coupling system are investigated and discussed in section 4 with 15000 gt ship model subsequently numerical simulations for s175 ship model with forward speed are carried out in different conditions e g head sea or beam sea conditions the final conclusion is in section 6 1 1 mathematical formulation in this paper time domain potential flow theory is used to address ship motion problems according to the existing results 3d time domain ship motion potential flow theory can be used to conduct coupling numerical analyses and is widely applied to the field of ship and ocean engineering hydrodynamics in this study ship motion equations coupled with sloshing are established in the time domain for the same time step a direct time domain method is used to obtain wave forces acting on a hull surface and the fully nonlinear time domain potential flow theory is adopted to simulate sloshing problems the 3d rankine source bem is adopted to numerically solve ship motion and sloshing problems 1 2 the 6 dof time domain ship and floating body motion equation as shown in fig 1 cartesian coordinate system o x y z is defined from origin o on the undisturbed free surface and with an o z axis pointing vertically upward o e x e y e z e is a fixed coordinate system and o b x b y b z b is so called moving coordinate system fixed with ship body with forward speed u motion equations of a ship with forward speed are described in second order ordinary differential equation ode form tang et al 2014b 1 m j k Œº j k x k t b j k x k t 0 t k j k t œÑ x k œÑ d œÑ c j k c j k x k t f j w a v e t where x k t x k t and x k t denote the displacement velocity and acceleration respectively of the k motion mode of a ship m j k is the total ship mass matrix c j k is the hydrostatic restoring force coefficient matrix Œº j k is the added mass and b j k and c j k are hydrodynamic coefficients generated from the forward speed of the ship k j k t is the so called retarded function which is determined by the geometry of the ship surface the time space and forward speed of the ship f j w a v e t is the wave exciting force acting on the hull surface including incident and diffracting waves all hydrodynamic coefficients of the motion equations are obtained from the time domain method 1 3 time domain potential flow theory as an example the governing equation and boundary conditions of the 3d time domain radiation potential problem can typically be written as follows dai and duan 2008 2 2 œÜ k x 2 2 œÜ k y 2 2 œÜ k z 2 0 œÜ k i n f l u i d d o m a i n f t u x 2 œÜ k g œÜ k z 0 œÜ k i n f r e e s u r f a c e s f œÜ k n x k t n k x k t m k œÜ k i n s h i p s u r f a c e s b œÜ k œÜ k n œÜ k 0 œÜ k i n f a r f i e l d s c œÜ k 0 œÜ k t 0 œÜ k a t t i m e 0 where œÜ k is k mode radiation velocity potential n is the normal partial derivation perpendicular to the ship hull surface x k t is k mode of 6 dof motion displacement vector of ship and n k is the k mode unit normal vector m k is the k mode normal derivation of the fluid velocity on the ship surface and is determined from the steady wave making resistance potential of the ship here values of m k are defined as follows 3 m 1 m 2 m 3 0 0 0 m 4 m 5 m 6 0 u n 3 u n 2 here the bem is applied to solve time domain initial value and boundary value problems and the 3d r a n k i n e source is used as the green function from the mixed distribution of sources and dipoles the form of the boundary integral equation is as follows 4 Œ± p œÜ k p t s b s f s c 1 r œÜ k q t n q d s q œÜ k q t n q 1 r d s q where r r 2 z Œ∂ 2 and r x Œæ y Œ∑ 2 within r and r x y z and Œæ Œ∑ Œ∂ are the coordinates of the field point p and the source point q respectively Œ± p is the spatial angle at the field point p and its expression is as follows 5 Œ± p 4 œÄ s b n q 1 r 1 r d s q where r r 2 z Œ∂ 2 is the mirror source by substituting Œ± p into eq 4 using eq 5 we have the following 6 4 œÄ œÜ k p t s b s f s c œÜ k q t n q 1 r d s q s b œÜ k q t n q 1 r 1 r d s q s b s f s c 1 r œÜ k q t n q d s q according to the irf method the k mode surface condition takes a convoluted form as follows 7 n k x k t x k t m k 0 t n k Œ¥ œÑ m k h œÑ x k t œÑ d œÑ the k mode surface condition of impulse response function irf of radiation velocity potential can be written as 8 n p œÜ k p t n k Œ¥ t m k h t where Œ¥ t is the dirac function and h t is the heaviside function from eq 8 the irf of radiation velocity potential can be decomposed into the instantaneous item œà 1 k p the impulsive item œà 2 k p and the memory item œá k p t as folllows 9 œÜ k p t œà 1 k p Œ¥ t œà 2 k p h t œá k p t by using the mixed distribution of sources and dipoles and numerical viscosity to manage far field boundary conditions satisfied boundary integral equations of instantaneous item œà 1 k p impulsive item œà 2 k p and the memorial item œá k p t are respectively as follows liu and guoping 1986 10 2 œÄ œà 1 k p s b œà 1 k q n q 1 r 1 r n k d s q s f 1 r n q œà 1 k q d s q 0 11 2 œÄ œà 2 k p s b œà 2 k q n q 1 r 1 r m k d s q s f 1 r n q œà 2 k q d s q 0 12 2 œÄ œá k p t s b œá k q t n q 1 r d s q s f œá k q t n q 1 r 1 r n q œá k q t d s q 0 we use the integral form of the free surface condition to update the free surface at each time step tang 2014 13 œá k q t t g œà 1 k z 2 u 0 t œá k q œÑ x d œÑ 0 t t œÑ u 2 2 œá k q œÑ x 2 g œá k q œÑ z d œÑ 0 the radiation force and moment can be obtained from eq 14 14 f j k t Œº j k x k t b j k x k t c j k x k t 0 t k j k t œÑ x k œÑ d œÑ within eq 14 we obtain the following 15 Œº j k œÅ s b œà 1 k q n j d s q 16 b j k œÅ s b œà 2 k q n j œà 1 k q m j d s q 17 c j k œÅ s b œà 2 k q m j d s q 18 k j k t œÅ s b t œá k q t n j œá k q t m j d s q where the hydrodynamic coefficient Œº j k depends on the geometry of ship surface and it is related to added mass the b j k and c j k not only depends on the geometry of ship surface but also on the forward speed the memorial coefficient k j k t is so called retarded function which is based on the geometry of the ship surface forward speed and time to obtain the diffraction velocity potential the approach is similar to that of the radiation problem rather than using the following boundary conditions 19 2 œÜ d x 2 2 œÜ d y 2 2 œÜ d z 2 0 œÜ d i n f l u i d d o m a i n f t u x 2 œÜ d g œÜ d z 0 œÜ d i n f r e e s u r f a c e s f œÜ d n œÜ i n œÜ d i n s h i p s u r f a c e s b œÜ d œÜ d n œÜ d 0 œÜ d i n f a r f i e l d s c œÜ d 0 œÜ d t 0 œÜ d a t t i m e 0 where œÜ d is diffraction wave velocity potential and œÜ i is the incident wave velocity potential takes the following form 20 œÜ i x y z t g Œ∂ i œâ e k z sin k x cos Œ≤ y sin Œ≤ œâ e t after solving initial and boundary value problems given in eq 19 diffraction wave forces and moments can be obtained by adding incident wave forces and moments f j w a v e t total forces acting on ship surfaces can be easily obtained for eq 10 to eq 12 the strength distribution of sources and dipoles is constant such that the matrix equations of eq 10 to eq 12 are easy to obtain and solve the strength distribution is already sufficient to obtain accurate hydrodynamical coefficients of time domain motion equations based on linear assumptions the numerical implemention for eq 13 based on tang et al is as follows tang 2014 21 œá k q n Œ¥ t t g œà 1 k z 2 u n 1 n 1 œá k q n Œ¥ t x Œ¥ t u œá k q n Œ¥ t x Œ¥ t n 1 n 1 n n u 2 2 œá k q n Œ¥ t x 2 g œá k q n Œ¥ t z Œ¥ t 0 where n is the total number of time steps to time t as the œá k x of source point p can be obtained from interpolation of œá k on surrounding points of p the discrete free surface s f can be divided into m panel meshes eq 21 can directly be established on each panel mesh generating m martix equations with m unknown quantity œá k and it is easy to solve furthermore during our numerical simulation damping layer technologies were adopted to calm reflection waves generated from the ship according to kring 1994 the damping coefficient was obtained as follow 22 d œÖ 2 œÖ Œ∂ d œÖ 2 g œÜ where 23 œÖ œÖ 0 x x 0 2 x r x 0 3 x x r œÖ œÖ 0 y y 0 2 y r y 0 3 y y r where x 0 y 0 x r y r are starting position coordinates of damping layer and free surface boundary coordinates respectively œÖ 0 is empirically setted between 3 and 10 1 4 sloshing problem based on the fully nonlinear time domain potential flow theory to facilitate our coupling simulation of ship motion the sloshing problem is solved within a tank fixed coordinate as shown in fig 2 the tank fixed coordinate system o 1 x 1 y 1 z 1 is positioned at the center of the still free surface and is positioned parallel to the ship fixed coordinate system o x y z here we define v u v w are translational velocities of the tank corresponding to the ship six 6 dof motions a boundary value problem of the velocity potential of the tank fixed coordinate system can be derived we assume that fluid within the liquid tank is incompressible in viscid and irrational and so the velocity potential also satisfies the laplace equation 24 2 œï x 2 2 œï y 2 2 œï z 2 0 on the wall surface of the liquid tank s b fluid should satisfy the impermeable boundary condition as follows 25 œï n v n œâ r n where we define œâ œâ x œâ y œâ z are rotational velocities of the tank that corresponding to the ship 6 dof motions n is the unit normal vector perpendicular to the tank walls r is the distance between rotation center and the wall under the tank fixed coordinate system the dynamical free surface boundary condition and kinematical free surface boundary condition can be respectively written as follows in s f 26 œï t 1 2 œï 2 g Œ∂ v œâ r œï 0 27 Œ∂ t Œ∂ x œï x Œ∂ y œï y œï z v œâ r Œ∂ x Œ∂ y 1 0 where Œ∂ is wave elevation defined for the tank fixed coordinate system g is the gravity acceleration the velocity potential on each field point p in the flow field can be expressed as follows 28 œï p 1 4 œÄ s œï q n g p q g p q n œï q d s where the g p q is the 3d r a n k i n e source 29 g p q 1 r 1 x Œæ 2 y Œ∑ 2 z Œ∂ 2 where r is the distance between source point q and field point p and s is the boundary of the flow domain including the rigid wall of the liquid tank and free surface on the free surface the velocity potential and wave elevation of field points are obtained by applying the time stepping technique eq 24 to eq 29 are the basic mathematical equations of the time domain sloshing problem based on the 3d fully nonlinear time domain potential flow theory after obtaining the velocity potential the hydrodynamic pressure of the tank wall can be obtained by means of the b e r n o u l l i equation 30 p œÅ œï t 1 2 œï 2 g Œ∂ v œâ r œï 0 by transferring hydrodynamic pressure p to gravity center of the ship the sloshing induced force and moment can be easily obtained in this paper the linear distribution is applied to the strength of the source and dipole after discretization eq 28 can be expressed as follows 31 œï p 1 4 œÄ i 1 n s i œï n 1 r d s 1 4 œÄ i 1 n s i n 1 r œï d s where n is the total panel mesh value we adopt a triangular surface element and seven nodes of the gaussian integral in our boundary element numerical calculations the coordinates of the gauss points and corresponding weight functions are given in he s paper he et al 2010 a schematic of the triangular panel mesh used is shown in fig 3 on each panel mesh the surface integral can be expressed as follows 32 œï p 1 4 œÄ i 1 n k 1 7 œâ k œï i k Œæ 1 k Œæ 2 k Œæ 3 k n 1 r Œæ 1 k Œæ 2 k Œæ 3 k 1 4 œÄ i 1 n k 1 7 œâ k n 1 r Œæ 1 k Œæ 2 k Œæ 3 k œï i k Œæ 1 k Œæ 2 k Œæ 3 k where œâ k is the weight function of the gauss point Œæ 1 k Œæ 2 k Œæ 3 k in this research the central difference was adopted to handle the time difference items œï t and Œ∂ t by free surface conditions as follows 33 œï t Œ¥ t œï t Œ¥ t 2 Œ¥ t œï t t Œ∂ t Œ¥ t Œ∂ t Œ¥ t 2 Œ¥ t Œ∂ t t for stable time step simulation a b spline smoothing scheme is applied in both longitudinal and transverse directions of the free surface of the liquid tank during the simulation to prevent saw tooth instability and to keep volume conservation the smoothing scheme is used at every three time steps 1 5 numerical method of tank sloshing coupling for ship motion with forward speed once the hydrodynamic pressure of sloshing has been obtained and transferred to the gravity center of the ship at current time step t based on eq 30 the time domain global ship 6 dof motion coupled with sloshing effects can be expressed as follows 34 m j k Œº j k x k t b j k x k t 0 t k j k t œÑ x k œÑ d œÑ b 1 x 4 b 2 x 4 2 x 4 2 c j k c j k x k t f j w a v e t f j s l o s h t where b 1 and b 2 are viscous coefficients determined from the rolling decay curve which can be obtained through model experiments cfd simulations or the least square method sheng and liu 2003 a flow chart of the coupling process is shown in fig 4 fig 4 show that when sloshing is address at the current time step sloshing induced forces and moments can be obtained by integrating hydrodynamic pressure acting on all tank walls then sloshing induced forces and moments must be added with other external wave forces and moments such as wave or mooring line induced forces and moments along each motion mode finally total exciting forces and moments acting on the ship are obtained which are expressed on the right side of eq 34 for the left side of eq 34 Œº j k b j k and c j k can be directly obtained by eq 15 to eq 17 by œà 1 k and œà 2 k so that they are not affected by sloshing however k j k t must be obtained at each time step notably during time domain analysis the retarded function is central to the solving procedure and must be accurately determined and used in motion equations to solve for time domain motion f j w a v e t was obtained from œÜ i and œÜ d with encounter frequency œâ e the forward speed is not only contained in items determined by œÜ i œÜ k and œÜ d but also in the sloshing potential œÜ creating f j s l o s h t once global ship motion is determined it must transferred to a sloshing simulation as the boundary conditions of the next time step in turn the time domain numerical solver of the coupling system was established developed and implemented using fortran and openmp in this study 2 numerical verfication to verify the accuracy of the numerical method proposed in this work three sets of experimental results including faltinsens sloshing experimental results the results of sloshing model experiments carried out at the china ship scientific research center cssrc and the results of a s175 model experiment carried out at the cssrc are examined as a benchmark case in this section to verify the sloshing scheme time domain method and coupling scheme 2 1 numerical verfication of the sloshing solver first numerical predictions of the free surface elevation of sloshing occurring under forced translational excitation are validated by means of faltinsens model experiments faltinsen 1978 within faltinsen s model experiment a tank of l 1 0 m b 1 0 m and d 1 0 m was used the liquid level was set to 0 5 m the tank was translationally excited in sine form as x 0 002 s i n 5 29 t for sloshing cases with forced excitation mesh settings m 1 and m 2 were adopted to conduct convergence analyses to guarantee mesh size and time step convergence within m 1 mesh quantities with tank length width and water depth were set as 10 10 5 m 2 was set with corresponding dimensions of 20 20 10 the time step was set as Œ¥ t 0 01 s fig 5 presents a comparison of wave elevation levels observed between the faltinsen s experimental results and numerical results for both mesh settings it can be observed that both sets of simulated wave elevation results are in good agreement with the experimental results fig 5 also shows that both m 1 and m 2 with Œ¥ t 0 01 s provide convergent results compare to m 1 m 2 offers better results that more closely reflect the experimental results second the results of a sloshing experiment carried out at cssrc are used to verify the simulated hydrodynamic pressure level in the cssrc s model experiment a tank with dimensions of l 1 2 m b 1 2 m and d 0 6 m the liquid level was set to 0 36 m harmonic roll motion x 0 015 s i n 2 475 t was applied to the tank wall during the simulation as a boundary condition for this case mesh settings for tank length width and water depth were set as 20 20 10 the time step was set as Œ¥ t 0 05 s a pressure probe was positioned on the sidewall at a height of 0 36 m fig 6 shows that simulated pressure results are in acceptable agreement with the experimental results the pressure time history is not continuous in time which was due to the presence of dry wall for this case the reason for numerical pressures appear to overestimate the experimental values is that the motion of this model experiment is relatively violent and the free surface was break during the experiment sometime the irregular pressure variation obtained by pressure probe was caused by splashes of water but the potential flow theory cannot handle such extreme nonlinear phenomena and the free surface variation was relatively smooth which caused such differences between numerical and experimental results in general by verifying the numerical results of the two experiments we find that the proposed numerical scheme generates satisfying results regardless of the wave elevation or hydrodynamic pressure levels thus this means that the numerical scheme is accurate enough to address further coupling problems 2 2 numerical verfication of the time domain solver in this section the adopted time domain method is used to verify ship motion responses with forward speed s175 model experimental results with f r 0 275 for ittc 1978 are adopted as a benchmark case the accuracy of the developed time domain numerical solver in terms of the forward speed of time domain ship motion must be guaranteed to further explore the coupling system with forward speed in the numerical simulation cases involving beam and head sea conditions are examined fig 7 shows that both the numerical and experimental results for pitch heave and roll motion are in good agreement with f r 0 275 across both head and beam sea conditions 2 3 numerical verfication of the coupling solver in this section the proposed coupling scheme is used to verify the coupling effect based on the adopted s175 model experiment the s175 model experiment was conducted within the wave basin of the cssrc images of the s175 ship model and liquid tank are shown in fig 8 and fig 9 respectively which from the experimental scene zou 2009 parameters of liquid tank are shown in fig 10 a s175 ship model with a rectangular liquid tank was used in the experiment and the scale ratio was set to see table 1 1 55 for the experiment the length breadth and height of the liquid tank are set as 0 6 m 0 3 m 0 25 m respectively the liquid level is set as 0 125 m the liquid tank is positioned between section 9 and section 13 of the ship model the gravity center of the liquid tank coincides with the gravity center of the s175 ship model fig 11 shows the roll decay curve obtained from the experiment which can be used to determine viscous coefficients b 1 and b 2 sheng and liu 2003 the model experiment was carried out under zero speed conditions thus our corresponding numerical calculations of the coupled motion of the s175 ship model with sloshing were carried out under beam sea and head sea conditions without forward speed fig 12 shows the time histories of roll motion observed at low and high incident frequency levels the incident wave amplitude of both cases is equal to 0 1 m time periods of 1 13 s and 3 58 s are respectively employed corresponded dimensionless frequency is 3 1620 and 0 9998 respectively the case for period 3 58 s reflects the resonance frequency of the roll motion of the s175 ship model and the case for period 1 13 s diverges from the resonance frequency value it can be observed that sloshing has limited effects on roll motion at a high incident frequency while the amplitude of roll motion clearly decreases with low incident frequency this is the case due to an order of magnitude and phase difference observed between sloshing and wave induced moments under the excitation of different incident waves with the high incident frequency the sloshing induced moment occurs smaller than the wave induced moment and so the effect of roll motion is limited the sloshing induced moment and wave induce moment occur in the same order of magnitude as the low incident frequency and a phase difference of close to 180 degree offset values such that the roll motion amplitude is clearly reduced fig 13 shows the time histories of pitch motion with low and high incident frequency levels for a 0 1 m incident wave amplitude as applied for the roll cases the wave periods of the two cases are 3 10 s and 0 98 s respectively and corresponding dimensionless frequency values are 1 1545 and 3 6509 respectively it can be observed that sloshing has a limited effect on pitch motion at high or low incident frequencies pitch and roll raos obtained from our numerical simulation and experimental results are shown in fig 14 for both with sloshing and with out sloshing case the numerical results agree well with experimental results as the bem cannot manage highly nonlinear phenomena such as those of wave breaking the proposed numerical method cannot simulate strong nonlinear phenomena very accurately nevertheless fig 14 shows that the proposed method is accurate enough to manage most realistic engineering problems 2 4 numerical investigations of liquid level effects on roll motion in this section the performance of the numerical coupling scheme proposed in this work is tested against experimental data to investigate liquid level effects of sloshing the ability of the proposed numerical scheme to address liquid level effects on ship roll motion is examined based on a 15000 gt model experiment the studied 15000 gt model experiment was also carried out in the wave basin at the cssrc a 15000 gt model with a rectangle liquid tank was used lines of the 15000 gt ship model and a schematic of the location of the liquid tank are shown in fig 15 and fig 16 respectively the scale ratio between the real ship and experimental model is 1 60 principal dimensions of the 15000 gt and liquid tank are listed in table 2 and table 3 respectively the corresponding bem panel mesh is shown in fig 17 roll rao results for the 15000 gt ship with different tank liquid levels for the beam sea condition obtained from the numerical method and experiment respectively are shown in fig 18 the comparison shows that the numerical model results agree well with the experimental results as tank water depths increase natural frequency levels also change gradually then the motion amplitude decreases this occurs because the sloshing induced moment increases with water depth due to the geometric shape of the tank the phase difference between the sloshing induced moment and the wave induced moment is relatively large therefore the total force moment value is small and vice versa furthermore the natural frequency of the liquid tank is related to the free surface scale when the excited frequency is similar to the resonance frequency of the liquid tank free surface variations become quite pronounced with time meanwhile the maximum wave elevation value including nonlinear factors will affect the resonance frequency of roll motion due to the shape of the liquid volume inside the tank will gradually change with variations in motion amplitude the gravity center of the liquid within the tank will also change because the shape of liquid generates variations changing of the positioning of the ship s stability center and thus affecting roll motion besides it is worth to mention that from fig 18 it can be observed roughly the peaks seem to shift towards higher frequencies as filling level goes up compared the uncoupled case however some of the recent research in this area have shown the opposite trend the frequency of the peak in roll rao with slosh coupling is lower that the corresponding frequency of the roll rao peak and this shift to the lower frequencies in higher as filling level decreases saripilli and sen saripilli and sen 2018b one possible reason is the ship type and the shape of the liquid tank for these two cases are different as mentioned above the natural frequency of the liquid tank is relating to the free surface scale and the water depth furthermore roll rao is determined by the superposition of wave induced and sloshing induced force moment so different resonance frequency may cause the situation that the essence is the same but the behaviors are different under the excitation of an incident wave of different wave lengths period the time history of the sloshing induced moment and wave induced moment is compared in fig 19 in fig 19 cases involving incident wavelengths of 15 m and 13 m generate results in the vicinity of roll resonance by contrast the phase difference between the sloshing induced moment and the wave induced moment is close to 180 whereas the amplitude of the sloshing moment is roughly 1 3 to 1 2 of the wave force amplitude such that the total moment magnitude is reduced by the superposition causing the amplitude of roll motion to decrease when the incident wavelength is equal to 10 m under the excitation of the incident wave the phase difference between the wave induced moment and sloshing induced moment is roughly 90 the amplitude of the total force moment acting on the ship is not changed significantly after superposition but the phase is offset when the incident wave is equal to 9 m and 8 m corresponding dimensionless frequencies are valued at 2 61 and 2 77 respectively approaching the peak frequency of the roll motion of the loaded liquid tank with a decrease in incident wavelength the phase difference between sloshing and wave induced moments also decreases the total amplitude measured after superposition is still of the same order relative to that observed before superposition but the amplitude of the total moment increases such that the rao of roll motion at the corresponding frequency also increases for an incident wave length of 5 m the sloshing induced moment value is very small compared to the wave induced moment value though the phase of the two is almost the same however the amplitude of the sloshing induced moment is only roughly 1 10 the value of the wave induced moment limiting roll motion effects it can be observed from our results that the peak frequency of roll motion varies with liquid levels at the same time from the time history of the sloshing induced moment and wave induced moment it can be observed that the roll moment generated by sloshing affects roll motion considerably the amplitude of the sloshing moment and its phase difference from the wave induced moment shapes global roll motion patterns 3 numerical investigations of forward speed effect in this section the proposed numerical method is used to investigate forward speed effects for a coupling system based on the s175 model experiments conducted on the liquid tank described in chapter 3 corresponding bem panel meshes of the s175 ship with a liquid tank are shown in fig 20 fig 21 presents numerical results for various pitch rao values for a s175 ship model with and without sloshing in head sea conditions it can be observed that as speeds increase sloshing has limited effects on pitch motion and especially within the low frequency range at which sloshing slightly increases the motion amplitude however it can also be observed from fig 21 that such effects slightly increases with increasing velocity in addition to this even though such phenomena are not obvious sloshing slightly changes pitch resonance frequencies fig 22 shows time histories of pitch motion for low middle and high incident frequency levels for a 0 1 m incident wave amplitude and at f r 0 3 the wave periods of three cases are set as 2 5203 s 1 9345 s and 1 3925 s and corresponding dimensionless frequencies are 1 3722 1 8501 and 2 5703 respectively it can be observed that sloshing has limited effects on pitch motion at high and low incident frequencies at low incident frequencies the phase difference between the sloshing induced moment and wave induced moment is very short and so after superposition the moment acting on the hull slightly increases the amplitude of pitch motion at a moderate incident frequency within the resonance frequency range of pitch motion of f r 0 3 the sloshing induced moment slightly increases however as the phase difference continue to change after superposition the total moment only increases slightly causing pitch motion to have a minor impact due to sloshing within the resonance frequency range at high incident frequencies the phase difference between the sloshing induced moment and wave induced moment is close to 180 causing the total moment and pitch amplitude to slightly decrease after superposition fig 23 presents numerical results for various roll raos of the s175 ship model with and without sloshing in beam sea conditions it can be observed that as speeds increase sloshing always has a similar effect on roll motion especially within the low frequency range at which sloshing increases the motion amplitude considerably in addition to this sloshing heavily alters the resonance frequency of the roll motion fig 24 shows the time histories of roll motion for low moderate and high incident frequencies for a 0 1 m incident wave amplitude and for f r 0 3 the wave periods of the three cases are set as 3 7319 s 2 1303 s and 1 3404 s corresponding dimensionless frequencies are 0 9590 1 6801 and 1 3925 respectively it can be observed that sloshing has a significant effect on roll motion especially at low and moderate incident frequencies at low incident frequencies the phase difference between the sloshing induced moment and wave induced moment is very small such that after superposition the total moment acting on the hull increases the amplitude of roll motion considerably at a moderate incident frequency due to a large phase difference after superposition the total moment decreased considerably and caused the roll motion to be heavily compromised due to sloshing at high incident frequencies the phase difference between sloshing and wave induced moments is very small causing the total moment and roll amplitude to increase slightly after superposition 4 conclusions in this work numerical simulations of areas within and outside of flow fields are established by applying the time domain potential flow theory and bem to investigate liquid level and forward speed effects the following conclusions are drawn the coupling method proposed in this work is suitable for simulating time domain coupling systems involving ship motion with sloshing as both inner and outer fluid domains were numerically applied based on potential flows and the bem approaches applied to examine tank liquid and ocean surface waves are similar and straightforward relative to previously developed coupling methods see the introduction for more information our numerical results clearly illustrate the influence by tank sloshing on ship motion and variations in resonance frequency sloshing flows play an important role in coupling effects and especially in roll motion the resonance frequency of roll motion is increased with water depthing the phase difference between the sloshing induced moment and wave induced moment is an important factor in determining the roll motion amplitude within the resonance frequency range of roll motion the proposed numerical method can provide satisfactory results based on potential flows though it presents some limitations when applied to examine large free surface variations at different forward speeds sloshing flows have minor effects on pitch motion but such effects tend to be enhanced at increasing forward speeds while sloshing flows reduce the resonance frequency of roll motion acknowledgments this work is financially supported by the national key r d program of china no 2016yfc0402601 national natural science foundation of china grant no 51609269 51679053 51209048 and the open foundation of the state key laboratory of hydrology water resources and hydraulic engineering grant no 2016491711 appendix a supplementary data the following is the supplementary data to this article multimedia component multimedia component appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j oceaneng 2019 02 063 
22903,in the present study an reasonable numerical method based on the potential flow theory and boundary element method bem for solving time domain ship motion coupling with sloshing is proposed ship motion is solved based on the three dimensional 3d time domain potential flow theory with forward speed using the bem the 3d fully nonlinear time domain potential flow theory and bem are also adopted to simulate the nonlinear sloshing phenomenon and then numerically coupled with ship motion in a same time step a corresponding parallel numerical solver is also developed to investigate the coupling effects between 6 degrees of freedom dof ship motion and internal sloshing to validate the numerical solver and better understand these coupling effects numerical research on liquid level and forward speed effects is conducted the developed numerical solver is also validated from previous model experimental results computational and experimental results of ship motion response amplitude operators raos are in reasonable agreement for both 15000 gt and s175 models with liquid tank the natural frequency of sloshing varies with changes in liquid levels and coupling effects become more obvious when the natural frequency of sloshing is close to excited frequency of a ship our accurate numerical results on the liquid level effects of roll motions indicate that the numerical method proposed can solve the engineering problem related to liquefied natural gas lng and liquefied petroleum gas lpg ships traveling through ocean waves the numerical behavior of a coupling system with forward speed shows that a liquid tank can reduces the resonance frequency of roll motion and has a limited effect on pitch motion however as forward speeds increase such effects follow a gradually increasing trend keywords tank sloshing boundary element method time domain potential flow theory forward speed coupled roll and ptich motion 1 introduction when a ship equipped with partially loaded liquid tanks travels across the ocean sloshing phenomena are excited by multiple degrees of freedom dof motions of ship motion due to the features of surrounding environment e g ocean surface waves meanwhile sloshing flow induced hydrodynamic loads acting on a liquid tank wall can affect ship motions with the development of lng and lpg carriers interactions and coupling effects observed between ship motion and sloshing phenomena have been emphasized over the last decade ballard et al 2003 faltinsen and rognebakke 2000 violent sloshing can seriously damage a ship body particularly a partially loaded liquid tank hydrodynamic loads induced by large amplitude sloshing phenomena can also incur serious damages to a ship structure kim 2002 interactions and coupling effects observed between ship motion and sloshing are important factors to consider during the design and operation of liquid loaded ships many studies have been carried out on the coupling effects between ship motion and sloshing kim et al 2003 in general according to potential flow theory studies can be categorized into two groups those using the frequency domain method where sloshing flow behavior is under the linear assumption kim et al 2004 and those using the time domain method which can handle a certain level of nonlinear sloshing flow behavior lee and newman 2005 numerical models based on the bem can always be employed to analyze internal sloshing loads acting on ships in the frequency domain where experimental results are also presented for comparison to prove feasibility levels newman 2005 rognebakke and faltinsen 2003 hu et al 2016 the linearized ship motion equation has been proven efficient and its numerical implemention in the time domain can be performed based on frequency domain results using the impulse response function irf method the irf has been used as a traditional means to obtain time domain motion results without solving the time domain velocity potential directly by transferring hydrodynamic coefficients of the frequency domain into a retard function as the left side of the time domain motion equations frequency domain to time domain fttm with high efficiency and acceptable accuracy for engineering applications for instance irf is widely adopted in mainstream commercial software such as wamit aqwa and hydrostar however the tradiational irf method relies on a boundary value problem without considering forward speed in the frequency domain as well as the k r a m e r s k r o n i g relation of the so called velocity correction method thus the traditional irf can only be applied to ships traveling at relatively low speeds e g f r 0 15 with an increase in ship speed differences between velocity correction with irf method and the time domain method also increase especailly on the retard function regardless of how accurate the frequency domain results kim and shin kim and shin 2008 presented a frequency model with forward speed to investigates coupling lng system with forward speed in frequency domain but the numerical model they proposed works in frequency domain normally sloshing is a typical nonlinear hydrodynamic problem which is not able to be well considered by frequency domain model especially for the low filling level condition for example the free surface elevation is not small compare with sloshing wave length which means the sloshing waves are normally nonlinear waves which cannot be well dealt with by the linear assumption adopted in frequency domain model compare to traditional velocity correction and irf methods used in a large number of industrial applications the time domain method remains an important academical issue as related theories and their implementation are relatively complex the 3d time domain green function is a classic and useful tool used to solve time domain ship motion problems beck 1994 zhu et al 2008 but it has not received enough attention in relation to engineering applications due to its high frequency oscillations and shortcomings in regard to divergence calculations of flare form floating bodies currently owing to its flexibility the rankine panel bem has become widely used time domain analysis and simulation method because it more easily takes nonlinearity into consideration better estimates the retard function and is relatively convenient to code kim and kim 2008 chen 2011 tang et al 2014a according to current research the constant vaule distribution of source strength of the rankine source bem can be used to obtain ship motion raos with acceptable accuracy in the time domain with forward speed after comparisons to experimental results are made in addition to the potential flow theory based model the computational fluid dynamics cfd method can better reproduce complex sloshing behaviors many studies have adopted a combination of potential flow based linear ship motion equation and cfd solvers on sloshing to simulate coupling processes of ship motion and sloshing huang et al 2012 hunter pullan ibrahim jiang et al 2015 the sola scheme can also be used to simulate sloshing in liquid tanks for the analysis of a liquid loaded vessel kim 2011 kim et al 2007 lee et al 2007 furthermore an open source cfd platform openfoam has been adopted to investigate sloshing and coupling with linear vessel motions in the time domain li et al 2012 nonlinear ship motions and sloshing have also been examined using nonlinear ship motion simulation program with six degrees of freedom shixdof and with a cfd approach based on the smoothed particle hydrodynamics sph solver hara and watanabeb 2016 ardakani 2016 camasa and pita 2016 recently sloshing effects on added resistance problem have also been studied seo and kim 2017 transient green function based method for ship motions coupled with cfd solution for the interior sloshing was proposed and this 3d ship motion solvers can also account for nonlinearities as well as forward speed saripilli and sen 2018a saripilli and sen the above studies on coupling between ship and sloshing consider a number of different platforms and theories which are not straightforward to implement for example the combination of the fvm method and bem method involves applying completely different theoretical and numerical apporaches which will result in the numerical solver is relatively difficult to design and to code by using different coding language such as fortran which is usually adopted by bem while c is adopted by openfoam examining forward speeds is also difficult as the frequency domain to time domain fttm with forward speed involves accuratly calculating the hydrodynamic coefficient based on a frequency domain boundary value problem this boundary value problem involves forward speed in the 3d frequency domain which is always difficult in relation to ship hydrodynamics due to green function calculation issue cfd solvers perform well in sloshing simulation but they consume considerable computational resources especially when addressing problems involving real scale conditions of both the ship and sloshing furthermore cfd solvers are less efficient addressing varying liquid level and wave conditions during simulation comparatively the potential flow theory based numerical solver consumes less computational resources and is relatively easy to apply zhao et al 2014 therefore a uniform and easily implementable platform in time domain is necessary to apply to address engineering problems sloshing is a classic problem of hydrodynamics and many numerical methods such as finite element method fem finite difference method fdm boundary element method bem can be adopted to address sloshing numerically normally fully nonlinear time domain potential flow theory is adopted by using bem it is worth to mention here that so called fully nonlinear means present numerical model adopts fully nonlinear free surface conditions which directly deduced from lagrange cauchy integral and total differentiation of free surface deformation which already contains all possible nonlinear factors that is the so called fully nonlinear means in the potential flow region compare with n s equation due to the viscosity and vortex was omitted of course the nonlinear parts are not completely considered in potential flow region but it was the restriction of potential flow until now there has lots of sloshing research completed by potential flow theory since it still is a powerful tool to reveal the details of fluid motion of sloshing and reducing computational resource unlike fem and fdm the bem converts the 3d volume integral into a two dimensional 2d surface integral to simplify problems and less computing time normally artificial damping has been introduced into bem simulation to account for the viscous damping effects of sloshing in terms of sloshing effects on vessel motion responses potential flow based methods efficiently generate strong results zhao et al 2018 in the present study a numerical method of inner and outer flow fields is established by applying the time domain potential flow theory and bem the main objective and contribution of this study is development of a whole 3d direct time domain potential flow based parallel numerical solver which is able to manage the coupling interaction of sloshing and ship motions with relatively high forward speed in time domain with acceptable accuracy mathematical formulations are listed in section 2 in section 3 is the validation of adopteded and proposed numerical method based on the proposed numerical method the liquid level effect for coupling system are investigated and discussed in section 4 with 15000 gt ship model subsequently numerical simulations for s175 ship model with forward speed are carried out in different conditions e g head sea or beam sea conditions the final conclusion is in section 6 1 1 mathematical formulation in this paper time domain potential flow theory is used to address ship motion problems according to the existing results 3d time domain ship motion potential flow theory can be used to conduct coupling numerical analyses and is widely applied to the field of ship and ocean engineering hydrodynamics in this study ship motion equations coupled with sloshing are established in the time domain for the same time step a direct time domain method is used to obtain wave forces acting on a hull surface and the fully nonlinear time domain potential flow theory is adopted to simulate sloshing problems the 3d rankine source bem is adopted to numerically solve ship motion and sloshing problems 1 2 the 6 dof time domain ship and floating body motion equation as shown in fig 1 cartesian coordinate system o x y z is defined from origin o on the undisturbed free surface and with an o z axis pointing vertically upward o e x e y e z e is a fixed coordinate system and o b x b y b z b is so called moving coordinate system fixed with ship body with forward speed u motion equations of a ship with forward speed are described in second order ordinary differential equation ode form tang et al 2014b 1 m j k Œº j k x k t b j k x k t 0 t k j k t œÑ x k œÑ d œÑ c j k c j k x k t f j w a v e t where x k t x k t and x k t denote the displacement velocity and acceleration respectively of the k motion mode of a ship m j k is the total ship mass matrix c j k is the hydrostatic restoring force coefficient matrix Œº j k is the added mass and b j k and c j k are hydrodynamic coefficients generated from the forward speed of the ship k j k t is the so called retarded function which is determined by the geometry of the ship surface the time space and forward speed of the ship f j w a v e t is the wave exciting force acting on the hull surface including incident and diffracting waves all hydrodynamic coefficients of the motion equations are obtained from the time domain method 1 3 time domain potential flow theory as an example the governing equation and boundary conditions of the 3d time domain radiation potential problem can typically be written as follows dai and duan 2008 2 2 œÜ k x 2 2 œÜ k y 2 2 œÜ k z 2 0 œÜ k i n f l u i d d o m a i n f t u x 2 œÜ k g œÜ k z 0 œÜ k i n f r e e s u r f a c e s f œÜ k n x k t n k x k t m k œÜ k i n s h i p s u r f a c e s b œÜ k œÜ k n œÜ k 0 œÜ k i n f a r f i e l d s c œÜ k 0 œÜ k t 0 œÜ k a t t i m e 0 where œÜ k is k mode radiation velocity potential n is the normal partial derivation perpendicular to the ship hull surface x k t is k mode of 6 dof motion displacement vector of ship and n k is the k mode unit normal vector m k is the k mode normal derivation of the fluid velocity on the ship surface and is determined from the steady wave making resistance potential of the ship here values of m k are defined as follows 3 m 1 m 2 m 3 0 0 0 m 4 m 5 m 6 0 u n 3 u n 2 here the bem is applied to solve time domain initial value and boundary value problems and the 3d r a n k i n e source is used as the green function from the mixed distribution of sources and dipoles the form of the boundary integral equation is as follows 4 Œ± p œÜ k p t s b s f s c 1 r œÜ k q t n q d s q œÜ k q t n q 1 r d s q where r r 2 z Œ∂ 2 and r x Œæ y Œ∑ 2 within r and r x y z and Œæ Œ∑ Œ∂ are the coordinates of the field point p and the source point q respectively Œ± p is the spatial angle at the field point p and its expression is as follows 5 Œ± p 4 œÄ s b n q 1 r 1 r d s q where r r 2 z Œ∂ 2 is the mirror source by substituting Œ± p into eq 4 using eq 5 we have the following 6 4 œÄ œÜ k p t s b s f s c œÜ k q t n q 1 r d s q s b œÜ k q t n q 1 r 1 r d s q s b s f s c 1 r œÜ k q t n q d s q according to the irf method the k mode surface condition takes a convoluted form as follows 7 n k x k t x k t m k 0 t n k Œ¥ œÑ m k h œÑ x k t œÑ d œÑ the k mode surface condition of impulse response function irf of radiation velocity potential can be written as 8 n p œÜ k p t n k Œ¥ t m k h t where Œ¥ t is the dirac function and h t is the heaviside function from eq 8 the irf of radiation velocity potential can be decomposed into the instantaneous item œà 1 k p the impulsive item œà 2 k p and the memory item œá k p t as folllows 9 œÜ k p t œà 1 k p Œ¥ t œà 2 k p h t œá k p t by using the mixed distribution of sources and dipoles and numerical viscosity to manage far field boundary conditions satisfied boundary integral equations of instantaneous item œà 1 k p impulsive item œà 2 k p and the memorial item œá k p t are respectively as follows liu and guoping 1986 10 2 œÄ œà 1 k p s b œà 1 k q n q 1 r 1 r n k d s q s f 1 r n q œà 1 k q d s q 0 11 2 œÄ œà 2 k p s b œà 2 k q n q 1 r 1 r m k d s q s f 1 r n q œà 2 k q d s q 0 12 2 œÄ œá k p t s b œá k q t n q 1 r d s q s f œá k q t n q 1 r 1 r n q œá k q t d s q 0 we use the integral form of the free surface condition to update the free surface at each time step tang 2014 13 œá k q t t g œà 1 k z 2 u 0 t œá k q œÑ x d œÑ 0 t t œÑ u 2 2 œá k q œÑ x 2 g œá k q œÑ z d œÑ 0 the radiation force and moment can be obtained from eq 14 14 f j k t Œº j k x k t b j k x k t c j k x k t 0 t k j k t œÑ x k œÑ d œÑ within eq 14 we obtain the following 15 Œº j k œÅ s b œà 1 k q n j d s q 16 b j k œÅ s b œà 2 k q n j œà 1 k q m j d s q 17 c j k œÅ s b œà 2 k q m j d s q 18 k j k t œÅ s b t œá k q t n j œá k q t m j d s q where the hydrodynamic coefficient Œº j k depends on the geometry of ship surface and it is related to added mass the b j k and c j k not only depends on the geometry of ship surface but also on the forward speed the memorial coefficient k j k t is so called retarded function which is based on the geometry of the ship surface forward speed and time to obtain the diffraction velocity potential the approach is similar to that of the radiation problem rather than using the following boundary conditions 19 2 œÜ d x 2 2 œÜ d y 2 2 œÜ d z 2 0 œÜ d i n f l u i d d o m a i n f t u x 2 œÜ d g œÜ d z 0 œÜ d i n f r e e s u r f a c e s f œÜ d n œÜ i n œÜ d i n s h i p s u r f a c e s b œÜ d œÜ d n œÜ d 0 œÜ d i n f a r f i e l d s c œÜ d 0 œÜ d t 0 œÜ d a t t i m e 0 where œÜ d is diffraction wave velocity potential and œÜ i is the incident wave velocity potential takes the following form 20 œÜ i x y z t g Œ∂ i œâ e k z sin k x cos Œ≤ y sin Œ≤ œâ e t after solving initial and boundary value problems given in eq 19 diffraction wave forces and moments can be obtained by adding incident wave forces and moments f j w a v e t total forces acting on ship surfaces can be easily obtained for eq 10 to eq 12 the strength distribution of sources and dipoles is constant such that the matrix equations of eq 10 to eq 12 are easy to obtain and solve the strength distribution is already sufficient to obtain accurate hydrodynamical coefficients of time domain motion equations based on linear assumptions the numerical implemention for eq 13 based on tang et al is as follows tang 2014 21 œá k q n Œ¥ t t g œà 1 k z 2 u n 1 n 1 œá k q n Œ¥ t x Œ¥ t u œá k q n Œ¥ t x Œ¥ t n 1 n 1 n n u 2 2 œá k q n Œ¥ t x 2 g œá k q n Œ¥ t z Œ¥ t 0 where n is the total number of time steps to time t as the œá k x of source point p can be obtained from interpolation of œá k on surrounding points of p the discrete free surface s f can be divided into m panel meshes eq 21 can directly be established on each panel mesh generating m martix equations with m unknown quantity œá k and it is easy to solve furthermore during our numerical simulation damping layer technologies were adopted to calm reflection waves generated from the ship according to kring 1994 the damping coefficient was obtained as follow 22 d œÖ 2 œÖ Œ∂ d œÖ 2 g œÜ where 23 œÖ œÖ 0 x x 0 2 x r x 0 3 x x r œÖ œÖ 0 y y 0 2 y r y 0 3 y y r where x 0 y 0 x r y r are starting position coordinates of damping layer and free surface boundary coordinates respectively œÖ 0 is empirically setted between 3 and 10 1 4 sloshing problem based on the fully nonlinear time domain potential flow theory to facilitate our coupling simulation of ship motion the sloshing problem is solved within a tank fixed coordinate as shown in fig 2 the tank fixed coordinate system o 1 x 1 y 1 z 1 is positioned at the center of the still free surface and is positioned parallel to the ship fixed coordinate system o x y z here we define v u v w are translational velocities of the tank corresponding to the ship six 6 dof motions a boundary value problem of the velocity potential of the tank fixed coordinate system can be derived we assume that fluid within the liquid tank is incompressible in viscid and irrational and so the velocity potential also satisfies the laplace equation 24 2 œï x 2 2 œï y 2 2 œï z 2 0 on the wall surface of the liquid tank s b fluid should satisfy the impermeable boundary condition as follows 25 œï n v n œâ r n where we define œâ œâ x œâ y œâ z are rotational velocities of the tank that corresponding to the ship 6 dof motions n is the unit normal vector perpendicular to the tank walls r is the distance between rotation center and the wall under the tank fixed coordinate system the dynamical free surface boundary condition and kinematical free surface boundary condition can be respectively written as follows in s f 26 œï t 1 2 œï 2 g Œ∂ v œâ r œï 0 27 Œ∂ t Œ∂ x œï x Œ∂ y œï y œï z v œâ r Œ∂ x Œ∂ y 1 0 where Œ∂ is wave elevation defined for the tank fixed coordinate system g is the gravity acceleration the velocity potential on each field point p in the flow field can be expressed as follows 28 œï p 1 4 œÄ s œï q n g p q g p q n œï q d s where the g p q is the 3d r a n k i n e source 29 g p q 1 r 1 x Œæ 2 y Œ∑ 2 z Œ∂ 2 where r is the distance between source point q and field point p and s is the boundary of the flow domain including the rigid wall of the liquid tank and free surface on the free surface the velocity potential and wave elevation of field points are obtained by applying the time stepping technique eq 24 to eq 29 are the basic mathematical equations of the time domain sloshing problem based on the 3d fully nonlinear time domain potential flow theory after obtaining the velocity potential the hydrodynamic pressure of the tank wall can be obtained by means of the b e r n o u l l i equation 30 p œÅ œï t 1 2 œï 2 g Œ∂ v œâ r œï 0 by transferring hydrodynamic pressure p to gravity center of the ship the sloshing induced force and moment can be easily obtained in this paper the linear distribution is applied to the strength of the source and dipole after discretization eq 28 can be expressed as follows 31 œï p 1 4 œÄ i 1 n s i œï n 1 r d s 1 4 œÄ i 1 n s i n 1 r œï d s where n is the total panel mesh value we adopt a triangular surface element and seven nodes of the gaussian integral in our boundary element numerical calculations the coordinates of the gauss points and corresponding weight functions are given in he s paper he et al 2010 a schematic of the triangular panel mesh used is shown in fig 3 on each panel mesh the surface integral can be expressed as follows 32 œï p 1 4 œÄ i 1 n k 1 7 œâ k œï i k Œæ 1 k Œæ 2 k Œæ 3 k n 1 r Œæ 1 k Œæ 2 k Œæ 3 k 1 4 œÄ i 1 n k 1 7 œâ k n 1 r Œæ 1 k Œæ 2 k Œæ 3 k œï i k Œæ 1 k Œæ 2 k Œæ 3 k where œâ k is the weight function of the gauss point Œæ 1 k Œæ 2 k Œæ 3 k in this research the central difference was adopted to handle the time difference items œï t and Œ∂ t by free surface conditions as follows 33 œï t Œ¥ t œï t Œ¥ t 2 Œ¥ t œï t t Œ∂ t Œ¥ t Œ∂ t Œ¥ t 2 Œ¥ t Œ∂ t t for stable time step simulation a b spline smoothing scheme is applied in both longitudinal and transverse directions of the free surface of the liquid tank during the simulation to prevent saw tooth instability and to keep volume conservation the smoothing scheme is used at every three time steps 1 5 numerical method of tank sloshing coupling for ship motion with forward speed once the hydrodynamic pressure of sloshing has been obtained and transferred to the gravity center of the ship at current time step t based on eq 30 the time domain global ship 6 dof motion coupled with sloshing effects can be expressed as follows 34 m j k Œº j k x k t b j k x k t 0 t k j k t œÑ x k œÑ d œÑ b 1 x 4 b 2 x 4 2 x 4 2 c j k c j k x k t f j w a v e t f j s l o s h t where b 1 and b 2 are viscous coefficients determined from the rolling decay curve which can be obtained through model experiments cfd simulations or the least square method sheng and liu 2003 a flow chart of the coupling process is shown in fig 4 fig 4 show that when sloshing is address at the current time step sloshing induced forces and moments can be obtained by integrating hydrodynamic pressure acting on all tank walls then sloshing induced forces and moments must be added with other external wave forces and moments such as wave or mooring line induced forces and moments along each motion mode finally total exciting forces and moments acting on the ship are obtained which are expressed on the right side of eq 34 for the left side of eq 34 Œº j k b j k and c j k can be directly obtained by eq 15 to eq 17 by œà 1 k and œà 2 k so that they are not affected by sloshing however k j k t must be obtained at each time step notably during time domain analysis the retarded function is central to the solving procedure and must be accurately determined and used in motion equations to solve for time domain motion f j w a v e t was obtained from œÜ i and œÜ d with encounter frequency œâ e the forward speed is not only contained in items determined by œÜ i œÜ k and œÜ d but also in the sloshing potential œÜ creating f j s l o s h t once global ship motion is determined it must transferred to a sloshing simulation as the boundary conditions of the next time step in turn the time domain numerical solver of the coupling system was established developed and implemented using fortran and openmp in this study 2 numerical verfication to verify the accuracy of the numerical method proposed in this work three sets of experimental results including faltinsens sloshing experimental results the results of sloshing model experiments carried out at the china ship scientific research center cssrc and the results of a s175 model experiment carried out at the cssrc are examined as a benchmark case in this section to verify the sloshing scheme time domain method and coupling scheme 2 1 numerical verfication of the sloshing solver first numerical predictions of the free surface elevation of sloshing occurring under forced translational excitation are validated by means of faltinsens model experiments faltinsen 1978 within faltinsen s model experiment a tank of l 1 0 m b 1 0 m and d 1 0 m was used the liquid level was set to 0 5 m the tank was translationally excited in sine form as x 0 002 s i n 5 29 t for sloshing cases with forced excitation mesh settings m 1 and m 2 were adopted to conduct convergence analyses to guarantee mesh size and time step convergence within m 1 mesh quantities with tank length width and water depth were set as 10 10 5 m 2 was set with corresponding dimensions of 20 20 10 the time step was set as Œ¥ t 0 01 s fig 5 presents a comparison of wave elevation levels observed between the faltinsen s experimental results and numerical results for both mesh settings it can be observed that both sets of simulated wave elevation results are in good agreement with the experimental results fig 5 also shows that both m 1 and m 2 with Œ¥ t 0 01 s provide convergent results compare to m 1 m 2 offers better results that more closely reflect the experimental results second the results of a sloshing experiment carried out at cssrc are used to verify the simulated hydrodynamic pressure level in the cssrc s model experiment a tank with dimensions of l 1 2 m b 1 2 m and d 0 6 m the liquid level was set to 0 36 m harmonic roll motion x 0 015 s i n 2 475 t was applied to the tank wall during the simulation as a boundary condition for this case mesh settings for tank length width and water depth were set as 20 20 10 the time step was set as Œ¥ t 0 05 s a pressure probe was positioned on the sidewall at a height of 0 36 m fig 6 shows that simulated pressure results are in acceptable agreement with the experimental results the pressure time history is not continuous in time which was due to the presence of dry wall for this case the reason for numerical pressures appear to overestimate the experimental values is that the motion of this model experiment is relatively violent and the free surface was break during the experiment sometime the irregular pressure variation obtained by pressure probe was caused by splashes of water but the potential flow theory cannot handle such extreme nonlinear phenomena and the free surface variation was relatively smooth which caused such differences between numerical and experimental results in general by verifying the numerical results of the two experiments we find that the proposed numerical scheme generates satisfying results regardless of the wave elevation or hydrodynamic pressure levels thus this means that the numerical scheme is accurate enough to address further coupling problems 2 2 numerical verfication of the time domain solver in this section the adopted time domain method is used to verify ship motion responses with forward speed s175 model experimental results with f r 0 275 for ittc 1978 are adopted as a benchmark case the accuracy of the developed time domain numerical solver in terms of the forward speed of time domain ship motion must be guaranteed to further explore the coupling system with forward speed in the numerical simulation cases involving beam and head sea conditions are examined fig 7 shows that both the numerical and experimental results for pitch heave and roll motion are in good agreement with f r 0 275 across both head and beam sea conditions 2 3 numerical verfication of the coupling solver in this section the proposed coupling scheme is used to verify the coupling effect based on the adopted s175 model experiment the s175 model experiment was conducted within the wave basin of the cssrc images of the s175 ship model and liquid tank are shown in fig 8 and fig 9 respectively which from the experimental scene zou 2009 parameters of liquid tank are shown in fig 10 a s175 ship model with a rectangular liquid tank was used in the experiment and the scale ratio was set to see table 1 1 55 for the experiment the length breadth and height of the liquid tank are set as 0 6 m 0 3 m 0 25 m respectively the liquid level is set as 0 125 m the liquid tank is positioned between section 9 and section 13 of the ship model the gravity center of the liquid tank coincides with the gravity center of the s175 ship model fig 11 shows the roll decay curve obtained from the experiment which can be used to determine viscous coefficients b 1 and b 2 sheng and liu 2003 the model experiment was carried out under zero speed conditions thus our corresponding numerical calculations of the coupled motion of the s175 ship model with sloshing were carried out under beam sea and head sea conditions without forward speed fig 12 shows the time histories of roll motion observed at low and high incident frequency levels the incident wave amplitude of both cases is equal to 0 1 m time periods of 1 13 s and 3 58 s are respectively employed corresponded dimensionless frequency is 3 1620 and 0 9998 respectively the case for period 3 58 s reflects the resonance frequency of the roll motion of the s175 ship model and the case for period 1 13 s diverges from the resonance frequency value it can be observed that sloshing has limited effects on roll motion at a high incident frequency while the amplitude of roll motion clearly decreases with low incident frequency this is the case due to an order of magnitude and phase difference observed between sloshing and wave induced moments under the excitation of different incident waves with the high incident frequency the sloshing induced moment occurs smaller than the wave induced moment and so the effect of roll motion is limited the sloshing induced moment and wave induce moment occur in the same order of magnitude as the low incident frequency and a phase difference of close to 180 degree offset values such that the roll motion amplitude is clearly reduced fig 13 shows the time histories of pitch motion with low and high incident frequency levels for a 0 1 m incident wave amplitude as applied for the roll cases the wave periods of the two cases are 3 10 s and 0 98 s respectively and corresponding dimensionless frequency values are 1 1545 and 3 6509 respectively it can be observed that sloshing has a limited effect on pitch motion at high or low incident frequencies pitch and roll raos obtained from our numerical simulation and experimental results are shown in fig 14 for both with sloshing and with out sloshing case the numerical results agree well with experimental results as the bem cannot manage highly nonlinear phenomena such as those of wave breaking the proposed numerical method cannot simulate strong nonlinear phenomena very accurately nevertheless fig 14 shows that the proposed method is accurate enough to manage most realistic engineering problems 2 4 numerical investigations of liquid level effects on roll motion in this section the performance of the numerical coupling scheme proposed in this work is tested against experimental data to investigate liquid level effects of sloshing the ability of the proposed numerical scheme to address liquid level effects on ship roll motion is examined based on a 15000 gt model experiment the studied 15000 gt model experiment was also carried out in the wave basin at the cssrc a 15000 gt model with a rectangle liquid tank was used lines of the 15000 gt ship model and a schematic of the location of the liquid tank are shown in fig 15 and fig 16 respectively the scale ratio between the real ship and experimental model is 1 60 principal dimensions of the 15000 gt and liquid tank are listed in table 2 and table 3 respectively the corresponding bem panel mesh is shown in fig 17 roll rao results for the 15000 gt ship with different tank liquid levels for the beam sea condition obtained from the numerical method and experiment respectively are shown in fig 18 the comparison shows that the numerical model results agree well with the experimental results as tank water depths increase natural frequency levels also change gradually then the motion amplitude decreases this occurs because the sloshing induced moment increases with water depth due to the geometric shape of the tank the phase difference between the sloshing induced moment and the wave induced moment is relatively large therefore the total force moment value is small and vice versa furthermore the natural frequency of the liquid tank is related to the free surface scale when the excited frequency is similar to the resonance frequency of the liquid tank free surface variations become quite pronounced with time meanwhile the maximum wave elevation value including nonlinear factors will affect the resonance frequency of roll motion due to the shape of the liquid volume inside the tank will gradually change with variations in motion amplitude the gravity center of the liquid within the tank will also change because the shape of liquid generates variations changing of the positioning of the ship s stability center and thus affecting roll motion besides it is worth to mention that from fig 18 it can be observed roughly the peaks seem to shift towards higher frequencies as filling level goes up compared the uncoupled case however some of the recent research in this area have shown the opposite trend the frequency of the peak in roll rao with slosh coupling is lower that the corresponding frequency of the roll rao peak and this shift to the lower frequencies in higher as filling level decreases saripilli and sen saripilli and sen 2018b one possible reason is the ship type and the shape of the liquid tank for these two cases are different as mentioned above the natural frequency of the liquid tank is relating to the free surface scale and the water depth furthermore roll rao is determined by the superposition of wave induced and sloshing induced force moment so different resonance frequency may cause the situation that the essence is the same but the behaviors are different under the excitation of an incident wave of different wave lengths period the time history of the sloshing induced moment and wave induced moment is compared in fig 19 in fig 19 cases involving incident wavelengths of 15 m and 13 m generate results in the vicinity of roll resonance by contrast the phase difference between the sloshing induced moment and the wave induced moment is close to 180 whereas the amplitude of the sloshing moment is roughly 1 3 to 1 2 of the wave force amplitude such that the total moment magnitude is reduced by the superposition causing the amplitude of roll motion to decrease when the incident wavelength is equal to 10 m under the excitation of the incident wave the phase difference between the wave induced moment and sloshing induced moment is roughly 90 the amplitude of the total force moment acting on the ship is not changed significantly after superposition but the phase is offset when the incident wave is equal to 9 m and 8 m corresponding dimensionless frequencies are valued at 2 61 and 2 77 respectively approaching the peak frequency of the roll motion of the loaded liquid tank with a decrease in incident wavelength the phase difference between sloshing and wave induced moments also decreases the total amplitude measured after superposition is still of the same order relative to that observed before superposition but the amplitude of the total moment increases such that the rao of roll motion at the corresponding frequency also increases for an incident wave length of 5 m the sloshing induced moment value is very small compared to the wave induced moment value though the phase of the two is almost the same however the amplitude of the sloshing induced moment is only roughly 1 10 the value of the wave induced moment limiting roll motion effects it can be observed from our results that the peak frequency of roll motion varies with liquid levels at the same time from the time history of the sloshing induced moment and wave induced moment it can be observed that the roll moment generated by sloshing affects roll motion considerably the amplitude of the sloshing moment and its phase difference from the wave induced moment shapes global roll motion patterns 3 numerical investigations of forward speed effect in this section the proposed numerical method is used to investigate forward speed effects for a coupling system based on the s175 model experiments conducted on the liquid tank described in chapter 3 corresponding bem panel meshes of the s175 ship with a liquid tank are shown in fig 20 fig 21 presents numerical results for various pitch rao values for a s175 ship model with and without sloshing in head sea conditions it can be observed that as speeds increase sloshing has limited effects on pitch motion and especially within the low frequency range at which sloshing slightly increases the motion amplitude however it can also be observed from fig 21 that such effects slightly increases with increasing velocity in addition to this even though such phenomena are not obvious sloshing slightly changes pitch resonance frequencies fig 22 shows time histories of pitch motion for low middle and high incident frequency levels for a 0 1 m incident wave amplitude and at f r 0 3 the wave periods of three cases are set as 2 5203 s 1 9345 s and 1 3925 s and corresponding dimensionless frequencies are 1 3722 1 8501 and 2 5703 respectively it can be observed that sloshing has limited effects on pitch motion at high and low incident frequencies at low incident frequencies the phase difference between the sloshing induced moment and wave induced moment is very short and so after superposition the moment acting on the hull slightly increases the amplitude of pitch motion at a moderate incident frequency within the resonance frequency range of pitch motion of f r 0 3 the sloshing induced moment slightly increases however as the phase difference continue to change after superposition the total moment only increases slightly causing pitch motion to have a minor impact due to sloshing within the resonance frequency range at high incident frequencies the phase difference between the sloshing induced moment and wave induced moment is close to 180 causing the total moment and pitch amplitude to slightly decrease after superposition fig 23 presents numerical results for various roll raos of the s175 ship model with and without sloshing in beam sea conditions it can be observed that as speeds increase sloshing always has a similar effect on roll motion especially within the low frequency range at which sloshing increases the motion amplitude considerably in addition to this sloshing heavily alters the resonance frequency of the roll motion fig 24 shows the time histories of roll motion for low moderate and high incident frequencies for a 0 1 m incident wave amplitude and for f r 0 3 the wave periods of the three cases are set as 3 7319 s 2 1303 s and 1 3404 s corresponding dimensionless frequencies are 0 9590 1 6801 and 1 3925 respectively it can be observed that sloshing has a significant effect on roll motion especially at low and moderate incident frequencies at low incident frequencies the phase difference between the sloshing induced moment and wave induced moment is very small such that after superposition the total moment acting on the hull increases the amplitude of roll motion considerably at a moderate incident frequency due to a large phase difference after superposition the total moment decreased considerably and caused the roll motion to be heavily compromised due to sloshing at high incident frequencies the phase difference between sloshing and wave induced moments is very small causing the total moment and roll amplitude to increase slightly after superposition 4 conclusions in this work numerical simulations of areas within and outside of flow fields are established by applying the time domain potential flow theory and bem to investigate liquid level and forward speed effects the following conclusions are drawn the coupling method proposed in this work is suitable for simulating time domain coupling systems involving ship motion with sloshing as both inner and outer fluid domains were numerically applied based on potential flows and the bem approaches applied to examine tank liquid and ocean surface waves are similar and straightforward relative to previously developed coupling methods see the introduction for more information our numerical results clearly illustrate the influence by tank sloshing on ship motion and variations in resonance frequency sloshing flows play an important role in coupling effects and especially in roll motion the resonance frequency of roll motion is increased with water depthing the phase difference between the sloshing induced moment and wave induced moment is an important factor in determining the roll motion amplitude within the resonance frequency range of roll motion the proposed numerical method can provide satisfactory results based on potential flows though it presents some limitations when applied to examine large free surface variations at different forward speeds sloshing flows have minor effects on pitch motion but such effects tend to be enhanced at increasing forward speeds while sloshing flows reduce the resonance frequency of roll motion acknowledgments this work is financially supported by the national key r d program of china no 2016yfc0402601 national natural science foundation of china grant no 51609269 51679053 51209048 and the open foundation of the state key laboratory of hydrology water resources and hydraulic engineering grant no 2016491711 appendix a supplementary data the following is the supplementary data to this article multimedia component multimedia component appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j oceaneng 2019 02 063 
22904,offshore wind turbines owts subjected to combined wind and wave loadings experience excessive bi directional vibrations that adversely influence the system performance and the structural integrity the present paper utilizes a three dimensional pendulum tuned mass damper 3d ptmd to mitigate the bi directional vibrations as well as harvest the kinetic energy using a linear electromagnetic energy harvester the proposed energy harvester consists of magnets and coil assemblies which are connected with the pendulum to convert the kinetic energy of the pendulum into electricity an analytical model of the offshore wind turbine coupled with the 3d ptmd is established using euler lagrangian equation the mathematical model of the linear electromagnetic energy harvester is established and integrated with the wind turbine model the optimum design of the electromagnetic energy harvester to minimize the nacelle displacement rms as well as to maximize the energy output is determined via a numerical search method the nrel 5 mw baseline wind turbine model is utilized to evaluate the performance of the 3d ptmd and the energy harvester results show that the 3d ptmd can reduce the bi directional vibrations induced by misaligned wind and wave loadings additionally electrical energy in orders of magnitude of kilowatts can be harnessed via using the energy harvester keywords offshore wind turbines three dimensional pendulum tuned mass damper energy harvesting bi directional vibration mitigation electromagnetic generator 1 introduction increasing demand for renewable energy makes wind energy production grow exponentially in the world today offshore wind turbines owts are becoming increasingly attractive than their onshore counterparts due to steadier and higher wind speeds fewer space limitations lower visual impact and less noise pollution in the marine area however because of the severe marine conditions such as strong wind wave and storm surge the owts always suffer from excessive vibrations which will compromise the power output reducing the structure reliability and increasing the maintenance cost in this regard structural control and health monitoring of owts have been studied actively by researchers in the past years in the community of structural control dissipating the kinetic energy of the main structure by means of viscous dampers is widely used to mitigate the structural response alternatively the kinetic energy of the main structure especially large structures can be harnessed as renewable energy meanwhile application of structural health monitoring shm with respect to the owts is essential to ensure the wind turbine performance and structural integrity which requires a large number of sensors continuous and reliable power supply to these sensors is a challenge due to limited lifespan of batteries and several miles distance from the coast therefore an integrated vibration control and energy harvesting is investigated to reduce the structural response of owts and simultaneously supply energy for the shm system to mitigate the excessive vibration of owts structural vibration control which has been previously applied in traditional civil structures is being studied numerous controlling methods have been investigated for offshore wind turbines murtagh et al 2007 studied the control of the wind turbine along wind vibration using a passive tuned mass damper colwell and basu 2009 studied the vibration reduction of the offshore wind turbines using the tuned liquid column damper it was found that the tuned liquid column damper can increase the tower fatigue life although passive control strategies are effective within the targeted frequency range they might lose part of their effectiveness because of environmental and system variations to overcome this issue lackner and rotea 2011a investigated active control for a floating barge type wind turbine it was found that active control is more effective than passive control in mitigating the structural vibrations staino et al 2012 used active tendons installed inside the wind turbine blades to mitigate the blades edgewise vibration it was shown that the introduced active control improves the wind turbine blades response fitzgerald and basu 2014 used an active tuned mass damper to mitigate the blades in plane vibrations it was concluded that active tuned mass damper is more effective than passive tuned mass damper in addition to active control semi active control which can provide comparable mitigation effect yet requires orders of magnitude smaller input energy is studied to mitigate the owts vibrations considering environmental and system variations sun 2018a 2018b introduced a semi active tmd stmd with tunable damping ratio and natural frequency to mitigate the owt vibrations the author found that with damage presence the passive tmd becomes off tuned and loses part of its effectiveness in comparison the stmd can effectively mitigate the structural vibration in the presence of damage dinh et al 2016 used an stmd placed in the wind turbine blades nacelle and platform it was observed that the semi active tuned mass damper is more effective than the passive tmd when subjected to time variant mooring cable tension rotor speed and blade stiffness while most of the current research focuses on mitigating the vibration in the fore aft direction owts always suffer from significant side side vibrations due to vortex induced vibrations or misalignment between wind and wave to address this issue lackner and rotea 2011b used dual linear tmds to control the bi directional structural vibrations it was concluded that the dual linear tmds can improve the structural response in both directions however several limitations such as high cost of installation larger mass and space exist in their approach hence using a tuned mass damper which is capable of mitigating the bi directional vibrations simultaneously is desired in this regard sun and jahangiri 2018 2019 introduced a three dimensional pendulum tuned mass damper 3d ptmd to control the excessive vibrations of the monopile owt in two directions the two linear tmds introduced in ref lackner and rotea 2011b was also used for comparison the authors concluded that the proposed 3d ptmd is more effective than the dual linear tmds in mitigating the bi directional structural vibration in the aforementioned literature viscous dampers are employed with tmds to dissipate the kinetic energy into heat by inelastic deformation housneret al 1997 instead of dissipating the kinetic energy into heat the kinetic energy can be harnessed by means of energy harvesters i e electromagnetic generators which function as equivalent as viscous dampers from the structural control perspective xie et al 2013 introduced a new method by implementing piezoelectric materials to convert the kinetic energy of a high rise building into electrical power it was concluded that the introduced method is capable of mitigating the vibration of the building like a tmd shen et al 2012 proposed a self powered planar pendulum tmd vibration control and monitoring system it was found that the proposed system provides a solution to the power supply problem and stimulates the integrated vibration control and monitoring system tang and zuo 2012 presented a method to scavenge the vibration energy from tall buildings with tmds by replacing the traditional viscous dampers with linear electromagnetic devices the approach was tested in a prototype building and an amount of 60 mw energy was harvested from the prototype model arias et al 2008 studied the feasibility of using passive electromagnetic damping system as a structural device in a traditional civil structure the authors found that the electromagnetic damping system could operate as a semi active damper by modifying the circuit impedance jahangiri et al 2016 employed piezoelectric materials in offshore oil platforms to convert mechanical energy of sea waves into electrical energy also fault diagnosis of the oil platform was studied based on the voltage signal in the presence of different uncertainties muliawan et al 2013 considered a combination of a spar type floating wind turbine and a floating point absorber wave energy converter it was shown that the combination of wave energy converter with the floating wind turbine can increase the total energy production a literature review in this area shows that harvesting energy from the motion of a three dimensional pendulum applied in owts has not been investigated before the present paper employs a three dimensional ptmd 3d ptmd proposed in sun and jahangiri 2018 to achieve integrated bi directional vibration mitigation and energy harvesting of the monopile owt on the basis of the authors previous work sun and jahangiri 2018 sun et al 2014a 2014b first a nonlinear mathematical model of the monopile owt coupled with the 3d ptmd and an energy harvester is established next dynamic interaction between the blades and the tower and the 3d ptmd is modeled then the mathematical model of a linear electromagnetic energy harvester system consisting of magnets and coil assemblies coupled with the 3d ptmd is established the generated electrical power is determined finally the performance of the 3d ptmd with an energy harvester in mitigating the vibrations in fore aft and side side directions is evaluated and compared with an uncontrolled owt results show that the 3d ptmd with an energy harvester is capable of mitigating the bi directional vibrations of the owt under misaligned wind and wave loadings more importantly electrical power in orders of magnitude of kilowatts can be harvested through the linear electromagnetic energy harvester which can be used to power the sensors for online structural health monitoring and the actuators for structural control 2 establishment of the analytical model euler lagrangian equation is used to establish the equations of motion of a fully coupled three dimensional dynamic model for a monopile owt with and without the 3d ptmd fig 1 portrays the schematic model of the owt with a 3d ptmd placed in the nacelle totally the coupled system contains 14 degree of freedom dof with q 1 q 6 representing the blade in plane and out of plane coordinates q 9 q 12 representing the nacelle fore aft and side side coordinates representing the translational and rotational coordinates of the foundation and q 13 and q 14 representing the relative coordinates of the ptmd with respect to the nacelle the soil effects in this paper is modeled with a pair of springs and dash pots the stiffness coefficient of soil effects for translational coordinates is represented by k x and k y and rotational springs with coefficients of k x œï and k y œï similarly the damping coefficients for translational and rotational coordinates is represented by c x c y c x œï and c y œï in fig 1 a wind wave misalignment is considered and denoted as Œ≤ as shown in fig 1 b a local coordinate system x r y r z r o r originating at the rest position of the pendulum is defined where the 3d ptmd will move along a spherical surface when the nacelle moves in the fore aft and side side directions as illustrated in fig 1 c and d two electromagnetic energy harvesters which performs as equivalent as viscous dampers are attached to the pendulum with an equivalent damping coefficients of c e h x and c e h y in x r and y r directions respectively the equations and schematic model of the electromagnetic energy harvester will be presented in section 4 2 1 model description the euler lagrangian equation is used to establish the equations of motion of the monopile owt coupled with 3d ptmd 1 d d t t t q t q t q i t t t q t q t q i t v t q t q i t q i t where sign denotes the first derivative with respect to time t and v are the kinetic and potential energy of the wind turbine q t is the generalized coordinates vector q i t is the generalized force corresponding to the i t h component of q t the nacelle absolute displacement in fore aft u n a c f a and side side u n a c s s directions can be determined as 2 u n a c f a q 7 q 9 h tan q 10 q 7 q 9 h q 10 u n a c s s q 8 q 11 h tan q 12 q 8 q 11 h q 12 by taking the derivative of eq 2 the absolute velocity in both directions can be v determined as 3 v n a c f a q 7 q 9 h q 10 v n a c s s q 8 q 11 h q 12 by considering parameter œâ as the rotating speed of the blades the azimuth angle œà j t of the j t h blade can be expressed as 4 œà j œâ t 2 œÄ 3 j 1 j 1 2 3 the absolute coordinate of the ptmd can be expressed as 5 x p u n a c f a x r y p u n a c s s y r z p l l 2 x r 2 y r 2 the kinetic energy of the pendulum is determined as follows 6 t p 1 2 m p x p 2 y p 2 z p 2 m p 2 v n a c s s 2 v n a c f a 2 2 v n a c s s x r 2 v n a c f a y r x r 2 y r 2 x r x r y r y r 2 l 2 x r 2 y r 2 where m p is the mass of the 3d ptmd finally the kinetic energy of the wind turbine system with coupled 3d ptmd can be determined as follows 7 t 1 2 j 1 3 0 r m v b j 2 r t d r 1 2 m n a c v n a c 2 1 2 0 h m v t o w 2 d z 1 2 m f q 9 2 t q 11 2 t 1 2 i f q 10 2 t q 12 2 t t p where m f and i f are the foundation mass and moment of inertia respectively m n a c is the nacelle mass m and m are the mass density per length of the blade and the tower parameters v b j and v t o w are the absolute velocity of the blade and tower respectively which can be found in ref sun 2018a also the potential energy of the pendulum is expressed as follows 8 v p m p g l l 2 x r 2 y r 2 therefore the total potential energy of the system can be expressed as 9 v v b 1 2 k t f a q 7 2 t 1 2 k t s s q 8 2 t 1 2 k x q 9 2 t 1 2 k y q 11 2 t 1 2 k x œï q 10 2 t 1 2 k y œï q 12 2 t v p where v b is the potential energy of the blades which can be found in ref sun 2018a k t f a and k t s s are the fore aft and side side stiffness of the tower by substituting eqs 7 and 9 into eq 1 the equations of motion for the owt can be expressed in a matrix format as follows 10 m q c e q q k q q w i n d q w v f where the system mass damping and stiffness matrices are shown with m c e q and k respectively in c e q the damping coefficient of the pendulum is determined via the electromagnetic force f is the generalized force caused by the nonlinearity of the pendulum variables q w i n d and q w v are the wind and wave generalized force vectors which are explained in the next section it should be noted that eq 10 is nonlinear equation since m c e q and k are time variant 3 loading the wind and wave loadings are derived and presented in this section 3 1 wind and aerodynamic loading the derivation of the generalized force vector of the wind loading represented by q w i n d in eq 10 is presented in this section a three dimensional wind field model is used to generate the wind speed time history for each blade element the wind velocity v z t can be expressed as v z t i e 11 v z t v z v z t where v z is the constant mean velocity which is calculated using the logarithmic wind profile the turbulent component is shown with v z t for the wind turbulence model and detailed description with respect to the generation of a three dimensional wind field one can refer to ref sun and jahangiri 2018 based on ref sun and jahangiri 2018 a three dimensional wind field profile represented by 31 31 velocity grids covering the domain of the rotor disk is generated using the turbsim program jonkman and kilcher 2012 as shown in fig 2 where the wind velocity is mapped onto the rotating blades wind shear power law with an exponent of 0 1 is used to describe the mean wind velocity the generated full wind field profile is mapped to each span station of the rotating blades using developed matlab codes fig 3 demonstrates the wind velocity time history at the center of the first blade tip element where the mean wind velocity is equal to v 12 m s and the turbulence intensity is equal to t i 10 in this study the blade element momentum bem method is implemented to calculate the aerodynamic loading applied to the rotating blades the blade rotational wind speed and the geometry of the blade are considered as input parameters hansen 2000 a general turbine blade is illustrated in fig 4 the blade is discretized into n elements and the blade elements are analyzed using bem method parameter r and œâ are the rotor radius and rotation velocity respectively also the i t h blade element at a distance r is detailed where d r is the element span and chord length at the element mid span is shown with c r fig 5 demonstrates an arbitrary wind turbine blade element subjected to aerodynamic loading and local velocities the relative wind velocity can be expressed as 12 v r e l v 1 a 2 œâ r 1 a 2 where a and a denote the axial velocity and tangential velocity induction factors the flow angle œï is obtained as 13 œï t a n 1 v 1 a œâ r 1 a the attack angle Œ± between the chord line and the relative velocity can be calculated by 14 Œ± œï Œ∏ where Œ∏ can be calculated by summing the twist and the pitch angle the lift and drag coefficients shown with c l and c d can be defined from the airfoil data in terms of the attack angle the lift force p l and the drag force p d can be calculated as 15 p l 1 2 œÅ v r e l 2 c c l p d 1 2 œÅ v r e l 2 c c d where œÅ and c are the air density and the chord length respectively the normal coefficient c n and the tangential coefficient c t can be determined as 16 c n c o s œï c l s i n œï c d c t s i n œï c l c o s œï c d the normal force p n and the tangential forces p t can be determined as 17 p n 1 2 œÅ v r e l 2 c c n p t 1 2 œÅ v r e l 2 c c t the time series of normal and tangential forces expressed in eq 17 can be obtained by developed matlab codes based on the introduced algorithm in ref hansen 2000 it should be noted that the developed matlab code includes glauert correction and the prandtl s tip loss factor in the next step the generalized aerodynamic loading is calculated based on the principle of virtual work the virtual work Œ¥ w w l done by the wind loading can be defined as 18 Œ¥ w w l j 1 3 0 r p t j r t œï 1 e Œ¥ q j Œ¥ u n a c s s cos œà j d r 0 r p n j r t œï 1 f Œ¥ q j 3 Œ¥ u n a c f a d r where p t j r t and p n j r t are the tangential and normal wind loading intensity per unit length on the j t h blade in terms of the principles of work and energy the generalized force q j can be defined as 19 q j Œ¥ w w l Œ¥ q j the wind induced generalized force can be determined by substituting eq 18 into eq 19 as follows 20 q j w i n d 0 r p t j r t œï 1 e d r q j 3 w i n d 0 r p n j r t œï 1 f d r j 1 2 3 q 7 w i n d j 1 3 0 r p n j r t d r q 8 w i n d j 1 3 0 r p t j r t d r cos œà j q 9 w i n d q 7 w i n d q 10 w i n d h q 7 w i n d q 11 w i n d q 8 w i n d q 12 w i n d h q 8 w i n d the magnitude of the wind loading effect on the tower of the offshore wind turbine is relatively small in comparison with the wind turbine blades and thus it is ignored in this paper 3 2 wave loading the derivation of the generalized force vector of the wave loading represented by q w a v e in eq 10 is presented in this section the strip theory and linear wave theory are implemented to determine the wave loading acting on the offshore wind turbine the monopile fixed offshore wind turbine is a cylindrical structure member thus morison s equation faltinsen 1990 can be used to estimate the wave loading the horizontal force of the wave d f acting on a strip of length d z can be expressed as 21 d f œÄ d 2 4 c m œÅ u d z œÅ 2 c d d u u d z where c m is the mass coefficient which has a value of 1 0 and c d is the drag coefficient which has a value of 1 2 in this study œÅ is the density of water which is equal to 1025 k g m 3 d is the diameter of the tower the wave induced horizontal acceleration and velocity of fluid particles is shown with u and u the jonswap wave spectrum ref iec 2009 as expressed in the following equation is used to generate wave time histories 22 s f 0 3125 h s 2 t p f f p 5 e x p 5 4 f f p 4 1 0 287 l n Œ≥ Œ≥ e x p œâ œâ p 2 2 œÉ 2 œâ p 2 where h s denotes the significant wave height t p is the period of sea waves f p 1 t p œÉ 0 07 for f f p œÉ 0 09 for f f p variable Œ≥ denotes the jonswap peakedness parameter iec 2009 23 Œ≥ 5 t p h s 3 6 e x p 5 75 1 15 t p h s 3 6 t p h s 5 0 1 t p h s 5 0 virtual work Œ¥ w w v done by the wave loading along the virtual displacement Œ¥ u t o w of the tower can be expressed as 24 Œ¥ w w v 0 Œ∑ d f Œ¥ u t o w 0 Œ∑ d f œï 1 t c o s Œ≤ Œ¥ q 7 s i n Œ≤ Œ¥ q 8 c o s Œ≤ Œ¥ q 9 z Œ¥ q 10 s i n Œ≤ Œ¥ q 11 z Œ¥ q 12 the wave generalized force can be determined by substituting eq 24 into eq 19 as follows 25 q 7 w a v e c o s Œ≤ f w v 1 q 8 w a v e s i n Œ≤ f w v 1 q 9 w a v e c o s Œ≤ f w v 2 q 11 w a v e s i n Œ≤ f w v 2 q 10 w a v e c o s Œ≤ f w v 3 q 12 w a v e s i n Œ≤ f w v 3 where f w v 1 d w Œ∑ t œï 1 t z d f i 1 n z œï 1 t z i œÅ œÄ d 2 z i 4 c m u z i t Œ¥ z œÅ 2 c d d z i u z i t u z i t Œ¥ z f w v 2 d w Œ∑ t d f i 1 n z œÅ œÄ d 2 z i 4 c m u z i t Œ¥ z œÅ 2 c d d z i u z i t u z i t Œ¥ z f w v 3 d w Œ∑ t z d f i 1 n z œÅ œÄ d 2 z i 4 c m u z i t Œ¥ z œÅ 2 c d d z i u z i t u z i t Œ¥ z z i parameter n z is the number of segments that the wetted portion of the tower is divided and Œ¥ z is the segment length 4 energy harvesting the schematic model of the electromagnetic generator consisting of a magnet assembly and a coil assembly is illustrated in fig 6 in the schematic model the relative motion between the magnet assembly and the coil assembly will produce electrical power accordingly the electromagnetic energy harvester will provide an electromagnetic force to mitigate the motion of the pendulum one end of the electromagnetic device is hinged to the structure and the other end is hinged to the pendulum as shown in fig 6 the energy harvester can freely rotate along with the motion of the pendulum via using ball hinges 4 1 uncoupled equations essentially the dynamic and electrical equations of the energy harvesters are coupled in real time however most of existing research simplified the model via considering the two process separately to reveal the difference and provide more insight into this process the present paper will establish two models uncoupled and coupled and compare the results in this section the electromagnetic energy harvester is considered to be uncoupled with the system and the equations are established the electrical voltage in x r and y r directions produced by the relative motion of the pendulum and the nacelle can be obtained as 26 v x b l x r v y b l y r where parameters b l x r and y r are the magnetic field constant length of the conductor and the relative velocity of the pendulum in x r and y r directions using the ohms law the electrical current can be determined as 27 i x v x r c i r c u i t b œÄ d n x r r c i r c u i t i y v y r c i r c u i t b œÄ d n y r r c i r c u i t where r c i r c u i t is the total resistance and is equal to the sum of internal resistance and the load resistance the generated current will cause a magnetic force to oppose the motion of the conductor according to lorentz law the magnetic force is equal to the multiplication of the current the magnetic field constant and the length of the conductor which can be expressed as 28 f x œÄ b d n 2 r c i r c u i t x r c e q x r f y œÄ b d n 2 r c i r c u i t y r c e q y r where c e q is an equivalent damping coefficient through solving eq 10 numerically the generated voltage and the corresponding magnetic force can be calculated using eq 26 eq 28 4 2 coupled equations in this section the electromagnetic energy harvester is considered to be coupled with the offshore wind turbine by coupling the energy harvester with the owt model two additional dofs are added to eq 10 the two added dofs are the current produced by the energy harvester in x r and y r directions an equivalent circuit is shown in fig 7 to represent the coupled linear electromagnetic energy harvester which is formulated as follows 29 l c o i l i x t r c i r c i x t e x t l c o i l i y t r c i r c i y t e y t where i x and i y are the currents l c o i l is the inductance of the coil e x and e y are the electromotive forces in x r and y r directions respectively the electromagnetic energy harvester is coupled with the owt system and the electrical current in x r and y r directions is considered as two additional dofs of the system hence the system will have 16 dofs totally parameter l c o i l is the inductance of the coil and can be determined by the following equation 30 l c o i l n 2 Œº 0 Œº r d 2 l n 8 d d 2 where Œº 0 and Œº r are the permeability of free space and relative permeability of the wire based on the faradays law the electromotive force is equal to multiplication of electromotive force coefficient k e m f and the relative velocity 31 e x t k e m f x r t e y t k e m f y r t the damping force generated by the electromagnetic transducer is expressed as 32 f e t k e m f i t substituting eq 31 into eq 29 yields 33 l c o i l i x t r c i r c i x t k e m f x r t l c o i l i y t r c i r c i y t k e m f y r t it is noted that the electromagnetic force calculated by eq 32 is the equivalent damping force of the pendulum then eqs 32 and 33 are coupled with eq 10 and can be solved numerically simultaneously 4 3 energy harvester parameters the optimum design of the electromagnetic energy harvester to minimize the nacelle displacement rms and to maximize the generated electrical power is presented in this section a numerical search method is used to determine the optimal parameters for the energy harvester the damping ratio of the 3d ptmd can be adjusted by changing the energy harvester parameters such as coil diameter number of turns circuit resistance and wire diameter on the basis of the authors previous work sun and jahangiri 2018 a mass ratio of 2 is recommended for the 3d ptmd considering the mitigation effect and practical constraints hence the present study uses a mass ratio of 2 with the fixed mass ratio of 2 the optimized frequency ratio was determined to be 0 97 with the given mass ratio 2 and frequency ratio 0 97 the nacelle displacement rms and the mean value of generated electrical power corresponding to different damping ratio values are determined the mean value of generated electrical power and displacement rms is set as the optimum objective fig 8 demonstrates the nacelle displacement rms against the damping ratio from this figure one can observe that a damping ratio of 10 is the optimum value to minimize the displacement rms fig 9 shows the mean value of generated electrical power against the damping ratio it can be seen that the generated electrical power decreases as the damping ratio decreases in the present study the primary objective is to mitigate the wind turbine displacement response therefore optimized value of the damping ratio to minimize the nacelle displacement rms is selected the desired damping ratio for ptmd is set to be 10 by considering a mass ratio of 2 and c 2 Œæ m p œâ n the damping coefficient can be calculated as 2852 42 n s m in this regard the chosen electromagnetic device parameters which satisfy the desired design for damping coefficient are listed in table 1 5 system parameters the parameter values of the baseline monopile owt and the soil effects are presented in this section in this paper the nrel 5 mw oc3 monopile wind turbine model jonkman et al 2009 is used the parameters are listed in table 2 the soil effect is modeled with linear springs and dash pots to represent the clay soil condition the spring stiffnesses are equal to k x k y 3 89 e 9 n m k x œï k y œï 1 14 e 11 n m r a d also the soil damping properties are equal to Œ∂ x Œ∂ y Œ∂ x œï Œ∂ y œï 0 6 carswell et al 2015 6 simulation and results in this section the performance of the 3d ptmd in mitigating the bi directional vibration of the owt is evaluated and the harnessed energy from the energy harvester is determined structural responses of the wind turbine are calculated through numerically solving eq 10 the mean wind velocity is considered to be 12 m s with a turbulent intensity of 10 and the significant wave height is assumed to be 2 m based on preceding discussions a suggested mass ratio of 2 is utilized and the corresponding optimal frequency ratio and damping ratio are f o p t 0 97 and Œæ o p t 10 fig 10 a d shows the nacelle fore aft displacement time history comparison between the 3d ptmd and the uncontrolled owt under the four wind wave misalignment angles it can be found that the 3d ptmd is able to mitigate the vibrations of the owt in the fore aft direction according to the data presented in fig 10 the 3d ptmd is able to reduce the rms of nacelle displacement in fore aft direction by 70 fig 11 a d shows the nacelle side side response mitigation comparison where it is indicated that the 3d ptmd can mitigate the nacelle side side response under different wind wave misalignment angles the 3d ptmd is able to mitigate the displacement of owt in the side side direction by around 77 it should be noted that the side side motion is minimal when the wind and wave loadings are aligned as shown in fig 11 a figs 12 and 13 illustrate the generated voltage time history comparison between the coupled and uncoupled energy harvester models in the fore aft and side side directions under four wind wave misalignment angles it should be noted that a 50 s time window is used to show the differences clearly one can observe the difference between the results from the uncoupled and coupled models quantitatively the generated voltage calculated using the coupled model is 7 smaller than that via the uncoupled model the reason for the small difference between the coupled and uncoupled energy harvester models is the low frequency feature of the primary structure and the small value of the inductance the inductance value for the considered electromagnetic damper is equal to 0 02 h which is a small value the generated power in the fore aft direction under different wind and wave misalignments is illustrated in fig 14 a d one can find that the generated electrical power decreases when increasing the wind and wave misalignment angle the average generated electrical power in fore aft direction for 0 30 60 and 90 wind wave misalignment angle is 792 594 203 and 2 8 w respectively the generated power in the side side direction under different wind and wave misalignments is illustrated in fig 15 a d the average generated electrical power in side side direction for 0 30 60 and 90 wind wave misalignment angle is 0 205 615 and 820 w respectively it can be seen that increasing the wind and wave misalignment angle will result in an increase in the generated electrical power 7 conclusions in the present paper a 3d ptmd with an energy harvester is utilized to control the bi directional vibration of the monopile owts through converting the kinetic energy into electrical power an analytical model of the monopile owt coupled with the 3d ptmd and the energy harvester is established linear electromagnetic devices are used instead of traditional viscous dampers to convert the kinetic energy of the pendulum into electrical power the performance of the 3d ptmd energy harvester system in reducing the response and harvesting the kinetic energy is evaluated based on the presented results the following conclusions can be obtained 1 the 3d ptmd energy harvester system is able to reduce the nacelle vibrations in the fore aft and side side directions significantly quantitatively the 3d ptmd can reduce the nacelle rms response by 70 in the fore aft direction and 77 in the side side direction 2 instead of dissipating the kinetic energy into heat the linear electromagnetic devices are implemented to convert the motion of the 3d ptmd into electrical power theoretical results indicate that considerable amount of energy with a magnitude of kw can be produced which can be used to power sensors and actuators for the structural health monitoring and control systems 3 the difference of the generated electrical voltage between coupled and uncoupled energy harvester models is around 7 using the parameter values selected in the present study the small difference for the generated electrical power between the coupled and uncoupled energy harvester is because of the low frequency feature of the primary system and small value of coil inductance it can be concluded that for low frequency structures such as high rise buildings bridges owts and etc uncoupled equations for the energy harvester can be used with a good accuracy 4 theoretically the generated electrical power using electromagnetic energy harvester is in orders of magnitude of kilowatts which is a considerable amount of energy to power the structural health monitoring and control devices it is important to consider the practical constraints and determine the applicable generated electrical power therefore experimental analysis to evaluate the findings of this paper will be implemented in future study acknowledgment this work was supported by louisiana state university start up fund fund number is 127150013 louisiana state university hurricane resilience research institute award awd 001823 and industrial ties research subpro gram of louisiana state board of regents awd 001515 usa this work was also supported by key laboratory of performance evolution and control for engineering structures of ministry of education tongji university grant no 2018kf 6 china the authors are grateful for all the support 
22904,offshore wind turbines owts subjected to combined wind and wave loadings experience excessive bi directional vibrations that adversely influence the system performance and the structural integrity the present paper utilizes a three dimensional pendulum tuned mass damper 3d ptmd to mitigate the bi directional vibrations as well as harvest the kinetic energy using a linear electromagnetic energy harvester the proposed energy harvester consists of magnets and coil assemblies which are connected with the pendulum to convert the kinetic energy of the pendulum into electricity an analytical model of the offshore wind turbine coupled with the 3d ptmd is established using euler lagrangian equation the mathematical model of the linear electromagnetic energy harvester is established and integrated with the wind turbine model the optimum design of the electromagnetic energy harvester to minimize the nacelle displacement rms as well as to maximize the energy output is determined via a numerical search method the nrel 5 mw baseline wind turbine model is utilized to evaluate the performance of the 3d ptmd and the energy harvester results show that the 3d ptmd can reduce the bi directional vibrations induced by misaligned wind and wave loadings additionally electrical energy in orders of magnitude of kilowatts can be harnessed via using the energy harvester keywords offshore wind turbines three dimensional pendulum tuned mass damper energy harvesting bi directional vibration mitigation electromagnetic generator 1 introduction increasing demand for renewable energy makes wind energy production grow exponentially in the world today offshore wind turbines owts are becoming increasingly attractive than their onshore counterparts due to steadier and higher wind speeds fewer space limitations lower visual impact and less noise pollution in the marine area however because of the severe marine conditions such as strong wind wave and storm surge the owts always suffer from excessive vibrations which will compromise the power output reducing the structure reliability and increasing the maintenance cost in this regard structural control and health monitoring of owts have been studied actively by researchers in the past years in the community of structural control dissipating the kinetic energy of the main structure by means of viscous dampers is widely used to mitigate the structural response alternatively the kinetic energy of the main structure especially large structures can be harnessed as renewable energy meanwhile application of structural health monitoring shm with respect to the owts is essential to ensure the wind turbine performance and structural integrity which requires a large number of sensors continuous and reliable power supply to these sensors is a challenge due to limited lifespan of batteries and several miles distance from the coast therefore an integrated vibration control and energy harvesting is investigated to reduce the structural response of owts and simultaneously supply energy for the shm system to mitigate the excessive vibration of owts structural vibration control which has been previously applied in traditional civil structures is being studied numerous controlling methods have been investigated for offshore wind turbines murtagh et al 2007 studied the control of the wind turbine along wind vibration using a passive tuned mass damper colwell and basu 2009 studied the vibration reduction of the offshore wind turbines using the tuned liquid column damper it was found that the tuned liquid column damper can increase the tower fatigue life although passive control strategies are effective within the targeted frequency range they might lose part of their effectiveness because of environmental and system variations to overcome this issue lackner and rotea 2011a investigated active control for a floating barge type wind turbine it was found that active control is more effective than passive control in mitigating the structural vibrations staino et al 2012 used active tendons installed inside the wind turbine blades to mitigate the blades edgewise vibration it was shown that the introduced active control improves the wind turbine blades response fitzgerald and basu 2014 used an active tuned mass damper to mitigate the blades in plane vibrations it was concluded that active tuned mass damper is more effective than passive tuned mass damper in addition to active control semi active control which can provide comparable mitigation effect yet requires orders of magnitude smaller input energy is studied to mitigate the owts vibrations considering environmental and system variations sun 2018a 2018b introduced a semi active tmd stmd with tunable damping ratio and natural frequency to mitigate the owt vibrations the author found that with damage presence the passive tmd becomes off tuned and loses part of its effectiveness in comparison the stmd can effectively mitigate the structural vibration in the presence of damage dinh et al 2016 used an stmd placed in the wind turbine blades nacelle and platform it was observed that the semi active tuned mass damper is more effective than the passive tmd when subjected to time variant mooring cable tension rotor speed and blade stiffness while most of the current research focuses on mitigating the vibration in the fore aft direction owts always suffer from significant side side vibrations due to vortex induced vibrations or misalignment between wind and wave to address this issue lackner and rotea 2011b used dual linear tmds to control the bi directional structural vibrations it was concluded that the dual linear tmds can improve the structural response in both directions however several limitations such as high cost of installation larger mass and space exist in their approach hence using a tuned mass damper which is capable of mitigating the bi directional vibrations simultaneously is desired in this regard sun and jahangiri 2018 2019 introduced a three dimensional pendulum tuned mass damper 3d ptmd to control the excessive vibrations of the monopile owt in two directions the two linear tmds introduced in ref lackner and rotea 2011b was also used for comparison the authors concluded that the proposed 3d ptmd is more effective than the dual linear tmds in mitigating the bi directional structural vibration in the aforementioned literature viscous dampers are employed with tmds to dissipate the kinetic energy into heat by inelastic deformation housneret al 1997 instead of dissipating the kinetic energy into heat the kinetic energy can be harnessed by means of energy harvesters i e electromagnetic generators which function as equivalent as viscous dampers from the structural control perspective xie et al 2013 introduced a new method by implementing piezoelectric materials to convert the kinetic energy of a high rise building into electrical power it was concluded that the introduced method is capable of mitigating the vibration of the building like a tmd shen et al 2012 proposed a self powered planar pendulum tmd vibration control and monitoring system it was found that the proposed system provides a solution to the power supply problem and stimulates the integrated vibration control and monitoring system tang and zuo 2012 presented a method to scavenge the vibration energy from tall buildings with tmds by replacing the traditional viscous dampers with linear electromagnetic devices the approach was tested in a prototype building and an amount of 60 mw energy was harvested from the prototype model arias et al 2008 studied the feasibility of using passive electromagnetic damping system as a structural device in a traditional civil structure the authors found that the electromagnetic damping system could operate as a semi active damper by modifying the circuit impedance jahangiri et al 2016 employed piezoelectric materials in offshore oil platforms to convert mechanical energy of sea waves into electrical energy also fault diagnosis of the oil platform was studied based on the voltage signal in the presence of different uncertainties muliawan et al 2013 considered a combination of a spar type floating wind turbine and a floating point absorber wave energy converter it was shown that the combination of wave energy converter with the floating wind turbine can increase the total energy production a literature review in this area shows that harvesting energy from the motion of a three dimensional pendulum applied in owts has not been investigated before the present paper employs a three dimensional ptmd 3d ptmd proposed in sun and jahangiri 2018 to achieve integrated bi directional vibration mitigation and energy harvesting of the monopile owt on the basis of the authors previous work sun and jahangiri 2018 sun et al 2014a 2014b first a nonlinear mathematical model of the monopile owt coupled with the 3d ptmd and an energy harvester is established next dynamic interaction between the blades and the tower and the 3d ptmd is modeled then the mathematical model of a linear electromagnetic energy harvester system consisting of magnets and coil assemblies coupled with the 3d ptmd is established the generated electrical power is determined finally the performance of the 3d ptmd with an energy harvester in mitigating the vibrations in fore aft and side side directions is evaluated and compared with an uncontrolled owt results show that the 3d ptmd with an energy harvester is capable of mitigating the bi directional vibrations of the owt under misaligned wind and wave loadings more importantly electrical power in orders of magnitude of kilowatts can be harvested through the linear electromagnetic energy harvester which can be used to power the sensors for online structural health monitoring and the actuators for structural control 2 establishment of the analytical model euler lagrangian equation is used to establish the equations of motion of a fully coupled three dimensional dynamic model for a monopile owt with and without the 3d ptmd fig 1 portrays the schematic model of the owt with a 3d ptmd placed in the nacelle totally the coupled system contains 14 degree of freedom dof with q 1 q 6 representing the blade in plane and out of plane coordinates q 9 q 12 representing the nacelle fore aft and side side coordinates representing the translational and rotational coordinates of the foundation and q 13 and q 14 representing the relative coordinates of the ptmd with respect to the nacelle the soil effects in this paper is modeled with a pair of springs and dash pots the stiffness coefficient of soil effects for translational coordinates is represented by k x and k y and rotational springs with coefficients of k x œï and k y œï similarly the damping coefficients for translational and rotational coordinates is represented by c x c y c x œï and c y œï in fig 1 a wind wave misalignment is considered and denoted as Œ≤ as shown in fig 1 b a local coordinate system x r y r z r o r originating at the rest position of the pendulum is defined where the 3d ptmd will move along a spherical surface when the nacelle moves in the fore aft and side side directions as illustrated in fig 1 c and d two electromagnetic energy harvesters which performs as equivalent as viscous dampers are attached to the pendulum with an equivalent damping coefficients of c e h x and c e h y in x r and y r directions respectively the equations and schematic model of the electromagnetic energy harvester will be presented in section 4 2 1 model description the euler lagrangian equation is used to establish the equations of motion of the monopile owt coupled with 3d ptmd 1 d d t t t q t q t q i t t t q t q t q i t v t q t q i t q i t where sign denotes the first derivative with respect to time t and v are the kinetic and potential energy of the wind turbine q t is the generalized coordinates vector q i t is the generalized force corresponding to the i t h component of q t the nacelle absolute displacement in fore aft u n a c f a and side side u n a c s s directions can be determined as 2 u n a c f a q 7 q 9 h tan q 10 q 7 q 9 h q 10 u n a c s s q 8 q 11 h tan q 12 q 8 q 11 h q 12 by taking the derivative of eq 2 the absolute velocity in both directions can be v determined as 3 v n a c f a q 7 q 9 h q 10 v n a c s s q 8 q 11 h q 12 by considering parameter œâ as the rotating speed of the blades the azimuth angle œà j t of the j t h blade can be expressed as 4 œà j œâ t 2 œÄ 3 j 1 j 1 2 3 the absolute coordinate of the ptmd can be expressed as 5 x p u n a c f a x r y p u n a c s s y r z p l l 2 x r 2 y r 2 the kinetic energy of the pendulum is determined as follows 6 t p 1 2 m p x p 2 y p 2 z p 2 m p 2 v n a c s s 2 v n a c f a 2 2 v n a c s s x r 2 v n a c f a y r x r 2 y r 2 x r x r y r y r 2 l 2 x r 2 y r 2 where m p is the mass of the 3d ptmd finally the kinetic energy of the wind turbine system with coupled 3d ptmd can be determined as follows 7 t 1 2 j 1 3 0 r m v b j 2 r t d r 1 2 m n a c v n a c 2 1 2 0 h m v t o w 2 d z 1 2 m f q 9 2 t q 11 2 t 1 2 i f q 10 2 t q 12 2 t t p where m f and i f are the foundation mass and moment of inertia respectively m n a c is the nacelle mass m and m are the mass density per length of the blade and the tower parameters v b j and v t o w are the absolute velocity of the blade and tower respectively which can be found in ref sun 2018a also the potential energy of the pendulum is expressed as follows 8 v p m p g l l 2 x r 2 y r 2 therefore the total potential energy of the system can be expressed as 9 v v b 1 2 k t f a q 7 2 t 1 2 k t s s q 8 2 t 1 2 k x q 9 2 t 1 2 k y q 11 2 t 1 2 k x œï q 10 2 t 1 2 k y œï q 12 2 t v p where v b is the potential energy of the blades which can be found in ref sun 2018a k t f a and k t s s are the fore aft and side side stiffness of the tower by substituting eqs 7 and 9 into eq 1 the equations of motion for the owt can be expressed in a matrix format as follows 10 m q c e q q k q q w i n d q w v f where the system mass damping and stiffness matrices are shown with m c e q and k respectively in c e q the damping coefficient of the pendulum is determined via the electromagnetic force f is the generalized force caused by the nonlinearity of the pendulum variables q w i n d and q w v are the wind and wave generalized force vectors which are explained in the next section it should be noted that eq 10 is nonlinear equation since m c e q and k are time variant 3 loading the wind and wave loadings are derived and presented in this section 3 1 wind and aerodynamic loading the derivation of the generalized force vector of the wind loading represented by q w i n d in eq 10 is presented in this section a three dimensional wind field model is used to generate the wind speed time history for each blade element the wind velocity v z t can be expressed as v z t i e 11 v z t v z v z t where v z is the constant mean velocity which is calculated using the logarithmic wind profile the turbulent component is shown with v z t for the wind turbulence model and detailed description with respect to the generation of a three dimensional wind field one can refer to ref sun and jahangiri 2018 based on ref sun and jahangiri 2018 a three dimensional wind field profile represented by 31 31 velocity grids covering the domain of the rotor disk is generated using the turbsim program jonkman and kilcher 2012 as shown in fig 2 where the wind velocity is mapped onto the rotating blades wind shear power law with an exponent of 0 1 is used to describe the mean wind velocity the generated full wind field profile is mapped to each span station of the rotating blades using developed matlab codes fig 3 demonstrates the wind velocity time history at the center of the first blade tip element where the mean wind velocity is equal to v 12 m s and the turbulence intensity is equal to t i 10 in this study the blade element momentum bem method is implemented to calculate the aerodynamic loading applied to the rotating blades the blade rotational wind speed and the geometry of the blade are considered as input parameters hansen 2000 a general turbine blade is illustrated in fig 4 the blade is discretized into n elements and the blade elements are analyzed using bem method parameter r and œâ are the rotor radius and rotation velocity respectively also the i t h blade element at a distance r is detailed where d r is the element span and chord length at the element mid span is shown with c r fig 5 demonstrates an arbitrary wind turbine blade element subjected to aerodynamic loading and local velocities the relative wind velocity can be expressed as 12 v r e l v 1 a 2 œâ r 1 a 2 where a and a denote the axial velocity and tangential velocity induction factors the flow angle œï is obtained as 13 œï t a n 1 v 1 a œâ r 1 a the attack angle Œ± between the chord line and the relative velocity can be calculated by 14 Œ± œï Œ∏ where Œ∏ can be calculated by summing the twist and the pitch angle the lift and drag coefficients shown with c l and c d can be defined from the airfoil data in terms of the attack angle the lift force p l and the drag force p d can be calculated as 15 p l 1 2 œÅ v r e l 2 c c l p d 1 2 œÅ v r e l 2 c c d where œÅ and c are the air density and the chord length respectively the normal coefficient c n and the tangential coefficient c t can be determined as 16 c n c o s œï c l s i n œï c d c t s i n œï c l c o s œï c d the normal force p n and the tangential forces p t can be determined as 17 p n 1 2 œÅ v r e l 2 c c n p t 1 2 œÅ v r e l 2 c c t the time series of normal and tangential forces expressed in eq 17 can be obtained by developed matlab codes based on the introduced algorithm in ref hansen 2000 it should be noted that the developed matlab code includes glauert correction and the prandtl s tip loss factor in the next step the generalized aerodynamic loading is calculated based on the principle of virtual work the virtual work Œ¥ w w l done by the wind loading can be defined as 18 Œ¥ w w l j 1 3 0 r p t j r t œï 1 e Œ¥ q j Œ¥ u n a c s s cos œà j d r 0 r p n j r t œï 1 f Œ¥ q j 3 Œ¥ u n a c f a d r where p t j r t and p n j r t are the tangential and normal wind loading intensity per unit length on the j t h blade in terms of the principles of work and energy the generalized force q j can be defined as 19 q j Œ¥ w w l Œ¥ q j the wind induced generalized force can be determined by substituting eq 18 into eq 19 as follows 20 q j w i n d 0 r p t j r t œï 1 e d r q j 3 w i n d 0 r p n j r t œï 1 f d r j 1 2 3 q 7 w i n d j 1 3 0 r p n j r t d r q 8 w i n d j 1 3 0 r p t j r t d r cos œà j q 9 w i n d q 7 w i n d q 10 w i n d h q 7 w i n d q 11 w i n d q 8 w i n d q 12 w i n d h q 8 w i n d the magnitude of the wind loading effect on the tower of the offshore wind turbine is relatively small in comparison with the wind turbine blades and thus it is ignored in this paper 3 2 wave loading the derivation of the generalized force vector of the wave loading represented by q w a v e in eq 10 is presented in this section the strip theory and linear wave theory are implemented to determine the wave loading acting on the offshore wind turbine the monopile fixed offshore wind turbine is a cylindrical structure member thus morison s equation faltinsen 1990 can be used to estimate the wave loading the horizontal force of the wave d f acting on a strip of length d z can be expressed as 21 d f œÄ d 2 4 c m œÅ u d z œÅ 2 c d d u u d z where c m is the mass coefficient which has a value of 1 0 and c d is the drag coefficient which has a value of 1 2 in this study œÅ is the density of water which is equal to 1025 k g m 3 d is the diameter of the tower the wave induced horizontal acceleration and velocity of fluid particles is shown with u and u the jonswap wave spectrum ref iec 2009 as expressed in the following equation is used to generate wave time histories 22 s f 0 3125 h s 2 t p f f p 5 e x p 5 4 f f p 4 1 0 287 l n Œ≥ Œ≥ e x p œâ œâ p 2 2 œÉ 2 œâ p 2 where h s denotes the significant wave height t p is the period of sea waves f p 1 t p œÉ 0 07 for f f p œÉ 0 09 for f f p variable Œ≥ denotes the jonswap peakedness parameter iec 2009 23 Œ≥ 5 t p h s 3 6 e x p 5 75 1 15 t p h s 3 6 t p h s 5 0 1 t p h s 5 0 virtual work Œ¥ w w v done by the wave loading along the virtual displacement Œ¥ u t o w of the tower can be expressed as 24 Œ¥ w w v 0 Œ∑ d f Œ¥ u t o w 0 Œ∑ d f œï 1 t c o s Œ≤ Œ¥ q 7 s i n Œ≤ Œ¥ q 8 c o s Œ≤ Œ¥ q 9 z Œ¥ q 10 s i n Œ≤ Œ¥ q 11 z Œ¥ q 12 the wave generalized force can be determined by substituting eq 24 into eq 19 as follows 25 q 7 w a v e c o s Œ≤ f w v 1 q 8 w a v e s i n Œ≤ f w v 1 q 9 w a v e c o s Œ≤ f w v 2 q 11 w a v e s i n Œ≤ f w v 2 q 10 w a v e c o s Œ≤ f w v 3 q 12 w a v e s i n Œ≤ f w v 3 where f w v 1 d w Œ∑ t œï 1 t z d f i 1 n z œï 1 t z i œÅ œÄ d 2 z i 4 c m u z i t Œ¥ z œÅ 2 c d d z i u z i t u z i t Œ¥ z f w v 2 d w Œ∑ t d f i 1 n z œÅ œÄ d 2 z i 4 c m u z i t Œ¥ z œÅ 2 c d d z i u z i t u z i t Œ¥ z f w v 3 d w Œ∑ t z d f i 1 n z œÅ œÄ d 2 z i 4 c m u z i t Œ¥ z œÅ 2 c d d z i u z i t u z i t Œ¥ z z i parameter n z is the number of segments that the wetted portion of the tower is divided and Œ¥ z is the segment length 4 energy harvesting the schematic model of the electromagnetic generator consisting of a magnet assembly and a coil assembly is illustrated in fig 6 in the schematic model the relative motion between the magnet assembly and the coil assembly will produce electrical power accordingly the electromagnetic energy harvester will provide an electromagnetic force to mitigate the motion of the pendulum one end of the electromagnetic device is hinged to the structure and the other end is hinged to the pendulum as shown in fig 6 the energy harvester can freely rotate along with the motion of the pendulum via using ball hinges 4 1 uncoupled equations essentially the dynamic and electrical equations of the energy harvesters are coupled in real time however most of existing research simplified the model via considering the two process separately to reveal the difference and provide more insight into this process the present paper will establish two models uncoupled and coupled and compare the results in this section the electromagnetic energy harvester is considered to be uncoupled with the system and the equations are established the electrical voltage in x r and y r directions produced by the relative motion of the pendulum and the nacelle can be obtained as 26 v x b l x r v y b l y r where parameters b l x r and y r are the magnetic field constant length of the conductor and the relative velocity of the pendulum in x r and y r directions using the ohms law the electrical current can be determined as 27 i x v x r c i r c u i t b œÄ d n x r r c i r c u i t i y v y r c i r c u i t b œÄ d n y r r c i r c u i t where r c i r c u i t is the total resistance and is equal to the sum of internal resistance and the load resistance the generated current will cause a magnetic force to oppose the motion of the conductor according to lorentz law the magnetic force is equal to the multiplication of the current the magnetic field constant and the length of the conductor which can be expressed as 28 f x œÄ b d n 2 r c i r c u i t x r c e q x r f y œÄ b d n 2 r c i r c u i t y r c e q y r where c e q is an equivalent damping coefficient through solving eq 10 numerically the generated voltage and the corresponding magnetic force can be calculated using eq 26 eq 28 4 2 coupled equations in this section the electromagnetic energy harvester is considered to be coupled with the offshore wind turbine by coupling the energy harvester with the owt model two additional dofs are added to eq 10 the two added dofs are the current produced by the energy harvester in x r and y r directions an equivalent circuit is shown in fig 7 to represent the coupled linear electromagnetic energy harvester which is formulated as follows 29 l c o i l i x t r c i r c i x t e x t l c o i l i y t r c i r c i y t e y t where i x and i y are the currents l c o i l is the inductance of the coil e x and e y are the electromotive forces in x r and y r directions respectively the electromagnetic energy harvester is coupled with the owt system and the electrical current in x r and y r directions is considered as two additional dofs of the system hence the system will have 16 dofs totally parameter l c o i l is the inductance of the coil and can be determined by the following equation 30 l c o i l n 2 Œº 0 Œº r d 2 l n 8 d d 2 where Œº 0 and Œº r are the permeability of free space and relative permeability of the wire based on the faradays law the electromotive force is equal to multiplication of electromotive force coefficient k e m f and the relative velocity 31 e x t k e m f x r t e y t k e m f y r t the damping force generated by the electromagnetic transducer is expressed as 32 f e t k e m f i t substituting eq 31 into eq 29 yields 33 l c o i l i x t r c i r c i x t k e m f x r t l c o i l i y t r c i r c i y t k e m f y r t it is noted that the electromagnetic force calculated by eq 32 is the equivalent damping force of the pendulum then eqs 32 and 33 are coupled with eq 10 and can be solved numerically simultaneously 4 3 energy harvester parameters the optimum design of the electromagnetic energy harvester to minimize the nacelle displacement rms and to maximize the generated electrical power is presented in this section a numerical search method is used to determine the optimal parameters for the energy harvester the damping ratio of the 3d ptmd can be adjusted by changing the energy harvester parameters such as coil diameter number of turns circuit resistance and wire diameter on the basis of the authors previous work sun and jahangiri 2018 a mass ratio of 2 is recommended for the 3d ptmd considering the mitigation effect and practical constraints hence the present study uses a mass ratio of 2 with the fixed mass ratio of 2 the optimized frequency ratio was determined to be 0 97 with the given mass ratio 2 and frequency ratio 0 97 the nacelle displacement rms and the mean value of generated electrical power corresponding to different damping ratio values are determined the mean value of generated electrical power and displacement rms is set as the optimum objective fig 8 demonstrates the nacelle displacement rms against the damping ratio from this figure one can observe that a damping ratio of 10 is the optimum value to minimize the displacement rms fig 9 shows the mean value of generated electrical power against the damping ratio it can be seen that the generated electrical power decreases as the damping ratio decreases in the present study the primary objective is to mitigate the wind turbine displacement response therefore optimized value of the damping ratio to minimize the nacelle displacement rms is selected the desired damping ratio for ptmd is set to be 10 by considering a mass ratio of 2 and c 2 Œæ m p œâ n the damping coefficient can be calculated as 2852 42 n s m in this regard the chosen electromagnetic device parameters which satisfy the desired design for damping coefficient are listed in table 1 5 system parameters the parameter values of the baseline monopile owt and the soil effects are presented in this section in this paper the nrel 5 mw oc3 monopile wind turbine model jonkman et al 2009 is used the parameters are listed in table 2 the soil effect is modeled with linear springs and dash pots to represent the clay soil condition the spring stiffnesses are equal to k x k y 3 89 e 9 n m k x œï k y œï 1 14 e 11 n m r a d also the soil damping properties are equal to Œ∂ x Œ∂ y Œ∂ x œï Œ∂ y œï 0 6 carswell et al 2015 6 simulation and results in this section the performance of the 3d ptmd in mitigating the bi directional vibration of the owt is evaluated and the harnessed energy from the energy harvester is determined structural responses of the wind turbine are calculated through numerically solving eq 10 the mean wind velocity is considered to be 12 m s with a turbulent intensity of 10 and the significant wave height is assumed to be 2 m based on preceding discussions a suggested mass ratio of 2 is utilized and the corresponding optimal frequency ratio and damping ratio are f o p t 0 97 and Œæ o p t 10 fig 10 a d shows the nacelle fore aft displacement time history comparison between the 3d ptmd and the uncontrolled owt under the four wind wave misalignment angles it can be found that the 3d ptmd is able to mitigate the vibrations of the owt in the fore aft direction according to the data presented in fig 10 the 3d ptmd is able to reduce the rms of nacelle displacement in fore aft direction by 70 fig 11 a d shows the nacelle side side response mitigation comparison where it is indicated that the 3d ptmd can mitigate the nacelle side side response under different wind wave misalignment angles the 3d ptmd is able to mitigate the displacement of owt in the side side direction by around 77 it should be noted that the side side motion is minimal when the wind and wave loadings are aligned as shown in fig 11 a figs 12 and 13 illustrate the generated voltage time history comparison between the coupled and uncoupled energy harvester models in the fore aft and side side directions under four wind wave misalignment angles it should be noted that a 50 s time window is used to show the differences clearly one can observe the difference between the results from the uncoupled and coupled models quantitatively the generated voltage calculated using the coupled model is 7 smaller than that via the uncoupled model the reason for the small difference between the coupled and uncoupled energy harvester models is the low frequency feature of the primary structure and the small value of the inductance the inductance value for the considered electromagnetic damper is equal to 0 02 h which is a small value the generated power in the fore aft direction under different wind and wave misalignments is illustrated in fig 14 a d one can find that the generated electrical power decreases when increasing the wind and wave misalignment angle the average generated electrical power in fore aft direction for 0 30 60 and 90 wind wave misalignment angle is 792 594 203 and 2 8 w respectively the generated power in the side side direction under different wind and wave misalignments is illustrated in fig 15 a d the average generated electrical power in side side direction for 0 30 60 and 90 wind wave misalignment angle is 0 205 615 and 820 w respectively it can be seen that increasing the wind and wave misalignment angle will result in an increase in the generated electrical power 7 conclusions in the present paper a 3d ptmd with an energy harvester is utilized to control the bi directional vibration of the monopile owts through converting the kinetic energy into electrical power an analytical model of the monopile owt coupled with the 3d ptmd and the energy harvester is established linear electromagnetic devices are used instead of traditional viscous dampers to convert the kinetic energy of the pendulum into electrical power the performance of the 3d ptmd energy harvester system in reducing the response and harvesting the kinetic energy is evaluated based on the presented results the following conclusions can be obtained 1 the 3d ptmd energy harvester system is able to reduce the nacelle vibrations in the fore aft and side side directions significantly quantitatively the 3d ptmd can reduce the nacelle rms response by 70 in the fore aft direction and 77 in the side side direction 2 instead of dissipating the kinetic energy into heat the linear electromagnetic devices are implemented to convert the motion of the 3d ptmd into electrical power theoretical results indicate that considerable amount of energy with a magnitude of kw can be produced which can be used to power sensors and actuators for the structural health monitoring and control systems 3 the difference of the generated electrical voltage between coupled and uncoupled energy harvester models is around 7 using the parameter values selected in the present study the small difference for the generated electrical power between the coupled and uncoupled energy harvester is because of the low frequency feature of the primary system and small value of coil inductance it can be concluded that for low frequency structures such as high rise buildings bridges owts and etc uncoupled equations for the energy harvester can be used with a good accuracy 4 theoretically the generated electrical power using electromagnetic energy harvester is in orders of magnitude of kilowatts which is a considerable amount of energy to power the structural health monitoring and control devices it is important to consider the practical constraints and determine the applicable generated electrical power therefore experimental analysis to evaluate the findings of this paper will be implemented in future study acknowledgment this work was supported by louisiana state university start up fund fund number is 127150013 louisiana state university hurricane resilience research institute award awd 001823 and industrial ties research subpro gram of louisiana state board of regents awd 001515 usa this work was also supported by key laboratory of performance evolution and control for engineering structures of ministry of education tongji university grant no 2018kf 6 china the authors are grateful for all the support 
