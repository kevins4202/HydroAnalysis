index,text
21890,automatic identification system ais trajectory data are collected from multiple sensors that record dynamic and static ship information ais sequences and records are affected by subjective ship officer behavior such as collision avoidance decision making and good seamanship therefore it is necessary to recognize ship handling behavior patterns in ais data when conducting ship collision avoidance research and developing routing plans here we propose a new method for recognizing a unique ship handling behavior pattern based on multi step sub trajectory clustering analysis 1 ais trajectories are segmented to generate sub trajectories and defined through 7 tuple coding 2 7 tuple data dimensionality reduction and data visualization are conducted using the t distributed stochastic neighbor embedding t sne algorithm and 3 sub trajectory clustering based on the spectral clustering algorithm is used for behavior pattern recognition the identified segments are used to define unique ship handling behavior and are referred to here as ship handling behavior basic shbb this approach can help to further understand and clarify ship handling behavior patterns while greatly improving machine learning efficiency with regard to research and planning for ship collision avoidance decision making route planning and anomalous behavior detection keywords ship handling behavior basic sub trajectory clustering 7 tuple coding t sne spectral clustering 1 introduction according to the international convention for safety of life at sea solas from 2002 onward all ships of more than 300 gross tonnage on international voyages all cargo ships of more than 500 gross tonnage and all passenger ships are required to install automatic identification system ais equipment as the shore based and space borne ais network has matured effective all day tracking of ship navigation has been achieved resulting in increasing quantities of ais trajectory data these data have been increasingly used in maritime big data cloud computing and machine learning research as they are the standard time series data in this field however many hidden factors affect the navigational patterns recorded by ais data such as the seamanship of officers ship maneuverability geography and rules of collision avoidance at sea analyses of ship trajectories can be used to identify ship handling behavior the collective behavioral pattern produced by a combination of the vessel s physical characteristics the habits of its officers and other influencing factors such as the surrounding environment this concept is helpful for studying marine traffic flow in higher detail designing navigational aids and developing traffic management rules and related regulations similar patterns of ship behavior can be identified using clustering analysis also known as group analysis a statistical classification method for samples or indicators that is an important pre processing step for data mining yao et al 2018 clustering algorithms are a typical class of unsupervised machine learning algorithms that can automatically classify data by similarity measurements without further context in recent years many studies have applied data mining and cluster analysis to ship trajectory data with most clustering methods being divided into three categories yuan et al 2017 1 clustering the ship trajectory as a whole using the entire ais trajectory as a clustering unit to perform calculations this method has two disadvantages a the overall clustering ignores most local features resulting in feature loss and b the two types of trajectories after clustering tend to overlap making the method less effective the use of dynamic time warping dtw can effectively measure the degree of similarity between trajectories of varying lengths but local features will still be ignored overall and the longer the trajectory the more features will be ignored li et al 2017 zhao and shi 2019 used the douglas peuker dp algorithm to compress the ais trajectory furthermore they used density based spatial clustering of applications with noise dbscan clustering however the dbscan is sensitive to data point density and using dp reduces the density thereby affecting the fern results of dbscan zhen et al 2017 investigated the spatial and directional characteristics of ais improved hausdorff distance by using the k medoid algorithm when clustering a ship trajectory vries and someren 2014 analyze the application of the two main types of similarity measures for moving object trajectories in machine learning from vessel movement data 2 clustering individual point data this is the most common method used to cluster ais data mostly based on the latitude and longitude this approach has two shortcomings a abandoning the shape characteristics of the trajectory by simply clustering through points cannot properly model the global trajectory features and motion trends and b the requirements for and influence of data volume are relatively high common approaches include k means yang et al 2019 and dbscan bin et al 2008 gariel et al 2011 zhang et al 2018b in the first layer the turning points are clustered using the dbscan clustering algorithm with respect to a set of criteria in the second layer the top 10 percent of cluster groups in the first layer s clustering result are selected and then these groups are clustered again using the dbscan clustering algorithm with respect to the relatively strict criteria boem et al 2011 presented a methodology based on earth mover s distance emd 3 clustering sub trajectories clustering in quest clique this approach segments the ais trajectory and clusters the segmented sub trajectories ensuring that neither local features nor the trajectory trend is lost the characteristics of the current ais trajectory should be dissimilar in general and overlap one other the trajectories play different roles in different time space and geographical environments lee et al 2007 proposed a partition and group framework based on the minimum description length then developed the trajectory clustering traclus algorithm based on dbscan nanni and pedreschi 2006 proposed a measure of similarity between the trajectories of a time interval using the ordering points to identify the clustering structure optics algorithm to cluster the trajectory segments before determining the appropriate time interval by repeated clustering luke and lee 2015 propose a general trajectory clustering methodology which can detect clusters using any arbitrary number of the n dimensions available in the data ship trajectories are best considered as a movement path in a specific environment at a specific time rather than a collection of data points sorted by time so when analyzing ship handling behavior characteristics such as distance direction speed and time should be considered unlike road traffic ship trajectories follow no clear route defined by obstacles only recommended routes of various types strict compliance with the routing system depends on ship officers seamanship so trajectories have a certain level of subjectivity that result in overall dissimilarity and local segment similarity as shown in fig 1 therefore clustering overall trajectories will lose important local information while clustering discrete points will lose the trend characteristics between points in this paper we propose a new method for ais sub trajectory segment clustering and classifying ship trajectories based on 7 tuple coding and the t sne and spectral clustering algorithms the identified segments are used to define unique ship handling behavior and are referred to here as shbb fig 2 summarizes the proposed procedure and the identification process of shbb based on ais trajectory data is shown in fig 3 the rest of this paper is organized as follows in section 2 a sliding window algorithm is used to identify feature points in ais trajectory data for details please refer to the authors other paper gao and shi 2019 which provides a comparison between the sliding window and douglas peuker algorithms the ais trajectory is cut at these points to generate sub trajectory segments a 7 tuple sequence is then constructed as a representation of a sub trajectory segment in section 3 in order to solve dimensionality and visualization problems a t sne algorithm is used to reduce the dimensionality of the data which provides a comparison with the neural network autocoder and maps the 7 tuple to 3d space in section 4 a spectral clustering algorithm is used to cluster the sub trajectory segments for behavior pattern recognition furthermore this section presents a comparison between our algorithm and the dbscan algorithm in section 5 we propose a method to define unique ship handling behavior sections 6 and 7 present the experimental verification and concluding remarks respectively 2 sub trajectory segment generation 2 1 sliding window key feature point extraction the complete ais trajectory requires reasonable cutting using a specific algorithm so that both the local characteristics and the overall trend of the trajectory are retained most algorithms use the euclidean vertical distance as the selection criterion for the key feature points kfps of the trajectory in which only spatial position data are considered the time information in the ais data are only used as an index for sorting and the spatio temporal characteristics of the data are considered even less however because ship ais data record not only latitude and longitude but also speed heading and time these can be used to more accurately define the ship s spatio temporal behavior table 1 presents the ais data structure in the proposed feature extraction process points p 1 l 1 b 1 t 1 p 2 l 2 b 2 t 2 and p 3 l 3 b 3 t 3 are located in the initial window where b is the ais latitude l is the ais longitude and t is the ais time using time t 2 of point p 2 l 2 b 2 t 2 as an index the difference between p 1 l 1 b 1 t 1 and p 3 l 3 b 3 t 3 can be calculated as p 2 l 2 b 2 t 2 1 δ i t i t s 2 δ e t e t s 3 b i b s δ i δ e b e b s 4 l i l s δ i δ e l e l s where δ i is the elapsed time from initial point to check point and δ e is the elapsed time from initial point to end point t i is the ais time of the point i t s is the ais time of the start point and t e is the ais time of the end point then 5 q ln tan π 4 b 2 1 e sin b 1 e sin b e 2 δ x a d l δ y a q 2 q 1 a arc tan 2 δ x δ y 6 s s b 2 s b 1 cos a δ b 0 r 1 δ l δ b 0 7 r 1 a cos b 1 1 e 2 sin 2 b 1 where q is the isometric latitude q 1 is the isometric latitude at latitude b 1 q 2 is the isometric latitude at latitude b 2 r 1 is the latitude radius at latitude b 1 x is the horizontal coordinate difference in the mercator coordinate system y is the vertical coordinate difference in the mercator coordinate system s is the length of a straight line between two points and a is the relative azimuth angle if d is less than the threshold d t then the relative azimuth angle from p 1 to p 2 is calculated and named a 1 the p 1 heading is called a 0 and the difference between a 1 and a 0 must be less than the calculated angle threshold a if this condition is satisfied p 2 can be deleted accomplishing feature extraction the improved sliding window algorithm is shown in fig 4 details on the operation steps and principles can be found in a previous paper gao and shi 2019 where d is the length of a vertical line between one point and the other line d t is the distance threshold and a t is the angle threshold the result of extraction by the sliding window algorithm is shown in fig 5 the blue triangle represents the extracted kfps and the red line represents the ais original trajectory 2 2 7 tuple coding the trajectory data extracted by the sliding window algorithm are truncated at the kfps and the ais trajectory data are fragmented to obtain the ship motion trajectory units each unit is stored as the smallest segment of the ship trajectory we propose using a 7 tuple to encode the ship handling behavior unit q d ss se das dae t where q is the azimuth from start point to end point d is the distance from start point to end point ss is the speed at the start point se is the speed at the end point das is the drift angle at the start point dae is the drift angle at the endpoint and t is the time from start point to end point fig 6 among the seven variables q d and t describe the overall trend of the ship s sub trajectory segments and se ss dae and das provide local ship state information by describing the two endpoints of the ship trajectory unit these latter four variables can be used for subsequent re splicing of the trajectory unit and the basis for ship trajectory planning the 7 tuple group provides new solutions and new ideas for describing the ship sub trajectory segment subsequent ship trajectory planning ship handling behavior analysis ship data re storage or reconstruction sang et al 2015 zhang et al 2018a and ship trajectory prediction piotr 2017 this study selects ais data of the tianjin port in december 2015 cuts a total of 499 385 ship sub trajectory segments and performs the 7 tuple code some of the 7 tuple sequences are shown in table 2 and the trajectory corresponding to the data in table 2 is shown in fig 7 2 3 ship ais trajectory units however not all cut ais sub trajectory segments can be referred to as ais trajectory units the ais data is broadcasted through the vhf channel thus there is a great risk that data will be lost or that erroneous data will be generated during the transmission among the data we received there are many ais data with abnormal speed or heading in addition there is a large portion of data such as the length of a single trajectory unit over 50 000 m that is certainly very unreasonable such a unit may exist but it is not the ship handling behavior unit mentioned in this article if this data is included in the subsequent 3d mapping and clustering the subsequent clustering effect will be seriously influenced thus a relatively small amount of data in the ais sub trajectory segment data is considered to be special data in this study therefore the distance parameter d values of the trajectory unit are filtered as shown in fig 8 the x axis indicates the maximum distance and the y axis indicates the ratio of the number of units in the x range to the total number of units it can be seen that the distance exceeds a certain range m n the number of trajectory units is significantly reduced and the number of trajectory units increases slowly as the maximum distance increases the parameter d takes a very large value owing to the small amount of data if additional calculations are included the result of the cluster analysis can be severely affected therefore data in the mn phase are identified as noise data for cleaning and elimination to analyze the distribution of the number of 7 tuple groups in each distance interval the number of 7 tuple is counted at intervals of 50 m and the results are shown in fig 9 the 7 tuple is filtered according to the amount of data in the interval it can be seen that fig 10 and table 3 in the short distance occur the step phenomenon at 350 400 so this paper uses the local minimum value 746 of the first half is used as the quantity standard to find the value of the second half of 4550 4600 fig 11 and table 4 as the upper distance limit of the trajectory handling unit the number of drift angles is counted according to the same screening principle fig 12 it can be seen that the drift angle data is normally distributed and the drift angle interval in the horizontal axis is selected as μ σ μ σ for a drift angle constraint of 15 5 16 3 t sne 3d mapping for shbb visualization 3 1 t sne description in order to describe the sub trajectory in multiple directions multiple parameters and high dimensional space representations are used although the sub trajectory is considered comprehensive high dimensional data will result in a major obstacle for subsequent data analysis operations similarity function setting and visualization data dimensionality reduction algorithms have many advantages for data processing including a mitigating dimensional disasters and increasing sample density b re enabling the algorithm based on the euclidean distance c removing data redundancy and reducing the signal to noise ratio and d data visualization and intuitive viewing existing dimensionality reduction algorithms include principal components analysis pca t sne and autoencoder five data types are needed to map the 7 tuple data to 3d space we used the t sne algorithm to reduce the dimensionality the t sne laurens and geoffrey 2008 algorithm models the distribution of neighbors of each data point where neighbors are collections of data points that are close to each other the original high dimensional space is modelled as a gaussian distribution while the low dimensional output space is modelled as a t distribution this process is intended to find the transformation that maps high dimensional space to low dimensional space and minimizes the gaps between all points helping the data points to be more evenly distributed in low dimensional spaces this occurs in four steps 1 the high dimensional euclidean distance between data points is converted into a conditional probability of similarity the conditional probability p j i between data points x i to x j fig 13 8 p j i exp x i x j 2 2 σ i 2 k i exp x i x k 2 2 σ i 2 this can be seen in fig 13 where σi is the gaussian variance centered on the data point x i 2 the method for determining the value of σi is presented later in this section because we are only interested in modeling pairwise similarities we set the value of pi i as 0 for the low dimensional counterparts y i and y j of the high dimensional datapoints x i and x j it is possible to compute a similar conditional probability denoted as qj i we set the value of qi i as 0 9 q j i exp y i y j 2 k i exp y i y k 2 3 to measure the sum and minimum of the conditional probability differences sne uses the gradient descent method to minimize the kl distance while the cost function of sne focuses on the local structure of the data in the map it is very difficult to optimize the function and t sne uses a heavy tailed distribution to alleviate the congestion problem and optimize sne the cost function of sne is shown below 10 c i k l p i q i i j p j i log p j i q j i 4 the remaining parameter to be selected is the gaussian variance σi that is centered over each high dimensional datapoint x i this distribution has an entropy which increases as σi increases sne performs a binary search for the value of σi that produces a p i with a fixed perplexity that is defined as 11 p e r p p i 2 h p i where h pi is the shannon entropy of p i measured in bits 12 h p i j p j i log 2 p j i 3 2 dimensionality reduction effect comparison in order to test the superior visualization ability of the t sne method proposed here we tested the 7 tuple data with both the t sne fig 14 and neural network autocoder fig 15 algorithms the latter had problems with data crowding along the edge of the three dimensional space while the former had a more reasonable result distribution that was more easily interpretable visually dimensional reduction by t sne not only maintains the data difference but also maintains the local structure of the data well sne changes the concept behind the distance invariant in mds and isomap when mapping high dimensional data to low dimensional data it attempts to ensure that the distribution probability remains unchanged in order to effectively solve the data congestion problem 4 improved spectral clustering 4 1 spectral clustering description spectral clustering evolved from graph theory chang and yeung 2008 the main concept of the spectral clustering algorithm is to treat all the data as points in space which can be connected by edges the edge weight value between two distant points is lower and the edge weight value between two closer distances is higher the cut feature of spectral clustering is shown in fig 16 different cut graphs can be obtained by cutting the graph composed of all the data points the weights between subgraphs are as low as possible and the weights in subgraphs are as high as possible thus achieving the aim of clustering this study is based on the njw clustering method proposed by using multipath spectral clustering li and guo 2012 ng et al 2001 the flow chart of the algorithm is as follows input x1 x2 x3 xn output c1 c2 c3 ck step 1 input ais data step 2 construct a similarity matrix s an adjacency matrix w and a degree matrix d step 3 construct a laplacian matrix s step 4 standardize the matrices step 5 find the eigenvector f corresponding to the smallest k eigenvalues and construct the feature matrix step 7 perform k means clustering output c1 c2 c3 ck compared with the traditional clustering algorithm the spectral clustering algorithm is insensitive to the initial input data and has the ability to identify non convex data it is easy to understand and has a low time complexity at present in the maritime field dbscan algorithms are more commonly used however the clustering effect of such algorithms is considerably dependent on the input parameters and the clustering results exhibit large fluctuations and are sensitive to the initial data further they do not consider the overall shape of the trajectory features their memory usage is high and their operation is slow in contrast the k means algorithm is a simple and fast clustering algorithm when processing large data sets the high quality data scaling efficiency can be maintained depending on the cluster density however this algorithm can easily cause a local optimum it is not suitable for non convex sets and is sensitive to noise it is generally used in spectral clustering for low dimensional matrix clustering after high dimensional processing when the number of clusters is known k means can often achieve very good results and the impact on the values of abnormal data will be smaller for clustering with regard to ship maneuvering behavior the navigational history can be used as an artificial orientation the k means algorithm is generally suitable for classifying clusters with a known amount of numbers while the spectral clustering algorithm is more flexible from an algorithmic point of view spectral clustering is similar to k means and the cluster centers are determined by iterative operations of the sample mean the spectral clustering algorithm adds some heuristics and can be combined with the structure of the man machine interaction to improve classification using the experience gained from intermediate results the ship handling behavior is roughly divided into small scale acceleration and deceleration 4 clusters large scale acceleration and deceleration 4 clusters and steady navigation 1 cluster thus an approximate initial cluster value can be given by the existing history we set the number of cluster centers from 3 to 25 and the γ value from the set 0 001 0 01 0 1 1 10 100 the score values with a change in each parameter are shown in table 5 if more than 16 are used in the experiment divergence will occur subsequent scores are getting higher and higher and since there is no upper limit can t find a reasonable solution for more than 16 kinds of ship maneuvering behavior units this method is too thin and very difficult for its rationality and applicability in addition the distinction between the two classes is little the significance of the research is gone hence it is not a high score however the effect is good when combined with the experience of navigation practice with 9 as the benchmark find 11 centers that are relatively better than the 9 clusters as the final application parameters fig 17 is the map of spectral clustering scores with the number of cluster centers from 3 to 16 the spectral clustering parameters were set as γ 0 001 n cluster 11 to obtain the maximum score of 1285 3155295029424 4 2 clustering result comparison the spectral clustering parameters were set as gamma 0 001 n cluster 11 and the dbscan parameters were set as ε 1 and minpts 3 for experimental comparison data we selected navigation trajectories on march 10th 2017 for 10 ships within the laotieshan channel 117 394685 e 120 280701666 e 38 1583 n 39 166176666 n at the entrance to china s bohai sea representing 126408 total ais data points fig 18 the spectral clustering algorithm identified 11 clusters by with a relatively uniform distribution in 3d space with relatively uniform cluster quantities figs 19 and 20 in comparison the dbscan algorithm identified 4 clusters with far higher differences in quantity figs 21 and 22 the spectral clustering results were thus closer to the estimated 9 types of cases and so were more in line with the actual distribution of ship handling behavior 5 shbb the concept of shbb is derived from a basic concept in the linear space of a mathematical field in the linear space v if 1 there are n elements α1 α2 αn 2 α1 α2 αn are linearly independent 3 α v and can be linearly represented by α1 α2 αn then α1 α2 αn are called linear a base of the space v n is called the dimension of the linear space v and the space v is called a linear space formed by the base α1 α2 αn denoted as v span α1 α2 αn the ship behavior handling unit is derived from the real ais trajectory data extracts the ship s handling behavior unit identifies the shbb label for the ship trajectory unit through spectral clustering and finally sets up the ship handling behavior space shbs as the elements of shbs shbbs are independent of each other the shbb linear combination of any sequence from the complete shbs can generate arbitrary ship handling behavior decisions recognize the continuous ship handling behavior from the ais trajectory and perform the subsequent ais big data decision coding and subsequent provides new method and means for ship collision avoidance decision research based on this approach a complete ship trajectory can be mapped as a continuous sequence of shbbs fig 23 an entire ship s trajectory can be represented as 0a 0 8b 6c 47 4c 78c 78 8d 76b where the number indicates the angle of rotation clockwise positive counterclockwise negative and indicates that the shbb image is flipped this unified storage format enables encoding and the actual trajectory can be reversibly encoded the generated image is easy for researchers to interpret while the sequence encoding is convenient for machine input and learning 6 experimental verification a comparison of the original ais trajectory fig 24 with the trajectory developed from shbb fig 25 shows that the ship s ais trajectory generally follows a pattern of overall trajectory dissimilarity and local segment similarity by analyzing the characteristics of the shbb sequence encoding we can obtain the action points table 6 shows the ais data of the single ship fig 26 shows the ais trajectory data of single ship table 7 shows the seven member trajectory of the ais fig 27 shows the seven member trajectory 3d mapping and fig 28 shows the process of establishing a single ais trajectory of the ship through the action points 7 conclusions in this paper we propose a new statement of shbb and a new method for considering ship handling behavior when analyzing ais trajectory data a sliding window algorithm is used to identify kfps and segment the trajectory to generate sub trajectory segments next 7 tuple sets are constructed to represent the sub trajectory segments for encoding the ship s ais sub trajectory the t sne algorithm is used to reduce data dimensionality and the 7 tuple is mapped to 3d space for improved visualization finally the spectral clustering algorithm is used to cluster the sub trajectory segments to identify the shbbs which can be used to recreate a more representative trajectory we believe our proposed statement will provide a new method and viewpoint to navigation research this approach can help to further understand and clarify ship handling behavior patterns while greatly improving machine learning efficiency with regard to research and planning for ship collision avoidance decision making ship route planning and anomalous behavior detection based on this research potential future studies will involve further discussion and exploration of the splicing rules of shbb we can also use the continuous splicing of the shbb sequence as the next machine learning study on the decision coding method of ship handling and use intelligent collision avoidance as the basis of decision making credit authorship contribution statement miao gao conceptualization software writing original draft writing review editing guo you shi supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this project was supported partially by national natural science foundation of china 51579025 51709165 the provincial natural science foundation of liaoning 20170540090 and supported by navigation college of dalian maritime university 
21890,automatic identification system ais trajectory data are collected from multiple sensors that record dynamic and static ship information ais sequences and records are affected by subjective ship officer behavior such as collision avoidance decision making and good seamanship therefore it is necessary to recognize ship handling behavior patterns in ais data when conducting ship collision avoidance research and developing routing plans here we propose a new method for recognizing a unique ship handling behavior pattern based on multi step sub trajectory clustering analysis 1 ais trajectories are segmented to generate sub trajectories and defined through 7 tuple coding 2 7 tuple data dimensionality reduction and data visualization are conducted using the t distributed stochastic neighbor embedding t sne algorithm and 3 sub trajectory clustering based on the spectral clustering algorithm is used for behavior pattern recognition the identified segments are used to define unique ship handling behavior and are referred to here as ship handling behavior basic shbb this approach can help to further understand and clarify ship handling behavior patterns while greatly improving machine learning efficiency with regard to research and planning for ship collision avoidance decision making route planning and anomalous behavior detection keywords ship handling behavior basic sub trajectory clustering 7 tuple coding t sne spectral clustering 1 introduction according to the international convention for safety of life at sea solas from 2002 onward all ships of more than 300 gross tonnage on international voyages all cargo ships of more than 500 gross tonnage and all passenger ships are required to install automatic identification system ais equipment as the shore based and space borne ais network has matured effective all day tracking of ship navigation has been achieved resulting in increasing quantities of ais trajectory data these data have been increasingly used in maritime big data cloud computing and machine learning research as they are the standard time series data in this field however many hidden factors affect the navigational patterns recorded by ais data such as the seamanship of officers ship maneuverability geography and rules of collision avoidance at sea analyses of ship trajectories can be used to identify ship handling behavior the collective behavioral pattern produced by a combination of the vessel s physical characteristics the habits of its officers and other influencing factors such as the surrounding environment this concept is helpful for studying marine traffic flow in higher detail designing navigational aids and developing traffic management rules and related regulations similar patterns of ship behavior can be identified using clustering analysis also known as group analysis a statistical classification method for samples or indicators that is an important pre processing step for data mining yao et al 2018 clustering algorithms are a typical class of unsupervised machine learning algorithms that can automatically classify data by similarity measurements without further context in recent years many studies have applied data mining and cluster analysis to ship trajectory data with most clustering methods being divided into three categories yuan et al 2017 1 clustering the ship trajectory as a whole using the entire ais trajectory as a clustering unit to perform calculations this method has two disadvantages a the overall clustering ignores most local features resulting in feature loss and b the two types of trajectories after clustering tend to overlap making the method less effective the use of dynamic time warping dtw can effectively measure the degree of similarity between trajectories of varying lengths but local features will still be ignored overall and the longer the trajectory the more features will be ignored li et al 2017 zhao and shi 2019 used the douglas peuker dp algorithm to compress the ais trajectory furthermore they used density based spatial clustering of applications with noise dbscan clustering however the dbscan is sensitive to data point density and using dp reduces the density thereby affecting the fern results of dbscan zhen et al 2017 investigated the spatial and directional characteristics of ais improved hausdorff distance by using the k medoid algorithm when clustering a ship trajectory vries and someren 2014 analyze the application of the two main types of similarity measures for moving object trajectories in machine learning from vessel movement data 2 clustering individual point data this is the most common method used to cluster ais data mostly based on the latitude and longitude this approach has two shortcomings a abandoning the shape characteristics of the trajectory by simply clustering through points cannot properly model the global trajectory features and motion trends and b the requirements for and influence of data volume are relatively high common approaches include k means yang et al 2019 and dbscan bin et al 2008 gariel et al 2011 zhang et al 2018b in the first layer the turning points are clustered using the dbscan clustering algorithm with respect to a set of criteria in the second layer the top 10 percent of cluster groups in the first layer s clustering result are selected and then these groups are clustered again using the dbscan clustering algorithm with respect to the relatively strict criteria boem et al 2011 presented a methodology based on earth mover s distance emd 3 clustering sub trajectories clustering in quest clique this approach segments the ais trajectory and clusters the segmented sub trajectories ensuring that neither local features nor the trajectory trend is lost the characteristics of the current ais trajectory should be dissimilar in general and overlap one other the trajectories play different roles in different time space and geographical environments lee et al 2007 proposed a partition and group framework based on the minimum description length then developed the trajectory clustering traclus algorithm based on dbscan nanni and pedreschi 2006 proposed a measure of similarity between the trajectories of a time interval using the ordering points to identify the clustering structure optics algorithm to cluster the trajectory segments before determining the appropriate time interval by repeated clustering luke and lee 2015 propose a general trajectory clustering methodology which can detect clusters using any arbitrary number of the n dimensions available in the data ship trajectories are best considered as a movement path in a specific environment at a specific time rather than a collection of data points sorted by time so when analyzing ship handling behavior characteristics such as distance direction speed and time should be considered unlike road traffic ship trajectories follow no clear route defined by obstacles only recommended routes of various types strict compliance with the routing system depends on ship officers seamanship so trajectories have a certain level of subjectivity that result in overall dissimilarity and local segment similarity as shown in fig 1 therefore clustering overall trajectories will lose important local information while clustering discrete points will lose the trend characteristics between points in this paper we propose a new method for ais sub trajectory segment clustering and classifying ship trajectories based on 7 tuple coding and the t sne and spectral clustering algorithms the identified segments are used to define unique ship handling behavior and are referred to here as shbb fig 2 summarizes the proposed procedure and the identification process of shbb based on ais trajectory data is shown in fig 3 the rest of this paper is organized as follows in section 2 a sliding window algorithm is used to identify feature points in ais trajectory data for details please refer to the authors other paper gao and shi 2019 which provides a comparison between the sliding window and douglas peuker algorithms the ais trajectory is cut at these points to generate sub trajectory segments a 7 tuple sequence is then constructed as a representation of a sub trajectory segment in section 3 in order to solve dimensionality and visualization problems a t sne algorithm is used to reduce the dimensionality of the data which provides a comparison with the neural network autocoder and maps the 7 tuple to 3d space in section 4 a spectral clustering algorithm is used to cluster the sub trajectory segments for behavior pattern recognition furthermore this section presents a comparison between our algorithm and the dbscan algorithm in section 5 we propose a method to define unique ship handling behavior sections 6 and 7 present the experimental verification and concluding remarks respectively 2 sub trajectory segment generation 2 1 sliding window key feature point extraction the complete ais trajectory requires reasonable cutting using a specific algorithm so that both the local characteristics and the overall trend of the trajectory are retained most algorithms use the euclidean vertical distance as the selection criterion for the key feature points kfps of the trajectory in which only spatial position data are considered the time information in the ais data are only used as an index for sorting and the spatio temporal characteristics of the data are considered even less however because ship ais data record not only latitude and longitude but also speed heading and time these can be used to more accurately define the ship s spatio temporal behavior table 1 presents the ais data structure in the proposed feature extraction process points p 1 l 1 b 1 t 1 p 2 l 2 b 2 t 2 and p 3 l 3 b 3 t 3 are located in the initial window where b is the ais latitude l is the ais longitude and t is the ais time using time t 2 of point p 2 l 2 b 2 t 2 as an index the difference between p 1 l 1 b 1 t 1 and p 3 l 3 b 3 t 3 can be calculated as p 2 l 2 b 2 t 2 1 δ i t i t s 2 δ e t e t s 3 b i b s δ i δ e b e b s 4 l i l s δ i δ e l e l s where δ i is the elapsed time from initial point to check point and δ e is the elapsed time from initial point to end point t i is the ais time of the point i t s is the ais time of the start point and t e is the ais time of the end point then 5 q ln tan π 4 b 2 1 e sin b 1 e sin b e 2 δ x a d l δ y a q 2 q 1 a arc tan 2 δ x δ y 6 s s b 2 s b 1 cos a δ b 0 r 1 δ l δ b 0 7 r 1 a cos b 1 1 e 2 sin 2 b 1 where q is the isometric latitude q 1 is the isometric latitude at latitude b 1 q 2 is the isometric latitude at latitude b 2 r 1 is the latitude radius at latitude b 1 x is the horizontal coordinate difference in the mercator coordinate system y is the vertical coordinate difference in the mercator coordinate system s is the length of a straight line between two points and a is the relative azimuth angle if d is less than the threshold d t then the relative azimuth angle from p 1 to p 2 is calculated and named a 1 the p 1 heading is called a 0 and the difference between a 1 and a 0 must be less than the calculated angle threshold a if this condition is satisfied p 2 can be deleted accomplishing feature extraction the improved sliding window algorithm is shown in fig 4 details on the operation steps and principles can be found in a previous paper gao and shi 2019 where d is the length of a vertical line between one point and the other line d t is the distance threshold and a t is the angle threshold the result of extraction by the sliding window algorithm is shown in fig 5 the blue triangle represents the extracted kfps and the red line represents the ais original trajectory 2 2 7 tuple coding the trajectory data extracted by the sliding window algorithm are truncated at the kfps and the ais trajectory data are fragmented to obtain the ship motion trajectory units each unit is stored as the smallest segment of the ship trajectory we propose using a 7 tuple to encode the ship handling behavior unit q d ss se das dae t where q is the azimuth from start point to end point d is the distance from start point to end point ss is the speed at the start point se is the speed at the end point das is the drift angle at the start point dae is the drift angle at the endpoint and t is the time from start point to end point fig 6 among the seven variables q d and t describe the overall trend of the ship s sub trajectory segments and se ss dae and das provide local ship state information by describing the two endpoints of the ship trajectory unit these latter four variables can be used for subsequent re splicing of the trajectory unit and the basis for ship trajectory planning the 7 tuple group provides new solutions and new ideas for describing the ship sub trajectory segment subsequent ship trajectory planning ship handling behavior analysis ship data re storage or reconstruction sang et al 2015 zhang et al 2018a and ship trajectory prediction piotr 2017 this study selects ais data of the tianjin port in december 2015 cuts a total of 499 385 ship sub trajectory segments and performs the 7 tuple code some of the 7 tuple sequences are shown in table 2 and the trajectory corresponding to the data in table 2 is shown in fig 7 2 3 ship ais trajectory units however not all cut ais sub trajectory segments can be referred to as ais trajectory units the ais data is broadcasted through the vhf channel thus there is a great risk that data will be lost or that erroneous data will be generated during the transmission among the data we received there are many ais data with abnormal speed or heading in addition there is a large portion of data such as the length of a single trajectory unit over 50 000 m that is certainly very unreasonable such a unit may exist but it is not the ship handling behavior unit mentioned in this article if this data is included in the subsequent 3d mapping and clustering the subsequent clustering effect will be seriously influenced thus a relatively small amount of data in the ais sub trajectory segment data is considered to be special data in this study therefore the distance parameter d values of the trajectory unit are filtered as shown in fig 8 the x axis indicates the maximum distance and the y axis indicates the ratio of the number of units in the x range to the total number of units it can be seen that the distance exceeds a certain range m n the number of trajectory units is significantly reduced and the number of trajectory units increases slowly as the maximum distance increases the parameter d takes a very large value owing to the small amount of data if additional calculations are included the result of the cluster analysis can be severely affected therefore data in the mn phase are identified as noise data for cleaning and elimination to analyze the distribution of the number of 7 tuple groups in each distance interval the number of 7 tuple is counted at intervals of 50 m and the results are shown in fig 9 the 7 tuple is filtered according to the amount of data in the interval it can be seen that fig 10 and table 3 in the short distance occur the step phenomenon at 350 400 so this paper uses the local minimum value 746 of the first half is used as the quantity standard to find the value of the second half of 4550 4600 fig 11 and table 4 as the upper distance limit of the trajectory handling unit the number of drift angles is counted according to the same screening principle fig 12 it can be seen that the drift angle data is normally distributed and the drift angle interval in the horizontal axis is selected as μ σ μ σ for a drift angle constraint of 15 5 16 3 t sne 3d mapping for shbb visualization 3 1 t sne description in order to describe the sub trajectory in multiple directions multiple parameters and high dimensional space representations are used although the sub trajectory is considered comprehensive high dimensional data will result in a major obstacle for subsequent data analysis operations similarity function setting and visualization data dimensionality reduction algorithms have many advantages for data processing including a mitigating dimensional disasters and increasing sample density b re enabling the algorithm based on the euclidean distance c removing data redundancy and reducing the signal to noise ratio and d data visualization and intuitive viewing existing dimensionality reduction algorithms include principal components analysis pca t sne and autoencoder five data types are needed to map the 7 tuple data to 3d space we used the t sne algorithm to reduce the dimensionality the t sne laurens and geoffrey 2008 algorithm models the distribution of neighbors of each data point where neighbors are collections of data points that are close to each other the original high dimensional space is modelled as a gaussian distribution while the low dimensional output space is modelled as a t distribution this process is intended to find the transformation that maps high dimensional space to low dimensional space and minimizes the gaps between all points helping the data points to be more evenly distributed in low dimensional spaces this occurs in four steps 1 the high dimensional euclidean distance between data points is converted into a conditional probability of similarity the conditional probability p j i between data points x i to x j fig 13 8 p j i exp x i x j 2 2 σ i 2 k i exp x i x k 2 2 σ i 2 this can be seen in fig 13 where σi is the gaussian variance centered on the data point x i 2 the method for determining the value of σi is presented later in this section because we are only interested in modeling pairwise similarities we set the value of pi i as 0 for the low dimensional counterparts y i and y j of the high dimensional datapoints x i and x j it is possible to compute a similar conditional probability denoted as qj i we set the value of qi i as 0 9 q j i exp y i y j 2 k i exp y i y k 2 3 to measure the sum and minimum of the conditional probability differences sne uses the gradient descent method to minimize the kl distance while the cost function of sne focuses on the local structure of the data in the map it is very difficult to optimize the function and t sne uses a heavy tailed distribution to alleviate the congestion problem and optimize sne the cost function of sne is shown below 10 c i k l p i q i i j p j i log p j i q j i 4 the remaining parameter to be selected is the gaussian variance σi that is centered over each high dimensional datapoint x i this distribution has an entropy which increases as σi increases sne performs a binary search for the value of σi that produces a p i with a fixed perplexity that is defined as 11 p e r p p i 2 h p i where h pi is the shannon entropy of p i measured in bits 12 h p i j p j i log 2 p j i 3 2 dimensionality reduction effect comparison in order to test the superior visualization ability of the t sne method proposed here we tested the 7 tuple data with both the t sne fig 14 and neural network autocoder fig 15 algorithms the latter had problems with data crowding along the edge of the three dimensional space while the former had a more reasonable result distribution that was more easily interpretable visually dimensional reduction by t sne not only maintains the data difference but also maintains the local structure of the data well sne changes the concept behind the distance invariant in mds and isomap when mapping high dimensional data to low dimensional data it attempts to ensure that the distribution probability remains unchanged in order to effectively solve the data congestion problem 4 improved spectral clustering 4 1 spectral clustering description spectral clustering evolved from graph theory chang and yeung 2008 the main concept of the spectral clustering algorithm is to treat all the data as points in space which can be connected by edges the edge weight value between two distant points is lower and the edge weight value between two closer distances is higher the cut feature of spectral clustering is shown in fig 16 different cut graphs can be obtained by cutting the graph composed of all the data points the weights between subgraphs are as low as possible and the weights in subgraphs are as high as possible thus achieving the aim of clustering this study is based on the njw clustering method proposed by using multipath spectral clustering li and guo 2012 ng et al 2001 the flow chart of the algorithm is as follows input x1 x2 x3 xn output c1 c2 c3 ck step 1 input ais data step 2 construct a similarity matrix s an adjacency matrix w and a degree matrix d step 3 construct a laplacian matrix s step 4 standardize the matrices step 5 find the eigenvector f corresponding to the smallest k eigenvalues and construct the feature matrix step 7 perform k means clustering output c1 c2 c3 ck compared with the traditional clustering algorithm the spectral clustering algorithm is insensitive to the initial input data and has the ability to identify non convex data it is easy to understand and has a low time complexity at present in the maritime field dbscan algorithms are more commonly used however the clustering effect of such algorithms is considerably dependent on the input parameters and the clustering results exhibit large fluctuations and are sensitive to the initial data further they do not consider the overall shape of the trajectory features their memory usage is high and their operation is slow in contrast the k means algorithm is a simple and fast clustering algorithm when processing large data sets the high quality data scaling efficiency can be maintained depending on the cluster density however this algorithm can easily cause a local optimum it is not suitable for non convex sets and is sensitive to noise it is generally used in spectral clustering for low dimensional matrix clustering after high dimensional processing when the number of clusters is known k means can often achieve very good results and the impact on the values of abnormal data will be smaller for clustering with regard to ship maneuvering behavior the navigational history can be used as an artificial orientation the k means algorithm is generally suitable for classifying clusters with a known amount of numbers while the spectral clustering algorithm is more flexible from an algorithmic point of view spectral clustering is similar to k means and the cluster centers are determined by iterative operations of the sample mean the spectral clustering algorithm adds some heuristics and can be combined with the structure of the man machine interaction to improve classification using the experience gained from intermediate results the ship handling behavior is roughly divided into small scale acceleration and deceleration 4 clusters large scale acceleration and deceleration 4 clusters and steady navigation 1 cluster thus an approximate initial cluster value can be given by the existing history we set the number of cluster centers from 3 to 25 and the γ value from the set 0 001 0 01 0 1 1 10 100 the score values with a change in each parameter are shown in table 5 if more than 16 are used in the experiment divergence will occur subsequent scores are getting higher and higher and since there is no upper limit can t find a reasonable solution for more than 16 kinds of ship maneuvering behavior units this method is too thin and very difficult for its rationality and applicability in addition the distinction between the two classes is little the significance of the research is gone hence it is not a high score however the effect is good when combined with the experience of navigation practice with 9 as the benchmark find 11 centers that are relatively better than the 9 clusters as the final application parameters fig 17 is the map of spectral clustering scores with the number of cluster centers from 3 to 16 the spectral clustering parameters were set as γ 0 001 n cluster 11 to obtain the maximum score of 1285 3155295029424 4 2 clustering result comparison the spectral clustering parameters were set as gamma 0 001 n cluster 11 and the dbscan parameters were set as ε 1 and minpts 3 for experimental comparison data we selected navigation trajectories on march 10th 2017 for 10 ships within the laotieshan channel 117 394685 e 120 280701666 e 38 1583 n 39 166176666 n at the entrance to china s bohai sea representing 126408 total ais data points fig 18 the spectral clustering algorithm identified 11 clusters by with a relatively uniform distribution in 3d space with relatively uniform cluster quantities figs 19 and 20 in comparison the dbscan algorithm identified 4 clusters with far higher differences in quantity figs 21 and 22 the spectral clustering results were thus closer to the estimated 9 types of cases and so were more in line with the actual distribution of ship handling behavior 5 shbb the concept of shbb is derived from a basic concept in the linear space of a mathematical field in the linear space v if 1 there are n elements α1 α2 αn 2 α1 α2 αn are linearly independent 3 α v and can be linearly represented by α1 α2 αn then α1 α2 αn are called linear a base of the space v n is called the dimension of the linear space v and the space v is called a linear space formed by the base α1 α2 αn denoted as v span α1 α2 αn the ship behavior handling unit is derived from the real ais trajectory data extracts the ship s handling behavior unit identifies the shbb label for the ship trajectory unit through spectral clustering and finally sets up the ship handling behavior space shbs as the elements of shbs shbbs are independent of each other the shbb linear combination of any sequence from the complete shbs can generate arbitrary ship handling behavior decisions recognize the continuous ship handling behavior from the ais trajectory and perform the subsequent ais big data decision coding and subsequent provides new method and means for ship collision avoidance decision research based on this approach a complete ship trajectory can be mapped as a continuous sequence of shbbs fig 23 an entire ship s trajectory can be represented as 0a 0 8b 6c 47 4c 78c 78 8d 76b where the number indicates the angle of rotation clockwise positive counterclockwise negative and indicates that the shbb image is flipped this unified storage format enables encoding and the actual trajectory can be reversibly encoded the generated image is easy for researchers to interpret while the sequence encoding is convenient for machine input and learning 6 experimental verification a comparison of the original ais trajectory fig 24 with the trajectory developed from shbb fig 25 shows that the ship s ais trajectory generally follows a pattern of overall trajectory dissimilarity and local segment similarity by analyzing the characteristics of the shbb sequence encoding we can obtain the action points table 6 shows the ais data of the single ship fig 26 shows the ais trajectory data of single ship table 7 shows the seven member trajectory of the ais fig 27 shows the seven member trajectory 3d mapping and fig 28 shows the process of establishing a single ais trajectory of the ship through the action points 7 conclusions in this paper we propose a new statement of shbb and a new method for considering ship handling behavior when analyzing ais trajectory data a sliding window algorithm is used to identify kfps and segment the trajectory to generate sub trajectory segments next 7 tuple sets are constructed to represent the sub trajectory segments for encoding the ship s ais sub trajectory the t sne algorithm is used to reduce data dimensionality and the 7 tuple is mapped to 3d space for improved visualization finally the spectral clustering algorithm is used to cluster the sub trajectory segments to identify the shbbs which can be used to recreate a more representative trajectory we believe our proposed statement will provide a new method and viewpoint to navigation research this approach can help to further understand and clarify ship handling behavior patterns while greatly improving machine learning efficiency with regard to research and planning for ship collision avoidance decision making ship route planning and anomalous behavior detection based on this research potential future studies will involve further discussion and exploration of the splicing rules of shbb we can also use the continuous splicing of the shbb sequence as the next machine learning study on the decision coding method of ship handling and use intelligent collision avoidance as the basis of decision making credit authorship contribution statement miao gao conceptualization software writing original draft writing review editing guo you shi supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this project was supported partially by national natural science foundation of china 51579025 51709165 the provincial natural science foundation of liaoning 20170540090 and supported by navigation college of dalian maritime university 
21891,water entry is the process in which a moving body with an initial velocity impacts the free surface and enters the water from the air and has many important applications in different fields of science and engineering in this paper a new transient model of the cavity shape by the consideration of the memory effect of the cavity is developed to predict the shape of the water entry cavity for circular cylinders and this model has been used to develop the complete model of the oblique water entry of a cylindrical projectile the proposed model could predict the impacts of the cavity on the cylinder body and it is tried to take into account all of the forces and moments which act on the projectile in order to develop an accurate model for the water entry problem the simulation results of several oblique water entry of cylindrical projectiles in different angles show that the new proposed model could predict the projectile attitude and the trajectory of the projectile with good accuracy relative to the experimental data of water entry and in a relatively shorter time of simulations compared to the numerical studies keywords mathematical modeling water entry cylindrical projectiles cavity memory effect 1 introduction water entry is the process of impacting an object on the free surface of the water and penetrating it into water understanding the mechanism of water entry has been the scope of many researchers from the past to now because of its importance in many fields of science and engineering the early researchers on the water entry were experimental using high speed photography for example may and woodhull 1950 may and woodhull 1948 studied the vertical water entry of spheres and may studied the vertical entry of missiles into the water using the high speed camera also worthington and cole 1897 used the single spark high speed photography to record the cavity shape of water entry spheres the water entry can be categorized into two different classes of high and low froude numbers for example the water entry of military projectiles such as torpedoes is often at high froude numbers where the effect of gravity is negligible one of the recently published studies on the water entry of high speed auvs was done by shi et al 2019 which presents the design and load reduction performance analysis of a mitigator their numerical simulations were based on the explicit finite element method with an arbitrary lagrangian eulerian ale solver and the accuracy of their numerical model was verified using the experimental results of the water entry of small spheres on the other hand for the low froud number case several studies on the water entry of spheres and disks with low speed can be found in the literature truscott and techet 2009 yan et al 2009 aristoff et al 2010 bergmann et al 2009 gilbarg and anderson 1948 recently li et al 2019 studied the effects of surface wettability and impact velocity on the water entry of spheres with low froude numbers the results indicated that the impact of the hydrophilic case creates a smaller splash and the hydrophilic and hydrophobic spheres experience different cavity regimes as the impact velocity increases also the hydrophobic spheres undergo higher force coefficients in the cavity forming cases also shentu et al 2019 studied the water entry of hydrophobic objects numerically based on the boundary data immersion method bdim and the volume of fluid vof method and the water crown the cavity and the flow pattern was analyzed the results indicated that the depth of pinch off increases by reducing the characteristic length of the cavity also it was shown that the pinch off time increases for the sphere with a larger density derakhshanian et al 2018 derakhshanian et al 2018 compared and evaluated three different numerical algorithms in order to find a reliable simulation tool for oblique water entry problems the first numerical algorithm was finite volume eulerian with boundary fitted adaptive grids and dynamic mesh also the volume of fluid vof model was used to capture the free surface between water and air the second algorithm was finite difference eulerian with cartesian computational grids and general moving object gmo algorithm to follow the solid boundary motion again the vof model was used to capture the free surface between water and air phases the third algorithm uses coupled eulerian lagrangian cel formulation in this method the lagrangian object can move through the eulerian domain using a contact algorithm in contrast to the previous two algorithms the cel method doesn t solve two phase flow problems however the eulerian volume fraction evf model is used to capture the free surface between water and void material the fluid dynamics of the splash cavity formation and its collapse for vertical water entry of a sphere were investigated using three numerical algorithms and compared with experimental data of water entry the results showed that the two first algorithms cannot predict the simple problem of the normal water entry of a sphere it was shown that the abaqus software third algorithm is the most capable software among the three numerical codes also the capability of the cel algorithm was evaluated for the oblique water entry problem and it was shown that the impact forces and moments can be precisely predicted even in the extreme angles and velocities of water entry the main focus of some experimental analytical or numerical studies is on the prediction of the water entry cavity shape for example abelson 1971 developed an analytical model based on the hydraulic flow model for predicting the shape of the cavity at water entry of bluff axisymmetric projectiles truscott et al 2009 developed a steady state model for the cavity shape based on the logvinovich theoretical model and with a correction of the angle of attack and guo et al 2012 presented a semi empirical cavity model for horizontal water entry of cylindrical projectiles and good agreement was observed between the obtained results of the model and the experimental results also it was shown that the maximum cavity radius decreases monotonically with the penetration distance however the presented model by guo et al is a steady state model which could not predict the transient phenomena such as the necking and pinch off of the cavity savchenko vlasenko 2003 developed an empirical model for the cavity radius in steady state conditions furthermore lee et al 1997 developed 2 d analytic models based on the theory of potential flow and duclaux et al 2007 presented an analytic model for the time evolution of the cavity based on the besant rayleigh equation also gaudet et al gaudet 1998 studied the water entry of circular disks at low froude numbers using a boundary integral method and showed that their results are in good agreement with experimental data recently wu et al 2019 studied the dynamics modeling and trajectory optimization for unmanned aerial aquatic vehicles uaavs diving into the water the shape of uaav was simplified as a wingless configuration and the fluid force acting on the vehicle was calculated by ideal and viscous fluids respectively they also used an adaptive and global best guided cuckoo search cs algorithm for trajectory optimization in our previous submitted paper mirzaei et al 2020 a simple and fast transient model was developed in order to predict the water entry cavity shape with acceptable accuracy and in a considerably shorter time of simulations than numerical models the memory effect and the effect of gravity and cavitator angle of attack on the axis deformation were considered for the development of the model and good agreement was observed with experimental results furthermore it was shown that the developed model by considering the memory effect is able to predict transient phenomena such as the necking the pinch off and the funnel shaped splashes after pinch off of the cavity at low and high froude numbers of water entry some experimental studies focus on the measurement of the impact force of projectiles at water entry shepard et al 2014 conducted experiments on the effects of velocity the density of the projectile and the wettability of the surface on the impact force during the water entry of spheres they concluded that the formation of quasi static cavities results in larger impact forces compared to the deep seal cases some other experiments are conducted in order to investigate the changes of pressure inside the cavity during the water entry abelson 1970 measured the pressure inside the water entry cavity at u s naval ordnance laboratory and the results indicated that the minimum pressure inside the cavity decreases linearly by increasing the water entry speed also it was shown that by increasing the entry angle the minimum required entry speed to generate a measurable pressure drop becomes greater in another study yuan et al 2017 investigated the cavity pressure during the water entry of supercavitating vehicles experimentally and concluded that the minimum pressure inside the cavity reduces gradually with the increase of water entry speed the trajectory stability at water entry is an important issue for high speed projectiles chen et al 2019 conducted experiments in order to investigate the trajectory stability at water entry of high speed projectiles the effects of the water entry angle impact velocity and nose shape were investigated in the experiments and the results showed that the peak pressure generated by the projectile with the flat nose is the largest which results in perfect trajectory stability however the ogival projectile showed significant instability of the trajectory and attitude deflection jiang and li 2014 studied the effect of adding turbulent drag reducing additives on the water entry supercavity through experimental and numerical studies the results showed that both the diameter and length of the supercavity are larger for the drag reducing solution in comparison to water and the maintaining time of the supercavity is longer in the drag reducing solution in addition to experimental studies different numerical studies based on computational fluid dynamics cfd have been done for investigation of the water entry process for example mu et al 2019 studied the effect of water entry angle on the cavitation flow field of high speed projectiles based on the finite volume method and using the volume of fluid vof multiphase model they investigated the evolution of the cavity shape the characteristics of the motion and hydrodynamics of the projectile at water entry the results showed that their numerical simulation can effectively simulate the change of the cavity shape during the water entry hou et al 2018 investigated the cavity dynamics and vortex evolution for the oblique water entry of a cylinder using the large eddy simulation les and volume of fluid vof techniques for the turbulence computation and air liquid interface modeling respectively the comparison of numerical results with the experimental data showed that the multi scale vortex structure around the cylinder can be successfully captured by the les technique they also conducted a numerical parametric study on the effect of water entry angle on the dynamics of a projectile in another numerical study nguyen et al 2016 used a preconditioned navier stokes ns method to simulate the water entry the three phase flow of water vapor and air were studied in their model and good agreement with experimental results was reported the literature review on the water entry process shows that different studies focus on special subjects such as the cavity shape pressure inside the cavity impact force during water entry and etc based on our knowledge only the numerical study by hou et al 2018 which investigates the cavity dynamics and vortex evolution for the oblique water entry of cylindrical projectiles can be found for a complete simulation of water entry however transient multiphase numerical studies on the water entry problem often need a high number of computational grids and small time steps which result in time consuming simulations for example hou et al 2018 used 9 2 million grids and a time step of 4 10 4 s for their simulations in other words despite the great number of studies on the water entry there is a lack of a complete model that can simulate the water entry process with acceptable accuracy and in a short time therefore in the present paper a complete model of the water entry is developed and compared with the experimental data it should be noted that the existent cavity models in the literature are limited to steady state conditions and are not capable of predicting the transient phenomena in the water entry process such as the necking of the cavity pinch off and funnel shape splashes after pinch off therefore in the present study an improved transient cavity model based on the memory effect of the cavity is constructed and used for the study of unsteady water entry problems also it is tried to take into account all of the forces and moments which act on the water entry projectile in order to increase the accuracy of the modeling in the water entry process the rest of the article is organized as follows section 2 presents the mathematical modeling of the water entry the results of the proposed model will be discussed in section 3 and the conclusions will be drawn in section 4 2 mathematical modeling two coordinate systems which are the inertial coordinate system o x z and the body fixed coordinate system o x z are selected for simulations as shown in fig 1 the origin of the inertial coordinate system is set at the sea level zero and the origin of the body fixed coordinate system is set at the center of gravity of the body cg the notations x and z are the translational positions of the center of gravity of the cylinder relative to the inertial coordinate system and x n and z n are the translational positions of the nose cavitator relative to the inertial coordinate system also θ is the pitch angle which is the rotational position of the projectile relative to the inertial coordinate system the forces and moments acting on the cylinder body consists of the cavitator force and moment f c and m c the gravity force f g the force and moment exerted on the wetted area of the body which includes the buoyancy force and moment f b m b the hydrodynamic force and moment f h m h and the frictional drag f f and also the planing force and moment f p and m p assuming that the origin of the body fixed coordinate system coincides the center of gravity of the cylinder the nonlinear 3 dof equations of motion can be derived using the linear and angular momentum equations in the body fixed coordinate system as follows 1 m u q w f c x f g x f b x f h x f f 2 m w u q f c z f g z f b z f h z f p 3a i y y q m c m b m h m p the components of the cavitator gravity buoyancy and hydrodynamic forces along the x axis of the body fixed coordinate system are denoted by f c x f g x f b x and f h x respectively and the components of these forces along the z axis of the body fixed coordinate system are denoted by f c z f g z f b z and f h z respectively it should be noted that the cavitator force along the z axis or f c z is equal to zero for a cylinder with a flat nose shape without any deflection however this component of cavitator force may generally exist for cavitators with a deflection angle and is considered for the general representation of the equations also it is assumed that the frictional drag f f and the planing force f p are only along the x axis and z axis of the body fixed coordinate system respectively in the above equations m is the mass of the projectile u and w are the linear surge and heave components of velocity in the body fixed coordinate system respectively and q represents the pitch angular velocity i y y is the moment of inertia of the projectile and notations u w and q are the time derivatives of linear velocities in the surge and heave directions and time derivative of pitch angular velocity respectively the equations of motion are ordinary differential equations with constraints that are solved numerically using the classic runge kutta iterative method rk4 and the time step is adaptive in calculations the forces and moments acting on the cylindrical projectile can be seen in fig 2 and the calculation of these forces and moments will be presented in the following subsections as mentioned the cavitator force along the z axis or f c z is shown only for generall representation of cavitator forces for a cavitator which may have nonzero deflection and is equal to zero for the cylindrical projectile with a flat nose 2 1 hydrostatic force and moment hydrostatic forces acting on the cylinder body consist of the gravity force f g and the buoyancy force f b and only the buoyancy force creates hydrostatic moment m b about the center of gravity these forces and moment are represented as 3b f g m g 4 f b ρ v w g 5 m b f b z l l w 2 x c g where g is the gravitational acceleration ρ is the density of the water and equal to 997 0 k g m 3 at 25 c l w is the wetted length of the cylinder and v w π d 2 4 l w is the wetted volume of the cylinder with diameter d also l is the total length of the projectile and x c g is the distance of the center of gravity from the nose it is assumed that the buoyancy force acts on the middle of the wetted volume and the moment arm relative to the center of gravity is equal to l l w 2 x c g 2 2 cavitator force and moment the following relations can be used to estimate the forces acting on the disk cavitator for two directions kirschner et al 2002 6 f c x σ α c 1 2 ρ v c 2 a c c d 0 1 σ cos α c cos δ c 7 f c z σ α c 1 2 ρ v c 2 a c c d 0 1 σ cos α c sin δ c where f c x σ α c and f c z σ α c are the cavitator forces in x and z directions respectively σ is the cavitation number defined as p p c 0 5 ρ v 2 in which p and p c are the ambient pressure and cavity inside pressure respectively and v is the velocity magnitude c d 0 0 815 is the drag coefficient of disk cavitator at zero incidences and a cavitation number of zero a c π d n 2 4 is the area of the disk cavitator with a diameter d n and α c tan 1 w c u c δ c is the angle of attack of the cavitator in which δ c is the deflection angle of the cavitator which is equal to zero for a circular cylinder therefore the cavitator force in the z direction f c z σ α c is equal to zero for the case of a water entry cylinder u c is the velocity of the cavitator in x direction and w c w q l n is the velocity of the cavitator in z direction also l n is the distance between the cavitator and the center of gravity it should be noted that the frictional drag acting on the cavitator can be ignored the negative sign in eqs 6 and 7 shows that the cavitator forces will be in the negative x and z directions when the angle of attack of cavitator α c is positive the cavitator moment can be estimated using the following relation 8 m c f c z σ α c l n 2 3 hydrodynamic force and moment the hydrodynamic forces which act on the wetted volume of the cylinder can be determined using eqs 9 and 10 respectively 9 f h x α 1 2 ρ v 2 a c x α α 10 f h z α 1 2 ρ v 2 a c z α α in the above equations α tan 1 w u is the angle of attack of the cylinder v is the velocity magnitude a π d 2 4 is the cross section area of the cylinder and c x α and c z α are the x and z force coefficients due to the angle of attack variation it is assumed that the hydrodynamic force in the z direction is exerted at the middle part of the wetted volume of the cylinder like the buoyancy force and the moment arm relative to the center of gravity is equal to l l w 2 x c g therefore the related hydrodynamic moment can be determined using the following equation 11 m h f h z α l l w 2 x c g the wetted length of the cylinder l w is calculated by subtracting the average cavity length l c from the total length of the cylinder l the method for calculation of the average cavity length l c will be discussed in the cavity model subsection section 2 6 2 4 frictional drag the frictional drag on the wetted part of the cylinder acts in the negative direction of the forward speed of the body and can be obtained using the following relation newman 1977 12 f f 1 2 ρ s w u 2 c f where s w π d l w is the wetted area of the cylinder and c f is the coefficient of frictional drag which can be written as 13 c f 0 075 l o g 10 r e 2 2 the reynolds number r e is equal to ρ u d μ in which μ is the dynamic viscosity of water which is equal to 8 9 10 4 p a s at 25 c the above empirical relation for the coefficient of frictional drag is known as the ittc 1957 relation and is valid for the range of 10 5 r e 10 10 carlton 2012 2 5 planing force and moment in order to represent the planing force and moment paryshev s formula has been used it should be noted that the paryshev s formula for the planing force is manipulated and simplified by dzielski which is presented as follows dzielski 2011 14 f p α i m π ρ r 2 h 2 r c r h tan α i m w t π ρ r 2 h 2 r c r h r c r h 2 tan α i m w t 2 15 m p α i m f p z α i m l x c where r is the radius of the cylinder r c is the cavity radius at the tail section and w t w l 2 q is the transom velocity it should be noted that the component of the planing force in the x direction planing drag is neglected here because of its relatively small value the immersion angle α i m tan 1 w u l 2 q u which is considered equal to the angle of attack of the tail it should be noted that the location of acting the planing force is always considered at the tail of the cylinder for simplicity also the immersion depth h can be obtained using the transient shape of the cavity at the tail section which is presented in the following subsection 2 6 cavity model based on our previous submitted study on the cavity shape in water entry mirzaei et al 2020 for the transient formulation of cavity shape with considering the memory effect the shape of the cavity can be obtained at different sections by considering the upper and lower parts of the cavity z c u j and z c l j versus x c j as the following equations 16 x c j x n j r c j sin θ j 17 z c u j z n j r c j cos θ j h g j h c j 18 z c l j z n j r c j cos θ j h g j h c j where x n j and z n j are the positions of the nose relative to the inertial coordinate system at section j on the trajectory of the projectile and θ j is the pitch angle of the cylinder body when the nose is at section j also h g j and h c j are the axis deformation due to the gravity effect and the angle of attack of the cavitator respectively the transient formulation of the cavity shape is based on the independence principle of cavity expansion by logvinovich 1972 which states that the expansion of each cavity section j does not depend on the previous and the next sections or j 1 and j 1 respectively see fig 3 as fig 3 shows by considering the memory effect the cavity tends to develop around the trajectory of the cavitator and the cavity axis is defined by the past trajectory of the cavitator the cavity radius at each section r c j is determined by the cavitator velocity v c j and the cavitation number at each section which is written as 19 σ j p j p c j 0 5 ρ v c j 2 where p j is the ambient pressure which is equal to p 0 ρ g h in which p 0 is the atmospheric pressure above the water surface g is the gravitational acceleration and h is the depth of the nose from the water surface p c j is the inside pressure of the cavity and is assumed to have no significant variations in the penetration direction in the process of water entry based on the experimental data from abelson 1970 the cavity inside pressure p c j can be estimated by the atmospheric pressure p 0 for the case of open water entry cavities which are open to the atmosphere after the closure of the cavity the inside pressure of the air bubble will be time dependent and can be determined using the adiabatic law as xi 2004 p c j p v p 0 q 0 q k in which p 0 and q 0 are the initial pressure and volume of the air bubble q is the instantaneous volume of the air bubble p v is the water vapor pressure and k c p c v is the ratio of specific heats of air which is equal to 1 4 the time delay for each instant t j from the current time t is represented as τ j t t j and the traveled distance by the cavitator from t j to t with the speed v c t j can be approximated as δ s j v c t j τ j as fig 3 shows the position of the cavitator at time t is at section m with a time delay of zero the cavity radius at the desired section r c j can be determined using the semi empirical cavity model by guo et al 2012 as the following equation 20 r c j r n 2 2 r n c d 0 1 σ j 2 n δ s j σ j 2 n δ s j 2 where r n is the radius of the cavitator c d 0 0 82 is the drag coefficient of the disk cavitator at zero incidences and a cavitation number of zero and n is an empirical coefficient that is assigned by a value of 1 4 the axis deformation due to the gravity effect and the angle of attack of the cavitator can be determined using the following relations logvinovich 1972 21 h g j g π v 0 δ s j q ξ r c 2 ξ d ξ 22 h c j l n π ρ v 2 0 δ s j d ξ r c 2 ξ where r c ξ is the cavity radius at distance ξ from the cavitator q ξ is the cavity volume from 0 to ξ and v is the free stream velocity the impact of the cavity on the cylinder has importance in calculating the planing force and moment and also determining the wetted length of the cylinder which is used for the calculation of the frictional drag buoyancy force and the hydrodynamic moment the 2 d cavity profile can be divided into upper and lower parts as written in eqs 16 18 and these parts may impact on the lower and upper parts of the cylinder in order to find the impact points of the cavity on the cylinder the upper and lower parts of the curve of the cavity and the cylinder body should be rotated about the nose by the negative pitch angle θ to be horizontal and then the impact points will be determined therefore the rotated parts of the cavity can be determined using the following relations 23 x c r z c u r cos θ sin θ sin θ cos θ x c x n z c u z n 24 x c r z c l r cos θ sin θ sin θ cos θ x c x n z c l z n where the index r represents the rotated part of the cavity in order to find the impact points of the cavity on the cylinder body all of the sections from the tail j k to the nose j m should be checked for the impact on the upper and lower parts of the cylinder with radius r based on the impact of the lower and upper parts of the cavity on upper and lower parts of the cylinder four impact points may occur which are represented as x i m p a c t u u for the impact of the upper part of the cavity on the upper part of the cylinder x i m p a c t l u for the impact of the upper part of the cavity on the lower part of the cylinder x i m p a c t u l for the impact of the lower part of the cavity on the upper part of the cylinder and x i m p a c t l l for the impact of the lower part of the cavity on the lower part of the cylinder the immersion depth h for the calculation of the planing force can be determined by subtracting the values of the upper or lower rotated parts of the cavity z c u r or z c l r from the z value of the cylinder body at the tail section z b it should be noted that the planing of the cavity to the lower part of the cylinder will occur only when x i m p a c t l l 0 and x i m p a c t u u x i m p a c t l u x i m p a c t u l 0 while the planing of the cavity to the upper part of the cylinder will occur only when x i m p a c t u u 0 and x i m p a c t l l x i m p a c t l u x i m p a c t u l 0 in other conditions except for the mentioned cases the immersion depth h will be set to zero when the planing occurs the average length of the cavity l c will be approximately equal to the length of the cylinder l and the wetted length will be equal to zero different conditions for the planing of the cavity with the cylinder are depicted in fig 4 as mentioned the impact of the lower or upper parts of the cavity may be at the lower or upper parts of the cylinder and the impact point can be determined using different conditions that may occur and are shown in fig 5 fig 5 a shows that both the lower and upper parts of the cavity impact on the upper part of the cylinder and fig 5 b indicates that both the lower and upper parts of the cavity impact on the lower part of the cylinder therefore for conditions a and b in fig 5 the impact point of the cavity on the upper or lower parts of the cylinder is considered equal to the minimum value of the two impact distances from the nose fig 5 c shows that one of the cavity parts lower or upper may have no impact on the upper part of the cylinder also fig 5 d indicates that one of the cavity parts lower or upper may have no impact on the lower part of the cylinder therefore for conditions c and d in fig 5 the impact points of the cavity on the upper or lower parts of the cylinder are considered equal to the maximum value of the impact distance from the nose due to the zero impact distance for one of the impact points of the cavity on the cylinder the summary of considered conditions for the immersion depth and the impact point of the cavity on the body can be seen in table 1 when the immersion depth h is determined the planing force and moment can be determined using eqs 14 and 15 respectively also after computing the average cavity length l c and hence the wetted length l w the buoyancy force and moment eq 4 and 5 the hydrodynamic force moment eq 11 and also the frictional drag eq 12 can be determined 3 results and discussion the experimental case from the study of hou et al 2018 is used here for the investigation of the validity of the proposed model the experiment which is the oblique water entry of a cylindrical projectile is conducted at dalian university of technology china the properties of the cylindrical projectile and the conditions for the test are presented in table 2 fig 6 shows the comparison between the results of the developed model and the experimental data from hou et al yuan et al 2017 for the cavity shape at water entry as mentioned earlier these results are obtained in our previous study by considering the memory effect of the cavity and the effects of gravity and the angle of attack of the cavitator as can be seen the cavity shape at water entry is similar to experimental data with acceptable accuracy and transient phenomena such as the necking of cavity pinch off and the funnel shaped splashes after the pinch off can be observed in the results of the model also fig 6 shows that approximately at t 0 12 s the cavity impacts on the lower part of the projectile which results in generating the planing force which will be discussed in the following the necking phenomenon can also be observed in the results of the model and the time of the pinch off of the cavity is approximately equal to 0 132 s which has good agreement with the experimental data as the results of the experiment shows at t 0 15 s and t 0 18 s the funnel shaped splash crown appears after pinching off the cavity this funnel shaped splash crown can also be observed in the results of the proposed model at times t 0 15 s and t 0 18 s with acceptable accuracy therefore the developed model for the cavity shape has acceptable accuracy to be used for complete mathematical modeling of water entry the results of simulations which have been shown in figs 7 10 are presented until t 0 2 s because the cylinder moves outside the view of the high speed camera after t 0 18 s in the experiment fig 7 a shows the time evolution of the projectile velocity which encompasses both vertical and horizontal components of velocity and indicates that before the impact of the cavity on the projectile at approximately t 0 12 s the slope of changing the velocity or the acceleration is high and after the impact the rate of change of the velocity or acceleration decreases this result can also be observed in fig 7 b which shows the change of the acceleration of the projectile during the water entry as can be seen the magnitude of the acceleration before the impact is approximately equal to 8 m s 2 and decreases to about 5 m s 2 after the impact the maximum error between the results of the model and the test data for the velocity magnitude is only 1 6 the comparison between the calculated values of angular displacement of the projectile pitch angle using the model and the results of the experiment are depicted in fig 7 c which shows the same trends are close to each other the maximum error between the results of the proposed modeling and experiment is only 3 2 at t 0 18 s however the error is less than 1 at t 0 12 s when the cavity impacts on the cylinder the x and z positions of the nose of the projectile are shown in fig 7 d and e respectively the comparison between the results of the proposed model and the experimental results shows that the proposed model could predict the trajectory of the projectile with good accuracy and the results of the model are approximately coincident to the test data fig 8 a shows the trend of changing the cavitation number during the water entry of the projectile as fig 8 a shows the cavitation number increases by increasing the depth of penetration of the projectile according to eq 19 the simulation results of the wetted length of the cylinder l w during the water entry is shown in fig 8 b as mentioned earlier the cavity length l c is set to the length of the projectile before the impact of the cavity on the body and therefore the wetted length l w for calculating the buoyancy force and the frictional drag can be determined by subtracting the cavity length l c from the total length of the cylinder or l w l l c at the beginning of the water entry and before the impact of the cavity on the cylinder the cavity length l c is equal to 0 197 m which is the length of the cylinder and therefore the wetted length of the cylinder is equal to zero and the buoyancy and frictional drag are equal to zero after the impact at approximately t 0 133 s the wetted length increase to about 0 057 m and then increasing during the motion of the projectile and collapsing the cavity the simulation results of the frictional drag and the buoyancy force are shown in fig 8 c and d respectively as can be seen in fig 8 c and d the frictional drag and the buoyancy force are equal to zero before t 0 133 s because the wetted length of the cylinder is equal to zero before this instant after the impact of the cavity on the cylinder and wetting the body from the tail the frictional drag and buoyancy forces are generated which are equal to 0 334 n and 1 154 n at t 0 133 s respectively after t 0 133 s the frictional drag and the buoyancy force starts to increase because of increasing the wetted length of the cylinder the simulation results of dimensionless immersion depth h r vs time is shown in fig 9 a as results show the immersion depth starts to increase at about 0 115 s and the dimensionless immersion depth reaches to its maximum at t 0 133 s which is approximately equal to 1 8 after t 0 133 s the immersion depth drops to zero because of the different conditions of the impact of the cavity on the cylinder which is shown in fig 5 and summarized in table 1 the immersion depth causes the planing force and the planing moment which are shown in fig 9 b and c respectively again the planing force and the planing moment reach their maximum at t 0 133 s which are approximately equal to 1 5 n and 0 15 n m respectively this planing force and moment which acts on the cylinder during a very short period of time like an impact force and moment will result in changes in the angular position of the cylinder pitch angle as shown in fig 7 c at approximately t 0 12 s where the slope of the pitch angle vs time changes suddenly fig 10 a shows the results of the hydrodynamic force and fig 10 b shows the results of the hydrodynamic moment the results indicate that at t 0 133 s and after the impact of the cavity on the cylinder the hydrodynamic force increases and reaches its maximum at about 0 14 s which is approximately equal to 1 9 n after t 0 14 s the hydrodynamic force decreases because of the decrease of the angle of attack see fig 10 c the trend of the change of the hydrodynamic moment vs time is more complex due to the changes in the angle of attack during the water entry and also changing the arm of the hydrodynamic force relative to the center of gravity during the time also fig 10 b shows that the hydrodynamic moment is first negative and then changes to positive values finally the results of the proposed model for the angle of attack can be seen in fig 10 c the angle of attack for the projectile is positive during the water entry and it increases first until t 0 133 s and reaches its maximum equal to about 6 2 d e g then the impact of the cavity on the cylinder occurs and after t 0 133 s the angle of attack of the cylinder starts to decrease due to the resultant of the planing moment hydrodynamic moment and the moment of the buoyancy 3 1 the effect of water entry angle in order to investigate the effect of water entry angle two other water entry angles which are equal to 45 and 75 are considered in addition to the previous case of 60 the other conditions for the simulations are similar to the case of the entry angle of 60 and can be seen in table 2 the shapes of the water entry cavity are depicted in figs 11 and 12 for water entry angles of 45 and 75 respectively also the comparison between the results of the proposed model and the results of the same numerical work by hou et al 2018 can be seen in fig 13 as can be seen in fig 11 for the water entry angle of 45 the impact of the cavity to the lower part of the cylinder occurs at about t 0 12 s which makes the cylinder rotate clockwise and the pitch angle rise continuously see fig 13 c this result is similar to the water entry angle of 60 as discussed in the previous section however for the water entry angle of 75 the impact of the cavity to the cylinder occurs at about t 0 12 s again but in this case the impact is with the upper part of the cylinder which results in the rotation of the cylinder to the opposite direction and changing the slope of the pitch angle see fig 13 c before reaching the impact point at about t 0 12 s the cylinder rotates clockwise and the angular displacement achieves its peak and after the impact it rotates inversely in an anti clockwise direction this result indicates that the trajectory characteristics of a water entry cylinder are sensitive to the water entry angle similar trends of changing the location of the nose and the pitch angle can be observed for the proposed model as compared to the numerical study by hou et al 2018 the little difference between the results come from differences in the forces and moments in two simulations the results of the horizontal and vertical displacements of the nose x n and z n are shown in fig 13 a and b respectively which show similar tendencies for three water entry angles the results indicate that by increasing the water entry angle the vertical displacement will rise faster while the horizontal displacement will grow slower in addition the slope of the vertical displacement curve is relatively larger that the horizontal displacement curve hou et al 2018 compared their numerical results based on the les method with experimental data of the water entry at the entry angle of 60 and showed that the maximum error for the angular displacement pitch angle is only 2 48 at t 0 12 s when the cavity touches the cylinder as mentioned earlier in the present study the maximum error between the results of the proposed modeling and the same experiment is only 3 2 at t 0 18 s and the error is less than 1 at t 0 12 s when the cavity impacts on the cylinder also the maximum error value of the velocity for the numerical study of hou et al 2018 is 10 90 at t 0 1 s while the maximum error for the velocity magnitude is only 1 6 for the proposed model in the present study this result indicate that the proposed model could predict the velocity and the trajectory of the water entry cylinder with better or at least the same accuracy than the time consuming numerical studies the total time of calculations for the proposed model is relatively lower compared to the numerical methods therefore the proposed model could predict the dynamics of the water entry of cylindrical projectiles with acceptable accuracy and in a short time which can be combined with other parts of a full simulation to predict the whole behaviours of an underwater vehicle 3 2 the effect of water entry velocity in order to investigate the effect of the water entry velocity two other water entry velocities which are equal to 2 08 m s and 8 32 m s are considered in addition to the previous case of 4 35 m s at an entry angle of 60 the other conditions for the simulations are similar to the case of the entry velocity of 4 35 m s and can be seen in table 2 the shapes of the water entry cavity are depicted in figs 14 and 15 for water entry velocities of 2 08 m s and 8 32 m s respectively also the results of the proposed model for the nose location and pitch angle of the projectile at different water entry velocities can be seen in fig 16 as figs 14 and 15 and the previous results of cavity shape for water entry velocity of 4 35 m s fig 6 show the transient shape of the cavity is similar at different entry velocities as can be seen in these three figures the necking of the cavity is started at about t 0 09 s for different entry velocities and the impact of the cavity to the lower section of the projectile body has occurred at about t 0 12 s however the planing force and moment differ for different entry velocities which results in different rotation of body after the impact fig 16 c shows that the rate of change of the pitch angle after the impact is higher for the case of lower entry velocity this figure shows that the time of impact changing the slope of the pitch angle is similar for three entry velocities and is approximately equal to 0 12 s but the rate of change of the pitch angle is higher for the case of the projectile with lower entry velocity 2 08 m s this result can be explained better using the graph of the angle of attack of the projectile during the water entry at three different velocities as shown in fig 16 d this figure indicates that the projectile has the same angle of attack at the beginning of the motion for three different velocities of water entry however the angle of attack of the projectile with lower velocity is higher during the planing which results in higher planing force and moment see eq 14 in other words the normal component of the velocity of the projectile is approximately similar for three cases due to the same gravitational force but the projectile with higher velocity has a higher axial component of the velocity during the water entry which results in a lower angle of attack α i m tan 1 w u l 2 q u the results of the horizontal and vertical displacements of the nose x n and z n are shown in fig 16 a and b respectively which show similar tendencies for three water entry velocities obviously the results indicate that by increasing the water entry velocity the vertical and horizontal displacements will rise 4 conclusion in the present study the complete modeling of the water entry of a cylindrical projectile has been considered and a new transient model of the cavity shape by the consideration of the memory effect of the cavity has been used for the development of the model the model could predict the impacts of the cavity on the cylinder body and identify which of the related forces and moments should be applied to the projectile during the motion equations of motion were developed for the projectile movement in the cavity while the cavity impacts different parts of the projectile it is tried to take into account all of the forces and moments such as the hydrostatic hydrodynamic cavitator frictional drag and planing which act on the projectile in order to increase the accuracy of the model the simulation results were compared with experimental test data of water entry and the results of the proposed model showed that it could predict the projectile motion and the trajectory of the projectile with good accuracy relative to the experimental data of water entry and in a relatively shorter time compared to the numerical studies finally a parametric study on the effect of the water entry angle and water entry velocity showed that the trajectory characteristics cavity shape and cavity contact point of the cylinder are sensitive to the water entry angle and velocity credit authorship contribution statement mojtaba mirzaei supervision writing review editing conceptualization methodology validation hossein taghvaei data curation software validation writing review editing mohammad mahdi alishahi validation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper appendix a supplementary data the following is are the supplementary data to this article data data appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j oceaneng 2020 107257 
21891,water entry is the process in which a moving body with an initial velocity impacts the free surface and enters the water from the air and has many important applications in different fields of science and engineering in this paper a new transient model of the cavity shape by the consideration of the memory effect of the cavity is developed to predict the shape of the water entry cavity for circular cylinders and this model has been used to develop the complete model of the oblique water entry of a cylindrical projectile the proposed model could predict the impacts of the cavity on the cylinder body and it is tried to take into account all of the forces and moments which act on the projectile in order to develop an accurate model for the water entry problem the simulation results of several oblique water entry of cylindrical projectiles in different angles show that the new proposed model could predict the projectile attitude and the trajectory of the projectile with good accuracy relative to the experimental data of water entry and in a relatively shorter time of simulations compared to the numerical studies keywords mathematical modeling water entry cylindrical projectiles cavity memory effect 1 introduction water entry is the process of impacting an object on the free surface of the water and penetrating it into water understanding the mechanism of water entry has been the scope of many researchers from the past to now because of its importance in many fields of science and engineering the early researchers on the water entry were experimental using high speed photography for example may and woodhull 1950 may and woodhull 1948 studied the vertical water entry of spheres and may studied the vertical entry of missiles into the water using the high speed camera also worthington and cole 1897 used the single spark high speed photography to record the cavity shape of water entry spheres the water entry can be categorized into two different classes of high and low froude numbers for example the water entry of military projectiles such as torpedoes is often at high froude numbers where the effect of gravity is negligible one of the recently published studies on the water entry of high speed auvs was done by shi et al 2019 which presents the design and load reduction performance analysis of a mitigator their numerical simulations were based on the explicit finite element method with an arbitrary lagrangian eulerian ale solver and the accuracy of their numerical model was verified using the experimental results of the water entry of small spheres on the other hand for the low froud number case several studies on the water entry of spheres and disks with low speed can be found in the literature truscott and techet 2009 yan et al 2009 aristoff et al 2010 bergmann et al 2009 gilbarg and anderson 1948 recently li et al 2019 studied the effects of surface wettability and impact velocity on the water entry of spheres with low froude numbers the results indicated that the impact of the hydrophilic case creates a smaller splash and the hydrophilic and hydrophobic spheres experience different cavity regimes as the impact velocity increases also the hydrophobic spheres undergo higher force coefficients in the cavity forming cases also shentu et al 2019 studied the water entry of hydrophobic objects numerically based on the boundary data immersion method bdim and the volume of fluid vof method and the water crown the cavity and the flow pattern was analyzed the results indicated that the depth of pinch off increases by reducing the characteristic length of the cavity also it was shown that the pinch off time increases for the sphere with a larger density derakhshanian et al 2018 derakhshanian et al 2018 compared and evaluated three different numerical algorithms in order to find a reliable simulation tool for oblique water entry problems the first numerical algorithm was finite volume eulerian with boundary fitted adaptive grids and dynamic mesh also the volume of fluid vof model was used to capture the free surface between water and air the second algorithm was finite difference eulerian with cartesian computational grids and general moving object gmo algorithm to follow the solid boundary motion again the vof model was used to capture the free surface between water and air phases the third algorithm uses coupled eulerian lagrangian cel formulation in this method the lagrangian object can move through the eulerian domain using a contact algorithm in contrast to the previous two algorithms the cel method doesn t solve two phase flow problems however the eulerian volume fraction evf model is used to capture the free surface between water and void material the fluid dynamics of the splash cavity formation and its collapse for vertical water entry of a sphere were investigated using three numerical algorithms and compared with experimental data of water entry the results showed that the two first algorithms cannot predict the simple problem of the normal water entry of a sphere it was shown that the abaqus software third algorithm is the most capable software among the three numerical codes also the capability of the cel algorithm was evaluated for the oblique water entry problem and it was shown that the impact forces and moments can be precisely predicted even in the extreme angles and velocities of water entry the main focus of some experimental analytical or numerical studies is on the prediction of the water entry cavity shape for example abelson 1971 developed an analytical model based on the hydraulic flow model for predicting the shape of the cavity at water entry of bluff axisymmetric projectiles truscott et al 2009 developed a steady state model for the cavity shape based on the logvinovich theoretical model and with a correction of the angle of attack and guo et al 2012 presented a semi empirical cavity model for horizontal water entry of cylindrical projectiles and good agreement was observed between the obtained results of the model and the experimental results also it was shown that the maximum cavity radius decreases monotonically with the penetration distance however the presented model by guo et al is a steady state model which could not predict the transient phenomena such as the necking and pinch off of the cavity savchenko vlasenko 2003 developed an empirical model for the cavity radius in steady state conditions furthermore lee et al 1997 developed 2 d analytic models based on the theory of potential flow and duclaux et al 2007 presented an analytic model for the time evolution of the cavity based on the besant rayleigh equation also gaudet et al gaudet 1998 studied the water entry of circular disks at low froude numbers using a boundary integral method and showed that their results are in good agreement with experimental data recently wu et al 2019 studied the dynamics modeling and trajectory optimization for unmanned aerial aquatic vehicles uaavs diving into the water the shape of uaav was simplified as a wingless configuration and the fluid force acting on the vehicle was calculated by ideal and viscous fluids respectively they also used an adaptive and global best guided cuckoo search cs algorithm for trajectory optimization in our previous submitted paper mirzaei et al 2020 a simple and fast transient model was developed in order to predict the water entry cavity shape with acceptable accuracy and in a considerably shorter time of simulations than numerical models the memory effect and the effect of gravity and cavitator angle of attack on the axis deformation were considered for the development of the model and good agreement was observed with experimental results furthermore it was shown that the developed model by considering the memory effect is able to predict transient phenomena such as the necking the pinch off and the funnel shaped splashes after pinch off of the cavity at low and high froude numbers of water entry some experimental studies focus on the measurement of the impact force of projectiles at water entry shepard et al 2014 conducted experiments on the effects of velocity the density of the projectile and the wettability of the surface on the impact force during the water entry of spheres they concluded that the formation of quasi static cavities results in larger impact forces compared to the deep seal cases some other experiments are conducted in order to investigate the changes of pressure inside the cavity during the water entry abelson 1970 measured the pressure inside the water entry cavity at u s naval ordnance laboratory and the results indicated that the minimum pressure inside the cavity decreases linearly by increasing the water entry speed also it was shown that by increasing the entry angle the minimum required entry speed to generate a measurable pressure drop becomes greater in another study yuan et al 2017 investigated the cavity pressure during the water entry of supercavitating vehicles experimentally and concluded that the minimum pressure inside the cavity reduces gradually with the increase of water entry speed the trajectory stability at water entry is an important issue for high speed projectiles chen et al 2019 conducted experiments in order to investigate the trajectory stability at water entry of high speed projectiles the effects of the water entry angle impact velocity and nose shape were investigated in the experiments and the results showed that the peak pressure generated by the projectile with the flat nose is the largest which results in perfect trajectory stability however the ogival projectile showed significant instability of the trajectory and attitude deflection jiang and li 2014 studied the effect of adding turbulent drag reducing additives on the water entry supercavity through experimental and numerical studies the results showed that both the diameter and length of the supercavity are larger for the drag reducing solution in comparison to water and the maintaining time of the supercavity is longer in the drag reducing solution in addition to experimental studies different numerical studies based on computational fluid dynamics cfd have been done for investigation of the water entry process for example mu et al 2019 studied the effect of water entry angle on the cavitation flow field of high speed projectiles based on the finite volume method and using the volume of fluid vof multiphase model they investigated the evolution of the cavity shape the characteristics of the motion and hydrodynamics of the projectile at water entry the results showed that their numerical simulation can effectively simulate the change of the cavity shape during the water entry hou et al 2018 investigated the cavity dynamics and vortex evolution for the oblique water entry of a cylinder using the large eddy simulation les and volume of fluid vof techniques for the turbulence computation and air liquid interface modeling respectively the comparison of numerical results with the experimental data showed that the multi scale vortex structure around the cylinder can be successfully captured by the les technique they also conducted a numerical parametric study on the effect of water entry angle on the dynamics of a projectile in another numerical study nguyen et al 2016 used a preconditioned navier stokes ns method to simulate the water entry the three phase flow of water vapor and air were studied in their model and good agreement with experimental results was reported the literature review on the water entry process shows that different studies focus on special subjects such as the cavity shape pressure inside the cavity impact force during water entry and etc based on our knowledge only the numerical study by hou et al 2018 which investigates the cavity dynamics and vortex evolution for the oblique water entry of cylindrical projectiles can be found for a complete simulation of water entry however transient multiphase numerical studies on the water entry problem often need a high number of computational grids and small time steps which result in time consuming simulations for example hou et al 2018 used 9 2 million grids and a time step of 4 10 4 s for their simulations in other words despite the great number of studies on the water entry there is a lack of a complete model that can simulate the water entry process with acceptable accuracy and in a short time therefore in the present paper a complete model of the water entry is developed and compared with the experimental data it should be noted that the existent cavity models in the literature are limited to steady state conditions and are not capable of predicting the transient phenomena in the water entry process such as the necking of the cavity pinch off and funnel shape splashes after pinch off therefore in the present study an improved transient cavity model based on the memory effect of the cavity is constructed and used for the study of unsteady water entry problems also it is tried to take into account all of the forces and moments which act on the water entry projectile in order to increase the accuracy of the modeling in the water entry process the rest of the article is organized as follows section 2 presents the mathematical modeling of the water entry the results of the proposed model will be discussed in section 3 and the conclusions will be drawn in section 4 2 mathematical modeling two coordinate systems which are the inertial coordinate system o x z and the body fixed coordinate system o x z are selected for simulations as shown in fig 1 the origin of the inertial coordinate system is set at the sea level zero and the origin of the body fixed coordinate system is set at the center of gravity of the body cg the notations x and z are the translational positions of the center of gravity of the cylinder relative to the inertial coordinate system and x n and z n are the translational positions of the nose cavitator relative to the inertial coordinate system also θ is the pitch angle which is the rotational position of the projectile relative to the inertial coordinate system the forces and moments acting on the cylinder body consists of the cavitator force and moment f c and m c the gravity force f g the force and moment exerted on the wetted area of the body which includes the buoyancy force and moment f b m b the hydrodynamic force and moment f h m h and the frictional drag f f and also the planing force and moment f p and m p assuming that the origin of the body fixed coordinate system coincides the center of gravity of the cylinder the nonlinear 3 dof equations of motion can be derived using the linear and angular momentum equations in the body fixed coordinate system as follows 1 m u q w f c x f g x f b x f h x f f 2 m w u q f c z f g z f b z f h z f p 3a i y y q m c m b m h m p the components of the cavitator gravity buoyancy and hydrodynamic forces along the x axis of the body fixed coordinate system are denoted by f c x f g x f b x and f h x respectively and the components of these forces along the z axis of the body fixed coordinate system are denoted by f c z f g z f b z and f h z respectively it should be noted that the cavitator force along the z axis or f c z is equal to zero for a cylinder with a flat nose shape without any deflection however this component of cavitator force may generally exist for cavitators with a deflection angle and is considered for the general representation of the equations also it is assumed that the frictional drag f f and the planing force f p are only along the x axis and z axis of the body fixed coordinate system respectively in the above equations m is the mass of the projectile u and w are the linear surge and heave components of velocity in the body fixed coordinate system respectively and q represents the pitch angular velocity i y y is the moment of inertia of the projectile and notations u w and q are the time derivatives of linear velocities in the surge and heave directions and time derivative of pitch angular velocity respectively the equations of motion are ordinary differential equations with constraints that are solved numerically using the classic runge kutta iterative method rk4 and the time step is adaptive in calculations the forces and moments acting on the cylindrical projectile can be seen in fig 2 and the calculation of these forces and moments will be presented in the following subsections as mentioned the cavitator force along the z axis or f c z is shown only for generall representation of cavitator forces for a cavitator which may have nonzero deflection and is equal to zero for the cylindrical projectile with a flat nose 2 1 hydrostatic force and moment hydrostatic forces acting on the cylinder body consist of the gravity force f g and the buoyancy force f b and only the buoyancy force creates hydrostatic moment m b about the center of gravity these forces and moment are represented as 3b f g m g 4 f b ρ v w g 5 m b f b z l l w 2 x c g where g is the gravitational acceleration ρ is the density of the water and equal to 997 0 k g m 3 at 25 c l w is the wetted length of the cylinder and v w π d 2 4 l w is the wetted volume of the cylinder with diameter d also l is the total length of the projectile and x c g is the distance of the center of gravity from the nose it is assumed that the buoyancy force acts on the middle of the wetted volume and the moment arm relative to the center of gravity is equal to l l w 2 x c g 2 2 cavitator force and moment the following relations can be used to estimate the forces acting on the disk cavitator for two directions kirschner et al 2002 6 f c x σ α c 1 2 ρ v c 2 a c c d 0 1 σ cos α c cos δ c 7 f c z σ α c 1 2 ρ v c 2 a c c d 0 1 σ cos α c sin δ c where f c x σ α c and f c z σ α c are the cavitator forces in x and z directions respectively σ is the cavitation number defined as p p c 0 5 ρ v 2 in which p and p c are the ambient pressure and cavity inside pressure respectively and v is the velocity magnitude c d 0 0 815 is the drag coefficient of disk cavitator at zero incidences and a cavitation number of zero a c π d n 2 4 is the area of the disk cavitator with a diameter d n and α c tan 1 w c u c δ c is the angle of attack of the cavitator in which δ c is the deflection angle of the cavitator which is equal to zero for a circular cylinder therefore the cavitator force in the z direction f c z σ α c is equal to zero for the case of a water entry cylinder u c is the velocity of the cavitator in x direction and w c w q l n is the velocity of the cavitator in z direction also l n is the distance between the cavitator and the center of gravity it should be noted that the frictional drag acting on the cavitator can be ignored the negative sign in eqs 6 and 7 shows that the cavitator forces will be in the negative x and z directions when the angle of attack of cavitator α c is positive the cavitator moment can be estimated using the following relation 8 m c f c z σ α c l n 2 3 hydrodynamic force and moment the hydrodynamic forces which act on the wetted volume of the cylinder can be determined using eqs 9 and 10 respectively 9 f h x α 1 2 ρ v 2 a c x α α 10 f h z α 1 2 ρ v 2 a c z α α in the above equations α tan 1 w u is the angle of attack of the cylinder v is the velocity magnitude a π d 2 4 is the cross section area of the cylinder and c x α and c z α are the x and z force coefficients due to the angle of attack variation it is assumed that the hydrodynamic force in the z direction is exerted at the middle part of the wetted volume of the cylinder like the buoyancy force and the moment arm relative to the center of gravity is equal to l l w 2 x c g therefore the related hydrodynamic moment can be determined using the following equation 11 m h f h z α l l w 2 x c g the wetted length of the cylinder l w is calculated by subtracting the average cavity length l c from the total length of the cylinder l the method for calculation of the average cavity length l c will be discussed in the cavity model subsection section 2 6 2 4 frictional drag the frictional drag on the wetted part of the cylinder acts in the negative direction of the forward speed of the body and can be obtained using the following relation newman 1977 12 f f 1 2 ρ s w u 2 c f where s w π d l w is the wetted area of the cylinder and c f is the coefficient of frictional drag which can be written as 13 c f 0 075 l o g 10 r e 2 2 the reynolds number r e is equal to ρ u d μ in which μ is the dynamic viscosity of water which is equal to 8 9 10 4 p a s at 25 c the above empirical relation for the coefficient of frictional drag is known as the ittc 1957 relation and is valid for the range of 10 5 r e 10 10 carlton 2012 2 5 planing force and moment in order to represent the planing force and moment paryshev s formula has been used it should be noted that the paryshev s formula for the planing force is manipulated and simplified by dzielski which is presented as follows dzielski 2011 14 f p α i m π ρ r 2 h 2 r c r h tan α i m w t π ρ r 2 h 2 r c r h r c r h 2 tan α i m w t 2 15 m p α i m f p z α i m l x c where r is the radius of the cylinder r c is the cavity radius at the tail section and w t w l 2 q is the transom velocity it should be noted that the component of the planing force in the x direction planing drag is neglected here because of its relatively small value the immersion angle α i m tan 1 w u l 2 q u which is considered equal to the angle of attack of the tail it should be noted that the location of acting the planing force is always considered at the tail of the cylinder for simplicity also the immersion depth h can be obtained using the transient shape of the cavity at the tail section which is presented in the following subsection 2 6 cavity model based on our previous submitted study on the cavity shape in water entry mirzaei et al 2020 for the transient formulation of cavity shape with considering the memory effect the shape of the cavity can be obtained at different sections by considering the upper and lower parts of the cavity z c u j and z c l j versus x c j as the following equations 16 x c j x n j r c j sin θ j 17 z c u j z n j r c j cos θ j h g j h c j 18 z c l j z n j r c j cos θ j h g j h c j where x n j and z n j are the positions of the nose relative to the inertial coordinate system at section j on the trajectory of the projectile and θ j is the pitch angle of the cylinder body when the nose is at section j also h g j and h c j are the axis deformation due to the gravity effect and the angle of attack of the cavitator respectively the transient formulation of the cavity shape is based on the independence principle of cavity expansion by logvinovich 1972 which states that the expansion of each cavity section j does not depend on the previous and the next sections or j 1 and j 1 respectively see fig 3 as fig 3 shows by considering the memory effect the cavity tends to develop around the trajectory of the cavitator and the cavity axis is defined by the past trajectory of the cavitator the cavity radius at each section r c j is determined by the cavitator velocity v c j and the cavitation number at each section which is written as 19 σ j p j p c j 0 5 ρ v c j 2 where p j is the ambient pressure which is equal to p 0 ρ g h in which p 0 is the atmospheric pressure above the water surface g is the gravitational acceleration and h is the depth of the nose from the water surface p c j is the inside pressure of the cavity and is assumed to have no significant variations in the penetration direction in the process of water entry based on the experimental data from abelson 1970 the cavity inside pressure p c j can be estimated by the atmospheric pressure p 0 for the case of open water entry cavities which are open to the atmosphere after the closure of the cavity the inside pressure of the air bubble will be time dependent and can be determined using the adiabatic law as xi 2004 p c j p v p 0 q 0 q k in which p 0 and q 0 are the initial pressure and volume of the air bubble q is the instantaneous volume of the air bubble p v is the water vapor pressure and k c p c v is the ratio of specific heats of air which is equal to 1 4 the time delay for each instant t j from the current time t is represented as τ j t t j and the traveled distance by the cavitator from t j to t with the speed v c t j can be approximated as δ s j v c t j τ j as fig 3 shows the position of the cavitator at time t is at section m with a time delay of zero the cavity radius at the desired section r c j can be determined using the semi empirical cavity model by guo et al 2012 as the following equation 20 r c j r n 2 2 r n c d 0 1 σ j 2 n δ s j σ j 2 n δ s j 2 where r n is the radius of the cavitator c d 0 0 82 is the drag coefficient of the disk cavitator at zero incidences and a cavitation number of zero and n is an empirical coefficient that is assigned by a value of 1 4 the axis deformation due to the gravity effect and the angle of attack of the cavitator can be determined using the following relations logvinovich 1972 21 h g j g π v 0 δ s j q ξ r c 2 ξ d ξ 22 h c j l n π ρ v 2 0 δ s j d ξ r c 2 ξ where r c ξ is the cavity radius at distance ξ from the cavitator q ξ is the cavity volume from 0 to ξ and v is the free stream velocity the impact of the cavity on the cylinder has importance in calculating the planing force and moment and also determining the wetted length of the cylinder which is used for the calculation of the frictional drag buoyancy force and the hydrodynamic moment the 2 d cavity profile can be divided into upper and lower parts as written in eqs 16 18 and these parts may impact on the lower and upper parts of the cylinder in order to find the impact points of the cavity on the cylinder the upper and lower parts of the curve of the cavity and the cylinder body should be rotated about the nose by the negative pitch angle θ to be horizontal and then the impact points will be determined therefore the rotated parts of the cavity can be determined using the following relations 23 x c r z c u r cos θ sin θ sin θ cos θ x c x n z c u z n 24 x c r z c l r cos θ sin θ sin θ cos θ x c x n z c l z n where the index r represents the rotated part of the cavity in order to find the impact points of the cavity on the cylinder body all of the sections from the tail j k to the nose j m should be checked for the impact on the upper and lower parts of the cylinder with radius r based on the impact of the lower and upper parts of the cavity on upper and lower parts of the cylinder four impact points may occur which are represented as x i m p a c t u u for the impact of the upper part of the cavity on the upper part of the cylinder x i m p a c t l u for the impact of the upper part of the cavity on the lower part of the cylinder x i m p a c t u l for the impact of the lower part of the cavity on the upper part of the cylinder and x i m p a c t l l for the impact of the lower part of the cavity on the lower part of the cylinder the immersion depth h for the calculation of the planing force can be determined by subtracting the values of the upper or lower rotated parts of the cavity z c u r or z c l r from the z value of the cylinder body at the tail section z b it should be noted that the planing of the cavity to the lower part of the cylinder will occur only when x i m p a c t l l 0 and x i m p a c t u u x i m p a c t l u x i m p a c t u l 0 while the planing of the cavity to the upper part of the cylinder will occur only when x i m p a c t u u 0 and x i m p a c t l l x i m p a c t l u x i m p a c t u l 0 in other conditions except for the mentioned cases the immersion depth h will be set to zero when the planing occurs the average length of the cavity l c will be approximately equal to the length of the cylinder l and the wetted length will be equal to zero different conditions for the planing of the cavity with the cylinder are depicted in fig 4 as mentioned the impact of the lower or upper parts of the cavity may be at the lower or upper parts of the cylinder and the impact point can be determined using different conditions that may occur and are shown in fig 5 fig 5 a shows that both the lower and upper parts of the cavity impact on the upper part of the cylinder and fig 5 b indicates that both the lower and upper parts of the cavity impact on the lower part of the cylinder therefore for conditions a and b in fig 5 the impact point of the cavity on the upper or lower parts of the cylinder is considered equal to the minimum value of the two impact distances from the nose fig 5 c shows that one of the cavity parts lower or upper may have no impact on the upper part of the cylinder also fig 5 d indicates that one of the cavity parts lower or upper may have no impact on the lower part of the cylinder therefore for conditions c and d in fig 5 the impact points of the cavity on the upper or lower parts of the cylinder are considered equal to the maximum value of the impact distance from the nose due to the zero impact distance for one of the impact points of the cavity on the cylinder the summary of considered conditions for the immersion depth and the impact point of the cavity on the body can be seen in table 1 when the immersion depth h is determined the planing force and moment can be determined using eqs 14 and 15 respectively also after computing the average cavity length l c and hence the wetted length l w the buoyancy force and moment eq 4 and 5 the hydrodynamic force moment eq 11 and also the frictional drag eq 12 can be determined 3 results and discussion the experimental case from the study of hou et al 2018 is used here for the investigation of the validity of the proposed model the experiment which is the oblique water entry of a cylindrical projectile is conducted at dalian university of technology china the properties of the cylindrical projectile and the conditions for the test are presented in table 2 fig 6 shows the comparison between the results of the developed model and the experimental data from hou et al yuan et al 2017 for the cavity shape at water entry as mentioned earlier these results are obtained in our previous study by considering the memory effect of the cavity and the effects of gravity and the angle of attack of the cavitator as can be seen the cavity shape at water entry is similar to experimental data with acceptable accuracy and transient phenomena such as the necking of cavity pinch off and the funnel shaped splashes after the pinch off can be observed in the results of the model also fig 6 shows that approximately at t 0 12 s the cavity impacts on the lower part of the projectile which results in generating the planing force which will be discussed in the following the necking phenomenon can also be observed in the results of the model and the time of the pinch off of the cavity is approximately equal to 0 132 s which has good agreement with the experimental data as the results of the experiment shows at t 0 15 s and t 0 18 s the funnel shaped splash crown appears after pinching off the cavity this funnel shaped splash crown can also be observed in the results of the proposed model at times t 0 15 s and t 0 18 s with acceptable accuracy therefore the developed model for the cavity shape has acceptable accuracy to be used for complete mathematical modeling of water entry the results of simulations which have been shown in figs 7 10 are presented until t 0 2 s because the cylinder moves outside the view of the high speed camera after t 0 18 s in the experiment fig 7 a shows the time evolution of the projectile velocity which encompasses both vertical and horizontal components of velocity and indicates that before the impact of the cavity on the projectile at approximately t 0 12 s the slope of changing the velocity or the acceleration is high and after the impact the rate of change of the velocity or acceleration decreases this result can also be observed in fig 7 b which shows the change of the acceleration of the projectile during the water entry as can be seen the magnitude of the acceleration before the impact is approximately equal to 8 m s 2 and decreases to about 5 m s 2 after the impact the maximum error between the results of the model and the test data for the velocity magnitude is only 1 6 the comparison between the calculated values of angular displacement of the projectile pitch angle using the model and the results of the experiment are depicted in fig 7 c which shows the same trends are close to each other the maximum error between the results of the proposed modeling and experiment is only 3 2 at t 0 18 s however the error is less than 1 at t 0 12 s when the cavity impacts on the cylinder the x and z positions of the nose of the projectile are shown in fig 7 d and e respectively the comparison between the results of the proposed model and the experimental results shows that the proposed model could predict the trajectory of the projectile with good accuracy and the results of the model are approximately coincident to the test data fig 8 a shows the trend of changing the cavitation number during the water entry of the projectile as fig 8 a shows the cavitation number increases by increasing the depth of penetration of the projectile according to eq 19 the simulation results of the wetted length of the cylinder l w during the water entry is shown in fig 8 b as mentioned earlier the cavity length l c is set to the length of the projectile before the impact of the cavity on the body and therefore the wetted length l w for calculating the buoyancy force and the frictional drag can be determined by subtracting the cavity length l c from the total length of the cylinder or l w l l c at the beginning of the water entry and before the impact of the cavity on the cylinder the cavity length l c is equal to 0 197 m which is the length of the cylinder and therefore the wetted length of the cylinder is equal to zero and the buoyancy and frictional drag are equal to zero after the impact at approximately t 0 133 s the wetted length increase to about 0 057 m and then increasing during the motion of the projectile and collapsing the cavity the simulation results of the frictional drag and the buoyancy force are shown in fig 8 c and d respectively as can be seen in fig 8 c and d the frictional drag and the buoyancy force are equal to zero before t 0 133 s because the wetted length of the cylinder is equal to zero before this instant after the impact of the cavity on the cylinder and wetting the body from the tail the frictional drag and buoyancy forces are generated which are equal to 0 334 n and 1 154 n at t 0 133 s respectively after t 0 133 s the frictional drag and the buoyancy force starts to increase because of increasing the wetted length of the cylinder the simulation results of dimensionless immersion depth h r vs time is shown in fig 9 a as results show the immersion depth starts to increase at about 0 115 s and the dimensionless immersion depth reaches to its maximum at t 0 133 s which is approximately equal to 1 8 after t 0 133 s the immersion depth drops to zero because of the different conditions of the impact of the cavity on the cylinder which is shown in fig 5 and summarized in table 1 the immersion depth causes the planing force and the planing moment which are shown in fig 9 b and c respectively again the planing force and the planing moment reach their maximum at t 0 133 s which are approximately equal to 1 5 n and 0 15 n m respectively this planing force and moment which acts on the cylinder during a very short period of time like an impact force and moment will result in changes in the angular position of the cylinder pitch angle as shown in fig 7 c at approximately t 0 12 s where the slope of the pitch angle vs time changes suddenly fig 10 a shows the results of the hydrodynamic force and fig 10 b shows the results of the hydrodynamic moment the results indicate that at t 0 133 s and after the impact of the cavity on the cylinder the hydrodynamic force increases and reaches its maximum at about 0 14 s which is approximately equal to 1 9 n after t 0 14 s the hydrodynamic force decreases because of the decrease of the angle of attack see fig 10 c the trend of the change of the hydrodynamic moment vs time is more complex due to the changes in the angle of attack during the water entry and also changing the arm of the hydrodynamic force relative to the center of gravity during the time also fig 10 b shows that the hydrodynamic moment is first negative and then changes to positive values finally the results of the proposed model for the angle of attack can be seen in fig 10 c the angle of attack for the projectile is positive during the water entry and it increases first until t 0 133 s and reaches its maximum equal to about 6 2 d e g then the impact of the cavity on the cylinder occurs and after t 0 133 s the angle of attack of the cylinder starts to decrease due to the resultant of the planing moment hydrodynamic moment and the moment of the buoyancy 3 1 the effect of water entry angle in order to investigate the effect of water entry angle two other water entry angles which are equal to 45 and 75 are considered in addition to the previous case of 60 the other conditions for the simulations are similar to the case of the entry angle of 60 and can be seen in table 2 the shapes of the water entry cavity are depicted in figs 11 and 12 for water entry angles of 45 and 75 respectively also the comparison between the results of the proposed model and the results of the same numerical work by hou et al 2018 can be seen in fig 13 as can be seen in fig 11 for the water entry angle of 45 the impact of the cavity to the lower part of the cylinder occurs at about t 0 12 s which makes the cylinder rotate clockwise and the pitch angle rise continuously see fig 13 c this result is similar to the water entry angle of 60 as discussed in the previous section however for the water entry angle of 75 the impact of the cavity to the cylinder occurs at about t 0 12 s again but in this case the impact is with the upper part of the cylinder which results in the rotation of the cylinder to the opposite direction and changing the slope of the pitch angle see fig 13 c before reaching the impact point at about t 0 12 s the cylinder rotates clockwise and the angular displacement achieves its peak and after the impact it rotates inversely in an anti clockwise direction this result indicates that the trajectory characteristics of a water entry cylinder are sensitive to the water entry angle similar trends of changing the location of the nose and the pitch angle can be observed for the proposed model as compared to the numerical study by hou et al 2018 the little difference between the results come from differences in the forces and moments in two simulations the results of the horizontal and vertical displacements of the nose x n and z n are shown in fig 13 a and b respectively which show similar tendencies for three water entry angles the results indicate that by increasing the water entry angle the vertical displacement will rise faster while the horizontal displacement will grow slower in addition the slope of the vertical displacement curve is relatively larger that the horizontal displacement curve hou et al 2018 compared their numerical results based on the les method with experimental data of the water entry at the entry angle of 60 and showed that the maximum error for the angular displacement pitch angle is only 2 48 at t 0 12 s when the cavity touches the cylinder as mentioned earlier in the present study the maximum error between the results of the proposed modeling and the same experiment is only 3 2 at t 0 18 s and the error is less than 1 at t 0 12 s when the cavity impacts on the cylinder also the maximum error value of the velocity for the numerical study of hou et al 2018 is 10 90 at t 0 1 s while the maximum error for the velocity magnitude is only 1 6 for the proposed model in the present study this result indicate that the proposed model could predict the velocity and the trajectory of the water entry cylinder with better or at least the same accuracy than the time consuming numerical studies the total time of calculations for the proposed model is relatively lower compared to the numerical methods therefore the proposed model could predict the dynamics of the water entry of cylindrical projectiles with acceptable accuracy and in a short time which can be combined with other parts of a full simulation to predict the whole behaviours of an underwater vehicle 3 2 the effect of water entry velocity in order to investigate the effect of the water entry velocity two other water entry velocities which are equal to 2 08 m s and 8 32 m s are considered in addition to the previous case of 4 35 m s at an entry angle of 60 the other conditions for the simulations are similar to the case of the entry velocity of 4 35 m s and can be seen in table 2 the shapes of the water entry cavity are depicted in figs 14 and 15 for water entry velocities of 2 08 m s and 8 32 m s respectively also the results of the proposed model for the nose location and pitch angle of the projectile at different water entry velocities can be seen in fig 16 as figs 14 and 15 and the previous results of cavity shape for water entry velocity of 4 35 m s fig 6 show the transient shape of the cavity is similar at different entry velocities as can be seen in these three figures the necking of the cavity is started at about t 0 09 s for different entry velocities and the impact of the cavity to the lower section of the projectile body has occurred at about t 0 12 s however the planing force and moment differ for different entry velocities which results in different rotation of body after the impact fig 16 c shows that the rate of change of the pitch angle after the impact is higher for the case of lower entry velocity this figure shows that the time of impact changing the slope of the pitch angle is similar for three entry velocities and is approximately equal to 0 12 s but the rate of change of the pitch angle is higher for the case of the projectile with lower entry velocity 2 08 m s this result can be explained better using the graph of the angle of attack of the projectile during the water entry at three different velocities as shown in fig 16 d this figure indicates that the projectile has the same angle of attack at the beginning of the motion for three different velocities of water entry however the angle of attack of the projectile with lower velocity is higher during the planing which results in higher planing force and moment see eq 14 in other words the normal component of the velocity of the projectile is approximately similar for three cases due to the same gravitational force but the projectile with higher velocity has a higher axial component of the velocity during the water entry which results in a lower angle of attack α i m tan 1 w u l 2 q u the results of the horizontal and vertical displacements of the nose x n and z n are shown in fig 16 a and b respectively which show similar tendencies for three water entry velocities obviously the results indicate that by increasing the water entry velocity the vertical and horizontal displacements will rise 4 conclusion in the present study the complete modeling of the water entry of a cylindrical projectile has been considered and a new transient model of the cavity shape by the consideration of the memory effect of the cavity has been used for the development of the model the model could predict the impacts of the cavity on the cylinder body and identify which of the related forces and moments should be applied to the projectile during the motion equations of motion were developed for the projectile movement in the cavity while the cavity impacts different parts of the projectile it is tried to take into account all of the forces and moments such as the hydrostatic hydrodynamic cavitator frictional drag and planing which act on the projectile in order to increase the accuracy of the model the simulation results were compared with experimental test data of water entry and the results of the proposed model showed that it could predict the projectile motion and the trajectory of the projectile with good accuracy relative to the experimental data of water entry and in a relatively shorter time compared to the numerical studies finally a parametric study on the effect of the water entry angle and water entry velocity showed that the trajectory characteristics cavity shape and cavity contact point of the cylinder are sensitive to the water entry angle and velocity credit authorship contribution statement mojtaba mirzaei supervision writing review editing conceptualization methodology validation hossein taghvaei data curation software validation writing review editing mohammad mahdi alishahi validation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper appendix a supplementary data the following is are the supplementary data to this article data data appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j oceaneng 2020 107257 
21892,nonlinear numerical simulation has become an important tool for analysing dynamic responses and energy dissipation of structures during ship collision and grounding scenarios however determining a globally acknowledged failure criterion remains a challenging task in this paper a material model based on the johnson cook model and the gurson tvergaard needleman gtn model is proposed the gtn model assumes that the fracture of materials is caused by void growth and coalescence but it is only applicable to a relatively high value of the stress triaxiality and significantly overestimates the carrying capacity of materials under a shear loading condition moreover the gtn model is suitable for the relatively low strain rates while at higher strain rates such as structural impact problems the numerical simulation results are not accurate so the material model proposed in this paper solves this problem by including the strain rate effect and combining the void nucleation and coalescence furthermore in order to verify the accuracy of the proposed model s application in the ls dyna programme a set of model tests were conducted a quasi static tensile test high speed tensile test and falling weight impact test were performed by comparing the numerical simulation results with those of the experiment results it is determined that the proposed material model can describe the structural damage extremely well which demonstrates the proposed model s applicability for structural failure response prediction in ship collision and grounding simulations keywords ship collision and grounding failure criterion material constitutive model model test numerical simulation 1 introduction even though ship navigation systems have been greatly enhanced along with the development of various navigation technologies the risk of ship collision and grounding accidents still remains high with the development of the global shipping industry the number of ships sailing in the sea has increased significantly and the speed of ships is increasing as well so the probability of ship collision and grounding accidents increases correspondingly improving the crashworthiness of ships can reduce the loss in these accidents the finite element numerical simulation method is considered to be an important tool for determining the structural damage resistance and energy dissipation during ship collision and grounding accidents nevertheless it important to reasonably define the failure criterion of steel in a finite element numerical simulation because the failure significantly influences the energy dissipation capability of the steel material additionally the strain rate effect also has a significant influence on the numerical simulation of ship collision and grounding problems jones 1989 2014 liu and soares 2019 and the strain rate effect should be taken into account hence liu et al 2015 and storheim et al 2015 have been conducted on the failure criteria of steel in a finite element numerical simulation of ship collision and grounding scenarios the critical equivalent plastic strain method is one of the most commonly used methods in the finite element numerical simulations for large scale structures when the plastic strain reaches the critical value the material will fracture the simplified expressions can be used to estimate the critical failure strain liu and soares 2019 yang and wang 2019 because these simplified expressions are derived based on the uniaxial tensile tests which are verified by tests liu et al 2015 found that different mesh sizes can affect the failure strain values in numerical simulation yamada et al 2015 evaluated the effect of the fracture strain value on the structural response of two large crude oil vessels vlcc after collision lehmann and peschmann 2002 demonstrated that the definition of the failure criterion and its parameters play key roles in predicting the fracture of the hull structure as well as its resistance and energy dissipation wierzbicki et al 2005 found that when a material is subjected to a stress state different from that in the uniaxial tensile test such as a plate structure of a biaxial loading state or a pure shear state using the criterion of the critical equivalent plastic strain as the failure criterion is usually inaccurate keeler and b 1963 first proposed a forming limit diagram fld based on the strain state and the method gives the local instability ultimate strain under different strain paths through unidirectional or biaxial tension of the material arrieux et al 1982 improved the forming limit diagram based on the strain state stoughton and zhu 2004 performed tensile tests on metal under different pre strain conditions and found that the forming limit diagram based on the strain state is dependent on the variable paths therefore the forming limit diagram based on the strain state was transformed into a forming limit diagram based on the stress state since the change of the strain path has little effect on the forming limit diagram based on the stress state jiem 2009 and abubakar and dow 2013 improved the method and proved its rationality through its application in a finite element numerical simulation the bressan williams hill bwh criterion defines the occurrence of local necking as the beginning of fracture marinatos and samuelides 2015 proved that the bwh failure criterion exhibits a lower mesh sensitivity which is suitable for collision and grounding simulations of large scale structures in a finite element numerical simulation the use of a coarse mesh cannot capture the change of the state accurately and the use of a fine mesh will greatly increase the calculation time using the bwh criterion can effectively reduce the influence of the mesh size in addition the onset of instability can be given based on the stress strain curve of the material hogström et al 2009 demonstrated that using the bwh failure criterion can predict the necking phenomenon well the rice tracey crockroft latham criterion rtcl is another model used it is a combination of the improved rice tracey rice and tracey 1969 failure criterion and the cockcroft latham cockcroft and l 1968 failure criterion törnqvist 2003 briefly discussed the existing damage model and defined a separate damage category aimed at covering different stress states by a combination of these two criteria as a method of determining the occurrence of the fracture it is suitable for predicting the fracture of large plate structures subjected to accidental loading törnqvist 2003 when the rtcl criterion is applied to the finite element numerical simulation it can predict the structural fracture effectively in addition to the criteria listed above the failure of steel material can also be predicted by methods considering void growth and coalescence the internal relationship between void evolution and plastic potential is established by gurson s cell model with micro voids gurson 1977 which can describe the influence of micro voids induced damage on the plastic deformation of the material tvergaard and needleman 1984 and needleman and tvergaard 1984 considered the interaction between voids on the basis of the gurson model and the gurson model was later modified by introducing three modified parameters and equivalent voids volume fraction the modified model is called the gurson tvergaard needleman gtn model many investigations have been made on the basis of the gtn model liao et al 1997 described the normal anisotropy and in plane isotropy behaviour of a matrix material using hill s quadratic and non quadratic anisotropic yield criterion to obtain an approximate macroscopic yield criterion for the metal plate pardoen and hutchinson 2000 gologanu et al 2001 and benzerga 2002 considered the effects of stress triaxiality as well as the shape and distance between voids johnson and cook 1985 proposed a constitutive model that can describe the material under dynamic loading research indicates that the johnson cook constitutive model can describe the dynamic mechanical behaviour of the material well under impact especially the mechanical response of the material in the process of penetration such as shear loading dilellio and olmstead 2003 prawoto et al 2012 wang and shi 2013 in previous studies bonora 1999 brunet et al 2005 croix et al 2003 zhang et al 1999 the gtn model assumed that the fracture of materials was caused by void growth and coalescence but it was only applicable to the loading conditions with relative high values of stress triaxiality however the shear mode is prevailing in ship collision scenarios therefore it is necessary to study the shear failure atli veltin et al 2016 kõrgesaar 2019 for shear loading the gtn model significantly overestimates the material s load carrying capability nahshon and hutchinson 2008 in this paper in order to reflect the material properties and more accurately describe the ductile fracture behaviour of steel under shear loading situation a constitutive model based on the johnson cook model and the gurson tvergaard needleman gtn model is proposed the proposed constitutive model solves this problem to a satisfactory extent which includes the johnson cook model considering the strain rate and the gtn model considering the void nucleation and coalescence as collision problems involve high strain rates the strain rates in ship collision scenarios are on the order of several hundred per second liu et al 2015 the strain rates is mesh size dependent in collision numerical simulation when the mesh size is five to ten times the thickness of the plate the simulated strain rates will reach 100 s 1 the high strain rates usually last for a short time storheim and amdahl 2015 the johnson cook model takes the strain and strain rate of the material into account assuming that the isotropic strain and strain rate of the material are decoupled the strain hardening of the model is in the form of a power function while the strain rate hardening factor is in a logarithmic form the proposed constitutive model can describe the ductile fracture process of steel better and predict the structural response more accurately in numerical simulation of ship collision scenarios 2 description of the constitutive model the johnson cook gtn model consists of two parts the johnson cook model which expresses the flow yield stress and the gtn yield function model the strain rate effect is taken into account in the johnson cook model section 2 1 introduces the johnson cook model and section 2 2 introduces the main theoretical formulas of the gtn model 2 1 johnson cook model the collision problems involve high strain rates and the equivalent stress of the high strain rate material model can be expressed as 1 σ e q f ε p ε t where σ e q is the equivalent stress ε p is the equivalent plastic strain ε is the plastic strain rate and t is the temperature at a low strain rate the hardening process of metal follows the following relationship 2 σ e q σ 0 k ε p n where σ 0 is the initial yield stress n is the strain hardening index and k is the strength coefficient the effect of temperature on the flow stress can be expressed as 3 σ e q σ r 1 t m where σ r is the flow stress at room temperature t t t r t m t r 0 1 t is the dimensionless temperature t r is the reference temperature room temperature t m is the melting temperature of the material t is the instantaneous temperature and m the is heat softening index at initialization the temperature of all particles are set to room temperature the strain rate effect of the material is complex and can be simplified as 4 σ e q ln ε p based on these factors johnson and cook 1985 proposed the johnson cook constitutive model which can reflect the effects of strain hardening and the strain hardening rate the equivalent stress plastic strain can be expressed as follows 5 σ e q a b ε p n 1 c ln ε ε r 1 t m where the von mises equivalent stress σ e q 3 j 2 3 2 s i j s i j j 2 is the second invariant of the deviatoric stress tensor s ij is the deviatoric strain tensor a is the yield strength at the reference temperature and the reference strain rate quasi static state b is the strain hardening coefficient ε p is the equivalent plastic strain n is the strain hardening index c is the strain rate hardening coefficient the plastic strain rate ε 2 3 ε i j ε i j and ε r is the reference strain rate which is generally taken as 0 1 10 5 s 1 these parameters are determined based on the selected material the first term in the johnson cook constitutive equation corresponds to the quasi static material properties of dimensionless temperature t 0 and reference strain rate ε r equal to 0 1 10 5 s 1 the constitutive model becomes the following expression 6 σ e q a b ε p n the second term 1 c ln ε ε r and the third term 1 t m in the johnson cook constitutive equation correspond to the strain rate sensitivity and temperature sensitivity of the material the thermal softening of the material will affect the equivalent stress in the constitutive equation because of the high strain and high strain rate 2 2 gtn damage model gurson 1977 firstly proposed a mesoscopic damage constitutive model for ductile porous materials which can be used to describe the softening and cracking of macroscopic materials due to the continuous growth nucleation and polymerization of voids compared with the concept of plastic volume incompressibility in a traditional plastic model the effect of macroscopic hydrostatic stress on the yield surface is considered to better describe the interaction between voids tvergaard and needleman 1984 introduced three additional parameters q 1 q 2 and q 3 as the calibration coefficients the damage variable f is the total equivalent void volume fraction which is a function of the void volume fraction f introduced by needleman and tvergaard 1984 which explains the gradual decline of material carrying capacity due to void polymerization the gtn model can be expressed in the following form 7 φ σ e q σ m 2 2 q 1 f cosh 3 2 q 2 σ h σ m 1 q 3 f 2 0 where φ is the yield function equation σ m is the yield stress of the matrix material σ eq is the von mises equivalent stress of the material σ h σ kk 3 is the macroscopic hydrostatic stress and q 1 q 2 and q 3 are calibration coefficients when q 1 q 2 q 3 1 0 the gtn model becomes the original gurson model the damage variable f can be expressed as 8 f f f f c κ f f c f f c f f c where κ 1 q 1 f c f f f c is the void growth acceleration factor f c is the critical void volume fraction when the voids begin to polymerize and f f is the volume fraction of the void when the material fractures when f 0 it is indicated that the material is undamaged the equivalent plastic strain and porosity can control the expansion and contraction of the yield surface and the equivalent plastic strain increment d ε p can be expressed by the following formula 9 σ d ε p 1 f σ m d ε m p l therefore the cumulative equivalent plastic strain increment d ε m p l of the matrix material can be obtained as follows 10 d ε m p l σ d ε p 1 f σ m the change in the void volume fraction of the material is composed of two parts the growth of the existing voids and the nucleation of new voids the nucleation coefficient of the void is assumed to have a normal distribution so the following can be obtained 11 a f n s n 2 π exp 1 2 ε m p l ε n s n 2 where a is the nucleation coefficient of the void f n is the volume fraction of the nucleation void ε n is the average equivalent plastic strain at void nucleation and s n is the nucleation strain standard deviation the damage evolution of the material can be divided into two parts the growth of existing voids and the nucleation of new voids which can be expressed as follows 12 d f d f g r o w t h d f n u c l e a t i o n it is generally assumed that the matrix material is incompressible and the original void growth df growth is related to the hydrostatic component of the plastic strain 13 d f g r o w t h 1 f d ε p i where d ε p is the equivalent plastic strain increment and i is the second order unit tensor by means of strain control nucleation the nucleation of new voids can be expressed as follows chu and needleman 1980 14 d f n u c l e a t i o n m 1 d σ m a d ε m p l where m 1 is a parameter related to the void nucleation and the flow stress of the matrix 3 numerical implementation of the constitutive model in this section the numerical integration algorithm stress update algorithm of the constitutive equation is introduced the implementation of the johnson cook gtn model into the finite element software ls dyna is given fig 1 is a flow chart of the process when the yield surface flow rule and yield stress are determined the constitutive equation can be integrated combining the complete implicit backward euler stress update algorithm proposed by aravas 2010 with the explicit finite element calculation can avoid the implicit finite element method for solving the large stiffness matrix which is suitable for deformation analysis of sheet metal the stress update algorithm is composed of two parts elastic prediction and plastic correction the total strain can be divided into elastic strain and plastic strain ε ε e ε p the plastic strain is the summation of two parts δ ε p 1 3 δ ε h p l i δ ε e q p l n where δ ε h p l λ ϕ σ h δ ε e q p l λ ϕ σ e q n is the flow direction and λ is the scale factor the yield surface evolution is controlled by the void volume fraction f and the equivalent plastic strain ε m p l f t and f t δt represent the value f at time t and t δt respectively the concrete implementation process is shown as follows 1 obtain the initial values at time t ε t σ t h t α δ t δ t ε where t h a a 1 2 represents two internal state variables the void volume fraction and the equivalent plastic strain of the matrix 2 by assuming that the strain increment is purely elastic calculate the elastic stress 15 σ t δ t e σ t c δ t δ t ε where c is the elastic modulus calculate the hydrostatic stress of the trial elastic stress σ t δ t h e calculate the equivalent stress of the trial elastic stress σ t δ t e q e 3 the yield function is calculated to determine whether the current state enters plastic flow 16 φ t δ t e φ σ t δ t e q e σ t δ t h e h t α if φ t δ t e 0 the material is in the elastic state the trial elastic stress is the true stress therefore go directly to step 5 if φ t δ t e 0 the material is in the plastic state and the plastic correction in step 4 is required 4 plastic correction calculation to simplify the expression this step omits the left subscript t δt the newton raphson method is used to solve the nonlinear equations it is necessary to satisfy the flow rule and the yield condition simultaneously 17 f 1 δ k 1 ε h p l φ σ e q δ k 1 ε e q p l φ σ h 0 f 2 φ σ k 1 e q e σ k 1 h e h k 1 α 0 where δ ε h p l and δ ε e q p l are the increment of the hydrostatic plastic strain and the increment of the equivalent plastic strain respectively the iterative solution continues the calculation until both f 1 and f 2 are less than the tolerances which mean the solution converges otherwise the calculation is terminated for shell elements it is also necessary to satisfy that the stress in the thickness direction of the elements should be zero that is 18 σ 33 0 this can be rewritten as 19 f 3 σ e q 3 g δ ε e q p l σ h s 33 e 4 3 g δ ε 3 σ e q 0 where δε 3 is the strain increment in the thickness direction of elements 5 update stress and state variables for solid elements the hydrostatic stress and equivalent stress can be expressed as 20 σ t δ t h σ t δ t h e k δ ε h p l σ t δ t e q σ t δ t e q e 3 g δ ε e q p l for shell elements the hydrostatic stress and equivalent stress are 21 σ t δ t h σ t δ t h e k δ ε 3 δ ε h p l σ t δ t e q 3 g δ ε e q p l σ t δ t e q e 2 6 g s t δ t 33 e δ ε 3 4 g 2 δ ε 3 2 1 2 where k is the bulk modulus and g is the shear modulus update the stress 22 σ t δ t σ t δ t h i 2 3 σ t δ t e q n update the state variables 23 δ t δ t h 1 δ ε m p l σ h δ ε h p l σ e q δ ε e q p l 1 f σ m δ t δ t h 2 δ f 1 f δ ε h p l a δ ε m p l 24 h t δ t 1 ε t δ t m p l ε t m p l δ ε m p l h t δ t 2 f t δ t f t δ f f is updated by formula 8 6 go to the next time step fig 1 is the flow chart diagram of the stress update for the johnson cook gtn model the finite element software ls dyna allows users to add a custom material constitutive model using the dynamic link library ls dyna lib specifically for secondary development to achieve the embedded calculation of the johnson cook gtn model the main workflow of fig 1 is shown in the appendix 4 experimental validation although the nonlinear finite element method is a powerful tool for analysing the ship collision and grounding problem the reliability of the simulation results largely depends on the accurate selection of the main parameters in the finite element software therefore it is necessary to verify the finite element programme through experiments in this section the experimental validations are conducted the details of the experiments are introduced the static properties of the material are obtained by quasi static tensile tests and the dynamic properties of the material are obtained by high speed tensile tests the damage deformation mechanism of the stiffened plate is evaluated by the falling weight impact test section 4 1 introduces the quasi static tensile test section 4 2 describes the high speed tensile test the falling weight impact test is presented in section 4 3 4 1 quasi static tensile test the quasi static tensile test of the material can directly obtain the static mechanical properties of the material such as the elastic modulus tensile strength and yield stress at the same time the static stress strain curve of the material can be acquired by a tensile test which can approximately describe the plastic properties of the material after yielding based on this curve the material hardening relation curve can be obtained which is an important material characteristic parameter for performing the structural impact test fig 2 shows the quasi static tensile test device and the standard dimensions of the specimen gb t 288 1 2010 the loading speed is 1 0 mm min 1 until fracture occurs by the quasi static tensile test the basic mechanical properties and the engineering stress strain curve of the material can be obtained as shown in table 1 and fig 3 respectively moreover the material s density and poisson ratio are assumed to be 7850 kg m3 and 0 3 respectively which are taken from the literature 4 2 high speed tensile test mild steel is a commonly used material in the shipbuilding industry which is highly sensitive to the strain rate effect jones 2014 the ship collision process is a high energy impacting process and the structure of the collision zone rapidly transforms from an elastic state to a plastic flow state therefore the effect of the strain rate on the material should be considered at present the hopkinson press bar test and the high speed tensile test are the main methods of obtaining the dynamic characteristic parameters of the material the hopkinson press bar test is usually accurate for predicting the material dynamic characteristic under a high strain rate 1000 s 1 10000 s 1 and the high speed tensile test is mainly applicable to the relatively low strain rate less than 1000 s 1 huh et al 2009 in light of the actual situation of a ship collision and grounding the magnitude of the strain rate is approximately 102 s 1 therefore the stress strain relationships of mild steel under different strain rates were obtained by high speed tensile tests which provide the input parameters for numerical simulation of structural impact problem to improve the accuracy fig 4 is the high speed tensile test instrument the range of the loading rate can be from 0 02 mm s 1 to 4000 mm s 1 which can meet the requirements of the usual impact problem in addition the maximum dynamic load is up to 10 kn the total loading distance is 550 mm and the effective measurement range of the instrument is 1 2 mm 20 mm the use of a data acquisition system is a major advantage of the instrument as its frequency response is higher than 40 khz and the acquisition frequency is 2 5 mhz currently there is no relevant material manual for providing a reference standard for the size of a high speed tensile specimen therefore its design is mainly based on the requirements of related test equipment and experience fig 5 shows the tensile specimen and its dimensions for high speed tensile tests a good specimen should ensure uniform and sufficient deformation within the gauge length in addition in order to achieve a constant strain during a high speed stretch and meet the requirements of the measurement range of the poisson s ratio extensometer the gauge length should be small combining the effective strain rate selection range of the high speed tensile test and taking the actual situation of ship collision and grounding into account four groups of high speed tensile tests with strain rates of 1 s 1 10 s 1 100 s 1 and 500 s 1 were performed to ensure the reliability of the experimental results each group of experiments was conducted five times fig 6 shows the engineering stress strain curve obtained by the high speed tensile tests it can be seen from the figure that with an increase in the strain rate the stress of the material increases while the fracture strain decreases the engineering stress strain curve cannot truly reflect the characteristics of the material in the plastic deformation stage and needs to be properly corrected at present the combined material relationship curve based on the engineering stress strain relationship is usually used as the simulation input to solve the material hardening problem villavicencio and soares 2011 before necking the true stress strain relationship of the material can be obtained by the engineering stress strain relationship dieter 1986 25 σ t σ e ε e 1 26 ε t ln ε e 1 after necking the true stress strain relationship of the material can be obtained by the following formula zhang et al 2004 27 σ t c ε t n where 28 n ln 1 a g 29 c r m e n n where a g is a parameter related to the stress r m at the time of fracture the parameter c in equations 27 and 29 is different from the parameter c in equation 5 r m is the ultimate tensile stress e is the natural logarithmic constant and a g can be obtained by the following formula 30 a g 1 0 24 0 01395 r m the combined material relationship curve obtained according to the above method can be directly used as the input for the impact simulation the four groups of engineering stress strain curves at different strain rates obtained by high speed tensile tests can be converted to the corresponding combined material relationship curves by the above method as shown in fig 7 as the engineering stress strain curve cannot provide a true indication of the deformation characteristics of the metal therefore the combined material relationship curve has to be used to represent the basic plastic flow characteristics of the material the combined material relationship curve has been used to predict the numerical plastic response without failure strain there the curves in fig 7 do not include the failure point 4 3 falling weight impact test the structure dynamic response and damage deformation mechanism of the stiffened plate were obtained by a falling weight impact test fig 8 shows the falling weight impact tester the height of the falling weight impact tester is 6 3 m and the indenter can fall at any height within the range of 0 m 3 7 m therefore the maximum impact speed of the falling weight impact tester can reach 8 5 m s 1 which can fully meet the speed simulation of ship collision and grounding scenario the falling weight consists of 12 pieces of 12 5 kg blocks and the blocks can be used to adjust the impact mass of the indenter so the maximum impact mass of the indenter is 1350 kg a force sensor is arranged between the indenter and the load cell to record the change of the force during the process of impact the maximum impact energy of the falling weight impact tester is 50 kj the system is also equipped with a series of indenters of different shapes and sizes which can satisfy the need of different test requirements the drop height in this test is 3 7 m and the maximum mass is 1350 kg to ensure the failure of the stiffened plate fig 9 shows the indenter and additional weights the radius of the indenter is 75 mm and the shape is hemispherical at the end fig 10 shows the specimen stiffened plate and its dimensions the thickness of the stiffened plate is 6 mm and its length is 1060 mm 1060 mm three stiffeners are attached to the stiffened plate the length of each stiffener is 1000 mm and all of the stiffeners are 50 mm 6 mm flat bars the stiffened panel was welded around the inner edge of the supporter to ensure adequate rigidity constraints and reduce the complexity of boundary simulation during the finite element numerical simulation the supporter is rigid enough to prevent any movement and is shown in fig 11 table 2 presents the detailed collision parameters of this test fig 12 shows the impact force displacement relationship curve of the stiffened plate this curve can accurately reflect the dynamic response of the specimen during the impact process and the slope of the curve in the figure represents the ability of the stiffened plate to resist the impact load the damage deformation of the stiffened plate is shown in fig 13 it can be seen from the figure that the damage range of the stiffened plate is concentrated in the impact contact area the deformation mainly includes two parts the overall deformation and the local deformation among these parts the local deformation is consistent with the shape of the indenter and the impact kinetic energy causes the stiffened panel to tear due to its failure strain being exceeded in addition the stiffened structure has an in plane bending deformation and buckling failure near the contact area 5 numerical validations and discussion using the numerical implementation method of section 3 the johnson cook gtn model was implemented by a user defined material subroutine in the finite element software ls dyna to verify the correctness of the subroutine a series of numerical tests were performed the results obtained by numerical calculations using the johnson cook gtn constitutive model are compared with the test results 5 1 numerical simulation of the quasi static tensile test the finite element model of the quasi static tensile test specimen is shown in fig 14 the model is established by shell elements with a mesh size of 2 0 mm 2 0 mm along the gage length the standard dimensions of the specimen and basic mechanical properties of mild steel are shown in fig 2 and table 1 respectively one end of the specimen is rigidly fixed and the other end of the specimen is conducted at a loading rate of 1 mm min 1 until fracture occurs most of the parameters in the gtn model cannot be directly determined by experiments so these parameters are usually taken as adjustable parameters by adjusting these parameters the numerical simulation result of the tensile test is consistent with the experimental result which means that the values of the selected parameters can reflect the damage law of the material the parameters of the johnson cook model are selected according to reference lin et al 2014 the material parameters used are shown in table 3 and table 4 respectively fig 15 shows the comparison of the numerical simulation results and test results when the necking phenomenon occurs the damage and the maximum stress are mainly concentrated near the symmetry centre of the tensile specimen the fracture occurs when the volume fraction of the void reaches the fracture volume fraction f f the comparison of engineering stress strain curve from the numerical simulations and the tension test is illustrated in fig 16 which proves the rationality of the selected parameters 5 2 numerical simulation of falling weight impact test the strain rate is considered in the johnson cook gtn model so numerical simulations of the falling weight impact test can verify the accuracy of the johnson cook gtn model fig 17 shows the finite element model in ls dyna the stiffened plate is established by shell elements with a mesh size of 6 mm all the elements are four nodes belytschko tsay elements which have the advantages of numerical stability for large deformation problems and a fast calculation speed the material parameters used are listed in tables 3 and 4 of section 5 1 a comparison of the damage deformation between test and simulation are illustrated in fig 18 the simulation results show that the structural fracture size failure mode and overall damage distribution are in good agreement with the experimental results in addition it can also be clearly seen from the numerical simulation deformation figure that the fracture on the stiffened plate is concentrated in the position of the indenter while the rest area without direct contact with the indenter is the overall bending deformation the vertical force versus the displacement curves from the experimental and numerical simulations are illustrated in fig 19 in addition numerical simulations of the stiffened plate models with different mesh sizes were also conducted table 5 shows the peak values of the impact force 5 3 numerical simulation of asis model test the asis model test was performed in 1993 in japan to study the failure mechanism of a tanker s side structures the scale ratio of the model test is 1 2 and the ship side model in the test is a section of the vlcc side which includes a section of deck three spaces of transverse webs and the attached stiffeners as shown in fig 20 a the indenter model is 1 0 m long and 1 0 m high and the radius of the bottom cylinder is 0 5 m as shown in fig 20 b kuroiwa 1993 in the asis model test the impact position was selected in the plane of the deck plate between the two transverse webs as illustrated in fig 20 a the material of the ship side model is mild steel and the main parameters in the model test are listed in table 6 the asis model test consists of two parts a dynamic impact test and a quasi static test fig 21 shows the deformation of the ship side model after the quasi static test in the numerical simulation only the asis quasi static test was selected for the ship side finite element model the four node belytschko tsay element is selected hallquist 2006 as the calculation model is relatively simple an overall mesh size of 20 mm is used to obtain a satisfactory calculation accuracy the ship side finite element model is illustrated in fig 22 the gtn parameters are obtained from tvergaard and needleman 1988 the johnson cook parameters are obtained from schwer 2007 and the material parameters used are listed in table 7 and table 8 the side model is fixed at six degrees of freedom at both ends of the longitudinal direction the six degrees of freedom at the inner edge of the deck was similarly fixed it is assumed that the indenter is rigid and the impact velocity is set to 2 m s 1 which is selected considering the balance between the calculation accuracy and the calculation speed in fact the study by samuelides et al 2007 showed that the impact velocity has a certain influence on the deformation of the structure in the contact definition the contact between the indenter and the side structure uses the automatic surface to surface in the ls dyna and the deformation of the side structure is automatically a single surface the stringer deck in the asis test model is subjected to shear loading as shown in fig 20 so numerical simulation of the asis test can verify the accuracy of the johnson cook gtn model subjected to shear loading fig 23 shows the deformation of side structures and the comparison of numerical simulation results and the asis model test results is shown in fig 24 5 4 discussion strain rate sensitivity plays an important role in the calculation and analysis of structural impact problems in the numerical simulation of falling weight impact test the results of the johnson cook gtn model considering strain rate and the numerical simulation results of a combined material relationship curve obtained from a high speed tensile test as a simulation input are compared with the test results it can be observed from fig 19 that the three groups of curves are in good agreement all of the curves first increase and later decrease with only one peak of impact force the experimental curve fluctuates more than the numerical simulation curve due to the influence of the welding seam which is ignored in the numerical simulation the influence of different mesh sizes on the damage deformation of the stiffened plate and impact force is uncertain therefore only the peak values of the impact force at different mesh sizes of the stiffened plate models are listed in table 5 it can be determined from the data in the table that with an increase in the mesh size the peak values of the impact force calculated by numerical simulations are still relatively close to the test result to a certain extent in the numerical simulation of the asis model test it can be seen from fig 24 that the two groups of curves agree well when the indenter is in contact with the side model the collision force appears at a peak value before slightly decreasing afterwards with an increase in impact depth the impact force gradually increases in general the impact behaviour can be well reflected by numerical simulation which validates the correctness of the johnson cook gtn model for the johnson cook gtn model the flow yield stress expression of the johnson cook model and the gtn yield function are adopted as collision problems involve high strain rates the johnson cook model takes the strain and strain rate of the material into account assuming that the isotropic strain and strain rate of the material are decoupled and the equivalent stress of high strain rate material model can be expressed as 31 σ e q f ε p ε t f 1 ε p f 2 ε f 3 t the strain hardening of the model is in the form of a power function while the strain rate hardening factor is in logarithmic form as shown in equation 32 therefore the dynamic mechanical behaviour of the material under impact can be well characterized 32 σ e q a b ε p n strain effect 1 c ln ε ε r strain rate effect 1 t m by comparing the numerical simulation results with those of the experiment results it is determined that the proposed johnson cook gtn constitutive model can describe the structural damage extremely well which demonstrates that the proposed model s applicability for structural failure response prediction 6 conclusions to better describe the ductile fracture process of steel and predict the structural deformation damage during ship collisions and grounding accidents a material model based on the johnson cook model considering the strain rate combined with void nucleation and coalescence in the gtn model is proposed next the material model is implemented by a user defined material subroutine in the finite element software ls dyna in previous studies the gtn model assumed that the fracture of materials was caused by void growth and coalescence but it was only applicable to relatively high values of stress loading conditions for shear loading the gtn model will significantly overestimate the carrying capacity of materials moreover the gtn model is suitable for the relatively low strain rates while at higher strain rates such as structural impact problems the numerical simulation results are not accurate so the material model proposed in this paper solves this problem to a satisfying extent therefore this work will be helpful for researching ship collision and grounding simulations in the future the material properties were obtained by a quasi static tensile test and the stress strain relationship curves at different strain rates were obtained by high speed tensile tests next the stress strain relationship curves at different strain rates were converted to combined material relationship curves the numerical simulation result of the quasi static tensile test proves the rationality of the selected parameters and the accuracy of the johnson cook gtn model the influence of the strain rate needs to be considered in the impact problem and the falling weight impact test numerical simulation results of the johnson cook gtn model are also compared with the numerical simulation results of the combined material relationship curve as the simulation input and test results their comparison results demonstrate the accuracy and applicability of the proposed method in this paper the asis test numerical simulation results of the johnson cook gtn model are also compared with the test results and the accuracy of the johnson cook gtn model subjected to shear loading is validated therefore the johnson cook gtn model can better predict structural deformation damage in ship collision and grounding simulations declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements we gratefully acknowledge the financial support of the national natural science foundation of china grant no 51779110 appendix the main workflow of fig 1 is divided into three steps 1 the johnson cook gtn model is written into a umat file in the fortran language and a new executable file ls dyna exe is compiled in the fortran compiler with the ls dyna lib database 2 the keyword mat user defined material models is used to define the user material parameters and generate a k file 3 before solving select the generated ls dyna exe in the ls dyna manager to solve and achieve the use of the umat file 
21892,nonlinear numerical simulation has become an important tool for analysing dynamic responses and energy dissipation of structures during ship collision and grounding scenarios however determining a globally acknowledged failure criterion remains a challenging task in this paper a material model based on the johnson cook model and the gurson tvergaard needleman gtn model is proposed the gtn model assumes that the fracture of materials is caused by void growth and coalescence but it is only applicable to a relatively high value of the stress triaxiality and significantly overestimates the carrying capacity of materials under a shear loading condition moreover the gtn model is suitable for the relatively low strain rates while at higher strain rates such as structural impact problems the numerical simulation results are not accurate so the material model proposed in this paper solves this problem by including the strain rate effect and combining the void nucleation and coalescence furthermore in order to verify the accuracy of the proposed model s application in the ls dyna programme a set of model tests were conducted a quasi static tensile test high speed tensile test and falling weight impact test were performed by comparing the numerical simulation results with those of the experiment results it is determined that the proposed material model can describe the structural damage extremely well which demonstrates the proposed model s applicability for structural failure response prediction in ship collision and grounding simulations keywords ship collision and grounding failure criterion material constitutive model model test numerical simulation 1 introduction even though ship navigation systems have been greatly enhanced along with the development of various navigation technologies the risk of ship collision and grounding accidents still remains high with the development of the global shipping industry the number of ships sailing in the sea has increased significantly and the speed of ships is increasing as well so the probability of ship collision and grounding accidents increases correspondingly improving the crashworthiness of ships can reduce the loss in these accidents the finite element numerical simulation method is considered to be an important tool for determining the structural damage resistance and energy dissipation during ship collision and grounding accidents nevertheless it important to reasonably define the failure criterion of steel in a finite element numerical simulation because the failure significantly influences the energy dissipation capability of the steel material additionally the strain rate effect also has a significant influence on the numerical simulation of ship collision and grounding problems jones 1989 2014 liu and soares 2019 and the strain rate effect should be taken into account hence liu et al 2015 and storheim et al 2015 have been conducted on the failure criteria of steel in a finite element numerical simulation of ship collision and grounding scenarios the critical equivalent plastic strain method is one of the most commonly used methods in the finite element numerical simulations for large scale structures when the plastic strain reaches the critical value the material will fracture the simplified expressions can be used to estimate the critical failure strain liu and soares 2019 yang and wang 2019 because these simplified expressions are derived based on the uniaxial tensile tests which are verified by tests liu et al 2015 found that different mesh sizes can affect the failure strain values in numerical simulation yamada et al 2015 evaluated the effect of the fracture strain value on the structural response of two large crude oil vessels vlcc after collision lehmann and peschmann 2002 demonstrated that the definition of the failure criterion and its parameters play key roles in predicting the fracture of the hull structure as well as its resistance and energy dissipation wierzbicki et al 2005 found that when a material is subjected to a stress state different from that in the uniaxial tensile test such as a plate structure of a biaxial loading state or a pure shear state using the criterion of the critical equivalent plastic strain as the failure criterion is usually inaccurate keeler and b 1963 first proposed a forming limit diagram fld based on the strain state and the method gives the local instability ultimate strain under different strain paths through unidirectional or biaxial tension of the material arrieux et al 1982 improved the forming limit diagram based on the strain state stoughton and zhu 2004 performed tensile tests on metal under different pre strain conditions and found that the forming limit diagram based on the strain state is dependent on the variable paths therefore the forming limit diagram based on the strain state was transformed into a forming limit diagram based on the stress state since the change of the strain path has little effect on the forming limit diagram based on the stress state jiem 2009 and abubakar and dow 2013 improved the method and proved its rationality through its application in a finite element numerical simulation the bressan williams hill bwh criterion defines the occurrence of local necking as the beginning of fracture marinatos and samuelides 2015 proved that the bwh failure criterion exhibits a lower mesh sensitivity which is suitable for collision and grounding simulations of large scale structures in a finite element numerical simulation the use of a coarse mesh cannot capture the change of the state accurately and the use of a fine mesh will greatly increase the calculation time using the bwh criterion can effectively reduce the influence of the mesh size in addition the onset of instability can be given based on the stress strain curve of the material hogström et al 2009 demonstrated that using the bwh failure criterion can predict the necking phenomenon well the rice tracey crockroft latham criterion rtcl is another model used it is a combination of the improved rice tracey rice and tracey 1969 failure criterion and the cockcroft latham cockcroft and l 1968 failure criterion törnqvist 2003 briefly discussed the existing damage model and defined a separate damage category aimed at covering different stress states by a combination of these two criteria as a method of determining the occurrence of the fracture it is suitable for predicting the fracture of large plate structures subjected to accidental loading törnqvist 2003 when the rtcl criterion is applied to the finite element numerical simulation it can predict the structural fracture effectively in addition to the criteria listed above the failure of steel material can also be predicted by methods considering void growth and coalescence the internal relationship between void evolution and plastic potential is established by gurson s cell model with micro voids gurson 1977 which can describe the influence of micro voids induced damage on the plastic deformation of the material tvergaard and needleman 1984 and needleman and tvergaard 1984 considered the interaction between voids on the basis of the gurson model and the gurson model was later modified by introducing three modified parameters and equivalent voids volume fraction the modified model is called the gurson tvergaard needleman gtn model many investigations have been made on the basis of the gtn model liao et al 1997 described the normal anisotropy and in plane isotropy behaviour of a matrix material using hill s quadratic and non quadratic anisotropic yield criterion to obtain an approximate macroscopic yield criterion for the metal plate pardoen and hutchinson 2000 gologanu et al 2001 and benzerga 2002 considered the effects of stress triaxiality as well as the shape and distance between voids johnson and cook 1985 proposed a constitutive model that can describe the material under dynamic loading research indicates that the johnson cook constitutive model can describe the dynamic mechanical behaviour of the material well under impact especially the mechanical response of the material in the process of penetration such as shear loading dilellio and olmstead 2003 prawoto et al 2012 wang and shi 2013 in previous studies bonora 1999 brunet et al 2005 croix et al 2003 zhang et al 1999 the gtn model assumed that the fracture of materials was caused by void growth and coalescence but it was only applicable to the loading conditions with relative high values of stress triaxiality however the shear mode is prevailing in ship collision scenarios therefore it is necessary to study the shear failure atli veltin et al 2016 kõrgesaar 2019 for shear loading the gtn model significantly overestimates the material s load carrying capability nahshon and hutchinson 2008 in this paper in order to reflect the material properties and more accurately describe the ductile fracture behaviour of steel under shear loading situation a constitutive model based on the johnson cook model and the gurson tvergaard needleman gtn model is proposed the proposed constitutive model solves this problem to a satisfactory extent which includes the johnson cook model considering the strain rate and the gtn model considering the void nucleation and coalescence as collision problems involve high strain rates the strain rates in ship collision scenarios are on the order of several hundred per second liu et al 2015 the strain rates is mesh size dependent in collision numerical simulation when the mesh size is five to ten times the thickness of the plate the simulated strain rates will reach 100 s 1 the high strain rates usually last for a short time storheim and amdahl 2015 the johnson cook model takes the strain and strain rate of the material into account assuming that the isotropic strain and strain rate of the material are decoupled the strain hardening of the model is in the form of a power function while the strain rate hardening factor is in a logarithmic form the proposed constitutive model can describe the ductile fracture process of steel better and predict the structural response more accurately in numerical simulation of ship collision scenarios 2 description of the constitutive model the johnson cook gtn model consists of two parts the johnson cook model which expresses the flow yield stress and the gtn yield function model the strain rate effect is taken into account in the johnson cook model section 2 1 introduces the johnson cook model and section 2 2 introduces the main theoretical formulas of the gtn model 2 1 johnson cook model the collision problems involve high strain rates and the equivalent stress of the high strain rate material model can be expressed as 1 σ e q f ε p ε t where σ e q is the equivalent stress ε p is the equivalent plastic strain ε is the plastic strain rate and t is the temperature at a low strain rate the hardening process of metal follows the following relationship 2 σ e q σ 0 k ε p n where σ 0 is the initial yield stress n is the strain hardening index and k is the strength coefficient the effect of temperature on the flow stress can be expressed as 3 σ e q σ r 1 t m where σ r is the flow stress at room temperature t t t r t m t r 0 1 t is the dimensionless temperature t r is the reference temperature room temperature t m is the melting temperature of the material t is the instantaneous temperature and m the is heat softening index at initialization the temperature of all particles are set to room temperature the strain rate effect of the material is complex and can be simplified as 4 σ e q ln ε p based on these factors johnson and cook 1985 proposed the johnson cook constitutive model which can reflect the effects of strain hardening and the strain hardening rate the equivalent stress plastic strain can be expressed as follows 5 σ e q a b ε p n 1 c ln ε ε r 1 t m where the von mises equivalent stress σ e q 3 j 2 3 2 s i j s i j j 2 is the second invariant of the deviatoric stress tensor s ij is the deviatoric strain tensor a is the yield strength at the reference temperature and the reference strain rate quasi static state b is the strain hardening coefficient ε p is the equivalent plastic strain n is the strain hardening index c is the strain rate hardening coefficient the plastic strain rate ε 2 3 ε i j ε i j and ε r is the reference strain rate which is generally taken as 0 1 10 5 s 1 these parameters are determined based on the selected material the first term in the johnson cook constitutive equation corresponds to the quasi static material properties of dimensionless temperature t 0 and reference strain rate ε r equal to 0 1 10 5 s 1 the constitutive model becomes the following expression 6 σ e q a b ε p n the second term 1 c ln ε ε r and the third term 1 t m in the johnson cook constitutive equation correspond to the strain rate sensitivity and temperature sensitivity of the material the thermal softening of the material will affect the equivalent stress in the constitutive equation because of the high strain and high strain rate 2 2 gtn damage model gurson 1977 firstly proposed a mesoscopic damage constitutive model for ductile porous materials which can be used to describe the softening and cracking of macroscopic materials due to the continuous growth nucleation and polymerization of voids compared with the concept of plastic volume incompressibility in a traditional plastic model the effect of macroscopic hydrostatic stress on the yield surface is considered to better describe the interaction between voids tvergaard and needleman 1984 introduced three additional parameters q 1 q 2 and q 3 as the calibration coefficients the damage variable f is the total equivalent void volume fraction which is a function of the void volume fraction f introduced by needleman and tvergaard 1984 which explains the gradual decline of material carrying capacity due to void polymerization the gtn model can be expressed in the following form 7 φ σ e q σ m 2 2 q 1 f cosh 3 2 q 2 σ h σ m 1 q 3 f 2 0 where φ is the yield function equation σ m is the yield stress of the matrix material σ eq is the von mises equivalent stress of the material σ h σ kk 3 is the macroscopic hydrostatic stress and q 1 q 2 and q 3 are calibration coefficients when q 1 q 2 q 3 1 0 the gtn model becomes the original gurson model the damage variable f can be expressed as 8 f f f f c κ f f c f f c f f c where κ 1 q 1 f c f f f c is the void growth acceleration factor f c is the critical void volume fraction when the voids begin to polymerize and f f is the volume fraction of the void when the material fractures when f 0 it is indicated that the material is undamaged the equivalent plastic strain and porosity can control the expansion and contraction of the yield surface and the equivalent plastic strain increment d ε p can be expressed by the following formula 9 σ d ε p 1 f σ m d ε m p l therefore the cumulative equivalent plastic strain increment d ε m p l of the matrix material can be obtained as follows 10 d ε m p l σ d ε p 1 f σ m the change in the void volume fraction of the material is composed of two parts the growth of the existing voids and the nucleation of new voids the nucleation coefficient of the void is assumed to have a normal distribution so the following can be obtained 11 a f n s n 2 π exp 1 2 ε m p l ε n s n 2 where a is the nucleation coefficient of the void f n is the volume fraction of the nucleation void ε n is the average equivalent plastic strain at void nucleation and s n is the nucleation strain standard deviation the damage evolution of the material can be divided into two parts the growth of existing voids and the nucleation of new voids which can be expressed as follows 12 d f d f g r o w t h d f n u c l e a t i o n it is generally assumed that the matrix material is incompressible and the original void growth df growth is related to the hydrostatic component of the plastic strain 13 d f g r o w t h 1 f d ε p i where d ε p is the equivalent plastic strain increment and i is the second order unit tensor by means of strain control nucleation the nucleation of new voids can be expressed as follows chu and needleman 1980 14 d f n u c l e a t i o n m 1 d σ m a d ε m p l where m 1 is a parameter related to the void nucleation and the flow stress of the matrix 3 numerical implementation of the constitutive model in this section the numerical integration algorithm stress update algorithm of the constitutive equation is introduced the implementation of the johnson cook gtn model into the finite element software ls dyna is given fig 1 is a flow chart of the process when the yield surface flow rule and yield stress are determined the constitutive equation can be integrated combining the complete implicit backward euler stress update algorithm proposed by aravas 2010 with the explicit finite element calculation can avoid the implicit finite element method for solving the large stiffness matrix which is suitable for deformation analysis of sheet metal the stress update algorithm is composed of two parts elastic prediction and plastic correction the total strain can be divided into elastic strain and plastic strain ε ε e ε p the plastic strain is the summation of two parts δ ε p 1 3 δ ε h p l i δ ε e q p l n where δ ε h p l λ ϕ σ h δ ε e q p l λ ϕ σ e q n is the flow direction and λ is the scale factor the yield surface evolution is controlled by the void volume fraction f and the equivalent plastic strain ε m p l f t and f t δt represent the value f at time t and t δt respectively the concrete implementation process is shown as follows 1 obtain the initial values at time t ε t σ t h t α δ t δ t ε where t h a a 1 2 represents two internal state variables the void volume fraction and the equivalent plastic strain of the matrix 2 by assuming that the strain increment is purely elastic calculate the elastic stress 15 σ t δ t e σ t c δ t δ t ε where c is the elastic modulus calculate the hydrostatic stress of the trial elastic stress σ t δ t h e calculate the equivalent stress of the trial elastic stress σ t δ t e q e 3 the yield function is calculated to determine whether the current state enters plastic flow 16 φ t δ t e φ σ t δ t e q e σ t δ t h e h t α if φ t δ t e 0 the material is in the elastic state the trial elastic stress is the true stress therefore go directly to step 5 if φ t δ t e 0 the material is in the plastic state and the plastic correction in step 4 is required 4 plastic correction calculation to simplify the expression this step omits the left subscript t δt the newton raphson method is used to solve the nonlinear equations it is necessary to satisfy the flow rule and the yield condition simultaneously 17 f 1 δ k 1 ε h p l φ σ e q δ k 1 ε e q p l φ σ h 0 f 2 φ σ k 1 e q e σ k 1 h e h k 1 α 0 where δ ε h p l and δ ε e q p l are the increment of the hydrostatic plastic strain and the increment of the equivalent plastic strain respectively the iterative solution continues the calculation until both f 1 and f 2 are less than the tolerances which mean the solution converges otherwise the calculation is terminated for shell elements it is also necessary to satisfy that the stress in the thickness direction of the elements should be zero that is 18 σ 33 0 this can be rewritten as 19 f 3 σ e q 3 g δ ε e q p l σ h s 33 e 4 3 g δ ε 3 σ e q 0 where δε 3 is the strain increment in the thickness direction of elements 5 update stress and state variables for solid elements the hydrostatic stress and equivalent stress can be expressed as 20 σ t δ t h σ t δ t h e k δ ε h p l σ t δ t e q σ t δ t e q e 3 g δ ε e q p l for shell elements the hydrostatic stress and equivalent stress are 21 σ t δ t h σ t δ t h e k δ ε 3 δ ε h p l σ t δ t e q 3 g δ ε e q p l σ t δ t e q e 2 6 g s t δ t 33 e δ ε 3 4 g 2 δ ε 3 2 1 2 where k is the bulk modulus and g is the shear modulus update the stress 22 σ t δ t σ t δ t h i 2 3 σ t δ t e q n update the state variables 23 δ t δ t h 1 δ ε m p l σ h δ ε h p l σ e q δ ε e q p l 1 f σ m δ t δ t h 2 δ f 1 f δ ε h p l a δ ε m p l 24 h t δ t 1 ε t δ t m p l ε t m p l δ ε m p l h t δ t 2 f t δ t f t δ f f is updated by formula 8 6 go to the next time step fig 1 is the flow chart diagram of the stress update for the johnson cook gtn model the finite element software ls dyna allows users to add a custom material constitutive model using the dynamic link library ls dyna lib specifically for secondary development to achieve the embedded calculation of the johnson cook gtn model the main workflow of fig 1 is shown in the appendix 4 experimental validation although the nonlinear finite element method is a powerful tool for analysing the ship collision and grounding problem the reliability of the simulation results largely depends on the accurate selection of the main parameters in the finite element software therefore it is necessary to verify the finite element programme through experiments in this section the experimental validations are conducted the details of the experiments are introduced the static properties of the material are obtained by quasi static tensile tests and the dynamic properties of the material are obtained by high speed tensile tests the damage deformation mechanism of the stiffened plate is evaluated by the falling weight impact test section 4 1 introduces the quasi static tensile test section 4 2 describes the high speed tensile test the falling weight impact test is presented in section 4 3 4 1 quasi static tensile test the quasi static tensile test of the material can directly obtain the static mechanical properties of the material such as the elastic modulus tensile strength and yield stress at the same time the static stress strain curve of the material can be acquired by a tensile test which can approximately describe the plastic properties of the material after yielding based on this curve the material hardening relation curve can be obtained which is an important material characteristic parameter for performing the structural impact test fig 2 shows the quasi static tensile test device and the standard dimensions of the specimen gb t 288 1 2010 the loading speed is 1 0 mm min 1 until fracture occurs by the quasi static tensile test the basic mechanical properties and the engineering stress strain curve of the material can be obtained as shown in table 1 and fig 3 respectively moreover the material s density and poisson ratio are assumed to be 7850 kg m3 and 0 3 respectively which are taken from the literature 4 2 high speed tensile test mild steel is a commonly used material in the shipbuilding industry which is highly sensitive to the strain rate effect jones 2014 the ship collision process is a high energy impacting process and the structure of the collision zone rapidly transforms from an elastic state to a plastic flow state therefore the effect of the strain rate on the material should be considered at present the hopkinson press bar test and the high speed tensile test are the main methods of obtaining the dynamic characteristic parameters of the material the hopkinson press bar test is usually accurate for predicting the material dynamic characteristic under a high strain rate 1000 s 1 10000 s 1 and the high speed tensile test is mainly applicable to the relatively low strain rate less than 1000 s 1 huh et al 2009 in light of the actual situation of a ship collision and grounding the magnitude of the strain rate is approximately 102 s 1 therefore the stress strain relationships of mild steel under different strain rates were obtained by high speed tensile tests which provide the input parameters for numerical simulation of structural impact problem to improve the accuracy fig 4 is the high speed tensile test instrument the range of the loading rate can be from 0 02 mm s 1 to 4000 mm s 1 which can meet the requirements of the usual impact problem in addition the maximum dynamic load is up to 10 kn the total loading distance is 550 mm and the effective measurement range of the instrument is 1 2 mm 20 mm the use of a data acquisition system is a major advantage of the instrument as its frequency response is higher than 40 khz and the acquisition frequency is 2 5 mhz currently there is no relevant material manual for providing a reference standard for the size of a high speed tensile specimen therefore its design is mainly based on the requirements of related test equipment and experience fig 5 shows the tensile specimen and its dimensions for high speed tensile tests a good specimen should ensure uniform and sufficient deformation within the gauge length in addition in order to achieve a constant strain during a high speed stretch and meet the requirements of the measurement range of the poisson s ratio extensometer the gauge length should be small combining the effective strain rate selection range of the high speed tensile test and taking the actual situation of ship collision and grounding into account four groups of high speed tensile tests with strain rates of 1 s 1 10 s 1 100 s 1 and 500 s 1 were performed to ensure the reliability of the experimental results each group of experiments was conducted five times fig 6 shows the engineering stress strain curve obtained by the high speed tensile tests it can be seen from the figure that with an increase in the strain rate the stress of the material increases while the fracture strain decreases the engineering stress strain curve cannot truly reflect the characteristics of the material in the plastic deformation stage and needs to be properly corrected at present the combined material relationship curve based on the engineering stress strain relationship is usually used as the simulation input to solve the material hardening problem villavicencio and soares 2011 before necking the true stress strain relationship of the material can be obtained by the engineering stress strain relationship dieter 1986 25 σ t σ e ε e 1 26 ε t ln ε e 1 after necking the true stress strain relationship of the material can be obtained by the following formula zhang et al 2004 27 σ t c ε t n where 28 n ln 1 a g 29 c r m e n n where a g is a parameter related to the stress r m at the time of fracture the parameter c in equations 27 and 29 is different from the parameter c in equation 5 r m is the ultimate tensile stress e is the natural logarithmic constant and a g can be obtained by the following formula 30 a g 1 0 24 0 01395 r m the combined material relationship curve obtained according to the above method can be directly used as the input for the impact simulation the four groups of engineering stress strain curves at different strain rates obtained by high speed tensile tests can be converted to the corresponding combined material relationship curves by the above method as shown in fig 7 as the engineering stress strain curve cannot provide a true indication of the deformation characteristics of the metal therefore the combined material relationship curve has to be used to represent the basic plastic flow characteristics of the material the combined material relationship curve has been used to predict the numerical plastic response without failure strain there the curves in fig 7 do not include the failure point 4 3 falling weight impact test the structure dynamic response and damage deformation mechanism of the stiffened plate were obtained by a falling weight impact test fig 8 shows the falling weight impact tester the height of the falling weight impact tester is 6 3 m and the indenter can fall at any height within the range of 0 m 3 7 m therefore the maximum impact speed of the falling weight impact tester can reach 8 5 m s 1 which can fully meet the speed simulation of ship collision and grounding scenario the falling weight consists of 12 pieces of 12 5 kg blocks and the blocks can be used to adjust the impact mass of the indenter so the maximum impact mass of the indenter is 1350 kg a force sensor is arranged between the indenter and the load cell to record the change of the force during the process of impact the maximum impact energy of the falling weight impact tester is 50 kj the system is also equipped with a series of indenters of different shapes and sizes which can satisfy the need of different test requirements the drop height in this test is 3 7 m and the maximum mass is 1350 kg to ensure the failure of the stiffened plate fig 9 shows the indenter and additional weights the radius of the indenter is 75 mm and the shape is hemispherical at the end fig 10 shows the specimen stiffened plate and its dimensions the thickness of the stiffened plate is 6 mm and its length is 1060 mm 1060 mm three stiffeners are attached to the stiffened plate the length of each stiffener is 1000 mm and all of the stiffeners are 50 mm 6 mm flat bars the stiffened panel was welded around the inner edge of the supporter to ensure adequate rigidity constraints and reduce the complexity of boundary simulation during the finite element numerical simulation the supporter is rigid enough to prevent any movement and is shown in fig 11 table 2 presents the detailed collision parameters of this test fig 12 shows the impact force displacement relationship curve of the stiffened plate this curve can accurately reflect the dynamic response of the specimen during the impact process and the slope of the curve in the figure represents the ability of the stiffened plate to resist the impact load the damage deformation of the stiffened plate is shown in fig 13 it can be seen from the figure that the damage range of the stiffened plate is concentrated in the impact contact area the deformation mainly includes two parts the overall deformation and the local deformation among these parts the local deformation is consistent with the shape of the indenter and the impact kinetic energy causes the stiffened panel to tear due to its failure strain being exceeded in addition the stiffened structure has an in plane bending deformation and buckling failure near the contact area 5 numerical validations and discussion using the numerical implementation method of section 3 the johnson cook gtn model was implemented by a user defined material subroutine in the finite element software ls dyna to verify the correctness of the subroutine a series of numerical tests were performed the results obtained by numerical calculations using the johnson cook gtn constitutive model are compared with the test results 5 1 numerical simulation of the quasi static tensile test the finite element model of the quasi static tensile test specimen is shown in fig 14 the model is established by shell elements with a mesh size of 2 0 mm 2 0 mm along the gage length the standard dimensions of the specimen and basic mechanical properties of mild steel are shown in fig 2 and table 1 respectively one end of the specimen is rigidly fixed and the other end of the specimen is conducted at a loading rate of 1 mm min 1 until fracture occurs most of the parameters in the gtn model cannot be directly determined by experiments so these parameters are usually taken as adjustable parameters by adjusting these parameters the numerical simulation result of the tensile test is consistent with the experimental result which means that the values of the selected parameters can reflect the damage law of the material the parameters of the johnson cook model are selected according to reference lin et al 2014 the material parameters used are shown in table 3 and table 4 respectively fig 15 shows the comparison of the numerical simulation results and test results when the necking phenomenon occurs the damage and the maximum stress are mainly concentrated near the symmetry centre of the tensile specimen the fracture occurs when the volume fraction of the void reaches the fracture volume fraction f f the comparison of engineering stress strain curve from the numerical simulations and the tension test is illustrated in fig 16 which proves the rationality of the selected parameters 5 2 numerical simulation of falling weight impact test the strain rate is considered in the johnson cook gtn model so numerical simulations of the falling weight impact test can verify the accuracy of the johnson cook gtn model fig 17 shows the finite element model in ls dyna the stiffened plate is established by shell elements with a mesh size of 6 mm all the elements are four nodes belytschko tsay elements which have the advantages of numerical stability for large deformation problems and a fast calculation speed the material parameters used are listed in tables 3 and 4 of section 5 1 a comparison of the damage deformation between test and simulation are illustrated in fig 18 the simulation results show that the structural fracture size failure mode and overall damage distribution are in good agreement with the experimental results in addition it can also be clearly seen from the numerical simulation deformation figure that the fracture on the stiffened plate is concentrated in the position of the indenter while the rest area without direct contact with the indenter is the overall bending deformation the vertical force versus the displacement curves from the experimental and numerical simulations are illustrated in fig 19 in addition numerical simulations of the stiffened plate models with different mesh sizes were also conducted table 5 shows the peak values of the impact force 5 3 numerical simulation of asis model test the asis model test was performed in 1993 in japan to study the failure mechanism of a tanker s side structures the scale ratio of the model test is 1 2 and the ship side model in the test is a section of the vlcc side which includes a section of deck three spaces of transverse webs and the attached stiffeners as shown in fig 20 a the indenter model is 1 0 m long and 1 0 m high and the radius of the bottom cylinder is 0 5 m as shown in fig 20 b kuroiwa 1993 in the asis model test the impact position was selected in the plane of the deck plate between the two transverse webs as illustrated in fig 20 a the material of the ship side model is mild steel and the main parameters in the model test are listed in table 6 the asis model test consists of two parts a dynamic impact test and a quasi static test fig 21 shows the deformation of the ship side model after the quasi static test in the numerical simulation only the asis quasi static test was selected for the ship side finite element model the four node belytschko tsay element is selected hallquist 2006 as the calculation model is relatively simple an overall mesh size of 20 mm is used to obtain a satisfactory calculation accuracy the ship side finite element model is illustrated in fig 22 the gtn parameters are obtained from tvergaard and needleman 1988 the johnson cook parameters are obtained from schwer 2007 and the material parameters used are listed in table 7 and table 8 the side model is fixed at six degrees of freedom at both ends of the longitudinal direction the six degrees of freedom at the inner edge of the deck was similarly fixed it is assumed that the indenter is rigid and the impact velocity is set to 2 m s 1 which is selected considering the balance between the calculation accuracy and the calculation speed in fact the study by samuelides et al 2007 showed that the impact velocity has a certain influence on the deformation of the structure in the contact definition the contact between the indenter and the side structure uses the automatic surface to surface in the ls dyna and the deformation of the side structure is automatically a single surface the stringer deck in the asis test model is subjected to shear loading as shown in fig 20 so numerical simulation of the asis test can verify the accuracy of the johnson cook gtn model subjected to shear loading fig 23 shows the deformation of side structures and the comparison of numerical simulation results and the asis model test results is shown in fig 24 5 4 discussion strain rate sensitivity plays an important role in the calculation and analysis of structural impact problems in the numerical simulation of falling weight impact test the results of the johnson cook gtn model considering strain rate and the numerical simulation results of a combined material relationship curve obtained from a high speed tensile test as a simulation input are compared with the test results it can be observed from fig 19 that the three groups of curves are in good agreement all of the curves first increase and later decrease with only one peak of impact force the experimental curve fluctuates more than the numerical simulation curve due to the influence of the welding seam which is ignored in the numerical simulation the influence of different mesh sizes on the damage deformation of the stiffened plate and impact force is uncertain therefore only the peak values of the impact force at different mesh sizes of the stiffened plate models are listed in table 5 it can be determined from the data in the table that with an increase in the mesh size the peak values of the impact force calculated by numerical simulations are still relatively close to the test result to a certain extent in the numerical simulation of the asis model test it can be seen from fig 24 that the two groups of curves agree well when the indenter is in contact with the side model the collision force appears at a peak value before slightly decreasing afterwards with an increase in impact depth the impact force gradually increases in general the impact behaviour can be well reflected by numerical simulation which validates the correctness of the johnson cook gtn model for the johnson cook gtn model the flow yield stress expression of the johnson cook model and the gtn yield function are adopted as collision problems involve high strain rates the johnson cook model takes the strain and strain rate of the material into account assuming that the isotropic strain and strain rate of the material are decoupled and the equivalent stress of high strain rate material model can be expressed as 31 σ e q f ε p ε t f 1 ε p f 2 ε f 3 t the strain hardening of the model is in the form of a power function while the strain rate hardening factor is in logarithmic form as shown in equation 32 therefore the dynamic mechanical behaviour of the material under impact can be well characterized 32 σ e q a b ε p n strain effect 1 c ln ε ε r strain rate effect 1 t m by comparing the numerical simulation results with those of the experiment results it is determined that the proposed johnson cook gtn constitutive model can describe the structural damage extremely well which demonstrates that the proposed model s applicability for structural failure response prediction 6 conclusions to better describe the ductile fracture process of steel and predict the structural deformation damage during ship collisions and grounding accidents a material model based on the johnson cook model considering the strain rate combined with void nucleation and coalescence in the gtn model is proposed next the material model is implemented by a user defined material subroutine in the finite element software ls dyna in previous studies the gtn model assumed that the fracture of materials was caused by void growth and coalescence but it was only applicable to relatively high values of stress loading conditions for shear loading the gtn model will significantly overestimate the carrying capacity of materials moreover the gtn model is suitable for the relatively low strain rates while at higher strain rates such as structural impact problems the numerical simulation results are not accurate so the material model proposed in this paper solves this problem to a satisfying extent therefore this work will be helpful for researching ship collision and grounding simulations in the future the material properties were obtained by a quasi static tensile test and the stress strain relationship curves at different strain rates were obtained by high speed tensile tests next the stress strain relationship curves at different strain rates were converted to combined material relationship curves the numerical simulation result of the quasi static tensile test proves the rationality of the selected parameters and the accuracy of the johnson cook gtn model the influence of the strain rate needs to be considered in the impact problem and the falling weight impact test numerical simulation results of the johnson cook gtn model are also compared with the numerical simulation results of the combined material relationship curve as the simulation input and test results their comparison results demonstrate the accuracy and applicability of the proposed method in this paper the asis test numerical simulation results of the johnson cook gtn model are also compared with the test results and the accuracy of the johnson cook gtn model subjected to shear loading is validated therefore the johnson cook gtn model can better predict structural deformation damage in ship collision and grounding simulations declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements we gratefully acknowledge the financial support of the national natural science foundation of china grant no 51779110 appendix the main workflow of fig 1 is divided into three steps 1 the johnson cook gtn model is written into a umat file in the fortran language and a new executable file ls dyna exe is compiled in the fortran compiler with the ls dyna lib database 2 the keyword mat user defined material models is used to define the user material parameters and generate a k file 3 before solving select the generated ls dyna exe in the ls dyna manager to solve and achieve the use of the umat file 
21893,to investigate the directivity of propeller shaft hull coupled acoustic radiation a propeller shaft hull model under unit longitudinal excitation is analyzed using the three dimensional sono elasticity method by comparing the different behaviors of coupled acoustic radiation induced by different modes the sound pressure distribution along a straight line parallel to the ship s axis with 30 m distance and a circle with a radius of 30 m from the central of the ship the bright area of the acoustic radiation contour and the influence of directivity on the measurement of the coupled acoustic radiation are revealed through a discussion based on numerical results it is indicated that the stern direction is always and the fore direction is sometimes the bright area of the propeller shaft hull coupled acoustic radiation induced by the longitudinal excitation when measuring the propeller shaft hull coupled acoustic radiation of a ship in the port or starboard side the measured results would be relatively small the conclusion of this paper can be used as a reference for the measurement of the coupled acoustic radiation and the concealed navigation of ships keywords directivity coupled acoustic radiation propeller shaft measurement sono elasticity 1 introduction as the propeller shaft hull coupled vibration and acoustic radiation of a ship becomes more and more prominent there are more and more investigations on its mechanism calculation characteristic and control peters et al 2015 qi et al 2019a b the three dimensional sono elasticity method wu et al 2016 zou et al 2018 used in this paper is based on the three dimensional hydro elasticity method wu 1984 the green function for the ideal compressible fluid is applied to solve the acoustic field the generalized vibration equation includes the added mass damping and restoring coefficients research on the directivity of propeller shaft hull coupled acoustic radiation is rarely seen in published literatures so some studies about the directivity of acoustic radiation from propellers stiffened cylinders thick disks and railway wheels are introduced xie and zhou 2010 investigated the directivity prediction on the noise of propellers operating in non uniform flows it is indicated that the characteristic coupling factor between inflow harmonic and the rotating blades has significant influence on the directivity feature shi et al 2006 analyzed the vibration and acoustic radiation from an axially stiffened cylindrical shell with two end plates by using fem bem finite element method boundary element method and found that the number of longitudinal stiffeners could change the directivity of sound field zhang 2019 studied the directivity of acoustic radiation induced by different modes of a thick disk under different boundary conditions and found that the directivity of acoustic radiation is the sharpest under fixed boundary conditions and the least under free boundary conditions the directivity of acoustic radiation induced by the bending vibration of a disk is widely used in ultrasonic detecting han 2012 presented a study about the effect of key parameters on the acoustic radiation of railway wheels fig 1 a fe be finite element boundary element model of a wheel with straight web was developed to calculate the natural frequencies and directivities the results of which were compared with results from laboratory tests obrist 2009 investigated the acoustic emission from wave packets to the far field a theory for different dimensional source fields in the shape of wave packets is put forward with gaussian envelopes the method is based on an approximation to lighthill s acoustic analogy for far observers the measurement of acoustic radiation is closely related to its directivity at present the main method is to use hydrophones to measure the underwater acoustic radiation of ships fig 2 with the development of hydrophone technology the measurement methods of underwater acoustic radiation are as follows 1 single hydrophone arveson and vendittis 2000 2 horizontal array luo and zhang 2009 3 vertical linear array brooker and humphrey 2016 4 hydrophone cluster fillinger et al 2011 5 vector hydrophone han 2009 the sound field energy distribution will be uneven due to the near field measurement in shallow sea the complexity of sound source structure the directivity of acoustic radiation the sea surface and bottom boundary conditions the change of sound field velocity gradient and the inhomogeneous medium in the sound field haimov et al 2016 presented a study on the implementation of experimental procedure for measuring the hydrodynamic noise induced by model scale propellers an appropriate method of the recorded time series characterized the background influences which can obtain net results with sufficient signal to noise ratio there is a channel phenomenon for the sound line propagation in the ocean ewing and worzel 1948 in the channel caustics and converging areas with higher sound intensity can be observed urick 1983 found that the basic condition for the formation of the convergence in the ocean is that the sound source must be located in the deep sea channel and the depth of sea water is larger than the critical depth the special environment of ship acoustic radiation measurement in china is shallow water and the energy distribution of sound field is not uniform according to the sea trial data the deviation of the ship s acoustic radiation is up to 8 db gao 2006 hu 2010 investigated the measurement of radiated noise from submarine due to inhomogeneous distribution of acoustic energy in shallow sea by systematical experiments on acoustic propagation measurement in short range the sensitivity calibration of vector hydrophone out field testing system design and validated the characteristics of acoustic energy inhomogeneous distribution within underwater target radiated noise measurement distance are analyzed from the above literature review we found that most studies focused on the directivity of acoustic radiation of propellers stiffened cylinders or other structures and the influence of the environment on the measurement results the directivity of the acoustic radiation of a propeller shaft hull coupled system has not been studied the influence of the directivity of the acoustic radiation on the measurement has not been investigated either in this paper the directivity of propeller shaft hull coupled acoustic radiation is investigated by analyzing the coupled acoustic radiation of a propeller shaft hull model under the unit longitudinal excitation on propeller using the three dimensional sono elasticity method the bright area of the acoustic radiation and the impact of directivity on the measurement of the coupled acoustic radiation are revealed by comparing the different coupled acoustic radiation induced by different modes the changes of the sound pressure along a straight line parallel to the ship s axis with 30 m distance and a circle with a radius of 30 m from the central of the ship through a discussion based on numerical results it is indicated that the stern direction is always and the fore direction is sometimes the bright area when measuring the propeller shaft hull coupled acoustic radiation of a ship in the port or starboard side the measured results would be relatively small 2 model development in order to obtain the directivity of the propeller shaft hull coupled acoustic radiation a numerical model including propeller shaft and hull structures is designated the geometry for the calculation model is shown in fig 3 the details about how to build the model and the parameters are in the reference qi et al 2019a b here is a brief introduction the total length of the model is 35 m the radii of the pressure hull and light hull are 2 5 m and 3 m while the thicknesses of the pressure hull and light hull are 12 mm and 5 mm meshes of the outer wetted surface mesh size 0 3 m 0 3 m and the inner wetted surface mesh size 0 2 m 0 2 m for the three dimensional sono elasticity method are shown in fig 4 the wetted surface of the propeller mesh size 0 08 m 0 08 m is shown in fig 4 both the longitudinal and transverse excitation should be considered in our research this paper focus on the longitudinal excitation generally the longitudinal excitation of propeller is larger than the transverse excitation the acoustic radiation induced by the longitudinal excitation is the main component these peaks of the acoustic radiation are all corresponding to these longitudinal modes which are discussed in this paper in the future we will also investigate the transverse excitation of propeller the longitudinal exciting force on a blade is simplified as three forces in three points which are located in the end 0 7r radius of the propeller and root of the blade the magnitudes of the three forces located in the end 0 7r and root of blade are 1 2 1 the magnitude of the resultant force for all the exciting forces is 1 n the location of the excitation is shown in fig 5 the longitudinal stiffness of the thrust bearing is 2 107n m the transverse stiffness of the tail middle and thrust bearing is 1 107n m 3 coupled acoustic radiation the propeller shaft hull coupled acoustic radiation induced by the unit longitudinal excitation on the propeller is shown in fig 6 it is clearly shown that there are peaks at 13 0 hz 26 6 hz 40 6 hz which are corresponding to the wet frequencies for the 1st longitudinal mode of shaft system the 1st longitudinal mode of hull and the umbrella mode of propeller qi et al 2019a b the mode shapes and corresponding natural frequencies for the coupled model are shown in figs 7 9 and 11 the 1st longitudinal mode of shaft system is relevant to the mass of the propeller shaft system and the longitudinal stiffness of the thrust bearing the 1st longitudinal mode of hull is relevant to the total mass of the ship and the longitudinal stiffness of the hull the umbrella mode of propeller is relevant to the mass and stiffness of the blade 3 1 contour plot of the coupled acoustic radiation in horizontal plane using the three dimensional sono elasticity method the contour plots of the acoustic radiation induced by different modes are shown in figs 8 10 and 12 the contour plot with a circle of 100 m radius shows the distribution of sound source level in horizontal plane the right handed coordinate system is used the positive direction of x axis is the bow direction the positive direction of y axis is the port direction fig 8 shows that the bow and stern directions of the acoustic radiation induced by the 1st longitudinal mode of shaft system are the bright area which are larger than the port and starboard direction fig 10 shows that the bow and stern directions of the acoustic radiation induced by the 1st longitudinal mode of hull are larger than the port and starboard directions in the near field while the stern direction is equivalent to the port and starboard directions and the bow direction is slightly smaller in the far field fig 12 shows that the stern direction of the acoustic radiation induced by the umbrella mode of propeller is the bright area which is larger than the other directions the bright areas of the acoustic radiation induced by different modes are different the coupled acoustic radiation has significant directivity 3 2 sound pressure of coupled acoustic radiation in horizontal plane with further detailed analysis of the field point sound pressure the sound pressure levels in different directions corresponding to the characteristic modes are listed in table 1 it is found that when the distance from the center is 30 m 50 m and 100 m the sound pressure for the 1st longitudinal mode of shaft system in the bow and stern directions are about 12 db higher than that in the port and starboard directions the sound pressure for the 1st longitudinal mode of hull in the stern port and starboard directions are about 6 db higher than that in bow direction the sound pressure for the umbrella mode of propeller in the stern direction is about 10 db higher than that in the bow direction and about 6 db higher than that in the port and starboard directions the results show that the bright areas of the acoustic radiation induced by the 1st longitudinal mode of shaft system the 1st longitudinal mode of hull and the umbrella mode of propeller are the bow and stern directions the stern port and starboard directions and the stern direction 3 3 contour plot of the coupled acoustic radiation in cylindrical surface the contour plots for the sound pressure induced by the 1st longitudinal mode of shaft system the 1st longitudinal mode of hull and the umbrella mode of propeller in cylindrical surfaces are shown in figs 13 15 the center of the cylindrical surface is at the center of the ship the radius is 30 m and the length is 60 m it can be seen from the figures that the sound pressure is almost the same in the circumferential direction on the cylindrical surface and there is an obvious difference in the axial direction there are bright areas in the axial direction the distribution characteristics of bright areas are consistent with the previous analysis results 3 4 measurement characteristic analysis in the acoustic radiation measurement of a ship the ship always moves in a straight line a fixed hydrophone is arranged at a certain distance away from the ship to measure the acoustic radiation of the ship from far to near and then to far field finally some of the measurement data are selected for the result analysis as shown in fig 16 in order to find the variation of acoustic radiation with the movement of the ship the change of sound pressure on the line of 200 m length and 30 m distance to the ship is analyzed the changes of sound pressure induced by different modes are shown in fig 17 it can be seen that the sound pressure on the line ab for different modes changes significantly which shows that the measured sound pressure at different points has different results in addition the position of the minimum value of sound pressure varies for different modes which shows that the distribution characteristics of sound radiation for different modes are different the distribution characteristics of acoustic radiation induced by different modes on a circle with a radius of 30 m are shown in figs 18 20 as can be seen from the figures the circumferential distribution of acoustic radiation for different modes has significant directivity further analysis of the characteristics of directivity shows that the bow and stern directions of the acoustic radiation induced by the 1st longitudinal mode of shaft system are larger than the port and starboard direction the stern direction of the acoustic radiation induced by the 1st longitudinal mode of hull is equivalent to the port and starboard directions and the bow direction is slightly smaller the stern direction of the acoustic radiation induced by the umbrella mode of propeller is larger than the other directions it is consistent with the previous analysis conclusion while the characteristics are more obvious for far field acoustic radiation 4 conclusions the directivity of the coupled acoustic radiation of a propeller shaft hull model under unit longitudinal excitation on propeller is investigated by using the three dimensional sono elasticity method the bow and stern directions of the acoustic radiation induced by the 1st longitudinal mode of shaft system are the bright area the bow and stern directions of the acoustic radiation induced by the 1st longitudinal mode of hull are larger than the port and starboard directions in the near field while the stern direction is equivalent to the port and starboard directions and the bow direction is slightly smaller in the far field the stern direction of the acoustic radiation induced by the umbrella mode of propeller is the bright area the coupled acoustic radiation have significant directivity the directivity which reflects the non uniform distribution of the propeller shaft hull coupled acoustic radiation in the axial and circumferential directions directly affects the measurement of a ship s acoustic radiation in the acoustic radiation measurement of a ship these hydrophones could be arranged at port starboard and bow directions the ship still moves in a straight line towards the hydrophone arranged in the bow direction from far field to near field and then to far field so that the acoustic radiation at the bow and stern directions could be obtained the measured data of the acoustic radiation should be effectively selected and analyzed according to the simulation results considering the acoustic radiation from all the directions the measurement results could be more objective credit authorship contribution statement libo qi conceptualization data curation formal analysis funding acquisition writing original draft writing review editing mingsong zou investigation methodology resources supervision project administration changgang lin software validation yue yu visualization shuxiao liu visualization declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgment this work was financially supported by the national natural science foundation of china grant no 51909246 and the natural science foundation of jiangsu province of china grant no bk20170217 
21893,to investigate the directivity of propeller shaft hull coupled acoustic radiation a propeller shaft hull model under unit longitudinal excitation is analyzed using the three dimensional sono elasticity method by comparing the different behaviors of coupled acoustic radiation induced by different modes the sound pressure distribution along a straight line parallel to the ship s axis with 30 m distance and a circle with a radius of 30 m from the central of the ship the bright area of the acoustic radiation contour and the influence of directivity on the measurement of the coupled acoustic radiation are revealed through a discussion based on numerical results it is indicated that the stern direction is always and the fore direction is sometimes the bright area of the propeller shaft hull coupled acoustic radiation induced by the longitudinal excitation when measuring the propeller shaft hull coupled acoustic radiation of a ship in the port or starboard side the measured results would be relatively small the conclusion of this paper can be used as a reference for the measurement of the coupled acoustic radiation and the concealed navigation of ships keywords directivity coupled acoustic radiation propeller shaft measurement sono elasticity 1 introduction as the propeller shaft hull coupled vibration and acoustic radiation of a ship becomes more and more prominent there are more and more investigations on its mechanism calculation characteristic and control peters et al 2015 qi et al 2019a b the three dimensional sono elasticity method wu et al 2016 zou et al 2018 used in this paper is based on the three dimensional hydro elasticity method wu 1984 the green function for the ideal compressible fluid is applied to solve the acoustic field the generalized vibration equation includes the added mass damping and restoring coefficients research on the directivity of propeller shaft hull coupled acoustic radiation is rarely seen in published literatures so some studies about the directivity of acoustic radiation from propellers stiffened cylinders thick disks and railway wheels are introduced xie and zhou 2010 investigated the directivity prediction on the noise of propellers operating in non uniform flows it is indicated that the characteristic coupling factor between inflow harmonic and the rotating blades has significant influence on the directivity feature shi et al 2006 analyzed the vibration and acoustic radiation from an axially stiffened cylindrical shell with two end plates by using fem bem finite element method boundary element method and found that the number of longitudinal stiffeners could change the directivity of sound field zhang 2019 studied the directivity of acoustic radiation induced by different modes of a thick disk under different boundary conditions and found that the directivity of acoustic radiation is the sharpest under fixed boundary conditions and the least under free boundary conditions the directivity of acoustic radiation induced by the bending vibration of a disk is widely used in ultrasonic detecting han 2012 presented a study about the effect of key parameters on the acoustic radiation of railway wheels fig 1 a fe be finite element boundary element model of a wheel with straight web was developed to calculate the natural frequencies and directivities the results of which were compared with results from laboratory tests obrist 2009 investigated the acoustic emission from wave packets to the far field a theory for different dimensional source fields in the shape of wave packets is put forward with gaussian envelopes the method is based on an approximation to lighthill s acoustic analogy for far observers the measurement of acoustic radiation is closely related to its directivity at present the main method is to use hydrophones to measure the underwater acoustic radiation of ships fig 2 with the development of hydrophone technology the measurement methods of underwater acoustic radiation are as follows 1 single hydrophone arveson and vendittis 2000 2 horizontal array luo and zhang 2009 3 vertical linear array brooker and humphrey 2016 4 hydrophone cluster fillinger et al 2011 5 vector hydrophone han 2009 the sound field energy distribution will be uneven due to the near field measurement in shallow sea the complexity of sound source structure the directivity of acoustic radiation the sea surface and bottom boundary conditions the change of sound field velocity gradient and the inhomogeneous medium in the sound field haimov et al 2016 presented a study on the implementation of experimental procedure for measuring the hydrodynamic noise induced by model scale propellers an appropriate method of the recorded time series characterized the background influences which can obtain net results with sufficient signal to noise ratio there is a channel phenomenon for the sound line propagation in the ocean ewing and worzel 1948 in the channel caustics and converging areas with higher sound intensity can be observed urick 1983 found that the basic condition for the formation of the convergence in the ocean is that the sound source must be located in the deep sea channel and the depth of sea water is larger than the critical depth the special environment of ship acoustic radiation measurement in china is shallow water and the energy distribution of sound field is not uniform according to the sea trial data the deviation of the ship s acoustic radiation is up to 8 db gao 2006 hu 2010 investigated the measurement of radiated noise from submarine due to inhomogeneous distribution of acoustic energy in shallow sea by systematical experiments on acoustic propagation measurement in short range the sensitivity calibration of vector hydrophone out field testing system design and validated the characteristics of acoustic energy inhomogeneous distribution within underwater target radiated noise measurement distance are analyzed from the above literature review we found that most studies focused on the directivity of acoustic radiation of propellers stiffened cylinders or other structures and the influence of the environment on the measurement results the directivity of the acoustic radiation of a propeller shaft hull coupled system has not been studied the influence of the directivity of the acoustic radiation on the measurement has not been investigated either in this paper the directivity of propeller shaft hull coupled acoustic radiation is investigated by analyzing the coupled acoustic radiation of a propeller shaft hull model under the unit longitudinal excitation on propeller using the three dimensional sono elasticity method the bright area of the acoustic radiation and the impact of directivity on the measurement of the coupled acoustic radiation are revealed by comparing the different coupled acoustic radiation induced by different modes the changes of the sound pressure along a straight line parallel to the ship s axis with 30 m distance and a circle with a radius of 30 m from the central of the ship through a discussion based on numerical results it is indicated that the stern direction is always and the fore direction is sometimes the bright area when measuring the propeller shaft hull coupled acoustic radiation of a ship in the port or starboard side the measured results would be relatively small 2 model development in order to obtain the directivity of the propeller shaft hull coupled acoustic radiation a numerical model including propeller shaft and hull structures is designated the geometry for the calculation model is shown in fig 3 the details about how to build the model and the parameters are in the reference qi et al 2019a b here is a brief introduction the total length of the model is 35 m the radii of the pressure hull and light hull are 2 5 m and 3 m while the thicknesses of the pressure hull and light hull are 12 mm and 5 mm meshes of the outer wetted surface mesh size 0 3 m 0 3 m and the inner wetted surface mesh size 0 2 m 0 2 m for the three dimensional sono elasticity method are shown in fig 4 the wetted surface of the propeller mesh size 0 08 m 0 08 m is shown in fig 4 both the longitudinal and transverse excitation should be considered in our research this paper focus on the longitudinal excitation generally the longitudinal excitation of propeller is larger than the transverse excitation the acoustic radiation induced by the longitudinal excitation is the main component these peaks of the acoustic radiation are all corresponding to these longitudinal modes which are discussed in this paper in the future we will also investigate the transverse excitation of propeller the longitudinal exciting force on a blade is simplified as three forces in three points which are located in the end 0 7r radius of the propeller and root of the blade the magnitudes of the three forces located in the end 0 7r and root of blade are 1 2 1 the magnitude of the resultant force for all the exciting forces is 1 n the location of the excitation is shown in fig 5 the longitudinal stiffness of the thrust bearing is 2 107n m the transverse stiffness of the tail middle and thrust bearing is 1 107n m 3 coupled acoustic radiation the propeller shaft hull coupled acoustic radiation induced by the unit longitudinal excitation on the propeller is shown in fig 6 it is clearly shown that there are peaks at 13 0 hz 26 6 hz 40 6 hz which are corresponding to the wet frequencies for the 1st longitudinal mode of shaft system the 1st longitudinal mode of hull and the umbrella mode of propeller qi et al 2019a b the mode shapes and corresponding natural frequencies for the coupled model are shown in figs 7 9 and 11 the 1st longitudinal mode of shaft system is relevant to the mass of the propeller shaft system and the longitudinal stiffness of the thrust bearing the 1st longitudinal mode of hull is relevant to the total mass of the ship and the longitudinal stiffness of the hull the umbrella mode of propeller is relevant to the mass and stiffness of the blade 3 1 contour plot of the coupled acoustic radiation in horizontal plane using the three dimensional sono elasticity method the contour plots of the acoustic radiation induced by different modes are shown in figs 8 10 and 12 the contour plot with a circle of 100 m radius shows the distribution of sound source level in horizontal plane the right handed coordinate system is used the positive direction of x axis is the bow direction the positive direction of y axis is the port direction fig 8 shows that the bow and stern directions of the acoustic radiation induced by the 1st longitudinal mode of shaft system are the bright area which are larger than the port and starboard direction fig 10 shows that the bow and stern directions of the acoustic radiation induced by the 1st longitudinal mode of hull are larger than the port and starboard directions in the near field while the stern direction is equivalent to the port and starboard directions and the bow direction is slightly smaller in the far field fig 12 shows that the stern direction of the acoustic radiation induced by the umbrella mode of propeller is the bright area which is larger than the other directions the bright areas of the acoustic radiation induced by different modes are different the coupled acoustic radiation has significant directivity 3 2 sound pressure of coupled acoustic radiation in horizontal plane with further detailed analysis of the field point sound pressure the sound pressure levels in different directions corresponding to the characteristic modes are listed in table 1 it is found that when the distance from the center is 30 m 50 m and 100 m the sound pressure for the 1st longitudinal mode of shaft system in the bow and stern directions are about 12 db higher than that in the port and starboard directions the sound pressure for the 1st longitudinal mode of hull in the stern port and starboard directions are about 6 db higher than that in bow direction the sound pressure for the umbrella mode of propeller in the stern direction is about 10 db higher than that in the bow direction and about 6 db higher than that in the port and starboard directions the results show that the bright areas of the acoustic radiation induced by the 1st longitudinal mode of shaft system the 1st longitudinal mode of hull and the umbrella mode of propeller are the bow and stern directions the stern port and starboard directions and the stern direction 3 3 contour plot of the coupled acoustic radiation in cylindrical surface the contour plots for the sound pressure induced by the 1st longitudinal mode of shaft system the 1st longitudinal mode of hull and the umbrella mode of propeller in cylindrical surfaces are shown in figs 13 15 the center of the cylindrical surface is at the center of the ship the radius is 30 m and the length is 60 m it can be seen from the figures that the sound pressure is almost the same in the circumferential direction on the cylindrical surface and there is an obvious difference in the axial direction there are bright areas in the axial direction the distribution characteristics of bright areas are consistent with the previous analysis results 3 4 measurement characteristic analysis in the acoustic radiation measurement of a ship the ship always moves in a straight line a fixed hydrophone is arranged at a certain distance away from the ship to measure the acoustic radiation of the ship from far to near and then to far field finally some of the measurement data are selected for the result analysis as shown in fig 16 in order to find the variation of acoustic radiation with the movement of the ship the change of sound pressure on the line of 200 m length and 30 m distance to the ship is analyzed the changes of sound pressure induced by different modes are shown in fig 17 it can be seen that the sound pressure on the line ab for different modes changes significantly which shows that the measured sound pressure at different points has different results in addition the position of the minimum value of sound pressure varies for different modes which shows that the distribution characteristics of sound radiation for different modes are different the distribution characteristics of acoustic radiation induced by different modes on a circle with a radius of 30 m are shown in figs 18 20 as can be seen from the figures the circumferential distribution of acoustic radiation for different modes has significant directivity further analysis of the characteristics of directivity shows that the bow and stern directions of the acoustic radiation induced by the 1st longitudinal mode of shaft system are larger than the port and starboard direction the stern direction of the acoustic radiation induced by the 1st longitudinal mode of hull is equivalent to the port and starboard directions and the bow direction is slightly smaller the stern direction of the acoustic radiation induced by the umbrella mode of propeller is larger than the other directions it is consistent with the previous analysis conclusion while the characteristics are more obvious for far field acoustic radiation 4 conclusions the directivity of the coupled acoustic radiation of a propeller shaft hull model under unit longitudinal excitation on propeller is investigated by using the three dimensional sono elasticity method the bow and stern directions of the acoustic radiation induced by the 1st longitudinal mode of shaft system are the bright area the bow and stern directions of the acoustic radiation induced by the 1st longitudinal mode of hull are larger than the port and starboard directions in the near field while the stern direction is equivalent to the port and starboard directions and the bow direction is slightly smaller in the far field the stern direction of the acoustic radiation induced by the umbrella mode of propeller is the bright area the coupled acoustic radiation have significant directivity the directivity which reflects the non uniform distribution of the propeller shaft hull coupled acoustic radiation in the axial and circumferential directions directly affects the measurement of a ship s acoustic radiation in the acoustic radiation measurement of a ship these hydrophones could be arranged at port starboard and bow directions the ship still moves in a straight line towards the hydrophone arranged in the bow direction from far field to near field and then to far field so that the acoustic radiation at the bow and stern directions could be obtained the measured data of the acoustic radiation should be effectively selected and analyzed according to the simulation results considering the acoustic radiation from all the directions the measurement results could be more objective credit authorship contribution statement libo qi conceptualization data curation formal analysis funding acquisition writing original draft writing review editing mingsong zou investigation methodology resources supervision project administration changgang lin software validation yue yu visualization shuxiao liu visualization declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgment this work was financially supported by the national natural science foundation of china grant no 51909246 and the natural science foundation of jiangsu province of china grant no bk20170217 
21894,slug flow is characterized by the variations of internal flow parameters with time and position this study aims to investigate the slug flow effect sfe on the cross flow vortex induced vibration viv of a flexible riser a steady slug flow model is adopted using several assumptions and empirical correlations a distribution of van der pol oscillators is employed to create the viv effect a novel approach has been proposed to capture the intermittent feature which is validated by comparisons with experiments the sfe is explored by comparisons of the dynamic behaviors of a flexible riser subject to two uniform currents assuming the pipe is filled with still liquid transporting a single phase liquid flow and a two phase slug flow it has demonstrated that the sfe is much more profound than the single phase internal flow effect a flexible riser conveying a slug flow can exhibit quite distinguished dynamics owing to the intermittent feature apart from triggering new modes the combination of slug flow frequency and viv frequency can generate an amplitude modulation phenomenon of excited modes most distinctively beating behaviours which corresponds to the resonant synchronization have been captured this study can contribute to fatigue analysis of a flexible riser conveying a two phase slug flow keywords slug flow effect intermittent feature viv amplitude modulation beating behaviour nomenclature l the length of the horizontal riser m p the mass of the riser structure per unit length e the elastic modulus of the riser e i the bending stiffness of the riser d i the internal diameter of the riser d e the external diameter of the riser o 1 the inlet of the pipe o 2 the outlet of the pipe ρ l the density of the inner liquid ρ g the density of the inner gas ν l the kinematic viscosity of the inner liquid ν g the kinematic viscosity of the inner gas v s l the superficial velocity of the inner liquid v s g the superficial velocity of the inner gas v t the translational velocity of the slug flow v i the time and space varying velocity of the internal flow ρ i the time and space varying density of the internal flow per unit length m i the time and space varying mass of the internal fluid ρ e the density of seawater m e the mass of the external fluid per unit length u e the velocity of incoming uniform current t 0 the external imposed tension x y z the euler coordinate s the lagrangian coordinate along the pipe axis m s the mass of the riser system per unit length f the hydrodynamic force m a the added mass c a the added mass coefficient f d the drag force c d the drag force coefficient f l the lift force c l the lift force coefficient c l 0 the lift force coefficient for a stationary riser q the reduced vortex variable a w the scaling parameter ε z the wake coefficient s t the strouhal number ω s the angular vortex shedding frequency l u the length of a slug unit l s the length of the liquid slug l f the length of the film zone h f the space varying liquid film height c the mixture velocity factor v s the mixture velocity v d the propagation velocity of a large bubble in stagnant liquid g the gravity acceleration f s the slug frequency t s the slug period v l the liquid velocity in the liquid slug region v b the velocity of the dispersed bubbles in the liquid slug region r s the liquid hold up in the liquid slug region α s the void fraction in the liquid slug region b the distribution parameter v 0 the bubble drift velocity of stagnant liquid v l the relative velocity between the slug unit and the inner liquid in the liquid slug region v b the relative velocity between the slug unit and the dispersed bubbles in the liquid slug region v f the velocity of the liquid film in the film zone v f the relative velocity between the slug unit and the liquid film in the film zone v g the velocity of the gas in the film zone v g the relative velocity between the slug unit and the gas in the film zone r f the liquid hold up in the film zone α f the void fraction in the film zone β the inclination angle of the riser a f the cross sectional area of the film liquid a g the cross sectional area of the gas s f the liquid wetted perimeters in the film zone s g the gas wetted perimeters in the film zone s i the interfacial width in the film zone θ the interfacial radian in the film zone τ f the friction force between the liquid and the wall in the film zone τ g the friction force between the gas and the wall in the film zone τ i the friction force between the liquid and the gas on the interface in the film zone f f the friction force coefficient between the liquid and the wall in the film zone f g the friction force coefficient between the gas and the wall in the film zone f i the interfacial gas liquid factor in the film zone re f the reynolds number of the liquid phase re g the reynolds number of the gas phase n m the number of eigenfunctions φ i s the adopted eigenfunctions i 1 n m e i q i the generalized coordinates in galerkin method i 1 n m n r the nodes of riser δ s the length of the riser segments n s the segment number in the liquid slug region s 0 the distance between the entry and the front of the first complete slug unit h f e the height of the film at the interface of the liquid slug and the film zone r f e the liquid hold up of the film at the interface of the liquid slug and the film zone v f e the fluid velocity of the film at the interface of the liquid slug and the film zone v g e the gas velocity of the film at the interface of the liquid slug and the film zone n c the number of complete slug units in the pipe r the liquid hold up along the pipe h the liquid height along the pipe 1 introduction marine risers inevitably experience vortex induced vibration viv which is one of the major concerns for structural integrity viv has attracted great attentions in the past decades and comprehensive reviews of viv study have been made williamson and govardhan 2004 sarpkaya 2004 wu et al 2012 hong and shah 2018 as ocean recourse exploration expands into ultra deep waters marine risers become much longer and slenderer the long flexible marine risers start exhibiting new dynamic features for example the viv response of the employed long flexible cylinder in the second gulf stream experiment was dominated by travelling waves sheshadri 2009 vandiver et al 2009 continuous efforts are devoted to reducing the uncertainties and figuring out the influential factors which have been ignored in previous studies gao et al 2019 for example one should not expect perfect synchronization because of the continuous interaction between the body and the fluctuations of added mass separation line amplitude correlation length and the phase angle sarpkaya 2004 viv of long flexible marine risers is characterized by the complicated response where a number of distinct frequency components can be simultaneously active which can be categorized as fundamental and higher harmonics although the higher order strain contributions are too small to reach the dominant mode strain level it has demonstrated that higher harmonics can have a tremendous impact on the fatigue life of the riser system zheng et al 2014 wu et al 2019 thorsen et al 2019 it is stated that with the increased aspect ratio and flexibility of marine risers internal flow effect ife on riser dynamics becomes significant atadan et al 1997 chatjigeorgiou 2010 wang and duan 2015 xu et al 2018 meng et al 2017b have found that for a flexible riser undergoing viv an single phase internal flow can trigger new natural modes and switch the role of the most predominant one when the internal flow velocity is sufficiently high this study focuses on the two phase slug flow effect sfe on the cross flow cf viv of a flexible riser subjected to a uniform current it is a direct extension of the former study in meng et al 2017b ife on the dynamics of flexible marine risers has been extensively studied under various external flow excitations such as the top end excitation from floating structures meng et al 2018 viv imposed by an incoming current guo and lou 2008 keber and wiercigroch 2008 meng and chen 2012 dai et al 2013 meng et al 2017a b wang et al 2018 liu et al 2019 the combined viv and top end excitations he et al 2017 however in the aforementioned studies internal flow is typically considered as a single phase steady flow in which the flow velocity profile is constant throughout the pipe it is known that the internal fluid inside a marine riser is a mixture of oil gas and water moreover there is a tendency that long pipelines are employed to transport natural resources without a previous separation process to avoid the use of platforms boris et al 2014 therefore multi phase ife of flexible marine risers has drawn particular attentions in recent years miranda and paik 2019 reported that compared to the single phase ife a two phase internal flow model could lead to significant variations as regards the dynamics of marine pipelines one representative type of two phase flow is slug flow in which the slugs are formed continuously as the inner liquid is transported through the riser gundersen et al 2012 states that there is an approximately 50 reduction in fatigue life of flexible risers when it suffers the combined irregular wave and slug flow excitations sfe on the dynamics of flexible risers has been witnessed in numerical simulations and scaled experiments park et al 2019 zhu et al 2018 vasquez and avila 2019 chatjigeorgiou 2017 has concluded that the sfe is very important on the dynamics of a catenary risers subject to top harmonic excitation in contrast to the marginal effect of other internal flow models such as the plug flow model a two phase slug flow is characterized by a sequence of liquid slugs and gas bubbles the slug flow patterns can generate rapid changes of the fluid mass and velocity distribution along the pipe this intermittent feature inevitably affects the natural frequencies and the viv responses of flexible risers this study is thus motivated to examine the sfe of a flexible marine riser undergoing viv researchers have devoted efforts to the sfe on vivs of flexible marine risers xie et al 2019 modelled the internal multi phase mixture as a monophasic flow they states that the fluctuation of internal fluid density can affect the vibration response of the riser suffering viv blanco and casanova 2010 assumed the internal slug flow as moving masses and the sfe was taken into account by computing instantaneous internal fluid mass they have demonstrated that the predicted fatigue life may be significantly modified when considering the conjunction of sfe and viv boris et al 2014 analyzed two extreme cases i e small size and large size slugs to examine the integration of between slug flow and viv of a flexible submarine pipeline however in these studies only the instantaneous time varying fluid mass is accounted for while the internal flow velocity effects are ignored it is worth noting that the velocity fluctuation of internal flow can significantly influence the viv responses of flexible pipes dai et al 2014 knudsen et al 2016 conducted a numerical analysis of combined viv and slug flow where the slug flow is modelled with constant internal velocity pressure and uniform slug lengths sfe was accounted for by introducing a time varying mass term and a centrifugal force without considering the coriolis force they reported that the slug velocity and slug length had an obvious influence on the response pattern amplitude and frequency safrendyo and srinil 2018 investigated the slug flow induced oscillation in subsea catenary riser experiencing viv for the sake of simplicity the slug flow was modelled as uniform liquid slugs and gas pockets travelling at the same velocity after all there is an obvious lack of the information on the sfe of flexible marine risers suffering viv this is the main motivation of the present study the paper is organized as follows the simulation model with adopted methodology is elaborated in section 2 in section 3 efforts are devoted to validate the developed codes in section 4 the cf viv responses of a flexible riser subject to slug flow excitations are examined the paper ends with conclusions in section 5 and suggestions are made for further study 2 simulation model 2 1 a flexible marine riser with adopted coordinates the sketch of a horizontal flexible riser experiencing the combined steady slug flow and a uniform current excitation is depicted in fig 1 the riser system consists of a pipe of length l with mass per unit length m p modulus of elasticity e and bending stiffness e i the internal and external diameters of the riser are d i and d e respectively which are relatively small compared to l the inlet and outlet of the pipe are labelled as o 1 and o 2 the densities of the liquid and gas phases are denoted by ρ l and ρ g respectively and the corresponding kinematic viscosities are ν l and ν g the superficial velocities of the liquid phase and the gas phase are v s l and v s g at the entry of the pipe the two phases are propagating inside the pipe and the slug units are propagating with a steady translational velocity v t for a specific location of the pipe the time varying parameters of the internal fluid includes mass per unit length m i density ρ i and velocity v i the origin of the adopted coordinates are set at o 1 euler coordinate x y z is adopted and the lagrangian coordinate s coincides with the local coordinate x the external fluid has a mass per unit length of m e with density ρ e the external imposed tension is t 0 and there is an incoming uniform current u e in the y direction in the following sections a prime stands for s and an overdot denotes t where t is time 2 2 riser structural model this study focuses on cf only viv according to zhang et al 2003a the time varying static pressure effect induced by the slug flow can be ignored referring to païdoussis 2014 and meng et al 2017b the linear equation of the riser system under consideration can be derived in a rigorous way expressed as 1 m s z 2 m i v i z m i v i 2 t 0 z e i z f where z is the cf direction the mass of the riser system is m s m p m i f is the hydrodynamic force per unit length of the riser imposed by the ocean environment as the riser is horizontal the gravity and pressurization effects can be neglected 2 3 hydrodynamic force model the hydrodynamic force f can be decomposed into an added mass force a drag force f d and a lift force f l the formulation is expressed as 2 f m a z f d f l where the added mass m a c a m e with constant coefficient c a 1 0 for simplicity the drag force f d can be calculated by 3 f d 1 2 c d ρ e d e u e z where the drag coefficient c d is assumed to be 1 2 the lift force can be estimated by 4 f l 1 2 ρ e d e u e 2 c l the lift coefficient c l can be calculated by introducing a wake variable q which is formulated as 5 c l 1 2 c l 0 q where c l 0 is the lift coefficient for a stationary pipe with c l 0 0 3 the reduced vortex variable q follows a van der pol oscillator model expressed as 6 q ε z ω s q 2 1 q ω s 2 q a w d e z where the scaling parameter a w and the wake coefficient ε z have been tuned as a w 12 ε z 0 3 facchinetti et al 2004 the angular vortex shedding frequency is 7 ω s 2 π s t u e d e where the strouhal number s t 0 2 a detailed literal description of the adopted hydrodynamic force model can be found in meng et al 2017b 2 4 steady slug flow model two phase slug flow has been widely studied via numerical modelling and scaled experiments taitel and barnea 1990 cook and behnia 1997 zhang et al 2003a b zhu et al 2018 vasquez and avila 2019 the geometry of a steady slug unit is depicted in fig 2 a slug unit with length l u can be divided into a slug region with length l s and a film zone with length l f in the liquid slug region the liquid slugs contain dispersed bubbles and occupy the whole cross sectional area in the film zone it has a space varying liquid film height h f and the gas phase exists as elongated bubbles separated by the liquid slugs it assumes that the slug units propagate at a steady translational velocity v t see fig 1 which can be estimated by 8 v t c v s v d where the mixture velocity v s is calculated by 9 v s v s l v s g the factor c is related to the contribution of the mixture velocity which can take the value of 1 2 chatjigeorgiou 2017 v d is the propagation velocity of a large bubble in stagnant liquid which can be estimated by the following widely used formula as 10 v d 0 54 g d i cos β 0 35 g d i sin β where the gravity acceleration g 9 8 the inclination angle β 0 bendiksen 1984 slug frequency f s is the number of slug units passing through a fixed point of the pipe over a certain period of time and it can be estimated by an empirical correlation in gregory and scott 1969 in this study when the length of the slug unit l u is obtained by numerical iteration f s is calculated by 11 f s v t l u then the period of the slug flow t s is obtained since it is the reciprocal of the slug frequency 2 4 1 liquid slug region according to taitel and barnea 1990 the liquid slug length can be estimated by 12 l s 32 d i for horizontal pipes with small internal diameters the cross section of the liquid slug region is depicted in fig 3 a the velocities of the liquid and the dispersed bubbles are denoted as v l and v b respectively the liquid hold up in the liquid slug region is designated as r s and thus the void fraction is α s 1 r s the value of r s can be calculated by use of the correlation in gregory et al 1978 which is formulated as 13 r s 1 1 v s 8 66 1 39 the bubble velocity can be calculated by 14 v b b v s v 0 where b is the distribution parameter and its evaluation is still an unsolved question which will be discussed in section 3 v 0 is the bubble drift velocity of stagnant liquid which can be estimated by 15 v 0 0 35 g d i as it assumes the densities of the liquid and gas are constant the volumetric flow rate through any cross section of the pipe is constant thus the formula 16 v s v l r s v b α s is obtained chatjigeorgiou 2017 the relative velocity between the slug unit and the inner fluids are 17 v l v t v l 18 v b v t v b 2 4 2 film zone the cross section of the film zone is shown in fig 3 b the velocities of the liquid film and the gas are designated as v f and v g respectively correspondingly the relative velocity between the slug unit and the internal fluids are 19 v f v t v f 20 v g v t v g the liquid hold up is denoted by r f and thus the void fraction is α f 1 r f for a stratified flow the liquid hold up in the film zone can be approximated by 21 r f 1 π π cos 1 h f h f 1 h f 2 where h f 2 h f d i 1 taitel and barnea 1990 a f and a g represent cross sectional areas of the liquid and gas s f and s g are the liquid and gas wetted perimeters s i is the interfacial width and θ is the corresponding radian the geometry parameters are literarily one dimensional functions of the film shape h f s and the geometrical relations are given as follows 22 θ 2 cos 1 1 2 h f d i 23 a f d i 2 2 θ sin θ 2 24 a g π d i 2 4 a f 25 s f θ d i 2 26 s g π d i s f 27 s i d i 2 2 cos θ 2 the steady state slug model in taitel and barnea 1990 is employed to calculate the film shape expressed as 28 d h f d s τ f s f a f τ g s g a g τ i s i 1 a f 1 a g ρ l ρ g g sin β ρ l ρ g g cos β ρ l v f v l r s r f 2 d r f d h f ρ g v g v b α s α f 2 d r f d h f where in case of a stratified flow 29 d r f d h f 4 π d i 1 2 h f d i 1 2 the friction forces between the liquid and the wall τ f the gas and the wall τ g and on the interface between the liquid and the gas τ i can be calculated by 30 τ i 1 2 ρ g f i v g v f v g v f 31 τ f 1 2 ρ l f f v f v f 32 τ g 1 2 ρ g f g v g v g referring to cohen and hanratty 1968 the interfacial gas liquid factor f i can take the value of 0 014 the coefficients f f and f g can be calculated using the blasius correlation formulated as 33 f f c f re f n f g c g re g n where c f c g 0 046 n 0 2 the reynolds numbers of the liquid and gas phases are 34 re f 4 a f v f s f ν l re g 4 a g v g s g s i ν g 2 4 3 mass balance principle as the slug units are propagating ahead part of the two phases is captured by the following slug unit then the relations for the relative velocities of the internal two phase fluids can be formulated as 35 v t v f v t v l r s r f 36 v t v g v t v b α s α f based on mass balance principle moreover after applying the liquid mass balance principle to the slug units 37 v s l v l r s v t α s l f l u v t l u 0 l f α f d s can be derived chatjigeorgiou 2017 2 5 simulation model the slug flow model can be incorporated into the riser structural equation via the relevant terms of the inner flow components after combination with the hydrodynamic force model the governing equations of the riser system can be obtained and it can be discretized adopting galerkin method by imposing 38 z i 1 n m φ i s e i t 39 q i 1 n m φ i s q i t where the eigenfunctions of a linear simply supported beam are utilized as the comparison functions n m is the number of adopted eigenfunctions e i and q i are the corresponding generalized coordinates finally the resulting second order implicit ordinary integral differential equations can be achieved as 40 j 1 n m m 1 i j e j j 1 n m c 1 i j e j j 1 n m k 1 i j e j j 1 n m f i j q j 0 41 j 1 n m m 2 i j q j j 1 n m c 2 i j q j j 1 n m k 1 n m l 1 n m c 3 i j k l q j q k q l j 1 n m k 3 i j q j a w d e j 1 n m m 2 i j e j 0 where m 1 i j 0 l m p m e x m i t φ i φ j d s m 2 i j 0 l φ i φ j d s c 1 i j 0 l 2 m i t v i φ i φ j d s 0 l 1 2 c d ρ e d e u e φ i φ j d s c 2 i j 0 l ε z ω s φ i φ j d s c 3 i j k l 0 l ε z ω s φ i φ j φ k φ l d s k 1 i j 0 l m i t v i 2 t 0 φ i φ j d s e i 0 l φ i φ j d s k 2 i j 0 l ω s 2 φ i φ j d s f i j 0 l 1 4 ρ e d e c l 0 u e 2 φ i φ j d s 2 6 methodology a code has been developed based on matlab the function fix is introduced here and fix x denotes the nearest integer of x towards zero the length of the riser l is discretized by n r nodes creating n r 1 equal length segments δ s the length of the fluid slug is purposely taken equal with an integral multiple of δ s which is the nearest to 32 d i expressed as 42 n s fix 32 d i δ s 43 l s n s δ s where n s is the number of segments in the liquid slug region the segment length δ s should be small enough to describe the liquid slug region the transient pattern of the slug flow at an arbitrary time t 0 is shown in fig 4 the coordinate s 0 in lagrangian coordinate is the distance between the entry of the pipe o 1 and the front of the first complete slug unit which can be calculated by 44 s 0 t fix f s t t s v t the first step is to predict the characteristics of a fully developed steady slug unit and the procedures are given as follows 1 the superficial velocities v s l and v s g are known parameters the translational velocity v t the liquid hold up r s the bubble velocity v b and the liquid slug velocity v l can be calculated by eq 8 eq 13 eq 14 and eq 16 respectively 2 at the interface of the liquid slug and the film zone the height of the film the liquid hold up the velocities of the fluid and gas are denoted as h f e r f e v f e and v g e respectively h f e can be obtained by use of eq 21 assuming r f e r s v f e and v g e can be calculated utilizing eq 36 and eq 37 respectively then the film shape can be computed adopting eq 29 which can be solved by a numerical method with a step size δ s the iteration is accomplished when eq 38 is satisfied δ s should be sufficiently small to satisfy the required precision the convergence can be confirmed by increasing the node number n r the second step aims to capture the intermittent feature when the slug units are formed and propagating continuously at the initial time i e t 0 it assumes that the pipe is full of slug units and the number of complete slug units is n c fix l l u the incomplete slug unit can be placed in the upper or and lower end s of the pipe in this study the incomplete slug unit is placed in the lower end there is a hypothetical pipe from x 0 to x 2 which contains n 1 slug units see fig 4 recalling that s 0 can be zero and the pipe length l may not be an integer multiple of the slug unit length l u the number n is defined as n n c 1 one more slug unit is required in the hypothetical pipe from x 0 to x 1 to simulate the incoming slug unit o 1 to s o in the real pipe for any specific slug flow parameter ξ in the hypothetical pipe a vector ξ 1 is defined by use of n steady slug units from x 1 to x 2 and another vector ξ 2 is defined using one steady slug unit from x 1 to x 0 then at any time step in simulations the slug flow parameter ξ of the segments from s 0 to o 2 in the real pipe receive data from the vector ξ 1 and the parameter ξ from s 0 to o 1 gains the data from the vector ξ 2 it is stated that when stable solutions are obtained the dynamics response of the riser is the same at different initial conditions of the internal steady slug flow the third step is to calculate the natural frequencies of the riser system and predict the dynamic response when it suffers viv at any time step once the steady slug flow model is solved the inner flow parameters are incorporated into the riser simulation model the linear part of eq 41 can be translated into a standard eigenvalue problem for the calculation of natural frequencies meanwhile eq 41 and eq 43 can be solved by houbolt s finite difference scheme with newton raphson method then the dynamic response of the riser can be examined in time domain the detailed solution procedures can be found in meng et al 2017b 3 validation of simulation a matlab code was developed to investigate the ife on the viv response of flexible marine risers the code has been validated for viv predictions and natural frequency calculations in meng et al 2017b the code is updated by accounting for the sfe based on the present study for the validation of sfe the experiments of 20 m long horizontal air water pipes with 32 and 50 mm in diameter in cook and behnia 1997 is introduced here the physical parameters of the internal two phases are assumed to be ρ l 1000 kg m 3 ν l 1 01 10 6 m 2 s ρ g 1 29 kg m 3 and ν g 1 48 10 5 m 2 s the predicted time traces of the film profiles in two cases i e case 1 d i 0 032 m v s l 1 51 m s v s g 4 11 m s case 2 d i 0 050 m v s l 1 42 m s v s g 2 08 m s at different values of the distribution parameter b see eq 14 are plotted in fig 5 the varying trend of the predicted time traces at different b is the same and it shows good coherence in comparison with the experimental observations however the film length and film height increase with the increase of the parameter b moreover it is found that the simulations at b 1 0 in case 1 and b 0 7 in case 2 provide the best fits to the measured data it is noticed that due to the lack of evidence factor b was assumed to be 1 0 for horizontal slug flows in taitel and barnea 1990 the formulas for the evaluation of b have also been proposed assuming b is only a function of the inclination angle β bendiksen 1984 mayor et al 2008 however the present simulation suggests that factor b is not a constant value for horizontal flows and the slug flow conditions should be accounted for when formulating the parameter b 4 slug flow effect on vivs of a flexible riser the flexible riser in the experiments conducted by song et al 2016 is employed here which has an aspect ratio of 263 and mass ratio of 2 5 the physical parameters are listed in table 1 where f 1 and f 2 are the lowest two natural frequencies in still water three internal flow conditions are defined at first case a the pipe is filled with still water case b the pipe is full of single phase water at v i 1 51 m s case c the pipe is conveying a slug flow at v s l 1 51 m s and v s g 4 11 m s the predicted liquid hold up r and liquid height h along the riser in case 3 are illustrated in fig 6 and the slug flow period is estimated as t s 0 49 s the natural frequencies of the riser in still water are simulated in three cases by a ten mode galerkin approximation and the predicted first two natural frequencies in case 3 are illustrated in fig 7 the single phase ife on the natural frequencies has been elaborated in meng et al 2017b and the ife on natural frequencies in case b is negligible since v i 1 51 m s is too small the average natural frequencies of the riser system conveying a slug flow in case c is increased compared to the constant natural frequencies in case a and case b it can be contributed to the reduction of the internal fluid mass in case c most importantly it is found that the sfe can introduce a fluctuating component with a constant period t s i e the slug flow period which agrees with the simulations in liu and wang 2018 4 1 u e 0 4 m s the measured cf rms displacement of the riser in the experiment when u e 0 4 m s is shown in fig 8 and it is found that the riser is locked with the first natural mode simulations of the flexible riser in the three cases i e case a case b and case c are conducted employing ten eigenfunctions i e n m 10 then the modes involved can be divided into odd multiple modes i e 1 st 3 rd 9 th modes and even multiple modes i e 2 nd 4 th 10 th modes simulations of the flexible riser in case a are undertaken at first and the predicted cf rms displacement of the riser is plotted in fig 8 the simulation in case a can capture the right dominant mode of vibration although the rms displacements are underestimated which has been explained in meng et al 2017b in case a only odd multiple modes have been excited and the first mode is absolutely dominant as examples the time traces of the modal coordinates of the first second and fifth modes in case a are depicted in fig 9 then simulations are conducted in case b it is found that as the internal flow velocity is too small the simulations in case b yield almost the same rms displacement of the riser and almost the same time histories of the odd multiple modes which are not presented here for brevity however all the even multiple modes have been trigged in case b contributed to the single phase ife although the strain contributions of the excited even modes are too small compared to the dominant mode i e the first mode as examples the predicted time traces of the modal coordinates e 2 and e 4 in case b are shown in fig 10 a and b respectively finally simulations are performed in case c the simulations in case c yield almost the same rms displacement with the predictions in case a and b same as the predictions in case b all the even multiple modes have been trigged and the strain contributions of the excited even modes are too small compared to the dominant mode i e the first mode however it is found that the combination of the slug flow frequency and the vibration frequencies produces an amplitude modulation response of all the excited modes which is quite distinguished from simulations in case b this phenomenon is quite remarkable in the dynamic response of even multiple modes and high odd multiple modes which can only contributed to the sfe most distinctively beating behaviors i e large amplitude modulated oscillations can be captured which corresponds to the resonant synchronization phenomenon as examples the time histories of the modal coordinate e 4 and e 7 in case c are shown in fig 10 b and c respectively 4 2 u e 2 8 m s the measured cf rms displacement of the riser in the experiment when u e 2 8 m s is shown in fig 11 and the riser is synchronized with the fifth natural mode simulations of the flexible riser in the three cases i e case a case b and case c are undertaken employing twenty eigenfunctions i e n m 20 then the natural modes involved can be classified as odd multiple modes i e 5 th and 15 th modes the odd non multiple modes i e 1 st 3 rd 7 th 13 rd 17 th 19 th modes and the even modes i e 2 nd 20 th modes simulations of the flexible riser in case a are undertaken at first and the predicted cf rms displacement of the riser is depicted in fig 11 the simulation can capture the right dominant mode of vibration and satisfying agreements are observed as regards the rms displacement of the riser in case a the odd multiple modes have been excited and the fifth mode is absolutely dominant all the odd non multiple modes and even modes are not triggered as examples the predicted time traces of the modal coordinates e 3 and e 15 in case a are shown in fig 12 then simulations are performed in case b as expected the internal flow velocity is too small to affect the odd multiple modes and the resultant rms displacement of the riser however it is noticed that owing to the single phase ife all the even modes and odd non multiple modes have also been trigged although the strain contributions are small compared to that of the dominant mode i e the fifth mode as examples the time histories of the modal coordinates e 2 and e 3 are shown in fig 13 a and b respectively finally simulations are carried out in case c the simulations in case c yield almost the same rms displacement with that in case a and case b same as the single phase ife in case b all the even modes and odd non multiple modes have been trigged distinguished from simulations in case b the combination of the slug flow frequency and the vibration frequencies produces an amplitude modulation response of all the excited modes this phenomenon is quite remarkable in the non multiple modes and the even modes as examples the time histories of the modal coordinate e 2 e 3 and e 15 in case c are depicted in fig 13 the beating behaviors have also been captured in the non multiple modes and the even modes as shown in fig 13 a and b it is worth noticing that although the internal fluid mass in case c is much less than that in case b the presence of beating response induced by the slug flow s intermittent feature can cause a great increase of the vibration amplitudes of the modal coordinates 5 conclusions and future study motived by the fact that the slug s flow s intermittent feature may cause additional vibrations this study devotes efforts to investigating sfe of a flexible marine riser experiencing viv based on the previously study in meng et al 2017b the main contributions of this study can be summarized as follows 1 a simulation model for analyzing the dynamical behaviour of a flexible riser which is exposed to an internal two phase slug flow and an external uniform current simultaneously has been developed a novel approach has been proposed to capture the two phase slug flow s intermittent feature which is validated by comparisons with experiments 2 it can be concluded that the sfe is much more profound than single phase ife on the viv responses of flexible marine risers owing to the intermittent feature although the internal fluid mass is reduced compared to the pipe conveying a single phase fluid it has demonstrated that when a flexible riser is subjected to the combined excitation of a internal two phase slug flow and an external current new natural modes can be triggered and the excited modes can exhibit an amplitude modulation response beating behaviors which correspond to the resonant synchronization phenomenon have also been captured therefore the sfe should be accounted for in fatigue analysis of a flexible marine riser conveying a two phase slug flow even if the slug flow velocity is small three dimensional study is required to discover the intrinsic coupled mechanisms of sfe on viv of flexible risers extensive simulations remains to be conducted in a wide slug flow regime combined with more external current conditions a scaled model experiment based on the present simulation model is going to be conducted in the circulation channel at shanghai jiao tong university the experimental observations together with the revised simulations will be presented in the next paper acknowledgement the authors gratefully acknowledge the supports of the national natural science foundation of china grant no 51879161 
21894,slug flow is characterized by the variations of internal flow parameters with time and position this study aims to investigate the slug flow effect sfe on the cross flow vortex induced vibration viv of a flexible riser a steady slug flow model is adopted using several assumptions and empirical correlations a distribution of van der pol oscillators is employed to create the viv effect a novel approach has been proposed to capture the intermittent feature which is validated by comparisons with experiments the sfe is explored by comparisons of the dynamic behaviors of a flexible riser subject to two uniform currents assuming the pipe is filled with still liquid transporting a single phase liquid flow and a two phase slug flow it has demonstrated that the sfe is much more profound than the single phase internal flow effect a flexible riser conveying a slug flow can exhibit quite distinguished dynamics owing to the intermittent feature apart from triggering new modes the combination of slug flow frequency and viv frequency can generate an amplitude modulation phenomenon of excited modes most distinctively beating behaviours which corresponds to the resonant synchronization have been captured this study can contribute to fatigue analysis of a flexible riser conveying a two phase slug flow keywords slug flow effect intermittent feature viv amplitude modulation beating behaviour nomenclature l the length of the horizontal riser m p the mass of the riser structure per unit length e the elastic modulus of the riser e i the bending stiffness of the riser d i the internal diameter of the riser d e the external diameter of the riser o 1 the inlet of the pipe o 2 the outlet of the pipe ρ l the density of the inner liquid ρ g the density of the inner gas ν l the kinematic viscosity of the inner liquid ν g the kinematic viscosity of the inner gas v s l the superficial velocity of the inner liquid v s g the superficial velocity of the inner gas v t the translational velocity of the slug flow v i the time and space varying velocity of the internal flow ρ i the time and space varying density of the internal flow per unit length m i the time and space varying mass of the internal fluid ρ e the density of seawater m e the mass of the external fluid per unit length u e the velocity of incoming uniform current t 0 the external imposed tension x y z the euler coordinate s the lagrangian coordinate along the pipe axis m s the mass of the riser system per unit length f the hydrodynamic force m a the added mass c a the added mass coefficient f d the drag force c d the drag force coefficient f l the lift force c l the lift force coefficient c l 0 the lift force coefficient for a stationary riser q the reduced vortex variable a w the scaling parameter ε z the wake coefficient s t the strouhal number ω s the angular vortex shedding frequency l u the length of a slug unit l s the length of the liquid slug l f the length of the film zone h f the space varying liquid film height c the mixture velocity factor v s the mixture velocity v d the propagation velocity of a large bubble in stagnant liquid g the gravity acceleration f s the slug frequency t s the slug period v l the liquid velocity in the liquid slug region v b the velocity of the dispersed bubbles in the liquid slug region r s the liquid hold up in the liquid slug region α s the void fraction in the liquid slug region b the distribution parameter v 0 the bubble drift velocity of stagnant liquid v l the relative velocity between the slug unit and the inner liquid in the liquid slug region v b the relative velocity between the slug unit and the dispersed bubbles in the liquid slug region v f the velocity of the liquid film in the film zone v f the relative velocity between the slug unit and the liquid film in the film zone v g the velocity of the gas in the film zone v g the relative velocity between the slug unit and the gas in the film zone r f the liquid hold up in the film zone α f the void fraction in the film zone β the inclination angle of the riser a f the cross sectional area of the film liquid a g the cross sectional area of the gas s f the liquid wetted perimeters in the film zone s g the gas wetted perimeters in the film zone s i the interfacial width in the film zone θ the interfacial radian in the film zone τ f the friction force between the liquid and the wall in the film zone τ g the friction force between the gas and the wall in the film zone τ i the friction force between the liquid and the gas on the interface in the film zone f f the friction force coefficient between the liquid and the wall in the film zone f g the friction force coefficient between the gas and the wall in the film zone f i the interfacial gas liquid factor in the film zone re f the reynolds number of the liquid phase re g the reynolds number of the gas phase n m the number of eigenfunctions φ i s the adopted eigenfunctions i 1 n m e i q i the generalized coordinates in galerkin method i 1 n m n r the nodes of riser δ s the length of the riser segments n s the segment number in the liquid slug region s 0 the distance between the entry and the front of the first complete slug unit h f e the height of the film at the interface of the liquid slug and the film zone r f e the liquid hold up of the film at the interface of the liquid slug and the film zone v f e the fluid velocity of the film at the interface of the liquid slug and the film zone v g e the gas velocity of the film at the interface of the liquid slug and the film zone n c the number of complete slug units in the pipe r the liquid hold up along the pipe h the liquid height along the pipe 1 introduction marine risers inevitably experience vortex induced vibration viv which is one of the major concerns for structural integrity viv has attracted great attentions in the past decades and comprehensive reviews of viv study have been made williamson and govardhan 2004 sarpkaya 2004 wu et al 2012 hong and shah 2018 as ocean recourse exploration expands into ultra deep waters marine risers become much longer and slenderer the long flexible marine risers start exhibiting new dynamic features for example the viv response of the employed long flexible cylinder in the second gulf stream experiment was dominated by travelling waves sheshadri 2009 vandiver et al 2009 continuous efforts are devoted to reducing the uncertainties and figuring out the influential factors which have been ignored in previous studies gao et al 2019 for example one should not expect perfect synchronization because of the continuous interaction between the body and the fluctuations of added mass separation line amplitude correlation length and the phase angle sarpkaya 2004 viv of long flexible marine risers is characterized by the complicated response where a number of distinct frequency components can be simultaneously active which can be categorized as fundamental and higher harmonics although the higher order strain contributions are too small to reach the dominant mode strain level it has demonstrated that higher harmonics can have a tremendous impact on the fatigue life of the riser system zheng et al 2014 wu et al 2019 thorsen et al 2019 it is stated that with the increased aspect ratio and flexibility of marine risers internal flow effect ife on riser dynamics becomes significant atadan et al 1997 chatjigeorgiou 2010 wang and duan 2015 xu et al 2018 meng et al 2017b have found that for a flexible riser undergoing viv an single phase internal flow can trigger new natural modes and switch the role of the most predominant one when the internal flow velocity is sufficiently high this study focuses on the two phase slug flow effect sfe on the cross flow cf viv of a flexible riser subjected to a uniform current it is a direct extension of the former study in meng et al 2017b ife on the dynamics of flexible marine risers has been extensively studied under various external flow excitations such as the top end excitation from floating structures meng et al 2018 viv imposed by an incoming current guo and lou 2008 keber and wiercigroch 2008 meng and chen 2012 dai et al 2013 meng et al 2017a b wang et al 2018 liu et al 2019 the combined viv and top end excitations he et al 2017 however in the aforementioned studies internal flow is typically considered as a single phase steady flow in which the flow velocity profile is constant throughout the pipe it is known that the internal fluid inside a marine riser is a mixture of oil gas and water moreover there is a tendency that long pipelines are employed to transport natural resources without a previous separation process to avoid the use of platforms boris et al 2014 therefore multi phase ife of flexible marine risers has drawn particular attentions in recent years miranda and paik 2019 reported that compared to the single phase ife a two phase internal flow model could lead to significant variations as regards the dynamics of marine pipelines one representative type of two phase flow is slug flow in which the slugs are formed continuously as the inner liquid is transported through the riser gundersen et al 2012 states that there is an approximately 50 reduction in fatigue life of flexible risers when it suffers the combined irregular wave and slug flow excitations sfe on the dynamics of flexible risers has been witnessed in numerical simulations and scaled experiments park et al 2019 zhu et al 2018 vasquez and avila 2019 chatjigeorgiou 2017 has concluded that the sfe is very important on the dynamics of a catenary risers subject to top harmonic excitation in contrast to the marginal effect of other internal flow models such as the plug flow model a two phase slug flow is characterized by a sequence of liquid slugs and gas bubbles the slug flow patterns can generate rapid changes of the fluid mass and velocity distribution along the pipe this intermittent feature inevitably affects the natural frequencies and the viv responses of flexible risers this study is thus motivated to examine the sfe of a flexible marine riser undergoing viv researchers have devoted efforts to the sfe on vivs of flexible marine risers xie et al 2019 modelled the internal multi phase mixture as a monophasic flow they states that the fluctuation of internal fluid density can affect the vibration response of the riser suffering viv blanco and casanova 2010 assumed the internal slug flow as moving masses and the sfe was taken into account by computing instantaneous internal fluid mass they have demonstrated that the predicted fatigue life may be significantly modified when considering the conjunction of sfe and viv boris et al 2014 analyzed two extreme cases i e small size and large size slugs to examine the integration of between slug flow and viv of a flexible submarine pipeline however in these studies only the instantaneous time varying fluid mass is accounted for while the internal flow velocity effects are ignored it is worth noting that the velocity fluctuation of internal flow can significantly influence the viv responses of flexible pipes dai et al 2014 knudsen et al 2016 conducted a numerical analysis of combined viv and slug flow where the slug flow is modelled with constant internal velocity pressure and uniform slug lengths sfe was accounted for by introducing a time varying mass term and a centrifugal force without considering the coriolis force they reported that the slug velocity and slug length had an obvious influence on the response pattern amplitude and frequency safrendyo and srinil 2018 investigated the slug flow induced oscillation in subsea catenary riser experiencing viv for the sake of simplicity the slug flow was modelled as uniform liquid slugs and gas pockets travelling at the same velocity after all there is an obvious lack of the information on the sfe of flexible marine risers suffering viv this is the main motivation of the present study the paper is organized as follows the simulation model with adopted methodology is elaborated in section 2 in section 3 efforts are devoted to validate the developed codes in section 4 the cf viv responses of a flexible riser subject to slug flow excitations are examined the paper ends with conclusions in section 5 and suggestions are made for further study 2 simulation model 2 1 a flexible marine riser with adopted coordinates the sketch of a horizontal flexible riser experiencing the combined steady slug flow and a uniform current excitation is depicted in fig 1 the riser system consists of a pipe of length l with mass per unit length m p modulus of elasticity e and bending stiffness e i the internal and external diameters of the riser are d i and d e respectively which are relatively small compared to l the inlet and outlet of the pipe are labelled as o 1 and o 2 the densities of the liquid and gas phases are denoted by ρ l and ρ g respectively and the corresponding kinematic viscosities are ν l and ν g the superficial velocities of the liquid phase and the gas phase are v s l and v s g at the entry of the pipe the two phases are propagating inside the pipe and the slug units are propagating with a steady translational velocity v t for a specific location of the pipe the time varying parameters of the internal fluid includes mass per unit length m i density ρ i and velocity v i the origin of the adopted coordinates are set at o 1 euler coordinate x y z is adopted and the lagrangian coordinate s coincides with the local coordinate x the external fluid has a mass per unit length of m e with density ρ e the external imposed tension is t 0 and there is an incoming uniform current u e in the y direction in the following sections a prime stands for s and an overdot denotes t where t is time 2 2 riser structural model this study focuses on cf only viv according to zhang et al 2003a the time varying static pressure effect induced by the slug flow can be ignored referring to païdoussis 2014 and meng et al 2017b the linear equation of the riser system under consideration can be derived in a rigorous way expressed as 1 m s z 2 m i v i z m i v i 2 t 0 z e i z f where z is the cf direction the mass of the riser system is m s m p m i f is the hydrodynamic force per unit length of the riser imposed by the ocean environment as the riser is horizontal the gravity and pressurization effects can be neglected 2 3 hydrodynamic force model the hydrodynamic force f can be decomposed into an added mass force a drag force f d and a lift force f l the formulation is expressed as 2 f m a z f d f l where the added mass m a c a m e with constant coefficient c a 1 0 for simplicity the drag force f d can be calculated by 3 f d 1 2 c d ρ e d e u e z where the drag coefficient c d is assumed to be 1 2 the lift force can be estimated by 4 f l 1 2 ρ e d e u e 2 c l the lift coefficient c l can be calculated by introducing a wake variable q which is formulated as 5 c l 1 2 c l 0 q where c l 0 is the lift coefficient for a stationary pipe with c l 0 0 3 the reduced vortex variable q follows a van der pol oscillator model expressed as 6 q ε z ω s q 2 1 q ω s 2 q a w d e z where the scaling parameter a w and the wake coefficient ε z have been tuned as a w 12 ε z 0 3 facchinetti et al 2004 the angular vortex shedding frequency is 7 ω s 2 π s t u e d e where the strouhal number s t 0 2 a detailed literal description of the adopted hydrodynamic force model can be found in meng et al 2017b 2 4 steady slug flow model two phase slug flow has been widely studied via numerical modelling and scaled experiments taitel and barnea 1990 cook and behnia 1997 zhang et al 2003a b zhu et al 2018 vasquez and avila 2019 the geometry of a steady slug unit is depicted in fig 2 a slug unit with length l u can be divided into a slug region with length l s and a film zone with length l f in the liquid slug region the liquid slugs contain dispersed bubbles and occupy the whole cross sectional area in the film zone it has a space varying liquid film height h f and the gas phase exists as elongated bubbles separated by the liquid slugs it assumes that the slug units propagate at a steady translational velocity v t see fig 1 which can be estimated by 8 v t c v s v d where the mixture velocity v s is calculated by 9 v s v s l v s g the factor c is related to the contribution of the mixture velocity which can take the value of 1 2 chatjigeorgiou 2017 v d is the propagation velocity of a large bubble in stagnant liquid which can be estimated by the following widely used formula as 10 v d 0 54 g d i cos β 0 35 g d i sin β where the gravity acceleration g 9 8 the inclination angle β 0 bendiksen 1984 slug frequency f s is the number of slug units passing through a fixed point of the pipe over a certain period of time and it can be estimated by an empirical correlation in gregory and scott 1969 in this study when the length of the slug unit l u is obtained by numerical iteration f s is calculated by 11 f s v t l u then the period of the slug flow t s is obtained since it is the reciprocal of the slug frequency 2 4 1 liquid slug region according to taitel and barnea 1990 the liquid slug length can be estimated by 12 l s 32 d i for horizontal pipes with small internal diameters the cross section of the liquid slug region is depicted in fig 3 a the velocities of the liquid and the dispersed bubbles are denoted as v l and v b respectively the liquid hold up in the liquid slug region is designated as r s and thus the void fraction is α s 1 r s the value of r s can be calculated by use of the correlation in gregory et al 1978 which is formulated as 13 r s 1 1 v s 8 66 1 39 the bubble velocity can be calculated by 14 v b b v s v 0 where b is the distribution parameter and its evaluation is still an unsolved question which will be discussed in section 3 v 0 is the bubble drift velocity of stagnant liquid which can be estimated by 15 v 0 0 35 g d i as it assumes the densities of the liquid and gas are constant the volumetric flow rate through any cross section of the pipe is constant thus the formula 16 v s v l r s v b α s is obtained chatjigeorgiou 2017 the relative velocity between the slug unit and the inner fluids are 17 v l v t v l 18 v b v t v b 2 4 2 film zone the cross section of the film zone is shown in fig 3 b the velocities of the liquid film and the gas are designated as v f and v g respectively correspondingly the relative velocity between the slug unit and the internal fluids are 19 v f v t v f 20 v g v t v g the liquid hold up is denoted by r f and thus the void fraction is α f 1 r f for a stratified flow the liquid hold up in the film zone can be approximated by 21 r f 1 π π cos 1 h f h f 1 h f 2 where h f 2 h f d i 1 taitel and barnea 1990 a f and a g represent cross sectional areas of the liquid and gas s f and s g are the liquid and gas wetted perimeters s i is the interfacial width and θ is the corresponding radian the geometry parameters are literarily one dimensional functions of the film shape h f s and the geometrical relations are given as follows 22 θ 2 cos 1 1 2 h f d i 23 a f d i 2 2 θ sin θ 2 24 a g π d i 2 4 a f 25 s f θ d i 2 26 s g π d i s f 27 s i d i 2 2 cos θ 2 the steady state slug model in taitel and barnea 1990 is employed to calculate the film shape expressed as 28 d h f d s τ f s f a f τ g s g a g τ i s i 1 a f 1 a g ρ l ρ g g sin β ρ l ρ g g cos β ρ l v f v l r s r f 2 d r f d h f ρ g v g v b α s α f 2 d r f d h f where in case of a stratified flow 29 d r f d h f 4 π d i 1 2 h f d i 1 2 the friction forces between the liquid and the wall τ f the gas and the wall τ g and on the interface between the liquid and the gas τ i can be calculated by 30 τ i 1 2 ρ g f i v g v f v g v f 31 τ f 1 2 ρ l f f v f v f 32 τ g 1 2 ρ g f g v g v g referring to cohen and hanratty 1968 the interfacial gas liquid factor f i can take the value of 0 014 the coefficients f f and f g can be calculated using the blasius correlation formulated as 33 f f c f re f n f g c g re g n where c f c g 0 046 n 0 2 the reynolds numbers of the liquid and gas phases are 34 re f 4 a f v f s f ν l re g 4 a g v g s g s i ν g 2 4 3 mass balance principle as the slug units are propagating ahead part of the two phases is captured by the following slug unit then the relations for the relative velocities of the internal two phase fluids can be formulated as 35 v t v f v t v l r s r f 36 v t v g v t v b α s α f based on mass balance principle moreover after applying the liquid mass balance principle to the slug units 37 v s l v l r s v t α s l f l u v t l u 0 l f α f d s can be derived chatjigeorgiou 2017 2 5 simulation model the slug flow model can be incorporated into the riser structural equation via the relevant terms of the inner flow components after combination with the hydrodynamic force model the governing equations of the riser system can be obtained and it can be discretized adopting galerkin method by imposing 38 z i 1 n m φ i s e i t 39 q i 1 n m φ i s q i t where the eigenfunctions of a linear simply supported beam are utilized as the comparison functions n m is the number of adopted eigenfunctions e i and q i are the corresponding generalized coordinates finally the resulting second order implicit ordinary integral differential equations can be achieved as 40 j 1 n m m 1 i j e j j 1 n m c 1 i j e j j 1 n m k 1 i j e j j 1 n m f i j q j 0 41 j 1 n m m 2 i j q j j 1 n m c 2 i j q j j 1 n m k 1 n m l 1 n m c 3 i j k l q j q k q l j 1 n m k 3 i j q j a w d e j 1 n m m 2 i j e j 0 where m 1 i j 0 l m p m e x m i t φ i φ j d s m 2 i j 0 l φ i φ j d s c 1 i j 0 l 2 m i t v i φ i φ j d s 0 l 1 2 c d ρ e d e u e φ i φ j d s c 2 i j 0 l ε z ω s φ i φ j d s c 3 i j k l 0 l ε z ω s φ i φ j φ k φ l d s k 1 i j 0 l m i t v i 2 t 0 φ i φ j d s e i 0 l φ i φ j d s k 2 i j 0 l ω s 2 φ i φ j d s f i j 0 l 1 4 ρ e d e c l 0 u e 2 φ i φ j d s 2 6 methodology a code has been developed based on matlab the function fix is introduced here and fix x denotes the nearest integer of x towards zero the length of the riser l is discretized by n r nodes creating n r 1 equal length segments δ s the length of the fluid slug is purposely taken equal with an integral multiple of δ s which is the nearest to 32 d i expressed as 42 n s fix 32 d i δ s 43 l s n s δ s where n s is the number of segments in the liquid slug region the segment length δ s should be small enough to describe the liquid slug region the transient pattern of the slug flow at an arbitrary time t 0 is shown in fig 4 the coordinate s 0 in lagrangian coordinate is the distance between the entry of the pipe o 1 and the front of the first complete slug unit which can be calculated by 44 s 0 t fix f s t t s v t the first step is to predict the characteristics of a fully developed steady slug unit and the procedures are given as follows 1 the superficial velocities v s l and v s g are known parameters the translational velocity v t the liquid hold up r s the bubble velocity v b and the liquid slug velocity v l can be calculated by eq 8 eq 13 eq 14 and eq 16 respectively 2 at the interface of the liquid slug and the film zone the height of the film the liquid hold up the velocities of the fluid and gas are denoted as h f e r f e v f e and v g e respectively h f e can be obtained by use of eq 21 assuming r f e r s v f e and v g e can be calculated utilizing eq 36 and eq 37 respectively then the film shape can be computed adopting eq 29 which can be solved by a numerical method with a step size δ s the iteration is accomplished when eq 38 is satisfied δ s should be sufficiently small to satisfy the required precision the convergence can be confirmed by increasing the node number n r the second step aims to capture the intermittent feature when the slug units are formed and propagating continuously at the initial time i e t 0 it assumes that the pipe is full of slug units and the number of complete slug units is n c fix l l u the incomplete slug unit can be placed in the upper or and lower end s of the pipe in this study the incomplete slug unit is placed in the lower end there is a hypothetical pipe from x 0 to x 2 which contains n 1 slug units see fig 4 recalling that s 0 can be zero and the pipe length l may not be an integer multiple of the slug unit length l u the number n is defined as n n c 1 one more slug unit is required in the hypothetical pipe from x 0 to x 1 to simulate the incoming slug unit o 1 to s o in the real pipe for any specific slug flow parameter ξ in the hypothetical pipe a vector ξ 1 is defined by use of n steady slug units from x 1 to x 2 and another vector ξ 2 is defined using one steady slug unit from x 1 to x 0 then at any time step in simulations the slug flow parameter ξ of the segments from s 0 to o 2 in the real pipe receive data from the vector ξ 1 and the parameter ξ from s 0 to o 1 gains the data from the vector ξ 2 it is stated that when stable solutions are obtained the dynamics response of the riser is the same at different initial conditions of the internal steady slug flow the third step is to calculate the natural frequencies of the riser system and predict the dynamic response when it suffers viv at any time step once the steady slug flow model is solved the inner flow parameters are incorporated into the riser simulation model the linear part of eq 41 can be translated into a standard eigenvalue problem for the calculation of natural frequencies meanwhile eq 41 and eq 43 can be solved by houbolt s finite difference scheme with newton raphson method then the dynamic response of the riser can be examined in time domain the detailed solution procedures can be found in meng et al 2017b 3 validation of simulation a matlab code was developed to investigate the ife on the viv response of flexible marine risers the code has been validated for viv predictions and natural frequency calculations in meng et al 2017b the code is updated by accounting for the sfe based on the present study for the validation of sfe the experiments of 20 m long horizontal air water pipes with 32 and 50 mm in diameter in cook and behnia 1997 is introduced here the physical parameters of the internal two phases are assumed to be ρ l 1000 kg m 3 ν l 1 01 10 6 m 2 s ρ g 1 29 kg m 3 and ν g 1 48 10 5 m 2 s the predicted time traces of the film profiles in two cases i e case 1 d i 0 032 m v s l 1 51 m s v s g 4 11 m s case 2 d i 0 050 m v s l 1 42 m s v s g 2 08 m s at different values of the distribution parameter b see eq 14 are plotted in fig 5 the varying trend of the predicted time traces at different b is the same and it shows good coherence in comparison with the experimental observations however the film length and film height increase with the increase of the parameter b moreover it is found that the simulations at b 1 0 in case 1 and b 0 7 in case 2 provide the best fits to the measured data it is noticed that due to the lack of evidence factor b was assumed to be 1 0 for horizontal slug flows in taitel and barnea 1990 the formulas for the evaluation of b have also been proposed assuming b is only a function of the inclination angle β bendiksen 1984 mayor et al 2008 however the present simulation suggests that factor b is not a constant value for horizontal flows and the slug flow conditions should be accounted for when formulating the parameter b 4 slug flow effect on vivs of a flexible riser the flexible riser in the experiments conducted by song et al 2016 is employed here which has an aspect ratio of 263 and mass ratio of 2 5 the physical parameters are listed in table 1 where f 1 and f 2 are the lowest two natural frequencies in still water three internal flow conditions are defined at first case a the pipe is filled with still water case b the pipe is full of single phase water at v i 1 51 m s case c the pipe is conveying a slug flow at v s l 1 51 m s and v s g 4 11 m s the predicted liquid hold up r and liquid height h along the riser in case 3 are illustrated in fig 6 and the slug flow period is estimated as t s 0 49 s the natural frequencies of the riser in still water are simulated in three cases by a ten mode galerkin approximation and the predicted first two natural frequencies in case 3 are illustrated in fig 7 the single phase ife on the natural frequencies has been elaborated in meng et al 2017b and the ife on natural frequencies in case b is negligible since v i 1 51 m s is too small the average natural frequencies of the riser system conveying a slug flow in case c is increased compared to the constant natural frequencies in case a and case b it can be contributed to the reduction of the internal fluid mass in case c most importantly it is found that the sfe can introduce a fluctuating component with a constant period t s i e the slug flow period which agrees with the simulations in liu and wang 2018 4 1 u e 0 4 m s the measured cf rms displacement of the riser in the experiment when u e 0 4 m s is shown in fig 8 and it is found that the riser is locked with the first natural mode simulations of the flexible riser in the three cases i e case a case b and case c are conducted employing ten eigenfunctions i e n m 10 then the modes involved can be divided into odd multiple modes i e 1 st 3 rd 9 th modes and even multiple modes i e 2 nd 4 th 10 th modes simulations of the flexible riser in case a are undertaken at first and the predicted cf rms displacement of the riser is plotted in fig 8 the simulation in case a can capture the right dominant mode of vibration although the rms displacements are underestimated which has been explained in meng et al 2017b in case a only odd multiple modes have been excited and the first mode is absolutely dominant as examples the time traces of the modal coordinates of the first second and fifth modes in case a are depicted in fig 9 then simulations are conducted in case b it is found that as the internal flow velocity is too small the simulations in case b yield almost the same rms displacement of the riser and almost the same time histories of the odd multiple modes which are not presented here for brevity however all the even multiple modes have been trigged in case b contributed to the single phase ife although the strain contributions of the excited even modes are too small compared to the dominant mode i e the first mode as examples the predicted time traces of the modal coordinates e 2 and e 4 in case b are shown in fig 10 a and b respectively finally simulations are performed in case c the simulations in case c yield almost the same rms displacement with the predictions in case a and b same as the predictions in case b all the even multiple modes have been trigged and the strain contributions of the excited even modes are too small compared to the dominant mode i e the first mode however it is found that the combination of the slug flow frequency and the vibration frequencies produces an amplitude modulation response of all the excited modes which is quite distinguished from simulations in case b this phenomenon is quite remarkable in the dynamic response of even multiple modes and high odd multiple modes which can only contributed to the sfe most distinctively beating behaviors i e large amplitude modulated oscillations can be captured which corresponds to the resonant synchronization phenomenon as examples the time histories of the modal coordinate e 4 and e 7 in case c are shown in fig 10 b and c respectively 4 2 u e 2 8 m s the measured cf rms displacement of the riser in the experiment when u e 2 8 m s is shown in fig 11 and the riser is synchronized with the fifth natural mode simulations of the flexible riser in the three cases i e case a case b and case c are undertaken employing twenty eigenfunctions i e n m 20 then the natural modes involved can be classified as odd multiple modes i e 5 th and 15 th modes the odd non multiple modes i e 1 st 3 rd 7 th 13 rd 17 th 19 th modes and the even modes i e 2 nd 20 th modes simulations of the flexible riser in case a are undertaken at first and the predicted cf rms displacement of the riser is depicted in fig 11 the simulation can capture the right dominant mode of vibration and satisfying agreements are observed as regards the rms displacement of the riser in case a the odd multiple modes have been excited and the fifth mode is absolutely dominant all the odd non multiple modes and even modes are not triggered as examples the predicted time traces of the modal coordinates e 3 and e 15 in case a are shown in fig 12 then simulations are performed in case b as expected the internal flow velocity is too small to affect the odd multiple modes and the resultant rms displacement of the riser however it is noticed that owing to the single phase ife all the even modes and odd non multiple modes have also been trigged although the strain contributions are small compared to that of the dominant mode i e the fifth mode as examples the time histories of the modal coordinates e 2 and e 3 are shown in fig 13 a and b respectively finally simulations are carried out in case c the simulations in case c yield almost the same rms displacement with that in case a and case b same as the single phase ife in case b all the even modes and odd non multiple modes have been trigged distinguished from simulations in case b the combination of the slug flow frequency and the vibration frequencies produces an amplitude modulation response of all the excited modes this phenomenon is quite remarkable in the non multiple modes and the even modes as examples the time histories of the modal coordinate e 2 e 3 and e 15 in case c are depicted in fig 13 the beating behaviors have also been captured in the non multiple modes and the even modes as shown in fig 13 a and b it is worth noticing that although the internal fluid mass in case c is much less than that in case b the presence of beating response induced by the slug flow s intermittent feature can cause a great increase of the vibration amplitudes of the modal coordinates 5 conclusions and future study motived by the fact that the slug s flow s intermittent feature may cause additional vibrations this study devotes efforts to investigating sfe of a flexible marine riser experiencing viv based on the previously study in meng et al 2017b the main contributions of this study can be summarized as follows 1 a simulation model for analyzing the dynamical behaviour of a flexible riser which is exposed to an internal two phase slug flow and an external uniform current simultaneously has been developed a novel approach has been proposed to capture the two phase slug flow s intermittent feature which is validated by comparisons with experiments 2 it can be concluded that the sfe is much more profound than single phase ife on the viv responses of flexible marine risers owing to the intermittent feature although the internal fluid mass is reduced compared to the pipe conveying a single phase fluid it has demonstrated that when a flexible riser is subjected to the combined excitation of a internal two phase slug flow and an external current new natural modes can be triggered and the excited modes can exhibit an amplitude modulation response beating behaviors which correspond to the resonant synchronization phenomenon have also been captured therefore the sfe should be accounted for in fatigue analysis of a flexible marine riser conveying a two phase slug flow even if the slug flow velocity is small three dimensional study is required to discover the intrinsic coupled mechanisms of sfe on viv of flexible risers extensive simulations remains to be conducted in a wide slug flow regime combined with more external current conditions a scaled model experiment based on the present simulation model is going to be conducted in the circulation channel at shanghai jiao tong university the experimental observations together with the revised simulations will be presented in the next paper acknowledgement the authors gratefully acknowledge the supports of the national natural science foundation of china grant no 51879161 
