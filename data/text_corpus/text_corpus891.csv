index,text
4455,long term forecasting of any hydrologic phenomena is essential for strategic environmental planning hydrologic and other forms of structural design agriculture and water resources management climate mode indices utilising machine learning methods are frequently considered as predictor variables in order to forecast several different hydrological variables in this study a feature selection algorithm based on two different deep learning models i e long short term memory and a gated recurrent unit is applied to improve the forecasting capability of streamflow water levels at six gaugingstations in the murray darling basin of australia this paper therefore aggregates the significant antecedent lag memory of climate mode indices rainfall and the monthly factor based on the periodicity as the predictor variables to attain significantly accurate stream water level forecasts this novel method identifies an improved relationship between the stream water level and climate mode indices through the aggregation of the significant lagged datasets capturing the historical features to predict the future streamflow water level the boruta feature selection algorithm brf was then applied in a two phase process before and after attaining the significant lagged inputs to screen the optimum predictor variables the merits of the forecast models were evaluated through different performance evaluation criteria the results show that the accumulated significant lagged inputs based on climate mode indices along with the rainfall and periodicity factors are seen to provide improved forecasting of the swl over the non brf deep learning approaches where no prior feature selection was applied the hybrid lstm method i e brf lstm model achieved a unique advantage in terms of swl forecasting particularly attaining over 98 of the predictive errors lying within a band of 0 015 m with relatively low relative errors rrmse 1 30 and rmae 0 882 outperforming all of the benchmark models it is also found that the periodicity factor has a potential influence on the accuracy of the forecast models for the four monitored study stations this study concludes that the newly developed hybrid deep learning approaches coupled with the brf feature selection provide improved forecasting performance the hybrid approach developed in this paper can therefore be used to provide a strong provide predictive response algorithm for the hydrological variables that were influenced by the low frequency variability of the climate model indices in respect to streamflow water level keywords stream water level climate indices boruta random forest hybridizer algorithm brf significant lag memory murray darling basin and long short term memory lstm nomenclature acf autocorrelation function aez australian agro ecological zones ann artificial neural network ao arctic oscillation bom australian bureau of meteorology brf boruta random forest hybridizer algorithm brf lstm hybrid model integrating the boruta feature selection algorithm with lstm brf gru hybrid model integrating the boruta feature selection algorithm with gru brf rnn hybrid model integrating the boruta feature selection algorithm with rnn brf svr hybrid model integrating the boruta feature selection algorithm with svr ccf cross correction function cnn convolutional neural network cpc climate prediction centre csiro commonwealth scientific and industrial research organization dbn deep belief network dl deep learning dmi dipole model index ecdf empirical cumulative distribution function elm extreme learning machine emi el nino southern oscillation modoki index enso el niño southern oscillation epi east pole index fcm fuzzy c means fe forecasting error gru gated recurrent unit iod indian ocean dipole ipo interdecadal pacific oscillation knmi royal netherlands meteorological institute lasso least absolute shrinkage and selection operator lm legates mccabe s index lstm long short term memory mae mean absolute error mape mean absolute percentage error mdb murray darling basin mlp multi layer perceptron mse mean squared error nao north atlantic oscillation noaa national oceanic and atmospheric administration nse nash sutcliffe efficiency nsw new south wales pacf partial autocorrelation function pdo pacific decadal oscillation qld queensland r correlation coefficient rmse root mean square error rnn recurrent neural network rrmse relative root mean square error sd standard deviation sam southern annular mode silo scientific information for landowners soi southern oscillation index sst sea surface temperature str subtropical ridge svr support vector regression swl stream water level tpi tri pole index wi willmott s index of agreement wpi west pole index 1 introduction forecasting streamflow as a driver of the hydro climatic variable is of high importance in strategic planning and redistributing of water resources as well as mitigating the impacts associated with climate extreme long term forecasting of streamflow is essential for the management of water floods and drought and agricultural planning and management activities yaseen et al 2018 however accurate forecasting of streamflow is challenging because of its complex relationships with hydro meteorological variables chu et al 2020 and inherent randomness in behaviour ahani et al 2018 besides the different ranges high medium and low of streamflow are related to different dynamical properties and hydrological processes therefore very few single data driven models to forecast the streamflow of different ranges can capture the characteristics of streamflow adequately a multi model deep learning approach can be implemented to mitigate the challenges associated with streamflow forecasting and simulations streamflow a prime component of the hydrological cycle is widely affected by climate and land cover changes abera et al 2019 alaoui et al 2014 climate change indirectly influences streamflow through changes in e g precipitation temperature and evaporation guo et al 2020 understanding the hydrological consequences is key to managing climate change impacts and determining effective measures for designing mitigation and adaptation options the primary indicators of stream water level i e evaporation and rainfall are highly variable verdon and franks 2005 over time and space resulting in inter annual variabilities of streamflow deo and sahin 2016 mcmahon et al 1992 which causes challenges in the management of irrigation marine life and ecosystems chiew et al 1998 in australia the significant modes of the pacific and indian oceans extended the precipitation anomalies rogers and beringer 2017 tozer et al 2017 mark the long term drought rashid et al 2020 van dijk et al 2013 and flood deo et al 2015 with the adaptation of climate telecommunications driven by climate indices and sea surface temperature sst moreover the reflection by the anomalies in streamflow is inherently linked to the oceanic atmosphere process drosdowsky 1993 kiem and franks 2004 and the pacific decadal oscillation pdo which is an indian ocean dipole iod indices saji et al 1999 thus developing a robust and reliable expert system for real time streamflow forecasting driven by climate indices is an evolving area of interest in australia various synoptic scale climate indices have been acknowledged as a suitable approach to climate variability based on the locations and seasons nguyen huy et al 2017 schepen et al 2012 the impact of iod and the subtropical ridge on australian rainfall variability are well recognised cai and cowan 2009 kirono et al 2010 murphy and timbal 2008 the la niña events are responsible for significant precipitation in eastern australia whereas the el niño events are related to high scale drought situations yuan and yamagata 2015 in the north and east of australia the el niño southern oscillation enso phenomenon greatly influences precipitation with regional differences risbey et al 2009 however for southern australia iod shows a superior impact than enso during winter and spring rainfall due to the robust covariation between enso and the iod cai et al 2011 the enso hydroclimate relates to below normal streamflow for el niño and above regular for la niño events deo and sahin 2016 which indicates that sst associated climate indices have robust potential in forecasting streamflow water level in australia given the significant impact that the enso cycle possesses on the hydro climatology of australia a couple of relevant studies nguyen huy et al 2017 royce et al 2011 shuai et al 2013 have explored the relationship between hydrological variables i e streamflow rainfall and droughts of several rivers in the country nguyen huy et al 2017 applied the vine copula approach in the australian agro ecological zones aezs to forecast the precipitation influenced by the enso and the interdecadal pacific oscillation ipo however power et al 1999 demonstrate no significant association between enso and interannual climate variability during the impact of ipo precipitation and river flows were identified as unfavourable moreover risbey et al 2009 have identified the variability of precipitation of australian catchments based on the relationships between synoptic scale climate indices and rainfall the lagged values of climate indices have been widely applied to forecast future rainfall chiew et al 1998 nguyen huy et al 2017 stone et al 1996 taschetto and england 2009 and streamflow deo and sahin 2016 in australia however some of the studies admit that the relationship between lagged climate indices does not always lead to a substantial correlation schepen et al 2012 besides a solo predictor may hamper forecasting capability as the relationships between precipitation and climate indices are comparatively elaborate rasel et al 2016 wang and hendon 2007 the influence of different climate indices on precipitation fluctuates based on geographic diversity ahmed et al 2021a chowdhury and beecham 2010 deo et al 2017b on the other hand the impact on streamflow is influenced by interannual variability of river flows mcmahon et al 1992 and australia and southern africa has the highest rainfall and streamflow variability than anywhere else in the world finlayson and mcmahon 1991 mcmahon et al 1992 adaptation of a data driven model to capture the future streamflow scenario based on different synoptic scale climate indices is a potential option for the river and drought management sustainably presently there are considerable varieties of models available for streamflow forecasting researchers often categorised them between physical and data driven models di et al 2014 physical models are used for depicting the movement and storage of water in watersheds romagnoli et al 2017 sommerlot et al 2016 moreover in the hydrology area the physical models are considered a gold standard that helps understand the physical mechanisms and river flow dynamics li et al 2014 besides the precision of forecasting by a physical model depends on the physics of the model the initial condition of catchments and the spatial and temporal resolution of predictors and predictand variables sun et al 2012 however the hydrologists must have expertise and experience in the model noori and kalin 2016 yin et al 2014 these factors mentioned above can limit the adaptability of a physical model even though they have considerable advantages in addressing hydrological forecasting characteristics moreover the nonlinearities arising between the hydrological variables and water flows from hydro physical interactions at large scales can also obscure the forecasting skill making the model more tedious for forecasting alternatively data driven models are intended to identify the correlation between the predictors and predictand variables without contemplating the core procedures of hydrological systems kisi 2015 yaseen et al 2016 hence the mathematical complexity of the physical model is reduced while the data driven models are used which use partial differential equations coupled with several initial conditions different data driven models have been used to predict in forecasting hydro metrological variable like precipitation akbari asanjan et al 2018 nguyen huy et al 2017 tripathi et al 2006 yang et al 2018 yoo and cho 2018 draught index deo and şahin 2015 rashid et al 2020 streamflow ahmed and shah 2017 chu et al 2020 damavandi et al 2019 deo and sahin 2016 ehteram et al 2019 khan and coulibaly 2006 prasad et al 2017 rainfall runoff alizadeh et al 2017 hu et al 2018 kratzert et al 2018 flood arto et al 2019 bui et al 2018 chen et al 2014 gizaw and gan 2016 le et al 2019 and water demand gedefaw et al 2018 in the previous decade various studies explored the application of multiple data intelligent models to forecast the stream water level and river flow significantly such as adaptive neuro fuzzy inference system ehteram et al 2019 support vector machine bafitlhile and li 2019 rasouli et al 2012 and artificial neural networks ahmed and shah 2017 bafitlhile and li 2019 and extreme learning machine deo and sahin 2016 lima et al 2016 nevertheless many studies executed standalone models e g ann svr elm mars that have specific drawbacks in simplification competencies by the occurrence of complex inputs s with stochastic features caused by highly interconnected climatic and hydrological factors to address the critical temporal and seasonal behaviour adamowski et al 2012 this standalone machine learning approaches create overfitting for large datasets zhang et al 2017 due to the complex and nonlinear relationships between the predictors addressing the restrictions associated with the standalone models deep learning dl has also been implemented li et al 2017 and found to generate superior accuracy in comparison hence the deep learning approaches have a potential prospect in forecasting stream water level deep learning dl models use multiple feature extraction layers and acquire the compound associations within the data efficiently ghimire et al 2019a these dl methods have been successfully utilised in medical imaging natural language processing and computer vision nevertheless only a few prior studies have been employed a dl model for hydrological forecasting explicitly using climate indices the deep learning algorithm exhibits excellent quality to extract data characteristics when processing large amounts of complex data with substantial computing power and complex mapping ability gong et al 2019 some relevance may be drawn from the recent study where deep learning methods such as long short term memory lstm have been introduced in the field of hydrology and water resources zhang et al 2018 as an established and practical predictive approach the lstm can resolve vanishing gradient issues by including three different gates ghimire et al 2019c performed lstm to predict the solar radiation to avoid the problems of overfitting the inputs and target variables and model attained a better generalisation outcome than standalone models e g ann a few studies were carried out based on the deep learning approaches i e lstm dbn to predict the hydrological variables i e precipitation runoffs and streamflow successfully chu et al 2020 hu et al 2018 kratzert et al 2018 le et al 2019 ramphul 2018 zhang et al 2018 hu et al 2018 used the lstm model for forecasting runoff discharges with excellent simulation the lstm model outperformed the conventional ann model capturing the data characteristics and its gate structure to overlook the previous features similarly bowes et al 2019 demonstrated that the long short term memory lstm networks are far better than the recurrent neural networks rnn to forecast the groundwater table of virginia to the best acquaintance of the authors no studies were carried out to model the streamflow water level using lstm however a hybrid approach was adopted by chu et al 2020 where they used a hybrid deep belief network dbn with the least absolute shrinkage and selection operator lasso and fuzzy c means fcm to forecast the streamflow of tennessee river catchment usa it is demonstrated that the lasso fcm dbn model provided more precise forecasting in comparison with the conventional models since lstm can extract the relevant extrapolative features from the historical data the hybridised lstm model is yet to be implemented in the mdb for forecasting streamflow levels impacted by climate indices the boruta feature selection algorithm brf is a wrapper algorithm developed by kursa et al 2010 the boruta random forest hybridizer algorithm brf was used and strongly recommended by different researchers around the globe christ et al 2016 prasad et al 2019 the algorithm is used to define significant input parameters using a comparison of the real features of the random probes utilization of boruta random forest hybridizer algorithm brf was observed in predicting soil moisture prasad et al 2019 and air quality lyu et al 2017 however this approach is yet to be implemented with the lstm model as a predictive model for streamflow water level therefore this study is proposed to incorporate boruta random forest hybridizer algorithm brf based feature extraction algorithm and lstm to forecast stream water level the cross correlation function and partial autocorrelation function would be utilized to select the significant decedent lag memories of predictors and target swl accordingly 1 1 study area and data six river basin stations from murray darling basin mdb the agricultural hub of australia were selected this basin covers almost 67 of agricultural land australian bureau of statistics 2010 which is 14 of the mainland of australia is considered as the most productive agricultural area of the country six selected stations are demonstrated in table 1 and fig 2 station 1 coggan is selected from the goulburn river catchment which has an extremely variable rainfall that has experienced an extended period of droughts csiro and meteorology 2015 the goulburn river is the largest branch of the hunter river contributing 23 of its flow abs 2014 the drainage area of the goulburn river at coggan has a drainage area of 3340 km2 coggan station is the adjoining station of mdb the 2nd station is at barham bridge on the murray river one of the longest rivers of murray darling basin with 43400 km2 of drainage area the area claims productive agriculture based on irrigation including rice citrus cereal crops walnuts and olives wee jasper station is located on the goodradigbee river a perennial river that is part of the murrumbidgee catchment inside the murray darling basin the drainage area of the watershed is 1165 km2 with a varied agricultural production including grape lachlan river the main tributary of the murrumbidgee river flows 30 miles upstream from cowra station 4 cowra experienced numerous flood events from 1870 to 2016 with a peak flow from 35ft to 52ft trueman 2011 namoi river at north cuerindi station 5 is the significant inflow upstream of keepit dam the catchment is diverse in climate and landscape fluctuating from cold high rainfall areas to semi arid low rainfall areas on extensive riverine plains in the west murray darling basin authority 2010 the sixth station is barwon river at brewarrina which was caused by the drought subsequently dripped through its hottest and driest year the catchment has the highest drainage area 297850 km2 among all six stations and an extensive australian dryland river system the monthly mean values of streamflow water level swl for six selected stations within australian murray darling basin is shown in fig 3 the key characteristics of the watersheds are climate variability low gradient and vast floodplain moreover while checking the quality of the stream water levels data sets between 2015 and 2019 the obtained missing values are replaced through the respective calendar average values inferred from the study period the missing values were from 1 2 to 5 of the total number of data observations for all the stations to demonstrate this study four types of data were collected and applied in the study streamflow water level swl rainfall periodicity and synoptic scale climate mode indices the monthly streamflow water level was obtained from the nsw department of primary industries data portal http realtimedata water nsw gov au water stm for six hydrological sites specified in table 2 rainfall data were collected from the scientific information for land owners silo portal jeffrey et al 2001 twelve climate indices and periodicity at a monthly t lag are acquired from different sources such as the national climate prediction centre bureau of meteorology australia bom 2020 and noaa physical science laboratory however the monthly sea surface temperature nino1 2sst nino3sst nino3 4sst nino4sst for january 1915 to december 2019 was downloaded from the knmi climate explorer database trouet and van oldenborgh 2013 the climate indices were selected based on the long term availability and applicability by different authors and understanding the impacts of climate stream flows relationships chu et al 2020 deo and sahin 2016 the significant connotation of the inter decadal pacific oscillation through the pacific ocean influences the enso phenomena which impact the drought events dai 2013 and can eventually affect the streamflow deo and sahin 2016 and precipitation dong and dai 2015 the soi impacts australian rainfall because of oscillation phases nguyen huy et al 2017 moreover the positive soi introduces la nina events whereas the negative soi launches el nino events adnan et al 2016 philander 1983 the correlated rainfall and lagged soi has been found feasible for the highest predictability of rainfall during august november chiew et al 1998 schepen et al 2012 hence the study utilizes the soi data to forecast the stream water level as an attempt to integrate the impacts of el nino and la nino events of swl into deep learning approaches furthermore four sea surface temperatures such as nino3sst nino3 4sst nino4sst and nino1 2 over the southeast indian ocean may correlate to heavy rainfall priya et al 2015 terray et al 2007 furthermore a comparatively new climate index interdecadal pacific oscillation ipo based tripole index tpi which is introduced by henley et al 2015 was collected from the noaa national climate prediction centre tpi is an sst based index for ipo consistent with indices used to track enso henley et al 2015 moreover the ipo shows a strong association with rainfall from victoria to queensland verdon and franks 2005 unlike soi ipo has an inverse relationship with precipitation as positive ipo launches lower rainfall power et al 1999 besides pal et al 2017 demonstrate that the southern annular mode sam pointedly impacts the monsoon rainfall anomaly the enso modoki index emi substantially affects the rainfall and temperature outlines around the globe due to the ocean atmosphere and the unique tri polar sea level pressure pattern ashok et al 2007 the combination of enso and dmi can successfully explain the rainfall anomalies cai et al 2011 the detailed information of the utilized climate indices and sst is tabulated in table 2 the influence of periodicity factor monthly is a way of demonstrating the aggregated lagged climate indices and time periods over the stream water level 1 1 1 long short term memory networks the long short term memory lstm is like the recurrent neural network rnn popularly used in the deep learning field likewise the rnn architecture lstm has a feedback connection with the layers which can establish the complete sequences of the inputs the description of lstm networks can be found different from researches britz 2015 chollet 2016 ghimire et al 2019c graves 2012 olah 2015 the lstm networks are introduced to solve the problems associated with conventional rnns sak et al 2014 the lstm networks are comprised of three layers i e an input layer one or more hidden layers and an output layer where the neuron number in the input layer is equivalent to the amount of feature space similarly the number of neurons in the output layer is equal to the output feature space the memory cell s contained in the hidden layer s has three gates adjusting its cell state st a forget gate ft an input gate it and an output gate ot the structure of a memory cell is illustrated in fig 1a for every time step t each of the three gates is presented with the input xt as well as the output ht 1 of the memory cells at the previous time step t 1 as a result of this the gates act as filters each fulfilling a different purpose 1 the forget gate derives which particular is detached from the cell state b the input gate specifies which information is supplemented to the cell state and c the output gate defines which data from the cell state is used as output during a forward pass of the lstm layer at every time step t the cell states st and output ht of the lstm layer at time step t is calculated as follows in the first step the lstm layer determines which information should be removed from its previous cell states st 1 therefore the activation values ft of the forget gates at time step t are computed based on the current input xt the outputs ht 1 of the memory cells at the previous time step t 1 and the bias terms bf of the forget gates the sigmoid function finally scales all activation values into the range between 0 completely forget and 1 completely remember 1 f t s i g m o i d w f x x t w f h x t 1 b f moreover the second step is determined by the lstm layer which information to be added to the network s cell states st this task includes two procedures first candidate values s t which could potentially be added to the cell states are computed second the activation values it of the input gates are calculated 2 s t t a n h w s x x t w s h h t 1 b s 3 i t s i g m o i d w i x x t w i h h t 1 b i in the third step the new cell states st are designed on the results of the previous steps with defining the hadamard product 4 s t f t o s t 1 i t o s t in the last step the output ht of the memory cells is derived as denoted in the following two equations 5 o t s i g m o i d w 0 x x t w 0 h h t 1 b 0 6 h t o t o t a n h s t when processing an input sequence its features are presented time step by time step to the lstm network at this moment the input at each time step t in our case one single standardised return is processed by the system as defined by the equations above when the last element of the sequence is processed the final output for the whole series is reimbursed fig 4 a shows the architecture of the lstm model 1 1 2 gated recurrent unit gru neural network the gated recurrent unit is a distinct type of lstm introduced by cho et al 2014 the performance of the gru during speech signal modelling was achieved to be identical to that of long short term memory the gru has a limited output gate and it has a shorter training time has fewer parameters than lstm wang et al 2018 the gru can achieve long short dependency falling into disappearing and ignition gradients which is like the lstm along with all the similarities there are some differences between gru and lstm for instance the lstm has three gates the input gate forget gate and output gate while the gru has only two the update gate and reset gate the update gate of gru can be replaced by the input and forget gate of the lstm as well the reset gate can straight to the formerly hidden state fig 4b shows the structure of the gated recurrent unit network in a gru network there are two input features at each time including the input vector x t and previous output vector h t 1 the output of each gate can be obtained through logical operation and nonlinear transformation of input the relationship between input and output can be described as follows 7 r t σ g w r x t u r h t 1 b r 8 z t σ g w z x t u z h t 1 b z 9 h t 1 z t o t 1 z t o h t 10 h t σ h w h x t u h r t o h t 1 b h where z t is the update gate vector r t is the reset gate vector w u and are parameter metrics and vector σg is a sigmoid function and σh is referred to as a hyperbolic tangent after constructing the gru network structure the training method is selected which includes backpropagation through time based on the previous studies the adam optimizer was adopted as it has improved performance ahmed et al 2021b ghimire et al 2019c workflow of implemented hybrid lstm and gru model is illustrated in fig 5 1 1 3 boruta feature selection algorithm brf the boruta algorithm is named after the god of the forest in slavic mythology it is a wrapper approach developed around the random forest algorithm breiman 2001 the algorithm is an extension of the idea introduced by stoppiglia et al 2003 to define significant input parameters using a comparison of the relevance of the real features to that of the random probes boruta calculates the z scores of every input predictor concerning the shadow attribute the essential factors of the predictors are determined by the distribution of z score metrics kursa et al 2010 a minimal optimal feature selection strategy was adopted by ranking and residual based on the boruta determined importance factors and then a stepwise model building was carried the boruta algorithm is outlined as the following steps kursa 2016 kursa and rudnicki 2010 produce a randomly ordered duplicated variable x t for particular input vector x v for adding randomness and eliminate the correlations between duplicate predictors and targets y t for a group of discrete inputs x t r n t and target variable y t r with several inputs n and t 1 2 t utilizing the random forest algorithm the target y t is forecasted with the duplicated inputs x t and actual inputs x t the variance importance measures i e permutation importance or mean decrease accuracy mda for each input x t and respective shadow input x t overall trees m tree 500 in this study as follows hur et al 2017 strobl et al 2008 11 mda 1 m tree m 1 m tree t o o b i y t f x t t o o b i y t f x t n o o b here i is the indicator function oob is derived as out of bag is the prediction error of each of the training samples based on bootstrap aggregation y t f x t are predicted values before permuting and y t f x t n is predicted values after permuting the z scores are calculated as 12 z s c o r e mda sd here sd is the standard deviation of accuracy losses and then calculate the maximum z score among shadow attributes mzsa following that the inputs z scores are compared with the corresponding shadows and evaluated using a variable importance distribution the inputs with z scores mzsa are tagged unimportant and permanently removed while inputs are having z scores mzsa are tagged confirmed the 0 40 value indicates the least to highest important predictors as illustrated in fig 6 b new duplicated inputs are produced and the algorithm stops when all input parameters are confirmed or the iteration threshold is touched during each iteration new shadows are created and the algorithm stops when all inputs are either confirmed or the iteration threshold maxruns i e 400 in this study is reached the unassigned inputs after reaching maxruns are classed as tentative and are either confirmed or rejected by comparing the respective median z scores with the median z scores of the best shadow input using a random forest wrapper mechanism boruta calculates the z scores relative to each predictor data s shadow attribute the distribution of metrics of the z score specifies the significant variables kursa et al 2010 by rating the outstanding predictors based on the essential factors decided by boruta a minimal optimal function selection approach was followed and then an incremental model development was carried out the feature selection algorithm would ideally test every possible subset of the input features and select the one that minimizes the model s error rate however this is an exhaustive search and is not computationally feasible for any extensive data set as the number of subsets is exponential the z score is computed in random forest by dividing the average accuracy loss by its standard deviation it is used as the important measure for all the variables the boruta package runs random forest on both original and random attributes and compute the importance of all variables since the whole process is dependent on permuted copies we repeat a random permutation procedure to get statistically robust results 1 2 model implementation procedure to achieve a robust deep learning model i e lstm and gru for forecasting the streamflow water level a prime job was to optimize the architecture of the objective model to employ the relationship between the predictors and model a multi phase brf lstm and brf gru model is implemented in the deep learning frameworks using python interface tensorflow and keras to investigate the experimental consequences of the forecasting models nine statistical metrics are utilized as described in section 3 2 the objective model is developed under intel i7 3 6 ghz and 16 gb memory computer algorithms for the proposed models were demonstrated using the freely available libraries based on deep learning such as keras brownlee 2016 ketkar 2017 and tensorflow abadi et al 2016 keras is a deep learning api successively works on top of tensorflow a competent machine learning platform of python keras is a highly productive interface that mainly focuses on contemporary deep learning approaches moreover the software platform such as r is used for the boruta feature selection algorithm brf however packages like matplotlib barrett et al 2005 and seaborn waskom et al 2020 are used to visualise the forecasted swl there is no specific formula to determine the valid predictors of the model tiwari and adamowski 2013 however the literature outlines three input selection methods for selecting the time series of lagged memories of swl and predictors for an optimum model these are trial and error acf and pacf and cross correlation function ccf approach for this study significant antecedent behaviour in terms of the lag of swl from the predictors using pacf tiwari and adamowski 2013 tiwari and chatterjee 2011 fig 7 demonstrates the pacf for of swl time series showing the antecedent behaviour in terms of the lag of swl it is clear from the figure that antecedent monthly delays are found significant generally the selection of the input signal pattern by the antecedent lag of the predictors is made by the cross correlation function adamowski et al 2012 the cross correlation function calculated the statistical alikeness between the predictors and the target variable fig 8 shows the cross correlation function between the predictors and swl for the station north cuerindi afterward a set of significant input combinations were determined by assessing rcross of each predictor with swl in this plot a 95 confidence level of the statistically significant rcross is shown in the blue line it is found from the figure the correlation of p data with swl was found as highest for all stations at lag zero rcross 0 22 0 75 considering climate indices emi and nino3 4 showed significant rcross from 0 219 to 0 301 and 0 204 to 0 284 accordingly likewise nino4 tpi and sam were found significant ranging from 0 20 to 0 30 however climate indices such as nao dmi and ao were not found significant with swl for increasing the diversity of the predictors some insignificant lags of the predictors such as periodicity pdo and nino3 are also considered for all other stations the ccf of swl with the predictors varied significantly however the lag selection strategy from the cross correlation function remains the same as north cuerindi the predictors used in this study are climate mode indices rainfall and periodicity factor month to forecast the swl of the rivers of murry darling basin the predictor data sets are normalized ahmed 2017 ali et al 2019 between 0 and 1 to minimize the overestimation of one variable to another 13 α norm α α min α max α min in eq 13 α is the respective predictors α min is the minimum value for the predictors α max is the maximum value of the data and α norm is the normalised value of the data after normalizing the predictor variables the data sets are partitioned 70 of the data sets as training 15 of the data as testing and the rest of the 15 of the data sets are used for validation following the proposed lstm and gru model a 4 layer hybrid lstm and 3 layered gru have been designed the theoretical descriptions have been explained in section 2 the hyperparameters and optimum architecture of the lstm gru rnn and svr model used in this study are provided in table 3 the conventional models used the traditional antecedent lagged matrix of the monthly climate mode indices rainfall and periodicity factor before applying ccf and pacf the boruta feature selection algorithm was used to remove the insignificant predictors of the model for the hybrid model boruta was applied to select the useful features from the decedent lag of the predictors boruta computes the z scores to govern the importance of the individual predictors as shown in fig 6 for example based on potential predictors obtained after the application of boruta the objective models and benchmark models were used to get the performance of boruta optimized hybrid models i e brf lstm brf gru brf rnn and brf svr 1 3 model evaluation benchmarks for an insightful forecasting assessment of the proposed model the present study adopted a wide range of models score metrics such as the pearson s correlation coefficient r root means square error rmse m mean absolute error mae m nash sutcliffe efficiency nse willmott s index agreement wi and legates mccabe s lm krause et al 2005 legates and davis 1997 legates and mccabe 1999 2013 nash and sutcliffe 1970 willmott et al 1985 2012 willmott and matsuura 2005 due to the geographic alterations of the model the percentage error measures relative error values such as rrmse rmae and mape were considered the competence of the model depends mostly on the connection between forecasted and observed values but frequently these criteria are based on model objectives and projects owing to the inherent merits and weaknesses of the metrics a combination of them is prudent sharma et al 2019 different sets of model evaluation metrics such as rmse mae and r2 coefficient of determination chu et al 2020 nse rmse mae and pers persistence index tiwari and chatterjee 2010 legates mccabe s index lm willmott s index wi rrmse rmae ali et al 2019 ghimire et al 2019b yaseen et al 2019 were selected for evaluating the model with numerous sets of variables the correlation of coefficient r provides information about the linear association between forecasted and observed swl data therefore it is limited in its capacity however r is considered oversensitive to extreme values willmott et al 1985 moreover the rmse and mae can provide appropriate information regarding the forecasting skill whereby rmse evaluates the robustness of the model related to high values but mae focuses on the deviation of the forecasted value from the observed deo et al 2017a besides willmott and matsuura 2005 revealed that mae is a better indicator of model performance over rmse whereas legates and mccabe 1999 conclude that the rmse can be more sensitive over other performance metrics on the other hand maes are not a perfect replacement for rmses chai and draxler 2014 the mathematical notations of the statistical metrics are mentioned in the appendix nse is a widely used model evaluation criteria for the hydrological model nse is a dimensionless metric and a scaled version of mse offering a better physical interpretation legates and mccabe 2013 however nse overemphasizes the higher values of outliers and lower values are neglected legates and mccabe 1999 due to the standardisation of the observed and predicted means and variance the robustness of r is limited wi was utilised to address this issue by considering the mean squared error ratio instead of the differences lm is a more advanced and powerful metric than both wi and nse which utilises the adjustment of comparison in wi and nse evaluation lm can be relatively robust in evaluating the results by addressing the weaknesses of r and using wi and nse as baseline adjusted indices together with an evaluation of rmse and mae 2 results this section provides results for an extensive evaluation of the proposed hybrid brf lstm brf gru brf rnn and brf svr models against standalone lstm gru rnn and svr the assessment is conducted after forecasting the stream water level swl at six hydrological sites the significant features of the predictor variables were achieved by incorporating the boruta feature selection algorithm brf a group of activation functions optimizers and hidden layer units were utilized to optimize the objective models that produced the lowest rmse mae and correlation coefficient r during the validation period to screen the optimum models the models were assessed using the testing dataset based on ten statistical metrics and visual plots the reasoning of the forecasted results the best model was picked according to the highest nse r lm and wi values and the lowest rmse mse rrmse rmae and mape values the assessment of the robustness of the brf integrated lstm gru rnn and svr model along with their respective standalone models are provided in table 4 in terms of statistical metrics in forecasting the swl three stations station 1 coggan station 2 barham and station 5 north cuerindi recorded the supreme r value from brf lstm models while one station station 6 brewarrina showed the highest value reported by brf gru models stimulatingly wee jasper recorded the same magnitude r 0 996 from both brf lstm and brf gru models subsequently the lowest rmse and mae values were attained by the hybrid brf lstm model at two sites station 1 coggan station 5 north cuerindi and the north cuerindi station station 5 displayed the lowest error metrics from the hybrid brf gru model therefore it was clear that the hybridized lstm models are superiors compared to other comparing models and their standalone counterparts however because of the vague consequences from the statistical metrics the choice to control the optimal model can be concealed in this regard visual plots to illustrate the time series plot of predicted and observed swl absolute forecasting error fe and scatter plots are provided to make a reliable decision table 4 provides the inclusive swl forecasting model boldface following statistical accuracy metrics eqs 17 24 for the proposed hybrid models i e brf lstm and brf gru the aggregated lagged values of climate indices rainfall and periodicity yielded very identical results for all stations lstm captured significant pearson s correlation coefficient r nash sutcliffe efficiency nse willmott s index wi and lowest root mean square error rmse and the mean absolute error mae the brf lstm model outperforms all the other developed models furthermore brf lstm for north cuerindi station has the best performance with a significant r 0 998 nse 0 993 wi 0 997 rmse 0 016 m and mae 0 014 m values however stations such as coggan barham and north cuerindi show identical performance with a fluctuation the lowest result for the brf lstm model was found for cowra stations with moderate performance when we compare the brf gru model results tabulated in table 4 for forecasting swl we attained the most accurate result for the brewarrina station in terms of five statistical parameters followed by the wee jasper station however among the rnn models the hybrid rnn model exhibits improved results compared with that of standalone rnn models the best brf rnn model was found for the barham station based on the statistical metrics besides svr and brf svr showed poor performance with weak statistical metrics therefore the improvement of the swl forecasting using the boruta feature selection algorithm was unsuccessful in the case of svr however the integration of brf was significant for the model like lstm gru and rnn it is evident from table 4 brf incorporated the lstm model showed 0 30 to 6 20 improvement while the brf gru model showed 0 2 to 2 0 improvement in terms of r value for forecasting swl moreover the rnn model is improved by 0 3 to 3 6 after the integration of brf for the best station of brf lstm the improvement percentage is 0 60 in terms of r values the proposed hybrid lstm was assessed based on rrmse and rmae for all tested models to analyse the robustness of the proposed model further fig 9 shows that the magnitude of rrmse and rmae for the objective model brf lstm for the six stations is significantly low which clarifies the potential merits of the proposed model rrmse values between 1 7 which is far better than the other associated benchmark models while the rmae value ranges from 0 88 to 2 7 the best rrmse 1 3 and rmae 0 88 were found for coggan followed by brewarrina some stations with brf gru showed excellent performance with moderate rrmse 1 9 to 10 5 and rmae 1 45 to 3 50 values the analysis revealed that the hybrid lstm model captures the future swl with higher accuracy to attain a further profound understanding of the proposed model fig 10 presents a comprehensive interpretation by illustrating the frequency distribution of the absolute forecasting error fe using all models for six stations of the murray darling basin mdb it is revealed from fig 10 that the brf lstm model except barham the other five stations provide significantly improved distribution with 98 forecasting error fe within first error brackets 0 fe 0 15 it was noteworthy that coggan and north cuerindi stations 85 of all forecasting yielded a considerably small error i e fe between 0 and 0 05 and the remaining 15 of simultaneously produced forecasting error between 0 05 and 0 10 when considered by the value of fe value for all stations and applied models the highest forecasted error was observed for brewarrina station with svr model 1 5 and the lowest forecasted error was found for all hybrid models 0 0 the acquired forecasted error was consistent with the standard deviation sd for six stations as shown in table 5 these statistics established the forecasting merits of the objective model i e brf lstm for different stations within the test dataset however a large amount of forecasted dataset with a comparatively relatively small magnitude of absolute forecasting errors demonstrated substantial forecasting skill of the proposed predictive model compared with standalone models using the taylor diagram taylor 2001 the proposed model performance analysis is an improved interpretation presented in fig 11 this primary perception of the diagram is to identify the closest forecasting model with the respective observed values in the two dimensional scale the taylor diagram shows that the output of brf lstm and brf gru models with antecedent climate indices and rainfall is much closer to the observation than other applied models the forecasted swl again clarifies the better applicability of the brf lstm model compared to the standalone lstm model for forecasting swl the performance of brf lstm model performance for coggan barham and north cuerindi outperformed other hybrid models achieving the nearest proximity concerning the observed values however the proximity of observed swl for barham and brewarrina is closest to the brf gru model comparatively the time series plot is used to understand forecasting ability and improve the proposed model from standalone to the hybrid model fig 12 demonstrates the time series plot of forecasted and observed swl fig 15a shows the forecasted and observed swl of the coggan station using brf lstm brf gru and their respective standalone models i e lstm and gru results show that the proposed brf lstm model is found very close to the observed swl revealed a high predictive accuracy of the model the improvement of forecasted swl after applying the boruta feature selection algorithm brf is evident for other stations using the brf lstm model the forecasted swl is found accurate compared to brf gru and other comparing models to reinforce the influence of the better performance of the proposed deep learning hybrid and their standalone counterpart models tested at each station fig 13 establishes the robustness of brf lstm a higher frequency of the relative forecasting error fe value ought to be closer to zero per cent for a better forecast model the performance of the proposed models i e brf lstm brf gru in terms of the relative fe is improved compared to the standalone lstm and gru models the plots provide monthly relative fe over the average monthly period from january to december in the testing period generated by the proposed brf lstm vs comparative models for swl forecasting the radial axis from origin denotes the magnitude of the fe calculated from the averaged time series brf lstm generates the lowest relative fe 0 2 for all stations followed by the brf gru model with reasonable accuracy 0 6 application of boruta feature selection algorithm with inputs of all stations improved the swl forecasting from 4 2 for all stations even for the gru model the hybrid approach improved the performances in a high skill demonstrating the merits of brf lstm model to forecast the future swl the hybrid deep learning model i e brf lstm agreed for the swl forecasting model is undoubtedly apparent in terms of accuracy as a cross validation metric the lm index 0 lm 1 0 can have an advantage over wi when high values are expected comparatively ali et al 2019 adapting the lm legates and mccabe 1999 is an ideal option as outliers may lead to a higher value for wi willmott et al 1985 fig 14 exhibits a 3d plot of legates and mccabe s index lm for the hybrid deep learning approach i e brf lstm vs other competing models i e brf gru brf rnn and brf svr and standalone lstm gru rnn and svr model for the selected six stations the lm index accumulated across these stations brf lstm shows a dramatically superior result for the proposed hybrid deep learning model the amount of lm for the stations in murray darling basin of australia clarifies the significant utilisation of hybrid deep learning models to predict the stream water level swl fig 14 demonstrates that the maximum value of lm with brf lstm was found for coggan station lm 0 946 and the worst value of lm was identified for cowra station lm 0 910 the range of lm value 0 910 to 0 046 clarifies that the brf lstm model outperforms other models including brf gru moreover in comparison with lm for brf gru model three stations i e barham wee jasper and north cuerindi provided convincing lm value ranges from 0 902 to 0 933 it is also mentionable that among the standalone models lstm gru rnn and svr a lower lm value is compared with the hybrid brf lstm and brf gru model thus combining the boruta feature selection algorithm with significant lags with the lstm model increases the forecasting performance of swl for murray darling basin finally to support the influences of better performance of the proposed brf lstm model at each mdb station the mean absolute percentage error mape was considered fig 15 by close observation of mape for the testing period it is evident that the best model is brf lstm found for the coggan station with the least mape value 0 884 the worst performance was achieved for barham with the svr model the brf lstm model provides the least mape value than competing models brf gru brf rnn and brf svr and standalone models i e lstm gru rnn and svr notably the results revealed that all mdb sites were precise in terms of the metrics attained however the training and validation performance of the proposed model is crucial to confirm the overall performance of the incorporated model table 6 depicts the training and validation performance of the hybrid deep learning model for all mdb sites with the coefficient of determination r2 mae and rmse it is shown that the model is adequate with the closest to unity which in pairs m r2 the hybrid brf lstm model provides the best training performance with r2 from 0 995 to 0 997 mae from 0 011 to 0 039 and rmse from 0 019 to 0 077 and validation performance with r2 from 0 993 to 0 996 mae from 0 015 to 0 060 and rmse from 0 024 to 0 074 the performance indicates that the network is not over or undertrained the performance is further tested by randomly selecting training validation and testing array demonstrating almost the same performance based on the results we note the effects of climate indices on swl as non negligible brf was used to examine significant features from predictors related to swl in data driven modelling selecting predictor variables is crucial as improper variables with weak relationships against swl can lead to undesirable uncertainties in the model the objective approach based on brf yielded good accuracy demonstrating that the best predictors were attained through a feature selection stage by brf and feature extraction stage by cnn our study suggests that nino4 0 nino3 4 nino3 emi and tpi which are found as essential factors to concentrate swl can be ideal variables to understand swl characteristics 3 discussion a better understanding of the future state of any river system through accurate predictive modelling and physical interpretation of such results is critical to the management of water quality and the availability of palatable water for many practical applications in particular the forecasting of the hydrological state of any river system is considered to be a significant step required to better comprehend the potential changes in stream flows which is also a critical element for the generation of hydropower sustainable water use and improved agricultural practices or reducing the potential risk of flooding yaseen et al 2018 these tasks have largely been accomplished through significant research aiming to develop statistical physical and more recently the dependable deep learning predictive methods to help policymakers in their day to day decision making the current research advances this overall objective by integrating a time varying predictive method i e lstm and gru models with the bortua feature selection algorithm for improved performance accuracy by employing the boruta coupled deep learning models for optimal feature extraction the study was capable of predicting stream water levels to an acceptable degree of testing accuracy the results achieved have demonstrated that the boruta feature selection algorithm is a strong potential tool that can identify the significant features within the predictor variable s as required to model the hydrological state of a river system this notion is consistent with the quality of the hydrological datasets that could potentially influence the predictive merits of any hydrological model yaseen et al 2018 in spite of the requirement to acquire the most suitable variable s to successfully predict a given target variable the acquisition of good quality hydrological variables in both physical and data driven models remain a matter of concern however the provision to adopt a selection of universally acceptable climate indices that is able to derive hydro meteorological teleconnections can be a promising approach to model a given hydrological target variable our study has utilised this preposition by adopting the boruta feature selection method to carefully screen the most optimal climate indices including an appropriate antecedent lagged value of these predictor variables to model the stream water levels the performance metrics demonstrating the usefulness of the brf algorithm in identifying the cause and effect relationships between climate indices and streamflow support the proposed method as a suitable tool for best feature selection this was evident in the results suggesting that the brf optimized models have a better performance than the non brf standalone models in predicting streamflow water levels like any other research the present study has some limitations that could set a new pathway for further investigations in future in this research we have used ground based hydro meteorological variables and climate indices to predict streamflow water levels however it is acknowledged that point based data which are perhaps not so granular or of high resolution over all study regions may restrict the broader applicability if the predictive model if it is used for practical purposes such as a small farm or agricultural region yaseen et al 2018 to address this limitation a group of climate indices most suitable for that region after a careful selection of these variables can be used to capture the overall features of streamflow water level especially for remote locations with particular reference to australia the synoptic scale climate indices have been long been recognised as a potential predictor of climate variability although this can be based on the specific location and the season nguyen huy et al 2017 it is well known that the enso based hydroclimate is linked to the below normal streamflow in el niño and the above normal streamflow in la niño events deo and sahin 2016 this indicates that the sst associated climate indices have a robust capability to inform the predictive features required in forecasting streamflow water levels especially in australia the present study demonstrates that along with rainfall and the periodicity or monthly factor the antecedent values of large scale climate indices e g nino4 0 nino3 4 emi tpi and soi appear to strongly contribute towards the forecasting of streamflow water levels the performance of the models in this study also concur with those of previous research chu et al 2020 in this study it was noted that the incorporation of climate indices derived from the changes in sst improved the hybrid deep learning approaches developed for streamflow water level forecasting and this performance was better than the conventional machine learning models ahmed and shah 2017 prasad et al 2017 yaseen et al 2018 2019 considering the relatively high performance of the hybrid deep learning approaches developed in this study it is postulated that our forecasting methods could be explored further in respect to the modelling of different rivers in other regions that possess similar characteristics found in the predictor e g ground based satellite based or climate indices datasets 4 conclusion in this study monthly streamflow water level swl was forecasted at six aspirant river stations within murray darling basin to investigate the potentiality of aggregated significant antecedent climate indices precipitation and periodicity factor boruta feature selection algorithm is incorporated to obtain the crucial features of the predictor datasets in the study the optimization of boruta led to developing a deep hybrid learning brf lstm model to forecast the stream water level of mdb which was benchmarked by the brf gru brf rnn brf svr and standalone svr gru rnn an lstm model the findings have revealed improved merits of the proposed model for every station compared with other adopted models the concluding remarks of the study are as follows the proposed hybrid brf lstm model showed the best performance in forecasting stream water levels of six designated stations of murray darling basin the superior status of the brf lstm model is endorsed with low mae ranging from 0 012 m to 0 039 m and high nse value ranged from 0 983 to 0 997 it is also clear that the percentage increase in the r values ranging from 0 27 and 8 wi values ranging from 2 7 in comparison with their respective standalone models coggan station recorded the best hybrid brf lstm model with a 3 layered lstm with adam optimizer for forecasting the stream water levels precisely the brf lstm for coggan had the best performance considering statistical performances the scatterplot revealed that the merits of brf lstm for the coggan station are closest to unity which therefore advocates the applicability of newly designed hybrid lstm in real time applications based on the findings it is established that the lstm model with boruta extracted feature shows an inherent superior capability of forecasting stream water level swl for the rivers of mdb australia the antecedent values of the large scale climate indices rainfall and periodicity for the stations embedding the success of the deep learning approach for future forecasting the hybrid approach established in this study can forecast any hydrological system response which is influenced by the low frequency variability of climate indices therefore this type of forecast is applied for flood forecasting and irrigation scheduling for sustainable management of water resources credit authorship contribution statement a a masrur ahmed writing original draft conceptualization methodology software ravinesh c deo conceptualization writing review editing investigation supervision qi feng writing review editing afshin ghahramani conceptualization writing review editing nawin raj writing review editing zhenliang yin writing review editing linshan yang writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the authors would like to recognize the funding of the chinese academy of science cas and university of southern queensland usq to provide a usq cas postgraduate research scholarship 2019 2021 awarded to the first author which is managed by graduate research school of usq under the project leadership of professor feng qi cas and associate professor ravinesh deo usq appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2021 126350 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 supplementary data 2 
4455,long term forecasting of any hydrologic phenomena is essential for strategic environmental planning hydrologic and other forms of structural design agriculture and water resources management climate mode indices utilising machine learning methods are frequently considered as predictor variables in order to forecast several different hydrological variables in this study a feature selection algorithm based on two different deep learning models i e long short term memory and a gated recurrent unit is applied to improve the forecasting capability of streamflow water levels at six gaugingstations in the murray darling basin of australia this paper therefore aggregates the significant antecedent lag memory of climate mode indices rainfall and the monthly factor based on the periodicity as the predictor variables to attain significantly accurate stream water level forecasts this novel method identifies an improved relationship between the stream water level and climate mode indices through the aggregation of the significant lagged datasets capturing the historical features to predict the future streamflow water level the boruta feature selection algorithm brf was then applied in a two phase process before and after attaining the significant lagged inputs to screen the optimum predictor variables the merits of the forecast models were evaluated through different performance evaluation criteria the results show that the accumulated significant lagged inputs based on climate mode indices along with the rainfall and periodicity factors are seen to provide improved forecasting of the swl over the non brf deep learning approaches where no prior feature selection was applied the hybrid lstm method i e brf lstm model achieved a unique advantage in terms of swl forecasting particularly attaining over 98 of the predictive errors lying within a band of 0 015 m with relatively low relative errors rrmse 1 30 and rmae 0 882 outperforming all of the benchmark models it is also found that the periodicity factor has a potential influence on the accuracy of the forecast models for the four monitored study stations this study concludes that the newly developed hybrid deep learning approaches coupled with the brf feature selection provide improved forecasting performance the hybrid approach developed in this paper can therefore be used to provide a strong provide predictive response algorithm for the hydrological variables that were influenced by the low frequency variability of the climate model indices in respect to streamflow water level keywords stream water level climate indices boruta random forest hybridizer algorithm brf significant lag memory murray darling basin and long short term memory lstm nomenclature acf autocorrelation function aez australian agro ecological zones ann artificial neural network ao arctic oscillation bom australian bureau of meteorology brf boruta random forest hybridizer algorithm brf lstm hybrid model integrating the boruta feature selection algorithm with lstm brf gru hybrid model integrating the boruta feature selection algorithm with gru brf rnn hybrid model integrating the boruta feature selection algorithm with rnn brf svr hybrid model integrating the boruta feature selection algorithm with svr ccf cross correction function cnn convolutional neural network cpc climate prediction centre csiro commonwealth scientific and industrial research organization dbn deep belief network dl deep learning dmi dipole model index ecdf empirical cumulative distribution function elm extreme learning machine emi el nino southern oscillation modoki index enso el niño southern oscillation epi east pole index fcm fuzzy c means fe forecasting error gru gated recurrent unit iod indian ocean dipole ipo interdecadal pacific oscillation knmi royal netherlands meteorological institute lasso least absolute shrinkage and selection operator lm legates mccabe s index lstm long short term memory mae mean absolute error mape mean absolute percentage error mdb murray darling basin mlp multi layer perceptron mse mean squared error nao north atlantic oscillation noaa national oceanic and atmospheric administration nse nash sutcliffe efficiency nsw new south wales pacf partial autocorrelation function pdo pacific decadal oscillation qld queensland r correlation coefficient rmse root mean square error rnn recurrent neural network rrmse relative root mean square error sd standard deviation sam southern annular mode silo scientific information for landowners soi southern oscillation index sst sea surface temperature str subtropical ridge svr support vector regression swl stream water level tpi tri pole index wi willmott s index of agreement wpi west pole index 1 introduction forecasting streamflow as a driver of the hydro climatic variable is of high importance in strategic planning and redistributing of water resources as well as mitigating the impacts associated with climate extreme long term forecasting of streamflow is essential for the management of water floods and drought and agricultural planning and management activities yaseen et al 2018 however accurate forecasting of streamflow is challenging because of its complex relationships with hydro meteorological variables chu et al 2020 and inherent randomness in behaviour ahani et al 2018 besides the different ranges high medium and low of streamflow are related to different dynamical properties and hydrological processes therefore very few single data driven models to forecast the streamflow of different ranges can capture the characteristics of streamflow adequately a multi model deep learning approach can be implemented to mitigate the challenges associated with streamflow forecasting and simulations streamflow a prime component of the hydrological cycle is widely affected by climate and land cover changes abera et al 2019 alaoui et al 2014 climate change indirectly influences streamflow through changes in e g precipitation temperature and evaporation guo et al 2020 understanding the hydrological consequences is key to managing climate change impacts and determining effective measures for designing mitigation and adaptation options the primary indicators of stream water level i e evaporation and rainfall are highly variable verdon and franks 2005 over time and space resulting in inter annual variabilities of streamflow deo and sahin 2016 mcmahon et al 1992 which causes challenges in the management of irrigation marine life and ecosystems chiew et al 1998 in australia the significant modes of the pacific and indian oceans extended the precipitation anomalies rogers and beringer 2017 tozer et al 2017 mark the long term drought rashid et al 2020 van dijk et al 2013 and flood deo et al 2015 with the adaptation of climate telecommunications driven by climate indices and sea surface temperature sst moreover the reflection by the anomalies in streamflow is inherently linked to the oceanic atmosphere process drosdowsky 1993 kiem and franks 2004 and the pacific decadal oscillation pdo which is an indian ocean dipole iod indices saji et al 1999 thus developing a robust and reliable expert system for real time streamflow forecasting driven by climate indices is an evolving area of interest in australia various synoptic scale climate indices have been acknowledged as a suitable approach to climate variability based on the locations and seasons nguyen huy et al 2017 schepen et al 2012 the impact of iod and the subtropical ridge on australian rainfall variability are well recognised cai and cowan 2009 kirono et al 2010 murphy and timbal 2008 the la niña events are responsible for significant precipitation in eastern australia whereas the el niño events are related to high scale drought situations yuan and yamagata 2015 in the north and east of australia the el niño southern oscillation enso phenomenon greatly influences precipitation with regional differences risbey et al 2009 however for southern australia iod shows a superior impact than enso during winter and spring rainfall due to the robust covariation between enso and the iod cai et al 2011 the enso hydroclimate relates to below normal streamflow for el niño and above regular for la niño events deo and sahin 2016 which indicates that sst associated climate indices have robust potential in forecasting streamflow water level in australia given the significant impact that the enso cycle possesses on the hydro climatology of australia a couple of relevant studies nguyen huy et al 2017 royce et al 2011 shuai et al 2013 have explored the relationship between hydrological variables i e streamflow rainfall and droughts of several rivers in the country nguyen huy et al 2017 applied the vine copula approach in the australian agro ecological zones aezs to forecast the precipitation influenced by the enso and the interdecadal pacific oscillation ipo however power et al 1999 demonstrate no significant association between enso and interannual climate variability during the impact of ipo precipitation and river flows were identified as unfavourable moreover risbey et al 2009 have identified the variability of precipitation of australian catchments based on the relationships between synoptic scale climate indices and rainfall the lagged values of climate indices have been widely applied to forecast future rainfall chiew et al 1998 nguyen huy et al 2017 stone et al 1996 taschetto and england 2009 and streamflow deo and sahin 2016 in australia however some of the studies admit that the relationship between lagged climate indices does not always lead to a substantial correlation schepen et al 2012 besides a solo predictor may hamper forecasting capability as the relationships between precipitation and climate indices are comparatively elaborate rasel et al 2016 wang and hendon 2007 the influence of different climate indices on precipitation fluctuates based on geographic diversity ahmed et al 2021a chowdhury and beecham 2010 deo et al 2017b on the other hand the impact on streamflow is influenced by interannual variability of river flows mcmahon et al 1992 and australia and southern africa has the highest rainfall and streamflow variability than anywhere else in the world finlayson and mcmahon 1991 mcmahon et al 1992 adaptation of a data driven model to capture the future streamflow scenario based on different synoptic scale climate indices is a potential option for the river and drought management sustainably presently there are considerable varieties of models available for streamflow forecasting researchers often categorised them between physical and data driven models di et al 2014 physical models are used for depicting the movement and storage of water in watersheds romagnoli et al 2017 sommerlot et al 2016 moreover in the hydrology area the physical models are considered a gold standard that helps understand the physical mechanisms and river flow dynamics li et al 2014 besides the precision of forecasting by a physical model depends on the physics of the model the initial condition of catchments and the spatial and temporal resolution of predictors and predictand variables sun et al 2012 however the hydrologists must have expertise and experience in the model noori and kalin 2016 yin et al 2014 these factors mentioned above can limit the adaptability of a physical model even though they have considerable advantages in addressing hydrological forecasting characteristics moreover the nonlinearities arising between the hydrological variables and water flows from hydro physical interactions at large scales can also obscure the forecasting skill making the model more tedious for forecasting alternatively data driven models are intended to identify the correlation between the predictors and predictand variables without contemplating the core procedures of hydrological systems kisi 2015 yaseen et al 2016 hence the mathematical complexity of the physical model is reduced while the data driven models are used which use partial differential equations coupled with several initial conditions different data driven models have been used to predict in forecasting hydro metrological variable like precipitation akbari asanjan et al 2018 nguyen huy et al 2017 tripathi et al 2006 yang et al 2018 yoo and cho 2018 draught index deo and şahin 2015 rashid et al 2020 streamflow ahmed and shah 2017 chu et al 2020 damavandi et al 2019 deo and sahin 2016 ehteram et al 2019 khan and coulibaly 2006 prasad et al 2017 rainfall runoff alizadeh et al 2017 hu et al 2018 kratzert et al 2018 flood arto et al 2019 bui et al 2018 chen et al 2014 gizaw and gan 2016 le et al 2019 and water demand gedefaw et al 2018 in the previous decade various studies explored the application of multiple data intelligent models to forecast the stream water level and river flow significantly such as adaptive neuro fuzzy inference system ehteram et al 2019 support vector machine bafitlhile and li 2019 rasouli et al 2012 and artificial neural networks ahmed and shah 2017 bafitlhile and li 2019 and extreme learning machine deo and sahin 2016 lima et al 2016 nevertheless many studies executed standalone models e g ann svr elm mars that have specific drawbacks in simplification competencies by the occurrence of complex inputs s with stochastic features caused by highly interconnected climatic and hydrological factors to address the critical temporal and seasonal behaviour adamowski et al 2012 this standalone machine learning approaches create overfitting for large datasets zhang et al 2017 due to the complex and nonlinear relationships between the predictors addressing the restrictions associated with the standalone models deep learning dl has also been implemented li et al 2017 and found to generate superior accuracy in comparison hence the deep learning approaches have a potential prospect in forecasting stream water level deep learning dl models use multiple feature extraction layers and acquire the compound associations within the data efficiently ghimire et al 2019a these dl methods have been successfully utilised in medical imaging natural language processing and computer vision nevertheless only a few prior studies have been employed a dl model for hydrological forecasting explicitly using climate indices the deep learning algorithm exhibits excellent quality to extract data characteristics when processing large amounts of complex data with substantial computing power and complex mapping ability gong et al 2019 some relevance may be drawn from the recent study where deep learning methods such as long short term memory lstm have been introduced in the field of hydrology and water resources zhang et al 2018 as an established and practical predictive approach the lstm can resolve vanishing gradient issues by including three different gates ghimire et al 2019c performed lstm to predict the solar radiation to avoid the problems of overfitting the inputs and target variables and model attained a better generalisation outcome than standalone models e g ann a few studies were carried out based on the deep learning approaches i e lstm dbn to predict the hydrological variables i e precipitation runoffs and streamflow successfully chu et al 2020 hu et al 2018 kratzert et al 2018 le et al 2019 ramphul 2018 zhang et al 2018 hu et al 2018 used the lstm model for forecasting runoff discharges with excellent simulation the lstm model outperformed the conventional ann model capturing the data characteristics and its gate structure to overlook the previous features similarly bowes et al 2019 demonstrated that the long short term memory lstm networks are far better than the recurrent neural networks rnn to forecast the groundwater table of virginia to the best acquaintance of the authors no studies were carried out to model the streamflow water level using lstm however a hybrid approach was adopted by chu et al 2020 where they used a hybrid deep belief network dbn with the least absolute shrinkage and selection operator lasso and fuzzy c means fcm to forecast the streamflow of tennessee river catchment usa it is demonstrated that the lasso fcm dbn model provided more precise forecasting in comparison with the conventional models since lstm can extract the relevant extrapolative features from the historical data the hybridised lstm model is yet to be implemented in the mdb for forecasting streamflow levels impacted by climate indices the boruta feature selection algorithm brf is a wrapper algorithm developed by kursa et al 2010 the boruta random forest hybridizer algorithm brf was used and strongly recommended by different researchers around the globe christ et al 2016 prasad et al 2019 the algorithm is used to define significant input parameters using a comparison of the real features of the random probes utilization of boruta random forest hybridizer algorithm brf was observed in predicting soil moisture prasad et al 2019 and air quality lyu et al 2017 however this approach is yet to be implemented with the lstm model as a predictive model for streamflow water level therefore this study is proposed to incorporate boruta random forest hybridizer algorithm brf based feature extraction algorithm and lstm to forecast stream water level the cross correlation function and partial autocorrelation function would be utilized to select the significant decedent lag memories of predictors and target swl accordingly 1 1 study area and data six river basin stations from murray darling basin mdb the agricultural hub of australia were selected this basin covers almost 67 of agricultural land australian bureau of statistics 2010 which is 14 of the mainland of australia is considered as the most productive agricultural area of the country six selected stations are demonstrated in table 1 and fig 2 station 1 coggan is selected from the goulburn river catchment which has an extremely variable rainfall that has experienced an extended period of droughts csiro and meteorology 2015 the goulburn river is the largest branch of the hunter river contributing 23 of its flow abs 2014 the drainage area of the goulburn river at coggan has a drainage area of 3340 km2 coggan station is the adjoining station of mdb the 2nd station is at barham bridge on the murray river one of the longest rivers of murray darling basin with 43400 km2 of drainage area the area claims productive agriculture based on irrigation including rice citrus cereal crops walnuts and olives wee jasper station is located on the goodradigbee river a perennial river that is part of the murrumbidgee catchment inside the murray darling basin the drainage area of the watershed is 1165 km2 with a varied agricultural production including grape lachlan river the main tributary of the murrumbidgee river flows 30 miles upstream from cowra station 4 cowra experienced numerous flood events from 1870 to 2016 with a peak flow from 35ft to 52ft trueman 2011 namoi river at north cuerindi station 5 is the significant inflow upstream of keepit dam the catchment is diverse in climate and landscape fluctuating from cold high rainfall areas to semi arid low rainfall areas on extensive riverine plains in the west murray darling basin authority 2010 the sixth station is barwon river at brewarrina which was caused by the drought subsequently dripped through its hottest and driest year the catchment has the highest drainage area 297850 km2 among all six stations and an extensive australian dryland river system the monthly mean values of streamflow water level swl for six selected stations within australian murray darling basin is shown in fig 3 the key characteristics of the watersheds are climate variability low gradient and vast floodplain moreover while checking the quality of the stream water levels data sets between 2015 and 2019 the obtained missing values are replaced through the respective calendar average values inferred from the study period the missing values were from 1 2 to 5 of the total number of data observations for all the stations to demonstrate this study four types of data were collected and applied in the study streamflow water level swl rainfall periodicity and synoptic scale climate mode indices the monthly streamflow water level was obtained from the nsw department of primary industries data portal http realtimedata water nsw gov au water stm for six hydrological sites specified in table 2 rainfall data were collected from the scientific information for land owners silo portal jeffrey et al 2001 twelve climate indices and periodicity at a monthly t lag are acquired from different sources such as the national climate prediction centre bureau of meteorology australia bom 2020 and noaa physical science laboratory however the monthly sea surface temperature nino1 2sst nino3sst nino3 4sst nino4sst for january 1915 to december 2019 was downloaded from the knmi climate explorer database trouet and van oldenborgh 2013 the climate indices were selected based on the long term availability and applicability by different authors and understanding the impacts of climate stream flows relationships chu et al 2020 deo and sahin 2016 the significant connotation of the inter decadal pacific oscillation through the pacific ocean influences the enso phenomena which impact the drought events dai 2013 and can eventually affect the streamflow deo and sahin 2016 and precipitation dong and dai 2015 the soi impacts australian rainfall because of oscillation phases nguyen huy et al 2017 moreover the positive soi introduces la nina events whereas the negative soi launches el nino events adnan et al 2016 philander 1983 the correlated rainfall and lagged soi has been found feasible for the highest predictability of rainfall during august november chiew et al 1998 schepen et al 2012 hence the study utilizes the soi data to forecast the stream water level as an attempt to integrate the impacts of el nino and la nino events of swl into deep learning approaches furthermore four sea surface temperatures such as nino3sst nino3 4sst nino4sst and nino1 2 over the southeast indian ocean may correlate to heavy rainfall priya et al 2015 terray et al 2007 furthermore a comparatively new climate index interdecadal pacific oscillation ipo based tripole index tpi which is introduced by henley et al 2015 was collected from the noaa national climate prediction centre tpi is an sst based index for ipo consistent with indices used to track enso henley et al 2015 moreover the ipo shows a strong association with rainfall from victoria to queensland verdon and franks 2005 unlike soi ipo has an inverse relationship with precipitation as positive ipo launches lower rainfall power et al 1999 besides pal et al 2017 demonstrate that the southern annular mode sam pointedly impacts the monsoon rainfall anomaly the enso modoki index emi substantially affects the rainfall and temperature outlines around the globe due to the ocean atmosphere and the unique tri polar sea level pressure pattern ashok et al 2007 the combination of enso and dmi can successfully explain the rainfall anomalies cai et al 2011 the detailed information of the utilized climate indices and sst is tabulated in table 2 the influence of periodicity factor monthly is a way of demonstrating the aggregated lagged climate indices and time periods over the stream water level 1 1 1 long short term memory networks the long short term memory lstm is like the recurrent neural network rnn popularly used in the deep learning field likewise the rnn architecture lstm has a feedback connection with the layers which can establish the complete sequences of the inputs the description of lstm networks can be found different from researches britz 2015 chollet 2016 ghimire et al 2019c graves 2012 olah 2015 the lstm networks are introduced to solve the problems associated with conventional rnns sak et al 2014 the lstm networks are comprised of three layers i e an input layer one or more hidden layers and an output layer where the neuron number in the input layer is equivalent to the amount of feature space similarly the number of neurons in the output layer is equal to the output feature space the memory cell s contained in the hidden layer s has three gates adjusting its cell state st a forget gate ft an input gate it and an output gate ot the structure of a memory cell is illustrated in fig 1a for every time step t each of the three gates is presented with the input xt as well as the output ht 1 of the memory cells at the previous time step t 1 as a result of this the gates act as filters each fulfilling a different purpose 1 the forget gate derives which particular is detached from the cell state b the input gate specifies which information is supplemented to the cell state and c the output gate defines which data from the cell state is used as output during a forward pass of the lstm layer at every time step t the cell states st and output ht of the lstm layer at time step t is calculated as follows in the first step the lstm layer determines which information should be removed from its previous cell states st 1 therefore the activation values ft of the forget gates at time step t are computed based on the current input xt the outputs ht 1 of the memory cells at the previous time step t 1 and the bias terms bf of the forget gates the sigmoid function finally scales all activation values into the range between 0 completely forget and 1 completely remember 1 f t s i g m o i d w f x x t w f h x t 1 b f moreover the second step is determined by the lstm layer which information to be added to the network s cell states st this task includes two procedures first candidate values s t which could potentially be added to the cell states are computed second the activation values it of the input gates are calculated 2 s t t a n h w s x x t w s h h t 1 b s 3 i t s i g m o i d w i x x t w i h h t 1 b i in the third step the new cell states st are designed on the results of the previous steps with defining the hadamard product 4 s t f t o s t 1 i t o s t in the last step the output ht of the memory cells is derived as denoted in the following two equations 5 o t s i g m o i d w 0 x x t w 0 h h t 1 b 0 6 h t o t o t a n h s t when processing an input sequence its features are presented time step by time step to the lstm network at this moment the input at each time step t in our case one single standardised return is processed by the system as defined by the equations above when the last element of the sequence is processed the final output for the whole series is reimbursed fig 4 a shows the architecture of the lstm model 1 1 2 gated recurrent unit gru neural network the gated recurrent unit is a distinct type of lstm introduced by cho et al 2014 the performance of the gru during speech signal modelling was achieved to be identical to that of long short term memory the gru has a limited output gate and it has a shorter training time has fewer parameters than lstm wang et al 2018 the gru can achieve long short dependency falling into disappearing and ignition gradients which is like the lstm along with all the similarities there are some differences between gru and lstm for instance the lstm has three gates the input gate forget gate and output gate while the gru has only two the update gate and reset gate the update gate of gru can be replaced by the input and forget gate of the lstm as well the reset gate can straight to the formerly hidden state fig 4b shows the structure of the gated recurrent unit network in a gru network there are two input features at each time including the input vector x t and previous output vector h t 1 the output of each gate can be obtained through logical operation and nonlinear transformation of input the relationship between input and output can be described as follows 7 r t σ g w r x t u r h t 1 b r 8 z t σ g w z x t u z h t 1 b z 9 h t 1 z t o t 1 z t o h t 10 h t σ h w h x t u h r t o h t 1 b h where z t is the update gate vector r t is the reset gate vector w u and are parameter metrics and vector σg is a sigmoid function and σh is referred to as a hyperbolic tangent after constructing the gru network structure the training method is selected which includes backpropagation through time based on the previous studies the adam optimizer was adopted as it has improved performance ahmed et al 2021b ghimire et al 2019c workflow of implemented hybrid lstm and gru model is illustrated in fig 5 1 1 3 boruta feature selection algorithm brf the boruta algorithm is named after the god of the forest in slavic mythology it is a wrapper approach developed around the random forest algorithm breiman 2001 the algorithm is an extension of the idea introduced by stoppiglia et al 2003 to define significant input parameters using a comparison of the relevance of the real features to that of the random probes boruta calculates the z scores of every input predictor concerning the shadow attribute the essential factors of the predictors are determined by the distribution of z score metrics kursa et al 2010 a minimal optimal feature selection strategy was adopted by ranking and residual based on the boruta determined importance factors and then a stepwise model building was carried the boruta algorithm is outlined as the following steps kursa 2016 kursa and rudnicki 2010 produce a randomly ordered duplicated variable x t for particular input vector x v for adding randomness and eliminate the correlations between duplicate predictors and targets y t for a group of discrete inputs x t r n t and target variable y t r with several inputs n and t 1 2 t utilizing the random forest algorithm the target y t is forecasted with the duplicated inputs x t and actual inputs x t the variance importance measures i e permutation importance or mean decrease accuracy mda for each input x t and respective shadow input x t overall trees m tree 500 in this study as follows hur et al 2017 strobl et al 2008 11 mda 1 m tree m 1 m tree t o o b i y t f x t t o o b i y t f x t n o o b here i is the indicator function oob is derived as out of bag is the prediction error of each of the training samples based on bootstrap aggregation y t f x t are predicted values before permuting and y t f x t n is predicted values after permuting the z scores are calculated as 12 z s c o r e mda sd here sd is the standard deviation of accuracy losses and then calculate the maximum z score among shadow attributes mzsa following that the inputs z scores are compared with the corresponding shadows and evaluated using a variable importance distribution the inputs with z scores mzsa are tagged unimportant and permanently removed while inputs are having z scores mzsa are tagged confirmed the 0 40 value indicates the least to highest important predictors as illustrated in fig 6 b new duplicated inputs are produced and the algorithm stops when all input parameters are confirmed or the iteration threshold is touched during each iteration new shadows are created and the algorithm stops when all inputs are either confirmed or the iteration threshold maxruns i e 400 in this study is reached the unassigned inputs after reaching maxruns are classed as tentative and are either confirmed or rejected by comparing the respective median z scores with the median z scores of the best shadow input using a random forest wrapper mechanism boruta calculates the z scores relative to each predictor data s shadow attribute the distribution of metrics of the z score specifies the significant variables kursa et al 2010 by rating the outstanding predictors based on the essential factors decided by boruta a minimal optimal function selection approach was followed and then an incremental model development was carried out the feature selection algorithm would ideally test every possible subset of the input features and select the one that minimizes the model s error rate however this is an exhaustive search and is not computationally feasible for any extensive data set as the number of subsets is exponential the z score is computed in random forest by dividing the average accuracy loss by its standard deviation it is used as the important measure for all the variables the boruta package runs random forest on both original and random attributes and compute the importance of all variables since the whole process is dependent on permuted copies we repeat a random permutation procedure to get statistically robust results 1 2 model implementation procedure to achieve a robust deep learning model i e lstm and gru for forecasting the streamflow water level a prime job was to optimize the architecture of the objective model to employ the relationship between the predictors and model a multi phase brf lstm and brf gru model is implemented in the deep learning frameworks using python interface tensorflow and keras to investigate the experimental consequences of the forecasting models nine statistical metrics are utilized as described in section 3 2 the objective model is developed under intel i7 3 6 ghz and 16 gb memory computer algorithms for the proposed models were demonstrated using the freely available libraries based on deep learning such as keras brownlee 2016 ketkar 2017 and tensorflow abadi et al 2016 keras is a deep learning api successively works on top of tensorflow a competent machine learning platform of python keras is a highly productive interface that mainly focuses on contemporary deep learning approaches moreover the software platform such as r is used for the boruta feature selection algorithm brf however packages like matplotlib barrett et al 2005 and seaborn waskom et al 2020 are used to visualise the forecasted swl there is no specific formula to determine the valid predictors of the model tiwari and adamowski 2013 however the literature outlines three input selection methods for selecting the time series of lagged memories of swl and predictors for an optimum model these are trial and error acf and pacf and cross correlation function ccf approach for this study significant antecedent behaviour in terms of the lag of swl from the predictors using pacf tiwari and adamowski 2013 tiwari and chatterjee 2011 fig 7 demonstrates the pacf for of swl time series showing the antecedent behaviour in terms of the lag of swl it is clear from the figure that antecedent monthly delays are found significant generally the selection of the input signal pattern by the antecedent lag of the predictors is made by the cross correlation function adamowski et al 2012 the cross correlation function calculated the statistical alikeness between the predictors and the target variable fig 8 shows the cross correlation function between the predictors and swl for the station north cuerindi afterward a set of significant input combinations were determined by assessing rcross of each predictor with swl in this plot a 95 confidence level of the statistically significant rcross is shown in the blue line it is found from the figure the correlation of p data with swl was found as highest for all stations at lag zero rcross 0 22 0 75 considering climate indices emi and nino3 4 showed significant rcross from 0 219 to 0 301 and 0 204 to 0 284 accordingly likewise nino4 tpi and sam were found significant ranging from 0 20 to 0 30 however climate indices such as nao dmi and ao were not found significant with swl for increasing the diversity of the predictors some insignificant lags of the predictors such as periodicity pdo and nino3 are also considered for all other stations the ccf of swl with the predictors varied significantly however the lag selection strategy from the cross correlation function remains the same as north cuerindi the predictors used in this study are climate mode indices rainfall and periodicity factor month to forecast the swl of the rivers of murry darling basin the predictor data sets are normalized ahmed 2017 ali et al 2019 between 0 and 1 to minimize the overestimation of one variable to another 13 α norm α α min α max α min in eq 13 α is the respective predictors α min is the minimum value for the predictors α max is the maximum value of the data and α norm is the normalised value of the data after normalizing the predictor variables the data sets are partitioned 70 of the data sets as training 15 of the data as testing and the rest of the 15 of the data sets are used for validation following the proposed lstm and gru model a 4 layer hybrid lstm and 3 layered gru have been designed the theoretical descriptions have been explained in section 2 the hyperparameters and optimum architecture of the lstm gru rnn and svr model used in this study are provided in table 3 the conventional models used the traditional antecedent lagged matrix of the monthly climate mode indices rainfall and periodicity factor before applying ccf and pacf the boruta feature selection algorithm was used to remove the insignificant predictors of the model for the hybrid model boruta was applied to select the useful features from the decedent lag of the predictors boruta computes the z scores to govern the importance of the individual predictors as shown in fig 6 for example based on potential predictors obtained after the application of boruta the objective models and benchmark models were used to get the performance of boruta optimized hybrid models i e brf lstm brf gru brf rnn and brf svr 1 3 model evaluation benchmarks for an insightful forecasting assessment of the proposed model the present study adopted a wide range of models score metrics such as the pearson s correlation coefficient r root means square error rmse m mean absolute error mae m nash sutcliffe efficiency nse willmott s index agreement wi and legates mccabe s lm krause et al 2005 legates and davis 1997 legates and mccabe 1999 2013 nash and sutcliffe 1970 willmott et al 1985 2012 willmott and matsuura 2005 due to the geographic alterations of the model the percentage error measures relative error values such as rrmse rmae and mape were considered the competence of the model depends mostly on the connection between forecasted and observed values but frequently these criteria are based on model objectives and projects owing to the inherent merits and weaknesses of the metrics a combination of them is prudent sharma et al 2019 different sets of model evaluation metrics such as rmse mae and r2 coefficient of determination chu et al 2020 nse rmse mae and pers persistence index tiwari and chatterjee 2010 legates mccabe s index lm willmott s index wi rrmse rmae ali et al 2019 ghimire et al 2019b yaseen et al 2019 were selected for evaluating the model with numerous sets of variables the correlation of coefficient r provides information about the linear association between forecasted and observed swl data therefore it is limited in its capacity however r is considered oversensitive to extreme values willmott et al 1985 moreover the rmse and mae can provide appropriate information regarding the forecasting skill whereby rmse evaluates the robustness of the model related to high values but mae focuses on the deviation of the forecasted value from the observed deo et al 2017a besides willmott and matsuura 2005 revealed that mae is a better indicator of model performance over rmse whereas legates and mccabe 1999 conclude that the rmse can be more sensitive over other performance metrics on the other hand maes are not a perfect replacement for rmses chai and draxler 2014 the mathematical notations of the statistical metrics are mentioned in the appendix nse is a widely used model evaluation criteria for the hydrological model nse is a dimensionless metric and a scaled version of mse offering a better physical interpretation legates and mccabe 2013 however nse overemphasizes the higher values of outliers and lower values are neglected legates and mccabe 1999 due to the standardisation of the observed and predicted means and variance the robustness of r is limited wi was utilised to address this issue by considering the mean squared error ratio instead of the differences lm is a more advanced and powerful metric than both wi and nse which utilises the adjustment of comparison in wi and nse evaluation lm can be relatively robust in evaluating the results by addressing the weaknesses of r and using wi and nse as baseline adjusted indices together with an evaluation of rmse and mae 2 results this section provides results for an extensive evaluation of the proposed hybrid brf lstm brf gru brf rnn and brf svr models against standalone lstm gru rnn and svr the assessment is conducted after forecasting the stream water level swl at six hydrological sites the significant features of the predictor variables were achieved by incorporating the boruta feature selection algorithm brf a group of activation functions optimizers and hidden layer units were utilized to optimize the objective models that produced the lowest rmse mae and correlation coefficient r during the validation period to screen the optimum models the models were assessed using the testing dataset based on ten statistical metrics and visual plots the reasoning of the forecasted results the best model was picked according to the highest nse r lm and wi values and the lowest rmse mse rrmse rmae and mape values the assessment of the robustness of the brf integrated lstm gru rnn and svr model along with their respective standalone models are provided in table 4 in terms of statistical metrics in forecasting the swl three stations station 1 coggan station 2 barham and station 5 north cuerindi recorded the supreme r value from brf lstm models while one station station 6 brewarrina showed the highest value reported by brf gru models stimulatingly wee jasper recorded the same magnitude r 0 996 from both brf lstm and brf gru models subsequently the lowest rmse and mae values were attained by the hybrid brf lstm model at two sites station 1 coggan station 5 north cuerindi and the north cuerindi station station 5 displayed the lowest error metrics from the hybrid brf gru model therefore it was clear that the hybridized lstm models are superiors compared to other comparing models and their standalone counterparts however because of the vague consequences from the statistical metrics the choice to control the optimal model can be concealed in this regard visual plots to illustrate the time series plot of predicted and observed swl absolute forecasting error fe and scatter plots are provided to make a reliable decision table 4 provides the inclusive swl forecasting model boldface following statistical accuracy metrics eqs 17 24 for the proposed hybrid models i e brf lstm and brf gru the aggregated lagged values of climate indices rainfall and periodicity yielded very identical results for all stations lstm captured significant pearson s correlation coefficient r nash sutcliffe efficiency nse willmott s index wi and lowest root mean square error rmse and the mean absolute error mae the brf lstm model outperforms all the other developed models furthermore brf lstm for north cuerindi station has the best performance with a significant r 0 998 nse 0 993 wi 0 997 rmse 0 016 m and mae 0 014 m values however stations such as coggan barham and north cuerindi show identical performance with a fluctuation the lowest result for the brf lstm model was found for cowra stations with moderate performance when we compare the brf gru model results tabulated in table 4 for forecasting swl we attained the most accurate result for the brewarrina station in terms of five statistical parameters followed by the wee jasper station however among the rnn models the hybrid rnn model exhibits improved results compared with that of standalone rnn models the best brf rnn model was found for the barham station based on the statistical metrics besides svr and brf svr showed poor performance with weak statistical metrics therefore the improvement of the swl forecasting using the boruta feature selection algorithm was unsuccessful in the case of svr however the integration of brf was significant for the model like lstm gru and rnn it is evident from table 4 brf incorporated the lstm model showed 0 30 to 6 20 improvement while the brf gru model showed 0 2 to 2 0 improvement in terms of r value for forecasting swl moreover the rnn model is improved by 0 3 to 3 6 after the integration of brf for the best station of brf lstm the improvement percentage is 0 60 in terms of r values the proposed hybrid lstm was assessed based on rrmse and rmae for all tested models to analyse the robustness of the proposed model further fig 9 shows that the magnitude of rrmse and rmae for the objective model brf lstm for the six stations is significantly low which clarifies the potential merits of the proposed model rrmse values between 1 7 which is far better than the other associated benchmark models while the rmae value ranges from 0 88 to 2 7 the best rrmse 1 3 and rmae 0 88 were found for coggan followed by brewarrina some stations with brf gru showed excellent performance with moderate rrmse 1 9 to 10 5 and rmae 1 45 to 3 50 values the analysis revealed that the hybrid lstm model captures the future swl with higher accuracy to attain a further profound understanding of the proposed model fig 10 presents a comprehensive interpretation by illustrating the frequency distribution of the absolute forecasting error fe using all models for six stations of the murray darling basin mdb it is revealed from fig 10 that the brf lstm model except barham the other five stations provide significantly improved distribution with 98 forecasting error fe within first error brackets 0 fe 0 15 it was noteworthy that coggan and north cuerindi stations 85 of all forecasting yielded a considerably small error i e fe between 0 and 0 05 and the remaining 15 of simultaneously produced forecasting error between 0 05 and 0 10 when considered by the value of fe value for all stations and applied models the highest forecasted error was observed for brewarrina station with svr model 1 5 and the lowest forecasted error was found for all hybrid models 0 0 the acquired forecasted error was consistent with the standard deviation sd for six stations as shown in table 5 these statistics established the forecasting merits of the objective model i e brf lstm for different stations within the test dataset however a large amount of forecasted dataset with a comparatively relatively small magnitude of absolute forecasting errors demonstrated substantial forecasting skill of the proposed predictive model compared with standalone models using the taylor diagram taylor 2001 the proposed model performance analysis is an improved interpretation presented in fig 11 this primary perception of the diagram is to identify the closest forecasting model with the respective observed values in the two dimensional scale the taylor diagram shows that the output of brf lstm and brf gru models with antecedent climate indices and rainfall is much closer to the observation than other applied models the forecasted swl again clarifies the better applicability of the brf lstm model compared to the standalone lstm model for forecasting swl the performance of brf lstm model performance for coggan barham and north cuerindi outperformed other hybrid models achieving the nearest proximity concerning the observed values however the proximity of observed swl for barham and brewarrina is closest to the brf gru model comparatively the time series plot is used to understand forecasting ability and improve the proposed model from standalone to the hybrid model fig 12 demonstrates the time series plot of forecasted and observed swl fig 15a shows the forecasted and observed swl of the coggan station using brf lstm brf gru and their respective standalone models i e lstm and gru results show that the proposed brf lstm model is found very close to the observed swl revealed a high predictive accuracy of the model the improvement of forecasted swl after applying the boruta feature selection algorithm brf is evident for other stations using the brf lstm model the forecasted swl is found accurate compared to brf gru and other comparing models to reinforce the influence of the better performance of the proposed deep learning hybrid and their standalone counterpart models tested at each station fig 13 establishes the robustness of brf lstm a higher frequency of the relative forecasting error fe value ought to be closer to zero per cent for a better forecast model the performance of the proposed models i e brf lstm brf gru in terms of the relative fe is improved compared to the standalone lstm and gru models the plots provide monthly relative fe over the average monthly period from january to december in the testing period generated by the proposed brf lstm vs comparative models for swl forecasting the radial axis from origin denotes the magnitude of the fe calculated from the averaged time series brf lstm generates the lowest relative fe 0 2 for all stations followed by the brf gru model with reasonable accuracy 0 6 application of boruta feature selection algorithm with inputs of all stations improved the swl forecasting from 4 2 for all stations even for the gru model the hybrid approach improved the performances in a high skill demonstrating the merits of brf lstm model to forecast the future swl the hybrid deep learning model i e brf lstm agreed for the swl forecasting model is undoubtedly apparent in terms of accuracy as a cross validation metric the lm index 0 lm 1 0 can have an advantage over wi when high values are expected comparatively ali et al 2019 adapting the lm legates and mccabe 1999 is an ideal option as outliers may lead to a higher value for wi willmott et al 1985 fig 14 exhibits a 3d plot of legates and mccabe s index lm for the hybrid deep learning approach i e brf lstm vs other competing models i e brf gru brf rnn and brf svr and standalone lstm gru rnn and svr model for the selected six stations the lm index accumulated across these stations brf lstm shows a dramatically superior result for the proposed hybrid deep learning model the amount of lm for the stations in murray darling basin of australia clarifies the significant utilisation of hybrid deep learning models to predict the stream water level swl fig 14 demonstrates that the maximum value of lm with brf lstm was found for coggan station lm 0 946 and the worst value of lm was identified for cowra station lm 0 910 the range of lm value 0 910 to 0 046 clarifies that the brf lstm model outperforms other models including brf gru moreover in comparison with lm for brf gru model three stations i e barham wee jasper and north cuerindi provided convincing lm value ranges from 0 902 to 0 933 it is also mentionable that among the standalone models lstm gru rnn and svr a lower lm value is compared with the hybrid brf lstm and brf gru model thus combining the boruta feature selection algorithm with significant lags with the lstm model increases the forecasting performance of swl for murray darling basin finally to support the influences of better performance of the proposed brf lstm model at each mdb station the mean absolute percentage error mape was considered fig 15 by close observation of mape for the testing period it is evident that the best model is brf lstm found for the coggan station with the least mape value 0 884 the worst performance was achieved for barham with the svr model the brf lstm model provides the least mape value than competing models brf gru brf rnn and brf svr and standalone models i e lstm gru rnn and svr notably the results revealed that all mdb sites were precise in terms of the metrics attained however the training and validation performance of the proposed model is crucial to confirm the overall performance of the incorporated model table 6 depicts the training and validation performance of the hybrid deep learning model for all mdb sites with the coefficient of determination r2 mae and rmse it is shown that the model is adequate with the closest to unity which in pairs m r2 the hybrid brf lstm model provides the best training performance with r2 from 0 995 to 0 997 mae from 0 011 to 0 039 and rmse from 0 019 to 0 077 and validation performance with r2 from 0 993 to 0 996 mae from 0 015 to 0 060 and rmse from 0 024 to 0 074 the performance indicates that the network is not over or undertrained the performance is further tested by randomly selecting training validation and testing array demonstrating almost the same performance based on the results we note the effects of climate indices on swl as non negligible brf was used to examine significant features from predictors related to swl in data driven modelling selecting predictor variables is crucial as improper variables with weak relationships against swl can lead to undesirable uncertainties in the model the objective approach based on brf yielded good accuracy demonstrating that the best predictors were attained through a feature selection stage by brf and feature extraction stage by cnn our study suggests that nino4 0 nino3 4 nino3 emi and tpi which are found as essential factors to concentrate swl can be ideal variables to understand swl characteristics 3 discussion a better understanding of the future state of any river system through accurate predictive modelling and physical interpretation of such results is critical to the management of water quality and the availability of palatable water for many practical applications in particular the forecasting of the hydrological state of any river system is considered to be a significant step required to better comprehend the potential changes in stream flows which is also a critical element for the generation of hydropower sustainable water use and improved agricultural practices or reducing the potential risk of flooding yaseen et al 2018 these tasks have largely been accomplished through significant research aiming to develop statistical physical and more recently the dependable deep learning predictive methods to help policymakers in their day to day decision making the current research advances this overall objective by integrating a time varying predictive method i e lstm and gru models with the bortua feature selection algorithm for improved performance accuracy by employing the boruta coupled deep learning models for optimal feature extraction the study was capable of predicting stream water levels to an acceptable degree of testing accuracy the results achieved have demonstrated that the boruta feature selection algorithm is a strong potential tool that can identify the significant features within the predictor variable s as required to model the hydrological state of a river system this notion is consistent with the quality of the hydrological datasets that could potentially influence the predictive merits of any hydrological model yaseen et al 2018 in spite of the requirement to acquire the most suitable variable s to successfully predict a given target variable the acquisition of good quality hydrological variables in both physical and data driven models remain a matter of concern however the provision to adopt a selection of universally acceptable climate indices that is able to derive hydro meteorological teleconnections can be a promising approach to model a given hydrological target variable our study has utilised this preposition by adopting the boruta feature selection method to carefully screen the most optimal climate indices including an appropriate antecedent lagged value of these predictor variables to model the stream water levels the performance metrics demonstrating the usefulness of the brf algorithm in identifying the cause and effect relationships between climate indices and streamflow support the proposed method as a suitable tool for best feature selection this was evident in the results suggesting that the brf optimized models have a better performance than the non brf standalone models in predicting streamflow water levels like any other research the present study has some limitations that could set a new pathway for further investigations in future in this research we have used ground based hydro meteorological variables and climate indices to predict streamflow water levels however it is acknowledged that point based data which are perhaps not so granular or of high resolution over all study regions may restrict the broader applicability if the predictive model if it is used for practical purposes such as a small farm or agricultural region yaseen et al 2018 to address this limitation a group of climate indices most suitable for that region after a careful selection of these variables can be used to capture the overall features of streamflow water level especially for remote locations with particular reference to australia the synoptic scale climate indices have been long been recognised as a potential predictor of climate variability although this can be based on the specific location and the season nguyen huy et al 2017 it is well known that the enso based hydroclimate is linked to the below normal streamflow in el niño and the above normal streamflow in la niño events deo and sahin 2016 this indicates that the sst associated climate indices have a robust capability to inform the predictive features required in forecasting streamflow water levels especially in australia the present study demonstrates that along with rainfall and the periodicity or monthly factor the antecedent values of large scale climate indices e g nino4 0 nino3 4 emi tpi and soi appear to strongly contribute towards the forecasting of streamflow water levels the performance of the models in this study also concur with those of previous research chu et al 2020 in this study it was noted that the incorporation of climate indices derived from the changes in sst improved the hybrid deep learning approaches developed for streamflow water level forecasting and this performance was better than the conventional machine learning models ahmed and shah 2017 prasad et al 2017 yaseen et al 2018 2019 considering the relatively high performance of the hybrid deep learning approaches developed in this study it is postulated that our forecasting methods could be explored further in respect to the modelling of different rivers in other regions that possess similar characteristics found in the predictor e g ground based satellite based or climate indices datasets 4 conclusion in this study monthly streamflow water level swl was forecasted at six aspirant river stations within murray darling basin to investigate the potentiality of aggregated significant antecedent climate indices precipitation and periodicity factor boruta feature selection algorithm is incorporated to obtain the crucial features of the predictor datasets in the study the optimization of boruta led to developing a deep hybrid learning brf lstm model to forecast the stream water level of mdb which was benchmarked by the brf gru brf rnn brf svr and standalone svr gru rnn an lstm model the findings have revealed improved merits of the proposed model for every station compared with other adopted models the concluding remarks of the study are as follows the proposed hybrid brf lstm model showed the best performance in forecasting stream water levels of six designated stations of murray darling basin the superior status of the brf lstm model is endorsed with low mae ranging from 0 012 m to 0 039 m and high nse value ranged from 0 983 to 0 997 it is also clear that the percentage increase in the r values ranging from 0 27 and 8 wi values ranging from 2 7 in comparison with their respective standalone models coggan station recorded the best hybrid brf lstm model with a 3 layered lstm with adam optimizer for forecasting the stream water levels precisely the brf lstm for coggan had the best performance considering statistical performances the scatterplot revealed that the merits of brf lstm for the coggan station are closest to unity which therefore advocates the applicability of newly designed hybrid lstm in real time applications based on the findings it is established that the lstm model with boruta extracted feature shows an inherent superior capability of forecasting stream water level swl for the rivers of mdb australia the antecedent values of the large scale climate indices rainfall and periodicity for the stations embedding the success of the deep learning approach for future forecasting the hybrid approach established in this study can forecast any hydrological system response which is influenced by the low frequency variability of climate indices therefore this type of forecast is applied for flood forecasting and irrigation scheduling for sustainable management of water resources credit authorship contribution statement a a masrur ahmed writing original draft conceptualization methodology software ravinesh c deo conceptualization writing review editing investigation supervision qi feng writing review editing afshin ghahramani conceptualization writing review editing nawin raj writing review editing zhenliang yin writing review editing linshan yang writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the authors would like to recognize the funding of the chinese academy of science cas and university of southern queensland usq to provide a usq cas postgraduate research scholarship 2019 2021 awarded to the first author which is managed by graduate research school of usq under the project leadership of professor feng qi cas and associate professor ravinesh deo usq appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2021 126350 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 supplementary data 2 
4456,optimal operations of high dimensional hydropower systems hdhss with dozens or hundreds of plants face a serious challenge called curse of dimensionality because the computational time and storage memory grow exponentially with the plant number this study develops an efficient method to alleviate the dimensionality challenge a random sampling rs technique is exploited to select representative water level states at each period by considering discrepant weights for different solution ranges the rs can dynamically adjust sampling size and times with the selected samples moreover acceptability and reliability parameters are introduced into the rs optimization to ensure a reasonable reliability level of the results a feasible region identification fri method is well designed to narrow the search range by transforming various operation constraints into equivalent water level limits and integrating them with water level range got from hundreds of simulation calculations furthermore this method can use the water levels obtained in last iteration to dynamically update feasible regions during the calculation process three case studies involving a large scale hydropower system with 21 plants are presented to verify the validity efficiency and sensitivity of the proposed method compared to dynamic programming dp discrete differential dynamic programming dddp and progressive optimality algorithm poa the method requires only 0 85 1 27 and 3 14 of the computational effort to produce almost the same results moreover a sensitivity analysis indicates that the reliability parameter in this method has a larger impact on the computational time than other parameters keywords high dimensional hydropower system hdhs random sampling rs feasible region identification fri dimensionality reduction 1 introduction optimal operations of hydropower plants are among the most important and challenging tasks for large hydropower producers and power grid dispatching organizations cheng et al 2014 dehghani et al 2019 liu et al 2018 yalcin and tigrek 2017 shen et al 2018 2019 wang et al 2019 in recent decades this problem has attracted increasing attention from researchers because many large hydropower reservoirs have been put into operation worldwide and bear major responsibilities in their respective power systems particularly in some hydropower rich countries e g china brazil and canada chang et al 2013 chuntian et al 2017 as is well known hydropower systems involve complex hydraulic relations among upstream and downstream hydropower plants and electrical connections among plants on different rivers as well as various equality and inequality operation conditions and constraints most of which are highly nonlinear and nonconvex poorsepahy samian et al 2016 shen et al 2020 wang et al 2015 zhang et al 2019 wan et al 2020 furthermore these systems are also characterized by high dimensionality largely as a result of the large number of hydropower plants therefore the rapid expansion of the scale of hydropower systems in hydropower rich countries is leading to a serious challenge called curse of dimensionality regarding the optimal operations of high dimensional hydropower systems hdhss carpentier et al 2013 much effort has been directed toward solving hydropower optimization problems in the past several decades niu et al 2018 methods of operations research have been applied to reservoir operations and hydropower scheduling since the 1940s these methods include mathematical programming methods such as linear programming quadratic programming nonlinear programming and mixed integer programming as well as dynamic programming dp carpentier et al 2013 and its variants such as discrete differential dynamic programming dddp dynamic programming with successive approximation yi et al 2003 progressive optimality algorithms poas heidari et al 1971 li et al 2014a incremental dynamic programming and parallel dynamic programming li et al 2014b machine intelligence algorithms are another popular class of optimization techniques for hydropower system operations including genetic algorithms tayebiyan et al 2016 particle swarm optimization wu et al 2020 differential evolution zhang et al 2013 and other evolutionary algorithms akbarifard et al 2020 ehteram et al 2019 qi et al 2017 specifically mathematical programming methods commonly require some simplification or approximation of the original system so that the resulting problems can be solved in a reasonable amount of time using available commercial solvers which are the tools most often employed in short term and real time hydropower operations cheng et al 2018 hosnar and kovač kralj 2014 skjelbred et al 2020 some hybrid methods are proposed to solve the challenges of reservoir operation for example zhao et al 2019 presented a framework consisting of nonlinear modeling strategy optimization and decision making this framework used a fuzzy analytic hierarchy process to select the most satisfying non dominated solution evolutionary algorithms are also usually used in the reservoir operations ehteram et al 2018 for instance yu et al 2019 presented a noisy genetic algorithm for reservoir management this algorithm uses an improved type of fitness function called sampling fitness function to reduce the noise of fitness assessment feng et al 2017 designed a parallel multi objective genetic algorithm based on the fork join parallel framework avoiding the wastage of computational resources and increase the population diversity nevertheless improving the computational efficiency of operations for hdhss is still challenging while guaranteeing high accuracy of the optimization results evolutionary algorithms are easily implemented because there are few strict requirements on the objective and constraints of the considered system their heuristic search principle provides a powerful search ability but also means that they may fail to converge to a global or even local optimal solution feng et al 2017 moreover high storage requirements for large amounts of individual information may aggravate the computational burden during the optimization process dp exhibits a strong capability to solve multistage decision problems and is widely popular in hydropower system optimization it is especially suitable for long term hydropower operations which generally have few coupling constraints between consecutive periods however the number of discrete state combinations increases exponentially with the number of hydropower plants leading to serious dimensionality problem giuliani et al 2014 it is generally agreed that the well known dimensionality problem remains the greatest obstacle facing dp for optimizing the operations of hdhss although some improved variants can mitigate the dimensionality difficulties in dp to some extent the computational burden may still grow quickly with the expansion of the system scale zeng et al 2019 therefore for hdhss it is still important and necessary to develop efficient solution methods arising from the multistage decision characteristics of hydropower optimization the dimensionality problem in dp lies in the excessively large number of possible combinations of discrete state values for the hydropower plants in every period thus an effective way to improve computational efficiency may be to avoid calculating unfeasible state combinations while selecting only a small number of representative combinations from among all available discrete state values for this purpose the techniques of feasible region identification fri mao et al 2019 wu et al 2018 and random sampling rs optimization are used in this study some studies have employed the sampling technique to alleviate dimensionality difficulties such as uniform sampling feng et al 2018 and importance sampling he et al 2019 however the uniform sampling easily falls into the dilemma of local optimality because such sampling way may ignore some important water level states importance sampling is strongly dependent on the initial water level trajectory a poor initial water level trajectory may greatly affect the quality of optimization results by comparison the rs optimization used in the study introduces the randomness and dynamically adjust sampling size and times with the searched results furthermore the initial water levels are not necessary for this method reducing reliance on subjective choices in order to ensure a reasonable reliability level for the samples selected from among all candidate solutions acceptability and reliability parameters are introduced into the rs optimization the selected water level states are iteratively evaluated to assess the improvement of the objective value which is used as the convergence criterion for the entire search process on the other hand there are a few references involving the feasible region identification where a feasible region is usually estimated before starting the solution procedure ming et al 2017 ming et al 2015 the computational efficiency is thus enhanced with a narrowed search space however it may be not ensured that the selected region can meet all operation constraints by comparison this study dynamically identifies feasible regions during the calculation process the proposed fri technique determines feasible ranges based on the known water levels at the beginning of each period obtained in last iteration it should be mentioned that the water balance equations and various operation constraints are integrated into equivalent water level limits to construct possible solution ranges in the next period e g water level constraints total discharge constraints turbine discharge constraints and power generation constraints and then integrated with the optimized operation decision of multi yearly inflows in order to construct a range of possible optimal solutions such a way can make the feasible region smaller and more accurate three case studies involving a large scale hydropower system with 21 hydropower plants are presented to verify the validity efficiency and sensitivity of the proposed method in the first two case studies we present comparisons between our method and three classical methods namely dp dddp and poa the results show that the proposed method requires little computational effort of these two methods to produce almost the same power generation results the third case study is a sensitivity analysis the results of which indicate that the reliability parameter b has a larger impact on the computation time of the proposed method than the parameter a does however both parameters need to be limited to within a reasonable range to ensure the desired computational efficiency and solution quality the rest of this study is organized as follows section 2 presents the problem description including the objective function and constraints the whole methodology is introduced in section 3 the four subsections of which sequentially elaborate on the overall solution framework the principle of rs optimization fri and the detailed solution procedure section 4 presents the application of the developed method to a large hydropower system in china and analyses the results through three case studies finally section 5 concludes the study and offers suggestions for potential future work 2 problem description 2 1 objective in this paper the objective is to maximize the energy production of the hydropower system the main purpose is to verify the validity efficiency and sensitivity of the proposed method for any power grid the corresponding objective function can be formulated as 1 maxe i 1 num t 1 t n i t δ t n i t k i q i t h i t h i t h i t u h i 1 t u 2 h i t d hl i t h i t d f 1 r i t hl i t f 2 q i t u i where e is total energy production of all hydropower plants during the time horizon t t are period index and the number of all periods respectively δt is the total number of hours in period t i is the reservoir index ki is the power coefficient of the ith reservoir and ni t qi t and hi t are the power generation turbine discharge and net head respectively of the ith hydropower reservoir in period t h i t u h i t d hl i t are the water level tailrace level and penstock loss of the ith hydropower reservoir in period t f 1 and f 2 are tailrace level function and penstock loss function respectively 2 2 constraints 2 2 1 reservoir water level constraints 2 h i 0 h i 0 h i t h i t h i s h i t h i z here h i 0 and h i t are the initial and final water levels respectively of the ith hydropower reservoir h i t is the forebay water level of the ith hydropower reservoir in period t and h i s and h i z are the minimum and maximum water levels respectively of the ith hydropower reservoir 2 2 2 total reservoir discharge constraints 3 r i m i n r i t r i m a x 4 q i m i n q i t q i m a x 5 r i t q i t w i t here r i m i n and r i m a x are the minimum and maximum discharges for the ith hydropower reservoir respectively and r i t is the water discharge from the ith hydropower reservoir in period t r i m i n is usually determined by the downstream comprehensive water requirements and r i m a x is the sum of the maximum turbine discharge and allowed maximum flood discharge q i m i n and q i m a x are the minimum and maximum turbine discharges for the ith hydropower reservoir respectively here q i m a x is usually set as the maximal allowed discharge of the turbine while q i m i n is equal to 0 to ensure a positive turbine discharge q i t is the turbine discharge from the ith hydropower reservoir in period t w i t is spilled discharge of the ith hydropower reservoir in period t during the calculation process the constraint qi t qi max is first judged if this constraint is violated then we will take qi t qi max and the redundant discharge is taken as w i t following this the ni t is calculated and compared with the ni max when ni t exceeds the ni max we will recalculate qi t and wi t according to ni t ni max 2 2 3 power generation constraints 5 n i m i n n i t n i m a x here n i t denotes the power generation of the ith hydropower reservoir in period t n i m a x is usually set as the installed capacity of the ith hydropower reservoir 2 2 4 water balance constraints 6 v i t 1 v i t 3600 q i t r i t δ t r i t q i t d i t 7 q i t q i t i 1 q i t q i t r t i 1 here q i t is the total inflow to the ith hydropower reservoir in the tth period q i t is the local inflow to reservoir i in the tth period and r t is the total water discharge from the set of upstream hydropower reservoirs in the tth period d i t is spillage of hydropower reservoir i in the tth period 3 methodology 3 1 solution framework for the above optimization problem the computational complexity grows exponentially with the number of dimensions of the state and control vectors mainly because of the extremely large number of possible water level combinations this leads to the curse of dimensionality for an hdhs with many tens of interconnected reservoirs if the number of possible water level combinations in a single period could be greatly reduced this dimensionality problem could be effectively solved therefore to avoid the curse of dimensionality we combine rs optimization with the fri method in each period to narrow the range of water levels in a given period most possible water levels do not satisfy all of the constraints if these water level ranges are excluded reliable water levels can be selected from the remaining range before calculation nevertheless even if the water level range is reduced in this way there are still a large number of possible water level combinations to be calculated for an hdhs therefore to further reduce the calculation range we use the multiyear water levels for each reservoir to eliminate low probability water levels within the resulting feasible range the rs optimization is then used to sample multiple water level combinations to obtain a satisfactory result to improve the reliability of sampling weight parameters are adopted for the water level distribution fig 1 shows the solution framework as a whole 3 2 basic principle of random sampling rs optimization rs optimization used in this study improves the performance of standard rs generally the standard rs determines the size of samples based on experience and obtains the result by only one sampling by comparison the rs optimization can analyze the relationship between the results from groups of sampling and dynamically adjust the size of samples this avoids excessive or insufficient sampling which can obtain reliable results during the process of rs the number of samples is controlled by setting appropriate parameters to ensure a certain degree of reliability in rs optimization four parameters a b m l and thresholds ε need to be determined among all parameters a and b have the most influence on the computation time the rs optimization assumes that all alternatives are sorted from best to worst by their performance this assumption is helpful to understand the meaning of parameter a used in the random sampling however it should be mentioned that such assumption does not affect the sampling results in this situation a represents that the desired scheme is located in the first a of the sequence and b represents the reliability set by the author the initial value of a is taken to be a0 and the initial reliability index for rs optimization is set to b0 a sequence of samples ak ak a0 k m k 1 m is obtained where the minimum number of samples sk in the sequence is calculated based on the following eq 8 8 s k m i n i n t l g q l g 1 a k 1 samples are drawn in accordance with sk and the objective value of each sample in the sequence is calculated to determine the optimal result f1 i and the fifth most optimal result f5 i to evaluate the optimality of the candidate solutions the thresholds ε1 and ε2 are introduced to determine whether the result is satisfactory if eqs 9 and 10 are satisfied this means the optimality of the results of the current iteration has not significantly increased with the increase in the number of samples since the previous iteration and the best result among all samples can be considered satisfactory otherwise we need to increase the number of samples and continue iterating until a satisfactory solution is found 9 ε 1 f 1 i f 1 i 1 a 1 10 ε 2 f 5 i f 5 i 1 a 1 the number of additional samples is determined according to eq 11 11 δ s i n t l g b l g 1 a m 1 l g b l g 1 a m 1 the additional samples are added to the original sequence of samples and the results are added to the sequence of results then the above operations are repeated until a satisfactory solution is found 3 3 feasible region identification fri a solution that satisfies all constraints of a mathematical model is called a feasible solution the set consisting of all feasible solutions is called the feasible region therefore for the reservoir scheduling problem considered in this paper the feasible region is the set of solutions that satisfy all constraints given in section 2 2 in particular the power generation constraints can be transformed into total water discharge constraints as shown in eq 12 12 q i p m a x n i m a x μ i q i p m i n n i m i n μ i the two sets of total discharge constraints are compared and their intersection is taken as the set of discharge constraints defining the feasible region 13 q m a x i m i n q i m a x q i p m a x q m i n i m a x q i m i n q i p m i n the drainage constraints are combined with the inflow in period i to obtain the water level range of each reservoir as shown in eqs 14 and 15 14 v i t 1 m a x v i t q i t q m i n i δ t i 1 v i t q i t q i 1 t q m i n i δ t i 1 v i t 1 m i n v i t q i t q m a x i δ t i 1 v i t q i t q i 1 t q m a x i δ t i 1 15 h i t m a x f v i t 1 m a x h i t m i n f v i t 1 m i n to achieve better results the fri method is further improved in this paper we remove any water level range that does not satisfy the constraints as well as any range that is not covered by the water level range in matrix a which is a three dimensional matrix composed of the water level groups of all reservoirs hundreds of simulation calculations are performed for reservoir i to obtain a set of water levels which compose the corresponding two dimensional matrix in a upper and lower water level limits are then set for each reservoir in each period in accordance with a then we compare the range of water levels that satisfy the constraints with these water level limits and take the overlapping region as the feasible region for period i the calculation formula is as follows 16 zmax i t m i n h z i a i t z m i n i t m a x h s i a i t subject to 17 zmin i t h i t m a x z m a x i t z m i n i t h i t m i n z m a x i t h i 0 h i 0 h i t h i t during the calculation process the feasible region is determined starting from the earliest period and proceeding through each subsequent period in period 1 we can obtain new water level constraints based on the initial water level in combination with the constraints and inflow in the first period combined with the rs optimization method this method ensures that the water levels will be sampled from the feasible region to obtain the initial conditions for the next period thus the feasible region for each reservoir in each period can be calculated in turn the computational efficiency for an hdrs can be greatly improved by identifying the feasible regions in this way the principle of the fri method is illustrated in fig 2 3 4 rs integrated with fri in this paper to solve the hdhs problem the two methods introduced above are combined in addition to improve the effectiveness of sampling the variable w is introduced the value of w is obtained by counting the number of water level points in each water level segment in matrix a this variable represents the probability that a sampling result will fall in the corresponding water level range the larger the w value for a water level range the more likely a sampling result is to lie in this range the sum of the w values for all water level ranges in the entire feasible region is 1 first we must determine the parameters of the rs optimization method and obtain a from multiple known water levels then the upper and lower water level limits and the water level distribution weights are set for each reservoir in each period in accordance with a this completes the preparation step next sequential calculations for each period are performed in accordance with the principle of fri after the feasible regions are determined rs is performed based on the water level distribution weights w water levels are sampled from within the feasible regions and the corresponding water discharge and energy production values are calculated after the calculations have been completed for all reservoirs in all periods the energy production of all reservoirs in all periods is summed to obtain the value of the corresponding sample this completes the calculation step after this step is performed sk times the resulting values of the sk samples are compared to obtain the first entries in the sequences of optimal results and fifth most optimal results following the principle of the rs optimization method we will finally obtain a sequence of optimal solutions f1 l f1 m and a sequence of fifth most optimal solutions f5 l f5 m then we determine whether the obtained result is satisfactory if the result is not satisfactory the number of samples is increased and the above calculation process is repeated until a satisfactory result is found let us consider two reservoirs i1 and i2 as an example to illustrate the above steps the main preparations are as follows the water level range in a is determined for each of the two reservoirs and upper and lower water level limits are set accordingly for each of the two reservoirs in each period in addition the parameters of the rs optimization method are determined different objectives will affect the choice of the parameters the main calculations are as follows the initial number of samples sk is obtained and calculations are performed from upstream to downstream and from the earliest period to the last period the power generation constraints are converted into water discharge constraints by considering the water consumption rate the two sets of water discharge constraints are compared and the smaller of the two upper limits and the larger of the two lower limits are taken as the new water discharge constraints q i m a x and q i m i n water level limits corresponding to the discharge constraints are calculated in accordance with the mathematical model and these water level limits are compared with the water level range in a to obtain the feasible water level range z i2 max z i2 min of reservoir i1 in the first period sampling is performed in accordance with the water level distribution weights within the feasible range to obtain the initial water level in the second period then the energy production and water discharge values for reservoir i1 in the first period are calculated in accordance with the mathematical model based on the water discharged from reservoir i1 the water level energy production and water discharge of reservoir i2 in the first period are then obtained the above operations are repeated until the calculations have been performed for all periods all of the energy production values are then summed to obtain the result for the current sample this entire calculation process is performed multiple times yielding a sequence of optimal results f1 l f1 m and a sequence of fifth most optimal results f5 l f5 m at the end of each iteration these results are compared with the results from the previous iteration to determine whether to increase the number of samples or output the result the calculation process is summarized in fig 3 3 5 performance analysis here we analyze the principle of rs optimization based on the parameters a b m and l the number of samples is calculated as shown in eq 8 and the additional number of samples in each iteration is calculated using eq 11 under the assumption that the number of samples needs to be increased n times the total number of samples is 18 s i m l n m i n t lg b lg 1 a i 1 we can modify s by changing the parameters a b m and l however we cannot directly select n which has a great impact on n only reasonable selection of the other parameters can effectively keep n within a small range the parameters m and l are not included in the definition of rs optimization and are suggested to be the specified integer values we calculated the results of different values of m and l it is found that the two parameters have little effect on the results by differentiating s with respect to a and b therefore we obtain 19 ds 2 da d b i m l n m 1 l n 10 l g 1 a i 2 b 1 a i when ai 1 1 l n 10 0 566 the term l n 10 l g 1 a i 2 will decrease more slowly than the 2nd power of ai as ai decreases this can be expressed as shown in the following formula 20 ds 2 da d b i m l n m 1 ai 2 b 1 a i because the values of a and b are generally less than 0 2 and they change relatively little as the number of reservoirs increases we can consider that ds 2 da d b i m l n m 1 ai 2 b and that the change in ds 2 da d b is small therefore s changes little with an increasing number of reservoirs 4 case studies 4 1 practical engineering in yunnan province the installed hydropower capacity exceeds 80 of the total power generation capacity and the hydropower plants are mainly concentrated on the jinsha river lancang river and hong river fig 4 illustrates the distribution map of the hydropower system the economically exploitable hydropower capacity is estimated to be approximately 98 gw currently efficient calculation methods have great practical significance for yunnan province hence the hdhs on the jinsha river lancang river and nanpan river in yunnan province is chosen to test the feasibility of the proposed algorithm the primary characteristics of the hydropower plants are given in table 1 and the flood season is from june to august three cases are taken into account to analyze different indexes of the proposed method respectively shown in the following three subsections a monthly step is used in all cases the first case presents operations of two reservoirs to verify the result accuracy and computational efficiency where the proposed method is compared with the dp the main reason is that dp can converge to the global optimal solution with the specified discrete step in this case the ga is also used to present another comparison with our method the second case aims to verify the computational efficiency by solving optimal operation of dozens of hydropower plants in this case dddp poa are chosen for the comparison for the dp its computational time is too long to be used for such many hydropower plants the last case places the emphasis on the sensitivity analysis of the present method so that the impact of parameters used in the method on the computational time can be identified 4 2 case 1 operations for two reservoirs dp can be used to find the globally optimal solution on the premise that the discrete step size is sufficiently small however as the step size is decreased more calculation time is needed the excessively large number of possible water level combinations is the reason for the curse of dimensionality facing dp consequently dispatching calculations for no more than two reservoirs can be performed using dp thus we verified the performance of the method proposed in this study against the performance of dp by performing dispatching calculations for the operation of two hydropower plants based on historical records of one year and 62 years to test the effectiveness of our method xiaowan reservoir and nuozhadu reservoir were selected and the results were compared with those obtained from dp the energy production and computation times of the two methods are listed in tables 2 and 3 the average annual power generation and computational time provide a proof to verify the performance of the method proposed in this study fig 5 illustrates energy production profiles and water level profiles of two reservoirs obtained from dp with different discrete precision of water level the operation schemes obtained from two methods exhibit obvious differences our method basically keeps the water levels in dry season higher than those got by dp this situation implies that high generating efficiency is easily available because the water head is relative big this conclusion can be further verified according to table 2 when the total energy productions are same the present method is 1068 times faster than the dp if the dp method adopts a very large discrete step size the computational time can be greatly reduced but the present method is still twice as fast as it and the energy production is increased by 2 57 besides the ga is also used to compare with the present method this algorithm is provided by the toolbox of matlab according to the optimized results ga spends 245 5 s and obtains a total energy production of 50 05 billion kwh by comparison the present method also gives better results and higher computational efficiency in order to better demonstrate the advantages of our method the two methods are further used to optimize the operation schemes considering inflows over 62 years table 3 shows the optimization results it is indicated that the proposed method can efficiently balance computational efficiency and solution accuracy compared with the results from dp the average annual energy production from our method is increased by 9 19 and 8 89 respectively correspondingly the computation time is decreased by 94 41 and 99 15 respectively these indicate that rs optimization is able to produce a better result within a much shorter time 4 3 case 2 operations for 21 reservoirs with long series runoff in this case study twenty one reservoirs including twelve cascaded reservoirs on the lancang river eight cascaded reservoirs on the jinsha river and one on the nanpan river were chosen to test the performance of the proposed method the actual runoff processes in this system over 53 years namely 1954 1959 1961 1999 and 2008 2015 were selected for calculation to verify the efficiency of the method proposed in this paper and analyze the effect of different levels of inflow on the results since the proposed method is based on rs the total power generation and computation time will be different in each calculation therefore multiple calculations were performed to estimate the performance the detailed power generation and computation time data are listed in table 3 table 3 4 and 5 shows that the annual energy production of our method is higher by 4 37 and 8 74 and the computation time is decreased by 98 73 and 96 86 compared with the dddp and poa what s more we can find in multiple calculations of our method that the change in the energy production result is small and it can be considered that the results obtained in each calculation are within a satisfactory range by contrast the computation time shows a relatively large range of fluctuations however the average time spent is still much shorter than the calculation time with dddp and poa these findings prove that rs optimization performs better within a much shorter time for further analysis fig 6 shows the inflow features and their profiles over the 53 years at a peak in the total water inflow the energy production value calculated by our method and poa also reaches a peak the energy production value calculated by dddp will also reaches a peak at the peak of inflow but the overall fluctuation of it is much greater because these results were all obtained using the same parameters from the analysis of the computational complexity of the rs optimization method given above we can infer that the inflow will also affect the value of n the guarantee rate is calculated for the known 53 year inflows to analyze the guarantee output of hydropower reservoirs the best and the worst results of all years are listed in table 6 as can be seen from the table there are many reservoirs that cannot satisfy the firm output the results indicate that it is hard for these hydropower reservoirs to always produce energy generation especially in some dry years it is also implied that taking the firm output as the minimum generation maybe cause none of feasible solutions during optimization on the other hand there are some hydropower plants such as nuozhadu and jinghong with lower guarantee rates this may be due to high water level target at the end of the year except the inflow impact in order to meet the specified water level it is necessary to store the runoff and reduce power generation during the time horizon 4 4 case 3 sensitivity analysis the values of input parameters of the rs optimization method may affect the results as mentioned above the two parameters a and b have a great impact on the results in other words they are sensitive for the method when these parameters are too small many unnecessary sampling calculations have to be performed when these parameters are too large sampling must be performed multiple times to find a satisfactory result which will also increase the computational time thus proper parameter selection can greatly reduce the time required for calculation fig 7 shows the energy production results and total computational times for all 53 years achieved using the rs optimization method with various parameter settings to ensure the credibility of the data each data point is an average over multiple calculations as can be analyzed from fig 8 the time spent is 400 800 s in most cases when a is smaller than 0 21 and meanwhile b is smaller than 0 18 the number of cases in which the computation time lies in the range of 600 800 s increases significantly when a is equal to 0 21 and meanwhile b is bigger than 0 19 there is a significant increase in the number of cases where the computation time lies in the range of 200 400 s the areas of the plot corresponding to times of 200 400 s and times of 600 800 s are approximately equal thus the shortest time can be approximated as 300 s and the average time can be approximated as 500 s the energy production values mostly lie between 185000 108 and 185400 108 kw h and the ratio of the maximum difference in energy production to the average is only 0 00324 when b less than 0 185 the power output is mainly in the range of 185200 108 185400 108 kw h when b 0 185 the power output is mainly in the range of 185000 108 185200 108 kw h to obtain the most satisfactory results in as little time as possible the parameters a and b should be selected on the basis of these two graphs in this case it is suitable that a and b are set as 0 21 and 0 22 respectively the parameter a is the proportion of the satisfactory solution we want to obtain among all the solutions b represents the possibility that a random sample is the satisfactory result we need and reflects the size of the total sample population we need to use our own experience to select the values of these two parameters due to the optimization method we set we will always increase the number of samples to further optimize when we do not find a satisfactory result when these two parameters are not properly selected extra calculations will be generated and the tutor s calculation time will increase different input conditions will affect the choice of parameters however even if the parameters chosen are not optimal the impact on the energy production will be small 5 conclusions hydropower is considered one of the most important renewable energy sources and is widely utilized worldwide since 2000 china s hydropower industry has been experiencing explosive growth resulting in many large scale cascaded provincial and regional hydropower systems with tens or hundreds of plants methods of modeling and solving such hydropower systems need to address the well known curse of dimensionality this study develops an efficient method based on the fri and rs techniques and verifies it through three different case studies based on a large hydropower system in china an analysis of the results yields some useful conclusions 1 the proposed method can greatly alleviate the dimensionality problem by selecting a subset of representative water level states with little loss in solution quality this implies that state reduction is an effective way to improve computational efficiency for the optimization of hdhss 2 the rs technique is employed to obtain state samples with a specified degree of reliability its complexity increases linearly with the number of plants and the degree of state discretization in contrast to the exponential increase of dp and dddp the results show that the proposed method requires little computational effort of these three methods to produce almost the same power generation results 3 many operation constraints and conditions may be beneficial for reducing the search area of the algorithm thereby reducing the computational effort accordingly it is demonstrated that fri is another important strategy for coping with the dimensionality problem 4 the required number of iterations of the proposed method is quite sensitive to the choice of the reliability parameters a and b thus tuning these two parameters is an important task the proposed optimization method mainly depends on the characteristics of deterministic hydropower optimization problems and is suitable to solve such problems some changes are required before it is applied to stochastic optimization of hydropower systems therefore in future work the potential improvements for considering runoff uncertainty can be made to enhance the applicability of the algorithm furthermore the method should be further verified on other different and larger practical hydropower systems in addition the sample strategies should be further analyzed and recommended as another subject of future work credit authorship contribution statement jian jian shen investigation conceptualization writing wen li zhu methodology writing chun tian cheng supervision hao zhong investigation yan jiang validation xiu feng li validation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement this work was supported by the national natural science foundation of china grant numbers 52079014 and 52039002 the open research fund of hubei provincial key laboratory for operation and control of cascaded hydropower station 2019kjx06 and dalian young technology star 2019rq004 the authors are very grateful to the anonymous reviewers and editors for their constructive comments data availability statement some or all data models or code generated or used during the study are proprietary or confidential in nature and may only be provided with restrictions 
4456,optimal operations of high dimensional hydropower systems hdhss with dozens or hundreds of plants face a serious challenge called curse of dimensionality because the computational time and storage memory grow exponentially with the plant number this study develops an efficient method to alleviate the dimensionality challenge a random sampling rs technique is exploited to select representative water level states at each period by considering discrepant weights for different solution ranges the rs can dynamically adjust sampling size and times with the selected samples moreover acceptability and reliability parameters are introduced into the rs optimization to ensure a reasonable reliability level of the results a feasible region identification fri method is well designed to narrow the search range by transforming various operation constraints into equivalent water level limits and integrating them with water level range got from hundreds of simulation calculations furthermore this method can use the water levels obtained in last iteration to dynamically update feasible regions during the calculation process three case studies involving a large scale hydropower system with 21 plants are presented to verify the validity efficiency and sensitivity of the proposed method compared to dynamic programming dp discrete differential dynamic programming dddp and progressive optimality algorithm poa the method requires only 0 85 1 27 and 3 14 of the computational effort to produce almost the same results moreover a sensitivity analysis indicates that the reliability parameter in this method has a larger impact on the computational time than other parameters keywords high dimensional hydropower system hdhs random sampling rs feasible region identification fri dimensionality reduction 1 introduction optimal operations of hydropower plants are among the most important and challenging tasks for large hydropower producers and power grid dispatching organizations cheng et al 2014 dehghani et al 2019 liu et al 2018 yalcin and tigrek 2017 shen et al 2018 2019 wang et al 2019 in recent decades this problem has attracted increasing attention from researchers because many large hydropower reservoirs have been put into operation worldwide and bear major responsibilities in their respective power systems particularly in some hydropower rich countries e g china brazil and canada chang et al 2013 chuntian et al 2017 as is well known hydropower systems involve complex hydraulic relations among upstream and downstream hydropower plants and electrical connections among plants on different rivers as well as various equality and inequality operation conditions and constraints most of which are highly nonlinear and nonconvex poorsepahy samian et al 2016 shen et al 2020 wang et al 2015 zhang et al 2019 wan et al 2020 furthermore these systems are also characterized by high dimensionality largely as a result of the large number of hydropower plants therefore the rapid expansion of the scale of hydropower systems in hydropower rich countries is leading to a serious challenge called curse of dimensionality regarding the optimal operations of high dimensional hydropower systems hdhss carpentier et al 2013 much effort has been directed toward solving hydropower optimization problems in the past several decades niu et al 2018 methods of operations research have been applied to reservoir operations and hydropower scheduling since the 1940s these methods include mathematical programming methods such as linear programming quadratic programming nonlinear programming and mixed integer programming as well as dynamic programming dp carpentier et al 2013 and its variants such as discrete differential dynamic programming dddp dynamic programming with successive approximation yi et al 2003 progressive optimality algorithms poas heidari et al 1971 li et al 2014a incremental dynamic programming and parallel dynamic programming li et al 2014b machine intelligence algorithms are another popular class of optimization techniques for hydropower system operations including genetic algorithms tayebiyan et al 2016 particle swarm optimization wu et al 2020 differential evolution zhang et al 2013 and other evolutionary algorithms akbarifard et al 2020 ehteram et al 2019 qi et al 2017 specifically mathematical programming methods commonly require some simplification or approximation of the original system so that the resulting problems can be solved in a reasonable amount of time using available commercial solvers which are the tools most often employed in short term and real time hydropower operations cheng et al 2018 hosnar and kovač kralj 2014 skjelbred et al 2020 some hybrid methods are proposed to solve the challenges of reservoir operation for example zhao et al 2019 presented a framework consisting of nonlinear modeling strategy optimization and decision making this framework used a fuzzy analytic hierarchy process to select the most satisfying non dominated solution evolutionary algorithms are also usually used in the reservoir operations ehteram et al 2018 for instance yu et al 2019 presented a noisy genetic algorithm for reservoir management this algorithm uses an improved type of fitness function called sampling fitness function to reduce the noise of fitness assessment feng et al 2017 designed a parallel multi objective genetic algorithm based on the fork join parallel framework avoiding the wastage of computational resources and increase the population diversity nevertheless improving the computational efficiency of operations for hdhss is still challenging while guaranteeing high accuracy of the optimization results evolutionary algorithms are easily implemented because there are few strict requirements on the objective and constraints of the considered system their heuristic search principle provides a powerful search ability but also means that they may fail to converge to a global or even local optimal solution feng et al 2017 moreover high storage requirements for large amounts of individual information may aggravate the computational burden during the optimization process dp exhibits a strong capability to solve multistage decision problems and is widely popular in hydropower system optimization it is especially suitable for long term hydropower operations which generally have few coupling constraints between consecutive periods however the number of discrete state combinations increases exponentially with the number of hydropower plants leading to serious dimensionality problem giuliani et al 2014 it is generally agreed that the well known dimensionality problem remains the greatest obstacle facing dp for optimizing the operations of hdhss although some improved variants can mitigate the dimensionality difficulties in dp to some extent the computational burden may still grow quickly with the expansion of the system scale zeng et al 2019 therefore for hdhss it is still important and necessary to develop efficient solution methods arising from the multistage decision characteristics of hydropower optimization the dimensionality problem in dp lies in the excessively large number of possible combinations of discrete state values for the hydropower plants in every period thus an effective way to improve computational efficiency may be to avoid calculating unfeasible state combinations while selecting only a small number of representative combinations from among all available discrete state values for this purpose the techniques of feasible region identification fri mao et al 2019 wu et al 2018 and random sampling rs optimization are used in this study some studies have employed the sampling technique to alleviate dimensionality difficulties such as uniform sampling feng et al 2018 and importance sampling he et al 2019 however the uniform sampling easily falls into the dilemma of local optimality because such sampling way may ignore some important water level states importance sampling is strongly dependent on the initial water level trajectory a poor initial water level trajectory may greatly affect the quality of optimization results by comparison the rs optimization used in the study introduces the randomness and dynamically adjust sampling size and times with the searched results furthermore the initial water levels are not necessary for this method reducing reliance on subjective choices in order to ensure a reasonable reliability level for the samples selected from among all candidate solutions acceptability and reliability parameters are introduced into the rs optimization the selected water level states are iteratively evaluated to assess the improvement of the objective value which is used as the convergence criterion for the entire search process on the other hand there are a few references involving the feasible region identification where a feasible region is usually estimated before starting the solution procedure ming et al 2017 ming et al 2015 the computational efficiency is thus enhanced with a narrowed search space however it may be not ensured that the selected region can meet all operation constraints by comparison this study dynamically identifies feasible regions during the calculation process the proposed fri technique determines feasible ranges based on the known water levels at the beginning of each period obtained in last iteration it should be mentioned that the water balance equations and various operation constraints are integrated into equivalent water level limits to construct possible solution ranges in the next period e g water level constraints total discharge constraints turbine discharge constraints and power generation constraints and then integrated with the optimized operation decision of multi yearly inflows in order to construct a range of possible optimal solutions such a way can make the feasible region smaller and more accurate three case studies involving a large scale hydropower system with 21 hydropower plants are presented to verify the validity efficiency and sensitivity of the proposed method in the first two case studies we present comparisons between our method and three classical methods namely dp dddp and poa the results show that the proposed method requires little computational effort of these two methods to produce almost the same power generation results the third case study is a sensitivity analysis the results of which indicate that the reliability parameter b has a larger impact on the computation time of the proposed method than the parameter a does however both parameters need to be limited to within a reasonable range to ensure the desired computational efficiency and solution quality the rest of this study is organized as follows section 2 presents the problem description including the objective function and constraints the whole methodology is introduced in section 3 the four subsections of which sequentially elaborate on the overall solution framework the principle of rs optimization fri and the detailed solution procedure section 4 presents the application of the developed method to a large hydropower system in china and analyses the results through three case studies finally section 5 concludes the study and offers suggestions for potential future work 2 problem description 2 1 objective in this paper the objective is to maximize the energy production of the hydropower system the main purpose is to verify the validity efficiency and sensitivity of the proposed method for any power grid the corresponding objective function can be formulated as 1 maxe i 1 num t 1 t n i t δ t n i t k i q i t h i t h i t h i t u h i 1 t u 2 h i t d hl i t h i t d f 1 r i t hl i t f 2 q i t u i where e is total energy production of all hydropower plants during the time horizon t t are period index and the number of all periods respectively δt is the total number of hours in period t i is the reservoir index ki is the power coefficient of the ith reservoir and ni t qi t and hi t are the power generation turbine discharge and net head respectively of the ith hydropower reservoir in period t h i t u h i t d hl i t are the water level tailrace level and penstock loss of the ith hydropower reservoir in period t f 1 and f 2 are tailrace level function and penstock loss function respectively 2 2 constraints 2 2 1 reservoir water level constraints 2 h i 0 h i 0 h i t h i t h i s h i t h i z here h i 0 and h i t are the initial and final water levels respectively of the ith hydropower reservoir h i t is the forebay water level of the ith hydropower reservoir in period t and h i s and h i z are the minimum and maximum water levels respectively of the ith hydropower reservoir 2 2 2 total reservoir discharge constraints 3 r i m i n r i t r i m a x 4 q i m i n q i t q i m a x 5 r i t q i t w i t here r i m i n and r i m a x are the minimum and maximum discharges for the ith hydropower reservoir respectively and r i t is the water discharge from the ith hydropower reservoir in period t r i m i n is usually determined by the downstream comprehensive water requirements and r i m a x is the sum of the maximum turbine discharge and allowed maximum flood discharge q i m i n and q i m a x are the minimum and maximum turbine discharges for the ith hydropower reservoir respectively here q i m a x is usually set as the maximal allowed discharge of the turbine while q i m i n is equal to 0 to ensure a positive turbine discharge q i t is the turbine discharge from the ith hydropower reservoir in period t w i t is spilled discharge of the ith hydropower reservoir in period t during the calculation process the constraint qi t qi max is first judged if this constraint is violated then we will take qi t qi max and the redundant discharge is taken as w i t following this the ni t is calculated and compared with the ni max when ni t exceeds the ni max we will recalculate qi t and wi t according to ni t ni max 2 2 3 power generation constraints 5 n i m i n n i t n i m a x here n i t denotes the power generation of the ith hydropower reservoir in period t n i m a x is usually set as the installed capacity of the ith hydropower reservoir 2 2 4 water balance constraints 6 v i t 1 v i t 3600 q i t r i t δ t r i t q i t d i t 7 q i t q i t i 1 q i t q i t r t i 1 here q i t is the total inflow to the ith hydropower reservoir in the tth period q i t is the local inflow to reservoir i in the tth period and r t is the total water discharge from the set of upstream hydropower reservoirs in the tth period d i t is spillage of hydropower reservoir i in the tth period 3 methodology 3 1 solution framework for the above optimization problem the computational complexity grows exponentially with the number of dimensions of the state and control vectors mainly because of the extremely large number of possible water level combinations this leads to the curse of dimensionality for an hdhs with many tens of interconnected reservoirs if the number of possible water level combinations in a single period could be greatly reduced this dimensionality problem could be effectively solved therefore to avoid the curse of dimensionality we combine rs optimization with the fri method in each period to narrow the range of water levels in a given period most possible water levels do not satisfy all of the constraints if these water level ranges are excluded reliable water levels can be selected from the remaining range before calculation nevertheless even if the water level range is reduced in this way there are still a large number of possible water level combinations to be calculated for an hdhs therefore to further reduce the calculation range we use the multiyear water levels for each reservoir to eliminate low probability water levels within the resulting feasible range the rs optimization is then used to sample multiple water level combinations to obtain a satisfactory result to improve the reliability of sampling weight parameters are adopted for the water level distribution fig 1 shows the solution framework as a whole 3 2 basic principle of random sampling rs optimization rs optimization used in this study improves the performance of standard rs generally the standard rs determines the size of samples based on experience and obtains the result by only one sampling by comparison the rs optimization can analyze the relationship between the results from groups of sampling and dynamically adjust the size of samples this avoids excessive or insufficient sampling which can obtain reliable results during the process of rs the number of samples is controlled by setting appropriate parameters to ensure a certain degree of reliability in rs optimization four parameters a b m l and thresholds ε need to be determined among all parameters a and b have the most influence on the computation time the rs optimization assumes that all alternatives are sorted from best to worst by their performance this assumption is helpful to understand the meaning of parameter a used in the random sampling however it should be mentioned that such assumption does not affect the sampling results in this situation a represents that the desired scheme is located in the first a of the sequence and b represents the reliability set by the author the initial value of a is taken to be a0 and the initial reliability index for rs optimization is set to b0 a sequence of samples ak ak a0 k m k 1 m is obtained where the minimum number of samples sk in the sequence is calculated based on the following eq 8 8 s k m i n i n t l g q l g 1 a k 1 samples are drawn in accordance with sk and the objective value of each sample in the sequence is calculated to determine the optimal result f1 i and the fifth most optimal result f5 i to evaluate the optimality of the candidate solutions the thresholds ε1 and ε2 are introduced to determine whether the result is satisfactory if eqs 9 and 10 are satisfied this means the optimality of the results of the current iteration has not significantly increased with the increase in the number of samples since the previous iteration and the best result among all samples can be considered satisfactory otherwise we need to increase the number of samples and continue iterating until a satisfactory solution is found 9 ε 1 f 1 i f 1 i 1 a 1 10 ε 2 f 5 i f 5 i 1 a 1 the number of additional samples is determined according to eq 11 11 δ s i n t l g b l g 1 a m 1 l g b l g 1 a m 1 the additional samples are added to the original sequence of samples and the results are added to the sequence of results then the above operations are repeated until a satisfactory solution is found 3 3 feasible region identification fri a solution that satisfies all constraints of a mathematical model is called a feasible solution the set consisting of all feasible solutions is called the feasible region therefore for the reservoir scheduling problem considered in this paper the feasible region is the set of solutions that satisfy all constraints given in section 2 2 in particular the power generation constraints can be transformed into total water discharge constraints as shown in eq 12 12 q i p m a x n i m a x μ i q i p m i n n i m i n μ i the two sets of total discharge constraints are compared and their intersection is taken as the set of discharge constraints defining the feasible region 13 q m a x i m i n q i m a x q i p m a x q m i n i m a x q i m i n q i p m i n the drainage constraints are combined with the inflow in period i to obtain the water level range of each reservoir as shown in eqs 14 and 15 14 v i t 1 m a x v i t q i t q m i n i δ t i 1 v i t q i t q i 1 t q m i n i δ t i 1 v i t 1 m i n v i t q i t q m a x i δ t i 1 v i t q i t q i 1 t q m a x i δ t i 1 15 h i t m a x f v i t 1 m a x h i t m i n f v i t 1 m i n to achieve better results the fri method is further improved in this paper we remove any water level range that does not satisfy the constraints as well as any range that is not covered by the water level range in matrix a which is a three dimensional matrix composed of the water level groups of all reservoirs hundreds of simulation calculations are performed for reservoir i to obtain a set of water levels which compose the corresponding two dimensional matrix in a upper and lower water level limits are then set for each reservoir in each period in accordance with a then we compare the range of water levels that satisfy the constraints with these water level limits and take the overlapping region as the feasible region for period i the calculation formula is as follows 16 zmax i t m i n h z i a i t z m i n i t m a x h s i a i t subject to 17 zmin i t h i t m a x z m a x i t z m i n i t h i t m i n z m a x i t h i 0 h i 0 h i t h i t during the calculation process the feasible region is determined starting from the earliest period and proceeding through each subsequent period in period 1 we can obtain new water level constraints based on the initial water level in combination with the constraints and inflow in the first period combined with the rs optimization method this method ensures that the water levels will be sampled from the feasible region to obtain the initial conditions for the next period thus the feasible region for each reservoir in each period can be calculated in turn the computational efficiency for an hdrs can be greatly improved by identifying the feasible regions in this way the principle of the fri method is illustrated in fig 2 3 4 rs integrated with fri in this paper to solve the hdhs problem the two methods introduced above are combined in addition to improve the effectiveness of sampling the variable w is introduced the value of w is obtained by counting the number of water level points in each water level segment in matrix a this variable represents the probability that a sampling result will fall in the corresponding water level range the larger the w value for a water level range the more likely a sampling result is to lie in this range the sum of the w values for all water level ranges in the entire feasible region is 1 first we must determine the parameters of the rs optimization method and obtain a from multiple known water levels then the upper and lower water level limits and the water level distribution weights are set for each reservoir in each period in accordance with a this completes the preparation step next sequential calculations for each period are performed in accordance with the principle of fri after the feasible regions are determined rs is performed based on the water level distribution weights w water levels are sampled from within the feasible regions and the corresponding water discharge and energy production values are calculated after the calculations have been completed for all reservoirs in all periods the energy production of all reservoirs in all periods is summed to obtain the value of the corresponding sample this completes the calculation step after this step is performed sk times the resulting values of the sk samples are compared to obtain the first entries in the sequences of optimal results and fifth most optimal results following the principle of the rs optimization method we will finally obtain a sequence of optimal solutions f1 l f1 m and a sequence of fifth most optimal solutions f5 l f5 m then we determine whether the obtained result is satisfactory if the result is not satisfactory the number of samples is increased and the above calculation process is repeated until a satisfactory result is found let us consider two reservoirs i1 and i2 as an example to illustrate the above steps the main preparations are as follows the water level range in a is determined for each of the two reservoirs and upper and lower water level limits are set accordingly for each of the two reservoirs in each period in addition the parameters of the rs optimization method are determined different objectives will affect the choice of the parameters the main calculations are as follows the initial number of samples sk is obtained and calculations are performed from upstream to downstream and from the earliest period to the last period the power generation constraints are converted into water discharge constraints by considering the water consumption rate the two sets of water discharge constraints are compared and the smaller of the two upper limits and the larger of the two lower limits are taken as the new water discharge constraints q i m a x and q i m i n water level limits corresponding to the discharge constraints are calculated in accordance with the mathematical model and these water level limits are compared with the water level range in a to obtain the feasible water level range z i2 max z i2 min of reservoir i1 in the first period sampling is performed in accordance with the water level distribution weights within the feasible range to obtain the initial water level in the second period then the energy production and water discharge values for reservoir i1 in the first period are calculated in accordance with the mathematical model based on the water discharged from reservoir i1 the water level energy production and water discharge of reservoir i2 in the first period are then obtained the above operations are repeated until the calculations have been performed for all periods all of the energy production values are then summed to obtain the result for the current sample this entire calculation process is performed multiple times yielding a sequence of optimal results f1 l f1 m and a sequence of fifth most optimal results f5 l f5 m at the end of each iteration these results are compared with the results from the previous iteration to determine whether to increase the number of samples or output the result the calculation process is summarized in fig 3 3 5 performance analysis here we analyze the principle of rs optimization based on the parameters a b m and l the number of samples is calculated as shown in eq 8 and the additional number of samples in each iteration is calculated using eq 11 under the assumption that the number of samples needs to be increased n times the total number of samples is 18 s i m l n m i n t lg b lg 1 a i 1 we can modify s by changing the parameters a b m and l however we cannot directly select n which has a great impact on n only reasonable selection of the other parameters can effectively keep n within a small range the parameters m and l are not included in the definition of rs optimization and are suggested to be the specified integer values we calculated the results of different values of m and l it is found that the two parameters have little effect on the results by differentiating s with respect to a and b therefore we obtain 19 ds 2 da d b i m l n m 1 l n 10 l g 1 a i 2 b 1 a i when ai 1 1 l n 10 0 566 the term l n 10 l g 1 a i 2 will decrease more slowly than the 2nd power of ai as ai decreases this can be expressed as shown in the following formula 20 ds 2 da d b i m l n m 1 ai 2 b 1 a i because the values of a and b are generally less than 0 2 and they change relatively little as the number of reservoirs increases we can consider that ds 2 da d b i m l n m 1 ai 2 b and that the change in ds 2 da d b is small therefore s changes little with an increasing number of reservoirs 4 case studies 4 1 practical engineering in yunnan province the installed hydropower capacity exceeds 80 of the total power generation capacity and the hydropower plants are mainly concentrated on the jinsha river lancang river and hong river fig 4 illustrates the distribution map of the hydropower system the economically exploitable hydropower capacity is estimated to be approximately 98 gw currently efficient calculation methods have great practical significance for yunnan province hence the hdhs on the jinsha river lancang river and nanpan river in yunnan province is chosen to test the feasibility of the proposed algorithm the primary characteristics of the hydropower plants are given in table 1 and the flood season is from june to august three cases are taken into account to analyze different indexes of the proposed method respectively shown in the following three subsections a monthly step is used in all cases the first case presents operations of two reservoirs to verify the result accuracy and computational efficiency where the proposed method is compared with the dp the main reason is that dp can converge to the global optimal solution with the specified discrete step in this case the ga is also used to present another comparison with our method the second case aims to verify the computational efficiency by solving optimal operation of dozens of hydropower plants in this case dddp poa are chosen for the comparison for the dp its computational time is too long to be used for such many hydropower plants the last case places the emphasis on the sensitivity analysis of the present method so that the impact of parameters used in the method on the computational time can be identified 4 2 case 1 operations for two reservoirs dp can be used to find the globally optimal solution on the premise that the discrete step size is sufficiently small however as the step size is decreased more calculation time is needed the excessively large number of possible water level combinations is the reason for the curse of dimensionality facing dp consequently dispatching calculations for no more than two reservoirs can be performed using dp thus we verified the performance of the method proposed in this study against the performance of dp by performing dispatching calculations for the operation of two hydropower plants based on historical records of one year and 62 years to test the effectiveness of our method xiaowan reservoir and nuozhadu reservoir were selected and the results were compared with those obtained from dp the energy production and computation times of the two methods are listed in tables 2 and 3 the average annual power generation and computational time provide a proof to verify the performance of the method proposed in this study fig 5 illustrates energy production profiles and water level profiles of two reservoirs obtained from dp with different discrete precision of water level the operation schemes obtained from two methods exhibit obvious differences our method basically keeps the water levels in dry season higher than those got by dp this situation implies that high generating efficiency is easily available because the water head is relative big this conclusion can be further verified according to table 2 when the total energy productions are same the present method is 1068 times faster than the dp if the dp method adopts a very large discrete step size the computational time can be greatly reduced but the present method is still twice as fast as it and the energy production is increased by 2 57 besides the ga is also used to compare with the present method this algorithm is provided by the toolbox of matlab according to the optimized results ga spends 245 5 s and obtains a total energy production of 50 05 billion kwh by comparison the present method also gives better results and higher computational efficiency in order to better demonstrate the advantages of our method the two methods are further used to optimize the operation schemes considering inflows over 62 years table 3 shows the optimization results it is indicated that the proposed method can efficiently balance computational efficiency and solution accuracy compared with the results from dp the average annual energy production from our method is increased by 9 19 and 8 89 respectively correspondingly the computation time is decreased by 94 41 and 99 15 respectively these indicate that rs optimization is able to produce a better result within a much shorter time 4 3 case 2 operations for 21 reservoirs with long series runoff in this case study twenty one reservoirs including twelve cascaded reservoirs on the lancang river eight cascaded reservoirs on the jinsha river and one on the nanpan river were chosen to test the performance of the proposed method the actual runoff processes in this system over 53 years namely 1954 1959 1961 1999 and 2008 2015 were selected for calculation to verify the efficiency of the method proposed in this paper and analyze the effect of different levels of inflow on the results since the proposed method is based on rs the total power generation and computation time will be different in each calculation therefore multiple calculations were performed to estimate the performance the detailed power generation and computation time data are listed in table 3 table 3 4 and 5 shows that the annual energy production of our method is higher by 4 37 and 8 74 and the computation time is decreased by 98 73 and 96 86 compared with the dddp and poa what s more we can find in multiple calculations of our method that the change in the energy production result is small and it can be considered that the results obtained in each calculation are within a satisfactory range by contrast the computation time shows a relatively large range of fluctuations however the average time spent is still much shorter than the calculation time with dddp and poa these findings prove that rs optimization performs better within a much shorter time for further analysis fig 6 shows the inflow features and their profiles over the 53 years at a peak in the total water inflow the energy production value calculated by our method and poa also reaches a peak the energy production value calculated by dddp will also reaches a peak at the peak of inflow but the overall fluctuation of it is much greater because these results were all obtained using the same parameters from the analysis of the computational complexity of the rs optimization method given above we can infer that the inflow will also affect the value of n the guarantee rate is calculated for the known 53 year inflows to analyze the guarantee output of hydropower reservoirs the best and the worst results of all years are listed in table 6 as can be seen from the table there are many reservoirs that cannot satisfy the firm output the results indicate that it is hard for these hydropower reservoirs to always produce energy generation especially in some dry years it is also implied that taking the firm output as the minimum generation maybe cause none of feasible solutions during optimization on the other hand there are some hydropower plants such as nuozhadu and jinghong with lower guarantee rates this may be due to high water level target at the end of the year except the inflow impact in order to meet the specified water level it is necessary to store the runoff and reduce power generation during the time horizon 4 4 case 3 sensitivity analysis the values of input parameters of the rs optimization method may affect the results as mentioned above the two parameters a and b have a great impact on the results in other words they are sensitive for the method when these parameters are too small many unnecessary sampling calculations have to be performed when these parameters are too large sampling must be performed multiple times to find a satisfactory result which will also increase the computational time thus proper parameter selection can greatly reduce the time required for calculation fig 7 shows the energy production results and total computational times for all 53 years achieved using the rs optimization method with various parameter settings to ensure the credibility of the data each data point is an average over multiple calculations as can be analyzed from fig 8 the time spent is 400 800 s in most cases when a is smaller than 0 21 and meanwhile b is smaller than 0 18 the number of cases in which the computation time lies in the range of 600 800 s increases significantly when a is equal to 0 21 and meanwhile b is bigger than 0 19 there is a significant increase in the number of cases where the computation time lies in the range of 200 400 s the areas of the plot corresponding to times of 200 400 s and times of 600 800 s are approximately equal thus the shortest time can be approximated as 300 s and the average time can be approximated as 500 s the energy production values mostly lie between 185000 108 and 185400 108 kw h and the ratio of the maximum difference in energy production to the average is only 0 00324 when b less than 0 185 the power output is mainly in the range of 185200 108 185400 108 kw h when b 0 185 the power output is mainly in the range of 185000 108 185200 108 kw h to obtain the most satisfactory results in as little time as possible the parameters a and b should be selected on the basis of these two graphs in this case it is suitable that a and b are set as 0 21 and 0 22 respectively the parameter a is the proportion of the satisfactory solution we want to obtain among all the solutions b represents the possibility that a random sample is the satisfactory result we need and reflects the size of the total sample population we need to use our own experience to select the values of these two parameters due to the optimization method we set we will always increase the number of samples to further optimize when we do not find a satisfactory result when these two parameters are not properly selected extra calculations will be generated and the tutor s calculation time will increase different input conditions will affect the choice of parameters however even if the parameters chosen are not optimal the impact on the energy production will be small 5 conclusions hydropower is considered one of the most important renewable energy sources and is widely utilized worldwide since 2000 china s hydropower industry has been experiencing explosive growth resulting in many large scale cascaded provincial and regional hydropower systems with tens or hundreds of plants methods of modeling and solving such hydropower systems need to address the well known curse of dimensionality this study develops an efficient method based on the fri and rs techniques and verifies it through three different case studies based on a large hydropower system in china an analysis of the results yields some useful conclusions 1 the proposed method can greatly alleviate the dimensionality problem by selecting a subset of representative water level states with little loss in solution quality this implies that state reduction is an effective way to improve computational efficiency for the optimization of hdhss 2 the rs technique is employed to obtain state samples with a specified degree of reliability its complexity increases linearly with the number of plants and the degree of state discretization in contrast to the exponential increase of dp and dddp the results show that the proposed method requires little computational effort of these three methods to produce almost the same power generation results 3 many operation constraints and conditions may be beneficial for reducing the search area of the algorithm thereby reducing the computational effort accordingly it is demonstrated that fri is another important strategy for coping with the dimensionality problem 4 the required number of iterations of the proposed method is quite sensitive to the choice of the reliability parameters a and b thus tuning these two parameters is an important task the proposed optimization method mainly depends on the characteristics of deterministic hydropower optimization problems and is suitable to solve such problems some changes are required before it is applied to stochastic optimization of hydropower systems therefore in future work the potential improvements for considering runoff uncertainty can be made to enhance the applicability of the algorithm furthermore the method should be further verified on other different and larger practical hydropower systems in addition the sample strategies should be further analyzed and recommended as another subject of future work credit authorship contribution statement jian jian shen investigation conceptualization writing wen li zhu methodology writing chun tian cheng supervision hao zhong investigation yan jiang validation xiu feng li validation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement this work was supported by the national natural science foundation of china grant numbers 52079014 and 52039002 the open research fund of hubei provincial key laboratory for operation and control of cascaded hydropower station 2019kjx06 and dalian young technology star 2019rq004 the authors are very grateful to the anonymous reviewers and editors for their constructive comments data availability statement some or all data models or code generated or used during the study are proprietary or confidential in nature and may only be provided with restrictions 
4457,the international legal principle of no harm as a customary international law lies at the heart of numerous international transboundary water conventions rules and agreements the current study identifies and examines the three most common categories of harm namely health environmental and economic in an integrated framework exploitation of the kamal khan dam over the hirmand helmand transboundary river internationally shared between iran and afghanistan has been selected as a case study for this aim an integrated modeling approach that links soil and water assessment tool swat indicators of hydrologic alteration iha dust storm events dst and crop production is developed to simulate the indicators and their parameters under historical conditions and future exploitation of the dam effects on the three types of harm are classified as being low moderate or high the results showed that the effects of the dam diversion for economic harm would be high for instance it could reduce the wheat production of the iranian side of sistan plain up to 70 the hydrological alteration of the river is also significant up to 80 during the winter and spring months this can result in health and environmental harms the region s health and environment are already in a critical situation mainly due to the drying of hamoun wetlands which rely on the inflows of the helmand river and are the major sources of dust storms notably these issues would affect the entire plain in both iran and afghanistan the scope of this study was the principle of no harm but the methodology with some additional modifications could be considered for other principles like equitable and reasonable utilization in transboundary river basins keywords no harm rule transboundary river basin limited territorial sovereignty international water law swat model helmand river basin 1 introduction the complex impacts of human activities on the socio economic political and environmental conditions of riparian countries are of vital importance in transboundary river basins a fundamental challenge in international water conflict management regarding the utilization of shared water resources under international water law is reconciling the sovereignty of one state within its territory on the one hand and the territorial integrity of other riparian countries on the other wehling 2020 the absolute territorial sovereignty which is also known as the harmon doctrine relies on absolute control over national waters this principle concluded that a state is free to use its territory without any restrictions and concern for the harm or adverse impact that such use may cause to other riparian states salman 2007 the opposite doctrine principle of absolute territorial integrity gives the downstream state the absolute right to the continuous flow of a river flowing from the upstream states kotkasaari 2008 today s international water law is based on some global conventions and rules specifically including the 1992 convention on the protection and use of transboundary the watercourses and international lakes the unece 1992 watercourses convention or 1992 helsinki watercourses convention which was adopted in helsinki in 1992 the 1997 convention on the law of non navigational use of international watercourses un watercourses convention 1997 which was adopted in new york in 1997 the 1966 helsinki rules on the uses of the waters of international rivers helsinki rules 1966 and the berlin rules on water resources berlin rules 2004 the mentioned global conventions as the modern international water law are based on the theories of limited territorial sovereignty and the community of interest the idea of limited sovereignty is contained in the equitable and reasonable utilization and no harm principles which emphasize that riparian countries should not use their territorial waters in ways that cause damage and undesirable impact to downstream co riparian countries zawahri hensengerth 2012 the current doctrine of limited territorial sovereignty stands in stark contrast to the earlier doctrines the obligation of one state to not cause significant harm to an other state s the no harm rule is one of the most fundamental principles in international water law mccaffrey 2007 nanda and pring 2013 tanzi 2020 this principle has implications for both the allocation of the uses of shared watercourses and for their environmental protection bulto 2009 this principle also is implicitly considered in the ramsar convention 1971 ramsar convention 1971 while international water law has evolved considerably over time to take into account the changes in both the use of international water resources and the understanding of hydrological systems it still does not adequately deal with several significant issues that have increasingly come to the fore wehling 2020 ambiguity in some articles of international water law has been mentioned as a major factor causing conflict among riparian countries and the failure of international water laws to manage international water disputes mianabadi et al 2015 for instance in the case of the euphrates tigris basin turkey bases its arguments on article 5 while implementing the gap project indicating that it is using the rivers based on equitable and reasonable utilization syria and iraq in contrast base their arguments on article 7 and claim that turkey is causing significant harm to the downstream countries korkutan 2001 this also applies in the case of blue nile water conflict among egypt sudan and ethiopia ansink 2009 the lack of an explicit definition of the principle of equitable and reasonable utilization and the no harm rule and no quantitative attributes and criteria appears to be an ambiguity in these conventions and rules salman 2007 the quantification of the no harm rule remains unclear to some extent van der zaag et al 2002 therefore it does not usually provide operative guidance to riparian countries for international water conflict management the obligation not to cause significant harm remains one of the essential circumstances to be taken into account for establishing whether a shared utilization in transboundary river basins is equitable and reasonable caflisch 1996 a key question remains about the definition and extent of the word harm and significant and how to define or quantify significant harm this issue is pointed out in different studies mianabadi 2016 salman 2019 2007 van der zaag et al 2002 the no harm and equitable and reasonable utilization principles are covered extensively by some global conventions and rules specifically including the unece 1992 watercourses convention the un watercourses convention 1997 the helsinki rules 1966 and the berlin rules 2004 the term of no harm also appears frequently in international transboundary conventions and agreements however quantification of these terms is challenging in spite of the significance of quantification of these fundamental principles of customary international water law little research has attempted to quantify only the principles of equitable and reasonable utilization as stated in the un watercourses convention1997 mimi sawalhi 2003 formulated a procedure for allocating the water resources of the jordan basin between the five riparian countries based on this principle they used a multi criteria decision method using the following nine variables for each basin state 1 the drainage area within the basin 2 climate 3 hydrology 4 historical consumption of water resources 5 socio economic demand 6 the populations dependent upon basin water resources 7 comparative cost of substituting new resources to meet economic and social demand 8 availability of other resources and 9 the degree to which the needs of a basin state can be satisfied without causing appreciable harm to the riparian states kampragou et al 2007 used these variables to evaluate the equitable and reasonable utilization principle for the nesto messi transboundary basin between bulgaria and greece avarideh et al 2017 assessed allocation of water resources in the sirvan deyaleh transboundary basin between iran and iraq using articles 5 to 7 and 10 of the un watercourses convention 1997 the indicators were similar to those suggested by mimi sawalhi 2003 similarly in the case of the no harm rule it has not been yet received enough attention in hydrological and environmental modeling researches no doubt a comprehensive evaluation of criteria and indicators with respect to territorial treaties and customary international water law requires integrated modeling for this purpose exchange of data and information in transboundary basins as a key principle of some landmark international transboundary water conventions including the un watercourses convention 1997 is generally limited by political concerns thu and wehn 2016 aside from political issues data scarcity is another considerable problem in transboundary basins as in the case study addressed in this research data and information is insufficient due to poor infrastructure limited meteorological monitoring systems and political instability to tackle this issue integrated models can be linked with global climate databases to simulate the rainfall runoff of transboundary basins the accuracy of this linkage has been validated in various studies for instance schuol abbaspour 2007 applied the soil and water assessment tool swat andah et al 2003 and climate research unit cru to a global climate database to simulate the volta river basin hajihosseini et al 2016 also applied a similar combination for the upper catchment of the helmand upstream of kajaki dam they evaluated trends in the time series of inflow into the dam and hydrologically assessed the 1973 treaty between iran and afghanistan on exploitation of the helmand river they also compared the cru data with data available from the few existing ground stations the results showed acceptable performance of the cru data and the swat for hydrological modeling of the basin swat does not directly simulate the components of environmental flows to address this deficiency it has been linked to the indicators of hydrologic alteration iha model in a number of research works morid et al 2016 applied this modeling setup for evaluation of habitat suitability on the kordan river in iran under climate change conditions morid et al 2019 did the same for the kikuchi river in japan amongst other uses iha has been applied to assess the impact of dam construction on environmental flows yang 2016 used the iha to evaluate the role of dam construction on the trinity and brazos environmental flows zuo and liang 2015 showed how environmental flows of the shaying river in china will be affected by construction of a dam on this river they reported changes for 1 to 90 day extreme events as well as days with zero stream flow in response to the preceding discussion the aim of the current study is to develop an integrated framework to investigate the no harm rule in hydrological and environmental modeling research for this purpose the swat model is used with iha and global climate databases the construction of kamal khan dam on the transboundary helmand river in afghanistan in construction since 2011 thomas and varzi 2015 has been used as a case study it is a hydroelectric and irrigation dam project as an infrastructural project on the upstream of a transboundary river basin there is a concern that the human and environmental consequences of the construction of this dam on the local inhabitants and the region s environment especially the international hamoun lakes have not been sufficiently considered however the article is not in a position to make any definite judgments the innovation of this study is its methodological approach to quantification of no harm rule as a fundamental principle of customary international water law on transboundary river basins using very limited observed data and public domain models the methods may also have applicability to other rules 2 material and methods 2 1 study area the international basin of the hirmand helmand river is an important water resource that is shared by iran and afghanistan its area is about 353 400 km2 of which 81 4 is in afghanistan and 15 is in iran the helmand river originates in the hindu kush mountains and crosses the sistan plain to lake hamoun these lakes are one of the main and most valuable aquatic ecosystems in the region and are registered wetlands in the ramsar and unesco biosphere reserve conventions van beek and meijer 2006 the hamoun lake ecosystem is a highly dynamic ecosystem and its system depends on the discharge of the hirmand river and a few smaller rivers but the flow differs greatly between years penning and beintema 2006 accordingly the size of the hamoun varies both seasonally and yearly greatest development takes place in late spring when snowmelt and seasonal high flows occur in wet years almost each 7 years the overflow from the lake flows southward to gowd i zerreh zerrah depression in afghanistan fig 1 which is usually dry whitney 2006 the river forms about 55 km of the border between iran and afghanistan the sistan plain is shared between southeastern iran sistan and baluchestan provinces and southern afghanistan nimruz helmand and kandahar provinces it has been settled since ancient times and used to be called the breadbasket of western asia however the prosperity of the plain declined in the early 16th century and has not been restored whitney 2006 in spite of signing numerous international water treaties such as the indus river agreement of 1960 the nile river agreement of 1959 and the euphrates river agreement of 1987 water disputes among riparian countries remain or have worsened this is also true for the hirmand helmand river which is shared between iran and afghanistan negotiations for exploitation of its water resources goes back to 1872 dominguez et al 1951 the average annual rainfall of this basin varies from 50 mm in the southwest to 300 mm in the northeast goes et al 2016 the water is primarily used for irrigation on both sides of the border yıldız 2015 some dams have been built on the helmand river and its tributaries the most important of which is the kajaki dam with the total capacity of 1700 mcm the kamal khan dam is the largest hydraulic structure on the helmand river after the kajaki dam fig 1 construction of this dam began in 1996 but was halted due to the civil war the project recommenced in 2011 and phase ii was completed in 2015 work on phase iii began in 2017 the objective has been to provide water for irrigation of agricultural land in the sistan plain afghanistan part flood protection drinking water and generation of 9 mw of electricity ariananews 2020 2 2 data and information data and information exchange in transboundary watercourses is considered as a fundamental component of long cooperative history over shared basins and a key principle of some conventions such as the 1997 un convention gerlak et al 2010 this issue has been stated as a usual problem in other research works bitew and gebremichael 2011 moreover the study suffers shortage of infrastructure for measuring hydro meteorological variables to address these challenges the case study made use of different public information judged to be sufficiently valid hydrological modeling requires rainfall temperature and streamflow data a digital elevation model and land use and soil maps they are prepared from different sources the recorded climate data period was very short thus global cru was used to compensate for this deficiency hydrological data covering 1968 to 1978 was collected from char burjak station 30017 latitude 62002 longitude near the kamal khan dam table 1 lists the information layers collected to run the models in the study area 2 2 1 cru database the cru is a widely applied climate dataset that uses extensive networks of weather station observations it offers high spatial resolution 0 5 0 5 in this study ts version 3 21 was used http www cru uea ac uk the accuracy and performance of cru for the study area has been reported by hajihosseini et al 2016 because cru data is produced monthly and daily data is required for input into swat the dgen algorithm schuol and abbaspour 2007 was used as applied by anoh et al 2018 and fadil et al 2011 2 3 definition of harm in international transboundary conventions 2 3 1 interrelationship between no harm and equitable and reasonable utilization principles the principle of equitable and reasonable utilization and the no harm rule lie at the core of international water law mccaffrey 2007 the inter relationship between these two core pillars has long been the most controversial issue in international water law the principle of equitable and reasonable utilization as a part of customary international law is based on the idea that transboundary watercourses must be used in such a manner that every state has an equal right to an equitable share of the uses of a watercourse and the benefits derived from it with regard to its use within their territory wehling 2020 this principle also does not only focus on the quantitative allocation of water resources between riparian states but also encompasses the manner of that use wehling 2020 hence this principle as a holistic concept incorporates aspects of both allocation and protection of the shared waters mccaffrey 2007 there are different views on the relationship between these two principles some believe that according to the arts 12 and 16 of the international law association 2004 the no harm and the equitable utilization rules have equal status sabel 2009 some others argue that the no harm rule becomes part of the rule of equitable and reasonable utilization as a outcome of the principle of equitable utilization of international rivers that has been recognized by courts castillo laborde 2009 in contrast some scholars such as tanzi 2020 conclude that there should be no interpretative difference between two principles and the no harm rule co exists harmoniously with the equitable and reasonable utilization principle he stresses that a use that causes significant harm would be presumed to be inequitable 2 3 2 no harm evaluation the no harm principle as one the key foundations of today s international water law emerges from the roman law maxim do not use your property so as to injure the property of another dellapenna 2006 generally it is recognized internationally that no country may use or permit uses on its territory that cause significant harm in the territory of another state wolfrum 2000 based on this principle all riparian states are mandated to exploit the watercourses in their territory in a way that avoids causing significant harm to other basin states the no harm rule is not only a passive obligation but it also implies the continuous long term proactive and anticipatory engagement of riparian countries to ward off the large scale and apparent incidents as well as the accumulation of small and isolated modifications of water quality and quantity that may generate unanticipated adverse effects tanzi kolliopoulos 2015 in addition to global water conventions and rules including the unece 1992 watercourses convention 1992 helsinki watercourses convention the un watercourses convention 1997 the helsinki rules 1966 and the berlin rules 2004 this fundamental rule has been also included in various regional agreements treaties such as the 1995 southern african development community protocol on shared watercourse systems the 2002 sava river basin agreement the 1996 mahakali river treaty and the 1998 convention on cooperation for the protection and sustainable use of the waters of luso spanish river basins the 1998 albufeira convention between spain and portugal as well as the 1996 mekong agreement moreover it also has been explicitly or implicitly acknowledged by international environmental conventions and declarations including the 1972 stockholm declaration of the un conference on human environment the 1971 ramsar convention the 1992 rio declaration on environment and development and the 1992 convention on biological diversity more details about these are available from rahaman 2009 mianabadi et al 2015 birnie and boyle 1994 unece water convention 1992 and salman 2019 a significant challenge facing international water governance in general and international water law in particular is the diversity of the geographic climatic hydrological and socio economic conditions along shared river basins wehling 2020 besides the definition and understanding of harm has been evolving over time tignino and bréthaut 2020 it is also noteworthy that due to diversity of the geographic climatic hydrological and socio economic conditions wehling 2020 uncertainty regarding the precise normative implications of the key substantive rules and principles of international water law mcintyre 2020 as well as complex and coupled human natural nature of transboundary water systems international legal obligations are often open ended so that they can be applied to different contexts globally although the explicit definition of no harm principle remains rather vague the international court of justice icj as well as other international tribunals and courts have sought to clarify this in their case law such as the trail smelter case in 1941 between usa and canada the lake lanoux case in 1957 between hungary and slovakia the gabcikovo nagymaros dam dispute in 1997 between france and spain the pulp mills case in 2010 between argentina and uruguay the indus waters kishenganga arbitration in 2013 between pakistan and india and the san juan river cases in 2015 and 2018 between nicaragua and costa rica generally no harm evaluation is one of the most complex and controversial issues in international water law because tignino and bréthaut 2020 1 this obligation includes both qualitative and quantitative aspects that are difficult to assess comprehensively 2 the lack of consensus on a comprehensive definition of no harm mianabadi et al 2015 caused the language and terms used to refer to the obligation and to the concept of harm to vary tignino and bréthaut 2020 from significant harm art 7 to significant adverse effects art 12 and effects detrimental art 22 in the un watercourses convention 1997 salman 2019 the no harm rule covers different dimensions including intra inter states intra inter generations spijkers 2016 and contains a high degree of flexibility and adaptability and suffers from a corresponding degree of normative indeterminacy mcintyre 2020 besides understanding the nature of the no harm principle is a normative problem so in the practice of dispute settlement mechanisms new norms might be created within particular subject matter tignino and bréthaut 2020 or the same norm might be applied in distinguished ways across subject matters sands 1998 accordingly the identification of specific aspects and dimensions of each basin for no harm evaluation may be different case by case evaluation of the no harm rule as a customary international law and a normative and evolutionary principle over time is complex as stressed earlier the normative notion of harm should be understood and materialized as the result of an evolving and incremental process that depends on various contextual factors tignino and bréthaut 2020 normative uncertainties as well as ecological hydrological climate demographic economic social political cultural and religious differences between transboundary watercourses have tended to obscure the effective parameters in the practical implementation of the no harm principle in international water law mcintyre 2020 the mutual understanding of the no harm principle in complex transboundary water systems considerably depends on various coupled human natural dimensions and dynamic socio politico ecological variables in the field of international water law global regional and basin level conventions have tended to address a range of problems such as maintenance of minimum flow requirements prevention of transboundary impact on the economy of inhabitants including fishing and agriculture and the protection of water quality as well as public human health thereby providing an extensive and diverse range of species of harm mcintyre 2020 furthermore the exploration of emblematic cases law on international watercourses elucidates that the decisions judgments and awards adopted by the icj and arbitral tribunals consider the harm not only in the light of geopolitical and international concerns but also by taking into consideration other types of narratives such as concerns at regional and or local levels tignino and bréthaut 2020 it is also noteworthy that the obligation to prevent harm is not limited to the direct use of water by one riparian party in a watercourse that causes harm to another riparians use for instance activities in one riparian state that are not directly related to a watercourse e g deforestation may have harmful effects in downstream riparian state e g flooding mccaffrey 2001 assessment of the conventions treaties and agreements as well as the decisions judgments and awards adopted by the icj and international arbitral tribunals and courts listed earlier mainly shows the considered harms mainly refer to three key points namely the environment human health or safety and the economy however their interconnection is also not well defined this is also reported by shelton 2002 about international concerns with human rights health and environmental protection and how they are isolated from one another therefore it is crucial to develop platforms to evaluate them in an integrated way as it was considered in this study 2 3 3 quantification of harm in the helmand river basin case study for the objectives of this study and considering the human natural dimensions and characteristics of the study area direct and indirect parameters and indicators were selected with which to evaluate the three categories of harm environment human health and economy as a consequence of changes in river flow from the helmand river these are h1 hydrological parameters for environmental flow clearly interference with the environmental flow of an international watercourse could be regarded as having caused significant harm in which has been also recognized in the kishenganga arbitration 2013 para 454 and the san juan river cases 2015 paras 105 and 119 mcintyre 2020 the value of ecosystem and environmental services of transboundary watercourses has been also clearly recognized by the icj in the joined san juan river cases in 2015 and 2018 between nicaragua and costa rica tignino and bréthaut 2020 this judgment of the icj heralds a new era for the no harm rule in the field of international water law mcintyre 2020 it has been also recently determined by the icj that damage to the environment and the consequent impairment or loss of the ability of the environment to provide goods and services is compensable under international law mcintyre 2020 as mentioned earlier the helmand river is the main source of water for lake hamoun which is an international transboundary wetland located in the sistan area and was designated as a protected site under the ramsar convention in 1975 hence the vitality of hamoun lake as the main life and environmental resource in the great sistan area depends on high flows and floods from the helmand river whitney 2006 the effects of changed environmental river flow regimes on human well being in the sistan inland delta was studied by meijer and hajiamiri 2007 the results of the developed conceptual model for linking human well being and environmental river flows in the hamoun wetlands in iran reveal that change in environmental river flow of the helmand river can affect income food and physical health of inhabitants in the region meijer and hajiamiri 2007 accordingly features representing the hydrological regime of helmand river such as the magnitude duration timing and frequency of extreme flows iha parameters were considered and evaluated h2 effect of dust storms on human health investigation of international case law reveals that judges imply the fact that harms concern ecosystem services in the broad sense tignino and bréthaut 2020 for instance the 1992 unece water convention expressly requires riparian states to apply the ecosystems approach article 3 1 i and defines the transboundary impact that the parties are to take all appropriate measures to prevent control and reduce article 2 1 to include effects on human health and safety flora fauna soil air water climate landscape or the interaction among these factors article 1 2 mcintyre 2020 besides transboundary air pollution has been considered transboundary harm caused by uses of water resources in the trail smelter arbitration case in 1941 between usa and canada in which often cited as the origin of the no harm rule and the first arbitral award in international environmental law tignino and bréthaut 2020 dust storms are a serious threat to the people of both countries on the sistan plain the combination of natural strong winds and water cover of the lakes hamoun provide a kind of natural air conditioning while the same strong winds with drying and empty hamouns result in severe sand storms affecting the health of the inhabitants van beek et al 2008 the drying out of the hamoun wetlands is the main source of dust storms in southwest asia miri et al 2010 with the onset of a long period of drought in the mid 1990 s and extension of agricultural areas in the middle helmand basin hajihosseini et al 2019 the wetlands began to dry up and the intensity and frequency of dust storms increased significantly rashki et al 2013 the characteristic winds in the lower helmand basin which occur from may to september locally called winds of 120 days exacerbate the situation as shown in fig 1 the wind blows steadily from the northwest iran to the east afghanistan whitney 2006 the severity of the dust storms is recorded by ground meteorological stations and satellite imagery the daily ground records from zabol station for 1991 to 2012 were used in this study here a dust storm event dst was characterized as wind velocity greater than 15 m sec and visibility vis 1000 m miri et al 2009 h3 wheat production as an economic indicator obviously any material interference with or loss of ecosystem services provided by the riverine ecosystem of a shared watercourse such as public health industry property agriculture or the environment may amount to actionable significant harm mcintyre 2020 the economy of the sistan inland delta is strongly dependent on agriculture irrigated and non irrigated and the goods and services provided by the river and wetlands van beek and meijer 2006 in downstream iran the sistan inland delta s agro ecological system is 96 dependent on surface water coming from afghanistan thomas and varzi 2015 the majority of people in the sistan are employed in agriculture and suffering from the severe water shortage loss of income and dust storms pushed the rural community to leave the area and emigrate to other places mianabadi et al 2020 the lakes hamoun are vital for all people living in the delta and provide goods and ecological services not only for rural population farmers and fishermen but for the whole residents thomas and varzi 2015 van beek et al 2008 a considerable reduction in the water of the lakes hamoun would not only harm the ecological functioning of the lake h1 it would also endanger and exacerbate the livelihoods of the residents depending on the products and eco services of this system thomas and varzi 2015 to evaluate this type of harm wheat production on the iranian side of sistan plain as the most important agricultural product in the region was used as the indicator because it depends fully on the streamflow from the helmand river the annual wheat production records were provided by the sistan and baluchistan agricultural organization iran 2 4 conceptual modeling framework the methodology followed for this study is presented in fig 2 initially swat was used to provide the basic information on daily flows this information was entered into the iha model to calculate the streamflow characteristics and evaluate possible environmental harm h1 and correlate streamflow with dust storm events dst and visibility vis 1000 m to evaluate human health harm h2 the simulated streamflow was applied to estimate economic harm h3 through its correlation with regional wheat production char burjak station was selected as the reference station because of its proximity to kamal khan dam fig 2 integrated framework for determining impact of human activity and climate variability on the helmand river basin from no harm perspective iha rva dst and vis stand for indicators of hydrologic alteration environmental flow components range of variability approach dust storm events and visibility 2 4 1 swat swat arnold et al 2012 was applied to simulate streamflow as the hydrologic cycle on a land surface based on the water balance as 1 sw t sw 0 i 1 t r day q surf e a w seep q gw i where swt is the final soil moisture content mm h2o sw 0 is the initial soil moisture content on day i mm h2o t is time days rday is the total precipitation on day i mm h2o qsurf is the surface runoff on day i mm h2o ea is the evapotranspiration on day i mm h2o wseep is the volume of water entering the unsaturated zone from soil profiles on day i mm h2o and qgw is the groundwater recharge amount on day i mm h2o the model subdivides each basin into several sub basins and then each sub basin into several hydrological response units hrus each hru incorporates uniform land use soil properties and slope which makes the model flexible for handling different management scenarios jain et al 2010 2 4 2 iha description the iha has been extensively used to evaluate the eco hydrological effects of a streamflow regime caused by alterations in river management yang 2016 it uses a number of parameters which are subdivided into iha and environmental flow components these have been classified into five groups as shown in table 2 with their respective parameters and explanation of their influence on ecosystems further description is available in the nature conservancy 2009 the 33 iha parameters vary for current conditions and future eco hydrological conditions according to external such as climate change or internal such as dam construction change richter et al 1997 1996 introduced the range of variability approach rva here we applied the 25th and 75th percentile values for each of the parameters to indicate target ranges in rva if the variability results in significant hydrologic alteration ha that produce a parameter value outside the rva range it means that the system has changed state and conditions are not normal the hai is estimated as follows 2 ha i n o n e n e 100 where no is the observed frequency of iha parameter i falling within the target range before the dam construction and ne is the targeted frequency after the dam construction the overall degree of change hao of a river can be calculated as 3 ha o 1 33 i 1 33 ha i 2 when ne values falling within the rva target range equals no it means ha is zero i e no hydrologic alteration but negative positive values indicate that the considered parameter fall inside the rva boundaries less more often than expected the degree of hydrologic alteration is identified in one of three categories of equal size including low 0 to 33 moderate 33 to 67 and high 67 to 100 duan et al 2016 another relevant index is relative difference rd it is calculated as follows 4 rd i mdn m d a mdn 100 where mdn and mda are the median of iha parameter i before and after impact respectively e g before and after the dam construction zheng et al 2020 3 results 3 1 setup of swat the types of harm were evaluated as possible consequences of the development of kamal khan dam and the relationship between their respective indicators parameters and the helmand streamflow were evaluated the daily simulated streamflow at the adjacent char burjak station fig 1 was applied and the modeling setup and calibration were based on this station 3 1 1 model parametrization to prepare swat for simulation of the helmand river at char burjak station the upper basin was divided to 15 sub basins and 106 hrus the parameters for each of the main components of the model included plant dat soil science sol groundwater gw management mgt and river rte parameters and were based on the available data and the results of previous studies by hajihosseini et al 2016 and hajihosseini et al 2019 the next steps were sensitivity analysis of the model parameters and calibration and uncertainty analysis of the model performed using the swat cup model abbaspour et al 2015 and the sequential uncertainty fitting algorithm sufi 2 table 3 shows the initial range and final values and ranks of the parameters p value and t stat the parameter with the greatest t stat value and a p value approaching zero had the greatest effect on the simulation of river flows parameters cn2 and alpha bf were the most sensitive and had an effect on the fractions of surface runoff and groundwater in the streamflow 3 1 2 model calibration using global datasets for climate soil and land use table 3 as well as swat cup the model was calibrated using the observed monthly discharge data from char burjak station for 1968 to 1978 only available data the first four years were used for calibration and the remainder for validation the results were deemed satisfactory at r2 0 62 and ns 0 65 for calibration and r2 0 61 and ns 0 64 for validation 3 2 historical evaluation of streamflow the calibrated swat approach was used to simulate the long term streamflow of helmand river the average monthly flows for the observed period 1968 1978 and simulation period 1968 2012 are shown in table 4 the results for the non parametric mann kendall trend mann whitney homogeneity before and after year 2000 and pettitt abrupt change methods were applied to the observed monthly flows to evaluate non stationary changes none of the tests showed a statistically significant change in the time series streamflow at a 5 confidence level 3 3 modeling regional harm components as it was already stated and shown in fig 2 environmental health and economic harms h1 to h3 were taken into account in this study these harms could be either direct or indirect consequences of a decrease in helmand water inflows downstream in the basin thus possible correlations between the selected harms and the helmand inflows were investigated the simulated daily streamflow of char burjak from swat for the period of 2000 to 2012 was applied for further analysis representation of helmand inflows 3 3 1 helmand streamflow and environment the simulated daily streamflow at char burjak station was used as input for the iha the results for the median of historical status of 33 iha parameters are shown in appendix a the ecosystem influences of these changes are already explained in the section 2 4 2 fig 3 also shows some of the parameters relating to groups 1 and 2 table 2 these groups emphasize more the characteristics of river discharges they are important for some of the ecosystem processes such as availability of water for terrestrial animals reliability of water supplies for terrestrial animals and physical habitat conditions the nature conservancy 2009 the figure reveals that april and may had the highest monthly flows notably the difference between the 1 day max and 90 day max was not high which can be attributed to less variability of the discharges during high flows from another point of view a high difference between the minimum and maximum flows of the river is illustrated 3 3 2 helmand streamflow and dust storm fig 4 shows the relationship between the daily recorded dst and vis 1000 m at zabol station and the simulated streamflow at char burjak station a discharge of 250 m3 sec provided the necessary conditions for an increase in occurrence of dust storm events i e dst and vis 1000 m thus it was defined as the threshold for detection of potential health harm underlying problems and health challenges were not limited to the iranian side wind direction poses a serious challenge to the afghanistan side as well 3 3 3 helmand streamflow and wheat production wheat as the major crop was selected as the indicator of economic harm in the iran part of sistan plain fig 5 shows the correlation between annual streamflow at char burjak station and annual production of wheat throughout the plain for 1990 to 2011 at r2 0 69 1 significance 5 p w 4 482 q ch 10580 where pw is the annual wheat production ton yr and qch is the annual discharge million cubic meters mcm from helmand river at char burjak station of course there is uncertainty with this equation however it is not considered in this study the same approach is also applied by mkhabela et al 2010 to assess indicators of agricultural drought impacts on spring wheat yield and quality on the canadian prairies 3 4 operation of kamal khan dam although the dam is not yet operational the reports reviewed for this study indicate that the diversions listed below should be considered 3 4 1 diversion for agricultural development dad the agricultural area of nimruz province in afghanistan has about 80 000 ha under irrigation and the target area after the dam has become operational is 174 000 ha nwara 2017 an increase of 94 000 ha the recommended cropping pattern is not clearly defined however reports exist on the optimum cropping pattern for the sistan plain ab khak consultant engineering 2017 this includes the cultivation of wheat barley canola watermelon cucumbers hay eggplants grapes and olives the fao study on water availability and uses in afghanistan river basins fao 2015 reports the helmand basin s current situation crops such as rice which are high in water consumption have been eliminated table 5 shows the required monthly diversion from helmand river according to this report the maximum monthly diversion is for may and is 129 25 m3 sec rameen 2017 reports that the capacity of dam diversion for agricultural land is 150 m3 sec the maximum monthly diversion is for may and is 129 25 m3 sec considering this value and 174 000 ha of total irrigation area its irrigation hydro module would be 0 75 l s ha the reported value for the iran side of sistan plain is 0 8 l s ha ab khak consultant engineering 2017 thus the estimations appear to be reasonable and in places lower than the targeted amounts 3 4 2 diversion for flood protection dfp flood protection is another objective of the dam the threshold for water diversion from the river to avert flooding is the bankfull discharge this term refers to the stage at which water overflows onto the floodplain edwards et al 2019 many factors affect the bankfull discharge however for many rivers it can be approximated with a recurrence interval for an annual flood series of 1 5 years dunne and leopold 1978 castro and jackson 2001 this threshold was used in the current study the annual maximum daily flow simulated by swat for char burjak station av 339 1 m3 sec and sd 170 8 m3 sec were applied to estimate the bankfull discharge i e 1 5 years return flows this was estimated to be 250 m3 sec using the gumbel distribution it was assumed that the kamal khan dam will be able to divert 100 m3 sec of river flow for floods of greater than 250 m3 sec for protection of the downstream area higher diversions would need huge investments this amount will be diverted through khoshk and biyabanal rivers which flow into gowd e zarreh fig 1 they are historical paths for the helmand river whitney 2006 of course the current design of the dam can divert flows lower than the bankfull discharge to gowd e zarreh too however such an operation will definitely have more negative impacts on the river environment using the daily simulation of swat and applying the dad and dfp rules the annual helmand river flow after the dam site is estimated to decrease up to 30 3 5 harm assessment of diversion from river by the kamal khan dam using swat and iha 3 5 1 environmental impact changes in the values of the iha and their respective parameters were evaluated and compared with the respected dad and dfp values based on ha eq 2 and rd eq 3 criteria fig 6 fig 6 a shows high hydrological alterations of the parameters of group 1 table 2 more significant has are seen during the winter and spring months which are continuously around 30 this is due to the expected higher irrigation during cropping season in dad scenario the impact of dfp flood control scenario is more visible in the group 2 fig 6 a while this is the intended outcome of flood control this type of flow also has an important effect on saving water for the hamoun fig 6 b shows the changes in the parameters using rd which is based on the medians it can be clearly seen that almost all of the indicators are drastically changed 3 5 2 economic impact using eq 4 for wheat production on the iranian side and the annual flow at char burjak station based on the discharge simulations of swat for the dad and dfp of kamal khan dam reveals significant economic losses fig 7 shows that the estimated changes would decrease the current 12 000 ton yr of wheat production to 3 850 ton yr the planned expansion in afghanistan from 80 to 174 thousand ha comes at the expense of existing production in iran 3 5 3 health impact fig 4 and the relation between dst and vis 1000 m at different discharge rates based on daily discharge simulations of swat were used to estimate the revised discharge rates after operation of the dam dad dfp as shown in fig 8 a linear proportional relationship has been assumed between the changes in the discharge and frequency of dst and vis 1000 m it was concluded that the frequency of dst and vis 1000 m would increase by 15 09 and 15 16 respectively 3 5 4 integrated evaluation of harms an integrated evaluation of the model outputs was used in this study to estimate the average relative change for the parameters of each harm type h1 to h3 these are shown in table 6 the overall change of hydrologic alteration for each of the 33 iha parameters were applied to determine the status of environmental harm i e hao in eq 3 also the same classification i e low 0 to 33 moderate 33 to 67 and high 67 to 100 is also applied to show the level of harms as seen harm to health is predicted to be at a low level i e dst and vis 1000 m are lower than 33 of course dust storms are already a serious health problem for inhabitants of both riparian sides of the sistan plain therefore the current health situation will be worsening the afghanistan meteorological department reports that they cause skin and eye irritation conjunctivitis and can enhance susceptibility to ocular infection 1 1 http www amd gov af sand and dust stormsen similar reports are available from iran miri et al 2009 therefore the situation will get worse even in afghanistan environmental harm will be at a moderate level due to 53 65 and 21 41 negative changes in hao and rd indicators respectively same as before the region s environment is already in a critical situation and the new diversions will further devastate it hamoun international wetlands will be the major target of this type of harm as the well being of the helmand river and hamoun habitats decline they will become sources of dust storms which will be harmful to both sides and increase international concerns about the hamoun wetlands as shown before wheat production as an indicator for economic harm could decrease up to 70 and causes negative impacts on livelihoods and economic income of the local people in the iran side of sistan plain it is necessary to emphasize that this analysis has not weighed this harm against the equitable and reasonable utilization of the riparian state afghanistan and has not evaluated whether this might legally still constitute reasonable and equitable utilization doing so would require additional investigations see e g kampragou et al 2007 and avarideh et al 2017 to sum up from the perspective of the un watercourses convention 1997 despite the recognition of the principle of equitable and reasonable utilization the occurrence of significant harm appears as a factor for the determination of the equitable character of a shared water utilization tanzi 2020 tanzi 2020 illustrates his argument by the hypothetical example given by the ilc 1994 that a dam which would provide hydroelectric power to hundreds of thousands of people but which would cause significant harm to a few hundred people in another riparian state whose recreational fishing would be destroyed ilc 1994 furthermore based on the limited territorial sovereignty principle riparian states are entitled to use their own watercourse in transboundary river basins in a way that does not have an undesirable impact on the other riparian states kotkasaari 2008 accordingly and with regard to the results of the applied model all the appropriate measures should be taken to anticipate and to prevent or mitigate such harm in the transboundary river basin 4 discussion and conclusion the no harm principle and integration of environmental issues in water management are covered extensively by international water and environmental law the term no harm also appears frequently in international transboundary conventions and agreements however the quantification of this term is challenging in the current study a methodology was developed to quantify this term specifically when the data and information are insufficient which is primarily based on global climate databases and public domain models no doubt comprehensive consensus building on understanding and grasp such a contested and evolving nature is so difficult hence this research does not argue that it develops a standard or considers all qualitative and quantitative aspects and dimensions for no harm assessment in transboundary river basins due to the complexity of coupled human water systems the definition and understanding of harm is a co evolutionary process so such efforts fulfilled in this study can be seen as the first steps towards the quantitative evaluation of the no harm rule in international transboundary watercourses nevertheless this model is able to take into account some main quantitative attributes for harm evaluation in the shared watercourses systems with regard to three main categories of harm which have been recognized by international transboundary conventions and icj as well as other international tribunals and courts it is emphasized again that this article is not in a position to be willing or able to make a definite judgement the exploitation of kamal khan dam on the transboundary helmand river has been applied as a case study for the proposed approach the following conclusions were drawn 1 international water treaties and agreements as well as the decisions judgments and awards adopted by the icj and international arbitral tribunals and courts generally assess three types of harm health environment and economic the proposed framework was adjusted to quantify these types of harm 2 an integrated model was developed to quantify and assess harm in transboundary river basins when data and information is insufficient due to poor infrastructure limited meteorological monitoring systems and political instability in riparian states 3 swat and the global cru dataset were combined with the iha to develop a useful framework to simulate river flow and its environmental characteristics this helped to address the scarcity inaccessibility of data and information on the study area 4 the predicted diversions for agriculture and flood protection substantially reduce discharge with drastic impact on the flow characteristics of the river and the survival of hamoun international wetlands of course flood is a challenge in the sistan plain and joint programs for flood control should be developed by iran and afghanistan in which both people and ecosystem especially hamoun as the main source of dust storms are considered 5 the health harm was evaluated using the number of days with dust storms dst and visibility of 1000 m vis 1000 m the results estimate that new diversions will increase dst and vis 1000 m about 15 and 28 respectively the entire sistan plain regularly experiences serious dust storm events the dry bed of the hamoun wetlands is the major source of dust in the region 6 environmental harm has been predicted to be moderate for the 33 hydrological iha parameters the respective results were 38 1 decreases in the parameters 7 economic harm has been quantified by wheat production the simulation shows decrease of about 70 in wheat productions on the iranian side the change relates to the similar cropping calendar for the sistan plain between iran and afghanistan and the decrease in flow especially during april and may 8 it is not the purpose of this study to argue against development in the upper catchments rather it attempts to show how such development can eventually shift an upstream problem e g lack of agriculture production to downstream areas or create new problems upstream an example of this relates to exacerbating of the health problem due to more frequent dust storms 9 the hydrological modeling for any catchment is associated with intrinsic uncertainties due to different factors reichert et al 2020 moreover the exchange of data and information in transboundary river basins is often problematic bitew and gebremichael 2011 which exacerbates these uncertainties despite such limitations the capacities of hydrological simulations and global databases should be considered for better evaluations of possible violation of the international laws as they were applied in this study for harm through an integrated framework 10 the scope of this study was the principle of no harm and other principles like reasonable and equitable utilization need to be addressed for more comprehensive evaluation of the kamal khan dam under the un watercourses convention 1997 the obligation not to cause significant harm implicitly appears through the duty to prevent pollution and the mechanism of prior notification and consultation related to infrastructures and project construction tignino and bréthaut 2020 the road to water cooperation and conflict management in transboundary river basins in general and the helmand river basin in particular will be paved by mutual fact finding and trust building one potential opportunity involves joint analysis of potential changes in wheat production across both countries for this purpose using quantitative evaluation models such as developed in this research can be seen as the first step towards mutual fact finding and trust building participatory monitoring and evaluation can be considered as another significant tool to enhance the management of international environment and transboundary river basins furthermore the recognition of the duty to carry out cooperative transboundary environmental impact assessment eia helps eliminate or mitigate the harm and prevent control and reduce any undesirable transboundary impact unfortunately no cooperative and transboundary eia study has been conducted on this dam so far besides the obligation of prior notification as a principle of international water law and an instrument of water diplomacy schmeier 2020 can play a key role in cooperation in the prevention of harm and protection of the environment of transboundary water resources prior notification was not made for this dam but in general can give riparian state s the opportunity to cooperate together on the potential impacts of that project by exchanging data and information needed to mitigate potential harm and conflict over that project this principle can also lead to consultation and trust building between notified riparian state s and ensuring that one riparian country does not intend to harm other riparian countries it can seriously mitigate riparians concerns and potential conflict regarding the consequential harm of that project no doubt prior notification about planned measures and their potential impacts can help riparian parties to prevent control and reduce any adverse transboundary effects last but not the least integrated water resources management integrated flood and drought management plans and depoliticization of the hirmand water interactions for preventing political frictions as well as the nexus approaches can be other preferred solutions to address these issues fortunately positive steps including signing the agreement for shared data collection and monitoring have been taken in this regard 2 2 https tolonews com afghanistan kabul tehran accord joint cooperation document imminent long standing comprehensive cooperation between iran and afghanistan is an example of this funding this research did not receive any specific grant from funding agencies in the public commercial or not for profit sectors declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement the authors would like to express their sincere gratitude to dr joseph guillaume as associate editor and the anonymous referees for their helpful comments and constructive suggestions appendix a medians of 31 iha parameters in the helmand river at char burjak station under natural condition as well as dad diversions for agriculture sector and joint dad and dfp flood control scenarios medians rva boundaries medians rva boundaries ihas natural dad dad dfp low high ihas natural dad dad dfp low high group 1 m3 s group 2 m3 s january 132 9 100 6 100 6 119 1 138 9 1 day max 346 3 291 2 245 8 326 8 507 7 february 166 4 117 6 117 6 151 1 174 8 3 day max 320 8 272 4 222 8 326 1 479 1 march 154 5 102 8 102 8 163 2 221 3 7 day max 274 5 255 4 208 5 304 2 447 3 april 212 3 135 8 135 8 209 9 356 9 30 day max 259 1 220 6 197 7 263 3 425 3 may 223 2 173 4 156 2 257 8 346 2 90 day max 206 2 165 0 160 0 222 2 353 5 june 120 161 3 157 8 145 9 219 9 base flow index 0 36 0 17 0 18 0 36 0 45 july 114 2 95 7 95 74 107 4 135 7 group 3 julian day august 87 89 72 2 72 24 88 26 107 3 date of min 279 311 5 311 5 281 313 september 77 02 64 8 64 84 76 0 92 58 date of max 74 60 5 60 5 52 44 98 78 october 68 18 70 39 70 39 70 82 100 0 group 4 november 65 21 31 19 31 19 62 89 85 7 low pulse count 2 3 3 1 2 78 december 106 7 78 9 78 9 80 99 116 5 low pulse duration day 84 5 25 25 25 25 18 9 43 16 group 2 m3 s high pulse count 2 2 3 2 3 1 day min 47 17 7 17 7 55 71 68 3 high pulse duration day 7 6 4 5 7 57 63 51 3 day min 47 75 17 9 17 9 56 08 68 96 group 5 7 day min 50 22 19 17 19 17 56 20 70 06 rise rate m3 s 0 72 0 79 0 72 0 88 0 72 30 day min 55 46 21 24 21 24 58 63 75 59 fall rate m3 s 0 89 1 04 1 26 0 90 1 26 90 day min 71 99 53 89 53 89 71 49 96 06 number of reversals 152 148 145 152 8 145 appendix b rules for the dam operation diversion for agriculture development dad n 1 to 33 the entire records of 33 years at charborjak station j 1 to 12 month and i 1 to 365 julian day qdn i daily flows of swat simulation q irn j daily water requirement for the new agriculture development based on table 5 q dadn i daily flows at dad scenario qdn i q irn i and if 0 then qdadn i 0 q han i daily altered discharge q dadn i diversion for flood protection dfp qmf maximum diversion for flood protection 100 m3 s qbf bankfull discharge 250 m3 s if qdn i qbf then q dfpn i qdn i qmf and if q dfpn i 250 then q dfpn i qbf q han i daily altered discharge q dfpn i diversion for dad and dfp repeat dfp scenario and substitute qdn i with q dadn i if q dadn i qbf m3 s then q dfpn i q dadn i qmf and if q dfpn i qbf then q dfpn i qbf q han i daily altered discharge q dfpn i 
4457,the international legal principle of no harm as a customary international law lies at the heart of numerous international transboundary water conventions rules and agreements the current study identifies and examines the three most common categories of harm namely health environmental and economic in an integrated framework exploitation of the kamal khan dam over the hirmand helmand transboundary river internationally shared between iran and afghanistan has been selected as a case study for this aim an integrated modeling approach that links soil and water assessment tool swat indicators of hydrologic alteration iha dust storm events dst and crop production is developed to simulate the indicators and their parameters under historical conditions and future exploitation of the dam effects on the three types of harm are classified as being low moderate or high the results showed that the effects of the dam diversion for economic harm would be high for instance it could reduce the wheat production of the iranian side of sistan plain up to 70 the hydrological alteration of the river is also significant up to 80 during the winter and spring months this can result in health and environmental harms the region s health and environment are already in a critical situation mainly due to the drying of hamoun wetlands which rely on the inflows of the helmand river and are the major sources of dust storms notably these issues would affect the entire plain in both iran and afghanistan the scope of this study was the principle of no harm but the methodology with some additional modifications could be considered for other principles like equitable and reasonable utilization in transboundary river basins keywords no harm rule transboundary river basin limited territorial sovereignty international water law swat model helmand river basin 1 introduction the complex impacts of human activities on the socio economic political and environmental conditions of riparian countries are of vital importance in transboundary river basins a fundamental challenge in international water conflict management regarding the utilization of shared water resources under international water law is reconciling the sovereignty of one state within its territory on the one hand and the territorial integrity of other riparian countries on the other wehling 2020 the absolute territorial sovereignty which is also known as the harmon doctrine relies on absolute control over national waters this principle concluded that a state is free to use its territory without any restrictions and concern for the harm or adverse impact that such use may cause to other riparian states salman 2007 the opposite doctrine principle of absolute territorial integrity gives the downstream state the absolute right to the continuous flow of a river flowing from the upstream states kotkasaari 2008 today s international water law is based on some global conventions and rules specifically including the 1992 convention on the protection and use of transboundary the watercourses and international lakes the unece 1992 watercourses convention or 1992 helsinki watercourses convention which was adopted in helsinki in 1992 the 1997 convention on the law of non navigational use of international watercourses un watercourses convention 1997 which was adopted in new york in 1997 the 1966 helsinki rules on the uses of the waters of international rivers helsinki rules 1966 and the berlin rules on water resources berlin rules 2004 the mentioned global conventions as the modern international water law are based on the theories of limited territorial sovereignty and the community of interest the idea of limited sovereignty is contained in the equitable and reasonable utilization and no harm principles which emphasize that riparian countries should not use their territorial waters in ways that cause damage and undesirable impact to downstream co riparian countries zawahri hensengerth 2012 the current doctrine of limited territorial sovereignty stands in stark contrast to the earlier doctrines the obligation of one state to not cause significant harm to an other state s the no harm rule is one of the most fundamental principles in international water law mccaffrey 2007 nanda and pring 2013 tanzi 2020 this principle has implications for both the allocation of the uses of shared watercourses and for their environmental protection bulto 2009 this principle also is implicitly considered in the ramsar convention 1971 ramsar convention 1971 while international water law has evolved considerably over time to take into account the changes in both the use of international water resources and the understanding of hydrological systems it still does not adequately deal with several significant issues that have increasingly come to the fore wehling 2020 ambiguity in some articles of international water law has been mentioned as a major factor causing conflict among riparian countries and the failure of international water laws to manage international water disputes mianabadi et al 2015 for instance in the case of the euphrates tigris basin turkey bases its arguments on article 5 while implementing the gap project indicating that it is using the rivers based on equitable and reasonable utilization syria and iraq in contrast base their arguments on article 7 and claim that turkey is causing significant harm to the downstream countries korkutan 2001 this also applies in the case of blue nile water conflict among egypt sudan and ethiopia ansink 2009 the lack of an explicit definition of the principle of equitable and reasonable utilization and the no harm rule and no quantitative attributes and criteria appears to be an ambiguity in these conventions and rules salman 2007 the quantification of the no harm rule remains unclear to some extent van der zaag et al 2002 therefore it does not usually provide operative guidance to riparian countries for international water conflict management the obligation not to cause significant harm remains one of the essential circumstances to be taken into account for establishing whether a shared utilization in transboundary river basins is equitable and reasonable caflisch 1996 a key question remains about the definition and extent of the word harm and significant and how to define or quantify significant harm this issue is pointed out in different studies mianabadi 2016 salman 2019 2007 van der zaag et al 2002 the no harm and equitable and reasonable utilization principles are covered extensively by some global conventions and rules specifically including the unece 1992 watercourses convention the un watercourses convention 1997 the helsinki rules 1966 and the berlin rules 2004 the term of no harm also appears frequently in international transboundary conventions and agreements however quantification of these terms is challenging in spite of the significance of quantification of these fundamental principles of customary international water law little research has attempted to quantify only the principles of equitable and reasonable utilization as stated in the un watercourses convention1997 mimi sawalhi 2003 formulated a procedure for allocating the water resources of the jordan basin between the five riparian countries based on this principle they used a multi criteria decision method using the following nine variables for each basin state 1 the drainage area within the basin 2 climate 3 hydrology 4 historical consumption of water resources 5 socio economic demand 6 the populations dependent upon basin water resources 7 comparative cost of substituting new resources to meet economic and social demand 8 availability of other resources and 9 the degree to which the needs of a basin state can be satisfied without causing appreciable harm to the riparian states kampragou et al 2007 used these variables to evaluate the equitable and reasonable utilization principle for the nesto messi transboundary basin between bulgaria and greece avarideh et al 2017 assessed allocation of water resources in the sirvan deyaleh transboundary basin between iran and iraq using articles 5 to 7 and 10 of the un watercourses convention 1997 the indicators were similar to those suggested by mimi sawalhi 2003 similarly in the case of the no harm rule it has not been yet received enough attention in hydrological and environmental modeling researches no doubt a comprehensive evaluation of criteria and indicators with respect to territorial treaties and customary international water law requires integrated modeling for this purpose exchange of data and information in transboundary basins as a key principle of some landmark international transboundary water conventions including the un watercourses convention 1997 is generally limited by political concerns thu and wehn 2016 aside from political issues data scarcity is another considerable problem in transboundary basins as in the case study addressed in this research data and information is insufficient due to poor infrastructure limited meteorological monitoring systems and political instability to tackle this issue integrated models can be linked with global climate databases to simulate the rainfall runoff of transboundary basins the accuracy of this linkage has been validated in various studies for instance schuol abbaspour 2007 applied the soil and water assessment tool swat andah et al 2003 and climate research unit cru to a global climate database to simulate the volta river basin hajihosseini et al 2016 also applied a similar combination for the upper catchment of the helmand upstream of kajaki dam they evaluated trends in the time series of inflow into the dam and hydrologically assessed the 1973 treaty between iran and afghanistan on exploitation of the helmand river they also compared the cru data with data available from the few existing ground stations the results showed acceptable performance of the cru data and the swat for hydrological modeling of the basin swat does not directly simulate the components of environmental flows to address this deficiency it has been linked to the indicators of hydrologic alteration iha model in a number of research works morid et al 2016 applied this modeling setup for evaluation of habitat suitability on the kordan river in iran under climate change conditions morid et al 2019 did the same for the kikuchi river in japan amongst other uses iha has been applied to assess the impact of dam construction on environmental flows yang 2016 used the iha to evaluate the role of dam construction on the trinity and brazos environmental flows zuo and liang 2015 showed how environmental flows of the shaying river in china will be affected by construction of a dam on this river they reported changes for 1 to 90 day extreme events as well as days with zero stream flow in response to the preceding discussion the aim of the current study is to develop an integrated framework to investigate the no harm rule in hydrological and environmental modeling research for this purpose the swat model is used with iha and global climate databases the construction of kamal khan dam on the transboundary helmand river in afghanistan in construction since 2011 thomas and varzi 2015 has been used as a case study it is a hydroelectric and irrigation dam project as an infrastructural project on the upstream of a transboundary river basin there is a concern that the human and environmental consequences of the construction of this dam on the local inhabitants and the region s environment especially the international hamoun lakes have not been sufficiently considered however the article is not in a position to make any definite judgments the innovation of this study is its methodological approach to quantification of no harm rule as a fundamental principle of customary international water law on transboundary river basins using very limited observed data and public domain models the methods may also have applicability to other rules 2 material and methods 2 1 study area the international basin of the hirmand helmand river is an important water resource that is shared by iran and afghanistan its area is about 353 400 km2 of which 81 4 is in afghanistan and 15 is in iran the helmand river originates in the hindu kush mountains and crosses the sistan plain to lake hamoun these lakes are one of the main and most valuable aquatic ecosystems in the region and are registered wetlands in the ramsar and unesco biosphere reserve conventions van beek and meijer 2006 the hamoun lake ecosystem is a highly dynamic ecosystem and its system depends on the discharge of the hirmand river and a few smaller rivers but the flow differs greatly between years penning and beintema 2006 accordingly the size of the hamoun varies both seasonally and yearly greatest development takes place in late spring when snowmelt and seasonal high flows occur in wet years almost each 7 years the overflow from the lake flows southward to gowd i zerreh zerrah depression in afghanistan fig 1 which is usually dry whitney 2006 the river forms about 55 km of the border between iran and afghanistan the sistan plain is shared between southeastern iran sistan and baluchestan provinces and southern afghanistan nimruz helmand and kandahar provinces it has been settled since ancient times and used to be called the breadbasket of western asia however the prosperity of the plain declined in the early 16th century and has not been restored whitney 2006 in spite of signing numerous international water treaties such as the indus river agreement of 1960 the nile river agreement of 1959 and the euphrates river agreement of 1987 water disputes among riparian countries remain or have worsened this is also true for the hirmand helmand river which is shared between iran and afghanistan negotiations for exploitation of its water resources goes back to 1872 dominguez et al 1951 the average annual rainfall of this basin varies from 50 mm in the southwest to 300 mm in the northeast goes et al 2016 the water is primarily used for irrigation on both sides of the border yıldız 2015 some dams have been built on the helmand river and its tributaries the most important of which is the kajaki dam with the total capacity of 1700 mcm the kamal khan dam is the largest hydraulic structure on the helmand river after the kajaki dam fig 1 construction of this dam began in 1996 but was halted due to the civil war the project recommenced in 2011 and phase ii was completed in 2015 work on phase iii began in 2017 the objective has been to provide water for irrigation of agricultural land in the sistan plain afghanistan part flood protection drinking water and generation of 9 mw of electricity ariananews 2020 2 2 data and information data and information exchange in transboundary watercourses is considered as a fundamental component of long cooperative history over shared basins and a key principle of some conventions such as the 1997 un convention gerlak et al 2010 this issue has been stated as a usual problem in other research works bitew and gebremichael 2011 moreover the study suffers shortage of infrastructure for measuring hydro meteorological variables to address these challenges the case study made use of different public information judged to be sufficiently valid hydrological modeling requires rainfall temperature and streamflow data a digital elevation model and land use and soil maps they are prepared from different sources the recorded climate data period was very short thus global cru was used to compensate for this deficiency hydrological data covering 1968 to 1978 was collected from char burjak station 30017 latitude 62002 longitude near the kamal khan dam table 1 lists the information layers collected to run the models in the study area 2 2 1 cru database the cru is a widely applied climate dataset that uses extensive networks of weather station observations it offers high spatial resolution 0 5 0 5 in this study ts version 3 21 was used http www cru uea ac uk the accuracy and performance of cru for the study area has been reported by hajihosseini et al 2016 because cru data is produced monthly and daily data is required for input into swat the dgen algorithm schuol and abbaspour 2007 was used as applied by anoh et al 2018 and fadil et al 2011 2 3 definition of harm in international transboundary conventions 2 3 1 interrelationship between no harm and equitable and reasonable utilization principles the principle of equitable and reasonable utilization and the no harm rule lie at the core of international water law mccaffrey 2007 the inter relationship between these two core pillars has long been the most controversial issue in international water law the principle of equitable and reasonable utilization as a part of customary international law is based on the idea that transboundary watercourses must be used in such a manner that every state has an equal right to an equitable share of the uses of a watercourse and the benefits derived from it with regard to its use within their territory wehling 2020 this principle also does not only focus on the quantitative allocation of water resources between riparian states but also encompasses the manner of that use wehling 2020 hence this principle as a holistic concept incorporates aspects of both allocation and protection of the shared waters mccaffrey 2007 there are different views on the relationship between these two principles some believe that according to the arts 12 and 16 of the international law association 2004 the no harm and the equitable utilization rules have equal status sabel 2009 some others argue that the no harm rule becomes part of the rule of equitable and reasonable utilization as a outcome of the principle of equitable utilization of international rivers that has been recognized by courts castillo laborde 2009 in contrast some scholars such as tanzi 2020 conclude that there should be no interpretative difference between two principles and the no harm rule co exists harmoniously with the equitable and reasonable utilization principle he stresses that a use that causes significant harm would be presumed to be inequitable 2 3 2 no harm evaluation the no harm principle as one the key foundations of today s international water law emerges from the roman law maxim do not use your property so as to injure the property of another dellapenna 2006 generally it is recognized internationally that no country may use or permit uses on its territory that cause significant harm in the territory of another state wolfrum 2000 based on this principle all riparian states are mandated to exploit the watercourses in their territory in a way that avoids causing significant harm to other basin states the no harm rule is not only a passive obligation but it also implies the continuous long term proactive and anticipatory engagement of riparian countries to ward off the large scale and apparent incidents as well as the accumulation of small and isolated modifications of water quality and quantity that may generate unanticipated adverse effects tanzi kolliopoulos 2015 in addition to global water conventions and rules including the unece 1992 watercourses convention 1992 helsinki watercourses convention the un watercourses convention 1997 the helsinki rules 1966 and the berlin rules 2004 this fundamental rule has been also included in various regional agreements treaties such as the 1995 southern african development community protocol on shared watercourse systems the 2002 sava river basin agreement the 1996 mahakali river treaty and the 1998 convention on cooperation for the protection and sustainable use of the waters of luso spanish river basins the 1998 albufeira convention between spain and portugal as well as the 1996 mekong agreement moreover it also has been explicitly or implicitly acknowledged by international environmental conventions and declarations including the 1972 stockholm declaration of the un conference on human environment the 1971 ramsar convention the 1992 rio declaration on environment and development and the 1992 convention on biological diversity more details about these are available from rahaman 2009 mianabadi et al 2015 birnie and boyle 1994 unece water convention 1992 and salman 2019 a significant challenge facing international water governance in general and international water law in particular is the diversity of the geographic climatic hydrological and socio economic conditions along shared river basins wehling 2020 besides the definition and understanding of harm has been evolving over time tignino and bréthaut 2020 it is also noteworthy that due to diversity of the geographic climatic hydrological and socio economic conditions wehling 2020 uncertainty regarding the precise normative implications of the key substantive rules and principles of international water law mcintyre 2020 as well as complex and coupled human natural nature of transboundary water systems international legal obligations are often open ended so that they can be applied to different contexts globally although the explicit definition of no harm principle remains rather vague the international court of justice icj as well as other international tribunals and courts have sought to clarify this in their case law such as the trail smelter case in 1941 between usa and canada the lake lanoux case in 1957 between hungary and slovakia the gabcikovo nagymaros dam dispute in 1997 between france and spain the pulp mills case in 2010 between argentina and uruguay the indus waters kishenganga arbitration in 2013 between pakistan and india and the san juan river cases in 2015 and 2018 between nicaragua and costa rica generally no harm evaluation is one of the most complex and controversial issues in international water law because tignino and bréthaut 2020 1 this obligation includes both qualitative and quantitative aspects that are difficult to assess comprehensively 2 the lack of consensus on a comprehensive definition of no harm mianabadi et al 2015 caused the language and terms used to refer to the obligation and to the concept of harm to vary tignino and bréthaut 2020 from significant harm art 7 to significant adverse effects art 12 and effects detrimental art 22 in the un watercourses convention 1997 salman 2019 the no harm rule covers different dimensions including intra inter states intra inter generations spijkers 2016 and contains a high degree of flexibility and adaptability and suffers from a corresponding degree of normative indeterminacy mcintyre 2020 besides understanding the nature of the no harm principle is a normative problem so in the practice of dispute settlement mechanisms new norms might be created within particular subject matter tignino and bréthaut 2020 or the same norm might be applied in distinguished ways across subject matters sands 1998 accordingly the identification of specific aspects and dimensions of each basin for no harm evaluation may be different case by case evaluation of the no harm rule as a customary international law and a normative and evolutionary principle over time is complex as stressed earlier the normative notion of harm should be understood and materialized as the result of an evolving and incremental process that depends on various contextual factors tignino and bréthaut 2020 normative uncertainties as well as ecological hydrological climate demographic economic social political cultural and religious differences between transboundary watercourses have tended to obscure the effective parameters in the practical implementation of the no harm principle in international water law mcintyre 2020 the mutual understanding of the no harm principle in complex transboundary water systems considerably depends on various coupled human natural dimensions and dynamic socio politico ecological variables in the field of international water law global regional and basin level conventions have tended to address a range of problems such as maintenance of minimum flow requirements prevention of transboundary impact on the economy of inhabitants including fishing and agriculture and the protection of water quality as well as public human health thereby providing an extensive and diverse range of species of harm mcintyre 2020 furthermore the exploration of emblematic cases law on international watercourses elucidates that the decisions judgments and awards adopted by the icj and arbitral tribunals consider the harm not only in the light of geopolitical and international concerns but also by taking into consideration other types of narratives such as concerns at regional and or local levels tignino and bréthaut 2020 it is also noteworthy that the obligation to prevent harm is not limited to the direct use of water by one riparian party in a watercourse that causes harm to another riparians use for instance activities in one riparian state that are not directly related to a watercourse e g deforestation may have harmful effects in downstream riparian state e g flooding mccaffrey 2001 assessment of the conventions treaties and agreements as well as the decisions judgments and awards adopted by the icj and international arbitral tribunals and courts listed earlier mainly shows the considered harms mainly refer to three key points namely the environment human health or safety and the economy however their interconnection is also not well defined this is also reported by shelton 2002 about international concerns with human rights health and environmental protection and how they are isolated from one another therefore it is crucial to develop platforms to evaluate them in an integrated way as it was considered in this study 2 3 3 quantification of harm in the helmand river basin case study for the objectives of this study and considering the human natural dimensions and characteristics of the study area direct and indirect parameters and indicators were selected with which to evaluate the three categories of harm environment human health and economy as a consequence of changes in river flow from the helmand river these are h1 hydrological parameters for environmental flow clearly interference with the environmental flow of an international watercourse could be regarded as having caused significant harm in which has been also recognized in the kishenganga arbitration 2013 para 454 and the san juan river cases 2015 paras 105 and 119 mcintyre 2020 the value of ecosystem and environmental services of transboundary watercourses has been also clearly recognized by the icj in the joined san juan river cases in 2015 and 2018 between nicaragua and costa rica tignino and bréthaut 2020 this judgment of the icj heralds a new era for the no harm rule in the field of international water law mcintyre 2020 it has been also recently determined by the icj that damage to the environment and the consequent impairment or loss of the ability of the environment to provide goods and services is compensable under international law mcintyre 2020 as mentioned earlier the helmand river is the main source of water for lake hamoun which is an international transboundary wetland located in the sistan area and was designated as a protected site under the ramsar convention in 1975 hence the vitality of hamoun lake as the main life and environmental resource in the great sistan area depends on high flows and floods from the helmand river whitney 2006 the effects of changed environmental river flow regimes on human well being in the sistan inland delta was studied by meijer and hajiamiri 2007 the results of the developed conceptual model for linking human well being and environmental river flows in the hamoun wetlands in iran reveal that change in environmental river flow of the helmand river can affect income food and physical health of inhabitants in the region meijer and hajiamiri 2007 accordingly features representing the hydrological regime of helmand river such as the magnitude duration timing and frequency of extreme flows iha parameters were considered and evaluated h2 effect of dust storms on human health investigation of international case law reveals that judges imply the fact that harms concern ecosystem services in the broad sense tignino and bréthaut 2020 for instance the 1992 unece water convention expressly requires riparian states to apply the ecosystems approach article 3 1 i and defines the transboundary impact that the parties are to take all appropriate measures to prevent control and reduce article 2 1 to include effects on human health and safety flora fauna soil air water climate landscape or the interaction among these factors article 1 2 mcintyre 2020 besides transboundary air pollution has been considered transboundary harm caused by uses of water resources in the trail smelter arbitration case in 1941 between usa and canada in which often cited as the origin of the no harm rule and the first arbitral award in international environmental law tignino and bréthaut 2020 dust storms are a serious threat to the people of both countries on the sistan plain the combination of natural strong winds and water cover of the lakes hamoun provide a kind of natural air conditioning while the same strong winds with drying and empty hamouns result in severe sand storms affecting the health of the inhabitants van beek et al 2008 the drying out of the hamoun wetlands is the main source of dust storms in southwest asia miri et al 2010 with the onset of a long period of drought in the mid 1990 s and extension of agricultural areas in the middle helmand basin hajihosseini et al 2019 the wetlands began to dry up and the intensity and frequency of dust storms increased significantly rashki et al 2013 the characteristic winds in the lower helmand basin which occur from may to september locally called winds of 120 days exacerbate the situation as shown in fig 1 the wind blows steadily from the northwest iran to the east afghanistan whitney 2006 the severity of the dust storms is recorded by ground meteorological stations and satellite imagery the daily ground records from zabol station for 1991 to 2012 were used in this study here a dust storm event dst was characterized as wind velocity greater than 15 m sec and visibility vis 1000 m miri et al 2009 h3 wheat production as an economic indicator obviously any material interference with or loss of ecosystem services provided by the riverine ecosystem of a shared watercourse such as public health industry property agriculture or the environment may amount to actionable significant harm mcintyre 2020 the economy of the sistan inland delta is strongly dependent on agriculture irrigated and non irrigated and the goods and services provided by the river and wetlands van beek and meijer 2006 in downstream iran the sistan inland delta s agro ecological system is 96 dependent on surface water coming from afghanistan thomas and varzi 2015 the majority of people in the sistan are employed in agriculture and suffering from the severe water shortage loss of income and dust storms pushed the rural community to leave the area and emigrate to other places mianabadi et al 2020 the lakes hamoun are vital for all people living in the delta and provide goods and ecological services not only for rural population farmers and fishermen but for the whole residents thomas and varzi 2015 van beek et al 2008 a considerable reduction in the water of the lakes hamoun would not only harm the ecological functioning of the lake h1 it would also endanger and exacerbate the livelihoods of the residents depending on the products and eco services of this system thomas and varzi 2015 to evaluate this type of harm wheat production on the iranian side of sistan plain as the most important agricultural product in the region was used as the indicator because it depends fully on the streamflow from the helmand river the annual wheat production records were provided by the sistan and baluchistan agricultural organization iran 2 4 conceptual modeling framework the methodology followed for this study is presented in fig 2 initially swat was used to provide the basic information on daily flows this information was entered into the iha model to calculate the streamflow characteristics and evaluate possible environmental harm h1 and correlate streamflow with dust storm events dst and visibility vis 1000 m to evaluate human health harm h2 the simulated streamflow was applied to estimate economic harm h3 through its correlation with regional wheat production char burjak station was selected as the reference station because of its proximity to kamal khan dam fig 2 integrated framework for determining impact of human activity and climate variability on the helmand river basin from no harm perspective iha rva dst and vis stand for indicators of hydrologic alteration environmental flow components range of variability approach dust storm events and visibility 2 4 1 swat swat arnold et al 2012 was applied to simulate streamflow as the hydrologic cycle on a land surface based on the water balance as 1 sw t sw 0 i 1 t r day q surf e a w seep q gw i where swt is the final soil moisture content mm h2o sw 0 is the initial soil moisture content on day i mm h2o t is time days rday is the total precipitation on day i mm h2o qsurf is the surface runoff on day i mm h2o ea is the evapotranspiration on day i mm h2o wseep is the volume of water entering the unsaturated zone from soil profiles on day i mm h2o and qgw is the groundwater recharge amount on day i mm h2o the model subdivides each basin into several sub basins and then each sub basin into several hydrological response units hrus each hru incorporates uniform land use soil properties and slope which makes the model flexible for handling different management scenarios jain et al 2010 2 4 2 iha description the iha has been extensively used to evaluate the eco hydrological effects of a streamflow regime caused by alterations in river management yang 2016 it uses a number of parameters which are subdivided into iha and environmental flow components these have been classified into five groups as shown in table 2 with their respective parameters and explanation of their influence on ecosystems further description is available in the nature conservancy 2009 the 33 iha parameters vary for current conditions and future eco hydrological conditions according to external such as climate change or internal such as dam construction change richter et al 1997 1996 introduced the range of variability approach rva here we applied the 25th and 75th percentile values for each of the parameters to indicate target ranges in rva if the variability results in significant hydrologic alteration ha that produce a parameter value outside the rva range it means that the system has changed state and conditions are not normal the hai is estimated as follows 2 ha i n o n e n e 100 where no is the observed frequency of iha parameter i falling within the target range before the dam construction and ne is the targeted frequency after the dam construction the overall degree of change hao of a river can be calculated as 3 ha o 1 33 i 1 33 ha i 2 when ne values falling within the rva target range equals no it means ha is zero i e no hydrologic alteration but negative positive values indicate that the considered parameter fall inside the rva boundaries less more often than expected the degree of hydrologic alteration is identified in one of three categories of equal size including low 0 to 33 moderate 33 to 67 and high 67 to 100 duan et al 2016 another relevant index is relative difference rd it is calculated as follows 4 rd i mdn m d a mdn 100 where mdn and mda are the median of iha parameter i before and after impact respectively e g before and after the dam construction zheng et al 2020 3 results 3 1 setup of swat the types of harm were evaluated as possible consequences of the development of kamal khan dam and the relationship between their respective indicators parameters and the helmand streamflow were evaluated the daily simulated streamflow at the adjacent char burjak station fig 1 was applied and the modeling setup and calibration were based on this station 3 1 1 model parametrization to prepare swat for simulation of the helmand river at char burjak station the upper basin was divided to 15 sub basins and 106 hrus the parameters for each of the main components of the model included plant dat soil science sol groundwater gw management mgt and river rte parameters and were based on the available data and the results of previous studies by hajihosseini et al 2016 and hajihosseini et al 2019 the next steps were sensitivity analysis of the model parameters and calibration and uncertainty analysis of the model performed using the swat cup model abbaspour et al 2015 and the sequential uncertainty fitting algorithm sufi 2 table 3 shows the initial range and final values and ranks of the parameters p value and t stat the parameter with the greatest t stat value and a p value approaching zero had the greatest effect on the simulation of river flows parameters cn2 and alpha bf were the most sensitive and had an effect on the fractions of surface runoff and groundwater in the streamflow 3 1 2 model calibration using global datasets for climate soil and land use table 3 as well as swat cup the model was calibrated using the observed monthly discharge data from char burjak station for 1968 to 1978 only available data the first four years were used for calibration and the remainder for validation the results were deemed satisfactory at r2 0 62 and ns 0 65 for calibration and r2 0 61 and ns 0 64 for validation 3 2 historical evaluation of streamflow the calibrated swat approach was used to simulate the long term streamflow of helmand river the average monthly flows for the observed period 1968 1978 and simulation period 1968 2012 are shown in table 4 the results for the non parametric mann kendall trend mann whitney homogeneity before and after year 2000 and pettitt abrupt change methods were applied to the observed monthly flows to evaluate non stationary changes none of the tests showed a statistically significant change in the time series streamflow at a 5 confidence level 3 3 modeling regional harm components as it was already stated and shown in fig 2 environmental health and economic harms h1 to h3 were taken into account in this study these harms could be either direct or indirect consequences of a decrease in helmand water inflows downstream in the basin thus possible correlations between the selected harms and the helmand inflows were investigated the simulated daily streamflow of char burjak from swat for the period of 2000 to 2012 was applied for further analysis representation of helmand inflows 3 3 1 helmand streamflow and environment the simulated daily streamflow at char burjak station was used as input for the iha the results for the median of historical status of 33 iha parameters are shown in appendix a the ecosystem influences of these changes are already explained in the section 2 4 2 fig 3 also shows some of the parameters relating to groups 1 and 2 table 2 these groups emphasize more the characteristics of river discharges they are important for some of the ecosystem processes such as availability of water for terrestrial animals reliability of water supplies for terrestrial animals and physical habitat conditions the nature conservancy 2009 the figure reveals that april and may had the highest monthly flows notably the difference between the 1 day max and 90 day max was not high which can be attributed to less variability of the discharges during high flows from another point of view a high difference between the minimum and maximum flows of the river is illustrated 3 3 2 helmand streamflow and dust storm fig 4 shows the relationship between the daily recorded dst and vis 1000 m at zabol station and the simulated streamflow at char burjak station a discharge of 250 m3 sec provided the necessary conditions for an increase in occurrence of dust storm events i e dst and vis 1000 m thus it was defined as the threshold for detection of potential health harm underlying problems and health challenges were not limited to the iranian side wind direction poses a serious challenge to the afghanistan side as well 3 3 3 helmand streamflow and wheat production wheat as the major crop was selected as the indicator of economic harm in the iran part of sistan plain fig 5 shows the correlation between annual streamflow at char burjak station and annual production of wheat throughout the plain for 1990 to 2011 at r2 0 69 1 significance 5 p w 4 482 q ch 10580 where pw is the annual wheat production ton yr and qch is the annual discharge million cubic meters mcm from helmand river at char burjak station of course there is uncertainty with this equation however it is not considered in this study the same approach is also applied by mkhabela et al 2010 to assess indicators of agricultural drought impacts on spring wheat yield and quality on the canadian prairies 3 4 operation of kamal khan dam although the dam is not yet operational the reports reviewed for this study indicate that the diversions listed below should be considered 3 4 1 diversion for agricultural development dad the agricultural area of nimruz province in afghanistan has about 80 000 ha under irrigation and the target area after the dam has become operational is 174 000 ha nwara 2017 an increase of 94 000 ha the recommended cropping pattern is not clearly defined however reports exist on the optimum cropping pattern for the sistan plain ab khak consultant engineering 2017 this includes the cultivation of wheat barley canola watermelon cucumbers hay eggplants grapes and olives the fao study on water availability and uses in afghanistan river basins fao 2015 reports the helmand basin s current situation crops such as rice which are high in water consumption have been eliminated table 5 shows the required monthly diversion from helmand river according to this report the maximum monthly diversion is for may and is 129 25 m3 sec rameen 2017 reports that the capacity of dam diversion for agricultural land is 150 m3 sec the maximum monthly diversion is for may and is 129 25 m3 sec considering this value and 174 000 ha of total irrigation area its irrigation hydro module would be 0 75 l s ha the reported value for the iran side of sistan plain is 0 8 l s ha ab khak consultant engineering 2017 thus the estimations appear to be reasonable and in places lower than the targeted amounts 3 4 2 diversion for flood protection dfp flood protection is another objective of the dam the threshold for water diversion from the river to avert flooding is the bankfull discharge this term refers to the stage at which water overflows onto the floodplain edwards et al 2019 many factors affect the bankfull discharge however for many rivers it can be approximated with a recurrence interval for an annual flood series of 1 5 years dunne and leopold 1978 castro and jackson 2001 this threshold was used in the current study the annual maximum daily flow simulated by swat for char burjak station av 339 1 m3 sec and sd 170 8 m3 sec were applied to estimate the bankfull discharge i e 1 5 years return flows this was estimated to be 250 m3 sec using the gumbel distribution it was assumed that the kamal khan dam will be able to divert 100 m3 sec of river flow for floods of greater than 250 m3 sec for protection of the downstream area higher diversions would need huge investments this amount will be diverted through khoshk and biyabanal rivers which flow into gowd e zarreh fig 1 they are historical paths for the helmand river whitney 2006 of course the current design of the dam can divert flows lower than the bankfull discharge to gowd e zarreh too however such an operation will definitely have more negative impacts on the river environment using the daily simulation of swat and applying the dad and dfp rules the annual helmand river flow after the dam site is estimated to decrease up to 30 3 5 harm assessment of diversion from river by the kamal khan dam using swat and iha 3 5 1 environmental impact changes in the values of the iha and their respective parameters were evaluated and compared with the respected dad and dfp values based on ha eq 2 and rd eq 3 criteria fig 6 fig 6 a shows high hydrological alterations of the parameters of group 1 table 2 more significant has are seen during the winter and spring months which are continuously around 30 this is due to the expected higher irrigation during cropping season in dad scenario the impact of dfp flood control scenario is more visible in the group 2 fig 6 a while this is the intended outcome of flood control this type of flow also has an important effect on saving water for the hamoun fig 6 b shows the changes in the parameters using rd which is based on the medians it can be clearly seen that almost all of the indicators are drastically changed 3 5 2 economic impact using eq 4 for wheat production on the iranian side and the annual flow at char burjak station based on the discharge simulations of swat for the dad and dfp of kamal khan dam reveals significant economic losses fig 7 shows that the estimated changes would decrease the current 12 000 ton yr of wheat production to 3 850 ton yr the planned expansion in afghanistan from 80 to 174 thousand ha comes at the expense of existing production in iran 3 5 3 health impact fig 4 and the relation between dst and vis 1000 m at different discharge rates based on daily discharge simulations of swat were used to estimate the revised discharge rates after operation of the dam dad dfp as shown in fig 8 a linear proportional relationship has been assumed between the changes in the discharge and frequency of dst and vis 1000 m it was concluded that the frequency of dst and vis 1000 m would increase by 15 09 and 15 16 respectively 3 5 4 integrated evaluation of harms an integrated evaluation of the model outputs was used in this study to estimate the average relative change for the parameters of each harm type h1 to h3 these are shown in table 6 the overall change of hydrologic alteration for each of the 33 iha parameters were applied to determine the status of environmental harm i e hao in eq 3 also the same classification i e low 0 to 33 moderate 33 to 67 and high 67 to 100 is also applied to show the level of harms as seen harm to health is predicted to be at a low level i e dst and vis 1000 m are lower than 33 of course dust storms are already a serious health problem for inhabitants of both riparian sides of the sistan plain therefore the current health situation will be worsening the afghanistan meteorological department reports that they cause skin and eye irritation conjunctivitis and can enhance susceptibility to ocular infection 1 1 http www amd gov af sand and dust stormsen similar reports are available from iran miri et al 2009 therefore the situation will get worse even in afghanistan environmental harm will be at a moderate level due to 53 65 and 21 41 negative changes in hao and rd indicators respectively same as before the region s environment is already in a critical situation and the new diversions will further devastate it hamoun international wetlands will be the major target of this type of harm as the well being of the helmand river and hamoun habitats decline they will become sources of dust storms which will be harmful to both sides and increase international concerns about the hamoun wetlands as shown before wheat production as an indicator for economic harm could decrease up to 70 and causes negative impacts on livelihoods and economic income of the local people in the iran side of sistan plain it is necessary to emphasize that this analysis has not weighed this harm against the equitable and reasonable utilization of the riparian state afghanistan and has not evaluated whether this might legally still constitute reasonable and equitable utilization doing so would require additional investigations see e g kampragou et al 2007 and avarideh et al 2017 to sum up from the perspective of the un watercourses convention 1997 despite the recognition of the principle of equitable and reasonable utilization the occurrence of significant harm appears as a factor for the determination of the equitable character of a shared water utilization tanzi 2020 tanzi 2020 illustrates his argument by the hypothetical example given by the ilc 1994 that a dam which would provide hydroelectric power to hundreds of thousands of people but which would cause significant harm to a few hundred people in another riparian state whose recreational fishing would be destroyed ilc 1994 furthermore based on the limited territorial sovereignty principle riparian states are entitled to use their own watercourse in transboundary river basins in a way that does not have an undesirable impact on the other riparian states kotkasaari 2008 accordingly and with regard to the results of the applied model all the appropriate measures should be taken to anticipate and to prevent or mitigate such harm in the transboundary river basin 4 discussion and conclusion the no harm principle and integration of environmental issues in water management are covered extensively by international water and environmental law the term no harm also appears frequently in international transboundary conventions and agreements however the quantification of this term is challenging in the current study a methodology was developed to quantify this term specifically when the data and information are insufficient which is primarily based on global climate databases and public domain models no doubt comprehensive consensus building on understanding and grasp such a contested and evolving nature is so difficult hence this research does not argue that it develops a standard or considers all qualitative and quantitative aspects and dimensions for no harm assessment in transboundary river basins due to the complexity of coupled human water systems the definition and understanding of harm is a co evolutionary process so such efforts fulfilled in this study can be seen as the first steps towards the quantitative evaluation of the no harm rule in international transboundary watercourses nevertheless this model is able to take into account some main quantitative attributes for harm evaluation in the shared watercourses systems with regard to three main categories of harm which have been recognized by international transboundary conventions and icj as well as other international tribunals and courts it is emphasized again that this article is not in a position to be willing or able to make a definite judgement the exploitation of kamal khan dam on the transboundary helmand river has been applied as a case study for the proposed approach the following conclusions were drawn 1 international water treaties and agreements as well as the decisions judgments and awards adopted by the icj and international arbitral tribunals and courts generally assess three types of harm health environment and economic the proposed framework was adjusted to quantify these types of harm 2 an integrated model was developed to quantify and assess harm in transboundary river basins when data and information is insufficient due to poor infrastructure limited meteorological monitoring systems and political instability in riparian states 3 swat and the global cru dataset were combined with the iha to develop a useful framework to simulate river flow and its environmental characteristics this helped to address the scarcity inaccessibility of data and information on the study area 4 the predicted diversions for agriculture and flood protection substantially reduce discharge with drastic impact on the flow characteristics of the river and the survival of hamoun international wetlands of course flood is a challenge in the sistan plain and joint programs for flood control should be developed by iran and afghanistan in which both people and ecosystem especially hamoun as the main source of dust storms are considered 5 the health harm was evaluated using the number of days with dust storms dst and visibility of 1000 m vis 1000 m the results estimate that new diversions will increase dst and vis 1000 m about 15 and 28 respectively the entire sistan plain regularly experiences serious dust storm events the dry bed of the hamoun wetlands is the major source of dust in the region 6 environmental harm has been predicted to be moderate for the 33 hydrological iha parameters the respective results were 38 1 decreases in the parameters 7 economic harm has been quantified by wheat production the simulation shows decrease of about 70 in wheat productions on the iranian side the change relates to the similar cropping calendar for the sistan plain between iran and afghanistan and the decrease in flow especially during april and may 8 it is not the purpose of this study to argue against development in the upper catchments rather it attempts to show how such development can eventually shift an upstream problem e g lack of agriculture production to downstream areas or create new problems upstream an example of this relates to exacerbating of the health problem due to more frequent dust storms 9 the hydrological modeling for any catchment is associated with intrinsic uncertainties due to different factors reichert et al 2020 moreover the exchange of data and information in transboundary river basins is often problematic bitew and gebremichael 2011 which exacerbates these uncertainties despite such limitations the capacities of hydrological simulations and global databases should be considered for better evaluations of possible violation of the international laws as they were applied in this study for harm through an integrated framework 10 the scope of this study was the principle of no harm and other principles like reasonable and equitable utilization need to be addressed for more comprehensive evaluation of the kamal khan dam under the un watercourses convention 1997 the obligation not to cause significant harm implicitly appears through the duty to prevent pollution and the mechanism of prior notification and consultation related to infrastructures and project construction tignino and bréthaut 2020 the road to water cooperation and conflict management in transboundary river basins in general and the helmand river basin in particular will be paved by mutual fact finding and trust building one potential opportunity involves joint analysis of potential changes in wheat production across both countries for this purpose using quantitative evaluation models such as developed in this research can be seen as the first step towards mutual fact finding and trust building participatory monitoring and evaluation can be considered as another significant tool to enhance the management of international environment and transboundary river basins furthermore the recognition of the duty to carry out cooperative transboundary environmental impact assessment eia helps eliminate or mitigate the harm and prevent control and reduce any undesirable transboundary impact unfortunately no cooperative and transboundary eia study has been conducted on this dam so far besides the obligation of prior notification as a principle of international water law and an instrument of water diplomacy schmeier 2020 can play a key role in cooperation in the prevention of harm and protection of the environment of transboundary water resources prior notification was not made for this dam but in general can give riparian state s the opportunity to cooperate together on the potential impacts of that project by exchanging data and information needed to mitigate potential harm and conflict over that project this principle can also lead to consultation and trust building between notified riparian state s and ensuring that one riparian country does not intend to harm other riparian countries it can seriously mitigate riparians concerns and potential conflict regarding the consequential harm of that project no doubt prior notification about planned measures and their potential impacts can help riparian parties to prevent control and reduce any adverse transboundary effects last but not the least integrated water resources management integrated flood and drought management plans and depoliticization of the hirmand water interactions for preventing political frictions as well as the nexus approaches can be other preferred solutions to address these issues fortunately positive steps including signing the agreement for shared data collection and monitoring have been taken in this regard 2 2 https tolonews com afghanistan kabul tehran accord joint cooperation document imminent long standing comprehensive cooperation between iran and afghanistan is an example of this funding this research did not receive any specific grant from funding agencies in the public commercial or not for profit sectors declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement the authors would like to express their sincere gratitude to dr joseph guillaume as associate editor and the anonymous referees for their helpful comments and constructive suggestions appendix a medians of 31 iha parameters in the helmand river at char burjak station under natural condition as well as dad diversions for agriculture sector and joint dad and dfp flood control scenarios medians rva boundaries medians rva boundaries ihas natural dad dad dfp low high ihas natural dad dad dfp low high group 1 m3 s group 2 m3 s january 132 9 100 6 100 6 119 1 138 9 1 day max 346 3 291 2 245 8 326 8 507 7 february 166 4 117 6 117 6 151 1 174 8 3 day max 320 8 272 4 222 8 326 1 479 1 march 154 5 102 8 102 8 163 2 221 3 7 day max 274 5 255 4 208 5 304 2 447 3 april 212 3 135 8 135 8 209 9 356 9 30 day max 259 1 220 6 197 7 263 3 425 3 may 223 2 173 4 156 2 257 8 346 2 90 day max 206 2 165 0 160 0 222 2 353 5 june 120 161 3 157 8 145 9 219 9 base flow index 0 36 0 17 0 18 0 36 0 45 july 114 2 95 7 95 74 107 4 135 7 group 3 julian day august 87 89 72 2 72 24 88 26 107 3 date of min 279 311 5 311 5 281 313 september 77 02 64 8 64 84 76 0 92 58 date of max 74 60 5 60 5 52 44 98 78 october 68 18 70 39 70 39 70 82 100 0 group 4 november 65 21 31 19 31 19 62 89 85 7 low pulse count 2 3 3 1 2 78 december 106 7 78 9 78 9 80 99 116 5 low pulse duration day 84 5 25 25 25 25 18 9 43 16 group 2 m3 s high pulse count 2 2 3 2 3 1 day min 47 17 7 17 7 55 71 68 3 high pulse duration day 7 6 4 5 7 57 63 51 3 day min 47 75 17 9 17 9 56 08 68 96 group 5 7 day min 50 22 19 17 19 17 56 20 70 06 rise rate m3 s 0 72 0 79 0 72 0 88 0 72 30 day min 55 46 21 24 21 24 58 63 75 59 fall rate m3 s 0 89 1 04 1 26 0 90 1 26 90 day min 71 99 53 89 53 89 71 49 96 06 number of reversals 152 148 145 152 8 145 appendix b rules for the dam operation diversion for agriculture development dad n 1 to 33 the entire records of 33 years at charborjak station j 1 to 12 month and i 1 to 365 julian day qdn i daily flows of swat simulation q irn j daily water requirement for the new agriculture development based on table 5 q dadn i daily flows at dad scenario qdn i q irn i and if 0 then qdadn i 0 q han i daily altered discharge q dadn i diversion for flood protection dfp qmf maximum diversion for flood protection 100 m3 s qbf bankfull discharge 250 m3 s if qdn i qbf then q dfpn i qdn i qmf and if q dfpn i 250 then q dfpn i qbf q han i daily altered discharge q dfpn i diversion for dad and dfp repeat dfp scenario and substitute qdn i with q dadn i if q dadn i qbf m3 s then q dfpn i q dadn i qmf and if q dfpn i qbf then q dfpn i qbf q han i daily altered discharge q dfpn i 
4458,tunnelling activities may significantly alter the groundwater balance in a karst aquifer but assessment of this effect remains challenging due to the complex flow geometries and strong hydrogeological heterogeneity in this study based on extensive site characterization of an independent hydrogeological unit hu in which a deep buried tunnel is under construction we present a modified lumped model to evaluate the impact of tunnel construction on the discharge from the aquifer system the lumped model consists of four interacting flow compartments and the associated water balance equations a series of simplified models is then developed by merging or removing some of the flow components that represent different mechanisms and relationships between recharge and discharge the dominant hydrological processes in the hu are identified by comparing the performance of the models of different structures and by screening analysis of parameter sensitivities it is found that the tunnel excavation captured a mean portion of 19 discharge from the aquifer system into the tunnel which is comparable to the result predicted by 3d numerical simulations this study evidences that as a first and simple approximation the lumped models provide a useful tool for characterizing the dominant factors that govern the groundwater response and for evaluating the groundwater budget changes induced by anthropogenic activities such as tunnelling and underground mining in karst regions keywords karst aquifers groundwater balance lumped model tunnel construction 1 introduction karstic aquifers are characteristic of complex flow geometry and strong hydrogeological heterogeneity caused mainly by double or triple porosity structures consisting of pores fissures fractures and conduits of various scales white 2002 ford and williams 2007 hartmann et al 2014 consequently karst groundwater typically consists of base flow through fissure network and rapid flow through enlarged fractures and conduits jukić and denić jukić 2009 hosseini et al 2017 these characteristics give rise to significant challenges in groundwater flow modelling in karstic formations further complexity arises when anthropogenic activities e g tunnel construction are involved where the groundwater flow paths and discharges may be changed drastically within a short period hao et al 2016 lv et al 2020 even resulting in geological and environmental hazards such as mud and water inrush spring depletion and ground subsidence raposo et al 2010 pu et al 2011 mahler and bourgeai 2013 grimmeisen et al 2016 han et al 2017 jiang et al 2018 liu et al 2019 chen et al 2020 zhou et al 2021 a variety of hydrological models e g black box distributed and lumped have been proposed to confront the challenges and approximate the groundwater budget changes in karst formations beven 1989 fleury et al 2007 le moine et al 2008 makropoulos et al 2008 jukić and denić jukić 2009 hartmann et al 2012 the black box models treat an aquifer as a black box system and focus on establishing an overall relationship between input infiltration and output discharge completely disregarding the structure and the physical mechanisms of the aquifer dreiss 1983 mangin 1984 the distributed models solve flow equations with temporal and spatial discretization over the whole aquifer hence requiring detailed information on the aquifer structure and hydrological properties for producing an acceptable simulation zhang et al 2011 saller et al 2013 zheng et al 2020 the lumped models provide a compromised tool for karst groundwater simulation in which linear or nonlinear reservoirs compartments are used to represent different physical elements of the aquifer structure and groundwater circulation fleury et al 2007 2009 jukić and denić jukić 2009 each reservoir relies on a production function and a transfer function to simulate the process from input to output in each hydrogeological unit and hence the lumped models are suitable for aquifer simulation with limited observation data and insufficient field characterization spring discharge observations and trace element data are commonly used to calibrate the lumped models wagener et al 2003 hartmann et al 2013 ye et al 2014 mudarra et al 2019 particular concerns have been focused on the temporal variability in groundwater recharges and the effect of karst aquifers drainage induced by climate change or human activities jukić and denić jukić 2009 chang et al 2017 hosseini et al 2017 the construction of deep buried tunnels in karst regions can profoundly change the water budget in the karst system hence there is a need to revisit the structure and parameters of the lumped model for incorporating this strong impact of human activity this study is motivated by tunnel excavation induced karst groundwater budget changes in the jiayan water diversion project jwdp located in guizhou province southwest china in this work a modified lumped model is presented to quantitatively estimate the impact of tunnel construction on the karst aquifers by integrating a channel drainage compartment that represents the drainage from the karst aquifer to the tunnel during construction the model structure is systematically investigated through comparison of simulations with varying levels of simplification by merging or removing some of the flow components the dominant hydrogeological processes that control the aquifer discharge are identified by performance assessment of the models and sensitivity analysis of the input parameters the impact of tunnel construction on the aquifer discharge is finally quantified with the calibrated models which contributes to decision making for appropriate engineering treatments during tunnel construction 2 study site and data the study area is located in guizhou province southwest china fig s1a in supplementary material where karst landscapes cover about 62 of the land area chen et al 2020 it is bounded by the baifu river in the east the liuchong river in the south and a groundwater divide in the north the terrains range from 1300 to 2300 m a s l sloping from northwest to southeast the study area lies in the subtropical monsoon climate zone with a marked seasonal pattern in the annual variations of precipitation and air temperature the daily rainfalls are available from two meteorological stations at machang and weixin fig s1a in supplementary material about 80 of the annual precipitation occurs during the wet season between april and september with a mean annual precipitation of 895 mm the average annual temperature in the study area is 12 c a large scale water diversion project named jiayan water diversion project jwdp is currently under construction in this area mainly for water supply irrigation and power generation the project has an irrigation area of 600 2 km2 and is designed to benefit a population of 2 67 million people in 9 cities or counties it consists of two main tunnels i e maochang and shuidaqiao tunnels of 35 7 km long and typically 220 550 m in depth in which 60 2 of the tunnel sections were excavated in karst formations consisting of triassic and permian carbonate rocks fig s1a in supplementary material the carbonate rocks mainly consist of limestone marly limestone dolomite and marly dolomite geological features including folds faults karst conduits and underground rivers are present in the study area fig s1a in supplementary material separated by low permeability triassic clay mudstone and siltstone rocks as well as impermeable geological structures four independent karstic hydrogeological units hus i e maochang xiaotianba yinatianba and shuchang from northwest to southeast are identified in the study area fig s1a in supplementary material different lithology of carbonate rocks is distributed in the four hus in the maochang hu the dominant lithology is permian dolomitic limestone and underground karstification is mainly controlled by an anticline striking ne sw the xiaotianba hu is mainly composed of thick triassic limestone layers the main rock types in the yinatianba and shuchang hus are triassic limestone and dolomite underground river systems formed by karstification are developed in each hu with the river flow directions basically consistent with the distribution of sinkholes observed in the field in most cases one underground river is developed in each hu except that in the maochang hu there are three underground rivers i e dapo goudiaoyan and maluodong distributed from northwest to southeast the four underground rivers in the maochang and xiaotianba hus flow from north to south and discharge to the liuchong river the other two underground rivers in the shuchang and yinatianba hus flow from west to east discharging to the baifu river due to the difficulties and limitations in data collection this study focuses on the shuchang hu located southeast in the study area fig s1a in supplementary material the shuchang hu has an area of about 50 km2 and is separated from the yinatianba hu to the north by a local groundwater divide it is bounded in the north by a series of compressive shear faults to the west it is neighboring to the xiaotianba hu with the boundary located on a reverse fault an anticlinal fault core and low permeability rocks consisting of triassic mudstones and siltstones fig s1b in supplementary material the shuchang hu is controlled by the baifu river in the east and separated by a regional scale fault zone containing a series of compressive shear faults i e machang fault with one of its branches labeled as f106 in the south the compressive shear faults are all impervious and therefore the groundwater exchanges between this hu and the neighboring hus are negligible which has been evidenced by tracer tests conducted in 2017 the shuchang underground river fig s1 in supplementary material is located in the shuchang hu with depths ranging between 10 and 100 m and its recharge area is distributed at elevation of 1380 m the underground river discharges to the baifu river at the shuchang spring at elevation of 1160 m with a length of 5 9 km and a mean slope of 4 the underground river is connected to three large sinkholes and a dozen smaller sinkholes which allows for quick point recharge into the karst system the soil cover has a spatially varying thickness generally thin and with shrubbery vegetation in most areas of this hu the shuidaqiao tunnel together with 3 branch tunnels for construction passes through this hu the tunnel is aligned with a horizontal distance of about 30 100 m away from and 30 350 m deeper than the shuchang underground river the construction of the tunnel started in january 2016 and lasted for 30 months the discharge data from the tunnel was collected daily from june 2017 to december 2017 the daily discharge data from the shuchang spring i e the outlet of the shuchang underground river was not available in this period but was recorded between june 2018 and december 2018 3 methods 3 1 model development as depicted conceptually in fig 1 in the shuchang hu the rainfall infiltrates into the karst system by both diffuse flow through soil cover and quick flow through sinkholes and vertical shafts where the recharge area often varies as the groundwater level fluctuates white 2002 ford and williams 2007 the quick flow directly feeds into the underground river while the diffuse flow recharges the epikarst zone characteristic of relatively lower degree of karstification at the site bailly comte et al 2010 then the groundwater further moves vertically into the more karstified vadose and phreatic zones where the shuchang underground river is located in forms of base flow through fissured matrix network quick flow through karstified conduits and vertical shafts and intermediate flow through enlarged karstified fractures the groundwater finally discharges either by the spring at the outlet of the underground river or through the hyporheic zone of the baifu river tunnel excavation opened a new route for discharge based on the above conceptualization this study presents a modified lumped model mlm from previous reservoir models developed for karst systems rimmer and salingar 2006 fleury et al 2007 2009 jukić and denić jukić 2009 charlier et al 2012 hosseini et al 2017 with a particular concern on the groundwater discharge from the karst system to the tunnel the model consists of four compartments i e a soil moisture compartment smc an epikarst compartment epc a groundwater compartment gwc and a channel drainage compartment cdc as shown in fig 2 the smc and epc compartments account for the hydrological functioning storage and production of soil cover and epikarst zone respectively jukić and denić jukić 2009 hosseini et al 2017 the gwc contains three parallel sub compartments for simulation of base flow intermediate flow and quick flow of the total discharge the modifications are manifested by the cdc that accounts for the impact of tunnel excavation on the aquifer discharge fig 2 the moisture mass balance in the upper karst formations is quantified by the smc which reads 1 d v s d t p t e t a t r h t r r t r s t where p is the precipitation et a is the actual evapotranspiration r s and r h are the recharges to the underlying layers through diffuse flow and internal runoff respectively r r is the surface runoff when infiltration exceeds the soil storage capacities and dv s denotes the increment of moisture storage within a given time step dt one day in this study all terms in eq 1 are in mm day 1 et a in eq 1 represents the actual moisture loss from the soil cover and is typically formulated as palmer 1965 2 e t a t e t p t if v s t p t d t v smax e t p t v s t p t d t v smax if v s t p t d t v smax where v smax is the maximum capacity of soil to store the infiltrated water in mm and et p is the potential evapotranspiration in mm day 1 which can be estimated by the expression of eagleman 1967 3 e t p φ c t c w e max 100 r h 1 2 e max 6 1 exp 17 1 t 234 2 t where t is the air temperature in c rh is the relative air humidity in percent c w is a constant depending on wind velocity commonly taken as 0 8 φ is a correction coefficient equal to 0 0329 for δt 1 day chang et al 2015 and c t is a coefficient depending on air temperature jukić and denić jukić 2009 4 c t 0 63 if t 0 0 63 0 024 t if 0 t 21 1 13 if t 21 the quick recharge r h through sinkholes can be evaluated by empirically introducing a coefficient f h which describes the proportionality of net infiltration by means of quick flow 5 r h t f h max p t e t a t v smax 0 the surface runoff r r represents the part of the excess water when infiltration exceeds the maximum capacity of soil r r can be considered as a function of excessinfiltrationandexcessstorage of this layer by a fraction f r 6 r r t f r max p t e t a t v smax 0 in the moisture mass balance equation the stored moisture v s t is assumed to have a maximum capacity v smax the soil receives recharge from precipitation for v s t v smax and as the soil is saturated i e v s t v smax the excess infiltrated water i e r s t recharges to the epikarst zone the output of the smc is taken as the input of the epc fig 2 in which the mass balance equation is written as hosseini et al 2017 7 d v e d t r s t r e t where dv e is the increment of water stored in the epikarst zone within the time step dt r s is the recharge from the soil storage and r e is the seepage or overflow from the epikarst zone to the underlying karst formations again all the terms in eq 7 are in mm day 1 the term r e can be expressed as drainage controlled by linearity coefficient αe day 1 or as overflow rimmer and salingar 2006 hartmann et al 2012 8 r e t 1 α e v e t r s t d t v emax if v e t r s t d t v emax α e v e t r s t d t if v e t r s t d t v emax the epikarst zone is assumed to have a maximum capacity of storage v emax and the recharge r e to the underlying vadose and phreatic zones occurs as the stored water exceeds its maximum capacity i e v e v emax this recharge r e together with the quick recharge component r h is considered as the total recharge r t to groundwater in the gwc bonacci 2001 white 2002 9 r t t r e t r h t water flow in the gwc is divided into three components base flow through fissured matrix network intermediate flow through enlarged fractures and quick flow through karst conduits and vertical shafts these three flow components are assumed to be independent i e the water exchange among them is not considered as commonly done in previous studies fleury et al 2007 jukić and denić jukić 2009 charlier et al 2012 hosseini et al 2017 the intermediate flow has been considered to exhibit a nonlinear relationship between recharge and discharge jukić and denić jukić 2006 2009 the recharge of each flow component is partitioned from r t by a separation factor fi i 1 2 3 with f 1 f 2 f 3 1 10a d s 1 d t f 1 r t t q 1 t 10b d s 2 d t f 2 r t t q 2 t 10c d s 3 d t f 3 r t t q 3 t where si and qi i 1 2 3 are the groundwater storage and discharge of the ith reservoir respectively and qi can be represented by using the recession coefficient αi fleury et al 2007 jukić and denić jukić 2009 11a q 1 t α 1 s 1 t f 1 r t t 11b q 2 t α 2 s 2 t f 2 r t t β 11c q 3 t α 3 s 3 t f 3 r t t where β is an exponent for the component of nonlinear intermediate flow the gwc then yields the total flow to the cdc r q by 12 r q t a q 1 t q 2 t q 3 t where a denotes the area of recharge finally the cdc takes r q t as the input to calculate the discharges from the spring at the outlet of the underground river and from the tunnel system respectively by introducing two factors γ 1 and γ 2 satisfying γ 1 γ 2 1 13a d v 1 d t γ 1 r q t q 1 t 13b d v 2 d t γ 2 r q t q 2 t where v 1 and v 2 are the storage in the underground river and the tunnel respectively and q 1 and q 2 in m3 day 1 are the discharge at the spring and the amount of drainage in the tunnel respectively the modified lumped model considers the interaction between tunnel and the aquifer system making it useful to quantitatively evaluate the impact of tunnel construction on the water balance fig 2 in the cdc the influence of tunnel excavation on the spring discharge variation is characterized by two factors γ 1 and γ 2 when no tunneling activity is involved the factor γ 2 vanishes and the model is reduced to previous models e g fleury et al 2007 jukić and denić jukić 2009 hosseini et al 2017 the model involves a total of 15 parameters but given the constraints that σfi 1 and σγi 1 the model contains 13 independent parameters to be calibrated as summarized in table 2 the typical ranges of these parameters are listed in table 1 by reviewing the literature fleury et al 2007 jukić and denić jukić 2009 charlier et al 2012 hartmann et al 2013 hosseini et al 2017 3 2 model simplifications the modified lumped model presented in section 3 1 hereafter denoted by mlm1 represents the general case of groundwater balance in a karst aquifer system with tunneling activity to systematically identify the dominant hydrological processes and parameters in the lumped water balance model we also present simplified versions of mlm1 and perform model calibration and simulations we consider varying levels of complexities in the model structure by reducing the number of compartments and or removing certain flow processes and parameters the first category keeps the four compartment structure but the vertical flow f h nonlinearity coefficient β or intermediate flow component f 2 α2 and β is respectively removed from the original model denoted by mlm2 4 fig s2a c in supplementary material specifically mlm2 ignores the recharge component of the sinkhole mlm3 characterizes the intermediate flow with a linear recession in mlm4 the intermediate flow component in the gwc compartment vanishes meaning that the groundwater is grouped into slow through small fissures and fast through conduits flows the second category reduces to a three compartment structure by merging the soil and epikarst compartments and then removing the recession coefficient αe intermediate flow component f 2 α2 and β or both components αe f 2 α2 β respectively denoted by mlm5 8 fig s3a d in supplementary material models of mlm5 8 represent a system of unified compartment for the unsaturated zones near the surface without considering the effect of storage capacity of thin soil layer table 2 summarizes the number of independent parameters and the number of reservoirs contained in each simplified model by simplifications and alterations of the model structure the dominant hydrological processes can be progressively identified 3 3 model calibration application of the proposed model and its simplified versions requires proper calibration of the parameters listed in tables 1 and 2 this study adopts the shuffled complex evolution metropolis scem ua method for calibration vrugt et al 2003 this method uses an adaptive evolutionary monte carlo markov chain mcmc algorithm for identification of the optimal parameter sets table 2 and quantification of uncertainties by inputting the time series data of precipitation and spring discharge it combines complex shuffling with the metropolis hastings mh search strategy for population evolution more details about scem ua method can be found in vrugt et al 2003 the convergence of the method can be evaluated with a diagnostic score a value of the score less than 1 2 is generally considered to indicate a convergence to a stationary distribution as shown in table s1 in the supplementary material all values of the score are well below 1 2 which means that a satisfactory convergence is achieved for all the models the nash sutcliffe coefficient of efficiency nse is selected as the criterion for evaluation defined by nash and sutcliffe 1970 14 nse 1 y i y s i 2 y i y 2 where yi and ys i are the observed and simulated discharges at time ti respectively and y is the mean observed discharge in this criterion if nse 0 5 the simulation can be considered acceptable if nse 0 65 the model is considered satisfactory and if nse 0 75 the model is considered to perform well moriasi et al 2007 the same settings of the scem ua method for calibration are used in all models with the number of complexes the population size and the maximum number of iterations being 6 500 and 50 000 respectively three frequently used measures i e the coefficient of correlation cc the root mean square error rmse and the mean absolute error mae are also computed for model comparison the definitions of these measures are listed in table 3 where n is the number of observed or simulated time series data initial guesses of some model parameters in table 2 could be qualitatively obtained by the time series analyses of daily rainfall and spring discharge observation the autocorrelation function acf and cross correlation function ccf provide an initial estimation for the range of recession coefficients in the gwc compartment the acf is an effective tool to evaluate the linear dependency of continuous values over a period of time and the memory effect of karst systems schuler et al 2020 the memory effect can be understood as the hysteresis of the karst aquifer storage the autocorrelation coefficient commonly takes the threshold of 0 2 to distinguish the memory effect in karst hydrology mangin 1984 as shown in fig 3 a the plot of acf for the shuchang spring discharge indicates a lag value of 30 days and hence a distinct memory effect of the studied aquifers the cross correlation function ccf is used to analyze the relationship between two time series which describes as a crucial indicator the degree to which the time series are linearly correlated the peak and the lag value of the cross correlation provide information about the time interval representing the pressure pulse transfer into the aquifer fu et al 2016 according to mangin 1984 and katsanou et al 2015 the range of the quick recession coefficient α3 can be qualitatively estimated by the ccf between rainfall and spring discharge as plotted in fig 3b the ccf between daily precipitation and the shuchang spring discharge predicts a lag of 2 days when the ccf attains its peak at 0 55 this lag time indicates a rapid response of the spring to rainfall events and a moderate degree of karstification in the studied catchment as a first approximation the quick recession coefficient α3 can be roughly estimated as the reciprocal of the lag time i e α3 0 5 day 1 which is within the range given in table 1 3 4 sensitivity analysis to identify the dominant hydrological processes that contribute to the spring discharge the pawn method presented by pianosi and wagener 2015 is adopted to evaluate the global sensitivities of the model parameters the pawn method calculates the sensitivity of a certain input parameter xi by comparing the conditional cumulative distribution function cdf of the model outputs when keeping the input parameter xi constant to the unconditional cdf when all the parameters are varied randomly the two sample kolmogorov smirnov statistic is used to measure the distance between the unconditional and conditional cdfs for each input given by kolmogorov 1933 15 ks x i max y f y y f y x i y where fy y and f y x i y are the unconditional and conditional cdfs of the model output y respectively practically fy y can be approximated by a number of nu outputs sampling over the entire feasible space of the input parameters and f y x i y can be approximated by nc outputs sampling over the non fixed input space i e except xi the sensitivity of the model parameters is quantified by the so called pawn index ti defined as the maximum values of ks over all possible values of xi pianosi and wagener 2015 16 t i max x i x i 1 x i n ks x i where x i 1 x i n are n randomly sampled values for the fixed input xi the pawn sensitivity index ti varies from 0 to 1 and a larger value indicates greater model sensitivity to that input parameter the total number of simulations needed for m input parameters is nu nmnc the appropriate settings of nu nc and n can be chosen by trial and error pianosi and wagener 2015 this study takes nu 200 nc 150 and n 15 and further increasing the numbers would not affect the result of sensitivity evaluation 3 5 tunnel discharge calculation in the modified lumped models the cdc quantifies the impact of tunnel construction on the discharge of karst aquifers through the separation factors γ 1 and γ 2 in the study area the shuidaqiao tunnel is located below the underground river and hence the tunnel excavation would lead to discharge of groundwater from the tunnel and reduction of discharge from the spring after the tunnel was fully concrete lined and grouted in july 2018 the groundwater inflow became negligible given the relatively limited data recorded at the site we first calibrate the model parameters with the scem ua method using the daily precipitation and spring discharge data collected from june 1 to december 31 2018 during which the tunnel inflow was negligible i e γ 2 0 and γ 1 1 see table 2 the calibrated model parameters are then used to predict the total discharge r q in 2017 the separation factors γ 1 and γ 2 are finally calibrated with the gradient descent approach polak 1997 using the tunnel discharge data available during june 1 and december 31 2017 the above calibration procedure is depicted in fig s4 in supplementary material this procedure involves an assumption that the model processes and responses defined by the model parameters except those in the cdc compartment were not significantly altered before and after the tunnel was lined and grouted we note that had the discharge data been simultaneously collected from both the spring and the tunnel system the result could be more convincing 4 results 4 1 model structures and performance both four and three compartment models mlm1 8 are used to simulate the groundwater response in the shuchang hydrogeological unit the scem ua method with the nse criterion is used to calibrate the parameters of each model after a warm up period of one month to eliminate the influence of initial conditions on the result as an example fig 4 presents the box whisker plot of the calibrated parameters for the model mlm1 having the most complex structure figs 5 and 6 plot the spring discharge curves simulated by each model during the calibration period from june 1 to december 31 2018 together with the 95 confidence intervals table 4 shows that the rmse cc and mae values are strongly correlated to nse for the performance of the models the four compartment models mlm1 4 all performs well with nse 0 79 0 81 a comparison between mlm1 and the other four compartment models fig 5 and table 4 shows that the vertical flow component f h has a negligible effect on the spring discharge mlm2 and removing the intermediate flow component f 2 α2 and β leads to a marginal decrease of model performance from nse 0 81 to nse 0 80 mlm4 but when the lumped model is further simplified to the three compartment models by merging the soil and epikarst compartments mlm5 8 the value of nse significantly reduces to 0 70 0 74 fig 6 and table 4 decreasing the goodness of fit from good to satisfactory the model evaluation indicates that the recession coefficient of epikarst reservoir αe is a critical parameter and plays a more important role than the intermediate flow removing it results in a significant decrease of nse from 0 74 to 0 70 mlm6 it is interesting to note that removing the intermediate flow component may even perform slightly better than the cases when a linear model is used comparing mlm4 to mlm3 or when the recession effect of the epikarst zone is ignored comparing mlm6 to mlm8 4 2 impact of tunnel excavation the separation factors γ 1 and γ 2 in the cdc compartment is calibrated using the precipitation and tunnel discharge data in 2017 by assuming that the hydrogeological processes defined by the model parameters were not significantly altered after completion of tunnel lining and grouting in 2018 as shown in figs 5 and 6 all the four and three compartment models perform fairly well to predict the tunnel discharge in terms of the values of rmse cc and mae the calibrated factor γ 2 representing the proportion of tunnel discharge from the total discharge r q of the aquifer system varies in a narrow range between 0 17 and 0 23 with a mean value of 0 19 in good agreement with a value of 0 24 fig s5 in supplementary material based on a 3d discrete continuum numerical simulation zheng et al 2020 this can be justified by the fact that the study area is an independent hu in which the groundwater discharged mainly through the shuchang spring and the tunnel even though the spring discharge was not recorded in the calibration period june 1 december 31 2017 it is reasonably estimated through the modeling analysis that the spring discharge was reduced by around 19 and this amount of groundwater was captured by the tunnel system it can also be noted that the variation of the observed data is actually smaller than that of the simulated data this is due to the way the tunnel discharge was measured to maintain construction progress discharged water in the tunnel had to be pumped out a small ditch was used to divert the discharged water along the tunnel to the pumping location and the pumping rate was monitored to represent the total tunnel discharge the measurement by the pumped flow rate might have partially smoothened the real time variations in tunnel discharge due to site operations and water storage effects in the tunnel however we expect that the average discharge rate to the tunnel and the total amount of tunnel discharge are reasonably estimated in this way 4 3 sensitivity analysis the sensitivities of the input parameters in the lumped models to the spring discharge are evaluated with the pawn method pianosi and wagener 2015 which helps understand the dominant factors that control the predictive accuracy of the models a parameter is considered sensitive to model output if the sensitivity index ti is larger than the critical value 0 15 of the ks statistic at the significance level of 0 05 the ks statistic values at various conditioning values of the input parameters of mlm1 are shown in fig 7 table 5 summarizes the values of the sensitivity index ti for each parameter in the lumped models mlm1 8 the screening analysis shows that in all of the models the components of epikarst v emax α e base flow f 1 α 1 quick flow α 3 and surface runoff f r together with recharge area a are highly sensitive to the spring discharge whereas the components of soil cover v smax vertical flow f h and intermediate flow f 2 α 2 and β are less significant to the model output but in some of the simplified models e g mlm5 6 the recession coefficient α 2 and the nonlinearity exponent β may exhibit moderate sensitivities while in the models mlm6 and mlm7 the parameters v emax and f r become insignificant respectively 5 discussion in section 4 we have identified the dominant hydrogeological processes in the shuchang hu by comparing the performance of a series of models with different degree of simplifications and by screening analysis of parameter sensitivities we find that the four compartment models consistently perform better than the three compartment counterparts but as a result of the thin thickness of the soil cover the calibrated soil storage capacity v smax is around 2 mm mlm1 and is less sensitive to the aquifer discharge this optimal value of v smax is comparable to the calibrated result 1 3 mm in catchments with thin soil cover jukić and denić jukić 2009 hartmann et al 2013 hosseini et al 2017 the calibrated fraction of surface runoff f r is 0 57 comparable to the values between 0 41 and 0 80 given by rimmer and salingar 2006 the calibrated recharge area a is 36 km2 which is smaller than the area of the catchment about 50 km2 but the vertical flow component is insignificant as a result of small ratio of the recharge area through sinkholes to that in the entire catchment the epikarst zone is well developed in the study area and hence its storage capacity and recession effect play a significant role in the groundwater balance the model mlm1 calibrates an optimal linearity recession constant of α e 0 33 slightly higher than the range of 0 09 0 3 reported by charlier et al 2012 and 0 04 0 2 by hartmann et al 2013 in the vadose and phreatic zones at the site only the base flow and quick flow components are significant this may be due to the fact that the intermediate flow through enlarged fractures can be well compensated by tuning the parameters in the base flow and quick flow components but when the intermediate flow is modelled it is better to consider the nonlinear effect of recession as suggested by jukić and denić jukić 2009 the nonlinearity coefficient β is estimated to be 1 63 close to the value of 1 65 by jukić and denić jukić 2009 the calibration by mlm1 indicates a base flow separation factor of f 1 0 51 consistent with the value of 0 50 by jukić and denić jukić 2009 and comparable to the values between 0 41 and 0 82 reported by fleury et al 2007 charlier et al 2012 hartmann et al 2013 and hosseini et al 2017 the intermediate flow possesses a proportion of f 2 0 21 smaller than the values of 0 31 0 38 by jukić and denić jukić 2009 and hosseini et al 2017 the recession coefficients are estimated to be α 1 0 0046 α 2 0 037 and α 3 0 39 which are similar or comparable to the results of α 1 0 006 by fleury et al 2007 α 1 0 0028 α 2 0 091 and α 3 0 27 by jukić and denić jukić 2009 α 1 0 0033 α 2 0 033 0 04 and α 3 0 1 by hosseini et al 2017 α 3 0 25 0 37 by hartmann et al 2012 and α 3 0 7 by charlier et al 2012 the differences in the calibrated parameters are expectable given the differences in site conditions and model structures given the relatively short period of the available data the above mentioned model parameters were obtained based on calibration using the entire time series of both tunnel and spring discharge for an additional evaluation of model performance a simulation procedure was also carried out in which the 7 month time series of both the tunnel and spring discharge is divided into two parts for evaluation the first three months for calibration and the last four months for validation see figure s6 in the supplementary material it is shown the tunnel and spring discharges could be reasonably well predicted in the validation period which demonstrates again an acceptable performance of the model as a limitation of this study the spring and tunnel discharge data was not collected simultaneously in the calibration period and hence we have to make an assumption that the model parameters for the balance equations in smc epc gwc but not cdc were not significantly altered due to concrete lining and grouting of the tunnel this assumption was justified by a 3d discrete continuum numerical simulation zheng et al 2020 which suggests that on average the groundwater level in the studied hu dropped only 0 5 m and 0 05 m in 2017 and 2018 fig s7 in supplementary material respectively with this reasonable assumption the models calibrated with the spring discharge data in 2018 are enabled to predict the total discharge of the aquifer system and obtain the proportion of tunnel discharge around 19 using the tunnel discharge data observed in 2017 6 conclusions this study presents a series of modified lumped models with different structures or flow components to characterize the mechanisms and relationships between recharge and discharge in karst aquifers a particular concern is placed upon the impact of tunneling activities on the aquifer discharge by integrating a channel drainage compartment in the models the lumped models are applied to an independent hydrogeological unit hu where a deep buried tunnel is being constructed by comparing the performance of the models and by screening analysis of parameter sensitivities we find that the surface runoff the storage and recession effects of the epikarst zone and the base flow and quick flow in the vadose and phreatic zones are the dominant factors that control the recharge discharge relationship in the studied hu the calibrated model parameters are mostly comparable to the results calibrated in other catchments e g fleury et al 2007 jukić and denić jukić 2009 charlier et al 2012 hartmann et al 2013 hosseini et al 2017 the captured discharge by tunnel construction is predicted to account for about 19 of the total discharge from the aquifer system this work provides a useful tool for understanding the groundwater budget changes induced by anthropogenic activities such as tunnelling and underground mining in karst regions the obtained model parameters also provide a guidance and reference for evaluating the impact of large underground engineering projects in similar settings because of the simplicity as compared to distributed numerical approaches the modified lumped models may be effectively used by practitioners to inform water resources planning and decision making concerning the hydrogeological impact of engineering activities credit authorship contribution statement bing qi zhou investigation methodology formal analysis validation writing original draft zhibing yang investigation methodology formal analysis validation writing review editing ran hu formal analysis validation xian jin zhao investigation methodology yi feng chen conceptualization supervision formal analysis resources funding acquisition writing original draft writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work was financially supported by the national natural science foundation of china grant no 51925906 the national key r d program of china grant no 2018yfc0407001 and the guizhou province key science and technology project grant no 2017 3005 1 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2021 126375 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
4458,tunnelling activities may significantly alter the groundwater balance in a karst aquifer but assessment of this effect remains challenging due to the complex flow geometries and strong hydrogeological heterogeneity in this study based on extensive site characterization of an independent hydrogeological unit hu in which a deep buried tunnel is under construction we present a modified lumped model to evaluate the impact of tunnel construction on the discharge from the aquifer system the lumped model consists of four interacting flow compartments and the associated water balance equations a series of simplified models is then developed by merging or removing some of the flow components that represent different mechanisms and relationships between recharge and discharge the dominant hydrological processes in the hu are identified by comparing the performance of the models of different structures and by screening analysis of parameter sensitivities it is found that the tunnel excavation captured a mean portion of 19 discharge from the aquifer system into the tunnel which is comparable to the result predicted by 3d numerical simulations this study evidences that as a first and simple approximation the lumped models provide a useful tool for characterizing the dominant factors that govern the groundwater response and for evaluating the groundwater budget changes induced by anthropogenic activities such as tunnelling and underground mining in karst regions keywords karst aquifers groundwater balance lumped model tunnel construction 1 introduction karstic aquifers are characteristic of complex flow geometry and strong hydrogeological heterogeneity caused mainly by double or triple porosity structures consisting of pores fissures fractures and conduits of various scales white 2002 ford and williams 2007 hartmann et al 2014 consequently karst groundwater typically consists of base flow through fissure network and rapid flow through enlarged fractures and conduits jukić and denić jukić 2009 hosseini et al 2017 these characteristics give rise to significant challenges in groundwater flow modelling in karstic formations further complexity arises when anthropogenic activities e g tunnel construction are involved where the groundwater flow paths and discharges may be changed drastically within a short period hao et al 2016 lv et al 2020 even resulting in geological and environmental hazards such as mud and water inrush spring depletion and ground subsidence raposo et al 2010 pu et al 2011 mahler and bourgeai 2013 grimmeisen et al 2016 han et al 2017 jiang et al 2018 liu et al 2019 chen et al 2020 zhou et al 2021 a variety of hydrological models e g black box distributed and lumped have been proposed to confront the challenges and approximate the groundwater budget changes in karst formations beven 1989 fleury et al 2007 le moine et al 2008 makropoulos et al 2008 jukić and denić jukić 2009 hartmann et al 2012 the black box models treat an aquifer as a black box system and focus on establishing an overall relationship between input infiltration and output discharge completely disregarding the structure and the physical mechanisms of the aquifer dreiss 1983 mangin 1984 the distributed models solve flow equations with temporal and spatial discretization over the whole aquifer hence requiring detailed information on the aquifer structure and hydrological properties for producing an acceptable simulation zhang et al 2011 saller et al 2013 zheng et al 2020 the lumped models provide a compromised tool for karst groundwater simulation in which linear or nonlinear reservoirs compartments are used to represent different physical elements of the aquifer structure and groundwater circulation fleury et al 2007 2009 jukić and denić jukić 2009 each reservoir relies on a production function and a transfer function to simulate the process from input to output in each hydrogeological unit and hence the lumped models are suitable for aquifer simulation with limited observation data and insufficient field characterization spring discharge observations and trace element data are commonly used to calibrate the lumped models wagener et al 2003 hartmann et al 2013 ye et al 2014 mudarra et al 2019 particular concerns have been focused on the temporal variability in groundwater recharges and the effect of karst aquifers drainage induced by climate change or human activities jukić and denić jukić 2009 chang et al 2017 hosseini et al 2017 the construction of deep buried tunnels in karst regions can profoundly change the water budget in the karst system hence there is a need to revisit the structure and parameters of the lumped model for incorporating this strong impact of human activity this study is motivated by tunnel excavation induced karst groundwater budget changes in the jiayan water diversion project jwdp located in guizhou province southwest china in this work a modified lumped model is presented to quantitatively estimate the impact of tunnel construction on the karst aquifers by integrating a channel drainage compartment that represents the drainage from the karst aquifer to the tunnel during construction the model structure is systematically investigated through comparison of simulations with varying levels of simplification by merging or removing some of the flow components the dominant hydrogeological processes that control the aquifer discharge are identified by performance assessment of the models and sensitivity analysis of the input parameters the impact of tunnel construction on the aquifer discharge is finally quantified with the calibrated models which contributes to decision making for appropriate engineering treatments during tunnel construction 2 study site and data the study area is located in guizhou province southwest china fig s1a in supplementary material where karst landscapes cover about 62 of the land area chen et al 2020 it is bounded by the baifu river in the east the liuchong river in the south and a groundwater divide in the north the terrains range from 1300 to 2300 m a s l sloping from northwest to southeast the study area lies in the subtropical monsoon climate zone with a marked seasonal pattern in the annual variations of precipitation and air temperature the daily rainfalls are available from two meteorological stations at machang and weixin fig s1a in supplementary material about 80 of the annual precipitation occurs during the wet season between april and september with a mean annual precipitation of 895 mm the average annual temperature in the study area is 12 c a large scale water diversion project named jiayan water diversion project jwdp is currently under construction in this area mainly for water supply irrigation and power generation the project has an irrigation area of 600 2 km2 and is designed to benefit a population of 2 67 million people in 9 cities or counties it consists of two main tunnels i e maochang and shuidaqiao tunnels of 35 7 km long and typically 220 550 m in depth in which 60 2 of the tunnel sections were excavated in karst formations consisting of triassic and permian carbonate rocks fig s1a in supplementary material the carbonate rocks mainly consist of limestone marly limestone dolomite and marly dolomite geological features including folds faults karst conduits and underground rivers are present in the study area fig s1a in supplementary material separated by low permeability triassic clay mudstone and siltstone rocks as well as impermeable geological structures four independent karstic hydrogeological units hus i e maochang xiaotianba yinatianba and shuchang from northwest to southeast are identified in the study area fig s1a in supplementary material different lithology of carbonate rocks is distributed in the four hus in the maochang hu the dominant lithology is permian dolomitic limestone and underground karstification is mainly controlled by an anticline striking ne sw the xiaotianba hu is mainly composed of thick triassic limestone layers the main rock types in the yinatianba and shuchang hus are triassic limestone and dolomite underground river systems formed by karstification are developed in each hu with the river flow directions basically consistent with the distribution of sinkholes observed in the field in most cases one underground river is developed in each hu except that in the maochang hu there are three underground rivers i e dapo goudiaoyan and maluodong distributed from northwest to southeast the four underground rivers in the maochang and xiaotianba hus flow from north to south and discharge to the liuchong river the other two underground rivers in the shuchang and yinatianba hus flow from west to east discharging to the baifu river due to the difficulties and limitations in data collection this study focuses on the shuchang hu located southeast in the study area fig s1a in supplementary material the shuchang hu has an area of about 50 km2 and is separated from the yinatianba hu to the north by a local groundwater divide it is bounded in the north by a series of compressive shear faults to the west it is neighboring to the xiaotianba hu with the boundary located on a reverse fault an anticlinal fault core and low permeability rocks consisting of triassic mudstones and siltstones fig s1b in supplementary material the shuchang hu is controlled by the baifu river in the east and separated by a regional scale fault zone containing a series of compressive shear faults i e machang fault with one of its branches labeled as f106 in the south the compressive shear faults are all impervious and therefore the groundwater exchanges between this hu and the neighboring hus are negligible which has been evidenced by tracer tests conducted in 2017 the shuchang underground river fig s1 in supplementary material is located in the shuchang hu with depths ranging between 10 and 100 m and its recharge area is distributed at elevation of 1380 m the underground river discharges to the baifu river at the shuchang spring at elevation of 1160 m with a length of 5 9 km and a mean slope of 4 the underground river is connected to three large sinkholes and a dozen smaller sinkholes which allows for quick point recharge into the karst system the soil cover has a spatially varying thickness generally thin and with shrubbery vegetation in most areas of this hu the shuidaqiao tunnel together with 3 branch tunnels for construction passes through this hu the tunnel is aligned with a horizontal distance of about 30 100 m away from and 30 350 m deeper than the shuchang underground river the construction of the tunnel started in january 2016 and lasted for 30 months the discharge data from the tunnel was collected daily from june 2017 to december 2017 the daily discharge data from the shuchang spring i e the outlet of the shuchang underground river was not available in this period but was recorded between june 2018 and december 2018 3 methods 3 1 model development as depicted conceptually in fig 1 in the shuchang hu the rainfall infiltrates into the karst system by both diffuse flow through soil cover and quick flow through sinkholes and vertical shafts where the recharge area often varies as the groundwater level fluctuates white 2002 ford and williams 2007 the quick flow directly feeds into the underground river while the diffuse flow recharges the epikarst zone characteristic of relatively lower degree of karstification at the site bailly comte et al 2010 then the groundwater further moves vertically into the more karstified vadose and phreatic zones where the shuchang underground river is located in forms of base flow through fissured matrix network quick flow through karstified conduits and vertical shafts and intermediate flow through enlarged karstified fractures the groundwater finally discharges either by the spring at the outlet of the underground river or through the hyporheic zone of the baifu river tunnel excavation opened a new route for discharge based on the above conceptualization this study presents a modified lumped model mlm from previous reservoir models developed for karst systems rimmer and salingar 2006 fleury et al 2007 2009 jukić and denić jukić 2009 charlier et al 2012 hosseini et al 2017 with a particular concern on the groundwater discharge from the karst system to the tunnel the model consists of four compartments i e a soil moisture compartment smc an epikarst compartment epc a groundwater compartment gwc and a channel drainage compartment cdc as shown in fig 2 the smc and epc compartments account for the hydrological functioning storage and production of soil cover and epikarst zone respectively jukić and denić jukić 2009 hosseini et al 2017 the gwc contains three parallel sub compartments for simulation of base flow intermediate flow and quick flow of the total discharge the modifications are manifested by the cdc that accounts for the impact of tunnel excavation on the aquifer discharge fig 2 the moisture mass balance in the upper karst formations is quantified by the smc which reads 1 d v s d t p t e t a t r h t r r t r s t where p is the precipitation et a is the actual evapotranspiration r s and r h are the recharges to the underlying layers through diffuse flow and internal runoff respectively r r is the surface runoff when infiltration exceeds the soil storage capacities and dv s denotes the increment of moisture storage within a given time step dt one day in this study all terms in eq 1 are in mm day 1 et a in eq 1 represents the actual moisture loss from the soil cover and is typically formulated as palmer 1965 2 e t a t e t p t if v s t p t d t v smax e t p t v s t p t d t v smax if v s t p t d t v smax where v smax is the maximum capacity of soil to store the infiltrated water in mm and et p is the potential evapotranspiration in mm day 1 which can be estimated by the expression of eagleman 1967 3 e t p φ c t c w e max 100 r h 1 2 e max 6 1 exp 17 1 t 234 2 t where t is the air temperature in c rh is the relative air humidity in percent c w is a constant depending on wind velocity commonly taken as 0 8 φ is a correction coefficient equal to 0 0329 for δt 1 day chang et al 2015 and c t is a coefficient depending on air temperature jukić and denić jukić 2009 4 c t 0 63 if t 0 0 63 0 024 t if 0 t 21 1 13 if t 21 the quick recharge r h through sinkholes can be evaluated by empirically introducing a coefficient f h which describes the proportionality of net infiltration by means of quick flow 5 r h t f h max p t e t a t v smax 0 the surface runoff r r represents the part of the excess water when infiltration exceeds the maximum capacity of soil r r can be considered as a function of excessinfiltrationandexcessstorage of this layer by a fraction f r 6 r r t f r max p t e t a t v smax 0 in the moisture mass balance equation the stored moisture v s t is assumed to have a maximum capacity v smax the soil receives recharge from precipitation for v s t v smax and as the soil is saturated i e v s t v smax the excess infiltrated water i e r s t recharges to the epikarst zone the output of the smc is taken as the input of the epc fig 2 in which the mass balance equation is written as hosseini et al 2017 7 d v e d t r s t r e t where dv e is the increment of water stored in the epikarst zone within the time step dt r s is the recharge from the soil storage and r e is the seepage or overflow from the epikarst zone to the underlying karst formations again all the terms in eq 7 are in mm day 1 the term r e can be expressed as drainage controlled by linearity coefficient αe day 1 or as overflow rimmer and salingar 2006 hartmann et al 2012 8 r e t 1 α e v e t r s t d t v emax if v e t r s t d t v emax α e v e t r s t d t if v e t r s t d t v emax the epikarst zone is assumed to have a maximum capacity of storage v emax and the recharge r e to the underlying vadose and phreatic zones occurs as the stored water exceeds its maximum capacity i e v e v emax this recharge r e together with the quick recharge component r h is considered as the total recharge r t to groundwater in the gwc bonacci 2001 white 2002 9 r t t r e t r h t water flow in the gwc is divided into three components base flow through fissured matrix network intermediate flow through enlarged fractures and quick flow through karst conduits and vertical shafts these three flow components are assumed to be independent i e the water exchange among them is not considered as commonly done in previous studies fleury et al 2007 jukić and denić jukić 2009 charlier et al 2012 hosseini et al 2017 the intermediate flow has been considered to exhibit a nonlinear relationship between recharge and discharge jukić and denić jukić 2006 2009 the recharge of each flow component is partitioned from r t by a separation factor fi i 1 2 3 with f 1 f 2 f 3 1 10a d s 1 d t f 1 r t t q 1 t 10b d s 2 d t f 2 r t t q 2 t 10c d s 3 d t f 3 r t t q 3 t where si and qi i 1 2 3 are the groundwater storage and discharge of the ith reservoir respectively and qi can be represented by using the recession coefficient αi fleury et al 2007 jukić and denić jukić 2009 11a q 1 t α 1 s 1 t f 1 r t t 11b q 2 t α 2 s 2 t f 2 r t t β 11c q 3 t α 3 s 3 t f 3 r t t where β is an exponent for the component of nonlinear intermediate flow the gwc then yields the total flow to the cdc r q by 12 r q t a q 1 t q 2 t q 3 t where a denotes the area of recharge finally the cdc takes r q t as the input to calculate the discharges from the spring at the outlet of the underground river and from the tunnel system respectively by introducing two factors γ 1 and γ 2 satisfying γ 1 γ 2 1 13a d v 1 d t γ 1 r q t q 1 t 13b d v 2 d t γ 2 r q t q 2 t where v 1 and v 2 are the storage in the underground river and the tunnel respectively and q 1 and q 2 in m3 day 1 are the discharge at the spring and the amount of drainage in the tunnel respectively the modified lumped model considers the interaction between tunnel and the aquifer system making it useful to quantitatively evaluate the impact of tunnel construction on the water balance fig 2 in the cdc the influence of tunnel excavation on the spring discharge variation is characterized by two factors γ 1 and γ 2 when no tunneling activity is involved the factor γ 2 vanishes and the model is reduced to previous models e g fleury et al 2007 jukić and denić jukić 2009 hosseini et al 2017 the model involves a total of 15 parameters but given the constraints that σfi 1 and σγi 1 the model contains 13 independent parameters to be calibrated as summarized in table 2 the typical ranges of these parameters are listed in table 1 by reviewing the literature fleury et al 2007 jukić and denić jukić 2009 charlier et al 2012 hartmann et al 2013 hosseini et al 2017 3 2 model simplifications the modified lumped model presented in section 3 1 hereafter denoted by mlm1 represents the general case of groundwater balance in a karst aquifer system with tunneling activity to systematically identify the dominant hydrological processes and parameters in the lumped water balance model we also present simplified versions of mlm1 and perform model calibration and simulations we consider varying levels of complexities in the model structure by reducing the number of compartments and or removing certain flow processes and parameters the first category keeps the four compartment structure but the vertical flow f h nonlinearity coefficient β or intermediate flow component f 2 α2 and β is respectively removed from the original model denoted by mlm2 4 fig s2a c in supplementary material specifically mlm2 ignores the recharge component of the sinkhole mlm3 characterizes the intermediate flow with a linear recession in mlm4 the intermediate flow component in the gwc compartment vanishes meaning that the groundwater is grouped into slow through small fissures and fast through conduits flows the second category reduces to a three compartment structure by merging the soil and epikarst compartments and then removing the recession coefficient αe intermediate flow component f 2 α2 and β or both components αe f 2 α2 β respectively denoted by mlm5 8 fig s3a d in supplementary material models of mlm5 8 represent a system of unified compartment for the unsaturated zones near the surface without considering the effect of storage capacity of thin soil layer table 2 summarizes the number of independent parameters and the number of reservoirs contained in each simplified model by simplifications and alterations of the model structure the dominant hydrological processes can be progressively identified 3 3 model calibration application of the proposed model and its simplified versions requires proper calibration of the parameters listed in tables 1 and 2 this study adopts the shuffled complex evolution metropolis scem ua method for calibration vrugt et al 2003 this method uses an adaptive evolutionary monte carlo markov chain mcmc algorithm for identification of the optimal parameter sets table 2 and quantification of uncertainties by inputting the time series data of precipitation and spring discharge it combines complex shuffling with the metropolis hastings mh search strategy for population evolution more details about scem ua method can be found in vrugt et al 2003 the convergence of the method can be evaluated with a diagnostic score a value of the score less than 1 2 is generally considered to indicate a convergence to a stationary distribution as shown in table s1 in the supplementary material all values of the score are well below 1 2 which means that a satisfactory convergence is achieved for all the models the nash sutcliffe coefficient of efficiency nse is selected as the criterion for evaluation defined by nash and sutcliffe 1970 14 nse 1 y i y s i 2 y i y 2 where yi and ys i are the observed and simulated discharges at time ti respectively and y is the mean observed discharge in this criterion if nse 0 5 the simulation can be considered acceptable if nse 0 65 the model is considered satisfactory and if nse 0 75 the model is considered to perform well moriasi et al 2007 the same settings of the scem ua method for calibration are used in all models with the number of complexes the population size and the maximum number of iterations being 6 500 and 50 000 respectively three frequently used measures i e the coefficient of correlation cc the root mean square error rmse and the mean absolute error mae are also computed for model comparison the definitions of these measures are listed in table 3 where n is the number of observed or simulated time series data initial guesses of some model parameters in table 2 could be qualitatively obtained by the time series analyses of daily rainfall and spring discharge observation the autocorrelation function acf and cross correlation function ccf provide an initial estimation for the range of recession coefficients in the gwc compartment the acf is an effective tool to evaluate the linear dependency of continuous values over a period of time and the memory effect of karst systems schuler et al 2020 the memory effect can be understood as the hysteresis of the karst aquifer storage the autocorrelation coefficient commonly takes the threshold of 0 2 to distinguish the memory effect in karst hydrology mangin 1984 as shown in fig 3 a the plot of acf for the shuchang spring discharge indicates a lag value of 30 days and hence a distinct memory effect of the studied aquifers the cross correlation function ccf is used to analyze the relationship between two time series which describes as a crucial indicator the degree to which the time series are linearly correlated the peak and the lag value of the cross correlation provide information about the time interval representing the pressure pulse transfer into the aquifer fu et al 2016 according to mangin 1984 and katsanou et al 2015 the range of the quick recession coefficient α3 can be qualitatively estimated by the ccf between rainfall and spring discharge as plotted in fig 3b the ccf between daily precipitation and the shuchang spring discharge predicts a lag of 2 days when the ccf attains its peak at 0 55 this lag time indicates a rapid response of the spring to rainfall events and a moderate degree of karstification in the studied catchment as a first approximation the quick recession coefficient α3 can be roughly estimated as the reciprocal of the lag time i e α3 0 5 day 1 which is within the range given in table 1 3 4 sensitivity analysis to identify the dominant hydrological processes that contribute to the spring discharge the pawn method presented by pianosi and wagener 2015 is adopted to evaluate the global sensitivities of the model parameters the pawn method calculates the sensitivity of a certain input parameter xi by comparing the conditional cumulative distribution function cdf of the model outputs when keeping the input parameter xi constant to the unconditional cdf when all the parameters are varied randomly the two sample kolmogorov smirnov statistic is used to measure the distance between the unconditional and conditional cdfs for each input given by kolmogorov 1933 15 ks x i max y f y y f y x i y where fy y and f y x i y are the unconditional and conditional cdfs of the model output y respectively practically fy y can be approximated by a number of nu outputs sampling over the entire feasible space of the input parameters and f y x i y can be approximated by nc outputs sampling over the non fixed input space i e except xi the sensitivity of the model parameters is quantified by the so called pawn index ti defined as the maximum values of ks over all possible values of xi pianosi and wagener 2015 16 t i max x i x i 1 x i n ks x i where x i 1 x i n are n randomly sampled values for the fixed input xi the pawn sensitivity index ti varies from 0 to 1 and a larger value indicates greater model sensitivity to that input parameter the total number of simulations needed for m input parameters is nu nmnc the appropriate settings of nu nc and n can be chosen by trial and error pianosi and wagener 2015 this study takes nu 200 nc 150 and n 15 and further increasing the numbers would not affect the result of sensitivity evaluation 3 5 tunnel discharge calculation in the modified lumped models the cdc quantifies the impact of tunnel construction on the discharge of karst aquifers through the separation factors γ 1 and γ 2 in the study area the shuidaqiao tunnel is located below the underground river and hence the tunnel excavation would lead to discharge of groundwater from the tunnel and reduction of discharge from the spring after the tunnel was fully concrete lined and grouted in july 2018 the groundwater inflow became negligible given the relatively limited data recorded at the site we first calibrate the model parameters with the scem ua method using the daily precipitation and spring discharge data collected from june 1 to december 31 2018 during which the tunnel inflow was negligible i e γ 2 0 and γ 1 1 see table 2 the calibrated model parameters are then used to predict the total discharge r q in 2017 the separation factors γ 1 and γ 2 are finally calibrated with the gradient descent approach polak 1997 using the tunnel discharge data available during june 1 and december 31 2017 the above calibration procedure is depicted in fig s4 in supplementary material this procedure involves an assumption that the model processes and responses defined by the model parameters except those in the cdc compartment were not significantly altered before and after the tunnel was lined and grouted we note that had the discharge data been simultaneously collected from both the spring and the tunnel system the result could be more convincing 4 results 4 1 model structures and performance both four and three compartment models mlm1 8 are used to simulate the groundwater response in the shuchang hydrogeological unit the scem ua method with the nse criterion is used to calibrate the parameters of each model after a warm up period of one month to eliminate the influence of initial conditions on the result as an example fig 4 presents the box whisker plot of the calibrated parameters for the model mlm1 having the most complex structure figs 5 and 6 plot the spring discharge curves simulated by each model during the calibration period from june 1 to december 31 2018 together with the 95 confidence intervals table 4 shows that the rmse cc and mae values are strongly correlated to nse for the performance of the models the four compartment models mlm1 4 all performs well with nse 0 79 0 81 a comparison between mlm1 and the other four compartment models fig 5 and table 4 shows that the vertical flow component f h has a negligible effect on the spring discharge mlm2 and removing the intermediate flow component f 2 α2 and β leads to a marginal decrease of model performance from nse 0 81 to nse 0 80 mlm4 but when the lumped model is further simplified to the three compartment models by merging the soil and epikarst compartments mlm5 8 the value of nse significantly reduces to 0 70 0 74 fig 6 and table 4 decreasing the goodness of fit from good to satisfactory the model evaluation indicates that the recession coefficient of epikarst reservoir αe is a critical parameter and plays a more important role than the intermediate flow removing it results in a significant decrease of nse from 0 74 to 0 70 mlm6 it is interesting to note that removing the intermediate flow component may even perform slightly better than the cases when a linear model is used comparing mlm4 to mlm3 or when the recession effect of the epikarst zone is ignored comparing mlm6 to mlm8 4 2 impact of tunnel excavation the separation factors γ 1 and γ 2 in the cdc compartment is calibrated using the precipitation and tunnel discharge data in 2017 by assuming that the hydrogeological processes defined by the model parameters were not significantly altered after completion of tunnel lining and grouting in 2018 as shown in figs 5 and 6 all the four and three compartment models perform fairly well to predict the tunnel discharge in terms of the values of rmse cc and mae the calibrated factor γ 2 representing the proportion of tunnel discharge from the total discharge r q of the aquifer system varies in a narrow range between 0 17 and 0 23 with a mean value of 0 19 in good agreement with a value of 0 24 fig s5 in supplementary material based on a 3d discrete continuum numerical simulation zheng et al 2020 this can be justified by the fact that the study area is an independent hu in which the groundwater discharged mainly through the shuchang spring and the tunnel even though the spring discharge was not recorded in the calibration period june 1 december 31 2017 it is reasonably estimated through the modeling analysis that the spring discharge was reduced by around 19 and this amount of groundwater was captured by the tunnel system it can also be noted that the variation of the observed data is actually smaller than that of the simulated data this is due to the way the tunnel discharge was measured to maintain construction progress discharged water in the tunnel had to be pumped out a small ditch was used to divert the discharged water along the tunnel to the pumping location and the pumping rate was monitored to represent the total tunnel discharge the measurement by the pumped flow rate might have partially smoothened the real time variations in tunnel discharge due to site operations and water storage effects in the tunnel however we expect that the average discharge rate to the tunnel and the total amount of tunnel discharge are reasonably estimated in this way 4 3 sensitivity analysis the sensitivities of the input parameters in the lumped models to the spring discharge are evaluated with the pawn method pianosi and wagener 2015 which helps understand the dominant factors that control the predictive accuracy of the models a parameter is considered sensitive to model output if the sensitivity index ti is larger than the critical value 0 15 of the ks statistic at the significance level of 0 05 the ks statistic values at various conditioning values of the input parameters of mlm1 are shown in fig 7 table 5 summarizes the values of the sensitivity index ti for each parameter in the lumped models mlm1 8 the screening analysis shows that in all of the models the components of epikarst v emax α e base flow f 1 α 1 quick flow α 3 and surface runoff f r together with recharge area a are highly sensitive to the spring discharge whereas the components of soil cover v smax vertical flow f h and intermediate flow f 2 α 2 and β are less significant to the model output but in some of the simplified models e g mlm5 6 the recession coefficient α 2 and the nonlinearity exponent β may exhibit moderate sensitivities while in the models mlm6 and mlm7 the parameters v emax and f r become insignificant respectively 5 discussion in section 4 we have identified the dominant hydrogeological processes in the shuchang hu by comparing the performance of a series of models with different degree of simplifications and by screening analysis of parameter sensitivities we find that the four compartment models consistently perform better than the three compartment counterparts but as a result of the thin thickness of the soil cover the calibrated soil storage capacity v smax is around 2 mm mlm1 and is less sensitive to the aquifer discharge this optimal value of v smax is comparable to the calibrated result 1 3 mm in catchments with thin soil cover jukić and denić jukić 2009 hartmann et al 2013 hosseini et al 2017 the calibrated fraction of surface runoff f r is 0 57 comparable to the values between 0 41 and 0 80 given by rimmer and salingar 2006 the calibrated recharge area a is 36 km2 which is smaller than the area of the catchment about 50 km2 but the vertical flow component is insignificant as a result of small ratio of the recharge area through sinkholes to that in the entire catchment the epikarst zone is well developed in the study area and hence its storage capacity and recession effect play a significant role in the groundwater balance the model mlm1 calibrates an optimal linearity recession constant of α e 0 33 slightly higher than the range of 0 09 0 3 reported by charlier et al 2012 and 0 04 0 2 by hartmann et al 2013 in the vadose and phreatic zones at the site only the base flow and quick flow components are significant this may be due to the fact that the intermediate flow through enlarged fractures can be well compensated by tuning the parameters in the base flow and quick flow components but when the intermediate flow is modelled it is better to consider the nonlinear effect of recession as suggested by jukić and denić jukić 2009 the nonlinearity coefficient β is estimated to be 1 63 close to the value of 1 65 by jukić and denić jukić 2009 the calibration by mlm1 indicates a base flow separation factor of f 1 0 51 consistent with the value of 0 50 by jukić and denić jukić 2009 and comparable to the values between 0 41 and 0 82 reported by fleury et al 2007 charlier et al 2012 hartmann et al 2013 and hosseini et al 2017 the intermediate flow possesses a proportion of f 2 0 21 smaller than the values of 0 31 0 38 by jukić and denić jukić 2009 and hosseini et al 2017 the recession coefficients are estimated to be α 1 0 0046 α 2 0 037 and α 3 0 39 which are similar or comparable to the results of α 1 0 006 by fleury et al 2007 α 1 0 0028 α 2 0 091 and α 3 0 27 by jukić and denić jukić 2009 α 1 0 0033 α 2 0 033 0 04 and α 3 0 1 by hosseini et al 2017 α 3 0 25 0 37 by hartmann et al 2012 and α 3 0 7 by charlier et al 2012 the differences in the calibrated parameters are expectable given the differences in site conditions and model structures given the relatively short period of the available data the above mentioned model parameters were obtained based on calibration using the entire time series of both tunnel and spring discharge for an additional evaluation of model performance a simulation procedure was also carried out in which the 7 month time series of both the tunnel and spring discharge is divided into two parts for evaluation the first three months for calibration and the last four months for validation see figure s6 in the supplementary material it is shown the tunnel and spring discharges could be reasonably well predicted in the validation period which demonstrates again an acceptable performance of the model as a limitation of this study the spring and tunnel discharge data was not collected simultaneously in the calibration period and hence we have to make an assumption that the model parameters for the balance equations in smc epc gwc but not cdc were not significantly altered due to concrete lining and grouting of the tunnel this assumption was justified by a 3d discrete continuum numerical simulation zheng et al 2020 which suggests that on average the groundwater level in the studied hu dropped only 0 5 m and 0 05 m in 2017 and 2018 fig s7 in supplementary material respectively with this reasonable assumption the models calibrated with the spring discharge data in 2018 are enabled to predict the total discharge of the aquifer system and obtain the proportion of tunnel discharge around 19 using the tunnel discharge data observed in 2017 6 conclusions this study presents a series of modified lumped models with different structures or flow components to characterize the mechanisms and relationships between recharge and discharge in karst aquifers a particular concern is placed upon the impact of tunneling activities on the aquifer discharge by integrating a channel drainage compartment in the models the lumped models are applied to an independent hydrogeological unit hu where a deep buried tunnel is being constructed by comparing the performance of the models and by screening analysis of parameter sensitivities we find that the surface runoff the storage and recession effects of the epikarst zone and the base flow and quick flow in the vadose and phreatic zones are the dominant factors that control the recharge discharge relationship in the studied hu the calibrated model parameters are mostly comparable to the results calibrated in other catchments e g fleury et al 2007 jukić and denić jukić 2009 charlier et al 2012 hartmann et al 2013 hosseini et al 2017 the captured discharge by tunnel construction is predicted to account for about 19 of the total discharge from the aquifer system this work provides a useful tool for understanding the groundwater budget changes induced by anthropogenic activities such as tunnelling and underground mining in karst regions the obtained model parameters also provide a guidance and reference for evaluating the impact of large underground engineering projects in similar settings because of the simplicity as compared to distributed numerical approaches the modified lumped models may be effectively used by practitioners to inform water resources planning and decision making concerning the hydrogeological impact of engineering activities credit authorship contribution statement bing qi zhou investigation methodology formal analysis validation writing original draft zhibing yang investigation methodology formal analysis validation writing review editing ran hu formal analysis validation xian jin zhao investigation methodology yi feng chen conceptualization supervision formal analysis resources funding acquisition writing original draft writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work was financially supported by the national natural science foundation of china grant no 51925906 the national key r d program of china grant no 2018yfc0407001 and the guizhou province key science and technology project grant no 2017 3005 1 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2021 126375 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
4459,in this paper six critical topics in social learning sl definition and applications are discussed 1 clarification of the sl definition 2 the role of sl in the management of shared water resources 3 the definition of learning in sl 4 the quantification of sl 5 the relation of sl with outputs of social networks analysis sna and stakeholder analysis sa 6 identifying and ranking of key stakeholders i e influencers for sl diffusion after defining sl we present sl s role using a well known game theory problem we have addressed the term learning in sl using an existing method namely reinforcement learning we present a new approach for quantifying sl within a hydrological environment and finding key stakeholders for the sl diffusion for the first time we consider a combination of sl sa and sna to propose a comprehensive social based approach to investigate sl diffusion the western part of tehran city which is suffering from some water and environmental issues such as overexploitation of groundwater and land subsidence is the case study of this paper the results show a significant relationship between sl and the outputs of sna the suggested method for identifying key stakeholders has been able to identify key stakeholders in terms of various water resources management issues in the study area the results can be used for developing effective policies towards sustainable management of water and environmental resources in the studied socio hydrological system keywords individual and social optimality kan river basin social learning sl social network analysis sna stakeholder analysis sa reinforcement learning 1 introduction the tragedy of commons is the consequence of the users selfish behaviors and their increasing demand for already scarce common pool resources hardin 2009 the limitation of available water resources and the presence of stakeholders with conflicting interests can exacerbate the selfishness self regard behavior leads to individual optimality io in which a stakeholder decides to take steps to maximize its profit regardless of the system welfare io may be different from social optimality so where the stakeholders choose actions to maximize the whole system s total profit and increase its level of performance hao and leung 2015 in most water resources systems several stakeholders can be identified it increases the importance of using socio hydrological approaches for modeling and management of water resources systems aghaie et al 2021 the management of water resources systems can be defined as a function of the stakeholders actions and the stakeholders behaviors may be affected by the community they belong to the coevolving interaction between hydrological and social systems may lead to unforeseen patterns that can induce critical environmental and social issues pouladi et al 2019 due to the failure of traditional approaches in solving current water resource management issues social based concepts such as social learning sl have been recently taken into account for developing management policies sl in shared resources management can be considered the changes and modifications in the norms beliefs and values towards sustainable use of shared resources the harmonising collaborative planning harmonicop project in europe is an appealing exemplary effort to consider and study social aspects in river basin management in harmonicop sl is viewed as the growing capacity of social entities to perform common river basin management tasks mostert 2003a 2003b in the harmonicop project sl has a central role in public participation and has been defined as learning to manage together cernesson et al 2005 in other words sl is a bridge between social and natural environments and is described as learning by groups authorities stakeholders and experts to handle issues in which all group members and stakeholders have a stake sl has been redefined since this term was used by bandura 1977 but its definition is still vague some papers such as reed et al 2010 were presented almost only for clarifying sl definition reed et al 2010 defined sl as a change in understanding beyond individuals through social interactions between actors in social networks they emphasized that in studying sl the following conditions and situations should be considered 1 the condition that is needed to facilitate sl such as stakeholders participation should not be confused with sl itself 2 the sl should not be confused with its outcomes 3 the distinction between sl and individual learning needed to be considered pahl wostl et al 2007 declared that sl takes place in social networks or communities and can be an outcome of the governance structure they showed that sl could occur on three time scales 1 short to medium time scale at the level of processes among collaborating stakeholders 2 medium to long time scales at the level of change in actor networks 3 long time scale at the level of change in the governance structure a review of sl s definitions and applications in the field of water resource management is presented in table a1 as the sl is a new concept it would be interesting to know its role in water resource management especially in a non cooperative environment therefore we consider a well known example in game theory literature as a benchmark for evaluating the sl s role also to define the meaning of learning in sl we compare sl with the reinforcement learning concepts we present a description of the study area and its water resource management problems based on the main identified challenges regarding the quantity and quality of water and treated wastewater resources we designed a questionnaire to identify the main stakeholders in the questionnaire two main types of questions i e open and closed questions have been considered we used the answers to the open questions for the sl evaluation we used the closed questions answers where the answers must be chosen from some fixed alternatives for the sa and sna we interpreted the stakeholders responses to identify the relations between the stakeholders social network and sl conditions in previous works it has been pointed out that there is a relationship between sl and social network characteristics reed et al 2010 but this relationship has not been quantified a closer look at the findings of sna can help promote sl using the responses provided by the main stakeholders the relationship between sl and sna has been evaluated in addition to the sl estimation we provided a new approach for promoting sl in the study area in this approach we considered a combination of the sl sna and sa to find the leading stakeholders for sl diffusion regarding various aspects of water resources in a hydrological environment the main questions which are answered in this paper are as follows 1 what is sl how can it be defined considering previous learning based methods a comprehensive review of the relevant works is presented to answer the above question also considering the reinforcement learning approach we attempt to provide a precise definition of learning in the concept of sl 2 which category of water resources engineering and management issues can be considered as a context for using the concept of sl in a problem where several stakeholders with strategic behaviors are involved the game theoretic approaches can be used to analyze the system barough et al 2012 emami skardi et al 2013 kerachian et al 2010 niksokhan et al 2009 sadegh et al 2010 because sl has mainly been considered in multi stakeholder systems a very well known example in game theory i e the prisoners dilemma pd is considered to define sl s role in shared water resource management 3 what is the relationship between sl and other social based methods used for water resource management in this paper some of the most important existing methods for studying social aspects of water resources engineering and management issues have been discussed and their relations with sl have been studied 4 what is the necessity importance and method of quantifying sl for water resource management sl has not been quantified in sl s previous applications in water resources engineering and management while for incorporating sl in simulation and optimization models and comparing stakeholders in terms of sl it is necessary to quantify sl therefore we attempt to provide a new approach for the evaluation and quantification of sl 5 how can key stakeholders or influencers for the sl diffusion be identified given the importance of influencing stakeholders for developing sl it is essential to identify the leading stakeholders in a system in this paper a combination of the sl sna and sa has been considered to find the sl diffusion s key stakeholders regarding various water resource issues this paper is organized as follows in section 3 the role of sl in water resources management is discussed in section 4 the sl definition is described using game theory and reinforcement learning approach a novel approach is presented in this section to quantify sl and its relation with sna and promote sl diffusion in section 5 the study area and its water and environmental issues are described after all the main finding and concluding remarks are presented 2 the role and definition of sl in a multi stakeholder environment sl is mainly developed to deal with multi stakeholder issues in a community of stakeholders using a well known example of shared resource management namely the pd in the game theory concept sl s role in water resources management is defined game theory is a powerful tool to study the strategic interactions among stakeholders in strategic water resource management issues the game theory has been successfully applied to water quality management e g emami skardi et al 2013 kerachian and karamouz 2007 niksokhan et al 2009 estalaki et al 2015 groundwater management e g bazargan lari and kerachian 2008 and pal et al 2020 transboundary water resources allocation e g yuan et al 2019 and urban runoff management e g ghodsi et al 2016a b various approaches have been presented to reach so in the game and one approach is to consider the penalty for the person who selects selfish actions madani 2010 hao and leung 2015 recently in dealing with io so problems eyni et al 2021 proposed a novel approach for the quantity and quality management of shared water resources using the correlated equilibrium concept from the game theory field in this paper according to the importance of the game theory concept in dealing with io so situation and using the pd game we explain the role of social attachment in natural resources management 2 1 the role of sl in changing pd game s answer from io to so pd is a well known standard example to study the stakeholders behavior in a multi stakeholder system this game has been used in many studies such as barrett 1994 becker and ester 1999 msangi 2005 madani and lund 2010 wu and zhou 2017 du et al 2019 the pd game can be used for studying stakeholders decision making in common resources management where two entirely rational players may not cooperate even with higher outcomes for the system further details of the pd game are given in annex i and figs a1 and a2 finding a way to achieve so is a challenging task in the past years various approaches have been presented to solve the pd games for example madani 2010 considered a penalty to reach so saak and peterson 2007 studied the behaviors of the stakeholders under incomplete information msangi 2005 evaluated the role of learning in stakeholders behaviors in shared groundwater management nakao et al 2002 tried to improve the non cooperative behaviors in a shared aquifer by proposing a framework for cooperation which increases the benefits of stakeholders based on most of the previous papers the existence of a powerful government can force players to cooperate and provide a socially optimal solution fig 1 the command and control approach has been mainly used to achieve so fig 1 however its efficiency may be questionable for the following reasons a in large scale problems like most of the hydrological issues monitoring of stakeholders behaviors even if be possible can be expensive complicated and troublous hao and leung 2015 b using punishment for enforcing players in a large society may lead to social resistance sl can be used instead of a penalty based method to direct the system s state from io to so the difference between using sl and penalty is that penalty changes in the value of rewards and forces the stakeholders to achieve so but sl makes a change in the way that stakeholders look at the issue and give them awareness about the consequences of their choices and they could achieve so without any pressure sl is not a magic approach for achieving so mostert et al 2008 but it can be considered along with other techniques for leading stakeholders to so 2 2 what kind of learning is sl sl is based on learning in a community of stakeholders although learning is a key element in human behaviors the definition of learning in sl should be clarified suppose we have a large scale environment like most of the water resources systems in that case an agent can decide and after receiving feedback from the environment the agent can assess his decision considering his values and norms the next step decision can be modified and updated based on the previous step s feedback this process in a large scale water resource system can be called learning fig 2 some studies have tried to formulate the learning process and make it algorithmic for example the reinforcement learning concept which simulates the learning process in human s has been applied to some water resources management problems such as reservoir operation castelletti et al 2002 mahootchi et al 2007 water allocation in the river basins abolpour et al 2007 urban water management and wastewater allocation emami skardi et al 2020 because of the algorithmic form of reinforcement learning it would be reasonable to use this concept to elaborate on the meaning of learning in sl reinforcement learning involves states actions estimated outcomes based on a reward function that is originated from the agent s norms and values and ultimately a decision that is made for the next step fig 2 each agent s reward function is defined according to the system s condition and the chosen actions finally the received payoff is evaluated based on the agents values and norms for example if a farmer intends to maximize his profit by selling agricultural products and his decisions actions are the amount of groundwater withdrawal harvesting and cultivar type his reward function can be defined based on these actions while the actions and environment are changing the norm which could be maximizing the total profit is usually considered constant the learning process used in reinforcement learning based algorithms can be considered a subset of sl the main difference between sl and reinforcement learning is the modification of norms and values in sl sl in water resources management can be defined as the changes in the norms beliefs and values towards sustainable use of water resources fig 3 3 methodology in this section we describe the main parts of the proposed methodology for the first time an attempt has been made to quantify sl study its relationship with sna and identify the sl diffusion s leading stakeholders a flowchart of the methodology is demonstrated in fig 4 3 1 system recognition system recognition has some basic parts delineation of the study area determination of environmental problems stakeholder identification and data collection the system s boundaries are usually defined as the river basin s boundaries after determining the physical boundaries the main challenges related to water and environmental systems are determined then the main stakeholders in the study area are identified to identify the key stakeholders a pre interview should be carried out and then using the snowball method goodman 1961 the list of main stakeholders is completed a questionnaire is designed to collect the required data for the sa sna and sl evaluation the gathered data should cover the physical features the main problems and stakeholders characteristics 3 2 stakholder analysis sa social network analysis sna and social learning sl evaluation to have a comprehensive evaluation of stakeholders in the study area these social based approaches are applied 3 2 1 stakeholder analysis sa defining the main stakeholders and their characteristics is always a challenging task stakeholders are individuals groups or organizations that can affect or be affected by the actions and decisions made to govern a system grimble and wellard 1997 reed 2008 grimble 1998 sa can have three main steps 1 identifying the stakeholders 2 categorizing the stakeholders and 3 investigating existing relationships between the stakeholders reed et al 2009 in the first step sa organizations groups and individuals who hold a stake regarding a specific issue are identified ahmadi et al 2019 then regarding their characteristics stakeholders are classified and their key differences are determined to determine whose interests are relevant in the process of implementing a given policy or program sa collects and analyzes qualitative information in a systematic way using semi structured interviews and interest influence matrices schmeer 1999 reed et al 2009 ahmadi et al 2019 quantified values of power interest and access to information can be the sa outputs we evaluate each stakeholder s power and interest using the following equations 1 p i j 1 n p ij n 2 i i j 1 n i ij n where p i and i i are the i th stakeholder s power and interest indices respectively p ij and i ij are power and interest values that j th stakeholder assigns to i th stakeholder respectively and n is the total number of stakeholders 3 2 2 social network analysis sna to form and analyze a social network the existing relationships among stakeholders should be identified then the characteristics of the relationships and the network should be determined this task i e calculating in degree and betweenness centrality indices can be done using some existing software such as ucinet and netdraw ahmadi et al 2019 or gephi bastian et al 2009 in some previous studies e g crona and parker 2012 cundill and rodela 2012 mills et al 2014 schwilch et al 2012 reed et al 2010 the relation between the sl and sna has been emphasized using sna methods the social network characteristics are calculated and a better understanding of the relationships the roles and responsibilities of the stakeholders is obtained since the sl occurs in a social network between the stakeholders due to the understanding obtained by sna it is possible to manage the sl diffusion better and identify key stakeholders for accelerating the sl process fig 5 the main sna indices considered in identifying the key stakeholders for sl diffusion are betweenness centrality and in degree the in degree is calculated as follows ahmadi et al 2019 3 ic j i 1 n r ij where ic j are the in degree centrality of the j th node n in the number of nodes i e stakeholders and r ij is element of i th row and j th column of the adjacency matrix which is an n n matrix r ij is equal to 1 if there is a link from i th node to j th node and is equal to 0 if there is no link from i th node to j th node the higher values of ic j mean that j th stakeholder has a more central position since more stakeholders have institutional relationships with this stakeholder ahmadi et al 2019 we applied the following equation to calculate the betweenness centrality freeman 1978 if σ jk equals to the total number of geodesic paths between nodes j and k and σ jk i equals to the number of these paths which pass through node i the betweenness centrality of node i i e b i when i j and k are distinct is calculated as follows ahmadi et al 2019 4 b i i j k σ jk i σ jk a stakeholder with high betweenness centrality value can act as an intermediary stakeholder since it lies on many different stakeholders network paths 3 2 3 social learning sl in the sl literature three learning levels have been defined single loop learning double loop learning and triple loop learning medema et al 2014 as shown in fig 3 a single loop which is the simplest type of learning happens when just the action is changed based on feedback one step ahead double loop learning occurs when the intention of doing an action changes the last and most comprehensive type of learning is triple loop learning in this type of learning changes in beliefs norms and governance are needed single loop learning is entirely consistent with reinforcement learning learning loops can help to classify and identify the sl occurring in a system therefore in this paper this approach has been used to evaluate and quantify the sl an open questionnaire considering the main issues related to surface water quantity and quality groundwater quantity and quality and wastewater reuse should be designed to estimate sl according to io and so s learning loops the stakeholders responses to the challenges that refer to the crisis should be classified if the answer is only related to the agent s concerns it is considered io on the other hand a so based response focuses on the system s interests answers can also be appropriate or inappropriate a stakeholder may understand an issue mentioned in the questionnaire and provide a solution this answer is called appropriate for example land subsidence may be a serious problem in an area and has been scientifically proved some stakeholders may understand this problem and have some proposals for tackling the issue following io or so interests a stakeholder may not be aware of the land subsidence and provide a wrong or inappropriate answer the answer of stakeholders to the questions can also be classified based on the learning loops according to the number of answers in each learning class the learning case score lcs is calculated a flowchart of the social learning evaluation is demonstrated in fig 6 3 3 identification of the influencers for the sl diffusion most of the literature regarding sl s applications in water resource management has focused on the sl estimation without suggesting sl s diffusion one of the most important ways of developing sl is the influence of stakeholders on one another therefore leading stakeholders should be identified for the sl diffusion a proper sa level can be appropriate for the sl development but it is not enough therefore the findings of sa sna and lcs are used to identify leading stakeholders for the sl development more details are presented using an example in the results section 4 case study the kan river basin is located in the tehran metropolitan city s western part fig 7 the main water resources of the study area are surface water reclaimed wastewater and groundwater a variety of land use can be identified in this study area such as agricultural residential industrial areas green spaces and a large recreational lake darbandsari et al 2017 the kan river basin starts from the northern part of tehran city and ends at tehran qom old road in the south the eastern and western boundaries of the area are defined perpendicular to equipotential lines of groundwater therefore the assumption of no inflow and outflow from the eastern and western borders is reasonably acceptable darbandsari et al 2020 fig 7 the kan river basin can represent a developing urban region with serious issues related to supplying drinking agricultural green space and industrial water demands besides several major environmental problems emami skardi et al 2020 khorasani et al 2020 ahmadi et al 2020 the kan river basin also suffers from policy related concerns such as conflicts among stakeholders about the allocation of treated wastewater ahmadi et al 2019 the average annual precipitation in the kan river basin is 230 mm the study area includes four water users the water demands and the amount of water withdrawal from ground and surface water resources are presented in table 1 the study area is challenging and interesting for investigating social learning based on the following reasons adapted from ahmadi et al 2019 covering some rapidly growing populated regions located near some large industries and agricultural regions covering some new human made recreational areas unlawful water withdrawals from the surface and groundwater existence of several stakeholders with different characteristics and conflicting utilities 4 1 stakeholders identification in this paper only the institutional stakeholders are considered hence stakeholders in the lowest level of decision making such as individual farmers are not considered the primary identification of key actors has been made using a pre interview with several key experts snowball sampling was applied in both the stakeholder s identification and data collection stages to find the main stakeholders moreover the physical characteristics i e land use main water bodies and related infrastructures political and hydrological boundaries and water demands of the kan river basin have been studied to identify the organizations that hold a prominent stake the main stakeholders are introduced in table 2 ahmadi et al 2019 suggested that the stakeholders should be categorized into three groups protective developing and intermediate organizations table 3 4 2 questions and survey after identifying thirteen key stakeholders a survey was done to collect the required data the survey consisted of three main parts providing data for sa sna and sl the close questions have been mainly used to study sna and sa and the open questions have been applied to study sl to study sa the interviewees have been asked to describe their organizations roles in the system determine the power and the interest of their organizations and the level of their organizations access to information also respondents were asked to evaluate all the other stakeholders powers and interests in the other part respondents were asked to characterize other stakeholders with whom they have an institutional relationship in the main five different management aspects i e surface water quantity management surface water quality management groundwater quantity management groundwater quality management and wastewater management then they were asked to determine the magnitude of those relationships and the nature of the relations detailed information about the close questions is presented in table a2 likert scale likert 1932 with five classes was used table a2 for quantifying the responses to evaluate the sl open questions have been considered the questionnaire has been prepared considering the following issues in the study area 1 problems related to water quantity a surface water unauthorized consumption the study area is important due to its large population and vast size diverse water uses agricultural lands and many industries in many cases the kan river has dried out because of excessive water withdrawal it should be noted that surface water consumption adversely impacts groundwater resources b groundwater unauthorized withdrawal groundwater resources have more problems because they are affected by direct water withdrawal and reduced recharge due to expanding the wastewater collection system also unauthorized groundwater withdrawal is much easier than surface water resources groundwater overexploitation has caused land subsidence in the southern part of tehran the latest data cleared that the rate of land subsidence in this region is about 25 cm per year much larger than the maximum acceptable level i e 4 mm year 2 problems related to water quality c surface water quality degradation the kan river as the most important river in tehran metropolitan area is under severe contamination pressures the pollutants entering the river are total suspended solids tss mainly due to sand harvesting from the river raw domestic wastewater industrial wastewater and agricultural return flow although the kan river quality degradation is so serious the main tragedy occurs when this water is used in the southern part of the study area for irrigating wheat barley alfalfa and vegetables d groundwater quality degradation tehran aquifer has an undesirable situation in terms of water quality due to the lack of a proper sewage collection system and disposal of domestic wastewater using adsorption wells in most regions of the city hence the nitrate concentration in groundwater usually violates the standards the main issue is that this polluted groundwater is one of the main sources for supplying the tehran metropolitan area s drinking water demand 3 problems related to wastewater management in some regions in the study area raw wastewater is directly discharged to surface or groundwater resources the questionnaire presented in table a3 has two main sections the stakeholders general opinions about water management in the study area have been examined in the first section in the second section the stakeholders feedbacks about the existing water and environmental problems in the study area are gathered the answers of the stakeholders are presented in annex iii table a4 it should be mentioned that several experts from each organization have been interviewed and the average of their answers to each question is considered for the sl evaluation 5 results in this section at first the results of sa sna and the sl evaluation are separately presented then the combination of these results is considered to identify the influencers for sl diffusion 5 1 sa to evaluate the level of stakeholders power and interest they were asked to assign a value to each characteristic for themselves and the others then as stated in section 4 2 1 the power and interest of each stakeholder are calculated to evaluate the level of stakeholders access to information they were asked to assign a value just for themselves the results are presented in table 4 as described in table a2 these results indicate the amount of power of influence on decisions the impact of decisions made on interests and the possibility of access to the stakeholders information 5 2 sna the respondents were asked to identify the stakeholders with whom their organizations hold the institutional relationship the conflictive and collaborative relations between different organizations were considered the data was transferred into matrices to be analyzed and the magnitudes of the relations were determined using the likert scale likert 1932 for conflictive and collaborative relations the values were considered to be negative and positive respectively hence the final entries of adjacency matrices which indicate ties strength and nature were between 5 as the strongest conflictive relation and 5 as the strongest collaborative relation in other words the negative and positive relationships indicate conflicting and collaborating relationships respectively ahmadi et al 2019 gephi as a visualization software is written in java environment bastian et al 2009 was applied to analyze the adjacency matrices based on the interviews and adjacency matrices betweenness centrality in degree and out degree indices that indicate the degree of effectiveness of stakeholders in different collaborative networks are presented in tables 5 7 the graphical presentations of the social networks which have been calculated and drawn using gephi are presented in figs 8 a3 a4 a5 and a6 better to understand the stakeholder s position in the social network 6 ranking the stakeholders through the lens of sl status and identifying the influencers for the sl diffusion if needed to accelerate the sl process in the system it may be essential to find the stakeholders who can be the sl process leader and facilitator in this section stakeholders are ranked based on learning development each answer to a question is scored considering the following steps 1 is the answer related to the question or not if it is not then no point is given to the answer 2 determine which responses are related to a topic i e surface water quality and quantity groundwater quality and quantity and wastewater it can be more than one 3 if the question is about a crisis the answer must be classified based on learning loops otherwise the answer is classified based on io and so table 8 presents the calculated lcs for all topics the following equation is used for ranking the stakeholders in terms of surface water quantity management from the sl point of view 5 l c s s w q u a n n a i o s w q u a n 1 n a s o s w q u a n 1 l c s w f q u a n 1 l c s w s q u a n 2 l c s w t q u a n 3 where sw g w q u a n q u a l w w stand for surface water groundwater quantity quality and wastewater respectively lc s sw quan denotes the learning condition score of a stakeholder in terms of surface water quantity management the first index refers to surface water and the second refers to quantity nai o sw quan is the number of appropriate answers of stakeholders that refer to surface water quantity management and io nas o sw quan is the number of appropriate answers of stakeholders which are referred to as surface water quantity management and so lcsw f quan is the number of the answers of stakeholders which are referred to as surface water quantity management in the first learning loop l c s w s quan is the number of the answers of stakeholders which are referred to as surface water quantity management in the second learning loop lcsw t quan is the number of the answers of stakeholders which are referred to as surface water quantity management in the third learning loop just like the above equation the following equations can be defined 6 l c s s w q u a l n a i o s w q u a l 1 n a s o s w q u a l 1 l c s w f q u a l 1 l c s w s q u a l 2 l c s w t q u a l 3 7 l c s g w q u a n n a i o g w q u a n 1 n a s o g w q u a n 1 l c g w f q u a n 1 l c g w s q u a n 2 l c g w t q u a n 3 8 l c s g w q u a l n a i o g w q u a l 1 n a s o g w q u a l 1 l c g w f q u a l 1 l c g w s q u a l 2 l c g w t q u a l 3 9 l c s w w n a i o w w 1 n a s o w w 1 l c w w f 1 l c w w s 2 l c w w t 3 where lcgwf is the number of answers related to learning condition for groundwater in the first loop lcgws is the number of answers related to learning condition for groundwater in the second loop lcgwt is the number of answers related to learning condition for groundwater in the third loop lcwwf is the number of answers related to learning condition for waste water in the first loop lcwws is the number of answers related to learning condition for waste water in the second loop l c w w t is the number of answers related to learning condition for waste water in the third loop according to eq 5 the calculated value for lcs of trw company corresponding to surface water management in the study area is presented in table 9 note that stakeholders responses focus on five water resources management groups surface water quantity and quality management groundwater quality and quantity management and wastewater if the answer is exactly related to any of these specific topics then the score for that answer provided by the stakeholder will be assigned to that particular topic if the answer given by a stakeholder is expressed in a way that addresses more than one topic then the estimated score for that answer should be divided among all related topics hence according to table 9 the lcs score related to surface water quantity is 3 9 suppose we want a stakeholder to affect the other stakeholders in that case he should have a proper in degree measure which expresses the others positive opinion about him besides a good centrality measure i e betweenness centrality which shows a suitable connection and relation with other stakeholders in graph theory which is the basis of sna betweenness centralityis an index ofcentrality in a graph in this paper in degree and betweenness centrality measures are used for rating the stakeholders besides identifying the leading stakeholders the power interest and access to information criteria which are outputs of sa should be considered a powerful and interested stakeholder can better expand sl in the social network access to information may help a stakeholder be aware of any future change in the system and cope with the uncertainties these criteria are used for rating the stakeholders 10 total score l c s i n degree b e t w e e n e s s c e n t r a l i t y p o w e r i n t e r e s t a c c e s s t o i n f o r m a t i o n for instance the rate of trw for surface water quality management is as follows the total score of trw for surface water quantity management 3 9 11 9 04 4 09 4 14 3 67 930 05 where lcs 3 9 i n degree 11 betweenness centrality 9 04 power 4 09 interest 4 14 and access to information 3 67 according to the method proposed in fig 6 the rating and ranking of stakeholders social learning evaluation in a collaborative network is presented in table 10 after evaluating sl the proposed approach that considers lcs sa and sna together for rating and ranking the stakeholders based on their ability to develop sl is applied and the results are presented in table 11 in other words table 10 is referred to the rating of the stakeholders regarding the learning loops io and so based evaluation of the stakeholders answers to the open questions furthermore table 11 is the stakeholder s total rating for being an influencer for the sl diffusion table 10 presents the stakeholders learning loops and their views based on so or io this table also shows the appropriateness of the answers to the questions according to the algorithm presented in fig 6 in table 10 the outputs of sna and sa have not been considered based on the results trw has a better learning condition also the stakeholders have a similar learning status in terms of water quality management like trw the municipality s learning condition in terms of municipal wastewater management is acceptable the mimt learning condition is suitable for surface water quality management it can help establish a partnership with this stakeholder to manage the wastewater of industrial areas table 11 can help find the main stakeholders for the sl diffusion in the system this table shows the stakeholders who have proper positions in table 10 and have power access to information and good connections with the other stakeholders to promote sl 7 discussion according to table 10 and fig 8 a3 a4 a5 and a6 trw has a proper connection level in the stakeholders social network moreover trw has an appropriate rank for the sl comparing to other stakeholders according to table 10 trw is more directly faced with water resources management problems these conditions for the trw follow the pattern presented in fig 5 hence we could interpret that for this organization social networking has been a catalyst for the sl some of the issues raised by this organization are specific to this institution and it seems that they are based on their experiences in dealing with problems to be more specific the appropriate position in a social network can improve that particular stakeholder s sl situation the appropriate position of a stakeholder in a network of stakeholders can be considered as a function of the number and level of communication links of that stakeholder with others some indices such as in degree out degree centrality and betweenness centrality show the stakeholders social networks situation since in this paper the social network of the stakeholders and the stakeholders sl has been evaluated and the results of both approaches have been quantified the accuracy of the statement that the position of a stakeholder in the social network can affect the sl condition of that stakeholder can be tested however an appropriate level of sl does not depend only on good communication in the social network fig 9 shows that a stakeholder s appropriate level of communication can improve that stakeholder s sl condition this is especially understandable for stakeholders located between two red lines in fig 9 in fig 9 the area between two red lines roughly indicates the range where the sl and betweenness centrality has a positive correlation in other words where the most important communication index in the network i e betweenness centrality is printed against the level of sl trw and some other stakeholders show a significant relationship between the level of sl and the position in the social network fig 9 meanwhile despite limited communication the bki has a good level of sl but its betweenness centrality is low which can be interpreted as the level of sl of this stakeholder has been improved mainly through the stakeholder s individual learning rather than the communications with other stakeholders ministry of health and medical education mhme and the department of environment doe are considered protective organizations these two institutions are ranked high in the social network related to surface water quality but they have less collaborative communications regarding the water quantity social network which corresponds to these organizations nature weak law enforcement and control of pollutants are the most important water quality issues in the study area this can be considered as the gap between understanding the problem and the ability to solve it department of environment doe has a moderate social network situation and a moderate learning condition due to the suitable interaction of this department with other stakeholders and its sl status doe can be considered the facilitator of sustainable development in the study area as the main agricultural stakeholder ministry of agriculture jahad maj has a weak position in the social networks regarding this stakeholder s answers to the open questions learning of maj is related to the first loop e g changing irrigation methods maj has a high out degree and a low in degree in positive connections and low out degree and in degree in negative interactions in most studied social networks according to the answers of maj to the open questions it seems that this stakeholder is unaware of the main issues of the system this can be the consequence of the mentioned in degree and out degree status in the sna mimt has a higher negative out degree in the social network than other stakeholders in response to open questions mimt has emphasized the industrial development rather than other types of development a high negative out degree may represent a conflict with other stakeholders over water allocation tpg considers the social parameters in the process of management this is mainly due to the scope of this institution s activities according to the sna results tpg has an even situation in both conflictive and collaborative networks tm almost has the worst position not only in the sna but also in the sl evaluation tm has the highest amount of negative in degree centrality and is located in the center of the conflict in response to the open questions centralized management has been pointed out as a solution to several problems in this region which is against good governance principles also none of the tm answers can be considered in the triple loop learning having high power and the worst learning condition and positions in the networks make tm an authoritarian according to the results on the macro scale trw can be considered the right stakeholder to raise awareness in the system and coach the other stakeholders towards so regarding water quality issues tpww can be nominated for the development of sl along with trw for dealing with the water quality issues the doe and mhme can also improve the sl among the stakeholders table 10 presents each stakeholder s rank for improving the sl in the system an interesting point is the change in the ranking of some stakeholders such as ngos in tables 10 and 11 this is due to ngo s good learning condition but lack of access to the information and lower authority to act in the system some stakeholders such as tm do not have a good position in both tables because of their very low social learning abilities 8 summary and conclusion in this paper we presented a new methodology which can be used for understanding the involved stakeholders characteristics quantifying sl and identifying the key stakeholders for the sl diffusion besides we described the process of sl diffusion and clarified its relation with sna sl can be considered a prerequisite for coordinating stakeholders and leading them towards so in a system in this paper the required data for sa sna sl evaluation has been obtained using a questionnaire and face to face interviews in our case study an attempt was made to identify the main environmental and water resource related issues in the study area using sa sna and sl approaches a comprehensive social based picture of the system was presented also a novel method for the sl quantification was proposed which helps find and identify the key stakeholders towards the sl diffusion based on the sna results the main conflicts in the studied urban area are between the stakeholders which are concerning about the physical development and environmental conservation of the system it was shown that a stakeholder with a proper position in the social network have a better sl condition in the study area trw has a very good condition for the sl diffusion regarding the water quality issues tpww along with trw are the key stakeholders for the development of sl for future works the presented social based approaches namely sl sna and sa can be integrated with simulation optimization models to form a comprehensive behavioral physical decision support system for water resource planning and management moreover uncertainties could be incorporated in quantifying the responses to the open questions also the levels of sl of stakeholders could be estimated in different time periods to estimate their long term variations to develop a dynamic picture of the system s social aspects credit authorship contribution statement mohammad javad emami skardi conceptualization methodology writing original draft software niknam momenzadeh conceptualization methodology writing original draft software reza kerachian supervision methodology writing review editing validation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper annex i pd game consider two prisoners who have been arrested for a crime and are interrogated in two separate rooms simultaneously each prisoner is offered a bargain each prisoner is given the opportunity to be disloyal to the other by testifying that the other committed the crime or cooperating with the other prisoner by being silent the bargain is if prisoner a and b betray confess each of them will be in jail for three years if prisoner a betrays confess b but b remains silent deny prisoner a will be in jail for a year and prisoner b will be in jail for five years and vice versa if a and b remain silent deny and cooperate they will be in jail for two years according to nash equilibrium both players would betray the players cooperation which provides a better outcome for the system the matrix form of the game is presented in fig a1 in which the first and second number refers to the payoffs of players a and b respectively the nash equilibrium of the game is confess confess fig a2 in the matrix form of the pd game the so is deny deny which leads to 2 2 outcomes for the system note the smaller the number in this game the better the outcome of the game is confess confess or 3 3 in this case the stakeholders decide to think in a strategic selfish manner annex ii annex iii analyzing the responses of agents using an sl based framework tehran province water and wastewater co tpww the answer to question 1 a q1 in establishing a factory or an industrial area we must consider the wastewater treatment plant before starting any project when the treatment plant is executed in the industrial sector then industrial infrastructure can be allowed to be built the treatment plant is the primary sector for any water related activity a q2 inappropriate or lack of purification processes many of the pollutants are discharged by government agencies failure to treat wastewater will cause many problems a q3 groundwater withdrawal in tehran is about 40 m3 s and the generated wastewater is 32 m3 s wastewater should be managed and used for preventing land subsidence a q4 the main problem is the pollution of groundwater resources due to the leakage of petrochemical pollutants a q5 entry of wastewater from villas into water resources a q6 no answer a q7 pathogens can create a serious problem for water resources in the region a q8 no answer tehran regional water co trw the answer to question 1 a q1 a summary of the responses are as follows 1 the familiarization of the river stakeholders with the current status quo and quality of the river 2 removing concrete obstacles along the river to create a suitable condition for the aquifer recharge 3 implementation of the required facilities for discharging treated wastewater to the kan river for recharging the aquifer a q2 1 lack of coordination among the organizations who are in charge of water withdrawal from the kan river or developing urban landscapes along the river 2 due to the lack of water related ngo for the rivers 3 existence of illegal use of the water especially farmers a q3 1 controlling withdrawalfrom groundwater resources in the subsidence areas and allocating wastewater to the river s upstream a q4 implementation of sewage network identification and monitoring of water resources pollutants and the environmental organization s effective operation to prevent pollutants spread a q5 imperative role of jahad e agriculture organization in preventing the entrance of drainage to the river creating a sewage network and preventing the entry of urban and rural wastewater into the river and the important role of the environmental organization to prevent the entry of industrial wastewater a q6 modify water consumption patterns supply management is not hard consumption management is hard a q7 implementing the sewage network and preventing wastewater flow into urban and rivers changing patterns in the agricultural sector is a tough job and may have many social consequences quantitative and qualitative management will not succeed unless people realize the risk they were creating people s participation in water resources projects a q8 no answer ministry of health and medical education mhme the ministry of health and medical education monitors the supply and distribution of urban drinking water and monitors water supply the answer to question 1 a q1 strike implementation of the criteria stricter and smarter monitoring of water resources by experts and inspectors a q2 conflicting interest is the main reason for many problems a q3 groundwater extracting should be banned and the wastewater must be recharged to the groundwater a q4 nitrate is the main problem of groundwater resources and is higher in the warm season as the main groundwater extracting for drinking water is for the warm days hence the concentration of nitrate in drinking water this season will be higher a q5 household agricultural and livestock wastewater a q6 talk about some water indexes such as 1 response 2 access 3 capacity 4 use and environment a q7 about 92 of the water is used for agricultural activity hence using wastewater must be prevented wastewater should be used to produce products like wood not the food industry a q8 no answer islamic city council of tehran icct the answer to question 1 a q1 prevent sewage from entering the watercourse the important role of the regional water company of tehran in the sustainable management of the watershed a q2 lack of coordination between decision makers a to q3 we need to know about water inflow in the river basin less water withdraws from groundwater using the wastewater to recharge groundwater resources a q4 establishment of a sewage network to prevent the entry of raw sewage into groundwater resources a q5 lack of sewage network in the study area the presence of industrial and even hospital wastewater causes high pollution in water resources a q6 implementation of the sewage network in all regions change in consumption patterns especially in urban green space prevent the evaporation of water in the city by preventing places like chitgar lake that will evaporate water a q7 due to the lack of water in tehran there is no alternative to using wastewater for irrigation vegetables are in bad condition and in some cases the nitrate in cucumber in south tehran is 35 times the standard limit and the lead of onions is 20 times the standard limit a q8 the treated wastewater can help to enhance agricultural conditions in southern tehran tehran water and wastewater company can provide the treated wastewater to farmers sewage network to run as soon as possible use of refined wastewater for green and agricultural use use water re rotation to reuse and optimize it cooperation between different organizations to improve water quality management in this area use of local refineries instead of central refineries in southern tehran urban development and the construction of new city areas should not be permitted without refinery construction department of natural resource and watershed dnrw the answer to question 1 a q1 integrated watershed management for improving the state of water resources management in the basin under the control of the provincial government preparation of catchment area documentation a q2 the most important obstacle is preferring the io to so besides lack of proper educational structure especially in tehran province s family and education department a q3 consumption control by installing alternating volumetric flow controllers recycling the wastewater and injecting it into the groundwater and controlling the flood water and importing it into the aquifer a q4 control of industrial and agricultural wastewater and try to reduce them installing sewage and water recycling systems in the industry and drinking water for urban green spaces and green space development for urban development a q5 surface water pollutions begins with polluted and acidified air in the tehran metropolitan area air pollution control urban development control and regulated agricultural development a q6 promote optimal per capita consumption planting drought resistant species promotion of urban and rural rainwater drainage levels a q7 due to the presence of heavy metals there is a lot of problems the standardization of industries especially cars and related industries is important a q8 comprehensive management of the watershed in the sustainable use of resources ministry of industry mine and trade mimt the answer to question 1 a q1 the river s structural and non structural parts should be dredged the importance of sustainable development and the allocation of water resources to sectors like the industry and not some parts such as chitgar lake a q2 the lack of proper governance and mismanagement in this region is the most critical region in the middle east a q3 closure of illegal wells of the farmers and recharging the aquifer using treated wastewater a q4 the upstream area of 22 or 21 is not connected to the wastewater treatment plant a q5 surface water like groundwater has problems such as the arrival of urban wastewater wastewater from the upstream restaurants and some industries a q6 the use of water for the more profitable activities such as industries instead of using in the agriculture sector a q7 in the watershed of tehran water use should be prohibited for farming one of the reasons for the disease in tehran is the use of heavy metal contaminated water for agriculture a q8 reaffirming the risk of contaminated water to heavy metals in the agriculture sector for humans tehran provincial government tpg the answer to question 1 a q1 the first sustainable management action is the river regime s central monitoring this track will include all incoming and outgoing data the allocation of water resources is based on technical issues and not on social approaches coordination between basin operators in maintaining water quality interacting in operation and maintaining the river s quantity can improve the situation a q2 the involvement of some influential beneficiaries in this river basin besides inconsistency between the river basin authorities the conflicts between the municipality authority and the other stakeholders and harvesting water regardless of the river s drainage regime a q3 no answer a q4 contamination from unauthorized constructions in this river basin a q5 the answer to q 4 a q6 only about 2 3 of water consumption is for drinking and sanitation the main user is the agricultural sector hence management should be focused on the agricultural sector especially with the emphasis on greenhouses and drip irrigation development in the agriculture sector water management social aspects must be considered a q7 emphasis on the local refineries separation of rainwater sewage and sewage a q8 no answer ministry of agriculture jahad maj the answer to question 1 a q1 the presence of this catchment area in tehran s urban area a q2 management and implementation of comprehensive studies by water organization of tehran a q3 the source of waste is specified and planned to improve its status a q4 proximity to the city of tehran the solution is the same as the answer to question 3 a q5 optimization and standardization of how to use for example the expansion of the use of drip irrigation in the agricultural sector a q6 inevitably untreated wastewater should not be used for agriculture if a report is submitted about the use of wastewater for agriculture it will be considered the need for education for this issue is felt among farmers a q7 the need for education is an essential approach in the management process a q8 no answer tehran municipality tm the answer to question 1 a q1 unit management is needed and tehran municipally can be the leader of many activities in the tehran metropolitan area such as water and wastewater management a q2 besides integrated water resource management we need unit water resource management in tehran and tehran municipally can be the main responsible a q3 the municipality has no role in this regard and has no idea for it a q4 there is not any pollution in the groundwater we have no problem with it a q5 waste and drainage water entrance to kan river a q6 production and consumption management a q7 we say to farmers that it is sewage water not water for agriculture farmers say we have been farming for twenty years here with this water which is not correct a q8 no answer department of environment doe the answer to question 1 a q1 preventing the entry of industrial and manufacturing pollutants into the river and treatment of rural wastewater along the river s margin and preventing the constructions and unauthorized use along the riverside a q2 monetary interest of some stakeholders and income generation look on these lands make kan river basin management much harder a q3 pollution source identification and control a q4 management and control the pollution from the source a q5 using recycling methods and identification of illegal activities and moving them outside the kan river basin a q6 wastewater treatment before entering the water resources a q7 no comment but just emphasized that it is illegal a q8 no answer non governmental organizations ngo the answer to question 1 a q1 the ministry of energy should play a more active role in managing the country s water resources a q2 unwillingness to properly manage water resources and the need to understand the water crisis in the country a q3 sand mining is one of the most imperative problems in the kan river basin sand mining can lead to land subsidence fatah bridge a bridge over kan river subsidence was due to sand mining a q4 constructing the sewage water system as soon as possible and explaining the water crisis to society and related problems using tv and other social media communicate effectively with members of the community to convince them not to pollute water resources a q5 controlling the river from being contaminated in its path and explaining that pollution entering the river may return to our life someday a q6 avoid polluting the rivers and implementing plans for collecting snow and rain preventing the use of salt and sand to defrost roads as they may enter water resources emphasis on the construction of urban sewage definition of social responsibility based units for schools and more effective voice and telecommunication and advertising agencies to improve social participation a q7 it generates a lot of additional costs for the community a q8 commitment and social responsibility become a belief in society ministry of roads and urban development mrud a q1 the need for a comprehensive plan and structure for all organizations and institutional creation to monitoring the implementation of laws a q2 eliminate profiteering a q3 no answer a q4 recognition of pollutant resources a q5 no answer a q6 establishing urban development criteria a q7 environmental impact assessment a q8 no answer bank keshavarzi iran bki a q1 watershed management development collect purify and reuse urban wastewater recycling and reuse of water resources using methods to reduce consumption in the agricultural sector collection of surface runoff in urban areas reducing urban consumption through public awareness and developing tools to reduce water consumption a q2 exhaustion of the pipeline system lack of adequate monitoring by organizations in legal control and utilization of water resources lack of public education on optimal water consumption and prevention of water pollution development and increase of tehran s population and lack of water capacity a q3 no answer a q4 control of urban pollutants such as waste and sanitary and industrial pollutants limit people s access to springs monitoring of river water conservation and water resources right of way limit the use of fertilizers and chemical pesticides a q5 decreasing air pollution collecting and disposing of sanitary waste population control in a region limit industrial development a q6 use of tools to reduce urban water consumption develop greenhouse cultivation plant drought resistant plants develop low water industries use methods to reduce evaporation a q7 cleaning and quality control of wastewater before use for agricultural purposes a q8 no answer annex iv sna parameters 
4459,in this paper six critical topics in social learning sl definition and applications are discussed 1 clarification of the sl definition 2 the role of sl in the management of shared water resources 3 the definition of learning in sl 4 the quantification of sl 5 the relation of sl with outputs of social networks analysis sna and stakeholder analysis sa 6 identifying and ranking of key stakeholders i e influencers for sl diffusion after defining sl we present sl s role using a well known game theory problem we have addressed the term learning in sl using an existing method namely reinforcement learning we present a new approach for quantifying sl within a hydrological environment and finding key stakeholders for the sl diffusion for the first time we consider a combination of sl sa and sna to propose a comprehensive social based approach to investigate sl diffusion the western part of tehran city which is suffering from some water and environmental issues such as overexploitation of groundwater and land subsidence is the case study of this paper the results show a significant relationship between sl and the outputs of sna the suggested method for identifying key stakeholders has been able to identify key stakeholders in terms of various water resources management issues in the study area the results can be used for developing effective policies towards sustainable management of water and environmental resources in the studied socio hydrological system keywords individual and social optimality kan river basin social learning sl social network analysis sna stakeholder analysis sa reinforcement learning 1 introduction the tragedy of commons is the consequence of the users selfish behaviors and their increasing demand for already scarce common pool resources hardin 2009 the limitation of available water resources and the presence of stakeholders with conflicting interests can exacerbate the selfishness self regard behavior leads to individual optimality io in which a stakeholder decides to take steps to maximize its profit regardless of the system welfare io may be different from social optimality so where the stakeholders choose actions to maximize the whole system s total profit and increase its level of performance hao and leung 2015 in most water resources systems several stakeholders can be identified it increases the importance of using socio hydrological approaches for modeling and management of water resources systems aghaie et al 2021 the management of water resources systems can be defined as a function of the stakeholders actions and the stakeholders behaviors may be affected by the community they belong to the coevolving interaction between hydrological and social systems may lead to unforeseen patterns that can induce critical environmental and social issues pouladi et al 2019 due to the failure of traditional approaches in solving current water resource management issues social based concepts such as social learning sl have been recently taken into account for developing management policies sl in shared resources management can be considered the changes and modifications in the norms beliefs and values towards sustainable use of shared resources the harmonising collaborative planning harmonicop project in europe is an appealing exemplary effort to consider and study social aspects in river basin management in harmonicop sl is viewed as the growing capacity of social entities to perform common river basin management tasks mostert 2003a 2003b in the harmonicop project sl has a central role in public participation and has been defined as learning to manage together cernesson et al 2005 in other words sl is a bridge between social and natural environments and is described as learning by groups authorities stakeholders and experts to handle issues in which all group members and stakeholders have a stake sl has been redefined since this term was used by bandura 1977 but its definition is still vague some papers such as reed et al 2010 were presented almost only for clarifying sl definition reed et al 2010 defined sl as a change in understanding beyond individuals through social interactions between actors in social networks they emphasized that in studying sl the following conditions and situations should be considered 1 the condition that is needed to facilitate sl such as stakeholders participation should not be confused with sl itself 2 the sl should not be confused with its outcomes 3 the distinction between sl and individual learning needed to be considered pahl wostl et al 2007 declared that sl takes place in social networks or communities and can be an outcome of the governance structure they showed that sl could occur on three time scales 1 short to medium time scale at the level of processes among collaborating stakeholders 2 medium to long time scales at the level of change in actor networks 3 long time scale at the level of change in the governance structure a review of sl s definitions and applications in the field of water resource management is presented in table a1 as the sl is a new concept it would be interesting to know its role in water resource management especially in a non cooperative environment therefore we consider a well known example in game theory literature as a benchmark for evaluating the sl s role also to define the meaning of learning in sl we compare sl with the reinforcement learning concepts we present a description of the study area and its water resource management problems based on the main identified challenges regarding the quantity and quality of water and treated wastewater resources we designed a questionnaire to identify the main stakeholders in the questionnaire two main types of questions i e open and closed questions have been considered we used the answers to the open questions for the sl evaluation we used the closed questions answers where the answers must be chosen from some fixed alternatives for the sa and sna we interpreted the stakeholders responses to identify the relations between the stakeholders social network and sl conditions in previous works it has been pointed out that there is a relationship between sl and social network characteristics reed et al 2010 but this relationship has not been quantified a closer look at the findings of sna can help promote sl using the responses provided by the main stakeholders the relationship between sl and sna has been evaluated in addition to the sl estimation we provided a new approach for promoting sl in the study area in this approach we considered a combination of the sl sna and sa to find the leading stakeholders for sl diffusion regarding various aspects of water resources in a hydrological environment the main questions which are answered in this paper are as follows 1 what is sl how can it be defined considering previous learning based methods a comprehensive review of the relevant works is presented to answer the above question also considering the reinforcement learning approach we attempt to provide a precise definition of learning in the concept of sl 2 which category of water resources engineering and management issues can be considered as a context for using the concept of sl in a problem where several stakeholders with strategic behaviors are involved the game theoretic approaches can be used to analyze the system barough et al 2012 emami skardi et al 2013 kerachian et al 2010 niksokhan et al 2009 sadegh et al 2010 because sl has mainly been considered in multi stakeholder systems a very well known example in game theory i e the prisoners dilemma pd is considered to define sl s role in shared water resource management 3 what is the relationship between sl and other social based methods used for water resource management in this paper some of the most important existing methods for studying social aspects of water resources engineering and management issues have been discussed and their relations with sl have been studied 4 what is the necessity importance and method of quantifying sl for water resource management sl has not been quantified in sl s previous applications in water resources engineering and management while for incorporating sl in simulation and optimization models and comparing stakeholders in terms of sl it is necessary to quantify sl therefore we attempt to provide a new approach for the evaluation and quantification of sl 5 how can key stakeholders or influencers for the sl diffusion be identified given the importance of influencing stakeholders for developing sl it is essential to identify the leading stakeholders in a system in this paper a combination of the sl sna and sa has been considered to find the sl diffusion s key stakeholders regarding various water resource issues this paper is organized as follows in section 3 the role of sl in water resources management is discussed in section 4 the sl definition is described using game theory and reinforcement learning approach a novel approach is presented in this section to quantify sl and its relation with sna and promote sl diffusion in section 5 the study area and its water and environmental issues are described after all the main finding and concluding remarks are presented 2 the role and definition of sl in a multi stakeholder environment sl is mainly developed to deal with multi stakeholder issues in a community of stakeholders using a well known example of shared resource management namely the pd in the game theory concept sl s role in water resources management is defined game theory is a powerful tool to study the strategic interactions among stakeholders in strategic water resource management issues the game theory has been successfully applied to water quality management e g emami skardi et al 2013 kerachian and karamouz 2007 niksokhan et al 2009 estalaki et al 2015 groundwater management e g bazargan lari and kerachian 2008 and pal et al 2020 transboundary water resources allocation e g yuan et al 2019 and urban runoff management e g ghodsi et al 2016a b various approaches have been presented to reach so in the game and one approach is to consider the penalty for the person who selects selfish actions madani 2010 hao and leung 2015 recently in dealing with io so problems eyni et al 2021 proposed a novel approach for the quantity and quality management of shared water resources using the correlated equilibrium concept from the game theory field in this paper according to the importance of the game theory concept in dealing with io so situation and using the pd game we explain the role of social attachment in natural resources management 2 1 the role of sl in changing pd game s answer from io to so pd is a well known standard example to study the stakeholders behavior in a multi stakeholder system this game has been used in many studies such as barrett 1994 becker and ester 1999 msangi 2005 madani and lund 2010 wu and zhou 2017 du et al 2019 the pd game can be used for studying stakeholders decision making in common resources management where two entirely rational players may not cooperate even with higher outcomes for the system further details of the pd game are given in annex i and figs a1 and a2 finding a way to achieve so is a challenging task in the past years various approaches have been presented to solve the pd games for example madani 2010 considered a penalty to reach so saak and peterson 2007 studied the behaviors of the stakeholders under incomplete information msangi 2005 evaluated the role of learning in stakeholders behaviors in shared groundwater management nakao et al 2002 tried to improve the non cooperative behaviors in a shared aquifer by proposing a framework for cooperation which increases the benefits of stakeholders based on most of the previous papers the existence of a powerful government can force players to cooperate and provide a socially optimal solution fig 1 the command and control approach has been mainly used to achieve so fig 1 however its efficiency may be questionable for the following reasons a in large scale problems like most of the hydrological issues monitoring of stakeholders behaviors even if be possible can be expensive complicated and troublous hao and leung 2015 b using punishment for enforcing players in a large society may lead to social resistance sl can be used instead of a penalty based method to direct the system s state from io to so the difference between using sl and penalty is that penalty changes in the value of rewards and forces the stakeholders to achieve so but sl makes a change in the way that stakeholders look at the issue and give them awareness about the consequences of their choices and they could achieve so without any pressure sl is not a magic approach for achieving so mostert et al 2008 but it can be considered along with other techniques for leading stakeholders to so 2 2 what kind of learning is sl sl is based on learning in a community of stakeholders although learning is a key element in human behaviors the definition of learning in sl should be clarified suppose we have a large scale environment like most of the water resources systems in that case an agent can decide and after receiving feedback from the environment the agent can assess his decision considering his values and norms the next step decision can be modified and updated based on the previous step s feedback this process in a large scale water resource system can be called learning fig 2 some studies have tried to formulate the learning process and make it algorithmic for example the reinforcement learning concept which simulates the learning process in human s has been applied to some water resources management problems such as reservoir operation castelletti et al 2002 mahootchi et al 2007 water allocation in the river basins abolpour et al 2007 urban water management and wastewater allocation emami skardi et al 2020 because of the algorithmic form of reinforcement learning it would be reasonable to use this concept to elaborate on the meaning of learning in sl reinforcement learning involves states actions estimated outcomes based on a reward function that is originated from the agent s norms and values and ultimately a decision that is made for the next step fig 2 each agent s reward function is defined according to the system s condition and the chosen actions finally the received payoff is evaluated based on the agents values and norms for example if a farmer intends to maximize his profit by selling agricultural products and his decisions actions are the amount of groundwater withdrawal harvesting and cultivar type his reward function can be defined based on these actions while the actions and environment are changing the norm which could be maximizing the total profit is usually considered constant the learning process used in reinforcement learning based algorithms can be considered a subset of sl the main difference between sl and reinforcement learning is the modification of norms and values in sl sl in water resources management can be defined as the changes in the norms beliefs and values towards sustainable use of water resources fig 3 3 methodology in this section we describe the main parts of the proposed methodology for the first time an attempt has been made to quantify sl study its relationship with sna and identify the sl diffusion s leading stakeholders a flowchart of the methodology is demonstrated in fig 4 3 1 system recognition system recognition has some basic parts delineation of the study area determination of environmental problems stakeholder identification and data collection the system s boundaries are usually defined as the river basin s boundaries after determining the physical boundaries the main challenges related to water and environmental systems are determined then the main stakeholders in the study area are identified to identify the key stakeholders a pre interview should be carried out and then using the snowball method goodman 1961 the list of main stakeholders is completed a questionnaire is designed to collect the required data for the sa sna and sl evaluation the gathered data should cover the physical features the main problems and stakeholders characteristics 3 2 stakholder analysis sa social network analysis sna and social learning sl evaluation to have a comprehensive evaluation of stakeholders in the study area these social based approaches are applied 3 2 1 stakeholder analysis sa defining the main stakeholders and their characteristics is always a challenging task stakeholders are individuals groups or organizations that can affect or be affected by the actions and decisions made to govern a system grimble and wellard 1997 reed 2008 grimble 1998 sa can have three main steps 1 identifying the stakeholders 2 categorizing the stakeholders and 3 investigating existing relationships between the stakeholders reed et al 2009 in the first step sa organizations groups and individuals who hold a stake regarding a specific issue are identified ahmadi et al 2019 then regarding their characteristics stakeholders are classified and their key differences are determined to determine whose interests are relevant in the process of implementing a given policy or program sa collects and analyzes qualitative information in a systematic way using semi structured interviews and interest influence matrices schmeer 1999 reed et al 2009 ahmadi et al 2019 quantified values of power interest and access to information can be the sa outputs we evaluate each stakeholder s power and interest using the following equations 1 p i j 1 n p ij n 2 i i j 1 n i ij n where p i and i i are the i th stakeholder s power and interest indices respectively p ij and i ij are power and interest values that j th stakeholder assigns to i th stakeholder respectively and n is the total number of stakeholders 3 2 2 social network analysis sna to form and analyze a social network the existing relationships among stakeholders should be identified then the characteristics of the relationships and the network should be determined this task i e calculating in degree and betweenness centrality indices can be done using some existing software such as ucinet and netdraw ahmadi et al 2019 or gephi bastian et al 2009 in some previous studies e g crona and parker 2012 cundill and rodela 2012 mills et al 2014 schwilch et al 2012 reed et al 2010 the relation between the sl and sna has been emphasized using sna methods the social network characteristics are calculated and a better understanding of the relationships the roles and responsibilities of the stakeholders is obtained since the sl occurs in a social network between the stakeholders due to the understanding obtained by sna it is possible to manage the sl diffusion better and identify key stakeholders for accelerating the sl process fig 5 the main sna indices considered in identifying the key stakeholders for sl diffusion are betweenness centrality and in degree the in degree is calculated as follows ahmadi et al 2019 3 ic j i 1 n r ij where ic j are the in degree centrality of the j th node n in the number of nodes i e stakeholders and r ij is element of i th row and j th column of the adjacency matrix which is an n n matrix r ij is equal to 1 if there is a link from i th node to j th node and is equal to 0 if there is no link from i th node to j th node the higher values of ic j mean that j th stakeholder has a more central position since more stakeholders have institutional relationships with this stakeholder ahmadi et al 2019 we applied the following equation to calculate the betweenness centrality freeman 1978 if σ jk equals to the total number of geodesic paths between nodes j and k and σ jk i equals to the number of these paths which pass through node i the betweenness centrality of node i i e b i when i j and k are distinct is calculated as follows ahmadi et al 2019 4 b i i j k σ jk i σ jk a stakeholder with high betweenness centrality value can act as an intermediary stakeholder since it lies on many different stakeholders network paths 3 2 3 social learning sl in the sl literature three learning levels have been defined single loop learning double loop learning and triple loop learning medema et al 2014 as shown in fig 3 a single loop which is the simplest type of learning happens when just the action is changed based on feedback one step ahead double loop learning occurs when the intention of doing an action changes the last and most comprehensive type of learning is triple loop learning in this type of learning changes in beliefs norms and governance are needed single loop learning is entirely consistent with reinforcement learning learning loops can help to classify and identify the sl occurring in a system therefore in this paper this approach has been used to evaluate and quantify the sl an open questionnaire considering the main issues related to surface water quantity and quality groundwater quantity and quality and wastewater reuse should be designed to estimate sl according to io and so s learning loops the stakeholders responses to the challenges that refer to the crisis should be classified if the answer is only related to the agent s concerns it is considered io on the other hand a so based response focuses on the system s interests answers can also be appropriate or inappropriate a stakeholder may understand an issue mentioned in the questionnaire and provide a solution this answer is called appropriate for example land subsidence may be a serious problem in an area and has been scientifically proved some stakeholders may understand this problem and have some proposals for tackling the issue following io or so interests a stakeholder may not be aware of the land subsidence and provide a wrong or inappropriate answer the answer of stakeholders to the questions can also be classified based on the learning loops according to the number of answers in each learning class the learning case score lcs is calculated a flowchart of the social learning evaluation is demonstrated in fig 6 3 3 identification of the influencers for the sl diffusion most of the literature regarding sl s applications in water resource management has focused on the sl estimation without suggesting sl s diffusion one of the most important ways of developing sl is the influence of stakeholders on one another therefore leading stakeholders should be identified for the sl diffusion a proper sa level can be appropriate for the sl development but it is not enough therefore the findings of sa sna and lcs are used to identify leading stakeholders for the sl development more details are presented using an example in the results section 4 case study the kan river basin is located in the tehran metropolitan city s western part fig 7 the main water resources of the study area are surface water reclaimed wastewater and groundwater a variety of land use can be identified in this study area such as agricultural residential industrial areas green spaces and a large recreational lake darbandsari et al 2017 the kan river basin starts from the northern part of tehran city and ends at tehran qom old road in the south the eastern and western boundaries of the area are defined perpendicular to equipotential lines of groundwater therefore the assumption of no inflow and outflow from the eastern and western borders is reasonably acceptable darbandsari et al 2020 fig 7 the kan river basin can represent a developing urban region with serious issues related to supplying drinking agricultural green space and industrial water demands besides several major environmental problems emami skardi et al 2020 khorasani et al 2020 ahmadi et al 2020 the kan river basin also suffers from policy related concerns such as conflicts among stakeholders about the allocation of treated wastewater ahmadi et al 2019 the average annual precipitation in the kan river basin is 230 mm the study area includes four water users the water demands and the amount of water withdrawal from ground and surface water resources are presented in table 1 the study area is challenging and interesting for investigating social learning based on the following reasons adapted from ahmadi et al 2019 covering some rapidly growing populated regions located near some large industries and agricultural regions covering some new human made recreational areas unlawful water withdrawals from the surface and groundwater existence of several stakeholders with different characteristics and conflicting utilities 4 1 stakeholders identification in this paper only the institutional stakeholders are considered hence stakeholders in the lowest level of decision making such as individual farmers are not considered the primary identification of key actors has been made using a pre interview with several key experts snowball sampling was applied in both the stakeholder s identification and data collection stages to find the main stakeholders moreover the physical characteristics i e land use main water bodies and related infrastructures political and hydrological boundaries and water demands of the kan river basin have been studied to identify the organizations that hold a prominent stake the main stakeholders are introduced in table 2 ahmadi et al 2019 suggested that the stakeholders should be categorized into three groups protective developing and intermediate organizations table 3 4 2 questions and survey after identifying thirteen key stakeholders a survey was done to collect the required data the survey consisted of three main parts providing data for sa sna and sl the close questions have been mainly used to study sna and sa and the open questions have been applied to study sl to study sa the interviewees have been asked to describe their organizations roles in the system determine the power and the interest of their organizations and the level of their organizations access to information also respondents were asked to evaluate all the other stakeholders powers and interests in the other part respondents were asked to characterize other stakeholders with whom they have an institutional relationship in the main five different management aspects i e surface water quantity management surface water quality management groundwater quantity management groundwater quality management and wastewater management then they were asked to determine the magnitude of those relationships and the nature of the relations detailed information about the close questions is presented in table a2 likert scale likert 1932 with five classes was used table a2 for quantifying the responses to evaluate the sl open questions have been considered the questionnaire has been prepared considering the following issues in the study area 1 problems related to water quantity a surface water unauthorized consumption the study area is important due to its large population and vast size diverse water uses agricultural lands and many industries in many cases the kan river has dried out because of excessive water withdrawal it should be noted that surface water consumption adversely impacts groundwater resources b groundwater unauthorized withdrawal groundwater resources have more problems because they are affected by direct water withdrawal and reduced recharge due to expanding the wastewater collection system also unauthorized groundwater withdrawal is much easier than surface water resources groundwater overexploitation has caused land subsidence in the southern part of tehran the latest data cleared that the rate of land subsidence in this region is about 25 cm per year much larger than the maximum acceptable level i e 4 mm year 2 problems related to water quality c surface water quality degradation the kan river as the most important river in tehran metropolitan area is under severe contamination pressures the pollutants entering the river are total suspended solids tss mainly due to sand harvesting from the river raw domestic wastewater industrial wastewater and agricultural return flow although the kan river quality degradation is so serious the main tragedy occurs when this water is used in the southern part of the study area for irrigating wheat barley alfalfa and vegetables d groundwater quality degradation tehran aquifer has an undesirable situation in terms of water quality due to the lack of a proper sewage collection system and disposal of domestic wastewater using adsorption wells in most regions of the city hence the nitrate concentration in groundwater usually violates the standards the main issue is that this polluted groundwater is one of the main sources for supplying the tehran metropolitan area s drinking water demand 3 problems related to wastewater management in some regions in the study area raw wastewater is directly discharged to surface or groundwater resources the questionnaire presented in table a3 has two main sections the stakeholders general opinions about water management in the study area have been examined in the first section in the second section the stakeholders feedbacks about the existing water and environmental problems in the study area are gathered the answers of the stakeholders are presented in annex iii table a4 it should be mentioned that several experts from each organization have been interviewed and the average of their answers to each question is considered for the sl evaluation 5 results in this section at first the results of sa sna and the sl evaluation are separately presented then the combination of these results is considered to identify the influencers for sl diffusion 5 1 sa to evaluate the level of stakeholders power and interest they were asked to assign a value to each characteristic for themselves and the others then as stated in section 4 2 1 the power and interest of each stakeholder are calculated to evaluate the level of stakeholders access to information they were asked to assign a value just for themselves the results are presented in table 4 as described in table a2 these results indicate the amount of power of influence on decisions the impact of decisions made on interests and the possibility of access to the stakeholders information 5 2 sna the respondents were asked to identify the stakeholders with whom their organizations hold the institutional relationship the conflictive and collaborative relations between different organizations were considered the data was transferred into matrices to be analyzed and the magnitudes of the relations were determined using the likert scale likert 1932 for conflictive and collaborative relations the values were considered to be negative and positive respectively hence the final entries of adjacency matrices which indicate ties strength and nature were between 5 as the strongest conflictive relation and 5 as the strongest collaborative relation in other words the negative and positive relationships indicate conflicting and collaborating relationships respectively ahmadi et al 2019 gephi as a visualization software is written in java environment bastian et al 2009 was applied to analyze the adjacency matrices based on the interviews and adjacency matrices betweenness centrality in degree and out degree indices that indicate the degree of effectiveness of stakeholders in different collaborative networks are presented in tables 5 7 the graphical presentations of the social networks which have been calculated and drawn using gephi are presented in figs 8 a3 a4 a5 and a6 better to understand the stakeholder s position in the social network 6 ranking the stakeholders through the lens of sl status and identifying the influencers for the sl diffusion if needed to accelerate the sl process in the system it may be essential to find the stakeholders who can be the sl process leader and facilitator in this section stakeholders are ranked based on learning development each answer to a question is scored considering the following steps 1 is the answer related to the question or not if it is not then no point is given to the answer 2 determine which responses are related to a topic i e surface water quality and quantity groundwater quality and quantity and wastewater it can be more than one 3 if the question is about a crisis the answer must be classified based on learning loops otherwise the answer is classified based on io and so table 8 presents the calculated lcs for all topics the following equation is used for ranking the stakeholders in terms of surface water quantity management from the sl point of view 5 l c s s w q u a n n a i o s w q u a n 1 n a s o s w q u a n 1 l c s w f q u a n 1 l c s w s q u a n 2 l c s w t q u a n 3 where sw g w q u a n q u a l w w stand for surface water groundwater quantity quality and wastewater respectively lc s sw quan denotes the learning condition score of a stakeholder in terms of surface water quantity management the first index refers to surface water and the second refers to quantity nai o sw quan is the number of appropriate answers of stakeholders that refer to surface water quantity management and io nas o sw quan is the number of appropriate answers of stakeholders which are referred to as surface water quantity management and so lcsw f quan is the number of the answers of stakeholders which are referred to as surface water quantity management in the first learning loop l c s w s quan is the number of the answers of stakeholders which are referred to as surface water quantity management in the second learning loop lcsw t quan is the number of the answers of stakeholders which are referred to as surface water quantity management in the third learning loop just like the above equation the following equations can be defined 6 l c s s w q u a l n a i o s w q u a l 1 n a s o s w q u a l 1 l c s w f q u a l 1 l c s w s q u a l 2 l c s w t q u a l 3 7 l c s g w q u a n n a i o g w q u a n 1 n a s o g w q u a n 1 l c g w f q u a n 1 l c g w s q u a n 2 l c g w t q u a n 3 8 l c s g w q u a l n a i o g w q u a l 1 n a s o g w q u a l 1 l c g w f q u a l 1 l c g w s q u a l 2 l c g w t q u a l 3 9 l c s w w n a i o w w 1 n a s o w w 1 l c w w f 1 l c w w s 2 l c w w t 3 where lcgwf is the number of answers related to learning condition for groundwater in the first loop lcgws is the number of answers related to learning condition for groundwater in the second loop lcgwt is the number of answers related to learning condition for groundwater in the third loop lcwwf is the number of answers related to learning condition for waste water in the first loop lcwws is the number of answers related to learning condition for waste water in the second loop l c w w t is the number of answers related to learning condition for waste water in the third loop according to eq 5 the calculated value for lcs of trw company corresponding to surface water management in the study area is presented in table 9 note that stakeholders responses focus on five water resources management groups surface water quantity and quality management groundwater quality and quantity management and wastewater if the answer is exactly related to any of these specific topics then the score for that answer provided by the stakeholder will be assigned to that particular topic if the answer given by a stakeholder is expressed in a way that addresses more than one topic then the estimated score for that answer should be divided among all related topics hence according to table 9 the lcs score related to surface water quantity is 3 9 suppose we want a stakeholder to affect the other stakeholders in that case he should have a proper in degree measure which expresses the others positive opinion about him besides a good centrality measure i e betweenness centrality which shows a suitable connection and relation with other stakeholders in graph theory which is the basis of sna betweenness centralityis an index ofcentrality in a graph in this paper in degree and betweenness centrality measures are used for rating the stakeholders besides identifying the leading stakeholders the power interest and access to information criteria which are outputs of sa should be considered a powerful and interested stakeholder can better expand sl in the social network access to information may help a stakeholder be aware of any future change in the system and cope with the uncertainties these criteria are used for rating the stakeholders 10 total score l c s i n degree b e t w e e n e s s c e n t r a l i t y p o w e r i n t e r e s t a c c e s s t o i n f o r m a t i o n for instance the rate of trw for surface water quality management is as follows the total score of trw for surface water quantity management 3 9 11 9 04 4 09 4 14 3 67 930 05 where lcs 3 9 i n degree 11 betweenness centrality 9 04 power 4 09 interest 4 14 and access to information 3 67 according to the method proposed in fig 6 the rating and ranking of stakeholders social learning evaluation in a collaborative network is presented in table 10 after evaluating sl the proposed approach that considers lcs sa and sna together for rating and ranking the stakeholders based on their ability to develop sl is applied and the results are presented in table 11 in other words table 10 is referred to the rating of the stakeholders regarding the learning loops io and so based evaluation of the stakeholders answers to the open questions furthermore table 11 is the stakeholder s total rating for being an influencer for the sl diffusion table 10 presents the stakeholders learning loops and their views based on so or io this table also shows the appropriateness of the answers to the questions according to the algorithm presented in fig 6 in table 10 the outputs of sna and sa have not been considered based on the results trw has a better learning condition also the stakeholders have a similar learning status in terms of water quality management like trw the municipality s learning condition in terms of municipal wastewater management is acceptable the mimt learning condition is suitable for surface water quality management it can help establish a partnership with this stakeholder to manage the wastewater of industrial areas table 11 can help find the main stakeholders for the sl diffusion in the system this table shows the stakeholders who have proper positions in table 10 and have power access to information and good connections with the other stakeholders to promote sl 7 discussion according to table 10 and fig 8 a3 a4 a5 and a6 trw has a proper connection level in the stakeholders social network moreover trw has an appropriate rank for the sl comparing to other stakeholders according to table 10 trw is more directly faced with water resources management problems these conditions for the trw follow the pattern presented in fig 5 hence we could interpret that for this organization social networking has been a catalyst for the sl some of the issues raised by this organization are specific to this institution and it seems that they are based on their experiences in dealing with problems to be more specific the appropriate position in a social network can improve that particular stakeholder s sl situation the appropriate position of a stakeholder in a network of stakeholders can be considered as a function of the number and level of communication links of that stakeholder with others some indices such as in degree out degree centrality and betweenness centrality show the stakeholders social networks situation since in this paper the social network of the stakeholders and the stakeholders sl has been evaluated and the results of both approaches have been quantified the accuracy of the statement that the position of a stakeholder in the social network can affect the sl condition of that stakeholder can be tested however an appropriate level of sl does not depend only on good communication in the social network fig 9 shows that a stakeholder s appropriate level of communication can improve that stakeholder s sl condition this is especially understandable for stakeholders located between two red lines in fig 9 in fig 9 the area between two red lines roughly indicates the range where the sl and betweenness centrality has a positive correlation in other words where the most important communication index in the network i e betweenness centrality is printed against the level of sl trw and some other stakeholders show a significant relationship between the level of sl and the position in the social network fig 9 meanwhile despite limited communication the bki has a good level of sl but its betweenness centrality is low which can be interpreted as the level of sl of this stakeholder has been improved mainly through the stakeholder s individual learning rather than the communications with other stakeholders ministry of health and medical education mhme and the department of environment doe are considered protective organizations these two institutions are ranked high in the social network related to surface water quality but they have less collaborative communications regarding the water quantity social network which corresponds to these organizations nature weak law enforcement and control of pollutants are the most important water quality issues in the study area this can be considered as the gap between understanding the problem and the ability to solve it department of environment doe has a moderate social network situation and a moderate learning condition due to the suitable interaction of this department with other stakeholders and its sl status doe can be considered the facilitator of sustainable development in the study area as the main agricultural stakeholder ministry of agriculture jahad maj has a weak position in the social networks regarding this stakeholder s answers to the open questions learning of maj is related to the first loop e g changing irrigation methods maj has a high out degree and a low in degree in positive connections and low out degree and in degree in negative interactions in most studied social networks according to the answers of maj to the open questions it seems that this stakeholder is unaware of the main issues of the system this can be the consequence of the mentioned in degree and out degree status in the sna mimt has a higher negative out degree in the social network than other stakeholders in response to open questions mimt has emphasized the industrial development rather than other types of development a high negative out degree may represent a conflict with other stakeholders over water allocation tpg considers the social parameters in the process of management this is mainly due to the scope of this institution s activities according to the sna results tpg has an even situation in both conflictive and collaborative networks tm almost has the worst position not only in the sna but also in the sl evaluation tm has the highest amount of negative in degree centrality and is located in the center of the conflict in response to the open questions centralized management has been pointed out as a solution to several problems in this region which is against good governance principles also none of the tm answers can be considered in the triple loop learning having high power and the worst learning condition and positions in the networks make tm an authoritarian according to the results on the macro scale trw can be considered the right stakeholder to raise awareness in the system and coach the other stakeholders towards so regarding water quality issues tpww can be nominated for the development of sl along with trw for dealing with the water quality issues the doe and mhme can also improve the sl among the stakeholders table 10 presents each stakeholder s rank for improving the sl in the system an interesting point is the change in the ranking of some stakeholders such as ngos in tables 10 and 11 this is due to ngo s good learning condition but lack of access to the information and lower authority to act in the system some stakeholders such as tm do not have a good position in both tables because of their very low social learning abilities 8 summary and conclusion in this paper we presented a new methodology which can be used for understanding the involved stakeholders characteristics quantifying sl and identifying the key stakeholders for the sl diffusion besides we described the process of sl diffusion and clarified its relation with sna sl can be considered a prerequisite for coordinating stakeholders and leading them towards so in a system in this paper the required data for sa sna sl evaluation has been obtained using a questionnaire and face to face interviews in our case study an attempt was made to identify the main environmental and water resource related issues in the study area using sa sna and sl approaches a comprehensive social based picture of the system was presented also a novel method for the sl quantification was proposed which helps find and identify the key stakeholders towards the sl diffusion based on the sna results the main conflicts in the studied urban area are between the stakeholders which are concerning about the physical development and environmental conservation of the system it was shown that a stakeholder with a proper position in the social network have a better sl condition in the study area trw has a very good condition for the sl diffusion regarding the water quality issues tpww along with trw are the key stakeholders for the development of sl for future works the presented social based approaches namely sl sna and sa can be integrated with simulation optimization models to form a comprehensive behavioral physical decision support system for water resource planning and management moreover uncertainties could be incorporated in quantifying the responses to the open questions also the levels of sl of stakeholders could be estimated in different time periods to estimate their long term variations to develop a dynamic picture of the system s social aspects credit authorship contribution statement mohammad javad emami skardi conceptualization methodology writing original draft software niknam momenzadeh conceptualization methodology writing original draft software reza kerachian supervision methodology writing review editing validation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper annex i pd game consider two prisoners who have been arrested for a crime and are interrogated in two separate rooms simultaneously each prisoner is offered a bargain each prisoner is given the opportunity to be disloyal to the other by testifying that the other committed the crime or cooperating with the other prisoner by being silent the bargain is if prisoner a and b betray confess each of them will be in jail for three years if prisoner a betrays confess b but b remains silent deny prisoner a will be in jail for a year and prisoner b will be in jail for five years and vice versa if a and b remain silent deny and cooperate they will be in jail for two years according to nash equilibrium both players would betray the players cooperation which provides a better outcome for the system the matrix form of the game is presented in fig a1 in which the first and second number refers to the payoffs of players a and b respectively the nash equilibrium of the game is confess confess fig a2 in the matrix form of the pd game the so is deny deny which leads to 2 2 outcomes for the system note the smaller the number in this game the better the outcome of the game is confess confess or 3 3 in this case the stakeholders decide to think in a strategic selfish manner annex ii annex iii analyzing the responses of agents using an sl based framework tehran province water and wastewater co tpww the answer to question 1 a q1 in establishing a factory or an industrial area we must consider the wastewater treatment plant before starting any project when the treatment plant is executed in the industrial sector then industrial infrastructure can be allowed to be built the treatment plant is the primary sector for any water related activity a q2 inappropriate or lack of purification processes many of the pollutants are discharged by government agencies failure to treat wastewater will cause many problems a q3 groundwater withdrawal in tehran is about 40 m3 s and the generated wastewater is 32 m3 s wastewater should be managed and used for preventing land subsidence a q4 the main problem is the pollution of groundwater resources due to the leakage of petrochemical pollutants a q5 entry of wastewater from villas into water resources a q6 no answer a q7 pathogens can create a serious problem for water resources in the region a q8 no answer tehran regional water co trw the answer to question 1 a q1 a summary of the responses are as follows 1 the familiarization of the river stakeholders with the current status quo and quality of the river 2 removing concrete obstacles along the river to create a suitable condition for the aquifer recharge 3 implementation of the required facilities for discharging treated wastewater to the kan river for recharging the aquifer a q2 1 lack of coordination among the organizations who are in charge of water withdrawal from the kan river or developing urban landscapes along the river 2 due to the lack of water related ngo for the rivers 3 existence of illegal use of the water especially farmers a q3 1 controlling withdrawalfrom groundwater resources in the subsidence areas and allocating wastewater to the river s upstream a q4 implementation of sewage network identification and monitoring of water resources pollutants and the environmental organization s effective operation to prevent pollutants spread a q5 imperative role of jahad e agriculture organization in preventing the entrance of drainage to the river creating a sewage network and preventing the entry of urban and rural wastewater into the river and the important role of the environmental organization to prevent the entry of industrial wastewater a q6 modify water consumption patterns supply management is not hard consumption management is hard a q7 implementing the sewage network and preventing wastewater flow into urban and rivers changing patterns in the agricultural sector is a tough job and may have many social consequences quantitative and qualitative management will not succeed unless people realize the risk they were creating people s participation in water resources projects a q8 no answer ministry of health and medical education mhme the ministry of health and medical education monitors the supply and distribution of urban drinking water and monitors water supply the answer to question 1 a q1 strike implementation of the criteria stricter and smarter monitoring of water resources by experts and inspectors a q2 conflicting interest is the main reason for many problems a q3 groundwater extracting should be banned and the wastewater must be recharged to the groundwater a q4 nitrate is the main problem of groundwater resources and is higher in the warm season as the main groundwater extracting for drinking water is for the warm days hence the concentration of nitrate in drinking water this season will be higher a q5 household agricultural and livestock wastewater a q6 talk about some water indexes such as 1 response 2 access 3 capacity 4 use and environment a q7 about 92 of the water is used for agricultural activity hence using wastewater must be prevented wastewater should be used to produce products like wood not the food industry a q8 no answer islamic city council of tehran icct the answer to question 1 a q1 prevent sewage from entering the watercourse the important role of the regional water company of tehran in the sustainable management of the watershed a q2 lack of coordination between decision makers a to q3 we need to know about water inflow in the river basin less water withdraws from groundwater using the wastewater to recharge groundwater resources a q4 establishment of a sewage network to prevent the entry of raw sewage into groundwater resources a q5 lack of sewage network in the study area the presence of industrial and even hospital wastewater causes high pollution in water resources a q6 implementation of the sewage network in all regions change in consumption patterns especially in urban green space prevent the evaporation of water in the city by preventing places like chitgar lake that will evaporate water a q7 due to the lack of water in tehran there is no alternative to using wastewater for irrigation vegetables are in bad condition and in some cases the nitrate in cucumber in south tehran is 35 times the standard limit and the lead of onions is 20 times the standard limit a q8 the treated wastewater can help to enhance agricultural conditions in southern tehran tehran water and wastewater company can provide the treated wastewater to farmers sewage network to run as soon as possible use of refined wastewater for green and agricultural use use water re rotation to reuse and optimize it cooperation between different organizations to improve water quality management in this area use of local refineries instead of central refineries in southern tehran urban development and the construction of new city areas should not be permitted without refinery construction department of natural resource and watershed dnrw the answer to question 1 a q1 integrated watershed management for improving the state of water resources management in the basin under the control of the provincial government preparation of catchment area documentation a q2 the most important obstacle is preferring the io to so besides lack of proper educational structure especially in tehran province s family and education department a q3 consumption control by installing alternating volumetric flow controllers recycling the wastewater and injecting it into the groundwater and controlling the flood water and importing it into the aquifer a q4 control of industrial and agricultural wastewater and try to reduce them installing sewage and water recycling systems in the industry and drinking water for urban green spaces and green space development for urban development a q5 surface water pollutions begins with polluted and acidified air in the tehran metropolitan area air pollution control urban development control and regulated agricultural development a q6 promote optimal per capita consumption planting drought resistant species promotion of urban and rural rainwater drainage levels a q7 due to the presence of heavy metals there is a lot of problems the standardization of industries especially cars and related industries is important a q8 comprehensive management of the watershed in the sustainable use of resources ministry of industry mine and trade mimt the answer to question 1 a q1 the river s structural and non structural parts should be dredged the importance of sustainable development and the allocation of water resources to sectors like the industry and not some parts such as chitgar lake a q2 the lack of proper governance and mismanagement in this region is the most critical region in the middle east a q3 closure of illegal wells of the farmers and recharging the aquifer using treated wastewater a q4 the upstream area of 22 or 21 is not connected to the wastewater treatment plant a q5 surface water like groundwater has problems such as the arrival of urban wastewater wastewater from the upstream restaurants and some industries a q6 the use of water for the more profitable activities such as industries instead of using in the agriculture sector a q7 in the watershed of tehran water use should be prohibited for farming one of the reasons for the disease in tehran is the use of heavy metal contaminated water for agriculture a q8 reaffirming the risk of contaminated water to heavy metals in the agriculture sector for humans tehran provincial government tpg the answer to question 1 a q1 the first sustainable management action is the river regime s central monitoring this track will include all incoming and outgoing data the allocation of water resources is based on technical issues and not on social approaches coordination between basin operators in maintaining water quality interacting in operation and maintaining the river s quantity can improve the situation a q2 the involvement of some influential beneficiaries in this river basin besides inconsistency between the river basin authorities the conflicts between the municipality authority and the other stakeholders and harvesting water regardless of the river s drainage regime a q3 no answer a q4 contamination from unauthorized constructions in this river basin a q5 the answer to q 4 a q6 only about 2 3 of water consumption is for drinking and sanitation the main user is the agricultural sector hence management should be focused on the agricultural sector especially with the emphasis on greenhouses and drip irrigation development in the agriculture sector water management social aspects must be considered a q7 emphasis on the local refineries separation of rainwater sewage and sewage a q8 no answer ministry of agriculture jahad maj the answer to question 1 a q1 the presence of this catchment area in tehran s urban area a q2 management and implementation of comprehensive studies by water organization of tehran a q3 the source of waste is specified and planned to improve its status a q4 proximity to the city of tehran the solution is the same as the answer to question 3 a q5 optimization and standardization of how to use for example the expansion of the use of drip irrigation in the agricultural sector a q6 inevitably untreated wastewater should not be used for agriculture if a report is submitted about the use of wastewater for agriculture it will be considered the need for education for this issue is felt among farmers a q7 the need for education is an essential approach in the management process a q8 no answer tehran municipality tm the answer to question 1 a q1 unit management is needed and tehran municipally can be the leader of many activities in the tehran metropolitan area such as water and wastewater management a q2 besides integrated water resource management we need unit water resource management in tehran and tehran municipally can be the main responsible a q3 the municipality has no role in this regard and has no idea for it a q4 there is not any pollution in the groundwater we have no problem with it a q5 waste and drainage water entrance to kan river a q6 production and consumption management a q7 we say to farmers that it is sewage water not water for agriculture farmers say we have been farming for twenty years here with this water which is not correct a q8 no answer department of environment doe the answer to question 1 a q1 preventing the entry of industrial and manufacturing pollutants into the river and treatment of rural wastewater along the river s margin and preventing the constructions and unauthorized use along the riverside a q2 monetary interest of some stakeholders and income generation look on these lands make kan river basin management much harder a q3 pollution source identification and control a q4 management and control the pollution from the source a q5 using recycling methods and identification of illegal activities and moving them outside the kan river basin a q6 wastewater treatment before entering the water resources a q7 no comment but just emphasized that it is illegal a q8 no answer non governmental organizations ngo the answer to question 1 a q1 the ministry of energy should play a more active role in managing the country s water resources a q2 unwillingness to properly manage water resources and the need to understand the water crisis in the country a q3 sand mining is one of the most imperative problems in the kan river basin sand mining can lead to land subsidence fatah bridge a bridge over kan river subsidence was due to sand mining a q4 constructing the sewage water system as soon as possible and explaining the water crisis to society and related problems using tv and other social media communicate effectively with members of the community to convince them not to pollute water resources a q5 controlling the river from being contaminated in its path and explaining that pollution entering the river may return to our life someday a q6 avoid polluting the rivers and implementing plans for collecting snow and rain preventing the use of salt and sand to defrost roads as they may enter water resources emphasis on the construction of urban sewage definition of social responsibility based units for schools and more effective voice and telecommunication and advertising agencies to improve social participation a q7 it generates a lot of additional costs for the community a q8 commitment and social responsibility become a belief in society ministry of roads and urban development mrud a q1 the need for a comprehensive plan and structure for all organizations and institutional creation to monitoring the implementation of laws a q2 eliminate profiteering a q3 no answer a q4 recognition of pollutant resources a q5 no answer a q6 establishing urban development criteria a q7 environmental impact assessment a q8 no answer bank keshavarzi iran bki a q1 watershed management development collect purify and reuse urban wastewater recycling and reuse of water resources using methods to reduce consumption in the agricultural sector collection of surface runoff in urban areas reducing urban consumption through public awareness and developing tools to reduce water consumption a q2 exhaustion of the pipeline system lack of adequate monitoring by organizations in legal control and utilization of water resources lack of public education on optimal water consumption and prevention of water pollution development and increase of tehran s population and lack of water capacity a q3 no answer a q4 control of urban pollutants such as waste and sanitary and industrial pollutants limit people s access to springs monitoring of river water conservation and water resources right of way limit the use of fertilizers and chemical pesticides a q5 decreasing air pollution collecting and disposing of sanitary waste population control in a region limit industrial development a q6 use of tools to reduce urban water consumption develop greenhouse cultivation plant drought resistant plants develop low water industries use methods to reduce evaporation a q7 cleaning and quality control of wastewater before use for agricultural purposes a q8 no answer annex iv sna parameters 
