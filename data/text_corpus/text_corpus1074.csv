index,text
5370,in 2010 flood hampered commercial and agricultural activities and destroyed infrastructure at large scale in pakistan accurate forecasting of the flood is necessary to implement right and timely strategies to mitigate its negative impacts therefore the current study emphasis on evaluation of the suitability of satellite reanalysis precipitation data products era interim mswep persiann cdr and trmm in comparison with observed rain gauge data for hydrological studies especially for flash floods analysis in the indus river basin pakistan the various statistical and categorical matrices bias nash sutcliff mae rmse r2 csi far pod percentage difference peak error percentage peak time error and graphical methods were used to report the divergences in the precipitation and flow results revealed that the mswep was outperformed on daily rainfall and hydrological suitability analysis based on various evaluations and all sources were captured accurate patterns the study results indicated a potential of satellite and reanalysis data in many applications especially flood forecasting and water management where rain gauge data are not available or limited keywords flood pakistan indus river basin satellite rainfall probability distribution model catchment hydrological modelling 1 introduction in resource poor countries the flood at large scale hampered commercial and agricultural activities and destroyed infrastructure brutally hong et al 2010 in the last two decades the frequency and magnitude of flood in pakistan have been increased significantly and quantified in many studies chohan et al 2015 therefore it is necessary to introduce a warning system to reduce flood induced losses wu et al 2012 hydrometeorological data and well calibrated hydrological models are the main parts of this system kim et al 2018 the acquisition of reliable and accurate precipitation measurement is main challenge to develop a flood forecasting system hou et al 2014 the emergence of satellite remote sensing provides valuable precipitation estimates in remote ungauged and trans boundary basins seyyedi et al 2015 wu et al 2014 pakistan has been suffered from many overwhelming floods from 1947 to 2013 which caused about us 38 billion financial losses ali 2013 but the 2010 flood was unprecedented in the history of river indus bhayo et al 2018 weather extremities particularly thrilling precipitation was main cause of flood and it caused uneven seasonal variation in the temperature it was the fifth largest flood in the history of pakistan which produced casualties around two thousand almost three thousand people were injured and affected more than 20 million people more than 10 of country population iqbal et al 2018 about 7 8 million people were suffered with the problem of food insecurity in addition more than us 16 billion economic losses were reported rehman et al 2015 to avoid negative impacts of natural disasters it is imperative to explore the accurate method of flood forecasting to develop a framework of flood mitigation strategies the efficient hydrological model for flood forecasting helps to avert damages through adoption of flood mitigation strategies after development of the model the next step is its calibration and validation keeping in view its importance the current study deals with two main objectives 1 to evaluate 2010 flood july september that caused significant damages at large scale of pakistan and 2 to analysis hydrological utility of the remotely sensed and reanalysis data through comparison with rain gauge observations and actual flow this study will improve understanding of the reliability of the remotely sensed and reanalysis data which will helpful for the management of water resources the article is organized into various sections section 1 deals with introduction section 2 explains the study area and data source section 3 presents the research methods used to determine study objections section 4 delineates results and discussion and sections 5 provides a summary of the study with policy implications 2 material and methods 2 1 selection of study area and its characteristics the indus river is 12th largest irrigation system in the world it is an important water system of asia however the incidence of extreme flood disasters is often due to mismanagement of water resources and destroyed infrastructure and standing crops of pakistan moreover extreme floods affected more than 260 million people in pakistan india china and afghanistan liu et al 2018 the indus river basin contains seven of the world s highest peaks after mount everest is transboundary system with total area of 1 12 million km2 which is shared by 47 39 8 and 6 with pakistan india china and afghanistan respectively karen frenken 2011 from the total area of 520 000 km2 about 65 14 11 and 1 areas shared by india afghanistan and china in terms of landmass respectively iqbal 2013 it originates from the lake manasarovar china at an elevation of 5500 m to the dry sandy plains of sindh southern province of pakistan and finally flows out into the arabian sea karen frenken 2011 the river is 3200 km long drainage area 960 000 km2 the average annual precipitation of indus region varies from 125 mm over the lower plains to about 500 mm in the upstream khan iqbal and yosufzai 2011 inam et al 2008 and average annual discharge is 7 610 m3 s out of the total drainage area about 506 753 km2 of area situated in the semiarid region of pakistan and the remaining area belongs to mountains and foothills khan et al 2011 the climate in the indus plains is arid to semi arid in the lower plain from december to february is the cold season and monthly mean temperature varies from 14 to 20 c from march to june it varies from 42 to 44 c karen frenken 2011 the upper indus basin northern part is a high mountain region with alpine and highland climates a major portion of the precipitation falls as snow during winter and spring indian winter monsoon and western disturbance in late winter and early spring are responsible for high precipitation qureshi 2011 on the other hand the lower basin southern part extends over plains exhibiting sub tropical arid and semi arid to temperate sub humid climates the monsoon from july to september is responsible for most of the precipitation falls and causes major flood incidences in pakistan ali and boer 2007 the flow significantly influences due to weather variation particularly it decreases during the winter and increases during the monsoons uneven weather systems fabricating the complex hydrological system which has an ultimate impression on the water availability and management in indus river basin the location of the study area is given in the fig 1 2 2 meteorological data in this study we have used 67 rain gauges and one flow station kotri the data of daily rainfall measurements and flow were collected from pakistan meteorological department water and power development authority wapda from 2007 to 2010 the data were about calibration and validation and big flash event in the history of pakistan flood there are three most common satellite and reanalysis data sets include the tropical rainfall measuring mission multi satellite precipitation analysis 3b42rt version 7 huffman et al 2007 precipitation estimation from remotely sensed information using artificial neural networks persiann ashouri et al 2015 multi source weighted ensemble precipitation mswep beck et al 2017 and european centre for medium range forecasts ecmwf era interim dee et al 2011 were downloaded from their respective sources and their characteristics are given in table 1 3 econometric analysis the arcgis was used to delineate watershed boundaries using the digital elevation model dem data of 90 m resolution data the average rainfall over the catchment was generated by thiessen polygons the evaluation has been done using daily rainfall data from 79 rain gauge stations 3b42rt v 7 persiann cdr mswep and era interim from 20 to 07 2010 to 20 09 2010 all respective rainfall and flood data were converted into daily temporal scale the satellite and reanalysis data were validated using the two common approaches which are scatter plots and cumulative catchment rainfall after the validation of the data different statistical methods of comparison were applied there are many statistical basis indices used to analysis the quantitative comparison between rain gauge and satellite data sources this study used a few of them including bias mean absolute error mae root mean square error rmse and coefficient of determination r2 nkunzimana et al 2019 elahi et al 2019 elahi et al 2018a however the r2 describes the agreement between satellite reanalysis and rain gauge observations the mae was used to scales out the general deviation the average magnitude of the error was found out by rmse and bias refers to the systematic bias between satellite reanalysis and rain gauge data elahi et al 2018b tang 2016 moreover the contingency of satellite precipitation was estimated by categorical statistical indicators such as probability of detection pod false alarm ratio far and critical success index csi correctly hit events among all real events found out by pod whereas far describes the unreal events detected by satellite and reanalysis data and csi embodies the correctly identified portion of rainfall by satellite and reanalysis data zhang et al 2019 su et al 2019 zhu et al 2020 moreover the graphical comparison was done on the basis of the taylor diagram taylor 2001 yang et al 2019 in addition r2 rmse and percentage difference peak error percentage pe and peak time error pte were used to evaluate the performance of simulated streamflow and hydrological model the mathematical formulas of statistical indicators are given in table 2 a semi distributed lumped hydrological model probability distribution model pdm was used to evaluate the hydrological utility of rainfall resources the hydrological analysis calibration validation and simulation has been done on the kotri barrage on indus river the probability distributed moisture stores and routing stores were used to runoff flow to the catchment outlet moore 1985 moore 1999 moore and bell 2002 abro et al 2019 following nelder and mead 1965 and phlip e gill et al 1981 the automatic optimization and informal visually interactive parameters were used 4 results and discussion 4 1 data validation rain gauge network was used to validate the satellite based rainfall retrievals satellite based rainfall validation against rain gauge provides an extensive view of performance and it is helpful to understand the data the comparison is given in fig 2 there are some common approaches to validate satellite based data sources in hydrological practices which are scattered plots and cumulative catchment rainfall bilal nichol and wang 2017 gao et al 2017 scatter plots were produced to understand the nature of relationships and the preliminary assessment of linear regression between reanalysis and satellite data against rain gauge scatterplots and cumulative catchment rainfall are shown in fig 2 it is found that all sources perform well and showed their ability to capture precipitation events quite well because r2 values are quite satisfactory they have good agreement with a rain gauge it can also be seen that all data sources were overestimated rain gauge when rainfall was higher and underestimate when rainfall was lower and moderate while era interim underestimate rain gauge rainfall which can be seen in cumulative catchment rainfall in general the performance of all data sources was quite well the rainfall and cumulative catchment rainfall are given in panel a and panel b of fig 2 4 2 rainfall analysis 4 2 1 quantitative and qualitative evaluation of extreme precipitation the fifth big flash flood in the history of pakistan was from 20 july 2010 to 20 september 2010 which haven t only damaged the infrastructure but also created food security problem for almost 80 of the population of country extreme daily precipitation derived from the era interim mswep persiann cdr and trmm products were plotted against rain gauge measurements for brief comparison fig 3 panel a the rainfall for this event was evaluated graphically and statistically for different rain estimators on the basis of graphical evaluation persiann cdr and mswep followed the same trend as rain gauge era interim and trmm slightly underestimated the rainfall of rain gauge at highest rainfall and overestimated at the end of this event meng et al 2014 studied the yellow river basin in china and found an underestimation of trmm on daily time scale however the performance of all data sources was satisfactory based on the statistics all satellite and reanalysis datasets synchronize well with rain gauge measurements with high correlation and nash values were more than 0 95 relatively era interim and trmm has lower correlation gao et al 2017 also reproted lower correlation for trmm over the tuojiang river catchment in china the persiann cdr and mswep have lower bias values i e 0 90 and 0 95 respectively the era interim and trmm data have the same bias value 1 01 furthermore mswep has lower values of 1 54 and 1 16 of rmse and mae respectively while era interim has higher values 3 58 and 2 68 of rmse and mae respectively sharifi et al 2016 have also determined the underestimation of rainfall by era and trmm in iran zhao et al 2019 studied the performance of trmm and gpm imerge for extreme precipitation over china and detected underestimation and lower correlation for trmm 0 72 taylor diagram illustrates the performance of rainfall estimators fig 3 panel b all rainfall estimators diagram plotted with rain gauge data it can be seen that persiann cdr and mswep followed the same trend while era interim and trmm underestimate rain gauge rainfall and it was also found that all rainfall estimators have a significantly high correlation xian et al 2019 have found high correlation and better performance for trmm over lower lancang mekong river basin located from lao pdr to the mekong delta furthermore the detection of the occurrence of extreme rainfall events there is rainfall or not was calculated by categorical skill metrics pod far and csi however all rainfall estimators performed better in capturing extreme rainfall events well with higher pod and csi values and lower far values table 3 fig 3 panel d the monthly sum of rainfall for sources was also evaluated it can be concluded that in the early phase of flash event the performance of all sources were quite satisfactory however in the peak of event the era interim persiann cdr and trmm showed slightly underestimation while at the recession the era interim and trmm showed significant overestimation fig 3 panel c 4 3 analysis of daily flow fig 4 illustrates the flow comparison of different rainfall estimators to actual flow for the unprecedented event 2010 flood in pakistan results revealed that era interim trmm and persiann cdr underestimated the actual flow furthermore era interim and trmm overestimated at recession limb while rain gauge and mswep produced promising in streamflow simulations yuan et al 2017 studied over chindwin river basin in myanmar and they found that trmm has significant underestimation of total runoff and high flows jiang et al 2012 studies over mishui basin xiangjing river china and found trmm underestimated actual flow we have found that the timing was not well for all rain estimators however all data sources showed lag behind for few days different statistical indicators were used to evaluate the hydrological utility of sources all data sources were highly correlated the correlation was more than 0 90 ba et al 2018 studied 21 years of hydrological evaluation of persiann cdr over upper senegal river and bani river basins shared by four african countries they have found that most of the years have correlation of more than 0 8 moreover all sources have little higher rmse the percentage difference and peak error percentage were also small furthermore all estimators have a few days delay the reason for delay might be complex topography of basin in general the rain gauge and mswep were outperformed the statistics of the flow are given in table 4 5 conclusion and policy implications the flood caused serious problems particularly damaged infrastructure and standing crops in pakistan flood forecasting system hydrological prediction is vital for water resource management regional and global satellite precipitation products offer new kinds of input data with high spatial and temporal resolution i e continuous remote mountainous and trans boundary basins this study was designed to evaluate the potential of satellite and reanalysis precipitation data sets to estimate flow during flash flood at the catchment level in response to flood forecasting systems satellite and reanalysis data were validated against rain gauge using scatter plots and cumulative catchment rainfall the quantitative and qualitative assessments of satellite and reanalysis data sets were done on graphical and statistical grounds the graphical evaluation has been done on time series graph and taylor diagram while for statistical evaluation few common statistical indicators and categorical statistical indicators bias r2 nash sutcliff rmse mae csi far and pod were used on the basis of both graphical and statistical analysis the performance of all data sources was found satisfactory to capture the pattern of rainfall while era interim and trmm were underestimated rain gauge rainfall and mswep was outperformed hydrological utility assessment and pdm hydrological model were used and their performance was evaluated based on statistical indicators r2 rmse percentage difference pep and pte and graphical basis however era interim persiann cdr and trmm underestimated the actual flow rain gauge and mswep following the same amplitude as actual flow furthermore all data sources were showed lagged behind for a few days the statistical indicators showed that mswep was outperformed results also evident that how pdm performs in a complex topographical basin the study results stress to conduct more studies to understand the utility of data sources the findings of the study will helpful for the flood forecasting systems accurately and timely to develop flood mitigation strategies 5 1 study limitations the availability of flood data and hydrological model lumped are the two main limitations of the study it might be better to analysis the spatial patterns and distributed hydrological models at different flow stations to elaborate on the utility of sources more effectively and efficiently credit author statement this study has evaluated the precipitation and flow using operational rain gauges satellite and reanalysis data era interim mswep persiann cdr and trmm over indus river basin pakistan in this study lumped conceptual model and probability distribution model pdm are employed to simulate the daily runoff at kotri barrage flow station pakistan using data of big flash event 2010 the main objective of this study is to assess the capability of different rain estimators and their hydrological applicability on the basis of different analysis techniques statistically and graphically declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments we are indebted to the national natural science foundation of china nsfc grant 71850410541 and startup foundation for introducing talent of nanjing university of information science and technology grant 2017r101 for the financial support we sincerely thank pakistan meteorological department pmd and water and power development authority wapda to provide data and we also owe our sincere thanks to the centre for ecology and hydrology wallingford uk for providing the pdm model last but not least we are thankful to the handling editor and anonymous reviewers to improve the quality of the article appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2020 125117 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
5370,in 2010 flood hampered commercial and agricultural activities and destroyed infrastructure at large scale in pakistan accurate forecasting of the flood is necessary to implement right and timely strategies to mitigate its negative impacts therefore the current study emphasis on evaluation of the suitability of satellite reanalysis precipitation data products era interim mswep persiann cdr and trmm in comparison with observed rain gauge data for hydrological studies especially for flash floods analysis in the indus river basin pakistan the various statistical and categorical matrices bias nash sutcliff mae rmse r2 csi far pod percentage difference peak error percentage peak time error and graphical methods were used to report the divergences in the precipitation and flow results revealed that the mswep was outperformed on daily rainfall and hydrological suitability analysis based on various evaluations and all sources were captured accurate patterns the study results indicated a potential of satellite and reanalysis data in many applications especially flood forecasting and water management where rain gauge data are not available or limited keywords flood pakistan indus river basin satellite rainfall probability distribution model catchment hydrological modelling 1 introduction in resource poor countries the flood at large scale hampered commercial and agricultural activities and destroyed infrastructure brutally hong et al 2010 in the last two decades the frequency and magnitude of flood in pakistan have been increased significantly and quantified in many studies chohan et al 2015 therefore it is necessary to introduce a warning system to reduce flood induced losses wu et al 2012 hydrometeorological data and well calibrated hydrological models are the main parts of this system kim et al 2018 the acquisition of reliable and accurate precipitation measurement is main challenge to develop a flood forecasting system hou et al 2014 the emergence of satellite remote sensing provides valuable precipitation estimates in remote ungauged and trans boundary basins seyyedi et al 2015 wu et al 2014 pakistan has been suffered from many overwhelming floods from 1947 to 2013 which caused about us 38 billion financial losses ali 2013 but the 2010 flood was unprecedented in the history of river indus bhayo et al 2018 weather extremities particularly thrilling precipitation was main cause of flood and it caused uneven seasonal variation in the temperature it was the fifth largest flood in the history of pakistan which produced casualties around two thousand almost three thousand people were injured and affected more than 20 million people more than 10 of country population iqbal et al 2018 about 7 8 million people were suffered with the problem of food insecurity in addition more than us 16 billion economic losses were reported rehman et al 2015 to avoid negative impacts of natural disasters it is imperative to explore the accurate method of flood forecasting to develop a framework of flood mitigation strategies the efficient hydrological model for flood forecasting helps to avert damages through adoption of flood mitigation strategies after development of the model the next step is its calibration and validation keeping in view its importance the current study deals with two main objectives 1 to evaluate 2010 flood july september that caused significant damages at large scale of pakistan and 2 to analysis hydrological utility of the remotely sensed and reanalysis data through comparison with rain gauge observations and actual flow this study will improve understanding of the reliability of the remotely sensed and reanalysis data which will helpful for the management of water resources the article is organized into various sections section 1 deals with introduction section 2 explains the study area and data source section 3 presents the research methods used to determine study objections section 4 delineates results and discussion and sections 5 provides a summary of the study with policy implications 2 material and methods 2 1 selection of study area and its characteristics the indus river is 12th largest irrigation system in the world it is an important water system of asia however the incidence of extreme flood disasters is often due to mismanagement of water resources and destroyed infrastructure and standing crops of pakistan moreover extreme floods affected more than 260 million people in pakistan india china and afghanistan liu et al 2018 the indus river basin contains seven of the world s highest peaks after mount everest is transboundary system with total area of 1 12 million km2 which is shared by 47 39 8 and 6 with pakistan india china and afghanistan respectively karen frenken 2011 from the total area of 520 000 km2 about 65 14 11 and 1 areas shared by india afghanistan and china in terms of landmass respectively iqbal 2013 it originates from the lake manasarovar china at an elevation of 5500 m to the dry sandy plains of sindh southern province of pakistan and finally flows out into the arabian sea karen frenken 2011 the river is 3200 km long drainage area 960 000 km2 the average annual precipitation of indus region varies from 125 mm over the lower plains to about 500 mm in the upstream khan iqbal and yosufzai 2011 inam et al 2008 and average annual discharge is 7 610 m3 s out of the total drainage area about 506 753 km2 of area situated in the semiarid region of pakistan and the remaining area belongs to mountains and foothills khan et al 2011 the climate in the indus plains is arid to semi arid in the lower plain from december to february is the cold season and monthly mean temperature varies from 14 to 20 c from march to june it varies from 42 to 44 c karen frenken 2011 the upper indus basin northern part is a high mountain region with alpine and highland climates a major portion of the precipitation falls as snow during winter and spring indian winter monsoon and western disturbance in late winter and early spring are responsible for high precipitation qureshi 2011 on the other hand the lower basin southern part extends over plains exhibiting sub tropical arid and semi arid to temperate sub humid climates the monsoon from july to september is responsible for most of the precipitation falls and causes major flood incidences in pakistan ali and boer 2007 the flow significantly influences due to weather variation particularly it decreases during the winter and increases during the monsoons uneven weather systems fabricating the complex hydrological system which has an ultimate impression on the water availability and management in indus river basin the location of the study area is given in the fig 1 2 2 meteorological data in this study we have used 67 rain gauges and one flow station kotri the data of daily rainfall measurements and flow were collected from pakistan meteorological department water and power development authority wapda from 2007 to 2010 the data were about calibration and validation and big flash event in the history of pakistan flood there are three most common satellite and reanalysis data sets include the tropical rainfall measuring mission multi satellite precipitation analysis 3b42rt version 7 huffman et al 2007 precipitation estimation from remotely sensed information using artificial neural networks persiann ashouri et al 2015 multi source weighted ensemble precipitation mswep beck et al 2017 and european centre for medium range forecasts ecmwf era interim dee et al 2011 were downloaded from their respective sources and their characteristics are given in table 1 3 econometric analysis the arcgis was used to delineate watershed boundaries using the digital elevation model dem data of 90 m resolution data the average rainfall over the catchment was generated by thiessen polygons the evaluation has been done using daily rainfall data from 79 rain gauge stations 3b42rt v 7 persiann cdr mswep and era interim from 20 to 07 2010 to 20 09 2010 all respective rainfall and flood data were converted into daily temporal scale the satellite and reanalysis data were validated using the two common approaches which are scatter plots and cumulative catchment rainfall after the validation of the data different statistical methods of comparison were applied there are many statistical basis indices used to analysis the quantitative comparison between rain gauge and satellite data sources this study used a few of them including bias mean absolute error mae root mean square error rmse and coefficient of determination r2 nkunzimana et al 2019 elahi et al 2019 elahi et al 2018a however the r2 describes the agreement between satellite reanalysis and rain gauge observations the mae was used to scales out the general deviation the average magnitude of the error was found out by rmse and bias refers to the systematic bias between satellite reanalysis and rain gauge data elahi et al 2018b tang 2016 moreover the contingency of satellite precipitation was estimated by categorical statistical indicators such as probability of detection pod false alarm ratio far and critical success index csi correctly hit events among all real events found out by pod whereas far describes the unreal events detected by satellite and reanalysis data and csi embodies the correctly identified portion of rainfall by satellite and reanalysis data zhang et al 2019 su et al 2019 zhu et al 2020 moreover the graphical comparison was done on the basis of the taylor diagram taylor 2001 yang et al 2019 in addition r2 rmse and percentage difference peak error percentage pe and peak time error pte were used to evaluate the performance of simulated streamflow and hydrological model the mathematical formulas of statistical indicators are given in table 2 a semi distributed lumped hydrological model probability distribution model pdm was used to evaluate the hydrological utility of rainfall resources the hydrological analysis calibration validation and simulation has been done on the kotri barrage on indus river the probability distributed moisture stores and routing stores were used to runoff flow to the catchment outlet moore 1985 moore 1999 moore and bell 2002 abro et al 2019 following nelder and mead 1965 and phlip e gill et al 1981 the automatic optimization and informal visually interactive parameters were used 4 results and discussion 4 1 data validation rain gauge network was used to validate the satellite based rainfall retrievals satellite based rainfall validation against rain gauge provides an extensive view of performance and it is helpful to understand the data the comparison is given in fig 2 there are some common approaches to validate satellite based data sources in hydrological practices which are scattered plots and cumulative catchment rainfall bilal nichol and wang 2017 gao et al 2017 scatter plots were produced to understand the nature of relationships and the preliminary assessment of linear regression between reanalysis and satellite data against rain gauge scatterplots and cumulative catchment rainfall are shown in fig 2 it is found that all sources perform well and showed their ability to capture precipitation events quite well because r2 values are quite satisfactory they have good agreement with a rain gauge it can also be seen that all data sources were overestimated rain gauge when rainfall was higher and underestimate when rainfall was lower and moderate while era interim underestimate rain gauge rainfall which can be seen in cumulative catchment rainfall in general the performance of all data sources was quite well the rainfall and cumulative catchment rainfall are given in panel a and panel b of fig 2 4 2 rainfall analysis 4 2 1 quantitative and qualitative evaluation of extreme precipitation the fifth big flash flood in the history of pakistan was from 20 july 2010 to 20 september 2010 which haven t only damaged the infrastructure but also created food security problem for almost 80 of the population of country extreme daily precipitation derived from the era interim mswep persiann cdr and trmm products were plotted against rain gauge measurements for brief comparison fig 3 panel a the rainfall for this event was evaluated graphically and statistically for different rain estimators on the basis of graphical evaluation persiann cdr and mswep followed the same trend as rain gauge era interim and trmm slightly underestimated the rainfall of rain gauge at highest rainfall and overestimated at the end of this event meng et al 2014 studied the yellow river basin in china and found an underestimation of trmm on daily time scale however the performance of all data sources was satisfactory based on the statistics all satellite and reanalysis datasets synchronize well with rain gauge measurements with high correlation and nash values were more than 0 95 relatively era interim and trmm has lower correlation gao et al 2017 also reproted lower correlation for trmm over the tuojiang river catchment in china the persiann cdr and mswep have lower bias values i e 0 90 and 0 95 respectively the era interim and trmm data have the same bias value 1 01 furthermore mswep has lower values of 1 54 and 1 16 of rmse and mae respectively while era interim has higher values 3 58 and 2 68 of rmse and mae respectively sharifi et al 2016 have also determined the underestimation of rainfall by era and trmm in iran zhao et al 2019 studied the performance of trmm and gpm imerge for extreme precipitation over china and detected underestimation and lower correlation for trmm 0 72 taylor diagram illustrates the performance of rainfall estimators fig 3 panel b all rainfall estimators diagram plotted with rain gauge data it can be seen that persiann cdr and mswep followed the same trend while era interim and trmm underestimate rain gauge rainfall and it was also found that all rainfall estimators have a significantly high correlation xian et al 2019 have found high correlation and better performance for trmm over lower lancang mekong river basin located from lao pdr to the mekong delta furthermore the detection of the occurrence of extreme rainfall events there is rainfall or not was calculated by categorical skill metrics pod far and csi however all rainfall estimators performed better in capturing extreme rainfall events well with higher pod and csi values and lower far values table 3 fig 3 panel d the monthly sum of rainfall for sources was also evaluated it can be concluded that in the early phase of flash event the performance of all sources were quite satisfactory however in the peak of event the era interim persiann cdr and trmm showed slightly underestimation while at the recession the era interim and trmm showed significant overestimation fig 3 panel c 4 3 analysis of daily flow fig 4 illustrates the flow comparison of different rainfall estimators to actual flow for the unprecedented event 2010 flood in pakistan results revealed that era interim trmm and persiann cdr underestimated the actual flow furthermore era interim and trmm overestimated at recession limb while rain gauge and mswep produced promising in streamflow simulations yuan et al 2017 studied over chindwin river basin in myanmar and they found that trmm has significant underestimation of total runoff and high flows jiang et al 2012 studies over mishui basin xiangjing river china and found trmm underestimated actual flow we have found that the timing was not well for all rain estimators however all data sources showed lag behind for few days different statistical indicators were used to evaluate the hydrological utility of sources all data sources were highly correlated the correlation was more than 0 90 ba et al 2018 studied 21 years of hydrological evaluation of persiann cdr over upper senegal river and bani river basins shared by four african countries they have found that most of the years have correlation of more than 0 8 moreover all sources have little higher rmse the percentage difference and peak error percentage were also small furthermore all estimators have a few days delay the reason for delay might be complex topography of basin in general the rain gauge and mswep were outperformed the statistics of the flow are given in table 4 5 conclusion and policy implications the flood caused serious problems particularly damaged infrastructure and standing crops in pakistan flood forecasting system hydrological prediction is vital for water resource management regional and global satellite precipitation products offer new kinds of input data with high spatial and temporal resolution i e continuous remote mountainous and trans boundary basins this study was designed to evaluate the potential of satellite and reanalysis precipitation data sets to estimate flow during flash flood at the catchment level in response to flood forecasting systems satellite and reanalysis data were validated against rain gauge using scatter plots and cumulative catchment rainfall the quantitative and qualitative assessments of satellite and reanalysis data sets were done on graphical and statistical grounds the graphical evaluation has been done on time series graph and taylor diagram while for statistical evaluation few common statistical indicators and categorical statistical indicators bias r2 nash sutcliff rmse mae csi far and pod were used on the basis of both graphical and statistical analysis the performance of all data sources was found satisfactory to capture the pattern of rainfall while era interim and trmm were underestimated rain gauge rainfall and mswep was outperformed hydrological utility assessment and pdm hydrological model were used and their performance was evaluated based on statistical indicators r2 rmse percentage difference pep and pte and graphical basis however era interim persiann cdr and trmm underestimated the actual flow rain gauge and mswep following the same amplitude as actual flow furthermore all data sources were showed lagged behind for a few days the statistical indicators showed that mswep was outperformed results also evident that how pdm performs in a complex topographical basin the study results stress to conduct more studies to understand the utility of data sources the findings of the study will helpful for the flood forecasting systems accurately and timely to develop flood mitigation strategies 5 1 study limitations the availability of flood data and hydrological model lumped are the two main limitations of the study it might be better to analysis the spatial patterns and distributed hydrological models at different flow stations to elaborate on the utility of sources more effectively and efficiently credit author statement this study has evaluated the precipitation and flow using operational rain gauges satellite and reanalysis data era interim mswep persiann cdr and trmm over indus river basin pakistan in this study lumped conceptual model and probability distribution model pdm are employed to simulate the daily runoff at kotri barrage flow station pakistan using data of big flash event 2010 the main objective of this study is to assess the capability of different rain estimators and their hydrological applicability on the basis of different analysis techniques statistically and graphically declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments we are indebted to the national natural science foundation of china nsfc grant 71850410541 and startup foundation for introducing talent of nanjing university of information science and technology grant 2017r101 for the financial support we sincerely thank pakistan meteorological department pmd and water and power development authority wapda to provide data and we also owe our sincere thanks to the centre for ecology and hydrology wallingford uk for providing the pdm model last but not least we are thankful to the handling editor and anonymous reviewers to improve the quality of the article appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2020 125117 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
5371,accurate and reliable predictions of estuarine salinity can lead to more effective water resource management and can alleviate the adverse impacts of saltwater intrusion due to the nonlinear and nonstationary features in time series of estuarine salinity this study is conducted to develop a hybrid model coupling the techniques of wavelet transform wt and artificial neural network ann for forecasting estuarine salinity in the pearl river estuary china two wavelet based forecasting frameworks the direct forecast df framework i e only explanatory variables are decomposed leading to direct forecasting of the target variables and multicomponent forecast mf framework i e both explanatory and target variables are decomposed and each target component is forecasted separately were used to construct the wt ann models the results reveal the superiority of hybrid wt ann models in estuarine salinity forecasting over traditional multiple linear regression mlr models and single ann models indicated by the nash sutcliffe efficiency nse correlation coefficient r root mean square error rmse mean absolute error mae and kling gupta efficiency kge between the two wavelet based forecasting paradigms the mf framework outperformed the df framework for better capturing the mutual dependence i e mutual information mi between input and output variables additionally the superiority of wt ann models in comparison with mlr and ann models is increasingly prominent when the forecast lead time is extended from 1 to 3 days keywords salinity forecasting wavelet transform artificial neural network hybrid model pearl river estuary 1 introduction estuaries the junction between coastal and terrestrial waters are particularly vulnerable to saltwater intrusions that could exert an adverse impact on the ecological environment liu et al 2019 and diminish freshwater available for humans rengasamy 2006 anthropogenic activities such as damming sand excavation and dredging have greatly altered the natural pattern of channel characteristics and intensified saltwater intrusions leading to the deterioration of water quality in coastal cities hu et al 2019 consequently accurate forecasts of salinity variation in estuaries are essential for water security in coastal regions rohmer and brisset 2017 according to previous studies salinity forecasts can be undertaken using either numerical hydrodynamic or data driven models since numerical models are effective in reproducing the physical processes of salinity transport they have been used widely for exploring hydrodynamic mechanisms of saltwater intrusion sun et al 2016 wang et al 2012 yuan et al 2015 however the applications of numerical models in salinity forecasting are still limited because these models require many different types of field data and a large effort to calibrate the model parameters by contrast data driven models can achieve satisfactory performance in various hydrological forecasting applications with much less field information and smaller costs londhe and charhate 2010 in general data driven models can be classified into traditional statistical models and more recent machine learning models solomatine and ostfeld 2008 traditional statistical models employed in salinity forecasts rely on the statistical correlation between the historical time series of salinity and relevant predictors e g previous salinity upstream inflow wind speed tide level and precipitation studies performed by sun and koch 2001 parsa and etemad shahidi 2011 qiu and wan 2013 are some previous examples where statistical models have been successfully used in forecasting estuarine salinity nevertheless the capability of traditional statistical models in capturing nonlinear features in hydrological processes is usually limited belayneh et al 2014 yaseen et al 2015 numerous studies have revealed that the process of saltwater intrusion is affected by diverse factors e g river discharge tidal current wind precipitation topography and human activities and the correlations among different variables are highly complex and nonlinear hu et al 2019 liu et al 2014 tian 2019 zhang and deng 2010 machine learning techniques have thus been successfully used for modeling the nonlinear hydrological processes over recent years these machine learning models have the inherent property of dealing with nonlinear data without prior knowledge of the whole physical process and they can therefore have multiple inputs with different characteristics to represent the spatiotemporal variability nourani et al 2009b machine learning models such as artificial neural network ann bowden et al 2005b he et al 2011 huang and foo 2002 kingston et al 2005 maier and dandy 1996 maier et al 2010 support vector machine svm fang et al 2016 rohmer and brisset 2017 adaptive neuro fuzzy inference systems anfis barzegar et al 2016 soltani et al 2010 and random forest rf liu et al 2015 vermeulen and van niekerk 2017 have been broadly used and accepted as effective tools for modeling and forecasting variations in water quality or salinity despite the merits and usefulness of these machine learning models the presence of different frequency components e g periodicity and noise embedded in time series of estuarine salinity are challenging the capacity of machine learning models in terms of dealing with nonstationary data at various scales from hourly to multidecadal dixit et al 2016 with regard to saltwater intrusion salinity time series generally have nonstationary characteristics on account of the interaction of marine terrestrial and meteorological factors hu et al 2019 for instance abrupt shift of estuarine salinity may occur due to some short term factors such as wind and rainstorm zheng et al 2014 while secular variations of saltwater intrusion are affected by some long term factors such as human activities and climate changes liu et al 2018 therefore hybrid models combining data preprocessing schemes with machine learning techniques can potentially have better performance in forecasting estuarine salinity than single machine learning models wavelet transform wt is a data preprocessing technique that provides a time frequency representation of a signal at different periods in the time domain wt can decompose complex time series by capturing useful information on different resolution levels and yield a more coherent structure of original signal to data driven models adamowski and sun 2010 nourani et al 2009a previous studies have reported the successful implementation of wt based hybrid models in hydrological and water resources forecasting afan et al 2016 belayneh et al 2014 dixit et al 2016 fahimi et al 2017 graf et al 2019 yaseen et al 2015 a hybrid model coupling wt with ann wt ann has already been applied for forecasting time series in various fields previous studies have shown that the wt ann models are usually efficient in responding to nonlinear and nonstationary time series for streamflow forecasting kasiviswanathan et al 2016 peng et al 2017 precipitation and drought forecasting abbaszadeh 2016 belayneh et al 2014 rainfall runoff modeling abbaszadeh et al 2018 nourani et al 2014 shoaib et al 2019 river water temperature forecasting graf et al 2019 zhu et al 2019 groundwater level forecasting barzegar et al 2017 ebrahimi and rajaee 2017 etc for instance nourani et al 2014 compared the efficiency of wt ann and ann models in modeling rainfall runoff of two different watersheds and found that the wt ann model could better capture the peak values in runoff time series abbaszadeh 2016 proposed a new method of de noising hydrological time series and constructed wt ann models for monthly precipitation forecasting the results showed that the de noising technique could efficiently improve the performance of wt ann models therefore in order to resolve the nonstationary components in salinity time series the development of wt ann models for estuarine salinity forecasting might also be an interesting attempt while their applications in this field are still rare despite the increased popularity of wt based forecasting models in hydrological and water resources applications some details of these models in real world forecasting has not always been scrutinized du et al 2017 zhang et al 2015 mainly concerned with the boundary treatment the algorithm of wt and the forecasting framework of wt based models quilty and adamowski 2018 it has been noticed that the discrete wt dwt which has already been popular in hydrological and water resources forecasting should not be used for real world forecasting applications since the future data is involved and the boundary effect arises during the wavelet decomposition stage in contrast the à trous algorithm at can avoid the usage of future data and be corrected in terms of the boundary condition given this the at with boundary treatment instead of the dwt was utilized to construct the hybrid wt ann models considering different wavelet based forecasting frameworks in this study the main objective of this study was to evaluate the effectiveness of a hybrid model coupling wavelet transform and artificial neural network wt ann model for estuarine salinity forecasting at daily scale in the pearl river estuary china the forecast performances of the wt ann models were contrasted with traditional multiple linear regression mlr models and single ann models two wavelet based forecasting frameworks the direct forecast df framework i e only explanatory variables are decomposed leading to direct forecasting of the target variables and multicomponent forecast mf framework i e both explanatory and target variables are decomposed and each target component is forecasted separately were used to construct the wt ann models and their discrepancies in forecast accuracy were compared and analyzed 2 study area and data 2 1 study area the pearl river delta prd located in the southeastern part of the pearl river basin is regarded as one of the most complicated river network regions in the world covering an area of more than 10 000 km2 it is characterized by a subtropical monsoon climate with an annual precipitation ranging from 1200 to 2200 mm but the volume of rainfall is unevenly distributed throughout the year with precipitation from april to september accounting for approximately 85 of the annual precipitation zhang et al 2010 the three main branches in the pearl river system xijiang river dongjiang river and beijiang river converge on this region and the freshwater outflows from eight outlets into the south china sea which from west to east are the yamen hutiaomen jitimen modaomen hengmen hongqimen jiaomen and humen waterways fig 1 a these eight outlets are connected by a large number of tributaries resulting in an intricate hydrodynamic context this is also one of the reasons why the saltwater intrusion process in the region is so complicated wang et al 2012 among the eight outlets in the prd the modaomen waterway located between 22 00 n and 22 40 n latitude and between 113 10 e and 113 40 e longitude fig 1b accounts for the largest proportion of the total outflow in the pearl river basin xu et al 2015 an irregular semidiurnal tide exists in the modaomen waterway and the interannual variation of the tide range is not evident with the mean annual tidal range fluctuating at approximately 1 5 m saltwater intrusions are more severe in the modaomen waterway than in the other seven outlets yuan et al 2015 over the past few decades extensive anthropogenic activities including sand excavation dam construction and land reclamation have led to large alterations in the hydrodynamic condition of the region zhang et al 2010 this variation has directly or indirectly exacerbated the problem of saltwater intrusion during the dry season october march according to daily salinity data from 2003 to 2010 at the pinggang station mean salinities during the dry season were greater than the water supply criterion of 250 mg l these salinities up to 1232 3 mg l were approximately five times higher than the water supply criterion in the dry season from 2007 to 2008 liu et al 2014 overall longer duration wider influenced area and higher invasion intensity of saltwater intrusions have developed in the modaomen waterway in recent years 2 2 data in this study the daily average salinity at pinggang station fig 1 b located around 35 km upstream of the estuary was chosen as the forecast object the predictors can be classified into antecedent and exogenous variables antecedent variables include the previous salinity measured at the pinggang station whereas exogenous variables include the daily average discharge at the sanshui and makou stations fig 1 b and the daily lowest tide level at the sanzao station fig 1 b the study period covers nine dry seasons october march from 2001 to 2010 and each dataset comprises 1107 records among these data there are three dry years four wet years and two normal years included in the study period indicating a good representativeness of the dataset all the data were obtained from the hydrological bureau of guangdong province with reliability and consistency strictly inspected by these authorities statistical characteristics of all the data are presented in table 1 including the daily average salinity the daily average discharge and the daily lowest tide level in order to train and test the models each dataset was partitioned into three parts training set the first to fifth dry seasons validation set the sixth to seventh dry seasons and testing set the eighth to ninth dry seasons the sample sizes of training validation and testing sets are 685 250 and 172 respectively 3 methods and model implementation in this study three types of models i e the mlr ann and wt ann models were built for forecasting estuarine salinity the general technology roadmap is presented in fig 2 firstly the mutual information mi and conditional mi cmi methods were applied to select optimal input variables for each model section 3 1 secondly on the basis of these selected input variables the forecasted results of the mlr and ann models were directly obtained by training and testing the models sections 3 2 and 3 3 due to the uncertainty of the number of hidden neurons data in the validation set were used to determine the network structure of ann models section 3 3 to establish the wt ann models two wavelet based forecasting frameworks the df and mf frameworks were employed in order to combine wt with ann section 3 5 furthermore as in the case of the mf framework the impacts of using different ensemble methods on model performance were considered as well section 3 5 finally the performances of each salinity forecasting model were evaluated using several statistical indices section 3 6 3 1 selection of input variables the choice of input variables is a crucial consideration for the identification of the optimal functional form of statistical models may et al 2011 in data based salinity forecasting models the first step is to determine the optimal input variables there are three types of algorithms for selecting input variables filter wrapper and embedded methods may et al 2011 we adopt filters in this study on account of their independence from and their ability to be coupled with any type of regression models quilty et al 2016 in light of previous studies river discharge is one of the most essential components to dilute estuarine salinity becker et al 2010 liu et al 2014 zhang et al 2016 whereas tide is the most direct factor to drive saltwater into estuary and increase the salinity gong and shen 2011 wang et al 2012 consequently both daily average discharge and daily lowest tide level are considered as exogenous variables for forecasting daily salinity in this work furthermore some researches have also shown that salinity time series have significant autocorrelation and that the variations of present salinity are strongly dependent on previous salinity levels lu and chen 2010 qiu and wan 2013 sun and koch 2001 therefore the previous daily average salinity is also considered as an antecedent variable for forecasting salinity in this study after preliminarily choosing the above predictors it is necessary to determine the most appropriate lead time of each predictor such that the optimal input variables can be selected for this purpose the mi and cmi methods were applied as filters the mi method describes the correlation between two variables and is derived from information theory shannon 1948 it is a type of nonparametric statistical and data driven method which can be used to identify the nonlinear dependence the mi between two variables x and y can be given in the form of the following equation bowden et al 2005a 1 m i x y f x y x y l n f x y x y f x x f y y d x d y where f x x and f y y are the marginal probability distribution functions of x and y and f x y x y is the joint probability distribution function of x and y however mi is not directly able to deal with the issue of redundancy and conditional irrelevancy during input variable selection bowden et al 2005a chen et al 2014 to overcome this problem it is worth to introduce the cmi quantifying the information between two variables that is not contained in a third one brown et al 2012 by introducing a third variable one may calculate the mi between the first two variables conditioned on the third variable to estimate the cmi the cmi using three variables can be calculated as follows quilty et al 2016 2 c m i x y z m i x y z m i x z details of calculating the cmi can be found in previous studies brown et al 2012 li et al 2015 quilty et al 2016 the main steps of selecting the optimal input variables are as follows 1 calculate the mi between the time series of current salinity and previous salinity at different lead times 1 5 days during the training period 2 determine the most appropriate lead time for previous salinity i e that with the highest mi and the corresponding input variables are selected into the set s 3 calculate the cmi between the time series of current salinity and daily discharge daily lowest tide level at different lead times 1 5 days conditioned on each variable in set s during the training period 4 determine the most appropriate lead time for daily discharge daily lowest tide level i e that with the highest cmi and the corresponding input variable is selected into the set s 5 output the set s containing the selected input variables the computation of mi and cmi can be implemented by using a kernelmi package in matlab version mikhail 2020 3 2 multiple linear regression mlr mlr is a traditional method applied for simulating linear relationships between dependent variable and multiple independent variables it can be represented by the following function adamowski et al 2012 3 y α β 1 x 1 β k x k where y is the dependent variable forecast object x 1 to x k reflect all independent variables forecast factors β 1 to β k are their corresponding regression coefficients and α is the intercept generally α and β are determined by the least squares fitting such that the summed squares of differences of estimated and observed values are minimized wang et al 2016 the mlr models for salinity forecasting were trained and tested using data in the training and testing sets this means that data in the validation set were unused for the mlr models because there was no need to determine the model structure like the ann models section 3 3 the selection of input variables for different forecast lead times is as presented in section 3 1 3 3 artificial neural network ann ann is a machine learning model inspired by biological neural systems and learns through processes analogous to those of the human brain karenina et al 2019 the advantages of anns are their parsimonious data requirements rapid execution time and ability to produce models in which the relationship between inputs and outputs is not fully understood among the variants of ann the multilayer perceptron mlp network with a feedforward back propagation bp network structure is a popular ann paradigm used today maier et al 2010 zhang et al 2015 typical mlp networks consist of an input layer one or more hidden layers and an output layer it has been proven that an ann model with only one hidden layer is sufficient for forecasting and simulating applications in water science asce 2000 thus a three layer bp network model structure was used in this work the logistic sigmoid activation function and linear activation function were selected for computing the outputs of each neuron in the hidden and output layers respectively the mean square error mse was chosen as the objective function for model training the levenberg marquardt algorithm lm was used as the training algorithm as it was found to outperform other training algorithms such as the conjugate gradient algorithm and gradient descent with momentum algorithm adamowski et al 2012 details of the lm are described by karul et al 2000 the primary requirement for developing an ann model is the selection of the most appropriate number of hidden neurons that is basically problem specific wang et al 2006 however there is no unique systematic strategy to determine this number considering the different aspects of individual problems fahimi et al 2017 generally a trial and error approach is recommended in order to obtain the best network structure for a specific issue karenina et al 2019 maier et al 2010 in this study the optimum number of hidden neurons was determined by testing several alternative values ranging from 2 to 20 and selecting the value with a corresponding ann model providing the highest forecast accuracy in the validation set after being trained in the training set 3 4 wavelet transform wt wt methods can decompose an original signal into scaled and translated versions of a specific wavelet basis presenting information of different resolution levels in both the time and frequency domains sharma et al 2016 two types of wts are generally considered the continuous wt cwt and the discrete wt dwt the cwt operates on smooth continuous functions and can detect signals on all scales nalley et al 2012 thus identifying global and localized features of the original time series sharma et al 2016 however the scale and translation coefficients of cwt are continuous resulting in long computation times due to the redundant additional data generated it may be more desirable to choose the dwt over cwt for practical application since the discretized wavelet requires less computation time and is simpler to implement in dwt decimation retaining one data point out of every two is implemented such that only half of the coefficients of the detailed components are left at the current level whereas half of the coefficients in the smooth version are recursively processed using high pass and low pass filters for coarser resolution levels rathinasamy et al 2013 in other words the number of wavelet scaling coefficients is halved with each move to the next decomposition level by decimation which means less information is available to train the forecast model at the coarser level inevitably leading to a reduction in prediction accuracy maheswaran and khosa 2013 while the property of reducing redundant information is helpful in applications such as data and image compression this type of dwt is inherently not shift invariant i e if any new value is added into the end of the time series during forecasting certain values of wavelet components will not be the same as before renaud et al 2005 and thus inapplicable for problems related to singularity detection forecasting and nonparametric regression maheswaran and khosa 2012a furthermore another major source responsible for the inappropriate usage of dwt in terms of forecasting is the so called boundary effect and the involvement of future data i e data unavailable in real world forecasts during the decomposition and reconstruction stages du et al 2017 zhang et al 2015 which have been elaborated by quilty and adamowski 2018 to overcome these problems a redundant algorithm the à trous algorithm at can be used its decomposition formulas can be defined as follows quilty and adamowski 2018 4 w j t a v j 1 t a v j t a 5 v j t a l 0 l 1 g l a v j 1 t 2 j 1 l m o d n a where v 0 t a denotes the original time series at time t w j t a and v j t a represent the j th level wavelet detail and scaling approximation coefficients at time t respectively g l a a scaling filter for at and g l a g l 2 g l a scaling filter for dwt mod the modulo operator in at decimation is avoided thus wavelet components wavelet coefficients and scaling coefficients are of the same length as in the original time series at also possesses the shift invariant property that makes it suitable for time series analysis regression and forecast applications maheswaran and khosa 2012a moreover at does not require future information to exist because it needs only the present time index or an earlier example as seen from eqs 4 and 5 the original time series can be directly obtained by additive reconstruction and it is expressed as follows quilty and adamowski 2018 6 v 0 t a j 1 j w j t a v j t a where v 0 t a represents the original time series at time t w j t a and v j t a represent the j th level wavelet detail and scaling approximation coefficients at time t respectively the problems of boundary effect due to the decomposition level and wavelet basis will introduce error into the wavelet scaling coefficients at the beginning of the time series which can be described as following equation bašta 2014 maslova et al 2016 quilty and adamowski 2018 7 l j 2 j 1 l 1 1 where l j is the number of wavelet scaling coefficients affected by the boundary effect j the decomposition level l the length of wavelet basis to avoid the boundary effect we remove the first l j wavelet scaling coefficients of the time series so that the boundary corrected wavelet components can be used to calibrate the wt based forecasting models quilty and adamowski 2018 selecting an appropriate wavelet basis is crucial to the forecast performance of a wt based model the haar wavelet a low pass filter is concentrated over the narrowest support band and therefore has good localization properties belayneh et al 2014 because the daily salinity time series have many short memory transient features and swings the haar wavelet with good time localization and compact support is effective in detecting variation within the series thus the haar wavelet has been selected herein as the wavelet basis for the wt ann models decomposition level is another key point for establishing a wt based model maheswaran and khosa 2012a revealed that the depth of decomposition must be selected after investigating the underlying dominant features in order to enable their unambiguous detection in this study the decomposition level was determined by an empirical equation nourani et al 2009a previously utilized by graf et al 2019 and seo et al 2015 8 l i n t l o g n where l and n are the optimal decomposition level and length of time series respectively l is determined to be 3 in this study since n 1107 thus each original time series is decomposed into six subseries i e d 1 d 2 d 3 a 1 a 2 and a 3 3 5 wavelet based artificial neural network wt ann there are two common forecasting frameworks existing in the current literature to couple wt and ann the df and mf frameworks nguyen and nabney 2010 corresponding to the single and within approaches of the wavelet data driven forecasting framework wddff in quilty and adamowski 2018 respectively these frameworks may result in different forecast accuracies and it is therefore essential to take both into consideration to identify which is the most appropriate for a given dataset nguyen and nabney 2010 considering the effect of both original and wavelet decomposed inputs on forecasting target variables the df and mf frameworks we employed in this study are more analogous to the single hybrid and within hybrid methods of wddff in quilty and adamowski 2018 the processes behind these two frameworks can be seen from fig 3 a and b in the df framework alizadeh and kavianpour 2015 samadianfard et al 2018 only the input variables including both antecedent and exogenous variables are decomposed into several subseries a i and d i thereafter a certain input selection method e g mi is applied to determine the optimal inputs from original and wavelet decomposed inputs for forecasting the target time series these selected inputs are fed into the model e g ann model to obtain the forecasting results after the model is trained and calibrated only one forecasting model is built in this framework in the mf framework shafaei and kisi 2016 yadav and eliza 2017 both the input variables and their target variables are decomposed into subseries a i and d i then similarly the optimal inputs are identified for forecasting each component of the target variables by using certain input selection methods e g mi unlike the df framework however each forecast component wavelet components of target variables is allocated one model e g ann model to be trained and calibrated separately after forecasting all the components of the target variables an ensemble method is applied to integrate the forecast components into the final forecast results generally the forecast components can be simply integrated by additive reconstruction eq 6 in this study we considered three types of ensemble methods the direct addition da mlr and ann ensemble methods in the da method the final forecast results are obtained by adding all the forecast components directly in the mlr ann ensemble method a an mlr ann model is trained to capture the relationships between the forecast components and the original target variables in the training set and then used for generating the forecast results in the testing set 3 6 model evaluation the performances of all developed salinity forecasting models were evaluated using four traditional statistical indices i e the nash sutcliffe efficiency nse root mean square error rmse mean absolute error mae and correlation coefficient r which can be expressed using the following equations maheswaran and khosa 2012b 9 nse 1 i 1 n o i p i 2 i 1 n o i o 2 10 rmse i 1 n o i p i 2 n 11 mae i 1 n o i p i n 12 r i 1 n o i o p i p i 1 n o i o 2 i 1 n p i p 2 where p i is the i th predicted daily salinity o i is the i th objected daily salinity o and p denote the mean observed and predicted daily salinity respectively and n is the total number of data samples evaluated the kling gupta efficiency kge based on a decomposition of nse into its constitutive components correlation variability bias and mean bias is also used for comparative evaluation of these three models knoben et al 2019 which can be expressed as follows gupta et al 2009 13 k g e 1 r 1 2 α 1 2 β 1 2 α σ sim σ obs β μ sim μ obs where r is the linear correlation between observations and simulations α a measure of the variability error β a bias term σ obs and σ sim standard deviation of observations and simulations μ obs and μ sim mean values of observations and simulations 4 results 4 1 selection of input variables in this study the three proposed models the mlr ann and wt ann models were employed to forecast the daily average salinity in the modaomen waterway prd china with forecast lead times ranging from 1 to 3 days to determine the optimal input variables for salinity forecasts we considered previous salinity daily discharge and daily lowest tide level table 2 presents the results of the mi between the current salinity and each of the aforementioned predictors at different lead times 1 5 days the mi of previous salinity is significantly greater than that of the other two predictors e g 1 332 for s t 1 0 697 for f t 1 and 0 139 for t t 1 and decreases rapidly with the extension of lead time indicating a strong autocorrelation of salinity time series generally antecedent variables play an important role in a time series model so we firstly selected the optimal input variables from the previous salinity after trial and error tests we found that using two items of previous salinity could significantly improve the forecast accuracy compared to using only one item of previous salinity and the improvements slowed down when continuing adding more previous salinity into input variable set thus we chose to use two items of previous salinity in the input variable set in order to make the set as small as possible as the problems of redundancy maybe exist due to the dependency between the antecedent and the exogenous variables the cmi of daily discharge and daily lowest tide level conditioned on previous salinity are also presented in table 2 from the table there is also a significant decrease in the cmi of both two exogenous variables with the extension of lead time in line with the selection method in section 3 1 the final selected input variables for 1 to 3 days forecast lead times are shown in table 3 4 2 results of mlr and ann models table 4 presents the performance results using the mlr and ann models for forecasting daily salinity at 1 to 3 days ahead during the training and testing periods the table shows that the forecast results of the ann models are more accurate than those of the mlr models with respect to 1 to 3 days forecast lead times in both the training and testing sets for instance when the forecast lead time is 3 days the proposed ann model has an nse of 0 592 and an r of 0 784 in the testing set which are greater than those of the mlr model an nse of 0 507 and an r of 0 726 the ann model has an rmse of 423 548 and an mae of 256 271 which are both smaller than those of the mlr model rmse of 465 565 and mae of 274 960 for the ann mlr models nse values of 0 928 0 925 and 0 772 0 733 indicate a good correlation between the observed and forecasted salinity values at 1 and 2 days forecast lead times in the testing set whereas an nse value of 0 592 0 507 exhibits a more mediocre performance at 3 days forecast lead time fig 4 provides the forecast results of the mlr and ann models for 1 to 3 days forecast lead times in the testing set indicating that the deviation between the forecasted and observed curves gradually increases with the extension of forecast lead time the ann models are slightly better than the mlr models as evidenced by the fact that their forecasted curves are a bit more similar to the observed curves the right panel of fig 4 also presents the scatter plots using the mlr and ann models during the testing period in general as the scatters approach the vicinity of the identity line denoting equality between the forecasted and observed value the performance of the model can be considered to be better it is clear that the scatters in the ann models are closer to the identity line than those of the mlr models especially in the forecast for 3 day lead time the scatter plots in fig 4 also show that when the forecast lead time is extended to 3 days several scatters with observed values lower greater than 1000 mg l are significantly above below the identity line exhibiting a trend of overestimating low values salinity under 1000 mg l and underestimating high values salinity over 1000 mg l in both the mlr and ann models 4 3 results of wt ann models the results of mi between each wavelet component of current salinity forecast object and each wavelet component of input variables forecast factors are presented in fig 5 for both the df and mf frameworks each subgraph corresponds to an input variable the horizontal wavelet components also called forecast component are from current salinity and the vertical components also called input components are from those selected input variables table 3 as presented in fig 5 some mi concerned with wavelet components are greater than those merely related to the original time series ori which means that further information has been exposed during the decomposition of the ori into several wavelet components this may indicate that the wt can increase the correlation between the input factors and output objects of the models and this also open up possibilities to the use of the wt ann models to improve the accuracy in salinity forecasting the optimal component of each input variable i e the component with the highest mi is selected for forecasting the original salinity series df framework or each forecast component mf framework as presented in fig 6 based on the selected input components of both two frameworks fig 6 the forecast results of wt ann models are further obtained tables 5 and 6 table 5 presents an evaluation of each forecasted component using the wt ann models with the mf framework these forecasted components are later integrated as the final results of forecasted salinity using certain ensemble methods e g da mlr and ann methods evaluation indices for df and mf frameworks with different ensemble methods are presented in table 6 from the nse and r in table 5 we can see that it is more accurate for models to forecast approximation coefficients a i than detail coefficients d i e g the nses for a 3 are respectively 0 995 0 968 and 0 880 with forecast lead times ranging from 1 to 3 days which are much higher than those of d i in other words the lower the signal frequency of a wavelet component the more accurately the models can forecast it this is probably because low frequency signals a i are generally influenced by long term factors making them fluctuate relatively smoothly and thus easier to forecast whereas high frequency signals d i are predominantly influenced by short term factors including noise leading to rapid and irregular variation in time series that makes their forecasting relatively difficult however the rmse and mae of a i are also greater than those of the d i in spite of the higher nse and r of a i which indicates that the energy related to the amplitude of the signals of high frequency signals is much lower than that of low frequency signals thus even when high frequency signals which are relatively hard to forecast are ultimately integrated into the final outputs using certain ensemble methods the forecast results would not be negatively affected to a large extent this makes it feasible to employ the mf framework for the wt ann models as presented in table 6 for the wt ann models with a mf framework the ann ensemble method outperformed da and mlr ensemble methods in the training set whereas the mlr ensemble method outperformed the other two methods in the testing set this suggests that the mlr method is more applicable in practice for the df framework overall the forecast results are less accurate than those of the mf framework with respect to a forecast lead time of 1 to 3 days especially in the forecast for 3 day lead time compared with table 4 the forecast results of the wt ann models with both df and mf frameworks irrespective of the ensemble method used are more accurate than single ann models according to the evaluation indices used which indicates that the wt ann models have an advantage over the ann models in forecasting estuarine salinity fig 7 presents the forecast results of the ann models and wt ann models using the mf framework and mlr ensemble method in the testing set as presented in the figure the forecast performance of the wt ann models is significantly better than that of the ann models because the forecasted curves more accurately fit the observed curves and the scatters are closer to the identity line particularly when the forecast lead time is 3 days the nse values of the wt ann models are respectively 0 938 0 806 and 0 667 corresponding to 1 2 and 3 days forecast lead times all of which are greater than the corresponding values for the ann models 0 928 0 772 and 0 592 moreover according to the scatter plots the trend of overestimating low values salinity under 1000 mg l and underestimating high values salinity over 1000 mg l is also eased when using the wt ann models 4 4 results of model evaluation fig 8 shows the taylor diagram for the mlr ann and wt ann models with different forecast lead times in testing set all the points of wt ann models d g j are closer to the observed point a compared with the mlr b e h and ann c f i models for a particular forecast lead time denoting that the forecasted results of wt ann models fit the observation better in order to allow more quantitative comparisons of the different models we also calculated the relative forecast errors re and kge of each model from the boxplots of re fig 9 a c although the median re for the wt ann models is not significantly lower than those of the mlr and ann models the width of the box and the values of the right boundaries are significantly smaller in the wt ann models than in the other two models indicating that the wt ann models provide an overall lower forecast error additionally the number of outliers of the re varies significantly among the three models in general a model with fewer outliers of forecast error is considered more credible because it has greater forecasting stability according to fig 9a c there are fewer outliers in the wt ann models than in the other two models indicating a higher forecasting stability of wt ann models the bar charts of kge fig 9d also evidence a superiority of wt ann models with the highest kge of 0 927 0 776 and 0 632 for 1 3 day lead time and it is found that the differences in the kge of these three models become increasingly prominent as the forecast lead time extends denoting that the advantages of wt ann models seem to be more significant for longer forecast lead times 5 discussion this study utilized three types of models the mlr ann and wt ann models to forecast daily salinities 1 to 3 days ahead in the modaomen waterway prd china according to the results the ann models had higher forecast accuracy than the mlr models indicating that such machine learning models are more effective than traditional statistical models in terms of daily salinity forecasting this is probably because the relationships between the different input variables and salinity time series are generally nonlinear the mlr models can only capture and reproduce linear relationships whereas the ann models have the ability to adequately represent highly nonlinear relationships among variables moreover comparisons between the results of the ann and wt ann models reveal that the use of wt to preprocess data can improve the forecast accuracy of the ann models in both the training and testing sets this is because the decomposition of the original time series into several subseries by wt allows increased potential information such as nonstationary features to be mined and captured by the models as presented in fig 5 some mi related to the subseries was greater than that merely concerned with the original series denoting that the wt process increased the correlation between the input factors and output objects of models by capturing detailed information at various wavelet resolution levels adamowski et al 2012 on the other hand the noise that is usually present in hydrological time series can affect the accuracy of forecasts in the ann models by causing problems related to overfitting but the wt ann models can alleviate such problems and enhance the generalization abilities via extracting the noise high frequency components from the original time series table 7 shows that the rates of increase in nse using the ann models compared with the mlr models are significantly lower in the testing set 0 31 3 85 and 16 74 than in the training set 1 21 8 49 and 24 17 which is likely because of the limited generalization ability of the ann models on the contrary the improvements of the wt ann models over the ann models in nse are more obvious during the testing period 1 06 4 48 and 12 63 compared with the training period 0 74 2 94 and 6 46 indicating that the wt ann models not only have an improved learning ability for nonlinear and nonstationary data but also possess stronger generalization abilities and are more robust against noise the results from the wt ann models with df and mf frameworks reveal that both wavelet based forecasting frameworks have the potential to improve forecast accuracy for the ann models highlighting the significance of preprocessing nonstationary data by wt overall the mf framework achieves better forecasts than the df framework in both the training and testing sets consistent with the works of nguyen and nabney 2010 this can be explained to some degree by the results presented in fig 5 from the right hand column this column is for the df framework of each subplot in fig 5 the values of mi for the wavelet components d 1 a 3 are not significantly greater and may even be smaller than those of the original time series ori which means that the df framework is insufficient to mine the potential information between the input and output variables on the contrary as for the mf framework the mi between the input and output variables were significantly increased after decomposing the original series into several wavelet components indicating that the mf framework can markedly enhance the correlation between the input and output variables in the models although the above explanation in terms of the mi for the forecasting framework cannot be generalized for all cases it may still provide a means to select an appropriate forecasting framework for constructing the wavelet based models without the need to put all frameworks into practice few studies have focused on the comparison between the df and mf frameworks in terms of the construction of wavelet based hybrid models for hydrological and water resources forecasting alizadeh and kavianpour 2015 and samadianfard et al 2018 used wavelet neural networks with the df framework to predict a variety of ocean water quality parameters and soil temperature respectively and both of their results revealed that the wt ann models are superior to the ann models shafaei and kisi 2016 and yadav and eliza 2017 considered only the mf framework to predict lake water fluctuation nguyen and nabney 2010 empirically compared the two frameworks of combining wt with data driven models and found that the mf framework outperformed the df framework in forecasting short term electricity demand and gas price the reason for the superiority of the mf framework however remains unexplained quilty and adamowski 2018 have compared these two frameworks in detail by exploring four different df approaches and four different mf approaches which is the most detailed study to explore different wt based forecasting approaches to date they found that the linear wt based model with the df framework considering both wavelet decomposed inputs and original inputs provided better performance than other models in their urban water demand forecasting case study for the mf framework the selection of an ensemble method also plays a significant role in forecast performance from our results we can see that the ann ensemble method surpasses the other two methods da and mlr in the training set whereas the mlr ensemble method performs the best in the testing set indicating that the mlr ensemble method is the most effective among the three methods in practice the poor performance of ann ensemble method in the testing set is likely related to the overfitting problems which may result in a high fitting ability in the training set but poor generalization ability in the testing set it is unnecessary to use such complicated nonlinear models for integrating subseries because it adds additional errors to the forecast which are not present in simple linear ensemble methods quilty and adamowski 2018 comparing the da and mlr ensemble methods the former has been employed in the majority of studies related to the mf framework nguyen and nabney 2010 shafaei and kisi 2016 yadav and eliza 2017 whereas the use of the mlr ensemble method has been relatively rare although there is theoretical support for the da ensemble method the relationship between the forecasted original series and wavelet components may not be consistent with additive reconstruction eq 6 the results in this study suggest that the mlr ensemble method achieves better forecasts in practice than the traditional da method providing another possible way for integrating forecasted wavelet components the results of these three models suggest that forecast accuracy rapidly decreases when the forecast lead time is increased from 1 to 3 days nse for the mlr models 0 925 to 0 507 nse for the ann models 0 928 to 0 592 nse for the wt ann models 0 938 to 0 667 and the superior performance of the wt ann models compared with the mlr and ann models becomes increasingly apparent table 7 this is also in accordance with the results of kasiviswanathan et al 2016 who forecasted daily streamflow using wavelet neural network since the autocorrelation of salinity time series is quite strong at short lead times table 2 the predictor of previous salinity plays a dominant role in salinity forecasting when the forecast lead time is short it is thus sufficient for traditional linear models mlr models to forecast daily salinity accurately at 1 day lead time because the relationship between the previous and current salinity is generally simple and linear accordingly there is no prominent discrepancy in the forecast performance using different models at short forecast lead times on the other hand when the lead time is extended the autocorrelation of salinity series rapidly weakens and the predictors increasingly depend on exogenous variables daily discharge and daily lowest tide level in table 2 whereas the correlation between salinity and exogenous variables is generally complex and nonlinear as found by maheswaran and khosa 2013 in their study of forecasting groundwater levels the nonlinearity and complexity in the forecasted system increased at longer lead times consequently the advantages of using the wt ann models in dealing with the problems of nonstationarity and noise in time series become apparent when increasing the forecast lead time leading to the most significant improvements over the other two models in 3 day ahead forecasting 6 conclusion in this study a hybrid model coupling wt and ann was implemented to achieve better forecasts for daily salinity in the pearl river estuary china two different forecasting frameworks and three different ensemble methods of the wt ann model were taken into consideration model performances were compared with traditional mlr and ann models the main conclusions of this study are as follows 1 the ann models outperformed the mlr models in terms of forecasting daily salinity at 1 3 day lead time owing to the fact that the ann models are more effective in modeling the nonlinear components of salinity time series during the testing period the mlr models have an nse of 0 507 0 925 and an rmse of 181 383 465 565 whereas the ann models have a greater nse of 0 592 0 928 and a lower rmse of 177 831 423 548 2 the wt ann models provided greater accuracy in salinity forecasting than the ann models indicating that decomposing the original time series by wt can improve the forecast performance of models the wt ann models combine the advantages of both ann and wt enabling them to capture the nonlinear relationships and respond to the nonstationary features in salinity time series 3 the mf framework outperformed the df framework for constructing the wt ann models in this study because the mf framework can better excavate potential information between the input and output variables moreover as in the mf framework the mlr ensemble method was more effective than the da and ann ensemble methods in practice 4 when the forecast lead time is extended from 1 to 3 days the prediction accuracy of all the models tested decreases rapidly but the superior performance of the wt ann models in comparison with the mlr and ann models becomes increasingly apparent the rates of increase in nse when using the wt ann models compared with the ann mlr models are respectively 1 06 1 37 4 48 9 97 and 12 63 31 49 corresponding to 1 2 and 3 days forecast lead times as this study has only focused on short term salinity forecasting in an estuarine region further research must be conducted to achieve higher accuracy with respect to long term salinity on time scales more relevant to support water resources management such models must incorporate the effects of climate change and atmospheric circulation in terms of their input variables additionally due to the fact that a variety of uncertainty factors such as inputs selection model structure and model parameters affect the outputs of a forecasting model it is not reliable to focus only on deterministic prediction i e to output one forecasted value at one moment future studies should attempt to employ wavelet based models in probabilistic prediction i e to output one forecasted interval at one moment that can reflect the uncertainty of a forecast quilty and adamowski 2020 quilty et al 2019 credit authorship contribution statement fanhan zhou methodology software formal analysis investigation writing original draft visualization bingjun liu conceptualization validation resources data curation writing original draft writing review editing supervision project administration funding acquisition kai duan writing review editing supervision funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this study was supported by the national natural science foundation of china grant nos 51879289 51909285 guangdong basic and applied basic research foundation 2019b1515120052 the national key research and development program of china grant nos 2017yfc0405900 we also thank enago www enago cn for the english language review 
5371,accurate and reliable predictions of estuarine salinity can lead to more effective water resource management and can alleviate the adverse impacts of saltwater intrusion due to the nonlinear and nonstationary features in time series of estuarine salinity this study is conducted to develop a hybrid model coupling the techniques of wavelet transform wt and artificial neural network ann for forecasting estuarine salinity in the pearl river estuary china two wavelet based forecasting frameworks the direct forecast df framework i e only explanatory variables are decomposed leading to direct forecasting of the target variables and multicomponent forecast mf framework i e both explanatory and target variables are decomposed and each target component is forecasted separately were used to construct the wt ann models the results reveal the superiority of hybrid wt ann models in estuarine salinity forecasting over traditional multiple linear regression mlr models and single ann models indicated by the nash sutcliffe efficiency nse correlation coefficient r root mean square error rmse mean absolute error mae and kling gupta efficiency kge between the two wavelet based forecasting paradigms the mf framework outperformed the df framework for better capturing the mutual dependence i e mutual information mi between input and output variables additionally the superiority of wt ann models in comparison with mlr and ann models is increasingly prominent when the forecast lead time is extended from 1 to 3 days keywords salinity forecasting wavelet transform artificial neural network hybrid model pearl river estuary 1 introduction estuaries the junction between coastal and terrestrial waters are particularly vulnerable to saltwater intrusions that could exert an adverse impact on the ecological environment liu et al 2019 and diminish freshwater available for humans rengasamy 2006 anthropogenic activities such as damming sand excavation and dredging have greatly altered the natural pattern of channel characteristics and intensified saltwater intrusions leading to the deterioration of water quality in coastal cities hu et al 2019 consequently accurate forecasts of salinity variation in estuaries are essential for water security in coastal regions rohmer and brisset 2017 according to previous studies salinity forecasts can be undertaken using either numerical hydrodynamic or data driven models since numerical models are effective in reproducing the physical processes of salinity transport they have been used widely for exploring hydrodynamic mechanisms of saltwater intrusion sun et al 2016 wang et al 2012 yuan et al 2015 however the applications of numerical models in salinity forecasting are still limited because these models require many different types of field data and a large effort to calibrate the model parameters by contrast data driven models can achieve satisfactory performance in various hydrological forecasting applications with much less field information and smaller costs londhe and charhate 2010 in general data driven models can be classified into traditional statistical models and more recent machine learning models solomatine and ostfeld 2008 traditional statistical models employed in salinity forecasts rely on the statistical correlation between the historical time series of salinity and relevant predictors e g previous salinity upstream inflow wind speed tide level and precipitation studies performed by sun and koch 2001 parsa and etemad shahidi 2011 qiu and wan 2013 are some previous examples where statistical models have been successfully used in forecasting estuarine salinity nevertheless the capability of traditional statistical models in capturing nonlinear features in hydrological processes is usually limited belayneh et al 2014 yaseen et al 2015 numerous studies have revealed that the process of saltwater intrusion is affected by diverse factors e g river discharge tidal current wind precipitation topography and human activities and the correlations among different variables are highly complex and nonlinear hu et al 2019 liu et al 2014 tian 2019 zhang and deng 2010 machine learning techniques have thus been successfully used for modeling the nonlinear hydrological processes over recent years these machine learning models have the inherent property of dealing with nonlinear data without prior knowledge of the whole physical process and they can therefore have multiple inputs with different characteristics to represent the spatiotemporal variability nourani et al 2009b machine learning models such as artificial neural network ann bowden et al 2005b he et al 2011 huang and foo 2002 kingston et al 2005 maier and dandy 1996 maier et al 2010 support vector machine svm fang et al 2016 rohmer and brisset 2017 adaptive neuro fuzzy inference systems anfis barzegar et al 2016 soltani et al 2010 and random forest rf liu et al 2015 vermeulen and van niekerk 2017 have been broadly used and accepted as effective tools for modeling and forecasting variations in water quality or salinity despite the merits and usefulness of these machine learning models the presence of different frequency components e g periodicity and noise embedded in time series of estuarine salinity are challenging the capacity of machine learning models in terms of dealing with nonstationary data at various scales from hourly to multidecadal dixit et al 2016 with regard to saltwater intrusion salinity time series generally have nonstationary characteristics on account of the interaction of marine terrestrial and meteorological factors hu et al 2019 for instance abrupt shift of estuarine salinity may occur due to some short term factors such as wind and rainstorm zheng et al 2014 while secular variations of saltwater intrusion are affected by some long term factors such as human activities and climate changes liu et al 2018 therefore hybrid models combining data preprocessing schemes with machine learning techniques can potentially have better performance in forecasting estuarine salinity than single machine learning models wavelet transform wt is a data preprocessing technique that provides a time frequency representation of a signal at different periods in the time domain wt can decompose complex time series by capturing useful information on different resolution levels and yield a more coherent structure of original signal to data driven models adamowski and sun 2010 nourani et al 2009a previous studies have reported the successful implementation of wt based hybrid models in hydrological and water resources forecasting afan et al 2016 belayneh et al 2014 dixit et al 2016 fahimi et al 2017 graf et al 2019 yaseen et al 2015 a hybrid model coupling wt with ann wt ann has already been applied for forecasting time series in various fields previous studies have shown that the wt ann models are usually efficient in responding to nonlinear and nonstationary time series for streamflow forecasting kasiviswanathan et al 2016 peng et al 2017 precipitation and drought forecasting abbaszadeh 2016 belayneh et al 2014 rainfall runoff modeling abbaszadeh et al 2018 nourani et al 2014 shoaib et al 2019 river water temperature forecasting graf et al 2019 zhu et al 2019 groundwater level forecasting barzegar et al 2017 ebrahimi and rajaee 2017 etc for instance nourani et al 2014 compared the efficiency of wt ann and ann models in modeling rainfall runoff of two different watersheds and found that the wt ann model could better capture the peak values in runoff time series abbaszadeh 2016 proposed a new method of de noising hydrological time series and constructed wt ann models for monthly precipitation forecasting the results showed that the de noising technique could efficiently improve the performance of wt ann models therefore in order to resolve the nonstationary components in salinity time series the development of wt ann models for estuarine salinity forecasting might also be an interesting attempt while their applications in this field are still rare despite the increased popularity of wt based forecasting models in hydrological and water resources applications some details of these models in real world forecasting has not always been scrutinized du et al 2017 zhang et al 2015 mainly concerned with the boundary treatment the algorithm of wt and the forecasting framework of wt based models quilty and adamowski 2018 it has been noticed that the discrete wt dwt which has already been popular in hydrological and water resources forecasting should not be used for real world forecasting applications since the future data is involved and the boundary effect arises during the wavelet decomposition stage in contrast the à trous algorithm at can avoid the usage of future data and be corrected in terms of the boundary condition given this the at with boundary treatment instead of the dwt was utilized to construct the hybrid wt ann models considering different wavelet based forecasting frameworks in this study the main objective of this study was to evaluate the effectiveness of a hybrid model coupling wavelet transform and artificial neural network wt ann model for estuarine salinity forecasting at daily scale in the pearl river estuary china the forecast performances of the wt ann models were contrasted with traditional multiple linear regression mlr models and single ann models two wavelet based forecasting frameworks the direct forecast df framework i e only explanatory variables are decomposed leading to direct forecasting of the target variables and multicomponent forecast mf framework i e both explanatory and target variables are decomposed and each target component is forecasted separately were used to construct the wt ann models and their discrepancies in forecast accuracy were compared and analyzed 2 study area and data 2 1 study area the pearl river delta prd located in the southeastern part of the pearl river basin is regarded as one of the most complicated river network regions in the world covering an area of more than 10 000 km2 it is characterized by a subtropical monsoon climate with an annual precipitation ranging from 1200 to 2200 mm but the volume of rainfall is unevenly distributed throughout the year with precipitation from april to september accounting for approximately 85 of the annual precipitation zhang et al 2010 the three main branches in the pearl river system xijiang river dongjiang river and beijiang river converge on this region and the freshwater outflows from eight outlets into the south china sea which from west to east are the yamen hutiaomen jitimen modaomen hengmen hongqimen jiaomen and humen waterways fig 1 a these eight outlets are connected by a large number of tributaries resulting in an intricate hydrodynamic context this is also one of the reasons why the saltwater intrusion process in the region is so complicated wang et al 2012 among the eight outlets in the prd the modaomen waterway located between 22 00 n and 22 40 n latitude and between 113 10 e and 113 40 e longitude fig 1b accounts for the largest proportion of the total outflow in the pearl river basin xu et al 2015 an irregular semidiurnal tide exists in the modaomen waterway and the interannual variation of the tide range is not evident with the mean annual tidal range fluctuating at approximately 1 5 m saltwater intrusions are more severe in the modaomen waterway than in the other seven outlets yuan et al 2015 over the past few decades extensive anthropogenic activities including sand excavation dam construction and land reclamation have led to large alterations in the hydrodynamic condition of the region zhang et al 2010 this variation has directly or indirectly exacerbated the problem of saltwater intrusion during the dry season october march according to daily salinity data from 2003 to 2010 at the pinggang station mean salinities during the dry season were greater than the water supply criterion of 250 mg l these salinities up to 1232 3 mg l were approximately five times higher than the water supply criterion in the dry season from 2007 to 2008 liu et al 2014 overall longer duration wider influenced area and higher invasion intensity of saltwater intrusions have developed in the modaomen waterway in recent years 2 2 data in this study the daily average salinity at pinggang station fig 1 b located around 35 km upstream of the estuary was chosen as the forecast object the predictors can be classified into antecedent and exogenous variables antecedent variables include the previous salinity measured at the pinggang station whereas exogenous variables include the daily average discharge at the sanshui and makou stations fig 1 b and the daily lowest tide level at the sanzao station fig 1 b the study period covers nine dry seasons october march from 2001 to 2010 and each dataset comprises 1107 records among these data there are three dry years four wet years and two normal years included in the study period indicating a good representativeness of the dataset all the data were obtained from the hydrological bureau of guangdong province with reliability and consistency strictly inspected by these authorities statistical characteristics of all the data are presented in table 1 including the daily average salinity the daily average discharge and the daily lowest tide level in order to train and test the models each dataset was partitioned into three parts training set the first to fifth dry seasons validation set the sixth to seventh dry seasons and testing set the eighth to ninth dry seasons the sample sizes of training validation and testing sets are 685 250 and 172 respectively 3 methods and model implementation in this study three types of models i e the mlr ann and wt ann models were built for forecasting estuarine salinity the general technology roadmap is presented in fig 2 firstly the mutual information mi and conditional mi cmi methods were applied to select optimal input variables for each model section 3 1 secondly on the basis of these selected input variables the forecasted results of the mlr and ann models were directly obtained by training and testing the models sections 3 2 and 3 3 due to the uncertainty of the number of hidden neurons data in the validation set were used to determine the network structure of ann models section 3 3 to establish the wt ann models two wavelet based forecasting frameworks the df and mf frameworks were employed in order to combine wt with ann section 3 5 furthermore as in the case of the mf framework the impacts of using different ensemble methods on model performance were considered as well section 3 5 finally the performances of each salinity forecasting model were evaluated using several statistical indices section 3 6 3 1 selection of input variables the choice of input variables is a crucial consideration for the identification of the optimal functional form of statistical models may et al 2011 in data based salinity forecasting models the first step is to determine the optimal input variables there are three types of algorithms for selecting input variables filter wrapper and embedded methods may et al 2011 we adopt filters in this study on account of their independence from and their ability to be coupled with any type of regression models quilty et al 2016 in light of previous studies river discharge is one of the most essential components to dilute estuarine salinity becker et al 2010 liu et al 2014 zhang et al 2016 whereas tide is the most direct factor to drive saltwater into estuary and increase the salinity gong and shen 2011 wang et al 2012 consequently both daily average discharge and daily lowest tide level are considered as exogenous variables for forecasting daily salinity in this work furthermore some researches have also shown that salinity time series have significant autocorrelation and that the variations of present salinity are strongly dependent on previous salinity levels lu and chen 2010 qiu and wan 2013 sun and koch 2001 therefore the previous daily average salinity is also considered as an antecedent variable for forecasting salinity in this study after preliminarily choosing the above predictors it is necessary to determine the most appropriate lead time of each predictor such that the optimal input variables can be selected for this purpose the mi and cmi methods were applied as filters the mi method describes the correlation between two variables and is derived from information theory shannon 1948 it is a type of nonparametric statistical and data driven method which can be used to identify the nonlinear dependence the mi between two variables x and y can be given in the form of the following equation bowden et al 2005a 1 m i x y f x y x y l n f x y x y f x x f y y d x d y where f x x and f y y are the marginal probability distribution functions of x and y and f x y x y is the joint probability distribution function of x and y however mi is not directly able to deal with the issue of redundancy and conditional irrelevancy during input variable selection bowden et al 2005a chen et al 2014 to overcome this problem it is worth to introduce the cmi quantifying the information between two variables that is not contained in a third one brown et al 2012 by introducing a third variable one may calculate the mi between the first two variables conditioned on the third variable to estimate the cmi the cmi using three variables can be calculated as follows quilty et al 2016 2 c m i x y z m i x y z m i x z details of calculating the cmi can be found in previous studies brown et al 2012 li et al 2015 quilty et al 2016 the main steps of selecting the optimal input variables are as follows 1 calculate the mi between the time series of current salinity and previous salinity at different lead times 1 5 days during the training period 2 determine the most appropriate lead time for previous salinity i e that with the highest mi and the corresponding input variables are selected into the set s 3 calculate the cmi between the time series of current salinity and daily discharge daily lowest tide level at different lead times 1 5 days conditioned on each variable in set s during the training period 4 determine the most appropriate lead time for daily discharge daily lowest tide level i e that with the highest cmi and the corresponding input variable is selected into the set s 5 output the set s containing the selected input variables the computation of mi and cmi can be implemented by using a kernelmi package in matlab version mikhail 2020 3 2 multiple linear regression mlr mlr is a traditional method applied for simulating linear relationships between dependent variable and multiple independent variables it can be represented by the following function adamowski et al 2012 3 y α β 1 x 1 β k x k where y is the dependent variable forecast object x 1 to x k reflect all independent variables forecast factors β 1 to β k are their corresponding regression coefficients and α is the intercept generally α and β are determined by the least squares fitting such that the summed squares of differences of estimated and observed values are minimized wang et al 2016 the mlr models for salinity forecasting were trained and tested using data in the training and testing sets this means that data in the validation set were unused for the mlr models because there was no need to determine the model structure like the ann models section 3 3 the selection of input variables for different forecast lead times is as presented in section 3 1 3 3 artificial neural network ann ann is a machine learning model inspired by biological neural systems and learns through processes analogous to those of the human brain karenina et al 2019 the advantages of anns are their parsimonious data requirements rapid execution time and ability to produce models in which the relationship between inputs and outputs is not fully understood among the variants of ann the multilayer perceptron mlp network with a feedforward back propagation bp network structure is a popular ann paradigm used today maier et al 2010 zhang et al 2015 typical mlp networks consist of an input layer one or more hidden layers and an output layer it has been proven that an ann model with only one hidden layer is sufficient for forecasting and simulating applications in water science asce 2000 thus a three layer bp network model structure was used in this work the logistic sigmoid activation function and linear activation function were selected for computing the outputs of each neuron in the hidden and output layers respectively the mean square error mse was chosen as the objective function for model training the levenberg marquardt algorithm lm was used as the training algorithm as it was found to outperform other training algorithms such as the conjugate gradient algorithm and gradient descent with momentum algorithm adamowski et al 2012 details of the lm are described by karul et al 2000 the primary requirement for developing an ann model is the selection of the most appropriate number of hidden neurons that is basically problem specific wang et al 2006 however there is no unique systematic strategy to determine this number considering the different aspects of individual problems fahimi et al 2017 generally a trial and error approach is recommended in order to obtain the best network structure for a specific issue karenina et al 2019 maier et al 2010 in this study the optimum number of hidden neurons was determined by testing several alternative values ranging from 2 to 20 and selecting the value with a corresponding ann model providing the highest forecast accuracy in the validation set after being trained in the training set 3 4 wavelet transform wt wt methods can decompose an original signal into scaled and translated versions of a specific wavelet basis presenting information of different resolution levels in both the time and frequency domains sharma et al 2016 two types of wts are generally considered the continuous wt cwt and the discrete wt dwt the cwt operates on smooth continuous functions and can detect signals on all scales nalley et al 2012 thus identifying global and localized features of the original time series sharma et al 2016 however the scale and translation coefficients of cwt are continuous resulting in long computation times due to the redundant additional data generated it may be more desirable to choose the dwt over cwt for practical application since the discretized wavelet requires less computation time and is simpler to implement in dwt decimation retaining one data point out of every two is implemented such that only half of the coefficients of the detailed components are left at the current level whereas half of the coefficients in the smooth version are recursively processed using high pass and low pass filters for coarser resolution levels rathinasamy et al 2013 in other words the number of wavelet scaling coefficients is halved with each move to the next decomposition level by decimation which means less information is available to train the forecast model at the coarser level inevitably leading to a reduction in prediction accuracy maheswaran and khosa 2013 while the property of reducing redundant information is helpful in applications such as data and image compression this type of dwt is inherently not shift invariant i e if any new value is added into the end of the time series during forecasting certain values of wavelet components will not be the same as before renaud et al 2005 and thus inapplicable for problems related to singularity detection forecasting and nonparametric regression maheswaran and khosa 2012a furthermore another major source responsible for the inappropriate usage of dwt in terms of forecasting is the so called boundary effect and the involvement of future data i e data unavailable in real world forecasts during the decomposition and reconstruction stages du et al 2017 zhang et al 2015 which have been elaborated by quilty and adamowski 2018 to overcome these problems a redundant algorithm the à trous algorithm at can be used its decomposition formulas can be defined as follows quilty and adamowski 2018 4 w j t a v j 1 t a v j t a 5 v j t a l 0 l 1 g l a v j 1 t 2 j 1 l m o d n a where v 0 t a denotes the original time series at time t w j t a and v j t a represent the j th level wavelet detail and scaling approximation coefficients at time t respectively g l a a scaling filter for at and g l a g l 2 g l a scaling filter for dwt mod the modulo operator in at decimation is avoided thus wavelet components wavelet coefficients and scaling coefficients are of the same length as in the original time series at also possesses the shift invariant property that makes it suitable for time series analysis regression and forecast applications maheswaran and khosa 2012a moreover at does not require future information to exist because it needs only the present time index or an earlier example as seen from eqs 4 and 5 the original time series can be directly obtained by additive reconstruction and it is expressed as follows quilty and adamowski 2018 6 v 0 t a j 1 j w j t a v j t a where v 0 t a represents the original time series at time t w j t a and v j t a represent the j th level wavelet detail and scaling approximation coefficients at time t respectively the problems of boundary effect due to the decomposition level and wavelet basis will introduce error into the wavelet scaling coefficients at the beginning of the time series which can be described as following equation bašta 2014 maslova et al 2016 quilty and adamowski 2018 7 l j 2 j 1 l 1 1 where l j is the number of wavelet scaling coefficients affected by the boundary effect j the decomposition level l the length of wavelet basis to avoid the boundary effect we remove the first l j wavelet scaling coefficients of the time series so that the boundary corrected wavelet components can be used to calibrate the wt based forecasting models quilty and adamowski 2018 selecting an appropriate wavelet basis is crucial to the forecast performance of a wt based model the haar wavelet a low pass filter is concentrated over the narrowest support band and therefore has good localization properties belayneh et al 2014 because the daily salinity time series have many short memory transient features and swings the haar wavelet with good time localization and compact support is effective in detecting variation within the series thus the haar wavelet has been selected herein as the wavelet basis for the wt ann models decomposition level is another key point for establishing a wt based model maheswaran and khosa 2012a revealed that the depth of decomposition must be selected after investigating the underlying dominant features in order to enable their unambiguous detection in this study the decomposition level was determined by an empirical equation nourani et al 2009a previously utilized by graf et al 2019 and seo et al 2015 8 l i n t l o g n where l and n are the optimal decomposition level and length of time series respectively l is determined to be 3 in this study since n 1107 thus each original time series is decomposed into six subseries i e d 1 d 2 d 3 a 1 a 2 and a 3 3 5 wavelet based artificial neural network wt ann there are two common forecasting frameworks existing in the current literature to couple wt and ann the df and mf frameworks nguyen and nabney 2010 corresponding to the single and within approaches of the wavelet data driven forecasting framework wddff in quilty and adamowski 2018 respectively these frameworks may result in different forecast accuracies and it is therefore essential to take both into consideration to identify which is the most appropriate for a given dataset nguyen and nabney 2010 considering the effect of both original and wavelet decomposed inputs on forecasting target variables the df and mf frameworks we employed in this study are more analogous to the single hybrid and within hybrid methods of wddff in quilty and adamowski 2018 the processes behind these two frameworks can be seen from fig 3 a and b in the df framework alizadeh and kavianpour 2015 samadianfard et al 2018 only the input variables including both antecedent and exogenous variables are decomposed into several subseries a i and d i thereafter a certain input selection method e g mi is applied to determine the optimal inputs from original and wavelet decomposed inputs for forecasting the target time series these selected inputs are fed into the model e g ann model to obtain the forecasting results after the model is trained and calibrated only one forecasting model is built in this framework in the mf framework shafaei and kisi 2016 yadav and eliza 2017 both the input variables and their target variables are decomposed into subseries a i and d i then similarly the optimal inputs are identified for forecasting each component of the target variables by using certain input selection methods e g mi unlike the df framework however each forecast component wavelet components of target variables is allocated one model e g ann model to be trained and calibrated separately after forecasting all the components of the target variables an ensemble method is applied to integrate the forecast components into the final forecast results generally the forecast components can be simply integrated by additive reconstruction eq 6 in this study we considered three types of ensemble methods the direct addition da mlr and ann ensemble methods in the da method the final forecast results are obtained by adding all the forecast components directly in the mlr ann ensemble method a an mlr ann model is trained to capture the relationships between the forecast components and the original target variables in the training set and then used for generating the forecast results in the testing set 3 6 model evaluation the performances of all developed salinity forecasting models were evaluated using four traditional statistical indices i e the nash sutcliffe efficiency nse root mean square error rmse mean absolute error mae and correlation coefficient r which can be expressed using the following equations maheswaran and khosa 2012b 9 nse 1 i 1 n o i p i 2 i 1 n o i o 2 10 rmse i 1 n o i p i 2 n 11 mae i 1 n o i p i n 12 r i 1 n o i o p i p i 1 n o i o 2 i 1 n p i p 2 where p i is the i th predicted daily salinity o i is the i th objected daily salinity o and p denote the mean observed and predicted daily salinity respectively and n is the total number of data samples evaluated the kling gupta efficiency kge based on a decomposition of nse into its constitutive components correlation variability bias and mean bias is also used for comparative evaluation of these three models knoben et al 2019 which can be expressed as follows gupta et al 2009 13 k g e 1 r 1 2 α 1 2 β 1 2 α σ sim σ obs β μ sim μ obs where r is the linear correlation between observations and simulations α a measure of the variability error β a bias term σ obs and σ sim standard deviation of observations and simulations μ obs and μ sim mean values of observations and simulations 4 results 4 1 selection of input variables in this study the three proposed models the mlr ann and wt ann models were employed to forecast the daily average salinity in the modaomen waterway prd china with forecast lead times ranging from 1 to 3 days to determine the optimal input variables for salinity forecasts we considered previous salinity daily discharge and daily lowest tide level table 2 presents the results of the mi between the current salinity and each of the aforementioned predictors at different lead times 1 5 days the mi of previous salinity is significantly greater than that of the other two predictors e g 1 332 for s t 1 0 697 for f t 1 and 0 139 for t t 1 and decreases rapidly with the extension of lead time indicating a strong autocorrelation of salinity time series generally antecedent variables play an important role in a time series model so we firstly selected the optimal input variables from the previous salinity after trial and error tests we found that using two items of previous salinity could significantly improve the forecast accuracy compared to using only one item of previous salinity and the improvements slowed down when continuing adding more previous salinity into input variable set thus we chose to use two items of previous salinity in the input variable set in order to make the set as small as possible as the problems of redundancy maybe exist due to the dependency between the antecedent and the exogenous variables the cmi of daily discharge and daily lowest tide level conditioned on previous salinity are also presented in table 2 from the table there is also a significant decrease in the cmi of both two exogenous variables with the extension of lead time in line with the selection method in section 3 1 the final selected input variables for 1 to 3 days forecast lead times are shown in table 3 4 2 results of mlr and ann models table 4 presents the performance results using the mlr and ann models for forecasting daily salinity at 1 to 3 days ahead during the training and testing periods the table shows that the forecast results of the ann models are more accurate than those of the mlr models with respect to 1 to 3 days forecast lead times in both the training and testing sets for instance when the forecast lead time is 3 days the proposed ann model has an nse of 0 592 and an r of 0 784 in the testing set which are greater than those of the mlr model an nse of 0 507 and an r of 0 726 the ann model has an rmse of 423 548 and an mae of 256 271 which are both smaller than those of the mlr model rmse of 465 565 and mae of 274 960 for the ann mlr models nse values of 0 928 0 925 and 0 772 0 733 indicate a good correlation between the observed and forecasted salinity values at 1 and 2 days forecast lead times in the testing set whereas an nse value of 0 592 0 507 exhibits a more mediocre performance at 3 days forecast lead time fig 4 provides the forecast results of the mlr and ann models for 1 to 3 days forecast lead times in the testing set indicating that the deviation between the forecasted and observed curves gradually increases with the extension of forecast lead time the ann models are slightly better than the mlr models as evidenced by the fact that their forecasted curves are a bit more similar to the observed curves the right panel of fig 4 also presents the scatter plots using the mlr and ann models during the testing period in general as the scatters approach the vicinity of the identity line denoting equality between the forecasted and observed value the performance of the model can be considered to be better it is clear that the scatters in the ann models are closer to the identity line than those of the mlr models especially in the forecast for 3 day lead time the scatter plots in fig 4 also show that when the forecast lead time is extended to 3 days several scatters with observed values lower greater than 1000 mg l are significantly above below the identity line exhibiting a trend of overestimating low values salinity under 1000 mg l and underestimating high values salinity over 1000 mg l in both the mlr and ann models 4 3 results of wt ann models the results of mi between each wavelet component of current salinity forecast object and each wavelet component of input variables forecast factors are presented in fig 5 for both the df and mf frameworks each subgraph corresponds to an input variable the horizontal wavelet components also called forecast component are from current salinity and the vertical components also called input components are from those selected input variables table 3 as presented in fig 5 some mi concerned with wavelet components are greater than those merely related to the original time series ori which means that further information has been exposed during the decomposition of the ori into several wavelet components this may indicate that the wt can increase the correlation between the input factors and output objects of the models and this also open up possibilities to the use of the wt ann models to improve the accuracy in salinity forecasting the optimal component of each input variable i e the component with the highest mi is selected for forecasting the original salinity series df framework or each forecast component mf framework as presented in fig 6 based on the selected input components of both two frameworks fig 6 the forecast results of wt ann models are further obtained tables 5 and 6 table 5 presents an evaluation of each forecasted component using the wt ann models with the mf framework these forecasted components are later integrated as the final results of forecasted salinity using certain ensemble methods e g da mlr and ann methods evaluation indices for df and mf frameworks with different ensemble methods are presented in table 6 from the nse and r in table 5 we can see that it is more accurate for models to forecast approximation coefficients a i than detail coefficients d i e g the nses for a 3 are respectively 0 995 0 968 and 0 880 with forecast lead times ranging from 1 to 3 days which are much higher than those of d i in other words the lower the signal frequency of a wavelet component the more accurately the models can forecast it this is probably because low frequency signals a i are generally influenced by long term factors making them fluctuate relatively smoothly and thus easier to forecast whereas high frequency signals d i are predominantly influenced by short term factors including noise leading to rapid and irregular variation in time series that makes their forecasting relatively difficult however the rmse and mae of a i are also greater than those of the d i in spite of the higher nse and r of a i which indicates that the energy related to the amplitude of the signals of high frequency signals is much lower than that of low frequency signals thus even when high frequency signals which are relatively hard to forecast are ultimately integrated into the final outputs using certain ensemble methods the forecast results would not be negatively affected to a large extent this makes it feasible to employ the mf framework for the wt ann models as presented in table 6 for the wt ann models with a mf framework the ann ensemble method outperformed da and mlr ensemble methods in the training set whereas the mlr ensemble method outperformed the other two methods in the testing set this suggests that the mlr method is more applicable in practice for the df framework overall the forecast results are less accurate than those of the mf framework with respect to a forecast lead time of 1 to 3 days especially in the forecast for 3 day lead time compared with table 4 the forecast results of the wt ann models with both df and mf frameworks irrespective of the ensemble method used are more accurate than single ann models according to the evaluation indices used which indicates that the wt ann models have an advantage over the ann models in forecasting estuarine salinity fig 7 presents the forecast results of the ann models and wt ann models using the mf framework and mlr ensemble method in the testing set as presented in the figure the forecast performance of the wt ann models is significantly better than that of the ann models because the forecasted curves more accurately fit the observed curves and the scatters are closer to the identity line particularly when the forecast lead time is 3 days the nse values of the wt ann models are respectively 0 938 0 806 and 0 667 corresponding to 1 2 and 3 days forecast lead times all of which are greater than the corresponding values for the ann models 0 928 0 772 and 0 592 moreover according to the scatter plots the trend of overestimating low values salinity under 1000 mg l and underestimating high values salinity over 1000 mg l is also eased when using the wt ann models 4 4 results of model evaluation fig 8 shows the taylor diagram for the mlr ann and wt ann models with different forecast lead times in testing set all the points of wt ann models d g j are closer to the observed point a compared with the mlr b e h and ann c f i models for a particular forecast lead time denoting that the forecasted results of wt ann models fit the observation better in order to allow more quantitative comparisons of the different models we also calculated the relative forecast errors re and kge of each model from the boxplots of re fig 9 a c although the median re for the wt ann models is not significantly lower than those of the mlr and ann models the width of the box and the values of the right boundaries are significantly smaller in the wt ann models than in the other two models indicating that the wt ann models provide an overall lower forecast error additionally the number of outliers of the re varies significantly among the three models in general a model with fewer outliers of forecast error is considered more credible because it has greater forecasting stability according to fig 9a c there are fewer outliers in the wt ann models than in the other two models indicating a higher forecasting stability of wt ann models the bar charts of kge fig 9d also evidence a superiority of wt ann models with the highest kge of 0 927 0 776 and 0 632 for 1 3 day lead time and it is found that the differences in the kge of these three models become increasingly prominent as the forecast lead time extends denoting that the advantages of wt ann models seem to be more significant for longer forecast lead times 5 discussion this study utilized three types of models the mlr ann and wt ann models to forecast daily salinities 1 to 3 days ahead in the modaomen waterway prd china according to the results the ann models had higher forecast accuracy than the mlr models indicating that such machine learning models are more effective than traditional statistical models in terms of daily salinity forecasting this is probably because the relationships between the different input variables and salinity time series are generally nonlinear the mlr models can only capture and reproduce linear relationships whereas the ann models have the ability to adequately represent highly nonlinear relationships among variables moreover comparisons between the results of the ann and wt ann models reveal that the use of wt to preprocess data can improve the forecast accuracy of the ann models in both the training and testing sets this is because the decomposition of the original time series into several subseries by wt allows increased potential information such as nonstationary features to be mined and captured by the models as presented in fig 5 some mi related to the subseries was greater than that merely concerned with the original series denoting that the wt process increased the correlation between the input factors and output objects of models by capturing detailed information at various wavelet resolution levels adamowski et al 2012 on the other hand the noise that is usually present in hydrological time series can affect the accuracy of forecasts in the ann models by causing problems related to overfitting but the wt ann models can alleviate such problems and enhance the generalization abilities via extracting the noise high frequency components from the original time series table 7 shows that the rates of increase in nse using the ann models compared with the mlr models are significantly lower in the testing set 0 31 3 85 and 16 74 than in the training set 1 21 8 49 and 24 17 which is likely because of the limited generalization ability of the ann models on the contrary the improvements of the wt ann models over the ann models in nse are more obvious during the testing period 1 06 4 48 and 12 63 compared with the training period 0 74 2 94 and 6 46 indicating that the wt ann models not only have an improved learning ability for nonlinear and nonstationary data but also possess stronger generalization abilities and are more robust against noise the results from the wt ann models with df and mf frameworks reveal that both wavelet based forecasting frameworks have the potential to improve forecast accuracy for the ann models highlighting the significance of preprocessing nonstationary data by wt overall the mf framework achieves better forecasts than the df framework in both the training and testing sets consistent with the works of nguyen and nabney 2010 this can be explained to some degree by the results presented in fig 5 from the right hand column this column is for the df framework of each subplot in fig 5 the values of mi for the wavelet components d 1 a 3 are not significantly greater and may even be smaller than those of the original time series ori which means that the df framework is insufficient to mine the potential information between the input and output variables on the contrary as for the mf framework the mi between the input and output variables were significantly increased after decomposing the original series into several wavelet components indicating that the mf framework can markedly enhance the correlation between the input and output variables in the models although the above explanation in terms of the mi for the forecasting framework cannot be generalized for all cases it may still provide a means to select an appropriate forecasting framework for constructing the wavelet based models without the need to put all frameworks into practice few studies have focused on the comparison between the df and mf frameworks in terms of the construction of wavelet based hybrid models for hydrological and water resources forecasting alizadeh and kavianpour 2015 and samadianfard et al 2018 used wavelet neural networks with the df framework to predict a variety of ocean water quality parameters and soil temperature respectively and both of their results revealed that the wt ann models are superior to the ann models shafaei and kisi 2016 and yadav and eliza 2017 considered only the mf framework to predict lake water fluctuation nguyen and nabney 2010 empirically compared the two frameworks of combining wt with data driven models and found that the mf framework outperformed the df framework in forecasting short term electricity demand and gas price the reason for the superiority of the mf framework however remains unexplained quilty and adamowski 2018 have compared these two frameworks in detail by exploring four different df approaches and four different mf approaches which is the most detailed study to explore different wt based forecasting approaches to date they found that the linear wt based model with the df framework considering both wavelet decomposed inputs and original inputs provided better performance than other models in their urban water demand forecasting case study for the mf framework the selection of an ensemble method also plays a significant role in forecast performance from our results we can see that the ann ensemble method surpasses the other two methods da and mlr in the training set whereas the mlr ensemble method performs the best in the testing set indicating that the mlr ensemble method is the most effective among the three methods in practice the poor performance of ann ensemble method in the testing set is likely related to the overfitting problems which may result in a high fitting ability in the training set but poor generalization ability in the testing set it is unnecessary to use such complicated nonlinear models for integrating subseries because it adds additional errors to the forecast which are not present in simple linear ensemble methods quilty and adamowski 2018 comparing the da and mlr ensemble methods the former has been employed in the majority of studies related to the mf framework nguyen and nabney 2010 shafaei and kisi 2016 yadav and eliza 2017 whereas the use of the mlr ensemble method has been relatively rare although there is theoretical support for the da ensemble method the relationship between the forecasted original series and wavelet components may not be consistent with additive reconstruction eq 6 the results in this study suggest that the mlr ensemble method achieves better forecasts in practice than the traditional da method providing another possible way for integrating forecasted wavelet components the results of these three models suggest that forecast accuracy rapidly decreases when the forecast lead time is increased from 1 to 3 days nse for the mlr models 0 925 to 0 507 nse for the ann models 0 928 to 0 592 nse for the wt ann models 0 938 to 0 667 and the superior performance of the wt ann models compared with the mlr and ann models becomes increasingly apparent table 7 this is also in accordance with the results of kasiviswanathan et al 2016 who forecasted daily streamflow using wavelet neural network since the autocorrelation of salinity time series is quite strong at short lead times table 2 the predictor of previous salinity plays a dominant role in salinity forecasting when the forecast lead time is short it is thus sufficient for traditional linear models mlr models to forecast daily salinity accurately at 1 day lead time because the relationship between the previous and current salinity is generally simple and linear accordingly there is no prominent discrepancy in the forecast performance using different models at short forecast lead times on the other hand when the lead time is extended the autocorrelation of salinity series rapidly weakens and the predictors increasingly depend on exogenous variables daily discharge and daily lowest tide level in table 2 whereas the correlation between salinity and exogenous variables is generally complex and nonlinear as found by maheswaran and khosa 2013 in their study of forecasting groundwater levels the nonlinearity and complexity in the forecasted system increased at longer lead times consequently the advantages of using the wt ann models in dealing with the problems of nonstationarity and noise in time series become apparent when increasing the forecast lead time leading to the most significant improvements over the other two models in 3 day ahead forecasting 6 conclusion in this study a hybrid model coupling wt and ann was implemented to achieve better forecasts for daily salinity in the pearl river estuary china two different forecasting frameworks and three different ensemble methods of the wt ann model were taken into consideration model performances were compared with traditional mlr and ann models the main conclusions of this study are as follows 1 the ann models outperformed the mlr models in terms of forecasting daily salinity at 1 3 day lead time owing to the fact that the ann models are more effective in modeling the nonlinear components of salinity time series during the testing period the mlr models have an nse of 0 507 0 925 and an rmse of 181 383 465 565 whereas the ann models have a greater nse of 0 592 0 928 and a lower rmse of 177 831 423 548 2 the wt ann models provided greater accuracy in salinity forecasting than the ann models indicating that decomposing the original time series by wt can improve the forecast performance of models the wt ann models combine the advantages of both ann and wt enabling them to capture the nonlinear relationships and respond to the nonstationary features in salinity time series 3 the mf framework outperformed the df framework for constructing the wt ann models in this study because the mf framework can better excavate potential information between the input and output variables moreover as in the mf framework the mlr ensemble method was more effective than the da and ann ensemble methods in practice 4 when the forecast lead time is extended from 1 to 3 days the prediction accuracy of all the models tested decreases rapidly but the superior performance of the wt ann models in comparison with the mlr and ann models becomes increasingly apparent the rates of increase in nse when using the wt ann models compared with the ann mlr models are respectively 1 06 1 37 4 48 9 97 and 12 63 31 49 corresponding to 1 2 and 3 days forecast lead times as this study has only focused on short term salinity forecasting in an estuarine region further research must be conducted to achieve higher accuracy with respect to long term salinity on time scales more relevant to support water resources management such models must incorporate the effects of climate change and atmospheric circulation in terms of their input variables additionally due to the fact that a variety of uncertainty factors such as inputs selection model structure and model parameters affect the outputs of a forecasting model it is not reliable to focus only on deterministic prediction i e to output one forecasted value at one moment future studies should attempt to employ wavelet based models in probabilistic prediction i e to output one forecasted interval at one moment that can reflect the uncertainty of a forecast quilty and adamowski 2020 quilty et al 2019 credit authorship contribution statement fanhan zhou methodology software formal analysis investigation writing original draft visualization bingjun liu conceptualization validation resources data curation writing original draft writing review editing supervision project administration funding acquisition kai duan writing review editing supervision funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this study was supported by the national natural science foundation of china grant nos 51879289 51909285 guangdong basic and applied basic research foundation 2019b1515120052 the national key research and development program of china grant nos 2017yfc0405900 we also thank enago www enago cn for the english language review 
5372,prediction of rivers and lakes water temperature plays an important role in hydrology ecology and water resources planning and management recently machines learning approaches have been widely used for modelling water temperature and the obtained results vary depending on the kind of models and the selections of the appropriates predictors in the present paper a new family of machines learning are proposed and compared to the famous air2stream model using a large data set collected at 25 lakes in the northern part of poland the proposed models were i the extremely randomized trees ert ii the multivariate adaptive regression splines mars iii the m5 model tree m5tree iv the random forest rf and v the multilayer perceptron neural network mlpnn the models were developed using the air temperature as input variables and the component of the gregorian calendar year month and day number results obtained were evaluated using several statistical indices the root mean square error rmse the mean absolute error mae correlation coefficient r and nash sutcliffe efficiency coefficient nse obtained results reveals that the air2stream model outperformed all other machines learning models and worked best with high accuracy at all the 25 lakes and none of the ert mars m5tree rf and mlpnn models was able to provides an improvement of the water temperature prediction compared to the air2stream keywords water temperature ert mars m5tree rf mlpnn 1 introduction surface water temperature lst is the most relevant and dominant factor that affects biological and chemical process of lakes and rivers ecosystems javaheri et al 2019 and significantly affect the survival of fish species jackson et al 2017a 2018 air temperature ta is strongly related to lst and mainly adopted as a relevant predictor for predicting lst whether alone or in company with other variables i e precipitation and solar radiation sr tao et al 2019 arora et al 2018 in response to the continued and steadily growing of lst the aquatic organisms are adapting to a specific range of water temperature and beyond the specific range life become impossible and the organisms and plants die and decompose javaheri et al 2019 and it was demonstrated that rising temperatures have a number of consequences for freshwater fish in freshwater ecosystems jackson et al 2016 according to toffolon et al 2013a toffolon and serafini 2013b warming help to improve the decomposition of the organic matter increases the water circulation and increases the rate of turbidity the lst has a strong influence on the formation and dynamic of ice covers in mid to high latitude lakes and rivers morales marin et al 2019 in a recently study syvitski et al 2019 selected a large number of weather variables i e wind speed relative humidity ta and sr collected over a long period of time for different climate regions and demonstrated the close relationship between highly lst variations and the ability of river to transport sediment syvitski et al 2019 the diversity and variability of the weathers variables controlling lst lead to very large thermal stratification in lakes and river and it was demonstrated that solar radiation sr is the most and important variable controlling the variability of lst for which an increase of water depth lead to a significant decrease in the light energy wang et al 2019 starting from the premise that lst is the most important factor affecting the aquatic organisms several researchers worldwide have tried to establish the relation between landscapes and river temperatures jackson et al 2017b for example o sullivan et al 2019 demonstrated that maximum watershed slope the sr comprising gravels sands and minor silt were strongly and positively correlated with lst in another study yuan et al 2020 highlighted that the warming induced by the global temperature increase has significantly accelerated the early spring green up date from year to year with the availability of large data set of measured in situ water temperature due to increasing demand from all areas of hydrology biology and ecology much effort has been devoted to improving the knowledge of the water temperature variation and its influence on aquatic organisms and the number of proposed models have exploded in number daigle et al 2019 according to morales marin et al 2019 models for water temperature can be classified into two categories i multivariable regression artificial intelligence models and thermal energy budget models and ii mechanistic models applied for large catchment scale due to the high capability of artificial intelligence models ai in building high nonlinear models they have been used increasingly for modeling river water temperature the proposed models include multilayer perceptron neural network mlpnn gaussian process regression gpr bootstrap aggregated decision trees ba dt discrete wavelet transforms wt adaptive network based fuzzy inference system anfis extreme learning machines elm radial basis function neural network rbfnn optimally pruned extreme learning opelm decision tree dt and more recently deep learning neural network dlnn piccolroaz et al 2016 compared several hybrid models namely linear regression lr seasonal linear regression slr logistic function lf stochastic model sm air2stream equilibrium temperature air2stream with differential equation and the air2water lake mode for modelling daily stream water temperature using data of 38 swiss rivers the authors reported that the family of air2stream hybrid models presented better results in comparison with statistical models graf et al 2019 employed four models for predicting daily river temperature using data collected at eight river stations in poland they compared the multilayer perceptron neural network mlpnn hybrid mlpnn coupled with discrete wavelet transforms wt mlpnn linear and nonlinear regression lr nlr from the obtained results they demonstrated the superiority of the wt mlpnn compared to the other models especially for extreme weather conditions such as heat waves and drought piotrowski et al 2014 compared the mlpnn trained using the levenberg marquardt lm algorithm and suite of artificial neural network optimized using the several nature inspired optimization methods for modelling river water temperature the authors demonstrated that the lm outperformed the major part of the nature inspired optimization methods except the differential evolution algorithms that provided relatively similar accuracy compared to the lm zhu et al 2018 compared the accuracy of the mlpnn the gaussian process regression gpr the bootstrap aggregated decision trees ba dt lr nlr and stochastic models in predicting water temperature from ta at the missouri river usa the authors reported that the three data driven models have relatively similar accuracy with negligible difference however compared to the stochastic model the data driven models worked more accurately zhu et al 2019a applied four machines learning models for modelling river water temperature namely mlpnn wt mlpnn adaptive network based fuzzy inference system anfis wt anfis and the standard multiple linear regression mlr using data collected at two station in located in the drava river croatia having lower root mean squared error rmse the two hybrid models wt mlpnn and wt anfis ranked first highlighting the importance of the wavelet transformation in improving the data driven models while the anfis and mlpnn models ranked in the second order with slightly higher rmse values and the mlr model performed worst compared to all other models in addition the authors have demonstrated the importance of using the day of the year as input variable zhu et al 2019b applied five extreme learning machines elm models having different activation functions for predicting daily river temperature based on daily ta and river discharge q model results from elm mlpnn and mlr models were compared and it was found that elm were more accurate and worked better than the other models zhu et al 2019c used three different anfis and the mlpnn models to establish a robust relation between river temperature te q and the component of the gregorian calendar cgc the year month and day numbers for four river one in croatia and three rivers in switzerland and reported that the models with the cgc were more accurate zhu and heddam 2019 proposed a new model called optimally pruned extreme learning opelm for predicting maximum daily water temperature tx based on ta q and the day of the year the results show that opelm was more suitable for tx compared to the radial basis function neural network rbfnn zhu et al 2019d demonstrated the high capability of the air2stream model in modelling tw compared to three machines learning models namely mlpnn gpr and decision tree dt and the high contribution of the day of the year in improving the models performances compared to the river q piotrowski et al 2015 compared four machines learning models namely mlpnn anfis product unit neural network punn and wavelet neural network wnn for forecasting stream water temperature up to five day in advance recently piotrowski et al 2020 proposed the deep learning neural network dlnn for modelling daily stream water temperature using data collected at six catchments located in various geographical regions usa poland and switzerland they selected ta and q as predictors for modelling water temperature in addition the authors have included the declination of the sun for every day of the year as an input variable the authors noted that the dlnn has proven to be highly robust and accurate this study adopts new family of machine learning algorithms to build models for predicting river water temperature using air temperature and to compare the obtained results to those obtained using the air2stream model we introduce the extremely randomized trees ert the multivariate adaptive regression splines mars the m5 model tree m5tree the random forest rf and the multilayer perceptron neural network mlpnn models which were compared to the air2stream model using large data set collected at 25 lakes in the northern part of poland the ert model was used in streamflow modelling and it has proved very efficient compared with the classical decision tree and artificial neural network models galelli and castelletti 2013 therefore the novelty of our work is the comparison the ert model to a suite of different machines learning models 2 materials and methods 2 1 study area and available data most lakes are distributed in the northern part of poland fig 1 due to the impact of the last glaciation that occurred approximately 12000 years ago these lakes are vital water resources for domestic water supply industry tourism etc the northern part of poland is characterized by a transitional climate in the western part marine climate dominates and it gradually transits into a continental climate towards the east this trend is clearly shown by the mean annual air temperature western part is lower by approximately 3 c compared to the eastern part in this study 25 lowland lakes in poland were studied fig 1 the characteristics of these lakes are presented in table 1 as seen these lakes have diverse morphologies with the mean water depth ranging from 1 3 m to 15 5 m and the lake area varying between 1 545 km2 and 114 88 km2 daily observed lst data are available from 1987 to 2016 for 21 lakes 30 years for the other four lakes sławskie lubie roś and wigry daily observed lst data are available from 1987 to 2014 28 years in poland lst is measured at a water depth of 0 4 m below water surface at 7 or 8 am at daily interval by the institute of meteorology and water management national research institute daily air temperature data are obtained from the nearby meteorological stations fig 1 and table 1 2 2 performance assessment of the models model performance is evaluated using three widely employed indicators for water temperature forecasting piccolroaz et al 2018 the root mean square error rmse the mean absolute error mae correlation coefficient r and nash sutcliffe efficiency coefficient nse 1 mae 1 n i 1 n l s t 0 i l s t p i 2 rmse 1 n i 1 n l s t 0 i l s t p i 2 3 nse 1 i 1 n l s t 0 i l s t p i 2 i 1 n l s t 0 i lst 0 2 n s e 1 4 r 1 n i 1 n l s t 0 i lst 0 l s t p i lst p 1 n i 1 n l s t 0 i lst 0 2 1 n i 1 n l s t p i lst p 2 in which n is the number of data lsto lstp lst 0 lst p are the measured calculated mean measured and mean calculated lake surface temperature c respectively 3 modeling approaches 3 1 air2water model the air2water model is a simple lumped model for lswt forecasting using only air temperature as input which was proposed by piccolroaz et al 2013 due to its simplicity and high accuracy it has been widely used for lst predictions over the world toffolon et al 2014 piccolroaz 2016 schmid and köster 2016 piccolroaz et al 2015 2018 the air2water model is based on the volume integrated heat balance equation through simple linearization of the heat flux terms using taylor expansion piccolroaz et al 2013 and using air temperature as a proxy for the integrated effect of the relevant processes and fluxes livingstone and padisák 2007 piccolroaz et al 2013 the equations for the six parameters version can be obtained as follows 5 d t w dt 1 δ a 1 a 2 t a a 3 t w a 5 cos 2 π t t y a 6 6 δ exp t w t a 4 t w t 1 t w t where t is time ty is the duration of the year tw is lst ta is air temperature th is a reference value for the deep lake temperature δ is a dimensionless number representing the ratio between the volume of the surface lake layer and a reference volume and a1 a6 are parameters which can be estimated through model calibration using the observed lswt data detailed descriptions of the air2water model can be found in piccolroaz et al 2013 piccolroaz et al 2016 and piotrowski and napiorkowski 2018 2019 3 2 multivariate adaptive regression splines multivariate adaptive regression splines mars was proposed by friedman 1991 as a robust and effective data driven tool for producing both linear and nonlinear models the high capability of the mars model for producing high nonlinear models between a set of predictors and predicted variables is mainly due to the structure of the mars which results from the combination of three different approaches i standard linear regression ii mathematical construction of spline and iii binary recursive partitioning miska and jan 2005 the mars model built suite of linear regression model by subdivides the all explanatory variables into several regions conoscenti et al 2015 the break values between the regions are called knots the intervals are designed as basis functions bfs conoscenti et al 2016 the knot marks the end of one region of data and the beginning of another the bfs were generated by searching in a stepwise manner and the nonlinear model is a combination of several bfs as follow zhang and goh 2013 7 y f x ψ 0 m 1 m ψ m bf m x y is the response dependent variable lake surface temperature lst c bf the basis function x is one or several predictors and ψm are the coefficients of the bf and m is the total number of the bf 3 3 m5 model tree the m5 model tree m5tree introduced by quinlan 1992 is improved algorithm of the decision tree dt singh et al 2010 since it has been proposed the m5tree has been reported as one of the effective and robust machine learning algorithms introduced during the last few decades goyal and ojha 2011 an m5tree model combines two paradigms the dt and the linear regression functions lrf at the leaves developing an m5tree model requires two stages rahimikhoob et al 2013 i creating a decision tree by splitting the data into several subsets and calculating the standard deviation reduction sdr as a splitting criterion and ii several sub trees were pruned and replaced with lrf the standard deviation reduction sdr is calculated as follow quinlan 1992 rahimikhoob et al 2013 8 sdr s d t t i t s d t i where t is the set of examples that reach the node ti denote the example of cases that have the ith outcome of the potential set sd standard deviation of the observed values more details about the m5 model tree can be found in quinlan 1992 rahimikhoob et al 2013 singh et al 2010 goyal and ojha 2011 3 4 extremely randomized tree the extremely randomized tree ert introduced by geurts et al 2006 is an improved version of the original decision tree dt models using the classical top down procedure geurts et al 2006 the ert is an ensemble of dt which was recursively trained and the final model was built using a large dt each one uses the entire data set to construct the tree and for each split the best cut point must be found based on information gain alswaina and elleithy 2018 xia et al 2015 the main innovations of the ert model are i division of the nodes is made randomly using the cut point xia et al 2015 and ii the total training dataset was used for building the dt rather than the replica generating using the bootstrap for other decision tree models for random forest model more detail about ert model can be found in xia et al 2015 galelli and castelletti 2013 according to galelli and castelletti 2013 ert model possess several advantages compared to the standalone dt models i help in avoiding the overfitting often encountered using the standalone dt and ii more computationally efficient iii is a totally randomized ensemble method iv possess more accuracy than standard decision tree model by ensemble averaging of a single model v the input and the splitting value were selected randomly the superiority and the high accuracy the ert model was demonstrated in streamflow modelling galelli and castelletti 2013 which is always a complicated hydrological process and the application of the ert for solving environmental problem such as river water temperature modelling constitutes the major motivation of our study 3 5 random forest rf the random forest rf is a machine learning model proposed by breiman 2001 and mainly inspired form the bagging methods breiman 1996 rf uses the classification and regression tree cart as an algorithm for solving a regression problem chen et al 2020 from a computational point of view rf is composed of an ensemble of selected independently and identically distributed decision tree dt each one casts a single vote for the final decision between a parent node and its child nodes and the final single prediction is calculated by aggregating an ensemble of regression trees ghorbani et al 2020 ford 2020 chutia et al 2020 the dt will be grouped together and the final model precision depends on the majority vote of the single tree li et al 2020 han et al 2020 for any single dt the best split threshold should be calculated by the so called gini impurity index ig as follow breiman 1996 2001 li et al 2020 han et al 2020 8 i g f 1 i 1 m f i 2 where fi is the probability of class i at node m therefore the final optimal split threshold corresponds to the lowest ig value 3 6 multilayer perceptron neural network mlpnn multilayer perceptron neural network mlpnn is a feedforward model structured in several layers and employed for solving several engineering problems in recent years it is shown that mlpnn exhibited better performances compared to the classical regression models especially for solving nonlinear problems the mlpnn model is structured in several layers each one contains several processing elements called neurons nodes or units typically there are three layers input hidden and output layers khishe and mosavi 2020 the input layer has a number of units equal to the number of predictors the output layer has only one neuron which corresponds to the lake surface temperature lst while the hidden layer should contains a number of units determined by trial and error method without prior knowledge the hidden neurons receive the available information in the input unit via a scalar number called a weight or connection strength and the weighted sum is then transferred to the output neuron via a sigmoid activation function akkoyun 2020 for developing a mlpnn model we need two stages training and validation during the training stage the parameters weights and biases were adopted via backpropagation algorithm by minimizing the error between the desired and calculated value for the validation phase the model generalization capability should be evaluated using a data set not used during the training phase cepowski 2020 4 results and discussion in this section we employ the rmse mae nse and r statistical indices for evaluating the performances of the air2stream m5tree ert mars rf and the mlpnn models the results of the comparison are summarized by station in tables 2 7 for further comparison between the models we also reported in table 8 a visualization of the mean minimal and maximal values of the four statistical indices obtained using the machines learning models the four statistical indices were calculated for twenty five sites described in table 1 these sites provide us with a wide range of water temperature conditions and offer a sound basis for comparison between different models two analyses were performed first the models were calibrated using 2 3 of the dataset second the models were validated using the remaining 1 3 of the data the results for the air2stream estimation are summarized in table 2 and the calculated against measured water temperature were plotted in fig 2 according to table 2 during the validation phase the maximum nse efficiency score of the air2stream models was 0 989 obtained at roś and ełckie stations and the nse declined to 0 962 in the case of the rajgrodzkie station in overall the mean nse value obtained over the all 25 stations was 0 980 the nse score show that the air2stream model captures a majority of the variability in the lake surface temperature time series based on the correlation coefficient r the maximum r value was 0 995 obtained for a least eight stations which reflect a perfect model while the minimal obtained value was found to be 0 982 in the case of rajgrodzkie station in overall the mean r value obtained over the all 25 stations was 0 991 most of the lst estimates obtained using the air2stream were of a similar magnitude the largest rmse and mae values was found for rajgrodzkie station with an estimated values of 1 527 c and 0 910 c respectively table 2 while the overall mean rmse and mae estimates across all stations were 1 031 c and 0 788 c respectively the estimated rmse and mae errors deviated considerably between the stations for all stations the mean rmse and mae values were 23 099 and 23 466 higher than the minimal values 0 793 c and 0 603 c while the mean rmse and mae values were 32 469 and 23 655 less than the maximal values 1 527 c and 1 032 c should be noted though that although the lake surface temperature estimation across all stations as regards to be very satisfactory to excellent by inspecting the models accuracy within each station it can be seen that the high obtained rmse and mae values in some stations have contributed significantly to the increase in the mean obtained values i e rajgrodzkie jamno jeziorak gardno and łebsko for which the overall efficiency was lower than those within the mean values obtained across all stations in general there is no clear justification of the models accuracy across the above reported lakes and this is due in particular to the absence of the additional information which can help to understand the thermal variation in the studied lakes however the influence of the anthropopressure and the human influence are not to be neglected as well when we benchmark the accuracy of the air2stream against mars ert m5tree rf and mlpnn models tables 3 6 it s clear that none of the proposed machines learning models was able to surpass the air2stream overall accuracy highlighted by the mean maximal and minimal values of the rmse mae r and nse using the ert models a mean r value equals to 0 982 and a mean nse value equals to 0 964 for the overall stations were observed between measured and calculated lst in addition the mean rmse and mae values were equal to 1 413 c and 1 085 c respectively however it seems that the mean rmse and mae values obtained using the ert model tends to be higher than that of the air2stream model for comparison the air2stream model decreased the mean rmse and mae value of the ert model by 27 043 and 27 368 respectively in addition the minimum and maximum limiting values obtained using the ert model were significantly higher than those obtained using the air2stream 11 581 and 22 342 for the maximum value and 34 245 and 34 811 for the minimum value respectively the mars models produced lower accuracy compared to ert models with rmse and mae values ranged between 1 298 c and 1 891 c 0 986 c and 1 437 c respectively the mean rmse and mae produced using the mars model were higher than those obtained using the ert model by 6 98 and 6 29 respectively with substantially higher mean values than the air2stream model 32 140 and 31 941 respectively furthermore we can see that on average the rmse and mae values obtained using the m5tree were 1 582 c and 1 191 c slightly higher than the values obtained using the mars model 3 96 and 2 80 the mean rmse and mae values of the m5tree are also significantly higher than those obtained using the ert model by 34 827 and 33 849 respectively in addition we can see that the mean rmse and mae values obtained using the rf models were 1 499 c and 1 150 c slightly lower than the values obtained using the m5tree model 5 47 and 3 44 however the mean rmse and mae values of the rf were slightly higher than those obtained using the ert model by 5 73 and 5 65 respectively finally results obtained using the mlpnn model was compared against those using the other models it is clear from table 8 that the results for mlpnn model were comparatively lower with mean rmse and mae of 1 726 c and 1 327 c significantly higher than those obtained using the air2water model by 40 26 and 40 61 respectively the obtained mean rmse and mae were the largest for mlpnn compared to the ert model by 18 13 and 18 24 respectively and by 11 94 and 12 74 compared to the mars model the mlpnn had at least 8 34 and 10 25 higher rmse and mae values compared to the m5tree finally the mlpnn had at least 13 15 and 13 34 higher rmse and mae respectively values compared to the rf model one has also to keep in mind that the accuracy of the mlpnn model was the lowest among all the proposed models for final models ranking it clear from table 8 that on one hand the air2water model had the lower errors indices in predicting lst compared to the all machines learning models and on the other hand we found the ert model to be more robust in predicting lst compared to the mars rf m5tree and mlpnn and the mlpnn was significantly less accurate than the other machines learning models with high errors indices rmse and mae and lower goodness of fit indices r and nse a slight difference becomes evident between ert and rf on one hand and between mars and m5tree on the other hand moreover figs 2 7 clearly show that the lst calculated using the air2stream are in better agreement with the measured values across all stations and the data were less scattered compared to the machines learning models table 9 presents the major estimated parameters of the air2water model it is clear that the air2water model need six parameters varying from one station to another table 10 presents major parameters of the machines learning models it is clear that all machines learning models need fewer parameters compared to the air2water model and when the models were compared taking into account the computational efficiency table 11 the machines learning need less time compared to the air2water model 840 s the ert model need less time 84 728 s compared to the air2water and mars models the mars model for which the training time tend to increase dramatically 969 30 s especially if the maximum number of basis functions included in the forward building phase was higher than 100 the training time reaches 20 to 30 min however although the mlpnn model possesses the poorest accuracy they only need fewer times for achieving the training process 17 729 s compared to all developed models in the present study followed by the m5tree 18 345 s and the rf 21 501 s models it is important to highlight that the increase in training time was certainly affected by the number of parameters to be optimized 5 conclusion this paper presents new family of machines learning models applied and compared for predicting lakes river temperature in poland europe the ert mars rf mlpnn and m5tree models were successfully calibrated and validated but all of them were not able to provide best accuracy compared to the air2stream model in order to improve the models accuracy we have included the component of the gregorian calendar however we have failed but it is nonetheless a step in the direction of undertaking research aimed at improving water temperature prediction but not necessarily specific to surpass the famous air2stream model by this study we therefore confirm the strong potential and accuracy of air2stream results obtained in the present investigation motivate further investigation involving other machines learning models i e hybrid methods for the estimation of water temperature and by including other predictors that can help to improving the machines learning accuracy credit authorship contribution statement salim heddam supervision conceptualization methodology project administration investigation software writing original draft writing review editing mariusz ptak conceptualization writing review editing senlin zhu software conceptualization writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper 
5372,prediction of rivers and lakes water temperature plays an important role in hydrology ecology and water resources planning and management recently machines learning approaches have been widely used for modelling water temperature and the obtained results vary depending on the kind of models and the selections of the appropriates predictors in the present paper a new family of machines learning are proposed and compared to the famous air2stream model using a large data set collected at 25 lakes in the northern part of poland the proposed models were i the extremely randomized trees ert ii the multivariate adaptive regression splines mars iii the m5 model tree m5tree iv the random forest rf and v the multilayer perceptron neural network mlpnn the models were developed using the air temperature as input variables and the component of the gregorian calendar year month and day number results obtained were evaluated using several statistical indices the root mean square error rmse the mean absolute error mae correlation coefficient r and nash sutcliffe efficiency coefficient nse obtained results reveals that the air2stream model outperformed all other machines learning models and worked best with high accuracy at all the 25 lakes and none of the ert mars m5tree rf and mlpnn models was able to provides an improvement of the water temperature prediction compared to the air2stream keywords water temperature ert mars m5tree rf mlpnn 1 introduction surface water temperature lst is the most relevant and dominant factor that affects biological and chemical process of lakes and rivers ecosystems javaheri et al 2019 and significantly affect the survival of fish species jackson et al 2017a 2018 air temperature ta is strongly related to lst and mainly adopted as a relevant predictor for predicting lst whether alone or in company with other variables i e precipitation and solar radiation sr tao et al 2019 arora et al 2018 in response to the continued and steadily growing of lst the aquatic organisms are adapting to a specific range of water temperature and beyond the specific range life become impossible and the organisms and plants die and decompose javaheri et al 2019 and it was demonstrated that rising temperatures have a number of consequences for freshwater fish in freshwater ecosystems jackson et al 2016 according to toffolon et al 2013a toffolon and serafini 2013b warming help to improve the decomposition of the organic matter increases the water circulation and increases the rate of turbidity the lst has a strong influence on the formation and dynamic of ice covers in mid to high latitude lakes and rivers morales marin et al 2019 in a recently study syvitski et al 2019 selected a large number of weather variables i e wind speed relative humidity ta and sr collected over a long period of time for different climate regions and demonstrated the close relationship between highly lst variations and the ability of river to transport sediment syvitski et al 2019 the diversity and variability of the weathers variables controlling lst lead to very large thermal stratification in lakes and river and it was demonstrated that solar radiation sr is the most and important variable controlling the variability of lst for which an increase of water depth lead to a significant decrease in the light energy wang et al 2019 starting from the premise that lst is the most important factor affecting the aquatic organisms several researchers worldwide have tried to establish the relation between landscapes and river temperatures jackson et al 2017b for example o sullivan et al 2019 demonstrated that maximum watershed slope the sr comprising gravels sands and minor silt were strongly and positively correlated with lst in another study yuan et al 2020 highlighted that the warming induced by the global temperature increase has significantly accelerated the early spring green up date from year to year with the availability of large data set of measured in situ water temperature due to increasing demand from all areas of hydrology biology and ecology much effort has been devoted to improving the knowledge of the water temperature variation and its influence on aquatic organisms and the number of proposed models have exploded in number daigle et al 2019 according to morales marin et al 2019 models for water temperature can be classified into two categories i multivariable regression artificial intelligence models and thermal energy budget models and ii mechanistic models applied for large catchment scale due to the high capability of artificial intelligence models ai in building high nonlinear models they have been used increasingly for modeling river water temperature the proposed models include multilayer perceptron neural network mlpnn gaussian process regression gpr bootstrap aggregated decision trees ba dt discrete wavelet transforms wt adaptive network based fuzzy inference system anfis extreme learning machines elm radial basis function neural network rbfnn optimally pruned extreme learning opelm decision tree dt and more recently deep learning neural network dlnn piccolroaz et al 2016 compared several hybrid models namely linear regression lr seasonal linear regression slr logistic function lf stochastic model sm air2stream equilibrium temperature air2stream with differential equation and the air2water lake mode for modelling daily stream water temperature using data of 38 swiss rivers the authors reported that the family of air2stream hybrid models presented better results in comparison with statistical models graf et al 2019 employed four models for predicting daily river temperature using data collected at eight river stations in poland they compared the multilayer perceptron neural network mlpnn hybrid mlpnn coupled with discrete wavelet transforms wt mlpnn linear and nonlinear regression lr nlr from the obtained results they demonstrated the superiority of the wt mlpnn compared to the other models especially for extreme weather conditions such as heat waves and drought piotrowski et al 2014 compared the mlpnn trained using the levenberg marquardt lm algorithm and suite of artificial neural network optimized using the several nature inspired optimization methods for modelling river water temperature the authors demonstrated that the lm outperformed the major part of the nature inspired optimization methods except the differential evolution algorithms that provided relatively similar accuracy compared to the lm zhu et al 2018 compared the accuracy of the mlpnn the gaussian process regression gpr the bootstrap aggregated decision trees ba dt lr nlr and stochastic models in predicting water temperature from ta at the missouri river usa the authors reported that the three data driven models have relatively similar accuracy with negligible difference however compared to the stochastic model the data driven models worked more accurately zhu et al 2019a applied four machines learning models for modelling river water temperature namely mlpnn wt mlpnn adaptive network based fuzzy inference system anfis wt anfis and the standard multiple linear regression mlr using data collected at two station in located in the drava river croatia having lower root mean squared error rmse the two hybrid models wt mlpnn and wt anfis ranked first highlighting the importance of the wavelet transformation in improving the data driven models while the anfis and mlpnn models ranked in the second order with slightly higher rmse values and the mlr model performed worst compared to all other models in addition the authors have demonstrated the importance of using the day of the year as input variable zhu et al 2019b applied five extreme learning machines elm models having different activation functions for predicting daily river temperature based on daily ta and river discharge q model results from elm mlpnn and mlr models were compared and it was found that elm were more accurate and worked better than the other models zhu et al 2019c used three different anfis and the mlpnn models to establish a robust relation between river temperature te q and the component of the gregorian calendar cgc the year month and day numbers for four river one in croatia and three rivers in switzerland and reported that the models with the cgc were more accurate zhu and heddam 2019 proposed a new model called optimally pruned extreme learning opelm for predicting maximum daily water temperature tx based on ta q and the day of the year the results show that opelm was more suitable for tx compared to the radial basis function neural network rbfnn zhu et al 2019d demonstrated the high capability of the air2stream model in modelling tw compared to three machines learning models namely mlpnn gpr and decision tree dt and the high contribution of the day of the year in improving the models performances compared to the river q piotrowski et al 2015 compared four machines learning models namely mlpnn anfis product unit neural network punn and wavelet neural network wnn for forecasting stream water temperature up to five day in advance recently piotrowski et al 2020 proposed the deep learning neural network dlnn for modelling daily stream water temperature using data collected at six catchments located in various geographical regions usa poland and switzerland they selected ta and q as predictors for modelling water temperature in addition the authors have included the declination of the sun for every day of the year as an input variable the authors noted that the dlnn has proven to be highly robust and accurate this study adopts new family of machine learning algorithms to build models for predicting river water temperature using air temperature and to compare the obtained results to those obtained using the air2stream model we introduce the extremely randomized trees ert the multivariate adaptive regression splines mars the m5 model tree m5tree the random forest rf and the multilayer perceptron neural network mlpnn models which were compared to the air2stream model using large data set collected at 25 lakes in the northern part of poland the ert model was used in streamflow modelling and it has proved very efficient compared with the classical decision tree and artificial neural network models galelli and castelletti 2013 therefore the novelty of our work is the comparison the ert model to a suite of different machines learning models 2 materials and methods 2 1 study area and available data most lakes are distributed in the northern part of poland fig 1 due to the impact of the last glaciation that occurred approximately 12000 years ago these lakes are vital water resources for domestic water supply industry tourism etc the northern part of poland is characterized by a transitional climate in the western part marine climate dominates and it gradually transits into a continental climate towards the east this trend is clearly shown by the mean annual air temperature western part is lower by approximately 3 c compared to the eastern part in this study 25 lowland lakes in poland were studied fig 1 the characteristics of these lakes are presented in table 1 as seen these lakes have diverse morphologies with the mean water depth ranging from 1 3 m to 15 5 m and the lake area varying between 1 545 km2 and 114 88 km2 daily observed lst data are available from 1987 to 2016 for 21 lakes 30 years for the other four lakes sławskie lubie roś and wigry daily observed lst data are available from 1987 to 2014 28 years in poland lst is measured at a water depth of 0 4 m below water surface at 7 or 8 am at daily interval by the institute of meteorology and water management national research institute daily air temperature data are obtained from the nearby meteorological stations fig 1 and table 1 2 2 performance assessment of the models model performance is evaluated using three widely employed indicators for water temperature forecasting piccolroaz et al 2018 the root mean square error rmse the mean absolute error mae correlation coefficient r and nash sutcliffe efficiency coefficient nse 1 mae 1 n i 1 n l s t 0 i l s t p i 2 rmse 1 n i 1 n l s t 0 i l s t p i 2 3 nse 1 i 1 n l s t 0 i l s t p i 2 i 1 n l s t 0 i lst 0 2 n s e 1 4 r 1 n i 1 n l s t 0 i lst 0 l s t p i lst p 1 n i 1 n l s t 0 i lst 0 2 1 n i 1 n l s t p i lst p 2 in which n is the number of data lsto lstp lst 0 lst p are the measured calculated mean measured and mean calculated lake surface temperature c respectively 3 modeling approaches 3 1 air2water model the air2water model is a simple lumped model for lswt forecasting using only air temperature as input which was proposed by piccolroaz et al 2013 due to its simplicity and high accuracy it has been widely used for lst predictions over the world toffolon et al 2014 piccolroaz 2016 schmid and köster 2016 piccolroaz et al 2015 2018 the air2water model is based on the volume integrated heat balance equation through simple linearization of the heat flux terms using taylor expansion piccolroaz et al 2013 and using air temperature as a proxy for the integrated effect of the relevant processes and fluxes livingstone and padisák 2007 piccolroaz et al 2013 the equations for the six parameters version can be obtained as follows 5 d t w dt 1 δ a 1 a 2 t a a 3 t w a 5 cos 2 π t t y a 6 6 δ exp t w t a 4 t w t 1 t w t where t is time ty is the duration of the year tw is lst ta is air temperature th is a reference value for the deep lake temperature δ is a dimensionless number representing the ratio between the volume of the surface lake layer and a reference volume and a1 a6 are parameters which can be estimated through model calibration using the observed lswt data detailed descriptions of the air2water model can be found in piccolroaz et al 2013 piccolroaz et al 2016 and piotrowski and napiorkowski 2018 2019 3 2 multivariate adaptive regression splines multivariate adaptive regression splines mars was proposed by friedman 1991 as a robust and effective data driven tool for producing both linear and nonlinear models the high capability of the mars model for producing high nonlinear models between a set of predictors and predicted variables is mainly due to the structure of the mars which results from the combination of three different approaches i standard linear regression ii mathematical construction of spline and iii binary recursive partitioning miska and jan 2005 the mars model built suite of linear regression model by subdivides the all explanatory variables into several regions conoscenti et al 2015 the break values between the regions are called knots the intervals are designed as basis functions bfs conoscenti et al 2016 the knot marks the end of one region of data and the beginning of another the bfs were generated by searching in a stepwise manner and the nonlinear model is a combination of several bfs as follow zhang and goh 2013 7 y f x ψ 0 m 1 m ψ m bf m x y is the response dependent variable lake surface temperature lst c bf the basis function x is one or several predictors and ψm are the coefficients of the bf and m is the total number of the bf 3 3 m5 model tree the m5 model tree m5tree introduced by quinlan 1992 is improved algorithm of the decision tree dt singh et al 2010 since it has been proposed the m5tree has been reported as one of the effective and robust machine learning algorithms introduced during the last few decades goyal and ojha 2011 an m5tree model combines two paradigms the dt and the linear regression functions lrf at the leaves developing an m5tree model requires two stages rahimikhoob et al 2013 i creating a decision tree by splitting the data into several subsets and calculating the standard deviation reduction sdr as a splitting criterion and ii several sub trees were pruned and replaced with lrf the standard deviation reduction sdr is calculated as follow quinlan 1992 rahimikhoob et al 2013 8 sdr s d t t i t s d t i where t is the set of examples that reach the node ti denote the example of cases that have the ith outcome of the potential set sd standard deviation of the observed values more details about the m5 model tree can be found in quinlan 1992 rahimikhoob et al 2013 singh et al 2010 goyal and ojha 2011 3 4 extremely randomized tree the extremely randomized tree ert introduced by geurts et al 2006 is an improved version of the original decision tree dt models using the classical top down procedure geurts et al 2006 the ert is an ensemble of dt which was recursively trained and the final model was built using a large dt each one uses the entire data set to construct the tree and for each split the best cut point must be found based on information gain alswaina and elleithy 2018 xia et al 2015 the main innovations of the ert model are i division of the nodes is made randomly using the cut point xia et al 2015 and ii the total training dataset was used for building the dt rather than the replica generating using the bootstrap for other decision tree models for random forest model more detail about ert model can be found in xia et al 2015 galelli and castelletti 2013 according to galelli and castelletti 2013 ert model possess several advantages compared to the standalone dt models i help in avoiding the overfitting often encountered using the standalone dt and ii more computationally efficient iii is a totally randomized ensemble method iv possess more accuracy than standard decision tree model by ensemble averaging of a single model v the input and the splitting value were selected randomly the superiority and the high accuracy the ert model was demonstrated in streamflow modelling galelli and castelletti 2013 which is always a complicated hydrological process and the application of the ert for solving environmental problem such as river water temperature modelling constitutes the major motivation of our study 3 5 random forest rf the random forest rf is a machine learning model proposed by breiman 2001 and mainly inspired form the bagging methods breiman 1996 rf uses the classification and regression tree cart as an algorithm for solving a regression problem chen et al 2020 from a computational point of view rf is composed of an ensemble of selected independently and identically distributed decision tree dt each one casts a single vote for the final decision between a parent node and its child nodes and the final single prediction is calculated by aggregating an ensemble of regression trees ghorbani et al 2020 ford 2020 chutia et al 2020 the dt will be grouped together and the final model precision depends on the majority vote of the single tree li et al 2020 han et al 2020 for any single dt the best split threshold should be calculated by the so called gini impurity index ig as follow breiman 1996 2001 li et al 2020 han et al 2020 8 i g f 1 i 1 m f i 2 where fi is the probability of class i at node m therefore the final optimal split threshold corresponds to the lowest ig value 3 6 multilayer perceptron neural network mlpnn multilayer perceptron neural network mlpnn is a feedforward model structured in several layers and employed for solving several engineering problems in recent years it is shown that mlpnn exhibited better performances compared to the classical regression models especially for solving nonlinear problems the mlpnn model is structured in several layers each one contains several processing elements called neurons nodes or units typically there are three layers input hidden and output layers khishe and mosavi 2020 the input layer has a number of units equal to the number of predictors the output layer has only one neuron which corresponds to the lake surface temperature lst while the hidden layer should contains a number of units determined by trial and error method without prior knowledge the hidden neurons receive the available information in the input unit via a scalar number called a weight or connection strength and the weighted sum is then transferred to the output neuron via a sigmoid activation function akkoyun 2020 for developing a mlpnn model we need two stages training and validation during the training stage the parameters weights and biases were adopted via backpropagation algorithm by minimizing the error between the desired and calculated value for the validation phase the model generalization capability should be evaluated using a data set not used during the training phase cepowski 2020 4 results and discussion in this section we employ the rmse mae nse and r statistical indices for evaluating the performances of the air2stream m5tree ert mars rf and the mlpnn models the results of the comparison are summarized by station in tables 2 7 for further comparison between the models we also reported in table 8 a visualization of the mean minimal and maximal values of the four statistical indices obtained using the machines learning models the four statistical indices were calculated for twenty five sites described in table 1 these sites provide us with a wide range of water temperature conditions and offer a sound basis for comparison between different models two analyses were performed first the models were calibrated using 2 3 of the dataset second the models were validated using the remaining 1 3 of the data the results for the air2stream estimation are summarized in table 2 and the calculated against measured water temperature were plotted in fig 2 according to table 2 during the validation phase the maximum nse efficiency score of the air2stream models was 0 989 obtained at roś and ełckie stations and the nse declined to 0 962 in the case of the rajgrodzkie station in overall the mean nse value obtained over the all 25 stations was 0 980 the nse score show that the air2stream model captures a majority of the variability in the lake surface temperature time series based on the correlation coefficient r the maximum r value was 0 995 obtained for a least eight stations which reflect a perfect model while the minimal obtained value was found to be 0 982 in the case of rajgrodzkie station in overall the mean r value obtained over the all 25 stations was 0 991 most of the lst estimates obtained using the air2stream were of a similar magnitude the largest rmse and mae values was found for rajgrodzkie station with an estimated values of 1 527 c and 0 910 c respectively table 2 while the overall mean rmse and mae estimates across all stations were 1 031 c and 0 788 c respectively the estimated rmse and mae errors deviated considerably between the stations for all stations the mean rmse and mae values were 23 099 and 23 466 higher than the minimal values 0 793 c and 0 603 c while the mean rmse and mae values were 32 469 and 23 655 less than the maximal values 1 527 c and 1 032 c should be noted though that although the lake surface temperature estimation across all stations as regards to be very satisfactory to excellent by inspecting the models accuracy within each station it can be seen that the high obtained rmse and mae values in some stations have contributed significantly to the increase in the mean obtained values i e rajgrodzkie jamno jeziorak gardno and łebsko for which the overall efficiency was lower than those within the mean values obtained across all stations in general there is no clear justification of the models accuracy across the above reported lakes and this is due in particular to the absence of the additional information which can help to understand the thermal variation in the studied lakes however the influence of the anthropopressure and the human influence are not to be neglected as well when we benchmark the accuracy of the air2stream against mars ert m5tree rf and mlpnn models tables 3 6 it s clear that none of the proposed machines learning models was able to surpass the air2stream overall accuracy highlighted by the mean maximal and minimal values of the rmse mae r and nse using the ert models a mean r value equals to 0 982 and a mean nse value equals to 0 964 for the overall stations were observed between measured and calculated lst in addition the mean rmse and mae values were equal to 1 413 c and 1 085 c respectively however it seems that the mean rmse and mae values obtained using the ert model tends to be higher than that of the air2stream model for comparison the air2stream model decreased the mean rmse and mae value of the ert model by 27 043 and 27 368 respectively in addition the minimum and maximum limiting values obtained using the ert model were significantly higher than those obtained using the air2stream 11 581 and 22 342 for the maximum value and 34 245 and 34 811 for the minimum value respectively the mars models produced lower accuracy compared to ert models with rmse and mae values ranged between 1 298 c and 1 891 c 0 986 c and 1 437 c respectively the mean rmse and mae produced using the mars model were higher than those obtained using the ert model by 6 98 and 6 29 respectively with substantially higher mean values than the air2stream model 32 140 and 31 941 respectively furthermore we can see that on average the rmse and mae values obtained using the m5tree were 1 582 c and 1 191 c slightly higher than the values obtained using the mars model 3 96 and 2 80 the mean rmse and mae values of the m5tree are also significantly higher than those obtained using the ert model by 34 827 and 33 849 respectively in addition we can see that the mean rmse and mae values obtained using the rf models were 1 499 c and 1 150 c slightly lower than the values obtained using the m5tree model 5 47 and 3 44 however the mean rmse and mae values of the rf were slightly higher than those obtained using the ert model by 5 73 and 5 65 respectively finally results obtained using the mlpnn model was compared against those using the other models it is clear from table 8 that the results for mlpnn model were comparatively lower with mean rmse and mae of 1 726 c and 1 327 c significantly higher than those obtained using the air2water model by 40 26 and 40 61 respectively the obtained mean rmse and mae were the largest for mlpnn compared to the ert model by 18 13 and 18 24 respectively and by 11 94 and 12 74 compared to the mars model the mlpnn had at least 8 34 and 10 25 higher rmse and mae values compared to the m5tree finally the mlpnn had at least 13 15 and 13 34 higher rmse and mae respectively values compared to the rf model one has also to keep in mind that the accuracy of the mlpnn model was the lowest among all the proposed models for final models ranking it clear from table 8 that on one hand the air2water model had the lower errors indices in predicting lst compared to the all machines learning models and on the other hand we found the ert model to be more robust in predicting lst compared to the mars rf m5tree and mlpnn and the mlpnn was significantly less accurate than the other machines learning models with high errors indices rmse and mae and lower goodness of fit indices r and nse a slight difference becomes evident between ert and rf on one hand and between mars and m5tree on the other hand moreover figs 2 7 clearly show that the lst calculated using the air2stream are in better agreement with the measured values across all stations and the data were less scattered compared to the machines learning models table 9 presents the major estimated parameters of the air2water model it is clear that the air2water model need six parameters varying from one station to another table 10 presents major parameters of the machines learning models it is clear that all machines learning models need fewer parameters compared to the air2water model and when the models were compared taking into account the computational efficiency table 11 the machines learning need less time compared to the air2water model 840 s the ert model need less time 84 728 s compared to the air2water and mars models the mars model for which the training time tend to increase dramatically 969 30 s especially if the maximum number of basis functions included in the forward building phase was higher than 100 the training time reaches 20 to 30 min however although the mlpnn model possesses the poorest accuracy they only need fewer times for achieving the training process 17 729 s compared to all developed models in the present study followed by the m5tree 18 345 s and the rf 21 501 s models it is important to highlight that the increase in training time was certainly affected by the number of parameters to be optimized 5 conclusion this paper presents new family of machines learning models applied and compared for predicting lakes river temperature in poland europe the ert mars rf mlpnn and m5tree models were successfully calibrated and validated but all of them were not able to provide best accuracy compared to the air2stream model in order to improve the models accuracy we have included the component of the gregorian calendar however we have failed but it is nonetheless a step in the direction of undertaking research aimed at improving water temperature prediction but not necessarily specific to surpass the famous air2stream model by this study we therefore confirm the strong potential and accuracy of air2stream results obtained in the present investigation motivate further investigation involving other machines learning models i e hybrid methods for the estimation of water temperature and by including other predictors that can help to improving the machines learning accuracy credit authorship contribution statement salim heddam supervision conceptualization methodology project administration investigation software writing original draft writing review editing mariusz ptak conceptualization writing review editing senlin zhu software conceptualization writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper 
5373,this study exploits aquifer responses to the reduction of pumping rates at different locations in a synthetic groundwater basin as basin scale hydraulic tomography ht surveys to estimate transmissivity t and storage coefficient s fields this experiment mimics the situation of groundwater exploitation reduction in a pilot area of groundwater overexploitation control in the north china plain the results of the study show that taking advantage of the groundwater exploitation reduction as ht surveys is a viable approach for basin scale parameter estimations results also suggest that ht analysis should use accurate mean values of t and s for geological zones as initial guesses for the inversion of parameters further we show that the t and s fields estimated from ht yield accurate predictions of the groundwater flow velocities and breakthrough curves btcs however the btcs based on kriged and zonal mean fields are inaccurate the predicted btcs using homogeneous fields fail to capture the true trend of solute concentration over time we advocate that utilizing aquifer responses induced by groundwater exploitation reduction could be a new paradigm for basin scale aquifer characterization keywords hydraulic tomography basin scale aquifer heterogeneity groundwater exploitation reduction north china plain 1 introduction identifying the spatial distribution of hydraulic property in large scale groundwater basins is crucial to the sustainable management of groundwater resources fakhreddine et al 2016 straface et al 2007 subsurface hydraulic heterogeneity dictates the behaviors of solute transport in groundwater and hence accurate identification of hydraulic properties in heterogeneous aquifers is of pivotal importance for reliable prediction of solute transport jiménez et al 2015 hydraulic properties of large scale groundwater basin over hundreds of kilometers are generally acquired by model calibrations which yield aquifer characterization with considerable uncertainty given that sources of excitations in aquifers are seldom fully characterized and only sparse temporal and spatial responses of aquifers are available kitanidis and vomvoris 1983 yeh et al 2009 due to the significant uncertainties in the estimated hydraulic properties by traditional methods the accuracy of predicting flow and solute transport in groundwater basins has been seriously questioned bredehoeft 2003 in the past few decades numerous studies have focused on identifying the fields of hydraulic conductivity and specific storage using traditional pumping tests and geophysical methods such as electrical resistivity tomography and ground penetrating radar fakhreddine et al 2016 however for groundwater basins these methods are costly and time consuming that they are impractical yeh and liu 2000 as an efficient geophysical tool the airborne electromagnetic em method has been widely used in geologic mapping groundwater exploration and environmental investigations paine and collins 2003 palacky 1993 yin et al 2016 although airborne em is cost effective guillemoteau et al 2011 its penetration depth is limited and it detects anomalies in electric resistivity rather than hydraulic properties fitterman 1990 hydraulic tomography ht is an emerging technique for imaging detailed aquifer heterogeneity hochstetler et al 2016 xiang et al 2009 yeh et al 2008 yeh and liu 2000 zha et al 2019 zhao and illman 2018 zhu and yeh 2005 which can integrate aquifer responses from numerous pumping tests the robustness of ht has been confirmed in small scale synthetic aquifers illman et al 2008 2010 illman et al 2008 laboratory sandboxes illman et al 2007 liu et al 2002 2007 zhao et al 2016 and field studies berg and illman 2011 cardiff et al 2012 doro et al 2015 fischer et al 2017 kuhlman et al 2008 zha et al 2016 more importantly the spatial patterns of hydraulic properties estimated by ht can produce better predictions of flow and solute transport than traditional aquifer imaging approaches illman et al 2012 ni et al 2009 tso et al 2016 pumping from a well to create detectable responses throughout large scale aquifers is unlikely as a result how to adequately stress the entire large scale aquifer becomes a challenge kuhlman et al 2008 proposed and demonstrated the utility of conducting multiple ht surveys in a synthetic groundwater basin yeh et al 2008 promoted exploiting natural stimuli atmospheric pressure variation lightning solid earth tides river stage etc as energy sources for basin scale hydrologic and geophysical tomographic surveys yeh et al 2009 demonstrated the feasibility of exploiting the river stage variation for basin scale aquifer characterization in a synthetic aquifer wang et al 2017 applied the river stage tomography concept to characterize the aquifer in the zhuoshui river fan in taiwan there are rooms for improvement in this emerging technology of ht in particular for imaging basin scale aquifer heterogeneity illman 2014 the cost effectiveness of ht derives from the collection of nonredundant information from a limited number of wells sun et al 2013 yeh et al 2014 new strategies that collect additional nonredundant information at the existing observation wells used by ht experiments would be the most attractive cardiff et al 2013a b tso et al 2016 for example zha et al 2019 took advantage of the change in the flow fields due to variations in pump and treat operation as a large scale ht survey to capture the low permeable zones for hydrofracking to enhance remediation effectiveness at the u s air force plant 44 tucson arizona usa analogous to natural stimuli anthropogenic perturbations can also cause a series of significant groundwater level fluctuations the north china plain ncp one of the extremely populated and water stressed areas of the world has been enduring persistent problems associated with groundwater depletion and deterioration of water quality in the past decades as a result the government has initiated the groundwater exploitation reduction program to restore the groundwater resources and to prevent further deterioration in the ncp since 2014 xu 2017 zhao et al 2017 in the ncp a large number of pumping and monitoring wells have been installed and groundwater levels have been monitored more importantly long term and high frequency records of groundwater levels have been collected for many years therefore we proposed to utilize the vast amount of existing wells and datasets to characterize the heterogeneity of aquifers in the ncp intermittent shutdown and resumption of different pumping wells in the ncp alters the large scale flow fields such changes in flow fields are equivalent to a large scale ht survey in the ncp if long term datasets of aquifer responses are available however such a long term dataset in the ncp is not available for us at this moment consequently in this study we use a synthetic two dimensional horizontal confined aquifer to demonstrate the feasibility of the proposed approach a shift of aquifer characterization strategies towards using existing wells and observation data is highly encouraged cardiff et al 2013a the main objectives of the study are to 1 explore the feasibility of utilizing aquifer responses induced by anthropogenic excitations to enhance basin scale aquifer characterization 2 evaluate the improvement of estimated transmissivity t and storage coefficient s fields using different prior means i e uniform mean kriged mean and zonal mean 3 assess the accuracy of solute transport prediction with different estimated parameter fields the results of this study may guide the future applications of this approach to the aquifer characterization in the ncp when data become available 2 methodology this study focuses on the transient flow and nonreactive solute transport problems in a horizontal two dimensional confined aquifer with spatially varying hydraulic properties the following sections brief the basic concepts and parameter estimation principles associated with the corresponding governing equations and assumptions for predicting flow and transport in groundwater 2 1 groundwater flow and transport model this study assumes that the following partial differential equation governs groundwater flow in a two dimensional depth averaged saturated heterogeneous confined aquifer 1 t x h q x p s x h t subject to the boundary and initial conditions 2 h γ 1 h 1 t x h n γ 2 q a n d h t 0 h 0 where in eq 1 h is the total head l x is the spatial coordinate x x y l q x p is the pumping rate per unit area l t at the location x p t x is the transmissivity l2 t and s x is the storativity in eq 2 h1 is the prescribed total head at dirichlet boundary γ1 q is the specified flux at neumann boundary γ2 n is a unit vector normal to γ2 and h0 represents the initial total head likewise the conservative solute transport processes along with groundwater flow in saturated porous media are presumed to be governed by the classical advection dispersion equations cade as follows 3 d x c x t v x c x t q c x t c x t t subject to boundary and initial conditions 4 c x t γ 1 c d d x c x t n γ 2 q c a n d c x t t 0 c 0 where in eq 3 c x t is the volumetric solute concentration measured in groundwater m l3 x is the spatial coordinate x x y l qc x t is the rates where the volumetric solute concentration is pumped from groundwater m l3t at the location x d x is the dispersion coefficient l2 t and v x is the flow velocity l t which is equal to the specific discharge divided by the effective porosity in eq 4 cd is the prescribed concentration at dirichlet boundary γ1 qc is the dispersive flux at neumann boundary γ2 n is a unit vector normal to γ2 and c0 is the initial concentration in this study these governing equations are solved by the code of vsaft2 variably saturated flow and transport 2 d developed by yeh et al 1993 available at http tian hwr arizona edu downloads 2 2 hydraulic tomography analysis in this study transient ht analysis was conducted using the simultaneous successive linear estimator simsle developed by xiang et al 2009 the simsle estimator is inherited from the successive linear estimator sle developed by yeh et al 1996 the robustness of the simsle algorithm is that the estimation of aquifer properties can be accomplished by simultaneously considering all observed hydraulic head changes due to various pumping events during an ht survey instead of incorporating the aquifer responses from discrete sources sequentially into the inversion process as is done in the sequential successive linear estimator ssle ni and yeh 2008 zhu and yeh 2005 the simsle estimator is briefly described below in the simsle method the aquifer properties t and s are conceptualized as highly parameterized random fields described by a prior geostatistical model mean variance and correlation scales the simsle starts with cokriging to estimate the conditional expectation of the aquifer parameters t and s conditioned on f xi and h k xj td the term f xi denotes the perturbations of either lnt or lns measured at location xi i 1 nf where nf is the total number of measured parameters another term h k xj td represents the observed head perturbation at location xj and time td during the kth pumping event the linear estimator is 5 f 1 x 0 i 1 n f λ 0 i f x i k 1 n p j 1 n h k d 1 n t k j β 0 k j d h k x j t d where f 1 x 0 is the cokriged f value at location x0 np is the total number of pumping events nh k is the total number of monitoring wells for the kth pumping event the total number of transient head measurements at location xj during the kth pumping event is denoted by nt k j meanwhile λ 0 i is the cokriging weight which represents the contribution of parameter measurement at location xi to the estimate at location x0 β 0 k j d denotes the contribution from the head perturbation h k x j t d to the estimate at location x0 these weights are calculated by solving the cokriging system of equations xiang et al 2009 the new estimate for all the elements can be generated by using cokriging and then the conditional covariance ε ff is computed as follows 6 ε ff 1 x m x n r ff x m x n i 1 n f λ mi r ff x i x n k 1 n p j 1 n h k d 1 n t k j β 0 k j d r hf k x j t d x n where m and n represent the element number rff denotes the unconditional covariance of the parameter while rhf is the cross covariance between h and f the conditional covariance can reflect the reduction of uncertainty in the parameter estimates along with the data assimilation of hydraulic head observations subsequently the estimated fields of parameters are used to generate the conditional effective head fields a stochastic linear estimator is then used to improve the estimate for iteration r 1 in which the nonlinear relationship between f and h is handled by a successive estimation scheme 7 f r 1 x 0 f r x 0 k 1 n p j 1 n h k d 1 n t k j ω 0 k j d r h k x j t d h r k x j t d where ω 0 k j d r is the weights representing the contribution of the difference between the observed head h k xj td and simulated h r k xj td at iteration r at location xj and time td during the kth pumping test to the estimation at location x0 the weighting coefficients are determined by 8 k 1 n p j 1 n h k d 1 n t k j ω 0 k j d r ε hh r p x m t e k x j t d θ r δ kjd ε hf r p x m t e x 0 where p 1 np m 1 nh and e 1 nt ε hh r is the conditional auto covariance of observed head data at iteration r and the term ε hf r is the conditional cross covariance between parameter f and head data at iteration r the covariances involved in eq 8 are calculated by the first order numerical approximation yeh and liu 2000 simsle stabilizes the solution by adding a dynamic stabilizer θ r δ kjd is the dirac delta equal to one if k j d and zero otherwise to the diagonal elements of ε hh r the diagonal elements vary with iterations reflecting the degree of improvement of the estimates thus this approach is different from that of levenberg marquardt algorithm pujol 2007 ε ff is the conditional covariance of parameter f which is constructed by a geostatistical prior model with a description of mean variance and correlation scales at r 0 after achieving the new parameter estimates using eq 7 ε ff is updated subsequently according to the following equation 9 ε ff r 1 x m x n ε ff r x m x n k 1 n p j 1 n h k d 1 n t k j ω mkjd r ε hf r k x j t d x n the iterative process among eqs 7 9 continues until one of the following two criteria is met one is that change in variances between the current estimated hydraulic properties and prior iterations is smaller than a specified tolerance while the other is that the change of simulated heads between successive iterations is smaller than the user specified head tolerance xiang et al 2009 2 3 performance metrics for ht inversion scatterplots of the true t and s values versus their estimated counterparts are used to assess the ht outcomes with various pieces of prior information moreover the criteria of the coefficient of determination r2 the mean absolute error l1 the mean square error l2 the slope and intercept are also used to evaluate the performance of ht inverse model l1 and l2 are described as the following equations 10 l 1 1 n i 1 n x i x i l 2 1 n i 1 n x i x i 2 where n is the total number of elements i is the element number x i is the true t or s value at the ith element and x i is the estimated t or s value at the ith element in general the higher r2 indicates a better result the smaller values for l1 and l2 are the better estimates the slope is an indicator of bias the closer the slope of the linear regression line to 1 and the intercept to 0 the better the estimates are 3 numerical experiments 3 1 site description the heilonggang hlg plain in the ncp is a pilot area of groundwater overexploitation control which stretches 9 57 km wide from west to east and 76 km long from south to north covering a total area of approximately 2695 km2 fig 1 the elevation in the study area ranges from 96 m above sea level m a s l in the southwest to 34 m a s l in the northeast part the overall terrain slope ranges from 0 1 to 0 2 the main landforms in the study area are alluvial proluvial plain and alluvial lacustrine plain respectively a temperate semi humid climate prevails in the study area characterized by an obvious seasonal pattern the mean annual precipitation was in the range of 500 600 mm and 70 80 of annual precipitation fell during the monsoon from june to september the average annual pan evaporation ranged from 1100 to 1800 mm wang 2011 the hlg is located in the southern section of the north china subsidence zone where the unconsolidated quaternary sediments are well developed with a maximum thickness of 560 m zhou 2008 the quaternary deposits consist of gravel sand silt and clay the aquifer system in the study area can be divided into two types phreatic aquifer and confined aquifer the unconfined and the confined aquifers are separated by an discontinuous aquitard composed of silt and clay with thickness around 10 m the phreatic aquifer is mainly composed of medium to fine grained sands with depth to the bottom of the aquifer varying from 100 to 150 m and the transmissivity of the aquifer ranges from 100 to 300 m2 d precipitation infiltration and irrigation return flow via vadose zone as well as lateral flow are the major sources of phreatic water the phreatic water mainly discharges as lateral outflow artificial exploitation and leakage given that the depth to the water table is generally large in the study area direct evaporation from the phreatic aquifer is small it is noteworthy that the saline water with total dissolved solids tds exceeding 2 g l is widespread in the phreatic aquifer fig 1 which is a potential contaminant source for groundwater quality in the underlying confined aquifer this study focuses on the confined aquifer which is the most promising water supply aquifer for agricultural domestic and industrial usages along with the groundwater exploitation reduction program the pressure head is anticipated to vary significantly the confined aquifer is mainly composed of alluvial sands and gravels during the quaternary with depth to the bottom of the aquifer varying from 350 to 500 m the hydraulic properties of the aquifer are highly variable in space generally the transmissivity changes between 10 and 480 m2 d and the storage coefficient ranges from 0 001 to 0 008 the transmissivity in the low permeable parts which is composed of silt varies from 10 to 50 m2 d and the storage coefficient is around 0 001 wang 2011 overall the confined groundwater flows predominantly from southwest to northeast fig 1 a huge groundwater cone of depression due to long term pumping has existed in the center of the study area over the past years the difference in hydraulic head between unconfined and confined aquifers has reached more than 60 m in some areas as a result leakage from the upper aquifer has become the dominant recharge source of the confined aquifer with an approximate percentage of 90 wei 2018 leakage from the overlying unconfined aquifer with high tds into the confined aquifer becomes a potential source of contamination the groundwater exploitation reduction program implemented by the government via agricultural water saving projects and water transfer from the middle route of the south to north water diversion project has reduced the total amount of groundwater pumping since 2014 this program has profound impacts on the groundwater and caused a series of changes in the aquifer system zhao et al 2017 well hydrographs at monitoring wells as shown in fig 2 provide direct evidence of the recovery of groundwater level in some regions the rebound of the water levels has taken place from one location to another during the years from 2014 to 2017 for the phreatic aquifer relative to the mean annual groundwater level in 2014 the mean annual groundwater level at the monitoring wells m2 and g2 increased 11 83 and 5 73 m respectively in 2017 fig 2a d similarly the groundwater level has also increased in the confined aquifer the average annual hydraulic heads at the observation wells q1 and q2 ascended 15 04 and 10 03 m in 2017 compared with the corresponding values in 2014 fig 2e and f meanwhile the mean annual groundwater levels at the wells f1 and f2 increased 10 28 and 6 27 m in 2017 relative to those in 2015 fig 2g and h 3 2 synthetic experiment setup the synthetic confined aquifer was designed to mimic the confined aquifer in the hlg plain the synthetic aquifer follows the shape of the aquifer in the hlg plain and has an area of 2695 km2 this aquifer is discretized into 2896 nodes that form 2720 rectangular elements the dimensions of each element are 1 km length 1 km width groundwater flows dominantly from southwest to northeast boundary fig 3 the boundary segments perpendicular to the contours of the groundwater level are no flux boundaries the remaining boundary segments a b c d e f are assigned specified head boundary condition with constant head values of 100 m a b and c d segments and 60 m e f segment respectively nonstationary random fields of true t and true s fig 4 were generated with four zones which is analogous to the geologic characteristics of the hlg basin fig 3 for each of the zones independent random fields of t and s are generated individually using a random field generator according to actual geological data different ranges of transmissivity were assigned to the zone 1 120 240 m2 d zone 2 120 m2 d zone 3 240 360 m2 d and zone 4 360 480 m2 d therefore the mean lnt m2 d values 5 1 4 38 5 4 and 5 68 were assigned to zones 1 2 3 and 4 respectively the variance of lnt for each zone is 0 1 likewise the mean lns for each zone is 5 81 6 91 5 12 and 4 89 respectively and the variance of lns is 0 1 transmissivity is assumed to be isotropic at the scale of the model elements t x t y but both the t and the s fields are assumed to be statistically anisotropic at the scale of the domain the correlation scales are 20 km in the east west direction and 5 km in the north south direction the random t and s fields are mutually exclusive after generating the random t field with these spatial statistics steady state responses of the aquifer with no pumping were simulated fig 3 and then the results of the steady state simulation were used as initial conditions for calculating transient head changes in the aquifer induced by the groundwater exploitation reduction the transient simulation stressed the aquifer simultaneously with multiple pumping wells in a manner analogous to municipal pumping systems in the hlg plain the synthetic well field is composed of 70 wells 18 pumping and 52 observation wells the well layout is the same as those in the real basin the well numbers their locations and steady state initial head distribution are shown in fig 3 we simulated three pumping reduction shutdown events which involved different wells pumping reduction shutdown periods and pumping rates as listed in table 1 the pumping rates were designed such that each pumping event stresses most of the aquifer resulting in the overlap between the stressed areas of different pumping events the pumping well locations for each event are shown in fig 3 triangles are wells pumped in pumping event 1 squares in event 2 and stars in event 3 the simulation lasts 3000 days specifically for pumping event 1 each of the six wells table 1 was pumped at 8000 m3 d for 1000 days then reduced to 4000 m3 d for 1000 days and they were shut down for the rest 1000 days for pumping event 2 six different wells table 1 were pumped at 8000 m3 d for 1000 days then temporarily shut down for 1000 days and they were pumped at a reduced rate of 4000 m3 d for the remaining 1000 days for pumping event 3 another six different wells table 1 were initially closed for 1000 days and afterward they were pumped at 8000 m3 d for 1000 days and reduced to 4000 m3 d for the rest 1000 days during each pumping test head data were collected at 52 observation wells fig 3 these events were designed in such a way to imitate the current situation of groundwater exploitation reduction in the ncp 4 results and discussion 4 1 forward simulation and aquifer response to groundwater pumping reduction the simulated groundwater drawdown fields at 1000 2000 and 3000 days due to the three events are shown in fig 5 the drawdown fields show that the changes in the operation of pumping wells due to the groundwater exploitation reduction program can stress the most areas of the entire aquifer the first time frame 0 1000 days represents the effect of normal pumping operations prior to the implementation of the groundwater exploitation reduction program at the year of 2014 clearly the spatial distribution of the drawdown field at 1000 days shows that simultaneous operation of multiple pumping wells can stimulate appreciable drawdown only in the finite regions of the entire aquifer fig 5a the program of groundwater exploitation reduction is a gradual process which is reflected in the remaining time intervals 1001 2000 days and 2001 3000 days the second time frame 1001 2000 days and the last time frame 2001 3000 days are the initial and late stage of regional groundwater pumping reduction respectively with the groundwater exploitation reduction the alteration of pumping wells modifies the basin scale flow field and the drawdown fields at 2000 and 3000 days spread throughout the region fig 5b and c indicating that the entire basin scale aquifer is stressed due to the operational variations of pumping wells at various locations the changes of groundwater levels in fifty two observation wells are shown in fig 6 over the three time intervals 0 1000 days 1001 2000 days and 2001 3000 days according to these well hydrographs wells respond differently to changes in stimulus caused by varying pumping events overall three patterns of hydraulic head fluctuations namely sharp drawdown slow drawdown and stable or rising limb are observed during the entire period fig 6 the sharp decline in water level generally occurs in the first and second time intervals when each pumping well is pumped at a normal rate of 8000 m3 d when the rate is reduced to 4000 m3 d the water level decreases slightly during the shutdown of pumping wells in different events the water level exhibits steady or notable rises the head changes in most of the monitoring wells are sensitive to the change of pumping operations suggesting a variety of patterns for all the groundwater pumping reduction intermittent shutdown and resumption events such a dissimilarity in the regional flow field suggests that these aquifer responses likely carry information about the hydraulic connections among pumping wells and observation wells wen et al 2020 therefore it is fairly obvious that changes in pumping rate can be detected in well signals and the changes in heads will be the superposition of a variety of different changes to the stresses throughout the aquifer which is tantamount to a large scale ht survey 4 2 ht inversion using different prior information 4 2 1 the role of initial guess in parameter estimations given that the estimation of t and s in a highly parameterized model is sensitive to the initial values of parameters illman et al 2008 zha et al 2019 three cases with different initial guesses uniform kriged fields and zonation were used in inverse model case 1 represents the situation in which there is little knowledge of spatial patterns of hydraulic properties at a field site as such the initial field for the inverse model is assumed to be homogeneous given the fact that the zone 1 is dominant feature in the region fig 3 the mean values of t and s for zone 1 were used as the initial guess properties case 2 aims to demonstrate the effects of considering direct measurements of t and s from pumping tests and borehole logs on characterizing the region that is the hypothetically known t and s values at locations of 52 observation wells were interpolated and extrapolated by kriging method to derive the initial t and s fields for the ht analysis fig 7 shows the kriged t and s fields which have a much more smoothed appearance than the true fields in fig 4 the kriged fields only delineate the approximate distribution of high and low permeable zones but fail to capture the details or accurate geometry of aquifer heterogeneity figs 4 and 7 case 3 assumes that the geometry and locations of the four geological zones in the reference fields are known exactly fig 3 via available geological maps and cross sections for initial guesses of the zonal hydraulic properties each zone is prescribed with a mean t or s value identical to that of the corresponding zone in the true t or s fields as a baseline the results of ht inversion using noise free observation data generated from the forward simulation cases 1a 2a and 3a were examined the estimated fields of parameters scatterplots and performance metrics of the estimates for the three cases are presented in table 2 figs 8 and 9 for case 1a the main features of the heterogeneous aquifer are identified fig 8a with a correlation coefficient r2 of 0 877 fig 9a indicating that much of the heterogeneous information on t has been extracted however the estimated s pattern fig 8d is much smoother than the true values fig 4b some localized high s zones are not identified and the shape of the low s areas is not accurately delineated fig 8d the scatterplot for lns in case 1a also exhibits a more dispersed distribution than that for lnt fig 9a and d relative to those values of metrics for lnt the performance of s estimation is worse with a lower r2 0 752 larger l2 0 127 smaller slope 0 741 in case 2a the ht inversion started with kriged t and s fields the estimated t map is similar to that of case 1a fig 8a and b with similar values of performance metrics fig 9a and b however the results of s estimates are better than those in case 1a the outlines of high s and low s zones are closer to the reference field fig 8e the index r2 increases to 0 768 and the slope value also ascends from 0 741 to 0 856 indicative of slightly better performance for s estimation in case 2a than that in case 1a in comparison with results of cases 1a and 2a the prior model with given zonal geometry case 3a yields the best results with respect to lnt the r2 and slope increase to 0 921 and 0 926 while l2 and intercept reduce to 0 018 and 0 383 respectively table 2 for lns the r2 and slope reach 0 932 and 0 931 while l2 and intercept reduce to 0 034 and 0 379 respectively table 2 case 3a yields a more accurate characterization of hydraulic heterogeneity relative to the reference fields as depicted in fig 8c and f additionally the scattered points for case 3a fig 9c and f are closely around the 1 1 line providing direct evidence for the excellent performance of the inverse model starting with zonal t and s means in summary the ht inversion using a known stratigraphic zonation model can produce more detailed information of aquifer heterogeneity however the inversion of the zonation model based on inaccurate geological information may yield worse inversion results luo et al 2017 zhao et al 2016 therefore using a hydraulic zonation model with accurate geological information as the prior information of ht analysis may be a preferred choice for the ht inversion given that it can improve the delineation of high and low t or s zones 4 2 2 effects of noisy observations the previous ht inversion was based on noise free observations however observed well hydrographs in the field likely contain noisy signals unexplained by the synthetic model apart from effects of heterogeneity such as measurement errors and other sources or sinks including precipitation evaporation lateral flow leakage etc in this study unbiased gaussian noises with a standard deviation of 0 1 m were superimposed onto the simulated hydrographs in order to mimic more realistic scenarios apart from the corruption of the observation data the other setup of the inverse models remains the same as that in the noise free analysis the estimated t and s tomograms from the cases 1b 2b and 3b using noisy signals for inverse modeling are shown in fig 10 in terms of t tomograms the spatial patterns of the main high and low permeable areas are mapped fig 10a c suggesting that the estimated t tomograms using noisy head data are still comparable to the true t fields fig 4a moreover it is noteworthy that the localized shapes of t tomograms in the case 3b are more accurately characterized in comparison to the inversion results in the cases 1b and 2b with respect to s tomograms the estimated s patterns fig 10d and e from the cases 1b and 2b are smoother than the true fields fig 4b the geometric shapes of the high and low s areas for the cases 1b and 2b are not accurately captured by comparing with the true fields fig 4b indicating loss of some heterogeneous information the s tomogram is noticeably improved in the case 3b fig 10f overall in noisy data analysis the ht inversion using an accurate zonation model can still reproduce t and s tomograms closer to the true fields to better assess the effects of noisy observations on the characterization of aquifer heterogeneity the bar charts of the main performance metrics r2 l2 and slope for all cases are plotted in fig 11 these bar charts illustrate that the estimates using noisy well hydrographs cases 1b 2b and 3b are inferior to those using noise free hydrographs cases 1a 2a and 3a although using the noisy signals in ht inversion results in the loss of some heterogeneous information the main subareas of hydraulic properties are still captured figs 10 and 11 using zonal means as prior guessed values for inversion case 3b also yields the best estimates of t and s among the cases 1b 2b and 3b in noisy data cases fig 11 thus for basin scale aquifer characterization we recommend the use of zonal means with accurate geological information as initial guesses for the inversion of parameters luo et al 2017 zhao et al 2016 4 3 predictions of solute transport with the reconstructed heterogeneity the spatial variation in transmissivity t plays a key role in the spreading of solute plumes ni et al 2009 therefore it is necessary to assess the performance of the reconstructed hydraulic parameter fields with different precision for predicting solute transport here four scenarios with different parameter fields are considered namely homogeneous zonal mean kriged fields and ht inversion results the homogeneous fields of t and s are assumed to be the mean values of t and s for zone 1 given the dominance of zone 1 in the region fig 3 for the zonal mean fields the average values of t and s are assigned to each zone of the domain which is also widely used in the groundwater models liu et al 2018 wen et al 2007 the resolution of the kriged fields is higher than that of the zonal mean fields because direct measurements of the aquifer parameters are considered additionally the t and s estimates of ht inversion in case 3a are used to predict the spreading behavior of plume which is anticipated to provide the highest resolution of the parameter fields as mentioned previously downward leakage from upper aquifer with high tds creates threats to the confined aquifer therefore the intrusion of the overlying saline water into the confined aquifer was considered to be a meaningful and realistic scenario for solute transport prediction the plume source zone was assumed to be the areas of the phreatic water with tds 2 g l namely the yellow orange and red zones in fig 1 the leakage rate was assumed to be 0 001 m d with a tds concentration of 2000 mg l for solute transport simulation all nodes were assigned an initial tds concentration of 500 mg l corresponding to the mean background concentration the boundary conditions and pumping events as well as the simulated time 3000 days remained the same as those in the case 3a for comparing the solute transport simulation results based on different parameter fields the 52 monitoring wells fig 3 were used for monitoring the concentrations of tds it should be noted that the transmissivity heterogeneity plays a much more important role in the transport behaviors of solute than the dispersivity ni et al 2009 given the insensitivity to longitudinal dispersion coefficient for large scale transport simulations sudicky et al 2010 for transport parameters the longitudinal and the transverse dispersivities were assumed to be 1000 and 100 m respectively an average porosity of 0 4 was selected for the entire domain the porosity value was assumed constant over the entire domain given that it may be less likely that depth averaged porosity varies by a factor of 2 4 within any individual grid cell at this basin scale model based on a small lnt variance of 0 1 spatial snapshots at selected time 1000 2000 and 3000 days of solute transport model show that the plume size varies over time fig 12 relative to the initial plume size with 1038 km2 the area of solute plume increases by 266 km2 at 1000 days fig 12a and 422 km2 at 2000 days fig 12b respectively lastly the contaminant plume size reaches 1540 km2 at 3000 days fig 12c given the importance of groundwater flow velocity in the solute transport prediction the actual velocity fields vx and vy were compared with simulated velocity fields using different parameter fields fig 13 clearly the parameter fields from ht inversion produce the best predicted velocity components analogous to those actual ones fig 13a and b the predicted velocity components using kriged fields fig 13c and d are inferior to those from ht estimation while they are slightly better than those using zonal mean fields fig 13e and f the simulated velocity components using homogeneous fields present the lowest accuracy fig 13g and h in comparison with other scenarios additionally the breakthrough curves btcs obtained at four monitoring sites wells 19 23 67 and 70 with various distances from source zones were selected to make a comparison of simulated results of different parameter resolutions fig 14 with respect to the true btc in the well 19 with approximate 1 km and 2 km away from the periphery of the northeast plume source and the west plume source of well 19 nonuniformities can be identified from the curve fig 14a the btc curve initially increases with a lower slope from the mean concentration suggesting that the small solute flux is likely a result of dispersion from the northeast plume source at the initial stage after about 1300 days the tds values increase at a faster rate indicating additional contribution from the plume source west of this well the superimposed effects of both two plume sources may be mainly responsible for the accelerated tds increment besides the initial arrival time is about 1200 days for the well 23 at a distance of 4 km away from the nearest point in the source zone thereafter the tds values immediately start with a steep increase of concentration from the mean background concentration 500 mg l followed by gradually reduced slopes during the period from 2000 to 3000 days and finally reach a relatively steady state with a maximum concentration of 520 mg l fig 14b the true btcs from wells 67 and 70 also follow a typical shape resulting from continuous input of solutes and vary in the arrival time and the maximum concentration fig 14c and d in this study the main concern is whether the reconstructed heterogeneity is accurate enough for predicting solute transport behaviors the simulated results confirm that the parameter fields estimated from ht inversion can yield the best prediction of btcs at these locations for most of the observation wells the btc peaks and trends can be accurately captured by using the estimated t and s values from ht inversion the btcs based on kriged fields show imprecise predictions of btcs and overestimations of peaks note that the kriged t and s fields were generated from 52 direct measurements that were assumed to be known however in most practical issues information on hydraulic parameters is generally very limited given the huge cost for conducting a large number of pumping tests in the field therefore it is an expensive way to acquire so many in situ parameters in the real world and the prediction of btcs based on the kriged fields is expected to be even lower accuracy than that shown in this study the simulated btcs based on zonal mean fields exhibit similar shapes of btcs analogous to true ones but show inaccurate peak values relative to the true peak values the peak value for btc in the well 19 is underestimated by 70 mg l while the peak for btc in the well 23 is underestimated by 10 mg l respectively the underestimations of peak values decrease with increasing monitoring distances from the plume source zone this may be attributed to velocity variation caused by the difference in aquifer parameters between zonal mean and true fields since groundwater velocity controls the advective transport of solutes kuhlman et al 2008 lastly the homogeneous model yields incorrect shapes of btcs at selected locations and these curves fail to capture the true trend of solute concentration over time which demonstrates the contribution of heterogeneous fields to improving the accuracy of the solute transport curves 5 conclusions a basin scale aquifer characterization approach based on the hydraulic tomography concept is proposed it takes advantage of readily available aquifer signals generated from operational variations of existing pumping and monitoring wells without additional cost to estimate the hydraulic heterogeneity over the whole basin specifically the basin scale flow field modified by the alternation intermittent shutdown and resumption of different pumping wells is tantamount to a basin scale ht survey because of the national policy in china such as the groundwater exploitation reduction program exploiting the groundwater data to resolve the basin scale aquifer characterization problem becomes logical and feasible in the north china plain abundant well hydrograph and pumping operations data over many years are readily available these datasets may not provide a great deal of basin scale information individually but when they are combined as a whole they can provide more information about aquifer heterogeneity than the sum of the individual parts that is aquifer responses to the change of pumping behaviors and locations of pumping are likely to carry non redundant information on the basin scale heterogeneity this study finds that the basin scale ht parameter estimation is sensitive to initial guesses for inverse models in particular compared with the ht estimates using uniform and kriged t and s fields using accurate mean values of t and s for geological zones as prior information can yield the best estimates of t and s in noise free and noisy data analysis however using the noisy signals in ht inversion results in the loss of some heterogeneous information but the inversion captures the main distributed features of hydraulic properties the estimated t and s fields from the proposed approach yield the best prediction of the groundwater flow velocities and btcs the btcs based on kriged and zonal mean fields show inaccurate peak values on the other hand the btcs derived from homogeneous fields fail to capture the true trend of solute concentration over time findings of this study suggest that the long term head data at as many locations as possible in response to varying locations and behaviors of pumping wells should be integrated as a whole for ht analysis we also recommend the use of the reasonably distributed mean properties as prior information if geologic knowledge about the heterogeneity is available lastly the results of this study support the call by yeh and lee 2008 time to change the way we collect and analyze data for aquifer characterization although the application of this concept to field problems remains to be tested the results of this study demonstrate the feasibility of using aquifer responses from operational variations of existing pumping wells to improve the characterization of basin scale subsurface heterogeneity the data fusion of head flux and chemical tracers tso et al 2016 zha et al 2016 could be a promising perspective for further enhancement of the basin scale aquifer characterization credit authorship contribution statement fei liu conceptualization formal analysis writing original draft writing review editing tian chyi jim yeh methodology writing original draft writing review editing supervision yu li wang writing original draft yonghong hao writing review editing jet chau wen writing review editing wenke wang writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this research was supported by the national natural science foundation of china grant no 41901039 the china scholarship council grant no 201808130026 the natural science foundation of hebei province grant no d2019402045 the department of education of hebei province grant no qn2018076 the authors are grateful to our colleagues and graduates for their assistance in data collection and field investigation t c jim yeh also acknowledges the partial support by the u s nsf grant ear1931756 special thanks go to the editor and the reviewers for their constructive comments 
5373,this study exploits aquifer responses to the reduction of pumping rates at different locations in a synthetic groundwater basin as basin scale hydraulic tomography ht surveys to estimate transmissivity t and storage coefficient s fields this experiment mimics the situation of groundwater exploitation reduction in a pilot area of groundwater overexploitation control in the north china plain the results of the study show that taking advantage of the groundwater exploitation reduction as ht surveys is a viable approach for basin scale parameter estimations results also suggest that ht analysis should use accurate mean values of t and s for geological zones as initial guesses for the inversion of parameters further we show that the t and s fields estimated from ht yield accurate predictions of the groundwater flow velocities and breakthrough curves btcs however the btcs based on kriged and zonal mean fields are inaccurate the predicted btcs using homogeneous fields fail to capture the true trend of solute concentration over time we advocate that utilizing aquifer responses induced by groundwater exploitation reduction could be a new paradigm for basin scale aquifer characterization keywords hydraulic tomography basin scale aquifer heterogeneity groundwater exploitation reduction north china plain 1 introduction identifying the spatial distribution of hydraulic property in large scale groundwater basins is crucial to the sustainable management of groundwater resources fakhreddine et al 2016 straface et al 2007 subsurface hydraulic heterogeneity dictates the behaviors of solute transport in groundwater and hence accurate identification of hydraulic properties in heterogeneous aquifers is of pivotal importance for reliable prediction of solute transport jiménez et al 2015 hydraulic properties of large scale groundwater basin over hundreds of kilometers are generally acquired by model calibrations which yield aquifer characterization with considerable uncertainty given that sources of excitations in aquifers are seldom fully characterized and only sparse temporal and spatial responses of aquifers are available kitanidis and vomvoris 1983 yeh et al 2009 due to the significant uncertainties in the estimated hydraulic properties by traditional methods the accuracy of predicting flow and solute transport in groundwater basins has been seriously questioned bredehoeft 2003 in the past few decades numerous studies have focused on identifying the fields of hydraulic conductivity and specific storage using traditional pumping tests and geophysical methods such as electrical resistivity tomography and ground penetrating radar fakhreddine et al 2016 however for groundwater basins these methods are costly and time consuming that they are impractical yeh and liu 2000 as an efficient geophysical tool the airborne electromagnetic em method has been widely used in geologic mapping groundwater exploration and environmental investigations paine and collins 2003 palacky 1993 yin et al 2016 although airborne em is cost effective guillemoteau et al 2011 its penetration depth is limited and it detects anomalies in electric resistivity rather than hydraulic properties fitterman 1990 hydraulic tomography ht is an emerging technique for imaging detailed aquifer heterogeneity hochstetler et al 2016 xiang et al 2009 yeh et al 2008 yeh and liu 2000 zha et al 2019 zhao and illman 2018 zhu and yeh 2005 which can integrate aquifer responses from numerous pumping tests the robustness of ht has been confirmed in small scale synthetic aquifers illman et al 2008 2010 illman et al 2008 laboratory sandboxes illman et al 2007 liu et al 2002 2007 zhao et al 2016 and field studies berg and illman 2011 cardiff et al 2012 doro et al 2015 fischer et al 2017 kuhlman et al 2008 zha et al 2016 more importantly the spatial patterns of hydraulic properties estimated by ht can produce better predictions of flow and solute transport than traditional aquifer imaging approaches illman et al 2012 ni et al 2009 tso et al 2016 pumping from a well to create detectable responses throughout large scale aquifers is unlikely as a result how to adequately stress the entire large scale aquifer becomes a challenge kuhlman et al 2008 proposed and demonstrated the utility of conducting multiple ht surveys in a synthetic groundwater basin yeh et al 2008 promoted exploiting natural stimuli atmospheric pressure variation lightning solid earth tides river stage etc as energy sources for basin scale hydrologic and geophysical tomographic surveys yeh et al 2009 demonstrated the feasibility of exploiting the river stage variation for basin scale aquifer characterization in a synthetic aquifer wang et al 2017 applied the river stage tomography concept to characterize the aquifer in the zhuoshui river fan in taiwan there are rooms for improvement in this emerging technology of ht in particular for imaging basin scale aquifer heterogeneity illman 2014 the cost effectiveness of ht derives from the collection of nonredundant information from a limited number of wells sun et al 2013 yeh et al 2014 new strategies that collect additional nonredundant information at the existing observation wells used by ht experiments would be the most attractive cardiff et al 2013a b tso et al 2016 for example zha et al 2019 took advantage of the change in the flow fields due to variations in pump and treat operation as a large scale ht survey to capture the low permeable zones for hydrofracking to enhance remediation effectiveness at the u s air force plant 44 tucson arizona usa analogous to natural stimuli anthropogenic perturbations can also cause a series of significant groundwater level fluctuations the north china plain ncp one of the extremely populated and water stressed areas of the world has been enduring persistent problems associated with groundwater depletion and deterioration of water quality in the past decades as a result the government has initiated the groundwater exploitation reduction program to restore the groundwater resources and to prevent further deterioration in the ncp since 2014 xu 2017 zhao et al 2017 in the ncp a large number of pumping and monitoring wells have been installed and groundwater levels have been monitored more importantly long term and high frequency records of groundwater levels have been collected for many years therefore we proposed to utilize the vast amount of existing wells and datasets to characterize the heterogeneity of aquifers in the ncp intermittent shutdown and resumption of different pumping wells in the ncp alters the large scale flow fields such changes in flow fields are equivalent to a large scale ht survey in the ncp if long term datasets of aquifer responses are available however such a long term dataset in the ncp is not available for us at this moment consequently in this study we use a synthetic two dimensional horizontal confined aquifer to demonstrate the feasibility of the proposed approach a shift of aquifer characterization strategies towards using existing wells and observation data is highly encouraged cardiff et al 2013a the main objectives of the study are to 1 explore the feasibility of utilizing aquifer responses induced by anthropogenic excitations to enhance basin scale aquifer characterization 2 evaluate the improvement of estimated transmissivity t and storage coefficient s fields using different prior means i e uniform mean kriged mean and zonal mean 3 assess the accuracy of solute transport prediction with different estimated parameter fields the results of this study may guide the future applications of this approach to the aquifer characterization in the ncp when data become available 2 methodology this study focuses on the transient flow and nonreactive solute transport problems in a horizontal two dimensional confined aquifer with spatially varying hydraulic properties the following sections brief the basic concepts and parameter estimation principles associated with the corresponding governing equations and assumptions for predicting flow and transport in groundwater 2 1 groundwater flow and transport model this study assumes that the following partial differential equation governs groundwater flow in a two dimensional depth averaged saturated heterogeneous confined aquifer 1 t x h q x p s x h t subject to the boundary and initial conditions 2 h γ 1 h 1 t x h n γ 2 q a n d h t 0 h 0 where in eq 1 h is the total head l x is the spatial coordinate x x y l q x p is the pumping rate per unit area l t at the location x p t x is the transmissivity l2 t and s x is the storativity in eq 2 h1 is the prescribed total head at dirichlet boundary γ1 q is the specified flux at neumann boundary γ2 n is a unit vector normal to γ2 and h0 represents the initial total head likewise the conservative solute transport processes along with groundwater flow in saturated porous media are presumed to be governed by the classical advection dispersion equations cade as follows 3 d x c x t v x c x t q c x t c x t t subject to boundary and initial conditions 4 c x t γ 1 c d d x c x t n γ 2 q c a n d c x t t 0 c 0 where in eq 3 c x t is the volumetric solute concentration measured in groundwater m l3 x is the spatial coordinate x x y l qc x t is the rates where the volumetric solute concentration is pumped from groundwater m l3t at the location x d x is the dispersion coefficient l2 t and v x is the flow velocity l t which is equal to the specific discharge divided by the effective porosity in eq 4 cd is the prescribed concentration at dirichlet boundary γ1 qc is the dispersive flux at neumann boundary γ2 n is a unit vector normal to γ2 and c0 is the initial concentration in this study these governing equations are solved by the code of vsaft2 variably saturated flow and transport 2 d developed by yeh et al 1993 available at http tian hwr arizona edu downloads 2 2 hydraulic tomography analysis in this study transient ht analysis was conducted using the simultaneous successive linear estimator simsle developed by xiang et al 2009 the simsle estimator is inherited from the successive linear estimator sle developed by yeh et al 1996 the robustness of the simsle algorithm is that the estimation of aquifer properties can be accomplished by simultaneously considering all observed hydraulic head changes due to various pumping events during an ht survey instead of incorporating the aquifer responses from discrete sources sequentially into the inversion process as is done in the sequential successive linear estimator ssle ni and yeh 2008 zhu and yeh 2005 the simsle estimator is briefly described below in the simsle method the aquifer properties t and s are conceptualized as highly parameterized random fields described by a prior geostatistical model mean variance and correlation scales the simsle starts with cokriging to estimate the conditional expectation of the aquifer parameters t and s conditioned on f xi and h k xj td the term f xi denotes the perturbations of either lnt or lns measured at location xi i 1 nf where nf is the total number of measured parameters another term h k xj td represents the observed head perturbation at location xj and time td during the kth pumping event the linear estimator is 5 f 1 x 0 i 1 n f λ 0 i f x i k 1 n p j 1 n h k d 1 n t k j β 0 k j d h k x j t d where f 1 x 0 is the cokriged f value at location x0 np is the total number of pumping events nh k is the total number of monitoring wells for the kth pumping event the total number of transient head measurements at location xj during the kth pumping event is denoted by nt k j meanwhile λ 0 i is the cokriging weight which represents the contribution of parameter measurement at location xi to the estimate at location x0 β 0 k j d denotes the contribution from the head perturbation h k x j t d to the estimate at location x0 these weights are calculated by solving the cokriging system of equations xiang et al 2009 the new estimate for all the elements can be generated by using cokriging and then the conditional covariance ε ff is computed as follows 6 ε ff 1 x m x n r ff x m x n i 1 n f λ mi r ff x i x n k 1 n p j 1 n h k d 1 n t k j β 0 k j d r hf k x j t d x n where m and n represent the element number rff denotes the unconditional covariance of the parameter while rhf is the cross covariance between h and f the conditional covariance can reflect the reduction of uncertainty in the parameter estimates along with the data assimilation of hydraulic head observations subsequently the estimated fields of parameters are used to generate the conditional effective head fields a stochastic linear estimator is then used to improve the estimate for iteration r 1 in which the nonlinear relationship between f and h is handled by a successive estimation scheme 7 f r 1 x 0 f r x 0 k 1 n p j 1 n h k d 1 n t k j ω 0 k j d r h k x j t d h r k x j t d where ω 0 k j d r is the weights representing the contribution of the difference between the observed head h k xj td and simulated h r k xj td at iteration r at location xj and time td during the kth pumping test to the estimation at location x0 the weighting coefficients are determined by 8 k 1 n p j 1 n h k d 1 n t k j ω 0 k j d r ε hh r p x m t e k x j t d θ r δ kjd ε hf r p x m t e x 0 where p 1 np m 1 nh and e 1 nt ε hh r is the conditional auto covariance of observed head data at iteration r and the term ε hf r is the conditional cross covariance between parameter f and head data at iteration r the covariances involved in eq 8 are calculated by the first order numerical approximation yeh and liu 2000 simsle stabilizes the solution by adding a dynamic stabilizer θ r δ kjd is the dirac delta equal to one if k j d and zero otherwise to the diagonal elements of ε hh r the diagonal elements vary with iterations reflecting the degree of improvement of the estimates thus this approach is different from that of levenberg marquardt algorithm pujol 2007 ε ff is the conditional covariance of parameter f which is constructed by a geostatistical prior model with a description of mean variance and correlation scales at r 0 after achieving the new parameter estimates using eq 7 ε ff is updated subsequently according to the following equation 9 ε ff r 1 x m x n ε ff r x m x n k 1 n p j 1 n h k d 1 n t k j ω mkjd r ε hf r k x j t d x n the iterative process among eqs 7 9 continues until one of the following two criteria is met one is that change in variances between the current estimated hydraulic properties and prior iterations is smaller than a specified tolerance while the other is that the change of simulated heads between successive iterations is smaller than the user specified head tolerance xiang et al 2009 2 3 performance metrics for ht inversion scatterplots of the true t and s values versus their estimated counterparts are used to assess the ht outcomes with various pieces of prior information moreover the criteria of the coefficient of determination r2 the mean absolute error l1 the mean square error l2 the slope and intercept are also used to evaluate the performance of ht inverse model l1 and l2 are described as the following equations 10 l 1 1 n i 1 n x i x i l 2 1 n i 1 n x i x i 2 where n is the total number of elements i is the element number x i is the true t or s value at the ith element and x i is the estimated t or s value at the ith element in general the higher r2 indicates a better result the smaller values for l1 and l2 are the better estimates the slope is an indicator of bias the closer the slope of the linear regression line to 1 and the intercept to 0 the better the estimates are 3 numerical experiments 3 1 site description the heilonggang hlg plain in the ncp is a pilot area of groundwater overexploitation control which stretches 9 57 km wide from west to east and 76 km long from south to north covering a total area of approximately 2695 km2 fig 1 the elevation in the study area ranges from 96 m above sea level m a s l in the southwest to 34 m a s l in the northeast part the overall terrain slope ranges from 0 1 to 0 2 the main landforms in the study area are alluvial proluvial plain and alluvial lacustrine plain respectively a temperate semi humid climate prevails in the study area characterized by an obvious seasonal pattern the mean annual precipitation was in the range of 500 600 mm and 70 80 of annual precipitation fell during the monsoon from june to september the average annual pan evaporation ranged from 1100 to 1800 mm wang 2011 the hlg is located in the southern section of the north china subsidence zone where the unconsolidated quaternary sediments are well developed with a maximum thickness of 560 m zhou 2008 the quaternary deposits consist of gravel sand silt and clay the aquifer system in the study area can be divided into two types phreatic aquifer and confined aquifer the unconfined and the confined aquifers are separated by an discontinuous aquitard composed of silt and clay with thickness around 10 m the phreatic aquifer is mainly composed of medium to fine grained sands with depth to the bottom of the aquifer varying from 100 to 150 m and the transmissivity of the aquifer ranges from 100 to 300 m2 d precipitation infiltration and irrigation return flow via vadose zone as well as lateral flow are the major sources of phreatic water the phreatic water mainly discharges as lateral outflow artificial exploitation and leakage given that the depth to the water table is generally large in the study area direct evaporation from the phreatic aquifer is small it is noteworthy that the saline water with total dissolved solids tds exceeding 2 g l is widespread in the phreatic aquifer fig 1 which is a potential contaminant source for groundwater quality in the underlying confined aquifer this study focuses on the confined aquifer which is the most promising water supply aquifer for agricultural domestic and industrial usages along with the groundwater exploitation reduction program the pressure head is anticipated to vary significantly the confined aquifer is mainly composed of alluvial sands and gravels during the quaternary with depth to the bottom of the aquifer varying from 350 to 500 m the hydraulic properties of the aquifer are highly variable in space generally the transmissivity changes between 10 and 480 m2 d and the storage coefficient ranges from 0 001 to 0 008 the transmissivity in the low permeable parts which is composed of silt varies from 10 to 50 m2 d and the storage coefficient is around 0 001 wang 2011 overall the confined groundwater flows predominantly from southwest to northeast fig 1 a huge groundwater cone of depression due to long term pumping has existed in the center of the study area over the past years the difference in hydraulic head between unconfined and confined aquifers has reached more than 60 m in some areas as a result leakage from the upper aquifer has become the dominant recharge source of the confined aquifer with an approximate percentage of 90 wei 2018 leakage from the overlying unconfined aquifer with high tds into the confined aquifer becomes a potential source of contamination the groundwater exploitation reduction program implemented by the government via agricultural water saving projects and water transfer from the middle route of the south to north water diversion project has reduced the total amount of groundwater pumping since 2014 this program has profound impacts on the groundwater and caused a series of changes in the aquifer system zhao et al 2017 well hydrographs at monitoring wells as shown in fig 2 provide direct evidence of the recovery of groundwater level in some regions the rebound of the water levels has taken place from one location to another during the years from 2014 to 2017 for the phreatic aquifer relative to the mean annual groundwater level in 2014 the mean annual groundwater level at the monitoring wells m2 and g2 increased 11 83 and 5 73 m respectively in 2017 fig 2a d similarly the groundwater level has also increased in the confined aquifer the average annual hydraulic heads at the observation wells q1 and q2 ascended 15 04 and 10 03 m in 2017 compared with the corresponding values in 2014 fig 2e and f meanwhile the mean annual groundwater levels at the wells f1 and f2 increased 10 28 and 6 27 m in 2017 relative to those in 2015 fig 2g and h 3 2 synthetic experiment setup the synthetic confined aquifer was designed to mimic the confined aquifer in the hlg plain the synthetic aquifer follows the shape of the aquifer in the hlg plain and has an area of 2695 km2 this aquifer is discretized into 2896 nodes that form 2720 rectangular elements the dimensions of each element are 1 km length 1 km width groundwater flows dominantly from southwest to northeast boundary fig 3 the boundary segments perpendicular to the contours of the groundwater level are no flux boundaries the remaining boundary segments a b c d e f are assigned specified head boundary condition with constant head values of 100 m a b and c d segments and 60 m e f segment respectively nonstationary random fields of true t and true s fig 4 were generated with four zones which is analogous to the geologic characteristics of the hlg basin fig 3 for each of the zones independent random fields of t and s are generated individually using a random field generator according to actual geological data different ranges of transmissivity were assigned to the zone 1 120 240 m2 d zone 2 120 m2 d zone 3 240 360 m2 d and zone 4 360 480 m2 d therefore the mean lnt m2 d values 5 1 4 38 5 4 and 5 68 were assigned to zones 1 2 3 and 4 respectively the variance of lnt for each zone is 0 1 likewise the mean lns for each zone is 5 81 6 91 5 12 and 4 89 respectively and the variance of lns is 0 1 transmissivity is assumed to be isotropic at the scale of the model elements t x t y but both the t and the s fields are assumed to be statistically anisotropic at the scale of the domain the correlation scales are 20 km in the east west direction and 5 km in the north south direction the random t and s fields are mutually exclusive after generating the random t field with these spatial statistics steady state responses of the aquifer with no pumping were simulated fig 3 and then the results of the steady state simulation were used as initial conditions for calculating transient head changes in the aquifer induced by the groundwater exploitation reduction the transient simulation stressed the aquifer simultaneously with multiple pumping wells in a manner analogous to municipal pumping systems in the hlg plain the synthetic well field is composed of 70 wells 18 pumping and 52 observation wells the well layout is the same as those in the real basin the well numbers their locations and steady state initial head distribution are shown in fig 3 we simulated three pumping reduction shutdown events which involved different wells pumping reduction shutdown periods and pumping rates as listed in table 1 the pumping rates were designed such that each pumping event stresses most of the aquifer resulting in the overlap between the stressed areas of different pumping events the pumping well locations for each event are shown in fig 3 triangles are wells pumped in pumping event 1 squares in event 2 and stars in event 3 the simulation lasts 3000 days specifically for pumping event 1 each of the six wells table 1 was pumped at 8000 m3 d for 1000 days then reduced to 4000 m3 d for 1000 days and they were shut down for the rest 1000 days for pumping event 2 six different wells table 1 were pumped at 8000 m3 d for 1000 days then temporarily shut down for 1000 days and they were pumped at a reduced rate of 4000 m3 d for the remaining 1000 days for pumping event 3 another six different wells table 1 were initially closed for 1000 days and afterward they were pumped at 8000 m3 d for 1000 days and reduced to 4000 m3 d for the rest 1000 days during each pumping test head data were collected at 52 observation wells fig 3 these events were designed in such a way to imitate the current situation of groundwater exploitation reduction in the ncp 4 results and discussion 4 1 forward simulation and aquifer response to groundwater pumping reduction the simulated groundwater drawdown fields at 1000 2000 and 3000 days due to the three events are shown in fig 5 the drawdown fields show that the changes in the operation of pumping wells due to the groundwater exploitation reduction program can stress the most areas of the entire aquifer the first time frame 0 1000 days represents the effect of normal pumping operations prior to the implementation of the groundwater exploitation reduction program at the year of 2014 clearly the spatial distribution of the drawdown field at 1000 days shows that simultaneous operation of multiple pumping wells can stimulate appreciable drawdown only in the finite regions of the entire aquifer fig 5a the program of groundwater exploitation reduction is a gradual process which is reflected in the remaining time intervals 1001 2000 days and 2001 3000 days the second time frame 1001 2000 days and the last time frame 2001 3000 days are the initial and late stage of regional groundwater pumping reduction respectively with the groundwater exploitation reduction the alteration of pumping wells modifies the basin scale flow field and the drawdown fields at 2000 and 3000 days spread throughout the region fig 5b and c indicating that the entire basin scale aquifer is stressed due to the operational variations of pumping wells at various locations the changes of groundwater levels in fifty two observation wells are shown in fig 6 over the three time intervals 0 1000 days 1001 2000 days and 2001 3000 days according to these well hydrographs wells respond differently to changes in stimulus caused by varying pumping events overall three patterns of hydraulic head fluctuations namely sharp drawdown slow drawdown and stable or rising limb are observed during the entire period fig 6 the sharp decline in water level generally occurs in the first and second time intervals when each pumping well is pumped at a normal rate of 8000 m3 d when the rate is reduced to 4000 m3 d the water level decreases slightly during the shutdown of pumping wells in different events the water level exhibits steady or notable rises the head changes in most of the monitoring wells are sensitive to the change of pumping operations suggesting a variety of patterns for all the groundwater pumping reduction intermittent shutdown and resumption events such a dissimilarity in the regional flow field suggests that these aquifer responses likely carry information about the hydraulic connections among pumping wells and observation wells wen et al 2020 therefore it is fairly obvious that changes in pumping rate can be detected in well signals and the changes in heads will be the superposition of a variety of different changes to the stresses throughout the aquifer which is tantamount to a large scale ht survey 4 2 ht inversion using different prior information 4 2 1 the role of initial guess in parameter estimations given that the estimation of t and s in a highly parameterized model is sensitive to the initial values of parameters illman et al 2008 zha et al 2019 three cases with different initial guesses uniform kriged fields and zonation were used in inverse model case 1 represents the situation in which there is little knowledge of spatial patterns of hydraulic properties at a field site as such the initial field for the inverse model is assumed to be homogeneous given the fact that the zone 1 is dominant feature in the region fig 3 the mean values of t and s for zone 1 were used as the initial guess properties case 2 aims to demonstrate the effects of considering direct measurements of t and s from pumping tests and borehole logs on characterizing the region that is the hypothetically known t and s values at locations of 52 observation wells were interpolated and extrapolated by kriging method to derive the initial t and s fields for the ht analysis fig 7 shows the kriged t and s fields which have a much more smoothed appearance than the true fields in fig 4 the kriged fields only delineate the approximate distribution of high and low permeable zones but fail to capture the details or accurate geometry of aquifer heterogeneity figs 4 and 7 case 3 assumes that the geometry and locations of the four geological zones in the reference fields are known exactly fig 3 via available geological maps and cross sections for initial guesses of the zonal hydraulic properties each zone is prescribed with a mean t or s value identical to that of the corresponding zone in the true t or s fields as a baseline the results of ht inversion using noise free observation data generated from the forward simulation cases 1a 2a and 3a were examined the estimated fields of parameters scatterplots and performance metrics of the estimates for the three cases are presented in table 2 figs 8 and 9 for case 1a the main features of the heterogeneous aquifer are identified fig 8a with a correlation coefficient r2 of 0 877 fig 9a indicating that much of the heterogeneous information on t has been extracted however the estimated s pattern fig 8d is much smoother than the true values fig 4b some localized high s zones are not identified and the shape of the low s areas is not accurately delineated fig 8d the scatterplot for lns in case 1a also exhibits a more dispersed distribution than that for lnt fig 9a and d relative to those values of metrics for lnt the performance of s estimation is worse with a lower r2 0 752 larger l2 0 127 smaller slope 0 741 in case 2a the ht inversion started with kriged t and s fields the estimated t map is similar to that of case 1a fig 8a and b with similar values of performance metrics fig 9a and b however the results of s estimates are better than those in case 1a the outlines of high s and low s zones are closer to the reference field fig 8e the index r2 increases to 0 768 and the slope value also ascends from 0 741 to 0 856 indicative of slightly better performance for s estimation in case 2a than that in case 1a in comparison with results of cases 1a and 2a the prior model with given zonal geometry case 3a yields the best results with respect to lnt the r2 and slope increase to 0 921 and 0 926 while l2 and intercept reduce to 0 018 and 0 383 respectively table 2 for lns the r2 and slope reach 0 932 and 0 931 while l2 and intercept reduce to 0 034 and 0 379 respectively table 2 case 3a yields a more accurate characterization of hydraulic heterogeneity relative to the reference fields as depicted in fig 8c and f additionally the scattered points for case 3a fig 9c and f are closely around the 1 1 line providing direct evidence for the excellent performance of the inverse model starting with zonal t and s means in summary the ht inversion using a known stratigraphic zonation model can produce more detailed information of aquifer heterogeneity however the inversion of the zonation model based on inaccurate geological information may yield worse inversion results luo et al 2017 zhao et al 2016 therefore using a hydraulic zonation model with accurate geological information as the prior information of ht analysis may be a preferred choice for the ht inversion given that it can improve the delineation of high and low t or s zones 4 2 2 effects of noisy observations the previous ht inversion was based on noise free observations however observed well hydrographs in the field likely contain noisy signals unexplained by the synthetic model apart from effects of heterogeneity such as measurement errors and other sources or sinks including precipitation evaporation lateral flow leakage etc in this study unbiased gaussian noises with a standard deviation of 0 1 m were superimposed onto the simulated hydrographs in order to mimic more realistic scenarios apart from the corruption of the observation data the other setup of the inverse models remains the same as that in the noise free analysis the estimated t and s tomograms from the cases 1b 2b and 3b using noisy signals for inverse modeling are shown in fig 10 in terms of t tomograms the spatial patterns of the main high and low permeable areas are mapped fig 10a c suggesting that the estimated t tomograms using noisy head data are still comparable to the true t fields fig 4a moreover it is noteworthy that the localized shapes of t tomograms in the case 3b are more accurately characterized in comparison to the inversion results in the cases 1b and 2b with respect to s tomograms the estimated s patterns fig 10d and e from the cases 1b and 2b are smoother than the true fields fig 4b the geometric shapes of the high and low s areas for the cases 1b and 2b are not accurately captured by comparing with the true fields fig 4b indicating loss of some heterogeneous information the s tomogram is noticeably improved in the case 3b fig 10f overall in noisy data analysis the ht inversion using an accurate zonation model can still reproduce t and s tomograms closer to the true fields to better assess the effects of noisy observations on the characterization of aquifer heterogeneity the bar charts of the main performance metrics r2 l2 and slope for all cases are plotted in fig 11 these bar charts illustrate that the estimates using noisy well hydrographs cases 1b 2b and 3b are inferior to those using noise free hydrographs cases 1a 2a and 3a although using the noisy signals in ht inversion results in the loss of some heterogeneous information the main subareas of hydraulic properties are still captured figs 10 and 11 using zonal means as prior guessed values for inversion case 3b also yields the best estimates of t and s among the cases 1b 2b and 3b in noisy data cases fig 11 thus for basin scale aquifer characterization we recommend the use of zonal means with accurate geological information as initial guesses for the inversion of parameters luo et al 2017 zhao et al 2016 4 3 predictions of solute transport with the reconstructed heterogeneity the spatial variation in transmissivity t plays a key role in the spreading of solute plumes ni et al 2009 therefore it is necessary to assess the performance of the reconstructed hydraulic parameter fields with different precision for predicting solute transport here four scenarios with different parameter fields are considered namely homogeneous zonal mean kriged fields and ht inversion results the homogeneous fields of t and s are assumed to be the mean values of t and s for zone 1 given the dominance of zone 1 in the region fig 3 for the zonal mean fields the average values of t and s are assigned to each zone of the domain which is also widely used in the groundwater models liu et al 2018 wen et al 2007 the resolution of the kriged fields is higher than that of the zonal mean fields because direct measurements of the aquifer parameters are considered additionally the t and s estimates of ht inversion in case 3a are used to predict the spreading behavior of plume which is anticipated to provide the highest resolution of the parameter fields as mentioned previously downward leakage from upper aquifer with high tds creates threats to the confined aquifer therefore the intrusion of the overlying saline water into the confined aquifer was considered to be a meaningful and realistic scenario for solute transport prediction the plume source zone was assumed to be the areas of the phreatic water with tds 2 g l namely the yellow orange and red zones in fig 1 the leakage rate was assumed to be 0 001 m d with a tds concentration of 2000 mg l for solute transport simulation all nodes were assigned an initial tds concentration of 500 mg l corresponding to the mean background concentration the boundary conditions and pumping events as well as the simulated time 3000 days remained the same as those in the case 3a for comparing the solute transport simulation results based on different parameter fields the 52 monitoring wells fig 3 were used for monitoring the concentrations of tds it should be noted that the transmissivity heterogeneity plays a much more important role in the transport behaviors of solute than the dispersivity ni et al 2009 given the insensitivity to longitudinal dispersion coefficient for large scale transport simulations sudicky et al 2010 for transport parameters the longitudinal and the transverse dispersivities were assumed to be 1000 and 100 m respectively an average porosity of 0 4 was selected for the entire domain the porosity value was assumed constant over the entire domain given that it may be less likely that depth averaged porosity varies by a factor of 2 4 within any individual grid cell at this basin scale model based on a small lnt variance of 0 1 spatial snapshots at selected time 1000 2000 and 3000 days of solute transport model show that the plume size varies over time fig 12 relative to the initial plume size with 1038 km2 the area of solute plume increases by 266 km2 at 1000 days fig 12a and 422 km2 at 2000 days fig 12b respectively lastly the contaminant plume size reaches 1540 km2 at 3000 days fig 12c given the importance of groundwater flow velocity in the solute transport prediction the actual velocity fields vx and vy were compared with simulated velocity fields using different parameter fields fig 13 clearly the parameter fields from ht inversion produce the best predicted velocity components analogous to those actual ones fig 13a and b the predicted velocity components using kriged fields fig 13c and d are inferior to those from ht estimation while they are slightly better than those using zonal mean fields fig 13e and f the simulated velocity components using homogeneous fields present the lowest accuracy fig 13g and h in comparison with other scenarios additionally the breakthrough curves btcs obtained at four monitoring sites wells 19 23 67 and 70 with various distances from source zones were selected to make a comparison of simulated results of different parameter resolutions fig 14 with respect to the true btc in the well 19 with approximate 1 km and 2 km away from the periphery of the northeast plume source and the west plume source of well 19 nonuniformities can be identified from the curve fig 14a the btc curve initially increases with a lower slope from the mean concentration suggesting that the small solute flux is likely a result of dispersion from the northeast plume source at the initial stage after about 1300 days the tds values increase at a faster rate indicating additional contribution from the plume source west of this well the superimposed effects of both two plume sources may be mainly responsible for the accelerated tds increment besides the initial arrival time is about 1200 days for the well 23 at a distance of 4 km away from the nearest point in the source zone thereafter the tds values immediately start with a steep increase of concentration from the mean background concentration 500 mg l followed by gradually reduced slopes during the period from 2000 to 3000 days and finally reach a relatively steady state with a maximum concentration of 520 mg l fig 14b the true btcs from wells 67 and 70 also follow a typical shape resulting from continuous input of solutes and vary in the arrival time and the maximum concentration fig 14c and d in this study the main concern is whether the reconstructed heterogeneity is accurate enough for predicting solute transport behaviors the simulated results confirm that the parameter fields estimated from ht inversion can yield the best prediction of btcs at these locations for most of the observation wells the btc peaks and trends can be accurately captured by using the estimated t and s values from ht inversion the btcs based on kriged fields show imprecise predictions of btcs and overestimations of peaks note that the kriged t and s fields were generated from 52 direct measurements that were assumed to be known however in most practical issues information on hydraulic parameters is generally very limited given the huge cost for conducting a large number of pumping tests in the field therefore it is an expensive way to acquire so many in situ parameters in the real world and the prediction of btcs based on the kriged fields is expected to be even lower accuracy than that shown in this study the simulated btcs based on zonal mean fields exhibit similar shapes of btcs analogous to true ones but show inaccurate peak values relative to the true peak values the peak value for btc in the well 19 is underestimated by 70 mg l while the peak for btc in the well 23 is underestimated by 10 mg l respectively the underestimations of peak values decrease with increasing monitoring distances from the plume source zone this may be attributed to velocity variation caused by the difference in aquifer parameters between zonal mean and true fields since groundwater velocity controls the advective transport of solutes kuhlman et al 2008 lastly the homogeneous model yields incorrect shapes of btcs at selected locations and these curves fail to capture the true trend of solute concentration over time which demonstrates the contribution of heterogeneous fields to improving the accuracy of the solute transport curves 5 conclusions a basin scale aquifer characterization approach based on the hydraulic tomography concept is proposed it takes advantage of readily available aquifer signals generated from operational variations of existing pumping and monitoring wells without additional cost to estimate the hydraulic heterogeneity over the whole basin specifically the basin scale flow field modified by the alternation intermittent shutdown and resumption of different pumping wells is tantamount to a basin scale ht survey because of the national policy in china such as the groundwater exploitation reduction program exploiting the groundwater data to resolve the basin scale aquifer characterization problem becomes logical and feasible in the north china plain abundant well hydrograph and pumping operations data over many years are readily available these datasets may not provide a great deal of basin scale information individually but when they are combined as a whole they can provide more information about aquifer heterogeneity than the sum of the individual parts that is aquifer responses to the change of pumping behaviors and locations of pumping are likely to carry non redundant information on the basin scale heterogeneity this study finds that the basin scale ht parameter estimation is sensitive to initial guesses for inverse models in particular compared with the ht estimates using uniform and kriged t and s fields using accurate mean values of t and s for geological zones as prior information can yield the best estimates of t and s in noise free and noisy data analysis however using the noisy signals in ht inversion results in the loss of some heterogeneous information but the inversion captures the main distributed features of hydraulic properties the estimated t and s fields from the proposed approach yield the best prediction of the groundwater flow velocities and btcs the btcs based on kriged and zonal mean fields show inaccurate peak values on the other hand the btcs derived from homogeneous fields fail to capture the true trend of solute concentration over time findings of this study suggest that the long term head data at as many locations as possible in response to varying locations and behaviors of pumping wells should be integrated as a whole for ht analysis we also recommend the use of the reasonably distributed mean properties as prior information if geologic knowledge about the heterogeneity is available lastly the results of this study support the call by yeh and lee 2008 time to change the way we collect and analyze data for aquifer characterization although the application of this concept to field problems remains to be tested the results of this study demonstrate the feasibility of using aquifer responses from operational variations of existing pumping wells to improve the characterization of basin scale subsurface heterogeneity the data fusion of head flux and chemical tracers tso et al 2016 zha et al 2016 could be a promising perspective for further enhancement of the basin scale aquifer characterization credit authorship contribution statement fei liu conceptualization formal analysis writing original draft writing review editing tian chyi jim yeh methodology writing original draft writing review editing supervision yu li wang writing original draft yonghong hao writing review editing jet chau wen writing review editing wenke wang writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this research was supported by the national natural science foundation of china grant no 41901039 the china scholarship council grant no 201808130026 the natural science foundation of hebei province grant no d2019402045 the department of education of hebei province grant no qn2018076 the authors are grateful to our colleagues and graduates for their assistance in data collection and field investigation t c jim yeh also acknowledges the partial support by the u s nsf grant ear1931756 special thanks go to the editor and the reviewers for their constructive comments 
5374,low impact development lid facilities have ability to increase evapotranspiration et and thus moderate the hydrological cycle and mitigate urban heat island uhi effects however it is difficult to measure et of lid facilities by traditional methods e g weighing lysimeter bowen ratio system and eddy covariance system in urban environment a recently developed method called three temperature model 3t model has been used to measure actual et of natural underlying surfaces in situ however its applicability in et measurement for lid facilities has not been investigated in order to investigate the accuracy of this method to estimate et of lid facilities and its influencing factors the experimental devices for vegetated lid green roof with zoysia tenuifoli grz and green roof with callisia repens grc and non vegetated lid permeable concrete pavement pcp and permeable brick pavement pbp were installed the method was validated by comparing the et measured by 3t model with that measured by weighing platform hourly data n 223 302 for each facility after validation the method was used to measure et variations of typical lid facilities under moist sub tropical weather condition in shenzhen china the results indicate the coefficient of determination r2 between et measured by 3t model and weighing platform is 0 63 0 60 0 70 and 0 65 for grz grc pcp and pbp respectively and the slopes of regression equations are close to 1 and their intercepts are close to 0 furthermore the 3t model has higher absolute relative error are of et estimation in the early morning and the late afternoon than that in the rest of daytime this is mainly due to the effect of energy related factors such as solar radiation air temperature and the difference between reference surface temperature and air temperature in addition et rates of lid facilities can maintain at a relatively high level in the first few days after rainfall however et of pcp decreases faster than that of other lid facilities during the drying period these results demonstrate the ability and accuracy of 3t model to measure variations of et of lid facilities in situ keywords evapotranspiration low impact development three temperature model weighing platform permeable pavement green roof 1 introduction low impact development lid facilities which include green roofs permeable pavements bioretentions and vegetated swales et al have been widely used in urban stormwater management valinski and chandler 2015 vogel and moore 2016 yang et al 2013 the facilities have multiple benefits to urban environments such as runoff volume reduction runoff quality improvement groundwater recharge increase in evapotranspiration et and so on askarizadeh et al 2015 elliott et al 2016 feng et al 2016 payne et al 2014 among these benefits increase in et is very important since it can not only promote a benign hydrological cycle in urban areas but also mitigate the urban heat island effects askarizadeh et al 2015 blanusa et al 2013 li et al 2014 due to the need to comprehensively evaluate the benefits of lid et measurement of lid facilities has been widely concerned cascone et al 2019 in previous studies actual et of lid facilities was measured by weighing platform lysimeter or eddy covariance system weighing platform can be used to measure et of lid facilities based on the change of their weight by using a load cell syrrakou and pinder 2014 measured et rates of a pervious concrete system in a laboratory li et al 2014 calculated et rates of permeable pavement materials by measuring the weight change of a set of round test devices with a diameter of 10 cm nemirovsky et al 2013 measured et of a permeable concrete by placing it in an impermeable pvc cylinder and weighing it on a scale this method is deemed as the most accurate et measurement method however it can be only used in experimental conditions and it is difficult to be applied in situ lysimeter has been used to measure et of vegetated lid facilities in situ feng et al 2018 used three sets of weighing lysimeters to simultaneously measure et of three green roofs with different vegetation types zaremba et al 2016 compared et of green roofs with and without drainage systems based on the observation of weighing lysimeters wadzuk et al 2013 conducted a 3 year study on et of green roofs and its influencing factors with weighing lysimeters weighing lysimeter has also been used in the studies on et of bioretention systems denich and bradford 2010 hess et al 2017 however it is difficult to install and inconvenient to move the lysimeter system which limits its application in et measurement of lid facilities heusinger and weber 2016 used an eddy covariance system to measure et of an extensive green roof with an area of 8600 m2 the eddy covariance method is a direct measurement method of et based on physical principles rather than empirical relationships or inferred from other meteorological parameters allen et al 2011 however the eddy covariance system must be set up on a flat terrain with consistent vegetation around the area since the method relies on vertical wind errors are introduced when wind speed turbulence is low or when there is horizontal wind fisher et al 2011 thus its application is limited in urban areas with high spatial heterogeneity and complicated meteorological conditions qiu et al 2017 in addition to the above methods there are other et measurement methods for different application scenarios such as bowen ratio sap flow and large aperture scintillometer las method similar to the eddy covariance system the bowen ratio system is also suitable for et observation in situ the system is mostly used to measure et in homogeneous environments because it cannot distinguish et of different underlying surfaces it is not suitable for et measurement in urban areas with high heterogeneity qiu et al 2017 the sap flow method is a simple and commonly used method to measure transpiration and its accuracy is not affected by environmental conditions however it can only be used to estimate transpiration of trees allen et al 2011 the las has been widely used to measure turbulent fluxes for both homogeneous and heterogeneous underlying surfaces in the last few decades meijninger et al 2002b it can obtain the area averaged sensible heat flux and the area averaged et can be derived from the energy balance equation meijninger et al 2002a however las is usually used to estimate et of large areas and not suitable for et estimation of lid facilities which are relatively small and characterized by decentralized distributions liu et al 2011 liu et al 2013 in recent years thermal infrared techniques have been used for et observations they have become increasingly popular as they are non destructive non contact and have the ability to observe large areas in a few minutes marshall et al 2016 tian et al 2014 xiong and qiu 2014 the thermal infrared remotely sensed land surface temperature lst is a key parameter to estimate et in most models based on remote sensing qiu and zhao 2010 wang et al 2016 such as the surface energy balance algorithm for land sebal model the surface energy balance system sebs model the two source energy balance tseb model and the three temperature 3t model wang et al 2016 xiong and qiu 2014 the 3t model proposed by qiu et al 1996 is an et measurement method based on energy balance in this model et can be estimated according to the variations of three temperatures air temperature surface temperature of vegetation or soil and surface temperature of the reference dry leaf or soil qiu et al 1996 qiu et al 1998 among them the surface temperature can usually be measured by a thermal infrared instrument if the 3t model is combined with a portable thermal infrared instrument the measurement method is portable and can be used for in situ observation tian et al 2014 in addition this method is able to distinguish the spatial difference of et caused by the heterogeneity of underlying surface types qiu et al 2017 the 3t model has been applied to measure et of various types of underlying surfaces such as bare soil grassland shrub and forests qiu et al 1998 qiu et al 2015 qiu et al 2017 qiu and zhao 2010 tian et al 2014 voortman et al 2016 xiong and qiu 2014 zou et al 2019 as shown above although there have been some studies exploring et of lid facilities in recent years few of them focused on actual et effects of lid facilities based on measured data this is due to difficulties in measuring actual et of lid facilities especially in situ compared with other et measurement methods the 3t model is possibly more portable and convenient for in situ et measurement of lid facilities however the 3t model has not been used in et measurement of lid facilities in previous studies furthermore the accuracy of this method to estimate et of lid facilities and its influencing factors have not been studied therefore the objectives of this research were to 1 verify the accuracy of 3t model to estimate et of vegetated lid green roofs and non vegetated lid permeable pavements 2 understand the variation of et estimation errors and its influencing factors and 3 initially investigate et variations of typical lid facilities based on 3t model 2 materials and methods 2 1 3t model the 3t model proposed by qiu et al 1996 is based on a surface energy balance equation that can be described as 1 le r n g h where le is the latent heat flux w m 2 l is the latent heat of vaporization 2 42 106 w m 2 mm 1 and e is the evapotranspiration mm rn is the net radiation w m 2 g is the heat flux of surface w m 2 and h is the sensible heat flux w m 2 the calculation of h is quite difficult as it requires accurate estimation of the aerodynamic resistance ra to overcome this difficulty qiu et al 1996 1998 introduced a reference dry soil or leaf for et estimation of soil or vegetation and eq 1 can be modified as follows qiu et al 1996 qiu et al 1998 2 le s r n s g s r n s d g sd t s t a t sd t a f o r s o i l 3 le v r n v r n v d t v t a t vd t a f o r v e g e t a t i o n where r n s r n s d r n v and r n v d are the net radiations of soil surface reference dry soil surface leaf surface and reference dry leaf surface w m 2 respectively g s and g sd are the heat fluxes of soil and reference dry soil w m 2 respectively ts tsd t v and t vd are the surface temperatures of soil reference dry soil leaf and reference dry leaf k respectively ta is air temperature k in this study eq 3 was used to calculate et of green roofs as both permeable pavements and soil are porous media they have similar water and energy transfer mechanism and thus eq 2 was used to calculate et of permeable pavements 2 2 experimental setup to investigate whether the 3t model can be used to estimate actual et of typical lid facilities and to evaluate its accuracy an experiment was conducted on the top of a building in peking university shenzhen graduate school pkusz 22 35 40 n 113 58 20 e shenzhen china shenzhen has a typical subtropical monsoon climate with the annual average temperature 22 c and the annual rainfall 1944 mm which mainly occurs from april to september the average annual sunshine duration is 2020 h and the solar radiation is as high as 5225 mj m 2 which provides abundant energy for et of underlying surfaces most lid facilities have a layered structure according to the characteristics of the surface layer the facilities can be divided into vegetated type and non vegetated type compared with other lid facilities e g bioretention green roofs and permeable pavements account for a larger proportion of urban underlying surfaces and they have a relatively greater impact on urban et therefore green roofs and permeable pavements were respectively selected as the representatives of vegetated and non vegetated lid facilities in this study two pilot green roofs and two pilot permeable pavements were installed in pkusz the pilot green roof was a 60 cm 60 cm 10 cm length width height pvc box the green roof consisted of a vegetation layer a soil layer geotextile and a storage layer from top to bottom the two pilot green roofs were planted with zoysia tenuifolia grz fig 1 a and callisia repens grc fig 1b respectively which both are widely used grass species in green roofs in south china the soil layer was filled with 7 cm thick engineered light soil 40 peat soil 30 broken ceramsite 10 perlite and 20 branches fertilizer the storage layer was 3 cm thick and had a drainage hole at the bottom on each side the pilot permeable pavement was a 40 cm 30 cm 30 cm length width height pvc box in this study two typical permeable pavements were considered permeable concrete pavement pcp fig 1c and permeable brick pavement pbp fig 1d the pcp consisted of a surface layer a leveling layer geotextile and a substrate layer the surface layer of pcp was 6 cm thick permeable concrete the leveling layer was filled with 2 cm thick graded gravel the substrate layer was filled with 20 cm thick graded broken stones there were two drainage holes at the bottom of two narrow sides of the pvc box which were kept closed during the experiment the surface layer of pbp was 6 cm thick permeable brick the leveling layer was filled with 2 cm thick coarse sand other parts of pbp were the same as pcp 2 3 actual et measurement two methods the weighing method and the 3t model were used to measure actual et of the pilot green roofs and the pilot permeable pavements the experiments were divided into two groups group a for grz and pcp group b for grc and pbp et of the two facilities in each group was measured simultaneously the weighing platform is cylindrical with a diameter of 50 cm and a weight resolution of 2 g lys220s beijing china the weight variation of each pilot facility was measured at an interval of 10 min and automatically recorded by a data logger the hourly average et rate can be derived from the weight change of the pilot facilities within one hour two weighing platform systems were used for each experiment group in this study obtaining the reference parameters of the dry soil or vegetation are key in applying the 3t model in previous studies a green paper was commonly used as alternative for an imitation dry leaf tian et al 2014 zhou et al 2014 however leaves of callisia repens turns red when the plant is short of water the difference in color results in the difference in albedo thus using green paper as a reference leaf would cause errors in estimating rn vd and tvd in eq 3 to minimize the errors a color photo of plant leaves was used to represent the imitation dry leaf in this study for permeable pavements both pcp and pbp had two identical systems one of which served as the reference system the reference system was covered to keep it dry during rainfall and was remained uncovered during the subsequent drying period the reference systems were placed next to the corresponding lid facilities to ensure they share a same surrounding environment to use the 3t model to estimate et and analyze the influence of meteorological factors on et the following indicators need to be measured in this study in each experiment group the surface temperatures of the lid facilities and their reference systems were measured by four infrared radiometers si 411 apogee instruments inc usa installed above the facilities the measurement wave length of the infrared radiometer is 8 14 μm the field of view is 44 the measurement precision is 0 05 and the calibration uncertainty 20 to 65 is 1 the temperature variation was recorded by a data logger at an interval of 10 min the weather data such as air temperature relative humidity wind speed and solar radiation were automatically recorded by a weather station davis wireless vantage pro2 davis usa installed around 1 m away from the lid facilities at an interval of 10 min net radiation can be either measured by net radiometer or estimated using solar radiation and other thermodynamic parameters albedo emissivity air temperature surface temperature etc in this study a four component net radiometer sn 500 apogee instruments inc utah usa and a one component net radiometer nr lite2 kipp zonen b v netherlands were installed above the lid facilities and their reference systems to simultaneously measure net radiations of the facilities the heat fluxes of pcp and pbp were respectively measured with two heat flux plates hfp01 campbell scientific inc usa at a depth of 0 5 cm under their surface layers qiu et al 1998 information of the sensors is shown in table 1 as et of lid facilities in the nighttime is very low cascone et al 2019 qin and hiller 2016 only et rate in the daytime 6 00 to 18 00 was estimated by the 3t model at an interval of an hour it must be noted that it is the instantaneous et rate per unit area that the 3t model estimates since the et rate usually changes little in one hour the average et rate in one hour is approximately equal to the instantaneous et rate qiu et al 1998 qiu et al 2015 qiu et al 2017 qiu and zhao 2010 tian et al 2014 voortman et al 2016 xiong and qiu 2014 in addition to compare et unit mm h 1 estimated by 3t model with that measured by weighing platform which directly records the weight change unit g h 1 of the facility the effective et area of each lid facility needs to be estimated to convert mm h 1 to g h 1 in this study the effective et area for permeable pavements is its projection area for grc the effective et area is also its projected area as leaves of callisia repens are basically laid horizontally for grz as leaves of zoysia tenuifolia are laid vertically its et area needs to be calibrated by active leaf area laiactive as proposed by allen et al 1998 and is estimated as 1 2 laiactive 0 5 lai lai 24 h where lai and h are the leaf area index and the crop height for clipped grass respectively h 0 1 m for zoysia tenuifolia in this study 2 4 data processing the experiment group a for grz and pcp was conducted in june 2018 january 2019 and april to may 2019 while the experiment group b for grc and pbp was conducted in june 2018 january 2019 and may to june 2019 during the whole experiment 332 296 253 and 323 h of et data of grz grc pcp and pbp were obtained respectively pauta criterion 3δ criterion shen et al 2017 was used to filter out abnormal et data estimated by the 3t model the accuracy of the 3t model in estimating et of different lid facilities was evaluated with correlation analysis and the error indices such as nse nash sutcliffe efficiency coefficient nash and sutcliffe 1970 and mae the mean absolute error nse indicates how well the estimated data fits the 1 1 line with the measured data the nse ranges between and 1 a value of 1 shows a perfect fit between et measured by weighing platform and et estimated by the 3t model negative values indicate unacceptable model performance mae is a conventional index of error a value close to 0 indicates error between measured and estimated value is very small nonparametric test method man whitney u test was used to judge the significance of difference of meteorological factors corresponding to high and low accurate estimations 3 results and discussion 3 1 accuracy of et estimation based on 3t model firstly the accuracy of the 3t model in estimating et of different lid facilities was evaluated before the evaluation the outliers of et estimated by 3t model were filterer by pauta criterion 3δ criterion after filtering the outliers 288 86 7 285 96 3 223 88 1 and 302 93 5 hours of et data were used in the evaluation for grz grc pcp and pcb respectively the sum of et corresponding to the outliers only accounts for 3 9 1 7 4 6 1 6 of the total et during the experiment period for grz grc pcp and pcb respectively and thus its influence on evaluation is negligible 3 1 1 green roofs fig 2 a shows the correlation between the et rates of grz measured by weighing platform and those estimated by the 3t model the distribution of data scatter is close to 1 1 line and their regression equation is y 0 90x 0 03 with r2 0 63 the nse and mae of et estimation for grz are 0 63 and 0 10 mm h 1 respectively fig 2b shows the correlation between the et rates of grc measured by the two methods the distribution of data scatter is also close to 1 1 line and their regression equation is y 0 87x 0 00 with r2 0 60 the nse and mae of et estimation for grc are 0 48 and 0 11 mm h 1 respectively in general et rates of green roofs estimated by the 3t model agree well with those measured by weighing platform both the regression equations for grz and grc have a slope close to 1 and an intercept close to 0 error analysis also shows that the 3t model has a good accuracy in estimating et rate of grz and grc however as shown in fig 2a and b there are still some points far from the 1 1 line for both grz and grc the estimation error of 3t model is relatively large when the et rate is low for grc there is a point point a far above the 1 1 line which indicates the et is overestimated by the 3t model this is because the 3t model is very sensitive to the variations of three temperatures air temperature surface temperature and reference surface temperature particularly when tvd ta in equation 3 is small in this study the measurement precision of the infrared radiometer to measure the surface temperatures is 0 05 when tvd ta decreases from 1 to 0 1 an absolute relative error of tv ta tvd ta caused by an error of 0 05 for tvd increases from 4 76 to 5 26 to 33 100 in the case of point a tvd ta is close to 0 0 02 and the et estimation error is as high as 456 3 1 2 permeable pavements fig 2c shows the correlation between the et rates of pcp measured by weighing platform and those estimated by the 3t model the distribution of data scatter is close to 1 1 line and their regression equation is y 0 79x 0 03 with r2 0 70 the nse and mae of et estimation for pcp are 0 73 and 0 06 mm h 1 respectively fig 2d shows the correlation between the et rates of pbp measured by the two methods again the distribution of data scatter is close to 1 1 line and their regression equation is y 0 98x 0 04 with r2 0 65 the nse and mae of et estimation for pbp are 0 55 and 0 12 mm h 1 respectively similar to green roofs in general et rates of permeable pavements estimated by the 3t model agree well with those measured by weighing platform both the regression equations for pcp and pbp have a slope close to 1 and an intercept close to 0 error analysis also indicates that the 3t model has a good accuracy in estimating et rate of pcp and pbp however as shown in fig 2c and d there are also some points far from the 1 1 line the 3t model tends to overestimate or underestimate et of permeable pavements when et rate is low just like green roofs when tsd ta in equation 2 is close to 0 and ts ta tsd ta is positive the 3t model overestimates et this leads to point b c f far above the 1 1 line in fig 2c and d 3 2 variation of et estimation errors and its influencing factors to understand how and why the et estimation errors of 3t model change the variation of the absolute relative error are of et estimation and its influencing factors were further investigated 3 2 1 variation of et estimation errors in a day fig 3 shows the variations of average hourly et in daytime 6 00 to 18 00 for each lid facility for grz the average hourly et measured by weighing platform increases from 0 03 mm h 1 at 6 00 to 0 50 mm h 1 at 12 00 and then begins to decline reaching 0 07 mm h 1 at 18 00 fig 3a a similar et trend is observed in terms of the data estimated by the 3tt model for grc the et rate increases from 0 11 mm h 1 at 6 00 to 0 48 mm h 1 at 14 00 then et decreases and falls to 0 11 mm h 1 at 18 00 fig 3b et trend obtained by the 3t model is similar to that measured by the weighing platform there are similar trends and results for permeable pavements for pcp the average hourly et rate is quite low compared with the other lid facilities it increases from 0 06 mm h 1 at 6 00 and reaches its maximum value of 0 36 mm h 1 at 10 00 and then begins to decline reaching 0 05 mm h 1 at 18 00 fig 3c for pbp the et rate gradually increases from 0 06 mm h 1 at 6 00 to the daily peak of 0 59 mm h 1 at 13 00 and then declines to 0 10 mm h 1 at 18 00 fig 3d the 3t model accurately depicts the hourly et variation trend for both pcp and pbp in this study the are was calculated based on the difference between the et rate estimated by the 3t model and that measured by the weighing platform fig 3 shows the box and whisker plots of the are for grz the median are at 6 00 and 18 00 is as high as 0 91 and 0 95 respectively while during the period from 7 00 to 17 00 the median are ranges from 0 09 to 0 36 in addition the variation range of are at 17 00 is much larger than that at other times fig 3a for grc the median are is as high as 0 89 at 6 00 and 18 00 while during the period from 7 00 to 17 00 the median are ranges from 0 14 to 0 37 fig 3b for pcp the median are at 6 00 7 00 and 18 00 is as high as 0 93 0 93 and 0 78 respectively while during the period from 8 00 to 17 00 the median are ranges from 0 10 to 0 38 in addition the variation range of are at 17 00 is much larger than other times fig 3c for pbp the median are at 6 00 and 18 00 is as high as 0 65 and 0 70 respectively while during the period from 7 00 to 17 00 the median are ranges from 0 12 to 0 34 in addition the variation range of are at 7 00 is much larger than other times fig 3d generally according to the change of are with time the daytime can be divided into two periods period a the early morning 6 00 7 00 or the late afternoon 17 00 18 00 period b the rest of daytime 8 00 16 00 are in period a is significantly larger than that in period b the reason for this lies in the variation of solar radiation during daytime which is further explained in section 3 2 2 however the hourly et in period a is much lower than that in period b in this study the et in period a only accounts for 9 16 14 and 12 of the total et in the daytime for grz grc pcp and pbp respectively 3 2 2 factors influencing et estimation errors according to whether are of hourly et estimation is greater than 0 5 all samples can be divided into two groups in this study group a with are 0 5 and group b with are 0 5 generally a significant difference between the two groups in terms of a certain factor indicates a significant influence of the factor on the are man whitney u test was used to analyze the significance of difference between the two groups the factors considered in the analysis included absolute difference between reference surface temperature and air temperature ts ta solar radiation air temperature relative humidity and wind speed the factor of ts ta was considered because et estimated by the 3t model is sensitive to it particularly when it is close to 0 zhou et al 2014 as shown in fig 4 for grz ts ta and solar radiation of group a are significantly higher than those of group b p 0 01 while relative humidity of group a is significantly lower than that of group b p 0 05 however there is no significant difference between the two groups in terms of air temperature and wind speed for grc ts ta solar radiation and air temperature are significantly higher than those of group b p 0 01 and relative humidity of group a is significantly lower than that of group b p 0 01 however there is no significant difference between the two groups in terms of wind speed for both pcp and pbp ts ta solar radiation and air temperature are significantly higher than those of group b p 0 01 relative humidity of group a is significantly lower than that of group b p 0 01 for pbp while there is no significant difference between the two groups for pcp wind speed of group a is significantly higher than that of group b p 0 05 for pcp while there is no significant difference between the two groups for pbp in general the three factors ts ta solar radiation and air temperature have significant effects on are of hourly et estimation and specifically their values with are 0 5 are significantly lower than those of the group with are 0 5 this is because the 3t model is developed based on ground surface energy balance in which et is estimated based on the energy related factors e g solar radiation temperature when the solar radiation is relatively low other factors e g advection and relative humidity might have a significant effect on et however the 3t model cannot directly consider this effect therefore et estimation error is large when the solar radiation is low on the contrary et estimation error is small when solar radiation is high in the early morning or late afternoon solar radiation is relative weak this results to the are of et estimation in this period is much larger than that in the rest of daytime this phenomenon is also found in the research of zhou et al 2014 3 3 t characteristics of lid facilities as a demonstration the validated 3t model was initially used to investigate the characteristics of lid facilities 3 3 1 variation of et after rainfall the grz and pcp experiments were conducted from april 2 7 2019 with 57 1 mm of rainfall on april 1 the grc and pbp experiments were conducted from may 10 15 2019 with 86 8 mm of rainfall on may 9 the lid facilities were sufficiently wetted before the experiments there was no rainfall during the experiments et rate was estimated by the 3t model fig 5 shows et variations of different lid facilities after rainfall the average et rate of grz and grc are 0 31 mm h 1 and 0 29 mm h 1 respectively and the average et rate of pcp and pbp are 0 10 mm h 1 and 0 37 mm h 1 respectively grz grc and pbp have similar et rate their et rates maintain at a relatively high level within 6 days after rainfall however pcp has much lower et rate than other lid facilities its et rate maintains at a relatively high level for 2 days after rainfall declines significantly on the third day and is too small to measure from the fourth day furthermore the variation trend of et and solar radiation is consistent in the first few days after rainfall more than 6 days for grz grc and pbp and 2 days for pcp in this study the et variation can be explained according to the structural characteristics of the lid facilities each lid facility has a storage layer or a substrate layer which can store water during a rain event and supply water to the surface layer during the subsequent drying period therefore the surface layer of each lid facility has sufficient water and the et process is mainly limited by solar energy in the first few days after rainfall in addition although both pcp and pbp are permeable pavement they have different leveling layer pcp and pbp respectively uses graded gravel and coarse sand as leveling layer this difference results in a much less capillary effect in pcp than in pbp because the water in the surface layer cannot be fully replenished through the capillary effect et of pcp significantly decrease on the third day after rainfall the results confirm the importance of improving capillarity of pcp to improve its evaporation effect liu et al 2018 qin et al 2018 3 3 2 effects of meteorological conditions on et of lid facilities the partial correlation analysis was conducted between hourly et rate and air temperature 2 m above the roof surface relative humidity wind speed and solar radiation to investigate effects of meteorological conditions on et of lid facilities the results are shown in table 2 the partial correlation coefficient between et and solar radiation is 0 80 0 60 0 52 and 0 74 for grz grc pcp pcb respectively at a 99 confidence level the correlation coefficients between et and air temperature humidity and wind speed are all very low the results indicate solar radiation is the dominant meteorological factor for the four lid facilities in the study area and influences of other meteorological factors wind speed relative humidity and air temperature are very weak this is due to the meteorological characteristics of low wind speed and high temperature in urban environment and the findings of this study are consistent with the previous results in urban environment qiu et al 2017 4 conclusions in order to investigate the accuracy of the 3t model to estimate et of lid facilities and its influencing factors the experimental devices for vegetated lid green roof with zoysia tenuifoli grz and green roof with callisia repens grc and non vegetated lid permeable concrete pavement pcp and permeable brick pavement pbp were installed the method was validated by comparing the et measured by 3t model with that measured by weighing platform after validation the 3t model was further used to initially investigate et characteristics of typical lid facilities the results obtained are summarized as below 1 the 3t model can accurately quantify et rate of the four lid facilities the slopes of regression equations are close to 1 the intercepts are close to 0 and the r2 are larger than 0 6 the nse are larger than 0 48 and the mae are lower than 0 12 mm h 1 2 the 3t model has relatively low accuracy in the early morning or the late afternoon and relatively high accuracy in the rest of daytime the are of et estimation is affected by energy related factors such as solar radiation air temperature and the difference between reference surface temperature and air temperature the lower solar radiation or temperature is the larger are is 3 et rates of lid facilities can maintain at a relatively high level in the first few days after rainfall this is because that the storage layer or substrate layer of lid facilities can store water during a rain event and supply water to the surface layer during the subsequent drying period however compared with other lid facilities et of pcp decreases faster during the drying period this is because that pcp has much less capillary effect and the water in the surface layer cannot be fully replenished during the drying period therefore the 3t model is suitable for application in highly heterogeneous environments and has the ability to measure et of lid facilities in urban environment since the error of et estimation is relatively large when the air temperature or solar radiation is low the 3t model is usually not suitable to apply in the early morning and late afternoon this method also has potential expansibility combined with a portable thermal infrared instrument the 3t model becomes portable and can be used for in situ et measurement of lid facilities if combined with uav based thermal remote sensing or satellite thermal remote sensing technology the 3t model can also be applied to larger scales such as community scale or regional scale furthermore if combined with video photography technology the 3t model has the potential for continuous et observation in the future however more studies are needed to further verify the applicability of the 3t model to estimate et of different lid facilities credit authorship contribution statement yuanyan zhang conceptualization methodology validation formal analysis writing original draft huapeng qin conceptualization resources formal analysis writing review editing funding acquisition jingyi zhang investigation resources writing review editing yinchao hu investigation writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this research was supported by the project of development and reform commission of shenzhen municipality discipline construction of watershed ecological engineering and the project of science technology and innovation commission of shenzhen municipality no zdsys20140509094114169 
5374,low impact development lid facilities have ability to increase evapotranspiration et and thus moderate the hydrological cycle and mitigate urban heat island uhi effects however it is difficult to measure et of lid facilities by traditional methods e g weighing lysimeter bowen ratio system and eddy covariance system in urban environment a recently developed method called three temperature model 3t model has been used to measure actual et of natural underlying surfaces in situ however its applicability in et measurement for lid facilities has not been investigated in order to investigate the accuracy of this method to estimate et of lid facilities and its influencing factors the experimental devices for vegetated lid green roof with zoysia tenuifoli grz and green roof with callisia repens grc and non vegetated lid permeable concrete pavement pcp and permeable brick pavement pbp were installed the method was validated by comparing the et measured by 3t model with that measured by weighing platform hourly data n 223 302 for each facility after validation the method was used to measure et variations of typical lid facilities under moist sub tropical weather condition in shenzhen china the results indicate the coefficient of determination r2 between et measured by 3t model and weighing platform is 0 63 0 60 0 70 and 0 65 for grz grc pcp and pbp respectively and the slopes of regression equations are close to 1 and their intercepts are close to 0 furthermore the 3t model has higher absolute relative error are of et estimation in the early morning and the late afternoon than that in the rest of daytime this is mainly due to the effect of energy related factors such as solar radiation air temperature and the difference between reference surface temperature and air temperature in addition et rates of lid facilities can maintain at a relatively high level in the first few days after rainfall however et of pcp decreases faster than that of other lid facilities during the drying period these results demonstrate the ability and accuracy of 3t model to measure variations of et of lid facilities in situ keywords evapotranspiration low impact development three temperature model weighing platform permeable pavement green roof 1 introduction low impact development lid facilities which include green roofs permeable pavements bioretentions and vegetated swales et al have been widely used in urban stormwater management valinski and chandler 2015 vogel and moore 2016 yang et al 2013 the facilities have multiple benefits to urban environments such as runoff volume reduction runoff quality improvement groundwater recharge increase in evapotranspiration et and so on askarizadeh et al 2015 elliott et al 2016 feng et al 2016 payne et al 2014 among these benefits increase in et is very important since it can not only promote a benign hydrological cycle in urban areas but also mitigate the urban heat island effects askarizadeh et al 2015 blanusa et al 2013 li et al 2014 due to the need to comprehensively evaluate the benefits of lid et measurement of lid facilities has been widely concerned cascone et al 2019 in previous studies actual et of lid facilities was measured by weighing platform lysimeter or eddy covariance system weighing platform can be used to measure et of lid facilities based on the change of their weight by using a load cell syrrakou and pinder 2014 measured et rates of a pervious concrete system in a laboratory li et al 2014 calculated et rates of permeable pavement materials by measuring the weight change of a set of round test devices with a diameter of 10 cm nemirovsky et al 2013 measured et of a permeable concrete by placing it in an impermeable pvc cylinder and weighing it on a scale this method is deemed as the most accurate et measurement method however it can be only used in experimental conditions and it is difficult to be applied in situ lysimeter has been used to measure et of vegetated lid facilities in situ feng et al 2018 used three sets of weighing lysimeters to simultaneously measure et of three green roofs with different vegetation types zaremba et al 2016 compared et of green roofs with and without drainage systems based on the observation of weighing lysimeters wadzuk et al 2013 conducted a 3 year study on et of green roofs and its influencing factors with weighing lysimeters weighing lysimeter has also been used in the studies on et of bioretention systems denich and bradford 2010 hess et al 2017 however it is difficult to install and inconvenient to move the lysimeter system which limits its application in et measurement of lid facilities heusinger and weber 2016 used an eddy covariance system to measure et of an extensive green roof with an area of 8600 m2 the eddy covariance method is a direct measurement method of et based on physical principles rather than empirical relationships or inferred from other meteorological parameters allen et al 2011 however the eddy covariance system must be set up on a flat terrain with consistent vegetation around the area since the method relies on vertical wind errors are introduced when wind speed turbulence is low or when there is horizontal wind fisher et al 2011 thus its application is limited in urban areas with high spatial heterogeneity and complicated meteorological conditions qiu et al 2017 in addition to the above methods there are other et measurement methods for different application scenarios such as bowen ratio sap flow and large aperture scintillometer las method similar to the eddy covariance system the bowen ratio system is also suitable for et observation in situ the system is mostly used to measure et in homogeneous environments because it cannot distinguish et of different underlying surfaces it is not suitable for et measurement in urban areas with high heterogeneity qiu et al 2017 the sap flow method is a simple and commonly used method to measure transpiration and its accuracy is not affected by environmental conditions however it can only be used to estimate transpiration of trees allen et al 2011 the las has been widely used to measure turbulent fluxes for both homogeneous and heterogeneous underlying surfaces in the last few decades meijninger et al 2002b it can obtain the area averaged sensible heat flux and the area averaged et can be derived from the energy balance equation meijninger et al 2002a however las is usually used to estimate et of large areas and not suitable for et estimation of lid facilities which are relatively small and characterized by decentralized distributions liu et al 2011 liu et al 2013 in recent years thermal infrared techniques have been used for et observations they have become increasingly popular as they are non destructive non contact and have the ability to observe large areas in a few minutes marshall et al 2016 tian et al 2014 xiong and qiu 2014 the thermal infrared remotely sensed land surface temperature lst is a key parameter to estimate et in most models based on remote sensing qiu and zhao 2010 wang et al 2016 such as the surface energy balance algorithm for land sebal model the surface energy balance system sebs model the two source energy balance tseb model and the three temperature 3t model wang et al 2016 xiong and qiu 2014 the 3t model proposed by qiu et al 1996 is an et measurement method based on energy balance in this model et can be estimated according to the variations of three temperatures air temperature surface temperature of vegetation or soil and surface temperature of the reference dry leaf or soil qiu et al 1996 qiu et al 1998 among them the surface temperature can usually be measured by a thermal infrared instrument if the 3t model is combined with a portable thermal infrared instrument the measurement method is portable and can be used for in situ observation tian et al 2014 in addition this method is able to distinguish the spatial difference of et caused by the heterogeneity of underlying surface types qiu et al 2017 the 3t model has been applied to measure et of various types of underlying surfaces such as bare soil grassland shrub and forests qiu et al 1998 qiu et al 2015 qiu et al 2017 qiu and zhao 2010 tian et al 2014 voortman et al 2016 xiong and qiu 2014 zou et al 2019 as shown above although there have been some studies exploring et of lid facilities in recent years few of them focused on actual et effects of lid facilities based on measured data this is due to difficulties in measuring actual et of lid facilities especially in situ compared with other et measurement methods the 3t model is possibly more portable and convenient for in situ et measurement of lid facilities however the 3t model has not been used in et measurement of lid facilities in previous studies furthermore the accuracy of this method to estimate et of lid facilities and its influencing factors have not been studied therefore the objectives of this research were to 1 verify the accuracy of 3t model to estimate et of vegetated lid green roofs and non vegetated lid permeable pavements 2 understand the variation of et estimation errors and its influencing factors and 3 initially investigate et variations of typical lid facilities based on 3t model 2 materials and methods 2 1 3t model the 3t model proposed by qiu et al 1996 is based on a surface energy balance equation that can be described as 1 le r n g h where le is the latent heat flux w m 2 l is the latent heat of vaporization 2 42 106 w m 2 mm 1 and e is the evapotranspiration mm rn is the net radiation w m 2 g is the heat flux of surface w m 2 and h is the sensible heat flux w m 2 the calculation of h is quite difficult as it requires accurate estimation of the aerodynamic resistance ra to overcome this difficulty qiu et al 1996 1998 introduced a reference dry soil or leaf for et estimation of soil or vegetation and eq 1 can be modified as follows qiu et al 1996 qiu et al 1998 2 le s r n s g s r n s d g sd t s t a t sd t a f o r s o i l 3 le v r n v r n v d t v t a t vd t a f o r v e g e t a t i o n where r n s r n s d r n v and r n v d are the net radiations of soil surface reference dry soil surface leaf surface and reference dry leaf surface w m 2 respectively g s and g sd are the heat fluxes of soil and reference dry soil w m 2 respectively ts tsd t v and t vd are the surface temperatures of soil reference dry soil leaf and reference dry leaf k respectively ta is air temperature k in this study eq 3 was used to calculate et of green roofs as both permeable pavements and soil are porous media they have similar water and energy transfer mechanism and thus eq 2 was used to calculate et of permeable pavements 2 2 experimental setup to investigate whether the 3t model can be used to estimate actual et of typical lid facilities and to evaluate its accuracy an experiment was conducted on the top of a building in peking university shenzhen graduate school pkusz 22 35 40 n 113 58 20 e shenzhen china shenzhen has a typical subtropical monsoon climate with the annual average temperature 22 c and the annual rainfall 1944 mm which mainly occurs from april to september the average annual sunshine duration is 2020 h and the solar radiation is as high as 5225 mj m 2 which provides abundant energy for et of underlying surfaces most lid facilities have a layered structure according to the characteristics of the surface layer the facilities can be divided into vegetated type and non vegetated type compared with other lid facilities e g bioretention green roofs and permeable pavements account for a larger proportion of urban underlying surfaces and they have a relatively greater impact on urban et therefore green roofs and permeable pavements were respectively selected as the representatives of vegetated and non vegetated lid facilities in this study two pilot green roofs and two pilot permeable pavements were installed in pkusz the pilot green roof was a 60 cm 60 cm 10 cm length width height pvc box the green roof consisted of a vegetation layer a soil layer geotextile and a storage layer from top to bottom the two pilot green roofs were planted with zoysia tenuifolia grz fig 1 a and callisia repens grc fig 1b respectively which both are widely used grass species in green roofs in south china the soil layer was filled with 7 cm thick engineered light soil 40 peat soil 30 broken ceramsite 10 perlite and 20 branches fertilizer the storage layer was 3 cm thick and had a drainage hole at the bottom on each side the pilot permeable pavement was a 40 cm 30 cm 30 cm length width height pvc box in this study two typical permeable pavements were considered permeable concrete pavement pcp fig 1c and permeable brick pavement pbp fig 1d the pcp consisted of a surface layer a leveling layer geotextile and a substrate layer the surface layer of pcp was 6 cm thick permeable concrete the leveling layer was filled with 2 cm thick graded gravel the substrate layer was filled with 20 cm thick graded broken stones there were two drainage holes at the bottom of two narrow sides of the pvc box which were kept closed during the experiment the surface layer of pbp was 6 cm thick permeable brick the leveling layer was filled with 2 cm thick coarse sand other parts of pbp were the same as pcp 2 3 actual et measurement two methods the weighing method and the 3t model were used to measure actual et of the pilot green roofs and the pilot permeable pavements the experiments were divided into two groups group a for grz and pcp group b for grc and pbp et of the two facilities in each group was measured simultaneously the weighing platform is cylindrical with a diameter of 50 cm and a weight resolution of 2 g lys220s beijing china the weight variation of each pilot facility was measured at an interval of 10 min and automatically recorded by a data logger the hourly average et rate can be derived from the weight change of the pilot facilities within one hour two weighing platform systems were used for each experiment group in this study obtaining the reference parameters of the dry soil or vegetation are key in applying the 3t model in previous studies a green paper was commonly used as alternative for an imitation dry leaf tian et al 2014 zhou et al 2014 however leaves of callisia repens turns red when the plant is short of water the difference in color results in the difference in albedo thus using green paper as a reference leaf would cause errors in estimating rn vd and tvd in eq 3 to minimize the errors a color photo of plant leaves was used to represent the imitation dry leaf in this study for permeable pavements both pcp and pbp had two identical systems one of which served as the reference system the reference system was covered to keep it dry during rainfall and was remained uncovered during the subsequent drying period the reference systems were placed next to the corresponding lid facilities to ensure they share a same surrounding environment to use the 3t model to estimate et and analyze the influence of meteorological factors on et the following indicators need to be measured in this study in each experiment group the surface temperatures of the lid facilities and their reference systems were measured by four infrared radiometers si 411 apogee instruments inc usa installed above the facilities the measurement wave length of the infrared radiometer is 8 14 μm the field of view is 44 the measurement precision is 0 05 and the calibration uncertainty 20 to 65 is 1 the temperature variation was recorded by a data logger at an interval of 10 min the weather data such as air temperature relative humidity wind speed and solar radiation were automatically recorded by a weather station davis wireless vantage pro2 davis usa installed around 1 m away from the lid facilities at an interval of 10 min net radiation can be either measured by net radiometer or estimated using solar radiation and other thermodynamic parameters albedo emissivity air temperature surface temperature etc in this study a four component net radiometer sn 500 apogee instruments inc utah usa and a one component net radiometer nr lite2 kipp zonen b v netherlands were installed above the lid facilities and their reference systems to simultaneously measure net radiations of the facilities the heat fluxes of pcp and pbp were respectively measured with two heat flux plates hfp01 campbell scientific inc usa at a depth of 0 5 cm under their surface layers qiu et al 1998 information of the sensors is shown in table 1 as et of lid facilities in the nighttime is very low cascone et al 2019 qin and hiller 2016 only et rate in the daytime 6 00 to 18 00 was estimated by the 3t model at an interval of an hour it must be noted that it is the instantaneous et rate per unit area that the 3t model estimates since the et rate usually changes little in one hour the average et rate in one hour is approximately equal to the instantaneous et rate qiu et al 1998 qiu et al 2015 qiu et al 2017 qiu and zhao 2010 tian et al 2014 voortman et al 2016 xiong and qiu 2014 in addition to compare et unit mm h 1 estimated by 3t model with that measured by weighing platform which directly records the weight change unit g h 1 of the facility the effective et area of each lid facility needs to be estimated to convert mm h 1 to g h 1 in this study the effective et area for permeable pavements is its projection area for grc the effective et area is also its projected area as leaves of callisia repens are basically laid horizontally for grz as leaves of zoysia tenuifolia are laid vertically its et area needs to be calibrated by active leaf area laiactive as proposed by allen et al 1998 and is estimated as 1 2 laiactive 0 5 lai lai 24 h where lai and h are the leaf area index and the crop height for clipped grass respectively h 0 1 m for zoysia tenuifolia in this study 2 4 data processing the experiment group a for grz and pcp was conducted in june 2018 january 2019 and april to may 2019 while the experiment group b for grc and pbp was conducted in june 2018 january 2019 and may to june 2019 during the whole experiment 332 296 253 and 323 h of et data of grz grc pcp and pbp were obtained respectively pauta criterion 3δ criterion shen et al 2017 was used to filter out abnormal et data estimated by the 3t model the accuracy of the 3t model in estimating et of different lid facilities was evaluated with correlation analysis and the error indices such as nse nash sutcliffe efficiency coefficient nash and sutcliffe 1970 and mae the mean absolute error nse indicates how well the estimated data fits the 1 1 line with the measured data the nse ranges between and 1 a value of 1 shows a perfect fit between et measured by weighing platform and et estimated by the 3t model negative values indicate unacceptable model performance mae is a conventional index of error a value close to 0 indicates error between measured and estimated value is very small nonparametric test method man whitney u test was used to judge the significance of difference of meteorological factors corresponding to high and low accurate estimations 3 results and discussion 3 1 accuracy of et estimation based on 3t model firstly the accuracy of the 3t model in estimating et of different lid facilities was evaluated before the evaluation the outliers of et estimated by 3t model were filterer by pauta criterion 3δ criterion after filtering the outliers 288 86 7 285 96 3 223 88 1 and 302 93 5 hours of et data were used in the evaluation for grz grc pcp and pcb respectively the sum of et corresponding to the outliers only accounts for 3 9 1 7 4 6 1 6 of the total et during the experiment period for grz grc pcp and pcb respectively and thus its influence on evaluation is negligible 3 1 1 green roofs fig 2 a shows the correlation between the et rates of grz measured by weighing platform and those estimated by the 3t model the distribution of data scatter is close to 1 1 line and their regression equation is y 0 90x 0 03 with r2 0 63 the nse and mae of et estimation for grz are 0 63 and 0 10 mm h 1 respectively fig 2b shows the correlation between the et rates of grc measured by the two methods the distribution of data scatter is also close to 1 1 line and their regression equation is y 0 87x 0 00 with r2 0 60 the nse and mae of et estimation for grc are 0 48 and 0 11 mm h 1 respectively in general et rates of green roofs estimated by the 3t model agree well with those measured by weighing platform both the regression equations for grz and grc have a slope close to 1 and an intercept close to 0 error analysis also shows that the 3t model has a good accuracy in estimating et rate of grz and grc however as shown in fig 2a and b there are still some points far from the 1 1 line for both grz and grc the estimation error of 3t model is relatively large when the et rate is low for grc there is a point point a far above the 1 1 line which indicates the et is overestimated by the 3t model this is because the 3t model is very sensitive to the variations of three temperatures air temperature surface temperature and reference surface temperature particularly when tvd ta in equation 3 is small in this study the measurement precision of the infrared radiometer to measure the surface temperatures is 0 05 when tvd ta decreases from 1 to 0 1 an absolute relative error of tv ta tvd ta caused by an error of 0 05 for tvd increases from 4 76 to 5 26 to 33 100 in the case of point a tvd ta is close to 0 0 02 and the et estimation error is as high as 456 3 1 2 permeable pavements fig 2c shows the correlation between the et rates of pcp measured by weighing platform and those estimated by the 3t model the distribution of data scatter is close to 1 1 line and their regression equation is y 0 79x 0 03 with r2 0 70 the nse and mae of et estimation for pcp are 0 73 and 0 06 mm h 1 respectively fig 2d shows the correlation between the et rates of pbp measured by the two methods again the distribution of data scatter is close to 1 1 line and their regression equation is y 0 98x 0 04 with r2 0 65 the nse and mae of et estimation for pbp are 0 55 and 0 12 mm h 1 respectively similar to green roofs in general et rates of permeable pavements estimated by the 3t model agree well with those measured by weighing platform both the regression equations for pcp and pbp have a slope close to 1 and an intercept close to 0 error analysis also indicates that the 3t model has a good accuracy in estimating et rate of pcp and pbp however as shown in fig 2c and d there are also some points far from the 1 1 line the 3t model tends to overestimate or underestimate et of permeable pavements when et rate is low just like green roofs when tsd ta in equation 2 is close to 0 and ts ta tsd ta is positive the 3t model overestimates et this leads to point b c f far above the 1 1 line in fig 2c and d 3 2 variation of et estimation errors and its influencing factors to understand how and why the et estimation errors of 3t model change the variation of the absolute relative error are of et estimation and its influencing factors were further investigated 3 2 1 variation of et estimation errors in a day fig 3 shows the variations of average hourly et in daytime 6 00 to 18 00 for each lid facility for grz the average hourly et measured by weighing platform increases from 0 03 mm h 1 at 6 00 to 0 50 mm h 1 at 12 00 and then begins to decline reaching 0 07 mm h 1 at 18 00 fig 3a a similar et trend is observed in terms of the data estimated by the 3tt model for grc the et rate increases from 0 11 mm h 1 at 6 00 to 0 48 mm h 1 at 14 00 then et decreases and falls to 0 11 mm h 1 at 18 00 fig 3b et trend obtained by the 3t model is similar to that measured by the weighing platform there are similar trends and results for permeable pavements for pcp the average hourly et rate is quite low compared with the other lid facilities it increases from 0 06 mm h 1 at 6 00 and reaches its maximum value of 0 36 mm h 1 at 10 00 and then begins to decline reaching 0 05 mm h 1 at 18 00 fig 3c for pbp the et rate gradually increases from 0 06 mm h 1 at 6 00 to the daily peak of 0 59 mm h 1 at 13 00 and then declines to 0 10 mm h 1 at 18 00 fig 3d the 3t model accurately depicts the hourly et variation trend for both pcp and pbp in this study the are was calculated based on the difference between the et rate estimated by the 3t model and that measured by the weighing platform fig 3 shows the box and whisker plots of the are for grz the median are at 6 00 and 18 00 is as high as 0 91 and 0 95 respectively while during the period from 7 00 to 17 00 the median are ranges from 0 09 to 0 36 in addition the variation range of are at 17 00 is much larger than that at other times fig 3a for grc the median are is as high as 0 89 at 6 00 and 18 00 while during the period from 7 00 to 17 00 the median are ranges from 0 14 to 0 37 fig 3b for pcp the median are at 6 00 7 00 and 18 00 is as high as 0 93 0 93 and 0 78 respectively while during the period from 8 00 to 17 00 the median are ranges from 0 10 to 0 38 in addition the variation range of are at 17 00 is much larger than other times fig 3c for pbp the median are at 6 00 and 18 00 is as high as 0 65 and 0 70 respectively while during the period from 7 00 to 17 00 the median are ranges from 0 12 to 0 34 in addition the variation range of are at 7 00 is much larger than other times fig 3d generally according to the change of are with time the daytime can be divided into two periods period a the early morning 6 00 7 00 or the late afternoon 17 00 18 00 period b the rest of daytime 8 00 16 00 are in period a is significantly larger than that in period b the reason for this lies in the variation of solar radiation during daytime which is further explained in section 3 2 2 however the hourly et in period a is much lower than that in period b in this study the et in period a only accounts for 9 16 14 and 12 of the total et in the daytime for grz grc pcp and pbp respectively 3 2 2 factors influencing et estimation errors according to whether are of hourly et estimation is greater than 0 5 all samples can be divided into two groups in this study group a with are 0 5 and group b with are 0 5 generally a significant difference between the two groups in terms of a certain factor indicates a significant influence of the factor on the are man whitney u test was used to analyze the significance of difference between the two groups the factors considered in the analysis included absolute difference between reference surface temperature and air temperature ts ta solar radiation air temperature relative humidity and wind speed the factor of ts ta was considered because et estimated by the 3t model is sensitive to it particularly when it is close to 0 zhou et al 2014 as shown in fig 4 for grz ts ta and solar radiation of group a are significantly higher than those of group b p 0 01 while relative humidity of group a is significantly lower than that of group b p 0 05 however there is no significant difference between the two groups in terms of air temperature and wind speed for grc ts ta solar radiation and air temperature are significantly higher than those of group b p 0 01 and relative humidity of group a is significantly lower than that of group b p 0 01 however there is no significant difference between the two groups in terms of wind speed for both pcp and pbp ts ta solar radiation and air temperature are significantly higher than those of group b p 0 01 relative humidity of group a is significantly lower than that of group b p 0 01 for pbp while there is no significant difference between the two groups for pcp wind speed of group a is significantly higher than that of group b p 0 05 for pcp while there is no significant difference between the two groups for pbp in general the three factors ts ta solar radiation and air temperature have significant effects on are of hourly et estimation and specifically their values with are 0 5 are significantly lower than those of the group with are 0 5 this is because the 3t model is developed based on ground surface energy balance in which et is estimated based on the energy related factors e g solar radiation temperature when the solar radiation is relatively low other factors e g advection and relative humidity might have a significant effect on et however the 3t model cannot directly consider this effect therefore et estimation error is large when the solar radiation is low on the contrary et estimation error is small when solar radiation is high in the early morning or late afternoon solar radiation is relative weak this results to the are of et estimation in this period is much larger than that in the rest of daytime this phenomenon is also found in the research of zhou et al 2014 3 3 t characteristics of lid facilities as a demonstration the validated 3t model was initially used to investigate the characteristics of lid facilities 3 3 1 variation of et after rainfall the grz and pcp experiments were conducted from april 2 7 2019 with 57 1 mm of rainfall on april 1 the grc and pbp experiments were conducted from may 10 15 2019 with 86 8 mm of rainfall on may 9 the lid facilities were sufficiently wetted before the experiments there was no rainfall during the experiments et rate was estimated by the 3t model fig 5 shows et variations of different lid facilities after rainfall the average et rate of grz and grc are 0 31 mm h 1 and 0 29 mm h 1 respectively and the average et rate of pcp and pbp are 0 10 mm h 1 and 0 37 mm h 1 respectively grz grc and pbp have similar et rate their et rates maintain at a relatively high level within 6 days after rainfall however pcp has much lower et rate than other lid facilities its et rate maintains at a relatively high level for 2 days after rainfall declines significantly on the third day and is too small to measure from the fourth day furthermore the variation trend of et and solar radiation is consistent in the first few days after rainfall more than 6 days for grz grc and pbp and 2 days for pcp in this study the et variation can be explained according to the structural characteristics of the lid facilities each lid facility has a storage layer or a substrate layer which can store water during a rain event and supply water to the surface layer during the subsequent drying period therefore the surface layer of each lid facility has sufficient water and the et process is mainly limited by solar energy in the first few days after rainfall in addition although both pcp and pbp are permeable pavement they have different leveling layer pcp and pbp respectively uses graded gravel and coarse sand as leveling layer this difference results in a much less capillary effect in pcp than in pbp because the water in the surface layer cannot be fully replenished through the capillary effect et of pcp significantly decrease on the third day after rainfall the results confirm the importance of improving capillarity of pcp to improve its evaporation effect liu et al 2018 qin et al 2018 3 3 2 effects of meteorological conditions on et of lid facilities the partial correlation analysis was conducted between hourly et rate and air temperature 2 m above the roof surface relative humidity wind speed and solar radiation to investigate effects of meteorological conditions on et of lid facilities the results are shown in table 2 the partial correlation coefficient between et and solar radiation is 0 80 0 60 0 52 and 0 74 for grz grc pcp pcb respectively at a 99 confidence level the correlation coefficients between et and air temperature humidity and wind speed are all very low the results indicate solar radiation is the dominant meteorological factor for the four lid facilities in the study area and influences of other meteorological factors wind speed relative humidity and air temperature are very weak this is due to the meteorological characteristics of low wind speed and high temperature in urban environment and the findings of this study are consistent with the previous results in urban environment qiu et al 2017 4 conclusions in order to investigate the accuracy of the 3t model to estimate et of lid facilities and its influencing factors the experimental devices for vegetated lid green roof with zoysia tenuifoli grz and green roof with callisia repens grc and non vegetated lid permeable concrete pavement pcp and permeable brick pavement pbp were installed the method was validated by comparing the et measured by 3t model with that measured by weighing platform after validation the 3t model was further used to initially investigate et characteristics of typical lid facilities the results obtained are summarized as below 1 the 3t model can accurately quantify et rate of the four lid facilities the slopes of regression equations are close to 1 the intercepts are close to 0 and the r2 are larger than 0 6 the nse are larger than 0 48 and the mae are lower than 0 12 mm h 1 2 the 3t model has relatively low accuracy in the early morning or the late afternoon and relatively high accuracy in the rest of daytime the are of et estimation is affected by energy related factors such as solar radiation air temperature and the difference between reference surface temperature and air temperature the lower solar radiation or temperature is the larger are is 3 et rates of lid facilities can maintain at a relatively high level in the first few days after rainfall this is because that the storage layer or substrate layer of lid facilities can store water during a rain event and supply water to the surface layer during the subsequent drying period however compared with other lid facilities et of pcp decreases faster during the drying period this is because that pcp has much less capillary effect and the water in the surface layer cannot be fully replenished during the drying period therefore the 3t model is suitable for application in highly heterogeneous environments and has the ability to measure et of lid facilities in urban environment since the error of et estimation is relatively large when the air temperature or solar radiation is low the 3t model is usually not suitable to apply in the early morning and late afternoon this method also has potential expansibility combined with a portable thermal infrared instrument the 3t model becomes portable and can be used for in situ et measurement of lid facilities if combined with uav based thermal remote sensing or satellite thermal remote sensing technology the 3t model can also be applied to larger scales such as community scale or regional scale furthermore if combined with video photography technology the 3t model has the potential for continuous et observation in the future however more studies are needed to further verify the applicability of the 3t model to estimate et of different lid facilities credit authorship contribution statement yuanyan zhang conceptualization methodology validation formal analysis writing original draft huapeng qin conceptualization resources formal analysis writing review editing funding acquisition jingyi zhang investigation resources writing review editing yinchao hu investigation writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this research was supported by the project of development and reform commission of shenzhen municipality discipline construction of watershed ecological engineering and the project of science technology and innovation commission of shenzhen municipality no zdsys20140509094114169 
