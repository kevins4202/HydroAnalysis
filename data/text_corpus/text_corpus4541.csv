index,text
22705,in the present paper large eddy simulations combined with the zwart gerber belamri cavitation model are conducted to study the flow characteristics in a tip leakage flow a reasonable agreement is obtained between the numerical and experimental data with the numerical results the influence of cavitation in a tip leakage flow on the gross features of tip leakage vortex tlv and tip separation vortex tsv the behavior of tip leakage jet the time averaged vorticity field and turbulent kinetic energy tke distributions are discussed in detailed our results demonstrate that more complex induced vortexes are observed in the non cavitation case when compared with the cavitation case moreover the results indicate that cavitation promotes the fusion of tlv and tsv the narrower passageway in the gap when cavitation occurs increases the strength of tip leakage jet which leaves significant influence on local vorticity and turbulent kinetic energy cavitation trends to suppress the production of spanwise and pitchwise vorticity and promotes the tke production further analysis shows that the spanwise and pitchwise flow patterns are mainly responsible for the tke production the fluctuations of v and w velocity and the corresponding spanwise and pitchwise velocity gradient components need to be controlled if a decrease in the viscous losses is desired keywords cavitation tip leakage flow tip separation vortex les turbulent kinetic energy 1 introduction tip leakage vortex tlv is prevalent in axial hydraulic machines in which the gap between the blade tip and casing is generally indispensable partial fluids near the blade tip pass through the gap driven by the pressure difference between suction and pressure sides forming a tip leakage flow the significant velocity gradients caused by the tip leakage and the main flows further induce the so called tip leakage vortex which is often accompanied with vibration li et al 2019a instability and performance loss luo et al 2016 zhao et al 2016 this issue is further worsened when cavitation occurs due to the low pressure in the core of tlv which leads to severe erosion and sharp rise in noise cui et al 2018 liu et al 2018b wang et al 2017 zhang et al 2015b some remedies such as anti cavitation lip have been conducted by engineers to mitigate the damage of tlv cavitation however roussopoulos and monkewitz 2000 suggested that its effect was limited the failure of these attempts should be attributed to our insufficient knowledge of tip leakage cavitating flow therefore further understanding of this complex unsteady flow phenomenon is needed for the past decades quite a number of experimental investigations have been conducted to obtain a better understanding on the behaviors of tlv inoue et al 1986 studied the flow field in an axial compressor rotor with various tip clearances in detail and suggested that the increase of gap leaded to a stronger tlv which was also consistent with the measured data by goto 1992 farrell and billet 1994 suggested that tip leakage flow could lead losses in efficiency and stall margin moreover they found that the vortical flow was subject to cavitation with the decreasing gap sizes cavitation inception indices increased lakshminarayana et al 1995 measured the components of relative velocity a high speed tip leakage jet was observed which was responsible for the production of intense shearing and flow separation in tip leakage flow miorini et al 2012 observed the inner structures of tip leakage flow and evolution of tlv within the rotor of an axial waterjet pump in detail and provided an insight to the behaviors of tlv however the complex geometry structure and moving blades or end wall casing in an axial turbo machinery increased the difficulty in making detailed measurement therefore increasing attention has been attracted to the tip leakage flow in a linear cascade ma and devenport 2006 2007 or generated by a fixed foil with a gap boulon et al 1999 muthanna and devenport 2004 and wenger et al 2004 conducted a series of experiments to study the effects of relative motion between the blade and end wall on the tip leakage flow their measurements revealed the wake structure of tlv and the mechanisms of turbulence production it suggested that the motion of end wall influenced the turbulence and mean velocity distributions of the vortex to some extent gopalan et al 2002 systematically investigated the effect of gap size on the flow structure and conditions of cavitation inception on a fixed hydrofoil a rankine model was utilized to estimate the minimum pressure coefficients in the cores of tlv with different gap size which provided a satisfying agreement with cavitation inception indices obtained from experimental data dreyer et al 2014 conducted a series of stereo piv measurements and flow visualizations for the tip leakage cavitating flow with special emphasis on the influence of the clearance size on the tip vortex structure in a simplified case study the structure and trajectory of a tlv by a fixed 2d hydrofoil for different confinements and flow parameters were experimentally investigated it indicated that the trajectory and intensity of tlv were impacted by the wall proximity significantly their work provided not only valuable information regarding this flow but also extensive experimental database for validating computational techniques thanks to these researches the qualitative understanding of tlv is obtained however a quantitative analysis such as the dynamics of tlv structures and cavitation is still poor shi et al 2017 zhang et al 2015a with the great improvement of computer technology numerical simulation is attracting more and more interest with noticeable success in predicting cavitating flows in recent years li et al 2019b liu et al 2018a long et al 2017 zhang et al 2019 you et al 2004 developed a flow solver based on les to simulate the incompressible flow in a rotor tip clearance which combined an immersed boundary technique with a curvilinear structured grid qualitative and quantitative agreements with available experimental data were obtained with this computational approach and the complex flow features were well captured with this numerical methodology a series of numerical investigations were conducted you et al 2006 according to their numerical results they pointed out that the tip leakage jet and tlv were the main reason for the production of vorticity and turbulent kinetic energy the viscous losses in the gap were mainly caused by the velocity gradients in the vicinity of the gap furthermore they suggested that the pressure fluctuations in tip leakage flow might be responsible for the vibrations of blades guo et al 2016 simulated the tip leakage flow and analyzed the influence of various gap widths on the evolution of tlv the results showed that the tsv induced by the flow separation affected the coexisting tlv s shape and intensity decaix et al 2015 conducted rans and les computations to simulate the tip leakage flow around a naca0009 hydrofoil including the gap between the tip and the wall the numerical results showed that both of the rans and les simulations provided a reasonable prediction on the position of vortex core mean velocity and axial vorticity distributions however it should be noted that the influence of cavitation was not taken into account in the work of guo et al 2016 and decaix et al 2015 it has been widely known that cavitation leaves a great influence on local vorticity turbulence and detailed flow structures though it may not alter the gross feature of tlv dreyer et al 2014 decaix et al 2016 attempted to simulate the tip leakage flow with cavitation using a rans model the vortex trajectory and the mean velocity field were well reproduced but the pressure drop in the core of tlv was not captured due to the inability of rans which further leaded to the failure of their attempt these works suggest that rans model is inadequate in the simulation of tip leakage cavitating flow on the other hand the applicability of les in reproducing the complex cavitating flow egerer et al 2016 lu et al 2014 xu et al 2018 and tip leakage flow you et al 2004 has been well demonstrated thus in the present paper les is employed to obtain reliable data for discussion inspired by previous work the present paper numerically investigates the tip leakage cavitating flow with les combined with the zwart gerber belamri cavitation model les simulation without cavitation is also conducted as a comparison the gross features of tlv and tsv behaviors of tip leakage jet time averaged vorticity field and turbulent kinetic energy distributions in the vicinity of the tip gap obtained with cavitation and non cavitation cases are comparatively analyzed the production mechanisms of the vorticity and turbulent kinetic energy are discussed in detail 2 mathematical formulations and numerical method 2 1 governing equations and the les approach with a low pass filter only large scale turbulence is solved directly in les and the small scale one filtered by the low pass filter is modeled by sub grid scale sgs model smagorinsky 1963 the basic governing equations consisting of the conservation of mass and momentum are as follows 1 ρ m t ρ m u j x j 0 2 ρ m u i t ρ m u i u j x j p x i x j μ m u i x j where p is the pressure u i is the velocity component in the i direction ρ m and μ m are the density and laminar viscosity of mixture respectively which are defined as 3 ρ m α l ρ l 1 α l ρ v 4 μ m α l μ l 1 α l μ v where α and μ are the volume fraction and laminar viscosity of one component l and v represent liquid and vapor phase respectively apply a favre filtering operation to eq 1 2 then les equations can be obtained 5 ρ m t ρ m u j x j 0 6 ρ m u i t ρ m u i u j x j p x i x j μ m u i x j τ ij x j where the over bars denote filtered quantities it is worth mentioning that the last term in eq 6 called sgs stresses are defined as 7 τ ij ρ m u i u j u i u j the boussinesq hypothesis is commonly used to model the sgs stresses 8 τ ij 1 3 τ kk δ ij 2 μ t s ij where τ kk is the isotropic part of the sgs stresses and μ t is the sgs turbulence viscosity s ij is the rate of strain tensor for the resolved scale defined by 9 s ij 1 2 u i x j u j x i in the present paper the wall adapting local eddy viscosity wale model nicoud and ducros 1999 is adopted which performs quite well in reproducing the laminar to turbulence transition since it follows the near wall distance y 3 law ji et al 2013 li and li 2016 2 2 physical cavitation model the zgb model is one of the most popular cavitation models based on the simplified rayleigh plesset equation whose accuracy has been widely validated cheng et al 2016 long et al 2018 the cavitation process in zgb model is governed by the following mass transfer equation 10 ρ v α v t ρ v α v u i x i m m where α v is the vapor volume fraction m and m are the mass transfer rate for the vaporization and condensation processes respectively which are defined as zwart et al 2004 11 m c vap 3 α nuc 1 α v ρ v r b 2 3 max p v p 0 ρ l 12 m c cond 3 α v ρ v r b 2 3 max p p v 0 ρ l where c vap 50 and c cond 0 01 are empirical constants for vaporization and condensation respectively in addition for the modeling purposes r b 1 10 6 m is set to a constant α nuc 5 10 4 is the volume fraction of the nucleation sites 2 3 simulation setup in the present paper a truncated naca0009 hydrofoil with a chord length of c 100 mm is located in a channel to generate a tip leakage cavitating flow the cartesian coordinate system is characterized with the axes x and z pointing in the streamwise and spanwise direction respectively while the axis y is the vertical direction the origin is located at the middle point of foil chord on the tunnel wall as illustrated in fig 1 the attack angle α is 10 and gap size is set as 0 1c the test section length of the tunnel is 7 5c with a cross section of 1 5c 1 5c the inlet is at 2 1c upstream of the leading edge of the foil and a total pressure of 153 kpa is applied to keep the local static pressure is about 1 bar as in the experiments the outlet velocity u is set to 10 m s no slip walls are at the foil and the tunnel wall near the gap while others tunnel walls are set as free slip wall the corresponding reynolds number re c and cavitation number σ in our simulation are 106 and 1 93 respectively which are defined as 13 r e c u c υ 14 σ p p v 0 5 ρ l u 2 where p v 3540pa is the saturated vapor pressure both of the cavitation and non cavitation simulations are initialized from steady state results using fully wetted models with k ω sst turbulence model then the cavitation model combined with les and the unsteady solver is turned on for the cavitation flow simulation for the non cavitation case only the unsteady solver with les is turned on and other settings are the same as the cavitation case the numerical schemes also affect the accuracy of results ren et al 2017 in the current paper simplec is utilized as the pressure velocity coupling method the schemes for momentum and volume fraction are set as bounded central differencing and first order upwind respectively for the unsteady simulation the bounded second order implicit scheme is chosen for the transient formulation forty iterations per time step are used to balance the accuracy and efficiency the convergence criteria are the absolute residual type with a residual target of 10 4 which is sufficient for unsteady flows with cavitation the time step size is 1 10 5s 3 validation of the numerical results 3 1 influence of mesh resolution on numerical results it should be noted that mesh independence is generally hard to be obtained for les any further mesh refinement may lead to a better prediction but also requires more computational resources to get a balance between the accuracy of numerical results and computational cost five meshes namely mesh1 5 respectively sharing the same topology but with different spatial resolutions are generated as listed in table 1 fig 2 shows a typical configuration of the computational mesh around the hydrofoil surface and near the gap the meshes near the foil surface and the gap are especially refined to capture the flow details of near wall and tip leakage flows to evaluate the influence of different meshes on capturing vortex details the vortex structures in the non cavitation case visualized by iso surface of the dimensionless q criterion with different mesh resolutions are displayed in fig 3 which can be written as 15 q 1 2 c u 2 u i x i 2 u i x j u j x i it indicates that a finer mesh resolution provides richer details vortex structures especially near the gap the similar vortex structures provided by mesh4 and mesh5 suggests that the mesh resolution of mesh4 is sufficient to capture local flow patterns fig 4 shows the distributions of y at the foil surface of the cavitation case which is an important requirement in les for the mesh resolution near wall and is defined as 16 y δ y u τ ν where δy is the distance to the nearest wall and u τ is the friction velocity at the nearest wall it can be observed that the maximum y for all of these five meshes is about 2 and most of them are less than 1 which indicates that the wall normal grid distance near the foil surface is sufficient for unsteady cavitation simulation another criterion in les simulation was suggested by benard et al 2016 to ensure enough explicit resolution of turbulent scales motions which is defined as 17 q c e sgs e sgs e r where e r is the resolved turbulent kinetic energy and e sgs is the sgs turbulent kinetic energy the value of e sgs can be evaluated by the following equation 18 e s g s k ν sgs δ 2 where ν sgs is the eddy viscosity provided by sgs model and k 100 is recommended yoshizawa and horiuti 1985 in a well resolved les the value of q c is expected below 0 2 fig 5 and fig 6 show the distributions of q c on two sections with z c 1 35 and x c 0 25 respectively it can be found that with coarse meshes the value of q c in the cavitation case is over 0 2 especially in the wake and gap region with a finer mesh resolution q c gradually decreases for mesh4 q c near the trailing edge is still not so satisfying but that near tlv is small it indicates that mesh4 should be sufficient for a relatively accurate resolution of local flow pattern 3 2 statistical convergence of the numerical results considering that most discussions in the current paper are based on the statistical results it is necessary to check the statistical convergence in our simulations the unsteady les simulations were started at t 0 00s which were initialed from steady state results using with k ω sst model to achieve a well developed turbulent cavitating flow as soon as possible then the statistics were activated at t 0 30s and lasted until the end of the simulation t 0 65s the duration over which the statistics were acquired was 0 35s which was about 27 cycles of the cloud cavitation shedding fig 7 shows the predicted lift coefficients against the time with mesh1 5 during several typical cycles which is defined as 19 c l l i f t 0 5 ρ l u 2 c s where s 1 4c is the spanwise length of hydrofoil we may observe the quasi periodic behaviors of c l predicted by mesh1 5 which suggests that the turbulent cavitating flow has developed well table 2 further compares the frequencies of sheet cavity shedding and time averaged lift coefficients from which we can find that the predicted frequencies and lift coefficients are very close to each other and the differences of c l with mesh3 5 are almost negligible considering that the mesh5 mesh leads to a sharp increase of the computational cost mesh4 may be a better choice for our simulations it is worth mentioning that during our cavitation simulations with mesh4 the variations of streamwise velocity at four points points 1 4 as shown in fig 8 were monitored as well fig 9 shows the running average of streamwise velocity which indicates that the convergence can be achieved after t 0 5s fig 10 further shows the running average of the reynolds stress in both cavitation and non cavitation cases the convergence is achieved after t 0 55s although the magnitudes of the reynolds stress remain slightly fluctuated after the convergence it does not affect the turbulent flow features the convergences of time averaged streamwise velocity and reynolds stress indicates that our statistics is sufficient to obtain convergent results the power spectrum density psd of pressure in cavitation case at point 0 see fig 8 by mesh4 in the cavitation case is checked as well as shown in fig 11 the 7 3 power law of pressure spectrum is also nearly predicted with mesh4 3 3 comparison of experimental and numerical results with mesh4 to further validate the numerical results the predicted velocity distributions in the cavitation case with mesh4 on three planes are compared with the measured piv data dreyer et al 2014 whose location is shown in fig 12 all of these measured planes share the same size 0 522c 0 552c and crosswise location the only difference is the x locations which are x c 1 0 1 2 and 1 5 respectively the predicted distributions of time averaged velocity components v x v y and v z on the measured planes are shown in figs 13 15 with the piv data as a comparison a reasonable agreement between numerical results and experimental data can be obtained with mesh4 the axial acceleration near the vortex core is successfully captured at all measured planes though the magnitude is slightly underestimated which is mainly attributed to the overestimation of viscosity near the vortex core the profiles of crosswise components are also well reproduced by numerical data fig 16 compares the predicted and measured time averaged tlv the measured time averaged tlv is depicted by cavitation and the predicted one is displayed by the iso surface of time averaged dimensionless q criterion a quite good agreement is obtained which indicates that the numerical results with mesh4 is sufficiently accurate to capture the flow characteristics of the tip leakage cavitating flow overall the numerical result provides a satisfying agreement with experimental data and is reliable for the following discussions considering that the emphasis of this paper is on the tlv and further increase in node number leads a sharp rise in computational cost mesh4 is used as the final mesh in our simulations 4 influence of cavitation on the confined tip leakage flow 4 1 gross features of the flow field gross features of tlv in both without and with cavitation cases will be discussed in this section as shown in fig 17 the time averaged streamlines are utilized to give a qualitative description of local flow patterns compared with that of the case without cavitation the mean u velocity v x of the cavitation case in the vortex cores is lower due to the occurrence of cavitation the huge density difference of liquid and vapor suggests that the volume occupied by local fluids expands greatly once cavitation occurs which induces an increase in radial velocity and further a decrease in v x in addition the volume expansion caused by cavitation also leaves an influence on the spatial distribution of vortex the distributions of streamlines in fig 17 implies that cavitation expands the core size of tlv and tsv to show the vortex structures in the vicinity of the gap more clearly fig 18 shows the iso surface of q based on the time averaged velocity with the value of 50 the tlv tsv and induced vortexes are well captured in addition the time averaged streamlines on several typical sections are also provided in fig 19 and fig 20 with the purpose to give a detailed observation on the vortex structures in the vicinity of the gap overall the evolutions of vortex structures in the non cavitation and cavitation cases are similar a pair of co rotating tlv and tsv is observed at x c 0 1 then the tsv is entrained to the suction side and merges into the tlv forming a new tlv at the same time some induced vortexes can be observed near the tunnel wall a so called secondary tlv may be formed on the suction side due to local pressure gradient near the central section of the hydrofoil as shown in figs 19 c and fig 20 c which merges into the tlv quickly both in the cavitation and non cavitation cases the tlv dominates in the evolution of vortex in the vicinity of gap however compared with the cavitation case induced vortexes in the non cavitation case are much more complex and sustain for a longer distance as shown in fig 19 two distinct induced vortexes can be observed from x c 0 7 to 1 1 for the cavitation case only at the section with x c 1 1 is observed two induced vortexes as fig 21 describes though the occurrence of cavitation can enlarge the size of tlv it weakens the vortex strength in the vortex core which further weakens the strength of induced vortexes moreover according to figs 18 20 the occurrence of cavitation trends to accelerate the fusion of tlv and tsv the fusion occurs at about 0 3c downstream the leading edge for the cavitation case which is about 0 7c for non cavitation case as a comparison one reason for that is the bigger size of tlv and tsv in the cavitation case it means that the distance between tlv and tsv in the cavitation case is smaller causing the fusion more easily to take place another reason is the narrower passageway in the gap due to cavitation the vapor will occupy much more space than the same amount of liquid as a result the flow channel in the gap for the liquid is reduced it leads to a higher of local velocity component from the pressure side to the suction side forming a stronger so called tip leakage jet which will be discussed in detail in the next section a tip leakage jet with higher velocity is favorable for the movement of tsv from the pressure side to the suction side and then promotes the fusion of tlv and tsv it should be noted that though cavitation leaves influence on the evolution of tlv and tsv but almost no impact on the trajectory of tlv as shown in figs 17 and 18 4 2 tip leakage jet flow as mentioned in the last section due to the pressure difference in the pressure and suction sides fluids in the vicinity of the gap are driven across the gap forming the so called tip leakage jet fig 22 shows the distributions of mean velocity vector at 5 lines near the suction side of foil whose x locations are x c 0 1 0 3 0 5 0 7 and 0 9 respectively it clearly depicts the process of the roll up of tip leakage jet which is considered as the formation mechanism of the tlv decaix et al 2015 you et al 2007 compared with v y of tip leakage jet in the non cavitation case that in the cavitation case is slightly higher which promotes the fusion of tlv and tsv in the cavitation case as we have discussed above to further demonstrate our argument fig 23 shows the contours of v p at five sections which is defined as 20 v p v x sin α v y cos α where α 10 is the attack angle v p represents the velocity component that is perpendicular to the foil chord the magnitude of which can be considered as a strength index of tip leakage jet in the cavitation case a significant decrease of v p is observed inside the tsv cavity when compared with the non cavitation case which induces an increase of v p in the other region near the gap as the volume of tsv cavity increases the magnitude of v p and the scope of region with high v p also show an increase leading to a stronger tip leakage jet at the same time due to the entrainment of the tip leakage jet the tsv cavity expands to the suction side more easily promoting the fusion of tlv and tsv it should be noted that the tsv itself in the non cavitation case can also induce a recirculation region with low v p but it is much smaller when compared with that in the cavitation case as shown in fig 23 a c once the fusion occurs the v p distributions in non cavitation and cavitation case are similar as shown in fig 23 d e as a consequence of that there is not distinct difference between the strengths of tip leakage jet in the non cavitation and cavitation cases our work demonstrates that when compared with the non cavitation case the narrower passageway in the gap in a cavitation case will induce a stronger tip leakage jet which will promote the fusion of tlv and tsv another important influence of tip leakage jet on local flow is the strong velocity gradients near the foil tip according to you et al 2007 the mean velocity gradient components induced by the tip leakage jet leave significant impact on the distributions of vorticity and turbulent kinetic energy fig 24 shows the distributions of the mean velocity gradient components v x z v y z and v z z on plane z c 1 41 which is very close to the foil tip the comparison between the non cavitation and cavitation cases shows that cavitation plays an important role in the distributions of the mean velocity gradient components near the gap which implies that cavitation may also significantly influence local vorticity and turbulent kinetic energy 4 3 time averaged vorticity field since the tip leakage jet impacts the distributions of the mean velocity gradient components in the vicinity of the gap it should also leave influence on local vorticity fig 25 shows the distributions of time averaged vorticity magnitude and its components near the gap on nine sections with x c 0 1 0 3 1 7 respectively as mentioned above although cavitation modifies the detailed characteristics of tlv tsv and induced vortexes the gross features of vortex structures in a tip leakage flow with and without cavitation are similar to find the major source of vorticity fig 25 b d give the distributions of mean vorticity components ω x ω y and ω z it indicates that the ω x dominates the vorticity field both in the cases without and with cavitation and the region with high ω x is a little bigger in cavitation case than that in non cavitation case however cavitation trends to suppress the production of ω y and ω z as shown in fig 25 c d the magnitudes of ω y and ω z in the non cavitation case are larger when compared with that in the cavitation case to find out how cavitation influences vorticity distributions fig 26 shows the contours of velocity gradient components according to fig 26 a b for ω x both v z y and v y z play an important role however ω y and ω z are mainly produced by the spanwise and pitchwise components of v x which are significantly weakened by the occurrence of cavitation as shown in fig 26 c and f as discussed in section 4 1 a decrease of u velocity in the cores of tlv and tsv is observed due to cavitation which will weaken the spanwise and pitchwise gradients of v x and further suppress the production of ω y and ω z you et al 2007 suggested that shape modification of blade was needed to control the pitchwise vorticity however according to our work both pitchwise and spanwise vorticity might be reduced by cavitation in the tip leakage flow to some degree for the streamwise vorticity special methods such as utilizing a vortex generator are still needed 4 4 reynolds stresses and turbulent kinetic energy it has been well known that once cavitation occurs violent velocity fluctuations will be induced which generally be accompanied by strong production of turbulent kinetic energy tke fig 27 a shows the distribution of tke which is defined as 21 k 0 5 v x v x v y v y v z v z fig 27 a shows that the tke mainly concentrates in the gap until the fusion begins much more tke is produced on the suction side during the fusion of tlv and tsv which suggests that the fusion process is quite unsteady and accompanied with violent velocity fluctuations the comparison of tke in the non cavitation and cavitation cases in the vicinity of the gap also demonstrates the significant promotion of tke production due to the influence of cavitation fig 27 b d indicate the major sources of tke production in the cavitation case are the fluctuations of spanwise and pitchwise velocity components according to the work by lakshminarayana 1996 and you et al 2007 the tip leakage loss is proportional to kinetic energy in velocity fluctuations caused by the tip leakage flow it suggests that compared with the tip leakage flow without cavitation more losses will be caused due to the occurrence of cavitation it is worth noting that miorini et al 2012 found a large amount of turbulent kinetic energy with a little production within the tlv core in their experiments but the limited measurement data is not sufficient for further analysis with the help of numerical technology decaix et al 2018 studied this mismatch and pointed out that the transportation of tke was the main reason however it is still necessary to check the contributions of the out of plane in turbulence production which is another possible reason for that mismatch as mentioned by miorini et al 2012 therefore fig 28 shows the components of tke production which is written as 22 p tke p tke 11 p tke 22 p tke 33 p tke 12 p tke 13 p tke 23 v x v x v x x v y v y v y y v z v z v z y v x v y v x y v y x v x v z v x z v z x v y v z v y z v z y a similar mismatch between the distributions of the turbulent kinetic energy and its production term near the tlv core can be also observed by comparing fig 27 a with fig 28 as shown in fig 28 the tke production are mainly consist of p tke22 p tke33 and p tke23 which are induced by the fluctuations and spanwise and pitchwise gradients of v y and v z our results indicates that contributions of the out of plane in turbulence production are not so important which supports the conclusion of decaix et al 2018 moreover it also suggests that the spanwise and pitchwise flow patterns are mainly responsible for the tke production in a tip leakage flow which further causes more viscous losses this issue is even worse when cavitation occurs a noticeable increase in p tke22 p tke33 and p tke23 is induced for the cavitation case when compared with the non cavitation case the fluctuations of v y and v z and their spanwise and pitchwise velocity gradients components need to be controlled if a decrease in the viscous losses is desired 5 conclusions in the present paper large eddy simulations combined with the zgb cavitation model are conducted to study the flow characteristics in a tip leakage flow without and with cavitation the impact of mesh resolution is checked carefully and the numerical results are compared with available experimental data dreyer et al 2014 it indicates that the numerical data is sufficiently accurate for the discussion in this paper with the numerical results the influence of cavitation in a tip leakage flow on the gross features of tlv and tsv the behavior of tip leakage jet the time averaged vorticity field and tke distribution are discussed in detailed the main conclusions can be drawn as follows 1 the simulations conducted in the present paper predicts the time averaged flow characteristic accurately when compared with experimental data the gross features of tip leakage flow are captured well compared with the cavitation case more complicate induced vortexes are observed in the non cavitation case the numerical results indicate that cavitation induces a decrease in the streamwise velocity and promotes the fusion of tlv and tsv cavitation enlarges the cores of tlv and tsv but weakens the vortex strength in the cores of tlv and tsv slightly 2 the occurrence of cavitation induces a narrower passageway in the gap for the tip leakage jet it will increase the strength of tip leakage jet and induce stronger shear stresses near the foil tip which leaves significant influence on local vorticity and tke 3 the gross distributions of vorticity in the tip leakage flow with and without cavitation are similar the streamwise vorticity dominates the vorticity field in both cases however cavitation trends to suppress the production of spanwise and pitchwise vorticity which is mainly caused by the decrease of u velocity in the cores of tlv and tsv when cavitation occurs for the streamwise vorticity the influence of cavitation is slight 4 in the tip leakage flow tke mainly concentrates in the gap until the fusion begins and much more tke is produced on the suction side during the fusion of tlv and tsv the comparison of tke in the non cavitation and cavitation cases indicates that cavitation significantly promotes the tke production further analysis shows that the spanwise and pitchwise flow patterns are mainly responsible for the tke production the fluctuations of v and w velocity and the corresponding spanwise and pitchwise gradient components need to be controlled if a decrease in the viscous losses is desired acknowledgment this work was financially supported by the national natural science foundation of china project nos 51822903 11772239 and 51576143 and the natural science foundation of hubei province 2017cfa048 and 2018cfa010 the numerical calculations in this paper have been done on the supercomputing system in the supercomputing center of wuhan university 
22705,in the present paper large eddy simulations combined with the zwart gerber belamri cavitation model are conducted to study the flow characteristics in a tip leakage flow a reasonable agreement is obtained between the numerical and experimental data with the numerical results the influence of cavitation in a tip leakage flow on the gross features of tip leakage vortex tlv and tip separation vortex tsv the behavior of tip leakage jet the time averaged vorticity field and turbulent kinetic energy tke distributions are discussed in detailed our results demonstrate that more complex induced vortexes are observed in the non cavitation case when compared with the cavitation case moreover the results indicate that cavitation promotes the fusion of tlv and tsv the narrower passageway in the gap when cavitation occurs increases the strength of tip leakage jet which leaves significant influence on local vorticity and turbulent kinetic energy cavitation trends to suppress the production of spanwise and pitchwise vorticity and promotes the tke production further analysis shows that the spanwise and pitchwise flow patterns are mainly responsible for the tke production the fluctuations of v and w velocity and the corresponding spanwise and pitchwise velocity gradient components need to be controlled if a decrease in the viscous losses is desired keywords cavitation tip leakage flow tip separation vortex les turbulent kinetic energy 1 introduction tip leakage vortex tlv is prevalent in axial hydraulic machines in which the gap between the blade tip and casing is generally indispensable partial fluids near the blade tip pass through the gap driven by the pressure difference between suction and pressure sides forming a tip leakage flow the significant velocity gradients caused by the tip leakage and the main flows further induce the so called tip leakage vortex which is often accompanied with vibration li et al 2019a instability and performance loss luo et al 2016 zhao et al 2016 this issue is further worsened when cavitation occurs due to the low pressure in the core of tlv which leads to severe erosion and sharp rise in noise cui et al 2018 liu et al 2018b wang et al 2017 zhang et al 2015b some remedies such as anti cavitation lip have been conducted by engineers to mitigate the damage of tlv cavitation however roussopoulos and monkewitz 2000 suggested that its effect was limited the failure of these attempts should be attributed to our insufficient knowledge of tip leakage cavitating flow therefore further understanding of this complex unsteady flow phenomenon is needed for the past decades quite a number of experimental investigations have been conducted to obtain a better understanding on the behaviors of tlv inoue et al 1986 studied the flow field in an axial compressor rotor with various tip clearances in detail and suggested that the increase of gap leaded to a stronger tlv which was also consistent with the measured data by goto 1992 farrell and billet 1994 suggested that tip leakage flow could lead losses in efficiency and stall margin moreover they found that the vortical flow was subject to cavitation with the decreasing gap sizes cavitation inception indices increased lakshminarayana et al 1995 measured the components of relative velocity a high speed tip leakage jet was observed which was responsible for the production of intense shearing and flow separation in tip leakage flow miorini et al 2012 observed the inner structures of tip leakage flow and evolution of tlv within the rotor of an axial waterjet pump in detail and provided an insight to the behaviors of tlv however the complex geometry structure and moving blades or end wall casing in an axial turbo machinery increased the difficulty in making detailed measurement therefore increasing attention has been attracted to the tip leakage flow in a linear cascade ma and devenport 2006 2007 or generated by a fixed foil with a gap boulon et al 1999 muthanna and devenport 2004 and wenger et al 2004 conducted a series of experiments to study the effects of relative motion between the blade and end wall on the tip leakage flow their measurements revealed the wake structure of tlv and the mechanisms of turbulence production it suggested that the motion of end wall influenced the turbulence and mean velocity distributions of the vortex to some extent gopalan et al 2002 systematically investigated the effect of gap size on the flow structure and conditions of cavitation inception on a fixed hydrofoil a rankine model was utilized to estimate the minimum pressure coefficients in the cores of tlv with different gap size which provided a satisfying agreement with cavitation inception indices obtained from experimental data dreyer et al 2014 conducted a series of stereo piv measurements and flow visualizations for the tip leakage cavitating flow with special emphasis on the influence of the clearance size on the tip vortex structure in a simplified case study the structure and trajectory of a tlv by a fixed 2d hydrofoil for different confinements and flow parameters were experimentally investigated it indicated that the trajectory and intensity of tlv were impacted by the wall proximity significantly their work provided not only valuable information regarding this flow but also extensive experimental database for validating computational techniques thanks to these researches the qualitative understanding of tlv is obtained however a quantitative analysis such as the dynamics of tlv structures and cavitation is still poor shi et al 2017 zhang et al 2015a with the great improvement of computer technology numerical simulation is attracting more and more interest with noticeable success in predicting cavitating flows in recent years li et al 2019b liu et al 2018a long et al 2017 zhang et al 2019 you et al 2004 developed a flow solver based on les to simulate the incompressible flow in a rotor tip clearance which combined an immersed boundary technique with a curvilinear structured grid qualitative and quantitative agreements with available experimental data were obtained with this computational approach and the complex flow features were well captured with this numerical methodology a series of numerical investigations were conducted you et al 2006 according to their numerical results they pointed out that the tip leakage jet and tlv were the main reason for the production of vorticity and turbulent kinetic energy the viscous losses in the gap were mainly caused by the velocity gradients in the vicinity of the gap furthermore they suggested that the pressure fluctuations in tip leakage flow might be responsible for the vibrations of blades guo et al 2016 simulated the tip leakage flow and analyzed the influence of various gap widths on the evolution of tlv the results showed that the tsv induced by the flow separation affected the coexisting tlv s shape and intensity decaix et al 2015 conducted rans and les computations to simulate the tip leakage flow around a naca0009 hydrofoil including the gap between the tip and the wall the numerical results showed that both of the rans and les simulations provided a reasonable prediction on the position of vortex core mean velocity and axial vorticity distributions however it should be noted that the influence of cavitation was not taken into account in the work of guo et al 2016 and decaix et al 2015 it has been widely known that cavitation leaves a great influence on local vorticity turbulence and detailed flow structures though it may not alter the gross feature of tlv dreyer et al 2014 decaix et al 2016 attempted to simulate the tip leakage flow with cavitation using a rans model the vortex trajectory and the mean velocity field were well reproduced but the pressure drop in the core of tlv was not captured due to the inability of rans which further leaded to the failure of their attempt these works suggest that rans model is inadequate in the simulation of tip leakage cavitating flow on the other hand the applicability of les in reproducing the complex cavitating flow egerer et al 2016 lu et al 2014 xu et al 2018 and tip leakage flow you et al 2004 has been well demonstrated thus in the present paper les is employed to obtain reliable data for discussion inspired by previous work the present paper numerically investigates the tip leakage cavitating flow with les combined with the zwart gerber belamri cavitation model les simulation without cavitation is also conducted as a comparison the gross features of tlv and tsv behaviors of tip leakage jet time averaged vorticity field and turbulent kinetic energy distributions in the vicinity of the tip gap obtained with cavitation and non cavitation cases are comparatively analyzed the production mechanisms of the vorticity and turbulent kinetic energy are discussed in detail 2 mathematical formulations and numerical method 2 1 governing equations and the les approach with a low pass filter only large scale turbulence is solved directly in les and the small scale one filtered by the low pass filter is modeled by sub grid scale sgs model smagorinsky 1963 the basic governing equations consisting of the conservation of mass and momentum are as follows 1 ρ m t ρ m u j x j 0 2 ρ m u i t ρ m u i u j x j p x i x j μ m u i x j where p is the pressure u i is the velocity component in the i direction ρ m and μ m are the density and laminar viscosity of mixture respectively which are defined as 3 ρ m α l ρ l 1 α l ρ v 4 μ m α l μ l 1 α l μ v where α and μ are the volume fraction and laminar viscosity of one component l and v represent liquid and vapor phase respectively apply a favre filtering operation to eq 1 2 then les equations can be obtained 5 ρ m t ρ m u j x j 0 6 ρ m u i t ρ m u i u j x j p x i x j μ m u i x j τ ij x j where the over bars denote filtered quantities it is worth mentioning that the last term in eq 6 called sgs stresses are defined as 7 τ ij ρ m u i u j u i u j the boussinesq hypothesis is commonly used to model the sgs stresses 8 τ ij 1 3 τ kk δ ij 2 μ t s ij where τ kk is the isotropic part of the sgs stresses and μ t is the sgs turbulence viscosity s ij is the rate of strain tensor for the resolved scale defined by 9 s ij 1 2 u i x j u j x i in the present paper the wall adapting local eddy viscosity wale model nicoud and ducros 1999 is adopted which performs quite well in reproducing the laminar to turbulence transition since it follows the near wall distance y 3 law ji et al 2013 li and li 2016 2 2 physical cavitation model the zgb model is one of the most popular cavitation models based on the simplified rayleigh plesset equation whose accuracy has been widely validated cheng et al 2016 long et al 2018 the cavitation process in zgb model is governed by the following mass transfer equation 10 ρ v α v t ρ v α v u i x i m m where α v is the vapor volume fraction m and m are the mass transfer rate for the vaporization and condensation processes respectively which are defined as zwart et al 2004 11 m c vap 3 α nuc 1 α v ρ v r b 2 3 max p v p 0 ρ l 12 m c cond 3 α v ρ v r b 2 3 max p p v 0 ρ l where c vap 50 and c cond 0 01 are empirical constants for vaporization and condensation respectively in addition for the modeling purposes r b 1 10 6 m is set to a constant α nuc 5 10 4 is the volume fraction of the nucleation sites 2 3 simulation setup in the present paper a truncated naca0009 hydrofoil with a chord length of c 100 mm is located in a channel to generate a tip leakage cavitating flow the cartesian coordinate system is characterized with the axes x and z pointing in the streamwise and spanwise direction respectively while the axis y is the vertical direction the origin is located at the middle point of foil chord on the tunnel wall as illustrated in fig 1 the attack angle α is 10 and gap size is set as 0 1c the test section length of the tunnel is 7 5c with a cross section of 1 5c 1 5c the inlet is at 2 1c upstream of the leading edge of the foil and a total pressure of 153 kpa is applied to keep the local static pressure is about 1 bar as in the experiments the outlet velocity u is set to 10 m s no slip walls are at the foil and the tunnel wall near the gap while others tunnel walls are set as free slip wall the corresponding reynolds number re c and cavitation number σ in our simulation are 106 and 1 93 respectively which are defined as 13 r e c u c υ 14 σ p p v 0 5 ρ l u 2 where p v 3540pa is the saturated vapor pressure both of the cavitation and non cavitation simulations are initialized from steady state results using fully wetted models with k ω sst turbulence model then the cavitation model combined with les and the unsteady solver is turned on for the cavitation flow simulation for the non cavitation case only the unsteady solver with les is turned on and other settings are the same as the cavitation case the numerical schemes also affect the accuracy of results ren et al 2017 in the current paper simplec is utilized as the pressure velocity coupling method the schemes for momentum and volume fraction are set as bounded central differencing and first order upwind respectively for the unsteady simulation the bounded second order implicit scheme is chosen for the transient formulation forty iterations per time step are used to balance the accuracy and efficiency the convergence criteria are the absolute residual type with a residual target of 10 4 which is sufficient for unsteady flows with cavitation the time step size is 1 10 5s 3 validation of the numerical results 3 1 influence of mesh resolution on numerical results it should be noted that mesh independence is generally hard to be obtained for les any further mesh refinement may lead to a better prediction but also requires more computational resources to get a balance between the accuracy of numerical results and computational cost five meshes namely mesh1 5 respectively sharing the same topology but with different spatial resolutions are generated as listed in table 1 fig 2 shows a typical configuration of the computational mesh around the hydrofoil surface and near the gap the meshes near the foil surface and the gap are especially refined to capture the flow details of near wall and tip leakage flows to evaluate the influence of different meshes on capturing vortex details the vortex structures in the non cavitation case visualized by iso surface of the dimensionless q criterion with different mesh resolutions are displayed in fig 3 which can be written as 15 q 1 2 c u 2 u i x i 2 u i x j u j x i it indicates that a finer mesh resolution provides richer details vortex structures especially near the gap the similar vortex structures provided by mesh4 and mesh5 suggests that the mesh resolution of mesh4 is sufficient to capture local flow patterns fig 4 shows the distributions of y at the foil surface of the cavitation case which is an important requirement in les for the mesh resolution near wall and is defined as 16 y δ y u τ ν where δy is the distance to the nearest wall and u τ is the friction velocity at the nearest wall it can be observed that the maximum y for all of these five meshes is about 2 and most of them are less than 1 which indicates that the wall normal grid distance near the foil surface is sufficient for unsteady cavitation simulation another criterion in les simulation was suggested by benard et al 2016 to ensure enough explicit resolution of turbulent scales motions which is defined as 17 q c e sgs e sgs e r where e r is the resolved turbulent kinetic energy and e sgs is the sgs turbulent kinetic energy the value of e sgs can be evaluated by the following equation 18 e s g s k ν sgs δ 2 where ν sgs is the eddy viscosity provided by sgs model and k 100 is recommended yoshizawa and horiuti 1985 in a well resolved les the value of q c is expected below 0 2 fig 5 and fig 6 show the distributions of q c on two sections with z c 1 35 and x c 0 25 respectively it can be found that with coarse meshes the value of q c in the cavitation case is over 0 2 especially in the wake and gap region with a finer mesh resolution q c gradually decreases for mesh4 q c near the trailing edge is still not so satisfying but that near tlv is small it indicates that mesh4 should be sufficient for a relatively accurate resolution of local flow pattern 3 2 statistical convergence of the numerical results considering that most discussions in the current paper are based on the statistical results it is necessary to check the statistical convergence in our simulations the unsteady les simulations were started at t 0 00s which were initialed from steady state results using with k ω sst model to achieve a well developed turbulent cavitating flow as soon as possible then the statistics were activated at t 0 30s and lasted until the end of the simulation t 0 65s the duration over which the statistics were acquired was 0 35s which was about 27 cycles of the cloud cavitation shedding fig 7 shows the predicted lift coefficients against the time with mesh1 5 during several typical cycles which is defined as 19 c l l i f t 0 5 ρ l u 2 c s where s 1 4c is the spanwise length of hydrofoil we may observe the quasi periodic behaviors of c l predicted by mesh1 5 which suggests that the turbulent cavitating flow has developed well table 2 further compares the frequencies of sheet cavity shedding and time averaged lift coefficients from which we can find that the predicted frequencies and lift coefficients are very close to each other and the differences of c l with mesh3 5 are almost negligible considering that the mesh5 mesh leads to a sharp increase of the computational cost mesh4 may be a better choice for our simulations it is worth mentioning that during our cavitation simulations with mesh4 the variations of streamwise velocity at four points points 1 4 as shown in fig 8 were monitored as well fig 9 shows the running average of streamwise velocity which indicates that the convergence can be achieved after t 0 5s fig 10 further shows the running average of the reynolds stress in both cavitation and non cavitation cases the convergence is achieved after t 0 55s although the magnitudes of the reynolds stress remain slightly fluctuated after the convergence it does not affect the turbulent flow features the convergences of time averaged streamwise velocity and reynolds stress indicates that our statistics is sufficient to obtain convergent results the power spectrum density psd of pressure in cavitation case at point 0 see fig 8 by mesh4 in the cavitation case is checked as well as shown in fig 11 the 7 3 power law of pressure spectrum is also nearly predicted with mesh4 3 3 comparison of experimental and numerical results with mesh4 to further validate the numerical results the predicted velocity distributions in the cavitation case with mesh4 on three planes are compared with the measured piv data dreyer et al 2014 whose location is shown in fig 12 all of these measured planes share the same size 0 522c 0 552c and crosswise location the only difference is the x locations which are x c 1 0 1 2 and 1 5 respectively the predicted distributions of time averaged velocity components v x v y and v z on the measured planes are shown in figs 13 15 with the piv data as a comparison a reasonable agreement between numerical results and experimental data can be obtained with mesh4 the axial acceleration near the vortex core is successfully captured at all measured planes though the magnitude is slightly underestimated which is mainly attributed to the overestimation of viscosity near the vortex core the profiles of crosswise components are also well reproduced by numerical data fig 16 compares the predicted and measured time averaged tlv the measured time averaged tlv is depicted by cavitation and the predicted one is displayed by the iso surface of time averaged dimensionless q criterion a quite good agreement is obtained which indicates that the numerical results with mesh4 is sufficiently accurate to capture the flow characteristics of the tip leakage cavitating flow overall the numerical result provides a satisfying agreement with experimental data and is reliable for the following discussions considering that the emphasis of this paper is on the tlv and further increase in node number leads a sharp rise in computational cost mesh4 is used as the final mesh in our simulations 4 influence of cavitation on the confined tip leakage flow 4 1 gross features of the flow field gross features of tlv in both without and with cavitation cases will be discussed in this section as shown in fig 17 the time averaged streamlines are utilized to give a qualitative description of local flow patterns compared with that of the case without cavitation the mean u velocity v x of the cavitation case in the vortex cores is lower due to the occurrence of cavitation the huge density difference of liquid and vapor suggests that the volume occupied by local fluids expands greatly once cavitation occurs which induces an increase in radial velocity and further a decrease in v x in addition the volume expansion caused by cavitation also leaves an influence on the spatial distribution of vortex the distributions of streamlines in fig 17 implies that cavitation expands the core size of tlv and tsv to show the vortex structures in the vicinity of the gap more clearly fig 18 shows the iso surface of q based on the time averaged velocity with the value of 50 the tlv tsv and induced vortexes are well captured in addition the time averaged streamlines on several typical sections are also provided in fig 19 and fig 20 with the purpose to give a detailed observation on the vortex structures in the vicinity of the gap overall the evolutions of vortex structures in the non cavitation and cavitation cases are similar a pair of co rotating tlv and tsv is observed at x c 0 1 then the tsv is entrained to the suction side and merges into the tlv forming a new tlv at the same time some induced vortexes can be observed near the tunnel wall a so called secondary tlv may be formed on the suction side due to local pressure gradient near the central section of the hydrofoil as shown in figs 19 c and fig 20 c which merges into the tlv quickly both in the cavitation and non cavitation cases the tlv dominates in the evolution of vortex in the vicinity of gap however compared with the cavitation case induced vortexes in the non cavitation case are much more complex and sustain for a longer distance as shown in fig 19 two distinct induced vortexes can be observed from x c 0 7 to 1 1 for the cavitation case only at the section with x c 1 1 is observed two induced vortexes as fig 21 describes though the occurrence of cavitation can enlarge the size of tlv it weakens the vortex strength in the vortex core which further weakens the strength of induced vortexes moreover according to figs 18 20 the occurrence of cavitation trends to accelerate the fusion of tlv and tsv the fusion occurs at about 0 3c downstream the leading edge for the cavitation case which is about 0 7c for non cavitation case as a comparison one reason for that is the bigger size of tlv and tsv in the cavitation case it means that the distance between tlv and tsv in the cavitation case is smaller causing the fusion more easily to take place another reason is the narrower passageway in the gap due to cavitation the vapor will occupy much more space than the same amount of liquid as a result the flow channel in the gap for the liquid is reduced it leads to a higher of local velocity component from the pressure side to the suction side forming a stronger so called tip leakage jet which will be discussed in detail in the next section a tip leakage jet with higher velocity is favorable for the movement of tsv from the pressure side to the suction side and then promotes the fusion of tlv and tsv it should be noted that though cavitation leaves influence on the evolution of tlv and tsv but almost no impact on the trajectory of tlv as shown in figs 17 and 18 4 2 tip leakage jet flow as mentioned in the last section due to the pressure difference in the pressure and suction sides fluids in the vicinity of the gap are driven across the gap forming the so called tip leakage jet fig 22 shows the distributions of mean velocity vector at 5 lines near the suction side of foil whose x locations are x c 0 1 0 3 0 5 0 7 and 0 9 respectively it clearly depicts the process of the roll up of tip leakage jet which is considered as the formation mechanism of the tlv decaix et al 2015 you et al 2007 compared with v y of tip leakage jet in the non cavitation case that in the cavitation case is slightly higher which promotes the fusion of tlv and tsv in the cavitation case as we have discussed above to further demonstrate our argument fig 23 shows the contours of v p at five sections which is defined as 20 v p v x sin α v y cos α where α 10 is the attack angle v p represents the velocity component that is perpendicular to the foil chord the magnitude of which can be considered as a strength index of tip leakage jet in the cavitation case a significant decrease of v p is observed inside the tsv cavity when compared with the non cavitation case which induces an increase of v p in the other region near the gap as the volume of tsv cavity increases the magnitude of v p and the scope of region with high v p also show an increase leading to a stronger tip leakage jet at the same time due to the entrainment of the tip leakage jet the tsv cavity expands to the suction side more easily promoting the fusion of tlv and tsv it should be noted that the tsv itself in the non cavitation case can also induce a recirculation region with low v p but it is much smaller when compared with that in the cavitation case as shown in fig 23 a c once the fusion occurs the v p distributions in non cavitation and cavitation case are similar as shown in fig 23 d e as a consequence of that there is not distinct difference between the strengths of tip leakage jet in the non cavitation and cavitation cases our work demonstrates that when compared with the non cavitation case the narrower passageway in the gap in a cavitation case will induce a stronger tip leakage jet which will promote the fusion of tlv and tsv another important influence of tip leakage jet on local flow is the strong velocity gradients near the foil tip according to you et al 2007 the mean velocity gradient components induced by the tip leakage jet leave significant impact on the distributions of vorticity and turbulent kinetic energy fig 24 shows the distributions of the mean velocity gradient components v x z v y z and v z z on plane z c 1 41 which is very close to the foil tip the comparison between the non cavitation and cavitation cases shows that cavitation plays an important role in the distributions of the mean velocity gradient components near the gap which implies that cavitation may also significantly influence local vorticity and turbulent kinetic energy 4 3 time averaged vorticity field since the tip leakage jet impacts the distributions of the mean velocity gradient components in the vicinity of the gap it should also leave influence on local vorticity fig 25 shows the distributions of time averaged vorticity magnitude and its components near the gap on nine sections with x c 0 1 0 3 1 7 respectively as mentioned above although cavitation modifies the detailed characteristics of tlv tsv and induced vortexes the gross features of vortex structures in a tip leakage flow with and without cavitation are similar to find the major source of vorticity fig 25 b d give the distributions of mean vorticity components ω x ω y and ω z it indicates that the ω x dominates the vorticity field both in the cases without and with cavitation and the region with high ω x is a little bigger in cavitation case than that in non cavitation case however cavitation trends to suppress the production of ω y and ω z as shown in fig 25 c d the magnitudes of ω y and ω z in the non cavitation case are larger when compared with that in the cavitation case to find out how cavitation influences vorticity distributions fig 26 shows the contours of velocity gradient components according to fig 26 a b for ω x both v z y and v y z play an important role however ω y and ω z are mainly produced by the spanwise and pitchwise components of v x which are significantly weakened by the occurrence of cavitation as shown in fig 26 c and f as discussed in section 4 1 a decrease of u velocity in the cores of tlv and tsv is observed due to cavitation which will weaken the spanwise and pitchwise gradients of v x and further suppress the production of ω y and ω z you et al 2007 suggested that shape modification of blade was needed to control the pitchwise vorticity however according to our work both pitchwise and spanwise vorticity might be reduced by cavitation in the tip leakage flow to some degree for the streamwise vorticity special methods such as utilizing a vortex generator are still needed 4 4 reynolds stresses and turbulent kinetic energy it has been well known that once cavitation occurs violent velocity fluctuations will be induced which generally be accompanied by strong production of turbulent kinetic energy tke fig 27 a shows the distribution of tke which is defined as 21 k 0 5 v x v x v y v y v z v z fig 27 a shows that the tke mainly concentrates in the gap until the fusion begins much more tke is produced on the suction side during the fusion of tlv and tsv which suggests that the fusion process is quite unsteady and accompanied with violent velocity fluctuations the comparison of tke in the non cavitation and cavitation cases in the vicinity of the gap also demonstrates the significant promotion of tke production due to the influence of cavitation fig 27 b d indicate the major sources of tke production in the cavitation case are the fluctuations of spanwise and pitchwise velocity components according to the work by lakshminarayana 1996 and you et al 2007 the tip leakage loss is proportional to kinetic energy in velocity fluctuations caused by the tip leakage flow it suggests that compared with the tip leakage flow without cavitation more losses will be caused due to the occurrence of cavitation it is worth noting that miorini et al 2012 found a large amount of turbulent kinetic energy with a little production within the tlv core in their experiments but the limited measurement data is not sufficient for further analysis with the help of numerical technology decaix et al 2018 studied this mismatch and pointed out that the transportation of tke was the main reason however it is still necessary to check the contributions of the out of plane in turbulence production which is another possible reason for that mismatch as mentioned by miorini et al 2012 therefore fig 28 shows the components of tke production which is written as 22 p tke p tke 11 p tke 22 p tke 33 p tke 12 p tke 13 p tke 23 v x v x v x x v y v y v y y v z v z v z y v x v y v x y v y x v x v z v x z v z x v y v z v y z v z y a similar mismatch between the distributions of the turbulent kinetic energy and its production term near the tlv core can be also observed by comparing fig 27 a with fig 28 as shown in fig 28 the tke production are mainly consist of p tke22 p tke33 and p tke23 which are induced by the fluctuations and spanwise and pitchwise gradients of v y and v z our results indicates that contributions of the out of plane in turbulence production are not so important which supports the conclusion of decaix et al 2018 moreover it also suggests that the spanwise and pitchwise flow patterns are mainly responsible for the tke production in a tip leakage flow which further causes more viscous losses this issue is even worse when cavitation occurs a noticeable increase in p tke22 p tke33 and p tke23 is induced for the cavitation case when compared with the non cavitation case the fluctuations of v y and v z and their spanwise and pitchwise velocity gradients components need to be controlled if a decrease in the viscous losses is desired 5 conclusions in the present paper large eddy simulations combined with the zgb cavitation model are conducted to study the flow characteristics in a tip leakage flow without and with cavitation the impact of mesh resolution is checked carefully and the numerical results are compared with available experimental data dreyer et al 2014 it indicates that the numerical data is sufficiently accurate for the discussion in this paper with the numerical results the influence of cavitation in a tip leakage flow on the gross features of tlv and tsv the behavior of tip leakage jet the time averaged vorticity field and tke distribution are discussed in detailed the main conclusions can be drawn as follows 1 the simulations conducted in the present paper predicts the time averaged flow characteristic accurately when compared with experimental data the gross features of tip leakage flow are captured well compared with the cavitation case more complicate induced vortexes are observed in the non cavitation case the numerical results indicate that cavitation induces a decrease in the streamwise velocity and promotes the fusion of tlv and tsv cavitation enlarges the cores of tlv and tsv but weakens the vortex strength in the cores of tlv and tsv slightly 2 the occurrence of cavitation induces a narrower passageway in the gap for the tip leakage jet it will increase the strength of tip leakage jet and induce stronger shear stresses near the foil tip which leaves significant influence on local vorticity and tke 3 the gross distributions of vorticity in the tip leakage flow with and without cavitation are similar the streamwise vorticity dominates the vorticity field in both cases however cavitation trends to suppress the production of spanwise and pitchwise vorticity which is mainly caused by the decrease of u velocity in the cores of tlv and tsv when cavitation occurs for the streamwise vorticity the influence of cavitation is slight 4 in the tip leakage flow tke mainly concentrates in the gap until the fusion begins and much more tke is produced on the suction side during the fusion of tlv and tsv the comparison of tke in the non cavitation and cavitation cases indicates that cavitation significantly promotes the tke production further analysis shows that the spanwise and pitchwise flow patterns are mainly responsible for the tke production the fluctuations of v and w velocity and the corresponding spanwise and pitchwise gradient components need to be controlled if a decrease in the viscous losses is desired acknowledgment this work was financially supported by the national natural science foundation of china project nos 51822903 11772239 and 51576143 and the natural science foundation of hubei province 2017cfa048 and 2018cfa010 the numerical calculations in this paper have been done on the supercomputing system in the supercomputing center of wuhan university 
22706,two dimensional numerical simulations are used to investigate the influence of a fish like undulating foil on the hydrodynamic performance of a flapping rigid foil the simulations are conducted to model the interplay between the flapping caudal fin and the undulating fish body in a virtual swimming tuna fish firstly simulations about the pure heave motion and the combined heave and pitch motion of a rigid naca0012 foil are performed the simulation results agree well with the literature values then the effects of structural configuration and spatial distance between the undulating foil and the flapping foil on the propulsive performance are studied numerical simulation results show that with a suitable structure a disconnected structural configuration can dramatically improve the thrust and propulsive efficiency of the hind flapping foil compared with the connected structural configuration in addition a sudden degradation phenomenon of the hydrodynamic coefficients in the disconnected structural configuration at high strouhal number st is investigated this sudden degradation phenomenon can be eliminated completely with a better separation distance condition and thus result in a better thrust increase keywords propulsive performance improvement flapping hydrofoil undulating hydrofoil distinctly separated tail computational fluid dynamics 1 introduction in nature animals have developed remarkable skills and abilities to adapt to a specific environment through millions of years of evolution natural propulsion methods such as the swimming of fishes and cetaceans and the flying of birds and insects may have potential applications in engineering and generate international research interests there is a rich biological diversity of species and thus means a morphological diversity in the aquatic environment almost 28 000 species of fish have been identified nelson 2006 morphological features of fish may have specific functions in different biological behaviors such as predation courtship camouflage and locomotion in terms of locomotion fish swimming exhibits two fundamental patterns bcf body and or caudal fin and mpf median and or paired fins modes as the main swimming mode adopted by the majority of fishes the bcf mode can be further divided into anguilliform subcarangiform carangiform and thunniform modes breder 1926 sfakiotakis et al 1999 in the bcf swimming mode fish propel themselves forward by undulating their body and caudal fin to push the adjacent water downstream blake 1979 sfakiotakis et al 1999 actually since fish swimming is an animal fluid interaction process the morphological features and mechanical properties of the fish body and caudal fin are vital to swimming performance over the past decades ichthyologists and bionic engineers have been intrigued by the evolutionary mechanisms and underlying hydrodynamic functions of the morphological features in the fish body and its appendages the effects of caudal fin shape and stiffness on the propulsive performance have been extensively studied apalkov et al 2012 bergmann et al 2014 kancharala and philen 2014 krishnadas et al 2018 larouche et al 2017 lauder 2000 these studies indicate that the shape and stiffness of the caudal fin can significantly impact a fish s propulsive performance as shown in fig 1 tuna and eel like fish are typical examples of the thunniform and anguilliform swimmers respectively the thunniform mode is identified as the most efficient locomotion mode evolved in the aquatic environment where more than 90 of the thrust is generated by the caudal fin sfakiotakis et al 1999 to simplify the research swaying motions of the fish caudal fin can be modeled as a flapping foil the flapping motion of a foil can be viewed as a combined motion of pitching and heaving over the past years great achievements have been made in flapping foil propulsion research anderson et al 1998 investigated the features of the flow around an oscillating naca0012 foil using digital particle image velocimetry dpiv in their experiments a maximum propulsive efficiency value of 87 was measured schouveiler et al 2005 carried out a similar experimental research and results showed that a maximum propulsive efficiency value of more than 70 can be achieved under the optimal combinations of parameters to improve the propulsive performance of a flapping foil in specific situations the kinematics or structure optimization methods were proposed karbasian and kim 2016 numerically investigated the behavior of vortices and flow structure in a dynamic stall phenomenon of an oscillating pitching hydrofoil an optimization method of the propulsive performance by introducing higher harmonics into the heave motion to ensure a sinusoidal variation of the angle of attack was shown to be helpful for the improvement of thrust at high strouhal numbers st read et al 2003 xiao and liao 2010 a novel motion pattern named fish like motion was researched esfahani et al 2013 karbasian and esfahani 2017 it turned out that the propulsive efficiency of a foil can be increased at moderate st through this modification of circular heaving motion the effect of elliptical motion trajectory on the propulsive performance of a flapping airfoil is evaluated esfahani et al 2015 just as the fishes can make good use of the incoming vortices liao et al 2003 the propulsive performance of the flapping or undulating foils can be improved in the wake of a bluff body obstacle such as a cylinder or d cylinder gopalkrishnan et al 1994 li et al 2017 shao et al 2010 zhang et al 2010 the swimming of mult foils in series or parallel structural configurations has been reported in past akhtar and mittal 2005 akhtar et al 2007 bao et al 2017 chen et al 2016 muscutt et al 2017 pan et al 2016 zhang and zheng 2009 studies have also found that the presence of chordwise or spanwise flexibility does have some positive effects on the propulsive performance improvement of a flapping foil bi and cai 2012 heathcote et al 2008 prempraneerach et al 2003 furthermore it is worth mentioning that the flapping foils have not only been applied as new style underwater bionic propulsors but have also been used to develop novel energy harvesting devices jeanmonod and olivier 2017 wang et al 2017 xu et al 2017 zhan et al 2017 although some studies mentioned above have provided valuable information about the topic of a flapping wing in the wake of an upstream obstacle in this study we present a new combined fish swimming model comprising an undulating fish body and a flapping caudal fin this fish model is abstracted from a tuna like fish the fish body and caudal fin will be considered separately the present research is performed by means of computational fluid dynamics cfd simulation the rest of the paper is organized as follows first the simulation model is presented in detail including the simplification and kinematics description in section 2 additionally the numerical method is described briefly in section 3 the grid independence and validation of the numerical simulation approach are presented based on this the effects of structural configuration and spatial distance between the undulating foil and the flapping foil on propulsive performance are studied the detailed analysis and discussion of the simulation results are found in section 4 finally we summarize the conclusions of this work and outline a blueprint for future research 2 material and methods 2 1 physical model as shown in fig 1 a distinctly separated tail can be clearly observed in tuna compared with that in eel like fish however most research treats the fish body and tail as a continuous and unitary whole akanyeti and liao 2013 borazjani and sotiropoulos 2009 2008 jia and chen 2018 instead we present a new combined fish swimming model comprising an undulating fish body and a flapping caudal fin to study the effects of their structural relationships on propulsive performance since conducting a three dimensional 3d study directly is complicated and burdensome for simplicity a two dimensional 2d model is used to simulate fish swimming moreover additional fins the dorsal and anal fins and the paired and median fins are not considered in this study as shown in fig 2 a an off center horizontal cross section a and a central cross section b are located at different positions on the tuna along the spanwise direction according to the structural relationships between the fish body and caudal fin of cross sections a and b in fig 2 b we can extract the 2d models displayed in fig 2 c we use a naca0012 foil to model the caudal fin and the original shape before the undulation of the fish body is modeled as a naca64018 foil whose chord length is 8 5 times that of the caudal fin due to the narrow necking at the caudal peduncle in front of the caudal fin most regions of the caudal fin are separated from the fish body only in the central part of a tuna are the body and caudal fin connected it should be noted that in both 2d models the original section profiles of the body and fin foils are uniform in size and shape respectively unless otherwise stated however for the 2d model with a separated caudal fin a necessary processing of truncation and smoothing is made at the trailing edge of the fish body foil fig 3 gives a detailed dimensional drawing of the 2d foil fish model it should be noted that we do not pursue an entirely accurate simulation about the structural relationships between the fish body and the caudal fin of a live tuna fish there are obvious limitations to this simulation model the 3d effects of live fish are neglected and thus the flow around the live fish cannot be fully described by 2d simulations the caudal fins of live fish are flexible whereas here they are assumed to be rigid the additional fins are not considered and yet they may have nonnegligible influences on the propulsive performance of the caudal fin more importantly the swimming of a live fish in essence is a complicated fluid structure interaction fsi problem but the coupling effects of the surrounding water and the fish body and fin are not taken into account however despite all of these limitations we can still expect that this study will provide some useful insights into fish swimming research and the development of biomimetic autonomous underwater vehicles auvs 2 2 motion model in this subsection the kinematics of both the fish body and caudal fin are given the undulating motion of the fish body is described by a fourier series that is based on the experimental observations of an average mackerel hess and videler 1984 specifically the equations describing the lateral undulating motion of the midline of the fish body are given as follows 1 h b x t a x sin ω t 2 π k x 2 a x a 0 a 1 x a 2 x 2 in the above equations all length variables are normalized by the chord length of the fish body foil l x is the axial flow direction measured value along the midline of the fish body from the fish head endpoint h b x t is the lateral shift of the fish body at time t a x defines the undulating amplitude value of lateral motion at location x where a 0 a 1 and a 2 are specific constants k l λ is defined as the wavenumber of the fish undulating where λ is the wavelength of the fish undulating and ω is the angular frequency obviously as the major thruster the movement of the caudal fin is crucial to swimming performance which is defined as a combination of heave motion and pitch motion with the following forms read et al 2003 3 h t t h 0 sin ω t 4 θ t θ 0 sin ω t φ in the above equations h t t is the heave displacement of the caudal fin at time t θ t is the pitch angle rotating around the pitch axis at time t h 0 and θ 0 are the heave amplitude and pitch angle amplitude respectively and φ is a phase angle between the pitching and heaving in radians to keep the integrity and consistency of the motions of the fish body and caudal fin the pitch axis is set at the leading edge of the caudal fin foil as shown in fig 3 the terminal point of the fish body midline and the leading edge of the caudal fin are coincident at all times meaning that the heave motion of the caudal fin has a constraint condition 5 h t t h b 1 t furthermore the fish is assumed to be swimming forward at a constant velocity of u the instant effective angle of attack which comprises θ t and the heaving induced angle of attack is defined as follows xiao and liao 2010 6 α t arctan h t t u θ t the nominal angle of attack α 0 as an approximation of the maximum angle of attack is defined as follows xiao and liao 2010 7 α 0 arctan ω h 0 u θ 0 2 3 relevant parameters in this subsection details of the relevant parameters are given as shown in fig 3 the chord length of the fish body naca64018 foil is l 8 5 c where c is the chord length of the caudal fin naca0012 foil the horizontal distance between the trailing edge of the fish body and the leading edge of the caudal fin is d the inflow velocity is u u as in most related studies of fish like swimming several important nondimensional parameters are given the strouhal number s t and reduced frequency k r f are defined as follows esfahani et al 2013 karbasian and esfahani 2017 8 s t 2 h 0 f u 9 k r f ω c 2 u where f is fish swimming frequency in hertz the st is a key parameter that interprets the relationship between the foil motion and free stream velocity karbasian and esfahani 2017 moreover k r f has also been employed in some studies the chord length reynolds number re is defined as follows 10 re ρ c u μ where ρ and μ are the density and dynamic viscosity of water respectively the main parameters considered in this study include the mean thrust coefficient c t mean input power coefficient c i p and propulsive efficiency η of the caudal fin the mean thrust coefficient per unit span length during one swing period has the following form xiao and liao 2010 11 c t f x 1 2 ρ u 2 c f x 1 t 0 t x t d t where f x is the periodic mean value of the force component x t of the caudal fin in the flow x direction and t is the swing period of the fish similarly the mean transverse force coefficient c y and moment coefficient c m can be defined as 12 c y f y 1 2 ρ u 2 c f y 1 t 0 t y t d t 13 c m m 1 2 ρ u 2 c 2 m 1 t 0 t m t d t where y t is the force component of the caudal fin in the lateral y direction and m t is the pitching moment the mean input power coefficient during one swing period is defined below xiao and liao 2010 14 c i p p 1 2 ρ u 3 c p 1 t 0 t y t d h t t d t d t 0 t m t d θ t d t d t where p is the periodic mean value of the input power finally the propulsive efficiency can be computed from the following equation xiao and liao 2010 15 η c t c i p 2 4 numerical method in this study the 2d transient incompressible viscous flow is solved by numerical simulation simulations are carried out using the commercial cfd code ansys fluent 14 5 ansys inc 2009 the 2d dynamic triangular unstructured meshes based on the spring and remeshing methods are applied the movements of the fish body and caudal fin are described and controlled by a user defined function udf program as shown in fig 4 the dimensions of the computational domain are 80 c 60 c and the velocity inlet and pressure outlet boundary conditions are used the fish body and caudal fin are taken as no slip walls we use the simple algorithm as the pressure velocity coupling scheme and the k ω sstturbulence model is adopted it should be noted that the original shape before the undulation of the fish is symmetrical to avoid the possible negative volume grid caused by the sudden shape change at the beginning of the simulation the fish shape in the initial mesh see fig 4 is determined by eqs 1 5 at t 0 s 3 results 3 1 grid independence in general the density and quality of mesh have a great effect on the result of the cfd simulation in this subsection we consider a simulation case of lian and shyy 2007 a rigid naca0012 foil performs a heaving motion with k r f 3 93 a ratio of the heave magnitude to chord length h 0 c 0 025 s t 0 06 and re 20 000 three different resolution meshes are used to assess grid sensitivity table 1 gives the details of these meshes specifically both mesh 2 and mesh 3 have 400 grids on the foil surface for comparison the mesh 1 only has 200 grids on the foil surface mesh details of the mesh 3 is shown in fig 5 the near body resolution on the foil surface satisfies y 1 six continuous oscillating cycles are simulated with 400 time steps in each cycle fig 6 shows the time histories of the instantaneous lift coefficient cl and drag coefficient cd of the foil over a cycle the results from the simulation of lian and shyy 2007 are also given a comparison of these three results indicates that there are no significant differences in cl among the meshes the cd of mesh 3 agrees best with the results of lian and shyy 2007 and thus mesh 3 should be the best choice in general the structured boundary layer mesh is essential to properly capture the flow boundary layer there is a special situation however where the fish body and caudal fin are connected as previously shown in fig 2 c generating and controlling the boundary layer grids in an undulating motion is difficult to avoid this difficulty and save calculation time as a trade off decision the simulations presented in the following are conducted in the mesh 2 condition as shown in fig 6 a comparison of the instantaneous force coefficients of the mesh 2 without the structured boundary layer mesh with that of the mesh 3 with the structured boundary layer mesh indicates that the overall hydrodynamic performance of the foil is not affected significantly in addition the time step 400 steps per period in this case is regarded as short enough to meet the demand of a dynamic mesh and acquire sufficient calculation precision 3 2 validation as a validation of this simulation model we consider a representative study conducted by anderson et al 1998 a rectangular foil with a uniform cross section of naca0012 span length of 0 6 m and chord length of 0 1 m was used in their experiments the foil performed a combined motion of heaving and pitching around its 1 3 chord point and these motions can be described as eqs 3 and 4 the foil was towed by a carriage at a speed of 0 4 m s corresponding to re 40 000 here we only consider the case where h 0 c 0 75 φ 90 and α 0 15 the comparison of our simulation results with the experimental values is shown in fig 7 the simulation results of the same case by xiao and liao 2010 are also given for further comparison for low st the c t of our simulations are in good agreement with the experimental results however for higher st both simulation results of c t are lower than the experimental values in the entire range of st our simulation results of c i p agree well with the experimental results in comparison the relatively poor agreement of η may be attributed to the possible force measurement errors in experiments and the inevitable numerical errors however in general our simulation results are in good agreement with those of xiao and liao 2010 according to the above analysis the reliability of our simulation model is deemed acceptable for the propulsive performance research of flapping foils 3 3 effect of structural configuration first the hydrodynamics of the 2d fish models with different fish body and caudal fin structural configurations as shown in fig 2 c are studied as mentioned above a rigid naca0012 foil is used to simulate the caudal fin and the original shape of the fish body is modeled as a naca64018 foil whose chord length is 8 5 times that of the caudal fin specifically the chord length of the caudal fin foil c is set as 0 1 m and thus the chord length of the fish body foil l is 0 85 m the motion of the fish body is described as eqs 1 and 2 with a 0 0 02 a 1 0 08 a 2 0 16 and k 0 59 in addition the motion of the caudal fin is described as eqs 3 and 4 under the constraint condition of eq 5 with the heave magnitude of h 0 0 085 m pitch angle magnitude of θ 0 30 and phase angle of φ π 2 unlike the validation case above the caudal fin foil performs a combined pitching and heaving motion around its leading edge furthermore all the simulations are conducted with an inflow velocity of u 0 4 m s corresponding to re 40 000 three different structural configurations of the fish body and caudal fin are considered table 2 gives the detailed descriptions of these configuration types as mentioned earlier d is the horizontal distance between the trailing edge of the fish body foil and the leading edge of the caudal fin foil the fish body and caudal fin are connected in the cf configuration with d 0 m whereas they are disconnected in the df configuration with d 0 34 c for comparison we also considered the sf configuration which contains the caudal fin foil only within the range of s t 0 25 0 85 the hydrodynamics of these three configurations are studied the variations of propulsive performance coefficients of the caudal fin c t c i p and η with st are shown in fig 8 since the thrust is mainly generated by the caudal fin in thunniform swimming mode the related data of the fish body foils are not considered in this study as shown in fig 8 both c t and c i p increase with st for all three configurations in the df and sf configurations higher propulsive efficiencies η are achieved between s t 0 25 0 35 this result is in accordance with previous studies that show that many species of swimming animals including dolphins sharks some scombroids and other bony fishes indeed swim in the interval of s t 0 25 0 35 eloy 2012 nudds et al 2014 taylor et al 2003 however the η value of the cf configuration is very small in this low st range and can even be negative meaning that a net drag is created by the caudal fin with the increase in st the η of the cf configuration increases to the maximum value of approximately 23 at s t 0 4 6 beyond this st value the η of the cf configuration decreases slightly with a further increase in st in general these three coefficients of the cf configuration are all far below those of the other two configurations in the entire st range indicating that the cf configuration adversely affects the propulsive performance of the caudal fin imagine a virtual situation where the narrow necking of the fish caudal peduncle is absent meaning that a larger part of the caudal fin is connected to the fish body as shown in fig 9 the caudal fin of this imaginary tuna is not distinctly separated from its body the tuna would not efficiently produce a thrust via its caudal fin alone therefore we propose a new assumption that aquatic animals that evolved such a distinctly separated tail are also motivated by the need to improve their propulsive performance moreover with the presence of an undulating fish body the c t and η of the df configuration can be increased compared to those of the sf configuration fig 10 gives the growth ratios of the thrust coefficient c t and propulsive efficiency η for the df configuration compared with those of the sf configuration showing that the thrust of the df configuration is increased over the entire st range and can in extreme cases reach more than two times the thrust of the sf configuration at s t 0 25 meanwhile a maximum of approximately 40 enhancement of propulsive efficiency can be achieved the growth ratios of thrust and efficiency both decrease with an increase in st specifically the value of η drops below 1 when st increases beyond 0 45 meaning that the propulsive efficiency of the df configuration is lower than that of the sf configuration 3 4 effect of the distance d the spatial distance and phase relationship between two tandem flapping foils are important for the propulsive performance of the downstream foil akhtar and mittal 2005 akhtar et al 2007 muscutt et al 2017 unlike in previous studies the movements of the fish body and caudal fin in this research are not completely independent the constraint condition described as eq 5 ensures the integrity and consistency of both motion foils hence all spacing and phasing features are determined by the distance d however with a certain shape and thickness of the fish body foil a considerable change in d will cause nonnegligible shape differences therefore in this subsection we replace the fish body foil with a uniform thickness 2 mm plate undulating with the midline of the fish body the horizontal length and the motion of the fish body midline are consistent with those in the last subsection a truncation processing is made at the trailing edge of the fish body plate to change the value of d within the range of d 0 34 c 2 c and s t 0 34 0 68 we consider the effect of distance d on the performance of the caudal fin the growth ratios of the propulsive performance coefficients to the corresponding values of the sf configuration with the same st are presented in fig 11 clearly the distance d dramatically changes the performance of the caudal fin as shown in fig 11 a the growth ratios of thrust increase with d for both st situations at the beginning when d increases beyond 1 2c the thrust augmentation declines sharply for the higher st situation for the case with s t 0 68 and d 1 2 c the thrust increases to 1 84 times compared with the thrust in the sf configuration s t 0 68 but the thrust increases only 1 25 times with the df configuration under the same conditions see fig 10 a as shown in fig 11 b and c the variation trend of the input power is similar to that of the thrust but the efficiency shows an almost opposite trend 4 discussion our simulation results indicate that the structural relationships between the fish body and caudal fin have significant impacts on the propulsive performance of the caudal fin in this section we will analyze and discuss the results from both aspects of flow field structure and force characteristics fig 12 presents a half cycle evolution process of the spanwise vorticity field of the three configurations cf df and sf with s t 0 68 in which the fish tail sways from the top most position a to the bottom most position f the clockwise and counterclockwise vorticity values are plotted in blue and red respectively for the cf and sf configurations a typical reversed von karman vortex pattern can be clearly observed in the wake which has been revealed in previous studies liu and kawachi 1999 schnipper et al 2009 in fig 12 c a the caudal fin is almost located at the top most position of the entire flapping cycle two relatively independent counterclockwise vortexes are formed on the lower side of the foil during the previous upstroke the first vortex is a leading edge vortex lev while the other one is a trailing edge vortex tev with the downward movement of the foil these vortexes move back along the lower surface of the foil in fig 12 c c the tev is about to shed into the wake and then the lev also sheds into the wake in the next stage see fig 12 c d after this happens these two vortexes merge together eventually forming a large counterclockwise vortex in the wake at the same time two clockwise vortexes are created on the upper side and then a similar process occurs again in the next upstroke in fig 12 a and b the spanwise vorticity contours of the cf and df configurations are plotted for the same instants corresponding to the sf configuration in fig 12 c for comparison all contours are plotted in the same value range in fig 12 a the major structures of the wake are similar to those in the sf configuration but there are some distinct differences as shown in fig 12 a the lev which is obvious in the sf configuration is absent whereas the strength of the tev is enhanced intuitively the connection of the fish body and caudal fin may cause the absence of the lev and the undulating motion of the fish body will enhance the strength of the tev in fig 12 b with the separation of the fish body and caudal fin a more complex flow field structure is formed in the wake in fig 12 b b with the downward movement of the fish tail a strong counterclockwise vortex is created at the trailing edge of the fish body the leading edge of the caudal fin collides into this vortex and as a result a clockwise lev is formed on the upper surface of the caudal fin with the further downward movement of the fish tail this induced clockwise lev of the caudal fin is stuck in the middle between the tev of the fish body and the tev of the caudal fin ultimately a complex and broken vorticity structure is created as shown in fig 10 the st has significant impacts on the degree of performance improvement of the caudal fin under the same structural configuration df to understand the performance improving mechanisms of the df configuration two representative st cases s t 0 25 0 68 are chosen for further analysis in fig 13 for both st situations the time histories of the instantaneous thrust coefficient c t transverse force coefficient c y and moment coefficient c m of the df configuration are plotted for comparison the corresponding data of the sf and cf configurations are also given only one period of data which covers the above motion process in fig 12 is depicted the marked time instants ã f correspond to those moving stages in fig 12 a negative value of c t means that the caudal fin generates a net thrust at that moment as shown in fig 13 simple harmonic variation curves of the c t for the sf configuration are observed in both st cases compared to the sf configuration the c t of the cf configuration is drastically reduced in both st cases in contrast a great c t improvement of the df configuration is achieved in the s t 0 25 case meanwhile the c y and c m of this case are both found to decrease this outcome results in an increase in propulsive efficiency in the low st range see fig 8 c however the c t improvement of the df configuration in the s t 0 68 case is limited more interestingly there is a sudden fluctuation in all three coefficients of the df configuration between instants b and d in the s t 0 68 case see fig 13 b this sudden fluctuation phenomenon goes against the performance improvement of the caudal fin the zoomed in views of the instantaneous vorticity field around the caudal fin of the above two st cases s t 0 25 0 68 are presented in fig 14 in both st cases a counterclockwise vortex is formed by the trailing edge of the fish body with the downward movement of the fish tail as a result a clockwise lev is induced on the upper surface of the caudal fin the main difference is that the intensities of these vortexes in the s t 0 25 case are much lower than those in the s t 0 68 case moreover the induced lev has a distinct separation from the upper surface of the caudal fin in the s t 0 68 case see fig 14 b c by contrast the induced lev is always attached to the upper surface of the caudal fin in the lower st case the corresponding pressure contours of both cases are plotted in fig 15 obviously a low pressure region is formed in the location of the induced lev in both st cases as this low pressure region is located on the suction side the upper side of the caudal fin it will increase the thrust corresponding to the distinct separation of the induced lev in the s t 0 68 case see fig 14 b c the separation of the low pressure region is notable see fig 15 b c potentially resulting in the sudden fluctuation phenomenon of hydrodynamic loads in fig 13 b according to the above analysis proper modifications that can alleviate or remove this severe separation of the low pressure region from the suction side of the caudal fin will be helpful for improving the propulsive performance as shown in fig 11 a the case with s t 0 68 and d 1 2 c greatly increases the thrust compared to the df configuration see fig 10 a fig 16 displays the vorticity contours and corresponding pressure distributions of this case during the same motion process fig 16 a shows a significantly different vortex structure from the vortex structure in the df configuration see fig 14 b the major difference is that the caudal fin only moves around the tev of the fish body and hence the induced clockwise lev of the caudal fin moves downward along the surface of the suction side of the caudal fin as a result as shown in fig 16 b the corresponding low pressure region also moves downward along the upper surface of the caudal fin in the whole downstroke the time histories of the instantaneous hydrodynamic coefficients of this case s t 0 68 and d 1 2 c are plotted in fig 17 accompanied by the results of the df and sf configurations with the same st value as shown in fig 17 the sudden fluctuation of the hydrodynamic coefficients that are obvious in the df configuration case are entirely eliminated ultimately a simple harmonic variation curve of c t is observed again in particular the maximum value of c t for the d 1 2 c case is almost doubled compared with that in the df configuration unfortunately the c y and c m of this case are also significantly increased at the same time these increases in the transverse force and pitching moment result in a greater demand of input power see fig 11 b therefore the thrust is effectively increased but the efficiency is decreased see fig 11 c the instantaneous vorticity field superimposed with streamlines of the representative motion stage c in the four cases mentioned above are plotted in fig 18 as the caudal fin moves down water flows in the opposite direction to the caudal fin leading to a positive effective angle of attack the counterclockwise tev of the fish body brings in an upward velocity component that increases the effective angle of attack the induced clockwise lev on the upper side of the caudal fin is attributed to this increased angle of attack as discussed above the enhanced suction pressure caused by this induced clockwise lev results in an increase in thrust this process is similar to the findings of a previous study akhtar and mittal 2005 akhtar et al 2007 furthermore a high st value and a short distance d will lead to an excessive separation of the induced lev as shown in fig 18 c resulting in the sudden fluctuation phenomenon of hydrodynamic loads in contrast a lower st value see fig 18 b or a longer distance d see fig 18 d will alleviate or remove this excessive separation and result in a better thrust increase finally according to the above analysis it is clear that the structural relationships between the fish body and caudal fin can change the flow field structure significantly and thus affect the propulsive performance of the fish caudal fin for a 3d live fish it should be noted that there may be no significant trailing edge effects of the fish body to generate a strong tev even if the finlets are already taken into account however compared with the unseparated caudal fin a distinctly separated fish tail not only significantly improves the propulsive performance of the fish but also provides an opportunity to further improve its performance by exploiting wakes in the flowing water 5 conclusion in the present study a numerical simulation was employed to explore the possible influences of the structural relationships between the fish body and caudal fin on the propulsive performance of fish the thrust and propulsive efficiency of the caudal fin were research priorities three kinds of structural configuration types were considered in addition the effects of distance between the trailing edge of the fish body foil and the leading edge of the caudal fin foil were also studied the results indicated that the structural relationships have significant effects on the propulsive performance of the caudal fin the cf configuration had an adverse impact on both thrust and efficiency within the entire st range compared with the sf configuration in contrast the df configuration significantly improved the thrust and efficiency under certain conditions by analyzing the flow field structure around the caudal fin the movement of the low pressure region caused by the induced lev was found to greatly influence the performance improvement of the caudal fin in addition only within a small range of st s t 0 25 0 35 could the caudal fin achieve a relatively high propulsive efficiency this result is consistent with previous findings in the past couple of decades the effects of vortexes induced by an upstream obstacle on the performance of a downstream fishlike swimmer have been widely studied the researches mentioned above covered the stationary or oscillating bluff body obstacles and the in line tandem or side by side arrangements of multiple swimmers in spite of the biology background and the structure differences a common topic is that how to take advantage of the incoming flow to improve the swimming performance of a swimmer on the whole high thrust occurs when the hind swimmer weaves between the vortices that have been shed by the fore obstacle or swimmer and low thrust occurs when the hind swimmer intercepts these vortices the main conclusions of this paper are as follows 1 a new assumption that aquatic animals that evolved such a distinctly separated tail are also motivated by the need to improve their propulsive performance 2 the undesired excessive separation of the low pressure region from the suction side surface will bring a sudden fluctuation in the hydrodynamic loads of the caudal fin with a suitable structural relationship between the fish body and caudal fin the propulsive performance of the caudal fin can be dramatically improved this conclusion may have direct meaning for the development of biomimetic auvs as mentioned earlier there are obvious limitations to these simplified 2d models another limitation of the current study is that these motions of the fish body and caudal fin do not change with swimming frequency in fact a live fish may change its motion features such as the amplitude of its tail s undulation with different swimming frequencies nudds et al 2014 however despite all of these limitations this research gives a better understanding of fish swimming and provides useful information for the development of biomimetic auvs certainly in the future more physical and comprehensive simulation models and better research methods are required to further studies in addition for fish body designs another important aspect to consider is the need for drag reduction declarations of interest none acknowledgements this work was financially supported by the national natural science foundation of china grant 60904085 foundation of national key laboratory of transient physics and foundation of defence technology innovation special filed 
22706,two dimensional numerical simulations are used to investigate the influence of a fish like undulating foil on the hydrodynamic performance of a flapping rigid foil the simulations are conducted to model the interplay between the flapping caudal fin and the undulating fish body in a virtual swimming tuna fish firstly simulations about the pure heave motion and the combined heave and pitch motion of a rigid naca0012 foil are performed the simulation results agree well with the literature values then the effects of structural configuration and spatial distance between the undulating foil and the flapping foil on the propulsive performance are studied numerical simulation results show that with a suitable structure a disconnected structural configuration can dramatically improve the thrust and propulsive efficiency of the hind flapping foil compared with the connected structural configuration in addition a sudden degradation phenomenon of the hydrodynamic coefficients in the disconnected structural configuration at high strouhal number st is investigated this sudden degradation phenomenon can be eliminated completely with a better separation distance condition and thus result in a better thrust increase keywords propulsive performance improvement flapping hydrofoil undulating hydrofoil distinctly separated tail computational fluid dynamics 1 introduction in nature animals have developed remarkable skills and abilities to adapt to a specific environment through millions of years of evolution natural propulsion methods such as the swimming of fishes and cetaceans and the flying of birds and insects may have potential applications in engineering and generate international research interests there is a rich biological diversity of species and thus means a morphological diversity in the aquatic environment almost 28 000 species of fish have been identified nelson 2006 morphological features of fish may have specific functions in different biological behaviors such as predation courtship camouflage and locomotion in terms of locomotion fish swimming exhibits two fundamental patterns bcf body and or caudal fin and mpf median and or paired fins modes as the main swimming mode adopted by the majority of fishes the bcf mode can be further divided into anguilliform subcarangiform carangiform and thunniform modes breder 1926 sfakiotakis et al 1999 in the bcf swimming mode fish propel themselves forward by undulating their body and caudal fin to push the adjacent water downstream blake 1979 sfakiotakis et al 1999 actually since fish swimming is an animal fluid interaction process the morphological features and mechanical properties of the fish body and caudal fin are vital to swimming performance over the past decades ichthyologists and bionic engineers have been intrigued by the evolutionary mechanisms and underlying hydrodynamic functions of the morphological features in the fish body and its appendages the effects of caudal fin shape and stiffness on the propulsive performance have been extensively studied apalkov et al 2012 bergmann et al 2014 kancharala and philen 2014 krishnadas et al 2018 larouche et al 2017 lauder 2000 these studies indicate that the shape and stiffness of the caudal fin can significantly impact a fish s propulsive performance as shown in fig 1 tuna and eel like fish are typical examples of the thunniform and anguilliform swimmers respectively the thunniform mode is identified as the most efficient locomotion mode evolved in the aquatic environment where more than 90 of the thrust is generated by the caudal fin sfakiotakis et al 1999 to simplify the research swaying motions of the fish caudal fin can be modeled as a flapping foil the flapping motion of a foil can be viewed as a combined motion of pitching and heaving over the past years great achievements have been made in flapping foil propulsion research anderson et al 1998 investigated the features of the flow around an oscillating naca0012 foil using digital particle image velocimetry dpiv in their experiments a maximum propulsive efficiency value of 87 was measured schouveiler et al 2005 carried out a similar experimental research and results showed that a maximum propulsive efficiency value of more than 70 can be achieved under the optimal combinations of parameters to improve the propulsive performance of a flapping foil in specific situations the kinematics or structure optimization methods were proposed karbasian and kim 2016 numerically investigated the behavior of vortices and flow structure in a dynamic stall phenomenon of an oscillating pitching hydrofoil an optimization method of the propulsive performance by introducing higher harmonics into the heave motion to ensure a sinusoidal variation of the angle of attack was shown to be helpful for the improvement of thrust at high strouhal numbers st read et al 2003 xiao and liao 2010 a novel motion pattern named fish like motion was researched esfahani et al 2013 karbasian and esfahani 2017 it turned out that the propulsive efficiency of a foil can be increased at moderate st through this modification of circular heaving motion the effect of elliptical motion trajectory on the propulsive performance of a flapping airfoil is evaluated esfahani et al 2015 just as the fishes can make good use of the incoming vortices liao et al 2003 the propulsive performance of the flapping or undulating foils can be improved in the wake of a bluff body obstacle such as a cylinder or d cylinder gopalkrishnan et al 1994 li et al 2017 shao et al 2010 zhang et al 2010 the swimming of mult foils in series or parallel structural configurations has been reported in past akhtar and mittal 2005 akhtar et al 2007 bao et al 2017 chen et al 2016 muscutt et al 2017 pan et al 2016 zhang and zheng 2009 studies have also found that the presence of chordwise or spanwise flexibility does have some positive effects on the propulsive performance improvement of a flapping foil bi and cai 2012 heathcote et al 2008 prempraneerach et al 2003 furthermore it is worth mentioning that the flapping foils have not only been applied as new style underwater bionic propulsors but have also been used to develop novel energy harvesting devices jeanmonod and olivier 2017 wang et al 2017 xu et al 2017 zhan et al 2017 although some studies mentioned above have provided valuable information about the topic of a flapping wing in the wake of an upstream obstacle in this study we present a new combined fish swimming model comprising an undulating fish body and a flapping caudal fin this fish model is abstracted from a tuna like fish the fish body and caudal fin will be considered separately the present research is performed by means of computational fluid dynamics cfd simulation the rest of the paper is organized as follows first the simulation model is presented in detail including the simplification and kinematics description in section 2 additionally the numerical method is described briefly in section 3 the grid independence and validation of the numerical simulation approach are presented based on this the effects of structural configuration and spatial distance between the undulating foil and the flapping foil on propulsive performance are studied the detailed analysis and discussion of the simulation results are found in section 4 finally we summarize the conclusions of this work and outline a blueprint for future research 2 material and methods 2 1 physical model as shown in fig 1 a distinctly separated tail can be clearly observed in tuna compared with that in eel like fish however most research treats the fish body and tail as a continuous and unitary whole akanyeti and liao 2013 borazjani and sotiropoulos 2009 2008 jia and chen 2018 instead we present a new combined fish swimming model comprising an undulating fish body and a flapping caudal fin to study the effects of their structural relationships on propulsive performance since conducting a three dimensional 3d study directly is complicated and burdensome for simplicity a two dimensional 2d model is used to simulate fish swimming moreover additional fins the dorsal and anal fins and the paired and median fins are not considered in this study as shown in fig 2 a an off center horizontal cross section a and a central cross section b are located at different positions on the tuna along the spanwise direction according to the structural relationships between the fish body and caudal fin of cross sections a and b in fig 2 b we can extract the 2d models displayed in fig 2 c we use a naca0012 foil to model the caudal fin and the original shape before the undulation of the fish body is modeled as a naca64018 foil whose chord length is 8 5 times that of the caudal fin due to the narrow necking at the caudal peduncle in front of the caudal fin most regions of the caudal fin are separated from the fish body only in the central part of a tuna are the body and caudal fin connected it should be noted that in both 2d models the original section profiles of the body and fin foils are uniform in size and shape respectively unless otherwise stated however for the 2d model with a separated caudal fin a necessary processing of truncation and smoothing is made at the trailing edge of the fish body foil fig 3 gives a detailed dimensional drawing of the 2d foil fish model it should be noted that we do not pursue an entirely accurate simulation about the structural relationships between the fish body and the caudal fin of a live tuna fish there are obvious limitations to this simulation model the 3d effects of live fish are neglected and thus the flow around the live fish cannot be fully described by 2d simulations the caudal fins of live fish are flexible whereas here they are assumed to be rigid the additional fins are not considered and yet they may have nonnegligible influences on the propulsive performance of the caudal fin more importantly the swimming of a live fish in essence is a complicated fluid structure interaction fsi problem but the coupling effects of the surrounding water and the fish body and fin are not taken into account however despite all of these limitations we can still expect that this study will provide some useful insights into fish swimming research and the development of biomimetic autonomous underwater vehicles auvs 2 2 motion model in this subsection the kinematics of both the fish body and caudal fin are given the undulating motion of the fish body is described by a fourier series that is based on the experimental observations of an average mackerel hess and videler 1984 specifically the equations describing the lateral undulating motion of the midline of the fish body are given as follows 1 h b x t a x sin ω t 2 π k x 2 a x a 0 a 1 x a 2 x 2 in the above equations all length variables are normalized by the chord length of the fish body foil l x is the axial flow direction measured value along the midline of the fish body from the fish head endpoint h b x t is the lateral shift of the fish body at time t a x defines the undulating amplitude value of lateral motion at location x where a 0 a 1 and a 2 are specific constants k l λ is defined as the wavenumber of the fish undulating where λ is the wavelength of the fish undulating and ω is the angular frequency obviously as the major thruster the movement of the caudal fin is crucial to swimming performance which is defined as a combination of heave motion and pitch motion with the following forms read et al 2003 3 h t t h 0 sin ω t 4 θ t θ 0 sin ω t φ in the above equations h t t is the heave displacement of the caudal fin at time t θ t is the pitch angle rotating around the pitch axis at time t h 0 and θ 0 are the heave amplitude and pitch angle amplitude respectively and φ is a phase angle between the pitching and heaving in radians to keep the integrity and consistency of the motions of the fish body and caudal fin the pitch axis is set at the leading edge of the caudal fin foil as shown in fig 3 the terminal point of the fish body midline and the leading edge of the caudal fin are coincident at all times meaning that the heave motion of the caudal fin has a constraint condition 5 h t t h b 1 t furthermore the fish is assumed to be swimming forward at a constant velocity of u the instant effective angle of attack which comprises θ t and the heaving induced angle of attack is defined as follows xiao and liao 2010 6 α t arctan h t t u θ t the nominal angle of attack α 0 as an approximation of the maximum angle of attack is defined as follows xiao and liao 2010 7 α 0 arctan ω h 0 u θ 0 2 3 relevant parameters in this subsection details of the relevant parameters are given as shown in fig 3 the chord length of the fish body naca64018 foil is l 8 5 c where c is the chord length of the caudal fin naca0012 foil the horizontal distance between the trailing edge of the fish body and the leading edge of the caudal fin is d the inflow velocity is u u as in most related studies of fish like swimming several important nondimensional parameters are given the strouhal number s t and reduced frequency k r f are defined as follows esfahani et al 2013 karbasian and esfahani 2017 8 s t 2 h 0 f u 9 k r f ω c 2 u where f is fish swimming frequency in hertz the st is a key parameter that interprets the relationship between the foil motion and free stream velocity karbasian and esfahani 2017 moreover k r f has also been employed in some studies the chord length reynolds number re is defined as follows 10 re ρ c u μ where ρ and μ are the density and dynamic viscosity of water respectively the main parameters considered in this study include the mean thrust coefficient c t mean input power coefficient c i p and propulsive efficiency η of the caudal fin the mean thrust coefficient per unit span length during one swing period has the following form xiao and liao 2010 11 c t f x 1 2 ρ u 2 c f x 1 t 0 t x t d t where f x is the periodic mean value of the force component x t of the caudal fin in the flow x direction and t is the swing period of the fish similarly the mean transverse force coefficient c y and moment coefficient c m can be defined as 12 c y f y 1 2 ρ u 2 c f y 1 t 0 t y t d t 13 c m m 1 2 ρ u 2 c 2 m 1 t 0 t m t d t where y t is the force component of the caudal fin in the lateral y direction and m t is the pitching moment the mean input power coefficient during one swing period is defined below xiao and liao 2010 14 c i p p 1 2 ρ u 3 c p 1 t 0 t y t d h t t d t d t 0 t m t d θ t d t d t where p is the periodic mean value of the input power finally the propulsive efficiency can be computed from the following equation xiao and liao 2010 15 η c t c i p 2 4 numerical method in this study the 2d transient incompressible viscous flow is solved by numerical simulation simulations are carried out using the commercial cfd code ansys fluent 14 5 ansys inc 2009 the 2d dynamic triangular unstructured meshes based on the spring and remeshing methods are applied the movements of the fish body and caudal fin are described and controlled by a user defined function udf program as shown in fig 4 the dimensions of the computational domain are 80 c 60 c and the velocity inlet and pressure outlet boundary conditions are used the fish body and caudal fin are taken as no slip walls we use the simple algorithm as the pressure velocity coupling scheme and the k ω sstturbulence model is adopted it should be noted that the original shape before the undulation of the fish is symmetrical to avoid the possible negative volume grid caused by the sudden shape change at the beginning of the simulation the fish shape in the initial mesh see fig 4 is determined by eqs 1 5 at t 0 s 3 results 3 1 grid independence in general the density and quality of mesh have a great effect on the result of the cfd simulation in this subsection we consider a simulation case of lian and shyy 2007 a rigid naca0012 foil performs a heaving motion with k r f 3 93 a ratio of the heave magnitude to chord length h 0 c 0 025 s t 0 06 and re 20 000 three different resolution meshes are used to assess grid sensitivity table 1 gives the details of these meshes specifically both mesh 2 and mesh 3 have 400 grids on the foil surface for comparison the mesh 1 only has 200 grids on the foil surface mesh details of the mesh 3 is shown in fig 5 the near body resolution on the foil surface satisfies y 1 six continuous oscillating cycles are simulated with 400 time steps in each cycle fig 6 shows the time histories of the instantaneous lift coefficient cl and drag coefficient cd of the foil over a cycle the results from the simulation of lian and shyy 2007 are also given a comparison of these three results indicates that there are no significant differences in cl among the meshes the cd of mesh 3 agrees best with the results of lian and shyy 2007 and thus mesh 3 should be the best choice in general the structured boundary layer mesh is essential to properly capture the flow boundary layer there is a special situation however where the fish body and caudal fin are connected as previously shown in fig 2 c generating and controlling the boundary layer grids in an undulating motion is difficult to avoid this difficulty and save calculation time as a trade off decision the simulations presented in the following are conducted in the mesh 2 condition as shown in fig 6 a comparison of the instantaneous force coefficients of the mesh 2 without the structured boundary layer mesh with that of the mesh 3 with the structured boundary layer mesh indicates that the overall hydrodynamic performance of the foil is not affected significantly in addition the time step 400 steps per period in this case is regarded as short enough to meet the demand of a dynamic mesh and acquire sufficient calculation precision 3 2 validation as a validation of this simulation model we consider a representative study conducted by anderson et al 1998 a rectangular foil with a uniform cross section of naca0012 span length of 0 6 m and chord length of 0 1 m was used in their experiments the foil performed a combined motion of heaving and pitching around its 1 3 chord point and these motions can be described as eqs 3 and 4 the foil was towed by a carriage at a speed of 0 4 m s corresponding to re 40 000 here we only consider the case where h 0 c 0 75 φ 90 and α 0 15 the comparison of our simulation results with the experimental values is shown in fig 7 the simulation results of the same case by xiao and liao 2010 are also given for further comparison for low st the c t of our simulations are in good agreement with the experimental results however for higher st both simulation results of c t are lower than the experimental values in the entire range of st our simulation results of c i p agree well with the experimental results in comparison the relatively poor agreement of η may be attributed to the possible force measurement errors in experiments and the inevitable numerical errors however in general our simulation results are in good agreement with those of xiao and liao 2010 according to the above analysis the reliability of our simulation model is deemed acceptable for the propulsive performance research of flapping foils 3 3 effect of structural configuration first the hydrodynamics of the 2d fish models with different fish body and caudal fin structural configurations as shown in fig 2 c are studied as mentioned above a rigid naca0012 foil is used to simulate the caudal fin and the original shape of the fish body is modeled as a naca64018 foil whose chord length is 8 5 times that of the caudal fin specifically the chord length of the caudal fin foil c is set as 0 1 m and thus the chord length of the fish body foil l is 0 85 m the motion of the fish body is described as eqs 1 and 2 with a 0 0 02 a 1 0 08 a 2 0 16 and k 0 59 in addition the motion of the caudal fin is described as eqs 3 and 4 under the constraint condition of eq 5 with the heave magnitude of h 0 0 085 m pitch angle magnitude of θ 0 30 and phase angle of φ π 2 unlike the validation case above the caudal fin foil performs a combined pitching and heaving motion around its leading edge furthermore all the simulations are conducted with an inflow velocity of u 0 4 m s corresponding to re 40 000 three different structural configurations of the fish body and caudal fin are considered table 2 gives the detailed descriptions of these configuration types as mentioned earlier d is the horizontal distance between the trailing edge of the fish body foil and the leading edge of the caudal fin foil the fish body and caudal fin are connected in the cf configuration with d 0 m whereas they are disconnected in the df configuration with d 0 34 c for comparison we also considered the sf configuration which contains the caudal fin foil only within the range of s t 0 25 0 85 the hydrodynamics of these three configurations are studied the variations of propulsive performance coefficients of the caudal fin c t c i p and η with st are shown in fig 8 since the thrust is mainly generated by the caudal fin in thunniform swimming mode the related data of the fish body foils are not considered in this study as shown in fig 8 both c t and c i p increase with st for all three configurations in the df and sf configurations higher propulsive efficiencies η are achieved between s t 0 25 0 35 this result is in accordance with previous studies that show that many species of swimming animals including dolphins sharks some scombroids and other bony fishes indeed swim in the interval of s t 0 25 0 35 eloy 2012 nudds et al 2014 taylor et al 2003 however the η value of the cf configuration is very small in this low st range and can even be negative meaning that a net drag is created by the caudal fin with the increase in st the η of the cf configuration increases to the maximum value of approximately 23 at s t 0 4 6 beyond this st value the η of the cf configuration decreases slightly with a further increase in st in general these three coefficients of the cf configuration are all far below those of the other two configurations in the entire st range indicating that the cf configuration adversely affects the propulsive performance of the caudal fin imagine a virtual situation where the narrow necking of the fish caudal peduncle is absent meaning that a larger part of the caudal fin is connected to the fish body as shown in fig 9 the caudal fin of this imaginary tuna is not distinctly separated from its body the tuna would not efficiently produce a thrust via its caudal fin alone therefore we propose a new assumption that aquatic animals that evolved such a distinctly separated tail are also motivated by the need to improve their propulsive performance moreover with the presence of an undulating fish body the c t and η of the df configuration can be increased compared to those of the sf configuration fig 10 gives the growth ratios of the thrust coefficient c t and propulsive efficiency η for the df configuration compared with those of the sf configuration showing that the thrust of the df configuration is increased over the entire st range and can in extreme cases reach more than two times the thrust of the sf configuration at s t 0 25 meanwhile a maximum of approximately 40 enhancement of propulsive efficiency can be achieved the growth ratios of thrust and efficiency both decrease with an increase in st specifically the value of η drops below 1 when st increases beyond 0 45 meaning that the propulsive efficiency of the df configuration is lower than that of the sf configuration 3 4 effect of the distance d the spatial distance and phase relationship between two tandem flapping foils are important for the propulsive performance of the downstream foil akhtar and mittal 2005 akhtar et al 2007 muscutt et al 2017 unlike in previous studies the movements of the fish body and caudal fin in this research are not completely independent the constraint condition described as eq 5 ensures the integrity and consistency of both motion foils hence all spacing and phasing features are determined by the distance d however with a certain shape and thickness of the fish body foil a considerable change in d will cause nonnegligible shape differences therefore in this subsection we replace the fish body foil with a uniform thickness 2 mm plate undulating with the midline of the fish body the horizontal length and the motion of the fish body midline are consistent with those in the last subsection a truncation processing is made at the trailing edge of the fish body plate to change the value of d within the range of d 0 34 c 2 c and s t 0 34 0 68 we consider the effect of distance d on the performance of the caudal fin the growth ratios of the propulsive performance coefficients to the corresponding values of the sf configuration with the same st are presented in fig 11 clearly the distance d dramatically changes the performance of the caudal fin as shown in fig 11 a the growth ratios of thrust increase with d for both st situations at the beginning when d increases beyond 1 2c the thrust augmentation declines sharply for the higher st situation for the case with s t 0 68 and d 1 2 c the thrust increases to 1 84 times compared with the thrust in the sf configuration s t 0 68 but the thrust increases only 1 25 times with the df configuration under the same conditions see fig 10 a as shown in fig 11 b and c the variation trend of the input power is similar to that of the thrust but the efficiency shows an almost opposite trend 4 discussion our simulation results indicate that the structural relationships between the fish body and caudal fin have significant impacts on the propulsive performance of the caudal fin in this section we will analyze and discuss the results from both aspects of flow field structure and force characteristics fig 12 presents a half cycle evolution process of the spanwise vorticity field of the three configurations cf df and sf with s t 0 68 in which the fish tail sways from the top most position a to the bottom most position f the clockwise and counterclockwise vorticity values are plotted in blue and red respectively for the cf and sf configurations a typical reversed von karman vortex pattern can be clearly observed in the wake which has been revealed in previous studies liu and kawachi 1999 schnipper et al 2009 in fig 12 c a the caudal fin is almost located at the top most position of the entire flapping cycle two relatively independent counterclockwise vortexes are formed on the lower side of the foil during the previous upstroke the first vortex is a leading edge vortex lev while the other one is a trailing edge vortex tev with the downward movement of the foil these vortexes move back along the lower surface of the foil in fig 12 c c the tev is about to shed into the wake and then the lev also sheds into the wake in the next stage see fig 12 c d after this happens these two vortexes merge together eventually forming a large counterclockwise vortex in the wake at the same time two clockwise vortexes are created on the upper side and then a similar process occurs again in the next upstroke in fig 12 a and b the spanwise vorticity contours of the cf and df configurations are plotted for the same instants corresponding to the sf configuration in fig 12 c for comparison all contours are plotted in the same value range in fig 12 a the major structures of the wake are similar to those in the sf configuration but there are some distinct differences as shown in fig 12 a the lev which is obvious in the sf configuration is absent whereas the strength of the tev is enhanced intuitively the connection of the fish body and caudal fin may cause the absence of the lev and the undulating motion of the fish body will enhance the strength of the tev in fig 12 b with the separation of the fish body and caudal fin a more complex flow field structure is formed in the wake in fig 12 b b with the downward movement of the fish tail a strong counterclockwise vortex is created at the trailing edge of the fish body the leading edge of the caudal fin collides into this vortex and as a result a clockwise lev is formed on the upper surface of the caudal fin with the further downward movement of the fish tail this induced clockwise lev of the caudal fin is stuck in the middle between the tev of the fish body and the tev of the caudal fin ultimately a complex and broken vorticity structure is created as shown in fig 10 the st has significant impacts on the degree of performance improvement of the caudal fin under the same structural configuration df to understand the performance improving mechanisms of the df configuration two representative st cases s t 0 25 0 68 are chosen for further analysis in fig 13 for both st situations the time histories of the instantaneous thrust coefficient c t transverse force coefficient c y and moment coefficient c m of the df configuration are plotted for comparison the corresponding data of the sf and cf configurations are also given only one period of data which covers the above motion process in fig 12 is depicted the marked time instants ã f correspond to those moving stages in fig 12 a negative value of c t means that the caudal fin generates a net thrust at that moment as shown in fig 13 simple harmonic variation curves of the c t for the sf configuration are observed in both st cases compared to the sf configuration the c t of the cf configuration is drastically reduced in both st cases in contrast a great c t improvement of the df configuration is achieved in the s t 0 25 case meanwhile the c y and c m of this case are both found to decrease this outcome results in an increase in propulsive efficiency in the low st range see fig 8 c however the c t improvement of the df configuration in the s t 0 68 case is limited more interestingly there is a sudden fluctuation in all three coefficients of the df configuration between instants b and d in the s t 0 68 case see fig 13 b this sudden fluctuation phenomenon goes against the performance improvement of the caudal fin the zoomed in views of the instantaneous vorticity field around the caudal fin of the above two st cases s t 0 25 0 68 are presented in fig 14 in both st cases a counterclockwise vortex is formed by the trailing edge of the fish body with the downward movement of the fish tail as a result a clockwise lev is induced on the upper surface of the caudal fin the main difference is that the intensities of these vortexes in the s t 0 25 case are much lower than those in the s t 0 68 case moreover the induced lev has a distinct separation from the upper surface of the caudal fin in the s t 0 68 case see fig 14 b c by contrast the induced lev is always attached to the upper surface of the caudal fin in the lower st case the corresponding pressure contours of both cases are plotted in fig 15 obviously a low pressure region is formed in the location of the induced lev in both st cases as this low pressure region is located on the suction side the upper side of the caudal fin it will increase the thrust corresponding to the distinct separation of the induced lev in the s t 0 68 case see fig 14 b c the separation of the low pressure region is notable see fig 15 b c potentially resulting in the sudden fluctuation phenomenon of hydrodynamic loads in fig 13 b according to the above analysis proper modifications that can alleviate or remove this severe separation of the low pressure region from the suction side of the caudal fin will be helpful for improving the propulsive performance as shown in fig 11 a the case with s t 0 68 and d 1 2 c greatly increases the thrust compared to the df configuration see fig 10 a fig 16 displays the vorticity contours and corresponding pressure distributions of this case during the same motion process fig 16 a shows a significantly different vortex structure from the vortex structure in the df configuration see fig 14 b the major difference is that the caudal fin only moves around the tev of the fish body and hence the induced clockwise lev of the caudal fin moves downward along the surface of the suction side of the caudal fin as a result as shown in fig 16 b the corresponding low pressure region also moves downward along the upper surface of the caudal fin in the whole downstroke the time histories of the instantaneous hydrodynamic coefficients of this case s t 0 68 and d 1 2 c are plotted in fig 17 accompanied by the results of the df and sf configurations with the same st value as shown in fig 17 the sudden fluctuation of the hydrodynamic coefficients that are obvious in the df configuration case are entirely eliminated ultimately a simple harmonic variation curve of c t is observed again in particular the maximum value of c t for the d 1 2 c case is almost doubled compared with that in the df configuration unfortunately the c y and c m of this case are also significantly increased at the same time these increases in the transverse force and pitching moment result in a greater demand of input power see fig 11 b therefore the thrust is effectively increased but the efficiency is decreased see fig 11 c the instantaneous vorticity field superimposed with streamlines of the representative motion stage c in the four cases mentioned above are plotted in fig 18 as the caudal fin moves down water flows in the opposite direction to the caudal fin leading to a positive effective angle of attack the counterclockwise tev of the fish body brings in an upward velocity component that increases the effective angle of attack the induced clockwise lev on the upper side of the caudal fin is attributed to this increased angle of attack as discussed above the enhanced suction pressure caused by this induced clockwise lev results in an increase in thrust this process is similar to the findings of a previous study akhtar and mittal 2005 akhtar et al 2007 furthermore a high st value and a short distance d will lead to an excessive separation of the induced lev as shown in fig 18 c resulting in the sudden fluctuation phenomenon of hydrodynamic loads in contrast a lower st value see fig 18 b or a longer distance d see fig 18 d will alleviate or remove this excessive separation and result in a better thrust increase finally according to the above analysis it is clear that the structural relationships between the fish body and caudal fin can change the flow field structure significantly and thus affect the propulsive performance of the fish caudal fin for a 3d live fish it should be noted that there may be no significant trailing edge effects of the fish body to generate a strong tev even if the finlets are already taken into account however compared with the unseparated caudal fin a distinctly separated fish tail not only significantly improves the propulsive performance of the fish but also provides an opportunity to further improve its performance by exploiting wakes in the flowing water 5 conclusion in the present study a numerical simulation was employed to explore the possible influences of the structural relationships between the fish body and caudal fin on the propulsive performance of fish the thrust and propulsive efficiency of the caudal fin were research priorities three kinds of structural configuration types were considered in addition the effects of distance between the trailing edge of the fish body foil and the leading edge of the caudal fin foil were also studied the results indicated that the structural relationships have significant effects on the propulsive performance of the caudal fin the cf configuration had an adverse impact on both thrust and efficiency within the entire st range compared with the sf configuration in contrast the df configuration significantly improved the thrust and efficiency under certain conditions by analyzing the flow field structure around the caudal fin the movement of the low pressure region caused by the induced lev was found to greatly influence the performance improvement of the caudal fin in addition only within a small range of st s t 0 25 0 35 could the caudal fin achieve a relatively high propulsive efficiency this result is consistent with previous findings in the past couple of decades the effects of vortexes induced by an upstream obstacle on the performance of a downstream fishlike swimmer have been widely studied the researches mentioned above covered the stationary or oscillating bluff body obstacles and the in line tandem or side by side arrangements of multiple swimmers in spite of the biology background and the structure differences a common topic is that how to take advantage of the incoming flow to improve the swimming performance of a swimmer on the whole high thrust occurs when the hind swimmer weaves between the vortices that have been shed by the fore obstacle or swimmer and low thrust occurs when the hind swimmer intercepts these vortices the main conclusions of this paper are as follows 1 a new assumption that aquatic animals that evolved such a distinctly separated tail are also motivated by the need to improve their propulsive performance 2 the undesired excessive separation of the low pressure region from the suction side surface will bring a sudden fluctuation in the hydrodynamic loads of the caudal fin with a suitable structural relationship between the fish body and caudal fin the propulsive performance of the caudal fin can be dramatically improved this conclusion may have direct meaning for the development of biomimetic auvs as mentioned earlier there are obvious limitations to these simplified 2d models another limitation of the current study is that these motions of the fish body and caudal fin do not change with swimming frequency in fact a live fish may change its motion features such as the amplitude of its tail s undulation with different swimming frequencies nudds et al 2014 however despite all of these limitations this research gives a better understanding of fish swimming and provides useful information for the development of biomimetic auvs certainly in the future more physical and comprehensive simulation models and better research methods are required to further studies in addition for fish body designs another important aspect to consider is the need for drag reduction declarations of interest none acknowledgements this work was financially supported by the national natural science foundation of china grant 60904085 foundation of national key laboratory of transient physics and foundation of defence technology innovation special filed 
22707,flow past rectangular cylinders represents an idealized flow around bluff bodies knowing the hydrodynamic properties of rectangular cylinders in a steady flow is of practical importance for many engineering applications although the unbounded flow past rectangular cylinders has been broadly studied investigations on the flow around rectangular cylinders close to the free surface are limited in the present study two dimensional multiphase simulations of flow past rectangular cylinders were conducted using rans the mentor shear stress transport sst k ω model and the volume of fluid vof model were adopted the mentor sst k ω model is capable of accurately predicting the flow past rectangular cylinders near the free surface when the width to length ratio is larger than 0 7 the effect of the depth to length ratio on the hydrodynamic properties of rectangular cylinders is affected by the width to length ratio and becomes significant when the depth to length ratio is lower than 1 0 the effect of the width to length ratio on the flow past rectangular cylinders near the free surface is different from that in an infinite domain the findings from the present study can provide a deep understanding of the hydrodynamic properties of rectangular cylinders close to the free surface keywords rectangular cylinder free surface rans simulation drag lift 1 introduction flow past rectangular cylinders in an infinite domain has been broadly investigated mannini et al 2010 2011 schewe 2013 tian et al 2013 due to its practical importance in engineering applications and scientific significance in fluid mechanics recently research on the flow around rectangular cylinders has been extended to incorporate the effects of asymmetric boundary conditions i e in the vicinity of the free surface this type of flow is relevant for many civil and marine engineering applications e g bridge decks malavasi and guadagnini 2003 offshore platform columns and hydrokinetic turbine blades liu et al 2016 understanding the hydrodynamic behaviors of rectangular cylinders under the effect of the free surface is an important consideration for offshore structure design some studies on the flow past rectangular cylinders close to the free surface have been carried out liu et al 2016 numerically investigated the flow past a plate with a width to length ratio of 0 1 in the vicinity of a free surface they demonstrated that as the depth decreases the wake structures behind the plate become irregular and a jet like flow forms from the surface on top of the plate when the depth is 0 3l where l is the length of the plate similar flow structures have been observed by reichl et al 2005 for a circular cylinder and by mirauda et al 2013 for a sphere mirauda et al 2013 demonstrated that in the extreme case of d 0 the vortex shedding around the sphere is suppressed by the free surface distortion resulting in the enhancement of the vorticity intensity on the side regions of the obstacle liu et al 2016 reported that the drag coefficient of the plate decreases as the depth decreases and a dramatic decrease of the drag coefficient occurs between a depth of 0 6l and 0 5l similar variations of the drag coefficient with the depth were observed in the flow past circular cylinders near the free surface miyata et al 1990 malavasi and guadagnini 2007 experimentally investigated the interaction between the free surface and a submerged rectangular cylinder with the width to length ratio of 3 0 two important factors i e the depth and the elevation from the floor were considered in their study malavasi and guadagnini 2007 reported that when the water depth is fixed at 7 0l the drag coefficient of the rectangular cylinder increases as the depth decreases from 4 5l to 0 while the lift coefficient approximately levels from d 4 5l to d 1 5l and decreases from d 1 5l to d 0 it is found that the variations of the drag and lift coefficients with the depth reported by malavasi and guadagnini 2007 are different from those reported by liu et al 2016 an obvious distinction between the two studies liu et al 2016 miyata et al 1990 is the difference of the width to length ratio which may account for the disagreement the width to length ratio w l where w and l are the width and length of the rectangular cylinder respectively is an important factor affecting the flow structures and force coefficients of rectangular cylinders in a steady flow nakaguchi et al 1968 reported a peak in the drag coefficient at around w l 0 7 and a discontinuity in the strouhal number at around w l 2 8 for the reynolds number ranging from 2 0 104 to 6 0 104 this was also observed by norberg 1993 who carried out wind tunnel experiments 4 0 102 re 3 0 104 and sohankar 2008 who conducted 3d les simulations re 1 0 105 shimada and ishihara 2002 reported two discontinuities in the strouhal number at w l 2 8 and w l 6 0 via using a modified rans k ε model re 2 2 104 they found that the discontinuities in the strouhal number are closely linked with the flow reattachment shimada and ishihara 2002 indicated that as the width to length ratio increases from 0 6 to 8 0 the flow around rectangular cylinders successively shows separated w l 2 8 intermittently reattached 2 8 w l 6 0 and fully reattached 6 0 w l patterns although the effect of the width to length ratio on the flow past rectangular cylinders in an infinite domain has been studied there have been very few investigations on the effect of the width to length ratio when the rectangular cylinder approaches the free surface moreover the effect of the depth to length ratio on the flow past rectangular cylinders with different width to length ratios and the relationship between the effects of the depth to length ratio and the width to length ratio of rectangular cylinders close to a free surface have not been well understood in the present study numerical simulations of flow past rectangular cylinders near the free surface are conducted using the computational fluid dynamics cfd method the reynolds averaged navier stokes rans approach is adopted the turbulence is modeled with the mentor shear stress transport sst k ω model menter 1994 and the free surface evolution is tracked with the volume of fluid vof multiphase model hirt and nichols 1981 the applicability of the mentor sst k ω model menter 1994 in modeling flow around rectangular cylinders near the free surface is discussed the effects of the depth to length ratio d l where d is the distance between the undisturbed surface and the top of the rectangular cylinder and the width to length ratio on the flow structures and force coefficients of rectangular cylinders are analyzed a broad range of depth to length ratios 0 3 4 5 and width to length ratios 0 1 5 0 is considered in the numerical simulations the significant effect of the free surface at d l 1 0 is observed and the existence of the critical depth to length ratio below which the flow is dominated by the free surface effects is identified the effect of the depth to length ratio is found to be closely related to the width to length ratio of the rectangular cylinder the findings from the present study can provide guidance on the multiphase simulations of flow around rectangular cylinders and contribute to the understanding of the hydrodynamic behaviors of structural members with rectangular cross sections located close to the free surface with this understanding the proper depth can be determined for hydrokinetic turbines where the maximum drag force is obtained in order to maximize the power extraction or the force coefficients of offshore platform columns at low depths d l 1 0 can be estimated considering the significant free surface effects 2 rans turbulence model rans simulations using the mentor sst k ω model menter 1994 are conducted in the present study the rans is a feasible solution for turbulence modeling in terms of computational requirements and can provide reasonable predictions for turbulent flows from engineering application perspective the rans has been successfully applied to high reynolds number flows around plates liu et al 2016 and cylinders mannini et al 2010 ong et al 2009 stringer et al 2014 tian et al 2013 the reynolds averaged equations for the conservation of mass and momentum are given by 1 u j x j 0 2 u i t u j u i x j 1 ρ p x i ν 2 u i x j 2 u i u j x j where u i and u i i 1 2 3 denote the mean velocity and fluctuating component of the velocity in the x i direction respectively the averaged products of the fluctuating components u i u j are the reynolds stresses which result from the time averaging of the nonlinear convection terms in the original navier stokes n s equations in order to close the above equations turbulence model is introduced as the first step the unknown reynolds stress components are linearly related to the mean velocity using the boussinesq approximation 3 u i u j ν t u i x j u j x i 2 3 k δ i j where ν t is the turbulent eddy viscosity and k 0 5 u i u i is the turbulent kinetic energy with the approximation the calculation of the reynolds stress is transformed to the computation of the turbulent eddy viscosity in the present study the two equation mentor sst k ω model menter 1994 is used to compute the turbulent eddy viscosity the mentor sst k ω model menter 1994 is a mixture of the wilcox k ω model wilcox 2006 and the standard k ε model jones and launder 1972 and has an improved adverse pressure gradient performance compared to other eddy viscosity models moukalled et al 2015 in the mentor sst k ω model menter 1994 conservation equations of the turbulent kinetic energy k and the turbulent frequency ω are introduced 4 k t u j k x j x j ν ν t σ k k x j 1 ρ p k β k ω 5 ω t u j ω x j x j ν ν t σ ω ω x j c α ω k ν t u i x j u j x i u i x j c β ω 2 2 1 f 1 σ ω 2 1 ω k x j ω x j where p k is the production of the turbulent kinetic energy and is calculated as 6 p k min ρ ν t u i x j u j x i u i x j 10 β ρ k ω the constants in the above equations are calculated by ϕ f 1 ϕ 1 1 f 1 ϕ 2 where ϕ 1 and ϕ 2 are the corresponding constants in the original k ω model and k ε model respectively the blending function f 1 depends on the solution variables and the normal distance of the first internal grid point to the wall and is calculated as 7 f 1 tanh γ 1 4 8 γ 1 min max k β ω y 500 ν y 2 ω 4 ρ σ ω 2 k c d k ω y 2 9 c d k ω max 2 ρ σ ω 2 1 ω k x j ω x j 10 10 with the constants of the original models assigned the following values c α1 0 5532 c β1 0 075 β 0 09 σ k1 2 00 σ ω1 2 00 c α2 0 4403 c β2 0 0828 σ k2 1 00 and σ ω2 1 186 the turbulent eddy viscosity is computed by 10 ν t 0 31 k max 0 31 ω 2 s t f 2 where s t is the magnitude of the strain rate and f 2 is given by f 2 tanh γ 2 2 with γ 2 max 2k 0 5 β ωy 500ν y 2 ω 3 computational overview 3 1 computational domain and boundary conditions two dimensional simulations of flow past rectangular cylinders near the free surface are conducted the schematic of the computational domain and the cartesian coordinate system of the model is drawn in fig 1 as shown in fig 1 the coordinate system is located in the center of the rectangular cylinder and the x axis is aligned with the inlet flow direction the length of the computational domain is 70l which is larger than that by liu et al 2016 the inlet is 20l upstream the cylinder and the outlet is 50l downstream the cylinder the distance between the cylinder and the outlet is believed to be sufficiently large that the outlet effects on the wake structures are negligible liu et al 2016 sohankar 2008 the entire domain is composed of air on the top and water at the bottom the top boundary is 10l away from undisturbed free surface and the bottom is 10l away from the center of the rectangular cylinder the rectangular cylinder is placed below the free surface the distance between the undisturbed surface and the top of the rectangular cylinder denoted by d has a significant impact on the flow structures and force coefficients of the cylinder details of the size of the rectangular cylinder along with other parameters used in the simulations are presented in table 1 the free surface evolution is tracked with the vof method hirt and nichols 1981 in which a fluid volume fraction α is introduced the α is bounded between 0 and 1 with α 1 representing water α 0 representing air and 0 α 1 representing the air water interface the transport equation of the volume fraction is given by 11 α t u j α x j 0 the fluid domain boundaries include the inlet s i the outlet s o the atmosphere s a the bottom s b and the structural surface s s the boundary conditions for the present simulations are shown in fig 1 at the inlet a constant velocity u 1 u is imposed and k and ω are calculated by 12 k 1 5 u i 2 13 ω k 0 5 c μ 0 25 l where i 5 is the turbulence intensity and l 0 07l is the turbulence length the empirical constant c μ is 0 09 in the near wall region i e near the surface of the rectangular cylinder and at the bottom if the flow is to be resolved a considerable number of grid points will be required due to the large gradients of velocity wall functions are used in the near wall region in the present simulations with the use of wall functions the turbulence model avoids the need to integrate all the way to the wall the first internal grid point is placed in the logarithmic layer 11 06 y 200 00 the empirical relations moukalled et al 2015 in this layer are given by 14 u 1 κ l n y b 15 k 1 c μ 16 ω ν μ τ κ y c μ where κ 0 41 is the von karman constant and b is 5 25 y yμ τ ν u u u τ k k u τ 2 and ω ων u τ 2 represent the normalized distance to the wall the normalized velocity parallel to the wall the normalized turbulent kinetic energy and the normalized turbulent frequency respectively y is the normal distance from the first internal grid point to the wall and μ τ is the friction velocity expressed in terms of the wall shear stress τ ω as μ τ τ w ρ 0 5 3 2 numerical methods the continuity and reynolds averaged n s equations the transport equation of volume fraction and the turbulence model equations are discretized using the finite volume method fvm performed in the open source package openfoam the fvm is implemented by integrating each term in the equations over a control volume and relating the volume integrals to the surface integrals using gauss s theorem the surface and volume integrals are both evaluated with the mid point integration approximation which yields second order accuracy values at cell centers are linearly interpolated to values at face centers the laplacian and divergence terms are treated with the gaussian linear corrected and gaussian linear schemes respectively the second order crank nicolson cn scheme is used for the time integration the discretized equations are solved with the pimple algorithm which is a hybrid of the piso and simple algorithms the principal of the algorithm is as follows holzmann 2016 within each time step both the inner pressure correction loop piso loop and outer pressure momentum correction loop simple loop are executed in the inner loop the pressure is recalculated with the new updated flux in the outer loop the velocity matrix is first rebuilt with the new flux the pressure is then corrected with the new velocity matrix and the flux is finally corrected with the new pressure the calculations are repeated until convergence is achieved in the present simulations three inner loops and three outer loops are executed within each time step the solutions are regarded as being converged when the final residuals of the velocity and pressure are lower than 1e 06 3 3 grid convergence study the meshes are generated by an algebraic method with the prediction that significant vortex generations occur near the rectangular cylinder grid points are intentionally clustered around the surface of the cylinder and stretch out gradually the medium mesh for the case of d l 4 5 and w l 5 0 is presented in fig 2 as shown in fig 2 the grid is fully orthogonal and dense areas of the grid points appear in the region near the rectangular cylinder and the free surface the grid convergence study is conducted for four cases d l 0 3 and w l 1 0 d l 0 3 and w l 5 0 d l 4 5 and w l 1 0 d l 4 5 and w l 5 0 details of the meshes are presented in table 2 the cases with subscripts 1 2 and 3 represent coarse medium and fine meshes respectively the drag and lift coefficients of rectangular cylinders are defined as 17 c d f d 0 5 ρ u 2 l 18 c l f l 0 5 ρ u 2 w where f d and f l are the streamwise and cross stream forces acting on the rectangular cylinder per unit length in the x 2 direction respectively the root mean square r m s value of the lift coefficient is calculated as 19 c l r m s c l 1 2 c l 2 2 c l 3 2 c l n 2 n the drag and lift coefficients as functions of time for the cases with w l 5 0 are shown in fig 3 it is seen that the flow becomes stable after 300s when the depth is 0 3l while the stable flow emerges after 200s at the depth of 4 5l the same situations happen for the cases with w l 1 0 it seems that at low depth to length ratios the flow takes a longer time to reach a stable condition in the present study the time averaged drag and lift coefficients are calculated over the time period 300s 400s and 200s 300s when d l is lower and higher than 1 0 respectively results of the convergence study are shown in table 2 as shown in table 2 the differences of the drag coefficient and strouhal number obtained with medium and fine meshes are generally below 1 for the r m s value of the lift coefficient a relatively large difference exists between the results obtained with three mesh densities mostly around 3 in the present study simulations with medium mesh densities are chosen for all the cases in consideration of the tradeoff between accuracy and computing time it is noted that the distance of the first internal grid point to the wall denoted by y is selected to be 0 025l at the surface of the rectangular cylinder and 0 050l at the bottom the averaged y around the surface of the rectangular cylinder for meshes a2 b2 c2 and d2 are 17 8 15 9 18 2 and 11 8 respectively indicating that the first internal grid points are generally located in the logarithmic layer 4 results and discussion 4 1 applicability of the rans turbulence model in order to study the applicability of the mentor sst k ω model menter 1994 in modeling flow past rectangular cylinders the predicted hydrodynamic results of this study are compared with the published results mizota et al 1988 nakaguchi et al 1968 ohtsuki 1978 sakamoto et al 1989 sohankar 2008 tamura and itoh 1996 the drag and lift coefficients are calculated by eq 17 and eq 18 the strouhal number is defined as st fl u where f denotes the vortex shedding frequency both the results obtained from the single phase and multiphase simulations are presented in fig 4 a c in the multiphase simulations the rectangular cylinder is placed at a depth of 4 5l below the water surface with d l equal to 4 5 the influence of the free surface on the force coefficients of rectangular cylinders is considered to be negligible malavasi and guadagnini 2007 the drag coefficient of the rectangular cylinder with different width to length ratios is depicted in fig 4 a as shown in fig 4 a the peak in the drag coefficient at around w l 0 7 is acquired through both the experiments mizota et al 1988 nakaguchi et al 1968 and simulations sohankar 2008 tamura and itoh 1996 fig 4 a shows that the drag coefficient predicted by using the single phase model agrees well with the published results when w l is between 0 7 and 5 0 this is consistent with that reported by tian et al 2013 fig 4 a also shows that the drag coefficient obtained from the multiphase simulations is in good agreement with the published results when w l is between 0 7 and 5 0 however when w l is lower than 0 7 the predicted drag coefficient is larger than both the experimental and numerical results the overestimation probably stems from the adoption of 2d modeling with which the significant three dimensional effects at low width to length ratios are neglected mannini et al 2010 shur et al 2005 fig 4 b shows that the r m s value of the lift coefficient decreases and the rate of decline decreases as w l increases from 0 7 to 5 0 however when w l is lower than 0 7 the r m s value increases with w l this variation trend is roughly captured via adopting the mentor sst k ω model menter 1994 in both the single phase and multiphase simulations however when w l is lower than 0 7 the r m s value of the lift coefficient is overpredicted by using the k ω model it indicates that the multiphase simulations with the mentor sst k ω model menter 1994 are incapable of accurately predicting the force coefficients of rectangular cylinders when w l 0 7 fig 4 c shows that the strouhal number obtained from both the single phase and multiphase simulations is in good agreement with the published results nakaguchi et al 1968 sakamoto et al 1989 sohankar 2008 tamura and itoh 1996 the discontinuity in the strouhal number appearing at around w l 2 8 is acquired by the present rans simulations it indicates that the flow past rectangular cylinders is reasonably reproduced via using the mentor sst k ω model menter 1994 in order to study the flow structures the flow around rectangular cylinders is visualized by vorticity contours as depicted in fig 5 the vorticity contours are obtained from the multiphase simulations and are plotted at 16 levels of ω 2 2 5 s 1 5 0 s 1 7 5 s 1 10 0 s 1 12 5 s 1 15 0 s 1 17 5 s 1 20 0 s 1 the solid and dashed contour lines represent the positive and negative vorticity contours respectively the vorticity component in the x 2 direction is defined as 20 ω 2 u 1 x 3 u 3 x 1 flow visualizations depicted in fig 5 are in agreement with those reported by shimada and ishihara 2002 fig 5 a d show that when w l is lower than 2 5 the rectangular cylinder is immersed in the separated flow region no flow reattachment is displayed due to the small widths of the cross sections fig 5 a d also show that as w l increases from 1 0 to 2 5 the location of the vortex behind the rectangular cylinder moves further downstream and the vortex becomes weaker this is an illustration of the decrease of the strouhal number when w l increases from 1 0 to 2 5 as shown in fig 4 c it is seen from fig 5 e i that when w l falls between 3 0 and 5 0 the flow separating from the upper and lower corners of the leading edge reattaches the side surfaces of the rectangular cylinder a substantial change of the flow occurs as w l increases from 2 5 to 3 0 with the change of the flow the vortex shedding frequency rises suddenly resulting in the discontinuity in the strouhal number see fig 4 c the force coefficients of the square obtained from the present multiphase simulations are compared with the published results lyn et al 1995 bosch and rodi 1998 farhadi and rahnama 2005 murakami and mochida 1995 shimada and ishihara 2002 tian et al 2013 as shown in table 3 the predicted drag coefficient and r m s value of the lift coefficient agree well with the numerical results by farhadi and rahnama 2005 and murakami and mochida 1995 respectively however it is seen that there are discrepancies between the predicted drag and lift coefficients of this study and the results reported by lyn et al 1995 tian et al 2013 bosch and rodi 1998 and shimada and ishihara 2002 the differences between the results are probably due to the different settings in the experimental or numerical studies e g the spanwise extension and blockage ratio table 3 also shows that the predicted strouhal number of this study is in good agreement with the published results 4 2 effect of the depth to length ratio the effect of the depth to length ratio on the hydrodynamic properties of rectangular cylinders with width to length ratios of 1 0 and 3 0 is discussed in this section as mentioned above the unbounded flow past rectangular cylinders with width to length ratios of 1 0 and 3 0 shows separated and intermittently reattached patterns respectively shimada and ishihara 2002 as the rectangular cylinder approaches the water surface the free surface effects on the cylinder with the two w l values are different as will be presented in the following paragraphs the drag coefficient of the rectangular cylinder at various depth to length ratios is depicted in fig 6 a as shown in fig 6 a when w l is 1 0 the drag coefficient increases as d l decreases from 4 5 to 0 8 and drops sharply when d l decreases from 0 8 to 0 5 then the drag coefficient increases slightly with d l decreasing from 0 5 to 0 3 the maximum drag coefficient c d 2 757 appears at the depth of 0 8l and is distinctly larger than that c d 2 233 at d l 4 5 however when w l is 3 0 the drag coefficient increases as d l decreases from 4 5 to 1 0 followed by a gentle reduction when d l decreases from 1 0 to 0 8 the drag coefficient increases again as d l decreases from 0 8 to 0 3 during which the growth rate of the drag coefficient is larger than that when d l decreases from 4 5 to 1 0 it is predicted that the maximum drag coefficient of the rectangular cylinder w l 3 0 will be obtained in the extreme case of d 0 fig 6 a also reveals that the variation trends of the drag coefficient with d l at the two w l values are similar but the amplitudes of variation and the corresponding ranges of d l values are different these differences are likely attributed to the different intensities of interaction between the free surface and the rectangular cylinder at w l 1 0 and w l 3 0 as discussed previously the flow past rectangular cylinders with width to length ratios of 1 0 and 3 0 in an infinite domain shows separated and intermittently reattached patterns respectively shimada and ishihara 2002 when the cylinder approaches a water surface the interaction between the free surface and the vortex shedding past the rectangular cylinder varies with the w l value leading to the different variations of the drag coefficient with d l the predicted results for the drag coefficient at w l 3 0 of this study are compared with the experimental results by malavasi and guadagnini 2007 it is found that the present predicted drag coefficient is generally lower than that by malavasi and guadagnini 2007 at the same depth to length ratios this is due to the different sizes of the rectangular cylinder in the two studies in order to make comparisons between the results the froude number fr u gd 0 5 which allows the sole effect of the free surface to be examined is used as the x coordinate as shown in fig 7 a the drag coefficient obtained from the present rans simulations agrees well with the experimental results malavasi and guadagnini 2007 at fr 0 4 however when fr is larger than 0 4 the predicted drag coefficient is evidently smaller than the results by malavasi and guadagnini 2007 this is due to the different blockage ratios adopted in the present simulations 9 3 and by malavasi and guadagnini 2007 14 3 fig 6 b shows the variations of the lift coefficient with the depth to length ratio it is seen from fig 6 b that when w l is 1 0 the lift coefficient varies slightly as d l decreases from 4 5 to 1 5 and descends suddenly when d l decreases from 1 5 to 1 0 the lift coefficient undergoes a sharp rise and fall as d l decreases from 1 0 to 0 3 with the peak emerging at d l 0 6 similar variations of the lift coefficient with d l can be seen when w l is 3 0 excepting that the lift coefficient decreases as d l decreases from 4 5 to 1 5 it is important to note that the lift coefficient at both values of w l w l 1 0 and w l 3 0 varies remarkably in the d l range from 1 0 to 0 3 specifically the sharp rise of the lift coefficient begins at d l 1 0 and ends at d l 0 6 when w l is 1 0 while when w l is 3 0 the lift coefficient starts rising at d l 1 0 and peaks at d l 0 8 it implies that the free surface effects become significant when the depth of the rectangular cylinder is lower than 1 0l this is also reflected by the dramatic decrease of the r m s value of the lift coefficient in the corresponding d l ranges as shown in fig 6 c the sudden fall of the lift coefficient occurs in the d l ranges from 0 6 to 0 3 and from 0 8 to 0 3 for rectangular cylinders with width to length ratios of 1 0 and 3 0 respectively at these d l ranges the vortex shedding around the rectangular cylinder is totally different from that in an infinite domain as will be discussed later moreover the predicted lift coefficient at w l 3 0 of the present study is compared with the experimental results by malavasi and guadagnini 2007 and the results match well with each other as shown in fig 7 b fig 6 d shows that for most depth to length ratios the strouhal number varies slightly with d l the dramatic variation of the strouhal number occurs at around the depth of 0 6l and 0 9l for rectangular cylinders with width to length ratios of 1 0 and 3 0 respectively it indicates a substantial change of the flow at the two depths and explains well the sharp rise of the lift coefficient with decreasing d l at around the two depths the relatively low values of strouhal number in the d l ranges from 0 5 to 0 3 and from 0 8 to 0 3 for rectangular cylinders at w l 1 0 and w l 3 0 imply that at these d l ranges the free surface effects play a dominant role on the vortex shedding around rectangular cylinders and the flow is totally different from that in an infinite domain fig 8 and fig 9 show the frequency distribution of the lift force for the cases with w l 1 0 and w l 3 0 at various depth to length ratios respectively it is seen that the peak frequency varies dramatically as d l decreases from 0 6 to 0 5 when w l is 1 0 and from 0 9 to 0 8 when w l is 3 0 this is in accordance with the variation of the strouhal number with d l see fig 6 d it is also observed that at low depth to length ratios the second largest peak is noticeable these frequency values are depicted with mark symbols in fig 6 d as shown in fig 6 d the resultant strouhal number of the second frequency at low d l values approximates that at high d l values it reflects the fact that the flow around rectangular cylinders near a free surface partly retains the features of the unbounded flow past rectangular cylinders although the vortex shedding is markedly suppressed by the free surface distortion as indicated by the reduced amplitude of the second largest peak the vorticity contours around the rectangular cylinder at various depth to length ratios are depicted in fig 10 and fig 11 the black thick lines above the rectangular cylinder represent the free surface in the figures by comparing fig 10 e to fig 5 a it is observed that the flow around the rectangular cylinder w l 1 0 at the depth of 1 0l is similar to that in an infinite domain however the vortices shed along the upper surface of the square are pressed due to the presence of the free surface reciprocally the free surface on top of the square fluctuates slightly this demonstrates the weak interaction between the free surface and the square as d l decreases from 1 0 to 0 6 the interaction between the free surface and the square becomes stronger as shown in fig 10 c e with the approaching of the free surface the vorticity contours above the square are flattened and fluctuations of the free surface increase meanwhile the vortex shedding frequency rises as is reflected by the shortened distance between the successively shed positive or negative vortices it results in the increase of the strouhal number when d l decreases from 1 0 to 0 6 as shown in fig 6 d fig 10 a and b show that when the square is submerged at the depth of 0 3l and 0 5l the flow around the square is completely different from that in an infinite domain as shown in fig 10 a and b the vortices shed from the upper corner of the leading edge are significantly pressed and the vortices generated at the lower corner of the leading edge are shed in a direction away from the lower surface of the square with the vorticity contours elongated the vortex shedding frequency drops leading to the drastic reduction of the strouhal number as d l decreases from 0 6 to 0 5 see fig 6 d the vorticity contours around the rectangular cylinder w l 3 0 at various depth to length ratios are shown in fig 11 it is seen from fig 11 e that when d l is 1 0 the flow around the rectangular cylinder reattaches the upper and lower surfaces this is similar to that in an infinite domain see fig 5 e except that the vortices above the rectangular cylinder are pressed under the effect of the free surface fig 11 d shows that when d l is 0 9 positive vortices are generated at both the upper and lower corners of the trailing edge causing the negative vortices under the rectangular cylinder to separate from the lower surface as d l decreases from 0 9 to 0 8 the free surface effects become more significant fig 11 c shows that the vorticity contours along the upper surface are flattened and lengthened and the vorticity contours along the lower surface are forced to stretch downward away from the rectangular cylinder it is observed that the flow above the rectangular cylinder reattaches the upper surface while the flow below the rectangular cylinder separates from the lower corner of the leading edge without reattaching the lower surface this causes the drop in vortex shedding frequency leading to a dramatic decrease in strouhal number see fig 6 d fig 11 a c show that as d l decreases from 0 8 to 0 3 the flow around the rectangular cylinder experiences small changes with the vorticity contours shortened slightly distributions of the time averaged vorticity on the surfaces of the rectangular cylinder are depicted in fig 12 the distance x is measured from the center of the leading edge around the surface of the rectangular cylinder in the clockwise direction the dashed curves represent the cases when the free surface effects play a dominant role as discussed above fig 12 a shows that the vorticity distributions on the leading edge 0 x 0 5 3 5 x 4 0 and lower surface 2 5 x 3 5 of the square have small differences as d l decreases from 1 0 to 0 3 however on the upper surface 0 5 x 1 5 and trailing edge 1 5 x 2 5 distributions of the vorticity vary significantly as d l varies as shown in fig 12 a with the decrease of d l the vorticity on the upper surface vary from negative values to positive values and the vorticity on the trailing edge decrease in magnitude it is seen that when d l is 0 3 and 0 5 the vorticity distributions around the square are different from those at other d l values this indicates the change of the flow as shown in fig 10 similar phenomenon can be observed when w l is 3 0 as shown in fig 12 b the vorticity distributions on the upper surface 0 5 x 3 5 and trailing edge 3 5 x 4 5 at d l 0 3 d l 0 7 and d l 0 8 are different from those at d l 0 9 and d l 1 0 the results are appropriate reflections of the flow variations with the depth as shown in fig 11 based on the above discussions it is predicted that there exists a critical depth to length ratio below which the flow around rectangular cylinders is dominated by the free surface effects as demonstrated by the flow visualizations when d l is larger than the critical value the flow past rectangular cylinders shares similar features to those in an infinite domain however when d l is lower than that value totally different features of the flow are displayed discussions on the vorticity distributions around the rectangular cylinder at various depths confirm the prediction moreover the critical depth to length ratio is found to be related to the width to length ratio of the rectangular cylinder as presented above the critical depth to length ratios for the rectangular cylinder with width to length ratios of 1 0 and 3 0 are in the ranges from 0 5 to 0 6 and from 0 8 to 0 9 respectively a deep investigation on the relationship between the critical depth to length ratio and the width to length ratio is not carried out in the present study and is left for future works 4 3 effect of the width to length ratio the effect of the width to length ratio on the flow past rectangular cylinders near the free surface is discussed in this section two depths 0 3l and 0 6l of rectangular cylinders are considered as discussed in the previous section 0 6 approximates the critical depth to length ratio for the rectangular cylinder with the width to length ratio of 1 0 the force coefficients of the rectangular cylinder with different width to length ratios are shown in fig 13 the results for the cases with d l 4 5 are also presented as shown in fig 13 a when d l is 0 3 the drag coefficient decreases linearly as w l increases from 0 6 to 5 0 the variation trend is markedly different from that of the case wth d l 4 5 it is anticipated that due to the strong free surface effects the flow around rectangular cylinders at the depth of 0 3l is totally different from that in an infinite domain when d l is 0 6 the variations of the drag coefficient have different characteristics in different w l ranges as w l increases from 0 6 to 1 5 the drag coefficient drops sharply and the curve approximates that of the cases with d l 4 5 the small differences between the results at d l 0 6 and d l 4 5 are most probably due to the presence or absence of the free surface effects as w l increases from 1 5 to 5 0 the drag coefficient decreases slowly with the declining curve paralleled to that of the cases with d l 0 3 it indicates that when the rectangular cylinder is located at the depth of 0 6l the interaction between the free surface and the vortex shedding is dramatically enhanced when w l is larger than 1 5 fig 13 b shows that when d l is 0 3 the lift coefficient decreases as w l increases from 0 6 to 5 0 it is markedly different from that of the cases with d l 4 5 in which the lift coefficient varies slightly with w l when d l is 0 6 the variations of the lift coefficient are different in different w l ranges as shown in fig 13 b when w l is lower than 1 5 the lift coefficient varies slightly as w l increases which is similar to that of the cases with d l 4 5 when w l is larger than 1 5 the lift coefficient decreases with w l with the declining curve paralleled to that of the cases with d l 0 3 the distinct variation trends of the force coefficients in different w l ranges at d l 0 6 can also be observed in the variations of the r m s value of the lift coefficient as shown in fig 13 c it is worth noting that the behaviors of the lift coefficient under varying w l at the two depths d 0 3l and d 0 6l are in accordance with those of the drag coefficient therefore it is reasonable to predict that when d l is 0 3 the interaction between the free surface and the rectangular cylinder is strong in the whole w l range from 0 6 to 5 0 and the flow is dominated by the free surface effects due to this dominance the variation trends of both the drag and lift coefficients with w l are remarkably different from those when the rectangular cylinder is deeply submerged d l 4 5 however when d l is 0 6 the flow past rectangular cylinders is dominated by the free surface effects only at w l 1 5 when w l is lower than 1 5 the interaction between the free surface and the rectangular cylinder is relatively less significant and the features of the vortex shedding flow in an infinite domain are retained this provides a good explanation for the different variation trends of the drag and lift coefficients in the two w l ranges i e from 0 6 to 1 5 and from 1 5 to 5 0 fig 13 d shows the variations of the strouhal number with the width to length ratio as shown in fig 13 d when d l is 0 3 the strouhal number remains at a relatively low value st 0 080 when w l increases from 0 6 to 5 0 this variation trend differs notably from that of the cases with d l 4 5 in particular the discontinuity in the strouhal number at around w l 2 8 is not present when the depth is 0 3l observations on the flow structures reveal that throughout the whole w l range from 0 6 to 5 0 the flow past rectangular cylinders located at the depth of 0 3l displays totally different features from those in an infinite domain examples of this flow are shown in figs 10 a and fig 11 a it is important to note that st 0 080 represents a typical characteristic of the vortex shedding suppressed by the free surface distortion and can be used to identify the presence or absence of the dominance of the free surface effects fig 13 d also shows that when d l is 0 6 the strouhal number varies slightly as w l increases from 0 6 to 1 0 and decreases sharply as w l increases from 1 0 to 1 5 when w l is larger than 1 5 the strouhal number roughly remains at a value close to 0 080 it indicates that the free surface effects become dominant at w l 1 5 observations on the flow structures confirm that when the depth is 0 6l the flow past rectangular cylinders resembles that in an infinite domain at w l 1 0 and is dominated by the free surface effects at w l 1 5 fig 14 shows the time averaged streamwise component of the velocity at two locations x 2 5l and x 10 0l downstream the rectangular cylinder the distance x is measured from the center of the trailing edge as shown in fig 14 a and b the variations of the streamwise velocity with the depth at x 2 5l and x 10 0l are different the sharp decrease of the streamwise velocity at x 2 5l as y l varies from 0 5 to 0 5 indicates that it is located in the recirculation region behind the rectangular cylinder it is also seen from fig 14 a and b that the streamwise velocity at different w l values varies similarly with the depth this demonstrates that the flow around the rectangular cylinder at the depth of 0 3l shares similar features as w l increases from 0 6 to 5 0 when d l is 0 6 the variations of the streamwise velocity with the depth change as w l changes as shown in fig 14 c and d the streamwise velocity at x 2 5l and x 10 0l experiences a sudden change as w l increases from 1 0 to 2 0 it is in accordance with the change of the flow past the rectangular cylinder at around w l 1 5 as mentioned above variations of the time averaged vorticity with the depth at two locations x 0 5l and x 1 5l downstream the rectangular cylinder are also studied fig 15 a and b show that when d l is 0 3 the vorticity decrease sharply from a relatively large positive value to about zero as y l varies from 0 5 to 0 5 and decrease further as y l varies from 0 5 to 1 0 similar variations of the vorticity with the depth can be seen in fig 15 c and d at w l 2 0 this corresponds to the flow which is strongly affected by the free surface however when w l is 0 6 and 1 0 the time averaged vorticity shows positive and negative values behind the rectangular cylinder at x 0 5l and x 1 5l respectively it is a demonstration of the periodic vortex shedding which is typical for flow past rectangular cylinders in an infinite domain 5 conclusions flow past rectangular cylinders in the vicinity of the free surface was investigated in the present study two dimensional rans simulations using the mentor sst k ω model were conducted the applicability of the mentor sst k ω model in modeling flow around rectangular cylinders near the free surface was first discussed the effects of the depth to length ratio and the width to length ratio on the hydrodynamic properties of rectangular cylinders were then analyzed the following conclusions were drawn 1 multiphase simulations based on the mentor sst k ω model can provide reasonable predictions of the force coefficients of rectangular cylinders close to the free surface when w l is larger than 0 7 the flow around rectangular cylinders at various width to length ratios from 1 0 to 5 0 can be reasonably reproduced via using the mentor sst k ω model 2 the effect of the depth to length ratio on the hydrodynamic properties of rectangular cylinders is affected by the width to length ratio variations of the drag and lift coefficients and the strouhal number with d l are similar for rectangular cylinders with width to length ratios of 1 0 and 3 0 but the amplitudes of variation and the corresponding ranges of d l values are different specifically the maximum drag coefficient c d 2 757 of the rectangular cylinder w l 1 0 appears at the depth of 0 8l while the maximum drag coefficient at w l 3 0 is predicted to emerge in the extreme case of d 0 3 the free surface effects on the flow past rectangular cylinders become significant when the depth is lower than 1 0l this is reflected by the sharp rise of the lift coefficient in the d l ranges from 1 0 to 0 6 and from 1 0 to 0 8 for rectangular cylinders with width to length ratios of 1 0 and 3 0 respectively the substantial change of the flow occurs at around the depth of 0 6l and 0 9l for rectangular cylinders with width to length ratios of 1 0 and 3 0 respectively the relatively low values of strouhal number in the d l ranges from 0 5 to 0 3 and from 0 8 to 0 3 for rectangular cylinders at w l 1 0 and w l 3 0 imply that at these d l ranges the free surface effects play a dominant role on the vortex shedding around rectangular cylinders 4 there exists a critical depth to length ratio for rectangular cylinders located near the free surface when d l is larger than the critical value the flow past rectangular cylinders shares similar features to those in an infinite domain however when d l is lower than that value the flow becomes dominated by the free surface effects the critical depth to length ratios for the rectangular cylinder with width to length ratios of 1 0 and 3 0 locate in the ranges from 0 5 to 0 6 and from 0 8 to 0 9 respectively the relationship between the critical depth to length ratio and the width to length ratio remains to be investigated 5 the effect of the width to length ratio on the flow past rectangular cylinders close to the free surface is different from that in an infinite domain when d l is 0 3 the flow past rectangular cylinders is dominated by the free surface effects throughout the whole w l range from 0 6 to 5 0 and the variation trends of the force coefficients are remarkably different from those in an infinite domain a typical characteristic of the vortex shedding suppressed by the free surface distortion is the low strouhal number st 0 080 which can be used to identify the presence or absence of the dominance of the free surface effects when d l is 0 6 the variations of the force coefficients have different characteristics at w l 1 0 and w l 1 5 and the change of the variation trends at w l 1 5 corresponds to the substantial change of the flow acknowledgement this work is supported by national natural science foundation of china nsfc and china scholarship council csc these supports are gratefully acknowledged the first author also acknowledges the support from the school of civil and construction engineering at oregon state university where the first author is a visiting doctorate student appendix a supplementary data the following is the supplementary data to this article multimedia component 1 multimedia component 1 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j oceaneng 2019 106118 
22707,flow past rectangular cylinders represents an idealized flow around bluff bodies knowing the hydrodynamic properties of rectangular cylinders in a steady flow is of practical importance for many engineering applications although the unbounded flow past rectangular cylinders has been broadly studied investigations on the flow around rectangular cylinders close to the free surface are limited in the present study two dimensional multiphase simulations of flow past rectangular cylinders were conducted using rans the mentor shear stress transport sst k ω model and the volume of fluid vof model were adopted the mentor sst k ω model is capable of accurately predicting the flow past rectangular cylinders near the free surface when the width to length ratio is larger than 0 7 the effect of the depth to length ratio on the hydrodynamic properties of rectangular cylinders is affected by the width to length ratio and becomes significant when the depth to length ratio is lower than 1 0 the effect of the width to length ratio on the flow past rectangular cylinders near the free surface is different from that in an infinite domain the findings from the present study can provide a deep understanding of the hydrodynamic properties of rectangular cylinders close to the free surface keywords rectangular cylinder free surface rans simulation drag lift 1 introduction flow past rectangular cylinders in an infinite domain has been broadly investigated mannini et al 2010 2011 schewe 2013 tian et al 2013 due to its practical importance in engineering applications and scientific significance in fluid mechanics recently research on the flow around rectangular cylinders has been extended to incorporate the effects of asymmetric boundary conditions i e in the vicinity of the free surface this type of flow is relevant for many civil and marine engineering applications e g bridge decks malavasi and guadagnini 2003 offshore platform columns and hydrokinetic turbine blades liu et al 2016 understanding the hydrodynamic behaviors of rectangular cylinders under the effect of the free surface is an important consideration for offshore structure design some studies on the flow past rectangular cylinders close to the free surface have been carried out liu et al 2016 numerically investigated the flow past a plate with a width to length ratio of 0 1 in the vicinity of a free surface they demonstrated that as the depth decreases the wake structures behind the plate become irregular and a jet like flow forms from the surface on top of the plate when the depth is 0 3l where l is the length of the plate similar flow structures have been observed by reichl et al 2005 for a circular cylinder and by mirauda et al 2013 for a sphere mirauda et al 2013 demonstrated that in the extreme case of d 0 the vortex shedding around the sphere is suppressed by the free surface distortion resulting in the enhancement of the vorticity intensity on the side regions of the obstacle liu et al 2016 reported that the drag coefficient of the plate decreases as the depth decreases and a dramatic decrease of the drag coefficient occurs between a depth of 0 6l and 0 5l similar variations of the drag coefficient with the depth were observed in the flow past circular cylinders near the free surface miyata et al 1990 malavasi and guadagnini 2007 experimentally investigated the interaction between the free surface and a submerged rectangular cylinder with the width to length ratio of 3 0 two important factors i e the depth and the elevation from the floor were considered in their study malavasi and guadagnini 2007 reported that when the water depth is fixed at 7 0l the drag coefficient of the rectangular cylinder increases as the depth decreases from 4 5l to 0 while the lift coefficient approximately levels from d 4 5l to d 1 5l and decreases from d 1 5l to d 0 it is found that the variations of the drag and lift coefficients with the depth reported by malavasi and guadagnini 2007 are different from those reported by liu et al 2016 an obvious distinction between the two studies liu et al 2016 miyata et al 1990 is the difference of the width to length ratio which may account for the disagreement the width to length ratio w l where w and l are the width and length of the rectangular cylinder respectively is an important factor affecting the flow structures and force coefficients of rectangular cylinders in a steady flow nakaguchi et al 1968 reported a peak in the drag coefficient at around w l 0 7 and a discontinuity in the strouhal number at around w l 2 8 for the reynolds number ranging from 2 0 104 to 6 0 104 this was also observed by norberg 1993 who carried out wind tunnel experiments 4 0 102 re 3 0 104 and sohankar 2008 who conducted 3d les simulations re 1 0 105 shimada and ishihara 2002 reported two discontinuities in the strouhal number at w l 2 8 and w l 6 0 via using a modified rans k ε model re 2 2 104 they found that the discontinuities in the strouhal number are closely linked with the flow reattachment shimada and ishihara 2002 indicated that as the width to length ratio increases from 0 6 to 8 0 the flow around rectangular cylinders successively shows separated w l 2 8 intermittently reattached 2 8 w l 6 0 and fully reattached 6 0 w l patterns although the effect of the width to length ratio on the flow past rectangular cylinders in an infinite domain has been studied there have been very few investigations on the effect of the width to length ratio when the rectangular cylinder approaches the free surface moreover the effect of the depth to length ratio on the flow past rectangular cylinders with different width to length ratios and the relationship between the effects of the depth to length ratio and the width to length ratio of rectangular cylinders close to a free surface have not been well understood in the present study numerical simulations of flow past rectangular cylinders near the free surface are conducted using the computational fluid dynamics cfd method the reynolds averaged navier stokes rans approach is adopted the turbulence is modeled with the mentor shear stress transport sst k ω model menter 1994 and the free surface evolution is tracked with the volume of fluid vof multiphase model hirt and nichols 1981 the applicability of the mentor sst k ω model menter 1994 in modeling flow around rectangular cylinders near the free surface is discussed the effects of the depth to length ratio d l where d is the distance between the undisturbed surface and the top of the rectangular cylinder and the width to length ratio on the flow structures and force coefficients of rectangular cylinders are analyzed a broad range of depth to length ratios 0 3 4 5 and width to length ratios 0 1 5 0 is considered in the numerical simulations the significant effect of the free surface at d l 1 0 is observed and the existence of the critical depth to length ratio below which the flow is dominated by the free surface effects is identified the effect of the depth to length ratio is found to be closely related to the width to length ratio of the rectangular cylinder the findings from the present study can provide guidance on the multiphase simulations of flow around rectangular cylinders and contribute to the understanding of the hydrodynamic behaviors of structural members with rectangular cross sections located close to the free surface with this understanding the proper depth can be determined for hydrokinetic turbines where the maximum drag force is obtained in order to maximize the power extraction or the force coefficients of offshore platform columns at low depths d l 1 0 can be estimated considering the significant free surface effects 2 rans turbulence model rans simulations using the mentor sst k ω model menter 1994 are conducted in the present study the rans is a feasible solution for turbulence modeling in terms of computational requirements and can provide reasonable predictions for turbulent flows from engineering application perspective the rans has been successfully applied to high reynolds number flows around plates liu et al 2016 and cylinders mannini et al 2010 ong et al 2009 stringer et al 2014 tian et al 2013 the reynolds averaged equations for the conservation of mass and momentum are given by 1 u j x j 0 2 u i t u j u i x j 1 ρ p x i ν 2 u i x j 2 u i u j x j where u i and u i i 1 2 3 denote the mean velocity and fluctuating component of the velocity in the x i direction respectively the averaged products of the fluctuating components u i u j are the reynolds stresses which result from the time averaging of the nonlinear convection terms in the original navier stokes n s equations in order to close the above equations turbulence model is introduced as the first step the unknown reynolds stress components are linearly related to the mean velocity using the boussinesq approximation 3 u i u j ν t u i x j u j x i 2 3 k δ i j where ν t is the turbulent eddy viscosity and k 0 5 u i u i is the turbulent kinetic energy with the approximation the calculation of the reynolds stress is transformed to the computation of the turbulent eddy viscosity in the present study the two equation mentor sst k ω model menter 1994 is used to compute the turbulent eddy viscosity the mentor sst k ω model menter 1994 is a mixture of the wilcox k ω model wilcox 2006 and the standard k ε model jones and launder 1972 and has an improved adverse pressure gradient performance compared to other eddy viscosity models moukalled et al 2015 in the mentor sst k ω model menter 1994 conservation equations of the turbulent kinetic energy k and the turbulent frequency ω are introduced 4 k t u j k x j x j ν ν t σ k k x j 1 ρ p k β k ω 5 ω t u j ω x j x j ν ν t σ ω ω x j c α ω k ν t u i x j u j x i u i x j c β ω 2 2 1 f 1 σ ω 2 1 ω k x j ω x j where p k is the production of the turbulent kinetic energy and is calculated as 6 p k min ρ ν t u i x j u j x i u i x j 10 β ρ k ω the constants in the above equations are calculated by ϕ f 1 ϕ 1 1 f 1 ϕ 2 where ϕ 1 and ϕ 2 are the corresponding constants in the original k ω model and k ε model respectively the blending function f 1 depends on the solution variables and the normal distance of the first internal grid point to the wall and is calculated as 7 f 1 tanh γ 1 4 8 γ 1 min max k β ω y 500 ν y 2 ω 4 ρ σ ω 2 k c d k ω y 2 9 c d k ω max 2 ρ σ ω 2 1 ω k x j ω x j 10 10 with the constants of the original models assigned the following values c α1 0 5532 c β1 0 075 β 0 09 σ k1 2 00 σ ω1 2 00 c α2 0 4403 c β2 0 0828 σ k2 1 00 and σ ω2 1 186 the turbulent eddy viscosity is computed by 10 ν t 0 31 k max 0 31 ω 2 s t f 2 where s t is the magnitude of the strain rate and f 2 is given by f 2 tanh γ 2 2 with γ 2 max 2k 0 5 β ωy 500ν y 2 ω 3 computational overview 3 1 computational domain and boundary conditions two dimensional simulations of flow past rectangular cylinders near the free surface are conducted the schematic of the computational domain and the cartesian coordinate system of the model is drawn in fig 1 as shown in fig 1 the coordinate system is located in the center of the rectangular cylinder and the x axis is aligned with the inlet flow direction the length of the computational domain is 70l which is larger than that by liu et al 2016 the inlet is 20l upstream the cylinder and the outlet is 50l downstream the cylinder the distance between the cylinder and the outlet is believed to be sufficiently large that the outlet effects on the wake structures are negligible liu et al 2016 sohankar 2008 the entire domain is composed of air on the top and water at the bottom the top boundary is 10l away from undisturbed free surface and the bottom is 10l away from the center of the rectangular cylinder the rectangular cylinder is placed below the free surface the distance between the undisturbed surface and the top of the rectangular cylinder denoted by d has a significant impact on the flow structures and force coefficients of the cylinder details of the size of the rectangular cylinder along with other parameters used in the simulations are presented in table 1 the free surface evolution is tracked with the vof method hirt and nichols 1981 in which a fluid volume fraction α is introduced the α is bounded between 0 and 1 with α 1 representing water α 0 representing air and 0 α 1 representing the air water interface the transport equation of the volume fraction is given by 11 α t u j α x j 0 the fluid domain boundaries include the inlet s i the outlet s o the atmosphere s a the bottom s b and the structural surface s s the boundary conditions for the present simulations are shown in fig 1 at the inlet a constant velocity u 1 u is imposed and k and ω are calculated by 12 k 1 5 u i 2 13 ω k 0 5 c μ 0 25 l where i 5 is the turbulence intensity and l 0 07l is the turbulence length the empirical constant c μ is 0 09 in the near wall region i e near the surface of the rectangular cylinder and at the bottom if the flow is to be resolved a considerable number of grid points will be required due to the large gradients of velocity wall functions are used in the near wall region in the present simulations with the use of wall functions the turbulence model avoids the need to integrate all the way to the wall the first internal grid point is placed in the logarithmic layer 11 06 y 200 00 the empirical relations moukalled et al 2015 in this layer are given by 14 u 1 κ l n y b 15 k 1 c μ 16 ω ν μ τ κ y c μ where κ 0 41 is the von karman constant and b is 5 25 y yμ τ ν u u u τ k k u τ 2 and ω ων u τ 2 represent the normalized distance to the wall the normalized velocity parallel to the wall the normalized turbulent kinetic energy and the normalized turbulent frequency respectively y is the normal distance from the first internal grid point to the wall and μ τ is the friction velocity expressed in terms of the wall shear stress τ ω as μ τ τ w ρ 0 5 3 2 numerical methods the continuity and reynolds averaged n s equations the transport equation of volume fraction and the turbulence model equations are discretized using the finite volume method fvm performed in the open source package openfoam the fvm is implemented by integrating each term in the equations over a control volume and relating the volume integrals to the surface integrals using gauss s theorem the surface and volume integrals are both evaluated with the mid point integration approximation which yields second order accuracy values at cell centers are linearly interpolated to values at face centers the laplacian and divergence terms are treated with the gaussian linear corrected and gaussian linear schemes respectively the second order crank nicolson cn scheme is used for the time integration the discretized equations are solved with the pimple algorithm which is a hybrid of the piso and simple algorithms the principal of the algorithm is as follows holzmann 2016 within each time step both the inner pressure correction loop piso loop and outer pressure momentum correction loop simple loop are executed in the inner loop the pressure is recalculated with the new updated flux in the outer loop the velocity matrix is first rebuilt with the new flux the pressure is then corrected with the new velocity matrix and the flux is finally corrected with the new pressure the calculations are repeated until convergence is achieved in the present simulations three inner loops and three outer loops are executed within each time step the solutions are regarded as being converged when the final residuals of the velocity and pressure are lower than 1e 06 3 3 grid convergence study the meshes are generated by an algebraic method with the prediction that significant vortex generations occur near the rectangular cylinder grid points are intentionally clustered around the surface of the cylinder and stretch out gradually the medium mesh for the case of d l 4 5 and w l 5 0 is presented in fig 2 as shown in fig 2 the grid is fully orthogonal and dense areas of the grid points appear in the region near the rectangular cylinder and the free surface the grid convergence study is conducted for four cases d l 0 3 and w l 1 0 d l 0 3 and w l 5 0 d l 4 5 and w l 1 0 d l 4 5 and w l 5 0 details of the meshes are presented in table 2 the cases with subscripts 1 2 and 3 represent coarse medium and fine meshes respectively the drag and lift coefficients of rectangular cylinders are defined as 17 c d f d 0 5 ρ u 2 l 18 c l f l 0 5 ρ u 2 w where f d and f l are the streamwise and cross stream forces acting on the rectangular cylinder per unit length in the x 2 direction respectively the root mean square r m s value of the lift coefficient is calculated as 19 c l r m s c l 1 2 c l 2 2 c l 3 2 c l n 2 n the drag and lift coefficients as functions of time for the cases with w l 5 0 are shown in fig 3 it is seen that the flow becomes stable after 300s when the depth is 0 3l while the stable flow emerges after 200s at the depth of 4 5l the same situations happen for the cases with w l 1 0 it seems that at low depth to length ratios the flow takes a longer time to reach a stable condition in the present study the time averaged drag and lift coefficients are calculated over the time period 300s 400s and 200s 300s when d l is lower and higher than 1 0 respectively results of the convergence study are shown in table 2 as shown in table 2 the differences of the drag coefficient and strouhal number obtained with medium and fine meshes are generally below 1 for the r m s value of the lift coefficient a relatively large difference exists between the results obtained with three mesh densities mostly around 3 in the present study simulations with medium mesh densities are chosen for all the cases in consideration of the tradeoff between accuracy and computing time it is noted that the distance of the first internal grid point to the wall denoted by y is selected to be 0 025l at the surface of the rectangular cylinder and 0 050l at the bottom the averaged y around the surface of the rectangular cylinder for meshes a2 b2 c2 and d2 are 17 8 15 9 18 2 and 11 8 respectively indicating that the first internal grid points are generally located in the logarithmic layer 4 results and discussion 4 1 applicability of the rans turbulence model in order to study the applicability of the mentor sst k ω model menter 1994 in modeling flow past rectangular cylinders the predicted hydrodynamic results of this study are compared with the published results mizota et al 1988 nakaguchi et al 1968 ohtsuki 1978 sakamoto et al 1989 sohankar 2008 tamura and itoh 1996 the drag and lift coefficients are calculated by eq 17 and eq 18 the strouhal number is defined as st fl u where f denotes the vortex shedding frequency both the results obtained from the single phase and multiphase simulations are presented in fig 4 a c in the multiphase simulations the rectangular cylinder is placed at a depth of 4 5l below the water surface with d l equal to 4 5 the influence of the free surface on the force coefficients of rectangular cylinders is considered to be negligible malavasi and guadagnini 2007 the drag coefficient of the rectangular cylinder with different width to length ratios is depicted in fig 4 a as shown in fig 4 a the peak in the drag coefficient at around w l 0 7 is acquired through both the experiments mizota et al 1988 nakaguchi et al 1968 and simulations sohankar 2008 tamura and itoh 1996 fig 4 a shows that the drag coefficient predicted by using the single phase model agrees well with the published results when w l is between 0 7 and 5 0 this is consistent with that reported by tian et al 2013 fig 4 a also shows that the drag coefficient obtained from the multiphase simulations is in good agreement with the published results when w l is between 0 7 and 5 0 however when w l is lower than 0 7 the predicted drag coefficient is larger than both the experimental and numerical results the overestimation probably stems from the adoption of 2d modeling with which the significant three dimensional effects at low width to length ratios are neglected mannini et al 2010 shur et al 2005 fig 4 b shows that the r m s value of the lift coefficient decreases and the rate of decline decreases as w l increases from 0 7 to 5 0 however when w l is lower than 0 7 the r m s value increases with w l this variation trend is roughly captured via adopting the mentor sst k ω model menter 1994 in both the single phase and multiphase simulations however when w l is lower than 0 7 the r m s value of the lift coefficient is overpredicted by using the k ω model it indicates that the multiphase simulations with the mentor sst k ω model menter 1994 are incapable of accurately predicting the force coefficients of rectangular cylinders when w l 0 7 fig 4 c shows that the strouhal number obtained from both the single phase and multiphase simulations is in good agreement with the published results nakaguchi et al 1968 sakamoto et al 1989 sohankar 2008 tamura and itoh 1996 the discontinuity in the strouhal number appearing at around w l 2 8 is acquired by the present rans simulations it indicates that the flow past rectangular cylinders is reasonably reproduced via using the mentor sst k ω model menter 1994 in order to study the flow structures the flow around rectangular cylinders is visualized by vorticity contours as depicted in fig 5 the vorticity contours are obtained from the multiphase simulations and are plotted at 16 levels of ω 2 2 5 s 1 5 0 s 1 7 5 s 1 10 0 s 1 12 5 s 1 15 0 s 1 17 5 s 1 20 0 s 1 the solid and dashed contour lines represent the positive and negative vorticity contours respectively the vorticity component in the x 2 direction is defined as 20 ω 2 u 1 x 3 u 3 x 1 flow visualizations depicted in fig 5 are in agreement with those reported by shimada and ishihara 2002 fig 5 a d show that when w l is lower than 2 5 the rectangular cylinder is immersed in the separated flow region no flow reattachment is displayed due to the small widths of the cross sections fig 5 a d also show that as w l increases from 1 0 to 2 5 the location of the vortex behind the rectangular cylinder moves further downstream and the vortex becomes weaker this is an illustration of the decrease of the strouhal number when w l increases from 1 0 to 2 5 as shown in fig 4 c it is seen from fig 5 e i that when w l falls between 3 0 and 5 0 the flow separating from the upper and lower corners of the leading edge reattaches the side surfaces of the rectangular cylinder a substantial change of the flow occurs as w l increases from 2 5 to 3 0 with the change of the flow the vortex shedding frequency rises suddenly resulting in the discontinuity in the strouhal number see fig 4 c the force coefficients of the square obtained from the present multiphase simulations are compared with the published results lyn et al 1995 bosch and rodi 1998 farhadi and rahnama 2005 murakami and mochida 1995 shimada and ishihara 2002 tian et al 2013 as shown in table 3 the predicted drag coefficient and r m s value of the lift coefficient agree well with the numerical results by farhadi and rahnama 2005 and murakami and mochida 1995 respectively however it is seen that there are discrepancies between the predicted drag and lift coefficients of this study and the results reported by lyn et al 1995 tian et al 2013 bosch and rodi 1998 and shimada and ishihara 2002 the differences between the results are probably due to the different settings in the experimental or numerical studies e g the spanwise extension and blockage ratio table 3 also shows that the predicted strouhal number of this study is in good agreement with the published results 4 2 effect of the depth to length ratio the effect of the depth to length ratio on the hydrodynamic properties of rectangular cylinders with width to length ratios of 1 0 and 3 0 is discussed in this section as mentioned above the unbounded flow past rectangular cylinders with width to length ratios of 1 0 and 3 0 shows separated and intermittently reattached patterns respectively shimada and ishihara 2002 as the rectangular cylinder approaches the water surface the free surface effects on the cylinder with the two w l values are different as will be presented in the following paragraphs the drag coefficient of the rectangular cylinder at various depth to length ratios is depicted in fig 6 a as shown in fig 6 a when w l is 1 0 the drag coefficient increases as d l decreases from 4 5 to 0 8 and drops sharply when d l decreases from 0 8 to 0 5 then the drag coefficient increases slightly with d l decreasing from 0 5 to 0 3 the maximum drag coefficient c d 2 757 appears at the depth of 0 8l and is distinctly larger than that c d 2 233 at d l 4 5 however when w l is 3 0 the drag coefficient increases as d l decreases from 4 5 to 1 0 followed by a gentle reduction when d l decreases from 1 0 to 0 8 the drag coefficient increases again as d l decreases from 0 8 to 0 3 during which the growth rate of the drag coefficient is larger than that when d l decreases from 4 5 to 1 0 it is predicted that the maximum drag coefficient of the rectangular cylinder w l 3 0 will be obtained in the extreme case of d 0 fig 6 a also reveals that the variation trends of the drag coefficient with d l at the two w l values are similar but the amplitudes of variation and the corresponding ranges of d l values are different these differences are likely attributed to the different intensities of interaction between the free surface and the rectangular cylinder at w l 1 0 and w l 3 0 as discussed previously the flow past rectangular cylinders with width to length ratios of 1 0 and 3 0 in an infinite domain shows separated and intermittently reattached patterns respectively shimada and ishihara 2002 when the cylinder approaches a water surface the interaction between the free surface and the vortex shedding past the rectangular cylinder varies with the w l value leading to the different variations of the drag coefficient with d l the predicted results for the drag coefficient at w l 3 0 of this study are compared with the experimental results by malavasi and guadagnini 2007 it is found that the present predicted drag coefficient is generally lower than that by malavasi and guadagnini 2007 at the same depth to length ratios this is due to the different sizes of the rectangular cylinder in the two studies in order to make comparisons between the results the froude number fr u gd 0 5 which allows the sole effect of the free surface to be examined is used as the x coordinate as shown in fig 7 a the drag coefficient obtained from the present rans simulations agrees well with the experimental results malavasi and guadagnini 2007 at fr 0 4 however when fr is larger than 0 4 the predicted drag coefficient is evidently smaller than the results by malavasi and guadagnini 2007 this is due to the different blockage ratios adopted in the present simulations 9 3 and by malavasi and guadagnini 2007 14 3 fig 6 b shows the variations of the lift coefficient with the depth to length ratio it is seen from fig 6 b that when w l is 1 0 the lift coefficient varies slightly as d l decreases from 4 5 to 1 5 and descends suddenly when d l decreases from 1 5 to 1 0 the lift coefficient undergoes a sharp rise and fall as d l decreases from 1 0 to 0 3 with the peak emerging at d l 0 6 similar variations of the lift coefficient with d l can be seen when w l is 3 0 excepting that the lift coefficient decreases as d l decreases from 4 5 to 1 5 it is important to note that the lift coefficient at both values of w l w l 1 0 and w l 3 0 varies remarkably in the d l range from 1 0 to 0 3 specifically the sharp rise of the lift coefficient begins at d l 1 0 and ends at d l 0 6 when w l is 1 0 while when w l is 3 0 the lift coefficient starts rising at d l 1 0 and peaks at d l 0 8 it implies that the free surface effects become significant when the depth of the rectangular cylinder is lower than 1 0l this is also reflected by the dramatic decrease of the r m s value of the lift coefficient in the corresponding d l ranges as shown in fig 6 c the sudden fall of the lift coefficient occurs in the d l ranges from 0 6 to 0 3 and from 0 8 to 0 3 for rectangular cylinders with width to length ratios of 1 0 and 3 0 respectively at these d l ranges the vortex shedding around the rectangular cylinder is totally different from that in an infinite domain as will be discussed later moreover the predicted lift coefficient at w l 3 0 of the present study is compared with the experimental results by malavasi and guadagnini 2007 and the results match well with each other as shown in fig 7 b fig 6 d shows that for most depth to length ratios the strouhal number varies slightly with d l the dramatic variation of the strouhal number occurs at around the depth of 0 6l and 0 9l for rectangular cylinders with width to length ratios of 1 0 and 3 0 respectively it indicates a substantial change of the flow at the two depths and explains well the sharp rise of the lift coefficient with decreasing d l at around the two depths the relatively low values of strouhal number in the d l ranges from 0 5 to 0 3 and from 0 8 to 0 3 for rectangular cylinders at w l 1 0 and w l 3 0 imply that at these d l ranges the free surface effects play a dominant role on the vortex shedding around rectangular cylinders and the flow is totally different from that in an infinite domain fig 8 and fig 9 show the frequency distribution of the lift force for the cases with w l 1 0 and w l 3 0 at various depth to length ratios respectively it is seen that the peak frequency varies dramatically as d l decreases from 0 6 to 0 5 when w l is 1 0 and from 0 9 to 0 8 when w l is 3 0 this is in accordance with the variation of the strouhal number with d l see fig 6 d it is also observed that at low depth to length ratios the second largest peak is noticeable these frequency values are depicted with mark symbols in fig 6 d as shown in fig 6 d the resultant strouhal number of the second frequency at low d l values approximates that at high d l values it reflects the fact that the flow around rectangular cylinders near a free surface partly retains the features of the unbounded flow past rectangular cylinders although the vortex shedding is markedly suppressed by the free surface distortion as indicated by the reduced amplitude of the second largest peak the vorticity contours around the rectangular cylinder at various depth to length ratios are depicted in fig 10 and fig 11 the black thick lines above the rectangular cylinder represent the free surface in the figures by comparing fig 10 e to fig 5 a it is observed that the flow around the rectangular cylinder w l 1 0 at the depth of 1 0l is similar to that in an infinite domain however the vortices shed along the upper surface of the square are pressed due to the presence of the free surface reciprocally the free surface on top of the square fluctuates slightly this demonstrates the weak interaction between the free surface and the square as d l decreases from 1 0 to 0 6 the interaction between the free surface and the square becomes stronger as shown in fig 10 c e with the approaching of the free surface the vorticity contours above the square are flattened and fluctuations of the free surface increase meanwhile the vortex shedding frequency rises as is reflected by the shortened distance between the successively shed positive or negative vortices it results in the increase of the strouhal number when d l decreases from 1 0 to 0 6 as shown in fig 6 d fig 10 a and b show that when the square is submerged at the depth of 0 3l and 0 5l the flow around the square is completely different from that in an infinite domain as shown in fig 10 a and b the vortices shed from the upper corner of the leading edge are significantly pressed and the vortices generated at the lower corner of the leading edge are shed in a direction away from the lower surface of the square with the vorticity contours elongated the vortex shedding frequency drops leading to the drastic reduction of the strouhal number as d l decreases from 0 6 to 0 5 see fig 6 d the vorticity contours around the rectangular cylinder w l 3 0 at various depth to length ratios are shown in fig 11 it is seen from fig 11 e that when d l is 1 0 the flow around the rectangular cylinder reattaches the upper and lower surfaces this is similar to that in an infinite domain see fig 5 e except that the vortices above the rectangular cylinder are pressed under the effect of the free surface fig 11 d shows that when d l is 0 9 positive vortices are generated at both the upper and lower corners of the trailing edge causing the negative vortices under the rectangular cylinder to separate from the lower surface as d l decreases from 0 9 to 0 8 the free surface effects become more significant fig 11 c shows that the vorticity contours along the upper surface are flattened and lengthened and the vorticity contours along the lower surface are forced to stretch downward away from the rectangular cylinder it is observed that the flow above the rectangular cylinder reattaches the upper surface while the flow below the rectangular cylinder separates from the lower corner of the leading edge without reattaching the lower surface this causes the drop in vortex shedding frequency leading to a dramatic decrease in strouhal number see fig 6 d fig 11 a c show that as d l decreases from 0 8 to 0 3 the flow around the rectangular cylinder experiences small changes with the vorticity contours shortened slightly distributions of the time averaged vorticity on the surfaces of the rectangular cylinder are depicted in fig 12 the distance x is measured from the center of the leading edge around the surface of the rectangular cylinder in the clockwise direction the dashed curves represent the cases when the free surface effects play a dominant role as discussed above fig 12 a shows that the vorticity distributions on the leading edge 0 x 0 5 3 5 x 4 0 and lower surface 2 5 x 3 5 of the square have small differences as d l decreases from 1 0 to 0 3 however on the upper surface 0 5 x 1 5 and trailing edge 1 5 x 2 5 distributions of the vorticity vary significantly as d l varies as shown in fig 12 a with the decrease of d l the vorticity on the upper surface vary from negative values to positive values and the vorticity on the trailing edge decrease in magnitude it is seen that when d l is 0 3 and 0 5 the vorticity distributions around the square are different from those at other d l values this indicates the change of the flow as shown in fig 10 similar phenomenon can be observed when w l is 3 0 as shown in fig 12 b the vorticity distributions on the upper surface 0 5 x 3 5 and trailing edge 3 5 x 4 5 at d l 0 3 d l 0 7 and d l 0 8 are different from those at d l 0 9 and d l 1 0 the results are appropriate reflections of the flow variations with the depth as shown in fig 11 based on the above discussions it is predicted that there exists a critical depth to length ratio below which the flow around rectangular cylinders is dominated by the free surface effects as demonstrated by the flow visualizations when d l is larger than the critical value the flow past rectangular cylinders shares similar features to those in an infinite domain however when d l is lower than that value totally different features of the flow are displayed discussions on the vorticity distributions around the rectangular cylinder at various depths confirm the prediction moreover the critical depth to length ratio is found to be related to the width to length ratio of the rectangular cylinder as presented above the critical depth to length ratios for the rectangular cylinder with width to length ratios of 1 0 and 3 0 are in the ranges from 0 5 to 0 6 and from 0 8 to 0 9 respectively a deep investigation on the relationship between the critical depth to length ratio and the width to length ratio is not carried out in the present study and is left for future works 4 3 effect of the width to length ratio the effect of the width to length ratio on the flow past rectangular cylinders near the free surface is discussed in this section two depths 0 3l and 0 6l of rectangular cylinders are considered as discussed in the previous section 0 6 approximates the critical depth to length ratio for the rectangular cylinder with the width to length ratio of 1 0 the force coefficients of the rectangular cylinder with different width to length ratios are shown in fig 13 the results for the cases with d l 4 5 are also presented as shown in fig 13 a when d l is 0 3 the drag coefficient decreases linearly as w l increases from 0 6 to 5 0 the variation trend is markedly different from that of the case wth d l 4 5 it is anticipated that due to the strong free surface effects the flow around rectangular cylinders at the depth of 0 3l is totally different from that in an infinite domain when d l is 0 6 the variations of the drag coefficient have different characteristics in different w l ranges as w l increases from 0 6 to 1 5 the drag coefficient drops sharply and the curve approximates that of the cases with d l 4 5 the small differences between the results at d l 0 6 and d l 4 5 are most probably due to the presence or absence of the free surface effects as w l increases from 1 5 to 5 0 the drag coefficient decreases slowly with the declining curve paralleled to that of the cases with d l 0 3 it indicates that when the rectangular cylinder is located at the depth of 0 6l the interaction between the free surface and the vortex shedding is dramatically enhanced when w l is larger than 1 5 fig 13 b shows that when d l is 0 3 the lift coefficient decreases as w l increases from 0 6 to 5 0 it is markedly different from that of the cases with d l 4 5 in which the lift coefficient varies slightly with w l when d l is 0 6 the variations of the lift coefficient are different in different w l ranges as shown in fig 13 b when w l is lower than 1 5 the lift coefficient varies slightly as w l increases which is similar to that of the cases with d l 4 5 when w l is larger than 1 5 the lift coefficient decreases with w l with the declining curve paralleled to that of the cases with d l 0 3 the distinct variation trends of the force coefficients in different w l ranges at d l 0 6 can also be observed in the variations of the r m s value of the lift coefficient as shown in fig 13 c it is worth noting that the behaviors of the lift coefficient under varying w l at the two depths d 0 3l and d 0 6l are in accordance with those of the drag coefficient therefore it is reasonable to predict that when d l is 0 3 the interaction between the free surface and the rectangular cylinder is strong in the whole w l range from 0 6 to 5 0 and the flow is dominated by the free surface effects due to this dominance the variation trends of both the drag and lift coefficients with w l are remarkably different from those when the rectangular cylinder is deeply submerged d l 4 5 however when d l is 0 6 the flow past rectangular cylinders is dominated by the free surface effects only at w l 1 5 when w l is lower than 1 5 the interaction between the free surface and the rectangular cylinder is relatively less significant and the features of the vortex shedding flow in an infinite domain are retained this provides a good explanation for the different variation trends of the drag and lift coefficients in the two w l ranges i e from 0 6 to 1 5 and from 1 5 to 5 0 fig 13 d shows the variations of the strouhal number with the width to length ratio as shown in fig 13 d when d l is 0 3 the strouhal number remains at a relatively low value st 0 080 when w l increases from 0 6 to 5 0 this variation trend differs notably from that of the cases with d l 4 5 in particular the discontinuity in the strouhal number at around w l 2 8 is not present when the depth is 0 3l observations on the flow structures reveal that throughout the whole w l range from 0 6 to 5 0 the flow past rectangular cylinders located at the depth of 0 3l displays totally different features from those in an infinite domain examples of this flow are shown in figs 10 a and fig 11 a it is important to note that st 0 080 represents a typical characteristic of the vortex shedding suppressed by the free surface distortion and can be used to identify the presence or absence of the dominance of the free surface effects fig 13 d also shows that when d l is 0 6 the strouhal number varies slightly as w l increases from 0 6 to 1 0 and decreases sharply as w l increases from 1 0 to 1 5 when w l is larger than 1 5 the strouhal number roughly remains at a value close to 0 080 it indicates that the free surface effects become dominant at w l 1 5 observations on the flow structures confirm that when the depth is 0 6l the flow past rectangular cylinders resembles that in an infinite domain at w l 1 0 and is dominated by the free surface effects at w l 1 5 fig 14 shows the time averaged streamwise component of the velocity at two locations x 2 5l and x 10 0l downstream the rectangular cylinder the distance x is measured from the center of the trailing edge as shown in fig 14 a and b the variations of the streamwise velocity with the depth at x 2 5l and x 10 0l are different the sharp decrease of the streamwise velocity at x 2 5l as y l varies from 0 5 to 0 5 indicates that it is located in the recirculation region behind the rectangular cylinder it is also seen from fig 14 a and b that the streamwise velocity at different w l values varies similarly with the depth this demonstrates that the flow around the rectangular cylinder at the depth of 0 3l shares similar features as w l increases from 0 6 to 5 0 when d l is 0 6 the variations of the streamwise velocity with the depth change as w l changes as shown in fig 14 c and d the streamwise velocity at x 2 5l and x 10 0l experiences a sudden change as w l increases from 1 0 to 2 0 it is in accordance with the change of the flow past the rectangular cylinder at around w l 1 5 as mentioned above variations of the time averaged vorticity with the depth at two locations x 0 5l and x 1 5l downstream the rectangular cylinder are also studied fig 15 a and b show that when d l is 0 3 the vorticity decrease sharply from a relatively large positive value to about zero as y l varies from 0 5 to 0 5 and decrease further as y l varies from 0 5 to 1 0 similar variations of the vorticity with the depth can be seen in fig 15 c and d at w l 2 0 this corresponds to the flow which is strongly affected by the free surface however when w l is 0 6 and 1 0 the time averaged vorticity shows positive and negative values behind the rectangular cylinder at x 0 5l and x 1 5l respectively it is a demonstration of the periodic vortex shedding which is typical for flow past rectangular cylinders in an infinite domain 5 conclusions flow past rectangular cylinders in the vicinity of the free surface was investigated in the present study two dimensional rans simulations using the mentor sst k ω model were conducted the applicability of the mentor sst k ω model in modeling flow around rectangular cylinders near the free surface was first discussed the effects of the depth to length ratio and the width to length ratio on the hydrodynamic properties of rectangular cylinders were then analyzed the following conclusions were drawn 1 multiphase simulations based on the mentor sst k ω model can provide reasonable predictions of the force coefficients of rectangular cylinders close to the free surface when w l is larger than 0 7 the flow around rectangular cylinders at various width to length ratios from 1 0 to 5 0 can be reasonably reproduced via using the mentor sst k ω model 2 the effect of the depth to length ratio on the hydrodynamic properties of rectangular cylinders is affected by the width to length ratio variations of the drag and lift coefficients and the strouhal number with d l are similar for rectangular cylinders with width to length ratios of 1 0 and 3 0 but the amplitudes of variation and the corresponding ranges of d l values are different specifically the maximum drag coefficient c d 2 757 of the rectangular cylinder w l 1 0 appears at the depth of 0 8l while the maximum drag coefficient at w l 3 0 is predicted to emerge in the extreme case of d 0 3 the free surface effects on the flow past rectangular cylinders become significant when the depth is lower than 1 0l this is reflected by the sharp rise of the lift coefficient in the d l ranges from 1 0 to 0 6 and from 1 0 to 0 8 for rectangular cylinders with width to length ratios of 1 0 and 3 0 respectively the substantial change of the flow occurs at around the depth of 0 6l and 0 9l for rectangular cylinders with width to length ratios of 1 0 and 3 0 respectively the relatively low values of strouhal number in the d l ranges from 0 5 to 0 3 and from 0 8 to 0 3 for rectangular cylinders at w l 1 0 and w l 3 0 imply that at these d l ranges the free surface effects play a dominant role on the vortex shedding around rectangular cylinders 4 there exists a critical depth to length ratio for rectangular cylinders located near the free surface when d l is larger than the critical value the flow past rectangular cylinders shares similar features to those in an infinite domain however when d l is lower than that value the flow becomes dominated by the free surface effects the critical depth to length ratios for the rectangular cylinder with width to length ratios of 1 0 and 3 0 locate in the ranges from 0 5 to 0 6 and from 0 8 to 0 9 respectively the relationship between the critical depth to length ratio and the width to length ratio remains to be investigated 5 the effect of the width to length ratio on the flow past rectangular cylinders close to the free surface is different from that in an infinite domain when d l is 0 3 the flow past rectangular cylinders is dominated by the free surface effects throughout the whole w l range from 0 6 to 5 0 and the variation trends of the force coefficients are remarkably different from those in an infinite domain a typical characteristic of the vortex shedding suppressed by the free surface distortion is the low strouhal number st 0 080 which can be used to identify the presence or absence of the dominance of the free surface effects when d l is 0 6 the variations of the force coefficients have different characteristics at w l 1 0 and w l 1 5 and the change of the variation trends at w l 1 5 corresponds to the substantial change of the flow acknowledgement this work is supported by national natural science foundation of china nsfc and china scholarship council csc these supports are gratefully acknowledged the first author also acknowledges the support from the school of civil and construction engineering at oregon state university where the first author is a visiting doctorate student appendix a supplementary data the following is the supplementary data to this article multimedia component 1 multimedia component 1 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j oceaneng 2019 106118 
22708,to promise the high fidelity of path following control for the underactuated ship this paper develops an event triggered robust fuzzy control scheme which also releases the constraint of input saturation to solve the underactuated problem we add an adaptive bounded term to the tracking error in the sway motion which allocates the error to actuated motions in the control scheme the fuzzy logic systems fls are employed to approximate the uncertainties while the methodology of robust damping is adopted the gauss error functions are introduced to approximate the structure of input saturation such that the backstepping frame can be applied and the control commands in the rudder angle and the revolving rate of the main engine are derived to avert the frequent acting of actuators the event triggered control etc technique is adopted the static triggered condition is constructed with a flexible adjustable variable which regulates the minimal inter event times for actuators via the direct lyapunov approach we prove the existence of the minimal inter event time and the uniform boundedness of all tracking errors in the closed loop system finally the feasibility of the scheme is validated in the platform of the simulated ocean environment keywords path following underactuated ships input saturation robust fuzzy damping event triggered control 1 introduction as one of typical scenarios of ship s manoeuvering path following has been widely studied over the past decades a potential future on this issue is expected in the context of worldwide recognition for mass marine autonomous surface ships which was legally admitted by imo international maritime organization in 2018 in common working condition the mass is an underactuated system with only the surge and the rolling motions are controllable the path following task for it is usually comprised of three components namely the path planning the guidance and the control in the specific frame of planning and guidance the control part is the most challenging issue which needs to reconcile the problems of the underactuated characteristic the environmental disturbances and the modeling uncertainties etc liu et al 2016 although plenties of outcomes have been achieved in this issue by resorting to advanced cybernetics most of them were not compatible with the marine devices that is because of both complexity of these algorithms and lack of practical considerations which refers to the informational unbalance fossen 2011 it can be divided into two categories to address the path following control of underactuated ships with respect to diverse guidance approaches liu et al 2017a one is to reinterpret the error dynamics by frame transformation or geometrical rationale two typical cases are line of sight los guidance fossen et al 2003 and serret frenet sf frame encarnacao et al 2000 these approaches usually ignore the control in surge motion and suppose the surge speed to be a constant to solve the underactuated problem the assumption of omissible sway speed is made li et al 2009 liu et al 2017a or the leeway angle is compensated lekkas and fossen 2014 fossen et al 2015 or estimated liu et al 2017b the other train of thought is to structure an ideal virtual ship sailing along the reference path without inertia and damping so as to transform the path following to the tracking of the virtual ship zhang and zhang 2015 the surging motion is also considered in this approach and it is applicable to fruitful outcomes towards tracking control in view of the tracking control for underactuated ships lyapunov theory based backstepping control approaches were developed in jiang 2002 and do et al 2002 by utilizing the interconnected structure of the ship via state transformation dong and guo 2005 proposed three stabilizing controller with different convergent rates ghommam et al 2010 developed an united stabilizing and tracking controller on the basis of the cascade structure of the ship besides slowly varying bias of the disturbances can be counteracted concluded from previous outcomes li et al 2008 only considered surge and yaw motions in controller design while the sway motion was self constrained by passivity although the above methodologies succeeded to solve the tracking control of underactuated ships in mathematical deduction they are not palatable to the nautical practice to meet the marine reality the consideration of engineering factors must be involved in the control scheme do and pan 2005 first coped with off diagonal inertia matrix of the ship s model which accords with the asymmetric geometrical feature of the ship in do 2010 the notion of practical control was proposed which reveals the present mainstream in this field in most of the previous researches the constraints generated by the actuators are omitted whereas the analysis of these constraint is indispensable to ensure the applicability of control schemes one of these constraints is the input saturation to solve this one can refer to zheng and sun 2016 and liu et al 2017a for the dynamic auxiliary system shojaei 2015 for the saturated filters jin 2016 for the barrier lyapunov function park et al 2017 for the additional control term and li et al 2015 2016 zhou et al 2017 for the sigmoid function approximation nevertheless all these researches finally derived the control inputs with the form of thrust and turning torque which can not be referred to by actuators directly in contrast it is more practical to offer the commands in the rudder angle and the revolving rate of the propeller to this end liu et al 2017a rendered the input of rudder angles with known actuator gains and an adaptive approach for uncertain actuator gains was proposed in zhang et al 2017 2018 due to the large overshoot of the adaptive schemes at the initial stage the control performance will be degraded it should be further investigated that only the bounds of gains are available another constraint lies in the limited acting frequency of the actuators in nautical practice the digital computer with sampler and zero order holder zoh is employed to emulate the continuous time control scheme and the control command will be updated periodically katayama and aoki 2014 long term high frequency action will lead to the mechanical abrasion and shorten the service life of actuators thus it is practical to lower the acting frequencies of actuators and increase the acting periods as larger period will degrade the control performance it is preferred that control only happens when it is necessary that is the event triggered control tabuada 2007 for the fully actuated ship emulation like backstepping approaches were proposed in jiao and wang 2016a b where the controller was first designed by ignoring the communication constraint fu et al 2017 integrated the active disturbance rejection control with the etc and devised a dynamic positioning controller in postoyan et al 2015 the etc tracking controller for the underactuated unicycle mobile robot was developed to the best of the author s knowledge there are still no researches investigating the etc for underactuated ships besides all the above methods premised the accurate model to approximate both internal and external uncertainties of the model we can refer to the neural networks or the fls for their universal approximation ability and yet we need to find the way to promote their good match with the etc further to reduce the complexity of the control laws the methodology of robust damping should be considered deng et al 2019 motivated by the above analysis this paper embarks on developing a synthesized path following control law for the underactuated ship with input saturation and uncertainties the contributions are mainly twofold 1 the proposed control scheme addresses several practical factors together first the saturation nonlinearities of actuators are represented by the gauss error functions such that the backstepping design can be easily used secondly by following the robust damping design the control laws possess a succinct form while there is no need to update the weights of fls thirdly we derive the control commands in the rudder angle and the revolving rate of the main engine which are more acceptable to the actuators fourthly we restructure the tracking error in the sway motion with the gauss error function of an adaptive compensating variable which allocates this error to the actuated motions and solves the underactuated problem 2 the ideology of etc is employed in the scheme to avoid the frequent acting of actuators creatively the propeller and the rudder are separately discussed with the mechanism to adjust their acting frequency flexibly the existence of minimal inter event time is proven such that the accumulation of triggering instants namely the so called zeno phenomenon is avoided the remainder of this paper is organized as following preliminaries are deployed in section 1 the control scheme is designed in section 2 section 3 analyzes the closed loop stability and the existence of minimal inter event time the comparative experiment in the simulated sea environment is conducted in section 4 section 5 concludes the whole paper notations uniformly in this paper sign denotes the sign function implies the 2 norm of the variable inf denotes the infimum of the discussed element 2 preliminaries 2 1 mathematical model according to fossen 2011 the motions of a surface ship can be described in two right handed cartesian coordinates of the body and the earth as for path following only three motions namely surge sway and yaw need to be considered in the earth frame the kinematic loop of eq 1 is fabricated which depicts the attitudes of the ship while in the body frame the dynamic loop of eq 2 is fabricated and the kinestates are described 1 x u cos ψ v sin ψ y u sin ψ v cos ψ ψ r 2 m u u τ u τ w u m v v r y r r 2 x u u x u u u u m v v τ w v m u u r y v v y v v v v y r v r v y r r y v r v r y r r r r m r r τ r τ w r m u m v u v y r u r n v v n v v v v n r v r v n r r n v r v r n r r r r where x y imply the horizontal coordinates of the ship ψ the heading angle u v r denote the translational and the angular speeds in surge sway and yaw motions respectively m i i u v r denote the ship inertia including the additional mass or moment respectively x y n with subscripts denote hydraulic derivatives generated by the damping effect τ w i denotes the environmental disturbance of each motion with the upper bound τ w i τ w i where τ w i is a positive constant τ u and τ r are the thrust and the turning torque according to characteristics of the rudder and the propeller they can be further written as eq 3 3 τ u c u t n n n a n a τ r c r t δ δ δ a δ a where n a is the actual revolving rate of the propeller δ a is the actual rudder angle in a simple way we can deem n and δ as the control inputs c u t and c r t are the time varying gains of the propeller and the rudder we assume that their upper bounds of c u and c r and lower bounds of c u and c r are known positive constants in view of the saturation constraint we presume that n and δ follow eq 4 4 n n i f n ˆ n n ˆ i f n n ˆ n n i f n ˆ n δ δ i f δ ˆ δ δ ˆ i f δ δ ˆ δ δ i f δ ˆ δ where n ˆ and δ ˆ are the ideal control commands n and δ denote positive upper limits n and δ lower negative limits 2 2 the virtual ship guidance the virtual ship guidance principle is adopted to proceed the following design which has been delineated in zhang and zhang 2015 deng et al 2019 this principle can transform the path following of the reference path to the tracking of the virtual ship and its rationale is shown in fig 1 while the waypoints are set in the electronic chart the reference path is first generated by connecting waypoints and interpolating arcs in the waypoints a virtual ship without inertia and damping is employed to generate the time series of positional coordinates x d y d and heading angles ψ d its kinetics can be described as x d u d cos ψ d y d u d sin ψ d and ψ d r d to guarantee the asymptotic consensus of ψ to ψ d we introduce the approaching angle as eq 5 5 ψ d a erf γ 1 x e 2 y e 2 arctan y e x e 1 erf γ 1 x e 2 y e 2 ψ d where x e x x d and y e y y d γ 1 is a parameter determining the transitional speed from arctan y e x e to ψ d erf is the gauss error function of the sigmoid shape defined by eq 6 6 erf x 2 π 0 π 2 x e t 2 dt where eq 6 is continuously differentiable with the upper and the lower bounds of 1 defining ψ e ψ ψ d a and from eq 5 and eq 6 we can know that ψ d a ψ d while x e 2 y e 2 0 and x x d y y d ψ ψ d while x e 0 y e 0 ψ e 0 then the control objective is concluded as following control objective under the saturation constraint of eq 4 design the law for ideal control commands n ˆ and δ ˆ to impel the ship with kinetics eq 1 and eq 2 to converge to the position x d y d and the heading angle ψ d of the virtual ship namely stabilize the errors x e y e and ψ e 2 3 approximation of fls in our scheme the fls is employed to approximate nonlinear functions according to wang 1994 the fls is constructed based on the fuzzy rules base and it is utilized by three steps that is fuzzification fuzzy reasoning and defuzzification a multi input single output system can thereby described by a fls with n rules as eq 7 7 y x l 1 n w l s l x l 1 n s l x where y is the output x is the input vector w l is the weight of each fuzzy rule s l x is the product of membership functions let s rewrite φ l s l l 1 n s l as the fuzzy basis function defining w w 1 w n t and ϕ φ 1 φ n t it can be described that y w t ϕ thus the approximation of fls can be concluded as the following lemma lemma 1 li et al 2015 2016 2019 for any continuous function f x defined on a compact set we can always find a fls satisfying eq 8 with an arbitrarily small constant ε 8 f x w t ϕ x ε 3 controller design in this section the control laws for n ˆ and δ ˆ are devised to resolve the tracking problem namely stabilize x e y e and ψ e it is divided into three steps in the first step the virtual control laws in three motions are devised our scheme adopts the ideology of emulation based etc thus in the second step the continuous control laws for n ˆ and δ ˆ denoted as n c and δ c are devised in advance and the underactuated problem is resolved then in the third step the triggering condition is devised step 1 according to kinematic loops of the eq 1 and the virtual ship the error system of eq 9 is first obtained 9 x e u e α u cos ψ u d cos ψ d v e α v sin ψ y e u e α u sin ψ u d sin ψ d v e α v cos ψ ψ e r e α r ψ d a where α i is the virtual control laws of i u v r and i e i α i according to the backstepping approach the virtual control laws are devised as eq 10 10 α u k x x e cos ψ k y y e sin ψ u d cos ψ d ψ α v k x x e sin ψ k y y e cos ψ u d sin ψ d ψ α r k ψ ψ e ψ d a y e u sin ψ v cos ψ u d sin ψ d ψ d a x e u cos ψ v sin ψ u d cos ψ d ψ d a ψ d r d where k x k y k ψ are tuning parameter the partial derivatives of ψ d a can be acquired by synthesizing eq 5 and eq 9 as 11 ψ d a y e γ 1 exp π 4 γ 1 2 x e 2 y e 2 y e x e 2 y e 2 arctan y e x e ψ d x e erf x e 2 y e 2 ψ d a x e γ 1 exp π 4 γ 1 2 x e 2 y e 2 x e x e 2 y e 2 arctan y e x e ψ d y e erf x e 2 y e 2 ψ d a ψ d 1 erf γ 1 x e 2 y e 2 then by substituting eq 10 and eq 11 to eq 9 it can be rendered that 12 x e k x x e u e cos ψ v e sin ψ y e k y y e u e sin ψ v e cos ψ ψ e k ψ ψ e r e defining the lyapunov function as v 1 1 2 x e 2 1 2 y e 2 1 2 ψ e 2 one can render its time derivative of eq 13 by differentiating it with eq 12 13 v 1 x e x e y e y e ψ e ψ e k x x e 2 k y y e 2 k ψ ψ e 2 u e x e cos ψ v e x e sin ψ u e y e sin ψ v e y e cos ψ ψ e r e step 2 according to ma et al 2015 the saturation constraint of eq 4 can be rewritten as the gauss error function plus the approximating error of eq 14 14 n n m erf n ˆ n m d n δ δ m erf δ ˆ δ m d δ where n m n n 2 n n 2 sign n ˆ and δ m δ δ 2 δ δ 2 sign δ ˆ d n and d δ are approximating errors with the upper bounds d n d n and d δ d δ observing eq 14 it can be transformed to eq 15 by lagrangian mean value theorem 15 n h n n ˆ d n δ h δ δ ˆ d δ where h n and h δ are expressed by 16 h n exp π t 2 4 n m 2 t 0 n ˆ h δ exp π t 2 4 δ m 2 t 0 δ ˆ as our scheme will not render an infinite value of n ˆ and δ ˆ it is tenable to presume that h n and h δ are bounded with h n h n h n and h δ h δ h δ by employing the lemma 1 the nonlinear terms in the dynamic loop eq 2 are expressed as eq 17 17 w u t ϕ u ε u m v v r y r r 2 x u u x u u u u α u m u w v t ϕ v ε v m u u r y v v y v v v v y r v r v y r r y v r v r y r r r r α v w r t ϕ r ε r m u m v u v y r u r n v v n v v v v α r n r v r v n r r n v r v r n r r r r where ε denotes the approximating error the subscripts u v r denote the discussing motions as the continuous control law n c and δ c will be first designed here we define the sampling induced control errors as e n n ˆ n c and e δ δ ˆ δ c by synthesizing eq 2 eq 3 eq 15 and eq 17 one can get the error system of the dynamic loop as eq 18 18 u e c u h n m u n c c u h n m u e n d n m u τ w u m u ε u w u t ϕ u v e τ m v m v ε v w v t ϕ v r e c r h δ m r δ c c r h δ m r e δ d δ m r τ w r m r ε r w r t ϕ r aiming at the underactuated problem we define the combined error function as s v v e β erf ϑ v where β is a small constant ϑ v is the adaptive compensating variable as the gauss error function erf ϑ v is bounded the stabilization of v e equates to the stabilization of s v according to the robust damping technique of zhang and zhang 2017 zhang et al 2017 we define the damping term as φ v ϕ v 1 and the compressed weight as θ v max w v τ w v m v ε v then the updating law of ϑ v is devised as eq 19 19 ϑ v exp π 4 ϑ v 2 β k v s v γ u u e γ r r e k f v s v x e 2 y e 2 2 ε s v where k v is the tuning parameter γ u and γ r are the distributing parameters which distributes the s v to surge and yaw motions ε denotes a small constant and k f v λ φ v 2 where λ is a positive tuning parameter then we define the lyapunov function as v 2 1 2 s v 2 from the structure of s v the following young s inequality is first constructed for the subsequent simplification 20 v e 2 2 s v 2 2 β 2 by synthesizing eq 18 and 19 and eq 20 the time derivative of v 2 can be rendered as eq 21 21 v 2 s v s v k v s v 2 γ u u e s v γ r r e s v θ v φ v s v x e 2 y e 2 2 ε s v 2 λ φ v 2 s v 2 k v s v 2 γ u u e s v γ r r e s v x e 2 y e 2 4 ε v e 2 x e 2 y e 2 2 ε β 2 θ v 2 4 λ next we embark on designing the control laws of n c and δ c similarly define θ u max w u d n m u τ w u m u ε u φ u ϕ u 1 and θ r max w r d δ m r τ w r m r ε r φ r ϕ r 1 then the continuous control laws of n c and δ c are designed as eq 22 22 n c m u c u h n k u u e k f u u e γ u 2 s v 2 x e 2 y e 2 4 ε u e δ c m r c r h δ k r r e k f r r e γ r 2 s v 2 ψ e 2 4 ε r e where k u and k r are tuning parameters the damping parameters are selected as k f u λ φ u 2 and k f r λ φ r 2 define the lyapunov function as v 3 1 2 u e 2 1 2 r e 2 by synthesizing eq 18 and eq 22 we can render the time derivative of v 3 as eq 23 23 v 3 u e u e r e r e k u u e 2 λ φ u 2 u e 2 θ u φ u u e γ u 2 s v 2 x e 2 y e 2 4 ε u e 2 c u h n m u e n u e k r r e 2 λ φ r 2 r e 2 θ r φ r r e γ r 2 s v 2 ψ e 2 4 ε r e 2 c r h δ m r e δ r e k u c u 2 h n 2 2 m u 2 u e 2 k r c r 2 h δ 2 2 m r 2 r e 2 γ u 2 s v 2 x e 2 y e 2 4 ε u e 2 γ r 2 s v 2 ψ e 2 4 ε r e 2 θ u 2 θ r 2 4 λ w n w δ where w n 1 2 e n 2 and w δ 1 2 e δ 2 are the lyapunov functions of the sample induced errors let v v 1 v 2 v 3 by combining eq 13 eq 21 and eq 23 it renders that 24 v v 1 v 2 v 3 k x β 2 2 ε x e 2 k y β 2 2 ε y e 2 k ψ ψ e 2 k v s v 2 k u c u 2 h n 2 2 m u 2 u e 2 k r c r 2 h δ 2 2 m r 2 r e 2 w n w δ 7 ε θ u 2 θ v 2 θ r 2 4 λ here we define a 2 min k x β 2 2 ε k y β 2 2 ε k ψ k v k u c u 2 h n 2 2 m u 2 k r c r 2 h δ 2 2 m r 2 and b 7 ε θ u 2 θ v 2 θ r 2 4 λ eq 24 can be rewritten as 25 v a v b w n w δ step 3 in the common continuous path following control schemes the design has already been complete in the last step here the ideology of etc is employed and the triggering condition will be established in this step we require that the signals of n c and δ c are only sent to n ˆ and δ ˆ at the triggering instants during the flow period between two successive triggering instants the zohs are employed to keep n ˆ and δ ˆ unchanged observed from eq 25 we are inspired with the further design suppose that the current time point lands in the flow time of t l i t l i 1 with i n δ respectively and the current triggering instant is denoted as t l i it should be noted that the common initial triggering time t 0 is also deemed as the initial time of the voyage then the next triggering instant t l i 1 is determined by satisfying the following triggering condition 26 t l n 1 inf t r t t l n w n a 1 σ ζ v v μ t l δ 1 inf t r t t l δ w δ a 1 σ 1 ζ v v μ where 0 σ 1 is the tuning parameter 0 ζ 1 is the adjustable variable concerning separating triggering conditions which determines minimal inter event times of the rudder and the propeller respectively μ is a positive constant concerning the ultimate bound of v t which is selected to ensure v t 0 μ b a σ remark 1 according to tabuada 2007 σ should be selected in a trade off way it can be inferred from eq 26 that a larger σ implies a smaller inter event time higher convergence speed and precision and vice versa different with jiao and wang 2016a b triggering conditions are separately set for the rudder and the propeller in our scheme it will be proved subsequently that the larger ζ implies the longer inter event time of the propeller and the shorter of the rudder and vice versa following the nautical practice ζ should select to be slightly larger so as to guarantee the slow changing of the revolving rate of the main engine remark 2 in the scheme the so called static triggering condition is constructed which is not the state of art etc technology there are some recent outcomes towards setting of the triggering condition with superb control performances such as the dynamic triggering condition girard 2015 the combined time event triggering condition abdelrahim et al 2016 nevertheless these methods are with strict requirements for the model which does not accords with the ship furthermore it is convenient to prove the existence of minimal inter event time in our scheme more advanced etc will be addressed in our future works 4 stability analysis the proposed scheme in this paper is concluded as the following theorem theorem 1 assume that all the following variables are within a compact set ω x e y e ψ e u v r x e 2 y e 2 ψ e 2 u 2 v 2 r 2 u d 2 r d 2 δ ω where δ ω is a constant for the underactuated ship with kinetics eqs 1 3 the semi global uniformly ultimate boundedness sguub of all the error signals is guaranteed via the virtual control law eq 10 the adaptive law eq 19 and the control law eq 22 with the triggering condition eq 26 by tuning parameters appropriately all the tracking errors can be regulated to be arbitrarily small furthermore the minimal inter event times of both the rudder and the propeller can be ensured the zeno phenomenon is averted proof of sguub according to eq 26 it can be known that e i i n δ is reset to zero once the triggering condition is satisfied thus w n a 1 σ ζ v and w δ a 1 σ 1 ζ v always hold for v μ along the control process synthesizing with eq 25 it renders 27 v a σ v b which can be further transformed to v t v t 0 exp a σ t b a σ 1 exp a σ t according to the triggering condition of eq 26 we know that v t will finally converge to μ as all the components of the squared errors in v t are less than v t it is clear that all the errors finally converge to the bound of 2 μ by increasing a this bound can be tuned to be arbitrarily small thus the proof of sguub for all the errors is complete proof of minimal inter event times the minimal inter event times of the rudder and the propeller are first defined as t δ and t n respectively in brief expression we define k δ k r k f r γ r 2 s v 2 ψ e 2 4 ε k n k u k f u γ u s v 2 x e 2 y e 2 4 ε and k s v k v k f v x e 2 y e 2 2 ε then we differentiate w δ along the following flow time of the triggering instant t l δ it renders eq 28 by synthesizing eq 12 eq 18 eq 19 and eq 22 28 w δ δ c e δ m r c r h δ k δ r e e δ m r c r h δ k δ r e e δ c r h δ c r h δ e δ 2 k δ m r c r h δ c r 2 h δ 2 k δ 2 r e e δ m r k δ c r h δ θ r φ r e δ m r γ r 2 2 ε c r h δ θ v φ v s v r e e δ m r r e e δ 2 ε c r h δ k ψ ψ e 2 ψ e r e γ r 2 k s v s v 2 γ r 2 γ u u e s v γ r 3 r e s v c r h δ k δ c r h δ m r c r h δ k δ 2 2 c r 2 h δ 2 m r k δ k f r c r h δ m r γ r 2 k f v s v 2 r e 2 2 ε c r h δ e δ 2 m r r e 2 e δ 2 4 ε c r h δ k ψ 1 2 ψ e 2 γ r 3 2 1 2 r e 2 1 2 γ r 2 γ u u e 2 γ r 2 k s v γ r 2 γ u 2 γ r 3 2 s v 2 m r k δ θ r 2 4 λ c r h δ m r c r h δ k δ 2 r e 2 2 c r 2 h δ 2 m r γ r 2 θ v 2 8 λ ε c r h δ define two class k functions as α δ v 2 c r h δ k δ c r h δ m r c r h δ k δ 2 c r 2 h δ 2 2 m r k δ k f r c r h δ m r γ r 2 k f v s v 2 r e 2 ε c r h δ m r 2 ε c r h δ k ψ 1 2 ψ e 2 γ r 3 2 1 2 r e 2 1 2 γ r 2 γ u u e 2 γ r 2 k s v γ r 2 γ u 2 γ r 3 2 s v 2 and β δ v m r c r h δ k δ 2 r e 2 2 c r 2 h δ 2 m r r e 2 4 ε c r h δ k ψ 1 2 ψ e 2 γ r 3 2 1 2 r e 2 1 2 γ r 2 γ u u e 2 γ r 2 k s v γ r 2 γ u 2 γ r 3 2 s v 2 the constant as b δ m r k δ θ r 2 4 λ c r h δ m r γ r 2 θ v 2 8 λ ε c r h δ then eq 28 can be rewritten as 29 w δ α δ v w δ β δ v b δ it can be observed from eq 27 that v t is bounded by the decreasing function from v t 0 to μ thus it has v t 0 v t in the discussing time interval t t l δ t l δ 1 according to eq 29 the following inequality holds 30 w δ t β δ v t 0 b δ α δ v t 0 e α δ v t 0 t t l δ β δ v t 0 b δ α δ v t 0 from the triggering condition of eq 26 we know that v μ holds at triggering instants thus we can infer from eq 30 that the inter event time of the rudder satisfy 31 t δ 1 α δ v t 0 ln 1 a μ 1 σ 1 ζ α δ v t 0 β δ v t 0 b δ the right side of eq 31 is a positive the proof of the rudder is complete similarly if we differentiate w n along the flow time of the triggering instant t l n it yields 32 w n n c e n m u c u h n k n u e e n m u c u h n k n u e e n c u h n c u h n e n 2 k n m u c u h n c u 2 h n 2 k n 2 u e e n m u k n c u h n θ u φ u e n m u γ u 2 2 ε c u h n θ v φ v s v u e e n m u u e e n 2 ε c u h n k x x e 2 k y y e 2 u e x e cos ψ v e x e sin ψ u e y e sin ψ γ u 3 u e s v v e y e cos ψ γ u 2 k s v s v 2 γ u 2 γ r r e s v c u h n k n c u h n m u c u h n k n 2 2 c u 2 h n 2 m u k n k f u c u h n m u γ u 2 k f v s v 2 u e 2 2 ε c u h n e n 2 n m u u e 2 e n 2 4 ε c u h n k x 1 x e 2 k y 1 y e 2 γ u 3 2 1 u e 2 v e 2 γ u 3 2 γ u 2 γ r 2 γ u 2 k s v s v 2 γ u 2 γ r 2 r e 2 m u k n θ u 2 4 λ c u h n m u c u h n k n 2 u e 2 2 c u 2 h n 2 m u γ u 2 θ v 2 8 λ ε c u h n here we define two class k functions as α n v 2 c u h n k n c u h n m u c u h n k n 2 c u 2 h n 2 2 m u k n k f u c u h n m u γ u 2 k f v s v 2 u e 2 ε c u h n m u 2 ε c u h n k x 1 x e 2 k y 1 y e 2 γ u 3 2 1 u e 2 v e 2 γ u 3 2 γ u 2 γ r 2 γ u 2 k s v s v 2 γ u 2 γ r 2 r e 2 and β n v m u c u h n k n 2 u e 2 2 c u 2 h n 2 m u u e 2 4 ε c u h n k x 1 x e 2 k y 1 y e 2 γ u 3 2 1 u e 2 v e 2 γ u 3 2 γ u 2 γ r 2 γ u 2 k s v s v 2 γ u 2 γ r 2 r e 2 the constant as b n m u k n θ u 2 4 λ c u h n m u γ u 2 θ v 2 8 λ ε c u h n similar to eq 29 31 it can be inferred that the inter event time of the propeller satisfy 33 t n 1 α n v t 0 ln 1 a μ 1 σ ζ α n v t 0 β n v t 0 b n the right side of eq 33 is a positive constant the proof of the propeller is complete 5 simulation to verify the effectiveness of the proposed scheme and outstand the superiority of it with common methods three cases are compared in the simulation with identical sea states the training ship in dalian maritime university called yu peng is selected as the control objective seeing fig 2 here we assume the ballast draft of yu peng in the simulation the basic coefficients in this condition are presented in table 1 according to eq 2 the inertial parameters are calculated by empirical equations referring to fossen 2011 and the hydrodynamic parameters of yu peng are preliminarily identified by regressive least square method from the data of real sea trial seeing the eq 34 to comply with the practice we set the limits of the actuators as n 10000 rpm 2 n 22500 rpm 2 δ 1225 deg 2 and δ 1225 deg 2 respectively the bounds of uncertain gains of the actuators are set as c u 1000 c u 2000 c r 1 5 10 5 and c r 2 5 10 5 respectively the actual values of these gains are slowly changing within the bounds according to the mechanic characteristics of actuators fossen 2011 it should be noted that the bounds of actuators can be roughly estimated in reality as our scheme is robust 34 m u 2 33 10 7 m v 3 60 10 7 m r 5 04 10 10 y r 1 10 10 7 x u 4 06 10 6 x u u 9 25 10 4 y v 1 50 10 6 y v v 1 50 10 6 y r v 2 20 10 5 y r 3 26 10 7 y v r 2 20 10 5 y r r 4 52 10 8 n v 2 96 10 7 n v v 6 32 10 5 n r v 5 78 10 5 n r 8 90 10 9 n v r 5 63 10 7 n r r 2 50 10 11 to guarantee the high fidelity of simulation the experiment is conducted in the platform of simulated sea environment which was also adopted in our recent work deng et al 2019 it assumes a non fully developed sea state with the wave described by the jonswap spectrum and the wind by davenport spectrum via the mechanism model of wave and wind the environmental disturbances τ w u τ w v and τ w r can be further deduced the platform is representative to describe the wind generated waves with finite water depth as only limited information is needed here the formulaic discussion is omitted in the simulation an usual sea state is presumed with beaufort wind scale no 5 of the northwest wind the average speed of which is approximately 9 8 m s seeing fig 3 set six waypoints in the electronic chart with the coordinates as 0 m 0 m 0 m 2500 m 2500 m 3500 m 2500 m 6500 m 500 m 7500 m 500 m 10000 m considering the turning radius of yu peng we set the interpolated radiuses of the virtual ship guidance around these waypoints as 500 m the initial attitudes of yu peng are set as x y ψ 500 m 0 m 90 the initial kinestates and compensating variable ϑ v are all set to be zeros the surge speed u d of the virtual ship is set to be 15 knot the control parameters of the proposed scheme in the simulation are set as eq 35 35 γ 1 0 1 k x 2 k y 2 k ψ 0 1 k u 0 1 k r 0 1 β 1 k v 0 1 γ u 1 γ r 0 01 ε 2 k f u 10 k f r 15 σ 0 5 μ 0 1 for convenience yu peng with three cases are denoted as the no 1 the no 2 and the no 3 ships separately the no 1 ship is selected as the comparing example by adopting the ideology of discrete control katayama and aoki 2014 in that scheme the los guidance is employed with the constant reference surge speed of the ship also set as 15 knot in the simulation accordingly the model eq 1 and eq 2 is first transformed to the discrete form by euler s approximation and the discrete controller is ulteriorly derived with the sampling period t involved as a design factor as the larger t will degrade the control performance it is selected to be 0 1 s for the no 1 ship to keep uniformity in the control inputs the actuator gains are assumed to be known for that ship with no more tautology one can refer to katayama and aoki 2014 2011 for its formulaic details the no 2 and the no 3 ships are used to reveal the superiority of the developed scheme and illustrate the adjustment of the event triggered mechanism here they are both outfitted with the continuous control law of eq 22 but the no 2 ship is set with ζ 0 8 while the no 3 ship ζ 0 2 then we proceed the simulation and launch out all three ships simultaneously after all ships arrive the terminal waypoint the planar trajectories of them are observed in fig 4 it shows that all the ships could accomplish final convergence to the reference path whereas in the local enlarged region our scheme has higher precision than the los based approach as only the ζ is changed there is little difference in trajectories between the no 2 and the no 3 ships it can also be learnt from fig 5 and fig 6 that attitudes and kinestates of them are very similar the position errors of x e and y e in fig 5 are stabilized to the vicinity of zero after 400s due to the large inertia of yu peng overshoots of the heading angle error ψ e occur at every turning manoeuvring but the proposed scheme can ensure the reversion of overshoots soon afterwards it shows in fig 6 that u of the ship finally converges to u d of the virtual ship and v to the neighborhood of zero but overshoots of v still happen because of the environmental disturbances it is observed from fig 6 that small high frequency chattering accompanies the entire voyage especially in the yaw motion in fact by the merit of robust damping design the chattering phenomenon has already been largely mitigated here compared with the adaptive scheme in fig 7 the evolution of the adaptive compensating variable ϑ v of the no 2 ship is given we can observe that steps of ϑ v occur with large overshoots of v namely at the time of turning manoeuvering it tends to be moderate in the straight line of path following then we analyze control inputs of the three cases in fig 8 a the evolution of terminal control inputs of n a and δ a are exhibited from the 0s 1700s it can be observed that the input saturation happens in the initial stage and the turning manoeuvring due to the large attitude errors for the propeller the proposed scheme has larger overshoots than the comparison that is because the difference in guidance approaches in the los guidance the constant surge speed is tracked whereas in the virtual ship guidance the virtual control term α u is tracked which relies on the attitude errors for the rudder the three cases follow the same mainstream of evolution but the amplitude of the proposed scheme in straight line path following is greater than that of the comparison it is reasonable since the higher tracking precision of the proposed scheme is guaranteed in fig 4 which means more energy is costed to cancel out the adverse effects of disturbances in fig 8 b the local enlarged diagrams of control inputs around 358s for the propeller and 1067s for the rudder are shown because the running time for the entire voyage is very long only these two typical points are selected we can observe from fig 8 b that the inter event time of the no 2 ship is larger than that of the no 3 ship in the propeller and vice versa in the rudder it conforms to the analysis in the remark 1 that the inter event time of actuators can be tuned by ζ in a quantified way we denote the minimum the maximum and the average inter event time as t m i n t m a x and t m e a n respectively as calculated in the table 2 t m a x and t m e a n of the no 2 in the propeller are larger than that of the no 3 while the total triggered times of the entire voyage of the no 2 in the propeller are smaller and vice versa in the rudder it should be noted that in the first figure of fig 8 b both the inter event time of the no 2 and the no 3 ship are smaller than that of the no 1 ship namely 0 1s that doesn t mean the inferior performance of the event triggered scheme as the time around 358s accounts for the turning manoeuvring near the waypoint of 0 m 2500 m finer control process is preferred it can also be seen in table 2 that although all the t m i n s in actuators are smaller than 0 1s all the t m e a n s are larger as is observed the time triggered ideology of the no 1 ship acts every 0 1s even if the amplitude difference between two consecutive triggering instants is very small in contrary the event triggered ideology of the no 2 and the no 3 ship acts in a more intellective way namely fine controls in necessary manoeuvring and slack controls in straight line courses reflected on fig 9 the evolution of total triggering times of the proposed scheme increases slowly in straight line path following but rapidly in turning manoeuvring and is significantly lower than that of the time triggered scheme which is proportional to time 6 conclusion this paper developed a practical path following control scheme for the underactuated ship which took into account the existence of uncertainties the input saturation and the limited acting frequency of actuators the nonlinearities of input saturation were restructured as the gauss error functions the underactuated problem was solved by compensating the tracking error of the sway motion with an adaptive variable with the fls approximating the uncertainties the robust damping control design was conducted in the backstepping frame by following the etc in the channel of controller to actuator the control commands of actuators were finally rendered furthermore the triggering condition was designed separately comparing with the previous time triggered schemes for the ship the proposed one is more intellective and reduces the acting frequency in a general meaning comparing with the previous event triggered schemes the proposed one is able to tune the minimum inter event times of actuators manually according to practical requirements nevertheless the proposed scheme may suffer from the shortage of conservatism while possessing robustness to environmental disturbances and saturation constraints this issue will be addressed in the future acknowledgements this work is partially supported by the national science foundation of china no 51679024 and no 51779029 the fundamental research funds for the central university no 3132016315 the national high technology research and development program of china no 2015aa016404 the university 111 project of china no b08046 the key research and development plan of shandong province no 2018ggx105014 the project of shandong province higher educational science and technology no j18ka010 the project of shandong province transportation science and technology program no 2018b69 the project of development of shiphandling and passenger evacuation support system funded by the ministry of oceans and fisheries of korea the author would sincerely thank the anonymous reviewers for their pertinent and instructive suggestions to improve the quality of this paper 
22708,to promise the high fidelity of path following control for the underactuated ship this paper develops an event triggered robust fuzzy control scheme which also releases the constraint of input saturation to solve the underactuated problem we add an adaptive bounded term to the tracking error in the sway motion which allocates the error to actuated motions in the control scheme the fuzzy logic systems fls are employed to approximate the uncertainties while the methodology of robust damping is adopted the gauss error functions are introduced to approximate the structure of input saturation such that the backstepping frame can be applied and the control commands in the rudder angle and the revolving rate of the main engine are derived to avert the frequent acting of actuators the event triggered control etc technique is adopted the static triggered condition is constructed with a flexible adjustable variable which regulates the minimal inter event times for actuators via the direct lyapunov approach we prove the existence of the minimal inter event time and the uniform boundedness of all tracking errors in the closed loop system finally the feasibility of the scheme is validated in the platform of the simulated ocean environment keywords path following underactuated ships input saturation robust fuzzy damping event triggered control 1 introduction as one of typical scenarios of ship s manoeuvering path following has been widely studied over the past decades a potential future on this issue is expected in the context of worldwide recognition for mass marine autonomous surface ships which was legally admitted by imo international maritime organization in 2018 in common working condition the mass is an underactuated system with only the surge and the rolling motions are controllable the path following task for it is usually comprised of three components namely the path planning the guidance and the control in the specific frame of planning and guidance the control part is the most challenging issue which needs to reconcile the problems of the underactuated characteristic the environmental disturbances and the modeling uncertainties etc liu et al 2016 although plenties of outcomes have been achieved in this issue by resorting to advanced cybernetics most of them were not compatible with the marine devices that is because of both complexity of these algorithms and lack of practical considerations which refers to the informational unbalance fossen 2011 it can be divided into two categories to address the path following control of underactuated ships with respect to diverse guidance approaches liu et al 2017a one is to reinterpret the error dynamics by frame transformation or geometrical rationale two typical cases are line of sight los guidance fossen et al 2003 and serret frenet sf frame encarnacao et al 2000 these approaches usually ignore the control in surge motion and suppose the surge speed to be a constant to solve the underactuated problem the assumption of omissible sway speed is made li et al 2009 liu et al 2017a or the leeway angle is compensated lekkas and fossen 2014 fossen et al 2015 or estimated liu et al 2017b the other train of thought is to structure an ideal virtual ship sailing along the reference path without inertia and damping so as to transform the path following to the tracking of the virtual ship zhang and zhang 2015 the surging motion is also considered in this approach and it is applicable to fruitful outcomes towards tracking control in view of the tracking control for underactuated ships lyapunov theory based backstepping control approaches were developed in jiang 2002 and do et al 2002 by utilizing the interconnected structure of the ship via state transformation dong and guo 2005 proposed three stabilizing controller with different convergent rates ghommam et al 2010 developed an united stabilizing and tracking controller on the basis of the cascade structure of the ship besides slowly varying bias of the disturbances can be counteracted concluded from previous outcomes li et al 2008 only considered surge and yaw motions in controller design while the sway motion was self constrained by passivity although the above methodologies succeeded to solve the tracking control of underactuated ships in mathematical deduction they are not palatable to the nautical practice to meet the marine reality the consideration of engineering factors must be involved in the control scheme do and pan 2005 first coped with off diagonal inertia matrix of the ship s model which accords with the asymmetric geometrical feature of the ship in do 2010 the notion of practical control was proposed which reveals the present mainstream in this field in most of the previous researches the constraints generated by the actuators are omitted whereas the analysis of these constraint is indispensable to ensure the applicability of control schemes one of these constraints is the input saturation to solve this one can refer to zheng and sun 2016 and liu et al 2017a for the dynamic auxiliary system shojaei 2015 for the saturated filters jin 2016 for the barrier lyapunov function park et al 2017 for the additional control term and li et al 2015 2016 zhou et al 2017 for the sigmoid function approximation nevertheless all these researches finally derived the control inputs with the form of thrust and turning torque which can not be referred to by actuators directly in contrast it is more practical to offer the commands in the rudder angle and the revolving rate of the propeller to this end liu et al 2017a rendered the input of rudder angles with known actuator gains and an adaptive approach for uncertain actuator gains was proposed in zhang et al 2017 2018 due to the large overshoot of the adaptive schemes at the initial stage the control performance will be degraded it should be further investigated that only the bounds of gains are available another constraint lies in the limited acting frequency of the actuators in nautical practice the digital computer with sampler and zero order holder zoh is employed to emulate the continuous time control scheme and the control command will be updated periodically katayama and aoki 2014 long term high frequency action will lead to the mechanical abrasion and shorten the service life of actuators thus it is practical to lower the acting frequencies of actuators and increase the acting periods as larger period will degrade the control performance it is preferred that control only happens when it is necessary that is the event triggered control tabuada 2007 for the fully actuated ship emulation like backstepping approaches were proposed in jiao and wang 2016a b where the controller was first designed by ignoring the communication constraint fu et al 2017 integrated the active disturbance rejection control with the etc and devised a dynamic positioning controller in postoyan et al 2015 the etc tracking controller for the underactuated unicycle mobile robot was developed to the best of the author s knowledge there are still no researches investigating the etc for underactuated ships besides all the above methods premised the accurate model to approximate both internal and external uncertainties of the model we can refer to the neural networks or the fls for their universal approximation ability and yet we need to find the way to promote their good match with the etc further to reduce the complexity of the control laws the methodology of robust damping should be considered deng et al 2019 motivated by the above analysis this paper embarks on developing a synthesized path following control law for the underactuated ship with input saturation and uncertainties the contributions are mainly twofold 1 the proposed control scheme addresses several practical factors together first the saturation nonlinearities of actuators are represented by the gauss error functions such that the backstepping design can be easily used secondly by following the robust damping design the control laws possess a succinct form while there is no need to update the weights of fls thirdly we derive the control commands in the rudder angle and the revolving rate of the main engine which are more acceptable to the actuators fourthly we restructure the tracking error in the sway motion with the gauss error function of an adaptive compensating variable which allocates this error to the actuated motions and solves the underactuated problem 2 the ideology of etc is employed in the scheme to avoid the frequent acting of actuators creatively the propeller and the rudder are separately discussed with the mechanism to adjust their acting frequency flexibly the existence of minimal inter event time is proven such that the accumulation of triggering instants namely the so called zeno phenomenon is avoided the remainder of this paper is organized as following preliminaries are deployed in section 1 the control scheme is designed in section 2 section 3 analyzes the closed loop stability and the existence of minimal inter event time the comparative experiment in the simulated sea environment is conducted in section 4 section 5 concludes the whole paper notations uniformly in this paper sign denotes the sign function implies the 2 norm of the variable inf denotes the infimum of the discussed element 2 preliminaries 2 1 mathematical model according to fossen 2011 the motions of a surface ship can be described in two right handed cartesian coordinates of the body and the earth as for path following only three motions namely surge sway and yaw need to be considered in the earth frame the kinematic loop of eq 1 is fabricated which depicts the attitudes of the ship while in the body frame the dynamic loop of eq 2 is fabricated and the kinestates are described 1 x u cos ψ v sin ψ y u sin ψ v cos ψ ψ r 2 m u u τ u τ w u m v v r y r r 2 x u u x u u u u m v v τ w v m u u r y v v y v v v v y r v r v y r r y v r v r y r r r r m r r τ r τ w r m u m v u v y r u r n v v n v v v v n r v r v n r r n v r v r n r r r r where x y imply the horizontal coordinates of the ship ψ the heading angle u v r denote the translational and the angular speeds in surge sway and yaw motions respectively m i i u v r denote the ship inertia including the additional mass or moment respectively x y n with subscripts denote hydraulic derivatives generated by the damping effect τ w i denotes the environmental disturbance of each motion with the upper bound τ w i τ w i where τ w i is a positive constant τ u and τ r are the thrust and the turning torque according to characteristics of the rudder and the propeller they can be further written as eq 3 3 τ u c u t n n n a n a τ r c r t δ δ δ a δ a where n a is the actual revolving rate of the propeller δ a is the actual rudder angle in a simple way we can deem n and δ as the control inputs c u t and c r t are the time varying gains of the propeller and the rudder we assume that their upper bounds of c u and c r and lower bounds of c u and c r are known positive constants in view of the saturation constraint we presume that n and δ follow eq 4 4 n n i f n ˆ n n ˆ i f n n ˆ n n i f n ˆ n δ δ i f δ ˆ δ δ ˆ i f δ δ ˆ δ δ i f δ ˆ δ where n ˆ and δ ˆ are the ideal control commands n and δ denote positive upper limits n and δ lower negative limits 2 2 the virtual ship guidance the virtual ship guidance principle is adopted to proceed the following design which has been delineated in zhang and zhang 2015 deng et al 2019 this principle can transform the path following of the reference path to the tracking of the virtual ship and its rationale is shown in fig 1 while the waypoints are set in the electronic chart the reference path is first generated by connecting waypoints and interpolating arcs in the waypoints a virtual ship without inertia and damping is employed to generate the time series of positional coordinates x d y d and heading angles ψ d its kinetics can be described as x d u d cos ψ d y d u d sin ψ d and ψ d r d to guarantee the asymptotic consensus of ψ to ψ d we introduce the approaching angle as eq 5 5 ψ d a erf γ 1 x e 2 y e 2 arctan y e x e 1 erf γ 1 x e 2 y e 2 ψ d where x e x x d and y e y y d γ 1 is a parameter determining the transitional speed from arctan y e x e to ψ d erf is the gauss error function of the sigmoid shape defined by eq 6 6 erf x 2 π 0 π 2 x e t 2 dt where eq 6 is continuously differentiable with the upper and the lower bounds of 1 defining ψ e ψ ψ d a and from eq 5 and eq 6 we can know that ψ d a ψ d while x e 2 y e 2 0 and x x d y y d ψ ψ d while x e 0 y e 0 ψ e 0 then the control objective is concluded as following control objective under the saturation constraint of eq 4 design the law for ideal control commands n ˆ and δ ˆ to impel the ship with kinetics eq 1 and eq 2 to converge to the position x d y d and the heading angle ψ d of the virtual ship namely stabilize the errors x e y e and ψ e 2 3 approximation of fls in our scheme the fls is employed to approximate nonlinear functions according to wang 1994 the fls is constructed based on the fuzzy rules base and it is utilized by three steps that is fuzzification fuzzy reasoning and defuzzification a multi input single output system can thereby described by a fls with n rules as eq 7 7 y x l 1 n w l s l x l 1 n s l x where y is the output x is the input vector w l is the weight of each fuzzy rule s l x is the product of membership functions let s rewrite φ l s l l 1 n s l as the fuzzy basis function defining w w 1 w n t and ϕ φ 1 φ n t it can be described that y w t ϕ thus the approximation of fls can be concluded as the following lemma lemma 1 li et al 2015 2016 2019 for any continuous function f x defined on a compact set we can always find a fls satisfying eq 8 with an arbitrarily small constant ε 8 f x w t ϕ x ε 3 controller design in this section the control laws for n ˆ and δ ˆ are devised to resolve the tracking problem namely stabilize x e y e and ψ e it is divided into three steps in the first step the virtual control laws in three motions are devised our scheme adopts the ideology of emulation based etc thus in the second step the continuous control laws for n ˆ and δ ˆ denoted as n c and δ c are devised in advance and the underactuated problem is resolved then in the third step the triggering condition is devised step 1 according to kinematic loops of the eq 1 and the virtual ship the error system of eq 9 is first obtained 9 x e u e α u cos ψ u d cos ψ d v e α v sin ψ y e u e α u sin ψ u d sin ψ d v e α v cos ψ ψ e r e α r ψ d a where α i is the virtual control laws of i u v r and i e i α i according to the backstepping approach the virtual control laws are devised as eq 10 10 α u k x x e cos ψ k y y e sin ψ u d cos ψ d ψ α v k x x e sin ψ k y y e cos ψ u d sin ψ d ψ α r k ψ ψ e ψ d a y e u sin ψ v cos ψ u d sin ψ d ψ d a x e u cos ψ v sin ψ u d cos ψ d ψ d a ψ d r d where k x k y k ψ are tuning parameter the partial derivatives of ψ d a can be acquired by synthesizing eq 5 and eq 9 as 11 ψ d a y e γ 1 exp π 4 γ 1 2 x e 2 y e 2 y e x e 2 y e 2 arctan y e x e ψ d x e erf x e 2 y e 2 ψ d a x e γ 1 exp π 4 γ 1 2 x e 2 y e 2 x e x e 2 y e 2 arctan y e x e ψ d y e erf x e 2 y e 2 ψ d a ψ d 1 erf γ 1 x e 2 y e 2 then by substituting eq 10 and eq 11 to eq 9 it can be rendered that 12 x e k x x e u e cos ψ v e sin ψ y e k y y e u e sin ψ v e cos ψ ψ e k ψ ψ e r e defining the lyapunov function as v 1 1 2 x e 2 1 2 y e 2 1 2 ψ e 2 one can render its time derivative of eq 13 by differentiating it with eq 12 13 v 1 x e x e y e y e ψ e ψ e k x x e 2 k y y e 2 k ψ ψ e 2 u e x e cos ψ v e x e sin ψ u e y e sin ψ v e y e cos ψ ψ e r e step 2 according to ma et al 2015 the saturation constraint of eq 4 can be rewritten as the gauss error function plus the approximating error of eq 14 14 n n m erf n ˆ n m d n δ δ m erf δ ˆ δ m d δ where n m n n 2 n n 2 sign n ˆ and δ m δ δ 2 δ δ 2 sign δ ˆ d n and d δ are approximating errors with the upper bounds d n d n and d δ d δ observing eq 14 it can be transformed to eq 15 by lagrangian mean value theorem 15 n h n n ˆ d n δ h δ δ ˆ d δ where h n and h δ are expressed by 16 h n exp π t 2 4 n m 2 t 0 n ˆ h δ exp π t 2 4 δ m 2 t 0 δ ˆ as our scheme will not render an infinite value of n ˆ and δ ˆ it is tenable to presume that h n and h δ are bounded with h n h n h n and h δ h δ h δ by employing the lemma 1 the nonlinear terms in the dynamic loop eq 2 are expressed as eq 17 17 w u t ϕ u ε u m v v r y r r 2 x u u x u u u u α u m u w v t ϕ v ε v m u u r y v v y v v v v y r v r v y r r y v r v r y r r r r α v w r t ϕ r ε r m u m v u v y r u r n v v n v v v v α r n r v r v n r r n v r v r n r r r r where ε denotes the approximating error the subscripts u v r denote the discussing motions as the continuous control law n c and δ c will be first designed here we define the sampling induced control errors as e n n ˆ n c and e δ δ ˆ δ c by synthesizing eq 2 eq 3 eq 15 and eq 17 one can get the error system of the dynamic loop as eq 18 18 u e c u h n m u n c c u h n m u e n d n m u τ w u m u ε u w u t ϕ u v e τ m v m v ε v w v t ϕ v r e c r h δ m r δ c c r h δ m r e δ d δ m r τ w r m r ε r w r t ϕ r aiming at the underactuated problem we define the combined error function as s v v e β erf ϑ v where β is a small constant ϑ v is the adaptive compensating variable as the gauss error function erf ϑ v is bounded the stabilization of v e equates to the stabilization of s v according to the robust damping technique of zhang and zhang 2017 zhang et al 2017 we define the damping term as φ v ϕ v 1 and the compressed weight as θ v max w v τ w v m v ε v then the updating law of ϑ v is devised as eq 19 19 ϑ v exp π 4 ϑ v 2 β k v s v γ u u e γ r r e k f v s v x e 2 y e 2 2 ε s v where k v is the tuning parameter γ u and γ r are the distributing parameters which distributes the s v to surge and yaw motions ε denotes a small constant and k f v λ φ v 2 where λ is a positive tuning parameter then we define the lyapunov function as v 2 1 2 s v 2 from the structure of s v the following young s inequality is first constructed for the subsequent simplification 20 v e 2 2 s v 2 2 β 2 by synthesizing eq 18 and 19 and eq 20 the time derivative of v 2 can be rendered as eq 21 21 v 2 s v s v k v s v 2 γ u u e s v γ r r e s v θ v φ v s v x e 2 y e 2 2 ε s v 2 λ φ v 2 s v 2 k v s v 2 γ u u e s v γ r r e s v x e 2 y e 2 4 ε v e 2 x e 2 y e 2 2 ε β 2 θ v 2 4 λ next we embark on designing the control laws of n c and δ c similarly define θ u max w u d n m u τ w u m u ε u φ u ϕ u 1 and θ r max w r d δ m r τ w r m r ε r φ r ϕ r 1 then the continuous control laws of n c and δ c are designed as eq 22 22 n c m u c u h n k u u e k f u u e γ u 2 s v 2 x e 2 y e 2 4 ε u e δ c m r c r h δ k r r e k f r r e γ r 2 s v 2 ψ e 2 4 ε r e where k u and k r are tuning parameters the damping parameters are selected as k f u λ φ u 2 and k f r λ φ r 2 define the lyapunov function as v 3 1 2 u e 2 1 2 r e 2 by synthesizing eq 18 and eq 22 we can render the time derivative of v 3 as eq 23 23 v 3 u e u e r e r e k u u e 2 λ φ u 2 u e 2 θ u φ u u e γ u 2 s v 2 x e 2 y e 2 4 ε u e 2 c u h n m u e n u e k r r e 2 λ φ r 2 r e 2 θ r φ r r e γ r 2 s v 2 ψ e 2 4 ε r e 2 c r h δ m r e δ r e k u c u 2 h n 2 2 m u 2 u e 2 k r c r 2 h δ 2 2 m r 2 r e 2 γ u 2 s v 2 x e 2 y e 2 4 ε u e 2 γ r 2 s v 2 ψ e 2 4 ε r e 2 θ u 2 θ r 2 4 λ w n w δ where w n 1 2 e n 2 and w δ 1 2 e δ 2 are the lyapunov functions of the sample induced errors let v v 1 v 2 v 3 by combining eq 13 eq 21 and eq 23 it renders that 24 v v 1 v 2 v 3 k x β 2 2 ε x e 2 k y β 2 2 ε y e 2 k ψ ψ e 2 k v s v 2 k u c u 2 h n 2 2 m u 2 u e 2 k r c r 2 h δ 2 2 m r 2 r e 2 w n w δ 7 ε θ u 2 θ v 2 θ r 2 4 λ here we define a 2 min k x β 2 2 ε k y β 2 2 ε k ψ k v k u c u 2 h n 2 2 m u 2 k r c r 2 h δ 2 2 m r 2 and b 7 ε θ u 2 θ v 2 θ r 2 4 λ eq 24 can be rewritten as 25 v a v b w n w δ step 3 in the common continuous path following control schemes the design has already been complete in the last step here the ideology of etc is employed and the triggering condition will be established in this step we require that the signals of n c and δ c are only sent to n ˆ and δ ˆ at the triggering instants during the flow period between two successive triggering instants the zohs are employed to keep n ˆ and δ ˆ unchanged observed from eq 25 we are inspired with the further design suppose that the current time point lands in the flow time of t l i t l i 1 with i n δ respectively and the current triggering instant is denoted as t l i it should be noted that the common initial triggering time t 0 is also deemed as the initial time of the voyage then the next triggering instant t l i 1 is determined by satisfying the following triggering condition 26 t l n 1 inf t r t t l n w n a 1 σ ζ v v μ t l δ 1 inf t r t t l δ w δ a 1 σ 1 ζ v v μ where 0 σ 1 is the tuning parameter 0 ζ 1 is the adjustable variable concerning separating triggering conditions which determines minimal inter event times of the rudder and the propeller respectively μ is a positive constant concerning the ultimate bound of v t which is selected to ensure v t 0 μ b a σ remark 1 according to tabuada 2007 σ should be selected in a trade off way it can be inferred from eq 26 that a larger σ implies a smaller inter event time higher convergence speed and precision and vice versa different with jiao and wang 2016a b triggering conditions are separately set for the rudder and the propeller in our scheme it will be proved subsequently that the larger ζ implies the longer inter event time of the propeller and the shorter of the rudder and vice versa following the nautical practice ζ should select to be slightly larger so as to guarantee the slow changing of the revolving rate of the main engine remark 2 in the scheme the so called static triggering condition is constructed which is not the state of art etc technology there are some recent outcomes towards setting of the triggering condition with superb control performances such as the dynamic triggering condition girard 2015 the combined time event triggering condition abdelrahim et al 2016 nevertheless these methods are with strict requirements for the model which does not accords with the ship furthermore it is convenient to prove the existence of minimal inter event time in our scheme more advanced etc will be addressed in our future works 4 stability analysis the proposed scheme in this paper is concluded as the following theorem theorem 1 assume that all the following variables are within a compact set ω x e y e ψ e u v r x e 2 y e 2 ψ e 2 u 2 v 2 r 2 u d 2 r d 2 δ ω where δ ω is a constant for the underactuated ship with kinetics eqs 1 3 the semi global uniformly ultimate boundedness sguub of all the error signals is guaranteed via the virtual control law eq 10 the adaptive law eq 19 and the control law eq 22 with the triggering condition eq 26 by tuning parameters appropriately all the tracking errors can be regulated to be arbitrarily small furthermore the minimal inter event times of both the rudder and the propeller can be ensured the zeno phenomenon is averted proof of sguub according to eq 26 it can be known that e i i n δ is reset to zero once the triggering condition is satisfied thus w n a 1 σ ζ v and w δ a 1 σ 1 ζ v always hold for v μ along the control process synthesizing with eq 25 it renders 27 v a σ v b which can be further transformed to v t v t 0 exp a σ t b a σ 1 exp a σ t according to the triggering condition of eq 26 we know that v t will finally converge to μ as all the components of the squared errors in v t are less than v t it is clear that all the errors finally converge to the bound of 2 μ by increasing a this bound can be tuned to be arbitrarily small thus the proof of sguub for all the errors is complete proof of minimal inter event times the minimal inter event times of the rudder and the propeller are first defined as t δ and t n respectively in brief expression we define k δ k r k f r γ r 2 s v 2 ψ e 2 4 ε k n k u k f u γ u s v 2 x e 2 y e 2 4 ε and k s v k v k f v x e 2 y e 2 2 ε then we differentiate w δ along the following flow time of the triggering instant t l δ it renders eq 28 by synthesizing eq 12 eq 18 eq 19 and eq 22 28 w δ δ c e δ m r c r h δ k δ r e e δ m r c r h δ k δ r e e δ c r h δ c r h δ e δ 2 k δ m r c r h δ c r 2 h δ 2 k δ 2 r e e δ m r k δ c r h δ θ r φ r e δ m r γ r 2 2 ε c r h δ θ v φ v s v r e e δ m r r e e δ 2 ε c r h δ k ψ ψ e 2 ψ e r e γ r 2 k s v s v 2 γ r 2 γ u u e s v γ r 3 r e s v c r h δ k δ c r h δ m r c r h δ k δ 2 2 c r 2 h δ 2 m r k δ k f r c r h δ m r γ r 2 k f v s v 2 r e 2 2 ε c r h δ e δ 2 m r r e 2 e δ 2 4 ε c r h δ k ψ 1 2 ψ e 2 γ r 3 2 1 2 r e 2 1 2 γ r 2 γ u u e 2 γ r 2 k s v γ r 2 γ u 2 γ r 3 2 s v 2 m r k δ θ r 2 4 λ c r h δ m r c r h δ k δ 2 r e 2 2 c r 2 h δ 2 m r γ r 2 θ v 2 8 λ ε c r h δ define two class k functions as α δ v 2 c r h δ k δ c r h δ m r c r h δ k δ 2 c r 2 h δ 2 2 m r k δ k f r c r h δ m r γ r 2 k f v s v 2 r e 2 ε c r h δ m r 2 ε c r h δ k ψ 1 2 ψ e 2 γ r 3 2 1 2 r e 2 1 2 γ r 2 γ u u e 2 γ r 2 k s v γ r 2 γ u 2 γ r 3 2 s v 2 and β δ v m r c r h δ k δ 2 r e 2 2 c r 2 h δ 2 m r r e 2 4 ε c r h δ k ψ 1 2 ψ e 2 γ r 3 2 1 2 r e 2 1 2 γ r 2 γ u u e 2 γ r 2 k s v γ r 2 γ u 2 γ r 3 2 s v 2 the constant as b δ m r k δ θ r 2 4 λ c r h δ m r γ r 2 θ v 2 8 λ ε c r h δ then eq 28 can be rewritten as 29 w δ α δ v w δ β δ v b δ it can be observed from eq 27 that v t is bounded by the decreasing function from v t 0 to μ thus it has v t 0 v t in the discussing time interval t t l δ t l δ 1 according to eq 29 the following inequality holds 30 w δ t β δ v t 0 b δ α δ v t 0 e α δ v t 0 t t l δ β δ v t 0 b δ α δ v t 0 from the triggering condition of eq 26 we know that v μ holds at triggering instants thus we can infer from eq 30 that the inter event time of the rudder satisfy 31 t δ 1 α δ v t 0 ln 1 a μ 1 σ 1 ζ α δ v t 0 β δ v t 0 b δ the right side of eq 31 is a positive the proof of the rudder is complete similarly if we differentiate w n along the flow time of the triggering instant t l n it yields 32 w n n c e n m u c u h n k n u e e n m u c u h n k n u e e n c u h n c u h n e n 2 k n m u c u h n c u 2 h n 2 k n 2 u e e n m u k n c u h n θ u φ u e n m u γ u 2 2 ε c u h n θ v φ v s v u e e n m u u e e n 2 ε c u h n k x x e 2 k y y e 2 u e x e cos ψ v e x e sin ψ u e y e sin ψ γ u 3 u e s v v e y e cos ψ γ u 2 k s v s v 2 γ u 2 γ r r e s v c u h n k n c u h n m u c u h n k n 2 2 c u 2 h n 2 m u k n k f u c u h n m u γ u 2 k f v s v 2 u e 2 2 ε c u h n e n 2 n m u u e 2 e n 2 4 ε c u h n k x 1 x e 2 k y 1 y e 2 γ u 3 2 1 u e 2 v e 2 γ u 3 2 γ u 2 γ r 2 γ u 2 k s v s v 2 γ u 2 γ r 2 r e 2 m u k n θ u 2 4 λ c u h n m u c u h n k n 2 u e 2 2 c u 2 h n 2 m u γ u 2 θ v 2 8 λ ε c u h n here we define two class k functions as α n v 2 c u h n k n c u h n m u c u h n k n 2 c u 2 h n 2 2 m u k n k f u c u h n m u γ u 2 k f v s v 2 u e 2 ε c u h n m u 2 ε c u h n k x 1 x e 2 k y 1 y e 2 γ u 3 2 1 u e 2 v e 2 γ u 3 2 γ u 2 γ r 2 γ u 2 k s v s v 2 γ u 2 γ r 2 r e 2 and β n v m u c u h n k n 2 u e 2 2 c u 2 h n 2 m u u e 2 4 ε c u h n k x 1 x e 2 k y 1 y e 2 γ u 3 2 1 u e 2 v e 2 γ u 3 2 γ u 2 γ r 2 γ u 2 k s v s v 2 γ u 2 γ r 2 r e 2 the constant as b n m u k n θ u 2 4 λ c u h n m u γ u 2 θ v 2 8 λ ε c u h n similar to eq 29 31 it can be inferred that the inter event time of the propeller satisfy 33 t n 1 α n v t 0 ln 1 a μ 1 σ ζ α n v t 0 β n v t 0 b n the right side of eq 33 is a positive constant the proof of the propeller is complete 5 simulation to verify the effectiveness of the proposed scheme and outstand the superiority of it with common methods three cases are compared in the simulation with identical sea states the training ship in dalian maritime university called yu peng is selected as the control objective seeing fig 2 here we assume the ballast draft of yu peng in the simulation the basic coefficients in this condition are presented in table 1 according to eq 2 the inertial parameters are calculated by empirical equations referring to fossen 2011 and the hydrodynamic parameters of yu peng are preliminarily identified by regressive least square method from the data of real sea trial seeing the eq 34 to comply with the practice we set the limits of the actuators as n 10000 rpm 2 n 22500 rpm 2 δ 1225 deg 2 and δ 1225 deg 2 respectively the bounds of uncertain gains of the actuators are set as c u 1000 c u 2000 c r 1 5 10 5 and c r 2 5 10 5 respectively the actual values of these gains are slowly changing within the bounds according to the mechanic characteristics of actuators fossen 2011 it should be noted that the bounds of actuators can be roughly estimated in reality as our scheme is robust 34 m u 2 33 10 7 m v 3 60 10 7 m r 5 04 10 10 y r 1 10 10 7 x u 4 06 10 6 x u u 9 25 10 4 y v 1 50 10 6 y v v 1 50 10 6 y r v 2 20 10 5 y r 3 26 10 7 y v r 2 20 10 5 y r r 4 52 10 8 n v 2 96 10 7 n v v 6 32 10 5 n r v 5 78 10 5 n r 8 90 10 9 n v r 5 63 10 7 n r r 2 50 10 11 to guarantee the high fidelity of simulation the experiment is conducted in the platform of simulated sea environment which was also adopted in our recent work deng et al 2019 it assumes a non fully developed sea state with the wave described by the jonswap spectrum and the wind by davenport spectrum via the mechanism model of wave and wind the environmental disturbances τ w u τ w v and τ w r can be further deduced the platform is representative to describe the wind generated waves with finite water depth as only limited information is needed here the formulaic discussion is omitted in the simulation an usual sea state is presumed with beaufort wind scale no 5 of the northwest wind the average speed of which is approximately 9 8 m s seeing fig 3 set six waypoints in the electronic chart with the coordinates as 0 m 0 m 0 m 2500 m 2500 m 3500 m 2500 m 6500 m 500 m 7500 m 500 m 10000 m considering the turning radius of yu peng we set the interpolated radiuses of the virtual ship guidance around these waypoints as 500 m the initial attitudes of yu peng are set as x y ψ 500 m 0 m 90 the initial kinestates and compensating variable ϑ v are all set to be zeros the surge speed u d of the virtual ship is set to be 15 knot the control parameters of the proposed scheme in the simulation are set as eq 35 35 γ 1 0 1 k x 2 k y 2 k ψ 0 1 k u 0 1 k r 0 1 β 1 k v 0 1 γ u 1 γ r 0 01 ε 2 k f u 10 k f r 15 σ 0 5 μ 0 1 for convenience yu peng with three cases are denoted as the no 1 the no 2 and the no 3 ships separately the no 1 ship is selected as the comparing example by adopting the ideology of discrete control katayama and aoki 2014 in that scheme the los guidance is employed with the constant reference surge speed of the ship also set as 15 knot in the simulation accordingly the model eq 1 and eq 2 is first transformed to the discrete form by euler s approximation and the discrete controller is ulteriorly derived with the sampling period t involved as a design factor as the larger t will degrade the control performance it is selected to be 0 1 s for the no 1 ship to keep uniformity in the control inputs the actuator gains are assumed to be known for that ship with no more tautology one can refer to katayama and aoki 2014 2011 for its formulaic details the no 2 and the no 3 ships are used to reveal the superiority of the developed scheme and illustrate the adjustment of the event triggered mechanism here they are both outfitted with the continuous control law of eq 22 but the no 2 ship is set with ζ 0 8 while the no 3 ship ζ 0 2 then we proceed the simulation and launch out all three ships simultaneously after all ships arrive the terminal waypoint the planar trajectories of them are observed in fig 4 it shows that all the ships could accomplish final convergence to the reference path whereas in the local enlarged region our scheme has higher precision than the los based approach as only the ζ is changed there is little difference in trajectories between the no 2 and the no 3 ships it can also be learnt from fig 5 and fig 6 that attitudes and kinestates of them are very similar the position errors of x e and y e in fig 5 are stabilized to the vicinity of zero after 400s due to the large inertia of yu peng overshoots of the heading angle error ψ e occur at every turning manoeuvring but the proposed scheme can ensure the reversion of overshoots soon afterwards it shows in fig 6 that u of the ship finally converges to u d of the virtual ship and v to the neighborhood of zero but overshoots of v still happen because of the environmental disturbances it is observed from fig 6 that small high frequency chattering accompanies the entire voyage especially in the yaw motion in fact by the merit of robust damping design the chattering phenomenon has already been largely mitigated here compared with the adaptive scheme in fig 7 the evolution of the adaptive compensating variable ϑ v of the no 2 ship is given we can observe that steps of ϑ v occur with large overshoots of v namely at the time of turning manoeuvering it tends to be moderate in the straight line of path following then we analyze control inputs of the three cases in fig 8 a the evolution of terminal control inputs of n a and δ a are exhibited from the 0s 1700s it can be observed that the input saturation happens in the initial stage and the turning manoeuvring due to the large attitude errors for the propeller the proposed scheme has larger overshoots than the comparison that is because the difference in guidance approaches in the los guidance the constant surge speed is tracked whereas in the virtual ship guidance the virtual control term α u is tracked which relies on the attitude errors for the rudder the three cases follow the same mainstream of evolution but the amplitude of the proposed scheme in straight line path following is greater than that of the comparison it is reasonable since the higher tracking precision of the proposed scheme is guaranteed in fig 4 which means more energy is costed to cancel out the adverse effects of disturbances in fig 8 b the local enlarged diagrams of control inputs around 358s for the propeller and 1067s for the rudder are shown because the running time for the entire voyage is very long only these two typical points are selected we can observe from fig 8 b that the inter event time of the no 2 ship is larger than that of the no 3 ship in the propeller and vice versa in the rudder it conforms to the analysis in the remark 1 that the inter event time of actuators can be tuned by ζ in a quantified way we denote the minimum the maximum and the average inter event time as t m i n t m a x and t m e a n respectively as calculated in the table 2 t m a x and t m e a n of the no 2 in the propeller are larger than that of the no 3 while the total triggered times of the entire voyage of the no 2 in the propeller are smaller and vice versa in the rudder it should be noted that in the first figure of fig 8 b both the inter event time of the no 2 and the no 3 ship are smaller than that of the no 1 ship namely 0 1s that doesn t mean the inferior performance of the event triggered scheme as the time around 358s accounts for the turning manoeuvring near the waypoint of 0 m 2500 m finer control process is preferred it can also be seen in table 2 that although all the t m i n s in actuators are smaller than 0 1s all the t m e a n s are larger as is observed the time triggered ideology of the no 1 ship acts every 0 1s even if the amplitude difference between two consecutive triggering instants is very small in contrary the event triggered ideology of the no 2 and the no 3 ship acts in a more intellective way namely fine controls in necessary manoeuvring and slack controls in straight line courses reflected on fig 9 the evolution of total triggering times of the proposed scheme increases slowly in straight line path following but rapidly in turning manoeuvring and is significantly lower than that of the time triggered scheme which is proportional to time 6 conclusion this paper developed a practical path following control scheme for the underactuated ship which took into account the existence of uncertainties the input saturation and the limited acting frequency of actuators the nonlinearities of input saturation were restructured as the gauss error functions the underactuated problem was solved by compensating the tracking error of the sway motion with an adaptive variable with the fls approximating the uncertainties the robust damping control design was conducted in the backstepping frame by following the etc in the channel of controller to actuator the control commands of actuators were finally rendered furthermore the triggering condition was designed separately comparing with the previous time triggered schemes for the ship the proposed one is more intellective and reduces the acting frequency in a general meaning comparing with the previous event triggered schemes the proposed one is able to tune the minimum inter event times of actuators manually according to practical requirements nevertheless the proposed scheme may suffer from the shortage of conservatism while possessing robustness to environmental disturbances and saturation constraints this issue will be addressed in the future acknowledgements this work is partially supported by the national science foundation of china no 51679024 and no 51779029 the fundamental research funds for the central university no 3132016315 the national high technology research and development program of china no 2015aa016404 the university 111 project of china no b08046 the key research and development plan of shandong province no 2018ggx105014 the project of shandong province higher educational science and technology no j18ka010 the project of shandong province transportation science and technology program no 2018b69 the project of development of shiphandling and passenger evacuation support system funded by the ministry of oceans and fisheries of korea the author would sincerely thank the anonymous reviewers for their pertinent and instructive suggestions to improve the quality of this paper 
22709,the contribution of this paper is to provide a method for optimizing installation capacity and operation strategy of a hybrid renewable energy system hres with offshore wind energy for container terminals a mixed integer optimization model of the hres is proposed in which maximum environmental and economic benefits are considered as two objectives and energy supply and demand balances energy storage balances technical constraints and quantity limitations are considered as constraints however container terminals typically execute many complicated and stochastic operation processes and thus represent highly dynamic energy demands therefore a simulation based optimization algorithm is developed to resolve the optimization model which consists of a simulation model and an optimization module the simulation model is constructed to overcome the stochastic characteristics and obtain the hourly energy demands in container terminals which are fed into the optimization module while the optimization module is used to search the solution space and provide the final decisions under three evaluation strategies cost saving low carbon and trade off strategy finally taking a container terminal in northeast china as an example optimal results are obtained by the proposed algorithm which can be used to provide references for power department policy making and green container terminal construction keywords green container terminals hybrid renewable energy system offshore wind energy simulation based optimization installation capacity operation strategy 1 introduction given the growing concerns on environmental challenges of traditional energy resources efforts aiming at energy related issues have been made from green container terminal perspective e g utilizing shore power and renewable energy for berthed ships kotrikla et al 2017 among them a promising avenue towards green container terminal construction lies in the transformation of energy supply structure that covers large shares or all of the energy demands in container terminals by means of renewable energy which have huge economic and environmental benefits melikoglu 2018 several port authorities worldwide have been developing initiatives in order to improve their energetic sustainability by fulfilling electric requirements in ports with renewable energy efiport 2008 heras saizarbitoria et al 2013 ramos et al 2014 hentschel et al 2018 however due to the intermittent and uncertain nature of renewable energy many problems are created when these resources are used to supply the local loads individually such as low security and reliability of supply bahramara et al 2016 to solve the problems stated above hybrid renewable energy systems hress which consist of renewable traditional energy resources and energy storages have emerged and are applied to provide required electricity for ships in ports tang et al 2018a within the wide variety of renewable energy sources adopted in hress offshore wind energy has gained growing interest and is arising as an alternative energy source with a record 18 814 mw of cumulative installed capacity at the end of 2017 global wind energy council 2018 the offshore wind energy has high capacity factors low negative impacts on human society such as visual and noise impacts kaldellis and apostolou 2017 and has been used to fulfill electric requirements in ports to reduce air pollution kotrikla et al 2017 however optimization management of such a hres comprising offshore wind energy for container terminals can be a challenging task given the need to simultaneously cover multiple technical methods e g installation capacity operation management etc and multiple conflicting objectives involved in hres design e g economic environmental etc furthermore the wind energy presents a high randomness and large variations vivas et al 2018 and energy demands in container terminals are characterized by high dynamics due to stochastic operation processes grundmeier et al 2014 which further causes challenges in operating the hress such as balancing energy supply and demand therefore to make full use of the clean and free wind energy this paper proposes a method for optimizing installation capacity and operation strategy of the hres with offshore wind energy for container terminals to realize the trade off between environmental benefits and economical profits many researchers have been devoted to identifying an optimal hres design and obtaining the rational installation capacity and optimal operation strategy of hress by different optimization techniques hutardo et al 2015 kaabeche et al 2011 song et al 2015 aiming at fully achieving objectives of being economic and environmentally friendly yang et al 2008 wang et al 2018 koutroulis et al 2006 applied the genetic algorithm to determine the optimum number and type of units of a hybrid photovoltaic wind system which minimized total system cost over a 20 year lifetime ekren and ekren 2010 optimized a hybrid photovoltaic wind battery storage system by stochastic gradient search method to minimize the total system cost bernal agustín and dufo lópez 2009 built a multi objective programming model for the optimal design of a photovoltaic wind diesel system which aimed at finding the best combinations of components for the hybrid energy system and the control strategy to minimize simultaneously both the total cost in the lifecycle and the unmet load gonzález et al 2015 studied optimal sizing of hybrid grid connected photovoltaic wind power systems based on real wind and solar irradiation data and electricity demand from a certain location aiming at reducing installation costs ghorbani et al 2018 developed a hybrid genetic algorithm with particle swarm optimization for the optimal sizing of an off grid house applied by a photovoltaic wind battery system for the purpose of reducing cost and increasing reliability dahmane et al 2013 proposed an intelligent algorithm for optimal power management of a hybrid renewable system containing a photovoltaic wind diesel generator and battery energy storage for the matching between electricity supply and load demand through analysis of the researches mentioned previously it can be observed that most of the optimization models proposed for optimizing capacity and operation of hress are mostly applied in remote residential buildings besides most attentions focus on the system cost and pollutants emission separately and few studies take environmental benefits and economical profits as objectives simultaneously for coordinated economic and environmental objectives ogunjuyigbe et al 2016 utilized a genetic algorithm to optimize photovoltaic wind diesel battery hybrid energy system which minimized life cycle cost carbon emission and dump energy of remote residential buildings however how to optimize the capacity and operation of hress for container terminals to realize the trade off between environmental and economic benefits is not resolved the hress applied in ports typically consisting of the photovoltaic arrays battery banks cold ironing and on board diesel generators are always used to feed the electric loads of ships while at berth tang et al 2018b the optimal operations of the hress adopted for ships have been regarded as a problem recently and corresponding research has been studied tang et al 2018a formulated the optimal operation problem of hress for a ship as an optimization model subject to a number of constraints including emission regulations of ports the results showed that the optimal operation of hress could bring promising electricity cost savings and robustness cannon et al 2015 presented the measures adopted by the port of los angeles and the shanghai municipal transportation commission for reducing the air emissions at both ports to institute and expand the use of cold ironing on ships while at berth lan et al 2015 proposed an optimal sizing method for a hybrid photovoltaic diesel storage ship power system which minimized the investment cost fuel cost and co2 emissions tang et al 2018b proposed an optimal energy management model and control methodology to obtain operational safety and efficiency of hress for large green ships while at berth which was solved by an adaptive multi context cooperatively coevolving particle swarm optimization algorithm through analysis of the aforementioned studies most of the works related to optimizing the capacity and operation of hress adopted in ports only concern the energy demands of ships without consideration of the energy demands of handling facilities during operation processes in ports besides the optimization models introduced only constrain the energy balance between supply and demand for a certain period e g the berthing period regardless of hourly fluctuations of highly dynamic energy demands in the long time the capacity and operation optimization of hress for container terminals considering the energy demands of ships and handling facilities to accurately satisfy the hourly balance between energy supply and demand is not resolved another challenge in influencing capacity and operation optimization of hress is the high randomness and large variations of energy demands in container terminals limited literature has studied the dynamic characteristics of energy demands in container terminals and most of related works mainly focus on minimizing energy consumption in container terminals by optimizing the allocation and scheduling of handling facilities golias et al 2010 proposed a berth scheduling policy to minimize the total emissions and fuel consumption for all ships while in idle mode and developed a genetic algorithm to solve the optimization model du et al 2011 formulated a berth allocation model considering fuel consumption and proposed a mixed integer second order cone programming model to offset the negative impact of the nonlinear complexity he et al 2015a proposed a yard crane scheduling model considering the trade off between efficiency and energy consumption and developed an integrated simulation optimization method for solving the problem chang et al 2010 developed a rolling horizon model based on objective programming for the integrated optimization of berth allocation and quay crane assignment with consideration of quay crane s energy consumption he et al 2015b formulated a mixed integer programming model for the problem of integrated quay crane scheduling internal truck scheduling and yard crane scheduling aiming at minimizing the total transportation energy consumption of all tasks the existing literature shows that energy consumption in container terminals always works as an objective function or constraint condition in an optimization model for allocation assignment and scheduling problem of handling facilities however how to obtain energy demands in container terminals in a certain period and represent the dynamic characteristics of energy demands is not resolved furthermore a container terminal operation system is very complicated and stochastic including many logistical processes such as berth allocation storage planning on container ships storage and stacking logistics and etc it is difficult or even impossible to formulate and evaluate such a complex system by analytical methods which can be resolved by discrete event simulation lee et al 2008 therefore in order to cope with the high uncertainties involved in a complex operation system it is imperative to provide a simulation based method to study the highly dynamic energy demands in container terminals the contribution of this paper is to provide a mixed integer optimization model for optimizing installation capacity and operation strategy of the hres with offshore wind energy for container terminals in which maximizing environmental benefits and minimizing economical costs are considered as two conflict objectives and accurately satisfying the hourly balance between energy supply and demand is taken as a constraint besides in order to overcome the complicated and stochastic operation processes a simulation based model is developed and thus used to obtain the hourly energy demands in container terminals in addition a simulation based optimization algorithm is proposed to resolve the optimization model the remainder of this paper is structured as follows section 2 focuses on problem description including analysis on energy demands in container terminals adopted patterns of the hres operation strategy of the adopted hres and evaluation strategy section 3 describes the proposed mixed integer optimization model and the simulation based optimization method to solve the model is presented in section 4 then section 5 carries out experiments to optimize installation capacity and operation strategy of the proposed hres followed by conclusions and future discussions in section 6 2 problem description there are many challenges in resolving the optimization model of the hres such as analyzing the dynamic energy demands in container terminals offsetting negative impacts of intermittent and variability of wind energy accurately satisfying the hourly balance between energy supply and demand and evaluation strategy for the optimal results in order to address the challenges above there are four problems that should be discussed more in detail including analysis on energy demands in container terminals adopted patterns of the hres operation strategy of the adopted hres and evaluation strategy 2 1 analysis on energy demands in container terminals a container terminal generally contains three components berth yard and gate where ships and handling facilities i e quay cranes trucks and yard cranes are taken as the main energy consumers during operation processes as shown in fig 1 generally trucks are driven by fuel consumption while ships quay cranes and yard cranes consume electricity which is taken as the energy demands in container terminals in this paper due to many complicated and stochastic operation processes energy demands in container terminals are characterized by highly complex dynamics the following aims at representing operation processes and energy demands in container terminals 2 1 1 operation processes in container terminals operation processes in container terminals at least consist of three sub processes that are interconnected ships arriving and berthing sub process handling operation sub process and ships departing sub process all these processes require available and shared resources and equipment to fulfill the tasks involved in handling and transporting containers quay cranes yard cranes and trucks gudelj et al 2010 the operation processes comprise two dynamic processes opposed to each other loading and unloading the following is introduced more in detail only focusing on the unloading process 2 1 1 1 ships arriving and berthing sub process ships arriving and berthing sub process consists of ships waiting at anchorage and ships going through waterway firstly arriving ships with various tonnages containers to be handled and powers of auxiliary engines enter the container terminal and have to wait at anchorage when the waterway and berth are occupied then a berth is allocated to a ship according to previously user defined assignment rules which take the required berthing space and expected spending time at berth into account finally once the waterway and berth are idle in addition natural conditions e g wind fog and waves and traffic status e g safety distance and sailing direction in waterway are satisfied the ship will go through waterway and berth at an allocated berth in ships arriving and berthing sub process the berthing time of each ship and types numbers of ships while at berth simultaneously are influenced by many stochastic environments such as natural conditions and traffic status which can bring highly complex dynamics of energy demands of ships in a certain period 2 1 1 2 handling operation sub process handling operation sub process comprises assigning quay cranes scheduling trucks dispatching yard cranes and handling transporting and stacking containers once the ship arrives at berth after mooring operation the procedure of handling operation begins firstly the assigned quay cranes discharge containers from ships to scheduled trucks then the trucks pick up containers unloaded from ships and transport the containers to the deployed yard block to wait for dispatched yard cranes to stack the containers finally once the yard crane is idle containers will be shuffled and stacked in handling operation sub process the quantity of handled containers in a certain time is influenced by many uncertain factors e g working efficiency congestion at road queue to wait for idle facilities which can result in unpredictable fluctuations of expected spending time at berth for ships and energy demands of handling facilities at each time step 2 1 1 3 ships departing sub process once handling operation is finished the ship prepares to leave the berth before leaving the natural conditions and traffic status are still judged if all the conditions are satisfied the ship will go through waterway and depart the queue to wait for stochastic conditions can result in additional spending time at berth for ships furthermore increase energy demands of ships while at berth based on the analysis of the operation processes above container terminals consist of highly uncertain and dynamic operation processes which cannot be resolved by theoretical and analytical methods not to speak of obtaining energy demands in container terminals at each time step as a useful tool lee et al 2008 a simulation model is needed to represent the complete and dynamic system environment in container terminals 2 1 2 energy demands in container terminals during operation processes in container terminals ships quay cranes and yard cranes require energy demands for electricity electricity replacing auxiliary diesels for ships mainly satisfies the hoteling load demand of ships while at berth such as lighting heating ventilation air conditioning cold storage and cooking electricity consumed by quay cranes mainly meets the load demand of picking containers up from ships moving containers horizontally and dropping containers on trucks electricity utilized by yard cranes mainly fulfills the load demand of picking containers off trucks moving containers to assigned storage locations and travelling to the location of the next truck energy demands of ships can be obtained by powers of auxiliary engines and expected spending time at berth for ships peng et al 2019 while energy demands of quay cranes and yard cranes can be calculated by the quantity of handled containers and electricity consumed for handling one container peng et al 2014 however due to the high complexity of operation processes as shown previously energy demands in container terminals are influenced by many stochastic factors therefore a simulation based method is developed to obtain and analyze the energy demands in container terminals and the detailed simulation model for a container terminal is organized in section 4 3 2 2 adopted patterns of the hres when renewable resources generate the electricity to meet energy demands of terminal users individually many difficulties are emerged such as low reliability and security of supply due to intermittent and variability which can be solved effectively with hress erdinc and uzunoglu 2012 bahramara et al 2016 the hres adopted in this paper comprises offshore wind energy energy storage systems and conventional energy generation which fulfills the energy demands of ships quay cranes and yard cranes as represented in fig 2 in the adopted hres offshore wind energy is considered as the priority energy source conventional energy generation as a backup source to ensure uninterrupted electricity supply energy storage systems are needed to store excess electricity from wind energy generation and provide electricity when the production is deficit conventional energy generation is taken as constant electricity supply at each time step and can be varying correspondingly at different time steps according to the relationships between energy supply and demand the following mainly focuses on the wind generation modeling and energy storage modeling 2 2 1 wind generation modeling there are two common analyzing approaches to model the wind power generation i e theoretical analysis of power speed relationships and measuring power curves of wind turbines respectively for the first approach the models appeared in the literature are usually parametric and non parametric ouyang et al 2017 taking the piecewise linear model included in parametric models as an example a number of different distribution models have been proposed to describe the probability distribution of wind speed shu et al 2015 in particular the weibull and rayleigh probability distribution models are regularly used as proper representation models of wind speed variation burton et al 2001 zakariazadeh et al 2014 once hourly mean wind speeds over a year are obtained mathematical model for power outputs of wind energy generation has been calculated shin et al 2017 and is given as follows 1 p w v 0 0 v v c i p r v v c i v r v c i v c i v v r p r v r v v c o 0 v v c o where p w v is the power outputs of wind energy generation at wind speed v and p r is the rated power besides v c i v r and v c o are the cut in wind speed rated speed and cut out wind speed respectively however due to the difference of the main characteristics of wind turbines and weather conditions such as temperature density and wind directions the power outputs obtained by theoretical analysis always represent significant deviations from the measured power curve of wind turbines ciulla et al 2019 sohoni et al 2016 for example the mismatch among theoretical power curve by using the piecewise linear model and the measured power curve of a real life wind turbine heag hw1 780 2016 is shown in fig 3 thereby for a real wind energy project the measured power curve shows a higher reliability compared to theoretical analysis for the promoters to analyze economic benefits of the investment which is the reason for adopting measured power curves of available commercial wind turbines in this paper 2 2 2 energy storage modeling in most previous studies charging and discharging of energy storage systems are automatically calculated by the difference between the energy production and energy demand shin et al 2017 however charging and discharging of the storages along with scheduled energy from conventional energy generation are considered as decision variables in this paper therefore decided by charging and discharging variables the state of energy storage systems is described below 2 e t e t 1 1 σ b η c h q t c h 1 η d i s c q t d i s c where e t is the stored electricity of energy storage systems at time step t kwh σ b is the self discharge rate η c h is the charging efficiency η d i s c is the discharging efficiency q t c h is the charging electricity at time step t kwh q t d i s c is the discharging electricity at time step t kwh the stored electricity at time step t of energy storage systems has several technical constraints such as the minimum and maximum allowable capacity the minimum bound of allowable capacity can be expressed by the maximum depth of discharge dod as in eq 3 3 e min 1 dod e max where e min is the minimum allowable capacity of energy storage systems kwh dod is the maximum depth of discharge e max is the maximum allowable capacity of energy storage systems kwh the e t must be bounded within the scale e min e max shown as follows 4 e min e t e max besides essential technical constraints of charging and discharging power should be satisfied during the operation process of energy storage systems zhang et al 2018 tan 2016 formulized as follows 5 0 p t c h p c h max 6 0 p t d i s c p d i s c max where p t c h and p t d i s c are the charging and discharging power of energy storage systems at time step t kw respectively p c h max and p d i s c max are the maximum allowable charging and discharging power of energy storage systems kw respectively 2 3 operation strategy of the adopted hres the main purpose of this paper is to optimize installation capacity and operation strategy of hress to realize the trade off between environmental benefits and economical profits the installation capacity optimization is to determine the optimal installed capacity of offshore wind power systems and energy storage systems while operation strategy optimization is to determine charging discharging energy to from energy storage systems and scheduled energy from conventional power generation at each time step as shown in fig 4 during the time interval t 1 t in fig 4 the electricity produced is not enough to meet energy demand and thus the shortage of energy demand is supplemented firstly by discharging energy from energy storage systems and then by scheduled energy from conventional power generation conversely during the time interval t t 1 the energy produced by wind generations is greater than the energy demand therefore the excess energy will be charged to energy storage systems based on the operation strategy of the adopted hres the hourly energy balance is satisfied in addition charging energy discharging energy and scheduled energy are optimized at each time step to minimize annual total cost and carbon emissions 2 4 evaluation strategy the environmental benefits and economical profits are always in negative correlations and cannot reach the optimal simultaneously therefore the trade off strategy is introduced to evaluate the feasible solutions in the pareto optimal set the trade off strategy concerning the trade off between environmental and economic benefits is based on membership theory and the weights for evaluating objective functions is determined by variance in addition the detailed evaluation process can be obtained according to the study by peng et al 2019 and is shown as follows the membership degree of objective function j of the feasible solution i is calculated as follows 7 σ i j p j max p i j p j max p j min i θ j ξ where σ i j is the membership degree θ is the set of all the feasible solutions indexed by i ξ is the set of all objective functions indexed by j p i j is the objective function j of the feasible solution i p j max and p j min are the maximum and minimum values of objective function j in the pareto optimal set the weight for evaluating function j by variance can be calculated as follows 8 η j i θ k θ σ i j σ k j 2 j ξ i θ k θ σ i j σ k j 2 where η j is the weight for evaluating function j which is subject to j ξ η j 1 the comprehensive evaluation index for the feasible solution i can be calculated as follows 9 f i j ξ σ i j η j i θ according to the maximum comprehensive evaluation index the optimal solution under trade off strategy can be selected besides this paper considers additional evaluation strategies i e cost saving strategy and low carbon strategy to analyze the sensitivity of evaluation strategies on the final decisions cost saving strategy selects the solution with minimum cost from the pareto optimal set while low carbon strategy considers the solution with minimum carbon emissions therefore according to the proposed evaluation strategies final decisions for the problem of optimizing the hres under cost saving low carbon and trade off strategy can be obtained 3 model formulation in this section a bi objective mixed integer programming optimization model for the problem of how to determine the optimal installed capacity and operation strategy of the hres considering a trade off between environmental benefits and economical profits is developed in the proposed model maximizing environmental benefits and minimizing annual total costs of the system are represented as the two objectives and energy supply and demand balances energy storage balances technical constraints and quantity limitations are considered as constraints 3 1 model assumptions 1 during handling operation processes the electricity requirements of berthed ships quay cranes and yard cranes are provided by the adopted hres 2 it is assumed that conventional energy power plants are invested by the government sector and therefore the investment cost operation and management cost of conventional energy generation are not taken into account 3 the handling facilities in container terminals are taken full use of in addition no accidents and interference happen 3 2 mixed integer optimization model 3 2 1 nomenclature to describe the sets parameters and variables in the bi objective mixed integer programming model the following nomenclature is used as shown in table 1 3 2 2 objective functions and constraints the bi objective mixed integer programming model for the problem can be formulated as follows 10 objective 1 min c c i w c o m w c i s c o m s c g 11 objective 2 min w t 1 t c e g q g t i 1 i t 1 t c e w x i q i t w subjected to 12 q g t i 1 i x i q i t w j 1 j y j q j t c h j 1 j y j q j t d i s c q r t 13 e j t e j t 1 1 σ b j η c h j q j t c h 1 η d i s c j q j t d i s c 14 q i t w p w i δ t 15 e min j e j t e max j 16 e max j q s j 17 e min j 1 dod j e max j 18 0 q j t c h p max j c h δ t 19 0 q j t d i s c p max j d i s c δ t 20 i 1 i x i x 21 j 1 j y j y where c i w c o m w c i s c o m s and c g represent respectively the annual investment cost of offshore wind power systems the annual operation and maintenance cost of offshore wind power systems the annual investment cost of energy storage systems the annual operation and maintenance cost of energy storage systems and the annual cost of scheduled energy from conventional energy generation which are defined as eq 22 eq 26 22 c i w i 1 i c f w i p w i c l w i x i c r f i 23 c o m w i 1 i x i p w i μ w c r f i 24 c i s j 1 j c f s j q s j c l s j y j c r f j 25 c o m s j 1 j y j q s j μ s c r f j 26 c g t 1 t c g q g t the capital recovery factor of offshore wind power system i c r f i is defined in eq 27 used to annualize the total investment operation and management costs of an installed system i the capital recovery factor for the energy storage system j c r f j is defined in a similar manner as in eq 28 27 c r f i r r 1 m w i r 1 m w i 1 28 c r f j r r 1 m s j r 1 m s j 1 besides the installation capacity of offshore wind power systems and energy storage systems is defined as follows 29 i c w i 1 t p w i x i 30 i c s j 1 j q s j y j eq 10 aims at minimizing the annual total cost of the adopted hres comprising the annual total investment operation and management cost of offshore wind power systems and energy storage systems and the annual cost of scheduled energy from conventional energy generation eq 11 is to minimize the carbon emissions due to the energy consumption in container terminals constraint 12 represents the constraint of energy supply and demand balance guaranteeing that energy demand in a container terminal must be met at each time step constraint 13 represents the constraint of energy storage balance required to describe the operation process of energy storage systems at time steps t and t 1 with respect to the state of charge charging and discharging efficiencies as well as self discharge losses constraint 14 constraint 15 represent technical constraints consisting of the capacity limitations during the operation process of wind power systems and energy storage systems constraint 16 constraint 17 define the maximum and minimum allowable capacity of energy storage systems respectively which are used to restrict the stored electricity in energy storage systems at each time step constraint 18 constraint 19 represent the constraints of charging and discharging power of energy storage systems at time step t constraint 20 constraint 21 represent quantity limitations of installed wind power systems and energy storage systems due to the site selection and land restriction the above optimization model formulates the problem for optimizing the capacity and operation of the adopted hres given the operation processes in container terminals are very complicated and uncertain it is almost impossible to obtain energy demands just by mathematical or analytical methods therefore a simulation based method is developed to obtain energy demands in the container terminal at each time step and a simulation based optimization algorithm which embeds the simulation model into the optimization module is introduced to solve the optimization model the detailed description of the algorithm is presented in section 4 4 simulation based optimization algorithm most problems associated with optimization of actual system such as transportation systems financial management systems and manufacturing systems are too complex to be modeled analytically due to many difficult and inherent features lee et al 2008 furthermore simulation method can only estimate the performance of given systems usually insufficient from the perspective of optimization he et al 2013 therefore considering the dynamic and stochastic nature in container terminals the simulation based optimization algorithm for the problem of optimizing the adopted hres is proposed 4 1 framework of the simulation based optimization algorithm as illustrated in fig 5 the simulation based optimization algorithm for the problem comprises two modules respectively optimization module and simulation model in particular the optimization module is applied to search the solution space firstly whereas the simulation model is used to obtain the energy demands in container terminals which are fed into optimization module to optimize the operation strategy at each time step then the objective function values can be calculated after the optimization of the operation strategy until all the feasible settings for decision variables are enumerated the pareto optimal set can be obtained and the results can be evaluated by evaluation strategy finally the optimal installation capacity and operation strategy of the adopted hres can be output according to the evaluation results 4 2 optimization module of the simulation based optimization algorithm in the optimization module nine main phases are proposed to present details of the optimization algorithm for the problem of optimizing the adopted hres the overall optimization procedures are shown in table 2 as described in table 2 phase 1 aims at generating initial feasible settings of the hres for the proposed algorithm initialization of decision variables x i and y j is the beginning of the introduced procedure and other parameters can be fed into the algorithm according to real operation data phase 2 focuses on running the simulation model to deal with the complicated and stochastic nature and obtain energy demands in the container terminal at each time step the simulation models take parameters of ships berths handling facilities and etc as inputs and output the energy demands phase 3 of the procedure aims at calculating the power outputs of wind power systems by wind generation modeling at each time step which in conjunction with energy demands obtained in phase 2 can be applied to optimize operation strategy in phase 4 after the optimization of the operating values for decision variables q j t c h q j t d i s c and q g t objective function values can be calculated in phase 5 phase 6 checks the stopping rule of the proposed procedure if all the feasible settings are enumerated the procedure will be terminated otherwise the procedure will continue and return to the next feasible setting after all the feasible settings are enumerated the pareto optimal set for the problem can be obtained in phase 7 phase 8 focuses on the evaluation of the optimal solutions for the problem by evaluation strategy finally according to the evaluation results the optimal installation capacity and operation strategy of the adopted hres can be output in phase 9 4 3 simulation model of the simulation based optimization algorithm based on the analysis of operation processes in section 2 1 1 a logic model is firstly developed before building simulation models as shown in fig 6 based on the logic model the detailed simulation model for a container terminal is developed in this subsection which represents the complete and dynamic system environment in container terminals and is therefore used to obtain energy demands at each time step the simulation model includes three sub models ships arriving and berthing sub model handling operation sub model and ships departing sub model 4 3 1 ships arriving and berthing sub model in the ships arriving and berthing sub model ships are firstly created by the create module with arrival interval obeying a certain distribution then the attributes such as tonnage of ships powers of auxiliary engines average handled quantity of containers and etc are assigned to ships in the assign module next the allocated berths are assigned to ships in the assign berths to ships module in this module ships will seize the berth resources if the berth is idle otherwise ships have to wait for idle berths finally when natural conditions and traffic status in waterway are satisfied the ships will go through the waterway and berth at the allocated berths meanwhile the berthing time of ships will be recorded in the assign berthing time module as shown in fig 7 4 3 2 handling operation sub model once mooring at berth and completing the auxiliary operation the procedure of handling operation begins as shown in fig 8 firstly containers to be handled are separated from ships in the separate module and sent to quay cranes handling module for handling operation then containers are handled by quay cranes transported by trucks and stacked by yard cranes and the energy demands for handling these containers by quay and yard cranes are recorded in the assign module finally the decide module is used to judge whether handling operation for ships is finished if finished the time for handling operation will be recorded in assign module 4 3 3 ships departing sub model once handling operation is finished ships prepare to leave the berth as shown in fig 9 when the natural conditions and traffic status are satisfied ships release berth resources by the release module meanwhile the releasing time and expected spending time at berth for ships are recorded in assign module which in conjunction with powers of auxiliary engines can be used to obtain the energy demands of ships then ships go through the waterway to leave the port via out waterway module finally the energy demands of ships quay cranes and yard cranes at each time step can be written to the external excel spreadsheet with the vba module 5 case study 5 1 parameter settings the experiments consider a container terminal in northeast china with five container berths as the simulation case in the planning phase of energy supply systems for the container terminal the hres consisting of offshore wind energy is considered to meet the goal of green ports and it is required to allocate the rational capacity and determine the optimal operation strategy of the hres the terminal is 1847m long and the tonnage of berths and the number of quay cranes assigned to each berth are presented in table 3 besides the working efficiency of each quay crane for handling operation is 30 teu h the dimension of waterway covers the length of 20 nm along with one way traffic lane and the navigation speed of ships through the waterway is 18 52 km per hour default parameters as inputs in the simulation model such as tidal conditions are provided by the port company this paper takes a full calendar year as an example study and all the time steps are set as 8760 the following is focusing on the parameters of ships handling facilities wind wind power systems energy storage systems carbon emission factors and energy prices 5 1 1 parameters of ships according to the frequency curve fitting and hypothesis testing of the real operation data in 2016 ships arrive at the container terminal with inter arrival time obeying negative exponential distribution and the average value of ship s inter arrival is 7 0 h the type combinations of ships such as tonnage proportion average handled quantity and berth number for ship mooring are listed in table 4 and the auxiliary working time for ships is set as 4 0h 5 1 2 parameters of handling facilities in order to obtain energy demands of handling facilities electricity consumed for handling one container is necessary according to the study by peng et al 2014 electricity consumed for handling one container by quay cranes and yard cranes is set as 5 23 kwh teu and 3 03 kwh teu respectively 5 1 3 parameters of wind a collection of hourly mean wind speeds in one year around the container terminal has been carried out based on the fitting curve and data histogram of wind data collected it can be observed that the hourly mean wind speed obeys weibull distribution as shown in fig 10 and the average wind speed of the whole year is 3 9 m s 5 1 4 parameters of wind power systems in order to analyze environmental and economic benefits of the adopted hres the cost and technical parameters of offshore wind power systems are needed to select an optimal design scheme for the hres in the container terminal this paper considers two types of wind power systems produced by a manufacturer and b manufacturer respectively considering the trade secrets the name of the two manufacturers is given by a and b and the model number of wind turbines is given by a 1 a 2 a 3 b 1 b 2 and b 3 besides the installed capacity the cost parameters and technical parameters of the wind power systems are illustrated in table 5 and table 6 in addition the power curves of the wind turbines are shown in fig 11 and fig 12 due to site selection and land restriction the installed quantity of all the wind turbines is set as 5 5 1 5 parameters of energy storage systems in this paper a type of mature energy storage technologies battery bank is introduced the battery bank is comprised of 210 batteries according to the parameters provided by the producer the energy capacity of one battery is equal to 12 v 200 ah 2 4 kwh therefore the capacity of the battery bank is equal to 210 2 4 kwh 504 kwh in addition the maximum depth of discharge is 50 and the charging efficiency is 85 and the discharging efficiency is 100 with consideration of the security of the battery bank the peak charging and discharging ratios are set as 0 3 c and 1 0 c therefore the maximum charging power of the battery bank is equal to 210 0 3 12 v 200 a 151 2 kw and the maximum discharging power of the battery bank is equal to 210 1 0 12 v 200 a 504 kw besides the investment costs operation and maintenance costs and lifetimes of the battery bank along with the technical parameters are shown in table 7 considering the site selection and land restriction the installed quantity of all the battery banks is set as 3 5 1 6 parameters of carbon emission factors and energy prices for the calculation of carbon emissions in the container terminal carbon emission factors of offshore wind power systems and conventional power generation are considered and set as 0 0165 kg kw h and 1 0416 kg kw h wang et al 2017 besides in order to analyze the economic benefits the price of scheduled electricity from conventional energy generation is set as 0 1455 kwh according to the industrial electricity price in china 5 2 results in this section the energy demands in the container terminal at each time step are obtained after carrying out the simulation model by using arena software besides the power outputs of wind power systems are calculated by the measured power curves of the wind turbines with real wind data after enumerating all the feasible settings the optimal installed capacity and operation strategy of the hres are output under different evaluation strategies by the simulation based optimization algorithm 5 2 1 energy demands in the container terminal based on the expected spending time at berth for ships and the quantity of handled containers recorded by vba model along with other parameters of ships berths and handling facilities the energy demands in the container terminal are output by running the simulation model taking a typical week as an example energy demands at each time step are as shown in fig 13 as illustrated in fig 13 ships gives a significant contribution to the total energy demands in the container terminal followed by quay cranes and yard cranes besides the energy demands represent highly dynamic nature ranging from 1 6 mwh to 9 5 mwh within a week which will create great difficulties in energy demand and supply balances 5 2 2 analysis on optimal installation capacity and operation strategy of the hres once the energy demands power outputs of wind power systems and other parameters related to the hres are fed into the mixed integer optimization model the optimal installation capacity and operation strategy for the adopted hres are obtained by means of the proposed algorithm 1 optimal results of the hres adopting the wind turbines produced by a manufacturer by resolving the optimization models the solution space and pareto frontier of the optimization model can be obtained the bi objective optimal solutions can be determined for each pareto frontier with consideration of the trade off between the objectives which relies on the evaluation strategies in this paper three types of evaluation strategies are considered i e low carbon strategy trade off strategy and cost saving strategy respectively the optimal point under low carbon strategy can be selected which achieves the lowest carbon emissions among all the solutions besides the optimal point evaluated by the cost saving strategy can be determined which gains the minimum annual total cost among all the solutions the trade off optimal point can be obtained by carrying out the proposed evaluation strategy in section 2 4 used for realizing the trade off between economic and environmental benefits according to the evaluation results the optimal installation capacity of the hres under different evaluation strategies are shown in table 8 in addition the optimal operation strategy in a selected representative day under trade off evaluation strategy is shown in fig 14 as illustrated in table 8 under low carbon strategy the optimal installation capacity of wind power systems is 3 0 mw with the lowest carbon emissions but the highest annual total cost compared to the optimal results under other two strategies under cost saving strategy the optimal installation capacity of wind power systems is 0 75 mw with the lowest annual total cost but the highest carbon emissions under trade off strategy the optimal installed capacity of wind power systems is 2 25 mw which can realize the trade off between the carbon emissions and annual total cost as depicted in fig 14 due to the small installed capacity low wind speed and inadequate installed quantity the electricity outputs of wind power systems at each time step are relatively insufficient compared to the energy demands in the container terminal therefore there is a need to schedule a large amount of electricity from conventional energy generation to meet the energy demands in the container terminal 2 optimal results of the hres adopting the wind turbines produced by b manufacturer in order to analyze the influence of the installed capacity of wind turbines on the optimal results this paper considers the wind turbines with large installed capacity and produced by b manufacturer in the hres by resolving the optimization model the optimal installation capacity of wind power systems under different evaluation strategies and the optimal operation strategy in a typical day under trade off evaluation strategy are shown in table 9 and fig 15 respectively it can be seen from table 9 that the optimal results under trade off strategy are the same as the optimal results under cost saving strategy besides the optimal solution under low carbon strategy gains the lowest carbon emissions and the highest annual total cost besides the carbon emissions under different evaluation strategies are lower than that shown in table 8 while the annual total cost is larger than that shown in table 8 it means that under the same condition of wind speed increasing the installed capacity of wind turbines inevitably raises the system cost yet improves the environmental benefits in container terminals compared to fig 14 electricity output of wind power systems in fig 15 is relatively larger on average and the scheduled electricity correspondingly reduces the hres consisting of the wind power systems produced by b manufacturer are more likely to achieve environmental benefits in the container terminal and reduce the yearly purchase cost of the scheduled electricity compared to a manufacturer as analyzed above the low wind speed and inadequate installed quantity can lead to low electricity output of wind power systems and cause that the energy demands in the container terminal are fulfilled by the scheduled electricity to a great extent from conventional energy generation this result can create hardness to realize the economic and environmental benefits of the hres including wind energy resources and result in unwillingness of port operators to implement the hres for container terminals thereby this paper considers another three alternative locations provided by port operators for establishing the wind power systems with the average wind speed being 5 9 m s 9 7 m s and 11 7 m s and performs a sensitivity analysis of wind speed on the optimal results the optimal results of each location are shown in section 5 2 3 besides this paper performs a sensitivity analysis of installed quantity of wind turbines on the economic and environmental benefits of the hres in section 5 2 4 it is noted that the following analysis is based on the hres adopting the wind turbines produced by b manufacturer due to the larger environmental benefits compared to the wind turbines produced by a manufacturer 5 2 3 the sensitivity of wind speeds at different locations on the optimal results due to the various natural conditions at different locations for building the wind power systems this paper considers the original proposed location and another three alternative locations to study the sensitivity analysis of wind speed on the optimal results with average wind speed being 3 9 m s 5 9 m s 9 7 m s and 11 7 m s respectively as shown in table 10 the optimal installation capacity optimal annual total cost and optimal carbon emissions under different wind speeds are illustrated in fig 16 fig 18 correspondingly it can be seen from fig 16 that the optimal installed capacity of wind power systems is unalter under low carbon strategy and cost saving strategy when wind speed increases maintaining at 12 5 mw and 7 5 mw correspondingly while the optimal installed capacity of wind power systems under trade off strategy raises with the increase of wind speed from 7 5 mw to 9 5 mw besides it can be drawn from fig 17 and fig 18 that the optimal annual total cost and optimal carbon emissions under three evaluation strategies reduce a lot with the increase of wind speed for example under low carbon strategy trade off strategy and cost saving strategy the optimal annual total cost reduces by 34 2 33 7 and 37 7 and the optimal carbon emissions reduce by 76 5 74 4 and 77 9 correspondingly it shows that building wind power systems in the locations with high wind speed can significantly improve the economic and environmental benefits of the hres for the container terminal 5 2 4 the sensitivity of installed quantity of wind turbines and battery banks on the optimal results considering the site selection and land restriction for real life ports the installed quantity of wind turbines and battery banks can be limited in addition the economic and environmental benefits under different installed quantity of wind turbines and battery banks is essential for port operators which can provide references to the scheme selection of designing the hres for container terminals therefore the sensitivity analysis of the installed quantity on the optimal results under different strategies is conducted in this section 1 the sensitivity of the installed quantity of wind turbines on the optimal results in order to study the influence of the installed quantity of wind turbines on the optimal results this paper considers five scenarios with the installed quantity increasing from 1 to 9 stepped by 2 and the installed quantity of each scenario is 1 3 5 7 and 9 respectively besides the installed quantity of battery banks is set as 3 and the average wind speed is 3 9 m s by resolving the optimization models under different installed quantity of wind turbines the optimal installation capacity optimal annual total cost and optimal carbon emissions are illustrated in fig 19 fig 21 correspondingly as depicted in fig 19 the optimal installation capacity of wind power systems under low carbon strategy trade off strategy and cost saving strategy is positively correlated with the installed quantity of wind turbines raising by 20 mw 11 mw and 12 mw with the increase of installed quantity from 1 to 9 correspondingly besides the detailed optimal allocation on the installed capacity of wind turbines for each scenario is shown in table 11 it can be seen from table 11 that only the wind turbine b 2 is needed for constructing the hres under low carbon strategy and only the wind turbine b 1 is needed under cost saving strategy while the optimal allocation on the installed capacity of wind turbines under trade off strategy can be determined only by performing the proposed solution algorithm as shown in fig 20 the optimal annual total cost under low carbon strategy trade off strategy and cost saving strategy raises by 97 9 83 7 and 85 0 with the increase of installed quantity of wind turbines from 1 to 9 respectively while the optimal carbon emissions under three evaluation strategies reduce by 39 1 28 5 and 31 9 with the increase of the installed quantity respectively as shown in fig 21 the results indicate a negative correlation between optimal annual total cost and optimal carbon emissions in this condition port operators can allocate the installed capacity and determine the installed quantity of wind turbines with consideration of emission regulations and financial conditions in container terminals 2 the sensitivity of the installed quantity of battery banks on the optimal results this paper considers five scenarios with the installed quantity of battery banks increasing from 1 to 5 stepped by 1 to study the influence of the installed quantity on the optimal results the installed quantity of battery banks for each scenario is set as 1 2 3 4 and 5 respectively besides the installed quantity of wind turbines is set as 5 and the average wind speed is 3 9 m s by means of resolving the optimization models and implementing the evaluation strategies for all the solutions the optimal installation capacity of wind power systems is demonstrated in fig 22 and the detailed allocation for each type of wind turbines is represented in table 12 besides optimal annual total cost and optimal carbon emissions under different installed quantity of battery banks are illustrated in fig 23 and fig 24 correspondingly it can be drawn from fig 22 that the optimal installed capacity of wind power systems under low carbon strategy and cost saving strategy keeps constant at 12 5 mw and 7 5 mw respectively when the installed quantity of battery banks increases besides the optimal allocation for each type of wind turbines remains unaltered under these two evaluation strategies as shown in table 12 while the installed capacity of wind turbines under the trade off strategy changes within the range of the installed capacity under other two evaluation strategies when the installed quantity of battery banks raises as shown in fig 23 the optimal annual total cost under low carbon strategy trade off strategy and cost saving strategy increases by 4 2 6 9 and 15 1 with the installed quantity of battery banks increasing from 1 to 5 respectively whereas the optimal carbon emissions under three evaluation strategies decrease slightly by 1 6 8 8 and 0 9 correspondingly as shown in fig 24 the results show the installed quantity of battery banks has little impact on the environmental and economic benefits of the hres 5 2 5 the sensitivity of the price of the scheduled energy on the optimal results the purchase price of the scheduled energy presents fluctuating characteristics in different regions according to the peak load price and flat load price for large scale industry in electricity price tables of beijing beijing municipal commission of development and reform 2019 tianjin tianjin development and reform commission 2019 and dalian dalian development and reform commission 2018 the purchase price mainly changes from 0 10 kwh to 0 16 kwh thus this paper considers seven scenarios with the purchase price increasing from 0 1 kwh to 0 16 kwh stepped by 0 01 kwh to perform the sensitivity analysis of the price of the scheduled energy on the optimal results the price of the scheduled energy for each scenario is set as 0 10 kwh 0 11 kwh 0 12 kwh 0 13 kwh 0 14 kwh 0 15 kwh and 0 16 kwh respectively by resolving the optimization models the optimal installation capacity of wind power systems optimal annual total cost and optimal carbon emissions under different prices of the scheduled energy are shown in fig 25 fig 27 as shown in fig 25 the optimal installation capacity of wind power systems under low carbon strategy and cost saving strategy remains unaltered at 12 5 mw and 7 5 mw respectively similarly the optimal carbon emissions under these two evaluation strategies still keep constant at 20 3 thousand tons and 23 2 thousand tons with the price increasing as shown in fig 27 besides the optimal installed capacity under trade off strategy changes between 7 5 mw and 12 5 mw shown in fig 25 and the optimal carbon emissions under trade off strategy change between 20 3 thousand tons and 23 2 thousand tons as shown in fig 27 while the optimal annual total cost under low carbon strategy trade off strategy and cost saving strategy increases by 15 0 8 1 and 19 5 with the price increasing from 0 10 kwh to 0 16 kwh respectively as shown in fig 26 the results demonstrate that the price of scheduled energy has almost no impact on the optimal installation capacity of wind power systems and the optimal carbon emissions under the low carbon strategy and the cost saving strategy yet has little influence on the economic benefits of the hres from the above analysis it is can be drawn that the optimal selection of installation capacity and installed quantity of wind turbines and battery banks in the hres is influenced by many factors which should be determined by comprehensively considering natural conditions technical performance of wind turbines and battery banks annual total costs carbon emissions and evaluation strategies 6 conclusions the contribution of this paper is to optimize installation capacity and operation strategy of the hres with offshore wind energy for container terminals a mixed integer optimization model is proposed for the hres in which maximizing environmental benefits and minimizing annual total costs are considered as two conflict objectives and accurately satisfying the hourly balance between energy supply and demand is taken as a constraint to resolve the optimization model a simulation based optimization algorithm is developed which consists of simulation model and optimization module simulation model is constructed to overcome the complicated and stochastic operation process in container terminals and obtain the hourly energy demands for optimization procedure optimization module is used to search the solution space evaluate the optimal results and provide the final decision under different evaluation strategies finally taking a container terminal in northeast china as an example energy demands are obtained by carrying out the simulation model in addition the capacity and operation optimization under different evaluation strategies is provided by using the proposed simulation based optimization algorithm 1 energy demands in the container terminal are obtained by the proposed simulation model and energy demands represent highly dynamic nature ranging from 1 6 mwh to 9 5 mwh within a week 2 building wind power systems in the locations with high wind speed has a significant improvement on the economic and environmental benefits of the hres for container terminals when the average wind speed increases from 3 9 m s to 11 7 m s the optimal annual total cost reduces by 34 2 33 7 and 37 7 and the optimal carbon emissions reduce by 76 5 74 4 and 77 9 under low carbon strategy trade off strategy and cost saving strategy correspondingly 3 there is a negative correlation between optimal annual total cost and optimal carbon emissions with the installed quantity of wind turbines increasing the optimal annual total cost under low carbon strategy trade off strategy and cost saving strategy raises by 97 9 83 7 and 85 0 with the increase of installed quantity of wind turbines from 1 to 9 while the optimal carbon emissions reduce by 39 1 28 5 and 31 9 respectively 4 the price of scheduled energy has almost no impact on the optimal installation capacity of wind power systems and the optimal carbon emissions under low carbon strategy and cost saving strategy yet has little influence on the economic benefits of the hres the results and proposed method can be applied to determine the optimal installation capacity and operation strategy of a hybrid renewable energy system for a container terminal however this paper focuses on the optimization of the system regardless of the influence of uncertain parameters on the optimal results such as the fluctuation of the investment cost of wind power systems and carbon emission factors future study should introduce a novel method for the capacity and operation optimization of the hybrid energy system under uncertainties acknowledgments this research was funded by the national natural science foundation of china china grant number no 51709037 and 51779037 we would also like to thank the fundamental research funds for the central universities china no dut18rc 4 053 and doctoral start up foundation of liaoning province china no 20170520165 for supporting this research 
22709,the contribution of this paper is to provide a method for optimizing installation capacity and operation strategy of a hybrid renewable energy system hres with offshore wind energy for container terminals a mixed integer optimization model of the hres is proposed in which maximum environmental and economic benefits are considered as two objectives and energy supply and demand balances energy storage balances technical constraints and quantity limitations are considered as constraints however container terminals typically execute many complicated and stochastic operation processes and thus represent highly dynamic energy demands therefore a simulation based optimization algorithm is developed to resolve the optimization model which consists of a simulation model and an optimization module the simulation model is constructed to overcome the stochastic characteristics and obtain the hourly energy demands in container terminals which are fed into the optimization module while the optimization module is used to search the solution space and provide the final decisions under three evaluation strategies cost saving low carbon and trade off strategy finally taking a container terminal in northeast china as an example optimal results are obtained by the proposed algorithm which can be used to provide references for power department policy making and green container terminal construction keywords green container terminals hybrid renewable energy system offshore wind energy simulation based optimization installation capacity operation strategy 1 introduction given the growing concerns on environmental challenges of traditional energy resources efforts aiming at energy related issues have been made from green container terminal perspective e g utilizing shore power and renewable energy for berthed ships kotrikla et al 2017 among them a promising avenue towards green container terminal construction lies in the transformation of energy supply structure that covers large shares or all of the energy demands in container terminals by means of renewable energy which have huge economic and environmental benefits melikoglu 2018 several port authorities worldwide have been developing initiatives in order to improve their energetic sustainability by fulfilling electric requirements in ports with renewable energy efiport 2008 heras saizarbitoria et al 2013 ramos et al 2014 hentschel et al 2018 however due to the intermittent and uncertain nature of renewable energy many problems are created when these resources are used to supply the local loads individually such as low security and reliability of supply bahramara et al 2016 to solve the problems stated above hybrid renewable energy systems hress which consist of renewable traditional energy resources and energy storages have emerged and are applied to provide required electricity for ships in ports tang et al 2018a within the wide variety of renewable energy sources adopted in hress offshore wind energy has gained growing interest and is arising as an alternative energy source with a record 18 814 mw of cumulative installed capacity at the end of 2017 global wind energy council 2018 the offshore wind energy has high capacity factors low negative impacts on human society such as visual and noise impacts kaldellis and apostolou 2017 and has been used to fulfill electric requirements in ports to reduce air pollution kotrikla et al 2017 however optimization management of such a hres comprising offshore wind energy for container terminals can be a challenging task given the need to simultaneously cover multiple technical methods e g installation capacity operation management etc and multiple conflicting objectives involved in hres design e g economic environmental etc furthermore the wind energy presents a high randomness and large variations vivas et al 2018 and energy demands in container terminals are characterized by high dynamics due to stochastic operation processes grundmeier et al 2014 which further causes challenges in operating the hress such as balancing energy supply and demand therefore to make full use of the clean and free wind energy this paper proposes a method for optimizing installation capacity and operation strategy of the hres with offshore wind energy for container terminals to realize the trade off between environmental benefits and economical profits many researchers have been devoted to identifying an optimal hres design and obtaining the rational installation capacity and optimal operation strategy of hress by different optimization techniques hutardo et al 2015 kaabeche et al 2011 song et al 2015 aiming at fully achieving objectives of being economic and environmentally friendly yang et al 2008 wang et al 2018 koutroulis et al 2006 applied the genetic algorithm to determine the optimum number and type of units of a hybrid photovoltaic wind system which minimized total system cost over a 20 year lifetime ekren and ekren 2010 optimized a hybrid photovoltaic wind battery storage system by stochastic gradient search method to minimize the total system cost bernal agustín and dufo lópez 2009 built a multi objective programming model for the optimal design of a photovoltaic wind diesel system which aimed at finding the best combinations of components for the hybrid energy system and the control strategy to minimize simultaneously both the total cost in the lifecycle and the unmet load gonzález et al 2015 studied optimal sizing of hybrid grid connected photovoltaic wind power systems based on real wind and solar irradiation data and electricity demand from a certain location aiming at reducing installation costs ghorbani et al 2018 developed a hybrid genetic algorithm with particle swarm optimization for the optimal sizing of an off grid house applied by a photovoltaic wind battery system for the purpose of reducing cost and increasing reliability dahmane et al 2013 proposed an intelligent algorithm for optimal power management of a hybrid renewable system containing a photovoltaic wind diesel generator and battery energy storage for the matching between electricity supply and load demand through analysis of the researches mentioned previously it can be observed that most of the optimization models proposed for optimizing capacity and operation of hress are mostly applied in remote residential buildings besides most attentions focus on the system cost and pollutants emission separately and few studies take environmental benefits and economical profits as objectives simultaneously for coordinated economic and environmental objectives ogunjuyigbe et al 2016 utilized a genetic algorithm to optimize photovoltaic wind diesel battery hybrid energy system which minimized life cycle cost carbon emission and dump energy of remote residential buildings however how to optimize the capacity and operation of hress for container terminals to realize the trade off between environmental and economic benefits is not resolved the hress applied in ports typically consisting of the photovoltaic arrays battery banks cold ironing and on board diesel generators are always used to feed the electric loads of ships while at berth tang et al 2018b the optimal operations of the hress adopted for ships have been regarded as a problem recently and corresponding research has been studied tang et al 2018a formulated the optimal operation problem of hress for a ship as an optimization model subject to a number of constraints including emission regulations of ports the results showed that the optimal operation of hress could bring promising electricity cost savings and robustness cannon et al 2015 presented the measures adopted by the port of los angeles and the shanghai municipal transportation commission for reducing the air emissions at both ports to institute and expand the use of cold ironing on ships while at berth lan et al 2015 proposed an optimal sizing method for a hybrid photovoltaic diesel storage ship power system which minimized the investment cost fuel cost and co2 emissions tang et al 2018b proposed an optimal energy management model and control methodology to obtain operational safety and efficiency of hress for large green ships while at berth which was solved by an adaptive multi context cooperatively coevolving particle swarm optimization algorithm through analysis of the aforementioned studies most of the works related to optimizing the capacity and operation of hress adopted in ports only concern the energy demands of ships without consideration of the energy demands of handling facilities during operation processes in ports besides the optimization models introduced only constrain the energy balance between supply and demand for a certain period e g the berthing period regardless of hourly fluctuations of highly dynamic energy demands in the long time the capacity and operation optimization of hress for container terminals considering the energy demands of ships and handling facilities to accurately satisfy the hourly balance between energy supply and demand is not resolved another challenge in influencing capacity and operation optimization of hress is the high randomness and large variations of energy demands in container terminals limited literature has studied the dynamic characteristics of energy demands in container terminals and most of related works mainly focus on minimizing energy consumption in container terminals by optimizing the allocation and scheduling of handling facilities golias et al 2010 proposed a berth scheduling policy to minimize the total emissions and fuel consumption for all ships while in idle mode and developed a genetic algorithm to solve the optimization model du et al 2011 formulated a berth allocation model considering fuel consumption and proposed a mixed integer second order cone programming model to offset the negative impact of the nonlinear complexity he et al 2015a proposed a yard crane scheduling model considering the trade off between efficiency and energy consumption and developed an integrated simulation optimization method for solving the problem chang et al 2010 developed a rolling horizon model based on objective programming for the integrated optimization of berth allocation and quay crane assignment with consideration of quay crane s energy consumption he et al 2015b formulated a mixed integer programming model for the problem of integrated quay crane scheduling internal truck scheduling and yard crane scheduling aiming at minimizing the total transportation energy consumption of all tasks the existing literature shows that energy consumption in container terminals always works as an objective function or constraint condition in an optimization model for allocation assignment and scheduling problem of handling facilities however how to obtain energy demands in container terminals in a certain period and represent the dynamic characteristics of energy demands is not resolved furthermore a container terminal operation system is very complicated and stochastic including many logistical processes such as berth allocation storage planning on container ships storage and stacking logistics and etc it is difficult or even impossible to formulate and evaluate such a complex system by analytical methods which can be resolved by discrete event simulation lee et al 2008 therefore in order to cope with the high uncertainties involved in a complex operation system it is imperative to provide a simulation based method to study the highly dynamic energy demands in container terminals the contribution of this paper is to provide a mixed integer optimization model for optimizing installation capacity and operation strategy of the hres with offshore wind energy for container terminals in which maximizing environmental benefits and minimizing economical costs are considered as two conflict objectives and accurately satisfying the hourly balance between energy supply and demand is taken as a constraint besides in order to overcome the complicated and stochastic operation processes a simulation based model is developed and thus used to obtain the hourly energy demands in container terminals in addition a simulation based optimization algorithm is proposed to resolve the optimization model the remainder of this paper is structured as follows section 2 focuses on problem description including analysis on energy demands in container terminals adopted patterns of the hres operation strategy of the adopted hres and evaluation strategy section 3 describes the proposed mixed integer optimization model and the simulation based optimization method to solve the model is presented in section 4 then section 5 carries out experiments to optimize installation capacity and operation strategy of the proposed hres followed by conclusions and future discussions in section 6 2 problem description there are many challenges in resolving the optimization model of the hres such as analyzing the dynamic energy demands in container terminals offsetting negative impacts of intermittent and variability of wind energy accurately satisfying the hourly balance between energy supply and demand and evaluation strategy for the optimal results in order to address the challenges above there are four problems that should be discussed more in detail including analysis on energy demands in container terminals adopted patterns of the hres operation strategy of the adopted hres and evaluation strategy 2 1 analysis on energy demands in container terminals a container terminal generally contains three components berth yard and gate where ships and handling facilities i e quay cranes trucks and yard cranes are taken as the main energy consumers during operation processes as shown in fig 1 generally trucks are driven by fuel consumption while ships quay cranes and yard cranes consume electricity which is taken as the energy demands in container terminals in this paper due to many complicated and stochastic operation processes energy demands in container terminals are characterized by highly complex dynamics the following aims at representing operation processes and energy demands in container terminals 2 1 1 operation processes in container terminals operation processes in container terminals at least consist of three sub processes that are interconnected ships arriving and berthing sub process handling operation sub process and ships departing sub process all these processes require available and shared resources and equipment to fulfill the tasks involved in handling and transporting containers quay cranes yard cranes and trucks gudelj et al 2010 the operation processes comprise two dynamic processes opposed to each other loading and unloading the following is introduced more in detail only focusing on the unloading process 2 1 1 1 ships arriving and berthing sub process ships arriving and berthing sub process consists of ships waiting at anchorage and ships going through waterway firstly arriving ships with various tonnages containers to be handled and powers of auxiliary engines enter the container terminal and have to wait at anchorage when the waterway and berth are occupied then a berth is allocated to a ship according to previously user defined assignment rules which take the required berthing space and expected spending time at berth into account finally once the waterway and berth are idle in addition natural conditions e g wind fog and waves and traffic status e g safety distance and sailing direction in waterway are satisfied the ship will go through waterway and berth at an allocated berth in ships arriving and berthing sub process the berthing time of each ship and types numbers of ships while at berth simultaneously are influenced by many stochastic environments such as natural conditions and traffic status which can bring highly complex dynamics of energy demands of ships in a certain period 2 1 1 2 handling operation sub process handling operation sub process comprises assigning quay cranes scheduling trucks dispatching yard cranes and handling transporting and stacking containers once the ship arrives at berth after mooring operation the procedure of handling operation begins firstly the assigned quay cranes discharge containers from ships to scheduled trucks then the trucks pick up containers unloaded from ships and transport the containers to the deployed yard block to wait for dispatched yard cranes to stack the containers finally once the yard crane is idle containers will be shuffled and stacked in handling operation sub process the quantity of handled containers in a certain time is influenced by many uncertain factors e g working efficiency congestion at road queue to wait for idle facilities which can result in unpredictable fluctuations of expected spending time at berth for ships and energy demands of handling facilities at each time step 2 1 1 3 ships departing sub process once handling operation is finished the ship prepares to leave the berth before leaving the natural conditions and traffic status are still judged if all the conditions are satisfied the ship will go through waterway and depart the queue to wait for stochastic conditions can result in additional spending time at berth for ships furthermore increase energy demands of ships while at berth based on the analysis of the operation processes above container terminals consist of highly uncertain and dynamic operation processes which cannot be resolved by theoretical and analytical methods not to speak of obtaining energy demands in container terminals at each time step as a useful tool lee et al 2008 a simulation model is needed to represent the complete and dynamic system environment in container terminals 2 1 2 energy demands in container terminals during operation processes in container terminals ships quay cranes and yard cranes require energy demands for electricity electricity replacing auxiliary diesels for ships mainly satisfies the hoteling load demand of ships while at berth such as lighting heating ventilation air conditioning cold storage and cooking electricity consumed by quay cranes mainly meets the load demand of picking containers up from ships moving containers horizontally and dropping containers on trucks electricity utilized by yard cranes mainly fulfills the load demand of picking containers off trucks moving containers to assigned storage locations and travelling to the location of the next truck energy demands of ships can be obtained by powers of auxiliary engines and expected spending time at berth for ships peng et al 2019 while energy demands of quay cranes and yard cranes can be calculated by the quantity of handled containers and electricity consumed for handling one container peng et al 2014 however due to the high complexity of operation processes as shown previously energy demands in container terminals are influenced by many stochastic factors therefore a simulation based method is developed to obtain and analyze the energy demands in container terminals and the detailed simulation model for a container terminal is organized in section 4 3 2 2 adopted patterns of the hres when renewable resources generate the electricity to meet energy demands of terminal users individually many difficulties are emerged such as low reliability and security of supply due to intermittent and variability which can be solved effectively with hress erdinc and uzunoglu 2012 bahramara et al 2016 the hres adopted in this paper comprises offshore wind energy energy storage systems and conventional energy generation which fulfills the energy demands of ships quay cranes and yard cranes as represented in fig 2 in the adopted hres offshore wind energy is considered as the priority energy source conventional energy generation as a backup source to ensure uninterrupted electricity supply energy storage systems are needed to store excess electricity from wind energy generation and provide electricity when the production is deficit conventional energy generation is taken as constant electricity supply at each time step and can be varying correspondingly at different time steps according to the relationships between energy supply and demand the following mainly focuses on the wind generation modeling and energy storage modeling 2 2 1 wind generation modeling there are two common analyzing approaches to model the wind power generation i e theoretical analysis of power speed relationships and measuring power curves of wind turbines respectively for the first approach the models appeared in the literature are usually parametric and non parametric ouyang et al 2017 taking the piecewise linear model included in parametric models as an example a number of different distribution models have been proposed to describe the probability distribution of wind speed shu et al 2015 in particular the weibull and rayleigh probability distribution models are regularly used as proper representation models of wind speed variation burton et al 2001 zakariazadeh et al 2014 once hourly mean wind speeds over a year are obtained mathematical model for power outputs of wind energy generation has been calculated shin et al 2017 and is given as follows 1 p w v 0 0 v v c i p r v v c i v r v c i v c i v v r p r v r v v c o 0 v v c o where p w v is the power outputs of wind energy generation at wind speed v and p r is the rated power besides v c i v r and v c o are the cut in wind speed rated speed and cut out wind speed respectively however due to the difference of the main characteristics of wind turbines and weather conditions such as temperature density and wind directions the power outputs obtained by theoretical analysis always represent significant deviations from the measured power curve of wind turbines ciulla et al 2019 sohoni et al 2016 for example the mismatch among theoretical power curve by using the piecewise linear model and the measured power curve of a real life wind turbine heag hw1 780 2016 is shown in fig 3 thereby for a real wind energy project the measured power curve shows a higher reliability compared to theoretical analysis for the promoters to analyze economic benefits of the investment which is the reason for adopting measured power curves of available commercial wind turbines in this paper 2 2 2 energy storage modeling in most previous studies charging and discharging of energy storage systems are automatically calculated by the difference between the energy production and energy demand shin et al 2017 however charging and discharging of the storages along with scheduled energy from conventional energy generation are considered as decision variables in this paper therefore decided by charging and discharging variables the state of energy storage systems is described below 2 e t e t 1 1 σ b η c h q t c h 1 η d i s c q t d i s c where e t is the stored electricity of energy storage systems at time step t kwh σ b is the self discharge rate η c h is the charging efficiency η d i s c is the discharging efficiency q t c h is the charging electricity at time step t kwh q t d i s c is the discharging electricity at time step t kwh the stored electricity at time step t of energy storage systems has several technical constraints such as the minimum and maximum allowable capacity the minimum bound of allowable capacity can be expressed by the maximum depth of discharge dod as in eq 3 3 e min 1 dod e max where e min is the minimum allowable capacity of energy storage systems kwh dod is the maximum depth of discharge e max is the maximum allowable capacity of energy storage systems kwh the e t must be bounded within the scale e min e max shown as follows 4 e min e t e max besides essential technical constraints of charging and discharging power should be satisfied during the operation process of energy storage systems zhang et al 2018 tan 2016 formulized as follows 5 0 p t c h p c h max 6 0 p t d i s c p d i s c max where p t c h and p t d i s c are the charging and discharging power of energy storage systems at time step t kw respectively p c h max and p d i s c max are the maximum allowable charging and discharging power of energy storage systems kw respectively 2 3 operation strategy of the adopted hres the main purpose of this paper is to optimize installation capacity and operation strategy of hress to realize the trade off between environmental benefits and economical profits the installation capacity optimization is to determine the optimal installed capacity of offshore wind power systems and energy storage systems while operation strategy optimization is to determine charging discharging energy to from energy storage systems and scheduled energy from conventional power generation at each time step as shown in fig 4 during the time interval t 1 t in fig 4 the electricity produced is not enough to meet energy demand and thus the shortage of energy demand is supplemented firstly by discharging energy from energy storage systems and then by scheduled energy from conventional power generation conversely during the time interval t t 1 the energy produced by wind generations is greater than the energy demand therefore the excess energy will be charged to energy storage systems based on the operation strategy of the adopted hres the hourly energy balance is satisfied in addition charging energy discharging energy and scheduled energy are optimized at each time step to minimize annual total cost and carbon emissions 2 4 evaluation strategy the environmental benefits and economical profits are always in negative correlations and cannot reach the optimal simultaneously therefore the trade off strategy is introduced to evaluate the feasible solutions in the pareto optimal set the trade off strategy concerning the trade off between environmental and economic benefits is based on membership theory and the weights for evaluating objective functions is determined by variance in addition the detailed evaluation process can be obtained according to the study by peng et al 2019 and is shown as follows the membership degree of objective function j of the feasible solution i is calculated as follows 7 σ i j p j max p i j p j max p j min i θ j ξ where σ i j is the membership degree θ is the set of all the feasible solutions indexed by i ξ is the set of all objective functions indexed by j p i j is the objective function j of the feasible solution i p j max and p j min are the maximum and minimum values of objective function j in the pareto optimal set the weight for evaluating function j by variance can be calculated as follows 8 η j i θ k θ σ i j σ k j 2 j ξ i θ k θ σ i j σ k j 2 where η j is the weight for evaluating function j which is subject to j ξ η j 1 the comprehensive evaluation index for the feasible solution i can be calculated as follows 9 f i j ξ σ i j η j i θ according to the maximum comprehensive evaluation index the optimal solution under trade off strategy can be selected besides this paper considers additional evaluation strategies i e cost saving strategy and low carbon strategy to analyze the sensitivity of evaluation strategies on the final decisions cost saving strategy selects the solution with minimum cost from the pareto optimal set while low carbon strategy considers the solution with minimum carbon emissions therefore according to the proposed evaluation strategies final decisions for the problem of optimizing the hres under cost saving low carbon and trade off strategy can be obtained 3 model formulation in this section a bi objective mixed integer programming optimization model for the problem of how to determine the optimal installed capacity and operation strategy of the hres considering a trade off between environmental benefits and economical profits is developed in the proposed model maximizing environmental benefits and minimizing annual total costs of the system are represented as the two objectives and energy supply and demand balances energy storage balances technical constraints and quantity limitations are considered as constraints 3 1 model assumptions 1 during handling operation processes the electricity requirements of berthed ships quay cranes and yard cranes are provided by the adopted hres 2 it is assumed that conventional energy power plants are invested by the government sector and therefore the investment cost operation and management cost of conventional energy generation are not taken into account 3 the handling facilities in container terminals are taken full use of in addition no accidents and interference happen 3 2 mixed integer optimization model 3 2 1 nomenclature to describe the sets parameters and variables in the bi objective mixed integer programming model the following nomenclature is used as shown in table 1 3 2 2 objective functions and constraints the bi objective mixed integer programming model for the problem can be formulated as follows 10 objective 1 min c c i w c o m w c i s c o m s c g 11 objective 2 min w t 1 t c e g q g t i 1 i t 1 t c e w x i q i t w subjected to 12 q g t i 1 i x i q i t w j 1 j y j q j t c h j 1 j y j q j t d i s c q r t 13 e j t e j t 1 1 σ b j η c h j q j t c h 1 η d i s c j q j t d i s c 14 q i t w p w i δ t 15 e min j e j t e max j 16 e max j q s j 17 e min j 1 dod j e max j 18 0 q j t c h p max j c h δ t 19 0 q j t d i s c p max j d i s c δ t 20 i 1 i x i x 21 j 1 j y j y where c i w c o m w c i s c o m s and c g represent respectively the annual investment cost of offshore wind power systems the annual operation and maintenance cost of offshore wind power systems the annual investment cost of energy storage systems the annual operation and maintenance cost of energy storage systems and the annual cost of scheduled energy from conventional energy generation which are defined as eq 22 eq 26 22 c i w i 1 i c f w i p w i c l w i x i c r f i 23 c o m w i 1 i x i p w i μ w c r f i 24 c i s j 1 j c f s j q s j c l s j y j c r f j 25 c o m s j 1 j y j q s j μ s c r f j 26 c g t 1 t c g q g t the capital recovery factor of offshore wind power system i c r f i is defined in eq 27 used to annualize the total investment operation and management costs of an installed system i the capital recovery factor for the energy storage system j c r f j is defined in a similar manner as in eq 28 27 c r f i r r 1 m w i r 1 m w i 1 28 c r f j r r 1 m s j r 1 m s j 1 besides the installation capacity of offshore wind power systems and energy storage systems is defined as follows 29 i c w i 1 t p w i x i 30 i c s j 1 j q s j y j eq 10 aims at minimizing the annual total cost of the adopted hres comprising the annual total investment operation and management cost of offshore wind power systems and energy storage systems and the annual cost of scheduled energy from conventional energy generation eq 11 is to minimize the carbon emissions due to the energy consumption in container terminals constraint 12 represents the constraint of energy supply and demand balance guaranteeing that energy demand in a container terminal must be met at each time step constraint 13 represents the constraint of energy storage balance required to describe the operation process of energy storage systems at time steps t and t 1 with respect to the state of charge charging and discharging efficiencies as well as self discharge losses constraint 14 constraint 15 represent technical constraints consisting of the capacity limitations during the operation process of wind power systems and energy storage systems constraint 16 constraint 17 define the maximum and minimum allowable capacity of energy storage systems respectively which are used to restrict the stored electricity in energy storage systems at each time step constraint 18 constraint 19 represent the constraints of charging and discharging power of energy storage systems at time step t constraint 20 constraint 21 represent quantity limitations of installed wind power systems and energy storage systems due to the site selection and land restriction the above optimization model formulates the problem for optimizing the capacity and operation of the adopted hres given the operation processes in container terminals are very complicated and uncertain it is almost impossible to obtain energy demands just by mathematical or analytical methods therefore a simulation based method is developed to obtain energy demands in the container terminal at each time step and a simulation based optimization algorithm which embeds the simulation model into the optimization module is introduced to solve the optimization model the detailed description of the algorithm is presented in section 4 4 simulation based optimization algorithm most problems associated with optimization of actual system such as transportation systems financial management systems and manufacturing systems are too complex to be modeled analytically due to many difficult and inherent features lee et al 2008 furthermore simulation method can only estimate the performance of given systems usually insufficient from the perspective of optimization he et al 2013 therefore considering the dynamic and stochastic nature in container terminals the simulation based optimization algorithm for the problem of optimizing the adopted hres is proposed 4 1 framework of the simulation based optimization algorithm as illustrated in fig 5 the simulation based optimization algorithm for the problem comprises two modules respectively optimization module and simulation model in particular the optimization module is applied to search the solution space firstly whereas the simulation model is used to obtain the energy demands in container terminals which are fed into optimization module to optimize the operation strategy at each time step then the objective function values can be calculated after the optimization of the operation strategy until all the feasible settings for decision variables are enumerated the pareto optimal set can be obtained and the results can be evaluated by evaluation strategy finally the optimal installation capacity and operation strategy of the adopted hres can be output according to the evaluation results 4 2 optimization module of the simulation based optimization algorithm in the optimization module nine main phases are proposed to present details of the optimization algorithm for the problem of optimizing the adopted hres the overall optimization procedures are shown in table 2 as described in table 2 phase 1 aims at generating initial feasible settings of the hres for the proposed algorithm initialization of decision variables x i and y j is the beginning of the introduced procedure and other parameters can be fed into the algorithm according to real operation data phase 2 focuses on running the simulation model to deal with the complicated and stochastic nature and obtain energy demands in the container terminal at each time step the simulation models take parameters of ships berths handling facilities and etc as inputs and output the energy demands phase 3 of the procedure aims at calculating the power outputs of wind power systems by wind generation modeling at each time step which in conjunction with energy demands obtained in phase 2 can be applied to optimize operation strategy in phase 4 after the optimization of the operating values for decision variables q j t c h q j t d i s c and q g t objective function values can be calculated in phase 5 phase 6 checks the stopping rule of the proposed procedure if all the feasible settings are enumerated the procedure will be terminated otherwise the procedure will continue and return to the next feasible setting after all the feasible settings are enumerated the pareto optimal set for the problem can be obtained in phase 7 phase 8 focuses on the evaluation of the optimal solutions for the problem by evaluation strategy finally according to the evaluation results the optimal installation capacity and operation strategy of the adopted hres can be output in phase 9 4 3 simulation model of the simulation based optimization algorithm based on the analysis of operation processes in section 2 1 1 a logic model is firstly developed before building simulation models as shown in fig 6 based on the logic model the detailed simulation model for a container terminal is developed in this subsection which represents the complete and dynamic system environment in container terminals and is therefore used to obtain energy demands at each time step the simulation model includes three sub models ships arriving and berthing sub model handling operation sub model and ships departing sub model 4 3 1 ships arriving and berthing sub model in the ships arriving and berthing sub model ships are firstly created by the create module with arrival interval obeying a certain distribution then the attributes such as tonnage of ships powers of auxiliary engines average handled quantity of containers and etc are assigned to ships in the assign module next the allocated berths are assigned to ships in the assign berths to ships module in this module ships will seize the berth resources if the berth is idle otherwise ships have to wait for idle berths finally when natural conditions and traffic status in waterway are satisfied the ships will go through the waterway and berth at the allocated berths meanwhile the berthing time of ships will be recorded in the assign berthing time module as shown in fig 7 4 3 2 handling operation sub model once mooring at berth and completing the auxiliary operation the procedure of handling operation begins as shown in fig 8 firstly containers to be handled are separated from ships in the separate module and sent to quay cranes handling module for handling operation then containers are handled by quay cranes transported by trucks and stacked by yard cranes and the energy demands for handling these containers by quay and yard cranes are recorded in the assign module finally the decide module is used to judge whether handling operation for ships is finished if finished the time for handling operation will be recorded in assign module 4 3 3 ships departing sub model once handling operation is finished ships prepare to leave the berth as shown in fig 9 when the natural conditions and traffic status are satisfied ships release berth resources by the release module meanwhile the releasing time and expected spending time at berth for ships are recorded in assign module which in conjunction with powers of auxiliary engines can be used to obtain the energy demands of ships then ships go through the waterway to leave the port via out waterway module finally the energy demands of ships quay cranes and yard cranes at each time step can be written to the external excel spreadsheet with the vba module 5 case study 5 1 parameter settings the experiments consider a container terminal in northeast china with five container berths as the simulation case in the planning phase of energy supply systems for the container terminal the hres consisting of offshore wind energy is considered to meet the goal of green ports and it is required to allocate the rational capacity and determine the optimal operation strategy of the hres the terminal is 1847m long and the tonnage of berths and the number of quay cranes assigned to each berth are presented in table 3 besides the working efficiency of each quay crane for handling operation is 30 teu h the dimension of waterway covers the length of 20 nm along with one way traffic lane and the navigation speed of ships through the waterway is 18 52 km per hour default parameters as inputs in the simulation model such as tidal conditions are provided by the port company this paper takes a full calendar year as an example study and all the time steps are set as 8760 the following is focusing on the parameters of ships handling facilities wind wind power systems energy storage systems carbon emission factors and energy prices 5 1 1 parameters of ships according to the frequency curve fitting and hypothesis testing of the real operation data in 2016 ships arrive at the container terminal with inter arrival time obeying negative exponential distribution and the average value of ship s inter arrival is 7 0 h the type combinations of ships such as tonnage proportion average handled quantity and berth number for ship mooring are listed in table 4 and the auxiliary working time for ships is set as 4 0h 5 1 2 parameters of handling facilities in order to obtain energy demands of handling facilities electricity consumed for handling one container is necessary according to the study by peng et al 2014 electricity consumed for handling one container by quay cranes and yard cranes is set as 5 23 kwh teu and 3 03 kwh teu respectively 5 1 3 parameters of wind a collection of hourly mean wind speeds in one year around the container terminal has been carried out based on the fitting curve and data histogram of wind data collected it can be observed that the hourly mean wind speed obeys weibull distribution as shown in fig 10 and the average wind speed of the whole year is 3 9 m s 5 1 4 parameters of wind power systems in order to analyze environmental and economic benefits of the adopted hres the cost and technical parameters of offshore wind power systems are needed to select an optimal design scheme for the hres in the container terminal this paper considers two types of wind power systems produced by a manufacturer and b manufacturer respectively considering the trade secrets the name of the two manufacturers is given by a and b and the model number of wind turbines is given by a 1 a 2 a 3 b 1 b 2 and b 3 besides the installed capacity the cost parameters and technical parameters of the wind power systems are illustrated in table 5 and table 6 in addition the power curves of the wind turbines are shown in fig 11 and fig 12 due to site selection and land restriction the installed quantity of all the wind turbines is set as 5 5 1 5 parameters of energy storage systems in this paper a type of mature energy storage technologies battery bank is introduced the battery bank is comprised of 210 batteries according to the parameters provided by the producer the energy capacity of one battery is equal to 12 v 200 ah 2 4 kwh therefore the capacity of the battery bank is equal to 210 2 4 kwh 504 kwh in addition the maximum depth of discharge is 50 and the charging efficiency is 85 and the discharging efficiency is 100 with consideration of the security of the battery bank the peak charging and discharging ratios are set as 0 3 c and 1 0 c therefore the maximum charging power of the battery bank is equal to 210 0 3 12 v 200 a 151 2 kw and the maximum discharging power of the battery bank is equal to 210 1 0 12 v 200 a 504 kw besides the investment costs operation and maintenance costs and lifetimes of the battery bank along with the technical parameters are shown in table 7 considering the site selection and land restriction the installed quantity of all the battery banks is set as 3 5 1 6 parameters of carbon emission factors and energy prices for the calculation of carbon emissions in the container terminal carbon emission factors of offshore wind power systems and conventional power generation are considered and set as 0 0165 kg kw h and 1 0416 kg kw h wang et al 2017 besides in order to analyze the economic benefits the price of scheduled electricity from conventional energy generation is set as 0 1455 kwh according to the industrial electricity price in china 5 2 results in this section the energy demands in the container terminal at each time step are obtained after carrying out the simulation model by using arena software besides the power outputs of wind power systems are calculated by the measured power curves of the wind turbines with real wind data after enumerating all the feasible settings the optimal installed capacity and operation strategy of the hres are output under different evaluation strategies by the simulation based optimization algorithm 5 2 1 energy demands in the container terminal based on the expected spending time at berth for ships and the quantity of handled containers recorded by vba model along with other parameters of ships berths and handling facilities the energy demands in the container terminal are output by running the simulation model taking a typical week as an example energy demands at each time step are as shown in fig 13 as illustrated in fig 13 ships gives a significant contribution to the total energy demands in the container terminal followed by quay cranes and yard cranes besides the energy demands represent highly dynamic nature ranging from 1 6 mwh to 9 5 mwh within a week which will create great difficulties in energy demand and supply balances 5 2 2 analysis on optimal installation capacity and operation strategy of the hres once the energy demands power outputs of wind power systems and other parameters related to the hres are fed into the mixed integer optimization model the optimal installation capacity and operation strategy for the adopted hres are obtained by means of the proposed algorithm 1 optimal results of the hres adopting the wind turbines produced by a manufacturer by resolving the optimization models the solution space and pareto frontier of the optimization model can be obtained the bi objective optimal solutions can be determined for each pareto frontier with consideration of the trade off between the objectives which relies on the evaluation strategies in this paper three types of evaluation strategies are considered i e low carbon strategy trade off strategy and cost saving strategy respectively the optimal point under low carbon strategy can be selected which achieves the lowest carbon emissions among all the solutions besides the optimal point evaluated by the cost saving strategy can be determined which gains the minimum annual total cost among all the solutions the trade off optimal point can be obtained by carrying out the proposed evaluation strategy in section 2 4 used for realizing the trade off between economic and environmental benefits according to the evaluation results the optimal installation capacity of the hres under different evaluation strategies are shown in table 8 in addition the optimal operation strategy in a selected representative day under trade off evaluation strategy is shown in fig 14 as illustrated in table 8 under low carbon strategy the optimal installation capacity of wind power systems is 3 0 mw with the lowest carbon emissions but the highest annual total cost compared to the optimal results under other two strategies under cost saving strategy the optimal installation capacity of wind power systems is 0 75 mw with the lowest annual total cost but the highest carbon emissions under trade off strategy the optimal installed capacity of wind power systems is 2 25 mw which can realize the trade off between the carbon emissions and annual total cost as depicted in fig 14 due to the small installed capacity low wind speed and inadequate installed quantity the electricity outputs of wind power systems at each time step are relatively insufficient compared to the energy demands in the container terminal therefore there is a need to schedule a large amount of electricity from conventional energy generation to meet the energy demands in the container terminal 2 optimal results of the hres adopting the wind turbines produced by b manufacturer in order to analyze the influence of the installed capacity of wind turbines on the optimal results this paper considers the wind turbines with large installed capacity and produced by b manufacturer in the hres by resolving the optimization model the optimal installation capacity of wind power systems under different evaluation strategies and the optimal operation strategy in a typical day under trade off evaluation strategy are shown in table 9 and fig 15 respectively it can be seen from table 9 that the optimal results under trade off strategy are the same as the optimal results under cost saving strategy besides the optimal solution under low carbon strategy gains the lowest carbon emissions and the highest annual total cost besides the carbon emissions under different evaluation strategies are lower than that shown in table 8 while the annual total cost is larger than that shown in table 8 it means that under the same condition of wind speed increasing the installed capacity of wind turbines inevitably raises the system cost yet improves the environmental benefits in container terminals compared to fig 14 electricity output of wind power systems in fig 15 is relatively larger on average and the scheduled electricity correspondingly reduces the hres consisting of the wind power systems produced by b manufacturer are more likely to achieve environmental benefits in the container terminal and reduce the yearly purchase cost of the scheduled electricity compared to a manufacturer as analyzed above the low wind speed and inadequate installed quantity can lead to low electricity output of wind power systems and cause that the energy demands in the container terminal are fulfilled by the scheduled electricity to a great extent from conventional energy generation this result can create hardness to realize the economic and environmental benefits of the hres including wind energy resources and result in unwillingness of port operators to implement the hres for container terminals thereby this paper considers another three alternative locations provided by port operators for establishing the wind power systems with the average wind speed being 5 9 m s 9 7 m s and 11 7 m s and performs a sensitivity analysis of wind speed on the optimal results the optimal results of each location are shown in section 5 2 3 besides this paper performs a sensitivity analysis of installed quantity of wind turbines on the economic and environmental benefits of the hres in section 5 2 4 it is noted that the following analysis is based on the hres adopting the wind turbines produced by b manufacturer due to the larger environmental benefits compared to the wind turbines produced by a manufacturer 5 2 3 the sensitivity of wind speeds at different locations on the optimal results due to the various natural conditions at different locations for building the wind power systems this paper considers the original proposed location and another three alternative locations to study the sensitivity analysis of wind speed on the optimal results with average wind speed being 3 9 m s 5 9 m s 9 7 m s and 11 7 m s respectively as shown in table 10 the optimal installation capacity optimal annual total cost and optimal carbon emissions under different wind speeds are illustrated in fig 16 fig 18 correspondingly it can be seen from fig 16 that the optimal installed capacity of wind power systems is unalter under low carbon strategy and cost saving strategy when wind speed increases maintaining at 12 5 mw and 7 5 mw correspondingly while the optimal installed capacity of wind power systems under trade off strategy raises with the increase of wind speed from 7 5 mw to 9 5 mw besides it can be drawn from fig 17 and fig 18 that the optimal annual total cost and optimal carbon emissions under three evaluation strategies reduce a lot with the increase of wind speed for example under low carbon strategy trade off strategy and cost saving strategy the optimal annual total cost reduces by 34 2 33 7 and 37 7 and the optimal carbon emissions reduce by 76 5 74 4 and 77 9 correspondingly it shows that building wind power systems in the locations with high wind speed can significantly improve the economic and environmental benefits of the hres for the container terminal 5 2 4 the sensitivity of installed quantity of wind turbines and battery banks on the optimal results considering the site selection and land restriction for real life ports the installed quantity of wind turbines and battery banks can be limited in addition the economic and environmental benefits under different installed quantity of wind turbines and battery banks is essential for port operators which can provide references to the scheme selection of designing the hres for container terminals therefore the sensitivity analysis of the installed quantity on the optimal results under different strategies is conducted in this section 1 the sensitivity of the installed quantity of wind turbines on the optimal results in order to study the influence of the installed quantity of wind turbines on the optimal results this paper considers five scenarios with the installed quantity increasing from 1 to 9 stepped by 2 and the installed quantity of each scenario is 1 3 5 7 and 9 respectively besides the installed quantity of battery banks is set as 3 and the average wind speed is 3 9 m s by resolving the optimization models under different installed quantity of wind turbines the optimal installation capacity optimal annual total cost and optimal carbon emissions are illustrated in fig 19 fig 21 correspondingly as depicted in fig 19 the optimal installation capacity of wind power systems under low carbon strategy trade off strategy and cost saving strategy is positively correlated with the installed quantity of wind turbines raising by 20 mw 11 mw and 12 mw with the increase of installed quantity from 1 to 9 correspondingly besides the detailed optimal allocation on the installed capacity of wind turbines for each scenario is shown in table 11 it can be seen from table 11 that only the wind turbine b 2 is needed for constructing the hres under low carbon strategy and only the wind turbine b 1 is needed under cost saving strategy while the optimal allocation on the installed capacity of wind turbines under trade off strategy can be determined only by performing the proposed solution algorithm as shown in fig 20 the optimal annual total cost under low carbon strategy trade off strategy and cost saving strategy raises by 97 9 83 7 and 85 0 with the increase of installed quantity of wind turbines from 1 to 9 respectively while the optimal carbon emissions under three evaluation strategies reduce by 39 1 28 5 and 31 9 with the increase of the installed quantity respectively as shown in fig 21 the results indicate a negative correlation between optimal annual total cost and optimal carbon emissions in this condition port operators can allocate the installed capacity and determine the installed quantity of wind turbines with consideration of emission regulations and financial conditions in container terminals 2 the sensitivity of the installed quantity of battery banks on the optimal results this paper considers five scenarios with the installed quantity of battery banks increasing from 1 to 5 stepped by 1 to study the influence of the installed quantity on the optimal results the installed quantity of battery banks for each scenario is set as 1 2 3 4 and 5 respectively besides the installed quantity of wind turbines is set as 5 and the average wind speed is 3 9 m s by means of resolving the optimization models and implementing the evaluation strategies for all the solutions the optimal installation capacity of wind power systems is demonstrated in fig 22 and the detailed allocation for each type of wind turbines is represented in table 12 besides optimal annual total cost and optimal carbon emissions under different installed quantity of battery banks are illustrated in fig 23 and fig 24 correspondingly it can be drawn from fig 22 that the optimal installed capacity of wind power systems under low carbon strategy and cost saving strategy keeps constant at 12 5 mw and 7 5 mw respectively when the installed quantity of battery banks increases besides the optimal allocation for each type of wind turbines remains unaltered under these two evaluation strategies as shown in table 12 while the installed capacity of wind turbines under the trade off strategy changes within the range of the installed capacity under other two evaluation strategies when the installed quantity of battery banks raises as shown in fig 23 the optimal annual total cost under low carbon strategy trade off strategy and cost saving strategy increases by 4 2 6 9 and 15 1 with the installed quantity of battery banks increasing from 1 to 5 respectively whereas the optimal carbon emissions under three evaluation strategies decrease slightly by 1 6 8 8 and 0 9 correspondingly as shown in fig 24 the results show the installed quantity of battery banks has little impact on the environmental and economic benefits of the hres 5 2 5 the sensitivity of the price of the scheduled energy on the optimal results the purchase price of the scheduled energy presents fluctuating characteristics in different regions according to the peak load price and flat load price for large scale industry in electricity price tables of beijing beijing municipal commission of development and reform 2019 tianjin tianjin development and reform commission 2019 and dalian dalian development and reform commission 2018 the purchase price mainly changes from 0 10 kwh to 0 16 kwh thus this paper considers seven scenarios with the purchase price increasing from 0 1 kwh to 0 16 kwh stepped by 0 01 kwh to perform the sensitivity analysis of the price of the scheduled energy on the optimal results the price of the scheduled energy for each scenario is set as 0 10 kwh 0 11 kwh 0 12 kwh 0 13 kwh 0 14 kwh 0 15 kwh and 0 16 kwh respectively by resolving the optimization models the optimal installation capacity of wind power systems optimal annual total cost and optimal carbon emissions under different prices of the scheduled energy are shown in fig 25 fig 27 as shown in fig 25 the optimal installation capacity of wind power systems under low carbon strategy and cost saving strategy remains unaltered at 12 5 mw and 7 5 mw respectively similarly the optimal carbon emissions under these two evaluation strategies still keep constant at 20 3 thousand tons and 23 2 thousand tons with the price increasing as shown in fig 27 besides the optimal installed capacity under trade off strategy changes between 7 5 mw and 12 5 mw shown in fig 25 and the optimal carbon emissions under trade off strategy change between 20 3 thousand tons and 23 2 thousand tons as shown in fig 27 while the optimal annual total cost under low carbon strategy trade off strategy and cost saving strategy increases by 15 0 8 1 and 19 5 with the price increasing from 0 10 kwh to 0 16 kwh respectively as shown in fig 26 the results demonstrate that the price of scheduled energy has almost no impact on the optimal installation capacity of wind power systems and the optimal carbon emissions under the low carbon strategy and the cost saving strategy yet has little influence on the economic benefits of the hres from the above analysis it is can be drawn that the optimal selection of installation capacity and installed quantity of wind turbines and battery banks in the hres is influenced by many factors which should be determined by comprehensively considering natural conditions technical performance of wind turbines and battery banks annual total costs carbon emissions and evaluation strategies 6 conclusions the contribution of this paper is to optimize installation capacity and operation strategy of the hres with offshore wind energy for container terminals a mixed integer optimization model is proposed for the hres in which maximizing environmental benefits and minimizing annual total costs are considered as two conflict objectives and accurately satisfying the hourly balance between energy supply and demand is taken as a constraint to resolve the optimization model a simulation based optimization algorithm is developed which consists of simulation model and optimization module simulation model is constructed to overcome the complicated and stochastic operation process in container terminals and obtain the hourly energy demands for optimization procedure optimization module is used to search the solution space evaluate the optimal results and provide the final decision under different evaluation strategies finally taking a container terminal in northeast china as an example energy demands are obtained by carrying out the simulation model in addition the capacity and operation optimization under different evaluation strategies is provided by using the proposed simulation based optimization algorithm 1 energy demands in the container terminal are obtained by the proposed simulation model and energy demands represent highly dynamic nature ranging from 1 6 mwh to 9 5 mwh within a week 2 building wind power systems in the locations with high wind speed has a significant improvement on the economic and environmental benefits of the hres for container terminals when the average wind speed increases from 3 9 m s to 11 7 m s the optimal annual total cost reduces by 34 2 33 7 and 37 7 and the optimal carbon emissions reduce by 76 5 74 4 and 77 9 under low carbon strategy trade off strategy and cost saving strategy correspondingly 3 there is a negative correlation between optimal annual total cost and optimal carbon emissions with the installed quantity of wind turbines increasing the optimal annual total cost under low carbon strategy trade off strategy and cost saving strategy raises by 97 9 83 7 and 85 0 with the increase of installed quantity of wind turbines from 1 to 9 while the optimal carbon emissions reduce by 39 1 28 5 and 31 9 respectively 4 the price of scheduled energy has almost no impact on the optimal installation capacity of wind power systems and the optimal carbon emissions under low carbon strategy and cost saving strategy yet has little influence on the economic benefits of the hres the results and proposed method can be applied to determine the optimal installation capacity and operation strategy of a hybrid renewable energy system for a container terminal however this paper focuses on the optimization of the system regardless of the influence of uncertain parameters on the optimal results such as the fluctuation of the investment cost of wind power systems and carbon emission factors future study should introduce a novel method for the capacity and operation optimization of the hybrid energy system under uncertainties acknowledgments this research was funded by the national natural science foundation of china china grant number no 51709037 and 51779037 we would also like to thank the fundamental research funds for the central universities china no dut18rc 4 053 and doctoral start up foundation of liaoning province china no 20170520165 for supporting this research 
