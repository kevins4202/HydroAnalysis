index,text
15,recent studies have emphasized the importance of nonlocal models in characterizing bedload transport in natural rivers particularly in mixed size gravel beds or steep hillslopes nonlocality denotes that a quantity flux at a specific location x is dependent on the conditions in the surrounding area as opposed to solely at the location itself this concept applies in bedload transport even in planar flumes where particles are entrained at an upstream position and travel a finite distance ultimately contributing nonlocally to the sediment flux however existing bedload transport models such as the advection diffusion equation ade or the fractional derivative equation fde models are inadequate in characterizing the nonlocal transport behavior of bedload at a regional scale large errors may arise from the lack of an accurate description of the nonlocal bedload transport processes at regional scales this study proposes a regional based nonlocal bedload transport model which is conceptualized from the probabilistic exner based equations and the peridynamic pd differential operator the pd model encapsulates the nonlocal motion of bedload sediments on the basis of the pd differential operator by utilizing a pre defined weight function and influence domain comparisons demonstrate that the pd model serves as a generalized tool connecting the local and the global models with different pd functions and influence domains its variability on kernel function and influence domain enable it conveniently describe sub super and normal diffusion behaviors of bedload transport keywords bedload transport nonlocal regional scale pd differential operator msd data availability data will be made available on request 1 introduction bedload transport along the riverbed plays an essential role in the field of hydrology and geology despite significant advancements made in recent decades modeling bedload transport in complex natural conditions such as mixed size gravel beds or steep hillslopes remains a challenge chien and wan 1999 cheng 2003 ancey et al 2008 stark et al 2009 foufoula georgiou et al 2010 sun et al 2015 khademishamami and nardin 2020 li et al 2021 there is growing evidence from both field and laboratory studies that bedload sediments can travel long distances during transport producing the nonlocal processes in bedload transport roering et al 1999 ancey et al 2008 stark et al 2009 foufoula georgiou et al 2010 tucker and bradley 2010 sun et al 2015 doane et al 2018 here the terminology nonlocal follows the definition given by cushman 1990 if the constitutive variable depends on what is happening at a point in space or a very small neighborhood of the point the variable is said to be local and derived from a local theory on the other hand if information is needed to define the constitutive variables from regions of space distinct from a neighborhood of the space point where evaluation of the variables is to be made then the theories and constitutive variables are said to be nonlocal in character efficient modeling of nonlocal bedload transport has garnered significant attention in recent years with the primary challenge being the development of a nonlocal model for the bedload transport that is applicable to a wide range of conditions stark et al 2009 foufoula georgiou et al 2010 zhang et al 2014 sun et al 2015 gonzález aguirre et al 2020 the distinction between the local and the nonlocal bedload transport models is well defined mathematically local models propose that the sediment flux can be described as a function of local conditions at a given point whereas nonlocal models suggest that distal conditions also contribute to the sediment flux at that point at early stage the ensemble averaged nonlocal bedload flux has been formulated by means of the probability density of the particle step length tsujimoto 1978 parker et al 2000 ganti et al 2010 pierce and hassan 2020 pierce et al 2022 investigated bedload transport from a stochastic dynamics perspective and expanded upon the nonlocal formulation to depict sediment flux as a stochastic process furthermore fractional derivative models fdms have been proposed as a promising tool for characterizing nonlocal bedload transport behavior by considering a heavy tailed dynamic where the probability density function for step length of bedload sediments declines as a power law decay which represents a global correlated nonlocality in space foufoula georgiou et al 2010 bradley et al 2010 sun et al 2015 zhang et al 2016 nevertheless it should be acknowledged that the nonlocal transport of bedload in natural rivers is typically confined to a specific spatial domain zhang et al 2012 doane et al 2018 and that the nonlocal processes must be confined within the boundaries of the area additionally a variety of nonlocal transport mechanisms with different length scales may contribute to the overall bedload transport and the fdms incorporating the heavy tailed dynamic may not be able to capture all these nonlocal transport processes the existing local and global models for bedload transport are unable to capture the regional scale nonlocal transport processes due to the mathematical definition of the local and the global operators this limitation hinders the ability of researchers to fully understand the nonlocal dynamics of bedload transport for example bar migration and morphodynamics of riverbed variation in this study we propose a regional based nonlocal bedload transport model that incorporates the peridynamic pd differential operator madenci et al 2016 and the probabilistic exner based equations parker et al 2000 ganti et al 2010 ancey 2010 pelosi et al 2014 wu et al 2019 the nonlocal characteristics of the pd model are incorporated within the pd differential operator by utilizing a pre defined weight function and influence domain the pd model provides an alternative tool for characterizing bedload transport behavior from local to global scales which bridges the local and global models the rest of this study is organized as follows in section 2 a comprehensive review of the local the fractional global models and the pd differential operator is presented in section 3 a novel pd nonlocal model is proposed this proposed model is then analyzed in depth in section 4 in section 5 we apply the pd model to analyze bedload transport in the mixed size gravel beds with different source conditions in section 6 the diffusion regimes of the pd model with different pd functions are discussed and a comparison between the pd differential operator and the fractional operator is provided conclusions are finally drawn in section 7 2 materials and methods 2 1 local and global models the practical movement state of bedload sediments can be characterized as a series of alternating processes of particle deposition and entrainment the simplest form of the exner equations represents the conservation of mass between the processes of entrainment and deposition is expressed as follows parker et al 2000 ganti et al 2010 furbish et al 2012 1 1 λ p η x t t e x t d x t d x t 0 e x r t p s r d r where λ p is the porosity of the riverbed η l denotes the mean bed elevation e x t l t and d x t l t are the volumes of particles entrained and deposited per unit area and per unit time respectively p s r denotes the probability density function pdf of step length eq 1 demonstrates that bedload transport behavior can be characterized by various probability density functions pdfs of sediment step length for a thin tailed pdf such that p s r decays exponentially as r eq 1 in conjunction with exchange processes between the active layer and the substrate layer as shown in fig 1 degenerates asymptotically to the classical local advection diffusion equation ade type of model pelosi et al 2014 wu et al 2019 2 c a x t t c s x t t v c a x t x d d 2 c a x t x 2 c s x t t g c a c s x t where c a x t is the nondimensionalized bedload sediment concentration in the active layer c s x t is the nondimensionalized concentration of bedload sediment captured in the substrate layer v represents the virtual velocity at which the centroid of the tracer population travels downstream d d is the diffusion coefficient g is an arbitrary operator that characterizes the exchange processes between the active layer and the substrate layer for a heavy tailed pdf such that p s r decays power law as r and the fractional global bedload transport model is obtained in the active layer pelosi et al 2014 3 c a x t t c s x t t v c a x t x d d δ α x 2 c a x t c s x t t g c a c s x t and δ α x 2 is the fractional laplacian an equivalent hypersingular integral definition of the fractional laplacian is given by samko et al 1993 4 δ α x 2 c a x t 2 α x 1 α x γ n α x 2 π n γ 1 α x 2 p v r n c a x t c a x t x x n α x d x where p v is the principal value of the integral and γ x denotes the gamma function the fractional model 3 utilizes a convolution operator to represent a global correlated nonlocality in characterizing bedload transport 2 2 peridynamic differential operator pd differential operator is built by madenci et al 2016 2019 a pd differential operator can be constructed by taking into account the taylor series expansion of multi variable scalar field f x f x ξ in an m dimensional space as 5 f x ξ f x n 1 1 n n 2 1 n n 1 n m 1 n n 1 n m 1 1 n 1 n 2 n m ξ 1 n 1 ξ 2 n 2 ξ m n m n 1 n 2 n m f x x 1 n 1 x 2 n 2 x m n m r n x where ξ x x with r n x representing the remainder assuming that the contribution of the remainder is negligible and utilizing the properties of orthogonal functions g n p 1 p 2 p m ξ a pd nonlocal expression for partial derivatives of any order is derived as follows 6 p 1 p 2 p m f x x 1 p 1 x 2 p 2 x m p m h x f x ξ f x g n p 1 p 2 p m ξ d v x in which p i represents the order of differentiation with respect to variable x i with i 1 m the pd functions g n p 1 p 2 p m ξ possess the orthogonality property of 7 1 n 1 n 2 n m h x ξ 1 n 1 ξ 2 n 2 ξ m n m g n p 1 p 2 p m ξ d v x δ n 1 p 1 δ n 2 p 2 δ n m p m in which n i 1 n the pd functions can be constructed as 8 g n p 1 p 2 p m ξ q 1 1 n q 2 1 n q 1 q m 1 n q 1 q m 1 a q 1 q 2 q m p 1 p 2 p m w ξ ξ 1 q 1 ξ 2 q 2 ξ m q m where w ξ is a nondimensional weight function that characterizes the degree of the interaction between the surrounding points in each family the unknown coefficient a q 1 q 2 q m p 1 p 2 p m can be determined from the solution of the following equation 9 q 1 1 n q 2 1 n q 1 q m 1 n q 1 q m 1 a n 1 n 2 n m q 1 q 2 q m a q 1 q 2 q m p 1 p 2 p m b q 1 q 2 q m p 1 p 2 p m in which q i 1 n the shape matrix is constructed as follows 10 a n 1 n 2 n m q 1 q 2 q m h x w ξ ξ 1 n 1 q 1 ξ 2 n 2 q 2 ξ m n m q m d v x and 11 b q 1 q 2 q m p 1 p 2 p m n 1 n 2 n m δ n 1 p 1 δ n 2 p 2 δ n m p m the primary distinction between fdms and the pd model originates from their respective mathematical underpinnings duo et al 2017 sun et al 2022 fdms rely on a global convolution operator while the pd model utilizes an integral operator consequently the extent of nonlocality constitutes another notable difference between these two model types fdms are designed to encapsulate global correlated nonlocality whereas the pd model aims to represent a constrained nonlocal region delineated by a finite influence domain additionally the kernel function in the pd model can be arbitrarily selected based on a given system s specific conditions while the kernel function in fdms is confined to a power law form as a result the capacity to select the size and shape symmetric or asymmetric of the influence domain as well as the adjustability of the weight function facilitates a more adaptable depiction of nonlocal transport behavior of bedload nevertheless despite its advantages the pd model is not devoid of challenges in contrast to the fdms which possess only one parameter i e the order of the fractional derivative the pd model contains multiple parameters that fluctuate depending on the choice of influence domain and influence function the selection of influence domain and weight function in the pd model remains a persistent challenge as it necessitates a fundamental comprehension of the underlying physics governing bedload nonlocal transport processes moreover the above derivation of the pd operator demonstrates that the pd function is determined collectively by the weight function and the influence domain in instances where the pd function cannot be derived analytically numerical computations for the pd model necessitate solving the pd function for every point within the influence domain consequently the computational cost escalates considerably as the influence domain expands in certain cases the computational cost is substantially reduced when the pd function can be acquired directly through analytical means gu et al 2019 becoming significantly lower than that of the global form of the fractional order model 3 model development recent works on the topic of bedload transport suggest the need to distinguish between local and nonlocal transport processes and have highlighted the crucial role of topography in the nonlocal bedload transport processes foufoula georgiou et al 2010 furbish and roering 2013 sun et al 2015 in highly heterogeneous hydrogeological media preferential flow paths such as spatial connectivity may form thereby allowing for the nonlocal movement of bedload sediments this can manifest as early arrivals of bedload transport and may deviate from the classical fick s law j c x and can be considered as a nonlocal flux as depicted in fig 2 the structures of the riverbed can lead to nonlocal transport processes of bedload sediments for instance the slope of the riverbed can result in particles being entrained at an upslope position and subsequently traveling a finite distance contributing nonlocally to the flux additionally the bedload sediments can be entrained by the water flow along the high flow belts of the riverbed resulting in the nonlocal transport processes the local and global models ade 2 and f ade 3 respectively are commonly used to characterize the transition densities of bedload transport however these two models may not always sufficient in characterizing the complexities of bedload transport processes particularly with regard to a finite spatial correlation as a result a novel model in characterizing the nonlocal transport behavior of bedload sediments at regional scales is proposed in the following subsection 3 1 a pd bedload transport model in this subsection we propose a pd bedload transport model in which the nonlocal movements are incorporated in the pd differential operator as follows 12 c a x t t c s x t t h x v g n 1 ξ d d g n 2 ξ c a x ξ t c a x t d ξ c s x t t g c a c s x t where g n 1 and g n 2 are the pd functions madenci et al 2016 which can be determined according to the methods outlined in section 2 2 fig 3 shows the difference between the local and the regional scale transport models the movement of bedload sediments is governed by the regional scale transport model resulting in early arrivals i e the tracer sediments can be observed earlier downstream in the context of the pd model the influence domain h x and weight function w ξ are two crucial indicators for quantifying nonlocal properties of bedload transport each point x i has a set of associated family points within h x and only interacts with these family points x f 1 x f 2 by adjusting the pre defined influence domain and weight function the pd model 12 can be used to capture the bedload transport behavior in a wide range of conditions from local to global scales effectively bridging the local 2 and the global 3 models due to the diversity of weight functions and influence domains in the pd model investigating the well posedness of the pd operator for transport problems is an important and ongoing research endeavor in the field of nonlocal mechanics as discussed in the literature du 2016 tao et al 2017 4 model analysis 4 1 semi analytical solution of the pd model the general form c a x t of the pd model 12 with a deep burial processes is expressed as 13 c a x t t h x v g n 1 ξ d g n 2 ξ c a x ξ t c a x t d ξ χ c a x t where χ 1 t is the scaled burial frequency since g n 1 ξ and g n 2 ξ are zero outside h x one obtains 14 c a x t t v g n 1 c a x t d g n 2 c a x t β 1 χ c a x t where denotes the convolution operator g n p c x t r g n p ξ c x ξ t d ξ and 15 β 1 h x v g n 1 ξ d g n 2 ξ d ξ taking the fourier transform of eq 14 yields 16 c ˆ a k t t v g ˆ n 1 k c ˆ a k t d g ˆ n 2 k c ˆ a k t β 1 χ c ˆ a k t where k is the fourier variable collating eq 16 yields 17 c ˆ a k t t v g ˆ n 1 k d g ˆ n 2 k β 1 χ c ˆ a k t considering the initial point source condition c a x 0 δ x c ˆ a k 0 1 the solution of eq 17 in the fourier space is 18 c ˆ a k t exp v g ˆ n 1 k d g ˆ n 2 k β 1 χ t finally taking the inverse fourier transform of eq 18 the solution of the pd model 12 in the time domain obtains 19 c a x t f 1 exp v g ˆ n 1 k d g ˆ n 2 k β 1 χ t where f 1 denotes the inverse fourier transform eq 19 represents the semi analytical solution of the pd model incorporating the deep burial process which can be calculated by using the numerical algorithm of the inverse fourier transform 4 2 impacts of influence domain and weight function on pd model local bedload transport typically encompasses sediment movements that are relatively simple and can be characterized in terms of the local conditions at a given position x conversely nonlocal transports involve sediment motions that are sufficiently large requiring the functional relationship of the movements to upslope or and downslope conditions that may differ from those local conditions at x unlike the fractional model which utilizes convolution integrals to weigh the effect of land surface conditions at all positions of x the weight function and the size of the influence domain in the pd model may be related to natural conditions in the pd model the influence domain h x can be viewed as an effective interaction distance or effective length scale the selection of the influence domain size for the pd model may depend on various factors such as the slope of the bed surface the grain size the gradation of bed sand particles and the characteristic length of the high flow belts additionally there are numerous potential choices for the weight function in the pd model and the choice can be arbitrary under some circumstances however a proper choice must take into consideration the physics of the problem either through numerical upscaling procedures or by theoretical homogenization of microstructural heterogeneity here the impacts of the influence domain and weight function on the pd model are investigated specifically the following equations and conditions are considered 20 c a x t t h x v g n 1 ξ d d g n 2 ξ c a x ξ t c a x t d ξ χ c a x t c s x t t χ c a x t c a x 0 0 c s x 0 0 c a x t x 0 m δ t c a x t x x e n d 0 the results presented in figs 4 a and b demonstrate the effect of the size of the influence domain on the spatial distribution of bedload sediment at two different instants in the simulations the circular influence domain h x with radius δ m δ x is applied here the simulation results show that the snapshots become increasingly dispersed as the size of h x a larger influence domain corresponds to an extended effective interaction distance in bedload transport which leads to the early arrival of bedload particles at downstream locations as depicted in fig 3 it is consistent with experimental observations of the nonlocal bedload movement along flow accelerating belts sun et al 2015 zhang et al 2016 additionally for a larger influence domain h x δ 20 δ x the snapshot of bedload sediment in the active layer c a x t exhibits a leftward deviation indicating an asymmetric characteristic of the transport system this asymmetry is a result of boundary effects where the number of asymmetric family points in space increases with h x the weight function in the pd model represented by w ξ in eq 8 plays a crucial role in determining the influence magnitude of all family points the weight function can take on various forms such as gaussian power law or even a constant as discussed in the literature by madenci et al 2019 as illustrated in figs 4 c and d the snapshots of bedload sediment are shown with two different weight functions namely a power law weight function w ξ δ 4 ξ 4 and a gaussian weight function w ξ exp ξ 2 δ 2 the results from the snapshots of sediment particles as depicted in fig 4 d demonstrate that the power law weight function with a large influence domain can capture a stronger nonlocal transport behavior in the pd model this is primarily attributed to the fact that the power law functions exhibit a slower rate of decay as compared to the exponential functions particularly on larger spatial scales the slower decay rate of the weight function implies that distant spatial points can exert a greater impact resulting in stronger nonlocal transport behavior in the pd model in addition the results of the gaussian weight function together with a small influence domain agree well with local model as depicted in fig 4 c this highlights the role of the weight function and influence domain in describing the nonlocal transport behavior of bedload sediments in the pd model in the simulations presented above a symmetric weight function was used meaning that the left and right family points have equal weight on the target points and any asymmetric properties are a result of asymmetric family points given that water flow is the primary driving force behind bedload transport it is reasonable to assume that the contribution of upstream locations to the nonlocal effects at a given observation site is greater in comparison to that of downstream locations asymmetric nonlocal transport processes should be considered in the pd model asymmetric snapshots of bedload sediments are well documented in the literature both field and laboratory are included sayre and hubbell 1965 chang and yen 2002 martin et al 2012 foufoula georgiou et al 2010 investigated the nonlocal sediment transport on hillslopes by using the one shift grünwald expansion which is a typically asymmetric fractional operator meerschaert and tadjeran 2004 voller et al 2012 suggested that information flows downstream in an erosional landscape and upstream in depositional landscapes an asymmetric fractional operator was also tested in their study to gain a deeper understanding of the asymmetric properties in nonlocal bedload transport an asymmetric weight function employed in the pd model as follows 21 w ξ 1 β 2 f ξ for ξ 0 1 β 2 f ξ for ξ 0 β 1 1 where f ξ is the function of ξ which can be expressed in various forms the same as the weight function mentioned above β is a skewness parameter a skewness parameter β is introduced here which serves to quantify the degree of asymmetry feature in the pd system the pd model can be classified based on the parameter β where β 1 0 corresponds to the right skewness β 0 1 corresponds to the left skewness and β 0 corresponds to the symmetric here the pd model with an asymmetric weight function f ξ δ 3 ξ 3 are simulated and an instantaneous source located at x 100 m is considered fig 5 demonstrates a striking difference between the snapshots of the symmetric and asymmetric systems specifically the snapshots of the asymmetric systems exhibit pronounced skewness features which contrasts the symmetric snapshots of the symmetric system these differences highlight the importance of considering the asymmetry in the pd system when investigating nonlocal bedload transport processes the skewness parameter β plays a crucial role in determining the nonlocal behavior of the bedload sediments and the overall dynamics of the system the influence domain and weight function together provide a comprehensive characterization of the nonlocal bedload transport in the pd system 5 applications this section checks the feasibility of the pd model in quantifying nonlocal bedload transport the experimental dataset was selected from our previous research sun et al 2015 li et al 2019 laboratory experiments were carried out in a 20 m 1 m 1 2 m length width and depth flume which was filled with mixed size sediments of various diameters including 0 45 mm 1 mm 3 mm 7 mm and 17 mm as shown in fig 7 the grain size distribution gsd of the experiments is shown in fig 6 flume experiments were conducted to explore the dynamics of bedload transport under low shields stress i e partial transport the initial channel bed slope was set at 0 004 a bedload feeder was placed at the upstream of the flume which provided a uniform sediment input over the channel width the moving grains were collected by a trap located at the outlet of the flume which was weighed at 15 minute intervals and then reloaded at the inlet the inflow discharge measured by an electromagnetic flow meter varied from 120 l s to 140 l s the froude number was less than 1 ranging from 0 63 to 0 65 indicating that the flow is subcritical the second step in the experiment involved tracking the movement of tracer particles after determining the mass proportions for each size of mixed sand from the fed sediment a new blend of grains was continuously instantaneously fed into the inlet rather than recirculated this new blend of grains was fed with same size proportion as the last trapped sediment from the first step with the exception that the tracer particles of the prescribed size were replaced by colored particles for each experimental run as depicted in fig 7 the final step was to collect and quantify the number density of the tracer particles in order to generate a snapshot i e spatial distribution of the colored sand on the bed surface digital images were taken for each sub reach with a length of 0 8 m and a width of 1 m and the number of tracer particles with a finer resolution of 0 1 m in length and 1 m in width were analyzed using imagej an image processing software the experimental results provided evidence for the existence of nonlocal bedload transport processes in the mixed size gravel beds larger particles tend to aggregate into clusters due to their inability to resist hydraulic forces individually this results in the formation of micro relief within the armor layer such as the formation of clusters and the presence of flow accelerating belts between these clusters bedload sediments that were previously trapped by broken down clusters may experience a sudden release and travel a considerable distance along these flow accelerating belts until they are recaptured by other clusters leading to non local bedload transport behavior the simulation results also indicated that the nonlocal properties of bedload transport are sensitive to the sediment size as reported in the literature sun et al 2015 zhang et al 2016 li et al 2019 since the experiments were conducted under conditions of low shields stress i e partial transport tracer particles captured by the substrate layer are difficult to re entrain during the movement hence the deep burial process between the active layer and substrate layer is applied in the simulations in our simulations a circular influence domain with radius δ m δ x and a power law weight function w ξ δ 3 ξ 3 are chosen the power law weight function is herein considered to be a good approximation of the nonlocal bedload transport process it has been commonly used in many studies foufoula georgiou et al 2010 furbish and roering 2013 sun et al 2015 the deep burial process as well as the initial and boundary conditions for the pd model are presented below 22 c a x t t h x v g n 1 ξ d d g n 2 ξ c a x ξ t c a x t d ξ χ c a x t c s x t t χ c a x t c a x 0 0 c s x 0 0 c a x t x 0 m 1 continuous c a x t x 0 m δ t instantaneous c a x t x x 20 m 0 5 1 case 1 bedload transport with a continuous source first the experimental data of two different sediment sizes 1 mm and 3 mm with a continuous source were selected for each set snapshots were recorded at two different observation times 1 mm 155 min and 355 min 3 mm 270 min and 430 min during the experiments the results shown in figs 8 and 9 demonstrate that the pd model 12 is able to capture the spatial distribution of sediment particles and its temporal evolution as well as the skewness of the system the local model 2 and the global model 3 are also presented for comparison and the optimal parameters of the three models for the experiments are listed in tab 1 the parameter m reflects the regional scale of nonlocality in bedload transport the parameter m increases with a decrease of sediment size the fine sediments 1 mm show near the global behavior δ 80 δ x while the coarse sediments 3 mm show near local behavior δ 6 δ x during the movement this difference indicates that the fine bedload sediments have a stronger nonlocal movement behavior than the coarse sediments under continuous sediment feeding which is consistent with our previous study sun et al 2015 compared to the local model 2 and the global model 3 the pd model 12 is able to capture the snapshots for both early time and late time for each set by adjusting the influence domain in contrast the local and global models deviate from the experimental data at some observation times such as the local model for 1 mm 155 min and the global model for 3 mm 270 min in addition we also noted that the snapshots predicted by the pd model for the coarse particles 3 mm is worse than that for the fine particles 1 mm this difference may be due to the following two aspects i the influence of particle size cannot be completely captured by the employed pd model ii large particles moving intermittently on the heterogeneous bed surface can therefore experience a bi modal transport nonlocal transport and long resting state and the long resting process that cannot be efficiently characterized by the traditional deep burial process temporal non locality should be considered in future models as discussed in the literature zhang et al 2014 2016 5 2 case 2 bedload transport with an instantaneous source the experimental data presented in fig 10 depicted as black circles shows the transport characteristics of bedload sediments under the instantaneous source condition specifically for four different sediment sizes 1 mm 3 mm 7 mm and a mixture of 1 mm 3 mm 7 mm the data demonstrates a heavy tailed and asymmetric distribution indicative of nonlocal transport behavior during bedload transport furthermore the data shows that as the sediment grain size increases the trailing edge of the snapshot becomes heavier indicating that the nonlocal transport behavior is enhanced with increasing sediment size under the instantaneous condition fig 10 presents the best fitting results of the three different models the local model 2 the global model 3 and the pd model 12 respectively the influence domain increasing in size as the sediment size increases the fitting results also indicate that the local model is unable to capture the heavy tailed behavior observed in the data for all four sediment sizes the global model tended to over estimate the trailing edge of the snapshots in contrast the pd model is able to reproduce the heavy tailed and the asymmetric characteristics for all four sediment sizes with particularly good results for the mixed size set this suggests that the pd model is an effective tool for modeling the nonlocal transport behavior of bedload sediments under the instantaneous source conditions additionally the parameter β 0 5 for both continuous and instantaneous sources illustrates the significant asymmetry features in the bedload transport system which cannot be ignored when describing the nonlocal bedload transport we suppose that the parameter β may be related to the flow conditions the flow conditions with higher sediment discharge could produce a larger β the results of the applications demonstrate that the nonlocal properties of bedload sediment vary greatly depending on both the sediment size and the source conditions the pd model as a more flexible tool is able to effectively capture this complexity and accurately describe the nonlocal transport behavior of bedload sediment under various conditions pd model provides a novel tool to characterize bedload transport from local to global scales overall the integration of the pd model into the study of bedload transport expands the field s analytical capabilities and improves our understanding of the nonlocal bedload transport processes the results of the present study demonstrate that the snapshots of bedload sediments can partially provide information on nonlocal transports the strength of nonlocal properties in bedload transport increases with the decay rate of snapshot tail decreases resulting in an expansion of the influence domain in the pd model as observed in figs 8 9 and 10 however determining an appropriate size for the influence domain in the context of bedload transport remains a great challenge despite the extensive research that has been conducted in the field of solid mechanics seleson and parks 2011 madenci et al 2019 shojaei et al 2019 bekar et al 2022 further investigations in the field of sediment transport are needed to fully understand the implications of the nonlocal models for bedload transport and to develop strategies for selecting an appropriate size for the influence domain in the pd model 6 discussion 6 1 diffusion regime of the pd model a standard tool to explore the stochastic motion of brownian tracers is the mean squared displacement msd of the tracers similar to brownian motion this subsection aims to evaluate the pd model by comparing the msd which is the criteria for diffusion states in quantifying nonlocal bedload transport the msd is herein defined as follows 23 r m s d t x t x t 2 d t γ msd tells us how far the bedload sediments can move away from their average position eq 23 gives that the diffusion regimes of the nonlocal bedload transport can be distinguished depending on the value of the exponent γ here γ 1 sub diffusion regime resulting from motion intermittency during the long rest and burial phases γ 1 normal diffusion and γ 1 super diffusion resulting from the spatial nonlocal movement of bedload sediment metzler and klafter 2000 gives that the local 2 and the global 3 models exhibit normal and super diffusion behavior in the case of χ 0 respectively here we investigate the diffusion regime of the pd model 12 with two different pd functions 6 1 1 exponential kernel of the pd function first the gaussian function is widely considered as a pd function g n 2 ξ sun et al 2022 as follows 24 g n 2 ξ exp 4 δ 2 ξ 2 taking the fourier transform of g n 2 ξ for eq 24 yields the deep burial process is taken into account in the current analysis 25 g ˆ n 2 k π a e k 2 4 a where a 4 δ 2 and β 1 d π a the msd can be derived by the formula r m s d t lim k 0 2 k 2 c ˆ k t in the case of c 0 26 c ˆ k t exp d π a e k 2 4 a d π a χ t and 27 r m s d d δ 3 π 16 e χ t t k e χ t t the msd of the pd model with an exponential pd function exhibits the same result as the local ade model 2 6 1 2 power law kernel of the pd function second the power law kernel of a pd function g n 2 ξ is considered here 28 g n 2 ξ a ξ 1 α where a is the normalized coefficient taking the fourier transform of eq 28 yields 29 g ˆ n 2 k 1 a k α where a a π γ 1 α s i n π α 2 for α 2 and β 1 d inserting eq 29 into the semi analytical solution 18 one obtains 30 c ˆ k t e χ t e a k α t considering that e a k α t is the characteristic function of the lévy distribution r m s d here a fractional moment is introduced to characterize the msd of eq 30 metzler and klafter 2000 and the msd can be written as 31 r m s d k e χ t t 2 α the msd of the pd model with a power law pd function exhibits the same result as the global fractional model 3 the msd for the exponential and power law pd functions are given by eqs 27 and 31 respectively the diffusion regime of the gaussian kernel is determined solely by the parameter χ with sub diffusion behavior increasing as χ increases and normal diffusion occurring when χ 0 the diffusion regime of the power law kernel however is influenced by both parameters χ and α fig 11 plots the msd of the exponential and the power law kernels for various values of χ highlighting the impact of the competition between χ and α on the diffusion regimes of bedload transport the results also demonstrate that the pd model can describe a variety of diffusion behaviors including sub super and normal diffusion the analysis of the msd in the pd model presented above demonstrates that the weight function plays a crucial role in controlling the diffusion regime of the model by tracking the trajectory of a set of tagged particles over a given period of time the diffusion regime of the particles can be ascertained and subsequently the weight function can be established 6 2 differences between the global and the pd models a comparison of eqs 4 and 6 reveals that the kernel function and the size of the influence domain are two primary distinctions between the pd operator and the fractional operator the kernel function of the pd operator can be adapted through various weight functions as illustrated in fig 12 the pd function can approximate the fractional kernel function when the weight function is power law however when the weight function is gaussian or constant the pd function diverges significantly from the fractional kernel function hence the ability to adapt the pd function through various weight functions enhances the flexibility and applicability of the pd model for characterizing nonlocal bedload transport processes as previously mentioned the pd model 12 can characterize the nonlocal bedload transport processes from local to global scales here the performance of these three different models is evaluated through the use of breakthrough curves btcs and snapshots as depicted in fig 13 fig 13 a plots the snapshots of the local model the global model and the pd model with an instantaneous source the results indicate that the snapshot of the global model is more dispersed than that of the local model with the results of the pd model lying in between the two models besides the snapshots of the pd model become increasingly dispersed with an increase in the size of the influence domain h x the results of the btcs shown in fig 13 b are consistent with the findings in fig 13 a thus the pd model s ability to capture the behavior between the local and global models makes it a valuable tool in understanding the complexity of nonlocal transport behavior of bedload sediment furthermore fig 13 also shows that the pd model with a large influence domain is still different from the fractional model 3 this difference is caused by the difference between the pd differential operator and the fractional laplacian operator here we investigate the difference between the pd differential operator and the fractional laplacian operator 4 we assume that the g n 2 ξ c 1 α ξ 1 α then we can computer their difference as 32 q 1 c x c 1 α r c x c x x x 1 α d x x δ x δ c x c x x x 1 α d x c 1 α x δ 1 x x 1 α d x x δ 1 x x 1 α d x c x c 1 α x δ c x x x d x x δ c x x x d x c 1 α α 2 δ α c x c 1 α x δ c x x x d x x δ c x x x d x where c 1 α 2 α 1 α γ 1 α 2 π n γ 1 α 2 eq 32 shows the discrepancy between the fractional laplacian operator and the pd differential operator we find that in the limiting case of α 2 the difference between the fractional laplacian operator and pd differential operator vanishes i e q 1 0 due to the constant c 1 α 0 on the other hand the convergence of the pd differential operator to the fractional laplacian operator as δ depends on the power α and it can degenerate rapidly for a small parameter α therefore the fractional model can be recognized as a specific case of the pd nonlocal models additionally the pd model offers a unique perspective on nonlocal processes by incorporating long range interactions which are not captured by traditional local models furthermore the ability to adapt the pd function and influence domain allows for a more comprehensive analysis of nonlocal phenomena taking into account both short range and long range interactions 6 3 limitations of this study in this study a novel regional based nonlocal bedload transport model utilizing the pd operator is proposed the pd model offers a more generalized representation of nonlocal bedload transport behavior compared to traditional fractional derivative models fdms by allowing adjustments to the influence domain and weight function the pd model bridges the gap between local and global models but its flexibility results in multiple parameters it depends on the selection of the influence domain and weight function in contrast to fdms that necessitate only one additional parameter the order of fractional derivative given that the bedload nonlocal transport behavior is influenced by various factors such as sediment particle size flow field state bed slope etc the selection of the influence domain and weight function might depend on these conditions this study constitutes a preliminary exploration of the nonlocal transport characteristics of bedload using the pd operator a significant challenge emerges in determining a transparent and quantitative relationship between the model parameters and the physical flow parameters due to limited practical knowledge and experience in this domain overall the proposed pd model holds promise for delivering a more accurate and comprehensive understanding of nonlocal bedload transport behavior nonetheless devising a robust and practical methodology for choosing suitable parameters is essential for the successful application of the model in real world scenarios consequently further research is required to examine the physics underpinning for the selection of influence domain and weight function within the pd model 7 conclusions the primary objective of this study was to quantify the nonlocal transport behavior of bedload sediment by proposing a novel nonlocal transport model the pd model the pd model was developed from the probabilistic exner based equation and the pd differential operator and is capable of characterizing nonlocal bedload transport behavior across a range of spatial scales from local to global two main conclusions can be drawn from this study first the pd model bridges the gap between local and fractional global models by utilizing various pre defined weight functions and influence domains as the influence domain decreases the pd model tends towards the local model whereas with a power law pd function and a global influence domain the pd model converges to the fractional global model the ability to adapt the weight function and influence domain allows for a more comprehensive analysis of nonlocal phenomena taking into account both short range and long range interactions it is particularly useful for understanding and modeling complex systems such as bedload transport where both local and nonlocal interactions are important second the msd analysis illustrates that the pd model can capture sub super and normal diffusion behaviors by utilizing different pd functions the asymmetric characteristics of the pd model can be characterized by an asymmetric weight function and even when the weight function is symmetric the asymmetric features of the pd model can still be observed near the boundary due to the asymmetry of family points the ability of the pd model to capture asymmetric characteristics is particularly valuable for the analysis of bedload transport as it allows for a more accurate representation of the nonlocal bedload transport behavior which is often characterized by asymmetric diffusion patterns additionally the model applications indicate that the pd model with an asymmetric weight function is capable of effectively describing the observed nonlocal transport behavior of bedload sediments credit authorship contribution statement zhipeng li conceptualization software formal analysis methodology software funding acquisition visualization writing original draft saiyu yuan investigation resources writing review editing hongwu tang supervision project administration funding acquisition writing review editing yantao zhu methodology visualization writing review editing hongguang sun conceptualization supervision funding acquisition resources project administration writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work was supported by the national key r d program of china 2022yfc3202602 the china postdoctoral science foundation china 2022m711024 the jiangsu funding program for excellent postdoctoral talent china 2022zb180 the fundamental research funds for the central universities china b210203044 b210202092 the postgraduate research practice innovation program of jiangsu province china kycx21 0456 the natural science foundation of jiangsu province china bk20190024 the authors would also like to thank professor dong chen for the flume experimental data provided in this study 
15,recent studies have emphasized the importance of nonlocal models in characterizing bedload transport in natural rivers particularly in mixed size gravel beds or steep hillslopes nonlocality denotes that a quantity flux at a specific location x is dependent on the conditions in the surrounding area as opposed to solely at the location itself this concept applies in bedload transport even in planar flumes where particles are entrained at an upstream position and travel a finite distance ultimately contributing nonlocally to the sediment flux however existing bedload transport models such as the advection diffusion equation ade or the fractional derivative equation fde models are inadequate in characterizing the nonlocal transport behavior of bedload at a regional scale large errors may arise from the lack of an accurate description of the nonlocal bedload transport processes at regional scales this study proposes a regional based nonlocal bedload transport model which is conceptualized from the probabilistic exner based equations and the peridynamic pd differential operator the pd model encapsulates the nonlocal motion of bedload sediments on the basis of the pd differential operator by utilizing a pre defined weight function and influence domain comparisons demonstrate that the pd model serves as a generalized tool connecting the local and the global models with different pd functions and influence domains its variability on kernel function and influence domain enable it conveniently describe sub super and normal diffusion behaviors of bedload transport keywords bedload transport nonlocal regional scale pd differential operator msd data availability data will be made available on request 1 introduction bedload transport along the riverbed plays an essential role in the field of hydrology and geology despite significant advancements made in recent decades modeling bedload transport in complex natural conditions such as mixed size gravel beds or steep hillslopes remains a challenge chien and wan 1999 cheng 2003 ancey et al 2008 stark et al 2009 foufoula georgiou et al 2010 sun et al 2015 khademishamami and nardin 2020 li et al 2021 there is growing evidence from both field and laboratory studies that bedload sediments can travel long distances during transport producing the nonlocal processes in bedload transport roering et al 1999 ancey et al 2008 stark et al 2009 foufoula georgiou et al 2010 tucker and bradley 2010 sun et al 2015 doane et al 2018 here the terminology nonlocal follows the definition given by cushman 1990 if the constitutive variable depends on what is happening at a point in space or a very small neighborhood of the point the variable is said to be local and derived from a local theory on the other hand if information is needed to define the constitutive variables from regions of space distinct from a neighborhood of the space point where evaluation of the variables is to be made then the theories and constitutive variables are said to be nonlocal in character efficient modeling of nonlocal bedload transport has garnered significant attention in recent years with the primary challenge being the development of a nonlocal model for the bedload transport that is applicable to a wide range of conditions stark et al 2009 foufoula georgiou et al 2010 zhang et al 2014 sun et al 2015 gonzález aguirre et al 2020 the distinction between the local and the nonlocal bedload transport models is well defined mathematically local models propose that the sediment flux can be described as a function of local conditions at a given point whereas nonlocal models suggest that distal conditions also contribute to the sediment flux at that point at early stage the ensemble averaged nonlocal bedload flux has been formulated by means of the probability density of the particle step length tsujimoto 1978 parker et al 2000 ganti et al 2010 pierce and hassan 2020 pierce et al 2022 investigated bedload transport from a stochastic dynamics perspective and expanded upon the nonlocal formulation to depict sediment flux as a stochastic process furthermore fractional derivative models fdms have been proposed as a promising tool for characterizing nonlocal bedload transport behavior by considering a heavy tailed dynamic where the probability density function for step length of bedload sediments declines as a power law decay which represents a global correlated nonlocality in space foufoula georgiou et al 2010 bradley et al 2010 sun et al 2015 zhang et al 2016 nevertheless it should be acknowledged that the nonlocal transport of bedload in natural rivers is typically confined to a specific spatial domain zhang et al 2012 doane et al 2018 and that the nonlocal processes must be confined within the boundaries of the area additionally a variety of nonlocal transport mechanisms with different length scales may contribute to the overall bedload transport and the fdms incorporating the heavy tailed dynamic may not be able to capture all these nonlocal transport processes the existing local and global models for bedload transport are unable to capture the regional scale nonlocal transport processes due to the mathematical definition of the local and the global operators this limitation hinders the ability of researchers to fully understand the nonlocal dynamics of bedload transport for example bar migration and morphodynamics of riverbed variation in this study we propose a regional based nonlocal bedload transport model that incorporates the peridynamic pd differential operator madenci et al 2016 and the probabilistic exner based equations parker et al 2000 ganti et al 2010 ancey 2010 pelosi et al 2014 wu et al 2019 the nonlocal characteristics of the pd model are incorporated within the pd differential operator by utilizing a pre defined weight function and influence domain the pd model provides an alternative tool for characterizing bedload transport behavior from local to global scales which bridges the local and global models the rest of this study is organized as follows in section 2 a comprehensive review of the local the fractional global models and the pd differential operator is presented in section 3 a novel pd nonlocal model is proposed this proposed model is then analyzed in depth in section 4 in section 5 we apply the pd model to analyze bedload transport in the mixed size gravel beds with different source conditions in section 6 the diffusion regimes of the pd model with different pd functions are discussed and a comparison between the pd differential operator and the fractional operator is provided conclusions are finally drawn in section 7 2 materials and methods 2 1 local and global models the practical movement state of bedload sediments can be characterized as a series of alternating processes of particle deposition and entrainment the simplest form of the exner equations represents the conservation of mass between the processes of entrainment and deposition is expressed as follows parker et al 2000 ganti et al 2010 furbish et al 2012 1 1 λ p η x t t e x t d x t d x t 0 e x r t p s r d r where λ p is the porosity of the riverbed η l denotes the mean bed elevation e x t l t and d x t l t are the volumes of particles entrained and deposited per unit area and per unit time respectively p s r denotes the probability density function pdf of step length eq 1 demonstrates that bedload transport behavior can be characterized by various probability density functions pdfs of sediment step length for a thin tailed pdf such that p s r decays exponentially as r eq 1 in conjunction with exchange processes between the active layer and the substrate layer as shown in fig 1 degenerates asymptotically to the classical local advection diffusion equation ade type of model pelosi et al 2014 wu et al 2019 2 c a x t t c s x t t v c a x t x d d 2 c a x t x 2 c s x t t g c a c s x t where c a x t is the nondimensionalized bedload sediment concentration in the active layer c s x t is the nondimensionalized concentration of bedload sediment captured in the substrate layer v represents the virtual velocity at which the centroid of the tracer population travels downstream d d is the diffusion coefficient g is an arbitrary operator that characterizes the exchange processes between the active layer and the substrate layer for a heavy tailed pdf such that p s r decays power law as r and the fractional global bedload transport model is obtained in the active layer pelosi et al 2014 3 c a x t t c s x t t v c a x t x d d δ α x 2 c a x t c s x t t g c a c s x t and δ α x 2 is the fractional laplacian an equivalent hypersingular integral definition of the fractional laplacian is given by samko et al 1993 4 δ α x 2 c a x t 2 α x 1 α x γ n α x 2 π n γ 1 α x 2 p v r n c a x t c a x t x x n α x d x where p v is the principal value of the integral and γ x denotes the gamma function the fractional model 3 utilizes a convolution operator to represent a global correlated nonlocality in characterizing bedload transport 2 2 peridynamic differential operator pd differential operator is built by madenci et al 2016 2019 a pd differential operator can be constructed by taking into account the taylor series expansion of multi variable scalar field f x f x ξ in an m dimensional space as 5 f x ξ f x n 1 1 n n 2 1 n n 1 n m 1 n n 1 n m 1 1 n 1 n 2 n m ξ 1 n 1 ξ 2 n 2 ξ m n m n 1 n 2 n m f x x 1 n 1 x 2 n 2 x m n m r n x where ξ x x with r n x representing the remainder assuming that the contribution of the remainder is negligible and utilizing the properties of orthogonal functions g n p 1 p 2 p m ξ a pd nonlocal expression for partial derivatives of any order is derived as follows 6 p 1 p 2 p m f x x 1 p 1 x 2 p 2 x m p m h x f x ξ f x g n p 1 p 2 p m ξ d v x in which p i represents the order of differentiation with respect to variable x i with i 1 m the pd functions g n p 1 p 2 p m ξ possess the orthogonality property of 7 1 n 1 n 2 n m h x ξ 1 n 1 ξ 2 n 2 ξ m n m g n p 1 p 2 p m ξ d v x δ n 1 p 1 δ n 2 p 2 δ n m p m in which n i 1 n the pd functions can be constructed as 8 g n p 1 p 2 p m ξ q 1 1 n q 2 1 n q 1 q m 1 n q 1 q m 1 a q 1 q 2 q m p 1 p 2 p m w ξ ξ 1 q 1 ξ 2 q 2 ξ m q m where w ξ is a nondimensional weight function that characterizes the degree of the interaction between the surrounding points in each family the unknown coefficient a q 1 q 2 q m p 1 p 2 p m can be determined from the solution of the following equation 9 q 1 1 n q 2 1 n q 1 q m 1 n q 1 q m 1 a n 1 n 2 n m q 1 q 2 q m a q 1 q 2 q m p 1 p 2 p m b q 1 q 2 q m p 1 p 2 p m in which q i 1 n the shape matrix is constructed as follows 10 a n 1 n 2 n m q 1 q 2 q m h x w ξ ξ 1 n 1 q 1 ξ 2 n 2 q 2 ξ m n m q m d v x and 11 b q 1 q 2 q m p 1 p 2 p m n 1 n 2 n m δ n 1 p 1 δ n 2 p 2 δ n m p m the primary distinction between fdms and the pd model originates from their respective mathematical underpinnings duo et al 2017 sun et al 2022 fdms rely on a global convolution operator while the pd model utilizes an integral operator consequently the extent of nonlocality constitutes another notable difference between these two model types fdms are designed to encapsulate global correlated nonlocality whereas the pd model aims to represent a constrained nonlocal region delineated by a finite influence domain additionally the kernel function in the pd model can be arbitrarily selected based on a given system s specific conditions while the kernel function in fdms is confined to a power law form as a result the capacity to select the size and shape symmetric or asymmetric of the influence domain as well as the adjustability of the weight function facilitates a more adaptable depiction of nonlocal transport behavior of bedload nevertheless despite its advantages the pd model is not devoid of challenges in contrast to the fdms which possess only one parameter i e the order of the fractional derivative the pd model contains multiple parameters that fluctuate depending on the choice of influence domain and influence function the selection of influence domain and weight function in the pd model remains a persistent challenge as it necessitates a fundamental comprehension of the underlying physics governing bedload nonlocal transport processes moreover the above derivation of the pd operator demonstrates that the pd function is determined collectively by the weight function and the influence domain in instances where the pd function cannot be derived analytically numerical computations for the pd model necessitate solving the pd function for every point within the influence domain consequently the computational cost escalates considerably as the influence domain expands in certain cases the computational cost is substantially reduced when the pd function can be acquired directly through analytical means gu et al 2019 becoming significantly lower than that of the global form of the fractional order model 3 model development recent works on the topic of bedload transport suggest the need to distinguish between local and nonlocal transport processes and have highlighted the crucial role of topography in the nonlocal bedload transport processes foufoula georgiou et al 2010 furbish and roering 2013 sun et al 2015 in highly heterogeneous hydrogeological media preferential flow paths such as spatial connectivity may form thereby allowing for the nonlocal movement of bedload sediments this can manifest as early arrivals of bedload transport and may deviate from the classical fick s law j c x and can be considered as a nonlocal flux as depicted in fig 2 the structures of the riverbed can lead to nonlocal transport processes of bedload sediments for instance the slope of the riverbed can result in particles being entrained at an upslope position and subsequently traveling a finite distance contributing nonlocally to the flux additionally the bedload sediments can be entrained by the water flow along the high flow belts of the riverbed resulting in the nonlocal transport processes the local and global models ade 2 and f ade 3 respectively are commonly used to characterize the transition densities of bedload transport however these two models may not always sufficient in characterizing the complexities of bedload transport processes particularly with regard to a finite spatial correlation as a result a novel model in characterizing the nonlocal transport behavior of bedload sediments at regional scales is proposed in the following subsection 3 1 a pd bedload transport model in this subsection we propose a pd bedload transport model in which the nonlocal movements are incorporated in the pd differential operator as follows 12 c a x t t c s x t t h x v g n 1 ξ d d g n 2 ξ c a x ξ t c a x t d ξ c s x t t g c a c s x t where g n 1 and g n 2 are the pd functions madenci et al 2016 which can be determined according to the methods outlined in section 2 2 fig 3 shows the difference between the local and the regional scale transport models the movement of bedload sediments is governed by the regional scale transport model resulting in early arrivals i e the tracer sediments can be observed earlier downstream in the context of the pd model the influence domain h x and weight function w ξ are two crucial indicators for quantifying nonlocal properties of bedload transport each point x i has a set of associated family points within h x and only interacts with these family points x f 1 x f 2 by adjusting the pre defined influence domain and weight function the pd model 12 can be used to capture the bedload transport behavior in a wide range of conditions from local to global scales effectively bridging the local 2 and the global 3 models due to the diversity of weight functions and influence domains in the pd model investigating the well posedness of the pd operator for transport problems is an important and ongoing research endeavor in the field of nonlocal mechanics as discussed in the literature du 2016 tao et al 2017 4 model analysis 4 1 semi analytical solution of the pd model the general form c a x t of the pd model 12 with a deep burial processes is expressed as 13 c a x t t h x v g n 1 ξ d g n 2 ξ c a x ξ t c a x t d ξ χ c a x t where χ 1 t is the scaled burial frequency since g n 1 ξ and g n 2 ξ are zero outside h x one obtains 14 c a x t t v g n 1 c a x t d g n 2 c a x t β 1 χ c a x t where denotes the convolution operator g n p c x t r g n p ξ c x ξ t d ξ and 15 β 1 h x v g n 1 ξ d g n 2 ξ d ξ taking the fourier transform of eq 14 yields 16 c ˆ a k t t v g ˆ n 1 k c ˆ a k t d g ˆ n 2 k c ˆ a k t β 1 χ c ˆ a k t where k is the fourier variable collating eq 16 yields 17 c ˆ a k t t v g ˆ n 1 k d g ˆ n 2 k β 1 χ c ˆ a k t considering the initial point source condition c a x 0 δ x c ˆ a k 0 1 the solution of eq 17 in the fourier space is 18 c ˆ a k t exp v g ˆ n 1 k d g ˆ n 2 k β 1 χ t finally taking the inverse fourier transform of eq 18 the solution of the pd model 12 in the time domain obtains 19 c a x t f 1 exp v g ˆ n 1 k d g ˆ n 2 k β 1 χ t where f 1 denotes the inverse fourier transform eq 19 represents the semi analytical solution of the pd model incorporating the deep burial process which can be calculated by using the numerical algorithm of the inverse fourier transform 4 2 impacts of influence domain and weight function on pd model local bedload transport typically encompasses sediment movements that are relatively simple and can be characterized in terms of the local conditions at a given position x conversely nonlocal transports involve sediment motions that are sufficiently large requiring the functional relationship of the movements to upslope or and downslope conditions that may differ from those local conditions at x unlike the fractional model which utilizes convolution integrals to weigh the effect of land surface conditions at all positions of x the weight function and the size of the influence domain in the pd model may be related to natural conditions in the pd model the influence domain h x can be viewed as an effective interaction distance or effective length scale the selection of the influence domain size for the pd model may depend on various factors such as the slope of the bed surface the grain size the gradation of bed sand particles and the characteristic length of the high flow belts additionally there are numerous potential choices for the weight function in the pd model and the choice can be arbitrary under some circumstances however a proper choice must take into consideration the physics of the problem either through numerical upscaling procedures or by theoretical homogenization of microstructural heterogeneity here the impacts of the influence domain and weight function on the pd model are investigated specifically the following equations and conditions are considered 20 c a x t t h x v g n 1 ξ d d g n 2 ξ c a x ξ t c a x t d ξ χ c a x t c s x t t χ c a x t c a x 0 0 c s x 0 0 c a x t x 0 m δ t c a x t x x e n d 0 the results presented in figs 4 a and b demonstrate the effect of the size of the influence domain on the spatial distribution of bedload sediment at two different instants in the simulations the circular influence domain h x with radius δ m δ x is applied here the simulation results show that the snapshots become increasingly dispersed as the size of h x a larger influence domain corresponds to an extended effective interaction distance in bedload transport which leads to the early arrival of bedload particles at downstream locations as depicted in fig 3 it is consistent with experimental observations of the nonlocal bedload movement along flow accelerating belts sun et al 2015 zhang et al 2016 additionally for a larger influence domain h x δ 20 δ x the snapshot of bedload sediment in the active layer c a x t exhibits a leftward deviation indicating an asymmetric characteristic of the transport system this asymmetry is a result of boundary effects where the number of asymmetric family points in space increases with h x the weight function in the pd model represented by w ξ in eq 8 plays a crucial role in determining the influence magnitude of all family points the weight function can take on various forms such as gaussian power law or even a constant as discussed in the literature by madenci et al 2019 as illustrated in figs 4 c and d the snapshots of bedload sediment are shown with two different weight functions namely a power law weight function w ξ δ 4 ξ 4 and a gaussian weight function w ξ exp ξ 2 δ 2 the results from the snapshots of sediment particles as depicted in fig 4 d demonstrate that the power law weight function with a large influence domain can capture a stronger nonlocal transport behavior in the pd model this is primarily attributed to the fact that the power law functions exhibit a slower rate of decay as compared to the exponential functions particularly on larger spatial scales the slower decay rate of the weight function implies that distant spatial points can exert a greater impact resulting in stronger nonlocal transport behavior in the pd model in addition the results of the gaussian weight function together with a small influence domain agree well with local model as depicted in fig 4 c this highlights the role of the weight function and influence domain in describing the nonlocal transport behavior of bedload sediments in the pd model in the simulations presented above a symmetric weight function was used meaning that the left and right family points have equal weight on the target points and any asymmetric properties are a result of asymmetric family points given that water flow is the primary driving force behind bedload transport it is reasonable to assume that the contribution of upstream locations to the nonlocal effects at a given observation site is greater in comparison to that of downstream locations asymmetric nonlocal transport processes should be considered in the pd model asymmetric snapshots of bedload sediments are well documented in the literature both field and laboratory are included sayre and hubbell 1965 chang and yen 2002 martin et al 2012 foufoula georgiou et al 2010 investigated the nonlocal sediment transport on hillslopes by using the one shift grünwald expansion which is a typically asymmetric fractional operator meerschaert and tadjeran 2004 voller et al 2012 suggested that information flows downstream in an erosional landscape and upstream in depositional landscapes an asymmetric fractional operator was also tested in their study to gain a deeper understanding of the asymmetric properties in nonlocal bedload transport an asymmetric weight function employed in the pd model as follows 21 w ξ 1 β 2 f ξ for ξ 0 1 β 2 f ξ for ξ 0 β 1 1 where f ξ is the function of ξ which can be expressed in various forms the same as the weight function mentioned above β is a skewness parameter a skewness parameter β is introduced here which serves to quantify the degree of asymmetry feature in the pd system the pd model can be classified based on the parameter β where β 1 0 corresponds to the right skewness β 0 1 corresponds to the left skewness and β 0 corresponds to the symmetric here the pd model with an asymmetric weight function f ξ δ 3 ξ 3 are simulated and an instantaneous source located at x 100 m is considered fig 5 demonstrates a striking difference between the snapshots of the symmetric and asymmetric systems specifically the snapshots of the asymmetric systems exhibit pronounced skewness features which contrasts the symmetric snapshots of the symmetric system these differences highlight the importance of considering the asymmetry in the pd system when investigating nonlocal bedload transport processes the skewness parameter β plays a crucial role in determining the nonlocal behavior of the bedload sediments and the overall dynamics of the system the influence domain and weight function together provide a comprehensive characterization of the nonlocal bedload transport in the pd system 5 applications this section checks the feasibility of the pd model in quantifying nonlocal bedload transport the experimental dataset was selected from our previous research sun et al 2015 li et al 2019 laboratory experiments were carried out in a 20 m 1 m 1 2 m length width and depth flume which was filled with mixed size sediments of various diameters including 0 45 mm 1 mm 3 mm 7 mm and 17 mm as shown in fig 7 the grain size distribution gsd of the experiments is shown in fig 6 flume experiments were conducted to explore the dynamics of bedload transport under low shields stress i e partial transport the initial channel bed slope was set at 0 004 a bedload feeder was placed at the upstream of the flume which provided a uniform sediment input over the channel width the moving grains were collected by a trap located at the outlet of the flume which was weighed at 15 minute intervals and then reloaded at the inlet the inflow discharge measured by an electromagnetic flow meter varied from 120 l s to 140 l s the froude number was less than 1 ranging from 0 63 to 0 65 indicating that the flow is subcritical the second step in the experiment involved tracking the movement of tracer particles after determining the mass proportions for each size of mixed sand from the fed sediment a new blend of grains was continuously instantaneously fed into the inlet rather than recirculated this new blend of grains was fed with same size proportion as the last trapped sediment from the first step with the exception that the tracer particles of the prescribed size were replaced by colored particles for each experimental run as depicted in fig 7 the final step was to collect and quantify the number density of the tracer particles in order to generate a snapshot i e spatial distribution of the colored sand on the bed surface digital images were taken for each sub reach with a length of 0 8 m and a width of 1 m and the number of tracer particles with a finer resolution of 0 1 m in length and 1 m in width were analyzed using imagej an image processing software the experimental results provided evidence for the existence of nonlocal bedload transport processes in the mixed size gravel beds larger particles tend to aggregate into clusters due to their inability to resist hydraulic forces individually this results in the formation of micro relief within the armor layer such as the formation of clusters and the presence of flow accelerating belts between these clusters bedload sediments that were previously trapped by broken down clusters may experience a sudden release and travel a considerable distance along these flow accelerating belts until they are recaptured by other clusters leading to non local bedload transport behavior the simulation results also indicated that the nonlocal properties of bedload transport are sensitive to the sediment size as reported in the literature sun et al 2015 zhang et al 2016 li et al 2019 since the experiments were conducted under conditions of low shields stress i e partial transport tracer particles captured by the substrate layer are difficult to re entrain during the movement hence the deep burial process between the active layer and substrate layer is applied in the simulations in our simulations a circular influence domain with radius δ m δ x and a power law weight function w ξ δ 3 ξ 3 are chosen the power law weight function is herein considered to be a good approximation of the nonlocal bedload transport process it has been commonly used in many studies foufoula georgiou et al 2010 furbish and roering 2013 sun et al 2015 the deep burial process as well as the initial and boundary conditions for the pd model are presented below 22 c a x t t h x v g n 1 ξ d d g n 2 ξ c a x ξ t c a x t d ξ χ c a x t c s x t t χ c a x t c a x 0 0 c s x 0 0 c a x t x 0 m 1 continuous c a x t x 0 m δ t instantaneous c a x t x x 20 m 0 5 1 case 1 bedload transport with a continuous source first the experimental data of two different sediment sizes 1 mm and 3 mm with a continuous source were selected for each set snapshots were recorded at two different observation times 1 mm 155 min and 355 min 3 mm 270 min and 430 min during the experiments the results shown in figs 8 and 9 demonstrate that the pd model 12 is able to capture the spatial distribution of sediment particles and its temporal evolution as well as the skewness of the system the local model 2 and the global model 3 are also presented for comparison and the optimal parameters of the three models for the experiments are listed in tab 1 the parameter m reflects the regional scale of nonlocality in bedload transport the parameter m increases with a decrease of sediment size the fine sediments 1 mm show near the global behavior δ 80 δ x while the coarse sediments 3 mm show near local behavior δ 6 δ x during the movement this difference indicates that the fine bedload sediments have a stronger nonlocal movement behavior than the coarse sediments under continuous sediment feeding which is consistent with our previous study sun et al 2015 compared to the local model 2 and the global model 3 the pd model 12 is able to capture the snapshots for both early time and late time for each set by adjusting the influence domain in contrast the local and global models deviate from the experimental data at some observation times such as the local model for 1 mm 155 min and the global model for 3 mm 270 min in addition we also noted that the snapshots predicted by the pd model for the coarse particles 3 mm is worse than that for the fine particles 1 mm this difference may be due to the following two aspects i the influence of particle size cannot be completely captured by the employed pd model ii large particles moving intermittently on the heterogeneous bed surface can therefore experience a bi modal transport nonlocal transport and long resting state and the long resting process that cannot be efficiently characterized by the traditional deep burial process temporal non locality should be considered in future models as discussed in the literature zhang et al 2014 2016 5 2 case 2 bedload transport with an instantaneous source the experimental data presented in fig 10 depicted as black circles shows the transport characteristics of bedload sediments under the instantaneous source condition specifically for four different sediment sizes 1 mm 3 mm 7 mm and a mixture of 1 mm 3 mm 7 mm the data demonstrates a heavy tailed and asymmetric distribution indicative of nonlocal transport behavior during bedload transport furthermore the data shows that as the sediment grain size increases the trailing edge of the snapshot becomes heavier indicating that the nonlocal transport behavior is enhanced with increasing sediment size under the instantaneous condition fig 10 presents the best fitting results of the three different models the local model 2 the global model 3 and the pd model 12 respectively the influence domain increasing in size as the sediment size increases the fitting results also indicate that the local model is unable to capture the heavy tailed behavior observed in the data for all four sediment sizes the global model tended to over estimate the trailing edge of the snapshots in contrast the pd model is able to reproduce the heavy tailed and the asymmetric characteristics for all four sediment sizes with particularly good results for the mixed size set this suggests that the pd model is an effective tool for modeling the nonlocal transport behavior of bedload sediments under the instantaneous source conditions additionally the parameter β 0 5 for both continuous and instantaneous sources illustrates the significant asymmetry features in the bedload transport system which cannot be ignored when describing the nonlocal bedload transport we suppose that the parameter β may be related to the flow conditions the flow conditions with higher sediment discharge could produce a larger β the results of the applications demonstrate that the nonlocal properties of bedload sediment vary greatly depending on both the sediment size and the source conditions the pd model as a more flexible tool is able to effectively capture this complexity and accurately describe the nonlocal transport behavior of bedload sediment under various conditions pd model provides a novel tool to characterize bedload transport from local to global scales overall the integration of the pd model into the study of bedload transport expands the field s analytical capabilities and improves our understanding of the nonlocal bedload transport processes the results of the present study demonstrate that the snapshots of bedload sediments can partially provide information on nonlocal transports the strength of nonlocal properties in bedload transport increases with the decay rate of snapshot tail decreases resulting in an expansion of the influence domain in the pd model as observed in figs 8 9 and 10 however determining an appropriate size for the influence domain in the context of bedload transport remains a great challenge despite the extensive research that has been conducted in the field of solid mechanics seleson and parks 2011 madenci et al 2019 shojaei et al 2019 bekar et al 2022 further investigations in the field of sediment transport are needed to fully understand the implications of the nonlocal models for bedload transport and to develop strategies for selecting an appropriate size for the influence domain in the pd model 6 discussion 6 1 diffusion regime of the pd model a standard tool to explore the stochastic motion of brownian tracers is the mean squared displacement msd of the tracers similar to brownian motion this subsection aims to evaluate the pd model by comparing the msd which is the criteria for diffusion states in quantifying nonlocal bedload transport the msd is herein defined as follows 23 r m s d t x t x t 2 d t γ msd tells us how far the bedload sediments can move away from their average position eq 23 gives that the diffusion regimes of the nonlocal bedload transport can be distinguished depending on the value of the exponent γ here γ 1 sub diffusion regime resulting from motion intermittency during the long rest and burial phases γ 1 normal diffusion and γ 1 super diffusion resulting from the spatial nonlocal movement of bedload sediment metzler and klafter 2000 gives that the local 2 and the global 3 models exhibit normal and super diffusion behavior in the case of χ 0 respectively here we investigate the diffusion regime of the pd model 12 with two different pd functions 6 1 1 exponential kernel of the pd function first the gaussian function is widely considered as a pd function g n 2 ξ sun et al 2022 as follows 24 g n 2 ξ exp 4 δ 2 ξ 2 taking the fourier transform of g n 2 ξ for eq 24 yields the deep burial process is taken into account in the current analysis 25 g ˆ n 2 k π a e k 2 4 a where a 4 δ 2 and β 1 d π a the msd can be derived by the formula r m s d t lim k 0 2 k 2 c ˆ k t in the case of c 0 26 c ˆ k t exp d π a e k 2 4 a d π a χ t and 27 r m s d d δ 3 π 16 e χ t t k e χ t t the msd of the pd model with an exponential pd function exhibits the same result as the local ade model 2 6 1 2 power law kernel of the pd function second the power law kernel of a pd function g n 2 ξ is considered here 28 g n 2 ξ a ξ 1 α where a is the normalized coefficient taking the fourier transform of eq 28 yields 29 g ˆ n 2 k 1 a k α where a a π γ 1 α s i n π α 2 for α 2 and β 1 d inserting eq 29 into the semi analytical solution 18 one obtains 30 c ˆ k t e χ t e a k α t considering that e a k α t is the characteristic function of the lévy distribution r m s d here a fractional moment is introduced to characterize the msd of eq 30 metzler and klafter 2000 and the msd can be written as 31 r m s d k e χ t t 2 α the msd of the pd model with a power law pd function exhibits the same result as the global fractional model 3 the msd for the exponential and power law pd functions are given by eqs 27 and 31 respectively the diffusion regime of the gaussian kernel is determined solely by the parameter χ with sub diffusion behavior increasing as χ increases and normal diffusion occurring when χ 0 the diffusion regime of the power law kernel however is influenced by both parameters χ and α fig 11 plots the msd of the exponential and the power law kernels for various values of χ highlighting the impact of the competition between χ and α on the diffusion regimes of bedload transport the results also demonstrate that the pd model can describe a variety of diffusion behaviors including sub super and normal diffusion the analysis of the msd in the pd model presented above demonstrates that the weight function plays a crucial role in controlling the diffusion regime of the model by tracking the trajectory of a set of tagged particles over a given period of time the diffusion regime of the particles can be ascertained and subsequently the weight function can be established 6 2 differences between the global and the pd models a comparison of eqs 4 and 6 reveals that the kernel function and the size of the influence domain are two primary distinctions between the pd operator and the fractional operator the kernel function of the pd operator can be adapted through various weight functions as illustrated in fig 12 the pd function can approximate the fractional kernel function when the weight function is power law however when the weight function is gaussian or constant the pd function diverges significantly from the fractional kernel function hence the ability to adapt the pd function through various weight functions enhances the flexibility and applicability of the pd model for characterizing nonlocal bedload transport processes as previously mentioned the pd model 12 can characterize the nonlocal bedload transport processes from local to global scales here the performance of these three different models is evaluated through the use of breakthrough curves btcs and snapshots as depicted in fig 13 fig 13 a plots the snapshots of the local model the global model and the pd model with an instantaneous source the results indicate that the snapshot of the global model is more dispersed than that of the local model with the results of the pd model lying in between the two models besides the snapshots of the pd model become increasingly dispersed with an increase in the size of the influence domain h x the results of the btcs shown in fig 13 b are consistent with the findings in fig 13 a thus the pd model s ability to capture the behavior between the local and global models makes it a valuable tool in understanding the complexity of nonlocal transport behavior of bedload sediment furthermore fig 13 also shows that the pd model with a large influence domain is still different from the fractional model 3 this difference is caused by the difference between the pd differential operator and the fractional laplacian operator here we investigate the difference between the pd differential operator and the fractional laplacian operator 4 we assume that the g n 2 ξ c 1 α ξ 1 α then we can computer their difference as 32 q 1 c x c 1 α r c x c x x x 1 α d x x δ x δ c x c x x x 1 α d x c 1 α x δ 1 x x 1 α d x x δ 1 x x 1 α d x c x c 1 α x δ c x x x d x x δ c x x x d x c 1 α α 2 δ α c x c 1 α x δ c x x x d x x δ c x x x d x where c 1 α 2 α 1 α γ 1 α 2 π n γ 1 α 2 eq 32 shows the discrepancy between the fractional laplacian operator and the pd differential operator we find that in the limiting case of α 2 the difference between the fractional laplacian operator and pd differential operator vanishes i e q 1 0 due to the constant c 1 α 0 on the other hand the convergence of the pd differential operator to the fractional laplacian operator as δ depends on the power α and it can degenerate rapidly for a small parameter α therefore the fractional model can be recognized as a specific case of the pd nonlocal models additionally the pd model offers a unique perspective on nonlocal processes by incorporating long range interactions which are not captured by traditional local models furthermore the ability to adapt the pd function and influence domain allows for a more comprehensive analysis of nonlocal phenomena taking into account both short range and long range interactions 6 3 limitations of this study in this study a novel regional based nonlocal bedload transport model utilizing the pd operator is proposed the pd model offers a more generalized representation of nonlocal bedload transport behavior compared to traditional fractional derivative models fdms by allowing adjustments to the influence domain and weight function the pd model bridges the gap between local and global models but its flexibility results in multiple parameters it depends on the selection of the influence domain and weight function in contrast to fdms that necessitate only one additional parameter the order of fractional derivative given that the bedload nonlocal transport behavior is influenced by various factors such as sediment particle size flow field state bed slope etc the selection of the influence domain and weight function might depend on these conditions this study constitutes a preliminary exploration of the nonlocal transport characteristics of bedload using the pd operator a significant challenge emerges in determining a transparent and quantitative relationship between the model parameters and the physical flow parameters due to limited practical knowledge and experience in this domain overall the proposed pd model holds promise for delivering a more accurate and comprehensive understanding of nonlocal bedload transport behavior nonetheless devising a robust and practical methodology for choosing suitable parameters is essential for the successful application of the model in real world scenarios consequently further research is required to examine the physics underpinning for the selection of influence domain and weight function within the pd model 7 conclusions the primary objective of this study was to quantify the nonlocal transport behavior of bedload sediment by proposing a novel nonlocal transport model the pd model the pd model was developed from the probabilistic exner based equation and the pd differential operator and is capable of characterizing nonlocal bedload transport behavior across a range of spatial scales from local to global two main conclusions can be drawn from this study first the pd model bridges the gap between local and fractional global models by utilizing various pre defined weight functions and influence domains as the influence domain decreases the pd model tends towards the local model whereas with a power law pd function and a global influence domain the pd model converges to the fractional global model the ability to adapt the weight function and influence domain allows for a more comprehensive analysis of nonlocal phenomena taking into account both short range and long range interactions it is particularly useful for understanding and modeling complex systems such as bedload transport where both local and nonlocal interactions are important second the msd analysis illustrates that the pd model can capture sub super and normal diffusion behaviors by utilizing different pd functions the asymmetric characteristics of the pd model can be characterized by an asymmetric weight function and even when the weight function is symmetric the asymmetric features of the pd model can still be observed near the boundary due to the asymmetry of family points the ability of the pd model to capture asymmetric characteristics is particularly valuable for the analysis of bedload transport as it allows for a more accurate representation of the nonlocal bedload transport behavior which is often characterized by asymmetric diffusion patterns additionally the model applications indicate that the pd model with an asymmetric weight function is capable of effectively describing the observed nonlocal transport behavior of bedload sediments credit authorship contribution statement zhipeng li conceptualization software formal analysis methodology software funding acquisition visualization writing original draft saiyu yuan investigation resources writing review editing hongwu tang supervision project administration funding acquisition writing review editing yantao zhu methodology visualization writing review editing hongguang sun conceptualization supervision funding acquisition resources project administration writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work was supported by the national key r d program of china 2022yfc3202602 the china postdoctoral science foundation china 2022m711024 the jiangsu funding program for excellent postdoctoral talent china 2022zb180 the fundamental research funds for the central universities china b210203044 b210202092 the postgraduate research practice innovation program of jiangsu province china kycx21 0456 the natural science foundation of jiangsu province china bk20190024 the authors would also like to thank professor dong chen for the flume experimental data provided in this study 
16,knowledge of freezing thawing f t cycles of sulfate saline soil is crucial regarding the spatial temporal distribution of solutes in the soil soil salinization and cold region engineering in sulfate saline soil areas f t tests of saturated sulfate saline soils with different salt contents water supply conditions and the number of f t cycles were conducted the coupling mechanism of water and salt migration ice water phase change salt crystallization dissolution and deformation caused by salt expansion and frost heave of saturated sulfate saline soil during f t processes were analyzed a water heat salt mechanics coupling mathematical model for saturated sulfate saline soil under f t cycles is proposed using the modified salt crystallization dissolution kinetics model the results show that the calculated profiles of temperature water content concentration and soil displacement are in good agreement with the experimental data demonstrating that the proposed coupling model can describe the coupled water heat salt mechanics process of sulfate saline soil during f t processes additionally the modified salt crystallization dissolution kinetics model employing the frezchem model can theoretically reveal the processes of salt crystal growth and dissolution also the water and temperature potential gradients are the main driving force for water migrating toward the freezing front convection and diffusion are the dominant factors for the spatial temporal distribution of solutes of sulfate saline soil subjected to f t cycles causing salt accumulation and precipitation and forming subflorescence in the frozen and unfrozen layers near the freezing front and efflorescence in the soil surface layer at a certain number of f t cycles due to the blocking effect of salt accumulation and precipitation on water and salt migration salt expansion during freezing and residual deformation during thawing gradually stabilize with the increase of f t cycles keywords freezing thawing processes spatial temporal distribution of solute subflorescence and efflorescence water heat salt mechanics coupling soil salinization data availability data will be made available on request nomenclature r mean curvature radius m δsm fusion entropy of ice water j mol k s α saturation degree of α phase tc tf t 0 crystallization point and freezing point of saline soil and bulk water k ua u a start supersaturation and threshold value v α volume of α phase vmi molar volume of ice crystal mol m3 v α flow velocity of α phase m s θ α volumetric content of α phase m3 m3 θ w r θ w a residual unfrozen water and initial moisture content m3 m3 λ α thermal conductivity of α phase w m k ν0 molecules of water ρ α density of α phase kg m3 σ stress vector n m2 χα ration of α phase subscripts w unfrozen water s dissolve salt l pore solution i ice crystal c salt crystal wc crystal water 1 introduction knowledge of freezing thawing f t cycles of sulfate saline soil is crucial in terms of the spatial temporal distribution of solutes in the soil soil salinization and cold region engineering in sulfate saline soil areas hou et al 2019 2022 kurylyk and watanabe 2013 wu et al 2019 as a multiphase continuous porous medium composed of solid liquid and gas phases saline soil is widely distributed in the cold regions lai et al 2017 the f t cycles of sulfate saline soil involve the coupling effects of water and salt migration heat transfer ice water phase change salt crystallization dissolution and soil deformation the dynamic interaction in sulfate saline soil experiencing f t cycles is a significant issue concerning soil salinization building durability underground structures engineering and environmental sciences in cold regions castellazzi et al 2013 2016 choo and sun 2018 li et al 2015 tan et al 2011 zhang et al 2017 teng et al 2019 hassani et al 2020 therefore studying the water heat salt mechanics coupling mechanism of sulfate saline soil can provide a theoretical reference to investigate soil salinization and prevent the deformation of salt expansion and frost heave of sulfate saline soil under f t cycles generally salt exists in two phases in porous media dissolved salt and salt crystals water and salt crystallization of sulfate saline soil destroys soil structure and rearranges soil particles exposed to f t processes lai et al 2017 f t cycles have considerable effects on changes in pore structure konrad 1989 wang et al 2020 permeability qi et al 2006 teng et al 2023 soil temperature yadav and wang 2021 unfrozen water content yadav and wang 2017 freezing point wang et al 2019 and solute concentration stähli and stadler 1997 which are directly related to water and salt migration and redistribution at the same time f t cycles will cause changes in the mechanical properties of the soil xu et al 2020 2020a 2020b researchers have found that the alteration in the cohesion of silty soil undergoing the f t cycle is not simply a decrease but there is a critical dry bulk density and the cohesion change observed under this critical dry bulk density is not substantial qi et al 2006 2008 many researchers have used different laboratory methods to investigate water and salt migration and the characteristics of crystallization induced soil deformation exposed to f t cycles the f t process of sulfate saline soil involves a dynamic water heat salt mechanics interaction when a freezing temperature gradient forms in the sulfate saline soil heat transfer can cause water and solute migration during freezing sarsembayeva and collins 2017 rui et al 2019 the salinity in the frozen layer increased as water and salt migrated toward the frozen zone from the underlying beds zhang and wang 2001 wu et al 2018 the temperature variation can cause water freezes into ice and salt crystallization and precipitation bing et al 2015 wang et al 2016 wu et al 2016 meanwhile ice water phase change and salt crystallization will cause the enhancement of the heat transfer process caused by the latent heat leading to the deformation of salt expansion and frost heave caused by the effective stress change zhang et al 2020a during the thawing period the amount of solute transported towards the frozen zone during the freezing process is higher than that migrated downward during thawing resulting in salt accumulation above the frozen fringe wu et al 2018 the high salinity sulfate saline soil exhibits significant residual deformation compared to the low salinity soil zhang et al 2020b furthermore convection and diffusion are the leading factors in solute redistribution which causes salt accumulation above the freezing front and forms discontinuously distributed layered salt crystal zones hassanizadeh and leijns 1988 kadlec et al 1988 rui et al 2019 zhang et al 2020a liu et al 2021 as mentioned above the results preliminarily clarified the law of water and salt migration in saline soil exposed to f t cycles but cannot illustrate the formation mechanism of salt accumulation and residual deformation of sulfate saline soil subjected to f t cycles therefore it is necessary to reveal the water heat salt mechanics coupling mechanism of sulfate saline soils subjected to f t cycles scholars have established corresponding coupled models to analyze the dynamic interaction of sulfate saline soil exposed to f t cycles based on continuum mechanics theories thermodynamics and segregation potential moisture heat mechanics coupling models were proposed to analyze f t disasters of tunnels canals and permafrost embankments in cold regions nishimura et al 2009 tan et al 2011 li et al 2015 zhang et al 2017 huang et al 2022 the mentioned moisture heat mechanics coupling model can simulate the interaction of water heat and stress in a porous medium exposed to f t cycles however none of them considers the effect of the solute and cannot describe the deformation caused by salt expansion and dissolve settlement zhang et al 2020a with the understanding of water transport in the soils during f t cycles many scholars have initiated more in depth studies on water and salt migration and the deformation caused by salt expansion and frost heave including water heat salt coupling models nassar and horton 1992 nassar et al 1992 castellazzi et al 2013 2016 wu et al 2019 the chemo hydra mechanical coupling models koniorczyk 2012 choo and sun 2018 and the water heat salt mechanics semi coupling models based on kinetic model considering nucleation molecular diffusion and crystal growth lai et al 2017 zhang et al 2020a the disadvantage is that in many cases the moisture and temperature in the coupling model are still dominated by the traditional three field coupling ignoring the solute effect on heat and mass transfer zhang et al 2021 generally studies on the interactions between water and salt migration heat transfer salt crystallization dissolution ice water phase change and deformation caused by salt expansion and frost heave of sulfate saline soil subjected to f t cycles are limited therefore it is important to provide a novel water heat salt mechanics coupling model for sulfate saline soils exposed to f t processes in this study unidirectional f t experiments were conducted on saturated sulfate saline soil with different salt contents water supply conditions and numbers of f t cycles to study the water heat salt mechanics coupling processes based on the modified salt crystallization dissolution kinetics model a water heat salt mechanics coupling model for saturated sulfate saline soil exposed to f t cycles was developed considering the effects of ice water phase change and salt crystallization dissolution the main objectives of this study were to determine that 1 coupled mechanism of water and salt transport heat transfer ice water phase change salt crystallization dissolution and the deformation caused by salt expansion and frost heave of sulfate saline soil during f t cycles 2 spatial temporal distribution of solutes of sulfate saline soil under different experimental conditions of f t cycles and 3 feedback mechanism of the spatial temporal distribution of solutes on salt accumulation and soil salinization of sulfate saline soil during f t processes this study could effectively reduce soil salinization and protect engineering facilities in sulfate saline soil areas 2 test description 2 1 test material and design the tests were conducted in the f t test chamber of the xt5405b series at the state key laboratory of frozen soil engineering the experimental conditions of the samples are listed in table 1 desalinized silty clay was obtained from the qinghai tibet plateau fig 1 shows grain size distribution of the soil used in this study six samples with different salt contents were prepared and sealed for 24 h at room temperature 25 c for homogenization the specifically designed samples are shown in table 1 where s1 s2 s3 and s4 represent the samples with different initial salt contents and s5 and s6 represent the samples with different water supply conditions the prepared samples were cylinders with a diameter of 10 0 cm and a height of 15 0 cm after the vacuum saturation process the water content of the sample closes to 20 9 2 2 test apparatus the f t experimental apparatus for testing the samples is shown in fig 2 a sample container was positioned inside the test chamber to control the environmental temperature the top and bottom plates controlled the top and bottom temperatures of the samples respectively eight temperature sensors thermistor precision 0 05 c were instrumented at intervals of 2 0 cm and 0 5 cm above the bottom of the sample to monitor temperature variations one hydra probe ⅱ was instrumented at 10 0 cm above the bottom of the column to measure temperature changes precision 0 6 c moisture content precision 0 003 and electrical conductivity precision 0 0014 s m a calibration graph was generated by plotting the electrical conductivities of the salt solutions with known salt concentrations the solute concentration of the pore solution was estimated from a calibration graph based on the measured electrical conductivity a displacement sensor precision 0 01 mm was installed at the top of the column to monitor soil displacement insulation material with a thickness of 2 0 cm was installed around the sample container to prevent temperature defects the water supplement system consisted of a mariotee flash connected to the bottom plate through a plastic tube 2 3 experimental program the applied cyclic f t temperature tcycle at the top of the sample during f t cycles is 1 t cycle 8 19 sin 2 π 18 t c the soil samples were pre cooled in the test chamber at 8 0 c for 24 h allowing the sodium sulfate in the pores to dissolve completely and the samples temperature to remain uniform before the test subsequently the f t processes were started with the top temperature of the samples set to the cyclic temperature the bottom and test chamber temperatures were set to 4 0 c and kept constant during f t cycles a cr3000 device was employed to collect data at 5 min intervals at the end of the experiments the soil columns were divided into 15 parts with a thickness of 1 0 cm and the salt content was measured 3 results and analyses 3 1 effect of initial salt content on moisture content the cyclic changes in sample temperature lead to ice water phase transition and salt crystallization dissolution in the pores which are the main factors contributing to changes in volumetric unfrozen water content vwc vwc and temperature variations with time under conditions s1 and s3 are presented in fig 3 as shown in fig 3 a the dominant factors affecting the vwc change in the f t cycle for the non saline soil sample s1 were water migration freezing temperature pore radius and pore structure characteristic the vwc change of sample s1 in the first f t cycle can be divided into two stages the slowly lowering and the f t variation stages during the first stage the increase in freezing depth led to water migration from the underlying zone to the freezing zone resulting in a decrease in the vwc in the underlying zone the second stage was the f t variation stage the ice water phase change of non saline soil experiencing the f t cycle led to vwc variations as shown in fig 3 b for the saline soil sample s3 the effects of salinity and salt crystallization dissolution on vwc cannot be ignored the vwc change of sample s3 in the first f t cycle is different from that of sample s1 which can be divided into three stages a slowly lowering salt crystallization and ice water phase change and salt crystallization dissolution stages salt crystallization was the dominant factor for vwc decrease before freezing when the soil temperature is lower than the freezing temperature alternate ice water phase change and salt crystallization dissolution led to vwc changes the residual vwc of sample s3 was larger than that of sample s1 at the same minimum temperature the analysis shows that the water activity decreases with increasing solute concentration lowering the pore solution freezing temperature therefore it is necessary to consider the effect of the solute on the vwc variation of sulfate saline soil subjected to f t cycles 3 2 effect of initial salt content on solute concentration concentration and temperature variations with time under conditions s3 and s4 are shown in fig 4 from fig 4 a the concentration change of sample s3 at 10 0 cm in the first f t cycle can be divided into three stages steady lowering and rapid decrease or increase stages the concentration changed slightly prior to freezing the results showed that the primary salt crystallization temperature was higher than the freezing temperature the concentration showed an apparent decreasing trend caused by salt crystallization during the second stage the rapid decrease or increase stage is attributable to the effect of ice water phase change and salt crystallization dissolution on the pore solution concentration meanwhile the concentration of sample s3 increased gradually with increasing number of f t cycles fig 4 b illustrates that the concentration change of sample s4 at 10 0 cm in the first f t cycle can be divided into three stages slowly increasing stage slightly decreasing and salt crystallization dissolution stages the initial temperature of sample s4 was lower than the primary salt crystallization temperature when the temperature reached its peak value as shown in fig 4 b the concentration increased slightly resulting from the dissolution of the salt crystals during the second stage decrease in concentration was attributable to salt migration from the unfrozen zone towards the freezing zone before salt crystallization the monitoring position of the concentration of sample s4 was always in the unfrozen zone during f t cycles salt crystallization dissolution is the reason for the concentration variation in the pore solution meanwhile the concentration of the pore solution of sample s4 at the monitoring position showed an increasing trend during f t cycles the variation in the solute concentration of sulfate saline soil subjected to f t processes was similar to the results of previous studies lai et al 2017 wu et al 2018 zhang et al 2020a 3 3 effect of initial salt content on soil deformation fig 5 shows the soil sample displacement and residual deformation variations for different salt contents from fig 5 a the deformation is characterized by frost heave and thaw settlement during f t cycles of the non saline and low salinity samples s1 and s2 residual deformation is defined as the difference between the deformation within the nth f t cycle and the n 1 th f t cycle as shown in fig 5 b during f t cycles samples s1 and s2 residual deformations of showed a downward trend after reaching a negative peak in the third f t cycle and were always less than 0 this indicates that soil deformation characteristic of samples s1 and s2 was thawing settlement for samples s1 and s2 frost heave occurred owing to the increase in ice pressure caused by the transformation of pore water into ice during freezing thawing settlement appears owing to the disappearance of ice pressure in pores and the weakening of soil shear strength during thawing therefore for low salinity soil the ice pressure generated during the formation of ice crystals is the dominant factor in soil deformation therefore the formation and dissipation of ice pressure deterioration of soil pore structure and weakening of soil shear strength are the main factors of frost heave and thawing settlement of low salinity soil subjected to f t cycles the deformation is characterized by salt expansion and dissolution settlement during f t cycles of the high salinity samples s3 and s4 as shown in fig 5 b the residual deformations of samples s3 and s4 decreased with the number of f t cycles and were always greater than 0 the results reveal that the deformation of the high salinity samples shows a gradual increasing trend with an increase in the number of f t cycles ice and salt crystallization pressures aggravate salt expansion and frost heave during freezing meanwhile the pressure on the pore walls depends on the amount of ice and salt crystals therefore the salt expansion and residual deformation increase with increasing initial salt content 3 4 effects of water supply condition and number of f t cycles on soil deformation fig 6 presents soil sample displacement and residual deformation variations under different water supply conditions and number of f t cycles for samples s3 s5 and s6 the deformation characteristic of samples s3 and s5 was mainly salt expansion in contrast dissolution settlement was primarily the deformation characteristic of sample s6 in fig 6 b residual deformation represents the f t deformation characteristics of the soil with positive values indicating expansion and negative values indicating settlement for sample s5 the solute continuously migrated and accumulated in the freezing zone during f t cycles increasing the salt content above the freezing front therefore the residual deformation of sample s5 decreased with the number of f t cycles and tended to be stable in the 9th f t cycle however for sample s6 without water replenishment water and salt migrated from the unfrozen zone to the freezing zone during the freezing period resulting in a decrease in water and salt contents under the freezing front the residual deformation of sample s6 showed a downward trend after reaching a negative peak in the 6th f t cycle and tended to be stable in the 10th f t cycle the results indicate that the water supply condition substantially influences the deformation of sulfate saline soil 4 mathematical model the temperature unfrozen water content and solute concentration of sulfate saline soil change periodically owing to external temperature variations during f t cycles soil water potential is the driving force for water and solute migration from the unfrozen zone to the frozen zone during freezing water and salt crystallization causes soil deformation of salt expansion and frost heave moreover it changes the soil pore structure and reduces the permeability and solute diffusion coefficient additionally a larger amount of solute migrated upward during cooling than that transported downward during the thawing period in the pores causing salt accumulation in the frozen zone and residual deformation as shown in fig 7 saturated sulfate saline soil consists of solid soil particles ice crystals and salt crystals and liquid unfrozen water and dissolved salt phases the influence of the gas phase was not considered sodium sulfate is more destructive than other salts therefore only one type of salt and salt crystal mirabilite na2so4 10h2o was considered castellazzi et al 2013 koniorczyk 2012 zhang et al 2020b the f t cycles of sulfate saline soil involve the coupling effects of water and salt migration heat transfer ice water phase change salt crystallization dissolution and soil deformation the following assumptions were made to propose the coupled model 1 soil is an isotropic and homogeneous porous medium 2 the influence of water evaporation is ignored considering only the influence of released absorbed latent heat caused by ice water phase transition and salt crystallization dissolution on the temperature field 3 water and salt migrate in liquid form ignoring the movement of ice and salt crystals based on volume averaging theory hassanizadeh and gray 1979 sulfate saline soil is conceptualized as a multiphase porous medium in the following unfrozen water dissolved salt and pore solution are described by the subscripts w s and l respectively the soil particles ice crystal and salt crystals are denoted by the subscripts m i and c respectively c α is the mass of α phase per unit volume of the porous medium which can be defined as castellazzi et al 2013 2 c α n s α ρ α θ α ρ α where n is the porosity s α is the saturation degree of α phase α w s l m i c ρα is the density of α phase and θα is the volumetric content of α phase can be described as 3 θ α d v α d v where v is the volume of the porous media and v α is the volume of α phase the pore solution consists of unfrozen water and solute and the saturation of the pore solution sl is given by 4 s l s w s s the ratios of moisture and solute in the solution can be written as 5 χ w θ w θ l s w s l χ s θ s θ l s s s l the concentration of solute in the pore solution is given by 6 c χ s ρ s based on the volume averaging theory a water heat salt mechanics coupling model for saturated sulfate saline soil exposed to f t cycles was proposed including the mass energy and stress balance equations 4 1 mass conservation equation 4 1 1 moisture conservation equation the f t cycles of sulfate saline soil involve ice water phase change and salt crystallization dissolution which affect the equivalent volumetric moisture content θ eff and can be expressed as zhang et al 2020a 7 θ e f f θ w θ i θ w c where θ w is vwc θ i is the volumetric ice crystal content and θ wc is the volumetric crystal water content the dissolution of the na2so4 crystal and its formation can be expressed by the following general equation 8 n a 2 s o 4 ν 0 h 2 o 2 n a s o 4 2 ν 0 h 2 o where ν0 corresponds to the number of water molecules in the crystalline hydrate only one type of salt and salt crystal mirabilite na2so4 10h2o was considered so ν0 10 the volumetric crystal water content can be expressed as 9 θ w c 10 θ c m w m c ρ c ρ w where m α is the molar mass of α phase based on the concept of equivalent water content the moisture conservation equation can be established from the equation of linear momentum balance for the liquid and the mass balance equation of water which can be expressed as harlan 1973 lai et al 2014 nishimura et al 2009 10 ρ w θ w t ρ i θ i t t 10 m w m c θ c ρ c ρ w v w the equation of the linear momentum balance for moisture was given by nassar and horton 1992 nassar et al 1992 11 v w j w ρ w d θ w θ w d t t k θ w k where jw is the water flux d θ w is the isothermal liquid diffusivity dt is the thermal liquid diffusivity k θ w is the hydraulic conductivity of the soil k is the vertical unit vector and t is temperature substituting eq 11 into eq 10 the moisture balance equation can be written as 12 ρ w θ w t ρ i θ i t t 10 m w m c θ c ρ c ρ w d θ w θ w d t t k θ w considering the effects of ice water phase change and salt crystallization dissolution the extended model of the vwc in freezing sulfate saline soil can be expressed as zhang et al 2020a 13 θ w n θ c t f t t c n θ c θ i n θ c θ i θ w r θ w a θ w r e c 1 t t f θ w r θ w a θ w r e c 1 t t f n θ c θ i θ w r θ w a θ w r e c 1 t t f where θ w r represents the residual vwc θ w a is the initial vwc in the unfrozen soil c 1 is an experimental parameter reflecting the rate of decay tf is the freezing temperature and tc is the primary crystallization temperature of the pore solution the following parameters were determined θ w r 0 05 and c 1 0 16 c 1 the primary crystallization temperature of the pore solution is the temperature at which the salt first meets the threshold value of salt crystal growth which can be expressed as 14 t c t u a u a s t a r t where ua is the supersaturation u a start is the threshold value for salt crystal growth usually u a start 1 for salt crystallization but u a start 1 once the primary crystallization process begins koniorczyk 2012 based on phase change theory the freezing point of saline soil can be written as xiao et al 2022 15 t f t 0 r t 0 l n a w v m i δ s m 2 γ i l c o s θ r δ s m where t 0 and tf are the freezing temperatures of the pure water and saline soil respectively vmi is the molar volume of the ice crystal δsm denotes the entropy of fusion per unit volume of ice crystals γ il is the surface energy of the ice liquid interface while r is the mean curvature radius and θ is the contact angle under the action of f t cycles the ice and salt crystals formed in the pores of sulfate saline soil impede water migration and reduce the hydraulic and diffusion coefficients of the soil therefore the impedance factor i is introduced to determine the effect of ice and salt crystals on water transport bai et al 2020 newman and wilson 1997 16 i 10 10 θ i θ c the hydraulic and diffusion coefficients of sulfate saline soil subjected to f t cycles can be given as watanabe and flury 2008 zhang et al 2017 17 k θ w k θ i 18 d θ w d θ i where k θ and d θ are the intrinsic hydraulic conductivity and intrinsic diffusion coefficient 4 1 2 solute conservation equation salt exists in two phases in porous media dissolved salt and salt crystals the hygrothermal properties of porous materials are substantially affected by salt migration and crystallization dissolution the solute conservation equation including the effect of salt migration and crystallization dissolution can be written as bear and bachmat 1990 19 θ l c t ρ c θ c t ρ s v s the flow velocity of the solute concerning convection and diffusion can be given by 20 v s j s ρ s 1 ρ s c v w d s h c where js is the solute flux and dsh is the diffusion coefficient in a porous medium which can be expressed as nguyen et al 2008 21 d s h d c τ n 0 s l 1 6 where d c is the diffusion coefficient in a non dilute solution and τ is the direction dependent tortuosity of the porous material substituting eqs 20 and 21 into eq 19 the solute balance equation can be expressed as 22 θ l c t c v w d c τ n 0 s l 1 6 c ρ c θ c t 4 1 3 salt crystals conservation equation based on the hypotheses mentioned above the salt crystals mass balance equations neglecting their movement can be described as wu et al 2015 zhang et al 2020a 23 ρ c θ c t m c t where mc is the mass of salt crystals according to the gibbs theory the supersaturation of the salt solution is necessary for nucleation the driving force for salt crystallization is the difference between the chemical potentials of the pore solution and salt crystals δμ when considering only one type of salt sodium sulfate na2so4 and one type of salt crystal mirabilite na2so4 10h2o the driving force can be expressed as espinosa et al 2008 24 δ μ r t l n a n a a n a 0 2 a s o 4 2 a s o 4 2 0 a w a w 0 10 l n u a where a n a a s o 4 2 and aw represent the activities of cations anions and water in a given solution respectively a n a 0 a s o 4 2 0 and a w 0 are the activities of cations anions and water in the solution in the equilibrium state respectively r is the gas constant t is the temperature the saturation degree of the solution ua is given by butler et al 2016 marion and kargel 2007 25 u a k k 0 exp l n k l n k 0 where k is the ion activity product and k 0 is the solubility product in this model the calculated ion activity product k is compared to the solubility product to ascertain whether the solution is undersaturated k k 0 saturated k k 0 or supersaturated k k 0 the ion activity product of the solution can be expressed as marion and kargel 2007 26 k a n a 2 a s o 4 2 a w 10 a n a 2 s o 4 10 h 2 o where a n a 2 s o 4 10 h 2 o is the activity of mirabilite and a n a 2 s o 4 10 h 2 o is equal to 1 for the pure solid phase the frezchem model is an equilibrium chemical thermodynamic model parameterized for concentrated electrolyte solutions employing the pitzer approach for a temperature range of 60 25 c marion and farren 1999 marion and kargel 2007 the model can simulate the crystallization and dissolution of sodium sulfate over a temperature range of 23 25 c butler et al 2016 wang et al 2022 the solubility product k 0 can be calculated using the frezchem model 27 l n k 0 a 1 j a 2 j t a 3 j t 2 a 4 j t 3 a 5 j t a 6 j ln t a 7 j t 2 a 8 j t 4 whose parameters aij i 1 8 depend on the salt type the modified salt crystallization dissolution kinetics model of sulfate saline soil based on the theoretical model of supersaturation can be described as espinosa et al 2008 28 m c t c s k sc u a u a start n sc u a u a start and c s 0 c c k cs 1 u a n cs u a 1 and c c 0 where ksc and kcs denote the salt crystallization and dissolution rate constants respectively nsc and ncs are material parameters it is noteworthy that the first term in eq 28 denotes the process of salt crystallization ua u a start and cs 0 whereas the second term in eq 28 represents the dissolution process of salt crystals ua 1 and cc 0 4 2 energy conservation equation the energy conservation equation considering the latent heat released by ice water phase change and salt crystallization dissolution and the variation of energy caused by the mass transfer of each component has the following form bear and bachmat 1990 tan et al 2011 wu et al 2015 zhang et al 2020a 29 t ρ m e f f c p m e f f t ρ w c p w t ρ s c p s t q m e f f q w q s v w ρ w c p w t v s ρ s c p s t l w i m i t l s c m c t 0 where ρ m eff is the equivalent density of the solid phase c pm eff and c pα are the equivalent heat capacities of the solid phase and α phase respectively q m eff qw and qs are the heat fluxes of the solid phase soil particles ice crystals and salt crystals unfrozen water and solute respectively lwi and lsc are the latent heats of water and salt crystallization respectively the total heat flux qt can be expressed as 30 q t q m e f f q w q s λ e f f t where λ eff is the effective thermal conductivity the effective specific heat capacity and effective thermal conductivity concerning the influence of the content change of each component can be given by nishimura et al 2009 31 ρ e f f c p e f f 1 n ρ m c p m θ i ρ i c p i θ c ρ c c p c θ w ρ w c p w θ s ρ s c p s 32 λ e f f λ m 1 n λ i θ i λ c θ c λ w θ w λ s θ s where ρ eff is the equivalent density of the porous medium c p eff is the effective specific heat capacity and λα is the thermal conductivity of α phase substituting eqs 30 32 into eq 29 the energy conservation equation can be expressed as 33 ρ e f f c p e f f t t λ e f f t v w ρ w c p w t v s ρ s c p s t l w i m i t l s c m c t 4 3 mechanical equation 4 3 1 equilibrium equation the developed water heat salt related mechanics model is under a cylindrical coordinate system as the boundary conditions of the sample are symmetrical along the centerline assumed that the compression is positive in soil mechanics the equilibrium equation in an incremental form can be expressed as huang and rudolph 2021 lai et al 2009 shen and ladanyi 1987 34 t δ σ δ f 0 where denotes the differential operator matrix and r 0 z 1 r 0 z r 0 t σ denotes the stress vector and σ σ r σ z σ rz σ θ t f denotes the body force vector and f fr fz t 4 3 2 strain displacement relations the strain displacement relation of soil in incremental form based on the assumption of small strains can be given as lai et al 2009 li et al 2015 35 δ ε δ u where ε is the strain vector and ε ε r ε z ε rz ε θ t u is the displacement vector and u ur uz t 4 3 3 constitutive equation the stress strain relationship in an incremental function under external loads can be given as huang et al 2022 lai et al 2009 li et al 2015 36 δ σ d t δ ε δ ε vp δ ε v where dt is the matrix of elastic moduli and d t e t 1 ν t 1 ν t 1 2 ν t e t ν t 1 ν t 1 2 ν t e t ν t 1 ν t 1 2 ν t e t 1 ν t 1 ν t 1 2 ν t 0 e t ν t 1 ν t 1 2 ν t 0 e t ν t 1 ν t 1 2 ν t 0 0 e t ν t 1 ν t 1 2 ν t e t ν t 1 ν t 1 2 ν t e t 2 1 ν t 0 0 e t 1 ν t 1 ν t 1 2 ν t et is the elastic modulus ν t is poisson s ratio δε δε vp and δε v are the total viscoplastic and salt expansion and frost heave strains increment vectors respectively in a multi dimensional stress state the viscoplastic strain rate can be expressed as lai et al 2009 37 d ε vp γ t φ f q σ where γ t denotes the viscosity parameter q is the plastic potential function and φ f is a scalar function defined as lai et al 2009 li et al 2015 38 φ f φ f 0 φ f 0 φ f 0 and 39 φ f f f 0 f 0 where f is the yield function and f 0 is the yield stress the drucker prager yield criterion matched to the mohr coulomb criterion was applied in this study and 40 q σ f σ f σ r f σ z f σ r z f σ θ t for sulfate saline soil with a high salt content the primary salt crystallization temperature of the pore solution is significantly higher than that of freezing the volume increase was caused only by salt migration and crystallization before freezing meanwhile when the temperature reached the freezing point the volume increase was attributed to water and salt migration and alternate crystallization in addition the influence of cold shrinkage was neglected the volume increase of sulfate saline during f t cycles can be expressed as 41 ε v ε v salt ε v ice 0 θ c θ l n 0 θ c θ i θ l n 0 t t c t f t t c t t f where ε v ε v salt ε v ice are increased volumes caused by water and salt migration and crystallization salt migration and crystallization and water migration and ice water phase change respectively for a cylindrical coordinate system constraining the horizontal displacement in the radial direction and the vertical displacements at the bottom of the sample the relationship between ε v and ε v can be written as 42 ε v ε v 3 0 1 2 ν t 1 ν t 0 0 t the basic water heat salt mechanics related parameters in the proposed coupled model are as follows li et al 2015 zhang et al 2017 bai et al 2020 43 e t a 1 b 1 t f t c 1 t t f a 1 t t f 44 ν t a 2 b 2 t f t c 2 t t f a 2 t t f 45 c t a 3 b 3 t f t c 3 t t f a 3 t t f 46 ϕ t a 4 b 4 t f t c 4 t t f a 4 t t f 47 k θ a 5 θ w b 5 48 d θ a 6 θ w b 6 where et is the elastic modulus ν t is poisson s ratio ct is the cohesion ϕ t is the angle of internal friction a i i 1 6 b i i 1 6 and c i i 1 4 are the experimental parameters the corresponding coefficients for the equations are listed in table 2 eqs 12 22 23 and 33 36 constitute the water heat salt mechanics coupling model of saturated sulfate saline soil subjected to f t cycles the governing equations are composed of the mass conservation moisture solute and salt crystal balance equations energy conservation and force equilibrium equations 5 model implement 5 1 finite element algorithm the proposed water heat salt mechanics coupling model is highly nonlinear because the coefficients in the governing equations vary with time and they affect each other the governing eqs 12 22 23 and 33 36 are discretized in space to solve the developed model using the finite element method these equations were solved using comsol software the above mentioned equations can be written as 49 d a ζ t γ h where ζ indicates a variable in the governing equations and ζ θ eff θ s θ c t u da denotes the damping coefficient γ is the flux vector and h is the source term generalized solution to eq 49 could be given in the form zhang et al 2016 50 d a ζ t ζ ω γ ζ ω h ζ ω where ζ is the virtual primary variable eq 50 can be written as 51 d a ζ t ζ ω γ ζ ω h ζ ω n γ ζ ω the time terms are discretized by using the backward euler difference method as follows 52 ζ t ζ i ζ i 1 δ t where the superscript i refers time i ω is the calculated domain ω is the boundary of the domain and n is the outward norm vector of the boundary substituting eq 52 into eq 51 gives 53 d a ζ i ζ i 1 δ t ζ ω γ ζ ω h ζ ω n γ ζ ω 5 2 initial and boundary conditions the initial condition can be expressed as lai et al 2014 54 ζ x y z 0 ζ 0 where ζ 0 is a known function of time or a prescribed value of the variable ζ at the initial time boundary conditions in above model including the dirichlet and neumann boundary conditions can be written as zhang et al 2020a 55 n γ g π ζ μ t where n is the outwards normal unit vector of the boundary g is the source term at the boundary π ζ t is the matrix of the elastic constraint and μ is the matrix of the lagrange multiplier specifically π 0 denotes the neumann boundary condition 6 numerical validation based on the experimental data of the f t cycles of saturated sulfate saline soil a numerical simulation of the f t cycles was conducted by employing the water heat salt mechanics coupling model proposed in this study the validity of the model was verified by comparing the calculated results with experimental data 6 1 calculation parameters and conditions the validity of the developed model is demonstrated by comparing it with the test data using sample s3 as a case study table 3 lists the numerical simulation primary parameters the data represented by superscript a b c d are from lai et al 2014 zhang et al 2020a castellazzi et al 2013 2016 wu et al 2015 marion and kargel 2007 and xiao et al 2022 respectively fig 8 shows an axisymmetric computation model in which ab is the symmetry axis the initial and boundary conditions are given by 1 the seepage boundary conditions ad and cd are impervious boundary conditions the supplied sodium sulfate solution equals the initial pore solution through the boundary bc 2 thermal boundary conditions cd is the thermal isolation boundary and ab is subjected to the cyclic f t temperature as shown in eq 1 bc temperature remains unchanged after decreasing from initial value to predetermined temperature and t bc 4 0 c the initial temperature field of the soil sample is uniform with t t 0 8 0 c 3 mechanical boundary conditions bc and cd radial displacements were constrained and bc vertical displacement was set to 0 6 2 variations of temperature vwc and concentration analyzing the variations of vwc and concentration with temperature is beneficial for studying the spatial temporal distribution of solutes during f t cycles and helps reveal the mechanism of salt accumulation and soil salinization of sulfate saline soil subjected to f t cycles as shown in fig 9 sample s3 is taken as a case study to compare the calculated results with test data to verify the effectiveness of the proposed model from fig 9 the predicted temperature vwc and concentration values closely match the test data the results show that the proposed coupling model can describe the dynamic interaction of water heat salt in sulfate saline soil during f t cycles scholars have explored the influence of salinity and salt types on vwc in saline soil during f t cycles however they cannot theoretically analyze the coupling effects of ice water phase change and salt crystallization dissolution on vwc during the freezing period water freezes into ice increasing the concentration of pore solution and intensifying salt crystallization and precipitation conversely salt crystallization will consume unfrozen water and promote water freezing as solute concentration decreases the alternation crystallization of ice and salt aggravates the decrease in vwc and solute concentration the mutual promotion between ice melting and salt crystal dissolution during the thawing stage is similar to the freezing process and will not be repeated as shown in fig 9 b similar test data were reported by lai et al 2017 and wu et al 2018 the extension model of vwc can describe the variation of unfrozen water in sulfate saline soil during f t cycles considering the interaction between ice water phase change and salt crystallization dissolution scholars attempt to analyze the concentration variation of pore solution in sulfate saline soil during f t cycles based on the relationship between the solubility of sodium and temperature however the formula is valid only above 0 c therefore using empirical formulas to describe the crystallization and dissolution characteristics of ideal dilute solutions may be incorrect koniorczyk 2012 zhang et al 2021 based on the pitzer model the frezchem model theoretically analyzes the saturation of sodium sulfate solution from the perspective of chemical thermodynamics equilibrium during f t cycles from eq 25 the calculated ion activity product is compared to the solubility product to ascertain whether the solution is supersaturated saturated or undersaturated from fig 9 c the calculated solute concentration correlates with the experimental data indicating the salt crystallization dissolution kinetics model employing the frezchem model can illustrate the salt crystal growth and dissolution in sulfate saline soil exposed to f t cycles the theoretical analysis of the saturation degree of sodium sulfate solution using the frezchem model avoids errors in empirical formula calculations 6 3 salt expansion and dissolution settlement fig 10 illustrates the soil displacement and residual deformation variations of sample s3 experiencing f t cycles the calculated results correlate well with the experimental data indicating that the developed coupling model in this study can illustrate the deformation property of sulfate saline soil during f t cycles from eq 41 the increased volume generated by water and salt migration ice water phase change and salt crystallization dissolution can be divided into two parts one part is frost heave caused by water migration and ice water phase change the other part is salt expansion caused by salt migration and salt crystallization dissolution the increased volume will separate soil particles and induce deformation caused by salt expansion and frost heave as shown in fig 10 a ice and salt crystals are formed by heterogeneous ice nucleation in a supercooled solution and salt crystallization in a saturated solution during freezing leading to the deformation of salt expansion and frost heave caused by the effective stress change water and solute migration provides the material sources for crystallization induced soil deformation it is evident that the salinity in the frozen layer increases along with water and salt migrating towards the frozen layer from the underlying soil during f t cycles therefore the deformation of sulfate saline soil with high salinity increased gradually with increasing f t cycles until it reached a stable state during the thawing period the salt improves the cementation between the soil particles enhancing the shear strength to a certain extent higher salinization improves the arrangement of the soil structure and significantly impacts instantaneous volume change behavior wang et al 2020 from fig 10 b sample s3 had a marked dissolution deformation in the melting stage forming a noteworthy residual deformation substantial amounts of salt accumulating above the freezing front caused by convection and diffusion reduce soil permeability and hinder water and salt migration therefore the residual deformation of sulfate saline soil decreases with increasing f t cycles and the deformation of salt expansion and frost heave tends to be stable fig 10 the correlation between the calculated results and the measured temperature vwc concentration and soil displacement data of sample s3 subjected to f t cycles is presented in fig 11 noticeably the overall performance of the proposed model in terms of water heat salt mechanics interaction simulation can be regarded as acceptable given the multi field coupled process in such a challenging environment even through discrepancies exist during certain periods for the proposed water heat salt mechanics coupling model the consistency between the calculated and measured temperature vwc concentration and soil displacement data was satisfactory indicating the capability of the proposed model to portray the coupling effect of water and salt transport heat transfer ice water phase change salt crystallization dissolution and the deformation caused by salt expansion and frost heave of sulfate saline soil during f t cycles 7 discussion 7 1 effect of initial salt content on the spatial temporal distribution of solute fig 12 presents the salt distribution of samples s3 and s4 after the 5th f t cycle the calculated results are consistent with the experimental data as shown in fig 12 the maximum salt content above the freezing front of samples s3 and s4 increased by 4 61 and 4 92 respectively compared with the initial values the salt contents in the frozen zone and the unfrozen area adjacent to the freezing front of samples s3 and s4 significantly increased although the salt contents in the top layer remained unchanged fig 13 illustrates the spatial temporal distribution of the solutes of samples s3 and s4 experiencing f t cycles many researchers adopt stratified sampling to study the mechanism of salt migration in saline soils during f t cycles but fail to describe the spatial temporal distribution of solutes based on the established coupling model and experimental data the influence of salt contents on the spatial temporal distribution of solutes in sulfate saline soil exposed to f t cycles under an opened system was analyzed the f t processes affect the hydrothermal cycles and solute transport resulting in water and salt redistribution during the freezing process the water and temperature potential gradients between the frozen and unfrozen layers were relatively high which could cause water to migrate from the unfrozen zone to the freezing front solute in the pores of the unfrozen area migrates together with soil water towards the frozen layer leading to salt accumulation above the freezing front and reducing solute concentration in the unfrozen zone as shown in fig 12 when water and solute are continually supplied to the frozen layer by capillary action the solute will abundantly accumulate in the frozen area as the freezing front penetrates downwards the solute concentration in the frozen zone reached the solubility resulting in salt precipitation in the form of subflorescence during thawing water and salt migrate downwards to the unfrozen zone from figs 12 and 13 results showed that the amount of salt migration upward during freezing is larger than that of downward transport during thawing salt accumulation above the freezing front increases with increasing f t cycles and similar test data were reported by lai et al 2017 and wu et al 2018 meanwhile diffusion occurred in the opposite direction owing to the development of concentration gradients during freezing resulting in the formation of a salt enrichment layer under the freezing front particularly for sample s4 with a higher salt content the results showed that the top layers of samples s3 and s4 did not accumulate and precipitate additional salt in the form of efflorescence compared to the initial values after 5 f t cycles although in the opened system therefore a sufficient number of f t cycles is required for the formation of the salinization of the soil surface layer 7 2 effect of water supply conditions and f t times on the spatial temporal distribution of solute fig 14 presents the salt distribution of samples s5 and s6 after the 10th f t cycle from fig 14 the calculated results correlate with the experimental data the maximum salt contents above the freezing front of samples s5 and s6 increased by 8 91 and 4 03 respectively more importantly the salt contents in the top layer of samples s5 and s6 increased by 2 57 and 1 55 respectively under the opened system results showed that the salt content in the unfrozen zone of sample s5 undergoing 10 f t cycles remained unchanged compared with that of s3 fig 14a however under the closed system it is worth pointing out that the salt content at the same location in the unfrozen area of sample s6 after 10 f t cycles is significantly smaller than that of s3 fig 14b how water supply conditions and f t times affect solute redistribution and the salinization of soil surface layer that must be addressed fig 15 shows the spatial temporal distribution of the solutes of samples s5 and s6 experiencing f t cycles under different water supply conditions based on the proposed coupling model the influences of water supply conditions and f t times on the spatial temporal distribution of solute and the salinization of soil surface layer were analyzed as shown in fig 15 a and b under the same test conditions except for different water supply conditions the salinity of the top layer of sample s5 increased significantly compared with that of s6 after 10 f t cycles results indicated that a sufficient number of f t cycles could also cause the salinization of soil surface layer without considering the evaporation effect salt accumulation in the frozen zone during freezing decreased the osmotic potential resulting in noticeable freezing point depressions and higher liquid contents in the frozen layer of soil meanwhile the freezing rate decreases with increasing solute concentration when the cooling rate of soils slows down gradually water and salt will have sufficient time to migrate toward the area near the soil s top layer the solute concentration near the top layer of the soil reached solubility resulting in salt precipitation in the form of efflorescence under the opened system the salt supplement from the bottom and the salt accumulation caused by the previous f t cycle in the frozen and unfrozen layers near the freezing front provides a material source for salt accumulation as a form of efflorescence salt accumulation and precipitation in the top layer will cause a decrease in salt content beneath the freezing front based on salt mass conservation since sample s6 is in the closed system fig 15b meanwhile ignoring the role of evaporation it is worth noting that f t cycles not only increase the salt content in the pores near the freezing front i e subflorescence but also increase the salt content in the soil surface layer i e the salinization of soil surface layer at a certain number of f t cycles e g 10 f t cycles 7 3 feedback mechanism of the spatial temporal distribution of the solute on soil salinization the f t processes of sulfate saline soil have long been recognized for their engineering applications and environmental issues fig 16 illustrates the feedback mechanism of the spatial temporal distribution of the solute on salt accumulation and soil salinization in sulfate saline soil subjected to f t cycles convection and diffusion are the dominant factors for salt migration and accumulation in sulfate saline soil subjected to f t cycles neglecting the effect of evaporation the convection causes salt to migrate upward from the unfrozen zone to the frozen area while the concentration gradient of the pore solution between the frozen and the unfrozen layers drives salt downward the convection and diffusion mechanisms make solute migrate in the opposite direction during freezing and convection is the primary process therefore the amount of salt migration upward is larger than that of downward transport during freezing increasing salt accumulation above the freezing front with increasing f t cycles and aggravating the salinization of soil surface layer meanwhile the water supply condition significantly influences salt migration in sulfate saline soil the replenishment of water and salt supplies the material source for salt accumulation therefore in the f t cycles of sulfate saline soil convection diffusion not only causes salt to accumulate and precipitate in the frozen and unfrozen layers near the freezing front in the form of subflorescence but also leads to salt accumulation and precipitation in the form of efflorescence in the soil surface layer at a certain number of f t cycles ice crystals grow from a supercooled solution through heterogeneous ice nucleation and salt crystals grow from a saturated solution the processes of water freezing into ice and salt crystallization lead to effective stress change and cause the deformation of salt expansion and frost heave the salt content in the frozen zone increases with increasing f t cycles leading to a gradual increase in the deformation of salt expansion meanwhile the amount of salt migration upward during freezing is larger than that of downward transport during thawing forming a significant residual deformation during melting it is worth noting that salt expansion at freezing and residual deformation at thawing gradually stabilize with increasing f t cycles caused by the hindering effects of salt accumulation and precipitation on water and salt migration 8 conclusions and future prospects sulfate saline soil involves the complex coupling effects of water and salt migration heat transfer ice water phase change salt crystallization dissolution and soil deformation during f t processes based on the modified salt crystallization dissolution kinetics model employing the frezchem model we proposed a water heat salt mechanics coupled model for saturated sulfate saline soil subjected to f t cycles considering the effects of ice water phase change and salt crystallization dissolution the influences of the initial salt content water supply condition and number of f t cycles on the water heat salt mechanics dynamic interaction were analyzed the spatial temporal distribution of the solute in sulfate saline soil under different experimental conditions was clearly illustrated we further described the feedback mechanism of the spatial temporal distribution of the solute on salt accumulation and soil salinization finally comparisons of the calculated results with the experimental data validated the effectiveness of the proposed model the following conclusions were drawn 1 the modified salt crystallization dissolution kinetics model employing the frezchem model can theoretically reveal the characteristics of salt crystal growth and dissolution of sulfate saline soil during f t processes 2 convection and diffusion are the dominant factors for the spatial temporal distribution of solutes of sulfate saline soil subjected to f t cycles forming subflorescence in the frozen and unfrozen layers near the freezing front and efflorescence in the soil surface layer at a certain number of f t cycles and aggravating salt accumulation and soil salinization 3 salt migration and accumulation promote salt expansion but the overall deformation characteristics of sulfate saline soil undergoing f t cycles are closely related to the initial conditions such as the initial salt content water supply condition and number of f t cycles 4 the calculated results correlate with the experimental data demonstrating that the proposed water heat salt mechanics coupling model based on crystallization kinetics can illustrate the dynamic interaction of water and salt migration heat transfer ice water phase change salt crystallization dissolution and soil displacement of saturated sulfate saline soil exposed to f t cycles the proposed model in this study can effectively describe the water heat salt mechanics coupling behavior in saturated sulfate saline soil during f t cycles we will further study the mechanisms of water and salt migration and soil deformation to improve the application of the model in unsaturated saline soil this study only focuses on the spatial temporal distribution of sulfate sodium in sulfate saline soil during f t cycles neglecting the multi component soil salts in actual saline soil further research will employ the frezchem model to describe multi component soil salts migration and accumulation characteristics in saline soil exposed to f t cycles f t cycle and evaporation are two control factors for soil salinization to extend the proposed water heat salt mechanics coupling model to a five field water heat salt vapor mechanics coupling model the internal mechanisms of salt migration and accumulation and salt crystallization dissolution in the coupling of f t cycle and evaporation will be further studied furthermore our research will pay close attention to the influences of future climatic uncertainties on soil salinization credit authorship contribution statement jing zhang conceptualization data curation validation investigation writing original draft writing review editing yuanming lai conceptualization writing review editing resources supervision project administration shuangyang li writing review editing mingyi zhang investigation writing review editing zhemin you writing review editing te liang writing review editing declaration of competing interest we confirm that the work described is original research that has not been published previously no conflict of interest exists in the submission of this manuscript acknowledgments this research was supported by the key research program of the chinese academy of sciences grant no zdrw zs 2020 1 the national natural science foundation of china grant nos u2268215 u21a2012 42201154 the national key research and development program of china grant no 2018yfc0809605 the key research program of frontier sciences of chinese academy of sciences grant no qyzdy ssw dqc015 the program of the state key laboratory of frozen soil engineering grant no sklfse zq 60 
16,knowledge of freezing thawing f t cycles of sulfate saline soil is crucial regarding the spatial temporal distribution of solutes in the soil soil salinization and cold region engineering in sulfate saline soil areas f t tests of saturated sulfate saline soils with different salt contents water supply conditions and the number of f t cycles were conducted the coupling mechanism of water and salt migration ice water phase change salt crystallization dissolution and deformation caused by salt expansion and frost heave of saturated sulfate saline soil during f t processes were analyzed a water heat salt mechanics coupling mathematical model for saturated sulfate saline soil under f t cycles is proposed using the modified salt crystallization dissolution kinetics model the results show that the calculated profiles of temperature water content concentration and soil displacement are in good agreement with the experimental data demonstrating that the proposed coupling model can describe the coupled water heat salt mechanics process of sulfate saline soil during f t processes additionally the modified salt crystallization dissolution kinetics model employing the frezchem model can theoretically reveal the processes of salt crystal growth and dissolution also the water and temperature potential gradients are the main driving force for water migrating toward the freezing front convection and diffusion are the dominant factors for the spatial temporal distribution of solutes of sulfate saline soil subjected to f t cycles causing salt accumulation and precipitation and forming subflorescence in the frozen and unfrozen layers near the freezing front and efflorescence in the soil surface layer at a certain number of f t cycles due to the blocking effect of salt accumulation and precipitation on water and salt migration salt expansion during freezing and residual deformation during thawing gradually stabilize with the increase of f t cycles keywords freezing thawing processes spatial temporal distribution of solute subflorescence and efflorescence water heat salt mechanics coupling soil salinization data availability data will be made available on request nomenclature r mean curvature radius m δsm fusion entropy of ice water j mol k s α saturation degree of α phase tc tf t 0 crystallization point and freezing point of saline soil and bulk water k ua u a start supersaturation and threshold value v α volume of α phase vmi molar volume of ice crystal mol m3 v α flow velocity of α phase m s θ α volumetric content of α phase m3 m3 θ w r θ w a residual unfrozen water and initial moisture content m3 m3 λ α thermal conductivity of α phase w m k ν0 molecules of water ρ α density of α phase kg m3 σ stress vector n m2 χα ration of α phase subscripts w unfrozen water s dissolve salt l pore solution i ice crystal c salt crystal wc crystal water 1 introduction knowledge of freezing thawing f t cycles of sulfate saline soil is crucial in terms of the spatial temporal distribution of solutes in the soil soil salinization and cold region engineering in sulfate saline soil areas hou et al 2019 2022 kurylyk and watanabe 2013 wu et al 2019 as a multiphase continuous porous medium composed of solid liquid and gas phases saline soil is widely distributed in the cold regions lai et al 2017 the f t cycles of sulfate saline soil involve the coupling effects of water and salt migration heat transfer ice water phase change salt crystallization dissolution and soil deformation the dynamic interaction in sulfate saline soil experiencing f t cycles is a significant issue concerning soil salinization building durability underground structures engineering and environmental sciences in cold regions castellazzi et al 2013 2016 choo and sun 2018 li et al 2015 tan et al 2011 zhang et al 2017 teng et al 2019 hassani et al 2020 therefore studying the water heat salt mechanics coupling mechanism of sulfate saline soil can provide a theoretical reference to investigate soil salinization and prevent the deformation of salt expansion and frost heave of sulfate saline soil under f t cycles generally salt exists in two phases in porous media dissolved salt and salt crystals water and salt crystallization of sulfate saline soil destroys soil structure and rearranges soil particles exposed to f t processes lai et al 2017 f t cycles have considerable effects on changes in pore structure konrad 1989 wang et al 2020 permeability qi et al 2006 teng et al 2023 soil temperature yadav and wang 2021 unfrozen water content yadav and wang 2017 freezing point wang et al 2019 and solute concentration stähli and stadler 1997 which are directly related to water and salt migration and redistribution at the same time f t cycles will cause changes in the mechanical properties of the soil xu et al 2020 2020a 2020b researchers have found that the alteration in the cohesion of silty soil undergoing the f t cycle is not simply a decrease but there is a critical dry bulk density and the cohesion change observed under this critical dry bulk density is not substantial qi et al 2006 2008 many researchers have used different laboratory methods to investigate water and salt migration and the characteristics of crystallization induced soil deformation exposed to f t cycles the f t process of sulfate saline soil involves a dynamic water heat salt mechanics interaction when a freezing temperature gradient forms in the sulfate saline soil heat transfer can cause water and solute migration during freezing sarsembayeva and collins 2017 rui et al 2019 the salinity in the frozen layer increased as water and salt migrated toward the frozen zone from the underlying beds zhang and wang 2001 wu et al 2018 the temperature variation can cause water freezes into ice and salt crystallization and precipitation bing et al 2015 wang et al 2016 wu et al 2016 meanwhile ice water phase change and salt crystallization will cause the enhancement of the heat transfer process caused by the latent heat leading to the deformation of salt expansion and frost heave caused by the effective stress change zhang et al 2020a during the thawing period the amount of solute transported towards the frozen zone during the freezing process is higher than that migrated downward during thawing resulting in salt accumulation above the frozen fringe wu et al 2018 the high salinity sulfate saline soil exhibits significant residual deformation compared to the low salinity soil zhang et al 2020b furthermore convection and diffusion are the leading factors in solute redistribution which causes salt accumulation above the freezing front and forms discontinuously distributed layered salt crystal zones hassanizadeh and leijns 1988 kadlec et al 1988 rui et al 2019 zhang et al 2020a liu et al 2021 as mentioned above the results preliminarily clarified the law of water and salt migration in saline soil exposed to f t cycles but cannot illustrate the formation mechanism of salt accumulation and residual deformation of sulfate saline soil subjected to f t cycles therefore it is necessary to reveal the water heat salt mechanics coupling mechanism of sulfate saline soils subjected to f t cycles scholars have established corresponding coupled models to analyze the dynamic interaction of sulfate saline soil exposed to f t cycles based on continuum mechanics theories thermodynamics and segregation potential moisture heat mechanics coupling models were proposed to analyze f t disasters of tunnels canals and permafrost embankments in cold regions nishimura et al 2009 tan et al 2011 li et al 2015 zhang et al 2017 huang et al 2022 the mentioned moisture heat mechanics coupling model can simulate the interaction of water heat and stress in a porous medium exposed to f t cycles however none of them considers the effect of the solute and cannot describe the deformation caused by salt expansion and dissolve settlement zhang et al 2020a with the understanding of water transport in the soils during f t cycles many scholars have initiated more in depth studies on water and salt migration and the deformation caused by salt expansion and frost heave including water heat salt coupling models nassar and horton 1992 nassar et al 1992 castellazzi et al 2013 2016 wu et al 2019 the chemo hydra mechanical coupling models koniorczyk 2012 choo and sun 2018 and the water heat salt mechanics semi coupling models based on kinetic model considering nucleation molecular diffusion and crystal growth lai et al 2017 zhang et al 2020a the disadvantage is that in many cases the moisture and temperature in the coupling model are still dominated by the traditional three field coupling ignoring the solute effect on heat and mass transfer zhang et al 2021 generally studies on the interactions between water and salt migration heat transfer salt crystallization dissolution ice water phase change and deformation caused by salt expansion and frost heave of sulfate saline soil subjected to f t cycles are limited therefore it is important to provide a novel water heat salt mechanics coupling model for sulfate saline soils exposed to f t processes in this study unidirectional f t experiments were conducted on saturated sulfate saline soil with different salt contents water supply conditions and numbers of f t cycles to study the water heat salt mechanics coupling processes based on the modified salt crystallization dissolution kinetics model a water heat salt mechanics coupling model for saturated sulfate saline soil exposed to f t cycles was developed considering the effects of ice water phase change and salt crystallization dissolution the main objectives of this study were to determine that 1 coupled mechanism of water and salt transport heat transfer ice water phase change salt crystallization dissolution and the deformation caused by salt expansion and frost heave of sulfate saline soil during f t cycles 2 spatial temporal distribution of solutes of sulfate saline soil under different experimental conditions of f t cycles and 3 feedback mechanism of the spatial temporal distribution of solutes on salt accumulation and soil salinization of sulfate saline soil during f t processes this study could effectively reduce soil salinization and protect engineering facilities in sulfate saline soil areas 2 test description 2 1 test material and design the tests were conducted in the f t test chamber of the xt5405b series at the state key laboratory of frozen soil engineering the experimental conditions of the samples are listed in table 1 desalinized silty clay was obtained from the qinghai tibet plateau fig 1 shows grain size distribution of the soil used in this study six samples with different salt contents were prepared and sealed for 24 h at room temperature 25 c for homogenization the specifically designed samples are shown in table 1 where s1 s2 s3 and s4 represent the samples with different initial salt contents and s5 and s6 represent the samples with different water supply conditions the prepared samples were cylinders with a diameter of 10 0 cm and a height of 15 0 cm after the vacuum saturation process the water content of the sample closes to 20 9 2 2 test apparatus the f t experimental apparatus for testing the samples is shown in fig 2 a sample container was positioned inside the test chamber to control the environmental temperature the top and bottom plates controlled the top and bottom temperatures of the samples respectively eight temperature sensors thermistor precision 0 05 c were instrumented at intervals of 2 0 cm and 0 5 cm above the bottom of the sample to monitor temperature variations one hydra probe ⅱ was instrumented at 10 0 cm above the bottom of the column to measure temperature changes precision 0 6 c moisture content precision 0 003 and electrical conductivity precision 0 0014 s m a calibration graph was generated by plotting the electrical conductivities of the salt solutions with known salt concentrations the solute concentration of the pore solution was estimated from a calibration graph based on the measured electrical conductivity a displacement sensor precision 0 01 mm was installed at the top of the column to monitor soil displacement insulation material with a thickness of 2 0 cm was installed around the sample container to prevent temperature defects the water supplement system consisted of a mariotee flash connected to the bottom plate through a plastic tube 2 3 experimental program the applied cyclic f t temperature tcycle at the top of the sample during f t cycles is 1 t cycle 8 19 sin 2 π 18 t c the soil samples were pre cooled in the test chamber at 8 0 c for 24 h allowing the sodium sulfate in the pores to dissolve completely and the samples temperature to remain uniform before the test subsequently the f t processes were started with the top temperature of the samples set to the cyclic temperature the bottom and test chamber temperatures were set to 4 0 c and kept constant during f t cycles a cr3000 device was employed to collect data at 5 min intervals at the end of the experiments the soil columns were divided into 15 parts with a thickness of 1 0 cm and the salt content was measured 3 results and analyses 3 1 effect of initial salt content on moisture content the cyclic changes in sample temperature lead to ice water phase transition and salt crystallization dissolution in the pores which are the main factors contributing to changes in volumetric unfrozen water content vwc vwc and temperature variations with time under conditions s1 and s3 are presented in fig 3 as shown in fig 3 a the dominant factors affecting the vwc change in the f t cycle for the non saline soil sample s1 were water migration freezing temperature pore radius and pore structure characteristic the vwc change of sample s1 in the first f t cycle can be divided into two stages the slowly lowering and the f t variation stages during the first stage the increase in freezing depth led to water migration from the underlying zone to the freezing zone resulting in a decrease in the vwc in the underlying zone the second stage was the f t variation stage the ice water phase change of non saline soil experiencing the f t cycle led to vwc variations as shown in fig 3 b for the saline soil sample s3 the effects of salinity and salt crystallization dissolution on vwc cannot be ignored the vwc change of sample s3 in the first f t cycle is different from that of sample s1 which can be divided into three stages a slowly lowering salt crystallization and ice water phase change and salt crystallization dissolution stages salt crystallization was the dominant factor for vwc decrease before freezing when the soil temperature is lower than the freezing temperature alternate ice water phase change and salt crystallization dissolution led to vwc changes the residual vwc of sample s3 was larger than that of sample s1 at the same minimum temperature the analysis shows that the water activity decreases with increasing solute concentration lowering the pore solution freezing temperature therefore it is necessary to consider the effect of the solute on the vwc variation of sulfate saline soil subjected to f t cycles 3 2 effect of initial salt content on solute concentration concentration and temperature variations with time under conditions s3 and s4 are shown in fig 4 from fig 4 a the concentration change of sample s3 at 10 0 cm in the first f t cycle can be divided into three stages steady lowering and rapid decrease or increase stages the concentration changed slightly prior to freezing the results showed that the primary salt crystallization temperature was higher than the freezing temperature the concentration showed an apparent decreasing trend caused by salt crystallization during the second stage the rapid decrease or increase stage is attributable to the effect of ice water phase change and salt crystallization dissolution on the pore solution concentration meanwhile the concentration of sample s3 increased gradually with increasing number of f t cycles fig 4 b illustrates that the concentration change of sample s4 at 10 0 cm in the first f t cycle can be divided into three stages slowly increasing stage slightly decreasing and salt crystallization dissolution stages the initial temperature of sample s4 was lower than the primary salt crystallization temperature when the temperature reached its peak value as shown in fig 4 b the concentration increased slightly resulting from the dissolution of the salt crystals during the second stage decrease in concentration was attributable to salt migration from the unfrozen zone towards the freezing zone before salt crystallization the monitoring position of the concentration of sample s4 was always in the unfrozen zone during f t cycles salt crystallization dissolution is the reason for the concentration variation in the pore solution meanwhile the concentration of the pore solution of sample s4 at the monitoring position showed an increasing trend during f t cycles the variation in the solute concentration of sulfate saline soil subjected to f t processes was similar to the results of previous studies lai et al 2017 wu et al 2018 zhang et al 2020a 3 3 effect of initial salt content on soil deformation fig 5 shows the soil sample displacement and residual deformation variations for different salt contents from fig 5 a the deformation is characterized by frost heave and thaw settlement during f t cycles of the non saline and low salinity samples s1 and s2 residual deformation is defined as the difference between the deformation within the nth f t cycle and the n 1 th f t cycle as shown in fig 5 b during f t cycles samples s1 and s2 residual deformations of showed a downward trend after reaching a negative peak in the third f t cycle and were always less than 0 this indicates that soil deformation characteristic of samples s1 and s2 was thawing settlement for samples s1 and s2 frost heave occurred owing to the increase in ice pressure caused by the transformation of pore water into ice during freezing thawing settlement appears owing to the disappearance of ice pressure in pores and the weakening of soil shear strength during thawing therefore for low salinity soil the ice pressure generated during the formation of ice crystals is the dominant factor in soil deformation therefore the formation and dissipation of ice pressure deterioration of soil pore structure and weakening of soil shear strength are the main factors of frost heave and thawing settlement of low salinity soil subjected to f t cycles the deformation is characterized by salt expansion and dissolution settlement during f t cycles of the high salinity samples s3 and s4 as shown in fig 5 b the residual deformations of samples s3 and s4 decreased with the number of f t cycles and were always greater than 0 the results reveal that the deformation of the high salinity samples shows a gradual increasing trend with an increase in the number of f t cycles ice and salt crystallization pressures aggravate salt expansion and frost heave during freezing meanwhile the pressure on the pore walls depends on the amount of ice and salt crystals therefore the salt expansion and residual deformation increase with increasing initial salt content 3 4 effects of water supply condition and number of f t cycles on soil deformation fig 6 presents soil sample displacement and residual deformation variations under different water supply conditions and number of f t cycles for samples s3 s5 and s6 the deformation characteristic of samples s3 and s5 was mainly salt expansion in contrast dissolution settlement was primarily the deformation characteristic of sample s6 in fig 6 b residual deformation represents the f t deformation characteristics of the soil with positive values indicating expansion and negative values indicating settlement for sample s5 the solute continuously migrated and accumulated in the freezing zone during f t cycles increasing the salt content above the freezing front therefore the residual deformation of sample s5 decreased with the number of f t cycles and tended to be stable in the 9th f t cycle however for sample s6 without water replenishment water and salt migrated from the unfrozen zone to the freezing zone during the freezing period resulting in a decrease in water and salt contents under the freezing front the residual deformation of sample s6 showed a downward trend after reaching a negative peak in the 6th f t cycle and tended to be stable in the 10th f t cycle the results indicate that the water supply condition substantially influences the deformation of sulfate saline soil 4 mathematical model the temperature unfrozen water content and solute concentration of sulfate saline soil change periodically owing to external temperature variations during f t cycles soil water potential is the driving force for water and solute migration from the unfrozen zone to the frozen zone during freezing water and salt crystallization causes soil deformation of salt expansion and frost heave moreover it changes the soil pore structure and reduces the permeability and solute diffusion coefficient additionally a larger amount of solute migrated upward during cooling than that transported downward during the thawing period in the pores causing salt accumulation in the frozen zone and residual deformation as shown in fig 7 saturated sulfate saline soil consists of solid soil particles ice crystals and salt crystals and liquid unfrozen water and dissolved salt phases the influence of the gas phase was not considered sodium sulfate is more destructive than other salts therefore only one type of salt and salt crystal mirabilite na2so4 10h2o was considered castellazzi et al 2013 koniorczyk 2012 zhang et al 2020b the f t cycles of sulfate saline soil involve the coupling effects of water and salt migration heat transfer ice water phase change salt crystallization dissolution and soil deformation the following assumptions were made to propose the coupled model 1 soil is an isotropic and homogeneous porous medium 2 the influence of water evaporation is ignored considering only the influence of released absorbed latent heat caused by ice water phase transition and salt crystallization dissolution on the temperature field 3 water and salt migrate in liquid form ignoring the movement of ice and salt crystals based on volume averaging theory hassanizadeh and gray 1979 sulfate saline soil is conceptualized as a multiphase porous medium in the following unfrozen water dissolved salt and pore solution are described by the subscripts w s and l respectively the soil particles ice crystal and salt crystals are denoted by the subscripts m i and c respectively c α is the mass of α phase per unit volume of the porous medium which can be defined as castellazzi et al 2013 2 c α n s α ρ α θ α ρ α where n is the porosity s α is the saturation degree of α phase α w s l m i c ρα is the density of α phase and θα is the volumetric content of α phase can be described as 3 θ α d v α d v where v is the volume of the porous media and v α is the volume of α phase the pore solution consists of unfrozen water and solute and the saturation of the pore solution sl is given by 4 s l s w s s the ratios of moisture and solute in the solution can be written as 5 χ w θ w θ l s w s l χ s θ s θ l s s s l the concentration of solute in the pore solution is given by 6 c χ s ρ s based on the volume averaging theory a water heat salt mechanics coupling model for saturated sulfate saline soil exposed to f t cycles was proposed including the mass energy and stress balance equations 4 1 mass conservation equation 4 1 1 moisture conservation equation the f t cycles of sulfate saline soil involve ice water phase change and salt crystallization dissolution which affect the equivalent volumetric moisture content θ eff and can be expressed as zhang et al 2020a 7 θ e f f θ w θ i θ w c where θ w is vwc θ i is the volumetric ice crystal content and θ wc is the volumetric crystal water content the dissolution of the na2so4 crystal and its formation can be expressed by the following general equation 8 n a 2 s o 4 ν 0 h 2 o 2 n a s o 4 2 ν 0 h 2 o where ν0 corresponds to the number of water molecules in the crystalline hydrate only one type of salt and salt crystal mirabilite na2so4 10h2o was considered so ν0 10 the volumetric crystal water content can be expressed as 9 θ w c 10 θ c m w m c ρ c ρ w where m α is the molar mass of α phase based on the concept of equivalent water content the moisture conservation equation can be established from the equation of linear momentum balance for the liquid and the mass balance equation of water which can be expressed as harlan 1973 lai et al 2014 nishimura et al 2009 10 ρ w θ w t ρ i θ i t t 10 m w m c θ c ρ c ρ w v w the equation of the linear momentum balance for moisture was given by nassar and horton 1992 nassar et al 1992 11 v w j w ρ w d θ w θ w d t t k θ w k where jw is the water flux d θ w is the isothermal liquid diffusivity dt is the thermal liquid diffusivity k θ w is the hydraulic conductivity of the soil k is the vertical unit vector and t is temperature substituting eq 11 into eq 10 the moisture balance equation can be written as 12 ρ w θ w t ρ i θ i t t 10 m w m c θ c ρ c ρ w d θ w θ w d t t k θ w considering the effects of ice water phase change and salt crystallization dissolution the extended model of the vwc in freezing sulfate saline soil can be expressed as zhang et al 2020a 13 θ w n θ c t f t t c n θ c θ i n θ c θ i θ w r θ w a θ w r e c 1 t t f θ w r θ w a θ w r e c 1 t t f n θ c θ i θ w r θ w a θ w r e c 1 t t f where θ w r represents the residual vwc θ w a is the initial vwc in the unfrozen soil c 1 is an experimental parameter reflecting the rate of decay tf is the freezing temperature and tc is the primary crystallization temperature of the pore solution the following parameters were determined θ w r 0 05 and c 1 0 16 c 1 the primary crystallization temperature of the pore solution is the temperature at which the salt first meets the threshold value of salt crystal growth which can be expressed as 14 t c t u a u a s t a r t where ua is the supersaturation u a start is the threshold value for salt crystal growth usually u a start 1 for salt crystallization but u a start 1 once the primary crystallization process begins koniorczyk 2012 based on phase change theory the freezing point of saline soil can be written as xiao et al 2022 15 t f t 0 r t 0 l n a w v m i δ s m 2 γ i l c o s θ r δ s m where t 0 and tf are the freezing temperatures of the pure water and saline soil respectively vmi is the molar volume of the ice crystal δsm denotes the entropy of fusion per unit volume of ice crystals γ il is the surface energy of the ice liquid interface while r is the mean curvature radius and θ is the contact angle under the action of f t cycles the ice and salt crystals formed in the pores of sulfate saline soil impede water migration and reduce the hydraulic and diffusion coefficients of the soil therefore the impedance factor i is introduced to determine the effect of ice and salt crystals on water transport bai et al 2020 newman and wilson 1997 16 i 10 10 θ i θ c the hydraulic and diffusion coefficients of sulfate saline soil subjected to f t cycles can be given as watanabe and flury 2008 zhang et al 2017 17 k θ w k θ i 18 d θ w d θ i where k θ and d θ are the intrinsic hydraulic conductivity and intrinsic diffusion coefficient 4 1 2 solute conservation equation salt exists in two phases in porous media dissolved salt and salt crystals the hygrothermal properties of porous materials are substantially affected by salt migration and crystallization dissolution the solute conservation equation including the effect of salt migration and crystallization dissolution can be written as bear and bachmat 1990 19 θ l c t ρ c θ c t ρ s v s the flow velocity of the solute concerning convection and diffusion can be given by 20 v s j s ρ s 1 ρ s c v w d s h c where js is the solute flux and dsh is the diffusion coefficient in a porous medium which can be expressed as nguyen et al 2008 21 d s h d c τ n 0 s l 1 6 where d c is the diffusion coefficient in a non dilute solution and τ is the direction dependent tortuosity of the porous material substituting eqs 20 and 21 into eq 19 the solute balance equation can be expressed as 22 θ l c t c v w d c τ n 0 s l 1 6 c ρ c θ c t 4 1 3 salt crystals conservation equation based on the hypotheses mentioned above the salt crystals mass balance equations neglecting their movement can be described as wu et al 2015 zhang et al 2020a 23 ρ c θ c t m c t where mc is the mass of salt crystals according to the gibbs theory the supersaturation of the salt solution is necessary for nucleation the driving force for salt crystallization is the difference between the chemical potentials of the pore solution and salt crystals δμ when considering only one type of salt sodium sulfate na2so4 and one type of salt crystal mirabilite na2so4 10h2o the driving force can be expressed as espinosa et al 2008 24 δ μ r t l n a n a a n a 0 2 a s o 4 2 a s o 4 2 0 a w a w 0 10 l n u a where a n a a s o 4 2 and aw represent the activities of cations anions and water in a given solution respectively a n a 0 a s o 4 2 0 and a w 0 are the activities of cations anions and water in the solution in the equilibrium state respectively r is the gas constant t is the temperature the saturation degree of the solution ua is given by butler et al 2016 marion and kargel 2007 25 u a k k 0 exp l n k l n k 0 where k is the ion activity product and k 0 is the solubility product in this model the calculated ion activity product k is compared to the solubility product to ascertain whether the solution is undersaturated k k 0 saturated k k 0 or supersaturated k k 0 the ion activity product of the solution can be expressed as marion and kargel 2007 26 k a n a 2 a s o 4 2 a w 10 a n a 2 s o 4 10 h 2 o where a n a 2 s o 4 10 h 2 o is the activity of mirabilite and a n a 2 s o 4 10 h 2 o is equal to 1 for the pure solid phase the frezchem model is an equilibrium chemical thermodynamic model parameterized for concentrated electrolyte solutions employing the pitzer approach for a temperature range of 60 25 c marion and farren 1999 marion and kargel 2007 the model can simulate the crystallization and dissolution of sodium sulfate over a temperature range of 23 25 c butler et al 2016 wang et al 2022 the solubility product k 0 can be calculated using the frezchem model 27 l n k 0 a 1 j a 2 j t a 3 j t 2 a 4 j t 3 a 5 j t a 6 j ln t a 7 j t 2 a 8 j t 4 whose parameters aij i 1 8 depend on the salt type the modified salt crystallization dissolution kinetics model of sulfate saline soil based on the theoretical model of supersaturation can be described as espinosa et al 2008 28 m c t c s k sc u a u a start n sc u a u a start and c s 0 c c k cs 1 u a n cs u a 1 and c c 0 where ksc and kcs denote the salt crystallization and dissolution rate constants respectively nsc and ncs are material parameters it is noteworthy that the first term in eq 28 denotes the process of salt crystallization ua u a start and cs 0 whereas the second term in eq 28 represents the dissolution process of salt crystals ua 1 and cc 0 4 2 energy conservation equation the energy conservation equation considering the latent heat released by ice water phase change and salt crystallization dissolution and the variation of energy caused by the mass transfer of each component has the following form bear and bachmat 1990 tan et al 2011 wu et al 2015 zhang et al 2020a 29 t ρ m e f f c p m e f f t ρ w c p w t ρ s c p s t q m e f f q w q s v w ρ w c p w t v s ρ s c p s t l w i m i t l s c m c t 0 where ρ m eff is the equivalent density of the solid phase c pm eff and c pα are the equivalent heat capacities of the solid phase and α phase respectively q m eff qw and qs are the heat fluxes of the solid phase soil particles ice crystals and salt crystals unfrozen water and solute respectively lwi and lsc are the latent heats of water and salt crystallization respectively the total heat flux qt can be expressed as 30 q t q m e f f q w q s λ e f f t where λ eff is the effective thermal conductivity the effective specific heat capacity and effective thermal conductivity concerning the influence of the content change of each component can be given by nishimura et al 2009 31 ρ e f f c p e f f 1 n ρ m c p m θ i ρ i c p i θ c ρ c c p c θ w ρ w c p w θ s ρ s c p s 32 λ e f f λ m 1 n λ i θ i λ c θ c λ w θ w λ s θ s where ρ eff is the equivalent density of the porous medium c p eff is the effective specific heat capacity and λα is the thermal conductivity of α phase substituting eqs 30 32 into eq 29 the energy conservation equation can be expressed as 33 ρ e f f c p e f f t t λ e f f t v w ρ w c p w t v s ρ s c p s t l w i m i t l s c m c t 4 3 mechanical equation 4 3 1 equilibrium equation the developed water heat salt related mechanics model is under a cylindrical coordinate system as the boundary conditions of the sample are symmetrical along the centerline assumed that the compression is positive in soil mechanics the equilibrium equation in an incremental form can be expressed as huang and rudolph 2021 lai et al 2009 shen and ladanyi 1987 34 t δ σ δ f 0 where denotes the differential operator matrix and r 0 z 1 r 0 z r 0 t σ denotes the stress vector and σ σ r σ z σ rz σ θ t f denotes the body force vector and f fr fz t 4 3 2 strain displacement relations the strain displacement relation of soil in incremental form based on the assumption of small strains can be given as lai et al 2009 li et al 2015 35 δ ε δ u where ε is the strain vector and ε ε r ε z ε rz ε θ t u is the displacement vector and u ur uz t 4 3 3 constitutive equation the stress strain relationship in an incremental function under external loads can be given as huang et al 2022 lai et al 2009 li et al 2015 36 δ σ d t δ ε δ ε vp δ ε v where dt is the matrix of elastic moduli and d t e t 1 ν t 1 ν t 1 2 ν t e t ν t 1 ν t 1 2 ν t e t ν t 1 ν t 1 2 ν t e t 1 ν t 1 ν t 1 2 ν t 0 e t ν t 1 ν t 1 2 ν t 0 e t ν t 1 ν t 1 2 ν t 0 0 e t ν t 1 ν t 1 2 ν t e t ν t 1 ν t 1 2 ν t e t 2 1 ν t 0 0 e t 1 ν t 1 ν t 1 2 ν t et is the elastic modulus ν t is poisson s ratio δε δε vp and δε v are the total viscoplastic and salt expansion and frost heave strains increment vectors respectively in a multi dimensional stress state the viscoplastic strain rate can be expressed as lai et al 2009 37 d ε vp γ t φ f q σ where γ t denotes the viscosity parameter q is the plastic potential function and φ f is a scalar function defined as lai et al 2009 li et al 2015 38 φ f φ f 0 φ f 0 φ f 0 and 39 φ f f f 0 f 0 where f is the yield function and f 0 is the yield stress the drucker prager yield criterion matched to the mohr coulomb criterion was applied in this study and 40 q σ f σ f σ r f σ z f σ r z f σ θ t for sulfate saline soil with a high salt content the primary salt crystallization temperature of the pore solution is significantly higher than that of freezing the volume increase was caused only by salt migration and crystallization before freezing meanwhile when the temperature reached the freezing point the volume increase was attributed to water and salt migration and alternate crystallization in addition the influence of cold shrinkage was neglected the volume increase of sulfate saline during f t cycles can be expressed as 41 ε v ε v salt ε v ice 0 θ c θ l n 0 θ c θ i θ l n 0 t t c t f t t c t t f where ε v ε v salt ε v ice are increased volumes caused by water and salt migration and crystallization salt migration and crystallization and water migration and ice water phase change respectively for a cylindrical coordinate system constraining the horizontal displacement in the radial direction and the vertical displacements at the bottom of the sample the relationship between ε v and ε v can be written as 42 ε v ε v 3 0 1 2 ν t 1 ν t 0 0 t the basic water heat salt mechanics related parameters in the proposed coupled model are as follows li et al 2015 zhang et al 2017 bai et al 2020 43 e t a 1 b 1 t f t c 1 t t f a 1 t t f 44 ν t a 2 b 2 t f t c 2 t t f a 2 t t f 45 c t a 3 b 3 t f t c 3 t t f a 3 t t f 46 ϕ t a 4 b 4 t f t c 4 t t f a 4 t t f 47 k θ a 5 θ w b 5 48 d θ a 6 θ w b 6 where et is the elastic modulus ν t is poisson s ratio ct is the cohesion ϕ t is the angle of internal friction a i i 1 6 b i i 1 6 and c i i 1 4 are the experimental parameters the corresponding coefficients for the equations are listed in table 2 eqs 12 22 23 and 33 36 constitute the water heat salt mechanics coupling model of saturated sulfate saline soil subjected to f t cycles the governing equations are composed of the mass conservation moisture solute and salt crystal balance equations energy conservation and force equilibrium equations 5 model implement 5 1 finite element algorithm the proposed water heat salt mechanics coupling model is highly nonlinear because the coefficients in the governing equations vary with time and they affect each other the governing eqs 12 22 23 and 33 36 are discretized in space to solve the developed model using the finite element method these equations were solved using comsol software the above mentioned equations can be written as 49 d a ζ t γ h where ζ indicates a variable in the governing equations and ζ θ eff θ s θ c t u da denotes the damping coefficient γ is the flux vector and h is the source term generalized solution to eq 49 could be given in the form zhang et al 2016 50 d a ζ t ζ ω γ ζ ω h ζ ω where ζ is the virtual primary variable eq 50 can be written as 51 d a ζ t ζ ω γ ζ ω h ζ ω n γ ζ ω the time terms are discretized by using the backward euler difference method as follows 52 ζ t ζ i ζ i 1 δ t where the superscript i refers time i ω is the calculated domain ω is the boundary of the domain and n is the outward norm vector of the boundary substituting eq 52 into eq 51 gives 53 d a ζ i ζ i 1 δ t ζ ω γ ζ ω h ζ ω n γ ζ ω 5 2 initial and boundary conditions the initial condition can be expressed as lai et al 2014 54 ζ x y z 0 ζ 0 where ζ 0 is a known function of time or a prescribed value of the variable ζ at the initial time boundary conditions in above model including the dirichlet and neumann boundary conditions can be written as zhang et al 2020a 55 n γ g π ζ μ t where n is the outwards normal unit vector of the boundary g is the source term at the boundary π ζ t is the matrix of the elastic constraint and μ is the matrix of the lagrange multiplier specifically π 0 denotes the neumann boundary condition 6 numerical validation based on the experimental data of the f t cycles of saturated sulfate saline soil a numerical simulation of the f t cycles was conducted by employing the water heat salt mechanics coupling model proposed in this study the validity of the model was verified by comparing the calculated results with experimental data 6 1 calculation parameters and conditions the validity of the developed model is demonstrated by comparing it with the test data using sample s3 as a case study table 3 lists the numerical simulation primary parameters the data represented by superscript a b c d are from lai et al 2014 zhang et al 2020a castellazzi et al 2013 2016 wu et al 2015 marion and kargel 2007 and xiao et al 2022 respectively fig 8 shows an axisymmetric computation model in which ab is the symmetry axis the initial and boundary conditions are given by 1 the seepage boundary conditions ad and cd are impervious boundary conditions the supplied sodium sulfate solution equals the initial pore solution through the boundary bc 2 thermal boundary conditions cd is the thermal isolation boundary and ab is subjected to the cyclic f t temperature as shown in eq 1 bc temperature remains unchanged after decreasing from initial value to predetermined temperature and t bc 4 0 c the initial temperature field of the soil sample is uniform with t t 0 8 0 c 3 mechanical boundary conditions bc and cd radial displacements were constrained and bc vertical displacement was set to 0 6 2 variations of temperature vwc and concentration analyzing the variations of vwc and concentration with temperature is beneficial for studying the spatial temporal distribution of solutes during f t cycles and helps reveal the mechanism of salt accumulation and soil salinization of sulfate saline soil subjected to f t cycles as shown in fig 9 sample s3 is taken as a case study to compare the calculated results with test data to verify the effectiveness of the proposed model from fig 9 the predicted temperature vwc and concentration values closely match the test data the results show that the proposed coupling model can describe the dynamic interaction of water heat salt in sulfate saline soil during f t cycles scholars have explored the influence of salinity and salt types on vwc in saline soil during f t cycles however they cannot theoretically analyze the coupling effects of ice water phase change and salt crystallization dissolution on vwc during the freezing period water freezes into ice increasing the concentration of pore solution and intensifying salt crystallization and precipitation conversely salt crystallization will consume unfrozen water and promote water freezing as solute concentration decreases the alternation crystallization of ice and salt aggravates the decrease in vwc and solute concentration the mutual promotion between ice melting and salt crystal dissolution during the thawing stage is similar to the freezing process and will not be repeated as shown in fig 9 b similar test data were reported by lai et al 2017 and wu et al 2018 the extension model of vwc can describe the variation of unfrozen water in sulfate saline soil during f t cycles considering the interaction between ice water phase change and salt crystallization dissolution scholars attempt to analyze the concentration variation of pore solution in sulfate saline soil during f t cycles based on the relationship between the solubility of sodium and temperature however the formula is valid only above 0 c therefore using empirical formulas to describe the crystallization and dissolution characteristics of ideal dilute solutions may be incorrect koniorczyk 2012 zhang et al 2021 based on the pitzer model the frezchem model theoretically analyzes the saturation of sodium sulfate solution from the perspective of chemical thermodynamics equilibrium during f t cycles from eq 25 the calculated ion activity product is compared to the solubility product to ascertain whether the solution is supersaturated saturated or undersaturated from fig 9 c the calculated solute concentration correlates with the experimental data indicating the salt crystallization dissolution kinetics model employing the frezchem model can illustrate the salt crystal growth and dissolution in sulfate saline soil exposed to f t cycles the theoretical analysis of the saturation degree of sodium sulfate solution using the frezchem model avoids errors in empirical formula calculations 6 3 salt expansion and dissolution settlement fig 10 illustrates the soil displacement and residual deformation variations of sample s3 experiencing f t cycles the calculated results correlate well with the experimental data indicating that the developed coupling model in this study can illustrate the deformation property of sulfate saline soil during f t cycles from eq 41 the increased volume generated by water and salt migration ice water phase change and salt crystallization dissolution can be divided into two parts one part is frost heave caused by water migration and ice water phase change the other part is salt expansion caused by salt migration and salt crystallization dissolution the increased volume will separate soil particles and induce deformation caused by salt expansion and frost heave as shown in fig 10 a ice and salt crystals are formed by heterogeneous ice nucleation in a supercooled solution and salt crystallization in a saturated solution during freezing leading to the deformation of salt expansion and frost heave caused by the effective stress change water and solute migration provides the material sources for crystallization induced soil deformation it is evident that the salinity in the frozen layer increases along with water and salt migrating towards the frozen layer from the underlying soil during f t cycles therefore the deformation of sulfate saline soil with high salinity increased gradually with increasing f t cycles until it reached a stable state during the thawing period the salt improves the cementation between the soil particles enhancing the shear strength to a certain extent higher salinization improves the arrangement of the soil structure and significantly impacts instantaneous volume change behavior wang et al 2020 from fig 10 b sample s3 had a marked dissolution deformation in the melting stage forming a noteworthy residual deformation substantial amounts of salt accumulating above the freezing front caused by convection and diffusion reduce soil permeability and hinder water and salt migration therefore the residual deformation of sulfate saline soil decreases with increasing f t cycles and the deformation of salt expansion and frost heave tends to be stable fig 10 the correlation between the calculated results and the measured temperature vwc concentration and soil displacement data of sample s3 subjected to f t cycles is presented in fig 11 noticeably the overall performance of the proposed model in terms of water heat salt mechanics interaction simulation can be regarded as acceptable given the multi field coupled process in such a challenging environment even through discrepancies exist during certain periods for the proposed water heat salt mechanics coupling model the consistency between the calculated and measured temperature vwc concentration and soil displacement data was satisfactory indicating the capability of the proposed model to portray the coupling effect of water and salt transport heat transfer ice water phase change salt crystallization dissolution and the deformation caused by salt expansion and frost heave of sulfate saline soil during f t cycles 7 discussion 7 1 effect of initial salt content on the spatial temporal distribution of solute fig 12 presents the salt distribution of samples s3 and s4 after the 5th f t cycle the calculated results are consistent with the experimental data as shown in fig 12 the maximum salt content above the freezing front of samples s3 and s4 increased by 4 61 and 4 92 respectively compared with the initial values the salt contents in the frozen zone and the unfrozen area adjacent to the freezing front of samples s3 and s4 significantly increased although the salt contents in the top layer remained unchanged fig 13 illustrates the spatial temporal distribution of the solutes of samples s3 and s4 experiencing f t cycles many researchers adopt stratified sampling to study the mechanism of salt migration in saline soils during f t cycles but fail to describe the spatial temporal distribution of solutes based on the established coupling model and experimental data the influence of salt contents on the spatial temporal distribution of solutes in sulfate saline soil exposed to f t cycles under an opened system was analyzed the f t processes affect the hydrothermal cycles and solute transport resulting in water and salt redistribution during the freezing process the water and temperature potential gradients between the frozen and unfrozen layers were relatively high which could cause water to migrate from the unfrozen zone to the freezing front solute in the pores of the unfrozen area migrates together with soil water towards the frozen layer leading to salt accumulation above the freezing front and reducing solute concentration in the unfrozen zone as shown in fig 12 when water and solute are continually supplied to the frozen layer by capillary action the solute will abundantly accumulate in the frozen area as the freezing front penetrates downwards the solute concentration in the frozen zone reached the solubility resulting in salt precipitation in the form of subflorescence during thawing water and salt migrate downwards to the unfrozen zone from figs 12 and 13 results showed that the amount of salt migration upward during freezing is larger than that of downward transport during thawing salt accumulation above the freezing front increases with increasing f t cycles and similar test data were reported by lai et al 2017 and wu et al 2018 meanwhile diffusion occurred in the opposite direction owing to the development of concentration gradients during freezing resulting in the formation of a salt enrichment layer under the freezing front particularly for sample s4 with a higher salt content the results showed that the top layers of samples s3 and s4 did not accumulate and precipitate additional salt in the form of efflorescence compared to the initial values after 5 f t cycles although in the opened system therefore a sufficient number of f t cycles is required for the formation of the salinization of the soil surface layer 7 2 effect of water supply conditions and f t times on the spatial temporal distribution of solute fig 14 presents the salt distribution of samples s5 and s6 after the 10th f t cycle from fig 14 the calculated results correlate with the experimental data the maximum salt contents above the freezing front of samples s5 and s6 increased by 8 91 and 4 03 respectively more importantly the salt contents in the top layer of samples s5 and s6 increased by 2 57 and 1 55 respectively under the opened system results showed that the salt content in the unfrozen zone of sample s5 undergoing 10 f t cycles remained unchanged compared with that of s3 fig 14a however under the closed system it is worth pointing out that the salt content at the same location in the unfrozen area of sample s6 after 10 f t cycles is significantly smaller than that of s3 fig 14b how water supply conditions and f t times affect solute redistribution and the salinization of soil surface layer that must be addressed fig 15 shows the spatial temporal distribution of the solutes of samples s5 and s6 experiencing f t cycles under different water supply conditions based on the proposed coupling model the influences of water supply conditions and f t times on the spatial temporal distribution of solute and the salinization of soil surface layer were analyzed as shown in fig 15 a and b under the same test conditions except for different water supply conditions the salinity of the top layer of sample s5 increased significantly compared with that of s6 after 10 f t cycles results indicated that a sufficient number of f t cycles could also cause the salinization of soil surface layer without considering the evaporation effect salt accumulation in the frozen zone during freezing decreased the osmotic potential resulting in noticeable freezing point depressions and higher liquid contents in the frozen layer of soil meanwhile the freezing rate decreases with increasing solute concentration when the cooling rate of soils slows down gradually water and salt will have sufficient time to migrate toward the area near the soil s top layer the solute concentration near the top layer of the soil reached solubility resulting in salt precipitation in the form of efflorescence under the opened system the salt supplement from the bottom and the salt accumulation caused by the previous f t cycle in the frozen and unfrozen layers near the freezing front provides a material source for salt accumulation as a form of efflorescence salt accumulation and precipitation in the top layer will cause a decrease in salt content beneath the freezing front based on salt mass conservation since sample s6 is in the closed system fig 15b meanwhile ignoring the role of evaporation it is worth noting that f t cycles not only increase the salt content in the pores near the freezing front i e subflorescence but also increase the salt content in the soil surface layer i e the salinization of soil surface layer at a certain number of f t cycles e g 10 f t cycles 7 3 feedback mechanism of the spatial temporal distribution of the solute on soil salinization the f t processes of sulfate saline soil have long been recognized for their engineering applications and environmental issues fig 16 illustrates the feedback mechanism of the spatial temporal distribution of the solute on salt accumulation and soil salinization in sulfate saline soil subjected to f t cycles convection and diffusion are the dominant factors for salt migration and accumulation in sulfate saline soil subjected to f t cycles neglecting the effect of evaporation the convection causes salt to migrate upward from the unfrozen zone to the frozen area while the concentration gradient of the pore solution between the frozen and the unfrozen layers drives salt downward the convection and diffusion mechanisms make solute migrate in the opposite direction during freezing and convection is the primary process therefore the amount of salt migration upward is larger than that of downward transport during freezing increasing salt accumulation above the freezing front with increasing f t cycles and aggravating the salinization of soil surface layer meanwhile the water supply condition significantly influences salt migration in sulfate saline soil the replenishment of water and salt supplies the material source for salt accumulation therefore in the f t cycles of sulfate saline soil convection diffusion not only causes salt to accumulate and precipitate in the frozen and unfrozen layers near the freezing front in the form of subflorescence but also leads to salt accumulation and precipitation in the form of efflorescence in the soil surface layer at a certain number of f t cycles ice crystals grow from a supercooled solution through heterogeneous ice nucleation and salt crystals grow from a saturated solution the processes of water freezing into ice and salt crystallization lead to effective stress change and cause the deformation of salt expansion and frost heave the salt content in the frozen zone increases with increasing f t cycles leading to a gradual increase in the deformation of salt expansion meanwhile the amount of salt migration upward during freezing is larger than that of downward transport during thawing forming a significant residual deformation during melting it is worth noting that salt expansion at freezing and residual deformation at thawing gradually stabilize with increasing f t cycles caused by the hindering effects of salt accumulation and precipitation on water and salt migration 8 conclusions and future prospects sulfate saline soil involves the complex coupling effects of water and salt migration heat transfer ice water phase change salt crystallization dissolution and soil deformation during f t processes based on the modified salt crystallization dissolution kinetics model employing the frezchem model we proposed a water heat salt mechanics coupled model for saturated sulfate saline soil subjected to f t cycles considering the effects of ice water phase change and salt crystallization dissolution the influences of the initial salt content water supply condition and number of f t cycles on the water heat salt mechanics dynamic interaction were analyzed the spatial temporal distribution of the solute in sulfate saline soil under different experimental conditions was clearly illustrated we further described the feedback mechanism of the spatial temporal distribution of the solute on salt accumulation and soil salinization finally comparisons of the calculated results with the experimental data validated the effectiveness of the proposed model the following conclusions were drawn 1 the modified salt crystallization dissolution kinetics model employing the frezchem model can theoretically reveal the characteristics of salt crystal growth and dissolution of sulfate saline soil during f t processes 2 convection and diffusion are the dominant factors for the spatial temporal distribution of solutes of sulfate saline soil subjected to f t cycles forming subflorescence in the frozen and unfrozen layers near the freezing front and efflorescence in the soil surface layer at a certain number of f t cycles and aggravating salt accumulation and soil salinization 3 salt migration and accumulation promote salt expansion but the overall deformation characteristics of sulfate saline soil undergoing f t cycles are closely related to the initial conditions such as the initial salt content water supply condition and number of f t cycles 4 the calculated results correlate with the experimental data demonstrating that the proposed water heat salt mechanics coupling model based on crystallization kinetics can illustrate the dynamic interaction of water and salt migration heat transfer ice water phase change salt crystallization dissolution and soil displacement of saturated sulfate saline soil exposed to f t cycles the proposed model in this study can effectively describe the water heat salt mechanics coupling behavior in saturated sulfate saline soil during f t cycles we will further study the mechanisms of water and salt migration and soil deformation to improve the application of the model in unsaturated saline soil this study only focuses on the spatial temporal distribution of sulfate sodium in sulfate saline soil during f t cycles neglecting the multi component soil salts in actual saline soil further research will employ the frezchem model to describe multi component soil salts migration and accumulation characteristics in saline soil exposed to f t cycles f t cycle and evaporation are two control factors for soil salinization to extend the proposed water heat salt mechanics coupling model to a five field water heat salt vapor mechanics coupling model the internal mechanisms of salt migration and accumulation and salt crystallization dissolution in the coupling of f t cycle and evaporation will be further studied furthermore our research will pay close attention to the influences of future climatic uncertainties on soil salinization credit authorship contribution statement jing zhang conceptualization data curation validation investigation writing original draft writing review editing yuanming lai conceptualization writing review editing resources supervision project administration shuangyang li writing review editing mingyi zhang investigation writing review editing zhemin you writing review editing te liang writing review editing declaration of competing interest we confirm that the work described is original research that has not been published previously no conflict of interest exists in the submission of this manuscript acknowledgments this research was supported by the key research program of the chinese academy of sciences grant no zdrw zs 2020 1 the national natural science foundation of china grant nos u2268215 u21a2012 42201154 the national key research and development program of china grant no 2018yfc0809605 the key research program of frontier sciences of chinese academy of sciences grant no qyzdy ssw dqc015 the program of the state key laboratory of frozen soil engineering grant no sklfse zq 60 
17,freshwater discharge into an estuary can affect its horizontal density gradients water column stratification and subtidal circulation an incomplete understanding of the effects of river discharge on tidal and subtidal flows motivates this study the focus is on how river discharge effects translate into temporal variations in velocity asymmetries within a microtidal estuary with mixed tides in particular this study quantifies the relative contribution of overtides compound tides and subtidal flows to velocity asymmetries by modifying the method proposed by nidzieko 2010 quantification is carried out with a three dimensional hydrodynamic model and the modified method is applied in a microtidal estuary with mixed tides numerical simulations show that the upper estuary toward the river responds differently from the lower estuary toward the ocean to changes in freshwater discharge throughout the estuary the horizontal salinity density gradient tends to migrate to the lower estuary as river discharge increases in the upper estuary subtidal flows become vertically unidirectional mainly because fresh water displaces salty water toward the lower estuary in the lower estuary the horizontal salinity gradient increases with a corresponding enhancement of the baroclinic circulation exchange flow estimates of velocity asymmetries show that the interaction between subtidal flows and semidiurnal tidal flows is the main contributor to the asymmetries as freshwater discharge increases changes in the velocity asymmetry manifest as attenuated interactions between semidiurnal and diurnal flows and enhanced interactions between semidiurnal flows and subtidal flows keywords river discharge velocity asymmetry subtidal flow tidal propagation caloosahatchee river estuary data availability data will be made available on request 1 introduction major drivers in estuarine hydrodynamics include tides and fluvial discharges plus their interactions tides may act as a barrier to river discharge sassi and hoitink 2013 riverine flow attenuates or magnifies tidal oscillations by altering frictional effects e g godin 1985 jay and flinchem 1997 leonardi et al 2015 moreover fresh water from rivers influences mixing processes and the water density distribution while affecting flushing and residence times of different parts of the estuary the discharge also affects the transport and dispersion of dissolved and suspended matter such as sediments nutrients and contaminants e g pritchard 1955 friedrichs and aubrey 1988 hoitink et al 2017 extensive efforts to study river tide interactions have been devoted to the effects of river discharge on barotropic tidal propagation e g godin 1999 hoitink and jay 2016 laurel castillo and valle levinson 2020 these efforts have implemented data analysis analytical solutions and numerical modeling one approach in these studies has been to apply continuous wavelet transform to water level signals and highlight the role of river discharge in redistributing the spectral energy of tides e g jay and flinchem 1997 guo et al 2015 other studies have revealed that high discharge events may increase the tidal current amplitude when the flow is river dominated and unidirectional no tidal reversal i e seaward during both ebbs and floods and decrease the tidal current amplitude when the flow is tidally dominated and bidirectional landward during floods and seaward during ebbs leonardi et al 2015 analytical solutions of tidal wave propagation in a fluvial estuary are typically derived from the shallow water equations with linearized bottom friction and negligible advection e g savenije 1998 godin 1999 analytical solutions show that river discharge can cause tidal damping in the upper reach of an estuary e g horrevoets et al 2004 cai et al 2012 2014 numerical modeling studies have been conducted on tidal river interactions worldwide guo and valle levinson 2007 investigated the dynamic response of the chesapeake bay to river discharge and tidal forcing their study highlighted the role of tidal forcing in organizing the vertical structure of the outflow plume and the horizontal variations in exchange flow sandbach et al 2018 explored the river tide interactions and net sediment transport they found that increasing river discharge reduced the extent of the flood directed flow and sediment transport in the columbia river estuary surya et al 2019 revealed that the increase of river discharge might amplify the diurnal tidal component and inundation areas of the lower estuary in jakarta bay indonesia however numerical simulations showed a decreasing trend of m2 and k1 tides with increasing discharge in the yellow river delta ji et al 2020 while numerous studies have been carried out on tidal dynamics in estuaries no attention has been paid to the effects of river discharge on the velocity asymmetry especially in microtidal estuaries where the fluvial discharge plays a prominent dynamical role an instantaneous velocity profile in estuaries features contributions from astronomic tides shallow water tides and subtidal processes flows with longer periods than the tides the velocity asymmetry is referred to as the periodic difference between a the peak flood and peak ebb velocities or b the duration of ebb and flood currents this asymmetry depends on tidal tidal velocity asymmetry and non tidal oscillations the intensity and direction of subtidal flows subtidal flows are induced mainly by river discharge non linear tidal distortion water density gradients wind atmospheric pressure and wind waves e g naimie et al 2001 valle levinson et al 2009 2019 they can be vertically sheared three dimensional or vertically uniform two dimensional and exhibit spatial and temporal variations in response to river pulses valle levinson 2012 within one tidal cycle tidal asymmetry in semi diurnal estuaries is related to overtides dronkers 1964 pugh 1987 dyer 1997 that arise from distortions to tides in shallow waters in diurnal and mixed diurnal estuaries tidal velocity asymmetries might arise from the interaction mainly between the k1 o1 and m2 s2 and n2 tidal constituents hoitink et al 2003 nidzieko 2010 several indexes have been used to quantify tidal velocity asymmetries guo et al 2019 the tidal duration asymmetry describes differences in ebb and flood intervals whereas the tidal velocity asymmetry or tidal velocity skewness reflects the difference between the peaks of flood and ebb tidal currents in regions dominated by semidiurnal tides tidal asymmetry is typically quantified by the m4 to m2 amplitude ratio friedrichs and aubrey 1988 and their relative phase difference e g hoitink et al 2003 olabarrieta et al 2018 in mixed diurnal semidiurnal tidal regimes the tidal velocity asymmetry can be evaluated using the tidal velocity skewness parameter proposed by nidzieko 2010 the studies above focused on the tidal velocity asymmetry i e the asymmetry related exclusively to tides however the focus here is on asymmetries between peak flood and ebb currents influenced by the strength and direction of subtidal flows this interaction will be herein referred to simply as velocity asymmetry the influence on velocity asymmetries can be affected by subtidal flows with a two or three dimensional structure the main goal of this study is to better understand the effects of river discharge on the overall circulation structures of a micro tidal estuary with particular attention to velocity asymmetries the goal is addressed with numerical simulations by modifying the method of nidzieko 2010 by including subtidal flows in calculating the velocity skewness as a test case we apply this method in the caloosahatchee river estuary florida a micro tidal and mixed diurnal semidiurnal estuary located on the southwest coast of florida the rest of the paper is organized as follows section 2 presents information on the study site the methods used in the study are shown in section 3 the effects of river discharge on tidal elevation and current amplitudes subtidal flows and velocity asymmetries are described in sections 4 1 4 3 respectively the effects of bottom friction are shown in section 4 4 results are discussed in sections 5 and 6 summarizes the main conclusions of the present work 2 study site the caloosahatchee river estuary the caloosahatchee river estuary is located on the southwest coast of florida fig 1 it mainly encompasses the caloosahatchee river and the lower estuary of san carlos bay the caloosahatchee river estuary is connected to the charlotte harbor estuary through matlacha pass and pine island sound zheng and weisberg 2004 conducted a numerical study on the circulation features within the charlotte harbor estuary located north of the caloosahatchee river estuary their study concluded that the flow and salinity fields respond to a combination of tide rivers and wind they also showed that charlotte harbor and san carlos bay show independent circulation behavior dye et al 2020 applied a two dimensional hydrodynamic model to the southwest florida coast and demonstrated the flush dominance in four major inlets within the estuary system however the dynamic response of the estuary to variations in the caloosahatchee river discharge remains poorly understood the geometry of the caloosahatchee river estuary is irregular with a width ranging from 160 m in the upper portion to 2500 m near its mouth scarlatos 1988 the volume of the estuary shell point upstream to s 79 is approximately 105 106 m3 stoker 1992 the caloosahatchee river is the primary source of fresh water to the estuary the river extends 67 km from lake okeechobee to the franklin lock and dam s 79 which marks the beginning of caloosahatchee river estuary and runs 42 km from s 79 to shell point chamberlain and doering 1998 sun et al 2016 the mean depth of the caloosahatchee river channel is approximately 5 m from beautiful island to shell point fig 1 the discharge of the caloosahatchee river is influenced by two sources one from its watershed and the other via regulatory releases from lake okeechobee doering and chamberlain 1999 in conjunction with a subtropical climate the caloosahatchee river discharge shows seasonal variations with values ranging from 0 m3 s during dry seasons up to 800 m3 s in wet seasons the lower estuary comprises the san carlos bay and southern portions of the pine island sound and matlacha pass it is characterized by complex bathymetry with multiple channels and shallow bays it provides a wide range of habitats for aquatic organisms such as tape grass oysters manatees and dolphins e g chamberlain and hayward 1996 doering et al 2002 barnes 2005 the caloosahatchee river estuary is a micro tidal estuary with a spring tidal range of less than 1 m through its 5 km opening to the ocean the lower estuary undergoes interactions between riverine and tidal flows astronomical tides exhibit a mixed mainly semidiurnal type with form factors ranging from 1 to 1 5 goodwin 1996 dye et al 2020 tidal influence can be far reaching and allow salt water to intrude up to the head of the estuary at s 79 during dry seasons tides and saltwater intrusions can be overwhelmed by river discharge during wet seasons sun et al 2016 3 methods in this section we describe the numerical model used to analyze the effects of river discharge on velocity fields and asymmetries the setting of the numerical model the experimental design and the model verification also described are the methods used to separate tidal oscillations from subtidal flows and the equations used to compute velocity asymmetries 3 1 model description setup and experimental design the regional ocean modeling system roms is a three dimensional ocean circulation model that solves the reynold averaged navier stokes rans equations using hydrostatic and boussinesq assumptions with a split explicit time stepping algorithm haidvogel et al 2000 2008 shchepetkin and mcwilliams 2005 the governing equations are discretized horizontally over an arakawa c grid and vertically over a terrain following sigma coordinate system using a centered second order finite difference approximation the momentum conservation equations solve by roms and written in a cartesian coordinate system are 1 h z u t u h z u x ν h z u y ω h z u s f h z v h z ρ 0 p x h z g η x s u ω ν h z u s 2 h z v t u h z v x ν h z v y ω h z v s f h z u h z ρ 0 p y h z g η y s v ω ν h z v s 3 0 1 ρ 0 p s g ρ 0 h z ρ with the continuity equation expressed as 4 η t h z u x h z v y h z ω s 0 and scalar transport presented as 5 h z c t u h z c x v h z c y ω h z c s s c ω ν h z c s c s o u r c e equations 1 5 are closed by parameterizing the reynolds stresses and tracer turbulent fluxes as u ω k m u z v ω k m v z c ω k c c z at the water surface k m u z τ s x k m v z τ s y at the water bottom k m u z τ b x k m v z τ b y here hz is the vertical stretching factor u v and ω u v and ω are the velocity components and perturbations respectively x y and s indicate the horizontal and vertical sigma coordinates p and η are pressure and wave averaged free surface elevation c c and csource represent the tracer scalar perturbation and source sink respectively ν is molecular viscosity ρ and ρ0 are total and reference densities eddy viscosities km and diffusivities kc can be parameterized using the generic length scale model described by warner et al 2005 τ s and τ b represents surface and bottom stresses in this study we apply roms to the area of the caloosahatchee river and estuary the modeling domain encompasses the charlotte harbor portion in the north and the san carlos bay portion in the south with the western boundary extending to the west florida shelf fig 1 the modeling grid has an adaptive horizontal grid size ranging from 300 m offshore to 10 m in the inner estuary and inlets to better resolve the water density field we use 12 terrain following vertical layers that provide a vertical resolution of 0 1 m in the shallowest areas of the estuary the bathymetry and topography data are obtained from a combination of noaa s continuously updated digital elevation model cudem with 1 9 arc second resolution cooperative institute for research in environmental sciences and usgs s lidar dem southwest fl in 2018 with 0 5 m spatial resolution https www fisheries noaa gov inport item 59010 at the open boundaries free surface elevation current velocity water temperature and salinity are interpolated from the output of the hybrid coordinate ocean model with naval research lab nrl coupled ocean data assimilation in the gulf of mexico hycom ncoda gulf of mexico which has spatial and temporal resolutions of 1 25 and 1 h respectively periods with missing boundary data are filled with the coawst modeling results from the u s geological survey usgs to enforce hycom external fields to roms the chapman implicit boundary condition chapman 1985 is applied to the surface elevation which assumes all outgoing cross boundary waves propagate as non dispersive shallow water waves the analogous flather boundary condition flather 1976 is imposed to barotropic velocities which allows the deviations from exterior values to radiate out of the boundary at a speed of the external shallow water waves the radiation boundary condition orlanski 1976 raymond and kuo 1984 is imposed to baroclinic velocities water temperature and salinity details regarding the implantation procedures of each open boundary condition can be referred to marchesiello et al 2001 marsaleix et al 2006 stress in the bottom boundary layer is parameterized by a logarithmic profile with a bottom roughness z 0 of 0 0015 m for sub grid vertical mixing eddy viscosity and diffusivity the turbulence model with generic length scale approach is applied warner et al 2005 which in this application resembles a k ε turbulence model regarding the atmospheric forcing inputs 10 m wind speed atmospheric pressure at mean sea level 2 m air temperature relative humidity and short and long wave radiation are specified with hourly values from the high resolution rapid refresh hrrr model at a 3 km spatial resolution https home chpc utah edu u0553130 brian blaylock cgi bin hrrr download cgi missing rainfall inputs are replaced with results from the global forecast system model https www ncei noaa gov products weather climate models global forecast the bulk flux algorithm of coare 3 5 edson 2013 is applied to estimate the momentum and heat fluxes from the air to the sea surface freshwater sources within the model domain are imposed via horizontal velocities crossing the land water mask boundary at specified inflow cells a total of 11 rivers and creeks dark blue triangles in fig 1 are considered freshwater source points including the three major rivers myakka river peace river and caloosahatchee river river and creek discharge values are derived from national water model hourly streamflow reanalysis data discharge values of the caloosahatchee river are specified with historical measurements at usgs station s 79 simulations are initialized on the 1st of january 2021 at 00 00 00 utc and run until the 31st of january 2021 at 23 00 00 utc water surface elevations 3 dimensional water temperature and salinity in the inner shelf are initialized with extrapolations from hycom gom model outputs and real time observations at four stations purple triangles in fig 1 of the river estuary and coastal observing network recon from sanibel captiva conservation foundation sccf https recon sccf org to investigate the effects of caloosahatchee river discharge on the water circulation patterns in the caloosahatchee river estuary we consider two modeling experiments with discharge values of 5 and 95 percentile of the cumulative density function of the historical river discharge measurements at usgs station s 79 which are 0 5 and 200 27 m3 s respectively to evaluate the river induced modifications in the momentum balance diagnostic outputs of each term in the horizontal momentum equations of roms not shown are saved hourly to exclusively investigate the effects of river discharge on the tidal dynamics atmospheric forcing e g wind and atmospheric pressure and ocean boundary conditions remain unmodified in the model scenarios considered 3 2 model verification tides in the caloosahatchee river estuary are mixed semidiurnal dominant with major constituents of m2 k1 o1 and s2 goodwin and michaelis 1976 zheng and weisberg 2004 to evaluate our model performance simulated tides are compared at 14 locations with predictions from noaa black dots in fig 1 modeled amplitudes and phases of the principal tidal constituents showed good agreement with noaa predicted values at most stations the mean root mean square errors rmses of m2 k1 and o1 tidal elevation amplitudes are 1 9 cm 1 8 cm and 0 7 cm respectively referred to supplementary materials table 1 in the caloosahatchee river estuary tidal signals are well captured with rmse of less than 1 cm and phase differences lower than 20 min e g station punta rassa and fort myers detailed information of the astronomic tidal verification is not shown here for conciseness and can be referred to in the supplementary materials overall the model performance is satisfactory in reproducing the tidal variations in addition to the tidal constituents time series of modeled water surface elevations are compared with water level observations from 4 recon sites fig 1 note that the station shell point from recon shares the same name as a noaa tidal prediction station but lies in a different location as shown in fig 2 modeled water surface elevations agree with the measurements with rmse of 6 7 cm and determination coefficient r2 values of 0 88 0 88 0 92 0 93 respectively in contrast to the station at tarpon bay in the lower estuary fig 1 water level variations at the stations along the river channel fig 2a b and c are similar two time periods near january 13th and january 28th with negative surges triggered by offshore winds are captured at all stations in this model application however water levels are underestimated up to 12 cm during a neap tide around january 19th these discrepancies possibly arise from underestimated water levels at the model boundaries or from overestimated seaward local winds in the atmospheric forcing generally modeled water surface elevations agree with the observed values further model verifications are conducted for water temperature and salinity measured at the same location as water surface elevations fig 3 shows the time series of measured and modeled water temperature and salinity modeled water temperature and salinity were interpolated to the same depth as the sensors which are located close to the bottom except for the beautiful island station measured water temperature variations are quantitatively well reproduced by the model with rmse less than 1 c biases at beautiful island potentially arise from 1 misrepresented surface heat fluxes over river upstream different spatial resolutions of the atmospheric 3 km and ocean 30 m models cause sub grid mismatches of land water mask as a result surface heat fluxes over the narrow 150 m and shallow 2 m upstream area of the river may be flawed this may increase the sensitivity and discrepancies of modeled water temperature 2 bias in river temperature input due to a lack of available observational data during the modeling period river temperature in this model application is set with the monthly averaged historical value of 20 c modeled salinity values are compared with observations rmses are less than 2 g kg at all stations fig 3e h note that the panels in fig 3 have different vertical axis limits particularly at shell point station where the salt and fresh water are dynamically mixed salinity variations up to 15 g kg are simulated well it appears that the overall interaction between the river and the ocean including their mixing are captured successfully by the model at tarpon bay while salinity deviates from 28 g kg by a few units three spikes to 33 g kg during january 25th 28th are resolved by the model at fort myers and beautiful island simulated salinity generally agrees with the observed trends but is underpredicted up to 3 g kg from january 15th to january 25th the overall r2 values for water temperature and salinity are 0 743 and 0 987 respectively fig 3i j inconsistencies of water temperature primarily come from the station of beautiful island as discussed above although inaccuracies exist modeled water temperatures and salinities lie in an acceptable range mean rmse equal to 0 95 c and 1 1 g kg for water temperature and salinity respectively 3 3 tidal decomposition and velocity asymmetry to split the tidal and non tidal oscillations harmonic analysis using the t tide package pawlowicz et al 2002 considering 29 tidal constituents is applied to the modeled surface elevations and current velocities at each computational grid cell non tidal subtidal oscillations are obtained first by subtracting the tidal signals from modeled surface elevation and currents and then applying a low pass lanczos filter duchon 1979 with a cut off period of 25 h the low pass filter is used to eliminate the remnants of periodic tidal oscillations that are not captured by harmonic analysis mean subtidal flow here and after refers to non tidal currents averaged over the whole simulation period regarding the velocity asymmetry the commonly used phase relationship between m2 and m4 tide is not applicable in a mixed mainly semidiurnal tidal regime therefore we adapted the method by nidzieko 2010 to evaluate the distortion of current velocity in the caloosahatchee river estuary specifically we calculate the skewness of current velocity instead of skewness of tidal elevation time derivative used in nidzieko 2010 to quantify the tidal duration asymmetry this adaption is justified since the skewness of velocity directly measures the distortion of the velocity distribution a positive negative velocity skewness indicates that the magnitudes of flood currents are higher lower than the magnitudes of ebb currents as a result the tidal velocity asymmetry γ can be quantified as 6 γ μ 3 σ 3 e v 3 e v 2 3 2 7 v i 0 n v i i 0 n a i cos ω i t ϕ i where μ3 and σ are the third moment and the standard deviation of the velocity v e is the expectation symbol n is the total number of tidal and subtidal constituents vi denotes all contributions to the flow with v 0 representing the subtidal flow ai ω i and ϕ i are tidal current amplitude angular frequency and phase respectively ω i 0 and ϕ0 0 or π for subtidal flow subtidal flows can exhibit a three dimensional structure the value of velocity skewness γ indicates dissimilarities between peaks of flood and ebb currents positive γ indicates a higher flood velocity than ebb velocity which is flood dominance negative γ represents ebb dominance the notations in equation 6 and 7 differ from those in nidzieko 2010 since the quantity v is the sum of tidal and subtidal flow the interaction of subtidal flows with astronomic tides can be included via eq 7 the velocity skewness γ can be computed by substituting eq 7 in eq 6 and taking the time average 8 γ 1 a 0 2 1 2 i 1 n a i 2 3 2 ω i ω j ω k 3 2 a i a j a k cos ϕ i ϕ j ϕ k 2 ω i ω j 3 4 a i 2 a j cos 2 ϕ i ϕ j i 1 n 3 2 a i 2 a 0 cos ϕ 0 a 0 3 cos ϕ 0 the first two terms on the right hand side represent the velocity asymmetry induced by the interactions of astronomical tidal constituents that satisfy the frequency relations ω i ω j ω k and 2ω i ω j referred to as distortions or triad interactions the last term represents interactions between subtidal flows and each tidal constituent relative contributions to velocity asymmetries can be inferred with eq 8 via different combinations of tidal constituents and subtidal flows the derivations of eq 8 are included in appendix a the reader is referred to nidzieko 2010 song et al 2011 and gong et al 2016 for further information about skewness quantified tidal asymmetry 4 results to explore the dynamic responses of the estuary to different freshwater inputs we consider two model scenarios with discharge values of 0 5 m3 s low discharge scenario and 200 27 m3 s high discharge scenario representative of the dry and a wet season respectively results are analyzed in terms of river discharge modifications to tidal elevations and velocity amplitudes section 4 1 salinity gradient and subtidal flows section 4 2 velocity asymmetries section 4 3 and bottom friction section 4 4 focus is on subtidal flows overtides and compound tides triad interactions among semidiurnal and diurnal harmonics because these are the major contributors to the velocity asymmetries 4 1 tidal elevation and velocity amplitudes this section presents a comparison of the tidal elevation and current amplitudes for the two river discharge scenarios considered in the caloosahatchee river estuary results show that changes of tidal elevation amplitudes in the charlotte harbor area are minimal 0 5 cm referred to supplementary material fig s1 increased freshwater inputs mainly affect the area of caloosahatchee river estuary including the main channel of the caloosahatchee river san carlos bay pine island sound and matlacha pass therefore emphasis starting from fig 4 is placed in the southern portion of the estuary system for graphic clarity fig 4 shows modeled tidal elevations amplitudes four tidal constituents k1 o1 m2 and s2 and the modifications under different discharge conditions in terms of different tidal constituents it is evident that semidiurnal and diurnal tidal elevation amplitudes respond differently to the variation of caloosahatchee river discharge for diurnal tides amplitudes of k1 and o1 decrease both in value and in percentage along the river channel and amplify in the lower estuary fig 4a1 a4 and b1 b4 the damping effect up to 30 is more noticeable compared to the amplification 0 5 cm and 5 for semidiurnal tides the most distinct alterations happen to the m2 constituent the amplification up to 15 of m2 extends from the san carlos bay to the matlacha pass pine island sound as well as the upper portion of the caloosahatchee river channel fig 4c1 c4 the modification of s2 elevation amplitude fig 4d1 d4 shows similar patterns as m2 but the variations up to 0 3 cm are moderate compared to the other constituents the tidal elevation amplitude of all the constituents is damped 30 close to the source of fresh water in the high discharge scenario regarding the alterations of tidal velocity magnitude the tidal current constituents show amplification in the lower estuary and reduction along the caloosahatchee river especially in the relatively deeper channels fig 5 only the changes of tidal current amplitude between the two scenarios are presented for conciseness in the area of san carlos bay diurnal tidal magnitudes are amplified up to 35 fig 5e h the m2 constituent shows the largest variation in value 2 cm s but the least in percentage up to 20 and s2 shows the least change in value 0 5 cm s but relatively large in percentage amplification of semi diurnal tidal currents extends from the mouth of san carlos bay to the north of pine island sound and matlacha pass along the caloosahatchee river channel tidal velocity magnitudes and especially the diurnal components reduce by more than 30 fig 5e f this reduction is primarily associated with a 6 cm increase of the mean water level caused by enhanced river discharge not shown this increased mean water level generates a downstream pressure gradient force per unit mass competing with the incoming tide in addition the increased river discharge decreases the diurnal tidal velocities but amplifies the semidiurnal components fig 5g h in the northern portion of pine island sound and the northern end of matlacha pass these two are the farthest points of influence for the caloosahatchee river discharge in this simulation further north changes of all constituents considered are negligible the relatively small modifications of tidal elevations and current amplitudes with respect to different caloosahatchee river inputs indicate weak connections to charlotte harbor estuary through pine island sound and matlacha pass 4 2 salinity gradient and subtidal flows this section describes the effects of river discharge on the redistribution of salinity and on the subtidal flows in the caloosahatchee river estuary depth and time averaged over the whole simulation period salinity distributions under the two discharge scenarios are shown in fig 6 during low discharge the salinity gradient mainly exists along the river channel from 2 to 24 g kg fig 6a when increasing the freshwater discharge the salinity along the river channel decreases dramatically to less than 5 g kg the freshwater dominated area increases and displaces the salinity gradient to the lower estuary fig 6b an increased northwestward salinity gradient develops from the mouth of san carlos bay 32 g kg to the south end of matlacha pass 14 g kg moreover modifications to the salinity gradient are found in pine island sound from 30 to 24 k kg and matlacha pass where salinity is nearly uniform in the low discharge scenario changes in the density gradient alter the horizontal and vertical density distributions and further affect the subtidal flows in different ways in the upper and lower estuary as explained below under low discharge conditions subtidal flows along the river channel are mainly baroclinic into the estuary near the bottom and seaward at the surface with the increase in river discharge the upper part of the estuary becomes river dominated and consequently the subtidal flow becomes vertically unidirectional and seaward in the lower estuary the baroclinic circulation intensifies with the increase of river discharge seaward subtidal flows on the surface and landward subtidal flows near the bottom are strengthened by the increased river discharge fig 7 near the bottom fig 7a c subtidal flows along the river channel increase in the downstream direction with magnitudes exceeding 6 cm s this is because bottom subtidal inflow under low discharge scenario fig 7a reverses to outflow in the high discharge scenario fig 7b in the lower estuary bottom subtidal inflows increase indicated by northwestward arrows fig 7c in the high discharge scenario especially at the mouth of san carlos bay in the area of pine island sound and matlacha pass bottom subtidal flows increase southeastward and northwestward respectively but the changes are relatively small magnitudes 2 cm s compared to those along the river channel near the water surface subtidal flows exhibit stronger alterations in magnitude up to 15 cm s than at the bottom fig 7d f compared to the low discharge scenario fig 7d increased surface subtidal outflows under high discharge fig 7e are found both along the river channel and in the lower estuary relatively larger alterations happen in deeper water pathways depth 3 m in the lower estuary surface subtidal flows at pine island sound increase northwestward in the high discharge scenario in addition the area where baroclinic subtidal flows increase coincides with the area where tidal velocity magnitudes amplify fig 5 the vertical structure of subtidal velocity profiles evolves differently in time according to position along the estuary fig 8 an upstream location in the caloosahatchee river p1 fig 1 is directly impacted by the freshwater input in the middle of san carlos bay p2 fig 1 fresh and salty waters mix at p1 fig 8a c two layer subtidal flows are observed under low river discharge which is representative of density driven exchange flow the two layer flow structure is overwhelmed with unidirectionally downstream subtidal flows in the high discharge scenario the magnitudes of seaward subtidal flows vary within a few cm s in contrast at p2 subtidal flows are mainly seaward under weak river discharge flow profiles show some vertical shear with landward flow 5 cm s at the bottom fig 8b exchange flows are enhanced with increased river flow fig 8d landward inflows and seaward outflows increase up to 10 cm s and 15 cm s respectively except in the first few days when freshwater impacts do not reach the lower estuary thus increased caloosahatchee river discharge enhances exchange flows in the lower estuary and suppresses them along the river channel in addition peaks of bottom subtidal inflows 10 cm s fig 8d appeared near the 9th 19th and 28th of january which coincided with the periods of relatively weak tidal forcing fig 2c 4 3 velocity asymmetry the velocity asymmetry reflects the difference in the peak values between flood and ebb currents and the duration of each tidal phase this section compares the velocity asymmetries with respect to different caloosahatchee river discharge and documents the occurrences of ebb and flood dominance flood flows coincide with the positive x axis and y axis while ebb flows align with the negative x axis and y axis indicated by the coordinates in fig 9 a fig 9 depicts the near bottom and near surface velocity asymmetries in different discharge scenarios as well as their modifications near the bottom modifications of γ are larger than 3 in the upper caloosahatchee river because bottom currents switch from flood dominance under the low discharge scenario fig 9 a to ebb dominance under the high discharge scenario fig 9 b in the lower estuary ebb dominance of bottom currents during low discharge are weakened or reversed to flood dominance in the high discharge scenario indicated by arrows directed to the positive x axis and y axis in fig 9 c however in the lower estuary the alterations of γ here are smaller than those along the river channel near bottom values of γ at pine island sound are inconsistent but mainly ebb dominant near the surface fig 9d f ebb dominance along the river channel and within the lower estuary increases with river discharge modifications of surface velocity asymmetry at pine island sound are more consistent than bottom values and in the flood direction changes in the directions of the velocity asymmetry follow the changes in subtidal flows fig 7c and e which highlights the importance of river induced subtidal flows in modifying the velocity asymmetry as velocity asymmetries have tidal and subtidal contributions different combinations of principal tidal constituents and subtidal flows should determine their relative influence on velocity asymmetry combinations were examined at two representative locations p1 for the river channel and p2 for the lower estuary as indicated in fig 1 in this mixed diurnal tidal region combinations of tidal constituents that generate asymmetry include m2 m4 m2 k1 o1 and the interactions between principal harmonics and subtidal flows u0 denoted as k1 u0 o1 u0 m2 u0 m4 u0 referred to as contributors along the caloosahatchee river channel p1 fig 10 a d both near the bottom and the surface interactions between m2 and m4 tides contribute to slight flood dominance γ 0 1 while interactions between semidiurnal and diurnal constituents m2 k1 o1 contribute to ebb dominance near the bottom currents are flood dominant total γ 1 5 in the low discharge scenario which is mainly attributed to the interactions between the semidiurnal constituent and subtidal flow m2 u0 fig 10a bottom flows become ebb dominant in the high discharge scenario fig 10b the largest change happens to the m2 u0 contribution γ decreases from 1 04 to 1 07 while the contributions from principal tidal constituents show negligible alterations near the surface ebb dominance with low discharge is primarily attributed to m2 u0 and m2 k1 o1 with high discharge contributions from m2 k1 o1 reduce greatly 50 and contributors containing subtidal flows play a prominent role especially the m2 u0 this is because the p1 site is directly impacted by the river flow that attenuates tidal currents and strengthens the seaward subtidal flow it can then be inferred that along the river channel river discharge affects the velocity asymmetry primarily by enhancing the interactions between semidiurnal tide and subtidal flows in the lower estuary represented by p2 fig 10e h the velocity asymmetry is in general smaller in magnitude compared to p1 for each corresponding scenario ebb dominance under low discharge both at the bottom and surface are primarily induced by m2 k1 o1 while the contribution from m2 u0 plays a secondary role near the surface γ 0 19 in fig 10g with increased river discharge m2 u0 prevails and the contributions from m2 k2 o1 decrease in magnitude by 40 and 35 for bottom and surface flows respectively near the bottom increased river discharge results in a transition from ebb to flood dominance contributions from non tidal oscillations are negligible fig 10e during low discharge and become evident in the high discharge scenarios fig 10f especially m2 u0 increased from 0 14 to 0 93 near the surface the velocity asymmetry remains ebb dominant from low to high discharge scenario but the intensity increases the largest change happens to m2 u0 while changes from other subtidal flow related contributors are minimal variations of the velocity asymmetry in the lower estuary are associated with both the increased m2 tidal velocity amplitude fig 5 and the enhanced estuarine circulation where there is a strengthening of seaward subtidal flows at the surface and landward subtidal flows near the bottom fig 7 to summarize the effects of enhanced caloosahatchee river discharge on velocity asymmetries manifest primarily as decreased interactions between semidiurnal and diurnal constituents and increased interactions between semidiurnal and subtidal flows as a result ebb dominance near the surface is strengthened both along the caloosahatchee river channel and in the lower estuary near the bottom flood dominance along the caloosahatchee river channel is reversed to ebb dominance under a high discharge condition in the lower estuary near bottom ebb dominance switches to flood dominance 4 4 modifications of bottom friction under the influence of river discharge to further understand the dynamical adjustments of caloosahatchee river estuary to the river discharge and to ascertain the driving force behind the alterations of tidal behaviors such as upstream damping and downstream amplification of tidal currents we diagnosed and compared the momentum balance for the model scenarios considered like most estuary systems momentum balances in caloosahatchee river estuary are primarily among dynamic pressure gradient 1st 2nd terms right hand side r h s of equation 1 and 2 stress divergence 3rd term r h s and horizontal advection 2nd 4th terms left hand slide l h s with residuals explained by the coriolis acceleration 5th term l h s and viscous effects 4th term r h s when tides enter the estuary their distortion amplification and dissipation mainly depend on the competition between pressure gradient and bottom friction in the presence of a river the freshwater discharge increases the downstream directed barotropic pressure gradient and induces a baroclinic pressure gradient due to water density gradients both processes exert influence on the 3 dimensional subtidal circulation the river induced subtidal flows may cause modifications of the total current velocities near the bottom and thus produce different bottom stresses on the astronomic tidal propagation modifications to tidally averaged bottom stress caused by changes in river discharge indicate spatial variability fig 11 a high river discharge minus low river discharge scenarios the mean bottom stress increases along the main river channel and a decrease in san carlos bay this explains the modifications of tidal velocity amplitudes upstream tidal damping and amplification in the lower estuary fig 5 furthermore three representative cross sections cs1 to cs3 fig 11b d elucidate the vertical structure of tidally averaged subtidal flows and the corresponding magnitudes of bottom stress section cs1 is selected upstream close to fort myers which is directly impacted by the fluvial discharge sections cs2 and cs3 lie in the middle of san carlos bay and the transition to the gulf of mexico the vertical structure of subtidal flows at cs1 shows contrasting response to those at cs2 and cs3 fig 11 at cs1 subtidal flows had the typical two layer structure under low river discharge condition indicating exchange flow fig 11 the two layer subtidal flow was overwhelmed by the enhanced riverine flow and became unidirectional seaward in the high river discharge scenario second panel in fig 11b as a result the mean bottom stress increased roughly 50 in magnitude third panel in fig 11b in the lower estuary the mean subtidal flows showed lateral variations associated with the complex bathymetry under the low river discharge scenario first panels in fig 11c d in the high river discharge scenario second panels in fig 11c d the far reaching freshwater discharge intensifies the vertical stratification enhancing the vertically sheared subtidal flow especially in relatively deeper channels the seaward subtidal flows on the surface and landward inflow near the bottom are consistent with fig 8 the increased landward bottom inflow counteracts the dominant ebb tidal currents and reduces the total current near the bottom thus decreasing the bottom stress effects third panel in fig 11c d this explains the amplification of astronomical tides in the lower estuary in addition temporal variations of the depth averaged momentum balance are presented in the supplementary materials figs s2 and s3 along the river channel the momentum balance is mainly between the pressure gradient and friction compared to the low discharge scenario the pressure gradient term decreases during floods and increases during ebb at the same time the bottom stress increases 100 during ebbs and slightly decreases 10 during floods in the lower estuary advection gains more importance due to a more complex bathymetry bottom stress decreases in the high discharge scenario especially during ebb and spring tide periods the temporal variations of the dynamical terms reflect again the role of river enhanced estuarine circulation played in modifying the bottom frictional effects in the lower estuary to summarize the momentum balances in the caloosahatchee river estuary were mainly among pressure gradient bottom stress and horizontal advection effects of increased river discharge and its associated subtidal flows generated different frictional effects along the caloosahatchee river channel and the lower estuary thus influencing the astronomical tidal propagations along the river channel tidal velocity amplitudes decreased with the increased frictional effects which was mostly attributed to the strong interactions between the riverine and tidal flow in the lower estuary tidal currents were amplified because of the reduction of the bottom stress which was related to the enhanced freshwater induced estuarine circulation especially in the relatively deeper channels 5 discussion velocity asymmetries are quantified by the velocity skewness γ eqs 3 8 which accounts for the combined effects of overtides triad interactions between tidal components and subtidal flows barotropic baroclinic subtidal flows have been usually disregarded when looking at the velocity asymmetry as the focus has been the tidal asymmetry rather than the velocity asymmetry nonetheless subtidal flows affect the difference between the peak flood and ebb velocities for example the long term morphodynamic evolution of estuaries is highly influenced by the velocity asymmetry and not just the tidal asymmetry moreover velocity asymmetries affect water quality estuarine flushing and residence times the approach described in this study should be applicable to any semi enclosed basin having velocity asymmetries the approach quantifies velocity asymmetry drivers and how they vary under different forcing conditions e g changes during spring to neap tidal cycles or during wind pulses eq 8 provides the relative contribution of overtides compound tides and subtidal flows to the velocity asymmetry such relative contributions in turn will be affected by rising water levels variations in rain river discharge and wind stress and human interventions like changing water depths in semi enclosed basins by understanding the mechanisms responsible for velocity asymmetries one could determine morphodynamic and water quality consequences although this study focused on the caloosahatchee river estuary it is expected that freshwater flow changes will be similar in shallow micro tidal estuaries with mixed diurnal semidiurnal tides the estuarine cross sectional area and its variation along the estuary dictates how the freshwater flux translates into velocities thus the larger the cross sectional area the smaller will be the flow associated with a given freshwater discharge in estuaries with relatively small cross sectional area we would expect the highest impacts of freshwater fluxes in these types of narrow and shallow estuaries the density gradient will be displaced seaward more efficiently other factors that might play a key role in the velocity asymmetry and specifically the relevance of the physical processes dominating such asymmetry are the tidal amplitude relative to the water depth and the amount of water stratification for those estuaries with a relatively large tidal amplitude tidal asymmetries might play a more relevant role previous studies have demonstrated that overtides m4 and m6 can arise from river tide interactions blanton et al 2002 sassi and hoitink 2013 guo et al 2015 2021 in this study we only analyzed the overtides and compound generated from the interaction between four principal tidal constituents other combinations of tidal constituents compound and overtides also affect the velocity asymmetry such as mk3 and ms4 e g hoitink et al 2003 gong et al 2016 however their effects are not considered in this study due to their relatively small contributions not shown in estuaries with relatively larger tidal amplitudes these interactions might be more relevant partially mixed estuaries such as the caloosahatchee river estuary are those with the most intense density gradient driven exchange flows therefore we would expect these density driven exchange flows to affect the velocity asymmetry more effectively than in stratified or well mixed estuaries the freshwater discharge the relative tidal amplitude and the degree of stratification of an estuary are constantly changing over time and space subtidal flows in this study refer to velocities with periods longer than the semidiurnal and diurnal tides that exclude astronomical tidal influence subtidal flows are time dependent and sensitive to pulses of freshwater input e g valle levinson et al 2009 2019 the wind the tidal amplitude and the degree of stratification further analysis of the implications of such changes on the tidal propagation and velocity asymmetries are needed to better manage these types of coastal systems 6 summary and conclusions this study investigates the influence of river discharge on tidal and subtidal flows in a microtidal estuary a three dimensional hydrodynamic model roms is applied to the caloosahatchee river estuary a microtidal estuary with mixed semidiurnal diurnal tides special focus is given on the modifications of velocity asymmetry primary contributors tidal subtidal and their interactions to the velocity asymmetry are decomposed and evaluated under different river discharge scenarios results show that changes in river discharge notably modify the tidal propagation subtidal flows and velocity asymmetries within the estuary under the high discharge condition diurnal tidal elevation amplitudes are reduced along the river channel and increased in the lower estuary semidiurnal tidal elevations are amplified in the lower estuary tidal velocity amplitudes decrease along the river channel and increase in the lower estuary with enhanced river discharge changes in tidal elevations and velocities are linked to freshwater induced modifications of bottom stress along the river channel higher river discharge resulted in increased frictional effects and reduced the astronomic tidal velocity amplitudes in the lower estuary enhanced baroclinic circulations under high discharge reduced the mean current during ebbs decreased the frictional effects and amplified the astronomic tidal velocity amplitudes modifications of subtidal flows and velocity asymmetry exhibit three dimensional characteristics enhanced baroclinic circulations are found in the lower estuary while they are suppressed along the river channel the main contributor to the velocity asymmetry along the estuary is the interaction between the subtidal flows and the m2 tidal component except under low freshwater discharge conditions at the lower estuary where the asymmetry is dominated by the triad interaction between the m2 k1 and o1 constituents alterations of the velocity asymmetry are driven by changes in both astronomic tides and subtidal flows they are primarily manifested as decreased interactions between semidiurnal and diurnal constituents and increased interactions between semidiurnal tides and subtidal flows credit authorship contribution statement luming shi methodology validation writing original draft writing review editing collin ortals methodology writing original draft resources arnoldo valle levinson conceptualization methodology writing original draft supervision maitane olabarrieta conceptualization methodology writing original draft writing review editing supervision declaration of competing interest the authors declare no competing interests acknowledgments we thank all developers in the roms toms group the roms model the regional ocean modeling system roms is an open source code distributed using both git and subversion on https www myroms org we would like to thank the river estuary and coastal observing network sanibel captiva conservation foundation recon sccf https recon sccf org and noaa tides and currents https tidesandcurrents noaa gov for providing valuable observational dataset used in this study we are grateful for the support from the center for coastal solutions of the university of florida https ccs eng ufl edu this work was supported by the us army corps of engineers aquatic nuisance species research program under federal award identification number fain w912hz 21 2 0057 by the department of environmental protection under the award awd12194 and by a private donation to the university of florida supplementary materials supplementary material associated with this article can be found in the online version at doi 10 1016 j advwatres 2023 104446 appendix b supplementary materials image application 1 appendix a here we present the derivation of velocity asymmetry expressed as velocity skewness eq 8 the current velocity v is expressed as v i 0 m v i i 0 m a i cos ω i t φ i v 3 i 0 m v i 3 i 0 m v i 3 3 i j 0 i j m v i 2 v j i j k 0 i j k m v i v j v k where v i 3 1 4 a i 3 c o s 3 ω i t 3 φ i 3 c o s ω i t φ i v i 2 v j 1 4 a i 2 a j c o s 2 ω i ω j t 2 φ i φ j c o s 2 ω i ω j t 2 φ i φ j 2 c o s ω j t φ j v i v j v k 1 4 a i a j a k c o s ω i ω j ω k t φ i φ j φ k c o s ω i ω j ω k t φ i φ j φ k c o s ω i ω j ω k t φ i φ j φ k c o s ω i ω j ω k t φ i φ j φ k v 2 i 0 m v i 2 i 0 m v i 2 i j 0 i j m v i v j where v i 2 1 2 a i 2 1 c o s 2 ω i t 2 φ i v i v j 1 2 a i a j c o s ω i ω j t φ i φ j c o s ω i ω j t φ i φ j the expectation of each term is expressed as e v i v j 0 e v i 3 0 w h e n ω i 0 a 0 2 c o s φ 0 w h e n ω i 0 e v i 2 1 2 a i 2 w h e n ω i 0 a 0 2 w h e n ω i 0 0 o t h e r s e v i 2 v j 1 4 a i 2 a j cos 2 φ i φ j w h e n ω i 0 1 2 a i 2 a 0 c o s φ 0 w h e n ω i 0 0 o t h e r s e v i v j v k 1 4 a i a j a k c o s φ i φ j φ k w h e n ω i ω j ω k 0 0 o t h e r s therefore γ μ 3 σ 3 e v 3 e v 2 3 2 1 a 0 2 1 2 i 1 n a i 2 3 2 ω i ω j ω k 3 2 a i a j a k cos ϕ i ϕ j ϕ k 2 ω i ω j 3 4 a i 2 a j cos 2 ϕ i ϕ j i 1 n 3 2 a i 2 a 0 cos ϕ 0 a 0 3 cos ϕ 0 
17,freshwater discharge into an estuary can affect its horizontal density gradients water column stratification and subtidal circulation an incomplete understanding of the effects of river discharge on tidal and subtidal flows motivates this study the focus is on how river discharge effects translate into temporal variations in velocity asymmetries within a microtidal estuary with mixed tides in particular this study quantifies the relative contribution of overtides compound tides and subtidal flows to velocity asymmetries by modifying the method proposed by nidzieko 2010 quantification is carried out with a three dimensional hydrodynamic model and the modified method is applied in a microtidal estuary with mixed tides numerical simulations show that the upper estuary toward the river responds differently from the lower estuary toward the ocean to changes in freshwater discharge throughout the estuary the horizontal salinity density gradient tends to migrate to the lower estuary as river discharge increases in the upper estuary subtidal flows become vertically unidirectional mainly because fresh water displaces salty water toward the lower estuary in the lower estuary the horizontal salinity gradient increases with a corresponding enhancement of the baroclinic circulation exchange flow estimates of velocity asymmetries show that the interaction between subtidal flows and semidiurnal tidal flows is the main contributor to the asymmetries as freshwater discharge increases changes in the velocity asymmetry manifest as attenuated interactions between semidiurnal and diurnal flows and enhanced interactions between semidiurnal flows and subtidal flows keywords river discharge velocity asymmetry subtidal flow tidal propagation caloosahatchee river estuary data availability data will be made available on request 1 introduction major drivers in estuarine hydrodynamics include tides and fluvial discharges plus their interactions tides may act as a barrier to river discharge sassi and hoitink 2013 riverine flow attenuates or magnifies tidal oscillations by altering frictional effects e g godin 1985 jay and flinchem 1997 leonardi et al 2015 moreover fresh water from rivers influences mixing processes and the water density distribution while affecting flushing and residence times of different parts of the estuary the discharge also affects the transport and dispersion of dissolved and suspended matter such as sediments nutrients and contaminants e g pritchard 1955 friedrichs and aubrey 1988 hoitink et al 2017 extensive efforts to study river tide interactions have been devoted to the effects of river discharge on barotropic tidal propagation e g godin 1999 hoitink and jay 2016 laurel castillo and valle levinson 2020 these efforts have implemented data analysis analytical solutions and numerical modeling one approach in these studies has been to apply continuous wavelet transform to water level signals and highlight the role of river discharge in redistributing the spectral energy of tides e g jay and flinchem 1997 guo et al 2015 other studies have revealed that high discharge events may increase the tidal current amplitude when the flow is river dominated and unidirectional no tidal reversal i e seaward during both ebbs and floods and decrease the tidal current amplitude when the flow is tidally dominated and bidirectional landward during floods and seaward during ebbs leonardi et al 2015 analytical solutions of tidal wave propagation in a fluvial estuary are typically derived from the shallow water equations with linearized bottom friction and negligible advection e g savenije 1998 godin 1999 analytical solutions show that river discharge can cause tidal damping in the upper reach of an estuary e g horrevoets et al 2004 cai et al 2012 2014 numerical modeling studies have been conducted on tidal river interactions worldwide guo and valle levinson 2007 investigated the dynamic response of the chesapeake bay to river discharge and tidal forcing their study highlighted the role of tidal forcing in organizing the vertical structure of the outflow plume and the horizontal variations in exchange flow sandbach et al 2018 explored the river tide interactions and net sediment transport they found that increasing river discharge reduced the extent of the flood directed flow and sediment transport in the columbia river estuary surya et al 2019 revealed that the increase of river discharge might amplify the diurnal tidal component and inundation areas of the lower estuary in jakarta bay indonesia however numerical simulations showed a decreasing trend of m2 and k1 tides with increasing discharge in the yellow river delta ji et al 2020 while numerous studies have been carried out on tidal dynamics in estuaries no attention has been paid to the effects of river discharge on the velocity asymmetry especially in microtidal estuaries where the fluvial discharge plays a prominent dynamical role an instantaneous velocity profile in estuaries features contributions from astronomic tides shallow water tides and subtidal processes flows with longer periods than the tides the velocity asymmetry is referred to as the periodic difference between a the peak flood and peak ebb velocities or b the duration of ebb and flood currents this asymmetry depends on tidal tidal velocity asymmetry and non tidal oscillations the intensity and direction of subtidal flows subtidal flows are induced mainly by river discharge non linear tidal distortion water density gradients wind atmospheric pressure and wind waves e g naimie et al 2001 valle levinson et al 2009 2019 they can be vertically sheared three dimensional or vertically uniform two dimensional and exhibit spatial and temporal variations in response to river pulses valle levinson 2012 within one tidal cycle tidal asymmetry in semi diurnal estuaries is related to overtides dronkers 1964 pugh 1987 dyer 1997 that arise from distortions to tides in shallow waters in diurnal and mixed diurnal estuaries tidal velocity asymmetries might arise from the interaction mainly between the k1 o1 and m2 s2 and n2 tidal constituents hoitink et al 2003 nidzieko 2010 several indexes have been used to quantify tidal velocity asymmetries guo et al 2019 the tidal duration asymmetry describes differences in ebb and flood intervals whereas the tidal velocity asymmetry or tidal velocity skewness reflects the difference between the peaks of flood and ebb tidal currents in regions dominated by semidiurnal tides tidal asymmetry is typically quantified by the m4 to m2 amplitude ratio friedrichs and aubrey 1988 and their relative phase difference e g hoitink et al 2003 olabarrieta et al 2018 in mixed diurnal semidiurnal tidal regimes the tidal velocity asymmetry can be evaluated using the tidal velocity skewness parameter proposed by nidzieko 2010 the studies above focused on the tidal velocity asymmetry i e the asymmetry related exclusively to tides however the focus here is on asymmetries between peak flood and ebb currents influenced by the strength and direction of subtidal flows this interaction will be herein referred to simply as velocity asymmetry the influence on velocity asymmetries can be affected by subtidal flows with a two or three dimensional structure the main goal of this study is to better understand the effects of river discharge on the overall circulation structures of a micro tidal estuary with particular attention to velocity asymmetries the goal is addressed with numerical simulations by modifying the method of nidzieko 2010 by including subtidal flows in calculating the velocity skewness as a test case we apply this method in the caloosahatchee river estuary florida a micro tidal and mixed diurnal semidiurnal estuary located on the southwest coast of florida the rest of the paper is organized as follows section 2 presents information on the study site the methods used in the study are shown in section 3 the effects of river discharge on tidal elevation and current amplitudes subtidal flows and velocity asymmetries are described in sections 4 1 4 3 respectively the effects of bottom friction are shown in section 4 4 results are discussed in sections 5 and 6 summarizes the main conclusions of the present work 2 study site the caloosahatchee river estuary the caloosahatchee river estuary is located on the southwest coast of florida fig 1 it mainly encompasses the caloosahatchee river and the lower estuary of san carlos bay the caloosahatchee river estuary is connected to the charlotte harbor estuary through matlacha pass and pine island sound zheng and weisberg 2004 conducted a numerical study on the circulation features within the charlotte harbor estuary located north of the caloosahatchee river estuary their study concluded that the flow and salinity fields respond to a combination of tide rivers and wind they also showed that charlotte harbor and san carlos bay show independent circulation behavior dye et al 2020 applied a two dimensional hydrodynamic model to the southwest florida coast and demonstrated the flush dominance in four major inlets within the estuary system however the dynamic response of the estuary to variations in the caloosahatchee river discharge remains poorly understood the geometry of the caloosahatchee river estuary is irregular with a width ranging from 160 m in the upper portion to 2500 m near its mouth scarlatos 1988 the volume of the estuary shell point upstream to s 79 is approximately 105 106 m3 stoker 1992 the caloosahatchee river is the primary source of fresh water to the estuary the river extends 67 km from lake okeechobee to the franklin lock and dam s 79 which marks the beginning of caloosahatchee river estuary and runs 42 km from s 79 to shell point chamberlain and doering 1998 sun et al 2016 the mean depth of the caloosahatchee river channel is approximately 5 m from beautiful island to shell point fig 1 the discharge of the caloosahatchee river is influenced by two sources one from its watershed and the other via regulatory releases from lake okeechobee doering and chamberlain 1999 in conjunction with a subtropical climate the caloosahatchee river discharge shows seasonal variations with values ranging from 0 m3 s during dry seasons up to 800 m3 s in wet seasons the lower estuary comprises the san carlos bay and southern portions of the pine island sound and matlacha pass it is characterized by complex bathymetry with multiple channels and shallow bays it provides a wide range of habitats for aquatic organisms such as tape grass oysters manatees and dolphins e g chamberlain and hayward 1996 doering et al 2002 barnes 2005 the caloosahatchee river estuary is a micro tidal estuary with a spring tidal range of less than 1 m through its 5 km opening to the ocean the lower estuary undergoes interactions between riverine and tidal flows astronomical tides exhibit a mixed mainly semidiurnal type with form factors ranging from 1 to 1 5 goodwin 1996 dye et al 2020 tidal influence can be far reaching and allow salt water to intrude up to the head of the estuary at s 79 during dry seasons tides and saltwater intrusions can be overwhelmed by river discharge during wet seasons sun et al 2016 3 methods in this section we describe the numerical model used to analyze the effects of river discharge on velocity fields and asymmetries the setting of the numerical model the experimental design and the model verification also described are the methods used to separate tidal oscillations from subtidal flows and the equations used to compute velocity asymmetries 3 1 model description setup and experimental design the regional ocean modeling system roms is a three dimensional ocean circulation model that solves the reynold averaged navier stokes rans equations using hydrostatic and boussinesq assumptions with a split explicit time stepping algorithm haidvogel et al 2000 2008 shchepetkin and mcwilliams 2005 the governing equations are discretized horizontally over an arakawa c grid and vertically over a terrain following sigma coordinate system using a centered second order finite difference approximation the momentum conservation equations solve by roms and written in a cartesian coordinate system are 1 h z u t u h z u x ν h z u y ω h z u s f h z v h z ρ 0 p x h z g η x s u ω ν h z u s 2 h z v t u h z v x ν h z v y ω h z v s f h z u h z ρ 0 p y h z g η y s v ω ν h z v s 3 0 1 ρ 0 p s g ρ 0 h z ρ with the continuity equation expressed as 4 η t h z u x h z v y h z ω s 0 and scalar transport presented as 5 h z c t u h z c x v h z c y ω h z c s s c ω ν h z c s c s o u r c e equations 1 5 are closed by parameterizing the reynolds stresses and tracer turbulent fluxes as u ω k m u z v ω k m v z c ω k c c z at the water surface k m u z τ s x k m v z τ s y at the water bottom k m u z τ b x k m v z τ b y here hz is the vertical stretching factor u v and ω u v and ω are the velocity components and perturbations respectively x y and s indicate the horizontal and vertical sigma coordinates p and η are pressure and wave averaged free surface elevation c c and csource represent the tracer scalar perturbation and source sink respectively ν is molecular viscosity ρ and ρ0 are total and reference densities eddy viscosities km and diffusivities kc can be parameterized using the generic length scale model described by warner et al 2005 τ s and τ b represents surface and bottom stresses in this study we apply roms to the area of the caloosahatchee river and estuary the modeling domain encompasses the charlotte harbor portion in the north and the san carlos bay portion in the south with the western boundary extending to the west florida shelf fig 1 the modeling grid has an adaptive horizontal grid size ranging from 300 m offshore to 10 m in the inner estuary and inlets to better resolve the water density field we use 12 terrain following vertical layers that provide a vertical resolution of 0 1 m in the shallowest areas of the estuary the bathymetry and topography data are obtained from a combination of noaa s continuously updated digital elevation model cudem with 1 9 arc second resolution cooperative institute for research in environmental sciences and usgs s lidar dem southwest fl in 2018 with 0 5 m spatial resolution https www fisheries noaa gov inport item 59010 at the open boundaries free surface elevation current velocity water temperature and salinity are interpolated from the output of the hybrid coordinate ocean model with naval research lab nrl coupled ocean data assimilation in the gulf of mexico hycom ncoda gulf of mexico which has spatial and temporal resolutions of 1 25 and 1 h respectively periods with missing boundary data are filled with the coawst modeling results from the u s geological survey usgs to enforce hycom external fields to roms the chapman implicit boundary condition chapman 1985 is applied to the surface elevation which assumes all outgoing cross boundary waves propagate as non dispersive shallow water waves the analogous flather boundary condition flather 1976 is imposed to barotropic velocities which allows the deviations from exterior values to radiate out of the boundary at a speed of the external shallow water waves the radiation boundary condition orlanski 1976 raymond and kuo 1984 is imposed to baroclinic velocities water temperature and salinity details regarding the implantation procedures of each open boundary condition can be referred to marchesiello et al 2001 marsaleix et al 2006 stress in the bottom boundary layer is parameterized by a logarithmic profile with a bottom roughness z 0 of 0 0015 m for sub grid vertical mixing eddy viscosity and diffusivity the turbulence model with generic length scale approach is applied warner et al 2005 which in this application resembles a k ε turbulence model regarding the atmospheric forcing inputs 10 m wind speed atmospheric pressure at mean sea level 2 m air temperature relative humidity and short and long wave radiation are specified with hourly values from the high resolution rapid refresh hrrr model at a 3 km spatial resolution https home chpc utah edu u0553130 brian blaylock cgi bin hrrr download cgi missing rainfall inputs are replaced with results from the global forecast system model https www ncei noaa gov products weather climate models global forecast the bulk flux algorithm of coare 3 5 edson 2013 is applied to estimate the momentum and heat fluxes from the air to the sea surface freshwater sources within the model domain are imposed via horizontal velocities crossing the land water mask boundary at specified inflow cells a total of 11 rivers and creeks dark blue triangles in fig 1 are considered freshwater source points including the three major rivers myakka river peace river and caloosahatchee river river and creek discharge values are derived from national water model hourly streamflow reanalysis data discharge values of the caloosahatchee river are specified with historical measurements at usgs station s 79 simulations are initialized on the 1st of january 2021 at 00 00 00 utc and run until the 31st of january 2021 at 23 00 00 utc water surface elevations 3 dimensional water temperature and salinity in the inner shelf are initialized with extrapolations from hycom gom model outputs and real time observations at four stations purple triangles in fig 1 of the river estuary and coastal observing network recon from sanibel captiva conservation foundation sccf https recon sccf org to investigate the effects of caloosahatchee river discharge on the water circulation patterns in the caloosahatchee river estuary we consider two modeling experiments with discharge values of 5 and 95 percentile of the cumulative density function of the historical river discharge measurements at usgs station s 79 which are 0 5 and 200 27 m3 s respectively to evaluate the river induced modifications in the momentum balance diagnostic outputs of each term in the horizontal momentum equations of roms not shown are saved hourly to exclusively investigate the effects of river discharge on the tidal dynamics atmospheric forcing e g wind and atmospheric pressure and ocean boundary conditions remain unmodified in the model scenarios considered 3 2 model verification tides in the caloosahatchee river estuary are mixed semidiurnal dominant with major constituents of m2 k1 o1 and s2 goodwin and michaelis 1976 zheng and weisberg 2004 to evaluate our model performance simulated tides are compared at 14 locations with predictions from noaa black dots in fig 1 modeled amplitudes and phases of the principal tidal constituents showed good agreement with noaa predicted values at most stations the mean root mean square errors rmses of m2 k1 and o1 tidal elevation amplitudes are 1 9 cm 1 8 cm and 0 7 cm respectively referred to supplementary materials table 1 in the caloosahatchee river estuary tidal signals are well captured with rmse of less than 1 cm and phase differences lower than 20 min e g station punta rassa and fort myers detailed information of the astronomic tidal verification is not shown here for conciseness and can be referred to in the supplementary materials overall the model performance is satisfactory in reproducing the tidal variations in addition to the tidal constituents time series of modeled water surface elevations are compared with water level observations from 4 recon sites fig 1 note that the station shell point from recon shares the same name as a noaa tidal prediction station but lies in a different location as shown in fig 2 modeled water surface elevations agree with the measurements with rmse of 6 7 cm and determination coefficient r2 values of 0 88 0 88 0 92 0 93 respectively in contrast to the station at tarpon bay in the lower estuary fig 1 water level variations at the stations along the river channel fig 2a b and c are similar two time periods near january 13th and january 28th with negative surges triggered by offshore winds are captured at all stations in this model application however water levels are underestimated up to 12 cm during a neap tide around january 19th these discrepancies possibly arise from underestimated water levels at the model boundaries or from overestimated seaward local winds in the atmospheric forcing generally modeled water surface elevations agree with the observed values further model verifications are conducted for water temperature and salinity measured at the same location as water surface elevations fig 3 shows the time series of measured and modeled water temperature and salinity modeled water temperature and salinity were interpolated to the same depth as the sensors which are located close to the bottom except for the beautiful island station measured water temperature variations are quantitatively well reproduced by the model with rmse less than 1 c biases at beautiful island potentially arise from 1 misrepresented surface heat fluxes over river upstream different spatial resolutions of the atmospheric 3 km and ocean 30 m models cause sub grid mismatches of land water mask as a result surface heat fluxes over the narrow 150 m and shallow 2 m upstream area of the river may be flawed this may increase the sensitivity and discrepancies of modeled water temperature 2 bias in river temperature input due to a lack of available observational data during the modeling period river temperature in this model application is set with the monthly averaged historical value of 20 c modeled salinity values are compared with observations rmses are less than 2 g kg at all stations fig 3e h note that the panels in fig 3 have different vertical axis limits particularly at shell point station where the salt and fresh water are dynamically mixed salinity variations up to 15 g kg are simulated well it appears that the overall interaction between the river and the ocean including their mixing are captured successfully by the model at tarpon bay while salinity deviates from 28 g kg by a few units three spikes to 33 g kg during january 25th 28th are resolved by the model at fort myers and beautiful island simulated salinity generally agrees with the observed trends but is underpredicted up to 3 g kg from january 15th to january 25th the overall r2 values for water temperature and salinity are 0 743 and 0 987 respectively fig 3i j inconsistencies of water temperature primarily come from the station of beautiful island as discussed above although inaccuracies exist modeled water temperatures and salinities lie in an acceptable range mean rmse equal to 0 95 c and 1 1 g kg for water temperature and salinity respectively 3 3 tidal decomposition and velocity asymmetry to split the tidal and non tidal oscillations harmonic analysis using the t tide package pawlowicz et al 2002 considering 29 tidal constituents is applied to the modeled surface elevations and current velocities at each computational grid cell non tidal subtidal oscillations are obtained first by subtracting the tidal signals from modeled surface elevation and currents and then applying a low pass lanczos filter duchon 1979 with a cut off period of 25 h the low pass filter is used to eliminate the remnants of periodic tidal oscillations that are not captured by harmonic analysis mean subtidal flow here and after refers to non tidal currents averaged over the whole simulation period regarding the velocity asymmetry the commonly used phase relationship between m2 and m4 tide is not applicable in a mixed mainly semidiurnal tidal regime therefore we adapted the method by nidzieko 2010 to evaluate the distortion of current velocity in the caloosahatchee river estuary specifically we calculate the skewness of current velocity instead of skewness of tidal elevation time derivative used in nidzieko 2010 to quantify the tidal duration asymmetry this adaption is justified since the skewness of velocity directly measures the distortion of the velocity distribution a positive negative velocity skewness indicates that the magnitudes of flood currents are higher lower than the magnitudes of ebb currents as a result the tidal velocity asymmetry γ can be quantified as 6 γ μ 3 σ 3 e v 3 e v 2 3 2 7 v i 0 n v i i 0 n a i cos ω i t ϕ i where μ3 and σ are the third moment and the standard deviation of the velocity v e is the expectation symbol n is the total number of tidal and subtidal constituents vi denotes all contributions to the flow with v 0 representing the subtidal flow ai ω i and ϕ i are tidal current amplitude angular frequency and phase respectively ω i 0 and ϕ0 0 or π for subtidal flow subtidal flows can exhibit a three dimensional structure the value of velocity skewness γ indicates dissimilarities between peaks of flood and ebb currents positive γ indicates a higher flood velocity than ebb velocity which is flood dominance negative γ represents ebb dominance the notations in equation 6 and 7 differ from those in nidzieko 2010 since the quantity v is the sum of tidal and subtidal flow the interaction of subtidal flows with astronomic tides can be included via eq 7 the velocity skewness γ can be computed by substituting eq 7 in eq 6 and taking the time average 8 γ 1 a 0 2 1 2 i 1 n a i 2 3 2 ω i ω j ω k 3 2 a i a j a k cos ϕ i ϕ j ϕ k 2 ω i ω j 3 4 a i 2 a j cos 2 ϕ i ϕ j i 1 n 3 2 a i 2 a 0 cos ϕ 0 a 0 3 cos ϕ 0 the first two terms on the right hand side represent the velocity asymmetry induced by the interactions of astronomical tidal constituents that satisfy the frequency relations ω i ω j ω k and 2ω i ω j referred to as distortions or triad interactions the last term represents interactions between subtidal flows and each tidal constituent relative contributions to velocity asymmetries can be inferred with eq 8 via different combinations of tidal constituents and subtidal flows the derivations of eq 8 are included in appendix a the reader is referred to nidzieko 2010 song et al 2011 and gong et al 2016 for further information about skewness quantified tidal asymmetry 4 results to explore the dynamic responses of the estuary to different freshwater inputs we consider two model scenarios with discharge values of 0 5 m3 s low discharge scenario and 200 27 m3 s high discharge scenario representative of the dry and a wet season respectively results are analyzed in terms of river discharge modifications to tidal elevations and velocity amplitudes section 4 1 salinity gradient and subtidal flows section 4 2 velocity asymmetries section 4 3 and bottom friction section 4 4 focus is on subtidal flows overtides and compound tides triad interactions among semidiurnal and diurnal harmonics because these are the major contributors to the velocity asymmetries 4 1 tidal elevation and velocity amplitudes this section presents a comparison of the tidal elevation and current amplitudes for the two river discharge scenarios considered in the caloosahatchee river estuary results show that changes of tidal elevation amplitudes in the charlotte harbor area are minimal 0 5 cm referred to supplementary material fig s1 increased freshwater inputs mainly affect the area of caloosahatchee river estuary including the main channel of the caloosahatchee river san carlos bay pine island sound and matlacha pass therefore emphasis starting from fig 4 is placed in the southern portion of the estuary system for graphic clarity fig 4 shows modeled tidal elevations amplitudes four tidal constituents k1 o1 m2 and s2 and the modifications under different discharge conditions in terms of different tidal constituents it is evident that semidiurnal and diurnal tidal elevation amplitudes respond differently to the variation of caloosahatchee river discharge for diurnal tides amplitudes of k1 and o1 decrease both in value and in percentage along the river channel and amplify in the lower estuary fig 4a1 a4 and b1 b4 the damping effect up to 30 is more noticeable compared to the amplification 0 5 cm and 5 for semidiurnal tides the most distinct alterations happen to the m2 constituent the amplification up to 15 of m2 extends from the san carlos bay to the matlacha pass pine island sound as well as the upper portion of the caloosahatchee river channel fig 4c1 c4 the modification of s2 elevation amplitude fig 4d1 d4 shows similar patterns as m2 but the variations up to 0 3 cm are moderate compared to the other constituents the tidal elevation amplitude of all the constituents is damped 30 close to the source of fresh water in the high discharge scenario regarding the alterations of tidal velocity magnitude the tidal current constituents show amplification in the lower estuary and reduction along the caloosahatchee river especially in the relatively deeper channels fig 5 only the changes of tidal current amplitude between the two scenarios are presented for conciseness in the area of san carlos bay diurnal tidal magnitudes are amplified up to 35 fig 5e h the m2 constituent shows the largest variation in value 2 cm s but the least in percentage up to 20 and s2 shows the least change in value 0 5 cm s but relatively large in percentage amplification of semi diurnal tidal currents extends from the mouth of san carlos bay to the north of pine island sound and matlacha pass along the caloosahatchee river channel tidal velocity magnitudes and especially the diurnal components reduce by more than 30 fig 5e f this reduction is primarily associated with a 6 cm increase of the mean water level caused by enhanced river discharge not shown this increased mean water level generates a downstream pressure gradient force per unit mass competing with the incoming tide in addition the increased river discharge decreases the diurnal tidal velocities but amplifies the semidiurnal components fig 5g h in the northern portion of pine island sound and the northern end of matlacha pass these two are the farthest points of influence for the caloosahatchee river discharge in this simulation further north changes of all constituents considered are negligible the relatively small modifications of tidal elevations and current amplitudes with respect to different caloosahatchee river inputs indicate weak connections to charlotte harbor estuary through pine island sound and matlacha pass 4 2 salinity gradient and subtidal flows this section describes the effects of river discharge on the redistribution of salinity and on the subtidal flows in the caloosahatchee river estuary depth and time averaged over the whole simulation period salinity distributions under the two discharge scenarios are shown in fig 6 during low discharge the salinity gradient mainly exists along the river channel from 2 to 24 g kg fig 6a when increasing the freshwater discharge the salinity along the river channel decreases dramatically to less than 5 g kg the freshwater dominated area increases and displaces the salinity gradient to the lower estuary fig 6b an increased northwestward salinity gradient develops from the mouth of san carlos bay 32 g kg to the south end of matlacha pass 14 g kg moreover modifications to the salinity gradient are found in pine island sound from 30 to 24 k kg and matlacha pass where salinity is nearly uniform in the low discharge scenario changes in the density gradient alter the horizontal and vertical density distributions and further affect the subtidal flows in different ways in the upper and lower estuary as explained below under low discharge conditions subtidal flows along the river channel are mainly baroclinic into the estuary near the bottom and seaward at the surface with the increase in river discharge the upper part of the estuary becomes river dominated and consequently the subtidal flow becomes vertically unidirectional and seaward in the lower estuary the baroclinic circulation intensifies with the increase of river discharge seaward subtidal flows on the surface and landward subtidal flows near the bottom are strengthened by the increased river discharge fig 7 near the bottom fig 7a c subtidal flows along the river channel increase in the downstream direction with magnitudes exceeding 6 cm s this is because bottom subtidal inflow under low discharge scenario fig 7a reverses to outflow in the high discharge scenario fig 7b in the lower estuary bottom subtidal inflows increase indicated by northwestward arrows fig 7c in the high discharge scenario especially at the mouth of san carlos bay in the area of pine island sound and matlacha pass bottom subtidal flows increase southeastward and northwestward respectively but the changes are relatively small magnitudes 2 cm s compared to those along the river channel near the water surface subtidal flows exhibit stronger alterations in magnitude up to 15 cm s than at the bottom fig 7d f compared to the low discharge scenario fig 7d increased surface subtidal outflows under high discharge fig 7e are found both along the river channel and in the lower estuary relatively larger alterations happen in deeper water pathways depth 3 m in the lower estuary surface subtidal flows at pine island sound increase northwestward in the high discharge scenario in addition the area where baroclinic subtidal flows increase coincides with the area where tidal velocity magnitudes amplify fig 5 the vertical structure of subtidal velocity profiles evolves differently in time according to position along the estuary fig 8 an upstream location in the caloosahatchee river p1 fig 1 is directly impacted by the freshwater input in the middle of san carlos bay p2 fig 1 fresh and salty waters mix at p1 fig 8a c two layer subtidal flows are observed under low river discharge which is representative of density driven exchange flow the two layer flow structure is overwhelmed with unidirectionally downstream subtidal flows in the high discharge scenario the magnitudes of seaward subtidal flows vary within a few cm s in contrast at p2 subtidal flows are mainly seaward under weak river discharge flow profiles show some vertical shear with landward flow 5 cm s at the bottom fig 8b exchange flows are enhanced with increased river flow fig 8d landward inflows and seaward outflows increase up to 10 cm s and 15 cm s respectively except in the first few days when freshwater impacts do not reach the lower estuary thus increased caloosahatchee river discharge enhances exchange flows in the lower estuary and suppresses them along the river channel in addition peaks of bottom subtidal inflows 10 cm s fig 8d appeared near the 9th 19th and 28th of january which coincided with the periods of relatively weak tidal forcing fig 2c 4 3 velocity asymmetry the velocity asymmetry reflects the difference in the peak values between flood and ebb currents and the duration of each tidal phase this section compares the velocity asymmetries with respect to different caloosahatchee river discharge and documents the occurrences of ebb and flood dominance flood flows coincide with the positive x axis and y axis while ebb flows align with the negative x axis and y axis indicated by the coordinates in fig 9 a fig 9 depicts the near bottom and near surface velocity asymmetries in different discharge scenarios as well as their modifications near the bottom modifications of γ are larger than 3 in the upper caloosahatchee river because bottom currents switch from flood dominance under the low discharge scenario fig 9 a to ebb dominance under the high discharge scenario fig 9 b in the lower estuary ebb dominance of bottom currents during low discharge are weakened or reversed to flood dominance in the high discharge scenario indicated by arrows directed to the positive x axis and y axis in fig 9 c however in the lower estuary the alterations of γ here are smaller than those along the river channel near bottom values of γ at pine island sound are inconsistent but mainly ebb dominant near the surface fig 9d f ebb dominance along the river channel and within the lower estuary increases with river discharge modifications of surface velocity asymmetry at pine island sound are more consistent than bottom values and in the flood direction changes in the directions of the velocity asymmetry follow the changes in subtidal flows fig 7c and e which highlights the importance of river induced subtidal flows in modifying the velocity asymmetry as velocity asymmetries have tidal and subtidal contributions different combinations of principal tidal constituents and subtidal flows should determine their relative influence on velocity asymmetry combinations were examined at two representative locations p1 for the river channel and p2 for the lower estuary as indicated in fig 1 in this mixed diurnal tidal region combinations of tidal constituents that generate asymmetry include m2 m4 m2 k1 o1 and the interactions between principal harmonics and subtidal flows u0 denoted as k1 u0 o1 u0 m2 u0 m4 u0 referred to as contributors along the caloosahatchee river channel p1 fig 10 a d both near the bottom and the surface interactions between m2 and m4 tides contribute to slight flood dominance γ 0 1 while interactions between semidiurnal and diurnal constituents m2 k1 o1 contribute to ebb dominance near the bottom currents are flood dominant total γ 1 5 in the low discharge scenario which is mainly attributed to the interactions between the semidiurnal constituent and subtidal flow m2 u0 fig 10a bottom flows become ebb dominant in the high discharge scenario fig 10b the largest change happens to the m2 u0 contribution γ decreases from 1 04 to 1 07 while the contributions from principal tidal constituents show negligible alterations near the surface ebb dominance with low discharge is primarily attributed to m2 u0 and m2 k1 o1 with high discharge contributions from m2 k1 o1 reduce greatly 50 and contributors containing subtidal flows play a prominent role especially the m2 u0 this is because the p1 site is directly impacted by the river flow that attenuates tidal currents and strengthens the seaward subtidal flow it can then be inferred that along the river channel river discharge affects the velocity asymmetry primarily by enhancing the interactions between semidiurnal tide and subtidal flows in the lower estuary represented by p2 fig 10e h the velocity asymmetry is in general smaller in magnitude compared to p1 for each corresponding scenario ebb dominance under low discharge both at the bottom and surface are primarily induced by m2 k1 o1 while the contribution from m2 u0 plays a secondary role near the surface γ 0 19 in fig 10g with increased river discharge m2 u0 prevails and the contributions from m2 k2 o1 decrease in magnitude by 40 and 35 for bottom and surface flows respectively near the bottom increased river discharge results in a transition from ebb to flood dominance contributions from non tidal oscillations are negligible fig 10e during low discharge and become evident in the high discharge scenarios fig 10f especially m2 u0 increased from 0 14 to 0 93 near the surface the velocity asymmetry remains ebb dominant from low to high discharge scenario but the intensity increases the largest change happens to m2 u0 while changes from other subtidal flow related contributors are minimal variations of the velocity asymmetry in the lower estuary are associated with both the increased m2 tidal velocity amplitude fig 5 and the enhanced estuarine circulation where there is a strengthening of seaward subtidal flows at the surface and landward subtidal flows near the bottom fig 7 to summarize the effects of enhanced caloosahatchee river discharge on velocity asymmetries manifest primarily as decreased interactions between semidiurnal and diurnal constituents and increased interactions between semidiurnal and subtidal flows as a result ebb dominance near the surface is strengthened both along the caloosahatchee river channel and in the lower estuary near the bottom flood dominance along the caloosahatchee river channel is reversed to ebb dominance under a high discharge condition in the lower estuary near bottom ebb dominance switches to flood dominance 4 4 modifications of bottom friction under the influence of river discharge to further understand the dynamical adjustments of caloosahatchee river estuary to the river discharge and to ascertain the driving force behind the alterations of tidal behaviors such as upstream damping and downstream amplification of tidal currents we diagnosed and compared the momentum balance for the model scenarios considered like most estuary systems momentum balances in caloosahatchee river estuary are primarily among dynamic pressure gradient 1st 2nd terms right hand side r h s of equation 1 and 2 stress divergence 3rd term r h s and horizontal advection 2nd 4th terms left hand slide l h s with residuals explained by the coriolis acceleration 5th term l h s and viscous effects 4th term r h s when tides enter the estuary their distortion amplification and dissipation mainly depend on the competition between pressure gradient and bottom friction in the presence of a river the freshwater discharge increases the downstream directed barotropic pressure gradient and induces a baroclinic pressure gradient due to water density gradients both processes exert influence on the 3 dimensional subtidal circulation the river induced subtidal flows may cause modifications of the total current velocities near the bottom and thus produce different bottom stresses on the astronomic tidal propagation modifications to tidally averaged bottom stress caused by changes in river discharge indicate spatial variability fig 11 a high river discharge minus low river discharge scenarios the mean bottom stress increases along the main river channel and a decrease in san carlos bay this explains the modifications of tidal velocity amplitudes upstream tidal damping and amplification in the lower estuary fig 5 furthermore three representative cross sections cs1 to cs3 fig 11b d elucidate the vertical structure of tidally averaged subtidal flows and the corresponding magnitudes of bottom stress section cs1 is selected upstream close to fort myers which is directly impacted by the fluvial discharge sections cs2 and cs3 lie in the middle of san carlos bay and the transition to the gulf of mexico the vertical structure of subtidal flows at cs1 shows contrasting response to those at cs2 and cs3 fig 11 at cs1 subtidal flows had the typical two layer structure under low river discharge condition indicating exchange flow fig 11 the two layer subtidal flow was overwhelmed by the enhanced riverine flow and became unidirectional seaward in the high river discharge scenario second panel in fig 11b as a result the mean bottom stress increased roughly 50 in magnitude third panel in fig 11b in the lower estuary the mean subtidal flows showed lateral variations associated with the complex bathymetry under the low river discharge scenario first panels in fig 11c d in the high river discharge scenario second panels in fig 11c d the far reaching freshwater discharge intensifies the vertical stratification enhancing the vertically sheared subtidal flow especially in relatively deeper channels the seaward subtidal flows on the surface and landward inflow near the bottom are consistent with fig 8 the increased landward bottom inflow counteracts the dominant ebb tidal currents and reduces the total current near the bottom thus decreasing the bottom stress effects third panel in fig 11c d this explains the amplification of astronomical tides in the lower estuary in addition temporal variations of the depth averaged momentum balance are presented in the supplementary materials figs s2 and s3 along the river channel the momentum balance is mainly between the pressure gradient and friction compared to the low discharge scenario the pressure gradient term decreases during floods and increases during ebb at the same time the bottom stress increases 100 during ebbs and slightly decreases 10 during floods in the lower estuary advection gains more importance due to a more complex bathymetry bottom stress decreases in the high discharge scenario especially during ebb and spring tide periods the temporal variations of the dynamical terms reflect again the role of river enhanced estuarine circulation played in modifying the bottom frictional effects in the lower estuary to summarize the momentum balances in the caloosahatchee river estuary were mainly among pressure gradient bottom stress and horizontal advection effects of increased river discharge and its associated subtidal flows generated different frictional effects along the caloosahatchee river channel and the lower estuary thus influencing the astronomical tidal propagations along the river channel tidal velocity amplitudes decreased with the increased frictional effects which was mostly attributed to the strong interactions between the riverine and tidal flow in the lower estuary tidal currents were amplified because of the reduction of the bottom stress which was related to the enhanced freshwater induced estuarine circulation especially in the relatively deeper channels 5 discussion velocity asymmetries are quantified by the velocity skewness γ eqs 3 8 which accounts for the combined effects of overtides triad interactions between tidal components and subtidal flows barotropic baroclinic subtidal flows have been usually disregarded when looking at the velocity asymmetry as the focus has been the tidal asymmetry rather than the velocity asymmetry nonetheless subtidal flows affect the difference between the peak flood and ebb velocities for example the long term morphodynamic evolution of estuaries is highly influenced by the velocity asymmetry and not just the tidal asymmetry moreover velocity asymmetries affect water quality estuarine flushing and residence times the approach described in this study should be applicable to any semi enclosed basin having velocity asymmetries the approach quantifies velocity asymmetry drivers and how they vary under different forcing conditions e g changes during spring to neap tidal cycles or during wind pulses eq 8 provides the relative contribution of overtides compound tides and subtidal flows to the velocity asymmetry such relative contributions in turn will be affected by rising water levels variations in rain river discharge and wind stress and human interventions like changing water depths in semi enclosed basins by understanding the mechanisms responsible for velocity asymmetries one could determine morphodynamic and water quality consequences although this study focused on the caloosahatchee river estuary it is expected that freshwater flow changes will be similar in shallow micro tidal estuaries with mixed diurnal semidiurnal tides the estuarine cross sectional area and its variation along the estuary dictates how the freshwater flux translates into velocities thus the larger the cross sectional area the smaller will be the flow associated with a given freshwater discharge in estuaries with relatively small cross sectional area we would expect the highest impacts of freshwater fluxes in these types of narrow and shallow estuaries the density gradient will be displaced seaward more efficiently other factors that might play a key role in the velocity asymmetry and specifically the relevance of the physical processes dominating such asymmetry are the tidal amplitude relative to the water depth and the amount of water stratification for those estuaries with a relatively large tidal amplitude tidal asymmetries might play a more relevant role previous studies have demonstrated that overtides m4 and m6 can arise from river tide interactions blanton et al 2002 sassi and hoitink 2013 guo et al 2015 2021 in this study we only analyzed the overtides and compound generated from the interaction between four principal tidal constituents other combinations of tidal constituents compound and overtides also affect the velocity asymmetry such as mk3 and ms4 e g hoitink et al 2003 gong et al 2016 however their effects are not considered in this study due to their relatively small contributions not shown in estuaries with relatively larger tidal amplitudes these interactions might be more relevant partially mixed estuaries such as the caloosahatchee river estuary are those with the most intense density gradient driven exchange flows therefore we would expect these density driven exchange flows to affect the velocity asymmetry more effectively than in stratified or well mixed estuaries the freshwater discharge the relative tidal amplitude and the degree of stratification of an estuary are constantly changing over time and space subtidal flows in this study refer to velocities with periods longer than the semidiurnal and diurnal tides that exclude astronomical tidal influence subtidal flows are time dependent and sensitive to pulses of freshwater input e g valle levinson et al 2009 2019 the wind the tidal amplitude and the degree of stratification further analysis of the implications of such changes on the tidal propagation and velocity asymmetries are needed to better manage these types of coastal systems 6 summary and conclusions this study investigates the influence of river discharge on tidal and subtidal flows in a microtidal estuary a three dimensional hydrodynamic model roms is applied to the caloosahatchee river estuary a microtidal estuary with mixed semidiurnal diurnal tides special focus is given on the modifications of velocity asymmetry primary contributors tidal subtidal and their interactions to the velocity asymmetry are decomposed and evaluated under different river discharge scenarios results show that changes in river discharge notably modify the tidal propagation subtidal flows and velocity asymmetries within the estuary under the high discharge condition diurnal tidal elevation amplitudes are reduced along the river channel and increased in the lower estuary semidiurnal tidal elevations are amplified in the lower estuary tidal velocity amplitudes decrease along the river channel and increase in the lower estuary with enhanced river discharge changes in tidal elevations and velocities are linked to freshwater induced modifications of bottom stress along the river channel higher river discharge resulted in increased frictional effects and reduced the astronomic tidal velocity amplitudes in the lower estuary enhanced baroclinic circulations under high discharge reduced the mean current during ebbs decreased the frictional effects and amplified the astronomic tidal velocity amplitudes modifications of subtidal flows and velocity asymmetry exhibit three dimensional characteristics enhanced baroclinic circulations are found in the lower estuary while they are suppressed along the river channel the main contributor to the velocity asymmetry along the estuary is the interaction between the subtidal flows and the m2 tidal component except under low freshwater discharge conditions at the lower estuary where the asymmetry is dominated by the triad interaction between the m2 k1 and o1 constituents alterations of the velocity asymmetry are driven by changes in both astronomic tides and subtidal flows they are primarily manifested as decreased interactions between semidiurnal and diurnal constituents and increased interactions between semidiurnal tides and subtidal flows credit authorship contribution statement luming shi methodology validation writing original draft writing review editing collin ortals methodology writing original draft resources arnoldo valle levinson conceptualization methodology writing original draft supervision maitane olabarrieta conceptualization methodology writing original draft writing review editing supervision declaration of competing interest the authors declare no competing interests acknowledgments we thank all developers in the roms toms group the roms model the regional ocean modeling system roms is an open source code distributed using both git and subversion on https www myroms org we would like to thank the river estuary and coastal observing network sanibel captiva conservation foundation recon sccf https recon sccf org and noaa tides and currents https tidesandcurrents noaa gov for providing valuable observational dataset used in this study we are grateful for the support from the center for coastal solutions of the university of florida https ccs eng ufl edu this work was supported by the us army corps of engineers aquatic nuisance species research program under federal award identification number fain w912hz 21 2 0057 by the department of environmental protection under the award awd12194 and by a private donation to the university of florida supplementary materials supplementary material associated with this article can be found in the online version at doi 10 1016 j advwatres 2023 104446 appendix b supplementary materials image application 1 appendix a here we present the derivation of velocity asymmetry expressed as velocity skewness eq 8 the current velocity v is expressed as v i 0 m v i i 0 m a i cos ω i t φ i v 3 i 0 m v i 3 i 0 m v i 3 3 i j 0 i j m v i 2 v j i j k 0 i j k m v i v j v k where v i 3 1 4 a i 3 c o s 3 ω i t 3 φ i 3 c o s ω i t φ i v i 2 v j 1 4 a i 2 a j c o s 2 ω i ω j t 2 φ i φ j c o s 2 ω i ω j t 2 φ i φ j 2 c o s ω j t φ j v i v j v k 1 4 a i a j a k c o s ω i ω j ω k t φ i φ j φ k c o s ω i ω j ω k t φ i φ j φ k c o s ω i ω j ω k t φ i φ j φ k c o s ω i ω j ω k t φ i φ j φ k v 2 i 0 m v i 2 i 0 m v i 2 i j 0 i j m v i v j where v i 2 1 2 a i 2 1 c o s 2 ω i t 2 φ i v i v j 1 2 a i a j c o s ω i ω j t φ i φ j c o s ω i ω j t φ i φ j the expectation of each term is expressed as e v i v j 0 e v i 3 0 w h e n ω i 0 a 0 2 c o s φ 0 w h e n ω i 0 e v i 2 1 2 a i 2 w h e n ω i 0 a 0 2 w h e n ω i 0 0 o t h e r s e v i 2 v j 1 4 a i 2 a j cos 2 φ i φ j w h e n ω i 0 1 2 a i 2 a 0 c o s φ 0 w h e n ω i 0 0 o t h e r s e v i v j v k 1 4 a i a j a k c o s φ i φ j φ k w h e n ω i ω j ω k 0 0 o t h e r s therefore γ μ 3 σ 3 e v 3 e v 2 3 2 1 a 0 2 1 2 i 1 n a i 2 3 2 ω i ω j ω k 3 2 a i a j a k cos ϕ i ϕ j ϕ k 2 ω i ω j 3 4 a i 2 a j cos 2 ϕ i ϕ j i 1 n 3 2 a i 2 a 0 cos ϕ 0 a 0 3 cos ϕ 0 
18,investigating the topology of natural fractures and associated flow properties allow for better understanding of fluid flow patterns and mechanical response in fractured reservoirs key points in the energy supply through geothermal systems or in the reduction of net co 2 emissions through carbon capture and storage ccs practices however limited information on the fracture networks is available from seismic data which poses as a challenge in the accurate modeling of fractured reservoirs this work proposes an integrated framework for obtaining fracture networks with real aperture distributions based on x ray computed tomography ct images of core plugs from naturally fractured rock formations we adapt and employ segmentation skeletonization and geometry generation algorithms that are available in open source libraries and licensed software in addition we investigate the contributions of fractures and porous matrix to the equivalent permeability tensor through fluid flow simulations considering three different scenarios for the matrix permeability this work is novel in the coordination of the steps involved in the generation of discrete fracture matrix dfm models from ct scans of core plugs graphical abstract keywords fractured porous media permeability tensor permeability anisotropy aperture distribution data availability data will be made available on request 1 introduction notwithstanding the recent advances and technology development on renewable green energy sources fluid flow in the subsurface remains a key investigation point in the energy supply through geothermal systems tambue et al 2013 guo et al 2019 wang et al 2021 and in the reduction on net co 2 emissions through carbon capture and storage ccs practices castelletto et al 2013 tao et al 2019 wen et al 2021 such investigations comprise the modeling of multiphase flow patterns and the mechanical response in the subsurface in which fractured reservoirs play a significant role berkowitz 2002 iding and blunt 2011 march et al 2018 kadeethum et al 2020 the co 2 trapping in fractured reservoirs for instance is believed to be governed by spontaneous imbibition from the highly conductive fractures into the slightly conductive porous matrix wu et al 2004 agada et al 2016 akbarabadi et al 2017 in addition the significant difference among the pore sizes of porous matrix and aperture sizes of the fractures leads to a substantial distinction between the fluid transmission through the fractures and the rock matrix since the fluid flow primary channels are these fractures the porous matrix ends up playing a supporting role in the fluid transport understanding the geometry and connectivity distributions of fracture networks allows for better comprehending the fluid flow patterns and mechanical response in fractured reservoirs as they impact the strength deformation and permeability of the rock formation hardebol et al 2015 nick et al 2011a zhu et al 2021 glad et al 2022b conversely limited information on the fracture networks is available from seismic data given their multi scale sizes loza espejel et al 2020 and the investigation of natural fractures topology and associated flow properties is often grasped through outcrop studies bisdom et al 2016 2017 azizmohammadi and sedaghat 2020 coupled with core and well data nonetheless such approaches rely on two dimensional analyzes which have been shown to provide inaccurate direct estimations of three dimensional equivalent permeability lang et al 2014 alternatively x ray computed tomography ct scanning has been successfully applied for imaging core samples yu et al 2018 saxena et al 2019 appelquist løge et al 2022 glad et al 2022a and analyzing the dynamic in situ fluid flow pattern development zhu et al 2007 bultreys et al 2016 rozhko et al 2018 rasmussen et al 2021 thus posing as an alternative source for generating fracture networks and obtaining realistic aperture distributions this approach requires the reconstructed ct image to be segmented which can be done via traditional methods macqueen 1967 otsu 1979 or more recently with machine learning taibi et al 2019 zhang et al 2021 reinhardt et al 2022 furthermore a surface skeletonization algorithm reniers et al 2008 au et al 2008 jalba et al 2013 in which we reduce the fractures 3d to 2d object is necessary for employing mixed dimensional models such models allow a substantial reduction in the cost of numerical simulations while keeping the accuracy of discrete fracture matrix dfm representations martin et al 2005 matthäi et al 2010 nick and matthäi 2011 berre et al 2019 shafabakhsh et al 2021 younes et al 2023 this work presents an integrated framework for obtaining the equivalent permeability tensor of small scale fracture networks with real aperture distributions which are based on ct scans of core plugs from naturally fractured rock formations moreover we are concerned with the feasibility of the framework on generating ct based dfm models rather than the implementation of more complex algorithms that would result in more accurate identification of the fracture networks hence we employ segmentation bradski 2000 skeletonization van der walt et al 2014 and geometry generation mcneel et al 2011 zhou 2017 algorithms that are available in open source libraries and licensed software the output of this framework is a dfm model represented by an unstructured mesh with discrete fractures from which an equivalent permeability tensor can be calculated this work is novel in the coordination of the steps that are involved in the generation of dfm models from ct scans of core plugs which produces 3d fracture networks from samples of the subsurface rock formation this paper is divided as follows in section 2 we outline the steps in proposed framework for obtaining the dfm model from ct scans of core plugs we review and discuss some methods available for fracture matrix segmentation surface skeletonization and geometry generation following we present the mesh generation and fluid flow simulation using the derived dfm models section 3 presents the results of the application of this framework for ct scans of core plugs extracted from the valdemar field mokhtari 2023 more specifically the tuxen formation from lower cretaceous we show the output from each step in this framework for some samples and discuss the relationship between the permeability of the porous matrix and the anisotropy of the equivalent permeability of the sample 2 methodology in this section we describe the proposed framework ferreira 2023b for generation of discrete fracture matrix dfm models from ct scans of fractured core plugs we illustrate the framework in fig 1 the 3d image of the core plug is first reconstructed from the ct scans slices and cropped into a box as our framework for calculation of equivalent tensor permeability cannot handle cylinder shaped models next we segment the 3d image to produce a binary object in which the fractures are detected and segregated from the porous matrix this is done through an adaptive thresholding method available in the opencv library bradski 2000 this method considers small neighborhoods of pixels and finds an optimal threshold value for each neighborhood this results in different threshold values for the different regions of the ct sample which gives better results for images with varying illumination following the binary 3d image is used for the generation of the surface skeleton of the fractures for that we employ a skeletonization algorithm lee et al 1994 which is available in the scikit image library van der walt et al 2014 the original binary image is again used along a medial axis algorithm available in the scikit image library for measuring the aperture distribution of the fractures the skeleton 3d image is then used for the generation of the box shaped geometry with internal fracture surfaces the fracture surfaces are obtained through a marching cubes algorithm lorensen and cline 1987 implemented on rhinoceros mcneel et al 2011 this algorithm generates very fine triangulated meshes which are then simplified using pymesh zhou 2017 and then converted to nurbs surfaces with rhinoceros finally the cad geometry containing the box shaped model with internal fracture surfaces is meshed using ansys icem cfd ansys inc 2017 and the output is converted ferreira 2023a to any of the mesh formats supported by meshio schlömer 2022 which allows the usage of different reservoir simulation frameworks with the our dfm models in the following subsections we further detail the steps involved in the generation of mixed dimensional models from the ct images of fractured core plugs 2 1 reconstruction and segmentation the first step in our framework is the reconstruction and segmentation of the ct scans that aims at producing box shaped binary images of part of the core plugs in which fractures and porous matrix are explicitly segregated and labeled the ct images are composed of a sequence of slices in the z direction this slices are grouped into a 3d image and a box shaped region in the center of the plugs is cropped the 3d image is basically a three dimensional array in which the pixel value correlates to the density measured with the ct scanner the pixels that correspond to fractures have different values than the ones that correspond to the porous matrix but both features fractures and porous matrix present pixels within a certain range of values this is illustrated in fig 2 by employing a segmentation method we are able to differentiate to some extent fractures and porous matrix global thresholding are among the conventional segmentation methods for instance otsu s binarization method otsu 1979 and k means clustering macqueen 1967 whereas some methods rely on graph cut algorithms li et al 2005 jeppesen et al 2020 alternatively machine learning based methods have been shown as prominent approaches for segmentation of fractured rocks taibi et al 2019 zhang et al 2021 reinhardt et al 2022 in this work we employ simple thresholding methods as we are more concerned with the feasibility of the framework on generating mixed dimensional models from ct scans rather the implementation of more complex algorithms that would provide more accurate representations of the fractures however when employing a basic thresholding method a single threshold value is used which may not suffice for proper segmentation of the image a single value may lead to a good segmentation of some portion of the image and might utterly fail in another part due to varying lighting condition or noise in the image for example for that reason we employ an adaptive thresholding method available in the opencv library bradski 2000 an adaptive thresholding method considers small sets of neighboring pixels and finds optimal thresholding values for each specific region thus improving the thresholding and overcoming lightning or noise issues for instance this is illustrated in fig 3 for a ct imaged core plug from the valdemar field at the danish north sea mokhtari 2023 the basic thresholding fails to segregate the small fractures from the porous matrix and increasing the thresh value ends up adding noise to the image an adaptive thresholding method on the other hand enables the detection of the small fractures since the thresh value is determined automatically for small neighborhoods the segmented images are grouped in a binary 3d image and saved in a vtk file schroeder et al 2006 which we use next for surface skeletonization of the fractures in these segmented images the pixels corresponding to the porous matrix have values 255 and the pixels corresponding to fractures have values 0 2 2 skeletonization and aperture measurement the second step in the framework is the surface skeletonization of the fractures contained in the segmented images our goal is to employ a mixed dimensional modeling for fractures and porous matrix martin et al 2005 matthäi et al 2010 nick and matthäi 2011 this means that the porous matrix should be modeled as 3d objects whereas fractures should be modeled as 2d objects an equi dimensional model that is the case in which both fractures and porous matrix are modeled as 3d objects requires a fine mesh to accurately represent the geometry and aperture distribution of the fractures a mixed dimensional model on the other hand allows the employment of coarser grids while keeping the accuracy of an explicit description of the fractures martin et al 2005 berre et al 2019 since the segmented images contain fractures as 3d objects we need to use a skeletonization algorithm to reduce the fractures to surfaces on skeletonization algorithms some methods were developed for volumetric representations reniers et al 2008 hesselink and roerdink 2008 cao et al 2013 while others were developed for polygonal models au et al 2008 jalba et al 2013 anew we are concerned with the feasibility of the framework thus despite some of these methods offer substantially speed ups of the skeletonization procedure we rather proceed with a simple algorithm based on lee s method lee et al 1994 available in the scikit image library van der walt et al 2014 this method uses an octree data structure of 3 3 3 lattice points to inspect the local connectivity the algorithm then proceed by iteratively sweeping over the image and removing pixels at each iteration in such way that the connectivity of the image is preserved until there is no further changes in the image lee s method was designed for 3d images however the implementation in the scikit image library produces single pixel wide skeletons i e line skeletons as aforementioned we are interested in reducing the fracture objects from 3d representations to 2d representations i e surface skeletons therefore we need to adapt the usage of the algorithm from van der walt et al 2014 for our needs as outlined in the algorithm 1 we employ a skeletonization in each slice of the 3d binary image which means that we reduce the fracture area in each slice to lines we start with the segmented image in which porous matrix is represented by pixel values 255 and fractures are represented by pixel values 0 this image is inverted such that porous matrix is represented by pixel values 0 and fractures are represented by pixel values 1 and such binary image is the input of our skeletonization algorithm we create two 3d images with zero valued pixels and same shape of the binary image one for saving the skeleton and one for saving thickness estimate and proceed with the surface skeletonization of the input image the skeletonization procedure is performed in all three directions thus producing 3 surface skeletons with different shapes and sizes in each direction we loop through each slice of the input image obtaining a skeletonized slice through lee s algorithm lee et al 1994 and the thickness estimate for thickness estimate we use a medial axis transform algorithm available in the scikit image library van der walt et al 2014 for obtaining the distance transform to the background grevera 2007 the skeletonized slice has pixel values 1 for the skeleton and 0 elsewhere and we compare it with the current slice saved in the 3d skeleton image if the skeletonized slice has a larger summation than the currently saved in the 3d skeleton image i e if it was able to capture better the topology of the fracture network than we overwrite the currently saved with the new one we keep also the corresponding thickness slice we use the surface skeleton for generating the cad geometry and meshing while the thickness is used for estimating the aperture distribution later used for fluid flow modeling 2 3 geometry generation and meshing given the 3d image that represents the surface skeleton of the fractures we aim at generating a box shaped cad geometry with internal fracture surfaces for that we first employ a marching cubes algorithm lorensen and cline 1987 available on rhino mcneel et al 2011 for generating a very fine triangulated mesh conforming with the points in the skeletonized image this fine mesh is saved into an stl file which is simplified using pymesh zhou 2017 as summarized in algorithm 2 the simplification is done by iteratively collapsing short edges and splitting long edges in an alternating fashion until the number of vertices does not change anymore this produces a mesh that preserves sharp features i e the geometry of the fractures but with larger elements the coarse mesh produced by algorithm 2 is imported to rhino and we generate a polysurface composed of the mesh facets converted to nurbs the box shaped cad geometry is generated considering the dimensions of the inputted ct scan which is finally meshed using ansys icem cfd ansys inc 2017 and the output mesh is converted using ansys2meshio ferreira 2023a to any mesh format supported by meshio schlömer 2022 this last step is necessary for correctly assigning the aperture permeability distribution of the fractures to the mesh elements the aperture distribution obtained in the skeletonization step is averaged for each fracture element in the mesh furthermore meshio schlömer 2022 permits exporting the outputted mesh to several mesh formats which allows the usage of different numerical simulation frameworks for instance xdmf format xdmf contributors 2022 and fenics logg et al 2012 alnaes et al 2015 gmsh format geuzaine and remacle 2009 and porepy keilegavlen et al 2021 or dumux flemisch et al 2011 koch et al 2021 cgns format poirier et al 1998 and efvlib honorio et al 2018 vtk format schroeder et al 2006 and geosx settgast et al 2022 among others 2 4 fluid flow modeling here we describe the employed fluid flow model for fractured porous media and present the governing equations used in the this work following we discuss the numerical method used for our simulations and we outline the procedure for upscaling an equivalent permeability tensor for each ct sample to obtain full equivalent permeability tensors we must solve a series of incompressible single phase flow problems over the meshes generated with this framework the core plugs used in this work are composed of chalk which has significant difference among pore throat sizes and aperture sizes of fractures leading to a substantial distinction between the fluid transmission through fractures and rock matrix glad et al 2022b to ensure an accurate estimation of the fluid flow pattern and balancing with the computational cost we employ a mixed dimensional model martin et al 2005 matthäi et al 2010 nick and matthäi 2011 berre et al 2019 shafabakhsh et al 2021 younes et al 2023 in which the porous matrix is discretized using volume elements and the fractures are discretized using surface elements the finite element discretization of the fluid flow model is carried with the academic multi institutional numerical framework csmp matthäi et al 2007a b nick et al 2011b paluszny and zimmerman 2011 developed in c and the solution of the linear system of equations is carried with the system algebraic multigrid samg stüben 2001 stüben et al 2017 gries 2018 the upscaling of an equivalent permeability tensor durlofsky 1991 lang et al 2014 is performed by solving three independent problems in directions x y and z for the first problem we assume a constant pressure of 1 1 0 8 pa on the left boundary and 1 1 0 5 pa on the right boundary with no flow on top bottom back and front boundaries for the second problem we prescribe 1 1 0 8 pa on the bottom boundary and 1 1 0 5 pa on the top with no flow on left right back and front boundaries finally we solve the third problem with 1 1 0 8 pa and 1 1 0 5 pa prescribed on the front and back boundaries respectively and no flow on left right bottom and top boundaries we denote p 1 p 2 and p 3 as the pressure solution of the first second and third problems respectively furthermore we define 1 ω 1 v box ω d v γ f a d s where v box ω d v γ a d s we may obtain the equivalent permeability tensor k eq given by 2 k eq k x x k x y k x z k y x k y y k y z k z x k z y k z z from the solution of the linear system a t w a x μ a t w b with 3 a g 1 1 g 1 2 g 1 3 g 2 1 g 2 2 g 2 3 g 3 1 g 3 2 g 3 3 c 1 c 2 c 3 4 w 1 a 2 i 9 0 0 a i 3 5 x t k x x k x y k x z k y x k y y k y z k z x k z y k z z 6 b t u 1 ω v 1 ω w 1 ω u 2 ω v 2 ω w 2 ω u 3 ω v 3 ω w 3 ω 0 0 0 where u i v i and w i are the components of the fluid flow velocity vector v i for the i th problem and the matrices g i j and c j are given by 7 g i 1 p i x ω p i y ω p i z ω 0 0 0 0 0 0 8 g i 2 0 0 0 p i x ω p i y ω p i z ω 0 0 0 9 g i 3 0 0 0 0 0 0 p i x ω p i y ω p i z ω 10 c 1 0 1 0 0 0 1 0 0 0 11 c 2 1 0 0 0 0 0 0 0 1 12 c 3 0 0 0 1 0 0 0 1 0 furthermore i n is a n n identity matrix and w is a penalty matrix in the linear system a t w a x μ a t w b for enforcing the constraints provided by c 1 c 2 and c 3 3 results in this section we present and discuss some results from the framework outlined in section 2 six different core plugs from the valdemar field more specifically the tuxen formation from the lower cretaceous were imaged with a ct scanner mokhtari 2023 and the samples were named s1 s2 s3 s4 s5 and s6 fig 4 depicts the cross sections of the sample s4 we notice one large fracture parallel to the plane x y and no other fracture is visible we first crop a block with size 260 240 650 in pixels we apply the segmentation procedure outlined in section 2 1 and the result is shown in mid panel of fig 5 we notice that the large fracture is well captured by the segmentation procedure however some noise is also observed this is due to the presence of minerals that have high density thus affecting the efficiency of the adaptive thresholding method in spite of that some of the noise is removed by the skeletonization and geometry generation steps as we see in the right most panel of fig 5 fig 6 depicts the cross sections for the sample s3 the density of fractures is much larger for this sample than for sample s4 where we notice one large fracture nearly normal the plane x y with several small ones immersed in the sample the sample is cropped into a block with size 260 240 650 in pixels and segmented the resulting binary image is shown in the mid panel of fig 7 we notice that the adaptive thresholding method is able to capture the large fracture and the small ones following the segmented image is skeletonized and we generate the box shaped geometry with internal fractures as depicted in right most panel of fig 7 as expected the cad geometry shows a high number of immersed fractures which should have a high influence in the fluid flow patterns in this sample fig 8 shows the cad geometries for samples s1 s6 it is noteworthy that samples s1 s4 and s6 all have large fractures crossing the box shaped model from one side to another whilst sample s5 only have some small immersed fractures the cad geometries are then meshed with ansys icem cfd and the outputted mesh are converted to csp format so it can be used with csmp we then are able to solve the fluid flow problems in all three directions as outlined in section 2 4 we illustrate in fig 9 the fluid flow results for the problem in the z direction for sample s3 the right panel shows the pressure and flow velocity distributions obtained through the solution of the fluid flow problem in z direction in the left panel we have the permeability distribution in the sample this distribution comprises the permeability of the porous matrix assumed to be isotropic and equal to k 1 0 22 i 3 m 2 in this case and the equivalent permeability of the fracture given by k f a h 2 12 i 2 here a h denotes the hydraulic aperture of the fracture given by the model proposed by neuzil and tracy 1981 as outlined in he et al 2021 this hydraulic aperture model may be used when the fracture aperture varies only in the direction normal to the pressure gradient inside the fracture this is the case for the fracture elements in our mixed dimensional model the lower dimensional representation of the fractures conforms with the midsurface of the fracture 3d objects which is generated through the skeletonization procedure therefore the fractures in our model are aligned with the direction of fluid flow inside them we investigate the influence of the fracture network in the equivalent permeability tensor by varying the permeability of the matrix in different tests the first test considers a homogeneous isotropic matrix whereas the second and third tests consider heterogeneous isotropic and anisotropic matrix permeability respectively 3 1 homogeneous isotropic matrix we solved the three fluid flow problems with varying permeability in the porous matrix for each one of the samples as aforementioned there is a significant distinction between the flow through the fractures and through the porous matrix in chalk due to the large difference between the sizes of the pore throats and the fracture aperture to investigate when the matrix permeability becomes influential to the overall permeability tensor we simulate fluid flow with matrix ranging from very low to high permeability the matrix permeability was assumed homogeneous isotropic with k k m i 3 and k m ranging from 10 22 to 10 12 m 2 fig 10 depicts the equivalent permeability tensor anisotropy against the varying permeability k m of the porous matrix the anisotropy is defined as the ratio of maximum and minimum principal components of the permeability tensor in this work referred as k max and k min respectively we notice that for samples s1 s2 and s3 the anisotropy does not change up to around k m 1 0 19 m 2 meaning that the fluid flow is not sensitive to the matrix permeability and is dominated by the fractures for samples s4 and s6 the anisotropy does not change up to around k m 1 0 18 m 2 and k m 1 0 20 m 2 respectively and lastly s5 presents isotropic behavior regardless of the matrix permeability the difference in the anisotropic behavior of the samples is due to the minimum component being more susceptible to changes in the matrix permeability fig 11 shows the maximum and minimum components of the equivalent permeability tensor for each sample versus the matrix permeability we notice that for all samples but s5 the maximum component remains constant up to higher matrix permeability around 10 18 to 10 16 when compared to the minimum component which starts varying for matrix permeability values around 10 19 3 2 heterogeneous isotropic matrix as noted before in fig 8 sample s5 has no fractures crossing the entire sample or any large fracture whatsoever which explains the isotropic behavior observed in figs 10 and 11 this sample has been characterized by mokhtari and feilberg 2022 with average porosity of 37 3 we considered the average pixel density of 125 76 of the ct scans of sample s5 and the measured average porosity to populate the porosity distribution for each sample s1 s6 we assumed that density 0 correlates to porosity 100 density 125 76 correlates to porosity 37 3 and density 255 correlates to porosity 0 and interpolated porosity given the pixel density distribution fig 12 illustrates the histogram of the porosity distribution for samples s1 s6 interpolated from the pixel density from the ct scans we observe no significant difference among the porosity distributions of the samples with exception of sample s3 the average porosity is 35 1 36 3 30 2 36 5 and 36 4 for samples s1 s2 s3 s4 and s6 respectively we populated heterogeneous permeability distributions to the matrices of samples s1 s6 through the correlation for gas permeability as function of porosity for middle upper tuxen and for lower tuxen by glad et al 2022b both corrected using the klinkenberg correlation for chalk by mortensen et al 1998 we considered both correlations for the tuxen formation to test scenarios with higher and lower contrast in the matrix permeability as the correlation for middle upper tuxen provides gas permeability ranging from 0 001 to 10 md whereas the correlation for lower tuxen provides gas permeability in the range 0 1 2 md let k kl ϕ denote the klinkenberg permeability for tuxen formation glad et al 2022b mortensen et al 1998 then we have k k kl ϕ i 3 and 13 k m 1 v ω k kl ϕ d v with v ω d v fig 13 shows the anisotropy and the maximum component of the equivalent permeability tensor for the valdemar samples considering heterogeneous isotropic matrix permeability we plot anisotropy and maximum component versus k m given by eq 13 and compare to the results obtained previously with homogeneous matrix the results obtained with heterogeneous matrix match with the ones obtained for homogeneous matrix for both cases of high and low permeability contrast in the matrix we also highlight the relative difference between the anisotropy for the homogeneous case and for the heterogeneous case for some samples this shows that the heterogeneity in the porous matrix does not affect the maximum and minimum components of the equivalent permeability of these samples 3 3 heterogeneous anisotropic matrix our last test considers anisotropy in the porous matrix due to compaction and cementation we assume a heterogeneous matrix permeability but in this case an anisotropic tensor the angle observed in the matrix permeability for such cases depends on the orientation of the well from which the plug was extracted in this test we consider two hypothetical well orientations vertical and horizontal we use the heterogeneous matrix permeability with both low and high contrast from the previous test case but for the vertical well case we divide the z component of the matrix permeability tensor by 10 and for the horizontal well case we divide the y component of the matrix permeability tensor by 10 let k vert denote the matrix permeability for the vertical well case and k horiz denote the matrix permeability for the horizontal well case hence we have 14 k vert k kl ϕ 0 0 0 k kl ϕ 0 0 0 k kl ϕ 10 k horiz k kl ϕ 0 0 0 k kl ϕ 10 0 0 0 k kl ϕ 15 k m 1 v ω 1 3 tr k d v with k being k vert or k horiz fig 14 shows the anisotropy and the maximum component of the equivalent permeability tensor considering heterogeneous anisotropic matrix permeability using both correlations for higher or lower contrast in the heterogeneity again we compare to the results obtained previously with homogeneous isotropic matrix the results obtained with anisotropic matrix are still close to the ones obtained for isotropic matrix for both cases of vertical and horizontal well with high contrast in the matrix however there is a large deviation in the results for the cases with the low contrast in the matrix for the latter cases the anisotropy is closer to one hence the matrix affects more the fluid flow pattern when compared to cases with higher anisotropy 4 discussion for each one of the samples s1 s6 we obtained the ct based dfm model and we used the fracture network topology for estimating the fracture density p32 and fracture porosity p33 the results are compiled in table 1 we also compile here the maximum component and the anisotropy of the equivalent permeability of the samples for the heterogeneous isotropic case there is no clear correlation between the fracture characteristics that is the fracture density and the fracture porosity and the principal components of the equivalent permeability tensor the strong anisotropy arises because samples s1 s4 and s6 all have fractures connecting opposite sides of the box shaped model whilst sample s5 has only a few small immersed fractures which explains the isotropic behavior observed for this sample this is in accordance with the findings of nick and bisdom 2018 to investigate the influence of the matrix permeability in the equivalent permeability tensor we illustrate as ellipsoids in fig 15 the tensors for samples s1 and s3 for the homogeneous isotropic test case and the tensors for samples s4 and s6 for the heterogeneous isotropic test case the relative difference between the anisotropy in the homogeneous and heterogeneous isotropic cases for these samples is very small as shown in fig 13 we illustrate the equivalent permeability tensors as ellipsoids such that the principal components of the tensor are represented by the axes of the ellipsoid and the principal orientation is associated with orientation of the ellipsoid the left panels of fig 15 show the ellipsoids for samples s1 and s3 for both the homogeneous isotropic case and the heterogeneous isotropic case with high contrast in the matrix and the right panels show the ellipsoids for samples s4 and s6 for both the homogeneous and the heterogeneous isotropic case with low contrast in the matrix the wireframe ellipsoids represent the homogeneous cases and the surface ellipsoids represent the heterogeneous cases there is no difference between the ellipsoids for sample s6 in both shape and orientation conversely despite having nearly the same anisotropy in the anisotropy for the homogeneous and heterogeneous cases difference smaller than 0 5 samples s1 s3 and s4 all depict different orientations this shows that the principal orientation varies with the matrix permeability reflecting that the orientation is impossible to be extracted from the fracture topology itself 5 conclusion in this work we present an integrated framework for deriving fracture networks with real aperture distributions based on ct scans of core plugs from naturally fracture rock formations we test this framework with 6 core plug samples and we investigate the contribution of fractures and porous matrix to the equivalent permeability tensor of each sample by considering three different scenarios for the matrix permeability 1 homogeneous isotropic 2 heterogeneous isotropic and 3 heterogeneous anisotropic our key results are as follows our framework can successfully generate discrete fracture matrix dfm models with real aperture distributions from ct scans of core plugs we generate dfm models with lower dimensional representation for the fractures and map fracture aperture and matrix permeability heterogeneity from ct images which enable accurate calculation of flow properties of fractured rock samples we observe a strong anisotropy in the equivalent permeability tensors when the matrix permeability is low there is nearly no difference between the anisotropy for the homogeneous and heterogeneous cases when considering isotropic matrix permeability for the studied chalk samples despite observing no variation in the anisotropy the principal orientation varies with the matrix permeability reflecting that it is not possible to extract the orientation of the tensor from the fracture topology alone credit authorship contribution statement carlos a s ferreira conceptualization methodology software validation investigation formal analysis writing original draft visualization hamidreza m nick conceptualization methodology resources writing review editing supervision funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments carlos a s ferreira and hamid m nick are both supported by the danish offshore technology centre dtu offshore and the research leading to the results in this paper has received funding from dtu offshore under the advanced water flooding program computer code availability the scripts used in this work are available at dtu s gitlab ferreira 2023a b 
18,investigating the topology of natural fractures and associated flow properties allow for better understanding of fluid flow patterns and mechanical response in fractured reservoirs key points in the energy supply through geothermal systems or in the reduction of net co 2 emissions through carbon capture and storage ccs practices however limited information on the fracture networks is available from seismic data which poses as a challenge in the accurate modeling of fractured reservoirs this work proposes an integrated framework for obtaining fracture networks with real aperture distributions based on x ray computed tomography ct images of core plugs from naturally fractured rock formations we adapt and employ segmentation skeletonization and geometry generation algorithms that are available in open source libraries and licensed software in addition we investigate the contributions of fractures and porous matrix to the equivalent permeability tensor through fluid flow simulations considering three different scenarios for the matrix permeability this work is novel in the coordination of the steps involved in the generation of discrete fracture matrix dfm models from ct scans of core plugs graphical abstract keywords fractured porous media permeability tensor permeability anisotropy aperture distribution data availability data will be made available on request 1 introduction notwithstanding the recent advances and technology development on renewable green energy sources fluid flow in the subsurface remains a key investigation point in the energy supply through geothermal systems tambue et al 2013 guo et al 2019 wang et al 2021 and in the reduction on net co 2 emissions through carbon capture and storage ccs practices castelletto et al 2013 tao et al 2019 wen et al 2021 such investigations comprise the modeling of multiphase flow patterns and the mechanical response in the subsurface in which fractured reservoirs play a significant role berkowitz 2002 iding and blunt 2011 march et al 2018 kadeethum et al 2020 the co 2 trapping in fractured reservoirs for instance is believed to be governed by spontaneous imbibition from the highly conductive fractures into the slightly conductive porous matrix wu et al 2004 agada et al 2016 akbarabadi et al 2017 in addition the significant difference among the pore sizes of porous matrix and aperture sizes of the fractures leads to a substantial distinction between the fluid transmission through the fractures and the rock matrix since the fluid flow primary channels are these fractures the porous matrix ends up playing a supporting role in the fluid transport understanding the geometry and connectivity distributions of fracture networks allows for better comprehending the fluid flow patterns and mechanical response in fractured reservoirs as they impact the strength deformation and permeability of the rock formation hardebol et al 2015 nick et al 2011a zhu et al 2021 glad et al 2022b conversely limited information on the fracture networks is available from seismic data given their multi scale sizes loza espejel et al 2020 and the investigation of natural fractures topology and associated flow properties is often grasped through outcrop studies bisdom et al 2016 2017 azizmohammadi and sedaghat 2020 coupled with core and well data nonetheless such approaches rely on two dimensional analyzes which have been shown to provide inaccurate direct estimations of three dimensional equivalent permeability lang et al 2014 alternatively x ray computed tomography ct scanning has been successfully applied for imaging core samples yu et al 2018 saxena et al 2019 appelquist løge et al 2022 glad et al 2022a and analyzing the dynamic in situ fluid flow pattern development zhu et al 2007 bultreys et al 2016 rozhko et al 2018 rasmussen et al 2021 thus posing as an alternative source for generating fracture networks and obtaining realistic aperture distributions this approach requires the reconstructed ct image to be segmented which can be done via traditional methods macqueen 1967 otsu 1979 or more recently with machine learning taibi et al 2019 zhang et al 2021 reinhardt et al 2022 furthermore a surface skeletonization algorithm reniers et al 2008 au et al 2008 jalba et al 2013 in which we reduce the fractures 3d to 2d object is necessary for employing mixed dimensional models such models allow a substantial reduction in the cost of numerical simulations while keeping the accuracy of discrete fracture matrix dfm representations martin et al 2005 matthäi et al 2010 nick and matthäi 2011 berre et al 2019 shafabakhsh et al 2021 younes et al 2023 this work presents an integrated framework for obtaining the equivalent permeability tensor of small scale fracture networks with real aperture distributions which are based on ct scans of core plugs from naturally fractured rock formations moreover we are concerned with the feasibility of the framework on generating ct based dfm models rather than the implementation of more complex algorithms that would result in more accurate identification of the fracture networks hence we employ segmentation bradski 2000 skeletonization van der walt et al 2014 and geometry generation mcneel et al 2011 zhou 2017 algorithms that are available in open source libraries and licensed software the output of this framework is a dfm model represented by an unstructured mesh with discrete fractures from which an equivalent permeability tensor can be calculated this work is novel in the coordination of the steps that are involved in the generation of dfm models from ct scans of core plugs which produces 3d fracture networks from samples of the subsurface rock formation this paper is divided as follows in section 2 we outline the steps in proposed framework for obtaining the dfm model from ct scans of core plugs we review and discuss some methods available for fracture matrix segmentation surface skeletonization and geometry generation following we present the mesh generation and fluid flow simulation using the derived dfm models section 3 presents the results of the application of this framework for ct scans of core plugs extracted from the valdemar field mokhtari 2023 more specifically the tuxen formation from lower cretaceous we show the output from each step in this framework for some samples and discuss the relationship between the permeability of the porous matrix and the anisotropy of the equivalent permeability of the sample 2 methodology in this section we describe the proposed framework ferreira 2023b for generation of discrete fracture matrix dfm models from ct scans of fractured core plugs we illustrate the framework in fig 1 the 3d image of the core plug is first reconstructed from the ct scans slices and cropped into a box as our framework for calculation of equivalent tensor permeability cannot handle cylinder shaped models next we segment the 3d image to produce a binary object in which the fractures are detected and segregated from the porous matrix this is done through an adaptive thresholding method available in the opencv library bradski 2000 this method considers small neighborhoods of pixels and finds an optimal threshold value for each neighborhood this results in different threshold values for the different regions of the ct sample which gives better results for images with varying illumination following the binary 3d image is used for the generation of the surface skeleton of the fractures for that we employ a skeletonization algorithm lee et al 1994 which is available in the scikit image library van der walt et al 2014 the original binary image is again used along a medial axis algorithm available in the scikit image library for measuring the aperture distribution of the fractures the skeleton 3d image is then used for the generation of the box shaped geometry with internal fracture surfaces the fracture surfaces are obtained through a marching cubes algorithm lorensen and cline 1987 implemented on rhinoceros mcneel et al 2011 this algorithm generates very fine triangulated meshes which are then simplified using pymesh zhou 2017 and then converted to nurbs surfaces with rhinoceros finally the cad geometry containing the box shaped model with internal fracture surfaces is meshed using ansys icem cfd ansys inc 2017 and the output is converted ferreira 2023a to any of the mesh formats supported by meshio schlömer 2022 which allows the usage of different reservoir simulation frameworks with the our dfm models in the following subsections we further detail the steps involved in the generation of mixed dimensional models from the ct images of fractured core plugs 2 1 reconstruction and segmentation the first step in our framework is the reconstruction and segmentation of the ct scans that aims at producing box shaped binary images of part of the core plugs in which fractures and porous matrix are explicitly segregated and labeled the ct images are composed of a sequence of slices in the z direction this slices are grouped into a 3d image and a box shaped region in the center of the plugs is cropped the 3d image is basically a three dimensional array in which the pixel value correlates to the density measured with the ct scanner the pixels that correspond to fractures have different values than the ones that correspond to the porous matrix but both features fractures and porous matrix present pixels within a certain range of values this is illustrated in fig 2 by employing a segmentation method we are able to differentiate to some extent fractures and porous matrix global thresholding are among the conventional segmentation methods for instance otsu s binarization method otsu 1979 and k means clustering macqueen 1967 whereas some methods rely on graph cut algorithms li et al 2005 jeppesen et al 2020 alternatively machine learning based methods have been shown as prominent approaches for segmentation of fractured rocks taibi et al 2019 zhang et al 2021 reinhardt et al 2022 in this work we employ simple thresholding methods as we are more concerned with the feasibility of the framework on generating mixed dimensional models from ct scans rather the implementation of more complex algorithms that would provide more accurate representations of the fractures however when employing a basic thresholding method a single threshold value is used which may not suffice for proper segmentation of the image a single value may lead to a good segmentation of some portion of the image and might utterly fail in another part due to varying lighting condition or noise in the image for example for that reason we employ an adaptive thresholding method available in the opencv library bradski 2000 an adaptive thresholding method considers small sets of neighboring pixels and finds optimal thresholding values for each specific region thus improving the thresholding and overcoming lightning or noise issues for instance this is illustrated in fig 3 for a ct imaged core plug from the valdemar field at the danish north sea mokhtari 2023 the basic thresholding fails to segregate the small fractures from the porous matrix and increasing the thresh value ends up adding noise to the image an adaptive thresholding method on the other hand enables the detection of the small fractures since the thresh value is determined automatically for small neighborhoods the segmented images are grouped in a binary 3d image and saved in a vtk file schroeder et al 2006 which we use next for surface skeletonization of the fractures in these segmented images the pixels corresponding to the porous matrix have values 255 and the pixels corresponding to fractures have values 0 2 2 skeletonization and aperture measurement the second step in the framework is the surface skeletonization of the fractures contained in the segmented images our goal is to employ a mixed dimensional modeling for fractures and porous matrix martin et al 2005 matthäi et al 2010 nick and matthäi 2011 this means that the porous matrix should be modeled as 3d objects whereas fractures should be modeled as 2d objects an equi dimensional model that is the case in which both fractures and porous matrix are modeled as 3d objects requires a fine mesh to accurately represent the geometry and aperture distribution of the fractures a mixed dimensional model on the other hand allows the employment of coarser grids while keeping the accuracy of an explicit description of the fractures martin et al 2005 berre et al 2019 since the segmented images contain fractures as 3d objects we need to use a skeletonization algorithm to reduce the fractures to surfaces on skeletonization algorithms some methods were developed for volumetric representations reniers et al 2008 hesselink and roerdink 2008 cao et al 2013 while others were developed for polygonal models au et al 2008 jalba et al 2013 anew we are concerned with the feasibility of the framework thus despite some of these methods offer substantially speed ups of the skeletonization procedure we rather proceed with a simple algorithm based on lee s method lee et al 1994 available in the scikit image library van der walt et al 2014 this method uses an octree data structure of 3 3 3 lattice points to inspect the local connectivity the algorithm then proceed by iteratively sweeping over the image and removing pixels at each iteration in such way that the connectivity of the image is preserved until there is no further changes in the image lee s method was designed for 3d images however the implementation in the scikit image library produces single pixel wide skeletons i e line skeletons as aforementioned we are interested in reducing the fracture objects from 3d representations to 2d representations i e surface skeletons therefore we need to adapt the usage of the algorithm from van der walt et al 2014 for our needs as outlined in the algorithm 1 we employ a skeletonization in each slice of the 3d binary image which means that we reduce the fracture area in each slice to lines we start with the segmented image in which porous matrix is represented by pixel values 255 and fractures are represented by pixel values 0 this image is inverted such that porous matrix is represented by pixel values 0 and fractures are represented by pixel values 1 and such binary image is the input of our skeletonization algorithm we create two 3d images with zero valued pixels and same shape of the binary image one for saving the skeleton and one for saving thickness estimate and proceed with the surface skeletonization of the input image the skeletonization procedure is performed in all three directions thus producing 3 surface skeletons with different shapes and sizes in each direction we loop through each slice of the input image obtaining a skeletonized slice through lee s algorithm lee et al 1994 and the thickness estimate for thickness estimate we use a medial axis transform algorithm available in the scikit image library van der walt et al 2014 for obtaining the distance transform to the background grevera 2007 the skeletonized slice has pixel values 1 for the skeleton and 0 elsewhere and we compare it with the current slice saved in the 3d skeleton image if the skeletonized slice has a larger summation than the currently saved in the 3d skeleton image i e if it was able to capture better the topology of the fracture network than we overwrite the currently saved with the new one we keep also the corresponding thickness slice we use the surface skeleton for generating the cad geometry and meshing while the thickness is used for estimating the aperture distribution later used for fluid flow modeling 2 3 geometry generation and meshing given the 3d image that represents the surface skeleton of the fractures we aim at generating a box shaped cad geometry with internal fracture surfaces for that we first employ a marching cubes algorithm lorensen and cline 1987 available on rhino mcneel et al 2011 for generating a very fine triangulated mesh conforming with the points in the skeletonized image this fine mesh is saved into an stl file which is simplified using pymesh zhou 2017 as summarized in algorithm 2 the simplification is done by iteratively collapsing short edges and splitting long edges in an alternating fashion until the number of vertices does not change anymore this produces a mesh that preserves sharp features i e the geometry of the fractures but with larger elements the coarse mesh produced by algorithm 2 is imported to rhino and we generate a polysurface composed of the mesh facets converted to nurbs the box shaped cad geometry is generated considering the dimensions of the inputted ct scan which is finally meshed using ansys icem cfd ansys inc 2017 and the output mesh is converted using ansys2meshio ferreira 2023a to any mesh format supported by meshio schlömer 2022 this last step is necessary for correctly assigning the aperture permeability distribution of the fractures to the mesh elements the aperture distribution obtained in the skeletonization step is averaged for each fracture element in the mesh furthermore meshio schlömer 2022 permits exporting the outputted mesh to several mesh formats which allows the usage of different numerical simulation frameworks for instance xdmf format xdmf contributors 2022 and fenics logg et al 2012 alnaes et al 2015 gmsh format geuzaine and remacle 2009 and porepy keilegavlen et al 2021 or dumux flemisch et al 2011 koch et al 2021 cgns format poirier et al 1998 and efvlib honorio et al 2018 vtk format schroeder et al 2006 and geosx settgast et al 2022 among others 2 4 fluid flow modeling here we describe the employed fluid flow model for fractured porous media and present the governing equations used in the this work following we discuss the numerical method used for our simulations and we outline the procedure for upscaling an equivalent permeability tensor for each ct sample to obtain full equivalent permeability tensors we must solve a series of incompressible single phase flow problems over the meshes generated with this framework the core plugs used in this work are composed of chalk which has significant difference among pore throat sizes and aperture sizes of fractures leading to a substantial distinction between the fluid transmission through fractures and rock matrix glad et al 2022b to ensure an accurate estimation of the fluid flow pattern and balancing with the computational cost we employ a mixed dimensional model martin et al 2005 matthäi et al 2010 nick and matthäi 2011 berre et al 2019 shafabakhsh et al 2021 younes et al 2023 in which the porous matrix is discretized using volume elements and the fractures are discretized using surface elements the finite element discretization of the fluid flow model is carried with the academic multi institutional numerical framework csmp matthäi et al 2007a b nick et al 2011b paluszny and zimmerman 2011 developed in c and the solution of the linear system of equations is carried with the system algebraic multigrid samg stüben 2001 stüben et al 2017 gries 2018 the upscaling of an equivalent permeability tensor durlofsky 1991 lang et al 2014 is performed by solving three independent problems in directions x y and z for the first problem we assume a constant pressure of 1 1 0 8 pa on the left boundary and 1 1 0 5 pa on the right boundary with no flow on top bottom back and front boundaries for the second problem we prescribe 1 1 0 8 pa on the bottom boundary and 1 1 0 5 pa on the top with no flow on left right back and front boundaries finally we solve the third problem with 1 1 0 8 pa and 1 1 0 5 pa prescribed on the front and back boundaries respectively and no flow on left right bottom and top boundaries we denote p 1 p 2 and p 3 as the pressure solution of the first second and third problems respectively furthermore we define 1 ω 1 v box ω d v γ f a d s where v box ω d v γ a d s we may obtain the equivalent permeability tensor k eq given by 2 k eq k x x k x y k x z k y x k y y k y z k z x k z y k z z from the solution of the linear system a t w a x μ a t w b with 3 a g 1 1 g 1 2 g 1 3 g 2 1 g 2 2 g 2 3 g 3 1 g 3 2 g 3 3 c 1 c 2 c 3 4 w 1 a 2 i 9 0 0 a i 3 5 x t k x x k x y k x z k y x k y y k y z k z x k z y k z z 6 b t u 1 ω v 1 ω w 1 ω u 2 ω v 2 ω w 2 ω u 3 ω v 3 ω w 3 ω 0 0 0 where u i v i and w i are the components of the fluid flow velocity vector v i for the i th problem and the matrices g i j and c j are given by 7 g i 1 p i x ω p i y ω p i z ω 0 0 0 0 0 0 8 g i 2 0 0 0 p i x ω p i y ω p i z ω 0 0 0 9 g i 3 0 0 0 0 0 0 p i x ω p i y ω p i z ω 10 c 1 0 1 0 0 0 1 0 0 0 11 c 2 1 0 0 0 0 0 0 0 1 12 c 3 0 0 0 1 0 0 0 1 0 furthermore i n is a n n identity matrix and w is a penalty matrix in the linear system a t w a x μ a t w b for enforcing the constraints provided by c 1 c 2 and c 3 3 results in this section we present and discuss some results from the framework outlined in section 2 six different core plugs from the valdemar field more specifically the tuxen formation from the lower cretaceous were imaged with a ct scanner mokhtari 2023 and the samples were named s1 s2 s3 s4 s5 and s6 fig 4 depicts the cross sections of the sample s4 we notice one large fracture parallel to the plane x y and no other fracture is visible we first crop a block with size 260 240 650 in pixels we apply the segmentation procedure outlined in section 2 1 and the result is shown in mid panel of fig 5 we notice that the large fracture is well captured by the segmentation procedure however some noise is also observed this is due to the presence of minerals that have high density thus affecting the efficiency of the adaptive thresholding method in spite of that some of the noise is removed by the skeletonization and geometry generation steps as we see in the right most panel of fig 5 fig 6 depicts the cross sections for the sample s3 the density of fractures is much larger for this sample than for sample s4 where we notice one large fracture nearly normal the plane x y with several small ones immersed in the sample the sample is cropped into a block with size 260 240 650 in pixels and segmented the resulting binary image is shown in the mid panel of fig 7 we notice that the adaptive thresholding method is able to capture the large fracture and the small ones following the segmented image is skeletonized and we generate the box shaped geometry with internal fractures as depicted in right most panel of fig 7 as expected the cad geometry shows a high number of immersed fractures which should have a high influence in the fluid flow patterns in this sample fig 8 shows the cad geometries for samples s1 s6 it is noteworthy that samples s1 s4 and s6 all have large fractures crossing the box shaped model from one side to another whilst sample s5 only have some small immersed fractures the cad geometries are then meshed with ansys icem cfd and the outputted mesh are converted to csp format so it can be used with csmp we then are able to solve the fluid flow problems in all three directions as outlined in section 2 4 we illustrate in fig 9 the fluid flow results for the problem in the z direction for sample s3 the right panel shows the pressure and flow velocity distributions obtained through the solution of the fluid flow problem in z direction in the left panel we have the permeability distribution in the sample this distribution comprises the permeability of the porous matrix assumed to be isotropic and equal to k 1 0 22 i 3 m 2 in this case and the equivalent permeability of the fracture given by k f a h 2 12 i 2 here a h denotes the hydraulic aperture of the fracture given by the model proposed by neuzil and tracy 1981 as outlined in he et al 2021 this hydraulic aperture model may be used when the fracture aperture varies only in the direction normal to the pressure gradient inside the fracture this is the case for the fracture elements in our mixed dimensional model the lower dimensional representation of the fractures conforms with the midsurface of the fracture 3d objects which is generated through the skeletonization procedure therefore the fractures in our model are aligned with the direction of fluid flow inside them we investigate the influence of the fracture network in the equivalent permeability tensor by varying the permeability of the matrix in different tests the first test considers a homogeneous isotropic matrix whereas the second and third tests consider heterogeneous isotropic and anisotropic matrix permeability respectively 3 1 homogeneous isotropic matrix we solved the three fluid flow problems with varying permeability in the porous matrix for each one of the samples as aforementioned there is a significant distinction between the flow through the fractures and through the porous matrix in chalk due to the large difference between the sizes of the pore throats and the fracture aperture to investigate when the matrix permeability becomes influential to the overall permeability tensor we simulate fluid flow with matrix ranging from very low to high permeability the matrix permeability was assumed homogeneous isotropic with k k m i 3 and k m ranging from 10 22 to 10 12 m 2 fig 10 depicts the equivalent permeability tensor anisotropy against the varying permeability k m of the porous matrix the anisotropy is defined as the ratio of maximum and minimum principal components of the permeability tensor in this work referred as k max and k min respectively we notice that for samples s1 s2 and s3 the anisotropy does not change up to around k m 1 0 19 m 2 meaning that the fluid flow is not sensitive to the matrix permeability and is dominated by the fractures for samples s4 and s6 the anisotropy does not change up to around k m 1 0 18 m 2 and k m 1 0 20 m 2 respectively and lastly s5 presents isotropic behavior regardless of the matrix permeability the difference in the anisotropic behavior of the samples is due to the minimum component being more susceptible to changes in the matrix permeability fig 11 shows the maximum and minimum components of the equivalent permeability tensor for each sample versus the matrix permeability we notice that for all samples but s5 the maximum component remains constant up to higher matrix permeability around 10 18 to 10 16 when compared to the minimum component which starts varying for matrix permeability values around 10 19 3 2 heterogeneous isotropic matrix as noted before in fig 8 sample s5 has no fractures crossing the entire sample or any large fracture whatsoever which explains the isotropic behavior observed in figs 10 and 11 this sample has been characterized by mokhtari and feilberg 2022 with average porosity of 37 3 we considered the average pixel density of 125 76 of the ct scans of sample s5 and the measured average porosity to populate the porosity distribution for each sample s1 s6 we assumed that density 0 correlates to porosity 100 density 125 76 correlates to porosity 37 3 and density 255 correlates to porosity 0 and interpolated porosity given the pixel density distribution fig 12 illustrates the histogram of the porosity distribution for samples s1 s6 interpolated from the pixel density from the ct scans we observe no significant difference among the porosity distributions of the samples with exception of sample s3 the average porosity is 35 1 36 3 30 2 36 5 and 36 4 for samples s1 s2 s3 s4 and s6 respectively we populated heterogeneous permeability distributions to the matrices of samples s1 s6 through the correlation for gas permeability as function of porosity for middle upper tuxen and for lower tuxen by glad et al 2022b both corrected using the klinkenberg correlation for chalk by mortensen et al 1998 we considered both correlations for the tuxen formation to test scenarios with higher and lower contrast in the matrix permeability as the correlation for middle upper tuxen provides gas permeability ranging from 0 001 to 10 md whereas the correlation for lower tuxen provides gas permeability in the range 0 1 2 md let k kl ϕ denote the klinkenberg permeability for tuxen formation glad et al 2022b mortensen et al 1998 then we have k k kl ϕ i 3 and 13 k m 1 v ω k kl ϕ d v with v ω d v fig 13 shows the anisotropy and the maximum component of the equivalent permeability tensor for the valdemar samples considering heterogeneous isotropic matrix permeability we plot anisotropy and maximum component versus k m given by eq 13 and compare to the results obtained previously with homogeneous matrix the results obtained with heterogeneous matrix match with the ones obtained for homogeneous matrix for both cases of high and low permeability contrast in the matrix we also highlight the relative difference between the anisotropy for the homogeneous case and for the heterogeneous case for some samples this shows that the heterogeneity in the porous matrix does not affect the maximum and minimum components of the equivalent permeability of these samples 3 3 heterogeneous anisotropic matrix our last test considers anisotropy in the porous matrix due to compaction and cementation we assume a heterogeneous matrix permeability but in this case an anisotropic tensor the angle observed in the matrix permeability for such cases depends on the orientation of the well from which the plug was extracted in this test we consider two hypothetical well orientations vertical and horizontal we use the heterogeneous matrix permeability with both low and high contrast from the previous test case but for the vertical well case we divide the z component of the matrix permeability tensor by 10 and for the horizontal well case we divide the y component of the matrix permeability tensor by 10 let k vert denote the matrix permeability for the vertical well case and k horiz denote the matrix permeability for the horizontal well case hence we have 14 k vert k kl ϕ 0 0 0 k kl ϕ 0 0 0 k kl ϕ 10 k horiz k kl ϕ 0 0 0 k kl ϕ 10 0 0 0 k kl ϕ 15 k m 1 v ω 1 3 tr k d v with k being k vert or k horiz fig 14 shows the anisotropy and the maximum component of the equivalent permeability tensor considering heterogeneous anisotropic matrix permeability using both correlations for higher or lower contrast in the heterogeneity again we compare to the results obtained previously with homogeneous isotropic matrix the results obtained with anisotropic matrix are still close to the ones obtained for isotropic matrix for both cases of vertical and horizontal well with high contrast in the matrix however there is a large deviation in the results for the cases with the low contrast in the matrix for the latter cases the anisotropy is closer to one hence the matrix affects more the fluid flow pattern when compared to cases with higher anisotropy 4 discussion for each one of the samples s1 s6 we obtained the ct based dfm model and we used the fracture network topology for estimating the fracture density p32 and fracture porosity p33 the results are compiled in table 1 we also compile here the maximum component and the anisotropy of the equivalent permeability of the samples for the heterogeneous isotropic case there is no clear correlation between the fracture characteristics that is the fracture density and the fracture porosity and the principal components of the equivalent permeability tensor the strong anisotropy arises because samples s1 s4 and s6 all have fractures connecting opposite sides of the box shaped model whilst sample s5 has only a few small immersed fractures which explains the isotropic behavior observed for this sample this is in accordance with the findings of nick and bisdom 2018 to investigate the influence of the matrix permeability in the equivalent permeability tensor we illustrate as ellipsoids in fig 15 the tensors for samples s1 and s3 for the homogeneous isotropic test case and the tensors for samples s4 and s6 for the heterogeneous isotropic test case the relative difference between the anisotropy in the homogeneous and heterogeneous isotropic cases for these samples is very small as shown in fig 13 we illustrate the equivalent permeability tensors as ellipsoids such that the principal components of the tensor are represented by the axes of the ellipsoid and the principal orientation is associated with orientation of the ellipsoid the left panels of fig 15 show the ellipsoids for samples s1 and s3 for both the homogeneous isotropic case and the heterogeneous isotropic case with high contrast in the matrix and the right panels show the ellipsoids for samples s4 and s6 for both the homogeneous and the heterogeneous isotropic case with low contrast in the matrix the wireframe ellipsoids represent the homogeneous cases and the surface ellipsoids represent the heterogeneous cases there is no difference between the ellipsoids for sample s6 in both shape and orientation conversely despite having nearly the same anisotropy in the anisotropy for the homogeneous and heterogeneous cases difference smaller than 0 5 samples s1 s3 and s4 all depict different orientations this shows that the principal orientation varies with the matrix permeability reflecting that the orientation is impossible to be extracted from the fracture topology itself 5 conclusion in this work we present an integrated framework for deriving fracture networks with real aperture distributions based on ct scans of core plugs from naturally fracture rock formations we test this framework with 6 core plug samples and we investigate the contribution of fractures and porous matrix to the equivalent permeability tensor of each sample by considering three different scenarios for the matrix permeability 1 homogeneous isotropic 2 heterogeneous isotropic and 3 heterogeneous anisotropic our key results are as follows our framework can successfully generate discrete fracture matrix dfm models with real aperture distributions from ct scans of core plugs we generate dfm models with lower dimensional representation for the fractures and map fracture aperture and matrix permeability heterogeneity from ct images which enable accurate calculation of flow properties of fractured rock samples we observe a strong anisotropy in the equivalent permeability tensors when the matrix permeability is low there is nearly no difference between the anisotropy for the homogeneous and heterogeneous cases when considering isotropic matrix permeability for the studied chalk samples despite observing no variation in the anisotropy the principal orientation varies with the matrix permeability reflecting that it is not possible to extract the orientation of the tensor from the fracture topology alone credit authorship contribution statement carlos a s ferreira conceptualization methodology software validation investigation formal analysis writing original draft visualization hamidreza m nick conceptualization methodology resources writing review editing supervision funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments carlos a s ferreira and hamid m nick are both supported by the danish offshore technology centre dtu offshore and the research leading to the results in this paper has received funding from dtu offshore under the advanced water flooding program computer code availability the scripts used in this work are available at dtu s gitlab ferreira 2023a b 
19,in this paper we propose a new approach to simultaneously map the fracture conduit network and the equivalent transmissivity of the rock matrix from hydraulic head measurements acquired during pumping injection tests in fractured aquifers the algorithm relies on the use of a multitask neural network to directly approximate the joint inversion operator that links hydraulic head data to aquifer hydraulic properties in which the hydraulic head responses are used as input data while the output consists of the fracture structure and matrix transmissivity field the multitasking is formed by fusing two single task neural networks both based on convolutional encoder decoder architectures one of which processes the fracture map inversion and the other the transmissivity map training neural network then relies on a large database which consists of thousands of synthetic aquifers characterized by the presence of the fracture conduit network and a heterogeneous transmissivity field attributed to the rock matrix both randomly generated in these aquifer models the groundwater flow equation is solved in a discrete continuum concept to numerically simulate the hydraulic head responses associated with sequential pumping injection tests multitasking succeeds in reconstructing the fracture architecture and matrix transmissivity field with higher accuracy in comparison to conventional single task networks the difference is due to the transfer mechanism involved in the multi task network where the information shared between the tasks effectively enhances the accuracy of both reconstructions however as with other inversion techniques the result accuracy depends on the quality and quantity of the hydraulic head data used in the inversion as well as the prior information involved in featuring the training models keywords convolutional neural network hydraulic tomography inverse problem karstic aquifer multi task learning deep learning data availability the authors do not have permission to share data 1 introduction fractured karstified aquifers store a significant portion of the world freshwater and characterization of their hydraulic properties thus occupies an essential place in hydrological research engineering activities and management planning streltsova 1976 coleman et al 2015 pedretti et al 2016 however these fractured aquifers are well known for their extreme heterogeneity with a complex spatial distribution of hydraulic properties hydraulic conductivity and specific storage that depend on the fracture conduit network structures white 2002 schuite et al 2015 which we refer to here as the fracture network assessment of these properties is usually accompanied by either mapping of transmissivity or its average value or identification of hydraulic connectivity between areas on the basis of piezometric data associated with pumping operations a slug or tracer test coleman et al 2015 tiedeman and barrash 2019 among these approaches spatial mapping of hydraulic properties by pumping experiments known as hydraulic tomography is the most efficient approach allowing a better consideration of aquifer heterogeneity when interpreting hydraulic head data from multiple pumping tests the spatial distribution of hydraulic conductivity field is mapped in a combined manner using an inversion code in this inversion process a deterministic stochastic or global optimization algorithm is implemented to find an optimal 2d or 3d hydraulic conductivity field capable of numerically reproducing the hydraulic head data measured in the piezometers during pumping tests sen et al 1995 carrera et al 2005 this process relies on numerical simulation of groundwater flow by solving the flow equation to determine the piezometric response to a water withdrawal over the study area with assigned hydraulic parameters transmissivity and storativity however parameterization of the two fields is challenging in the case of a karstified aquifer due to the strong contrast in hydraulic properties between the fractures and the matrix within this framework a number of concepts have been developed in the literature such as the discrete fracture network and the equivalent porous medium in the equivalent porous medium concept the heterogeneity of hydraulic properties of both the matrix and fractures is described as a single continuum in which both entities are represented by equivalent hydraulic properties attributed to the cells that discretize the aquifer i e fahs et al 2014 moutsopoulos et al 2022 in this concept fracture geometries are not considered which makes the concept simplistic and explains its extensive use in the parameterization of hydraulic properties in the inverse problem this concept has been applied in a variety of inversion cases ranging from synthetic case studies hao et al 2008 illman 2014 to laboratory experiments poduri et al 2021 sharmeen et al 2012 to real field investigations illman et al 2009 wang et al 2021 it is also used to image models at different scales ranging from a small scale lee et al 2011 to a large scale environment zha et al 2015 2016 in the discrete fracture network parameterization fractures are represented as lines surfaces in a 2d 3d continuum that handles the surrounding rock matrix ringel et al 2019 fischer et al 2018 klepikova et al 2020 this approach offers an advantage of a realistic description of the fractures but it requires not only the hydraulic property values of the fractures but also their characteristics regarding location connectivity density and size which are often difficult to determine in the field this last point makes the inversion task very complex which explains its limited application in solving the inverse problem the few applications of this approach are mainly in parameterization with stochastic somogyvári and bayer 2017 ringel et al 2021 or global le goc et al 2010 inversion methods dual continuum approaches represent the fracture network as an equivalent continuum coupling with the hydraulic heterogeneity in the matrix while at the same time establishing the hydraulic continuity between the two media trottier et al 2014 kaczmaryk and delay 2007 this concept has attracted the attention of some researchers in recent years who have applied it to synthetic or real cases trottier et al 2014 fischer et al 2020 in this paper we explore the use of the dual continuum concept as a numerical parameterization of a fractured aquifer during the inversion of hydraulic data in a hydraulic tomography study the heterogeneity of this field is not limited to fractures and conduits but can also be present in matrix compartment which can be described by an equivalent conductivity field in this way the inversion aims to identify both the structure of the main fractures with their hydraulic parameters here the transmissivity and the parameter field assigned to the matrix the originality of this work lies in the use of deep learning algorithms as an inversion tool which differs from traditional deterministic and stochastic inversion processes in fact the deep learning approach aims to formulate the inversion operator linking the piezometric data and the hydraulic properties of the aquifer the concept is based on sequential processing of the input data via linear nonlinear operators defined on hidden layers of the neural network in which each layer contains a set of parameters that translate the input data into outputs in a direct way the parameters involved in this process are identified in the learning phase based on an optimization algorithm to reduce the difference between the given data and the reconstruction from the network this learning phase requires a big database to effectively link between the two variables and ensure the generalization of the inverse operator in this work the database of piezometric data and hydraulic parameters consists only of synthetic data which implies an intensive and repeated computation of the groundwater flow equations while preparing database for training the network represents the major effort in the approach development the training itself can be efficiently performed with new generation networks and gpu computing resources the trained neural network however operates each inference instantaneously with advances in computational capabilities and neural networks deep learning approaches have become increasingly popular in the geosciences with applications ranging from geophysics to hydrology reichstein et al 2019 dramsch 2020 among these new neural networks convolutional networks cnns with an encoder decoder architecture have proven their ability to tackle tomographic problems in geophysics hydrogeology or remote sensing these networks consist of multiple convolutional layers that excel at extracting the features embedded in the input data with efficiency and simplicity a convolutional layer scans small filters on the input image in a defined order to construct feature maps that extract information about local regions venkatesan and li 2017 the feature map is then reprocessed by a nonlinear filter layer such as the rectified linear unit relu and its dimension is reduced by a pooling layer in an encoder before being reconstructed in a decoder structure to obtain the tomography from the learned features zhang et al 2021 these feature based processes focus on relevant information and make training fast and efficient ciresan et al 2011 krizhevsky et al 2012 to extract various features with different degrees of complexity multiple convolutional layers are combined in successive encoders in which the simple features extracted by the lower convolutional layers are refined by the subsequent layers to capture more complex representations the capability and flexibility of cnn in identifying features allows for broad application in solving a variety of tomographic problems in the geosciences these include seismic facies mapping zhao 2018 moseley et al 2020 adler et al 2021 characterizing the subsurface environment from electrical properties vu and jardani 2021 mapping aquifer heterogeneity in hydrology vu and jardani 2022a jardani et al 2022 detecting fracture network vu and jardani 2022b or modeling heat transfer rajabi et al 2022 most of the aforementioned work has been realized with cnn architectures that efficiently process input data to map only a physical parameter field in the subsurface as a single output of the neural network however in a multivariate problem the different tasks can be handled in a joint manner with a single neural network to achieve better performance by learning the tasks simultaneously and resulting in multiple outputs misra et al 2016 zhang and yang 2021 a multi task learning mtl in fact can be built from the integration of single task networks that shares the hierarchical representations at certain levels ruder 2017 such a strategy allows the network to learn the similarities and contrasts between the shared tasks as it becomes a source of data augmentation used in training which is crucial to obtain highly generalized representations in the data and avoid the overfitting problem caruana 1997 instead of forming an independent neural network for each task all tasks can be assigned to a single network by optimizing a unified loss function that combines the loss functions of each task thus in this case the loss of each task serves as an additional regularization to facilitate and stabilize the optimization process thung and wee 2018 in other words the mlt network prevents overfitting during the learning process and improves the quality of the reconstruction at the end multitask learning is a new concept in artificial intelligence and has been successfully applied in many fields including natural language processing computer vision and industrial applications liu et al 2019 csurka 2017 chowdhuri et al 2019 however its use in geosciences is still tentative with few applications in seismic data processing for example siahsar et al 2017 used mtl to better mitigate the impact of random noise in synthetic and real three dimensional seismic data in reasonable time wu et al 2019 built an encoding decoding algorithm for local seismic image processing that integrates a fault map clean seismic image and normal estimation for better accuracy and sharper fault detection li et al 2020 attempted to improve the efficiency and accuracy of full waveform inversion to construct a high resolution seismic velocity model the use of mtl in hydrology is rather rare and in this context vu and jardani 2022c proposed an encoder decoder based architecture for simultaneously mapping transmissivity and storativity fields from hydraulic head measurements this network outperformed conventional inversion networks and single task networks in terms of accuracy in this paper we propose an architecture with mtl to jointly map two fields one for the fracture trace and another for the hydraulic transmissivity for the matrix the architecture consists of two interconnected encoder decoder neural networks with input data from piezometric measurements acquired during pumping tests conducted in a fractured aquifer the encoder decoder neural networks are based on the segnet architecture which has been shown to be effective in image processing in terms of interpretation accuracy and computational cost badrinarayanan et al 2017 the paper will discuss the effectiveness of this multi task network in hydraulic tomography of fractured aquifers and will be organized into four sections in the second section the theoretical background is briefly described with numerical modeling of water flow in a fractured aquifer used to generate the training data we also describe the inversion concepts in hydraulic tomography and the design of the proposed multi task neural network section 3 details an application of the mtl network on synthetic cases the efficiency of the network is discussed in section 4 to examine the impact of data coverage data noise and inconsistency of interpreted features on its performance at the end of the paper the main results of the study are summarized with prospects for future development 2 theoretical background in this section we briefly review the concepts used to solve inverse hydraulic measurement in fractured aquifers using a deep learning approach first we introduce the numerical modeling of groundwater flow or the forward problem used in both classical and neural network inversion approaches to simulate the piezometric responses as a function of hydraulic properties assigned to the domain representing the aquifer under study next we describe the mathematical formulation of the inversion using deep learning in which the properties of the multitask neural network its operation and innovations are detailed and discussed at the end of the section 2 1 forward problem groundwater modeling groundwater flows at steady state in a confined isotropic fractured aquifer where the heterogeneity of the transmissivity field with respect to fractures and matrix is expressed by the discrete continuum concept we denote the 2d domain as ω ℝ2 with the boundary γ in which the union of all fractures is denoted as ωf and the surrounding rock matrix as ωm with the contact between two as γmf a conventional subscription m and f are adopted to denote the variables corresponding to the matrix and the fracture respectively within ωm the mass balance equation and the constitutive law are 1a ρ q m q m q m k m μ p m ρ g similarly within the ωf 1b ρ q f ρ q m n f q f k f μ p f ρ g where q is the darcy flux p is the aqueous pressure k is the permeability μ is the fluid viscosity and ρ is the fluid density and g is the gravity and q denotes the external sources nf is the normal vector pointing into the fracture domain and q m is the flux between the matrix and the fracture on the matrix fracture interface γmf the mass conservation law leads to the continuity condition 1c q m n f q m n f in the fracture averaging the balance equation in normal direction yields 1d q m n f 4 k f μ a f p f p m where af is the fracture aperture and pm is the mean value of pressure in the matrix in two sides of the fracture the solving is subject to the boundary condition 1e p p γ at the boundary γ as well as the following initial boundary condition 1f p p 0 at t 0 these differential equations defined for the matrix and fracture components can only be solved by a numerical method such as the finite element method using the dirichlet boundary conditions eq 1e on the four boundaries of the domain γ which are located far from the studied area using a buffer zone where the transmissivity is considered homogeneous this study utilizes the developed comsol module specifically designed for fractured aquifers incorporating mesh refinement techniques around the wells and fractures the solver adopts the finite element method to solve both equations to capture the spatial distribution of the hydraulic head at the observation wells during sequential pumping tests in the end the operator of 2d forward problem can be expressed as a function that depends on three parameters 2 h h t m t f λ f where h denotes the forward operator the hydraulic head h is the response to pumping tests carried out on an aquifer represented by a matrix of heterogeneous hydraulic transmissivity tm intersected by a fracture network of transmissivity tf and geometry λf 2 2 inversion problem hydraulic tomography from gw level measurements in this study the inversion problem deals only with the reconstruction of the matrix transmissivity tm and the fracture geometry λf estimating further fracture properties such as transmissivity requires more data and a deeper neural network which demands enormous computational power that is not currently available determining the transmissivity of fractures will therefore be the subject of a later work in a classical inversion method the identification of these two parameters can be done with deterministic or stochastic schemes via optimizing an objective function these parameter models are determined based on a criterion of adequacy to reproduce the hydraulic data and to fulfill the criteria imposed on the basis of the prior information to achieve a reasonable solution the optimization process often relies on an iterative scheme in which multiple models are tested sequentially with a typical objective function s being as follows 3 min s t m γ f h o b s h t m λ f t m 0 λ f 0 where hobs denote the hydraulic head measurements and t m λ f are the parameter fields t m 0 λ f 0 represent the parameter fields proposed as prior models a constraint in the optimization however inversion with a deep learning differs completely from the classic inversion with the optimization algorithm above deep learning indeed approximates the inversion function that connects straightforwardly input data to output map in this case the hydraulic head data at the input and output with the fracture geometry and transmissivity field the problem is then reformulated where this strongly non linear relationship is established by a set of coefficients involved in linear nonlinear operators of the neural network using the training database therefore the optimization problem is defined by estimating the network parameters through minimizing the following objective function l 4 min l ω t m λ f ψ h ω where ψ represents the neural network with its learnable coefficient system ω that approximates inversion operator linking the hydraulic head data h and aquifer parameters t m λ f this minimization process is known as learning phase in which the parameters are determined based on their ability to enable the network to reconstruct the aquifer models t m λ f from corresponding input h both given in the training database the performance of the network depends strongly on its structure and the training database the preparation of training database is the costliest step of this method since its construction involves solving the forward problem to generate numerical hydraulic head data for thousands of given matrix transmissivity and fracture structure maps in fact the learning phase requires a massive database to form a network with a proper generalization thus it implies a repeated computation of the forward problem and the implementation of a generator for flexible aquifer models in which their characteristics can be defined according to the prior information through this step the prior model intervenes in the inversion process with deep learning algorithms in classical optimization the prior model is introduced into the objective function but here into the database instead to drive the inversion to a plausible solution with certain known properties indeed the inverse problem using deep learning tools is not formulated as a classical optimization problem where the predefined condition i e the physical constraints are directly used to find the optimal solution here the predefined condition is only involved in generating the training data that is used to train the networks therefore the inverse solution of transmissivity and fracture structure can be found separately since this solution does not require the obtained fields to reproduce the hydraulic data this type of approach has been used in several geoscientific disciplines such as geophysics where the seismic section has been trained with a network to find the geometry of faults e g wu et al 2019 li et al 2020 these faults are not defined by their ability to reproduce the seismic data but their determination depends on the ability of the network to detect how the data relates to the existence of the fault after it has been trained to perform this task the comparison between the classical inversion approach and deep learning has been discussed in jardani et al 2022 2 3 multi task architecture deep learning algorithms have been developed based on an imitation of the complex information processing of the human brain which allows a human being to use the knowledge acquired in one task to perform other tasks this transfer of learning occurs in different human activities such as playing sports learning languages playing music or performing jobs development of multi task networks is thus motivated by learning biology in order to design a neural network in which relevant information can be transferred between the tasks multi task learning relies primarily on knowledge transfer within the network operation a single task network on the other hand aims only at predicting a particular variable while ignoring the information that can be retrieved during the execution of the other tasks sharing information in a multi task network allows similarities and contrasts between tasks to be incorporated into the learning improving the efficiency of the network in addition cross transfer increases the amount of data used in the learning process for each task which is critical to promoting the model generalization a multi task neural network can be designed from multiple single task networks according to the number of tasks performed while ensuring the exchange of information between them in this work the segnet network with an encoder decoder architecture is opted to construct the multi task network that aims at mapping the transmissivity of rock matrix and detecting the trace of fractures this network was originally developed to capture the complex conditions of real traffic badrinarayanan et al 2017 quickly segnet has proven to be highly effective in a number of applications across disciplines dash et al 2020 audebert et al 2017 kolhar and jagtap 2021 it has also been tested for applications in subsurface tomography such as processing apparent electrical resistivities recorded at the ground surface to image the electrical resistivity distribution in the subsurface vu and jardani 2021 in hydrology this concept was developed to map the transmissivity field in the interpretation of pumping or tracer tests jardani et al 2022 vu and jardani 2022a 2022b 2022c indeed the proposed multi task architecture consists of two segnet networks each of which performs the corresponding individual tasks see fig 1 while the upper network is designed to perform a segmentation task to reconstruct the fracture map the lower network involves a regression task to map the transmissivity field both networks consist of four encoder decoder pairs terminated by a soft max layer for the upper network and a regression layer for the lower network information transfer between the two networks is implemented in the last layers by a concatenation layer and a 1 1 convolutional layer the high level features of the higher network are transferred and concatenated to the lower network to improve the efficiency of the mtl both networks interpret the same input data the hydraulic head and its gradients these maps are derived by interpolating piezometric point data to form the input as a matrix of the same dimension as the estimated output fields recall that an efficient design of a multitasking architecture must be built on a thorough analysis of how single tasking networks work here each network consists of multiple encoders arranged in pairs layered similarly to decoders but in reverse order the encoders aim to extract generic features from the input image while the decoders convert these extracted features into the output map the encoding task is based on successive convolutional layers cn with which several filters scan the input image piece by piece and detect some relevant features formed by the neighboring pixels then the extracted maps go through a batch normalization bn and a rectified linear unit relu layer to incorporate nonlinearity into the analysis then the dimensionality of these low level feature maps is reduced with max pooling operator to preserve only the important features thus reducing the computation time on the other side by using the same layers the decoder is designed to process the output images with an up sampling operator to recover the original dimensionality lost during encoding by transferring the indices of the max pooling operator from the encoders this bridging mechanism improves the accuracy of the output map reconstructions since these shared indexes are smaller in segnet than in competing architectures such as unet abdollahi et al 2020 that requires less computation time and memory segnet architecture offers performance and learning advantages that make it effective for building a multitasking network the design of mtl networks is primarily based on sharing information between subnetworks of tasks sharing can be done at different levels to incorporate the relevant information to improve the efficiency of one or all tasks in the sub task networks but the structure of the neural network and the deep nature of cnns make it difficult to thoroughly evaluate all conceivable structures to select the best level of sharing in general levels are selected for sharing where there is commonality between tasks which is the case for some imaging applications csurka 2017 thung and wee 2018 ruder 2017 however in physical problems such as geosciences the subsurface properties interpreted with the networks often have ambiguous relationships despite the difficulty in relating the physical properties sought the use of mtls can be beneficial romera paredes et al 2012 experiments with synthetic and real world data have shown that incorporating information from other tasks where relationships between parameters are not identified can even significantly improve the traditional mtl technique romera paredes et al 2012 hajiramezanali et al 2018 in our case the algorithm reconstructs the fracture geometry and the surrounding transmissivity heterogeneity which are independent in nature and have different properties even the identification of the two parameters is based on the same piezometric signals sharing information at low level representations between the sub networks is less interesting however sharing high level information at the decoder level can improve the reconstruction quality of the resulting maps such a concept has already been successfully applied in a cascaded multi task network in processing e g visual scene understanding or face recognition dai et al 2016 wu et al 2019 therefore in this new network we keep the connection mechanism between encoders and decoders while connecting the subnetworks at the end of the decoder segment these two information transfer mechanisms help to increase the reliability of the outcome mappings for further explanation this study develops a cascaded architecture with two tasks corresponding to the maps where the output of one task is used as input for the next task in this way information can be transferred sequentially from one task to the next resulting in improved task performance there are two main mechanisms in the proposed network for information transfer see fig 1 first the last hidden representations from the first task are combined and later used as input for the second task this allows for more complex information about the internal workings to be transferred between tasks second the above output representations are combined into a single representation and merged with the intermediate representation of the second task which guides further processing to improve the task interpretation accuracy the learning process thus aims to optimize a single loss function reformulated as the sum of two loss terms from the two tasks such formulation ensures that each task acts as a term regularization for the other which numerically stabilizes the optimization the loss function l is formulated as follows 5 l l f λ l m in this equation lf is the cross entropy function that is used as a loss function to evaluate the adequacy of fracture geometry predictions 6 l f n s ln s n where s denotes the fracture parameter field 1 represents the fracture pixels and 0 the matrices and s is the corresponding prediction n is the number of parameters in each field in this case equal to 64 64 the second loss function lm for the transmissivity map is expressed as the least squares difference between the true t and predicted t transmissivity maps in a logarithm scale 7 l m n t t 2 n and λ is a scalar coefficient that varies during the learning process from 0 05 at the beginning to 1 at the end of the training which aims to balance two tasks thus the multitasking architecture is trained using a standard gradient descent algorithm that performs an end to end operation the architecture now functions as a unified framework that provides two output maps each map describing a field separately as a post processing the two maps can later be externally overlaid after inversion for visual purposes which can help to better localize features and condense the visualization in short the proposed multitask architecture works jointly by combining the ending sections of multiple tasks into a single neural network where the second subnetwork builds upon the results of the first subnetwork to guide the prediction once the first subnetwork performs the fracture detection and generates a candidate fracture map the second subnetwork takes the generated fracture and refines the processing matrix map as each subnetwork is initially designed to execute its task efficiently and accurately the cascaded structure allows the use of intermediate results from one task to further enhance the efficiency of the next task this joint approach thus enables to perform multitasks in a unified framework reducing computational costs and increasing accuracy compared to separate single networks yet a concrete explanation of how deep neural networks work remains a major challenge at the current state of deep learning development i e burkart and huber 2021 roscher et al 2020 especially given the complex architecture in this work high dimensionality with many layers millions of parameters and multiple activation functions in deep neural networks which are often nonlinear and complex makes it difficult to figure out how the network processes data and makes predictions this challenge underscores the need for techniques that can improve the explainability of deep learning models in the future 3 application in this section the mtl network is trained with synthetic data by randomly generating thousands of synthetic 2d aquifers containing fractures surrounded by a heterogeneous transmittivity matrix in these aquifers we installed a series of wells to perform pumping tests in hydraulic tomography mode the hydraulic head data numerically obtained from the pumping tests are used as input data for the network while the output maps consist of the aquifer properties including the fracture geometry and the matrix transmissivity field the generated aquifer properties with the well configuration are presented at the beginning of the section followed by discussions of their use in training the network 3 1 aquifer model fracture network embedded in a heterogeneous matrix the investigated area covers a fractured aquifer of 100 m 100 m in which we placed 49 observation wells in a regular distribution of 12 5 m in each direction to determine the transmissivity heterogeneity and fracture network in the subsurface four dipole pumping injection tests are performed on pumping injection wells located at the edge of the zone and designated by numbers as shown in fig 2 during each pumping test the hydraulic head at steady state is recorded at the observation wells these measurements are then used as input to the neural network the dipole configuration of hydraulic tests better captures the spatial heterogeneity of the aquifer on this domain we randomly generated 45 000 models of the hydraulic properties of the aquifer that include the fracture geometry and the matrix transmissivity field considered as a heterogeneous parameter these models are used for training the network and testing process for the transmissivity matrix we used a gaussian geostatistical variogram to generate fields with a mean transmissivity value ranging from 10 4 to 10 6 m2 s while the magnitude varies from 10 2 to 10 8 m2 s such variability in the transmissivity field allows the construction of a network capturing the true complexity of the matrix heterogeneity which may include equivalent transmissivities related to the presence of secondary fractures not included in the generated fractures the fractures are introduced as 1d polylines crossing the study area of which the orientation as well as their number in each aquifer model are randomly chosen between zero and three in this study the transmissivity of the fractures is set to 0 01 m2 s for simplicity but their traces are variable the characteristics of the fractures relate to the local aquifer conditions which is located in a strongly karstified chalk aquifer in normandy france 3 2 data acquisition and data processing the forward problem operator based on the numerical solution of the groundwater flow equation operates for each aquifer model to obtain the hydraulic head responses in the pumping injection tests the hydraulic responses captured at the observation wells are then interpolated to construct the input data as maps of the same size as the output maps for this purpose the nearest neighbor interpolation method is adopted to obtain a hydraulic head map of 64 64 for each pumping injection test for four pumping tests the resulting data form a multi channel matrix of 64 64 4 as the hydraulic impact of fracture transmissivity and matrices provide well contrasted flow patterns with the fractures characterized by highly focused flow by incorporating the gradients of the hydraulic head map in two directions the input data finally is a multichannel image of 64 64 12 the principle of a convolutional neural network requires image to image processing thus the fracture traces are discretized in a binary image with 1 for fracture and 0 for others while the matrix transmissivity is discretized in a scaled image neural network output then consists of two maps one for transmissivity and one for fracture both meshed with the same 64 64 resolution while the former represents the tomography of the logarithmic value of transmissivity located at the outcome of the lower half of the architecture which is in fact a regression neural network the latter is a binary map located at the end of the upper half in the designed architecture which is a classification neural network see fig 1 finally at the end of the neural network two maps are combined to obtain a better visualization of the entire aquifer model with the fracture pixels in the latter overlaying the transmissivity image in the matrix 3 3 learning process and results in the learning phase we randomly selected 30 000 models for training and 5000 models for validation from database of 45 000 generated models the remaining 10 000 models are set aside to evaluate the performance of the trained network the process of generating the database takes approximately three days using a dell precision tower 5810 equipped with a single cpu the training step determines the parameters of the neural network over many iterations each iteration analyses a number of samples minibatch a subset from the training dataset to reduce computational cost this process often requires optimization over multiple full cycles through the training data set the epochs the neural network is trained with the adam algorithm implemented in matlab with a constant learning rate of 0 001 and a minibatch size of 96 to regularize task balance in the unified loss function we used the weighting coefficient α in eq 8 is reset from 0 1 to 1 at epoch 11 after 43 epochs the training is stopped manually to avoid the overfitting problem the training takes 16 h on a single nvidia quadro k2200 gpu in a dell precision tower 5810 and the loss function evolving in the process is shown in fig 3 to metrically assess the quality of network inferences we used the following three metrics where the accuracy of the fracture map is based on the similarity between the truth and predicted maps as following 8 a c c u f r a c n s s n 100 where s and s represent the true and predicted labels of fracture or matrices to evaluate the reconstruction of transmissivity field two other metrics are used including the coefficient of determination and the root mean square error defined as follows 9 r t 2 n t t 2 n t t 2 10 r m s e t n t t 2 n where t t t are the truth its mean and prediction of logarithmic transmissivity respectively applying the network to the 10 000 unseen data takes 0 03 s per model to reconstruct the fracture network and transmissivity field from the measured hydraulic heads over the entire test data set the average accuracy reaches 94 7 for fracture reconstruction while the transmissivity fields are mapped with an accuracy of 0 77 for r2 and 0 21 for rmse a histogram of the accuracy distribution is sumarized in fig 9 and the parameters are listed in table 1 both of which can be found at the end of this section to illustrate the effectiveness of the approach in detail fig 4 illustrates six representative inferences with different characteristics and complexity levels in the fracture network and matrix heterogeneity in general the reconstructions are able to capture the main features of each target field with high accuracy both in terms of the magnitude of the transmissivity values and the location of the fracture networks as shown in fig 4 the prediction quality of fracture structure decreases slightly with increasing number of fractures and complexity in the models for simple configurations from ex1 to ex2 with none to two fractures the interpretations properly reproduce the fracture shapes in their matrix environment nevertheless minor interpretation errors can occur in regions of dense fractures such as the lower half of ex4 and the middle of ex6 where fractures intersect closely this is due to the limited resolution of the piezometric coverage over these regions which does not allow for a more precise distinction of the fractures with this level of detail the coverage constraint thus can present a challenge in locating fracture intersections as accurate determination in neighboring intersection may require a fine resolution in the measurement scheme indeed this dilemma between data coverage and detail reconstruction is a common challenge in solving inversion problems vandecar and snieder 1994 ren and kalscheuer 2020 the accuracy of the transmissivity field reconstruction also depends on data coverage and complexity of the target field however the impact of the cross fracture network on this identification is unclear or non existent this is due to the mechanisms of multi task network where the information from the two sub networks effectively distills the cross effect of two parameter fields in the interpretation results as the minimal sharing is implemented at the high level features in the mtl design each subnetwork can effectively contribute to its original performance in the whole network in order to explore and highlight the benefits of multi task learning the next section compares the mapping results from mtl with those from single task networks under the same conditions 4 discussion this section focuses on the discussion of various factors that condition the quality of the reconstructions obtained with the network first we compare the reconstructions obtained with the multi task network with those obtained with a simple single task network the impact of other aspects is also addressed such as the size of the observation data and its noise level as well as the nature of the training models 4 1 effect of multi task network comparison to the single tasks to highlight the advantage of multi task learning we compare its reconstruction results to those obtained with conventional single task neural networks the single task networks are designed to perform a specific task one for mapping fracture network the other for transmissivity field both are based on a four level segnet architecture which actually correspond to the upper and lower subnetworks of the proposed multi task architecture described in section 2 3 two single task architectures are then trained validated and tested on the same database as the multi task architectures the trainings of both architectures are performed in 60 epochs with a constant learning rate of 0 001 in 6 h each on the same computer and with the same training algorithm each network has about 0 5 million parameters which is half size of the multitasking architecture and both are obviously faster to build however the execution time and number of parameters of the two single task neural networks are ultimately of the same order of magnitude as the multi task neural network regarding their evaluations on the same testing dataset they provide an average accuracy of 94 3 for fracture mapping and the average rmse and r2 values for transmissivity mapping are 0 22 and 0 73 respectively the outcome metrics show that single task performance is competitive with multi task performance as found in previous research in the visual domain dai et al 2016 wu et al 2019 however there is a slight degradation in fracture reconstructions with single task networks of 0 4 of r2 over the 10 000 test inferences a degradation is also observed when mapping the transmissivity field with the single task networks with 5 higher in rmse compared to the multi tasking the statistical comparison between the two models on the test dataset is shown in fig 9 with the average metric shown in table 1 examining such a large number of test samples proves a real improvement made by the mtl network for more details the results from the single task networks are shown in fig 5 with the same representative models used in fig 4 for mtl metric analysis of these results shows a slight multitask network advantage in fracture reconstruction especially in ex3 6 this advantage of mtl is largely confirmed in mapping the transmissivity field where the network is able to better capture the heterogeneity of matrix transmissivity compared to the single task models this is due to the sharing concept in the multitask neural network that transfers relevant information from the fracture prediction to improve the prediction of the transmissivity map the fracture mapping itself has a marginal gain likely due to the use of a regularization term in the objective function optimization overall multitasking in this case requires more computational cost but provides more accurate results 4 2 effect of number of observation points to further investigate the impact of piezometric coverage on reconstruction results we reduce the number of observation wells to 25 wells almost a half of the initial configuration and then a third with only 16 wells using less wells saves installation costs in practice but also provides fewer input data points for the interpretation process as in the previous case the database uses the same generated aquifer models the multitask neural network is then retrained to better adapt to the new configuration and analyzed on the same 10 000 test models in this first new configuration we reduce the number of wells but arrange them in a regular grid as shown in fig 6 a case 2a the test results in metrics show an average accuracy of 92 52 for fracture identification while the transmissivity fields are reconstructed with an error of 0 27 for rmse and a correlation of 0 62 for r2 metric comparisons of the new configuration with the original reveal a clear degradation in reconstruction quality for both maps when piezometric coverage runs into low resolution this degradation in mapping accuracy is also confirmed visually in the representative examples as shown in fig 7 for the new dataset in cases with simple fracture shapes as in ex2 to ex3 even with sparser observation wells the neural network enables to locate them effectively however it is not the case for the more complex fracture networks in ex4 though ex6 a low resolution of hydraulic data is insufficient to capture the full complexity of the environment producing interruptions and artifacts in the fracture reconstructions detection of complex fracture geometries often requires high level of input data coverage a problem that has been frequently reported in previous imaging studies sarker et al 2019 khan et al 2020 jardani et al 2022 however the condition is more favorable for the reconstruction of transmissivity field as the main patterns are well captured by the neural network with some smoothing indeed mapping a continuous field is less demanding if a tomography can be interpolated from values at only some points such interpolation may result in a lack of detail and exaggerated smoothing but the main feature of the field can be formed in general to get better insight into the coverage issue the next case examines an irregular distribution in the monitoring wells which is a common situation in hydrogeological investigations case 2b the new arrangement with different grid space in the two directions highlights the impact of well density on the prediction accuracy while the upper left corner is monitored with the coarsest resolution the lower right side maintains the same high density as the original scheme the other two sides have intermediate density see fig 6b interpretations of the test data set show almost similar average values of metrics as in the previous case table 1 this trend is also confirmed in fig 7 where the results of both cases show some similarity as the key features are still well located in the fracture and transmissivity maps however the details in fig 7 clearly demonstrate how data coverage determines the quality of interpretation the fractures in the upper conners associated with low resolution in monitoring are delineated with low accuracy especially in the complex cases ex3 to ex6 with the presence of interruptions and artifacts when the number of observation points is further reduced to 16 wells case 2c the quality of the interpretation deteriorates due to the lower resolution of the monitoring data mapping accuracy of fracture decreases to 91 76 and the same is true for transmissivity reconstruction with rmse and r2 of 0 29 and 0 56 respectively as with other classical deterministic or stochastic inversion methods the accuracy of the imagery obtained with xnet depends on the adequacy of the data resolution used in the inversion in the case of piezometric coverage with a small number of piezometers the accuracy of the results may drop particularly if the target field has a complex heterogeneity data noise can also be a factor in degrading the accuracy of reconstructions and this will be discussed in the next section 4 3 effect of observation uncertainty in practice each measurement is likely to be associated with noise from known or unknown sources that challenges any data interpretation process to investigate the impact of noise on the accuracy of reconstructions we contaminate the original data with various levels of random noise in the first test a common noise scale is added to the observation of a hydraulic head with 5 of the measured value case 3a the neural network trained in section 3 3 is recalled here to interpret the testing dataset contaminated with the noise when mapping the fracture structure the average accuracy for 10 000 tests is 93 91 while the matrix transmissivity is reconstructed with an average accuracy of 0 70 for r2 and 0 24 for rmse the interpretation of the data set is compared with the uncontaminated case in fig 9 to illustrate the effect of noise the statistical analysis reveals a slight deterioration associated with noise in the reconstruction of fracture and transmissivity maps to explore this issue further we analyze the results of the representative models shown in fig 8 where the network correctly maps the heterogeneity of the aquifer however in these reconstructions the fracture shapes exhibit some misalignment when examined closely while other interruptions and minor artifacts appear in the ex4 results the degradation of the reconstructions intensifies when a higher noise of 10 is imposed in the original signal case 3b both cases evident a significant deterioration of the reconstruction quality which illustrates the dependence of mapping accuracy on the measurement noise the details of reconstruction with these noise levels are listed in table 1 and summarized in fig 9 for the whole contaminated datasets transmissivity field mapping appears sensitive to the presence of noise when r2 drops from 0 77 for uncontaminated data to 0 50 for 10 noise whereas fracture mapping does not show much change with respect to the noise the difference could be due to the nature of the inferred fields fractures with several orders of magnitude higher conductivities drive the flow field in the aquifer thus favoring the detection process the transmissivity imaging is further reconstructed from data points distributed over the study area where the grouping noisy points can lead to misinterpretation with presence of false fractures and minor artifacts a detailed analysis of the representative results in fig 8 proves that despite the decrease in accuracy metrics under the influence of noise the transmissivity mapping is still reliable as the main features are well pronounced in all samples overall the transmissivity and fracture reconstructions show some resistance to noise in the input data despite some slight interruptions and artifacts observed on the mapped fields this resistance to noise has also been described in previous studied on hydraulic and electrical tomography vu and jardani 2021 jardani et al 2022 and other imaging topics zhu et al 2018 chen et al 2017 this advantage is due to the way the input data is processed in a convolutional neural network that translates the input image through scanning a set of small filters to extract the feature maps by working region by region the interpretation can limit the impact of noise at each data point therefore this feature based method preserves the most relevant information embedded in the input data at the end the results of the previous tests are summarized in fig 9 with the comparisons with the original scheme which provides an overall picture of the test set of 10 000 samples with the average of accuracy metrics detailed in table 1 4 4 influence of features in training models as a data driven model the neural network reconstructs the hydraulic heterogeneity of an aquifer from a training database a large database seems to lead to a more generic mapping solution but being costly in practice using a small database requires less effort from which the trained network can be less generic when it can only target the models having a similar property with the trained data in this study a database with broad features was generated to cover as much diversity as possible but it still may be insufficient to capture complex heterogeneity that may occur in a real fractured aquifer to test the degree of generalization and dependence of the trained network on the actual database we apply the trained network to process the piezometric data coming from models with different features from the generated database for this purpose the trained network is tested with six models embedded features that differ from learning the first three models involve a discontinuous and binary transmissivity field while the last three with fracture networks differ from those of the trained models see fig 10 in the first test case a the neural network correctly reconstructs both regions in terms of amplitude and shape with the region boundary well delineated the smooth and continuous nature of the training fields impose a gradual transition in transmissivity boundary between the two regions such an effect is also visible in the detailed reconstruction of each region where the transmissivity value varies throughout regions instead of being homogeneous as in the true model the accuracy of the reconstruction then deteriorates when the difference between two regions increases up to three orders as shown in case b a strong transmissivity contrast can lead to a significant change in the water flow mode near the interface of two regions whose behavior resembles well to the presence of a fracture there as a result a false fracture appears in the reconstruction this discrepancy also causes a significant degradation in mapping the transmissivity field but the shape of the two regions is still reliably delineated case c is more complex with the presence of both fracture network and large transmissivity contrast in the matrix components such complexity complicates the flow field modalities leading to deterioration especially in the transmissivity field reconstruction but the region boundary is still recognized with some perturbations by fracture intersections despite some deficiencies in the fracture and transmissivity fields all aquifer components are reasonably formed the next test involves a fracture system with short segments case d as shown in fig 10djp this configuration differs from the trained model which consists of only long fractures running throughout the region while the main fracture is well determined the short fractures are almost neglected in the mapping this is not surprising since the main fracture with significant hydraulic activity is easy to detect detection of minor fractures is otherwise conditioned by the coverage of observation data as discussed in section 4 2 where more detail on short fractures requires a finer monitoring system in the fifth test the study is extended to detect more fractures with four long fractures that exceed the maximum number of three fractures in the trained model case e the interpretation delineates only three fractures which corresponds well to the trained condition the final test further focuses on the change in hydraulic property of the fracture with each fracture having a different transmissivity unlike the trained model where all fractures have the same transmissivity in this case we keep only one fracture with this value the black one in fig 10f two other fractures deviate from the original value one with three times higher transmissivity the red and one with three times lower transmissivity the blue the result in fig 10l r shows that the two fractures with higher transmissivity are correctly located whereas the left one with the lowest transmissivity is poorly described the low transmissivity of the latter which is barely different from the background matrix prevents the neural network from providing an accurate interpretation overall the difference between the trained model and the tested model presents a challenge to the interpretation process where the reconstruction accuracy varies with the complexity of the feature encountered this also reflects the nature of a data driven model where reliability is based on consistency between the given database and the processed inference for this reason training models must be featured on the basis of prior information in order to find plausible solutions 5 conclusion in this work we develop a new approach to mapping fracture trace and matrix transmissivity field of karstified fractured aquifers by inverting piezometric data associated with pumping tests the inversion method is based on a deep learning algorithm using a neural network with a multi tasking architecture to image multiple fields simultaneously this multi task neural network which is rarely used in inverse problems provides an end to end operator that directly approximates the nonlinear inverse function with two output images of fractures and transmissivity rather than adjusting the measurement via a minimization process as is the case in conventional deterministic or stochastic methods the neural network proposed in this work is inspired from segnet an encoder decoder architecture that is widely used for traffic scene analysis due to its performance and low computational cost each fracture trace or matrix transmissivity field imaging can be indeed performed separately as a single task with the use of segnet instead a multi task network is designed to perform both tasks jointly to enhance the quality of reconstructions by introducing information transferred between the two tasks in this network only the high level features at the end of each individual task are transferred while the skip mechanism of the original segnet is maintained transferring information from the fracture prediction network to the other transmissivity field prediction task significantly improves the latter reconstruction the transfer mechanism provides the transmissivity field subnetwork with information about the area dominated by flow in the fractures which refines the identification of the transmissivity field and thus promotes mapping accuracy the proposed architecture also provides a lightweight neural network without pre trained or external parts that can be then trained directly with a standard gradient descent algorithm in addition the use of a single unified loss function allows for better generalization of both tasks when each act as a regularization term for the other to investigate the performance of the multitask neural network in this study we use 2d synthetic data that simulate pumping injection experiments conducted in heterogeneous and fractured aquifers such a random generation scheme with a wide variety of model features guarantees a reliable generalization of the network the trained multi task network is then tested with 10 000 unknown subsurface models with each inference taking 0 03 s almost instantaneously the mapping result also confirms the performance of the network by providing accurate reconstructions for fractures and transmissivity fields multi task learning also shows significant improvement over single task networks with a 5 improvement in transmissivity tomography mapping and better fracture determination the performance of the proposed multitasking solution can also be impacted by factors such as the quantity and quality of piezometric data which are common interferences in any inversion algorithm regardless of the nature of method used as with other data driven algorithms data size controls mapping accuracy where a poor data coverage due to a small number of observation points degrades the reconstruction quality of both fracture and transmissivity reconstructions however the neural network shows certain resistance to data noise in the measurement experiments with noise of 5 to 10 a common order of magnitude in hydraulic data reveals a marginal degradation in mapping fracture structure and transmissivity heterogeneity this advantage is related to the nature of processing data within the proposed neural network where convolution operators translate the input data based on patterns rather than processing each data point individually finally the trained network is tested on complex aquifers whose characteristics differ from given features in the training database the mapping result confirms some dependence of the proposed network on the nature of the trained models even though featuring the database used for training the neural network in practice should be tied to prior information in order to target a realistic solution a better understanding of field conditions may hence ease the requirement for a large data set while maintaining reliability with comprehensive constraints however by its very nature using a cnn model requires significant computational resources especially in a real case that is often complex and considers many features as a prototypical study this work only addresses a 2d approach with a synthetic dataset and only considers limited features in both the fracture network and matrix continua future work should consider a more complex case especially for fractures such as with transmissivity heterogeneity non darcy flow a deeper investigation in the future should also include an uncertainty analysis with a better explicability of a working mechanism between tasks which should be clarified with real data to cover all aspects of the proposed algorithm credit author statement m t vu conceptualization methodology software data curation writing visualization investigation a jardani conceptualization reviewing and editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper 
19,in this paper we propose a new approach to simultaneously map the fracture conduit network and the equivalent transmissivity of the rock matrix from hydraulic head measurements acquired during pumping injection tests in fractured aquifers the algorithm relies on the use of a multitask neural network to directly approximate the joint inversion operator that links hydraulic head data to aquifer hydraulic properties in which the hydraulic head responses are used as input data while the output consists of the fracture structure and matrix transmissivity field the multitasking is formed by fusing two single task neural networks both based on convolutional encoder decoder architectures one of which processes the fracture map inversion and the other the transmissivity map training neural network then relies on a large database which consists of thousands of synthetic aquifers characterized by the presence of the fracture conduit network and a heterogeneous transmissivity field attributed to the rock matrix both randomly generated in these aquifer models the groundwater flow equation is solved in a discrete continuum concept to numerically simulate the hydraulic head responses associated with sequential pumping injection tests multitasking succeeds in reconstructing the fracture architecture and matrix transmissivity field with higher accuracy in comparison to conventional single task networks the difference is due to the transfer mechanism involved in the multi task network where the information shared between the tasks effectively enhances the accuracy of both reconstructions however as with other inversion techniques the result accuracy depends on the quality and quantity of the hydraulic head data used in the inversion as well as the prior information involved in featuring the training models keywords convolutional neural network hydraulic tomography inverse problem karstic aquifer multi task learning deep learning data availability the authors do not have permission to share data 1 introduction fractured karstified aquifers store a significant portion of the world freshwater and characterization of their hydraulic properties thus occupies an essential place in hydrological research engineering activities and management planning streltsova 1976 coleman et al 2015 pedretti et al 2016 however these fractured aquifers are well known for their extreme heterogeneity with a complex spatial distribution of hydraulic properties hydraulic conductivity and specific storage that depend on the fracture conduit network structures white 2002 schuite et al 2015 which we refer to here as the fracture network assessment of these properties is usually accompanied by either mapping of transmissivity or its average value or identification of hydraulic connectivity between areas on the basis of piezometric data associated with pumping operations a slug or tracer test coleman et al 2015 tiedeman and barrash 2019 among these approaches spatial mapping of hydraulic properties by pumping experiments known as hydraulic tomography is the most efficient approach allowing a better consideration of aquifer heterogeneity when interpreting hydraulic head data from multiple pumping tests the spatial distribution of hydraulic conductivity field is mapped in a combined manner using an inversion code in this inversion process a deterministic stochastic or global optimization algorithm is implemented to find an optimal 2d or 3d hydraulic conductivity field capable of numerically reproducing the hydraulic head data measured in the piezometers during pumping tests sen et al 1995 carrera et al 2005 this process relies on numerical simulation of groundwater flow by solving the flow equation to determine the piezometric response to a water withdrawal over the study area with assigned hydraulic parameters transmissivity and storativity however parameterization of the two fields is challenging in the case of a karstified aquifer due to the strong contrast in hydraulic properties between the fractures and the matrix within this framework a number of concepts have been developed in the literature such as the discrete fracture network and the equivalent porous medium in the equivalent porous medium concept the heterogeneity of hydraulic properties of both the matrix and fractures is described as a single continuum in which both entities are represented by equivalent hydraulic properties attributed to the cells that discretize the aquifer i e fahs et al 2014 moutsopoulos et al 2022 in this concept fracture geometries are not considered which makes the concept simplistic and explains its extensive use in the parameterization of hydraulic properties in the inverse problem this concept has been applied in a variety of inversion cases ranging from synthetic case studies hao et al 2008 illman 2014 to laboratory experiments poduri et al 2021 sharmeen et al 2012 to real field investigations illman et al 2009 wang et al 2021 it is also used to image models at different scales ranging from a small scale lee et al 2011 to a large scale environment zha et al 2015 2016 in the discrete fracture network parameterization fractures are represented as lines surfaces in a 2d 3d continuum that handles the surrounding rock matrix ringel et al 2019 fischer et al 2018 klepikova et al 2020 this approach offers an advantage of a realistic description of the fractures but it requires not only the hydraulic property values of the fractures but also their characteristics regarding location connectivity density and size which are often difficult to determine in the field this last point makes the inversion task very complex which explains its limited application in solving the inverse problem the few applications of this approach are mainly in parameterization with stochastic somogyvári and bayer 2017 ringel et al 2021 or global le goc et al 2010 inversion methods dual continuum approaches represent the fracture network as an equivalent continuum coupling with the hydraulic heterogeneity in the matrix while at the same time establishing the hydraulic continuity between the two media trottier et al 2014 kaczmaryk and delay 2007 this concept has attracted the attention of some researchers in recent years who have applied it to synthetic or real cases trottier et al 2014 fischer et al 2020 in this paper we explore the use of the dual continuum concept as a numerical parameterization of a fractured aquifer during the inversion of hydraulic data in a hydraulic tomography study the heterogeneity of this field is not limited to fractures and conduits but can also be present in matrix compartment which can be described by an equivalent conductivity field in this way the inversion aims to identify both the structure of the main fractures with their hydraulic parameters here the transmissivity and the parameter field assigned to the matrix the originality of this work lies in the use of deep learning algorithms as an inversion tool which differs from traditional deterministic and stochastic inversion processes in fact the deep learning approach aims to formulate the inversion operator linking the piezometric data and the hydraulic properties of the aquifer the concept is based on sequential processing of the input data via linear nonlinear operators defined on hidden layers of the neural network in which each layer contains a set of parameters that translate the input data into outputs in a direct way the parameters involved in this process are identified in the learning phase based on an optimization algorithm to reduce the difference between the given data and the reconstruction from the network this learning phase requires a big database to effectively link between the two variables and ensure the generalization of the inverse operator in this work the database of piezometric data and hydraulic parameters consists only of synthetic data which implies an intensive and repeated computation of the groundwater flow equations while preparing database for training the network represents the major effort in the approach development the training itself can be efficiently performed with new generation networks and gpu computing resources the trained neural network however operates each inference instantaneously with advances in computational capabilities and neural networks deep learning approaches have become increasingly popular in the geosciences with applications ranging from geophysics to hydrology reichstein et al 2019 dramsch 2020 among these new neural networks convolutional networks cnns with an encoder decoder architecture have proven their ability to tackle tomographic problems in geophysics hydrogeology or remote sensing these networks consist of multiple convolutional layers that excel at extracting the features embedded in the input data with efficiency and simplicity a convolutional layer scans small filters on the input image in a defined order to construct feature maps that extract information about local regions venkatesan and li 2017 the feature map is then reprocessed by a nonlinear filter layer such as the rectified linear unit relu and its dimension is reduced by a pooling layer in an encoder before being reconstructed in a decoder structure to obtain the tomography from the learned features zhang et al 2021 these feature based processes focus on relevant information and make training fast and efficient ciresan et al 2011 krizhevsky et al 2012 to extract various features with different degrees of complexity multiple convolutional layers are combined in successive encoders in which the simple features extracted by the lower convolutional layers are refined by the subsequent layers to capture more complex representations the capability and flexibility of cnn in identifying features allows for broad application in solving a variety of tomographic problems in the geosciences these include seismic facies mapping zhao 2018 moseley et al 2020 adler et al 2021 characterizing the subsurface environment from electrical properties vu and jardani 2021 mapping aquifer heterogeneity in hydrology vu and jardani 2022a jardani et al 2022 detecting fracture network vu and jardani 2022b or modeling heat transfer rajabi et al 2022 most of the aforementioned work has been realized with cnn architectures that efficiently process input data to map only a physical parameter field in the subsurface as a single output of the neural network however in a multivariate problem the different tasks can be handled in a joint manner with a single neural network to achieve better performance by learning the tasks simultaneously and resulting in multiple outputs misra et al 2016 zhang and yang 2021 a multi task learning mtl in fact can be built from the integration of single task networks that shares the hierarchical representations at certain levels ruder 2017 such a strategy allows the network to learn the similarities and contrasts between the shared tasks as it becomes a source of data augmentation used in training which is crucial to obtain highly generalized representations in the data and avoid the overfitting problem caruana 1997 instead of forming an independent neural network for each task all tasks can be assigned to a single network by optimizing a unified loss function that combines the loss functions of each task thus in this case the loss of each task serves as an additional regularization to facilitate and stabilize the optimization process thung and wee 2018 in other words the mlt network prevents overfitting during the learning process and improves the quality of the reconstruction at the end multitask learning is a new concept in artificial intelligence and has been successfully applied in many fields including natural language processing computer vision and industrial applications liu et al 2019 csurka 2017 chowdhuri et al 2019 however its use in geosciences is still tentative with few applications in seismic data processing for example siahsar et al 2017 used mtl to better mitigate the impact of random noise in synthetic and real three dimensional seismic data in reasonable time wu et al 2019 built an encoding decoding algorithm for local seismic image processing that integrates a fault map clean seismic image and normal estimation for better accuracy and sharper fault detection li et al 2020 attempted to improve the efficiency and accuracy of full waveform inversion to construct a high resolution seismic velocity model the use of mtl in hydrology is rather rare and in this context vu and jardani 2022c proposed an encoder decoder based architecture for simultaneously mapping transmissivity and storativity fields from hydraulic head measurements this network outperformed conventional inversion networks and single task networks in terms of accuracy in this paper we propose an architecture with mtl to jointly map two fields one for the fracture trace and another for the hydraulic transmissivity for the matrix the architecture consists of two interconnected encoder decoder neural networks with input data from piezometric measurements acquired during pumping tests conducted in a fractured aquifer the encoder decoder neural networks are based on the segnet architecture which has been shown to be effective in image processing in terms of interpretation accuracy and computational cost badrinarayanan et al 2017 the paper will discuss the effectiveness of this multi task network in hydraulic tomography of fractured aquifers and will be organized into four sections in the second section the theoretical background is briefly described with numerical modeling of water flow in a fractured aquifer used to generate the training data we also describe the inversion concepts in hydraulic tomography and the design of the proposed multi task neural network section 3 details an application of the mtl network on synthetic cases the efficiency of the network is discussed in section 4 to examine the impact of data coverage data noise and inconsistency of interpreted features on its performance at the end of the paper the main results of the study are summarized with prospects for future development 2 theoretical background in this section we briefly review the concepts used to solve inverse hydraulic measurement in fractured aquifers using a deep learning approach first we introduce the numerical modeling of groundwater flow or the forward problem used in both classical and neural network inversion approaches to simulate the piezometric responses as a function of hydraulic properties assigned to the domain representing the aquifer under study next we describe the mathematical formulation of the inversion using deep learning in which the properties of the multitask neural network its operation and innovations are detailed and discussed at the end of the section 2 1 forward problem groundwater modeling groundwater flows at steady state in a confined isotropic fractured aquifer where the heterogeneity of the transmissivity field with respect to fractures and matrix is expressed by the discrete continuum concept we denote the 2d domain as ω ℝ2 with the boundary γ in which the union of all fractures is denoted as ωf and the surrounding rock matrix as ωm with the contact between two as γmf a conventional subscription m and f are adopted to denote the variables corresponding to the matrix and the fracture respectively within ωm the mass balance equation and the constitutive law are 1a ρ q m q m q m k m μ p m ρ g similarly within the ωf 1b ρ q f ρ q m n f q f k f μ p f ρ g where q is the darcy flux p is the aqueous pressure k is the permeability μ is the fluid viscosity and ρ is the fluid density and g is the gravity and q denotes the external sources nf is the normal vector pointing into the fracture domain and q m is the flux between the matrix and the fracture on the matrix fracture interface γmf the mass conservation law leads to the continuity condition 1c q m n f q m n f in the fracture averaging the balance equation in normal direction yields 1d q m n f 4 k f μ a f p f p m where af is the fracture aperture and pm is the mean value of pressure in the matrix in two sides of the fracture the solving is subject to the boundary condition 1e p p γ at the boundary γ as well as the following initial boundary condition 1f p p 0 at t 0 these differential equations defined for the matrix and fracture components can only be solved by a numerical method such as the finite element method using the dirichlet boundary conditions eq 1e on the four boundaries of the domain γ which are located far from the studied area using a buffer zone where the transmissivity is considered homogeneous this study utilizes the developed comsol module specifically designed for fractured aquifers incorporating mesh refinement techniques around the wells and fractures the solver adopts the finite element method to solve both equations to capture the spatial distribution of the hydraulic head at the observation wells during sequential pumping tests in the end the operator of 2d forward problem can be expressed as a function that depends on three parameters 2 h h t m t f λ f where h denotes the forward operator the hydraulic head h is the response to pumping tests carried out on an aquifer represented by a matrix of heterogeneous hydraulic transmissivity tm intersected by a fracture network of transmissivity tf and geometry λf 2 2 inversion problem hydraulic tomography from gw level measurements in this study the inversion problem deals only with the reconstruction of the matrix transmissivity tm and the fracture geometry λf estimating further fracture properties such as transmissivity requires more data and a deeper neural network which demands enormous computational power that is not currently available determining the transmissivity of fractures will therefore be the subject of a later work in a classical inversion method the identification of these two parameters can be done with deterministic or stochastic schemes via optimizing an objective function these parameter models are determined based on a criterion of adequacy to reproduce the hydraulic data and to fulfill the criteria imposed on the basis of the prior information to achieve a reasonable solution the optimization process often relies on an iterative scheme in which multiple models are tested sequentially with a typical objective function s being as follows 3 min s t m γ f h o b s h t m λ f t m 0 λ f 0 where hobs denote the hydraulic head measurements and t m λ f are the parameter fields t m 0 λ f 0 represent the parameter fields proposed as prior models a constraint in the optimization however inversion with a deep learning differs completely from the classic inversion with the optimization algorithm above deep learning indeed approximates the inversion function that connects straightforwardly input data to output map in this case the hydraulic head data at the input and output with the fracture geometry and transmissivity field the problem is then reformulated where this strongly non linear relationship is established by a set of coefficients involved in linear nonlinear operators of the neural network using the training database therefore the optimization problem is defined by estimating the network parameters through minimizing the following objective function l 4 min l ω t m λ f ψ h ω where ψ represents the neural network with its learnable coefficient system ω that approximates inversion operator linking the hydraulic head data h and aquifer parameters t m λ f this minimization process is known as learning phase in which the parameters are determined based on their ability to enable the network to reconstruct the aquifer models t m λ f from corresponding input h both given in the training database the performance of the network depends strongly on its structure and the training database the preparation of training database is the costliest step of this method since its construction involves solving the forward problem to generate numerical hydraulic head data for thousands of given matrix transmissivity and fracture structure maps in fact the learning phase requires a massive database to form a network with a proper generalization thus it implies a repeated computation of the forward problem and the implementation of a generator for flexible aquifer models in which their characteristics can be defined according to the prior information through this step the prior model intervenes in the inversion process with deep learning algorithms in classical optimization the prior model is introduced into the objective function but here into the database instead to drive the inversion to a plausible solution with certain known properties indeed the inverse problem using deep learning tools is not formulated as a classical optimization problem where the predefined condition i e the physical constraints are directly used to find the optimal solution here the predefined condition is only involved in generating the training data that is used to train the networks therefore the inverse solution of transmissivity and fracture structure can be found separately since this solution does not require the obtained fields to reproduce the hydraulic data this type of approach has been used in several geoscientific disciplines such as geophysics where the seismic section has been trained with a network to find the geometry of faults e g wu et al 2019 li et al 2020 these faults are not defined by their ability to reproduce the seismic data but their determination depends on the ability of the network to detect how the data relates to the existence of the fault after it has been trained to perform this task the comparison between the classical inversion approach and deep learning has been discussed in jardani et al 2022 2 3 multi task architecture deep learning algorithms have been developed based on an imitation of the complex information processing of the human brain which allows a human being to use the knowledge acquired in one task to perform other tasks this transfer of learning occurs in different human activities such as playing sports learning languages playing music or performing jobs development of multi task networks is thus motivated by learning biology in order to design a neural network in which relevant information can be transferred between the tasks multi task learning relies primarily on knowledge transfer within the network operation a single task network on the other hand aims only at predicting a particular variable while ignoring the information that can be retrieved during the execution of the other tasks sharing information in a multi task network allows similarities and contrasts between tasks to be incorporated into the learning improving the efficiency of the network in addition cross transfer increases the amount of data used in the learning process for each task which is critical to promoting the model generalization a multi task neural network can be designed from multiple single task networks according to the number of tasks performed while ensuring the exchange of information between them in this work the segnet network with an encoder decoder architecture is opted to construct the multi task network that aims at mapping the transmissivity of rock matrix and detecting the trace of fractures this network was originally developed to capture the complex conditions of real traffic badrinarayanan et al 2017 quickly segnet has proven to be highly effective in a number of applications across disciplines dash et al 2020 audebert et al 2017 kolhar and jagtap 2021 it has also been tested for applications in subsurface tomography such as processing apparent electrical resistivities recorded at the ground surface to image the electrical resistivity distribution in the subsurface vu and jardani 2021 in hydrology this concept was developed to map the transmissivity field in the interpretation of pumping or tracer tests jardani et al 2022 vu and jardani 2022a 2022b 2022c indeed the proposed multi task architecture consists of two segnet networks each of which performs the corresponding individual tasks see fig 1 while the upper network is designed to perform a segmentation task to reconstruct the fracture map the lower network involves a regression task to map the transmissivity field both networks consist of four encoder decoder pairs terminated by a soft max layer for the upper network and a regression layer for the lower network information transfer between the two networks is implemented in the last layers by a concatenation layer and a 1 1 convolutional layer the high level features of the higher network are transferred and concatenated to the lower network to improve the efficiency of the mtl both networks interpret the same input data the hydraulic head and its gradients these maps are derived by interpolating piezometric point data to form the input as a matrix of the same dimension as the estimated output fields recall that an efficient design of a multitasking architecture must be built on a thorough analysis of how single tasking networks work here each network consists of multiple encoders arranged in pairs layered similarly to decoders but in reverse order the encoders aim to extract generic features from the input image while the decoders convert these extracted features into the output map the encoding task is based on successive convolutional layers cn with which several filters scan the input image piece by piece and detect some relevant features formed by the neighboring pixels then the extracted maps go through a batch normalization bn and a rectified linear unit relu layer to incorporate nonlinearity into the analysis then the dimensionality of these low level feature maps is reduced with max pooling operator to preserve only the important features thus reducing the computation time on the other side by using the same layers the decoder is designed to process the output images with an up sampling operator to recover the original dimensionality lost during encoding by transferring the indices of the max pooling operator from the encoders this bridging mechanism improves the accuracy of the output map reconstructions since these shared indexes are smaller in segnet than in competing architectures such as unet abdollahi et al 2020 that requires less computation time and memory segnet architecture offers performance and learning advantages that make it effective for building a multitasking network the design of mtl networks is primarily based on sharing information between subnetworks of tasks sharing can be done at different levels to incorporate the relevant information to improve the efficiency of one or all tasks in the sub task networks but the structure of the neural network and the deep nature of cnns make it difficult to thoroughly evaluate all conceivable structures to select the best level of sharing in general levels are selected for sharing where there is commonality between tasks which is the case for some imaging applications csurka 2017 thung and wee 2018 ruder 2017 however in physical problems such as geosciences the subsurface properties interpreted with the networks often have ambiguous relationships despite the difficulty in relating the physical properties sought the use of mtls can be beneficial romera paredes et al 2012 experiments with synthetic and real world data have shown that incorporating information from other tasks where relationships between parameters are not identified can even significantly improve the traditional mtl technique romera paredes et al 2012 hajiramezanali et al 2018 in our case the algorithm reconstructs the fracture geometry and the surrounding transmissivity heterogeneity which are independent in nature and have different properties even the identification of the two parameters is based on the same piezometric signals sharing information at low level representations between the sub networks is less interesting however sharing high level information at the decoder level can improve the reconstruction quality of the resulting maps such a concept has already been successfully applied in a cascaded multi task network in processing e g visual scene understanding or face recognition dai et al 2016 wu et al 2019 therefore in this new network we keep the connection mechanism between encoders and decoders while connecting the subnetworks at the end of the decoder segment these two information transfer mechanisms help to increase the reliability of the outcome mappings for further explanation this study develops a cascaded architecture with two tasks corresponding to the maps where the output of one task is used as input for the next task in this way information can be transferred sequentially from one task to the next resulting in improved task performance there are two main mechanisms in the proposed network for information transfer see fig 1 first the last hidden representations from the first task are combined and later used as input for the second task this allows for more complex information about the internal workings to be transferred between tasks second the above output representations are combined into a single representation and merged with the intermediate representation of the second task which guides further processing to improve the task interpretation accuracy the learning process thus aims to optimize a single loss function reformulated as the sum of two loss terms from the two tasks such formulation ensures that each task acts as a term regularization for the other which numerically stabilizes the optimization the loss function l is formulated as follows 5 l l f λ l m in this equation lf is the cross entropy function that is used as a loss function to evaluate the adequacy of fracture geometry predictions 6 l f n s ln s n where s denotes the fracture parameter field 1 represents the fracture pixels and 0 the matrices and s is the corresponding prediction n is the number of parameters in each field in this case equal to 64 64 the second loss function lm for the transmissivity map is expressed as the least squares difference between the true t and predicted t transmissivity maps in a logarithm scale 7 l m n t t 2 n and λ is a scalar coefficient that varies during the learning process from 0 05 at the beginning to 1 at the end of the training which aims to balance two tasks thus the multitasking architecture is trained using a standard gradient descent algorithm that performs an end to end operation the architecture now functions as a unified framework that provides two output maps each map describing a field separately as a post processing the two maps can later be externally overlaid after inversion for visual purposes which can help to better localize features and condense the visualization in short the proposed multitask architecture works jointly by combining the ending sections of multiple tasks into a single neural network where the second subnetwork builds upon the results of the first subnetwork to guide the prediction once the first subnetwork performs the fracture detection and generates a candidate fracture map the second subnetwork takes the generated fracture and refines the processing matrix map as each subnetwork is initially designed to execute its task efficiently and accurately the cascaded structure allows the use of intermediate results from one task to further enhance the efficiency of the next task this joint approach thus enables to perform multitasks in a unified framework reducing computational costs and increasing accuracy compared to separate single networks yet a concrete explanation of how deep neural networks work remains a major challenge at the current state of deep learning development i e burkart and huber 2021 roscher et al 2020 especially given the complex architecture in this work high dimensionality with many layers millions of parameters and multiple activation functions in deep neural networks which are often nonlinear and complex makes it difficult to figure out how the network processes data and makes predictions this challenge underscores the need for techniques that can improve the explainability of deep learning models in the future 3 application in this section the mtl network is trained with synthetic data by randomly generating thousands of synthetic 2d aquifers containing fractures surrounded by a heterogeneous transmittivity matrix in these aquifers we installed a series of wells to perform pumping tests in hydraulic tomography mode the hydraulic head data numerically obtained from the pumping tests are used as input data for the network while the output maps consist of the aquifer properties including the fracture geometry and the matrix transmissivity field the generated aquifer properties with the well configuration are presented at the beginning of the section followed by discussions of their use in training the network 3 1 aquifer model fracture network embedded in a heterogeneous matrix the investigated area covers a fractured aquifer of 100 m 100 m in which we placed 49 observation wells in a regular distribution of 12 5 m in each direction to determine the transmissivity heterogeneity and fracture network in the subsurface four dipole pumping injection tests are performed on pumping injection wells located at the edge of the zone and designated by numbers as shown in fig 2 during each pumping test the hydraulic head at steady state is recorded at the observation wells these measurements are then used as input to the neural network the dipole configuration of hydraulic tests better captures the spatial heterogeneity of the aquifer on this domain we randomly generated 45 000 models of the hydraulic properties of the aquifer that include the fracture geometry and the matrix transmissivity field considered as a heterogeneous parameter these models are used for training the network and testing process for the transmissivity matrix we used a gaussian geostatistical variogram to generate fields with a mean transmissivity value ranging from 10 4 to 10 6 m2 s while the magnitude varies from 10 2 to 10 8 m2 s such variability in the transmissivity field allows the construction of a network capturing the true complexity of the matrix heterogeneity which may include equivalent transmissivities related to the presence of secondary fractures not included in the generated fractures the fractures are introduced as 1d polylines crossing the study area of which the orientation as well as their number in each aquifer model are randomly chosen between zero and three in this study the transmissivity of the fractures is set to 0 01 m2 s for simplicity but their traces are variable the characteristics of the fractures relate to the local aquifer conditions which is located in a strongly karstified chalk aquifer in normandy france 3 2 data acquisition and data processing the forward problem operator based on the numerical solution of the groundwater flow equation operates for each aquifer model to obtain the hydraulic head responses in the pumping injection tests the hydraulic responses captured at the observation wells are then interpolated to construct the input data as maps of the same size as the output maps for this purpose the nearest neighbor interpolation method is adopted to obtain a hydraulic head map of 64 64 for each pumping injection test for four pumping tests the resulting data form a multi channel matrix of 64 64 4 as the hydraulic impact of fracture transmissivity and matrices provide well contrasted flow patterns with the fractures characterized by highly focused flow by incorporating the gradients of the hydraulic head map in two directions the input data finally is a multichannel image of 64 64 12 the principle of a convolutional neural network requires image to image processing thus the fracture traces are discretized in a binary image with 1 for fracture and 0 for others while the matrix transmissivity is discretized in a scaled image neural network output then consists of two maps one for transmissivity and one for fracture both meshed with the same 64 64 resolution while the former represents the tomography of the logarithmic value of transmissivity located at the outcome of the lower half of the architecture which is in fact a regression neural network the latter is a binary map located at the end of the upper half in the designed architecture which is a classification neural network see fig 1 finally at the end of the neural network two maps are combined to obtain a better visualization of the entire aquifer model with the fracture pixels in the latter overlaying the transmissivity image in the matrix 3 3 learning process and results in the learning phase we randomly selected 30 000 models for training and 5000 models for validation from database of 45 000 generated models the remaining 10 000 models are set aside to evaluate the performance of the trained network the process of generating the database takes approximately three days using a dell precision tower 5810 equipped with a single cpu the training step determines the parameters of the neural network over many iterations each iteration analyses a number of samples minibatch a subset from the training dataset to reduce computational cost this process often requires optimization over multiple full cycles through the training data set the epochs the neural network is trained with the adam algorithm implemented in matlab with a constant learning rate of 0 001 and a minibatch size of 96 to regularize task balance in the unified loss function we used the weighting coefficient α in eq 8 is reset from 0 1 to 1 at epoch 11 after 43 epochs the training is stopped manually to avoid the overfitting problem the training takes 16 h on a single nvidia quadro k2200 gpu in a dell precision tower 5810 and the loss function evolving in the process is shown in fig 3 to metrically assess the quality of network inferences we used the following three metrics where the accuracy of the fracture map is based on the similarity between the truth and predicted maps as following 8 a c c u f r a c n s s n 100 where s and s represent the true and predicted labels of fracture or matrices to evaluate the reconstruction of transmissivity field two other metrics are used including the coefficient of determination and the root mean square error defined as follows 9 r t 2 n t t 2 n t t 2 10 r m s e t n t t 2 n where t t t are the truth its mean and prediction of logarithmic transmissivity respectively applying the network to the 10 000 unseen data takes 0 03 s per model to reconstruct the fracture network and transmissivity field from the measured hydraulic heads over the entire test data set the average accuracy reaches 94 7 for fracture reconstruction while the transmissivity fields are mapped with an accuracy of 0 77 for r2 and 0 21 for rmse a histogram of the accuracy distribution is sumarized in fig 9 and the parameters are listed in table 1 both of which can be found at the end of this section to illustrate the effectiveness of the approach in detail fig 4 illustrates six representative inferences with different characteristics and complexity levels in the fracture network and matrix heterogeneity in general the reconstructions are able to capture the main features of each target field with high accuracy both in terms of the magnitude of the transmissivity values and the location of the fracture networks as shown in fig 4 the prediction quality of fracture structure decreases slightly with increasing number of fractures and complexity in the models for simple configurations from ex1 to ex2 with none to two fractures the interpretations properly reproduce the fracture shapes in their matrix environment nevertheless minor interpretation errors can occur in regions of dense fractures such as the lower half of ex4 and the middle of ex6 where fractures intersect closely this is due to the limited resolution of the piezometric coverage over these regions which does not allow for a more precise distinction of the fractures with this level of detail the coverage constraint thus can present a challenge in locating fracture intersections as accurate determination in neighboring intersection may require a fine resolution in the measurement scheme indeed this dilemma between data coverage and detail reconstruction is a common challenge in solving inversion problems vandecar and snieder 1994 ren and kalscheuer 2020 the accuracy of the transmissivity field reconstruction also depends on data coverage and complexity of the target field however the impact of the cross fracture network on this identification is unclear or non existent this is due to the mechanisms of multi task network where the information from the two sub networks effectively distills the cross effect of two parameter fields in the interpretation results as the minimal sharing is implemented at the high level features in the mtl design each subnetwork can effectively contribute to its original performance in the whole network in order to explore and highlight the benefits of multi task learning the next section compares the mapping results from mtl with those from single task networks under the same conditions 4 discussion this section focuses on the discussion of various factors that condition the quality of the reconstructions obtained with the network first we compare the reconstructions obtained with the multi task network with those obtained with a simple single task network the impact of other aspects is also addressed such as the size of the observation data and its noise level as well as the nature of the training models 4 1 effect of multi task network comparison to the single tasks to highlight the advantage of multi task learning we compare its reconstruction results to those obtained with conventional single task neural networks the single task networks are designed to perform a specific task one for mapping fracture network the other for transmissivity field both are based on a four level segnet architecture which actually correspond to the upper and lower subnetworks of the proposed multi task architecture described in section 2 3 two single task architectures are then trained validated and tested on the same database as the multi task architectures the trainings of both architectures are performed in 60 epochs with a constant learning rate of 0 001 in 6 h each on the same computer and with the same training algorithm each network has about 0 5 million parameters which is half size of the multitasking architecture and both are obviously faster to build however the execution time and number of parameters of the two single task neural networks are ultimately of the same order of magnitude as the multi task neural network regarding their evaluations on the same testing dataset they provide an average accuracy of 94 3 for fracture mapping and the average rmse and r2 values for transmissivity mapping are 0 22 and 0 73 respectively the outcome metrics show that single task performance is competitive with multi task performance as found in previous research in the visual domain dai et al 2016 wu et al 2019 however there is a slight degradation in fracture reconstructions with single task networks of 0 4 of r2 over the 10 000 test inferences a degradation is also observed when mapping the transmissivity field with the single task networks with 5 higher in rmse compared to the multi tasking the statistical comparison between the two models on the test dataset is shown in fig 9 with the average metric shown in table 1 examining such a large number of test samples proves a real improvement made by the mtl network for more details the results from the single task networks are shown in fig 5 with the same representative models used in fig 4 for mtl metric analysis of these results shows a slight multitask network advantage in fracture reconstruction especially in ex3 6 this advantage of mtl is largely confirmed in mapping the transmissivity field where the network is able to better capture the heterogeneity of matrix transmissivity compared to the single task models this is due to the sharing concept in the multitask neural network that transfers relevant information from the fracture prediction to improve the prediction of the transmissivity map the fracture mapping itself has a marginal gain likely due to the use of a regularization term in the objective function optimization overall multitasking in this case requires more computational cost but provides more accurate results 4 2 effect of number of observation points to further investigate the impact of piezometric coverage on reconstruction results we reduce the number of observation wells to 25 wells almost a half of the initial configuration and then a third with only 16 wells using less wells saves installation costs in practice but also provides fewer input data points for the interpretation process as in the previous case the database uses the same generated aquifer models the multitask neural network is then retrained to better adapt to the new configuration and analyzed on the same 10 000 test models in this first new configuration we reduce the number of wells but arrange them in a regular grid as shown in fig 6 a case 2a the test results in metrics show an average accuracy of 92 52 for fracture identification while the transmissivity fields are reconstructed with an error of 0 27 for rmse and a correlation of 0 62 for r2 metric comparisons of the new configuration with the original reveal a clear degradation in reconstruction quality for both maps when piezometric coverage runs into low resolution this degradation in mapping accuracy is also confirmed visually in the representative examples as shown in fig 7 for the new dataset in cases with simple fracture shapes as in ex2 to ex3 even with sparser observation wells the neural network enables to locate them effectively however it is not the case for the more complex fracture networks in ex4 though ex6 a low resolution of hydraulic data is insufficient to capture the full complexity of the environment producing interruptions and artifacts in the fracture reconstructions detection of complex fracture geometries often requires high level of input data coverage a problem that has been frequently reported in previous imaging studies sarker et al 2019 khan et al 2020 jardani et al 2022 however the condition is more favorable for the reconstruction of transmissivity field as the main patterns are well captured by the neural network with some smoothing indeed mapping a continuous field is less demanding if a tomography can be interpolated from values at only some points such interpolation may result in a lack of detail and exaggerated smoothing but the main feature of the field can be formed in general to get better insight into the coverage issue the next case examines an irregular distribution in the monitoring wells which is a common situation in hydrogeological investigations case 2b the new arrangement with different grid space in the two directions highlights the impact of well density on the prediction accuracy while the upper left corner is monitored with the coarsest resolution the lower right side maintains the same high density as the original scheme the other two sides have intermediate density see fig 6b interpretations of the test data set show almost similar average values of metrics as in the previous case table 1 this trend is also confirmed in fig 7 where the results of both cases show some similarity as the key features are still well located in the fracture and transmissivity maps however the details in fig 7 clearly demonstrate how data coverage determines the quality of interpretation the fractures in the upper conners associated with low resolution in monitoring are delineated with low accuracy especially in the complex cases ex3 to ex6 with the presence of interruptions and artifacts when the number of observation points is further reduced to 16 wells case 2c the quality of the interpretation deteriorates due to the lower resolution of the monitoring data mapping accuracy of fracture decreases to 91 76 and the same is true for transmissivity reconstruction with rmse and r2 of 0 29 and 0 56 respectively as with other classical deterministic or stochastic inversion methods the accuracy of the imagery obtained with xnet depends on the adequacy of the data resolution used in the inversion in the case of piezometric coverage with a small number of piezometers the accuracy of the results may drop particularly if the target field has a complex heterogeneity data noise can also be a factor in degrading the accuracy of reconstructions and this will be discussed in the next section 4 3 effect of observation uncertainty in practice each measurement is likely to be associated with noise from known or unknown sources that challenges any data interpretation process to investigate the impact of noise on the accuracy of reconstructions we contaminate the original data with various levels of random noise in the first test a common noise scale is added to the observation of a hydraulic head with 5 of the measured value case 3a the neural network trained in section 3 3 is recalled here to interpret the testing dataset contaminated with the noise when mapping the fracture structure the average accuracy for 10 000 tests is 93 91 while the matrix transmissivity is reconstructed with an average accuracy of 0 70 for r2 and 0 24 for rmse the interpretation of the data set is compared with the uncontaminated case in fig 9 to illustrate the effect of noise the statistical analysis reveals a slight deterioration associated with noise in the reconstruction of fracture and transmissivity maps to explore this issue further we analyze the results of the representative models shown in fig 8 where the network correctly maps the heterogeneity of the aquifer however in these reconstructions the fracture shapes exhibit some misalignment when examined closely while other interruptions and minor artifacts appear in the ex4 results the degradation of the reconstructions intensifies when a higher noise of 10 is imposed in the original signal case 3b both cases evident a significant deterioration of the reconstruction quality which illustrates the dependence of mapping accuracy on the measurement noise the details of reconstruction with these noise levels are listed in table 1 and summarized in fig 9 for the whole contaminated datasets transmissivity field mapping appears sensitive to the presence of noise when r2 drops from 0 77 for uncontaminated data to 0 50 for 10 noise whereas fracture mapping does not show much change with respect to the noise the difference could be due to the nature of the inferred fields fractures with several orders of magnitude higher conductivities drive the flow field in the aquifer thus favoring the detection process the transmissivity imaging is further reconstructed from data points distributed over the study area where the grouping noisy points can lead to misinterpretation with presence of false fractures and minor artifacts a detailed analysis of the representative results in fig 8 proves that despite the decrease in accuracy metrics under the influence of noise the transmissivity mapping is still reliable as the main features are well pronounced in all samples overall the transmissivity and fracture reconstructions show some resistance to noise in the input data despite some slight interruptions and artifacts observed on the mapped fields this resistance to noise has also been described in previous studied on hydraulic and electrical tomography vu and jardani 2021 jardani et al 2022 and other imaging topics zhu et al 2018 chen et al 2017 this advantage is due to the way the input data is processed in a convolutional neural network that translates the input image through scanning a set of small filters to extract the feature maps by working region by region the interpretation can limit the impact of noise at each data point therefore this feature based method preserves the most relevant information embedded in the input data at the end the results of the previous tests are summarized in fig 9 with the comparisons with the original scheme which provides an overall picture of the test set of 10 000 samples with the average of accuracy metrics detailed in table 1 4 4 influence of features in training models as a data driven model the neural network reconstructs the hydraulic heterogeneity of an aquifer from a training database a large database seems to lead to a more generic mapping solution but being costly in practice using a small database requires less effort from which the trained network can be less generic when it can only target the models having a similar property with the trained data in this study a database with broad features was generated to cover as much diversity as possible but it still may be insufficient to capture complex heterogeneity that may occur in a real fractured aquifer to test the degree of generalization and dependence of the trained network on the actual database we apply the trained network to process the piezometric data coming from models with different features from the generated database for this purpose the trained network is tested with six models embedded features that differ from learning the first three models involve a discontinuous and binary transmissivity field while the last three with fracture networks differ from those of the trained models see fig 10 in the first test case a the neural network correctly reconstructs both regions in terms of amplitude and shape with the region boundary well delineated the smooth and continuous nature of the training fields impose a gradual transition in transmissivity boundary between the two regions such an effect is also visible in the detailed reconstruction of each region where the transmissivity value varies throughout regions instead of being homogeneous as in the true model the accuracy of the reconstruction then deteriorates when the difference between two regions increases up to three orders as shown in case b a strong transmissivity contrast can lead to a significant change in the water flow mode near the interface of two regions whose behavior resembles well to the presence of a fracture there as a result a false fracture appears in the reconstruction this discrepancy also causes a significant degradation in mapping the transmissivity field but the shape of the two regions is still reliably delineated case c is more complex with the presence of both fracture network and large transmissivity contrast in the matrix components such complexity complicates the flow field modalities leading to deterioration especially in the transmissivity field reconstruction but the region boundary is still recognized with some perturbations by fracture intersections despite some deficiencies in the fracture and transmissivity fields all aquifer components are reasonably formed the next test involves a fracture system with short segments case d as shown in fig 10djp this configuration differs from the trained model which consists of only long fractures running throughout the region while the main fracture is well determined the short fractures are almost neglected in the mapping this is not surprising since the main fracture with significant hydraulic activity is easy to detect detection of minor fractures is otherwise conditioned by the coverage of observation data as discussed in section 4 2 where more detail on short fractures requires a finer monitoring system in the fifth test the study is extended to detect more fractures with four long fractures that exceed the maximum number of three fractures in the trained model case e the interpretation delineates only three fractures which corresponds well to the trained condition the final test further focuses on the change in hydraulic property of the fracture with each fracture having a different transmissivity unlike the trained model where all fractures have the same transmissivity in this case we keep only one fracture with this value the black one in fig 10f two other fractures deviate from the original value one with three times higher transmissivity the red and one with three times lower transmissivity the blue the result in fig 10l r shows that the two fractures with higher transmissivity are correctly located whereas the left one with the lowest transmissivity is poorly described the low transmissivity of the latter which is barely different from the background matrix prevents the neural network from providing an accurate interpretation overall the difference between the trained model and the tested model presents a challenge to the interpretation process where the reconstruction accuracy varies with the complexity of the feature encountered this also reflects the nature of a data driven model where reliability is based on consistency between the given database and the processed inference for this reason training models must be featured on the basis of prior information in order to find plausible solutions 5 conclusion in this work we develop a new approach to mapping fracture trace and matrix transmissivity field of karstified fractured aquifers by inverting piezometric data associated with pumping tests the inversion method is based on a deep learning algorithm using a neural network with a multi tasking architecture to image multiple fields simultaneously this multi task neural network which is rarely used in inverse problems provides an end to end operator that directly approximates the nonlinear inverse function with two output images of fractures and transmissivity rather than adjusting the measurement via a minimization process as is the case in conventional deterministic or stochastic methods the neural network proposed in this work is inspired from segnet an encoder decoder architecture that is widely used for traffic scene analysis due to its performance and low computational cost each fracture trace or matrix transmissivity field imaging can be indeed performed separately as a single task with the use of segnet instead a multi task network is designed to perform both tasks jointly to enhance the quality of reconstructions by introducing information transferred between the two tasks in this network only the high level features at the end of each individual task are transferred while the skip mechanism of the original segnet is maintained transferring information from the fracture prediction network to the other transmissivity field prediction task significantly improves the latter reconstruction the transfer mechanism provides the transmissivity field subnetwork with information about the area dominated by flow in the fractures which refines the identification of the transmissivity field and thus promotes mapping accuracy the proposed architecture also provides a lightweight neural network without pre trained or external parts that can be then trained directly with a standard gradient descent algorithm in addition the use of a single unified loss function allows for better generalization of both tasks when each act as a regularization term for the other to investigate the performance of the multitask neural network in this study we use 2d synthetic data that simulate pumping injection experiments conducted in heterogeneous and fractured aquifers such a random generation scheme with a wide variety of model features guarantees a reliable generalization of the network the trained multi task network is then tested with 10 000 unknown subsurface models with each inference taking 0 03 s almost instantaneously the mapping result also confirms the performance of the network by providing accurate reconstructions for fractures and transmissivity fields multi task learning also shows significant improvement over single task networks with a 5 improvement in transmissivity tomography mapping and better fracture determination the performance of the proposed multitasking solution can also be impacted by factors such as the quantity and quality of piezometric data which are common interferences in any inversion algorithm regardless of the nature of method used as with other data driven algorithms data size controls mapping accuracy where a poor data coverage due to a small number of observation points degrades the reconstruction quality of both fracture and transmissivity reconstructions however the neural network shows certain resistance to data noise in the measurement experiments with noise of 5 to 10 a common order of magnitude in hydraulic data reveals a marginal degradation in mapping fracture structure and transmissivity heterogeneity this advantage is related to the nature of processing data within the proposed neural network where convolution operators translate the input data based on patterns rather than processing each data point individually finally the trained network is tested on complex aquifers whose characteristics differ from given features in the training database the mapping result confirms some dependence of the proposed network on the nature of the trained models even though featuring the database used for training the neural network in practice should be tied to prior information in order to target a realistic solution a better understanding of field conditions may hence ease the requirement for a large data set while maintaining reliability with comprehensive constraints however by its very nature using a cnn model requires significant computational resources especially in a real case that is often complex and considers many features as a prototypical study this work only addresses a 2d approach with a synthetic dataset and only considers limited features in both the fracture network and matrix continua future work should consider a more complex case especially for fractures such as with transmissivity heterogeneity non darcy flow a deeper investigation in the future should also include an uncertainty analysis with a better explicability of a working mechanism between tasks which should be clarified with real data to cover all aspects of the proposed algorithm credit author statement m t vu conceptualization methodology software data curation writing visualization investigation a jardani conceptualization reviewing and editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper 
