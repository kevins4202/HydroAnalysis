index,text
23360,sea traffic growing from year to year contributes significantly to increase of dangerous ship ship encounters which if not handled properly may result in an accident the existing anti collision systems installed on ships improve navigation safety significantly however navigation decision support systems solving complex encounter situations providing navigator with simple but reliable information are still at the development stage therefore this paper shows the concept of the multi arpa marpa system along with case studies the system is intended to deliver to a navigator on board ship information on safe headings while encountering other ships the safe headings are determined based on the level of hazard that other ships create or will create once the heading of the own ship is altered the system may evaluate and visualize safe heading adopting multi level or binary classification the presented system operates on the basis of an algorithm designating direct hazards for the own ship for the set of manoeuvres in an encounter situation for numerous ships keywords arpa marpa anti collision manoeuvre individual comfort limit manoeuvre last chance manoeuvre main abbreviations and symbols arpa automatic radar plotting aid ais automatic identification system c classes mathematical function cm the calculating module of arpa colreg the international regulations for preventing collisions at sea cpa closest point of approach cpac closest point of approach class dh direct hazards dnh the degree of navigation hazard ecdis electronic chart display and information system em the executive module gps global positioning system indh indirect hazards iclm individual comfort limit manoeuver lcm last chance manoeuver marpa multi arpa pd packages of data for objects pmarpa parameter calculated by marpa tcpa time to closest point of approach tcpac time to closest point of approach class up user panel vm verification module of marpa 1 introduction sea traffic growing from year to year created a new challenge for navigators and traffic engineering denser traffic creates complex encounters between ships that may turn into an accident if not solved properly in time and space to this end numerous navigational systems have been developed such as ecdis electronic chart display and information system arpa automatic radar plotting aid ais automatic identification system these provide effective support for maritime navigation and significantly contribute to the development of e navigation concept that is meant for further facilitation of navigational tasks on board ships basker 2005 weintrit et al 2007 the main principle of operation of the systems lies in its user friendliness and transparency of obtained navigation information the arpa system calculates parameters such as the closest point of approach cpa and time to the closest point of approach tcpa and includes software necessary to carry out a trial manoeuvre for a single target or group of targets bole et al 2014 wawruch 2008 despite unquestionable advantages arpa does not solve some issues related to the navigation first arpa does not propose nor seeks for an anti collision manoeuvre or a manoeuvre which is safe for a sufficiently long period second arpa is not able to estimate a potential collision hazard caused by other ships targets once they change their courses third it is not capable of establishing a ship domain i e an area the navigator would like to or rather should keep free from other objects to ensure safe passage on the other hand the literature on the subject offers a range of solutions for anti collision systems other than arpa where some of the above mentioned issues are addressed for example novel collision avoidance concepts algorithms and systems are proposed utilizing various concepts as criterion delineating safe and unsafe ship ship encounter to this end a notion of cpa tcpa is commonly used bukhari et al 2013 chin and debnath 2009 also a concept of ship domains and time to domain violation is adopted as presented in pietrzykowski et al 2012 pietrzykowski and uriasz 2009 szłapczyński and szłapczyńska 2016 wang 2010 wang et al 2013 also experts knowledge is utilized to label the safety level of encounters goerlandt et al 2015 perera et al 2015 rhee and lee 1996 and ship manoeuvrability is accounted for to determine the minimum manoeuvring area for the own ship to escape form the collision encounter with own manoeuvres only baldauf et al 2011 krata and montewka 2015 łukaszewicz 2007 rutkowski 2016 2009 tam and bucknall 2010 wang et al 2017 zhang et al 2012 subsequently some of those solutions are adopted in safe path planning algorithms accounting for collision avoidance see krata and szlapczynska 2018 lisowski 2014 perera et al 2015 pietrzykowski et al 2017 szłapczyński 2011 2005 szłapczyński and śmierzchalski 2009 tam and bucknall 2013 tsou et al 2010 occasionally appropriate technological readiness level is achieved for a system to be made operational pietrzykowski et al 2017 the majority of those solutions offer binary answers namely the given encounter is labelled as safe or unsafe pietrzykowski et al 2017 some solutions though offers several level of safety for an encounter goerlandt et al 2015 however the logic hidden behind the system is not straightforward pietrzykowski et al 2017 2012 and often too complex to grasp by the end user zhang et al 2015 in order to solve the collision avoidance task the navigator needs a reliable and easy to read and understand system which seems to be missing at present lenart 2015 schröder hinrichs et al 2011 therefore this paper presents a concept of a system called marpa which refers to multi target arpa that determines for a given traffic situation as follows 1 the sectors around own ship that offer wide safety margin 2 the sectors that offers safe margin however caution is required 3 the sectors which should be avoided the tool is based on arpa calculations and heuristics adopted to determine the safety level for a given encounter the heuristics applied browse all possible courses and selected own ship velocity ranges with a well known assumption rooted in arpa that the motion parameters of targets are constant the obtained results are visualized in a simplified manner where a traffic light symbolism is used however binary representation of the results is possible as well safe unsafe sectors the paper comprises four chapters the introduction and the summary chapter 2 presents the concept and main assumptions of the marpa system chapter 3 introduces a model that drives marpa the case studies and results obtained are given in chapter 4 whereas the system is discussed in chapter 5 section 6 concludes 2 methods the main task of the marpa system is two fold first to provide information on safe courses in collision situation second to provide a navigator anticipating a turn with synthetic information on permissible courses on which an own ship will not create a collision situation in relation to other objects when analysing a one to one encounter situation an anti collision manoeuvre is usually executed without any difficulty however when there are more targets around the own ship an evasive manoeuvre with regard to one of those may create a collision situation to another therefore marpa provides the navigator with information on courses which will result in one of the following predefined situations no hazard minor hazards real hazard and collision however the binary classification of the courses safe unsafe can be used as well this chapter presents the concept assumptions and principle of operation and design of the anticipated marpa system 2 1 definitions and assumptions navigation hazards involving a possible collision with another object can be divided into two groups 1 direct hazard dh is a target moving with course and speed resulting in cpa below adopted threshold that if no action is taken to avoid the target the risk of a collision will develop in the course of encounter within the available time until the closest point of approach tcpa dh is determined based in the values of cpa and tcpa that are calculated by arpa for all targets in the observation range 2 indirect hazards indh a target not on collision course at the given moment but attributable a feasible set of courses and velocities for which it can turn into dh with respect to the own ship from the perspective of the own ship it is a range of relative bearings and velocities for which the target will embark on a collision course with the own ship at a given moment the own ship does not have to be necessarily in the dh condition but it may experience the indh condition which implies that the ship may end up in a collision situation any time due to course speed alterations of the target to calculate the marpa hazards the notion of class c is adopted the class is a function divided into the number of intervals n taking factors w as input which are measured for a specific task the class takes the following form 1 c 1 f o r w w 1 2 f o r w 1 w w 2 n f o r w n 1 w w n depending on the task marpa calculates parameters p marpa on the basis of calculated classes and sub classes as follows 2 p m a r p a f c 1 c 2 c k the parameters calculated in the above mentioned way are intended for visualisation within marpa system as presented in chapter 4 thus marpa is intended to be a navigational decision support tool capable of fulfilling the following tasks 1 provide an overview of navigational situation marpa visualises dhs for all courses of the own ship it serves as a system evaluating navigation safety at a specific moment and estimates safety of an anti collision manoeuvre by performing single course alteration collision evasive action 2 provide early warning marpa visualises indh it serves as a rapid alert system for indhs which may occur as a result of changes in parameters of target movements useful in convoys especially in the ice convoy inland waterways and other closed spaces when the typical distance between ships is short and the available time for response is very limited goerlandt et al 2017 zhang et al 2017 3 provide an advice in collision situation marpa is capable to determine a domain for the own ship this in turn may assist in planning safe collision avoidance manoeuver in terms of minimal distance from the target that should be kept for safe navigation in this article we focus on task 1 and direct hazards assessment and visualisation from the latter the indirect hazards can be derived task 2 however to complete task 3 namely to evaluate the ship domain mapra would require some additional features pertaining to ship manoeuvrability as discussed extensively in baldauf et al 2015 curtis 1986 krata and montewka 2015 krata and wawrzynski 2017 liu et al 2014 montewka and krata 2014 wawrzyński and krata 2016a 2016b zhang et al 2012 2017 2 2 high level concept of marpa marpa is anticipated as a separately functioning device based on the arpa which uses its solutions in an extended way or serves as an overlay for the arpa marpa modules fulfil the above tasks sending another data for calculations to arpa and browsing arpa calculations in an orderly manner and finally visualising obtained results with the use of an algorithm suitable for a specific task the flow chart of marpa is shown in fig 1 and explained below 1 input sensors gps ais radar hydro meteorological sensors e g anemometer that provides the executive module with relevant information on targets and environment 2 the executive module em collects data from the input sensors creates a package of data for further processing depending on the task sends the data packages to the calculating module of arpa and to the verification module of marpa 3 the calculating module of marpa cm calculates cpa and tcpa for all the targets it sends the data to the verification module of marpa 4 verification module of marpa vm depending on the task completed it processes data from the em and cm and sends packages of data for visualisation to the user panel 5 user panel up displays information from vm on the ship borne monitor the user can determine the visualisation criteria multi colour or two colour symbolism as well as threshold parameters for cpa and tcpa in the following section mathematical model driving the presented concept of marpa is described followed by principles of marpa system operation 3 a model for direct hazards 3 1 definition of classes a direct hazard dh is defined by two parameters tcpa and cpa if available the effect of hydro meteo conditions can be added as well depending on the availability of the latter two or three data packages are delivered to cm in order to calculate cpa and tcpa for a pair of objects as follows 3 c p a i f 1 φ i λ i v i c o g i φ 0 λ 0 v o c o g 0 4 t c p a i f 2 φ i λ i v i c o g i φ 0 λ 0 v o c o g 0 5 z c w s where φ i λ i a geographical position of the ith target defined by the latitude φ and longitude λ v i velocity of the ith target cog i course over ground of the ith target ship φ 0 λ 0 geographical position of the own ship v 0 a velocity of the own ship cog 0 course of the ground of the own ship z c w s denotes a function determining the influence of current wind and sea parameters on the own ship movement obviously only one of the two components either cpa or tcpa is not decisive for the degree of the collision hazard if for example cpa 0 05 nm but tcpa 1 h the risk of a collision is negligible since there is sufficient time to make decision and execute an anti collision manoeuvre only with simultaneous consideration of cpa and tcpa it is possible to determine the degree of hazard for a given encounter to this end the classes of cpa and tcpa need to be specified and further combined 3 1 1 cpa classes a cpa class cpac is a natural number describing the level of hazard for a given encounter due to proximity of two encountering ships it is defined as follows 6 cpac 1 i f c p a c p a 0 2 i f c p a 0 c p a c p a 1 3 i f c p a 1 c p a c p a 2 n 1 i f c p a n 1 c p a c p a n n i f c p a n c p a where n denotes a number of classes for the purpose of this paper four classes are adopted and defined as follows 1 cpac 1 no hazard applied cpa 1nm hilgert and baldauf 1997 2 cpac 2 minor hazard 1nm cpa 0 5 nm no direct hazard of collision large margin for unexpected manoeuvre of a target leading to collision encounter goerlandt et al 2015 3 cpac 3 real hazard 0 5 nm cpa 0 2 nm potentially hazardous encounter due to small margin for unexpected manoeuvre of a target and significant influence of errors stemming from cpa calculations bole et al 2014 goerlandt et al 2015 4 cpac 4 a collision encounter 0 2 nm cpa such situation must be avoided for short distances between encountering ships small cpa and tcpa may be tantamount to collision baldauf et al 2015 krata and montewka 2015 szłapczyński and szłapczyńska 2017 the formula governing the cpac is as follows 7 cpac 1 i f c p a 1 n m 2 i f 1 n m c p a 0 5 n m 3 i f 0 5 n m c p a 0 2 n m 4 i f 0 2 n m c p a 3 1 2 tcpa classes a tcpa class tcpac describes the level of hazard for a given encounter due to available time for reaction to solve the situation between two encountering ships it is a natural number defined as follows 8 tcpac 1 i f t c p a t c p a 0 2 i f t c p a 0 t c p a t c p a 1 3 i f t c p a 1 t c p a t c p a 2 m 1 i f t c p a m 1 t c p a t c p a m m i f t c p a m t c p a where m stands for the number of tcpa classes for the purpose of this paper four classes are adopted and defined as follows 1 tcpac 1 no hazard tcpa 30 min there is enough time for evaluate plan and execute necessary collision avoidance manoeuver 2 tcpac 2 action initiation time 30 min tcpa 10min time during which either of ships own or target should carry out safe manoeuvre if necessary such manoeuvre should be comfortable and known to a navigator a manoeuver that has been performed often and should not comprise the safety of the ship or her cargo for the purpose of this paper it is called individual comfort limit manoeuver iclm the lower limit of tcpa for this class is the minimum time required to perform iclm hilgert and baldauf 1997 3 tcpac 3 the last call for action initiation 10min tcpa 2min in case of a real hazard the navigator must take a decision and execute a manoeuvre appropriate for a given situation however due to time limitation and ship manoeuvrability in certain encounters especially those requiring large course alteration damage to the ship and cargo can be expected since some parameters of the manoeuvre carried out by the navigator exceed the iclm parameters the lower limit of tcpa adopted here corresponds to the last chance manoeuvre lcm carried out using all measures available to avoid collision hard to side significant speed alteration full astern 4 tcpac 4 no time to react 2min t c p a was applied for the own design of marpa it is an interval at which an own ship is not able to avoid the risk of a collision with a target by executing the lcm however it does not exclude the possibility to avoid such a collision through cooperation of both sips the formula governing tcpac reads as follows 9 tcpac 1 i f t c p a 30 m i n 2 i f 30 m i n t c p a 10 m i n 3 i f 10 m i n t c p a 20 m i n 4 i f 2 m i n t c p a the above cpac and tcpac ranges are exemplary each of the intervals has to be considered individually for a given type of an own ship and target movement parameters loading status and navigator s experience 3 2 definition of the degree of navigation hazard subsequently these two classes are inputted into a function that yields the degree of navigation hazard dnh as follows 10 d n h i f c p a c i t c p a c i where dnh i a degree of navigation hazard with respect to the ith target the logic behind dnh is given in the following section the degree of navigation hazard dnh consists of two components cpac and tcpac as shown in eq 10 the sample f function describing the dnh is presented in table 1 while hazard degrees are defined as follows 1 dnh 1 lack of collision hazard or hazard that is enough distant in time that does not need to be taken into account in the current situation 2 dnh 2 remote collision hazard not significant at the moment however a possible manoeuvre may be required if targets falling in this category are on the actual or planned course of the own ship 3 dnh 3 close collision hazard if the own ship s course falls into this zone determined actions should be taken in order to avoid the collision situation that arises targets in this zone can be expected to infridge the own ship s domain however there is still time to perform collision evasive manoeuvers that are comfortable for the navigator and safe for the ship crew and cargo also there is time to correct the evasive manoeuver if necessary the lower boundary of this zone can be represented by a ship s domain which navigator wants to keep free from other targets mainly due to his nautical preferences 4 dnh 4 very close collision hazard within this zone a tiny safety margin for any error exists moreover there is no time to hesitate to perform collision evasive action and the time available for collision evasive manoeuvres is very short the envelope of this zone is defined by the own ship manoeuvrability only assuming the collision can be avoided by the own manoeuvres alone the upper boundary of the zone can be interpreted as a minimum manoeuvring area for the own ship where the moderate rudder angle are applied thus the manoeuvres taken are still safe for ship cargo and passengers the lower boundary of the zone corresponds to an area that is required to perform the last chance manoeuver which may compromise the safety of the cargo passengers or even ship due to large roll angles and even imminent danger of ship capsizing maib 2016 therefore navigators should as far as possible avoid entering the dnh 4 zone furthermore each course alteration by a target in the dnh4 zone implies additional indirect hazards which may lead directly to a collision or cause entering into the dnh5 zone 5 dnh 5 collision imminent once the own ship gets into this zone collision cannot be avoided by own manoeuvres alone thus this is a prohibited zone the navigator must not allow the ship to set a course falling therein 3 3 principles of mapra operation 3 3 1 process of dnh evaluation and visualisation to evaluate dnh online marpa performs the following tasks 1 the executive module em collects data of targets in questions from gps ais radar hydro meteorological sensors if available such as ships positions φ i λ i their velocity v i courses c o g i for objects i 0 1 2 3 n and hydro meteorological parameters as a ship velocity function depending on the wind current vector forces and sea z p w m the target labelled with i 0 is an own ship subsequent numbers are attributed to the targets also the data can be inputted to the user panel item 11 and sent to em 2 the em creates packages of data for objects pd where p d i φ i λ i v i c o g i i 0 1 2 n 3 the em creates packages of data of an own ship for all possible turn angles p d 0 k and the z p w m package 4 the em sends the following packages to cm and vm p d i φ i λ i v i c o g i i 1 2 n and p d 0 k φ 0 λ 0 v 0 k z p w m k 0 1 2 359 5 the cm collects data from the em for each received p d i then calculates c p a p d 0 k p d i and t c p a p d 0 k p d i for i 1 2 3 n and k 0 1 2 359 6 the cm sends all calculated c p a p d 0 k p d i and t c p a p d 0 k p d i to the vm 7 the vm collects data from the cm determines all d n h i k where k a course of an own ship i another target in question 8 the vm compares all d n g i k on a given course of the own ship and selects the highest value d n h m a x k max d n h i k for i 1 2 3 n and k 0 1 2 359 the result of d n h m a x k shows a hazard for the own ship of a specific velocity on a given course 9 the vm assigns a numerical value or colour to each own ship course depending on the d n h m a x k value the following colour code for multi colour visualisation is applied 11 f k k b l u e i f d n h m a x k 1 g r e e n i f d n h m a x k 2 y e l l o w i f d n h m a x k 3 o r a n g e i f d n h m a x k 4 r e d i f d n h m a x k 5 sample two colour visualisation 12 f k k b l u e i f d n h m a x k 4 r e d i f d n h m a x k 4 13 or f l k d n h m a x k where f k colour visualisation f l numerical visualisation 10 the vm sends a graphic visualisation command to the display in the user panel up to fill in the sectors with colour code for a range of the own ship courses 11 the monitor on the up visualises dhs the flow chart of marpa calculating a dh is shown in fig 2 a legend for the proposed colour code describing the direct hazards is given in table 2 3 3 2 influence of hydro meteo conditions on dh classification hydro meteorological conditions affect the motion parameters of a ship both her speed and rate of turn these in turn influence the cpa and tcpa of the targets finally the degree of navigational hazards are affected this effect can be accounted for in numerous way however solution adopted here is simplified however enough for the purpose of the idea demonstration when large course alteration is anticipated significant change of the velocity can be expected this can be further decreased by unfavourable wave and wind conditions however this reduction can not be know to the marpa in advance since the speed data are sent for a given time instance and the dnh is determined based on this data however this may change with the change of the speed and green sector can turn yellow or yellow can turn red as the manoeuver continuous and ships drops her speed to avoid such situation and to evaluate the effect of speed changes on the degree of navigational hazards beforehand which determines safe and non safe sectors the speed of the own ship is defined as an interval rather than single value the upper value corresponds to speed before manoeuver and the lower boundary describes the speed at the course alteration completion v m and the speed drop step δv is taken as 0 1 knot depending on the hydro meteo conditions the values for lower boundary will change as well as the speed drop step this can be evaluated empirically with the use of ship motion model or based on full scale data obtained in the course of ship operations however the same principle can be used in mapra if the navigator intends to change the speed during the maneuver very often navigators are considering course alteration as collision avoidance manoeuver since it is easier nad faster to change this parameter that ship speed due to ship inertia however in the case of relatively light and highly manouverable ships speed alteration is possible as well and can be an additional mapra option as a result a set k of manoeuvres is obtained including directions k meeting the following relation 14 k k λ v 0 v m δ v d n h k v m δ v d n h m i n in case k ø all the directions that fall within the set k form a set of acceptable manoeuvres in fig 3 a sample set of manoeuvres for the own ship are shown which is a set of k comprised of courses resulting in d n h m i n 2 for crossing the traffic flow of ships steaming on the opposite courses 4 results the proposed concept of marpa is tested using two most frequent traffic scenarios 1 the navigator intends to change the course in the presence of heavy traffic involving ships of different movement parameters a frequent situation e g when leaving the separation zone and altering the course 2 several targets are in direct proximity to the own ship and the navigator is obliged to yield 4 1 scenario1 in fig 4 the anticipated situation as seen on the own ship s radar where the own ship intends to alter her course to cross the main traffic flow comprised of ships steaming in the opposite direction the marpa visualisation shown indicates dhs for all potential courses of the own ship including a set of courses the own ship intends to make a turn to one of these courses as indicated in the figure there is a number of sectors attributed by dnh level where all but red are allowed however navigation within yellow sectors dh 3 requires collision avoidance actions but the time available is sufficient whereas upon entering orange sectors dh 4 the own ship has small amount of time to perform avoidance manoeuver with respect to those targets the same situation can also be visualized with the use of two colour code as depicted in fig 5 therein the situations are divided into safe dh 2 and doubtful dh 2 elimination of doubtful solutions i e all courses of a ship for which dnh 2 at which the probability of a collision movement results at most from indirect hazards provides clear information on course alteration opportunities 4 2 scenario 2 in fig 6 the own ship navigates in the area that is trafficked with several targets moving at different speed in different directions a target alters her course developing thus the risk of collision in this encounter the own ship becomes a give a way sip according to convention on the international regulations for preventing collisions at sea colreg imo 2003 the sample visualisation of marpa results is presented in figs 6 and 7 where multi colour and two colour codes are applied respectively therein navigator is able to clearly determine sectors of new courses to avoid a collision 5 discussion 5 1 interpretation of results depending on the algorithm applied in the cm and sensors connected to marpa on board the own ship the anticipated variation of the own ship speed and heading in the course of collision avoidance action may be accounted for along with the effect of hydro meteorological conditions the modern arpa devices are able to account for the speed and course variations due to performed manoeuver however if the effect of wave action on ship forward speed and rate of turn is not estimated then the results obtained from marpa need proper interpretation for marpa not evaluating neither the effect of collision avoidance manoeuver nor the wave action the effect of those will increase with the dnh the lower dnhs dnh 2 the smaller effect on it will be caused by the variation of the own ship speed and heading however for higher dnhs dnh 2 those effects may be more prominent especially for the courses falling close to the sectors boundary therefore it is advisable to avoid such courses and choose courses that fall in the middle of a sector for marpa that accounts for the effect of own ship movement parameters changes in the course of collision avoidance manoeuver however lacks the influence of wave the similar effect can be expected as above first the effect of wave action will depend on ship size type and stability conditions second the direction and height of wave may determine the magnitude of course alteration therefore it is advisable to steer on courses that fall in the middle of the sectors labelled with higher dnh dnh 2 for marpa accounting for both effects the own ship will end up within the dnh zone as visualized at the stage of manoeuver planning 5 2 marpa limitations there are several major limitations that the proposed marpa features at this stage these are listed below along with suggested ways of addressing them 1 discretisation of the marpa mathematics model algorithm develops a small error which may affect the dnh for a certain set of angles falling between two discrete angles this can be reduced by finer discretisation preferably adjusted to the attainable level of ship course keeping e g up to 0 5 2 lack of a module evaluating the effect of hydro meteorological conditions on dnh this feature is not so critical for large and deep ships however this is not the case for smaller vessels it can be solved by implementing appropriate algorithms into the mathematical model of marpa 3 lack visualisation that could be used on a continuous basis colouring the whole display is not convenient for a user mainly due to the great quantity of overlapping data however verification of available navigation possibilities at a given moment is a sufficient aid for navigation operations 4 lack of indirect hazards consideration by the presented concept of marpa by not considering this we assume that each target will follow its heading and speed in the course of encounter this is an idealistic assumption and can be addressed by adding the effect of potential changes that may occur during the encounter on the dnh 5 mapra does not account for complex manoeuver where several course alterations and or speed changes are involved to address this issue substantial upgrade of the marpa mathematical model is needed which is beyond the scope of this research 5 3 directions for further research improvement of algorithms by introducing dynamic data from ais to determine dnh moreover consideration of the influence of hydro meteorological conditions for a given ship in marpa it could be either an algorithm based on ship trajectory and its parameters to estimate accurately dhs or simpler model as presented in section 3 3 2 consideration of the optimal visualisation method the two colour method has been initially adopted as a working method since there are no clear radar visualisation solutions for the multi colour method the following could be considered to visualize high risk sectors in red 15 f k k b l u e i f d n h m a x k 4 r e d i f d n h m a x k 4 the following could be used to visualize only safe manoeuvres dnh 3 considering all others as unsafe 16 f k k b l u e i f d n h m a x k 3 r e d i f d n h m a x k 3 consideration of proper marpa operation training some manoeuvres are executed in a short time in stressful situations one should remember that marpa is only a supporting tool it should be used to demonstrate potential capabilities in the first stage of making decisions to change a course however a watch officer is responsible for verification and making a final decision reckless use of marpa without considering its limits as for any other device may lead to hazardous situations another proposition is to use marpa for final verification of previous calculations of the course change however marpa does not account for complex manoeuvres more than one course alteration the area around the own ship that the navigator should keep clear of the other vessels while on the collision course depends on numerous factors both internal and external one of the main directions of work on marpa will be to determine such area a k a ship domain based on own ship manoeuvering characteristics and type of encounter 6 conclusions in this paper we present a concept of the prospective marpa system and provides preliminary results obtained from the two case studies the main objective of the marpa system is to provide a navigator with clear information concerning safe navigation operations on all possible courses at a given moment for given movement parameters of targets and the own ship the potential of the marpa system as a comprehensive navigation aid cannot be overestimated visualisation of even one of marpa operating tasks on radar or ecdis provides essential information to facilitate ship navigation the article describes one potential area of application of the marpa system namely evaluation of encounters with respect to direct hazards as illustrated with the examples marpa can serve as a very useful navigation aid both for browsing and checking solutions before making a navigation decision marpa can provide navigator with more time for execution of collision evasive action by offering him her solutions based on clear and well understood criteria for weighting ship ship encounter marpa provides solution with respect to all targets ensuring no target is omitted in order to use the marpa system on a ship in an effective way efforts should be focused on limiting errors resulting from determination of movement parameters of own ship under different hydro meteorological conditions such error could be eliminated by adopting proper algorithms evaluating effect of wave action on the own ship movement or through proper interpretation of results as described in section 5 1 in such case interpretation of the results must be simple and unambiguous for the navigator who uses the marpa system the future work should focus on implementation of indirect hazards into the system providing a link between marpa and ship domain as well as accounting for the effect of hydro meteorological conditions on ship behaviour while performing collision evasive action acknowledgment second author appreciates the financial contributions from polish ministry of science and higher education grant number ds 442 2017 duration 2017 2019 the views expressed remain solely those of the authors 
23360,sea traffic growing from year to year contributes significantly to increase of dangerous ship ship encounters which if not handled properly may result in an accident the existing anti collision systems installed on ships improve navigation safety significantly however navigation decision support systems solving complex encounter situations providing navigator with simple but reliable information are still at the development stage therefore this paper shows the concept of the multi arpa marpa system along with case studies the system is intended to deliver to a navigator on board ship information on safe headings while encountering other ships the safe headings are determined based on the level of hazard that other ships create or will create once the heading of the own ship is altered the system may evaluate and visualize safe heading adopting multi level or binary classification the presented system operates on the basis of an algorithm designating direct hazards for the own ship for the set of manoeuvres in an encounter situation for numerous ships keywords arpa marpa anti collision manoeuvre individual comfort limit manoeuvre last chance manoeuvre main abbreviations and symbols arpa automatic radar plotting aid ais automatic identification system c classes mathematical function cm the calculating module of arpa colreg the international regulations for preventing collisions at sea cpa closest point of approach cpac closest point of approach class dh direct hazards dnh the degree of navigation hazard ecdis electronic chart display and information system em the executive module gps global positioning system indh indirect hazards iclm individual comfort limit manoeuver lcm last chance manoeuver marpa multi arpa pd packages of data for objects pmarpa parameter calculated by marpa tcpa time to closest point of approach tcpac time to closest point of approach class up user panel vm verification module of marpa 1 introduction sea traffic growing from year to year created a new challenge for navigators and traffic engineering denser traffic creates complex encounters between ships that may turn into an accident if not solved properly in time and space to this end numerous navigational systems have been developed such as ecdis electronic chart display and information system arpa automatic radar plotting aid ais automatic identification system these provide effective support for maritime navigation and significantly contribute to the development of e navigation concept that is meant for further facilitation of navigational tasks on board ships basker 2005 weintrit et al 2007 the main principle of operation of the systems lies in its user friendliness and transparency of obtained navigation information the arpa system calculates parameters such as the closest point of approach cpa and time to the closest point of approach tcpa and includes software necessary to carry out a trial manoeuvre for a single target or group of targets bole et al 2014 wawruch 2008 despite unquestionable advantages arpa does not solve some issues related to the navigation first arpa does not propose nor seeks for an anti collision manoeuvre or a manoeuvre which is safe for a sufficiently long period second arpa is not able to estimate a potential collision hazard caused by other ships targets once they change their courses third it is not capable of establishing a ship domain i e an area the navigator would like to or rather should keep free from other objects to ensure safe passage on the other hand the literature on the subject offers a range of solutions for anti collision systems other than arpa where some of the above mentioned issues are addressed for example novel collision avoidance concepts algorithms and systems are proposed utilizing various concepts as criterion delineating safe and unsafe ship ship encounter to this end a notion of cpa tcpa is commonly used bukhari et al 2013 chin and debnath 2009 also a concept of ship domains and time to domain violation is adopted as presented in pietrzykowski et al 2012 pietrzykowski and uriasz 2009 szłapczyński and szłapczyńska 2016 wang 2010 wang et al 2013 also experts knowledge is utilized to label the safety level of encounters goerlandt et al 2015 perera et al 2015 rhee and lee 1996 and ship manoeuvrability is accounted for to determine the minimum manoeuvring area for the own ship to escape form the collision encounter with own manoeuvres only baldauf et al 2011 krata and montewka 2015 łukaszewicz 2007 rutkowski 2016 2009 tam and bucknall 2010 wang et al 2017 zhang et al 2012 subsequently some of those solutions are adopted in safe path planning algorithms accounting for collision avoidance see krata and szlapczynska 2018 lisowski 2014 perera et al 2015 pietrzykowski et al 2017 szłapczyński 2011 2005 szłapczyński and śmierzchalski 2009 tam and bucknall 2013 tsou et al 2010 occasionally appropriate technological readiness level is achieved for a system to be made operational pietrzykowski et al 2017 the majority of those solutions offer binary answers namely the given encounter is labelled as safe or unsafe pietrzykowski et al 2017 some solutions though offers several level of safety for an encounter goerlandt et al 2015 however the logic hidden behind the system is not straightforward pietrzykowski et al 2017 2012 and often too complex to grasp by the end user zhang et al 2015 in order to solve the collision avoidance task the navigator needs a reliable and easy to read and understand system which seems to be missing at present lenart 2015 schröder hinrichs et al 2011 therefore this paper presents a concept of a system called marpa which refers to multi target arpa that determines for a given traffic situation as follows 1 the sectors around own ship that offer wide safety margin 2 the sectors that offers safe margin however caution is required 3 the sectors which should be avoided the tool is based on arpa calculations and heuristics adopted to determine the safety level for a given encounter the heuristics applied browse all possible courses and selected own ship velocity ranges with a well known assumption rooted in arpa that the motion parameters of targets are constant the obtained results are visualized in a simplified manner where a traffic light symbolism is used however binary representation of the results is possible as well safe unsafe sectors the paper comprises four chapters the introduction and the summary chapter 2 presents the concept and main assumptions of the marpa system chapter 3 introduces a model that drives marpa the case studies and results obtained are given in chapter 4 whereas the system is discussed in chapter 5 section 6 concludes 2 methods the main task of the marpa system is two fold first to provide information on safe courses in collision situation second to provide a navigator anticipating a turn with synthetic information on permissible courses on which an own ship will not create a collision situation in relation to other objects when analysing a one to one encounter situation an anti collision manoeuvre is usually executed without any difficulty however when there are more targets around the own ship an evasive manoeuvre with regard to one of those may create a collision situation to another therefore marpa provides the navigator with information on courses which will result in one of the following predefined situations no hazard minor hazards real hazard and collision however the binary classification of the courses safe unsafe can be used as well this chapter presents the concept assumptions and principle of operation and design of the anticipated marpa system 2 1 definitions and assumptions navigation hazards involving a possible collision with another object can be divided into two groups 1 direct hazard dh is a target moving with course and speed resulting in cpa below adopted threshold that if no action is taken to avoid the target the risk of a collision will develop in the course of encounter within the available time until the closest point of approach tcpa dh is determined based in the values of cpa and tcpa that are calculated by arpa for all targets in the observation range 2 indirect hazards indh a target not on collision course at the given moment but attributable a feasible set of courses and velocities for which it can turn into dh with respect to the own ship from the perspective of the own ship it is a range of relative bearings and velocities for which the target will embark on a collision course with the own ship at a given moment the own ship does not have to be necessarily in the dh condition but it may experience the indh condition which implies that the ship may end up in a collision situation any time due to course speed alterations of the target to calculate the marpa hazards the notion of class c is adopted the class is a function divided into the number of intervals n taking factors w as input which are measured for a specific task the class takes the following form 1 c 1 f o r w w 1 2 f o r w 1 w w 2 n f o r w n 1 w w n depending on the task marpa calculates parameters p marpa on the basis of calculated classes and sub classes as follows 2 p m a r p a f c 1 c 2 c k the parameters calculated in the above mentioned way are intended for visualisation within marpa system as presented in chapter 4 thus marpa is intended to be a navigational decision support tool capable of fulfilling the following tasks 1 provide an overview of navigational situation marpa visualises dhs for all courses of the own ship it serves as a system evaluating navigation safety at a specific moment and estimates safety of an anti collision manoeuvre by performing single course alteration collision evasive action 2 provide early warning marpa visualises indh it serves as a rapid alert system for indhs which may occur as a result of changes in parameters of target movements useful in convoys especially in the ice convoy inland waterways and other closed spaces when the typical distance between ships is short and the available time for response is very limited goerlandt et al 2017 zhang et al 2017 3 provide an advice in collision situation marpa is capable to determine a domain for the own ship this in turn may assist in planning safe collision avoidance manoeuver in terms of minimal distance from the target that should be kept for safe navigation in this article we focus on task 1 and direct hazards assessment and visualisation from the latter the indirect hazards can be derived task 2 however to complete task 3 namely to evaluate the ship domain mapra would require some additional features pertaining to ship manoeuvrability as discussed extensively in baldauf et al 2015 curtis 1986 krata and montewka 2015 krata and wawrzynski 2017 liu et al 2014 montewka and krata 2014 wawrzyński and krata 2016a 2016b zhang et al 2012 2017 2 2 high level concept of marpa marpa is anticipated as a separately functioning device based on the arpa which uses its solutions in an extended way or serves as an overlay for the arpa marpa modules fulfil the above tasks sending another data for calculations to arpa and browsing arpa calculations in an orderly manner and finally visualising obtained results with the use of an algorithm suitable for a specific task the flow chart of marpa is shown in fig 1 and explained below 1 input sensors gps ais radar hydro meteorological sensors e g anemometer that provides the executive module with relevant information on targets and environment 2 the executive module em collects data from the input sensors creates a package of data for further processing depending on the task sends the data packages to the calculating module of arpa and to the verification module of marpa 3 the calculating module of marpa cm calculates cpa and tcpa for all the targets it sends the data to the verification module of marpa 4 verification module of marpa vm depending on the task completed it processes data from the em and cm and sends packages of data for visualisation to the user panel 5 user panel up displays information from vm on the ship borne monitor the user can determine the visualisation criteria multi colour or two colour symbolism as well as threshold parameters for cpa and tcpa in the following section mathematical model driving the presented concept of marpa is described followed by principles of marpa system operation 3 a model for direct hazards 3 1 definition of classes a direct hazard dh is defined by two parameters tcpa and cpa if available the effect of hydro meteo conditions can be added as well depending on the availability of the latter two or three data packages are delivered to cm in order to calculate cpa and tcpa for a pair of objects as follows 3 c p a i f 1 φ i λ i v i c o g i φ 0 λ 0 v o c o g 0 4 t c p a i f 2 φ i λ i v i c o g i φ 0 λ 0 v o c o g 0 5 z c w s where φ i λ i a geographical position of the ith target defined by the latitude φ and longitude λ v i velocity of the ith target cog i course over ground of the ith target ship φ 0 λ 0 geographical position of the own ship v 0 a velocity of the own ship cog 0 course of the ground of the own ship z c w s denotes a function determining the influence of current wind and sea parameters on the own ship movement obviously only one of the two components either cpa or tcpa is not decisive for the degree of the collision hazard if for example cpa 0 05 nm but tcpa 1 h the risk of a collision is negligible since there is sufficient time to make decision and execute an anti collision manoeuvre only with simultaneous consideration of cpa and tcpa it is possible to determine the degree of hazard for a given encounter to this end the classes of cpa and tcpa need to be specified and further combined 3 1 1 cpa classes a cpa class cpac is a natural number describing the level of hazard for a given encounter due to proximity of two encountering ships it is defined as follows 6 cpac 1 i f c p a c p a 0 2 i f c p a 0 c p a c p a 1 3 i f c p a 1 c p a c p a 2 n 1 i f c p a n 1 c p a c p a n n i f c p a n c p a where n denotes a number of classes for the purpose of this paper four classes are adopted and defined as follows 1 cpac 1 no hazard applied cpa 1nm hilgert and baldauf 1997 2 cpac 2 minor hazard 1nm cpa 0 5 nm no direct hazard of collision large margin for unexpected manoeuvre of a target leading to collision encounter goerlandt et al 2015 3 cpac 3 real hazard 0 5 nm cpa 0 2 nm potentially hazardous encounter due to small margin for unexpected manoeuvre of a target and significant influence of errors stemming from cpa calculations bole et al 2014 goerlandt et al 2015 4 cpac 4 a collision encounter 0 2 nm cpa such situation must be avoided for short distances between encountering ships small cpa and tcpa may be tantamount to collision baldauf et al 2015 krata and montewka 2015 szłapczyński and szłapczyńska 2017 the formula governing the cpac is as follows 7 cpac 1 i f c p a 1 n m 2 i f 1 n m c p a 0 5 n m 3 i f 0 5 n m c p a 0 2 n m 4 i f 0 2 n m c p a 3 1 2 tcpa classes a tcpa class tcpac describes the level of hazard for a given encounter due to available time for reaction to solve the situation between two encountering ships it is a natural number defined as follows 8 tcpac 1 i f t c p a t c p a 0 2 i f t c p a 0 t c p a t c p a 1 3 i f t c p a 1 t c p a t c p a 2 m 1 i f t c p a m 1 t c p a t c p a m m i f t c p a m t c p a where m stands for the number of tcpa classes for the purpose of this paper four classes are adopted and defined as follows 1 tcpac 1 no hazard tcpa 30 min there is enough time for evaluate plan and execute necessary collision avoidance manoeuver 2 tcpac 2 action initiation time 30 min tcpa 10min time during which either of ships own or target should carry out safe manoeuvre if necessary such manoeuvre should be comfortable and known to a navigator a manoeuver that has been performed often and should not comprise the safety of the ship or her cargo for the purpose of this paper it is called individual comfort limit manoeuver iclm the lower limit of tcpa for this class is the minimum time required to perform iclm hilgert and baldauf 1997 3 tcpac 3 the last call for action initiation 10min tcpa 2min in case of a real hazard the navigator must take a decision and execute a manoeuvre appropriate for a given situation however due to time limitation and ship manoeuvrability in certain encounters especially those requiring large course alteration damage to the ship and cargo can be expected since some parameters of the manoeuvre carried out by the navigator exceed the iclm parameters the lower limit of tcpa adopted here corresponds to the last chance manoeuvre lcm carried out using all measures available to avoid collision hard to side significant speed alteration full astern 4 tcpac 4 no time to react 2min t c p a was applied for the own design of marpa it is an interval at which an own ship is not able to avoid the risk of a collision with a target by executing the lcm however it does not exclude the possibility to avoid such a collision through cooperation of both sips the formula governing tcpac reads as follows 9 tcpac 1 i f t c p a 30 m i n 2 i f 30 m i n t c p a 10 m i n 3 i f 10 m i n t c p a 20 m i n 4 i f 2 m i n t c p a the above cpac and tcpac ranges are exemplary each of the intervals has to be considered individually for a given type of an own ship and target movement parameters loading status and navigator s experience 3 2 definition of the degree of navigation hazard subsequently these two classes are inputted into a function that yields the degree of navigation hazard dnh as follows 10 d n h i f c p a c i t c p a c i where dnh i a degree of navigation hazard with respect to the ith target the logic behind dnh is given in the following section the degree of navigation hazard dnh consists of two components cpac and tcpac as shown in eq 10 the sample f function describing the dnh is presented in table 1 while hazard degrees are defined as follows 1 dnh 1 lack of collision hazard or hazard that is enough distant in time that does not need to be taken into account in the current situation 2 dnh 2 remote collision hazard not significant at the moment however a possible manoeuvre may be required if targets falling in this category are on the actual or planned course of the own ship 3 dnh 3 close collision hazard if the own ship s course falls into this zone determined actions should be taken in order to avoid the collision situation that arises targets in this zone can be expected to infridge the own ship s domain however there is still time to perform collision evasive manoeuvers that are comfortable for the navigator and safe for the ship crew and cargo also there is time to correct the evasive manoeuver if necessary the lower boundary of this zone can be represented by a ship s domain which navigator wants to keep free from other targets mainly due to his nautical preferences 4 dnh 4 very close collision hazard within this zone a tiny safety margin for any error exists moreover there is no time to hesitate to perform collision evasive action and the time available for collision evasive manoeuvres is very short the envelope of this zone is defined by the own ship manoeuvrability only assuming the collision can be avoided by the own manoeuvres alone the upper boundary of the zone can be interpreted as a minimum manoeuvring area for the own ship where the moderate rudder angle are applied thus the manoeuvres taken are still safe for ship cargo and passengers the lower boundary of the zone corresponds to an area that is required to perform the last chance manoeuver which may compromise the safety of the cargo passengers or even ship due to large roll angles and even imminent danger of ship capsizing maib 2016 therefore navigators should as far as possible avoid entering the dnh 4 zone furthermore each course alteration by a target in the dnh4 zone implies additional indirect hazards which may lead directly to a collision or cause entering into the dnh5 zone 5 dnh 5 collision imminent once the own ship gets into this zone collision cannot be avoided by own manoeuvres alone thus this is a prohibited zone the navigator must not allow the ship to set a course falling therein 3 3 principles of mapra operation 3 3 1 process of dnh evaluation and visualisation to evaluate dnh online marpa performs the following tasks 1 the executive module em collects data of targets in questions from gps ais radar hydro meteorological sensors if available such as ships positions φ i λ i their velocity v i courses c o g i for objects i 0 1 2 3 n and hydro meteorological parameters as a ship velocity function depending on the wind current vector forces and sea z p w m the target labelled with i 0 is an own ship subsequent numbers are attributed to the targets also the data can be inputted to the user panel item 11 and sent to em 2 the em creates packages of data for objects pd where p d i φ i λ i v i c o g i i 0 1 2 n 3 the em creates packages of data of an own ship for all possible turn angles p d 0 k and the z p w m package 4 the em sends the following packages to cm and vm p d i φ i λ i v i c o g i i 1 2 n and p d 0 k φ 0 λ 0 v 0 k z p w m k 0 1 2 359 5 the cm collects data from the em for each received p d i then calculates c p a p d 0 k p d i and t c p a p d 0 k p d i for i 1 2 3 n and k 0 1 2 359 6 the cm sends all calculated c p a p d 0 k p d i and t c p a p d 0 k p d i to the vm 7 the vm collects data from the cm determines all d n h i k where k a course of an own ship i another target in question 8 the vm compares all d n g i k on a given course of the own ship and selects the highest value d n h m a x k max d n h i k for i 1 2 3 n and k 0 1 2 359 the result of d n h m a x k shows a hazard for the own ship of a specific velocity on a given course 9 the vm assigns a numerical value or colour to each own ship course depending on the d n h m a x k value the following colour code for multi colour visualisation is applied 11 f k k b l u e i f d n h m a x k 1 g r e e n i f d n h m a x k 2 y e l l o w i f d n h m a x k 3 o r a n g e i f d n h m a x k 4 r e d i f d n h m a x k 5 sample two colour visualisation 12 f k k b l u e i f d n h m a x k 4 r e d i f d n h m a x k 4 13 or f l k d n h m a x k where f k colour visualisation f l numerical visualisation 10 the vm sends a graphic visualisation command to the display in the user panel up to fill in the sectors with colour code for a range of the own ship courses 11 the monitor on the up visualises dhs the flow chart of marpa calculating a dh is shown in fig 2 a legend for the proposed colour code describing the direct hazards is given in table 2 3 3 2 influence of hydro meteo conditions on dh classification hydro meteorological conditions affect the motion parameters of a ship both her speed and rate of turn these in turn influence the cpa and tcpa of the targets finally the degree of navigational hazards are affected this effect can be accounted for in numerous way however solution adopted here is simplified however enough for the purpose of the idea demonstration when large course alteration is anticipated significant change of the velocity can be expected this can be further decreased by unfavourable wave and wind conditions however this reduction can not be know to the marpa in advance since the speed data are sent for a given time instance and the dnh is determined based on this data however this may change with the change of the speed and green sector can turn yellow or yellow can turn red as the manoeuver continuous and ships drops her speed to avoid such situation and to evaluate the effect of speed changes on the degree of navigational hazards beforehand which determines safe and non safe sectors the speed of the own ship is defined as an interval rather than single value the upper value corresponds to speed before manoeuver and the lower boundary describes the speed at the course alteration completion v m and the speed drop step δv is taken as 0 1 knot depending on the hydro meteo conditions the values for lower boundary will change as well as the speed drop step this can be evaluated empirically with the use of ship motion model or based on full scale data obtained in the course of ship operations however the same principle can be used in mapra if the navigator intends to change the speed during the maneuver very often navigators are considering course alteration as collision avoidance manoeuver since it is easier nad faster to change this parameter that ship speed due to ship inertia however in the case of relatively light and highly manouverable ships speed alteration is possible as well and can be an additional mapra option as a result a set k of manoeuvres is obtained including directions k meeting the following relation 14 k k λ v 0 v m δ v d n h k v m δ v d n h m i n in case k ø all the directions that fall within the set k form a set of acceptable manoeuvres in fig 3 a sample set of manoeuvres for the own ship are shown which is a set of k comprised of courses resulting in d n h m i n 2 for crossing the traffic flow of ships steaming on the opposite courses 4 results the proposed concept of marpa is tested using two most frequent traffic scenarios 1 the navigator intends to change the course in the presence of heavy traffic involving ships of different movement parameters a frequent situation e g when leaving the separation zone and altering the course 2 several targets are in direct proximity to the own ship and the navigator is obliged to yield 4 1 scenario1 in fig 4 the anticipated situation as seen on the own ship s radar where the own ship intends to alter her course to cross the main traffic flow comprised of ships steaming in the opposite direction the marpa visualisation shown indicates dhs for all potential courses of the own ship including a set of courses the own ship intends to make a turn to one of these courses as indicated in the figure there is a number of sectors attributed by dnh level where all but red are allowed however navigation within yellow sectors dh 3 requires collision avoidance actions but the time available is sufficient whereas upon entering orange sectors dh 4 the own ship has small amount of time to perform avoidance manoeuver with respect to those targets the same situation can also be visualized with the use of two colour code as depicted in fig 5 therein the situations are divided into safe dh 2 and doubtful dh 2 elimination of doubtful solutions i e all courses of a ship for which dnh 2 at which the probability of a collision movement results at most from indirect hazards provides clear information on course alteration opportunities 4 2 scenario 2 in fig 6 the own ship navigates in the area that is trafficked with several targets moving at different speed in different directions a target alters her course developing thus the risk of collision in this encounter the own ship becomes a give a way sip according to convention on the international regulations for preventing collisions at sea colreg imo 2003 the sample visualisation of marpa results is presented in figs 6 and 7 where multi colour and two colour codes are applied respectively therein navigator is able to clearly determine sectors of new courses to avoid a collision 5 discussion 5 1 interpretation of results depending on the algorithm applied in the cm and sensors connected to marpa on board the own ship the anticipated variation of the own ship speed and heading in the course of collision avoidance action may be accounted for along with the effect of hydro meteorological conditions the modern arpa devices are able to account for the speed and course variations due to performed manoeuver however if the effect of wave action on ship forward speed and rate of turn is not estimated then the results obtained from marpa need proper interpretation for marpa not evaluating neither the effect of collision avoidance manoeuver nor the wave action the effect of those will increase with the dnh the lower dnhs dnh 2 the smaller effect on it will be caused by the variation of the own ship speed and heading however for higher dnhs dnh 2 those effects may be more prominent especially for the courses falling close to the sectors boundary therefore it is advisable to avoid such courses and choose courses that fall in the middle of a sector for marpa that accounts for the effect of own ship movement parameters changes in the course of collision avoidance manoeuver however lacks the influence of wave the similar effect can be expected as above first the effect of wave action will depend on ship size type and stability conditions second the direction and height of wave may determine the magnitude of course alteration therefore it is advisable to steer on courses that fall in the middle of the sectors labelled with higher dnh dnh 2 for marpa accounting for both effects the own ship will end up within the dnh zone as visualized at the stage of manoeuver planning 5 2 marpa limitations there are several major limitations that the proposed marpa features at this stage these are listed below along with suggested ways of addressing them 1 discretisation of the marpa mathematics model algorithm develops a small error which may affect the dnh for a certain set of angles falling between two discrete angles this can be reduced by finer discretisation preferably adjusted to the attainable level of ship course keeping e g up to 0 5 2 lack of a module evaluating the effect of hydro meteorological conditions on dnh this feature is not so critical for large and deep ships however this is not the case for smaller vessels it can be solved by implementing appropriate algorithms into the mathematical model of marpa 3 lack visualisation that could be used on a continuous basis colouring the whole display is not convenient for a user mainly due to the great quantity of overlapping data however verification of available navigation possibilities at a given moment is a sufficient aid for navigation operations 4 lack of indirect hazards consideration by the presented concept of marpa by not considering this we assume that each target will follow its heading and speed in the course of encounter this is an idealistic assumption and can be addressed by adding the effect of potential changes that may occur during the encounter on the dnh 5 mapra does not account for complex manoeuver where several course alterations and or speed changes are involved to address this issue substantial upgrade of the marpa mathematical model is needed which is beyond the scope of this research 5 3 directions for further research improvement of algorithms by introducing dynamic data from ais to determine dnh moreover consideration of the influence of hydro meteorological conditions for a given ship in marpa it could be either an algorithm based on ship trajectory and its parameters to estimate accurately dhs or simpler model as presented in section 3 3 2 consideration of the optimal visualisation method the two colour method has been initially adopted as a working method since there are no clear radar visualisation solutions for the multi colour method the following could be considered to visualize high risk sectors in red 15 f k k b l u e i f d n h m a x k 4 r e d i f d n h m a x k 4 the following could be used to visualize only safe manoeuvres dnh 3 considering all others as unsafe 16 f k k b l u e i f d n h m a x k 3 r e d i f d n h m a x k 3 consideration of proper marpa operation training some manoeuvres are executed in a short time in stressful situations one should remember that marpa is only a supporting tool it should be used to demonstrate potential capabilities in the first stage of making decisions to change a course however a watch officer is responsible for verification and making a final decision reckless use of marpa without considering its limits as for any other device may lead to hazardous situations another proposition is to use marpa for final verification of previous calculations of the course change however marpa does not account for complex manoeuvres more than one course alteration the area around the own ship that the navigator should keep clear of the other vessels while on the collision course depends on numerous factors both internal and external one of the main directions of work on marpa will be to determine such area a k a ship domain based on own ship manoeuvering characteristics and type of encounter 6 conclusions in this paper we present a concept of the prospective marpa system and provides preliminary results obtained from the two case studies the main objective of the marpa system is to provide a navigator with clear information concerning safe navigation operations on all possible courses at a given moment for given movement parameters of targets and the own ship the potential of the marpa system as a comprehensive navigation aid cannot be overestimated visualisation of even one of marpa operating tasks on radar or ecdis provides essential information to facilitate ship navigation the article describes one potential area of application of the marpa system namely evaluation of encounters with respect to direct hazards as illustrated with the examples marpa can serve as a very useful navigation aid both for browsing and checking solutions before making a navigation decision marpa can provide navigator with more time for execution of collision evasive action by offering him her solutions based on clear and well understood criteria for weighting ship ship encounter marpa provides solution with respect to all targets ensuring no target is omitted in order to use the marpa system on a ship in an effective way efforts should be focused on limiting errors resulting from determination of movement parameters of own ship under different hydro meteorological conditions such error could be eliminated by adopting proper algorithms evaluating effect of wave action on the own ship movement or through proper interpretation of results as described in section 5 1 in such case interpretation of the results must be simple and unambiguous for the navigator who uses the marpa system the future work should focus on implementation of indirect hazards into the system providing a link between marpa and ship domain as well as accounting for the effect of hydro meteorological conditions on ship behaviour while performing collision evasive action acknowledgment second author appreciates the financial contributions from polish ministry of science and higher education grant number ds 442 2017 duration 2017 2019 the views expressed remain solely those of the authors 
23361,an underwater thermal glider is efficient when it takes a stable zigzag gliding in the vertical plane to increase its endurance improving the control and energy efficiency over the pitch angle adjustment is necessary firstly the working and control principle of the thermal glider is given and the mathematical motion model is built on this principle for a performance test secondly based on the tracking differentiator and active disturbance rejection control adrc theory a self searching optimal control method is proposed with this method the external disturbance can be compensated by adjusting the reference in advance which makes the required control signal optimized and small finally this method is used for the pitch keeping control of the glider during the descent and ascent or the posture transition control between the descent and ascent the results show that the control system has a good steady and dynamic performance under a simulated ocean current and noise disturbance as well as an adaptive effect the control signal to keep and track the trajectory is much smaller thus by assistantly adjusting the reference in advance this method takes much less energy to resist the disturbance than by only changing the control output and adjusting the actuator with the adrc or pid since the thermal glider carries a limited power saving energy means an increased endurance theory is a guide before practice this will have a great significance in the marine survey or military usage besides the control algorithm is also simple all these make it a better control strategy keywords tracking differentiator self searching optimal active disturbance rejection control pitch angle underwater thermal glider vertical plane control 1 introduction an underwater thermal glider is a kind of efficient buoyancy driven and autonomous underwater vehicle auv with wings it converts the ocean thermal energy into a propulsion power and has an important value in the marine survey and military detection the core component of the thermal glider is the thermal energy tubes which contain a working fluid of phase change material davis et al 2002 however the underwater thermal glider inherently has a low motion speed and highly dependents on its motion environment thus it faces a lot of problems when dealing with the complex marine environment for example how to have a robust performance how to save energy and how to improve its dynamics besides the glider dynamics have a multi variable nonlinear and coupled characteristic these factors pose a great challenge to the design of its motion control system mahmoudian 2009 owen et al 2015 at present many underwater thermal gliders still adopt a simple or promoted pid control to keep their posture herman 2009 alvarez et al 2009 sarhadi et al 2016a tanakitkorn et al 2017 this method is simple and effective in a certain range but it lacks an adaptability non linearity and intelligence for a better control effect the partial feedback linearization theory is used in the tracking control of the glider under uncertain disturbance repoulias and papadopoulos 2007 kim 2015 caharija et al 2016 miao et al 2017 however the linear control law of this method has a good control performance only near the equilibrium it is not suitable for the wide range motion of the glider thus a nonlinear method must be considered for its further control the neural network has a good nonlinearity the adaptive control method based on the neural network is utilized in many occasions such as the nonlinear multi input multi output motion control of the auv zhang et al 2009 peng et al 2015 shojaei 2016 cui et al 2017a however a learning process needs to completed before the neural network can be used besides its training method still has some inherent deficiencies the sliding mode control smc essentially is also a special nonlinear method its non linearity is reflected in the discontinuity of its control it can purposefully change based on the current system state which forces the system to move according to the state trajectory of the sliding mode the sliding mode can be designed and independent of the object parameter or disturbance because of this advantage the smc is also widely used in the motion control of the glider guo et al 2003 cui et al 2016 valeriano et al 2016 elmokadem et al 2017 however the differential geometry theory of its regularization process is very abstract and its coordinate transformation process is also complicated the backstepping method does not need a complex coordinate transformation its process is simple and the physical meaning is also clear thus the backstepping adaptive control is widely used in the glider motion control batista et al 2009 lapierre 2009 xiang et al 2015 li et al 2015 this method and its transformation are both constructive they are based on the lyapunov stability theory and satisfy the lyapunov convergence therefore the backstepping method shows a good adaptability and robustness under uncertain disturbance however the construct function sometimes is not easy to find in order to achieve a better control effect an integrated control approach that combines the advantages of various methods is used for example in 2016 zool et al proposed a smc and robust dynamic region based scheme for the robust control of an auv ismail et al 2016 in 2016 sarhadi et al combined a model reference adaptive control with an integral state feedback and modern anti windup compensator for the pitch and yaw channel control of the auv with actuator saturation sarhadi et al 2016b in 2016 kim et al presented an integral smc supplemented by an enhanced time delay controller for the auv position control under disturbance kim et al 2016 in 2017 rout et al developed a constrained self tuning controller for the heading and diving motion control of an auv with a moving average exogenous model extended recursive least square algorithm and sight guidance law rout and subudhi 2017 there are still some other methods that have been used in the motion control of the underwater glider such as the fuzzy control method xiang et al 2017 the robust control method qiao et al 2017 the model predict control method shi et al 2017 etc these methods all have achieved their control effect over the desired targets in their respective field however an overlook that many of the above methods share is that only the control effect is considered while further efforts on the optimization by minimizing the control energy are neglected during achieving the control effect thus in 2013 santhakumar et al developed a power efficient dynamic station keeping control of a flat fish type auv by modifying its thruster configuration santhakumar and asokan 2013 in 2016 sarkar et al addressed the energy and control accuracy issues with a novel controller of the smc and euler lagrange based classical optimal method sarkar et al 2016 in 2017 townsend proposed a self powered auv according to the principle of a gyroscopic energy prototype townsend 2016 it can be seen that some methods are in need to further modify the auv design the trade off research between the control and its energy is still rare and further study is needed therefore in order to promote the control and energy efficiency by further optimization this paper proposes a self searching optimal active disturbance rejection control adrc method for the pitch angle control of an underwater thermal glider in the vertical plane motion firstly the working and control principle of the thermal glider is given and the coordinate system and variables of the glider are defined based on these the mathematical motion model is built for a performance test secondly the minimum searching method based on a tracking differentiator td and the adrc control method are demonstrated they are combined into a self searching optimal adrc control method and it s proposed and demonstrated this method can compensate the external disturbance by adjusting its reference in advance which optimizes the required control signal finally this method is used for the pitch keeping control of the glider during its 23 descent 23 ascent and its posture transition control between the 23 descent and 23 ascent since this control system has a good steady and dynamic performance under a simulated ocean current and noise disturbance it proves to be a good anti disturbance and adaptive system in addition the control system can also achieve an optimal efficiency in terms of energy the control signal required to be kept at 23 descent or 23 ascent and track its transition trajectory is much smaller thus by assistantly adjusting the reference in advance it takes much less energy to resist disturbance than by only changing the control output and adjusting the actuator with the adrc or pid since the thermal glider carries a limited power saving energy means an increased endurance theory is a guide before practice this will has a great significance in the marine survey or military usage for the thermal glider besides the control algorithm is simple all these make it a better control strategy 2 the working and control principle of the thermal glider 2 1 the ocean thermal engine the underwater thermal glider has a propulsion system based on the ocean thermal energy that is the ocean thermal engine shown in fig 1 a it scavenges the ocean thermal energy between the warm surface and cold deep seawater and directly converts it into the mechanical energy to drive the glider fig 1 b shows the outline of the slocum thermal glider the working fluid is stored in its tubes which can exchange heat with its surrounding seawater easily kong et al 2010 yang et al 2016 the initial condition is shown in fig 1 a the thermal glider floats in the ocean surface which is in a stable thermal balance with the warm surface seawater its external bladder is expanded and the net buoyancy is positive the nitrogen in the accumulator is compressed the working fluid in the thermal tubes is completely liquid here the transfer fluid is ethylene glycol and the working gas is nitrogen the descent of the glider is shown in fig 2 a first the b c side of the 3 way valve is connected as the internal pressure of the glider is slightly lower than the atmospheric pressure the transfer fluid in the external bladder flows into the internal bladder as the volume of the external bladder decreases the net buoyancy changes from positive to negative the glider starts descent and the 3 way valve is closed while the surrounding temperature gradually declines the working fluid in the thermal tubes begins to release heat when the seawater temperature is lower than the phase change temperature the working fluid begins to solidify and shrink at this time the pressure in the thermal tube begins to decrease the check valve 2 is opened and the thermal tubes inhale the transfer fluid from the internal bladder kong et al 2010 yang et al 2016 the ascent of the glider is shown in fig 2 b first the a c side of the 3 way valve is connected the transfer fluid in the accumulator flows into the external bladder under the action of the high pressure nitrogen as the volume of the external bladder increases the net buoyancy changes from negative to positive the glider starts ascent and the 3 way valve is closed before the glider enters the warm seawater the working fluid is fully solidified and the volume is minimized when the seawater temperature is higher than the phase change temperature the working fluid begins to absorb heat from the seawater and melt and its volume expands at this time the working fluid produces a huge pressure on the transfer fluid then the check valve 1 is opened the transfer fluid is pressed into the accumulator again and the nitrogen in the accumulator is also compressed kong et al 2010 yang et al 2016 before the glider descends into the cold seawater again the working fluid is completely melted and the volume is maximized then a thermal cycle is completed 2 2 the control principle of the glider the buoyancy center of the thermal glider can be considered as invariant the buoyancy can be alternately reduced and increased by its buoyancy adjusting system while keeping the whole glider mass nearly constant this system reduces or increases the buoyancy to achieve a descent or ascent motion of the glider in the ocean meanwhile the thermal glider changes its mass distribution by an internal actuator for example the pitch adjusting mechanism changes the relative position of the glider gravity and buoyancy center by changing its sliding mass distribution in longitude this can control the pitch angle the roll adjusting mechanism controls the roll angle by changing the mass distribution horizontally according to the same principle graver 2005 if the thermal glider can maintain a stable pitch angle it will help to maximize the adjusting effect of the 3 way buoyancy timing valve in fig 2 the fixed wings of the thermal glider can generate lift during its descent and ascent motions through the posture adjustment the lift can drive the glider forward as a result the glider moves along a zigzag path the reason why the thermal glider is efficient is because it takes a stable zigzag gliding in the vertical plane for most of its motion time bhatta 2006 3 the mathematical model of the thermal glider and ocean disturbance the thermal glider adjusts its pitch angle mainly by sliding its internal mass 3 1 definition of coordinate system and variables the ground system x y z is defined as the inertial coordinate system and i j k is respectively the unit vector in x y z direction shown in fig 3 the inertial axis x and y are located in the horizontal plane and vertical to the gravity and z is the same direction as the gravity the origin of the ontology coordinate system e 1 e 2 e 3 is defined to coincide with the buoyancy center of the thermal glider the axis e 1 is along the long axis and points to the glider bow the axis e 2 is in the wing plane and points to the starboard side the axis e 3 is vertical to the wing plane the posture of the thermal glider is represented by the following three euler angles the heading angle φ pitch angle θ and roll angle ϕ φ is positive for the right inclination of the glider looking down θ is positive when its bow rises up and ϕ is positive when its right ring is downward as shown in fig 4 the motion and angular velocity s s 1 s 2 s 3 t ω ω 1 ω 2 ω 3 t of the thermal glider relative to the inertial coordinate system are respectively demonstrated in the ontology coordinate system in addition the hydrodynamic characteristic of the thermal glider depends on its relative speed and direction to the surrounding fluid without considering the ocean current that is the fluid is assumed stationary as shown in fig 4 the relative speed of the glider to its surrounding fluid is s then the relative direction can also be determined by the tracking coordinate system in fig 4 the origin of the tracking coordinate system coincides with the buoyancy center of the thermal glider the relative direction of the glider to its ontology coordinate system can be described by the following attack angle α and sideslip angle drift angle β as graver 2005 1 α arctan s 3 s 1 2 β arcsin s 2 s 1 2 s 2 2 s 3 2 thus the gliding angle ξ in the vertical plane can be defined as ξ θ α the thermal glider is regarded as a rigid ellipsoid and has a fixed wing tail and two internal particle masses m b m as shown in fig 5 the sliding mass m is used to control the glider posture the three direction position r p of the sliding mass in the ontology coordinate system can be expressed as r p r p 1 r p 2 r p 3 t another particle mass the buoyancy system mass m b is fixed on the buoyancy center of the glider ellipsoid this mass is variable and used to control the glider buoyancy the shell mass m h is evenly distributed thus the total static glider mass is m s m h m b and the total glider mass is m t m s m assuming that the drainage mass of the glider is m then the net buoyancy mass can be defined as m 0 m t m assuming that the fluid around the glider is an ideal fluid the additional mass matrix m f and inertia matrix j f of the surrounding fluid are both diagonal matrices that is m f diag m f 1 m f 2 m f 3 j f diag j f 1 j f 2 j f 3 define i as the unit matrix and define j s as the inertia matrix of the fixed glider mass then the system mass matrix consisting of the glider body and the fluid is m m s i m f diag m 1 m 2 m 3 and its inertia matrix is j j s j f diag j 1 j 2 j 3 in addition the control input of the three directions to the sliding mass is u u 1 u 2 u 3 t the control input to the variable buoyancy mass is u 4 3 2 the mathematical model of the thermal glider the team led by professor leonard of princeton university has established a nonlinear dynamic model of the thermal glider graver 2005 bhatta and leonard 2002 leonard and graver 2001 which can describe its behavior in detail in the paper this model is used for the motion control simulation of the thermal glider this model is the motion equation in the vertical plane the thermal glider takes a stable zigzag gliding in the vertical plane for most of its motion time in this paper the improved nonlinear motion equations of the thermal glider in the vertical plane are described in state space as follows 3 θ ω 2 4 ω 2 1 a m m 1 m m 3 y m m 3 m m 1 r p 1 r p 1 ω 2 m m m 3 r p 3 x 1 m m m 1 r p 1 x 3 m m 1 m m 3 r p 3 u 1 5 s 1 1 a m m m 3 r p 3 y m 2 m 3 r p 1 r p 3 r p 1 ω 2 j 2 m m 3 m m 3 r p 1 2 m m m 3 r p 3 2 x 1 m 2 r p 1 r p 3 x 3 m j 2 m j 2 m 3 m m 3 r p 1 2 u 1 6 s 3 1 a m m m 1 r p 1 y m j 2 m j 2 m 1 m m 1 r p 3 2 r p 1 ω 2 m 2 r p 1 r p 3 x 1 j 2 m m 1 m m m 1 r p 1 2 m m 1 r p 3 2 x 3 m 2 m 1 r p 1 r p 3 u 1 7 r p 1 u 1 8 m b u 4 in eqs 3 8 the variables are all defined in the context of sec 3 1 except for a j 2 m m 1 m m 3 m m 3 m m 1 r p 1 2 m m 1 m m 3 r p 3 2 x 1 m 3 s 3 ω 2 m s 3 r p 1 ω 2 ω 2 m 0 g sin θ d cos α l sin α x 3 m 1 s 1 ω 2 m s 1 r p 1 r p 3 ω 2 ω 2 m 0 g cos θ d sin α l cos α 9 y m 3 m 1 s 1 s 3 r p 1 m s 1 r p 1 r p 3 ω 2 r p 3 m s 3 r p 1 ω 2 ω 2 m g r p 1 cos θ r p 3 sin θ m d l 2 m 0 m b m h m m m 1 m b m h m f 1 m 3 m b m h m f 3 in it g is the unit of the gravity acceleration the resistance d lift l and viscous torque m d l 2 can be expressed as follows graver 2005 10 d k d 0 k d α 2 s 1 2 s 3 2 11 l k l 0 k l α s 1 2 s 3 2 12 m d l 2 k m 0 k m α s 1 2 s 3 2 k ω 2 1 ω 2 k ω 2 2 ω 2 2 in it k d 0 k d are the resistance coefficients k l 0 k l are the lift coefficients k m 0 k m are the viscous torque coefficients k ω 2 1 and k ω 2 2 are the angular velocity coefficients from eqs 3 8 it can be seen that the dynamic model of the thermal glider is a multi variable nonlinear and coupled system in addition it has five independent output variables θ s 1 s 3 m b r p 1 and only two independent input variables u 1 u 4 thus the system is also under actuated 3 3 the simulated disturbance the above equations are the mathematical model of the thermal glider in a static seawater in fact the glider motion is affected by the ocean current and wind etc usually the ocean current and its velocity change are very slow and can be negligible the ocean current in the surface is usually greater than that of the deep water moreover it s related to the terrain feature of the area seasonal change and other factors etc a simulated disturbance signal can be added to test the anti disturbance ability of the designed motion control system for the thermal glider for example the continuous disturbance signal 13 d t b 1 sin t r n d 0 5 5 d e s c e n t a s c e n t d t b 2 sin t 20 r n d 0 5 5 t r a n s i t i o n can be added to the output variable of the pitch angle during the descent ascent and posture transition simulations the r n d in eq 13 is a random function between 0 and 1 the reason to choose these basic disturbance is that it has an important effect on the thermal glider motion graver 2005 bhatta and leonard 2002 leonard and graver 2001 since the transition procedure is more difficult to control a lower frequency disturbance of sin t 20 is selected in eq 13 4 the minimal td and optimal adrc method 4 1 the minimum searching based on the td for a nonlinear input x t t h 2 h 3 h the td can output its filtered original signal x t and its derivative with respect to time t that is x t thus the td is a nonlinear function with a special character as shown in eqs 14 and 15 chang et al 2016 14 x 1 t 1 x 1 t h x 2 t x 2 t 1 x 2 t h f h a n x 1 t v t x 2 t r h 0 15 f h a n r s i g n a a d r a d a d d r h 0 d 0 h 0 d y x 1 t h 0 x 2 t a 0 d 2 8 r y a x 2 t a 0 d 2 s i g n y y d 0 x 2 t y h 0 y d 0 in it x 1 x 2 is respectively the system state and its first derivative h is the iterative time step f h a n is a constructed nonlinear function v is the system reference h 0 is the filtering factor r is the time ruler and s i g n is a sign function the measuring derivative method is often used to search an extreme value point shao et al 2017 its recursive algorithm is 16 x t 1 x t λ d y t d x t x x t in it λ is a correcting parameter if the function y f x is known the differential operator in eq 16 can be easily obtained however for the unknown model of the thermal glider the td is needed to obtain the derivative of y t and x t then eq 16 is revised and used to determine its extreme value point as in eq 17 x t 1 x t λ d y t d t d x t d t x x t 17 x t λ y t x t x x t the input and output signal x y of the thermal glider are respectively sent into two tds to obtain its real time differential signal x t y t then the x t y t are substituted into eq 17 and the extreme value can be obtained by repeating the iterative calculation 4 2 the adjusting parameters of the td it s not difficult to determine the td parameters r h 0 h because they have universal values that are suitable for most systems for example the h usually takes h 0 01 h 0 usually takes 20 30 times of the h r usually takes several tens feng and guo 2017 for a greater r fig 6 shows that the td output x 1 t is closer to the input signal the td output x 2 t is closer to its derivative and vice versa however if r is too large the tracking quality will be deteriorated by the noise in the input signal for a smaller h 0 the similar simulation can also show that the td has a better tracking effect and vice versa if h 0 is too small the tracking quality will also be deteriorated by the noise in the input signal for h as long as h h 0 fig 7 shows that the stable oscillation in the td outputs can always be eliminated example 1 the following function of eq 18 is selected to simulate and verify the proposed minimum searching algorithm based on the td 18 y f 1 x 0 1 x 2 4 x 3 according to the sec 4 2 the algorithm parameters are set as r 1000 h 0 01 h 0 0 01 λ 0 02 the simulation results are shown in figs 8 9 by analyzing fig 8 it s about x min 20 when the function takes its minimal y min 37 fig 9 shows the minimum searching process of y and it s finally stable at 37 fig 9 also shows that the x for the minimal y is ultimately stable at 20 the simulation proves that this algorithm can be used to find the minimal value and the optimal result also has a high accuracy 4 3 the adrc method the adrc theory was first proposed by han 2009 its central idea is that the internal dynamics and external disturbance of the thermal glider can be estimated and compensated in real time with a td extended state observer eso and nonlinear state error feedback nlsef then the adrc can promote the control quality and rate where a pid is probably used chang et al 2016 this method adopts the following four steps 1 arrange a transient process for the system reference with the td of eqs 14 and 15 2 estimate the system state and total disturbance of the controlled object with the eso 19 z 1 t 1 z 1 t h z 2 t β 01 e z 2 t 1 z 2 t h z 3 t β 02 f e u t z 3 t 1 z 3 t h β 03 f e 1 e z 1 t y t f e f a l e 0 5 h f e 1 f a l e 0 25 h 20 f a l e α δ e δ α 1 e δ e α s i g n e e δ in it e is the error of the estimated state and system output z 1 z 2 z 3 are the estimated system states and disturbance β 01 β 02 β 03 are the gain coefficients u is the control input y is the system output f a l is a constructed nonlinear function δ α are the parameters of the f a l function chang et al 2016 li et al 2016 3 the nlsef 21 e 1 x 1 t z 1 t e 2 x 2 t z 2 t u 0 t f h a n e 1 c e 2 r h 0 in it e 1 e 2 are the errors of the estimated and system states u 0 is an intermediate control signal before compensation c is a gain coefficient 4 the disturbance compensator 22 u t u 0 t z 3 t b 0 in it b 0 is the amplification factor of the control signal it can take 1 u is the final control signal 4 4 the adjusting parameters of the eso nlsef and compensator yu et al 2017 cui et al 2017b a successful output z 1 z 2 z 3 of the eso under β 01 100 β 02 300 β 03 1000 and δ 0 05 are shown in fig 10 the α in the f a l function in eq 20 is the power of its exponential function when it s not equals to 1 the adrc is a nonlinear controller the δ in the f a l is only effective for a nonlinear system a lot of simulations show that a small change in these parameters will greatly affect other parameters setting thus they should not be modified when the adrc controller is started while the other parameters β 01 β 02 β 03 b 0 can be modified online in general the α usually takes α 1 0 5 α 2 0 25 based on the practical experience which is to reduce its power calculation if the δ is too large the adrc can only work in a linear region if it s too small the adrc may have a vibration phenomenon thus the δ generally takes 0 1 at first and then it s fine tuned according to the control effect the β 01 β 02 and β 03 respectively affect the estimation of two system states and the system disturbance if the disturbance is large the β 01 β 02 β 03 should also be large in addition the larger the β 03 the smaller the delay however if β 03 is too large it probably causes the estimated value to diverge an appropriate increase of β 01 β 02 can suppress this divergence however if β 01 β 02 is too large it also has this divergence phenomenon thus these parameters should be coordinately adjusted a small change of b 0 will also lead to a jumping change in the control signal the b 0 usually takes a larger value when it s a delay system a larger b 0 can also effectively compensate for the disturbance and model uncertainty example 2 the following two order dynamic system of eq 23 is taken for example 23 x 6 x 3 x ω u y x in it ω sin t γ n t is an added disturbance n t is the white noise whose mean value is 0 and variance is 1 γ 0 1 u is the control input the reference is a unit step signal of v 1 from time1 the adopted adrc controller is shown in eqs 14 and 15 and eqs 19 22 the parameters for the best control effect are found as r 30 c 3 h 0 0 3 β 01 100 β 02 300 β 03 1000 b 0 1 h 0 01 with a trial and error method the proportional integral differential coefficient of the pid controller is k 34 t i 17 t d 0 8 then the control effect for the unit step input in fig 11 shows that the adrc has a better control effect than that of the pid it can achieve a non overshoot control while satisfying the rapidity under the disturbance of ω sin t γ n t if the adrc can resist the step response disturbance it can work on most occasions this is because this disturbance is the most destructive to a dynamic system 5 the self searching optimal control for the underwater thermal glider 5 1 the self searching optimal control method based on the td and adrc this section will combine the above minimum searching td and adrc to propose a self searching optimal adrc control method this method can optimize the control energy while achieving its anti disturbance control for the thermal glider the optimal and control effect is assistantly achieved by compensating for the external disturbance through adjusting its reference in advance this method regards the control variable as a function of the state error e reference v 0 t and disturbance ω t that is u t f e v 0 t ω t then the control energy can be expressed as u 2 t f 2 e v 0 t ω t thus the optimal control energy problem is to search a proper reference v 0 t and minimize the function u 2 t f 2 e v 0 t ω t according to the external disturbance it s an adaptive control process although the specific equation u 2 t f 2 e v 0 t ω t is unknown this function relationship does exist first the td based minimum searching method in sec 4 1 can be used to determine the optimal v 0 t next the optimal v 0 t is used to yield the control variable u t and resist the disturbance with the adrc method in sec 4 3 in turn the control energy u 2 t is optimized which adjusts the v 0 t according to the disturbance and self searching optimal adrc control method this principle is shown in fig 12 symbols also refer to eqs 14 15 19 22 and the self searching optimal adrc control method is as follows 1 arrange a transient process for the reference v 0 t according to the td of eqs 14 and 15 24 v 1 t 1 v 1 t h v 2 t v 2 t 1 v 2 t h f h a n v 1 t v 0 t v 2 t r 0 h 2 output the estimated system state z 1 z 2 and the total disturbance z 3 according to the eso of eqs 19 and 20 25 z 1 t 1 z 1 t h z 2 t β 01 e z 2 t 1 z 2 t h z 3 t β 02 f e u t z 3 t 1 z 3 t h β 03 f e 1 e z 1 t y t f e f a l e 0 5 h f e 1 f a l e 0 25 h 3 output the error e 1 the control variable u u t of the error feedback and the final control variable u t according to the nlsef and compensator of eqs 21 and 22 26 e 1 v 1 t z 1 t e 2 v 2 t z 2 t u u t f h a n e 1 c e 2 r h 0 u t u u t z 3 t b 0 4 calculate the u 2 t f 2 e v 0 t ω t derivative for optimization with an intermediate variable d t d u 2 t d v 0 t according to the outputs of two tds of eqs 14 and 15 27 u 01 t 1 u 01 t h u 02 t u 02 t 1 u 02 t h f h a n u 01 t u 2 t u 02 t r 1 h 1 28 v 01 t 1 v 01 t h v 02 t v 02 t 1 v 02 t h f h v f h a n v 01 t v 0 t v 02 t r 2 h 2 5 the non zero processing for v 02 t 29 v 02 t max a b s v 02 t 0 0001 s i g n v 02 t in it the max is a function to select and output the bigger value and s i g n is a sign function 6 then the new form of the intermediate variable d t and its filtering processing are 30 d t d u 2 t d v 0 t u 02 t v 02 t 31 d 1 t 1 d 1 t h d 2 t d 2 t 1 d 2 t h f h a n d 1 t d t d 2 t r 3 h 3 7 finally the reference v 0 t is revised according to the minimum searching method of eq 17 by substituting the results of eqs 30 and 31 into it that is v 0 t 1 v 0 t λ d u 2 t d v 0 t v 0 t λ d 1 t 32 v 0 t λ f a l d 1 t 0 1 0 001 where the nonlinear function f a l d 1 t 0 1 0 001 is used for a proper approximating speed it can improve the approximating speed when d 1 t is small and decrease the approximating speed when d 1 t is big 5 2 simulation and test preparing under a general numerical example example 3 suppose that there is a general controlled system 33 x 1 x 2 x 2 a 1 x 1 v 0 a 2 x 2 ω t u y x 1 in it a 1 2 0 a 2 1 0 the external disturbance is ω t sin t 20 the controller parameters are 34 β 01 100 β 02 300 β 03 1000 r 0 20 r 100 c 3 0 h 0 0 2 r 1 r 2 r 3 100 h 1 h 2 h 3 0 2 λ 0 0005 the constant v 0 2 is assumed as the system reference the aim is to resist the external disturbance ω t with an optimal control energy then eq 34 can be rewritten into 35 x 1 x 2 x 2 a 1 x 1 v 0 ω t a 1 a 2 x 2 ω t u y x 1 according to eq 35 if the reference is revised as v 0 ω t a 1 the control signal u 0 can still achieve its control purpose thus the self searching optimal adrc control is available and its simulation is shown in figs 13 15 the system can achieve its control effect fig 13 while the control signal is very small fig 14 and the reference can basically keep up with the disturbance change fig 15 5 3 the pitch angle keeping control during descent and ascent under current and noise disturbance based on the above general numerical example a further simulation for the thermal glider can be tested it s to evaluate the performance of the motion control system under the proposed self searching optimal adrc ocean current and noise disturbance now the controlled object is the thermal glider model of eqs 3 12 this model is similar to the slocum of sec 2 in size and its parameters are shown in table 1 only the pitch angle adjustment needs to be considered for the simulation in this paper this is because the buoyancy is only preset by twice timing operations of the three way valve a b c in fig 2 during a thermal cycle after the valve is switched the buoyancy changes according to eq 36 at the beginning of the descent or changes according to eq 37 at the beginning of the ascent this is also shown in fig 16 36 y 1 d 0 047 0 094 3 t 15 2 2 t 15 3 t 15 0 047 t 15 37 y 2 d 0 047 0 094 3 t 15 2 2 t 15 3 t 15 0 047 t 15 then the longitudinal position of the sliding mass in the glider is to be controlled the thermal glider should be kept at 23 23 pitch angle during its ascent descent under the ocean current and noise disturbance d t b 1 sin t r n d 0 5 5 in eq 13 1 first the 23 pitch angle keeping for the glider descent is taken for example and simulated at the initial time the steady state of the thermal glider is respectively θ 23 ω 2 0 deg s v 1 0 3 m s v 3 0 01 m s r p 1 0 02 m r p 1 0 m s m 0 0 047 kg the parameters of the self searching optimal adrc controller are set the same as eq 34 except for λ 0 0059 the simulation results are in figs 17 19 fig 17 shows that the glider can maintain at 23 descent pitch angle even under the ocean current and noise disturbance meanwhile fig 18 shows that the control signal and its energy is optimized and very small it is due to the optimal and control effect through compensation by adjusting the reference in advance as shown in fig 19 thus the control system has a good trajectory keeping performance with an optimized energy efficiency the truth is the control signal of the proposed controller totally depends on its added disturbance in the real ocean the disturbances to the thermal glider are much simpler and less than our assumed ones thus the control variable will not fluctuate sharply as in fig 18 and the effects should be automatically eliminated when the disturbance form changes or its frequency decreases such practice will neither increase the energy consumption nor reduce the mechanical life 2 then the state at 23 pitch angle during the glider ascent is taken for example and simulated at the initial time the steady state of the thermal glider is respectively θ 23 ω 2 0 deg s v 1 0 3 m s v 3 0 01 m s r p 1 0 02 m r p 1 0 m s m 0 0 047 kg the disturbance and controller parameters are set the same as the descent simulation the simulation results are shown in figs 20 22 it s very similar to the descent simulation and has the same principle which will not be repeated here 5 4 the pitch angle transition control between ascent and descent under current and noise disturbance when the thermal glider descends to the intended ocean depth it must be switched from descent to ascent and vice versa the longitudinal position of the sliding mass in the glider is still to be controlled the control system output is the pitch angle transition from 23 to 23 or from 23 to 23 under the simulated ocean current and noise disturbance of d t b 2 sin t 20 r n d 0 5 5 in eq 13 the steady state 1 of the 23 descent for the thermal glider is respectively θ 23 ω 2 0 deg s v 1 0 3 m s v 3 0 01 m s r p 1 0 02 m r p 1 0 m s m 0 0 047 kg the steady state 2 of the 23 ascent is respectively θ 23 ω 2 0 deg s v 1 0 3 m s v 3 0 01 m s r p 1 0 02 m r p 1 0 m s m 0 0 047 kg the desired pitch angle transition trajectory from 23 descent to 23 ascent is planed according to eq 39 the pitch angle transition from 23 to 23 is planed according to eq 40 this is also shown in fig 23 39 y 1 d 23 46 10 t 15 3 15 t 15 4 6 t 15 5 t 15 23 t 15 40 y 1 d 23 46 10 t 15 3 15 t 15 4 6 t 15 5 t 15 23 t 15 this section takes a continuous transition procedure for example in order to test the control ability of the proposed self searching optimal adrc controller this is because the steady glide segments of keeping descent and ascent have been tested in sec 5 3 thus the steady segments have been omitted in this test by initializing the glider model after each transition that is at first the pitch angle of the thermal glider changes from 23 to 23 when finished the glider model is immediately initialized into the steady state 2 then it changes from 23 to 23 when finished the glider model is immediately initialized into the 23 steady state 1 the test continues to repeat this cycle the model and controller parameters are set the same as in sec 5 3 the invariant controller parameters adaptive to different motion and disturbance are necessary for the online control of the thermal glider the glider can obtain a robust performance without even revising its parameter online otherwise the online adjusting will make the controller very difficult to be used the simulation results are in figs 24 26 fig 24 shows that the glider can make a continuous transition between the two equilibrium states according to the desired transition trajectory of eqs 39 and 40 or fig 23 under the ocean current and noise disturbance meanwhile fig 25 shows that the control signal and its energy is optimized and very small it is due to the optimal and control effect through compensation by adjusting the reference in advance as shown in fig 26 thus the control system also has a good trajectory tracking performance with an optimized energy efficiency as the controller parameters are kept invariant for the simulation in sec 5 3 and 5 4 the proposed self searching optimal adrc is also a successful adaptive control method compared with ref santhakumar and asokan 2013 townsend 2016 these energy efficient results are only based on the self searching optimal adrc method and there is no need to revise the thermal glider design compared with ref sarkar et al 2016 these methods probably have a much smaller control signal to resist the disturbance the superiority lies in that the minimum searching td searches for the optimal control signal while the adrc achieves the anti disturbance control effect thus it takes much less energy to resist the disturbance by assistantly adjusting the reference in advance than by only changing the control output and adjusting the actuator with the adrc or pid to sum up the control system is characterized by its good steady and dynamic effect and also good anti disturbance and adaptive performance besides the control signal required to maintain and track the output trajectory is small which consumes low control energy all these make it a better control strategy 6 discussion and conclusion this paper proposes a self searching optimal adrc control method for the pitch angle control of an underwater thermal glider in the vertical plane motion under disturbance firstly the working and control principle of the thermal glider is given and the coordinate system and variables of the glider are defined based on this the mathematical motion model is built for a performance test then a minimum searching method based on the td and the adrc control method are demonstrated a self searching optimal adrc control method is proposed and demonstrated thereafter with this method the external disturbance can be compensated by adjusting the reference in advance which makes the required control signal optimized and small finally this method is used for the pitch keeping control of the glider during its 23 descent 23 ascent and its posture transition control between the 23 descent and 23 ascent the results show that the control system has a good steady and dynamic effect under a simulated ocean current and noise disturbance it can resist the disturbance and maintain a good adaptive performance in addition the control system can achieve a energy efficient control effect the control signal required to be kept at 23 descent 23 ascent and track its transition trajectory is much smaller then the required control energy is also much lower since the thermal glider carries a limited power saving energy means an increased endurance this has a great significance in regards to the marine survey or military purpose for the thermal glider besides the control algorithm is also simple all these make it a better control strategy acknowledgments this work is supported by the nsfc projects of china under grant no 61403250 no 51779136 no 51509151 the bureau project of china under grant no 2015ht056 and the science commission of shanghai under grant no 13510501600 
23361,an underwater thermal glider is efficient when it takes a stable zigzag gliding in the vertical plane to increase its endurance improving the control and energy efficiency over the pitch angle adjustment is necessary firstly the working and control principle of the thermal glider is given and the mathematical motion model is built on this principle for a performance test secondly based on the tracking differentiator and active disturbance rejection control adrc theory a self searching optimal control method is proposed with this method the external disturbance can be compensated by adjusting the reference in advance which makes the required control signal optimized and small finally this method is used for the pitch keeping control of the glider during the descent and ascent or the posture transition control between the descent and ascent the results show that the control system has a good steady and dynamic performance under a simulated ocean current and noise disturbance as well as an adaptive effect the control signal to keep and track the trajectory is much smaller thus by assistantly adjusting the reference in advance this method takes much less energy to resist the disturbance than by only changing the control output and adjusting the actuator with the adrc or pid since the thermal glider carries a limited power saving energy means an increased endurance theory is a guide before practice this will have a great significance in the marine survey or military usage besides the control algorithm is also simple all these make it a better control strategy keywords tracking differentiator self searching optimal active disturbance rejection control pitch angle underwater thermal glider vertical plane control 1 introduction an underwater thermal glider is a kind of efficient buoyancy driven and autonomous underwater vehicle auv with wings it converts the ocean thermal energy into a propulsion power and has an important value in the marine survey and military detection the core component of the thermal glider is the thermal energy tubes which contain a working fluid of phase change material davis et al 2002 however the underwater thermal glider inherently has a low motion speed and highly dependents on its motion environment thus it faces a lot of problems when dealing with the complex marine environment for example how to have a robust performance how to save energy and how to improve its dynamics besides the glider dynamics have a multi variable nonlinear and coupled characteristic these factors pose a great challenge to the design of its motion control system mahmoudian 2009 owen et al 2015 at present many underwater thermal gliders still adopt a simple or promoted pid control to keep their posture herman 2009 alvarez et al 2009 sarhadi et al 2016a tanakitkorn et al 2017 this method is simple and effective in a certain range but it lacks an adaptability non linearity and intelligence for a better control effect the partial feedback linearization theory is used in the tracking control of the glider under uncertain disturbance repoulias and papadopoulos 2007 kim 2015 caharija et al 2016 miao et al 2017 however the linear control law of this method has a good control performance only near the equilibrium it is not suitable for the wide range motion of the glider thus a nonlinear method must be considered for its further control the neural network has a good nonlinearity the adaptive control method based on the neural network is utilized in many occasions such as the nonlinear multi input multi output motion control of the auv zhang et al 2009 peng et al 2015 shojaei 2016 cui et al 2017a however a learning process needs to completed before the neural network can be used besides its training method still has some inherent deficiencies the sliding mode control smc essentially is also a special nonlinear method its non linearity is reflected in the discontinuity of its control it can purposefully change based on the current system state which forces the system to move according to the state trajectory of the sliding mode the sliding mode can be designed and independent of the object parameter or disturbance because of this advantage the smc is also widely used in the motion control of the glider guo et al 2003 cui et al 2016 valeriano et al 2016 elmokadem et al 2017 however the differential geometry theory of its regularization process is very abstract and its coordinate transformation process is also complicated the backstepping method does not need a complex coordinate transformation its process is simple and the physical meaning is also clear thus the backstepping adaptive control is widely used in the glider motion control batista et al 2009 lapierre 2009 xiang et al 2015 li et al 2015 this method and its transformation are both constructive they are based on the lyapunov stability theory and satisfy the lyapunov convergence therefore the backstepping method shows a good adaptability and robustness under uncertain disturbance however the construct function sometimes is not easy to find in order to achieve a better control effect an integrated control approach that combines the advantages of various methods is used for example in 2016 zool et al proposed a smc and robust dynamic region based scheme for the robust control of an auv ismail et al 2016 in 2016 sarhadi et al combined a model reference adaptive control with an integral state feedback and modern anti windup compensator for the pitch and yaw channel control of the auv with actuator saturation sarhadi et al 2016b in 2016 kim et al presented an integral smc supplemented by an enhanced time delay controller for the auv position control under disturbance kim et al 2016 in 2017 rout et al developed a constrained self tuning controller for the heading and diving motion control of an auv with a moving average exogenous model extended recursive least square algorithm and sight guidance law rout and subudhi 2017 there are still some other methods that have been used in the motion control of the underwater glider such as the fuzzy control method xiang et al 2017 the robust control method qiao et al 2017 the model predict control method shi et al 2017 etc these methods all have achieved their control effect over the desired targets in their respective field however an overlook that many of the above methods share is that only the control effect is considered while further efforts on the optimization by minimizing the control energy are neglected during achieving the control effect thus in 2013 santhakumar et al developed a power efficient dynamic station keeping control of a flat fish type auv by modifying its thruster configuration santhakumar and asokan 2013 in 2016 sarkar et al addressed the energy and control accuracy issues with a novel controller of the smc and euler lagrange based classical optimal method sarkar et al 2016 in 2017 townsend proposed a self powered auv according to the principle of a gyroscopic energy prototype townsend 2016 it can be seen that some methods are in need to further modify the auv design the trade off research between the control and its energy is still rare and further study is needed therefore in order to promote the control and energy efficiency by further optimization this paper proposes a self searching optimal active disturbance rejection control adrc method for the pitch angle control of an underwater thermal glider in the vertical plane motion firstly the working and control principle of the thermal glider is given and the coordinate system and variables of the glider are defined based on these the mathematical motion model is built for a performance test secondly the minimum searching method based on a tracking differentiator td and the adrc control method are demonstrated they are combined into a self searching optimal adrc control method and it s proposed and demonstrated this method can compensate the external disturbance by adjusting its reference in advance which optimizes the required control signal finally this method is used for the pitch keeping control of the glider during its 23 descent 23 ascent and its posture transition control between the 23 descent and 23 ascent since this control system has a good steady and dynamic performance under a simulated ocean current and noise disturbance it proves to be a good anti disturbance and adaptive system in addition the control system can also achieve an optimal efficiency in terms of energy the control signal required to be kept at 23 descent or 23 ascent and track its transition trajectory is much smaller thus by assistantly adjusting the reference in advance it takes much less energy to resist disturbance than by only changing the control output and adjusting the actuator with the adrc or pid since the thermal glider carries a limited power saving energy means an increased endurance theory is a guide before practice this will has a great significance in the marine survey or military usage for the thermal glider besides the control algorithm is simple all these make it a better control strategy 2 the working and control principle of the thermal glider 2 1 the ocean thermal engine the underwater thermal glider has a propulsion system based on the ocean thermal energy that is the ocean thermal engine shown in fig 1 a it scavenges the ocean thermal energy between the warm surface and cold deep seawater and directly converts it into the mechanical energy to drive the glider fig 1 b shows the outline of the slocum thermal glider the working fluid is stored in its tubes which can exchange heat with its surrounding seawater easily kong et al 2010 yang et al 2016 the initial condition is shown in fig 1 a the thermal glider floats in the ocean surface which is in a stable thermal balance with the warm surface seawater its external bladder is expanded and the net buoyancy is positive the nitrogen in the accumulator is compressed the working fluid in the thermal tubes is completely liquid here the transfer fluid is ethylene glycol and the working gas is nitrogen the descent of the glider is shown in fig 2 a first the b c side of the 3 way valve is connected as the internal pressure of the glider is slightly lower than the atmospheric pressure the transfer fluid in the external bladder flows into the internal bladder as the volume of the external bladder decreases the net buoyancy changes from positive to negative the glider starts descent and the 3 way valve is closed while the surrounding temperature gradually declines the working fluid in the thermal tubes begins to release heat when the seawater temperature is lower than the phase change temperature the working fluid begins to solidify and shrink at this time the pressure in the thermal tube begins to decrease the check valve 2 is opened and the thermal tubes inhale the transfer fluid from the internal bladder kong et al 2010 yang et al 2016 the ascent of the glider is shown in fig 2 b first the a c side of the 3 way valve is connected the transfer fluid in the accumulator flows into the external bladder under the action of the high pressure nitrogen as the volume of the external bladder increases the net buoyancy changes from negative to positive the glider starts ascent and the 3 way valve is closed before the glider enters the warm seawater the working fluid is fully solidified and the volume is minimized when the seawater temperature is higher than the phase change temperature the working fluid begins to absorb heat from the seawater and melt and its volume expands at this time the working fluid produces a huge pressure on the transfer fluid then the check valve 1 is opened the transfer fluid is pressed into the accumulator again and the nitrogen in the accumulator is also compressed kong et al 2010 yang et al 2016 before the glider descends into the cold seawater again the working fluid is completely melted and the volume is maximized then a thermal cycle is completed 2 2 the control principle of the glider the buoyancy center of the thermal glider can be considered as invariant the buoyancy can be alternately reduced and increased by its buoyancy adjusting system while keeping the whole glider mass nearly constant this system reduces or increases the buoyancy to achieve a descent or ascent motion of the glider in the ocean meanwhile the thermal glider changes its mass distribution by an internal actuator for example the pitch adjusting mechanism changes the relative position of the glider gravity and buoyancy center by changing its sliding mass distribution in longitude this can control the pitch angle the roll adjusting mechanism controls the roll angle by changing the mass distribution horizontally according to the same principle graver 2005 if the thermal glider can maintain a stable pitch angle it will help to maximize the adjusting effect of the 3 way buoyancy timing valve in fig 2 the fixed wings of the thermal glider can generate lift during its descent and ascent motions through the posture adjustment the lift can drive the glider forward as a result the glider moves along a zigzag path the reason why the thermal glider is efficient is because it takes a stable zigzag gliding in the vertical plane for most of its motion time bhatta 2006 3 the mathematical model of the thermal glider and ocean disturbance the thermal glider adjusts its pitch angle mainly by sliding its internal mass 3 1 definition of coordinate system and variables the ground system x y z is defined as the inertial coordinate system and i j k is respectively the unit vector in x y z direction shown in fig 3 the inertial axis x and y are located in the horizontal plane and vertical to the gravity and z is the same direction as the gravity the origin of the ontology coordinate system e 1 e 2 e 3 is defined to coincide with the buoyancy center of the thermal glider the axis e 1 is along the long axis and points to the glider bow the axis e 2 is in the wing plane and points to the starboard side the axis e 3 is vertical to the wing plane the posture of the thermal glider is represented by the following three euler angles the heading angle φ pitch angle θ and roll angle ϕ φ is positive for the right inclination of the glider looking down θ is positive when its bow rises up and ϕ is positive when its right ring is downward as shown in fig 4 the motion and angular velocity s s 1 s 2 s 3 t ω ω 1 ω 2 ω 3 t of the thermal glider relative to the inertial coordinate system are respectively demonstrated in the ontology coordinate system in addition the hydrodynamic characteristic of the thermal glider depends on its relative speed and direction to the surrounding fluid without considering the ocean current that is the fluid is assumed stationary as shown in fig 4 the relative speed of the glider to its surrounding fluid is s then the relative direction can also be determined by the tracking coordinate system in fig 4 the origin of the tracking coordinate system coincides with the buoyancy center of the thermal glider the relative direction of the glider to its ontology coordinate system can be described by the following attack angle α and sideslip angle drift angle β as graver 2005 1 α arctan s 3 s 1 2 β arcsin s 2 s 1 2 s 2 2 s 3 2 thus the gliding angle ξ in the vertical plane can be defined as ξ θ α the thermal glider is regarded as a rigid ellipsoid and has a fixed wing tail and two internal particle masses m b m as shown in fig 5 the sliding mass m is used to control the glider posture the three direction position r p of the sliding mass in the ontology coordinate system can be expressed as r p r p 1 r p 2 r p 3 t another particle mass the buoyancy system mass m b is fixed on the buoyancy center of the glider ellipsoid this mass is variable and used to control the glider buoyancy the shell mass m h is evenly distributed thus the total static glider mass is m s m h m b and the total glider mass is m t m s m assuming that the drainage mass of the glider is m then the net buoyancy mass can be defined as m 0 m t m assuming that the fluid around the glider is an ideal fluid the additional mass matrix m f and inertia matrix j f of the surrounding fluid are both diagonal matrices that is m f diag m f 1 m f 2 m f 3 j f diag j f 1 j f 2 j f 3 define i as the unit matrix and define j s as the inertia matrix of the fixed glider mass then the system mass matrix consisting of the glider body and the fluid is m m s i m f diag m 1 m 2 m 3 and its inertia matrix is j j s j f diag j 1 j 2 j 3 in addition the control input of the three directions to the sliding mass is u u 1 u 2 u 3 t the control input to the variable buoyancy mass is u 4 3 2 the mathematical model of the thermal glider the team led by professor leonard of princeton university has established a nonlinear dynamic model of the thermal glider graver 2005 bhatta and leonard 2002 leonard and graver 2001 which can describe its behavior in detail in the paper this model is used for the motion control simulation of the thermal glider this model is the motion equation in the vertical plane the thermal glider takes a stable zigzag gliding in the vertical plane for most of its motion time in this paper the improved nonlinear motion equations of the thermal glider in the vertical plane are described in state space as follows 3 θ ω 2 4 ω 2 1 a m m 1 m m 3 y m m 3 m m 1 r p 1 r p 1 ω 2 m m m 3 r p 3 x 1 m m m 1 r p 1 x 3 m m 1 m m 3 r p 3 u 1 5 s 1 1 a m m m 3 r p 3 y m 2 m 3 r p 1 r p 3 r p 1 ω 2 j 2 m m 3 m m 3 r p 1 2 m m m 3 r p 3 2 x 1 m 2 r p 1 r p 3 x 3 m j 2 m j 2 m 3 m m 3 r p 1 2 u 1 6 s 3 1 a m m m 1 r p 1 y m j 2 m j 2 m 1 m m 1 r p 3 2 r p 1 ω 2 m 2 r p 1 r p 3 x 1 j 2 m m 1 m m m 1 r p 1 2 m m 1 r p 3 2 x 3 m 2 m 1 r p 1 r p 3 u 1 7 r p 1 u 1 8 m b u 4 in eqs 3 8 the variables are all defined in the context of sec 3 1 except for a j 2 m m 1 m m 3 m m 3 m m 1 r p 1 2 m m 1 m m 3 r p 3 2 x 1 m 3 s 3 ω 2 m s 3 r p 1 ω 2 ω 2 m 0 g sin θ d cos α l sin α x 3 m 1 s 1 ω 2 m s 1 r p 1 r p 3 ω 2 ω 2 m 0 g cos θ d sin α l cos α 9 y m 3 m 1 s 1 s 3 r p 1 m s 1 r p 1 r p 3 ω 2 r p 3 m s 3 r p 1 ω 2 ω 2 m g r p 1 cos θ r p 3 sin θ m d l 2 m 0 m b m h m m m 1 m b m h m f 1 m 3 m b m h m f 3 in it g is the unit of the gravity acceleration the resistance d lift l and viscous torque m d l 2 can be expressed as follows graver 2005 10 d k d 0 k d α 2 s 1 2 s 3 2 11 l k l 0 k l α s 1 2 s 3 2 12 m d l 2 k m 0 k m α s 1 2 s 3 2 k ω 2 1 ω 2 k ω 2 2 ω 2 2 in it k d 0 k d are the resistance coefficients k l 0 k l are the lift coefficients k m 0 k m are the viscous torque coefficients k ω 2 1 and k ω 2 2 are the angular velocity coefficients from eqs 3 8 it can be seen that the dynamic model of the thermal glider is a multi variable nonlinear and coupled system in addition it has five independent output variables θ s 1 s 3 m b r p 1 and only two independent input variables u 1 u 4 thus the system is also under actuated 3 3 the simulated disturbance the above equations are the mathematical model of the thermal glider in a static seawater in fact the glider motion is affected by the ocean current and wind etc usually the ocean current and its velocity change are very slow and can be negligible the ocean current in the surface is usually greater than that of the deep water moreover it s related to the terrain feature of the area seasonal change and other factors etc a simulated disturbance signal can be added to test the anti disturbance ability of the designed motion control system for the thermal glider for example the continuous disturbance signal 13 d t b 1 sin t r n d 0 5 5 d e s c e n t a s c e n t d t b 2 sin t 20 r n d 0 5 5 t r a n s i t i o n can be added to the output variable of the pitch angle during the descent ascent and posture transition simulations the r n d in eq 13 is a random function between 0 and 1 the reason to choose these basic disturbance is that it has an important effect on the thermal glider motion graver 2005 bhatta and leonard 2002 leonard and graver 2001 since the transition procedure is more difficult to control a lower frequency disturbance of sin t 20 is selected in eq 13 4 the minimal td and optimal adrc method 4 1 the minimum searching based on the td for a nonlinear input x t t h 2 h 3 h the td can output its filtered original signal x t and its derivative with respect to time t that is x t thus the td is a nonlinear function with a special character as shown in eqs 14 and 15 chang et al 2016 14 x 1 t 1 x 1 t h x 2 t x 2 t 1 x 2 t h f h a n x 1 t v t x 2 t r h 0 15 f h a n r s i g n a a d r a d a d d r h 0 d 0 h 0 d y x 1 t h 0 x 2 t a 0 d 2 8 r y a x 2 t a 0 d 2 s i g n y y d 0 x 2 t y h 0 y d 0 in it x 1 x 2 is respectively the system state and its first derivative h is the iterative time step f h a n is a constructed nonlinear function v is the system reference h 0 is the filtering factor r is the time ruler and s i g n is a sign function the measuring derivative method is often used to search an extreme value point shao et al 2017 its recursive algorithm is 16 x t 1 x t λ d y t d x t x x t in it λ is a correcting parameter if the function y f x is known the differential operator in eq 16 can be easily obtained however for the unknown model of the thermal glider the td is needed to obtain the derivative of y t and x t then eq 16 is revised and used to determine its extreme value point as in eq 17 x t 1 x t λ d y t d t d x t d t x x t 17 x t λ y t x t x x t the input and output signal x y of the thermal glider are respectively sent into two tds to obtain its real time differential signal x t y t then the x t y t are substituted into eq 17 and the extreme value can be obtained by repeating the iterative calculation 4 2 the adjusting parameters of the td it s not difficult to determine the td parameters r h 0 h because they have universal values that are suitable for most systems for example the h usually takes h 0 01 h 0 usually takes 20 30 times of the h r usually takes several tens feng and guo 2017 for a greater r fig 6 shows that the td output x 1 t is closer to the input signal the td output x 2 t is closer to its derivative and vice versa however if r is too large the tracking quality will be deteriorated by the noise in the input signal for a smaller h 0 the similar simulation can also show that the td has a better tracking effect and vice versa if h 0 is too small the tracking quality will also be deteriorated by the noise in the input signal for h as long as h h 0 fig 7 shows that the stable oscillation in the td outputs can always be eliminated example 1 the following function of eq 18 is selected to simulate and verify the proposed minimum searching algorithm based on the td 18 y f 1 x 0 1 x 2 4 x 3 according to the sec 4 2 the algorithm parameters are set as r 1000 h 0 01 h 0 0 01 λ 0 02 the simulation results are shown in figs 8 9 by analyzing fig 8 it s about x min 20 when the function takes its minimal y min 37 fig 9 shows the minimum searching process of y and it s finally stable at 37 fig 9 also shows that the x for the minimal y is ultimately stable at 20 the simulation proves that this algorithm can be used to find the minimal value and the optimal result also has a high accuracy 4 3 the adrc method the adrc theory was first proposed by han 2009 its central idea is that the internal dynamics and external disturbance of the thermal glider can be estimated and compensated in real time with a td extended state observer eso and nonlinear state error feedback nlsef then the adrc can promote the control quality and rate where a pid is probably used chang et al 2016 this method adopts the following four steps 1 arrange a transient process for the system reference with the td of eqs 14 and 15 2 estimate the system state and total disturbance of the controlled object with the eso 19 z 1 t 1 z 1 t h z 2 t β 01 e z 2 t 1 z 2 t h z 3 t β 02 f e u t z 3 t 1 z 3 t h β 03 f e 1 e z 1 t y t f e f a l e 0 5 h f e 1 f a l e 0 25 h 20 f a l e α δ e δ α 1 e δ e α s i g n e e δ in it e is the error of the estimated state and system output z 1 z 2 z 3 are the estimated system states and disturbance β 01 β 02 β 03 are the gain coefficients u is the control input y is the system output f a l is a constructed nonlinear function δ α are the parameters of the f a l function chang et al 2016 li et al 2016 3 the nlsef 21 e 1 x 1 t z 1 t e 2 x 2 t z 2 t u 0 t f h a n e 1 c e 2 r h 0 in it e 1 e 2 are the errors of the estimated and system states u 0 is an intermediate control signal before compensation c is a gain coefficient 4 the disturbance compensator 22 u t u 0 t z 3 t b 0 in it b 0 is the amplification factor of the control signal it can take 1 u is the final control signal 4 4 the adjusting parameters of the eso nlsef and compensator yu et al 2017 cui et al 2017b a successful output z 1 z 2 z 3 of the eso under β 01 100 β 02 300 β 03 1000 and δ 0 05 are shown in fig 10 the α in the f a l function in eq 20 is the power of its exponential function when it s not equals to 1 the adrc is a nonlinear controller the δ in the f a l is only effective for a nonlinear system a lot of simulations show that a small change in these parameters will greatly affect other parameters setting thus they should not be modified when the adrc controller is started while the other parameters β 01 β 02 β 03 b 0 can be modified online in general the α usually takes α 1 0 5 α 2 0 25 based on the practical experience which is to reduce its power calculation if the δ is too large the adrc can only work in a linear region if it s too small the adrc may have a vibration phenomenon thus the δ generally takes 0 1 at first and then it s fine tuned according to the control effect the β 01 β 02 and β 03 respectively affect the estimation of two system states and the system disturbance if the disturbance is large the β 01 β 02 β 03 should also be large in addition the larger the β 03 the smaller the delay however if β 03 is too large it probably causes the estimated value to diverge an appropriate increase of β 01 β 02 can suppress this divergence however if β 01 β 02 is too large it also has this divergence phenomenon thus these parameters should be coordinately adjusted a small change of b 0 will also lead to a jumping change in the control signal the b 0 usually takes a larger value when it s a delay system a larger b 0 can also effectively compensate for the disturbance and model uncertainty example 2 the following two order dynamic system of eq 23 is taken for example 23 x 6 x 3 x ω u y x in it ω sin t γ n t is an added disturbance n t is the white noise whose mean value is 0 and variance is 1 γ 0 1 u is the control input the reference is a unit step signal of v 1 from time1 the adopted adrc controller is shown in eqs 14 and 15 and eqs 19 22 the parameters for the best control effect are found as r 30 c 3 h 0 0 3 β 01 100 β 02 300 β 03 1000 b 0 1 h 0 01 with a trial and error method the proportional integral differential coefficient of the pid controller is k 34 t i 17 t d 0 8 then the control effect for the unit step input in fig 11 shows that the adrc has a better control effect than that of the pid it can achieve a non overshoot control while satisfying the rapidity under the disturbance of ω sin t γ n t if the adrc can resist the step response disturbance it can work on most occasions this is because this disturbance is the most destructive to a dynamic system 5 the self searching optimal control for the underwater thermal glider 5 1 the self searching optimal control method based on the td and adrc this section will combine the above minimum searching td and adrc to propose a self searching optimal adrc control method this method can optimize the control energy while achieving its anti disturbance control for the thermal glider the optimal and control effect is assistantly achieved by compensating for the external disturbance through adjusting its reference in advance this method regards the control variable as a function of the state error e reference v 0 t and disturbance ω t that is u t f e v 0 t ω t then the control energy can be expressed as u 2 t f 2 e v 0 t ω t thus the optimal control energy problem is to search a proper reference v 0 t and minimize the function u 2 t f 2 e v 0 t ω t according to the external disturbance it s an adaptive control process although the specific equation u 2 t f 2 e v 0 t ω t is unknown this function relationship does exist first the td based minimum searching method in sec 4 1 can be used to determine the optimal v 0 t next the optimal v 0 t is used to yield the control variable u t and resist the disturbance with the adrc method in sec 4 3 in turn the control energy u 2 t is optimized which adjusts the v 0 t according to the disturbance and self searching optimal adrc control method this principle is shown in fig 12 symbols also refer to eqs 14 15 19 22 and the self searching optimal adrc control method is as follows 1 arrange a transient process for the reference v 0 t according to the td of eqs 14 and 15 24 v 1 t 1 v 1 t h v 2 t v 2 t 1 v 2 t h f h a n v 1 t v 0 t v 2 t r 0 h 2 output the estimated system state z 1 z 2 and the total disturbance z 3 according to the eso of eqs 19 and 20 25 z 1 t 1 z 1 t h z 2 t β 01 e z 2 t 1 z 2 t h z 3 t β 02 f e u t z 3 t 1 z 3 t h β 03 f e 1 e z 1 t y t f e f a l e 0 5 h f e 1 f a l e 0 25 h 3 output the error e 1 the control variable u u t of the error feedback and the final control variable u t according to the nlsef and compensator of eqs 21 and 22 26 e 1 v 1 t z 1 t e 2 v 2 t z 2 t u u t f h a n e 1 c e 2 r h 0 u t u u t z 3 t b 0 4 calculate the u 2 t f 2 e v 0 t ω t derivative for optimization with an intermediate variable d t d u 2 t d v 0 t according to the outputs of two tds of eqs 14 and 15 27 u 01 t 1 u 01 t h u 02 t u 02 t 1 u 02 t h f h a n u 01 t u 2 t u 02 t r 1 h 1 28 v 01 t 1 v 01 t h v 02 t v 02 t 1 v 02 t h f h v f h a n v 01 t v 0 t v 02 t r 2 h 2 5 the non zero processing for v 02 t 29 v 02 t max a b s v 02 t 0 0001 s i g n v 02 t in it the max is a function to select and output the bigger value and s i g n is a sign function 6 then the new form of the intermediate variable d t and its filtering processing are 30 d t d u 2 t d v 0 t u 02 t v 02 t 31 d 1 t 1 d 1 t h d 2 t d 2 t 1 d 2 t h f h a n d 1 t d t d 2 t r 3 h 3 7 finally the reference v 0 t is revised according to the minimum searching method of eq 17 by substituting the results of eqs 30 and 31 into it that is v 0 t 1 v 0 t λ d u 2 t d v 0 t v 0 t λ d 1 t 32 v 0 t λ f a l d 1 t 0 1 0 001 where the nonlinear function f a l d 1 t 0 1 0 001 is used for a proper approximating speed it can improve the approximating speed when d 1 t is small and decrease the approximating speed when d 1 t is big 5 2 simulation and test preparing under a general numerical example example 3 suppose that there is a general controlled system 33 x 1 x 2 x 2 a 1 x 1 v 0 a 2 x 2 ω t u y x 1 in it a 1 2 0 a 2 1 0 the external disturbance is ω t sin t 20 the controller parameters are 34 β 01 100 β 02 300 β 03 1000 r 0 20 r 100 c 3 0 h 0 0 2 r 1 r 2 r 3 100 h 1 h 2 h 3 0 2 λ 0 0005 the constant v 0 2 is assumed as the system reference the aim is to resist the external disturbance ω t with an optimal control energy then eq 34 can be rewritten into 35 x 1 x 2 x 2 a 1 x 1 v 0 ω t a 1 a 2 x 2 ω t u y x 1 according to eq 35 if the reference is revised as v 0 ω t a 1 the control signal u 0 can still achieve its control purpose thus the self searching optimal adrc control is available and its simulation is shown in figs 13 15 the system can achieve its control effect fig 13 while the control signal is very small fig 14 and the reference can basically keep up with the disturbance change fig 15 5 3 the pitch angle keeping control during descent and ascent under current and noise disturbance based on the above general numerical example a further simulation for the thermal glider can be tested it s to evaluate the performance of the motion control system under the proposed self searching optimal adrc ocean current and noise disturbance now the controlled object is the thermal glider model of eqs 3 12 this model is similar to the slocum of sec 2 in size and its parameters are shown in table 1 only the pitch angle adjustment needs to be considered for the simulation in this paper this is because the buoyancy is only preset by twice timing operations of the three way valve a b c in fig 2 during a thermal cycle after the valve is switched the buoyancy changes according to eq 36 at the beginning of the descent or changes according to eq 37 at the beginning of the ascent this is also shown in fig 16 36 y 1 d 0 047 0 094 3 t 15 2 2 t 15 3 t 15 0 047 t 15 37 y 2 d 0 047 0 094 3 t 15 2 2 t 15 3 t 15 0 047 t 15 then the longitudinal position of the sliding mass in the glider is to be controlled the thermal glider should be kept at 23 23 pitch angle during its ascent descent under the ocean current and noise disturbance d t b 1 sin t r n d 0 5 5 in eq 13 1 first the 23 pitch angle keeping for the glider descent is taken for example and simulated at the initial time the steady state of the thermal glider is respectively θ 23 ω 2 0 deg s v 1 0 3 m s v 3 0 01 m s r p 1 0 02 m r p 1 0 m s m 0 0 047 kg the parameters of the self searching optimal adrc controller are set the same as eq 34 except for λ 0 0059 the simulation results are in figs 17 19 fig 17 shows that the glider can maintain at 23 descent pitch angle even under the ocean current and noise disturbance meanwhile fig 18 shows that the control signal and its energy is optimized and very small it is due to the optimal and control effect through compensation by adjusting the reference in advance as shown in fig 19 thus the control system has a good trajectory keeping performance with an optimized energy efficiency the truth is the control signal of the proposed controller totally depends on its added disturbance in the real ocean the disturbances to the thermal glider are much simpler and less than our assumed ones thus the control variable will not fluctuate sharply as in fig 18 and the effects should be automatically eliminated when the disturbance form changes or its frequency decreases such practice will neither increase the energy consumption nor reduce the mechanical life 2 then the state at 23 pitch angle during the glider ascent is taken for example and simulated at the initial time the steady state of the thermal glider is respectively θ 23 ω 2 0 deg s v 1 0 3 m s v 3 0 01 m s r p 1 0 02 m r p 1 0 m s m 0 0 047 kg the disturbance and controller parameters are set the same as the descent simulation the simulation results are shown in figs 20 22 it s very similar to the descent simulation and has the same principle which will not be repeated here 5 4 the pitch angle transition control between ascent and descent under current and noise disturbance when the thermal glider descends to the intended ocean depth it must be switched from descent to ascent and vice versa the longitudinal position of the sliding mass in the glider is still to be controlled the control system output is the pitch angle transition from 23 to 23 or from 23 to 23 under the simulated ocean current and noise disturbance of d t b 2 sin t 20 r n d 0 5 5 in eq 13 the steady state 1 of the 23 descent for the thermal glider is respectively θ 23 ω 2 0 deg s v 1 0 3 m s v 3 0 01 m s r p 1 0 02 m r p 1 0 m s m 0 0 047 kg the steady state 2 of the 23 ascent is respectively θ 23 ω 2 0 deg s v 1 0 3 m s v 3 0 01 m s r p 1 0 02 m r p 1 0 m s m 0 0 047 kg the desired pitch angle transition trajectory from 23 descent to 23 ascent is planed according to eq 39 the pitch angle transition from 23 to 23 is planed according to eq 40 this is also shown in fig 23 39 y 1 d 23 46 10 t 15 3 15 t 15 4 6 t 15 5 t 15 23 t 15 40 y 1 d 23 46 10 t 15 3 15 t 15 4 6 t 15 5 t 15 23 t 15 this section takes a continuous transition procedure for example in order to test the control ability of the proposed self searching optimal adrc controller this is because the steady glide segments of keeping descent and ascent have been tested in sec 5 3 thus the steady segments have been omitted in this test by initializing the glider model after each transition that is at first the pitch angle of the thermal glider changes from 23 to 23 when finished the glider model is immediately initialized into the steady state 2 then it changes from 23 to 23 when finished the glider model is immediately initialized into the 23 steady state 1 the test continues to repeat this cycle the model and controller parameters are set the same as in sec 5 3 the invariant controller parameters adaptive to different motion and disturbance are necessary for the online control of the thermal glider the glider can obtain a robust performance without even revising its parameter online otherwise the online adjusting will make the controller very difficult to be used the simulation results are in figs 24 26 fig 24 shows that the glider can make a continuous transition between the two equilibrium states according to the desired transition trajectory of eqs 39 and 40 or fig 23 under the ocean current and noise disturbance meanwhile fig 25 shows that the control signal and its energy is optimized and very small it is due to the optimal and control effect through compensation by adjusting the reference in advance as shown in fig 26 thus the control system also has a good trajectory tracking performance with an optimized energy efficiency as the controller parameters are kept invariant for the simulation in sec 5 3 and 5 4 the proposed self searching optimal adrc is also a successful adaptive control method compared with ref santhakumar and asokan 2013 townsend 2016 these energy efficient results are only based on the self searching optimal adrc method and there is no need to revise the thermal glider design compared with ref sarkar et al 2016 these methods probably have a much smaller control signal to resist the disturbance the superiority lies in that the minimum searching td searches for the optimal control signal while the adrc achieves the anti disturbance control effect thus it takes much less energy to resist the disturbance by assistantly adjusting the reference in advance than by only changing the control output and adjusting the actuator with the adrc or pid to sum up the control system is characterized by its good steady and dynamic effect and also good anti disturbance and adaptive performance besides the control signal required to maintain and track the output trajectory is small which consumes low control energy all these make it a better control strategy 6 discussion and conclusion this paper proposes a self searching optimal adrc control method for the pitch angle control of an underwater thermal glider in the vertical plane motion under disturbance firstly the working and control principle of the thermal glider is given and the coordinate system and variables of the glider are defined based on this the mathematical motion model is built for a performance test then a minimum searching method based on the td and the adrc control method are demonstrated a self searching optimal adrc control method is proposed and demonstrated thereafter with this method the external disturbance can be compensated by adjusting the reference in advance which makes the required control signal optimized and small finally this method is used for the pitch keeping control of the glider during its 23 descent 23 ascent and its posture transition control between the 23 descent and 23 ascent the results show that the control system has a good steady and dynamic effect under a simulated ocean current and noise disturbance it can resist the disturbance and maintain a good adaptive performance in addition the control system can achieve a energy efficient control effect the control signal required to be kept at 23 descent 23 ascent and track its transition trajectory is much smaller then the required control energy is also much lower since the thermal glider carries a limited power saving energy means an increased endurance this has a great significance in regards to the marine survey or military purpose for the thermal glider besides the control algorithm is also simple all these make it a better control strategy acknowledgments this work is supported by the nsfc projects of china under grant no 61403250 no 51779136 no 51509151 the bureau project of china under grant no 2015ht056 and the science commission of shanghai under grant no 13510501600 
23362,a newly developed three dimensional multi domain high order boundary element method mdhobem is applied to solve time domain ship motions in waves for ships advancing with forward speed as well as the corresponding added wave resistances by the method fluid domain is decomposed by a regular control surface into inner and outer parts in which rankine panel method and transient green function method are adopted respectively by the mdhobem the problem of highly oscillatory nature of transient green function near waterline can be avoided due to substitution of rankine source in inner domain fewer discrete quantities than in rankine panel method is needed as transient green function is employed in outer domain and the radiation condition can be analytically satisfied as well boundary value problem of velocity potential is solved in a translational and inertial frame without use of moving mesh implying it is a highly efficient approach a mixed form of ship wave linearized or double body flow linearized free surface condition and the according m terms are employed in inner domain to treat the steady flow effects more accurately the yielding hybrid boundary integral equations are discretized with bi quadratic isoparametric high order elements to minimize discretization error a fortran code is originally developed and is used to simulate wave body interactions of both the wall sided and flared hulls including mathematical wigley 3 hull series60 and more realistic hull forms of kcs and s175 convergence of spatial and temporal discretization and size of inner domain are detailedly investigated beforehand results indicate the present numerical scheme has quite good robustness and the inner free surface can be reduced to a rather small region comparing to rankine panel method the computed hydrodynamic coefficients added wave resistance and ship motions by mdhobem are compared with model test data and results of classic boundary element methods including rankine panel method transient green function method and translating and pulsating green function method it manifests the mdhobem has quite good accuracy and needs less computational cost keywords multi domain hobem time domain ship motion forward speed added wave resistance 1 introduction in ship design stage reliable predictions of ship motion responses in waves wave loads structural loads and added wave resistance are imperative for hull form and structural design it is more convenient to adopt numerical methods in ship seakeeping analysis for the large scale wave ship interaction problems of semi infinite domain application of potential flow theory is more efficient and plays important role for practical engineering problem than rans simulation early numerical method to compute ship swaying motions is developed by korvin kroukovsky 1955 who introduced concept of slender body in aerodynamics and came up with strip theory tasai 1967 ogilvie and tuck 1969 salvesen et al 1970 in the following proposed new strip theory rational strip theory and the well known stf method which are more complete these methods have been used in hydrodynamic computations for a long time whereas there are certain limitations on account of the assumption that flow is constrained in two dimensional sections in the strip theory so accurate results are obtained just for slender ships and the cases shall meet the requirement of high frequency and low speed assumptions three dimensional theory can overcome the obstacle in strip theory since havelock 1942 derived three dimensional frequency domain pulsating source green function problem of wave body interactions at zero speed has been well studied by scholars like faltinsen and michelsen 1974 newman 1999 and others who used free surface green function method problems with respect to ship motions with steady forward speed would be more complicated although the three dimensional translating and pulsating source 3dtp green function was derived by haskind 1946 long ago the application in ship motions computation is studied until recent decades one reason is that numerical evaluation of the green function is much more complicated and highly time consuming in contrast to pulsating source kim and shin 2007 hong et al 2016 yao and dong 2016 respectively studied solution methods of 3dtp and then computed seakeeping of ship advancing in waves by applying the green function chen and wu 2001 investigated the behavior of a point source pulsating and advancing at a uniform forward speed the research confirmed that the green function shows singular and highly oscillatory behavior near free surface this is another intrinsic problem of the method which is responsible for numerical instability or even divergence for ships with flare and also for flat hulls apart from the frequency domain computation an alternative choice is to use transient green function in time domain simulation bingham 1994 qiu and peng 2013 sengupta et al 2016 have conducted related researches challenge of the time domain free surface green function method still lie in the efficient and stable numerical evaluation of transient green function moreover there is another deficiency that both the frequency and time domain free surface green functions are derived with neumann kelvin linearized free surface condition which cannot take account of interactions with the steady ship wave or the stationary double body flow using the rankine panel method which employs fundamental solution of 1 r of the laplace equation as green function can avoid problems involved in free surface green function method integrals of 1 r over boundaries are easier to compute besides any form of boundary conditions but not only the neumann kelvin linearized conditions can be imposed in the numerical method studies of frequency and time domain ship seakeeping predictions by applying the rankine panel method have been carried out by lots of scholars for example of nakos and sclavounos 1990 kring 1994 kim and kim 2010 zhang et al 2010 söding et al 2012 and others however the feature of 1 r that does not satisfy any boundary conditions creates other problems infinite fluid field must be truncated at a limited distance as singularities are required to be distributed on all boundaries this may bring truncation errors moreover additional conditions should be imposed to meet the radiation condition the most favorable approach in recent researches is to add artificial damping in outer layer of free surface usually a distance of one wave length in this case free surface range should not be too small free surface size is generally set as several wavelengths or ship lengths by experience therefore plenty of mesh discretization on free surface results in massive quantity of unknowns to the boundary integral equation and consequently computational efficiency would be reduced a reasonable solution is to combine free surface green function method and rankine panel method which is also the recent development the yielding multi domain or hybrid boundary element method shall take advantages of the classic approaches by this method flow domain is decomposed into two parts by a virtual control surface close to ship and rankine source and free surface green function are applied in inner and outer parts respectively one merit of the method is that integrals of free surface green function on the vertical matching surface is easy to evaluate moreover free surface green function automatically satisfies radiation condition so inner free surface can be reduced to a very small region as seen in fig 1 which is comparison of general mesh discretization of rankine panel method and multi domain method zhang et al 1998 solved heave and pitch motions of non wall sided body with hybrid boundary element method in time domain duan and dai 1999 studied on the same method while they set up the vertical control surface crossing to waterline making the method not applicable for ship with bulb kataoka and iwashita 2004 liu and papanikolaou 2011 carried out time domain simulation of linear radiation and diffraction problems in the earth fixed frame to avoid horizontal spatial derivatives of velocity potential in the free surface condition whereas the numerical scheme is time consuming as free surface mesh varies with time tang et al 2014 modeled ship wave interactions in the reference frame which translates with ship and calculated ship motions by multi domain constant bem however they employed neumann kelvin linearized free surface condition in inner domain and adopted simplified m terms which may provide satisfactory results only for slender bodies in the present study a three dimensional multi domain high order boundary element method mdhobem is developed to compute time domain ship motions with and without forward speeds as well as added wave resistance by this method a vertical control surface close to ship is employed to divide the fluid domain into inner and outer parts in which rankine panel method and transient green function method are applied respectively some progress and improvements on previous methods are made in this work the unsteady disturbance potential involving both radiation and diffraction components are solved directly without the use of impulse response function as in study of tang et al 2014 liu and papanikolaou 2011 in this case the ship wave linearized or double body flow linearized free surface condition and the corresponding m terms can be applied to the inner domain to consider the steady flow effects more accurately which is shown in the following sections to be effective in improving results in the outer domain transient green function is evaluated with the practical tabulation and interpolation method incorporated with solving ordinary differential equations ode which is highly efficient the corresponding hybrid boundary integral equation is discretized with a hobem based on bi quadratic isoparametric elements moreover added wave resistance is computed by the near field pressure integration method and different components of added wave resistance are analyzed a numerical program is coded with fortran it is applied to compute hydrodynamic forces and motions of both wall sided and flared ships for validation detailed convergence studies for ship motion computations by mdhobem with respect to spatial and temporal discretization as well as boundary size are conducted beforehand the numerical analysis implies quite good robustness of the present numerical scheme the computed results involving added mass and damping coefficients ship motions relative motions of free surface and added wave resistance at various frequencies together with results obtained by other numerical methods including rankine panel method formulated and programed in this study as well transient green function method and translating and pulsating source green function method are compared with related model test data it demonstrates the present mdhobem is more advanced and can improve results 2 mathematical and numerical formulation of multi domain hobem in time domain 2 1 coordinate system and flow decomposition an inertial frame o xyz which translates with constant forward speed u is used in computation xoy plane is on still water level ox axis points to bow and oz axis is vertically upward in computation fluid domain is decomposed into inner domain i and outer domain ii by a virtual control surface s c as shown in fig 2 inner domain is bounded by body surface s b inner free surface and control surface s c outer domain is enclosed by control surface s c the remaining free surface and an infinite control surface s rankine panel method that is valid for ship with flare is applied to inner domain since the elementary source would not oscillate near free surface besides more accurate free surface conditions rather than neumann kelvin n k linearized form can also be used with rankine panel method in domain ii transient green function method is adopted it satisfies n k linearized free surface condition and radiation condition dirichlet and neumann conditions are imposed on control surface to maintain continuous velocity potential and its normal derivative in two domains flow chart of multi domain method are shown in fig 3 2 2 governing equations the fluid is assumed to be homogeneous incompressible and inviscid and the flow is irrotational velocity potential satisfies laplace s equation 1 2 φ 0 total velocity potential can be regarded as the summation of steady and time varying components as shown below 2 φ x y z t u x φ x y z φ 0 x y z t φ d x y z t where ux is uniform stream φ is steady flow potential which satisfies the following boundary conditions 3 s b φ n u n x s f z 0 φ n 0 f o r d o u b l e b o d y f l o w u 2 g 2 φ x 2 φ z 0 f o r s h i p w a v e where n is normal vector pointing out of fluid domain and subscript x denotes x component φ 0 is incident wave potential for regular wave of infinite water depth it is expressed by 4 φ 0 g ζ a ω e k z sin k x u t cos β k y sin β ω t where ζ a is wave amplitude g represents gravitational acceleration k denotes wave number ω is circular frequency and β is wave angle as defined in fig 2 the boundary value problem of φ d is shown in the following sections 2 2 1 boundary value problem of φ d in domain i boundary conditions of φ d in inner domain is presented below 5 s f ι t u φ ζ d φ d z 2 φ z 2 ζ d φ ζ a s f ι t u φ φ d g ζ d φ φ 0 u φ 1 2 φ φ s b φ d n j 1 6 ξ j n j ξ j m j φ 0 n s c ι φ d ι φ d ι ι φ d ι n φ d ι ι n initial condition φ d 0 φ d t 0 the ship wave linearized swl and double body flow linearized dbl free surface condition are employed in this work as they can provide more accurate results of hydrodynamic forces and ship motions where steady ship wave is solved by rankine source method this is an improvement of some of previous studies like tang et al 2014 who adopted neumann kelvin linearized free surface condition in internal domain time marching of free surface condition is by applying the mixed euler lagrange scheme in body boundary condition ξ 1 6 denotes six freedom ship motions n 1 n 2 n 3 n and n 4 n 5 n 6 r n are unit normal vectors m j terms are computed by the following formulas 6 m 1 m 2 m 3 n u φ m 4 m 5 m 6 n r u φ where φ stands for steady disturbance potential and ship wave and double body flow potential are used in the present work the second order derivatives of velocity potential are evaluated numerically by hobem referring to shao 2010 on the control surface dirichlet and neumann conditions should be imposed to ensure flow velocity potential and normal velocity are continuous 2 2 2 boundary value problem φ d in domain ii in outer domain φ d should satisfy the following boundary conditions 7 s f ι ι t u x 2 φ d g φ d z 0 s c ι ι φ d ι ι φ d ι φ d ι ι n φ d ι n s φ d 0 φ d n 0 φ d 0 initial condition φ d 0 φ d t 0 as transient green function is used in outer domain the free surface condition should be neumann kelvin linearized form which is linearization about uniform stream ux a problem is that the condition is inconsistent with ship wave or double body flow linearized free surface condition adopted in inner domain to deal with the difficulty a transition zone is set on the end of inner free surface to gradually damp the steady potential φ with respect to rectangular free surface values of steady potential in transition zone are defined as the follows 8 φ φ x x 0 2 x r x 0 2 1 x x 0 φ φ y y 0 2 y r y 0 2 1 y y 0 where x 0 and y 0 represent starting points of the transition region x r and y r are coordinates of edge of free surface within a certain range variation of size of the transition zone would not affect numerical results because the steady potential φ is merely significant in the vicinity of ship in the present computations characteristic length of the transition zone is set as 5 of ship length 2 3 boundary integral equations 2 3 1 boundary integral equations of domain i rankine panel method is applied in inner domain with green second identity a mixed boundary integral equation is established 9 α p φ d ι p t s f ι s b s c φ d ι q t n q 1 r φ d ι q t n q 1 r d s q where p and q represent field and source points respectively n q is normal vector pointing to outside of inner domain 1 r is rankine source green function and r is distance between field and source points 10 r x q x p 2 y q y p 2 z q z p 2 in addition α in equation 9 stands for solid angle which is computed by an indirect method in the present paper by substituting φ d in equation 9 with uniform potentials the following formula for computing α can be derived 11 α p s f ι s b s c n q 1 r d s q 2 3 2 boundary integral equations of domain ii transient green function method is used in outer domain hence singularities are required to be distributed only on control surface the mixed boundary integral equation is written as 12 α p φ d ii p t s c φ d ii q t g 0 n q φ d ii q t n q g 0 d s q 0 t d τ s c φ d ii q τ g n q φ d ii q τ n q g d s q u 2 g 0 t d τ γ 0 φ d ii q τ g x q φ d ii q τ x q g n 1 d l u g 0 t d τ γ 0 φ d ii q τ g τ φ d ii q τ τ g n 1 d l it should be noted that normal direction of control surface are in consistence with inner domain so normal vectors point to the inside of outer flow field as a result the bie of the two domains should have different signs in equation 12 γ 0 denotes the intersecting line of free surface and vertical control surface g 0 and g are instantaneous and memory terms of transient green function the expressions are presented below 13 g 0 1 r 1 r 14 g p t q τ 2 0 g k e k z p z q j 0 k r sin g k t τ d k where 1 r is image source of 1 r about z 0 j 0 represents the first kind of zero order bessel function r is horizontal distance between source and field points 15 r x q τ x p t u t τ 2 y q τ y p t 2 there are difficulties in numerical evaluation of transient green function researchers have paid great efforts to improve computational stability and efficiency in the past few decades huang 1992 proposed a fast approach by tabulation and interpolation clement 1998 obtained solution of transient green function through solving fourth order ordinary differential equation zhu et al 2007 incorporated the two approaches and came up with a practical numerical method which is also adopted in the present study 2 4 hobem discretization to discretize the hybrid boundary integral equation a high order boundary element method hobem based on bi quadratic shape functions are applied comparing with constant panel method cpm hobem can construct continuous distribution of velocity potential and its normal derivative over boundaries as well as high order distribution of variables in elements moreover curved panels would minimize the gaps between elements the 9 nodes isoparametric panel used in this study is shown in fig 4 an arbitrary variable ψ in panel can be expressed by the following formula 16 ψ j 1 9 n j ξ η ψ j where n k ξ η is 9 node shape function subscript j denotes local nodal index with the above relation spatial derivatives can be conveniently solved 17 ψ x ψ y ψ z t j 1 ξ η ψ ξ ψ η ψ n t where j ξ η is jacobi matrix derivatives with respect to parametric coordinate ξ η are computed by 18 ψ ξ η j 1 9 n j ξ η ξ η ψ j substituting equation 16 into boundary integral eqs 9 and 12 and choosing collection points as nodes of panels discretized hybrid boundary integral equations can be derived 19 h b b ι a b b ι h b c ι a b c ι h f b ι a f f ι h b c ι a b c ι h c b ι a c f ι h c c ι a c c ι 0 0 h c c ii a c c ii φ d b φ d f n φ d c φ d c n a b b ι h b b ι 0 0 a f b ι h f f ι 0 0 a c b ι h c f ι 0 0 0 0 0 0 φ d b n φ d f 0 0 0 0 0 m e t c where h and a are sub matrixes of influence coefficients subscripts b f and c represent body free and control surfaces respectively since φ d and φ d n are both unknown variables on control surface total size of the equation is n b n f 2 n c influence coefficients are computed by the following formulas 20 a i j ι p 1 n p k 1 9 δ i n d p k j 1 1 1 1 1 r n k ξ η j ξ η d ξ d η 21 h i j ι δ i j α i p 1 n p k 1 9 δ i n d p k j 1 1 1 1 n 1 r n k ξ η j ξ η d ξ d η 22 a i j ι ι p n p b n p f 1 n p k 1 9 δ i n d p k j 1 1 1 1 g 0 n k ξ η j ξ η d ξ d η 23 h i j ι ι δ i j α i p n p b n p f 1 n p k 1 9 δ i n d p k j 1 1 1 1 g 0 n n k ξ η j ξ η d ξ d η where n p n pb n pf n pc represents total number of panels k is local nodal index in a panel ξ and η are two orthogonal isoparametric variables ranging from 1 to 1 δ denotes dirac delta function ind p k signifies global index of k th node in p th panel memory term in right side of the boundary integral equation is expressed as 24 m e t i δ t k 1 n p 1 n p c j 1 9 1 1 1 1 φ d ii j t k g t n t k n φ d ii j t k n g t n t k n j ξ η j ξ η d ξ d η δ t k 1 n l 1 n l c j 1 3 u 2 g 1 1 φ d ii j t k g t n t k x q φ d ii j t k x q g t n t k n l j ξ j ξ d ξ δ t k 1 n l 1 n l c j 1 3 u g 1 1 φ d ii j t k g t n t k τ φ d ii j t k τ g t n t k n l j ξ j ξ d ξ to solve the boundary integral equation either gaussian elimination or iterative method like bicg and gmres can be employed due to the translational frame used in this work influence coefficients are same at each time step consequently a direct matrix solver is more efficient and is adopted 2 5 equations of ship motions applying newton s second law can yield six freedom ship motion equations 25 m i j ξ t j c i j ξ t j f ξ ξ t i i j 1 6 where m ij and c ij are mass and restoring coefficients respectively noting that artificial soft springs should be added in the three degrees of freedom in horizontal plane to provide restoring forces time varying hydrodynamic forces and moments are evaluated by pressure integrals 26 f 1 f 2 f 3 s b p 0 p d n d s f 4 f 5 f 6 s b p 0 p d r r g n d s where p 0 is incident wave pressure and p d denotes pressure due to unsteady disturbance flow hydrodynamic pressure can be computed by bernoulli s equation 27 p ρ φ t ρ u φ φ where φ represents total unsteady potential the partial derivatives of velocity potential in bernoulli s equation are solved by eqs 17 and 18 added mass and damping coefficients can further be obtained by forced motion computations if harmonic forced ship motion has frequency ωe and amplitude ξ the radiation force would be expressed by the following equation 28 f i r ω 2 a i j ω e i ω b i j ω e ξ j e i ω e t added mass a ij and damping coefficient b ij can then be solved 29 a i j ω e re f i r ω e 2 ξ j b i j ω e im f i r ω e ξ j 2 6 added wave resistance added wave resistance is also investigated in the present study as it is the key parameter for estimating meteorological factor of energy efficiency design index eedi so it is non negligible for the determination of suitable ship propulsion power added wave resistance in fact is longitudinal component of mean drift force to evaluate added wave resistance both near field joncquez 2009 kim and kim 2011 and far field methods hong et al 2016 can be adopted the near field approach is used in this work for it does not require a far control surface referring to joncquez 2009 the equation of second order forces can be derived by perturbation expansion and retaining second order terms the yielding equation is 30 f 2 ρ s b 1 2 φ φ n d s a ρ s b ξ t ξ r r φ t u φ φ n d s b ρ ξ r n s b ξ t ξ r r u φ 1 2 φ φ d s c ρ ξ r n s b φ t u φ φ d s d ρ ξ r n s b g ξ 3 ξ 4 y ξ 5 x d s e ρ s b h r g z u φ 1 2 φ φ n d s ρ s b g z u φ 1 2 φ φ h n d s f 1 2 ρ g w l ζ ξ 3 ξ 4 y ξ 5 x 2 n sin α d l g ρ w l u φ 1 2 φ φ ζ ξ 3 ξ 4 y ξ 5 x ξ r n sin α d l h where φ is the total unsteady potential including incident and disturbance components h is second order transformation matrix ξ t and ξ r denote translational and rotational displacement vectors respectively α represents angle of hull flare at water plane an advantage of near field method is that different components of second force can be investigated in detail kim and kim 2011 in the present study the second order force is decomposed according to different physical character components a h in the above equation correspond to a pressure induced by square of flow velocity b coupling between gradient of first order pressure and first order motion c rotational effect of coupling term of steady pressure gradient and first order motion d rotational effect of first order force e rotational effect of first order motion f contributions related to second order position and normal vector g contributions of relative free surface elevation water line integral h rotational effect of coupling term of steady pressure gradient and relative free surface elevation water line integral the main difficulty of near field method is to compute second order derivatives as hobem is adopted the second order spatial derivatives can be evaluated directly on high order panels by using chain rule 3 results and discussions a numerical program of three dimensional multi domain high order boundary element method mdhobem is originally developed it is applied to compute hydrodynamic coefficients motions and added resistance of different hulls advancing in waves numerical issues of convergence of the method are detailedly discussed computed results are compared with model test data and results of classic bem including rankine panel method translating and pulsating green function method and transient green function method followed by discussions 3 1 numerical example the modified wigley 3 hull journée 1992 series60 hull with block coefficient cb 0 7 kcs container ship and s175 container ship are employed as numerical example the wigley 3 is wall sided near free surface while the other three ships have flare principle dimensions of the four types of hull forms are shown in table 1 for wigley 3 and s60 only double body basis flow are considered in motion computations while for the more realistic kcs and s175 the steady ship wave linearized free surface conditions and the according m terms are employed in addition hull form of wigley 3 is defined by the following formula 31 y b 2 1 z d 2 1 2 x l 2 1 0 2 2 x l 2 geometry model of mean wetted surfaces of s60 kcs and s175 are shown in fig 5 7 computational domain and panel arrangement are shown in fig 8 in which variables l up l down l width signify length of free surface upstream downstream and in width respectively h c is depth of control surface n l and n w stand for number of grid nodes distributed in longitudinal and lateral 3 2 convergence study on domain size mesh density and time step convergence tests for spatial and temporal discretization are carried out the wigley 3 model is adopted as numerical example and time histories of heave and pitch motions at fn 0 2 are computed with different discrete parameters figs 9 and 10 show results of different free surface sizes l down l up l width figs 11 and 12 show converged results with respect to free surface mesh quantity n f figs 13 and 14 are results computed with disparate depths of control surfaces h c in addition convergence with respect to time step length δt which is defined by number of time steps divided by encounter wave period are presented in figs 15 and 16 these figures illustrate robustness of the present numerical scheme which is insensitive to discretization parameters results also indicate methods in different domains are well matched and inner domain can be limited to a quite small region time histories of heave and pitch motions can converge with the increasing of internal domain size and number of panel discretization as well as the reduction of length of time step in view of both the accuracy and efficiency the recommended parameters for temporal and spatial discretization of the present numerical method are δt t 100 n f 1071 l down l up l width 0 4l and h c 3d 3 3 added mass and damping coefficients forced motions of the wigley 3 and s60 ships advancing in head waves are simulated by the present mdhobem fig 17 20 show added mass and damping coefficients due to heave and pitch motions of the wigley 3 hull computations by rankine panel method in conjunction with the double body flow linearized dbl method and the uniform stream linearized usl method the so called neumann kelvin linearization are also performed in this work as for comparison legend tpgreen in the figures represents result by using three dimensional transiting and pulsating green function method kim and shin 2007 numerical results of the mdhobem and rankine dbl are in quite good agreements with experiments journée 1992 and have higher accuracy than rankine usl practically in low frequency regime where the effects of steady flow are significant the present multi domain method by imposing double body flow linearization in inner domain can improve results of hydrodynamic coefficients in comparison to the tpgreen curves of the mdhobem are quite smooth in high frequencies and conform to measured data some fluctuations are observed on results of the tpgreen when non dimensional frequency is larger than about 4 hydrodynamic coefficients of s60 are shown in figs 21 and 22 results computed by the present mdhobem are in better than that by transient green function method bingham 1994 agreement with model test data gerritsma and beukelman 1963 pitch pitch added mass and damping coefficients solved by the transient green show slight oscillation characteristic over frequencies the mdhobem is shown to have better accuracy as well as stability in general than the free surface green function methods of the tpgreen and the transient green 3 4 free motions in head waves free motions of the wigley 3 and s60 hull advancing in head waves are computed figs 23 and 24 depict heave and pitch motions rao of the wigley 3 at zero speed which are obtained by fourier series expansions of time history curves computational results by the mdhobem rankine panel method and transient green function method zhu 2009 are comparable since boundary conditions of the three method are consistent when fn 0 it should be noted that for zero speed computations inner free surface size can be reduced to an even smaller region than in forward speed condition due to the same free surface condition in two domains and also the vanish of spatial derivatives in free surface condition fig 25 28 show heave and pitch motions rao of the wigley 3 at fn 0 2 and 0 3 of the present mdhobem computation in contrast to the rankine panel method the transient green zhu 2009 the tpgreen kim and shin 2007 and experimental data journée 1992 results of both amplitude and phase angle solved by the mdhobem are quite satisfactory as seen from figs 25 and 26 the mdhobem has generally better accuracy than the transient green and peak value of heave motion by the mdhobem is slightly lower and closer to the model tests than by the rankine dbl at higher speed fn 0 3 the mdohbem also shows generally better accuracy than the rankine dbl and the tpgreen the relative motions s a ζ ξ 3 xξ 5 between free surface and the wigley 3 hull at x 0 35 l computed by the mdhobem are shown in figs 29 and 30 the computational froude numbers are 0 2 and 0 3 it can be observed from the figures that the present results of the mdhobem agree better with experimental data than the results solved by strip theory journée 1992 so the mdhobem does not only have high accuracy in computing ship motions but also in the simulation of free surface flow motions of s60 computed by the mdhobem and the rankine dbl in comparison to model test gerritsma et al 1974 are presented in figs 31 and 32 smooth rao curves are obtained by the mdhobem it shows the method is robust in computing motions of the non wall sided hull by contrast free surface green function method is instable for flared ships fig 33 36 are heave and pitch motions of kcs container ship at fn 0 26 and 0 33 label swl and dbl in these figures mean that steady ship wave linearized and double body flow linearized free surface conditions and the according m terms are used in computations respectively it can be seen that at fn 0 26 the computed motions by both the mdhobem swl and mdhobem dbl are in accordance with measured data simonsen et al 2013 however at higher speed fn 0 33 heave and pitch motions computed by the mdhobem swl are more accurate than by the mdhobem dbl the reason is that steady wave generated by a ship at high speed is significant especially for realistic hull with bulbous bow like kcs as shown in fig 37 the actual steady ship wave potential is quite different with double body potential of kcs at fn 0 33 consequently effects of steady flow on unsteady ship motions are more notable and using double body flow as basis flow can no longer provide accurate computations of ship motions to sum up the present mdhobem shall provide more accurate prediction results of heave and pitch in comparison to free surface green function methods since it can concern steady flow effects more precisely by employing ship wave or double body flow linearization in inner domain likewise the mdhobem also has slightly higher accuracy than the rankine dbl in addition comparing to rankine panel method size of computational domain and quantity of mesh discretization are reduced quite a lot and no additional artificial conditions like damping terms which may have detrimental effects on results are required to be imposed in boundary conditions in addition the mdhobem is valid for different types of hull forms 3 5 motions of s175 in oblique and beam waves motions of s175 in oblique and beam waves are computed by using the mdhobem in prediction of roll motion the viscous roll damping b 44 of is determined from numerical test of free decay of roll motion which is carried out by using commercial cfd software starccm following wilson et al 2006 time history curve of the roll angle can be fitted by the equation ξ 4 a d e i 1 n β i t i cos ω d t where ω d is the natural frequency of the roll motion a d is amplitude and β i represents the i th order of the damping coefficients after getting β i the equivalent linearized roll damping can be computed by energy method non dimensional roll damping of s175 adopted in the present study is b 44 b 44 m b 2 b 2 g 0 0045 numerical results of heave roll and pitch of s175 at fn 0 275 in comparison with experimental data ittc seakeeping committee 1978 are shown in fig 38 42 wave angles in computations are 150 120 and 90 the computed motions rao of s175 are in quite good agreement with experiments in different wave directions the swl is slightly more accurate than the dbl in the computation of roll motion of s175 numerical results indicate the present method is accurate in prediction of ship motions in oblique and beam waves 3 6 added wave resistance fig 43 shows time series of longitudinal second order wave force of the wigley 3 in regular head wave as can be seen the curve is smooth and regular implying the present numerical scheme is stable in computing near field pressure integrals similar with hydrodynamic coefficients results of the mdhobem and rankine dbl show less difference added wave resistance shall be obtained by averaging the time history of second order force figs 44 and 45 depict added wave resistance of wigley 3 at fn 0 2 and 0 3 fig 46 shows added wave resistance of s60 at fn 0 222 figs 47 and 48 are added wave resistance of s175 at fn 0 2 and 0 3 for numerical investigation results computed by the present mdhobem are compared with model test data journée 1992 strom tejsen et al 1973 fujii and takahashi 1975 nakamura and naito 1977 and results by other potential flow methods including rankine panel method kim and kim 2011 frequency domain transiting and pulsating green function method hong et al 2016 frequency domain pulsating green function method with speed correction hong et al 2016 and strip theory journée 1992 the present numerical results show good agreements with experimental data and both peak value and resonance frequency are well predicted in addition the present mdhobem show overall higher accuracy than other numerical methods however each of the potential flow methods compute smaller added resistance of s60 and s175 in short waves where the effects of diffracted waves are significant nonlinear features of flow like bow wave swell up may explain the difference proportions of different components in total added wave resistance of s60 and s175 are also investigated results are shown in figs 49 and 50 it can be seen that component g which is contribution of relative wave elevation in water line integral is dominant in r aw for different hulls at different speeds this is also verified by kim and kim 2011 component a related to square of flow velocity also takes a main proportion in r aw components b d and e which are coupling of first order motions with gradient of first order pressure and rotational effects of first order force and motion are significant as well by contrast component f related to second order position and normal vector as well as terms c and h involving gradient of steady pressure are negligible 3 7 wave contours contours of unsteady radiated and scattered free surface waves of the wigley 3 s60 and kcs at different forward speeds and wave lengths are depicted in fig 51 56 numerical results of the mdhobem and rankine panel method are in quite favorable agreement no reflected waves are found from borders of the inner domain as plotted in the lower images of the figures it indicates the present mdhobem can successfully match flow of different domains moreover by applying transient green function in the exterior domain the mdobem uses much smaller discretized region to simulate flow motions in comparison to rankine panel method 4 conclusions a three dimension multi domain high order boundary element method which combines rankine panel and transient green function methods is developed to simulate time domain motions and added resistance of ship advancing in waves the ship wave and double body flow linearization are adopted in the inner domain for solving time domain diffraction and radiation problems with forward speed by the mdhobem problem of highly oscillatory nature of transient green function near waterline and limitation of neumann kelvin linearized condition in derivation of free surface green function can be avoided due to substitution of rankine source in inner domain moreover fewer discrete quantities than in rankine panel method are needed and radiation condition can be analytically satisfied a fortran program is originally developed and validation studies are carried out for different type of hulls over various frequencies conclusions can be drawn by numerical investigations 1 the numerical scheme is shown to be quite robust by convergence study of spatial and temporal discretization methods in different domains are well matched and inner domain can be limited to a quite small region about 0 4 times of ship length for problem with forward speed and even smaller in case of zero speed 2 the computed added mass damping coefficients and motions and added wave resistance of different ships are in quite good agreement with experimental data in comparison to classic bem methods including transient green translating and pulsating green and rankine panel methods mdhobem shows generally higher accuracy and efficiency 3 the developed mdhobem is also more robust than free surface green function methods and needs less panels than rankine panel method in solving seakeeping problems it also has advantages in extension to fully nonlinear computations acknowledgement this work has been supported by national natural science foundation of china nsfc grant no 51479117 51579147 advance research program of china no 41407010202 and program of state key laboratory of ocean engineering collaborative innovation center for advanced ship and deep sea exploration sjtu china no gkzd010071 
23362,a newly developed three dimensional multi domain high order boundary element method mdhobem is applied to solve time domain ship motions in waves for ships advancing with forward speed as well as the corresponding added wave resistances by the method fluid domain is decomposed by a regular control surface into inner and outer parts in which rankine panel method and transient green function method are adopted respectively by the mdhobem the problem of highly oscillatory nature of transient green function near waterline can be avoided due to substitution of rankine source in inner domain fewer discrete quantities than in rankine panel method is needed as transient green function is employed in outer domain and the radiation condition can be analytically satisfied as well boundary value problem of velocity potential is solved in a translational and inertial frame without use of moving mesh implying it is a highly efficient approach a mixed form of ship wave linearized or double body flow linearized free surface condition and the according m terms are employed in inner domain to treat the steady flow effects more accurately the yielding hybrid boundary integral equations are discretized with bi quadratic isoparametric high order elements to minimize discretization error a fortran code is originally developed and is used to simulate wave body interactions of both the wall sided and flared hulls including mathematical wigley 3 hull series60 and more realistic hull forms of kcs and s175 convergence of spatial and temporal discretization and size of inner domain are detailedly investigated beforehand results indicate the present numerical scheme has quite good robustness and the inner free surface can be reduced to a rather small region comparing to rankine panel method the computed hydrodynamic coefficients added wave resistance and ship motions by mdhobem are compared with model test data and results of classic boundary element methods including rankine panel method transient green function method and translating and pulsating green function method it manifests the mdhobem has quite good accuracy and needs less computational cost keywords multi domain hobem time domain ship motion forward speed added wave resistance 1 introduction in ship design stage reliable predictions of ship motion responses in waves wave loads structural loads and added wave resistance are imperative for hull form and structural design it is more convenient to adopt numerical methods in ship seakeeping analysis for the large scale wave ship interaction problems of semi infinite domain application of potential flow theory is more efficient and plays important role for practical engineering problem than rans simulation early numerical method to compute ship swaying motions is developed by korvin kroukovsky 1955 who introduced concept of slender body in aerodynamics and came up with strip theory tasai 1967 ogilvie and tuck 1969 salvesen et al 1970 in the following proposed new strip theory rational strip theory and the well known stf method which are more complete these methods have been used in hydrodynamic computations for a long time whereas there are certain limitations on account of the assumption that flow is constrained in two dimensional sections in the strip theory so accurate results are obtained just for slender ships and the cases shall meet the requirement of high frequency and low speed assumptions three dimensional theory can overcome the obstacle in strip theory since havelock 1942 derived three dimensional frequency domain pulsating source green function problem of wave body interactions at zero speed has been well studied by scholars like faltinsen and michelsen 1974 newman 1999 and others who used free surface green function method problems with respect to ship motions with steady forward speed would be more complicated although the three dimensional translating and pulsating source 3dtp green function was derived by haskind 1946 long ago the application in ship motions computation is studied until recent decades one reason is that numerical evaluation of the green function is much more complicated and highly time consuming in contrast to pulsating source kim and shin 2007 hong et al 2016 yao and dong 2016 respectively studied solution methods of 3dtp and then computed seakeeping of ship advancing in waves by applying the green function chen and wu 2001 investigated the behavior of a point source pulsating and advancing at a uniform forward speed the research confirmed that the green function shows singular and highly oscillatory behavior near free surface this is another intrinsic problem of the method which is responsible for numerical instability or even divergence for ships with flare and also for flat hulls apart from the frequency domain computation an alternative choice is to use transient green function in time domain simulation bingham 1994 qiu and peng 2013 sengupta et al 2016 have conducted related researches challenge of the time domain free surface green function method still lie in the efficient and stable numerical evaluation of transient green function moreover there is another deficiency that both the frequency and time domain free surface green functions are derived with neumann kelvin linearized free surface condition which cannot take account of interactions with the steady ship wave or the stationary double body flow using the rankine panel method which employs fundamental solution of 1 r of the laplace equation as green function can avoid problems involved in free surface green function method integrals of 1 r over boundaries are easier to compute besides any form of boundary conditions but not only the neumann kelvin linearized conditions can be imposed in the numerical method studies of frequency and time domain ship seakeeping predictions by applying the rankine panel method have been carried out by lots of scholars for example of nakos and sclavounos 1990 kring 1994 kim and kim 2010 zhang et al 2010 söding et al 2012 and others however the feature of 1 r that does not satisfy any boundary conditions creates other problems infinite fluid field must be truncated at a limited distance as singularities are required to be distributed on all boundaries this may bring truncation errors moreover additional conditions should be imposed to meet the radiation condition the most favorable approach in recent researches is to add artificial damping in outer layer of free surface usually a distance of one wave length in this case free surface range should not be too small free surface size is generally set as several wavelengths or ship lengths by experience therefore plenty of mesh discretization on free surface results in massive quantity of unknowns to the boundary integral equation and consequently computational efficiency would be reduced a reasonable solution is to combine free surface green function method and rankine panel method which is also the recent development the yielding multi domain or hybrid boundary element method shall take advantages of the classic approaches by this method flow domain is decomposed into two parts by a virtual control surface close to ship and rankine source and free surface green function are applied in inner and outer parts respectively one merit of the method is that integrals of free surface green function on the vertical matching surface is easy to evaluate moreover free surface green function automatically satisfies radiation condition so inner free surface can be reduced to a very small region as seen in fig 1 which is comparison of general mesh discretization of rankine panel method and multi domain method zhang et al 1998 solved heave and pitch motions of non wall sided body with hybrid boundary element method in time domain duan and dai 1999 studied on the same method while they set up the vertical control surface crossing to waterline making the method not applicable for ship with bulb kataoka and iwashita 2004 liu and papanikolaou 2011 carried out time domain simulation of linear radiation and diffraction problems in the earth fixed frame to avoid horizontal spatial derivatives of velocity potential in the free surface condition whereas the numerical scheme is time consuming as free surface mesh varies with time tang et al 2014 modeled ship wave interactions in the reference frame which translates with ship and calculated ship motions by multi domain constant bem however they employed neumann kelvin linearized free surface condition in inner domain and adopted simplified m terms which may provide satisfactory results only for slender bodies in the present study a three dimensional multi domain high order boundary element method mdhobem is developed to compute time domain ship motions with and without forward speeds as well as added wave resistance by this method a vertical control surface close to ship is employed to divide the fluid domain into inner and outer parts in which rankine panel method and transient green function method are applied respectively some progress and improvements on previous methods are made in this work the unsteady disturbance potential involving both radiation and diffraction components are solved directly without the use of impulse response function as in study of tang et al 2014 liu and papanikolaou 2011 in this case the ship wave linearized or double body flow linearized free surface condition and the corresponding m terms can be applied to the inner domain to consider the steady flow effects more accurately which is shown in the following sections to be effective in improving results in the outer domain transient green function is evaluated with the practical tabulation and interpolation method incorporated with solving ordinary differential equations ode which is highly efficient the corresponding hybrid boundary integral equation is discretized with a hobem based on bi quadratic isoparametric elements moreover added wave resistance is computed by the near field pressure integration method and different components of added wave resistance are analyzed a numerical program is coded with fortran it is applied to compute hydrodynamic forces and motions of both wall sided and flared ships for validation detailed convergence studies for ship motion computations by mdhobem with respect to spatial and temporal discretization as well as boundary size are conducted beforehand the numerical analysis implies quite good robustness of the present numerical scheme the computed results involving added mass and damping coefficients ship motions relative motions of free surface and added wave resistance at various frequencies together with results obtained by other numerical methods including rankine panel method formulated and programed in this study as well transient green function method and translating and pulsating source green function method are compared with related model test data it demonstrates the present mdhobem is more advanced and can improve results 2 mathematical and numerical formulation of multi domain hobem in time domain 2 1 coordinate system and flow decomposition an inertial frame o xyz which translates with constant forward speed u is used in computation xoy plane is on still water level ox axis points to bow and oz axis is vertically upward in computation fluid domain is decomposed into inner domain i and outer domain ii by a virtual control surface s c as shown in fig 2 inner domain is bounded by body surface s b inner free surface and control surface s c outer domain is enclosed by control surface s c the remaining free surface and an infinite control surface s rankine panel method that is valid for ship with flare is applied to inner domain since the elementary source would not oscillate near free surface besides more accurate free surface conditions rather than neumann kelvin n k linearized form can also be used with rankine panel method in domain ii transient green function method is adopted it satisfies n k linearized free surface condition and radiation condition dirichlet and neumann conditions are imposed on control surface to maintain continuous velocity potential and its normal derivative in two domains flow chart of multi domain method are shown in fig 3 2 2 governing equations the fluid is assumed to be homogeneous incompressible and inviscid and the flow is irrotational velocity potential satisfies laplace s equation 1 2 φ 0 total velocity potential can be regarded as the summation of steady and time varying components as shown below 2 φ x y z t u x φ x y z φ 0 x y z t φ d x y z t where ux is uniform stream φ is steady flow potential which satisfies the following boundary conditions 3 s b φ n u n x s f z 0 φ n 0 f o r d o u b l e b o d y f l o w u 2 g 2 φ x 2 φ z 0 f o r s h i p w a v e where n is normal vector pointing out of fluid domain and subscript x denotes x component φ 0 is incident wave potential for regular wave of infinite water depth it is expressed by 4 φ 0 g ζ a ω e k z sin k x u t cos β k y sin β ω t where ζ a is wave amplitude g represents gravitational acceleration k denotes wave number ω is circular frequency and β is wave angle as defined in fig 2 the boundary value problem of φ d is shown in the following sections 2 2 1 boundary value problem of φ d in domain i boundary conditions of φ d in inner domain is presented below 5 s f ι t u φ ζ d φ d z 2 φ z 2 ζ d φ ζ a s f ι t u φ φ d g ζ d φ φ 0 u φ 1 2 φ φ s b φ d n j 1 6 ξ j n j ξ j m j φ 0 n s c ι φ d ι φ d ι ι φ d ι n φ d ι ι n initial condition φ d 0 φ d t 0 the ship wave linearized swl and double body flow linearized dbl free surface condition are employed in this work as they can provide more accurate results of hydrodynamic forces and ship motions where steady ship wave is solved by rankine source method this is an improvement of some of previous studies like tang et al 2014 who adopted neumann kelvin linearized free surface condition in internal domain time marching of free surface condition is by applying the mixed euler lagrange scheme in body boundary condition ξ 1 6 denotes six freedom ship motions n 1 n 2 n 3 n and n 4 n 5 n 6 r n are unit normal vectors m j terms are computed by the following formulas 6 m 1 m 2 m 3 n u φ m 4 m 5 m 6 n r u φ where φ stands for steady disturbance potential and ship wave and double body flow potential are used in the present work the second order derivatives of velocity potential are evaluated numerically by hobem referring to shao 2010 on the control surface dirichlet and neumann conditions should be imposed to ensure flow velocity potential and normal velocity are continuous 2 2 2 boundary value problem φ d in domain ii in outer domain φ d should satisfy the following boundary conditions 7 s f ι ι t u x 2 φ d g φ d z 0 s c ι ι φ d ι ι φ d ι φ d ι ι n φ d ι n s φ d 0 φ d n 0 φ d 0 initial condition φ d 0 φ d t 0 as transient green function is used in outer domain the free surface condition should be neumann kelvin linearized form which is linearization about uniform stream ux a problem is that the condition is inconsistent with ship wave or double body flow linearized free surface condition adopted in inner domain to deal with the difficulty a transition zone is set on the end of inner free surface to gradually damp the steady potential φ with respect to rectangular free surface values of steady potential in transition zone are defined as the follows 8 φ φ x x 0 2 x r x 0 2 1 x x 0 φ φ y y 0 2 y r y 0 2 1 y y 0 where x 0 and y 0 represent starting points of the transition region x r and y r are coordinates of edge of free surface within a certain range variation of size of the transition zone would not affect numerical results because the steady potential φ is merely significant in the vicinity of ship in the present computations characteristic length of the transition zone is set as 5 of ship length 2 3 boundary integral equations 2 3 1 boundary integral equations of domain i rankine panel method is applied in inner domain with green second identity a mixed boundary integral equation is established 9 α p φ d ι p t s f ι s b s c φ d ι q t n q 1 r φ d ι q t n q 1 r d s q where p and q represent field and source points respectively n q is normal vector pointing to outside of inner domain 1 r is rankine source green function and r is distance between field and source points 10 r x q x p 2 y q y p 2 z q z p 2 in addition α in equation 9 stands for solid angle which is computed by an indirect method in the present paper by substituting φ d in equation 9 with uniform potentials the following formula for computing α can be derived 11 α p s f ι s b s c n q 1 r d s q 2 3 2 boundary integral equations of domain ii transient green function method is used in outer domain hence singularities are required to be distributed only on control surface the mixed boundary integral equation is written as 12 α p φ d ii p t s c φ d ii q t g 0 n q φ d ii q t n q g 0 d s q 0 t d τ s c φ d ii q τ g n q φ d ii q τ n q g d s q u 2 g 0 t d τ γ 0 φ d ii q τ g x q φ d ii q τ x q g n 1 d l u g 0 t d τ γ 0 φ d ii q τ g τ φ d ii q τ τ g n 1 d l it should be noted that normal direction of control surface are in consistence with inner domain so normal vectors point to the inside of outer flow field as a result the bie of the two domains should have different signs in equation 12 γ 0 denotes the intersecting line of free surface and vertical control surface g 0 and g are instantaneous and memory terms of transient green function the expressions are presented below 13 g 0 1 r 1 r 14 g p t q τ 2 0 g k e k z p z q j 0 k r sin g k t τ d k where 1 r is image source of 1 r about z 0 j 0 represents the first kind of zero order bessel function r is horizontal distance between source and field points 15 r x q τ x p t u t τ 2 y q τ y p t 2 there are difficulties in numerical evaluation of transient green function researchers have paid great efforts to improve computational stability and efficiency in the past few decades huang 1992 proposed a fast approach by tabulation and interpolation clement 1998 obtained solution of transient green function through solving fourth order ordinary differential equation zhu et al 2007 incorporated the two approaches and came up with a practical numerical method which is also adopted in the present study 2 4 hobem discretization to discretize the hybrid boundary integral equation a high order boundary element method hobem based on bi quadratic shape functions are applied comparing with constant panel method cpm hobem can construct continuous distribution of velocity potential and its normal derivative over boundaries as well as high order distribution of variables in elements moreover curved panels would minimize the gaps between elements the 9 nodes isoparametric panel used in this study is shown in fig 4 an arbitrary variable ψ in panel can be expressed by the following formula 16 ψ j 1 9 n j ξ η ψ j where n k ξ η is 9 node shape function subscript j denotes local nodal index with the above relation spatial derivatives can be conveniently solved 17 ψ x ψ y ψ z t j 1 ξ η ψ ξ ψ η ψ n t where j ξ η is jacobi matrix derivatives with respect to parametric coordinate ξ η are computed by 18 ψ ξ η j 1 9 n j ξ η ξ η ψ j substituting equation 16 into boundary integral eqs 9 and 12 and choosing collection points as nodes of panels discretized hybrid boundary integral equations can be derived 19 h b b ι a b b ι h b c ι a b c ι h f b ι a f f ι h b c ι a b c ι h c b ι a c f ι h c c ι a c c ι 0 0 h c c ii a c c ii φ d b φ d f n φ d c φ d c n a b b ι h b b ι 0 0 a f b ι h f f ι 0 0 a c b ι h c f ι 0 0 0 0 0 0 φ d b n φ d f 0 0 0 0 0 m e t c where h and a are sub matrixes of influence coefficients subscripts b f and c represent body free and control surfaces respectively since φ d and φ d n are both unknown variables on control surface total size of the equation is n b n f 2 n c influence coefficients are computed by the following formulas 20 a i j ι p 1 n p k 1 9 δ i n d p k j 1 1 1 1 1 r n k ξ η j ξ η d ξ d η 21 h i j ι δ i j α i p 1 n p k 1 9 δ i n d p k j 1 1 1 1 n 1 r n k ξ η j ξ η d ξ d η 22 a i j ι ι p n p b n p f 1 n p k 1 9 δ i n d p k j 1 1 1 1 g 0 n k ξ η j ξ η d ξ d η 23 h i j ι ι δ i j α i p n p b n p f 1 n p k 1 9 δ i n d p k j 1 1 1 1 g 0 n n k ξ η j ξ η d ξ d η where n p n pb n pf n pc represents total number of panels k is local nodal index in a panel ξ and η are two orthogonal isoparametric variables ranging from 1 to 1 δ denotes dirac delta function ind p k signifies global index of k th node in p th panel memory term in right side of the boundary integral equation is expressed as 24 m e t i δ t k 1 n p 1 n p c j 1 9 1 1 1 1 φ d ii j t k g t n t k n φ d ii j t k n g t n t k n j ξ η j ξ η d ξ d η δ t k 1 n l 1 n l c j 1 3 u 2 g 1 1 φ d ii j t k g t n t k x q φ d ii j t k x q g t n t k n l j ξ j ξ d ξ δ t k 1 n l 1 n l c j 1 3 u g 1 1 φ d ii j t k g t n t k τ φ d ii j t k τ g t n t k n l j ξ j ξ d ξ to solve the boundary integral equation either gaussian elimination or iterative method like bicg and gmres can be employed due to the translational frame used in this work influence coefficients are same at each time step consequently a direct matrix solver is more efficient and is adopted 2 5 equations of ship motions applying newton s second law can yield six freedom ship motion equations 25 m i j ξ t j c i j ξ t j f ξ ξ t i i j 1 6 where m ij and c ij are mass and restoring coefficients respectively noting that artificial soft springs should be added in the three degrees of freedom in horizontal plane to provide restoring forces time varying hydrodynamic forces and moments are evaluated by pressure integrals 26 f 1 f 2 f 3 s b p 0 p d n d s f 4 f 5 f 6 s b p 0 p d r r g n d s where p 0 is incident wave pressure and p d denotes pressure due to unsteady disturbance flow hydrodynamic pressure can be computed by bernoulli s equation 27 p ρ φ t ρ u φ φ where φ represents total unsteady potential the partial derivatives of velocity potential in bernoulli s equation are solved by eqs 17 and 18 added mass and damping coefficients can further be obtained by forced motion computations if harmonic forced ship motion has frequency ωe and amplitude ξ the radiation force would be expressed by the following equation 28 f i r ω 2 a i j ω e i ω b i j ω e ξ j e i ω e t added mass a ij and damping coefficient b ij can then be solved 29 a i j ω e re f i r ω e 2 ξ j b i j ω e im f i r ω e ξ j 2 6 added wave resistance added wave resistance is also investigated in the present study as it is the key parameter for estimating meteorological factor of energy efficiency design index eedi so it is non negligible for the determination of suitable ship propulsion power added wave resistance in fact is longitudinal component of mean drift force to evaluate added wave resistance both near field joncquez 2009 kim and kim 2011 and far field methods hong et al 2016 can be adopted the near field approach is used in this work for it does not require a far control surface referring to joncquez 2009 the equation of second order forces can be derived by perturbation expansion and retaining second order terms the yielding equation is 30 f 2 ρ s b 1 2 φ φ n d s a ρ s b ξ t ξ r r φ t u φ φ n d s b ρ ξ r n s b ξ t ξ r r u φ 1 2 φ φ d s c ρ ξ r n s b φ t u φ φ d s d ρ ξ r n s b g ξ 3 ξ 4 y ξ 5 x d s e ρ s b h r g z u φ 1 2 φ φ n d s ρ s b g z u φ 1 2 φ φ h n d s f 1 2 ρ g w l ζ ξ 3 ξ 4 y ξ 5 x 2 n sin α d l g ρ w l u φ 1 2 φ φ ζ ξ 3 ξ 4 y ξ 5 x ξ r n sin α d l h where φ is the total unsteady potential including incident and disturbance components h is second order transformation matrix ξ t and ξ r denote translational and rotational displacement vectors respectively α represents angle of hull flare at water plane an advantage of near field method is that different components of second force can be investigated in detail kim and kim 2011 in the present study the second order force is decomposed according to different physical character components a h in the above equation correspond to a pressure induced by square of flow velocity b coupling between gradient of first order pressure and first order motion c rotational effect of coupling term of steady pressure gradient and first order motion d rotational effect of first order force e rotational effect of first order motion f contributions related to second order position and normal vector g contributions of relative free surface elevation water line integral h rotational effect of coupling term of steady pressure gradient and relative free surface elevation water line integral the main difficulty of near field method is to compute second order derivatives as hobem is adopted the second order spatial derivatives can be evaluated directly on high order panels by using chain rule 3 results and discussions a numerical program of three dimensional multi domain high order boundary element method mdhobem is originally developed it is applied to compute hydrodynamic coefficients motions and added resistance of different hulls advancing in waves numerical issues of convergence of the method are detailedly discussed computed results are compared with model test data and results of classic bem including rankine panel method translating and pulsating green function method and transient green function method followed by discussions 3 1 numerical example the modified wigley 3 hull journée 1992 series60 hull with block coefficient cb 0 7 kcs container ship and s175 container ship are employed as numerical example the wigley 3 is wall sided near free surface while the other three ships have flare principle dimensions of the four types of hull forms are shown in table 1 for wigley 3 and s60 only double body basis flow are considered in motion computations while for the more realistic kcs and s175 the steady ship wave linearized free surface conditions and the according m terms are employed in addition hull form of wigley 3 is defined by the following formula 31 y b 2 1 z d 2 1 2 x l 2 1 0 2 2 x l 2 geometry model of mean wetted surfaces of s60 kcs and s175 are shown in fig 5 7 computational domain and panel arrangement are shown in fig 8 in which variables l up l down l width signify length of free surface upstream downstream and in width respectively h c is depth of control surface n l and n w stand for number of grid nodes distributed in longitudinal and lateral 3 2 convergence study on domain size mesh density and time step convergence tests for spatial and temporal discretization are carried out the wigley 3 model is adopted as numerical example and time histories of heave and pitch motions at fn 0 2 are computed with different discrete parameters figs 9 and 10 show results of different free surface sizes l down l up l width figs 11 and 12 show converged results with respect to free surface mesh quantity n f figs 13 and 14 are results computed with disparate depths of control surfaces h c in addition convergence with respect to time step length δt which is defined by number of time steps divided by encounter wave period are presented in figs 15 and 16 these figures illustrate robustness of the present numerical scheme which is insensitive to discretization parameters results also indicate methods in different domains are well matched and inner domain can be limited to a quite small region time histories of heave and pitch motions can converge with the increasing of internal domain size and number of panel discretization as well as the reduction of length of time step in view of both the accuracy and efficiency the recommended parameters for temporal and spatial discretization of the present numerical method are δt t 100 n f 1071 l down l up l width 0 4l and h c 3d 3 3 added mass and damping coefficients forced motions of the wigley 3 and s60 ships advancing in head waves are simulated by the present mdhobem fig 17 20 show added mass and damping coefficients due to heave and pitch motions of the wigley 3 hull computations by rankine panel method in conjunction with the double body flow linearized dbl method and the uniform stream linearized usl method the so called neumann kelvin linearization are also performed in this work as for comparison legend tpgreen in the figures represents result by using three dimensional transiting and pulsating green function method kim and shin 2007 numerical results of the mdhobem and rankine dbl are in quite good agreements with experiments journée 1992 and have higher accuracy than rankine usl practically in low frequency regime where the effects of steady flow are significant the present multi domain method by imposing double body flow linearization in inner domain can improve results of hydrodynamic coefficients in comparison to the tpgreen curves of the mdhobem are quite smooth in high frequencies and conform to measured data some fluctuations are observed on results of the tpgreen when non dimensional frequency is larger than about 4 hydrodynamic coefficients of s60 are shown in figs 21 and 22 results computed by the present mdhobem are in better than that by transient green function method bingham 1994 agreement with model test data gerritsma and beukelman 1963 pitch pitch added mass and damping coefficients solved by the transient green show slight oscillation characteristic over frequencies the mdhobem is shown to have better accuracy as well as stability in general than the free surface green function methods of the tpgreen and the transient green 3 4 free motions in head waves free motions of the wigley 3 and s60 hull advancing in head waves are computed figs 23 and 24 depict heave and pitch motions rao of the wigley 3 at zero speed which are obtained by fourier series expansions of time history curves computational results by the mdhobem rankine panel method and transient green function method zhu 2009 are comparable since boundary conditions of the three method are consistent when fn 0 it should be noted that for zero speed computations inner free surface size can be reduced to an even smaller region than in forward speed condition due to the same free surface condition in two domains and also the vanish of spatial derivatives in free surface condition fig 25 28 show heave and pitch motions rao of the wigley 3 at fn 0 2 and 0 3 of the present mdhobem computation in contrast to the rankine panel method the transient green zhu 2009 the tpgreen kim and shin 2007 and experimental data journée 1992 results of both amplitude and phase angle solved by the mdhobem are quite satisfactory as seen from figs 25 and 26 the mdhobem has generally better accuracy than the transient green and peak value of heave motion by the mdhobem is slightly lower and closer to the model tests than by the rankine dbl at higher speed fn 0 3 the mdohbem also shows generally better accuracy than the rankine dbl and the tpgreen the relative motions s a ζ ξ 3 xξ 5 between free surface and the wigley 3 hull at x 0 35 l computed by the mdhobem are shown in figs 29 and 30 the computational froude numbers are 0 2 and 0 3 it can be observed from the figures that the present results of the mdhobem agree better with experimental data than the results solved by strip theory journée 1992 so the mdhobem does not only have high accuracy in computing ship motions but also in the simulation of free surface flow motions of s60 computed by the mdhobem and the rankine dbl in comparison to model test gerritsma et al 1974 are presented in figs 31 and 32 smooth rao curves are obtained by the mdhobem it shows the method is robust in computing motions of the non wall sided hull by contrast free surface green function method is instable for flared ships fig 33 36 are heave and pitch motions of kcs container ship at fn 0 26 and 0 33 label swl and dbl in these figures mean that steady ship wave linearized and double body flow linearized free surface conditions and the according m terms are used in computations respectively it can be seen that at fn 0 26 the computed motions by both the mdhobem swl and mdhobem dbl are in accordance with measured data simonsen et al 2013 however at higher speed fn 0 33 heave and pitch motions computed by the mdhobem swl are more accurate than by the mdhobem dbl the reason is that steady wave generated by a ship at high speed is significant especially for realistic hull with bulbous bow like kcs as shown in fig 37 the actual steady ship wave potential is quite different with double body potential of kcs at fn 0 33 consequently effects of steady flow on unsteady ship motions are more notable and using double body flow as basis flow can no longer provide accurate computations of ship motions to sum up the present mdhobem shall provide more accurate prediction results of heave and pitch in comparison to free surface green function methods since it can concern steady flow effects more precisely by employing ship wave or double body flow linearization in inner domain likewise the mdhobem also has slightly higher accuracy than the rankine dbl in addition comparing to rankine panel method size of computational domain and quantity of mesh discretization are reduced quite a lot and no additional artificial conditions like damping terms which may have detrimental effects on results are required to be imposed in boundary conditions in addition the mdhobem is valid for different types of hull forms 3 5 motions of s175 in oblique and beam waves motions of s175 in oblique and beam waves are computed by using the mdhobem in prediction of roll motion the viscous roll damping b 44 of is determined from numerical test of free decay of roll motion which is carried out by using commercial cfd software starccm following wilson et al 2006 time history curve of the roll angle can be fitted by the equation ξ 4 a d e i 1 n β i t i cos ω d t where ω d is the natural frequency of the roll motion a d is amplitude and β i represents the i th order of the damping coefficients after getting β i the equivalent linearized roll damping can be computed by energy method non dimensional roll damping of s175 adopted in the present study is b 44 b 44 m b 2 b 2 g 0 0045 numerical results of heave roll and pitch of s175 at fn 0 275 in comparison with experimental data ittc seakeeping committee 1978 are shown in fig 38 42 wave angles in computations are 150 120 and 90 the computed motions rao of s175 are in quite good agreement with experiments in different wave directions the swl is slightly more accurate than the dbl in the computation of roll motion of s175 numerical results indicate the present method is accurate in prediction of ship motions in oblique and beam waves 3 6 added wave resistance fig 43 shows time series of longitudinal second order wave force of the wigley 3 in regular head wave as can be seen the curve is smooth and regular implying the present numerical scheme is stable in computing near field pressure integrals similar with hydrodynamic coefficients results of the mdhobem and rankine dbl show less difference added wave resistance shall be obtained by averaging the time history of second order force figs 44 and 45 depict added wave resistance of wigley 3 at fn 0 2 and 0 3 fig 46 shows added wave resistance of s60 at fn 0 222 figs 47 and 48 are added wave resistance of s175 at fn 0 2 and 0 3 for numerical investigation results computed by the present mdhobem are compared with model test data journée 1992 strom tejsen et al 1973 fujii and takahashi 1975 nakamura and naito 1977 and results by other potential flow methods including rankine panel method kim and kim 2011 frequency domain transiting and pulsating green function method hong et al 2016 frequency domain pulsating green function method with speed correction hong et al 2016 and strip theory journée 1992 the present numerical results show good agreements with experimental data and both peak value and resonance frequency are well predicted in addition the present mdhobem show overall higher accuracy than other numerical methods however each of the potential flow methods compute smaller added resistance of s60 and s175 in short waves where the effects of diffracted waves are significant nonlinear features of flow like bow wave swell up may explain the difference proportions of different components in total added wave resistance of s60 and s175 are also investigated results are shown in figs 49 and 50 it can be seen that component g which is contribution of relative wave elevation in water line integral is dominant in r aw for different hulls at different speeds this is also verified by kim and kim 2011 component a related to square of flow velocity also takes a main proportion in r aw components b d and e which are coupling of first order motions with gradient of first order pressure and rotational effects of first order force and motion are significant as well by contrast component f related to second order position and normal vector as well as terms c and h involving gradient of steady pressure are negligible 3 7 wave contours contours of unsteady radiated and scattered free surface waves of the wigley 3 s60 and kcs at different forward speeds and wave lengths are depicted in fig 51 56 numerical results of the mdhobem and rankine panel method are in quite favorable agreement no reflected waves are found from borders of the inner domain as plotted in the lower images of the figures it indicates the present mdhobem can successfully match flow of different domains moreover by applying transient green function in the exterior domain the mdobem uses much smaller discretized region to simulate flow motions in comparison to rankine panel method 4 conclusions a three dimension multi domain high order boundary element method which combines rankine panel and transient green function methods is developed to simulate time domain motions and added resistance of ship advancing in waves the ship wave and double body flow linearization are adopted in the inner domain for solving time domain diffraction and radiation problems with forward speed by the mdhobem problem of highly oscillatory nature of transient green function near waterline and limitation of neumann kelvin linearized condition in derivation of free surface green function can be avoided due to substitution of rankine source in inner domain moreover fewer discrete quantities than in rankine panel method are needed and radiation condition can be analytically satisfied a fortran program is originally developed and validation studies are carried out for different type of hulls over various frequencies conclusions can be drawn by numerical investigations 1 the numerical scheme is shown to be quite robust by convergence study of spatial and temporal discretization methods in different domains are well matched and inner domain can be limited to a quite small region about 0 4 times of ship length for problem with forward speed and even smaller in case of zero speed 2 the computed added mass damping coefficients and motions and added wave resistance of different ships are in quite good agreement with experimental data in comparison to classic bem methods including transient green translating and pulsating green and rankine panel methods mdhobem shows generally higher accuracy and efficiency 3 the developed mdhobem is also more robust than free surface green function methods and needs less panels than rankine panel method in solving seakeeping problems it also has advantages in extension to fully nonlinear computations acknowledgement this work has been supported by national natural science foundation of china nsfc grant no 51479117 51579147 advance research program of china no 41407010202 and program of state key laboratory of ocean engineering collaborative innovation center for advanced ship and deep sea exploration sjtu china no gkzd010071 
23363,the objective of this paper is to investigate ventilated cavitating vortex shedding dynamics over a bluff body at re 6 7 104 with large eddy simulation les model the finite time lyapunov exponent ftle and lagrangian coherent structures lcs methods are applied to investigate the formation evolution and shedding of ventilated cavitating vortices the results show that ventilated cavitation plays an important role in the vortex structures and the vortex shedding process comparing with non cavitating flow the strouhal number st corresponding to vortex shedding increases and the length of formation region decreases when the gas entrainment coefficient is q v 0 0231 while with further increase of gas entrainment coefficient the st reduces gradually and the formation region expands based on the lagrangian analysis of vortex dynamics it can clearly be seen that the turbulent wake can be divided into two parts near wake the formation and development of vortices and far wake vortex street the variation of the size of near wake is the same as that of the formation region in the far wake the vortices stretch and distort and the rotation of vortices in the ventilated cavitating flow is not evident as that in non cavitating flow keywords ventilated cavitating flow vortex shedding lagrangian coherent structures 1 introduction ventilated cavitation is obtained by injecting gas into the low pressure regions of liquid flows franc and michel 2005 it is an interest topic due to its importance in a wide range of fundamental studies and engineering applications ceccio 2009 arndt et al 2009 mäkiharju et al 2013 karn et al 2016b shao and arndt et al 2017 barbaca et al 2017 liu et al 2017 wang et al 2015 wosnik and arndt 2013 carried out experiments in high speed water tunnel to investigate the interaction between a ventilated supercavity and its turbulent bubbly wake karn et al 2016a investigated the physical mechanisms of closure formation and transition in ventilated supercavity when gas entrainment coefficient is not large enough to form a supercavity cavitation often results in the formation of vortex shedding showing an unsteady behavior harwood et al 2016 investigated the topology formation elimination and stability of ventilated cavity on a surface piercing hydrofoil the results indicated that the re entrant jet played an important role in the stability of ventilated regimes although cavitation shedding dynamics has been extensively studied both experimentally and numerically arndt et al 2000 gopalan and katz 2000 laberteaux and ceccio 2001 lyer and ceccio 2002 ji et al 2013 huang et al 2013 chen et al 2016 wang et al 2017a b c wu et al 2018 relatively fewer studies exist for the ventilated cavitation behind a bluff body as the flow passes over a bluff body various kinds of vortices form develop and interact with each other in the wake which will lead to vibration noise large fluctuating pressure forces or resonance williamson 1966 balachandar and ramamuthy 1999 brandner et al 2010 ganesh et al 2016 huang et al 2014 the characteristics of vortex shedding in non cavitating flows over a bluff body have been widely studied gerrard 1966 yarusevych et al 2009 it is well known that the fluid dynamics past a bluff body are complex which involve the interaction of the boundary layer the free shear layer and the wake however cavitating flow is one kind of multiphase flow and so the fluid dynamics in the bluff body wake are physically more complicated belahadji et al 1995 investigated global conditions of inception and development of cavitation in the rotational structures of the turbulent wake they found that the strouhal number and vortex street depended strongly on the development of cavitation cavitation tended to change the flow features in the turbulent wake and made the local mechanism more complex in some extent ausoni et al 2007 concentrated mainly on the effects of cavitation development and fluid structure interaction on the mechanism of the vortex generation they found that for fully developed cavitation the vortex shedding frequency increased up to 15 which was accompanied by the increase of the vortex advection velocity and reduction of the streamwise vortex spacing gnanaskandan and mahesh 2016 demonstrated that cavitation effected the evolution of pressure boundary layer and loads on the cylinder surface in addition cavitation suppressed turbulence and delayed the 3d breakdown of kármán vortices the literature above all indicated that cavitation had a significant influence on the fluid dynamics in the turbulent wake behind a bluff body however except for several studies there has been relatively less research on the phenomenon of cavitating vortex shedding behind a bluff body especially ventilated cavitating vortex shedding the characteristics of ventilated cavitating vortex shedding over a bluff body are still not well understood as there are strong correlations between ventilated cavitation and vortex structures it is important to identify regions of separated flow as well as wake structures to reveal the unsteady vortex behaviors in cavitating flow huang and green 2015 cheng et al 2018 long et al 2018 during these years the finite time lyapunov exponent ftle and lagrangian coherent structures lcs methods are developed to study the intrinsic structures or properties within flows haller 2001 shadden et al 2005 green et al 2007 demonstrated that the lcs method could define time dependent vortex structure boundaries without relying on a pre selected threshold and presented greater visible details without the requirement of velocity derivatives brunton and rowley 2009 applied lcs to visualize the relevant flow in the wake of a flat plate recently some researchers gradually applied the ftle and lagrangian coherent structures lcs methods in cavitating flow tang et al 2012 utilized the lcs method to flow dynamics and underlying physics of unsteady turbulent cavitating flows these researches showed that the lcs was a powerful method to help identify and add the description of the dynamical features of different vortex dominated flow fields in this work the main goal is to improve the understanding of characteristics of ventilated cavitating vortex shedding over a bluff body the paper is organized as follows section 2 is the numerical method sections 3 shows the numerical setups and descriptions in section 4 the ftle is applied to display the influence of ventilated cavitation on the formation evolution and shedding of vortices in addition the relationship between the vortex shedding process and unsteady loads is discussed 2 numerical model the numerical results shown in this paper are performed using the commercial cfd code cfx to solve the unsteady navier stokes equations by the les wall adapting local eddy viscosity wale model nicoud and ducros 1999 the homogeneous model assumes that the transported quantities with the exception of volume fraction for that process are the same for all the governing equations are shown as follows 1 ρ m t ρ m u j x j 0 2 ρ m u i t ρ m u i u j x j p x i x j μ m u i x j here u is the velocity p is the pressure the mixtured density ρ m and dynamic viscosity μ m are defined as 3 ρ m ρ l α l ρ g α g 4 μ m μ l α l μ g α g where ρ l is the liquid density ρ g is the gas density which is a function of pressure and temperature α l is the liquid fraction α g is the gas fraction α l 1 α g applying a favre filtering operation to equs 1 and 2 gives the les equations 5 ρ t ρ u j x j 0 6 ρ u i t ρ u i u j x j p x i x j μ u i x j τ i j x j where over bar denotes a filtered quantity by comparing equ 2 with equ 6 there is an extra nonlinear term τ ij which is called the sub grid scale sgs stress it includes the effect of the small scales and is defined by 7 τ i j ρ u i u j u i u j the large scale turbulent flow is solved directly and the influence of the small scales is taken into account by appropriate subgrid scale sgs models an eddy viscosity approach is used which relates the subgrid scale stresses τ ij to the large scale strain rate tensor s i j in the following way 8 τ i j 1 3 τ k k δ i j 2 μ t s i j 9 s i j 1 2 u i x j u j x i the s i j is the rate of strain tensor for the resolved scale and the sub grid scale turbulent is closed by the les wall adapting local eddy viscosity wale model nicoud and ducros 1999 10 μ t ρ l s 2 s i j d s i j d 3 2 s i j s i j 5 2 s i j d s i j d 5 4 where s i j d and l s in the wale model are defined respectively as 11 s i j d 1 2 g i j 2 g j i 2 1 3 δ i j g k k 2 g i j 2 g i k g k j g i j u i x j l s min k d c s v 1 3 s i j d denotes the traceless symmetric part of the square of the velocity gradient tensor and δ i j is the kronecker symbol l s is the sub grid scale mixing length k is von karman s constant d is the distance to the closest wall v is the volume of the computational cell and c s is the wale constant having the default value of 0 35 the main advantages of the wale model are the capability to reproduce the laminar to turbulent transition and the design of the model to return the correct wall asymptotic y 3 variation of the sgs viscosity 3 numerical set and description the computational domain follows the boundaries of the cavitation tunnel 35d in length 9 5d in height and 3 5d in width as shown in fig 1 d is the diameter of bluff body d 0 02 m the total mesh nodes are 13 225 000 a no slip boundary condition is imposed on the test body surface the top bottom front and back boundaries of the tunnel are free slip a constant turbulent intensity of 2 is set at the inlet boundary of the domain and is equal to the experimentally measured mean turbulent intensity on the inlet boundary of the domain the volume fraction of gas is 0 while the volume fraction of liquid is 1 the inlet boundary of the gas injection is based on volume flow rate on this boundary the volume fraction of gas is 1 while the volume fraction of liquid is 0 all ventilated cavitating runs have been initialized with steady state fully wetted calculations at the initial time step the corresponding power spectrum density psd of the pressure coefficient fluctuation with a distance x d 0 6 is shown in fig 2 the resolved scales seem to be asymptotic to an inertial subrange reasonably close to f 5 3 scaling ji et al 2015 in this study the reynolds number is defined as re u d ν where u is the free stream velocity ν is the kinematic viscosity the gas entrainment coefficient q v is defined as q v q u d 2 where q is the volumetric flow rate of the injected gas 4 lagrangian coherent structures in order to study the intrinsic structures or properties within the flows haller and yuan 2000 developed a trajectory based approach from a lagrangian perspective by considering the fluid as a dynamical system of fluid particles in this method the lcss are defined as the ridge of the finite time lyapunov exponent in a finite time period t 0 t 0 t le at the given point x 0 the finite time version of the cauchy green deformation tensor δ shadden et al 2005 can be defined as 12 δ t 0 t l e x 0 x t 0 t l e t 0 x 0 x 0 t x t 0 t l e t 0 x 0 x 0 where the x t 0 t le t 0 x 0 is the final position of x 0 after a finite time t le t is the transpose of the deformation gradient tensor then the finite time lyapunov exponent with a finite integration time t le can be expressed as 13 σ t 0 t l e x 0 1 t l e ln λ max δ t 0 t l e x 0 here λ max δ t 0 t l e x 0 is the maximum eigenvalue of cauchy green deformation tensor 5 results and discussion 5 1 the influence of ventilated cavitation on the characteristics of vortex shedding the vortex shedding behind a bluff body has been investigated by a numerical method at a constant reynolds number of re 6 7 104 fig 3 shows the instantaneous structures in the form of q criterion iso surfaces q 5000 1 s2 colored by volume fraction of gas top and vorticity ω z middle and bottom at gas entrainment coefficient q v 0 and q v 0 0231 respectively although a similar pattern of bénard kármán vortex street forms in the wake behind the bluff body for both cases ventilated cavitation plays an important role in the characteristics of the vortex street when the gas is injected into the flow q v 0 0231 the gas is entrapped in the vortices and preferentially concentrated in the cores of the vortices compared with q v 0 the spanwise vortices distort and some opposite sign of vorticity is blend into vortex at q v 0 0231 for the positive vortex counter clockwise vorticity a as shown in the front view in fig 3 b some negative vorticity clockwise vorticity is entrained into the positive vortex the horizontal distance λ between the vortices of the opposite rotational direction decreases in terms of the streamwise vortices the number of streamwise vortices increases and the distance l between the streamwise vortices decreases in order to reveal the influence of ventilated cavitation on the primary vortices spanwise vortices the instantaneous of ventilated cavitation shape left wang et al 2018 the time averaged volume fraction of gas middle and statistical reynolds stress u i u j u i u j u i u j with time averaged streamlines right at the cross sectional are shown in fig 5 to minimize the measurement uncertainties more than six cycles of instantaneous fields are averaged to obtain the statistical reynolds stress fields and average streamlines the strouhal number st fd u and the formation length l f versus q v are displayed in fig 6 the formation length is the distance from the downstream of the bluff body along the centerline to the first peak in fluctuating velocity gnanaskandan and mahesh 2016 to compare with non cavitating flow the strouhal number and the formation length are normalized by its corresponding non cavitating values st nc and l fnc st nc 0 11 and l fnc d 1 4 in the non cavitating flow gerrard 1966 found that the formation region behind the bluff body played an important role in the vortex shedding frequency at the shear layer transition regime re 1000 to 200 000 the formation length decreases with the increase of re schiller and linke 1933 roshko 1954b williamson 1996 the sketch of formation region shown in fig 4 indicates that the flow can be divided into three parts ie a b c respectively flow a is entrained by the growing vortex flow b enters the upper shear layer and then cuts it flow c is in the interior of the formation region the size of the formation region is mainly determined by the balance between flow b and c the experimental structures with filament lines illustrate the sketch of the formation region within the rolling up shear layers see fig 5 combining the filament lines see fig 4 with the formation length l f see figs 5 and 6 it can be clearly seen that at different gas entrainment coefficients the dramatic changes take place in the flow component and the formation length at q v 0 three parts of flow a b and c are all liquid the upper vortex entrains the lower side fluid a across the wake to enter the vortex the flow b enters the upper shear layer and eventually cuts off the vorticity feeding to vortex fluid c moves back toward bluff body and find its way into the interior of formation region comparing with non cavitating q v 0 flow c in the formation region is still liquid while the entrainment flow a and b are composed of the mixture of liquid and gas at q v 0 0231 the strouhal number st corresponding to vortex shedding increases the injection of gas adds kinetic energy into the flow and promote the evolution of vortex so the formation region shrinks in size which may be the reason why the strouhal number increases at q v 0 0231 by comparison of q v 0 with further increase of the gas entrainment coefficient q v the flow a b and c are all composed of the mixture of liquid and gas the ventilated cavity gradually covers the bluff body and the length of cavity l c increases at q v 0 231 the formation region contains not only the evolution of ventilated cavitation vortices but also the development of ventilated cavity which is attached the bluff body although the injection of gas also increases the kinetic energy the development of ventilated cavity behind the bluff body may diffuse more energy this leads that the formation region expands in size which signifies a reduction of vortex shedding frequency 5 2 unsteady vortex structure at variable flow patterns to reveal the influence of ventilated cavitation on the formation evolution and shedding of vortices the photographs of ventilated cavitation the vorticity ω z contours with streamlines and the backward time ftle finite time lyapunov exponent contours in the middle plane at q v 0 q v 0 0866 q v 0 231 are shown in fig 8 fig 10 and fig 12 the ftle and lcss can be regarded as a useful method to get a better understanding of the flow dynamics haller and yuan 2000 tang et al 2012 the integration time is 0 85t where t is the period of vortex shedding process lagrangian coherent structures in dark red are observed as the ridges of the ftle field the time evolutions of the lift coefficients c l lift 0 5ρu 2 ld and drag coefficients c d drag 0 5ρu 2 ld at different flows are displayed in fig 7 fig 9 and fig 11 here l is the spanwise length 5 2 1 the non cavitating flow in the non cavitating flow a periodic state associated with bénard kármán vortex shedding occurs in the turbulent wake behind the bluff body at t 1 the upper shear layer becomes strong enough to draw the lower circulation across the wake then the part drawn by the upper zone moves upwards and cuts off the upper shear layer і at the black point see fig 8a a large negative vortex v1 clockwise vorticity develops and prepares for shedding from the upper part of the bluff body at t 2 the upper vortex v1 has already shed into the wake it rotates and moves downstream the lower shear layer begins to develop at this instant the lift coefficient reaches the minimum value at t 3 t 4 the lower vortex v2 continues to be fed by circulation from the shear layer the lift coefficient gradually increases as the lower vortex develops at t 4 the lower shear layer is cut off at the black point see fig 8d right at t 5 the lower vortex is separated from the lower shear layer the new negative vortex v3 clockwise vorticity begins to grow at this instant the lift coefficient is the maximum value 5 2 2 the ventilated cavitating flow while maintaining the reynolds number at 6 7 104 the gas is injected into the turbulent wake there still exists the alternate shedding in the wake with the lower and upper vortices the vortex shedding process can be visualized by the presence of the gas cavities from the photographs and the contours it can be found that good agreements of predicted and experimental vortex shedding process are obtain comparing with non cavitating flow the vortex shedding process changes due to ventilated cavitation at q v 0 0866 it can be clearly seen that the injection of gas forms separate bubbles and the small bubbles are entrapped into the upper cavitating vortex v1 clockwise vorticity at t 1 the bottom circulation with vorticity of opposite sign counter clockwise vorticity is entrained across the wake to enter not only upper shear layer but also the upper vortex see і it splits the upper circulation into two parts at the black point see fig 10 a right the rear part of the upper circulation zone becomes the first cavitating vortex v1 which is the mixture of negative and positive vorticity at t 2 the upper cavitating vortex is going to shed from the upper shear layer while the front part of upper circulation zone is taken by the lower zone the lift coefficient reaches the minimum value at this moment the value is smaller than that at q v 0 at t 3 the upper cavitating vortex v1 moves downstream in the core of cavitating vortices the volume fraction of gas is larger and the vorticity is opposite to that of the vortex the lower vortex v2 keeps on developing and entrains the upper circulation which can be clearly seen by the photograph of experiments and the vorticity contours the upper circulation which is entrained by the lower circulation zone moves downwards and enters the lower shear layer to split the lower circulation zone the bubble in the upper zone is entrained into the lower cavitating vortex the lift coefficient gradually increases at t 4 t 5 the lower cavitating vortex continues to develop and then sheds into the wake the process is repeated to form a cycle in comparison of q v 0 0866 a fixed ventilated cavity attaches to the bluff body and the ventilated cavitation vortices shed from the rear part of the ventilated cavity at q v 0 231 the mixture of negative and positive vorticity exists in the ventilated cavity zone behind the bluff body in addition both the maximum and minimum values of drag and lift coefficients reduce what s more the process also will change at t 1 the upper vortex generated from the upper side evolves to become a larger vortex v1 a lot of vorticity is stored in the zone of fixed ventilated cavity the strength of vortex becomes weaker and the upper shear layer entrains less circulation of the lower zone simultaneously a lower circulation zone begins to develop at t 2 t 3 the upper vortex is shed from the trailing edge of the ventilated cavity the shed vortex v1 aligns on the symmetry line of the wake and moves downstream at the same time the lower vortex gradually rolls to grow at t 4 t 5 the process is also repeated to form a cycle 5 2 3 the comparison at different flows by ftle the ftle with lcss has the advantage of defining the structures boundaries and recognizing the vortices without depending on the preselected a threshold green et al 2007 tang et al 2012 fig 13 gives the instantaneous ftle contours with initial location of particles left and the particles trajectories right from the ftle contours it can be clearly seen that the turbulent wake is divided into two parts near wake and far wake in the near wake it displays the formation and development of vortices in the far wake it is the vortex street at different flows the region of near wake changes it is interesting that the length of near wake and the formation region see fig 5 is similar in addition the ftle also displays the structure and motion of vortices at q v 0 the vortex is nearly a circle dx dy it also demonstrates the rotation of vortices when gas is injected into the wake the vortices stretch and distort the length dx decreases and the length dy increases and the rotation of vortices become not evident at q v 0 231 compared with non cavitating flow 6 discussions and conclusions in this study the characteristics of ventilated cavitating vortex shedding over a bluff body are investigated by numerical method the lcss defined by the ridges of the ftle are utilized to detect the formation development and shedding phenomena of the vortex structures for different flows 1 a similar pattern of bénard kármán vortex street forms in the wake behind the bluff body for all cases compared with non cavitating flow the primary vortices stretch both the horizontal distance λ between the spanwise vortices of the opposite rotational direction and the distance l between the streamwise vortices decrease at q v 0 0231 2 there is a correlation between the vortex shedding frequency and the size of formation region compared with non cavitating flow the strouhal number corresponding to vortex shedding increases but the length of formation region decreases when the gas entrainment coefficient is q v 0 0231 with further increase of gas entrainment coefficient the strouhal number reduces gradually and the length of formation region increases 3 the finite time lyapunov exponent ftle and lagrangian coherent structures lcs methods are applied to detect the structures boundaries and recognize the vortices the ventilated cavitation plays an important role in the turbulent wake compared with non cavitating flow the length of the near wake which contains the formation and development of the vortices decreases at q v 0 0866 with the increase of the q v the cavity cover the bluff body and the length of cavity increases the length of the near wake increases at q v 0 231 in comparison of q v 0 0866 and it is almost the same as that of the formation region in the far wake the rotation of vortices become not evident as that in non cavitating flow at q v 0 231 in addition ventilated cavitation also has an influence on the unsteady loads with the increase of gas entrainment coefficient the highest amplitude values of lift and drag coefficients decrease acknowledgement the authors gratefully acknowledge support by the national science foundation of china nsfc grant nos 91752105 and 51679005 national natural science foundation of beijing grant no 3172029 and chines advanced research of equipment fund 61402070401 and 61402070501 the authors also appreciated the funding support from graduate technological innovation project of beijing institute of technology 2017cx10043 and china scholarship council 201706030087 
23363,the objective of this paper is to investigate ventilated cavitating vortex shedding dynamics over a bluff body at re 6 7 104 with large eddy simulation les model the finite time lyapunov exponent ftle and lagrangian coherent structures lcs methods are applied to investigate the formation evolution and shedding of ventilated cavitating vortices the results show that ventilated cavitation plays an important role in the vortex structures and the vortex shedding process comparing with non cavitating flow the strouhal number st corresponding to vortex shedding increases and the length of formation region decreases when the gas entrainment coefficient is q v 0 0231 while with further increase of gas entrainment coefficient the st reduces gradually and the formation region expands based on the lagrangian analysis of vortex dynamics it can clearly be seen that the turbulent wake can be divided into two parts near wake the formation and development of vortices and far wake vortex street the variation of the size of near wake is the same as that of the formation region in the far wake the vortices stretch and distort and the rotation of vortices in the ventilated cavitating flow is not evident as that in non cavitating flow keywords ventilated cavitating flow vortex shedding lagrangian coherent structures 1 introduction ventilated cavitation is obtained by injecting gas into the low pressure regions of liquid flows franc and michel 2005 it is an interest topic due to its importance in a wide range of fundamental studies and engineering applications ceccio 2009 arndt et al 2009 mäkiharju et al 2013 karn et al 2016b shao and arndt et al 2017 barbaca et al 2017 liu et al 2017 wang et al 2015 wosnik and arndt 2013 carried out experiments in high speed water tunnel to investigate the interaction between a ventilated supercavity and its turbulent bubbly wake karn et al 2016a investigated the physical mechanisms of closure formation and transition in ventilated supercavity when gas entrainment coefficient is not large enough to form a supercavity cavitation often results in the formation of vortex shedding showing an unsteady behavior harwood et al 2016 investigated the topology formation elimination and stability of ventilated cavity on a surface piercing hydrofoil the results indicated that the re entrant jet played an important role in the stability of ventilated regimes although cavitation shedding dynamics has been extensively studied both experimentally and numerically arndt et al 2000 gopalan and katz 2000 laberteaux and ceccio 2001 lyer and ceccio 2002 ji et al 2013 huang et al 2013 chen et al 2016 wang et al 2017a b c wu et al 2018 relatively fewer studies exist for the ventilated cavitation behind a bluff body as the flow passes over a bluff body various kinds of vortices form develop and interact with each other in the wake which will lead to vibration noise large fluctuating pressure forces or resonance williamson 1966 balachandar and ramamuthy 1999 brandner et al 2010 ganesh et al 2016 huang et al 2014 the characteristics of vortex shedding in non cavitating flows over a bluff body have been widely studied gerrard 1966 yarusevych et al 2009 it is well known that the fluid dynamics past a bluff body are complex which involve the interaction of the boundary layer the free shear layer and the wake however cavitating flow is one kind of multiphase flow and so the fluid dynamics in the bluff body wake are physically more complicated belahadji et al 1995 investigated global conditions of inception and development of cavitation in the rotational structures of the turbulent wake they found that the strouhal number and vortex street depended strongly on the development of cavitation cavitation tended to change the flow features in the turbulent wake and made the local mechanism more complex in some extent ausoni et al 2007 concentrated mainly on the effects of cavitation development and fluid structure interaction on the mechanism of the vortex generation they found that for fully developed cavitation the vortex shedding frequency increased up to 15 which was accompanied by the increase of the vortex advection velocity and reduction of the streamwise vortex spacing gnanaskandan and mahesh 2016 demonstrated that cavitation effected the evolution of pressure boundary layer and loads on the cylinder surface in addition cavitation suppressed turbulence and delayed the 3d breakdown of kármán vortices the literature above all indicated that cavitation had a significant influence on the fluid dynamics in the turbulent wake behind a bluff body however except for several studies there has been relatively less research on the phenomenon of cavitating vortex shedding behind a bluff body especially ventilated cavitating vortex shedding the characteristics of ventilated cavitating vortex shedding over a bluff body are still not well understood as there are strong correlations between ventilated cavitation and vortex structures it is important to identify regions of separated flow as well as wake structures to reveal the unsteady vortex behaviors in cavitating flow huang and green 2015 cheng et al 2018 long et al 2018 during these years the finite time lyapunov exponent ftle and lagrangian coherent structures lcs methods are developed to study the intrinsic structures or properties within flows haller 2001 shadden et al 2005 green et al 2007 demonstrated that the lcs method could define time dependent vortex structure boundaries without relying on a pre selected threshold and presented greater visible details without the requirement of velocity derivatives brunton and rowley 2009 applied lcs to visualize the relevant flow in the wake of a flat plate recently some researchers gradually applied the ftle and lagrangian coherent structures lcs methods in cavitating flow tang et al 2012 utilized the lcs method to flow dynamics and underlying physics of unsteady turbulent cavitating flows these researches showed that the lcs was a powerful method to help identify and add the description of the dynamical features of different vortex dominated flow fields in this work the main goal is to improve the understanding of characteristics of ventilated cavitating vortex shedding over a bluff body the paper is organized as follows section 2 is the numerical method sections 3 shows the numerical setups and descriptions in section 4 the ftle is applied to display the influence of ventilated cavitation on the formation evolution and shedding of vortices in addition the relationship between the vortex shedding process and unsteady loads is discussed 2 numerical model the numerical results shown in this paper are performed using the commercial cfd code cfx to solve the unsteady navier stokes equations by the les wall adapting local eddy viscosity wale model nicoud and ducros 1999 the homogeneous model assumes that the transported quantities with the exception of volume fraction for that process are the same for all the governing equations are shown as follows 1 ρ m t ρ m u j x j 0 2 ρ m u i t ρ m u i u j x j p x i x j μ m u i x j here u is the velocity p is the pressure the mixtured density ρ m and dynamic viscosity μ m are defined as 3 ρ m ρ l α l ρ g α g 4 μ m μ l α l μ g α g where ρ l is the liquid density ρ g is the gas density which is a function of pressure and temperature α l is the liquid fraction α g is the gas fraction α l 1 α g applying a favre filtering operation to equs 1 and 2 gives the les equations 5 ρ t ρ u j x j 0 6 ρ u i t ρ u i u j x j p x i x j μ u i x j τ i j x j where over bar denotes a filtered quantity by comparing equ 2 with equ 6 there is an extra nonlinear term τ ij which is called the sub grid scale sgs stress it includes the effect of the small scales and is defined by 7 τ i j ρ u i u j u i u j the large scale turbulent flow is solved directly and the influence of the small scales is taken into account by appropriate subgrid scale sgs models an eddy viscosity approach is used which relates the subgrid scale stresses τ ij to the large scale strain rate tensor s i j in the following way 8 τ i j 1 3 τ k k δ i j 2 μ t s i j 9 s i j 1 2 u i x j u j x i the s i j is the rate of strain tensor for the resolved scale and the sub grid scale turbulent is closed by the les wall adapting local eddy viscosity wale model nicoud and ducros 1999 10 μ t ρ l s 2 s i j d s i j d 3 2 s i j s i j 5 2 s i j d s i j d 5 4 where s i j d and l s in the wale model are defined respectively as 11 s i j d 1 2 g i j 2 g j i 2 1 3 δ i j g k k 2 g i j 2 g i k g k j g i j u i x j l s min k d c s v 1 3 s i j d denotes the traceless symmetric part of the square of the velocity gradient tensor and δ i j is the kronecker symbol l s is the sub grid scale mixing length k is von karman s constant d is the distance to the closest wall v is the volume of the computational cell and c s is the wale constant having the default value of 0 35 the main advantages of the wale model are the capability to reproduce the laminar to turbulent transition and the design of the model to return the correct wall asymptotic y 3 variation of the sgs viscosity 3 numerical set and description the computational domain follows the boundaries of the cavitation tunnel 35d in length 9 5d in height and 3 5d in width as shown in fig 1 d is the diameter of bluff body d 0 02 m the total mesh nodes are 13 225 000 a no slip boundary condition is imposed on the test body surface the top bottom front and back boundaries of the tunnel are free slip a constant turbulent intensity of 2 is set at the inlet boundary of the domain and is equal to the experimentally measured mean turbulent intensity on the inlet boundary of the domain the volume fraction of gas is 0 while the volume fraction of liquid is 1 the inlet boundary of the gas injection is based on volume flow rate on this boundary the volume fraction of gas is 1 while the volume fraction of liquid is 0 all ventilated cavitating runs have been initialized with steady state fully wetted calculations at the initial time step the corresponding power spectrum density psd of the pressure coefficient fluctuation with a distance x d 0 6 is shown in fig 2 the resolved scales seem to be asymptotic to an inertial subrange reasonably close to f 5 3 scaling ji et al 2015 in this study the reynolds number is defined as re u d ν where u is the free stream velocity ν is the kinematic viscosity the gas entrainment coefficient q v is defined as q v q u d 2 where q is the volumetric flow rate of the injected gas 4 lagrangian coherent structures in order to study the intrinsic structures or properties within the flows haller and yuan 2000 developed a trajectory based approach from a lagrangian perspective by considering the fluid as a dynamical system of fluid particles in this method the lcss are defined as the ridge of the finite time lyapunov exponent in a finite time period t 0 t 0 t le at the given point x 0 the finite time version of the cauchy green deformation tensor δ shadden et al 2005 can be defined as 12 δ t 0 t l e x 0 x t 0 t l e t 0 x 0 x 0 t x t 0 t l e t 0 x 0 x 0 where the x t 0 t le t 0 x 0 is the final position of x 0 after a finite time t le t is the transpose of the deformation gradient tensor then the finite time lyapunov exponent with a finite integration time t le can be expressed as 13 σ t 0 t l e x 0 1 t l e ln λ max δ t 0 t l e x 0 here λ max δ t 0 t l e x 0 is the maximum eigenvalue of cauchy green deformation tensor 5 results and discussion 5 1 the influence of ventilated cavitation on the characteristics of vortex shedding the vortex shedding behind a bluff body has been investigated by a numerical method at a constant reynolds number of re 6 7 104 fig 3 shows the instantaneous structures in the form of q criterion iso surfaces q 5000 1 s2 colored by volume fraction of gas top and vorticity ω z middle and bottom at gas entrainment coefficient q v 0 and q v 0 0231 respectively although a similar pattern of bénard kármán vortex street forms in the wake behind the bluff body for both cases ventilated cavitation plays an important role in the characteristics of the vortex street when the gas is injected into the flow q v 0 0231 the gas is entrapped in the vortices and preferentially concentrated in the cores of the vortices compared with q v 0 the spanwise vortices distort and some opposite sign of vorticity is blend into vortex at q v 0 0231 for the positive vortex counter clockwise vorticity a as shown in the front view in fig 3 b some negative vorticity clockwise vorticity is entrained into the positive vortex the horizontal distance λ between the vortices of the opposite rotational direction decreases in terms of the streamwise vortices the number of streamwise vortices increases and the distance l between the streamwise vortices decreases in order to reveal the influence of ventilated cavitation on the primary vortices spanwise vortices the instantaneous of ventilated cavitation shape left wang et al 2018 the time averaged volume fraction of gas middle and statistical reynolds stress u i u j u i u j u i u j with time averaged streamlines right at the cross sectional are shown in fig 5 to minimize the measurement uncertainties more than six cycles of instantaneous fields are averaged to obtain the statistical reynolds stress fields and average streamlines the strouhal number st fd u and the formation length l f versus q v are displayed in fig 6 the formation length is the distance from the downstream of the bluff body along the centerline to the first peak in fluctuating velocity gnanaskandan and mahesh 2016 to compare with non cavitating flow the strouhal number and the formation length are normalized by its corresponding non cavitating values st nc and l fnc st nc 0 11 and l fnc d 1 4 in the non cavitating flow gerrard 1966 found that the formation region behind the bluff body played an important role in the vortex shedding frequency at the shear layer transition regime re 1000 to 200 000 the formation length decreases with the increase of re schiller and linke 1933 roshko 1954b williamson 1996 the sketch of formation region shown in fig 4 indicates that the flow can be divided into three parts ie a b c respectively flow a is entrained by the growing vortex flow b enters the upper shear layer and then cuts it flow c is in the interior of the formation region the size of the formation region is mainly determined by the balance between flow b and c the experimental structures with filament lines illustrate the sketch of the formation region within the rolling up shear layers see fig 5 combining the filament lines see fig 4 with the formation length l f see figs 5 and 6 it can be clearly seen that at different gas entrainment coefficients the dramatic changes take place in the flow component and the formation length at q v 0 three parts of flow a b and c are all liquid the upper vortex entrains the lower side fluid a across the wake to enter the vortex the flow b enters the upper shear layer and eventually cuts off the vorticity feeding to vortex fluid c moves back toward bluff body and find its way into the interior of formation region comparing with non cavitating q v 0 flow c in the formation region is still liquid while the entrainment flow a and b are composed of the mixture of liquid and gas at q v 0 0231 the strouhal number st corresponding to vortex shedding increases the injection of gas adds kinetic energy into the flow and promote the evolution of vortex so the formation region shrinks in size which may be the reason why the strouhal number increases at q v 0 0231 by comparison of q v 0 with further increase of the gas entrainment coefficient q v the flow a b and c are all composed of the mixture of liquid and gas the ventilated cavity gradually covers the bluff body and the length of cavity l c increases at q v 0 231 the formation region contains not only the evolution of ventilated cavitation vortices but also the development of ventilated cavity which is attached the bluff body although the injection of gas also increases the kinetic energy the development of ventilated cavity behind the bluff body may diffuse more energy this leads that the formation region expands in size which signifies a reduction of vortex shedding frequency 5 2 unsteady vortex structure at variable flow patterns to reveal the influence of ventilated cavitation on the formation evolution and shedding of vortices the photographs of ventilated cavitation the vorticity ω z contours with streamlines and the backward time ftle finite time lyapunov exponent contours in the middle plane at q v 0 q v 0 0866 q v 0 231 are shown in fig 8 fig 10 and fig 12 the ftle and lcss can be regarded as a useful method to get a better understanding of the flow dynamics haller and yuan 2000 tang et al 2012 the integration time is 0 85t where t is the period of vortex shedding process lagrangian coherent structures in dark red are observed as the ridges of the ftle field the time evolutions of the lift coefficients c l lift 0 5ρu 2 ld and drag coefficients c d drag 0 5ρu 2 ld at different flows are displayed in fig 7 fig 9 and fig 11 here l is the spanwise length 5 2 1 the non cavitating flow in the non cavitating flow a periodic state associated with bénard kármán vortex shedding occurs in the turbulent wake behind the bluff body at t 1 the upper shear layer becomes strong enough to draw the lower circulation across the wake then the part drawn by the upper zone moves upwards and cuts off the upper shear layer і at the black point see fig 8a a large negative vortex v1 clockwise vorticity develops and prepares for shedding from the upper part of the bluff body at t 2 the upper vortex v1 has already shed into the wake it rotates and moves downstream the lower shear layer begins to develop at this instant the lift coefficient reaches the minimum value at t 3 t 4 the lower vortex v2 continues to be fed by circulation from the shear layer the lift coefficient gradually increases as the lower vortex develops at t 4 the lower shear layer is cut off at the black point see fig 8d right at t 5 the lower vortex is separated from the lower shear layer the new negative vortex v3 clockwise vorticity begins to grow at this instant the lift coefficient is the maximum value 5 2 2 the ventilated cavitating flow while maintaining the reynolds number at 6 7 104 the gas is injected into the turbulent wake there still exists the alternate shedding in the wake with the lower and upper vortices the vortex shedding process can be visualized by the presence of the gas cavities from the photographs and the contours it can be found that good agreements of predicted and experimental vortex shedding process are obtain comparing with non cavitating flow the vortex shedding process changes due to ventilated cavitation at q v 0 0866 it can be clearly seen that the injection of gas forms separate bubbles and the small bubbles are entrapped into the upper cavitating vortex v1 clockwise vorticity at t 1 the bottom circulation with vorticity of opposite sign counter clockwise vorticity is entrained across the wake to enter not only upper shear layer but also the upper vortex see і it splits the upper circulation into two parts at the black point see fig 10 a right the rear part of the upper circulation zone becomes the first cavitating vortex v1 which is the mixture of negative and positive vorticity at t 2 the upper cavitating vortex is going to shed from the upper shear layer while the front part of upper circulation zone is taken by the lower zone the lift coefficient reaches the minimum value at this moment the value is smaller than that at q v 0 at t 3 the upper cavitating vortex v1 moves downstream in the core of cavitating vortices the volume fraction of gas is larger and the vorticity is opposite to that of the vortex the lower vortex v2 keeps on developing and entrains the upper circulation which can be clearly seen by the photograph of experiments and the vorticity contours the upper circulation which is entrained by the lower circulation zone moves downwards and enters the lower shear layer to split the lower circulation zone the bubble in the upper zone is entrained into the lower cavitating vortex the lift coefficient gradually increases at t 4 t 5 the lower cavitating vortex continues to develop and then sheds into the wake the process is repeated to form a cycle in comparison of q v 0 0866 a fixed ventilated cavity attaches to the bluff body and the ventilated cavitation vortices shed from the rear part of the ventilated cavity at q v 0 231 the mixture of negative and positive vorticity exists in the ventilated cavity zone behind the bluff body in addition both the maximum and minimum values of drag and lift coefficients reduce what s more the process also will change at t 1 the upper vortex generated from the upper side evolves to become a larger vortex v1 a lot of vorticity is stored in the zone of fixed ventilated cavity the strength of vortex becomes weaker and the upper shear layer entrains less circulation of the lower zone simultaneously a lower circulation zone begins to develop at t 2 t 3 the upper vortex is shed from the trailing edge of the ventilated cavity the shed vortex v1 aligns on the symmetry line of the wake and moves downstream at the same time the lower vortex gradually rolls to grow at t 4 t 5 the process is also repeated to form a cycle 5 2 3 the comparison at different flows by ftle the ftle with lcss has the advantage of defining the structures boundaries and recognizing the vortices without depending on the preselected a threshold green et al 2007 tang et al 2012 fig 13 gives the instantaneous ftle contours with initial location of particles left and the particles trajectories right from the ftle contours it can be clearly seen that the turbulent wake is divided into two parts near wake and far wake in the near wake it displays the formation and development of vortices in the far wake it is the vortex street at different flows the region of near wake changes it is interesting that the length of near wake and the formation region see fig 5 is similar in addition the ftle also displays the structure and motion of vortices at q v 0 the vortex is nearly a circle dx dy it also demonstrates the rotation of vortices when gas is injected into the wake the vortices stretch and distort the length dx decreases and the length dy increases and the rotation of vortices become not evident at q v 0 231 compared with non cavitating flow 6 discussions and conclusions in this study the characteristics of ventilated cavitating vortex shedding over a bluff body are investigated by numerical method the lcss defined by the ridges of the ftle are utilized to detect the formation development and shedding phenomena of the vortex structures for different flows 1 a similar pattern of bénard kármán vortex street forms in the wake behind the bluff body for all cases compared with non cavitating flow the primary vortices stretch both the horizontal distance λ between the spanwise vortices of the opposite rotational direction and the distance l between the streamwise vortices decrease at q v 0 0231 2 there is a correlation between the vortex shedding frequency and the size of formation region compared with non cavitating flow the strouhal number corresponding to vortex shedding increases but the length of formation region decreases when the gas entrainment coefficient is q v 0 0231 with further increase of gas entrainment coefficient the strouhal number reduces gradually and the length of formation region increases 3 the finite time lyapunov exponent ftle and lagrangian coherent structures lcs methods are applied to detect the structures boundaries and recognize the vortices the ventilated cavitation plays an important role in the turbulent wake compared with non cavitating flow the length of the near wake which contains the formation and development of the vortices decreases at q v 0 0866 with the increase of the q v the cavity cover the bluff body and the length of cavity increases the length of the near wake increases at q v 0 231 in comparison of q v 0 0866 and it is almost the same as that of the formation region in the far wake the rotation of vortices become not evident as that in non cavitating flow at q v 0 231 in addition ventilated cavitation also has an influence on the unsteady loads with the increase of gas entrainment coefficient the highest amplitude values of lift and drag coefficients decrease acknowledgement the authors gratefully acknowledge support by the national science foundation of china nsfc grant nos 91752105 and 51679005 national natural science foundation of beijing grant no 3172029 and chines advanced research of equipment fund 61402070401 and 61402070501 the authors also appreciated the funding support from graduate technological innovation project of beijing institute of technology 2017cx10043 and china scholarship council 201706030087 
23364,for members located near the free surface an intermittent effect caused by the free surface fluctuation makes statistical properties of fluid particle kinematics different therefore a linearization coefficient of the drag force derived under the assumption that the particle velocity and acceleration follow the gaussian process are not valid above the still water level the present paper derives the linearization coefficient for the drag force considering the intermittent effect force spectra and mean values of force maxima at each location are compared between nonlinear and linearized drag force to verify the validity of the proposed coefficient the linearization coefficients derived from fully submerged section are constant irrespective of the observation position and it tends to underestimate both the mean values of peak forces and force spectra as the observation height increases near the free surface the proposed linearization coefficient reflects the effect of the free surface fluctuation and improves the error between the nonlinear and linear drag with increasing observation position keywords linearization coefficient morison force force spectrum fatigue damage intermittent effect 1 introduction slender members have widely been used in many offshore structures such as offshore fixed wind turbines and jacket structures in general wave forces acting on these slender members are calculated from the morison s equation in combination with linear random wave theory the validity of linear random wave theory used to predict the particle kinematics in random wave field was proven at continuously submerged points by charkrabarti 1980 however if points of interest are located near the free surface the particle kinematics are changed due to the intermittent effect wave forces act discontinuously at those points because that points are intermittently submerged due to free surface fluctuation the phenomenon that fluid particle kinematics change by free surface fluctuation is called the intermittent effect tung 1975 proposed linear intermittent random wave theory that calculates particle kinematics in intermittent flow by linear random wave theory below the free surface and assuming that all properties are zero above the free surface the probability density functions and statistical moments of particle velocity acceleration and pressure were derived through the linear intermittent random wave theory anastasiou et al 1982 indicated the importance of second order effects in wave forces and tung and huang 1983 1985 derived the probabilistic models and particle kinematics in intermittent flow using the second order stokes wave theory tung 1995 conducted a study on the magnitude of the effect of the intermittent effect and the conditions that could have a significant effect the morison s equation consists of two terms the first one is drag force which is proportional to the square of velocity and the other one is inertia force which is proportional to acceleration due to nonlinearity in drag force it is difficult to calculate force spectral density borgman 1967 suggested force spectral density for fully submerged case because it is not easy to estimate force spectral density reflecting the complete form of morison s equation as it is a linearization coefficient was introduced to linearize nonlinear drag term in the morison s equation pajouhi and tung 1975 extended tung s work 1975 to derive covariance function of morison force which preserves nonlinear drag term the force spectral density which is a fourier transform pair of the covariance function was also derived by numerical integration of a lengthy formula in their work approximate form of force spectral density was also suggested to simplify formula for force spectral density isaacson and baldwin 1990a 1990b proposed analytic formula for the probability density function of force maxima and simplified force spectral density near the free surface and verified the formula by experiments the intermittent effect was not significant below the free surface but the force spectrum was greatly reduced by the intermittent effect above the surface isaacson and subbiah 1991 verified the derived theoretical model through numerical analysis in time domain and mentioned the effect of simulation time and random phase of wave on numerical analysis results many researches pointed out the limitation of borgman s linearization coefficient brouwers and verbeek 1983 compared fatigue damages and extreme responses caused by nonlinear drag and linearized drag force calculated by borgman s coefficient 1967 the linear method significantly underestimated the expected fatigue damages and extreme response when drag is dominant an alternative approach to determine the linearization coefficient for drag force in morison s equation was investigated by wolfram 1999 he explained that a least square approach used in borgman s work was adequate if the ultimate goal was to minimize the time average of nonlinear and linearized drag force however in engineering point of view truly important things are extreme response or fatigue damage not load itself proposed linearization approach was to find the coefficient that could match the expectation values of force maxima of nonlinear and linearized drag force existing linearization coefficients suggested by borgman and wolfram were estimated based on fully submerged condition isaacson and baldwin 1990b also proposed linearization coefficient in intermittent flow but it was also obtained by a least square method that may underestimate extreme responses and fatigue damages in this present study the linearization coefficient in intermittent flow is investigated the expectation values of force maxima of nonlinear and linearized drag force in intermittent flow are derived finally the linearization coefficient is proposed by comparing two expectation value and is verified by numerical simulations this paper consists of four parts part 2 is devoted to explain how to derive the expectation value and linearization coefficient the procedure and results of numerical simulation is discussed in part 3 finally the conclusion is presented in part 4 2 derivation of linearization coefficient in intermittent flow 2 1 linear intermittent random wave theory and the probabilistic density function of force maxima 2 1 1 linear intermittent random wave theory the linear random wave theory lrwt has been verified in a number of studies for its accuracy in predicting particle kinematics at a fully submerged point the surface elevation derived from the lrwt follows a zero mean gaussian process and could be expressed as a wave spectrum in frequency domain particle velocity and acceleration at x 0 are linearly proportional to the surface elevation and its derivative as eq 1 3 1 η x t h 2 cos ω t where η s u r f a c e e l e v a t i o n h w a v e h e i g h t ω a n g u l a r f r e q u e n c y t t i m e 2 u z t h 2 ω g z cos ω t u 0 g z cos ω t ω g z η where u horizontal particle velocity d water depth u 0 h 2 ω velocity amplitude g z cosh k z d s i n h k d w h e r e z 0 o t h e r w i s e g z 1 t a n h k d k wave number 3 a z t u t h 2 ω 2 g z sin ω t u 0 ω g z sin ω t ω g z η where a horizontal particle acceleration however in the vicinity of the free surface the particle kinematics are discontinuous due to the surface fluctuation tung 1975 proposed the linear intermittent random wave theory to express particle kinematics in intermittent flow as described in fig 1 this approach estimates particle kinematics near the free surface by comparing the surface elevation η and observation position h when η is larger than h which means that the observation point is immersed particle kinematics are calculated based on lrwt and otherwise all properties are assumed to be zero the particle velocity u and acceleration a in intermittent flow derived from the linear intermittent random wave theory are expressed as eq 4 mathematically 4 u z t u z t y η t h a z t a z t y η t h where y heaviside function y x 0 x 0 1 x 0 the probability density functions of the particle velocity p u and acceleration p a at h are expressed by tung 1975 as eqs 5 and 6 5 p u 1 q b δ u 1 σ u z u σ u q b r u σ u 1 r 2 where σ u the standard deviation of particle velocity at h δ x d i r a c d e l t a f u n c t i o n r 1 σ η σ u 0 s u η ω d ω 1 σ η σ u 0 ω g z s η ω d ω the cross spectral density between u and η σ η the standard deviation of elevation b h σ η z λ 1 2 π e x p λ 2 2 q b b z λ d λ 6 p a 1 q b δ a 1 σ a z a σ a q b where σ a the standard deviation of particle acceleration at h the q in above equations is the probability that the surface elevation exceeds the observation height when the observation point is always submerged q goes to unity and the probability density function of u and a become gaussian distribution like fully submerged case pajouhi and tung 1975 derived spectral density functions for particle velocity acceleration and pressure in intermittent flow by extending tung s work 1975 as eqs 7 and 8 7 s u ω ω g z q b σ u σ η r b z b 2 s η ω h u ω 2 s η ω where s u ω spectral density of particle velocity in intermittent flow s η ω wave spectrum h u ω transfer function for particle velocity 8 s a ω i ω 2 g z q b 2 s η ω h a ω 2 s η ω where h a ω transfer function for particle acceleration 2 1 2 force spectral density the morison s equation is widely used to calculate the wave force acting on the slender member and it consists of drag force and inertia force term as shown in eq 9 9 f f d f i 1 2 ρ c d d u u ρ π d 2 4 c m a k d u 0 2 cos ω t cos ω t k m u 0 ω sin ω t where ρ sea water density kg m 3 d the diameter of the member c d c m empirical drag and inertia coefficients k d 1 2 ρ c d d k m ρ π d 2 4 c m it is difficult to obtain force spectral density for a complete form of morison s equation due to the nonlinear drag term in it borgman 1967 derived the force spectral density for fully submerged member by linearizing the nonlinear drag term linearization coefficient was introduced to linearize the morison s equation by borgman by substituting the coefficient morison s equation could be linearized as eq 10 and the force spectral density for fully submerged case could be derived as eq 11 10 f l k d β u k m a k d u 0 cos ω t k m u 0 ω sin ω t where β 8 π σ u k d k d β 11 s f ω k d 2 β 2 s u ω k m 2 s a ω ω 2 g 2 z k d 2 β 2 k m 2 ω 2 s η ω where s u ω ω 2 g 2 z s η ω s a ω ω 4 g 2 z s η ω when the points of interest are located near the free surface it is hard to assume that particle velocity u is a gaussian process pajouhi and tung 1975 proposed a lengthy formula for covariance function and spectral density for a complete form of morison s equation which retains the nonlinear drag term considering the intermittent effect the force spectral density could be obtained by integrating the covariance function numerically so they gives approximate form of force spectral density based on taylor series expansion isaacson and baldwin 1990b pointed out necessity for modification of linearization coefficient in intermittently submerged case and derived a linearization coefficient as eq 12 12 β u 3 u 2 where the time averaged or expectation value expectation values required to calculate 12 could be estimated numerically from probability distribution function of u in 5 the approximate form of force spectral density s f ω in intermittent flow was derived by using the linearization coefficient β and spectral densities of u and a as eq 13 isaacson and baldwin 1990b 13 s f ω k d 2 β 2 s u ω k m 2 s a ω k d 2 β 2 1 σ u r b z b σ η q b ω g z 2 k m 2 ω 2 ω 2 g 2 z q 2 b s η ω 2 1 3 the probabilistic density function of force maxima from the structural design point of view extreme responses and fatigue damage are of interest rather than load itself therefore many studies were conducted to derive not only the probability distribution function of the force but also the force maxima which is related to the extreme load in fully submerged case force maxima occurs when the time derivative of eq 9 goes to zero so the maximum value of morison force is expressed as eq 14 14 f p z u 0 ω g z k m f o r u 0 σ u 2 k u 0 2 g 2 z k d k m 2 ω 2 4 k d f o r u 0 σ u 2 k where f p force maxima k k d σ u k m ω the ratio of drag force to inertia force the probability density function of force maxima for narrow banded wave spectrum in fully submerged member was derived by borgman 1965 as eq 15 15 p ζ ζ e x p 1 2 ζ 2 f o r ζ ζ c ζ c e x p 1 2 ζ c 2 ζ ζ c f o r ζ ζ c where ζ 2 2 f p ω 0 2 k m h r m s g z h r m s the root mean square wave height ω 0 modal frequency ζ c 2 k m k d h r m s g z a measure of the relative contributions of inertia and drag force the probabilistic distribution model of force maxima near the free surface also changes due to the intermittent effect although a continuous force reaches its maximum force maxima observed near the free surface could differ from peak value of the continuous force if waves do not reach the observation point in other words the value of force maxima near the free surface could be influenced by the relation between the phase θ m at which the peak value of continuous force occurs and the phase θ 0 when water first reaches the observation point isaacson and baldwin 1990b derived the value of force maxima in intermittent flow by using the relationship between θ m and θ 0 as shown eq 16 and the probability density function of force maxima was also derived as eq 17 16 f p h 0 f o r h 2 h u 0 2 g 2 z k d cos θ 0 cos θ 0 u 0 ω g z k m sin θ 0 f o r h 2 h a n d θ 0 θ m u 0 2 g 2 z k d k m 2 ω 2 4 k d f o r h 2 h a n d θ 0 θ m where θ 0 cos 1 2 h h θ m π 2 f o r k m g z h k d otherwise θ m sin 1 k m g z h k d 17 p ξ γ γ δ ζ f o r ζ 0 0 f o r 0 ζ γ ζ γ e x p 1 2 ζ γ 2 γ ζ c f o r γ ζ ζ c γ ζ c e x p 1 2 ζ c 2 ζ ζ c f o r ζ ζ c γ where γ x 1 e x p x 2 2 gamma function γ b 2 2 ζ c the probability model for maxima of morison force in a wide band wave spectrum deviating from the narrow band assumption in which the spectral density is not concentrated at one frequency has also been studied however it is difficult to develop a complete form of expression and approximate forms were investigated by tung 1974 tickell 1977 and moe and crandall 1978 2 2 linearization coefficients in fully and intermittently submerged member 2 2 1 coefficients for fully submerged member to approximate the spectral density of the morison force the linearization coefficients was first proposed by borgman 1967 the borgman s coefficient was estimated by minimizing the error between nonlinear and linearized morison force during entire time span a least square method was applied to minimize the error and the coefficient k d was derived by eq 18 18 f f l 2 k d 2 k d u 2 u k d u 2 0 k d k d u 2 u u 2 based on the linear wave theory in the fully submerged section the particle velocity u follows the gaussian process of zero mean so the second and third moments of u are σ u 2 and 8 π σ u 3 respectively therefore the borgman s coefficient for fully submerged condition could be derived by substituting statistical moments in eq 18 that is the borgman s coefficient is only proportional to the standard deviation of the particle velocity σ u at that location and the other variables do not affect the coefficients 19 k d β k d 8 π σ u 3 σ u 2 k d 8 π σ u brouwers and verbeek 1983 compared fatigue damages calculated by nonlinear and linearized morison s equations by borgman respectively when the ratio of drag force to inertia force k is small which means that inertia force is dominant linearized force could predict well the fatigue damage calculated by the nonlinear force but it was found that linearized force tend to underestimate fatigue damages in region where drag force is not negligible they also pointed out that the error increases as the slope of s n curve increases because borgman s coefficient is calculated by minimizing the time average of error between nonlinear and linear morison force it may underestimate the value of peak forces deviated largely from the mean value the limitations of borgman s coefficient were reviewed and an alternative approach to linearize morison s equation for a narrow band wave was proposed by wolfram 1999 the important responses such as extreme responses and fatigue damage are related to the force maxima not force itself thus the approach was to match the expectation values of the force maxima of the nonlinear and linearized morison force because expectation value is defined as integrating the product of probability density function and random variable in the whole region the expectation value of force maxima in complete morison s equation is calculated by integrating the product of eq 14 and the probability density function of the amplitude of particle velocity p u 0 as eq 20 because the wolfram s coefficient was derived just below the free surface g z in eq 14 was taken as 1 in his work 20 e f p 0 σ u 2 k p u 0 u 0 ω m v k m d u 0 σ u 2 k p u 0 u 0 2 k d k m 2 ω m v 2 4 k d d u 0 ω m v k m 0 σ u 2 k p u 0 u 0 d u 0 k d σ u 2 k p u 0 u 0 2 d u 0 k m 2 ω m v 2 4 k d σ u 2 k p u 0 d u 0 where ω m v the mean zero up crossing frequency of particle velocity in lrwt the particle velocity at a fully submerged point is assumed to be a zero mean gaussian process thus the amplitude of particle velocity follows the rayleigh distribution after substituting the rayleigh distribution and integrating three terms in eq 20 the expectation value is expressed as eq 21 21 e f p k d σ u 2 e x p 1 8 k 2 1 4 k 2 2 1 k π 2 e r f 1 2 2 k as for the expectation value in linearized morison s equation the value of peak force could be obtained by differentiating eq 10 respect to time and equating it to zero 22 f p l u 0 k d 2 k m 2 ω 2 therefore the expectation value of force maxima in linearized morison s equation is derived as eq 23 23 e f p l 0 f u 0 u 0 k d 2 k m 2 ω m v 2 d u 0 σ u π 2 k d 2 k m 2 ω m v 2 finally the linearization coefficient that make the force maxima equal in the complete and linearized morison s equations can be obtained by comparing eqs 21 and 23 which can be summarized as eq 24 24 k d k d σ u 2 π e x p 1 8 k 2 1 4 k 2 2 1 k π 2 e r f 1 2 2 k 2 1 k 2 k d β k d σ u c 1 k where c m k β σ u in case of fatigue damage it is proportional to mth power of stress range not stress range therefore linearization coefficient to match fatigue damages calculated by nonlinear and linear drag force should be calculated by equating the expectation values of mth power of force maxima wolfram 1999 also derived linearization factor considering this fact and the generalized linearization coefficient was expressed in his work 2 2 2 coefficients for intermittently submerged member unlike the fully submerged case the particle velocity and acceleration in the intermittent flow no longer follow the gaussian process therefore it is necessary to propose a new linearization coefficient through the probability distribution model considering the intermittent effect in vicinity of near free surface in this study the linearization coefficient near the free surface is derived by using the probability distribution model of force maxima and particle velocity in the intermittent flow proposed by tung 1975 and isaacson and baldwin 1990b this coefficient is estimated by equating the expectation values of force maxima for nonlinear and linearized morison s equation as mentioned above when deriving the expectation value for the force maxima in the intermittent flow there are two differences with fully submerged case the probability density function of amplitude of the particle velocity p u 0 and the expectation value of force maxima f p from eq 5 which indicates the probability density function of particle velocity in intermittent flow proposed by tung 1975 it is possible to derive the probability function of velocity amplitude as eq 25 25 p u 0 1 q b δ u 0 u 0 σ u 2 e x p u 0 2 2 σ u 2 q b r u 0 σ u 1 r 2 the value of force maxima expressed in eq 16 could be rewritten as a function of velocity amplitude as eq 26 in deep water g z is assumed to be 1 near the free surface where z approaches to zero 26 f p h 0 f o r u 0 ω h ω 2 k d h 2 ω k m u 0 2 ω 2 h 2 f o r ω h u 0 σ u 2 4 k 2 ω 2 h 2 u 0 2 k d k m 2 ω 2 4 k d f o r σ u 2 4 k 2 ω 2 h 2 u 0 the expectation value of force maxima in intermittent flow is derived from eqs 25 and 26 in order to reflect the effect of m which is the slope of s n curve on the linearization coefficient the expectation value for mth order of force maxima is derived in case of the complete morison s equation in a narrow band wave spectrum the expectation value is expressed as eq 27 27 e f p m h ω m v h σ u 2 4 k 2 ω m v 2 h 2 p u 0 f a m d u 0 σ u 2 4 k 2 ω m v 2 h 2 p u 0 f b m d u 0 where f a ω m v 2 k d h 2 ω m v k m u 0 2 ω m v 2 h 2 f b u 0 2 k d k m 2 ω m v 2 4 k d the two integral terms f a m f b m are expanded as eqs 28 and 29 by binomial theorem 28 f a m p 0 m c m p ω m v k m u 0 2 ω m v 2 h 2 p ω m v 2 k d h 2 m p p 0 m c m p k m p ω m v 2 m p u 0 2 ω m v 2 h 2 p 2 k d m p h 2 m 2 p where c m p m m p p 29 f b m p 0 m c m p k m 2 ω m v 2 4 k d p u 0 2 k d m p p 0 m c m p 2 2 p k m 2 p ω m v 2 p k d m 2 p u 0 2 m 2 p by substituting eqs 28 and 29 into eq 27 it can be rewritten as sum of eqs 30 and 31 30 p 0 m c m p k m p ω m v 2 m p k d m p h 2 m 2 p ω m v h σ u 2 4 k 2 ω m v 2 h 2 p u 0 u 0 2 ω m v 2 h 2 p 2 d u 0 31 p 0 m c m p 2 2 p k m 2 p ω m v 2 p k d m 2 p σ u 2 4 k 2 ω m v 2 h 2 p u 0 u 0 2 m 2 p d u 0 two integral terms in eqs 30 and 31 are not be possible to express explicit forms so they should be evaluated through a numerical method in linearized morison s equation as eq 10 the values of force maxima in intermittent flow are derived from eq 26 the phase angle θ m at which the peak of continuous force occurs in the linearized morison force could be evaluated by differentiating eq 10 with respect to time and be expressed as eq 32 32 f l t u 0 ω k d sin θ m k m ω cos θ m 0 θ m tan 1 k m ω k d the phase angle θ m in eq 32 is expressed as a function of linearization coefficient k d since this is related to continuous force it could be assumed that it is equal to the wolfram s coefficient eq 24 derived from fully submerged condition by substituting eq 24 to eq 32 the θ m of linearized morison force could be expressed as eq 33 33 θ m tan 1 k m ω k d tan 1 k m ω k d σ u c w tan 1 1 c w k where c w wolfram s coefficient m 1 by comparing θ m and θ 0 the peak values of linearized morison force in intermittent flow at h is derived as eq 34 34 f p l h 0 f o r u 0 ω h ω k d h ω g z k m u 0 2 ω 2 h 2 f o r ω h u 0 ω h 1 c w 2 k 2 1 u 0 k d 2 k m 2 ω 2 f o r ω h 1 c w 2 k 2 1 u 0 the expectation value for mth order of force maxima in linearized morison force for a narrow band wave spectrum could be derived as the same manner 35 e f p l m h ω m v h ω m v h 1 c w 2 k 2 1 p u 0 f c m d u 0 ω m v h 1 c w 2 k 2 1 p u 0 f d m d u 0 where f c ω m v k d h ω m v k m u 0 2 ω m v 2 h 2 f d u 0 k d 2 k m 2 ω m v 2 the two integral terms f c m f d m are expanded as eqs 36 and 37 by binomial theorem 36 f c m p 0 m c m p ω m v k m u 0 2 ω m v 2 h 2 p ω m v k d h m p p 0 m c m p k m p ω m v m k d m p h m p u 0 2 ω m v 2 h 2 p 2 37 f d m k d 2 k m 2 ω m v 2 m 2 u 0 m by substituting eqs 36 and 37 into eq 35 it can be rewritten as sum of eqs 38 and 39 38 p 0 m c m p k m p ω m v m k d m p σ u m p c m p h m p ω m v h ω m v h 1 c w 2 k 2 1 p u 0 u 0 2 ω m v 2 h 2 p 2 d u 0 39 k d m σ u m c 2 1 k 2 m 2 ω m v h 1 c w 2 k 2 1 p u 0 u 0 m d u 0 c in eqs 38 and 39 was defined in wolfram s work as a function of k and m but observation height h is added as an input factor for c in this present work the expectation value for mth order of force maxima in linearized morison s equation can be expressed as a summation of eqs 38 and 39 and the integral terms should be evaluated by numerical integration because c is defined as the value that makes both expectation values of nonlinear and linearized drag force c could be evaluated by comparing eqs 27 and 35 finally c is expressed as a function of k m and h as shown in eq 40 40 k d c m k h k d σ u finally the linearization coefficient c m k h in intermittent flow could be calculated by equating the expectation values in nonlinear and linearized morison s equations fig 2 shows linearization coefficients with the ratio of drag force to inertia force k at different observation heights h since the influence of the drag is small in a small region of k k 0 2 the linearization coefficients are also small in that region as k increases the linearization coefficients increase and then converge to a specific value like wolfram s coefficient the converged value 1 654 is similar to wolfram coefficient 1 595 when observation height is small in the intermittent flow the observed height h also have an impact on the linearization coefficient as shown in fig 2 the proposed linearization coefficient increases as h increases as the observation position increases the number of waves reaching it decreases whereas the all arriving wave have high wave amplitudes because the amplitude of particle velocity has a linear relationship with wave amplitude the amplitude of velocity should be large when the wave amplitude is large this tendency is reflected in the proposed linearization coefficient and it can be interpreted that the linearization coefficient increases with the increase in the observation position the linearization coefficients with different m values are also compared to evaluate the effect of the slope of s n curve in the coefficient as mentioned in the study of brouwers and verbeek 1983 the borgman approximation underestimates the fatigue damage and the error increases as the slope of s n curve increases the proposed coefficient is also considered the effect of the slope of s n curve like wolfram s work as seen in fig 3 the linearization coefficient increases as m increases although all three lines are calculated at the same height 3 numerical simulation 3 1 simulation condition in order to evaluate the validity of the proposed linearization coefficients numerical simulation is performed to calculate particle kinematics and morison force acting on fixed cylinder protruding the free surface in the time domain the wave spectrum used to generate random wave field is modified pm spectrum ittc spectrum proposed by pierson and moskowitz 1964 the simulations were conducted in nine different sea states where significant wave heights and mean zero upcrossing periods were 5 10 15 m and 10 15 s respectively 41 s η ω 1 4 π h s 2 2 π t z 4 ω 5 e x p 1 π 2 π t z 4 ω 4 where t z mean zero crossing period h s significant wave height a sufficient amount of time record data are required to obtain force spectral densities at all observation points in this present work total time duration of simulation is 1 h and time step is 0 1 s so total number of time records at each location is 36 000 due to uncertainty of time simulation numerical simulations in each sea state were repeated 10 times wave superposition technique which generates irregular sea by superimposing a lot of regular waves is applied to generate random wave field a total of 1000 regular waves are superimposed and the amplitude of each regular waves are determined as deterministic spectral amplitude proposed by rice 1944 42 η t n 1 n a n cos ω n t ε n where a n 2 s η ω n δ ω deterministic spectral amplitude ω n representative frequency ε n phase angle distributed at random 0 ε n 2 π to eliminate repetition during the simulation time representative frequencies in each frequency bin are selected by random variations at the center of the frequency bin particle kinematics above still water level are predicted by vertical stretching method proposed by marshall and inglis 1986 which assumes that all kinematics above still water level are the same at the free surface force coefficients such as drag c d and inertia coefficient c m are taken to be 1 3 and 1 5 respectively as for observation points tung 1995 indicated that free surface fluctuations have almost no effect where the observation height exceeds three times of the standard deviation of wave amplitude thus the normalized observation height b h σ η are taken as range from 0 5 to 3 at intervals of 0 5 so total number of observation points is six 3 2 particle kinematics at each observation points the particle velocity acceleration and drag force are calculated at each observation points linearized drag forces in intermittent flow are calculated using two existing coefficients wolfram 1999 and isaacson and baldwin 1990b and the coefficient proposed in this work to compare the accuracy each other three results such as mean values of force maxima force spectral densities and fatigue damages estimated by nonlinear and linearized drag forces are compared figs 4 7 shows these results obtained in 5th sea state where significant wave height and mean zero upcrossing period are 10 m and 15 s respectively since the intermittent effect is not reflected in the wolfram coefficient linearized drag forces estimated by wolfram s coefficient tend to underestimate the mean values after observation height exceeds b 1 and the error between nonlinear and linearized drag force increases as the observation height increases the errors between nonlinear and linearized drag force by wolfram s coefficients range from 55 5 to 6 5 and the maximum error is observed when b 3 as shown in fig 4 on the other hands the coefficient proposed by isaacson and baldwin gives better results than wolfram s coefficient since it considers the effect of observation height so the coefficients increase as the observation height increases the errors of this coefficient are in the range of 9 4 14 6 the proposed coefficient also considers the intermittent effect so it give similar results to isaacson and baldwin s coefficient the errors of this coefficient ranges from 6 0 to 6 8 since not only linearization coefficients but also the spectral density of the particle velocity affect the accuracy of the force spectral density tung s approximation for the spectral density of velocity in intermittent flow expressed in 7 is compared to the velocity spectra estimated by fourier transformation of time history at first in fig 5 tung s model describes the time simulation results relatively well near peak frequency 0 43 rad s but it deviates from time simulation data above 0 6 rad s when calculating the particle velocity at each observation location if the observation location is not submerged the velocity is converted to zero the higher the observation location the shorter the time that waves reach the observation location it might be the reason that simulated velocity spectrum has larger spectral density than tung s approximation in high frequency range when b exceeds 2 tung s model appears to differ from the time simulation results at peak frequency these error of model for the spectral density of particle velocity affects the force spectral density as well force spectral densities for nonlinear and linearized drag force are calculated in conjunction with tung s model expressed as eq 13 since the values of the three linearization coefficients are similar at b 0 5 which is closest to the free surface the force spectral densities from all coefficients are not significantly different and it seems that these coefficients could describe well the force spectral density of nonlinear drag at b 0 5 however like the mean value of force maxima the wolfram coefficient underestimates the amplitude of force spectral density and the gap increases when b increases the other two coefficients which consider the intermittent effect predict the force spectral densities near peak frequency 0 43 rad s well but they differ from the force spectral densities estimated by nonlinear drag in the frequency range exceeding 0 6 rad s as mentioned above it seems that this difference is caused by the limitation of tung s model finally fatigue damages caused by nonlinear and linearized drag force are compared it is assumed that structural response has a linear relationship with force and cycle counting method such as the rain flow counting method is applied to the time history of stress to obtain the number of cycles and corresponding stress ranges fatigue damage per stress cycle is calculated from s n curve and each fatigue damage is summed based on miner s rule as shown in eqs 43 and 44 43 log n log a m log δ σ where n predicted number of cycles to failure for stress range δ σ δ σ stress range m negative inverse slope of s n curve log a a constant of s n curve 44 d i 1 k n i n i 1 a i 1 k n i δ σ i m d accumulated fatigue damage n i number of stress cycles in stress block i k number of stress blocks n i number of cycles to failure at constant stress range the c curve in seawater with cathodic protection dnv 2011 is used in analysis and the slope m and constant of s n curve log a are 3 0 and 12 192 respectively therefore the wolfram and proposed coefficients that consider the effect of the slope of s n curve are evaluated by equating the expectation values of the 3rd power of force maxima fatigue damage is proportional to 3rd power of linearization factor if the factor underestimates mean value of force maxima or force spectral density fatigue damages evaluated by linearized drag force could be severely underestimated the coefficient suggested by isaacson and baldwin underestimates fatigue damages at all observation points about 70 4 32 8 respect to the fatigue damages caused by nonlinear drag force since this coefficient does not take care of the effect of m on the other hand the proposed coefficient gives better predictions at all observed positions since it reflects the effect of m the errors between nonlinear and linearized drag force estimated by proposed coefficient in fatigue damages are within a range of 34 6 19 5 environmental conditions such as wave height could have an effect on the accuracy of predicted results the errors of mean values of force maxima and fatigue damages calculated by nonlinear and linearized drag force in all sea states are compared in figs 8 and 9 as for the mean value of force maxima proposed linearization coefficient predicted well the simulated results ranging from 12 to 12 regardless of wave height and period however in case of fatigue damage significant wave height has an effect on the accuracy of the results an increase of wave height incur the standard deviation of particle velocity σ u which is term in the numerator of k thus when wave height increases the value of k will rise and linearization coefficient which is an increasing function of k also get bigger considering that the prediction of fatigue damage through the linearization coefficient is usually lower than the simulated value the increase in wave height seems to contribute to reduce the error the mean values of force maxima and fatigue damages were also calculated by linearization coefficient proposed by isaacson and baldwin as seen in figs 10 and 11 this coefficient also predicts well the mean values of force maxima in range of 15 to 15 in all sea states however as mentioned above this coefficient tends to underestimate fatigue damages severely around 70 near the free surface in all sea states 4 conclusion in this present work the expectation values and linearization coefficient for morison s equation above still water level are discussed by considering particle kinematics and probability density functions in intermittent flow the linearization coefficients below still water level derived from the assumptions that the particle velocity follow a zero mean gaussian random process under linear random wave theory were verified in many studies however in the vicinity of the free surface wave force is discontinuous due to the surface fluctuation so particle kinematics and stochastic characteristic are different from that under the free surface especially the influence of the observation height on the linearization coefficient is significant as the observation height increases the expectation value of the force maxima becomes smaller as the number of waves that cannot reach this point increases however since only the high wave arrives the linearization coefficient that approximates them must also increase with the observation height the proposed linearization coefficient is defined as a value that makes the force maxima of the nonlinear and linearized morison forces equal in the intermittent flow the expectation value is calculated by combining the probability model of the velocity amplitude and the peak force value in the intermittent flow the validity of the proposed coefficient is verified through a numerical simulation the wolfram coefficient derived under fully submerged condition does not consider the intermittent effect so it tends to underestimate the force spectral densities near the free surface as for the coefficients proposed by isaacson and baldwin it gives better results in force spectral density and the mean values of force maxima at each observation points however it severely underestimates the fatigue damage this because it was derived by minimizing the time average of the error between nonlinear and linearized drag force although it could predict load itself but it fail to describe the extreme load or fatigue damage that is related to mth power of force maxima the proposed coefficient improves the accuracy of the existing linearization coefficients by reflecting the intermittent effect and correction of the mth power of force maxima at the same time the proposed coefficient is derived based on the linear intermittent random wave theory also narrow band wave spectrum is assumed to derive the coefficient thus when nonlinear effect is large and the waves follow wide band process the present coefficient could not be proper the further investigations for high order intermittent wave theory and wide band process are required acknowledgement this work was supported by the technology innovation program 10062271 development of structural integrity assessment technology for flexible riser of over 7 inch internal diameter at water depth of 1500 m funded by the ministry of trade industry and energy this research was supported by a grant from endowment project of study on the core technology of structural design engineering and test for establishment of structural evaluation system for offshore structure 2 3 funded by korea research institute of ships and ocean engineering pes9470 the institute of engineering research at seoul national university provided research facilities for this work 
23364,for members located near the free surface an intermittent effect caused by the free surface fluctuation makes statistical properties of fluid particle kinematics different therefore a linearization coefficient of the drag force derived under the assumption that the particle velocity and acceleration follow the gaussian process are not valid above the still water level the present paper derives the linearization coefficient for the drag force considering the intermittent effect force spectra and mean values of force maxima at each location are compared between nonlinear and linearized drag force to verify the validity of the proposed coefficient the linearization coefficients derived from fully submerged section are constant irrespective of the observation position and it tends to underestimate both the mean values of peak forces and force spectra as the observation height increases near the free surface the proposed linearization coefficient reflects the effect of the free surface fluctuation and improves the error between the nonlinear and linear drag with increasing observation position keywords linearization coefficient morison force force spectrum fatigue damage intermittent effect 1 introduction slender members have widely been used in many offshore structures such as offshore fixed wind turbines and jacket structures in general wave forces acting on these slender members are calculated from the morison s equation in combination with linear random wave theory the validity of linear random wave theory used to predict the particle kinematics in random wave field was proven at continuously submerged points by charkrabarti 1980 however if points of interest are located near the free surface the particle kinematics are changed due to the intermittent effect wave forces act discontinuously at those points because that points are intermittently submerged due to free surface fluctuation the phenomenon that fluid particle kinematics change by free surface fluctuation is called the intermittent effect tung 1975 proposed linear intermittent random wave theory that calculates particle kinematics in intermittent flow by linear random wave theory below the free surface and assuming that all properties are zero above the free surface the probability density functions and statistical moments of particle velocity acceleration and pressure were derived through the linear intermittent random wave theory anastasiou et al 1982 indicated the importance of second order effects in wave forces and tung and huang 1983 1985 derived the probabilistic models and particle kinematics in intermittent flow using the second order stokes wave theory tung 1995 conducted a study on the magnitude of the effect of the intermittent effect and the conditions that could have a significant effect the morison s equation consists of two terms the first one is drag force which is proportional to the square of velocity and the other one is inertia force which is proportional to acceleration due to nonlinearity in drag force it is difficult to calculate force spectral density borgman 1967 suggested force spectral density for fully submerged case because it is not easy to estimate force spectral density reflecting the complete form of morison s equation as it is a linearization coefficient was introduced to linearize nonlinear drag term in the morison s equation pajouhi and tung 1975 extended tung s work 1975 to derive covariance function of morison force which preserves nonlinear drag term the force spectral density which is a fourier transform pair of the covariance function was also derived by numerical integration of a lengthy formula in their work approximate form of force spectral density was also suggested to simplify formula for force spectral density isaacson and baldwin 1990a 1990b proposed analytic formula for the probability density function of force maxima and simplified force spectral density near the free surface and verified the formula by experiments the intermittent effect was not significant below the free surface but the force spectrum was greatly reduced by the intermittent effect above the surface isaacson and subbiah 1991 verified the derived theoretical model through numerical analysis in time domain and mentioned the effect of simulation time and random phase of wave on numerical analysis results many researches pointed out the limitation of borgman s linearization coefficient brouwers and verbeek 1983 compared fatigue damages and extreme responses caused by nonlinear drag and linearized drag force calculated by borgman s coefficient 1967 the linear method significantly underestimated the expected fatigue damages and extreme response when drag is dominant an alternative approach to determine the linearization coefficient for drag force in morison s equation was investigated by wolfram 1999 he explained that a least square approach used in borgman s work was adequate if the ultimate goal was to minimize the time average of nonlinear and linearized drag force however in engineering point of view truly important things are extreme response or fatigue damage not load itself proposed linearization approach was to find the coefficient that could match the expectation values of force maxima of nonlinear and linearized drag force existing linearization coefficients suggested by borgman and wolfram were estimated based on fully submerged condition isaacson and baldwin 1990b also proposed linearization coefficient in intermittent flow but it was also obtained by a least square method that may underestimate extreme responses and fatigue damages in this present study the linearization coefficient in intermittent flow is investigated the expectation values of force maxima of nonlinear and linearized drag force in intermittent flow are derived finally the linearization coefficient is proposed by comparing two expectation value and is verified by numerical simulations this paper consists of four parts part 2 is devoted to explain how to derive the expectation value and linearization coefficient the procedure and results of numerical simulation is discussed in part 3 finally the conclusion is presented in part 4 2 derivation of linearization coefficient in intermittent flow 2 1 linear intermittent random wave theory and the probabilistic density function of force maxima 2 1 1 linear intermittent random wave theory the linear random wave theory lrwt has been verified in a number of studies for its accuracy in predicting particle kinematics at a fully submerged point the surface elevation derived from the lrwt follows a zero mean gaussian process and could be expressed as a wave spectrum in frequency domain particle velocity and acceleration at x 0 are linearly proportional to the surface elevation and its derivative as eq 1 3 1 η x t h 2 cos ω t where η s u r f a c e e l e v a t i o n h w a v e h e i g h t ω a n g u l a r f r e q u e n c y t t i m e 2 u z t h 2 ω g z cos ω t u 0 g z cos ω t ω g z η where u horizontal particle velocity d water depth u 0 h 2 ω velocity amplitude g z cosh k z d s i n h k d w h e r e z 0 o t h e r w i s e g z 1 t a n h k d k wave number 3 a z t u t h 2 ω 2 g z sin ω t u 0 ω g z sin ω t ω g z η where a horizontal particle acceleration however in the vicinity of the free surface the particle kinematics are discontinuous due to the surface fluctuation tung 1975 proposed the linear intermittent random wave theory to express particle kinematics in intermittent flow as described in fig 1 this approach estimates particle kinematics near the free surface by comparing the surface elevation η and observation position h when η is larger than h which means that the observation point is immersed particle kinematics are calculated based on lrwt and otherwise all properties are assumed to be zero the particle velocity u and acceleration a in intermittent flow derived from the linear intermittent random wave theory are expressed as eq 4 mathematically 4 u z t u z t y η t h a z t a z t y η t h where y heaviside function y x 0 x 0 1 x 0 the probability density functions of the particle velocity p u and acceleration p a at h are expressed by tung 1975 as eqs 5 and 6 5 p u 1 q b δ u 1 σ u z u σ u q b r u σ u 1 r 2 where σ u the standard deviation of particle velocity at h δ x d i r a c d e l t a f u n c t i o n r 1 σ η σ u 0 s u η ω d ω 1 σ η σ u 0 ω g z s η ω d ω the cross spectral density between u and η σ η the standard deviation of elevation b h σ η z λ 1 2 π e x p λ 2 2 q b b z λ d λ 6 p a 1 q b δ a 1 σ a z a σ a q b where σ a the standard deviation of particle acceleration at h the q in above equations is the probability that the surface elevation exceeds the observation height when the observation point is always submerged q goes to unity and the probability density function of u and a become gaussian distribution like fully submerged case pajouhi and tung 1975 derived spectral density functions for particle velocity acceleration and pressure in intermittent flow by extending tung s work 1975 as eqs 7 and 8 7 s u ω ω g z q b σ u σ η r b z b 2 s η ω h u ω 2 s η ω where s u ω spectral density of particle velocity in intermittent flow s η ω wave spectrum h u ω transfer function for particle velocity 8 s a ω i ω 2 g z q b 2 s η ω h a ω 2 s η ω where h a ω transfer function for particle acceleration 2 1 2 force spectral density the morison s equation is widely used to calculate the wave force acting on the slender member and it consists of drag force and inertia force term as shown in eq 9 9 f f d f i 1 2 ρ c d d u u ρ π d 2 4 c m a k d u 0 2 cos ω t cos ω t k m u 0 ω sin ω t where ρ sea water density kg m 3 d the diameter of the member c d c m empirical drag and inertia coefficients k d 1 2 ρ c d d k m ρ π d 2 4 c m it is difficult to obtain force spectral density for a complete form of morison s equation due to the nonlinear drag term in it borgman 1967 derived the force spectral density for fully submerged member by linearizing the nonlinear drag term linearization coefficient was introduced to linearize the morison s equation by borgman by substituting the coefficient morison s equation could be linearized as eq 10 and the force spectral density for fully submerged case could be derived as eq 11 10 f l k d β u k m a k d u 0 cos ω t k m u 0 ω sin ω t where β 8 π σ u k d k d β 11 s f ω k d 2 β 2 s u ω k m 2 s a ω ω 2 g 2 z k d 2 β 2 k m 2 ω 2 s η ω where s u ω ω 2 g 2 z s η ω s a ω ω 4 g 2 z s η ω when the points of interest are located near the free surface it is hard to assume that particle velocity u is a gaussian process pajouhi and tung 1975 proposed a lengthy formula for covariance function and spectral density for a complete form of morison s equation which retains the nonlinear drag term considering the intermittent effect the force spectral density could be obtained by integrating the covariance function numerically so they gives approximate form of force spectral density based on taylor series expansion isaacson and baldwin 1990b pointed out necessity for modification of linearization coefficient in intermittently submerged case and derived a linearization coefficient as eq 12 12 β u 3 u 2 where the time averaged or expectation value expectation values required to calculate 12 could be estimated numerically from probability distribution function of u in 5 the approximate form of force spectral density s f ω in intermittent flow was derived by using the linearization coefficient β and spectral densities of u and a as eq 13 isaacson and baldwin 1990b 13 s f ω k d 2 β 2 s u ω k m 2 s a ω k d 2 β 2 1 σ u r b z b σ η q b ω g z 2 k m 2 ω 2 ω 2 g 2 z q 2 b s η ω 2 1 3 the probabilistic density function of force maxima from the structural design point of view extreme responses and fatigue damage are of interest rather than load itself therefore many studies were conducted to derive not only the probability distribution function of the force but also the force maxima which is related to the extreme load in fully submerged case force maxima occurs when the time derivative of eq 9 goes to zero so the maximum value of morison force is expressed as eq 14 14 f p z u 0 ω g z k m f o r u 0 σ u 2 k u 0 2 g 2 z k d k m 2 ω 2 4 k d f o r u 0 σ u 2 k where f p force maxima k k d σ u k m ω the ratio of drag force to inertia force the probability density function of force maxima for narrow banded wave spectrum in fully submerged member was derived by borgman 1965 as eq 15 15 p ζ ζ e x p 1 2 ζ 2 f o r ζ ζ c ζ c e x p 1 2 ζ c 2 ζ ζ c f o r ζ ζ c where ζ 2 2 f p ω 0 2 k m h r m s g z h r m s the root mean square wave height ω 0 modal frequency ζ c 2 k m k d h r m s g z a measure of the relative contributions of inertia and drag force the probabilistic distribution model of force maxima near the free surface also changes due to the intermittent effect although a continuous force reaches its maximum force maxima observed near the free surface could differ from peak value of the continuous force if waves do not reach the observation point in other words the value of force maxima near the free surface could be influenced by the relation between the phase θ m at which the peak value of continuous force occurs and the phase θ 0 when water first reaches the observation point isaacson and baldwin 1990b derived the value of force maxima in intermittent flow by using the relationship between θ m and θ 0 as shown eq 16 and the probability density function of force maxima was also derived as eq 17 16 f p h 0 f o r h 2 h u 0 2 g 2 z k d cos θ 0 cos θ 0 u 0 ω g z k m sin θ 0 f o r h 2 h a n d θ 0 θ m u 0 2 g 2 z k d k m 2 ω 2 4 k d f o r h 2 h a n d θ 0 θ m where θ 0 cos 1 2 h h θ m π 2 f o r k m g z h k d otherwise θ m sin 1 k m g z h k d 17 p ξ γ γ δ ζ f o r ζ 0 0 f o r 0 ζ γ ζ γ e x p 1 2 ζ γ 2 γ ζ c f o r γ ζ ζ c γ ζ c e x p 1 2 ζ c 2 ζ ζ c f o r ζ ζ c γ where γ x 1 e x p x 2 2 gamma function γ b 2 2 ζ c the probability model for maxima of morison force in a wide band wave spectrum deviating from the narrow band assumption in which the spectral density is not concentrated at one frequency has also been studied however it is difficult to develop a complete form of expression and approximate forms were investigated by tung 1974 tickell 1977 and moe and crandall 1978 2 2 linearization coefficients in fully and intermittently submerged member 2 2 1 coefficients for fully submerged member to approximate the spectral density of the morison force the linearization coefficients was first proposed by borgman 1967 the borgman s coefficient was estimated by minimizing the error between nonlinear and linearized morison force during entire time span a least square method was applied to minimize the error and the coefficient k d was derived by eq 18 18 f f l 2 k d 2 k d u 2 u k d u 2 0 k d k d u 2 u u 2 based on the linear wave theory in the fully submerged section the particle velocity u follows the gaussian process of zero mean so the second and third moments of u are σ u 2 and 8 π σ u 3 respectively therefore the borgman s coefficient for fully submerged condition could be derived by substituting statistical moments in eq 18 that is the borgman s coefficient is only proportional to the standard deviation of the particle velocity σ u at that location and the other variables do not affect the coefficients 19 k d β k d 8 π σ u 3 σ u 2 k d 8 π σ u brouwers and verbeek 1983 compared fatigue damages calculated by nonlinear and linearized morison s equations by borgman respectively when the ratio of drag force to inertia force k is small which means that inertia force is dominant linearized force could predict well the fatigue damage calculated by the nonlinear force but it was found that linearized force tend to underestimate fatigue damages in region where drag force is not negligible they also pointed out that the error increases as the slope of s n curve increases because borgman s coefficient is calculated by minimizing the time average of error between nonlinear and linear morison force it may underestimate the value of peak forces deviated largely from the mean value the limitations of borgman s coefficient were reviewed and an alternative approach to linearize morison s equation for a narrow band wave was proposed by wolfram 1999 the important responses such as extreme responses and fatigue damage are related to the force maxima not force itself thus the approach was to match the expectation values of the force maxima of the nonlinear and linearized morison force because expectation value is defined as integrating the product of probability density function and random variable in the whole region the expectation value of force maxima in complete morison s equation is calculated by integrating the product of eq 14 and the probability density function of the amplitude of particle velocity p u 0 as eq 20 because the wolfram s coefficient was derived just below the free surface g z in eq 14 was taken as 1 in his work 20 e f p 0 σ u 2 k p u 0 u 0 ω m v k m d u 0 σ u 2 k p u 0 u 0 2 k d k m 2 ω m v 2 4 k d d u 0 ω m v k m 0 σ u 2 k p u 0 u 0 d u 0 k d σ u 2 k p u 0 u 0 2 d u 0 k m 2 ω m v 2 4 k d σ u 2 k p u 0 d u 0 where ω m v the mean zero up crossing frequency of particle velocity in lrwt the particle velocity at a fully submerged point is assumed to be a zero mean gaussian process thus the amplitude of particle velocity follows the rayleigh distribution after substituting the rayleigh distribution and integrating three terms in eq 20 the expectation value is expressed as eq 21 21 e f p k d σ u 2 e x p 1 8 k 2 1 4 k 2 2 1 k π 2 e r f 1 2 2 k as for the expectation value in linearized morison s equation the value of peak force could be obtained by differentiating eq 10 respect to time and equating it to zero 22 f p l u 0 k d 2 k m 2 ω 2 therefore the expectation value of force maxima in linearized morison s equation is derived as eq 23 23 e f p l 0 f u 0 u 0 k d 2 k m 2 ω m v 2 d u 0 σ u π 2 k d 2 k m 2 ω m v 2 finally the linearization coefficient that make the force maxima equal in the complete and linearized morison s equations can be obtained by comparing eqs 21 and 23 which can be summarized as eq 24 24 k d k d σ u 2 π e x p 1 8 k 2 1 4 k 2 2 1 k π 2 e r f 1 2 2 k 2 1 k 2 k d β k d σ u c 1 k where c m k β σ u in case of fatigue damage it is proportional to mth power of stress range not stress range therefore linearization coefficient to match fatigue damages calculated by nonlinear and linear drag force should be calculated by equating the expectation values of mth power of force maxima wolfram 1999 also derived linearization factor considering this fact and the generalized linearization coefficient was expressed in his work 2 2 2 coefficients for intermittently submerged member unlike the fully submerged case the particle velocity and acceleration in the intermittent flow no longer follow the gaussian process therefore it is necessary to propose a new linearization coefficient through the probability distribution model considering the intermittent effect in vicinity of near free surface in this study the linearization coefficient near the free surface is derived by using the probability distribution model of force maxima and particle velocity in the intermittent flow proposed by tung 1975 and isaacson and baldwin 1990b this coefficient is estimated by equating the expectation values of force maxima for nonlinear and linearized morison s equation as mentioned above when deriving the expectation value for the force maxima in the intermittent flow there are two differences with fully submerged case the probability density function of amplitude of the particle velocity p u 0 and the expectation value of force maxima f p from eq 5 which indicates the probability density function of particle velocity in intermittent flow proposed by tung 1975 it is possible to derive the probability function of velocity amplitude as eq 25 25 p u 0 1 q b δ u 0 u 0 σ u 2 e x p u 0 2 2 σ u 2 q b r u 0 σ u 1 r 2 the value of force maxima expressed in eq 16 could be rewritten as a function of velocity amplitude as eq 26 in deep water g z is assumed to be 1 near the free surface where z approaches to zero 26 f p h 0 f o r u 0 ω h ω 2 k d h 2 ω k m u 0 2 ω 2 h 2 f o r ω h u 0 σ u 2 4 k 2 ω 2 h 2 u 0 2 k d k m 2 ω 2 4 k d f o r σ u 2 4 k 2 ω 2 h 2 u 0 the expectation value of force maxima in intermittent flow is derived from eqs 25 and 26 in order to reflect the effect of m which is the slope of s n curve on the linearization coefficient the expectation value for mth order of force maxima is derived in case of the complete morison s equation in a narrow band wave spectrum the expectation value is expressed as eq 27 27 e f p m h ω m v h σ u 2 4 k 2 ω m v 2 h 2 p u 0 f a m d u 0 σ u 2 4 k 2 ω m v 2 h 2 p u 0 f b m d u 0 where f a ω m v 2 k d h 2 ω m v k m u 0 2 ω m v 2 h 2 f b u 0 2 k d k m 2 ω m v 2 4 k d the two integral terms f a m f b m are expanded as eqs 28 and 29 by binomial theorem 28 f a m p 0 m c m p ω m v k m u 0 2 ω m v 2 h 2 p ω m v 2 k d h 2 m p p 0 m c m p k m p ω m v 2 m p u 0 2 ω m v 2 h 2 p 2 k d m p h 2 m 2 p where c m p m m p p 29 f b m p 0 m c m p k m 2 ω m v 2 4 k d p u 0 2 k d m p p 0 m c m p 2 2 p k m 2 p ω m v 2 p k d m 2 p u 0 2 m 2 p by substituting eqs 28 and 29 into eq 27 it can be rewritten as sum of eqs 30 and 31 30 p 0 m c m p k m p ω m v 2 m p k d m p h 2 m 2 p ω m v h σ u 2 4 k 2 ω m v 2 h 2 p u 0 u 0 2 ω m v 2 h 2 p 2 d u 0 31 p 0 m c m p 2 2 p k m 2 p ω m v 2 p k d m 2 p σ u 2 4 k 2 ω m v 2 h 2 p u 0 u 0 2 m 2 p d u 0 two integral terms in eqs 30 and 31 are not be possible to express explicit forms so they should be evaluated through a numerical method in linearized morison s equation as eq 10 the values of force maxima in intermittent flow are derived from eq 26 the phase angle θ m at which the peak of continuous force occurs in the linearized morison force could be evaluated by differentiating eq 10 with respect to time and be expressed as eq 32 32 f l t u 0 ω k d sin θ m k m ω cos θ m 0 θ m tan 1 k m ω k d the phase angle θ m in eq 32 is expressed as a function of linearization coefficient k d since this is related to continuous force it could be assumed that it is equal to the wolfram s coefficient eq 24 derived from fully submerged condition by substituting eq 24 to eq 32 the θ m of linearized morison force could be expressed as eq 33 33 θ m tan 1 k m ω k d tan 1 k m ω k d σ u c w tan 1 1 c w k where c w wolfram s coefficient m 1 by comparing θ m and θ 0 the peak values of linearized morison force in intermittent flow at h is derived as eq 34 34 f p l h 0 f o r u 0 ω h ω k d h ω g z k m u 0 2 ω 2 h 2 f o r ω h u 0 ω h 1 c w 2 k 2 1 u 0 k d 2 k m 2 ω 2 f o r ω h 1 c w 2 k 2 1 u 0 the expectation value for mth order of force maxima in linearized morison force for a narrow band wave spectrum could be derived as the same manner 35 e f p l m h ω m v h ω m v h 1 c w 2 k 2 1 p u 0 f c m d u 0 ω m v h 1 c w 2 k 2 1 p u 0 f d m d u 0 where f c ω m v k d h ω m v k m u 0 2 ω m v 2 h 2 f d u 0 k d 2 k m 2 ω m v 2 the two integral terms f c m f d m are expanded as eqs 36 and 37 by binomial theorem 36 f c m p 0 m c m p ω m v k m u 0 2 ω m v 2 h 2 p ω m v k d h m p p 0 m c m p k m p ω m v m k d m p h m p u 0 2 ω m v 2 h 2 p 2 37 f d m k d 2 k m 2 ω m v 2 m 2 u 0 m by substituting eqs 36 and 37 into eq 35 it can be rewritten as sum of eqs 38 and 39 38 p 0 m c m p k m p ω m v m k d m p σ u m p c m p h m p ω m v h ω m v h 1 c w 2 k 2 1 p u 0 u 0 2 ω m v 2 h 2 p 2 d u 0 39 k d m σ u m c 2 1 k 2 m 2 ω m v h 1 c w 2 k 2 1 p u 0 u 0 m d u 0 c in eqs 38 and 39 was defined in wolfram s work as a function of k and m but observation height h is added as an input factor for c in this present work the expectation value for mth order of force maxima in linearized morison s equation can be expressed as a summation of eqs 38 and 39 and the integral terms should be evaluated by numerical integration because c is defined as the value that makes both expectation values of nonlinear and linearized drag force c could be evaluated by comparing eqs 27 and 35 finally c is expressed as a function of k m and h as shown in eq 40 40 k d c m k h k d σ u finally the linearization coefficient c m k h in intermittent flow could be calculated by equating the expectation values in nonlinear and linearized morison s equations fig 2 shows linearization coefficients with the ratio of drag force to inertia force k at different observation heights h since the influence of the drag is small in a small region of k k 0 2 the linearization coefficients are also small in that region as k increases the linearization coefficients increase and then converge to a specific value like wolfram s coefficient the converged value 1 654 is similar to wolfram coefficient 1 595 when observation height is small in the intermittent flow the observed height h also have an impact on the linearization coefficient as shown in fig 2 the proposed linearization coefficient increases as h increases as the observation position increases the number of waves reaching it decreases whereas the all arriving wave have high wave amplitudes because the amplitude of particle velocity has a linear relationship with wave amplitude the amplitude of velocity should be large when the wave amplitude is large this tendency is reflected in the proposed linearization coefficient and it can be interpreted that the linearization coefficient increases with the increase in the observation position the linearization coefficients with different m values are also compared to evaluate the effect of the slope of s n curve in the coefficient as mentioned in the study of brouwers and verbeek 1983 the borgman approximation underestimates the fatigue damage and the error increases as the slope of s n curve increases the proposed coefficient is also considered the effect of the slope of s n curve like wolfram s work as seen in fig 3 the linearization coefficient increases as m increases although all three lines are calculated at the same height 3 numerical simulation 3 1 simulation condition in order to evaluate the validity of the proposed linearization coefficients numerical simulation is performed to calculate particle kinematics and morison force acting on fixed cylinder protruding the free surface in the time domain the wave spectrum used to generate random wave field is modified pm spectrum ittc spectrum proposed by pierson and moskowitz 1964 the simulations were conducted in nine different sea states where significant wave heights and mean zero upcrossing periods were 5 10 15 m and 10 15 s respectively 41 s η ω 1 4 π h s 2 2 π t z 4 ω 5 e x p 1 π 2 π t z 4 ω 4 where t z mean zero crossing period h s significant wave height a sufficient amount of time record data are required to obtain force spectral densities at all observation points in this present work total time duration of simulation is 1 h and time step is 0 1 s so total number of time records at each location is 36 000 due to uncertainty of time simulation numerical simulations in each sea state were repeated 10 times wave superposition technique which generates irregular sea by superimposing a lot of regular waves is applied to generate random wave field a total of 1000 regular waves are superimposed and the amplitude of each regular waves are determined as deterministic spectral amplitude proposed by rice 1944 42 η t n 1 n a n cos ω n t ε n where a n 2 s η ω n δ ω deterministic spectral amplitude ω n representative frequency ε n phase angle distributed at random 0 ε n 2 π to eliminate repetition during the simulation time representative frequencies in each frequency bin are selected by random variations at the center of the frequency bin particle kinematics above still water level are predicted by vertical stretching method proposed by marshall and inglis 1986 which assumes that all kinematics above still water level are the same at the free surface force coefficients such as drag c d and inertia coefficient c m are taken to be 1 3 and 1 5 respectively as for observation points tung 1995 indicated that free surface fluctuations have almost no effect where the observation height exceeds three times of the standard deviation of wave amplitude thus the normalized observation height b h σ η are taken as range from 0 5 to 3 at intervals of 0 5 so total number of observation points is six 3 2 particle kinematics at each observation points the particle velocity acceleration and drag force are calculated at each observation points linearized drag forces in intermittent flow are calculated using two existing coefficients wolfram 1999 and isaacson and baldwin 1990b and the coefficient proposed in this work to compare the accuracy each other three results such as mean values of force maxima force spectral densities and fatigue damages estimated by nonlinear and linearized drag forces are compared figs 4 7 shows these results obtained in 5th sea state where significant wave height and mean zero upcrossing period are 10 m and 15 s respectively since the intermittent effect is not reflected in the wolfram coefficient linearized drag forces estimated by wolfram s coefficient tend to underestimate the mean values after observation height exceeds b 1 and the error between nonlinear and linearized drag force increases as the observation height increases the errors between nonlinear and linearized drag force by wolfram s coefficients range from 55 5 to 6 5 and the maximum error is observed when b 3 as shown in fig 4 on the other hands the coefficient proposed by isaacson and baldwin gives better results than wolfram s coefficient since it considers the effect of observation height so the coefficients increase as the observation height increases the errors of this coefficient are in the range of 9 4 14 6 the proposed coefficient also considers the intermittent effect so it give similar results to isaacson and baldwin s coefficient the errors of this coefficient ranges from 6 0 to 6 8 since not only linearization coefficients but also the spectral density of the particle velocity affect the accuracy of the force spectral density tung s approximation for the spectral density of velocity in intermittent flow expressed in 7 is compared to the velocity spectra estimated by fourier transformation of time history at first in fig 5 tung s model describes the time simulation results relatively well near peak frequency 0 43 rad s but it deviates from time simulation data above 0 6 rad s when calculating the particle velocity at each observation location if the observation location is not submerged the velocity is converted to zero the higher the observation location the shorter the time that waves reach the observation location it might be the reason that simulated velocity spectrum has larger spectral density than tung s approximation in high frequency range when b exceeds 2 tung s model appears to differ from the time simulation results at peak frequency these error of model for the spectral density of particle velocity affects the force spectral density as well force spectral densities for nonlinear and linearized drag force are calculated in conjunction with tung s model expressed as eq 13 since the values of the three linearization coefficients are similar at b 0 5 which is closest to the free surface the force spectral densities from all coefficients are not significantly different and it seems that these coefficients could describe well the force spectral density of nonlinear drag at b 0 5 however like the mean value of force maxima the wolfram coefficient underestimates the amplitude of force spectral density and the gap increases when b increases the other two coefficients which consider the intermittent effect predict the force spectral densities near peak frequency 0 43 rad s well but they differ from the force spectral densities estimated by nonlinear drag in the frequency range exceeding 0 6 rad s as mentioned above it seems that this difference is caused by the limitation of tung s model finally fatigue damages caused by nonlinear and linearized drag force are compared it is assumed that structural response has a linear relationship with force and cycle counting method such as the rain flow counting method is applied to the time history of stress to obtain the number of cycles and corresponding stress ranges fatigue damage per stress cycle is calculated from s n curve and each fatigue damage is summed based on miner s rule as shown in eqs 43 and 44 43 log n log a m log δ σ where n predicted number of cycles to failure for stress range δ σ δ σ stress range m negative inverse slope of s n curve log a a constant of s n curve 44 d i 1 k n i n i 1 a i 1 k n i δ σ i m d accumulated fatigue damage n i number of stress cycles in stress block i k number of stress blocks n i number of cycles to failure at constant stress range the c curve in seawater with cathodic protection dnv 2011 is used in analysis and the slope m and constant of s n curve log a are 3 0 and 12 192 respectively therefore the wolfram and proposed coefficients that consider the effect of the slope of s n curve are evaluated by equating the expectation values of the 3rd power of force maxima fatigue damage is proportional to 3rd power of linearization factor if the factor underestimates mean value of force maxima or force spectral density fatigue damages evaluated by linearized drag force could be severely underestimated the coefficient suggested by isaacson and baldwin underestimates fatigue damages at all observation points about 70 4 32 8 respect to the fatigue damages caused by nonlinear drag force since this coefficient does not take care of the effect of m on the other hand the proposed coefficient gives better predictions at all observed positions since it reflects the effect of m the errors between nonlinear and linearized drag force estimated by proposed coefficient in fatigue damages are within a range of 34 6 19 5 environmental conditions such as wave height could have an effect on the accuracy of predicted results the errors of mean values of force maxima and fatigue damages calculated by nonlinear and linearized drag force in all sea states are compared in figs 8 and 9 as for the mean value of force maxima proposed linearization coefficient predicted well the simulated results ranging from 12 to 12 regardless of wave height and period however in case of fatigue damage significant wave height has an effect on the accuracy of the results an increase of wave height incur the standard deviation of particle velocity σ u which is term in the numerator of k thus when wave height increases the value of k will rise and linearization coefficient which is an increasing function of k also get bigger considering that the prediction of fatigue damage through the linearization coefficient is usually lower than the simulated value the increase in wave height seems to contribute to reduce the error the mean values of force maxima and fatigue damages were also calculated by linearization coefficient proposed by isaacson and baldwin as seen in figs 10 and 11 this coefficient also predicts well the mean values of force maxima in range of 15 to 15 in all sea states however as mentioned above this coefficient tends to underestimate fatigue damages severely around 70 near the free surface in all sea states 4 conclusion in this present work the expectation values and linearization coefficient for morison s equation above still water level are discussed by considering particle kinematics and probability density functions in intermittent flow the linearization coefficients below still water level derived from the assumptions that the particle velocity follow a zero mean gaussian random process under linear random wave theory were verified in many studies however in the vicinity of the free surface wave force is discontinuous due to the surface fluctuation so particle kinematics and stochastic characteristic are different from that under the free surface especially the influence of the observation height on the linearization coefficient is significant as the observation height increases the expectation value of the force maxima becomes smaller as the number of waves that cannot reach this point increases however since only the high wave arrives the linearization coefficient that approximates them must also increase with the observation height the proposed linearization coefficient is defined as a value that makes the force maxima of the nonlinear and linearized morison forces equal in the intermittent flow the expectation value is calculated by combining the probability model of the velocity amplitude and the peak force value in the intermittent flow the validity of the proposed coefficient is verified through a numerical simulation the wolfram coefficient derived under fully submerged condition does not consider the intermittent effect so it tends to underestimate the force spectral densities near the free surface as for the coefficients proposed by isaacson and baldwin it gives better results in force spectral density and the mean values of force maxima at each observation points however it severely underestimates the fatigue damage this because it was derived by minimizing the time average of the error between nonlinear and linearized drag force although it could predict load itself but it fail to describe the extreme load or fatigue damage that is related to mth power of force maxima the proposed coefficient improves the accuracy of the existing linearization coefficients by reflecting the intermittent effect and correction of the mth power of force maxima at the same time the proposed coefficient is derived based on the linear intermittent random wave theory also narrow band wave spectrum is assumed to derive the coefficient thus when nonlinear effect is large and the waves follow wide band process the present coefficient could not be proper the further investigations for high order intermittent wave theory and wide band process are required acknowledgement this work was supported by the technology innovation program 10062271 development of structural integrity assessment technology for flexible riser of over 7 inch internal diameter at water depth of 1500 m funded by the ministry of trade industry and energy this research was supported by a grant from endowment project of study on the core technology of structural design engineering and test for establishment of structural evaluation system for offshore structure 2 3 funded by korea research institute of ships and ocean engineering pes9470 the institute of engineering research at seoul national university provided research facilities for this work 
