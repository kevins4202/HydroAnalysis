index,text
23730,this work shows a study about the bilge keel and its influence width and form on the roll damping of fpso sections a computational code was developed to simulate forced roll oscillation of a middle section of fpso with different bilge keels types the computational code calculates the solution of the navier stokes equations in 2d using the finite volume method and the upwind tvd scheme of roe sweby the effect of wave radiation is neglected this work shows how the generated vortices influence the pressure distribution around the middle section of fpso the numerical results are compared with experimental results to validate the computational code new bilge keel configurations were studied to improve the roll damping of fpso keywords fpso bilge keel roll damping forced roll oscillation cfd finite volume method tvd nomenclature a 44 added mass coefficient of roll b beam of the model b 44 damping coefficient of roll c 44 restoring coefficient of roll c p pressure coefficient f r froude number g acceleration of gravity k c keulegan carpenter number l length of the model m mach number m h hydrodynamic moment m θ p pressure moment with respect to center of gravity of the model m θ v viscous moment with respect to center of gravity of the model m mass of the model n normal vector pointing out of the object p pressure of the fluid p pressure of free stream r e reynolds number s area of the cell boundary t draft of the model t p period t time u x velocity component u r e f reference velocity v y velocity component v volume of the cell x horizontal cartesian coordinate y vertical cartesian coordinate w local velocity of the surface of the control volume ε phase of angle θ angle of inclination τ viscous stress tensor ψ flux limiter displacement volume 1 introduction in the field of hydrodynamics of ocean engineering to predict the motion of ship and floating platforms is one of the most important goals in general all movements can be reproduced fairly accurately using known linear methodologies except the strongly nonlinear roll motion the roll motion is very sensitive to the effects of viscosity especially in the presence of appendages such as bilge keels this appendage is a prompter of flow separation around the body generating vortices and viscous damping it is the most traditional passive stability system used in ships the vortices around the hull influence the pressure distribution on the body surface these vortices depend directly on the body geometry and the appendages in the case of floating platforms as fpsos floating production storage and offloading fpsos have cost advantages and cargo capacity especially in regions with little oil flow infrastructure pipelines as the brazilian coast these units are exposed throughout their lifetime to roll motion which has an impact on the design and of related structures ikeda et al 1977a studied the damping component that generates vortices eddy damping and concluded that this component is proportional to the square of the frequency and amplitude of roll motion ikeda et al 1977b concluded that the pressure on a ship hull surface due to the bilge keels is proportional to the square of the oscillation frequency and the negative pressure coefficient behind the bilge keel depends on the keulegan carpenter kc number himeno 1981 described the state of the art of the ship roll damping prediction it showed that it is possible to estimate the roll damping of typical hull ship with reasonable accuracy he commented that the damping of the bilge keel not merely shows a quadratic nonlinear behavior but it depends on the amplitude and frequency in a more complex form downie et al 1988 concluded that for rectangular hulls the damping by wave radiation is small and viscous effects are particularly important on roll damping yeung et al 1998 developed an experimental program to measure the hydrodynamic coefficients of rectangular cylinders and the results were compared with the fsrvm method free surface random vortex method developed by yeung and vaidhyanathan 1994 aloisio and felice 2006 conducted a study of the flow around the bilge keel using a piv system it was concluded that the vortex shedding is the main mechanism involved in the damping of the roll motion and the vorticity shed from the bilge keel is proportional to the amplitude of the motion jaouen et al 2011 reproduced numerically the experimental tests of forced roll oscillation of ikeda et al 1977a and only compared the viscous damping the numerical code that they have developed and used refresco did not consider the effect of wave radiation the results showed good agreement and also showed that in rectangular hull sections the sharp bilges show greater added mass and damping than the rounded bilges avalos 2012 and avalos et al 2014 simulated the roll damping decay of a middle section of fpso with bilge keel through the numerical solution of the navier stokes equations in 2 d the computer code was developed using the finite volume method and the tvd upwind scheme of roe 1984 and sweby 1984 in an unstructured dynamic mesh and neglecting the wave radiation effects the results showed the influence of the bilge in the damping and the difference of the vortex generation mechanism with and without bilge keel the bilge keel has been the most used appendage to reduce the roll motion of stationary floating units for reasons of simplicity and cost efficiency studies of large width bilge keels impacts in roll behavior that can be mentioned for instance are thiagarajan krish and braddock 2009 oliveira 2011 new forms of bilge keels were studied by matsuura et al 2001 na et al 2002 kinnas 2005 and lee et al 2010 the computational fluid dynamics cfd tools have the potential to improve prediction of local loads improving the integrity of this appendage which has become critical to ensuring the satisfactory operation of the production units the present study aims the development of a 2d computational code able to calculate the roll damping of fpsos with new forms of bilge keels the numerical code was developed in avalos 2016 and represents an evolution of the works of avalos 2012 and avalos et al 2014 this code should help to understand how the bilge keels influence the roll damping with respect to its shape and size thus it identifies the main features required for new bilge keel projects numerical results obtained in this study are compared with experimental results of thiagarajan krish and braddock 2009 na et al 2002 and ikeda et al 2004 to validate the developed computational code after the numerical code validation new bilge keel configurations were studied 2 mathematical formulation in the present investigation wave radiation was not considered the body is completely submerged in the numerical tank and the navier stokes equations are solved for the entire flow around the body without considering the source term of the gravity when the forces acting on the body are calculated the effect of pressure and viscous stress of this flow acting on the body is considered only in the part of the body below an imaginary flat free surface defined by the draft the effect of gravity hydrostatic pressure is considered in this calculation as well the slightly compressible navier stokes equations are solved numerically using the finite volume method and the upwind tvd scheme of roe 1984 and sweby 1984 for the flow around a fpso section in forced roll oscillation eq 1 presents the governing equations in two dimensional cartesian coordinates and written in the conservative and dimensionless form as in wanderley and levi 2005 1 q t e e e v x f e f v y 0 where q is the vector of conserved variables e e and f e are the inviscid flux vectors and e v and f v are the viscous flux vectors see eq 2 q p u v e e p u u 2 p u v e v 1 r e 0 u x v x 2 f e p v u v v 2 p f v 1 r e 0 u y v y where 3 r e ρ u r e f b μ u r e f ω θ 0 b all variables are made dimensionless using the beam of the model b density ρ and the velocity u r e f where r e is the reynolds number μ is the dynamic viscosity ω is the circular oscillation frequency and θ 0 is the forced oscillation amplitude the integral form of eq 1 is shown in eq 4 4 d q d t s p q w n d s where 5 p e e e v i f e f v j 6 q v q the vector w represents the local velocity of the cell surface to take into account the deformation of the finite volumes the vectors i and j are the unit vectors in the x and y directions respectively the variable q represents the average value of q in a cell with volume v and surface s and is attributed to the center of the cell q is defined in eq 7 7 q 1 v v q d v in the numerical simulation the following initial and boundary conditions were imposed initial conditions 8 u 0 v 0 p 1 m 2 the value assigned to the mach number m is 0 2 this ensures a slightly compressible flow boundary conditions on the walls of the tank left and right 9 p x 0 u x 0 v x 0 this condition avoids reflection in the tank walls in this way it is not necessary that the length of the numerical tank to have the same size of the experimental tank thereby avoiding an unnecessary computational burden no slip boundary conditions are applied on the top and bottom of the tank 10 u 0 v 0 p y 0 no slip boundary conditions are applied on the body surface 11 u u c v v c p n 0 where u c e v c are the body surface velocity components in the x and y directions respectively 3 numerical formulation equation 12 shows an approximation of the integral form of the governing equations eq 4 applied to a two dimensional triangular finite volume the vector of conserved variables is defined in the finite volume center this is known as cell center approach 12 f 1 3 p e q w s i f p v s i f where the subscript f is the face of the element i and the vectors containing the inviscid and viscous flux vectors are shown in eq 13 13 p e e e i f e j p v e v i f v j the components of the velocity vector w in eq 12 are shown in eq 14 14 u s x f n 1 x f n δ t v s y f n 1 y f n δ t where x f n y f n are the coordinates of the midpoint of face f of the element i at the time instant n eq 14 is an approximation suggested by lesoinne and farhat 1996 to satisfy the equation of geometric conservation law gcl introduced by thomas and lombard 1979 to avoid errors induced by the deformation of the mesh in eq 12 the inviscid flux vector is approximated using the upwind tvd scheme of roe 1984 and sweby 1984 defined in eq 15 15 p e s i f 1 2 e e i e e j s x 1 2 f e i f e j s y 1 2 a ˆ f q j q i where s x and s y are the components of the area vector normal to face f and the subscript j represents the neighbor elements of the element i see fig 1 the matrix a ˆ f in eq 15 is the modified flux jacobian matrix defined in eq 16 16 a ˆ f t f λ ˆ f t f 1 in eq 16 the matrix λ ˆ f is a diagonal matrix which elements are shown in eq 17 and the matrix t f is defined in eq 18 17 λ ˆ k λ k ψ k δ t δ s λ k 2 λ k 18 t f x 1 x 2 x 3 where x k λ k are the eigenvectors and eigenvalues of the jacobian matrix a defined in eq 19 and δ s is the distance between the finite volume centers i and j see fig 1 19 a p e s i f q i in eq 17 ψ k is the van leer 1979 flux limiter presented in eq 20 where the parameter r k is defined in eq 21 20 ψ k 0 i f r k 0 2 r k 1 r k i f r k 0 21 r k b n i j δ w k i j i f λ k 0 d n i j δ w k i j i f λ k 0 where n i j represents a unit vector between the grid elements i and j δ w k i j are the components of the vector δ w i j given in eq 22 the vectors b and d are defined in eq 23 where the subscripts m p s and t are the grid elements shown in the fig 1 22 δ w i j t f q j q i b δ w k j m n j m δ w k j p n j p 23 d δ w k s i n s i δ w k t i n t i in eq 12 the viscous flux vector is approximated as shown in eq 24 24 p v s i f 1 2 e v i e v j s x 1 2 f v i f v j s y the solution of the governing equations in time is obtained using the optimal multistage scheme by tai et al 1995 and the residual smoothing technique by jameson and baker 1983 4 forced rolling motion in order to avoid strong transient flows at earlier time steps of the calculation the forced rolling motion is defined in eq 25 25 θ θ 0 tanh ω t 6 s i n ω t t t p θ θ 0 s i n ω t t t p where t p represents three times the period of forced oscillation all forced rolling motions were initiated from rest the numerical code calculates the hydrodynamic moment m h at each time step assuming a linear damping coefficient the hydrodynamic moment can be written as in eq 26 26 m h a 44 θ b 44 θ c 44 θ where a 44 b 44 and c 44 are the hydrodynamic coefficients of added mass damping and restoring spring respectively for a sinusoidal signal the hydrodynamic moment is given by eq 27 27 m h m 0 s i n ω t ε where m 0 is the amplitude of the roll moment and ε is the phase angle between roll motion and the roll moment therefore the hydrodynamic coefficient b 44 is obtained from m 0 and ε according to eq 28 28 b 44 m 0 s i n ε ω θ 0 in our case where the signal is not sinusoidal m 0 and ε is obtained through a first order fourier analysis where the first seven periods of forced rolling motion were disregarded in the signal processing more periods were disregarded if the steady state of hydrodynamic moment was not achieved especially in high frequencies a minimum of 5 periods were considered to calculate m 0 and ε the dimensionless damping coefficient and the circular oscillation frequency were obtained following vugts 1968 29 b 44 b 44 4 ρ b 2 2 b 2 g 30 ω ω b 2 g the moment acting on the fpso see fig 2 is obtained by integration of the pressure and viscous stress around the part of the body below the imaginary flat free surface defined by the draft equation 31 shows how the pressure and viscous moments are obtained where the hydrostatic pressure is taken into account in the calculation of the pressure moment m θ p s p p ρ g y r n d s 31 m θ v s r τ n d s where 32 r x x c g i y y c g j the cartesian coordinates x c g y c g represent the center of mass of the body 5 grid generation and deformation the mesh generator gmsh by geuzaine and remacle 2009 distributed under the terms of gnu general public license was used in the present study the unstructured grid is composed only of triangular elements generated using the delaunay method the grid is constructed in such a way that the boundary of the body is part of the grid then it is necessary to displace the grid points taking into account the motion of the body the displacement of grid points is achieved with the function f the value of the function varies between zero and one the product between the displacement of the body and the function f provides the displacement of the grid points the function f is defined in eq 33 and shown in fig 3 the deformation of the grid is shown in fig 4 33 f 1 r r 1 1 cos 8 α r 1 r r 2 0 r 2 r where 34 α π 16 1 r r 1 r 2 r 1 6 validation in order to validate the numerical code developed in this work the numerical results were compared to experimental results of na et al 2002 thiagarajan krish and braddock 2009 and ikeda et al 2004 the element size and the maximum number of elements of the grids are shown in table 1 finer grids were not used to avoid excessive computational effort since the upwind tvd scheme of roe sweby used to solve the navier stokes equations requires itself a lot of computational effort as was mentioned before this work used the optimal multistage scheme by tai et al 1995 and the residual smoothing technique by jameson and baker 1983 despite of finer grids were not used the obtained numerical results were satisfactory this is due to the advantage of the use of grids that are deformed and adapted to the body movement avoiding unnecessary computational effort a good reference with respect to this advantage is askes et al 1999 a grid sensitivity study is done for four different grids with element sizes and numbers shown in table 2 to reproducing forced roll oscillation tests the hull section bk1 of thiagarajan krish and braddock 2009 was used in this study see sect 6 2 fig 5 shows the grid around the bilge keel of grid 2 of table 2 it is important to comment that the grid refinement around the part of the body below the imaginary flat free surface defined by the draft was the main concern in this investigation see fig 4 because the forces are computed around this region the damping coefficients of the grid sensitivity study are shown in fig 6 the experimental damping coefficient of thiagarajan krish and braddock 2009 for the bilge keel bk1 is approximately 0 022 see fig 9 the numerical results did not show a big difference for the four tested grids and are very close to the experimental data of 0 022 therefore based on the grid sensitivity tests grids with between 150 000 and 227 000 elements were used in the present numerical study 6 1 comparison with the experimental results of na et al 2002 the characteristics of the hull section and the sketch of the various bilge keels of na et al 2002 are shown in table 3 and fig 7 respectively the forced roll amplitude was 5 and the depth of the wave flume was of 1 0 m according to na et al 2002 the damping coefficient b 44 was normalized according to eq 35 different from that of eq 29 the variables a ρ b and g represents the sectional area density of water breadth of the model and the acceleration of gravity respectively 35 b 44 b 44 ρ a b 2 b 2 g fig 8 shows the good agreement between the numerical and experimental results for the damping coefficient regarding the 45 arrangement bilge keels fig 8a shows that the damping coefficient increases with frequency and bilge keel width increasing the bilge keel width the frontal area and the drag acting on the bilge keel increase therefore the moment opposing the fpso rotational motion increases also consequently the damping coefficient increases increasing the frequency more vortices are shed at the tip of the bilge keel and more energy is transfer from the motion of the body to the flow field and consequently the damping coefficient increases 6 2 comparison with the experimental results of thiagarajan krish and braddock 2009 the characteristics of the hull section of thiagarajan krish and braddock 2009 are shown in table 4 the bilge keels were in the arrangement of 45 and their sizes with 3 mm thick are shown in table 5 the forced roll amplitude was of 12 5 and the depth of the tank was of 1 0 m in the experimental test the bilge keels were tested at various frequencies the present study reproduced the experimental results at 0 646 hz that corresponds to a dimensionless frequency ω of 0 347 the bilge keel length corresponds to a third of the model s length located in the middle of the model therefore to reproduce these results using the 2d numerical code developed in this study a weighted average of the damping coefficient between the model without and with bilge keel was calculated fig 9 shows the good agreement between numerical and experimental results in table 6 the bilge keels from bk0 to bk3 show less than 5 relative error the highest discrepancy is observed for the bilge keel bk4 with 10 3 of relative error this slightly difference may be due to two factors first the fact that the free surface is not captured in our numerical model the bilge keels bk4 and bk5 represent 15 and 20 percent of the half beam of the model and perhaps there may be a greater interaction between the generated vortices by the bilge keels and the free surface second the weighted average to obtain the damping coefficient may introduce some uncertainty in this case the bilge keel in the arrangement of 45 is more used in the field of ship offshore industry fig 10 shows the pressure distribution cp black line and the vorticity field of the bilge keels bk1 and bk5 the direction of the eddies is depicted in fig 10 a and the high and low pressure distributions around the hull section are shown in fig 10 b in the bilge keels it is observed that the high and low pressure distributions are generated by the upstream and downstream sides of the bilge keel respectively the comparison between the pressure distributions of bk1 and bk5 is shown in fig 11 regarding the increased width of the bilge keel it is observed that the pressure distribution changes smoothly around the model and reaches an extreme value around the bilge keel region see fig 10b a sudden decrease of pressure distribution is observed in certain regions due to the presence of the vortices generated at the bilge keel tip this is clearly observed in the bilge keel bk1 in fig 10 a and on the de side of the bilge keel bk5 in fig 10 b all of this is confirmed quantitatively in fig 11 in this last figure it is observed that the hi side of the bilge keel bk1 shows a lower pressure distribution than that of the bilge keel bk5 this is due to the presence of the vortex generated at the tip of the bilge keel increasing the width of the bilge keel the vortices tend to pull away from the body so that the pressure drop on the bottom and both sides of the body is considerably reduced but only observed at the tip of the bilge keel see fig 10b an animation showing more detail about this result can be found in the following link https youtu be 4lngaheiaba 6 3 comparison with the experimental results of ikeda et al 2004 the characteristics of the hull section of ikeda et al 2004 are shown in table 7 the bilge keel was in the arrangement of 45 the forced roll amplitudes were 5 10 15 and 20 and the dimensionless forced roll frequencies ω were 0 299 0 448 considered as low frequency and 0 893 and 0 996 considered as high frequency the obtained results are in a fair agreement with the experimental data see fig 12 table 8 shows the discrepancies between experimental and numerical results it is observed that the relative errors are acceptable except for the amplitude of 5 at low frequencies in these cases the absolute errors are of the order of the corresponding experimental damping coefficients it is important to observe that the higher absolute errors are registered for the amplitude of 20 at high frequencies but their relative errors are acceptable in these cases the numerical results are always more damped than the experimental results see fig 12 a possible justification is the free surface that is not captured in our numerical model at high amplitudes there may be an interaction between the vortices generated by the bilge keel and the free surface that modifies the pressure distribution around the body 7 study of new forms of bilge keel it has been a difficult task to improve the roll damping of offshore structures as in the case of flng floating liquefied natural gas then after validating the numerical code with experimental results this section shows a study of new forms of bilge keels and their influence on the roll damping this study was motivated by the works of matsuura et al 2001 lee et al 2010 and na et al 2002 the last work was described in section 6 1 matsuura et al 2001 developed a new concept of bilge keels msboard flat plates vertical or horizontal attached to the bottom sides of the floating structure with a narrow gap lee et al 2010 developed the l shape roll suppression device l rsd that offers an easy installation and increases significantly the roll damping the characteristics of the hull section are the same as in na et al 2002 and they are shown in table 3 the forced amplitude of 5 is the same as in na et al 2002 and three dimensionless forced roll frequencies ω of 0 4 0 6 and 0 8 were considered the present study used the two better bilge keels with 2 cm width of na et al 2002 namely the bilge keels 2b horizontal and 2c form of t see fig 7 these bilge keels were slightly modified in position and form and grouped in two classifications to permit a better visualization of the results denoted by bilge keels type 2b and bilge keels type 2c the dimensions and forms of them are shown in figs 13 and 14 7 1 type 2b bilge keels the study of the bilge keels type 2b was motivated by the works of matsuura et al 2001 and lee et al 2010 in these studies the authors assessed the application of a gap between the bilge keel and the body and the arrangement of the bilge keel may be vertical or horizontal in the present work the influence of the gap size for the arrangement of horizontal bilge keel is analyzed fig 15 shows the numerical results for the damping coefficient for the bilge keels type 2b it is observed clearly that the excessive gap of the bilge keel 2b1 in this case equal to the bilge keel width the damping decreases considerably considering the average of decrease in damping at each frequency the damping decrease for the bilge keel 2b1 was about 18 5 with respect to the bilge keel 2b a slight decrease of the damping is observed when the gap is decreased more than that of the bilge keel 2b2 see bilge keel 2b3 although both are of the same order for the studied amplitude the bilge keel 2b2 showed a little bit higher damping than the others approximately 4 6 more damping than that of the bilge keel 2b fig 16 shows the pressure distribution around the bilge keels type 2b it is observed that the bilge keel 2b2 has higher pressure distribution around it than that of the others the low pressure distribution on the fg side is similar in the bilge keels 2b2 and 2b3 and represents approximately twice the pressure distribution corresponding to the bilge keel 2b1 the high pressure distribution on the de side of the bilge keel 2b2 is about twice the pressure distribution of the bilge keel 2b3 on the ab side of the bilge 2b2 the high pressure distribution is about twice the pressure distribution corresponding to the bilge keel 2b3 and at the bottom of the body bc side the bilge 2b2 shows a greater pressure distribution near the bilge keel this pressure distribution around the bilge keel 2b2 is farther away from the center of rotation than that of the others and contributes to a greater hydrodynamic moment and therefore a greater roll damping the vortex shedding in the bilge keels type 2b represents an interesting subject of discussion the sudden variation of pressure distribution observed in certain regions of the fig 16 is due to the presence of vortices as seen in fig 10 this is clearly confirmed in fig 17 that shows the vorticity field and pressure distribution for the same instant of time as shown in fig 16 vortex shedding is observed in three places for the three bilge keels type 2b two vortices are generated by the bilge keel and one by the sharp bilge one vortex generated by the bilge keel influences the low pressure distribution on the fg side the vortex generated by sharp bilge influences the pressure distribution sudden decrease on the bottom of the body and the interaction of the two vortices on the bottom of the body influences the pressure distribution sudden increase this is observed clearly in the bilge keel 2b1 and 2b2 the gap size influences the size and interaction of the vortices in the bilge keel 2b1 the greatest gap the vortices are larger and the interaction of the two vortices on the bottom of the body occurs furthest from the bilge keel than that of the others in the bilge keel 2b3 this interaction of vortices on the bottom of the body is faster and weaker than the other bilge keels for this reason it is not observed a pressure distribution sudden increase as the bilge keels 2b1 and 2b2 an animation showing more detail about this result can be found in the following link https youtu be dtdm 4xds5u 7 2 type 2c bilge keels the bilge keels type 2c shown in fig 14 are variations of the bilge keel proposed by na et al 2002 the bilge keel 2c form of t showed the best damping characteristics of those bilge keels with 2 cm width in that case the influence of the plate at the end of the bilge keel with slight variations of position and form is shown comparing the influence of the plate at the end of the bilge keel at horizontal bilge keel 2c1 and vertical bilge keel 2c2 positions it is observed in fig 18 that the vertical position of the plate decreases the damping by about 6 3 and the horizontal position increases the damping by about 3 with respect to the original position similar behavior was observed in the experimental and numerical results in sect 6 1 where the bilge keel 2a vertical position showed less damping than the bilge keel 2b horizontal position modifying the end plate of the bilge keel as in the case of the bilge keels 2c3 and 2c4 the increase and decrease behavior with respect to original bilge keel is repeated again but this damping variation is greater see fig 18 the increase and decrease of the damping were about 21 and 10 7 respectively the bilge keel 2c3 form of y showed more damping than the bilge keel 2c4 form of arrow therefore the best bilge keel of the type 2c is the bilge keel 2c3 showing a considerable damping increase fig 19 shows the pressure distribution of the bilge keels type 2c the high pressure distribution on ab and bc sides of the bilge keel 2c3 is slightly greater than that of the other bilge keels the low pressure distribution on the opposite side of bc and on the bottom of the body is similar on the bilge keels 2c1 2c3 and 2c4 but it is more significant on the bilge keels 2c3 and 2c4 for the best bilge keel of type 2c bilge keel 2c3 the pressure distribution on the sides cd ef and hi contributes to a greater hydrodynamic damping moment fig 20 shows the numerical results for the best bilge keels of this study bilge keels 2c3 and 2b2 they are compared to the numerical results obtained for the bilge keel 2 of sect 6 1 the traditional bilge keel of 45 with 2 cm width it is observed clearly that the increase of damping obtained in the bilge keel 2c3 form of y was about 15 7 more than that of bilge keel 2 the bilge keel 2b2 showed only 1 4 more damping than the bilge keel 2 in this figure the result of the other bilge keel in the form of y is added denominated bilge keel 2c3 2 this bilge keel has an average width of 2 cm equal to bilge keel 2 it is observed that the bilge keel 2c3 2 shows a small gain of damping with respect to bilge keel 2 similar to bilge keel 2b2 the gain of damping was about 3 1 with respect to bilge keel 2 therefore the damping increment observed in the bilge keel 2c3 is mainly due to the increment of the average width 35 bigger than the bilge keel 2 8 conclusions a numerical code was developed in order to reproduce numerically forced roll test of fpso with bilge keels the new numerical code was validated reproducing forced roll test of fpso with bilge keels of the literature the code was tested up to amplitudes of 20 compatible with the maximum amplitudes that these platforms operate in its useful life the numerical results show the code capacity to reproduce these tests despite the approximation of the numerical model it demonstrates that this approximation is acceptable in order to reproduce these tests up to amplitudes of 20 besides to demonstrate to be a computational tool able to calculate the roll damping of fpso with acceptable accuracy the computational code helps to a better understanding and visualization of the influence of the vortices on the pressure distribution of fpso section especially around the bilge keel regarding the study of new forms of bilge keels the bilge keels type 2b showed that an excessive gap size in this case equal to the bilge keel width the damping decreases 18 5 with respect to that of the bilge keel 2b for the studied amplitude it is observed a little bit higher damping approximately 4 6 compared with bilge keel 2b when the gap is reduced to 50 of the bilge keel width the bilge keels type 2c always have an arrangement of 45 with an end plate but the roll damping may be improved by modifying the form or angular position of the plate at the end of the bilge keel in this case the bilge keel 2c3 form of y shows more damping but its damping increment of 15 7 was mainly due to the average width increment 35 bigger than the traditional bilge keel of 45 bilge keel 2 the damping increment only due to the form of y bilge keel 2c3 2 was about 3 1 acknowledgements the authors want to present their special thanks to coordination of high level education capes 
23730,this work shows a study about the bilge keel and its influence width and form on the roll damping of fpso sections a computational code was developed to simulate forced roll oscillation of a middle section of fpso with different bilge keels types the computational code calculates the solution of the navier stokes equations in 2d using the finite volume method and the upwind tvd scheme of roe sweby the effect of wave radiation is neglected this work shows how the generated vortices influence the pressure distribution around the middle section of fpso the numerical results are compared with experimental results to validate the computational code new bilge keel configurations were studied to improve the roll damping of fpso keywords fpso bilge keel roll damping forced roll oscillation cfd finite volume method tvd nomenclature a 44 added mass coefficient of roll b beam of the model b 44 damping coefficient of roll c 44 restoring coefficient of roll c p pressure coefficient f r froude number g acceleration of gravity k c keulegan carpenter number l length of the model m mach number m h hydrodynamic moment m θ p pressure moment with respect to center of gravity of the model m θ v viscous moment with respect to center of gravity of the model m mass of the model n normal vector pointing out of the object p pressure of the fluid p pressure of free stream r e reynolds number s area of the cell boundary t draft of the model t p period t time u x velocity component u r e f reference velocity v y velocity component v volume of the cell x horizontal cartesian coordinate y vertical cartesian coordinate w local velocity of the surface of the control volume ε phase of angle θ angle of inclination τ viscous stress tensor ψ flux limiter displacement volume 1 introduction in the field of hydrodynamics of ocean engineering to predict the motion of ship and floating platforms is one of the most important goals in general all movements can be reproduced fairly accurately using known linear methodologies except the strongly nonlinear roll motion the roll motion is very sensitive to the effects of viscosity especially in the presence of appendages such as bilge keels this appendage is a prompter of flow separation around the body generating vortices and viscous damping it is the most traditional passive stability system used in ships the vortices around the hull influence the pressure distribution on the body surface these vortices depend directly on the body geometry and the appendages in the case of floating platforms as fpsos floating production storage and offloading fpsos have cost advantages and cargo capacity especially in regions with little oil flow infrastructure pipelines as the brazilian coast these units are exposed throughout their lifetime to roll motion which has an impact on the design and of related structures ikeda et al 1977a studied the damping component that generates vortices eddy damping and concluded that this component is proportional to the square of the frequency and amplitude of roll motion ikeda et al 1977b concluded that the pressure on a ship hull surface due to the bilge keels is proportional to the square of the oscillation frequency and the negative pressure coefficient behind the bilge keel depends on the keulegan carpenter kc number himeno 1981 described the state of the art of the ship roll damping prediction it showed that it is possible to estimate the roll damping of typical hull ship with reasonable accuracy he commented that the damping of the bilge keel not merely shows a quadratic nonlinear behavior but it depends on the amplitude and frequency in a more complex form downie et al 1988 concluded that for rectangular hulls the damping by wave radiation is small and viscous effects are particularly important on roll damping yeung et al 1998 developed an experimental program to measure the hydrodynamic coefficients of rectangular cylinders and the results were compared with the fsrvm method free surface random vortex method developed by yeung and vaidhyanathan 1994 aloisio and felice 2006 conducted a study of the flow around the bilge keel using a piv system it was concluded that the vortex shedding is the main mechanism involved in the damping of the roll motion and the vorticity shed from the bilge keel is proportional to the amplitude of the motion jaouen et al 2011 reproduced numerically the experimental tests of forced roll oscillation of ikeda et al 1977a and only compared the viscous damping the numerical code that they have developed and used refresco did not consider the effect of wave radiation the results showed good agreement and also showed that in rectangular hull sections the sharp bilges show greater added mass and damping than the rounded bilges avalos 2012 and avalos et al 2014 simulated the roll damping decay of a middle section of fpso with bilge keel through the numerical solution of the navier stokes equations in 2 d the computer code was developed using the finite volume method and the tvd upwind scheme of roe 1984 and sweby 1984 in an unstructured dynamic mesh and neglecting the wave radiation effects the results showed the influence of the bilge in the damping and the difference of the vortex generation mechanism with and without bilge keel the bilge keel has been the most used appendage to reduce the roll motion of stationary floating units for reasons of simplicity and cost efficiency studies of large width bilge keels impacts in roll behavior that can be mentioned for instance are thiagarajan krish and braddock 2009 oliveira 2011 new forms of bilge keels were studied by matsuura et al 2001 na et al 2002 kinnas 2005 and lee et al 2010 the computational fluid dynamics cfd tools have the potential to improve prediction of local loads improving the integrity of this appendage which has become critical to ensuring the satisfactory operation of the production units the present study aims the development of a 2d computational code able to calculate the roll damping of fpsos with new forms of bilge keels the numerical code was developed in avalos 2016 and represents an evolution of the works of avalos 2012 and avalos et al 2014 this code should help to understand how the bilge keels influence the roll damping with respect to its shape and size thus it identifies the main features required for new bilge keel projects numerical results obtained in this study are compared with experimental results of thiagarajan krish and braddock 2009 na et al 2002 and ikeda et al 2004 to validate the developed computational code after the numerical code validation new bilge keel configurations were studied 2 mathematical formulation in the present investigation wave radiation was not considered the body is completely submerged in the numerical tank and the navier stokes equations are solved for the entire flow around the body without considering the source term of the gravity when the forces acting on the body are calculated the effect of pressure and viscous stress of this flow acting on the body is considered only in the part of the body below an imaginary flat free surface defined by the draft the effect of gravity hydrostatic pressure is considered in this calculation as well the slightly compressible navier stokes equations are solved numerically using the finite volume method and the upwind tvd scheme of roe 1984 and sweby 1984 for the flow around a fpso section in forced roll oscillation eq 1 presents the governing equations in two dimensional cartesian coordinates and written in the conservative and dimensionless form as in wanderley and levi 2005 1 q t e e e v x f e f v y 0 where q is the vector of conserved variables e e and f e are the inviscid flux vectors and e v and f v are the viscous flux vectors see eq 2 q p u v e e p u u 2 p u v e v 1 r e 0 u x v x 2 f e p v u v v 2 p f v 1 r e 0 u y v y where 3 r e ρ u r e f b μ u r e f ω θ 0 b all variables are made dimensionless using the beam of the model b density ρ and the velocity u r e f where r e is the reynolds number μ is the dynamic viscosity ω is the circular oscillation frequency and θ 0 is the forced oscillation amplitude the integral form of eq 1 is shown in eq 4 4 d q d t s p q w n d s where 5 p e e e v i f e f v j 6 q v q the vector w represents the local velocity of the cell surface to take into account the deformation of the finite volumes the vectors i and j are the unit vectors in the x and y directions respectively the variable q represents the average value of q in a cell with volume v and surface s and is attributed to the center of the cell q is defined in eq 7 7 q 1 v v q d v in the numerical simulation the following initial and boundary conditions were imposed initial conditions 8 u 0 v 0 p 1 m 2 the value assigned to the mach number m is 0 2 this ensures a slightly compressible flow boundary conditions on the walls of the tank left and right 9 p x 0 u x 0 v x 0 this condition avoids reflection in the tank walls in this way it is not necessary that the length of the numerical tank to have the same size of the experimental tank thereby avoiding an unnecessary computational burden no slip boundary conditions are applied on the top and bottom of the tank 10 u 0 v 0 p y 0 no slip boundary conditions are applied on the body surface 11 u u c v v c p n 0 where u c e v c are the body surface velocity components in the x and y directions respectively 3 numerical formulation equation 12 shows an approximation of the integral form of the governing equations eq 4 applied to a two dimensional triangular finite volume the vector of conserved variables is defined in the finite volume center this is known as cell center approach 12 f 1 3 p e q w s i f p v s i f where the subscript f is the face of the element i and the vectors containing the inviscid and viscous flux vectors are shown in eq 13 13 p e e e i f e j p v e v i f v j the components of the velocity vector w in eq 12 are shown in eq 14 14 u s x f n 1 x f n δ t v s y f n 1 y f n δ t where x f n y f n are the coordinates of the midpoint of face f of the element i at the time instant n eq 14 is an approximation suggested by lesoinne and farhat 1996 to satisfy the equation of geometric conservation law gcl introduced by thomas and lombard 1979 to avoid errors induced by the deformation of the mesh in eq 12 the inviscid flux vector is approximated using the upwind tvd scheme of roe 1984 and sweby 1984 defined in eq 15 15 p e s i f 1 2 e e i e e j s x 1 2 f e i f e j s y 1 2 a ˆ f q j q i where s x and s y are the components of the area vector normal to face f and the subscript j represents the neighbor elements of the element i see fig 1 the matrix a ˆ f in eq 15 is the modified flux jacobian matrix defined in eq 16 16 a ˆ f t f λ ˆ f t f 1 in eq 16 the matrix λ ˆ f is a diagonal matrix which elements are shown in eq 17 and the matrix t f is defined in eq 18 17 λ ˆ k λ k ψ k δ t δ s λ k 2 λ k 18 t f x 1 x 2 x 3 where x k λ k are the eigenvectors and eigenvalues of the jacobian matrix a defined in eq 19 and δ s is the distance between the finite volume centers i and j see fig 1 19 a p e s i f q i in eq 17 ψ k is the van leer 1979 flux limiter presented in eq 20 where the parameter r k is defined in eq 21 20 ψ k 0 i f r k 0 2 r k 1 r k i f r k 0 21 r k b n i j δ w k i j i f λ k 0 d n i j δ w k i j i f λ k 0 where n i j represents a unit vector between the grid elements i and j δ w k i j are the components of the vector δ w i j given in eq 22 the vectors b and d are defined in eq 23 where the subscripts m p s and t are the grid elements shown in the fig 1 22 δ w i j t f q j q i b δ w k j m n j m δ w k j p n j p 23 d δ w k s i n s i δ w k t i n t i in eq 12 the viscous flux vector is approximated as shown in eq 24 24 p v s i f 1 2 e v i e v j s x 1 2 f v i f v j s y the solution of the governing equations in time is obtained using the optimal multistage scheme by tai et al 1995 and the residual smoothing technique by jameson and baker 1983 4 forced rolling motion in order to avoid strong transient flows at earlier time steps of the calculation the forced rolling motion is defined in eq 25 25 θ θ 0 tanh ω t 6 s i n ω t t t p θ θ 0 s i n ω t t t p where t p represents three times the period of forced oscillation all forced rolling motions were initiated from rest the numerical code calculates the hydrodynamic moment m h at each time step assuming a linear damping coefficient the hydrodynamic moment can be written as in eq 26 26 m h a 44 θ b 44 θ c 44 θ where a 44 b 44 and c 44 are the hydrodynamic coefficients of added mass damping and restoring spring respectively for a sinusoidal signal the hydrodynamic moment is given by eq 27 27 m h m 0 s i n ω t ε where m 0 is the amplitude of the roll moment and ε is the phase angle between roll motion and the roll moment therefore the hydrodynamic coefficient b 44 is obtained from m 0 and ε according to eq 28 28 b 44 m 0 s i n ε ω θ 0 in our case where the signal is not sinusoidal m 0 and ε is obtained through a first order fourier analysis where the first seven periods of forced rolling motion were disregarded in the signal processing more periods were disregarded if the steady state of hydrodynamic moment was not achieved especially in high frequencies a minimum of 5 periods were considered to calculate m 0 and ε the dimensionless damping coefficient and the circular oscillation frequency were obtained following vugts 1968 29 b 44 b 44 4 ρ b 2 2 b 2 g 30 ω ω b 2 g the moment acting on the fpso see fig 2 is obtained by integration of the pressure and viscous stress around the part of the body below the imaginary flat free surface defined by the draft equation 31 shows how the pressure and viscous moments are obtained where the hydrostatic pressure is taken into account in the calculation of the pressure moment m θ p s p p ρ g y r n d s 31 m θ v s r τ n d s where 32 r x x c g i y y c g j the cartesian coordinates x c g y c g represent the center of mass of the body 5 grid generation and deformation the mesh generator gmsh by geuzaine and remacle 2009 distributed under the terms of gnu general public license was used in the present study the unstructured grid is composed only of triangular elements generated using the delaunay method the grid is constructed in such a way that the boundary of the body is part of the grid then it is necessary to displace the grid points taking into account the motion of the body the displacement of grid points is achieved with the function f the value of the function varies between zero and one the product between the displacement of the body and the function f provides the displacement of the grid points the function f is defined in eq 33 and shown in fig 3 the deformation of the grid is shown in fig 4 33 f 1 r r 1 1 cos 8 α r 1 r r 2 0 r 2 r where 34 α π 16 1 r r 1 r 2 r 1 6 validation in order to validate the numerical code developed in this work the numerical results were compared to experimental results of na et al 2002 thiagarajan krish and braddock 2009 and ikeda et al 2004 the element size and the maximum number of elements of the grids are shown in table 1 finer grids were not used to avoid excessive computational effort since the upwind tvd scheme of roe sweby used to solve the navier stokes equations requires itself a lot of computational effort as was mentioned before this work used the optimal multistage scheme by tai et al 1995 and the residual smoothing technique by jameson and baker 1983 despite of finer grids were not used the obtained numerical results were satisfactory this is due to the advantage of the use of grids that are deformed and adapted to the body movement avoiding unnecessary computational effort a good reference with respect to this advantage is askes et al 1999 a grid sensitivity study is done for four different grids with element sizes and numbers shown in table 2 to reproducing forced roll oscillation tests the hull section bk1 of thiagarajan krish and braddock 2009 was used in this study see sect 6 2 fig 5 shows the grid around the bilge keel of grid 2 of table 2 it is important to comment that the grid refinement around the part of the body below the imaginary flat free surface defined by the draft was the main concern in this investigation see fig 4 because the forces are computed around this region the damping coefficients of the grid sensitivity study are shown in fig 6 the experimental damping coefficient of thiagarajan krish and braddock 2009 for the bilge keel bk1 is approximately 0 022 see fig 9 the numerical results did not show a big difference for the four tested grids and are very close to the experimental data of 0 022 therefore based on the grid sensitivity tests grids with between 150 000 and 227 000 elements were used in the present numerical study 6 1 comparison with the experimental results of na et al 2002 the characteristics of the hull section and the sketch of the various bilge keels of na et al 2002 are shown in table 3 and fig 7 respectively the forced roll amplitude was 5 and the depth of the wave flume was of 1 0 m according to na et al 2002 the damping coefficient b 44 was normalized according to eq 35 different from that of eq 29 the variables a ρ b and g represents the sectional area density of water breadth of the model and the acceleration of gravity respectively 35 b 44 b 44 ρ a b 2 b 2 g fig 8 shows the good agreement between the numerical and experimental results for the damping coefficient regarding the 45 arrangement bilge keels fig 8a shows that the damping coefficient increases with frequency and bilge keel width increasing the bilge keel width the frontal area and the drag acting on the bilge keel increase therefore the moment opposing the fpso rotational motion increases also consequently the damping coefficient increases increasing the frequency more vortices are shed at the tip of the bilge keel and more energy is transfer from the motion of the body to the flow field and consequently the damping coefficient increases 6 2 comparison with the experimental results of thiagarajan krish and braddock 2009 the characteristics of the hull section of thiagarajan krish and braddock 2009 are shown in table 4 the bilge keels were in the arrangement of 45 and their sizes with 3 mm thick are shown in table 5 the forced roll amplitude was of 12 5 and the depth of the tank was of 1 0 m in the experimental test the bilge keels were tested at various frequencies the present study reproduced the experimental results at 0 646 hz that corresponds to a dimensionless frequency ω of 0 347 the bilge keel length corresponds to a third of the model s length located in the middle of the model therefore to reproduce these results using the 2d numerical code developed in this study a weighted average of the damping coefficient between the model without and with bilge keel was calculated fig 9 shows the good agreement between numerical and experimental results in table 6 the bilge keels from bk0 to bk3 show less than 5 relative error the highest discrepancy is observed for the bilge keel bk4 with 10 3 of relative error this slightly difference may be due to two factors first the fact that the free surface is not captured in our numerical model the bilge keels bk4 and bk5 represent 15 and 20 percent of the half beam of the model and perhaps there may be a greater interaction between the generated vortices by the bilge keels and the free surface second the weighted average to obtain the damping coefficient may introduce some uncertainty in this case the bilge keel in the arrangement of 45 is more used in the field of ship offshore industry fig 10 shows the pressure distribution cp black line and the vorticity field of the bilge keels bk1 and bk5 the direction of the eddies is depicted in fig 10 a and the high and low pressure distributions around the hull section are shown in fig 10 b in the bilge keels it is observed that the high and low pressure distributions are generated by the upstream and downstream sides of the bilge keel respectively the comparison between the pressure distributions of bk1 and bk5 is shown in fig 11 regarding the increased width of the bilge keel it is observed that the pressure distribution changes smoothly around the model and reaches an extreme value around the bilge keel region see fig 10b a sudden decrease of pressure distribution is observed in certain regions due to the presence of the vortices generated at the bilge keel tip this is clearly observed in the bilge keel bk1 in fig 10 a and on the de side of the bilge keel bk5 in fig 10 b all of this is confirmed quantitatively in fig 11 in this last figure it is observed that the hi side of the bilge keel bk1 shows a lower pressure distribution than that of the bilge keel bk5 this is due to the presence of the vortex generated at the tip of the bilge keel increasing the width of the bilge keel the vortices tend to pull away from the body so that the pressure drop on the bottom and both sides of the body is considerably reduced but only observed at the tip of the bilge keel see fig 10b an animation showing more detail about this result can be found in the following link https youtu be 4lngaheiaba 6 3 comparison with the experimental results of ikeda et al 2004 the characteristics of the hull section of ikeda et al 2004 are shown in table 7 the bilge keel was in the arrangement of 45 the forced roll amplitudes were 5 10 15 and 20 and the dimensionless forced roll frequencies ω were 0 299 0 448 considered as low frequency and 0 893 and 0 996 considered as high frequency the obtained results are in a fair agreement with the experimental data see fig 12 table 8 shows the discrepancies between experimental and numerical results it is observed that the relative errors are acceptable except for the amplitude of 5 at low frequencies in these cases the absolute errors are of the order of the corresponding experimental damping coefficients it is important to observe that the higher absolute errors are registered for the amplitude of 20 at high frequencies but their relative errors are acceptable in these cases the numerical results are always more damped than the experimental results see fig 12 a possible justification is the free surface that is not captured in our numerical model at high amplitudes there may be an interaction between the vortices generated by the bilge keel and the free surface that modifies the pressure distribution around the body 7 study of new forms of bilge keel it has been a difficult task to improve the roll damping of offshore structures as in the case of flng floating liquefied natural gas then after validating the numerical code with experimental results this section shows a study of new forms of bilge keels and their influence on the roll damping this study was motivated by the works of matsuura et al 2001 lee et al 2010 and na et al 2002 the last work was described in section 6 1 matsuura et al 2001 developed a new concept of bilge keels msboard flat plates vertical or horizontal attached to the bottom sides of the floating structure with a narrow gap lee et al 2010 developed the l shape roll suppression device l rsd that offers an easy installation and increases significantly the roll damping the characteristics of the hull section are the same as in na et al 2002 and they are shown in table 3 the forced amplitude of 5 is the same as in na et al 2002 and three dimensionless forced roll frequencies ω of 0 4 0 6 and 0 8 were considered the present study used the two better bilge keels with 2 cm width of na et al 2002 namely the bilge keels 2b horizontal and 2c form of t see fig 7 these bilge keels were slightly modified in position and form and grouped in two classifications to permit a better visualization of the results denoted by bilge keels type 2b and bilge keels type 2c the dimensions and forms of them are shown in figs 13 and 14 7 1 type 2b bilge keels the study of the bilge keels type 2b was motivated by the works of matsuura et al 2001 and lee et al 2010 in these studies the authors assessed the application of a gap between the bilge keel and the body and the arrangement of the bilge keel may be vertical or horizontal in the present work the influence of the gap size for the arrangement of horizontal bilge keel is analyzed fig 15 shows the numerical results for the damping coefficient for the bilge keels type 2b it is observed clearly that the excessive gap of the bilge keel 2b1 in this case equal to the bilge keel width the damping decreases considerably considering the average of decrease in damping at each frequency the damping decrease for the bilge keel 2b1 was about 18 5 with respect to the bilge keel 2b a slight decrease of the damping is observed when the gap is decreased more than that of the bilge keel 2b2 see bilge keel 2b3 although both are of the same order for the studied amplitude the bilge keel 2b2 showed a little bit higher damping than the others approximately 4 6 more damping than that of the bilge keel 2b fig 16 shows the pressure distribution around the bilge keels type 2b it is observed that the bilge keel 2b2 has higher pressure distribution around it than that of the others the low pressure distribution on the fg side is similar in the bilge keels 2b2 and 2b3 and represents approximately twice the pressure distribution corresponding to the bilge keel 2b1 the high pressure distribution on the de side of the bilge keel 2b2 is about twice the pressure distribution of the bilge keel 2b3 on the ab side of the bilge 2b2 the high pressure distribution is about twice the pressure distribution corresponding to the bilge keel 2b3 and at the bottom of the body bc side the bilge 2b2 shows a greater pressure distribution near the bilge keel this pressure distribution around the bilge keel 2b2 is farther away from the center of rotation than that of the others and contributes to a greater hydrodynamic moment and therefore a greater roll damping the vortex shedding in the bilge keels type 2b represents an interesting subject of discussion the sudden variation of pressure distribution observed in certain regions of the fig 16 is due to the presence of vortices as seen in fig 10 this is clearly confirmed in fig 17 that shows the vorticity field and pressure distribution for the same instant of time as shown in fig 16 vortex shedding is observed in three places for the three bilge keels type 2b two vortices are generated by the bilge keel and one by the sharp bilge one vortex generated by the bilge keel influences the low pressure distribution on the fg side the vortex generated by sharp bilge influences the pressure distribution sudden decrease on the bottom of the body and the interaction of the two vortices on the bottom of the body influences the pressure distribution sudden increase this is observed clearly in the bilge keel 2b1 and 2b2 the gap size influences the size and interaction of the vortices in the bilge keel 2b1 the greatest gap the vortices are larger and the interaction of the two vortices on the bottom of the body occurs furthest from the bilge keel than that of the others in the bilge keel 2b3 this interaction of vortices on the bottom of the body is faster and weaker than the other bilge keels for this reason it is not observed a pressure distribution sudden increase as the bilge keels 2b1 and 2b2 an animation showing more detail about this result can be found in the following link https youtu be dtdm 4xds5u 7 2 type 2c bilge keels the bilge keels type 2c shown in fig 14 are variations of the bilge keel proposed by na et al 2002 the bilge keel 2c form of t showed the best damping characteristics of those bilge keels with 2 cm width in that case the influence of the plate at the end of the bilge keel with slight variations of position and form is shown comparing the influence of the plate at the end of the bilge keel at horizontal bilge keel 2c1 and vertical bilge keel 2c2 positions it is observed in fig 18 that the vertical position of the plate decreases the damping by about 6 3 and the horizontal position increases the damping by about 3 with respect to the original position similar behavior was observed in the experimental and numerical results in sect 6 1 where the bilge keel 2a vertical position showed less damping than the bilge keel 2b horizontal position modifying the end plate of the bilge keel as in the case of the bilge keels 2c3 and 2c4 the increase and decrease behavior with respect to original bilge keel is repeated again but this damping variation is greater see fig 18 the increase and decrease of the damping were about 21 and 10 7 respectively the bilge keel 2c3 form of y showed more damping than the bilge keel 2c4 form of arrow therefore the best bilge keel of the type 2c is the bilge keel 2c3 showing a considerable damping increase fig 19 shows the pressure distribution of the bilge keels type 2c the high pressure distribution on ab and bc sides of the bilge keel 2c3 is slightly greater than that of the other bilge keels the low pressure distribution on the opposite side of bc and on the bottom of the body is similar on the bilge keels 2c1 2c3 and 2c4 but it is more significant on the bilge keels 2c3 and 2c4 for the best bilge keel of type 2c bilge keel 2c3 the pressure distribution on the sides cd ef and hi contributes to a greater hydrodynamic damping moment fig 20 shows the numerical results for the best bilge keels of this study bilge keels 2c3 and 2b2 they are compared to the numerical results obtained for the bilge keel 2 of sect 6 1 the traditional bilge keel of 45 with 2 cm width it is observed clearly that the increase of damping obtained in the bilge keel 2c3 form of y was about 15 7 more than that of bilge keel 2 the bilge keel 2b2 showed only 1 4 more damping than the bilge keel 2 in this figure the result of the other bilge keel in the form of y is added denominated bilge keel 2c3 2 this bilge keel has an average width of 2 cm equal to bilge keel 2 it is observed that the bilge keel 2c3 2 shows a small gain of damping with respect to bilge keel 2 similar to bilge keel 2b2 the gain of damping was about 3 1 with respect to bilge keel 2 therefore the damping increment observed in the bilge keel 2c3 is mainly due to the increment of the average width 35 bigger than the bilge keel 2 8 conclusions a numerical code was developed in order to reproduce numerically forced roll test of fpso with bilge keels the new numerical code was validated reproducing forced roll test of fpso with bilge keels of the literature the code was tested up to amplitudes of 20 compatible with the maximum amplitudes that these platforms operate in its useful life the numerical results show the code capacity to reproduce these tests despite the approximation of the numerical model it demonstrates that this approximation is acceptable in order to reproduce these tests up to amplitudes of 20 besides to demonstrate to be a computational tool able to calculate the roll damping of fpso with acceptable accuracy the computational code helps to a better understanding and visualization of the influence of the vortices on the pressure distribution of fpso section especially around the bilge keel regarding the study of new forms of bilge keels the bilge keels type 2b showed that an excessive gap size in this case equal to the bilge keel width the damping decreases 18 5 with respect to that of the bilge keel 2b for the studied amplitude it is observed a little bit higher damping approximately 4 6 compared with bilge keel 2b when the gap is reduced to 50 of the bilge keel width the bilge keels type 2c always have an arrangement of 45 with an end plate but the roll damping may be improved by modifying the form or angular position of the plate at the end of the bilge keel in this case the bilge keel 2c3 form of y shows more damping but its damping increment of 15 7 was mainly due to the average width increment 35 bigger than the traditional bilge keel of 45 bilge keel 2 the damping increment only due to the form of y bilge keel 2c3 2 was about 3 1 acknowledgements the authors want to present their special thanks to coordination of high level education capes 
23731,in order to extend the operational weather window for marine vessels under dynamic positioning dp control a novel sea state identification method with multi layer classifiers is proposed in this paper due to the distinction of system responses for various sea states four motion signals including surge sway roll and yaw are adopted for classification purpose firstly preprocessing techniques like filtration and k means clustering are performed to the raw data to filter out the corrupted low frequency lf information and generate the band pass filter bank then the processed data is decomposed into 20 categories via hilbert huang transform hht filter bank method and wavelet transform and 11 statistical features are extracted for each category subsequently max relevance min redundancy mrmr method helps to select salient features with best trade off between relevance and redundancy with these selected features a newly developed three layer classification structure with adaptive neuro fuzzy inference system anfis random forest rf and particle swarm optimization pso based combination classifiers is proposed to derive the current sea state the simulation results demonstrate that the proposed identification system can achieve satisfactory classification accuracy moreover the multi layer classifier outperforms single layer classifier and can rapidly classify the sea state in real time implementation keywords sea state identification feature extraction multi layer classifier marine vessel 1 introduction due to the increasingly serious global energy crisis during the past few decades people focused on offshore resources development say oil and gas while recently offshore operations have been moving towards more challenging environments such as ultra deep waters and arctic areas where richer resources are detected and to be mined however in deepwater environment the traditional mooring system is not so efficient hence there is a large demand to use the dp control system for a floating vessel dp system keeps a vessel in fixed position or following a predefined trajectory through the active thrusters nguyen et al 2007 so that a smooth and continuous offshore operation can be guaranteed the first dp system dates back to 1960s this control system used an siso pid controller to regulate the horizontal modes of motion sørensen 2011 in 1980 a kalman filter based optimal multi variable control was proposed to cope with the slow oscillating motion of vessels based on model adjustments and parameter tuning rules balchen et al 1980 a detailed mathematical model of vessel was required to optimally estimate the vessel motions and environmental forces in 1990s nonlinear controller such as fuzzy control and nonlinear feedback linearization based backstepping were designed in stephens et al 1995 godhavn et al 1998 and berin et al 2000 for dp system later sliding mode control in combination with an easy tuning methodology were proposed in tannuri et al 2010 to handle the variations in environmental and loading conditions however all these control theories consider only a limit of weather condition in lindegaard 2003 the author proposed an acceleration feedback using imu to improve the performance under severe sea conditions to ensure the vessel stability during the ocean condition transition from calm to extreme a supervisory switched control was designed in dong 2005 nguyen et al 2007 nguyen et al 2008 nguyen and sørensen 2009 hassani et al 2012a b this hybrid control strategy increased the operation window by making it possible to realize all year marine operations using the integration of a set of models and controllers these works identify the sea state by using spectral analysis of the position measurement which is completely model free and based on signal processing only in practical due to the randomness of the environmental forces this method which only depends on the recent collected data may easily lead to chattering or incorrect identification output the model based sea state identification works can be found in hassani et al 2012a b 2013 other sea state estimation researches are presented in bitner gregersen et al 2016 eckert gallup et al 2016 nielsen 2017 traditionally sea state can either be assessed by an experienced observer like a trained mariner or through instruments like weather buoys wave radar or remote sensing satellites calla 2011 these schemes depend heavily on extra instruments or sensors which makes the results either inaccurate or uneconomical in nguyen and quek 2010 the peak frequency of waves is estimated and the corresponding sea state is classified through the estimated peak frequency but this method has innegligible probability of wrong condition estimation which may lead to the failure of the switching system to address the above mentioned problems a novel sea state identification system is proposed in this paper to accurately identify the sea state with the mounted motion sensors that are originally used for dp control purpose the output of the proposed approach is the classified sea state levels calm smooth high which indicate the general condition of vessels in the ocean with respect to wind waves and swell at a certain location and moment a detailed elaboration can be found in section 2 this scheme utilizes the onboard motion sensors such as global positioning system gps hydro acoustic position reference hpr unit gyroscopes and motion reference unit mru nguyen and quek 2010 to collect the four degree of freedom dof motions surge sway roll and yaw of a vessel these four motions contain the response information of wave force excitation and dp control force moreover in order to reduce wear and tear on the thrusters dp control only considers the lf motion of a vessel liu et al 2008 therefore the high frequency hf wave induced motion is relatively pure and can reflect the response of the vessel against varying sea state to obtain the hf motion component a high pass filter with proper cut off frequency is required in the preprocessing stage prior to further analysis in this paper the dp system is assumed to adopt a passive filter and pid controller fossen and strand 1999 under the dp control the vessel is performing a very slow target following task with the velocity approximating to zero this scenario mimics the supply vessel serving a turret moored floating production storage and offloading fpso in deepsea operation the time and frequency domain statistical information of the measured motion data are analyzed by means of filter bank decompositions hilbert huang transform and wavelet transform these methods are capable to decompose the given sequence into different frequency intervals with distinct scales of resolution in this manner a thorough analysis on the signals can be conducted to avoid the curse of dimensionality mrmr method peng et al 2005 is applied to select the most relevant features as well as minimizing the mutual redundancy with the selected salient features a three layer classifier structure is developed using anfis rf and pso based classifier combination technique the proposed structure is able to upgrade the classification accuracy compared with a single layer structure the flow chart of the proposed system is depicted in fig 1 the innovations and contributions of this paper is three fold i for the first time accurate sea state identification is achieved only based on the ship motion response which makes it possible to reduce the instrument cost and shows great feasibility to implement ii since the proposed approach is model free and only copes with the pure hf motion response it can be widely used for different ship types under distinct control strategies iii the novelly proposed identification structure presents an all around time frequency domain analysis for the measured signals also the newly designed multi layer classifier achieves excellent performance in simulation study the organization of this paper is as follows section 2 briefly introduces the definition of sea state code and preliminary knowledge about wave spectrum section 3 presents the lf and hf model of the vessel as well as the filtering and control strategies preprocessing feature extraction and feature selection techniques are explicitly illustrated in section 4 details on the development of multi layer classifier are introduced in section 5 in section 6 numerical simulation study is conducted to demonstrate the efficacy of the proposed approach finally section 7 gives some concluding remarks 2 sea state descriptions in oceanography a sea state refers to the general condition of the vessels in the ocean with respect to wind waves and swell at a certain location and moment a sea state is characterized by statistics with the following parameters i significant wave height ii average wave frequency or average zero crossing wave frequency or peak frequency fossen 2011 to describe the sea state quantifiably sea state code is introduced as shown in table 1 price and bishop 1974 pfw is the abbreviation of peak frequency of the waves it should be mentioned that sea state definition is always with respect to a specific vessel the data in that table refers to a relatively large vessel the proposed approach is applicable to all types of vessel with specifically trained multi layer classifiers which will be introduced in following contents to study the wave energy distributed among different frequencies and wave heights the concept of wave spectrum is put forward there are many off the shelf spectrum such as modified pierson moskowitz mpm spectrum joint north sea wave project jonswap spectrum torsethaugen spectrum and etc these spectra describe the wave in terms of different generation ways fossen 2011 in this paper we consider the jonswap spectrum this spectrum is measured in the north sea between the island sylt in germany and iceland during year 1968 1969 it is applicable for most wind generated waves under the assumption of finite water depth and limited fetch the corresponding spectral density function sdf can be expressed as 1 s ω 155 h s 2 t 1 4 ω 5 e x p 944 t 1 4 ω 4 γ y j where 2 y j e x p 0 191 ω t 1 1 2 σ 2 σ 0 07 ω 5 24 t 1 0 09 ω 5 24 t 1 t 1 0 834 t 0 t 0 is the peak period and the peak enhancement factor γ equals 3 3 hasselmann et al 1973 which is a default value and can be replaced with other feasible values the plot of jonswap spectrum under different sea states is presented in fig 2 from the figure it can be observed that in frequency domain with the increment of sea state the dominant frequency decreases while the energy involved in the wave increase this characteristic brings possibility to identify the sea state from frequency perspective for analysis purpose the wave force acting on the vessel is usually separated into two categories i first order wave induced force ii second order wave induced force the former one refers to the zero mean wave frequency i e hf oscillatory force the latter one represents the nonzero slowly varying drift force fossen 2011 these two types of forces cause the hf and lf motion of the vessel respectively in practical dp implementation it is not energy efficient to also regulate the hf motion thus generally the hf component needs to be filtered out in advance which means this part is not corrupted by the control and is suitable as the raw data for classification remark it should be noted that when high or extreme sea happens it is not anymore possible to separate the lf and hf motion due to their big overlap if we still would like to apply control to the vessel under this situation the uncontrolled dofs such as heave can be used without filtration for the identification however usually the occurrence probability of these sea states is very low as table 1 presents in this work the hf motion of a supply vessel is generated using the mss toolbox fossen and perez 2004 and shown in fig 3 it can be seen that the time domain variation is also obvious enough to separate different sea state levels this paves way for hybrid time frequency domain analysis for sea state identification remark compared with practical system mss toolbox adopts an experientially simplified mathematical model for the dynamics and thruster motor system although the fidelity is reduced the produced data is still informative enough to depict the time and frequency domain properties of the vessel motion for theoretical performance verification 3 modelling and control of marine vessels in this paper a typical supply vessel is considered as the target ship due to the dynamic positioning system the vessel is performing very slow tracking task to achieve the tracking a commonly used passive filter with pid control is applied and depicted in this section 3 1 dynamic model the coordinate system for supply vessel can be found in fig 4 referring to fossen 2011 the north east down ned coordinate system is employed for the global frame o 0 x 0 y 0 z 0 with the origin fixed at a certain point on sea level the local frame of supply vessel o s x s y s z s is a moving coordinate system with its origin fixed at the midship point in the water line x s axis is the longitudinal axis which points to the fore of the ship y s is the transversal axis which directs to the starboard z s axis points to the center of the earth which is normal to the sea level by fossen 2011 a 6 dof lf dynamic model of the vessel is considered as follows 3 η j η ϕ η θ η ψ ν 4 m ν c ν ν d ν ν g η τ d where η η x η y η z η ϕ η θ η ψ t represents the earth fixed vessel position and orientation known as surge sway yaw roll pitch yaw ν u v w p q r t denotes the body fixed velocities of translation and rotation j η ϕ η θ η ψ r 6 6 is the rotation matrix m m r b m a r 6 6 denotes the inertia matrix which is the sum of rigid body inertia and added mass c ν c r b ν c a ν r 6 6 is the matrix of coriolis and centripetal d ν r 6 6 and g η r 6 1 are damping matrix and restoring force respectively τ r 6 1 describes the resultant control forces from the thrusters d r 6 1 denotes the external environmental forces and disturbance for dp implementation it is usually hard to control heave roll and pitch motion of a vessel thus a 3 dof model is usually considered when the filter and controller is developed 5 η j η ψ ν 6 m ν c ν ν d ν ν g η τ d where η η x η y η ψ t and ν u v r t other matrices are similar dynamic terms with those in 3 4 but in 3 dof more details about the model can be found in fossen 2011 3 2 linear approximation of hf motion for practical control system implementation and test a simple but effective way to represent the hf oscillation is required thus in year 1976 a linear approximation model is proposed to estimate the hf motion of a vessel in surge sway yaw by balchen et al 1976 the irrotational first order wave induced motion is defined as 7 ξ ξ i ξ i i o i ω 1 ω 2 ξ i ξ i i o ψ w ω w a ω θ ω ξ i ξ i i o ψ w ω w we define 8 a ω θ ω o i ω 1 ω 2 o i d i a g θ ω 1 d i a g θ ω 2 where ξ i ξ 1 ξ 2 ξ 3 t is an intermediate state of the wave motion model ξ i i ξ 4 ξ 5 ξ 6 t is the hf wave induced motion component ψ w r 3 3 and ω ω r 3 are wave intensity matrix and zero mean white noise vector respectively θ ω 1 ω o 1 2 ω o 2 2 ω o 3 2 θ ω2 2ζ o1 ω o1 2ζ o2 ω o2 2ζ o3 ω o3 describe the variation of wave condition and ω oi i 1 2 3 is the dominant frequency of wave induced motion ζ oi i 1 2 3 is the corresponding damping ratio combining the lf motion model 5 6 and the hf motion model 7 the measurement vector is derived as 9 y y x y y y ψ η x η y η ψ o i ξ i ξ i i η c ω ξ it should be noted that although the 3 dof model is considered in dp control system the proposed identification algorithm utilizes a fourth dof i e the roll motion the hf model for roll motion is very similar to that in 7 fossen 2011 since the roll motion is not affected by dp control the measured signal does not contain the lf component and can be imported to the identification system directly without high pass filtering in the preprocessing stage 3 3 filtering and control in order to reduce wear and tear on the thrusters due to the hf wave induced motion a low pass filter is usually developed to obtain the lf motion before control design a typical passive nonlinear filter is formulated as follows strand and fossen 1999 fossen and strand 1999 fossen 2011 10 ξ ˆ a ω θ ˆ ω ξ ˆ k 1 h y f 11 d ˆ t d 1 d ˆ k 3 y k 3 l x f 12 η ˆ j η ψ ν ˆ k 2 y k 2 l x f k 2 h y f 13 m ν ˆ c ν ˆ ν ˆ d ν ˆ ν ˆ g η τ d ˆ j t η ψ k 4 y k 4 l x f k 4 h y f 14 ŷ η ˆ c ω ξ ˆ where η ˆ ν ˆ and ξ ˆ are estimated lf positions and orientation velocities and wf model states respectively k 1 h r 6 3 k 2 k 2 l k 2 h k 4 k 4 l k 4 h r 3 3 are filter gain matrices x f r 3 and y f r 3 are the low pass and high pass filtered innovation signals t d r 3 3 is the matrix of bias time constants a nonlinear pid controller is used for performing the tracking task along the desired trajectory η d η x d η y d η ψ d t the control law can be written as strand and fossen 1999 15 τ m j t η ˆ ψ η ψ d k p e k d ė k i 0 t e d δ where e j t η ˆ ψ η η d r 3 denotes the tracking error of lf positions and orientation 4 preprocessing feature extraction and reduction the measured 4 dof signals surge sway roll and yaw are chosen as the raw input data of the sea state identification system it should be noted that this paper aims to develop a general framework for the sea state identification which can be applied to all the six dofs motion of the vessel besides the aforementioned four motions each data sequence contains 8 sea states state 0 2 are merged as one state with the sampling time of 1000s for each state the sampling rate is 1 hz the training set has 200 samples for each states which means there are in total 200 8 1 600 sequences for analysis and training firstly in preprocessing stage the corrupted lf component is filtered out moreover a bunch of band pass filters are generated using k means clustering for the next stage in feature extraction apart from time domain analysis three effective methods i e band pass filtration based fft hilbert huang transform and wavelet transform are employed for the frequency domain analysis to bloom the features subsequently mrmr helps to reduce the dimension of the features by selecting the most salient four ones the salient features construct the training and testing sets for classification in the final stage 4 1 preprocessing the overall preprocessing steps proposed in this paper is shown in fig 5 in this stage two tasks are expected to be completed i high pass filtration ii generation of band pass filter bank task ii whose steps are enclosed in the dash box aims to generate five band pass filters for the feature extraction stage the band pass frequencies of the filter bank should cover the whole frequency band of the collected data and the band pass frequency of each filter needs to be distributed rationally to achieve this the k means clustering algorithm is applied to the training data set to generate five clusters of frequency bands in this task all the sequences of 8 states are merged into one training sequence such that each new sequence contains 1 000 8 8 000 points in order to handle the time varying dominate frequency and bloom the samples for clustering framing and hamming windowing are introduced in this task before fft each step has its own function and mathematical expression as illustrated briefly in the following article step 1 high pass filter since dp control only considers lf motion of a vessel the hf motion is relatively pure and can reflect the sea state accurately therefore a high pass filter is required to remove the influence of lf motion and reserve the hf one hf motion usually has period less than 25s equivalent to 0 251 rad s or 0 04 hz joseph 2013 the cut off frequency is chosen as 0 23 rad s different from other steps in preprocessing stage which are only applicable for training data the high pass filter is necessary for both training and testing data set step 2 framing to derive adequate samples for k means clustering the collected motion sequence is segmented into small frames with 512 sampling points each two adjacent frames are overlapped by 100 points hence every signal sequence will generate 19 frames step 3 hamming windowing hamming window is used to minimizing the disruptions at the beginning and end of each frame gupta et al 2013 by multiplying the window function and the frame sequence the number of points in each frame n equals to 512 in this paper step 4 fast fourier transform fft fft is applied to convert each frame of n samples from time domain to frequency domain after conversion the dominant frequency of each frame is collected as the sampling set for k means clustering step 5 k means clustering the collection of dominate frequency value are assigned to 5 clusters to generate the filter bank using the k means algorithm the size of sampling set m is 19 200 3 800 for each dof the clustering results are shown in fig 6 4 2 feature extraction 4 2 1 signal statistical characteristics to extract features from both time and frequency signal sequence 11 statistical features are considered as shown in table 2 these features describe the investigated sequence in different aspects f 1 and f 3 f 5 reflect the amplitude and energy f 2 f 10 as well as f 6 f 7 present the distribution characteristics while f 8 f 9 and f 11 indicate the influence of impact or impulse input moreover normalization is significant to the convergence speed and the classification accuracy thus each feature should be mapped to the interval of 1 1 after generated however in practical implementation not all the 11 features are necessary to be calculated instead the salient ones for each signal sequence will be derived through feature selection algorithm the details are going to be introduced after the feature extraction section 4 2 2 feature extraction with filter bank different sea states are discriminative by various dominant frequency to study the characteristics on each frequency band separately would contribute a lot to the accuracy of classification in this work the signals are subjected to five band pass bp1 bp5 filters to generate the filtered sequence for feature extraction the band pass frequencies of the filter bank are determined in preprocessing stage and the result is presented in table 3 there frequencies are chosen to cover the signal components containing the majority of hf motion energy with proper frequency intervals after filtration the 11 features shown in table 2 are extracted from the filtered signals in time domain hence there are in total 11 5 55 time domain features for each dof to eliminate the effect of hf non stationary noise and uncertainties caused by the data collection process the filtered signal should be demodulated before frequency domain analysis is conducted in this work hilbert envelope spectrum is proposed to attenuate the disturbance firstly the filtered signal x t is subjected to hilbert transform makwana et al 2012 16 h x t 1 π x t t τ d τ the analytical signal of x t is 17 z t x t i h x t a t e x p i θ t where a t x 2 t h 2 x t θ t atctan h x t x t secondly the hilbert envelope spectrum can be derived by 18 h f a t e j 2 π f t ⅆ t the obtained spectrum is further processed to produce another 11 5 55 features in frequency domain for each dof therefore 110 features are generated for each dof after filter bank process 4 2 3 hilbert huang transform hht is developed to decompose a time domain sequence into its individual characteristic oscillation sub components using empirical mode decomposition emd schlurmann 2001 the embedded characteristic oscillation is represented in the form of intrinsic mode function imf in other words the complicated original signal is decomposed into a bunch of complete and orthogonal imfs the procedure that emd conducts to search imfs are introduced in algorithm 1 the first two imfs that contain the most characteristic of the signal are selected to derive the features similar to the last subsection the hilbert transform is employed to each of the disintegrated imf subsequently the instantaneous frequency can be calculated with the following equation ville et al 1948 image 1 19 f t 1 2 π d θ t d t the hht brings us another 11 2 22 features for each dof 4 2 4 wavelet transform different from fourier transform wavelet transform is believed to have strong capability to analyze a signal through correlation with translation and dilatation of a short duration mother wavelet ψ mentouri et al 2013 this enables wavelet transform to analyze a signal with multi scales both in time and frequency domain qin et al 2015 in this paper the sampling rate is 1 hz and referring to table 1 the dominant frequency of the hf motion is in the range from 0 04 0 25 hz therefore we choose the decomposition level to be five the frequency range of the five levels can be found in fig 7 by trial and error the daubechies wavelet of order 1 db1 is selected as the basis function four approximation components a 1 a 4 and three detail components d 3 d 5 are chosen to exact the features which gives 11 7 77 features for each dof 4 2 5 max relevance min redundancy for dimension reduction according to above discussion and table 4 where td and fd denote the abbreviation of time domain and frequency domain respectively there are as many as 220 features for one dof although these features are all applicable to identify the sea states from different aspects they are discriminative in relevance some features are salient while others are not therefore to improve the identification performance and reduce training and testing cost the non significant features must be abandoned to achieve this mrmr method is applied to rank the features based on the relevance to target variables and mutual redundancy cai et al 2012 mrmr method believes that good features can provide the best trade off between maximum relevance d to the target variable and the minimum redundancy r concretely mrmr aims to optimize d and r simultaneously as follow 20 max d r in practical implementation incremental search is applied to solve the optimization problem apart from the above mentioned d r pattern d r is also an effective method to search the solutions in this work d r pattern is adopted and the 11 statistical features f 1 f 11 are sorted for each feature category of the four dof a representative result in surge direction is presented in fig 8 this result shows the mrmr values of the sorted 11 features in saliency decreasing order as can be seen from the figure the first feature usually has a very high mrmr value denoted as v mrmr 1 due to the absence of redundancy criterion and generally the features with lower priority would have smaller mrmr values to determine the number of salient feature that we needed for training the following criterion is proposed the first n features are selected as the salient feature if the n 1 th feature has a mrmr value smaller than σ v mrmr 1 σ is a scalar and in this paper by balancing the classification accuracy and the identification speed this parameter is tuned as 20 the excellent classification performance with this parameter is demonstrated in the simulation section moreover for the ease of classifier design an average number of salient feature is calculated for all the categories with above criterion and the result is 4 in this way the total features for each dof are reduced to 4 20 80 the selection results for each feature category are shown in the simulation section 5 multi layer classifier the classifier for sea state identification is introduced in this section to guarantee the classification accuracy a three level classifier structure is proposed firstly 20 anfis classifiers are designed for each category in every dof secondly four random forest rf classifiers are involved to derive the identification results for the four dof the training set of the rf classifier is constructed with the output of anfis classifiers finally the outcome of the four dof are combined through a weighted averaging technique with bias compensation to determine the weights and bias efficiently pso approach is applied to search the solution iteratively moreover two auxiliary combination rules are also taken into consideration to avoid the effect of dominant elements 5 1 design of anfis classifier anfis is firstly introduced by jang 1993 with the capability of universal approximation combined with the sugeno approach anfis is later widely used to predict the output from input variables it integrates the back propagation and least squares estimation lse to identify the structure and learn the fuzzy rules of the takagi sugeno ts system automatically a simple but typical first order sugeno type model has the following expression 21 i f x i s a a n d y i s b t h e n z a x b y c where x and y are the two inputs and z represents the system output a and b denote the linguistic labels in this paper they can be different sea state codes a b c are the consequent part parameters a typical first order anfis structure with two input variables can be found in fig 9 as shown in the figure the structure contains five layers and each of the layer has the function of i system fuzzification ii firing strength calculation iii firing strength normalization iv system defuzzification and v overall output a 1 a 2 b 1 b 2 stands for the membership functions mf both the shape and the premise parameters inside the mfs need to be chosen according to the system specifics in this paper 20 anfis are employed for the 20 categories of each dof each anfis has four inputs corresponding to the four salient features and one output representing the identified sea state code hence by the end of the first classification 20 sea state levels outputs are prepared as the input new features of next layer classifiers for each dof by trial and error the number of mf is selected to be 4 and the shape is bell shape the maximum training epoch number is 200 and training error is set as zero the initial step size step size decrease and increase rate are chosen as 0 01 0 9 and 1 1 respectively the classification results for this layer are elaborated in the simulation section 5 2 random forest classifier design random forest ho 1998 has been proven to be effective in handling large training set as mentioned in the last section the number of input to the rf classifiers can be as many as 20 anfis classifier would take a long time for training due to its complex structure in the contrary because of the random space method not all the features are going to be used in a single candidate split in this manner not only the correlation among decision trees can be avoided but the training speed is improved in this paper four rf classifiers are designed for each dof with the input of 20 features each feature denotes one identified sea state obtained from anfis classifier the number of decision tree in each classifier is chosen to be 300 this layer will generate four identification results for the final layer to process 5 3 pso based multi classifier combination in the second layer four identification results are derived from hf oscillation data in surge sway roll and yaw this subsection intends to calculate the final identification result with these four inputs different from traditional linear weighted averaging technique lei et al 2007 in this work a bias compensating weighted averaging method is applied the final classification result is derived with the following combination 22 z r o u n d k 1 4 w k y k b w k b 0 where z y k are the final output and intermediate output of rf classifiers respectively round rounds the nearest integer of w k denote the weights associated with four rf classifiers b represents the bias the novelly added bias can compensate for the linear combination of the voting in this manner the classification accuracy can be improved pso is used to estimate the weights and the bias iteratively the fitness function can be defined using root mean square rms as 23 j 1 1 e e 1 n n 1 n c n z n 2 where c n is the target output n is the number of the training samples by trial and error the population size is chosen to be 300 the maximum and minimum inertia weights are 0 9 and 0 4 respectively the maximum number of iteration is selected as 300 moreover it should be noted that the performance of the mentioned combination method can be degraded dramatically due to some dominant features the weights corresponding to these features are usually very large so that the final result is easily manipulated by the dominant features to counterbalance this problem two additional rules with the highest priority are involved they are summarized as follows the output z n is set to be the majority votes if three out of the four inputs share the same sea state the output z n is set to be the majority votes if two out of the four inputs share the same sea state and the minority two votes are different with the above two auxiliary rules the accuracy of classification can be improved obviously as illustrated in the simulation section 6 simulation study in this section a supply model is used for case study during the simulation some components of the proposed algorithm are verify and the proposed method performance is demonstrated via both static and dynamic study the geometric and dynamic parameters are referred to nguyen et al 2007 the mss toolbox is employed for the generation of data sequence under jonswap spectrum the mean wave attack direction with respect to the bow of the vessel is set as 135 deg bow sea the vessel performs slow tracking motion under the dp system as mentioned in section 4 eight states data are generated with sampling rate of 1 hz each sample includes collected oscillation data for 1000s and each state contains 300 samples among the 300 samples 200 samples are selected as training set and the remaining 100 is testing set thus we have in total 200 8 1 600 sequences for training and 100 8 800 sequences for testing after preprocessing and feature extraction the feature selection algorithm mrmr is then performed for each category the results are shown in table 5 the corresponding histogram in fig 10 shows the number of times that a single feature is called as a salient feature the results reveal that the salient features are exclusively distributed in f 1 f 7 by recalling the representation of each features it can be observed that energy and distribution characteristics are two main factors to describe different sea states this coincides with the property of jonswap spectrum shown in fig 2 moreover f 2 f 4 f 3 and f 5 are the four most salient features that can best present the diversity of various sea states they corresponds to the variance root mean square square root of amplitude and maximum of the data sequence the selected salient features are then applied to train the anfis classifiers 800 out of the 1 600 training samples are put in the training set and the remaining 800 samples construct the intermediate testing set 20 classifiers for each dof are trained and they are denoted as ctd c t d b p 1 c t d b p 5 c f d b p 1 c f d b p 5 c h h t 1 c h h t 2 and c w a v l e t 1 c w a v l e t 7 respectively after training the intermediate testing sets are imported to generate the training set for the second layer classification classifiers in the second layer is named as crfsur crfswa crfroll and crfyaw these four classifiers correspond to the four dof respectively combining training and intermediate testing set in total 1 600 samples outcome from anfis classifiers are imported to one rf classifier and the output is treated as the training input of the final layer classifier the training strategy can be summarized in fig 11 after pso optimization the weights and the bias are solved as 0 386 0 0 0 644 t and 0 027 the classification accuracy of each layer is shown in table 6 and fig 12 for concise illustration the 20 classifiers are categorized into 5 classes the ctd bp describes the average classification accuracy of ctd bp 1 ctd bp 5 the same situation holds for cfd bp chht and cwavlet avglyr1 and avglyr2 are the average accuracy of first layer classifiers and the second layer classifiers chybrid is the overall accuracy as can be observed in the results the accuracy upgrades with the increasing of layers among the first layer time domain analysis performs best however time domain analysis alone can only achieve an accuracy of 95 19 for testing set with the frequency domain analysis the accuracy goes up to over 99 in the second layer after the three layer classification almost all the samples can be classified successfully 99 88 moreover the values of weight in the last layer reveal the dominant role of surge and yaw motion for the final identification result due to their perfect performance in the training phase this phenomenon means the final result is heavily manipulated by these two dof and vulnerable to their incorrect results this drawback demonstrates the necessity of the two additional rules in section 5 to numerically prove the efficacy of the two auxiliary rules experiment in the absence of the rules are conducted the classification accuracy goes down to 99 63 this result verifies the effectiveness of the additional rules since we hope to utilize the sea state identification system for real time control system the identification speed is of great significance the candidate sequence for the above system contains 1 000 points i e it costs 1000s to construct an available candidate sequence in the following study a proper number of necessary points in one sequence is going to be researched the number of points is named as record interval the test sequence is cascaded with 8 classes each class contains 2000s as shown in fig 13 and the proposed identification system is applied slidingly on the measured data set with different record intervals in this paper 10 candidate record intervals are investigated which are 50s 100s 150s 200s 300s 400s 500s 700s 850s and 1000s the classification interval is 4s activate the identification system every 4 s the simulation result of different record intervals are presented in fig 14 the results reveal that the selected 10 record intervals are all able to classify the testing sequence roughly however the longer the record intervals are the more stable the output becomes this is reasonable because longer record interval bring more solid and adequate information about the current sea state so that the classification accuracy increases but longer record interval causes obvious identification delay at the sea state transition point in practical control system implementation this delay leads to the postponement of switching signal in the controller which may further contribute to the arising of control error the quantitative analysis outcome is presented in table 7 and fig 15 the classification accuracy and the identification time of the 10 candidate record intervals are compared in this study the identification time is defined as the average duration that the classification system can give an accurate output after sea state transition by saying accurate we mean the moment when the following 20 successive outputs i e 20 4 80s give the correct classification results for 50s and 100s this moment does not always exits thus the identification time for these two candidates remind blank it can be observed from the results that the accuracy increases at first and decreases after the peak of candidate 300s the identification time also shows similar trend but in the opposite way hence obviously the best record interval should be 300s in this study extendedly the range from 200s to 400s are also acceptable by further investigation we observe that short record interval has unsatisfactory performance for high state identification obvious identification error can be seen especially for level 7 and level 8 this is because higher state level causes longer wave length period of oscillation short record interval can only capture limited number of cycle also due to the randomness of the hf motion it is very likely that the collected data shows similar statistical characteristics with that in low level states e g smaller amplitude the above reasons explain the unfavorable performance of short record interval when dealing with high sea state levels however recalling the possibility percentage of individual sea state in table 1 we can see that not all the states evenly occur moderate and slight sea states are the most common ones and the high or extreme sea states are unusual this motivates us to study the response of the identification system and the record interval under reasonably distributed sea states for the purpose of study a new data sequence with corresponding sea condition occupance percentage is generated for instance the preprocessed data in surge direction is shown as fig 16 a the simulation time is 6 h which means we collect 21 600 points for this study there are in total 11 phases in this study describing the rise and vanishment of the sea states the points that each phase contains are 1211 4326 3627 1135 307 225 347 1630 5054 2 519 and 1 219 the classification interval is still 4s the standard output is presented in fig 16 b 14 candidate intervals are studied in this section they are 20s 50s 65s 80s 90s 100s 150s 180s 200s 250s 280s 300s 350s and 400s the accuracy rate and the corresponding curve are depicted in table 8 ri stands for record interval and fig 17 some representative results are shown in fig 18 from the accuracy curve we can see that the accuracy peak forms at around 80s after 80s the accuracy starts to vanish gradually this result brings a little contradiction with the previous simulation results for 8 level study two main reasons can explain the contradiction i as mentioned above short interval provides bad results for high level identification when these high levels are removed the accuracy of short interval will definitely increase ii short interval shows excellent sensitivity when dealing with short term sea state e g peak region s6 in contrast long interval like 400s in fig 18 cannot even recognize s6 which will degrade the accuracy significantly although short interval like 80s has great accuracy and sensitivity it should be noted that their stability is imperfect some state jumps exit where a stable output is expected such as 50s 80s 100s this problem may further cause too frequently switching of the controller while longer record interval can effectively solve this problem although they sacrifice some accuracy and sensitivity in this study 200s provides the best trade off among accuracy sensitivity and stability it can recognize the entire six levels with negligible unwanted jumps and acceptable accuracy the set of study verifies that the proper record interval should be tuned based on the specific environmental characteristics in different regions and the best trade off should be derived by field experiment 7 conclusion in this paper a novel sea state identification method for deepwater marine vessels is proposed this approach only takes advantage of four dofs of ship motion to realize accurate and rapid classification the measured signal is firstly processed through a preprocessing procedure and then decomposed by filter bank method hht and wavelet transform parallelly for feature extraction to eliminate the redundant features mrmr method is employed by maximizing the relevance between individual feature and the target output as well as minimizing the redundancy among selected features finally a three layer classification structure is developed with distinct classifiers in each layer the simulation results demonstrate the superiority of this multi layer structure over single layer ones in addition from the view of practical applications the most suitable record interval is retrieved and the distinct performance of different record intervals in real sea transition environment are investigated and discussed by case study acknowledgment the authors would like to thank the national research foundation keppel corporation and national university of singapore r 261 507 004 281 for supporting this work done in the keppel nus corporate laboratory the conclusions put forward reflect the views of the authors alone and not necessarily those of the institutions within the corporate laboratory 
23731,in order to extend the operational weather window for marine vessels under dynamic positioning dp control a novel sea state identification method with multi layer classifiers is proposed in this paper due to the distinction of system responses for various sea states four motion signals including surge sway roll and yaw are adopted for classification purpose firstly preprocessing techniques like filtration and k means clustering are performed to the raw data to filter out the corrupted low frequency lf information and generate the band pass filter bank then the processed data is decomposed into 20 categories via hilbert huang transform hht filter bank method and wavelet transform and 11 statistical features are extracted for each category subsequently max relevance min redundancy mrmr method helps to select salient features with best trade off between relevance and redundancy with these selected features a newly developed three layer classification structure with adaptive neuro fuzzy inference system anfis random forest rf and particle swarm optimization pso based combination classifiers is proposed to derive the current sea state the simulation results demonstrate that the proposed identification system can achieve satisfactory classification accuracy moreover the multi layer classifier outperforms single layer classifier and can rapidly classify the sea state in real time implementation keywords sea state identification feature extraction multi layer classifier marine vessel 1 introduction due to the increasingly serious global energy crisis during the past few decades people focused on offshore resources development say oil and gas while recently offshore operations have been moving towards more challenging environments such as ultra deep waters and arctic areas where richer resources are detected and to be mined however in deepwater environment the traditional mooring system is not so efficient hence there is a large demand to use the dp control system for a floating vessel dp system keeps a vessel in fixed position or following a predefined trajectory through the active thrusters nguyen et al 2007 so that a smooth and continuous offshore operation can be guaranteed the first dp system dates back to 1960s this control system used an siso pid controller to regulate the horizontal modes of motion sørensen 2011 in 1980 a kalman filter based optimal multi variable control was proposed to cope with the slow oscillating motion of vessels based on model adjustments and parameter tuning rules balchen et al 1980 a detailed mathematical model of vessel was required to optimally estimate the vessel motions and environmental forces in 1990s nonlinear controller such as fuzzy control and nonlinear feedback linearization based backstepping were designed in stephens et al 1995 godhavn et al 1998 and berin et al 2000 for dp system later sliding mode control in combination with an easy tuning methodology were proposed in tannuri et al 2010 to handle the variations in environmental and loading conditions however all these control theories consider only a limit of weather condition in lindegaard 2003 the author proposed an acceleration feedback using imu to improve the performance under severe sea conditions to ensure the vessel stability during the ocean condition transition from calm to extreme a supervisory switched control was designed in dong 2005 nguyen et al 2007 nguyen et al 2008 nguyen and sørensen 2009 hassani et al 2012a b this hybrid control strategy increased the operation window by making it possible to realize all year marine operations using the integration of a set of models and controllers these works identify the sea state by using spectral analysis of the position measurement which is completely model free and based on signal processing only in practical due to the randomness of the environmental forces this method which only depends on the recent collected data may easily lead to chattering or incorrect identification output the model based sea state identification works can be found in hassani et al 2012a b 2013 other sea state estimation researches are presented in bitner gregersen et al 2016 eckert gallup et al 2016 nielsen 2017 traditionally sea state can either be assessed by an experienced observer like a trained mariner or through instruments like weather buoys wave radar or remote sensing satellites calla 2011 these schemes depend heavily on extra instruments or sensors which makes the results either inaccurate or uneconomical in nguyen and quek 2010 the peak frequency of waves is estimated and the corresponding sea state is classified through the estimated peak frequency but this method has innegligible probability of wrong condition estimation which may lead to the failure of the switching system to address the above mentioned problems a novel sea state identification system is proposed in this paper to accurately identify the sea state with the mounted motion sensors that are originally used for dp control purpose the output of the proposed approach is the classified sea state levels calm smooth high which indicate the general condition of vessels in the ocean with respect to wind waves and swell at a certain location and moment a detailed elaboration can be found in section 2 this scheme utilizes the onboard motion sensors such as global positioning system gps hydro acoustic position reference hpr unit gyroscopes and motion reference unit mru nguyen and quek 2010 to collect the four degree of freedom dof motions surge sway roll and yaw of a vessel these four motions contain the response information of wave force excitation and dp control force moreover in order to reduce wear and tear on the thrusters dp control only considers the lf motion of a vessel liu et al 2008 therefore the high frequency hf wave induced motion is relatively pure and can reflect the response of the vessel against varying sea state to obtain the hf motion component a high pass filter with proper cut off frequency is required in the preprocessing stage prior to further analysis in this paper the dp system is assumed to adopt a passive filter and pid controller fossen and strand 1999 under the dp control the vessel is performing a very slow target following task with the velocity approximating to zero this scenario mimics the supply vessel serving a turret moored floating production storage and offloading fpso in deepsea operation the time and frequency domain statistical information of the measured motion data are analyzed by means of filter bank decompositions hilbert huang transform and wavelet transform these methods are capable to decompose the given sequence into different frequency intervals with distinct scales of resolution in this manner a thorough analysis on the signals can be conducted to avoid the curse of dimensionality mrmr method peng et al 2005 is applied to select the most relevant features as well as minimizing the mutual redundancy with the selected salient features a three layer classifier structure is developed using anfis rf and pso based classifier combination technique the proposed structure is able to upgrade the classification accuracy compared with a single layer structure the flow chart of the proposed system is depicted in fig 1 the innovations and contributions of this paper is three fold i for the first time accurate sea state identification is achieved only based on the ship motion response which makes it possible to reduce the instrument cost and shows great feasibility to implement ii since the proposed approach is model free and only copes with the pure hf motion response it can be widely used for different ship types under distinct control strategies iii the novelly proposed identification structure presents an all around time frequency domain analysis for the measured signals also the newly designed multi layer classifier achieves excellent performance in simulation study the organization of this paper is as follows section 2 briefly introduces the definition of sea state code and preliminary knowledge about wave spectrum section 3 presents the lf and hf model of the vessel as well as the filtering and control strategies preprocessing feature extraction and feature selection techniques are explicitly illustrated in section 4 details on the development of multi layer classifier are introduced in section 5 in section 6 numerical simulation study is conducted to demonstrate the efficacy of the proposed approach finally section 7 gives some concluding remarks 2 sea state descriptions in oceanography a sea state refers to the general condition of the vessels in the ocean with respect to wind waves and swell at a certain location and moment a sea state is characterized by statistics with the following parameters i significant wave height ii average wave frequency or average zero crossing wave frequency or peak frequency fossen 2011 to describe the sea state quantifiably sea state code is introduced as shown in table 1 price and bishop 1974 pfw is the abbreviation of peak frequency of the waves it should be mentioned that sea state definition is always with respect to a specific vessel the data in that table refers to a relatively large vessel the proposed approach is applicable to all types of vessel with specifically trained multi layer classifiers which will be introduced in following contents to study the wave energy distributed among different frequencies and wave heights the concept of wave spectrum is put forward there are many off the shelf spectrum such as modified pierson moskowitz mpm spectrum joint north sea wave project jonswap spectrum torsethaugen spectrum and etc these spectra describe the wave in terms of different generation ways fossen 2011 in this paper we consider the jonswap spectrum this spectrum is measured in the north sea between the island sylt in germany and iceland during year 1968 1969 it is applicable for most wind generated waves under the assumption of finite water depth and limited fetch the corresponding spectral density function sdf can be expressed as 1 s ω 155 h s 2 t 1 4 ω 5 e x p 944 t 1 4 ω 4 γ y j where 2 y j e x p 0 191 ω t 1 1 2 σ 2 σ 0 07 ω 5 24 t 1 0 09 ω 5 24 t 1 t 1 0 834 t 0 t 0 is the peak period and the peak enhancement factor γ equals 3 3 hasselmann et al 1973 which is a default value and can be replaced with other feasible values the plot of jonswap spectrum under different sea states is presented in fig 2 from the figure it can be observed that in frequency domain with the increment of sea state the dominant frequency decreases while the energy involved in the wave increase this characteristic brings possibility to identify the sea state from frequency perspective for analysis purpose the wave force acting on the vessel is usually separated into two categories i first order wave induced force ii second order wave induced force the former one refers to the zero mean wave frequency i e hf oscillatory force the latter one represents the nonzero slowly varying drift force fossen 2011 these two types of forces cause the hf and lf motion of the vessel respectively in practical dp implementation it is not energy efficient to also regulate the hf motion thus generally the hf component needs to be filtered out in advance which means this part is not corrupted by the control and is suitable as the raw data for classification remark it should be noted that when high or extreme sea happens it is not anymore possible to separate the lf and hf motion due to their big overlap if we still would like to apply control to the vessel under this situation the uncontrolled dofs such as heave can be used without filtration for the identification however usually the occurrence probability of these sea states is very low as table 1 presents in this work the hf motion of a supply vessel is generated using the mss toolbox fossen and perez 2004 and shown in fig 3 it can be seen that the time domain variation is also obvious enough to separate different sea state levels this paves way for hybrid time frequency domain analysis for sea state identification remark compared with practical system mss toolbox adopts an experientially simplified mathematical model for the dynamics and thruster motor system although the fidelity is reduced the produced data is still informative enough to depict the time and frequency domain properties of the vessel motion for theoretical performance verification 3 modelling and control of marine vessels in this paper a typical supply vessel is considered as the target ship due to the dynamic positioning system the vessel is performing very slow tracking task to achieve the tracking a commonly used passive filter with pid control is applied and depicted in this section 3 1 dynamic model the coordinate system for supply vessel can be found in fig 4 referring to fossen 2011 the north east down ned coordinate system is employed for the global frame o 0 x 0 y 0 z 0 with the origin fixed at a certain point on sea level the local frame of supply vessel o s x s y s z s is a moving coordinate system with its origin fixed at the midship point in the water line x s axis is the longitudinal axis which points to the fore of the ship y s is the transversal axis which directs to the starboard z s axis points to the center of the earth which is normal to the sea level by fossen 2011 a 6 dof lf dynamic model of the vessel is considered as follows 3 η j η ϕ η θ η ψ ν 4 m ν c ν ν d ν ν g η τ d where η η x η y η z η ϕ η θ η ψ t represents the earth fixed vessel position and orientation known as surge sway yaw roll pitch yaw ν u v w p q r t denotes the body fixed velocities of translation and rotation j η ϕ η θ η ψ r 6 6 is the rotation matrix m m r b m a r 6 6 denotes the inertia matrix which is the sum of rigid body inertia and added mass c ν c r b ν c a ν r 6 6 is the matrix of coriolis and centripetal d ν r 6 6 and g η r 6 1 are damping matrix and restoring force respectively τ r 6 1 describes the resultant control forces from the thrusters d r 6 1 denotes the external environmental forces and disturbance for dp implementation it is usually hard to control heave roll and pitch motion of a vessel thus a 3 dof model is usually considered when the filter and controller is developed 5 η j η ψ ν 6 m ν c ν ν d ν ν g η τ d where η η x η y η ψ t and ν u v r t other matrices are similar dynamic terms with those in 3 4 but in 3 dof more details about the model can be found in fossen 2011 3 2 linear approximation of hf motion for practical control system implementation and test a simple but effective way to represent the hf oscillation is required thus in year 1976 a linear approximation model is proposed to estimate the hf motion of a vessel in surge sway yaw by balchen et al 1976 the irrotational first order wave induced motion is defined as 7 ξ ξ i ξ i i o i ω 1 ω 2 ξ i ξ i i o ψ w ω w a ω θ ω ξ i ξ i i o ψ w ω w we define 8 a ω θ ω o i ω 1 ω 2 o i d i a g θ ω 1 d i a g θ ω 2 where ξ i ξ 1 ξ 2 ξ 3 t is an intermediate state of the wave motion model ξ i i ξ 4 ξ 5 ξ 6 t is the hf wave induced motion component ψ w r 3 3 and ω ω r 3 are wave intensity matrix and zero mean white noise vector respectively θ ω 1 ω o 1 2 ω o 2 2 ω o 3 2 θ ω2 2ζ o1 ω o1 2ζ o2 ω o2 2ζ o3 ω o3 describe the variation of wave condition and ω oi i 1 2 3 is the dominant frequency of wave induced motion ζ oi i 1 2 3 is the corresponding damping ratio combining the lf motion model 5 6 and the hf motion model 7 the measurement vector is derived as 9 y y x y y y ψ η x η y η ψ o i ξ i ξ i i η c ω ξ it should be noted that although the 3 dof model is considered in dp control system the proposed identification algorithm utilizes a fourth dof i e the roll motion the hf model for roll motion is very similar to that in 7 fossen 2011 since the roll motion is not affected by dp control the measured signal does not contain the lf component and can be imported to the identification system directly without high pass filtering in the preprocessing stage 3 3 filtering and control in order to reduce wear and tear on the thrusters due to the hf wave induced motion a low pass filter is usually developed to obtain the lf motion before control design a typical passive nonlinear filter is formulated as follows strand and fossen 1999 fossen and strand 1999 fossen 2011 10 ξ ˆ a ω θ ˆ ω ξ ˆ k 1 h y f 11 d ˆ t d 1 d ˆ k 3 y k 3 l x f 12 η ˆ j η ψ ν ˆ k 2 y k 2 l x f k 2 h y f 13 m ν ˆ c ν ˆ ν ˆ d ν ˆ ν ˆ g η τ d ˆ j t η ψ k 4 y k 4 l x f k 4 h y f 14 ŷ η ˆ c ω ξ ˆ where η ˆ ν ˆ and ξ ˆ are estimated lf positions and orientation velocities and wf model states respectively k 1 h r 6 3 k 2 k 2 l k 2 h k 4 k 4 l k 4 h r 3 3 are filter gain matrices x f r 3 and y f r 3 are the low pass and high pass filtered innovation signals t d r 3 3 is the matrix of bias time constants a nonlinear pid controller is used for performing the tracking task along the desired trajectory η d η x d η y d η ψ d t the control law can be written as strand and fossen 1999 15 τ m j t η ˆ ψ η ψ d k p e k d ė k i 0 t e d δ where e j t η ˆ ψ η η d r 3 denotes the tracking error of lf positions and orientation 4 preprocessing feature extraction and reduction the measured 4 dof signals surge sway roll and yaw are chosen as the raw input data of the sea state identification system it should be noted that this paper aims to develop a general framework for the sea state identification which can be applied to all the six dofs motion of the vessel besides the aforementioned four motions each data sequence contains 8 sea states state 0 2 are merged as one state with the sampling time of 1000s for each state the sampling rate is 1 hz the training set has 200 samples for each states which means there are in total 200 8 1 600 sequences for analysis and training firstly in preprocessing stage the corrupted lf component is filtered out moreover a bunch of band pass filters are generated using k means clustering for the next stage in feature extraction apart from time domain analysis three effective methods i e band pass filtration based fft hilbert huang transform and wavelet transform are employed for the frequency domain analysis to bloom the features subsequently mrmr helps to reduce the dimension of the features by selecting the most salient four ones the salient features construct the training and testing sets for classification in the final stage 4 1 preprocessing the overall preprocessing steps proposed in this paper is shown in fig 5 in this stage two tasks are expected to be completed i high pass filtration ii generation of band pass filter bank task ii whose steps are enclosed in the dash box aims to generate five band pass filters for the feature extraction stage the band pass frequencies of the filter bank should cover the whole frequency band of the collected data and the band pass frequency of each filter needs to be distributed rationally to achieve this the k means clustering algorithm is applied to the training data set to generate five clusters of frequency bands in this task all the sequences of 8 states are merged into one training sequence such that each new sequence contains 1 000 8 8 000 points in order to handle the time varying dominate frequency and bloom the samples for clustering framing and hamming windowing are introduced in this task before fft each step has its own function and mathematical expression as illustrated briefly in the following article step 1 high pass filter since dp control only considers lf motion of a vessel the hf motion is relatively pure and can reflect the sea state accurately therefore a high pass filter is required to remove the influence of lf motion and reserve the hf one hf motion usually has period less than 25s equivalent to 0 251 rad s or 0 04 hz joseph 2013 the cut off frequency is chosen as 0 23 rad s different from other steps in preprocessing stage which are only applicable for training data the high pass filter is necessary for both training and testing data set step 2 framing to derive adequate samples for k means clustering the collected motion sequence is segmented into small frames with 512 sampling points each two adjacent frames are overlapped by 100 points hence every signal sequence will generate 19 frames step 3 hamming windowing hamming window is used to minimizing the disruptions at the beginning and end of each frame gupta et al 2013 by multiplying the window function and the frame sequence the number of points in each frame n equals to 512 in this paper step 4 fast fourier transform fft fft is applied to convert each frame of n samples from time domain to frequency domain after conversion the dominant frequency of each frame is collected as the sampling set for k means clustering step 5 k means clustering the collection of dominate frequency value are assigned to 5 clusters to generate the filter bank using the k means algorithm the size of sampling set m is 19 200 3 800 for each dof the clustering results are shown in fig 6 4 2 feature extraction 4 2 1 signal statistical characteristics to extract features from both time and frequency signal sequence 11 statistical features are considered as shown in table 2 these features describe the investigated sequence in different aspects f 1 and f 3 f 5 reflect the amplitude and energy f 2 f 10 as well as f 6 f 7 present the distribution characteristics while f 8 f 9 and f 11 indicate the influence of impact or impulse input moreover normalization is significant to the convergence speed and the classification accuracy thus each feature should be mapped to the interval of 1 1 after generated however in practical implementation not all the 11 features are necessary to be calculated instead the salient ones for each signal sequence will be derived through feature selection algorithm the details are going to be introduced after the feature extraction section 4 2 2 feature extraction with filter bank different sea states are discriminative by various dominant frequency to study the characteristics on each frequency band separately would contribute a lot to the accuracy of classification in this work the signals are subjected to five band pass bp1 bp5 filters to generate the filtered sequence for feature extraction the band pass frequencies of the filter bank are determined in preprocessing stage and the result is presented in table 3 there frequencies are chosen to cover the signal components containing the majority of hf motion energy with proper frequency intervals after filtration the 11 features shown in table 2 are extracted from the filtered signals in time domain hence there are in total 11 5 55 time domain features for each dof to eliminate the effect of hf non stationary noise and uncertainties caused by the data collection process the filtered signal should be demodulated before frequency domain analysis is conducted in this work hilbert envelope spectrum is proposed to attenuate the disturbance firstly the filtered signal x t is subjected to hilbert transform makwana et al 2012 16 h x t 1 π x t t τ d τ the analytical signal of x t is 17 z t x t i h x t a t e x p i θ t where a t x 2 t h 2 x t θ t atctan h x t x t secondly the hilbert envelope spectrum can be derived by 18 h f a t e j 2 π f t ⅆ t the obtained spectrum is further processed to produce another 11 5 55 features in frequency domain for each dof therefore 110 features are generated for each dof after filter bank process 4 2 3 hilbert huang transform hht is developed to decompose a time domain sequence into its individual characteristic oscillation sub components using empirical mode decomposition emd schlurmann 2001 the embedded characteristic oscillation is represented in the form of intrinsic mode function imf in other words the complicated original signal is decomposed into a bunch of complete and orthogonal imfs the procedure that emd conducts to search imfs are introduced in algorithm 1 the first two imfs that contain the most characteristic of the signal are selected to derive the features similar to the last subsection the hilbert transform is employed to each of the disintegrated imf subsequently the instantaneous frequency can be calculated with the following equation ville et al 1948 image 1 19 f t 1 2 π d θ t d t the hht brings us another 11 2 22 features for each dof 4 2 4 wavelet transform different from fourier transform wavelet transform is believed to have strong capability to analyze a signal through correlation with translation and dilatation of a short duration mother wavelet ψ mentouri et al 2013 this enables wavelet transform to analyze a signal with multi scales both in time and frequency domain qin et al 2015 in this paper the sampling rate is 1 hz and referring to table 1 the dominant frequency of the hf motion is in the range from 0 04 0 25 hz therefore we choose the decomposition level to be five the frequency range of the five levels can be found in fig 7 by trial and error the daubechies wavelet of order 1 db1 is selected as the basis function four approximation components a 1 a 4 and three detail components d 3 d 5 are chosen to exact the features which gives 11 7 77 features for each dof 4 2 5 max relevance min redundancy for dimension reduction according to above discussion and table 4 where td and fd denote the abbreviation of time domain and frequency domain respectively there are as many as 220 features for one dof although these features are all applicable to identify the sea states from different aspects they are discriminative in relevance some features are salient while others are not therefore to improve the identification performance and reduce training and testing cost the non significant features must be abandoned to achieve this mrmr method is applied to rank the features based on the relevance to target variables and mutual redundancy cai et al 2012 mrmr method believes that good features can provide the best trade off between maximum relevance d to the target variable and the minimum redundancy r concretely mrmr aims to optimize d and r simultaneously as follow 20 max d r in practical implementation incremental search is applied to solve the optimization problem apart from the above mentioned d r pattern d r is also an effective method to search the solutions in this work d r pattern is adopted and the 11 statistical features f 1 f 11 are sorted for each feature category of the four dof a representative result in surge direction is presented in fig 8 this result shows the mrmr values of the sorted 11 features in saliency decreasing order as can be seen from the figure the first feature usually has a very high mrmr value denoted as v mrmr 1 due to the absence of redundancy criterion and generally the features with lower priority would have smaller mrmr values to determine the number of salient feature that we needed for training the following criterion is proposed the first n features are selected as the salient feature if the n 1 th feature has a mrmr value smaller than σ v mrmr 1 σ is a scalar and in this paper by balancing the classification accuracy and the identification speed this parameter is tuned as 20 the excellent classification performance with this parameter is demonstrated in the simulation section moreover for the ease of classifier design an average number of salient feature is calculated for all the categories with above criterion and the result is 4 in this way the total features for each dof are reduced to 4 20 80 the selection results for each feature category are shown in the simulation section 5 multi layer classifier the classifier for sea state identification is introduced in this section to guarantee the classification accuracy a three level classifier structure is proposed firstly 20 anfis classifiers are designed for each category in every dof secondly four random forest rf classifiers are involved to derive the identification results for the four dof the training set of the rf classifier is constructed with the output of anfis classifiers finally the outcome of the four dof are combined through a weighted averaging technique with bias compensation to determine the weights and bias efficiently pso approach is applied to search the solution iteratively moreover two auxiliary combination rules are also taken into consideration to avoid the effect of dominant elements 5 1 design of anfis classifier anfis is firstly introduced by jang 1993 with the capability of universal approximation combined with the sugeno approach anfis is later widely used to predict the output from input variables it integrates the back propagation and least squares estimation lse to identify the structure and learn the fuzzy rules of the takagi sugeno ts system automatically a simple but typical first order sugeno type model has the following expression 21 i f x i s a a n d y i s b t h e n z a x b y c where x and y are the two inputs and z represents the system output a and b denote the linguistic labels in this paper they can be different sea state codes a b c are the consequent part parameters a typical first order anfis structure with two input variables can be found in fig 9 as shown in the figure the structure contains five layers and each of the layer has the function of i system fuzzification ii firing strength calculation iii firing strength normalization iv system defuzzification and v overall output a 1 a 2 b 1 b 2 stands for the membership functions mf both the shape and the premise parameters inside the mfs need to be chosen according to the system specifics in this paper 20 anfis are employed for the 20 categories of each dof each anfis has four inputs corresponding to the four salient features and one output representing the identified sea state code hence by the end of the first classification 20 sea state levels outputs are prepared as the input new features of next layer classifiers for each dof by trial and error the number of mf is selected to be 4 and the shape is bell shape the maximum training epoch number is 200 and training error is set as zero the initial step size step size decrease and increase rate are chosen as 0 01 0 9 and 1 1 respectively the classification results for this layer are elaborated in the simulation section 5 2 random forest classifier design random forest ho 1998 has been proven to be effective in handling large training set as mentioned in the last section the number of input to the rf classifiers can be as many as 20 anfis classifier would take a long time for training due to its complex structure in the contrary because of the random space method not all the features are going to be used in a single candidate split in this manner not only the correlation among decision trees can be avoided but the training speed is improved in this paper four rf classifiers are designed for each dof with the input of 20 features each feature denotes one identified sea state obtained from anfis classifier the number of decision tree in each classifier is chosen to be 300 this layer will generate four identification results for the final layer to process 5 3 pso based multi classifier combination in the second layer four identification results are derived from hf oscillation data in surge sway roll and yaw this subsection intends to calculate the final identification result with these four inputs different from traditional linear weighted averaging technique lei et al 2007 in this work a bias compensating weighted averaging method is applied the final classification result is derived with the following combination 22 z r o u n d k 1 4 w k y k b w k b 0 where z y k are the final output and intermediate output of rf classifiers respectively round rounds the nearest integer of w k denote the weights associated with four rf classifiers b represents the bias the novelly added bias can compensate for the linear combination of the voting in this manner the classification accuracy can be improved pso is used to estimate the weights and the bias iteratively the fitness function can be defined using root mean square rms as 23 j 1 1 e e 1 n n 1 n c n z n 2 where c n is the target output n is the number of the training samples by trial and error the population size is chosen to be 300 the maximum and minimum inertia weights are 0 9 and 0 4 respectively the maximum number of iteration is selected as 300 moreover it should be noted that the performance of the mentioned combination method can be degraded dramatically due to some dominant features the weights corresponding to these features are usually very large so that the final result is easily manipulated by the dominant features to counterbalance this problem two additional rules with the highest priority are involved they are summarized as follows the output z n is set to be the majority votes if three out of the four inputs share the same sea state the output z n is set to be the majority votes if two out of the four inputs share the same sea state and the minority two votes are different with the above two auxiliary rules the accuracy of classification can be improved obviously as illustrated in the simulation section 6 simulation study in this section a supply model is used for case study during the simulation some components of the proposed algorithm are verify and the proposed method performance is demonstrated via both static and dynamic study the geometric and dynamic parameters are referred to nguyen et al 2007 the mss toolbox is employed for the generation of data sequence under jonswap spectrum the mean wave attack direction with respect to the bow of the vessel is set as 135 deg bow sea the vessel performs slow tracking motion under the dp system as mentioned in section 4 eight states data are generated with sampling rate of 1 hz each sample includes collected oscillation data for 1000s and each state contains 300 samples among the 300 samples 200 samples are selected as training set and the remaining 100 is testing set thus we have in total 200 8 1 600 sequences for training and 100 8 800 sequences for testing after preprocessing and feature extraction the feature selection algorithm mrmr is then performed for each category the results are shown in table 5 the corresponding histogram in fig 10 shows the number of times that a single feature is called as a salient feature the results reveal that the salient features are exclusively distributed in f 1 f 7 by recalling the representation of each features it can be observed that energy and distribution characteristics are two main factors to describe different sea states this coincides with the property of jonswap spectrum shown in fig 2 moreover f 2 f 4 f 3 and f 5 are the four most salient features that can best present the diversity of various sea states they corresponds to the variance root mean square square root of amplitude and maximum of the data sequence the selected salient features are then applied to train the anfis classifiers 800 out of the 1 600 training samples are put in the training set and the remaining 800 samples construct the intermediate testing set 20 classifiers for each dof are trained and they are denoted as ctd c t d b p 1 c t d b p 5 c f d b p 1 c f d b p 5 c h h t 1 c h h t 2 and c w a v l e t 1 c w a v l e t 7 respectively after training the intermediate testing sets are imported to generate the training set for the second layer classification classifiers in the second layer is named as crfsur crfswa crfroll and crfyaw these four classifiers correspond to the four dof respectively combining training and intermediate testing set in total 1 600 samples outcome from anfis classifiers are imported to one rf classifier and the output is treated as the training input of the final layer classifier the training strategy can be summarized in fig 11 after pso optimization the weights and the bias are solved as 0 386 0 0 0 644 t and 0 027 the classification accuracy of each layer is shown in table 6 and fig 12 for concise illustration the 20 classifiers are categorized into 5 classes the ctd bp describes the average classification accuracy of ctd bp 1 ctd bp 5 the same situation holds for cfd bp chht and cwavlet avglyr1 and avglyr2 are the average accuracy of first layer classifiers and the second layer classifiers chybrid is the overall accuracy as can be observed in the results the accuracy upgrades with the increasing of layers among the first layer time domain analysis performs best however time domain analysis alone can only achieve an accuracy of 95 19 for testing set with the frequency domain analysis the accuracy goes up to over 99 in the second layer after the three layer classification almost all the samples can be classified successfully 99 88 moreover the values of weight in the last layer reveal the dominant role of surge and yaw motion for the final identification result due to their perfect performance in the training phase this phenomenon means the final result is heavily manipulated by these two dof and vulnerable to their incorrect results this drawback demonstrates the necessity of the two additional rules in section 5 to numerically prove the efficacy of the two auxiliary rules experiment in the absence of the rules are conducted the classification accuracy goes down to 99 63 this result verifies the effectiveness of the additional rules since we hope to utilize the sea state identification system for real time control system the identification speed is of great significance the candidate sequence for the above system contains 1 000 points i e it costs 1000s to construct an available candidate sequence in the following study a proper number of necessary points in one sequence is going to be researched the number of points is named as record interval the test sequence is cascaded with 8 classes each class contains 2000s as shown in fig 13 and the proposed identification system is applied slidingly on the measured data set with different record intervals in this paper 10 candidate record intervals are investigated which are 50s 100s 150s 200s 300s 400s 500s 700s 850s and 1000s the classification interval is 4s activate the identification system every 4 s the simulation result of different record intervals are presented in fig 14 the results reveal that the selected 10 record intervals are all able to classify the testing sequence roughly however the longer the record intervals are the more stable the output becomes this is reasonable because longer record interval bring more solid and adequate information about the current sea state so that the classification accuracy increases but longer record interval causes obvious identification delay at the sea state transition point in practical control system implementation this delay leads to the postponement of switching signal in the controller which may further contribute to the arising of control error the quantitative analysis outcome is presented in table 7 and fig 15 the classification accuracy and the identification time of the 10 candidate record intervals are compared in this study the identification time is defined as the average duration that the classification system can give an accurate output after sea state transition by saying accurate we mean the moment when the following 20 successive outputs i e 20 4 80s give the correct classification results for 50s and 100s this moment does not always exits thus the identification time for these two candidates remind blank it can be observed from the results that the accuracy increases at first and decreases after the peak of candidate 300s the identification time also shows similar trend but in the opposite way hence obviously the best record interval should be 300s in this study extendedly the range from 200s to 400s are also acceptable by further investigation we observe that short record interval has unsatisfactory performance for high state identification obvious identification error can be seen especially for level 7 and level 8 this is because higher state level causes longer wave length period of oscillation short record interval can only capture limited number of cycle also due to the randomness of the hf motion it is very likely that the collected data shows similar statistical characteristics with that in low level states e g smaller amplitude the above reasons explain the unfavorable performance of short record interval when dealing with high sea state levels however recalling the possibility percentage of individual sea state in table 1 we can see that not all the states evenly occur moderate and slight sea states are the most common ones and the high or extreme sea states are unusual this motivates us to study the response of the identification system and the record interval under reasonably distributed sea states for the purpose of study a new data sequence with corresponding sea condition occupance percentage is generated for instance the preprocessed data in surge direction is shown as fig 16 a the simulation time is 6 h which means we collect 21 600 points for this study there are in total 11 phases in this study describing the rise and vanishment of the sea states the points that each phase contains are 1211 4326 3627 1135 307 225 347 1630 5054 2 519 and 1 219 the classification interval is still 4s the standard output is presented in fig 16 b 14 candidate intervals are studied in this section they are 20s 50s 65s 80s 90s 100s 150s 180s 200s 250s 280s 300s 350s and 400s the accuracy rate and the corresponding curve are depicted in table 8 ri stands for record interval and fig 17 some representative results are shown in fig 18 from the accuracy curve we can see that the accuracy peak forms at around 80s after 80s the accuracy starts to vanish gradually this result brings a little contradiction with the previous simulation results for 8 level study two main reasons can explain the contradiction i as mentioned above short interval provides bad results for high level identification when these high levels are removed the accuracy of short interval will definitely increase ii short interval shows excellent sensitivity when dealing with short term sea state e g peak region s6 in contrast long interval like 400s in fig 18 cannot even recognize s6 which will degrade the accuracy significantly although short interval like 80s has great accuracy and sensitivity it should be noted that their stability is imperfect some state jumps exit where a stable output is expected such as 50s 80s 100s this problem may further cause too frequently switching of the controller while longer record interval can effectively solve this problem although they sacrifice some accuracy and sensitivity in this study 200s provides the best trade off among accuracy sensitivity and stability it can recognize the entire six levels with negligible unwanted jumps and acceptable accuracy the set of study verifies that the proper record interval should be tuned based on the specific environmental characteristics in different regions and the best trade off should be derived by field experiment 7 conclusion in this paper a novel sea state identification method for deepwater marine vessels is proposed this approach only takes advantage of four dofs of ship motion to realize accurate and rapid classification the measured signal is firstly processed through a preprocessing procedure and then decomposed by filter bank method hht and wavelet transform parallelly for feature extraction to eliminate the redundant features mrmr method is employed by maximizing the relevance between individual feature and the target output as well as minimizing the redundancy among selected features finally a three layer classification structure is developed with distinct classifiers in each layer the simulation results demonstrate the superiority of this multi layer structure over single layer ones in addition from the view of practical applications the most suitable record interval is retrieved and the distinct performance of different record intervals in real sea transition environment are investigated and discussed by case study acknowledgment the authors would like to thank the national research foundation keppel corporation and national university of singapore r 261 507 004 281 for supporting this work done in the keppel nus corporate laboratory the conclusions put forward reflect the views of the authors alone and not necessarily those of the institutions within the corporate laboratory 
23732,the singapore strait plays a vital role for the international freight transportation including containers bulk cargo and crude oil in view of the importance of singapore strait it is of practical significance to investigate the ship traffic s speed density relationship called the fundamental diagram in the strait which can be used to estimate the theoretical strait capacity despite the availability of large empirical ship traffic data and the long history of traffic flow modeling the analysis of ship traffic fundamental diagram for the singapore strait is still highly deficient to fill in the gap we first develop a research framework to address the big ais automatic identification system data for the ship traffic fundamental diagram building to ensure the correctness of ais data a tangible error elimination method is presented moreover a novel weighted least square approach is applied to develop the ship traffic speed density formulations accurately meanwhile we also show the applicability of the weighted least square approach by a theoretical investigation into the difference between the weighted and non weighted least square approaches finally we study all the fifteen legs in the singapore strait and propose 75 fundamental diagrams based on four classic traffic flow models through mining more than 43 million pieces of ais data these fundamental diagrams also indicate the theoretical capacity of each leg in the singapore strait keywords singapore strait strait capacity ship traffic speed density fundamental diagram big ais data weighted least square approach 1 introduction the singapore strait is a 105 km long and 16 km wide waterway between the strait of malacca in the west and the south china sea in the east and it is one of the most important and busiest shipping waterways in the world in terms of usage by commercial vessels and surface naval forces which experienced a 29 3 percent increase in ship traffic from 2005 to 2015 the singapore strait also plays a vital role in the international freight transportation including containers bulk cargo and crude oil qu and meng 2012 meng et al 2017 in 2016 the straits of singapore and malacca promoted singapore to be one of the world s top three export crude oil refining centers the world s third largest oil and oil products trading hub as well as the world s second largest container port in terms of container throughput in view of the importance of singapore strait it is of practical significance to investigate the speed density relationship called the fundamental diagram showing the relationship between ship speed and ship density for ship traffic in the strait because the relationship can exhibit its theoretical capacity the automatic identification system ais is primarily and foremost a navigation tool for ship collision avoidance mou et al 2010 weng et al 2012 zhang et al 2015 2016a for example xiao et al 2015 presented an ais data analysis to deepen the understanding about the ship traffic safety in the waterways wu et al 2016 investigated the waterway transportation features from a macro level by using the aggregate ais data moreover according to the regulations proposed by international maritime organization 1 1 website of regulations http www imo org en ourwork safety navigation pages ais aspx all ships of 300 gross tonnage and upwards engaged on international voyages cargo ships of 500 gross tonnage and upwards not engaged on international voyages and all passenger ships irrespective of size are required to install the ais that can automatically identify the dynamic location sailing speed and other messages of a ship referred to as the ais messages and transit these messages to the nearby ais base stations in a time interval of 10 s approximately these dynamic and frequent ais messages promptly form the ais data to be the big data for example there are more than 43 million pieces of ship ais data in the singapore strait in one week note that these ais data record the ship navigation information in this restricted strait our preliminary observations of the ais data indicate that ships navigating in the singapore strait follow a clear speed density relation namely ship following phenomenon in addition to this phenomenon a series of maritime simulator based experiments in the singapore strait were performed by eight captains of more than ten years of sailing experience similar ship following phenomenon was observed in the simulated experiments under various scenarios different speed density cases therefore this study aims to build the fundamental diagram of ship traffic in the singapore strait by using the big ais data to further enrich the ship traffic flow studies 1 1 relevant studies for the road traffic daganzo and geroliminis 2008 showed that a fundamental diagram relating average flow and density must exist on any street with blocks of diverse widths and lengths but no turns the fundamental diagram speed density relationship has been considered as the foundation of traffic flow theory e g qu et al 2015 with traffic fundamental diagrams decision makers and researchers can study traffic flow phenomenon predict system utilization and congestion and devise strategies to improve traffic conditions there is a wealth of literature on the speed density relationships for road traffic including microscopic and macroscopic models each of which characterizes a simple yet efficient traffic flow fundamental diagram e g greenberg 1959 newell 1961 underwood 1961 pipes 1967 kerner and konhäuser 1994 li and zhang 2001 macnicholas 2008 chiabaut et al 2009 ji et al 2010 wang et al 2011 2013 wu and liu 2011 ni and wang 2013 and ni et al 2016 the main contributions of these studies have focused on developing accurate single regime and multiple regime models with a number of practically meaningful parameters that need to be calibrated to calibrate the fundamental diagram the least square approach has been applied widely which is a standard approach in regression analysis to the approximate solution of over determined systems legendre 1805 after this seminal work several variations with algebraic procedures for fitting linear non linear equations to data in engineering have been addressed for example sun et al 2003 applied a proposal local linear regression model to short term traffic prediction indicating that the local linear method consistently showed better performance than the k nearest neighbor and kernel smoothing methods meng and qu 2013 found that the bus dwell time at a bus bay possessed a high degree of uncertainty originating from the merging behavior of bus to the vehicles in the shoulder lane thus they formulated the bus dwell time at a bus bay based on a conventional regression method however the least square approach could not fit the empirical data consistently well in light traffic and congested conditions more specifically when a problem has substantial uncertainties in independent variables the least square approach has some problems in such a case the methodology required for fitting errors in variables models may be considered instead of that for the least square approach existing studies indicate that an improved weighted least square approach could largely address the sample selection bias issue aitken 1935 indeed observations may not be equally reliable in other words the observations should be weighted in some cases qu et al 2015 showed that the inaccuracy of single region models was not caused solely by the functional forms but also by the sample selection bias thus they designed an effective weighted square method on the fundamental diagram calibration for freeway traffic demonstrating that the weighted square method could represent all traffic states with high accuracy recently it has been found empirically that the traffic speed and density are related by a unique and reproducible curve the fundamental curve and optimal control methodologies such as perimeter hierarchical control and boundary flow control strategies have been used to consider network heterogeneity and cooperative traffic control see mahmassani et al 2013 leclercq et al 2015 to the best of our knowledge there are fewer studies on the fundamental diagram for ship traffic with the development of ais technique millions of pieces of ship navigation information can be used for research purpose to begin filling in this gap this study makes the first attempt to investigate the speed density relationship for ship traffic in straits by using the big ais data as well as a novel weighted least square approach 1 2 objective and contributions there are some interesting approaches proposed to estimate traffic capacity or efficiency in maritime fujii and tanaka 1971 brilon and miltner 2005 zhang et al 2016c olba et al 2017 for example liu et al 2016 developed dynamic ship domain models for estimating the capacity of restricted water channels zhang et al 2016b studied the correlation between freeway traffic and ferry traffic and proposed a modelling methodology for predicting ferry traffic in both the time and frequency domain however note that the speed density fundamental diagram can study ship traffic flow phenomenon predict strait capacity utilization and congestion and devise strategies to improve ship traffic conditions therefore it is no exaggeration to say the importance of ship speed density relationship in theoretical research and practice despite the availability of large empirical ship traffic data and the long history of road traffic flow modeling the ship traffic fundamental diagrams for the restricted waters such as the singapore strait is still highly deficient hence this study aims to develop the proper ship fundamental diagrams to formulate relationships between speed and density in different ship traffic states the main contributions of this study have threefold first a tangible research framework to address the big ais data for the ship traffic fundamental diagram building is proposed we find ship speed generally decreases with the increase of ship density in the singapore strait through mining more than 43 million pieces of ais data this finding drives us to adopt four classic traffic flow models to reveal ship speed density relationships in the strait second the four classic traffic flow models for the fifteen legs in the singapore strait are estimated by the weighted and non weighted least square approaches respectively meanwhile a theoretical investigation is conducted to show the difference between the weighted and non weighted least square approaches third the theoretical ship traffic capacity for each leg in the singapore strait is estimated which is presented by two modus standardized ships and general ships including ship length and ship type the remainder of this paper is organized as follows in section 2 we formally describe the research methodology including error elimination method for the big ais data ship harmonic mean speed and density calculation speed density function estimation and a general weight determination method for the weighted least square approach the fundamental diagrams for the overall fifteen legs in singapore strait are calibrated in section 3 conclusions and future studies are presented in section 4 2 research methodology the singapore strait providing the shortest sea route between the indian ocean via the andaman sea and the pacific ocean via the south china sea consists of fifteen legs shown in fig 1 among these legs legs w1 w7 direct from east to west and legs e8 e15 direct from west to east sigtto 2008 for more information such as leg length leg width and leg turning interested readers refer to http www shipfinder com for the sake of presentation all these legs are grouped into a set s namely 1 s s s w 1 w 2 w 7 e 8 e 9 e 15 to identify the fundamental diagram of ship traffic for each leg in the singapore strait the ais data over the strait in one week of october 2013 october 1st to october 7th was collected via the official channel including more than 43 million records note that environmental conditions such as the historical weather and wind for the period are referred to the website https www wunderground com history to make use of the ais data a research framework with three phases is proposed shown in fig 2 phase 1 aims to eliminate the noises or errors for the raw ais data and the purpose of phase 2 is to calculate the ship harmonic mean speed and ship density for each of the fifteen legs in the singapore strait by using the ais data processed in phase 1 in phase 3 a tangible weighted least square approach is applied to propose the ship speed density relationship for each leg then the fundamental diagram of ship traffic for each leg in the singapore strait is identified via existing well recognized speed density models 2 1 error elimination method for the raw big ais data a complete record of the ais data at least includes the following messages ship id position longitude and latitude course speed heading vessel type time drought navigation status dimension of bow dimension of stern dimension of port and dimension of starboard shu et al 2017 however the following five ais messages related to each ship ship id longitude latitude ship speed and time are sufficient for this study to reveal speed density relationships and develop ship fundamental diagrams these five ais messages may include some unavoidable errors noises due to the ais data transmission such as field loss and or data reading errors for example according to the statistics of the ais data over singapore strait in one week of october 2013 the resolution of the raw ais data the number of data after screening dividing the number of raw data is 91 07 approximately to remove as many errors in ais data as possible a tangible error elimination method is presented below for the sake of presentation the detailed description of error elimination method of steps 1 2 and 3 can be found in appendix a ais data error elimination method image 1 note that it may take different times to clear out data errors by using different searching methods an effective searching method is quite appreciated when dealing with the big ais data fig 3 shows two algorithmic schemes to implement the proposed ais data error elimination method fig 3 a is the vertical searching method that checks data column by column that is it first screens the ship id data and updates the matrix then the vertical method goes to screen and update the longitude latitude and speed data one column after another by contrary the horizontal searching method in fig 3 b screens the data row by row for each row the entire messages will be deleted as long as there is an error in ship id longitude latitude or speed the following proposition compares the computational performance of the vertical and horizontal searching methods proposition 1 if n 4 3 n u m 1 n u m 2 2 3 n u m 3 holds then the vertical searching method a outperforms the horizontal searching method b in terms of cpu running time measured by the big o notation otherwise horizontal b outperforms vertical a here n u m 1 n u m 2 n u m 3 denotes the number of ship ids updated after the first second third round of screening in the vertical searching method a the time complexity of the vertical searching method a is 2 o a o n n u m 1 n u m 2 n u m 3 o 4 n and the time complexity of horizontal searching method b is 3 o b o n 3 n u m 1 n 2 n u m 2 n n u m 3 n o 4 n based on the order of magnitude both searching methods are in high efficiency assuming that o a o b we have 4 o n n u m 1 n u m 2 n u m 3 o n 3 n u m 1 n 2 n u m 2 n n u m 3 n that is 5 n 4 3 n u m 1 n u m 2 2 3 n u m 3 therefore if n 4 3 n u m 1 n u m 2 2 3 n u m 3 the horizontal searching method b is better than the vertical searing method a in terms of cpu running time measured by big o notation otherwise the vertical searching method a outperforms the horizontal searching method b we used the raw ais data 8 00 9 00 on october 1st 2013 in the singapore strait to assess the efficiency of the vertical searching method a and horizontal searching method b it took 28 min approximately to screen about one million pieces of data by the vertical searching method a in a personal computer desktop workstation with 2 processors of 40 2 5 ghz cpu and 32 gb of ram however the horizontal searching method b spent more than 45 min under the same computational environment in addition we randomly selected another sheet of raw data on october 3rd 2013 to test similarly the vertical searching method a is in higher efficiency than the horizontal searching method b therefore we deduce that the vertical searching method a could show its advantage in reducing cpu time when addressing the big ais data from the singapore strait 2 2 ship harmonic mean speed and ship density in 1952 wardrop 1952 showed the difference between the space mean speed and the time mean speed in road traffic flow theory as time goes by researchers have tended towards calculating time mean speed instead of space mean speed with the development of double loop detectors soriguera and robusté 2011 in this study the ais data are separated by time intervals transmitted from the ais base stations and the harmonic mean speed is calculated in terms of time mean speed thus we select harmonic mean speed here however it should be pointed out that the space mean speed is also applicable with the checked ais data we first calculate the harmonic mean speed of ship traffic at observation j 1 ζ s in a particular leg s s denoted as v j s by 6 v j s n j s i d 1 n j s 1 v ˆ i d j s s s j 1 ζ s where v ˆ i d j s is the instantaneous sailing speed of ship i d at observation j in leg s and n j s is the total number of ships at observation j in leg s wardrop 1952 note that this harmonic mean speed v j s has a fixed relationship with the space mean speed v j s under a given set of observations let us compare them by three formulas in 7 8 and 9 as observed v j s v j s is a constant because each v ˆ i d j s i d 1 2 n j s is fixed according to the ais data therefore the numerical relationship between v j s and v j s is linear 7 v j s n j s 1 v ˆ 1 j s 1 v ˆ 2 j s 1 v ˆ n j s j s s s j 1 ζ s 8 v j s v ˆ 1 j s v ˆ 2 j s v ˆ n j s j s n j s s s j 1 ζ s 9 v j s v j s v ˆ 1 j s v ˆ 2 j s v ˆ n j s j s 1 v ˆ 1 j s 1 v ˆ 2 j s 1 v ˆ n j s j s s s j 1 ζ s in addition the ship density at time j 0 ζ s in a particular leg s s denoted as k j s is accordingly calculated by 10 k j s n j s l s s s j 0 ζ s where l s is the length of leg s greenberg 1959 note that densities ships per nautical mile are rounded to three decimal points in this study when the values are floats moreover we assume the width of a leg is fixed so that the shape of a leg can be considered as a rectangle in this case the unit of fundamental diagram holds under the consideration of ship density ships nm ship speed knot nm hr and ship flow ships hr in a given leg s s the ship harmonic speed v j s and ship density k j s are aggregated according to observations thus we have a large number of observations j 1 2 ζ s of speeds and densities for each leg s 11 j 1 ζ s v j s v 1 s v j s v ζ s s s s 12 j 1 ζ s k j s k 1 s k j s k ζ s s s s 2 3 speed density function estimation after the preliminary analysis on the ais data we found that ship speed decreases with the increase of ship density such a speed density relationship for ships in maritime transport has not been addressed using the big real data in literature therefore we apply the classic traffic flow theory to ship traffic aiming to quantitatively reveal the ship speed density relationship in the singapore strait 2 3 1 speed density relationships the relationship between ship sailing speed and ship density in leg s s denoted by v s and k s can be formulated by a generic function 13 v s g k s β s s where g k s β represents the function of ship density with the vector of parameters β that can be estimated using the ais data there are many models to formulate speed density relationships in this study we adopt four well recognized models in road traffic engineering shown in table 1 greenshields stream model greenshields et al 1935 greenberg s logarithmic model greenberg 1959 underwood s exponential model underwood 1961 and pipes generalized model pipes 1967 this is because these four models are representative by covering linear logarithm exponential and power patterns note that the four recognized models are transformed into linear functions in the last column of table 1 which can then be accurately and easily regressed by the least square approach the least square approach is a typical method to estimate the vector of parameters β by solving the minimization problem 14 min j 1 ζ s v j s g k j s β 2 s s which has been widely adopted for regression models such as sun et al 2003 in vehicle traffic forecasting meng and qu 2013 in bus dwell time estimation and qu et al 2015 in calibrating fundamental diagrams for freeway traffic however the squared error for each observation is added directly in the objective function to be minimized by using eq 14 to fit the speed density diagram consequently if a large proportion of observations are around a fixed interval density which is the case for the ais data in singapore strait 74 94 observations are in the ellipse area in fig 4 then the values of parameters β will be biased toward the area near the particular density we use the four well known models in table 1 and the ais data to calibrate the vector of parameters β the results indicate that the four regression models have a poor performance at light traffic or high traffic conditions because of the high proportion of observations at medium traffic conditions however accurate fitting in high traffic conditions is particularly important because we may forecast the capacity of a leg in a strait according to high traffic conditions 2 3 2 general weight determination method the deficiency of the least square approach caused by sample selection bias issue could be addressed by the weighted least square approach first proposed by aitken 1935 to calibrate the ship speed density model more accurately at light traffic and high traffic conditions we minimize the sum of weighted squared errors mathematically 15 min e i 1 u j 1 u ˆ i ω i j s v i j s f k i j s β 2 s s where v i j s represents the ship speed of the j t h observation under density index i in leg s s f k i j s β shows the fitting curve function with an independent density variable k i j s ship density of j t h observation of index i in leg s and ω i j s denotes the weight of j t h observation of index i in leg s if a particular traffic state is overrepresented a lower weight should be set to the corresponding observations to guarantee that the state would not dominate the estimation results therefore the following weight determination function is proposed 16 ω i j s k i j s 2 j 1 u ˆ i k i j s i 1 j 1 2 u ˆ i k i j s k i 1 1 s k i j s j 1 u ˆ i k i j s i 2 n j 1 2 u ˆ i s s where u ˆ i represents the total number of densities with the same density index i to validate the weights for observations we design the following general weight determination method comprising three steps general weight determination method step 1 initial ranking rank and update the observations based on densities k j s in leg s as the following sequence 17 v j s k j s j 1 2 ζ s v 1 s k 1 s v 2 s k 2 s v j s k j s v m s k m s where k 1 s k 2 s k j s k m s and the total number of elements in density set k j s of leg s is ζ s step 2 density merging check the values of k j s above merge and change indexes j according to densities those who have the same density will have the same subscript i and different subscript r we thus have another sequence 18 v 1 1 s k 1 1 s v 1 2 s k 1 2 s v i 1 s k i 1 s v i r s k i r s v i u ˆ i s k i u ˆ i s v n 1 s k n 1 s v n u ˆ n s k n u ˆ n s 19 where k 1 1 s k 1 2 s k i 1 s k i r s k i u ˆ i s k n 1 s k n u ˆ n s and 20 i 1 n u ˆ i m from eq 17 to eq 18 speed and density values are the same with their subscripts changed for example v j s k j s v i r s k i r s means that the original density k j s is the i t h largest value in leg s observed and the number of densities equaling k j s is r step 3 weight calculation for i in 1 2 n and for r in 1 2 u ˆ i calculate weight coefficients iteratively if i 1 according to eq 16 s s 21 ω 1 r s k 1 r s 2 r 1 u ˆ 1 k 1 r s r 1 2 u ˆ 1 else s s 22 ω i r s k i r s k i 1 1 s k i r s r 1 u ˆ k i r s i 2 n r 1 2 u ˆ i in short weights are inversely proportional to the number of same densities and proportional to the range of two densities the current density minus the former density for example if k 1 r s k 1 2 s k 1 r s ε i i 1 then according to eq 21 we have the equation ω 1 r s ω 1 2 s ω 1 r s ε i r if k i r s k i 2 s k i r s ε i i 1 then according to eq 22 ω i r s ω i 2 s ω i r s ε i ε i 1 r fig 5 is taken as an example to show how weight coefficients are determined qu et al 2015 suppose that we have a sample dataset consisting of nine observations with five densities k i r s 1 2 3 4 5 in leg s the nine observations are further ranked by densities as well as the number of observations of the same density i e 23 k 1 1 s k 1 2 s k 2 1 s k 3 1 s k 3 2 s k 3 3 s k 4 1 s k 4 2 s k 5 1 s 1 1 2 3 3 3 4 4 5 according to eqs 21 and 22 weight coefficients of the same density are inversely proportional to the number of observations of the same density and proportional to the range of two adjacent densities 24 w 1 1 s w 1 2 s w 2 1 s w 3 1 s w 3 2 s w 3 3 s w 4 1 s w 4 2 s w 5 1 s 1 2 1 2 1 1 1 3 1 3 1 3 1 2 1 2 1 1 moreover it is important to note that weight coefficients are not the absolute values but are the relative values for all ω i j s in leg s if we divide or multiply each ω i j s by ψ which is an arbitrary value for instance the estimation results will not change to conclude the model shown by eq 15 is an unconstrained minimization problem if the speed density function f k i j s β is continuously differentiable the first order optimality condition shows that the optimal solution of model shown by eq 15 occurs when the gradient of the objective function shown in eq 25 equals zero s s 25 e β r 2 i 1 u j 1 u ˆ i ω i j s v i j s f k i j s β f k i j s β β r 0 3 results and analyses 3 1 estimation for legs w1 e15 in the singapore strait we use one week ais data to estimate the speed density relationships for legs w1 e15 in the singapore strait fitting results are reported in table 2 respectively weighted greenshields model weighted greenberg model weighted underwood model and weighted pipes model in addition the corresponding curves are presented in fig 6 where the gray stars are empirical observations note that one week of data do not consider the environmental factors in navigation resulting in a variability in the data as can be observed in fig 6 ship navigating speeds in all fifteen legs of the singapore strait are approximate in a range of 4 20 knots however most ships navigate in 8 15 knots according to the restrictions in addition ships in leg w1 have the fastest speed in westbound statistically this is because leg w1 is the entrance leg where ships have a high speed navigating from the south china sea to the singapore strait similarly ships in leg e15 navigate fastest in eastbound from which ships start to accelerate and head towards the sea moreover as mentioned previously having ais data the relationship between harmonic mean speed and space mean speed will be determined here we make a regression comparison between the harmonic mean speed and space mean speed for leg w1 as observed in fig 7 the space mean speed is slightly greater than the harmonic mean speed in general however the regression results of the five models are approximately similar 3 2 result analysis 3 2 1 coefficient of determination r square we first adopt r squares in eqs 26 29 to evaluate the performance of the non weighted and weighted models version et al 2011 values of r square are in a range of 0 1 a larger r square indicates a better performance of the model wu and liu 2011 according to the r squares 0 59 0 70 the fundamental diagrams do not fit the ais data well usually the larger the amount of data we use the better the regression result will be when the behavior of ships follows a specified fundamental diagram in addition as shown in table 3 the average r square calibrated by the weighted method is larger than the non weighted method thus the weighted method generally outperforms the non weighted method in terms of r square values in the study of the singapore strait with the exception of legs w3 e10 and e15 this indicates the different applicability of the weighted and non weighted least square approaches due to different input data hence we give a theoretical investigation into the difference between the weighted and non weighted least square approaches in appendix b which shows different cases of selecting the weighted and non weighted models 26 r s q u a r e w e i g h t e d 1 i 1 n j 1 u ˆ i v i j s f k i j s β 2 i 1 n j 1 u ˆ i v i j s v i j s 2 s s 27 v i j s i 1 n j 1 u ˆ i v i j s n u ˆ i s s 28 r s q u a r e n o n w e i g h t e d 1 j 1 ζ s v j s f k j s β 2 j 1 ζ s v j s v j s 2 s s 29 v j s j 1 ζ s v j s ζ s s s 3 2 2 root mean square error the root mean squared error rmse has also been widely used to measure the sample standard deviation of the differences between actual and predicted values version et al 2011 mathematically the weighted and non weighted rmse equations are formulated by 30 r m s e w e i g h t e d i 1 n j 1 u ˆ i v i j s f k i j s β 2 i 1 n u ˆ i s s and 31 r m s e n o n w e i g h t e d j 1 ζ s v j s f k j s β 2 ζ s s s the effect of an error on rmse is proportional to the size of the squared error thus large errors have a disproportionately large effect on rmse table 4 reports the performance of the four types of models calibrated by the non weighted and weighted methods as can be observed the weighted method significantly outperforms the non weighted method whose rmse is around 0 45 compared to 1 2 of the non weighted method 3 3 capacity estimation for the singapore strait 3 3 1 capacity estimation with a standardized ship comprehensively considering the average r square and rmse values we choose the weighted greenshields model to estimate the theoretical capacity of ship traffic for each leg in the singapore strait by adopting the basic theory of traffic flow fujii and tanaka 1971 here we define a standardized ship according to the real ship length data in the singapore strait the length of a standardized ship is determined by all ships in the studied ais data which theoretically equals the average of all ship lengths 98 66 m for the sake of presentation we define a standardized ship as a ship of 100 m in length without considering its type a combination of theoretical capacities for the fifteen legs in the strait is illustrated in fig 8 as can be observed leg w6 becomes the tightest throat leg in westbound which can hold 5 9 standardized ships per hour and leg e9 is the tightest in eastbound which can hold 8 2 standardized ships per hour in addition legs w4 w5 and w6 have a low theoretical capacity compared to the other legs in eastbound it is because w4 and w5 are quite narrow generally ships will slow down when entering legs w4 and w5 more importantly there is a 120 degree turn after w5 so that ships will further decelerate to pass through leg w6 the tightest capacity leg similarly e9 follows a 150 degree turn after e8 which makes it a low capacity leg 3 3 2 capacity estimation with different ship lengths and ship types in section 3 3 1 we define a standardized ship to estimate the capacity for each leg in the singapore strait in this section we develop a method to calculate the ship composition consisting of ship length and type under the maximum capacity firstly we count the distribution of different lengths of ships passing through the singapore strait for statistics ship lengths are divided into four groups 0 100 m 100 200 m 200 300 m and above 300 m according to the data 50 6 of ships are in 0 100 m 26 6 of ships are in 100 200 m 16 7 of ships are in 200 300 m and 6 1 of ships are above 300 m then we calculate the distribution of ship lengths in the strait according to the theoretical capacity forecasted as shown in table 5 for the sake of presentation we demonstrate legs w1 w2 and w3 in detail shown in fig 9 as illustrated there are 13 7 ships passing through leg w1 per hour 6 9 13 7 50 6 of them are small ships within 100 m in length 3 7 13 7 26 6 of them are medium ships within 200 m 2 3 13 7 16 7 of them are large ships within 300 m and 0 8 13 7 6 1 of them are super large ships above 300 m in addition by using the similar statistical method table 6 shows ship type distributions in the fifteen legs of the singapore strait the top five ship types are tanker 33 general cargo 15 tug 14 passenger ship 7 and container ship 6 more specifically fig 10 shows the ship type distributions for legs w1 w2 and w3 with the theoretical capacity estimation for each leg in the singapore strait we can find the composition of ship types in terms of the maximum ship traffic flow in each leg for example leg w1 can accommodate 4 5 tankers 2 1 general cargoes 1 9 tugs 0 9 passenger ships 0 9 container ships and 3 4 other type vessels such as bulk carrier pleasure boat and offshore work ship per hour theoretically 4 conclusions there is little doubt that the quantities of data now available are indeed large but that s not the most relevant characteristic of this new data ecosystem said danah boyd a scientist from microsoft research everyday more than six million pieces of ais data record trajectories for ships passing through the singapore strait to ensure navigation safety among the data ship speed density relationships can be mined and considered as the foundation of ship traffic flow theory which is still highly deficient hence this paper fills in the gap of the fundamental diagram of ship traffic in literature specifically from the perspective of theoretical research we developed a research framework and compared the weighted and non weighted least square approaches to address the big ais data for estimating ship fundamental diagrams from the viewpoint of practical applications we studied all the fifteen legs in singapore strait and calibrated 75 fundamental diagrams based on four classic traffic flow models through mining more than 43 million pieces of data the results indicate that ship speed density relationships are reversely related in the singapore strait generally moreover with the ship fundamental diagrams estimated by four classic traffic flow models the capacity of each leg in the strait has been predicted the speed of vessels may be determined by many factors such as weather navigators ship types traffic conditions and so on it is difficult to present an accurate regression model which contains all the above factors because of the limited data support frankly speaking the existing well known models in road traffic flow do not fit the ais data closely according to r squares to improve the fit the ais data addressed in future studies can cover a longer time period such as one year when the behavior of ships follow a specified fundamental relation in restricted water areas on the other hand ship speed is limited in the singapore strait indicating that there are not enough observations of high speeds thus experiments in maritime based simulators can be conducted to collect various ship speed density data moreover lane changing is not considered in the classic car following models in the strait ships may overtake each other thus future research should take these differences into consideration in addition different operations are conducted in various vessels such as ships decelerating to anchorage or to get pilots to board resulting in speed changing as well as occupying strait capacity such influences can be studied in future through video capturing and recording approaches goerlandt et al 2017 the inaccuracy of single regime models is not solely caused by their functional forms but also by the sample selection bias qu et al 2015 thus the non weighted least square approach could not fit the empirical data consistently well in light traffic and heavy traffic conditions in such a case the weighted least square approach generally addresses the sample selection bias problem however the weighted approach does not always outperform the non weighted approach a theoretical investigation into the difference between the above two approaches in this paper indicates the applicability of each approach in other words due to the diversity of ship traffic flows data diversity a single approach may lose its advantage in regression and shows inconsistency hence future studies can combine the weighted and non weighted approaches to solve the sample selection bias problem in calibrating macroscopic and microscopic fundamental diagrams acknowledgements we are grateful to the four anonymous reviewers for their valuable comments and constructive suggestions made for the early versions of this study this study is supported by the research project impact analysis of large ships on ship traffic in the straits of malacca and singapore project id smi 2015 ma 03 funded by the singapore maritime institute appendix a steps 1 2 and 3 in the ais data error elimination method are presented below checking ship id errors in step 1 two types of data errors found in the ais database are data messy codes such as notation in row h of table a and numerical errors such as figure 1000 in the third row according to ship numbering rules if s h i p i d max i d or s h i p i d min i d in a row where max i d 999999999 and min i d 100000000 then delete the data for that row note that the ship ids in table a have been partly anonymized eliminating ship position errors in step 2 there are two types of ship position longitude and latitude errors one is data loss see the element of row three and column three in table a another one is data irrational for example coordinate position 123 7993 e 12 51272 n is obviously not in the singapore strait s area therefore s s if l o n g i t u d e max l o n s l o n g i t u d e min l o n s l a t i t u d e max l a t s or l a t i t u d e min l a t s then delete the corresponding row data moreover according to harati mokhtari et al 2007 ship position errors may not completely cleared out by the above step one situation is that a ship navigates in leg s whose position data are in leg s frankly speaking it is a small probability event a ship generates hundreds of pieces of ais data when it passes through a leg if all these position data were wrongly transmitted then we would delete these messages for a certain leg in this study removing ship speed errors in step 3 in the singapore strait ship speed is limited within the upper max v and lower min v bounds to ensure navigation safety accordingly if s p e e d max v or s p e e d min v where max v and min v are input parameters then delete the corresponding row data such as rows h 1 and n 1 in table a in addition a lot of real data will be deleted if max v and min v are strictly set based on the traffic restrictions in the singapore straits it is because qu et al 2011 found that around 25 of the vessels sailed with a speed greater than the speed limit 15 knots while most vessels navigate faster than the lower bound in the strait thus the upper bound of speed limit should be properly enlarged in this study we set min v 4 according to restrictions and max v 20 knots according to qu et al 2011 to include most vessels in practice table a testing ais data in the singapore strait table a no ship id longitude latitude speed kn time 1 31269 103 8139 1 261175 7 2 10 1 2013 8 00 00 2 56302 123 7993 12 51272 7 8 10 1 2013 8 00 00 3 1000 none 1 305255 11 6 10 1 2013 8 00 00 h 103 7673 1 158755 8 6 10 1 2013 8 00 00 h 1 57497 none 1 312605 0 0 10 1 2013 8 00 00 n 1 56650 103 8747 none 102 2 10 1 2013 8 00 00 n 56302 104 3297 1 239625 5 1 10 1 2013 8 00 00 ais data after screening 1 31269 103 8139 1 261175 7 2 10 1 2013 8 00 00 n 56302 104 3297 1 239625 5 1 10 1 2013 8 00 00 represents data messy codes appendix b here we conduct a theoretical investigation into the difference between the weighted and non weighted least square approaches for the sake of presenting let the total number of observations under density k be n given density k speed at the i t h observation denoted by v i is a random variable the average speed of total observations under k is v and the prediction speed under k is denoted as v ˆ we use r square to compare the weighted and non weighted least square approaches in 32 32 r r w i v i r v i i 1 n v i v ˆ 2 i 1 n v i v 2 i 1 n w i v i v ˆ 2 i 1 n w i v i v 2 where function r represents the difference between the weighted and non weighted r square values let φ i v i v ˆ 2 and δ i v i v 2 clearly φ i 0 and δ i 0 thus 33 r i 1 n φ i i 1 n δ i i 1 n w i φ i i 1 n w i δ i i 1 n φ i i 1 n w i δ i i 1 n δ i i 1 n w i φ i i 1 n δ i i 1 n w i δ i 2 ω u v two items of the numerator in eq 33 are extended by two n n matrixes in eqs 34 and 35 respectively note that eq 36 is the difference between i 1 n φ i i 1 n w i δ i and i 1 n δ i i 1 n w i φ i 34 i 1 n φ i i 1 n w i δ i s u m w 1 φ 1 δ 1 w 2 φ 1 δ 2 w n φ 1 δ n w 1 φ 2 δ 1 w 2 φ 2 δ 2 w n φ 2 δ n w 1 φ n δ 1 w 2 φ n δ 2 w n φ n δ n 35 i 1 n w i φ i i 1 n δ i s u m w 1 φ 1 δ 1 w 1 φ 1 δ 2 w 1 φ 1 δ n w 2 φ 2 δ 1 w 2 φ 2 δ 2 w 2 φ 2 δ n w n φ n δ 1 w n φ n δ 2 w n φ n δ n 36 g s u m 0 w 2 w 1 φ 1 δ 2 w n w 1 φ 1 δ n w 1 w 2 φ 2 δ 1 0 w n w 2 φ 2 δ n w 1 w n φ n δ w 2 w n φ n δ 2 0 according to eq 36 when w i w j 0 φ i δ j φ j δ i 0 1 i j n we get g 0 in such a case the non weighted least square approach outperforms the weighted least square approach on the contrary the weighted least square approach performs better if g 0 
23732,the singapore strait plays a vital role for the international freight transportation including containers bulk cargo and crude oil in view of the importance of singapore strait it is of practical significance to investigate the ship traffic s speed density relationship called the fundamental diagram in the strait which can be used to estimate the theoretical strait capacity despite the availability of large empirical ship traffic data and the long history of traffic flow modeling the analysis of ship traffic fundamental diagram for the singapore strait is still highly deficient to fill in the gap we first develop a research framework to address the big ais automatic identification system data for the ship traffic fundamental diagram building to ensure the correctness of ais data a tangible error elimination method is presented moreover a novel weighted least square approach is applied to develop the ship traffic speed density formulations accurately meanwhile we also show the applicability of the weighted least square approach by a theoretical investigation into the difference between the weighted and non weighted least square approaches finally we study all the fifteen legs in the singapore strait and propose 75 fundamental diagrams based on four classic traffic flow models through mining more than 43 million pieces of ais data these fundamental diagrams also indicate the theoretical capacity of each leg in the singapore strait keywords singapore strait strait capacity ship traffic speed density fundamental diagram big ais data weighted least square approach 1 introduction the singapore strait is a 105 km long and 16 km wide waterway between the strait of malacca in the west and the south china sea in the east and it is one of the most important and busiest shipping waterways in the world in terms of usage by commercial vessels and surface naval forces which experienced a 29 3 percent increase in ship traffic from 2005 to 2015 the singapore strait also plays a vital role in the international freight transportation including containers bulk cargo and crude oil qu and meng 2012 meng et al 2017 in 2016 the straits of singapore and malacca promoted singapore to be one of the world s top three export crude oil refining centers the world s third largest oil and oil products trading hub as well as the world s second largest container port in terms of container throughput in view of the importance of singapore strait it is of practical significance to investigate the speed density relationship called the fundamental diagram showing the relationship between ship speed and ship density for ship traffic in the strait because the relationship can exhibit its theoretical capacity the automatic identification system ais is primarily and foremost a navigation tool for ship collision avoidance mou et al 2010 weng et al 2012 zhang et al 2015 2016a for example xiao et al 2015 presented an ais data analysis to deepen the understanding about the ship traffic safety in the waterways wu et al 2016 investigated the waterway transportation features from a macro level by using the aggregate ais data moreover according to the regulations proposed by international maritime organization 1 1 website of regulations http www imo org en ourwork safety navigation pages ais aspx all ships of 300 gross tonnage and upwards engaged on international voyages cargo ships of 500 gross tonnage and upwards not engaged on international voyages and all passenger ships irrespective of size are required to install the ais that can automatically identify the dynamic location sailing speed and other messages of a ship referred to as the ais messages and transit these messages to the nearby ais base stations in a time interval of 10 s approximately these dynamic and frequent ais messages promptly form the ais data to be the big data for example there are more than 43 million pieces of ship ais data in the singapore strait in one week note that these ais data record the ship navigation information in this restricted strait our preliminary observations of the ais data indicate that ships navigating in the singapore strait follow a clear speed density relation namely ship following phenomenon in addition to this phenomenon a series of maritime simulator based experiments in the singapore strait were performed by eight captains of more than ten years of sailing experience similar ship following phenomenon was observed in the simulated experiments under various scenarios different speed density cases therefore this study aims to build the fundamental diagram of ship traffic in the singapore strait by using the big ais data to further enrich the ship traffic flow studies 1 1 relevant studies for the road traffic daganzo and geroliminis 2008 showed that a fundamental diagram relating average flow and density must exist on any street with blocks of diverse widths and lengths but no turns the fundamental diagram speed density relationship has been considered as the foundation of traffic flow theory e g qu et al 2015 with traffic fundamental diagrams decision makers and researchers can study traffic flow phenomenon predict system utilization and congestion and devise strategies to improve traffic conditions there is a wealth of literature on the speed density relationships for road traffic including microscopic and macroscopic models each of which characterizes a simple yet efficient traffic flow fundamental diagram e g greenberg 1959 newell 1961 underwood 1961 pipes 1967 kerner and konhäuser 1994 li and zhang 2001 macnicholas 2008 chiabaut et al 2009 ji et al 2010 wang et al 2011 2013 wu and liu 2011 ni and wang 2013 and ni et al 2016 the main contributions of these studies have focused on developing accurate single regime and multiple regime models with a number of practically meaningful parameters that need to be calibrated to calibrate the fundamental diagram the least square approach has been applied widely which is a standard approach in regression analysis to the approximate solution of over determined systems legendre 1805 after this seminal work several variations with algebraic procedures for fitting linear non linear equations to data in engineering have been addressed for example sun et al 2003 applied a proposal local linear regression model to short term traffic prediction indicating that the local linear method consistently showed better performance than the k nearest neighbor and kernel smoothing methods meng and qu 2013 found that the bus dwell time at a bus bay possessed a high degree of uncertainty originating from the merging behavior of bus to the vehicles in the shoulder lane thus they formulated the bus dwell time at a bus bay based on a conventional regression method however the least square approach could not fit the empirical data consistently well in light traffic and congested conditions more specifically when a problem has substantial uncertainties in independent variables the least square approach has some problems in such a case the methodology required for fitting errors in variables models may be considered instead of that for the least square approach existing studies indicate that an improved weighted least square approach could largely address the sample selection bias issue aitken 1935 indeed observations may not be equally reliable in other words the observations should be weighted in some cases qu et al 2015 showed that the inaccuracy of single region models was not caused solely by the functional forms but also by the sample selection bias thus they designed an effective weighted square method on the fundamental diagram calibration for freeway traffic demonstrating that the weighted square method could represent all traffic states with high accuracy recently it has been found empirically that the traffic speed and density are related by a unique and reproducible curve the fundamental curve and optimal control methodologies such as perimeter hierarchical control and boundary flow control strategies have been used to consider network heterogeneity and cooperative traffic control see mahmassani et al 2013 leclercq et al 2015 to the best of our knowledge there are fewer studies on the fundamental diagram for ship traffic with the development of ais technique millions of pieces of ship navigation information can be used for research purpose to begin filling in this gap this study makes the first attempt to investigate the speed density relationship for ship traffic in straits by using the big ais data as well as a novel weighted least square approach 1 2 objective and contributions there are some interesting approaches proposed to estimate traffic capacity or efficiency in maritime fujii and tanaka 1971 brilon and miltner 2005 zhang et al 2016c olba et al 2017 for example liu et al 2016 developed dynamic ship domain models for estimating the capacity of restricted water channels zhang et al 2016b studied the correlation between freeway traffic and ferry traffic and proposed a modelling methodology for predicting ferry traffic in both the time and frequency domain however note that the speed density fundamental diagram can study ship traffic flow phenomenon predict strait capacity utilization and congestion and devise strategies to improve ship traffic conditions therefore it is no exaggeration to say the importance of ship speed density relationship in theoretical research and practice despite the availability of large empirical ship traffic data and the long history of road traffic flow modeling the ship traffic fundamental diagrams for the restricted waters such as the singapore strait is still highly deficient hence this study aims to develop the proper ship fundamental diagrams to formulate relationships between speed and density in different ship traffic states the main contributions of this study have threefold first a tangible research framework to address the big ais data for the ship traffic fundamental diagram building is proposed we find ship speed generally decreases with the increase of ship density in the singapore strait through mining more than 43 million pieces of ais data this finding drives us to adopt four classic traffic flow models to reveal ship speed density relationships in the strait second the four classic traffic flow models for the fifteen legs in the singapore strait are estimated by the weighted and non weighted least square approaches respectively meanwhile a theoretical investigation is conducted to show the difference between the weighted and non weighted least square approaches third the theoretical ship traffic capacity for each leg in the singapore strait is estimated which is presented by two modus standardized ships and general ships including ship length and ship type the remainder of this paper is organized as follows in section 2 we formally describe the research methodology including error elimination method for the big ais data ship harmonic mean speed and density calculation speed density function estimation and a general weight determination method for the weighted least square approach the fundamental diagrams for the overall fifteen legs in singapore strait are calibrated in section 3 conclusions and future studies are presented in section 4 2 research methodology the singapore strait providing the shortest sea route between the indian ocean via the andaman sea and the pacific ocean via the south china sea consists of fifteen legs shown in fig 1 among these legs legs w1 w7 direct from east to west and legs e8 e15 direct from west to east sigtto 2008 for more information such as leg length leg width and leg turning interested readers refer to http www shipfinder com for the sake of presentation all these legs are grouped into a set s namely 1 s s s w 1 w 2 w 7 e 8 e 9 e 15 to identify the fundamental diagram of ship traffic for each leg in the singapore strait the ais data over the strait in one week of october 2013 october 1st to october 7th was collected via the official channel including more than 43 million records note that environmental conditions such as the historical weather and wind for the period are referred to the website https www wunderground com history to make use of the ais data a research framework with three phases is proposed shown in fig 2 phase 1 aims to eliminate the noises or errors for the raw ais data and the purpose of phase 2 is to calculate the ship harmonic mean speed and ship density for each of the fifteen legs in the singapore strait by using the ais data processed in phase 1 in phase 3 a tangible weighted least square approach is applied to propose the ship speed density relationship for each leg then the fundamental diagram of ship traffic for each leg in the singapore strait is identified via existing well recognized speed density models 2 1 error elimination method for the raw big ais data a complete record of the ais data at least includes the following messages ship id position longitude and latitude course speed heading vessel type time drought navigation status dimension of bow dimension of stern dimension of port and dimension of starboard shu et al 2017 however the following five ais messages related to each ship ship id longitude latitude ship speed and time are sufficient for this study to reveal speed density relationships and develop ship fundamental diagrams these five ais messages may include some unavoidable errors noises due to the ais data transmission such as field loss and or data reading errors for example according to the statistics of the ais data over singapore strait in one week of october 2013 the resolution of the raw ais data the number of data after screening dividing the number of raw data is 91 07 approximately to remove as many errors in ais data as possible a tangible error elimination method is presented below for the sake of presentation the detailed description of error elimination method of steps 1 2 and 3 can be found in appendix a ais data error elimination method image 1 note that it may take different times to clear out data errors by using different searching methods an effective searching method is quite appreciated when dealing with the big ais data fig 3 shows two algorithmic schemes to implement the proposed ais data error elimination method fig 3 a is the vertical searching method that checks data column by column that is it first screens the ship id data and updates the matrix then the vertical method goes to screen and update the longitude latitude and speed data one column after another by contrary the horizontal searching method in fig 3 b screens the data row by row for each row the entire messages will be deleted as long as there is an error in ship id longitude latitude or speed the following proposition compares the computational performance of the vertical and horizontal searching methods proposition 1 if n 4 3 n u m 1 n u m 2 2 3 n u m 3 holds then the vertical searching method a outperforms the horizontal searching method b in terms of cpu running time measured by the big o notation otherwise horizontal b outperforms vertical a here n u m 1 n u m 2 n u m 3 denotes the number of ship ids updated after the first second third round of screening in the vertical searching method a the time complexity of the vertical searching method a is 2 o a o n n u m 1 n u m 2 n u m 3 o 4 n and the time complexity of horizontal searching method b is 3 o b o n 3 n u m 1 n 2 n u m 2 n n u m 3 n o 4 n based on the order of magnitude both searching methods are in high efficiency assuming that o a o b we have 4 o n n u m 1 n u m 2 n u m 3 o n 3 n u m 1 n 2 n u m 2 n n u m 3 n that is 5 n 4 3 n u m 1 n u m 2 2 3 n u m 3 therefore if n 4 3 n u m 1 n u m 2 2 3 n u m 3 the horizontal searching method b is better than the vertical searing method a in terms of cpu running time measured by big o notation otherwise the vertical searching method a outperforms the horizontal searching method b we used the raw ais data 8 00 9 00 on october 1st 2013 in the singapore strait to assess the efficiency of the vertical searching method a and horizontal searching method b it took 28 min approximately to screen about one million pieces of data by the vertical searching method a in a personal computer desktop workstation with 2 processors of 40 2 5 ghz cpu and 32 gb of ram however the horizontal searching method b spent more than 45 min under the same computational environment in addition we randomly selected another sheet of raw data on october 3rd 2013 to test similarly the vertical searching method a is in higher efficiency than the horizontal searching method b therefore we deduce that the vertical searching method a could show its advantage in reducing cpu time when addressing the big ais data from the singapore strait 2 2 ship harmonic mean speed and ship density in 1952 wardrop 1952 showed the difference between the space mean speed and the time mean speed in road traffic flow theory as time goes by researchers have tended towards calculating time mean speed instead of space mean speed with the development of double loop detectors soriguera and robusté 2011 in this study the ais data are separated by time intervals transmitted from the ais base stations and the harmonic mean speed is calculated in terms of time mean speed thus we select harmonic mean speed here however it should be pointed out that the space mean speed is also applicable with the checked ais data we first calculate the harmonic mean speed of ship traffic at observation j 1 ζ s in a particular leg s s denoted as v j s by 6 v j s n j s i d 1 n j s 1 v ˆ i d j s s s j 1 ζ s where v ˆ i d j s is the instantaneous sailing speed of ship i d at observation j in leg s and n j s is the total number of ships at observation j in leg s wardrop 1952 note that this harmonic mean speed v j s has a fixed relationship with the space mean speed v j s under a given set of observations let us compare them by three formulas in 7 8 and 9 as observed v j s v j s is a constant because each v ˆ i d j s i d 1 2 n j s is fixed according to the ais data therefore the numerical relationship between v j s and v j s is linear 7 v j s n j s 1 v ˆ 1 j s 1 v ˆ 2 j s 1 v ˆ n j s j s s s j 1 ζ s 8 v j s v ˆ 1 j s v ˆ 2 j s v ˆ n j s j s n j s s s j 1 ζ s 9 v j s v j s v ˆ 1 j s v ˆ 2 j s v ˆ n j s j s 1 v ˆ 1 j s 1 v ˆ 2 j s 1 v ˆ n j s j s s s j 1 ζ s in addition the ship density at time j 0 ζ s in a particular leg s s denoted as k j s is accordingly calculated by 10 k j s n j s l s s s j 0 ζ s where l s is the length of leg s greenberg 1959 note that densities ships per nautical mile are rounded to three decimal points in this study when the values are floats moreover we assume the width of a leg is fixed so that the shape of a leg can be considered as a rectangle in this case the unit of fundamental diagram holds under the consideration of ship density ships nm ship speed knot nm hr and ship flow ships hr in a given leg s s the ship harmonic speed v j s and ship density k j s are aggregated according to observations thus we have a large number of observations j 1 2 ζ s of speeds and densities for each leg s 11 j 1 ζ s v j s v 1 s v j s v ζ s s s s 12 j 1 ζ s k j s k 1 s k j s k ζ s s s s 2 3 speed density function estimation after the preliminary analysis on the ais data we found that ship speed decreases with the increase of ship density such a speed density relationship for ships in maritime transport has not been addressed using the big real data in literature therefore we apply the classic traffic flow theory to ship traffic aiming to quantitatively reveal the ship speed density relationship in the singapore strait 2 3 1 speed density relationships the relationship between ship sailing speed and ship density in leg s s denoted by v s and k s can be formulated by a generic function 13 v s g k s β s s where g k s β represents the function of ship density with the vector of parameters β that can be estimated using the ais data there are many models to formulate speed density relationships in this study we adopt four well recognized models in road traffic engineering shown in table 1 greenshields stream model greenshields et al 1935 greenberg s logarithmic model greenberg 1959 underwood s exponential model underwood 1961 and pipes generalized model pipes 1967 this is because these four models are representative by covering linear logarithm exponential and power patterns note that the four recognized models are transformed into linear functions in the last column of table 1 which can then be accurately and easily regressed by the least square approach the least square approach is a typical method to estimate the vector of parameters β by solving the minimization problem 14 min j 1 ζ s v j s g k j s β 2 s s which has been widely adopted for regression models such as sun et al 2003 in vehicle traffic forecasting meng and qu 2013 in bus dwell time estimation and qu et al 2015 in calibrating fundamental diagrams for freeway traffic however the squared error for each observation is added directly in the objective function to be minimized by using eq 14 to fit the speed density diagram consequently if a large proportion of observations are around a fixed interval density which is the case for the ais data in singapore strait 74 94 observations are in the ellipse area in fig 4 then the values of parameters β will be biased toward the area near the particular density we use the four well known models in table 1 and the ais data to calibrate the vector of parameters β the results indicate that the four regression models have a poor performance at light traffic or high traffic conditions because of the high proportion of observations at medium traffic conditions however accurate fitting in high traffic conditions is particularly important because we may forecast the capacity of a leg in a strait according to high traffic conditions 2 3 2 general weight determination method the deficiency of the least square approach caused by sample selection bias issue could be addressed by the weighted least square approach first proposed by aitken 1935 to calibrate the ship speed density model more accurately at light traffic and high traffic conditions we minimize the sum of weighted squared errors mathematically 15 min e i 1 u j 1 u ˆ i ω i j s v i j s f k i j s β 2 s s where v i j s represents the ship speed of the j t h observation under density index i in leg s s f k i j s β shows the fitting curve function with an independent density variable k i j s ship density of j t h observation of index i in leg s and ω i j s denotes the weight of j t h observation of index i in leg s if a particular traffic state is overrepresented a lower weight should be set to the corresponding observations to guarantee that the state would not dominate the estimation results therefore the following weight determination function is proposed 16 ω i j s k i j s 2 j 1 u ˆ i k i j s i 1 j 1 2 u ˆ i k i j s k i 1 1 s k i j s j 1 u ˆ i k i j s i 2 n j 1 2 u ˆ i s s where u ˆ i represents the total number of densities with the same density index i to validate the weights for observations we design the following general weight determination method comprising three steps general weight determination method step 1 initial ranking rank and update the observations based on densities k j s in leg s as the following sequence 17 v j s k j s j 1 2 ζ s v 1 s k 1 s v 2 s k 2 s v j s k j s v m s k m s where k 1 s k 2 s k j s k m s and the total number of elements in density set k j s of leg s is ζ s step 2 density merging check the values of k j s above merge and change indexes j according to densities those who have the same density will have the same subscript i and different subscript r we thus have another sequence 18 v 1 1 s k 1 1 s v 1 2 s k 1 2 s v i 1 s k i 1 s v i r s k i r s v i u ˆ i s k i u ˆ i s v n 1 s k n 1 s v n u ˆ n s k n u ˆ n s 19 where k 1 1 s k 1 2 s k i 1 s k i r s k i u ˆ i s k n 1 s k n u ˆ n s and 20 i 1 n u ˆ i m from eq 17 to eq 18 speed and density values are the same with their subscripts changed for example v j s k j s v i r s k i r s means that the original density k j s is the i t h largest value in leg s observed and the number of densities equaling k j s is r step 3 weight calculation for i in 1 2 n and for r in 1 2 u ˆ i calculate weight coefficients iteratively if i 1 according to eq 16 s s 21 ω 1 r s k 1 r s 2 r 1 u ˆ 1 k 1 r s r 1 2 u ˆ 1 else s s 22 ω i r s k i r s k i 1 1 s k i r s r 1 u ˆ k i r s i 2 n r 1 2 u ˆ i in short weights are inversely proportional to the number of same densities and proportional to the range of two densities the current density minus the former density for example if k 1 r s k 1 2 s k 1 r s ε i i 1 then according to eq 21 we have the equation ω 1 r s ω 1 2 s ω 1 r s ε i r if k i r s k i 2 s k i r s ε i i 1 then according to eq 22 ω i r s ω i 2 s ω i r s ε i ε i 1 r fig 5 is taken as an example to show how weight coefficients are determined qu et al 2015 suppose that we have a sample dataset consisting of nine observations with five densities k i r s 1 2 3 4 5 in leg s the nine observations are further ranked by densities as well as the number of observations of the same density i e 23 k 1 1 s k 1 2 s k 2 1 s k 3 1 s k 3 2 s k 3 3 s k 4 1 s k 4 2 s k 5 1 s 1 1 2 3 3 3 4 4 5 according to eqs 21 and 22 weight coefficients of the same density are inversely proportional to the number of observations of the same density and proportional to the range of two adjacent densities 24 w 1 1 s w 1 2 s w 2 1 s w 3 1 s w 3 2 s w 3 3 s w 4 1 s w 4 2 s w 5 1 s 1 2 1 2 1 1 1 3 1 3 1 3 1 2 1 2 1 1 moreover it is important to note that weight coefficients are not the absolute values but are the relative values for all ω i j s in leg s if we divide or multiply each ω i j s by ψ which is an arbitrary value for instance the estimation results will not change to conclude the model shown by eq 15 is an unconstrained minimization problem if the speed density function f k i j s β is continuously differentiable the first order optimality condition shows that the optimal solution of model shown by eq 15 occurs when the gradient of the objective function shown in eq 25 equals zero s s 25 e β r 2 i 1 u j 1 u ˆ i ω i j s v i j s f k i j s β f k i j s β β r 0 3 results and analyses 3 1 estimation for legs w1 e15 in the singapore strait we use one week ais data to estimate the speed density relationships for legs w1 e15 in the singapore strait fitting results are reported in table 2 respectively weighted greenshields model weighted greenberg model weighted underwood model and weighted pipes model in addition the corresponding curves are presented in fig 6 where the gray stars are empirical observations note that one week of data do not consider the environmental factors in navigation resulting in a variability in the data as can be observed in fig 6 ship navigating speeds in all fifteen legs of the singapore strait are approximate in a range of 4 20 knots however most ships navigate in 8 15 knots according to the restrictions in addition ships in leg w1 have the fastest speed in westbound statistically this is because leg w1 is the entrance leg where ships have a high speed navigating from the south china sea to the singapore strait similarly ships in leg e15 navigate fastest in eastbound from which ships start to accelerate and head towards the sea moreover as mentioned previously having ais data the relationship between harmonic mean speed and space mean speed will be determined here we make a regression comparison between the harmonic mean speed and space mean speed for leg w1 as observed in fig 7 the space mean speed is slightly greater than the harmonic mean speed in general however the regression results of the five models are approximately similar 3 2 result analysis 3 2 1 coefficient of determination r square we first adopt r squares in eqs 26 29 to evaluate the performance of the non weighted and weighted models version et al 2011 values of r square are in a range of 0 1 a larger r square indicates a better performance of the model wu and liu 2011 according to the r squares 0 59 0 70 the fundamental diagrams do not fit the ais data well usually the larger the amount of data we use the better the regression result will be when the behavior of ships follows a specified fundamental diagram in addition as shown in table 3 the average r square calibrated by the weighted method is larger than the non weighted method thus the weighted method generally outperforms the non weighted method in terms of r square values in the study of the singapore strait with the exception of legs w3 e10 and e15 this indicates the different applicability of the weighted and non weighted least square approaches due to different input data hence we give a theoretical investigation into the difference between the weighted and non weighted least square approaches in appendix b which shows different cases of selecting the weighted and non weighted models 26 r s q u a r e w e i g h t e d 1 i 1 n j 1 u ˆ i v i j s f k i j s β 2 i 1 n j 1 u ˆ i v i j s v i j s 2 s s 27 v i j s i 1 n j 1 u ˆ i v i j s n u ˆ i s s 28 r s q u a r e n o n w e i g h t e d 1 j 1 ζ s v j s f k j s β 2 j 1 ζ s v j s v j s 2 s s 29 v j s j 1 ζ s v j s ζ s s s 3 2 2 root mean square error the root mean squared error rmse has also been widely used to measure the sample standard deviation of the differences between actual and predicted values version et al 2011 mathematically the weighted and non weighted rmse equations are formulated by 30 r m s e w e i g h t e d i 1 n j 1 u ˆ i v i j s f k i j s β 2 i 1 n u ˆ i s s and 31 r m s e n o n w e i g h t e d j 1 ζ s v j s f k j s β 2 ζ s s s the effect of an error on rmse is proportional to the size of the squared error thus large errors have a disproportionately large effect on rmse table 4 reports the performance of the four types of models calibrated by the non weighted and weighted methods as can be observed the weighted method significantly outperforms the non weighted method whose rmse is around 0 45 compared to 1 2 of the non weighted method 3 3 capacity estimation for the singapore strait 3 3 1 capacity estimation with a standardized ship comprehensively considering the average r square and rmse values we choose the weighted greenshields model to estimate the theoretical capacity of ship traffic for each leg in the singapore strait by adopting the basic theory of traffic flow fujii and tanaka 1971 here we define a standardized ship according to the real ship length data in the singapore strait the length of a standardized ship is determined by all ships in the studied ais data which theoretically equals the average of all ship lengths 98 66 m for the sake of presentation we define a standardized ship as a ship of 100 m in length without considering its type a combination of theoretical capacities for the fifteen legs in the strait is illustrated in fig 8 as can be observed leg w6 becomes the tightest throat leg in westbound which can hold 5 9 standardized ships per hour and leg e9 is the tightest in eastbound which can hold 8 2 standardized ships per hour in addition legs w4 w5 and w6 have a low theoretical capacity compared to the other legs in eastbound it is because w4 and w5 are quite narrow generally ships will slow down when entering legs w4 and w5 more importantly there is a 120 degree turn after w5 so that ships will further decelerate to pass through leg w6 the tightest capacity leg similarly e9 follows a 150 degree turn after e8 which makes it a low capacity leg 3 3 2 capacity estimation with different ship lengths and ship types in section 3 3 1 we define a standardized ship to estimate the capacity for each leg in the singapore strait in this section we develop a method to calculate the ship composition consisting of ship length and type under the maximum capacity firstly we count the distribution of different lengths of ships passing through the singapore strait for statistics ship lengths are divided into four groups 0 100 m 100 200 m 200 300 m and above 300 m according to the data 50 6 of ships are in 0 100 m 26 6 of ships are in 100 200 m 16 7 of ships are in 200 300 m and 6 1 of ships are above 300 m then we calculate the distribution of ship lengths in the strait according to the theoretical capacity forecasted as shown in table 5 for the sake of presentation we demonstrate legs w1 w2 and w3 in detail shown in fig 9 as illustrated there are 13 7 ships passing through leg w1 per hour 6 9 13 7 50 6 of them are small ships within 100 m in length 3 7 13 7 26 6 of them are medium ships within 200 m 2 3 13 7 16 7 of them are large ships within 300 m and 0 8 13 7 6 1 of them are super large ships above 300 m in addition by using the similar statistical method table 6 shows ship type distributions in the fifteen legs of the singapore strait the top five ship types are tanker 33 general cargo 15 tug 14 passenger ship 7 and container ship 6 more specifically fig 10 shows the ship type distributions for legs w1 w2 and w3 with the theoretical capacity estimation for each leg in the singapore strait we can find the composition of ship types in terms of the maximum ship traffic flow in each leg for example leg w1 can accommodate 4 5 tankers 2 1 general cargoes 1 9 tugs 0 9 passenger ships 0 9 container ships and 3 4 other type vessels such as bulk carrier pleasure boat and offshore work ship per hour theoretically 4 conclusions there is little doubt that the quantities of data now available are indeed large but that s not the most relevant characteristic of this new data ecosystem said danah boyd a scientist from microsoft research everyday more than six million pieces of ais data record trajectories for ships passing through the singapore strait to ensure navigation safety among the data ship speed density relationships can be mined and considered as the foundation of ship traffic flow theory which is still highly deficient hence this paper fills in the gap of the fundamental diagram of ship traffic in literature specifically from the perspective of theoretical research we developed a research framework and compared the weighted and non weighted least square approaches to address the big ais data for estimating ship fundamental diagrams from the viewpoint of practical applications we studied all the fifteen legs in singapore strait and calibrated 75 fundamental diagrams based on four classic traffic flow models through mining more than 43 million pieces of data the results indicate that ship speed density relationships are reversely related in the singapore strait generally moreover with the ship fundamental diagrams estimated by four classic traffic flow models the capacity of each leg in the strait has been predicted the speed of vessels may be determined by many factors such as weather navigators ship types traffic conditions and so on it is difficult to present an accurate regression model which contains all the above factors because of the limited data support frankly speaking the existing well known models in road traffic flow do not fit the ais data closely according to r squares to improve the fit the ais data addressed in future studies can cover a longer time period such as one year when the behavior of ships follow a specified fundamental relation in restricted water areas on the other hand ship speed is limited in the singapore strait indicating that there are not enough observations of high speeds thus experiments in maritime based simulators can be conducted to collect various ship speed density data moreover lane changing is not considered in the classic car following models in the strait ships may overtake each other thus future research should take these differences into consideration in addition different operations are conducted in various vessels such as ships decelerating to anchorage or to get pilots to board resulting in speed changing as well as occupying strait capacity such influences can be studied in future through video capturing and recording approaches goerlandt et al 2017 the inaccuracy of single regime models is not solely caused by their functional forms but also by the sample selection bias qu et al 2015 thus the non weighted least square approach could not fit the empirical data consistently well in light traffic and heavy traffic conditions in such a case the weighted least square approach generally addresses the sample selection bias problem however the weighted approach does not always outperform the non weighted approach a theoretical investigation into the difference between the above two approaches in this paper indicates the applicability of each approach in other words due to the diversity of ship traffic flows data diversity a single approach may lose its advantage in regression and shows inconsistency hence future studies can combine the weighted and non weighted approaches to solve the sample selection bias problem in calibrating macroscopic and microscopic fundamental diagrams acknowledgements we are grateful to the four anonymous reviewers for their valuable comments and constructive suggestions made for the early versions of this study this study is supported by the research project impact analysis of large ships on ship traffic in the straits of malacca and singapore project id smi 2015 ma 03 funded by the singapore maritime institute appendix a steps 1 2 and 3 in the ais data error elimination method are presented below checking ship id errors in step 1 two types of data errors found in the ais database are data messy codes such as notation in row h of table a and numerical errors such as figure 1000 in the third row according to ship numbering rules if s h i p i d max i d or s h i p i d min i d in a row where max i d 999999999 and min i d 100000000 then delete the data for that row note that the ship ids in table a have been partly anonymized eliminating ship position errors in step 2 there are two types of ship position longitude and latitude errors one is data loss see the element of row three and column three in table a another one is data irrational for example coordinate position 123 7993 e 12 51272 n is obviously not in the singapore strait s area therefore s s if l o n g i t u d e max l o n s l o n g i t u d e min l o n s l a t i t u d e max l a t s or l a t i t u d e min l a t s then delete the corresponding row data moreover according to harati mokhtari et al 2007 ship position errors may not completely cleared out by the above step one situation is that a ship navigates in leg s whose position data are in leg s frankly speaking it is a small probability event a ship generates hundreds of pieces of ais data when it passes through a leg if all these position data were wrongly transmitted then we would delete these messages for a certain leg in this study removing ship speed errors in step 3 in the singapore strait ship speed is limited within the upper max v and lower min v bounds to ensure navigation safety accordingly if s p e e d max v or s p e e d min v where max v and min v are input parameters then delete the corresponding row data such as rows h 1 and n 1 in table a in addition a lot of real data will be deleted if max v and min v are strictly set based on the traffic restrictions in the singapore straits it is because qu et al 2011 found that around 25 of the vessels sailed with a speed greater than the speed limit 15 knots while most vessels navigate faster than the lower bound in the strait thus the upper bound of speed limit should be properly enlarged in this study we set min v 4 according to restrictions and max v 20 knots according to qu et al 2011 to include most vessels in practice table a testing ais data in the singapore strait table a no ship id longitude latitude speed kn time 1 31269 103 8139 1 261175 7 2 10 1 2013 8 00 00 2 56302 123 7993 12 51272 7 8 10 1 2013 8 00 00 3 1000 none 1 305255 11 6 10 1 2013 8 00 00 h 103 7673 1 158755 8 6 10 1 2013 8 00 00 h 1 57497 none 1 312605 0 0 10 1 2013 8 00 00 n 1 56650 103 8747 none 102 2 10 1 2013 8 00 00 n 56302 104 3297 1 239625 5 1 10 1 2013 8 00 00 ais data after screening 1 31269 103 8139 1 261175 7 2 10 1 2013 8 00 00 n 56302 104 3297 1 239625 5 1 10 1 2013 8 00 00 represents data messy codes appendix b here we conduct a theoretical investigation into the difference between the weighted and non weighted least square approaches for the sake of presenting let the total number of observations under density k be n given density k speed at the i t h observation denoted by v i is a random variable the average speed of total observations under k is v and the prediction speed under k is denoted as v ˆ we use r square to compare the weighted and non weighted least square approaches in 32 32 r r w i v i r v i i 1 n v i v ˆ 2 i 1 n v i v 2 i 1 n w i v i v ˆ 2 i 1 n w i v i v 2 where function r represents the difference between the weighted and non weighted r square values let φ i v i v ˆ 2 and δ i v i v 2 clearly φ i 0 and δ i 0 thus 33 r i 1 n φ i i 1 n δ i i 1 n w i φ i i 1 n w i δ i i 1 n φ i i 1 n w i δ i i 1 n δ i i 1 n w i φ i i 1 n δ i i 1 n w i δ i 2 ω u v two items of the numerator in eq 33 are extended by two n n matrixes in eqs 34 and 35 respectively note that eq 36 is the difference between i 1 n φ i i 1 n w i δ i and i 1 n δ i i 1 n w i φ i 34 i 1 n φ i i 1 n w i δ i s u m w 1 φ 1 δ 1 w 2 φ 1 δ 2 w n φ 1 δ n w 1 φ 2 δ 1 w 2 φ 2 δ 2 w n φ 2 δ n w 1 φ n δ 1 w 2 φ n δ 2 w n φ n δ n 35 i 1 n w i φ i i 1 n δ i s u m w 1 φ 1 δ 1 w 1 φ 1 δ 2 w 1 φ 1 δ n w 2 φ 2 δ 1 w 2 φ 2 δ 2 w 2 φ 2 δ n w n φ n δ 1 w n φ n δ 2 w n φ n δ n 36 g s u m 0 w 2 w 1 φ 1 δ 2 w n w 1 φ 1 δ n w 1 w 2 φ 2 δ 1 0 w n w 2 φ 2 δ n w 1 w n φ n δ w 2 w n φ n δ 2 0 according to eq 36 when w i w j 0 φ i δ j φ j δ i 0 1 i j n we get g 0 in such a case the non weighted least square approach outperforms the weighted least square approach on the contrary the weighted least square approach performs better if g 0 
23733,improvement of the undrained capacities of foundation as a result of preloading has received attention in offshore engineering only recently it offers the benefit of optimising foundation design and reducing footprint and cost this paper investigates the preloading performance of skirted circular foundations in clay using 3d coupled finite element analyses the increase in the ultimate undrained uniaxial vertical horizontal and moment capacities is provided for non dimensional groups of foundation skirt length in situ undrained shear strength heterogeneity magnitude of vertical preload and normalised consolidation time an exponential relationship between preloading gain in capacity and normalised consolidation time is established with the maximum preloading gain expressed as a function of the three other dimensionless groups an approach to estimate the post preload undrained ultimate uniaxial capacities of skirted circular foundations on normally consolidated clay is ultimately proposed the influence of foundation geometry is discussed via comparison with the existing solutions keywords shallow footing preloading consolidation bearing capacity modified cam clay 1 introduction holding vertical load on a foundation in a preloading process improves its capacity due to consolidation and the associated dissipation of excess pore pressures in the soil in offshore engineering an active preloading process may be used prior to operations to develop an acceptable margin of safety against environmental loading randolph and gourvenec 2011 passive preloading resulting from self weight consolidation also increases the foundation capacity though this is usually not considered in design the majority of the research work undertaken to date focuses on the enhancement of the vertical undrained bearing capacity of shallow foundations in clay fig 1 summarises the vertical capacity increase ηv f after full consolidation for increasing levels of preloading p both normalised with the no preload undrained capacity from full scale and reduced scale experimental work and from numerical analysis lehane and jardine 2003 conducted field tests to investigate the effect of preloading on the undrained bearing capacity of an embedded solid square foundation in lightly over consolidated soil ocr approximately 2 5 at the foundation top level a significant increase in the undrained capacity ηv f of 1 5 was measured after 11 year of consolidation under a sustained level of preloading of p 65 a finite element model was also implemented by zdravkovic et al 2003 providing further insight into the response of a preloaded strip foundation in clay with various ratios of over consolidation ocr ranging within 1 2 4 9 and 25 a much larger gain in undrained capacity was calculated in normally consolidated clay than in over consolidated clay lehane and gaudin 2005 reported results of centrifuge testing on embedded solid square foundations a considerable gain ηv f of 1 8 in undrained capacity was measured after full consolidation under a level of preloading of p 65 although the over consolidation ratio ocr was approximately 8 at the foundation level a series of centrifuge tests was conducted by bienen et al 2010 to investigate the effects of both preloading and consolidation on the undrained bearing capacity of a surface circular foundation on normally consolidated clay the results showed an increase ηv f of 1 6 in undrained bearing capacity under a level of preloading of approximately p 75 as evident from fig 1 the improvement in vertical capacity can be significant up to 80 but varies greatly as a function of the foundation shape and embedment and the degree of over consolidation of the soil more recently further work has been undertaken to characterise more rigorously the gain in capacity due to preloading gourvenec et al 2014 developed a framework to predict the gain in undrained vertical bearing capacity of a strip and circular foundation as a function of the level of preloading and degree of consolidation the changes in preload driven elastic and plastic stress were assessed to evaluate the gain in average undrained shear strength in parallel fu et al 2015 conducted a series of centrifuge testing and numerical analyses to investigate the history of the response of the bearing capacity of a skirted circular foundation on soft clay a time dependent exponential increase in bearing capacity was proposed for any given level of preloading based on the evolution in both elastic and plastic volume changes the effect of the interface property was also investigated which shows no influence on the gain in undrained bearing capacity consistent with the observation of gourvenec et al 2014 a smaller body of research investigated the increase in combined vertical v horizontal h and moment m capacity due to preloading bransby 2002 explored the preloaded vertical and horizontal load response of a strip foundation in normally consolidated soil a higher increase in horizontal capacity was calculated compared with that in vertical capacity more recently feng and gourvenec 2015 and vulpe et al 2016 reported capacity for a surface rectangular in combined vhm as well as the torsional t load direction and for surface strip and circular foundation in vhm for different levels of preloading and duration of consolidation this body of literature provides evidence of the increased foundation capacity due to preloading and the importance of factors such as foundation shape interface property loading direction and initial stress state however the influence of the foundation skirt embedment has received less attention this is of significant importance because the skirt transfers the load applied on the foundation to deeper soil changing the region of primary consolidation this particular aspect is addressed in this paper which presents numerical results using coupled small strain finite element analyses to investigate the post preload capacities of skirted circular foundations on normally consolidated clay the skirt length the initial undrained shear strength distribution in the soil the magnitude of preloading and the duration of consolidation are considered based on the finite element results formulations to predict the post preload undrained uniaxial capacities of skirted circular foundations are proposed as a function of the level of preloading p defined as the ratio of the applied vertical load v p to the undrained vertical bearing capacity v un the duration of application of the preload defined by the time factor t v c v0 t d 2 where c v0 is the initial in situ coefficient of consolidation at the skirt tip level t is the elapsed time and d is the foundation diameter the foundation aspect ratios d d where d is the foundation skirt length which is varied from 0 to 1 and the soil strength heterogeneity ratio kd s u0 where k is the soil strength gradient with soil depth z and s u0 is the undrained shear strength at the skirt tip level d which is varied from 0 5 to 5 note that a linear soil strength profile is adopted as s u s um kz where s um is the shear strength at the mudline 2 numerical model 2 1 soil model and parameters three dimensional coupled small strain finite element analyses were undertaken using the modified cam clay soil model roscoe and burland 1968 as implemented in abaqus dassault systèmes 2010 the soil domain was modelled as a linear elastoplastic material all parameters adopted in this study are summarised in table 1 the soil body was anisotropically consolidated with k 0 1 sinϕ tc 0 612 where the critical friction angle ϕ tc was 22 8 in triaxial compression wroth 1984 the submerged unit weight of soil was taken as γ 6 kn m3 the plane strain strength s u varies with depth following standard relationships wroth 1984 1 s u σ v s u p cs p cs p 0 p 0 σ v m s cos θ l 3 p c0 2p 0 λ κ λ 1 2 k 0 3 where σ v is the vertical effective stress κ is the swelling and recompression index λ is the virgin compression index p 0 is the initial mean normal effective stress p c0 is the initial pre consolidation pressure p cs is the mean normal stress at failure and θl is the lode angle the surcharge was applied on the top surface and across the foundation base to provide an initial soil strength heterogeneity ratio kd s u0 varying within the range 0 5 1 1 25 1 4285 2 3 33 and 5 under these conditions the coefficient of consolidation c v0 eq 2 and initial void ratio e 0 eq 3 also vary with depth 2 c v 0 k s m v γ w k s 1 e 0 p 0 λ γ w 3 e 0 e c s λ κ ln 2 κ ln p 0 λ κ ln p c 0 where k s is the permeability p c0 is the initial pre consolidation pressure and p 0 is the corresponding mean effective normal stress further details of the soil model and finite element modelling methods used in the present study can be obtained from chatterjee et al 2012 fu et al 2015 and 2017 2 2 geometry foundation model and mesh the skirted circular foundation was modelled with a diameter d of 14 m and a skirt tip pre embedded in the soil to a depth d of 0 1 diameters 0 0 2d 0 3d 0 5d 0 7d 0 8d and 1d the embedded skirt tip and skirt base nodes were bounded to the adjacent soil elements leading to a rough interface in shear with no detachment permitted between the soil and foundation this is thought to be appropriate for representing offshore field conditions because the tensile resistance developed within the soil plug due to suction is confined by the periphery skirts no permeability was allowed at the foundation interface the reference point rp for loads and displacements is located along the foundation centreline at the skirt tip level a typical three dimensional finite element mesh used for the analyses of a skirted circular footing d d 0 5 is presented in fig 2 which represents a half footing cut through the plane of symmetry the mesh boundary extends a distance of 7d horizontally and 3 1d vertically from the tip level of the skirted circular foundation with the horizontal displacement on the lateral boundaries and vertical displacement at the base boundary set to zero a free boundary was allowed only at the top surface which was defined as a permeable boundary the mesh shown in fig 2 d d 0 5 comprises 23 500 full integration stress pore fluid continuum elements c3d8p in the abaqus standard library the minimum element length was approximately 0 002d located beneath and around the skirt tip to ensure the reliable simulation at the failure zone a mesh sensitivity analysis was undertaken to examine the efficiency in calculation without compromising accuracy 2 3 analysis procedure the numerical analyses included 4662 cases involving the application of a vertical preload v p on the foundation yielding a level of preloading p v p v un 100 where v un is the ultimate vertical load maintaining a period of time for consolidation the foundation was then subjected to the following procedures 1 further undrained penetration was imposed to establish the post preload undrained ultimate vertical load v pc p 2 the horizontal or rotational side swipe tests tan 1990 were then carried out to derive the post preload undrained horizontal load h pc p or moment undrained load m pc p nine different levels of preloading p from 10 to 90 with intervals of 10 and a series of consolidation times were included in the simulation for each foundation aspect ratio d d and each soil strength heterogeneity kd s u0 note that all no preload undrained uniaxial capacities necessary to the analyses in this study are inferred from the solution described by fu et al 2017 with the same computation parameters 3 nomenclature the notation of loads involving both no preload and post preload analyses is summarised in table 2 note that more complicated subscripts involved in notations are not included but the definition follows a simple rule the combination of two general terms undrained uniaxial capacity q and preloading gain η with several subscripts indicates different conditions the subscripts comprised v for the vertical direction h for the horizontal direction m for the moment direction un for the no preload condition pc for the post preload condition f for full consolidation p for partial consolidation p10 for the p of 10 p90 for the p of 90 skt for the skirted circular foundation surf for the surface circular foundation for example ηv f p10 surf denotes the preloading gain in the undrained vertical capacity under p of 10 after the full consolidation for a surface circular foundation for all analyses an initial in situ coefficient of consolidation at the skirt tip level c v0 is adopted in this study to capture the normalised elapsed time t v c v0 t d 2 4 results when exploring the post preload undrained uniaxial capacities of a skirted circular foundation in clay an appropriate method is to investigate the ratio of the post preload to the original undrained capacities ηv p v pc p v un ηh p h pc p h un ηm p m pc p m un this is because a significant amount of studies exist to evaluate the original undrained capacities considering various boundary conditions for instance fu et al 2017 outlined an approach to estimate the undrained uniaxial capacities of skirted circular foundations for any given d d and kd s u0 which can be taken as a direct database for comparing the corresponding gains due to preloading studied in this paper increase in undrained uniaxial capacities after full consolidation ηv f v pc f v un ηh f h pc f h un ηm f m pc f m un fig 3 shows the gains in the undrained uniaxial vertical horizontal and moment capacities of skirted circular foundations of aspect ratios d d 0 0 2 0 5 and 1 under different levels of preloading p from 10 to 90 with intervals of 10 after full consolidation five soil strength heterogeneity ratios kd s u0 0 5 1 2 3 33 and 5 are selected for demonstration a similar trend of increase for each of the undrained uniaxial capacities due to preloading and consolidation is observed the trend exhibits a bilinear increase with an inflexion point at about p 10 implying a different rate of increase in undrained shear strength between very low and high levels of preloading this is because the increase in undrained shear strength resulting from consolidation arises from both elastic and plastic volume changes the elastic compression associated with low p gives a smaller change in volume than the plastic compression associated with large p fu et al 2015 for each d d the gain in all uniaxial capacities increases with increasing kd s u0 which reflects shallower failure mechanisms of higher strength heterogeneity and larger enhancement of the undrained shear strength due to preloading in the near surface soil although the trend is similar the magnitude of increase in uniaxial capacity differs between the loading directions with maximum ηv f ηh f ηm f of 1 9 3 2 and 3 4 respectively these are obtained from calculations on the surface circular foundation ηv f ηh f and skirted circular foundation with d d of 0 2 ηm f on the soil with kd s u0 of 5 and under the largest p of 90 this is attributed to the non uniform increase in undrained shear strength with the near surface soil experiencing the largest increase in strength and the mobilised volume at failure under different directional loading the vertical loading mobilises the largest soil domain encompassing most of the consolidated material the horizontal loading mobilises a smaller domain limited to the sliding plane beneath the foundation and the passive and active side wedges along the skirts low foundation aspect ratios in soil with high strength heterogeneity lead to an internal scoop mechanism under moment loading which involves a relatively small soil domain see fu et al 2017 the latter moment is therefore only associated with enhancement in undrained shear strength of the soil above the skirt tip 4 1 method to predict the increase in uniaxial capacity after full consolidation considering the bilinear variation of gain in undrained capacities ηv f ηh f ηm f with the level of preloading the focus of this paper is on the assessment of ηv f ηh f and ηm f under a transitional level of preloading p of 10 and a relatively larger level of preloading p of 90 based on this the preloading gains in undrained capacities after full consolidation can be expressed as follows for p 10 4 η f η f p 10 10 p for 10 p 90 5 η f η f p 10 η f p 90 η f p 10 90 10 p 10 where ηf is the preloading gain after full consolidation representing ηv f ηh f and ηm f for each loading direction subscripts p10 and p90 are associated with p of 10 and 90 respectively the foundation aspect ratio d d and the soil strength heterogeneity ratio kd s u0 are also considered in evaluating ηf p10 and ηf p90 considering their influence on the preloading gain as evident from fig 3 the influence of kd s u0 can be readily assessed from the response of the surface circular foundation d d 0 numerical results under p of 10 and 90 are shown in fig 4 a and b encompassing ηv f ηh f and ηm f respectively and the corresponding linear lines showing the best fit are also included expressed as for p 10 6 η f p 10 surf 1 05 0 007 kd s u 0 vertical 1 16 0 02 kd s u 0 horizontal 1 10 0 003 kd s u 0 moment for p 90 7 η f p 90 surf 1 75 0 03 kd s u 0 vertical 2 52 0 15 kd s u 0 horizontal 2 29 moment where ηf p10 surf and ηf p90 surf are the preloading gains in the undrained capacities of the surface circular foundation after full consolidation at p of 10 and 90 respectively the influence of d d is evaluated by comparing the post preload undrained capacity of a skirted circular and surface circular foundation the differences essentially resides in the contribution of the soil above the skirt tip fig 5 presents the method to quantify the effect of d d on the increase in undrained uniaxial capacities the increase in undrained capacities δq δv v pc f v un δh h pc f h un and δm m pc f m un of the skirted circular foundation is divided into two independent components one δq top is related to the soil above the skirt tip see the region with the hatching shadow in fig 5 and the other δq surf relies on the soil below the skirt tip see the region with the square dot shadow in fig 5 which can be evaluated by the increase in capacity for a surface circular footing with identical kd s u0 condition δq can therefore be expressed from the improvement evaluated for a surface circular foundation 8 δ q s k t g d d δ q s u r f where g d d is a function of d d indicating the effect of foundation skirt length on the improvement in the undrained capacity due to preloading with consolidation subscripts skt and surf distinguish the improvement between the skirted and surface foundations and δq surf is expressed as 9 δ q s u r f η f s u r f 1 q u n s u r f where ηf surf is calculated using eqs 4 7 for any given level of preloading q un surf is the undrained uniaxial capacities of the surface circular foundation representing v un surf h un surf and m un surf the preloading gains in undrained capacities for skirted circular foundations ηf skt is obtained with a combination of eqs 8 and 9 10 η s k t q u n s k t δ q s k t q u n s k t g d d η f s u r f 1 q u n s k t q u n s u r f 1 where q un skt q un surf is the ratio of the undrained capacities of the skirted circular foundation to that of the surface circular foundation quantified by fu et al 2017 with the general term being replaced by v h and m for each loading direction for any d d and kd s u0 11 v un skt v un surf 1 1 9 l n 1 d d s u m s u 0 1 1 15 ln 1 d d kd s u 0 12 h un skt h un surf 1 8 15 l n 1 d d s u m s u 0 1 5 ln 1 d d kd s u 0 13 m un skt m un surf 1 1 79 d d 1 02 d d 2 1 56 d d 3 s u m s u 0 0 65 0 05 d d 1 88 d d 2 kd s u 0 to establish the expression of g d d the numerical results of ηf skt are used for back calculation analyses note that the values of ηf surf and q un skt q un surf are also from numerical analyses rather than calculated from the equations above to ensure accuracy in the prediction of g d d the corresponding fitting curves are for p 10 14 g d d p 10 1 vertical 1 horizontal 1 moment for p 90 15 g d d p 90 1 0 18 d d 0 5 vertical 1 0 41 d d 0 33 horizontal 1 0 46 d d 0 55 moment eqs 14 and 15 give a value of g d d higher than 1 within the range of p of 10 90 this indicates that the foundation skirt length contributes positively to the absolute improvement in undrained capacities δq under the same kd s u0 condition due to the added consolidation of soil above the skirt tip at p of 10 g d d is almost unity for any direction of loading with increasing d d this implies that at low p the soil above the skirt tip makes little contribution to the preloading gain of the skirted circular foundation at p of 90 the variation of g d d with d d follows a power law increase with an increasing d d along each loading direction to determine the accuracy of this set of equations eq 15 both results of ηf skt from finite element analyses and equations are shown in figs 6 and 7 for p of 10 and 90 respectively both sets of results are generally in close agreement with the largest discrepancies within 5 observed at p of 10 and kd s u0 of 5 under moment loading normalised preloading gain in undrained uniaxial capacities with elapsed time it is not always possible to wait until full consolidation of the skirted footing particularly in the costly offshore environment engineers therefore require knowledge of the increase in capacity with time during the preloading here we use the finite element analyses to define the normalised preloading gain u a general term representing u v u h u m for each loading direction with the elapsed time as a representative of the rate of increase in capacity with consolidation we follow the strategy described by fu et al 2015 where 16a u v v p c p v u n v p c f v u n v p c p v u n 1 v p c f v u n 1 η v p 1 η v f 1 16b u h h p c p h u n h p c f h u n h p c p h u n 1 h p c f h u n 1 η h p 1 η h f 1 16c u m m p c p m u n m p c f m u n m p c p m u n 1 m p c f m u n 1 η m p 1 η m f 1 with ηv p ηh p and ηm p being the preloading gains in the undrained vertical horizontal and moment capacities under partial consolidation and ηv f ηh f and ηm f being the respective preloading gains corresponding to full consolidation as evaluated by eqs 4 and 5 similarly v pc p h pc p and m pc p are the post preload undrained capacities under partial consolidation the variation of u defined by the variation of time factor t v c v0 t d 2 with different p d d and initial kd s u0 is discussed in the following sections 4 2 effect of p the magnitude of the vertical preloading changes the effective stress field due to consolidation which also changes the coefficient of consolidation the consolidation responses therefore vary with p the variations of u v u h and u m with time factor t v for different levels of preloading are presented in fig 8 results for d d 0 with a relatively homogeneous soil condition kd s u0 0 5 are selected for presentation to avoid the combined effects of d d and kd s u0 the normalised preloading gain in each loading direction shows a similar trend with a slightly faster consolidation response being observed under higher p this implies that p has a minimal influence on the normalised consolidation responses the consolidation curves presented in this study are therefore mostly presented for p of 50 representing a good and generally conservative estimation of all results 4 3 effect of aspect ratio d d with increasing d d the drainage paths within the soil lengthens and the consolidation response is affected the variations of u v u h and u m with time factor t v for different skirt embedment levels are reported in fig 9 a b and c respectively results for p 50 and kd s u0 0 5 are selected for interpretation ensuring that no kd s u0 effects are involved the normalised preloading gain in each loading direction shows a slower consolidation response with increasing d d this reflects a larger volume of soil being mobilised during consolidation and longer drainage paths 4 4 effect of strength ratio kd su0 variations of u v u h and u m with time factor t v for different strength heterogeneity ratios are presented in fig 10 a b and c results are limited to p 50 and d d 0 for clarity for each loading direction a faster consolidation response is observed with increasing kd s u0 due to the corresponding distribution of the initial coefficient of consolidation 4 5 evaluation of u considering combined effects of p d d and kd su0 based on the characteristics outlined previously an exponential formulation is presented to depict the time responses of normalised preloading gain in undrained capacities 17 u 1 0 5 t v t 50 n where t 50 is the time at which the increase in uniaxial undrained capacity is half the maximum increase and n is the factor controlling the shapes of the time response table 3 summarises the best fit values of t 50 and n to u v u h and u m for skirted circular foundations with different d d note that the influence of kd s u0 is neglected here instead the consolidation responses with a relatively homogeneous soil strength profile kd s u0 0 5 with a corresponding relatively uniform profile of the coefficient of consolidation is used to represent each d d which allows for a conservative and simpler formulation the results are representative for all p the parameter t 50 increases with d d for u v u h and u m which implies longer time periods are required for consolidation the parameter n maintains a constant value of 0 85 for u v and u m but for u h shows an initial rise from approximately 0 60 at low d d to a constant value of 0 85 at higher d d such a change in shape of the consolidation response is presented in fig 9 compared to u v and u m a major difference exists in the early stage of consolidation with u h exhibiting a faster consolidation rate fig 11 a d d 0 however this discrepancy becomes less pronounced with increasing d d fig 11b this reflects the difference of the consolidation response across the soil domain u v u h and u m are associated with the evolution of undrained shear strength with consolidation within the soil domain mobilised by each direction of loading volumetric deformations under vertical preload develop from a region in the vicinity of the foundation to the far field with consolidation under vertical and moment load a larger volume of soil is mobilised in consolidation for low strength heterogeneities the failure mechanism under moment load is not confined to an internal scoop hence u v and u m reflect the average consolidation response over a larger volume of soil under horizontal loading at a lower d d soil is essentially mobilised along the sliding plane and the corresponding u h is associated with a more localised consolidation beneath the foundation at a higher d d a larger body of soil underneath the foundation and in the active and passive wedge region will be mobilised reducing the difference in consolidation response between u h and u v and u m 5 summary of the method to calculate the post preloaded uniaxial capacities formulations are presented to calculate the preloaded undrained uniaxial capacities of skirted circular foundations as a function of the level of preloading p as a function of the duration of application of preload defined by the time factor t v for embedment ratios d d ranging from 0 to 1 and for strength heterogeneity ratios kd s u0 the method incorporates the solutions to estimate the no preload uniaxial undrained capacities presented in fu et al 2017 and the formulations for evaluating ηf and u presented in this paper the calculation procedure comprises four steps 1 calculate the no preload undrained uniaxial capacities v un h un and m un using the expressions of the undrained uniaxial capacity factors n c of the skirted circular foundation fu et al 2017 2 calculate the preloading gains in undrained uniaxial capacities after full consolidation ηf using eqs 4 and 5 3 calculate the preloading gains in undrained uniaxial capacities for partial consolidation ηp using ηf calculated from step 2 and t v following an expression derived from a combination of eqs 16 and 17 19 η p η f η f 1 0 5 t v t 50 n fig 12 a b and c show an example of a preloading gain in undrained vertical horizontal and moment capacities η ηv ηh ηm with a normalised consolidation time t v for a skirted circular foundation with d d 0 3 four different kd s u0 0 5 1 2 3 33 and two different p of 20 and 90 are included 4 calculate the post preload undrained uniaxial capacities q pc which can be expressed as follows for full consolidation 20a q p c f q u n η f for partial consolidation 20b q p c p q u n η p the overall procedure with a summary of the formulation to calculate n c ηf and ηp is presented in table 4 following the method proposed above an example is introduced here to illustrate the potential gains in the uniaxial capacities of a subsea foundation due to preloading with consolidation a circular foundation with a dimeter d of 10 m rests on the normally consolidated clay with an undrained shear strength profile s u 4 5 1 5z kd s u0 of 3 33 and a consolidation coefficient c v0 of 3 m2 year a vertical preload v of 1160 kn is applied to the foundation and durations of consolidation under the vertical preload of 3 and 6 months within the range of typical time lag between installation and operation of pipelines are considered following fu et al 2017 the no preload undrained ultimate vertical capacity v un horizontal capacity h un and moment capacity m un are 2905 2 kn 353 4 kn and 3852 4 knmm the preloading level p corresponds to approximately 40 which yields preloading gains ηf v ηf h and ηf m under full consolidation of 1 33 1 66 and 1 50 the 3 month and 6 month consolidation time corresponds to t v of 0 0075 and 0 015 which will lead to the preloading gains ηp v ηp h and ηp m being 1 13 1 20 1 30 1 41 and 1 20 1 30 respectively the vertical horizontal and moment capacity are therefore predicted to increase to 3285 3 3478 8 kn 460 2 497 9 kn and 4616 0 5004 8 knm respectively it is clear that the consolidation allows the foundation to resist greater environmental loads if accounted in design this could result in smaller and more economical foundations 6 comparison with available solutions the influence of the foundation geometry on the preloading gains in undrained uniaxial capacities is discussed in this section results are first compared with existing solutions based on linear fits for surface strip vulpe et al 2016 and surface rectangular foundations feng and gourvenec 2015 in fig 13 a b and c the fitted expressions for preloading gains in undrained capacities are compared for p 0 70 after full consolidation for a surface circular foundation d d 0 in fig 10 a b and c to ensure a direct comparison between the studies a strength heterogeneity ratio kd s um kb s um for the surface rectangular foundation of 1 875 is considered the surface strip foundation generally exhibits the largest increase due to preloading this is because plane strain consolidation leads to a higher average increase in undrained shear strength for the vertical loading direction the surface circular foundation shows slightly lower preloading gains than the surface rectangular foundation for the horizontal loading direction the surface circular and rectangular foundations present similar although slightly lower preloading gains compared to the surface strip footing implying a similar increase in the undrained shear strength of the near surface soil under the same magnitude of vertical preload the surface circular foundation has a higher preloading gain under a lower preloading level in horizontal loading direction compared to the surface strip foundation which may be attributed to the bi linear fit adopted in this study in the moment direction the rectangular footing presents the lowest preloading gain along the loading direction the rotation axis is the in the centre foundation base plane and parallel to the short edge which is highly related to the largest volume of soil being mobilised by consolidation the performance of other types of foundation in preloading gain in v h and m are also compared for the vertical loading direction the surface circular foundation shows much higher preloading gains than the skirted circular foundation this is because the periphery skirt allows consolidation to occur in stronger soil with lower compressibility and thus yields a lower increase in undrained shear strength the development of consolidation in deep soil also results in a low preloading gain of the skirted circular foundation and this tendency is more obvious with an increasing d d for the moment loading direction a skirted circular foundation with a small d d of 0 2 shows a large gain exceeding that of the surface foundations at large p this is because although the soil beneath the skirt tip has a lower increase in shear strength the additional improvement in soil strength due to consolidation confined within the periphery skirt is mobilised under the moment loading at failure after consolidation this tendency does not remain with increasing d d 7 concluding remarks a set of comprehensive finite element analyses were conducted to investigate the post preload undrained uniaxial capacity of the skirted circular foundation on normally consolidated clay the influences of the level of preloading the foundation aspect ratio the initial soil strength heterogeneity and the duration of consolidation are observed the main conclusions are non uniform increases in the uniaxial capacities in v h and m for a given level of preload and consolidation time is attributed to the volume of consolidated soil encompassed by the failure mechanism the level of preloading reflects the magnitude of soil deformation in the consolidation soil region elastic compression dominates soil behaviour at low p lower than 10 while the plastic compression dominates at higher p larger than 10 the resultant preloading gains follow an approximately bilinear relationship against the magnitude of vertical preload higher soil strength heterogeneity results in shallower soil being mobilised at failure which shows larger increases in undrained shear strength due to consolidation larger gains are associated with shorter skirt length because the periphery skirt transfers the vertical preload to deeper soil already more competent soil a series of equations is proposed to evaluate the full consolidated gains in uniaxial undrained capacities under preloading a further extension incorporates the entire consolidation history and a method to estimate the post preload uniaxial capacities for any given p d d and kd s u0 after a period of consolidation is proposed finally this study has neglected a range of complexities such as skirted foundation roughness over consolidation ratio and soil model sensitivity these influences might be analysed independently to gauge the significance of foundation preloading issues however the general conclusion here will be useful for many practical foundation designs acknowledgements this work forms part of the activities of the centre for offshore foundation systems cofs which is supported by the lloyd s register foundation as a centre of excellence and now forms one of the primary nodes of the australian research council arc centre of excellence for geotechnical science and engineering lloyd s register foundation invests in science engineering and technology for public benefit worldwide notation c v0 initial in situ coefficient of consolidation at the skirt tip level d skirt length d d aspect ratio d diameter of skirted circular foundation e 0 initial void ratio e cs intercepts of the critical state line csl with the compression plane at p 1 kpa h general term for horizontal load k shear strength gradient kd s u0 undrained shear strength heterogeneity kd s um non dimensional undrained shear strength gradient k s coefficient of permeability k 0 coefficient of lateral earth pressure m v coefficient of volume compressibility m general term for moment load m s gradient of critical state line csl in the p qd plane n fitting parameter n c undrained uniaxial capacity factor n c r ratio of the capacity factor for a skirted circular foundation divided by that for a circular foundation n c r homo ratio of the capacity factor for a skirted circular foundation divided by that for a circular foundation on homogeneous soil n c r nc soil ratio of the capacity factor for a skirted circular foundation divided by that for a circular foundation on normally consolidated soil p 0 initial mean normal effective stress p c0 pre consolidation pressure hardening parameter p cs mean normal effective stress at the failure state q a general term for undrained ultimate vertical horizontal and moment load s u undrained shear strength s u0 initial undrained shear strength at the skirt tip level s um initial undrained shear strength at the mudline t 50 fitting parameter t v normalised consolidation time factor u normalised preloading gain v general term for vertical load δh absolute preloading enhancement in undrained horizontal capacities δm absolute preloading enhancement in undrained moment capacities δv absolute preloading enhancement in undrained vertical capacities δq general term of absolute preloading enhancement in undrained vertical horizontal and moment capacities η general term of preloading gains γ w water unit weight γ submerged unit weight of the soil θl lode angle κ swelling and recompression index λ virgin compression index σ v vertical effective stress ϕ tc critical friction angle in triaxial compression 
23733,improvement of the undrained capacities of foundation as a result of preloading has received attention in offshore engineering only recently it offers the benefit of optimising foundation design and reducing footprint and cost this paper investigates the preloading performance of skirted circular foundations in clay using 3d coupled finite element analyses the increase in the ultimate undrained uniaxial vertical horizontal and moment capacities is provided for non dimensional groups of foundation skirt length in situ undrained shear strength heterogeneity magnitude of vertical preload and normalised consolidation time an exponential relationship between preloading gain in capacity and normalised consolidation time is established with the maximum preloading gain expressed as a function of the three other dimensionless groups an approach to estimate the post preload undrained ultimate uniaxial capacities of skirted circular foundations on normally consolidated clay is ultimately proposed the influence of foundation geometry is discussed via comparison with the existing solutions keywords shallow footing preloading consolidation bearing capacity modified cam clay 1 introduction holding vertical load on a foundation in a preloading process improves its capacity due to consolidation and the associated dissipation of excess pore pressures in the soil in offshore engineering an active preloading process may be used prior to operations to develop an acceptable margin of safety against environmental loading randolph and gourvenec 2011 passive preloading resulting from self weight consolidation also increases the foundation capacity though this is usually not considered in design the majority of the research work undertaken to date focuses on the enhancement of the vertical undrained bearing capacity of shallow foundations in clay fig 1 summarises the vertical capacity increase ηv f after full consolidation for increasing levels of preloading p both normalised with the no preload undrained capacity from full scale and reduced scale experimental work and from numerical analysis lehane and jardine 2003 conducted field tests to investigate the effect of preloading on the undrained bearing capacity of an embedded solid square foundation in lightly over consolidated soil ocr approximately 2 5 at the foundation top level a significant increase in the undrained capacity ηv f of 1 5 was measured after 11 year of consolidation under a sustained level of preloading of p 65 a finite element model was also implemented by zdravkovic et al 2003 providing further insight into the response of a preloaded strip foundation in clay with various ratios of over consolidation ocr ranging within 1 2 4 9 and 25 a much larger gain in undrained capacity was calculated in normally consolidated clay than in over consolidated clay lehane and gaudin 2005 reported results of centrifuge testing on embedded solid square foundations a considerable gain ηv f of 1 8 in undrained capacity was measured after full consolidation under a level of preloading of p 65 although the over consolidation ratio ocr was approximately 8 at the foundation level a series of centrifuge tests was conducted by bienen et al 2010 to investigate the effects of both preloading and consolidation on the undrained bearing capacity of a surface circular foundation on normally consolidated clay the results showed an increase ηv f of 1 6 in undrained bearing capacity under a level of preloading of approximately p 75 as evident from fig 1 the improvement in vertical capacity can be significant up to 80 but varies greatly as a function of the foundation shape and embedment and the degree of over consolidation of the soil more recently further work has been undertaken to characterise more rigorously the gain in capacity due to preloading gourvenec et al 2014 developed a framework to predict the gain in undrained vertical bearing capacity of a strip and circular foundation as a function of the level of preloading and degree of consolidation the changes in preload driven elastic and plastic stress were assessed to evaluate the gain in average undrained shear strength in parallel fu et al 2015 conducted a series of centrifuge testing and numerical analyses to investigate the history of the response of the bearing capacity of a skirted circular foundation on soft clay a time dependent exponential increase in bearing capacity was proposed for any given level of preloading based on the evolution in both elastic and plastic volume changes the effect of the interface property was also investigated which shows no influence on the gain in undrained bearing capacity consistent with the observation of gourvenec et al 2014 a smaller body of research investigated the increase in combined vertical v horizontal h and moment m capacity due to preloading bransby 2002 explored the preloaded vertical and horizontal load response of a strip foundation in normally consolidated soil a higher increase in horizontal capacity was calculated compared with that in vertical capacity more recently feng and gourvenec 2015 and vulpe et al 2016 reported capacity for a surface rectangular in combined vhm as well as the torsional t load direction and for surface strip and circular foundation in vhm for different levels of preloading and duration of consolidation this body of literature provides evidence of the increased foundation capacity due to preloading and the importance of factors such as foundation shape interface property loading direction and initial stress state however the influence of the foundation skirt embedment has received less attention this is of significant importance because the skirt transfers the load applied on the foundation to deeper soil changing the region of primary consolidation this particular aspect is addressed in this paper which presents numerical results using coupled small strain finite element analyses to investigate the post preload capacities of skirted circular foundations on normally consolidated clay the skirt length the initial undrained shear strength distribution in the soil the magnitude of preloading and the duration of consolidation are considered based on the finite element results formulations to predict the post preload undrained uniaxial capacities of skirted circular foundations are proposed as a function of the level of preloading p defined as the ratio of the applied vertical load v p to the undrained vertical bearing capacity v un the duration of application of the preload defined by the time factor t v c v0 t d 2 where c v0 is the initial in situ coefficient of consolidation at the skirt tip level t is the elapsed time and d is the foundation diameter the foundation aspect ratios d d where d is the foundation skirt length which is varied from 0 to 1 and the soil strength heterogeneity ratio kd s u0 where k is the soil strength gradient with soil depth z and s u0 is the undrained shear strength at the skirt tip level d which is varied from 0 5 to 5 note that a linear soil strength profile is adopted as s u s um kz where s um is the shear strength at the mudline 2 numerical model 2 1 soil model and parameters three dimensional coupled small strain finite element analyses were undertaken using the modified cam clay soil model roscoe and burland 1968 as implemented in abaqus dassault systèmes 2010 the soil domain was modelled as a linear elastoplastic material all parameters adopted in this study are summarised in table 1 the soil body was anisotropically consolidated with k 0 1 sinϕ tc 0 612 where the critical friction angle ϕ tc was 22 8 in triaxial compression wroth 1984 the submerged unit weight of soil was taken as γ 6 kn m3 the plane strain strength s u varies with depth following standard relationships wroth 1984 1 s u σ v s u p cs p cs p 0 p 0 σ v m s cos θ l 3 p c0 2p 0 λ κ λ 1 2 k 0 3 where σ v is the vertical effective stress κ is the swelling and recompression index λ is the virgin compression index p 0 is the initial mean normal effective stress p c0 is the initial pre consolidation pressure p cs is the mean normal stress at failure and θl is the lode angle the surcharge was applied on the top surface and across the foundation base to provide an initial soil strength heterogeneity ratio kd s u0 varying within the range 0 5 1 1 25 1 4285 2 3 33 and 5 under these conditions the coefficient of consolidation c v0 eq 2 and initial void ratio e 0 eq 3 also vary with depth 2 c v 0 k s m v γ w k s 1 e 0 p 0 λ γ w 3 e 0 e c s λ κ ln 2 κ ln p 0 λ κ ln p c 0 where k s is the permeability p c0 is the initial pre consolidation pressure and p 0 is the corresponding mean effective normal stress further details of the soil model and finite element modelling methods used in the present study can be obtained from chatterjee et al 2012 fu et al 2015 and 2017 2 2 geometry foundation model and mesh the skirted circular foundation was modelled with a diameter d of 14 m and a skirt tip pre embedded in the soil to a depth d of 0 1 diameters 0 0 2d 0 3d 0 5d 0 7d 0 8d and 1d the embedded skirt tip and skirt base nodes were bounded to the adjacent soil elements leading to a rough interface in shear with no detachment permitted between the soil and foundation this is thought to be appropriate for representing offshore field conditions because the tensile resistance developed within the soil plug due to suction is confined by the periphery skirts no permeability was allowed at the foundation interface the reference point rp for loads and displacements is located along the foundation centreline at the skirt tip level a typical three dimensional finite element mesh used for the analyses of a skirted circular footing d d 0 5 is presented in fig 2 which represents a half footing cut through the plane of symmetry the mesh boundary extends a distance of 7d horizontally and 3 1d vertically from the tip level of the skirted circular foundation with the horizontal displacement on the lateral boundaries and vertical displacement at the base boundary set to zero a free boundary was allowed only at the top surface which was defined as a permeable boundary the mesh shown in fig 2 d d 0 5 comprises 23 500 full integration stress pore fluid continuum elements c3d8p in the abaqus standard library the minimum element length was approximately 0 002d located beneath and around the skirt tip to ensure the reliable simulation at the failure zone a mesh sensitivity analysis was undertaken to examine the efficiency in calculation without compromising accuracy 2 3 analysis procedure the numerical analyses included 4662 cases involving the application of a vertical preload v p on the foundation yielding a level of preloading p v p v un 100 where v un is the ultimate vertical load maintaining a period of time for consolidation the foundation was then subjected to the following procedures 1 further undrained penetration was imposed to establish the post preload undrained ultimate vertical load v pc p 2 the horizontal or rotational side swipe tests tan 1990 were then carried out to derive the post preload undrained horizontal load h pc p or moment undrained load m pc p nine different levels of preloading p from 10 to 90 with intervals of 10 and a series of consolidation times were included in the simulation for each foundation aspect ratio d d and each soil strength heterogeneity kd s u0 note that all no preload undrained uniaxial capacities necessary to the analyses in this study are inferred from the solution described by fu et al 2017 with the same computation parameters 3 nomenclature the notation of loads involving both no preload and post preload analyses is summarised in table 2 note that more complicated subscripts involved in notations are not included but the definition follows a simple rule the combination of two general terms undrained uniaxial capacity q and preloading gain η with several subscripts indicates different conditions the subscripts comprised v for the vertical direction h for the horizontal direction m for the moment direction un for the no preload condition pc for the post preload condition f for full consolidation p for partial consolidation p10 for the p of 10 p90 for the p of 90 skt for the skirted circular foundation surf for the surface circular foundation for example ηv f p10 surf denotes the preloading gain in the undrained vertical capacity under p of 10 after the full consolidation for a surface circular foundation for all analyses an initial in situ coefficient of consolidation at the skirt tip level c v0 is adopted in this study to capture the normalised elapsed time t v c v0 t d 2 4 results when exploring the post preload undrained uniaxial capacities of a skirted circular foundation in clay an appropriate method is to investigate the ratio of the post preload to the original undrained capacities ηv p v pc p v un ηh p h pc p h un ηm p m pc p m un this is because a significant amount of studies exist to evaluate the original undrained capacities considering various boundary conditions for instance fu et al 2017 outlined an approach to estimate the undrained uniaxial capacities of skirted circular foundations for any given d d and kd s u0 which can be taken as a direct database for comparing the corresponding gains due to preloading studied in this paper increase in undrained uniaxial capacities after full consolidation ηv f v pc f v un ηh f h pc f h un ηm f m pc f m un fig 3 shows the gains in the undrained uniaxial vertical horizontal and moment capacities of skirted circular foundations of aspect ratios d d 0 0 2 0 5 and 1 under different levels of preloading p from 10 to 90 with intervals of 10 after full consolidation five soil strength heterogeneity ratios kd s u0 0 5 1 2 3 33 and 5 are selected for demonstration a similar trend of increase for each of the undrained uniaxial capacities due to preloading and consolidation is observed the trend exhibits a bilinear increase with an inflexion point at about p 10 implying a different rate of increase in undrained shear strength between very low and high levels of preloading this is because the increase in undrained shear strength resulting from consolidation arises from both elastic and plastic volume changes the elastic compression associated with low p gives a smaller change in volume than the plastic compression associated with large p fu et al 2015 for each d d the gain in all uniaxial capacities increases with increasing kd s u0 which reflects shallower failure mechanisms of higher strength heterogeneity and larger enhancement of the undrained shear strength due to preloading in the near surface soil although the trend is similar the magnitude of increase in uniaxial capacity differs between the loading directions with maximum ηv f ηh f ηm f of 1 9 3 2 and 3 4 respectively these are obtained from calculations on the surface circular foundation ηv f ηh f and skirted circular foundation with d d of 0 2 ηm f on the soil with kd s u0 of 5 and under the largest p of 90 this is attributed to the non uniform increase in undrained shear strength with the near surface soil experiencing the largest increase in strength and the mobilised volume at failure under different directional loading the vertical loading mobilises the largest soil domain encompassing most of the consolidated material the horizontal loading mobilises a smaller domain limited to the sliding plane beneath the foundation and the passive and active side wedges along the skirts low foundation aspect ratios in soil with high strength heterogeneity lead to an internal scoop mechanism under moment loading which involves a relatively small soil domain see fu et al 2017 the latter moment is therefore only associated with enhancement in undrained shear strength of the soil above the skirt tip 4 1 method to predict the increase in uniaxial capacity after full consolidation considering the bilinear variation of gain in undrained capacities ηv f ηh f ηm f with the level of preloading the focus of this paper is on the assessment of ηv f ηh f and ηm f under a transitional level of preloading p of 10 and a relatively larger level of preloading p of 90 based on this the preloading gains in undrained capacities after full consolidation can be expressed as follows for p 10 4 η f η f p 10 10 p for 10 p 90 5 η f η f p 10 η f p 90 η f p 10 90 10 p 10 where ηf is the preloading gain after full consolidation representing ηv f ηh f and ηm f for each loading direction subscripts p10 and p90 are associated with p of 10 and 90 respectively the foundation aspect ratio d d and the soil strength heterogeneity ratio kd s u0 are also considered in evaluating ηf p10 and ηf p90 considering their influence on the preloading gain as evident from fig 3 the influence of kd s u0 can be readily assessed from the response of the surface circular foundation d d 0 numerical results under p of 10 and 90 are shown in fig 4 a and b encompassing ηv f ηh f and ηm f respectively and the corresponding linear lines showing the best fit are also included expressed as for p 10 6 η f p 10 surf 1 05 0 007 kd s u 0 vertical 1 16 0 02 kd s u 0 horizontal 1 10 0 003 kd s u 0 moment for p 90 7 η f p 90 surf 1 75 0 03 kd s u 0 vertical 2 52 0 15 kd s u 0 horizontal 2 29 moment where ηf p10 surf and ηf p90 surf are the preloading gains in the undrained capacities of the surface circular foundation after full consolidation at p of 10 and 90 respectively the influence of d d is evaluated by comparing the post preload undrained capacity of a skirted circular and surface circular foundation the differences essentially resides in the contribution of the soil above the skirt tip fig 5 presents the method to quantify the effect of d d on the increase in undrained uniaxial capacities the increase in undrained capacities δq δv v pc f v un δh h pc f h un and δm m pc f m un of the skirted circular foundation is divided into two independent components one δq top is related to the soil above the skirt tip see the region with the hatching shadow in fig 5 and the other δq surf relies on the soil below the skirt tip see the region with the square dot shadow in fig 5 which can be evaluated by the increase in capacity for a surface circular footing with identical kd s u0 condition δq can therefore be expressed from the improvement evaluated for a surface circular foundation 8 δ q s k t g d d δ q s u r f where g d d is a function of d d indicating the effect of foundation skirt length on the improvement in the undrained capacity due to preloading with consolidation subscripts skt and surf distinguish the improvement between the skirted and surface foundations and δq surf is expressed as 9 δ q s u r f η f s u r f 1 q u n s u r f where ηf surf is calculated using eqs 4 7 for any given level of preloading q un surf is the undrained uniaxial capacities of the surface circular foundation representing v un surf h un surf and m un surf the preloading gains in undrained capacities for skirted circular foundations ηf skt is obtained with a combination of eqs 8 and 9 10 η s k t q u n s k t δ q s k t q u n s k t g d d η f s u r f 1 q u n s k t q u n s u r f 1 where q un skt q un surf is the ratio of the undrained capacities of the skirted circular foundation to that of the surface circular foundation quantified by fu et al 2017 with the general term being replaced by v h and m for each loading direction for any d d and kd s u0 11 v un skt v un surf 1 1 9 l n 1 d d s u m s u 0 1 1 15 ln 1 d d kd s u 0 12 h un skt h un surf 1 8 15 l n 1 d d s u m s u 0 1 5 ln 1 d d kd s u 0 13 m un skt m un surf 1 1 79 d d 1 02 d d 2 1 56 d d 3 s u m s u 0 0 65 0 05 d d 1 88 d d 2 kd s u 0 to establish the expression of g d d the numerical results of ηf skt are used for back calculation analyses note that the values of ηf surf and q un skt q un surf are also from numerical analyses rather than calculated from the equations above to ensure accuracy in the prediction of g d d the corresponding fitting curves are for p 10 14 g d d p 10 1 vertical 1 horizontal 1 moment for p 90 15 g d d p 90 1 0 18 d d 0 5 vertical 1 0 41 d d 0 33 horizontal 1 0 46 d d 0 55 moment eqs 14 and 15 give a value of g d d higher than 1 within the range of p of 10 90 this indicates that the foundation skirt length contributes positively to the absolute improvement in undrained capacities δq under the same kd s u0 condition due to the added consolidation of soil above the skirt tip at p of 10 g d d is almost unity for any direction of loading with increasing d d this implies that at low p the soil above the skirt tip makes little contribution to the preloading gain of the skirted circular foundation at p of 90 the variation of g d d with d d follows a power law increase with an increasing d d along each loading direction to determine the accuracy of this set of equations eq 15 both results of ηf skt from finite element analyses and equations are shown in figs 6 and 7 for p of 10 and 90 respectively both sets of results are generally in close agreement with the largest discrepancies within 5 observed at p of 10 and kd s u0 of 5 under moment loading normalised preloading gain in undrained uniaxial capacities with elapsed time it is not always possible to wait until full consolidation of the skirted footing particularly in the costly offshore environment engineers therefore require knowledge of the increase in capacity with time during the preloading here we use the finite element analyses to define the normalised preloading gain u a general term representing u v u h u m for each loading direction with the elapsed time as a representative of the rate of increase in capacity with consolidation we follow the strategy described by fu et al 2015 where 16a u v v p c p v u n v p c f v u n v p c p v u n 1 v p c f v u n 1 η v p 1 η v f 1 16b u h h p c p h u n h p c f h u n h p c p h u n 1 h p c f h u n 1 η h p 1 η h f 1 16c u m m p c p m u n m p c f m u n m p c p m u n 1 m p c f m u n 1 η m p 1 η m f 1 with ηv p ηh p and ηm p being the preloading gains in the undrained vertical horizontal and moment capacities under partial consolidation and ηv f ηh f and ηm f being the respective preloading gains corresponding to full consolidation as evaluated by eqs 4 and 5 similarly v pc p h pc p and m pc p are the post preload undrained capacities under partial consolidation the variation of u defined by the variation of time factor t v c v0 t d 2 with different p d d and initial kd s u0 is discussed in the following sections 4 2 effect of p the magnitude of the vertical preloading changes the effective stress field due to consolidation which also changes the coefficient of consolidation the consolidation responses therefore vary with p the variations of u v u h and u m with time factor t v for different levels of preloading are presented in fig 8 results for d d 0 with a relatively homogeneous soil condition kd s u0 0 5 are selected for presentation to avoid the combined effects of d d and kd s u0 the normalised preloading gain in each loading direction shows a similar trend with a slightly faster consolidation response being observed under higher p this implies that p has a minimal influence on the normalised consolidation responses the consolidation curves presented in this study are therefore mostly presented for p of 50 representing a good and generally conservative estimation of all results 4 3 effect of aspect ratio d d with increasing d d the drainage paths within the soil lengthens and the consolidation response is affected the variations of u v u h and u m with time factor t v for different skirt embedment levels are reported in fig 9 a b and c respectively results for p 50 and kd s u0 0 5 are selected for interpretation ensuring that no kd s u0 effects are involved the normalised preloading gain in each loading direction shows a slower consolidation response with increasing d d this reflects a larger volume of soil being mobilised during consolidation and longer drainage paths 4 4 effect of strength ratio kd su0 variations of u v u h and u m with time factor t v for different strength heterogeneity ratios are presented in fig 10 a b and c results are limited to p 50 and d d 0 for clarity for each loading direction a faster consolidation response is observed with increasing kd s u0 due to the corresponding distribution of the initial coefficient of consolidation 4 5 evaluation of u considering combined effects of p d d and kd su0 based on the characteristics outlined previously an exponential formulation is presented to depict the time responses of normalised preloading gain in undrained capacities 17 u 1 0 5 t v t 50 n where t 50 is the time at which the increase in uniaxial undrained capacity is half the maximum increase and n is the factor controlling the shapes of the time response table 3 summarises the best fit values of t 50 and n to u v u h and u m for skirted circular foundations with different d d note that the influence of kd s u0 is neglected here instead the consolidation responses with a relatively homogeneous soil strength profile kd s u0 0 5 with a corresponding relatively uniform profile of the coefficient of consolidation is used to represent each d d which allows for a conservative and simpler formulation the results are representative for all p the parameter t 50 increases with d d for u v u h and u m which implies longer time periods are required for consolidation the parameter n maintains a constant value of 0 85 for u v and u m but for u h shows an initial rise from approximately 0 60 at low d d to a constant value of 0 85 at higher d d such a change in shape of the consolidation response is presented in fig 9 compared to u v and u m a major difference exists in the early stage of consolidation with u h exhibiting a faster consolidation rate fig 11 a d d 0 however this discrepancy becomes less pronounced with increasing d d fig 11b this reflects the difference of the consolidation response across the soil domain u v u h and u m are associated with the evolution of undrained shear strength with consolidation within the soil domain mobilised by each direction of loading volumetric deformations under vertical preload develop from a region in the vicinity of the foundation to the far field with consolidation under vertical and moment load a larger volume of soil is mobilised in consolidation for low strength heterogeneities the failure mechanism under moment load is not confined to an internal scoop hence u v and u m reflect the average consolidation response over a larger volume of soil under horizontal loading at a lower d d soil is essentially mobilised along the sliding plane and the corresponding u h is associated with a more localised consolidation beneath the foundation at a higher d d a larger body of soil underneath the foundation and in the active and passive wedge region will be mobilised reducing the difference in consolidation response between u h and u v and u m 5 summary of the method to calculate the post preloaded uniaxial capacities formulations are presented to calculate the preloaded undrained uniaxial capacities of skirted circular foundations as a function of the level of preloading p as a function of the duration of application of preload defined by the time factor t v for embedment ratios d d ranging from 0 to 1 and for strength heterogeneity ratios kd s u0 the method incorporates the solutions to estimate the no preload uniaxial undrained capacities presented in fu et al 2017 and the formulations for evaluating ηf and u presented in this paper the calculation procedure comprises four steps 1 calculate the no preload undrained uniaxial capacities v un h un and m un using the expressions of the undrained uniaxial capacity factors n c of the skirted circular foundation fu et al 2017 2 calculate the preloading gains in undrained uniaxial capacities after full consolidation ηf using eqs 4 and 5 3 calculate the preloading gains in undrained uniaxial capacities for partial consolidation ηp using ηf calculated from step 2 and t v following an expression derived from a combination of eqs 16 and 17 19 η p η f η f 1 0 5 t v t 50 n fig 12 a b and c show an example of a preloading gain in undrained vertical horizontal and moment capacities η ηv ηh ηm with a normalised consolidation time t v for a skirted circular foundation with d d 0 3 four different kd s u0 0 5 1 2 3 33 and two different p of 20 and 90 are included 4 calculate the post preload undrained uniaxial capacities q pc which can be expressed as follows for full consolidation 20a q p c f q u n η f for partial consolidation 20b q p c p q u n η p the overall procedure with a summary of the formulation to calculate n c ηf and ηp is presented in table 4 following the method proposed above an example is introduced here to illustrate the potential gains in the uniaxial capacities of a subsea foundation due to preloading with consolidation a circular foundation with a dimeter d of 10 m rests on the normally consolidated clay with an undrained shear strength profile s u 4 5 1 5z kd s u0 of 3 33 and a consolidation coefficient c v0 of 3 m2 year a vertical preload v of 1160 kn is applied to the foundation and durations of consolidation under the vertical preload of 3 and 6 months within the range of typical time lag between installation and operation of pipelines are considered following fu et al 2017 the no preload undrained ultimate vertical capacity v un horizontal capacity h un and moment capacity m un are 2905 2 kn 353 4 kn and 3852 4 knmm the preloading level p corresponds to approximately 40 which yields preloading gains ηf v ηf h and ηf m under full consolidation of 1 33 1 66 and 1 50 the 3 month and 6 month consolidation time corresponds to t v of 0 0075 and 0 015 which will lead to the preloading gains ηp v ηp h and ηp m being 1 13 1 20 1 30 1 41 and 1 20 1 30 respectively the vertical horizontal and moment capacity are therefore predicted to increase to 3285 3 3478 8 kn 460 2 497 9 kn and 4616 0 5004 8 knm respectively it is clear that the consolidation allows the foundation to resist greater environmental loads if accounted in design this could result in smaller and more economical foundations 6 comparison with available solutions the influence of the foundation geometry on the preloading gains in undrained uniaxial capacities is discussed in this section results are first compared with existing solutions based on linear fits for surface strip vulpe et al 2016 and surface rectangular foundations feng and gourvenec 2015 in fig 13 a b and c the fitted expressions for preloading gains in undrained capacities are compared for p 0 70 after full consolidation for a surface circular foundation d d 0 in fig 10 a b and c to ensure a direct comparison between the studies a strength heterogeneity ratio kd s um kb s um for the surface rectangular foundation of 1 875 is considered the surface strip foundation generally exhibits the largest increase due to preloading this is because plane strain consolidation leads to a higher average increase in undrained shear strength for the vertical loading direction the surface circular foundation shows slightly lower preloading gains than the surface rectangular foundation for the horizontal loading direction the surface circular and rectangular foundations present similar although slightly lower preloading gains compared to the surface strip footing implying a similar increase in the undrained shear strength of the near surface soil under the same magnitude of vertical preload the surface circular foundation has a higher preloading gain under a lower preloading level in horizontal loading direction compared to the surface strip foundation which may be attributed to the bi linear fit adopted in this study in the moment direction the rectangular footing presents the lowest preloading gain along the loading direction the rotation axis is the in the centre foundation base plane and parallel to the short edge which is highly related to the largest volume of soil being mobilised by consolidation the performance of other types of foundation in preloading gain in v h and m are also compared for the vertical loading direction the surface circular foundation shows much higher preloading gains than the skirted circular foundation this is because the periphery skirt allows consolidation to occur in stronger soil with lower compressibility and thus yields a lower increase in undrained shear strength the development of consolidation in deep soil also results in a low preloading gain of the skirted circular foundation and this tendency is more obvious with an increasing d d for the moment loading direction a skirted circular foundation with a small d d of 0 2 shows a large gain exceeding that of the surface foundations at large p this is because although the soil beneath the skirt tip has a lower increase in shear strength the additional improvement in soil strength due to consolidation confined within the periphery skirt is mobilised under the moment loading at failure after consolidation this tendency does not remain with increasing d d 7 concluding remarks a set of comprehensive finite element analyses were conducted to investigate the post preload undrained uniaxial capacity of the skirted circular foundation on normally consolidated clay the influences of the level of preloading the foundation aspect ratio the initial soil strength heterogeneity and the duration of consolidation are observed the main conclusions are non uniform increases in the uniaxial capacities in v h and m for a given level of preload and consolidation time is attributed to the volume of consolidated soil encompassed by the failure mechanism the level of preloading reflects the magnitude of soil deformation in the consolidation soil region elastic compression dominates soil behaviour at low p lower than 10 while the plastic compression dominates at higher p larger than 10 the resultant preloading gains follow an approximately bilinear relationship against the magnitude of vertical preload higher soil strength heterogeneity results in shallower soil being mobilised at failure which shows larger increases in undrained shear strength due to consolidation larger gains are associated with shorter skirt length because the periphery skirt transfers the vertical preload to deeper soil already more competent soil a series of equations is proposed to evaluate the full consolidated gains in uniaxial undrained capacities under preloading a further extension incorporates the entire consolidation history and a method to estimate the post preload uniaxial capacities for any given p d d and kd s u0 after a period of consolidation is proposed finally this study has neglected a range of complexities such as skirted foundation roughness over consolidation ratio and soil model sensitivity these influences might be analysed independently to gauge the significance of foundation preloading issues however the general conclusion here will be useful for many practical foundation designs acknowledgements this work forms part of the activities of the centre for offshore foundation systems cofs which is supported by the lloyd s register foundation as a centre of excellence and now forms one of the primary nodes of the australian research council arc centre of excellence for geotechnical science and engineering lloyd s register foundation invests in science engineering and technology for public benefit worldwide notation c v0 initial in situ coefficient of consolidation at the skirt tip level d skirt length d d aspect ratio d diameter of skirted circular foundation e 0 initial void ratio e cs intercepts of the critical state line csl with the compression plane at p 1 kpa h general term for horizontal load k shear strength gradient kd s u0 undrained shear strength heterogeneity kd s um non dimensional undrained shear strength gradient k s coefficient of permeability k 0 coefficient of lateral earth pressure m v coefficient of volume compressibility m general term for moment load m s gradient of critical state line csl in the p qd plane n fitting parameter n c undrained uniaxial capacity factor n c r ratio of the capacity factor for a skirted circular foundation divided by that for a circular foundation n c r homo ratio of the capacity factor for a skirted circular foundation divided by that for a circular foundation on homogeneous soil n c r nc soil ratio of the capacity factor for a skirted circular foundation divided by that for a circular foundation on normally consolidated soil p 0 initial mean normal effective stress p c0 pre consolidation pressure hardening parameter p cs mean normal effective stress at the failure state q a general term for undrained ultimate vertical horizontal and moment load s u undrained shear strength s u0 initial undrained shear strength at the skirt tip level s um initial undrained shear strength at the mudline t 50 fitting parameter t v normalised consolidation time factor u normalised preloading gain v general term for vertical load δh absolute preloading enhancement in undrained horizontal capacities δm absolute preloading enhancement in undrained moment capacities δv absolute preloading enhancement in undrained vertical capacities δq general term of absolute preloading enhancement in undrained vertical horizontal and moment capacities η general term of preloading gains γ w water unit weight γ submerged unit weight of the soil θl lode angle κ swelling and recompression index λ virgin compression index σ v vertical effective stress ϕ tc critical friction angle in triaxial compression 
23734,in may 2015 a shallow water acoustic variability experiment savex15 was conducted in the northeastern east china sea surprisingly an underwater sound channel that is typical for deep water was discovered in this shallow water waveguide 100 m deep with the channel axis at around 40 m for a broad band source 0 5 2 0 khz deployed close to the channel axis channel impulse responses observed by a vertical array exhibited a complex arrival structure with a large delay spread e g 160 milliseconds most arrivals are found to be surface and bottom reflected while a pair of high intensity refracted arrivals are embedded in the early reflected arrivals broadband simulations based on a normal mode propagation model show good agreement with data keywords east china sea underwater sound channel channel impulse response savex15 1 introduction the east china sea ecs and surrounding area is an extremely complex region from the perspective of oceanography hydrography and bathymetry in turn the internal wave activity within this region also is extremely complex cho et al 2016a lee et al 2006 within the ecs there are several mechanisms for generating internal waves including tidal and wind forcing forcing by the kuroshio tsushima and yellow sea circular currents upwelling induced by the intrusion of the kuroshio across the continental shelf mostly in the southern region near taiwan and freshwater discharged from the yangtze river as illustrated in fig 1 a bathymetry is also an important factor in internal wave generation propagation and dissipation the variability in the sound speed field due to internal wave perturbations along with strong currents in the ecs impacts significantly the variability of the acoustic field over various time scales smith 2010 as a collaborative research effort between the us and rok republic of korea a shallow water acoustic variability experiment savex15 was conducted in the northeastern ecs in may 2015 the goal of savex15 was to obtain acoustic and environmental data appropriate for studying the coupling of oceanography acoustics and underwater communications in the region a surprising aspect of the oceanography was the revelation of an underwater sound channel usc persistent in this shallow water waveguide 100 m deep with the channel axis at around 40 m in this letter we present preliminary results investigating the impact of the usc on acoustic propagation in the ecs using both data and a propagation model in the low to mid frequency band 0 5 2 0 khz the paper is organized as follows section 2 describes the savex15 experiment along with sound speed profiles in section 3 channel impulse responses cirs captured by a vertical array at 3 5 km range during a source tow run is presented for a modest broadband source 0 5 2 0 khz deployed to about 50 m depth indicating a large delay spread of approximately 160 ms the arrival structure of the cir is analyzed in section 4 using a normal mode propagation model and its dispersion characteristics followed by a summary in section 5 2 savex15 the savex15 experiment was conducted 14 28 may 2015 in the northeastern ecs 100 km southwest of jeju island using the research vessel r v onnuri the experimental site denoted by a solid ellipse in fig 1a was a nearly at sandy bottom with water depth of approximately 100 m both fixed and towed source transmissions were carried out to two moored receiving arrays over ranges of 1 10 km the acoustic transmissions were in various frequency bands covering 0 5 32 khz and included both channel probing waveforms as well as communication transmissions environmental data collected included water column sound speed structure sea surface directional wave field and local wind speed and direction sound speed profiles ssps are displayed in fig 1b they were obtained from both standard ctd conductivity temperature and depth and underway ctd uctd data the uctd is a rapid profiling ctd system that provides high quality profiles during ship s transit up to 20 kts ullman and herbert 2014 a calibration test was conducted against the more accurate ctd as a precaution and showed good agreement between the two fig 1c over the duration of the experiment we collected a total of 1062 uctd profiles as compared to just 26 ctd profiles in grey color the mean profiles of ctd dashed and uctd solid are similar except near the surface fig 1b clearly the ssps indicate an underwater sound channel usc with the channel axis at around 40 m almost symmetric with respect to the channel axis in 100 m deep water the maximum sound speed difference between the sound channel and surface seafloor is about 15 m s this type of usc is called thermal due mainly to the increase in temperature below the channel axis fig 1c in contrast the usc in deep water commonly referred to as the dsc deep sound channel or sofar sound fixing and ranging channel is due to the increase in hydrostatic pressure a thermal usc also is observed during the summer may sep in the shallow southern baltic sea grelowska 2000 and yellow sea lee 1992 however a recent analysis of historical hydrographic data collected over 50 years 1962 2011 in the northeastern ecs cho et al 2016a did not show such characteristics of an usc and we are not aware of any previous report on an usc in the northeastern ecs the formation of the usc is currently under investigation which is beyond the scope of this paper 3 acoustic propagation in usc to investigate the impact of the usc on acoustic propagation in shallow water we analyze the data collected during a source tow run on jd 146 may 26 the schematic of the source tow run is illustrated in fig 2 a a broadband source 0 5 2 0 khz called seanos was deployed to about 50 m depth close to the channel axis 40 m and towed by the r v onnuri mostly at a speed of 4 knots 2 m s along a specified ship track the seanos source level sl was 165 db re μpa 1 m an assortment of channel probing waveforms and communication sequences from participating institutions was put together to form a 4 min long single transmission which was repeated every 5 min from the towed source in this letter we focus on a 10 s data packet that consisted of a 100 ms 0 5 2 0 khz linear frequency modulated lfm chirp as a channel probe followed by a 9 s long bpsk binary phase shift keying communication sequence at a carrier frequency of 1 25 khz and a symbol rate of 1 khz throughout the experiment two identical vertical line arrays vlas separated by about 5 5 km in range were moored for stable operation each vla consisted of 16 elements spanning a 56 25 m aperture with 3 75 m element spacing covering about half the water column from 25 to 81 m in about 100 m deep water one of the vlas was selected here to process the data transmitted at 16 40 utc approximately at 3 5 km range from the seanos approaching the vla in fig 2a the doppler shift was estimated as fd 1 89 hz and applied to resampling doppler compensation of the communication sequence for time varying channel estimation song 2013 in section 4 fig 4 the channel impulse response estimated using the lfm channel probe is displayed in fig 3a after matched filtering the horizontal axis is a relative time of arrival after subtraction of 2 333 s corresponding to the approximate travel time for a source at 3 5 km range and the dynamic range is 30 db there are strong early arrivals at around t 20 ms the arrival structure appears complicated with many distinct paths for the modest source level 165 db to better understand the observed data broadband simulations are presented in section 4 using a normal mode propagation model assuming a range independent environment jensen et al 2011 unfortunately there were no concurrent uctd measurements during this source tow run and thus three ctd casts conducted before and after the run are averaged for the ssp in fig 2b featuring an asymmetrical usc with the channel axis at 40 m the seafloor is modeled as a simple two layer geoacoustic system with a 0 5 m thick sand sediment overlying a half space density 1 5 1 97 g cm3 compressional sound speed 1600 1800 m s and compressional wave attenuation 0 6 0 94 db wavelength respectively ryang et al 2013 4 simulation results the group slowness sg versus phase slowness sp curve corresponding to the ssp in fig 2b is illustrated in fig 2c at the carrier frequency of 1 25 khz or equivalently group speed vg 1 sg versus phase speed vp 1 sp on the horizontal axis the mode number or phase speed increases from the right towards the left the modes can be divided into two different groups depending on the phase speed vp i high order modes vp 1505 m s and ii low order modes vp 1505 m s note that the phase speed vp 1505 m s corresponds approximately to the sound speed of the bounding region of the usc in fig 2b vertical dotted line the group i modes behave like those in an ideal waveguide cho et al 2016b with the waveguide invariant β 1 where β is defined by 1 β d 1 v g d 1 v p d s g d s p the inverse of the negative slope dashed line for group i modes in fig 2c is estimated as β 1 02 being close to unity thus group i modes are surface bottom reflected paths as ones in an ideal waveguide and fig 3c represents the simulated cir containing group i modes alone the delay spread of the channel e g 160 ms is determined by the group speeds of the lowest and highest reflected modes along the dashed line in fig 2c contributing to the acoustic field for model and data comparison fig 3c model is aligned against fig 3a data to best match the reflected arrivals on the other hand the low order modes in group ii are refracted water borne paths with a similar group speed and a high intensity the simulated cir containing modes in group ii alone is shown in fig 3d confirming that the acoustic energy is trapped mostly around the sound channel axis 40 m and clustered around t 15 ms with a delay spread of about 10 ms it should be pointed out however that the corresponding high intensity arrivals in the data fig 3a indicate a more compact structure with a single group of arrivals compared to apparently two groups in fig 3d the difference likely is due to the averaged ssp used for modeling not capturing the details of the actual ssp present during data collection within the group ii refracted modes higher order modes propagate faster than lower order modes comparing fig 3c and d most reflected paths of group i are slower than the refracted paths of group ii except for a few earlier arrivals i e t 15 ms in fig 3c by including all the modes i e combining fig 3c and d we obtain a simulated cir in fig 3b which shows good agreement with the data fig 3a in terms of the arrival structure albeit some notable differences in particular the simulated arrivals in b and c remain strong up to 150 ms vis a vis the data counterparts in a which gradually diminish over time and are barely visible around 150 ms this can be attributed to the fact that the higher order modes of group i with steeper propagation angles and slower group speeds are significantly attenuated due to many interactions with rough boundaries together with uncertainties in the bottom attenuation and model for the simulations in b and c the maximum phase speed of propagation was set to vp 1600 m s which corresponds to a source launch angle of about 20 finally the temporal evolution of the cirs is shown in fig 4 using the 9 s bpsk communication sequence and lms least mean squares adaptive algorithm song 2016 at four representative receiver depths from top to bottom 25 m ch 1 40 m ch 5 59 m ch 10 and 81 m ch 16 each panel is normalized separately with respect to its peak value and has the same dynamic range of 20 db these plots are useful for identifying the large number of arrivals closely spaced in delay time ch 5 corresponds to the channel axis with a high intensity arrival at around t 20 ms which is from the group ii refracted low order modes a similar strong refracted arrival also can be found in ch 1 and ch 10 but appears a bit earlier e g 2 ms than the arrival in ch 5 indicating that it is still from the group ii but higher order modes most of weak reflected arrivals from group i then follow the strong refracted arrival in ch 1 and ch 10 as the receiver moves away from the channel axis especially towards the lower edge of the usc due to its asymmetry the number of arrivals tends to increase along with an increasing delay spread the bottom receiver ch 16 at the lower edge of the usc shows a large number of arrivals that are all reflected paths from group i resulting in a large delay spread of up to 160 ms 5 summary the savex15 experiment conducted in the northeastern ecs revealed an usc with the channel axis around 40 m in 100 m deep water the impact of the usc on acoustic propagation in shallow water was investigated using data from a vertical array moored at 3 5 km range from a modest broadband 0 5 2 0 khz source deployed around the channel axis broadband simulations based on a normal mode propagation model showed good agreement with the data it was found that most of the arrivals are surface and bottom reflected paths as ones in an ideal waveguide while a pair of high intensity refracted arrivals are embedded in the early reflected arrivals the large delay spread 160 ms with a large number of paths implies a long reverberation time in the northeastern ecs in the low to mid frequency band acknowledgements this work was jointly supported by the us office of naval research under grant no n00014 13 1 0510 korea research institute of ships and ocean engineering pes1940 and korea institute of ocean science and technology pe99531 in addition s nam was partly supported by national research foundation funded by the korean ministry of education via sger program nrf 2015r1d1a1a02062252 this work was a part of the project titled deep water circulation and material cycling in the east sea and construction of ocean research station and their application studies funded by the ministry of oceans and fisheries korea 
23734,in may 2015 a shallow water acoustic variability experiment savex15 was conducted in the northeastern east china sea surprisingly an underwater sound channel that is typical for deep water was discovered in this shallow water waveguide 100 m deep with the channel axis at around 40 m for a broad band source 0 5 2 0 khz deployed close to the channel axis channel impulse responses observed by a vertical array exhibited a complex arrival structure with a large delay spread e g 160 milliseconds most arrivals are found to be surface and bottom reflected while a pair of high intensity refracted arrivals are embedded in the early reflected arrivals broadband simulations based on a normal mode propagation model show good agreement with data keywords east china sea underwater sound channel channel impulse response savex15 1 introduction the east china sea ecs and surrounding area is an extremely complex region from the perspective of oceanography hydrography and bathymetry in turn the internal wave activity within this region also is extremely complex cho et al 2016a lee et al 2006 within the ecs there are several mechanisms for generating internal waves including tidal and wind forcing forcing by the kuroshio tsushima and yellow sea circular currents upwelling induced by the intrusion of the kuroshio across the continental shelf mostly in the southern region near taiwan and freshwater discharged from the yangtze river as illustrated in fig 1 a bathymetry is also an important factor in internal wave generation propagation and dissipation the variability in the sound speed field due to internal wave perturbations along with strong currents in the ecs impacts significantly the variability of the acoustic field over various time scales smith 2010 as a collaborative research effort between the us and rok republic of korea a shallow water acoustic variability experiment savex15 was conducted in the northeastern ecs in may 2015 the goal of savex15 was to obtain acoustic and environmental data appropriate for studying the coupling of oceanography acoustics and underwater communications in the region a surprising aspect of the oceanography was the revelation of an underwater sound channel usc persistent in this shallow water waveguide 100 m deep with the channel axis at around 40 m in this letter we present preliminary results investigating the impact of the usc on acoustic propagation in the ecs using both data and a propagation model in the low to mid frequency band 0 5 2 0 khz the paper is organized as follows section 2 describes the savex15 experiment along with sound speed profiles in section 3 channel impulse responses cirs captured by a vertical array at 3 5 km range during a source tow run is presented for a modest broadband source 0 5 2 0 khz deployed to about 50 m depth indicating a large delay spread of approximately 160 ms the arrival structure of the cir is analyzed in section 4 using a normal mode propagation model and its dispersion characteristics followed by a summary in section 5 2 savex15 the savex15 experiment was conducted 14 28 may 2015 in the northeastern ecs 100 km southwest of jeju island using the research vessel r v onnuri the experimental site denoted by a solid ellipse in fig 1a was a nearly at sandy bottom with water depth of approximately 100 m both fixed and towed source transmissions were carried out to two moored receiving arrays over ranges of 1 10 km the acoustic transmissions were in various frequency bands covering 0 5 32 khz and included both channel probing waveforms as well as communication transmissions environmental data collected included water column sound speed structure sea surface directional wave field and local wind speed and direction sound speed profiles ssps are displayed in fig 1b they were obtained from both standard ctd conductivity temperature and depth and underway ctd uctd data the uctd is a rapid profiling ctd system that provides high quality profiles during ship s transit up to 20 kts ullman and herbert 2014 a calibration test was conducted against the more accurate ctd as a precaution and showed good agreement between the two fig 1c over the duration of the experiment we collected a total of 1062 uctd profiles as compared to just 26 ctd profiles in grey color the mean profiles of ctd dashed and uctd solid are similar except near the surface fig 1b clearly the ssps indicate an underwater sound channel usc with the channel axis at around 40 m almost symmetric with respect to the channel axis in 100 m deep water the maximum sound speed difference between the sound channel and surface seafloor is about 15 m s this type of usc is called thermal due mainly to the increase in temperature below the channel axis fig 1c in contrast the usc in deep water commonly referred to as the dsc deep sound channel or sofar sound fixing and ranging channel is due to the increase in hydrostatic pressure a thermal usc also is observed during the summer may sep in the shallow southern baltic sea grelowska 2000 and yellow sea lee 1992 however a recent analysis of historical hydrographic data collected over 50 years 1962 2011 in the northeastern ecs cho et al 2016a did not show such characteristics of an usc and we are not aware of any previous report on an usc in the northeastern ecs the formation of the usc is currently under investigation which is beyond the scope of this paper 3 acoustic propagation in usc to investigate the impact of the usc on acoustic propagation in shallow water we analyze the data collected during a source tow run on jd 146 may 26 the schematic of the source tow run is illustrated in fig 2 a a broadband source 0 5 2 0 khz called seanos was deployed to about 50 m depth close to the channel axis 40 m and towed by the r v onnuri mostly at a speed of 4 knots 2 m s along a specified ship track the seanos source level sl was 165 db re μpa 1 m an assortment of channel probing waveforms and communication sequences from participating institutions was put together to form a 4 min long single transmission which was repeated every 5 min from the towed source in this letter we focus on a 10 s data packet that consisted of a 100 ms 0 5 2 0 khz linear frequency modulated lfm chirp as a channel probe followed by a 9 s long bpsk binary phase shift keying communication sequence at a carrier frequency of 1 25 khz and a symbol rate of 1 khz throughout the experiment two identical vertical line arrays vlas separated by about 5 5 km in range were moored for stable operation each vla consisted of 16 elements spanning a 56 25 m aperture with 3 75 m element spacing covering about half the water column from 25 to 81 m in about 100 m deep water one of the vlas was selected here to process the data transmitted at 16 40 utc approximately at 3 5 km range from the seanos approaching the vla in fig 2a the doppler shift was estimated as fd 1 89 hz and applied to resampling doppler compensation of the communication sequence for time varying channel estimation song 2013 in section 4 fig 4 the channel impulse response estimated using the lfm channel probe is displayed in fig 3a after matched filtering the horizontal axis is a relative time of arrival after subtraction of 2 333 s corresponding to the approximate travel time for a source at 3 5 km range and the dynamic range is 30 db there are strong early arrivals at around t 20 ms the arrival structure appears complicated with many distinct paths for the modest source level 165 db to better understand the observed data broadband simulations are presented in section 4 using a normal mode propagation model assuming a range independent environment jensen et al 2011 unfortunately there were no concurrent uctd measurements during this source tow run and thus three ctd casts conducted before and after the run are averaged for the ssp in fig 2b featuring an asymmetrical usc with the channel axis at 40 m the seafloor is modeled as a simple two layer geoacoustic system with a 0 5 m thick sand sediment overlying a half space density 1 5 1 97 g cm3 compressional sound speed 1600 1800 m s and compressional wave attenuation 0 6 0 94 db wavelength respectively ryang et al 2013 4 simulation results the group slowness sg versus phase slowness sp curve corresponding to the ssp in fig 2b is illustrated in fig 2c at the carrier frequency of 1 25 khz or equivalently group speed vg 1 sg versus phase speed vp 1 sp on the horizontal axis the mode number or phase speed increases from the right towards the left the modes can be divided into two different groups depending on the phase speed vp i high order modes vp 1505 m s and ii low order modes vp 1505 m s note that the phase speed vp 1505 m s corresponds approximately to the sound speed of the bounding region of the usc in fig 2b vertical dotted line the group i modes behave like those in an ideal waveguide cho et al 2016b with the waveguide invariant β 1 where β is defined by 1 β d 1 v g d 1 v p d s g d s p the inverse of the negative slope dashed line for group i modes in fig 2c is estimated as β 1 02 being close to unity thus group i modes are surface bottom reflected paths as ones in an ideal waveguide and fig 3c represents the simulated cir containing group i modes alone the delay spread of the channel e g 160 ms is determined by the group speeds of the lowest and highest reflected modes along the dashed line in fig 2c contributing to the acoustic field for model and data comparison fig 3c model is aligned against fig 3a data to best match the reflected arrivals on the other hand the low order modes in group ii are refracted water borne paths with a similar group speed and a high intensity the simulated cir containing modes in group ii alone is shown in fig 3d confirming that the acoustic energy is trapped mostly around the sound channel axis 40 m and clustered around t 15 ms with a delay spread of about 10 ms it should be pointed out however that the corresponding high intensity arrivals in the data fig 3a indicate a more compact structure with a single group of arrivals compared to apparently two groups in fig 3d the difference likely is due to the averaged ssp used for modeling not capturing the details of the actual ssp present during data collection within the group ii refracted modes higher order modes propagate faster than lower order modes comparing fig 3c and d most reflected paths of group i are slower than the refracted paths of group ii except for a few earlier arrivals i e t 15 ms in fig 3c by including all the modes i e combining fig 3c and d we obtain a simulated cir in fig 3b which shows good agreement with the data fig 3a in terms of the arrival structure albeit some notable differences in particular the simulated arrivals in b and c remain strong up to 150 ms vis a vis the data counterparts in a which gradually diminish over time and are barely visible around 150 ms this can be attributed to the fact that the higher order modes of group i with steeper propagation angles and slower group speeds are significantly attenuated due to many interactions with rough boundaries together with uncertainties in the bottom attenuation and model for the simulations in b and c the maximum phase speed of propagation was set to vp 1600 m s which corresponds to a source launch angle of about 20 finally the temporal evolution of the cirs is shown in fig 4 using the 9 s bpsk communication sequence and lms least mean squares adaptive algorithm song 2016 at four representative receiver depths from top to bottom 25 m ch 1 40 m ch 5 59 m ch 10 and 81 m ch 16 each panel is normalized separately with respect to its peak value and has the same dynamic range of 20 db these plots are useful for identifying the large number of arrivals closely spaced in delay time ch 5 corresponds to the channel axis with a high intensity arrival at around t 20 ms which is from the group ii refracted low order modes a similar strong refracted arrival also can be found in ch 1 and ch 10 but appears a bit earlier e g 2 ms than the arrival in ch 5 indicating that it is still from the group ii but higher order modes most of weak reflected arrivals from group i then follow the strong refracted arrival in ch 1 and ch 10 as the receiver moves away from the channel axis especially towards the lower edge of the usc due to its asymmetry the number of arrivals tends to increase along with an increasing delay spread the bottom receiver ch 16 at the lower edge of the usc shows a large number of arrivals that are all reflected paths from group i resulting in a large delay spread of up to 160 ms 5 summary the savex15 experiment conducted in the northeastern ecs revealed an usc with the channel axis around 40 m in 100 m deep water the impact of the usc on acoustic propagation in shallow water was investigated using data from a vertical array moored at 3 5 km range from a modest broadband 0 5 2 0 khz source deployed around the channel axis broadband simulations based on a normal mode propagation model showed good agreement with the data it was found that most of the arrivals are surface and bottom reflected paths as ones in an ideal waveguide while a pair of high intensity refracted arrivals are embedded in the early reflected arrivals the large delay spread 160 ms with a large number of paths implies a long reverberation time in the northeastern ecs in the low to mid frequency band acknowledgements this work was jointly supported by the us office of naval research under grant no n00014 13 1 0510 korea research institute of ships and ocean engineering pes1940 and korea institute of ocean science and technology pe99531 in addition s nam was partly supported by national research foundation funded by the korean ministry of education via sger program nrf 2015r1d1a1a02062252 this work was a part of the project titled deep water circulation and material cycling in the east sea and construction of ocean research station and their application studies funded by the ministry of oceans and fisheries korea 
