index,text
22805,the value of ship automatic identification system ais data coexists with data noises whereas a tangible noise elimination method plays an important role in data mining in this study we first address the big ship ais data de noising issue for the 43 million records from 15 legs in the singapore strait in which ship position speed and course data are checked and corrected by our proposed method i moreover a winding number based method ii is developed to select data within irregularly restricted water areas based on these data we particularly design a search and cut method iii to filter out ships that pass through an l turning two or more neighboring legs forming a curved channel in this study speeds are normally distributed within a certain range according to the real ais data in the singapore strait three types of waters i e legs l turnings and the whole strait are compared the results indicate that ship speeds in l turnings are more normally distributed than the speeds in legs and the entire strait in the singapore strait ship speeds slow down by 5 26 14 4 to pass through l turnings approximately moreover our tangible method iv of identifying ship decelerating processes from a large number of navigational data indicates that changes in ship speed of an l turning have the least relationship with ship types or lengths however we find that the longer the length of the ship 1 the longer the decelerating time 2 the smaller the deceleration and 3 the smaller the course changing rate keywords singapore strait l turning ship ais data data modeling and analysis ship speed density flow 1 introduction the singapore strait is a relatively narrow and a busy waterway used by all types of ships including very large crude carriers ferries container ships and oil tankers it is no exaggeration to say the importance of the singapore strait since it carries one third of the world s traded goods approximately and connects more than 120 counties singapore 2014 in view of its significance it is of practical importance to investigate the ship traffic problems in the singapore strait which can provide useful solutions for the maritime governors to manage the strait s traffic effectively as well as the singapore port s operations efficiently the singapore strait extends over 105 km from the straits of malacca in the west to the south china sea in the east and its minimum width is 16 km approximately the strait consists of 15 legs divided by sigtto 2008 based on the structure and various traffic conditions of each leg as well as the consideration of the geographic locations of different ship terminals as shown in fig 1 the strait provides deep water access allowing vessels with a draught of 26 m and tankers of 200 000 dwt to the port of singapore and over 2 000 merchant ships traverse the water areas on a daily basis the online port information specialists 2018 among these 15 legs seven legs numbered w1 w7 direct from west to east and eight legs numbered e8 e15 direct from east to west as shown in fig 1 to put forward the research object of this study the following definition 1 of l turning is presented definition 1 two neighboring legs intersect with an angle between 0 and 160 forming an l shaped channel for ships navigating that is referred to as an l turning in this study as introduced a strait consists of a number of legs and these legs form a certain number of l turnings for example there are four l turnings in the singapore strait which will be introduced in detail in the following context as shown in fig 1 compared with straight legs ships passing through l turnings tend to have various characteristics for example variables of deceleration acceleration and changing courses moreover due to the different navigational conditions in each leg e g different widths of legs in an l turning and time variant ship flows different navigators may have various navigating behaviors so that the ship traffic capacity of the strait will be affected therefore it is necessary to find such relationships for the busy shipping corridors such as the singapore strait because traffic conditions in these straits are vital to the global logistics industry according to qu and meng 2012 for example daily loss of blockade in the singapore strait for the global maritime transportation is as much as 10 million usd 1 1 relevant studies ship traffic analyses support valuable knowledge for the maritime traffic control and management such as liner shipping sailing speed limits and traffic separation schemes wang et al 2013 zhang et al 2015 lu et al 2018 traditional methods of ship traffic analysis usually include ship traffic surveys such as manual observation radar detection and airborne photography zhang et al 2017 the first ship traffic survey was conducted in japan 1963 by means of statistics of ship traffic flow and accidents to estimate ship traffic capability and support ship traffic control recently advanced methods of ship traffic data collection such as the automatic identification system ais and vessel traffic services vts have been widely developed merrick and van dorp 2006 the ais data based ship traffic analytical methods are more accurate since the data precisely record ship navigational processes shelmerdine 2015 which can be used to model vessel navigation based on observations of ais data based on the ship ais data some empirical studies have analyzed ship traffic using ais data to improve port operations for example through proposing dynamic berth allocations and robust tugboat scheduling plans wu et al 2018 developed an ais data based method of studying travel behavior of vessels when they pass through a hotspot in a narrow inland waterway it is a novel trip information building method which can reveal the travel patterns of vessels passing through narrow waterways and also examine the risk of vessel collisions at the hotspots moreover two popular research branches of the existing studies contribute to reducing ship engine exhaust emissions goldsworthy and goldsworthy 2015 and preventing avoiding ship accidents hanninen and kujala 2012 wu et al 2016 zhang et al 2019 air quality and ship emissions data driven environmental issues e g air emissions and water pollution associated with ships are increasing in the literature air emissions can be described and modeled according to the shipping data transformed by ais including ship type speed operation mode sea condition etc for example ng et al 2013 developed a detailed activity based marine emission inventory for ships by considering ship speed and ship operation mode based on the ais data they reduced the complexity of air emission models similarly an activity based emission model was formulated by mölders et al 2013 to calculate the ship cruising emissions two types of data are utilized from the ais ship cruising data position speed and the operation mode and ship characteristics data engine power ship size fuel type and maximum cruising speed for more information interested readers can refer to robards et al 2016 based on the above studies we can say the ais data open new windows for calculating accurate air emissions and environmental impacts for shipping ship accident analysis and prevention despite the increase in ship traffic and ship size the rate of ship accidents has declined overall and one of the most harmful issues to the society death toll has reduced significantly fields 2014 however according to harati mokhtari et al 2007 around 84 of accidents were attributed to human errors and could be avoided with the aid of ais or other techniques moreover the potential risks to the environment and property losses grow with the increase of vessel sizes recently shipping routes hazard identification and risk evaluation can be estimated by using the historical ais data talavera et al 2013 zaman et al 2014 kang et al 2019 this is an off line estimation for the real time risk assessment silveira et al 2013 defined overall collision candidates by predicting future distances between any two ships with their current positions courses and speeds and comparing those distances with a predefined collision threshold similarly weng et al 2012 estimated the number of ship conflicts and the causation probability by using the real time ship ais data to conclude ais data based analysis of ship traffic contributes to both preventing accidents and making informed decisions on fairway design traffic separation schemes and disposition of emergency services 1 2 research objectives our thorough literature review via the academic search engines shows that the ship traffic problems when ships passing through l turnings as well as the methodologies of using the big ais data for solving these problems have not yet been investigated in the literature in this study we thus try to address the following four problems for the ship traffic in the singapore strait from a big ais data perspective 1 ship speed distributions affect the ship traffic capacity of a strait are ship speeds in the singapore strait subject to a certain distribution we compare three scenarios under the normal distribution leg l turning and strait cases 2 do l turnings in the singapore strait characterized by their corners and lengths have any impacts on ship navigation we try to describe such impacts in quantification in terms of ship acceleration deceleration and course changing 3 do different types and lengths of ships passing through the l turning have various sailing characteristics we propose a tangible method to identify ship accelerating decelerating processes when passing through the l turnings from the big ship ais data pool and conduct analysis for different ships 4 will l turnings affect the ship traffic capacity of a strait we demonstrate such impacts by introducing the fundamental diagram of ship traffic in the singapore strait the remainder of this study is organized as follows in section 2 we present the research methodology including ship ais data checking method winding number method and l turning s ship selection method comparisons of ship speeds in the singapore strait and of passing through l turnings are made in section 3 detailed analyses of ships sailing in l turnings are conducted in section 4 section 5 presents the calculation of ship traffic capacity of each l turning and section 6 concludes this study 2 methodology 2 1 ship ais data checking a complete piece of ship ais data at least includes the following messages ship id ship type position course speed heading drought navigation status dimension of bow dimension of stern dimension of port and dimension of starboard shu et al 2017 kang et al 2018 as shown in fig 2 the first two messages are for ship identifications the third to sixth messages indicate ship navigation parameters the seventh and eighth messages provide the strait environment and the last four messages tell the ship physical information however three important ais messages related to each ship with an interval time of less than 10 s ship id position and speed are sufficient for this study in general ship identification and navigation messages provided by the ais technique are highly reliable however ship position course and speed data are not immune to errors during the transmission from ships to the nearby ais bases for example the singapore strait has its boundaries that identify the longitude and latitude of each ship moving in the strait due to the ship initial turning ability course span of two consecutive records of each ship is within a certain range moreover ship speed in the singapore strait is also limited taking into account the safety of navigation hence errors or unreasonable data in the ais database should be identified and revised according to certain practical rules prior to presenting the method checking and revising the ais data we define the following notations for the real ais database let s be the ship id s s and t be the time t t for each ship s at time t x t s represents the longitude y t s denotes the latitude v t s signifies the speed and c t s shows the navigating course the international hydrographical organization defines the bounds of the singapore strait with respect to longitude as 103 350 e to the west min x 103 350 and 104 583 e to the east max x 104 583 as well as latitude 1 027 n to the south min y 1 027 and 1 422 n to the north max y 1 422 in addition considering the speed limit in the singapore strait and the real ais data we set a lower speed bound min v 5 knots and an upper speed bound max v 25 knots qu et al 2011 qu and meng 2012 in terms of ship turning we refer to the ship course difference between two consecutive ais records of each ship i e min δ c 5 and max δ c 5 with the above definitions the ais data checking and revising method i is proposed in detail as follows method i ais data checking and revising step 1 checking and revising the longitude data check ship longitude data according to eq 1 if longitude x t s does not meet the lower or upper bounds then we revise it based on eq 2 where time t is the preceding time of t and t is the following time of t in the ais records i e t t t note that this step aims to check and revise minor data errors caused by transformation considering the high reliability of ais data 1 min x x t s max x s s t t 2 x t s x t s x t s t t t t step 2 checking and revising the latitude data similar to the longitude we check ship latitude data according to the lower and upper bounds in eq 3 if latitude y t s does not meet condition 3 then we revise it based on eq 4 3 min y y t s max y s s t t 4 y t s y t s y t s t t t t step 3 checking and revising the speed data ship speed is supposed to be continuous and checked by the lower and upper bounds in eq 5 if speed v t s does not meet condition 5 then we revise it based on eq 6 where g t is the function of speed versus time between times t and t note that speed change here is recognized as a continuous process and g t can be obtained by the existing speed data with linear data fitting 5 min v v t s max v s s t t 6 v t s t t g v d v step 4 checking and revising the course data similarly ship course changing is also continuous and we check ship course data according to eq 7 if course c t s does not meet condition 7 then we revise it based on eq 8 where h t is the function of course versus time between times t and t 7 min δ c c t s c t 1 s max δ c s s t t 8 c t s t t h c d c this is the end of method i here we take ship id 218284000 in table 1 for instance records in the third row including longitude latitude speed and course of ship 218284000 at time 8 00 12 are not correct after checking against eqs 1 3 5 and 7 by using the proposed data revising method revised records are updated in the fourth row after the ship ais data checking and revising processes data noises are basically eliminated according to our statistics there are about 383 990 data points updated by the procedure accounting for 8 93 of the total data approximately based on our observation the errors do not have any clear distribution over time or geographic locations however legs w7 and e10 have the most and least data errors accounting for 2 01 and 0 085 of the total records respectively 2 2 the winding number based method this study focuses on the l turnings in the singapore strait thus the ais data studied should be within the restricted areas herein we use the winding number method to select the target data the winding number precisely shows whether a point is in an irregularly closed curve or not and it is defined as the total number of times that curve travels counterclockwise around the point that is if the curve does not wind around a point then the rounded winding number equals zero and thus the point is outside the curve mathematically let w n p v represent the winding number of any non simple closed curve v around a point p note that p is not on v consider v as a continuous curve in fig 3 consisting of a large number of points x u y u 0 u 1 as shown in eq 9 let v 0 v 1 in a plane 9 v u v x u y u 0 u 1 moreover we define a vector v p u from p to v u in eq 10 the unit vector of v p u in eq 11 thus maps the point v u to the vector v p u on the unit circle o x y x 2 y 2 1 this mapping notes as w p by eq 12 which however can be represented in a polar coordinate system by eq 13 10 v p u v u p 0 u 1 p v 11 v p u v p u v p u 0 u 1 p v 12 w p v o p v 13 w p u cos θ u sin θ u 0 u 1 p v where θ u represents a positive counterclockwise angle in radians the winding number w n p v therefore equals the number of times that w p wraps v around o which can be obtained by the integral 14 w n p v 1 2 π d θ 1 2 π 0 1 θ u d u p v specifically when v is a polygon with the number of vertexes n the integral in eq 14 reduces to the sum of the angles that each edge v j v j 1 subtends with the point p x t s y t s 15 w n p v 1 2 π j 1 n θ j p v a strait s leg can be considered as a polygon and let v v 1 v 2 v j v n be the set of vertexes of the leg where v j represents the j t h vertex of the leg and v n 1 v 1 the longitude and latitude of the vertex v j are given and denoted by l o n v j and l a t v j respectively the position of the vertex v j is v j l a t v j l o n v j which transforms into a rectangular coordinate v j l a t v j l o n v j moreover as introduced x t s and y t s represent the longitude and latitude of ship s at time t respectively hence a point p x t s y t s represents the real position of ship s at time t in the strait and its rectangular coordinate is p x t s y t s to check whether point p x t s y t s is in a certain strait leg the following eq 16 calculates how many times the polygon winds around p x t s y t s 16 w n p v 1 2 π j 1 n arccos p v j p v j 1 p v j p v j 1 p v where p v j is the vector from points p x t s y t s to v j l a t v j l o n v j hence it is clear that point p x t s y t s is in the leg when r o u n d w n p v 0 otherwise r o u n d w n p v 0 note that r o u n d is the rounding operation for the winding number based on the above discussion we propose the winding number method as follows method ii winding number checking image 1 here we take leg w7 in the singapore strait for instance as fig 4 shows the terrestrial coordinates of the five vertexes are given and the rectangular coordinates are obtained by eq 17 in which ℜ represents the earth radius for ship position p x t s y t s 103 32 e 1 13 n in the figure r o u n d w n p v 1 thus ship position p x t s y t s is within leg w7 as to position p x t s y t s 103 38 e 1 17 n r o u n d w n p v 0 indicating that position p is beyond leg w7 17 v j l a t v j l o n v j ℜ cos l o n v j cos l a t v j ℜ sin l o n v j cos l a t v j to improve the checking efficiency the above winding number method can be applied to multiple legs at the same time for instance legs w1 and w2 forming an l turning can be considered as a six vertex polygon moreover the westbound of the singapore strait including the seven legs can also be linked together to a 22 vertex polygon therefore the above winding number checking is robust with the flexibility of choosing data size and polygon shape 2 3 selecting ships passing through two legs with the ship ais data checking and revising method i as well as the winding number based method ii ais data within a certain leg or legs are identified however these data showing ship trajectories may not pass through l turnings in other words these discrete points may only exist in a single leg hence an effective method of identifying ship data from 15 legs that pass through l turnings in the singapore strait should be presented firstly we pick up the four l turnings from the singapore strait see table 2 denoted as l w 1 w 2 l w 5 w 6 l e 8 e 9 and l e 14 e 15 as well as their clean data then the linear function of each intersecting line that cuts l turnings into two legs in terrestrial coordinates is proposed in eq 18 18 l w 1 w 2 g x 5 979 x 625 104 3232 x 104 3271 l w 5 w 6 g x 1 694 x 174 6 103 7269 x 103 7382 l e 8 e 9 g x 2 828 x 294 2 103 6475 x 103 6596 l e 14 e 15 g x 31 75 x 3311 104 3280 x 104 3288 where g x represents the fitting latitude with the given longitude x if one position x t s y t s of the ship s s in the ais database meets one of the functions in eq 18 i e g x t s y t s t t then we can say this ship has passed through the corresponding l turning note that the ais data may not be exactly on the intersecting line due to the interval of data transmission 5 10 s although the ship does pass through two legs hence we introduce an accuracy ε that is if the absolute difference between y t s real latitude and g x t s fitting latitude is less than ε then we consider this ship to pass through the l turning hence according to the above discussion a tangible and efficient searching method iii is proposed for the data in a restricted area to find ships passing through a certain l turning in the singapore strait for the sake of efficiency method iii will cut or delete the ship ids from the big data that have been identified this is called the search and cut method method iii search and cut method for selecting ships passing through l turnings image 2 3 ship sailing speed in the singapore strait and of passing through l turnings in this section ship sailing speeds as well as their distributions in the singapore strait are presented firstly based on the one week clean ais data from oct 1 to oct 7 2013 specifically we further filter out the data for ships that pass through the four l turnings and make comparisons with the overall data in the singapore strait it should be pointed out that the analysis here does not consider ship types or lengths we will factor in these two ship attributes in the analysis of the next section 3 1 from the perspective of the whole strait fig 5 illustrates the overall ship speed distribution in the singapore strait where the x axis shows speed data and the y axis presents the number of records under the speed note that ship speeds are filtered in a range of 5 25 knots as introduced the minimum and maximum speeds are 5 13 and 24 87 knots two times of speeding respectively with a mean speed of 15 knots we use four models to fit the data the linear model quadratic model polynomial nonlinear model and gaussian model the fitting results are given in eq 19 19 s s t t f v t s 49 81 v t s 1289 r 2 0 3533 r m s e 387 4 f v t s 6 859 v t s 2 155 4 v t s 21 78 r 2 0 5294 r m s e 331 3 f v t s 226 2 sin v t s π 5 907 v t s 10 2 875 4 r 2 0 6217 r m s e 295 5 f v t s 719 9 exp v t s 11 9568 5 065 2 r 2 0 7479 r m s e 216 3 to compare the regression we use two widely adopted indicators r 2 and rmse root mean squared error in eqs 20 and 21 respectively to evaluate the above four models note that values of r 2 are in a range of 0 1 and a larger value of r 2 indicates a better fitting performance of the model on the contrary the smaller the rmse the better the regression as observed the gaussian model outperforms the other three models according to the goodness of fit 20 r 2 1 t v t f 2 t v t t v t ω 2 21 r m s e 1 t v t f 2 ω in the singapore strait however the speed limit is 12 knots according to the data shape and gaussian curve as depicted in fig 5 around 50 of data points are speeding moreover as highlighted in the ellipse a majority number of ships sail around the limit speed signifying that navigators are aware of the limited speed in the following we formally transform the ship speed data into a standard normal distribution to calibrate the distribution of speeds fig 6 illustrates the quantiles of ship speed data y axis versus theoretical quantiles from a normal distribution x axis if the distribution of speed data is normal then the plot will be close to linear as observed speed data below 6 knots and above 18 knots significantly deviate from the dotted line the curve of speeds between 6 and 18 knots matches with the straight dotted line more specifically speed data in the range of 9 15 knots form a more exact normal distribution with the expected speed value of 11 96 knots approximately property 1 ship speed data in a restricted area obey normal distributions when they are divided into intervals the accepted interval α of these interval data is 22 σ f sin 2 arcsin f q i π 2 d α d s p μ σ f sin 2 arcsin f q i π 2 d α where α d s p μ parameters μ and σ are estimators in the normal distribution f and d α is the bound of a significant level of d s p at α michael 1983 proof the fitting statistics in eq 23 can be applied to evaluate a sample data x 1 x 2 x i x n 23 d s p max r i s i i 1 2 n where i is the index of sample data d s p measures the maximum deviation of plotted points from their theoretical values where r i and s i are calculated by eqs 24 and 25 respectively if d s p is within a certain interval for example a 100 1 α accepted interval then it meets eq 23 for more information interested readers can refer to michael 1983 24 r i 2 π arcsin i 0 5 n 25 s i 2 π arcsin f x i μ σ this is the end of the proof 3 2 from the perspective of l turnings observed from the above sub section the overall speed data do not exactly conform to the normal distribution in the singapore strait in a certain interval however these speed data can be recognized as a normal distribution therefore in fig 7 we filter out the data that ships pass through the four l turnings in the singapore strait to see the distribution similarly a trend gaussian curve along with the speed data is attached 26 f v t s 393 1 exp v t s 12 4855 3 918 2 s s t t once again we transform the speed data in l turnings into a standard normal distribution to verify the speed distribution as can be seen excluding the speed below 6 knots and above 17 knots the rest of the data in fig 8 form a straight line approximately in another word these speed data are normally distributed compared to the speed in 9 15 knots in the entire singapore strait thus the above two quantile quantile figures indicate that speeds in l turnings are more normally distributed than those in the singapore strait this finding drives us to observe the speed distribution in each leg and compare it with each l turning 3 3 comparisons between legs and l turnings as shown in fig 9 when we separately consider ships in each leg we find that speeds do not follow a normal distribution in most legs such as legs w5 e8 e9 e14 and e15 with exception of legs w1 and w2 next we will explain this phenomenon in terms of legs w1 and w2 ships come from the south china sea with high speeds when ships enter the singapore strait they should decelerate to obey navigation rules and ensure safety such operations of deceleration could make the speeds normally distributed as for the other legs they have non normal distributions of speeds mainly because of two reasons first a big turning between two legs would result in data agglomeration like speed acceleration or deceleration when we observe the speed data in each leg separately for example legs w5 and w6 the same situation also applies to legs e8 and e9 second for two adjacent legs in the singapore strait some ships may navigate through only one leg and sail into the open sea or the singapore port with full speeds thus their speeds are not affected by the l turnings for example the ships navigate in leg e14 and then drive into the open sea in this case the speed data in legs e14 and e15 are not normally distributed as demonstrated in fig 10 the four l turnings all conditionally show normal distributions of the speed data in their domains that is in addition to the low speed and high speed data in ellipses the rest data are normally distributed such conditional normal distributions can be interpreted in two aspects firstly the number of low speeds in 5 6 knots is larger than the theoretical value in normal distributions above the dotted standard line it is because when ships decelerate they shall keep sailing at a low speed for a while secondly the number of high speeds about 20 knots is smaller than the theoretical value in normal distributions below the dotted standard line this indicates that most ships do navigate slowly in l turnings or they will rapidly speed down in l turnings 4 ships navigating in l turnings this section explores how ships pass through l turnings in terms of speed change and the corresponding processes moreover based on the ais data and interpolation data implicit ship navigation rules in l turnings are revealed 4 1 speed decelerating to pass through l turnings fig 11 shows the speed data in the four l turnings by a heat map the warmer the color the faster the ship speed as seen when ships pass through an l turning the average speed of the downstream is smaller than that of the upstream this indicates that ships will decelerate when they pass through l turnings in general making ship data normally distributed in l turnings moreover elliptical areas also show that ships will slow down when they are changing courses greatly note that the finding here is based on seven days data with linear interpolation in the following we will make a comparison for each day in table 3 the average speed of each leg in an l turning is reported for seven days as observed 25 28 groups of data show a phenomenon of speed deceleration in l turnings three exceptions are l turning i on oct 2 l turning ii on oct 5 and l turning iii on oct 3 in general ships will decelerate when they pass through l turnings averagely decreasing 1 08 knots 1 84 knots 0 62 knots and 1 05 knots in l turning i l turning ii l turning iii and l turning iv respectively note that deceleration in l turning iii is the least by 5 26 because the speed in this turning is lower than that in the other three turnings on the contrary deceleration in l turning ii is the most by 14 4 because the corner in this turn is the biggest nearly a right angle turn 4 2 ship decelerating process as observed ships generally decelerate in l turnings this subsection studies the deceleration process in terms of speed change and course change for a given ship with a fixed size here we aim to answer the following four questions 1 how long will it take to decelerate 2 how much will the speed drop 3 how much will the course change 4 is the deceleration process related to a ship s size type to address the above questions we first propose an effective method iv to find out the starting and ending time of speed change for each ship passing through an l turning the main idea of method iv is to find both the maximum speed of a ship in the upstream of an l turning and the minimum speed of this ship in the downstream if the difference between the maximum and minimum speeds is greater than a threshold then we consider this process as a deceleration moreover a course check will be conducted to this deceleration process to ensure that the ship filtered out has passed through the l turning by applying method iv to the ais data from the singapore strait we find that if we do not consider environmental factors such as weather visibility wave etc the longer the length of the ship the longer the decelerating time the smaller the deceleration the smaller the course changing rate note that there is no significant relationship between the amount of speed changes and the length of the ship which also implicitly indicates that navigators tend to reduce the speed by a certain degree to pass through l turnings for the sake of presentation we only show the results with the ais data on 8 00 9 00 a m oct 1 2013 in this 1 h slice 14 ships are selected by method iv as shown in table 4 with the specific ais records at the starting and ending time of the speed change for each ship the corresponding deceleration process is recorded as ship id type length the initial final course before after deceleration the initial final speed before after deceleration decelerating time deceleration rate and course changing rate moreover based on the decelerating data impacts of ship length on the decelerating process are illustrated in fig 12 method iv locking ship decelerating process when passing through l turnings image 3 to verify the above findings we collect the data in an hour 8 a m 9 a m of one week oct 1 oct 7 2013 and calculate the pearson correlation coefficient pcc for each group of data to measure the linear correlation between two variables pcc has a value between 1 and 1 in statistics where pcc 1 means the total positive linear correlation 0 is no linear correlation and 1 is the total negative linear correlation ahlgren et al 2003 the results indicate that ship length has stronger correlations with deceleration time pcc 0 8021 and course changing rate pcc 0 6326 than with speed change pcc 0 3147 and deceleration pcc 0 3981 when ships pass through l turnings 5 ship traffic capacity of l turnings the speed density or flow density relationship has been recognized as the foundation of traffic flow theory zhang et al 2018a 2018b qu et al 2015 2017 noting that ships will decelerate when they pass through the l turnings this section thus addresses the ship speed density flow diagrams with four calibration models with the fundamental diagrams calibrated the ship traffic capacity of each l turning can be estimated kang et al 2018 5 1 ship speed density models the big ship ais data consist of a large number of observations and each observation records ship navigational messages in a restricted area let time t be the index of observations t t and t 1 2 t ω in the strait ships often change courses and do not always navigate in a straight line it is difficult and not accurate to calculate the space mean speed therefore the time mean speed of ship traffic at observation t in a particular l turning denoted as v t is calculated by 27 v t s v t s n t t t where v t s is the instantaneous sailing speed of ship s at observation t and n t is the total number of ships at observation t in the l turning in addition ship density at observation t in a particular l turning or in a restricted water area denoted as k t is defined by 28 k t n t l n m t t where constant l n m is the length of the l turning in nautical miles note that ais data have a time interval of approximately 10 s although we count the ship speed and density based on individual observations we cannot ensure that each observation contains all the ships in the l turning due to the natural limitation of ais technology however the smaller the time interval the higher the calculation accuracy the relationship between ship speed and ship density in any l turning respectively denoted as v and k is considered to be formulated by a generic function 29 v ξ k β where ξ k β represents the function of ship density with the vector of parameters β that can be estimated by using the real ais data by adopting the least square approach the vector of parameters β can be determined by solving the unconstrained minimization problem 30 minimize t t v t ξ k β 2 in this section we adopt four well recognized models in table 5 to fit the ship speed density relationships including linear gaussian exponential and power formulations where the four models are further transformed into their linear expressions 5 2 calibration results fig 13 presents the ship speed density relationships for the four l turnings in the singapore strait where each star represents an observation regarding the average speed data in the y axis and density data in the x axis here the time interval a range of 1 10 s used for calculating the mean speed and density is the one recorded in each observation and is directly retrieved from the ais data as observed the average speed in the four l turnings generally decreases with the increase of ship density more specifically l turning of legs w1 w2 in the first subfigure depicts a near linear regression relation l turnings of legs w5 w6 in the second subfigure and legs e8 e9 in the third subfigure show a convex regression with the fast to slow descent rate on the contrary l turning of legs e14 e15 in the fourth subfigure presents a concave regression with the slow to fast descent rate moreover mathematical speed density relationships for the four l turnings by the linear gaussian exponential and power models are calibrated in table 6 where not applicable means that model does not fit the real data as shown in table 7 according to the average r 2 the exponential and power models fit the ais data better than the linear models gaussian models are not completely applicable based on the average rmse the exponential and power models also outperform the linear models overall these four models can fit the data well with an exception of gaussian model for the w5w6 and e8e9 l turnings 5 3 ship flow analysis in l turnings traffic capacity is the capability of a waterway to deal with the traffic and when the traffic volume exceeds this limit traffic flow starts to decrease as is often experienced on congested roads before analyzing the ship flow in l turnings we give the following definition 2 definition 2 the capacity of an l turning is the maximum number of ships that can pass through this restricted water area per hour 31 q m s h i p s h r k m s h i p s n m v m k n o t s n m h r where k m and v m are the ship density and speed under the maximum ship flow respectively eq 31 is based on the fundamental diagram of ship traffic without loss of generality the flow of an l turning q can be calculated by the ship speed and ship density at any observation q k v considering the variety of models as well as r 2 and rmse we use speed density models in linear and exponential patterns as mentioned ships decelerate when they pass through l turnings from 13 7615 knots to 12 6453 knots from 12 2941 knots to 11 4598 knots from 12 4336 knots to 11 0028 knots and from 13 6746 knots to 12 5786 knots in l turning i l turning ii l turning iii and l turning iv respectively table 8 therefore reports the estimated ship flows in the four l turnings from the singapore strait according to the average speeds before and after deceleration as seen when ships decelerate to pass through the four l turnings the corresponding ship flows increase in other words the number of ships that can pass through each l turning per hour increases fig 14 shows the speed flow relations in the four l turnings by two model patterns linear speed density and exponential speed density models with which we can calculate the ship capacity of each l turning both two subfigures show that l turning i legs w1 w2 has the largest capacity while l turning ii legs w5 w6 has the smallest capacity specifically by taking the first order optimality condition of the ship flow function the capacity of each turning can be derived which is shown in the last column of table 8 6 conclusions in this study four tangible methods were proposed to analyze the traffic problem of ships passing through l turnings in the singapore strait from a big ais data perspective firstly method i ais data checking and revising addressed the big data de noising for the 43 million ship ais records in the singapore strait then method ii winding number checking selected the data within irregularly restricted water areas to remove noise data furthermore method iii filtered out the ships as well as their navigational records that pass through two or more neighboring legs i e l turnings the above methods were applied to one week ais data in the singapore strait and a series of analyses were conducted the findings in this study are concluded as follows 1 ship speeds in an l turning are normally distributed within a certain range however in a single leg either the upstream or downstream waters such a normal distribution is not clear 2 in the singapore strait ships slow down by 5 26 14 4 of the speed approximately to pass through l turnings interestingly changes in ship speed in an l turning identified by method iv have no relationship with ship types or lengths 3 ship length has an impact on ship decelerating time deceleration and course changing rate this indicates that ship length will influence ship traffic in the restricted water areas 4 in the singapore strait ships decelerate to pass through each l turning resulting in an increase of saturated ship traffic flow the main contribution of this study to literature relates to the application of the above findings by the channel management authority and the pilots in the singapore strait to help improve the traffic in the channel for example one can understand the relationship between ship density and ship speed to further manage the traffic flow this is also the first time an ais data based methodological framework is developed to investigate the travel behavior of vessels when they pass through l turning channels in the singapore strait results not only provide operative profiles in the l shaped water areas but also suggest the possible value of ais based data processing methodologies moreover results and policy recommendations such as setting speed limits in the singapore strait of this study may also support adequacy or improvement of existing policies and can be transferable to other water areas with similar traffic conditions acknowledgments the authors wish to express their great appreciation to the editor and anonymous reviewers for the meticulous review valuable comments and constructive suggestions which improved the paper significantly this study is supported by the research project tugboat scheduling for large container ports grant no r726000003646 granted by the institute of operations research and analytics at the national university of singapore 
22805,the value of ship automatic identification system ais data coexists with data noises whereas a tangible noise elimination method plays an important role in data mining in this study we first address the big ship ais data de noising issue for the 43 million records from 15 legs in the singapore strait in which ship position speed and course data are checked and corrected by our proposed method i moreover a winding number based method ii is developed to select data within irregularly restricted water areas based on these data we particularly design a search and cut method iii to filter out ships that pass through an l turning two or more neighboring legs forming a curved channel in this study speeds are normally distributed within a certain range according to the real ais data in the singapore strait three types of waters i e legs l turnings and the whole strait are compared the results indicate that ship speeds in l turnings are more normally distributed than the speeds in legs and the entire strait in the singapore strait ship speeds slow down by 5 26 14 4 to pass through l turnings approximately moreover our tangible method iv of identifying ship decelerating processes from a large number of navigational data indicates that changes in ship speed of an l turning have the least relationship with ship types or lengths however we find that the longer the length of the ship 1 the longer the decelerating time 2 the smaller the deceleration and 3 the smaller the course changing rate keywords singapore strait l turning ship ais data data modeling and analysis ship speed density flow 1 introduction the singapore strait is a relatively narrow and a busy waterway used by all types of ships including very large crude carriers ferries container ships and oil tankers it is no exaggeration to say the importance of the singapore strait since it carries one third of the world s traded goods approximately and connects more than 120 counties singapore 2014 in view of its significance it is of practical importance to investigate the ship traffic problems in the singapore strait which can provide useful solutions for the maritime governors to manage the strait s traffic effectively as well as the singapore port s operations efficiently the singapore strait extends over 105 km from the straits of malacca in the west to the south china sea in the east and its minimum width is 16 km approximately the strait consists of 15 legs divided by sigtto 2008 based on the structure and various traffic conditions of each leg as well as the consideration of the geographic locations of different ship terminals as shown in fig 1 the strait provides deep water access allowing vessels with a draught of 26 m and tankers of 200 000 dwt to the port of singapore and over 2 000 merchant ships traverse the water areas on a daily basis the online port information specialists 2018 among these 15 legs seven legs numbered w1 w7 direct from west to east and eight legs numbered e8 e15 direct from east to west as shown in fig 1 to put forward the research object of this study the following definition 1 of l turning is presented definition 1 two neighboring legs intersect with an angle between 0 and 160 forming an l shaped channel for ships navigating that is referred to as an l turning in this study as introduced a strait consists of a number of legs and these legs form a certain number of l turnings for example there are four l turnings in the singapore strait which will be introduced in detail in the following context as shown in fig 1 compared with straight legs ships passing through l turnings tend to have various characteristics for example variables of deceleration acceleration and changing courses moreover due to the different navigational conditions in each leg e g different widths of legs in an l turning and time variant ship flows different navigators may have various navigating behaviors so that the ship traffic capacity of the strait will be affected therefore it is necessary to find such relationships for the busy shipping corridors such as the singapore strait because traffic conditions in these straits are vital to the global logistics industry according to qu and meng 2012 for example daily loss of blockade in the singapore strait for the global maritime transportation is as much as 10 million usd 1 1 relevant studies ship traffic analyses support valuable knowledge for the maritime traffic control and management such as liner shipping sailing speed limits and traffic separation schemes wang et al 2013 zhang et al 2015 lu et al 2018 traditional methods of ship traffic analysis usually include ship traffic surveys such as manual observation radar detection and airborne photography zhang et al 2017 the first ship traffic survey was conducted in japan 1963 by means of statistics of ship traffic flow and accidents to estimate ship traffic capability and support ship traffic control recently advanced methods of ship traffic data collection such as the automatic identification system ais and vessel traffic services vts have been widely developed merrick and van dorp 2006 the ais data based ship traffic analytical methods are more accurate since the data precisely record ship navigational processes shelmerdine 2015 which can be used to model vessel navigation based on observations of ais data based on the ship ais data some empirical studies have analyzed ship traffic using ais data to improve port operations for example through proposing dynamic berth allocations and robust tugboat scheduling plans wu et al 2018 developed an ais data based method of studying travel behavior of vessels when they pass through a hotspot in a narrow inland waterway it is a novel trip information building method which can reveal the travel patterns of vessels passing through narrow waterways and also examine the risk of vessel collisions at the hotspots moreover two popular research branches of the existing studies contribute to reducing ship engine exhaust emissions goldsworthy and goldsworthy 2015 and preventing avoiding ship accidents hanninen and kujala 2012 wu et al 2016 zhang et al 2019 air quality and ship emissions data driven environmental issues e g air emissions and water pollution associated with ships are increasing in the literature air emissions can be described and modeled according to the shipping data transformed by ais including ship type speed operation mode sea condition etc for example ng et al 2013 developed a detailed activity based marine emission inventory for ships by considering ship speed and ship operation mode based on the ais data they reduced the complexity of air emission models similarly an activity based emission model was formulated by mölders et al 2013 to calculate the ship cruising emissions two types of data are utilized from the ais ship cruising data position speed and the operation mode and ship characteristics data engine power ship size fuel type and maximum cruising speed for more information interested readers can refer to robards et al 2016 based on the above studies we can say the ais data open new windows for calculating accurate air emissions and environmental impacts for shipping ship accident analysis and prevention despite the increase in ship traffic and ship size the rate of ship accidents has declined overall and one of the most harmful issues to the society death toll has reduced significantly fields 2014 however according to harati mokhtari et al 2007 around 84 of accidents were attributed to human errors and could be avoided with the aid of ais or other techniques moreover the potential risks to the environment and property losses grow with the increase of vessel sizes recently shipping routes hazard identification and risk evaluation can be estimated by using the historical ais data talavera et al 2013 zaman et al 2014 kang et al 2019 this is an off line estimation for the real time risk assessment silveira et al 2013 defined overall collision candidates by predicting future distances between any two ships with their current positions courses and speeds and comparing those distances with a predefined collision threshold similarly weng et al 2012 estimated the number of ship conflicts and the causation probability by using the real time ship ais data to conclude ais data based analysis of ship traffic contributes to both preventing accidents and making informed decisions on fairway design traffic separation schemes and disposition of emergency services 1 2 research objectives our thorough literature review via the academic search engines shows that the ship traffic problems when ships passing through l turnings as well as the methodologies of using the big ais data for solving these problems have not yet been investigated in the literature in this study we thus try to address the following four problems for the ship traffic in the singapore strait from a big ais data perspective 1 ship speed distributions affect the ship traffic capacity of a strait are ship speeds in the singapore strait subject to a certain distribution we compare three scenarios under the normal distribution leg l turning and strait cases 2 do l turnings in the singapore strait characterized by their corners and lengths have any impacts on ship navigation we try to describe such impacts in quantification in terms of ship acceleration deceleration and course changing 3 do different types and lengths of ships passing through the l turning have various sailing characteristics we propose a tangible method to identify ship accelerating decelerating processes when passing through the l turnings from the big ship ais data pool and conduct analysis for different ships 4 will l turnings affect the ship traffic capacity of a strait we demonstrate such impacts by introducing the fundamental diagram of ship traffic in the singapore strait the remainder of this study is organized as follows in section 2 we present the research methodology including ship ais data checking method winding number method and l turning s ship selection method comparisons of ship speeds in the singapore strait and of passing through l turnings are made in section 3 detailed analyses of ships sailing in l turnings are conducted in section 4 section 5 presents the calculation of ship traffic capacity of each l turning and section 6 concludes this study 2 methodology 2 1 ship ais data checking a complete piece of ship ais data at least includes the following messages ship id ship type position course speed heading drought navigation status dimension of bow dimension of stern dimension of port and dimension of starboard shu et al 2017 kang et al 2018 as shown in fig 2 the first two messages are for ship identifications the third to sixth messages indicate ship navigation parameters the seventh and eighth messages provide the strait environment and the last four messages tell the ship physical information however three important ais messages related to each ship with an interval time of less than 10 s ship id position and speed are sufficient for this study in general ship identification and navigation messages provided by the ais technique are highly reliable however ship position course and speed data are not immune to errors during the transmission from ships to the nearby ais bases for example the singapore strait has its boundaries that identify the longitude and latitude of each ship moving in the strait due to the ship initial turning ability course span of two consecutive records of each ship is within a certain range moreover ship speed in the singapore strait is also limited taking into account the safety of navigation hence errors or unreasonable data in the ais database should be identified and revised according to certain practical rules prior to presenting the method checking and revising the ais data we define the following notations for the real ais database let s be the ship id s s and t be the time t t for each ship s at time t x t s represents the longitude y t s denotes the latitude v t s signifies the speed and c t s shows the navigating course the international hydrographical organization defines the bounds of the singapore strait with respect to longitude as 103 350 e to the west min x 103 350 and 104 583 e to the east max x 104 583 as well as latitude 1 027 n to the south min y 1 027 and 1 422 n to the north max y 1 422 in addition considering the speed limit in the singapore strait and the real ais data we set a lower speed bound min v 5 knots and an upper speed bound max v 25 knots qu et al 2011 qu and meng 2012 in terms of ship turning we refer to the ship course difference between two consecutive ais records of each ship i e min δ c 5 and max δ c 5 with the above definitions the ais data checking and revising method i is proposed in detail as follows method i ais data checking and revising step 1 checking and revising the longitude data check ship longitude data according to eq 1 if longitude x t s does not meet the lower or upper bounds then we revise it based on eq 2 where time t is the preceding time of t and t is the following time of t in the ais records i e t t t note that this step aims to check and revise minor data errors caused by transformation considering the high reliability of ais data 1 min x x t s max x s s t t 2 x t s x t s x t s t t t t step 2 checking and revising the latitude data similar to the longitude we check ship latitude data according to the lower and upper bounds in eq 3 if latitude y t s does not meet condition 3 then we revise it based on eq 4 3 min y y t s max y s s t t 4 y t s y t s y t s t t t t step 3 checking and revising the speed data ship speed is supposed to be continuous and checked by the lower and upper bounds in eq 5 if speed v t s does not meet condition 5 then we revise it based on eq 6 where g t is the function of speed versus time between times t and t note that speed change here is recognized as a continuous process and g t can be obtained by the existing speed data with linear data fitting 5 min v v t s max v s s t t 6 v t s t t g v d v step 4 checking and revising the course data similarly ship course changing is also continuous and we check ship course data according to eq 7 if course c t s does not meet condition 7 then we revise it based on eq 8 where h t is the function of course versus time between times t and t 7 min δ c c t s c t 1 s max δ c s s t t 8 c t s t t h c d c this is the end of method i here we take ship id 218284000 in table 1 for instance records in the third row including longitude latitude speed and course of ship 218284000 at time 8 00 12 are not correct after checking against eqs 1 3 5 and 7 by using the proposed data revising method revised records are updated in the fourth row after the ship ais data checking and revising processes data noises are basically eliminated according to our statistics there are about 383 990 data points updated by the procedure accounting for 8 93 of the total data approximately based on our observation the errors do not have any clear distribution over time or geographic locations however legs w7 and e10 have the most and least data errors accounting for 2 01 and 0 085 of the total records respectively 2 2 the winding number based method this study focuses on the l turnings in the singapore strait thus the ais data studied should be within the restricted areas herein we use the winding number method to select the target data the winding number precisely shows whether a point is in an irregularly closed curve or not and it is defined as the total number of times that curve travels counterclockwise around the point that is if the curve does not wind around a point then the rounded winding number equals zero and thus the point is outside the curve mathematically let w n p v represent the winding number of any non simple closed curve v around a point p note that p is not on v consider v as a continuous curve in fig 3 consisting of a large number of points x u y u 0 u 1 as shown in eq 9 let v 0 v 1 in a plane 9 v u v x u y u 0 u 1 moreover we define a vector v p u from p to v u in eq 10 the unit vector of v p u in eq 11 thus maps the point v u to the vector v p u on the unit circle o x y x 2 y 2 1 this mapping notes as w p by eq 12 which however can be represented in a polar coordinate system by eq 13 10 v p u v u p 0 u 1 p v 11 v p u v p u v p u 0 u 1 p v 12 w p v o p v 13 w p u cos θ u sin θ u 0 u 1 p v where θ u represents a positive counterclockwise angle in radians the winding number w n p v therefore equals the number of times that w p wraps v around o which can be obtained by the integral 14 w n p v 1 2 π d θ 1 2 π 0 1 θ u d u p v specifically when v is a polygon with the number of vertexes n the integral in eq 14 reduces to the sum of the angles that each edge v j v j 1 subtends with the point p x t s y t s 15 w n p v 1 2 π j 1 n θ j p v a strait s leg can be considered as a polygon and let v v 1 v 2 v j v n be the set of vertexes of the leg where v j represents the j t h vertex of the leg and v n 1 v 1 the longitude and latitude of the vertex v j are given and denoted by l o n v j and l a t v j respectively the position of the vertex v j is v j l a t v j l o n v j which transforms into a rectangular coordinate v j l a t v j l o n v j moreover as introduced x t s and y t s represent the longitude and latitude of ship s at time t respectively hence a point p x t s y t s represents the real position of ship s at time t in the strait and its rectangular coordinate is p x t s y t s to check whether point p x t s y t s is in a certain strait leg the following eq 16 calculates how many times the polygon winds around p x t s y t s 16 w n p v 1 2 π j 1 n arccos p v j p v j 1 p v j p v j 1 p v where p v j is the vector from points p x t s y t s to v j l a t v j l o n v j hence it is clear that point p x t s y t s is in the leg when r o u n d w n p v 0 otherwise r o u n d w n p v 0 note that r o u n d is the rounding operation for the winding number based on the above discussion we propose the winding number method as follows method ii winding number checking image 1 here we take leg w7 in the singapore strait for instance as fig 4 shows the terrestrial coordinates of the five vertexes are given and the rectangular coordinates are obtained by eq 17 in which ℜ represents the earth radius for ship position p x t s y t s 103 32 e 1 13 n in the figure r o u n d w n p v 1 thus ship position p x t s y t s is within leg w7 as to position p x t s y t s 103 38 e 1 17 n r o u n d w n p v 0 indicating that position p is beyond leg w7 17 v j l a t v j l o n v j ℜ cos l o n v j cos l a t v j ℜ sin l o n v j cos l a t v j to improve the checking efficiency the above winding number method can be applied to multiple legs at the same time for instance legs w1 and w2 forming an l turning can be considered as a six vertex polygon moreover the westbound of the singapore strait including the seven legs can also be linked together to a 22 vertex polygon therefore the above winding number checking is robust with the flexibility of choosing data size and polygon shape 2 3 selecting ships passing through two legs with the ship ais data checking and revising method i as well as the winding number based method ii ais data within a certain leg or legs are identified however these data showing ship trajectories may not pass through l turnings in other words these discrete points may only exist in a single leg hence an effective method of identifying ship data from 15 legs that pass through l turnings in the singapore strait should be presented firstly we pick up the four l turnings from the singapore strait see table 2 denoted as l w 1 w 2 l w 5 w 6 l e 8 e 9 and l e 14 e 15 as well as their clean data then the linear function of each intersecting line that cuts l turnings into two legs in terrestrial coordinates is proposed in eq 18 18 l w 1 w 2 g x 5 979 x 625 104 3232 x 104 3271 l w 5 w 6 g x 1 694 x 174 6 103 7269 x 103 7382 l e 8 e 9 g x 2 828 x 294 2 103 6475 x 103 6596 l e 14 e 15 g x 31 75 x 3311 104 3280 x 104 3288 where g x represents the fitting latitude with the given longitude x if one position x t s y t s of the ship s s in the ais database meets one of the functions in eq 18 i e g x t s y t s t t then we can say this ship has passed through the corresponding l turning note that the ais data may not be exactly on the intersecting line due to the interval of data transmission 5 10 s although the ship does pass through two legs hence we introduce an accuracy ε that is if the absolute difference between y t s real latitude and g x t s fitting latitude is less than ε then we consider this ship to pass through the l turning hence according to the above discussion a tangible and efficient searching method iii is proposed for the data in a restricted area to find ships passing through a certain l turning in the singapore strait for the sake of efficiency method iii will cut or delete the ship ids from the big data that have been identified this is called the search and cut method method iii search and cut method for selecting ships passing through l turnings image 2 3 ship sailing speed in the singapore strait and of passing through l turnings in this section ship sailing speeds as well as their distributions in the singapore strait are presented firstly based on the one week clean ais data from oct 1 to oct 7 2013 specifically we further filter out the data for ships that pass through the four l turnings and make comparisons with the overall data in the singapore strait it should be pointed out that the analysis here does not consider ship types or lengths we will factor in these two ship attributes in the analysis of the next section 3 1 from the perspective of the whole strait fig 5 illustrates the overall ship speed distribution in the singapore strait where the x axis shows speed data and the y axis presents the number of records under the speed note that ship speeds are filtered in a range of 5 25 knots as introduced the minimum and maximum speeds are 5 13 and 24 87 knots two times of speeding respectively with a mean speed of 15 knots we use four models to fit the data the linear model quadratic model polynomial nonlinear model and gaussian model the fitting results are given in eq 19 19 s s t t f v t s 49 81 v t s 1289 r 2 0 3533 r m s e 387 4 f v t s 6 859 v t s 2 155 4 v t s 21 78 r 2 0 5294 r m s e 331 3 f v t s 226 2 sin v t s π 5 907 v t s 10 2 875 4 r 2 0 6217 r m s e 295 5 f v t s 719 9 exp v t s 11 9568 5 065 2 r 2 0 7479 r m s e 216 3 to compare the regression we use two widely adopted indicators r 2 and rmse root mean squared error in eqs 20 and 21 respectively to evaluate the above four models note that values of r 2 are in a range of 0 1 and a larger value of r 2 indicates a better fitting performance of the model on the contrary the smaller the rmse the better the regression as observed the gaussian model outperforms the other three models according to the goodness of fit 20 r 2 1 t v t f 2 t v t t v t ω 2 21 r m s e 1 t v t f 2 ω in the singapore strait however the speed limit is 12 knots according to the data shape and gaussian curve as depicted in fig 5 around 50 of data points are speeding moreover as highlighted in the ellipse a majority number of ships sail around the limit speed signifying that navigators are aware of the limited speed in the following we formally transform the ship speed data into a standard normal distribution to calibrate the distribution of speeds fig 6 illustrates the quantiles of ship speed data y axis versus theoretical quantiles from a normal distribution x axis if the distribution of speed data is normal then the plot will be close to linear as observed speed data below 6 knots and above 18 knots significantly deviate from the dotted line the curve of speeds between 6 and 18 knots matches with the straight dotted line more specifically speed data in the range of 9 15 knots form a more exact normal distribution with the expected speed value of 11 96 knots approximately property 1 ship speed data in a restricted area obey normal distributions when they are divided into intervals the accepted interval α of these interval data is 22 σ f sin 2 arcsin f q i π 2 d α d s p μ σ f sin 2 arcsin f q i π 2 d α where α d s p μ parameters μ and σ are estimators in the normal distribution f and d α is the bound of a significant level of d s p at α michael 1983 proof the fitting statistics in eq 23 can be applied to evaluate a sample data x 1 x 2 x i x n 23 d s p max r i s i i 1 2 n where i is the index of sample data d s p measures the maximum deviation of plotted points from their theoretical values where r i and s i are calculated by eqs 24 and 25 respectively if d s p is within a certain interval for example a 100 1 α accepted interval then it meets eq 23 for more information interested readers can refer to michael 1983 24 r i 2 π arcsin i 0 5 n 25 s i 2 π arcsin f x i μ σ this is the end of the proof 3 2 from the perspective of l turnings observed from the above sub section the overall speed data do not exactly conform to the normal distribution in the singapore strait in a certain interval however these speed data can be recognized as a normal distribution therefore in fig 7 we filter out the data that ships pass through the four l turnings in the singapore strait to see the distribution similarly a trend gaussian curve along with the speed data is attached 26 f v t s 393 1 exp v t s 12 4855 3 918 2 s s t t once again we transform the speed data in l turnings into a standard normal distribution to verify the speed distribution as can be seen excluding the speed below 6 knots and above 17 knots the rest of the data in fig 8 form a straight line approximately in another word these speed data are normally distributed compared to the speed in 9 15 knots in the entire singapore strait thus the above two quantile quantile figures indicate that speeds in l turnings are more normally distributed than those in the singapore strait this finding drives us to observe the speed distribution in each leg and compare it with each l turning 3 3 comparisons between legs and l turnings as shown in fig 9 when we separately consider ships in each leg we find that speeds do not follow a normal distribution in most legs such as legs w5 e8 e9 e14 and e15 with exception of legs w1 and w2 next we will explain this phenomenon in terms of legs w1 and w2 ships come from the south china sea with high speeds when ships enter the singapore strait they should decelerate to obey navigation rules and ensure safety such operations of deceleration could make the speeds normally distributed as for the other legs they have non normal distributions of speeds mainly because of two reasons first a big turning between two legs would result in data agglomeration like speed acceleration or deceleration when we observe the speed data in each leg separately for example legs w5 and w6 the same situation also applies to legs e8 and e9 second for two adjacent legs in the singapore strait some ships may navigate through only one leg and sail into the open sea or the singapore port with full speeds thus their speeds are not affected by the l turnings for example the ships navigate in leg e14 and then drive into the open sea in this case the speed data in legs e14 and e15 are not normally distributed as demonstrated in fig 10 the four l turnings all conditionally show normal distributions of the speed data in their domains that is in addition to the low speed and high speed data in ellipses the rest data are normally distributed such conditional normal distributions can be interpreted in two aspects firstly the number of low speeds in 5 6 knots is larger than the theoretical value in normal distributions above the dotted standard line it is because when ships decelerate they shall keep sailing at a low speed for a while secondly the number of high speeds about 20 knots is smaller than the theoretical value in normal distributions below the dotted standard line this indicates that most ships do navigate slowly in l turnings or they will rapidly speed down in l turnings 4 ships navigating in l turnings this section explores how ships pass through l turnings in terms of speed change and the corresponding processes moreover based on the ais data and interpolation data implicit ship navigation rules in l turnings are revealed 4 1 speed decelerating to pass through l turnings fig 11 shows the speed data in the four l turnings by a heat map the warmer the color the faster the ship speed as seen when ships pass through an l turning the average speed of the downstream is smaller than that of the upstream this indicates that ships will decelerate when they pass through l turnings in general making ship data normally distributed in l turnings moreover elliptical areas also show that ships will slow down when they are changing courses greatly note that the finding here is based on seven days data with linear interpolation in the following we will make a comparison for each day in table 3 the average speed of each leg in an l turning is reported for seven days as observed 25 28 groups of data show a phenomenon of speed deceleration in l turnings three exceptions are l turning i on oct 2 l turning ii on oct 5 and l turning iii on oct 3 in general ships will decelerate when they pass through l turnings averagely decreasing 1 08 knots 1 84 knots 0 62 knots and 1 05 knots in l turning i l turning ii l turning iii and l turning iv respectively note that deceleration in l turning iii is the least by 5 26 because the speed in this turning is lower than that in the other three turnings on the contrary deceleration in l turning ii is the most by 14 4 because the corner in this turn is the biggest nearly a right angle turn 4 2 ship decelerating process as observed ships generally decelerate in l turnings this subsection studies the deceleration process in terms of speed change and course change for a given ship with a fixed size here we aim to answer the following four questions 1 how long will it take to decelerate 2 how much will the speed drop 3 how much will the course change 4 is the deceleration process related to a ship s size type to address the above questions we first propose an effective method iv to find out the starting and ending time of speed change for each ship passing through an l turning the main idea of method iv is to find both the maximum speed of a ship in the upstream of an l turning and the minimum speed of this ship in the downstream if the difference between the maximum and minimum speeds is greater than a threshold then we consider this process as a deceleration moreover a course check will be conducted to this deceleration process to ensure that the ship filtered out has passed through the l turning by applying method iv to the ais data from the singapore strait we find that if we do not consider environmental factors such as weather visibility wave etc the longer the length of the ship the longer the decelerating time the smaller the deceleration the smaller the course changing rate note that there is no significant relationship between the amount of speed changes and the length of the ship which also implicitly indicates that navigators tend to reduce the speed by a certain degree to pass through l turnings for the sake of presentation we only show the results with the ais data on 8 00 9 00 a m oct 1 2013 in this 1 h slice 14 ships are selected by method iv as shown in table 4 with the specific ais records at the starting and ending time of the speed change for each ship the corresponding deceleration process is recorded as ship id type length the initial final course before after deceleration the initial final speed before after deceleration decelerating time deceleration rate and course changing rate moreover based on the decelerating data impacts of ship length on the decelerating process are illustrated in fig 12 method iv locking ship decelerating process when passing through l turnings image 3 to verify the above findings we collect the data in an hour 8 a m 9 a m of one week oct 1 oct 7 2013 and calculate the pearson correlation coefficient pcc for each group of data to measure the linear correlation between two variables pcc has a value between 1 and 1 in statistics where pcc 1 means the total positive linear correlation 0 is no linear correlation and 1 is the total negative linear correlation ahlgren et al 2003 the results indicate that ship length has stronger correlations with deceleration time pcc 0 8021 and course changing rate pcc 0 6326 than with speed change pcc 0 3147 and deceleration pcc 0 3981 when ships pass through l turnings 5 ship traffic capacity of l turnings the speed density or flow density relationship has been recognized as the foundation of traffic flow theory zhang et al 2018a 2018b qu et al 2015 2017 noting that ships will decelerate when they pass through the l turnings this section thus addresses the ship speed density flow diagrams with four calibration models with the fundamental diagrams calibrated the ship traffic capacity of each l turning can be estimated kang et al 2018 5 1 ship speed density models the big ship ais data consist of a large number of observations and each observation records ship navigational messages in a restricted area let time t be the index of observations t t and t 1 2 t ω in the strait ships often change courses and do not always navigate in a straight line it is difficult and not accurate to calculate the space mean speed therefore the time mean speed of ship traffic at observation t in a particular l turning denoted as v t is calculated by 27 v t s v t s n t t t where v t s is the instantaneous sailing speed of ship s at observation t and n t is the total number of ships at observation t in the l turning in addition ship density at observation t in a particular l turning or in a restricted water area denoted as k t is defined by 28 k t n t l n m t t where constant l n m is the length of the l turning in nautical miles note that ais data have a time interval of approximately 10 s although we count the ship speed and density based on individual observations we cannot ensure that each observation contains all the ships in the l turning due to the natural limitation of ais technology however the smaller the time interval the higher the calculation accuracy the relationship between ship speed and ship density in any l turning respectively denoted as v and k is considered to be formulated by a generic function 29 v ξ k β where ξ k β represents the function of ship density with the vector of parameters β that can be estimated by using the real ais data by adopting the least square approach the vector of parameters β can be determined by solving the unconstrained minimization problem 30 minimize t t v t ξ k β 2 in this section we adopt four well recognized models in table 5 to fit the ship speed density relationships including linear gaussian exponential and power formulations where the four models are further transformed into their linear expressions 5 2 calibration results fig 13 presents the ship speed density relationships for the four l turnings in the singapore strait where each star represents an observation regarding the average speed data in the y axis and density data in the x axis here the time interval a range of 1 10 s used for calculating the mean speed and density is the one recorded in each observation and is directly retrieved from the ais data as observed the average speed in the four l turnings generally decreases with the increase of ship density more specifically l turning of legs w1 w2 in the first subfigure depicts a near linear regression relation l turnings of legs w5 w6 in the second subfigure and legs e8 e9 in the third subfigure show a convex regression with the fast to slow descent rate on the contrary l turning of legs e14 e15 in the fourth subfigure presents a concave regression with the slow to fast descent rate moreover mathematical speed density relationships for the four l turnings by the linear gaussian exponential and power models are calibrated in table 6 where not applicable means that model does not fit the real data as shown in table 7 according to the average r 2 the exponential and power models fit the ais data better than the linear models gaussian models are not completely applicable based on the average rmse the exponential and power models also outperform the linear models overall these four models can fit the data well with an exception of gaussian model for the w5w6 and e8e9 l turnings 5 3 ship flow analysis in l turnings traffic capacity is the capability of a waterway to deal with the traffic and when the traffic volume exceeds this limit traffic flow starts to decrease as is often experienced on congested roads before analyzing the ship flow in l turnings we give the following definition 2 definition 2 the capacity of an l turning is the maximum number of ships that can pass through this restricted water area per hour 31 q m s h i p s h r k m s h i p s n m v m k n o t s n m h r where k m and v m are the ship density and speed under the maximum ship flow respectively eq 31 is based on the fundamental diagram of ship traffic without loss of generality the flow of an l turning q can be calculated by the ship speed and ship density at any observation q k v considering the variety of models as well as r 2 and rmse we use speed density models in linear and exponential patterns as mentioned ships decelerate when they pass through l turnings from 13 7615 knots to 12 6453 knots from 12 2941 knots to 11 4598 knots from 12 4336 knots to 11 0028 knots and from 13 6746 knots to 12 5786 knots in l turning i l turning ii l turning iii and l turning iv respectively table 8 therefore reports the estimated ship flows in the four l turnings from the singapore strait according to the average speeds before and after deceleration as seen when ships decelerate to pass through the four l turnings the corresponding ship flows increase in other words the number of ships that can pass through each l turning per hour increases fig 14 shows the speed flow relations in the four l turnings by two model patterns linear speed density and exponential speed density models with which we can calculate the ship capacity of each l turning both two subfigures show that l turning i legs w1 w2 has the largest capacity while l turning ii legs w5 w6 has the smallest capacity specifically by taking the first order optimality condition of the ship flow function the capacity of each turning can be derived which is shown in the last column of table 8 6 conclusions in this study four tangible methods were proposed to analyze the traffic problem of ships passing through l turnings in the singapore strait from a big ais data perspective firstly method i ais data checking and revising addressed the big data de noising for the 43 million ship ais records in the singapore strait then method ii winding number checking selected the data within irregularly restricted water areas to remove noise data furthermore method iii filtered out the ships as well as their navigational records that pass through two or more neighboring legs i e l turnings the above methods were applied to one week ais data in the singapore strait and a series of analyses were conducted the findings in this study are concluded as follows 1 ship speeds in an l turning are normally distributed within a certain range however in a single leg either the upstream or downstream waters such a normal distribution is not clear 2 in the singapore strait ships slow down by 5 26 14 4 of the speed approximately to pass through l turnings interestingly changes in ship speed in an l turning identified by method iv have no relationship with ship types or lengths 3 ship length has an impact on ship decelerating time deceleration and course changing rate this indicates that ship length will influence ship traffic in the restricted water areas 4 in the singapore strait ships decelerate to pass through each l turning resulting in an increase of saturated ship traffic flow the main contribution of this study to literature relates to the application of the above findings by the channel management authority and the pilots in the singapore strait to help improve the traffic in the channel for example one can understand the relationship between ship density and ship speed to further manage the traffic flow this is also the first time an ais data based methodological framework is developed to investigate the travel behavior of vessels when they pass through l turning channels in the singapore strait results not only provide operative profiles in the l shaped water areas but also suggest the possible value of ais based data processing methodologies moreover results and policy recommendations such as setting speed limits in the singapore strait of this study may also support adequacy or improvement of existing policies and can be transferable to other water areas with similar traffic conditions acknowledgments the authors wish to express their great appreciation to the editor and anonymous reviewers for the meticulous review valuable comments and constructive suggestions which improved the paper significantly this study is supported by the research project tugboat scheduling for large container ports grant no r726000003646 granted by the institute of operations research and analytics at the national university of singapore 
22806,in deepwater oil and gas field development a tension leg platform tlp consists of a hull tendons and top tension risers ttr when one or more tendons failure due to extreme sea state a tlp will be under the working condition which is very different from its design condition showing structural instability and transient effect to enhance the safety and global stability of whole tlp system obtaining failure consequences is necessary by 3d potential flow theory and panel element method a series of mooring analyses are performed for the target tlp to predict its coupled hydrodynamic response after tendon one time failure and in particular during progressive failure of several tendons different directions of environment load that including extreme wind wave and current and tendon failure positions are considered in the results the motion response of the hull the force from residual tendons and ttrs are presented keywords tendon failure progressive failure hull tendon top tension riser ttr coupling model local mooring failure tendon hanging irregular wave with slow drift 1 introduction tension leg platform tlp is one major type of offshore structures which are used in deepwater oil and gas field development a whole tlp generally includes three parts the hull which is the main body of the platform floating on the sea tendons which are the crucial part to form tension legs fastening the hull downward to wellhead on seabed in general each leg consists of 2 or 3 tendons and risers the specific type corresponding to a tlp is top tension riser ttr used for oil drilling or production transfer although so far offshore engineering design specifications demand to take the redundancy for mooring failure of floating structure into account e g global performance will not be affected after one mooring line fails and the platform will not overturn or drift away after two lines fails etc the accidental extreme sea state are not considered as an external excitation condition and the chain reaction from multi line failure is neglected in previous research in fact the probability for a tlp in healthy condition to undergo tendon failure may be maximal when it is in an extreme sea load and the broken position along one tendon is most probably at its upper end close to hull or its lower end on seabed compared with tendon one time failure multi tendon progressive failure is significant because these progressive processes can describe a more real failure path and different response occurs when tendons fail one by one than two tendons one time fail during past years some researches on floating platform especially tlp have been conducted by relevant scholars a time domain vessel mooring riser coupled dynamic analysis has been developed for multi floating systems e g ran and kim 1997 kim et al 2001 the hydrodynamic coefficients of floaters are calculated from wamit lee et al 1991 the importance of the hull mooring riser coupled dynamic analysis for deepwater floating systems is well clarified in ma et al 2000 and wichers and devlin 2004 q zhang c b zhao et al 2013 focus on tendon response of 10 mw offshore wind turbine tlp platform in extreme environment condition nematbakhsh ali et al 2015 makes comparison of wave load effects on a tlp wind turbine by using cfd and potential flow theory chengxi li 2015 does a numerical investigation of a hybrid wave absorption method chengxi li jun zhang 2016 perform a nonlinear coupled dynamics analysis of a truss spar platform hanqing zhang et al 2017 illustrate interference of ttr for tlp yan li et al 2017 study effects of second order wave forces and aerodynamic forces on dynamic responses of a tlp type floating offshore wind turbine zhang a f et al 2017 makes analysis of mooring performance parameters of tlp based on aqwa gao wei zhang jichun zhu weiquan 2017 perform global motion analysis of conventional tlp in relative shallow water region of south china sea t p mazarakos s a mavrakos 2017 investigate experimentally on mooring loads and motions of a tlp floating wind turbine teng wang yujie liu 2018 calculate dynamic response of platform riser coupling system with hydro pneumatic tensioner chengxi li et al 2018 make a study on the weakly nonlinear seekeeping solution near the critical frequency zhang z et al 2009 researches progressive mooring line failure of a deepwater modu in hurricane conditions gu jiayang et al 2015 make a study on the dynamic response and tension characteristics of a tlp with one tendon broken damilola o oyejobi et al 2017 does a research on stochastic response of intact and a removed tendon tension leg platform to random wave and current forces mohammad reza tabeshpour et al 2018 makes an investigation of tlp behavior under tendon damage people mostly pay attention to hull s motion and mooring lines own response even no riser model is built when mooring system breakdown not only residual mooring lines but risers on floating body also experience impact even damage but the response of riser is generally ignored in previous research in the aspect of mooring failure the transient effect of tendon disconnection on the global motion of etlp is focused on by chan k yang et al 2008 kim and zhang 2009 study transient effects of tendon disconnection on the survivability of a tlp in moderate hurricane transient effects of tendon disconnection of a tlp are researched by hull tendon riser coupled dynamic analysis yang and kim 2010 aysan jamalkia et al 2016 make damage detection of tlp and spar floating wind turbine using dynamic response of the structure y h bae m h kim h c kim 2017 discuss performance changes of a floating offshore wind turbine with broken mooring line yan li et al 2018 investigate transient response of a spar type floating offshore wind turbine with fractured mooring lines although various failure positions and combinations are simulated before few scholar performs analysis on progressive mooring failure to floating platforms in other words the case mooring lines fail one by one by some certain criteria further few people is concerned with what a different result such failure one by one brings about the present paper focuses on a series of mooring analyses for a tlp with ttrs when its tendons fail to get the subsequent behaviors of the platform and mooring system response including remanent tendons and risers one time failures caused by different number of tendon and in various sea load direction are performed and progressive failures caused by multi tendon are also performed furthermore comparisons between the two kinds of failure mode above are made to assess the latter one s necessity and their response difference is focused on to estimate the range of progressive effect not only are slow drift force from the 2nd order wave component calculated but also wind force defined by npd spectrum other than steady wind act on the upper structure both of tendon s and ttr s responses are analyzed a calculation method for tendon failure is proposed and the influence by hanged tendon is predicted by a self programmed subroutine in the manuscript 2 tlp tendon and ttr configuration 2 1 hull the target tlp applied in research is a classic tlp with 4 vertical cylindrical columns and 4 rectangular pontoons horizontal at bottom r eatock taylor e r jefferys 1986 as shown in fig 1 2 2 tendon the mooring system of the tlp is comprised of 8 tendons divided into 4 tension legs with 2 tendons each every 2 tendons are connected with the lower end of one corner column by tendon porch and their another ends are locked by subsea receptacles in detail the angle between a pair of tendons relative to column axis is 60 and their connection position is 9 94m offset and 4m height not on the column bottom circle see fig 2 according to design api 5l x70 steel pipe are adopted as main material of tendon with 0 038m in wt and 1 016m in od the pretension of each tendon for full riser configuration is 1577 1 mt in terms of steel specification the tensile strength of x70 is 570 mpa api specification 5l 2012 so the nominal breakage tension for the single tendon is about 6 7e 04 kn this is a main check criterion to tendon failure api rp 2t 1997 2 3 ttr a total of 12 ttrs are installed on the platform with layout of a 3 4 array shown in fig 3 as a majority of risers are production riser e g always only one drilling riser exists all of them are regarded as production ones to form a symmetry riser system each riser is 0 273m in od and 0 01m in wt the payload of each riser is 101 1 mt it is about 1 10 total pretension of tendons for the full risers the top of risers are hanged by hydraulic tensioners at 20m height above waterline and at the geometry center of hull in horizontal the tensioner stiffness at its equilibrium position when riser stroke is zero is 2 75e 05 n m all of the subsea connection points no matter for tendons or risers are vertically corresponding to their hull ends respectively and they are all located in the same seabed plane 3 environmental condition and load cases the water depth where the tlp operates is 450m which belongs to deepwater which is defined in offshore engineering subrata k chakrabarti 2005 absolute calm sea condition is applied in some test analyses to verify the tlp modeling and to get its fundamental structural attributions e g static offset test free decay test and tendon failure test in no any sea load etc it is the most possible that tendon failure occurs on tlp when it encounter an extreme sea state because a conventional environment condition which is not so acute could have been verified in design phase that it is not enough to destroy the structure or any of its parts and some typical mooring failure tests in mild sea are generally demanded in code design api rp 2t 1997 moreover the more intensive sea load acts on structure the lower reliable the structure or its local part becomes thus a tropical cyclone or typhoon condition is set as the sea state in paper of course it is also one of design criteria for the initial platform without any damaged omnidirectional typhoon environment data from the south china sea are selected to form a dangerous combination of max wave max wind and max current once in 1000 year and three of them are in same direction this is a survival case for the healthy platform in design details of the metocean are listed in table 2 below irregular wave has randomicity in superposition of element waves so it will lead to different waves from one spectrum to analyze the result from different failure conditions and get some laws though in irregular wave a same time history of wave surface is needed there are many complicated components are distributed at two ends of tension leg to guarantee its valid mooring connection in addition a slender bar like tendon always has high stress area close to its ends when a crucial part porch or tendon connector at a tendon end is damaged by insufficient strength impact fatigue collision or corrosion the tendon will be disconnected from its top or bottom and then danger happens tendon and ttr number heading and sea load direction including wind wave and current are defined in fig 4 local structure axes lsa o x y z are fixed at the cog of hull following with it to move and fixed reference axes fra o x y z are placed at the origin of model space it is global and never moved directions of wave current and wind are all defined by directions they go toward in x o y plane due to symmetry of the structure there are only 0 30 and 45 directions needed to check for a healthy tlp but during tendon failure structural response more depends on wave direction relative to failed tendon than absolute wave direction changing wave direction is equivalent to changing position of failed tendon therefore 45 and 225 are chosen for load cases when the failed tendon is most close and far away to coming wave i e up wave and down wave so called for continuity of load case changing 0 and 180 are also calculated 4 numerical model a composite model is constructed for the target tlp which consists of three parts that a panel model a morison model and a tether model which are shown in fig 6 rule tn is short for the n th tendon similarly rn is for riser finally a whole hull tendon ttr coupling numerical model is generated for mooring analysis api 2005 api 2007a faltinsen o m 1990 the motion equation of floating structure in the time response analysis is shown as below cummins w e 1962 1 m a x t c x t k x t 0 t r t τ x τ d τ f t and those hydrodynamic parameters in it which shows structural property are acquired from the frequency domain analysis done in front the wave force rao radiation damping and added mass etc are checked in accordance with design information r eatock taylor e r jefferys 1986 a sketch map for solving problem in the paper is illustrated in fig 5 4 1 panel model panel model describes the tlp s wet surface the panel model is cut into an underwater section and an upside section by waterline then it is meshed into numerous panel elements to calculate potential flow force on the hull the total number of elements used in the study is 9107 and 3666 ones among them are diffracting elements the potential due to incident diffraction and radiation waves are written as 2 φ x e i ω t φ 1 φ d 6 j 1 φ r j x j e i ω t equation 2 is used to get potential flow force including froude krylov force due to incident wave 3 f i j i ω ρ s 0 φ i x n j d s diffracting force due to diffraction wave 4 f d j i ω ρ s 0 φ d x n j d s and radiation force due to radiation wave induced by unit amplitude body rigid motion 5 f r j k i ω ρ s 0 φ r k x n j d s besides wave frequency component the structural time response contains low frequency and high frequency components the low frequency wave force often has a big contribution as drift force to in plane motion of platform it can amplify the range of tlp motion after tendons fail the mean wave drift force coefficients which are calculated firstly in frequency domain are required to determine drift force in time domain far field method is applied for mean drift forces newman 1967 faltinsen and michelsen 1974 the rate of change of linear and angular momentum may be written as 6 d g d t ρ s s f s i n s b p ρ g z n v v n u n d s 7 d h d t ρ s s f s i n s b p ρ g z r n r v v n u n d s based on equations above the resulting mean forces and moment are 8 f x s i n p cos ψ ρ v r v r cos ψ v ψ sin ψ r d ψ d z 9 f y s i n p sin ψ ρ v r v r sin ψ v ψ cos ψ r d ψ d z 10 m z s i n ρ v r v ψ r 2 d ψ d z the second order wave exciting force can be written as pinkster 1980 11 f 2 t i 1 n j 1 n p i j cos ω i ω j t ε i ε j p i j cos ω i ω j t ε i ε j i 1 n j 1 n q i j sin ω i ω j t ε i ε j q i j sin ω i ω j t ε i ε j where the expression of in phase component p i j is as below and the out of phase component q i j is similar to that 12 p i j w l 1 4 ρ g ζ i ζ j cos ε i ε j n n 1 2 n 2 2 d l s 0 1 4 ρ ϕ i ϕ j n d s s 0 1 2 ρ x i φ j t n d s 1 2 m s r i x g j s 0 ρ φ 2 t n d s then to calculate slowly varying drift force of the structure in deepwater depth with irregular waves newman s approximation is used and it can be written as newman et al 1974 13 f s v t i 1 n s p l j 1 n s p l p i j cos ω i ω j t ε i ε j where p i j does not comes from off diagonal values in difference frequency qtf matrix but the average value of mean wave drift coefficients this method can reduce amount of calculation meanwhile the full difference and sum frequency qtf matrices are absent so that high frequency excitation are neglected actually in the research motion response of the same tlp is also calculated by using full qtfs under the same sea state but it has hardly any difference from that by newman s method this means that first the magnitude of sum frequency force is small in total and second the natural frequencies in heave roll and pitch are not in the range of sum frequency dynamic magnification and the mooring stiffness of incomplete structure descents resulting in natural frequency goes down to some extent see table 4 which move towards and approach wave frequency gradually although the sum frequency excitation can lead to high frequent response it is not a main factor to change the transient peak value and steady mean value of motion or tendon response it will not to interfere with the analysis for tendon failure problem moreover wave drift damping wdd is included to feature nonlinear surface wave effects the method to calculate wdd is based on the work of kim and sclavounos 1998 and wdd matrix is shown as below 14 f w d d x ω β f w d d y ω β m w d d r z ω β b 11 ω β b 12 ω β b 16 ω β b 21 ω β b 22 ω β b 26 ω β b 61 ω β b 62 ω β b 66 ω β u 1 u 2 u 6 the drift damping coefficients are estimated by 15 b 11 ω β ω g ω f x ω cos β 2 f x β sin β 4 f x cos β b 12 ω β ω g ω f x ω sin β 2 f x β cos β 4 f x sin β b 21 ω β ω g ω f y ω cos β 2 f y β sin β 4 f y cos β b 22 ω β ω g ω f y ω sin β 2 f y β cos β 4 f y sin β b 61 ω β ω g ω m z ω cos β 2 m z β sin β 4 m z x cos β b 62 ω β ω g ω m z ω sin β 2 m z β cos β 4 m z sin β where f x f y m z are the drift forces and moment and β is the incident wave angle due to the faintness of yaw motion of platform in research b 16 b 26 and b 66 s contributions are very little which are neglected 4 2 morison model water viscosity is neglected in potential flow theory to supply fluid viscous force on numerical model 8 morison members are added along the axes of columns and pontoons as those red lines shown in fig 6 the morison model is not only applied to calculate viscous wave force on columns and pontoons but also current force on them in addition the hydrodynamic force on tendons and ttrs are also derived from the morison equation 16 d f 1 2 ρ d c d u f u s u f u s ρ a c m u f ρ a c m 1 u s where the drag coefficient c d is 1 1 the inertia coefficient c m is 2 0 j r morison j w johnson s a schaaf 1950 due to the inertial force on the hull is calculated by potential flow theory too the inertia term is omitted in this case 4 3 tether model tether models are exclusive for tendons and ttrs they are considered as flexible cylindrical tubes whose diameters are small enough compared to the wavelength the total force f e applied on a tether element consists of the components 17 f e f k f s f i f m where f k is the internal force due to bending structural stiffness f s represents the externally applied forces due to the springs at the end nodes f i represents the integrated forces which consist of gravity hydrostatic forces drag wave inertia the froude krylov force and f m is the force due to the calculation being performed in a moving reference frame at its two ends both encastre conditions are set 4 4 wind force coefficients besides wave and current force the wind feature of superstructure is expressed by directional wind force coefficients by interval of 45 the matrix of coefficients is listed in table 3 below those coefficients in intermediate directions come from interpolation among x y z rx ry and rz refer to 6 dofs respectively i e surge sway heave roll pitch and yaw 4 5 calculation method for tendon failure for prevalent hydrodynamics tools a universal method to realize mooring failure of a floating structure is proposed this method can be divided into steps below first do time response analysis for a healthy platform which has no failed tendon second extract the tendon force time history acting on hull from the one which could have failed third keep other all conditions unchanged apply that force history on hull from initial time to the time of tendon failure and then fourth solve again to get results to deal with several tendons progressive failure these steps above can be followed with circularly make a superposition of every failed tendon s force history in different time length the method is attributed to that mooring lines are always slender parts in a small scale and they do not almost disturb the flow field based on potential flow theory a series of calculation tests are performed to confirm its equivalence between failed tendon existing and disappearing 4 6 tendon hanged model there are two typical failure conditions for tendon the one is disconnection between its top and hull and the other one is between its bottom and seabed i e it is hanged by hull the former can be achieved by removing directly tether model from whole mooring system the latter can be done only by extra effort actually a tendon hanged math model should be organized and then program the model to participate in motion coupling calculation after original tether removed so that failed tendon hanged by hull still exists mathematically a subroutine is programmed by fortran formula translator and a dynamic link library dll is generated wang baoqi 2007 when it is called in every step in time integral the hull s motion parameters are imported from main routine it exports and feeds external force value back to main routine finally the subroutine describes a real time functional relation about the hanged tendon force to tlp motion axis transformation is required in designing the math model above with euler rotation matrix e the coordinate in fra of any point fixed on rigid body can be expressed as 18 x y z x g y g z g e x y z where x g y g z g t is the coordinate of cog in fra and x y z t is that of object point in lsa 5 model verification the time domain results are determined directly by frequency domain analysis to validate the numerical model in frequency domain an elaborative contrast has been done with the reference paper r eatock taylor e r jefferys 1986 the contrast includes that the first order wave force rao radiation damping added mass and mean horizontal drift forces these data are the necessary parameters input to floater motion time integral equation as a result the frequency domain parameters of our model fits well those in the published paper no matter modulus or phase here some key frequency domain results are given as below note that the red curves represent the data gained by author from the numerical model of target tlp the point background represents reference data see figs 7 11 6 results and discussions before the formal analysis about load cases in extreme typhoon several tests and still water tests are executed static offset test and free decay test are to calibrate and verify the numerical model and calm sea test are to prove the method to achieve tendon failure valid 6 1 static offset test the restoring force versus tlp offset and set down for the entire model with full ttrs is tested in 45 and its curves are shown in following fig 12 the corresponding up wave and down wave tendon tension curves are also presented in fig 13 note that the horizontal restoring force is in the same direction with displacement which consists of f x and f y components according to fig 13 the more offset of the platform the more tension difference between up wave and down wave tendon and up wave tension is greater than down wave also down wave tension does not almost rise in the offset range under 50m the rise of up wave tension alone means the more possibility that up wave tendon fails 6 2 free decay test to acquire the structural natural periods in every dof a series of free decay tests are performed its natural periods are significant to time response after tendon failure because some natural periods maybe have a change the displacement decay curves are plotted respectively in fig 14 and fig 15 table 4 shows the mooring system s natural period and damping ratio which are obtained from decay curves in 6 dofs tang yougang 2002 the damping ratios are approximately the same order of magnitude in surge sway and yaw in other dofs damping ratios are almost the same in a very smaller magnitude different mooring stiffness in dof leads to various natural periods essentially the period values above avoid wave energy main distribution between 4s and 30s 6 3 failure in calm sea tendon failure in calm sea can predict structural transient effect and steady state about its motion and mooring response of residual tendons and ttrs since the model is trimmed to the equilibrium position at time zero initial condition effect can be neglected in time response analysis under calm sea so that only 50 s is retained before tendons fail to contrast the sudden changes out calm sea is the most ideal condition in structural design so when only one tendon fails the other tendon at the same corner will be a substitute to bear all impact by instantaneous surplus buoyancy around loads transfer to the other one consequently little motion can be induced by contrast the whole tension leg failure leads to intensive even catastrophic response in other words 2 tendons fail no 1 and 2 tendons are set to fail synchronously at 50s the 6 dof displacement curves of cog are shown in figs 14 and 15 the transient effect which means curves fluctuate sharply than entire model at tendon broken time occurs in surge sway heave and roll pitch because of the mooring symmetry in 45 curves in surge and sway nearly overlap and the ones in roll and pitch form a mirror image about zero axis the motion in these dofs can be summarized that two components equilibrium position offset and decay the most obvious offset appears in heave about 0 3m upward and in tilt around 135 line of heading direction naming diagonal here this is attributed to restoring moment by roll pitch just counteracts the unbalanced pretension by tendons left due to the pretension of failed leg is redistributed and added on other ones tendons become stretched a little longer the 0 3m heave of cog is mainly from tilt of hull the unbalanced mooring force also causes horizontal offset in 45 about 0 25 2 m the decay in heave roll and pitch are high frequent owing to high stiffness still in these dofs even though 2 tendons cancelled high decay rates are presented those decays in roll and pitch are in low frequency decaying slowly to be more clearly the cog trajectory by time and its projective on cog plane are illustrated in fig 16 tendon failure brings about mooring disturbance to residual tendons which is illustrated in fig 17 in terms of result data tension responses do not differ very much between t1 and t2 t5 and t6 t3 and t8 t4 and t7 so some tendons are ignored to simplify the figure actually to a tilt plane the tensions of constraint crucially depend on their distance to neutral axis from where applied here neutral axis refers to diagonal normally to one same tendon effective tension at an upper node is larger than that at a lower node caused by its buoyant weight so then the top nodes of tendon are focused on tendon effective tension at top fluctuates hugely after failure not only does t3 t8 bear 3 times force does t4 t7 bear 2 5 times as static before but also t5 t6 s force goes down very much even be less than zero see fig 17 based on code check the effective tension is negative means global buckling happens this is to say tensile strength failure is not the only failure type to tlp when tendon fails different types participate in one failure condition makes a response curve maybe contains several components and becomes complicated when buckling t5 t6 sustains their corner of hull upwards rather than pull it down as normal as fluctuation decays they are switching between tensile state and compressive state if regarding the fragmentary system as a teeterboard which rotates around diagonal axis t3 t4 t7 and t8 form the pivot t5 t6 firstly resists the platform to keep level and after a critical angle which is not the new equilibrium position to a certain extent also resists its further tilt finally top effective tension of t5 t6 is maintained steadily at about 0 8e 03 kn still being stretched at the end t3 is 3 17e 04 kn and t4 is 2 76e 04 kn top effective tension since breakage tension of single tendon is up to 6 7e 04 kn which is based on material property 4 5 times as pretension even the peak of t3 in fig 17 cannot be large enough to tensile failure when peak impacts t3 has 27 6 tension reserve t4 has 39 4 tension reserve compared to tendons disturbance ttrs effective tension at top node hardly has a big change the max amount of increase just reaches about 17 in fig 18 the increment of different ttr very depends on its position it has the similar principle with tendon s tension the sequence r1 r9 r4 r12 the tension from large to small is just the distance sequence to diagonal from its one side to the other see fig 19 ttrs are connected by tensioners with hull and the riser length at zero stroke is 470m when tendons fail the distance between the top node and bottom node of r1 climbs to 470 72m only 2 4s used this value of r12 is 470 45m also in 2 4s see fig 20 although 0 7m down stroke is still in the range of tensioner s effective stroke the speed rate of down stroke at that short moment 0 28 m s can be seen rarely enough to damage the tensioner probably 6 4 irregular wave with slow drift there are four typical cases occurring when tendon failure they are single tendon failure double tendon failure tendon progressive failure and tendon hanging after failure except of progressive failure other three belong to one time failure to make comparisons all of these are performed under one same wave time history in extreme 1000 yr tropical cyclone only changing environment direction in which wind wave and current go co linear together to eliminate the initial condition effect of time domain 250s initial phase before tendons fail remains in every time run the time step for integration of motion equation is 0 1s short enough to the structure 6 5 single tendon failure in this case t1 is set to fail at 250s sea loads in 225 up wave and 45 down wave are applied on the 7 tendon tlp these two directions are in back diagonal line based on the definition of diagonal mentioned above when 225 t1 t2 is up wave t5 t6 is down wave when 45 it conversely only single tendon fails tlp still has 4 legs at corners the tension in the lost one is transferred to t2 instantly the whole structure still keeps its stability the effective tension in tendons and ttrs are illustrated by curves in different color in fig 21 fig 22 and fig 23 below when single tendon failure occurs at up wave position tension impact on the other tendon is much more intensive than that at down wave in the former t2 s peak tension approaches to 6 7e 04 kn which is the breakage tension if t2 cannot survive in that impact a case called progressive failure is created and this will be talked about in the section below here only the condition that not broken is discussed in the latter t2 s peak tension just gets to about 4 25e 04 kn the risk to broken does not exist at all on the other hand when one tendon fails the tendon opposite to it along back diagonal becomes a little loose because its tension goes down but it does not become so slack that buckling the other tendon of broken leg prevents this situation happening in one tendon failure case ttr tension does not rise up a lot see r6 6 6 double tendons under the same corner failure t1 and t2 fail synchronously at 250s in the case when tlp loses one tension leg i e 2 tendons under the same corner the structure then enters into another steady shape which is described in figs 14 and 15 it is tilted to an unstable mooring system there are 4 directions to be discussed including 180 parallel up wave 0 parallel down wave 225 up wave and 45 down wave to find out more response details 1 180 parallel up wave to assess the magnitude of slowly drift force the percentage curve of low frequency drift force among total horizontal force is drawn in fig 24 mooring force in surge is chosen to represent total sea load on hull neglecting the unsteady phase at beginning total load value fluctuates around 3 5e 04 kn and drift force accounts for average 10 of it this percent fits roughly the given value in the reference faltinsen o m 1990 the max percentage is up to 40 and drift force is almost unidirectional rather than reciprocating so it is necessary to calculate the slowly drift effect of wave to predict in plane motion response after tendon is lost tendon and ttr tensions are shown in fig 25 and fig 26 2 0 parallel down wave note figs 24 26 belong to 1 from fig 27 and fig 28 failure happens in an extreme sea state but the displacement time response in x and z does not almost show apparent transient effect only y does 2 tendons under the same corner failure makes tlp form an incomplete structure which is same with the one in calm sea failure except of environment condition but there are transient responses in calm sea failure see figs 14 and 15 this means that transient response when tendons fail depends on the specific environment condition the closer to motion limitation the position of hull is when tendons are broken the less transient effect it has after the broken time the most representative curves are displacement in y because the direction of sea load in 0 the hull is still at equilibrium position in y when motion in x z is limited by tendons initial length and axial stiffness tendon tensions are shown in fig 29 3 225 up wave note fig 30 and fig 31 belong to 3 4 45 down wave in a 1000 yr sea state 2 tendon failure at the same corner is fatal to whole tlp hull tendon ttr system especially the corner is at up wave position from fig 30 in 225 t3 has a big risk to broken down subsequently comparatively such a risk in 45 can be much less than that the reason is that t3 tension in former has an average level higher than 7 0e 04 kn the one in latter only has a peak close to breakage tension its average is about 4 3e 04 kn being more safe shown in fig 32 once more than 2 tendons fail other tendons left will not be able to keep station for the platform under such an intensive sea load even more severe tendons left fail progressively moreover in 180 and 225 tendon buckling appears see figs 25 and 30 this can be another reason to tendon failure in other directions the downward compressive position on hull caused by tilt is at the up wave corner the up wave tendon on a healthy tlp usually bears the highest tension among others see unsteady phase before broken in figs 30 and 32 in riser aspect illustrated by figs 26 and 31 and fig 33 the max effective tension gets to 1 6e 03 kn about 1 6 times its initial pretension and the distance is prolonged from 470m to 471 8m to normal tensioner stroke and stiffness this length and tension leap is enough to make tensioners bottom out or damaged some research about tendon one time failure of tlp has been also done before chan k yang m h kim 2010 moo hyun kim zhi zhang 2009 by contrast the time history results with theirs there are very similar features in the motion and tendon response curves no matter both in transient the shape of peak impulse and steady stages the regular pattern of tension distribution in residual tendons in this manuscript more research on tendon progressive failure is done 6 7 tendon progressive failure single and double tendon failure above are both in one time they regard the residual mooring system after broken time as an unchangeable structure in fact it is impossible for any tendon to be avoided failing when it works around structural limit even though no induction factor appears e g its own reliability problem when all the tendons of tlp work well the structure is the most sturdy to withstand environment loads the more tendons tlp loses in an extreme sea state the more possible it is to experience subsequent destruction this is like a vicious circle and chain reactions are often motivated to a progressive failure process in terms of the cases analyzed above the most dangerous direction of 225 up wave is chosen to predict one disastrous whole process from entire tlp to nearly global failure of mooring system it is still for t1 to be induced to broken down at 250s it is a more complicated case following with the one in single tendon failure in 225 the whole process can be divided into 3 stages firstly t1 to t2 secondly t2 to t3 t8 and thirdly t3 t8 to more tendons broken down 1 tendon 1 to tendon 2 in 225 up wave for the entire tlp under the 1000 yr sea state the tension reverse of tendons is around 55 70 from fig 21 a very adequate reverse to break its design criterion an external incentive is needed in the case tlp loses t1 perhaps because of tendon part s insufficient strength instantaneous intensive impact fatigue problem under wave collision with ships or corrosion by seawater and this coincidently is at the up wave position the posture of platform in the first stage is shown from fig 34 to fig 36 arrows in the pictures represents wind wave and current respectively fig 34 is just before t1 s broken time fig 35 is right after t1 s broken time and fig 36 is just after t2 s broken time the broken time for t2 is determined by its effective tension time history in case above only t1 failure 225 shown in fig 37 its peak value at 251 5s is very close to the breakage tension so 251 5s is chosen for t2 4 legs it still has keep the platform level the comparison for tension curves of tendon between one time failure and progressively is illustrated in fig 38 similar comparison for displacement is in fig 39 the maximal difference is 0 77 in x y 15 39 in z and 46 53 in rx ry respectively owing to the only 1 5s time difference the structural time response is obviously different from the case t1 and t2 failure synchronously in the range from 250s to 300s out of the range before or after curves overlap with that case very well this reveals that if time difference between 2 tendons is short enough the structural response in progressive failure will be identical to that in synchronous failure except of a transient effect stage right after the earlier broken time curves overlap again because of the system s energy dissipation to transient difference the response difference is actually an impulse response in addition the more the time difference is the longer the time span should be waited for if the transient difference is unconcerned about a simplified failure case can be designed to analyze after t2 is lost by tlp t3 t8 s tension easily breaks through the limit so it enters the second stage t2 to t3 t8 2 tendon 2 to tendon 3 8 in 225 up wave note figs 34 39 belong to 1 in this stage t1 and t2 do not participate in mooring any more then t3 t8 is stretched into its limit state their tension curves in the first stage are zoomed in fig 42 from fig 38 their tensions fluctuate in an upward tendency and the highest peak time at 260 8s is looked upon as their most possible broken time note that all the broken times for tn refer to the last time tn still moors hull not the time tn is just disconnected with it the posture of platform in the second stage is shown in fig 40 and fig 41 fig 40 is right before t3 t8 broken time and fig 41 is the very next time step combined with the platform posture in the first stage after 9 3s interval the hull tilts a very large angle around diagonal one hand when 2 tendons under the same column is lost the hydrostatic position of hull is tilting caused by surplus buoyancy around corner on the other hand the tilted hull turns its bottom plane to the coming loads from wave and current so a component force upward tilts hull further the tension of tn displacement and tension of rn are monitored respectively in fig 43 fig 44 and fig 45 the motion in every dof has a great increment in the second stage than before riser s tension doubles for r1 so that it has a huge risk of being damaged in progressive failure process by observing the tension curves of t4 t7 they are surely undergoing a tensile failure right after 260 8s actually after t3 t8 broken down the residual mooring system gets into the third stage immediately global mooring failure 3 tendon 3 8 to more ones in 225 up wave note figs 40 45 belong to 2 global mooring failure begins from the time t3 t8 broken down with t4 t7 failing next 6 tendons of total 8 ones are lost in an extreme sea state the 2 ones left certainly cannot be strong enough to keep station for hull under such a violent environment even though they still keep working such few tendons cannot maintain tlp s stability ttrs also have a large possibility of being damaged after all they are not the primary members for mooring in design such 3 stages in a progressive failure exhibits a typical case that how a local mooring failure develops to a catastrophic global mooring failure of a tlp by the way if the first tendon failure occurs at the 45 down wave any other tendon does not have the danger of tension fracture see fig 23 6 8 tendon hanging as a supplement to failure from tendon s top end the bottom end breakdown is evaluated only one tendon failure at the up wave and down wave are performed in tendon hanging namely 225 and 45 the purpose of hanging case is to investigate how much influence on motion response of tlp the hanging tendon has than tendon s top failing a subroutine is programmed in fortran to characterize the hanging tendon in model space after its broken time same calculation parameters are used with other one time failures before in the paper suppose that the hanging tendon only has interaction with hull at connection position and it is so slender enough that its motion disturbance to fluid field is neglected the motion responses between no tendon hanging and hanging are shown from figs 46 52 because of the symmetry of model displacements in y and ry are omitted due to the horizontal force by current on the hanging tendon the offset in x of hull is greater than that with no hanging by about 0 8m 1 45 of total offset this is to say if steady horizontal loads exists e g current the platform s offset can be a little larger in vertical direction except of a short time of transient impact the hanging case has more set down than no hanging case about 0 2m lower 4 44 of total set down this is a combination effect of the hanging tendon s own buoyant weight and lateral loads in angular displacements it has almost no change in rx about mean value and amplitude from no hanging case but in a low parallelism with it compared to offset or set down curves moreover the hanging tendon changes hull s yaw direction into the opposite also with mean value and amplitude not changed even though the degree is too small to observe all in all when tlp is under an extreme environment the hanging tendon may magnify the motion response but the increment is still too small to run a specialized hanging case if unnecessary 7 summary and conclusion a series of tendon one time failure and progressive failure for a whole tlp with ttrs are analyzed under an extreme tropical cyclone on south china sea in article besides an assessment of influence of hanging tendon 3d potential flow theory and a hull tendon ttr coupling model are adopted to obtain its various failure consequences different disconnection positions of tendon up wave and down wave also top and bottom breakdown are all tested based on time domain results and discussions above some conclusions are drawn as follow not only does tensile strength failure for tendons happen in local mooring failure of tlp but also tendon s global buckling that its effective tension become negative according to criterion in code check it maybe leads to different response components in same one time history the component from ultimate strength and the component from buckling appear alternately around the critical point at zero effective tension transient effect of mooring structure after tendon failure under extreme sea load is more obvious than that of hull motion the further away from the equilibrium position the hull is the less transient effect in motion it has right after failure because tlp s motion reserve in plane gets down as it is pushed far away by sea load low frequency drift effect should be considered when tlp loses tendons the in plane drift load achieves average 10 maximal 40 of total horizontal loads this can magnify tlp s offset and set down even rotation with residual moorings and it is easy to understand the more tendons the platform loses the more apparent the magnification effect becomes although transient effect of motion is relatively slight by range limit drift load increases mooring response of tendon as a result reducing their tension reserve by comparison between responses in failure progressively and failure synchronously a rule is acquired as below to analyze a progressive failure if time difference between 2 tendons broken is short enough to neglect the exact transient process a 2 tendon one time failure can be substituted for its time response this is an excellent simplified method to cope with those situations that there are several tendons waiting to fail but some of their broken times are very close to each other e g theirs are within same a second a global mooring failure maybe follows with an initial local mooring failure obtaining from the progressive failure case in an extreme sea state a tlp has no enough bearing capacity of any tendon failure at key position it can eventually develop to a global mooring failure even the platform s absolutely overturning as long as only one up wave tendon fails initially if a definition of structural robustness is that one important attribution of engineering structure to keep its global stability when and after an accident occurs and not to undergo collapse or progressive damage which is not unbecoming to the accident on severity so a lack of robustness of the tlp under extreme environment leads to its global mooring failure tendon hanging influence on platform s motion is too small to establish a case alone specialized in it even though the hanging case is on a dangerous side sometimes and the hanging tendon will almost not change the motion response feature of platform acknowledgements the author would like to appreciate the financially support from national natural science foundation of china for youth grant no 51609169 national key r d program of china grant no 2018yfc0310500 guangxi science and technology major project grant no guike aa17292007 and national natural science foundation of china grant no 51779173 in the research appendix a supplementary data the following is the supplementary data to this article multimedia component 1 multimedia component 1 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j oceaneng 2019 04 049 
22806,in deepwater oil and gas field development a tension leg platform tlp consists of a hull tendons and top tension risers ttr when one or more tendons failure due to extreme sea state a tlp will be under the working condition which is very different from its design condition showing structural instability and transient effect to enhance the safety and global stability of whole tlp system obtaining failure consequences is necessary by 3d potential flow theory and panel element method a series of mooring analyses are performed for the target tlp to predict its coupled hydrodynamic response after tendon one time failure and in particular during progressive failure of several tendons different directions of environment load that including extreme wind wave and current and tendon failure positions are considered in the results the motion response of the hull the force from residual tendons and ttrs are presented keywords tendon failure progressive failure hull tendon top tension riser ttr coupling model local mooring failure tendon hanging irregular wave with slow drift 1 introduction tension leg platform tlp is one major type of offshore structures which are used in deepwater oil and gas field development a whole tlp generally includes three parts the hull which is the main body of the platform floating on the sea tendons which are the crucial part to form tension legs fastening the hull downward to wellhead on seabed in general each leg consists of 2 or 3 tendons and risers the specific type corresponding to a tlp is top tension riser ttr used for oil drilling or production transfer although so far offshore engineering design specifications demand to take the redundancy for mooring failure of floating structure into account e g global performance will not be affected after one mooring line fails and the platform will not overturn or drift away after two lines fails etc the accidental extreme sea state are not considered as an external excitation condition and the chain reaction from multi line failure is neglected in previous research in fact the probability for a tlp in healthy condition to undergo tendon failure may be maximal when it is in an extreme sea load and the broken position along one tendon is most probably at its upper end close to hull or its lower end on seabed compared with tendon one time failure multi tendon progressive failure is significant because these progressive processes can describe a more real failure path and different response occurs when tendons fail one by one than two tendons one time fail during past years some researches on floating platform especially tlp have been conducted by relevant scholars a time domain vessel mooring riser coupled dynamic analysis has been developed for multi floating systems e g ran and kim 1997 kim et al 2001 the hydrodynamic coefficients of floaters are calculated from wamit lee et al 1991 the importance of the hull mooring riser coupled dynamic analysis for deepwater floating systems is well clarified in ma et al 2000 and wichers and devlin 2004 q zhang c b zhao et al 2013 focus on tendon response of 10 mw offshore wind turbine tlp platform in extreme environment condition nematbakhsh ali et al 2015 makes comparison of wave load effects on a tlp wind turbine by using cfd and potential flow theory chengxi li 2015 does a numerical investigation of a hybrid wave absorption method chengxi li jun zhang 2016 perform a nonlinear coupled dynamics analysis of a truss spar platform hanqing zhang et al 2017 illustrate interference of ttr for tlp yan li et al 2017 study effects of second order wave forces and aerodynamic forces on dynamic responses of a tlp type floating offshore wind turbine zhang a f et al 2017 makes analysis of mooring performance parameters of tlp based on aqwa gao wei zhang jichun zhu weiquan 2017 perform global motion analysis of conventional tlp in relative shallow water region of south china sea t p mazarakos s a mavrakos 2017 investigate experimentally on mooring loads and motions of a tlp floating wind turbine teng wang yujie liu 2018 calculate dynamic response of platform riser coupling system with hydro pneumatic tensioner chengxi li et al 2018 make a study on the weakly nonlinear seekeeping solution near the critical frequency zhang z et al 2009 researches progressive mooring line failure of a deepwater modu in hurricane conditions gu jiayang et al 2015 make a study on the dynamic response and tension characteristics of a tlp with one tendon broken damilola o oyejobi et al 2017 does a research on stochastic response of intact and a removed tendon tension leg platform to random wave and current forces mohammad reza tabeshpour et al 2018 makes an investigation of tlp behavior under tendon damage people mostly pay attention to hull s motion and mooring lines own response even no riser model is built when mooring system breakdown not only residual mooring lines but risers on floating body also experience impact even damage but the response of riser is generally ignored in previous research in the aspect of mooring failure the transient effect of tendon disconnection on the global motion of etlp is focused on by chan k yang et al 2008 kim and zhang 2009 study transient effects of tendon disconnection on the survivability of a tlp in moderate hurricane transient effects of tendon disconnection of a tlp are researched by hull tendon riser coupled dynamic analysis yang and kim 2010 aysan jamalkia et al 2016 make damage detection of tlp and spar floating wind turbine using dynamic response of the structure y h bae m h kim h c kim 2017 discuss performance changes of a floating offshore wind turbine with broken mooring line yan li et al 2018 investigate transient response of a spar type floating offshore wind turbine with fractured mooring lines although various failure positions and combinations are simulated before few scholar performs analysis on progressive mooring failure to floating platforms in other words the case mooring lines fail one by one by some certain criteria further few people is concerned with what a different result such failure one by one brings about the present paper focuses on a series of mooring analyses for a tlp with ttrs when its tendons fail to get the subsequent behaviors of the platform and mooring system response including remanent tendons and risers one time failures caused by different number of tendon and in various sea load direction are performed and progressive failures caused by multi tendon are also performed furthermore comparisons between the two kinds of failure mode above are made to assess the latter one s necessity and their response difference is focused on to estimate the range of progressive effect not only are slow drift force from the 2nd order wave component calculated but also wind force defined by npd spectrum other than steady wind act on the upper structure both of tendon s and ttr s responses are analyzed a calculation method for tendon failure is proposed and the influence by hanged tendon is predicted by a self programmed subroutine in the manuscript 2 tlp tendon and ttr configuration 2 1 hull the target tlp applied in research is a classic tlp with 4 vertical cylindrical columns and 4 rectangular pontoons horizontal at bottom r eatock taylor e r jefferys 1986 as shown in fig 1 2 2 tendon the mooring system of the tlp is comprised of 8 tendons divided into 4 tension legs with 2 tendons each every 2 tendons are connected with the lower end of one corner column by tendon porch and their another ends are locked by subsea receptacles in detail the angle between a pair of tendons relative to column axis is 60 and their connection position is 9 94m offset and 4m height not on the column bottom circle see fig 2 according to design api 5l x70 steel pipe are adopted as main material of tendon with 0 038m in wt and 1 016m in od the pretension of each tendon for full riser configuration is 1577 1 mt in terms of steel specification the tensile strength of x70 is 570 mpa api specification 5l 2012 so the nominal breakage tension for the single tendon is about 6 7e 04 kn this is a main check criterion to tendon failure api rp 2t 1997 2 3 ttr a total of 12 ttrs are installed on the platform with layout of a 3 4 array shown in fig 3 as a majority of risers are production riser e g always only one drilling riser exists all of them are regarded as production ones to form a symmetry riser system each riser is 0 273m in od and 0 01m in wt the payload of each riser is 101 1 mt it is about 1 10 total pretension of tendons for the full risers the top of risers are hanged by hydraulic tensioners at 20m height above waterline and at the geometry center of hull in horizontal the tensioner stiffness at its equilibrium position when riser stroke is zero is 2 75e 05 n m all of the subsea connection points no matter for tendons or risers are vertically corresponding to their hull ends respectively and they are all located in the same seabed plane 3 environmental condition and load cases the water depth where the tlp operates is 450m which belongs to deepwater which is defined in offshore engineering subrata k chakrabarti 2005 absolute calm sea condition is applied in some test analyses to verify the tlp modeling and to get its fundamental structural attributions e g static offset test free decay test and tendon failure test in no any sea load etc it is the most possible that tendon failure occurs on tlp when it encounter an extreme sea state because a conventional environment condition which is not so acute could have been verified in design phase that it is not enough to destroy the structure or any of its parts and some typical mooring failure tests in mild sea are generally demanded in code design api rp 2t 1997 moreover the more intensive sea load acts on structure the lower reliable the structure or its local part becomes thus a tropical cyclone or typhoon condition is set as the sea state in paper of course it is also one of design criteria for the initial platform without any damaged omnidirectional typhoon environment data from the south china sea are selected to form a dangerous combination of max wave max wind and max current once in 1000 year and three of them are in same direction this is a survival case for the healthy platform in design details of the metocean are listed in table 2 below irregular wave has randomicity in superposition of element waves so it will lead to different waves from one spectrum to analyze the result from different failure conditions and get some laws though in irregular wave a same time history of wave surface is needed there are many complicated components are distributed at two ends of tension leg to guarantee its valid mooring connection in addition a slender bar like tendon always has high stress area close to its ends when a crucial part porch or tendon connector at a tendon end is damaged by insufficient strength impact fatigue collision or corrosion the tendon will be disconnected from its top or bottom and then danger happens tendon and ttr number heading and sea load direction including wind wave and current are defined in fig 4 local structure axes lsa o x y z are fixed at the cog of hull following with it to move and fixed reference axes fra o x y z are placed at the origin of model space it is global and never moved directions of wave current and wind are all defined by directions they go toward in x o y plane due to symmetry of the structure there are only 0 30 and 45 directions needed to check for a healthy tlp but during tendon failure structural response more depends on wave direction relative to failed tendon than absolute wave direction changing wave direction is equivalent to changing position of failed tendon therefore 45 and 225 are chosen for load cases when the failed tendon is most close and far away to coming wave i e up wave and down wave so called for continuity of load case changing 0 and 180 are also calculated 4 numerical model a composite model is constructed for the target tlp which consists of three parts that a panel model a morison model and a tether model which are shown in fig 6 rule tn is short for the n th tendon similarly rn is for riser finally a whole hull tendon ttr coupling numerical model is generated for mooring analysis api 2005 api 2007a faltinsen o m 1990 the motion equation of floating structure in the time response analysis is shown as below cummins w e 1962 1 m a x t c x t k x t 0 t r t τ x τ d τ f t and those hydrodynamic parameters in it which shows structural property are acquired from the frequency domain analysis done in front the wave force rao radiation damping and added mass etc are checked in accordance with design information r eatock taylor e r jefferys 1986 a sketch map for solving problem in the paper is illustrated in fig 5 4 1 panel model panel model describes the tlp s wet surface the panel model is cut into an underwater section and an upside section by waterline then it is meshed into numerous panel elements to calculate potential flow force on the hull the total number of elements used in the study is 9107 and 3666 ones among them are diffracting elements the potential due to incident diffraction and radiation waves are written as 2 φ x e i ω t φ 1 φ d 6 j 1 φ r j x j e i ω t equation 2 is used to get potential flow force including froude krylov force due to incident wave 3 f i j i ω ρ s 0 φ i x n j d s diffracting force due to diffraction wave 4 f d j i ω ρ s 0 φ d x n j d s and radiation force due to radiation wave induced by unit amplitude body rigid motion 5 f r j k i ω ρ s 0 φ r k x n j d s besides wave frequency component the structural time response contains low frequency and high frequency components the low frequency wave force often has a big contribution as drift force to in plane motion of platform it can amplify the range of tlp motion after tendons fail the mean wave drift force coefficients which are calculated firstly in frequency domain are required to determine drift force in time domain far field method is applied for mean drift forces newman 1967 faltinsen and michelsen 1974 the rate of change of linear and angular momentum may be written as 6 d g d t ρ s s f s i n s b p ρ g z n v v n u n d s 7 d h d t ρ s s f s i n s b p ρ g z r n r v v n u n d s based on equations above the resulting mean forces and moment are 8 f x s i n p cos ψ ρ v r v r cos ψ v ψ sin ψ r d ψ d z 9 f y s i n p sin ψ ρ v r v r sin ψ v ψ cos ψ r d ψ d z 10 m z s i n ρ v r v ψ r 2 d ψ d z the second order wave exciting force can be written as pinkster 1980 11 f 2 t i 1 n j 1 n p i j cos ω i ω j t ε i ε j p i j cos ω i ω j t ε i ε j i 1 n j 1 n q i j sin ω i ω j t ε i ε j q i j sin ω i ω j t ε i ε j where the expression of in phase component p i j is as below and the out of phase component q i j is similar to that 12 p i j w l 1 4 ρ g ζ i ζ j cos ε i ε j n n 1 2 n 2 2 d l s 0 1 4 ρ ϕ i ϕ j n d s s 0 1 2 ρ x i φ j t n d s 1 2 m s r i x g j s 0 ρ φ 2 t n d s then to calculate slowly varying drift force of the structure in deepwater depth with irregular waves newman s approximation is used and it can be written as newman et al 1974 13 f s v t i 1 n s p l j 1 n s p l p i j cos ω i ω j t ε i ε j where p i j does not comes from off diagonal values in difference frequency qtf matrix but the average value of mean wave drift coefficients this method can reduce amount of calculation meanwhile the full difference and sum frequency qtf matrices are absent so that high frequency excitation are neglected actually in the research motion response of the same tlp is also calculated by using full qtfs under the same sea state but it has hardly any difference from that by newman s method this means that first the magnitude of sum frequency force is small in total and second the natural frequencies in heave roll and pitch are not in the range of sum frequency dynamic magnification and the mooring stiffness of incomplete structure descents resulting in natural frequency goes down to some extent see table 4 which move towards and approach wave frequency gradually although the sum frequency excitation can lead to high frequent response it is not a main factor to change the transient peak value and steady mean value of motion or tendon response it will not to interfere with the analysis for tendon failure problem moreover wave drift damping wdd is included to feature nonlinear surface wave effects the method to calculate wdd is based on the work of kim and sclavounos 1998 and wdd matrix is shown as below 14 f w d d x ω β f w d d y ω β m w d d r z ω β b 11 ω β b 12 ω β b 16 ω β b 21 ω β b 22 ω β b 26 ω β b 61 ω β b 62 ω β b 66 ω β u 1 u 2 u 6 the drift damping coefficients are estimated by 15 b 11 ω β ω g ω f x ω cos β 2 f x β sin β 4 f x cos β b 12 ω β ω g ω f x ω sin β 2 f x β cos β 4 f x sin β b 21 ω β ω g ω f y ω cos β 2 f y β sin β 4 f y cos β b 22 ω β ω g ω f y ω sin β 2 f y β cos β 4 f y sin β b 61 ω β ω g ω m z ω cos β 2 m z β sin β 4 m z x cos β b 62 ω β ω g ω m z ω sin β 2 m z β cos β 4 m z sin β where f x f y m z are the drift forces and moment and β is the incident wave angle due to the faintness of yaw motion of platform in research b 16 b 26 and b 66 s contributions are very little which are neglected 4 2 morison model water viscosity is neglected in potential flow theory to supply fluid viscous force on numerical model 8 morison members are added along the axes of columns and pontoons as those red lines shown in fig 6 the morison model is not only applied to calculate viscous wave force on columns and pontoons but also current force on them in addition the hydrodynamic force on tendons and ttrs are also derived from the morison equation 16 d f 1 2 ρ d c d u f u s u f u s ρ a c m u f ρ a c m 1 u s where the drag coefficient c d is 1 1 the inertia coefficient c m is 2 0 j r morison j w johnson s a schaaf 1950 due to the inertial force on the hull is calculated by potential flow theory too the inertia term is omitted in this case 4 3 tether model tether models are exclusive for tendons and ttrs they are considered as flexible cylindrical tubes whose diameters are small enough compared to the wavelength the total force f e applied on a tether element consists of the components 17 f e f k f s f i f m where f k is the internal force due to bending structural stiffness f s represents the externally applied forces due to the springs at the end nodes f i represents the integrated forces which consist of gravity hydrostatic forces drag wave inertia the froude krylov force and f m is the force due to the calculation being performed in a moving reference frame at its two ends both encastre conditions are set 4 4 wind force coefficients besides wave and current force the wind feature of superstructure is expressed by directional wind force coefficients by interval of 45 the matrix of coefficients is listed in table 3 below those coefficients in intermediate directions come from interpolation among x y z rx ry and rz refer to 6 dofs respectively i e surge sway heave roll pitch and yaw 4 5 calculation method for tendon failure for prevalent hydrodynamics tools a universal method to realize mooring failure of a floating structure is proposed this method can be divided into steps below first do time response analysis for a healthy platform which has no failed tendon second extract the tendon force time history acting on hull from the one which could have failed third keep other all conditions unchanged apply that force history on hull from initial time to the time of tendon failure and then fourth solve again to get results to deal with several tendons progressive failure these steps above can be followed with circularly make a superposition of every failed tendon s force history in different time length the method is attributed to that mooring lines are always slender parts in a small scale and they do not almost disturb the flow field based on potential flow theory a series of calculation tests are performed to confirm its equivalence between failed tendon existing and disappearing 4 6 tendon hanged model there are two typical failure conditions for tendon the one is disconnection between its top and hull and the other one is between its bottom and seabed i e it is hanged by hull the former can be achieved by removing directly tether model from whole mooring system the latter can be done only by extra effort actually a tendon hanged math model should be organized and then program the model to participate in motion coupling calculation after original tether removed so that failed tendon hanged by hull still exists mathematically a subroutine is programmed by fortran formula translator and a dynamic link library dll is generated wang baoqi 2007 when it is called in every step in time integral the hull s motion parameters are imported from main routine it exports and feeds external force value back to main routine finally the subroutine describes a real time functional relation about the hanged tendon force to tlp motion axis transformation is required in designing the math model above with euler rotation matrix e the coordinate in fra of any point fixed on rigid body can be expressed as 18 x y z x g y g z g e x y z where x g y g z g t is the coordinate of cog in fra and x y z t is that of object point in lsa 5 model verification the time domain results are determined directly by frequency domain analysis to validate the numerical model in frequency domain an elaborative contrast has been done with the reference paper r eatock taylor e r jefferys 1986 the contrast includes that the first order wave force rao radiation damping added mass and mean horizontal drift forces these data are the necessary parameters input to floater motion time integral equation as a result the frequency domain parameters of our model fits well those in the published paper no matter modulus or phase here some key frequency domain results are given as below note that the red curves represent the data gained by author from the numerical model of target tlp the point background represents reference data see figs 7 11 6 results and discussions before the formal analysis about load cases in extreme typhoon several tests and still water tests are executed static offset test and free decay test are to calibrate and verify the numerical model and calm sea test are to prove the method to achieve tendon failure valid 6 1 static offset test the restoring force versus tlp offset and set down for the entire model with full ttrs is tested in 45 and its curves are shown in following fig 12 the corresponding up wave and down wave tendon tension curves are also presented in fig 13 note that the horizontal restoring force is in the same direction with displacement which consists of f x and f y components according to fig 13 the more offset of the platform the more tension difference between up wave and down wave tendon and up wave tension is greater than down wave also down wave tension does not almost rise in the offset range under 50m the rise of up wave tension alone means the more possibility that up wave tendon fails 6 2 free decay test to acquire the structural natural periods in every dof a series of free decay tests are performed its natural periods are significant to time response after tendon failure because some natural periods maybe have a change the displacement decay curves are plotted respectively in fig 14 and fig 15 table 4 shows the mooring system s natural period and damping ratio which are obtained from decay curves in 6 dofs tang yougang 2002 the damping ratios are approximately the same order of magnitude in surge sway and yaw in other dofs damping ratios are almost the same in a very smaller magnitude different mooring stiffness in dof leads to various natural periods essentially the period values above avoid wave energy main distribution between 4s and 30s 6 3 failure in calm sea tendon failure in calm sea can predict structural transient effect and steady state about its motion and mooring response of residual tendons and ttrs since the model is trimmed to the equilibrium position at time zero initial condition effect can be neglected in time response analysis under calm sea so that only 50 s is retained before tendons fail to contrast the sudden changes out calm sea is the most ideal condition in structural design so when only one tendon fails the other tendon at the same corner will be a substitute to bear all impact by instantaneous surplus buoyancy around loads transfer to the other one consequently little motion can be induced by contrast the whole tension leg failure leads to intensive even catastrophic response in other words 2 tendons fail no 1 and 2 tendons are set to fail synchronously at 50s the 6 dof displacement curves of cog are shown in figs 14 and 15 the transient effect which means curves fluctuate sharply than entire model at tendon broken time occurs in surge sway heave and roll pitch because of the mooring symmetry in 45 curves in surge and sway nearly overlap and the ones in roll and pitch form a mirror image about zero axis the motion in these dofs can be summarized that two components equilibrium position offset and decay the most obvious offset appears in heave about 0 3m upward and in tilt around 135 line of heading direction naming diagonal here this is attributed to restoring moment by roll pitch just counteracts the unbalanced pretension by tendons left due to the pretension of failed leg is redistributed and added on other ones tendons become stretched a little longer the 0 3m heave of cog is mainly from tilt of hull the unbalanced mooring force also causes horizontal offset in 45 about 0 25 2 m the decay in heave roll and pitch are high frequent owing to high stiffness still in these dofs even though 2 tendons cancelled high decay rates are presented those decays in roll and pitch are in low frequency decaying slowly to be more clearly the cog trajectory by time and its projective on cog plane are illustrated in fig 16 tendon failure brings about mooring disturbance to residual tendons which is illustrated in fig 17 in terms of result data tension responses do not differ very much between t1 and t2 t5 and t6 t3 and t8 t4 and t7 so some tendons are ignored to simplify the figure actually to a tilt plane the tensions of constraint crucially depend on their distance to neutral axis from where applied here neutral axis refers to diagonal normally to one same tendon effective tension at an upper node is larger than that at a lower node caused by its buoyant weight so then the top nodes of tendon are focused on tendon effective tension at top fluctuates hugely after failure not only does t3 t8 bear 3 times force does t4 t7 bear 2 5 times as static before but also t5 t6 s force goes down very much even be less than zero see fig 17 based on code check the effective tension is negative means global buckling happens this is to say tensile strength failure is not the only failure type to tlp when tendon fails different types participate in one failure condition makes a response curve maybe contains several components and becomes complicated when buckling t5 t6 sustains their corner of hull upwards rather than pull it down as normal as fluctuation decays they are switching between tensile state and compressive state if regarding the fragmentary system as a teeterboard which rotates around diagonal axis t3 t4 t7 and t8 form the pivot t5 t6 firstly resists the platform to keep level and after a critical angle which is not the new equilibrium position to a certain extent also resists its further tilt finally top effective tension of t5 t6 is maintained steadily at about 0 8e 03 kn still being stretched at the end t3 is 3 17e 04 kn and t4 is 2 76e 04 kn top effective tension since breakage tension of single tendon is up to 6 7e 04 kn which is based on material property 4 5 times as pretension even the peak of t3 in fig 17 cannot be large enough to tensile failure when peak impacts t3 has 27 6 tension reserve t4 has 39 4 tension reserve compared to tendons disturbance ttrs effective tension at top node hardly has a big change the max amount of increase just reaches about 17 in fig 18 the increment of different ttr very depends on its position it has the similar principle with tendon s tension the sequence r1 r9 r4 r12 the tension from large to small is just the distance sequence to diagonal from its one side to the other see fig 19 ttrs are connected by tensioners with hull and the riser length at zero stroke is 470m when tendons fail the distance between the top node and bottom node of r1 climbs to 470 72m only 2 4s used this value of r12 is 470 45m also in 2 4s see fig 20 although 0 7m down stroke is still in the range of tensioner s effective stroke the speed rate of down stroke at that short moment 0 28 m s can be seen rarely enough to damage the tensioner probably 6 4 irregular wave with slow drift there are four typical cases occurring when tendon failure they are single tendon failure double tendon failure tendon progressive failure and tendon hanging after failure except of progressive failure other three belong to one time failure to make comparisons all of these are performed under one same wave time history in extreme 1000 yr tropical cyclone only changing environment direction in which wind wave and current go co linear together to eliminate the initial condition effect of time domain 250s initial phase before tendons fail remains in every time run the time step for integration of motion equation is 0 1s short enough to the structure 6 5 single tendon failure in this case t1 is set to fail at 250s sea loads in 225 up wave and 45 down wave are applied on the 7 tendon tlp these two directions are in back diagonal line based on the definition of diagonal mentioned above when 225 t1 t2 is up wave t5 t6 is down wave when 45 it conversely only single tendon fails tlp still has 4 legs at corners the tension in the lost one is transferred to t2 instantly the whole structure still keeps its stability the effective tension in tendons and ttrs are illustrated by curves in different color in fig 21 fig 22 and fig 23 below when single tendon failure occurs at up wave position tension impact on the other tendon is much more intensive than that at down wave in the former t2 s peak tension approaches to 6 7e 04 kn which is the breakage tension if t2 cannot survive in that impact a case called progressive failure is created and this will be talked about in the section below here only the condition that not broken is discussed in the latter t2 s peak tension just gets to about 4 25e 04 kn the risk to broken does not exist at all on the other hand when one tendon fails the tendon opposite to it along back diagonal becomes a little loose because its tension goes down but it does not become so slack that buckling the other tendon of broken leg prevents this situation happening in one tendon failure case ttr tension does not rise up a lot see r6 6 6 double tendons under the same corner failure t1 and t2 fail synchronously at 250s in the case when tlp loses one tension leg i e 2 tendons under the same corner the structure then enters into another steady shape which is described in figs 14 and 15 it is tilted to an unstable mooring system there are 4 directions to be discussed including 180 parallel up wave 0 parallel down wave 225 up wave and 45 down wave to find out more response details 1 180 parallel up wave to assess the magnitude of slowly drift force the percentage curve of low frequency drift force among total horizontal force is drawn in fig 24 mooring force in surge is chosen to represent total sea load on hull neglecting the unsteady phase at beginning total load value fluctuates around 3 5e 04 kn and drift force accounts for average 10 of it this percent fits roughly the given value in the reference faltinsen o m 1990 the max percentage is up to 40 and drift force is almost unidirectional rather than reciprocating so it is necessary to calculate the slowly drift effect of wave to predict in plane motion response after tendon is lost tendon and ttr tensions are shown in fig 25 and fig 26 2 0 parallel down wave note figs 24 26 belong to 1 from fig 27 and fig 28 failure happens in an extreme sea state but the displacement time response in x and z does not almost show apparent transient effect only y does 2 tendons under the same corner failure makes tlp form an incomplete structure which is same with the one in calm sea failure except of environment condition but there are transient responses in calm sea failure see figs 14 and 15 this means that transient response when tendons fail depends on the specific environment condition the closer to motion limitation the position of hull is when tendons are broken the less transient effect it has after the broken time the most representative curves are displacement in y because the direction of sea load in 0 the hull is still at equilibrium position in y when motion in x z is limited by tendons initial length and axial stiffness tendon tensions are shown in fig 29 3 225 up wave note fig 30 and fig 31 belong to 3 4 45 down wave in a 1000 yr sea state 2 tendon failure at the same corner is fatal to whole tlp hull tendon ttr system especially the corner is at up wave position from fig 30 in 225 t3 has a big risk to broken down subsequently comparatively such a risk in 45 can be much less than that the reason is that t3 tension in former has an average level higher than 7 0e 04 kn the one in latter only has a peak close to breakage tension its average is about 4 3e 04 kn being more safe shown in fig 32 once more than 2 tendons fail other tendons left will not be able to keep station for the platform under such an intensive sea load even more severe tendons left fail progressively moreover in 180 and 225 tendon buckling appears see figs 25 and 30 this can be another reason to tendon failure in other directions the downward compressive position on hull caused by tilt is at the up wave corner the up wave tendon on a healthy tlp usually bears the highest tension among others see unsteady phase before broken in figs 30 and 32 in riser aspect illustrated by figs 26 and 31 and fig 33 the max effective tension gets to 1 6e 03 kn about 1 6 times its initial pretension and the distance is prolonged from 470m to 471 8m to normal tensioner stroke and stiffness this length and tension leap is enough to make tensioners bottom out or damaged some research about tendon one time failure of tlp has been also done before chan k yang m h kim 2010 moo hyun kim zhi zhang 2009 by contrast the time history results with theirs there are very similar features in the motion and tendon response curves no matter both in transient the shape of peak impulse and steady stages the regular pattern of tension distribution in residual tendons in this manuscript more research on tendon progressive failure is done 6 7 tendon progressive failure single and double tendon failure above are both in one time they regard the residual mooring system after broken time as an unchangeable structure in fact it is impossible for any tendon to be avoided failing when it works around structural limit even though no induction factor appears e g its own reliability problem when all the tendons of tlp work well the structure is the most sturdy to withstand environment loads the more tendons tlp loses in an extreme sea state the more possible it is to experience subsequent destruction this is like a vicious circle and chain reactions are often motivated to a progressive failure process in terms of the cases analyzed above the most dangerous direction of 225 up wave is chosen to predict one disastrous whole process from entire tlp to nearly global failure of mooring system it is still for t1 to be induced to broken down at 250s it is a more complicated case following with the one in single tendon failure in 225 the whole process can be divided into 3 stages firstly t1 to t2 secondly t2 to t3 t8 and thirdly t3 t8 to more tendons broken down 1 tendon 1 to tendon 2 in 225 up wave for the entire tlp under the 1000 yr sea state the tension reverse of tendons is around 55 70 from fig 21 a very adequate reverse to break its design criterion an external incentive is needed in the case tlp loses t1 perhaps because of tendon part s insufficient strength instantaneous intensive impact fatigue problem under wave collision with ships or corrosion by seawater and this coincidently is at the up wave position the posture of platform in the first stage is shown from fig 34 to fig 36 arrows in the pictures represents wind wave and current respectively fig 34 is just before t1 s broken time fig 35 is right after t1 s broken time and fig 36 is just after t2 s broken time the broken time for t2 is determined by its effective tension time history in case above only t1 failure 225 shown in fig 37 its peak value at 251 5s is very close to the breakage tension so 251 5s is chosen for t2 4 legs it still has keep the platform level the comparison for tension curves of tendon between one time failure and progressively is illustrated in fig 38 similar comparison for displacement is in fig 39 the maximal difference is 0 77 in x y 15 39 in z and 46 53 in rx ry respectively owing to the only 1 5s time difference the structural time response is obviously different from the case t1 and t2 failure synchronously in the range from 250s to 300s out of the range before or after curves overlap with that case very well this reveals that if time difference between 2 tendons is short enough the structural response in progressive failure will be identical to that in synchronous failure except of a transient effect stage right after the earlier broken time curves overlap again because of the system s energy dissipation to transient difference the response difference is actually an impulse response in addition the more the time difference is the longer the time span should be waited for if the transient difference is unconcerned about a simplified failure case can be designed to analyze after t2 is lost by tlp t3 t8 s tension easily breaks through the limit so it enters the second stage t2 to t3 t8 2 tendon 2 to tendon 3 8 in 225 up wave note figs 34 39 belong to 1 in this stage t1 and t2 do not participate in mooring any more then t3 t8 is stretched into its limit state their tension curves in the first stage are zoomed in fig 42 from fig 38 their tensions fluctuate in an upward tendency and the highest peak time at 260 8s is looked upon as their most possible broken time note that all the broken times for tn refer to the last time tn still moors hull not the time tn is just disconnected with it the posture of platform in the second stage is shown in fig 40 and fig 41 fig 40 is right before t3 t8 broken time and fig 41 is the very next time step combined with the platform posture in the first stage after 9 3s interval the hull tilts a very large angle around diagonal one hand when 2 tendons under the same column is lost the hydrostatic position of hull is tilting caused by surplus buoyancy around corner on the other hand the tilted hull turns its bottom plane to the coming loads from wave and current so a component force upward tilts hull further the tension of tn displacement and tension of rn are monitored respectively in fig 43 fig 44 and fig 45 the motion in every dof has a great increment in the second stage than before riser s tension doubles for r1 so that it has a huge risk of being damaged in progressive failure process by observing the tension curves of t4 t7 they are surely undergoing a tensile failure right after 260 8s actually after t3 t8 broken down the residual mooring system gets into the third stage immediately global mooring failure 3 tendon 3 8 to more ones in 225 up wave note figs 40 45 belong to 2 global mooring failure begins from the time t3 t8 broken down with t4 t7 failing next 6 tendons of total 8 ones are lost in an extreme sea state the 2 ones left certainly cannot be strong enough to keep station for hull under such a violent environment even though they still keep working such few tendons cannot maintain tlp s stability ttrs also have a large possibility of being damaged after all they are not the primary members for mooring in design such 3 stages in a progressive failure exhibits a typical case that how a local mooring failure develops to a catastrophic global mooring failure of a tlp by the way if the first tendon failure occurs at the 45 down wave any other tendon does not have the danger of tension fracture see fig 23 6 8 tendon hanging as a supplement to failure from tendon s top end the bottom end breakdown is evaluated only one tendon failure at the up wave and down wave are performed in tendon hanging namely 225 and 45 the purpose of hanging case is to investigate how much influence on motion response of tlp the hanging tendon has than tendon s top failing a subroutine is programmed in fortran to characterize the hanging tendon in model space after its broken time same calculation parameters are used with other one time failures before in the paper suppose that the hanging tendon only has interaction with hull at connection position and it is so slender enough that its motion disturbance to fluid field is neglected the motion responses between no tendon hanging and hanging are shown from figs 46 52 because of the symmetry of model displacements in y and ry are omitted due to the horizontal force by current on the hanging tendon the offset in x of hull is greater than that with no hanging by about 0 8m 1 45 of total offset this is to say if steady horizontal loads exists e g current the platform s offset can be a little larger in vertical direction except of a short time of transient impact the hanging case has more set down than no hanging case about 0 2m lower 4 44 of total set down this is a combination effect of the hanging tendon s own buoyant weight and lateral loads in angular displacements it has almost no change in rx about mean value and amplitude from no hanging case but in a low parallelism with it compared to offset or set down curves moreover the hanging tendon changes hull s yaw direction into the opposite also with mean value and amplitude not changed even though the degree is too small to observe all in all when tlp is under an extreme environment the hanging tendon may magnify the motion response but the increment is still too small to run a specialized hanging case if unnecessary 7 summary and conclusion a series of tendon one time failure and progressive failure for a whole tlp with ttrs are analyzed under an extreme tropical cyclone on south china sea in article besides an assessment of influence of hanging tendon 3d potential flow theory and a hull tendon ttr coupling model are adopted to obtain its various failure consequences different disconnection positions of tendon up wave and down wave also top and bottom breakdown are all tested based on time domain results and discussions above some conclusions are drawn as follow not only does tensile strength failure for tendons happen in local mooring failure of tlp but also tendon s global buckling that its effective tension become negative according to criterion in code check it maybe leads to different response components in same one time history the component from ultimate strength and the component from buckling appear alternately around the critical point at zero effective tension transient effect of mooring structure after tendon failure under extreme sea load is more obvious than that of hull motion the further away from the equilibrium position the hull is the less transient effect in motion it has right after failure because tlp s motion reserve in plane gets down as it is pushed far away by sea load low frequency drift effect should be considered when tlp loses tendons the in plane drift load achieves average 10 maximal 40 of total horizontal loads this can magnify tlp s offset and set down even rotation with residual moorings and it is easy to understand the more tendons the platform loses the more apparent the magnification effect becomes although transient effect of motion is relatively slight by range limit drift load increases mooring response of tendon as a result reducing their tension reserve by comparison between responses in failure progressively and failure synchronously a rule is acquired as below to analyze a progressive failure if time difference between 2 tendons broken is short enough to neglect the exact transient process a 2 tendon one time failure can be substituted for its time response this is an excellent simplified method to cope with those situations that there are several tendons waiting to fail but some of their broken times are very close to each other e g theirs are within same a second a global mooring failure maybe follows with an initial local mooring failure obtaining from the progressive failure case in an extreme sea state a tlp has no enough bearing capacity of any tendon failure at key position it can eventually develop to a global mooring failure even the platform s absolutely overturning as long as only one up wave tendon fails initially if a definition of structural robustness is that one important attribution of engineering structure to keep its global stability when and after an accident occurs and not to undergo collapse or progressive damage which is not unbecoming to the accident on severity so a lack of robustness of the tlp under extreme environment leads to its global mooring failure tendon hanging influence on platform s motion is too small to establish a case alone specialized in it even though the hanging case is on a dangerous side sometimes and the hanging tendon will almost not change the motion response feature of platform acknowledgements the author would like to appreciate the financially support from national natural science foundation of china for youth grant no 51609169 national key r d program of china grant no 2018yfc0310500 guangxi science and technology major project grant no guike aa17292007 and national natural science foundation of china grant no 51779173 in the research appendix a supplementary data the following is the supplementary data to this article multimedia component 1 multimedia component 1 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j oceaneng 2019 04 049 
22807,in this paper a robust procedure for estimating of nominal hydrodynamic coefficients of an autonomous underwater vehicle auv in presence of parameter uncertainties is proposed some parameters of the model of an auv such as its hydrodynamic coefficients may perturb from their nominal values because of changes in its operating conditions and the surrounding environment this paper presents two different filters for robust identification of the auv parameters the robust extended kalman filter rekf and the extended h infinity eh filter are implemented to estimate the nominal hydrodynamic coefficients of the auv by using a model of a sample auv and simulating the motion of the vehicle in the diving mode involving parameter perturbations the performance of the filters is compared the results show that the rekf outperforms the eh filter in this application also the performance of these estimation algorithms is compared with the standard extended kalman filter ekf using the data obtained from experimental test of a real auv it is observed that the model using the identified values of hydrodynamic coefficients of both filters can predict the actual trajectory of the vehicle and the robust filters are more accurate as compared to the standard ekf keywords robust identification autonomous underwater vehicle robust extended kalman filter h filter hydrodynamic coefficients 1 introduction one of the important issues in the design control navigation and guidance of underwater vehicles is system identification where the parameters of vehicle model are estimated the identification of the parameters of a remotely operated vehicle rov can be performed at a lower cost by implementing least squares ls and the ekf techniques using standard on board devices alessandri et al 1998a b in alessandri et al 1998a b a simplified dynamic model of an unmanned underwater vehicle uuv has been identified using standard identification techniques and experimental data acquired by inboard navigation sensors in heave direction various methods have been applied for model identification and parameter estimation of auvs using an offline estimation technique based on least squares method two methods for estimation of nonlinear model of an auv were presented and compared in ridao et al 2004 base on minimization of the acceleration prediction error direct method minimization of the velocity one step prediction error integral method observer kalman filter identification was implemented for identification of the yaw dynamics of an auv in tiano et al 2007 by implementing kalman filter with fading memory and maximum likelihood algorithm the state variables of an auv and its parameters were estimated and the cost function was optimized using a damped newton method shahinfar et al 2010 in identifying the coefficients of an auv it is important to have an identification process that is easily implementable and time efficient an efficient method was introduced in mišković et al 2011 which is based on self oscillations of auv the concept is to use harmonic linearization to obtain an approximation of the parameters of a nonlinear element in the presence of oscillations the performance of ekf for estimating of linear damping coefficients of an auv was compared with the experimental data obtained from the planar motion mechanism pmm test kim et al 2002 in ernani et al 2015 hydrodynamic coefficients of two different sample auvs were identified by implementing ekfs using the arma process model a proper covariance matrix was selected for increasing the accuracy and the speed of the convergence of the algorithm using unscented kalman filter ukf and ekf hydrodynamic coefficients of an auv are estimated and the results are compared in sabet et al 2014 the results of this research show that ukf method is faster and its estimation is more accurate than ekf in another related research the performance of three filters the ekf cubature kalman filter ckf and transformed unscented kalman filter tukf are compared in identification of 22 parameters of an auv sabet et al 2017 it was indicated that in comparison with the ekf tukf and ckf present more accurate estimates also the tukf is more accurate than ckf at the same cpu time in xu et al 2012 the hydrodynamic derivates of an auv are identified by analyzing the motion simulation in diving mode and the results is compared with the standard coefficients shariati et al 2019 combined the particle filter pf with ekf and formed the extended kalman particle filter ekpf for model identification of an auv while some states are unmeasured the simulation results of the ekpf estimated model were validated and compared with the experimental data it was shown that the ekpf is more accurate than ekf implementing a standard least squares estimation method the main hydrodynamic parameters of a special auv are identified from reduced experimental dataset allotta et al 2018 the vehicle is typhoon auv that is controlled with two rear propellers and four tunnel thrusters for adopting a simplified model only the forces that are due to the propellers and quadratic drag terms are considered and the forces due to added mass and other hydrodynamic characteristics are not considered the parameters of the model are assumed to be fixed without any perturbations in some filters such as kalman filter and its nonlinear extensions it is assumed that system model and noise statistics are known also the process and measurement noises are assumed to be white zero mean and uncorrelated if any of these assumption are lost the filter estimates can degrade simon 2006 so the problem of kalman filtering with uncertainties in the system model and noise covariance has been investigated by several researcher see e g zhu et al 2002 and the references therein in feng et al 2013 a distributed weighted robust kalman filter was presented for uncertain systems with autocorrelated and cross correlated noises based on a new optimal robust kalman type recursive filter one of the common filtering was specifically designed for robustness is h filter grimble and el sayed 1990 by minimizing the worst case estimation error the h filter is more robust than kalman filter which minimizes the root mean square rms of estimation error simon 2006 the performances of different sensor fusion algorithms in a robot with uncertainties in both the system and measurement matrices were compared using a kalman filter and an h filter and a robust mixed kalman h filter in liu et al 2010 the differences between the actual and the nominal values of parameters of a auv model come from unmodeled dynamic different operation conditions and environmental conditions these variations have been considered as model uncertainty in several research works on the robust control system design for underwater vehicles e g bozorg et al 2004 gayvoronskiy et al 2018 rezazadegan et al 2015 yang et al 2015 and monnet et al 2017 in most of the previous works on identification of auv parameters linear and nonlinear filters are implemented to identify these parameters without taking into account the effects of parameter uncertainties in this paper an underwater vehicle is considered as a plant with uncertain parameters then two robust nonlinear filters namely rekf and eh are used for the estimation of hydrodynamic coefficients of the auv in the diving mode the performance of these estimators is compared through various simulations also the model of a real auv in diving mode is identified using the experimental data obtained from test runs using these filters and results are compared with the outcomes of a standard ekf in section 2 the equations of motion of an auv in the diving mode are presented in section 3 the identification method proposed in this paper is presented and the rekf and eh filter are explained section 4 presents simulation results of implementing of these filters for a sample auv snuuv i and the estimated hydrodynamic coefficients are compared with their nominal values in section 5 the hydrodynamic coefficients of an auv are identified from experimental data finally the paper is summarized in section 6 2 auv s mathematical model in fig 1 auv body fixed and earth fixed coordinate systems and the forces and the moments applied to it are shown the six degrees of freedom equations of motion can be divided into three subsystems healey and marco 1992 1 speed subsystem where state variable is u t 2 steering subsystem states where state variables are v t r t and ψ t 3 diving subsystem states where state variables are w t q t θ t and z t 2 1 state space model in diving mode in this subsection the model of an auv in diving mode is presented fossen 1994 in this mode state variables are heave velocity w angular velocity q pitch angle θ and position in heave direction z and input is the stern plane angle δ s if the underwater vehicle moves slowly in vertical plane the variation of heave velocity should be small if the origin of body fixed frame is put on the centre of gravity the model can be presented as 1 q θ z m q i y y m q z g z b i y y m q 0 1 0 0 0 u 0 0 q θ z m δ i y y m q 0 0 δ s for this mode the hydrodynamic coefficients m q m q m δ s are assumed to be uncertain 3 system identification algorithms in this section two identification algorithms that are used in this paper for robust estimation of hydrodynamic coefficients of an auv are introduced consider the following uncertain nonlinear system 2 x k f x k 1 u k 1 a k δ ak x k 1 w k y k h x k v k where x k r l is the state variables of the system y k r m is the measured values u k 1 is system input and f x k 1 and h x k represent the nonlinear models of the process and measurement of system respectively also w k r l and v k r m are uncorrelated white noises with zero means and known covariance matrices 3 e w k v k w j t v j t q k δ k j 0 0 r k δ k j a k δ ak represents the parametric uncertainty of system where a k is the scaling matrix and δ ak is the perturbation matrix which satisfies the following condition 4 δ ak δ ak t i 3 1 robust extended kalman filter rekf the discrete robust extended kalman filter rekf for the above system where the time step t t k t k 1 is constant can be represented as xiong et al 2012 5 prediction stage x ˆ k k 1 f x ˆ k 1 σ k k 1 1 γ 2 1 γ 1 γ 2 1 1 f k σ k 1 f k t q ˆ k measurement update x ˆ k x ˆ k k 1 k k y k h x ˆ k k 1 σ k 1 γ 2 1 γ 1 γ 2 1 1 i k k h k σ k k 1 i k k h k t k k r ˆ k k k t k k 1 γ 2 1 γ 1 γ 2 1 1 σ k k 1 h k t 1 γ 2 1 γ 1 γ 2 1 1 h σ k k 1 h k t r ˆ k 1 where 6 f k f x x x ˆ k 1 h k h x x x ˆ k k 1 q ˆ k γ 2 a k a k t q k r ˆ k γ 2 c k c k t r k and γ 1 and γ 2 where γ 2 γ 1 1 are chosen by the user based on the problem circumstances remark 1 in comparison with the standard ekf the robust ekf has two additional parameters γ 1 γ 2 these parameters are defined to impose an upper bound on error covariance xiong et al 2012 remark 2 if the parameter uncertainties are negligible the matrices a k and c k can be set to zero then as γ 2 the rekf reverts to the ekf xiong et al 2012 3 2 extended h infinity eh for introduction of the discrete extended h infinity eh filter with constant time step t system 2 is rewritten as 7 x k 1 f k x k g k u k w k y k h k x k v k where 8 f k f x x x ˆ k 1 h k h x x x ˆ k k 1 u k model input then the algorithm of eh can be represented as simon 2006 9 x ˆ k f k 1 x ˆ k 1 g k 1 u k 1 f k 1 k k 1 y k 1 h k 1 x ˆ k 1 σ k f k 1 σ k 1 i θ s k 1 σ k 1 h k 1 t r k 1 1 h k 1 σ k 1 1 f k 1 t q k 1 k k σ k 1 i θ s k 1 σ k 1 h k 1 t r k 1 1 h k 1 σ k 1 1 h k 1 t r k 1 1 where θ and s are chosen by the user based on the problem circumstances 3 3 augmented state variables for estimation of the unknown parameters hydrodynamic coefficients they can be added to the state variables to be estimated to form the augmented state vector 10 x k x k β k where β k r p is the unknown parameter vector to be estimated also small artificial noises should be added to the state equations to define random dynamic for these parameters simon 2006 the augmented state space model in coherence with aim of the work is categorized to three state variables of the auv dynamic in diving mode x k q k θ k z k and three hydrodynamic coefficients β k m q m q m s for estimation so system 1 is rewritten as 11 x k f x k s k w k t 4 simulation results 4 1 robust identification of a sample auv in diving mode in this subsection a nonlinear sample auv model is used to verify the performance of the two algorithms introduced in section 3 the nonlinear 6 dof dynamic model of snuuv i shahinfar et al 2010 is used for simulation purposes and uncertainties are added to the model parameters to examine the performance of the robust filters the specifications of snuuv i and its hydrodynamic coefficients are listed in tables 1 and 2 respectively according to equation 1 the model input is stern plan angle δ s and the model output of this simulation is pitch angle θ furthermore measurement and process noises are added to the model the noises are considered to be white noise with zero mean with the following covariances 12 process noise covariance 10 6 0 0 0 2 10 6 0 0 0 10 4 measurement noise covariance 10 2 the step inputs given to the model is shown in fig 2 algorithm 1 is devised to simulate the model output and implement the rekf and eh filter for robust estimation of auv parameters algorithm 1 robust estimation of auv parameters 1 select a set of hydrodynamic coefficients m q m q and m δ s the hydrodynamic coefficients are assumed to be uncertain with random perturbation around theirs nominal values the nominal values for the simulated system are listed in table 2 2 by using equation 1 the pitch angle θ is measured as the output by changing the stern plane angle δ s as the input of model according to fig 2 3 use the rekf and eh filters for robust identification of nominal values of the hydrodynamic coefficients implementation of pseudo codes of the filters has been explained in appendix a by assuming 10 perturbation around the nominal values and selecting the hydrodynamic coefficients m q 0 05949 m q 17 1217 and m δ s 0 0345 in step 1 of algorithm 1 and implementing step 2 a simulated output is shown in fig 3 in this simulation both the process and the measurement noises are added figs 4 and 5 show the estimation results of the rekf and eh filter for three hydrodynamic coefficients by implementing step 3 of algorithm 1 the tuning parameters of rekf γ 1 and γ 2 should be properly chosen to ensure the filter convergence for this simulation assumes γ 1 40 and γ 2 200 initial values for coefficients in two filters are assumed to be same the time step is chosen as t 0 1 s the values of the estimated parameters their nominal values are compared in tables 3 and 4 it can be seen that by using the rekf and the eh filter the nominal values of parameters can be estimated from uncertain model with proper precision also the rekf provides more accurate results in the estimation of parameters 4 2 monte carlo simulation in this subsection a monte carlo simulation is implemented for this implementation algorithm 1 is run 100 times in each run a set of hydrodynamic coefficients m q m q and m δ s are selected randomly within the 10 interval around the nominal values according to step 1 of algorithm 1 then step 2 of the algorithm is implemented 10 000 times with different random values for the process and measurement noises and rekf and eh filter are implemented for estimation of nominal values of parameters the covariances of these noises are chosen as in 11 then the nominal values of the parameters and the mean and the standard deviation of estimation errors of the two filters are shown in table 5 the results show that the estimates of rekf are more accurate than estimates of eh filter also it shows that the estimation of m δ s is performed more accurately as compared to the other parameters but the estimation of m q is less accurate 5 application of filters using experimental data in this section an experimental test run of a slender body autonomous underwater vehicle is investigated the recorded input and outputs of the identification maneuver in depth mode are shown in fig 6 the input is the stern plane angle δ s and the outputs are pitch angle θ and depth z applying the two parameter estimation methods eh and rekf presented in section 3 and the standard ekf for the auv under study to estimate the hydrodynamic coefficients appearing in equation 1 is examined here the covariances of process and measurement noises q k r k are assumed to be same for the three filters the simulation of the auv motion with the hydrodynamic coefficients identified by ekf is shown in fig 7 it can be seen that the model outputs are not close enough to the measured outputs the reason is that there exist some uncertainties due to working conditions that are not taken into account by ekf the output of the models using the coefficients identified by eh filter and rekf are shown in figs 8 and 9 it can be seen that the model outputs match the measured outputs adequately the outputs of the identified models are similar but the results of rekf are more accurate the outputs of both filters are closer to the real recorded path of the vehicle as compared to the outputs of the model identified by ekf this emphasizes the importance of taking into account the uncertainty of the hydrodynamic coefficients 6 conclusion in this paper the robust estimation of uncertain hydrodynamic coefficients of an auv using robust extended kalman filter rekf and extended h infinity eh filter are carried out the results demonstrate the appropriate performance of the algorithms in estimation of hydrodynamic coefficients and their accuracy in the presence of uncertainties in these coefficients the methods are verified by both simulated and experimental data the method is applied to estimate the hydrodynamic coefficient of a real auv the results indicate that the rekf parameter identification method is the more accurate however eh filter was also able to identify the hydrodynamic coefficients with a proper accuracy the estimation of both filters outperformed the estimation of standard ekf therefore using these robust filters in situations where there exist some uncertainties in the identified parameters are suggested to improve the accuracy of estimation the computational requirements of the methods are contained and thence they are viable for practical implementations the rekf algorithm requires initial definition of the tuning parameters γ 1 and γ 2 and eh requires the definition of the parameters θ and s to formulate the uncertainty of the identified parameters this requires some trial and error to tune these parameters for the auv under study however this is affordable as the outcomes of the identified models can easily be compared with the recorded experimental data acknowledgments the authors wish to thank dr ali akbar tadaion from department of electrical engineering yazd university yazd iran for his collaboration in the research appendix pseudo codes for robust extended kalman and extended h filters table 1 pseudo codes of the robust extended kalman filter rekf for auv parameter estimation table 1 the rekf is initialized as x ˆ 0 e x 0 σ 0 e x 0 x ˆ 0 x 0 x ˆ 0 t choose tuning parameters γ 1 and γ 2 choose process and measurement covariance q ˆ and r ˆ for each time step k 1 e n d compute the following matrices f k f x x x ˆ k k 1 h k h x x x ˆ k k 1 perform the prediction stage of the augment state and error covariance estimates as x ˆ k k 1 f x ˆ k 1 s k 1 0 σ k k 1 1 γ 2 1 γ 1 γ 2 1 1 f k σ k 1 f k t q ˆ k calculate rekf gain k k 1 γ 2 1 γ 1 γ 2 1 1 σ k k 1 h k t 1 γ 2 1 γ 1 γ 2 1 1 h k σ k k 1 h k t r ˆ k 1 perform the measurement update of the augment state and error covariance estimates as x ˆ k x ˆ k k 1 k k y k h x ˆ k k 1 σ k 1 γ 2 1 γ 1 γ 2 1 1 i k k h k σ k k 1 i k k h k t k k r ˆ k k k t table 2 pseudo codes of the extended h filter eh for auv parameter estimation table 2 the eh is initialized as x ˆ 0 e x 0 σ 0 e x 0 x ˆ 0 x 0 x ˆ 0 t choose tuning parameters s and θ choose process and measurement covariance q and r for each time step k 1 e n d compute the following matrices f k f x x x ˆ k k 1 h k h x x x ˆ k k 1 perform the augment state and error covariance estimates as x ˆ k f k 1 x ˆ k 1 g k 1 u k 1 f k 1 k k 1 y k 1 h k 1 x ˆ k 1 σ k f k 1 σ k 1 i θ s k 1 σ k 1 h k 1 t r k 1 1 h k 1 σ k 1 1 f k 1 t q k 1 calculate rekf gain k k σ k 1 i θ s k 1 σ k 1 h k 1 t r k 1 1 h k 1 σ k 1 1 h k 1 t r k 1 1 
22807,in this paper a robust procedure for estimating of nominal hydrodynamic coefficients of an autonomous underwater vehicle auv in presence of parameter uncertainties is proposed some parameters of the model of an auv such as its hydrodynamic coefficients may perturb from their nominal values because of changes in its operating conditions and the surrounding environment this paper presents two different filters for robust identification of the auv parameters the robust extended kalman filter rekf and the extended h infinity eh filter are implemented to estimate the nominal hydrodynamic coefficients of the auv by using a model of a sample auv and simulating the motion of the vehicle in the diving mode involving parameter perturbations the performance of the filters is compared the results show that the rekf outperforms the eh filter in this application also the performance of these estimation algorithms is compared with the standard extended kalman filter ekf using the data obtained from experimental test of a real auv it is observed that the model using the identified values of hydrodynamic coefficients of both filters can predict the actual trajectory of the vehicle and the robust filters are more accurate as compared to the standard ekf keywords robust identification autonomous underwater vehicle robust extended kalman filter h filter hydrodynamic coefficients 1 introduction one of the important issues in the design control navigation and guidance of underwater vehicles is system identification where the parameters of vehicle model are estimated the identification of the parameters of a remotely operated vehicle rov can be performed at a lower cost by implementing least squares ls and the ekf techniques using standard on board devices alessandri et al 1998a b in alessandri et al 1998a b a simplified dynamic model of an unmanned underwater vehicle uuv has been identified using standard identification techniques and experimental data acquired by inboard navigation sensors in heave direction various methods have been applied for model identification and parameter estimation of auvs using an offline estimation technique based on least squares method two methods for estimation of nonlinear model of an auv were presented and compared in ridao et al 2004 base on minimization of the acceleration prediction error direct method minimization of the velocity one step prediction error integral method observer kalman filter identification was implemented for identification of the yaw dynamics of an auv in tiano et al 2007 by implementing kalman filter with fading memory and maximum likelihood algorithm the state variables of an auv and its parameters were estimated and the cost function was optimized using a damped newton method shahinfar et al 2010 in identifying the coefficients of an auv it is important to have an identification process that is easily implementable and time efficient an efficient method was introduced in mišković et al 2011 which is based on self oscillations of auv the concept is to use harmonic linearization to obtain an approximation of the parameters of a nonlinear element in the presence of oscillations the performance of ekf for estimating of linear damping coefficients of an auv was compared with the experimental data obtained from the planar motion mechanism pmm test kim et al 2002 in ernani et al 2015 hydrodynamic coefficients of two different sample auvs were identified by implementing ekfs using the arma process model a proper covariance matrix was selected for increasing the accuracy and the speed of the convergence of the algorithm using unscented kalman filter ukf and ekf hydrodynamic coefficients of an auv are estimated and the results are compared in sabet et al 2014 the results of this research show that ukf method is faster and its estimation is more accurate than ekf in another related research the performance of three filters the ekf cubature kalman filter ckf and transformed unscented kalman filter tukf are compared in identification of 22 parameters of an auv sabet et al 2017 it was indicated that in comparison with the ekf tukf and ckf present more accurate estimates also the tukf is more accurate than ckf at the same cpu time in xu et al 2012 the hydrodynamic derivates of an auv are identified by analyzing the motion simulation in diving mode and the results is compared with the standard coefficients shariati et al 2019 combined the particle filter pf with ekf and formed the extended kalman particle filter ekpf for model identification of an auv while some states are unmeasured the simulation results of the ekpf estimated model were validated and compared with the experimental data it was shown that the ekpf is more accurate than ekf implementing a standard least squares estimation method the main hydrodynamic parameters of a special auv are identified from reduced experimental dataset allotta et al 2018 the vehicle is typhoon auv that is controlled with two rear propellers and four tunnel thrusters for adopting a simplified model only the forces that are due to the propellers and quadratic drag terms are considered and the forces due to added mass and other hydrodynamic characteristics are not considered the parameters of the model are assumed to be fixed without any perturbations in some filters such as kalman filter and its nonlinear extensions it is assumed that system model and noise statistics are known also the process and measurement noises are assumed to be white zero mean and uncorrelated if any of these assumption are lost the filter estimates can degrade simon 2006 so the problem of kalman filtering with uncertainties in the system model and noise covariance has been investigated by several researcher see e g zhu et al 2002 and the references therein in feng et al 2013 a distributed weighted robust kalman filter was presented for uncertain systems with autocorrelated and cross correlated noises based on a new optimal robust kalman type recursive filter one of the common filtering was specifically designed for robustness is h filter grimble and el sayed 1990 by minimizing the worst case estimation error the h filter is more robust than kalman filter which minimizes the root mean square rms of estimation error simon 2006 the performances of different sensor fusion algorithms in a robot with uncertainties in both the system and measurement matrices were compared using a kalman filter and an h filter and a robust mixed kalman h filter in liu et al 2010 the differences between the actual and the nominal values of parameters of a auv model come from unmodeled dynamic different operation conditions and environmental conditions these variations have been considered as model uncertainty in several research works on the robust control system design for underwater vehicles e g bozorg et al 2004 gayvoronskiy et al 2018 rezazadegan et al 2015 yang et al 2015 and monnet et al 2017 in most of the previous works on identification of auv parameters linear and nonlinear filters are implemented to identify these parameters without taking into account the effects of parameter uncertainties in this paper an underwater vehicle is considered as a plant with uncertain parameters then two robust nonlinear filters namely rekf and eh are used for the estimation of hydrodynamic coefficients of the auv in the diving mode the performance of these estimators is compared through various simulations also the model of a real auv in diving mode is identified using the experimental data obtained from test runs using these filters and results are compared with the outcomes of a standard ekf in section 2 the equations of motion of an auv in the diving mode are presented in section 3 the identification method proposed in this paper is presented and the rekf and eh filter are explained section 4 presents simulation results of implementing of these filters for a sample auv snuuv i and the estimated hydrodynamic coefficients are compared with their nominal values in section 5 the hydrodynamic coefficients of an auv are identified from experimental data finally the paper is summarized in section 6 2 auv s mathematical model in fig 1 auv body fixed and earth fixed coordinate systems and the forces and the moments applied to it are shown the six degrees of freedom equations of motion can be divided into three subsystems healey and marco 1992 1 speed subsystem where state variable is u t 2 steering subsystem states where state variables are v t r t and ψ t 3 diving subsystem states where state variables are w t q t θ t and z t 2 1 state space model in diving mode in this subsection the model of an auv in diving mode is presented fossen 1994 in this mode state variables are heave velocity w angular velocity q pitch angle θ and position in heave direction z and input is the stern plane angle δ s if the underwater vehicle moves slowly in vertical plane the variation of heave velocity should be small if the origin of body fixed frame is put on the centre of gravity the model can be presented as 1 q θ z m q i y y m q z g z b i y y m q 0 1 0 0 0 u 0 0 q θ z m δ i y y m q 0 0 δ s for this mode the hydrodynamic coefficients m q m q m δ s are assumed to be uncertain 3 system identification algorithms in this section two identification algorithms that are used in this paper for robust estimation of hydrodynamic coefficients of an auv are introduced consider the following uncertain nonlinear system 2 x k f x k 1 u k 1 a k δ ak x k 1 w k y k h x k v k where x k r l is the state variables of the system y k r m is the measured values u k 1 is system input and f x k 1 and h x k represent the nonlinear models of the process and measurement of system respectively also w k r l and v k r m are uncorrelated white noises with zero means and known covariance matrices 3 e w k v k w j t v j t q k δ k j 0 0 r k δ k j a k δ ak represents the parametric uncertainty of system where a k is the scaling matrix and δ ak is the perturbation matrix which satisfies the following condition 4 δ ak δ ak t i 3 1 robust extended kalman filter rekf the discrete robust extended kalman filter rekf for the above system where the time step t t k t k 1 is constant can be represented as xiong et al 2012 5 prediction stage x ˆ k k 1 f x ˆ k 1 σ k k 1 1 γ 2 1 γ 1 γ 2 1 1 f k σ k 1 f k t q ˆ k measurement update x ˆ k x ˆ k k 1 k k y k h x ˆ k k 1 σ k 1 γ 2 1 γ 1 γ 2 1 1 i k k h k σ k k 1 i k k h k t k k r ˆ k k k t k k 1 γ 2 1 γ 1 γ 2 1 1 σ k k 1 h k t 1 γ 2 1 γ 1 γ 2 1 1 h σ k k 1 h k t r ˆ k 1 where 6 f k f x x x ˆ k 1 h k h x x x ˆ k k 1 q ˆ k γ 2 a k a k t q k r ˆ k γ 2 c k c k t r k and γ 1 and γ 2 where γ 2 γ 1 1 are chosen by the user based on the problem circumstances remark 1 in comparison with the standard ekf the robust ekf has two additional parameters γ 1 γ 2 these parameters are defined to impose an upper bound on error covariance xiong et al 2012 remark 2 if the parameter uncertainties are negligible the matrices a k and c k can be set to zero then as γ 2 the rekf reverts to the ekf xiong et al 2012 3 2 extended h infinity eh for introduction of the discrete extended h infinity eh filter with constant time step t system 2 is rewritten as 7 x k 1 f k x k g k u k w k y k h k x k v k where 8 f k f x x x ˆ k 1 h k h x x x ˆ k k 1 u k model input then the algorithm of eh can be represented as simon 2006 9 x ˆ k f k 1 x ˆ k 1 g k 1 u k 1 f k 1 k k 1 y k 1 h k 1 x ˆ k 1 σ k f k 1 σ k 1 i θ s k 1 σ k 1 h k 1 t r k 1 1 h k 1 σ k 1 1 f k 1 t q k 1 k k σ k 1 i θ s k 1 σ k 1 h k 1 t r k 1 1 h k 1 σ k 1 1 h k 1 t r k 1 1 where θ and s are chosen by the user based on the problem circumstances 3 3 augmented state variables for estimation of the unknown parameters hydrodynamic coefficients they can be added to the state variables to be estimated to form the augmented state vector 10 x k x k β k where β k r p is the unknown parameter vector to be estimated also small artificial noises should be added to the state equations to define random dynamic for these parameters simon 2006 the augmented state space model in coherence with aim of the work is categorized to three state variables of the auv dynamic in diving mode x k q k θ k z k and three hydrodynamic coefficients β k m q m q m s for estimation so system 1 is rewritten as 11 x k f x k s k w k t 4 simulation results 4 1 robust identification of a sample auv in diving mode in this subsection a nonlinear sample auv model is used to verify the performance of the two algorithms introduced in section 3 the nonlinear 6 dof dynamic model of snuuv i shahinfar et al 2010 is used for simulation purposes and uncertainties are added to the model parameters to examine the performance of the robust filters the specifications of snuuv i and its hydrodynamic coefficients are listed in tables 1 and 2 respectively according to equation 1 the model input is stern plan angle δ s and the model output of this simulation is pitch angle θ furthermore measurement and process noises are added to the model the noises are considered to be white noise with zero mean with the following covariances 12 process noise covariance 10 6 0 0 0 2 10 6 0 0 0 10 4 measurement noise covariance 10 2 the step inputs given to the model is shown in fig 2 algorithm 1 is devised to simulate the model output and implement the rekf and eh filter for robust estimation of auv parameters algorithm 1 robust estimation of auv parameters 1 select a set of hydrodynamic coefficients m q m q and m δ s the hydrodynamic coefficients are assumed to be uncertain with random perturbation around theirs nominal values the nominal values for the simulated system are listed in table 2 2 by using equation 1 the pitch angle θ is measured as the output by changing the stern plane angle δ s as the input of model according to fig 2 3 use the rekf and eh filters for robust identification of nominal values of the hydrodynamic coefficients implementation of pseudo codes of the filters has been explained in appendix a by assuming 10 perturbation around the nominal values and selecting the hydrodynamic coefficients m q 0 05949 m q 17 1217 and m δ s 0 0345 in step 1 of algorithm 1 and implementing step 2 a simulated output is shown in fig 3 in this simulation both the process and the measurement noises are added figs 4 and 5 show the estimation results of the rekf and eh filter for three hydrodynamic coefficients by implementing step 3 of algorithm 1 the tuning parameters of rekf γ 1 and γ 2 should be properly chosen to ensure the filter convergence for this simulation assumes γ 1 40 and γ 2 200 initial values for coefficients in two filters are assumed to be same the time step is chosen as t 0 1 s the values of the estimated parameters their nominal values are compared in tables 3 and 4 it can be seen that by using the rekf and the eh filter the nominal values of parameters can be estimated from uncertain model with proper precision also the rekf provides more accurate results in the estimation of parameters 4 2 monte carlo simulation in this subsection a monte carlo simulation is implemented for this implementation algorithm 1 is run 100 times in each run a set of hydrodynamic coefficients m q m q and m δ s are selected randomly within the 10 interval around the nominal values according to step 1 of algorithm 1 then step 2 of the algorithm is implemented 10 000 times with different random values for the process and measurement noises and rekf and eh filter are implemented for estimation of nominal values of parameters the covariances of these noises are chosen as in 11 then the nominal values of the parameters and the mean and the standard deviation of estimation errors of the two filters are shown in table 5 the results show that the estimates of rekf are more accurate than estimates of eh filter also it shows that the estimation of m δ s is performed more accurately as compared to the other parameters but the estimation of m q is less accurate 5 application of filters using experimental data in this section an experimental test run of a slender body autonomous underwater vehicle is investigated the recorded input and outputs of the identification maneuver in depth mode are shown in fig 6 the input is the stern plane angle δ s and the outputs are pitch angle θ and depth z applying the two parameter estimation methods eh and rekf presented in section 3 and the standard ekf for the auv under study to estimate the hydrodynamic coefficients appearing in equation 1 is examined here the covariances of process and measurement noises q k r k are assumed to be same for the three filters the simulation of the auv motion with the hydrodynamic coefficients identified by ekf is shown in fig 7 it can be seen that the model outputs are not close enough to the measured outputs the reason is that there exist some uncertainties due to working conditions that are not taken into account by ekf the output of the models using the coefficients identified by eh filter and rekf are shown in figs 8 and 9 it can be seen that the model outputs match the measured outputs adequately the outputs of the identified models are similar but the results of rekf are more accurate the outputs of both filters are closer to the real recorded path of the vehicle as compared to the outputs of the model identified by ekf this emphasizes the importance of taking into account the uncertainty of the hydrodynamic coefficients 6 conclusion in this paper the robust estimation of uncertain hydrodynamic coefficients of an auv using robust extended kalman filter rekf and extended h infinity eh filter are carried out the results demonstrate the appropriate performance of the algorithms in estimation of hydrodynamic coefficients and their accuracy in the presence of uncertainties in these coefficients the methods are verified by both simulated and experimental data the method is applied to estimate the hydrodynamic coefficient of a real auv the results indicate that the rekf parameter identification method is the more accurate however eh filter was also able to identify the hydrodynamic coefficients with a proper accuracy the estimation of both filters outperformed the estimation of standard ekf therefore using these robust filters in situations where there exist some uncertainties in the identified parameters are suggested to improve the accuracy of estimation the computational requirements of the methods are contained and thence they are viable for practical implementations the rekf algorithm requires initial definition of the tuning parameters γ 1 and γ 2 and eh requires the definition of the parameters θ and s to formulate the uncertainty of the identified parameters this requires some trial and error to tune these parameters for the auv under study however this is affordable as the outcomes of the identified models can easily be compared with the recorded experimental data acknowledgments the authors wish to thank dr ali akbar tadaion from department of electrical engineering yazd university yazd iran for his collaboration in the research appendix pseudo codes for robust extended kalman and extended h filters table 1 pseudo codes of the robust extended kalman filter rekf for auv parameter estimation table 1 the rekf is initialized as x ˆ 0 e x 0 σ 0 e x 0 x ˆ 0 x 0 x ˆ 0 t choose tuning parameters γ 1 and γ 2 choose process and measurement covariance q ˆ and r ˆ for each time step k 1 e n d compute the following matrices f k f x x x ˆ k k 1 h k h x x x ˆ k k 1 perform the prediction stage of the augment state and error covariance estimates as x ˆ k k 1 f x ˆ k 1 s k 1 0 σ k k 1 1 γ 2 1 γ 1 γ 2 1 1 f k σ k 1 f k t q ˆ k calculate rekf gain k k 1 γ 2 1 γ 1 γ 2 1 1 σ k k 1 h k t 1 γ 2 1 γ 1 γ 2 1 1 h k σ k k 1 h k t r ˆ k 1 perform the measurement update of the augment state and error covariance estimates as x ˆ k x ˆ k k 1 k k y k h x ˆ k k 1 σ k 1 γ 2 1 γ 1 γ 2 1 1 i k k h k σ k k 1 i k k h k t k k r ˆ k k k t table 2 pseudo codes of the extended h filter eh for auv parameter estimation table 2 the eh is initialized as x ˆ 0 e x 0 σ 0 e x 0 x ˆ 0 x 0 x ˆ 0 t choose tuning parameters s and θ choose process and measurement covariance q and r for each time step k 1 e n d compute the following matrices f k f x x x ˆ k k 1 h k h x x x ˆ k k 1 perform the augment state and error covariance estimates as x ˆ k f k 1 x ˆ k 1 g k 1 u k 1 f k 1 k k 1 y k 1 h k 1 x ˆ k 1 σ k f k 1 σ k 1 i θ s k 1 σ k 1 h k 1 t r k 1 1 h k 1 σ k 1 1 f k 1 t q k 1 calculate rekf gain k k σ k 1 i θ s k 1 σ k 1 h k 1 t r k 1 1 h k 1 σ k 1 1 h k 1 t r k 1 1 
22808,the present paper reports an experimental numerical study about the aerodynamics of sails in upwind conditions this work is part of a wider research frame carried out in the recent years at politecnico di milano involving numerical wind tunnel and full scale studies on the aero hydrodynamics of sailing yachts the experimental apparatus adopted in this work is the scaled version of the full scale setup adopted in the sailing yacht laboratory syl at the same institutions more specifically soft sails were tested in wind tunnel in close hauled conditions properly equipped with thin and soft pressure strips at different sections of head and main sail therefore simultaneous data about distributed pressure aerodynamic forces and 3d flying shapes were gathered fine trimming were investigated during the tests to study the different effect on pressure distribution performance and sail shapes the measured sails geometry about the same conditions fed the steady numerical simulations based both on vortex lattice method and reynolds averaged navier stokes equations for comparison and validation with regard to the latter a sensitivity analysis on the simulation parameters was also reported in comparison to experimental results aim of this work was to improve the state of the art with an extensive set of combined measurements and computations of different nature and objectives in order to provide a holistic view on the upwind sails aerodynamics keywords wind tunnel experiments pressure measurements flying shapes sails aerodynamics upwind cfd numerical validation nomenclature ρ air density k g m 3 b chord length m c p pressure coefficient c x driving force coefficient c y heeling force coefficient f x driving force n f y heeling force n l 1 pressure sensor at 25 of luff l 2 pressure sensor at 50 of luff l 3 pressure sensor at 75 of luff p pressure pa p 0 mean static pressure pa s sail plane area m 2 v incoming wind speed m s awa apparent wind angle aws apparent wind speed m s cad computer aided design cfd computational fluid dynamics fs full scale rans reynolds averaged navier stokes tof time of flight technology vlm vortex lattice method 1 introduction wind tunnel measurements ail planes have recently become common practice to investigate and optimize sail planes either for upwind and downind conditions fossati et al 2006 and fossati et al 2008 they usually provide very good results especially when carried out in facilities with low blockage and great control of wind quality e g turbulence intensity campbell 2014 nevertheless integral measurements alone e g forces may not be sufficient to understand how a sail planes can be optimized for specific purposes if any information about the complex local fluid structure interaction are provided therefore aerodynamic non dimensional coefficients only which are derived by force measurements and adopted as performance indicators should be correlated to corresponding 3d flying shape and distributed pressure measurements in order also to validate the prediction of numerical codes ranging from velocity prediction programmes vpp to high fidelity computational fluid dynamics cfd moreover the possibility of knowing the effective pressure distribution over the sail plane is of great interest for the aerodynamic and structural design of sails and for the selection and the optimal use of materials production techniques and strategies in this scenario measurements on rigid scale models of sail planes have been recently conducted either upwind viola and flay 2011 or downwind bot et al 2014 as well as on the water with properly instrumented sails respectively viola and flay 2010 bayati et al 2017 and viola and flay 2013 flying shapes detection systems have been included to associate 3d geometry to pressure measurements through camera based vspars system motta et al 2014 time of flight devices vandone 2016 or go pro based cameras deparday et al 2016 along with local load measurements load cells or straing gauges on the rigging or even global force measurements as in fossati et al 2015a where a 6 components dynamometric frame bears the entire sail plane providing the integral aerodynamic forces simultaneously with pressure and sail shapes fossati et al 2016 masuyama 2013 nevertheless a reliable comparison between wind tunnel data versus full scale ones is still to be achieved since different setup and experimental approaches are usually carried out making the direct comparison not straightforward e g rigid sails in the tunnel local forces measurements at full scale bayati et al 2017 this work presents a new set of wind tunnel experimental data carried out with a novel pressure measurement system adapted to soft sails fossati et al 2016 allowing to investigate the pressure distributions on the sails of any trim fossati et al 2006 along with the corresponding forces and flying shapes these wind tunnel tests carried out at politecnico di milano have been performed with the same hardware software setup installed on the sailing yacht laboratory syl the full scale dynamometric sail boat developed by the same research group fossati et al 2015a in terms of forces pressure and shape measurements therefore the presented results are to be considered also suitable for numerical code validation as well as direct comparison with full scale measurements similar numerical experimental comparison has been recently conducted in persson et al 2017 although investigating unsteady aerodynamics on rigid sails more specifically upwind sailing condition is studied in this work both for upright and heeled configurations forces distributed pressures and corresponding shapes are measured for each run and the geometry are then post processed and given as inputs for cfd computations carried out in the open source openfoam environment as well as to feed a vortex lattice code this represents the main philosophy of the present work which aims at providing unprecedented comparison between advanced experiments and different numerical approaches to reach a comprehensive powerful engineering tool when bound together by effective 3d shapes of the sails among various different configurations investigated during the experimental campaign a subset were chosen to be run also in the corresponding numerical environment then herein reported these cases were charactherized by the max power trimming i e maximum c x found during the experiments for different awa investigations other relevant works in this topic can be found in augier et al 2012a 2012b 2013 and aubin et al 2016 2 experimental setup for this work a complete 1 10 scale model of a 48 cruiser racer was adopted it is composed of yacht hull body above the waterline with deck mast rigging and sails the model was installed on the wind tunnel turntable in order to change awa during the tests in the 14 4 m atmospheric boundary layer abl section of politecnico di milano wind tunnel the tests were performed in the standard wind tunnel flow conditions with a smooth wind velocity profile and without considering twisted flow in this configuration the boundary layer thickness is about 0 2 m defined as the height where the wind velocity is equal to 99 of the undisturbed flow velocity the maximum velocity deviation across the section is less than 3 while the turbulence intensity indexes outside the boundary layer are just below 2 the average along wind integral length scale is evaluated equal to 0 15 m the boundary layer dimension ensures a smooth wind velocity profile with constant turbulence intensity on the sail plane as only the hull is subjected to the velocity reduction close to the ground the large size of the section enables yacht scale models of quite large size to be tested so that the sails are large enough to be manufactured using standard sail making techniques and blockage effect is very limited as well moreover the model can be rigged using typical model yacht fittings commercially available that can be used in order to trim the sails as in real operating condition the sheet trims are controlled by a sail trimmer who operates from the wind tunnel control room with a 7 multi turn control knobs that allow winch drum positions to be recorded and re established if necessary the tests were performed at 4 5 m s wind speed a compromise between higher signals noise ratio and lower forces acceptable for the sail control system the wind tunnel speed is mostly limited by the strength of the model mast and rigging and the power of the sheet winches this velocity results in an average chord reynold number of about 1e5 the sailing yacht model was placed on a 6 components dynamometric balance typically adopted for wind tunnel aerospace applications the tested heeled configuration 30 was made available thanks to a dedicated hull model reproducing the corresponding heeled water plane the adopted balance ruag sg balance 192 6 measures the strain produced by loads by means of stran gauges arranged in a wheatstone bridge and calibrated using dead weights and a high precision data acquisition system by the manufacturer the balances were controlled by the amplifier system device hbm mgc this set up was widely used for previous experimental campaigns and the reliability and repeteability of this performed measures were verified in fossati et al 2006 persson et al 2017 fossati and muggiasca 2013 in table 1 the geometry of the tested sail plane is reported as well as in fig 1 where the sections instrumented by pressure strips are shown 2 1 pressure system the pressure distribution on the sails was measured by means of a dedicated pressure system based on mems technology sensors integrated in the pressure scanners fig 2 a single scanner has 16 channels each provides measurements in the range of 1 pa to 1 kpa thanks to a new generation piezo resistive differential low pressure dies besides their measuring accuracy resolution of 0 01 fs these type of scanners were chosen also for their light weight and limited dimension allowing to install the scanners close to the actual measurement sections without affecting the flow field scanners are coupled with pressure strips made of thin polymer films in which tiny micro channels have been manufactured by laser ablation or micro milling these channels allow for the pressure propagation from the tap to the connected pressure sensor some preliminary tests were performed to verify the measurement quality of the system in terms of static accuracy of the pressure measurements and dynamic response of pressure strips the analysis of the static accuracy of the pressure measurement system was carried out in the 1 m 1 5 m test section of the close circuit wind tunnel of the aerodynamics laboratory of politecnico di milano using a constant section naca 23015 airfoil model fig 23 comparative measurements were performed both for the novel pressure system with strip micro channels csem and the consolidated high accuracy pressure scanner system more specifically the latter relies on an esterline pressure systems dtc esp miniature pressure scanner with 1 psi range controlled by a chell quaddaq system fossati et al 2016 comparison between the two acquisition systems were also performed on a sample sail section fig 24 thanks to t tubes duplicating the measurements for the wind tunnel tests both sides of the main sail and the jib have been equipped with the above mentioned tailor made pressure strips this allowed to completely define the flow condition around the sail plane obtaining pressure maps referred to the mean static pressure of the test section measured pressure distributions could be useful also for the analysis of the full scale data in full scale conditions only differential pressures within the two side of the sails can be measured as no reference pressure is easily available bayati et al 2017 each strip provides 40 pressure taps divided among three horizontal test sections at 25 50 and 75 l 1 l 2 and l 3 of the sail luff with 16 taps at the two lower sections and 8 taps on the higher one figs 1 and 25 the taps are disposed at variable chord lengths in order to best capture all the flow phenomena of interest for this reason the tap concentration is rather fine at the leading edge to detect any possible pressure peak and separation bubble and more coarse moving towards the trailing edge where pressure gradients are less severe the adopted pressure strip technology is particularly suited for model scale applications because the small size of the sails reflects in the likewise tiny dimensions of the strips this aspect limits the addition of stiffness to the sail cloth preserving almost entirely the sail natural shape 2 2 flying shape detection during the present wind tunnel campaign a sail flying shape detection system based on time of flight technology tof has been adopted to perform 3d shape measurements a detailed explanation of the tof device can be found in vandone 2016 canciani et al 2015 and fossati et al 2015b more specifically a laser pulse is emitted by the sensor and by measuring the time the pulse takes to hit the target surface and to come back to the receiver it is possible to estimate the target distance the device performs measurements in terms of spatial coordinates of thousands of points belonging to the sail surface without impairing its shape since no contact occurs between object and sensor these data coming singularly from two different laser scanners one for main sail and the other for jib as in fig 3 are then processed together to reconstruct the entire 3d sail plane as explained in vandone 2016 canciani et al 2015 and fossati et al 2015b this set up allows defining the sail shape with a measurement uncertainty that mainly depends on the relative position between target and sensor distance and orientation and on the target surface properties reflectivity and color in particular considering a sensor to target distance of approximately 2 m and an orientation angle of about 90 sensor facing the sails plane frontally a measurement error around 6 mm up to 1 cm was estimated this level of uncertainty can be considered acceptable considering that the same set up was developed to be used both for wind tunnel and full scale tests moreover the sail reconstruction was carried out by using nurbs surfaces to fit thousands of measured points thus the acquisition noise is drastically reduced to quantify this noise reduction we simulated ten possible datasets starting from an acquired point cloud considered as reference and adding to each measured point along the measuring beam direction that can be approximated to the transverse of the yacht centerline a random component representing the acquisition noise normally distributed with mean equal to zero and standard deviation equal to 6 mm these clouds have been analyzed and geometrical parameters have been compared to evaluate the influence of the measurement uncertainty onto the sail shape reconstruction figs 4 7 show and the analysis performed onto the middle section of a jib for the awa 35 depowering configuration the reference section presented a camber of 15 48 and the other simulated clouds provided a mean camber value of 15 leading to a percent error around 0 5 in table 2 are reported value also for a section below 3 8 and above 5 8 the middle one 4 8 other sections especially the highest ones are usually more critical in the acquisition because of occlusions due to the mast or the fore stay so we decided not to consider them for this uncertainty evaluation another critical aspect in the acquisition process is the dynamics of the soft sails aware of that the acquisition software was developed allowing the user to adjust the scan speed and of course the faster the scan is the less the points acquired as a general rule scans no longer than 1 s were accepted this time gap allowed for the acquisition of thousands of points per sail in a considerably static condition consistent with upwind tested conditions for the sake of completeness other devices has been tested in this experimental campaign in particular for the acquisition of the entire sail surface another time of flight sensor with shorter measurement range but higher accuracy microsoft kinect v2 maximum range 4 m accuracy below 1 mm was tested but the laser beam intensity was too low and the transparency of the sail tissue led to infeasible measurement while to gather accurate sail section profiles photogrammetry technique was also considered for its great accuracy even below 0 1 mm in 3d measurement and its instantaneous acquisition tens of circular reflective markers were placed on the sails right close to the pressure stripes as shown in fig 3 to reconstruct the 3d shape of the stripes of both sails by means of three industrial cameras fixed onto the wind tunnel floor all around the yacht model however the poor overlapping field of views of the cameras caused by the setup configuration introduced some issues during the calibration process resulting in a measure accuracy lower than the expected moreover in some tests we experienced occlusion issues that impaired the entire stripe reconstruction during this experimental campaign the photogrammetry technique was also considered for its great accuracy even below 0 1 mm in 3d measurement and its instantaneous acquisition thus tens of circular reflective markers were placed on the sails right close to the pressure stripes as shown in fig 3 to reconstruct the 3d shape of the stripes of both sails by means of three industrial cameras fixed onto the wind tunnel floor all around the yacht model however the poor overlapping field of views of the cameras caused by the setup configuration introduced some issues during the calibration process resulting in a measure accuracy lower than the expected moreover in some tests we experienced occlusion issues that impaired the entire stripe reconstruction fig 31 shows an example of a point cloud acquired during the experimental tests and the post processing pipeline to transform measurements into a surface suitable for numerical simulations acquired points are superimposed on the boat model for an absolute localization of the sails plane then only points belonging to the sail surfaces are extracted and processed by a dedicated software this developed software is able to detect automatically the sail corners and edges criteria to eliminate bad points from the cloud are implemented and for every shape acquisition a check on each sail edge length is carried out comparing the luff leech and foot measured values with the reference real ones then the sail surface is reconstructed fitting this clean dataset and another piece of code runs to automatically finds eight strips considering sail surface sections at different heights finally these sail profiles can be used to support the pressure measurements as reported in this work see figs 24 and 25 or can be further analyzed to obtain geometrical information such as camber draft entry exit front back and twist relative to yacht centerline as widely exploited in vandone 2016 see fig 22 3 experimental results in fig 8 the force based aerodynamic coefficients c x and c y eq 1 are reported for the upright condition about the six apparent wind angles awa tested in this campaign 1 c x f x 1 2 ρ v 2 s c y f y 1 2 ρ v 2 s for each awa the maximum c x was searched by an iterative manual process carried out by professional sailors trimming to the maximum driving force the maximum drive point was found by trimming the sails to the best using the camera views the tufts on the sails and the force measurements output data nevertheless it can be seen that there are some settings at the highest values of heeling force coefficients where the driving force is lower than the maximum value e g 20 and 25 these non optimum values were due to a slight over sheeting of the sails such that the mainsail generally had a tight leech and the airflow separated in the head of the sail after having maximized the driving force the heeling force coefficient would be reduced to simulate the typical trim of the sails conditions with higher wind in fact in real life windy conditions to keep the optimum heeling angle heeling force has to be reduced by the crew the sail trimming routine adopted was to choose the position of the mainsail traveller initially quite high up to windward and then to vary the incidence and the twist of the mainsail to power or de power it by over trimming or easing the main traveller and main sheet the genoa was initially trimmed in order to have the maximum driving force condition and was fixed varying the mainsail shape the obtained data can be provide to a vpp which chooses the best values for a defined full scale wind condition envelope curves have been drawn through the test points with the greatest driving force at a given heeling force e g depower curves fossati et al 2006 in fig 9 three different awas are reported also for the heeled condition 30 it can be seen how the corresponding graphs of fig 8 have similar trends for the heeled case although c x coefficients are generally lower regarding pressure measurements figs 10 and 11 report respectively the qualitative explanations of the upwind sail aerodynamics in terms of phsyical phenomenon and corresponding pressure coefficients eq 2 see viola and flay 2011 more specifically the overall pressure coefficient presents a greater difference between leeward and windward side for the headsail jib than the mainsail for both leading edge bubble causes a drop in the pressure coefficient due to detachment and following reattachment of the fluid stream along the chord b fig 11 on the mainsail this is caused by the presence of the mast which causes the separation with regard to the jib this occurs either way whenever the leading edge is not perfectly parallel with the streamlines i e overtrimmed angle of attack higher than optimal and the high curvature results in causing the separation viola and flay 2011 moreover different trailing edge conditions are qualitatively experienced by the two sails respectively with a non zero c p for the jib and zero for the main sail e g koutta joukowsky condition 2 c p p p 0 1 2 ρ v 2 corresponding pressure measurements along the depower curves of fig 8 are reported in figs 12 and 13 respectively for the selected awa of 25 and 35 in upright conditions the obtained distributions especially on the middle sections of main and jib present evident agreement with the expected trends although the suction shows a bit higher which might be reasonably more realistic with completely different sail shape soft and material surface roughness than the previous experimental measurements viola and flay 2011 both sails present a suction region on the leeward side where the flow is accelerated and the pressure drops and a region of positive pressure on the windward side where the flow is slowed down at the leading edge of both sails the flow detaches from the surface and reattaches further downstream creating the so called separation bubble which is a region of recirculating flow at the trailing edge depending on the sail trim and the angle of attack with the incoming air the flow might separate again leading to turbulent phenomena and vortex shedding in general the aerodynamic loads on the headsail are greater and oriented more towards the forward direction compared to the main sail see fossati et al 2016 this characteristic is due to the different shape of the two sails and their interaction with each other looking at the mid section of figs 12 and 13 where the flow is not disturbed by tip effects the mast is shown to have great influence on the pressure distribution and interestingly the effect varies along the sail height and with trim looking at the mainsail for both the awa considered an increase in suction coefficients can easily be seen in the leeward side near the leading edge where the mast is placed as discussed before this is related to a large separation bubble that extends up to 10 of the chord the highest negative values in this region were obtained for the configurations with higher driving force coefficient c x whereas when easing is carried the flow is less accelerated and consequently the negative values became lower in these cases the greater sail curvature leads to higher more negative pressure gradients that allow reaching similar values at the mid chord from that location the downstream distribution remains almost identical within the same de power curve furthermore moving along the airfoil chord up to the trailing edge another greatly suction coefficient region is experienced at the lowest section the flatter shape of the sail reflects on the pressure distribution at the leading edge since the flow is less accelerated the pressure recovers faster leading to smaller separation bubbles along the chord the limited curvature even for depowered trims only partially increases the flow speed resulting in lower less negative pressures without showing any peak but rather a smooth trend the highest section is extremely interesting as it clearly shows the effect of twist the most tightened trims present high angles of attack that produce large leading edge bubbles and flat shapes that induce the flow to detach quite upstream the combination of these two effects results in an almost monotonic increasing pressure trends as described in viola and flay 2011 when the traveller is eased and the main sail twisted the sail curvature increases and the angle of attack decreases leading to pressure distributions more similar to the other sections in real sailing conditions for achieving a good trim this kind of regulation is essential because it allows to depower the highest sections thus reducing their aerodynamic contribution which is mainly to heel the boat and to generate strong tip vortices i e induced drag looking at the jib it is worth recalling that the jib shape was not changed during the depowering procedure therefore the pressure distribution differences among the various trims must be attributed to the changes of the mainsail influence only this can be directly observed fig 27 where two trims relative to awa 35 are reported in terms of pressure distributions and sails shapes for section l2 it is evident how basically the same jib shape of the section 1 1 in fig 27 the two jibs are rotated in the visualization to better appreciate the pressure distribution which was not modified along the de power curve in terms of trimming results in different pressure trends due to the different efficiency of the mainsail whose suction effect on the jib is greatly lower in a de powered setting this in turn brings about a modification of the boundary conditions of the jib itself due to different main sail aerodynamic efficiency as it can be seen in fig 15 as a sort of rigid rotation the sail is actually enough stiff to preserve its shape curvature if any change in the trim is introduced even if the pressure distribution changes as a consequence of the different flow conditions produced by the main trim also the different overall lateral forces f y computed from integrating the pressures over the l2 section confirms the differences observed in the integral measurements further analysis concerning pressure measurements and sail shape are reported in vandone 2016 also on the jib leading edge a separation bubble can be found suggesting that the slight over trim of the head sail made to prevent soft sails from flapping results in a drop of c p compared to the main sail the jib shows greater differences depending on the trim also in the second half of the chord up to the trailing edge more specifically the mainsail positively affects the jib by increasing its effective angle of attack up wash effect and accelerating the flow on the leeward side thanks to the suction region created on the contrary the headsail acts oppositely on the main down wash effect which therefore is subjected to lower aerodynamic loads in particular a more powerful suction on the main leeward side corresponds to a stronger up wash effect which in turn results in greater induced angles of incidence therefore when the up wash effect is very strong i e the angle of incidence very high toward max c x the pressure at the leading edge reaches considerably low values the separation bubble enlarges and consequently the positive pressure gradient related to the reattachment decreases at the same time the flat pressure distribution close to the trailing edge indicates that the flow detaches prematurely due to the high curvature and large velocities this finding clearly visible also on l 1 of fig 12 confirms the distributed pressure described in viola and flay 2011 in case of very high angles of attack as the main is eased the up wash induced angle of attack of the jib decreases and the leading edge bubble gets smaller the l 2 of figs 12 and 13 can be taken as reference to justify the respective higher efficiency reported in fig 8 of awa 35 case against awa 25 a realistic visualization about the interpretations reported in this paragraph can be found in fig 14 and fig 15 based on measurements it must be noticed that the lowest part of the jib was difficult to reconstruct from measurements due to the presence of instrumentation pressure scanners and the relative cables 4 numerical analysis in the present section the two different numerical methods adopted are reported as mentioned they have been chosen for their different capabilities in terms of the resolved fluid dynamics and the related different computational efforts as such they both rely on the measured fully 3d sail shapes of the corresponding wind tunnel load cases 4 1 vortex lattice method the vlm code adopted refers to helmstad and larsson 2013 it is based on potential flow theory which is valid under the assumptions of incompressible inviscid and irrotational fluid for this reason it is suitable for simulating closed hauled navigation only where the contribution to the overall forces of viscous effect and turbulence is limited as in the present work this code was adopted as a low fidelity engineering tool for a rough but efficient comparison with experimental results based on tof measurements of the flying shapes of the wind tunnel runs each sail has been discretized with a 20 10 panel grid in order to sufficiently well describe the sail curvatures and at the same time keeping the computational time very limited computing the circulation strengths and velocities for each panel the force acting on each panel is computed with the formula expressed in the kutta joukowski theorem then integrated over the sail a simple wake model is implemented in this code helmstad and larsson 2013 assuming that the flow behind the sails is mainly aligned with the free stream without generating unreal lift forces thus guaranteeing kutta conditions hence the wake can be modelled by a single row of panels that extends for several meters downstream oriented as the free stream velocity which is known and constant this was preferred against the implementation of a completely free force wake model ensuring that trailing edge panel was oriented with the local velocity since in helmstad and larsson 2013 it was found that any relevant difference in the force coefficients made it preferable against the simple wake model 4 2 computational fluid dynamics rans equations was chosen for cfd analysis implemented in the open source environment openfoam as for vlm computations the sail shape geometry was elaborated from tof measurements as explained in vandone 2016 and properly set on the cad model of the hull mast assembly forming a unique stl file to be included in the meshing procedure in this assembly all the negligible geometries were disregarded e g rigging instrumentations winches etc the boundary domain was set as a box with the same dimensions as the wind tunnel test section 4 m 14 m x 36 m and the model was virtually placed at the same distance from the inlet starting from the outer box the mesh was generated in terms of structured hexahedral cells that from a rather big edge size 1 1 m and progressively refined getting closer to the boat model as the flow gradients to be resolved get steeper downsizing up to 2 mm with triangular tetrahedral elements see fig 16 which corresponds to the artificial thickness of the sails extruded from the surface at the local reynolds numbers of the cases tested re is approximately 150 k the boundary layer has an overall thickness of maximum 17 mm this means that for a proper resolution of all the flow phenomena inside it in particular the viscous sublayer a mesh size in the order of the tenth of millimetre is needed closed to the surface the numerical solution has been conveyed from the region attached to the surface to the outer flow with the aid of specific wall functions i e nutuspalding implemented in correspondence to mast and sails where no slip conditions were set all the rest of boundary surfaces are considered either slip walls low hull or symmetrical planes front back upper since an accurate description of the flow is out of the interest of this work rans equations are solved iteratively with the simple algorithm semi implicit method for pressure linked equations commonly used for steady state upwind sail aerodynamics 2013 incompressible fluid flows whose detailed explanation can be found in openfoam guide user guide geometric agglomerated algebraic multi grid solver gamg was adopted along with the following schemes time steady gradient divergence laplacian linear gaussian linear a convergence study was carried out considering the case of a w a 27 5 in upright condition the three turbulence models spalart allmaras k ε and k ω sst were tested with different meshes for each combination the aerodynamic coefficients have been extracted and evaluated against the correspondent values of wind tunnel table 3 summarize the relative errors on the coefficients between numerical result and experimental outcome for each case showing that spalart allmaras model presents the most coherent trends the coefficients tend towards the values obtained in experiments as the number of cells increases i e as the computational grid gets finer more details on the uncertainty quantification for experimental and numerical results can be found respectively in eca and hoekstra 2014 xing and stern 1115 and viola et al 2013 on the other hand the behaviour of k ε and k ω sst models might seem somehow surprising considering that they should represent more accurately the physical phenomena being composed by two transport equations in fact it seems that the results do not depend on the grid resolution or even that the trend is opposite to the one expected a possible explanation for this behaviour might be related to the use of wall functions which need specific sizes of cells close to the walls of interest in particular it should be guaranteed a certain thickness of the first layer y 30 that in our case would have prevented to place a minimum number of cells within the boundary layer resulting in a grid too coarse for properly refining other important flow phenomena it is reasonable to think that this aspect has more influence on turbulence models finer and more sensitive such as k ε and k ω sst moreover compared to the other turbulence models spalart allmaras has been developed specifically for external flows low angles of attack and limited areas interested by flow separation which reflects quite precisely the tested condition justifying its choice over k ε and k ω sst models this model was adopted also for the corresponding suitable grid resolution chosen as a compromise between accuracy of results and manageable computational loads and times table 3 in particular the configuration with around 6 million cells guaranteed a good trade off between these two aspects generating relative errors lower than 2 5 compared to experimental coefficients and reasonable computational times of approximately 5 h with 32 processors running in parallel therefore this set up was selected as grid structure for all the simulations a visualization of the results of a sample run is reported in fig 17 5 experimental numerical comparison 5 1 aerodynamic coefficients in table 4 experimental numerical comparison about the aerodynamic coefficients corresponding to the maximum c x is reported for both upright and heeled conditions figs 8 and 9 the agreement is overall fairly good with all numerical methods especially for upright condition whereas for heeled one a greater dispersion is found although limited this is reasonably due to the higher level of complexity in the flow pattern arising from the greater three dimensional nature of the flow as well as the great dependency on the leading edge aerodynamics more difficult to be numerically simulated furthermore in the heeled condition the measured and simulated forces need to be oriented also in the vertical plane this might explain the higher errors on c y rather than on c x as expected rans simulations are always closer to wind tunnel data than vlm results thrust coefficient c x calculated with the viscous model accurately follows the experimental one remaining within 5 relative error for almost every configuration considered the heel coefficient c y is predicted correctly particularly in upright conditions where the errors stay below 6 the heeled configurations present worse results for the reasons stated above but the relative errors only slightly exceed 10 coherently vlm method predicts quite well the measured coefficients especially at lower wind angles where the turbulence has minor effects 5 2 pressure distribution in figss 18 21 experimental numerical comparison about pressure distributions is reported for the upright conditions corresponding to the maximum c x at a w a 25 and a w a 35 in figs 18 and 19 the pressure value obtained in the wind tunnel from each tap is directly compared to the value calculated numerically by the rans method at the same chordwise location on each section whereas in figs 20 and 21 differential values are reported to compare the two numerical methods simultaneously numerical values were picked from simulations in the locations corresponding to the measurement points for a direct comparison figs 18 and 19 show very good agreement confirming the reliable numerical method i e turbulence model and boundary layer wall function and the flying shape detection methodology nonetheless the ability to predict the leading edge separation bubbles is evident even though it is the most critical to be reproduced numerically since the flow separates and abruptly reattaches downstream with high sensitivity to the small differences in the angle of attack interestingly the most significant disagreements between experiments and simulations are observed on the windward side of the sail specifically on the main surface the pressure is quite largely over predicted indicating that the simulated flow is slower than in wind tunnel this behaviour somehow surprising because numerically the flow speed should be higher since the wind shear layer is not modelled is most probably related to the poor simulation of the interaction between mast and main sail on the other hand the sail surface is reconstructed from a point cloud and therefore the sail leading edge might slightly differ from the real one as well as the generated sails plane is placed manually on the virtual boat model through selected reference points the combination of these two procedures inherently characterized by uncertainties affects the sensitive interaction between mast and main sail this explanation is coherent also with the fairly accurate agreement on the windward side of the head sail which is only marginally influenced by the fore stay present in the wind tunnel and not modelled in openfoam a more detailed description of the uncertainty quantification of the reconstructed sails plane from shape measurements can be found in vandone 2016 figs 20 and 21 show the experimental comparison in terms of δ c p among all the numerical methods as expected vlm is able to predict quite closely the experimental behaviour in fig 20 only where the angle of attack is lower compared to fig 21 especially for the l 2 level nevertheless since the mechanisms of separation and reattachment are completely neglected along with viscosity the net pressure distribution is in general over predicted in vlm method the comparison between numerical and experimental results in max power conditions were considered more in detail in fig 18 awa 25 and in fig 19 awa 35 where rans and wind tunnel pressure distributions are directly plotted on the l2 section of the sale plan fig 28 and fig 29 in the two figures the forces obtained from pressure integration on the section are also reported both the components for each sail arrows on the left for the jib and arrows on the right for the main and the resultant arrows on the middle are considered it is possible to note that the main differences in the section forces concern the heeling component and they are greater for 35 of angle of attack confirming the trend observed on the global forces it may also be highlighted that the differences in the global quantities can be lower than the ones concerning the local forces and pressures in fig 20 vlm and experimental results are compared at 25 the heeling force on a single sail shows higher discrepancy with respect to the resultant on the l2 section where differences balance out this points out that global quantities especially if coming from numerical simulations must be carefully considered in the evaluation of fluid structure interaction pressure distributions were measured also for the heeled cases fig 30 reported as an example the comparison between the mean pressure coefficients obtained in upright and heeled conditions at 25 wind angle both for max power trim analysing the figures it emerges that the pressure distributions on the three levels of the main sail are very similar presenting only minor differences regarding the curvature related suction peak most probably caused by a slightly different sail shape assumed in the two cases on the other hand the pressures on the headsail are quite different both on leeward and windward sides in particular also considering fig 26 the heeled configuration presents higher pressures less negative on the leeward side especially at the leading edge and less positive on the windward resulting ultimately in lower δ c p this can be explained considering that in heeled conditions the flow is more three dimensional the inclination of the sails induces the flow to move upwards along the surfaces enhancing the vertical component of velocity this interferes with the 2d flow that develops along the sail chord increasing the velocity on the windward side and reducing the effective angle of attack which in turns weakens the suction region on the leeward side this phenomenon is more evident on the jib rather than on the main because of the sail shapes the headsail has greater curvature and sail location the flow is accelerated vertically in the first portions of the chord and then becomes more horizontal following the surfaces this produces a reduction on both driving and heeling forces in heeled model as observed for the force coefficients in fig 9 6 conclusions this work reports an experimental and numerical wind tunnel investigation of the aerodynamics of sails related to close hauled navigation compared to the state of the art in this work soft sails were adopted and trimmed during wind tunnel experiments as in real navigation being equipped by thin and soft pressure strips not influencing the natural shape of the sails flying shape were also measured along with aerodynamic forces for each experimental run feeding the numerical analysis and comparison thanks to the simultaneous information in terms of distributed pressure forces and shape deep insight of the aerodynamics of upwind sails was provided confirming theoretical preliminary studies and works on rigid sails and allowing further to correlate in detail different pressure distributions with progressively different sails trims de powering as well as the overall sails performance aerodynamic coefficients vlm and rans simulations of the corresponding wind tunnel measurements were also reported allowing to validate the different range of validity of the two numerical methods as well as the sensitivity of cfd different parameters on the predictive capability of rans this work has been carried out with the aim of extensively documenting the physics of upwind sails aerodynamics via consistent simultaneous and even redundant combinations of measurements and numerical analysis so as to give a further contribution to the state of the art and to consolidate the global understanding of such phenomenon through different engineering approaches further improvements of the work herein reported can be carried out in the topic of the accuracy and uncertainty quantification of the sails shape more accurate cfd modelling of the experimental setup e g boundary layer as well as cfd simulations in unsteady setup to better catch the separated flow acknowledgements the authors want to acknowledge various msc and phd students who partially contributed to the experimental and numerical work over the years g castellano l bernini f giacobone g campanardi for his technical support during wind tunnel tests m belloli for helpful discussions on the results and a lisa for useful conversations during real sailing moreover this work has been started under the brilliant guidance of prof fabio fossati to his memory this milestone is dedicated 
22808,the present paper reports an experimental numerical study about the aerodynamics of sails in upwind conditions this work is part of a wider research frame carried out in the recent years at politecnico di milano involving numerical wind tunnel and full scale studies on the aero hydrodynamics of sailing yachts the experimental apparatus adopted in this work is the scaled version of the full scale setup adopted in the sailing yacht laboratory syl at the same institutions more specifically soft sails were tested in wind tunnel in close hauled conditions properly equipped with thin and soft pressure strips at different sections of head and main sail therefore simultaneous data about distributed pressure aerodynamic forces and 3d flying shapes were gathered fine trimming were investigated during the tests to study the different effect on pressure distribution performance and sail shapes the measured sails geometry about the same conditions fed the steady numerical simulations based both on vortex lattice method and reynolds averaged navier stokes equations for comparison and validation with regard to the latter a sensitivity analysis on the simulation parameters was also reported in comparison to experimental results aim of this work was to improve the state of the art with an extensive set of combined measurements and computations of different nature and objectives in order to provide a holistic view on the upwind sails aerodynamics keywords wind tunnel experiments pressure measurements flying shapes sails aerodynamics upwind cfd numerical validation nomenclature ρ air density k g m 3 b chord length m c p pressure coefficient c x driving force coefficient c y heeling force coefficient f x driving force n f y heeling force n l 1 pressure sensor at 25 of luff l 2 pressure sensor at 50 of luff l 3 pressure sensor at 75 of luff p pressure pa p 0 mean static pressure pa s sail plane area m 2 v incoming wind speed m s awa apparent wind angle aws apparent wind speed m s cad computer aided design cfd computational fluid dynamics fs full scale rans reynolds averaged navier stokes tof time of flight technology vlm vortex lattice method 1 introduction wind tunnel measurements ail planes have recently become common practice to investigate and optimize sail planes either for upwind and downind conditions fossati et al 2006 and fossati et al 2008 they usually provide very good results especially when carried out in facilities with low blockage and great control of wind quality e g turbulence intensity campbell 2014 nevertheless integral measurements alone e g forces may not be sufficient to understand how a sail planes can be optimized for specific purposes if any information about the complex local fluid structure interaction are provided therefore aerodynamic non dimensional coefficients only which are derived by force measurements and adopted as performance indicators should be correlated to corresponding 3d flying shape and distributed pressure measurements in order also to validate the prediction of numerical codes ranging from velocity prediction programmes vpp to high fidelity computational fluid dynamics cfd moreover the possibility of knowing the effective pressure distribution over the sail plane is of great interest for the aerodynamic and structural design of sails and for the selection and the optimal use of materials production techniques and strategies in this scenario measurements on rigid scale models of sail planes have been recently conducted either upwind viola and flay 2011 or downwind bot et al 2014 as well as on the water with properly instrumented sails respectively viola and flay 2010 bayati et al 2017 and viola and flay 2013 flying shapes detection systems have been included to associate 3d geometry to pressure measurements through camera based vspars system motta et al 2014 time of flight devices vandone 2016 or go pro based cameras deparday et al 2016 along with local load measurements load cells or straing gauges on the rigging or even global force measurements as in fossati et al 2015a where a 6 components dynamometric frame bears the entire sail plane providing the integral aerodynamic forces simultaneously with pressure and sail shapes fossati et al 2016 masuyama 2013 nevertheless a reliable comparison between wind tunnel data versus full scale ones is still to be achieved since different setup and experimental approaches are usually carried out making the direct comparison not straightforward e g rigid sails in the tunnel local forces measurements at full scale bayati et al 2017 this work presents a new set of wind tunnel experimental data carried out with a novel pressure measurement system adapted to soft sails fossati et al 2016 allowing to investigate the pressure distributions on the sails of any trim fossati et al 2006 along with the corresponding forces and flying shapes these wind tunnel tests carried out at politecnico di milano have been performed with the same hardware software setup installed on the sailing yacht laboratory syl the full scale dynamometric sail boat developed by the same research group fossati et al 2015a in terms of forces pressure and shape measurements therefore the presented results are to be considered also suitable for numerical code validation as well as direct comparison with full scale measurements similar numerical experimental comparison has been recently conducted in persson et al 2017 although investigating unsteady aerodynamics on rigid sails more specifically upwind sailing condition is studied in this work both for upright and heeled configurations forces distributed pressures and corresponding shapes are measured for each run and the geometry are then post processed and given as inputs for cfd computations carried out in the open source openfoam environment as well as to feed a vortex lattice code this represents the main philosophy of the present work which aims at providing unprecedented comparison between advanced experiments and different numerical approaches to reach a comprehensive powerful engineering tool when bound together by effective 3d shapes of the sails among various different configurations investigated during the experimental campaign a subset were chosen to be run also in the corresponding numerical environment then herein reported these cases were charactherized by the max power trimming i e maximum c x found during the experiments for different awa investigations other relevant works in this topic can be found in augier et al 2012a 2012b 2013 and aubin et al 2016 2 experimental setup for this work a complete 1 10 scale model of a 48 cruiser racer was adopted it is composed of yacht hull body above the waterline with deck mast rigging and sails the model was installed on the wind tunnel turntable in order to change awa during the tests in the 14 4 m atmospheric boundary layer abl section of politecnico di milano wind tunnel the tests were performed in the standard wind tunnel flow conditions with a smooth wind velocity profile and without considering twisted flow in this configuration the boundary layer thickness is about 0 2 m defined as the height where the wind velocity is equal to 99 of the undisturbed flow velocity the maximum velocity deviation across the section is less than 3 while the turbulence intensity indexes outside the boundary layer are just below 2 the average along wind integral length scale is evaluated equal to 0 15 m the boundary layer dimension ensures a smooth wind velocity profile with constant turbulence intensity on the sail plane as only the hull is subjected to the velocity reduction close to the ground the large size of the section enables yacht scale models of quite large size to be tested so that the sails are large enough to be manufactured using standard sail making techniques and blockage effect is very limited as well moreover the model can be rigged using typical model yacht fittings commercially available that can be used in order to trim the sails as in real operating condition the sheet trims are controlled by a sail trimmer who operates from the wind tunnel control room with a 7 multi turn control knobs that allow winch drum positions to be recorded and re established if necessary the tests were performed at 4 5 m s wind speed a compromise between higher signals noise ratio and lower forces acceptable for the sail control system the wind tunnel speed is mostly limited by the strength of the model mast and rigging and the power of the sheet winches this velocity results in an average chord reynold number of about 1e5 the sailing yacht model was placed on a 6 components dynamometric balance typically adopted for wind tunnel aerospace applications the tested heeled configuration 30 was made available thanks to a dedicated hull model reproducing the corresponding heeled water plane the adopted balance ruag sg balance 192 6 measures the strain produced by loads by means of stran gauges arranged in a wheatstone bridge and calibrated using dead weights and a high precision data acquisition system by the manufacturer the balances were controlled by the amplifier system device hbm mgc this set up was widely used for previous experimental campaigns and the reliability and repeteability of this performed measures were verified in fossati et al 2006 persson et al 2017 fossati and muggiasca 2013 in table 1 the geometry of the tested sail plane is reported as well as in fig 1 where the sections instrumented by pressure strips are shown 2 1 pressure system the pressure distribution on the sails was measured by means of a dedicated pressure system based on mems technology sensors integrated in the pressure scanners fig 2 a single scanner has 16 channels each provides measurements in the range of 1 pa to 1 kpa thanks to a new generation piezo resistive differential low pressure dies besides their measuring accuracy resolution of 0 01 fs these type of scanners were chosen also for their light weight and limited dimension allowing to install the scanners close to the actual measurement sections without affecting the flow field scanners are coupled with pressure strips made of thin polymer films in which tiny micro channels have been manufactured by laser ablation or micro milling these channels allow for the pressure propagation from the tap to the connected pressure sensor some preliminary tests were performed to verify the measurement quality of the system in terms of static accuracy of the pressure measurements and dynamic response of pressure strips the analysis of the static accuracy of the pressure measurement system was carried out in the 1 m 1 5 m test section of the close circuit wind tunnel of the aerodynamics laboratory of politecnico di milano using a constant section naca 23015 airfoil model fig 23 comparative measurements were performed both for the novel pressure system with strip micro channels csem and the consolidated high accuracy pressure scanner system more specifically the latter relies on an esterline pressure systems dtc esp miniature pressure scanner with 1 psi range controlled by a chell quaddaq system fossati et al 2016 comparison between the two acquisition systems were also performed on a sample sail section fig 24 thanks to t tubes duplicating the measurements for the wind tunnel tests both sides of the main sail and the jib have been equipped with the above mentioned tailor made pressure strips this allowed to completely define the flow condition around the sail plane obtaining pressure maps referred to the mean static pressure of the test section measured pressure distributions could be useful also for the analysis of the full scale data in full scale conditions only differential pressures within the two side of the sails can be measured as no reference pressure is easily available bayati et al 2017 each strip provides 40 pressure taps divided among three horizontal test sections at 25 50 and 75 l 1 l 2 and l 3 of the sail luff with 16 taps at the two lower sections and 8 taps on the higher one figs 1 and 25 the taps are disposed at variable chord lengths in order to best capture all the flow phenomena of interest for this reason the tap concentration is rather fine at the leading edge to detect any possible pressure peak and separation bubble and more coarse moving towards the trailing edge where pressure gradients are less severe the adopted pressure strip technology is particularly suited for model scale applications because the small size of the sails reflects in the likewise tiny dimensions of the strips this aspect limits the addition of stiffness to the sail cloth preserving almost entirely the sail natural shape 2 2 flying shape detection during the present wind tunnel campaign a sail flying shape detection system based on time of flight technology tof has been adopted to perform 3d shape measurements a detailed explanation of the tof device can be found in vandone 2016 canciani et al 2015 and fossati et al 2015b more specifically a laser pulse is emitted by the sensor and by measuring the time the pulse takes to hit the target surface and to come back to the receiver it is possible to estimate the target distance the device performs measurements in terms of spatial coordinates of thousands of points belonging to the sail surface without impairing its shape since no contact occurs between object and sensor these data coming singularly from two different laser scanners one for main sail and the other for jib as in fig 3 are then processed together to reconstruct the entire 3d sail plane as explained in vandone 2016 canciani et al 2015 and fossati et al 2015b this set up allows defining the sail shape with a measurement uncertainty that mainly depends on the relative position between target and sensor distance and orientation and on the target surface properties reflectivity and color in particular considering a sensor to target distance of approximately 2 m and an orientation angle of about 90 sensor facing the sails plane frontally a measurement error around 6 mm up to 1 cm was estimated this level of uncertainty can be considered acceptable considering that the same set up was developed to be used both for wind tunnel and full scale tests moreover the sail reconstruction was carried out by using nurbs surfaces to fit thousands of measured points thus the acquisition noise is drastically reduced to quantify this noise reduction we simulated ten possible datasets starting from an acquired point cloud considered as reference and adding to each measured point along the measuring beam direction that can be approximated to the transverse of the yacht centerline a random component representing the acquisition noise normally distributed with mean equal to zero and standard deviation equal to 6 mm these clouds have been analyzed and geometrical parameters have been compared to evaluate the influence of the measurement uncertainty onto the sail shape reconstruction figs 4 7 show and the analysis performed onto the middle section of a jib for the awa 35 depowering configuration the reference section presented a camber of 15 48 and the other simulated clouds provided a mean camber value of 15 leading to a percent error around 0 5 in table 2 are reported value also for a section below 3 8 and above 5 8 the middle one 4 8 other sections especially the highest ones are usually more critical in the acquisition because of occlusions due to the mast or the fore stay so we decided not to consider them for this uncertainty evaluation another critical aspect in the acquisition process is the dynamics of the soft sails aware of that the acquisition software was developed allowing the user to adjust the scan speed and of course the faster the scan is the less the points acquired as a general rule scans no longer than 1 s were accepted this time gap allowed for the acquisition of thousands of points per sail in a considerably static condition consistent with upwind tested conditions for the sake of completeness other devices has been tested in this experimental campaign in particular for the acquisition of the entire sail surface another time of flight sensor with shorter measurement range but higher accuracy microsoft kinect v2 maximum range 4 m accuracy below 1 mm was tested but the laser beam intensity was too low and the transparency of the sail tissue led to infeasible measurement while to gather accurate sail section profiles photogrammetry technique was also considered for its great accuracy even below 0 1 mm in 3d measurement and its instantaneous acquisition tens of circular reflective markers were placed on the sails right close to the pressure stripes as shown in fig 3 to reconstruct the 3d shape of the stripes of both sails by means of three industrial cameras fixed onto the wind tunnel floor all around the yacht model however the poor overlapping field of views of the cameras caused by the setup configuration introduced some issues during the calibration process resulting in a measure accuracy lower than the expected moreover in some tests we experienced occlusion issues that impaired the entire stripe reconstruction during this experimental campaign the photogrammetry technique was also considered for its great accuracy even below 0 1 mm in 3d measurement and its instantaneous acquisition thus tens of circular reflective markers were placed on the sails right close to the pressure stripes as shown in fig 3 to reconstruct the 3d shape of the stripes of both sails by means of three industrial cameras fixed onto the wind tunnel floor all around the yacht model however the poor overlapping field of views of the cameras caused by the setup configuration introduced some issues during the calibration process resulting in a measure accuracy lower than the expected moreover in some tests we experienced occlusion issues that impaired the entire stripe reconstruction fig 31 shows an example of a point cloud acquired during the experimental tests and the post processing pipeline to transform measurements into a surface suitable for numerical simulations acquired points are superimposed on the boat model for an absolute localization of the sails plane then only points belonging to the sail surfaces are extracted and processed by a dedicated software this developed software is able to detect automatically the sail corners and edges criteria to eliminate bad points from the cloud are implemented and for every shape acquisition a check on each sail edge length is carried out comparing the luff leech and foot measured values with the reference real ones then the sail surface is reconstructed fitting this clean dataset and another piece of code runs to automatically finds eight strips considering sail surface sections at different heights finally these sail profiles can be used to support the pressure measurements as reported in this work see figs 24 and 25 or can be further analyzed to obtain geometrical information such as camber draft entry exit front back and twist relative to yacht centerline as widely exploited in vandone 2016 see fig 22 3 experimental results in fig 8 the force based aerodynamic coefficients c x and c y eq 1 are reported for the upright condition about the six apparent wind angles awa tested in this campaign 1 c x f x 1 2 ρ v 2 s c y f y 1 2 ρ v 2 s for each awa the maximum c x was searched by an iterative manual process carried out by professional sailors trimming to the maximum driving force the maximum drive point was found by trimming the sails to the best using the camera views the tufts on the sails and the force measurements output data nevertheless it can be seen that there are some settings at the highest values of heeling force coefficients where the driving force is lower than the maximum value e g 20 and 25 these non optimum values were due to a slight over sheeting of the sails such that the mainsail generally had a tight leech and the airflow separated in the head of the sail after having maximized the driving force the heeling force coefficient would be reduced to simulate the typical trim of the sails conditions with higher wind in fact in real life windy conditions to keep the optimum heeling angle heeling force has to be reduced by the crew the sail trimming routine adopted was to choose the position of the mainsail traveller initially quite high up to windward and then to vary the incidence and the twist of the mainsail to power or de power it by over trimming or easing the main traveller and main sheet the genoa was initially trimmed in order to have the maximum driving force condition and was fixed varying the mainsail shape the obtained data can be provide to a vpp which chooses the best values for a defined full scale wind condition envelope curves have been drawn through the test points with the greatest driving force at a given heeling force e g depower curves fossati et al 2006 in fig 9 three different awas are reported also for the heeled condition 30 it can be seen how the corresponding graphs of fig 8 have similar trends for the heeled case although c x coefficients are generally lower regarding pressure measurements figs 10 and 11 report respectively the qualitative explanations of the upwind sail aerodynamics in terms of phsyical phenomenon and corresponding pressure coefficients eq 2 see viola and flay 2011 more specifically the overall pressure coefficient presents a greater difference between leeward and windward side for the headsail jib than the mainsail for both leading edge bubble causes a drop in the pressure coefficient due to detachment and following reattachment of the fluid stream along the chord b fig 11 on the mainsail this is caused by the presence of the mast which causes the separation with regard to the jib this occurs either way whenever the leading edge is not perfectly parallel with the streamlines i e overtrimmed angle of attack higher than optimal and the high curvature results in causing the separation viola and flay 2011 moreover different trailing edge conditions are qualitatively experienced by the two sails respectively with a non zero c p for the jib and zero for the main sail e g koutta joukowsky condition 2 c p p p 0 1 2 ρ v 2 corresponding pressure measurements along the depower curves of fig 8 are reported in figs 12 and 13 respectively for the selected awa of 25 and 35 in upright conditions the obtained distributions especially on the middle sections of main and jib present evident agreement with the expected trends although the suction shows a bit higher which might be reasonably more realistic with completely different sail shape soft and material surface roughness than the previous experimental measurements viola and flay 2011 both sails present a suction region on the leeward side where the flow is accelerated and the pressure drops and a region of positive pressure on the windward side where the flow is slowed down at the leading edge of both sails the flow detaches from the surface and reattaches further downstream creating the so called separation bubble which is a region of recirculating flow at the trailing edge depending on the sail trim and the angle of attack with the incoming air the flow might separate again leading to turbulent phenomena and vortex shedding in general the aerodynamic loads on the headsail are greater and oriented more towards the forward direction compared to the main sail see fossati et al 2016 this characteristic is due to the different shape of the two sails and their interaction with each other looking at the mid section of figs 12 and 13 where the flow is not disturbed by tip effects the mast is shown to have great influence on the pressure distribution and interestingly the effect varies along the sail height and with trim looking at the mainsail for both the awa considered an increase in suction coefficients can easily be seen in the leeward side near the leading edge where the mast is placed as discussed before this is related to a large separation bubble that extends up to 10 of the chord the highest negative values in this region were obtained for the configurations with higher driving force coefficient c x whereas when easing is carried the flow is less accelerated and consequently the negative values became lower in these cases the greater sail curvature leads to higher more negative pressure gradients that allow reaching similar values at the mid chord from that location the downstream distribution remains almost identical within the same de power curve furthermore moving along the airfoil chord up to the trailing edge another greatly suction coefficient region is experienced at the lowest section the flatter shape of the sail reflects on the pressure distribution at the leading edge since the flow is less accelerated the pressure recovers faster leading to smaller separation bubbles along the chord the limited curvature even for depowered trims only partially increases the flow speed resulting in lower less negative pressures without showing any peak but rather a smooth trend the highest section is extremely interesting as it clearly shows the effect of twist the most tightened trims present high angles of attack that produce large leading edge bubbles and flat shapes that induce the flow to detach quite upstream the combination of these two effects results in an almost monotonic increasing pressure trends as described in viola and flay 2011 when the traveller is eased and the main sail twisted the sail curvature increases and the angle of attack decreases leading to pressure distributions more similar to the other sections in real sailing conditions for achieving a good trim this kind of regulation is essential because it allows to depower the highest sections thus reducing their aerodynamic contribution which is mainly to heel the boat and to generate strong tip vortices i e induced drag looking at the jib it is worth recalling that the jib shape was not changed during the depowering procedure therefore the pressure distribution differences among the various trims must be attributed to the changes of the mainsail influence only this can be directly observed fig 27 where two trims relative to awa 35 are reported in terms of pressure distributions and sails shapes for section l2 it is evident how basically the same jib shape of the section 1 1 in fig 27 the two jibs are rotated in the visualization to better appreciate the pressure distribution which was not modified along the de power curve in terms of trimming results in different pressure trends due to the different efficiency of the mainsail whose suction effect on the jib is greatly lower in a de powered setting this in turn brings about a modification of the boundary conditions of the jib itself due to different main sail aerodynamic efficiency as it can be seen in fig 15 as a sort of rigid rotation the sail is actually enough stiff to preserve its shape curvature if any change in the trim is introduced even if the pressure distribution changes as a consequence of the different flow conditions produced by the main trim also the different overall lateral forces f y computed from integrating the pressures over the l2 section confirms the differences observed in the integral measurements further analysis concerning pressure measurements and sail shape are reported in vandone 2016 also on the jib leading edge a separation bubble can be found suggesting that the slight over trim of the head sail made to prevent soft sails from flapping results in a drop of c p compared to the main sail the jib shows greater differences depending on the trim also in the second half of the chord up to the trailing edge more specifically the mainsail positively affects the jib by increasing its effective angle of attack up wash effect and accelerating the flow on the leeward side thanks to the suction region created on the contrary the headsail acts oppositely on the main down wash effect which therefore is subjected to lower aerodynamic loads in particular a more powerful suction on the main leeward side corresponds to a stronger up wash effect which in turn results in greater induced angles of incidence therefore when the up wash effect is very strong i e the angle of incidence very high toward max c x the pressure at the leading edge reaches considerably low values the separation bubble enlarges and consequently the positive pressure gradient related to the reattachment decreases at the same time the flat pressure distribution close to the trailing edge indicates that the flow detaches prematurely due to the high curvature and large velocities this finding clearly visible also on l 1 of fig 12 confirms the distributed pressure described in viola and flay 2011 in case of very high angles of attack as the main is eased the up wash induced angle of attack of the jib decreases and the leading edge bubble gets smaller the l 2 of figs 12 and 13 can be taken as reference to justify the respective higher efficiency reported in fig 8 of awa 35 case against awa 25 a realistic visualization about the interpretations reported in this paragraph can be found in fig 14 and fig 15 based on measurements it must be noticed that the lowest part of the jib was difficult to reconstruct from measurements due to the presence of instrumentation pressure scanners and the relative cables 4 numerical analysis in the present section the two different numerical methods adopted are reported as mentioned they have been chosen for their different capabilities in terms of the resolved fluid dynamics and the related different computational efforts as such they both rely on the measured fully 3d sail shapes of the corresponding wind tunnel load cases 4 1 vortex lattice method the vlm code adopted refers to helmstad and larsson 2013 it is based on potential flow theory which is valid under the assumptions of incompressible inviscid and irrotational fluid for this reason it is suitable for simulating closed hauled navigation only where the contribution to the overall forces of viscous effect and turbulence is limited as in the present work this code was adopted as a low fidelity engineering tool for a rough but efficient comparison with experimental results based on tof measurements of the flying shapes of the wind tunnel runs each sail has been discretized with a 20 10 panel grid in order to sufficiently well describe the sail curvatures and at the same time keeping the computational time very limited computing the circulation strengths and velocities for each panel the force acting on each panel is computed with the formula expressed in the kutta joukowski theorem then integrated over the sail a simple wake model is implemented in this code helmstad and larsson 2013 assuming that the flow behind the sails is mainly aligned with the free stream without generating unreal lift forces thus guaranteeing kutta conditions hence the wake can be modelled by a single row of panels that extends for several meters downstream oriented as the free stream velocity which is known and constant this was preferred against the implementation of a completely free force wake model ensuring that trailing edge panel was oriented with the local velocity since in helmstad and larsson 2013 it was found that any relevant difference in the force coefficients made it preferable against the simple wake model 4 2 computational fluid dynamics rans equations was chosen for cfd analysis implemented in the open source environment openfoam as for vlm computations the sail shape geometry was elaborated from tof measurements as explained in vandone 2016 and properly set on the cad model of the hull mast assembly forming a unique stl file to be included in the meshing procedure in this assembly all the negligible geometries were disregarded e g rigging instrumentations winches etc the boundary domain was set as a box with the same dimensions as the wind tunnel test section 4 m 14 m x 36 m and the model was virtually placed at the same distance from the inlet starting from the outer box the mesh was generated in terms of structured hexahedral cells that from a rather big edge size 1 1 m and progressively refined getting closer to the boat model as the flow gradients to be resolved get steeper downsizing up to 2 mm with triangular tetrahedral elements see fig 16 which corresponds to the artificial thickness of the sails extruded from the surface at the local reynolds numbers of the cases tested re is approximately 150 k the boundary layer has an overall thickness of maximum 17 mm this means that for a proper resolution of all the flow phenomena inside it in particular the viscous sublayer a mesh size in the order of the tenth of millimetre is needed closed to the surface the numerical solution has been conveyed from the region attached to the surface to the outer flow with the aid of specific wall functions i e nutuspalding implemented in correspondence to mast and sails where no slip conditions were set all the rest of boundary surfaces are considered either slip walls low hull or symmetrical planes front back upper since an accurate description of the flow is out of the interest of this work rans equations are solved iteratively with the simple algorithm semi implicit method for pressure linked equations commonly used for steady state upwind sail aerodynamics 2013 incompressible fluid flows whose detailed explanation can be found in openfoam guide user guide geometric agglomerated algebraic multi grid solver gamg was adopted along with the following schemes time steady gradient divergence laplacian linear gaussian linear a convergence study was carried out considering the case of a w a 27 5 in upright condition the three turbulence models spalart allmaras k ε and k ω sst were tested with different meshes for each combination the aerodynamic coefficients have been extracted and evaluated against the correspondent values of wind tunnel table 3 summarize the relative errors on the coefficients between numerical result and experimental outcome for each case showing that spalart allmaras model presents the most coherent trends the coefficients tend towards the values obtained in experiments as the number of cells increases i e as the computational grid gets finer more details on the uncertainty quantification for experimental and numerical results can be found respectively in eca and hoekstra 2014 xing and stern 1115 and viola et al 2013 on the other hand the behaviour of k ε and k ω sst models might seem somehow surprising considering that they should represent more accurately the physical phenomena being composed by two transport equations in fact it seems that the results do not depend on the grid resolution or even that the trend is opposite to the one expected a possible explanation for this behaviour might be related to the use of wall functions which need specific sizes of cells close to the walls of interest in particular it should be guaranteed a certain thickness of the first layer y 30 that in our case would have prevented to place a minimum number of cells within the boundary layer resulting in a grid too coarse for properly refining other important flow phenomena it is reasonable to think that this aspect has more influence on turbulence models finer and more sensitive such as k ε and k ω sst moreover compared to the other turbulence models spalart allmaras has been developed specifically for external flows low angles of attack and limited areas interested by flow separation which reflects quite precisely the tested condition justifying its choice over k ε and k ω sst models this model was adopted also for the corresponding suitable grid resolution chosen as a compromise between accuracy of results and manageable computational loads and times table 3 in particular the configuration with around 6 million cells guaranteed a good trade off between these two aspects generating relative errors lower than 2 5 compared to experimental coefficients and reasonable computational times of approximately 5 h with 32 processors running in parallel therefore this set up was selected as grid structure for all the simulations a visualization of the results of a sample run is reported in fig 17 5 experimental numerical comparison 5 1 aerodynamic coefficients in table 4 experimental numerical comparison about the aerodynamic coefficients corresponding to the maximum c x is reported for both upright and heeled conditions figs 8 and 9 the agreement is overall fairly good with all numerical methods especially for upright condition whereas for heeled one a greater dispersion is found although limited this is reasonably due to the higher level of complexity in the flow pattern arising from the greater three dimensional nature of the flow as well as the great dependency on the leading edge aerodynamics more difficult to be numerically simulated furthermore in the heeled condition the measured and simulated forces need to be oriented also in the vertical plane this might explain the higher errors on c y rather than on c x as expected rans simulations are always closer to wind tunnel data than vlm results thrust coefficient c x calculated with the viscous model accurately follows the experimental one remaining within 5 relative error for almost every configuration considered the heel coefficient c y is predicted correctly particularly in upright conditions where the errors stay below 6 the heeled configurations present worse results for the reasons stated above but the relative errors only slightly exceed 10 coherently vlm method predicts quite well the measured coefficients especially at lower wind angles where the turbulence has minor effects 5 2 pressure distribution in figss 18 21 experimental numerical comparison about pressure distributions is reported for the upright conditions corresponding to the maximum c x at a w a 25 and a w a 35 in figs 18 and 19 the pressure value obtained in the wind tunnel from each tap is directly compared to the value calculated numerically by the rans method at the same chordwise location on each section whereas in figs 20 and 21 differential values are reported to compare the two numerical methods simultaneously numerical values were picked from simulations in the locations corresponding to the measurement points for a direct comparison figs 18 and 19 show very good agreement confirming the reliable numerical method i e turbulence model and boundary layer wall function and the flying shape detection methodology nonetheless the ability to predict the leading edge separation bubbles is evident even though it is the most critical to be reproduced numerically since the flow separates and abruptly reattaches downstream with high sensitivity to the small differences in the angle of attack interestingly the most significant disagreements between experiments and simulations are observed on the windward side of the sail specifically on the main surface the pressure is quite largely over predicted indicating that the simulated flow is slower than in wind tunnel this behaviour somehow surprising because numerically the flow speed should be higher since the wind shear layer is not modelled is most probably related to the poor simulation of the interaction between mast and main sail on the other hand the sail surface is reconstructed from a point cloud and therefore the sail leading edge might slightly differ from the real one as well as the generated sails plane is placed manually on the virtual boat model through selected reference points the combination of these two procedures inherently characterized by uncertainties affects the sensitive interaction between mast and main sail this explanation is coherent also with the fairly accurate agreement on the windward side of the head sail which is only marginally influenced by the fore stay present in the wind tunnel and not modelled in openfoam a more detailed description of the uncertainty quantification of the reconstructed sails plane from shape measurements can be found in vandone 2016 figs 20 and 21 show the experimental comparison in terms of δ c p among all the numerical methods as expected vlm is able to predict quite closely the experimental behaviour in fig 20 only where the angle of attack is lower compared to fig 21 especially for the l 2 level nevertheless since the mechanisms of separation and reattachment are completely neglected along with viscosity the net pressure distribution is in general over predicted in vlm method the comparison between numerical and experimental results in max power conditions were considered more in detail in fig 18 awa 25 and in fig 19 awa 35 where rans and wind tunnel pressure distributions are directly plotted on the l2 section of the sale plan fig 28 and fig 29 in the two figures the forces obtained from pressure integration on the section are also reported both the components for each sail arrows on the left for the jib and arrows on the right for the main and the resultant arrows on the middle are considered it is possible to note that the main differences in the section forces concern the heeling component and they are greater for 35 of angle of attack confirming the trend observed on the global forces it may also be highlighted that the differences in the global quantities can be lower than the ones concerning the local forces and pressures in fig 20 vlm and experimental results are compared at 25 the heeling force on a single sail shows higher discrepancy with respect to the resultant on the l2 section where differences balance out this points out that global quantities especially if coming from numerical simulations must be carefully considered in the evaluation of fluid structure interaction pressure distributions were measured also for the heeled cases fig 30 reported as an example the comparison between the mean pressure coefficients obtained in upright and heeled conditions at 25 wind angle both for max power trim analysing the figures it emerges that the pressure distributions on the three levels of the main sail are very similar presenting only minor differences regarding the curvature related suction peak most probably caused by a slightly different sail shape assumed in the two cases on the other hand the pressures on the headsail are quite different both on leeward and windward sides in particular also considering fig 26 the heeled configuration presents higher pressures less negative on the leeward side especially at the leading edge and less positive on the windward resulting ultimately in lower δ c p this can be explained considering that in heeled conditions the flow is more three dimensional the inclination of the sails induces the flow to move upwards along the surfaces enhancing the vertical component of velocity this interferes with the 2d flow that develops along the sail chord increasing the velocity on the windward side and reducing the effective angle of attack which in turns weakens the suction region on the leeward side this phenomenon is more evident on the jib rather than on the main because of the sail shapes the headsail has greater curvature and sail location the flow is accelerated vertically in the first portions of the chord and then becomes more horizontal following the surfaces this produces a reduction on both driving and heeling forces in heeled model as observed for the force coefficients in fig 9 6 conclusions this work reports an experimental and numerical wind tunnel investigation of the aerodynamics of sails related to close hauled navigation compared to the state of the art in this work soft sails were adopted and trimmed during wind tunnel experiments as in real navigation being equipped by thin and soft pressure strips not influencing the natural shape of the sails flying shape were also measured along with aerodynamic forces for each experimental run feeding the numerical analysis and comparison thanks to the simultaneous information in terms of distributed pressure forces and shape deep insight of the aerodynamics of upwind sails was provided confirming theoretical preliminary studies and works on rigid sails and allowing further to correlate in detail different pressure distributions with progressively different sails trims de powering as well as the overall sails performance aerodynamic coefficients vlm and rans simulations of the corresponding wind tunnel measurements were also reported allowing to validate the different range of validity of the two numerical methods as well as the sensitivity of cfd different parameters on the predictive capability of rans this work has been carried out with the aim of extensively documenting the physics of upwind sails aerodynamics via consistent simultaneous and even redundant combinations of measurements and numerical analysis so as to give a further contribution to the state of the art and to consolidate the global understanding of such phenomenon through different engineering approaches further improvements of the work herein reported can be carried out in the topic of the accuracy and uncertainty quantification of the sails shape more accurate cfd modelling of the experimental setup e g boundary layer as well as cfd simulations in unsteady setup to better catch the separated flow acknowledgements the authors want to acknowledge various msc and phd students who partially contributed to the experimental and numerical work over the years g castellano l bernini f giacobone g campanardi for his technical support during wind tunnel tests m belloli for helpful discussions on the results and a lisa for useful conversations during real sailing moreover this work has been started under the brilliant guidance of prof fabio fossati to his memory this milestone is dedicated 
22809,this paper presents an application and stability result of a modified line of sight los guidance law for 3 d path following pf of an unmanned underactuated underwater vehicle subject to environmental disturbances the pf problem is solved using a revised relative system model with an improved flow frame and a complete model of ocean current wave disturbances the pf approach uses course control and speed allocation which is the problem of allocating the desired inertial total speed into desired body velocities including current wave velocities the definitions of track errors in the general pf problem have been accurately illustrated in the inertial frame the course control strategy defined by incorporating the slip angles into the desired heading angles has been extended to vertical plane with the new definition of vertical slip stability results include local exponential stability les of the enclosure based los elos and semi global exponential stability sges of the modified los guidance laws the 3 d los vector is tracked simultaneously in both planes using a planar speed assignment strategy in 4 dof for a coupled 3 d tracking simulation results show robust pf performance of a sway underactuated auv in course control in the presence of significant ocean current disturbances and measurement noises the effectiveness of simple course control and speed allocation in disturbance rejection has also been illustrated keywords marine guidance and control line of sight path following kinematics ocean currents underwater vehicles 1 introduction the primary applications of unmanned underwater vehicles e g pipeline tracking and surveying require accurate and efficient execution of path following pf tasks underwater vehicles with autonomous capabilities such as autonomous underwater vehicles auv also allow for execution of tasks that are costly and dangerous for humans the pf task can be solved without any time constraints on the path unlike trajectory tracking tt as a maneuvering problem using guidance laws breivik and fossen 2005 fossen 2011 pf also has the potential to provide smoother convergence properties and decreased actuator activity aguiar and hespanha 2007 compared to tt this makes pf a simpler more flexible and robust and thus a better choice over tt accurate modeling of underwater vehicle dynamics is not trivial caccia et al 2000 and pf under parametric uncertainties is treated in aguiar and hespanha 2007 for design of pf controllers the line of sight los guidance is a popular choice because of its simplicity and good path convergence properties fossen et al 2003 breivik and fossen 2009 lekkas and fossen 2013 nevertheless in the presence of external disturbances such as ocean currents and waves pf performance can be severely affected if these disturbances are not taken into account in the design this is usually due to the difficulty in achieving accurate estimates of the sideslip caused by sway motion where the performance is more degraded if sway dof is underactuated lekkas and fossen 2014 however most of the existing auvs are torpedo shaped and thus underactuated since this provides energy efficiency and robustness through general design simplicity caharija et al 2012 the sideslip is a measure of sway motion relative to surge and it is difficult to accurately estimate the sideslip because of the difficulty in achieving accurate hydrodynamic models and noises in accelerometers or even global positioning systems lu et al 2016 thus estimation and incorporation of the sideslip angle is important in pf under disturbances there are adaptive approaches aplied to estimating the sideslip angle in fossen and lekkas 2014 lu et al 2016 the sideslip angle has been treated as a bias and estimated using adaptive laws in lu et al 2017 a reduced order extended state observer has been employed to identify a time varying sideslip nevertheless the integral los ilos design have become a more common approach to deal with sideways drift caused by unknown ocean currents børhaug et al 2008 breivik and fossen 2009 caharija et al 2012 2016 wigg et al 2016 where caharija et al 2016 further provides experimental results the approach most of these works apply in dealing with disturbances is to steer vehicle heading towards a desired non zero steady state heading angle with respect to the path heading so that the vehicle is allowed to slide side ways to stay on the path during a drift this concept is achieved through feeding back the sideslip angle to the desired heading angle that now incorporates the drift in sway this is conveniently referred in this paper as course control which can achieve the same objective of reducing the drift in a simpler and effective manner and is further studied course control essentially controls the actual displacement of the vehicle since it controls the direction of the total inertial speed by incorporating the sideways drift through sideslip angle instead of only controlling the vehicle heading i e non course control while the definition of coruse angle with sideslip is not new e g fossen 2011 fossen and pettersen 2014 course control with side slip is only first published by lekkas and fossen 2013 in 3 d and subsequently reported by lekkas and fossen 2014 fossen and lekkas 2015 and abdurahman et al 2017b a for pf in 2 d where its capability in current disturbance rejection are shown 3 d course control is only discussed in lekkas and fossen 2014 where it requires the definition of vertical slip in the vertical plane in sway underactuated cases it is important to analyze the behavior of the uncontrolled sway dynamics especially when there are environmental disturbances since the vehicle motion is coupled the sway motion relative to an inertial frame is usually negligible and the desired surge velocity is made equal to the desired total speed both relative to the inertial frame see e g caharija et al 2012 2016 this is referred here as the speed allocation problem of allocating a single desired total speed in an inertial frame to desired speeds at the body frame and its unique structure has been formulated first in abdurahman et al 2017b which provides a design of desired surge velocity that can incorporate the current disturbance the effectiveness of speed allocation in current drift reduction has been shown in both abdurahman et al 2017b a and is further studied and extended to 3 d case in this paper the los pf is achieved through tracking a reference point on the path and the los guidance has two steering schemes the lookahead based los llos and the enclosure based los elos guidance fossen 2011 the llos scheme is computationally simpler than elos scheme since the later requires solving a set of two equations online to find a circle path interception for computing the los angle ψ l o s however a fixed lookahead distance provided by traditional llos scheme is not an optimal solution to path following that a small will achieve faster path convergence but may produce overshoot and oscillations while a large can eliminate these problems but results in slower path convergence lekkas and fossen 2013 the trade off that has been sought in the literature e g lekkas and fossen 2012 is provided naturally with the elos scheme where it inherently employs a time varying look ahead distance that provides a perpendicular heading near the edge of the radius r and thus a faster path convergence while changing the heading towards a path parallel direction as the vehicle comes closer to the path thus eliminating the overshoot and oscillation this presents an inherent advantage of the elos scheme is that it provides a varying lookahead distance which is most likely the reason why it performs better when it involves following curved paths see comparison of carrot chasing and the nonlinear guidance law in sujit et al 2014 however the tuning radius and los vector r is conventionally fixed and it is critical for r to be greater than the cross track error y e so that the enclosing circle is bigger than the distance from the vehicle to the path and thus the circle path interceptions exist if not other guidance laws are required to guide the vehicle towards the path which was also an implementation issue sujit et al 2014 it was shown in abdurahman et al 2017b that the switching mechanism has been shown to be simpler and more effective than two other such modifications on elos guidance the switching enclosure based los selos guidance always ensures the existence of circle path interceptions a comparison of selos guidance law to llos and the vector field guidance laws has also been carried out using course control in abdurahman et al 2017a at the kinetic level which shows their advantages and disadvantages and that there is no clear winner among them in terms of providing both low control effort and low cross track error the selos scheme in abdurahman et al 2017b is extended to 3 d in this work the vertical course control problem has also been formulated with an illustrated definition of the vertical slip compared to the only existing vertical slip or vertical sideslip angle as presented in lekkas and fossen 2013 without illustration in addition more detailed illustrations of the los pf problem have been shown in both horizontal and vertical planes where the definitions of the track errors are also provided using inertial coordinates which have not been done so in existing literature see e g latest illustrations in fossen and pettersen 2014 caharija et al 2016 stability results of los guidance laws in the literature are limitted only to the llos scheme and to straight paths semi global exponential stability sges of llos guidance law has been provided by fossen and pettersen 2014 stability of llos in the vertical plane has been shown by wigg et al 2016 albeit with integral action in this regard local exponential stability les and sges results of the elos and selos guidance laws are provided for straight paths moreover the difference between the cross track error dynamics for straight and curved paths is highlighted incorporation of the ocean current and wave in the relative equations of motion are presented in fossen 2012 and subsequent studies dealing with disturbance also rely on this model e g caharija et al 2016 it should be noted that this model however does not provide the definitions of the current angle of attack α c and current roll angle and thus may not be suitable in 3 d simulations a new model of the constant slowly varying and irrotational ocean current has also been presented and implemented in the pf task which is more easy to follow and complete with definitions of the current euler angles in 3 d and can also be used to represent wave disturbances incorporation of this current and or wave disturbance into the relative equations of motion requires an improved understanding of the flow reference frame which is also provided in this paper with a better understanding reference frames the main contributions of this paper compared to previous works can be summarized as follows 1 a new and complete model of the 3 d ocean current incorporating ocean waves and extension of the selos guidance law with speed allocation and a coupled planar speed assignment technique for a 3 d coupled pf in 4 dof have been presented the ocean current modeling approach includes more accurate expressions of motion states relative to the fluid flow frame in relative system dynamics and general coordinate transformations these lead to more accurate pf control designs and simulations of environmental disturbances in general the benefits of speed allocation in disturbance rejection and energy efficiency when combined with course control has also been demonstrated 2 improved formulation of the 3 d pf problem with more accurate definitions and illustrations of the relevant vectors track errors and path euler angles in inertial reference frames are presented this includes the formulation of vertical guidance law for vertical pitch course control with the definition of vertical slip angle for simpler and better disturbance rejection in the vertical plane the benefit of course control in significant disturbance rejection has also been illustrated 3 les and sges stability results of the horizontal vertical elos and horizontal selos guidance laws for straight path the paper is organized as follows a 5 dof relative system model with the improved flow and the new current reference frames are presented in section 2 along with the model of the ocean current section 3 presents the pf problem with control objective speed allocation and definitions of the revised track errors the horizontal and vertical los course control with slip angels are given in section 4 section 5 presents the stability results the control systems uncontrolled sway dynamics simulation results using a dynamic 4 dof auv model in waypoint following scenario with disturbances and measurement noises are presented in section 6 finally a conclusion is given in section 7 2 relative system model 2 1 relative system model the relative equations of motion for uvs are conventionally given by the 6 dof nonlinear model of fossen 2011 2012 based on newton euler formulation where the 5 dof model can be extracted as 1 η b n n j θ b n n ν b f v c l n n 0 0 t 2 m ν b f c ν b f ν b f d ν b f ν b f g θ b n n τ the three index convention from fossen 2011 is used here to represent the vectors which is beneficial in describing relativity this convention emphasises a distinction between relative to and expressed in first distingiushed by encarnação and pascoal 2000 the index convention are read as e g η b n n is the vehicle body position and euler angles relative to the inertial frame north east down ned and expressed in ned it follows that ν b f is the vehicle body velocities and euler rates relative to the fluid frame flow v c l n n is the linear velocities of ocean current relative to and expressed in ned j θ b n n is the transformation matrix from ned to body with θ b n n ϕ θ ψ t being the vehicle euler angles relative to and expressed in ned with right hand convention m is the mass inertia matrix including rigid body and added mass c ν b f is the matrix of coriolis and centripetal forces and moments d ν b f is the damping matrix including linear and nonlinear damping terms g θ b n n is the vector of gravitational and restoring forces and moments and the control input vector τ consists of input and disturbance forces and moments the ned frame is defined by x n y n z n with a chosen reference point on the surface of the earth as its center and north east and down as positive directions with right hand convention the relationship between the vehicle velocity relative to the fluid was first published by caccia et al 2000 which is subsequently given by børhaug et al 2008 fossen 2011 caharija et al 2016 as 3 ν b f ν b n b ν c n b where ν b n b is the vehicle body velocities and euler rates relative to ned expressed in body and ν c n b is the ocean current velocity and euler rates relative to ned expressed in body now it can be seen that it has not been made clear in which reference frame ν b f is expressed in this requires further understanding of the flow reference frame and how it is defined the effective volume of ambient fluid motion around the vehicle can be described by the flow frame f x f y f z f with a center of flow cf coinciding with the co of body the flow frame is defined by fossen 2011 2012 as being aligned with body but here it is defined as opposite to body similar to that in ross 2008 one of the reasons is that it is preferred from the perspective of newton s 3rd law in this case ν b f can now be expressed in the flow frame i e ν b f ν b f f and the relationship of relativity in eq 3 becomes 4 ν b f f ν b n b ν c n b when there is no current ν c n b 0 and consequently ν b f f ν b n b this means that despite both ν b f f and ν b n b having the same sign they are opposite to each other because ν b f f is expressed in flow and ν b n b is expressed in body where flow and body are 180 o out of phase from each other this is further illustrated through fig 1 for 3 different motion scenarios in surge thus the signs of the states depend on which reference frame they are being expressed in when roll and pitch are passively stabilized i e when ϕ θ 0 the 4 dof relative dynamics can be rewritten as 5 η b n n j θ b n n ν b n b 6 m ν b f f c ν b f f ν b f f d ν b f f ν b f f g θ b n n bf with eq 4 describing the updated relationship of relativity at body level now η b n n x y z ψ is the inertial velocities and yaw rate relative to and expressed in ned ν b n b u v w r t is the body velocities in surge sway and heave and yaw rate relative to ned and expressed in body ν c n b u c v c w c r c t is the ocean current linear velocities and yaw rate relative to ned and expressed in body ν b f f u f v f w f r f t is the body velocities in surge sway and heave and yaw rate relative to and expressed in flow and g θ b n n 0 0 0 0 t under the assumption of neutral buoyancy the control input vector m 1 bf τ u 0 τ w τ ψ t consists of surge heave forces and yaw moment where f is the actuator input vector and b is the actuator configuration matrix this structure of the control input vector is obtained by assuming that origin b of body is positioned in the pivot point such that yaw moment has no effect on sway motion which was first shown by fredriksen and pettersen 2006 the system in eq 6 is underactuated in sway since the dimension of f is less than that of the system the 4 dof transformation matrix without roll and pitch dof is given by 7 j θ b n n r θ b n n 0 3 1 0 1 3 1 expanding this yields the 4 dof kinematics as 8 x u cos ψ v sin ψ 9 y u sin ψ v cos ψ 10 z w 11 ψ r 2 2 ocean current model the ocean current is conventionally described by the old flow frame by fossen 2012 using the current heading and a current angle of attack while the definition of current heading in the inertial frame β c is intuitive fossen and lekkas 2015 the definition of the current angle of attack α c is not given plus more justification could be provided for the principal transformation approach used in fossen 2012 in this paper a new current reference frame is used to fully describe the ocean current in ned the idea here is to treat the ocean current wave as a separate object by having its own reference frame the current frame c x c describing a volume of ocean current relative to ned with a chosen center of current cc and x c as its direction of stream the ocean current is not a rigid body but its directions as those of the 3 d current intensity vector v c can be described by its euler angles relative to and expressed in ned which are denoted as θ c n n ϕ c θ c ψ c t the linear components of constant and irrotational current in ned in 4 dof are defined by v c n n v x v y v z v ψ t where the current intensity given by v c v x 2 v y 2 v z 2 u c 2 v c 2 w c 2 is bounded and v ψ 0 for irrotational current in ned the current euler angles can now be defined as ϕ c θ c ψ c a t a n 2 v z v y a t a n 2 v z v x a t a n 2 v y v x these euler angles exist since v x v y v z are measurable in practice note that the entire volume of the current stream is assumed to be in uniform motion as the cc so that the vehicle experiences the same forces across all projecting areas in given direction of current for constant current in ned v c n n 0 with current euler angles the v c n n can now be easily rotated to body from ned using the transpose of body to ned transformation matrix which is 12 ν c n b u c v c w c r c t j θ c n n θ b n n t v c n n this expands to 13 u c v x c ψ c ψ c θ c v y s ψ c ψ c θ c v z s θ c 14 v c v x c ψ c ψ s θ c s ϕ c s ψ c ψ c ϕ c v y c ψ c ψ c ϕ c s ψ c ψ s θ c s ϕ c v z c θ c s ϕ c 15 w c v x s ψ c ψ s ϕ c c ψ c ψ c ϕ c s θ c v y s ψ c ψ s θ c c ϕ c c ψ c ψ s ϕ c v z c θ c c ϕ c since ϕ θ 0 in vehicle 4 dof s c denote sine and cosine and r c 0 the rotation θ c n n θ b n n is logical because both θ c n n and θ b n n are expressed in the same ned frame θ c n n θ b n n means that the angles used for decomposing v c n n into ν b n b are the angular difference between them and the transpose of transformation matrix j then rotates the linear current components in ned to body this is also an easier to follow and more intuitive insight into general coordinate transformations the dynamics of the current in body is simply obtained by time differentiating eq 12 16 u c r v x s ψ c ψ c θ c v y c ψ c ψ c θ c 17 v c r v x s ψ c ψ s θ c s ϕ c c ψ c ψ c ϕ c r v y c ψ c ψ s θ c s ϕ c s ψ c ψ c ϕ c 18 w c r v x c ψ c ψ s ϕ c s ψ c ψ c ϕ c s θ c r v y s ψ c ψ s ϕ c c ψ c ψ s θ c c ϕ c since v c 0 and the current euler rates θ c n n 0 for irrotational current relative to ned remark 1 the previous flow frame in fossen 2012 is used to describe the ocean current the ocean current here is described by both the improved flow and a current frame complete with the definition of the current euler angles compared to previous works this approach of representing fluids by their own reference frame is naturally also applicable to aerospace applications for modeling and incorporating 3 d wind disturbances the flow frame in fossen 2011 corresponded to the wind frame in aerospace while the current frame here can correspond to a wind frame that can be similarly defined to describe the motion of a uniform volume of air relative to ned where the role of the new flow frame remains the same note that the flow frame not only describes the fluid motion caused by the ocean current but also the fluid motion in the absence of ocean current i e the fluid motion caused due to vehicle motion relative to flow since ocean currents and waves are both fluid motion the current frame can also be used to describe ocean waves through ν c n n and thus the current disturbance can also be referred as current and or wave disturbances remark 2 note that ν b n b is also referred as absolute velocity in many works e g in fossen 2012 this may not contribute to better understanding of the problem in general since motion is always relative to a reference point frame this can also be seen from the relationship of relativity in eqs 3 and 4 that all the vectors here are either relative to ned or flow 3 control objective the path following problem is solved as a maneuvering problem breivik and fossen 2005 where a geometric and a dynamic task are solved the geometric task can be defined as minimizing the 3 d off track error the normal distance from the vehicle to the path in 4 dof case without pitch and roll this can be achieved in a cascaded manner by solving a dynamic task that requires the vehicle heading ψ the horizontal speed u h u 2 v 2 in ned and heave speed w to track the desired heading angle ψ d the desired horizontal speed u h d u d 2 v d 2 in ned and the desired heave speed w d relative to ned and expressed in body resp u d and v d and are the desired body speeds relative to ned expressed in body 3 1 speed allocation the desired horizontal speed u h d 0 is required to be allocated to u d and v d there is no solution to this problem in the literature and usually u d u h d when the sway motion is assumed negligible e g fossen 2011 caharija et al 2016 in børhaug et al 2008 u d is solved as u d sin u h d under the same assumption this problem will be referred as the speed allocation problem here and more generally this can also describe the problem of transforming speeds between body fixed and inertial reference frames the unique formulation of the speed allocation is first published in abdurahman et al 2017b in 2 d which can be extended to 3 d using the three index notation convention used in this paper the 3 d speed allocation is given by 19 u d u d 2 v d 2 w d 2 20 u h d u d 2 v d 2 21 u d u d f u c 22 v d v d f v c 23 w d w d f w c where u d is the desired total speed ν d b n b u d v d w d r d t is the desired body velocities and euler rate in surge sway heave and yaw relative to ned and expressed in body ν d b f f u d f v d f w d f r d f t is the desired body velocities and euler rate in surge sway heave and yaw relative to and expressed in flow eq 19 23 represent the structure for the speed allocation problem it can be seen that the formulation of eqs 21 23 is analogous to the relationship of relativity in eq 4 where the actual states become the desired states this can also be naturally extended to design desired angular velocities if the current is rotational in ned the speed allocation can now incorporate the amount of actuation desired in each dof by setting scalar values or 0 for ν d f since they are the vehicle speed relative to flow in sway underactuated case here v d f can be set to zero in eq 22 to yield v d v c which gives the solution to u d f from eq 20 as 24 u d u h d 2 v d 2 u h d 2 v c 2 and u h d is pre assigned notice that the vehicle surge is designed to slow down in 24 if there is a large sway current v c this is beneficial only in course control and is explained in the next section notice also that for successful path following under current wave disturbances if sway dof is not actuated such that u d is given by eq 24 it is required that u h d v c to avoid imaginary solutions for u d 3 2 track errors and control objective 3 2 1 track errors the horizontal and vertical track errors are usually defined in the path p frame and their definition in inertial coordinates are not provided in the literature e g in børhaug et al 2008 fossen and pettersen 2014 caharija et al 2016 abdurahman et al 2017b an improved illustrations of the track errors are presented here first with the definitions of the cross track along track and off track errors in ned for general pf problem the along track cross track and vertical track or vertical cross track as referred in lekkas and fossen 2013 errors x e y e and z e are commonly the normal distances from the path to the vehicle in 2 d x e and y e are shown in fig 2 which is an updated version of that in fossen and pettersen 2014 in n e plane it can now be seen that the along track error x e becomes the curved length of the path between points x p y p and x l o s y l o s in curved path which is then equivalent to horizontal look ahead distance h if this segment is a straight line the cross track error y e can now be defined in ned by the following coordinates from fig 2 as 25 y e x x p 2 y y p 2 e x 2 e y 2 it can also be given by the cosine rule as 26 l o s h y e 2 h 2 2 y e h cos θ r h where θ r h can be referred as the look ahead angle between h and y e these show that the coordinate transformations as in fossen 2011 lekkas and fossen 2013 are not necessary to define x e and y e if the coordinates are already in ned frame equation 26 is for the general case pf with straight and curved paths when following a straight path θ r h is a right angle and thus l o s h y e 2 h 2 the vertical track error z e can similarly be defined as 27 z e x x p 2 z z p 2 e x 2 e z 2 the 3 d normal distance from the path is then given by the off track error e y z which can now be defined by the pythagoras relationship between the cross track and vertical track errors y e and z e as e y z y e 2 z e 2 therefore in 3 d the geometric task can also be alternatively set as minimizing e y z which means the vehicle is on the path in 3 d note that the definitions of the track errors in eqs 25 27 are positive as results of distance equations their signs in ned can be separately assigned the origin of ned can be set at the point of vehicle normal projection on the path x p y p z p which moves along as the vehicle moves and the direction of north as the direction of the path in this case y e is positive negative if the vehicle is on right left hand side of the path and z e is positive negative if the vehicle is below above the path according to the right hand convention of ned having the track errors defined the control objectives in sway underactuated 4 dof pf are formulated as 28 lim t u t u d t 29 lim t w t w d t 30 lim t ψ t ψ d t 31 lim t y e t 0 32 lim t z e t 0 z e and e y z are depicted in figs 3 and 4 the pf problem becomes course control when the desired heading ψ d includes the sideslip to compensate for the drift in vehicle sway see fig 5 note that when following curved paths the curvature of the path has to be smaller than the curvature of the enclosing radius r so that the solution of y e is unique fossen and pettersen 2014 4 3 d selos guidance and course control 4 1 horizontal los guidance law the elos guidance creates an enclosing circle around the vehicle in 2 d fossen et al 2003 in 3 d it can similarly create an enclosing sphere with los vector radius r centered at vehicle ned position and use one of the sphere path interceptions as the reference point p l o s x l o s y l o s z l o s to calculate ψ l o s for designing ψ d the equation for the sphere is given by 33 x l o s x 2 y l o s y 2 z l o s z 2 l o s 2 r 2 which can be used with the equations of the 3 d line formed between two way points p k and p k 1 or p k and p k 1 once p l o s is solved the horizontal reference heading is given by ψ l o s as 34 ψ l o s atan 2 y l o s y x l o s x p i 2 θ h θ x p p i 2 cos 1 l o s h 2 y e h 2 2 l o s h y e tan 1 x x p y y p using the cosine law note that the second equality in eq 34 is only applicable for this specific los reference p l o s in fig 2 of curved pf other equations can be similarly derived for different cases thus conventional definitions of the los angles are only applicable to straight lines e g fossen and pettersen 2014 caharija et al 2016 when following a straight path from fig 2 ψ l o s is given by 35 ψ l o s atan 2 y l o s y x l o s x ψ p ψ y e ψ p tan 1 y e h which is the conventional los guidance law for straight path the path heading ψ p tan 1 y p x p when the path is series of way points consisting of only straight lines ψ p is given by 36 y l o s y k x l o s x k y k 1 y k x k 1 x k tan ψ p the horizontal component of the los vector r is given by 37 l o s h 2 r h 2 x l o s x 2 y l o s y 2 hence eqs 35 37 define the horizontal los guidance law for pf of straight lines 4 2 vertical los guidance law in the vertical plane the vertical los guidance is similarly defined to obtain the vertical los angle θ l o s the vertical los guidance is illustrated in fig 3 in n d plane and it can be seen that θ l o s is given by 38 θ l o s atan 2 z l o s z x l o s x θ p θ z e θ p tan 1 z e v where θ p tan 1 z p x p can be referred as path pitch angle in ned and v 2 x 2 z 2 can be referred as look above distance for way point following consisting of straight lines θ p is similarly given by 39 z l o s z k x l o s x k z k 1 z k x k 1 x k tan θ p the vertical component of r is given by 40 l o s v 2 r v 2 x l o s x 2 z l o s z 2 therefore eqs 38 40 represent the vertical los guidance law for pf of only straight lines similarly the vertical los guidance law has different equtions for curved paths is tuned in llos and r is tuned in elos the performance and linear stability of elos guidance is provided by park et al 2007 the 3 d illustration of the los pf is provided in fig 4 4 3 selos guidance the switching mechanism of the selos scheme is achieved by the following sigmoid function that acts as a continuous switch which is extended to 3 d from the 2 d case in abdurahman et al 2017b 41 r r m i n 1 2 a e y z r m i n e y z r m i n c e y z r m i n where a 1 is a gain and 1 c 0 is the slope of the sigmoid function at the origin for a 1 and c 0 eq 41 becomes 42 r r m i n if e y z r m i n a e y z if e y z r m i n the guidance law achieved using eq 37 behaves exactly as traditional elos guidance when e y z r m i n and when e y z r m i n r becomes nearly normal to the path providing a perpendicular ψ l o s since the off track error e y z is normal line to the path and r e y z due to a 1 this thus provides a shortest path strategy for path approaching when the vehicle is outside r m i n the tuning of r m i n is discussed in abdurahman et al 2017b where it becomes a lower saturated function of actuators since the lowest turning radius is determined by the actuators if there are no horizontal rudders outside r m i n the perpendicularity of the desired heading to the path can be changed by adjusting a the switching will not produce large jumps when it switches from r m i n to a e y z if a 1 since the vehicle heading is already perpendicular to path when it is about to leave the radius r m i n thus the switching action is only a change from a perpendicular heading to a near perpendicular heading due to a 1 it is required to keep a 1 if shortest path strategy is desired outside r m i n compared to previous modifications of the elos guidance the following advantages of the selos scheme can be summarized from the comparison in abdurahman et al 2017b simple and effective solution to the guidance law for global values of the track error y e provides a ψ l o s perpendicular to the path for applying a shortest path strategy as soon as y e r m i n for quicker path convergence preserves the natural behavior of elos scheme that is good at following curved paths within r m i n and allows the tuning of r m i n to be as small as possible for quicker path convergence without the risk of having no solution to the guidance law when the cross track or off track error is larger than r m i n selos guidance law can also be used for pf of curved paths as long as the curvatures in the path is reasonably smaller than the curvature of the enclosing circle defined by r so that the enclosing circle and path interception has only two solutions in this case as long as y e is available then r can be tuned larger than y e to ensure that the enclosing circle r intercepts the path 4 4 slip angle and course control the slip angle usually refers to the sideslip in the horizontal plane and this is used to form the course angle and the desired heading for course control fossen 2012 the course angle ψ c r s is also given by fossen and pettersen 2014 43 ψ c r s ψ β atan 2 y x this is also the direction of vehicle horizontal speed u h in ned plane or particle heading as described by breivik and fossen 2005 and β atan 2 v u is the vehicle sideslip relative to and expressed in ned course control is now defined by the heading control scheme that produces a desired heading angle that incorporates the sideslip that is lekkas and fossen 2013 44 ψ d ψ l o s β ψ p tan 1 y e h atan 2 v u the sideslip and horizontal course control can now be extended to the vertical plane using the exact steps in a decoupled manner with the definitions of v and e x z in this case the vertical course angle θ c r s and the desired pitch angle θ d for vertical course control are given by 45 θ c r s θ β z atan 2 z x 46 θ d θ l o s β z θ p tan 1 e x z v atan 2 w u where β z atan 2 w u is the vertical slip relative to and expressed in ned definitions of θ c r s β z and consequently θ d are simpler and more intuitive compared to the 3 d course control only reported in lekkas and fossen 2013 in addition the vertical pf problem has been illustrated and defined in more detail here which can graphically show the definition of the vertical slip by the angle between w and u in fig 3 remark 3 note that the vertical slip definition is similar to that of the classic angle of attack α for the vehicle which can be defined using the notations here as α atan 2 w f u f the vertical slip is relative to ned while the vehicle angle of attack is relative to flow where it has been shown that the flow can also incorporate current wave remark 4 the 3 d pf seems to be decoupled into horizontal and vertical guidance laws this is because the 3 d los vector has to be followed separately in the horizontal and vertical planes due to the separation between yaw and pitch dofs by the body frame however since the los reference vector is generated in 3 d which makes it a coupled reference generation a coupled 3 d pf can be achieved when the pitch and yaw heading errors are minimized simultaneously towards the 3 d los reference point by a regulating mechanism 5 stability of los guidance laws for straight path 5 1 horizontal elos guidance law the sges stability of horizontal llos guidance law has been shown by fossen and pettersen 2014 the sges also hold in 4 dof with passively stabilized roll and pitch since the y dynamics y remains the same in the horizontal plane as in eq 9 which is used to derive the cross track error dynamics however since it has been shown in eq 34 that the guidance law has different equation for curved paths previous stability results only hold for straight paths the stability result here looks at elos guidance which has not been shown before similarly the stability analysis is different for curved paths due to the non pythagoras relationship as shown in eq 26 and straight path is considered first the error states relative to ned are defined to describe the track error dynamics as u u d u v v d v w w d w and ψ ψ d ψ the cross track error dynamics y e is commonly given by placing the center of ned on the vehicle projection point x p y p z p on the path and aligning north as the direction of the path so that y becomes y e and that the path euler angles relative to and expressed in ned ϕ p θ p ψ p 0 in this case substituting ψ ψ d ψ into y in eq 9 and rewriting y as y e gives the cross track error dynamics as 47 y e u sin ψ d ψ v cos ψ d ψ when ψ d is tracked such that ψ 0 eq 47 becomes 48 y e u sin ψ d v cos ψ d u 2 v 2 sin ψ d tan 1 v u in phase amplitude form substituting ψ d from eq 44 into eq 48 and using the identity sin tan 1 x x 1 x 2 gives 49 y e u 2 v 2 y e h 2 y e 2 u h y e r h which only holds for straight path when r h h 2 y e 2 theorem 1 horizontal elos guidance law for straight path the horizontal elos guidance law and the sideslip given by eq 44 renders the origin y e 0 of the cross track error dynamics in eq 49 locally exponentially stable les if u h and r h satisfy 0 u h and 0 y e r h and that ψ d is tracked such that ψ 0 proof the cross track dynamics in eq 49 is not time varying since it does not explicitly depend on time and can be completely described by its states as in the general form x f x t for autonomous systems in khalil 2002 and not in the form x f t x for the definition of non autonomous systems note that this is true only when u h is constant such that the system dynamics is the same for all 0 t t where t could be infinity see e g the mass spring system in khalil 2002 is autonomous which is a common analogy to the dynamics of mobile robots thus marine vehicle systems in this paper are autonomous systems stability of the cross track error dynamics 49 is analyzed using the time derivative of lfc v y e 1 2 y e 2 which is 50 v y e u h r h y e 2 k 3 y e 2 0 on the ball b r y e ℝ y e r with 0 k 3 u h r h since u h r h 0 are constant and v y e is negative definite the origin y e 0 of eq 45 is les the stability of elos guidance law cannot be global since y e r h is required for real solutions remark 5 the underactuation in sway can also be incorporated using the speed allocation into the cross track error dynamics by substituting v by v v d v c when v d f 0 in eq 22 however this will still produce a positive speed vector in eq 49 and the new expression for sideslip angle using v v d v c gets canceled out similarly as happened in the derivation of eq 48 thus sway underactuation does not affect the stability of result of the guidance law 5 2 horizontal selos guidance law the horizontal los radius r h can be written for the horizontal selos guidance as 51 r h r h m i n 1 2 a y e r h m i n y e r h m i n c y e r h m i n where r h m i n is the minimum tuning value for r h when c 0 and a 1 eq 51 becomes 52 r h r h m i n if y e r h m i n a y e if y e r h m i n the first case of eq 52 represents the elos guidance law which is proven to provide les above substituting the second case of eq 52 into eq 49 gives 53 y e u h a y e y e u h y e c 2 y e 2 since a 1 and c 0 theorem 2 horizontal selos guidance law for straight path the horizontal selos guidance law and the sideslip given by eq 35 37 and 44 renders the origin y e 0 of the cross track error dynamics 53 sges if u h and c satisfy 0 u h m i n u h and 0 c c m a x and ψ d is tracked such that ψ 0 proof the proof is similar to the approach in fossen and pettersen 2014 pettersen 2017 albeit the system is autonomous here origin of the system in eq 46 is les when y e r h m i n stability of the system 49 is analyzed using the time derivative of lfc v y e 1 2 y e 2 which is 54 v y e u h y e 2 c 2 y e 2 2 b r e v y e 0 for each r e 0 all y e t r e and b r e given by 55 b r e u h m i n c m a x 2 r e 2 first part of eq 54 means y e t y e 0 for all t 0 by invoking the comparison lemma khalil 2002 lemma 3 4 the second part of eq 54 implies y e t e 2 b r e y e 0 for all t 0 thus eq 54 implies that y e t e b r e y e 0 for t 0 and y e 0 y e 0 therefore the origin y e 0 is a sges equilibrium point of eq 53 loria and panteley 2004 definition 2 7 remark 6 if c 0 and a 1 r h m i n y e and this means that only global asymptotic stability gas is achieved for selos outside r h m i n which will result in shorter path convergence time since the vehicle is now traveling perpendicularly to the path however gas is less robust than exponential stability the saturation function in eq 53 resulting from the kinematic representation of the cross track error only allows sges stability for this class of guidance laws fossen and pettersen 2014 a study on stability and robustness properties of sges to perturbations are given in pettersen 2017 5 3 vertical track error dynamics the vertical track error dynamics can also be similarly described by the vehicle kinematics in d direction when the origin of ned is located at vehicle projection point x p y p z p on the path and the directions of ned are aligned with the path euler angles in ned such that ϕ p θ p ψ p 0 the vertical track error dynamics is also analyzed 5 dof since the vertical los guidance has also been formulated in 3 d course control 5 3 1 4 dof the 4 dof vertical track error dynamics z e is given by the relative kinematics z in eq 10 by replacing z with z e which is 56 z e w proposition 1 the origin z e 0 of the 4 dof vertical track error dynamics in eq 56 is gas proof the time derivative of the lfc considered for eq 56 v z 1 2 z e 2 is given by 57 v z z e z e w z e for constant w note that the vehicle can only converge to the path when the vehicle moves in the opposite direction to z e in ned which means that w must be negative in this case changing the sign of w in eq 53 gives v z w z e and hence the origin z e 0 is gas notice that the vertical track error in 4 dof does not require guidance law for convergence any controller that can provide a non zero w can thus stabilize the vertical track error in this 4 dof the sign of w is obtained through the sign of z e for vertical path convergence which is shown in the next section 5 3 2 5 dof the sges of vertical llos guidance is shown in wigg et al 2016 with an integral effect and without vertical slip however slip angles in desired headings for course control cancel out in the stability analysis as in eq 49 and thus the results also hold for non course control without slip angles the vertical elos and selos guidance laws with course control presented in this paper can also guarantee les and sges in 5 dof with pitch control resp this is shown as an example for elos guidance in this section the 5 dof relative kinematics with pitch is given by 58 x u cos ψ cos θ v sin ψ w cos ψ sin θ 59 y u sin ψ cos θ v cos ψ w sin ψ sin θ 60 z u sin θ w cos θ 61 θ q 62 ψ r cos θ the vertical track error dynamics z e in 5 dof is similarly given by the vehicle kinematics for similar choice of the origin and direction of ned on the path thus replacing z e with z and using the error expression θ θ d θ gives 63 z u sin θ d θ w cos θ d θ when θ d is tracked such that θ 0 this becomes 64 z e u sin θ d w cos θ d u 2 w 2 sin θ d tan 1 w u in phase amplitude form where w is reverted as w for the same reason as in proposition 1 substituting θ d from eq 46 into eq 64 and using the identity sin tan 1 x x 1 x 2 gives 65 z e u 2 w 2 z e v 2 z e 2 u v z e r v for straight path when r v v 2 z e 2 and u v u x z u 2 w 2 theorem 3 vertical elos guidance law for straight path the vertical elos guidance law with the vertical slip given by eq 46 renders the origin y e 0 of the vertical track error dynamics 65 les if u v and r v satisfy 0 u v and 0 z e r v and that θ d is tracked such that θ 0 proof stability of the vertical track error dynamics 65 is analyzed using the time derivative of lfc v z e 1 2 z e 2 which is 66 v z e u v r v z e 2 k 4 z e 2 0 on the ball b r z e ℝ z e r v with 0 k 4 u v r v since u v r v 0 are constant and v z e is negative definite the origin z e 0 of eq 61 is les the stability cannot be global since the condition z e r v is required for real solutions the les sges of vertical selos can be achieved using the exact steps used in the horizontal case of theorem 2 and thus is not repeated here 6 underactuated course control with speed allocation in 4 dof the selos guidance with and w o course control and or speed allocation are applied to an auv model using nonlinear controllers in 4 dof with heave control first the system matrices are presented which take the following structure 67 m m 11 0 0 0 0 m 22 0 m 24 0 0 m 33 0 0 m 24 0 m 44 a c ν b f f 0 0 0 c 14 0 0 0 c 24 0 0 0 0 c 14 c 24 0 0 b 68 d ν b f f d i a g d 11 u f d 22 v f d 33 w f d 44 r f the structure of the system matrices in 67 are obtained by assuming that the vehicle is symmetric in port starboard most vehicles are the body frame is located along the center line of the vehicle and that the terms in the center of gravity cg vector y g z g 0 fossen 2011 the sway underactuated system dynamics relative to flow is obtained by expanding relative kinetics in eq 6 as 69 u f 1 m 11 c 14 r f d 11 u f τ u 70 v f 1 m 22 c 24 r f d 22 v f m 24 r f 71 w f 1 m 33 d 33 w f τ w 72 r f 1 m 44 d 44 r f c 14 u f c 24 v f m 24 v f τ ψ where the dynamics in eqs 70 and 73 are coupled with r f and v f due to non zero m 24 which is due to non zero x g in cg however these coupled acceleration terms are negligible at low operating speeds and when x g 0 6 1 control systems and sway dynamics 6 1 1 yaw control the yaw error and its dynamics are defined as and given by ψ ψ d ψ and ψ ψ d r f taking time derivative of ψ and using r r f for irrotational current in ned the 4 dof kinematics and kinetics in eqs 11 and 72 gives 73 ψ ψ d r f ψ d 1 m 44 d 44 r f c 14 u f c 24 v f τ ψ m 24 v f a lyapunov based feedback linearizing controller used for yaw can be derived from eq 69 which is 74 τ ψ d 44 r f c 14 u f c 24 v f m 44 ψ d m 24 v f k ψ ψ where k ψ 0 is design gain by standard lyapunov analysis where the feedback terms cancel out the nonlinear terms in eq 73 it can be easily shown that the equilibrium ψ 0 is ges hence ψ 0 exponentially as t this satisfies the control objective 30 the values for ψ d and ψ d in τ ψ are designed as ψ d k r ψ and ψ d k a ψ where k r k a are positive gains since τ ψ contains ψ d which also contains r and hence τ ψ τ ψ f τ ψ also in order to prevent large ψ d being fed into the controller e g during waypoint switching the following integration is used to generate small increments of ψ d this is given by ψ d ψ k r t s ψ where t s is the integrator sampling time and ψ 0 still implies ψ ψ d remark 7 feedback controllers are are not easy to implement since they require knowledge or estimations of vehicle parameters one reason for using feedback controllers is to achieve ges or at least asymptotic stability as which obviously provides better performance and robustness at the kinetic level the yaw error dynamics in eq 73 shows that feedback terms are necessary to achieve at least as if feedback terms are not available only global stability can be achieved directly using any of the pid type controllers with high gains without as integral action is necessary to achieve zero steady state error for ψ which in turn requires anti windup the stability result of the yaw error dynamics does not affect the stability the guidance laws at the kinematic level but it can reduce the performance and robustness at the kinetic level which it turn can affect the cross tracking performance thus robust speed controllers here can provide a more accurate comparison for the benefits of course control and speed allocation without them reducing the pf performance this is also the reason of assuming the vehicle parameters to be known and using common feedback controllers at this stage to highlight the performance and benefits of using course control and speed allocation under a common condition of kinetic controllers and known vehicle parameters 6 1 2 surge control using time derivative of the relativity relationship in eq 4 current and surge dynamics in eqs 16 and 69 the surge error dynamics is given by 75 u u d u u d u f u c u d 1 m 11 c 14 r f d 11 u f τ u r v x s ψ c ψ c θ c v y c ψ c ψ c θ c the feedback linearizing proportional control law used for surge is given by 76 τ u c 14 r f d 11 u f m 11 u d k u u r f v x s ψ c ψ c θ c v y c ψ c ψ c θ c since r r f and k u 0 is proportional gain the desired surge acceleration u d can be obtained by u d k 1 u where k 1 0 is gain again standard lyapunov analysis can show that the origin u 0 of 75 is ges thus u t 0 as t this achieves control objective 28 6 1 3 heave control using the time derivative of relativity relationship in eq 5 and current and heave dynamics in eqs 18 and 71 the heave error dynamics is given by 77 w w d w w d w f w c w d 1 m 33 d 33 w f τ w r v x c ψ c ψ c ϕ c s θ c c ψ c ψ s ϕ c r v y s ψ c ψ s ϕ c c ψ c ψ s θ c c ϕ c the feedback linearizing controller for heave is given by 78 τ w d 33 w f m 33 w d k w w r v x s ψ c ψ c ϕ c s θ c ψ c ψ s ϕ c r v y s ψ c ψ s ϕ c c ψ c ψ s θ c c ϕ c where k w 0 is proportional gain the desired surge acceleration w d is obtained by w d k 2 w and k 2 0 is gain similarly using standard lyapunov analysis it can be shown that the origin w 0 of eq 77 is ges thus w t 0 as t this achieves control objective eq 29 6 1 4 sway error dynamics the error in uncontrolled sway system under current disturbance can be similarly defined and now can be expressed using speed allocation v d v c from eq 22 when v d f 0 and the relationship of relativity in eq 4 as 79 v v d v v c v v f using time derivative of the relativity relationship in eq 4 current sway and yaw dynamics in eqs 14 66 and 68 the sway error dynamics is given by 80 v v f 1 m 22 m 23 r c 23 r d 22 v f this equation represents a general 3 dof coupled underactuated sway error dynamics at body level relative to ned in the presence of current disturbance it can be seen that sway will drift in the direction of net force resulting in eq 80 without any actuation in sway for marine vehicles it is realistic and common to assumed that the sway dynamics is bounded for bounded input and externtal disturbance e g as in caharija et al 2012 it is shown by breivik 2003 for 2 d surface vehicles that ν b f f ν b n b is bounded for bounded τ a c t ν c n b and those proofs of passivity and boundedness can be shown for any 3 d case using the exact steps therein by assuming neutral buoyancy thus the relative underactuated sway dynamics will be bounded for bounded τ a c t ν c n b the drift in sway is minimized with actuation in surge and yaw when sideslip is taken into account in course control since the sideslip also describes the amount of v by definition and the vehicle is required to steer accordingly to counteract the drift in sway using surge this empathizes the importance of incorporating slip angles in heading control and thus of course control especially when there are current disturbance and sway is underactuated which cause bigger drift remark 8 note that the stability results of surge and sway error dynamics do not affect the stability results of the guidance laws on track error dynamics however the surge and sway velocities have an effect on cross tracking performance and also on course control pf performance through the definition of sideslip 6 2 planar speed assignment existing literature on 3 d pf primarily focus on 3 5 or 6 dof cases e g caharija et al 2012 2016 abdurahman et al 2017b and there are limited publications on 4 dof cases in 4 dof pf with passively stabilized vehicle roll and pitch dofs the dynamic task has to be divided into horizontal and vertical components to produce the respective speeds for u h d and w d such that the vehicle aims to track the los reference point p l o s simultaneously in both planes at a desired total speed u d this can also be referred as a coupled 3 d tracking this competition between the horizontal and vertical planes hasn t been sufficiently addressed in guidance based strategies to the author s best knowledge lekkas and fossen 2013 caharija et al 2016 a coupled design implies that the vehicle is tracking the los reference point in a shortest path strategy and a non coupled design will not result in a shortest path strategy which is not energy efficient this problem can be classified and is conveniently referred here as planar speed assignment the planar speed assignment is achieved by a trajectory generating system that will assign suitable values for u h d and w d using the los look above angle θ r z corresponding to the amount of look above distance r z which is given by 81 θ r z atan 2 z l o s z x l o s x 2 y l o s y 2 atan 2 r z r h the desired speed trajectories u h d and w d are then given by 82 u h d u h d m a x if r z w r h u h w d m a x tan θ r z if r z w r h u h 83 w d sgn e z w d m a x if r z w r h u h u h d m a x tan θ r z if r z w r h u h where u h d m a x w d m a x 0 are the preassigned maximum operating speeds in horizontal and vertical planes of ned and sgn e z helps determine the direction of w d which is reversed since the directions of vertical axes of ned frame and the z axis in software are opposite to each other the idea behind the speed assignment scheme in eq 81 83 is that it compares the expected times of arrival of the vehicle to p l o s in both planes using current speeds u h and w and assigns correct values for u h d and w d so that the vehicle is commanded to arrive at the reference p l o s simultaneously in both planes this is also equivalent to commanding the vehicle to follow the 3 d los vector r in 4 dof which is a simple and effective method for desired speed trajectory generation a slightly different speed allocation system can be similarly derived if there are additional dofs therefore such a speed assignment is a minimum requirement whenever the vehicle aims to simultaneously track a 3 d path in both planes and more advanced designs can be directly built on this strategy the final value for w d will fluctuate between w d m a x during depth keeping which is not good and can cause fluctuations in maintaining constant depth if they are directly fed to the actuators this is similarly avoided at the simplest case by designing w d as increments of the error in heave to added to the current heave speed w which is w d w k 5 w where k 5 is a gain this is also done for u h d where u h d u h k u r u h d u h for a smoother reference signal remark 9 note that in this 4 dof case the los reference generation is still coupled in 3 d and the horizontal and vertical tracking are executed simultaneously through the horizontal guidance law and the speed assigned heave velocity control thus it is also a coupled 3 d tracking therefore it is important for the planar speed assignment technique to regulate the horizontal and the vertical speeds so that the 3 d los reference vector is tracked simultaneously for a coupled pf 6 3 simulation results a 3 d straight line following performance the 4 dof girona 500 auv has been simulated using the selos relative states speed allocation and the new model of the ocean current in matlab the girona 500 is a multi purpose re configurable auv with three torpedo shaped hull design that is mainly used for research where the bottom hull can be replaced with robotic arms or other payloads for different missions the vehicle can be actuated fully in 4 dof with self stabilized roll and pitch and the model parameters of the vehicle are extracted from karras et al 2013 the path consists of straight lines between waypoints given in ned coordinates by w p x 5 18 25 35 40 w p y 10 23 25 35 35 w p z 15 15 6 6 15 the initial ned position vehicle heading and relative velocities are set to η b n n 4 1 1 0 and ν b n b 0 0 0 0 and the maximum desired relative velocities u h d m a x 1 m s and w d m a x 0 6 m s which gives a total maximum speed of u d m a x 1 17 m s in 3 d the current velocities are v x v y 1 2 m s and v z 0 2 m s which give its direction in ned as ϕ c θ c 9 5 o and ψ c 45 o which are constant in ned the guidance and control system gains are set as follows r m i n 1 a 1 01 c 0 001 k r k a k 1 k 2 1 k ψ 10 k d k u k w 55 k 5 k u r 0 2 t s 0 05 acceleration gains k 1 k 2 are usually small and other controller gains are not very high since the nonliniear terms are canceled out by the feedback in addition a radius of acceptance has to be designed in the guidance system to command the vehicle when to switch from the current waypoint ahead to the next waypoint in this regard a horizontal and a vertical radius of acceptance have been set as r a h 0 6 and r a z 0 4 resp so that when the vehicle enters this ball an oval in this case it knows that it has reached the current waypoint these radius are called as radius of acceptance fossen 2011 a smaller radius of acceptance produces less track errors spikes during waypoint switching but they have to be tuned accordingly taking into account mainly the operating speed of the vehicle so that it does not skip the waypoint on initial closing in which can lead to path divergence note that the selos guidance always has a solution despite large cross track errors because r is always tuned greater than the off track error e y z furthermore to achieve a more realistic simulation the control inputs saturate at 400 n in surge and heave and 150 n m in yaw and there is a limit in yaw rate of r m a x 57 3 o s there is also a rise time of 0 2 s for control inputs to rise from 0 to 400 n and 150 n m as the actuation dynamics in surge heave and yaw resp these actuator saturation and rise time can considerably affect the pf performance and they are not reported in many simulation or experimental works in the simulations the body velocities relative to and expressed in flow ν b f f are updated from zero initial values by integrating ν b f f which is obtained from the relative vehicle dynamics in eq 6 when the model parameters are known the body velocities relative to ned and expressed in body ν b n b are then obtained by using the updated relationship of relativity in eq 4 from the known current velocity in body that is rotated from the known current velocities in ned the vehicle starts from a distance away from the 1st waypoint and the pf performance with and w o current disturbances and or measurement noise are shown in fig 6 it can be seen that the vehicle can also accurately follow the path in all cases with some fluctuation when there are measurement noise the measurement noises are not filtered and in practice there will be some filter to smooth out the noise which makes the actual fluctuation smaller note that considering an underactuated vehicle in sway the current disturbance rejection is significant at 121 v c 1 21 u d m a x which is much higher than existing current disturbance rejections in the literature especially with saturation and rise time in actuation e g caharija et al 2012 2016 the vehicle is seen being drifted away in the horizontal plane initially this is due to the zero initial vehicle velocity and initial heading error hence the vehicle drift is reduced when it has gained some velocity and less heading error this initial drift is intuitively more dominant in sway underactuated case and if there is actuation in sway the drift will be smaller especially if the current in sway v c can be counteracted by some design of v d now allowed through the speed allocation note that compared to a constant and irrotational current a time varying and rotational current is equal to only increasing the intensity of the current in each dofs with nonzero v c and current euler rates thus in general the current disturbance can be increased even further or made time varying and rotational to demonstrate the intuitive fact that with sufficient amount of actuation the vehicle can always reject sufficient amount of disturbance i e the amount of environmental disturbances that can be overcome mainly depend on the amount and dynamics of input actuation this can be shown using the relative equations of motion which completely incorporate all the environmental disturbance from fluid flow which in turn includes the current and or wave disturbance through the updated relationship of relativity in eq 5 figs 6 and 7 show the velocity tracking profiles for pf with and w o current disturbance which shows good tracking of the desired states they both show that the horizontal velocity is reduced during diving through the planar speed assignment design for a coupled tracking in 3 d in fig 6 the sway velocity is actually negligible when there is no current disturbance as commonly assumed in many works fig 7 also shows that the unactuated sway velocity v sways along with the current in sway v c to align the course angle with the desired heading in course control the slight fluctuations in surge speed is due to input actuation rise time this is actually smaller than it seems in the figure since the time axis is long at about 90 s figs 8 and 9 show that the desired heading angle and track errors are also tracked accurately and kept at minimum especially in the case w o current disturbance the spikes in the off track error are during waypoint switching and the sign changes in its representation fig 9 shows that there is a large heading error initially which is due to slow initial speed limited actuation and saturation in yaw the steep changes in heading error is due to shifts in the quadrants that occurred care is required when dealing with heading angles greater smaller than 2 π 2 π and most studies do not consider all four quadrants this is the reason of using a reference signal generator for yaw and thus the actual error fed back to the controller is only in small increments as designed in the previous section in addition this error will be nonlinearly smaller for decreased current disturbance and a near worst case scenario is demonstrated for the magnitude of current disturbance figs 10 and 11 show the control input forces and moments during pf w and w o current disturbances where it can be seen that yaw input is only needed during waypoint switching when there is no disturbance note that similarly some chattering is present in the figures but these are actually smaller since the time axis is long 6 3 1 pf w and w o speed allocation and or course control further simulations are carried out to highlight the effectiveness of course control and speed allocation in disturbance rejection the waypoints initial conditions guidance and control system gains are exactly the as in the previous section the 3 d current is v x v y 0 3 m s and v z 0 1 m s which gives its intensity and heading at v c 0 66 m s and ϕ c θ c 18 4 o p s i c 45 o the pf performance of the vehicle w and w o course control crc and or speed allocation sa are shown in fig 12 the desired heading angle w o sideslip is given by ψ d ψ l o s and the desired surge speed w o speed allocation is as commonly given by u d u h d the desired heading and speed are well tracked by the controllers and thus only track errors are shown here it can be seen that the pf performance is worst when there are no speed allocation or course control where it also takes much longer to complete the waypoints and as expected it is best when there are both speed allocation and course control also with quicker path completion time see that the main advantage of speed allocation is reduction in oscillation and path completion time in both cases in addition only course control alone can hugely reduce the cross track error even w o speed allocation this again shows that course control is a very effective and simple method for disturbance rejection 7 conclusion this paper presented the pf performance and stability analysis of 3 d selos guidance system using course control and speed allocation along with a model of 3 d ocean current the new current model updated relationship of relativity and the definitions and illustrations of the track errors in ned have provided a more complete formulation of the 3 d pf problem under ocean current and or wave disturbances the course control and speed allocation problems have been further studied and their effectiveness in disturbance rejection without introducing complexity has been demonstrated with actuator dynamics and saturation these two strategies are very attractive in pf systems under disturbance rejection future research will include experimental studies pf under time varying and rotational current and or wave disturbances stability in curved paths and fully actuated pf considering the design freedom offered by the speed allocation nevertheless the results in this paper together with the new model of the ocean current and 3 d pf problem offer powerful and cost effective preliminary simulation studies before experimental implementations appendix a supplementary data the following is the supplementary data to this article multimedia component 1 multimedia component 1 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j oceaneng 2019 04 021 
22809,this paper presents an application and stability result of a modified line of sight los guidance law for 3 d path following pf of an unmanned underactuated underwater vehicle subject to environmental disturbances the pf problem is solved using a revised relative system model with an improved flow frame and a complete model of ocean current wave disturbances the pf approach uses course control and speed allocation which is the problem of allocating the desired inertial total speed into desired body velocities including current wave velocities the definitions of track errors in the general pf problem have been accurately illustrated in the inertial frame the course control strategy defined by incorporating the slip angles into the desired heading angles has been extended to vertical plane with the new definition of vertical slip stability results include local exponential stability les of the enclosure based los elos and semi global exponential stability sges of the modified los guidance laws the 3 d los vector is tracked simultaneously in both planes using a planar speed assignment strategy in 4 dof for a coupled 3 d tracking simulation results show robust pf performance of a sway underactuated auv in course control in the presence of significant ocean current disturbances and measurement noises the effectiveness of simple course control and speed allocation in disturbance rejection has also been illustrated keywords marine guidance and control line of sight path following kinematics ocean currents underwater vehicles 1 introduction the primary applications of unmanned underwater vehicles e g pipeline tracking and surveying require accurate and efficient execution of path following pf tasks underwater vehicles with autonomous capabilities such as autonomous underwater vehicles auv also allow for execution of tasks that are costly and dangerous for humans the pf task can be solved without any time constraints on the path unlike trajectory tracking tt as a maneuvering problem using guidance laws breivik and fossen 2005 fossen 2011 pf also has the potential to provide smoother convergence properties and decreased actuator activity aguiar and hespanha 2007 compared to tt this makes pf a simpler more flexible and robust and thus a better choice over tt accurate modeling of underwater vehicle dynamics is not trivial caccia et al 2000 and pf under parametric uncertainties is treated in aguiar and hespanha 2007 for design of pf controllers the line of sight los guidance is a popular choice because of its simplicity and good path convergence properties fossen et al 2003 breivik and fossen 2009 lekkas and fossen 2013 nevertheless in the presence of external disturbances such as ocean currents and waves pf performance can be severely affected if these disturbances are not taken into account in the design this is usually due to the difficulty in achieving accurate estimates of the sideslip caused by sway motion where the performance is more degraded if sway dof is underactuated lekkas and fossen 2014 however most of the existing auvs are torpedo shaped and thus underactuated since this provides energy efficiency and robustness through general design simplicity caharija et al 2012 the sideslip is a measure of sway motion relative to surge and it is difficult to accurately estimate the sideslip because of the difficulty in achieving accurate hydrodynamic models and noises in accelerometers or even global positioning systems lu et al 2016 thus estimation and incorporation of the sideslip angle is important in pf under disturbances there are adaptive approaches aplied to estimating the sideslip angle in fossen and lekkas 2014 lu et al 2016 the sideslip angle has been treated as a bias and estimated using adaptive laws in lu et al 2017 a reduced order extended state observer has been employed to identify a time varying sideslip nevertheless the integral los ilos design have become a more common approach to deal with sideways drift caused by unknown ocean currents børhaug et al 2008 breivik and fossen 2009 caharija et al 2012 2016 wigg et al 2016 where caharija et al 2016 further provides experimental results the approach most of these works apply in dealing with disturbances is to steer vehicle heading towards a desired non zero steady state heading angle with respect to the path heading so that the vehicle is allowed to slide side ways to stay on the path during a drift this concept is achieved through feeding back the sideslip angle to the desired heading angle that now incorporates the drift in sway this is conveniently referred in this paper as course control which can achieve the same objective of reducing the drift in a simpler and effective manner and is further studied course control essentially controls the actual displacement of the vehicle since it controls the direction of the total inertial speed by incorporating the sideways drift through sideslip angle instead of only controlling the vehicle heading i e non course control while the definition of coruse angle with sideslip is not new e g fossen 2011 fossen and pettersen 2014 course control with side slip is only first published by lekkas and fossen 2013 in 3 d and subsequently reported by lekkas and fossen 2014 fossen and lekkas 2015 and abdurahman et al 2017b a for pf in 2 d where its capability in current disturbance rejection are shown 3 d course control is only discussed in lekkas and fossen 2014 where it requires the definition of vertical slip in the vertical plane in sway underactuated cases it is important to analyze the behavior of the uncontrolled sway dynamics especially when there are environmental disturbances since the vehicle motion is coupled the sway motion relative to an inertial frame is usually negligible and the desired surge velocity is made equal to the desired total speed both relative to the inertial frame see e g caharija et al 2012 2016 this is referred here as the speed allocation problem of allocating a single desired total speed in an inertial frame to desired speeds at the body frame and its unique structure has been formulated first in abdurahman et al 2017b which provides a design of desired surge velocity that can incorporate the current disturbance the effectiveness of speed allocation in current drift reduction has been shown in both abdurahman et al 2017b a and is further studied and extended to 3 d case in this paper the los pf is achieved through tracking a reference point on the path and the los guidance has two steering schemes the lookahead based los llos and the enclosure based los elos guidance fossen 2011 the llos scheme is computationally simpler than elos scheme since the later requires solving a set of two equations online to find a circle path interception for computing the los angle ψ l o s however a fixed lookahead distance provided by traditional llos scheme is not an optimal solution to path following that a small will achieve faster path convergence but may produce overshoot and oscillations while a large can eliminate these problems but results in slower path convergence lekkas and fossen 2013 the trade off that has been sought in the literature e g lekkas and fossen 2012 is provided naturally with the elos scheme where it inherently employs a time varying look ahead distance that provides a perpendicular heading near the edge of the radius r and thus a faster path convergence while changing the heading towards a path parallel direction as the vehicle comes closer to the path thus eliminating the overshoot and oscillation this presents an inherent advantage of the elos scheme is that it provides a varying lookahead distance which is most likely the reason why it performs better when it involves following curved paths see comparison of carrot chasing and the nonlinear guidance law in sujit et al 2014 however the tuning radius and los vector r is conventionally fixed and it is critical for r to be greater than the cross track error y e so that the enclosing circle is bigger than the distance from the vehicle to the path and thus the circle path interceptions exist if not other guidance laws are required to guide the vehicle towards the path which was also an implementation issue sujit et al 2014 it was shown in abdurahman et al 2017b that the switching mechanism has been shown to be simpler and more effective than two other such modifications on elos guidance the switching enclosure based los selos guidance always ensures the existence of circle path interceptions a comparison of selos guidance law to llos and the vector field guidance laws has also been carried out using course control in abdurahman et al 2017a at the kinetic level which shows their advantages and disadvantages and that there is no clear winner among them in terms of providing both low control effort and low cross track error the selos scheme in abdurahman et al 2017b is extended to 3 d in this work the vertical course control problem has also been formulated with an illustrated definition of the vertical slip compared to the only existing vertical slip or vertical sideslip angle as presented in lekkas and fossen 2013 without illustration in addition more detailed illustrations of the los pf problem have been shown in both horizontal and vertical planes where the definitions of the track errors are also provided using inertial coordinates which have not been done so in existing literature see e g latest illustrations in fossen and pettersen 2014 caharija et al 2016 stability results of los guidance laws in the literature are limitted only to the llos scheme and to straight paths semi global exponential stability sges of llos guidance law has been provided by fossen and pettersen 2014 stability of llos in the vertical plane has been shown by wigg et al 2016 albeit with integral action in this regard local exponential stability les and sges results of the elos and selos guidance laws are provided for straight paths moreover the difference between the cross track error dynamics for straight and curved paths is highlighted incorporation of the ocean current and wave in the relative equations of motion are presented in fossen 2012 and subsequent studies dealing with disturbance also rely on this model e g caharija et al 2016 it should be noted that this model however does not provide the definitions of the current angle of attack α c and current roll angle and thus may not be suitable in 3 d simulations a new model of the constant slowly varying and irrotational ocean current has also been presented and implemented in the pf task which is more easy to follow and complete with definitions of the current euler angles in 3 d and can also be used to represent wave disturbances incorporation of this current and or wave disturbance into the relative equations of motion requires an improved understanding of the flow reference frame which is also provided in this paper with a better understanding reference frames the main contributions of this paper compared to previous works can be summarized as follows 1 a new and complete model of the 3 d ocean current incorporating ocean waves and extension of the selos guidance law with speed allocation and a coupled planar speed assignment technique for a 3 d coupled pf in 4 dof have been presented the ocean current modeling approach includes more accurate expressions of motion states relative to the fluid flow frame in relative system dynamics and general coordinate transformations these lead to more accurate pf control designs and simulations of environmental disturbances in general the benefits of speed allocation in disturbance rejection and energy efficiency when combined with course control has also been demonstrated 2 improved formulation of the 3 d pf problem with more accurate definitions and illustrations of the relevant vectors track errors and path euler angles in inertial reference frames are presented this includes the formulation of vertical guidance law for vertical pitch course control with the definition of vertical slip angle for simpler and better disturbance rejection in the vertical plane the benefit of course control in significant disturbance rejection has also been illustrated 3 les and sges stability results of the horizontal vertical elos and horizontal selos guidance laws for straight path the paper is organized as follows a 5 dof relative system model with the improved flow and the new current reference frames are presented in section 2 along with the model of the ocean current section 3 presents the pf problem with control objective speed allocation and definitions of the revised track errors the horizontal and vertical los course control with slip angels are given in section 4 section 5 presents the stability results the control systems uncontrolled sway dynamics simulation results using a dynamic 4 dof auv model in waypoint following scenario with disturbances and measurement noises are presented in section 6 finally a conclusion is given in section 7 2 relative system model 2 1 relative system model the relative equations of motion for uvs are conventionally given by the 6 dof nonlinear model of fossen 2011 2012 based on newton euler formulation where the 5 dof model can be extracted as 1 η b n n j θ b n n ν b f v c l n n 0 0 t 2 m ν b f c ν b f ν b f d ν b f ν b f g θ b n n τ the three index convention from fossen 2011 is used here to represent the vectors which is beneficial in describing relativity this convention emphasises a distinction between relative to and expressed in first distingiushed by encarnação and pascoal 2000 the index convention are read as e g η b n n is the vehicle body position and euler angles relative to the inertial frame north east down ned and expressed in ned it follows that ν b f is the vehicle body velocities and euler rates relative to the fluid frame flow v c l n n is the linear velocities of ocean current relative to and expressed in ned j θ b n n is the transformation matrix from ned to body with θ b n n ϕ θ ψ t being the vehicle euler angles relative to and expressed in ned with right hand convention m is the mass inertia matrix including rigid body and added mass c ν b f is the matrix of coriolis and centripetal forces and moments d ν b f is the damping matrix including linear and nonlinear damping terms g θ b n n is the vector of gravitational and restoring forces and moments and the control input vector τ consists of input and disturbance forces and moments the ned frame is defined by x n y n z n with a chosen reference point on the surface of the earth as its center and north east and down as positive directions with right hand convention the relationship between the vehicle velocity relative to the fluid was first published by caccia et al 2000 which is subsequently given by børhaug et al 2008 fossen 2011 caharija et al 2016 as 3 ν b f ν b n b ν c n b where ν b n b is the vehicle body velocities and euler rates relative to ned expressed in body and ν c n b is the ocean current velocity and euler rates relative to ned expressed in body now it can be seen that it has not been made clear in which reference frame ν b f is expressed in this requires further understanding of the flow reference frame and how it is defined the effective volume of ambient fluid motion around the vehicle can be described by the flow frame f x f y f z f with a center of flow cf coinciding with the co of body the flow frame is defined by fossen 2011 2012 as being aligned with body but here it is defined as opposite to body similar to that in ross 2008 one of the reasons is that it is preferred from the perspective of newton s 3rd law in this case ν b f can now be expressed in the flow frame i e ν b f ν b f f and the relationship of relativity in eq 3 becomes 4 ν b f f ν b n b ν c n b when there is no current ν c n b 0 and consequently ν b f f ν b n b this means that despite both ν b f f and ν b n b having the same sign they are opposite to each other because ν b f f is expressed in flow and ν b n b is expressed in body where flow and body are 180 o out of phase from each other this is further illustrated through fig 1 for 3 different motion scenarios in surge thus the signs of the states depend on which reference frame they are being expressed in when roll and pitch are passively stabilized i e when ϕ θ 0 the 4 dof relative dynamics can be rewritten as 5 η b n n j θ b n n ν b n b 6 m ν b f f c ν b f f ν b f f d ν b f f ν b f f g θ b n n bf with eq 4 describing the updated relationship of relativity at body level now η b n n x y z ψ is the inertial velocities and yaw rate relative to and expressed in ned ν b n b u v w r t is the body velocities in surge sway and heave and yaw rate relative to ned and expressed in body ν c n b u c v c w c r c t is the ocean current linear velocities and yaw rate relative to ned and expressed in body ν b f f u f v f w f r f t is the body velocities in surge sway and heave and yaw rate relative to and expressed in flow and g θ b n n 0 0 0 0 t under the assumption of neutral buoyancy the control input vector m 1 bf τ u 0 τ w τ ψ t consists of surge heave forces and yaw moment where f is the actuator input vector and b is the actuator configuration matrix this structure of the control input vector is obtained by assuming that origin b of body is positioned in the pivot point such that yaw moment has no effect on sway motion which was first shown by fredriksen and pettersen 2006 the system in eq 6 is underactuated in sway since the dimension of f is less than that of the system the 4 dof transformation matrix without roll and pitch dof is given by 7 j θ b n n r θ b n n 0 3 1 0 1 3 1 expanding this yields the 4 dof kinematics as 8 x u cos ψ v sin ψ 9 y u sin ψ v cos ψ 10 z w 11 ψ r 2 2 ocean current model the ocean current is conventionally described by the old flow frame by fossen 2012 using the current heading and a current angle of attack while the definition of current heading in the inertial frame β c is intuitive fossen and lekkas 2015 the definition of the current angle of attack α c is not given plus more justification could be provided for the principal transformation approach used in fossen 2012 in this paper a new current reference frame is used to fully describe the ocean current in ned the idea here is to treat the ocean current wave as a separate object by having its own reference frame the current frame c x c describing a volume of ocean current relative to ned with a chosen center of current cc and x c as its direction of stream the ocean current is not a rigid body but its directions as those of the 3 d current intensity vector v c can be described by its euler angles relative to and expressed in ned which are denoted as θ c n n ϕ c θ c ψ c t the linear components of constant and irrotational current in ned in 4 dof are defined by v c n n v x v y v z v ψ t where the current intensity given by v c v x 2 v y 2 v z 2 u c 2 v c 2 w c 2 is bounded and v ψ 0 for irrotational current in ned the current euler angles can now be defined as ϕ c θ c ψ c a t a n 2 v z v y a t a n 2 v z v x a t a n 2 v y v x these euler angles exist since v x v y v z are measurable in practice note that the entire volume of the current stream is assumed to be in uniform motion as the cc so that the vehicle experiences the same forces across all projecting areas in given direction of current for constant current in ned v c n n 0 with current euler angles the v c n n can now be easily rotated to body from ned using the transpose of body to ned transformation matrix which is 12 ν c n b u c v c w c r c t j θ c n n θ b n n t v c n n this expands to 13 u c v x c ψ c ψ c θ c v y s ψ c ψ c θ c v z s θ c 14 v c v x c ψ c ψ s θ c s ϕ c s ψ c ψ c ϕ c v y c ψ c ψ c ϕ c s ψ c ψ s θ c s ϕ c v z c θ c s ϕ c 15 w c v x s ψ c ψ s ϕ c c ψ c ψ c ϕ c s θ c v y s ψ c ψ s θ c c ϕ c c ψ c ψ s ϕ c v z c θ c c ϕ c since ϕ θ 0 in vehicle 4 dof s c denote sine and cosine and r c 0 the rotation θ c n n θ b n n is logical because both θ c n n and θ b n n are expressed in the same ned frame θ c n n θ b n n means that the angles used for decomposing v c n n into ν b n b are the angular difference between them and the transpose of transformation matrix j then rotates the linear current components in ned to body this is also an easier to follow and more intuitive insight into general coordinate transformations the dynamics of the current in body is simply obtained by time differentiating eq 12 16 u c r v x s ψ c ψ c θ c v y c ψ c ψ c θ c 17 v c r v x s ψ c ψ s θ c s ϕ c c ψ c ψ c ϕ c r v y c ψ c ψ s θ c s ϕ c s ψ c ψ c ϕ c 18 w c r v x c ψ c ψ s ϕ c s ψ c ψ c ϕ c s θ c r v y s ψ c ψ s ϕ c c ψ c ψ s θ c c ϕ c since v c 0 and the current euler rates θ c n n 0 for irrotational current relative to ned remark 1 the previous flow frame in fossen 2012 is used to describe the ocean current the ocean current here is described by both the improved flow and a current frame complete with the definition of the current euler angles compared to previous works this approach of representing fluids by their own reference frame is naturally also applicable to aerospace applications for modeling and incorporating 3 d wind disturbances the flow frame in fossen 2011 corresponded to the wind frame in aerospace while the current frame here can correspond to a wind frame that can be similarly defined to describe the motion of a uniform volume of air relative to ned where the role of the new flow frame remains the same note that the flow frame not only describes the fluid motion caused by the ocean current but also the fluid motion in the absence of ocean current i e the fluid motion caused due to vehicle motion relative to flow since ocean currents and waves are both fluid motion the current frame can also be used to describe ocean waves through ν c n n and thus the current disturbance can also be referred as current and or wave disturbances remark 2 note that ν b n b is also referred as absolute velocity in many works e g in fossen 2012 this may not contribute to better understanding of the problem in general since motion is always relative to a reference point frame this can also be seen from the relationship of relativity in eqs 3 and 4 that all the vectors here are either relative to ned or flow 3 control objective the path following problem is solved as a maneuvering problem breivik and fossen 2005 where a geometric and a dynamic task are solved the geometric task can be defined as minimizing the 3 d off track error the normal distance from the vehicle to the path in 4 dof case without pitch and roll this can be achieved in a cascaded manner by solving a dynamic task that requires the vehicle heading ψ the horizontal speed u h u 2 v 2 in ned and heave speed w to track the desired heading angle ψ d the desired horizontal speed u h d u d 2 v d 2 in ned and the desired heave speed w d relative to ned and expressed in body resp u d and v d and are the desired body speeds relative to ned expressed in body 3 1 speed allocation the desired horizontal speed u h d 0 is required to be allocated to u d and v d there is no solution to this problem in the literature and usually u d u h d when the sway motion is assumed negligible e g fossen 2011 caharija et al 2016 in børhaug et al 2008 u d is solved as u d sin u h d under the same assumption this problem will be referred as the speed allocation problem here and more generally this can also describe the problem of transforming speeds between body fixed and inertial reference frames the unique formulation of the speed allocation is first published in abdurahman et al 2017b in 2 d which can be extended to 3 d using the three index notation convention used in this paper the 3 d speed allocation is given by 19 u d u d 2 v d 2 w d 2 20 u h d u d 2 v d 2 21 u d u d f u c 22 v d v d f v c 23 w d w d f w c where u d is the desired total speed ν d b n b u d v d w d r d t is the desired body velocities and euler rate in surge sway heave and yaw relative to ned and expressed in body ν d b f f u d f v d f w d f r d f t is the desired body velocities and euler rate in surge sway heave and yaw relative to and expressed in flow eq 19 23 represent the structure for the speed allocation problem it can be seen that the formulation of eqs 21 23 is analogous to the relationship of relativity in eq 4 where the actual states become the desired states this can also be naturally extended to design desired angular velocities if the current is rotational in ned the speed allocation can now incorporate the amount of actuation desired in each dof by setting scalar values or 0 for ν d f since they are the vehicle speed relative to flow in sway underactuated case here v d f can be set to zero in eq 22 to yield v d v c which gives the solution to u d f from eq 20 as 24 u d u h d 2 v d 2 u h d 2 v c 2 and u h d is pre assigned notice that the vehicle surge is designed to slow down in 24 if there is a large sway current v c this is beneficial only in course control and is explained in the next section notice also that for successful path following under current wave disturbances if sway dof is not actuated such that u d is given by eq 24 it is required that u h d v c to avoid imaginary solutions for u d 3 2 track errors and control objective 3 2 1 track errors the horizontal and vertical track errors are usually defined in the path p frame and their definition in inertial coordinates are not provided in the literature e g in børhaug et al 2008 fossen and pettersen 2014 caharija et al 2016 abdurahman et al 2017b an improved illustrations of the track errors are presented here first with the definitions of the cross track along track and off track errors in ned for general pf problem the along track cross track and vertical track or vertical cross track as referred in lekkas and fossen 2013 errors x e y e and z e are commonly the normal distances from the path to the vehicle in 2 d x e and y e are shown in fig 2 which is an updated version of that in fossen and pettersen 2014 in n e plane it can now be seen that the along track error x e becomes the curved length of the path between points x p y p and x l o s y l o s in curved path which is then equivalent to horizontal look ahead distance h if this segment is a straight line the cross track error y e can now be defined in ned by the following coordinates from fig 2 as 25 y e x x p 2 y y p 2 e x 2 e y 2 it can also be given by the cosine rule as 26 l o s h y e 2 h 2 2 y e h cos θ r h where θ r h can be referred as the look ahead angle between h and y e these show that the coordinate transformations as in fossen 2011 lekkas and fossen 2013 are not necessary to define x e and y e if the coordinates are already in ned frame equation 26 is for the general case pf with straight and curved paths when following a straight path θ r h is a right angle and thus l o s h y e 2 h 2 the vertical track error z e can similarly be defined as 27 z e x x p 2 z z p 2 e x 2 e z 2 the 3 d normal distance from the path is then given by the off track error e y z which can now be defined by the pythagoras relationship between the cross track and vertical track errors y e and z e as e y z y e 2 z e 2 therefore in 3 d the geometric task can also be alternatively set as minimizing e y z which means the vehicle is on the path in 3 d note that the definitions of the track errors in eqs 25 27 are positive as results of distance equations their signs in ned can be separately assigned the origin of ned can be set at the point of vehicle normal projection on the path x p y p z p which moves along as the vehicle moves and the direction of north as the direction of the path in this case y e is positive negative if the vehicle is on right left hand side of the path and z e is positive negative if the vehicle is below above the path according to the right hand convention of ned having the track errors defined the control objectives in sway underactuated 4 dof pf are formulated as 28 lim t u t u d t 29 lim t w t w d t 30 lim t ψ t ψ d t 31 lim t y e t 0 32 lim t z e t 0 z e and e y z are depicted in figs 3 and 4 the pf problem becomes course control when the desired heading ψ d includes the sideslip to compensate for the drift in vehicle sway see fig 5 note that when following curved paths the curvature of the path has to be smaller than the curvature of the enclosing radius r so that the solution of y e is unique fossen and pettersen 2014 4 3 d selos guidance and course control 4 1 horizontal los guidance law the elos guidance creates an enclosing circle around the vehicle in 2 d fossen et al 2003 in 3 d it can similarly create an enclosing sphere with los vector radius r centered at vehicle ned position and use one of the sphere path interceptions as the reference point p l o s x l o s y l o s z l o s to calculate ψ l o s for designing ψ d the equation for the sphere is given by 33 x l o s x 2 y l o s y 2 z l o s z 2 l o s 2 r 2 which can be used with the equations of the 3 d line formed between two way points p k and p k 1 or p k and p k 1 once p l o s is solved the horizontal reference heading is given by ψ l o s as 34 ψ l o s atan 2 y l o s y x l o s x p i 2 θ h θ x p p i 2 cos 1 l o s h 2 y e h 2 2 l o s h y e tan 1 x x p y y p using the cosine law note that the second equality in eq 34 is only applicable for this specific los reference p l o s in fig 2 of curved pf other equations can be similarly derived for different cases thus conventional definitions of the los angles are only applicable to straight lines e g fossen and pettersen 2014 caharija et al 2016 when following a straight path from fig 2 ψ l o s is given by 35 ψ l o s atan 2 y l o s y x l o s x ψ p ψ y e ψ p tan 1 y e h which is the conventional los guidance law for straight path the path heading ψ p tan 1 y p x p when the path is series of way points consisting of only straight lines ψ p is given by 36 y l o s y k x l o s x k y k 1 y k x k 1 x k tan ψ p the horizontal component of the los vector r is given by 37 l o s h 2 r h 2 x l o s x 2 y l o s y 2 hence eqs 35 37 define the horizontal los guidance law for pf of straight lines 4 2 vertical los guidance law in the vertical plane the vertical los guidance is similarly defined to obtain the vertical los angle θ l o s the vertical los guidance is illustrated in fig 3 in n d plane and it can be seen that θ l o s is given by 38 θ l o s atan 2 z l o s z x l o s x θ p θ z e θ p tan 1 z e v where θ p tan 1 z p x p can be referred as path pitch angle in ned and v 2 x 2 z 2 can be referred as look above distance for way point following consisting of straight lines θ p is similarly given by 39 z l o s z k x l o s x k z k 1 z k x k 1 x k tan θ p the vertical component of r is given by 40 l o s v 2 r v 2 x l o s x 2 z l o s z 2 therefore eqs 38 40 represent the vertical los guidance law for pf of only straight lines similarly the vertical los guidance law has different equtions for curved paths is tuned in llos and r is tuned in elos the performance and linear stability of elos guidance is provided by park et al 2007 the 3 d illustration of the los pf is provided in fig 4 4 3 selos guidance the switching mechanism of the selos scheme is achieved by the following sigmoid function that acts as a continuous switch which is extended to 3 d from the 2 d case in abdurahman et al 2017b 41 r r m i n 1 2 a e y z r m i n e y z r m i n c e y z r m i n where a 1 is a gain and 1 c 0 is the slope of the sigmoid function at the origin for a 1 and c 0 eq 41 becomes 42 r r m i n if e y z r m i n a e y z if e y z r m i n the guidance law achieved using eq 37 behaves exactly as traditional elos guidance when e y z r m i n and when e y z r m i n r becomes nearly normal to the path providing a perpendicular ψ l o s since the off track error e y z is normal line to the path and r e y z due to a 1 this thus provides a shortest path strategy for path approaching when the vehicle is outside r m i n the tuning of r m i n is discussed in abdurahman et al 2017b where it becomes a lower saturated function of actuators since the lowest turning radius is determined by the actuators if there are no horizontal rudders outside r m i n the perpendicularity of the desired heading to the path can be changed by adjusting a the switching will not produce large jumps when it switches from r m i n to a e y z if a 1 since the vehicle heading is already perpendicular to path when it is about to leave the radius r m i n thus the switching action is only a change from a perpendicular heading to a near perpendicular heading due to a 1 it is required to keep a 1 if shortest path strategy is desired outside r m i n compared to previous modifications of the elos guidance the following advantages of the selos scheme can be summarized from the comparison in abdurahman et al 2017b simple and effective solution to the guidance law for global values of the track error y e provides a ψ l o s perpendicular to the path for applying a shortest path strategy as soon as y e r m i n for quicker path convergence preserves the natural behavior of elos scheme that is good at following curved paths within r m i n and allows the tuning of r m i n to be as small as possible for quicker path convergence without the risk of having no solution to the guidance law when the cross track or off track error is larger than r m i n selos guidance law can also be used for pf of curved paths as long as the curvatures in the path is reasonably smaller than the curvature of the enclosing circle defined by r so that the enclosing circle and path interception has only two solutions in this case as long as y e is available then r can be tuned larger than y e to ensure that the enclosing circle r intercepts the path 4 4 slip angle and course control the slip angle usually refers to the sideslip in the horizontal plane and this is used to form the course angle and the desired heading for course control fossen 2012 the course angle ψ c r s is also given by fossen and pettersen 2014 43 ψ c r s ψ β atan 2 y x this is also the direction of vehicle horizontal speed u h in ned plane or particle heading as described by breivik and fossen 2005 and β atan 2 v u is the vehicle sideslip relative to and expressed in ned course control is now defined by the heading control scheme that produces a desired heading angle that incorporates the sideslip that is lekkas and fossen 2013 44 ψ d ψ l o s β ψ p tan 1 y e h atan 2 v u the sideslip and horizontal course control can now be extended to the vertical plane using the exact steps in a decoupled manner with the definitions of v and e x z in this case the vertical course angle θ c r s and the desired pitch angle θ d for vertical course control are given by 45 θ c r s θ β z atan 2 z x 46 θ d θ l o s β z θ p tan 1 e x z v atan 2 w u where β z atan 2 w u is the vertical slip relative to and expressed in ned definitions of θ c r s β z and consequently θ d are simpler and more intuitive compared to the 3 d course control only reported in lekkas and fossen 2013 in addition the vertical pf problem has been illustrated and defined in more detail here which can graphically show the definition of the vertical slip by the angle between w and u in fig 3 remark 3 note that the vertical slip definition is similar to that of the classic angle of attack α for the vehicle which can be defined using the notations here as α atan 2 w f u f the vertical slip is relative to ned while the vehicle angle of attack is relative to flow where it has been shown that the flow can also incorporate current wave remark 4 the 3 d pf seems to be decoupled into horizontal and vertical guidance laws this is because the 3 d los vector has to be followed separately in the horizontal and vertical planes due to the separation between yaw and pitch dofs by the body frame however since the los reference vector is generated in 3 d which makes it a coupled reference generation a coupled 3 d pf can be achieved when the pitch and yaw heading errors are minimized simultaneously towards the 3 d los reference point by a regulating mechanism 5 stability of los guidance laws for straight path 5 1 horizontal elos guidance law the sges stability of horizontal llos guidance law has been shown by fossen and pettersen 2014 the sges also hold in 4 dof with passively stabilized roll and pitch since the y dynamics y remains the same in the horizontal plane as in eq 9 which is used to derive the cross track error dynamics however since it has been shown in eq 34 that the guidance law has different equation for curved paths previous stability results only hold for straight paths the stability result here looks at elos guidance which has not been shown before similarly the stability analysis is different for curved paths due to the non pythagoras relationship as shown in eq 26 and straight path is considered first the error states relative to ned are defined to describe the track error dynamics as u u d u v v d v w w d w and ψ ψ d ψ the cross track error dynamics y e is commonly given by placing the center of ned on the vehicle projection point x p y p z p on the path and aligning north as the direction of the path so that y becomes y e and that the path euler angles relative to and expressed in ned ϕ p θ p ψ p 0 in this case substituting ψ ψ d ψ into y in eq 9 and rewriting y as y e gives the cross track error dynamics as 47 y e u sin ψ d ψ v cos ψ d ψ when ψ d is tracked such that ψ 0 eq 47 becomes 48 y e u sin ψ d v cos ψ d u 2 v 2 sin ψ d tan 1 v u in phase amplitude form substituting ψ d from eq 44 into eq 48 and using the identity sin tan 1 x x 1 x 2 gives 49 y e u 2 v 2 y e h 2 y e 2 u h y e r h which only holds for straight path when r h h 2 y e 2 theorem 1 horizontal elos guidance law for straight path the horizontal elos guidance law and the sideslip given by eq 44 renders the origin y e 0 of the cross track error dynamics in eq 49 locally exponentially stable les if u h and r h satisfy 0 u h and 0 y e r h and that ψ d is tracked such that ψ 0 proof the cross track dynamics in eq 49 is not time varying since it does not explicitly depend on time and can be completely described by its states as in the general form x f x t for autonomous systems in khalil 2002 and not in the form x f t x for the definition of non autonomous systems note that this is true only when u h is constant such that the system dynamics is the same for all 0 t t where t could be infinity see e g the mass spring system in khalil 2002 is autonomous which is a common analogy to the dynamics of mobile robots thus marine vehicle systems in this paper are autonomous systems stability of the cross track error dynamics 49 is analyzed using the time derivative of lfc v y e 1 2 y e 2 which is 50 v y e u h r h y e 2 k 3 y e 2 0 on the ball b r y e ℝ y e r with 0 k 3 u h r h since u h r h 0 are constant and v y e is negative definite the origin y e 0 of eq 45 is les the stability of elos guidance law cannot be global since y e r h is required for real solutions remark 5 the underactuation in sway can also be incorporated using the speed allocation into the cross track error dynamics by substituting v by v v d v c when v d f 0 in eq 22 however this will still produce a positive speed vector in eq 49 and the new expression for sideslip angle using v v d v c gets canceled out similarly as happened in the derivation of eq 48 thus sway underactuation does not affect the stability of result of the guidance law 5 2 horizontal selos guidance law the horizontal los radius r h can be written for the horizontal selos guidance as 51 r h r h m i n 1 2 a y e r h m i n y e r h m i n c y e r h m i n where r h m i n is the minimum tuning value for r h when c 0 and a 1 eq 51 becomes 52 r h r h m i n if y e r h m i n a y e if y e r h m i n the first case of eq 52 represents the elos guidance law which is proven to provide les above substituting the second case of eq 52 into eq 49 gives 53 y e u h a y e y e u h y e c 2 y e 2 since a 1 and c 0 theorem 2 horizontal selos guidance law for straight path the horizontal selos guidance law and the sideslip given by eq 35 37 and 44 renders the origin y e 0 of the cross track error dynamics 53 sges if u h and c satisfy 0 u h m i n u h and 0 c c m a x and ψ d is tracked such that ψ 0 proof the proof is similar to the approach in fossen and pettersen 2014 pettersen 2017 albeit the system is autonomous here origin of the system in eq 46 is les when y e r h m i n stability of the system 49 is analyzed using the time derivative of lfc v y e 1 2 y e 2 which is 54 v y e u h y e 2 c 2 y e 2 2 b r e v y e 0 for each r e 0 all y e t r e and b r e given by 55 b r e u h m i n c m a x 2 r e 2 first part of eq 54 means y e t y e 0 for all t 0 by invoking the comparison lemma khalil 2002 lemma 3 4 the second part of eq 54 implies y e t e 2 b r e y e 0 for all t 0 thus eq 54 implies that y e t e b r e y e 0 for t 0 and y e 0 y e 0 therefore the origin y e 0 is a sges equilibrium point of eq 53 loria and panteley 2004 definition 2 7 remark 6 if c 0 and a 1 r h m i n y e and this means that only global asymptotic stability gas is achieved for selos outside r h m i n which will result in shorter path convergence time since the vehicle is now traveling perpendicularly to the path however gas is less robust than exponential stability the saturation function in eq 53 resulting from the kinematic representation of the cross track error only allows sges stability for this class of guidance laws fossen and pettersen 2014 a study on stability and robustness properties of sges to perturbations are given in pettersen 2017 5 3 vertical track error dynamics the vertical track error dynamics can also be similarly described by the vehicle kinematics in d direction when the origin of ned is located at vehicle projection point x p y p z p on the path and the directions of ned are aligned with the path euler angles in ned such that ϕ p θ p ψ p 0 the vertical track error dynamics is also analyzed 5 dof since the vertical los guidance has also been formulated in 3 d course control 5 3 1 4 dof the 4 dof vertical track error dynamics z e is given by the relative kinematics z in eq 10 by replacing z with z e which is 56 z e w proposition 1 the origin z e 0 of the 4 dof vertical track error dynamics in eq 56 is gas proof the time derivative of the lfc considered for eq 56 v z 1 2 z e 2 is given by 57 v z z e z e w z e for constant w note that the vehicle can only converge to the path when the vehicle moves in the opposite direction to z e in ned which means that w must be negative in this case changing the sign of w in eq 53 gives v z w z e and hence the origin z e 0 is gas notice that the vertical track error in 4 dof does not require guidance law for convergence any controller that can provide a non zero w can thus stabilize the vertical track error in this 4 dof the sign of w is obtained through the sign of z e for vertical path convergence which is shown in the next section 5 3 2 5 dof the sges of vertical llos guidance is shown in wigg et al 2016 with an integral effect and without vertical slip however slip angles in desired headings for course control cancel out in the stability analysis as in eq 49 and thus the results also hold for non course control without slip angles the vertical elos and selos guidance laws with course control presented in this paper can also guarantee les and sges in 5 dof with pitch control resp this is shown as an example for elos guidance in this section the 5 dof relative kinematics with pitch is given by 58 x u cos ψ cos θ v sin ψ w cos ψ sin θ 59 y u sin ψ cos θ v cos ψ w sin ψ sin θ 60 z u sin θ w cos θ 61 θ q 62 ψ r cos θ the vertical track error dynamics z e in 5 dof is similarly given by the vehicle kinematics for similar choice of the origin and direction of ned on the path thus replacing z e with z and using the error expression θ θ d θ gives 63 z u sin θ d θ w cos θ d θ when θ d is tracked such that θ 0 this becomes 64 z e u sin θ d w cos θ d u 2 w 2 sin θ d tan 1 w u in phase amplitude form where w is reverted as w for the same reason as in proposition 1 substituting θ d from eq 46 into eq 64 and using the identity sin tan 1 x x 1 x 2 gives 65 z e u 2 w 2 z e v 2 z e 2 u v z e r v for straight path when r v v 2 z e 2 and u v u x z u 2 w 2 theorem 3 vertical elos guidance law for straight path the vertical elos guidance law with the vertical slip given by eq 46 renders the origin y e 0 of the vertical track error dynamics 65 les if u v and r v satisfy 0 u v and 0 z e r v and that θ d is tracked such that θ 0 proof stability of the vertical track error dynamics 65 is analyzed using the time derivative of lfc v z e 1 2 z e 2 which is 66 v z e u v r v z e 2 k 4 z e 2 0 on the ball b r z e ℝ z e r v with 0 k 4 u v r v since u v r v 0 are constant and v z e is negative definite the origin z e 0 of eq 61 is les the stability cannot be global since the condition z e r v is required for real solutions the les sges of vertical selos can be achieved using the exact steps used in the horizontal case of theorem 2 and thus is not repeated here 6 underactuated course control with speed allocation in 4 dof the selos guidance with and w o course control and or speed allocation are applied to an auv model using nonlinear controllers in 4 dof with heave control first the system matrices are presented which take the following structure 67 m m 11 0 0 0 0 m 22 0 m 24 0 0 m 33 0 0 m 24 0 m 44 a c ν b f f 0 0 0 c 14 0 0 0 c 24 0 0 0 0 c 14 c 24 0 0 b 68 d ν b f f d i a g d 11 u f d 22 v f d 33 w f d 44 r f the structure of the system matrices in 67 are obtained by assuming that the vehicle is symmetric in port starboard most vehicles are the body frame is located along the center line of the vehicle and that the terms in the center of gravity cg vector y g z g 0 fossen 2011 the sway underactuated system dynamics relative to flow is obtained by expanding relative kinetics in eq 6 as 69 u f 1 m 11 c 14 r f d 11 u f τ u 70 v f 1 m 22 c 24 r f d 22 v f m 24 r f 71 w f 1 m 33 d 33 w f τ w 72 r f 1 m 44 d 44 r f c 14 u f c 24 v f m 24 v f τ ψ where the dynamics in eqs 70 and 73 are coupled with r f and v f due to non zero m 24 which is due to non zero x g in cg however these coupled acceleration terms are negligible at low operating speeds and when x g 0 6 1 control systems and sway dynamics 6 1 1 yaw control the yaw error and its dynamics are defined as and given by ψ ψ d ψ and ψ ψ d r f taking time derivative of ψ and using r r f for irrotational current in ned the 4 dof kinematics and kinetics in eqs 11 and 72 gives 73 ψ ψ d r f ψ d 1 m 44 d 44 r f c 14 u f c 24 v f τ ψ m 24 v f a lyapunov based feedback linearizing controller used for yaw can be derived from eq 69 which is 74 τ ψ d 44 r f c 14 u f c 24 v f m 44 ψ d m 24 v f k ψ ψ where k ψ 0 is design gain by standard lyapunov analysis where the feedback terms cancel out the nonlinear terms in eq 73 it can be easily shown that the equilibrium ψ 0 is ges hence ψ 0 exponentially as t this satisfies the control objective 30 the values for ψ d and ψ d in τ ψ are designed as ψ d k r ψ and ψ d k a ψ where k r k a are positive gains since τ ψ contains ψ d which also contains r and hence τ ψ τ ψ f τ ψ also in order to prevent large ψ d being fed into the controller e g during waypoint switching the following integration is used to generate small increments of ψ d this is given by ψ d ψ k r t s ψ where t s is the integrator sampling time and ψ 0 still implies ψ ψ d remark 7 feedback controllers are are not easy to implement since they require knowledge or estimations of vehicle parameters one reason for using feedback controllers is to achieve ges or at least asymptotic stability as which obviously provides better performance and robustness at the kinetic level the yaw error dynamics in eq 73 shows that feedback terms are necessary to achieve at least as if feedback terms are not available only global stability can be achieved directly using any of the pid type controllers with high gains without as integral action is necessary to achieve zero steady state error for ψ which in turn requires anti windup the stability result of the yaw error dynamics does not affect the stability the guidance laws at the kinematic level but it can reduce the performance and robustness at the kinetic level which it turn can affect the cross tracking performance thus robust speed controllers here can provide a more accurate comparison for the benefits of course control and speed allocation without them reducing the pf performance this is also the reason of assuming the vehicle parameters to be known and using common feedback controllers at this stage to highlight the performance and benefits of using course control and speed allocation under a common condition of kinetic controllers and known vehicle parameters 6 1 2 surge control using time derivative of the relativity relationship in eq 4 current and surge dynamics in eqs 16 and 69 the surge error dynamics is given by 75 u u d u u d u f u c u d 1 m 11 c 14 r f d 11 u f τ u r v x s ψ c ψ c θ c v y c ψ c ψ c θ c the feedback linearizing proportional control law used for surge is given by 76 τ u c 14 r f d 11 u f m 11 u d k u u r f v x s ψ c ψ c θ c v y c ψ c ψ c θ c since r r f and k u 0 is proportional gain the desired surge acceleration u d can be obtained by u d k 1 u where k 1 0 is gain again standard lyapunov analysis can show that the origin u 0 of 75 is ges thus u t 0 as t this achieves control objective 28 6 1 3 heave control using the time derivative of relativity relationship in eq 5 and current and heave dynamics in eqs 18 and 71 the heave error dynamics is given by 77 w w d w w d w f w c w d 1 m 33 d 33 w f τ w r v x c ψ c ψ c ϕ c s θ c c ψ c ψ s ϕ c r v y s ψ c ψ s ϕ c c ψ c ψ s θ c c ϕ c the feedback linearizing controller for heave is given by 78 τ w d 33 w f m 33 w d k w w r v x s ψ c ψ c ϕ c s θ c ψ c ψ s ϕ c r v y s ψ c ψ s ϕ c c ψ c ψ s θ c c ϕ c where k w 0 is proportional gain the desired surge acceleration w d is obtained by w d k 2 w and k 2 0 is gain similarly using standard lyapunov analysis it can be shown that the origin w 0 of eq 77 is ges thus w t 0 as t this achieves control objective eq 29 6 1 4 sway error dynamics the error in uncontrolled sway system under current disturbance can be similarly defined and now can be expressed using speed allocation v d v c from eq 22 when v d f 0 and the relationship of relativity in eq 4 as 79 v v d v v c v v f using time derivative of the relativity relationship in eq 4 current sway and yaw dynamics in eqs 14 66 and 68 the sway error dynamics is given by 80 v v f 1 m 22 m 23 r c 23 r d 22 v f this equation represents a general 3 dof coupled underactuated sway error dynamics at body level relative to ned in the presence of current disturbance it can be seen that sway will drift in the direction of net force resulting in eq 80 without any actuation in sway for marine vehicles it is realistic and common to assumed that the sway dynamics is bounded for bounded input and externtal disturbance e g as in caharija et al 2012 it is shown by breivik 2003 for 2 d surface vehicles that ν b f f ν b n b is bounded for bounded τ a c t ν c n b and those proofs of passivity and boundedness can be shown for any 3 d case using the exact steps therein by assuming neutral buoyancy thus the relative underactuated sway dynamics will be bounded for bounded τ a c t ν c n b the drift in sway is minimized with actuation in surge and yaw when sideslip is taken into account in course control since the sideslip also describes the amount of v by definition and the vehicle is required to steer accordingly to counteract the drift in sway using surge this empathizes the importance of incorporating slip angles in heading control and thus of course control especially when there are current disturbance and sway is underactuated which cause bigger drift remark 8 note that the stability results of surge and sway error dynamics do not affect the stability results of the guidance laws on track error dynamics however the surge and sway velocities have an effect on cross tracking performance and also on course control pf performance through the definition of sideslip 6 2 planar speed assignment existing literature on 3 d pf primarily focus on 3 5 or 6 dof cases e g caharija et al 2012 2016 abdurahman et al 2017b and there are limited publications on 4 dof cases in 4 dof pf with passively stabilized vehicle roll and pitch dofs the dynamic task has to be divided into horizontal and vertical components to produce the respective speeds for u h d and w d such that the vehicle aims to track the los reference point p l o s simultaneously in both planes at a desired total speed u d this can also be referred as a coupled 3 d tracking this competition between the horizontal and vertical planes hasn t been sufficiently addressed in guidance based strategies to the author s best knowledge lekkas and fossen 2013 caharija et al 2016 a coupled design implies that the vehicle is tracking the los reference point in a shortest path strategy and a non coupled design will not result in a shortest path strategy which is not energy efficient this problem can be classified and is conveniently referred here as planar speed assignment the planar speed assignment is achieved by a trajectory generating system that will assign suitable values for u h d and w d using the los look above angle θ r z corresponding to the amount of look above distance r z which is given by 81 θ r z atan 2 z l o s z x l o s x 2 y l o s y 2 atan 2 r z r h the desired speed trajectories u h d and w d are then given by 82 u h d u h d m a x if r z w r h u h w d m a x tan θ r z if r z w r h u h 83 w d sgn e z w d m a x if r z w r h u h u h d m a x tan θ r z if r z w r h u h where u h d m a x w d m a x 0 are the preassigned maximum operating speeds in horizontal and vertical planes of ned and sgn e z helps determine the direction of w d which is reversed since the directions of vertical axes of ned frame and the z axis in software are opposite to each other the idea behind the speed assignment scheme in eq 81 83 is that it compares the expected times of arrival of the vehicle to p l o s in both planes using current speeds u h and w and assigns correct values for u h d and w d so that the vehicle is commanded to arrive at the reference p l o s simultaneously in both planes this is also equivalent to commanding the vehicle to follow the 3 d los vector r in 4 dof which is a simple and effective method for desired speed trajectory generation a slightly different speed allocation system can be similarly derived if there are additional dofs therefore such a speed assignment is a minimum requirement whenever the vehicle aims to simultaneously track a 3 d path in both planes and more advanced designs can be directly built on this strategy the final value for w d will fluctuate between w d m a x during depth keeping which is not good and can cause fluctuations in maintaining constant depth if they are directly fed to the actuators this is similarly avoided at the simplest case by designing w d as increments of the error in heave to added to the current heave speed w which is w d w k 5 w where k 5 is a gain this is also done for u h d where u h d u h k u r u h d u h for a smoother reference signal remark 9 note that in this 4 dof case the los reference generation is still coupled in 3 d and the horizontal and vertical tracking are executed simultaneously through the horizontal guidance law and the speed assigned heave velocity control thus it is also a coupled 3 d tracking therefore it is important for the planar speed assignment technique to regulate the horizontal and the vertical speeds so that the 3 d los reference vector is tracked simultaneously for a coupled pf 6 3 simulation results a 3 d straight line following performance the 4 dof girona 500 auv has been simulated using the selos relative states speed allocation and the new model of the ocean current in matlab the girona 500 is a multi purpose re configurable auv with three torpedo shaped hull design that is mainly used for research where the bottom hull can be replaced with robotic arms or other payloads for different missions the vehicle can be actuated fully in 4 dof with self stabilized roll and pitch and the model parameters of the vehicle are extracted from karras et al 2013 the path consists of straight lines between waypoints given in ned coordinates by w p x 5 18 25 35 40 w p y 10 23 25 35 35 w p z 15 15 6 6 15 the initial ned position vehicle heading and relative velocities are set to η b n n 4 1 1 0 and ν b n b 0 0 0 0 and the maximum desired relative velocities u h d m a x 1 m s and w d m a x 0 6 m s which gives a total maximum speed of u d m a x 1 17 m s in 3 d the current velocities are v x v y 1 2 m s and v z 0 2 m s which give its direction in ned as ϕ c θ c 9 5 o and ψ c 45 o which are constant in ned the guidance and control system gains are set as follows r m i n 1 a 1 01 c 0 001 k r k a k 1 k 2 1 k ψ 10 k d k u k w 55 k 5 k u r 0 2 t s 0 05 acceleration gains k 1 k 2 are usually small and other controller gains are not very high since the nonliniear terms are canceled out by the feedback in addition a radius of acceptance has to be designed in the guidance system to command the vehicle when to switch from the current waypoint ahead to the next waypoint in this regard a horizontal and a vertical radius of acceptance have been set as r a h 0 6 and r a z 0 4 resp so that when the vehicle enters this ball an oval in this case it knows that it has reached the current waypoint these radius are called as radius of acceptance fossen 2011 a smaller radius of acceptance produces less track errors spikes during waypoint switching but they have to be tuned accordingly taking into account mainly the operating speed of the vehicle so that it does not skip the waypoint on initial closing in which can lead to path divergence note that the selos guidance always has a solution despite large cross track errors because r is always tuned greater than the off track error e y z furthermore to achieve a more realistic simulation the control inputs saturate at 400 n in surge and heave and 150 n m in yaw and there is a limit in yaw rate of r m a x 57 3 o s there is also a rise time of 0 2 s for control inputs to rise from 0 to 400 n and 150 n m as the actuation dynamics in surge heave and yaw resp these actuator saturation and rise time can considerably affect the pf performance and they are not reported in many simulation or experimental works in the simulations the body velocities relative to and expressed in flow ν b f f are updated from zero initial values by integrating ν b f f which is obtained from the relative vehicle dynamics in eq 6 when the model parameters are known the body velocities relative to ned and expressed in body ν b n b are then obtained by using the updated relationship of relativity in eq 4 from the known current velocity in body that is rotated from the known current velocities in ned the vehicle starts from a distance away from the 1st waypoint and the pf performance with and w o current disturbances and or measurement noise are shown in fig 6 it can be seen that the vehicle can also accurately follow the path in all cases with some fluctuation when there are measurement noise the measurement noises are not filtered and in practice there will be some filter to smooth out the noise which makes the actual fluctuation smaller note that considering an underactuated vehicle in sway the current disturbance rejection is significant at 121 v c 1 21 u d m a x which is much higher than existing current disturbance rejections in the literature especially with saturation and rise time in actuation e g caharija et al 2012 2016 the vehicle is seen being drifted away in the horizontal plane initially this is due to the zero initial vehicle velocity and initial heading error hence the vehicle drift is reduced when it has gained some velocity and less heading error this initial drift is intuitively more dominant in sway underactuated case and if there is actuation in sway the drift will be smaller especially if the current in sway v c can be counteracted by some design of v d now allowed through the speed allocation note that compared to a constant and irrotational current a time varying and rotational current is equal to only increasing the intensity of the current in each dofs with nonzero v c and current euler rates thus in general the current disturbance can be increased even further or made time varying and rotational to demonstrate the intuitive fact that with sufficient amount of actuation the vehicle can always reject sufficient amount of disturbance i e the amount of environmental disturbances that can be overcome mainly depend on the amount and dynamics of input actuation this can be shown using the relative equations of motion which completely incorporate all the environmental disturbance from fluid flow which in turn includes the current and or wave disturbance through the updated relationship of relativity in eq 5 figs 6 and 7 show the velocity tracking profiles for pf with and w o current disturbance which shows good tracking of the desired states they both show that the horizontal velocity is reduced during diving through the planar speed assignment design for a coupled tracking in 3 d in fig 6 the sway velocity is actually negligible when there is no current disturbance as commonly assumed in many works fig 7 also shows that the unactuated sway velocity v sways along with the current in sway v c to align the course angle with the desired heading in course control the slight fluctuations in surge speed is due to input actuation rise time this is actually smaller than it seems in the figure since the time axis is long at about 90 s figs 8 and 9 show that the desired heading angle and track errors are also tracked accurately and kept at minimum especially in the case w o current disturbance the spikes in the off track error are during waypoint switching and the sign changes in its representation fig 9 shows that there is a large heading error initially which is due to slow initial speed limited actuation and saturation in yaw the steep changes in heading error is due to shifts in the quadrants that occurred care is required when dealing with heading angles greater smaller than 2 π 2 π and most studies do not consider all four quadrants this is the reason of using a reference signal generator for yaw and thus the actual error fed back to the controller is only in small increments as designed in the previous section in addition this error will be nonlinearly smaller for decreased current disturbance and a near worst case scenario is demonstrated for the magnitude of current disturbance figs 10 and 11 show the control input forces and moments during pf w and w o current disturbances where it can be seen that yaw input is only needed during waypoint switching when there is no disturbance note that similarly some chattering is present in the figures but these are actually smaller since the time axis is long 6 3 1 pf w and w o speed allocation and or course control further simulations are carried out to highlight the effectiveness of course control and speed allocation in disturbance rejection the waypoints initial conditions guidance and control system gains are exactly the as in the previous section the 3 d current is v x v y 0 3 m s and v z 0 1 m s which gives its intensity and heading at v c 0 66 m s and ϕ c θ c 18 4 o p s i c 45 o the pf performance of the vehicle w and w o course control crc and or speed allocation sa are shown in fig 12 the desired heading angle w o sideslip is given by ψ d ψ l o s and the desired surge speed w o speed allocation is as commonly given by u d u h d the desired heading and speed are well tracked by the controllers and thus only track errors are shown here it can be seen that the pf performance is worst when there are no speed allocation or course control where it also takes much longer to complete the waypoints and as expected it is best when there are both speed allocation and course control also with quicker path completion time see that the main advantage of speed allocation is reduction in oscillation and path completion time in both cases in addition only course control alone can hugely reduce the cross track error even w o speed allocation this again shows that course control is a very effective and simple method for disturbance rejection 7 conclusion this paper presented the pf performance and stability analysis of 3 d selos guidance system using course control and speed allocation along with a model of 3 d ocean current the new current model updated relationship of relativity and the definitions and illustrations of the track errors in ned have provided a more complete formulation of the 3 d pf problem under ocean current and or wave disturbances the course control and speed allocation problems have been further studied and their effectiveness in disturbance rejection without introducing complexity has been demonstrated with actuator dynamics and saturation these two strategies are very attractive in pf systems under disturbance rejection future research will include experimental studies pf under time varying and rotational current and or wave disturbances stability in curved paths and fully actuated pf considering the design freedom offered by the speed allocation nevertheless the results in this paper together with the new model of the ocean current and 3 d pf problem offer powerful and cost effective preliminary simulation studies before experimental implementations appendix a supplementary data the following is the supplementary data to this article multimedia component 1 multimedia component 1 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j oceaneng 2019 04 021 
