index,text
2415,the covariance of stable hydrogen δ 2h and oxygen δ 18o isotopes in local precipitation the local meteoric water line lmwl serves as a benchmark in isotope hydrological or paleoclimatological applications however the isotope hydrometeorological monitoring network is still sparse in many parts of the mediterranean and the degree of spatial data coverage is insufficient to address current needs to remedy this weakness a spatially continuous interpolated geostatistical product of the lmwls of modern precipitation across the mediterranean has been developed the lmwls of the stations with data for more than four years between 2000 and 2015 were calculated using reduced major axis regression and then interpolated across the region using statistical and machine learning methods random forest interpolation with buffer distance and elevation gave the best performance in the out of sample verification and was thus used to derive the final interpolated product the slope and intercept of the lmwls ranged between 5 9 to 8 2 and 3 9 to 16 1 respectively a detailed comparison with previous local regional estimations showed that the model presented here concurs with those albeit with minor deviations in certain regions with the present results it then becomes possible to assess how well grounded the eastern and western mediterranean meteoric water lines emmwl and wmmwl for the 21st century are in the eastern mediterranean the current model shows a slope 6 9 and the intercept 15 concurring with local studies but does not reproduce the frequently cited benchmark values of the emmwl slope 8 intercept 20 the emmwl may be considered an idealized isotope hydrological benchmark useful in regional studies nonetheless it cannot be taken as a valid representation of the actual empirical description of the δ2h δ18o covariance of local precipitation in the eastern mediterranean defining a uniform regional mwl in the western mediterranean is not supported by the spatial heterogeneity of lmwl parameters based on the present estimations calling into question the utility of the wmmwl as an isotope hydrological benchmark keywords meteoric water line stable isotopes rma regression machine learning precipitation emmwl wmmwl abbreviations rma reduced major axis emmwl eastern mediterranean meteoric water line wmmwl western mediterranean meteoric water line data availability the source of the used data is explained in the data availability statement in the ms 1 introduction water phase changes occur over various spatiotemporal scales in the global hydrological cycle resulting in relative changes in the spatiotemporal distribution of stable water isotopes yoshimura 2015 the specific isotopic signatures of atmospheric processes such as evaporation condensation and deposition in precipitation are then imprinted in terrestrial water bodies allowing the application of isotopic data to hydrological studies gat et al 2001 the isotopic composition of hydrogen δ 2h and oxygen δ 18o of precipitation δ p is recognized as highly important natural tracer in the water cycle bowen et al 2019 fórizs 2003 gat 1996 gat et al 2001 describing the linear relationship between δ 2h and δ 18o in precipitation is a classical concept of hydrology gat 2005 and is called the meteoric water line mwl it is common practice to define a local meteoric water line lmwl for a given location as the best linear fit of all the precipitation data in δ space gat 2005 a global compilation of the δ 2h and δ 18o of fresh water provided a best fit line δ 2h 8 δ 18o 10 craig 1961 later called the global meteoric water line gmwl following an additional 30 years of data collection the database of global network of isotopes in precipitation gnip allowed the gmwl s revision based on long term amount weighted annual means as δ 2h 8 20 0 07 δ 18o 11 27 0 65 rozanski et al 1993 the gmwl is very useful in hydrology in understanding the origin of modern and ancient ground water and its interactions with surface waters the gmwl may be considered an amalgamation of many local meteoric water lines lmwl which in turn vary greatly in their slope and intercepts on regional or local scales kendall and coplen 2001 sharp 2017 these lmwls are often evaluated in the context of their deviation from the gmwl e g tappa et al 2016 which represents the expected equilibrium relationship where the slope is assumed to arise from the ratio of equilibrium fractionation factors putman et al 2019 the gmwl s slope of 8 reflects the average global relationship between δ2h and δ18o in precipitation while lmwl slopes documented at values ranging from 4 8 to 10 9 at 400 sites globally putman et al 2019 may indicate that at least one season is characterized by precipitation affected by nonequilibrium processes the intercept of the lmwls has also been documented as varying across the globe from 24 to 27 putman et al 2019 the lmwl represents the characteristic distribution of δ p and can if determined from long term observations serve as a benchmark in isotope hydrological applications such as the estimation of the infiltration period or the paleoclimatological evaluation of the groundwater isotope signals clark and fritz 1997 it is common practice however to estimate the lmwls from just short term investigations e g bottyán et al 2017 el ouali et al 2022 kattan 1997 liotta et al 2013 paar et al 2019 an approach which is prone to biasing by anomalous climatic events longinelli et al 2006 vreča et al 2007 vreča et al 2022 if at least 48 months data for a given station is used it can attenuate the possible noise caused by such extreme events and interannual variability in estimating the covariance of δ 2h and δ 18o putman et al 2019 at present the mediterranean region faces an ever increasing tendency towards water shortage garcía ruiz et al 2011 hoerling et al 2012 iglesias et al 2007 villani et al 2022 which will clearly amplify the potential for sociopolitical and economic disruption e g kelley et al 2015 and ecological problems cook et al 2016 isotope hydrological methods have great potential in the improvement of the scientific understanding of the processes governing the regional water cycle and so therefore to assist in knowledge based water resource management aggarwal et al 2005 in some parts of the mediterranean region the isotope hydrometeorological monitoring network was sparse in the past leading to the initiation of regional campaigns iaea 2005 and further subregional monitoring the spatial data coverage is however still insufficient for many scientific purposes isotope hydrological studies frequently use lmwls across the mediterranean tackling problems in subsurface brkić et al 2020 christofi et al 2020 hssaisoune et al 2022 koeniger et al 2017 liotta et al 2013 trabelsi et al 2020 túri et al 2020 vasić et al 2019 or surface hydrology el ouali et al 2022 gat and dansgaard 1972 serianz et al 2021 lmwls taken from relatively remote locations have recently started to grow in numbers e g boumaiza et al 2021 elghawi et al 2021 túri 2019 indicating a great demand for such reference data in the isotope hydrological research in the region therefore reliable estimates of the lmwls are also important at places where direct isotope meteorological monitoring is not in operation remote lmwls can indeed be misleading for local water resource applications e g serianz et al 2021 the lmwls might be very similar over extended regions allowing the definition of regional mwls pioneering studies have assessed the precipitation stable isotope composition on subregional scales in the broader mediterranean realm regional meteoric water lines for the eastern emmwl δ 2h 8 δ 18o 22 and the western parts wmmwl δ 2h 8 δ 18o 13 7 were established in the late 20th century and both continue to serve as widely used benchmarks in isotope hydrological studies fernández chacón et al 2010 giustini et al 2016 natali et al 2021 surić et al 2018 previously determined models can require revision because of the ongoing spatiotemporally varying changes in the hydroclimate which may be presumed to induce alterations in the isotope hydrometeorological signal a further source of difficulty is the existence of various methodological approaches to addressing the question of describing the linear relationship between the water stable isotopes across the mediterranean e g argiriou and lykoudis 2006 and these may be expected to result in significantly different estimates crawford et al 2014 marchina et al 2020 natali et al 2021 moreover the temporal resolution of the input data and most importantly the time period the data cover can cause significant differences in the estimates of the slope and intercept of the lmwls putman et al 2019 as has been specifically documented in certain sub regions of the mediterranean e g krajcar bronić et al 2020a vreča and malenšek 2016 the regional mwl was defined in the western mediterranean wmmwl on the basis of data from ten coastal stations with relatively short term coverage from the end of the twentieth century celle jeanton et al 2001 the origin of the eastern mediterranean meteoric water line emmwl is somehow more obscure in the eastern mediterranean it was found that the d excess a second order stable isotopic parameter defined as d δ 2h 8 δ 18o dansgaard 1964 has characteristically elevated values well above18 gat and carmi 1970 this observation for eastern mediterranean precipitation subsequently received reinforcement d 15 el asrag 2005 rindsberger et al 1990 to complicate the issue further decades later in gat 1996 this same observation was referred to as the eastern mediterranean mwl of d 20 gat and carmi 1970 regarding the slope of an eastern mediterranean regional meteoric water line there is no mention of it in gat and carmi 1970 a relationship between precipitation δ 2hand δ 18o samples has been documented for israel with slopes of 5 and 6 3 gat and dansgaard 1972 fig 3 therein a potential source of misunderstanding could be the first numeric appearance of the rather well known equation δ 2h 8 δ 18o 22 in relation with isotope data of surface water in the upper jordan valley fig 9 in gat and dansgaard 1972 this however clearly cannot be taken as a figure for precipitation representative of the eastern mediterranean furthermore rindsberger et al 1990 in sect 1 states the δd and δ 18o values of the precipitation in most cases follow a relationship such as δd 8 δ 18o d the so called mwl relationship which is clearly an oversimplification of the matter meanwhile fig 7a δ 2h vs δ 18o plot in rindsberger et al 1990 presents a reference line annotated as mwl d 22 without any underlying data or citation suggesting that this is just an arbitrarily chosen benchmark in that particular study at the turn of the twenty first century it was reported that rain events of 20 mm at a monitoring station in israel between 1995 and 1997 followed a trend with a slope of 8 and d excess of 20 to 30 ayalon et al 1998 this however cannot be considered an mwl since as noted above the lmwl is defined as the best linear fit of all the precipitation data in δ space gat 2005 it seems that some studies have taken it for granted that the slope is 8 and the intercept is 22 of the emmwl although these parameters were not obtained obeying the rules of how meteoric water lines should be derived see gat 2005 what is more further confusion regarding the mediterranean regional meteoric water lines may have originated from the occasional usage of ad hoc terminology and acronyms for example the mediterranean meteoric water line mmwl ayalon et al 1998 koeniger et al 2017 which is used to represent location s in the eastern mediterranean or the abbreviation emwl e g bajjali and abu jaber 2001 yüce 2005 such usage further increases the possibility of confusion over regional mwls in the present work the abbreviations emmwl and wmmwl are used exclusively to refer to the regional definitions a recent study has addressed the geographic variations in the slope of lmwls across europe focusing on the temperate and boreal regions of the continent lécuyer et al 2020 it does not however cover the mediterranean region thus the current work aims to provide a spatial extension of that analysis with respect to the slope of lwmls additionally the present study represents a methodological extension because the intercept of the lmwl is also evaluated moreover in doing so the performance of various interpolation methods classical statistical and machine learning with different set of predictors altogether 14 approaches is investigated in modeling the spatial distribution of the slope and intercept of the local meteoric water lines across the mediterranean taking into consideration the climatic and geographic context of the region 2 materials and methods 2 1 study area description the study area covers the mediterranean basin from north africa across southern europe to the middle east this area extends from 7 5 w to 36 7 e and from 29 9 n to the orogenic belt from the pyrenees through the southern alps to the carpathian chains fig 1 a the mediterranean climate of the region is characterized by temperate dry hot summers and humid winters the csa climate subtype in the köppen geiger climate classification system kottek et al 2006 warm dry summers csb are more frequent on the coasts close to the atlantic ocean in the west and the black sea in the east the southern part of the basin is dominated by arid hot and cold steppe conditions bsh bsk and arid desert conditions bwh especially south of 31 n under the influence of the sahara north of 41 n a temperate climate dominates without a dry season and with warm cfb and hot summers cfa especially around the black and adriatic seas the mediterranean basin is characterized by specific patterns of atmospheric circulation with dry and cold continental air masses that interact with a marine basin characterized by high evaporation rates and relatively high sea surface temperatures 20 c iaea 2005 such air sea interactions are important sites of cyclogenesis in the mediterranean bartholy et al 2009 kelemen et al 2015 compared to the rest of the european continent which is dominated by atlantic moisture the mediterranean has a more complex moisture source structure the primary source region being the mediterranean sea itself at least seasonally ciric et al 2018 previous subregional isotope hydrometeorological assessments have revealed that the variable physiographic and hydrometeorological factors act differently and result in a remarkable divergence in values of δ p between the different parts of the mediterranean basin fischer and mattey 2012 giustini et al 2016 hatvani et al 2020 hunjak et al 2013 consequently the δ 2h δ 18o relationship has also been found to display considerable subregional differences e g dotsika et al 2010 giustini et al 2016 vreča et al 2006 2 2 data used monthly δ p values were acquired from a total of 249 monitoring stations covering 1960 2020 primarily from the global network of isotopes in precipitation gnip with six stations updated with more recent data râmnicu vâlcea varlam et al 2021 zagreb krajcar bronić et al 2020a plitvice krajcar bronić et al 2020b ljubljana and portorož vreča et al 2015 vreča et al 2011 vreča et al 2008 vreča et al 2014 vreča et al 2022 and pisa natali et al 2021 table s1 in addition other local and regional networks were included 11 stations in sicily operating between february 2002 and march 2003 liotta et al 2006 6 stations february 1992 to december 1996 longinelli and selmo 2003 8 stations january 2002 december 2004 scattered across northern italy longinelli et al 2006 3 stations from the mt vulture region paternoster et al 2008 and 7 stations from tuscany natali et al 2021 in addition single records from forni di sopra 2005 2010 cervi et al 2017 and riva del garda from february 2007 to january 2008 longinelli et al 2008 data collected at 6 stations in lebanon between october 2012 and may 2013 koeniger and margane 2014 6 stations in hungary operating between january 2005 and november 2017 fórizs et al 2020 3 stations in croatia operating between may 2012 and september 2013 paar et al 2019 and one station between 2017 and 2019 marković et al 2020 dumbrava romania from april 2012 to july 2015 bojar et al 2017 16 stations in cyprus 2014 2017 christofi et al 2020 1 station in serbia 1992 1997 and 2003 2005 golobočanin et al 2007 and 2 short time series from morocco from june 2010 to november 2011 wassenburg et al 2016 in general the data gathered were unequally distributed in space fig 1a and time fig 1b until the mid 1980s the number of active precipitation monitoring stations was limited n 12 from the mid 1980s onwards their number rose progressively reaching about 50 by the turn of the millennium in the early 2000s owing to a coordinated research project of the iaea iaea 2005 the network was quite extensive for instance in 2002 3 the number of active stations peaked at over 80 while the average number of annual δ p pairs was 60 at that time fig 1b in the 2000s the same number of δ 2h and δ 18o data were generally available although in certain cases the δ 18o records were more abundant to maximize the spatiotemporal coverage of the δ p values available from the study region a focus period of 2000 2015 was chosen this period was characterized by an annual average number of stations 31 providing data in any given year the only exception was 2007 in which the average number of active stations was only 30 2 fig 1b nevertheless the focus period chosen 2000 2015 was not cut in half on account of this one year 2 3 methodology 2 3 1 data preprocessing as a first step local moran s i statistics moran 1948 were calculated to investigate the correlations within different spatial units and their surrounding spatial lags up to 501 km this was done for each month from january 2000 to december 2015 for both δ p using moran scatterplots anselin 1996 classifying the spatial autocorrelation moran is of the stations into four types and enabling an advanced screening for outliers if the moran scatterplot suggested a possible error the d excess values d e x c e s s δ 2 h 8 δ 18 o dansgaard 1964 were also compared between the neighboring if the d excess values of the possible outlier deviated inexplicably from its neighbor s e g diff 10 the δ p values were dropped cf erdélyi 2023 this approach is more complex than that employed in previous studies which used a static d excess cutoff threshold bowen 2008 nelson et al 2021 outside of which δ p values were excluded without any consideration of the spatial relationship as a result of this approach δ p values from patras dec 2000 ciudad real feb 2002 antalya mar 2003 and murcia jan 2004 were dropped in all cases the d excess was 20 in addition curiously in 2010 the exact same δ p values were recorded at the ankara and antalya stations and it was not possible to trace back the origin of the gnip database error or decide to which station the values belong thus these were excluded from the analyses next the monitoring stations were classified into three quality categories qc according to the number of data recorded at each one during 2000 2015 stations belonging to qc1 had to have δ 2h δ 18o pairs from 48 months as this was the amount of data required for any lmwl calculation for it to take on the characteristics of the long term distribution without bias caused by natural noise putman et al 2019 in the study area in high summer precipitation may not fall for months thus an additional quality category was set up qc2 had to have data from at least four years covering not 16 months because below this threshold the use of rma regression frequently resulted in insignificant relationships see sect 2 3 2 the stations not meeting any of the criteria above qc3 were excluded from the analysis the possibility was entertained that stations situated close to each other within 10 km could be merged to improve the input data for lmwl estimation since certain monitoring sites had been relocated within a short distance or restarted at a nearby locality after a multiannual halt in monitoring the datasets for such nearby stations were merged table s1 the coordinates of the one functioning longest from among those merged was used in the final dataset in all cases the inter station distance of the stations forming these merged datasets was smaller than 8 km the final quality controlled dataset contained 42qc1 and 20qc2 stations of which 11 had been merged 2 3 2 reduced major axis rma regression traditionally the lmwls are defined employing ordinary least squares regression ols or reduced major axis rma regressions iaea 1992 the conceptual difference between the two approaches is that while ols regression minimizes the sum of the squared deviations of the predicted values rma minimizes both the vertical and the horizontal distances between each point and the regression line i e it uses diagonal residuals that have slopes opposite to the slope of the regression line clarke 1980 since rma is less prone to outliers and more importantly the relationship of the two assessed variables can be described by physical laws carroll and ruppert 1996 the application of rma is more appropriate to the definition of the lmwl crawford et al 2014 putman et al 2019 a more advanced option could have been to use precipitation weighted rma pwrma regression crawford et al 2014 but that would require precipitation amounts recorded for all δ p values a requirement not met in the present case moreover studies support that the difference between slope and intercept values estimated by rma and pwrma agree within error bounds boschetti et al 2019 krajcar bronić et al 2020a therefore in the present study rma regression was applied to raw monthly δ p values using the lmodel2 package legendre 2018 in r r core team 2019 with 2 000 permutations to obtain the significance values 2 3 3 interpolation techniques three major types of interpolation techniques were employed in the study with different sets of predictors to obtain a spatially continuous map of the intercept and slope of the rma regression inverse distance weighting idw a traditional interpolation method webster and oliver 2008 and two machine learning ml methods specifically random forest rf li et al 2011 liu et al 2012 and support vector machine svm cortes and vapnik 1995 were used idw interpolation is a method in which each point of estimation is calculated as the average of nearby sample values weighted by their distance from the estimation point it does not make assumptions about spatial relationships except for the basic assumption that nearby points are expected to be more closely related to the value at the estimation location than distant points two alternatives were trialed linear weighting power α 1 idwp1 and nonlinear weighting power α 2 idwp2 rf is a machine learning algorithm in the procedure a combination of a series of tree structure predictors is assessed here each tree depends on the values of a random vector sampled independently with the same distribution for all trees in the forest the generalization error for forests converges to a limit as the number of trees in the forest increases the generalization error of a forest of tree classifiers depends on the strength of the individual trees in the forest and the correlation between them breiman 2001 its predictions are based on the average results of the decision trees which use bootstrap sample bagging to eliminate the possibility of over fitting for details see e g biau and scornet 2016 breiman 2001 prasad et al 2006 as with rf svm is another frequently used supervised machine learning technique for classification and regression purposes however the theory behind svm is different to that of rf it relies on the application of kernel functions which also means that svm is a nonparametric technique in finding a function that deviates from an observation by a value not greater than a given threshold value for each observation and at the same time is as flat as possible as a consequence the function fitted by svm is the hyperplane that has the maximum number of observations cortes and vapnik 1995 six combinations of predictors which can influence the stable isotopic composition of precipitation consequently the slope and intercept of the lwmls in the region were considered in the case of the ml algorithms latitude longitude in web mercator epsg 3857 köppen geiger climate class codes category variable with the approaches denoted as rfkg svmkg latitude longitude and elevation ele denoted as rfele svmele elevation was incorporated since the local orographic features may significantly change the isotopic composition of precipitation in the mediterranean liotta et al 2006 liotta et al 2013 latitude longitude köppen geiger climate class codes and elevation denoted as rfkg ele svmkg ele the distance matrix of the monitoring stations and again the köppen geiger codes following the rfsp procedure of hengl et al 2004 with the approaches denoted as rfsp kg and svmsp kg the distance matrix of the monitoring stations and elevation denoted as rfsp ele and svmsp ele the distance matrix of the monitoring stations the köppen geiger climate class codes and elevation denoted as rfsp kg ele and svmsp kg ele the idw interpolation was performed using golden software surfer 15 and gs 10 in the rf approach the value of the nodesize and mtry parameters was selected automatically using the tune command of the randomforestsrc package ishwaran et al 2021 ishwaran et al 2008 in r r core team 2019 while for rfsp these were chosen as 5 and 10 for the slope and intercept parameters respectively using the ranger package wright and ziegler 2015 the svm modelling was carried out using the caret kuhn et al 2020 and e1071 meyer et al 2019 r packages 2 3 4 validation the results of the different interpolation schemes were validated by forming two pairs of training and validation datasets validation stations were only selected from those countries where there was more than one station available not considering merged stations the validation set1 vs1 n 10 consisted of one randomly chosen station from each country preferably from its q2 station s validation set2 vs2 n 10 consisted of the first stations in alphabetical order from each country table s1 the reason the stations were chosen from different countries was to avoid biased validation results that might arise due to some spatial clustering the sets of stations used in the actual interpolation were complementary to vs1 and vs2 and were referred to as set 1 and set 2 respectively after applying the interpolation methods to estimate the slope and intercept of set1 and set2 the squared point differences for stations in vs1 and vs2 were calculated the performance of the 14 interpolation schemes was primarily evaluated using the squared errors of vs1 and vs2 while visual inspection of the interpolated maps was employed to check for systematic interpolation errors artefacts etc first and foremost the median of the squared errors was taken into consideration rather than the mean since latter is much more sensitive to outliers wilcox 2003 which is a crucial strength in the case of a relatively small sample size as with the present one 3 results and discussion 3 1 local meteoric water lines in modern precipitation across the mediterranean in the estimations presented here the point values of the stations and the pattern seen on the interpolated maps are compared with previous studies of the region the slope of the δ 2h δ 18o relationship varied between 5 9 and 8 3 the lowest values some even falling below 7 were observed in the east and in the western parts and n africa the highest values exceeding 8 in the north in the alpine foothills of italy fig 2 a considering subtropical arid or seasonally hot and dry regions köppen geiger climate class b and cs 40 of the slopes obtained fall within the typical range 5 to 7 reported for these climate regions in a global assessment putman et al 2019 the rest of the stations assigned to these climate classes had slightly steeper slopes max lake massaciuccioli 7 9 in zone csa which is still not unusual in these climates considering humid temperate and seasonally snow dominated regions köppen geiger climate class cf and d 77 of the obtained slopes fall within the typical range 7 to 8 for these climate regions reported in a global assessment putman et al 2019 the remainder is in the vicinity of the southern alps where as previously mentioned the highest slope values are observed in the subtropical arid or seasonally hot and dry regions köppen geiger climate classes b and cs almost all 90 of the intercept values fall within the typical range 0 to 15 reported for these climate regions in putman et al 2019 the outliers comprise mainly stations with low intercepts in central iberia in the case of humid temperate and seasonally snow dominated regions köppen geiger climate classes cf and d only 14 of the intercept values obtained fall within a typical range 20 to 5 putman et al 2019 this discrepancy may be due to the differing extent of various colder climate zones incorporated into the studies it should be noted that the stations studied here are characteristically rather humid and experience less snowfall fig 1 and table s1 whereas snowfall tends to result in negative intercepts putman et al 2019 the large scale spatial patterns fit well into the estimations made for a continental transect across europe where slopes ranged from 6 to 10 lécuyer et al 2020 in fact from the western margin of the area studied up to the adriatic 12 e a similar longitudinal trend is observed as that reported across the temperate and boreal regions of europe reaching a slope of 8 lécuyer et al 2020 fig 4 therein further eastward however while the slope of the relationship assessed from the continental transect continues to increase up to 9 lécuyer et al 2020 in the case of the mediterranean it declines the spatial pattern of the intercept on the other hand shows a more complex pattern in central iberia the intercept is 3 5 while the coastal parts have values ranging between 2 7 and 6 then after a gradual increase higher values are seen surrounding the adriatic sea peaking at 10 in northeastern italy and slovenia fig 2b matching the area of the steepest slopes fig 2a eastward from the adriatic a gradual decrease is observed around 17 e intercepts of 7 5 are observed to decrease to around 5 20 23 e a subregional pattern is seen surrounding the black sea where intercept values are 3 2 fig 1a it is a common climatic feature of the low intercept areas both central iberia and this particular region that the summer is characterized by very dry conditions table s1 an explicit contrast is observed in the southeastern sector of the mediterranean basin where altogether the highest 16 intercept values are to be found fig 2b in the northern part of africa the number of stations used to estimate the lmwls and interpolate those is smaller and much less continuous compared to the other regions in the mediterranean fig 2 therefore attention should be paid to these points when the estimations for this specific sub region are used 3 2 performance evaluation of the spatially continuous estimations of the lmwls across the mediterranean region in choosing the best performing interpolation method the median the upper quartile and the interquartile interval obtained squared differences and the question of how prone the method was to showing extreme outliers were all considered if the number of squared differences classified as extreme outliers fig 3 is 10 practically n 2 for either the slope or the intercept said method is discarded this was true for all the svm approaches regardless of the predictors applied since the svm methods gave the most extreme outliers in the case of the slope and intercept those were not considered in the following it was also determined that there was no significant difference either between the medians as calculated using mood s independent samples median test mood 1950 asymptotic significance p 549 and 72 for the slope and intercept respectively or in the distribution of the squared errors between the three models with the best performance based on independent samples using the kruskal wallis test kruskal and wallis 1952 which yielded values of h 2 663 p 718 for the slope and h 2 82 p 644 the inverse distance approaches performed worst in the case of the slope regarding the median and the upper quartile fig 3a and regarding the median in the case of the intercept fig 3b therefore the rf approaches with the different combination of predictors seemed the most promising rfsp ele was the only combination that gave the most promising results for the slope and intercept as well this was not true for the other options because those gave incoherent errors for some the squared errors were higher for the slope while indicating relatively smaller errors for the intercept and vice versa fig 3 thus to be consistent the random forest approach with buffer distance and with the inclusion of elevation as predictors rfsp ele was chosen to provide the best interpolation for the slope fig 2a and the intercept fig 2b of the mediterranean lwml 3 3 spatial patterns and regional differences comparing not only the estimated point values sect 3 2 but the spatial trend seen in the spatially continuous interpolated products fig 2 and figs s1 and s2 it was observed that these concur with the findings documented in numerous studies from the region over the decades there are however some differences that are explained later in this section a recent regional study described the lmwl across nw iberia on the basis of a small regional monitoring network moreno et al 2021 partially overlapping with the chosen timeframe 2010 2012 but not meeting the quality criteria described in sect 2 3 1 apart from barcelona and mallorca the stations used in that study were not included in the present analysis hence offering the possibility of an independent comparison to assess the interpolated lmwl parameters along the cantabrian coast the difference in the slope between the presented model and a reference study moreno et al 2021 is 0 6 this may be because the region is on the border of the present study area where the slope values were merely extrapolated in contrast to this the slope does represent quite a good match with the other stations moreno et al 2021 with an average difference of 0 12 in an iberian regional reference study the intercept ranges between 1 and 5 moreno et al 2021 which is similar to the values in the present estimations fig 2 b heading east the regional trend previously documented across the apennine peninsula giustini et al 2016 is in harmony with the pattern documented here a continuous decrease in slope from 8 to 7 and intercept from 9 5 to 6 from north to south fig 2a specifically the slope parameter displays a good match over the whole region fig 2a while the values of the intercept are smaller fig 2b compared to those in a reference study giustini et al 2016 if the present estimations are compared with the lmwl of a more localized study from ne italy masiol et al 2021 the slope values show a good match while the intercept estimated in the present work is slightly higher by 1 on the se coast of the gulf of genoa fig 1a a regional study estimated a slope of 7 28 and intercept 7 3 natali et al 2021 which gave a rather good match with the presented modelled values fig 2 it should be noted however that two out of the four central italian stations were used in the interpolation exercise after preprocessing therefore this comparison cannot be taken as fully independent similar slope and intercept values are observed across sicily compared to the sub regional outcrop of the model for the apennine peninsula giustini et al 2016 and a better match is seen in the highly elevated nw coastal stations of sicily when compared to a sub regional model of the island liotta et al 2006 compared to a study assessing the regional lmwls in sicily the presented slope values are slightly higher and so are the intercept values 1 liotta et al 2013 although this difference might come from the relatively short period covered jul 2004 jun 2006 which does not meet the necessary four year criterion putman et al 2019 an independent dataset from eastern serbia incorporating three stations overlaps with the study period vasić 2017 the specific locations of the stations used in that reference work were not documented and the temporal coverage was not continuous thus these could only be used with reservations for comparison and are not included in the modeling the slope of individual stations n 3 ranged from 6 6 to 7 2 with the intercept spanning 2 4 to 4 8 vasić 2017 the present model provided a spatially much smoother and somewhat higher estimation for the slope and intercept for the corresponding area with values of 7 4 and 5 3 respectively fig 2 probably due to their applied method ols and temporal gaps and in the reference data vasić 2017 considering the southern sector of the balkan peninsula reported lmwls display an unusually large scattering in slope and intercept from 5 5 to 9 2 and from 1 2 to 21 respectively even for locations close to each other in southern greece dotsika et al 2010 on the contrary the macro regional mediterranean model presented here displays much smoother and hence realistic estimates of the lmwl parameters heading further east the slope and intercept indicate a rather meridional trend across greece the slope gradually decreases from 7 3 to 6 9 going west to east across greece fig 2a while the intercept decreases from the albanian greek border 5 9 to 3 also towards turkey fig 2b for the final subregional comparison in cyprus a lmwl δ 2h 6 58 0 13 δ 18o 12 64 0 91 was derived in a recent study from the mean precipitation weighted values of 16 monitoring stations christofi et al 2020 updating older findings based on many fewer stations δ 2h 5 75 δ 18o 3 6 jacovides 1979 taking the previous estimations into account the present model s slope for the area 6 8 agrees well with the most recent one while the intercept 7 is below the recent estimate but definitely higher than the older study s intercept value regarding north africa a study combining rainfall events and monthly data from 17 monitoring stations defined two lmwls ait brahim et al 2016 fig 5 therein the estimated parameters of which are both higher than those yielded by the present estimation slope 7 intercept 7 5 this may well be due to relative scarcity of station data in this subregion passing the quality control requirements sect 2 3 1 of the present study 3 4 regional meteoric water lines in the eastern and western mediterranean domain in the eastern sector of the region the current macro regional mediterranean model i displays a slightly higher slope around and between 6 8 and 6 9 compared to previous regional works for precipitation from the 1960s 6 3 gat and dansgaard 1972 but ii better agrees if all rain events from the 1990s are considered slope 8 ayalon et al 1998 the present model s highest intercept values scatter around 15 in the eastern mediterranean sector thus neither the slope nor the intercept reproduce the frequently cited benchmark values of the δ 2h 8 δ 18o 22 emmwl variant it should be noted that both parameters show a quite homogeneous pattern in this subregion supporting the derivation of a regional mwl the emmwl may well have proven itself to be a useful isotope hydrological benchmark but cannot be taken as an actual empirical relationship validly describing the meteoric waters in the eastern mediterranean following the fundamental rules of deriving meteoric water line s gat 2005 in the western mediterranean the presence of a regional mwl has been suggested with a slope of 8 and intercept 13 7 celle jeanton et al 2001 overarching a vast part of the area however the present model based on a much higher number of stations shows clear differences across the domain under consideration fig 2 the slope varies between 6 5 and 7 5 with the lowest values in algeria and the highest in iberia fig 2a while the intercept ranges from 2 5 to 6 5 with the lowest values seen again in algeria and the highest values near the gulf of genoa fig 2b the spatial heterogeneity of lmwl parameters based on precipitation from between 2000 and 2015 in the western mediterranean basin does not support the definition of a uniform regional mwl for this region further use of the western mediterranean meteoric water line as an isotope hydrological benchmark therefore seems to be untenable instead the use of i the local estimates from nearby stations with long term monitoring or in the absence of a nearby station ii estimates retrieved from the current interpolated product is recommended fig 2 4 conclusions in the study the long term precipitation stable isotopic data of 249 mediterranean precipitation monitoring stations were assessed to derive a revised and extended spatially continuous geostatistical model of the local meteoric water lines of the region for the early twenty first century in the chosen focus period 2000 2015 rigorous preprocessing consisted of iteratively assessing i the local indicator of spatial association together with ii d excess values to find outliers as a result 62 stations were retained with at least four years of data coverage ensuring a quality controlled dataset for the derivation of the lmwls with rma regression and the interpolation of the slope and intercept of the δ 2h δ 18o relationship across the region using random forest interpolation with buffer distance the slope and intercept of the lmwls ranged from 5 9 to 8 2 and 3 9 to 16 1 respectively the macro regional mediterranean model of δ 2h δ 18o covariance presented here provides spatially continuous predictions of the slope and intercept of the lmwl of modern post 2000ce precipitation updating the results of subregional studies from the twentieth century the model provides an opportunity to revisit the classical concepts of the emmwl and the wmmwl with regard to the former the coherent pattern of rather high intercept values in the eastern mediterranean reinforces the validity and utility of the concept of the emmwl for the 21st century too but in the west there was no homogeneous pattern of lmwl parameters on the basis of the results of the present model it is therefore suggested that the wmmwl should be abandoned as an isotope hydrological benchmark for modern precipitation the sub regional to regional differences observed in the interpolated lmwls highlight the importance of deriving fine scale spatially continuous estimations of the mwl and not aggregating data together from numerous stations that may be hundreds or even thousands of kilometers apart it is therefore advised that either local estimates from close stations with long term monitoring or in the absence of a nearby station estimates retrieved from the current interpolated product figs s1 and s2 should be used for the region author contributions z k conceived and designed the study with contribution from i g h i g h d e a e s and g sz performed the analysis d e and i g h produced the figures i g h and z k wrote the paper with contributions from d e a e s g sz and p v the flae approach was applied to the sequence of authors see https doi org 10 1371 journal pbio 0050018 all authors have read and agreed to the published version of the manuscript funding this research was supported by the national research development and innovation office under grants snn118205 and by the slovenian research agency arrs under grants n1 0054 and p1 0143 data availability statement publicly available datasets were analyzed in this study this data can be found at https nucleus iaea org wiser index aspx and in the papers cited see table s1 and sect 2 2 for further details declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the authors thank paul thatcher for his work on the english version the authors are grateful for christof christofi jasper wassenburg enrico selmo and roxana ionete for providing data the results of this study have been discussed within the cost action watson ca19120 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2022 128925 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 supplementary data 2 
2415,the covariance of stable hydrogen δ 2h and oxygen δ 18o isotopes in local precipitation the local meteoric water line lmwl serves as a benchmark in isotope hydrological or paleoclimatological applications however the isotope hydrometeorological monitoring network is still sparse in many parts of the mediterranean and the degree of spatial data coverage is insufficient to address current needs to remedy this weakness a spatially continuous interpolated geostatistical product of the lmwls of modern precipitation across the mediterranean has been developed the lmwls of the stations with data for more than four years between 2000 and 2015 were calculated using reduced major axis regression and then interpolated across the region using statistical and machine learning methods random forest interpolation with buffer distance and elevation gave the best performance in the out of sample verification and was thus used to derive the final interpolated product the slope and intercept of the lmwls ranged between 5 9 to 8 2 and 3 9 to 16 1 respectively a detailed comparison with previous local regional estimations showed that the model presented here concurs with those albeit with minor deviations in certain regions with the present results it then becomes possible to assess how well grounded the eastern and western mediterranean meteoric water lines emmwl and wmmwl for the 21st century are in the eastern mediterranean the current model shows a slope 6 9 and the intercept 15 concurring with local studies but does not reproduce the frequently cited benchmark values of the emmwl slope 8 intercept 20 the emmwl may be considered an idealized isotope hydrological benchmark useful in regional studies nonetheless it cannot be taken as a valid representation of the actual empirical description of the δ2h δ18o covariance of local precipitation in the eastern mediterranean defining a uniform regional mwl in the western mediterranean is not supported by the spatial heterogeneity of lmwl parameters based on the present estimations calling into question the utility of the wmmwl as an isotope hydrological benchmark keywords meteoric water line stable isotopes rma regression machine learning precipitation emmwl wmmwl abbreviations rma reduced major axis emmwl eastern mediterranean meteoric water line wmmwl western mediterranean meteoric water line data availability the source of the used data is explained in the data availability statement in the ms 1 introduction water phase changes occur over various spatiotemporal scales in the global hydrological cycle resulting in relative changes in the spatiotemporal distribution of stable water isotopes yoshimura 2015 the specific isotopic signatures of atmospheric processes such as evaporation condensation and deposition in precipitation are then imprinted in terrestrial water bodies allowing the application of isotopic data to hydrological studies gat et al 2001 the isotopic composition of hydrogen δ 2h and oxygen δ 18o of precipitation δ p is recognized as highly important natural tracer in the water cycle bowen et al 2019 fórizs 2003 gat 1996 gat et al 2001 describing the linear relationship between δ 2h and δ 18o in precipitation is a classical concept of hydrology gat 2005 and is called the meteoric water line mwl it is common practice to define a local meteoric water line lmwl for a given location as the best linear fit of all the precipitation data in δ space gat 2005 a global compilation of the δ 2h and δ 18o of fresh water provided a best fit line δ 2h 8 δ 18o 10 craig 1961 later called the global meteoric water line gmwl following an additional 30 years of data collection the database of global network of isotopes in precipitation gnip allowed the gmwl s revision based on long term amount weighted annual means as δ 2h 8 20 0 07 δ 18o 11 27 0 65 rozanski et al 1993 the gmwl is very useful in hydrology in understanding the origin of modern and ancient ground water and its interactions with surface waters the gmwl may be considered an amalgamation of many local meteoric water lines lmwl which in turn vary greatly in their slope and intercepts on regional or local scales kendall and coplen 2001 sharp 2017 these lmwls are often evaluated in the context of their deviation from the gmwl e g tappa et al 2016 which represents the expected equilibrium relationship where the slope is assumed to arise from the ratio of equilibrium fractionation factors putman et al 2019 the gmwl s slope of 8 reflects the average global relationship between δ2h and δ18o in precipitation while lmwl slopes documented at values ranging from 4 8 to 10 9 at 400 sites globally putman et al 2019 may indicate that at least one season is characterized by precipitation affected by nonequilibrium processes the intercept of the lmwls has also been documented as varying across the globe from 24 to 27 putman et al 2019 the lmwl represents the characteristic distribution of δ p and can if determined from long term observations serve as a benchmark in isotope hydrological applications such as the estimation of the infiltration period or the paleoclimatological evaluation of the groundwater isotope signals clark and fritz 1997 it is common practice however to estimate the lmwls from just short term investigations e g bottyán et al 2017 el ouali et al 2022 kattan 1997 liotta et al 2013 paar et al 2019 an approach which is prone to biasing by anomalous climatic events longinelli et al 2006 vreča et al 2007 vreča et al 2022 if at least 48 months data for a given station is used it can attenuate the possible noise caused by such extreme events and interannual variability in estimating the covariance of δ 2h and δ 18o putman et al 2019 at present the mediterranean region faces an ever increasing tendency towards water shortage garcía ruiz et al 2011 hoerling et al 2012 iglesias et al 2007 villani et al 2022 which will clearly amplify the potential for sociopolitical and economic disruption e g kelley et al 2015 and ecological problems cook et al 2016 isotope hydrological methods have great potential in the improvement of the scientific understanding of the processes governing the regional water cycle and so therefore to assist in knowledge based water resource management aggarwal et al 2005 in some parts of the mediterranean region the isotope hydrometeorological monitoring network was sparse in the past leading to the initiation of regional campaigns iaea 2005 and further subregional monitoring the spatial data coverage is however still insufficient for many scientific purposes isotope hydrological studies frequently use lmwls across the mediterranean tackling problems in subsurface brkić et al 2020 christofi et al 2020 hssaisoune et al 2022 koeniger et al 2017 liotta et al 2013 trabelsi et al 2020 túri et al 2020 vasić et al 2019 or surface hydrology el ouali et al 2022 gat and dansgaard 1972 serianz et al 2021 lmwls taken from relatively remote locations have recently started to grow in numbers e g boumaiza et al 2021 elghawi et al 2021 túri 2019 indicating a great demand for such reference data in the isotope hydrological research in the region therefore reliable estimates of the lmwls are also important at places where direct isotope meteorological monitoring is not in operation remote lmwls can indeed be misleading for local water resource applications e g serianz et al 2021 the lmwls might be very similar over extended regions allowing the definition of regional mwls pioneering studies have assessed the precipitation stable isotope composition on subregional scales in the broader mediterranean realm regional meteoric water lines for the eastern emmwl δ 2h 8 δ 18o 22 and the western parts wmmwl δ 2h 8 δ 18o 13 7 were established in the late 20th century and both continue to serve as widely used benchmarks in isotope hydrological studies fernández chacón et al 2010 giustini et al 2016 natali et al 2021 surić et al 2018 previously determined models can require revision because of the ongoing spatiotemporally varying changes in the hydroclimate which may be presumed to induce alterations in the isotope hydrometeorological signal a further source of difficulty is the existence of various methodological approaches to addressing the question of describing the linear relationship between the water stable isotopes across the mediterranean e g argiriou and lykoudis 2006 and these may be expected to result in significantly different estimates crawford et al 2014 marchina et al 2020 natali et al 2021 moreover the temporal resolution of the input data and most importantly the time period the data cover can cause significant differences in the estimates of the slope and intercept of the lmwls putman et al 2019 as has been specifically documented in certain sub regions of the mediterranean e g krajcar bronić et al 2020a vreča and malenšek 2016 the regional mwl was defined in the western mediterranean wmmwl on the basis of data from ten coastal stations with relatively short term coverage from the end of the twentieth century celle jeanton et al 2001 the origin of the eastern mediterranean meteoric water line emmwl is somehow more obscure in the eastern mediterranean it was found that the d excess a second order stable isotopic parameter defined as d δ 2h 8 δ 18o dansgaard 1964 has characteristically elevated values well above18 gat and carmi 1970 this observation for eastern mediterranean precipitation subsequently received reinforcement d 15 el asrag 2005 rindsberger et al 1990 to complicate the issue further decades later in gat 1996 this same observation was referred to as the eastern mediterranean mwl of d 20 gat and carmi 1970 regarding the slope of an eastern mediterranean regional meteoric water line there is no mention of it in gat and carmi 1970 a relationship between precipitation δ 2hand δ 18o samples has been documented for israel with slopes of 5 and 6 3 gat and dansgaard 1972 fig 3 therein a potential source of misunderstanding could be the first numeric appearance of the rather well known equation δ 2h 8 δ 18o 22 in relation with isotope data of surface water in the upper jordan valley fig 9 in gat and dansgaard 1972 this however clearly cannot be taken as a figure for precipitation representative of the eastern mediterranean furthermore rindsberger et al 1990 in sect 1 states the δd and δ 18o values of the precipitation in most cases follow a relationship such as δd 8 δ 18o d the so called mwl relationship which is clearly an oversimplification of the matter meanwhile fig 7a δ 2h vs δ 18o plot in rindsberger et al 1990 presents a reference line annotated as mwl d 22 without any underlying data or citation suggesting that this is just an arbitrarily chosen benchmark in that particular study at the turn of the twenty first century it was reported that rain events of 20 mm at a monitoring station in israel between 1995 and 1997 followed a trend with a slope of 8 and d excess of 20 to 30 ayalon et al 1998 this however cannot be considered an mwl since as noted above the lmwl is defined as the best linear fit of all the precipitation data in δ space gat 2005 it seems that some studies have taken it for granted that the slope is 8 and the intercept is 22 of the emmwl although these parameters were not obtained obeying the rules of how meteoric water lines should be derived see gat 2005 what is more further confusion regarding the mediterranean regional meteoric water lines may have originated from the occasional usage of ad hoc terminology and acronyms for example the mediterranean meteoric water line mmwl ayalon et al 1998 koeniger et al 2017 which is used to represent location s in the eastern mediterranean or the abbreviation emwl e g bajjali and abu jaber 2001 yüce 2005 such usage further increases the possibility of confusion over regional mwls in the present work the abbreviations emmwl and wmmwl are used exclusively to refer to the regional definitions a recent study has addressed the geographic variations in the slope of lmwls across europe focusing on the temperate and boreal regions of the continent lécuyer et al 2020 it does not however cover the mediterranean region thus the current work aims to provide a spatial extension of that analysis with respect to the slope of lwmls additionally the present study represents a methodological extension because the intercept of the lmwl is also evaluated moreover in doing so the performance of various interpolation methods classical statistical and machine learning with different set of predictors altogether 14 approaches is investigated in modeling the spatial distribution of the slope and intercept of the local meteoric water lines across the mediterranean taking into consideration the climatic and geographic context of the region 2 materials and methods 2 1 study area description the study area covers the mediterranean basin from north africa across southern europe to the middle east this area extends from 7 5 w to 36 7 e and from 29 9 n to the orogenic belt from the pyrenees through the southern alps to the carpathian chains fig 1 a the mediterranean climate of the region is characterized by temperate dry hot summers and humid winters the csa climate subtype in the köppen geiger climate classification system kottek et al 2006 warm dry summers csb are more frequent on the coasts close to the atlantic ocean in the west and the black sea in the east the southern part of the basin is dominated by arid hot and cold steppe conditions bsh bsk and arid desert conditions bwh especially south of 31 n under the influence of the sahara north of 41 n a temperate climate dominates without a dry season and with warm cfb and hot summers cfa especially around the black and adriatic seas the mediterranean basin is characterized by specific patterns of atmospheric circulation with dry and cold continental air masses that interact with a marine basin characterized by high evaporation rates and relatively high sea surface temperatures 20 c iaea 2005 such air sea interactions are important sites of cyclogenesis in the mediterranean bartholy et al 2009 kelemen et al 2015 compared to the rest of the european continent which is dominated by atlantic moisture the mediterranean has a more complex moisture source structure the primary source region being the mediterranean sea itself at least seasonally ciric et al 2018 previous subregional isotope hydrometeorological assessments have revealed that the variable physiographic and hydrometeorological factors act differently and result in a remarkable divergence in values of δ p between the different parts of the mediterranean basin fischer and mattey 2012 giustini et al 2016 hatvani et al 2020 hunjak et al 2013 consequently the δ 2h δ 18o relationship has also been found to display considerable subregional differences e g dotsika et al 2010 giustini et al 2016 vreča et al 2006 2 2 data used monthly δ p values were acquired from a total of 249 monitoring stations covering 1960 2020 primarily from the global network of isotopes in precipitation gnip with six stations updated with more recent data râmnicu vâlcea varlam et al 2021 zagreb krajcar bronić et al 2020a plitvice krajcar bronić et al 2020b ljubljana and portorož vreča et al 2015 vreča et al 2011 vreča et al 2008 vreča et al 2014 vreča et al 2022 and pisa natali et al 2021 table s1 in addition other local and regional networks were included 11 stations in sicily operating between february 2002 and march 2003 liotta et al 2006 6 stations february 1992 to december 1996 longinelli and selmo 2003 8 stations january 2002 december 2004 scattered across northern italy longinelli et al 2006 3 stations from the mt vulture region paternoster et al 2008 and 7 stations from tuscany natali et al 2021 in addition single records from forni di sopra 2005 2010 cervi et al 2017 and riva del garda from february 2007 to january 2008 longinelli et al 2008 data collected at 6 stations in lebanon between october 2012 and may 2013 koeniger and margane 2014 6 stations in hungary operating between january 2005 and november 2017 fórizs et al 2020 3 stations in croatia operating between may 2012 and september 2013 paar et al 2019 and one station between 2017 and 2019 marković et al 2020 dumbrava romania from april 2012 to july 2015 bojar et al 2017 16 stations in cyprus 2014 2017 christofi et al 2020 1 station in serbia 1992 1997 and 2003 2005 golobočanin et al 2007 and 2 short time series from morocco from june 2010 to november 2011 wassenburg et al 2016 in general the data gathered were unequally distributed in space fig 1a and time fig 1b until the mid 1980s the number of active precipitation monitoring stations was limited n 12 from the mid 1980s onwards their number rose progressively reaching about 50 by the turn of the millennium in the early 2000s owing to a coordinated research project of the iaea iaea 2005 the network was quite extensive for instance in 2002 3 the number of active stations peaked at over 80 while the average number of annual δ p pairs was 60 at that time fig 1b in the 2000s the same number of δ 2h and δ 18o data were generally available although in certain cases the δ 18o records were more abundant to maximize the spatiotemporal coverage of the δ p values available from the study region a focus period of 2000 2015 was chosen this period was characterized by an annual average number of stations 31 providing data in any given year the only exception was 2007 in which the average number of active stations was only 30 2 fig 1b nevertheless the focus period chosen 2000 2015 was not cut in half on account of this one year 2 3 methodology 2 3 1 data preprocessing as a first step local moran s i statistics moran 1948 were calculated to investigate the correlations within different spatial units and their surrounding spatial lags up to 501 km this was done for each month from january 2000 to december 2015 for both δ p using moran scatterplots anselin 1996 classifying the spatial autocorrelation moran is of the stations into four types and enabling an advanced screening for outliers if the moran scatterplot suggested a possible error the d excess values d e x c e s s δ 2 h 8 δ 18 o dansgaard 1964 were also compared between the neighboring if the d excess values of the possible outlier deviated inexplicably from its neighbor s e g diff 10 the δ p values were dropped cf erdélyi 2023 this approach is more complex than that employed in previous studies which used a static d excess cutoff threshold bowen 2008 nelson et al 2021 outside of which δ p values were excluded without any consideration of the spatial relationship as a result of this approach δ p values from patras dec 2000 ciudad real feb 2002 antalya mar 2003 and murcia jan 2004 were dropped in all cases the d excess was 20 in addition curiously in 2010 the exact same δ p values were recorded at the ankara and antalya stations and it was not possible to trace back the origin of the gnip database error or decide to which station the values belong thus these were excluded from the analyses next the monitoring stations were classified into three quality categories qc according to the number of data recorded at each one during 2000 2015 stations belonging to qc1 had to have δ 2h δ 18o pairs from 48 months as this was the amount of data required for any lmwl calculation for it to take on the characteristics of the long term distribution without bias caused by natural noise putman et al 2019 in the study area in high summer precipitation may not fall for months thus an additional quality category was set up qc2 had to have data from at least four years covering not 16 months because below this threshold the use of rma regression frequently resulted in insignificant relationships see sect 2 3 2 the stations not meeting any of the criteria above qc3 were excluded from the analysis the possibility was entertained that stations situated close to each other within 10 km could be merged to improve the input data for lmwl estimation since certain monitoring sites had been relocated within a short distance or restarted at a nearby locality after a multiannual halt in monitoring the datasets for such nearby stations were merged table s1 the coordinates of the one functioning longest from among those merged was used in the final dataset in all cases the inter station distance of the stations forming these merged datasets was smaller than 8 km the final quality controlled dataset contained 42qc1 and 20qc2 stations of which 11 had been merged 2 3 2 reduced major axis rma regression traditionally the lmwls are defined employing ordinary least squares regression ols or reduced major axis rma regressions iaea 1992 the conceptual difference between the two approaches is that while ols regression minimizes the sum of the squared deviations of the predicted values rma minimizes both the vertical and the horizontal distances between each point and the regression line i e it uses diagonal residuals that have slopes opposite to the slope of the regression line clarke 1980 since rma is less prone to outliers and more importantly the relationship of the two assessed variables can be described by physical laws carroll and ruppert 1996 the application of rma is more appropriate to the definition of the lmwl crawford et al 2014 putman et al 2019 a more advanced option could have been to use precipitation weighted rma pwrma regression crawford et al 2014 but that would require precipitation amounts recorded for all δ p values a requirement not met in the present case moreover studies support that the difference between slope and intercept values estimated by rma and pwrma agree within error bounds boschetti et al 2019 krajcar bronić et al 2020a therefore in the present study rma regression was applied to raw monthly δ p values using the lmodel2 package legendre 2018 in r r core team 2019 with 2 000 permutations to obtain the significance values 2 3 3 interpolation techniques three major types of interpolation techniques were employed in the study with different sets of predictors to obtain a spatially continuous map of the intercept and slope of the rma regression inverse distance weighting idw a traditional interpolation method webster and oliver 2008 and two machine learning ml methods specifically random forest rf li et al 2011 liu et al 2012 and support vector machine svm cortes and vapnik 1995 were used idw interpolation is a method in which each point of estimation is calculated as the average of nearby sample values weighted by their distance from the estimation point it does not make assumptions about spatial relationships except for the basic assumption that nearby points are expected to be more closely related to the value at the estimation location than distant points two alternatives were trialed linear weighting power α 1 idwp1 and nonlinear weighting power α 2 idwp2 rf is a machine learning algorithm in the procedure a combination of a series of tree structure predictors is assessed here each tree depends on the values of a random vector sampled independently with the same distribution for all trees in the forest the generalization error for forests converges to a limit as the number of trees in the forest increases the generalization error of a forest of tree classifiers depends on the strength of the individual trees in the forest and the correlation between them breiman 2001 its predictions are based on the average results of the decision trees which use bootstrap sample bagging to eliminate the possibility of over fitting for details see e g biau and scornet 2016 breiman 2001 prasad et al 2006 as with rf svm is another frequently used supervised machine learning technique for classification and regression purposes however the theory behind svm is different to that of rf it relies on the application of kernel functions which also means that svm is a nonparametric technique in finding a function that deviates from an observation by a value not greater than a given threshold value for each observation and at the same time is as flat as possible as a consequence the function fitted by svm is the hyperplane that has the maximum number of observations cortes and vapnik 1995 six combinations of predictors which can influence the stable isotopic composition of precipitation consequently the slope and intercept of the lwmls in the region were considered in the case of the ml algorithms latitude longitude in web mercator epsg 3857 köppen geiger climate class codes category variable with the approaches denoted as rfkg svmkg latitude longitude and elevation ele denoted as rfele svmele elevation was incorporated since the local orographic features may significantly change the isotopic composition of precipitation in the mediterranean liotta et al 2006 liotta et al 2013 latitude longitude köppen geiger climate class codes and elevation denoted as rfkg ele svmkg ele the distance matrix of the monitoring stations and again the köppen geiger codes following the rfsp procedure of hengl et al 2004 with the approaches denoted as rfsp kg and svmsp kg the distance matrix of the monitoring stations and elevation denoted as rfsp ele and svmsp ele the distance matrix of the monitoring stations the köppen geiger climate class codes and elevation denoted as rfsp kg ele and svmsp kg ele the idw interpolation was performed using golden software surfer 15 and gs 10 in the rf approach the value of the nodesize and mtry parameters was selected automatically using the tune command of the randomforestsrc package ishwaran et al 2021 ishwaran et al 2008 in r r core team 2019 while for rfsp these were chosen as 5 and 10 for the slope and intercept parameters respectively using the ranger package wright and ziegler 2015 the svm modelling was carried out using the caret kuhn et al 2020 and e1071 meyer et al 2019 r packages 2 3 4 validation the results of the different interpolation schemes were validated by forming two pairs of training and validation datasets validation stations were only selected from those countries where there was more than one station available not considering merged stations the validation set1 vs1 n 10 consisted of one randomly chosen station from each country preferably from its q2 station s validation set2 vs2 n 10 consisted of the first stations in alphabetical order from each country table s1 the reason the stations were chosen from different countries was to avoid biased validation results that might arise due to some spatial clustering the sets of stations used in the actual interpolation were complementary to vs1 and vs2 and were referred to as set 1 and set 2 respectively after applying the interpolation methods to estimate the slope and intercept of set1 and set2 the squared point differences for stations in vs1 and vs2 were calculated the performance of the 14 interpolation schemes was primarily evaluated using the squared errors of vs1 and vs2 while visual inspection of the interpolated maps was employed to check for systematic interpolation errors artefacts etc first and foremost the median of the squared errors was taken into consideration rather than the mean since latter is much more sensitive to outliers wilcox 2003 which is a crucial strength in the case of a relatively small sample size as with the present one 3 results and discussion 3 1 local meteoric water lines in modern precipitation across the mediterranean in the estimations presented here the point values of the stations and the pattern seen on the interpolated maps are compared with previous studies of the region the slope of the δ 2h δ 18o relationship varied between 5 9 and 8 3 the lowest values some even falling below 7 were observed in the east and in the western parts and n africa the highest values exceeding 8 in the north in the alpine foothills of italy fig 2 a considering subtropical arid or seasonally hot and dry regions köppen geiger climate class b and cs 40 of the slopes obtained fall within the typical range 5 to 7 reported for these climate regions in a global assessment putman et al 2019 the rest of the stations assigned to these climate classes had slightly steeper slopes max lake massaciuccioli 7 9 in zone csa which is still not unusual in these climates considering humid temperate and seasonally snow dominated regions köppen geiger climate class cf and d 77 of the obtained slopes fall within the typical range 7 to 8 for these climate regions reported in a global assessment putman et al 2019 the remainder is in the vicinity of the southern alps where as previously mentioned the highest slope values are observed in the subtropical arid or seasonally hot and dry regions köppen geiger climate classes b and cs almost all 90 of the intercept values fall within the typical range 0 to 15 reported for these climate regions in putman et al 2019 the outliers comprise mainly stations with low intercepts in central iberia in the case of humid temperate and seasonally snow dominated regions köppen geiger climate classes cf and d only 14 of the intercept values obtained fall within a typical range 20 to 5 putman et al 2019 this discrepancy may be due to the differing extent of various colder climate zones incorporated into the studies it should be noted that the stations studied here are characteristically rather humid and experience less snowfall fig 1 and table s1 whereas snowfall tends to result in negative intercepts putman et al 2019 the large scale spatial patterns fit well into the estimations made for a continental transect across europe where slopes ranged from 6 to 10 lécuyer et al 2020 in fact from the western margin of the area studied up to the adriatic 12 e a similar longitudinal trend is observed as that reported across the temperate and boreal regions of europe reaching a slope of 8 lécuyer et al 2020 fig 4 therein further eastward however while the slope of the relationship assessed from the continental transect continues to increase up to 9 lécuyer et al 2020 in the case of the mediterranean it declines the spatial pattern of the intercept on the other hand shows a more complex pattern in central iberia the intercept is 3 5 while the coastal parts have values ranging between 2 7 and 6 then after a gradual increase higher values are seen surrounding the adriatic sea peaking at 10 in northeastern italy and slovenia fig 2b matching the area of the steepest slopes fig 2a eastward from the adriatic a gradual decrease is observed around 17 e intercepts of 7 5 are observed to decrease to around 5 20 23 e a subregional pattern is seen surrounding the black sea where intercept values are 3 2 fig 1a it is a common climatic feature of the low intercept areas both central iberia and this particular region that the summer is characterized by very dry conditions table s1 an explicit contrast is observed in the southeastern sector of the mediterranean basin where altogether the highest 16 intercept values are to be found fig 2b in the northern part of africa the number of stations used to estimate the lmwls and interpolate those is smaller and much less continuous compared to the other regions in the mediterranean fig 2 therefore attention should be paid to these points when the estimations for this specific sub region are used 3 2 performance evaluation of the spatially continuous estimations of the lmwls across the mediterranean region in choosing the best performing interpolation method the median the upper quartile and the interquartile interval obtained squared differences and the question of how prone the method was to showing extreme outliers were all considered if the number of squared differences classified as extreme outliers fig 3 is 10 practically n 2 for either the slope or the intercept said method is discarded this was true for all the svm approaches regardless of the predictors applied since the svm methods gave the most extreme outliers in the case of the slope and intercept those were not considered in the following it was also determined that there was no significant difference either between the medians as calculated using mood s independent samples median test mood 1950 asymptotic significance p 549 and 72 for the slope and intercept respectively or in the distribution of the squared errors between the three models with the best performance based on independent samples using the kruskal wallis test kruskal and wallis 1952 which yielded values of h 2 663 p 718 for the slope and h 2 82 p 644 the inverse distance approaches performed worst in the case of the slope regarding the median and the upper quartile fig 3a and regarding the median in the case of the intercept fig 3b therefore the rf approaches with the different combination of predictors seemed the most promising rfsp ele was the only combination that gave the most promising results for the slope and intercept as well this was not true for the other options because those gave incoherent errors for some the squared errors were higher for the slope while indicating relatively smaller errors for the intercept and vice versa fig 3 thus to be consistent the random forest approach with buffer distance and with the inclusion of elevation as predictors rfsp ele was chosen to provide the best interpolation for the slope fig 2a and the intercept fig 2b of the mediterranean lwml 3 3 spatial patterns and regional differences comparing not only the estimated point values sect 3 2 but the spatial trend seen in the spatially continuous interpolated products fig 2 and figs s1 and s2 it was observed that these concur with the findings documented in numerous studies from the region over the decades there are however some differences that are explained later in this section a recent regional study described the lmwl across nw iberia on the basis of a small regional monitoring network moreno et al 2021 partially overlapping with the chosen timeframe 2010 2012 but not meeting the quality criteria described in sect 2 3 1 apart from barcelona and mallorca the stations used in that study were not included in the present analysis hence offering the possibility of an independent comparison to assess the interpolated lmwl parameters along the cantabrian coast the difference in the slope between the presented model and a reference study moreno et al 2021 is 0 6 this may be because the region is on the border of the present study area where the slope values were merely extrapolated in contrast to this the slope does represent quite a good match with the other stations moreno et al 2021 with an average difference of 0 12 in an iberian regional reference study the intercept ranges between 1 and 5 moreno et al 2021 which is similar to the values in the present estimations fig 2 b heading east the regional trend previously documented across the apennine peninsula giustini et al 2016 is in harmony with the pattern documented here a continuous decrease in slope from 8 to 7 and intercept from 9 5 to 6 from north to south fig 2a specifically the slope parameter displays a good match over the whole region fig 2a while the values of the intercept are smaller fig 2b compared to those in a reference study giustini et al 2016 if the present estimations are compared with the lmwl of a more localized study from ne italy masiol et al 2021 the slope values show a good match while the intercept estimated in the present work is slightly higher by 1 on the se coast of the gulf of genoa fig 1a a regional study estimated a slope of 7 28 and intercept 7 3 natali et al 2021 which gave a rather good match with the presented modelled values fig 2 it should be noted however that two out of the four central italian stations were used in the interpolation exercise after preprocessing therefore this comparison cannot be taken as fully independent similar slope and intercept values are observed across sicily compared to the sub regional outcrop of the model for the apennine peninsula giustini et al 2016 and a better match is seen in the highly elevated nw coastal stations of sicily when compared to a sub regional model of the island liotta et al 2006 compared to a study assessing the regional lmwls in sicily the presented slope values are slightly higher and so are the intercept values 1 liotta et al 2013 although this difference might come from the relatively short period covered jul 2004 jun 2006 which does not meet the necessary four year criterion putman et al 2019 an independent dataset from eastern serbia incorporating three stations overlaps with the study period vasić 2017 the specific locations of the stations used in that reference work were not documented and the temporal coverage was not continuous thus these could only be used with reservations for comparison and are not included in the modeling the slope of individual stations n 3 ranged from 6 6 to 7 2 with the intercept spanning 2 4 to 4 8 vasić 2017 the present model provided a spatially much smoother and somewhat higher estimation for the slope and intercept for the corresponding area with values of 7 4 and 5 3 respectively fig 2 probably due to their applied method ols and temporal gaps and in the reference data vasić 2017 considering the southern sector of the balkan peninsula reported lmwls display an unusually large scattering in slope and intercept from 5 5 to 9 2 and from 1 2 to 21 respectively even for locations close to each other in southern greece dotsika et al 2010 on the contrary the macro regional mediterranean model presented here displays much smoother and hence realistic estimates of the lmwl parameters heading further east the slope and intercept indicate a rather meridional trend across greece the slope gradually decreases from 7 3 to 6 9 going west to east across greece fig 2a while the intercept decreases from the albanian greek border 5 9 to 3 also towards turkey fig 2b for the final subregional comparison in cyprus a lmwl δ 2h 6 58 0 13 δ 18o 12 64 0 91 was derived in a recent study from the mean precipitation weighted values of 16 monitoring stations christofi et al 2020 updating older findings based on many fewer stations δ 2h 5 75 δ 18o 3 6 jacovides 1979 taking the previous estimations into account the present model s slope for the area 6 8 agrees well with the most recent one while the intercept 7 is below the recent estimate but definitely higher than the older study s intercept value regarding north africa a study combining rainfall events and monthly data from 17 monitoring stations defined two lmwls ait brahim et al 2016 fig 5 therein the estimated parameters of which are both higher than those yielded by the present estimation slope 7 intercept 7 5 this may well be due to relative scarcity of station data in this subregion passing the quality control requirements sect 2 3 1 of the present study 3 4 regional meteoric water lines in the eastern and western mediterranean domain in the eastern sector of the region the current macro regional mediterranean model i displays a slightly higher slope around and between 6 8 and 6 9 compared to previous regional works for precipitation from the 1960s 6 3 gat and dansgaard 1972 but ii better agrees if all rain events from the 1990s are considered slope 8 ayalon et al 1998 the present model s highest intercept values scatter around 15 in the eastern mediterranean sector thus neither the slope nor the intercept reproduce the frequently cited benchmark values of the δ 2h 8 δ 18o 22 emmwl variant it should be noted that both parameters show a quite homogeneous pattern in this subregion supporting the derivation of a regional mwl the emmwl may well have proven itself to be a useful isotope hydrological benchmark but cannot be taken as an actual empirical relationship validly describing the meteoric waters in the eastern mediterranean following the fundamental rules of deriving meteoric water line s gat 2005 in the western mediterranean the presence of a regional mwl has been suggested with a slope of 8 and intercept 13 7 celle jeanton et al 2001 overarching a vast part of the area however the present model based on a much higher number of stations shows clear differences across the domain under consideration fig 2 the slope varies between 6 5 and 7 5 with the lowest values in algeria and the highest in iberia fig 2a while the intercept ranges from 2 5 to 6 5 with the lowest values seen again in algeria and the highest values near the gulf of genoa fig 2b the spatial heterogeneity of lmwl parameters based on precipitation from between 2000 and 2015 in the western mediterranean basin does not support the definition of a uniform regional mwl for this region further use of the western mediterranean meteoric water line as an isotope hydrological benchmark therefore seems to be untenable instead the use of i the local estimates from nearby stations with long term monitoring or in the absence of a nearby station ii estimates retrieved from the current interpolated product is recommended fig 2 4 conclusions in the study the long term precipitation stable isotopic data of 249 mediterranean precipitation monitoring stations were assessed to derive a revised and extended spatially continuous geostatistical model of the local meteoric water lines of the region for the early twenty first century in the chosen focus period 2000 2015 rigorous preprocessing consisted of iteratively assessing i the local indicator of spatial association together with ii d excess values to find outliers as a result 62 stations were retained with at least four years of data coverage ensuring a quality controlled dataset for the derivation of the lmwls with rma regression and the interpolation of the slope and intercept of the δ 2h δ 18o relationship across the region using random forest interpolation with buffer distance the slope and intercept of the lmwls ranged from 5 9 to 8 2 and 3 9 to 16 1 respectively the macro regional mediterranean model of δ 2h δ 18o covariance presented here provides spatially continuous predictions of the slope and intercept of the lmwl of modern post 2000ce precipitation updating the results of subregional studies from the twentieth century the model provides an opportunity to revisit the classical concepts of the emmwl and the wmmwl with regard to the former the coherent pattern of rather high intercept values in the eastern mediterranean reinforces the validity and utility of the concept of the emmwl for the 21st century too but in the west there was no homogeneous pattern of lmwl parameters on the basis of the results of the present model it is therefore suggested that the wmmwl should be abandoned as an isotope hydrological benchmark for modern precipitation the sub regional to regional differences observed in the interpolated lmwls highlight the importance of deriving fine scale spatially continuous estimations of the mwl and not aggregating data together from numerous stations that may be hundreds or even thousands of kilometers apart it is therefore advised that either local estimates from close stations with long term monitoring or in the absence of a nearby station estimates retrieved from the current interpolated product figs s1 and s2 should be used for the region author contributions z k conceived and designed the study with contribution from i g h i g h d e a e s and g sz performed the analysis d e and i g h produced the figures i g h and z k wrote the paper with contributions from d e a e s g sz and p v the flae approach was applied to the sequence of authors see https doi org 10 1371 journal pbio 0050018 all authors have read and agreed to the published version of the manuscript funding this research was supported by the national research development and innovation office under grants snn118205 and by the slovenian research agency arrs under grants n1 0054 and p1 0143 data availability statement publicly available datasets were analyzed in this study this data can be found at https nucleus iaea org wiser index aspx and in the papers cited see table s1 and sect 2 2 for further details declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the authors thank paul thatcher for his work on the english version the authors are grateful for christof christofi jasper wassenburg enrico selmo and roxana ionete for providing data the results of this study have been discussed within the cost action watson ca19120 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2022 128925 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 supplementary data 2 
2416,solute transport in fracture is easy to diffuse into the matrix due to the permeability of the matrix the quantification of solute concentration is particularly important during diffusion and is a challenge for the management of pollutants in a fracture matrix system in this paper sodium chloride as solute the geoelectrical technology was combined with high density electrical method and conductivity acquisition method to conduct a series of sandbox experiments in the center of the sandbox is a fracture and on both sides of the fracture is the matrix the fracture and matrix in the sandbox form a fracture matrix system loading flushing process of sodium chloride solution in fracture matrix system was monitored in real time and non destructive the effect of matrix porosity and flow velocity on solute transport in fracture matrix system was investigated the results showed that 1 mass transfer rate coefficient α and fracture matrix porosity ratio β and tailing exponent of residence time distribution ω were quantified by pairing bulk electrical conductivity bec and fluid electrical conductivity fec without the requirement of inverse model calibration in contrast the single electrical method still lacks resolution or is not representative in determining solute transport parameters in fracture matrix system 2 the matrix porosity had a significant effect on solute transport in fracture matrix system with the increase of porosity the mass transfer rate coefficient α increased and the residence time in the matrix decreased 3 an increase of flow velocity led to a decrease of residence time in the matrix and an increase in mass transfer rate coefficient α the solute transport in fracture matrix system can be quantified by electrical conductivity hysteresis the results can provide a basis for the management of solute transport in fracture matrix system keywords fracture matrix system mass transfer matrix porosity flow velocity geoelectrical technology data availability data will be made available on request 1 introduction the fundamental understanding of solute transport process in fracture geological systems is critical for developing many geoengineering strategies geological sequestering of fluid in geologic repositories e g storing radioactive waste and carbon dioxide bodin et al 2003 roubinet et al 2012 however accurate characterization and prediction of solute transport in fractured rock is particularly challenging owing to the extreme heterogeneities of flow velocity and matrix porosity dou et al 2018a b chen et al 2022 viswanathan et al 2022 over the past several decades the hydrological and environmental communities have extensively highlighted the complexity of the solute transport process in fractured rock system cardenas et al 2007 chen et al 2021 qian et al 2011a rezaei and pirvand 2022 rezaei et al 2016 wang et al 2022 zhan et al 2009 zhou and zhan 2018 zhou et al 2017 zhu and zhan 2018 many studies have shown that preferential flow in rock fracture promotes fast transfers while diffusion from rock fracture into matrix can results in the occurrence of solute heavy tailing hyman et al 2019 the fractured porous medium contains a less mobile rock matrix block and mobile fracture and each part has its own specific transport characteristics sonnenborg et al 1999 tang and aral 1992 the fracture typically has relatively high permeability and low storage capability while the matrix usually has low permeability and high storage capability moleme and gomo 2018 zhou et al 2017 when the solute enter the fractured rock the plume can penetrate from fracture to matrix moreno et al 1997 solute transport in fractures matrix system is governed primarily by advection and diffusion cvetkovic and frampton 2012 if the diffusion coefficient or contact time between solute and matrix is minimal enough matrix diffusion can be ignored however on a long time scale matrix diffusion often acts as a significant mechanism in the disposal of chemical and nuclear wastes neretnieks 1980 roubinet et al 2012 a contaminant in the matrix can be slowly released into the fracture by diffusion and trapped in the fracture matrix system for a long time amin et al 2012 which leads to excessively long transport time and anomalous solute breakthrough curves btcs with heavier tailing behavior carrera 1993 harvey and gorelick 2000 levy and berkowitz 2003 hence determining the factors that affect the interaction of fracture and matrix and quantifying solute transport in fracture matrix system is important as they regulate the presence of secondary pollutant sources that make remediation procedures slow and inefficient adamson et al 2016 falta and wang 2017 haggerty and gorelick 1994 characterizations of solute transport in fracture matrix systems at laboratory or field scales are extremely challenging due to the difficulty in obtaining mass and concentration data directly from the matrix houseworth et al 2013 the previous studies on solute transport process in fracture matrix system focus on numerical modeling rezaei and pirvand 2022 zhou and zhan 2018 zhou et al 2017 zhu and zhan 2018 transport in the fracture matrix system has been highly simplified in semi analytical models by a single fracture roubinet et al 2012 zhou et al 2017 zhu et al 2016 transport in parallel multi fractures is usually restricted to unfilled fractures in semi analytical models amin et al 2012 chen and zhan 2018 in reality fractures are filled with unconsolidated geological material bradner and murdoch 2005 wealthall et al 2001 the filled fracture behaves differently compared to the open fracture for instance a previous study reported that the propagation front in the filled fracture is smoother than those in open fractures lunati et al 2003 solute transport in single filled fracture cannot be calculated using the advection dispersion equation ade qian et al 2011b a large number of investigations indicate that ade performs poorly in both filled and open fractures and cannot explain the anomalous solute transport behavior e g heavier tailing of the btc dual domain mass transfer ddmt models provide a satisfactory explanation van genuchten and wierenga 1976 previous research has shown that ddmt models capture abnormal transport better than ade baratelli et al 2014 briggs et al 2018 swanson et al 2015 when velocity differences between mobile and less mobile regions are minor ddmt models have been successfully used baratelli et al 2010 despite the success of ddmt models in matching observations it is difficult to measure the parameters directly and there is no lab scale or field scale experimental verification because it is usually much more challenging to draw fluid samples from the less mobile region matrix or aquitard moysey 2021 zhou and zhan 2018 therefore it is difficult to accurately quantify anomalous transport which can persist in the less mobile region the geoelectrical monitoring technique provides a unique advantage in investigating the storage of contaminants in fractured rock due to the ability of electrical signals to pass through both the mobile and less mobile domains briggs et al 2013 day lewis and singha 2008 2017a b singha et al 2007 this geoelectrical monitoring technique has not been applied in fracture matrix system however the application of traditional geoelectric monitoring method alone can only estimate the porosity of fractured rock roughly but cannot quantify the mass transfer coefficient between fracture and matrix therefore in this paper we combined geoelectrical monitoring method with high density electrical method bulk conductivity method and electrical conductivity acquisition method fluid conductivity method to quantify the influence of matrix porosity and mass transfer coefficient on the solute and quantify the mass exchange process between the fracture and matrix in fracture matrix system a fracture with three filled porosities is conducted in a sandbox model to simulate the solute transport process between fracture and matrix the sandbox model was made by plexiglass plates in the center of the sandbox is a fracture filled with coarse grained quartz and on both sides of the fracture is the matrix filled with fine grained quartz the fracture and matrix in the sandbox form a fracture matrix system the loading and scouring process of sodium chloride solution in fracture matrix system was monitored in real time and nondestructively the current work aims 1 to directly quantify solute transport in a fracture matrix system using the synthesis of electrically conductive tracers and a geoelectrical monitoring method 2 to examine the effects of flow velocity on solute transport 3 to investigate the effect of matrix porosity on solute transport 2 materials and methods 2 1 experimental design and tracer experiments a sandbox 500 138 20 mm l w h was made by plexiglass plates in the center of the sandbox is a fracture and on both sides of the fracture is the matrix the fracture and matrix are separated by a plexiglass plate with evenly distributed holes slightly less than the matrix particle size the fracture and matrix in the sandbox form a fracture matrix system low and high permeability zones simulate matrix and fracture in a subsurface environment in a fracture matrix system the fracture is filled with coarse quartz sands with an average diameter of 3 mm minhai environmental technology co henan china coarse grained quartz sand was utilized to represent the filled fracture due to its high hydraulic conductivity which formed preferential flow paths of groundwater and contaminant during the experiment the filled fracture was kept unchanged the matrix with different porosities were prepared with three quartz grain sizes of 0 24 0 15 and 0 092 mm table 1 displays the material of the fracture matrix system fig 1 shows a schematic diagram of the physical model consisting of the fracture matrix and electrical monitoring parts the fracture matrix consists of a high permeability fracture and a low permeability matrix and two plexiglass tanks for recharge and discharge the first tank contains a water filled zone 200 120 20 mm at the inlet to maintain a uniform inlet flow while the second one was identical to the first the fracture dimensions are 500 20 20 mm the matrix 500 59 20 mm with the same properties was distributed on the two sides of the fracture since gravity is not taken into account in this case the fracture matrix part is vertical sodium chloride nacl was selected as an ionic tracer a filter paper was located at the inlet and outlet of the fracture device to ensure that no quartz sand escaped and that the nacl solution was evenly distributed nacl solution was injected upward into the fracture from the bottom of the recharge tank by a pump before the experiment 0 25 g l fec about 200µs cm of nacl solution was continuously injected at a rate of 5 ml min to ensure the balance between the fracture and the matrix region and then 0 5 g l fec about 1200 µs cm nacl solution was injected instantaneously then return to the initial 0 25 g l solution fracture matrix system of tracer was injected to allow the fracture and matrix dominants to reach equilibrium indicated fluid electrical conductivity fec and bulk electrical conductivity bec no longer change in time 2 2 geoelectrical measurement this study measured the fec and bec during the experiment at 250 mm from the recharge tank the fec was determined using conductivity probes of conductivity acquisition method djs 1c inesa scientific instrumentco ltd china located at the center of the fracture matrix part such as the bec electrode array fig 1a the bec was collected using a wenner alpha electrode configuration array of high density electrical method which was obtained utilizing ert21s nanjing geozhou exploration technology company limited china in the wenner alpha electrode configuration array a total of four electrodes were involved the outer two electrodes a and b were used as current and the inner two electrodes m and n were used as potential electrodes fig 1a four electrodes were arranged on one side of the sandbox model spaced 1 5 cm apart the bulk electrical resistivity ρ b is defined as the ratio of potential difference δ v to intense current i multiplied by the coefficient k of the device the electrical resistivity value was determined using eq 1 yang et al 2021 1 ρ b k δ v i the coefficient of the device k was calculated according to eq 2 2 k 2 π 1 am 1 an 1 bm 1 bn where am an bm and bn are the distances between electrodes mm the bec σ b was determined using the bulk electrical resistivity ρ b according to eq 3 3 σ b 1 ρ b the electrical monitoring method was performed at 55 s sampling intervals in order to compare the bec and the fec measurements a petrophysical model is typically required typically the fec and bec are linked using archie s law archie 1942 where the mobile and less mobile production concentrations fec are converted into bec singha et al 2007 σ b as follows 4 σ b θ m θ lm q 1 θ m σ m θ lm σ lm where σ b is the measured bec θ m is the mobile area porosity σ m is the ec of the mobile θ lm is the the less mobile porosity σ lm is the ec of the less mobile porosity and q is the cementation exponent assumed as 1 7 for saturated sand briggs et al 2018 2 3 the dual domain mass transfer ddmt model the simplest one dimensional ddmt model can be written as follows van genuchten et al 1977 5 θ m c m t θ lm c lm t θ m d m 2 c m x 2 v m θ m c m x 6 θ lm c lm t α c m c lm where θ m and θ lm are the porosities of the mobile and less mobile domains respectively c m and c lm are the solute concentrations of the mobile and less mobile domains m 2 t respectively d m is the spatially constant dispersion coefficient l 2 t v m is the average pore water velocity l t α is the mass transfer rate coefficient t 1 and t is the time t 2 4 residence time distribution rtds the presence of matrix porous in the fracture matrix system can lead to the tail of btcs in order to characterize the tail of btcs the residence time distribution rtds an effective metric developed by the nonlocal theory dou et al 2018a b zhang et al 2022 was calculated for the normalized solute transport under different flow velocity conditions the rtds can be derived from the derivative of btcs for the instantaneous step injection yielding the resident concentration time series and rtds can be calculated as wang and bayani cardenas 2017 7 r t d c i dt where c i is the concentration obtained in response to the instantaneous injection the btcs can be converted from an instantaneous injection to step one yu et al 1999 8 d c i dt c s where the c s is the concentration obtained in response to the step injection 2 5 less mobile porosity estimation specific fec and bec were plotted over time for generating the btcs and the hysteresis curve was determined using the concentration space between the fec and bec the hysteresis curve was used to calculate the less mobile mobile porosity ratio β and the mass transfer rate coefficient α between the less mobile and the mobile domains generally β can be graphically estimated using the hysteresis curves inflection points as shown in fig 2 a briggs et al 2014 and can be calculated as follows 9 β σ b 3 σ b 0 σ b 2 σ b 3 where σ b 0 is the bec value at the hinge points under equilibrium conductions before injection σ b 2 is the bec value associated with the inflection point under equilibrium conductions after injection and σ b 3 is the bec value at the flush phase point briggs et al 2014 this assumption is more valid in this method for the flush limb of the hysteresis curve when the less mobile and mobile zones are parallel electrical conductors day lewis et al 2017a b therefore σ b 0 σ b 2 and σ b 3 are used for the graphical analysis of β 2 6 mass transfer rate coefficient estimation in order to estimate the classic mass transfer rate coefficient α ma and zheng 2011 the semi analytical approach was used which is presented by briggs et al 2018 in this approach a second order polynomial was used to fit the temporal fec σ m curve for the mobile domain before reaching the tracer injection plateau fig 2b 10 g t a t 2 b t c where a b and c are constants the fluid sampling method can be used to measured σ m described in eq 4 it is possible to approximate the time series of σ m as it approaches equilibrium with the tracer injection concentration using a differentiable function for instance a second order polynomial in this case eq 4 can be rewritten as follows 11 σ b θ m θ lm q 1 θ m a t 2 b t c θ lm σ lm by taking the derivative of eq 4 with respect to time the following equation will be derived 12 σ b t θ m θ m θ lm q 1 2 a t b θ lm θ m θ lm q 1 φ σ lm φ t substituting the transport equation for less mobile concentration of σ lm t it can be obtained by solving eq 4 13 σ b t θ m θ m θ lm q 1 2 a t b α θ m θ lm q 1 σ m σ lm by solving eq 4 for σ lm a single ordinary differential equation eq 14 can be derived when substituting the polynomial expression for σ m 14 σ b t θ m θ lm q 1 θ m 2 a t b α a t 2 b t c σ b θ m θ lm q 1 θ m a t 2 b t c θ lm the initial conditions for bec and fec are identified experimentally and eq 14 is fitted to the data using a nonlinear regression that identify the best fitting mass transfer parameter α briggs et al 2014 3 results 3 1 flow characteristics fig 3 depicts hydraulic experimental data the linear darcy s law accurately describes the relationship between flow velocity and hydraulic gradient of matrix 1 fig 3a however this relationship is fig 3b and c nonlinear for matrices 2 and 3 specifically darcy s equation j av with constant a can almost precisely fit the hydraulic gradient j and flow velocity v correlations of matrix 1 coefficient of determination r2 0 99 the j v relationships of matrices 2 and 3 can be fitted by the forchheimer equation j av2 bv with constants a and b that represent the inertial and viscous components of j r2 0 99 zimmerman et al 2004 flow in the fracture matrix system gradually shifts from linear to nonlinear systems when the flow velocity increases and the matrix s hydraulic conductivity k decreases the magnitude of the non darcy effect is normalized using the non darcy effect factor e 15 e b v 2 av b v 2 generally it was widely believed that the oneset of the nonlinear effect of fluid was characterized by e 0 1 javadi et al 2014 wang et al 2020 xing et al 2021 in this experiment fig 4 illustrates the distribution of e at various flow velocities for matrices 2 and 3 e 0 1 when v 0 006 cm s and v 0 001 cm s respectively under v 0 15 cm s e 0 65 of matrix 3 is larger than e 0 21 of matrix 2 in fig 4 indicating the magnitude of the non darcy effect of fracture matrix 3 is greater than fracture matrix 2 as the matrix porosity increases i e fracture matrix porosity ratio β approach to 1 table 1 the fracture matrix system behaves increasingly like a single dominant and the flow in fracture matrix 1 is darcy flow the results of the hydraulic experimental data from matrix 2 and matrix 3 indicate that the fracture matrix is more prone to non darcy flow considering the phenomenon of the difference in the hydraulic conductivity between the fracture and matrix is nearly three times of magnitude and fracture matrix porosity ratio β is smaller table 1 3 2 geophysical experiments bulk and fluid tracer btcs fig 5 shows btcs of fec and bec in the experiments of the three quartz sandsmatrices at various flow velocities btcs for all flow velocities are indicated in figures s1 s3 the details of each experiment are listed in table 2 it is important to note that if the fraction of less mobile porosity is negligible leading to a linear relationship between the fec and bec as expected from archie s law archie 1942 however there was some lag between the bec and fec during ionic tracer perturbations this result qualitatively indicates the presence of matrix porosity with delayed loading of the solute tracer after a short peak the flush phase starts and the bec lags behind fec variation indicating that the matrix progressively releases solute tracer the peak time varies based on flow velocity and matrix condition fec and bec data of the three matrices at different flow velocities are presented as btcs in fig 5 fig 5d to 5f present the experiment outcomes of matrix 2 the lag between fec and bec is still noticeable however it reduces relative to matrix 1 and increases compared to matrix 3 in the following section other flow velocity conditions are explored for the three matrix types and the tracer experiments are analyzed using fec and bec hysteresis curves 3 3 resistance time distribution rtds matrix porosity is a significant parameter that controls the solute transport process in the fracture matrix system zhu and zhan 2018 fig 6 shows the resistance time distribution rtd of btcs in the fracture matrix system under various flow velocity conditions in matrices 1 to 3 when solute transport follows the fickian law the rtds will drop sharply after the peak rather than the power law tail cardenas et al 2007 the power law function of time was utilized to fit the rtds value after the peak to characterize the magnitude of tailing in all cases the higher flow velocity raises the tailing exponent ω indicating the light tail fig 6a to c as the matrix porosity decreases a heavier tail occurs in matrix 3 as the ω decrease thus it can be concluded that matrix porosity plays a vital role in controlling the solute transport in the fracture matrix system in addition the flow velocity influences in shortening the tail enhancing the solute transport process and improving the mass transfer rate between the fracture and matrix the effective rate of the mass transfer between the less mobile and mobile zones contribute to the magnitude of the tails the following section will directly quantify the mass transfer processes between the less mobile and mobile regions 3 4 characterization of matrix porosity from hysteresis loops fig 7 exhibits several hysteresis curves between fec and bec and figures s4 through s6 depicts the entire results the hysteresis curves are approximate mirror symmetry suggesting that the mass exchange processes in fracture and matrix are observed during tracer injection and flush phases the difference in the shapes of hysteresis curves indicates the dependence of mobile and less mobile exchange parameters on matrix properties various porosities and flow velocity the hysteresis curves are larger and reveal apparent separation at the velocity of 0 148 cm s in matrix 1 however the hysteresis curves converge in shape at the velocity of 0 28 cm s this result is evident in matrix 2 but not in matrix 3 the less mobile mobile porosity ratio β can be calculated using eq 9 briggs et al 2014 in table 2 β values derived from the hysteresis curve are provided in all experiments β is less for lower flow velocity 0 06 cm s than for higher flow velocity fig 8 a this tendency is particularly apparent in matrix 3 where β rise by approximately 7 from lowest to highest flow velocity in all experiments the parameter α grows with developing flow velocity fig 8b indicating faster mass transfer between the mobile and less mobile domains leading to a decrease in the resident time of the less mobile ω increase 4 discussions 4 1 effect of flow velocity on solute transport the solute is injected into a fracture matrix system at a constant flow velocity in the experiment this provides an opportunity to quantify the flow velocity impacts on the solute transport in the fracture matrix system fig 7 depicts the effect of varying flow velocities on the solute transport across various fracture and matrix regions in all cases the resulting hysteresis curves for low and medium flow velocities are wider than those for high flow on the other hand at a greater flow velocity such as 0 28 cm s for matrix 1 and 0 29 cm s for matrix 2 advection is increased causing the fracture matrix system to function more as a single region lower differential tracer loading leading to a narrow hysteresis curve that approaches archie linear values because if the part of matrix porosity is negligible points σ b 0 and σ b 3 σ b 1 and σ b 2 will be coincided fig 2a resulting in a linear relationship between bec and fec based on archie s law archie 1942 the only exception in this phenomenon is matrix 3 at high flow velocity where matrix porosity is lower and the differential in loading of less mobile versus mobile regions is higher leading to a broader hysteresis curve under a lower flow velocity the hysteresis curves are wider indicating an increased effect of the less mobile part as illustrated in fig 8a briggs et al 2014 suggested that there are more regions where solute has a long residence time when the flow velocity is high such as 0 28 cm s for matrix1 and 0 29 cm s for matrix2 the less mobile part grows slightly fig 8a while α increases fig 8b resulting in a reduction of less mobile residence time fig 8c the mass transfer rate between fracture and matrix increases when the flow velocity becomes larger qian et al 2011a this differential response on flow velocity indicates that the solute transport of the less mobile depends on flow at a lower or medium flow velocity as flow velocity increases the fracture matrix system resembles a single domain medium this flow dependence is consistent with the experimental results of briggs s study briggs et al 2018 the only exception in this trend is matrix 3 at a high flow velocity as when v is more than 0 006 cm s the fracture matrix 3 occurs non darcy effect fig 4b and it does not quickly achieve great flow velocity for the fracture matrix 3 in contrast the porosity of matrix 3 is lower than that of the fracture and the differential in loading between less mobile and mobile regions is risen in fact the value of β was greatly affected by the flow velocity and the degree of influence was different in different flow velocity ranges when flow velocity ranged from 0 042 to 0 144 cm s it increased with the increase of the flow velocity however when the flow velocity was between 0 144 and 0 188 cm s the value of β hardly increased for example matrix 2 the differential response with flow velocity indicates that the matrix had a strong dependence on the flow velocity at lower flow velocity as flow velocity increased the volume of matrix porosity effective porosity increased slightly or with no change while the mass transfer rate coefficient α increased and resulted in a net reduction of matrix porosity residence time higher the tailing exponent ω of rtds such flow dependence of matrix porosity dynamics was generally consistent with the simulation results in previous studies briggs et al 2014 mahmoodpoor dehkordy et al 2018 therefore the matrix porosity also plays a vital role in solute transport in fracture matrix system the effect of matrix porosity on solute transport will be discussed in the following section 4 2 effect of the matrix porosity on solute transport matrix porosity is a critical parameter that controls the contaminant transport process in the fracture matrix system in this experiment a water flushing phase is applied to the inlet boundary of the fracture matrix system after a specific time of tracer injecting the solute back diffusion from the matrix where porosity is lower and concentrations are higher into the fracture where porosity is higher and concentrations are lower will occur during the water flushing phase all btcs curves fig 5 exhibit a trail phenomenon which is the essential effect of back diffusion of mass the mass held in the matrix served as a secondary source and caused the persistence of the solute plume tail david et al 2016 this process is related to the porosity of the matrix because it is one of the significant factors governing the source strength of the secondary source yang et al 2016 the impact of matrix porosity on solute transport is analyzed by changing different matrix porosity table 1 fig 9 illustrates the impact of the matrix porosity on a trailing duration trailing balance time minus peak time in the fracture for various flow velocities it reveals that the different matrix properties significantly influence the solute transport process for instance the trailing duration time increases as matrix properties decreases a small matrix porosity low permeability and high storage capability can slow down the process of solute back diffusion from the matrix into the fracture fig 6 shows all the tails followed by a power law drop the tailing exponent ω of rtds is employed to characterize the effect of the matrix porosity on trails when the tail is heavy the tailing exponent of rtds ω is small the tailing exponent of rtds drops as matrix porosity fig 8c decreases demonstrating that a low matrix porosity results in a heavier tail for instance the tailing exponent for the matrix with the lowest porosity in this study ranges from 1 to 2 however the tailing exponent varies between 3 and 5 for the highest matrix porosity at the end of the process of solute transport the majority of the solute has migrated out of the fracture leading to the lower matrix porosity slowing back the diffusion of mass chapman and parker 2005 tatti et al 2018 yan et al 2016 the matrix is considered a less mobile region where the solute undergoes a first order single exchange rate the first order single rate of mass transfer process controls the magnitude of the trails dou et al 2018a b therefore the mass transfer coefficient α between the fracture and matrix domain is also quantified in all cases α rises with an increase in matrix porosity fig 8b indicating that there is a faster mass transfer between the fracture and matrix region leading to the rtds tailing exponent of matrix increase residence time decreases fig 8a 4 3 experimental limitations although this study directly quantified solute transport in a fracture matrix system considering the experimental tractability the experimental model size is limited consequently the model length might not fully satisfy the threshold for achieving the progressive dispersion regime wang et al 2012 this might influence the explanation of tailing behavior further induced by flow velocity however the key results of this study should remain valid the matrix thickness is one of the important factors that influence solute transport and which may also be the main factor affecting the value of ω for systems with infinite fissure matrix thickness ω is less than 1 5 becker and shapiro 2000 hoffmann et al 2020 however the value of ω will increase at a finite matrix thickness under the same other experimental conditions in this study the matrix thickness 59 mm is fixed and obtained ω of 1 75 matrix 3 5 conclusion in this study quantification of solute transport in a fracture matrix system was investigated by combining geoelectrical monitoring with high density electrical method bulk electrical conductivity and conductivity acquisition method fluid electrical conductivity and direct geoelectric monitoring was applied to quantify mass transfer parameters i e mass transfer rate coefficient α and fracture matrix porosity ratio β the effect of matrix porosity and flow velocity on solute transport in the fracture matrix system was quantitatively and qualitatively analyzed the primarily results are as follows 1 geoelectrical monitoring combined with bec and fec can quantify solute transport in the fracture matrix system the hysteresis curve obtained between bec and fec in fracture matrix provides evidence of mass exchange between fracture and matrix domains 2 flow velocity significantly influenced the behavior of solute transport in the fracture matrix system when flow velocity changed from low to high β values increased slightly or with no change and α increased which reduced residence time in the matrix region higher the tailing exponent ω of rtds 3 matrix porosity affects the solute transport behavior in fracture matrices the mass transfer rate coefficient α reduced with the decrease of fracture matrix porosity ratio β lower matrix porosity and increase of the residence time lower the tailing exponent ω of rtds which indicated that solute transport between the fracture and matrix is slow quantification of matrix porosity allows for a more accurate assessment of the volume of matrix contaminants on site and combined with the mass transfer rate coefficient α the time required for remediation can be calculated credit authorship contribution statement yongshuai yan methodology writing review editing supervision jiazhong qian methodology lei ma software guizhang zhao validation yaping deng formal analysis haoming zhang writing original draft yunhai fang yong liu declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work was supported by the national natural science foundation of china 41831289 42072276 41877191 and the belt and road special foundation of the state key laboratory of hydrology water resources and hydraulic engineering 2021490511 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2022 128885 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
2416,solute transport in fracture is easy to diffuse into the matrix due to the permeability of the matrix the quantification of solute concentration is particularly important during diffusion and is a challenge for the management of pollutants in a fracture matrix system in this paper sodium chloride as solute the geoelectrical technology was combined with high density electrical method and conductivity acquisition method to conduct a series of sandbox experiments in the center of the sandbox is a fracture and on both sides of the fracture is the matrix the fracture and matrix in the sandbox form a fracture matrix system loading flushing process of sodium chloride solution in fracture matrix system was monitored in real time and non destructive the effect of matrix porosity and flow velocity on solute transport in fracture matrix system was investigated the results showed that 1 mass transfer rate coefficient α and fracture matrix porosity ratio β and tailing exponent of residence time distribution ω were quantified by pairing bulk electrical conductivity bec and fluid electrical conductivity fec without the requirement of inverse model calibration in contrast the single electrical method still lacks resolution or is not representative in determining solute transport parameters in fracture matrix system 2 the matrix porosity had a significant effect on solute transport in fracture matrix system with the increase of porosity the mass transfer rate coefficient α increased and the residence time in the matrix decreased 3 an increase of flow velocity led to a decrease of residence time in the matrix and an increase in mass transfer rate coefficient α the solute transport in fracture matrix system can be quantified by electrical conductivity hysteresis the results can provide a basis for the management of solute transport in fracture matrix system keywords fracture matrix system mass transfer matrix porosity flow velocity geoelectrical technology data availability data will be made available on request 1 introduction the fundamental understanding of solute transport process in fracture geological systems is critical for developing many geoengineering strategies geological sequestering of fluid in geologic repositories e g storing radioactive waste and carbon dioxide bodin et al 2003 roubinet et al 2012 however accurate characterization and prediction of solute transport in fractured rock is particularly challenging owing to the extreme heterogeneities of flow velocity and matrix porosity dou et al 2018a b chen et al 2022 viswanathan et al 2022 over the past several decades the hydrological and environmental communities have extensively highlighted the complexity of the solute transport process in fractured rock system cardenas et al 2007 chen et al 2021 qian et al 2011a rezaei and pirvand 2022 rezaei et al 2016 wang et al 2022 zhan et al 2009 zhou and zhan 2018 zhou et al 2017 zhu and zhan 2018 many studies have shown that preferential flow in rock fracture promotes fast transfers while diffusion from rock fracture into matrix can results in the occurrence of solute heavy tailing hyman et al 2019 the fractured porous medium contains a less mobile rock matrix block and mobile fracture and each part has its own specific transport characteristics sonnenborg et al 1999 tang and aral 1992 the fracture typically has relatively high permeability and low storage capability while the matrix usually has low permeability and high storage capability moleme and gomo 2018 zhou et al 2017 when the solute enter the fractured rock the plume can penetrate from fracture to matrix moreno et al 1997 solute transport in fractures matrix system is governed primarily by advection and diffusion cvetkovic and frampton 2012 if the diffusion coefficient or contact time between solute and matrix is minimal enough matrix diffusion can be ignored however on a long time scale matrix diffusion often acts as a significant mechanism in the disposal of chemical and nuclear wastes neretnieks 1980 roubinet et al 2012 a contaminant in the matrix can be slowly released into the fracture by diffusion and trapped in the fracture matrix system for a long time amin et al 2012 which leads to excessively long transport time and anomalous solute breakthrough curves btcs with heavier tailing behavior carrera 1993 harvey and gorelick 2000 levy and berkowitz 2003 hence determining the factors that affect the interaction of fracture and matrix and quantifying solute transport in fracture matrix system is important as they regulate the presence of secondary pollutant sources that make remediation procedures slow and inefficient adamson et al 2016 falta and wang 2017 haggerty and gorelick 1994 characterizations of solute transport in fracture matrix systems at laboratory or field scales are extremely challenging due to the difficulty in obtaining mass and concentration data directly from the matrix houseworth et al 2013 the previous studies on solute transport process in fracture matrix system focus on numerical modeling rezaei and pirvand 2022 zhou and zhan 2018 zhou et al 2017 zhu and zhan 2018 transport in the fracture matrix system has been highly simplified in semi analytical models by a single fracture roubinet et al 2012 zhou et al 2017 zhu et al 2016 transport in parallel multi fractures is usually restricted to unfilled fractures in semi analytical models amin et al 2012 chen and zhan 2018 in reality fractures are filled with unconsolidated geological material bradner and murdoch 2005 wealthall et al 2001 the filled fracture behaves differently compared to the open fracture for instance a previous study reported that the propagation front in the filled fracture is smoother than those in open fractures lunati et al 2003 solute transport in single filled fracture cannot be calculated using the advection dispersion equation ade qian et al 2011b a large number of investigations indicate that ade performs poorly in both filled and open fractures and cannot explain the anomalous solute transport behavior e g heavier tailing of the btc dual domain mass transfer ddmt models provide a satisfactory explanation van genuchten and wierenga 1976 previous research has shown that ddmt models capture abnormal transport better than ade baratelli et al 2014 briggs et al 2018 swanson et al 2015 when velocity differences between mobile and less mobile regions are minor ddmt models have been successfully used baratelli et al 2010 despite the success of ddmt models in matching observations it is difficult to measure the parameters directly and there is no lab scale or field scale experimental verification because it is usually much more challenging to draw fluid samples from the less mobile region matrix or aquitard moysey 2021 zhou and zhan 2018 therefore it is difficult to accurately quantify anomalous transport which can persist in the less mobile region the geoelectrical monitoring technique provides a unique advantage in investigating the storage of contaminants in fractured rock due to the ability of electrical signals to pass through both the mobile and less mobile domains briggs et al 2013 day lewis and singha 2008 2017a b singha et al 2007 this geoelectrical monitoring technique has not been applied in fracture matrix system however the application of traditional geoelectric monitoring method alone can only estimate the porosity of fractured rock roughly but cannot quantify the mass transfer coefficient between fracture and matrix therefore in this paper we combined geoelectrical monitoring method with high density electrical method bulk conductivity method and electrical conductivity acquisition method fluid conductivity method to quantify the influence of matrix porosity and mass transfer coefficient on the solute and quantify the mass exchange process between the fracture and matrix in fracture matrix system a fracture with three filled porosities is conducted in a sandbox model to simulate the solute transport process between fracture and matrix the sandbox model was made by plexiglass plates in the center of the sandbox is a fracture filled with coarse grained quartz and on both sides of the fracture is the matrix filled with fine grained quartz the fracture and matrix in the sandbox form a fracture matrix system the loading and scouring process of sodium chloride solution in fracture matrix system was monitored in real time and nondestructively the current work aims 1 to directly quantify solute transport in a fracture matrix system using the synthesis of electrically conductive tracers and a geoelectrical monitoring method 2 to examine the effects of flow velocity on solute transport 3 to investigate the effect of matrix porosity on solute transport 2 materials and methods 2 1 experimental design and tracer experiments a sandbox 500 138 20 mm l w h was made by plexiglass plates in the center of the sandbox is a fracture and on both sides of the fracture is the matrix the fracture and matrix are separated by a plexiglass plate with evenly distributed holes slightly less than the matrix particle size the fracture and matrix in the sandbox form a fracture matrix system low and high permeability zones simulate matrix and fracture in a subsurface environment in a fracture matrix system the fracture is filled with coarse quartz sands with an average diameter of 3 mm minhai environmental technology co henan china coarse grained quartz sand was utilized to represent the filled fracture due to its high hydraulic conductivity which formed preferential flow paths of groundwater and contaminant during the experiment the filled fracture was kept unchanged the matrix with different porosities were prepared with three quartz grain sizes of 0 24 0 15 and 0 092 mm table 1 displays the material of the fracture matrix system fig 1 shows a schematic diagram of the physical model consisting of the fracture matrix and electrical monitoring parts the fracture matrix consists of a high permeability fracture and a low permeability matrix and two plexiglass tanks for recharge and discharge the first tank contains a water filled zone 200 120 20 mm at the inlet to maintain a uniform inlet flow while the second one was identical to the first the fracture dimensions are 500 20 20 mm the matrix 500 59 20 mm with the same properties was distributed on the two sides of the fracture since gravity is not taken into account in this case the fracture matrix part is vertical sodium chloride nacl was selected as an ionic tracer a filter paper was located at the inlet and outlet of the fracture device to ensure that no quartz sand escaped and that the nacl solution was evenly distributed nacl solution was injected upward into the fracture from the bottom of the recharge tank by a pump before the experiment 0 25 g l fec about 200µs cm of nacl solution was continuously injected at a rate of 5 ml min to ensure the balance between the fracture and the matrix region and then 0 5 g l fec about 1200 µs cm nacl solution was injected instantaneously then return to the initial 0 25 g l solution fracture matrix system of tracer was injected to allow the fracture and matrix dominants to reach equilibrium indicated fluid electrical conductivity fec and bulk electrical conductivity bec no longer change in time 2 2 geoelectrical measurement this study measured the fec and bec during the experiment at 250 mm from the recharge tank the fec was determined using conductivity probes of conductivity acquisition method djs 1c inesa scientific instrumentco ltd china located at the center of the fracture matrix part such as the bec electrode array fig 1a the bec was collected using a wenner alpha electrode configuration array of high density electrical method which was obtained utilizing ert21s nanjing geozhou exploration technology company limited china in the wenner alpha electrode configuration array a total of four electrodes were involved the outer two electrodes a and b were used as current and the inner two electrodes m and n were used as potential electrodes fig 1a four electrodes were arranged on one side of the sandbox model spaced 1 5 cm apart the bulk electrical resistivity ρ b is defined as the ratio of potential difference δ v to intense current i multiplied by the coefficient k of the device the electrical resistivity value was determined using eq 1 yang et al 2021 1 ρ b k δ v i the coefficient of the device k was calculated according to eq 2 2 k 2 π 1 am 1 an 1 bm 1 bn where am an bm and bn are the distances between electrodes mm the bec σ b was determined using the bulk electrical resistivity ρ b according to eq 3 3 σ b 1 ρ b the electrical monitoring method was performed at 55 s sampling intervals in order to compare the bec and the fec measurements a petrophysical model is typically required typically the fec and bec are linked using archie s law archie 1942 where the mobile and less mobile production concentrations fec are converted into bec singha et al 2007 σ b as follows 4 σ b θ m θ lm q 1 θ m σ m θ lm σ lm where σ b is the measured bec θ m is the mobile area porosity σ m is the ec of the mobile θ lm is the the less mobile porosity σ lm is the ec of the less mobile porosity and q is the cementation exponent assumed as 1 7 for saturated sand briggs et al 2018 2 3 the dual domain mass transfer ddmt model the simplest one dimensional ddmt model can be written as follows van genuchten et al 1977 5 θ m c m t θ lm c lm t θ m d m 2 c m x 2 v m θ m c m x 6 θ lm c lm t α c m c lm where θ m and θ lm are the porosities of the mobile and less mobile domains respectively c m and c lm are the solute concentrations of the mobile and less mobile domains m 2 t respectively d m is the spatially constant dispersion coefficient l 2 t v m is the average pore water velocity l t α is the mass transfer rate coefficient t 1 and t is the time t 2 4 residence time distribution rtds the presence of matrix porous in the fracture matrix system can lead to the tail of btcs in order to characterize the tail of btcs the residence time distribution rtds an effective metric developed by the nonlocal theory dou et al 2018a b zhang et al 2022 was calculated for the normalized solute transport under different flow velocity conditions the rtds can be derived from the derivative of btcs for the instantaneous step injection yielding the resident concentration time series and rtds can be calculated as wang and bayani cardenas 2017 7 r t d c i dt where c i is the concentration obtained in response to the instantaneous injection the btcs can be converted from an instantaneous injection to step one yu et al 1999 8 d c i dt c s where the c s is the concentration obtained in response to the step injection 2 5 less mobile porosity estimation specific fec and bec were plotted over time for generating the btcs and the hysteresis curve was determined using the concentration space between the fec and bec the hysteresis curve was used to calculate the less mobile mobile porosity ratio β and the mass transfer rate coefficient α between the less mobile and the mobile domains generally β can be graphically estimated using the hysteresis curves inflection points as shown in fig 2 a briggs et al 2014 and can be calculated as follows 9 β σ b 3 σ b 0 σ b 2 σ b 3 where σ b 0 is the bec value at the hinge points under equilibrium conductions before injection σ b 2 is the bec value associated with the inflection point under equilibrium conductions after injection and σ b 3 is the bec value at the flush phase point briggs et al 2014 this assumption is more valid in this method for the flush limb of the hysteresis curve when the less mobile and mobile zones are parallel electrical conductors day lewis et al 2017a b therefore σ b 0 σ b 2 and σ b 3 are used for the graphical analysis of β 2 6 mass transfer rate coefficient estimation in order to estimate the classic mass transfer rate coefficient α ma and zheng 2011 the semi analytical approach was used which is presented by briggs et al 2018 in this approach a second order polynomial was used to fit the temporal fec σ m curve for the mobile domain before reaching the tracer injection plateau fig 2b 10 g t a t 2 b t c where a b and c are constants the fluid sampling method can be used to measured σ m described in eq 4 it is possible to approximate the time series of σ m as it approaches equilibrium with the tracer injection concentration using a differentiable function for instance a second order polynomial in this case eq 4 can be rewritten as follows 11 σ b θ m θ lm q 1 θ m a t 2 b t c θ lm σ lm by taking the derivative of eq 4 with respect to time the following equation will be derived 12 σ b t θ m θ m θ lm q 1 2 a t b θ lm θ m θ lm q 1 φ σ lm φ t substituting the transport equation for less mobile concentration of σ lm t it can be obtained by solving eq 4 13 σ b t θ m θ m θ lm q 1 2 a t b α θ m θ lm q 1 σ m σ lm by solving eq 4 for σ lm a single ordinary differential equation eq 14 can be derived when substituting the polynomial expression for σ m 14 σ b t θ m θ lm q 1 θ m 2 a t b α a t 2 b t c σ b θ m θ lm q 1 θ m a t 2 b t c θ lm the initial conditions for bec and fec are identified experimentally and eq 14 is fitted to the data using a nonlinear regression that identify the best fitting mass transfer parameter α briggs et al 2014 3 results 3 1 flow characteristics fig 3 depicts hydraulic experimental data the linear darcy s law accurately describes the relationship between flow velocity and hydraulic gradient of matrix 1 fig 3a however this relationship is fig 3b and c nonlinear for matrices 2 and 3 specifically darcy s equation j av with constant a can almost precisely fit the hydraulic gradient j and flow velocity v correlations of matrix 1 coefficient of determination r2 0 99 the j v relationships of matrices 2 and 3 can be fitted by the forchheimer equation j av2 bv with constants a and b that represent the inertial and viscous components of j r2 0 99 zimmerman et al 2004 flow in the fracture matrix system gradually shifts from linear to nonlinear systems when the flow velocity increases and the matrix s hydraulic conductivity k decreases the magnitude of the non darcy effect is normalized using the non darcy effect factor e 15 e b v 2 av b v 2 generally it was widely believed that the oneset of the nonlinear effect of fluid was characterized by e 0 1 javadi et al 2014 wang et al 2020 xing et al 2021 in this experiment fig 4 illustrates the distribution of e at various flow velocities for matrices 2 and 3 e 0 1 when v 0 006 cm s and v 0 001 cm s respectively under v 0 15 cm s e 0 65 of matrix 3 is larger than e 0 21 of matrix 2 in fig 4 indicating the magnitude of the non darcy effect of fracture matrix 3 is greater than fracture matrix 2 as the matrix porosity increases i e fracture matrix porosity ratio β approach to 1 table 1 the fracture matrix system behaves increasingly like a single dominant and the flow in fracture matrix 1 is darcy flow the results of the hydraulic experimental data from matrix 2 and matrix 3 indicate that the fracture matrix is more prone to non darcy flow considering the phenomenon of the difference in the hydraulic conductivity between the fracture and matrix is nearly three times of magnitude and fracture matrix porosity ratio β is smaller table 1 3 2 geophysical experiments bulk and fluid tracer btcs fig 5 shows btcs of fec and bec in the experiments of the three quartz sandsmatrices at various flow velocities btcs for all flow velocities are indicated in figures s1 s3 the details of each experiment are listed in table 2 it is important to note that if the fraction of less mobile porosity is negligible leading to a linear relationship between the fec and bec as expected from archie s law archie 1942 however there was some lag between the bec and fec during ionic tracer perturbations this result qualitatively indicates the presence of matrix porosity with delayed loading of the solute tracer after a short peak the flush phase starts and the bec lags behind fec variation indicating that the matrix progressively releases solute tracer the peak time varies based on flow velocity and matrix condition fec and bec data of the three matrices at different flow velocities are presented as btcs in fig 5 fig 5d to 5f present the experiment outcomes of matrix 2 the lag between fec and bec is still noticeable however it reduces relative to matrix 1 and increases compared to matrix 3 in the following section other flow velocity conditions are explored for the three matrix types and the tracer experiments are analyzed using fec and bec hysteresis curves 3 3 resistance time distribution rtds matrix porosity is a significant parameter that controls the solute transport process in the fracture matrix system zhu and zhan 2018 fig 6 shows the resistance time distribution rtd of btcs in the fracture matrix system under various flow velocity conditions in matrices 1 to 3 when solute transport follows the fickian law the rtds will drop sharply after the peak rather than the power law tail cardenas et al 2007 the power law function of time was utilized to fit the rtds value after the peak to characterize the magnitude of tailing in all cases the higher flow velocity raises the tailing exponent ω indicating the light tail fig 6a to c as the matrix porosity decreases a heavier tail occurs in matrix 3 as the ω decrease thus it can be concluded that matrix porosity plays a vital role in controlling the solute transport in the fracture matrix system in addition the flow velocity influences in shortening the tail enhancing the solute transport process and improving the mass transfer rate between the fracture and matrix the effective rate of the mass transfer between the less mobile and mobile zones contribute to the magnitude of the tails the following section will directly quantify the mass transfer processes between the less mobile and mobile regions 3 4 characterization of matrix porosity from hysteresis loops fig 7 exhibits several hysteresis curves between fec and bec and figures s4 through s6 depicts the entire results the hysteresis curves are approximate mirror symmetry suggesting that the mass exchange processes in fracture and matrix are observed during tracer injection and flush phases the difference in the shapes of hysteresis curves indicates the dependence of mobile and less mobile exchange parameters on matrix properties various porosities and flow velocity the hysteresis curves are larger and reveal apparent separation at the velocity of 0 148 cm s in matrix 1 however the hysteresis curves converge in shape at the velocity of 0 28 cm s this result is evident in matrix 2 but not in matrix 3 the less mobile mobile porosity ratio β can be calculated using eq 9 briggs et al 2014 in table 2 β values derived from the hysteresis curve are provided in all experiments β is less for lower flow velocity 0 06 cm s than for higher flow velocity fig 8 a this tendency is particularly apparent in matrix 3 where β rise by approximately 7 from lowest to highest flow velocity in all experiments the parameter α grows with developing flow velocity fig 8b indicating faster mass transfer between the mobile and less mobile domains leading to a decrease in the resident time of the less mobile ω increase 4 discussions 4 1 effect of flow velocity on solute transport the solute is injected into a fracture matrix system at a constant flow velocity in the experiment this provides an opportunity to quantify the flow velocity impacts on the solute transport in the fracture matrix system fig 7 depicts the effect of varying flow velocities on the solute transport across various fracture and matrix regions in all cases the resulting hysteresis curves for low and medium flow velocities are wider than those for high flow on the other hand at a greater flow velocity such as 0 28 cm s for matrix 1 and 0 29 cm s for matrix 2 advection is increased causing the fracture matrix system to function more as a single region lower differential tracer loading leading to a narrow hysteresis curve that approaches archie linear values because if the part of matrix porosity is negligible points σ b 0 and σ b 3 σ b 1 and σ b 2 will be coincided fig 2a resulting in a linear relationship between bec and fec based on archie s law archie 1942 the only exception in this phenomenon is matrix 3 at high flow velocity where matrix porosity is lower and the differential in loading of less mobile versus mobile regions is higher leading to a broader hysteresis curve under a lower flow velocity the hysteresis curves are wider indicating an increased effect of the less mobile part as illustrated in fig 8a briggs et al 2014 suggested that there are more regions where solute has a long residence time when the flow velocity is high such as 0 28 cm s for matrix1 and 0 29 cm s for matrix2 the less mobile part grows slightly fig 8a while α increases fig 8b resulting in a reduction of less mobile residence time fig 8c the mass transfer rate between fracture and matrix increases when the flow velocity becomes larger qian et al 2011a this differential response on flow velocity indicates that the solute transport of the less mobile depends on flow at a lower or medium flow velocity as flow velocity increases the fracture matrix system resembles a single domain medium this flow dependence is consistent with the experimental results of briggs s study briggs et al 2018 the only exception in this trend is matrix 3 at a high flow velocity as when v is more than 0 006 cm s the fracture matrix 3 occurs non darcy effect fig 4b and it does not quickly achieve great flow velocity for the fracture matrix 3 in contrast the porosity of matrix 3 is lower than that of the fracture and the differential in loading between less mobile and mobile regions is risen in fact the value of β was greatly affected by the flow velocity and the degree of influence was different in different flow velocity ranges when flow velocity ranged from 0 042 to 0 144 cm s it increased with the increase of the flow velocity however when the flow velocity was between 0 144 and 0 188 cm s the value of β hardly increased for example matrix 2 the differential response with flow velocity indicates that the matrix had a strong dependence on the flow velocity at lower flow velocity as flow velocity increased the volume of matrix porosity effective porosity increased slightly or with no change while the mass transfer rate coefficient α increased and resulted in a net reduction of matrix porosity residence time higher the tailing exponent ω of rtds such flow dependence of matrix porosity dynamics was generally consistent with the simulation results in previous studies briggs et al 2014 mahmoodpoor dehkordy et al 2018 therefore the matrix porosity also plays a vital role in solute transport in fracture matrix system the effect of matrix porosity on solute transport will be discussed in the following section 4 2 effect of the matrix porosity on solute transport matrix porosity is a critical parameter that controls the contaminant transport process in the fracture matrix system in this experiment a water flushing phase is applied to the inlet boundary of the fracture matrix system after a specific time of tracer injecting the solute back diffusion from the matrix where porosity is lower and concentrations are higher into the fracture where porosity is higher and concentrations are lower will occur during the water flushing phase all btcs curves fig 5 exhibit a trail phenomenon which is the essential effect of back diffusion of mass the mass held in the matrix served as a secondary source and caused the persistence of the solute plume tail david et al 2016 this process is related to the porosity of the matrix because it is one of the significant factors governing the source strength of the secondary source yang et al 2016 the impact of matrix porosity on solute transport is analyzed by changing different matrix porosity table 1 fig 9 illustrates the impact of the matrix porosity on a trailing duration trailing balance time minus peak time in the fracture for various flow velocities it reveals that the different matrix properties significantly influence the solute transport process for instance the trailing duration time increases as matrix properties decreases a small matrix porosity low permeability and high storage capability can slow down the process of solute back diffusion from the matrix into the fracture fig 6 shows all the tails followed by a power law drop the tailing exponent ω of rtds is employed to characterize the effect of the matrix porosity on trails when the tail is heavy the tailing exponent of rtds ω is small the tailing exponent of rtds drops as matrix porosity fig 8c decreases demonstrating that a low matrix porosity results in a heavier tail for instance the tailing exponent for the matrix with the lowest porosity in this study ranges from 1 to 2 however the tailing exponent varies between 3 and 5 for the highest matrix porosity at the end of the process of solute transport the majority of the solute has migrated out of the fracture leading to the lower matrix porosity slowing back the diffusion of mass chapman and parker 2005 tatti et al 2018 yan et al 2016 the matrix is considered a less mobile region where the solute undergoes a first order single exchange rate the first order single rate of mass transfer process controls the magnitude of the trails dou et al 2018a b therefore the mass transfer coefficient α between the fracture and matrix domain is also quantified in all cases α rises with an increase in matrix porosity fig 8b indicating that there is a faster mass transfer between the fracture and matrix region leading to the rtds tailing exponent of matrix increase residence time decreases fig 8a 4 3 experimental limitations although this study directly quantified solute transport in a fracture matrix system considering the experimental tractability the experimental model size is limited consequently the model length might not fully satisfy the threshold for achieving the progressive dispersion regime wang et al 2012 this might influence the explanation of tailing behavior further induced by flow velocity however the key results of this study should remain valid the matrix thickness is one of the important factors that influence solute transport and which may also be the main factor affecting the value of ω for systems with infinite fissure matrix thickness ω is less than 1 5 becker and shapiro 2000 hoffmann et al 2020 however the value of ω will increase at a finite matrix thickness under the same other experimental conditions in this study the matrix thickness 59 mm is fixed and obtained ω of 1 75 matrix 3 5 conclusion in this study quantification of solute transport in a fracture matrix system was investigated by combining geoelectrical monitoring with high density electrical method bulk electrical conductivity and conductivity acquisition method fluid electrical conductivity and direct geoelectric monitoring was applied to quantify mass transfer parameters i e mass transfer rate coefficient α and fracture matrix porosity ratio β the effect of matrix porosity and flow velocity on solute transport in the fracture matrix system was quantitatively and qualitatively analyzed the primarily results are as follows 1 geoelectrical monitoring combined with bec and fec can quantify solute transport in the fracture matrix system the hysteresis curve obtained between bec and fec in fracture matrix provides evidence of mass exchange between fracture and matrix domains 2 flow velocity significantly influenced the behavior of solute transport in the fracture matrix system when flow velocity changed from low to high β values increased slightly or with no change and α increased which reduced residence time in the matrix region higher the tailing exponent ω of rtds 3 matrix porosity affects the solute transport behavior in fracture matrices the mass transfer rate coefficient α reduced with the decrease of fracture matrix porosity ratio β lower matrix porosity and increase of the residence time lower the tailing exponent ω of rtds which indicated that solute transport between the fracture and matrix is slow quantification of matrix porosity allows for a more accurate assessment of the volume of matrix contaminants on site and combined with the mass transfer rate coefficient α the time required for remediation can be calculated credit authorship contribution statement yongshuai yan methodology writing review editing supervision jiazhong qian methodology lei ma software guizhang zhao validation yaping deng formal analysis haoming zhang writing original draft yunhai fang yong liu declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work was supported by the national natural science foundation of china 41831289 42072276 41877191 and the belt and road special foundation of the state key laboratory of hydrology water resources and hydraulic engineering 2021490511 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2022 128885 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
2417,soil water potential swp gradients control water and energy fluxes in the soil plant atmosphere continuum exploring the spatial temporal variability of swp at the hillslope scale is an essential step towards developing ecohydrological models in this study swp monitoring was carried out on two contrasting alpine humid forested hillslopes i e coniferous and broadleaf forests at three depths 10 50 and 100 cm the effects of static soil properties and topography and dynamic precipitation dynamics and soil wetness conditions factors on swp dynamics and variability were investigated based on statistical methods temporal stability and variance decomposition analysis the results showed that the swp in the soil root zone 10 and 50 cm depths in the broadleaf forest exhibited higher variability and lower temporal stability than in the coniferous forest likely because of the stronger evapotranspiration and more variable soil hydraulic conductivity the relatively high swp variability in the deeper soil layer 100 cm depth of both forested hillslopes was due to the frequent lateral preferential flow furthermore topographic factors i e distance of hillslope to stream and slope and soil properties clay and rock fragment contents regulated the spatial patterns in swp and influenced representative site selection in the coniferous and broadleaf forests respectively decomposition of the spatial variance showed that the time invariant component was the dominant contributor to the total spatial variance an exponentially increasing relationship between the time invariant component and mean swp and a concave up parabolic shape between the contribution of the temporal anomalies and mean swp were observed our results provide an improved understanding of the temporal and spatial variability in terms of swp in forested hillslopes keywords hillslope scale representative locations spatial variability soil water potential temporal stability data availability data will be made available on request 1 introduction soil moisture is a key variable that controls the exchange of water and energy between the soil vegetation and climate guo and lin 2016 penna et al 2009 seneviratne et al 2010 vereecken et al 2022 however soil moisture is often spatially and temporally heterogeneous due to the complex interaction of precipitation vegetation soil properties and topography teuling and troch 2005 vereecken et al 2014 wang et al 2017 western et al 2002 knowledge of this spatial temporal variability is essential for various scientific investigations including 1 uncertainty estimations of the hydrological models heathman et al 2003 2 optimal location of sites for soil moisture monitoring and sampling wang et al 2008 3 validation of remote sensing products vereecken et al 2014 vereecken et al 2007 previous studies have shown that the spatial temporal variability of soil moisture can be characterized in terms of the standard deviation or coefficient of variance of soil moisture as a function of its mean value famiglietti et al 2008 however there is no consensus regarding the documentation of soil moisture variability at different spatial scales and in variable climate zones korres et al 2015 besides because of practical limitations conclusions regarding soil moisture variability are based almost solely on the near surface of gentle slopes e g see the reviews in brocca et al 2007 vanderlinden et al 2012 steep hillslopes and deep soil layers in alpine humid forests have complex subsurface critical zone structures and frequent rainfall pulses that may severely affect the soil moisture distribution guo and lin 2016 lin 2006 lin and zhou 2008 wang et al 2022 white et al 2019 grayson and western 2001 suggested that the spatial patterns of soil moisture were more related to topographic variables in humid and steep hillslopes where the subsurface lateral flow is likely to occur lin 2006 introduced a conceptual model that considered the significant effects of the preferential lateral flow system on the spatial soil moisture distribution within soil profiles kaiser and mcglynn 2018 identified an increased standard deviation of the water content within a riparian area caused by the effects of lateral flow from connected flow paths compared with that in the uplands area however the variability of soil moisture in steep and humid hillslope scale is still inadequate and requires further investigation the temporal stability analysis method proposed by vachaud et al 1985 has been used as a diagnostic tool to identify time stable locations and potential controlling factors the temporal stability of soil moisture at specific locations was shown to be consistently wetter or drier than the average value leading to a persistent bias which is a reflection of the temporal persistence of the spatial structure martínez fernández and ceballos 2005 this method has been successfully tested in different vegetation types soil properties topographic attributes soil depths and seasonal soil wetness conditions baroni et al 2013 gao et al 2011 hu et al 2010 lin 2006 martínez fernández and ceballos 2005 wang et al 2015 williams et al 2009 zhu et al 2021 cho and choi 2014 found that the meteorological factors contributed more to soil moisture temporal stability on a regional scale zhu et al 2021 showed that throughfall soil bulk density and litter biomass significantly affected the soil moisture temporal stability at a plot scale moreover temporally stable locations identified give the areal mean soil moisture of a hillslope rather than sampling at many random points jacobs et al 2004 which highlights the usefulness of temporal stability analysis the controls on spatial and temporal soil moisture patterns are a combination of static e g topography and soil properties and dynamic e g precipitation and soil wetness conditions variables as such an analysis of the variability of soil moisture patterns can be carried out by considering the absolute soil moisture values expressed in volumetric terms cm3 cm3 or relative values such as temporal anomalies which reduces the impact of the static soil properties brocca et al 2014 mittelbach and seneviratne 2012 yetbarek and ojha 2020 similarly the variability of soil moisture can be decomposed into time invariant i e temporal mean and time variant i e anomalies components it is possible to assess the extent to which these components contribute to the overall spatial soil moisture variability brocca et al 2014 showed that there was much lower spatial variability of temporal anomalies than absolute soil moisture values based on six soil moisture monitoring networks across six countries indicating a major contribution of the time invariant component gao et al 2015 found that the time invariant component provided the primary contribution and varied with soil wetness as such it is important to examine how these components vary as a function of soil wetness conditions as soil moisture variability changes significantly with soil wetness moreover previous studies have focused mainly on regional or catchment scales and near surface soil moisture dynamics and studies of deeper soil layers at different spatial scales are encouraged and required dari et al 2019 gao et al 2015 mittelbach and seneviratne 2012 rötzer et al 2015 soil water potential swp drives water fluxes between soils streams and groundwater but the relationship between swp and variability is controversial due to the nonlinear relationship between swp and soil moisture in addition the studies of swp variability are rather limited compared with the soil moisture novick et al 2022 yang et al 2016 yu et al 2015 therefore this study investigated the swp behaviors at the hillslope scale in which topography and rainfall inputs are expected to have an important role the specific objectives were 1 to investigate spatial temporal variability of swp over contrasting forested hillslopes 2 to evaluate the contribution of the time invariant and variant component in the determination of the spatial variability of swp and 3 to explore how soil wetness conditions alter contribution of the time invariant and variant components the results of this study can be of interest mainly for small scale studies e g hydrological or ecological studies and provide guidelines for the determination of sampling or monitoring schemes 2 materials and methods 2 1 sites description and data collection the hailuo valley is located on the eastern slope of mount gongga on the eastern edge of the tibetan plateau the elevation increases dramatically over a short horizontal distance resulting in contrasting land cover along the elevation gradient the climate is characterized by distinct dry november april and wet may october seasons and almost 80 of the total rainfall occurs during wet seasons hu et al 2018 sun et al 2011 this study focuses on a coniferous forest 3020 m asl dominated by abies fabri picea brachytyla and sparse shrubs and a broadleaf forest 2280 m asl dominated by lithocarpus cleistocarpus and cercidiphyllum japonicum the mean annual precipitation and temperature in the study area are 1884 2 mm and 3 98 c in the coniferous forest and 1572 4 mm and 8 59 c in the broadleaf forest based on the nearby rainfall and temperature monitoring devices i e within a horizontal distance of 500 m which were attached to an eddy covariance flux tower hu et al 2018 for each forest type a hillslope near a stream was chosen to deploy the swp sensors t4e ums corp germany 85 kpa to 100 kpa at three depths 10 50 and 100 cm and three slope positions upper slope u middle slope m and lower slope l with two replicates we used 1 and 2 to denote the replicate in the left and right column fore example u1 denotes the monitoring location at left column on the upper hillslope and the horizontal distance remained constant between the replicates along the hillslope the relief of the two hillslopes are convergent with average slopes of 20 and 26 and areas of 0 40 and 0 36 ha in the coniferous and broadleaf forests respectively the hillslopes are devoid of human activity and the soils are primarily sandy sand 90 with abundant rock fragments table s1 along the both hillslopes the lower boundary of dense plant roots is mainly at 40 60 cm above which the soils have a high infiltration capacity and highly variable root networks below the root boundary rock fragments are more common and the infiltration capacity decreases abruptly wang et al 2022 five throughfall collection trenches were used to synchronously measure the throughfall i e rainfall after canopy interception and were evenly distributed on the hillslopes to reduce the spatial variability of the throughfall all hydrological monitoring equipment was connected to a data logger cr1000 campbell scientific inc usa the data were recorded every 15 min and unreliable data were excluded during relatively dry seasons november april with frozen soils battery damage and maintenance periods 2 2 statistical and temporal stability analysis statistical features of the spatial and temporal variability of the swp were determined the standard deviation σ j and coefficient of variability in space cv j were the basis of the calculations we defined φ ij which denotes the swp measured at location i i 1 2 3 n on the monitoring day j j 1 2 3 m the spatial mean of each monitoring day φ j was calculated as follows to simplify the notations the depth k was omitted in the following expressions 1 φ j 1 n i 1 n φ ij in a similar way the temporal mean value for each monitoring location σ j was defined as follows 2 φ i 1 m j 1 m φ ij the coefficient of variance in space cvj was obtained as follows 3 c v j σ j φ j 1 n 1 i 1 n φ ij φ j 2 φ j where σ j is the spatial standard deviation which reflects the spatial variability of the swp the temporal stability analysis was carried out using the relative difference method the relative difference rd between the φ ij at location i on time j and the spatial mean φ j at the same time was defined as follows 4 rdij φ ij φ j φ j the mean relative difference mrd for location i was then calculated by 5 mr d i 1 m j 1 m r d ij the standard deviation of the mrd was calculated as follows 6 sdr d i 1 m 1 j 1 m r d ij m r d i 2 the time stable locations tend to have a mrd value close to zero and a minimum sdrd as the mrd and sdrd represent the bias and precision when predicting the mean swp thus an introduced index of time stability its that considers the bias and precision gao et al 2020 jacobs et al 2004 zhao et al 2010 was calculated as follows 7 itsi mr d i 2 s d r d i 2 the its is a single metric for identifying sampling locations that are most representative of the mean hillslope swp the lowest its represents the most stable locations and vice versa to assess how the temporal stability indexes depend on different variables a pearson correlation analysis was used to quantify the dependency of the temporal stability indexes i e mrd and its on associated soil and terrain features soil properties and hillslope topography has been widely proven to control the temporal stability of the swp in previous studies vanderlinden et al 2012 soil properties such as bulk density bd clay sand and silt contents soil organic matter som saturated hydraulic conductivity k s and rock fragment content rf reflect the ability of soil to retain and transmit water and is the reason for differences in the swp while in the hillslope area with less soil variability the influence of topographic features on swp variation may increase hence the slope and distance to stream dts were considered for further analysis 2 3 decomposition of spatial variance based on the theory introduced by mittelbach and seneviratne 2012 the spatial variance of the swp σ 2 φ ij can be decomposed into three components 8 σ 2 φ ij σ 2 φ i σ 2 a ij 2 cov φ i a ij where σ 2 φ i is the spatial variance of the temporal mean swp σ 2 a ij is the spatial variance of the temporal anomalies and 2 cov φ i a ij is the spatial covariance between the temporal mean swp at a specific location and its corresponding anomaly aij represents the temporal anomalies and was calculated as follows 9 a ij φ ij φ i in eq 8 σ 2 φ i is the time invariant component whereas the sum of σ 2 a ij and 2 cov φ i a ij which varies over time is the time variant component this allows us to determine the percentage contribution of the individual components to the total variance and their temporal evolution at different soil depths 3 results 3 1 overview of soil water potential dynamics the time series of the mean swp observed on the hillslopes and its responses to throughfall input are shown in fig 1 the swp responded rapidly to throughfall input and then decreased significantly at the end of the throughfall in both forests fig 1 on days with no rain the swp at 50 cm depth exhibited a significant decrease compared with that of the surface soil layer in both forests a summary of φ j during the wet seasons for different soil depths is shown in table 1 with mean values of 26 69 16 13 and 10 63 hpa in the coniferous forest and 21 19 22 22 and 12 50 hpa in the broadleaf forest at 10 50 and 100 cm depths respectively the range of the φ j at 10 50 and 100 cm depths was 70 60 32 29 and 25 39 hpa in the coniferous forest and 53 19 53 84 and 28 93 hpa in the broadleaf forest respectively table 1 during wet seasons the more converged shapes and unimodal distribution of the swp distribution in the coniferous forest are indicative of less variable swp dynamics fig 2 notably in the study period the occurrence of swp 0 was observed at all monitoring locations indicating the ephemeral occurrence of perched water tables it also showed that the percentage duration of the soil saturation status was similar between both forests 36 25 in the coniferous forest and 35 47 in the broadleaf forest the soil layer at 100 cm depth on the lower slope in the coniferous forest was saturated for nearly a third of the study period in this study the standard deviation of the swp decreased with increasing mean swp except for the value for 100 cm depth in the broadleaf forest fig 3 with mean standard deviation values of 7 28 hpa with range 1 72 24 48 hpa 6 13 hpa with range 2 75 12 28 hpa and 8 10 hpa with range 4 03 12 58 hpa in the coniferous forest and 7 93 hpa with range 0 99 21 96 hpa 12 00 hpa with range 1 12 32 04 hpa and 7 69 hpa with range 2 34 16 60 hpa in the broadleaf forest from surface to subsurface soil depths table 1 the cv j was 0 42 with range 0 12 1 03 0 59 with range 0 25 1 13 and 0 82 with range 0 49 3 28 in the broadleaf forest and 0 31 with range 0 07 1 56 0 41 with range 0 08 3 00 and 0 96 with range 0 18 4 67 in the coniferous forest from surface to subsurface soil depths indicative of more variable swp dynamics in the soil root zone in the broadleaf forest table 1 3 2 temporal stability analysis and controlling factors the temporal stability analysis was carried out by calculating the mrd and its of the mean swp on the hillslopes at different monitoring locations and depths fig 4 a c and 5a c the analysis identified the most representative locations where swp measurements should be conducted or continuous monitoring sensors should be installed for estimating the temporal pattern of the hillslope mean swp and explored potential factors that control the temporal stability of the swp the characteristics of the rank ordered mrd for each monitoring location at the three soil depths differed in both forests figs 4 5 the ranges for the mrd at 10 50 and 100 cm depths were 63 5 99 1 and 193 7 in the coniferous forest and 86 2 160 1 and 93 8 in the broadleaf forest respectively the mean value of its was 0 30 with range 0 20 0 47 and 0 33 with range 0 12 0 74 in the coniferous forest and 0 39 with range 0 27 0 47 and 0 65 with range 0 45 1 15 in the broadleaf forest at 10 and 50 cm depths respectively however the its values at 100 cm depth were considerably larger with a mean value of 2 64 with range 0 86 5 57 in the broadleaf forest and 2 67 with range 1 20 5 22 in the coniferous forest the most representative locations in terms of the lowest its values were m1 at 10 cm depth l1 at 50 cm depth and m2 at 100 cm depth in the coniferous forest notably the representative location at 100 cm depth in the coniferous forest was m2 where the swp was closet to the mean of the studied hillslope with an r2 value equal to 0 93 fig 5f despite the value of its being worse than u2 the representative locations identified were l1 at 10 cm depth u2 at 50 cm depth and l1 at 100 cm depth in the broadleaf forest respectively to test the feasibility of the identified representative locations the measured hillslope mean swp was plotted against the representative locations fig 4d f and 5d f the linear fits had high correlation coefficients r 2 0 83 for the three depths indicating these representative locations are suitable for estimating hillslope mean swp at various depths a correlation analysis between the mrd and potential variables revealed that no factors had a controlling effect in the broadleaf forest in contrast the dts and slope were identified as controlling factors in the coniferous forest fig 6 in terms of the its k s was the only factor that affected the temporal stability in the coniferous forest and soil bulk density som clay and rock fragment content were identified as potential variables controlling the temporal stability of the swp in the broadleaf forest 3 3 decomposition of spatial variance as shown in eq 8 the spatial variance of the absolute swp on any given date consists of the temporal mean temporal anomalies i e the absolute swp minus the seasonal mean and covariance the time series of contribution of different components to the total spatial variance during the study period are shown in fig 7 for the study period the time invariant component i e temporal mean contributed the most with mean values of 77 84 2 66 255 07 in the coniferous forest and 93 22 8 54 346 88 in the broadleaf forest table 2 the contribution of the time invariant component in the broadleaf forest was higher than that in the coniferous forest at 10 and 100 cm depths the contribution of the temporal anomalies in the broadleaf forest was higher than that in the coniferous forest at all depths with mean values of 48 75 0 47 250 64 in the broadleaf forest and 24 8 0 18 73 04 in the coniferous forest as a result the covariance was highly negative with a mean value of 41 92 595 28 49 06 in the broadleaf forest compared with that of 2 59 215 54 46 75 in the coniferous forest table 2 the negative covariance implies a negative contribution indicating that the interactions between the factors controlling the temporal mean and those controlling the temporal anomalies are strengthened in the broadleaf forest but such interactions are weak in the coniferous forest as a result the total mean contribution of the time variant component i e the sum of temporal anomalies and covariance were 22 21 and 6 83 in the coniferous and broadleaf forests indicating that the time variant factor is visible only in the broadleaf forest the effects of swp conditions on the contributions of different components were qualitatively characterized figs 8 9 the contribution of the spatial variance of temporal mean generally increased exponentially as the swp increased apart from at 100 cm depth in the broadleaf forest figs 8 9 left column plots of the contribution of the temporal anomalies as a function of the swp yielded a concave curve and the contribution reached the minimum at a spatial mean swp of 30 12 and 6 hpa fig 8 middle column and 17 20 and 11 hpa in the broadleaf forest fig 9 middle column from the surface to subsurface soil layers moreover the distinct contribution of the covariance decreased exponentially which was opposite to the trend of the temporal mean in the coniferous forest it is clear that the swp levels significantly affect the contributions of different components to the total variance moreover the ranges of all components were larger in the broadleaf forest than in the coniferous forest for all soil depths figs 8 9 indicative of more variability in the swp in the broadleaf forest 4 discussions 4 1 statistical and temporal stability analysis both hillslopes were extremely wet during the study period figs 1 and s1 which caused the lower spatial variability compared with the observed values in the humid waldstein experimental site vegetated with norway spruce in germany where the mean swp was 0 to 500 hpa and the standard deviation was 0 34 0 hpa göttlein and manderscheid 1998 in the temperate shaley hills in central usa with deciduous forests the swp ranged from 9 5 to 704 9 hpa yu et al 2015 where the standard deviation of the swp was 0 4 40 4 hpa in the present study a higher standard deviation was observed at 10 and 50 cm depth i e the soil root zone in the broadleaf forest compared with the coniferous forest one reason for this result may be the thermal conditions because higher soil water absorption occurs in the shallow soil root zone in the broadleaf forest table s1 which is equivalent to the conclusions reached in earlier studies that examined the thermal differences between north and south facing hillslopes lin 2006 wang et al 2011 in addition the high standard deviation may have been caused by the higher spatial variability of the soil saturated hydraulic conductivity in the broadleaf forest which concurs with the findings that the higher spatial variability of saturated hydraulic conductivity leads to a higher standard deviation of the soil moisture especially under wet conditions martínez garcía et al 2014 vereecken et al 2007 however the soil moisture range in the form of volumetric content in the soil root zone was smaller in the broadleaf forest fig s1 which can be attributed to the inherent soil properties the relationship between the standard deviation and φ j was downward linear in both forests with the exception at 100 cm depth in the broadleaf forest which is consistent with the results of previous studies hendrickx and wierenga 1990 van pelt and wierenga 2001 yu et al 2015 suggesting that a downward linear relationship is common with φ j ranging from 500 to 0 hpa a possible explanation for the different behavior observed at the 100 cm depth data in the broadleaf forest is that the greater elevation difference and frequent lateral preferential flow reduced the horizontal variance of φ j lin 2006 lin and zhou 2008 williams et al 2009 this reasoning might be supported by the fact that the interquartile ranges of φ j were lower in the broadleaf forest the temporal stability of the spatial pattern of the swp was the highest in the soil root zone 10 and 50 cm depths in terms of the its this result agrees with the results of previous studies conducted in tropical piracicaba brazil cichota et al 2006 and shales hills catchment central usa yu et al 2015 where the temporal stability was higher in the upper soil layers despite the advantages of reducing cost by choosing a single representative location it is still challenging to find one single representative location for the estimation of φ j for different depths at the hillslope scale gao and shao 2012 jacobs et al 2004 liao et al 2017 sur et al 2013 meaning that temporally stable locations at different depths do not always occur at the same location in the coniferous forest as the soil properties on the hillslope are less variable table s1 i e the low standard error of the bulk density clay silt and sand contents the slope and dts were identified as controlling factors on the mrd flatter slope and short dts contribute to the formation of the hydrostatic pressure or water head which was observed at the lower slope with higher standard deviation and variability in the coniferous forest fig 2a whereas the steeper slope and relatively drier swp caused by long dts may drain infiltration water rapidly to the deeper soil layers or lateral direction thus affecting swp variability gao et al 2013 jarecke et al 2021 kaiser and mcglynn 2018 martinez et al 2013 therefore representative sampling monitoring locations should be a moderate distance from streams and on average slope in the coniferous forest which is consistent with the finding of previous studies brocca et al 2009 he et al 2019 sur et al 2013 no factors were significantly related to the mrd in the broadleaf forest which may be because of the extreme soil heterogeneity caused by the dense root networks and abundant rock fragments that result in high spatial variability of the swp meanwhile intrinsically related soil properties i e soil bulk density som clay and rock fragment content were identified as controlling factors on the its the rock fragments increase the soil bulk density and indicate weak weathering conditions lead to low clay content which has been proven to be a key factor influencing temporal stability characteristics jacobs et al 2004 sur et al 2013 the rock fragments provide preferential flow pathways for infiltrating water by changing the soil hydraulic conductivity which is thought to significantly affect the spatial variability of the swp martínez garcía et al 2014 vereecken et al 2007 4 2 contribution to the total variance the spatial variance of the time invariant component varies with the forest types and soil depths table 2 at the surface 10 cm soil depth the contribution from the time invariant component was 2 66 247 53 with a mean value of 59 79 in the coniferous forest and 12 38 311 32 with a mean value of 92 49 in the broadleaf forest these values are much larger than the results from the study of brocca et al 2014 who found that the time invariant component contributed to the total variance by 38 117 with a mean value of 33 in six monitoring networks at a depth of 5 15 cm at sites covered with grass and cropland however our results are similar to those from a study conducted in a loess catchment vegetated with perennial grasses where the time invariant component contribution varied between 21 4 and 282 2 with a mean value of 66 8 in the surface soil layer gao et al 2015 gao et al 2015 attributed the greater contribution of the time invariant component to the increased spatial variability of soil properties caused by the complex topography for instance more fine soil particles are deposited at lower elevations and slope gradients in our study the soil properties along the hillslopes are similar and the differences between the forest types were 32 70 10 94 and 43 47 in the surface soil layer for the temporal mean temporal anomalies and covariance respectively a possible explanation for the differences is complex soil structures and evapotranspiration the variability is mainly controlled by hydraulic conductivity in wet conditions korres et al 2015 vereecken et al 2007 and we found larger and more variable k s in the broadleaf forest than in the coniferous forest due to the denser root network table s1 this significant difference in k s is comparative with the previous study that rice and wheat crop cover showed a similar contribution of the time invariant component due to a minor difference of soil hydraulic properties yetbarek and ojha 2020 the higher evapotranspiration caused by lower elevation in the broadleaf forest leads to an increase in variability leading to an increase in higher contribution from the time invariant component famiglietti et al 1998 korres et al 2015 in the subsurface soil layers the temporal changes in the time invariant i e temporal mean and time variant i e temporal anomalies plus covariance components were similar to those observed in the surface soil layer which has also been recognized in previous studies mittelbach and seneviratne 2012 yetbarek and ojha 2020 the time invariant component is still the predominant contributor with average values exceeding 80 in all subsurface soil layers i e 50 and 100 cm depth in both forests which is higher than the average value of 60 in subsurface soil layers i e 40 60 and 80 cm depth in the loess catchment gao et al 2015 this may be attributed to the coarse soil texture which is mainly characterized by abundant rock fragments thus leading to higher variability of the swp due to the preferential flow wang et al 2022 in our study area the soil wetness clearly affects the contributions of the components and is more pronounced in the coniferous forest figs 8 9 the contribution of the temporal mean generally exponentially increased with increasing mean swp and that of the temporal anomalies became near zero at intermediate swp conditions which is consistent with previous studies gao et al 2015 when there is rainfall input the moist soil quickly becomes near saturated where the static properties i e soil hydraulic conductivity take the controlling role of water flux and determine the variability of the swp the contribution of the temporal anomalies decreased with increasing soil wetness until a threshold was reached at which point connected flow paths and lateral flow dominated the soil hydrological processes resulting in an increased contribution of temporal anomalies grayson et al 1997 jarecke et al 2021 moreover the spatial scale is another important aspect to consider for the analysis in general soil properties and vegetation are expected to be less variable at a smaller spatial scale and the dynamic properties are expected to be dominant in controlling the spatial variance of the swp a decreasing trend in the contribution of the time invariant component to the total spatial variance was observed from 94 over an area of 31 500 km2 mittelbach and seneviratne 2012 to 66 8 over an area of 0 6 km2 gao et al 2015 therefore the contribution of the time invariant component at small scales is expected to be lower brocca et al 2014 gao et al 2015 the unexpected dominant contribution of the time invariant component in this study may be due to the extremely wet soil conditions when nonlocal factors have a dominant control on soil moisture patterns by governing lateral water distribution through subsurface paths on the basis of the recognized two preferred states i e lateral water movement dominates under the wet preferred state whereas vertical movement such as evapotranspiration and vertical drainage dominates under the the dry preferred state of soil moisture famiglietti et al 1998 grayson et al 1997 this result is consistent with yetbarek and ojha 2020 who also found a more significant contribution from the time invariant component in areas with 0 0006 km2 therefore the contradictory results in the present study indicate that the effects of complex subsurface flow induced by static properties e g soil depth soil structures and subsurface layering on the soil moisture water potential dynamics require further investigations 5 conclusions in this study we characterized variability and temporal stability of swp at different soil depths under coniferous and broadleaf forested hillslopes located on the eastern edge of the tibetan plateau the swp showed a higher variability and lower temporal stability in the soil root zone i e 10 and 50 cm depths of the broadleaf forest owing to the higher evapotranspiration and more spatially variable soil saturated hydraulic conductivity compared with the coniferous forest the temporal stability of swp at the deeper soil layer 100 cm depth in both forests was higher than the soil root zone soil depths the correlation analysis between temporal stability indexes and related attributes revealed that the topography i e slope and dts in the coniferous forest and soil properties i e bulk density soc clay and rock fragments contents in the broadleaf forest were identified as the controlling factors on the temporal stability of swp in the hillslopes indicating that the variability of swp was attributed to a complex interaction between topography soil properties vegetation and elevation these results represent a useful support to optimize soil moisture monitoring sampling schemes over areas at the hillslope scale overall the time invariant component temporal mean was the major contribution 59 79 92 73 in the coniferous forest and 91 05 95 96 in the broadleaf forest to the total spatial variance of the swp despite the minor difference in soil properties and continuous rainfall input at the studied scale and region the time variant component temporal anomalies plus covariance was more visible in the coniferous forest 7 27 40 22 than the broadleaf forest 4 04 8 95 the unexpected high time invariant contribution is mainly attributed to the soil spatial structures relating to the preferential flow and the subsurface lateral flow caused by the interaction of the vegetation topography and climate condition in this study soil wetness conditions significantly affect the contribution of individual components in general there is an exponential increase between the contribution of the temporal mean and hillslope mean swp in both forests and a concave shape between the contribution of the temporal anomalies component and hillslope mean swp was also found although this relationship in not so pronounced in the subsurface layer in the broadleaf forest declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this research was supported by the strategic priority research program of chinese academy of sciences grant no xda23090201 and the national natural science foundation of china grant no 41790431 and the second tibetan plateau scientific expedition and research program grant no 2019qzkk0903 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2022 129036 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
2417,soil water potential swp gradients control water and energy fluxes in the soil plant atmosphere continuum exploring the spatial temporal variability of swp at the hillslope scale is an essential step towards developing ecohydrological models in this study swp monitoring was carried out on two contrasting alpine humid forested hillslopes i e coniferous and broadleaf forests at three depths 10 50 and 100 cm the effects of static soil properties and topography and dynamic precipitation dynamics and soil wetness conditions factors on swp dynamics and variability were investigated based on statistical methods temporal stability and variance decomposition analysis the results showed that the swp in the soil root zone 10 and 50 cm depths in the broadleaf forest exhibited higher variability and lower temporal stability than in the coniferous forest likely because of the stronger evapotranspiration and more variable soil hydraulic conductivity the relatively high swp variability in the deeper soil layer 100 cm depth of both forested hillslopes was due to the frequent lateral preferential flow furthermore topographic factors i e distance of hillslope to stream and slope and soil properties clay and rock fragment contents regulated the spatial patterns in swp and influenced representative site selection in the coniferous and broadleaf forests respectively decomposition of the spatial variance showed that the time invariant component was the dominant contributor to the total spatial variance an exponentially increasing relationship between the time invariant component and mean swp and a concave up parabolic shape between the contribution of the temporal anomalies and mean swp were observed our results provide an improved understanding of the temporal and spatial variability in terms of swp in forested hillslopes keywords hillslope scale representative locations spatial variability soil water potential temporal stability data availability data will be made available on request 1 introduction soil moisture is a key variable that controls the exchange of water and energy between the soil vegetation and climate guo and lin 2016 penna et al 2009 seneviratne et al 2010 vereecken et al 2022 however soil moisture is often spatially and temporally heterogeneous due to the complex interaction of precipitation vegetation soil properties and topography teuling and troch 2005 vereecken et al 2014 wang et al 2017 western et al 2002 knowledge of this spatial temporal variability is essential for various scientific investigations including 1 uncertainty estimations of the hydrological models heathman et al 2003 2 optimal location of sites for soil moisture monitoring and sampling wang et al 2008 3 validation of remote sensing products vereecken et al 2014 vereecken et al 2007 previous studies have shown that the spatial temporal variability of soil moisture can be characterized in terms of the standard deviation or coefficient of variance of soil moisture as a function of its mean value famiglietti et al 2008 however there is no consensus regarding the documentation of soil moisture variability at different spatial scales and in variable climate zones korres et al 2015 besides because of practical limitations conclusions regarding soil moisture variability are based almost solely on the near surface of gentle slopes e g see the reviews in brocca et al 2007 vanderlinden et al 2012 steep hillslopes and deep soil layers in alpine humid forests have complex subsurface critical zone structures and frequent rainfall pulses that may severely affect the soil moisture distribution guo and lin 2016 lin 2006 lin and zhou 2008 wang et al 2022 white et al 2019 grayson and western 2001 suggested that the spatial patterns of soil moisture were more related to topographic variables in humid and steep hillslopes where the subsurface lateral flow is likely to occur lin 2006 introduced a conceptual model that considered the significant effects of the preferential lateral flow system on the spatial soil moisture distribution within soil profiles kaiser and mcglynn 2018 identified an increased standard deviation of the water content within a riparian area caused by the effects of lateral flow from connected flow paths compared with that in the uplands area however the variability of soil moisture in steep and humid hillslope scale is still inadequate and requires further investigation the temporal stability analysis method proposed by vachaud et al 1985 has been used as a diagnostic tool to identify time stable locations and potential controlling factors the temporal stability of soil moisture at specific locations was shown to be consistently wetter or drier than the average value leading to a persistent bias which is a reflection of the temporal persistence of the spatial structure martínez fernández and ceballos 2005 this method has been successfully tested in different vegetation types soil properties topographic attributes soil depths and seasonal soil wetness conditions baroni et al 2013 gao et al 2011 hu et al 2010 lin 2006 martínez fernández and ceballos 2005 wang et al 2015 williams et al 2009 zhu et al 2021 cho and choi 2014 found that the meteorological factors contributed more to soil moisture temporal stability on a regional scale zhu et al 2021 showed that throughfall soil bulk density and litter biomass significantly affected the soil moisture temporal stability at a plot scale moreover temporally stable locations identified give the areal mean soil moisture of a hillslope rather than sampling at many random points jacobs et al 2004 which highlights the usefulness of temporal stability analysis the controls on spatial and temporal soil moisture patterns are a combination of static e g topography and soil properties and dynamic e g precipitation and soil wetness conditions variables as such an analysis of the variability of soil moisture patterns can be carried out by considering the absolute soil moisture values expressed in volumetric terms cm3 cm3 or relative values such as temporal anomalies which reduces the impact of the static soil properties brocca et al 2014 mittelbach and seneviratne 2012 yetbarek and ojha 2020 similarly the variability of soil moisture can be decomposed into time invariant i e temporal mean and time variant i e anomalies components it is possible to assess the extent to which these components contribute to the overall spatial soil moisture variability brocca et al 2014 showed that there was much lower spatial variability of temporal anomalies than absolute soil moisture values based on six soil moisture monitoring networks across six countries indicating a major contribution of the time invariant component gao et al 2015 found that the time invariant component provided the primary contribution and varied with soil wetness as such it is important to examine how these components vary as a function of soil wetness conditions as soil moisture variability changes significantly with soil wetness moreover previous studies have focused mainly on regional or catchment scales and near surface soil moisture dynamics and studies of deeper soil layers at different spatial scales are encouraged and required dari et al 2019 gao et al 2015 mittelbach and seneviratne 2012 rötzer et al 2015 soil water potential swp drives water fluxes between soils streams and groundwater but the relationship between swp and variability is controversial due to the nonlinear relationship between swp and soil moisture in addition the studies of swp variability are rather limited compared with the soil moisture novick et al 2022 yang et al 2016 yu et al 2015 therefore this study investigated the swp behaviors at the hillslope scale in which topography and rainfall inputs are expected to have an important role the specific objectives were 1 to investigate spatial temporal variability of swp over contrasting forested hillslopes 2 to evaluate the contribution of the time invariant and variant component in the determination of the spatial variability of swp and 3 to explore how soil wetness conditions alter contribution of the time invariant and variant components the results of this study can be of interest mainly for small scale studies e g hydrological or ecological studies and provide guidelines for the determination of sampling or monitoring schemes 2 materials and methods 2 1 sites description and data collection the hailuo valley is located on the eastern slope of mount gongga on the eastern edge of the tibetan plateau the elevation increases dramatically over a short horizontal distance resulting in contrasting land cover along the elevation gradient the climate is characterized by distinct dry november april and wet may october seasons and almost 80 of the total rainfall occurs during wet seasons hu et al 2018 sun et al 2011 this study focuses on a coniferous forest 3020 m asl dominated by abies fabri picea brachytyla and sparse shrubs and a broadleaf forest 2280 m asl dominated by lithocarpus cleistocarpus and cercidiphyllum japonicum the mean annual precipitation and temperature in the study area are 1884 2 mm and 3 98 c in the coniferous forest and 1572 4 mm and 8 59 c in the broadleaf forest based on the nearby rainfall and temperature monitoring devices i e within a horizontal distance of 500 m which were attached to an eddy covariance flux tower hu et al 2018 for each forest type a hillslope near a stream was chosen to deploy the swp sensors t4e ums corp germany 85 kpa to 100 kpa at three depths 10 50 and 100 cm and three slope positions upper slope u middle slope m and lower slope l with two replicates we used 1 and 2 to denote the replicate in the left and right column fore example u1 denotes the monitoring location at left column on the upper hillslope and the horizontal distance remained constant between the replicates along the hillslope the relief of the two hillslopes are convergent with average slopes of 20 and 26 and areas of 0 40 and 0 36 ha in the coniferous and broadleaf forests respectively the hillslopes are devoid of human activity and the soils are primarily sandy sand 90 with abundant rock fragments table s1 along the both hillslopes the lower boundary of dense plant roots is mainly at 40 60 cm above which the soils have a high infiltration capacity and highly variable root networks below the root boundary rock fragments are more common and the infiltration capacity decreases abruptly wang et al 2022 five throughfall collection trenches were used to synchronously measure the throughfall i e rainfall after canopy interception and were evenly distributed on the hillslopes to reduce the spatial variability of the throughfall all hydrological monitoring equipment was connected to a data logger cr1000 campbell scientific inc usa the data were recorded every 15 min and unreliable data were excluded during relatively dry seasons november april with frozen soils battery damage and maintenance periods 2 2 statistical and temporal stability analysis statistical features of the spatial and temporal variability of the swp were determined the standard deviation σ j and coefficient of variability in space cv j were the basis of the calculations we defined φ ij which denotes the swp measured at location i i 1 2 3 n on the monitoring day j j 1 2 3 m the spatial mean of each monitoring day φ j was calculated as follows to simplify the notations the depth k was omitted in the following expressions 1 φ j 1 n i 1 n φ ij in a similar way the temporal mean value for each monitoring location σ j was defined as follows 2 φ i 1 m j 1 m φ ij the coefficient of variance in space cvj was obtained as follows 3 c v j σ j φ j 1 n 1 i 1 n φ ij φ j 2 φ j where σ j is the spatial standard deviation which reflects the spatial variability of the swp the temporal stability analysis was carried out using the relative difference method the relative difference rd between the φ ij at location i on time j and the spatial mean φ j at the same time was defined as follows 4 rdij φ ij φ j φ j the mean relative difference mrd for location i was then calculated by 5 mr d i 1 m j 1 m r d ij the standard deviation of the mrd was calculated as follows 6 sdr d i 1 m 1 j 1 m r d ij m r d i 2 the time stable locations tend to have a mrd value close to zero and a minimum sdrd as the mrd and sdrd represent the bias and precision when predicting the mean swp thus an introduced index of time stability its that considers the bias and precision gao et al 2020 jacobs et al 2004 zhao et al 2010 was calculated as follows 7 itsi mr d i 2 s d r d i 2 the its is a single metric for identifying sampling locations that are most representative of the mean hillslope swp the lowest its represents the most stable locations and vice versa to assess how the temporal stability indexes depend on different variables a pearson correlation analysis was used to quantify the dependency of the temporal stability indexes i e mrd and its on associated soil and terrain features soil properties and hillslope topography has been widely proven to control the temporal stability of the swp in previous studies vanderlinden et al 2012 soil properties such as bulk density bd clay sand and silt contents soil organic matter som saturated hydraulic conductivity k s and rock fragment content rf reflect the ability of soil to retain and transmit water and is the reason for differences in the swp while in the hillslope area with less soil variability the influence of topographic features on swp variation may increase hence the slope and distance to stream dts were considered for further analysis 2 3 decomposition of spatial variance based on the theory introduced by mittelbach and seneviratne 2012 the spatial variance of the swp σ 2 φ ij can be decomposed into three components 8 σ 2 φ ij σ 2 φ i σ 2 a ij 2 cov φ i a ij where σ 2 φ i is the spatial variance of the temporal mean swp σ 2 a ij is the spatial variance of the temporal anomalies and 2 cov φ i a ij is the spatial covariance between the temporal mean swp at a specific location and its corresponding anomaly aij represents the temporal anomalies and was calculated as follows 9 a ij φ ij φ i in eq 8 σ 2 φ i is the time invariant component whereas the sum of σ 2 a ij and 2 cov φ i a ij which varies over time is the time variant component this allows us to determine the percentage contribution of the individual components to the total variance and their temporal evolution at different soil depths 3 results 3 1 overview of soil water potential dynamics the time series of the mean swp observed on the hillslopes and its responses to throughfall input are shown in fig 1 the swp responded rapidly to throughfall input and then decreased significantly at the end of the throughfall in both forests fig 1 on days with no rain the swp at 50 cm depth exhibited a significant decrease compared with that of the surface soil layer in both forests a summary of φ j during the wet seasons for different soil depths is shown in table 1 with mean values of 26 69 16 13 and 10 63 hpa in the coniferous forest and 21 19 22 22 and 12 50 hpa in the broadleaf forest at 10 50 and 100 cm depths respectively the range of the φ j at 10 50 and 100 cm depths was 70 60 32 29 and 25 39 hpa in the coniferous forest and 53 19 53 84 and 28 93 hpa in the broadleaf forest respectively table 1 during wet seasons the more converged shapes and unimodal distribution of the swp distribution in the coniferous forest are indicative of less variable swp dynamics fig 2 notably in the study period the occurrence of swp 0 was observed at all monitoring locations indicating the ephemeral occurrence of perched water tables it also showed that the percentage duration of the soil saturation status was similar between both forests 36 25 in the coniferous forest and 35 47 in the broadleaf forest the soil layer at 100 cm depth on the lower slope in the coniferous forest was saturated for nearly a third of the study period in this study the standard deviation of the swp decreased with increasing mean swp except for the value for 100 cm depth in the broadleaf forest fig 3 with mean standard deviation values of 7 28 hpa with range 1 72 24 48 hpa 6 13 hpa with range 2 75 12 28 hpa and 8 10 hpa with range 4 03 12 58 hpa in the coniferous forest and 7 93 hpa with range 0 99 21 96 hpa 12 00 hpa with range 1 12 32 04 hpa and 7 69 hpa with range 2 34 16 60 hpa in the broadleaf forest from surface to subsurface soil depths table 1 the cv j was 0 42 with range 0 12 1 03 0 59 with range 0 25 1 13 and 0 82 with range 0 49 3 28 in the broadleaf forest and 0 31 with range 0 07 1 56 0 41 with range 0 08 3 00 and 0 96 with range 0 18 4 67 in the coniferous forest from surface to subsurface soil depths indicative of more variable swp dynamics in the soil root zone in the broadleaf forest table 1 3 2 temporal stability analysis and controlling factors the temporal stability analysis was carried out by calculating the mrd and its of the mean swp on the hillslopes at different monitoring locations and depths fig 4 a c and 5a c the analysis identified the most representative locations where swp measurements should be conducted or continuous monitoring sensors should be installed for estimating the temporal pattern of the hillslope mean swp and explored potential factors that control the temporal stability of the swp the characteristics of the rank ordered mrd for each monitoring location at the three soil depths differed in both forests figs 4 5 the ranges for the mrd at 10 50 and 100 cm depths were 63 5 99 1 and 193 7 in the coniferous forest and 86 2 160 1 and 93 8 in the broadleaf forest respectively the mean value of its was 0 30 with range 0 20 0 47 and 0 33 with range 0 12 0 74 in the coniferous forest and 0 39 with range 0 27 0 47 and 0 65 with range 0 45 1 15 in the broadleaf forest at 10 and 50 cm depths respectively however the its values at 100 cm depth were considerably larger with a mean value of 2 64 with range 0 86 5 57 in the broadleaf forest and 2 67 with range 1 20 5 22 in the coniferous forest the most representative locations in terms of the lowest its values were m1 at 10 cm depth l1 at 50 cm depth and m2 at 100 cm depth in the coniferous forest notably the representative location at 100 cm depth in the coniferous forest was m2 where the swp was closet to the mean of the studied hillslope with an r2 value equal to 0 93 fig 5f despite the value of its being worse than u2 the representative locations identified were l1 at 10 cm depth u2 at 50 cm depth and l1 at 100 cm depth in the broadleaf forest respectively to test the feasibility of the identified representative locations the measured hillslope mean swp was plotted against the representative locations fig 4d f and 5d f the linear fits had high correlation coefficients r 2 0 83 for the three depths indicating these representative locations are suitable for estimating hillslope mean swp at various depths a correlation analysis between the mrd and potential variables revealed that no factors had a controlling effect in the broadleaf forest in contrast the dts and slope were identified as controlling factors in the coniferous forest fig 6 in terms of the its k s was the only factor that affected the temporal stability in the coniferous forest and soil bulk density som clay and rock fragment content were identified as potential variables controlling the temporal stability of the swp in the broadleaf forest 3 3 decomposition of spatial variance as shown in eq 8 the spatial variance of the absolute swp on any given date consists of the temporal mean temporal anomalies i e the absolute swp minus the seasonal mean and covariance the time series of contribution of different components to the total spatial variance during the study period are shown in fig 7 for the study period the time invariant component i e temporal mean contributed the most with mean values of 77 84 2 66 255 07 in the coniferous forest and 93 22 8 54 346 88 in the broadleaf forest table 2 the contribution of the time invariant component in the broadleaf forest was higher than that in the coniferous forest at 10 and 100 cm depths the contribution of the temporal anomalies in the broadleaf forest was higher than that in the coniferous forest at all depths with mean values of 48 75 0 47 250 64 in the broadleaf forest and 24 8 0 18 73 04 in the coniferous forest as a result the covariance was highly negative with a mean value of 41 92 595 28 49 06 in the broadleaf forest compared with that of 2 59 215 54 46 75 in the coniferous forest table 2 the negative covariance implies a negative contribution indicating that the interactions between the factors controlling the temporal mean and those controlling the temporal anomalies are strengthened in the broadleaf forest but such interactions are weak in the coniferous forest as a result the total mean contribution of the time variant component i e the sum of temporal anomalies and covariance were 22 21 and 6 83 in the coniferous and broadleaf forests indicating that the time variant factor is visible only in the broadleaf forest the effects of swp conditions on the contributions of different components were qualitatively characterized figs 8 9 the contribution of the spatial variance of temporal mean generally increased exponentially as the swp increased apart from at 100 cm depth in the broadleaf forest figs 8 9 left column plots of the contribution of the temporal anomalies as a function of the swp yielded a concave curve and the contribution reached the minimum at a spatial mean swp of 30 12 and 6 hpa fig 8 middle column and 17 20 and 11 hpa in the broadleaf forest fig 9 middle column from the surface to subsurface soil layers moreover the distinct contribution of the covariance decreased exponentially which was opposite to the trend of the temporal mean in the coniferous forest it is clear that the swp levels significantly affect the contributions of different components to the total variance moreover the ranges of all components were larger in the broadleaf forest than in the coniferous forest for all soil depths figs 8 9 indicative of more variability in the swp in the broadleaf forest 4 discussions 4 1 statistical and temporal stability analysis both hillslopes were extremely wet during the study period figs 1 and s1 which caused the lower spatial variability compared with the observed values in the humid waldstein experimental site vegetated with norway spruce in germany where the mean swp was 0 to 500 hpa and the standard deviation was 0 34 0 hpa göttlein and manderscheid 1998 in the temperate shaley hills in central usa with deciduous forests the swp ranged from 9 5 to 704 9 hpa yu et al 2015 where the standard deviation of the swp was 0 4 40 4 hpa in the present study a higher standard deviation was observed at 10 and 50 cm depth i e the soil root zone in the broadleaf forest compared with the coniferous forest one reason for this result may be the thermal conditions because higher soil water absorption occurs in the shallow soil root zone in the broadleaf forest table s1 which is equivalent to the conclusions reached in earlier studies that examined the thermal differences between north and south facing hillslopes lin 2006 wang et al 2011 in addition the high standard deviation may have been caused by the higher spatial variability of the soil saturated hydraulic conductivity in the broadleaf forest which concurs with the findings that the higher spatial variability of saturated hydraulic conductivity leads to a higher standard deviation of the soil moisture especially under wet conditions martínez garcía et al 2014 vereecken et al 2007 however the soil moisture range in the form of volumetric content in the soil root zone was smaller in the broadleaf forest fig s1 which can be attributed to the inherent soil properties the relationship between the standard deviation and φ j was downward linear in both forests with the exception at 100 cm depth in the broadleaf forest which is consistent with the results of previous studies hendrickx and wierenga 1990 van pelt and wierenga 2001 yu et al 2015 suggesting that a downward linear relationship is common with φ j ranging from 500 to 0 hpa a possible explanation for the different behavior observed at the 100 cm depth data in the broadleaf forest is that the greater elevation difference and frequent lateral preferential flow reduced the horizontal variance of φ j lin 2006 lin and zhou 2008 williams et al 2009 this reasoning might be supported by the fact that the interquartile ranges of φ j were lower in the broadleaf forest the temporal stability of the spatial pattern of the swp was the highest in the soil root zone 10 and 50 cm depths in terms of the its this result agrees with the results of previous studies conducted in tropical piracicaba brazil cichota et al 2006 and shales hills catchment central usa yu et al 2015 where the temporal stability was higher in the upper soil layers despite the advantages of reducing cost by choosing a single representative location it is still challenging to find one single representative location for the estimation of φ j for different depths at the hillslope scale gao and shao 2012 jacobs et al 2004 liao et al 2017 sur et al 2013 meaning that temporally stable locations at different depths do not always occur at the same location in the coniferous forest as the soil properties on the hillslope are less variable table s1 i e the low standard error of the bulk density clay silt and sand contents the slope and dts were identified as controlling factors on the mrd flatter slope and short dts contribute to the formation of the hydrostatic pressure or water head which was observed at the lower slope with higher standard deviation and variability in the coniferous forest fig 2a whereas the steeper slope and relatively drier swp caused by long dts may drain infiltration water rapidly to the deeper soil layers or lateral direction thus affecting swp variability gao et al 2013 jarecke et al 2021 kaiser and mcglynn 2018 martinez et al 2013 therefore representative sampling monitoring locations should be a moderate distance from streams and on average slope in the coniferous forest which is consistent with the finding of previous studies brocca et al 2009 he et al 2019 sur et al 2013 no factors were significantly related to the mrd in the broadleaf forest which may be because of the extreme soil heterogeneity caused by the dense root networks and abundant rock fragments that result in high spatial variability of the swp meanwhile intrinsically related soil properties i e soil bulk density som clay and rock fragment content were identified as controlling factors on the its the rock fragments increase the soil bulk density and indicate weak weathering conditions lead to low clay content which has been proven to be a key factor influencing temporal stability characteristics jacobs et al 2004 sur et al 2013 the rock fragments provide preferential flow pathways for infiltrating water by changing the soil hydraulic conductivity which is thought to significantly affect the spatial variability of the swp martínez garcía et al 2014 vereecken et al 2007 4 2 contribution to the total variance the spatial variance of the time invariant component varies with the forest types and soil depths table 2 at the surface 10 cm soil depth the contribution from the time invariant component was 2 66 247 53 with a mean value of 59 79 in the coniferous forest and 12 38 311 32 with a mean value of 92 49 in the broadleaf forest these values are much larger than the results from the study of brocca et al 2014 who found that the time invariant component contributed to the total variance by 38 117 with a mean value of 33 in six monitoring networks at a depth of 5 15 cm at sites covered with grass and cropland however our results are similar to those from a study conducted in a loess catchment vegetated with perennial grasses where the time invariant component contribution varied between 21 4 and 282 2 with a mean value of 66 8 in the surface soil layer gao et al 2015 gao et al 2015 attributed the greater contribution of the time invariant component to the increased spatial variability of soil properties caused by the complex topography for instance more fine soil particles are deposited at lower elevations and slope gradients in our study the soil properties along the hillslopes are similar and the differences between the forest types were 32 70 10 94 and 43 47 in the surface soil layer for the temporal mean temporal anomalies and covariance respectively a possible explanation for the differences is complex soil structures and evapotranspiration the variability is mainly controlled by hydraulic conductivity in wet conditions korres et al 2015 vereecken et al 2007 and we found larger and more variable k s in the broadleaf forest than in the coniferous forest due to the denser root network table s1 this significant difference in k s is comparative with the previous study that rice and wheat crop cover showed a similar contribution of the time invariant component due to a minor difference of soil hydraulic properties yetbarek and ojha 2020 the higher evapotranspiration caused by lower elevation in the broadleaf forest leads to an increase in variability leading to an increase in higher contribution from the time invariant component famiglietti et al 1998 korres et al 2015 in the subsurface soil layers the temporal changes in the time invariant i e temporal mean and time variant i e temporal anomalies plus covariance components were similar to those observed in the surface soil layer which has also been recognized in previous studies mittelbach and seneviratne 2012 yetbarek and ojha 2020 the time invariant component is still the predominant contributor with average values exceeding 80 in all subsurface soil layers i e 50 and 100 cm depth in both forests which is higher than the average value of 60 in subsurface soil layers i e 40 60 and 80 cm depth in the loess catchment gao et al 2015 this may be attributed to the coarse soil texture which is mainly characterized by abundant rock fragments thus leading to higher variability of the swp due to the preferential flow wang et al 2022 in our study area the soil wetness clearly affects the contributions of the components and is more pronounced in the coniferous forest figs 8 9 the contribution of the temporal mean generally exponentially increased with increasing mean swp and that of the temporal anomalies became near zero at intermediate swp conditions which is consistent with previous studies gao et al 2015 when there is rainfall input the moist soil quickly becomes near saturated where the static properties i e soil hydraulic conductivity take the controlling role of water flux and determine the variability of the swp the contribution of the temporal anomalies decreased with increasing soil wetness until a threshold was reached at which point connected flow paths and lateral flow dominated the soil hydrological processes resulting in an increased contribution of temporal anomalies grayson et al 1997 jarecke et al 2021 moreover the spatial scale is another important aspect to consider for the analysis in general soil properties and vegetation are expected to be less variable at a smaller spatial scale and the dynamic properties are expected to be dominant in controlling the spatial variance of the swp a decreasing trend in the contribution of the time invariant component to the total spatial variance was observed from 94 over an area of 31 500 km2 mittelbach and seneviratne 2012 to 66 8 over an area of 0 6 km2 gao et al 2015 therefore the contribution of the time invariant component at small scales is expected to be lower brocca et al 2014 gao et al 2015 the unexpected dominant contribution of the time invariant component in this study may be due to the extremely wet soil conditions when nonlocal factors have a dominant control on soil moisture patterns by governing lateral water distribution through subsurface paths on the basis of the recognized two preferred states i e lateral water movement dominates under the wet preferred state whereas vertical movement such as evapotranspiration and vertical drainage dominates under the the dry preferred state of soil moisture famiglietti et al 1998 grayson et al 1997 this result is consistent with yetbarek and ojha 2020 who also found a more significant contribution from the time invariant component in areas with 0 0006 km2 therefore the contradictory results in the present study indicate that the effects of complex subsurface flow induced by static properties e g soil depth soil structures and subsurface layering on the soil moisture water potential dynamics require further investigations 5 conclusions in this study we characterized variability and temporal stability of swp at different soil depths under coniferous and broadleaf forested hillslopes located on the eastern edge of the tibetan plateau the swp showed a higher variability and lower temporal stability in the soil root zone i e 10 and 50 cm depths of the broadleaf forest owing to the higher evapotranspiration and more spatially variable soil saturated hydraulic conductivity compared with the coniferous forest the temporal stability of swp at the deeper soil layer 100 cm depth in both forests was higher than the soil root zone soil depths the correlation analysis between temporal stability indexes and related attributes revealed that the topography i e slope and dts in the coniferous forest and soil properties i e bulk density soc clay and rock fragments contents in the broadleaf forest were identified as the controlling factors on the temporal stability of swp in the hillslopes indicating that the variability of swp was attributed to a complex interaction between topography soil properties vegetation and elevation these results represent a useful support to optimize soil moisture monitoring sampling schemes over areas at the hillslope scale overall the time invariant component temporal mean was the major contribution 59 79 92 73 in the coniferous forest and 91 05 95 96 in the broadleaf forest to the total spatial variance of the swp despite the minor difference in soil properties and continuous rainfall input at the studied scale and region the time variant component temporal anomalies plus covariance was more visible in the coniferous forest 7 27 40 22 than the broadleaf forest 4 04 8 95 the unexpected high time invariant contribution is mainly attributed to the soil spatial structures relating to the preferential flow and the subsurface lateral flow caused by the interaction of the vegetation topography and climate condition in this study soil wetness conditions significantly affect the contribution of individual components in general there is an exponential increase between the contribution of the temporal mean and hillslope mean swp in both forests and a concave shape between the contribution of the temporal anomalies component and hillslope mean swp was also found although this relationship in not so pronounced in the subsurface layer in the broadleaf forest declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this research was supported by the strategic priority research program of chinese academy of sciences grant no xda23090201 and the national natural science foundation of china grant no 41790431 and the second tibetan plateau scientific expedition and research program grant no 2019qzkk0903 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2022 129036 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
2418,data assimilation for high dimensional parameter joint inversion of multiple time varying source strength and hydraulic conductivity fields can be computationally intensive as a large number of forward model runs are usually required in this study a deep neural network based surrogate is proposed to replace the forward model in the data assimilation process to efficiently achieve high dimensional parameter inversion the deep convolutional encoding decoding network architecture is used to leverage the advantages of the convolutional network in processing image like data where the high dimensional input and output fields of the forward model are expressed as images the encoding network extracts the main features of the multiple time varying source input image and high dimensional hydraulic conductivity fields and the decoding network refines the extracted features to generate the output hydraulic head and contaminant concentration fields the residual dense convolutional neural network rdcnn is proposed by combining residual learning with a densely connected convolutional neural network to solve the image regression problem for surrogate construction iterative local updating ensemble smoother ilues is utilized to assimilate hydraulic head and contaminant concentration data to inverse high dimensional parameters the proposed method is evaluated by jointly inversing the high dimensional hydraulic conductivity and source parameters for a synthetic multiple source contaminated aquifer the results indicate that compared to the surrogate constructed by dense convolutional neural network dcnn without addressing residual learning the rdcnn surrogate captures the model input output relationship better with relatively high training efficiency the rdcnn surrogate coupled ilues achieves state of the art performance in terms of inversion accuracy of 9 pollution source parameters and 255 hydraulic conductivity field parameters and computational efficiency in comparison to the ilues based on the forward model keywords ensemble data assimilation high dimensional parameter inversion surrogate model residual learning convolutional neural network data availability data will be made available on request 1 introduction joint estimation of groundwater contaminant source parameters and hydraulic conductivity field are essential for assessing the impact of a groundwater contaminant incident and designing a remediation plan for decision makers jiang et al 2021 xing et al 2019 this requires solving an inverse problem to infer parameters related to the contaminant source and hydraulic conductivity field based on sparsely available hydraulic heads and contaminant concentrations since obtaining this information directly is impractical white 2018 xu and gómez hernández 2018 zhang et al 2016 due to the subsurface substantial heterogeneities high dimensional parameters are required to reconstruct the physical properties of the aquifer and contaminant release history joint estimation of high dimensional parameters such as contaminant source information and hydraulic conductivity field thus incurs a super linear increase in computational cost different methods for solving the inverse problem can be used depending on various available measurement data traditional simulation optimization inversion methods such as the gradient type method e g nonlinear programming embedded approach and heuristic search method e g simulated annealing genetic algorithm have been applied to identify groundwater contaminant sources ayaz et al 2022 ayvaz 2016 chakraborty and prakash 2020 datta et al 2011 traditional methods could not fully quantify the uncertainty of the inverse results and the ill posed nature of inverse problems may result in nonexistent or non unique solutions such uncertainty can be addressed using bayesian inversion approaches in which the unknown parameters are considered as random variables and their posterior distributions may well be determined by markov chain monte carlo mcmc sampling rajabi and ataie ashtiani 2016 xu and valocchi 2015 the computational cost is prohibitive when employing this approach to tackle a high dimensional inverse problem as a large number of simulation models are repetitively called to estimate the likelihood zhang et al 2015 ensemble based data assimilation methods such as ensemble smoother es evensen and leeuwen 1999 and ensemble kalman filter enkf evensen 2003 have become increasingly universal for solving the inverse problem in groundwater hydrology because of their monte carlo nature to simultaneously estimate unknown model parameters and associated uncertainty li et al 2012 panzeri et al 2013 xu et al 2022 unlike enkf es simultaneously assimilates all available data to compute a global update without modifying the restart files at each assimilation step and eliminates inconsistency issues between model parameters and state variables by updating only model parameters zhang et al 2018 in addition diverse iterative forms and variants of es have been presented and effectively utilized in groundwater inversion work to improve the performance of es in handling high dimensional and highly nonlinear situations ju et al 2018 li et al 2018 todaro et al 2021 zhang et al 2018 to further improve the applicability and efficiency of es for strongly nonlinear problems zhang et al 2018 proposed an iterative local updating ensemble smoother ilues in which the observations and each sample are updated locally using the es scheme instead of globally and the local ensemble is defined in terms of an integrated measure of distance to this sample the ilues is then implemented in this work as an inversion approach to jointly estimate high dimensional parameters of the contaminant source and hydraulic conductivity field generally a large number of iterations and ensemble size of ilues are required to inverse high dimensional parameters necessitating a larger number of forward model runs which is computationally demanding mo et al 2019a zhang et al 2018 surrogate models are cheaper to execute models that approximate the input output relationship of a computationally intensive model neumerous surrogate models have been extensively employed in studies of the groundwater inverse problem keating et al 2010 mo et al 2017 xu et al 2017 yan et al 2019 projection based methods can preserve the structure of a full order model but they are incapable of efficiently addressing severely nonlinear problems and suffer from stability issues chaturantabut and sorensen 2010 lassila et al 2014 with limited training data gaussian processes have been utilized to quantify the parameter uncertainty but this method relies on certain a priori assumptions on the relationship between inputs and outputs and it is difficult to guarantee computational efficiency when dealing with large amounts of data atkinson and zabaras 2019 taccari et al 2022 recently deep neural networks dnn based surrogate modeling techniques have acquired increasing prominence bao et al 2020 panahi et al 2020 yu et al 2020 zhu and zabaras 2018 developed an image to image regression method with a fully convolutional neural network to directly capture the complex mapping relationship between the high dimensional input and the output of the forward model without explicit dimensionality reduction techniques similar to the computer vision problem both the high dimensional input and output fields are regarded as images and the surrogate modeling process is turned into an image regression issue using fully convolutional neural networks for image processing efficient surrogate models for complicated high dimensional problems are obtained zhu and zabaras 2018 mo et al 2019b constructed a surrogate for the multiphase flow model using a deep fully convolutional encoder decoder network where the encoder captures multi scale features from high dimensional input images and the decoder reconstructs the output fields mo et al 2019a additionally proposed a deep autoregressive theory in the dense convolutional encoder decoder network to construct an efficient surrogate for the groundwater contaminant transport model which is coupled with ilues to successfully achieve high dimensional parameter estimation he et al 2021 coupled a theory guided full convolutional neural network tgfcnn based surrogate with an iterative ensemble smoother ies to efficiently predict the unknown parameters of a contaminant transport model and the proposed tgfcnn incorporates physical constraints into the loss function to enhance the performance of cnn resulting in greater accuracy than conventional cnn models zhou and tartakovsky 2020 attempted to combine the cnn based surrogate with an adaptive mcmc method to reduce the computational cost which diminishes the sampling error of the approximate likelihood function despite the numerous attempts of neural network based surrogate models to solve groundwater inversion problems the majority of studies of surrogate models based on image to image regression theory consider either a single contaminant source or low dimensional unknown parameters while few studies consider both first as the dimensionality of the inversion parameters rises it becomes more challenging to ensure the accuracy of inversion using surrogate models second the interaction between multiple contaminant sources aggravates surrogates difficulties in capturing the relationship between input and output images based on the dense convolutional encoder decoder network architecture the present work formulates a deep neural network to construct a surrogate model which is then combined with the ilues method to jointly inverse high dimensional hydraulic conductivity parameters and multiple source information with high efficiency for groundwater flow and transport models the residual dense convolutional neural network rdcnn is a simplified deep neural network designed to improve the training efficiency of surrogate modeling under the premise of ensuring the approximation accuracy of complex mapping relationships between high dimensional inputs and outputs of the forward model the rdcnn based surrogate is compared to the dcnn based surrogate to evaluate the performance of the proposed improvement strategy for fully convolutional encoding decoding networks in terms of prediction accuracy of head and contaminant concentration fields given multiple time varying contaminant sources and hydraulic conductivity fields the influence of network architecture training sample size and network parameters on the prediction accuracy of a deep neural network constructed surrogate is presented multiple contaminant source information and high dimensional hydraulic conductivity parameters are concurrently inversed for a synthetic case using a rdcnn surrogate based ilues method the remaining sections are organized as follows section 2 presents the theory of the ilues method and the adopted image to image deep learning method based on the rdcnn architecture section 3 provides an overview of the problem formulation model parameter configuration and surrogate model training in section 4 the performance of the proposed method is evaluated by resolving a high dimensional parameter inverse problem for a synthetic model finally section 5 offers a summary of the conclusions 2 methodology 2 1 governing equations the forward model of the groundwater flow and transport process is described by the governing equations which is divided into two parts the flow equation and the contaminant transport equation the governing partial differential equation for the steady state saturated flow in a two dimensional aquifer is as follows 1 x i k ij h x j w 0 i j 1 2 where k ij is the hydraulic conductivity l t 1 h is the hydraulic head l x i and x j are the cartesian coordinates and w is the volumetric source positive or sink negative flux per unit volume t 1 the head distribution is used to determine the velocity of groundwater flow v i l t 1 in terms of darcy s law as follows 2 v i k ij θ h x j i j 1 2 where θ is the porosity dimensionless advection and dispersion are considered the dominant processes in the contaminant transport model of this study the advection dispersion equation can be written as follows to calculate the contaminant concentration in a two dimensional model 3 θ c t x i θ v i c x i d ij θ c x j c s w 0 i j 1 2 c represents the concentration of the contaminant m l 3 d ij is the hydrodynamic dispersion coefficient a second order tensor l 2 t 1 and c s is the concentration of sources or sinks m l 3 due to the fact that molecular diffusion is generally far lower than hydrodynamic dispersion it is neglected here and the hydrodynamic dispersion coefficient d ij is defined as 4 d x 1 x 1 α l v x 1 2 α t v x 2 2 v d x 2 x 2 α l v x 2 2 α t v x 1 2 v d x 1 x 2 d x 2 x 1 α l α t v x 1 v x 2 v where α l and α t denote the longitudinal and the transverse dispersivity l respectively v equals the magnitude of velocity vector 2 2 iterative local updating ensemble smoother the relationship between the vector of measurements and the vector of model parameters is assumed to be simplified to the following form 5 d g m ε where d is the measurement vector m is the vector of model parameters g is the forward model and ε is a vector of gaussian distributed measurement error with mean e ε 0 and covariance c d ε j ε j t compared to the traditional ensemble smoother es the iterative local updating ensemble smoother ilues proposes a local updating idea to deal with high dimensional and strongly nonlinear problems more effectively and to assimilate available observation data iteratively multiple times zhang et al 2018 fig 1 depicts the framework of the ilues algorithm ilues can be implemented according to the following steps step1 initialization as the initial parameter ensemble n e equally likely stochastic parameter realizations are generated from the prior distribution it is also possible to build the output ensemble for the initial parameter ensemble by solving the forward model 6 m ini m 1 ini m 2 ini m n e ini 7 d ini g m 1 ini g m 2 ini g m n e ini the subscript represents the index of the ensemble member and the superscript ini is short for initialization which means the initial iteration step2 determination of local ensemble the distance j m between the measurements d and the sample m j f is measured synthetically from both the space of the model responses j 1 and the model parameters j 2 to determine the local ensemble of the sample m j f j 1 2 n e 8 j m j 1 m j 1 max β j 2 m j 2 max 9 j 1 m g m d t c d 1 g m d 10 j 2 m m m j f t c mm 1 m m j f j 1 m is the distance between the predicted data by forward model g m and the measurements d j 2 m is the distance between the model parameters m and the selected samples m j f β 0 represents the relative weight of two distance metrics where j 1 max and j 2 max are the maximum values of j 1 m and j 2 m respectively c mm is the auto covariance matrix of the model parameters m step3 update the local ensemble the local ensemble of m j f containing the n loc α n e α 0 1 samples with the n loc lowest j values can be updated by the ensemble smoother 11 m j k a m j k f c md loc f c dd loc f c d 1 d k g m j k f where k 1 n loc α is the ratio between the local ensemble m j loc f and the global ensemble m f c dd loc f is the n d n d auto covariance matrix of measurement d loc f n d is the total number of measurements assimilated d k n d obs c d is the measurement with d obs representing the n d 1 vector of observation data and c d e ε k ε k t representing the n d n d covariance matrix of measurement errors of observation data randomly selected from the updated local ensemble m j loc a m j 1 a m j 2 a m j n loc a sample m j loc a is regarded as the updated sample of m j f j 1 2 n e following this procedure the updated global ensemble m a m 1 loc a m 2 loc a m n e loc a can be obtained 2 3 convolutional neural network convolutional neural networks cnns have advantages in characterizing the spatial information of images and have been widely implemented in high dimensional image processing in general the following formulations can be used to represent two successive cnn layers 12 m l μ l w l m l 1 b l where l is the layer number m l 1 and m l denote the input and output respectively of the lth layer μ l indicates the nonlinear activation function such as the sigmoid function recitified linear unit relu and hyperbolic tangent function tanh w l is the kernel weight matrix b l represents the bias vector not taken into account in this study fully connected neural networks require a large number of layers to construct an effective model which dramatically increases the number of network parameters and results in extremely low computing efficiency cnn s two main characteristics namely its local connectivity and weight sharing scheme significantly minimize the number of parameters involved in its training process local connectivity signifies that each neuron in the convolutional layer is only connected to the neuron in a certain local window in the adjacent layer resulting in much fewer parameters between layers compared to a fully connected network in addition the convolutional kernel is viewed as a feature extractor that captures only the specific local features of the input image then using a weight sharing scheme a series of kernels create an entire convolutional layer to extract global features for example an input pixel x a b of a two dimensional image at location a b is processed by a convolutional layer c which is composed of a series of convolutional kernels ω n r z 1 z 2 n 1 n f to obtain the corresponding feature value c n x a b by the following expressions 13 c n x a b μ i 1 z 1 j 1 z 2 ω i j n x a i b j where nf is the total number of feature maps in the output layer and z denotes the size of kernel matrices given the input feature map size h f x w f x the output feature map size h f y w f y can be expressed as 14 h f y h f x 2 p z s 1 w f y w f x 2 p z s 1 where represents the floor function p denotes the zero padding which is the padding on each side of the input image s boundary with zeros in order to maintain a certain map size and s represents the stride which determines the pixel distance between the kernel s center and the center of the next successive move here three parameters including the stride s the zero padding p and the kernel size z are critical for the convolutional layer and should be calculated carefully before layer design 2 4 residual dense convolutional neural network a convolutional neural network is designed to capture the spatial characteristics of a high dimensional input image by first coarsening it the image is then refined in order to recover its feature information in a typical encoding decoding network architecture feature maps containing the primary features of the input image are retrieved by convolution operations in the encoder while upscaling is employed in the decoder to restore the feature map to the original image fig 2 is a schematic representation of the encoding and decoding process of a deep convolutional neural network in general the deeper neural networks enhance a model s ability to fit data which might lead to an over fitting issue and make it difficult for the model to converge simultaneously to reduce the required training samples and improve the parameter efficiency of the deep neural network a dense connected structure dense block is proposed to connect all the layers so as to facilitate information flow between the nets and avoid the parameter explosion caused by increasing network depth huang et al 2017 zhu and zabaras 2018 more specifically for a layer in the densely connected structure the feature maps of all previous layers are regarded as its input and the layer s own feature maps are utilized as the input of all subsequent layers this connection structure can effectively reduce information loss allow feature reuse and maximize feature propagation efficiency meanwhile network parameters are not obviously increased by using this structure thereby significantly guaranteeing the efficiency of training surrogate models the information flow between layers in a dense connected structure can be expressed as 15 x l f x 0 x 1 x l 1 where represents the concatenation of all output feature maps preceding the lth layer and the same feature map size is the prerequisite for the concatenation operation consequently the structure of a dense block is mainly defined by two parameters the number of network layers n l inside the structure and the growth rate which is generally quantified by the number of output feature maps of each layer n f each layer of a dense connected network contains a sequential combination of batch normalization bn relu activation function and convolution operation conv the number of feature maps throughout the entire dense connected block is n 0 n f n l where n 0 is the number of input feature maps fig 3 is a schematic diagram of the dense connected block structure with 3 layers n l 3 and a growth rate of 4 n f 4 to improve the prediction accuracy of the surrogate model constructed using a deep convolutional neural network it is necessary to increase the depth of the convolutional neural network by incorporating a number of dense connected blocks however a significant number of dense connections will result in the explosion of the feature map a transition block is positioned between two adjacent dense connected blocks in which a convolution operation is utilized to decrease the number of output feature maps fig 4 in addition the transition block can assist in adjusting the size of the feature map during the process of extracting the input image features and enlarging the feature map for instance the convolution layer in the transition block of the encoding network halves the size of the feature map which is known as downsampling conversely through the transposed convolution layer in the decoding network the transition block doubles the size of the feature map which is known as upsampling fig 4b and fig 4c depict the schematic diagrams for operations in each layer of the transition block structure in the encoding and decoding network respectively in addition to the dense connection structure residual learning is employed to prevent the gradient vanishing and explosion of the deep network thereby considerably improving the training efficiency of the model residuals have been recently applied in deep cnns for objection detection and image recognition successfully yue et al 2018 and the introduction of residual learning is more advantageous in efficiency than the original structure jégou et al 2010 therefore this study proposes a residual dense convolutional neural network rdcnn that combines the feature reuse idea of dense connected blocks and residual learning to achieve a streamlined deep neural network a residual dense block rdb of the rdcnn is formulated by densely connected blocks transition blocks and skip connections which is shown in fig 4a a typical cnn model has a plain architecture in which the input of each layer comes directly from the output of the previous layer in the residual block however the inputs are processed by two different functions and the final output is the summation of their outputs the rdb can be illustrated in the following form fooladgar and kasaei 2020 16 x out f x l r x l where x l and x out are the input and output of the lth rdb respectively the function r is regarded as identity mapping which implements a skip connection to ensure that the information flow can pass through the network smoothly and a typical one is r x l x l the function f x l is stated as follows 17 f x l f t f d x l x l 1 x l m where x out 1 f d x l x l 1 x l m represents the output of a densely connected block and the function f d is a sequential combination of the bn relu and 3 3 conv each of which is defined as a layer of the dense block and fig 3 illustrates the overall architecture of a densely connected block with 3 layers and operations on each layer f t indicates the non linear transformation conducted in the transition block and comprises a sequential combination of the bn relu 1 1 conv bn relu and 3 3 conv transposed conv performed in the encoding decoding transition block as depicted in fig 4b and fig 4c respectively particularly since the size of the feature map is halved following the convolution transition block in the encoding network the summation in equation 16 necessitates an additional down sampling operation in the skip connection the r in equation 16 of this work is considered to be the conv operation to replace the typical identity mapping to reslove the inconsistent problem of the size of the feature map fig 4a similarly a deconvolution operation is added to the skip connection in order to achieve upsampling and maintain the size of the feature map in the decoding network a brief architecture of rdcnn to construct a surrogate is shown in fig 5 the rdcnn network mainly comprises two phases encoding and decoding the first phase encodes the input images into compact feature maps the second phase recovers the feature maps to the target output images i e hydraulic head and contaminant concentration maps the encoding path comprises a convolutional layer and a residual dense block in this work instead of employing pooling operations to reduce the size of the feature map the initial convolutional layer which consists of 7 convolutional kernels with a stride of 2 and a padding of 3 is exploited to downsample the feature map by half the decoding path contains a residual dense block a common dense block and a transition block after the last transition block of the decoding path the multichannel feature maps are projected into the desired output images each dense block is composed of n l layers the growth rate k determines the number of new feature maps that are utilized by each 3 3 convolutional layer of the f d function thus the output of the dense block contains k 0 n l k feature maps where k 0 is the number of the initial input feature maps since the architecture of rdcnn is fixed the number of layers n l in each dense block and the growth rate k can be varied to affect the accuracy of the surrogate model constructed by the proposed method as will be discussed in the subsequent illustrative example study 2 4 1 image regression strategy based on the rdcnn s efficient image processing capability the surrogate construction can be regarded as an image regression problem which can be described as 18 f r c h i h i w i r c h o h o w o where c h i h i and w i denote the number of channels height and width of the input images respectively similarly c h o h o and w o represent the corresponding properties of the output images consider a two dimensional problem in which the pdes defined in section 2 1 are solved over a 2 d spatial domain with h w grids where h and w denote the maximum number of grids along two coordinates height and width the input and output of the forward model should be restructured as image like data and various forward model input parameters could be expressed as input images with several channels for rdcnn the state variables obtained from the forward model can be transformed into output images with specific channels it should be noted that the input and output images have the same height and width in this work i e hi ho and wi wo an efficient trained rdcnn can approximate the relationship between the input and output of the forward model therefore the image regression strategy here has been transformed into a pixel prediction task where the output of each channel on each grid of the domain can be predicted the relationship between the model inputs and outputs can be given as the following mapping 19 f x y where x r d x g n and y r d y g n d x and d y denote the size of input and output on one grid respectively here g n is the number of spatial grid blocks of the model consider a two dimensional model where the spatial grid block is subdivided into g n h w the model input x r d x g n and output y r d y g n can be written in the form of an image like data structure that is x r d x h w and y r d y h w therefore the surrogate construction is transformed into an image regression problem which can be described as follows 20 f r d x h w r d y h w the input field of random parameters in the groundwater flow and solute transport model and the output field of the model are treated as images with significant spatial correlation based on the image regression strategy the intricate relationship between the input and output of the forward model is approximated by transforming it into an image regression problem theoretically a surrogate for a complicated and high dimensional groundwater flow and transport model can be developed by combining the powerful capabilities of convolutional neural networks in visual data processing 2 4 2 image processing of the dynamic characteristics of contaminant sources due to the dynamic nature of the groundwater flow and the solute transport process the time factor and the response value of the forward model corresponding to the specific time can be treated as the input and output respectively the process of constructing a surrogate for the dynamic system can be represented as 21 y a b μ x a t b β where μ represents the functional relationship between the input image and the output image x a denotes the model input parameter t b is the time β represents the convolutional neural network parameter and y a b represents the output of the surrogate model at time t b when the input is x a the training samples should be reintegrated as follows and t b is also used as an input in order to more precisely depict the dynamic characteristics of the system 22 x a t b y a b a 1 b 1 n a n b x c y c c n a n b x y where y a b represents the output of the forward model with the given input x a at time t b x c represents the comprehensive input by integrating the input parameter x a and time t b n a and n b represents the running times of the forward model and the number of specific time respectively after the combination of the input parameters and time information for training samples the number of training samples required to construct a surrogate model with the convolutional network is n n a n b image regression is adopted to construct surrogate model through convolutional neural networks therefore image processing must be performed on the parameters and state variables of the forward model i e the input field and output field should be represented with images the time factor must be considered in the dynamic process as illustrated in equation 22 and the time t b needs to be denoted as a constant feature map with the value of each pixel equal to t b contaminant source strengths are also represented as constant feature maps where the value of the individual pixel reflecting the position of the contaminant source in the image corresponds to the contaminant source strength assuming the contaminant is released to the aquifer at the i th time step the input including location and intensity could be expressed in the image as follows 23 s i n x n y s si n x n x s n y n y s 0 n x n x s n y n y s where n x 1 w n y 1 h n x s n y is the source location in the input image the value of the pixel in the input image corresponding to the pollution source location is the contaminant source strength s si while the values of the remaining pixels are zero the contaminant source information is shown in the input image after the preprocessing 3 illustrative example 3 1 problem description a two dimensional steady groundwater flow through an isotropic heterogeneous saturated aquifer revised after that of zhang et al 2018 is used to illustrate the applicability of the proposed surrogate model to replace forward simulation and is utilized in parameter inversion as depicted in fig 6 the hypothetical aquifer extends over a domain of 20 10 l and is discretized in two dimensions into 80 columns by 40 rows i e 0 25 0 25 l square grid cells the constant heads prescribed for the left and right boundaries are 6 and 5 l respectively no flow conditions are assumed on the upper and lower boundaries three contaminant sources with time varying strength are considered in this case and the source coordinates are 3 5 6 6 and 10 3 75 the source strength is given by the mass loading rate the unknown source information is represented by 9 parameters i e s si mt 1 during 2 t i 1 2 t i and t i i t i 1 2 3 which indicates that three sources release the contaminant into the aquifer during t 2 4 6 t the longitudinal dispersivity α l and transverse dispersivity α t are 2 0 l and 0 2 l respectively the effective porosity is 0 35 the hydraulic conductivity field k is assumed to be a log normal distribution with the mean lnk 2 0 and variance σ lnk 2 0 5 the correlation lengths along the x and y directions are λ x 5 l and λ y 2 5 l respectively the variogram type is exponential the karhunen loève expansion kle zhang and lu 2004 is used to reduce the dimension of the conductivity field to enhance the computing efficiency the approximation of the log conductivity field in finite dimensions could be given as 24 ln k ln k i 1 n kle ξ i τ i f i x where ξ i represents the independent standard gaussian random variable τ i and f i x are eigenvalues and eigenfunctions of the correlation function respectively ln k denotes the mean of ln k and n kle is the number of terms to be kept to approximate the hydraulic conductivity field keeping the first 255 kl main expansion items n kle 255 can preserve approximately 95 of the total variance for the hydraulic conductivity field in this study therefore it is necessary to estimate a total of 264 parameters comprising 255 kle terms for the hydraulic conductivity field and 9 pollutant source strength parameters whose prior knowledge and actual values are listed in table 1 to estimate these unknown parameters 180 observation data with 5 random error are available at 20 observation locations shown in fig 6 including 20 hydraulic head and 160 contaminant concentration observations at t 2 4 6 8 10 12 14 16 t when using the deep convolutional neural network to construct a surrogate of forward model to predict the head and contaminant concentration the key procedure is to generate images to describe contaminant source strengths and hydraulic conductivity fields the contaminant source location and source strength are processed to be image using the method shown in 2 3 2 the hydraulic conductivity field is also represented by the input image the head and contaminant concentration output images can be predicted after the input images are processed by the deep convolutional neural network 3 2 data structure and evaluation indicators an image to image framework is adopted to construct a surrogate for a groundwater flow and transport model through mapping the input images that contain hydraulic conductivity field k and time varying contaminant source strength s si j i 1 j 1 n t n s to the output images of head h and contaminant concentration c k k 1 t c the framework is illustrated as 25 input k s si j i 1 j 1 n t n s o u t p u t h c k k 1 t c where n t and n s denote the total time step of contaminant release and the number of contaminant sources respectively t c is the total time of the predicted contaminant concentration fields the training dataset consists of the hydraulic conductivity field contaminant source parameters the head and concentration at a specific time step all of which were determined by the forward model to discuss the influence of the training sample size on the approximate accuracy of the surrogate model five training sample sizes of 1000 2000 3000 4000 and 5000 are considered the testing dataset consists of 500 randomly generated testing samples the correlation coefficient r 2 and root mean square error rmse are employed to quantify the performance of the rdcnn surrogate for approximating the forward model r 2 can be defined as 26 r 2 1 i 1 n e y i y i 2 2 i 1 n e y i y 2 2 where y i 1 n e i 1 n e y i n e is the total number of testing samples and y i represents the output of the forward model for the ith testing sample y i denotes the prediction of surrogate model for the ith testing sample rmse can be given as 27 rmse 1 n e i 1 n e y i y i 2 2 generally the better the performance of the surrogate model the greater r 2 and the smaller rmse 3 3 network structure design there are three dense connected blocks two of which are residual dense blocks and one of which is a dense block as shown in fig 5 this study takes into account three network structures each block of which includes 6 8 and 10 layers for a total of convolutional layers of 25 31 and 37 respectively the first layer of the whole network is a fully convolutional layer without any fully connected operations the network structure and parameters of rdcnn are shown in table 2 after the first convolutional layer there are 64 output feature maps and the growth rate is set to 24 or 36 the network training epoch and batch size are 220 and 100 correspondingly the l2 is chosen to be the loss function of the image to image regression problem l2 loss is defined by 28 l 2 β x y 1 n a 1 n b a 1 n a b 1 n b μ x a t b β y a b 2 2 the adaptive moment estimation adam is adopted as the optimization algorithm of the training network parameters and the initial learning rate for the adam optimization algorithm is 0 003 supposing that the loss function remains unchanged for 10 consecutive epochs the growth rate drops to 10 of the current growth rate to evaluate the effectiveness of rdcnn in surrogate construction for the groundwater flow and transport model the rdcnn constructed surrogate is compared with the dense connected convolutional neural network dcnn surrogate the main difference between the two convolutional neural networks is the introduction of a shortcut connection in rdcnn and the other network structures and parameters are identical the input of the network consists of 4 images including the hydraulic conductivity field and the image characterizing the contaminant sources denoted as x k s si j i 1 j 1 3 3 r 4 40 80 there are 9 output images including head and contaminant concentration fields at 8 specific times denoted as y y h c k k 1 8 r 9 40 80 due to the non negativity of the contaminant concentration the output layer employs the softplus activation function meanwhile the head data should be normalized to the range of 0 to 1 and the sigmoid activation function is employed in the output layer to ensure that the head varies at a constant interval 4 results and analysis 4 1 performance of surrogate 4 1 1 type of network the prediction accuracy of surrogate models constructed by rdcnn and dcnn is compared to evaluate the performance of the proposed rdcnn rdcnn and dcnn use the same network structure and parameters while the encoding decoding network of rdcnn further employs the residual learning strategy to save computing resources the training sample size and the training epoch are set to 3000 and 220 respectively each dense connected block contains 6 convolutional layers and the growth rate is 24 the surrogate models constructed using rdcnn and dcnn are therefore denoted as rdcnn 24 25 and dcnn 24 25 which can be explained by rdcnn k 25 in table 2 for network structure and parameters for comparison the surrogate models constructed by rdcnn 24 25 and dcnn 24 25 are employed to predict the head and contaminant concentration at a specific time using the input of a randomly selected test sample fig 7 and fig 8 display the predicted field the real field and the absolute error field obtained from the rdcnn 24 25 and dcnn 24 25 surrogate models respectively the same legend scale is used in both fig 7 and fig 8 for a clear comparison of the prediction results from different surrogate models fig 7 and fig 8 demonstrate that both the rdcnn and dcnn surrogate models accurately predict the head field and the contaminant concentration field at a specific time in localized regions such as the edge of the contaminated plume there are nonetheless some prediction errors the first reason could be that the training sample size is only 3000 and the mapping relationship between the input and output images remains uncertain another reason might be that the input images contain 3 images denoting the source strength released at time t 2 j 1 2j t j 1 2 3 and 1 image showing the hydraulic conductivity field as an output there are 9 images including 1 image of the head field and 8 images of the contaminant concentration field at t 2 4 6 8 10 12 14 16 t therefore t 8 10 12 14 16 t is the non contaminant source release period and there are no input images correspondingly making it more difficult for the surrogate to predict from the prediction absolute error fields of fig 7 and fig 8 it can be observed that the absolute errors of the rdcnn surrogate for head and all contaminant concentration fields are generally lower than those of the dcnn surrogate furthermore the evaluation of r2 and rmse on the entire test dataset indicates that the prediction accuracy of the rdcnn surrogate r2 0 984 and rmse 0 047 is superior to that of the dcnn surrogate r2 0 977 and rmse 0 055 therefore the surrogate models based on the rdcnn and dcnn both demonstrate satisfactory performance in high dimensional modeling approximation and can accurately predict the head field and the pollutant concentration field at a specific time with the rdcnn prediction being closer to the results obtained by the forward model 4 1 2 size of training sample to investigate the effect of training sample size on the prediction accuracy of the surrogate model based on the rdcnn network the corresponding surrogate models are constructed with training sample sizes of 1000 2000 3000 4000 and 5000 training samples respectively considering the computational time the rdcnn k 25 is selected as the network structure where k 24 and other network parameter settings are displayed in table 2 for rdcnn k 25 the variation trend of the rmse as the number of training epochs increases is depicted in fig 9 where the rmse values of both the training and test sample sets tend to be stable after 180 epochs once the training process is completed at epoch 220 the rmse decreases as the number of training samples increases indicating that the predictive accuracy of the surrogate model has improved the r2 score of the training and testing sample set for each rdcnn surrogate model with varying training sample sizes is given in fig 10 the r2 values for the training and testing data sets of the surrogate are 0 937 and 0 818 respectively when the training sample size is only 1000 indicating that the generalization performance of the surrogate model is still weak fig 10 clearly demonstrates that the r2 score increases as more training samples are available when the training sample size is increased to 5000 the surrogate model achieves r2 values of 0 978 for the training set and 0 951 for the test set the performance of the proposed network surrogate in accurately approximating is further shown in fig 11 and fig 12 which depict a comparison of the contaminant concentration fields at t 2 4 6 8 10 12 14 16 t and the hydraulic head field predicted by the original simulation model modflow and mt3dms and the surrogate model using 1000 and 5000 training samples respectively these predictions take into account contaminant source strength and hydraulic conductivity field realization which are randomly selected from the test samples the surrogate can roughly capture the contaminant concentration field and hydraulic head when using 1000 training samples but the prediction error is relatively large and some details are not depicted clearly as shown in fig 12 the surrogate model provides a better characterization of local features such as the intersection of two high concentration pollutant plumes at time t 10 t when the quantity of training samples is raised to 5000 in contrast the absolute approximation error for the contaminant concentration and hydraulic head field obtained from the surrogate using 5000 training samples is significantly lower than that obtained from the surrogate using 1000 training samples the results indicate that especially when additional training samples are available the rdcnn employed in the surrogate construction performs satisfactorily in approximating the contamination transport process with multiple time varying sources 4 1 3 parameter of network architecture to demonstrate the impact of network architecture parameters on the prediction performance of the rdcnn based surrogate the training sample size of 5000 and the dense connected block number are fixed at 3 in the surrogate network which includes two residual dense blocks and one common dense connected block network depth and growth rate are two crucial parameters in terms of network structure considering that each dense connected block contains 6 8 and 10 equal convolutional layers the rdcnn network depths are 25 31 and 37 respectively two different growth rates 24 and 40 are selected and other network parameter settings are listed in table 2 the resulting rmse and r2 values of rdcnn surrogate models with different parameter sets of network depth and growth rate at varying training epochs which are evaluated on both training and test sample sets are presented in fig 13 and fig 14 for the contaminant transport system with multiple sources of time varying release strength figs 13 and 14 demonstrate that the rdcnn surrogate prediction with greater network depth and a fixed growth rate yields a lower rmse value and a higher r2 score furthermore with the same network depth for rdcnn surrogate construction it is found that as network growth rate increases the surrogate prediction for both the training set and the test set achieves lower rmse and higher r2 values indicating that the rdcnn based surrogate model provides superior approximation results it should be noted that an increase in either network depth or network growth rate will lead to significantly more network parameters for training the rdcnn to construct surrogate models this demonstrates that the network training process gets harder and requires more cpu time and storage in order to strike a balance between training efficiency and approximation accuracy while training the rdcnn to construct a surrogate model for groundwater flow and contaminant transport systems it is required to choose the network parameter set of network depth and growth rate comprehensively 4 2 parameter inversion results the ilues algorithm is adopted to inverse high dimensional parameters based on a surrogate constructed by training 5000 forward model input output datasets rdcnn 40 31 is selected as the network architecture where the growth rate is 40 the network depth is 31 and each dense connected block has 8 convolutional layers to ensure the construction efficiency and prediction accuracy of the surrogate model the forward model is fully replaced by the surrogate and no additional simulation forward models are called by the data assimilation method during the inversion process to evaluate the accuracy and computational efficiency of high dimensional parameters inversion by combining the rdcnn surrogate model with the ilues method referred to as the surrogate coupled ilues hereinafter the inversion results obtained by ilues calling the simulation forward models referred to as the former ilues hereinafter are regarded as a reference to solve the problem of high dimensional model parameter inversion and adequately quantify the uncertainty of parameters an ensemble size of ne 3000 and an iteration number of niter 10 are set for both former and surrogate coupled ilues two ilues algorithm parameters including a local ensemble factor of α 0 3 and a distance weight β 3 are also determined empirically fig 15 shows the inversion results of the 9 contaminant source strength parameters versus the number of iterations based on the former ilues as the number of iterations grows the mean value of each ensemble for contaminant source strength approaches the actual value while the uncertainty of the ensemble diminishes steadily it demonstrates that the source strength parameters are accurately identified with the former ilues the reference field and estimated results of the hydraulic conductivity field including six posterior realizations and the estimated mean and variance field are given in fig 16 which clearly demonstrates that the former ilues can approximately capture the characteristics of the entire hydraulic conductivity field and accurately estimate the high and low conductivity zones there are a total of 180 observed data containing 20 hydraulic head and 160 contaminant concentration values which is relatively sparse to identify 264 dimensional model parameters as a consequence certain deviations can still be observed in the local area of the posterior realization and mean of the hydraulic conductivity field compared to the reference field specifically due to the limited observation locations the estimated variance field indicates that the ensemble uncertainty is mainly distributed near the east and west boundaries optimal observation design for both the number and the spatiotemporal distribution of observation locations may help to improve the accuracy of estimating the hydraulic conductivity field note that when using the former ilues method to inverse model parameters the forward model is required to running 33000 times 3000 1 10 33000 with 3000 computations necessary to construct the initial ensemble and 10 iterations requiring 30000 model calls even though the ilues algorithm based on the forward model can accurately inverse the source strength and hydraulic conductivity field the 33000 executions of the forward model inevitably cause a considerable computational burden and decrease the inversion efficiency of the ilues method as illustrated in fig 17 the surrogate coupled ilues technique can successfully identify the nine parameters representing contamination source strength within ten iterations similarly fig 18 depicts the estimation results of the hydraulic conductivity field including a comparison of the reference field with six posterior realizations and the estimated mean and variance field the overall features of the hydraulic conductivity field could be accurately characterized by the surrogate coupled ilues especially the obvious high value and low value regions of the hydraulic conductivity the surrogate coupled ilues might also yield approximate results for high dimensional parameter estimation similar to the ilues based on forward models particularly when utilizing the rdcnn surrogate coupled ilues to assimilate the observations to inverse model parameters there is no need to run additional forward models in the parameter inversion stage and only 5500 forward model 5000 samples for training and 500 samples for test executions are required in the construction stage of the surrogate which is significantly less than the 33000 forward model runs of the former ilues and substantially improves the solution efficiency of the inversion problem to further quantify the improvement in the inversion efficiency provided by the proposed surrogate the computational costs for the entire process of parameter inversion based on the former ilues and the surrogate coupled ilues are calculated independently first while executing ilues based on the forward model cf and nf denote the time required for running one forward model and the number of forward model executions for inversion respectively therefore the total computational cost cf of the former ilues can be expressed as 29 c f c f n f for the surrogate coupled ilues the total time consumed for the model parameter inversion mainly consists of two parts 1 the computational time of executing the forward model to obtain the training and test sample set expressed as cf no where no represents the total number of training and test samples and 2 the training time to construct a satisfactory surrogate to replace the forward model denoted as ct consequently the computational cost ct of the surrogate coupled ilues can be given as 30 c t c f n o c t where cf 3 5s nf 33000 no 5500 and ct 4598 11s for this numerical case the computational cost of cf 1 155 105s and ct 2 385 104s are taken to jointly inverse the contaminant source strength and hydraulic conductivity field by the ilues based on an expensive forward model and a time saving rdcnn surrogate model respectively the results show that the computational cost of 264 dimensional parameter estimation using ilues based on the rdcnn surrogate model is much lower than that based on the forward model and the calculation time is reduced by nearly an order of magnitude indicating that the surrogate coupled ilues method can significantly improve the computational efficiency of high dimensional inversion problems moreover if a problem with a larger dimension needs to be solved or if the execution of the forward model takes longer significant computational savings might be expected by replacing the forward model with an effective surrogate model based on the above identified results using the former and surrogate coupled ilues methods a random posterior ensemble of contaminant source strength and hydraulic conductivity field is selected as the model input and the outputs of contaminant concentration and hydraulic head field can be obtained notice that the forward model is used to generate the output using model input parameters figs 15 and 16 estimated by the former ilues meanwhile the rdcnn surrogate model is directly employed to predict model outputs for the input model parameters obtained from surrogate coupled ilues figs 17 and 18 fig 19 shows the ensemble mean fields of contaminant concentration and hydraulic head after the assimilation of observation data by the ilues algorithm based on the forward model and the rdcnn surrogate model the output state variable fields of the reference model are also displayed for comparison in fig 19 it can be observed from fig 19 that the contaminant concentration and hydraulic head fields obtained by the forward model and rdcnn surrogate model show a high similarity which are nearly identical to the reference fields visually the results further prove the effectiveness of the rdcnn surrogate model combined with the ilues algorithm for identifying high dimensional model input parameters however the variances of posterior samples generated by the surrogate coupled ilues are greater than those generated by the former ilues the first reason is that the contaminant plume is jointly affected by three distinct contaminant sources and the details of the contaminant plume are more difficult to represent with a surrogate than if only one source were addressed the rdcnn method on the other hand is a data driven method and 5000 training samples are utilized to construct a surrogate to save training time the complexity of contaminant distribution resulting from the interaction of three joint contaminant sources cannot be entirely recognized with 5000 training samples the second reason is that there is inherent uncertainty in the surrogate to predict the contaminant concentration fields based on source information and conductivity fields the r2 value of the rdcnn surrogate used for the test dataset is 0 956 and there is a slight deviation between the actual concentrations for each observation location obtained from the forward model and from the rdcnn based surrogate which may make it more challenging for ilues to converge to the actual values and increase the variance the reason should be noted that in fig 15 the former ilues converges in 3 iterations for the source strength parameter whereas the total iteration number is selected to be 10 first the source strength parameters and the high dimensional hydraulic conductivity parameters are inversed together the number of unknown parameters for contaminant is only 9 while the number of hydraulic conductivity parameters is 255 despite the fact that the contaminant source parameters converge after three iterations the estimation of the hydraulic conductivity field does not converge and does not produce the similar results as the reference field fig 20 and the variance field is still relatively large following three iterations the number of 10 iterations is used to guarantee satisfactory estimation results for both the contaminant source and the hydraulic conductivity field 4 3 application in an irregular aquifer to further test the performance of the proposed ilues based surrogate inverse framework an anisotropic aquifer with irregular boundaries is chosen which is revised by the cases described by xing et al 2019 and li et al 2022 fig 21 shows the plan view of this case with two contaminant sources a pumping well and eight observation locations the entire simulation time is 120 months which is divided into 20 equal stress periods with each duration of 6 months the constant heads prescribed for the upper left and lower right boundaries are 100 and 80 m respectively and no flow boundaries are assumed on other sides the aquifer is divided into five hydraulic conductivity field zones and the values of each zone are unknown the contaminant is assumed to be released to the aquifer during the first 5 release periods each of which is equivalent to two stress periods thus 15 unknown variables need to be identified for 2 sources 5 release periods and 5 zones of hydraulic conductivity observations consist of 8 hydraulic head and contaminant concentrations at t 720 1080 1440 1800 2160 2520 2880 d actual values of each zone and source strength are listed in table 3 and table 4 respectively the chemical reactions are introduced in the contaminant transport model the related parameters of the chemical reactions and the basic hydrogeological parameters of the aquifer are given in table 5 the rdcnn 36 31 is selected to construct the surrogate for this irregular aquifer where the initial size of output feature map is 64 after the first convolutional layer and the growth rate is 36 the network training epoch of 220 and batch size of 100 are considered during the training process the training and test datasets contain 3000 and 300 randomly selected samples respectively fig 22 shows the result of a randomly selected testing sample to display the performance of the rdcnn surrogate for substituting the original model on an irregular aquifer model the rdcnn surrogate can approximately capture the features of the contaminant concentration and hydraulic head field and the values of r2 and rmse for the whole testing dataset are 0 991 and 0 039 respectively which indicates that the rdcnn surrogate model could provide similar prediction results as the forward model the surrogate coupled ilues is employed to jointly inverse contaminant source information and hydraulic conductivity for each zones an ensemble size of 1000 and an iteration number of 8 are selected and the determination of other ilues algorithm parameters is the same as the aforementioned fig 23 presents the inversion results of unknown variables the ensemble means of both the contaminant source strength and the hydraulic conductivity of each zone gradually get closer to the true values and the ensemble variances decrease as the iteration progresses demonstrating that rdcnn surrogate coupled ilues enables accurate inversion of unknown parameters for an irregular aquifer with two sources the inverse results of the surrogate coupled ilues further illustrates the robust prediction capability of the rdcnn surrogate model 5 conclusions in this study a deep learning method based on residual dense connected convolutional neural network rdcnn is proposed to construct surrogate model for groundwater flow and solute transport models with multiple time varying contaminant sources the rdcnn constructed surrogate is combined with an iterative local updating ensemble smoother ilues to achieve the efficient and accurate joint inversion of high dimensional parameters of the groundwater contaminant source and hydraulic conductivity field the proposed method could also achieve satisfactory performance for substituting an irregular aquifer model with relatively complicated conditions the main conclusions drawn from this study are as follows 1 based on the deep fully convolutional encoding decoding architecture a residual densely connected convolutional neural network rdcnn is proposed to implement a streamlined deep neural network coupling the feature reuse idea of dense connected network densenet with the residual connected idea of residual network resnet the rdcnn is employed to construct a surrogate for the groundwater forward model where the high dimensional input parameters and output state variables are represented by different images and the surrogate construction process is transformed into an image to image regression problem the performance of a surrogate model can successfully explore the complex relationship between the forward model s input parameters and output state variables without high computational cost for training 2 the performance of the proposed rdcnn and traditional dcnn is compared by substituting the forward model to depict hydraulic head and concentration fields based on the contaminant source information and hydraulic conductivity field the results demonstrate that the rdcnn based surrogate provides more similar output fields to the forward model indicating that the proposed rdcnn performs better in high dimensional surrogate modeling whereas both the proposed rdcnn and traditional rdcnn can successfully approximate the mapping relationship between high dimensional inputs the multiple contaminant time varying source parameters and hydraulic conductivity field and outputs the hydraulic head field and concentration fields at different times the proposed method takes advantage of the skip connections within a residual dense block which facilitate information propagation without degradation making it possible to ease training the network and to achieve comparable and ever better surrogate performance on image regression however the proposed method is a data driven method and not always physics based and the generalization ability of the constructed surrogate beyond the training data is limited in addition a large number of training samples are required to guarantee the accuracy of the surrogate therefore physical constraints should be combined with the neural network to characterize the transport simulation model more accurately in further study due to the lack of real site information application of the proposed method on a practical case is still challenging and remains to be explored in subsequent study 3 the influence of the number of training samples and network structure parameters on the accuracy of the rdcnn surrogate model is discussed the results indicate that with the limited computation resources a larger number of training samples should be selected to train the rdcnn to improve the prediction performance of the surrogate to ensure the accuracy of predictions and increase the training efficiency of the surrogate model it is necessary to thoroughly consider the characteristics of the proposed network such as its depth and growth rate 4 the ilues algorithm is used to estimate the contaminant source intensity and hydraulic conductivity field based on the forward model and the rdcnn surrogate model respectively the results show that both the forward model based and the rdcnn surrogate based ilues method could successfully inverse the high dimensional parameter compared to the ilues algorithm based on the forward model the ilues method based on the rdcnn surrogate model method can inverse high dimensional parameters with considerable accuracy by running a small number of forward models which significantly reduces the computational cost and improves inversion efficiency credit authorship contribution statement xuemin xia conceptualization methodology writing original draft writing review editing simin jiang supervision conceptualization writing review editing nianqing zhou supervision validation jifei cui investigation xianwen li validation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work is supported by the key technologies research and development program 2019yfe0114900 and the national natural science foundation of china 42077176 the authors would like to thank the editor and reviewers for their constructive and valuable comments and suggestions which significantly improve the quality of this work 
2418,data assimilation for high dimensional parameter joint inversion of multiple time varying source strength and hydraulic conductivity fields can be computationally intensive as a large number of forward model runs are usually required in this study a deep neural network based surrogate is proposed to replace the forward model in the data assimilation process to efficiently achieve high dimensional parameter inversion the deep convolutional encoding decoding network architecture is used to leverage the advantages of the convolutional network in processing image like data where the high dimensional input and output fields of the forward model are expressed as images the encoding network extracts the main features of the multiple time varying source input image and high dimensional hydraulic conductivity fields and the decoding network refines the extracted features to generate the output hydraulic head and contaminant concentration fields the residual dense convolutional neural network rdcnn is proposed by combining residual learning with a densely connected convolutional neural network to solve the image regression problem for surrogate construction iterative local updating ensemble smoother ilues is utilized to assimilate hydraulic head and contaminant concentration data to inverse high dimensional parameters the proposed method is evaluated by jointly inversing the high dimensional hydraulic conductivity and source parameters for a synthetic multiple source contaminated aquifer the results indicate that compared to the surrogate constructed by dense convolutional neural network dcnn without addressing residual learning the rdcnn surrogate captures the model input output relationship better with relatively high training efficiency the rdcnn surrogate coupled ilues achieves state of the art performance in terms of inversion accuracy of 9 pollution source parameters and 255 hydraulic conductivity field parameters and computational efficiency in comparison to the ilues based on the forward model keywords ensemble data assimilation high dimensional parameter inversion surrogate model residual learning convolutional neural network data availability data will be made available on request 1 introduction joint estimation of groundwater contaminant source parameters and hydraulic conductivity field are essential for assessing the impact of a groundwater contaminant incident and designing a remediation plan for decision makers jiang et al 2021 xing et al 2019 this requires solving an inverse problem to infer parameters related to the contaminant source and hydraulic conductivity field based on sparsely available hydraulic heads and contaminant concentrations since obtaining this information directly is impractical white 2018 xu and gómez hernández 2018 zhang et al 2016 due to the subsurface substantial heterogeneities high dimensional parameters are required to reconstruct the physical properties of the aquifer and contaminant release history joint estimation of high dimensional parameters such as contaminant source information and hydraulic conductivity field thus incurs a super linear increase in computational cost different methods for solving the inverse problem can be used depending on various available measurement data traditional simulation optimization inversion methods such as the gradient type method e g nonlinear programming embedded approach and heuristic search method e g simulated annealing genetic algorithm have been applied to identify groundwater contaminant sources ayaz et al 2022 ayvaz 2016 chakraborty and prakash 2020 datta et al 2011 traditional methods could not fully quantify the uncertainty of the inverse results and the ill posed nature of inverse problems may result in nonexistent or non unique solutions such uncertainty can be addressed using bayesian inversion approaches in which the unknown parameters are considered as random variables and their posterior distributions may well be determined by markov chain monte carlo mcmc sampling rajabi and ataie ashtiani 2016 xu and valocchi 2015 the computational cost is prohibitive when employing this approach to tackle a high dimensional inverse problem as a large number of simulation models are repetitively called to estimate the likelihood zhang et al 2015 ensemble based data assimilation methods such as ensemble smoother es evensen and leeuwen 1999 and ensemble kalman filter enkf evensen 2003 have become increasingly universal for solving the inverse problem in groundwater hydrology because of their monte carlo nature to simultaneously estimate unknown model parameters and associated uncertainty li et al 2012 panzeri et al 2013 xu et al 2022 unlike enkf es simultaneously assimilates all available data to compute a global update without modifying the restart files at each assimilation step and eliminates inconsistency issues between model parameters and state variables by updating only model parameters zhang et al 2018 in addition diverse iterative forms and variants of es have been presented and effectively utilized in groundwater inversion work to improve the performance of es in handling high dimensional and highly nonlinear situations ju et al 2018 li et al 2018 todaro et al 2021 zhang et al 2018 to further improve the applicability and efficiency of es for strongly nonlinear problems zhang et al 2018 proposed an iterative local updating ensemble smoother ilues in which the observations and each sample are updated locally using the es scheme instead of globally and the local ensemble is defined in terms of an integrated measure of distance to this sample the ilues is then implemented in this work as an inversion approach to jointly estimate high dimensional parameters of the contaminant source and hydraulic conductivity field generally a large number of iterations and ensemble size of ilues are required to inverse high dimensional parameters necessitating a larger number of forward model runs which is computationally demanding mo et al 2019a zhang et al 2018 surrogate models are cheaper to execute models that approximate the input output relationship of a computationally intensive model neumerous surrogate models have been extensively employed in studies of the groundwater inverse problem keating et al 2010 mo et al 2017 xu et al 2017 yan et al 2019 projection based methods can preserve the structure of a full order model but they are incapable of efficiently addressing severely nonlinear problems and suffer from stability issues chaturantabut and sorensen 2010 lassila et al 2014 with limited training data gaussian processes have been utilized to quantify the parameter uncertainty but this method relies on certain a priori assumptions on the relationship between inputs and outputs and it is difficult to guarantee computational efficiency when dealing with large amounts of data atkinson and zabaras 2019 taccari et al 2022 recently deep neural networks dnn based surrogate modeling techniques have acquired increasing prominence bao et al 2020 panahi et al 2020 yu et al 2020 zhu and zabaras 2018 developed an image to image regression method with a fully convolutional neural network to directly capture the complex mapping relationship between the high dimensional input and the output of the forward model without explicit dimensionality reduction techniques similar to the computer vision problem both the high dimensional input and output fields are regarded as images and the surrogate modeling process is turned into an image regression issue using fully convolutional neural networks for image processing efficient surrogate models for complicated high dimensional problems are obtained zhu and zabaras 2018 mo et al 2019b constructed a surrogate for the multiphase flow model using a deep fully convolutional encoder decoder network where the encoder captures multi scale features from high dimensional input images and the decoder reconstructs the output fields mo et al 2019a additionally proposed a deep autoregressive theory in the dense convolutional encoder decoder network to construct an efficient surrogate for the groundwater contaminant transport model which is coupled with ilues to successfully achieve high dimensional parameter estimation he et al 2021 coupled a theory guided full convolutional neural network tgfcnn based surrogate with an iterative ensemble smoother ies to efficiently predict the unknown parameters of a contaminant transport model and the proposed tgfcnn incorporates physical constraints into the loss function to enhance the performance of cnn resulting in greater accuracy than conventional cnn models zhou and tartakovsky 2020 attempted to combine the cnn based surrogate with an adaptive mcmc method to reduce the computational cost which diminishes the sampling error of the approximate likelihood function despite the numerous attempts of neural network based surrogate models to solve groundwater inversion problems the majority of studies of surrogate models based on image to image regression theory consider either a single contaminant source or low dimensional unknown parameters while few studies consider both first as the dimensionality of the inversion parameters rises it becomes more challenging to ensure the accuracy of inversion using surrogate models second the interaction between multiple contaminant sources aggravates surrogates difficulties in capturing the relationship between input and output images based on the dense convolutional encoder decoder network architecture the present work formulates a deep neural network to construct a surrogate model which is then combined with the ilues method to jointly inverse high dimensional hydraulic conductivity parameters and multiple source information with high efficiency for groundwater flow and transport models the residual dense convolutional neural network rdcnn is a simplified deep neural network designed to improve the training efficiency of surrogate modeling under the premise of ensuring the approximation accuracy of complex mapping relationships between high dimensional inputs and outputs of the forward model the rdcnn based surrogate is compared to the dcnn based surrogate to evaluate the performance of the proposed improvement strategy for fully convolutional encoding decoding networks in terms of prediction accuracy of head and contaminant concentration fields given multiple time varying contaminant sources and hydraulic conductivity fields the influence of network architecture training sample size and network parameters on the prediction accuracy of a deep neural network constructed surrogate is presented multiple contaminant source information and high dimensional hydraulic conductivity parameters are concurrently inversed for a synthetic case using a rdcnn surrogate based ilues method the remaining sections are organized as follows section 2 presents the theory of the ilues method and the adopted image to image deep learning method based on the rdcnn architecture section 3 provides an overview of the problem formulation model parameter configuration and surrogate model training in section 4 the performance of the proposed method is evaluated by resolving a high dimensional parameter inverse problem for a synthetic model finally section 5 offers a summary of the conclusions 2 methodology 2 1 governing equations the forward model of the groundwater flow and transport process is described by the governing equations which is divided into two parts the flow equation and the contaminant transport equation the governing partial differential equation for the steady state saturated flow in a two dimensional aquifer is as follows 1 x i k ij h x j w 0 i j 1 2 where k ij is the hydraulic conductivity l t 1 h is the hydraulic head l x i and x j are the cartesian coordinates and w is the volumetric source positive or sink negative flux per unit volume t 1 the head distribution is used to determine the velocity of groundwater flow v i l t 1 in terms of darcy s law as follows 2 v i k ij θ h x j i j 1 2 where θ is the porosity dimensionless advection and dispersion are considered the dominant processes in the contaminant transport model of this study the advection dispersion equation can be written as follows to calculate the contaminant concentration in a two dimensional model 3 θ c t x i θ v i c x i d ij θ c x j c s w 0 i j 1 2 c represents the concentration of the contaminant m l 3 d ij is the hydrodynamic dispersion coefficient a second order tensor l 2 t 1 and c s is the concentration of sources or sinks m l 3 due to the fact that molecular diffusion is generally far lower than hydrodynamic dispersion it is neglected here and the hydrodynamic dispersion coefficient d ij is defined as 4 d x 1 x 1 α l v x 1 2 α t v x 2 2 v d x 2 x 2 α l v x 2 2 α t v x 1 2 v d x 1 x 2 d x 2 x 1 α l α t v x 1 v x 2 v where α l and α t denote the longitudinal and the transverse dispersivity l respectively v equals the magnitude of velocity vector 2 2 iterative local updating ensemble smoother the relationship between the vector of measurements and the vector of model parameters is assumed to be simplified to the following form 5 d g m ε where d is the measurement vector m is the vector of model parameters g is the forward model and ε is a vector of gaussian distributed measurement error with mean e ε 0 and covariance c d ε j ε j t compared to the traditional ensemble smoother es the iterative local updating ensemble smoother ilues proposes a local updating idea to deal with high dimensional and strongly nonlinear problems more effectively and to assimilate available observation data iteratively multiple times zhang et al 2018 fig 1 depicts the framework of the ilues algorithm ilues can be implemented according to the following steps step1 initialization as the initial parameter ensemble n e equally likely stochastic parameter realizations are generated from the prior distribution it is also possible to build the output ensemble for the initial parameter ensemble by solving the forward model 6 m ini m 1 ini m 2 ini m n e ini 7 d ini g m 1 ini g m 2 ini g m n e ini the subscript represents the index of the ensemble member and the superscript ini is short for initialization which means the initial iteration step2 determination of local ensemble the distance j m between the measurements d and the sample m j f is measured synthetically from both the space of the model responses j 1 and the model parameters j 2 to determine the local ensemble of the sample m j f j 1 2 n e 8 j m j 1 m j 1 max β j 2 m j 2 max 9 j 1 m g m d t c d 1 g m d 10 j 2 m m m j f t c mm 1 m m j f j 1 m is the distance between the predicted data by forward model g m and the measurements d j 2 m is the distance between the model parameters m and the selected samples m j f β 0 represents the relative weight of two distance metrics where j 1 max and j 2 max are the maximum values of j 1 m and j 2 m respectively c mm is the auto covariance matrix of the model parameters m step3 update the local ensemble the local ensemble of m j f containing the n loc α n e α 0 1 samples with the n loc lowest j values can be updated by the ensemble smoother 11 m j k a m j k f c md loc f c dd loc f c d 1 d k g m j k f where k 1 n loc α is the ratio between the local ensemble m j loc f and the global ensemble m f c dd loc f is the n d n d auto covariance matrix of measurement d loc f n d is the total number of measurements assimilated d k n d obs c d is the measurement with d obs representing the n d 1 vector of observation data and c d e ε k ε k t representing the n d n d covariance matrix of measurement errors of observation data randomly selected from the updated local ensemble m j loc a m j 1 a m j 2 a m j n loc a sample m j loc a is regarded as the updated sample of m j f j 1 2 n e following this procedure the updated global ensemble m a m 1 loc a m 2 loc a m n e loc a can be obtained 2 3 convolutional neural network convolutional neural networks cnns have advantages in characterizing the spatial information of images and have been widely implemented in high dimensional image processing in general the following formulations can be used to represent two successive cnn layers 12 m l μ l w l m l 1 b l where l is the layer number m l 1 and m l denote the input and output respectively of the lth layer μ l indicates the nonlinear activation function such as the sigmoid function recitified linear unit relu and hyperbolic tangent function tanh w l is the kernel weight matrix b l represents the bias vector not taken into account in this study fully connected neural networks require a large number of layers to construct an effective model which dramatically increases the number of network parameters and results in extremely low computing efficiency cnn s two main characteristics namely its local connectivity and weight sharing scheme significantly minimize the number of parameters involved in its training process local connectivity signifies that each neuron in the convolutional layer is only connected to the neuron in a certain local window in the adjacent layer resulting in much fewer parameters between layers compared to a fully connected network in addition the convolutional kernel is viewed as a feature extractor that captures only the specific local features of the input image then using a weight sharing scheme a series of kernels create an entire convolutional layer to extract global features for example an input pixel x a b of a two dimensional image at location a b is processed by a convolutional layer c which is composed of a series of convolutional kernels ω n r z 1 z 2 n 1 n f to obtain the corresponding feature value c n x a b by the following expressions 13 c n x a b μ i 1 z 1 j 1 z 2 ω i j n x a i b j where nf is the total number of feature maps in the output layer and z denotes the size of kernel matrices given the input feature map size h f x w f x the output feature map size h f y w f y can be expressed as 14 h f y h f x 2 p z s 1 w f y w f x 2 p z s 1 where represents the floor function p denotes the zero padding which is the padding on each side of the input image s boundary with zeros in order to maintain a certain map size and s represents the stride which determines the pixel distance between the kernel s center and the center of the next successive move here three parameters including the stride s the zero padding p and the kernel size z are critical for the convolutional layer and should be calculated carefully before layer design 2 4 residual dense convolutional neural network a convolutional neural network is designed to capture the spatial characteristics of a high dimensional input image by first coarsening it the image is then refined in order to recover its feature information in a typical encoding decoding network architecture feature maps containing the primary features of the input image are retrieved by convolution operations in the encoder while upscaling is employed in the decoder to restore the feature map to the original image fig 2 is a schematic representation of the encoding and decoding process of a deep convolutional neural network in general the deeper neural networks enhance a model s ability to fit data which might lead to an over fitting issue and make it difficult for the model to converge simultaneously to reduce the required training samples and improve the parameter efficiency of the deep neural network a dense connected structure dense block is proposed to connect all the layers so as to facilitate information flow between the nets and avoid the parameter explosion caused by increasing network depth huang et al 2017 zhu and zabaras 2018 more specifically for a layer in the densely connected structure the feature maps of all previous layers are regarded as its input and the layer s own feature maps are utilized as the input of all subsequent layers this connection structure can effectively reduce information loss allow feature reuse and maximize feature propagation efficiency meanwhile network parameters are not obviously increased by using this structure thereby significantly guaranteeing the efficiency of training surrogate models the information flow between layers in a dense connected structure can be expressed as 15 x l f x 0 x 1 x l 1 where represents the concatenation of all output feature maps preceding the lth layer and the same feature map size is the prerequisite for the concatenation operation consequently the structure of a dense block is mainly defined by two parameters the number of network layers n l inside the structure and the growth rate which is generally quantified by the number of output feature maps of each layer n f each layer of a dense connected network contains a sequential combination of batch normalization bn relu activation function and convolution operation conv the number of feature maps throughout the entire dense connected block is n 0 n f n l where n 0 is the number of input feature maps fig 3 is a schematic diagram of the dense connected block structure with 3 layers n l 3 and a growth rate of 4 n f 4 to improve the prediction accuracy of the surrogate model constructed using a deep convolutional neural network it is necessary to increase the depth of the convolutional neural network by incorporating a number of dense connected blocks however a significant number of dense connections will result in the explosion of the feature map a transition block is positioned between two adjacent dense connected blocks in which a convolution operation is utilized to decrease the number of output feature maps fig 4 in addition the transition block can assist in adjusting the size of the feature map during the process of extracting the input image features and enlarging the feature map for instance the convolution layer in the transition block of the encoding network halves the size of the feature map which is known as downsampling conversely through the transposed convolution layer in the decoding network the transition block doubles the size of the feature map which is known as upsampling fig 4b and fig 4c depict the schematic diagrams for operations in each layer of the transition block structure in the encoding and decoding network respectively in addition to the dense connection structure residual learning is employed to prevent the gradient vanishing and explosion of the deep network thereby considerably improving the training efficiency of the model residuals have been recently applied in deep cnns for objection detection and image recognition successfully yue et al 2018 and the introduction of residual learning is more advantageous in efficiency than the original structure jégou et al 2010 therefore this study proposes a residual dense convolutional neural network rdcnn that combines the feature reuse idea of dense connected blocks and residual learning to achieve a streamlined deep neural network a residual dense block rdb of the rdcnn is formulated by densely connected blocks transition blocks and skip connections which is shown in fig 4a a typical cnn model has a plain architecture in which the input of each layer comes directly from the output of the previous layer in the residual block however the inputs are processed by two different functions and the final output is the summation of their outputs the rdb can be illustrated in the following form fooladgar and kasaei 2020 16 x out f x l r x l where x l and x out are the input and output of the lth rdb respectively the function r is regarded as identity mapping which implements a skip connection to ensure that the information flow can pass through the network smoothly and a typical one is r x l x l the function f x l is stated as follows 17 f x l f t f d x l x l 1 x l m where x out 1 f d x l x l 1 x l m represents the output of a densely connected block and the function f d is a sequential combination of the bn relu and 3 3 conv each of which is defined as a layer of the dense block and fig 3 illustrates the overall architecture of a densely connected block with 3 layers and operations on each layer f t indicates the non linear transformation conducted in the transition block and comprises a sequential combination of the bn relu 1 1 conv bn relu and 3 3 conv transposed conv performed in the encoding decoding transition block as depicted in fig 4b and fig 4c respectively particularly since the size of the feature map is halved following the convolution transition block in the encoding network the summation in equation 16 necessitates an additional down sampling operation in the skip connection the r in equation 16 of this work is considered to be the conv operation to replace the typical identity mapping to reslove the inconsistent problem of the size of the feature map fig 4a similarly a deconvolution operation is added to the skip connection in order to achieve upsampling and maintain the size of the feature map in the decoding network a brief architecture of rdcnn to construct a surrogate is shown in fig 5 the rdcnn network mainly comprises two phases encoding and decoding the first phase encodes the input images into compact feature maps the second phase recovers the feature maps to the target output images i e hydraulic head and contaminant concentration maps the encoding path comprises a convolutional layer and a residual dense block in this work instead of employing pooling operations to reduce the size of the feature map the initial convolutional layer which consists of 7 convolutional kernels with a stride of 2 and a padding of 3 is exploited to downsample the feature map by half the decoding path contains a residual dense block a common dense block and a transition block after the last transition block of the decoding path the multichannel feature maps are projected into the desired output images each dense block is composed of n l layers the growth rate k determines the number of new feature maps that are utilized by each 3 3 convolutional layer of the f d function thus the output of the dense block contains k 0 n l k feature maps where k 0 is the number of the initial input feature maps since the architecture of rdcnn is fixed the number of layers n l in each dense block and the growth rate k can be varied to affect the accuracy of the surrogate model constructed by the proposed method as will be discussed in the subsequent illustrative example study 2 4 1 image regression strategy based on the rdcnn s efficient image processing capability the surrogate construction can be regarded as an image regression problem which can be described as 18 f r c h i h i w i r c h o h o w o where c h i h i and w i denote the number of channels height and width of the input images respectively similarly c h o h o and w o represent the corresponding properties of the output images consider a two dimensional problem in which the pdes defined in section 2 1 are solved over a 2 d spatial domain with h w grids where h and w denote the maximum number of grids along two coordinates height and width the input and output of the forward model should be restructured as image like data and various forward model input parameters could be expressed as input images with several channels for rdcnn the state variables obtained from the forward model can be transformed into output images with specific channels it should be noted that the input and output images have the same height and width in this work i e hi ho and wi wo an efficient trained rdcnn can approximate the relationship between the input and output of the forward model therefore the image regression strategy here has been transformed into a pixel prediction task where the output of each channel on each grid of the domain can be predicted the relationship between the model inputs and outputs can be given as the following mapping 19 f x y where x r d x g n and y r d y g n d x and d y denote the size of input and output on one grid respectively here g n is the number of spatial grid blocks of the model consider a two dimensional model where the spatial grid block is subdivided into g n h w the model input x r d x g n and output y r d y g n can be written in the form of an image like data structure that is x r d x h w and y r d y h w therefore the surrogate construction is transformed into an image regression problem which can be described as follows 20 f r d x h w r d y h w the input field of random parameters in the groundwater flow and solute transport model and the output field of the model are treated as images with significant spatial correlation based on the image regression strategy the intricate relationship between the input and output of the forward model is approximated by transforming it into an image regression problem theoretically a surrogate for a complicated and high dimensional groundwater flow and transport model can be developed by combining the powerful capabilities of convolutional neural networks in visual data processing 2 4 2 image processing of the dynamic characteristics of contaminant sources due to the dynamic nature of the groundwater flow and the solute transport process the time factor and the response value of the forward model corresponding to the specific time can be treated as the input and output respectively the process of constructing a surrogate for the dynamic system can be represented as 21 y a b μ x a t b β where μ represents the functional relationship between the input image and the output image x a denotes the model input parameter t b is the time β represents the convolutional neural network parameter and y a b represents the output of the surrogate model at time t b when the input is x a the training samples should be reintegrated as follows and t b is also used as an input in order to more precisely depict the dynamic characteristics of the system 22 x a t b y a b a 1 b 1 n a n b x c y c c n a n b x y where y a b represents the output of the forward model with the given input x a at time t b x c represents the comprehensive input by integrating the input parameter x a and time t b n a and n b represents the running times of the forward model and the number of specific time respectively after the combination of the input parameters and time information for training samples the number of training samples required to construct a surrogate model with the convolutional network is n n a n b image regression is adopted to construct surrogate model through convolutional neural networks therefore image processing must be performed on the parameters and state variables of the forward model i e the input field and output field should be represented with images the time factor must be considered in the dynamic process as illustrated in equation 22 and the time t b needs to be denoted as a constant feature map with the value of each pixel equal to t b contaminant source strengths are also represented as constant feature maps where the value of the individual pixel reflecting the position of the contaminant source in the image corresponds to the contaminant source strength assuming the contaminant is released to the aquifer at the i th time step the input including location and intensity could be expressed in the image as follows 23 s i n x n y s si n x n x s n y n y s 0 n x n x s n y n y s where n x 1 w n y 1 h n x s n y is the source location in the input image the value of the pixel in the input image corresponding to the pollution source location is the contaminant source strength s si while the values of the remaining pixels are zero the contaminant source information is shown in the input image after the preprocessing 3 illustrative example 3 1 problem description a two dimensional steady groundwater flow through an isotropic heterogeneous saturated aquifer revised after that of zhang et al 2018 is used to illustrate the applicability of the proposed surrogate model to replace forward simulation and is utilized in parameter inversion as depicted in fig 6 the hypothetical aquifer extends over a domain of 20 10 l and is discretized in two dimensions into 80 columns by 40 rows i e 0 25 0 25 l square grid cells the constant heads prescribed for the left and right boundaries are 6 and 5 l respectively no flow conditions are assumed on the upper and lower boundaries three contaminant sources with time varying strength are considered in this case and the source coordinates are 3 5 6 6 and 10 3 75 the source strength is given by the mass loading rate the unknown source information is represented by 9 parameters i e s si mt 1 during 2 t i 1 2 t i and t i i t i 1 2 3 which indicates that three sources release the contaminant into the aquifer during t 2 4 6 t the longitudinal dispersivity α l and transverse dispersivity α t are 2 0 l and 0 2 l respectively the effective porosity is 0 35 the hydraulic conductivity field k is assumed to be a log normal distribution with the mean lnk 2 0 and variance σ lnk 2 0 5 the correlation lengths along the x and y directions are λ x 5 l and λ y 2 5 l respectively the variogram type is exponential the karhunen loève expansion kle zhang and lu 2004 is used to reduce the dimension of the conductivity field to enhance the computing efficiency the approximation of the log conductivity field in finite dimensions could be given as 24 ln k ln k i 1 n kle ξ i τ i f i x where ξ i represents the independent standard gaussian random variable τ i and f i x are eigenvalues and eigenfunctions of the correlation function respectively ln k denotes the mean of ln k and n kle is the number of terms to be kept to approximate the hydraulic conductivity field keeping the first 255 kl main expansion items n kle 255 can preserve approximately 95 of the total variance for the hydraulic conductivity field in this study therefore it is necessary to estimate a total of 264 parameters comprising 255 kle terms for the hydraulic conductivity field and 9 pollutant source strength parameters whose prior knowledge and actual values are listed in table 1 to estimate these unknown parameters 180 observation data with 5 random error are available at 20 observation locations shown in fig 6 including 20 hydraulic head and 160 contaminant concentration observations at t 2 4 6 8 10 12 14 16 t when using the deep convolutional neural network to construct a surrogate of forward model to predict the head and contaminant concentration the key procedure is to generate images to describe contaminant source strengths and hydraulic conductivity fields the contaminant source location and source strength are processed to be image using the method shown in 2 3 2 the hydraulic conductivity field is also represented by the input image the head and contaminant concentration output images can be predicted after the input images are processed by the deep convolutional neural network 3 2 data structure and evaluation indicators an image to image framework is adopted to construct a surrogate for a groundwater flow and transport model through mapping the input images that contain hydraulic conductivity field k and time varying contaminant source strength s si j i 1 j 1 n t n s to the output images of head h and contaminant concentration c k k 1 t c the framework is illustrated as 25 input k s si j i 1 j 1 n t n s o u t p u t h c k k 1 t c where n t and n s denote the total time step of contaminant release and the number of contaminant sources respectively t c is the total time of the predicted contaminant concentration fields the training dataset consists of the hydraulic conductivity field contaminant source parameters the head and concentration at a specific time step all of which were determined by the forward model to discuss the influence of the training sample size on the approximate accuracy of the surrogate model five training sample sizes of 1000 2000 3000 4000 and 5000 are considered the testing dataset consists of 500 randomly generated testing samples the correlation coefficient r 2 and root mean square error rmse are employed to quantify the performance of the rdcnn surrogate for approximating the forward model r 2 can be defined as 26 r 2 1 i 1 n e y i y i 2 2 i 1 n e y i y 2 2 where y i 1 n e i 1 n e y i n e is the total number of testing samples and y i represents the output of the forward model for the ith testing sample y i denotes the prediction of surrogate model for the ith testing sample rmse can be given as 27 rmse 1 n e i 1 n e y i y i 2 2 generally the better the performance of the surrogate model the greater r 2 and the smaller rmse 3 3 network structure design there are three dense connected blocks two of which are residual dense blocks and one of which is a dense block as shown in fig 5 this study takes into account three network structures each block of which includes 6 8 and 10 layers for a total of convolutional layers of 25 31 and 37 respectively the first layer of the whole network is a fully convolutional layer without any fully connected operations the network structure and parameters of rdcnn are shown in table 2 after the first convolutional layer there are 64 output feature maps and the growth rate is set to 24 or 36 the network training epoch and batch size are 220 and 100 correspondingly the l2 is chosen to be the loss function of the image to image regression problem l2 loss is defined by 28 l 2 β x y 1 n a 1 n b a 1 n a b 1 n b μ x a t b β y a b 2 2 the adaptive moment estimation adam is adopted as the optimization algorithm of the training network parameters and the initial learning rate for the adam optimization algorithm is 0 003 supposing that the loss function remains unchanged for 10 consecutive epochs the growth rate drops to 10 of the current growth rate to evaluate the effectiveness of rdcnn in surrogate construction for the groundwater flow and transport model the rdcnn constructed surrogate is compared with the dense connected convolutional neural network dcnn surrogate the main difference between the two convolutional neural networks is the introduction of a shortcut connection in rdcnn and the other network structures and parameters are identical the input of the network consists of 4 images including the hydraulic conductivity field and the image characterizing the contaminant sources denoted as x k s si j i 1 j 1 3 3 r 4 40 80 there are 9 output images including head and contaminant concentration fields at 8 specific times denoted as y y h c k k 1 8 r 9 40 80 due to the non negativity of the contaminant concentration the output layer employs the softplus activation function meanwhile the head data should be normalized to the range of 0 to 1 and the sigmoid activation function is employed in the output layer to ensure that the head varies at a constant interval 4 results and analysis 4 1 performance of surrogate 4 1 1 type of network the prediction accuracy of surrogate models constructed by rdcnn and dcnn is compared to evaluate the performance of the proposed rdcnn rdcnn and dcnn use the same network structure and parameters while the encoding decoding network of rdcnn further employs the residual learning strategy to save computing resources the training sample size and the training epoch are set to 3000 and 220 respectively each dense connected block contains 6 convolutional layers and the growth rate is 24 the surrogate models constructed using rdcnn and dcnn are therefore denoted as rdcnn 24 25 and dcnn 24 25 which can be explained by rdcnn k 25 in table 2 for network structure and parameters for comparison the surrogate models constructed by rdcnn 24 25 and dcnn 24 25 are employed to predict the head and contaminant concentration at a specific time using the input of a randomly selected test sample fig 7 and fig 8 display the predicted field the real field and the absolute error field obtained from the rdcnn 24 25 and dcnn 24 25 surrogate models respectively the same legend scale is used in both fig 7 and fig 8 for a clear comparison of the prediction results from different surrogate models fig 7 and fig 8 demonstrate that both the rdcnn and dcnn surrogate models accurately predict the head field and the contaminant concentration field at a specific time in localized regions such as the edge of the contaminated plume there are nonetheless some prediction errors the first reason could be that the training sample size is only 3000 and the mapping relationship between the input and output images remains uncertain another reason might be that the input images contain 3 images denoting the source strength released at time t 2 j 1 2j t j 1 2 3 and 1 image showing the hydraulic conductivity field as an output there are 9 images including 1 image of the head field and 8 images of the contaminant concentration field at t 2 4 6 8 10 12 14 16 t therefore t 8 10 12 14 16 t is the non contaminant source release period and there are no input images correspondingly making it more difficult for the surrogate to predict from the prediction absolute error fields of fig 7 and fig 8 it can be observed that the absolute errors of the rdcnn surrogate for head and all contaminant concentration fields are generally lower than those of the dcnn surrogate furthermore the evaluation of r2 and rmse on the entire test dataset indicates that the prediction accuracy of the rdcnn surrogate r2 0 984 and rmse 0 047 is superior to that of the dcnn surrogate r2 0 977 and rmse 0 055 therefore the surrogate models based on the rdcnn and dcnn both demonstrate satisfactory performance in high dimensional modeling approximation and can accurately predict the head field and the pollutant concentration field at a specific time with the rdcnn prediction being closer to the results obtained by the forward model 4 1 2 size of training sample to investigate the effect of training sample size on the prediction accuracy of the surrogate model based on the rdcnn network the corresponding surrogate models are constructed with training sample sizes of 1000 2000 3000 4000 and 5000 training samples respectively considering the computational time the rdcnn k 25 is selected as the network structure where k 24 and other network parameter settings are displayed in table 2 for rdcnn k 25 the variation trend of the rmse as the number of training epochs increases is depicted in fig 9 where the rmse values of both the training and test sample sets tend to be stable after 180 epochs once the training process is completed at epoch 220 the rmse decreases as the number of training samples increases indicating that the predictive accuracy of the surrogate model has improved the r2 score of the training and testing sample set for each rdcnn surrogate model with varying training sample sizes is given in fig 10 the r2 values for the training and testing data sets of the surrogate are 0 937 and 0 818 respectively when the training sample size is only 1000 indicating that the generalization performance of the surrogate model is still weak fig 10 clearly demonstrates that the r2 score increases as more training samples are available when the training sample size is increased to 5000 the surrogate model achieves r2 values of 0 978 for the training set and 0 951 for the test set the performance of the proposed network surrogate in accurately approximating is further shown in fig 11 and fig 12 which depict a comparison of the contaminant concentration fields at t 2 4 6 8 10 12 14 16 t and the hydraulic head field predicted by the original simulation model modflow and mt3dms and the surrogate model using 1000 and 5000 training samples respectively these predictions take into account contaminant source strength and hydraulic conductivity field realization which are randomly selected from the test samples the surrogate can roughly capture the contaminant concentration field and hydraulic head when using 1000 training samples but the prediction error is relatively large and some details are not depicted clearly as shown in fig 12 the surrogate model provides a better characterization of local features such as the intersection of two high concentration pollutant plumes at time t 10 t when the quantity of training samples is raised to 5000 in contrast the absolute approximation error for the contaminant concentration and hydraulic head field obtained from the surrogate using 5000 training samples is significantly lower than that obtained from the surrogate using 1000 training samples the results indicate that especially when additional training samples are available the rdcnn employed in the surrogate construction performs satisfactorily in approximating the contamination transport process with multiple time varying sources 4 1 3 parameter of network architecture to demonstrate the impact of network architecture parameters on the prediction performance of the rdcnn based surrogate the training sample size of 5000 and the dense connected block number are fixed at 3 in the surrogate network which includes two residual dense blocks and one common dense connected block network depth and growth rate are two crucial parameters in terms of network structure considering that each dense connected block contains 6 8 and 10 equal convolutional layers the rdcnn network depths are 25 31 and 37 respectively two different growth rates 24 and 40 are selected and other network parameter settings are listed in table 2 the resulting rmse and r2 values of rdcnn surrogate models with different parameter sets of network depth and growth rate at varying training epochs which are evaluated on both training and test sample sets are presented in fig 13 and fig 14 for the contaminant transport system with multiple sources of time varying release strength figs 13 and 14 demonstrate that the rdcnn surrogate prediction with greater network depth and a fixed growth rate yields a lower rmse value and a higher r2 score furthermore with the same network depth for rdcnn surrogate construction it is found that as network growth rate increases the surrogate prediction for both the training set and the test set achieves lower rmse and higher r2 values indicating that the rdcnn based surrogate model provides superior approximation results it should be noted that an increase in either network depth or network growth rate will lead to significantly more network parameters for training the rdcnn to construct surrogate models this demonstrates that the network training process gets harder and requires more cpu time and storage in order to strike a balance between training efficiency and approximation accuracy while training the rdcnn to construct a surrogate model for groundwater flow and contaminant transport systems it is required to choose the network parameter set of network depth and growth rate comprehensively 4 2 parameter inversion results the ilues algorithm is adopted to inverse high dimensional parameters based on a surrogate constructed by training 5000 forward model input output datasets rdcnn 40 31 is selected as the network architecture where the growth rate is 40 the network depth is 31 and each dense connected block has 8 convolutional layers to ensure the construction efficiency and prediction accuracy of the surrogate model the forward model is fully replaced by the surrogate and no additional simulation forward models are called by the data assimilation method during the inversion process to evaluate the accuracy and computational efficiency of high dimensional parameters inversion by combining the rdcnn surrogate model with the ilues method referred to as the surrogate coupled ilues hereinafter the inversion results obtained by ilues calling the simulation forward models referred to as the former ilues hereinafter are regarded as a reference to solve the problem of high dimensional model parameter inversion and adequately quantify the uncertainty of parameters an ensemble size of ne 3000 and an iteration number of niter 10 are set for both former and surrogate coupled ilues two ilues algorithm parameters including a local ensemble factor of α 0 3 and a distance weight β 3 are also determined empirically fig 15 shows the inversion results of the 9 contaminant source strength parameters versus the number of iterations based on the former ilues as the number of iterations grows the mean value of each ensemble for contaminant source strength approaches the actual value while the uncertainty of the ensemble diminishes steadily it demonstrates that the source strength parameters are accurately identified with the former ilues the reference field and estimated results of the hydraulic conductivity field including six posterior realizations and the estimated mean and variance field are given in fig 16 which clearly demonstrates that the former ilues can approximately capture the characteristics of the entire hydraulic conductivity field and accurately estimate the high and low conductivity zones there are a total of 180 observed data containing 20 hydraulic head and 160 contaminant concentration values which is relatively sparse to identify 264 dimensional model parameters as a consequence certain deviations can still be observed in the local area of the posterior realization and mean of the hydraulic conductivity field compared to the reference field specifically due to the limited observation locations the estimated variance field indicates that the ensemble uncertainty is mainly distributed near the east and west boundaries optimal observation design for both the number and the spatiotemporal distribution of observation locations may help to improve the accuracy of estimating the hydraulic conductivity field note that when using the former ilues method to inverse model parameters the forward model is required to running 33000 times 3000 1 10 33000 with 3000 computations necessary to construct the initial ensemble and 10 iterations requiring 30000 model calls even though the ilues algorithm based on the forward model can accurately inverse the source strength and hydraulic conductivity field the 33000 executions of the forward model inevitably cause a considerable computational burden and decrease the inversion efficiency of the ilues method as illustrated in fig 17 the surrogate coupled ilues technique can successfully identify the nine parameters representing contamination source strength within ten iterations similarly fig 18 depicts the estimation results of the hydraulic conductivity field including a comparison of the reference field with six posterior realizations and the estimated mean and variance field the overall features of the hydraulic conductivity field could be accurately characterized by the surrogate coupled ilues especially the obvious high value and low value regions of the hydraulic conductivity the surrogate coupled ilues might also yield approximate results for high dimensional parameter estimation similar to the ilues based on forward models particularly when utilizing the rdcnn surrogate coupled ilues to assimilate the observations to inverse model parameters there is no need to run additional forward models in the parameter inversion stage and only 5500 forward model 5000 samples for training and 500 samples for test executions are required in the construction stage of the surrogate which is significantly less than the 33000 forward model runs of the former ilues and substantially improves the solution efficiency of the inversion problem to further quantify the improvement in the inversion efficiency provided by the proposed surrogate the computational costs for the entire process of parameter inversion based on the former ilues and the surrogate coupled ilues are calculated independently first while executing ilues based on the forward model cf and nf denote the time required for running one forward model and the number of forward model executions for inversion respectively therefore the total computational cost cf of the former ilues can be expressed as 29 c f c f n f for the surrogate coupled ilues the total time consumed for the model parameter inversion mainly consists of two parts 1 the computational time of executing the forward model to obtain the training and test sample set expressed as cf no where no represents the total number of training and test samples and 2 the training time to construct a satisfactory surrogate to replace the forward model denoted as ct consequently the computational cost ct of the surrogate coupled ilues can be given as 30 c t c f n o c t where cf 3 5s nf 33000 no 5500 and ct 4598 11s for this numerical case the computational cost of cf 1 155 105s and ct 2 385 104s are taken to jointly inverse the contaminant source strength and hydraulic conductivity field by the ilues based on an expensive forward model and a time saving rdcnn surrogate model respectively the results show that the computational cost of 264 dimensional parameter estimation using ilues based on the rdcnn surrogate model is much lower than that based on the forward model and the calculation time is reduced by nearly an order of magnitude indicating that the surrogate coupled ilues method can significantly improve the computational efficiency of high dimensional inversion problems moreover if a problem with a larger dimension needs to be solved or if the execution of the forward model takes longer significant computational savings might be expected by replacing the forward model with an effective surrogate model based on the above identified results using the former and surrogate coupled ilues methods a random posterior ensemble of contaminant source strength and hydraulic conductivity field is selected as the model input and the outputs of contaminant concentration and hydraulic head field can be obtained notice that the forward model is used to generate the output using model input parameters figs 15 and 16 estimated by the former ilues meanwhile the rdcnn surrogate model is directly employed to predict model outputs for the input model parameters obtained from surrogate coupled ilues figs 17 and 18 fig 19 shows the ensemble mean fields of contaminant concentration and hydraulic head after the assimilation of observation data by the ilues algorithm based on the forward model and the rdcnn surrogate model the output state variable fields of the reference model are also displayed for comparison in fig 19 it can be observed from fig 19 that the contaminant concentration and hydraulic head fields obtained by the forward model and rdcnn surrogate model show a high similarity which are nearly identical to the reference fields visually the results further prove the effectiveness of the rdcnn surrogate model combined with the ilues algorithm for identifying high dimensional model input parameters however the variances of posterior samples generated by the surrogate coupled ilues are greater than those generated by the former ilues the first reason is that the contaminant plume is jointly affected by three distinct contaminant sources and the details of the contaminant plume are more difficult to represent with a surrogate than if only one source were addressed the rdcnn method on the other hand is a data driven method and 5000 training samples are utilized to construct a surrogate to save training time the complexity of contaminant distribution resulting from the interaction of three joint contaminant sources cannot be entirely recognized with 5000 training samples the second reason is that there is inherent uncertainty in the surrogate to predict the contaminant concentration fields based on source information and conductivity fields the r2 value of the rdcnn surrogate used for the test dataset is 0 956 and there is a slight deviation between the actual concentrations for each observation location obtained from the forward model and from the rdcnn based surrogate which may make it more challenging for ilues to converge to the actual values and increase the variance the reason should be noted that in fig 15 the former ilues converges in 3 iterations for the source strength parameter whereas the total iteration number is selected to be 10 first the source strength parameters and the high dimensional hydraulic conductivity parameters are inversed together the number of unknown parameters for contaminant is only 9 while the number of hydraulic conductivity parameters is 255 despite the fact that the contaminant source parameters converge after three iterations the estimation of the hydraulic conductivity field does not converge and does not produce the similar results as the reference field fig 20 and the variance field is still relatively large following three iterations the number of 10 iterations is used to guarantee satisfactory estimation results for both the contaminant source and the hydraulic conductivity field 4 3 application in an irregular aquifer to further test the performance of the proposed ilues based surrogate inverse framework an anisotropic aquifer with irregular boundaries is chosen which is revised by the cases described by xing et al 2019 and li et al 2022 fig 21 shows the plan view of this case with two contaminant sources a pumping well and eight observation locations the entire simulation time is 120 months which is divided into 20 equal stress periods with each duration of 6 months the constant heads prescribed for the upper left and lower right boundaries are 100 and 80 m respectively and no flow boundaries are assumed on other sides the aquifer is divided into five hydraulic conductivity field zones and the values of each zone are unknown the contaminant is assumed to be released to the aquifer during the first 5 release periods each of which is equivalent to two stress periods thus 15 unknown variables need to be identified for 2 sources 5 release periods and 5 zones of hydraulic conductivity observations consist of 8 hydraulic head and contaminant concentrations at t 720 1080 1440 1800 2160 2520 2880 d actual values of each zone and source strength are listed in table 3 and table 4 respectively the chemical reactions are introduced in the contaminant transport model the related parameters of the chemical reactions and the basic hydrogeological parameters of the aquifer are given in table 5 the rdcnn 36 31 is selected to construct the surrogate for this irregular aquifer where the initial size of output feature map is 64 after the first convolutional layer and the growth rate is 36 the network training epoch of 220 and batch size of 100 are considered during the training process the training and test datasets contain 3000 and 300 randomly selected samples respectively fig 22 shows the result of a randomly selected testing sample to display the performance of the rdcnn surrogate for substituting the original model on an irregular aquifer model the rdcnn surrogate can approximately capture the features of the contaminant concentration and hydraulic head field and the values of r2 and rmse for the whole testing dataset are 0 991 and 0 039 respectively which indicates that the rdcnn surrogate model could provide similar prediction results as the forward model the surrogate coupled ilues is employed to jointly inverse contaminant source information and hydraulic conductivity for each zones an ensemble size of 1000 and an iteration number of 8 are selected and the determination of other ilues algorithm parameters is the same as the aforementioned fig 23 presents the inversion results of unknown variables the ensemble means of both the contaminant source strength and the hydraulic conductivity of each zone gradually get closer to the true values and the ensemble variances decrease as the iteration progresses demonstrating that rdcnn surrogate coupled ilues enables accurate inversion of unknown parameters for an irregular aquifer with two sources the inverse results of the surrogate coupled ilues further illustrates the robust prediction capability of the rdcnn surrogate model 5 conclusions in this study a deep learning method based on residual dense connected convolutional neural network rdcnn is proposed to construct surrogate model for groundwater flow and solute transport models with multiple time varying contaminant sources the rdcnn constructed surrogate is combined with an iterative local updating ensemble smoother ilues to achieve the efficient and accurate joint inversion of high dimensional parameters of the groundwater contaminant source and hydraulic conductivity field the proposed method could also achieve satisfactory performance for substituting an irregular aquifer model with relatively complicated conditions the main conclusions drawn from this study are as follows 1 based on the deep fully convolutional encoding decoding architecture a residual densely connected convolutional neural network rdcnn is proposed to implement a streamlined deep neural network coupling the feature reuse idea of dense connected network densenet with the residual connected idea of residual network resnet the rdcnn is employed to construct a surrogate for the groundwater forward model where the high dimensional input parameters and output state variables are represented by different images and the surrogate construction process is transformed into an image to image regression problem the performance of a surrogate model can successfully explore the complex relationship between the forward model s input parameters and output state variables without high computational cost for training 2 the performance of the proposed rdcnn and traditional dcnn is compared by substituting the forward model to depict hydraulic head and concentration fields based on the contaminant source information and hydraulic conductivity field the results demonstrate that the rdcnn based surrogate provides more similar output fields to the forward model indicating that the proposed rdcnn performs better in high dimensional surrogate modeling whereas both the proposed rdcnn and traditional rdcnn can successfully approximate the mapping relationship between high dimensional inputs the multiple contaminant time varying source parameters and hydraulic conductivity field and outputs the hydraulic head field and concentration fields at different times the proposed method takes advantage of the skip connections within a residual dense block which facilitate information propagation without degradation making it possible to ease training the network and to achieve comparable and ever better surrogate performance on image regression however the proposed method is a data driven method and not always physics based and the generalization ability of the constructed surrogate beyond the training data is limited in addition a large number of training samples are required to guarantee the accuracy of the surrogate therefore physical constraints should be combined with the neural network to characterize the transport simulation model more accurately in further study due to the lack of real site information application of the proposed method on a practical case is still challenging and remains to be explored in subsequent study 3 the influence of the number of training samples and network structure parameters on the accuracy of the rdcnn surrogate model is discussed the results indicate that with the limited computation resources a larger number of training samples should be selected to train the rdcnn to improve the prediction performance of the surrogate to ensure the accuracy of predictions and increase the training efficiency of the surrogate model it is necessary to thoroughly consider the characteristics of the proposed network such as its depth and growth rate 4 the ilues algorithm is used to estimate the contaminant source intensity and hydraulic conductivity field based on the forward model and the rdcnn surrogate model respectively the results show that both the forward model based and the rdcnn surrogate based ilues method could successfully inverse the high dimensional parameter compared to the ilues algorithm based on the forward model the ilues method based on the rdcnn surrogate model method can inverse high dimensional parameters with considerable accuracy by running a small number of forward models which significantly reduces the computational cost and improves inversion efficiency credit authorship contribution statement xuemin xia conceptualization methodology writing original draft writing review editing simin jiang supervision conceptualization writing review editing nianqing zhou supervision validation jifei cui investigation xianwen li validation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work is supported by the key technologies research and development program 2019yfe0114900 and the national natural science foundation of china 42077176 the authors would like to thank the editor and reviewers for their constructive and valuable comments and suggestions which significantly improve the quality of this work 
2419,hydrological models are useful to support ecosystem services restoration however when planning the expansion of nature based solutions and payments for ecosystem services there are requirements including the principle of additionality representation of multiple runoff mechanisms and calculation of farm scale spatial outputs and epistemic uncertainty while addressing these aspects is important to make future planning more effective investment costs and water benefits it is also challenging this paper integrates in a single modeling framework the main requirements highlighted this allows an improved selection of top priority areas with farm scale spatial resolution and a deeper understanding of how epistemic modeling uncertainty affects the results which is relevant to evaluate the risks of overestimating ecosystem services benefits the modeling approach is demonstrated in a case study watershed in the atlantic forest biome brazil the plans model is introduced which uses the design of topmodel to simulate both simulates both saturation excess and infiltration excess runoff at the farm scale resolution also it uses a novel saturation index based in a composition of height above the nearest drainage and topographical wetness index terrain descriptors we applied the generalized likelihood uncertainty estimation method aided by an evolutionary algorithm to estimate output epistemic uncertainty results show that uncertainty substantially affects priority definition 97 ranking change and that simulated topographic effects can overcome local effects of land cover and soil type with better data uncertainty evaluation indicates that the restoration program in the study case could have the cost of its allocation policy reduced by up to 27 showing that it can be made more cost effective with the methods proposed graphical abstract keywords spatial epistemic uncertainty ecosystem services nature based solutions watershed restoration priority areas data availability data will be made available on request 1 introduction the spatial allocation of restoration actions in watersheds is an unsettling challenge in the search for water security and other sustainable development goals of the united nations 2030 agenda un water 2018 cassin and matthews 2021 there is a justified urge for upscale nature based solutions nbs in watersheds changes in land use and land cover induced by an array of nbs allegedly improves the ecosystem services of water provision water quality regulation soil protection extreme events mitigation in addition of co benefits for biodiversity sanitation and food security sahani et al 2019 kalantari et al 2018 keesstra et al 2018 as a response payments for ecosystem services pes programs are emerging as an attractive strategy for expanding nbs in watersheds accounting for an investment of up to us 24 7 billion annually totalizing 387 programs in 62 countries salzman et al 2018 in this context planning an efficient resource allocation in space rely strongly on mapping priority areas for ecosystem services restoration with the help of environmental models maes et al 2012 yet this is not an ordinary task especially when such services are linked to upstream hydrological processes in fact a modeling approach for effectively support decision making in the case of nbs expansion must meet four basic requirements 1 to follow the principle of additionality 2 to represent multiple runoff mechanisms 3 to obtain farm scale spatial outputs and 4 to estimate output epistemic uncertainty these requirements are explained and justified below first requirement to follow the principle of additionality the expansion of nbs as an investment in natural capital must deliver additional ecosystem services wunder 2007 tacconi 2012 such expansion in watershed pes programs is generally motivated by the expectation of a valuable change in terms of return of investment or avoided cost from the perspective of downstream water users kroeger et al 2019 this means that planning assessments must compare model outputs between scenarios with and without planned actions e g carvalho santos et al 2014 ullrich and volk 2009 martinez martinez et al 2014 daneshi et al 2021 in the approach of ecosystem service restoration foley et al 2005 this principle translates into assessing the difference or anomaly between simulated hydrological processes under baseline pre development and current post development land use scenarios as presented in lima et al 2017 therefore planners need to apply conceptual models in order to make deductive inferences about several processes of the hydrological system such as runoff infiltration recharge and evapotranspiration simplified lumped and data driven models e g ditthakit et al 2021 singh et al 2022 although useful for streamflow prediction are not applicable for the case of planning the expansion of nbs in watersheds second requirement to represent multiple runoff mechanisms empirical evidence in rural watersheds demonstrates that runoff is indeed controlled by multiple processes saffarpour et al 2016 hence models used for mapping priority areas must discern infiltration excess runoff hortonian runoff horton 1933 which is influenced locally by land cover from saturation excess runoff dunnean runoff dunne and black 1970 which is influenced globally by the topography and saturation of the basin lyon et al 2006 this fact has been largely ignored by the literature of ecosystem services modeling on the contrary as points francesconi et al 2016 there is a growing trend in the use of the swat model in which runoff is based only in an infiltration excess mechanism arnold et al 1993 third requirement to obtain farm scale spatial outputs this is obvious since any watershed pes program is by definition a farm scale land use policy hence models must help planning at operational level that is ranking the priority of all rural properties in a given area of interest e g bremer et al 2021 quaglia et al 2019 reaney et al 2019 lima et al 2014 ghebremichael et al 2013 most of the literature on modeling ecosystem services however delivers methods for planning at the strategic level e g rabiei et al 2022 cong et al 2020 liu et al 2016 due to intrinsic model structure outputs are generally aggregated in sub basins which is not helpful for deciding detailed farm scale resource allocation fourth requirement to estimate output epistemic uncertainty epistemic uncertainty arises from the lack of knowledge about 1 how to represent the environmental system and 2 forcing data used for calibration or scenario evaluation beven 2016 communication of model uncertainty although challenging blöschl et al 2019 is crucial for well informed decision making in the context of ecosystem services modeling e g chen et al 2022 xiaojun et al 2021 tsvetkova and randhir 2019 vigiak et al 2015 woznicki and nejadhashemi 2014 strauch et al 2013 moreover uncertainty estimation is a best practice found in several other environmental applications such as mineral prospecting mcmanus et al 2021 land use planning lechner et al 2014 xing et al 2020 baker et al 2021 reservoir operation xu et al 2021 vanda et al 2022 groundwater management seifi et al 2020 atmospheric pollution management ribeiro et al 2016 gholami et al 2020 and planning for climate change seaby et al 2015 since conceptual hydrological models are inevitably subject to the equifinality problem beven 2006 conventional modeling approaches e g ostad ali askari 2022a ostad ali askari 2022b may be incomplete for decision makers because the information of precipitation and streamflow alone is not sufficient to justify a specific set of parameters there will always be the possibility of obtaining right results for the wrong reasons advanced studies in epistemic uncertainty estimation for mapping and ranking priority areas generally propose the use of ensembles of model spatial outputs e g evenson et al 2021 cameira et al 2019 saad et al 2018 hamel and guswa 2015 huisman et al 2009 robertson et al 2009 however according to evenson et al 2021 further research may apply a variety of methods to assess uncertainty such as monte carlo latin hypercube or bootstrapping sampling and more formalized uncertainty procedures such as generalized likelihood uncertainty estimation glue the objective of this paper is to provide a comprehensive modeling approach to tackle the problem of planning the expansion of nbs in watershed pes programs under epistemic uncertainty the novelty of our research is that we deliver a unique framework that captures all four basic requirements described earlier to address the problem as shown in table 1 there is a clear gap to be fulfilled in the literature covering such requirements the approach applies a novel model called plans initially proposed in possantti and marques 2022 for a case study located in southern brazil the arroio castelhano watershed the basin is within the atlantic forest biome a hopespot for ecosystem services restoration in the most populous region of brazil rezende et al 2018 the model is a modified version of topmodel beven and kirkby 1979 beven et al 2020 a model that maps hydrological processes at the appropriate spatial resolution farm scale and simulates both infiltration excess runoff and saturation excess runoff next we use the generalized likelihood uncertainty estimation glue method beven and binley 1992 2014 to estimate the epistemic uncertainty a guided search is used with the help of an evolutionary algorithm to select 100 behavioral models according to a likelihood measure which considers both observed streamflow time series and evapotranspiration map scenes for each hydrological process runoff infiltration etc the principle of additionality was followed by evaluating the anomaly the difference between post development current and pre development baseline land cover scenarios spatial epistemic uncertainty in turn was defined by the ratio between the distributed 90 prediction interval and the distributed mean finally we evaluated the potential impact on decision making in the face of more or less precipitation and streamflow data estimating the economic value of this information for the watershed planners 2 material and methods 2 1 approach overview the first step in our approach is to estimate the distributed statistics of hydrological processes in pre development and post development land cover scenarios for the watershed of interest fig 1a these statistics are obtained by a grid to grid processing of a set of maps of several hydrological processes such as runoff infiltration recharge and evapotranspiration these maps were obtained by simulating the system using a set of hydrological models each model being formed by a different combination of parameters the set of models is selected according to likelihood criteria for the observed behavior of the hydrological system as hydrological information on precipitation and streamflow is not always available in the basin of interest for the likelihood assessment the approach assumes the feasibility of transferring parameters from a calibration basin the approach is essentially independent of the simulation model as long as maps of hydrological processes can be produced at the appropriate spatial scale which is the scale of rural properties to consider the principle of additionality the anomaly of hydrological processes is the guiding variable for decision making the anomaly is defined here as the potential or deficit of hydrological ecosystem services which is used to justify the expansion of nbs thus for each hydrological process the spatial anomaly of the mean is the cell to cell difference of the distributed mean between the land cover scenarios fig 1b 1 δ i μ 1 i μ 0 i i where δ i is the mean anomaly of the hydrological process in the grid cell i μ 1 i is the mean of the hydrological process in the post development scenario in the grid cell i and μ 0 i is the mean of the hydrological process in the pre development scenario in the grid cell i the distributed mean of runoff is used a posteriori to estimate soil annual loss and annual export of nutrients nitrogen and phosphorus from eq 1 the spatial anomaly of such processes is also estimated and used in decision making fig 1d for each hydrological process in each land cover scenario the spatial epistemic uncertainty is defined by the cell to cell ratio between the 90 prediction interval and the mean 2 u i i 90 μ i i where u i is the spatial epistemic uncertainty of the process in the grid cell pixel i μ i is the process mean in the evaluated scenario and i 90 is the 90 prediction interval of the process in the evaluated scenario as there are two land cover scenarios pre development and post development the inter scenario spatial uncertainty for a given hydrological process is the mean of the uncertainty between the scenarios fig 1c finally the result is a limited and ordered list of top priority rural properties in the watershed of interest fig 1e the list is constrained by the available funds for the pes program which is converted into a limitation of the total area of rural properties annual pes are defined per unit of area the order of the list is defined by a composite index of rural property priority that considers both the anomaly and the uncertainty of the hydrological processes of interest 3 i p i p 1 n i u p i i a p i p 1 n i u p i i where i p i is the priority index of a rural property i i a p i is the anomaly index of the process p in rural property i e i u p i is the uncertainty index of the process p in rural property i the eq 3 can be understood in fact as the average of the anomaly index i a of the hydrological processes of interest weighted by the uncertainty index i u of the processes the uncertainty index i u therefore must be high for properties with low epistemic uncertainty and vice versa so that the priority i p is always higher in rural properties with high anomaly and low epistemic uncertainty the anomaly indices i a and uncertainty i u in turn are ordinal variables defined from the classification in quantiles of the histogram of the anomaly δ eq 1 and the uncertainty u eq 2 aggregated over the spatial extent of each rural property it is assumed that different rural properties may appear on the priority list when different hydrological information is available which includes observed series of precipitation streamflow and evapotranspiration in maps these are used to assess the likelihood of model realizations hence there is an opportunity to estimate the economic value of this information for watershed planning and management by comparing datasets with more information e g greater number of data points to datasets with less information fig 1f the dataset available was considered as a reference more information the comparison was performed with alternative degraded datasets in which the information was removed 2 2 the plans model the planning nature based solutions plans model was originally conceived by possantti and marques 2022 as a modeling framework that aims to help planning and management of watersheds here we present a new hydrological model to the framework in order to allow greater focus on decisions involving space employing the semi distributed modeling approach of topmodel beven and kirkby 1979 the potential daily evaporation is estimated by the simplified model proposed by oudin et al 2005b the streamflow routing is considered in a lumped way by using the unit hydrograph of nash 1958 model details are presented below table 2 displays the list of all parameters of the model 2 2 1 soil water balance as in topmodel the soil water balance is performed considering the basin as a system of global and local water stocks and flows beven 2012 globally the system is conceived as a large water stock filled with a porous medium fig 2a locally the system is a regular grid of stacked elementary water stock cells that may or may not exhibit hydrological similarity to each other fig 2b in the simulation the two scales are linked by the way in which the spatial pattern of water table is drawn at each time step and by the fact that the global variables are the average of the local variables fig 2c for example global soil water deficit is defined by 4 d 1 n i n d i i where d mm is the global soil water deficit d i mm is the local soil water deficit in the grid cell i and n is the number of grid cells on the global scale soil stores water in two reservoirs the saturated zone where water can move horizontally and the unsaturated zone vadose zone where water moves in the vertical direction fig 2a the saturated zone gains water by recharge from the unsaturated zone and loses water both by baseflow and by the plant transpiration when applying the principle of mass conservation to the control volume of the saturated zone 5 d d d t q b t p s q v where q b mm δ t 1 is baseflow t p s mm δ t 1 is the global transpiration of plants from the saturated zone and q v mm δ t 1 is the global recharge from the vadose zone to the saturated zone given the initial conditions the eq 5 is numerically solved for finite differences in a sequence of discrete t time steps with δ t duration as well as the next equations of mass conservation the plans model follows the exponential decay hypothesis of soil transmissivity beven and kirkby 1979 in which the baseflow is defined by 6 q b q o e d m where q o mm δ t 1 is the maximum baseflow under complete saturation conditions of the basin and m mm is the exponential decay coefficient the global recharge is computed by the local average of the gridded cells 7 q v 1 n i n q v i i where q v i mm δ t 1 is the local recharge from the vadose zone to the saturated zone this flow is computed locally according to beven and wood 1983 assuming a direct proportion to the local water deficit 8 q v i k s a t i u n z i d i i where k s a t i mm δ t 1 is the effective local hydraulic conductivity u n z i mm is the water stored in the vadose zone locally and d i mm is the local deficit of water in the soil similarly 9 t p s 1 n i n t p s i i where t p s i mm δ t 1 is the local plant transpiration of the saturated zone at the local scale the model is composed of four storages stacked in layers two of them are positioned above ground level the vegetation canopy c p y i mm and the surface storage s f s i mm which represents both shallow depressions and the litter rich soil organic horizon the other two are underground the local vadose zone u n z i mm and the local saturated zone which is modeled as a function of the local deficit d i mm canopy surface and vadose zone are all subjected to mass conservation at the local scale the local deficit on the other hand is updated at each time step by the mapping function to follow the global soil water balance eq 5 for the canopy the conservation of local mass is defined by 10 d c p y i d t p i i r a i e v c i c p y i c p m a x i i where c p y i mm is the local water storage in the canopy p i mm δ t 1 is the local precipitation i r a i mm δ t 1 is the local sprinkler irrigation input and e v c i mm δ t 1 is the local evaporation of water from the canopy local water storage in the canopy is constrained by the local storage capacity c p m a x i mm so that excess water generates throughfall t f i mm δ t 1 the conservation of local mass on the surface is defined by 11 d s f s i d t t f i i r i i i n f i e v s i s f s i s f m a x i i where s f s i mm is the local surface water storage i r i i mm δ t 1 is the local drip or flood irrigation flow i n f i mm δ t 1 is the local infiltration stream and e v s i mm δ t 1 is the local flux of evaporation from the surface local surface water storage s f s i is constrained by the local storage capacity s f m a x i mm so excess water generates runoff r i mm δ t 1 local surface water storage s f s i is drained by infiltration at the rate of local effective hydraulic conductivity k s a t i but this depletion is bottom up controlled by the local water deficit just below the surface d i which implies a zero seepage flux over fully saturated grid cells where d i 0 unless depleted by local surface evaporation e v s i these grid cells will tend to produce saturation excess runoff dunnean mechanism and finally the local mass conservation of the vadose zone 12 d u n z i d t i n f i q v i t p u i i where u n z i mm is the local water storage in the vadose zone i n f i mm δ t 1 is the local infiltration flow q v i mm δ t 1 is the local recharge flow and t p u i mm δ t 1 is the local flow of plant transpiration from the vadose zone the actual local evapotranspiration e t i mm δ t 1 is defined by the sum of all evaporation and transpiration processes which are constrained by total daily potential evapotranspiration p e t t mm δ t 1 in each time step t 13 e t i p e t t e v c i e v s i t p s i t p u i p e t t e v c i e v s i t p s i t p u i e v c i e v s i t p s i t p u i p e t t i in the model there is a reserved order for the local computation of e t i until the demand i e p e t t is satisfied the order is based on the empirical results obtained by souza et al 2019 in studies of irrigated rice crops in accordance with the energy balance based approach of the authors evaporation from the canopy e v c i is defined to occur first followed by plant transpiration from the saturated zone t p s i which is followed by plant transpiration from the vadose zone t p u i and lastly followed by evaporation from the surface e v s i the local root zone depth r z d i mm which is an important constraint for plant transpiration is defined by 14 r z d i e r z i φ i φ i 1 i where e r z i mm is the effective depth of the root zone and φ i dimensionless is the effective local soil porosity 2 2 2 the htwi index of saturation propensity the fundamental concept underlying beven and kirkby 1979 s topmodel approach is that groundwater dynamics at the local scale can be emulated as a function of the local propensity for saturation and the global soil water deficit predicted by the global water mass conservation eq 5 the deviation between the global and local deficit of soil water is directly proportional to the deviation between the global and a local index of saturation propensity so that 15 d i 0 d m λ λ i 0 d m λ λ i d m λ λ i 0 i where d i mm is the local soil water deficit d mm is the global soil water deficit m mm is the exponential decay parameter of the transmissivity λ i dimensionless is an index of local saturation propensity and λ dimensionless is an index of global saturation propensity beven and kirkby 1979 derived an index of saturation propensity λ i called topographic wetness index twi from a formal and physically based treatment of darcy s law in the plans model the mapping function is relaxed in terms of physical formality with the local propensity to saturation λ i being taken as a hydrological similarity index explicitly defined by the modeler as a hypothesis of how soil saturation in the basin evolves with more or less moisture the global index λ is therefore treated as an available threshold for calibration the formula of the twi is 16 t w i i ln a i tan β i i where for grid cell i a i m 2 m 1 is the upstream drainage area per contour unit usually taken by grid cell resolution and β i radians is the local slope of the terrain although the physical conceptual basis of twi is correct i e a given grid cell is more prone to saturation the flatter and further downstream it is in practice we think that this assumption works only in the headwaters of a basin which are usually steeper this is because these areas are less subject to downstream controls which are not considered in twi downstream cells do not influence flow accumulation or local slope these downstream controls on soil moisture conditions are considerable as empirically demonstrated by several studies e g crave and gascuel odoux 1997 hjerdt et al 2004 some indices have already been designed to represent them such as the height above the nearest drainage called hand nobre et al 2011 rennó et al 2008 the usage of hand or similar indices has been shown to have several advantages over the twi in representing soil saturation murphy et al 2009 gharari et al 2011 ågren et al 2014 oltean et al 2016 loritz et al 2019 in the present work we adopted hand as a quantitative indicator for the saturation propensity below a height threshold over the channels network that is in a zone of the landscape that we can refer to as riparian wetlands fig 3a thus we introduce hand enhanced twi htwi which is a weighted superposition of the two indices 17 h t w i i s f t w i i w f h a n d i 1 w 0 f t w i i 1 0 f h a n d i 1 i where for the index cell i h t w i i dimensionless is the local htwi f t w i i dimensionless is the fuzzyfied twi f h a n d i dimensionless is the fuzzyfied hand w dimensionless is the magnitude of the dominance of hand over twi and s dimensionless is a constant defined so that the map values of htwi can be scaled back to the amplitude of twi a similar approach is presented in jafarzadegan and merwade 2019 with probability functions to preserve continuity in transitions the fuzzy twi is defined from a membership function based on an ascending sinusoidal transition towards an upper threshold 18 f t w i i 1 2 cos π t w i i t m a x 1 2 0 t w i i t m a x i where t m a x dimensionless is the upper threshold for twi which can be the maximum value observed in a given basin similarly the fuzzyfied hand is defined from a membership function based on a descending sinusoidal transition towards an upper threshold 19 f h a n d i 1 2 cos π h a n d i h m a x 1 2 0 h a n d i h m a x i where h m a x meters is the upper threshold of hand that defines the riparian wetland zone the map of htwi is therefore defined by two parameters the weight w which configures the dominance of hand over twi everywhere and the threshold h m a x which configures the spatial distribution of riparian wetlands we believe that this allows the modeling of basins with a wide variety of geomorphological conditions from shallow soil basins lesser dominance of hand to deep soil basins greater dominance of hand the details b to e in fig 3 schematically illustrate the method for obtaining htwi 2 2 3 spatial heterogeneity in plans the concept of hydrological similarity is used to represent spatial heterogeneity space is implicitly represented by the histogram of hydrological response units our method includes both conventional hydrological response units represented by soil types and cover classes fig 4a as well as classes of the saturation propensity index named here as saturation propensity units fig 4b the result is a encoded map of spatial units in a two dimensional histogram that is a spatial matrix that is subjected to processing in the model simulation fig 4c the flows stocks and model parameters are therefore stored in a matrix in computational memory which is decoded into explicit maps a posteriori for each hydrologic response unit there are specific parameter values for canopy storage capacity c p m a x u surface storage capacity s f m a x u root zone depth r z d u effective soil hydraulic conductivity k s a t u and effective soil porosity φ u this leads inevitably to the problem of parameter dimensionality typical of models based on hydrologic response units beven 2012 we circumvented this problem by allowing a priori conditioning of the relative magnitude between equivalent parameters based in proxy spatial variables field measurements and other available information the practical result of this strategy is that calibration takes place only on unitary parameters that is of magnitude equal to unity the relative value of each hydrological response unit is then calculated by the respective scale factors 2 2 4 annual loss of soil and nutrients the annual local soil loss in the plans model is estimated by the usle m equation proposed by kinnell and risse 1998 therefore the simulated maps of the annual runoff coefficient are used in a gis based approach of the usle m method maps of precipitation erosivity local soil erodibility and other dimensionless factors of the equation are obtained from the literature the annual local nutrient export is estimated by using the empirical load spatially distributed by simulated local soil loss 20 e i j e j a i j a j where e i j kg ha 1 year 1 is the local empirical export load annual nutrient per unit area in cell i located in area with land cover j e j kg year 1 ha 1 is the annual nutrient export load for the land cover type j a i j is the simulated local annual loss of soil in cell i and a j is the average annual local soil loss for land cover type j empirical loading values e j for nitrogen and phosphorus in different types of land cover can be estimated from the literature or calibrated directly from experimental plots 2 3 estimation of epistemic uncertainty 2 3 1 the glue method the epistemic uncertainty of the plans model was evaluated by the generalized likelihood uncertainty estimation glue method proposed by beven and binley 1992 in this method the epistemic uncertainty of a model as a general hypothesis is estimated by simulating a large set of models combinations of parameters specific hypothesis which are selected from a prior confidence interval as it is a bayesian approach albeit informal the method allows new observations to be incorporated recursively incrementally improving the posterior confidence interval estimation of model parameters and realizations this is possible by the definition of an informal likelihood or generalized taken as a quantitative measure of credence in a model in relation to the available set of observations beven and binley 2014 thus the bayes equation takes the following form 21 l p m y l o m l y m y c where l p m y is the posterior likelihood of a model m given the set of observations y l o m is the previous likelihood assigned to the m model l y m y is the informal likelihood of the model m given the set of observations y and c is a scale constant defined so that the sum of the posterior likelihood of each evaluated model is unity 2 3 2 informal likelihood measure from the point of view of the equifinality paradigm one should make use of the greatest number of observations about the hydrological system for conditioning a model including the spatial pattern of processes e g zink et al 2018 oliveira et al 2021 for this reason the evaluation of the plans model relied on a composite likelihood measure that includes both observed streamflow and evapotranspiration the informal likelihood therefore was defined by a euclidean distance in the objective space 22 l m y 1 1 l m q 2 1 l m e t 2 where l m y is the informal likelihood of the model m given the set of observations y l m q is the informal likelihood of streamflow and l m e t is the informal likelihood of evapotranspiration both likelihoods streamflow and evapotranspiration were determined by the kling gupta efficiency kge proposed in gupta et al 2009 23 kge s y 1 r s y 1 2 σ s σ y 1 2 μ s μ y 1 2 where kge s y is the kling gupta efficiency of the simulation s given the observed counterpart y r s y is the correlation coefficient between s and y σ s is the standard deviation of s σ y is the standard deviation of y μ s is the average of s and μ y is the average of y thus the informal likelihood of streamflow was evaluated by the kge of the streamflow logarithm 24 l m q kge log q y e s log q o b s the informal likelihood of evapotranspiration was evaluated by the mean kge of et scenes derived from landsat 8 imagery and computed the by surface energy balance algorithms for land sebal presented and detailed in laipelt et al 2020 25 l m e t 1 n i n kge e t i y e s e t i o b s where n is the number of available et scenes i for direct and computationally fast comparison with the simulation maps the observed et scenes were resampled in the spatial matrix of the plans model fig 4 by the zonal mean of each matrix cell that is each spatial unit furthermore to not bias the likelihood estimate the value of et in each cell of the matrix both simulated and observed was considered proportional to its spatial distribution 2 3 3 search algorithm admissibility and selection criteria the glue method is also characterized by the a priori definition of an admissibility criterion for including searched models in the posterior likelihood estimation this leads to the problem of searching the parametric space for a large set of admissible or behavioral models here the search for such set was performed by an evolutionary algorithm unlike the conventional glue method of beven and binley 1992 which makes use of random sampling in the parametric space this search method suggested by khu and werner 2003 aims to reduce the number of model realizations in order to map high likelihood regions in the parametric space without however focusing on the search of a single global optimum in this sense we developed a genetic algorithm to perform the search for admissible parameter sets the algorithm 1 below presents the pseudo code of the evolutionary algorithm developed for the calibration of the plans model this code was compiled by a python 3 routine available in https github com ipo exe plans3 releases tag v0 1 1 the algorithm s parameters are 1 the number of generations 2 the size of the population of candidate solutions 3 the size of the recombination segment and 4 the mutation rate of the solutions at the end of the process the last generation contains the best solutions found any candidate solution consists of a vector of numerical elements the encoding of the vector gene in the evolutionary algorithm is done in integer format ranging from 0 to 1000 that is the numerical value of the calibrated parameters manifests a resolution of the 1000th prior confidence interval the variation operator of the developed algorithm has two components 1 recombination and 2 mutation recombination occurs by drawing two candidate solutions that produce two new solutions by exchanging a segment of pre defined size between them mutation occurs by substituting one element for another in the vector both are stochastic operations with the difference that not all solutions mutate the algorithm selection operator presents deterministic elitism that is the best solutions of one generation are selected to integrate the next generation in the present case study the uncertainty of ten parameters were assessed in this sense any candidate solution consisted of a vector of ten numerical elements that is submitted for evaluation in terms of likelihood eq 22 therefore it was necessary to simulate the plans model in each evaluation and return not only the simulated streamflow but also the spatial matrix of et on the date of each landsat scene used in the calibration period twenty generations were evaluated each with 2 000 candidate solutions the mutation rate was set to 1 and the recombination segment was set to three elements we defined the admissibility criterion by the 1000th best solutions produced by the search algorithm i e the combinations of parameters with ordering of likelihood l y m y eq 22 higher or equal to 1000 as for the estimation of the spatial epistemic uncertainty of the case study a selection was extracted from the behavioral models considering the best hundred models in relation to the likelihood of streamflow l m q eq 24 2 4 case study and experiment design here are described the details of the case study which is the arroio castelhano basin basin of interest and the pardinho river basin calibration basin additional details are presented in appendix a appendix a 1 shows the list of data used appendix a 2 presents additional maps of the arroio castelhano basin basin of interest 2 4 1 the pes program in the arroio castelhano watershed our case study is the arroio castelhano watershed a tributary of the taquari river which is located in rio grande do sul brazil the watershed is within the atlantic forest biome where native vegetation is a submontane semideciduous wet forest with rich biodiversity and high level of species endemism rezende et al 2018 the mountains are characterized by basalt cliffs with residual shallow clayey soils and valleys with relatively deeper loamy soils the climate is humid sub tropical with an average annual precipitation of approximately 2000 mm a small portion of the region at lower elevations is dominated by sandstone substrate and well drained sandy soils due to the shallow soils steep terrain orographic precipitation and low seasonality a streamflow regime with high variability and relatively low baseflow is observed in the rivers of the region collischonn et al 2007 the arroio castelhano watershed is the main source of water for the city of venâncio aires nearly 72 thousand inhabitants ibge 2021 drinking water is supplied by the companhia riograndense de saneamento corsan which is developing a watershed pes program in the basin area 468 km 2 the existence of budget constraints leads to the need to optimize the process of choosing the priority restoration areas included in the program for the expansion of nbs in the case of corsan s pes program for the arroio castelhano watershed we consider an annual budget estimated at us 39 062 00 and annual payments of us 39 00 ha which results in a maximum total area of 1000 ha for the expansion of nbs i e 2 6 of the basin area however since the region has a high density of rural properties with 3496 rural properties registered the problem of spatial allocation arises where to invest the available resources in the most efficient way possible fig 5g 2 4 2 spatial datasets the absence of gauging stations in the arroio castelhano basin made it necessary to use for the calibration process the neighboring basin rio pardinho 805 km 2 fig 5a the pardinho river basin presents great similarity in terms of area climate landscape geology land use and land cover which justifies the transfer of the model parameters for both basins maps were produced for saturation propensity units and hydrological response units the saturation propensity map was derived from the htwi map which itself was classified into twenty classes separated by equal intervals from zero to the maximum index obtained the map of twi was processed from strm digital elevation model farr et al 2007 with cell resolution of 30 m fig 5a the digital elevation model was processed by the algorithm of wang and liu 2006 for the removal of depressions from this the flow directions d8 method and the accumulated flow in each cell were determined the map of hand was obtained from the digital elevation model of the merit hydro dataset yamazaki et al 2019 using a drainage network defined by the algorithm topographic position based stream definition of barbedo et al 2022 the values of htwi parameters w and h m a x were previously defined with h m a x set at three meters and w considered the unit to obtain the hydrological response units map we built a mosaic between maps of soil types fig 5d and land cover classes fig 5e the classification of soil types considered two approaches 1 the definition of the substrate that forms the soil based on data from the hydrogeological map of brazil diniz et al 2014 and 2 the classification of landscape units based on hand and slope gao et al 2014 gharari et al 2011 savenije 2010 where a threshold of hand three meters separates the riparian wetlands from the rest of the terrain and a slope threshold of 10 separates the hillslope areas from the flat areas for each substrate this classification yields three landscape units for the soil type 1 residual soil 2 colluvial soil and 3 alluvial soil for land cover we separated regions into six classes 1 crops 2 pastures 3 roads 4 forests 5 urban areas and 6 water bodies this classification was based on field visits and visual inspection of satellite imagery in which we verified that the crops are mostly tobacco and accompanied by pastures the native vegetation is the atlantic forest due to the high land division density the region has a large number of unpaved rural roads subject to heavy erosion the post development land cover scenario map fig 5c was obtained for both basins from the mapbiomas project of souza et al 2020 which is a classification of landsat 8 scenes and rural road data available from openstreetmap contributors 2017 the reference year for coverage in the post development scenario was 2013 the map of the pre development coverage scenario on the other hand was defined by the coverage of potential native vegetation that is by the complete coverage of atlantic forest see appendix a the relative magnitude of model parameters for each hydrologic response unit was conditioned a priori considering spatial proxy variables and values reported in the technical literature for the coverage parameters c p m a x s f m a x and e r z the relative magnitude between each hydrological response unit was obtained by the zonal mean of the ndvi of landsat 8 scenes obtained in the period encapsulated by the precipitation and streamflow series as for the soil parameters k s a t the relative magnitude between each hydrological response unit was considered from the hydrogeological map of brazil diniz et al 2014 the effective porosity value φ was fixed a priori φ 0 5 2 4 3 hydrological datasets streamflow series used came from the gauging station of rio pardinho code 85830000 shown in detail iv in fig 6a available from the snirh database precipitation series from rain gauges deodoro code 2952037 boqueirão code 2952036 and herveiras code 2952035 were also obtained from the snirh database details i ii and iii in fig 6a fig 5b shows the map of monitoring stations and the thiesen polygons used as the area of influence of each precipitation station the average daily temperature series was obtained from the santa maria weather station code 83936 the longest period encapsulated by available hydrological information was four years from 2011 to 2015 the period reserved for verification was defined from october 2013 to 2015 corresponding to 30 of the total series in the available period and from 2013 onwards eleven daily scenes of evapotranspiration were obtained by the tool developed by laipelt et al 2020 for google earth engine which uses the algorithm surface energy balance algorithms for land sebal on landsat 8 imagery these daily scenes of et fig 6d were selected to have less than 10 cloud cover and focused on a reduced yet representative extent of the calibration basin the definition of such calibration window aimed to minimize the shading effect of the terrain in et scenes common in the mountainous region finally the et scenes were resampled in the model s spatial matrix fig 4c and the zonal mean was obtained for each class of hydrological response units and saturation propensity units in order to assess the sensitivity of our approach to the availability of hydrological information we structured three sets of data used in independent experiments fig 6b and c the reference dataset consists of all available data ds0 this set contains data from three rain gauges totalizing 16 years of data the other two sets consist of data that have been degraded the alternative set a dsa with only one rain gauge available and alternative set b dsb with only one rain gauge and a shorter time series as illustrated in fig 6c the reference set ds0 has 16 years of data records while the alternative sets dsa and dsb has eight and four years respectively 3 results 3 1 results in the calibration basin 3 1 1 search and selection of behavioral models the behavioral models found by the search algorithm brought elucidation on the distributions and posterior confidence intervals of the ten parameters that were analyzed by the glue method fig 7 exposes the results of the model search and the analysis of posterior distributions only for the reference dataset ds0 results for the alternative datasets dsa and dsb are given later in section 3 3 3 fig 7a presents an inspection window in the space produced by the two likelihood components streamflow l m q eq 24 and evapotranspiration l m e t eq 25 in this window while l m q exhibited positive values l m e t remained in a range of negative values which means that streamflow information was much better represented by the model we also highlight that several models exhibited relatively good likelihood measures for only one of the likelihood components which corroborates the equifinality thesis of beven 2006 the information available on the hydrological system is not enough to justify a given set of parameters from one model over another since in each generation the population parents produces the same number of descendants offspring up to 40 000 candidate solutions were explored in the evolution process illustrated by fig 7b although the number of generations 20 was defined a priori the evolution of the search resulted in a typical curve eiben and smith 2015 advancing fast at the beginning and stabilizing after a few generations fig 7c shows the likelihood of the behavioral models from the perspective of each of the ten parameters each point on the graph represents a behavioral model so each graph displays 1000 pointspoints and all have their corresponding counterparts on the other graphs in fact when evaluating the top of the point mass this type of graph allows the visual interpretation of the shape of the response surface of model informal likelihood furthermore the density of the points informs about the confidence interval and posterior distribution of the parameters which is determined by the glue method and illustrated in fig 7d it was found that part of the evaluated parameters showed a multi modal response surface with likelihood peaks obtained in many parts of the prior confidence interval in the case of parameters q o c p m a x and e r z the response surface was practically constant as for the k s a t parameter it was observed that there were two well defined peaks at each end of the range this feature resulted in a relatively small reduction in the posterior confidence interval about one tenth of the prior interval on the one hand these results also reinforce the equifinality thesis of beven 2006 there is ambiguity in relation to which is the optimal parameter set on the other hand the parameters m λ s f m a x c k and n manifested a unimodal response surface with a greater reduction in the confidence interval a relatively well defined likelihood peak was observed for the global parameters c k and n with a reduction in the confidence interval from one third to one fifth of the prior interval 3 1 2 model performance fig 8a shows results of the streamflow analysis shown on logarithmic scale the observed simulated median and i 90 of streamflow series are shown in detail i in fig 8a the temporal epistemic uncertainty of streamflow can be visualized in a weekly moving average in the detail ii in fig 8a here there was an epistemic uncertainty with a relatively accentuated variability and a higher weekly average in low flows which suggests that the model presents more behavioral possibilities to represent periods of drought for example in the 2012 drought the epistemic uncertainty reached its maximum value in addition to remaining above the average 173 for the calibration period during the verification period nonetheless the epistemic uncertainty exhibited less variability and remained at an average slightly lower than the calibration period 129 probably due to the higher moisture of this period the detail iii in fig 8a is also a weekly moving average which evaluates the performance of encapsulating the data observed by i 90 according to beven and binley 2014 an ideal performance would consist of i 90 encapsulating 90 of the observed data the results obtained however deviate from the ideal with the average for the calibration period being approximately 50 interestingly the encapsulation average remained similar in the verification period which implies that the model remained with the same performance which is usually not the case due to overfitting effects the simulated median performance was relatively good exhibiting kling and gupta efficiency of 0 66 gupta et al 2009 and nash sutcliffe efficiency of 0 48 nash and sutcliffe 1970 both metrics taken by the logarithm of streamflow the largest deviations from the median occur at high flows which suggests both 1 the greater difficulty of the model to represent large floods and 2 the interference of statistical uncertainty arising from observed precipitation and flow data during extreme events the relatively good performance of the median and prediction interval is also reinforced by the scatter plot detail iv and the flow duration curve plot detail v both in fig 8a the median and limits of the prediction moved relatively adherent to the observed data with pearson correlation coefficients above 0 7 the hydrological regime is also well represented with most orders of magnitude encapsulated by the confidence interval of the flow duration curves fig 8b exposes results of the evapotranspiration analysis the series of observed et the simulated median and the i 90 are displayed in detail i in fig 8b the temporal epistemic uncertainty of et can be visualized in a weekly moving average in the detail ii in fig 8b unlike streamflow there was low variability in the epistemic uncertainty of et which remained constant average of 41 for most of the calibration period with exceptions observed mainly in the summer the time of year with the most pronounced droughts the same pattern and performance were obtained in the verification period this reinforces the previous hypothesis that the model manifests more behavioral possibilities of representing dry periods than wet periods the overall signal encapsulation performance of the eleven et scenes was 60 in the calibration period and 33 in the verification period despite the reduced number of observations eleven for quantitative analyses it was found by visual inspection a good performance of the median in terms of adherence to the temporal pattern low et in winter and high et in the summer this is consistent with the energy availability in the system represented by the oudin model oudin et al 2005a finally fig 8c shows an example of the local adjustment of one of the et scenes used in the calibration of one of the 100 selected models to avoid the effects of clouds and hill shading the scenes were compared in a reduced yet representative spatial extent of the calibration watershed shown in detail the map i in fig 8c shows the original map of observed et derived from scene landsat 8 with algorithm sebal of laipelt et al 2020 the map ii in fig 8c presents the resampling of the et observed in the spatial units here a smoothing of the et extremes was observed since the average was taken in each spatial unit the map iii in fig 8c displays the local error i e the difference between the observed map and the simulated map considering that the likelihood measure of et eq 25 directly considered the observed and simulated maps the spatial pattern of et in the simulation has been preserved otherwise if only the global averages of et were used there would be no guarantee of getting right results for the wrong reasons i e of not obtaining simulated unlikely spatial patterns after all there are countless ways to obtain the same average over an spatial extent 3 2 results in the basin of interest 3 2 1 hydrological processes in time the principle of additionality in the basin of interest was followed by simulating two different land cover scenarios 1 the pre development scenario having a homogeneous cover of atlantic forest forests 100 forest and 2 the post development scenario with ground cover being observed in 2013 and obtained by souza et al 2020 showing a mosaic of forests 61 3 pastures 3 8 crops 31 6 urban areas 0 4 ponds 0 1 and roads 2 6 the hydrological processes simulated for both scenarios are shown in fig 9 the simulated water flows accumulated and annualized annual average are shown in fig 9a the annual averages of water stocks in the reservoirs of the hydrological system are presented in fig 9b the time series and flow duration curves of the median and the 90 confidence interval for streamflow baseflow and evapotranspiration are shown in fig 9c d and e respectively considering that post development scenario presents 38 7 less native forests atlantic forest the results agreed with what was expected from the impact of forests on the hydrology of watersheds less runoff more infiltration and more evapotranspiration compared to paired basins without forests filoso et al 2017 andréassian 2004 it should be noted however that the large overlap of the 90 prediction interval obtained between both scenarios prevents us from categorical statements about the difference between the simulated hydrological processes the average discrepancy of the simulated hydrological behavior of the pre development scenario was marked by higher annual water losses by evapotranspiration especially by direct evaporation from the canopy e v c in fig 9a and lower annual production of infiltration excess runoff hortonian r i e in fig 9a the annual production of saturation excess runoff did not show major average discrepancies between the scenarios r s e in fig 9a which reinforces the aforementioned need to use models that make the proper separation between runoff mechanisms unlike runoff it was found that in annual terms infiltration recharge and baseflow i n f q v and q b in fig 9a respectively were all relatively higher in the scenario with more forests this was enough to obtain for different reasons a similar average annual flow q in both scenarios approximately 760 mm per year with an annual flow coefficient of 38 the simulation of the greater presence of forests also resulted in a greater average annual storage of water in the system s stocks in the canopy on the surface and in the vadose zone c p y s f s and u n z in fig 9b respectively in other words despite evaporative losses the simulation of scenarios suggests that forest cover has the potential to reduce infiltration excess runoff hortonian runoff and to increase groundwater recharge the time series analysis gave insights for the hydrological regime in both land cover scenarios for example the left limit of the flow duration curve detail ii in fig 9c indicated that there are no major differences between land cover scenarios at very high flows suggesting that the maximum canopy and surface storage capacity is largely exceeded during extreme precipitation events however it was confirmed that the scenario with more forests pre development exhibited moderately higher flows the origin of this flow was baseflow which is higher in this scenario most of the time as illustrated in the time series detail i and in the flow duration curve detail ii in fig 9d nonetheless this was not enough to guarantee more water in critical periods of drought baseflow tends to be the same in these periods when the basin is extremely dry as in january 2012 in fact as shown in the right limit of the flow duration curve detail ii in fig 9c the system s simulation showed higher drought flow in the scenario with fewer forests post development the reason for this could not be explained by baseflow which is the same in both scenarios in these critical situations but the infiltration excess runoff hortonian produced in greater quantity in the post development scenario in summary with fewer forests the minimal precipitation available in critical dry periods was largely converted into runoff while in the scenario with more forests this water was depleted by interception evaporation and transpiration from plants the results shown in fig 9 support this conception since evapotranspiration is always higher in the scenario with more forests pre development 3 2 2 hydrological processes in space the spatial anomaly and the spatial epistemic uncertainty were estimated from simulated hydrological processes maps aggregated annualy in this sense the mean and 90 prediction interval of runoff recharge evapotranspiration annual soil loss annual nitrogen export and annual phosphorus export were extracted both statistics were computed cell by cell from the set of 100 selected models resulting in synthetic maps of the spatial hydrological pattern for each land cover scenario pre development and post development although this procedure was applied to all datasets see fig 6 only results for the reference dataset ds0 are presented here fig 10a illustrates some interesting results of the spatial assessment for the post development scenario in a selected extension of the arroio castelhano basin the totality of results for both coverage scenarios is displayed in appendix b 1 and in appendix b 2 the spatial extent of the analysis was defined as an inspection window selected as adequate in terms of scale and for its landscape diversity this region presents the transition from the mountainous areas to the alluvial plain where different types of soils occur sartori et al 2005 residual basalt soils predominate in the higher parts alluvium occurs in valleys and plains and residual sandstone soils outcrop in the undulating terrain at the base of the mountain escarpment detail i another feature of this extension is the richness of the mosaic of land cover classes under post development scenario including the urbanized area of venâncio aires detail ii the simulated annual recharge map detail iii in fig 10a suggests a hierarchy of importance for this process topography first well drained hillslopes with low soil water deficit then the soil type effective hydraulic conductivity and finally the land cover class effective surface storage capacity it demonstrates that there was no recharge in the valleys and floodplains these zones are riparian wetlands where in fact groundwater was near the surface most of the time soil types and land cover classes were indifferent for recharge in these zones as there was a high saturation of soil pores as a function of the topography and global saturation of the basin on the other hand soil types and land cover classes were determinant for recharge over well drained hillslopes the region dominated by residual sandstone soils despite the predominance of crops stood out for the highest average annual recharge flow which is in line with the a priori definition of the scale factor of effective hydraulic conductivity for this soil ten times greater than basaltic soil see fig 14 in appendix a in this region the small fragments of existing forest exhibited the highest simulated average values of annual recharge around 800 mm and the lowest values were found in the urban area followed by crops and pastures the same pattern between land cover classes but at a lower average level occurred in the region dominated by residual basalt soils the highest simulated annual recharge flows occurred in forests this indicates the positive impact on recharge of effective surface water storage capacity which is greater in forests due to litter and organic horizon the contrast between the maps of saturation excess runoff detail v from fig 10a and infiltration excess runoff hortonian runoff detail iv in fig 10a demonstrated that these simulated processes manifest in completely different environments in the landscape and for different reasons the simulation of saturation excess runoff exhibited an annual spatial pattern that reflected the propensity of soil saturation with the highest flows obtained in the riparian wetlands of the alluvial plain values above 1300 mm and gradually lower flows in the valleys and thalwegs of the terrain tending to zero in well drained terrain environments hence this hydrological process manifested itself mainly as a function of the topography and global saturation of the system with soil types and land cover classes being secondary factors on the other hand the simulation of infiltration excess runoff hortonian runoff exhibited an annual spatial pattern that mainly reflected the effective surface storage capacity of the land cover classes being lower in forests and higher in crops pastures and urban areas soil types also showed some influence since in the region of residual sandstone soils the runoff flows were relatively smaller than in the regions of residual basalt soils this fact agrees with the recharge simulation map indicating that the higher infiltration flow in the sandstone regions ensured a greater surface storage capacity between the surface remained dry for longer periods of time the resulting map of annual soil loss detail vii in fig 10a preserved a spatial pattern adhering to land cover classes the difference in magnitude between the coverage classes however varied under topographical influence in the case of the post development scenario crops and pastures showed higher annual soil loss values than forests this means that the factor c of usle m detail ii in fig 14 exhibited a greater influence on the simulation result in relation to the types of soils erodibility k detail i in fig 16c and the runoff coefficient itself rural unpaved roads stood out by presenting extremely high simulated values of annual soil loss around 100 tons per cell the lowest annual soil loss occurred in the riparian wetlands where the low topographic factor of the alluvial plain factors l and s details ii and iii in fig 16c respectively prevailed both over land cover crops and pastures and over the runoff coefficient which was high in these wetlands due to saturation excess runoff see detail iv in fig 10a the highest mean annual simulated evapotranspiration et detail ix in fig 10a occurred in forests and riparian wetlands by different mechanisms et in the riparian wetlands showed a strong component of deep transpiration t p s from the saturated zone the mean annual deep transpiration map detail vii in fig 10a showed a simulated spatial pattern similar to that obtained for saturation excess runoff which suggests a strong effect of topography on this process for example forests in the higher valleys and thalwegs showed even less deep transpiration than crops and pastures in riparian areas the land cover exerted some influence on the simulation of this process only in intermediate regions of the landscape where the small fragments of forest scattered in the matrix of crops stood out for being a focus of deep transpiration the large et in forests exhibited a greater component of evaporation mainly from the water stored in the canopy in fact in forests in mountainous and well drained areas of the landscape the simulation of canopy evaporation practically corresponded to the entire et with the other evaporative fluxes being minimal see fig 17c the simulation of evaporation from the surface although relatively smaller predominated in well drained and deforested areas in this case and in the case of transpiration in the vadose zone the simulated influence of soil types was manifested since residual sandstone soils by guaranteeing a greater infiltration flow presented a lower mean annual evaporative flow than in residual basalt soils results for spatial anomaly of all simulated hydrological processes are presented in appendix b 1 fig 10b illustrates anomaly in the case of runoff the anomaly detail iii is the difference between the post development scenario detail ii and the pre development scenario detail i at a first glance it was found that the simulated runoff anomaly was positive where the land cover class changed from one scenario to another that is where forests were replaced by crops pastures pounds roads and cities the highest anomaly values above 500 mm were found in the urban area and rural unpaved roads this naturally suggests that the reduction in canopy and surface storage capacity was the cause of the higher mean annual runoff in the post development scenario by closer inspection however it was also found that the simulated runoff anomaly was negative in certain areas where land cover had not changed this happened because the structure of the plans model and the topmodel implies a dynamic interaction between the global state of saturation and the local states of saturation of the watershed in this sense the entire hydrological landscape is connected by the local deficit mapping function eq 15 allowing downstream processes to produce upstream effects as can be seen from the analysis of the other hydrological processes see appendix b 1 the component responsible for the negative anomaly of the runoff was the saturation excess runoff detail iii in fig 15 as the basin remained relatively drier in the post development scenario detail iv in fig 18 the retraction of the extent of the saturated areas resulted in less simulated saturation excess runoff in the higher parts of terrain thalwegs a topographic phenomenon and regardless of land cover class in fact these landscape zones exhibited a positive anomaly in the infiltration and recharge simulation details iv and v in fig 18 respectively contrastingly the basin remained relatively drier in the post development scenario precisely because simulated recharge anomaly was negative in most of the territory this was manifested not exclusively by the lower water infiltration into the soil but also by the higher water capture by transpiration from the vadose zone canopy evaporation and deep transpiration previously sufficient were unable to meet the potential demand for evapotranspiration resulting in a positive anomaly of vadose zone transpiration fig 17 results for spatial epistemic uncertainty of all simulated hydrological processes are presented in appendix b 2 fig 19 fig 20 and fig 21 as we used the prediction interval of 90 as the dispersion measure values above 100 were verified in most hydrological processes except for evapotranspiration fig 10c illustrates the procedure used to obtain the spatial epistemic uncertainty for the case of runoff in the post development scenario uncertainty detail iii is the ratio between the 90 prediction interval detail ii and the mean detail i an auxiliary graph displays the sampling of four points on the map point s1 in the alluvial plain point s2 in the hillside forest point s3 in the urban area and point s4 on a terrain thalweg a relatively lower epistemic uncertainty was found in riparian wetlands of the alluvial plain despite that there was a high uncertainty in the transition zone from the wetlands to the well drained part of the land which reflects the wider amplitude obtained in the posterior confidence interval of the parameters m λ and q o see fig 7 the different behavioral models resulted in divergences in the extent of the saturated areas on the upstream side which is the side that expands or retracts depending on the saturation of the basin a greater epistemic uncertainty was also observed in infiltration and recharge over the region with residual sandstone soils this suggests a synergy between the wide range of the surface parameters c p m a x and s f m a x and the k s a t parameter see fig 7 since the scale factor defined for this type of soil was relatively higher fig 14 however the relatively wide posterior confidence intervals of the parameters c p m a x and s f m a x showed no greater influence on the spatial epistemic uncertainty of the evapotranspiration simulation fig 20 we interpreted that the reason for this lies in the relatively narrow posterior confidence interval of the parameter c which resulted in a potential evapotranspiration always below the canopy and surface storage thresholds along these lines the results suggest that spatial epistemic uncertainty is more sensitive to flow parameters than to storage parameters 3 3 priority for action allocation 3 3 1 priority index of rural properties the order of priority for actions was defined by eq 3 a composite priority index that considers both the anomaly and the uncertainty of hydrological processes to determine the index the zonal mean for anomaly and uncertainty were extracted by geoprocessing techniques from each of the rural properties in the watershed detail i in fig 11a i e these spatial variables were sampled aggregated in the extension of the polygon of each property as illustrated by the detail ii in fig 11a from this the anomaly index i a and the uncertainty index i u were obtained from the analysis of the histogram of each aggregated spatial variable detail iii in fig 11 the anomaly index was defined in six percentile classes with class i a 6 being the 5 properties with the highest anomaly the inverse was defined for the uncertainty index with the class i u 6 being the 5 properties with the lowest uncertainty the other i a and i u classes follow the 20 intervals of the histogram of the respective variable fig 11b presents the results for the anomaly index for the hydrological processes considered of interest runoff et recharge annual soil loss annual nitrogen export and annual phosphorus export these processes were selected in order to represent the main flows in terms of water availability and water quality fig 11c displays the results for runoff uncertainty index et and recharge the uncertainty of the annual loss of soil and nutrients was considered by the uncertainty of the runoff as they were calculated from the histograms the maps of the anomaly and uncertainty indices fig 11b and c presented the spatial pattern more clearly on these variables for example the high classes of the anomaly index i a of et and recharge predominated in the downstream plain regions which reflects the pattern of agricultural development in this area the region of residual sandstone soils stood out with the highest anomaly index i a 6 mainly in relation to runoff as for the annual loss of soil and nutrients nitrogen and phosphorus the highest anomaly index i a 6 was manifested in the cliffs of the mountain range in the intermediate portion of the watershed which suggests a greater influence of topography 3 3 2 impact of uncertainty estimation the priority index i p eq 3 of each rural property was used to obtain the ordered list of priority properties the limit of the list was defined based on the information on the area of each rural property and the budget constraint which was considered by an annual budget of us 39 062 00 and pes of us 39 00 ha equivalent in a maximum area of 1000 hectares for the expansion of nbs in the watershed thus the list was built by selecting the first 236 priority rural properties totalizing 997 hectares the map of priority rural properties and their respective ordering is displayed in fig 12b fig 12a map displays an alternative analysis which was conducted considering only the anomaly index i a in determining the priority index that is the eq 3 was not weighted by the i u uncertainty index the inclusion of spatial epistemic uncertainty resulted in 43 18 of the properties being replaced in the priority list with the spatial arrangement remaining similar the inclusion of spatial epistemic uncertainty also reconfigured the order of priority of the properties that were not replaced 97 of the properties changed their order with approximately 20 of the changes being a jump or a fall greater than 100 positions on the list out of 236 fig 12c displays the map of the ordering change and fig 12d displays the analysis of the change 3 3 3 value of hydrological information the results presented so far correspond to the reference dataset ds0 i e all available hydrological information the next results are analogous but for the alternative degraded datasets dsa and dsb described in section 2 4 2 here fig 13a and b present the likelihood space of the obtained behavioral models and the evolution of the search algorithm for the different datasets are shown respectively the signatures of selected models of different datasets are displayed in fig 13c the action allocation policies considering the epistemic uncertainty resulting from the application of the approach to the different datasets are shown in fig 13d finally fig 13e demonstrates the analysis of the value of hydrological information by the avoided cost of the reference dataset in relation to the alternative degraded datasets although the spatial pattern of alternative policies was relatively preserved the results showed that in practice different datasets of hydrological information led to different allocation policies that is different lists of priority properties emerged from different hydrological information furthermore the results made it possible to quantify the difference between the reference policy and alternative policies for example the alternative policy dsa failed to list 82 priority reference properties and listed 33 extra properties which were not priority according to the reference policy therefore the additional cost of the extra properties in the alternative policy dsa resulted in an avoided cost in the reference policy of approximately us 10 248 00 or 26 2 of the budget constraint us 39 062 00 the alternative policy dsb showed a different result 63 missing properties and 29 extra ones with an avoided cost in the reference policy of approximately us 7 883 00 or 20 of the budget constraint us 39 062 00 table 3 summarizes the results for the different allocation policies interestingly the alternative policy dsb exhibited an avoided cost lower than the alternative policy dsa this was contrary to our initial expectations given that this policy was obtained from a more degraded dataset in contrast to dataset dsa which was degraded only by the absence of certain rain gauges the dataset dsb presents half of streamflow time series with the aggravating factor of not including the severe drought seen in the year of 2012 this discrepancy in the temporal dimension is clearly manifested in the region of the likelihood space fig 13a the behavioral models are shifted in order to favor the likelihood of et l m e t to the detriment of the streamflow likelihood l m q another difference in the dsb dataset was evident in the evolution of the search for behavioral models fig 13a showing a late and atypical progress although sufficient in the final generations to obtain models with average likelihood l y m y higher than the other datasets this result again corroborates the problem of equifinality in hydrological modeling evoked by beven 2006 showing direct impacts on the planning and management of watersheds in this case the temporal degradation of the scarce information available did not prevented the search for behavioral models from being successful including finding models that on average are even better according to the chosen likelihood measure 4 discussion the main contribution of our research is that we provided a comprehensive modeling approach to tackle the problem of planning the expansion of nature based solutions nbs in a watershed payments for ecosystem services pes program under epistemic uncertainty this is a novel relevant input to the field of modeling hydrological ecosystem services because we addressed in a single framework the following basic requirements 1 to follow the principle of additionality 2 to represent multiple runoff mechanisms 3 to obtain farm scale spatial outputs and 4 to estimate output epistemic uncertainty for our case study arroio castelhano watershed brazil we made clear that the estimation of spatial epistemic uncertainty in the mapping of priority restoration areas is a critical information for efficient resource allocation at the operational level farm scale as far as we could check advanced studies in this research field failed to fulfill the four basic requirements mentioned above mainly because they make use of aggregated or gis based models such as swat and invest evenson et al 2021 saad et al 2018 hamel and guswa 2015 huisman et al 2009 moreover as suggested by evenson et al 2021 the use of the glue method for epistemic uncertainty estimation makes our approach the first study in this research field to explicitly address the equifinality of conceptual hydrological models beven 2006 we also deliver three secondary important contributions to the general field of hydrological modeling 1 the modification of topmodel in what we called the plans model 2 the proposition of the novel hand enhanced twi saturation index and 3 the assessment of the economic value of hydrological information under an uncertainty framework strengths and limitations of these research findings are discussed in the next paragraphs the introduced plans model presents itself as a promising operational tool for planning spatial and temporal allocation of restoration actions as proposed in possantti and marques 2022 most of the literature in this subject as reviewed in francesconi et al 2016 uses swat to model hydrological ecosystem services a model that since its proposition in arnold et al 1993 simulates runoff by applying the curve number method of mockus 1949 despite its empirical basis the curve number method is tied to the paradigm of infiltration excess runoff hortonian in addition of not being designed for continuous simulation we think that the widespread operational use of such model is not justified before being tools hydrological models are hypotheses beven 2019 and the hypothesis underlying fast runoff mechanisms has been updated many times since dunne and black 1970 the application of the plans model in our case study clearly demonstrated the operational superiority of simulating both infiltration excess and saturation excess runoff topographic effects in certain parts of the landscape can overcome secondary factors such as land cover and soil type furthermore the plans model allows for calibration and verification against both observed time series e g streamflow and detailed gridded data e g et scenes so output uncertainty can be constrained in a greater extent as is proposed in zink et al 2018 and oliveira et al 2021 and shown by our results the design of the plans model was inspired in topmodel beven and kirkby 1979 but with adjustments in surface storage streamflow routing and representation of spatial heterogeneity it resulted in a novel structure with 13 parameters 7 more than found in topmodel beven et al 2020 what inevitably added more uncertainty in the modeling process however such changes are justified in both a theoretical sense and a practical sense the original surface water storage as pointed by gao et al 2015 was too simplified for the assessment of the influence of mosaics on different land cover classes including forests to address this problem they introduced a fully distributed version of topmodel sacrificing the original low computational demand in our approach the concept of spatial matrix preserved a low processing demand at the cost of two new parameters c p m a x and s f m a x and more model uncertainty our concern with practical processing speed was also manifested in the routing method which differs from the original in that it is completely concentrated the unit hydrograph method of nash 1958 at the cost of two new parameters k and n chen and wu 2012 also claim to bring an alternative to represent spatial heterogeneity but they actually incorporate to swat some features of topmodel while we incorporate to topmodel some features of swat and other models based on hydrological response units the proposed hand enhanced topographical wetness index htwi was an innovative attempt to incorporate the hand terrain descriptor directly into a hydrological simulation model advanced studies have so far used hand as an index of similarity for classification of landscape units soils and vegetation e g cuartas et al 2012 or for mapping and modeling floods e g nobre et al 2016 it is true that gao et al 2019 also offer an alternative to use hand directly in hydrological simulation with the hand based storage curve method even so the htwi is an interesting approach as it delivers the flexibility to model different landscapes on the one hand the twi of topmodel emerges from the approximation of the hydraulic gradient to the terrain gradient beven et al 2020 which implies the assumption of shallow soils on the other hand htwi allows the representation of two different saturation environments a dual landscape downstream wide riparian wetlands contrasting with upstream constrained wetlands the composition of twi with hand under different combinations of dominance w threshold h m a x and global values λ opens opportunities for further comparative modeling studies in different geomorphological and climatic regions our results also reinforce the hypothesis that action allocation policies are very sensitive to the hydrological information available for modeling in our case study the data increment introduced an avoided cost in the allocation policy of up to 27 of the estimated budget for the watershed pes program however it was shown that the value of this information is not proportional to the amount of data a more similar allocation policy can emerge from a more degraded dataset we interpret this paradox under the equifinality thesis of beven 2006 since the behavioral models obtained from the different datasets are equivalent in terms of likelihood but occupy distinct regions of the parametric space planners in our case study would benefit substantially from a richer dataset than currently available mainly in the temporal dimension in order to condition the calibration of the hydrological model and reduce the equifinality problem the proposed modeling approach has several limitations that must be addressed in future works it is recommended the use of multiple likelihood measures for aggregated streamflow in different time scales such as weekly monthly and annual e g kge of annual minimums annual pbias etc another possible improvement consists of adapting the demand of potential evapotranspiration at the global level in the basin as forests in well drained areas presented a minimum simulated transpiration flow which is not consistent with our perception of such hydrological process advances in empirical modeling such as in kisi et al 2022 suggests novel alternatives for modeling potential evapotranspiration other than the oudin model oudin et al 2005a the use of the nash unit hydrograph for streamflow routing can be revised or conditioned by the topology of the drainage network in order to improve transferability from calibration basins to interest basins also from the view of empirical science it is insufficient to represent the saturation excess runoff without modeling the connectivity of hillslopes with the drainage network a phenomenon also responsible for the rapid subsurface runoff mcdonnell 2013 blume and van meerveld 2015 in fact mcdonnell 2003 s comments remain relevant even 20 years later the plans model does not shift beyond paradigm of variable contribution area as with other research models such as those proposed by stieglitz et al 2003 and smith et al 2013 future changes in the general structure should address the activation thresholds of surface and subsurface responses furthermore isotope research reported by renée brooks et al 2010 and evaristo et al 2015 reinforce the need for representation of the different eco hydrological compartments of the soil generally the approach could be improved by integration with other management and planning tools related to the sustainable development goals of the un 2030 agenda united nations assembly 2015 rasul and sharma 2016 argue that sustainability policies should be oriented towards the nexus between water energy and food production in this sense synergies and trade offs with goals other than water security and related ecosystem services must be assessed e g timko et al 2018 turkelboom et al 2018 li et al 2020 to this end additional indicators could be aggregated at the scale of rural properties leading planners to forms of multi criteria decision making e g sarkar et al 2022 spatial optimization models could be coupled to minimize soil loss as shown in domingues et al 2020 trade offs involving food security and biodiversity conservation could be evaluated by multi objective optimization algorithms e g recanati and guariso 2018 verhagen et al 2018 integration with ecological models might help to assess the trade off and synergies between carbon sequestration of forest restoration and annual water yield as suggested by ovando et al 2019 and khorchani et al 2022 in the context of brazil many watershed pes programs emerged in the last two decades in the country promoted by water utilities governments non governmental organizations watershed committees and by the national water agency taffarello et al 2017 although implementing such programs is a complex task viani et al 2019 the growing need for water security for urban centers flörke et al 2018 and the advent of the national program for watershed revitalization could further intensify this trend 5 conclusion this study provided a novel modeling approach to help planning the expansion of nature based solutions nbs for water security and other sustainable development goals of the un 2030 agenda the proposed modeling method is suitable for mapping restoration priority areas in the context of watershed payments for ecosystem services pes programs because it meets the following basic requirements 1 to follow the principle of additionality 2 to represent multiple runoff mechanisms 3 to obtain farm scale spatial outputs and 4 to estimate output epistemic uncertainty advanced studies in the field of ecosystem services modeling have failed so far in fulfilling such requirements in one single framework due to several factors like absence of baseline scenario when additionality is not evaluated intrinsic model structure when process and scale representation is not adequate for the problem and simplistic uncertainty estimation when model equifinality is not considered based on the results of our case study a payments for ecosystem services program in the arroio castelhano watershed brazil it was shown that the estimation of spatial epistemic uncertainty in the mapping of priority areas consists of critical information for efficient resource allocation since 97 of rural properties changed their ranking approximately 20 being a change greater than 100 positions in the priority list our results also clearly demonstrate the advantage of simulating both infiltration excess and saturation excess runoff topographic effects in certain parts of the landscape can overcome secondary factors such as land cover and soil type the distinction between runoff mechanisms allowed the mapping of ecosystem services restoration efforts where it really makes a difference that is to follow the principle of additionality this feature is not possible in other conventional and widely used models such as swat and invest the sensitivity of the approach was also evaluated in the light of more or less hydrological information available which made it possible to estimate the economic value of this information for the watershed pes program the simulation of data increment introduced an avoided cost in the allocation policy of up to 27 of the estimated budget future advances might follow two separate lines of research 1 to improve the modeling features in order to address existing limitations and 2 to integrate or couple the approach to others modeling strategies in order to expand possible applications improvement efforts in the plans hydrological model might envision to constrain uncertainty by using more likelihood measures to explore the proposed saturation index the hand enhanced twi in new different landscapes and to represent the activation thresholds of surface and subsurface responses by changing the model structure integration and coupling strategies might include multi criteria methods and multi objective optimization to assess synergies and trade offs with other ecosystem services and sustainable development goals such as food security biodiversity conservation and climate change mitigation list of abbreviations ds0 reference dataset all data available dsa alternative dataset a degraded dsb alternative dataset b degraded et evapotranspiration glue method generalized likelihood uncertainty estimation hand height above the nearest drainage htwi hand enhanced topographic wetness index invest model integrated valuation of ecosystem services and tradeoffs kge kling gupta efficiency nbs nature based solutions pes payments for ecosystem services plans model planning nature based solutions sebal model surface energy balance algorithms for land swat model soil and water assessment tool topmodel model hydrological model based in the twi twi topographic wetness index credit authorship contribution statement iporã possantti conceptualization methodology software writing original draft rafael barbedo methodology software writing review editing marcelo kronbauer validation writing review editing project administration walter collischonn validation supervision writing review editing guilherme marques conceptualization resources supervision writing review editing funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the authors are grateful for the financial support provided by the brazilian national council for scientific and technological development cnpq brazil grant 380978 2020 2 and national water agency brazil grants apq 404242 2019 7 and 308549 2019 8 appendix a case study additional details additional details of the case study are presented here the arroio castelhano watershed and the rio pardinho watershed appendix a 1 shows the list of datasets used appendix a 2 presents additional maps of the arroio castelhano basin basin of interest a 1 list of input datasets the table 4 presents the complete list of datasets used for the case study all datasets used were obtained from public or freely distributed data sources a 2 additional maps the fig 14 presents an additional detail of the arroio castelhano watershed including the illustration of the pre development scenario a condition in which homogeneous coverage by the atlantic forest is considered potential native vegetation parameter maps and scale factors are also displayed appendix b results additional details here additional details of the results obtained from the application of the approach in the case study are presented appendix b 1 displays the spatial anomaly maps for all processes in the arroio castelhano watershed in the inspection window appendix b 1 displays the maps of spatial epistemic uncertainty for all processes in the arroio castelhano watershed in the inspection window b 1 spatial anomaly all processes here the anomaly maps associated with the annualized hydrological processes in the pre development and post development land cover scenarios are presented in fig 15 fig 16 fig 17 and fig 18 the process maps are the result of the cell to cell average of the 100 selected models the spatial inspection window in the basin of interest arroio castelhano was defined aiming at a better visualization and interpretation of the details produced the pre development land cover scenario was defined by the homogeneous coverage of potential native vegetation which in this case is the atlantic forest the post development scenario was defined by the observed land cover for the reference year of 2013 the anomaly was defined by the difference between the scenarios eq 1 a positive anomaly for runoff for example means that more runoff occurs in the current scenario post development b 2 spatial epistemic uncertainty all processes here the epistemic uncertainty maps associated with the annualized hydrological processes in the pre development and post development land cover scenarios are presented in fig 19 fig 20 and fig 21 the spatial inspection window in the basin of interest arroio castelhano was defined aiming at a better visualization and interpretation of the details produced for each scenario the epistemic uncertainty was defined as the ratio between the 90 prediction interval and the process mean computed cell by cell from the 100 selected models eq 2 the inter scenario uncertainty was defined by the average between the scenarios the epistemic uncertainty maps show where the selected models diverge more or less from the mean value of the hydrological process 
2419,hydrological models are useful to support ecosystem services restoration however when planning the expansion of nature based solutions and payments for ecosystem services there are requirements including the principle of additionality representation of multiple runoff mechanisms and calculation of farm scale spatial outputs and epistemic uncertainty while addressing these aspects is important to make future planning more effective investment costs and water benefits it is also challenging this paper integrates in a single modeling framework the main requirements highlighted this allows an improved selection of top priority areas with farm scale spatial resolution and a deeper understanding of how epistemic modeling uncertainty affects the results which is relevant to evaluate the risks of overestimating ecosystem services benefits the modeling approach is demonstrated in a case study watershed in the atlantic forest biome brazil the plans model is introduced which uses the design of topmodel to simulate both simulates both saturation excess and infiltration excess runoff at the farm scale resolution also it uses a novel saturation index based in a composition of height above the nearest drainage and topographical wetness index terrain descriptors we applied the generalized likelihood uncertainty estimation method aided by an evolutionary algorithm to estimate output epistemic uncertainty results show that uncertainty substantially affects priority definition 97 ranking change and that simulated topographic effects can overcome local effects of land cover and soil type with better data uncertainty evaluation indicates that the restoration program in the study case could have the cost of its allocation policy reduced by up to 27 showing that it can be made more cost effective with the methods proposed graphical abstract keywords spatial epistemic uncertainty ecosystem services nature based solutions watershed restoration priority areas data availability data will be made available on request 1 introduction the spatial allocation of restoration actions in watersheds is an unsettling challenge in the search for water security and other sustainable development goals of the united nations 2030 agenda un water 2018 cassin and matthews 2021 there is a justified urge for upscale nature based solutions nbs in watersheds changes in land use and land cover induced by an array of nbs allegedly improves the ecosystem services of water provision water quality regulation soil protection extreme events mitigation in addition of co benefits for biodiversity sanitation and food security sahani et al 2019 kalantari et al 2018 keesstra et al 2018 as a response payments for ecosystem services pes programs are emerging as an attractive strategy for expanding nbs in watersheds accounting for an investment of up to us 24 7 billion annually totalizing 387 programs in 62 countries salzman et al 2018 in this context planning an efficient resource allocation in space rely strongly on mapping priority areas for ecosystem services restoration with the help of environmental models maes et al 2012 yet this is not an ordinary task especially when such services are linked to upstream hydrological processes in fact a modeling approach for effectively support decision making in the case of nbs expansion must meet four basic requirements 1 to follow the principle of additionality 2 to represent multiple runoff mechanisms 3 to obtain farm scale spatial outputs and 4 to estimate output epistemic uncertainty these requirements are explained and justified below first requirement to follow the principle of additionality the expansion of nbs as an investment in natural capital must deliver additional ecosystem services wunder 2007 tacconi 2012 such expansion in watershed pes programs is generally motivated by the expectation of a valuable change in terms of return of investment or avoided cost from the perspective of downstream water users kroeger et al 2019 this means that planning assessments must compare model outputs between scenarios with and without planned actions e g carvalho santos et al 2014 ullrich and volk 2009 martinez martinez et al 2014 daneshi et al 2021 in the approach of ecosystem service restoration foley et al 2005 this principle translates into assessing the difference or anomaly between simulated hydrological processes under baseline pre development and current post development land use scenarios as presented in lima et al 2017 therefore planners need to apply conceptual models in order to make deductive inferences about several processes of the hydrological system such as runoff infiltration recharge and evapotranspiration simplified lumped and data driven models e g ditthakit et al 2021 singh et al 2022 although useful for streamflow prediction are not applicable for the case of planning the expansion of nbs in watersheds second requirement to represent multiple runoff mechanisms empirical evidence in rural watersheds demonstrates that runoff is indeed controlled by multiple processes saffarpour et al 2016 hence models used for mapping priority areas must discern infiltration excess runoff hortonian runoff horton 1933 which is influenced locally by land cover from saturation excess runoff dunnean runoff dunne and black 1970 which is influenced globally by the topography and saturation of the basin lyon et al 2006 this fact has been largely ignored by the literature of ecosystem services modeling on the contrary as points francesconi et al 2016 there is a growing trend in the use of the swat model in which runoff is based only in an infiltration excess mechanism arnold et al 1993 third requirement to obtain farm scale spatial outputs this is obvious since any watershed pes program is by definition a farm scale land use policy hence models must help planning at operational level that is ranking the priority of all rural properties in a given area of interest e g bremer et al 2021 quaglia et al 2019 reaney et al 2019 lima et al 2014 ghebremichael et al 2013 most of the literature on modeling ecosystem services however delivers methods for planning at the strategic level e g rabiei et al 2022 cong et al 2020 liu et al 2016 due to intrinsic model structure outputs are generally aggregated in sub basins which is not helpful for deciding detailed farm scale resource allocation fourth requirement to estimate output epistemic uncertainty epistemic uncertainty arises from the lack of knowledge about 1 how to represent the environmental system and 2 forcing data used for calibration or scenario evaluation beven 2016 communication of model uncertainty although challenging blöschl et al 2019 is crucial for well informed decision making in the context of ecosystem services modeling e g chen et al 2022 xiaojun et al 2021 tsvetkova and randhir 2019 vigiak et al 2015 woznicki and nejadhashemi 2014 strauch et al 2013 moreover uncertainty estimation is a best practice found in several other environmental applications such as mineral prospecting mcmanus et al 2021 land use planning lechner et al 2014 xing et al 2020 baker et al 2021 reservoir operation xu et al 2021 vanda et al 2022 groundwater management seifi et al 2020 atmospheric pollution management ribeiro et al 2016 gholami et al 2020 and planning for climate change seaby et al 2015 since conceptual hydrological models are inevitably subject to the equifinality problem beven 2006 conventional modeling approaches e g ostad ali askari 2022a ostad ali askari 2022b may be incomplete for decision makers because the information of precipitation and streamflow alone is not sufficient to justify a specific set of parameters there will always be the possibility of obtaining right results for the wrong reasons advanced studies in epistemic uncertainty estimation for mapping and ranking priority areas generally propose the use of ensembles of model spatial outputs e g evenson et al 2021 cameira et al 2019 saad et al 2018 hamel and guswa 2015 huisman et al 2009 robertson et al 2009 however according to evenson et al 2021 further research may apply a variety of methods to assess uncertainty such as monte carlo latin hypercube or bootstrapping sampling and more formalized uncertainty procedures such as generalized likelihood uncertainty estimation glue the objective of this paper is to provide a comprehensive modeling approach to tackle the problem of planning the expansion of nbs in watershed pes programs under epistemic uncertainty the novelty of our research is that we deliver a unique framework that captures all four basic requirements described earlier to address the problem as shown in table 1 there is a clear gap to be fulfilled in the literature covering such requirements the approach applies a novel model called plans initially proposed in possantti and marques 2022 for a case study located in southern brazil the arroio castelhano watershed the basin is within the atlantic forest biome a hopespot for ecosystem services restoration in the most populous region of brazil rezende et al 2018 the model is a modified version of topmodel beven and kirkby 1979 beven et al 2020 a model that maps hydrological processes at the appropriate spatial resolution farm scale and simulates both infiltration excess runoff and saturation excess runoff next we use the generalized likelihood uncertainty estimation glue method beven and binley 1992 2014 to estimate the epistemic uncertainty a guided search is used with the help of an evolutionary algorithm to select 100 behavioral models according to a likelihood measure which considers both observed streamflow time series and evapotranspiration map scenes for each hydrological process runoff infiltration etc the principle of additionality was followed by evaluating the anomaly the difference between post development current and pre development baseline land cover scenarios spatial epistemic uncertainty in turn was defined by the ratio between the distributed 90 prediction interval and the distributed mean finally we evaluated the potential impact on decision making in the face of more or less precipitation and streamflow data estimating the economic value of this information for the watershed planners 2 material and methods 2 1 approach overview the first step in our approach is to estimate the distributed statistics of hydrological processes in pre development and post development land cover scenarios for the watershed of interest fig 1a these statistics are obtained by a grid to grid processing of a set of maps of several hydrological processes such as runoff infiltration recharge and evapotranspiration these maps were obtained by simulating the system using a set of hydrological models each model being formed by a different combination of parameters the set of models is selected according to likelihood criteria for the observed behavior of the hydrological system as hydrological information on precipitation and streamflow is not always available in the basin of interest for the likelihood assessment the approach assumes the feasibility of transferring parameters from a calibration basin the approach is essentially independent of the simulation model as long as maps of hydrological processes can be produced at the appropriate spatial scale which is the scale of rural properties to consider the principle of additionality the anomaly of hydrological processes is the guiding variable for decision making the anomaly is defined here as the potential or deficit of hydrological ecosystem services which is used to justify the expansion of nbs thus for each hydrological process the spatial anomaly of the mean is the cell to cell difference of the distributed mean between the land cover scenarios fig 1b 1 δ i μ 1 i μ 0 i i where δ i is the mean anomaly of the hydrological process in the grid cell i μ 1 i is the mean of the hydrological process in the post development scenario in the grid cell i and μ 0 i is the mean of the hydrological process in the pre development scenario in the grid cell i the distributed mean of runoff is used a posteriori to estimate soil annual loss and annual export of nutrients nitrogen and phosphorus from eq 1 the spatial anomaly of such processes is also estimated and used in decision making fig 1d for each hydrological process in each land cover scenario the spatial epistemic uncertainty is defined by the cell to cell ratio between the 90 prediction interval and the mean 2 u i i 90 μ i i where u i is the spatial epistemic uncertainty of the process in the grid cell pixel i μ i is the process mean in the evaluated scenario and i 90 is the 90 prediction interval of the process in the evaluated scenario as there are two land cover scenarios pre development and post development the inter scenario spatial uncertainty for a given hydrological process is the mean of the uncertainty between the scenarios fig 1c finally the result is a limited and ordered list of top priority rural properties in the watershed of interest fig 1e the list is constrained by the available funds for the pes program which is converted into a limitation of the total area of rural properties annual pes are defined per unit of area the order of the list is defined by a composite index of rural property priority that considers both the anomaly and the uncertainty of the hydrological processes of interest 3 i p i p 1 n i u p i i a p i p 1 n i u p i i where i p i is the priority index of a rural property i i a p i is the anomaly index of the process p in rural property i e i u p i is the uncertainty index of the process p in rural property i the eq 3 can be understood in fact as the average of the anomaly index i a of the hydrological processes of interest weighted by the uncertainty index i u of the processes the uncertainty index i u therefore must be high for properties with low epistemic uncertainty and vice versa so that the priority i p is always higher in rural properties with high anomaly and low epistemic uncertainty the anomaly indices i a and uncertainty i u in turn are ordinal variables defined from the classification in quantiles of the histogram of the anomaly δ eq 1 and the uncertainty u eq 2 aggregated over the spatial extent of each rural property it is assumed that different rural properties may appear on the priority list when different hydrological information is available which includes observed series of precipitation streamflow and evapotranspiration in maps these are used to assess the likelihood of model realizations hence there is an opportunity to estimate the economic value of this information for watershed planning and management by comparing datasets with more information e g greater number of data points to datasets with less information fig 1f the dataset available was considered as a reference more information the comparison was performed with alternative degraded datasets in which the information was removed 2 2 the plans model the planning nature based solutions plans model was originally conceived by possantti and marques 2022 as a modeling framework that aims to help planning and management of watersheds here we present a new hydrological model to the framework in order to allow greater focus on decisions involving space employing the semi distributed modeling approach of topmodel beven and kirkby 1979 the potential daily evaporation is estimated by the simplified model proposed by oudin et al 2005b the streamflow routing is considered in a lumped way by using the unit hydrograph of nash 1958 model details are presented below table 2 displays the list of all parameters of the model 2 2 1 soil water balance as in topmodel the soil water balance is performed considering the basin as a system of global and local water stocks and flows beven 2012 globally the system is conceived as a large water stock filled with a porous medium fig 2a locally the system is a regular grid of stacked elementary water stock cells that may or may not exhibit hydrological similarity to each other fig 2b in the simulation the two scales are linked by the way in which the spatial pattern of water table is drawn at each time step and by the fact that the global variables are the average of the local variables fig 2c for example global soil water deficit is defined by 4 d 1 n i n d i i where d mm is the global soil water deficit d i mm is the local soil water deficit in the grid cell i and n is the number of grid cells on the global scale soil stores water in two reservoirs the saturated zone where water can move horizontally and the unsaturated zone vadose zone where water moves in the vertical direction fig 2a the saturated zone gains water by recharge from the unsaturated zone and loses water both by baseflow and by the plant transpiration when applying the principle of mass conservation to the control volume of the saturated zone 5 d d d t q b t p s q v where q b mm δ t 1 is baseflow t p s mm δ t 1 is the global transpiration of plants from the saturated zone and q v mm δ t 1 is the global recharge from the vadose zone to the saturated zone given the initial conditions the eq 5 is numerically solved for finite differences in a sequence of discrete t time steps with δ t duration as well as the next equations of mass conservation the plans model follows the exponential decay hypothesis of soil transmissivity beven and kirkby 1979 in which the baseflow is defined by 6 q b q o e d m where q o mm δ t 1 is the maximum baseflow under complete saturation conditions of the basin and m mm is the exponential decay coefficient the global recharge is computed by the local average of the gridded cells 7 q v 1 n i n q v i i where q v i mm δ t 1 is the local recharge from the vadose zone to the saturated zone this flow is computed locally according to beven and wood 1983 assuming a direct proportion to the local water deficit 8 q v i k s a t i u n z i d i i where k s a t i mm δ t 1 is the effective local hydraulic conductivity u n z i mm is the water stored in the vadose zone locally and d i mm is the local deficit of water in the soil similarly 9 t p s 1 n i n t p s i i where t p s i mm δ t 1 is the local plant transpiration of the saturated zone at the local scale the model is composed of four storages stacked in layers two of them are positioned above ground level the vegetation canopy c p y i mm and the surface storage s f s i mm which represents both shallow depressions and the litter rich soil organic horizon the other two are underground the local vadose zone u n z i mm and the local saturated zone which is modeled as a function of the local deficit d i mm canopy surface and vadose zone are all subjected to mass conservation at the local scale the local deficit on the other hand is updated at each time step by the mapping function to follow the global soil water balance eq 5 for the canopy the conservation of local mass is defined by 10 d c p y i d t p i i r a i e v c i c p y i c p m a x i i where c p y i mm is the local water storage in the canopy p i mm δ t 1 is the local precipitation i r a i mm δ t 1 is the local sprinkler irrigation input and e v c i mm δ t 1 is the local evaporation of water from the canopy local water storage in the canopy is constrained by the local storage capacity c p m a x i mm so that excess water generates throughfall t f i mm δ t 1 the conservation of local mass on the surface is defined by 11 d s f s i d t t f i i r i i i n f i e v s i s f s i s f m a x i i where s f s i mm is the local surface water storage i r i i mm δ t 1 is the local drip or flood irrigation flow i n f i mm δ t 1 is the local infiltration stream and e v s i mm δ t 1 is the local flux of evaporation from the surface local surface water storage s f s i is constrained by the local storage capacity s f m a x i mm so excess water generates runoff r i mm δ t 1 local surface water storage s f s i is drained by infiltration at the rate of local effective hydraulic conductivity k s a t i but this depletion is bottom up controlled by the local water deficit just below the surface d i which implies a zero seepage flux over fully saturated grid cells where d i 0 unless depleted by local surface evaporation e v s i these grid cells will tend to produce saturation excess runoff dunnean mechanism and finally the local mass conservation of the vadose zone 12 d u n z i d t i n f i q v i t p u i i where u n z i mm is the local water storage in the vadose zone i n f i mm δ t 1 is the local infiltration flow q v i mm δ t 1 is the local recharge flow and t p u i mm δ t 1 is the local flow of plant transpiration from the vadose zone the actual local evapotranspiration e t i mm δ t 1 is defined by the sum of all evaporation and transpiration processes which are constrained by total daily potential evapotranspiration p e t t mm δ t 1 in each time step t 13 e t i p e t t e v c i e v s i t p s i t p u i p e t t e v c i e v s i t p s i t p u i e v c i e v s i t p s i t p u i p e t t i in the model there is a reserved order for the local computation of e t i until the demand i e p e t t is satisfied the order is based on the empirical results obtained by souza et al 2019 in studies of irrigated rice crops in accordance with the energy balance based approach of the authors evaporation from the canopy e v c i is defined to occur first followed by plant transpiration from the saturated zone t p s i which is followed by plant transpiration from the vadose zone t p u i and lastly followed by evaporation from the surface e v s i the local root zone depth r z d i mm which is an important constraint for plant transpiration is defined by 14 r z d i e r z i φ i φ i 1 i where e r z i mm is the effective depth of the root zone and φ i dimensionless is the effective local soil porosity 2 2 2 the htwi index of saturation propensity the fundamental concept underlying beven and kirkby 1979 s topmodel approach is that groundwater dynamics at the local scale can be emulated as a function of the local propensity for saturation and the global soil water deficit predicted by the global water mass conservation eq 5 the deviation between the global and local deficit of soil water is directly proportional to the deviation between the global and a local index of saturation propensity so that 15 d i 0 d m λ λ i 0 d m λ λ i d m λ λ i 0 i where d i mm is the local soil water deficit d mm is the global soil water deficit m mm is the exponential decay parameter of the transmissivity λ i dimensionless is an index of local saturation propensity and λ dimensionless is an index of global saturation propensity beven and kirkby 1979 derived an index of saturation propensity λ i called topographic wetness index twi from a formal and physically based treatment of darcy s law in the plans model the mapping function is relaxed in terms of physical formality with the local propensity to saturation λ i being taken as a hydrological similarity index explicitly defined by the modeler as a hypothesis of how soil saturation in the basin evolves with more or less moisture the global index λ is therefore treated as an available threshold for calibration the formula of the twi is 16 t w i i ln a i tan β i i where for grid cell i a i m 2 m 1 is the upstream drainage area per contour unit usually taken by grid cell resolution and β i radians is the local slope of the terrain although the physical conceptual basis of twi is correct i e a given grid cell is more prone to saturation the flatter and further downstream it is in practice we think that this assumption works only in the headwaters of a basin which are usually steeper this is because these areas are less subject to downstream controls which are not considered in twi downstream cells do not influence flow accumulation or local slope these downstream controls on soil moisture conditions are considerable as empirically demonstrated by several studies e g crave and gascuel odoux 1997 hjerdt et al 2004 some indices have already been designed to represent them such as the height above the nearest drainage called hand nobre et al 2011 rennó et al 2008 the usage of hand or similar indices has been shown to have several advantages over the twi in representing soil saturation murphy et al 2009 gharari et al 2011 ågren et al 2014 oltean et al 2016 loritz et al 2019 in the present work we adopted hand as a quantitative indicator for the saturation propensity below a height threshold over the channels network that is in a zone of the landscape that we can refer to as riparian wetlands fig 3a thus we introduce hand enhanced twi htwi which is a weighted superposition of the two indices 17 h t w i i s f t w i i w f h a n d i 1 w 0 f t w i i 1 0 f h a n d i 1 i where for the index cell i h t w i i dimensionless is the local htwi f t w i i dimensionless is the fuzzyfied twi f h a n d i dimensionless is the fuzzyfied hand w dimensionless is the magnitude of the dominance of hand over twi and s dimensionless is a constant defined so that the map values of htwi can be scaled back to the amplitude of twi a similar approach is presented in jafarzadegan and merwade 2019 with probability functions to preserve continuity in transitions the fuzzy twi is defined from a membership function based on an ascending sinusoidal transition towards an upper threshold 18 f t w i i 1 2 cos π t w i i t m a x 1 2 0 t w i i t m a x i where t m a x dimensionless is the upper threshold for twi which can be the maximum value observed in a given basin similarly the fuzzyfied hand is defined from a membership function based on a descending sinusoidal transition towards an upper threshold 19 f h a n d i 1 2 cos π h a n d i h m a x 1 2 0 h a n d i h m a x i where h m a x meters is the upper threshold of hand that defines the riparian wetland zone the map of htwi is therefore defined by two parameters the weight w which configures the dominance of hand over twi everywhere and the threshold h m a x which configures the spatial distribution of riparian wetlands we believe that this allows the modeling of basins with a wide variety of geomorphological conditions from shallow soil basins lesser dominance of hand to deep soil basins greater dominance of hand the details b to e in fig 3 schematically illustrate the method for obtaining htwi 2 2 3 spatial heterogeneity in plans the concept of hydrological similarity is used to represent spatial heterogeneity space is implicitly represented by the histogram of hydrological response units our method includes both conventional hydrological response units represented by soil types and cover classes fig 4a as well as classes of the saturation propensity index named here as saturation propensity units fig 4b the result is a encoded map of spatial units in a two dimensional histogram that is a spatial matrix that is subjected to processing in the model simulation fig 4c the flows stocks and model parameters are therefore stored in a matrix in computational memory which is decoded into explicit maps a posteriori for each hydrologic response unit there are specific parameter values for canopy storage capacity c p m a x u surface storage capacity s f m a x u root zone depth r z d u effective soil hydraulic conductivity k s a t u and effective soil porosity φ u this leads inevitably to the problem of parameter dimensionality typical of models based on hydrologic response units beven 2012 we circumvented this problem by allowing a priori conditioning of the relative magnitude between equivalent parameters based in proxy spatial variables field measurements and other available information the practical result of this strategy is that calibration takes place only on unitary parameters that is of magnitude equal to unity the relative value of each hydrological response unit is then calculated by the respective scale factors 2 2 4 annual loss of soil and nutrients the annual local soil loss in the plans model is estimated by the usle m equation proposed by kinnell and risse 1998 therefore the simulated maps of the annual runoff coefficient are used in a gis based approach of the usle m method maps of precipitation erosivity local soil erodibility and other dimensionless factors of the equation are obtained from the literature the annual local nutrient export is estimated by using the empirical load spatially distributed by simulated local soil loss 20 e i j e j a i j a j where e i j kg ha 1 year 1 is the local empirical export load annual nutrient per unit area in cell i located in area with land cover j e j kg year 1 ha 1 is the annual nutrient export load for the land cover type j a i j is the simulated local annual loss of soil in cell i and a j is the average annual local soil loss for land cover type j empirical loading values e j for nitrogen and phosphorus in different types of land cover can be estimated from the literature or calibrated directly from experimental plots 2 3 estimation of epistemic uncertainty 2 3 1 the glue method the epistemic uncertainty of the plans model was evaluated by the generalized likelihood uncertainty estimation glue method proposed by beven and binley 1992 in this method the epistemic uncertainty of a model as a general hypothesis is estimated by simulating a large set of models combinations of parameters specific hypothesis which are selected from a prior confidence interval as it is a bayesian approach albeit informal the method allows new observations to be incorporated recursively incrementally improving the posterior confidence interval estimation of model parameters and realizations this is possible by the definition of an informal likelihood or generalized taken as a quantitative measure of credence in a model in relation to the available set of observations beven and binley 2014 thus the bayes equation takes the following form 21 l p m y l o m l y m y c where l p m y is the posterior likelihood of a model m given the set of observations y l o m is the previous likelihood assigned to the m model l y m y is the informal likelihood of the model m given the set of observations y and c is a scale constant defined so that the sum of the posterior likelihood of each evaluated model is unity 2 3 2 informal likelihood measure from the point of view of the equifinality paradigm one should make use of the greatest number of observations about the hydrological system for conditioning a model including the spatial pattern of processes e g zink et al 2018 oliveira et al 2021 for this reason the evaluation of the plans model relied on a composite likelihood measure that includes both observed streamflow and evapotranspiration the informal likelihood therefore was defined by a euclidean distance in the objective space 22 l m y 1 1 l m q 2 1 l m e t 2 where l m y is the informal likelihood of the model m given the set of observations y l m q is the informal likelihood of streamflow and l m e t is the informal likelihood of evapotranspiration both likelihoods streamflow and evapotranspiration were determined by the kling gupta efficiency kge proposed in gupta et al 2009 23 kge s y 1 r s y 1 2 σ s σ y 1 2 μ s μ y 1 2 where kge s y is the kling gupta efficiency of the simulation s given the observed counterpart y r s y is the correlation coefficient between s and y σ s is the standard deviation of s σ y is the standard deviation of y μ s is the average of s and μ y is the average of y thus the informal likelihood of streamflow was evaluated by the kge of the streamflow logarithm 24 l m q kge log q y e s log q o b s the informal likelihood of evapotranspiration was evaluated by the mean kge of et scenes derived from landsat 8 imagery and computed the by surface energy balance algorithms for land sebal presented and detailed in laipelt et al 2020 25 l m e t 1 n i n kge e t i y e s e t i o b s where n is the number of available et scenes i for direct and computationally fast comparison with the simulation maps the observed et scenes were resampled in the spatial matrix of the plans model fig 4 by the zonal mean of each matrix cell that is each spatial unit furthermore to not bias the likelihood estimate the value of et in each cell of the matrix both simulated and observed was considered proportional to its spatial distribution 2 3 3 search algorithm admissibility and selection criteria the glue method is also characterized by the a priori definition of an admissibility criterion for including searched models in the posterior likelihood estimation this leads to the problem of searching the parametric space for a large set of admissible or behavioral models here the search for such set was performed by an evolutionary algorithm unlike the conventional glue method of beven and binley 1992 which makes use of random sampling in the parametric space this search method suggested by khu and werner 2003 aims to reduce the number of model realizations in order to map high likelihood regions in the parametric space without however focusing on the search of a single global optimum in this sense we developed a genetic algorithm to perform the search for admissible parameter sets the algorithm 1 below presents the pseudo code of the evolutionary algorithm developed for the calibration of the plans model this code was compiled by a python 3 routine available in https github com ipo exe plans3 releases tag v0 1 1 the algorithm s parameters are 1 the number of generations 2 the size of the population of candidate solutions 3 the size of the recombination segment and 4 the mutation rate of the solutions at the end of the process the last generation contains the best solutions found any candidate solution consists of a vector of numerical elements the encoding of the vector gene in the evolutionary algorithm is done in integer format ranging from 0 to 1000 that is the numerical value of the calibrated parameters manifests a resolution of the 1000th prior confidence interval the variation operator of the developed algorithm has two components 1 recombination and 2 mutation recombination occurs by drawing two candidate solutions that produce two new solutions by exchanging a segment of pre defined size between them mutation occurs by substituting one element for another in the vector both are stochastic operations with the difference that not all solutions mutate the algorithm selection operator presents deterministic elitism that is the best solutions of one generation are selected to integrate the next generation in the present case study the uncertainty of ten parameters were assessed in this sense any candidate solution consisted of a vector of ten numerical elements that is submitted for evaluation in terms of likelihood eq 22 therefore it was necessary to simulate the plans model in each evaluation and return not only the simulated streamflow but also the spatial matrix of et on the date of each landsat scene used in the calibration period twenty generations were evaluated each with 2 000 candidate solutions the mutation rate was set to 1 and the recombination segment was set to three elements we defined the admissibility criterion by the 1000th best solutions produced by the search algorithm i e the combinations of parameters with ordering of likelihood l y m y eq 22 higher or equal to 1000 as for the estimation of the spatial epistemic uncertainty of the case study a selection was extracted from the behavioral models considering the best hundred models in relation to the likelihood of streamflow l m q eq 24 2 4 case study and experiment design here are described the details of the case study which is the arroio castelhano basin basin of interest and the pardinho river basin calibration basin additional details are presented in appendix a appendix a 1 shows the list of data used appendix a 2 presents additional maps of the arroio castelhano basin basin of interest 2 4 1 the pes program in the arroio castelhano watershed our case study is the arroio castelhano watershed a tributary of the taquari river which is located in rio grande do sul brazil the watershed is within the atlantic forest biome where native vegetation is a submontane semideciduous wet forest with rich biodiversity and high level of species endemism rezende et al 2018 the mountains are characterized by basalt cliffs with residual shallow clayey soils and valleys with relatively deeper loamy soils the climate is humid sub tropical with an average annual precipitation of approximately 2000 mm a small portion of the region at lower elevations is dominated by sandstone substrate and well drained sandy soils due to the shallow soils steep terrain orographic precipitation and low seasonality a streamflow regime with high variability and relatively low baseflow is observed in the rivers of the region collischonn et al 2007 the arroio castelhano watershed is the main source of water for the city of venâncio aires nearly 72 thousand inhabitants ibge 2021 drinking water is supplied by the companhia riograndense de saneamento corsan which is developing a watershed pes program in the basin area 468 km 2 the existence of budget constraints leads to the need to optimize the process of choosing the priority restoration areas included in the program for the expansion of nbs in the case of corsan s pes program for the arroio castelhano watershed we consider an annual budget estimated at us 39 062 00 and annual payments of us 39 00 ha which results in a maximum total area of 1000 ha for the expansion of nbs i e 2 6 of the basin area however since the region has a high density of rural properties with 3496 rural properties registered the problem of spatial allocation arises where to invest the available resources in the most efficient way possible fig 5g 2 4 2 spatial datasets the absence of gauging stations in the arroio castelhano basin made it necessary to use for the calibration process the neighboring basin rio pardinho 805 km 2 fig 5a the pardinho river basin presents great similarity in terms of area climate landscape geology land use and land cover which justifies the transfer of the model parameters for both basins maps were produced for saturation propensity units and hydrological response units the saturation propensity map was derived from the htwi map which itself was classified into twenty classes separated by equal intervals from zero to the maximum index obtained the map of twi was processed from strm digital elevation model farr et al 2007 with cell resolution of 30 m fig 5a the digital elevation model was processed by the algorithm of wang and liu 2006 for the removal of depressions from this the flow directions d8 method and the accumulated flow in each cell were determined the map of hand was obtained from the digital elevation model of the merit hydro dataset yamazaki et al 2019 using a drainage network defined by the algorithm topographic position based stream definition of barbedo et al 2022 the values of htwi parameters w and h m a x were previously defined with h m a x set at three meters and w considered the unit to obtain the hydrological response units map we built a mosaic between maps of soil types fig 5d and land cover classes fig 5e the classification of soil types considered two approaches 1 the definition of the substrate that forms the soil based on data from the hydrogeological map of brazil diniz et al 2014 and 2 the classification of landscape units based on hand and slope gao et al 2014 gharari et al 2011 savenije 2010 where a threshold of hand three meters separates the riparian wetlands from the rest of the terrain and a slope threshold of 10 separates the hillslope areas from the flat areas for each substrate this classification yields three landscape units for the soil type 1 residual soil 2 colluvial soil and 3 alluvial soil for land cover we separated regions into six classes 1 crops 2 pastures 3 roads 4 forests 5 urban areas and 6 water bodies this classification was based on field visits and visual inspection of satellite imagery in which we verified that the crops are mostly tobacco and accompanied by pastures the native vegetation is the atlantic forest due to the high land division density the region has a large number of unpaved rural roads subject to heavy erosion the post development land cover scenario map fig 5c was obtained for both basins from the mapbiomas project of souza et al 2020 which is a classification of landsat 8 scenes and rural road data available from openstreetmap contributors 2017 the reference year for coverage in the post development scenario was 2013 the map of the pre development coverage scenario on the other hand was defined by the coverage of potential native vegetation that is by the complete coverage of atlantic forest see appendix a the relative magnitude of model parameters for each hydrologic response unit was conditioned a priori considering spatial proxy variables and values reported in the technical literature for the coverage parameters c p m a x s f m a x and e r z the relative magnitude between each hydrological response unit was obtained by the zonal mean of the ndvi of landsat 8 scenes obtained in the period encapsulated by the precipitation and streamflow series as for the soil parameters k s a t the relative magnitude between each hydrological response unit was considered from the hydrogeological map of brazil diniz et al 2014 the effective porosity value φ was fixed a priori φ 0 5 2 4 3 hydrological datasets streamflow series used came from the gauging station of rio pardinho code 85830000 shown in detail iv in fig 6a available from the snirh database precipitation series from rain gauges deodoro code 2952037 boqueirão code 2952036 and herveiras code 2952035 were also obtained from the snirh database details i ii and iii in fig 6a fig 5b shows the map of monitoring stations and the thiesen polygons used as the area of influence of each precipitation station the average daily temperature series was obtained from the santa maria weather station code 83936 the longest period encapsulated by available hydrological information was four years from 2011 to 2015 the period reserved for verification was defined from october 2013 to 2015 corresponding to 30 of the total series in the available period and from 2013 onwards eleven daily scenes of evapotranspiration were obtained by the tool developed by laipelt et al 2020 for google earth engine which uses the algorithm surface energy balance algorithms for land sebal on landsat 8 imagery these daily scenes of et fig 6d were selected to have less than 10 cloud cover and focused on a reduced yet representative extent of the calibration basin the definition of such calibration window aimed to minimize the shading effect of the terrain in et scenes common in the mountainous region finally the et scenes were resampled in the model s spatial matrix fig 4c and the zonal mean was obtained for each class of hydrological response units and saturation propensity units in order to assess the sensitivity of our approach to the availability of hydrological information we structured three sets of data used in independent experiments fig 6b and c the reference dataset consists of all available data ds0 this set contains data from three rain gauges totalizing 16 years of data the other two sets consist of data that have been degraded the alternative set a dsa with only one rain gauge available and alternative set b dsb with only one rain gauge and a shorter time series as illustrated in fig 6c the reference set ds0 has 16 years of data records while the alternative sets dsa and dsb has eight and four years respectively 3 results 3 1 results in the calibration basin 3 1 1 search and selection of behavioral models the behavioral models found by the search algorithm brought elucidation on the distributions and posterior confidence intervals of the ten parameters that were analyzed by the glue method fig 7 exposes the results of the model search and the analysis of posterior distributions only for the reference dataset ds0 results for the alternative datasets dsa and dsb are given later in section 3 3 3 fig 7a presents an inspection window in the space produced by the two likelihood components streamflow l m q eq 24 and evapotranspiration l m e t eq 25 in this window while l m q exhibited positive values l m e t remained in a range of negative values which means that streamflow information was much better represented by the model we also highlight that several models exhibited relatively good likelihood measures for only one of the likelihood components which corroborates the equifinality thesis of beven 2006 the information available on the hydrological system is not enough to justify a given set of parameters from one model over another since in each generation the population parents produces the same number of descendants offspring up to 40 000 candidate solutions were explored in the evolution process illustrated by fig 7b although the number of generations 20 was defined a priori the evolution of the search resulted in a typical curve eiben and smith 2015 advancing fast at the beginning and stabilizing after a few generations fig 7c shows the likelihood of the behavioral models from the perspective of each of the ten parameters each point on the graph represents a behavioral model so each graph displays 1000 pointspoints and all have their corresponding counterparts on the other graphs in fact when evaluating the top of the point mass this type of graph allows the visual interpretation of the shape of the response surface of model informal likelihood furthermore the density of the points informs about the confidence interval and posterior distribution of the parameters which is determined by the glue method and illustrated in fig 7d it was found that part of the evaluated parameters showed a multi modal response surface with likelihood peaks obtained in many parts of the prior confidence interval in the case of parameters q o c p m a x and e r z the response surface was practically constant as for the k s a t parameter it was observed that there were two well defined peaks at each end of the range this feature resulted in a relatively small reduction in the posterior confidence interval about one tenth of the prior interval on the one hand these results also reinforce the equifinality thesis of beven 2006 there is ambiguity in relation to which is the optimal parameter set on the other hand the parameters m λ s f m a x c k and n manifested a unimodal response surface with a greater reduction in the confidence interval a relatively well defined likelihood peak was observed for the global parameters c k and n with a reduction in the confidence interval from one third to one fifth of the prior interval 3 1 2 model performance fig 8a shows results of the streamflow analysis shown on logarithmic scale the observed simulated median and i 90 of streamflow series are shown in detail i in fig 8a the temporal epistemic uncertainty of streamflow can be visualized in a weekly moving average in the detail ii in fig 8a here there was an epistemic uncertainty with a relatively accentuated variability and a higher weekly average in low flows which suggests that the model presents more behavioral possibilities to represent periods of drought for example in the 2012 drought the epistemic uncertainty reached its maximum value in addition to remaining above the average 173 for the calibration period during the verification period nonetheless the epistemic uncertainty exhibited less variability and remained at an average slightly lower than the calibration period 129 probably due to the higher moisture of this period the detail iii in fig 8a is also a weekly moving average which evaluates the performance of encapsulating the data observed by i 90 according to beven and binley 2014 an ideal performance would consist of i 90 encapsulating 90 of the observed data the results obtained however deviate from the ideal with the average for the calibration period being approximately 50 interestingly the encapsulation average remained similar in the verification period which implies that the model remained with the same performance which is usually not the case due to overfitting effects the simulated median performance was relatively good exhibiting kling and gupta efficiency of 0 66 gupta et al 2009 and nash sutcliffe efficiency of 0 48 nash and sutcliffe 1970 both metrics taken by the logarithm of streamflow the largest deviations from the median occur at high flows which suggests both 1 the greater difficulty of the model to represent large floods and 2 the interference of statistical uncertainty arising from observed precipitation and flow data during extreme events the relatively good performance of the median and prediction interval is also reinforced by the scatter plot detail iv and the flow duration curve plot detail v both in fig 8a the median and limits of the prediction moved relatively adherent to the observed data with pearson correlation coefficients above 0 7 the hydrological regime is also well represented with most orders of magnitude encapsulated by the confidence interval of the flow duration curves fig 8b exposes results of the evapotranspiration analysis the series of observed et the simulated median and the i 90 are displayed in detail i in fig 8b the temporal epistemic uncertainty of et can be visualized in a weekly moving average in the detail ii in fig 8b unlike streamflow there was low variability in the epistemic uncertainty of et which remained constant average of 41 for most of the calibration period with exceptions observed mainly in the summer the time of year with the most pronounced droughts the same pattern and performance were obtained in the verification period this reinforces the previous hypothesis that the model manifests more behavioral possibilities of representing dry periods than wet periods the overall signal encapsulation performance of the eleven et scenes was 60 in the calibration period and 33 in the verification period despite the reduced number of observations eleven for quantitative analyses it was found by visual inspection a good performance of the median in terms of adherence to the temporal pattern low et in winter and high et in the summer this is consistent with the energy availability in the system represented by the oudin model oudin et al 2005a finally fig 8c shows an example of the local adjustment of one of the et scenes used in the calibration of one of the 100 selected models to avoid the effects of clouds and hill shading the scenes were compared in a reduced yet representative spatial extent of the calibration watershed shown in detail the map i in fig 8c shows the original map of observed et derived from scene landsat 8 with algorithm sebal of laipelt et al 2020 the map ii in fig 8c presents the resampling of the et observed in the spatial units here a smoothing of the et extremes was observed since the average was taken in each spatial unit the map iii in fig 8c displays the local error i e the difference between the observed map and the simulated map considering that the likelihood measure of et eq 25 directly considered the observed and simulated maps the spatial pattern of et in the simulation has been preserved otherwise if only the global averages of et were used there would be no guarantee of getting right results for the wrong reasons i e of not obtaining simulated unlikely spatial patterns after all there are countless ways to obtain the same average over an spatial extent 3 2 results in the basin of interest 3 2 1 hydrological processes in time the principle of additionality in the basin of interest was followed by simulating two different land cover scenarios 1 the pre development scenario having a homogeneous cover of atlantic forest forests 100 forest and 2 the post development scenario with ground cover being observed in 2013 and obtained by souza et al 2020 showing a mosaic of forests 61 3 pastures 3 8 crops 31 6 urban areas 0 4 ponds 0 1 and roads 2 6 the hydrological processes simulated for both scenarios are shown in fig 9 the simulated water flows accumulated and annualized annual average are shown in fig 9a the annual averages of water stocks in the reservoirs of the hydrological system are presented in fig 9b the time series and flow duration curves of the median and the 90 confidence interval for streamflow baseflow and evapotranspiration are shown in fig 9c d and e respectively considering that post development scenario presents 38 7 less native forests atlantic forest the results agreed with what was expected from the impact of forests on the hydrology of watersheds less runoff more infiltration and more evapotranspiration compared to paired basins without forests filoso et al 2017 andréassian 2004 it should be noted however that the large overlap of the 90 prediction interval obtained between both scenarios prevents us from categorical statements about the difference between the simulated hydrological processes the average discrepancy of the simulated hydrological behavior of the pre development scenario was marked by higher annual water losses by evapotranspiration especially by direct evaporation from the canopy e v c in fig 9a and lower annual production of infiltration excess runoff hortonian r i e in fig 9a the annual production of saturation excess runoff did not show major average discrepancies between the scenarios r s e in fig 9a which reinforces the aforementioned need to use models that make the proper separation between runoff mechanisms unlike runoff it was found that in annual terms infiltration recharge and baseflow i n f q v and q b in fig 9a respectively were all relatively higher in the scenario with more forests this was enough to obtain for different reasons a similar average annual flow q in both scenarios approximately 760 mm per year with an annual flow coefficient of 38 the simulation of the greater presence of forests also resulted in a greater average annual storage of water in the system s stocks in the canopy on the surface and in the vadose zone c p y s f s and u n z in fig 9b respectively in other words despite evaporative losses the simulation of scenarios suggests that forest cover has the potential to reduce infiltration excess runoff hortonian runoff and to increase groundwater recharge the time series analysis gave insights for the hydrological regime in both land cover scenarios for example the left limit of the flow duration curve detail ii in fig 9c indicated that there are no major differences between land cover scenarios at very high flows suggesting that the maximum canopy and surface storage capacity is largely exceeded during extreme precipitation events however it was confirmed that the scenario with more forests pre development exhibited moderately higher flows the origin of this flow was baseflow which is higher in this scenario most of the time as illustrated in the time series detail i and in the flow duration curve detail ii in fig 9d nonetheless this was not enough to guarantee more water in critical periods of drought baseflow tends to be the same in these periods when the basin is extremely dry as in january 2012 in fact as shown in the right limit of the flow duration curve detail ii in fig 9c the system s simulation showed higher drought flow in the scenario with fewer forests post development the reason for this could not be explained by baseflow which is the same in both scenarios in these critical situations but the infiltration excess runoff hortonian produced in greater quantity in the post development scenario in summary with fewer forests the minimal precipitation available in critical dry periods was largely converted into runoff while in the scenario with more forests this water was depleted by interception evaporation and transpiration from plants the results shown in fig 9 support this conception since evapotranspiration is always higher in the scenario with more forests pre development 3 2 2 hydrological processes in space the spatial anomaly and the spatial epistemic uncertainty were estimated from simulated hydrological processes maps aggregated annualy in this sense the mean and 90 prediction interval of runoff recharge evapotranspiration annual soil loss annual nitrogen export and annual phosphorus export were extracted both statistics were computed cell by cell from the set of 100 selected models resulting in synthetic maps of the spatial hydrological pattern for each land cover scenario pre development and post development although this procedure was applied to all datasets see fig 6 only results for the reference dataset ds0 are presented here fig 10a illustrates some interesting results of the spatial assessment for the post development scenario in a selected extension of the arroio castelhano basin the totality of results for both coverage scenarios is displayed in appendix b 1 and in appendix b 2 the spatial extent of the analysis was defined as an inspection window selected as adequate in terms of scale and for its landscape diversity this region presents the transition from the mountainous areas to the alluvial plain where different types of soils occur sartori et al 2005 residual basalt soils predominate in the higher parts alluvium occurs in valleys and plains and residual sandstone soils outcrop in the undulating terrain at the base of the mountain escarpment detail i another feature of this extension is the richness of the mosaic of land cover classes under post development scenario including the urbanized area of venâncio aires detail ii the simulated annual recharge map detail iii in fig 10a suggests a hierarchy of importance for this process topography first well drained hillslopes with low soil water deficit then the soil type effective hydraulic conductivity and finally the land cover class effective surface storage capacity it demonstrates that there was no recharge in the valleys and floodplains these zones are riparian wetlands where in fact groundwater was near the surface most of the time soil types and land cover classes were indifferent for recharge in these zones as there was a high saturation of soil pores as a function of the topography and global saturation of the basin on the other hand soil types and land cover classes were determinant for recharge over well drained hillslopes the region dominated by residual sandstone soils despite the predominance of crops stood out for the highest average annual recharge flow which is in line with the a priori definition of the scale factor of effective hydraulic conductivity for this soil ten times greater than basaltic soil see fig 14 in appendix a in this region the small fragments of existing forest exhibited the highest simulated average values of annual recharge around 800 mm and the lowest values were found in the urban area followed by crops and pastures the same pattern between land cover classes but at a lower average level occurred in the region dominated by residual basalt soils the highest simulated annual recharge flows occurred in forests this indicates the positive impact on recharge of effective surface water storage capacity which is greater in forests due to litter and organic horizon the contrast between the maps of saturation excess runoff detail v from fig 10a and infiltration excess runoff hortonian runoff detail iv in fig 10a demonstrated that these simulated processes manifest in completely different environments in the landscape and for different reasons the simulation of saturation excess runoff exhibited an annual spatial pattern that reflected the propensity of soil saturation with the highest flows obtained in the riparian wetlands of the alluvial plain values above 1300 mm and gradually lower flows in the valleys and thalwegs of the terrain tending to zero in well drained terrain environments hence this hydrological process manifested itself mainly as a function of the topography and global saturation of the system with soil types and land cover classes being secondary factors on the other hand the simulation of infiltration excess runoff hortonian runoff exhibited an annual spatial pattern that mainly reflected the effective surface storage capacity of the land cover classes being lower in forests and higher in crops pastures and urban areas soil types also showed some influence since in the region of residual sandstone soils the runoff flows were relatively smaller than in the regions of residual basalt soils this fact agrees with the recharge simulation map indicating that the higher infiltration flow in the sandstone regions ensured a greater surface storage capacity between the surface remained dry for longer periods of time the resulting map of annual soil loss detail vii in fig 10a preserved a spatial pattern adhering to land cover classes the difference in magnitude between the coverage classes however varied under topographical influence in the case of the post development scenario crops and pastures showed higher annual soil loss values than forests this means that the factor c of usle m detail ii in fig 14 exhibited a greater influence on the simulation result in relation to the types of soils erodibility k detail i in fig 16c and the runoff coefficient itself rural unpaved roads stood out by presenting extremely high simulated values of annual soil loss around 100 tons per cell the lowest annual soil loss occurred in the riparian wetlands where the low topographic factor of the alluvial plain factors l and s details ii and iii in fig 16c respectively prevailed both over land cover crops and pastures and over the runoff coefficient which was high in these wetlands due to saturation excess runoff see detail iv in fig 10a the highest mean annual simulated evapotranspiration et detail ix in fig 10a occurred in forests and riparian wetlands by different mechanisms et in the riparian wetlands showed a strong component of deep transpiration t p s from the saturated zone the mean annual deep transpiration map detail vii in fig 10a showed a simulated spatial pattern similar to that obtained for saturation excess runoff which suggests a strong effect of topography on this process for example forests in the higher valleys and thalwegs showed even less deep transpiration than crops and pastures in riparian areas the land cover exerted some influence on the simulation of this process only in intermediate regions of the landscape where the small fragments of forest scattered in the matrix of crops stood out for being a focus of deep transpiration the large et in forests exhibited a greater component of evaporation mainly from the water stored in the canopy in fact in forests in mountainous and well drained areas of the landscape the simulation of canopy evaporation practically corresponded to the entire et with the other evaporative fluxes being minimal see fig 17c the simulation of evaporation from the surface although relatively smaller predominated in well drained and deforested areas in this case and in the case of transpiration in the vadose zone the simulated influence of soil types was manifested since residual sandstone soils by guaranteeing a greater infiltration flow presented a lower mean annual evaporative flow than in residual basalt soils results for spatial anomaly of all simulated hydrological processes are presented in appendix b 1 fig 10b illustrates anomaly in the case of runoff the anomaly detail iii is the difference between the post development scenario detail ii and the pre development scenario detail i at a first glance it was found that the simulated runoff anomaly was positive where the land cover class changed from one scenario to another that is where forests were replaced by crops pastures pounds roads and cities the highest anomaly values above 500 mm were found in the urban area and rural unpaved roads this naturally suggests that the reduction in canopy and surface storage capacity was the cause of the higher mean annual runoff in the post development scenario by closer inspection however it was also found that the simulated runoff anomaly was negative in certain areas where land cover had not changed this happened because the structure of the plans model and the topmodel implies a dynamic interaction between the global state of saturation and the local states of saturation of the watershed in this sense the entire hydrological landscape is connected by the local deficit mapping function eq 15 allowing downstream processes to produce upstream effects as can be seen from the analysis of the other hydrological processes see appendix b 1 the component responsible for the negative anomaly of the runoff was the saturation excess runoff detail iii in fig 15 as the basin remained relatively drier in the post development scenario detail iv in fig 18 the retraction of the extent of the saturated areas resulted in less simulated saturation excess runoff in the higher parts of terrain thalwegs a topographic phenomenon and regardless of land cover class in fact these landscape zones exhibited a positive anomaly in the infiltration and recharge simulation details iv and v in fig 18 respectively contrastingly the basin remained relatively drier in the post development scenario precisely because simulated recharge anomaly was negative in most of the territory this was manifested not exclusively by the lower water infiltration into the soil but also by the higher water capture by transpiration from the vadose zone canopy evaporation and deep transpiration previously sufficient were unable to meet the potential demand for evapotranspiration resulting in a positive anomaly of vadose zone transpiration fig 17 results for spatial epistemic uncertainty of all simulated hydrological processes are presented in appendix b 2 fig 19 fig 20 and fig 21 as we used the prediction interval of 90 as the dispersion measure values above 100 were verified in most hydrological processes except for evapotranspiration fig 10c illustrates the procedure used to obtain the spatial epistemic uncertainty for the case of runoff in the post development scenario uncertainty detail iii is the ratio between the 90 prediction interval detail ii and the mean detail i an auxiliary graph displays the sampling of four points on the map point s1 in the alluvial plain point s2 in the hillside forest point s3 in the urban area and point s4 on a terrain thalweg a relatively lower epistemic uncertainty was found in riparian wetlands of the alluvial plain despite that there was a high uncertainty in the transition zone from the wetlands to the well drained part of the land which reflects the wider amplitude obtained in the posterior confidence interval of the parameters m λ and q o see fig 7 the different behavioral models resulted in divergences in the extent of the saturated areas on the upstream side which is the side that expands or retracts depending on the saturation of the basin a greater epistemic uncertainty was also observed in infiltration and recharge over the region with residual sandstone soils this suggests a synergy between the wide range of the surface parameters c p m a x and s f m a x and the k s a t parameter see fig 7 since the scale factor defined for this type of soil was relatively higher fig 14 however the relatively wide posterior confidence intervals of the parameters c p m a x and s f m a x showed no greater influence on the spatial epistemic uncertainty of the evapotranspiration simulation fig 20 we interpreted that the reason for this lies in the relatively narrow posterior confidence interval of the parameter c which resulted in a potential evapotranspiration always below the canopy and surface storage thresholds along these lines the results suggest that spatial epistemic uncertainty is more sensitive to flow parameters than to storage parameters 3 3 priority for action allocation 3 3 1 priority index of rural properties the order of priority for actions was defined by eq 3 a composite priority index that considers both the anomaly and the uncertainty of hydrological processes to determine the index the zonal mean for anomaly and uncertainty were extracted by geoprocessing techniques from each of the rural properties in the watershed detail i in fig 11a i e these spatial variables were sampled aggregated in the extension of the polygon of each property as illustrated by the detail ii in fig 11a from this the anomaly index i a and the uncertainty index i u were obtained from the analysis of the histogram of each aggregated spatial variable detail iii in fig 11 the anomaly index was defined in six percentile classes with class i a 6 being the 5 properties with the highest anomaly the inverse was defined for the uncertainty index with the class i u 6 being the 5 properties with the lowest uncertainty the other i a and i u classes follow the 20 intervals of the histogram of the respective variable fig 11b presents the results for the anomaly index for the hydrological processes considered of interest runoff et recharge annual soil loss annual nitrogen export and annual phosphorus export these processes were selected in order to represent the main flows in terms of water availability and water quality fig 11c displays the results for runoff uncertainty index et and recharge the uncertainty of the annual loss of soil and nutrients was considered by the uncertainty of the runoff as they were calculated from the histograms the maps of the anomaly and uncertainty indices fig 11b and c presented the spatial pattern more clearly on these variables for example the high classes of the anomaly index i a of et and recharge predominated in the downstream plain regions which reflects the pattern of agricultural development in this area the region of residual sandstone soils stood out with the highest anomaly index i a 6 mainly in relation to runoff as for the annual loss of soil and nutrients nitrogen and phosphorus the highest anomaly index i a 6 was manifested in the cliffs of the mountain range in the intermediate portion of the watershed which suggests a greater influence of topography 3 3 2 impact of uncertainty estimation the priority index i p eq 3 of each rural property was used to obtain the ordered list of priority properties the limit of the list was defined based on the information on the area of each rural property and the budget constraint which was considered by an annual budget of us 39 062 00 and pes of us 39 00 ha equivalent in a maximum area of 1000 hectares for the expansion of nbs in the watershed thus the list was built by selecting the first 236 priority rural properties totalizing 997 hectares the map of priority rural properties and their respective ordering is displayed in fig 12b fig 12a map displays an alternative analysis which was conducted considering only the anomaly index i a in determining the priority index that is the eq 3 was not weighted by the i u uncertainty index the inclusion of spatial epistemic uncertainty resulted in 43 18 of the properties being replaced in the priority list with the spatial arrangement remaining similar the inclusion of spatial epistemic uncertainty also reconfigured the order of priority of the properties that were not replaced 97 of the properties changed their order with approximately 20 of the changes being a jump or a fall greater than 100 positions on the list out of 236 fig 12c displays the map of the ordering change and fig 12d displays the analysis of the change 3 3 3 value of hydrological information the results presented so far correspond to the reference dataset ds0 i e all available hydrological information the next results are analogous but for the alternative degraded datasets dsa and dsb described in section 2 4 2 here fig 13a and b present the likelihood space of the obtained behavioral models and the evolution of the search algorithm for the different datasets are shown respectively the signatures of selected models of different datasets are displayed in fig 13c the action allocation policies considering the epistemic uncertainty resulting from the application of the approach to the different datasets are shown in fig 13d finally fig 13e demonstrates the analysis of the value of hydrological information by the avoided cost of the reference dataset in relation to the alternative degraded datasets although the spatial pattern of alternative policies was relatively preserved the results showed that in practice different datasets of hydrological information led to different allocation policies that is different lists of priority properties emerged from different hydrological information furthermore the results made it possible to quantify the difference between the reference policy and alternative policies for example the alternative policy dsa failed to list 82 priority reference properties and listed 33 extra properties which were not priority according to the reference policy therefore the additional cost of the extra properties in the alternative policy dsa resulted in an avoided cost in the reference policy of approximately us 10 248 00 or 26 2 of the budget constraint us 39 062 00 the alternative policy dsb showed a different result 63 missing properties and 29 extra ones with an avoided cost in the reference policy of approximately us 7 883 00 or 20 of the budget constraint us 39 062 00 table 3 summarizes the results for the different allocation policies interestingly the alternative policy dsb exhibited an avoided cost lower than the alternative policy dsa this was contrary to our initial expectations given that this policy was obtained from a more degraded dataset in contrast to dataset dsa which was degraded only by the absence of certain rain gauges the dataset dsb presents half of streamflow time series with the aggravating factor of not including the severe drought seen in the year of 2012 this discrepancy in the temporal dimension is clearly manifested in the region of the likelihood space fig 13a the behavioral models are shifted in order to favor the likelihood of et l m e t to the detriment of the streamflow likelihood l m q another difference in the dsb dataset was evident in the evolution of the search for behavioral models fig 13a showing a late and atypical progress although sufficient in the final generations to obtain models with average likelihood l y m y higher than the other datasets this result again corroborates the problem of equifinality in hydrological modeling evoked by beven 2006 showing direct impacts on the planning and management of watersheds in this case the temporal degradation of the scarce information available did not prevented the search for behavioral models from being successful including finding models that on average are even better according to the chosen likelihood measure 4 discussion the main contribution of our research is that we provided a comprehensive modeling approach to tackle the problem of planning the expansion of nature based solutions nbs in a watershed payments for ecosystem services pes program under epistemic uncertainty this is a novel relevant input to the field of modeling hydrological ecosystem services because we addressed in a single framework the following basic requirements 1 to follow the principle of additionality 2 to represent multiple runoff mechanisms 3 to obtain farm scale spatial outputs and 4 to estimate output epistemic uncertainty for our case study arroio castelhano watershed brazil we made clear that the estimation of spatial epistemic uncertainty in the mapping of priority restoration areas is a critical information for efficient resource allocation at the operational level farm scale as far as we could check advanced studies in this research field failed to fulfill the four basic requirements mentioned above mainly because they make use of aggregated or gis based models such as swat and invest evenson et al 2021 saad et al 2018 hamel and guswa 2015 huisman et al 2009 moreover as suggested by evenson et al 2021 the use of the glue method for epistemic uncertainty estimation makes our approach the first study in this research field to explicitly address the equifinality of conceptual hydrological models beven 2006 we also deliver three secondary important contributions to the general field of hydrological modeling 1 the modification of topmodel in what we called the plans model 2 the proposition of the novel hand enhanced twi saturation index and 3 the assessment of the economic value of hydrological information under an uncertainty framework strengths and limitations of these research findings are discussed in the next paragraphs the introduced plans model presents itself as a promising operational tool for planning spatial and temporal allocation of restoration actions as proposed in possantti and marques 2022 most of the literature in this subject as reviewed in francesconi et al 2016 uses swat to model hydrological ecosystem services a model that since its proposition in arnold et al 1993 simulates runoff by applying the curve number method of mockus 1949 despite its empirical basis the curve number method is tied to the paradigm of infiltration excess runoff hortonian in addition of not being designed for continuous simulation we think that the widespread operational use of such model is not justified before being tools hydrological models are hypotheses beven 2019 and the hypothesis underlying fast runoff mechanisms has been updated many times since dunne and black 1970 the application of the plans model in our case study clearly demonstrated the operational superiority of simulating both infiltration excess and saturation excess runoff topographic effects in certain parts of the landscape can overcome secondary factors such as land cover and soil type furthermore the plans model allows for calibration and verification against both observed time series e g streamflow and detailed gridded data e g et scenes so output uncertainty can be constrained in a greater extent as is proposed in zink et al 2018 and oliveira et al 2021 and shown by our results the design of the plans model was inspired in topmodel beven and kirkby 1979 but with adjustments in surface storage streamflow routing and representation of spatial heterogeneity it resulted in a novel structure with 13 parameters 7 more than found in topmodel beven et al 2020 what inevitably added more uncertainty in the modeling process however such changes are justified in both a theoretical sense and a practical sense the original surface water storage as pointed by gao et al 2015 was too simplified for the assessment of the influence of mosaics on different land cover classes including forests to address this problem they introduced a fully distributed version of topmodel sacrificing the original low computational demand in our approach the concept of spatial matrix preserved a low processing demand at the cost of two new parameters c p m a x and s f m a x and more model uncertainty our concern with practical processing speed was also manifested in the routing method which differs from the original in that it is completely concentrated the unit hydrograph method of nash 1958 at the cost of two new parameters k and n chen and wu 2012 also claim to bring an alternative to represent spatial heterogeneity but they actually incorporate to swat some features of topmodel while we incorporate to topmodel some features of swat and other models based on hydrological response units the proposed hand enhanced topographical wetness index htwi was an innovative attempt to incorporate the hand terrain descriptor directly into a hydrological simulation model advanced studies have so far used hand as an index of similarity for classification of landscape units soils and vegetation e g cuartas et al 2012 or for mapping and modeling floods e g nobre et al 2016 it is true that gao et al 2019 also offer an alternative to use hand directly in hydrological simulation with the hand based storage curve method even so the htwi is an interesting approach as it delivers the flexibility to model different landscapes on the one hand the twi of topmodel emerges from the approximation of the hydraulic gradient to the terrain gradient beven et al 2020 which implies the assumption of shallow soils on the other hand htwi allows the representation of two different saturation environments a dual landscape downstream wide riparian wetlands contrasting with upstream constrained wetlands the composition of twi with hand under different combinations of dominance w threshold h m a x and global values λ opens opportunities for further comparative modeling studies in different geomorphological and climatic regions our results also reinforce the hypothesis that action allocation policies are very sensitive to the hydrological information available for modeling in our case study the data increment introduced an avoided cost in the allocation policy of up to 27 of the estimated budget for the watershed pes program however it was shown that the value of this information is not proportional to the amount of data a more similar allocation policy can emerge from a more degraded dataset we interpret this paradox under the equifinality thesis of beven 2006 since the behavioral models obtained from the different datasets are equivalent in terms of likelihood but occupy distinct regions of the parametric space planners in our case study would benefit substantially from a richer dataset than currently available mainly in the temporal dimension in order to condition the calibration of the hydrological model and reduce the equifinality problem the proposed modeling approach has several limitations that must be addressed in future works it is recommended the use of multiple likelihood measures for aggregated streamflow in different time scales such as weekly monthly and annual e g kge of annual minimums annual pbias etc another possible improvement consists of adapting the demand of potential evapotranspiration at the global level in the basin as forests in well drained areas presented a minimum simulated transpiration flow which is not consistent with our perception of such hydrological process advances in empirical modeling such as in kisi et al 2022 suggests novel alternatives for modeling potential evapotranspiration other than the oudin model oudin et al 2005a the use of the nash unit hydrograph for streamflow routing can be revised or conditioned by the topology of the drainage network in order to improve transferability from calibration basins to interest basins also from the view of empirical science it is insufficient to represent the saturation excess runoff without modeling the connectivity of hillslopes with the drainage network a phenomenon also responsible for the rapid subsurface runoff mcdonnell 2013 blume and van meerveld 2015 in fact mcdonnell 2003 s comments remain relevant even 20 years later the plans model does not shift beyond paradigm of variable contribution area as with other research models such as those proposed by stieglitz et al 2003 and smith et al 2013 future changes in the general structure should address the activation thresholds of surface and subsurface responses furthermore isotope research reported by renée brooks et al 2010 and evaristo et al 2015 reinforce the need for representation of the different eco hydrological compartments of the soil generally the approach could be improved by integration with other management and planning tools related to the sustainable development goals of the un 2030 agenda united nations assembly 2015 rasul and sharma 2016 argue that sustainability policies should be oriented towards the nexus between water energy and food production in this sense synergies and trade offs with goals other than water security and related ecosystem services must be assessed e g timko et al 2018 turkelboom et al 2018 li et al 2020 to this end additional indicators could be aggregated at the scale of rural properties leading planners to forms of multi criteria decision making e g sarkar et al 2022 spatial optimization models could be coupled to minimize soil loss as shown in domingues et al 2020 trade offs involving food security and biodiversity conservation could be evaluated by multi objective optimization algorithms e g recanati and guariso 2018 verhagen et al 2018 integration with ecological models might help to assess the trade off and synergies between carbon sequestration of forest restoration and annual water yield as suggested by ovando et al 2019 and khorchani et al 2022 in the context of brazil many watershed pes programs emerged in the last two decades in the country promoted by water utilities governments non governmental organizations watershed committees and by the national water agency taffarello et al 2017 although implementing such programs is a complex task viani et al 2019 the growing need for water security for urban centers flörke et al 2018 and the advent of the national program for watershed revitalization could further intensify this trend 5 conclusion this study provided a novel modeling approach to help planning the expansion of nature based solutions nbs for water security and other sustainable development goals of the un 2030 agenda the proposed modeling method is suitable for mapping restoration priority areas in the context of watershed payments for ecosystem services pes programs because it meets the following basic requirements 1 to follow the principle of additionality 2 to represent multiple runoff mechanisms 3 to obtain farm scale spatial outputs and 4 to estimate output epistemic uncertainty advanced studies in the field of ecosystem services modeling have failed so far in fulfilling such requirements in one single framework due to several factors like absence of baseline scenario when additionality is not evaluated intrinsic model structure when process and scale representation is not adequate for the problem and simplistic uncertainty estimation when model equifinality is not considered based on the results of our case study a payments for ecosystem services program in the arroio castelhano watershed brazil it was shown that the estimation of spatial epistemic uncertainty in the mapping of priority areas consists of critical information for efficient resource allocation since 97 of rural properties changed their ranking approximately 20 being a change greater than 100 positions in the priority list our results also clearly demonstrate the advantage of simulating both infiltration excess and saturation excess runoff topographic effects in certain parts of the landscape can overcome secondary factors such as land cover and soil type the distinction between runoff mechanisms allowed the mapping of ecosystem services restoration efforts where it really makes a difference that is to follow the principle of additionality this feature is not possible in other conventional and widely used models such as swat and invest the sensitivity of the approach was also evaluated in the light of more or less hydrological information available which made it possible to estimate the economic value of this information for the watershed pes program the simulation of data increment introduced an avoided cost in the allocation policy of up to 27 of the estimated budget future advances might follow two separate lines of research 1 to improve the modeling features in order to address existing limitations and 2 to integrate or couple the approach to others modeling strategies in order to expand possible applications improvement efforts in the plans hydrological model might envision to constrain uncertainty by using more likelihood measures to explore the proposed saturation index the hand enhanced twi in new different landscapes and to represent the activation thresholds of surface and subsurface responses by changing the model structure integration and coupling strategies might include multi criteria methods and multi objective optimization to assess synergies and trade offs with other ecosystem services and sustainable development goals such as food security biodiversity conservation and climate change mitigation list of abbreviations ds0 reference dataset all data available dsa alternative dataset a degraded dsb alternative dataset b degraded et evapotranspiration glue method generalized likelihood uncertainty estimation hand height above the nearest drainage htwi hand enhanced topographic wetness index invest model integrated valuation of ecosystem services and tradeoffs kge kling gupta efficiency nbs nature based solutions pes payments for ecosystem services plans model planning nature based solutions sebal model surface energy balance algorithms for land swat model soil and water assessment tool topmodel model hydrological model based in the twi twi topographic wetness index credit authorship contribution statement iporã possantti conceptualization methodology software writing original draft rafael barbedo methodology software writing review editing marcelo kronbauer validation writing review editing project administration walter collischonn validation supervision writing review editing guilherme marques conceptualization resources supervision writing review editing funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the authors are grateful for the financial support provided by the brazilian national council for scientific and technological development cnpq brazil grant 380978 2020 2 and national water agency brazil grants apq 404242 2019 7 and 308549 2019 8 appendix a case study additional details additional details of the case study are presented here the arroio castelhano watershed and the rio pardinho watershed appendix a 1 shows the list of datasets used appendix a 2 presents additional maps of the arroio castelhano basin basin of interest a 1 list of input datasets the table 4 presents the complete list of datasets used for the case study all datasets used were obtained from public or freely distributed data sources a 2 additional maps the fig 14 presents an additional detail of the arroio castelhano watershed including the illustration of the pre development scenario a condition in which homogeneous coverage by the atlantic forest is considered potential native vegetation parameter maps and scale factors are also displayed appendix b results additional details here additional details of the results obtained from the application of the approach in the case study are presented appendix b 1 displays the spatial anomaly maps for all processes in the arroio castelhano watershed in the inspection window appendix b 1 displays the maps of spatial epistemic uncertainty for all processes in the arroio castelhano watershed in the inspection window b 1 spatial anomaly all processes here the anomaly maps associated with the annualized hydrological processes in the pre development and post development land cover scenarios are presented in fig 15 fig 16 fig 17 and fig 18 the process maps are the result of the cell to cell average of the 100 selected models the spatial inspection window in the basin of interest arroio castelhano was defined aiming at a better visualization and interpretation of the details produced the pre development land cover scenario was defined by the homogeneous coverage of potential native vegetation which in this case is the atlantic forest the post development scenario was defined by the observed land cover for the reference year of 2013 the anomaly was defined by the difference between the scenarios eq 1 a positive anomaly for runoff for example means that more runoff occurs in the current scenario post development b 2 spatial epistemic uncertainty all processes here the epistemic uncertainty maps associated with the annualized hydrological processes in the pre development and post development land cover scenarios are presented in fig 19 fig 20 and fig 21 the spatial inspection window in the basin of interest arroio castelhano was defined aiming at a better visualization and interpretation of the details produced for each scenario the epistemic uncertainty was defined as the ratio between the 90 prediction interval and the process mean computed cell by cell from the 100 selected models eq 2 the inter scenario uncertainty was defined by the average between the scenarios the epistemic uncertainty maps show where the selected models diverge more or less from the mean value of the hydrological process 
