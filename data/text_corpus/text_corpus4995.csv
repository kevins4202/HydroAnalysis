index,text
24975,the phenology of plants is a major driver of agro ecosystem processes and biosphere feedbacks to the climate system phenology models are classically used in ecology and agronomy to project future phenological changes with our increasing understanding of the environmental cues affecting bud development phenology models also increase in complexity but we expect these cues and the underlying physiological processes to have varying influence on bud break date predictions depending on the specific weather patterns in winter and spring here we evaluated the parameter sensitivity of state of the art process based phenology models that have been widely used to predict forest tree species phenology we used sensitivity analysis to compare the behavior of models with increasing complexity under specific climatic conditions we thus assessed whether the influence of the parameters and modeled processes on predictions varies with winter and spring temperatures we found that the prediction of the bud break date was mainly affected by the response to forcing temperature under current climatic conditions however the impact of the parameters driving the response to chilling temperatures and to photoperiod on the prediction of the models increased with warmer winter and spring temperatures interaction effects between parameters played an important role on the prediction of models especially for the most complex models but did not affect the relative influence of parameters on bud break dates our results highlighted that a stronger focus should be given to the characterization of the reaction norms to both forcing and chilling temperature to predict accurately bud break dates in a larger range of climatic conditions and evaluate the evolutionary potential of phenological traits with climate change keywords sensitivity analysis process based modeling bud development forcing temperature chilling temperature photoperiod 1 introduction bud break is a key phenological event that affects plant performance by defining the period during which plants are able to grow photosynthesize and produce their seeds therefore the phenology of plants is a major driver of agro ecosystem processes cleland et al 2007 and biosphere feedbacks to the climate system richardson et al 2013 it drives ecosystem productivity richardson et al 2012 carbon delpierre et al 2009 water hogg et al 2000 and nutrient cooke and weih 2005 cycling processes as well as energy balance wilson and baldocchi 2000 moreover plant phenology critically affects yield and organoleptic quality of crop harvest nissanka et al 2015 as well as species distributions chuine 2010 the onset of plant activity has been reported to advance by 2 5 days per decade on average during the last 50 years menzel et al 2006 potentially increasing the risk of frost damages on flowers and leaves vitasse et al 2018a these rapid responses have been shown to be highly species specific and are expected to have major consequences on species interactions species distributions ecosystem functioning and forest carbon uptake cleland et al 2007 chuine 2010 richardson et al 2013 therefore accurately predicting plant species phenology at both large and local scales is of key importance for assessing the impact of global change on agro ecosystems and the multiple services they provide as well as species range shift and populations local extinction fu et al 2015b showed however that the linear trend towards earlier spring onset had been slowing down significantly during the last two decades one of the hypotheses put forward by the authors to explain this slowdown is the warming of winters and indeed recently asse et al 2018 documented the negative effect of the warming of winter on the leaf unfolding and flowering date of several tree species air temperature is the major environmental factor regulating the dates of budburst and flowering of plants rathcke and lacey 1985 polgar and primack 2011 in perennial species temperature has an antagonistic effect on bud development depending on the season low temperature called chilling are required to release the endodormancy of buds during winter which is characterized by the inability of bud cells to growth despite optimal growing conditions while higher temperature called forcing are required to promote bud cell elongation in spring recently the effect of long photoperiod in compensating the lack of chilling temperature has also been reported for some tree species laube et al 2014 way and montgomery 2015 zohner et al 2016 our understanding of the environmental cues affecting species specific bud break dates has been increasing thanks to the compilation of large phenological datasets menzel et al 2006 fu et al 2015b and to experimental work in controlled conditions using growth chambers e g caffarra and donnelly 2011 zohner et al 2016 this empirical knowledge has been essential for the development and calibration of process based phenology models chuine and regniere 2017 that are used to predict spring phenology over large spatial and temporal scales e g chuine et al 2016 gauzere et al 2017 while the relative contribution of environmental cues in driving spring phenological responses in current and future climatic conditions is still debated for most species chuine and regniere 2017 laube et al 2014 fu et al 2015a b the recent declining of the response of spring onset to global warming suggests that the relative influence of environmental cues driving the endodormancy phase varies with climatic conditions since climate change is likely to generate non equilibrium conditions the relative influence of the environmental cues might also not remain constant over time overall a strong expectation is that the environmental cues releasing endodormancy should have an increasing influence in warmer environmental conditions yet comprehensive analysis of the behavior of phenology models in different climates are still lacking while pioneer modeling studies in crops have shown that it is expected to change depending on ecological conditions e g yin et al 2005 zhang et al 2014 recently huber et al 2018 highlighted the importance of improving our understanding of models behavior and identifying key parameters and processes that have the strongest effects on model predictions under different ecological conditions it is a major stage to enhance model applications across large spatial and temporal scales as well as the robustness of model projections we embrace this view and acknowledge here the usefulness of sensitivity analysis to reach this general objective sensitivity analyses are interesting statistical tools to address the impact of parameters variations on the outputs of models cariboni et al 2007 allowing to evaluate both intrinsic i e model structure and parameters and extrinsic i e model inputs sources of variation they can also highlight model limitations and directions for further improvements saltelli et al 2000 cariboni et al 2007 therefore they represent an important step in the modeling cycle saltelli et al 2000 cariboni et al 2007 augusiak et al 2014 courbaud et al 2015 for forest tree species most studies in phenology modeling have focused on the analysis of extrinsic sources of variation e g investigating the uncertainty of climatic inputs on simulations morin and chuine 2005 migliavacca et al 2012 ecological studies interested in intrinsic sources of variation most often evaluate the effect of the variation of single parameters on the model outputs other parameters remaining fixed at a given default value e g lange et al 2016 the major disadvantage of this approach is to neglect possible interactions among parameters and to be unreliable in presence of non linear relationships between the parameters and the model predictions coutts and yokomizo 2014 at the opposite sensitivity analyses varying all parameters simultaneously allow to account for parameter interactions and non linear relationships and providing robust sensitivity measures for complex simulation models while phenology model complexity is increasing with our understanding of the physiological responses involved in bud development these interaction effects and non linear relationships can no more be overlooked a first originality and aim of this study was thus to compare the behavior of phenology models with increasing complexity and to disentangle the main and interaction effects of parameters on bud break date predictions the most commonly used phenology models are process based meaning that they describe known or suspected cause effect relationships between physiological processes and some driving factors in the organism s environment to predict the precise occurrence in time of various phenology events see for review chuine and regniere 2017 the parameters of these models are either defined using parameter values measured in experimental controlled conditions or statistically inferred from phenological and meteorological data using inverse modeling techniques since they describe causal relationships derived from experimental work the sensitivity analysis of process based models is supposed to reflect the sensitivity of the real processes saltelli et al 2000 therefore we can expect the sensitivity of phenology models to specific parameters e g driving the endodormancy phase to change with varying climatic conditions the impact of climate on observed and simulated bud break dates is expected to be complex because of the cumulative and antagonistic effects of temperature depending on the season on bud development chuine and regniere 2017 for this reason we also aimed at testing the parameter sensitivity of phenology models to climatic conditions we thus analyzed model behavior under specific patterns of winter and spring temperatures that produced either particularly early or late bud break date this study thus differ from that of lange et al 2016 which explored the behavior of phenology models in uniformly warmer or colder conditions all along the year in the present study we used different observed climatically contrasted years with their specific weather patterns using a sensitivity analysis approach we aimed at evaluating the parameter sensitivity of state of the art process based phenology models that have been widely used to predict bud break dates of forest tree species the main originalities of this study are to i compare the behavior of models with increasing complexity and ii perform this analysis under realistic and contrasted climatic conditions in order to better estimate how the relative influence of parameters on model prediction varies with specific weather patterns in winter and spring to perform this study we used historical climatic conditions encountered at different elevations in the pyrenees mountains to cover a large range of temperature variation without variation of the day length between sites more specifically we propose here to 1 evaluate whether increasing model complexity is related to higher interaction effects between parameters 2 identify key parameters and processes that cause the highest variability in the output of the models under different climatic regimes 3 assess the physiological plausibility of this sensitivity 4 discuss our outcome for future studies that will use phenology models to address key question in ecology and evolution in particular we expect parameters related to physiological responses to spring forcing temperatures to have a stronger impact on the prediction of the bud break date in cold environmental conditions and more generally in historical climatic conditions in western europe on the opposite we expect parameters related to endodormancy release requiring chilling conditions during winter to have an increasing influence on the prediction of models in warmer environmental conditions finally we expect parameter interactions to have a greater influence on the prediction of models with increasing model complexity 2 material and methods 2 1 process based phenology models process based phenology models see for review chuine and regniere 2017 are deeply grounded on experimental results which have accumulated over the last 50 years and describe how the development of buds from dormancy induction in fall to bud break in spring is determined by the individual or interactive effects of different environmental cues notably temperature and photoperiod most of these models are based on the same framework see chuine and regniere 2017 each development phase e g endodormancy ecodormancy is described by a submodel determining its reaction norms to various cues several response functions describing the reaction norms to various cues can combine by addition multiplication or composition development phases either are sequential follow each other in time or overlap a phase can start before the end of the previous one we chose three different kinds of model within this framework that represent the three main types of environmental regulation of bud break of either vegetative or reproductive buds in perennial species and are the most widely used in phenology studies uniforc chuine 2000 unichill chuine 2000 and pgc gauzere et al 2017 these models differ by their complexity and by the environmental cues they account for while uniforc and unichill are thermal ecodormancy and endo ecodormancy models respectively pgc is a photothermal endo ecodormancy model in the three models described below t 0 defines the beginning of the endo or ecodormant phase depending on the model t f the bud break date and f the critical amount of forcing units to reach bud break null the uniforc model is an one phase model describing the cumulative effect of forcing temperatures on the development of buds during the ecodormancy phase this model thus assumes that the endodormancy phase is always fully released and that there is no dynamic effects of chilling and photoperiod on forcing requirements bud break occurs when the rate of forcing r f eq 7 accumulated since t 0 reaches the critical state of forcing f 1 t 0 t f r f t f with t the daily average temperature unichill the unichill model is a sequential two phases model describing the cumulative effect of chilling temperatures on the development of buds during the endodormancy phase first phase and the cumulative effect of forcing temperatures during the ecodormancy phase like in the uniforc model bud break occurs when the accumulated rate of forcing r f reaches f eq 1 the start of the ecodormancy phase corresponds to the end of the endodormancy phase t c which occurs when the accumulated rate of chilling r c eq 8 has reached the critical state of chilling c 2 t 0 t c r c t c pgc the pgc model has been designed to explain bud break date of photosensitive species which might represent about 30 of the species zohner et al 2016 it has been shown to be particular relevant to simulate the bud break date of beech fagus sylvatica l which is one of the most photosensitive species for bud break gauzere et al 2017 this is a photothermal model that integrates the compensatory effect of photoperiod on insufficient chilling accumulation through a growth competence function gc gauzere et al 2017 the growth competence function describes the ability of buds to respond to forcing temperatures it modulates the rate of forcing r f through a multiplicative function to define the actual daily forcing units accumulated by the bud until bud break as 3 t 0 t f gc p r f t f with p and t the daily photoperiod and average temperature respectively the growth competence gc is related to the daily photoperiod through a sigmoid function 4 gc p 1 1 e d p p p 50 t with p 50 the mid response photoperiod and d p the positive slope of the sigmoid function p 50 is not constant and depends on the state of chilling cs the greater the accumulated rate of chilling the shorter the mid response photoperiod i e buds become sensitive to shorter photoperiod when they have accumulated chilling 5 p 50 cs 12 p r 2 p r 1 e d c cs t c 50 with p r the range boundaries of the parameter p 50 so that p 50 12 p r 12 p r d c the negative slope of the sigmoid function and c 50 is the mid response parameter if the sigmoid function reflecting chilling requirements under short day length finally chilling units accumulated as 6 cs t t 0 t r c t for the sake of comparison the version of the models used for this study have the same type of response functions to forcing and to chilling temperatures the response function to forcing temperature r f was defined as a sigmoid function as it has been shown to be the most realistic experimentally hanninen et al 1990 caffarra and donnelly 2011 7 r f t d 1 1 e d t t d t 50 with d t the positive slope and t 50 the mid response temperature of the sigmoid function we defined the rate of chilling r c as a threshold function caffarra et al 2011b 8 r c t d 1 if t d t b 0 if t d t b with t d the mean temperature of day d and t b the threshold temperature also called base temperature of the function as defined here the uniforc model has 4 parameters t 0 d t t 50 f the unichill model 6 parameters t 0 t b c d t t 50 f the pgc model 9 parameters t 0 t b c 50 p r d c d p d t t 50 f table 1 2 2 model calibration and validation in order to set up the sensitivity analysis design we first calibrated and validated the studied phenology models for three emblematic tree species in european forests common beech f sylvatica sessile oak quercus petraea l and silver fir abies alba mill these results were used to i define the natural parameter variation among tree species table 1 and ii identify contemporary climatic years that produced particularly early and late spring phenology appendix 4 the three models were parametrized for the three different species using observations of the bud break date in the pyrenees and corresponding weather data from 2005 to 2012 the phenology of several populations located at different elevations following the gave and ossau valleys in the pyrenees have been yearly monitored since 2005 the studied populations ranged from 131 to 1604 m 9 sites for beech from 131 to 1630 m 13 sites for oak and from 840 to 1604 m 6 sites for fir for further details about these populations see vitasse et al 2009 data used for this study consisted in the bud break date bbch 9 monitored from 2005 to 2012 in these populations models were parametrized using daily weather data since 2004 from prosensor hobo pro rh temp onset computer corporation bourne ma 02532 that have been placed at the core of each monitored population vitasse et al 2009 day length was calculated according to the latitude of the meteorological stations see caffarra et al 2011a using these datasets the three studied models were parametrized for each species following gauzere et al 2017 the models rmse varied from 5 85 to 10 days with mean rmse of 6 28 for beech 6 92 for oak 9 39 for fir appendix 3 2 3 sensitivity analysis to perform the sensitivity analysis we sampled 1 000 000 parameters combinations for each model to fully capture each parameter space to sample each parameter we used beta distributions for the slope parameter of the sigmoid functions eqs 4 5 and 7 and uniform distributions for other parameters appendix 5 the beta distribution was chosen to account for the fact that variations in shape parameters have differential effects on sigmoid responses variation in extreme shape values have a lowest impact on the global shape of the sigmoid function the bounds of the sampling distributions were defined according to two criteria i the sampled values needed to be biologically relevant i e make sense according to the empirical knowledge about the physiological responses and the adjusted values for the three species and ii produce positioned dates i e dates different from the last day of the year doy 365 due to these constraints all parameters do not have the same variance coefficient of variation ranging from 0 05 to 0 18 appendix 5 details the parameter values adjusted for each species in the parameter space explored for the sensitivity analysis two different sensitivity indexes describing the proportion of variance of the model s output y here bud break date explained by the variation of a given parameter x i were calculated from the sobol and sobol jansen methods implemented in the package sensitivity of the r software these two methods implement the monte carlo estimation of the variance based method for sensitivity analysis proposed by sobol 1993 more precisely these functions allow estimating the first order and total effect indexes from the variance decomposition sometimes referred to as functional anova decomposition the first order index is defined as 9 s i var xi e x i y x i var y with 10 i 1 n s i 1 s i 0 y is the prediction and x i is the ith parameter of the model the notation x i indicates the set of all variables except x i the numerator represents the contribution of the main effect of x i to the variation in the output i e the effect of varying x i alone but averaged over variations in other input parameters s i is standardized by the total variance to provide the fractional contribution of each parameter i and total effect index as 11 s ti e x i var xi y x i var y 1 var x i e xi y x i var y with 12 i 1 n s ti 1 s ti 0 due to the interaction effect e g x i and x j both counted in s ti and s tj s ti thus measures the contribution of x i to the variation in the output including all variances caused by its interactions with any other input variables 2 4 climatic data used for the sensitivity analysis to perform the sensitivity analysis we used the climate simulated at different elevations over a gradient of 1000 m for the period from 1956 to 2012 in order to explore a large range of climatic conditions to study the response of the models to realistic climate at different elevations we used measurements taken with local weather stations on three forest sites at 627 1082 and 1630 m a s l along the gave valley prosensor hobo pro vitasse et al 2009 as this weather dataset only covered the period from 2004 to 2012 we also used météo france measurements at other stations located close to these sites and data from the safran reanalysis on the points of the systematic grid located in the valley to simulate the climate at the forest sites over a larger period 1959 2012 the temperature data recorded with the local hobo sensors were linearly correlated to the climatic data derived by the safran model of météo france quintana segui et al 2008 for the same period daily minimum and maximum temperature data from 1960 to 2012 were generated based on the long term safran outputs using the following equation 13 t x β t x α t x t safran with x the targeted site β t and α t the intercept and the slope of the linear regression between t safran and t hobo for the period 2004 2012 the coefficients used for this equation are provided in appendix 1 day length was calculated according to the latitude of the forest sites see caffarra et al 2011a over this large simulated period we chose three climatically contrasted years that corresponded to 1 a year with winter and spring mean temperatures close to their global mean over the 1960 2012 period normal climatic year year 1966 2 a year expected to produce early spring phenology i e with cooler winter and warmer spring temperatures than normal early climatic year year 2011 and 3 a year expected to produce late spring phenology i e with warmer winter and cooler spring temperatures than normal late climatic year year 1975 table 2 appendix 2 we checked that the three years selected indeed generated early average and late bud break dates using the adjusted models for different tree species appendix 4 this range of climatic conditions allowed us to credibly investigate the impact of specific weather patterns in winter and spring on the behavior of the models 3 results 3 1 main trends in parameter sensitivity of phenology models for the three models the mid response temperature during the ecodormancy t 50 had the greatest influence on the predictions of the models in most of the climatic conditions explored except in the cool winter warm spring conditions producing early phenology fig 1 and see appendices 6 7 and 8 for detailed results this strong influence is both due to the main effect of t 50 and its interaction with other parameters and especially with d t t 50 d t defining the shape of the forcing response during the ecodormancy phase under the conditions producing early phenology the main parameters affecting the predicted bud break date were t 0 t 50 and f for uniforc unichill and pgc respectively fig 1a note that the influence of the parameters on the predictions of the models was significantly affected by their coefficient of variation i e parameters that had the highest variation also had the highest influence fig 2 however this effect only explained a small proportion of the total variation in the total effect of the parameters r 2 0 29 3 2 the sensitivity to model parameters varies with model complexity the sensitivity of model predictions to the variation in model parameters highly depended on the phases and processes modeled fig 1 predictions of the ecodormancy model uniforc were more sensitive to the t 0 parameter i e the model starting date than the predictions of the endo ecodormancy models unichill and pgc particularly under the climatic conditions producing early phenology fig 1a and b predictions of the thermal model unichill were more sensitive to the critical amount of chilling to release dormancy c parameter than the predictions of the photothermal model pgc to the equivalent parameter c 50 predictions of this latter photothermal model was more sensitive to the critical amount of forcing f than that of the thermal models uniforc and unichill finally predictions of the unichill model were more sensitive to the mid response temperature during ecodormancy t 50 than that of the uniforc and pgc models which presented similar sensitivity to this parameter fig 1 depending on the model complexity the uncertainty in the predictions will thus reply in the accurate calibration of different key parameters 3 3 the sensitivity to model parameters varies with climate the sensitivity of the model predictions to the variation in model parameters also changed according to the climatic conditions experienced during winter and spring fig 3 in the three models the sensitivity of the predictions to the mid response temperature during ecodormancy t 50 decreased with warming temperature fig 3 while the sensitivity to the parameters driving the endodormancy phase e g t 0 in the uniforc model c in the unichill model d p and c 50 in the pgc model increased with warming temperature fig 3 the sensitivity of the endo ecodormancy models to the critical amount of forcing to reach bud break f was also higher in warmer conditions this is probably because even if forcing accumulation becomes less limiting with warming temperature f still represents the minimum duration of the ecodormancy phase and thus strongly drives bud break date the sensitivity of the predictions of the pgc model to both the critical amount of chilling c 50 and the parameter determining the sensitivity to photoperiod d p increased with warming temperature fig 3 but in such conditions the sensitivity of pgc model predictions to the photoperiod related parameter was higher than that to chilling related parameters c 50 and t b fig 3 finally the sensitivity of pgc model predictions to the starting date of endodormancy t 0 tended to increase with warming temperature conditions while that of the unichill model remained constant and low fig 3 this result may be explained by the differences in growth competence modeling between these two models the growth competence function of the pgc model is not null in autumn but decreases with the decreasing day length and induces endodormancy if temperature conditions are particularly favorable some forcing units can be accumulated before endodormancy is fully induced contrary to the unichill model this therefore gives an increasing importance to t 0 in driving bud break dates in warmer temperature conditions for the three models the increasing influence of the endodormancy vs ecodormancy related parameters on bud break date predictions can already be noticed in warm winter conditions 3 4 main and interaction effects in the results above we describe the influence of the parameters on the predictions of the models based on their total effect which include both main and second order interaction effects however it is also interesting to decompose these effects to understand their relative contributions to the variation of bud break dates for most parameters the total effects were mainly due to main or first order effects and in a lesser extend to interaction effects between parameters or second order effects fig 1 second order effects always explained less than 15 of the predictions variation while the largest first order effect explained more than 50 of the output variation fig 4 and appendix 9 interestingly interaction effects did not modify the relative influence of the parameters on the predictions of the models fig 1 nevertheless total interaction effects represented an important source of variation in the predicted bud break dates fig 4 in particular for the most complex models the total influence of interaction effects on model predictions also varied with the specific weather patterns in winter and spring for uniforc total interaction effects were found to be more important in the warm winter cool spring conditions producing late phenology while for pgc these effects were more important in the cool winter warm spring conditions producing early phenology fig 4a and c the interaction between the parameters t 50 and d t had the largest effect on the predicted bud break date notably in the coldest temperature conditions d t t 50 appendix 9 these two parameters define the shape of the response to temperature during ecodormancy in the three models for the pgc model in the warmest climatic conditions the interaction between the endodormancy starting date t 0 and the photoperiod sensitivity d p also had an impact on the predicted bud break date t 0 d p appendix 9 the influence of interaction effects thus tended to increase with model complexity but also varied with specific weather patterns in winter and spring 4 discussion 4 1 bud break date predictions mainly depend on the forcing response under current climatic conditions the sensitivity analysis of the studied process based models showed that the mid response temperature of the ecodormancy phase called here t 50 plays a critical role in the prediction of bud break date under current climatic conditions this result applies whether models account or not for an endodormancy phase or a photoperiodic control of bud development it therefore suggests that the response to forcing temperature during the ecodormancy defined by both t 50 and d t in the studied phenological models is a major physiological response driving the variation of bud break dates in temperate plant species in historical and current climatic conditions this finding is consistent with previous correlative modeling studies showing that bud break date variation was mainly driven by the mean temperature of the two preceding months which roughly corresponds to the ecodormancy phase e g menzel et al 2006 it is also consistent with previous process based modeling studies showing that models simulating only the ecodormancy phase explained as much variance in bud break dates as models simulating both the endo and ecodormancy phases linkosalo et al 2006 gauzere et al 2017 the similar performance of the two types of model suggested either that the fulfillment of chilling requirements had not been a limiting factor so far or that the endodormancy phase is not accurately modeled linkosalo et al 2006 chuine et al 2016 our results support the first hypothesis i e winter chilling temperature have played a minor role in bud break variations so far which also explains why the response of plant species to climate warming has so far resulted in an advancement of the bud break dates menzel et al 2006 a methodological consequence of this is that phenological records in natural populations may not allow estimating accurately endodormancy model parameters chuine et al 2016 4 2 bud break date predictions are increasingly dependent on chilling temperatures and photoperiod as climate warms we found that the effect of the reaction norm to forcing temperature on the prediction of the bud break date decreased with warming spring conditions while the effect of chilling accumulation during the endodormancy phase increased with warming winter temperature for the thermal endo ecodormancy models unichill and pgc this suggests that in warmer environmental conditions reaction norms to temperature during both bud endodormancy and ecodormancy are critical in determining bud break dates this result is supported by several recent experimental studies showing that temperature sensitivity of the bud break dates was currently decreasing likely due to an increasing influence of warming winters on bud endodormancy fu et al 2015a b vitasse et al 2018b asse et al 2018 in particular vitasse et al 2018b showed that a differential response to chilling temperatures between trees living at low and high elevations may explain the difference in the temporal trends of bud break date advancement observed at different elevations with warming conditions during the last decade overall these results highlight that the influence of chilling temperatures on bud development can no longer be overlooked and that the correct estimation of the parameters governing the endodormancy phase is required to accurately predict bud break the sensitivity analysis of the photothermal endo ecodormancy model pgc showed that the influence of the photoperiodic response through the d p parameter on the prediction of the bud break date increased in warmer environmental conditions a growing number of studies suggest that the phenology of up to 30 of tree species might be sensitive to photoperiod at various degrees laube et al 2014 zohner et al 2016 understanding how this increasing effect of the photoperiodic cue will affect the variation of bud break dates in future climatic conditions is an issue still debated fu et al 2015b gauzere et al 2017 however in the most sensitive species such as beech it has been suggested that this sensitivity may counteract the negative effect of insufficient chilling during winter gauzere et al 2017 our results thus highlight that a stronger focus should be given to the modeling of the reaction norm to photoperiod to be able to accurately predict bud break dates of up to 30 of tree species in future climatic conditions 4 3 originality and limits of the study only a few studies have performed sensitivity analysis of phenology models so far they either analyzed the behavior of phenology models identified the main sources of uncertainties in bud break date predictions or assessed the consequences of phenological uncertainties on related processes e g morin and chuine 2005 migliavacca et al 2012 zhang et al 2014 lange et al 2016 a key results from these previous studies is that uncertainty in climate conditions notably generated by climate scenarios was a greater source of variation in phenological date projections than uncertainty in phenology models migliavacca et al 2012 to our knowledge this study is the first to have compared the behavior of different phenology models with increasing complexity and to perform this analysis under different weather patterns in winter and spring the results found here are in line with a recent sensitivity analysis of species specific phenology models which found an increasing importance of chilling requirements and photoperiod in warm climatic conditions for temperate tree species lange et al 2016 the consistency of our results with the sensitivity analysis of other phenology models strengthens the scope of our study and thus further stress the importance of investigating the behavior of phenology models in contrasted climatic conditions in order to fully embrace their robustness while the climate we used to perform the sensitivity analyses covers a small geographical region it still explores a large range of variation in winter and spring average temperatures t novdec 2 07 8 97 t maraprnay 5 56 14 52 this temperature variation is less important than in other sensitivity analyses e g lange et al 2016 but it is large enough to allow extrapolating the results of this study at larger spatial scales the aim of the present study was not to investigate the behavior of phenology models under climate change scenarios nevertheless by extrapolating our results on the impact of warming conditions on parameter sensitivity we can expect the influence of the parameters governing the endodormancy to overall have more influence on bud break date predictions in the future due to the high computational requirement of sensitivity analyses most studies usually neglect partially or completely interaction effects between model parameters as a source of output variation e g lange et al 2016 however the complexity of process based phenology models tends to increase as we gain better knowledge about the physiological processes involved in bud development with increasing model complexity and realism we can expect interaction effects to have non negligible influence on the prediction of the models and thus local sensitivity analysis to partially reveal the effect of parameters on output variance our results also suggest that model complexity would result in higher uncertainty in bud break dates because of interaction effects moreover increasing model complexity would generate higher uncertainty in model outputs because of parameter compensation during the statistical adjustment notably if models are used to perform predictions outside of the range of the climatic conditions used to adjust them gauzere et al 2017 here we showed that sensitivity analysis of process based phenology models are relevant to identify key parameters and processes that have the largest effect on phenology migliavacca et al 2012 lange et al 2016 however the choice of the parameter variation range likely affects the results of such analyses since for most plant species the range limits or shape of the distributions of the physiological parameters in natural populations are unknown such sensitivity analyses rely on assumptions that cannot be tested here we might have overestimated the real contribution of t 50 and f to the variation of the bud break date due to uneven variances in parameter sampling distributions this effect of parameter variation on the outcome of sensitivity analyses should be more acknowledged to improve the scope and relevance of sensitivity analyses more attention should be given to the characterization of the natural variation of the physiological parameters described in process based models e g burghardt et al 2015 4 4 implications for the adaptive potential of phenological traits while the sensitivity analysis of phenology models has direct implications for ecological and climate change studies we wanted to highlight also here their usefulness for evolutionary studies the bud break date is among the most genetically differentiated trait across species distribution ranges de kort et al 2013 suggesting that it is strongly involved in the process of local genetic adaptation evolutionary response of the bud break date is expected to depend on which parameters present genetic variation and how this variation impacts the bud break date i e the expressed trait variation sensitivity analysis outputs can be used to address this second issue for example our results show that the mid response temperature of the ecodormancy phase t 50 has the highest impact on the variation of the bud break date in most conditions we thus suggest that future experimental research consider measuring the genetic variation of this key physiological trait in natural populations and crops to evaluate their adaptive potential this can be done by monitoring bud break of several genotypes either in varying controlled conditions e g caffarra et al 2011b or by monitoring growth transcriptor factors in natura or in the field using new transcriptomic technics e g nagano et al 2012 or even better by combining both approaches e g satake et al 2013 given the increasing importance of the response to chilling temperatures during the endodormancy phase to determine the bud break date in warming conditions future experimental research might additionally consider measuring the genetic variation in chilling requirement and reaction norms to chilling temperature especially in species requiring large amount of chilling finally future experimental research should consider measuring the genetic variation in the reaction norm to photoperiod in most sensitive species and notably beech goyne et al 1989 for example in crops 5 conclusions the identification of the physiological responses underlying the bud break date variation in current environmental conditions is an important on going experimental research field fu et al 2015a b vitasse et al 2018b assuming that process based phenology models reflect real physiological responses and processes the analysis of their behavior under contrasted climatic conditions can provide valuable information about this issue our results highlighted the major influence of the response to forcing temperature on the prediction of the bud break date but also an increasing importance of the responses to chilling temperature and photoperiod in warming environmental conditions changes in the sensitivity of the prediction of phenology models to their parameters with climatic conditions highlights that we need to better take into account the temporal and spatial variation of environmental conditions when analyzing phenological changes vitasse et al 2018b more generally we acknowledge here that the sensitivity analysis of process based models is a useful tool to understand the relative contributions of environmental cues in driving phenotypic traits variation and their evolutionary potential donohue et al 2015 burghardt et al 2015 lange et al 2016 conflict of interest the authors have no conflict of interest to declare acknowledgements we thank claude bruchou and guillaume marie for helpful discussions on the approach and results of this manuscript we thank also two anonymous reviewers for their constructive comments which helped us improving previous versions of this article this study was funded by the anr 13 adap 0006 project mecc supplementary data supplementary data associated with this article can be found in the online version at https doi org 10 1016 j ecolmodel 2019 108805 supplementary data the following are the supplementary data to this article 
24975,the phenology of plants is a major driver of agro ecosystem processes and biosphere feedbacks to the climate system phenology models are classically used in ecology and agronomy to project future phenological changes with our increasing understanding of the environmental cues affecting bud development phenology models also increase in complexity but we expect these cues and the underlying physiological processes to have varying influence on bud break date predictions depending on the specific weather patterns in winter and spring here we evaluated the parameter sensitivity of state of the art process based phenology models that have been widely used to predict forest tree species phenology we used sensitivity analysis to compare the behavior of models with increasing complexity under specific climatic conditions we thus assessed whether the influence of the parameters and modeled processes on predictions varies with winter and spring temperatures we found that the prediction of the bud break date was mainly affected by the response to forcing temperature under current climatic conditions however the impact of the parameters driving the response to chilling temperatures and to photoperiod on the prediction of the models increased with warmer winter and spring temperatures interaction effects between parameters played an important role on the prediction of models especially for the most complex models but did not affect the relative influence of parameters on bud break dates our results highlighted that a stronger focus should be given to the characterization of the reaction norms to both forcing and chilling temperature to predict accurately bud break dates in a larger range of climatic conditions and evaluate the evolutionary potential of phenological traits with climate change keywords sensitivity analysis process based modeling bud development forcing temperature chilling temperature photoperiod 1 introduction bud break is a key phenological event that affects plant performance by defining the period during which plants are able to grow photosynthesize and produce their seeds therefore the phenology of plants is a major driver of agro ecosystem processes cleland et al 2007 and biosphere feedbacks to the climate system richardson et al 2013 it drives ecosystem productivity richardson et al 2012 carbon delpierre et al 2009 water hogg et al 2000 and nutrient cooke and weih 2005 cycling processes as well as energy balance wilson and baldocchi 2000 moreover plant phenology critically affects yield and organoleptic quality of crop harvest nissanka et al 2015 as well as species distributions chuine 2010 the onset of plant activity has been reported to advance by 2 5 days per decade on average during the last 50 years menzel et al 2006 potentially increasing the risk of frost damages on flowers and leaves vitasse et al 2018a these rapid responses have been shown to be highly species specific and are expected to have major consequences on species interactions species distributions ecosystem functioning and forest carbon uptake cleland et al 2007 chuine 2010 richardson et al 2013 therefore accurately predicting plant species phenology at both large and local scales is of key importance for assessing the impact of global change on agro ecosystems and the multiple services they provide as well as species range shift and populations local extinction fu et al 2015b showed however that the linear trend towards earlier spring onset had been slowing down significantly during the last two decades one of the hypotheses put forward by the authors to explain this slowdown is the warming of winters and indeed recently asse et al 2018 documented the negative effect of the warming of winter on the leaf unfolding and flowering date of several tree species air temperature is the major environmental factor regulating the dates of budburst and flowering of plants rathcke and lacey 1985 polgar and primack 2011 in perennial species temperature has an antagonistic effect on bud development depending on the season low temperature called chilling are required to release the endodormancy of buds during winter which is characterized by the inability of bud cells to growth despite optimal growing conditions while higher temperature called forcing are required to promote bud cell elongation in spring recently the effect of long photoperiod in compensating the lack of chilling temperature has also been reported for some tree species laube et al 2014 way and montgomery 2015 zohner et al 2016 our understanding of the environmental cues affecting species specific bud break dates has been increasing thanks to the compilation of large phenological datasets menzel et al 2006 fu et al 2015b and to experimental work in controlled conditions using growth chambers e g caffarra and donnelly 2011 zohner et al 2016 this empirical knowledge has been essential for the development and calibration of process based phenology models chuine and regniere 2017 that are used to predict spring phenology over large spatial and temporal scales e g chuine et al 2016 gauzere et al 2017 while the relative contribution of environmental cues in driving spring phenological responses in current and future climatic conditions is still debated for most species chuine and regniere 2017 laube et al 2014 fu et al 2015a b the recent declining of the response of spring onset to global warming suggests that the relative influence of environmental cues driving the endodormancy phase varies with climatic conditions since climate change is likely to generate non equilibrium conditions the relative influence of the environmental cues might also not remain constant over time overall a strong expectation is that the environmental cues releasing endodormancy should have an increasing influence in warmer environmental conditions yet comprehensive analysis of the behavior of phenology models in different climates are still lacking while pioneer modeling studies in crops have shown that it is expected to change depending on ecological conditions e g yin et al 2005 zhang et al 2014 recently huber et al 2018 highlighted the importance of improving our understanding of models behavior and identifying key parameters and processes that have the strongest effects on model predictions under different ecological conditions it is a major stage to enhance model applications across large spatial and temporal scales as well as the robustness of model projections we embrace this view and acknowledge here the usefulness of sensitivity analysis to reach this general objective sensitivity analyses are interesting statistical tools to address the impact of parameters variations on the outputs of models cariboni et al 2007 allowing to evaluate both intrinsic i e model structure and parameters and extrinsic i e model inputs sources of variation they can also highlight model limitations and directions for further improvements saltelli et al 2000 cariboni et al 2007 therefore they represent an important step in the modeling cycle saltelli et al 2000 cariboni et al 2007 augusiak et al 2014 courbaud et al 2015 for forest tree species most studies in phenology modeling have focused on the analysis of extrinsic sources of variation e g investigating the uncertainty of climatic inputs on simulations morin and chuine 2005 migliavacca et al 2012 ecological studies interested in intrinsic sources of variation most often evaluate the effect of the variation of single parameters on the model outputs other parameters remaining fixed at a given default value e g lange et al 2016 the major disadvantage of this approach is to neglect possible interactions among parameters and to be unreliable in presence of non linear relationships between the parameters and the model predictions coutts and yokomizo 2014 at the opposite sensitivity analyses varying all parameters simultaneously allow to account for parameter interactions and non linear relationships and providing robust sensitivity measures for complex simulation models while phenology model complexity is increasing with our understanding of the physiological responses involved in bud development these interaction effects and non linear relationships can no more be overlooked a first originality and aim of this study was thus to compare the behavior of phenology models with increasing complexity and to disentangle the main and interaction effects of parameters on bud break date predictions the most commonly used phenology models are process based meaning that they describe known or suspected cause effect relationships between physiological processes and some driving factors in the organism s environment to predict the precise occurrence in time of various phenology events see for review chuine and regniere 2017 the parameters of these models are either defined using parameter values measured in experimental controlled conditions or statistically inferred from phenological and meteorological data using inverse modeling techniques since they describe causal relationships derived from experimental work the sensitivity analysis of process based models is supposed to reflect the sensitivity of the real processes saltelli et al 2000 therefore we can expect the sensitivity of phenology models to specific parameters e g driving the endodormancy phase to change with varying climatic conditions the impact of climate on observed and simulated bud break dates is expected to be complex because of the cumulative and antagonistic effects of temperature depending on the season on bud development chuine and regniere 2017 for this reason we also aimed at testing the parameter sensitivity of phenology models to climatic conditions we thus analyzed model behavior under specific patterns of winter and spring temperatures that produced either particularly early or late bud break date this study thus differ from that of lange et al 2016 which explored the behavior of phenology models in uniformly warmer or colder conditions all along the year in the present study we used different observed climatically contrasted years with their specific weather patterns using a sensitivity analysis approach we aimed at evaluating the parameter sensitivity of state of the art process based phenology models that have been widely used to predict bud break dates of forest tree species the main originalities of this study are to i compare the behavior of models with increasing complexity and ii perform this analysis under realistic and contrasted climatic conditions in order to better estimate how the relative influence of parameters on model prediction varies with specific weather patterns in winter and spring to perform this study we used historical climatic conditions encountered at different elevations in the pyrenees mountains to cover a large range of temperature variation without variation of the day length between sites more specifically we propose here to 1 evaluate whether increasing model complexity is related to higher interaction effects between parameters 2 identify key parameters and processes that cause the highest variability in the output of the models under different climatic regimes 3 assess the physiological plausibility of this sensitivity 4 discuss our outcome for future studies that will use phenology models to address key question in ecology and evolution in particular we expect parameters related to physiological responses to spring forcing temperatures to have a stronger impact on the prediction of the bud break date in cold environmental conditions and more generally in historical climatic conditions in western europe on the opposite we expect parameters related to endodormancy release requiring chilling conditions during winter to have an increasing influence on the prediction of models in warmer environmental conditions finally we expect parameter interactions to have a greater influence on the prediction of models with increasing model complexity 2 material and methods 2 1 process based phenology models process based phenology models see for review chuine and regniere 2017 are deeply grounded on experimental results which have accumulated over the last 50 years and describe how the development of buds from dormancy induction in fall to bud break in spring is determined by the individual or interactive effects of different environmental cues notably temperature and photoperiod most of these models are based on the same framework see chuine and regniere 2017 each development phase e g endodormancy ecodormancy is described by a submodel determining its reaction norms to various cues several response functions describing the reaction norms to various cues can combine by addition multiplication or composition development phases either are sequential follow each other in time or overlap a phase can start before the end of the previous one we chose three different kinds of model within this framework that represent the three main types of environmental regulation of bud break of either vegetative or reproductive buds in perennial species and are the most widely used in phenology studies uniforc chuine 2000 unichill chuine 2000 and pgc gauzere et al 2017 these models differ by their complexity and by the environmental cues they account for while uniforc and unichill are thermal ecodormancy and endo ecodormancy models respectively pgc is a photothermal endo ecodormancy model in the three models described below t 0 defines the beginning of the endo or ecodormant phase depending on the model t f the bud break date and f the critical amount of forcing units to reach bud break null the uniforc model is an one phase model describing the cumulative effect of forcing temperatures on the development of buds during the ecodormancy phase this model thus assumes that the endodormancy phase is always fully released and that there is no dynamic effects of chilling and photoperiod on forcing requirements bud break occurs when the rate of forcing r f eq 7 accumulated since t 0 reaches the critical state of forcing f 1 t 0 t f r f t f with t the daily average temperature unichill the unichill model is a sequential two phases model describing the cumulative effect of chilling temperatures on the development of buds during the endodormancy phase first phase and the cumulative effect of forcing temperatures during the ecodormancy phase like in the uniforc model bud break occurs when the accumulated rate of forcing r f reaches f eq 1 the start of the ecodormancy phase corresponds to the end of the endodormancy phase t c which occurs when the accumulated rate of chilling r c eq 8 has reached the critical state of chilling c 2 t 0 t c r c t c pgc the pgc model has been designed to explain bud break date of photosensitive species which might represent about 30 of the species zohner et al 2016 it has been shown to be particular relevant to simulate the bud break date of beech fagus sylvatica l which is one of the most photosensitive species for bud break gauzere et al 2017 this is a photothermal model that integrates the compensatory effect of photoperiod on insufficient chilling accumulation through a growth competence function gc gauzere et al 2017 the growth competence function describes the ability of buds to respond to forcing temperatures it modulates the rate of forcing r f through a multiplicative function to define the actual daily forcing units accumulated by the bud until bud break as 3 t 0 t f gc p r f t f with p and t the daily photoperiod and average temperature respectively the growth competence gc is related to the daily photoperiod through a sigmoid function 4 gc p 1 1 e d p p p 50 t with p 50 the mid response photoperiod and d p the positive slope of the sigmoid function p 50 is not constant and depends on the state of chilling cs the greater the accumulated rate of chilling the shorter the mid response photoperiod i e buds become sensitive to shorter photoperiod when they have accumulated chilling 5 p 50 cs 12 p r 2 p r 1 e d c cs t c 50 with p r the range boundaries of the parameter p 50 so that p 50 12 p r 12 p r d c the negative slope of the sigmoid function and c 50 is the mid response parameter if the sigmoid function reflecting chilling requirements under short day length finally chilling units accumulated as 6 cs t t 0 t r c t for the sake of comparison the version of the models used for this study have the same type of response functions to forcing and to chilling temperatures the response function to forcing temperature r f was defined as a sigmoid function as it has been shown to be the most realistic experimentally hanninen et al 1990 caffarra and donnelly 2011 7 r f t d 1 1 e d t t d t 50 with d t the positive slope and t 50 the mid response temperature of the sigmoid function we defined the rate of chilling r c as a threshold function caffarra et al 2011b 8 r c t d 1 if t d t b 0 if t d t b with t d the mean temperature of day d and t b the threshold temperature also called base temperature of the function as defined here the uniforc model has 4 parameters t 0 d t t 50 f the unichill model 6 parameters t 0 t b c d t t 50 f the pgc model 9 parameters t 0 t b c 50 p r d c d p d t t 50 f table 1 2 2 model calibration and validation in order to set up the sensitivity analysis design we first calibrated and validated the studied phenology models for three emblematic tree species in european forests common beech f sylvatica sessile oak quercus petraea l and silver fir abies alba mill these results were used to i define the natural parameter variation among tree species table 1 and ii identify contemporary climatic years that produced particularly early and late spring phenology appendix 4 the three models were parametrized for the three different species using observations of the bud break date in the pyrenees and corresponding weather data from 2005 to 2012 the phenology of several populations located at different elevations following the gave and ossau valleys in the pyrenees have been yearly monitored since 2005 the studied populations ranged from 131 to 1604 m 9 sites for beech from 131 to 1630 m 13 sites for oak and from 840 to 1604 m 6 sites for fir for further details about these populations see vitasse et al 2009 data used for this study consisted in the bud break date bbch 9 monitored from 2005 to 2012 in these populations models were parametrized using daily weather data since 2004 from prosensor hobo pro rh temp onset computer corporation bourne ma 02532 that have been placed at the core of each monitored population vitasse et al 2009 day length was calculated according to the latitude of the meteorological stations see caffarra et al 2011a using these datasets the three studied models were parametrized for each species following gauzere et al 2017 the models rmse varied from 5 85 to 10 days with mean rmse of 6 28 for beech 6 92 for oak 9 39 for fir appendix 3 2 3 sensitivity analysis to perform the sensitivity analysis we sampled 1 000 000 parameters combinations for each model to fully capture each parameter space to sample each parameter we used beta distributions for the slope parameter of the sigmoid functions eqs 4 5 and 7 and uniform distributions for other parameters appendix 5 the beta distribution was chosen to account for the fact that variations in shape parameters have differential effects on sigmoid responses variation in extreme shape values have a lowest impact on the global shape of the sigmoid function the bounds of the sampling distributions were defined according to two criteria i the sampled values needed to be biologically relevant i e make sense according to the empirical knowledge about the physiological responses and the adjusted values for the three species and ii produce positioned dates i e dates different from the last day of the year doy 365 due to these constraints all parameters do not have the same variance coefficient of variation ranging from 0 05 to 0 18 appendix 5 details the parameter values adjusted for each species in the parameter space explored for the sensitivity analysis two different sensitivity indexes describing the proportion of variance of the model s output y here bud break date explained by the variation of a given parameter x i were calculated from the sobol and sobol jansen methods implemented in the package sensitivity of the r software these two methods implement the monte carlo estimation of the variance based method for sensitivity analysis proposed by sobol 1993 more precisely these functions allow estimating the first order and total effect indexes from the variance decomposition sometimes referred to as functional anova decomposition the first order index is defined as 9 s i var xi e x i y x i var y with 10 i 1 n s i 1 s i 0 y is the prediction and x i is the ith parameter of the model the notation x i indicates the set of all variables except x i the numerator represents the contribution of the main effect of x i to the variation in the output i e the effect of varying x i alone but averaged over variations in other input parameters s i is standardized by the total variance to provide the fractional contribution of each parameter i and total effect index as 11 s ti e x i var xi y x i var y 1 var x i e xi y x i var y with 12 i 1 n s ti 1 s ti 0 due to the interaction effect e g x i and x j both counted in s ti and s tj s ti thus measures the contribution of x i to the variation in the output including all variances caused by its interactions with any other input variables 2 4 climatic data used for the sensitivity analysis to perform the sensitivity analysis we used the climate simulated at different elevations over a gradient of 1000 m for the period from 1956 to 2012 in order to explore a large range of climatic conditions to study the response of the models to realistic climate at different elevations we used measurements taken with local weather stations on three forest sites at 627 1082 and 1630 m a s l along the gave valley prosensor hobo pro vitasse et al 2009 as this weather dataset only covered the period from 2004 to 2012 we also used météo france measurements at other stations located close to these sites and data from the safran reanalysis on the points of the systematic grid located in the valley to simulate the climate at the forest sites over a larger period 1959 2012 the temperature data recorded with the local hobo sensors were linearly correlated to the climatic data derived by the safran model of météo france quintana segui et al 2008 for the same period daily minimum and maximum temperature data from 1960 to 2012 were generated based on the long term safran outputs using the following equation 13 t x β t x α t x t safran with x the targeted site β t and α t the intercept and the slope of the linear regression between t safran and t hobo for the period 2004 2012 the coefficients used for this equation are provided in appendix 1 day length was calculated according to the latitude of the forest sites see caffarra et al 2011a over this large simulated period we chose three climatically contrasted years that corresponded to 1 a year with winter and spring mean temperatures close to their global mean over the 1960 2012 period normal climatic year year 1966 2 a year expected to produce early spring phenology i e with cooler winter and warmer spring temperatures than normal early climatic year year 2011 and 3 a year expected to produce late spring phenology i e with warmer winter and cooler spring temperatures than normal late climatic year year 1975 table 2 appendix 2 we checked that the three years selected indeed generated early average and late bud break dates using the adjusted models for different tree species appendix 4 this range of climatic conditions allowed us to credibly investigate the impact of specific weather patterns in winter and spring on the behavior of the models 3 results 3 1 main trends in parameter sensitivity of phenology models for the three models the mid response temperature during the ecodormancy t 50 had the greatest influence on the predictions of the models in most of the climatic conditions explored except in the cool winter warm spring conditions producing early phenology fig 1 and see appendices 6 7 and 8 for detailed results this strong influence is both due to the main effect of t 50 and its interaction with other parameters and especially with d t t 50 d t defining the shape of the forcing response during the ecodormancy phase under the conditions producing early phenology the main parameters affecting the predicted bud break date were t 0 t 50 and f for uniforc unichill and pgc respectively fig 1a note that the influence of the parameters on the predictions of the models was significantly affected by their coefficient of variation i e parameters that had the highest variation also had the highest influence fig 2 however this effect only explained a small proportion of the total variation in the total effect of the parameters r 2 0 29 3 2 the sensitivity to model parameters varies with model complexity the sensitivity of model predictions to the variation in model parameters highly depended on the phases and processes modeled fig 1 predictions of the ecodormancy model uniforc were more sensitive to the t 0 parameter i e the model starting date than the predictions of the endo ecodormancy models unichill and pgc particularly under the climatic conditions producing early phenology fig 1a and b predictions of the thermal model unichill were more sensitive to the critical amount of chilling to release dormancy c parameter than the predictions of the photothermal model pgc to the equivalent parameter c 50 predictions of this latter photothermal model was more sensitive to the critical amount of forcing f than that of the thermal models uniforc and unichill finally predictions of the unichill model were more sensitive to the mid response temperature during ecodormancy t 50 than that of the uniforc and pgc models which presented similar sensitivity to this parameter fig 1 depending on the model complexity the uncertainty in the predictions will thus reply in the accurate calibration of different key parameters 3 3 the sensitivity to model parameters varies with climate the sensitivity of the model predictions to the variation in model parameters also changed according to the climatic conditions experienced during winter and spring fig 3 in the three models the sensitivity of the predictions to the mid response temperature during ecodormancy t 50 decreased with warming temperature fig 3 while the sensitivity to the parameters driving the endodormancy phase e g t 0 in the uniforc model c in the unichill model d p and c 50 in the pgc model increased with warming temperature fig 3 the sensitivity of the endo ecodormancy models to the critical amount of forcing to reach bud break f was also higher in warmer conditions this is probably because even if forcing accumulation becomes less limiting with warming temperature f still represents the minimum duration of the ecodormancy phase and thus strongly drives bud break date the sensitivity of the predictions of the pgc model to both the critical amount of chilling c 50 and the parameter determining the sensitivity to photoperiod d p increased with warming temperature fig 3 but in such conditions the sensitivity of pgc model predictions to the photoperiod related parameter was higher than that to chilling related parameters c 50 and t b fig 3 finally the sensitivity of pgc model predictions to the starting date of endodormancy t 0 tended to increase with warming temperature conditions while that of the unichill model remained constant and low fig 3 this result may be explained by the differences in growth competence modeling between these two models the growth competence function of the pgc model is not null in autumn but decreases with the decreasing day length and induces endodormancy if temperature conditions are particularly favorable some forcing units can be accumulated before endodormancy is fully induced contrary to the unichill model this therefore gives an increasing importance to t 0 in driving bud break dates in warmer temperature conditions for the three models the increasing influence of the endodormancy vs ecodormancy related parameters on bud break date predictions can already be noticed in warm winter conditions 3 4 main and interaction effects in the results above we describe the influence of the parameters on the predictions of the models based on their total effect which include both main and second order interaction effects however it is also interesting to decompose these effects to understand their relative contributions to the variation of bud break dates for most parameters the total effects were mainly due to main or first order effects and in a lesser extend to interaction effects between parameters or second order effects fig 1 second order effects always explained less than 15 of the predictions variation while the largest first order effect explained more than 50 of the output variation fig 4 and appendix 9 interestingly interaction effects did not modify the relative influence of the parameters on the predictions of the models fig 1 nevertheless total interaction effects represented an important source of variation in the predicted bud break dates fig 4 in particular for the most complex models the total influence of interaction effects on model predictions also varied with the specific weather patterns in winter and spring for uniforc total interaction effects were found to be more important in the warm winter cool spring conditions producing late phenology while for pgc these effects were more important in the cool winter warm spring conditions producing early phenology fig 4a and c the interaction between the parameters t 50 and d t had the largest effect on the predicted bud break date notably in the coldest temperature conditions d t t 50 appendix 9 these two parameters define the shape of the response to temperature during ecodormancy in the three models for the pgc model in the warmest climatic conditions the interaction between the endodormancy starting date t 0 and the photoperiod sensitivity d p also had an impact on the predicted bud break date t 0 d p appendix 9 the influence of interaction effects thus tended to increase with model complexity but also varied with specific weather patterns in winter and spring 4 discussion 4 1 bud break date predictions mainly depend on the forcing response under current climatic conditions the sensitivity analysis of the studied process based models showed that the mid response temperature of the ecodormancy phase called here t 50 plays a critical role in the prediction of bud break date under current climatic conditions this result applies whether models account or not for an endodormancy phase or a photoperiodic control of bud development it therefore suggests that the response to forcing temperature during the ecodormancy defined by both t 50 and d t in the studied phenological models is a major physiological response driving the variation of bud break dates in temperate plant species in historical and current climatic conditions this finding is consistent with previous correlative modeling studies showing that bud break date variation was mainly driven by the mean temperature of the two preceding months which roughly corresponds to the ecodormancy phase e g menzel et al 2006 it is also consistent with previous process based modeling studies showing that models simulating only the ecodormancy phase explained as much variance in bud break dates as models simulating both the endo and ecodormancy phases linkosalo et al 2006 gauzere et al 2017 the similar performance of the two types of model suggested either that the fulfillment of chilling requirements had not been a limiting factor so far or that the endodormancy phase is not accurately modeled linkosalo et al 2006 chuine et al 2016 our results support the first hypothesis i e winter chilling temperature have played a minor role in bud break variations so far which also explains why the response of plant species to climate warming has so far resulted in an advancement of the bud break dates menzel et al 2006 a methodological consequence of this is that phenological records in natural populations may not allow estimating accurately endodormancy model parameters chuine et al 2016 4 2 bud break date predictions are increasingly dependent on chilling temperatures and photoperiod as climate warms we found that the effect of the reaction norm to forcing temperature on the prediction of the bud break date decreased with warming spring conditions while the effect of chilling accumulation during the endodormancy phase increased with warming winter temperature for the thermal endo ecodormancy models unichill and pgc this suggests that in warmer environmental conditions reaction norms to temperature during both bud endodormancy and ecodormancy are critical in determining bud break dates this result is supported by several recent experimental studies showing that temperature sensitivity of the bud break dates was currently decreasing likely due to an increasing influence of warming winters on bud endodormancy fu et al 2015a b vitasse et al 2018b asse et al 2018 in particular vitasse et al 2018b showed that a differential response to chilling temperatures between trees living at low and high elevations may explain the difference in the temporal trends of bud break date advancement observed at different elevations with warming conditions during the last decade overall these results highlight that the influence of chilling temperatures on bud development can no longer be overlooked and that the correct estimation of the parameters governing the endodormancy phase is required to accurately predict bud break the sensitivity analysis of the photothermal endo ecodormancy model pgc showed that the influence of the photoperiodic response through the d p parameter on the prediction of the bud break date increased in warmer environmental conditions a growing number of studies suggest that the phenology of up to 30 of tree species might be sensitive to photoperiod at various degrees laube et al 2014 zohner et al 2016 understanding how this increasing effect of the photoperiodic cue will affect the variation of bud break dates in future climatic conditions is an issue still debated fu et al 2015b gauzere et al 2017 however in the most sensitive species such as beech it has been suggested that this sensitivity may counteract the negative effect of insufficient chilling during winter gauzere et al 2017 our results thus highlight that a stronger focus should be given to the modeling of the reaction norm to photoperiod to be able to accurately predict bud break dates of up to 30 of tree species in future climatic conditions 4 3 originality and limits of the study only a few studies have performed sensitivity analysis of phenology models so far they either analyzed the behavior of phenology models identified the main sources of uncertainties in bud break date predictions or assessed the consequences of phenological uncertainties on related processes e g morin and chuine 2005 migliavacca et al 2012 zhang et al 2014 lange et al 2016 a key results from these previous studies is that uncertainty in climate conditions notably generated by climate scenarios was a greater source of variation in phenological date projections than uncertainty in phenology models migliavacca et al 2012 to our knowledge this study is the first to have compared the behavior of different phenology models with increasing complexity and to perform this analysis under different weather patterns in winter and spring the results found here are in line with a recent sensitivity analysis of species specific phenology models which found an increasing importance of chilling requirements and photoperiod in warm climatic conditions for temperate tree species lange et al 2016 the consistency of our results with the sensitivity analysis of other phenology models strengthens the scope of our study and thus further stress the importance of investigating the behavior of phenology models in contrasted climatic conditions in order to fully embrace their robustness while the climate we used to perform the sensitivity analyses covers a small geographical region it still explores a large range of variation in winter and spring average temperatures t novdec 2 07 8 97 t maraprnay 5 56 14 52 this temperature variation is less important than in other sensitivity analyses e g lange et al 2016 but it is large enough to allow extrapolating the results of this study at larger spatial scales the aim of the present study was not to investigate the behavior of phenology models under climate change scenarios nevertheless by extrapolating our results on the impact of warming conditions on parameter sensitivity we can expect the influence of the parameters governing the endodormancy to overall have more influence on bud break date predictions in the future due to the high computational requirement of sensitivity analyses most studies usually neglect partially or completely interaction effects between model parameters as a source of output variation e g lange et al 2016 however the complexity of process based phenology models tends to increase as we gain better knowledge about the physiological processes involved in bud development with increasing model complexity and realism we can expect interaction effects to have non negligible influence on the prediction of the models and thus local sensitivity analysis to partially reveal the effect of parameters on output variance our results also suggest that model complexity would result in higher uncertainty in bud break dates because of interaction effects moreover increasing model complexity would generate higher uncertainty in model outputs because of parameter compensation during the statistical adjustment notably if models are used to perform predictions outside of the range of the climatic conditions used to adjust them gauzere et al 2017 here we showed that sensitivity analysis of process based phenology models are relevant to identify key parameters and processes that have the largest effect on phenology migliavacca et al 2012 lange et al 2016 however the choice of the parameter variation range likely affects the results of such analyses since for most plant species the range limits or shape of the distributions of the physiological parameters in natural populations are unknown such sensitivity analyses rely on assumptions that cannot be tested here we might have overestimated the real contribution of t 50 and f to the variation of the bud break date due to uneven variances in parameter sampling distributions this effect of parameter variation on the outcome of sensitivity analyses should be more acknowledged to improve the scope and relevance of sensitivity analyses more attention should be given to the characterization of the natural variation of the physiological parameters described in process based models e g burghardt et al 2015 4 4 implications for the adaptive potential of phenological traits while the sensitivity analysis of phenology models has direct implications for ecological and climate change studies we wanted to highlight also here their usefulness for evolutionary studies the bud break date is among the most genetically differentiated trait across species distribution ranges de kort et al 2013 suggesting that it is strongly involved in the process of local genetic adaptation evolutionary response of the bud break date is expected to depend on which parameters present genetic variation and how this variation impacts the bud break date i e the expressed trait variation sensitivity analysis outputs can be used to address this second issue for example our results show that the mid response temperature of the ecodormancy phase t 50 has the highest impact on the variation of the bud break date in most conditions we thus suggest that future experimental research consider measuring the genetic variation of this key physiological trait in natural populations and crops to evaluate their adaptive potential this can be done by monitoring bud break of several genotypes either in varying controlled conditions e g caffarra et al 2011b or by monitoring growth transcriptor factors in natura or in the field using new transcriptomic technics e g nagano et al 2012 or even better by combining both approaches e g satake et al 2013 given the increasing importance of the response to chilling temperatures during the endodormancy phase to determine the bud break date in warming conditions future experimental research might additionally consider measuring the genetic variation in chilling requirement and reaction norms to chilling temperature especially in species requiring large amount of chilling finally future experimental research should consider measuring the genetic variation in the reaction norm to photoperiod in most sensitive species and notably beech goyne et al 1989 for example in crops 5 conclusions the identification of the physiological responses underlying the bud break date variation in current environmental conditions is an important on going experimental research field fu et al 2015a b vitasse et al 2018b assuming that process based phenology models reflect real physiological responses and processes the analysis of their behavior under contrasted climatic conditions can provide valuable information about this issue our results highlighted the major influence of the response to forcing temperature on the prediction of the bud break date but also an increasing importance of the responses to chilling temperature and photoperiod in warming environmental conditions changes in the sensitivity of the prediction of phenology models to their parameters with climatic conditions highlights that we need to better take into account the temporal and spatial variation of environmental conditions when analyzing phenological changes vitasse et al 2018b more generally we acknowledge here that the sensitivity analysis of process based models is a useful tool to understand the relative contributions of environmental cues in driving phenotypic traits variation and their evolutionary potential donohue et al 2015 burghardt et al 2015 lange et al 2016 conflict of interest the authors have no conflict of interest to declare acknowledgements we thank claude bruchou and guillaume marie for helpful discussions on the approach and results of this manuscript we thank also two anonymous reviewers for their constructive comments which helped us improving previous versions of this article this study was funded by the anr 13 adap 0006 project mecc supplementary data supplementary data associated with this article can be found in the online version at https doi org 10 1016 j ecolmodel 2019 108805 supplementary data the following are the supplementary data to this article 
24976,the order of events in discrete time models plays an important role in the determination of the dynamics for instance harvest of a renewable resource can occur before or after species reproduction in this work we argue that a discrete time two patch dynamical model of a single population proposed in the literature is partly incorrect with respect to harvest timing we put forward a new formulation where pre and post reproductive harvest are precisely specified by means of numerical bifurcation analysis employing the same parameter values of the model proposed in the literature we show that optimal harvest fractions are less than 1 while those in the referred literature are exactly 1 in the corresponding cases these results point to an overestimation of harvest fractions in the model with incorrect harvest timing keywords harvest timing optimal harvest fraction marine reserves 1 introduction the order of events in discrete time models plays an important role in the determination of the dynamics features such as ageing and survival wang and gutierrez 1980 predation crawley 1992 density dependence in parasitism may et al 1981 emigration and or immigration doebelli 1995 survival reproduction and dispersal hassell et al 1995 optimal timing of augmentation of an endangered threatened population in a target region must all be tuned to a certain order in the species life cycle bodine et al 2012 recently it was shown that pre reproductive mortality could raise the equilibrium population level in some discrete time models of single populations the so called hydra effect abrams 2009 or positive effects of mortality schröder et al 2014 marine reserves can be defined as pre determined portions of the coastline or ocean to be protected from fishing and other anthropogenic disturbances in this way they can be considered as a means of i conserving marine biodiversity and restoring depleted fish stocks see for instance oropeza et al 2011 ii protecting target species but also the habitat of the species within the protected area micheli et al 2004 iii safeguarding species against management failure e g the setting of risky quotas by decision makers clark 2006 roberts et al 2005 these features support the fact that marine reserves can serve many purposes continuous or discrete time mathematical models that describe the population dynamics within marine reserves and in their surroundings have been propounded in the literature they can address for example sustainability of single mangel 1998 or multispecies mangel and levin 2005 harvested systems and restoration of depleted stocks ghosh et al 2017 in this modelling context lundberg and jonzén 1999 proposed a discrete time two patch dynamical model of a single population subject to harvest in the unprotected area it is worth mentioning that their model presents some built in population characteristics similar to the single species continuous time source sink dynamical model analysed in clark 2006 we argue that the proposed model by lundberg and jonzén 1999 is partly incorrect with respect to the specification of the order of events between harvest actions and density dependent processes of species survival and reproduction in turn in this work we propose and analyse an alternative formulation of the same model with two distinct orders of events concerning harvest and density dependent population processes taken into account in the studied model in these two cases our proposed models predict an optimal harvest fraction less than 1 while lundberg and jonzén 1999 predict an optimal harvest fraction equal to 1 these markedly different results can have significant implications in the management of the studied population 2 a discrete time model of a spatially explicit single population with harvest timing the design of protected areas in marine fishery has been a constant subject of study in single as well as in interacting populations gerber et al 2002 mangel 1998 micheli et al 2004 a graphical scheme of such framework is displayed in fig 1 based on fig 1 lundberg and jonzén 1999 proposed and analysed the harvest of a single species outside a reserve according to the following two patch model 1 x 1 t 1 x 1 t m 1 λ 1 x 1 t 1 a 1 x 1 1 s x 2 t 1 x 2 t m 2 λ 2 x 2 t 1 a 2 x 2 t λ 1 x 1 t 1 a 1 x 1 t s h x 2 t they define patch 1 as the reserve and patch 2 as the area outside the reserve where harvest is undertaken the variables x1 and x2 are the densities of fish individuals in each patch the parameter mi is the adult survival rate 0 mi 1 i e there is generation overlap in patch i i 1 2 s is the fraction 0 s 1 of all recruits produced in the reserve i 1 that migrate post reproductively to the harvest area i 2 a1 a2 denote the strength of density dependence in each habitat λ 1 λ 2 are the maximum rate of increase in each habitat 0 h 1 is the harvest fraction acting on x2 the harvest term hx2 t in model 1 poses a problem because the timing of harvest is not explicitly stated for the sake of clarification of the importance of order events in modelling and without loss of generality let us dismiss temporarily the migration term in the x2 t equation of model 1 the aim is to focus on birth survival and harvest processes acting on the individual outside the reserve x2 t accordingly the x2 t equation reads 1a x 2 t 1 x 2 t m 2 λ 2 x 2 t 1 a 2 x 2 t h x 2 t let x2 t be the density of adults at the beginning of period t in patch 2 according to λ 2 x 2 t 1 a 2 x 2 t in 1a reproduction and survival acts upon x2 t hence harvest cannot be pre reproductive if it were reproduction and survival would act upon 1 h x2 t those surviving from harvest leading to λ 2 1 h x 2 t 1 a 2 1 h x 2 t at the end of period t the surviving newborns λ 2 x 2 t 1 a 2 x 2 t plus the surviving adults m2 x2 t will make up the new population at the beginning of period t 1 within this framework hx2 t in the x2 t eq 1a means that harvest acts upon individuals at the beginning of period t x2 t however reproduction and survival also act upon x2 t according to λ 2 x 2 t 1 a 2 x 2 t as a consequence it may be the case that individuals outside the reserve are harvested at the beginning of period t hx2 t and yet reproduce contributing to the population outside the reserve during this same discrete time period in order to avoid this incoherence we propose the following two schedules of order of events based on the assumptions previously made 3 pre reproductive harvest the pre reproductive harvest follows the sequence displayed in fig 2 according to fig 2 harvest hx2 t acts before reproduction at the beginning of period t consequently the remaining adult population density in patch 2 after harvest would be 1 h x2 t the density 1 h x2 t would then not only dictate the intensity of reproduction and survival by means of the growth function or alternatively the stock recruitment function that would read λ 2 1 h x 2 t 1 a 2 1 h x 2 t but also the density of the surviving adults from period t to period t 1 i e 1 h x2 t m2 this last term represents the generation overlap characteristic to iteroparous species i e species with multiple reproductive events during their lifetime with the assumption of pre reproduction harvest above the x2 t equation in 1a will read 1b x 2 t 1 1 h x 2 t m 2 λ 2 1 h x 2 t 1 a 2 1 h x 2 t according to 1b harvest acts before reproduction upon x2 t therefore reproduction and survival of the newborns will depend on those individuals that were not harvested i e 1 h x2 t generating the term λ 2 1 h x 2 t 1 a 2 1 h x 2 t in addition there are the adults that were not harvested and a fraction m2 of those survive to the next generation 1 h x2 t m2 note the same structure of eq 1b in eq 1 in mangel 2000 where harvest acts pre reproductively in a single discrete time population model described by a logistic growth 4 post reproductive harvest the post reproductive harvest follows the sequence displayed in fig 3 according to fig 3 at the beginning of period t x2 t generate newborns that survive to adulthood according to the stock recruitment expression λ 2 x 2 t 1 a 2 x 2 t additionally a fraction m2 of the adults x2 t at the beginning of period t survive till the end of period t i e m2 x2 t the sum of these two population components will be the population subject to post reproductive harvest in this way post reproductive harvest simultaneously acts upon the newborns that survive to adulthood λ 2 x 2 t 1 a 2 x 2 t and those adults that survive to the next generation m2 x2 t in other words the population surviving from harvest will be given by x 2 t m 2 λ 2 x 2 t 1 a 2 x 2 t 1 h hence for a post reproduction survival harvest the x2 t equation in 1 will read x 2 t 1 x 2 t m 2 λ 2 x 2 t 1 a 2 x 2 t 1 h in view of the above reasoning we propose that harvest be more clearly segregated in time with respect to reproduction because it was shown that this segregation can lead to distinct model structures at this juncture we enlist the assumptions of the model proposed by lundberg and jonzén 1999 and the assumptions of our model as displayed in table 1 5 the proposed models with two distinct orders of events in order to construct the dynamical models with two distinct orders of events as to harvesting we turn back to model 1 proposed by lundberg and jonzén 1999 first following lundberg and jonzén 1999 we change the population variable to number of individuals instead of density let a be the size of the total area that the population occupies habitat 1 the reserve is a fraction c of a and is thus of size ca and habitat 2 consequently has size 1 c a hence the number of individuals occupying habitats i 1 2 will be respectively n1 cax1 and n2 1 c ax2 casting model 1 in terms of number of individuals occupying a respective habitat and setting a 1 without loss of generality with pre reproductive harvest h will yield the following model 2 n 1 t 1 n 1 t m 1 λ 1 n 1 t 1 a 1 n 1 t c 1 s n 2 t 1 n 2 t 1 h m 2 λ 2 n 2 t 1 h 1 a 2 n 2 t 1 c 1 h λ 1 n 1 t 1 a 1 n 1 t c s note that 1 h n2 t m2 is the amount of adults from period t that are not harvested and survive from natural causes of mortality to period t 1 λ 2 n 2 t 1 h 1 a 2 n 2 t 1 c 1 h is the amount of newborns from 1 h n2 t adults that reached adulthood note also that only newborns in patch 1 that reached adulthood migrate from patch 1 reserve to patch 2 and by assumption this migration is post reproductive therefore they are not affected by harvest in patch 2 because i harvest is assumed to occur pre reproductively ii it is also assumed that reproduction is synchronized in both patches alternatively casting model 1 with post reproductive harvest h will yield the following model 3 n 1 t 1 n 1 t m 1 λ 1 n 1 t 1 a 1 n 1 t c 1 s n 2 t 1 n 2 t m 2 λ 2 n 2 t 1 a 2 n 2 t 1 c λ 1 n 1 t 1 a 1 n 1 t c s 1 h note that since harvest is post reproductive it acts upon the adults of patch 1 that migrate to patch 2 recall that reproduction is synchronized in both patches hence those adults that migrate and survive from harvest are represented by the term λ 1 n 1 t 1 a 1 n 1 t c s 1 h the term n2 t m2 1 h is the amount of adults from period t that survive to period t 1 from natural causes of death and from harvest λ 2 n 2 t 1 a 2 n 2 t 1 c 1 h is the amount of adults in patch 2 that survive from harvest we now proceed to perform the analysis of models 2 and 3 following lundberg and jonzén 1999 we simulate a bifurcation diagram of model 2 and 3 cast in number of individuals n1 and n2 as a function of the harvested fraction 0 h 1 in order to evaluate the harvest yield as h varies bifurcation diagrams of model 2 and 3 as a function of parameter h were generated by means of time series simulations run up to 300 time units to eliminate transient dynamics and the last 20 values of n2 were considered as steady state then these steady states multiplied by the fraction harvest hn2 i e the harvest yield outside the reserve were plotted for each value of h 0 h 1 we emphasize that the parameter values in model 2 and 3 are the same as those in model 1 the model proposed by lundberg and jonzén 1999 fig 4 shows how the capture in numbers outside the reserve patch i 2 varies when the pre reproductive harvest fraction h is increased in model 2 the results of fig 4 are at variance with those of fig 3 in lundberg and jonzén 1999 p 132 because their respective curves for s 0 25 are monotonically increasing in the interval 0 h 1with an optimal harvest fraction at h 1 while in our fig 4 the harvest yield curves are unimodal for s 0 25 with an optimal harvest fraction h 0 36 0 h 1 note also that this optimal harvest fraction is the same for both reserve sizes considered i e c 0 01 and c 0 25 according to the bifurcation diagram of fig 4 model 2 suggests that for a certain value of spillover s 0 25 augmentation of harvest fraction beyond 0 36 i e h h 0 36 can decrease the harvest yield we now turn to the analysis of the post reproductive harvest model 3 fig 5 shows how the capture in numbers outside the reserve patch i 2 varies when the post reproductive harvest h is increased in model 3 the results of fig 5 are also at variance with those of fig 3 in lundberg and jonzén 1999 p 132 because their respective curves for s 0 25 are monotonically increasing in the interval 0 h 1with an optimal harvest fraction at h 1 while in our fig 5 the harvest yield curves are unimodal for s 0 25 with an optimal harvest fraction h 0 3 0 h 1 in other words our results in fig 4 and 5 bring out a maximum sustainable yield quinn and deriso 1999 note also that this optimal harvest fraction is the same for both reserve sizes considered i e c 0 01 and c 0 25 likewise as in model 2 the bifurcation diagram of model 3 displayed in fig 5 suggests that for a certain value of spillover s 0 25 augmentation of harvest fraction beyond 0 3 i e h h 0 3 can decrease the harvest yield according to the outcomes of models 2 and 3 displayed in figs 4 and 5 we see that the segregation of events such as dispersal and harvest are important in the determination of the species dynamics and consequently in the present study the optimal harvest fraction note however that although timing of harvest is not specified in lundberg and jonzén 1999 the timing of spillover is specified because it is assumed that dispersal from the reserve to the area outside the reserve the spillover occurs in a post reproductive fashion 6 discussion this work centred upon the modelling of harvest timing in a specific discrete time dynamical model of a single population to this end we put forward a new formulation taking into account pre and post reproductive harvest to provide a complete harvest timing structure in a two patch discrete time model proposed by lundberg and jonzén 1999 their model describes a possible spatial dynamics of a single fish population inside and outside a marine reserve using the same set of parameter values of the model proposed by lundberg and jonzén 1999 the results concerning optimal harvest fraction markedly differ between our pre and post reproductive models and that of lundberg and jonzén 1999 for the same value of spillover s 0 25 our models suggest that there are positive optimal harvest fractions less than 1 h 0 36 in model 2 and h 0 3 in model 3 while in lundberg and jonzén 1999 the optimal harvest fraction for these cases with the same parameter values is h 1 such discrepancy in optimal harvest fractions can have its toll in the management of renewable resources on account of the overestimation of the harvest fractions in the model proposed by lundberg and jonzén 1999 according to figures 4 and 5 an optimal harvest fraction h 1 the overestimated harvest fraction found in lundberg and jonzén 1999 leads to a harvest yield below the maximum sustainable yield we remark that although lundberg and jonzén 1999 do not take into account a precise timing of harvest from the mathematical modelling point of view the results for s 0 01 in their fig 3 are qualitatively similar to our figs 4 and 5 that is in their fig 3 the catch in numbers curves are not monotonically increasing in the interval 0 h 1 we recall that a similar problem was found in the context of population dispersal in a spatially structured system in the model proposed by bascompte and solé 1994 and solved in hassell et al 1995 couched as a discrete analogue of a reaction diffusion equation bascompte and solé 1994 population dynamical model fails to segregate the processes of survival and dispersal as a result the same individuals may simultaneously fail to survive and yet disperse as additional examples of lack of specification of order of events in discrete time population models one can cite i dispersal timing is not specified in the discrete time one species metapopulation model proposed by vandermeer and carvajal 2001 p 216 ii dispersal and harvest timing is not specified in a two patch discrete time single population model in bischi et al 2009 it is important to mention that the two works cited above deal with renewable resource management of single populations therefore the results of this theoretical exercise concerning optimal harvest fractions of a single population corroborate the importance of the precise modelling of the order of events in discrete time population models this is all the more important when decision making concerning several strategies in the management of single as well as multiple populations is required acknowledgements the authors acknowledge the helpful comments and suggestions made by the referees on an earlier version of this work lucas dos anjos acknowledges the financial support given by coordenação de aperfeiçoamento de pessoal de nível superior brasil capes 
24976,the order of events in discrete time models plays an important role in the determination of the dynamics for instance harvest of a renewable resource can occur before or after species reproduction in this work we argue that a discrete time two patch dynamical model of a single population proposed in the literature is partly incorrect with respect to harvest timing we put forward a new formulation where pre and post reproductive harvest are precisely specified by means of numerical bifurcation analysis employing the same parameter values of the model proposed in the literature we show that optimal harvest fractions are less than 1 while those in the referred literature are exactly 1 in the corresponding cases these results point to an overestimation of harvest fractions in the model with incorrect harvest timing keywords harvest timing optimal harvest fraction marine reserves 1 introduction the order of events in discrete time models plays an important role in the determination of the dynamics features such as ageing and survival wang and gutierrez 1980 predation crawley 1992 density dependence in parasitism may et al 1981 emigration and or immigration doebelli 1995 survival reproduction and dispersal hassell et al 1995 optimal timing of augmentation of an endangered threatened population in a target region must all be tuned to a certain order in the species life cycle bodine et al 2012 recently it was shown that pre reproductive mortality could raise the equilibrium population level in some discrete time models of single populations the so called hydra effect abrams 2009 or positive effects of mortality schröder et al 2014 marine reserves can be defined as pre determined portions of the coastline or ocean to be protected from fishing and other anthropogenic disturbances in this way they can be considered as a means of i conserving marine biodiversity and restoring depleted fish stocks see for instance oropeza et al 2011 ii protecting target species but also the habitat of the species within the protected area micheli et al 2004 iii safeguarding species against management failure e g the setting of risky quotas by decision makers clark 2006 roberts et al 2005 these features support the fact that marine reserves can serve many purposes continuous or discrete time mathematical models that describe the population dynamics within marine reserves and in their surroundings have been propounded in the literature they can address for example sustainability of single mangel 1998 or multispecies mangel and levin 2005 harvested systems and restoration of depleted stocks ghosh et al 2017 in this modelling context lundberg and jonzén 1999 proposed a discrete time two patch dynamical model of a single population subject to harvest in the unprotected area it is worth mentioning that their model presents some built in population characteristics similar to the single species continuous time source sink dynamical model analysed in clark 2006 we argue that the proposed model by lundberg and jonzén 1999 is partly incorrect with respect to the specification of the order of events between harvest actions and density dependent processes of species survival and reproduction in turn in this work we propose and analyse an alternative formulation of the same model with two distinct orders of events concerning harvest and density dependent population processes taken into account in the studied model in these two cases our proposed models predict an optimal harvest fraction less than 1 while lundberg and jonzén 1999 predict an optimal harvest fraction equal to 1 these markedly different results can have significant implications in the management of the studied population 2 a discrete time model of a spatially explicit single population with harvest timing the design of protected areas in marine fishery has been a constant subject of study in single as well as in interacting populations gerber et al 2002 mangel 1998 micheli et al 2004 a graphical scheme of such framework is displayed in fig 1 based on fig 1 lundberg and jonzén 1999 proposed and analysed the harvest of a single species outside a reserve according to the following two patch model 1 x 1 t 1 x 1 t m 1 λ 1 x 1 t 1 a 1 x 1 1 s x 2 t 1 x 2 t m 2 λ 2 x 2 t 1 a 2 x 2 t λ 1 x 1 t 1 a 1 x 1 t s h x 2 t they define patch 1 as the reserve and patch 2 as the area outside the reserve where harvest is undertaken the variables x1 and x2 are the densities of fish individuals in each patch the parameter mi is the adult survival rate 0 mi 1 i e there is generation overlap in patch i i 1 2 s is the fraction 0 s 1 of all recruits produced in the reserve i 1 that migrate post reproductively to the harvest area i 2 a1 a2 denote the strength of density dependence in each habitat λ 1 λ 2 are the maximum rate of increase in each habitat 0 h 1 is the harvest fraction acting on x2 the harvest term hx2 t in model 1 poses a problem because the timing of harvest is not explicitly stated for the sake of clarification of the importance of order events in modelling and without loss of generality let us dismiss temporarily the migration term in the x2 t equation of model 1 the aim is to focus on birth survival and harvest processes acting on the individual outside the reserve x2 t accordingly the x2 t equation reads 1a x 2 t 1 x 2 t m 2 λ 2 x 2 t 1 a 2 x 2 t h x 2 t let x2 t be the density of adults at the beginning of period t in patch 2 according to λ 2 x 2 t 1 a 2 x 2 t in 1a reproduction and survival acts upon x2 t hence harvest cannot be pre reproductive if it were reproduction and survival would act upon 1 h x2 t those surviving from harvest leading to λ 2 1 h x 2 t 1 a 2 1 h x 2 t at the end of period t the surviving newborns λ 2 x 2 t 1 a 2 x 2 t plus the surviving adults m2 x2 t will make up the new population at the beginning of period t 1 within this framework hx2 t in the x2 t eq 1a means that harvest acts upon individuals at the beginning of period t x2 t however reproduction and survival also act upon x2 t according to λ 2 x 2 t 1 a 2 x 2 t as a consequence it may be the case that individuals outside the reserve are harvested at the beginning of period t hx2 t and yet reproduce contributing to the population outside the reserve during this same discrete time period in order to avoid this incoherence we propose the following two schedules of order of events based on the assumptions previously made 3 pre reproductive harvest the pre reproductive harvest follows the sequence displayed in fig 2 according to fig 2 harvest hx2 t acts before reproduction at the beginning of period t consequently the remaining adult population density in patch 2 after harvest would be 1 h x2 t the density 1 h x2 t would then not only dictate the intensity of reproduction and survival by means of the growth function or alternatively the stock recruitment function that would read λ 2 1 h x 2 t 1 a 2 1 h x 2 t but also the density of the surviving adults from period t to period t 1 i e 1 h x2 t m2 this last term represents the generation overlap characteristic to iteroparous species i e species with multiple reproductive events during their lifetime with the assumption of pre reproduction harvest above the x2 t equation in 1a will read 1b x 2 t 1 1 h x 2 t m 2 λ 2 1 h x 2 t 1 a 2 1 h x 2 t according to 1b harvest acts before reproduction upon x2 t therefore reproduction and survival of the newborns will depend on those individuals that were not harvested i e 1 h x2 t generating the term λ 2 1 h x 2 t 1 a 2 1 h x 2 t in addition there are the adults that were not harvested and a fraction m2 of those survive to the next generation 1 h x2 t m2 note the same structure of eq 1b in eq 1 in mangel 2000 where harvest acts pre reproductively in a single discrete time population model described by a logistic growth 4 post reproductive harvest the post reproductive harvest follows the sequence displayed in fig 3 according to fig 3 at the beginning of period t x2 t generate newborns that survive to adulthood according to the stock recruitment expression λ 2 x 2 t 1 a 2 x 2 t additionally a fraction m2 of the adults x2 t at the beginning of period t survive till the end of period t i e m2 x2 t the sum of these two population components will be the population subject to post reproductive harvest in this way post reproductive harvest simultaneously acts upon the newborns that survive to adulthood λ 2 x 2 t 1 a 2 x 2 t and those adults that survive to the next generation m2 x2 t in other words the population surviving from harvest will be given by x 2 t m 2 λ 2 x 2 t 1 a 2 x 2 t 1 h hence for a post reproduction survival harvest the x2 t equation in 1 will read x 2 t 1 x 2 t m 2 λ 2 x 2 t 1 a 2 x 2 t 1 h in view of the above reasoning we propose that harvest be more clearly segregated in time with respect to reproduction because it was shown that this segregation can lead to distinct model structures at this juncture we enlist the assumptions of the model proposed by lundberg and jonzén 1999 and the assumptions of our model as displayed in table 1 5 the proposed models with two distinct orders of events in order to construct the dynamical models with two distinct orders of events as to harvesting we turn back to model 1 proposed by lundberg and jonzén 1999 first following lundberg and jonzén 1999 we change the population variable to number of individuals instead of density let a be the size of the total area that the population occupies habitat 1 the reserve is a fraction c of a and is thus of size ca and habitat 2 consequently has size 1 c a hence the number of individuals occupying habitats i 1 2 will be respectively n1 cax1 and n2 1 c ax2 casting model 1 in terms of number of individuals occupying a respective habitat and setting a 1 without loss of generality with pre reproductive harvest h will yield the following model 2 n 1 t 1 n 1 t m 1 λ 1 n 1 t 1 a 1 n 1 t c 1 s n 2 t 1 n 2 t 1 h m 2 λ 2 n 2 t 1 h 1 a 2 n 2 t 1 c 1 h λ 1 n 1 t 1 a 1 n 1 t c s note that 1 h n2 t m2 is the amount of adults from period t that are not harvested and survive from natural causes of mortality to period t 1 λ 2 n 2 t 1 h 1 a 2 n 2 t 1 c 1 h is the amount of newborns from 1 h n2 t adults that reached adulthood note also that only newborns in patch 1 that reached adulthood migrate from patch 1 reserve to patch 2 and by assumption this migration is post reproductive therefore they are not affected by harvest in patch 2 because i harvest is assumed to occur pre reproductively ii it is also assumed that reproduction is synchronized in both patches alternatively casting model 1 with post reproductive harvest h will yield the following model 3 n 1 t 1 n 1 t m 1 λ 1 n 1 t 1 a 1 n 1 t c 1 s n 2 t 1 n 2 t m 2 λ 2 n 2 t 1 a 2 n 2 t 1 c λ 1 n 1 t 1 a 1 n 1 t c s 1 h note that since harvest is post reproductive it acts upon the adults of patch 1 that migrate to patch 2 recall that reproduction is synchronized in both patches hence those adults that migrate and survive from harvest are represented by the term λ 1 n 1 t 1 a 1 n 1 t c s 1 h the term n2 t m2 1 h is the amount of adults from period t that survive to period t 1 from natural causes of death and from harvest λ 2 n 2 t 1 a 2 n 2 t 1 c 1 h is the amount of adults in patch 2 that survive from harvest we now proceed to perform the analysis of models 2 and 3 following lundberg and jonzén 1999 we simulate a bifurcation diagram of model 2 and 3 cast in number of individuals n1 and n2 as a function of the harvested fraction 0 h 1 in order to evaluate the harvest yield as h varies bifurcation diagrams of model 2 and 3 as a function of parameter h were generated by means of time series simulations run up to 300 time units to eliminate transient dynamics and the last 20 values of n2 were considered as steady state then these steady states multiplied by the fraction harvest hn2 i e the harvest yield outside the reserve were plotted for each value of h 0 h 1 we emphasize that the parameter values in model 2 and 3 are the same as those in model 1 the model proposed by lundberg and jonzén 1999 fig 4 shows how the capture in numbers outside the reserve patch i 2 varies when the pre reproductive harvest fraction h is increased in model 2 the results of fig 4 are at variance with those of fig 3 in lundberg and jonzén 1999 p 132 because their respective curves for s 0 25 are monotonically increasing in the interval 0 h 1with an optimal harvest fraction at h 1 while in our fig 4 the harvest yield curves are unimodal for s 0 25 with an optimal harvest fraction h 0 36 0 h 1 note also that this optimal harvest fraction is the same for both reserve sizes considered i e c 0 01 and c 0 25 according to the bifurcation diagram of fig 4 model 2 suggests that for a certain value of spillover s 0 25 augmentation of harvest fraction beyond 0 36 i e h h 0 36 can decrease the harvest yield we now turn to the analysis of the post reproductive harvest model 3 fig 5 shows how the capture in numbers outside the reserve patch i 2 varies when the post reproductive harvest h is increased in model 3 the results of fig 5 are also at variance with those of fig 3 in lundberg and jonzén 1999 p 132 because their respective curves for s 0 25 are monotonically increasing in the interval 0 h 1with an optimal harvest fraction at h 1 while in our fig 5 the harvest yield curves are unimodal for s 0 25 with an optimal harvest fraction h 0 3 0 h 1 in other words our results in fig 4 and 5 bring out a maximum sustainable yield quinn and deriso 1999 note also that this optimal harvest fraction is the same for both reserve sizes considered i e c 0 01 and c 0 25 likewise as in model 2 the bifurcation diagram of model 3 displayed in fig 5 suggests that for a certain value of spillover s 0 25 augmentation of harvest fraction beyond 0 3 i e h h 0 3 can decrease the harvest yield according to the outcomes of models 2 and 3 displayed in figs 4 and 5 we see that the segregation of events such as dispersal and harvest are important in the determination of the species dynamics and consequently in the present study the optimal harvest fraction note however that although timing of harvest is not specified in lundberg and jonzén 1999 the timing of spillover is specified because it is assumed that dispersal from the reserve to the area outside the reserve the spillover occurs in a post reproductive fashion 6 discussion this work centred upon the modelling of harvest timing in a specific discrete time dynamical model of a single population to this end we put forward a new formulation taking into account pre and post reproductive harvest to provide a complete harvest timing structure in a two patch discrete time model proposed by lundberg and jonzén 1999 their model describes a possible spatial dynamics of a single fish population inside and outside a marine reserve using the same set of parameter values of the model proposed by lundberg and jonzén 1999 the results concerning optimal harvest fraction markedly differ between our pre and post reproductive models and that of lundberg and jonzén 1999 for the same value of spillover s 0 25 our models suggest that there are positive optimal harvest fractions less than 1 h 0 36 in model 2 and h 0 3 in model 3 while in lundberg and jonzén 1999 the optimal harvest fraction for these cases with the same parameter values is h 1 such discrepancy in optimal harvest fractions can have its toll in the management of renewable resources on account of the overestimation of the harvest fractions in the model proposed by lundberg and jonzén 1999 according to figures 4 and 5 an optimal harvest fraction h 1 the overestimated harvest fraction found in lundberg and jonzén 1999 leads to a harvest yield below the maximum sustainable yield we remark that although lundberg and jonzén 1999 do not take into account a precise timing of harvest from the mathematical modelling point of view the results for s 0 01 in their fig 3 are qualitatively similar to our figs 4 and 5 that is in their fig 3 the catch in numbers curves are not monotonically increasing in the interval 0 h 1 we recall that a similar problem was found in the context of population dispersal in a spatially structured system in the model proposed by bascompte and solé 1994 and solved in hassell et al 1995 couched as a discrete analogue of a reaction diffusion equation bascompte and solé 1994 population dynamical model fails to segregate the processes of survival and dispersal as a result the same individuals may simultaneously fail to survive and yet disperse as additional examples of lack of specification of order of events in discrete time population models one can cite i dispersal timing is not specified in the discrete time one species metapopulation model proposed by vandermeer and carvajal 2001 p 216 ii dispersal and harvest timing is not specified in a two patch discrete time single population model in bischi et al 2009 it is important to mention that the two works cited above deal with renewable resource management of single populations therefore the results of this theoretical exercise concerning optimal harvest fractions of a single population corroborate the importance of the precise modelling of the order of events in discrete time population models this is all the more important when decision making concerning several strategies in the management of single as well as multiple populations is required acknowledgements the authors acknowledge the helpful comments and suggestions made by the referees on an earlier version of this work lucas dos anjos acknowledges the financial support given by coordenação de aperfeiçoamento de pessoal de nível superior brasil capes 
24977,niche based species distribution models sdms play a central role in studying species response to environmental change effective management and conservation plans for freshwater ecosystems require sdms that accommodate hierarchical catchment ordering and provide clarity on the performance of such models across multiple scales the scale dependence components considered here are a environment spatial structure represented by hierarchical catchment ordering following the strahler system b analysis grain that included 1st to 5th order catchments and c response grain the grain at which species respond most represented by local and upstream catchment area effects we used fish occurrence data from the danube river basin and various factors representing climate land cover and anthropogenic pressures our results indicate that the choice of response grain local vs upstream area effects and the choice of analysis grain only marginally influence the performance of sdms upstream effects tend to better predict fish distributions than corresponding local effects for anthropogenic and land cover factors in particular for species sensitive to pollution key predictors and their relative importance are scale and species dependent consequently choosing proper species dependent spatial scales and factors is imperative for effective river rehabilitation measures keywords catchment order conservation planning danube freshwater fish species distribution modelling upstream area 1 introduction the majority of studies describing distributions of freshwater species rely on niche based species distribution models sdms buisson et al 2008 lassalle et al 2010 markovic et al 2012 while the methodological aspects of sdms towards reducing model uncertainties have been extensively studied e g thuiller 2004 marmion et al 2009 grenouillet et al 2011 the influence of scale components on predictive power of sdms was less frequently studied following mertes and jetz 2018 the scale dependence components of species environment relationships are 1 spatial structure of the environment 2 analysis grain the grain at which analyses are conducted and 3 response grain the grain at which species respond most strongly to their environment domisch et al 2013 and kärcher et al 2019 have shown that the second scale component analysis grain only marginally influences the performance of sdms however to address the effects of the above defined three scale components on the performance of sdms tailored to freshwater species an integrated modelling framework is needed stream ecologists have long recognized that biodiversity patterns of freshwater species are strongly influenced by the spatial structure of the environment the dendritic structure of stream and river networks cf fausch et al 2002 moreover swan and brown 2017 have shown that restoration activities aiming at increasing biodiversity are more efficient in small isolated streams than in larger well connected downstream reaches accordingly the local diversity of streams and rivers is influenced by the watershed structure and land use within the surrounding river and stream valleys at multiple scales allan et al 1997 allan 2004 black et al 2004 stephenson and morin 2009 and also known as the riverine macrosystem mccluney et al 2014 for example macroinvertebrates and fish are shown to be strongly influenced by riparian land use and instream habitat conditions at the reach scale moerke and lamberti 2006 feld and hering 2007 verdonschot 2009 sui et al 2014 and up to a few kilometres upstream of sampling sites kail et al 2009 kail and wolter 2013 in the era of urgent management response to high environmental pressures to freshwater ecosystems catchment scale hold great promise where fine grain e g reach scale survey data are unavailable given the high vulnerability of freshwater ecosystems to environmental change woodward et al 2010 markovic et al 2017 and the fact that sdms play a central role in conservation and restoration planning at multiple scales e g franklin 2009 it is of fundamental importance to investigate the scale effects on the performance of sdms of freshwater species distributions hierarchical catchment ordering provides a valuable framework to address the effects of the two scale components analysis grain and spatial structure of the environment on models of freshwater species distributions cf allan et al 1997 in our recent study kärcher et al 2019 we have shown that the choice of the analysis grain reflected by the hierarchical catchment order only marginally influences the mean performance of sdms the present study incorporates an additional scale dimension into this discourse the response grain implemented through the combination of local factors and those of the entire upstream catchment namely while the relative importance of factors affecting species distributions is still debated tudesque et al 2014 there is clear evidence for the influence of the upstream area on the occurrence probability of species in a particular stream reach or a site angermeier and winston 1988 allan 2004 despite this evidence and the increased awareness that cause effect relationships should be simultaneously studied at both fine and broad scales see soranno et al 2014 the combination of local factors and those of the entire upstream catchment in shaping distribution patterns of freshwater species had not been sufficiently studied for instance the upstream effects were commonly not considered for the whole upstream catchment but only up to a certain distance from a sampling site e g up to 7 5 km in kail and wolter 2013 the few studies addressing the relationship between a species occurrence probability and upstream effects suggest strong impacts of intensive agricultural land use allan et al 1997 allan 2004 and a higher relative importance of cumulative upstream area conditions than environmental conditions at the reach scale esselman and allan 2010 here we present a comprehensive modelling framework that addresses the scale effects on the performance of sdms describing freshwater fish species distribution patterns the study area includes the danube river basin the spatial structure of the environment and analysis grain are based on the most widely used hierarchical catchment ordering the strahler system strahler 1964 strahler order reflects the hierarchical level of each reach in the whole river network with 1st order assigned to all reaches with no tributaries 2nd order to the confluences of two first order reaches and so on in this study we focus on the reach scale here the catchment area of the river reach where an occurrence of the freshwater fish was observed hereafter called 1st order catchment and the corresponding 2nd to 5th order catchments at each of the hierarchical catchment orders we evaluated the species response grain using environmental factors summarizing effects across catchments of a particular order across the corresponding whole upstream area as well as those summarizing cross scale effects the aims of the present study are 1 to identify for each individual environmental factor whether the entire upstream catchment effect the local reach effect or their interaction are better related to fish distribution patterns and 2 to test whether there is a decrease in the performance of sdms with coarsening analysis grain i e catchment order to test the effects on model performance objective 2 above we compared the performance of sdms for each catchment order based a solely on local catchment effects b solely on upstream catchment effects and c on the combination of local and upstream catchment effects 2 methods as this study is an extension of our previously published work kärcher et al 2019 and thus partially follows the same methodology for convenience the descriptions of the methods are kept the same wherever appropriate 2 1 study area the danube is europe s second largest river basin 801 463 km2 and is shared among more than 80 million people from 19 countries it extends from central europe through the balkans and drains to the black sea fig a1 the danube river delta is one of the world s largest wetlands rich in rare fauna and flora and inscribed on unesco s world heritage list in 1991 due to its large spatial extent and diverse relief the danube river basin also shows great differences in climate the summed annual precipitation ranges from more than 2300 mm in the high mountains to less than 400 mm in the delta region while the mean annual discharge reaches 6460 m3s 1 at the danube delta in romania icpdr 2009 the ecosystems of the danube river basin host over 2000 plant species over 40 mammals and approximately 100 fish species but are also subject to increasing pressure and serious pollution from agriculture industry and municipalities icpdr 2009 2 2 environmental data choice of environmental factors was based on recent studies of fish species distributions buisson et al 2008 lassalle et al 2010 markovic et al 2012 isaak et al 2017 with the predictor selection performed following markovic et al 2012 in total six environmental predictors emerged representing climate land cover and anthropogenic pressure of the study area table 1 climatic and topographic data were extracted from the worldclim 30 arc second approx 1 km 1 km gridded information hijmans et al 2007 the climatic data set included annual mean temperature anntmean and annual mean precipitation annpmean land use of the study area was described by applying three land cover classes percentage of area covered by row crops rowcrops by forest forest and by artificial surface builtup land cover information was extracted from the corine land cover database eea 2011 the number of inhabitants per area population was used as a measure of anthropogenic pressure global rural urban mapping project version1 available at http sedac ciesin columbia edu gpw initially topography of the study area was considered using altitude and slope however due to high correlations above 0 7 with the annual mean temperature both altitude and slope were omitted from further analyses fig a2 as indicated in table 1 the study area encompasses a wide range of environmental conditions 2 3 hierarchical catchment orders and predictor data sets the analyses and modelling were conducted for five different catchment orders watershed order wso1 to wso5 based on the strahler order of the river reaches from the ccm2 pan european catchments database ccm version 2 1 de jager and vogt 2010 the 1st order catchments wso1 are defined according to the drainage areas of the individual river reaches while higher order catchments wso2 wso5 result from groupings of the lower order catchments in a hierarchical way more specifically the wso1 represents here drainage areas of the river reaches with observed species occurrences catchment order increase is reflected in an increasing catchment size with an average ranging from 12 km2 for the wso1 to 2148 km2 for the wso5 for each wso environmental factors were calculated by averaging gridded data across the corresponding local catchment areas lca reflecting the river reach scale and across the cumulative upstream catchment areas uca fig a1 resulting in two distinct predictor data sets the upstream catchment related factors were derived using the pfafstetter coding system of the ccm2 database in r environment r development core team 2019 regarding the lca and the uca predictor data sets the environmental factors represent different statistics resulting from the processing of the gridded data for the local and the upstream catchments mean values for climatic factors percentage values for the land use classes and the sum of the number of inhabitants per area also it is noteworthy that cumulative upstream environmental factors for small 5th order catchments might be very similar over all lower hierarchical wso levels in addition to the lca and the uca predictor data sets we also defined their combined cross scale interactions csi specifically the interactions between the environmental factors were measured using the product of the corresponding lca and the uca predictors to ensure interpretability of our outcomes we used only pairs of identical environmental factors e g lca and uca related percentage of area under row crops and not all possible environmental factor combinations e g a possible but poorly interpretable combination would be the product of lca annual mean precipitation and uca number of inhabitants 2 4 fish data species occurrence data for the danube river basin were provided by partners of the project biofresh www freshwaterplatform eu schinegger et al 2016 for 1364 sites see also fig a1 fisheries data were sampled by either single pass or double pass electrofishing mainly between 1985 and 2002 to ensure an accurate estimate of the species distributions only species with at least 50 occurrences at the largest analysed scale the wso5 were included into the analysis cf coudon and gégout 2007 in total eight species are considered table 2 species ecological characterizations follow kottelat and freyhof 2007 the bleak alburnus alburnus is a small cyprinid and prefers open waters of lakes and medium to large rivers the stone loach barbatula barbatula is usually found in medium sized rivers with gravel to stone bottom barbus barbus is a fish of the cyprinid family preferably inhabiting faster flowing summer warm medium to large sized rivers gudgeons of the genus gobio here represented by gobio obtusirostris are riverine cyprinids too which tolerate in contrast to barbels lower flow velocities and finer spawning substrates the bullhead cottus gobio inhabits cold clear and fast flowing water of small streams to medium sized rivers the roach rutilus rutilus is a small fish of the cyprinid family mainly found in nutrient rich large to medium sized lowland rivers and backwaters the trout salmo trutta is a species of salmonid fish preferring cold well oxygenated streams in the mountainous areas the chub squalius cephalus is a fish of the cyprinid family found in slow flowing lowland rivers very small mountain streams and in large streams of barbel zone for each of the five wsos fish occurrence data were aggregated to presence absence information hereafter called catchment scale mapping the final number of catchments of each particular order and their spatial arrangement was thus directly constrained by fish data availability with the wso increase the number of catchments under consideration decreases from 1363 for the wso1 to 126 for the wso5 with a corresponding increase in species prevalence table 2 we note here that because of the dendritic structure of river networks catchment scale mapping is more appropriate for freshwater species than the point to grid mapping used for mapping terrestrial species occurrences see fagan 2002 in addition given that catchments serve as units for freshwater management and conservation commonly referred to as the catchment based approach caba see defra 2013 catchment scale mapping of freshwater species occurrences ensures compatibility between the management and the analysis scales as well as the optimisation of ecological restoration efforts lévêque et al 2008 markovic et al 2017 kuemmerlen et al 2019 2 5 data analysis and modelling a schematic view of the data analysis and modelling workflow is provided in fig 1 univariate strength of the environmental predictor variables was quantified using the weight of evidence woe and information value concepts as implemented in the r library information larsen 2016 while woe describes the relationship between a predictor variable x here environmental predictors listed in table 2 and a binary dependent variable y here species occurrence in a particular catchment information value measures the strength of the y x relationship specifically if b i i 1 k denote k discrete bins for the predictor x then the strength of the predictor in describing y can be quantified as i p x b i y 1 p x b i y 0 w o e i cf larsen 2016 as such information value is suitable for comparing the strength between local and upstream area effects on freshwater fish distribution across multiple scales i e for comparing the predictive power of the environmental factors calculated for the local catchment areas of each watershed order and for the corresponding cumulative upstream catchment areas species distribution modelling was performed using generalized additive models gam r library gam hastie 2005 gam is a non parametric extension of generalized linear methods and is widely used for modelling current and future distribution patterns of fish species previous investigations using various sdms have shown that gam glm generalized linear models and regression tree based sdms have similar validation performance the first two kinds of models had also similar calibration performance while regression tree based sdms tend to overfit during the calibration phase markovic et al 2012 the improved performance of consensus or ensemble methods in providing more accurate and robust projections of species distribution have been already demonstrated marmion et al 2009 buisson et al 2010 lauzeral et al 2013 however the main objective of this study was determining the effect and importance of variation in spatial scale rather than the performance of different sdms therefore we focus here only on gam based sdms but acknowledge the importance of using multiple sdms when the study goal is predicting future species distribution patterns see markovic et al 2012 moreover gams are very flexible models and have well performance at high collinearity dormann et al 2013 species occurrence probabilities resulting from the application of gam were transformed to presence absence information using the thresholds which maximize both sensitivity the true positive rate and the specificity the true negative rate thus the percentage of correctly predicted presences sensitivity and the percentage of correctly predicted absences specificity are jointly maximized we used repeated random splitting 10 times of the fish data into calibration 70 and validation 30 i e each of the 10 models was calibrated using a different 70 data sample and validated using the remaining 30 the repetitive modelling procedure allowed for quantifying the uncertainty of the estimates agreement between the observed and modelled species distribution patterns was quantified by sensitivity and specificity while the performance of the calibrated models was estimated using the area under the receiver operator curve auc and the true skill statistic tss allouche et al 2006 an auc of 0 5 and a tss of 0 indicate that a model has no discriminatory power while an auc or tss of 1 indicate that presences and absences are perfectly discriminated within the multivariate modelling of species distributions three predictor data sets were created one describing only local reach scale effects a second describing only cumulative upstream area effects and a third combined predictor data set comb merging the local the upstream and the cross scale interactions predictor sets in the comb predictor data set the environmental factor with the higher information value of each of the three source data sets was used in the modelling consequently models of distribution patterns of each of the studied species were initiated using three distinct predictor sets resulting in 30 multivariate models per species 10 repetitions 3 predictor data sets for each predictor data set used in modelling of species distribution patterns the condition of pairwise correlations below 0 70 had to be satisfied at all scales i e no multicollinearity correlation matrix for the reach scale is provided in fig a2 thereby within each of the 30 multivariate model runs per species the search for a parsimonious model involved analyses of the model improvement based on the akaike information criterion aic through simultaneous forward and backward predictor selection statistical significance between the aucs for different predictor data sets lca uca and comb was measured using the two sample t test e g wilks 1995 by including statistical testing data sets leading to significantly better performances can be identified and recommended for explaining the fish distributions across the studied scales to quantify the relative predictor importance the variance partitioning method implemented within the r library relaimpo grömping 2006 was used the advantage of the variance partitioning method by lindeman et al 1980 is that it considers sequential sums of squares over all predictor permutations and thus considers the inter correlation effects among the individual predictors we note that high predictor relative importance does not necessarily imply causation 3 results 3 1 local and cumulative upstream effects overall the annual mean temperature and the percentage of area under row crops have the highest information value irrespective of the considered spatial scale lca vs uca and wso1 to wso5 fig 2 a comparison between the information values of the factors derived for the local catchment areas and for the corresponding upstream catchment areas indicated higher predictive strength of the local effects for the climatic predictors anntmean and annpmean up to the fourth order catchments for anthropogenic and land cover factors the information value results suggest that cumulative upstream effects of population population percentage of area covered by row crops rowcrops and artificial surface builtup are likely to be better predictors of fish distribution patterns than the corresponding local catchment effects fig 2f the information values of the cross scale interactions csi here measured as the product of the lca and uca related environmental factors were significantly lower than the information value of the lca and uca factors themselves consequently within the comb predictor data set the factors population rowcrops and builtup were selected from the uca predictor data set while the remaining predictors were selected from the lca predictor data set fig 2f as such none of the csi predictors qualified to be included in the modelling process 3 2 catchment order specific predictor set and model performance due to multicollinearity condition the number of statistically applicable model predictors varied with catchment order of the initially considered eight factors figs a2 a3 the predictor set used at wso1 included six environmental factors table 1 for the lca and comb data sets and five factors for the uca data set although gams have well performance at high collinearity dormann et al 2013 since the majority of sdms are vulnerable to collinearity at higher catchment orders a subset of that at wso1 was used satisfying the condition of pairwise correlations 0 70 furthermore keeping highly correlated predictors in the model would limit both interpretability of the results and drawing inferences on the performance effects of the individual factors within the predictor selection process the one of two highly correlated predictors was used having higher information value fig 2 for instance within the lca predictor set at wso5 annual mean temperature and annual mean precipitation could not be both used in the modelling due to correlation 0 7 wherefore only annual mean temperature was left in the predictor set owing to its higher information value fig 2 as a result at wso5 of the six lca environmental factors used at wso1 only four were applicable annual mean temperature population and percentage of area covered by forest and artificial surface the number of statistically significant model predictors is shown to vary across species and catchment orders table 3 regardless of the species studied the mean number of required parameters decreased with catchment order increase at the wso1 the mean number of statistically significant predictors from the 10 independent model runs per species is between 4 and 5 whereas for describing fish distribution patterns across wso5 only 1 3 predictors were required table 3 overall species distribution models calibrated with the locally estimated predictors required the least number of predictors compared to those calibrated using cumulative upstream area related effects uca and comb the average of the validation aucs across all repetition models of species distribution patterns was above 0 85 for all combinations of catchment order and predictor sets indicating highly accurate models table 4 fig 3 the results above were confirmed by the mean sensitivity and mean specificity which both were above 80 for the majority of the models resulting in mean tss of 0 58 when looking at the model performance per individual species differences in the validation aucs between the models calibrated using the three different predictor data sets lca uca and comb were up to 0 09 but statistically significant only for b barbus wso2 to wso5 c gobio and s trutta wso2 to wso3 in favour of the uca predictor set and for a alburnus and b barbatula wso1 to wso3 in favour of the lca set table 3 for other species wsos consideration of the upstream area effects i e uca and comb predictor set did not contribute to a statistically significant improvement of the model performance when compared to the models using lca predictor set overall when coarsening the grain size i e increasing catchment order both a slight model degradation and a slight model improvement was observed fig 3 accompanied by an increase in the standard deviation of the validation aucs 3 3 predictor importance per species and catchment order predictor importance patterns varied across species and catchment orders figs 4 5 fig a4 a5 table a1 overall irrespective of the type of consideration of the factor influence that is irrespective of whether local cumulative upstream or the combined factor influence was considered climatic factors are shown to be the main drivers of the distribution patterns of the fish species at all catchment orders fig 4 also the relative importance of annual mean temperature generally increased with catchment order fig 4 the relative importance of the annual mean temperature was highest for s trutta 97 2 lca wso4 table a1 for b barbatula c gobio g obtusirostris and the widely distributed s trutta the mean relative importance of the locally derived annual mean precipitation was higher than that of the annual mean temperature for the first three catchment orders fig a4 table a1 with regard to the land cover and anthropogenic factors up to wso2 the relative importance of their local effects was below 20 except for the row crops table a1 we remark that the factor row crops could only be used up to wso2 to avoid multicollinearity with the catchment order increase both a decrease and an increase in relative importance of the land cover and anthropogenic factors were observed fig a5 the relative importance of the upstream and the combined effects were considered only for those species and catchment orders where their use resulted in the statistically significant improvement of the sdms compared to the sdms based on local influences in particular we remind that for b barbus the upstream area consideration of the environmental predictors resulted in statistically significant improvement of the sdms for all catchment orders for c gobio and s trutta for wso2 wso3 while for g obtusirostris only for the 5th order catchments there was a statistically significant improvement in the models performance when using the combined local and upstream area influences for b barbus the upstream related anthropogenic and land use related influences had higher relative importance than the climatic effects up to wso4 fig a4b a5 table a1 c gobio and s trutta distributions across the 2nd order catchments were strongly influenced by the upstream related area under row crops is the mean relative importance was 43 3 for c gobio and 30 3 for s trutta g obtusirostris distributions across the 5th order catchments were mainly influenced by the locally related climatic effects the mean relative importance of the annual mean temperature was 57 7 4 discussion the species distribution models of all included fish species were highly accurate across the studied spatial scales independently of whether or not the cumulative upstream effects were considered the negligible performance differences across the scales and model setups affirm the selection of the environmental factors used for explaining fish distribution patterns and the chosen applied statistical methodology gam the upstream catchment related percentage of area covered by row crops and artificial surface as well as the number of inhabitants per area tend to be better predictors of fish distribution patterns than the corresponding local catchment effects these findings correspond to results from previous studies which highlighted the essential influence of the surrounding landscape on the in stream ecosystem structure and function fausch et al 2002 linke et al 2008 with high nitrate flux positively influencing aquatic plant cover as well as water quality and thus negatively fish species richness the surrounding area covered by row crops is essentially connected to fish distribution patterns strayer et al 2003 the danube river basin has already experienced significant changes in water quality including chemical alterations due to nitrate and other nutrient pollutants from agriculture and various land use factors chapman et al 2016 which are known to favour algal blooms further decreases of oxygen concentrations resulting from water quality degradation are expected which can drastically influence fish species and their ability to cope with warming chapman et al 2016 verberk et al 2016 especially gravel spawning riverine fish species are affected by intensely used cropland specifically intensely used croplands provide a continuous source of fine sediments and siltation of coarse substrates which is followed by the decline of gravel spawning riverine fish species soulsby et al 2001 lapointe et al 2004 greig et al 2005 jensen et al 2009 in contrast to the above discussed land use related factors the climatic factors are shown to display higher information value when calculated for the local catchment areas rather than for the entire upstream catchments as such our finding supports the selection of local climatic conditions in fish species distribution models across all studied scales see also kärcher et al 2019 the observation of climatic factors dominating non climatic factors for the local approach could also be made for all studied species the interactions between the environmental factors manifested low information value however this might be only a reflection of the studied species drivers relationships that do not constitute any proof of the negligible impact of the cross scale interactions overall our results suggest the consideration of scale dependence components when studying species environment relationships and thus factor and species dependent selection between local and upstream area effects paired with appropriate monitoring of effects and management of mitigation activities tailored to ensure species long term persistence the decrease in the number of environmental factors used by the multivariate models with increasing catchment order is generally a consequence of the decrease in the environmental information granularity manifested through a reduction in the environmental variability austin 2007 for instance the mean area size at wso5 2148 km2 is almost 180 times larger than the mean area size at wso1 12 km2 thus the multitude of environmental conditions that exist when considering drivers at the wso1 scale is significantly flattened at the wso5 scale we underline that the number and combination of predictors was species and catchment order specific implying that the use of arbitrary parameter sets for the calibration of sdms is inappropriate and should be replaced by a well founded parameter selection methodology specifically similarly to our past study kärcher et al 2019 our results indicate that for b barbus the relative importance of anthropogenic pressure manifested by either population density or percentage of area covered by artificial surface and row crops is higher than the importance of the climatic factors damming river regulation and fine sediment input are known to influence b barbus kottelat and freyhof 2007 thus the results obtained from the sdms suit well to the ecological classification of this species compared to s trutta which has similar environmental requirements b barbus seems also more susceptible to the effects of land use on water quality and spawning habitat with barbel preferably colonizing lower elevated river reaches this identified difference may simply result from higher cumulative anthropogenic pressure at such lower elevated reaches the influence of anthropogenic pressure is additionally outlined by the ability of cumulative upstream area effects in particular the influence of row crops to describe the distribution of trout and gudgeons of the genus gobio all preferring cold and clean water better than the locally derived effects besides those limitations that we discussed in kärcher et al 2019 the present modelling framework has a number of aspects that can be addressed in future research one of the key aspects is the consideration of hydrological connectivity among catchments assuming non disturbed flow as dams can separate sites form their upstream catchments the inclusion of this complex disturbance factor can alter the impact that upstream factors have on local fish distributions consequently the conclusions resulting from the upstream area approach should be viewed in the context of the difficulty to quantify accurate dam influences also for large transboundary catchments such as the danube river catchment the non uniform level of available species data needs to be addressed the latter includes spatial autocorrelation effects as well as non availability of species data for large catchment parts moreover including point and non point pollution sources has also the potential to refine our results however with regard to the good performance of the calibrated models and the species specific outcomes we argue that the key outcomes would not substantially change even if we would have had better input data or have included additional parameters to our models specifically given the overall good performance of our sdms adding new parameters to our models would rather result in an overfitting than in a meaningful improvement in the model accuracy 5 conclusion negligible effects of the choice between local vs upstream area effects means that a significant portion of freshwater fish patterns can be explained by local reach scale environmental factors this finding implicates that especially for improving fish assemblages river rehabilitation measures at the spatial scale of sites and reaches are highly relevant however we highlight the importance of using upstream effects for population and land cover related predictors when addressing species sensitive to pollution such as b barbus and consequently taking into account the different scale components for investigating species environment relationships in particular our results imply both catchment order dependent and species dependent model complexity and importance of environmental drivers which underlines the importance of compatibility between the scale of factor importance and the species conservation management scale data accessibility statement the environmental datasets analysed during the current study are available at http www worldclim org climatic and topographic data http sedac ciesin columbia edu gpw global rural urban mapping project version1 and https land copernicus eu pan european corine land cover corine land cover database species occurrence data of the project biofresh are available at www freshwaterplatform eu acknowledgements this work was supported by the dfg under grant ma 6593 2 1 and by the horizon 2020 ecopotential project ref 641762 appendix a supplementary data supplementary material related to this article can be found in the online version at doi https doi org 10 1016 j ecolmodel 2019 108818 appendix a supplementary data the following is supplementary data to this article 
24977,niche based species distribution models sdms play a central role in studying species response to environmental change effective management and conservation plans for freshwater ecosystems require sdms that accommodate hierarchical catchment ordering and provide clarity on the performance of such models across multiple scales the scale dependence components considered here are a environment spatial structure represented by hierarchical catchment ordering following the strahler system b analysis grain that included 1st to 5th order catchments and c response grain the grain at which species respond most represented by local and upstream catchment area effects we used fish occurrence data from the danube river basin and various factors representing climate land cover and anthropogenic pressures our results indicate that the choice of response grain local vs upstream area effects and the choice of analysis grain only marginally influence the performance of sdms upstream effects tend to better predict fish distributions than corresponding local effects for anthropogenic and land cover factors in particular for species sensitive to pollution key predictors and their relative importance are scale and species dependent consequently choosing proper species dependent spatial scales and factors is imperative for effective river rehabilitation measures keywords catchment order conservation planning danube freshwater fish species distribution modelling upstream area 1 introduction the majority of studies describing distributions of freshwater species rely on niche based species distribution models sdms buisson et al 2008 lassalle et al 2010 markovic et al 2012 while the methodological aspects of sdms towards reducing model uncertainties have been extensively studied e g thuiller 2004 marmion et al 2009 grenouillet et al 2011 the influence of scale components on predictive power of sdms was less frequently studied following mertes and jetz 2018 the scale dependence components of species environment relationships are 1 spatial structure of the environment 2 analysis grain the grain at which analyses are conducted and 3 response grain the grain at which species respond most strongly to their environment domisch et al 2013 and kärcher et al 2019 have shown that the second scale component analysis grain only marginally influences the performance of sdms however to address the effects of the above defined three scale components on the performance of sdms tailored to freshwater species an integrated modelling framework is needed stream ecologists have long recognized that biodiversity patterns of freshwater species are strongly influenced by the spatial structure of the environment the dendritic structure of stream and river networks cf fausch et al 2002 moreover swan and brown 2017 have shown that restoration activities aiming at increasing biodiversity are more efficient in small isolated streams than in larger well connected downstream reaches accordingly the local diversity of streams and rivers is influenced by the watershed structure and land use within the surrounding river and stream valleys at multiple scales allan et al 1997 allan 2004 black et al 2004 stephenson and morin 2009 and also known as the riverine macrosystem mccluney et al 2014 for example macroinvertebrates and fish are shown to be strongly influenced by riparian land use and instream habitat conditions at the reach scale moerke and lamberti 2006 feld and hering 2007 verdonschot 2009 sui et al 2014 and up to a few kilometres upstream of sampling sites kail et al 2009 kail and wolter 2013 in the era of urgent management response to high environmental pressures to freshwater ecosystems catchment scale hold great promise where fine grain e g reach scale survey data are unavailable given the high vulnerability of freshwater ecosystems to environmental change woodward et al 2010 markovic et al 2017 and the fact that sdms play a central role in conservation and restoration planning at multiple scales e g franklin 2009 it is of fundamental importance to investigate the scale effects on the performance of sdms of freshwater species distributions hierarchical catchment ordering provides a valuable framework to address the effects of the two scale components analysis grain and spatial structure of the environment on models of freshwater species distributions cf allan et al 1997 in our recent study kärcher et al 2019 we have shown that the choice of the analysis grain reflected by the hierarchical catchment order only marginally influences the mean performance of sdms the present study incorporates an additional scale dimension into this discourse the response grain implemented through the combination of local factors and those of the entire upstream catchment namely while the relative importance of factors affecting species distributions is still debated tudesque et al 2014 there is clear evidence for the influence of the upstream area on the occurrence probability of species in a particular stream reach or a site angermeier and winston 1988 allan 2004 despite this evidence and the increased awareness that cause effect relationships should be simultaneously studied at both fine and broad scales see soranno et al 2014 the combination of local factors and those of the entire upstream catchment in shaping distribution patterns of freshwater species had not been sufficiently studied for instance the upstream effects were commonly not considered for the whole upstream catchment but only up to a certain distance from a sampling site e g up to 7 5 km in kail and wolter 2013 the few studies addressing the relationship between a species occurrence probability and upstream effects suggest strong impacts of intensive agricultural land use allan et al 1997 allan 2004 and a higher relative importance of cumulative upstream area conditions than environmental conditions at the reach scale esselman and allan 2010 here we present a comprehensive modelling framework that addresses the scale effects on the performance of sdms describing freshwater fish species distribution patterns the study area includes the danube river basin the spatial structure of the environment and analysis grain are based on the most widely used hierarchical catchment ordering the strahler system strahler 1964 strahler order reflects the hierarchical level of each reach in the whole river network with 1st order assigned to all reaches with no tributaries 2nd order to the confluences of two first order reaches and so on in this study we focus on the reach scale here the catchment area of the river reach where an occurrence of the freshwater fish was observed hereafter called 1st order catchment and the corresponding 2nd to 5th order catchments at each of the hierarchical catchment orders we evaluated the species response grain using environmental factors summarizing effects across catchments of a particular order across the corresponding whole upstream area as well as those summarizing cross scale effects the aims of the present study are 1 to identify for each individual environmental factor whether the entire upstream catchment effect the local reach effect or their interaction are better related to fish distribution patterns and 2 to test whether there is a decrease in the performance of sdms with coarsening analysis grain i e catchment order to test the effects on model performance objective 2 above we compared the performance of sdms for each catchment order based a solely on local catchment effects b solely on upstream catchment effects and c on the combination of local and upstream catchment effects 2 methods as this study is an extension of our previously published work kärcher et al 2019 and thus partially follows the same methodology for convenience the descriptions of the methods are kept the same wherever appropriate 2 1 study area the danube is europe s second largest river basin 801 463 km2 and is shared among more than 80 million people from 19 countries it extends from central europe through the balkans and drains to the black sea fig a1 the danube river delta is one of the world s largest wetlands rich in rare fauna and flora and inscribed on unesco s world heritage list in 1991 due to its large spatial extent and diverse relief the danube river basin also shows great differences in climate the summed annual precipitation ranges from more than 2300 mm in the high mountains to less than 400 mm in the delta region while the mean annual discharge reaches 6460 m3s 1 at the danube delta in romania icpdr 2009 the ecosystems of the danube river basin host over 2000 plant species over 40 mammals and approximately 100 fish species but are also subject to increasing pressure and serious pollution from agriculture industry and municipalities icpdr 2009 2 2 environmental data choice of environmental factors was based on recent studies of fish species distributions buisson et al 2008 lassalle et al 2010 markovic et al 2012 isaak et al 2017 with the predictor selection performed following markovic et al 2012 in total six environmental predictors emerged representing climate land cover and anthropogenic pressure of the study area table 1 climatic and topographic data were extracted from the worldclim 30 arc second approx 1 km 1 km gridded information hijmans et al 2007 the climatic data set included annual mean temperature anntmean and annual mean precipitation annpmean land use of the study area was described by applying three land cover classes percentage of area covered by row crops rowcrops by forest forest and by artificial surface builtup land cover information was extracted from the corine land cover database eea 2011 the number of inhabitants per area population was used as a measure of anthropogenic pressure global rural urban mapping project version1 available at http sedac ciesin columbia edu gpw initially topography of the study area was considered using altitude and slope however due to high correlations above 0 7 with the annual mean temperature both altitude and slope were omitted from further analyses fig a2 as indicated in table 1 the study area encompasses a wide range of environmental conditions 2 3 hierarchical catchment orders and predictor data sets the analyses and modelling were conducted for five different catchment orders watershed order wso1 to wso5 based on the strahler order of the river reaches from the ccm2 pan european catchments database ccm version 2 1 de jager and vogt 2010 the 1st order catchments wso1 are defined according to the drainage areas of the individual river reaches while higher order catchments wso2 wso5 result from groupings of the lower order catchments in a hierarchical way more specifically the wso1 represents here drainage areas of the river reaches with observed species occurrences catchment order increase is reflected in an increasing catchment size with an average ranging from 12 km2 for the wso1 to 2148 km2 for the wso5 for each wso environmental factors were calculated by averaging gridded data across the corresponding local catchment areas lca reflecting the river reach scale and across the cumulative upstream catchment areas uca fig a1 resulting in two distinct predictor data sets the upstream catchment related factors were derived using the pfafstetter coding system of the ccm2 database in r environment r development core team 2019 regarding the lca and the uca predictor data sets the environmental factors represent different statistics resulting from the processing of the gridded data for the local and the upstream catchments mean values for climatic factors percentage values for the land use classes and the sum of the number of inhabitants per area also it is noteworthy that cumulative upstream environmental factors for small 5th order catchments might be very similar over all lower hierarchical wso levels in addition to the lca and the uca predictor data sets we also defined their combined cross scale interactions csi specifically the interactions between the environmental factors were measured using the product of the corresponding lca and the uca predictors to ensure interpretability of our outcomes we used only pairs of identical environmental factors e g lca and uca related percentage of area under row crops and not all possible environmental factor combinations e g a possible but poorly interpretable combination would be the product of lca annual mean precipitation and uca number of inhabitants 2 4 fish data species occurrence data for the danube river basin were provided by partners of the project biofresh www freshwaterplatform eu schinegger et al 2016 for 1364 sites see also fig a1 fisheries data were sampled by either single pass or double pass electrofishing mainly between 1985 and 2002 to ensure an accurate estimate of the species distributions only species with at least 50 occurrences at the largest analysed scale the wso5 were included into the analysis cf coudon and gégout 2007 in total eight species are considered table 2 species ecological characterizations follow kottelat and freyhof 2007 the bleak alburnus alburnus is a small cyprinid and prefers open waters of lakes and medium to large rivers the stone loach barbatula barbatula is usually found in medium sized rivers with gravel to stone bottom barbus barbus is a fish of the cyprinid family preferably inhabiting faster flowing summer warm medium to large sized rivers gudgeons of the genus gobio here represented by gobio obtusirostris are riverine cyprinids too which tolerate in contrast to barbels lower flow velocities and finer spawning substrates the bullhead cottus gobio inhabits cold clear and fast flowing water of small streams to medium sized rivers the roach rutilus rutilus is a small fish of the cyprinid family mainly found in nutrient rich large to medium sized lowland rivers and backwaters the trout salmo trutta is a species of salmonid fish preferring cold well oxygenated streams in the mountainous areas the chub squalius cephalus is a fish of the cyprinid family found in slow flowing lowland rivers very small mountain streams and in large streams of barbel zone for each of the five wsos fish occurrence data were aggregated to presence absence information hereafter called catchment scale mapping the final number of catchments of each particular order and their spatial arrangement was thus directly constrained by fish data availability with the wso increase the number of catchments under consideration decreases from 1363 for the wso1 to 126 for the wso5 with a corresponding increase in species prevalence table 2 we note here that because of the dendritic structure of river networks catchment scale mapping is more appropriate for freshwater species than the point to grid mapping used for mapping terrestrial species occurrences see fagan 2002 in addition given that catchments serve as units for freshwater management and conservation commonly referred to as the catchment based approach caba see defra 2013 catchment scale mapping of freshwater species occurrences ensures compatibility between the management and the analysis scales as well as the optimisation of ecological restoration efforts lévêque et al 2008 markovic et al 2017 kuemmerlen et al 2019 2 5 data analysis and modelling a schematic view of the data analysis and modelling workflow is provided in fig 1 univariate strength of the environmental predictor variables was quantified using the weight of evidence woe and information value concepts as implemented in the r library information larsen 2016 while woe describes the relationship between a predictor variable x here environmental predictors listed in table 2 and a binary dependent variable y here species occurrence in a particular catchment information value measures the strength of the y x relationship specifically if b i i 1 k denote k discrete bins for the predictor x then the strength of the predictor in describing y can be quantified as i p x b i y 1 p x b i y 0 w o e i cf larsen 2016 as such information value is suitable for comparing the strength between local and upstream area effects on freshwater fish distribution across multiple scales i e for comparing the predictive power of the environmental factors calculated for the local catchment areas of each watershed order and for the corresponding cumulative upstream catchment areas species distribution modelling was performed using generalized additive models gam r library gam hastie 2005 gam is a non parametric extension of generalized linear methods and is widely used for modelling current and future distribution patterns of fish species previous investigations using various sdms have shown that gam glm generalized linear models and regression tree based sdms have similar validation performance the first two kinds of models had also similar calibration performance while regression tree based sdms tend to overfit during the calibration phase markovic et al 2012 the improved performance of consensus or ensemble methods in providing more accurate and robust projections of species distribution have been already demonstrated marmion et al 2009 buisson et al 2010 lauzeral et al 2013 however the main objective of this study was determining the effect and importance of variation in spatial scale rather than the performance of different sdms therefore we focus here only on gam based sdms but acknowledge the importance of using multiple sdms when the study goal is predicting future species distribution patterns see markovic et al 2012 moreover gams are very flexible models and have well performance at high collinearity dormann et al 2013 species occurrence probabilities resulting from the application of gam were transformed to presence absence information using the thresholds which maximize both sensitivity the true positive rate and the specificity the true negative rate thus the percentage of correctly predicted presences sensitivity and the percentage of correctly predicted absences specificity are jointly maximized we used repeated random splitting 10 times of the fish data into calibration 70 and validation 30 i e each of the 10 models was calibrated using a different 70 data sample and validated using the remaining 30 the repetitive modelling procedure allowed for quantifying the uncertainty of the estimates agreement between the observed and modelled species distribution patterns was quantified by sensitivity and specificity while the performance of the calibrated models was estimated using the area under the receiver operator curve auc and the true skill statistic tss allouche et al 2006 an auc of 0 5 and a tss of 0 indicate that a model has no discriminatory power while an auc or tss of 1 indicate that presences and absences are perfectly discriminated within the multivariate modelling of species distributions three predictor data sets were created one describing only local reach scale effects a second describing only cumulative upstream area effects and a third combined predictor data set comb merging the local the upstream and the cross scale interactions predictor sets in the comb predictor data set the environmental factor with the higher information value of each of the three source data sets was used in the modelling consequently models of distribution patterns of each of the studied species were initiated using three distinct predictor sets resulting in 30 multivariate models per species 10 repetitions 3 predictor data sets for each predictor data set used in modelling of species distribution patterns the condition of pairwise correlations below 0 70 had to be satisfied at all scales i e no multicollinearity correlation matrix for the reach scale is provided in fig a2 thereby within each of the 30 multivariate model runs per species the search for a parsimonious model involved analyses of the model improvement based on the akaike information criterion aic through simultaneous forward and backward predictor selection statistical significance between the aucs for different predictor data sets lca uca and comb was measured using the two sample t test e g wilks 1995 by including statistical testing data sets leading to significantly better performances can be identified and recommended for explaining the fish distributions across the studied scales to quantify the relative predictor importance the variance partitioning method implemented within the r library relaimpo grömping 2006 was used the advantage of the variance partitioning method by lindeman et al 1980 is that it considers sequential sums of squares over all predictor permutations and thus considers the inter correlation effects among the individual predictors we note that high predictor relative importance does not necessarily imply causation 3 results 3 1 local and cumulative upstream effects overall the annual mean temperature and the percentage of area under row crops have the highest information value irrespective of the considered spatial scale lca vs uca and wso1 to wso5 fig 2 a comparison between the information values of the factors derived for the local catchment areas and for the corresponding upstream catchment areas indicated higher predictive strength of the local effects for the climatic predictors anntmean and annpmean up to the fourth order catchments for anthropogenic and land cover factors the information value results suggest that cumulative upstream effects of population population percentage of area covered by row crops rowcrops and artificial surface builtup are likely to be better predictors of fish distribution patterns than the corresponding local catchment effects fig 2f the information values of the cross scale interactions csi here measured as the product of the lca and uca related environmental factors were significantly lower than the information value of the lca and uca factors themselves consequently within the comb predictor data set the factors population rowcrops and builtup were selected from the uca predictor data set while the remaining predictors were selected from the lca predictor data set fig 2f as such none of the csi predictors qualified to be included in the modelling process 3 2 catchment order specific predictor set and model performance due to multicollinearity condition the number of statistically applicable model predictors varied with catchment order of the initially considered eight factors figs a2 a3 the predictor set used at wso1 included six environmental factors table 1 for the lca and comb data sets and five factors for the uca data set although gams have well performance at high collinearity dormann et al 2013 since the majority of sdms are vulnerable to collinearity at higher catchment orders a subset of that at wso1 was used satisfying the condition of pairwise correlations 0 70 furthermore keeping highly correlated predictors in the model would limit both interpretability of the results and drawing inferences on the performance effects of the individual factors within the predictor selection process the one of two highly correlated predictors was used having higher information value fig 2 for instance within the lca predictor set at wso5 annual mean temperature and annual mean precipitation could not be both used in the modelling due to correlation 0 7 wherefore only annual mean temperature was left in the predictor set owing to its higher information value fig 2 as a result at wso5 of the six lca environmental factors used at wso1 only four were applicable annual mean temperature population and percentage of area covered by forest and artificial surface the number of statistically significant model predictors is shown to vary across species and catchment orders table 3 regardless of the species studied the mean number of required parameters decreased with catchment order increase at the wso1 the mean number of statistically significant predictors from the 10 independent model runs per species is between 4 and 5 whereas for describing fish distribution patterns across wso5 only 1 3 predictors were required table 3 overall species distribution models calibrated with the locally estimated predictors required the least number of predictors compared to those calibrated using cumulative upstream area related effects uca and comb the average of the validation aucs across all repetition models of species distribution patterns was above 0 85 for all combinations of catchment order and predictor sets indicating highly accurate models table 4 fig 3 the results above were confirmed by the mean sensitivity and mean specificity which both were above 80 for the majority of the models resulting in mean tss of 0 58 when looking at the model performance per individual species differences in the validation aucs between the models calibrated using the three different predictor data sets lca uca and comb were up to 0 09 but statistically significant only for b barbus wso2 to wso5 c gobio and s trutta wso2 to wso3 in favour of the uca predictor set and for a alburnus and b barbatula wso1 to wso3 in favour of the lca set table 3 for other species wsos consideration of the upstream area effects i e uca and comb predictor set did not contribute to a statistically significant improvement of the model performance when compared to the models using lca predictor set overall when coarsening the grain size i e increasing catchment order both a slight model degradation and a slight model improvement was observed fig 3 accompanied by an increase in the standard deviation of the validation aucs 3 3 predictor importance per species and catchment order predictor importance patterns varied across species and catchment orders figs 4 5 fig a4 a5 table a1 overall irrespective of the type of consideration of the factor influence that is irrespective of whether local cumulative upstream or the combined factor influence was considered climatic factors are shown to be the main drivers of the distribution patterns of the fish species at all catchment orders fig 4 also the relative importance of annual mean temperature generally increased with catchment order fig 4 the relative importance of the annual mean temperature was highest for s trutta 97 2 lca wso4 table a1 for b barbatula c gobio g obtusirostris and the widely distributed s trutta the mean relative importance of the locally derived annual mean precipitation was higher than that of the annual mean temperature for the first three catchment orders fig a4 table a1 with regard to the land cover and anthropogenic factors up to wso2 the relative importance of their local effects was below 20 except for the row crops table a1 we remark that the factor row crops could only be used up to wso2 to avoid multicollinearity with the catchment order increase both a decrease and an increase in relative importance of the land cover and anthropogenic factors were observed fig a5 the relative importance of the upstream and the combined effects were considered only for those species and catchment orders where their use resulted in the statistically significant improvement of the sdms compared to the sdms based on local influences in particular we remind that for b barbus the upstream area consideration of the environmental predictors resulted in statistically significant improvement of the sdms for all catchment orders for c gobio and s trutta for wso2 wso3 while for g obtusirostris only for the 5th order catchments there was a statistically significant improvement in the models performance when using the combined local and upstream area influences for b barbus the upstream related anthropogenic and land use related influences had higher relative importance than the climatic effects up to wso4 fig a4b a5 table a1 c gobio and s trutta distributions across the 2nd order catchments were strongly influenced by the upstream related area under row crops is the mean relative importance was 43 3 for c gobio and 30 3 for s trutta g obtusirostris distributions across the 5th order catchments were mainly influenced by the locally related climatic effects the mean relative importance of the annual mean temperature was 57 7 4 discussion the species distribution models of all included fish species were highly accurate across the studied spatial scales independently of whether or not the cumulative upstream effects were considered the negligible performance differences across the scales and model setups affirm the selection of the environmental factors used for explaining fish distribution patterns and the chosen applied statistical methodology gam the upstream catchment related percentage of area covered by row crops and artificial surface as well as the number of inhabitants per area tend to be better predictors of fish distribution patterns than the corresponding local catchment effects these findings correspond to results from previous studies which highlighted the essential influence of the surrounding landscape on the in stream ecosystem structure and function fausch et al 2002 linke et al 2008 with high nitrate flux positively influencing aquatic plant cover as well as water quality and thus negatively fish species richness the surrounding area covered by row crops is essentially connected to fish distribution patterns strayer et al 2003 the danube river basin has already experienced significant changes in water quality including chemical alterations due to nitrate and other nutrient pollutants from agriculture and various land use factors chapman et al 2016 which are known to favour algal blooms further decreases of oxygen concentrations resulting from water quality degradation are expected which can drastically influence fish species and their ability to cope with warming chapman et al 2016 verberk et al 2016 especially gravel spawning riverine fish species are affected by intensely used cropland specifically intensely used croplands provide a continuous source of fine sediments and siltation of coarse substrates which is followed by the decline of gravel spawning riverine fish species soulsby et al 2001 lapointe et al 2004 greig et al 2005 jensen et al 2009 in contrast to the above discussed land use related factors the climatic factors are shown to display higher information value when calculated for the local catchment areas rather than for the entire upstream catchments as such our finding supports the selection of local climatic conditions in fish species distribution models across all studied scales see also kärcher et al 2019 the observation of climatic factors dominating non climatic factors for the local approach could also be made for all studied species the interactions between the environmental factors manifested low information value however this might be only a reflection of the studied species drivers relationships that do not constitute any proof of the negligible impact of the cross scale interactions overall our results suggest the consideration of scale dependence components when studying species environment relationships and thus factor and species dependent selection between local and upstream area effects paired with appropriate monitoring of effects and management of mitigation activities tailored to ensure species long term persistence the decrease in the number of environmental factors used by the multivariate models with increasing catchment order is generally a consequence of the decrease in the environmental information granularity manifested through a reduction in the environmental variability austin 2007 for instance the mean area size at wso5 2148 km2 is almost 180 times larger than the mean area size at wso1 12 km2 thus the multitude of environmental conditions that exist when considering drivers at the wso1 scale is significantly flattened at the wso5 scale we underline that the number and combination of predictors was species and catchment order specific implying that the use of arbitrary parameter sets for the calibration of sdms is inappropriate and should be replaced by a well founded parameter selection methodology specifically similarly to our past study kärcher et al 2019 our results indicate that for b barbus the relative importance of anthropogenic pressure manifested by either population density or percentage of area covered by artificial surface and row crops is higher than the importance of the climatic factors damming river regulation and fine sediment input are known to influence b barbus kottelat and freyhof 2007 thus the results obtained from the sdms suit well to the ecological classification of this species compared to s trutta which has similar environmental requirements b barbus seems also more susceptible to the effects of land use on water quality and spawning habitat with barbel preferably colonizing lower elevated river reaches this identified difference may simply result from higher cumulative anthropogenic pressure at such lower elevated reaches the influence of anthropogenic pressure is additionally outlined by the ability of cumulative upstream area effects in particular the influence of row crops to describe the distribution of trout and gudgeons of the genus gobio all preferring cold and clean water better than the locally derived effects besides those limitations that we discussed in kärcher et al 2019 the present modelling framework has a number of aspects that can be addressed in future research one of the key aspects is the consideration of hydrological connectivity among catchments assuming non disturbed flow as dams can separate sites form their upstream catchments the inclusion of this complex disturbance factor can alter the impact that upstream factors have on local fish distributions consequently the conclusions resulting from the upstream area approach should be viewed in the context of the difficulty to quantify accurate dam influences also for large transboundary catchments such as the danube river catchment the non uniform level of available species data needs to be addressed the latter includes spatial autocorrelation effects as well as non availability of species data for large catchment parts moreover including point and non point pollution sources has also the potential to refine our results however with regard to the good performance of the calibrated models and the species specific outcomes we argue that the key outcomes would not substantially change even if we would have had better input data or have included additional parameters to our models specifically given the overall good performance of our sdms adding new parameters to our models would rather result in an overfitting than in a meaningful improvement in the model accuracy 5 conclusion negligible effects of the choice between local vs upstream area effects means that a significant portion of freshwater fish patterns can be explained by local reach scale environmental factors this finding implicates that especially for improving fish assemblages river rehabilitation measures at the spatial scale of sites and reaches are highly relevant however we highlight the importance of using upstream effects for population and land cover related predictors when addressing species sensitive to pollution such as b barbus and consequently taking into account the different scale components for investigating species environment relationships in particular our results imply both catchment order dependent and species dependent model complexity and importance of environmental drivers which underlines the importance of compatibility between the scale of factor importance and the species conservation management scale data accessibility statement the environmental datasets analysed during the current study are available at http www worldclim org climatic and topographic data http sedac ciesin columbia edu gpw global rural urban mapping project version1 and https land copernicus eu pan european corine land cover corine land cover database species occurrence data of the project biofresh are available at www freshwaterplatform eu acknowledgements this work was supported by the dfg under grant ma 6593 2 1 and by the horizon 2020 ecopotential project ref 641762 appendix a supplementary data supplementary material related to this article can be found in the online version at doi https doi org 10 1016 j ecolmodel 2019 108818 appendix a supplementary data the following is supplementary data to this article 
24978,in this kind of model the main characteristic that determines population viability in the long term is the stochastic growth rate sgr denoted λ s when λ s is larger than one the population grows exponentially with probability one and when it is smaller than one the population goes extinct with probability one however even in very simple situations it is not possible to calculate the sgr analytically the literature offers some approximations for the case in which environmental variability is low and there are also some lower and upper bounds but there is no study of the practical situations in which they would be tight some new bounds for the sgr are built and the conditions under which each bound works best are analyzed these bounds are used to give some necessary and some sufficient conditions for population explosion and extinction that are easy to check in practice the general results are applied to several cases amongst them a population structured as juveniles and adults living in an environment switching randomly between rich and poor keywords matrix models environmental stochasticity stochastic growth rate lower bound upper bound extinction 1 introduction we consider matrix population models that incorporate environmental stochasticity which refers to unpredictable temporal fluctuations in environmental conditions a number of different environmental conditions are considered and their variation is characterized by a sequence of random variables corresponding to the different time steps of the discrete system tuljapurkar 1990 caswell 2001 each environment is characterized by its corresponding population projection matrix ppm i e the matrix of vital rates in that environment e g time specific annual ppms gained from a time series of data logofet 2018 elsewhere in this issue it is well known that given certain hypotheses on the pattern of temporal variation and on the set of ppms the total population size grows or decays exponentially with probability one with a rate given by the so called stochastic growth rate λ s sgr which is the stochastic analogue of the dominant eigenvalue for deterministic systems the sgr is the main feature of this kind of models due to its ecological implications and it is widely used by ecologists as a measure of population fitness williams et al 2015 compagnoni et al 2016 mcdonald et al 2016 gremer and venable 2014 a sgr larger than one implies population explosion with probability one whereas a value lower than one implies that the population tends to extinction with probability one it must be stressed that we are adopting cohen s definition for the sgr cohen 1979 because it allows one to directly compare the stochastic rate of growth with its deterministic counterpart although some authors tuljapurkar 1990 caswell 2001 define the sgr as the logarithmic rate of growth i e log λ s the sgr is easy to obtain for scalar models i e in the case of unstructured populations alonso and sanz 2009 however letting aside some settings in which very specific conditions are met tuljapurkar 1990 alonso and sanz 2009 it cannot be derived analytically for structured populations indeed even in relatively simple cases like stochastic leslie models with two age classes there are no closed form expressions for the sgr ffffff as a result in order to obtain the sgr the main tools at the ecologist s disposal are computer simulations williams et al 2015 gremer and venable 2014 certain perturbation techniques like tuljapurkar s approximation λ t to the sgr see tuljapurkar 1990 for the derivation and davison et al 2013 for an application and in certain systems with time scales approximate aggregation techniques that allow one to transform the original system to a scalar one sanz and bravo de la parra 2007 alonso and sanz 2009 sanz and alonso 2010 another strategy that offers valuable information is the derivation of upper and lower bounds for the sgr in addition to the quantitative values of these bounds ecologists can make use of them to extract qualitative information about the model in the following way assume that one knows that 1 c log λ s c throughout this work and for the sake of simplicity in the expressions involved bounds for log λ s rather than for λ s itself will be considered obviously bounds for λ s follow in the form exp c λ s exp c then the population grows to infinity with probability one when c 0 whereas whenever c 0 the population goes extinct with probability one therefore the bounds can be used to obtain sufficient although not necessary conditions for population growth or extinction in the mathematical literature there are some bounds for the sgr that can be quite precise but they must be obtained through complex algorithmic procedures so that there are no closed form expressions for them see protasov and jungers 2013 and the references therein in this work however we are interested in bounds that can be easily obtained and that at least in two stage models can be obtained analytically the literature on mathematical ecology presents a few bounds with those properties cohen 1979 caswell 2001 one of them is μ the rate of growth of the mean population size which is an upper bound several works have compared λ s and μ see tuljapurkar 1990 and the references therein however there is hardly any study on the conditions under which the other bounds work well or a comparison between the different bounds an exception was given by tuljapurkar and orzack 1980 who discussed a case in which one of the bounds is very loose and therefore of little practical interest neither are there studies that use the bounds to obtain analytical conditions for growth or extinction as suggested above the first purpose of this work is to find new upper and lower bounds for the sgr different approaches are followed and as a consequence four different upper and lower bounds will be obtained one of the approaches is only valid in the context of stochastic leslie models with two age classes but the rest of the bounds are valid for general stage classified models moreover in the case of models with two stages closed form expressions for the bounds are provided our second aim is to provide some properties of both the new and known bounds and moreover to give some ideas about the situations in which each one performs best in addition a comparison between the different bounds is carried out finally in order to illustrate their usefulness in a practical application the bounds are used to obtain conditions that guarantee non extinction in a leslie model with two age classes and two possible environments the structure of the paper is as follows section 2 introduces the basic setting of matrix models with environmental stochasticity and the concept of sgr the general setting is particularized in section 2 1 to a stochastic leslie model with two age classes that will be used throughout the paper to illustrate the different results we provide section 3 presents the different bounds already available in the literature and some of their properties in section 4 we make use of a perturbation approach to obtain a new result that is valid for any kind of stochastic matrix model it allows one to compare the sgr of two stochastic systems that share the same pattern of environmental variability but have different ppms then we make use of this general result in order to obtain three new bounds for the sgr section 5 concentrates in the specific case of stochastic leslie models with two age classes and provides bounds that are built by making use of some properties of age structure an analysis and comparison of the different bounds is carried out in section 6 in the context of the aforementioned stochastic leslie model with young and adults and two environments we also relate the bounds with tuljapurkar s second order approximation λ t to the sgr tuljapurkar 1982 section 7 towards which ecologists interested mainly in applications can focus their attention illustrates one of the possible uses of the bounds to obtain analytical conditions for growth or extinction of populations in a setting in which a population is subjected to a rich and a poor environment a discussion of results can be found in section 8 the manuscript is completed with an appendix that contains different proofs together with an important auxiliary result on stochastic matrix population models 2 matrix models with environmental stochasticity we assume that the population lives in an ambient in which there are different environmental states which we suppose indexed by η i where i is a set of indexes examples are i 1 r i ℤ or i ℝ the vital rates corresponding to environment η i are given by the nonnegative ppm a η a η ij 1 i j n ℝ n n and a a η η i is the set of different ppms note that i can theoretically be infinite numerable or denumerable yet for the sake of simplicity we express all expectations considering the numerable case i e in terms of possible infinite sums in the denumerable case all expressions are still valid but the sums must be replaced with the corresponding integrals environmental randomness is characterized by a homogeneous markov chain τ t t 0 1 2 defined on a certain probability space ω f p billingsley 2008 over the state space i for each realization ω ω of the process the population is subjected to environmental conditions τ t 1 ω between times t and t 1 thus the model reads 2 z t 1 a τ t 1 z t where for each t 0 1 z t z 1 t z n t t is a vector random variable in ℝ n which represents the population vector at time t the total population is z t 1 z 1 t z n t the subscript at the norm notation will be further omitted throughout we assume that z 0 is a fixed nonnegative nonzero vector assume that τ t has a unique stationary probability distribution given by π π η η i towards which the t step transition probabilities converge i e π η lim t p τ t η τ 0 ξ for all η ξ i it is well known see appendix a for a precise statement of the result that if the set a is ergodic and an additional technical condition on the speed of convergence of these transition probabilities is met then 1 the joint process τ t z t z t is a markov chain that converges to a certain stationary distribution g 2 there exists the so called stochastic growth rate λ s sgr of system 2 defined through 3 log λ s lim t log z t t where the limit holds with probability one moreover λ s is finite and independent of the initial probabilities of the chain states and of the initial non zero population vector z 0 0 it follows from 3 that if log λ s 0 then the population grows exponentially to infinity with probability one whereas it becomes extinct with probability one whenever log λ s 0 we assume the conditions for the existence of the sgr to hold true throughout this work in the next sections several upper and lower bounds for the sgr will be obtained clearly a desirable property of a sgr bound is that when there is no environmental variation i e in the deterministic case it coincides with the dominant eigenvalue of the corresponding ppm specifically property p we say that a lower or upper bound c for the sgr verifies property p when in the case a η a for all η i it follows that c ρ a where ρ denotes the spectral radius it will be shown that some but not all of the bounds studied in this work verify property p 2 1 a particular case stochastic leslie model with two age classes as an illustration of the general setting above we turn our attention to the case of leslie models with n 2 age classes juveniles and adults the model takes the form 4 z 1 t 1 z 2 t 1 a τ t 1 z 1 t z 2 t where a η f η f η s η 0 η i this simple model will be used to illustrate the different results obtained in model 4 a necessary and sufficient condition for the set a of vital rates to be ergodic is that there exist positive constants α and β such that for all η i f η f η and s η are bounded from above by β and from below by α in that case for any non zero initial condition z 0 the population vector z t is positive for all t 2 the mean matrix with respect to the stationary environmental distribution π is 5 a f f s 0 where f η i π η f η f η i π η f η s η i π η s η 3 known bounds for the sgr this section shows the bounds already known in the literature specifically the rate of growth of the mean population size cohen s bounds and the bounds through a max min approach are considered later on they will be compared with the new bounds proposed in this work rate of growth of the mean population size an important parameter in models of the kind 2 is the rate of growth μ of the mean population size i e 6 log μ lim t log e z t t it is well known that as an immediate consequence of jensen s inequality billingsley 2008 one has 7 λ s μ and so μ is an upper bound for the sgr note that one can have apparently paradoxical situations in which log μ 0 and so the mean population size grows to infinity whereas log λ s 0 and so the population goes extinct with probability one this illustrates the sufficient yet unnecessary essence of condition log μ 0 for population extinction the literature shows cohen 1979 that μ coincides with the dominant eigenvalue of a certain nonnegative matrix d that in the general markovian case depends on matrices a η and on the one step transition probabilities of the chain τ t if for the sake of simplicity we restrict our attention to the case in which τ t is an independent and identically distributed iid process d coincides with the mean environmental matrix i e 8 a η i π η a η it is easy to check that when there is no environmental variability matrix d coincides with the deterministic matrix a and so μ verifies property p in the case of system 4 and iid temporal variation one has log μ log ρ a log f f 2 4 f s 1 2 2 when imposing the sufficient condition for extinction μ 1 the resulting analytical expression can be simplified by using the concept of net reproductive value in matrix models cushing and yicang 1994 indeed if r 0 f s f denotes the net reproductive value corresponding to matrix a the condition μ 1 is equivalent to r 0 1 i e f s f 1 which is therefore a sufficient condition for the extinction of the population cohen s bounds for each η i define the column sums of a η 9 φ η j i 1 n a η ij j 1 n η i and let m η and m η be their respective minimum and maximum i e m η min j 1 n φ η j m η max j 1 n φ η j η i then cohen 1979 one has c i log λ s c i where 10 c i η i π η log m η c i η i π η log m η in tuljapurkar and orzack 1980 certain numerical simulations are carried out that show that at least in the cases covered in the study bounds 10 do not work well bounds 10 are tight when for each η i all the columns of a η sum approximately to the same amount and the contrary happens when the maximum and the minimum of the column sums are very different indeed it is easy to check that they are exact if and only if a η α η p for each η i where α η ℝ and p is a column stochastic matrix another problem of bounds 10 is that they do not verify property p i e they do not coincide with the sgr when there is no environmental variation in the case of system 4 one has 11 c i η i π η log min f η s η f η c i η i π η log max f η s η f η bounds through a max min approach it is immediate to show that if a a ˆ ℝ n n are non negative matrices such that 0 a a η a ˆ η i then c min log λ s c max where 12 c min log ρ a c max log ρ a ˆ clearly these bounds are very easy to obtain and verify property p a serious drawback is that they are independent of the equilibrium environmental distribution π and so they do not weight the relative contribution of the different environments for instance when there is only two environments and a 1 a 2 it is easy to see that c min is very poor whenever π 1 is close to zero in the case of system 4 one has 13 a min η i f η min η i f η min η i s η 0 a ˆ max η i f η max η i f η max η i s η 0 4 a perturbation approach to obtaining bounds for the sgr let us first introduce a new result that relates the sgr of any two stochastic systems of the kind 2 although more general in nature this result will be particularized to certain situations to obtain bounds for the sgr consider the following stochastic system 14 z t 1 b τ t 1 z t where we assume that b η η i is an ergodic set of n n non negative matrices and further that their incidence matrices coincide with those of system 2 that is for all η i one has b η ij 0 if and only if a η ij 0 under the above conditions there exists an sgr that we denote λ s for 14 now we want to relate λ s and λ s in order to do so let us first define matrices w η w η ij 1 i j n η i through 15 w η ij a η ij b η ij b η ij if b η ij 0 0 if b η ij 0 note that w η ij can be thought of as the relative amount of perturbation of a η ij with respect to b η ij let us now set 16 w η m min i j 1 n w η ij w η m max i j 1 n w η ij using the nonnegativity of a η and b η and the fact that the incidence matrix of b η coincides with that of a η we check immediately that 17 w η m w η m 1 then see appendix b one has 18 log λ s η i π η log 1 w η m log λ s log λ s η i π η log 1 w η m the previous result is more general but in this work it is used in the case in which system 14 is deterministic i e b η b for all η i where b is a certain matrix so that λ s ρ b therefore in that case one can write c pert log λ s c pert where 19 c pert log ρ b η i π η log 1 w η m c pert log ρ b η i π η log 1 w η m bounds c pert and c pert have been deduced through a perturbation approach and certainly work better when for each η i matrix a η is a perturbation of b however the bounds are valid even when that is not the case we stress that these bounds are valid in systems of general dimensionality i e n is arbitrary note that when there is no stochasticity w η m w η m 0 for all η i and so the bounds in 19 verify property p as desired obviously different choices of matrix b will lead to different bounds we propose three possibilities 1 b equals the average environmental matrix we take b a e π a τ t η i π η a η i e the average environmental matrix with the average taken with respect to the stationary distribution of τ t we denote c ii and c ii the resulting bounds in 19 for this choice of b in the case of system 4 we have c ii log f f 2 4 f s 1 2 2 η i π η log min 1 f η f f η f s η f c ii log f f 2 4 f s 1 2 2 η i π η log max 1 f η f f η f s η f note that for system 4 and the iid setting one has c ii log ρ a log μ and therefore in this case log μ is always better than c ii as an upper bound for log λ s 2 b equals the max matrix we define b b ij 1 i j n through b ij max η i a η ij and we denote c iii and c iii the resulting bounds in 19 in this case b a ˆ in 12 and w η m 0 for all η i therefore c iii log ρ a ˆ c max and so c iii is always a better upper bound than c max for system 4 one has w η m 0 for all η i and so 20 c iii log max η f η max η f η 2 4 max η f η max η s η 1 2 2 η i π η log 1 min f η max η f η f η max η f η s η max η s η c iii c max log max η f η max η f η 2 4 max η f η max η s η 1 2 2 3 b equals the min matrix we put b ij min η i a η ij and the resulting bounds in 19 are denoted c iv and c iv reasoning like in the previous case one has c iv log ρ a c min and therefore c iv is always a better lower bound than c min in the case of system 4 one has analogous expressions for c iv and c iv to those of 20 we emphasize that the bounds c iii and c iv proposed in this work improve the existing bounds c max and c min respectively there is no rule of thumb for the best choice of matrix b even in very simple situations as when there are only two stages only one vital rate varies and there are two environments which are equiprobable simulations show that in general the optimal choice of b is somewhere inbetween the min and the max matrices sometimes close to the former some to the latter and some others to the average matrix 5 bounds in two class leslie models the idea is to find bounds for the vector of age structure i e the vector with the proportion of young and adults that are valid for large times and that can be used later on to obtain bounds for the sgr as a first step we generalize some results from tuljapurkar 1990 to obtain bounds for the vector of age structure when all three vital rates fertility of the young of the adults and survival are stochastic these bounds on age structure are then used to obtain a new bound for the sgr 5 1 bounds on age structure for two class leslie models we are interested in finding bounds for age structure valid for large values of t i e we want to find deterministic vectors l l 1 l n u u 1 u n ℝ n such that for large enough t one can write 21 l z t z t u these bounds on age structure are relevant in this work since as it is shown later on they can be used to obtain new bounds for the sgr it is not possible to obtain bounds of the kind 21 for system 2 in the general case in tuljapurkar 1990 certain bounds are obtained in the particular case of leslie models although when there is an arbitrary number of age classes the bounds cannot be obtained through closed expressions but must be found through an iterative process here we concentrate in the case of system 4 with n 2 age classes for which closed form expressions can be found first we obtain bounds for the quotient z 2 t z 1 t in the form 22 δ z 2 t z 1 t κ once this is accomplished it is immediate to conclude that the vector of population structure can be bounded as follows 23 δ 1 κ 1 1 κ l z t z t u κ 1 δ 1 1 δ in tuljapurkar 1990 bounds of the kind 22 are obtained in the case in which only the survival of the young is stochastic here we show that following a similar reasoning to that of tuljapurkar 1990 the results can be extended to the case in which the three vital rates are stochastic specifically let us define ε m max η i f η f η ε m min η i f η f η γ m max η i s η f η γ m min η i s η f η then it can be shown see appendix b for the proof that eq 22 holds with 24 δ 2 γ m 1 ε m γ m ε m γ m 1 ε m γ m ε m γ m 2 2 ε m γ m ε m γ m κ 2 γ m 1 ε m γ m ε m γ m 1 ε m γ m ε m γ m 2 2 ε m γ m ε m γ m note that in the deterministic setting i e a η a for all η i bounds δ and κ coincide with the quotient v 2 v 1 where v v 1 v 2 is a right eigenvector of matrix a associated to its dominant eigenvalue and so bounds 23 are exact 5 2 bounds for the sgr using info on age structure consider system 2 and assume that 21 holds for certain known vectors l and u then it follows see appendix b for the proof that c v log λ s c v where 25 c v η i π η log j 1 n l η j φ η j c v η i π η log j 1 n u j φ η j and the φ η j are given by 9 note that in the deterministic case one has l u and so bounds 25 are exact in principle these bounds can be used for any system of the kind 2 but as mentioned before in practice bounds of the kind 21 are not at our disposal in the particular case of model 4 by making use of 23 one obtains c v η i π η log f η s η f η δ 1 κ c v η i π η log f η s η f η κ 1 δ where δ and κ are given by 24 6 analysis and comparison of the different bounds in this section we carry out a comparison of the different bounds which have been previously introduced before we proceed it should be noted that excluding μ the rest of the bounds considered in this work depend on the environmental chain τ t only through its equilibrium distribution π and are therefore independent of the serial correlation between different environments on the other hand we stress that previous studies tuljapurkar 1982 show that the sgr depends strongly on the stationary distribution π but rather weakly on the serial correlation between environments taking these two facts into consideration in order to carry out the comparison between the different bounds we restrict our attention to the iid setting i e there is no serial correlation between environments more specifically we consider the two class leslie model 4 with two different environments note that the environmental process τ t is completely defined through the value of π 1 0 1 in particular we want to find out which upper and which lower bounds wins for each value of the parameter values i e which lower bound is the largest and which upper bound is the lowest even in this simple setting the large number of parameters involved makes an analytical study of the comparison unfeasible so resort to numerical simulations around 2 106 numerical simulations have been performed in which the parameters π 1 f 1 f 2 f 1 f 2 s 1 and s 2 take different values specifically π 1 0 1 0 3 0 5 0 7 0 9 and the vital rates are taken from the following intervals f 1 f 2 0 1 3 f 1 f 2 0 1 5 s 1 s 2 0 1 0 9 the distance between consecutive values of each parameter is 0 2 tables 1 and 2 show the percentage of cases in which each upper bound and each lower wins regarding the upper bounds we can draw the following conclusions μ is the best upper bound in the vast majority of cases this combined with the fact that its analytical expression is relatively simple makes it the best choice of upper bound when one does not want to check which upper bound is the best bounds c ii and c iv never win bounds c i c iii and c v win in approximately the same percentage of cases regarding the lower bounds one can see that c i c iv and c v win in a large percentage of cases but so are c ii and c iii for certain instances in section 7 we illustrate this fact with specific examples simulations have also shown that when the two environments are more or less equiprobable i e π 1 0 5 then c i and c v win in most cases 45 16 and 35 75 respectively for π 1 0 5 and c ii never win but when one environment is much more frequent for example for π 1 0 1 c iii wins in 10 of cases and in the remaining 90 the rest of the bounds win in approximately in the same percentage of cases the second question we want to analyze is how large is the relative error incurred when using the best upper or best lower bound for λ s note that we work with λ s and not with log λ s to avoid having to divide by numbers close to zero when computing the relative error in the cases for which λ s is close to 1 it is reasonable to expect that this error depends strongly on the amount of environmental variation therefore a set of simulations similar to the ones described above has been carried out we have computed the relative error 100 λ s c λ s where c is the best upper or lower bound for λ s and have compared it to the relative amount of environmental variation measured as 100 f 2 f 1 s 2 s 1 f 2 f 1 max f 1 f 2 max s 1 s 2 max f 1 f 2 the sgr cannot be obtained analytically and therefore has been approximated by means of numerical simulations specifically we have used the approach described in tuljapurkar 1997 and in order to keep the computational cost manageable and still obtain a good approximation be have used n 500 samples each of them with a length of t 600 time steps in order to estimate the sampling error for these values of n and t we have compared the results for these values with the ones corresponding to very large values of these parameters specifically n 2000 and t 8000 for which we can expect a very accurate estimate of λ s to be obtained thus we have computed λ s in 100 different cases using both procedures and have obtained that the maximum discrepancy between them is around 0 3 whereas the mean discrepancy is around 0 1 therefore we can consider that the sampling error has almost no effect in the estimation of the relative error for the best upper and lower bounds the results are shown in fig 1 they suggest that both the best upper bound and the best lower bound are quite good approximations to the sgr for a wide range of values of environmental variation they also show that the mean error for the best upper bound is roughly half that corresponding to the best lower bound note the comparatively large standard deviation in the distribution of the error corresponding to both the best upper and best lower bound especially in the latter case we conclude this section with some comments about tuljapurkar s second order approximation to the sgr λ t tuljapurkar 1982 which as pointed out before is a popular tool for ecologists in the previous simulations we have analyzed some properties of λ t and have reached interesting conclusions in the first place in around 95 of cases λ t underestimates the sgr secondly in around 99 of cases λ t is larger than the best lower bound these two points suggest that as a rule of thumb that works in most situations we could consider λ t as a practical lower bound for the sgr although from a rigorous point of view it is not that in many cases performs better that the lower bounds that have been studied in this work 7 a study of growth extinction in a stochastic leslie model as an illustration of a practical use of the bounds presented in this work let us consider the leslie model with two age classes 4 in the following setting there are two possible environments i e i 1 2 environment 1 is rich in the sense that ρ a 1 1 whereas environment 2 is poorer in the sense that the adults fertility is reduced by an amount δ 0 i e a 1 f f s 0 a 2 f f δ s 0 we consider fixed values of f 0 f 0 and s 0 1 with the restriction that ρ a 1 1 or alternatively using the net reproductive value that 26 f sf 1 therefore if subjected to environment 1 alone the population grows to infinity let us consider the iid setting let π 1 0 1 be fixed and let π π 1 1 π 1 be the probability distribution of environmental states clearly when δ 0 we only have environment 1 and the population grows to infinity also as δ increases the population fitness decreases therefore we want to answer the following question what is the maximum value of δ that we denote δmax such that λ s 1 and so the population does not go extinct since the sgr cannot be derived analytically the problem cannot be solved directly our strategy will be to consider one lower bound for the sgr say c log λ s and to obtain the maximum value δ c such that c δ 1 whenever 0 δ δ c consequently if the last inequality holds we know that the population grows to infinity note that δ c δmax i e with this approach we obtain sufficient but not necessary conditions on δ for population growth whenever possible we want to find closed form expressions for δ c in what follows we will complete this process in turn for the different lower bounds for the sgr use of cohen s bound c i 11 we distinguish two situations case a f 1 in that case it is easy to show using 26 that f s f therefore from 11 one has c i log f s π 1 f δ 1 π 1 and therefore c i 0 if and only if δ δ ia f f s π 1 π 1 1 case b f 1 then f s f and c i log f π 1 f δ 1 π 1 so c i 0 if and only if δ δ ib f 1 f 1 π 1 1 use of bound c iii from 20 it follows that c iii log ρ a 1 1 π 1 log 1 δ f and so c iii 0 if and only if δ δ iii f 1 ρ a 1 1 π 1 1 use of bound c iv in this case c iv c min ρ a 2 and so c iv 0 if and only if ρ a 2 1 i e if and only if f s f δ 1 or equivalently δ δ iv f 1 f s one can proceed similarly by working with bound c ii a closed form expression of the maximum value of δ is not possible using c v due to the complexity of the equation involved the question now is to find out for each value of the model parameters which lower bound wins i e which of the different lower bounds provides the largest value of δ for which one can guarantee non extinction in order to address this issue several numerical simulations have been performed that show that even in this particular setting in which only one parameter varies from environment 1 to environment 2 there is no overall best lower bound but different lower bounds can win depending on parameters values fig 2 shows the values of log λ s obtained through numerical simulations and of the lower bounds as functions of δ for three different configurations that we denote case a case b and case c in case a c iv wins and the worst bounds are c i for low values of δ and c iii for larger values the situation changes dramatically in case b for c iii becomes the winner whereas the worst bounds are now c i for low values of δ and c iv for larger values in case c bound c v wins whereas c i and c iii in this case these two bounds coincide are the worst we argued in section 6 that in most practical cases we can consider λ t is a practical lower bound for λ s therefore we could try in principle to find the maximum value of δ proceeding as above however the resulting expression for λ t as a function of δ is very complicated and so it is not possible to find a closed form expression for the maximum value of δ using λ t numerically one can observe that in the three cases a b and c λ t is lower than λ s and that it performs better than the rest of the lower bounds 8 discussion and conclusion except in very particular cases the sgr of matrix population models subjected to environmental stochasticity cannot be derived analytically in this work we have introduced four new upper and lower bounds for the sgr these bounds which at least for two stage models are easy derived as close form expressions can provide both quantitative and qualitative information about ecological models specially relevant is the fact that they can be used to give sufficient conditions for population growth or population extinction see the sections 1 and 7 the bounds for the sgr are been obtained following two different strategies the first one valid for all kind of models is a perturbation approach the second one useful for leslie models with two age classes makes use of certain bounds for the vector of population structure that we have introduced and that generalize previous results in the field the different bounds have been analyzed through computer simulations in the context of leslie models with two age classes in general the best upper bound does a better job at approximating λ s than the best lower bounds as far as the upper bounds are concerned the rate of growth μ of the mean population size is the best upper bound for λ s in the vast majority of cases and so it is the best quick choice for the job as far as the lower bounds are concerned there is no clear winner and the best bound depends strongly on the specific parameter values although a number of general guidelines have been provided it has also been found that tuljapurkar s second order approximation to λ s underestimates λ s in most but not all cases and that it usually performs better that the lower bounds that have been studied in this work section 7 illustrates one of the possible applications of the bounds to the study of stochastic population models there are many more applications in which the bounds can be useful and we proceed to give some ideas about one of them let us consider an age structured stochastic model like that of section 2 1 with two environments in the first environment the dominant eigenvalue of the corresponding ppm is greater that one whereas in the case of the second environment it is less than one by using one lower bound and proceeding like in section 7 we can find a value π 0 1 such that if the asymptotic probability π 1 of environment one verifies π 1 π then the population grows to infinity similarly the use of an upper bound allows one to find a value π ˆ 0 1 such that the population goes extinct whenever π 1 π ˆ appendix a matrix models with environmental stochasticity the following theorem summarizes some results in the literature furstenberg and kesten 1960 cohen 1977 tuljapurkar and orzack 1980 about the dynamics of models of the kind 2 which are relevant in this work theorem 1 let us consider system 2 and assume that a the set a η η i of vital rates matrices is ergodic i e there exists a positive integer g such that any product of g matrices with repetitions allowed drawn from a is a positive matrix i e its components are all positive and moreover there exist constants α β 0 such that for all η i max a η β min a η α where max a η is the maximum of the elements of a η and min a η is the minimum of the positive elements of a η clearly when i is finite the second condition can be omitted 1 the joint process τ t z t z t is a markov chain that converges to a stationary distribution g 2 we can define the stochastic growth rate sgr λ s of system 2 through log λ s lim t log z t t where the limit holds with probability one moreover λ s is finite is independent of the initial probabilities of τ t and of the initial non zero population vector z 0 0 and can be calculated through a 1 log λ s e g log a τ t 1 z t z t where the expectation is taken with respect to the stationary distribution g appendix b proofs proof of the bounds 18 following furstenberg and kesten 1960 and tuljapurkar and orzack 1980 the sgr of system 2 can be calculated through any of the components of the matrix product i e for all i j 1 n we have b 1 log λ s lim t log a τ t a τ t 1 a τ 2 a τ 1 ij t with probability one from 15 we can write a η ij 1 w η ij b η ij for all η i and i j 1 n and therefore for all i j 1 n one has a τ t a τ t 1 a τ 2 a τ 1 ij 1 w τ t m 1 w τ t 1 m 1 w τ 2 m 1 w τ 1 m b τ t b τ t 1 b τ 2 b τ 1 ij from where it follows b 2 log a τ t a τ t 1 a τ 2 a τ 1 ij t log 1 w τ t m 1 w τ t 1 m 1 w τ 2 m 1 w τ 1 m t log b τ t b τ t 1 b τ 2 b τ 1 ij t let us consider the scalar system b 3 x t 1 1 w τ t 1 m x t since according to 17 we have 1 w η m 0 for all η i the set 1 w η m η i is ergodic and therefore system b 3 has a sgr in order to calculate it we use a 1 and take into account that since the system is scalar the process x t x t is trivial equals 1 with probability one so the joint distribution of τ t x t x t coincides with the distribution of τ t and so b 4 lim t log 1 w τ t m 1 w τ t 1 m 1 w τ 2 m 1 w τ 1 m t η i π η log 1 w η m from b 1 it follows that lim t log a τ t a τ t 1 a τ 2 a τ 1 ij t log λ s and lim t log b τ t b τ t 1 b τ 2 b τ 1 ij t log λ s using this facts together with b 4 in b 2 we finally obtain log λ s log λ s η i π η log 1 w η m the other inequality in 18 follows from an analogous reasoning substituting the upper bound in b 2 by the corresponding lower bound proof of bounds 24 for population structure to start with since we are only interested in age structure in matrices a η we can factor out the fertility of the young i e a τ t f τ t 1 ε t γ t 0 where we have defined ε t f τ t f τ t γ t s τ t f τ t and we proceed to work with matrices 1 ε t γ t 0 we use the same reasoning of tuljapurkar in tuljapurkar 1990 and the equivalent to his equation 8 1 3 reads z 2 t 1 z 1 t 1 γ t 1 1 ε t 1 z 2 t z 1 t f t 1 z 2 t z 1 t where function f t 1 is increasing as a function of γ t 1 decreasing as a function of ε t 1 and decreasing as a function of z 2 t z 1 t from the first two assertions if follows that if we define for each value of z 2 t z 1 t f min z 2 t z 1 t γ m 1 ε m z 2 t z 1 t f max z 2 t z 1 t γ m 1 ε m z 2 t z 1 t one has f min z 2 t z 1 t f t 1 z 2 t z 1 t f max z 2 t z 1 t from here and reasoning as in tuljapurkar 1990 section 8 1 we obtain that for any initial vector and large enough t the expression δ z 2 t z 1 t κ holds where b 5 δ lim t δ t κ lim t κ t and δ t and κ t are defined iteratively through b 6 δ 1 f min f max z 2 0 z 1 0 δ t f min f max δ t 1 κ 1 f max f min z 2 0 z 1 0 κ t f max f min κ t 1 the dynamics of δ t can be studied as follows let x min 1 ε m γ m 0 x max 1 ε m γ m 0 and take any positive initial vector z 0 if we apply matrix x max to z 0 and then x min the new population vector verifies that the ratio of adult to young is given by f min f max z 2 0 z 1 0 therefore from b 5 and b 6 we have δ v 2 v 1 where v v 1 v 2 is the dominant eigenvector of matrix x min x max 1 ε m γ m ε m γ m γ m ε m straightforward computations show that δ has indeed the expression given by 24 regarding κ the same reasonings above apply replacing product x min x max by x max x min proof of bounds 25 we make use of a 1 and therefore e g log a τ t 1 z t z t e g log i 1 n j 1 n a τ t 1 ij z j t z t e g log i 1 n j 1 n u η j a τ t 1 ij e g log j 1 n u η j i 1 n a τ t 1 ij e g log j 1 n u η j φ τ t 1 j η i π η log j 1 n u j φ η j where in the last equality we have used that we are taking the expected value of a random variable that is independent of the population structure z t z t thus the expression of c iv has been obtained an analogous reasoning leads to the expression of c iv acknowledgements author is supported by ministerio de economía y competitividad spain project mtm2014 56022 c2 1 p 
24978,in this kind of model the main characteristic that determines population viability in the long term is the stochastic growth rate sgr denoted λ s when λ s is larger than one the population grows exponentially with probability one and when it is smaller than one the population goes extinct with probability one however even in very simple situations it is not possible to calculate the sgr analytically the literature offers some approximations for the case in which environmental variability is low and there are also some lower and upper bounds but there is no study of the practical situations in which they would be tight some new bounds for the sgr are built and the conditions under which each bound works best are analyzed these bounds are used to give some necessary and some sufficient conditions for population explosion and extinction that are easy to check in practice the general results are applied to several cases amongst them a population structured as juveniles and adults living in an environment switching randomly between rich and poor keywords matrix models environmental stochasticity stochastic growth rate lower bound upper bound extinction 1 introduction we consider matrix population models that incorporate environmental stochasticity which refers to unpredictable temporal fluctuations in environmental conditions a number of different environmental conditions are considered and their variation is characterized by a sequence of random variables corresponding to the different time steps of the discrete system tuljapurkar 1990 caswell 2001 each environment is characterized by its corresponding population projection matrix ppm i e the matrix of vital rates in that environment e g time specific annual ppms gained from a time series of data logofet 2018 elsewhere in this issue it is well known that given certain hypotheses on the pattern of temporal variation and on the set of ppms the total population size grows or decays exponentially with probability one with a rate given by the so called stochastic growth rate λ s sgr which is the stochastic analogue of the dominant eigenvalue for deterministic systems the sgr is the main feature of this kind of models due to its ecological implications and it is widely used by ecologists as a measure of population fitness williams et al 2015 compagnoni et al 2016 mcdonald et al 2016 gremer and venable 2014 a sgr larger than one implies population explosion with probability one whereas a value lower than one implies that the population tends to extinction with probability one it must be stressed that we are adopting cohen s definition for the sgr cohen 1979 because it allows one to directly compare the stochastic rate of growth with its deterministic counterpart although some authors tuljapurkar 1990 caswell 2001 define the sgr as the logarithmic rate of growth i e log λ s the sgr is easy to obtain for scalar models i e in the case of unstructured populations alonso and sanz 2009 however letting aside some settings in which very specific conditions are met tuljapurkar 1990 alonso and sanz 2009 it cannot be derived analytically for structured populations indeed even in relatively simple cases like stochastic leslie models with two age classes there are no closed form expressions for the sgr ffffff as a result in order to obtain the sgr the main tools at the ecologist s disposal are computer simulations williams et al 2015 gremer and venable 2014 certain perturbation techniques like tuljapurkar s approximation λ t to the sgr see tuljapurkar 1990 for the derivation and davison et al 2013 for an application and in certain systems with time scales approximate aggregation techniques that allow one to transform the original system to a scalar one sanz and bravo de la parra 2007 alonso and sanz 2009 sanz and alonso 2010 another strategy that offers valuable information is the derivation of upper and lower bounds for the sgr in addition to the quantitative values of these bounds ecologists can make use of them to extract qualitative information about the model in the following way assume that one knows that 1 c log λ s c throughout this work and for the sake of simplicity in the expressions involved bounds for log λ s rather than for λ s itself will be considered obviously bounds for λ s follow in the form exp c λ s exp c then the population grows to infinity with probability one when c 0 whereas whenever c 0 the population goes extinct with probability one therefore the bounds can be used to obtain sufficient although not necessary conditions for population growth or extinction in the mathematical literature there are some bounds for the sgr that can be quite precise but they must be obtained through complex algorithmic procedures so that there are no closed form expressions for them see protasov and jungers 2013 and the references therein in this work however we are interested in bounds that can be easily obtained and that at least in two stage models can be obtained analytically the literature on mathematical ecology presents a few bounds with those properties cohen 1979 caswell 2001 one of them is μ the rate of growth of the mean population size which is an upper bound several works have compared λ s and μ see tuljapurkar 1990 and the references therein however there is hardly any study on the conditions under which the other bounds work well or a comparison between the different bounds an exception was given by tuljapurkar and orzack 1980 who discussed a case in which one of the bounds is very loose and therefore of little practical interest neither are there studies that use the bounds to obtain analytical conditions for growth or extinction as suggested above the first purpose of this work is to find new upper and lower bounds for the sgr different approaches are followed and as a consequence four different upper and lower bounds will be obtained one of the approaches is only valid in the context of stochastic leslie models with two age classes but the rest of the bounds are valid for general stage classified models moreover in the case of models with two stages closed form expressions for the bounds are provided our second aim is to provide some properties of both the new and known bounds and moreover to give some ideas about the situations in which each one performs best in addition a comparison between the different bounds is carried out finally in order to illustrate their usefulness in a practical application the bounds are used to obtain conditions that guarantee non extinction in a leslie model with two age classes and two possible environments the structure of the paper is as follows section 2 introduces the basic setting of matrix models with environmental stochasticity and the concept of sgr the general setting is particularized in section 2 1 to a stochastic leslie model with two age classes that will be used throughout the paper to illustrate the different results we provide section 3 presents the different bounds already available in the literature and some of their properties in section 4 we make use of a perturbation approach to obtain a new result that is valid for any kind of stochastic matrix model it allows one to compare the sgr of two stochastic systems that share the same pattern of environmental variability but have different ppms then we make use of this general result in order to obtain three new bounds for the sgr section 5 concentrates in the specific case of stochastic leslie models with two age classes and provides bounds that are built by making use of some properties of age structure an analysis and comparison of the different bounds is carried out in section 6 in the context of the aforementioned stochastic leslie model with young and adults and two environments we also relate the bounds with tuljapurkar s second order approximation λ t to the sgr tuljapurkar 1982 section 7 towards which ecologists interested mainly in applications can focus their attention illustrates one of the possible uses of the bounds to obtain analytical conditions for growth or extinction of populations in a setting in which a population is subjected to a rich and a poor environment a discussion of results can be found in section 8 the manuscript is completed with an appendix that contains different proofs together with an important auxiliary result on stochastic matrix population models 2 matrix models with environmental stochasticity we assume that the population lives in an ambient in which there are different environmental states which we suppose indexed by η i where i is a set of indexes examples are i 1 r i ℤ or i ℝ the vital rates corresponding to environment η i are given by the nonnegative ppm a η a η ij 1 i j n ℝ n n and a a η η i is the set of different ppms note that i can theoretically be infinite numerable or denumerable yet for the sake of simplicity we express all expectations considering the numerable case i e in terms of possible infinite sums in the denumerable case all expressions are still valid but the sums must be replaced with the corresponding integrals environmental randomness is characterized by a homogeneous markov chain τ t t 0 1 2 defined on a certain probability space ω f p billingsley 2008 over the state space i for each realization ω ω of the process the population is subjected to environmental conditions τ t 1 ω between times t and t 1 thus the model reads 2 z t 1 a τ t 1 z t where for each t 0 1 z t z 1 t z n t t is a vector random variable in ℝ n which represents the population vector at time t the total population is z t 1 z 1 t z n t the subscript at the norm notation will be further omitted throughout we assume that z 0 is a fixed nonnegative nonzero vector assume that τ t has a unique stationary probability distribution given by π π η η i towards which the t step transition probabilities converge i e π η lim t p τ t η τ 0 ξ for all η ξ i it is well known see appendix a for a precise statement of the result that if the set a is ergodic and an additional technical condition on the speed of convergence of these transition probabilities is met then 1 the joint process τ t z t z t is a markov chain that converges to a certain stationary distribution g 2 there exists the so called stochastic growth rate λ s sgr of system 2 defined through 3 log λ s lim t log z t t where the limit holds with probability one moreover λ s is finite and independent of the initial probabilities of the chain states and of the initial non zero population vector z 0 0 it follows from 3 that if log λ s 0 then the population grows exponentially to infinity with probability one whereas it becomes extinct with probability one whenever log λ s 0 we assume the conditions for the existence of the sgr to hold true throughout this work in the next sections several upper and lower bounds for the sgr will be obtained clearly a desirable property of a sgr bound is that when there is no environmental variation i e in the deterministic case it coincides with the dominant eigenvalue of the corresponding ppm specifically property p we say that a lower or upper bound c for the sgr verifies property p when in the case a η a for all η i it follows that c ρ a where ρ denotes the spectral radius it will be shown that some but not all of the bounds studied in this work verify property p 2 1 a particular case stochastic leslie model with two age classes as an illustration of the general setting above we turn our attention to the case of leslie models with n 2 age classes juveniles and adults the model takes the form 4 z 1 t 1 z 2 t 1 a τ t 1 z 1 t z 2 t where a η f η f η s η 0 η i this simple model will be used to illustrate the different results obtained in model 4 a necessary and sufficient condition for the set a of vital rates to be ergodic is that there exist positive constants α and β such that for all η i f η f η and s η are bounded from above by β and from below by α in that case for any non zero initial condition z 0 the population vector z t is positive for all t 2 the mean matrix with respect to the stationary environmental distribution π is 5 a f f s 0 where f η i π η f η f η i π η f η s η i π η s η 3 known bounds for the sgr this section shows the bounds already known in the literature specifically the rate of growth of the mean population size cohen s bounds and the bounds through a max min approach are considered later on they will be compared with the new bounds proposed in this work rate of growth of the mean population size an important parameter in models of the kind 2 is the rate of growth μ of the mean population size i e 6 log μ lim t log e z t t it is well known that as an immediate consequence of jensen s inequality billingsley 2008 one has 7 λ s μ and so μ is an upper bound for the sgr note that one can have apparently paradoxical situations in which log μ 0 and so the mean population size grows to infinity whereas log λ s 0 and so the population goes extinct with probability one this illustrates the sufficient yet unnecessary essence of condition log μ 0 for population extinction the literature shows cohen 1979 that μ coincides with the dominant eigenvalue of a certain nonnegative matrix d that in the general markovian case depends on matrices a η and on the one step transition probabilities of the chain τ t if for the sake of simplicity we restrict our attention to the case in which τ t is an independent and identically distributed iid process d coincides with the mean environmental matrix i e 8 a η i π η a η it is easy to check that when there is no environmental variability matrix d coincides with the deterministic matrix a and so μ verifies property p in the case of system 4 and iid temporal variation one has log μ log ρ a log f f 2 4 f s 1 2 2 when imposing the sufficient condition for extinction μ 1 the resulting analytical expression can be simplified by using the concept of net reproductive value in matrix models cushing and yicang 1994 indeed if r 0 f s f denotes the net reproductive value corresponding to matrix a the condition μ 1 is equivalent to r 0 1 i e f s f 1 which is therefore a sufficient condition for the extinction of the population cohen s bounds for each η i define the column sums of a η 9 φ η j i 1 n a η ij j 1 n η i and let m η and m η be their respective minimum and maximum i e m η min j 1 n φ η j m η max j 1 n φ η j η i then cohen 1979 one has c i log λ s c i where 10 c i η i π η log m η c i η i π η log m η in tuljapurkar and orzack 1980 certain numerical simulations are carried out that show that at least in the cases covered in the study bounds 10 do not work well bounds 10 are tight when for each η i all the columns of a η sum approximately to the same amount and the contrary happens when the maximum and the minimum of the column sums are very different indeed it is easy to check that they are exact if and only if a η α η p for each η i where α η ℝ and p is a column stochastic matrix another problem of bounds 10 is that they do not verify property p i e they do not coincide with the sgr when there is no environmental variation in the case of system 4 one has 11 c i η i π η log min f η s η f η c i η i π η log max f η s η f η bounds through a max min approach it is immediate to show that if a a ˆ ℝ n n are non negative matrices such that 0 a a η a ˆ η i then c min log λ s c max where 12 c min log ρ a c max log ρ a ˆ clearly these bounds are very easy to obtain and verify property p a serious drawback is that they are independent of the equilibrium environmental distribution π and so they do not weight the relative contribution of the different environments for instance when there is only two environments and a 1 a 2 it is easy to see that c min is very poor whenever π 1 is close to zero in the case of system 4 one has 13 a min η i f η min η i f η min η i s η 0 a ˆ max η i f η max η i f η max η i s η 0 4 a perturbation approach to obtaining bounds for the sgr let us first introduce a new result that relates the sgr of any two stochastic systems of the kind 2 although more general in nature this result will be particularized to certain situations to obtain bounds for the sgr consider the following stochastic system 14 z t 1 b τ t 1 z t where we assume that b η η i is an ergodic set of n n non negative matrices and further that their incidence matrices coincide with those of system 2 that is for all η i one has b η ij 0 if and only if a η ij 0 under the above conditions there exists an sgr that we denote λ s for 14 now we want to relate λ s and λ s in order to do so let us first define matrices w η w η ij 1 i j n η i through 15 w η ij a η ij b η ij b η ij if b η ij 0 0 if b η ij 0 note that w η ij can be thought of as the relative amount of perturbation of a η ij with respect to b η ij let us now set 16 w η m min i j 1 n w η ij w η m max i j 1 n w η ij using the nonnegativity of a η and b η and the fact that the incidence matrix of b η coincides with that of a η we check immediately that 17 w η m w η m 1 then see appendix b one has 18 log λ s η i π η log 1 w η m log λ s log λ s η i π η log 1 w η m the previous result is more general but in this work it is used in the case in which system 14 is deterministic i e b η b for all η i where b is a certain matrix so that λ s ρ b therefore in that case one can write c pert log λ s c pert where 19 c pert log ρ b η i π η log 1 w η m c pert log ρ b η i π η log 1 w η m bounds c pert and c pert have been deduced through a perturbation approach and certainly work better when for each η i matrix a η is a perturbation of b however the bounds are valid even when that is not the case we stress that these bounds are valid in systems of general dimensionality i e n is arbitrary note that when there is no stochasticity w η m w η m 0 for all η i and so the bounds in 19 verify property p as desired obviously different choices of matrix b will lead to different bounds we propose three possibilities 1 b equals the average environmental matrix we take b a e π a τ t η i π η a η i e the average environmental matrix with the average taken with respect to the stationary distribution of τ t we denote c ii and c ii the resulting bounds in 19 for this choice of b in the case of system 4 we have c ii log f f 2 4 f s 1 2 2 η i π η log min 1 f η f f η f s η f c ii log f f 2 4 f s 1 2 2 η i π η log max 1 f η f f η f s η f note that for system 4 and the iid setting one has c ii log ρ a log μ and therefore in this case log μ is always better than c ii as an upper bound for log λ s 2 b equals the max matrix we define b b ij 1 i j n through b ij max η i a η ij and we denote c iii and c iii the resulting bounds in 19 in this case b a ˆ in 12 and w η m 0 for all η i therefore c iii log ρ a ˆ c max and so c iii is always a better upper bound than c max for system 4 one has w η m 0 for all η i and so 20 c iii log max η f η max η f η 2 4 max η f η max η s η 1 2 2 η i π η log 1 min f η max η f η f η max η f η s η max η s η c iii c max log max η f η max η f η 2 4 max η f η max η s η 1 2 2 3 b equals the min matrix we put b ij min η i a η ij and the resulting bounds in 19 are denoted c iv and c iv reasoning like in the previous case one has c iv log ρ a c min and therefore c iv is always a better lower bound than c min in the case of system 4 one has analogous expressions for c iv and c iv to those of 20 we emphasize that the bounds c iii and c iv proposed in this work improve the existing bounds c max and c min respectively there is no rule of thumb for the best choice of matrix b even in very simple situations as when there are only two stages only one vital rate varies and there are two environments which are equiprobable simulations show that in general the optimal choice of b is somewhere inbetween the min and the max matrices sometimes close to the former some to the latter and some others to the average matrix 5 bounds in two class leslie models the idea is to find bounds for the vector of age structure i e the vector with the proportion of young and adults that are valid for large times and that can be used later on to obtain bounds for the sgr as a first step we generalize some results from tuljapurkar 1990 to obtain bounds for the vector of age structure when all three vital rates fertility of the young of the adults and survival are stochastic these bounds on age structure are then used to obtain a new bound for the sgr 5 1 bounds on age structure for two class leslie models we are interested in finding bounds for age structure valid for large values of t i e we want to find deterministic vectors l l 1 l n u u 1 u n ℝ n such that for large enough t one can write 21 l z t z t u these bounds on age structure are relevant in this work since as it is shown later on they can be used to obtain new bounds for the sgr it is not possible to obtain bounds of the kind 21 for system 2 in the general case in tuljapurkar 1990 certain bounds are obtained in the particular case of leslie models although when there is an arbitrary number of age classes the bounds cannot be obtained through closed expressions but must be found through an iterative process here we concentrate in the case of system 4 with n 2 age classes for which closed form expressions can be found first we obtain bounds for the quotient z 2 t z 1 t in the form 22 δ z 2 t z 1 t κ once this is accomplished it is immediate to conclude that the vector of population structure can be bounded as follows 23 δ 1 κ 1 1 κ l z t z t u κ 1 δ 1 1 δ in tuljapurkar 1990 bounds of the kind 22 are obtained in the case in which only the survival of the young is stochastic here we show that following a similar reasoning to that of tuljapurkar 1990 the results can be extended to the case in which the three vital rates are stochastic specifically let us define ε m max η i f η f η ε m min η i f η f η γ m max η i s η f η γ m min η i s η f η then it can be shown see appendix b for the proof that eq 22 holds with 24 δ 2 γ m 1 ε m γ m ε m γ m 1 ε m γ m ε m γ m 2 2 ε m γ m ε m γ m κ 2 γ m 1 ε m γ m ε m γ m 1 ε m γ m ε m γ m 2 2 ε m γ m ε m γ m note that in the deterministic setting i e a η a for all η i bounds δ and κ coincide with the quotient v 2 v 1 where v v 1 v 2 is a right eigenvector of matrix a associated to its dominant eigenvalue and so bounds 23 are exact 5 2 bounds for the sgr using info on age structure consider system 2 and assume that 21 holds for certain known vectors l and u then it follows see appendix b for the proof that c v log λ s c v where 25 c v η i π η log j 1 n l η j φ η j c v η i π η log j 1 n u j φ η j and the φ η j are given by 9 note that in the deterministic case one has l u and so bounds 25 are exact in principle these bounds can be used for any system of the kind 2 but as mentioned before in practice bounds of the kind 21 are not at our disposal in the particular case of model 4 by making use of 23 one obtains c v η i π η log f η s η f η δ 1 κ c v η i π η log f η s η f η κ 1 δ where δ and κ are given by 24 6 analysis and comparison of the different bounds in this section we carry out a comparison of the different bounds which have been previously introduced before we proceed it should be noted that excluding μ the rest of the bounds considered in this work depend on the environmental chain τ t only through its equilibrium distribution π and are therefore independent of the serial correlation between different environments on the other hand we stress that previous studies tuljapurkar 1982 show that the sgr depends strongly on the stationary distribution π but rather weakly on the serial correlation between environments taking these two facts into consideration in order to carry out the comparison between the different bounds we restrict our attention to the iid setting i e there is no serial correlation between environments more specifically we consider the two class leslie model 4 with two different environments note that the environmental process τ t is completely defined through the value of π 1 0 1 in particular we want to find out which upper and which lower bounds wins for each value of the parameter values i e which lower bound is the largest and which upper bound is the lowest even in this simple setting the large number of parameters involved makes an analytical study of the comparison unfeasible so resort to numerical simulations around 2 106 numerical simulations have been performed in which the parameters π 1 f 1 f 2 f 1 f 2 s 1 and s 2 take different values specifically π 1 0 1 0 3 0 5 0 7 0 9 and the vital rates are taken from the following intervals f 1 f 2 0 1 3 f 1 f 2 0 1 5 s 1 s 2 0 1 0 9 the distance between consecutive values of each parameter is 0 2 tables 1 and 2 show the percentage of cases in which each upper bound and each lower wins regarding the upper bounds we can draw the following conclusions μ is the best upper bound in the vast majority of cases this combined with the fact that its analytical expression is relatively simple makes it the best choice of upper bound when one does not want to check which upper bound is the best bounds c ii and c iv never win bounds c i c iii and c v win in approximately the same percentage of cases regarding the lower bounds one can see that c i c iv and c v win in a large percentage of cases but so are c ii and c iii for certain instances in section 7 we illustrate this fact with specific examples simulations have also shown that when the two environments are more or less equiprobable i e π 1 0 5 then c i and c v win in most cases 45 16 and 35 75 respectively for π 1 0 5 and c ii never win but when one environment is much more frequent for example for π 1 0 1 c iii wins in 10 of cases and in the remaining 90 the rest of the bounds win in approximately in the same percentage of cases the second question we want to analyze is how large is the relative error incurred when using the best upper or best lower bound for λ s note that we work with λ s and not with log λ s to avoid having to divide by numbers close to zero when computing the relative error in the cases for which λ s is close to 1 it is reasonable to expect that this error depends strongly on the amount of environmental variation therefore a set of simulations similar to the ones described above has been carried out we have computed the relative error 100 λ s c λ s where c is the best upper or lower bound for λ s and have compared it to the relative amount of environmental variation measured as 100 f 2 f 1 s 2 s 1 f 2 f 1 max f 1 f 2 max s 1 s 2 max f 1 f 2 the sgr cannot be obtained analytically and therefore has been approximated by means of numerical simulations specifically we have used the approach described in tuljapurkar 1997 and in order to keep the computational cost manageable and still obtain a good approximation be have used n 500 samples each of them with a length of t 600 time steps in order to estimate the sampling error for these values of n and t we have compared the results for these values with the ones corresponding to very large values of these parameters specifically n 2000 and t 8000 for which we can expect a very accurate estimate of λ s to be obtained thus we have computed λ s in 100 different cases using both procedures and have obtained that the maximum discrepancy between them is around 0 3 whereas the mean discrepancy is around 0 1 therefore we can consider that the sampling error has almost no effect in the estimation of the relative error for the best upper and lower bounds the results are shown in fig 1 they suggest that both the best upper bound and the best lower bound are quite good approximations to the sgr for a wide range of values of environmental variation they also show that the mean error for the best upper bound is roughly half that corresponding to the best lower bound note the comparatively large standard deviation in the distribution of the error corresponding to both the best upper and best lower bound especially in the latter case we conclude this section with some comments about tuljapurkar s second order approximation to the sgr λ t tuljapurkar 1982 which as pointed out before is a popular tool for ecologists in the previous simulations we have analyzed some properties of λ t and have reached interesting conclusions in the first place in around 95 of cases λ t underestimates the sgr secondly in around 99 of cases λ t is larger than the best lower bound these two points suggest that as a rule of thumb that works in most situations we could consider λ t as a practical lower bound for the sgr although from a rigorous point of view it is not that in many cases performs better that the lower bounds that have been studied in this work 7 a study of growth extinction in a stochastic leslie model as an illustration of a practical use of the bounds presented in this work let us consider the leslie model with two age classes 4 in the following setting there are two possible environments i e i 1 2 environment 1 is rich in the sense that ρ a 1 1 whereas environment 2 is poorer in the sense that the adults fertility is reduced by an amount δ 0 i e a 1 f f s 0 a 2 f f δ s 0 we consider fixed values of f 0 f 0 and s 0 1 with the restriction that ρ a 1 1 or alternatively using the net reproductive value that 26 f sf 1 therefore if subjected to environment 1 alone the population grows to infinity let us consider the iid setting let π 1 0 1 be fixed and let π π 1 1 π 1 be the probability distribution of environmental states clearly when δ 0 we only have environment 1 and the population grows to infinity also as δ increases the population fitness decreases therefore we want to answer the following question what is the maximum value of δ that we denote δmax such that λ s 1 and so the population does not go extinct since the sgr cannot be derived analytically the problem cannot be solved directly our strategy will be to consider one lower bound for the sgr say c log λ s and to obtain the maximum value δ c such that c δ 1 whenever 0 δ δ c consequently if the last inequality holds we know that the population grows to infinity note that δ c δmax i e with this approach we obtain sufficient but not necessary conditions on δ for population growth whenever possible we want to find closed form expressions for δ c in what follows we will complete this process in turn for the different lower bounds for the sgr use of cohen s bound c i 11 we distinguish two situations case a f 1 in that case it is easy to show using 26 that f s f therefore from 11 one has c i log f s π 1 f δ 1 π 1 and therefore c i 0 if and only if δ δ ia f f s π 1 π 1 1 case b f 1 then f s f and c i log f π 1 f δ 1 π 1 so c i 0 if and only if δ δ ib f 1 f 1 π 1 1 use of bound c iii from 20 it follows that c iii log ρ a 1 1 π 1 log 1 δ f and so c iii 0 if and only if δ δ iii f 1 ρ a 1 1 π 1 1 use of bound c iv in this case c iv c min ρ a 2 and so c iv 0 if and only if ρ a 2 1 i e if and only if f s f δ 1 or equivalently δ δ iv f 1 f s one can proceed similarly by working with bound c ii a closed form expression of the maximum value of δ is not possible using c v due to the complexity of the equation involved the question now is to find out for each value of the model parameters which lower bound wins i e which of the different lower bounds provides the largest value of δ for which one can guarantee non extinction in order to address this issue several numerical simulations have been performed that show that even in this particular setting in which only one parameter varies from environment 1 to environment 2 there is no overall best lower bound but different lower bounds can win depending on parameters values fig 2 shows the values of log λ s obtained through numerical simulations and of the lower bounds as functions of δ for three different configurations that we denote case a case b and case c in case a c iv wins and the worst bounds are c i for low values of δ and c iii for larger values the situation changes dramatically in case b for c iii becomes the winner whereas the worst bounds are now c i for low values of δ and c iv for larger values in case c bound c v wins whereas c i and c iii in this case these two bounds coincide are the worst we argued in section 6 that in most practical cases we can consider λ t is a practical lower bound for λ s therefore we could try in principle to find the maximum value of δ proceeding as above however the resulting expression for λ t as a function of δ is very complicated and so it is not possible to find a closed form expression for the maximum value of δ using λ t numerically one can observe that in the three cases a b and c λ t is lower than λ s and that it performs better than the rest of the lower bounds 8 discussion and conclusion except in very particular cases the sgr of matrix population models subjected to environmental stochasticity cannot be derived analytically in this work we have introduced four new upper and lower bounds for the sgr these bounds which at least for two stage models are easy derived as close form expressions can provide both quantitative and qualitative information about ecological models specially relevant is the fact that they can be used to give sufficient conditions for population growth or population extinction see the sections 1 and 7 the bounds for the sgr are been obtained following two different strategies the first one valid for all kind of models is a perturbation approach the second one useful for leslie models with two age classes makes use of certain bounds for the vector of population structure that we have introduced and that generalize previous results in the field the different bounds have been analyzed through computer simulations in the context of leslie models with two age classes in general the best upper bound does a better job at approximating λ s than the best lower bounds as far as the upper bounds are concerned the rate of growth μ of the mean population size is the best upper bound for λ s in the vast majority of cases and so it is the best quick choice for the job as far as the lower bounds are concerned there is no clear winner and the best bound depends strongly on the specific parameter values although a number of general guidelines have been provided it has also been found that tuljapurkar s second order approximation to λ s underestimates λ s in most but not all cases and that it usually performs better that the lower bounds that have been studied in this work section 7 illustrates one of the possible applications of the bounds to the study of stochastic population models there are many more applications in which the bounds can be useful and we proceed to give some ideas about one of them let us consider an age structured stochastic model like that of section 2 1 with two environments in the first environment the dominant eigenvalue of the corresponding ppm is greater that one whereas in the case of the second environment it is less than one by using one lower bound and proceeding like in section 7 we can find a value π 0 1 such that if the asymptotic probability π 1 of environment one verifies π 1 π then the population grows to infinity similarly the use of an upper bound allows one to find a value π ˆ 0 1 such that the population goes extinct whenever π 1 π ˆ appendix a matrix models with environmental stochasticity the following theorem summarizes some results in the literature furstenberg and kesten 1960 cohen 1977 tuljapurkar and orzack 1980 about the dynamics of models of the kind 2 which are relevant in this work theorem 1 let us consider system 2 and assume that a the set a η η i of vital rates matrices is ergodic i e there exists a positive integer g such that any product of g matrices with repetitions allowed drawn from a is a positive matrix i e its components are all positive and moreover there exist constants α β 0 such that for all η i max a η β min a η α where max a η is the maximum of the elements of a η and min a η is the minimum of the positive elements of a η clearly when i is finite the second condition can be omitted 1 the joint process τ t z t z t is a markov chain that converges to a stationary distribution g 2 we can define the stochastic growth rate sgr λ s of system 2 through log λ s lim t log z t t where the limit holds with probability one moreover λ s is finite is independent of the initial probabilities of τ t and of the initial non zero population vector z 0 0 and can be calculated through a 1 log λ s e g log a τ t 1 z t z t where the expectation is taken with respect to the stationary distribution g appendix b proofs proof of the bounds 18 following furstenberg and kesten 1960 and tuljapurkar and orzack 1980 the sgr of system 2 can be calculated through any of the components of the matrix product i e for all i j 1 n we have b 1 log λ s lim t log a τ t a τ t 1 a τ 2 a τ 1 ij t with probability one from 15 we can write a η ij 1 w η ij b η ij for all η i and i j 1 n and therefore for all i j 1 n one has a τ t a τ t 1 a τ 2 a τ 1 ij 1 w τ t m 1 w τ t 1 m 1 w τ 2 m 1 w τ 1 m b τ t b τ t 1 b τ 2 b τ 1 ij from where it follows b 2 log a τ t a τ t 1 a τ 2 a τ 1 ij t log 1 w τ t m 1 w τ t 1 m 1 w τ 2 m 1 w τ 1 m t log b τ t b τ t 1 b τ 2 b τ 1 ij t let us consider the scalar system b 3 x t 1 1 w τ t 1 m x t since according to 17 we have 1 w η m 0 for all η i the set 1 w η m η i is ergodic and therefore system b 3 has a sgr in order to calculate it we use a 1 and take into account that since the system is scalar the process x t x t is trivial equals 1 with probability one so the joint distribution of τ t x t x t coincides with the distribution of τ t and so b 4 lim t log 1 w τ t m 1 w τ t 1 m 1 w τ 2 m 1 w τ 1 m t η i π η log 1 w η m from b 1 it follows that lim t log a τ t a τ t 1 a τ 2 a τ 1 ij t log λ s and lim t log b τ t b τ t 1 b τ 2 b τ 1 ij t log λ s using this facts together with b 4 in b 2 we finally obtain log λ s log λ s η i π η log 1 w η m the other inequality in 18 follows from an analogous reasoning substituting the upper bound in b 2 by the corresponding lower bound proof of bounds 24 for population structure to start with since we are only interested in age structure in matrices a η we can factor out the fertility of the young i e a τ t f τ t 1 ε t γ t 0 where we have defined ε t f τ t f τ t γ t s τ t f τ t and we proceed to work with matrices 1 ε t γ t 0 we use the same reasoning of tuljapurkar in tuljapurkar 1990 and the equivalent to his equation 8 1 3 reads z 2 t 1 z 1 t 1 γ t 1 1 ε t 1 z 2 t z 1 t f t 1 z 2 t z 1 t where function f t 1 is increasing as a function of γ t 1 decreasing as a function of ε t 1 and decreasing as a function of z 2 t z 1 t from the first two assertions if follows that if we define for each value of z 2 t z 1 t f min z 2 t z 1 t γ m 1 ε m z 2 t z 1 t f max z 2 t z 1 t γ m 1 ε m z 2 t z 1 t one has f min z 2 t z 1 t f t 1 z 2 t z 1 t f max z 2 t z 1 t from here and reasoning as in tuljapurkar 1990 section 8 1 we obtain that for any initial vector and large enough t the expression δ z 2 t z 1 t κ holds where b 5 δ lim t δ t κ lim t κ t and δ t and κ t are defined iteratively through b 6 δ 1 f min f max z 2 0 z 1 0 δ t f min f max δ t 1 κ 1 f max f min z 2 0 z 1 0 κ t f max f min κ t 1 the dynamics of δ t can be studied as follows let x min 1 ε m γ m 0 x max 1 ε m γ m 0 and take any positive initial vector z 0 if we apply matrix x max to z 0 and then x min the new population vector verifies that the ratio of adult to young is given by f min f max z 2 0 z 1 0 therefore from b 5 and b 6 we have δ v 2 v 1 where v v 1 v 2 is the dominant eigenvector of matrix x min x max 1 ε m γ m ε m γ m γ m ε m straightforward computations show that δ has indeed the expression given by 24 regarding κ the same reasonings above apply replacing product x min x max by x max x min proof of bounds 25 we make use of a 1 and therefore e g log a τ t 1 z t z t e g log i 1 n j 1 n a τ t 1 ij z j t z t e g log i 1 n j 1 n u η j a τ t 1 ij e g log j 1 n u η j i 1 n a τ t 1 ij e g log j 1 n u η j φ τ t 1 j η i π η log j 1 n u j φ η j where in the last equality we have used that we are taking the expected value of a random variable that is independent of the population structure z t z t thus the expression of c iv has been obtained an analogous reasoning leads to the expression of c iv acknowledgements author is supported by ministerio de economía y competitividad spain project mtm2014 56022 c2 1 p 
24979,species distribution modelling sdm techniques were originally developed in the mid 1980s in this century they are gaining increasing attention in the literature and in practical use as a powerful tool to support forest management strategies especially under climate change in this review paper we consider species occurrence datasets climatic and soil predictor variables modelling algorithms evaluation methods and widely used software for sdm studies we describe several important and freely available sources for species occurrence and interpolated climatic data we outline the use of both presence only and presence absence modelling algorithms including distance based algorithms machine learning algorithms and regression based models we conclude that sdm techniques provide a valuable asset for forest managers however it is essential to consider uncertainties behind the use of future climate change scenarios keywords forest modeling ecological mathematics climate change scenarios spatial analyses ecology ecosystem services from forests 1 introduction the future dynamics and spatial distribution of forest ecosystems is a key issue for biodiversity conservation under the many uncertainties generated by climate change rehfeldt et al 2014 walentowski et al 2017 forest ecosystems deliver a wide range of benefits to human beings and achieving the sustainable use of natural resources is central to research in many disciplines knowledge concerning the current spatial occurrence of forest species the influence of ecological drivers e g climate soil and the possible erosion or expansion of their envelopes of suitability is required by decision makers in order to detect both threatened areas and possible refuges pecchi et al 2019 williams and dumroese 2013 the use of better adapted forest tree species genotypes and provenance selection genotyping has the potential to improve the resilience of forest systems and allow assisted migration strategies hanewinkel et al 2014 marchi and ducci 2018 thus assisting the adaptive processes of forest ecosystems ferrarini et al 2016 since the emergence of modelling techniques spatial data including aerial images cartographic layers and national forest inventories have been fundamental resources for statistical mapping di biase et al 2018 fleischer et al 2017 mura et al 2016 spittlehouse and stewart 2004 reliable datasets and statistical models quickly became integral to supporting decisions which aim to support sustainable use of forest resources under a changing climate numerous datasets of forest attributes and land suitability surfaces have been developed for many forest tree species in many areas of the world and these are integral to developing spatial decision support systems johnson et al 2014 masek et al 2013 statistical modelling techniques can be divided into one of three types 1 empirical 2 correlative or 3 mechanistic correlative species distribution models sdm involve the collation of species occurrence data relating these occurrences to environmental variables and generating maps which predict past present or future species distributions their ease of use makes them a popular method and they represent the vast majority around 90 of sdm publications an alternative approach is to use mechanistic sdms which simulate biological processes according to ecological drivers these mechanistic models rely on huge datasets with long time series and high resolution data which are often not available at national or continental scales given that statistical sdms have emerged as methods by which these limitations can be overcome mechanistic models are not considered in detail by this review before the mid 1980s sdm attempts were limited by the lack of reliable interpolated climatic data on large spatial scales i e to estimate conditions at species occurrence sites that are often distant from meteorological stations modern sdm took off in the late 1990s and early 2000s with the release of global climatic surfaces such as the worldclim database hijmans et al 2005 which has provided the data used in many sdm studies to date in 1996 bioclim provided a set of 19 bioclimatic variables which are also still widely used in many sdm studies the sdm approach was initially based on the ecological niche concept provided by hutchinson around 1950s and then refined by booth et al 1988 this envisaged an n dimensional hypervolume which included simple ranges for environmental factors such as precipitation or temperature describing where the species grows naturally i e its realized niche or where it can grow and reproduce in the absence of competitors i e its fundamental niche appreciating that many tree species can grow under conditions somewhat different from those within their natural distributions is crucial for understanding how they may respond to climate change it is reasonable to assume that a long lived tree species already well established at particular sites may well be able to display some of the climatic adaptability it has shown at trials outside its natural distribution booth 2017 most sdm studies of forests under climate change ignore this adaptability thus determining species climatic requirements from their natural distributions only and applying climate change scenarios this distinction between fundamental or potential i e grinellian and realized i e hutchinsonian niche pearson and dawson 2003 pulliam 2000 vetaas 2002 has been often discussed while the fundamental niche represents the entire habitat suitable for a considered species the realized niche is defined as a smaller part of the expressed fundamental niche as the result of the inter and intra specific competition for available resources in a specific environment i e geographic zone booth 2017 the recognition of this distinction is critical for deciding how an sdm should function pearson and dawson 2003 the majority of sdm to date make use of realized niches often deriving these from the current spatial distributions of forest species this has limitations as sdm are not able to consider the relationships between species and other biotic components e g pests and diseases austin 2007 morin and thuiller 2009 sdm is recognized as a powerful method to forecast the most likely impact of a changing climate on the geographic distribution of a target species by means of environmental data and future global climate model gcm outputs booth 2018 guisan et al 2013 thuiller et al 2015 the technique can go by many different names including habitat model niche based model habitat suitability model climate envelope environmental niche model enm and ecological niche model elith and leathwick 2009 guisan et al 2017 2013 hamann and wang 2006 jeschke and strayer 2008 the use of enm as synonymous with sdm is contentious given the confusion about the significance of the term niche mcinerny and etienne 2013 2012 peterson and soberón 2012 warren 2012 for some authors the inability of models based on realized niches to consider biotic interactions means that the true niche of the species cannot be modelled consequently the current spatial distribution of forest species is viewed as inadequate to properly characterize its ecological requirements this paper reviews available species occurrence datasets environmental data modelling algorithms evaluation processes and spatial projections discussing the implications of the findings for forest science silviculture and forestry the aim is to describe how ecological modelling of forest tree species has evolved within the framework of spatial ecology to support forest management a bibliographic search was conducted by analyzing scopus google scholar and isi wos databases for the period 2000 2019 the aim of this review is to give a general overview of the techniques and adjustments implemented by researchers in order to improve future applications of sdm in forestry research the unresolved issues highlighted previously including the discussion around the definition of real or potential sdm and awareness of the theoretical differences between sdm and enm are not discussed further the term sdm will be used through the text to include all methods intended to link the spatial distribution of target tree species with environmental variables 2 species distribution datasets the spatial distribution of a target species species occurrence as the result of past history current long term climatic conditions and above all forest management strategies represents the primary basis for any sdm falk and mellert 2011 godsoe et al 2017 there are many possible sources for species distribution records selecting the most appropriate dataset is challenging and can influence model performance duputié et al 2014 while many studies have focused their models on the native range only gastón et al 2014 isaac renton et al 2014 other authors have included the distribution of artificial stands under the assumption that if it survives there it is suitable and worth to be considered duveneck and scheller 2015 marchi et al 2016 in fact several studies have demonstrated the ability of many forest tree species to grow well outside their native range and often better than in their origin area boiffin et al 2017 booth 2017 castaldi et al 2017 regardless of database source there are common issues that affect the reliability of datasets these include uncertainty in species identification low or unknown accuracy of sample locations lack of design sampling and incomplete spatial coverage of the true distribution of species guisan et al 2017 2 1 vector format shapefile and national forest inventories species occurrence data for sdm can be obtained from field surveys e g national forest inventories nfi compiled on the basis of existing literature e g euforgen maps or derived from statistical modeling procedures e g efi maps brus et al 2012 while presence data are easy to obtain including absences or pseudo absences is a major issue in sdm the spatial distribution is rarely in a true equilibrium with climate soil due to human pressure on the environment for this reason many uncertainties lie behind both presence and absence data many additional modelling tools have been proposed to properly simulate absences barbet massin et al 2012 peterson et al 2011 however only nfi datasets have the advantage of being based on a statistical sampling scheme with additional information on absences marchi and ducci 2018 most of the databases used by authors are open source and freely available on the web the euforgen maps http www euforgen org species are the first example of distribution maps this database was created by forest genetic resource program and consists of a series of pan european distribution maps for 45 different species which are updated continuously the latest version is available in caudullo et al 2017 and was realized in the framework of the european atlas of forest species san miguel ayanz et al 2016 the main shortcoming of this database relates to its polygon format which can affect the quality and reliability of the data given that no information is available within each polygon considering all locations as potentially suitable at the same level such data has been generally used to validate sdm outputs or to constrain the analysis within a native range for instance bede fazekas and levente horváth 2014 used it to investigate the potential distribution of 4 different species of mediterranean pine another study proposed by falk and hempelmann 2013 was explored the distribution and shift of beech and spruce in europe icp forest is another freely available european database but in contrast to euforgen which can be freely downloaded from the website icp forest download requires a formal request icp is the result of the international cooperative program on assessment and monitoring of air pollution effects on forests project the data are split into two different monitoring intensities and spatial distributions level i and level ii in the first case almost 6000 forest monitoring plots are available regularly distributed on a 16 km grid hanewinkel et al 2012 hanewinkel et al 2012 use icp forest to examine the distribution of important forest species in europe while casalegno et al 2010 used icp to realize a map of vulnerability of pinus cembra to present and future climate conditions level ii is an intensive monitoring network and provides keys insights into factors affecting the condition of forest ecosystems and relative effects of different stress factors in this case only around 800 plots have been established within the major forest types of europe while icp forests might be used as presence absence dataset a lack of a spatial sampling scheme a major shortcoming of this dataset for this reason an adjustment was proposed by brus et al 2012 where a mixture of compositional kriging in areas with nfi plot data and a multinomial multiple logistic regression model between icp forests plots was performed although often initially conducted for different purposes e g to record management actions or inform economic research national forest inventory nfi data are probably the most important and detailed source of biological data for sdm the main superiority of nfi for sdm relies on the sampling method used which respects statistical rules and can be used for inference nfi are an unbiased sampling of the forest area in a specific country and can be used to derive estimators of forest attributes their repetition at almost regular intervals of time enables monitoring and modelling of temporal changes teuscher et al 2013 hanewinkel et al 2010 modeled the potential economic consequences of a shift from norway spruce to european beech in a forest in the south of germany similarly rivera and lòpez quilez 2017 worked in spain to compare several statistical techniques for predicting species distribution of forest species iverson et al 2008a 2008b evaluated a potential response of forest species to climate change following two different emission scenarios in eastern of usa using inventory data for 134 different species of forest tree recently nfis have been used to study the possibility for detecting and conserving marginal and peripheral forest populations with several sdm techniques in order to forecast possible adaptation strategies for two mediterranean species abies alba and fagus sylvatica sharing a common environment marchi and ducci 2018 based on the classic sdm evaluation method true skill statistic tss see below a higher accuracy of predictions was obtained modeling only a small part of the whole distribution referred as provenance and mainly due to the reduction in the background noise consequently authors concluded that the provenance species distribution modeling may represent a valuable step forward in spatial analysis particularly for the detection of marginal peripheral populations 2 2 global datasets and raster layers the global biodiversity information facility gbif database is an important source of auxiliary information for sdm the database gives information on occurrence data outside the native range and therefore an indication of the ability of species to grow under different climate conditions booth 2014 dyderski et al 2018 as with icp forests its main problem is the lack of sample design guisan et al 2017 and thus it is rarely use as a principal source of data however there are several examples of it being utilized hernández quiroz et al 2018 related quercus occurrence data to its current distribution using gbif data in booth 2014 the gbif is related to the atlas of living australia ala to develop a methodology which describes the climatic requirements of eucaplyptus nitens dyderski et al 2018 also worked with gbif as additional information to improve the predicted performance of their sdm in another study zhang et al 2017 integrated data from the fia united states forest inventory and analysis and psp canadian permanent sampling plots with gbif to develop an ensemble sdm which evaluated potential habitat suitability for forest species under different conditions of climate land use and dispersal constraints local regional or national datasets such as forest category maps represent valuable strata for regional studies which can enrich national continental or global datasets for example forest ecotypes link plant species to certain zones marchi et al 2016 used ecotypes to model future scenarios for a marginal forest population of black pine pinus nigra spp nigra var italica in the mediterranean area in order to forecast potential mitigation strategies and propose an assisted migration protocol similarly in iturbide et al 2015 11 different ecotypes of quercus spp were used to analyze the effect of different methods for pseudo absence data generation and generate optimal results national forest maps have also sometimes been utilized in garzón et al 2006 a distribution map at a resolution of 1 km was used to assess the potential distribution of pinus sylvestris in spain similarly wang et al 2016 studied likely climate change effects on the distribution of some common chinese tree species statistical maps of forest tree species represent an alternative and interesting source for sdm brus et al 2012 recently generated raster maps at 1 km resolution for 20 forest tree species in europe input data was sourced from icp forests records and nfi inventory statistics for 18 european countries for areas covered by national inventory plots the proportional area of each of the 20 species was calculated using a kriging interpolation method a multinomial regression model was then applied to predict species composition for the rest of europe the results of the model were then scaled using independent data these datasets have been widely used van der maaten et al 2017 investigated the hypothesis that future climate projections are linked to temporal or spatial variation in forest growth ring width these datasets were also used by maps were also used by noce et al 2017 to study the potential effect of climate change on hot spot distribution in southern europe with regards to common group of forest species 3 climate soil land cover and variable choice many factors need to be taken into account when choosing an appropriate predictor variable the purpose of the study the availability of data and the redundancies between variables an additional issue in variable selection is collinearity which can occur between predictors this phenomenon occurs where two or more predictors are related to one another linearly or not this can affect the proportion of variance explained by each independent variable while no impact has been found on final prediction this characteristic can make it difficult to establish the relative importance of predictors in affecting the distribution of species dormann et al 2013 where there is high collinearity among predictors the easiest method is to remove some of the highly correlated variables from the computational steps schröder 2008 a pre determined threshold which generally ranges between 0 8 and 1 0 dormann et al 2013 can be applied to filter them to avoid subjective selection the use of a pre selective technique such as principal component analysis pca can be used variables are then chosen according to the proportion of variance explained by each component cruz cárdenas et al 2014 metzger et al 2013 alternatively pca components can be used as predictors marchi and ducci 2018 however even with a mathematically perfect model the components are orthogonal for construction the importance of each ecological predictor is hard to estimate another option is the cluster independent method with two sub variants i to select variables where the correlation values are under 0 7 or ii residual regression finally latent variable models can be used to infer hidden variables from observed and collinear variables dormann et al 2013 3 1 worldclim and worldclim based raster surfaces the environmental variables or predictors in sdm are used to derive the ecological niche which can then be used to model species distributions according to their drivers pearson 2010 the choice of predictor variables represents a critical step which must be based on the ecoogical tolerance and habitat requirements of the species in question jarnevich et al 2015 despite its important repercussions on model performance the predictors issue has only recently begun to acquire greater attention barbet massin and jetz 2014 climate variables e g temperature and precipitation but also derived climatic indexes are generally the most used variables in sdm thuiller 2013 at current time many different sources of climate data are freely available on the web barbet massin and jetz 2014 worldclim fick and hijmans 2017 being the most common worldclim collects monthly climate data at several resolutions ranging from 10 min about 300 square km to 30 arc seconds about 1 square km after initial release 1960 1990 version 1 4 where only temperature maximum minimum and average precipitation and 19 bioclimatic indices were available new indices including solar radiation vapor pressure and wind speed have been added and all other indices extended for the period 1970 2000 version 2 0 fick and hijmans 2017 worldclims implementation in sdm is very common in the scientific literature for example casalegno et al 2010 build an sdm describing the vulnerability of pinus cembra to climate change märkel and dolos 2017 used the 19 bioclimatic variables from worldclim to calculate starting from climate data derived from german climate service the final aim is to build a methodology to combine them in unique technique to better evaluate the climate change impact in germany however two main shortcomings arise i the global extension makes the dataset often unsuitable for local application and ii the lack of an adequate coverage in some regions of the globe make some climatic variables unreliable especially precipitation data bedia et al 2013 marchi et al 2019 given these limitations an alternative or complementary sources to worldclim is the recently released envirem dataset environmental raster for ecological modeling it combines a set of biological and topographic variables calculated from worldclim rasters and solar radiation title and bemmels 2018 3 2 standalone software for climatic custom queries the use of standalone software for local downscaling of climatic data is gaining attention in the scientific literature among these climateeu climatena and climatesa software packages are valuable tools https sites ualberta ca ahamann data html with which to generate customized raster maps for europe north america and south america respectively for both historical time slices or future scenarios these packages provide a method to downscale prism data using a combination of bilinear interpolation and dynamic lapse rate adjustment the prism parameter elevation regression on independent slopes model climate database available for united states only provides mean monthly precipitation and minimum and maximum temperature values for the period 1971 2000 these data were interpolated to produce climate variables for the entire united states using a dem available at 30 arcsec of spatial resolution daly et al 2008 the software calculates monthly seasonal and annual climate variables for a specified location on the base of latitude longitude and elevation wang et al 2012 hamann et al 2013 and van der maaten 2017 used this database to build a sdm fore distribution of european tree forest species inclduing norway spruce scots pine european beech and pedunculate oak isaac renton et al 2014 also used climatena and climateeu to build a sdm for douglas fir and evaluate species transferability between continents in view of climate change concerning europe climateeu was used by marchi and ducci 2018 to generate raster surfaces at 250 m of spatial resolution in combination with nfi data local climate datasets are undoubtably the most accurate source of information for sdm but they are also the least accessible local data is used widely in forest management and especially in forest monitoring due to its higher precision and quality ferrara et al 2017 bedia et al 2013 compared the use of national climate data to data from worldclim in order to verify the differing sensitivity in sdms using distribution data for fagus sylvatica in smaller region local climate databases were also used in crimmins et al 2013 four predictor variables minimum and maximum temperature mean annual actual evapotranspiration and mean annual climatic water deficit hypothesized to have a direct influence on species distribution were tested in order to evaluate the success of a consensus approach for predicting the distribution of plant species 3 3 soil and land cover datasets in addition to climate data soil and land cover information can be included in sdm approaches the principal characteristics of interest with regards to soil are ph texture fertility and soil moisture roces diàz et al 2014 used nfi data for spain together with 9 different predictors among them an index of fertility of soils to realize a distribution model which investigates the relationship between climate and the distribution of 6 different tree species coudun et al 2006 used many different predictor variables to realize a sdm to investigate the importance of climate and other edaphic variables to distribution of acer campestre ph was a key variable together with other 6 other variables linked to aspects of soil despite soil being a critical predictor variable its use in sdm is limited as the lack of available datasets in either digital format or suitable resolution makes it hard to find data of comparable quality to climate data mod et al 2016 thuiller 2013 the most relevant and up to date information with global coverage is soilgrids250 m hengl et al 2017 this dataset provides global predictions for standard numeric soil properties organic carbon bulk density cation exchange capacity cec ph soil texture fractions and coarse fragments at seven standard depths 0 5 15 30 60 100 and 200 cm in addition to predictions of depth to bedrock and distribution of soil classes based on the world reference base wrb and usda classification systems the interpolated surfaces were built using more than 150 000 soil profiles and 158 remote sensing based soil covariates primarily derived from modis land products srtm dem derivatives used as predictors in a combination random forest model and multinomial logistic regression algorithm in manchego et al 2017 this database was used to evaluate the potential effects of deforestation and climate change on the distribution of 17 characteristic forest tree species of dry forest in ecuador in terms of land cover land cover change for example agricultural intensification can have important effect on the distribution of different organisms by including land cover data in sdm the explanatory power of the model is often increased while the predictive performance remain unchanged thuiller et al 2004 despite this use of land cover data has not been common in plant distribution studies except when predicting species abundance bradley et al 2012 mod et al 2016 for example hill et al 2017 predicted the future abundance of typical forest trees in uk by means of a land cover change map in addition to land use and land cover maps digital elevation models dem or digital terrain models dtm and mathematically derived maps i e slope aspect topographic position index etc are sometimes included when choosing an appropriate dem spatial resolution and any uncertainties associated with interpolation are principal factors to consider franklin 2010 garzón et al 2006 used aspect and slope as predictors while duan et al 2014 included altitude among several other predictive variables however generally the use of terrain models has often been neglected given that the information they provide is already included in climatic maps and no climate change effects can be added to such predictors 4 modelling algorithms many different algorithms are currently implemented in sdm processes guisan et al 2017 and 12 modeling methods have been described and selected according to their use in the analyzed literature fig 1 there is consensus that a single and perfect technique for all possible sdm cases is impossible and thus the selection of the an appropriate modeling algorithm is fundamental as demonstrated by many studies beale and lennon 2012 buisson et al 2010 duan et al 2014 jarnevich et al 2015 koo et al 2017 choosing the correct algorithm can reduce the uncertainty within the model the algorithms involved in sdm computational steps can be divided into different groups and according to various characteristics and grouping criteria in this review paper the analyzed algorithms were firstly divided according to input data i presence only and ii presence absence algorithms then subgroups were made based on intrinsic characteristics e g distance based linear or regression model classification and decision trees machine learning a graphical scheme of the proposed structure is shown in fig 2 4 1 presence only algorithms all techniques included within this group are characterized by their ability to model the spatial distribution of a target species simply on the basis of species occurrence or presence very simple and computationally light these are the oldest technique used in ecological modeling but also acknowledged as being less powerful and often unsuited for predicting the effects of climate change guisan et al 2017 hijmans and graham 2006 miller 2010 algorithms included in this group and reported here are bioclim or surface range envelope sre the mahalanobis distance the domain algorithm and the environmental niche factor analysis enfa the bioclim or surface range envelope sre algorithm has been extensively used for sdm and represents the classic climate envelope model booth 2014 hijmans and elith 2011 although it generally does not perform as well as some other modelling methods elith et al 2006 it is still used as it is easy to understand and thus useful in teaching sdm this method computes the similarity of a location by comparing the values of environmental variables at any location to a percentile distribution of the values at known locations of occurrence the closer to the 50th percentile the median the more suitable the location is a key shortcoming is that the tails of the distribution are not distinguished and the 10th percentile is treated as equivalent to the 90th percentile bioclim has been used less by recent literature and where it does occur this is often in comparative papers for example duan et al 2014 evaluated the predictive capacity and solidity of different techniques for estimating species distribution for many forest tree species pinus massoniana betula platyphylla quercus wutaishanica quercus mongolica and quercus variabilis an interesting use of such algorithm is as ancillary model to generate pseudo absences in biomod2 package thuiller et al 2009 in this package bioclim called sre can be used to generate an user defined number of pseudo absences in a target spatial extent laying outside the ecological distribution of the species to be modeled and described by the occurrences we found the mahalanobis distance to be the most popular algorithm among the distance based methods this method calculates the suitability area as a multivariate and environmental distance between the study area and a vector of optimum climate condition generally calculated as a mean of all values which occur in a presence dataset farber and kadmon 2003 peterson et al 2011 the predictive power of mahalanobis is higher than bioclim farber and kadmon 2003 but some disadvantages still occur franklin 2010 highlighted the inability to weight the relative influence of different predictor variables similarly to mahalanobis the domain algorithm carpenter et al 1993 computes environmental distance in this case the gower distance is used which calculates the distance between environmental variables at any location and those at any of the known locations of occurrence training sites for each variable the minimum distance between a site and any of the training points is taken to integrate findings across environmental variables the maximum distance to any one of the variables is used and this distance is subtracted from one environmental niche factor analysis enfa is the last algorithm in the family of presence only and distance based methods this algorithm is able to estimate the ecological niche through a comparison of presence data and environmental values for the entire area guisan et al 2017 hirzel et al 2002 rupprecht et al 2011 used this method to evaluate the prediction capacity of different type of algorithms for a distribution of juniperous oxycedrus species 4 2 presence absence algorithms this second group is populated by more complex and time consuming but also more complete algorithms this is due to both the higher amount of information they can handle and the inclusion of absences in the modeling steps indeed absence data are often numerically more common than presence data sometimes even ten times more for this reason such models need to handle this problem properly weighting the sun of presences and absences equally this statistical method is generally called prevalence barbet massin et al 2012 manel et al 2001 marchi and ducci 2018 according to the statistical family two different sub groups can be defined regression based and machine learning the first group includes parametric models such as generalized linear models glm generalized additive models gam and multivariate adaptive regression splines mars among the immense literature on machine learning algorithms artificial neural network ann classification trees cart maximum entropy maxent genetic algorithm garp and random forest rf are herewith discussed as the most used nonparametric algorithms glm represent one of the principal algorithms in sdm as a flexible and relativley simple tool derived from linear model guisan et al 2002 the main characteristic of glm which distinguishes it from a general linear model is the possibility to include a response variable with a different distribution family from the gaussian for example binomial or poisson guisan et al 2017 this algorithm is particularly useful for non normal distribution data bolker et al 2009 its use in the case of sdm is allowed by means of the specification of a binomial family and a logistic link function the glm algorithm is extensively used in the literature higa et al 2013 assessed the importance of non climatic factors on the provision of the potential habitat for typical japanese tree species fagus crenata betula grossa carpinus laxiflora carpinus tschonoskii celtis sinensis ulmus laciniate and zelkova serrata thuiller et al 2006 evaluated the potential change in distribution of 112 tree species following climate change in europe in roces díaz et al 2014 glm clearly revealed both the difference in habitat suitability among different tree species in spain and the importance of predictor variables in particular minimum temperature and soil fertility finally thuiller et al 2009b and eith et al 2006 compared the predictive accuracy of glm with gam and cta using three independent datasets of tree species at different scales and resolution results showed that the predictive performance of glm were superior to other algorithms especially at finer scales an extension of glm is represented by the mixed effecst generalized linear mixed model glmm glmm is currently not commonly used in the forestry sector and has only recently been applied to build a novel sdm approach benito garzón et al 2019 where forest tree species were modelled according to the performances obtained in common garden experiments the main novelty of glmm rely on the use of the common garden as random effect predictor which allows to handle the differences within sites in a model cleaning the prediction from artifacts and unexplained differences as an example from another field glmm has been used to quantify the effect of imperfect detection on the estimation of niche overlap between two forest dormice muscardinus avellanarius and glis glis by paniccia et al 2018 gam represents a natural expansion of the glm algorithm guisan et al 2002 with its principal feature being high flexibility this aspect allows use of this algorithm to represent situations where there are non linear combinations between variables elith et al 2006 gam adopts a particular smoothing function to fit a non linear relation between predictive variables and species occurrence the gam algorithm is used by keenan et al 2011 to compare the future distribution of different forest species with an output from mechanistic processes walentoski et al 2017 used gam to evaluate the suitability of a franconian plateau in the south of germany for three different species in the context of climate change in rivera and lòpez quìlez 2017 compared algorithms including gam cart mars and maxent to predict the potential distribution of 17 species of forest tree from nfi data no significant differences were found between these techniques although gam showed a slightly higher predictive capacity similarly to gam the mars algorithm is a further development of glm it is computationally faster than other algorithms of the regression family and is particularly suitable when a wide range predictive variables are available choe et al 2016 miller 2010 this algorithm represents an important alternative to fitting non linear responses using a piecewise linear fit instead of a smooth function it has been used by bedia et al 2013 in comparison with glm to evaluate the sensitivity of these algorithms to different climate databases in marchi et al 2016 the algorithm was used to evaluate the potential effect of climate change on the spatial distribution of a marginal and peripheral forest population of european black pine pinus nigra spp nigra var italica in comparison with glm and rf and to generate a consensus map in périé and de blois 2016 mars is used together with other seven algorithms to evaluate the potential decline in habitat suitability for 5 forest tree species in canada picea mariana mill britton sterns poggenb abies balsamea l mill betula papyrifera marshall acer saccharum marsh and betula alleghaniensis britton cart is the first nonparametric algorithm within the machine learning group the technique is based on a recursive partitioning process where the dataset is broken into small homogeneous groups noce et al 2017 used this algorithm within a suite of different models to investigate the likelihood of future provision of suitability distributions for important forest tree species in europe the predictive performance of cart is compared with several other algorithms used by aertsen et al 2010 to model three different forest species pinus brutia pinus nigra cedrus libani in turkey cart algorithms were found to be one of the most user friendly models mckenney and pedlar 2003 used a cart algorithm to predict site productivity on the base of climatic and soil characteristics for two forest species in canada ann or sometimes simply neural networks nn is a complex technique inspired by working principles of the brain a basic ann procedure consists of a network of simple elements artificial neurons representing the brain li and wang 2013 the use of a set of adaptive weights allow the tuning of the algorithms with a learning process a nonlinear relationship between a response variable and an explanatory variable is allowed and the possibility of use data in every statistical distribution except with gaussian data are the most relevant features of the algorithm li and wang 2013 pearson et al 2002 ann algorithm is among the 4 different techniques used by thuiller 2004 to evaluate the potential distribution of different species of plant under various hypothetic climate change scenarios bedia et al 2011 also use ann algorithm as one of 6 different algorithms in assessing and comparing the predictive performance for distributions of herbaceous plant species in a northern region of spain in most cases ann turned out to be the best algorithm for predictive performance often improperly reported as presence only algorithm elith et al 2011 merow et al 2013 phillips et al 2006 we include the maxent algorithm in the presence absence group this is due to the fact that this algorithm is deeply different from sre domain mahalanobis and enfa maxent requires additional information about the external environment where the species is located i e the background this information is generally obtained automatically during computation by means of a spatial random sampling procedure guillera arroita 2017 as recognizable from the name this technique estimates the suitability of an area through a maximum entropy principle the algorithm calculates the maximum entropy probability of the distribution species and compares it with a maximum entropy probability of the entire object region guillera arroita et al 2015 the maxent algorithm has been extensively used in the literature lahssini et al 2015 studied the distribution of ceratonia siliqua l across morocco results showed a good predictive performance antönez et al 2018 used the algorithm to predict potential distribution for 13 tree species in three different time periods the most recent glaciation the present and the future period using the a2 scenario form the third assessment report of ipcc del río et al 2018 implemented maxent to evaluate the principal driving factors shaping the distribution of spanish beech in current and future climate conditions cruz cardenas et al 2014 developed a methodology to reduce or resolve the problem of spatial autocorrelation for predictor variables with maxent offering a pca for predictor variables and randomness selection for presence records clark et al 2014 examined the current and future potential distribution of an important invasive species ailanthus altissima in the appalachian region of the united states finally dyderski et al 2018 modelled the potential distribution of 12 forest species for current and future climate conditions garp genetic algorithm for rule set prediction works similarly to maxent in that it requires a presence background method barbet massin et al 2012 the genetic algorithm works on the base of a set of mathematical rules which are randomly selected and interpreted as a different and limited environmental condition or particular relationship between the environment and a species each rules is defined as a gene and each combination of genes generates a different algorithm franklin and miller 2010 li and wang 2013 elith et al 2006 use garp among 16 different algorithms to predict the potential distribution of 226 different species both animals and plants in 6 different regions of the globe garp was found to be the most suitable and best performing algorithm vessella and schirone 2013 used both maxent and garp to investigate the potential distribution of quercus suber on the basis of current climate conditions the garp algorithm outperformed maxent with drought and cold stress found to be the main factors influencing the distribution of the species rf is one of the most important most used and high performing algorithms it consists of a series of decisional trees which are randomly generated and used to build a virtual forest each single tree is constituted by a random bootstrap sample wang et al 2016 the most important feature of rf is that it is nonparametric and not vulnerable to collinearity moreover it is a robust algorithm and performs well with large datasets li and wang 2013 shortcomings of the algorithm include over fitting which can occur in some cases and the black box structure which doesn t allow the user to fully understand the calculation process as well as the weights applied to predictors morin and thuiller 2009 used different techniques to assess the potential range shift of 15 different north eastern american tree species in the context of climate change this technique rf was compared to phenofit which is a process based model and in addition to all the correlative algorithms contained within the biomod2 package thuiller et al 2009 the main aim was to compare the final output of a niche based method with other mechanistic models a high degree of uncertainty was demonstrated by the results which was similar for both models attorre et al 2011 compared rf gam and cart to evaluate the potential effects of climate change on the abundance of 27 species on the italian peninsula in garzón et al 2006 fr ann and cart are used to study the potential distribution area of pinus sylvestris rf demonstrated the best predictive performance rf is also used in koo et al 2017 where 6 other algorithms were combined to model the geographical distribution of machilus thunbergi siebold zucc a typical evergreen broadleaved tree in korea peninsula finally rf was used in benito garzón et al 2008 together with cart and ann to study the future tree distributions in the iberian peninsula the predictive performance of rf is consistently found to beslightly higher than other models all the above described algorithms are briefly summarized in table1 where the main software involved in sdm are reported for each of them the included algorithms are reported concerning r language the basic packages such as for instance stats for glm mgcv for gam randomforest for rf etc were dropped 5 model evaluation as stressed in section 4 the choice of sdm algorithm can give different predictions for habitat suitability the causes of these observed difference can be due to the small sample sizes and measurement errors as well as possible omission of an important predictor variable and the choice of gcm and climate scenario used buisson et al 2010 marmion et al 2009 in the scientific literature many comparisons between differential algorithms have been published in order to quantify and evaluate this variability and uncertainty this issue can raise further problems in particular i how to compare between different statistical algorithms ii which parameters should be used for evaluation and iii how to evaluate the compatibility between the statistical model and ecological model in such a framework two principal solutions to resolve these problems are reported in literature i comparison between different models can be made by indicators of goodness of fit or ii a consensus model approach can be used to balance projections obtained from different algorithms austin 2007 cheaib et al 2012 marmion et al 2009 thuiller 2004 both approaches aim to assess the relative accuracy of different modelling algorithms within these solutions methods can be groups into one of two categories threshold dependent or threshold independent laio et al 2011 watling et al 2013 a threshold independent method evaluates the performance of algorithm only based on comparison of the resulting probabilities in contrast a threshold dependent method requires the conversion of raw probabilities produced by the algorithm into two classes based on a defined cut off value or threshold watling et al 2013 the choice of threshold is a key source of uncertainty three different approaches can be followed a fixed threshold b data driven i e linked to species data or predicted probability c accuracy based i e the value is selected to produce the best compromise between original and the evaluated data hanewinkel et al 2014a in ecology three main methods are consistently applied area under curve auc or receiver operating characteristic roc kappa or cohen kappa statistic and the true skill statistic tss leroy et al 2018 while the first technique is generated by means of an analysis of the auc curve the last two methods are derived from the confusion matrix classification system which facilitates visualization of the performance of an algorithm márcia barbosa et al 2013 the auc area under curve or roc values represents an independent threshold technique auc produces a bi dimensional analysis with true positive error on the y axis and false positive error on the x axis fig 3 the value of auc can vary between 1 and 1 noce et al 2017 rivera and lópez quílez 2017 much of the literature reports the method to be biased and of limited use lobo et al 2008 report five key disadvantages i it ignores the predicted probability values and goodness of fit ii performances are calculated over regions of the roc space in which one would rarely operate iii omission and commission errors are weighted equally iv lack of information concerning spatial distribution of model errors v model extent strongly influences the rate of well predicted absences and auc scores despite these disadvantages auc continued to be used even by recent papers alternatively threshold dependent methods such as the kappa or cohen kappa rates algorithm performance between 0 and 1 with 1 representing good agreement between predicted and observed presence data the indicator is calculated according to the following equation k a p p a t p t n t p f n t p f p f p t n f n t n n n t p f n t p f p f p t n f n t n n where tp is the number of true positives tn is the number of true negatives fp is the number of false positives and fn is the number of false negatives detected by the algorithm on the total number of testing samples n the method is limited by the fact that it is strongly reliant on linked to species prevalence as well as uncertainty relating to the application of a threshold miller 2010 watling et al 2013 2012 tss total sum of squares is also threshold dependent but it has the advantage of being independent from species prevalence values between 1 and 1 correspond to the sum of the value of sensitivity and the value of specificity which are calculated as a proportion of presence areas and absence areas respectively barbet massin et al 2012 tss is calculated using the following equation t s s s e n s i t i v i t y s p e c i f i c i t y 1 where s e n s i t i v i t y t p t p f n s p e c i f i c i t y t n f p t n both auc and tss have been applied by noce et al 2017 to evaluate the capacity of different sdm algorithms to predict potential future suitability of hot spots for many important forest tree species in southern of europe morin and thuiller 2009 used only auc to evaluate predictive performance of alternative niche modelling techniques process based vs correlative similarly only the kappa statistic was calculated by freeman and moisen 2008 to evaluate predictive performance of sdm for 13 forest tree species in usa a combination of methods was used by falk and hempelmann 2013 to evaluate predictive performance zhang et al 2015a b compared all three different methods to evaluate the accuracy of alternative predictive models to study plant distribution in china auc and tss were found to outperform kappa thurm et al 2018 also adopted tss to evaluate algorithms used to estimate the present and future potential distribution of 12 forest tree species in europe all the statistics discussed above are among the most used but not the only in literature and are often employed to generate consensus or ensemble maps the interest in ensemble modeling is growing rapidly not only in ecology but also in other fields such as economy and medicine individual algorithms are combined using different techniques for example a selective algorithm pca or a mathematical or statistical functions such as taking the median mean or weighted average taking the mean remains the most commonly used option in sdm kindt 2018 marmion et al 2009 in many papers studying the forestry sector tss values are the most common weight applied to each algorithm keenan et al 2011 evaluated the predictive performance of models using the weighted mean of tss engler et al 2013 used the same technique to present an interesting method to map the distribution of each individual tree belonging to a principal forest species in switzerland zhang et al 2015a b calculated kappa auc and tss values for each different sdm algorithm employing an ensemble technique which considered three different functions the median the frequency and the simple mean 6 future scenarios dealing with the uncertainty behind modeling steps the process of selecting adequate software presence absence datasets environmental predictors modeling algorithms and weighting procedures is often carried out with the aim of exploring future scenarios in order to derive insight on how climate change might impact forest tree species distributions the future provision of ecosystem services will be highly influenced by climate change albert et al 2017 ray et al 2019 and sdm techniques can support decision makers in developing forest management strategies the use of better adapted forest tree species genotypes and provenance selection genotyping will improve the resilience of forest systems and allow assisted migration strategies hanewinkel et al 2014 marchi and ducci 2018 thus enforcing the adaptive processes of forest ecosystems ferrarini et al 2016 dealing with the uncertainties generated by climate change is a challenging matter by sampling along latitudinal north south or east west or altitudinal gradients research strategies often aim to search for regions where local adaptation is taking place becerra 2016 boisvert marsh et al 2014 kozyr 2014 the selective pressure exerted upon genotypes at higher elevations colder temperatures or southern latitudes warmer temperatures forces forest species to adapt to local conditions this kind of adaptive process if recognized as genetic difference will be a valuable resource in forest management strategies williams and dumroese 2013 future projections are generally based on a specific emission scenario which represents a hypothetical image of the possible trend in greenhouse gas emissions alternative pathways for environmental socio economic technological and demographic development are also included currently the most commonly used projections have been generated by the ipcc 5th assessment report ar5 emission scenarios are represented by representive concentration pathways rcps with four possibilities trajectories of increasing severity rcp 2 6 rcp 4 5 rcp 6 0 and rcp 8 5 these replaced the previous special report on emissions sscenarios sres a1 a2 b1 b2 goberville et al 2015 in addition to the ar5 rcps many global circulation models gcm have been developed by research groups around the world often targeted at specific geographic regions these regional gcms rely heavily on statistical probability which introduces deep degree of uncertainty in sdm efforts using those datasets for this reason researchers have tried to tackle the issue by combining multiple gcm and rcp inputs and analyzing the resulting variance the most common method is to average different outputs goberville et al 2015 for example iverson et al 2008a b used three different climate models and data from the sres emission scenarios a1 and b1 walentowski et al 2017 did repeated this method using new ar5 scenarios thereby providing a comparison hanewinkel et al 2010 used data from emission scenarios a2 and b1 to predict the possible economic consequences of a shift from picea abies to fagus sylvatica in southern germany finally benito garzón et al 2008 used data from a range of emission scenarios a1 a2 b1 b2 to simulate the impact on the distribution of the iberian tree species in three different time slices 2020s 2050s 2080s the use of regional climate models rcm allow higher precision than gcm due to their greater detail at small scale franklin et al 2013 koca et al 2006 rcm are derived from gcm models through a process of statistical downscaling for instance an interesting comparison was made by liu et al 2014 where the use of gcm or rcm was assessed when dealing with climate change impacts and the future scenarios for invasive plants in usa a static sdm i e no migration included is based on the assumption that species distribution is in equilibrium with climate and will react locally to a changing climate the inclusion of the migration capacity of different tree species is a rapidly increasing theme in recent literature and could be used to improve estimations of the ability of a target species to colonize new sites two important methods are currently available to evaluate the migration capacity the migclim engler et al 2012 and kissmig algorithms subba et al 2018 both are currently available as r packages and while the first enables the implementation of species specific dispersal constraints into projections of sdm kissmig offers a simple raster based and stochastic migration model nobis and normand 2014 7 conclusions this review has found an evident increment in scientific contribution relating to sdm from 2000 to 2019 demonstrating a growing interest for the technique the primary aim of sdm in forest research and management is to derive insights relating to the future potential distribution of tree species in order to implement effective adaptation strategies janowiak et al 2017 the literature highlights that the correct interpretation and use of presence absence datasets is central to deriving a correct estimation of the ecological niche for the species in question another key finding is the need to reduce the uncertainties associated with modelling steps e g reliability of species distribution data climate surfaces gcms and further work in this area is highly important to improve estimations of future forest distribution and resulting ecosystem services a key downfall of sdm as it stands is the lack of inclusion of biotic interaction into the modeling procedure inclusion of these processes would see a shift from sdm to true ecological niche models however such models even if theorized are yet to be achieved a promising area of further research are multi species and multi level sdm where many target trees are modeled at the same time currently only single tree models are in use leaving the final merging procedure to a simple overlay process in a gis environment host disease models offer an similar promising advancement where both host and disease are modelled according to climate change scenarios to simulate the potential future impact of biotic stresses e g insects fungi bacteria on forest tree species in this case a co evolution in modelling techniques is expected and consequently a combined sdm offers a promising method to model such interactions acknowledgements this study was partially supported by the phd grant provided by the university of florence to matteo pecchi in the framework of the project effetti di eventiestremi a seguito di cambiamenti climaticisu ambientinaturali e semi naturali impatto mitigazione e resilienza maurizio marchi and vanessa burton were partially funded by the eu in the framework of the horizon 2020 b4est project adaptive breeding for productive sustainable and resilient forests under climate change ue grant agreement 773383 
24979,species distribution modelling sdm techniques were originally developed in the mid 1980s in this century they are gaining increasing attention in the literature and in practical use as a powerful tool to support forest management strategies especially under climate change in this review paper we consider species occurrence datasets climatic and soil predictor variables modelling algorithms evaluation methods and widely used software for sdm studies we describe several important and freely available sources for species occurrence and interpolated climatic data we outline the use of both presence only and presence absence modelling algorithms including distance based algorithms machine learning algorithms and regression based models we conclude that sdm techniques provide a valuable asset for forest managers however it is essential to consider uncertainties behind the use of future climate change scenarios keywords forest modeling ecological mathematics climate change scenarios spatial analyses ecology ecosystem services from forests 1 introduction the future dynamics and spatial distribution of forest ecosystems is a key issue for biodiversity conservation under the many uncertainties generated by climate change rehfeldt et al 2014 walentowski et al 2017 forest ecosystems deliver a wide range of benefits to human beings and achieving the sustainable use of natural resources is central to research in many disciplines knowledge concerning the current spatial occurrence of forest species the influence of ecological drivers e g climate soil and the possible erosion or expansion of their envelopes of suitability is required by decision makers in order to detect both threatened areas and possible refuges pecchi et al 2019 williams and dumroese 2013 the use of better adapted forest tree species genotypes and provenance selection genotyping has the potential to improve the resilience of forest systems and allow assisted migration strategies hanewinkel et al 2014 marchi and ducci 2018 thus assisting the adaptive processes of forest ecosystems ferrarini et al 2016 since the emergence of modelling techniques spatial data including aerial images cartographic layers and national forest inventories have been fundamental resources for statistical mapping di biase et al 2018 fleischer et al 2017 mura et al 2016 spittlehouse and stewart 2004 reliable datasets and statistical models quickly became integral to supporting decisions which aim to support sustainable use of forest resources under a changing climate numerous datasets of forest attributes and land suitability surfaces have been developed for many forest tree species in many areas of the world and these are integral to developing spatial decision support systems johnson et al 2014 masek et al 2013 statistical modelling techniques can be divided into one of three types 1 empirical 2 correlative or 3 mechanistic correlative species distribution models sdm involve the collation of species occurrence data relating these occurrences to environmental variables and generating maps which predict past present or future species distributions their ease of use makes them a popular method and they represent the vast majority around 90 of sdm publications an alternative approach is to use mechanistic sdms which simulate biological processes according to ecological drivers these mechanistic models rely on huge datasets with long time series and high resolution data which are often not available at national or continental scales given that statistical sdms have emerged as methods by which these limitations can be overcome mechanistic models are not considered in detail by this review before the mid 1980s sdm attempts were limited by the lack of reliable interpolated climatic data on large spatial scales i e to estimate conditions at species occurrence sites that are often distant from meteorological stations modern sdm took off in the late 1990s and early 2000s with the release of global climatic surfaces such as the worldclim database hijmans et al 2005 which has provided the data used in many sdm studies to date in 1996 bioclim provided a set of 19 bioclimatic variables which are also still widely used in many sdm studies the sdm approach was initially based on the ecological niche concept provided by hutchinson around 1950s and then refined by booth et al 1988 this envisaged an n dimensional hypervolume which included simple ranges for environmental factors such as precipitation or temperature describing where the species grows naturally i e its realized niche or where it can grow and reproduce in the absence of competitors i e its fundamental niche appreciating that many tree species can grow under conditions somewhat different from those within their natural distributions is crucial for understanding how they may respond to climate change it is reasonable to assume that a long lived tree species already well established at particular sites may well be able to display some of the climatic adaptability it has shown at trials outside its natural distribution booth 2017 most sdm studies of forests under climate change ignore this adaptability thus determining species climatic requirements from their natural distributions only and applying climate change scenarios this distinction between fundamental or potential i e grinellian and realized i e hutchinsonian niche pearson and dawson 2003 pulliam 2000 vetaas 2002 has been often discussed while the fundamental niche represents the entire habitat suitable for a considered species the realized niche is defined as a smaller part of the expressed fundamental niche as the result of the inter and intra specific competition for available resources in a specific environment i e geographic zone booth 2017 the recognition of this distinction is critical for deciding how an sdm should function pearson and dawson 2003 the majority of sdm to date make use of realized niches often deriving these from the current spatial distributions of forest species this has limitations as sdm are not able to consider the relationships between species and other biotic components e g pests and diseases austin 2007 morin and thuiller 2009 sdm is recognized as a powerful method to forecast the most likely impact of a changing climate on the geographic distribution of a target species by means of environmental data and future global climate model gcm outputs booth 2018 guisan et al 2013 thuiller et al 2015 the technique can go by many different names including habitat model niche based model habitat suitability model climate envelope environmental niche model enm and ecological niche model elith and leathwick 2009 guisan et al 2017 2013 hamann and wang 2006 jeschke and strayer 2008 the use of enm as synonymous with sdm is contentious given the confusion about the significance of the term niche mcinerny and etienne 2013 2012 peterson and soberón 2012 warren 2012 for some authors the inability of models based on realized niches to consider biotic interactions means that the true niche of the species cannot be modelled consequently the current spatial distribution of forest species is viewed as inadequate to properly characterize its ecological requirements this paper reviews available species occurrence datasets environmental data modelling algorithms evaluation processes and spatial projections discussing the implications of the findings for forest science silviculture and forestry the aim is to describe how ecological modelling of forest tree species has evolved within the framework of spatial ecology to support forest management a bibliographic search was conducted by analyzing scopus google scholar and isi wos databases for the period 2000 2019 the aim of this review is to give a general overview of the techniques and adjustments implemented by researchers in order to improve future applications of sdm in forestry research the unresolved issues highlighted previously including the discussion around the definition of real or potential sdm and awareness of the theoretical differences between sdm and enm are not discussed further the term sdm will be used through the text to include all methods intended to link the spatial distribution of target tree species with environmental variables 2 species distribution datasets the spatial distribution of a target species species occurrence as the result of past history current long term climatic conditions and above all forest management strategies represents the primary basis for any sdm falk and mellert 2011 godsoe et al 2017 there are many possible sources for species distribution records selecting the most appropriate dataset is challenging and can influence model performance duputié et al 2014 while many studies have focused their models on the native range only gastón et al 2014 isaac renton et al 2014 other authors have included the distribution of artificial stands under the assumption that if it survives there it is suitable and worth to be considered duveneck and scheller 2015 marchi et al 2016 in fact several studies have demonstrated the ability of many forest tree species to grow well outside their native range and often better than in their origin area boiffin et al 2017 booth 2017 castaldi et al 2017 regardless of database source there are common issues that affect the reliability of datasets these include uncertainty in species identification low or unknown accuracy of sample locations lack of design sampling and incomplete spatial coverage of the true distribution of species guisan et al 2017 2 1 vector format shapefile and national forest inventories species occurrence data for sdm can be obtained from field surveys e g national forest inventories nfi compiled on the basis of existing literature e g euforgen maps or derived from statistical modeling procedures e g efi maps brus et al 2012 while presence data are easy to obtain including absences or pseudo absences is a major issue in sdm the spatial distribution is rarely in a true equilibrium with climate soil due to human pressure on the environment for this reason many uncertainties lie behind both presence and absence data many additional modelling tools have been proposed to properly simulate absences barbet massin et al 2012 peterson et al 2011 however only nfi datasets have the advantage of being based on a statistical sampling scheme with additional information on absences marchi and ducci 2018 most of the databases used by authors are open source and freely available on the web the euforgen maps http www euforgen org species are the first example of distribution maps this database was created by forest genetic resource program and consists of a series of pan european distribution maps for 45 different species which are updated continuously the latest version is available in caudullo et al 2017 and was realized in the framework of the european atlas of forest species san miguel ayanz et al 2016 the main shortcoming of this database relates to its polygon format which can affect the quality and reliability of the data given that no information is available within each polygon considering all locations as potentially suitable at the same level such data has been generally used to validate sdm outputs or to constrain the analysis within a native range for instance bede fazekas and levente horváth 2014 used it to investigate the potential distribution of 4 different species of mediterranean pine another study proposed by falk and hempelmann 2013 was explored the distribution and shift of beech and spruce in europe icp forest is another freely available european database but in contrast to euforgen which can be freely downloaded from the website icp forest download requires a formal request icp is the result of the international cooperative program on assessment and monitoring of air pollution effects on forests project the data are split into two different monitoring intensities and spatial distributions level i and level ii in the first case almost 6000 forest monitoring plots are available regularly distributed on a 16 km grid hanewinkel et al 2012 hanewinkel et al 2012 use icp forest to examine the distribution of important forest species in europe while casalegno et al 2010 used icp to realize a map of vulnerability of pinus cembra to present and future climate conditions level ii is an intensive monitoring network and provides keys insights into factors affecting the condition of forest ecosystems and relative effects of different stress factors in this case only around 800 plots have been established within the major forest types of europe while icp forests might be used as presence absence dataset a lack of a spatial sampling scheme a major shortcoming of this dataset for this reason an adjustment was proposed by brus et al 2012 where a mixture of compositional kriging in areas with nfi plot data and a multinomial multiple logistic regression model between icp forests plots was performed although often initially conducted for different purposes e g to record management actions or inform economic research national forest inventory nfi data are probably the most important and detailed source of biological data for sdm the main superiority of nfi for sdm relies on the sampling method used which respects statistical rules and can be used for inference nfi are an unbiased sampling of the forest area in a specific country and can be used to derive estimators of forest attributes their repetition at almost regular intervals of time enables monitoring and modelling of temporal changes teuscher et al 2013 hanewinkel et al 2010 modeled the potential economic consequences of a shift from norway spruce to european beech in a forest in the south of germany similarly rivera and lòpez quilez 2017 worked in spain to compare several statistical techniques for predicting species distribution of forest species iverson et al 2008a 2008b evaluated a potential response of forest species to climate change following two different emission scenarios in eastern of usa using inventory data for 134 different species of forest tree recently nfis have been used to study the possibility for detecting and conserving marginal and peripheral forest populations with several sdm techniques in order to forecast possible adaptation strategies for two mediterranean species abies alba and fagus sylvatica sharing a common environment marchi and ducci 2018 based on the classic sdm evaluation method true skill statistic tss see below a higher accuracy of predictions was obtained modeling only a small part of the whole distribution referred as provenance and mainly due to the reduction in the background noise consequently authors concluded that the provenance species distribution modeling may represent a valuable step forward in spatial analysis particularly for the detection of marginal peripheral populations 2 2 global datasets and raster layers the global biodiversity information facility gbif database is an important source of auxiliary information for sdm the database gives information on occurrence data outside the native range and therefore an indication of the ability of species to grow under different climate conditions booth 2014 dyderski et al 2018 as with icp forests its main problem is the lack of sample design guisan et al 2017 and thus it is rarely use as a principal source of data however there are several examples of it being utilized hernández quiroz et al 2018 related quercus occurrence data to its current distribution using gbif data in booth 2014 the gbif is related to the atlas of living australia ala to develop a methodology which describes the climatic requirements of eucaplyptus nitens dyderski et al 2018 also worked with gbif as additional information to improve the predicted performance of their sdm in another study zhang et al 2017 integrated data from the fia united states forest inventory and analysis and psp canadian permanent sampling plots with gbif to develop an ensemble sdm which evaluated potential habitat suitability for forest species under different conditions of climate land use and dispersal constraints local regional or national datasets such as forest category maps represent valuable strata for regional studies which can enrich national continental or global datasets for example forest ecotypes link plant species to certain zones marchi et al 2016 used ecotypes to model future scenarios for a marginal forest population of black pine pinus nigra spp nigra var italica in the mediterranean area in order to forecast potential mitigation strategies and propose an assisted migration protocol similarly in iturbide et al 2015 11 different ecotypes of quercus spp were used to analyze the effect of different methods for pseudo absence data generation and generate optimal results national forest maps have also sometimes been utilized in garzón et al 2006 a distribution map at a resolution of 1 km was used to assess the potential distribution of pinus sylvestris in spain similarly wang et al 2016 studied likely climate change effects on the distribution of some common chinese tree species statistical maps of forest tree species represent an alternative and interesting source for sdm brus et al 2012 recently generated raster maps at 1 km resolution for 20 forest tree species in europe input data was sourced from icp forests records and nfi inventory statistics for 18 european countries for areas covered by national inventory plots the proportional area of each of the 20 species was calculated using a kriging interpolation method a multinomial regression model was then applied to predict species composition for the rest of europe the results of the model were then scaled using independent data these datasets have been widely used van der maaten et al 2017 investigated the hypothesis that future climate projections are linked to temporal or spatial variation in forest growth ring width these datasets were also used by maps were also used by noce et al 2017 to study the potential effect of climate change on hot spot distribution in southern europe with regards to common group of forest species 3 climate soil land cover and variable choice many factors need to be taken into account when choosing an appropriate predictor variable the purpose of the study the availability of data and the redundancies between variables an additional issue in variable selection is collinearity which can occur between predictors this phenomenon occurs where two or more predictors are related to one another linearly or not this can affect the proportion of variance explained by each independent variable while no impact has been found on final prediction this characteristic can make it difficult to establish the relative importance of predictors in affecting the distribution of species dormann et al 2013 where there is high collinearity among predictors the easiest method is to remove some of the highly correlated variables from the computational steps schröder 2008 a pre determined threshold which generally ranges between 0 8 and 1 0 dormann et al 2013 can be applied to filter them to avoid subjective selection the use of a pre selective technique such as principal component analysis pca can be used variables are then chosen according to the proportion of variance explained by each component cruz cárdenas et al 2014 metzger et al 2013 alternatively pca components can be used as predictors marchi and ducci 2018 however even with a mathematically perfect model the components are orthogonal for construction the importance of each ecological predictor is hard to estimate another option is the cluster independent method with two sub variants i to select variables where the correlation values are under 0 7 or ii residual regression finally latent variable models can be used to infer hidden variables from observed and collinear variables dormann et al 2013 3 1 worldclim and worldclim based raster surfaces the environmental variables or predictors in sdm are used to derive the ecological niche which can then be used to model species distributions according to their drivers pearson 2010 the choice of predictor variables represents a critical step which must be based on the ecoogical tolerance and habitat requirements of the species in question jarnevich et al 2015 despite its important repercussions on model performance the predictors issue has only recently begun to acquire greater attention barbet massin and jetz 2014 climate variables e g temperature and precipitation but also derived climatic indexes are generally the most used variables in sdm thuiller 2013 at current time many different sources of climate data are freely available on the web barbet massin and jetz 2014 worldclim fick and hijmans 2017 being the most common worldclim collects monthly climate data at several resolutions ranging from 10 min about 300 square km to 30 arc seconds about 1 square km after initial release 1960 1990 version 1 4 where only temperature maximum minimum and average precipitation and 19 bioclimatic indices were available new indices including solar radiation vapor pressure and wind speed have been added and all other indices extended for the period 1970 2000 version 2 0 fick and hijmans 2017 worldclims implementation in sdm is very common in the scientific literature for example casalegno et al 2010 build an sdm describing the vulnerability of pinus cembra to climate change märkel and dolos 2017 used the 19 bioclimatic variables from worldclim to calculate starting from climate data derived from german climate service the final aim is to build a methodology to combine them in unique technique to better evaluate the climate change impact in germany however two main shortcomings arise i the global extension makes the dataset often unsuitable for local application and ii the lack of an adequate coverage in some regions of the globe make some climatic variables unreliable especially precipitation data bedia et al 2013 marchi et al 2019 given these limitations an alternative or complementary sources to worldclim is the recently released envirem dataset environmental raster for ecological modeling it combines a set of biological and topographic variables calculated from worldclim rasters and solar radiation title and bemmels 2018 3 2 standalone software for climatic custom queries the use of standalone software for local downscaling of climatic data is gaining attention in the scientific literature among these climateeu climatena and climatesa software packages are valuable tools https sites ualberta ca ahamann data html with which to generate customized raster maps for europe north america and south america respectively for both historical time slices or future scenarios these packages provide a method to downscale prism data using a combination of bilinear interpolation and dynamic lapse rate adjustment the prism parameter elevation regression on independent slopes model climate database available for united states only provides mean monthly precipitation and minimum and maximum temperature values for the period 1971 2000 these data were interpolated to produce climate variables for the entire united states using a dem available at 30 arcsec of spatial resolution daly et al 2008 the software calculates monthly seasonal and annual climate variables for a specified location on the base of latitude longitude and elevation wang et al 2012 hamann et al 2013 and van der maaten 2017 used this database to build a sdm fore distribution of european tree forest species inclduing norway spruce scots pine european beech and pedunculate oak isaac renton et al 2014 also used climatena and climateeu to build a sdm for douglas fir and evaluate species transferability between continents in view of climate change concerning europe climateeu was used by marchi and ducci 2018 to generate raster surfaces at 250 m of spatial resolution in combination with nfi data local climate datasets are undoubtably the most accurate source of information for sdm but they are also the least accessible local data is used widely in forest management and especially in forest monitoring due to its higher precision and quality ferrara et al 2017 bedia et al 2013 compared the use of national climate data to data from worldclim in order to verify the differing sensitivity in sdms using distribution data for fagus sylvatica in smaller region local climate databases were also used in crimmins et al 2013 four predictor variables minimum and maximum temperature mean annual actual evapotranspiration and mean annual climatic water deficit hypothesized to have a direct influence on species distribution were tested in order to evaluate the success of a consensus approach for predicting the distribution of plant species 3 3 soil and land cover datasets in addition to climate data soil and land cover information can be included in sdm approaches the principal characteristics of interest with regards to soil are ph texture fertility and soil moisture roces diàz et al 2014 used nfi data for spain together with 9 different predictors among them an index of fertility of soils to realize a distribution model which investigates the relationship between climate and the distribution of 6 different tree species coudun et al 2006 used many different predictor variables to realize a sdm to investigate the importance of climate and other edaphic variables to distribution of acer campestre ph was a key variable together with other 6 other variables linked to aspects of soil despite soil being a critical predictor variable its use in sdm is limited as the lack of available datasets in either digital format or suitable resolution makes it hard to find data of comparable quality to climate data mod et al 2016 thuiller 2013 the most relevant and up to date information with global coverage is soilgrids250 m hengl et al 2017 this dataset provides global predictions for standard numeric soil properties organic carbon bulk density cation exchange capacity cec ph soil texture fractions and coarse fragments at seven standard depths 0 5 15 30 60 100 and 200 cm in addition to predictions of depth to bedrock and distribution of soil classes based on the world reference base wrb and usda classification systems the interpolated surfaces were built using more than 150 000 soil profiles and 158 remote sensing based soil covariates primarily derived from modis land products srtm dem derivatives used as predictors in a combination random forest model and multinomial logistic regression algorithm in manchego et al 2017 this database was used to evaluate the potential effects of deforestation and climate change on the distribution of 17 characteristic forest tree species of dry forest in ecuador in terms of land cover land cover change for example agricultural intensification can have important effect on the distribution of different organisms by including land cover data in sdm the explanatory power of the model is often increased while the predictive performance remain unchanged thuiller et al 2004 despite this use of land cover data has not been common in plant distribution studies except when predicting species abundance bradley et al 2012 mod et al 2016 for example hill et al 2017 predicted the future abundance of typical forest trees in uk by means of a land cover change map in addition to land use and land cover maps digital elevation models dem or digital terrain models dtm and mathematically derived maps i e slope aspect topographic position index etc are sometimes included when choosing an appropriate dem spatial resolution and any uncertainties associated with interpolation are principal factors to consider franklin 2010 garzón et al 2006 used aspect and slope as predictors while duan et al 2014 included altitude among several other predictive variables however generally the use of terrain models has often been neglected given that the information they provide is already included in climatic maps and no climate change effects can be added to such predictors 4 modelling algorithms many different algorithms are currently implemented in sdm processes guisan et al 2017 and 12 modeling methods have been described and selected according to their use in the analyzed literature fig 1 there is consensus that a single and perfect technique for all possible sdm cases is impossible and thus the selection of the an appropriate modeling algorithm is fundamental as demonstrated by many studies beale and lennon 2012 buisson et al 2010 duan et al 2014 jarnevich et al 2015 koo et al 2017 choosing the correct algorithm can reduce the uncertainty within the model the algorithms involved in sdm computational steps can be divided into different groups and according to various characteristics and grouping criteria in this review paper the analyzed algorithms were firstly divided according to input data i presence only and ii presence absence algorithms then subgroups were made based on intrinsic characteristics e g distance based linear or regression model classification and decision trees machine learning a graphical scheme of the proposed structure is shown in fig 2 4 1 presence only algorithms all techniques included within this group are characterized by their ability to model the spatial distribution of a target species simply on the basis of species occurrence or presence very simple and computationally light these are the oldest technique used in ecological modeling but also acknowledged as being less powerful and often unsuited for predicting the effects of climate change guisan et al 2017 hijmans and graham 2006 miller 2010 algorithms included in this group and reported here are bioclim or surface range envelope sre the mahalanobis distance the domain algorithm and the environmental niche factor analysis enfa the bioclim or surface range envelope sre algorithm has been extensively used for sdm and represents the classic climate envelope model booth 2014 hijmans and elith 2011 although it generally does not perform as well as some other modelling methods elith et al 2006 it is still used as it is easy to understand and thus useful in teaching sdm this method computes the similarity of a location by comparing the values of environmental variables at any location to a percentile distribution of the values at known locations of occurrence the closer to the 50th percentile the median the more suitable the location is a key shortcoming is that the tails of the distribution are not distinguished and the 10th percentile is treated as equivalent to the 90th percentile bioclim has been used less by recent literature and where it does occur this is often in comparative papers for example duan et al 2014 evaluated the predictive capacity and solidity of different techniques for estimating species distribution for many forest tree species pinus massoniana betula platyphylla quercus wutaishanica quercus mongolica and quercus variabilis an interesting use of such algorithm is as ancillary model to generate pseudo absences in biomod2 package thuiller et al 2009 in this package bioclim called sre can be used to generate an user defined number of pseudo absences in a target spatial extent laying outside the ecological distribution of the species to be modeled and described by the occurrences we found the mahalanobis distance to be the most popular algorithm among the distance based methods this method calculates the suitability area as a multivariate and environmental distance between the study area and a vector of optimum climate condition generally calculated as a mean of all values which occur in a presence dataset farber and kadmon 2003 peterson et al 2011 the predictive power of mahalanobis is higher than bioclim farber and kadmon 2003 but some disadvantages still occur franklin 2010 highlighted the inability to weight the relative influence of different predictor variables similarly to mahalanobis the domain algorithm carpenter et al 1993 computes environmental distance in this case the gower distance is used which calculates the distance between environmental variables at any location and those at any of the known locations of occurrence training sites for each variable the minimum distance between a site and any of the training points is taken to integrate findings across environmental variables the maximum distance to any one of the variables is used and this distance is subtracted from one environmental niche factor analysis enfa is the last algorithm in the family of presence only and distance based methods this algorithm is able to estimate the ecological niche through a comparison of presence data and environmental values for the entire area guisan et al 2017 hirzel et al 2002 rupprecht et al 2011 used this method to evaluate the prediction capacity of different type of algorithms for a distribution of juniperous oxycedrus species 4 2 presence absence algorithms this second group is populated by more complex and time consuming but also more complete algorithms this is due to both the higher amount of information they can handle and the inclusion of absences in the modeling steps indeed absence data are often numerically more common than presence data sometimes even ten times more for this reason such models need to handle this problem properly weighting the sun of presences and absences equally this statistical method is generally called prevalence barbet massin et al 2012 manel et al 2001 marchi and ducci 2018 according to the statistical family two different sub groups can be defined regression based and machine learning the first group includes parametric models such as generalized linear models glm generalized additive models gam and multivariate adaptive regression splines mars among the immense literature on machine learning algorithms artificial neural network ann classification trees cart maximum entropy maxent genetic algorithm garp and random forest rf are herewith discussed as the most used nonparametric algorithms glm represent one of the principal algorithms in sdm as a flexible and relativley simple tool derived from linear model guisan et al 2002 the main characteristic of glm which distinguishes it from a general linear model is the possibility to include a response variable with a different distribution family from the gaussian for example binomial or poisson guisan et al 2017 this algorithm is particularly useful for non normal distribution data bolker et al 2009 its use in the case of sdm is allowed by means of the specification of a binomial family and a logistic link function the glm algorithm is extensively used in the literature higa et al 2013 assessed the importance of non climatic factors on the provision of the potential habitat for typical japanese tree species fagus crenata betula grossa carpinus laxiflora carpinus tschonoskii celtis sinensis ulmus laciniate and zelkova serrata thuiller et al 2006 evaluated the potential change in distribution of 112 tree species following climate change in europe in roces díaz et al 2014 glm clearly revealed both the difference in habitat suitability among different tree species in spain and the importance of predictor variables in particular minimum temperature and soil fertility finally thuiller et al 2009b and eith et al 2006 compared the predictive accuracy of glm with gam and cta using three independent datasets of tree species at different scales and resolution results showed that the predictive performance of glm were superior to other algorithms especially at finer scales an extension of glm is represented by the mixed effecst generalized linear mixed model glmm glmm is currently not commonly used in the forestry sector and has only recently been applied to build a novel sdm approach benito garzón et al 2019 where forest tree species were modelled according to the performances obtained in common garden experiments the main novelty of glmm rely on the use of the common garden as random effect predictor which allows to handle the differences within sites in a model cleaning the prediction from artifacts and unexplained differences as an example from another field glmm has been used to quantify the effect of imperfect detection on the estimation of niche overlap between two forest dormice muscardinus avellanarius and glis glis by paniccia et al 2018 gam represents a natural expansion of the glm algorithm guisan et al 2002 with its principal feature being high flexibility this aspect allows use of this algorithm to represent situations where there are non linear combinations between variables elith et al 2006 gam adopts a particular smoothing function to fit a non linear relation between predictive variables and species occurrence the gam algorithm is used by keenan et al 2011 to compare the future distribution of different forest species with an output from mechanistic processes walentoski et al 2017 used gam to evaluate the suitability of a franconian plateau in the south of germany for three different species in the context of climate change in rivera and lòpez quìlez 2017 compared algorithms including gam cart mars and maxent to predict the potential distribution of 17 species of forest tree from nfi data no significant differences were found between these techniques although gam showed a slightly higher predictive capacity similarly to gam the mars algorithm is a further development of glm it is computationally faster than other algorithms of the regression family and is particularly suitable when a wide range predictive variables are available choe et al 2016 miller 2010 this algorithm represents an important alternative to fitting non linear responses using a piecewise linear fit instead of a smooth function it has been used by bedia et al 2013 in comparison with glm to evaluate the sensitivity of these algorithms to different climate databases in marchi et al 2016 the algorithm was used to evaluate the potential effect of climate change on the spatial distribution of a marginal and peripheral forest population of european black pine pinus nigra spp nigra var italica in comparison with glm and rf and to generate a consensus map in périé and de blois 2016 mars is used together with other seven algorithms to evaluate the potential decline in habitat suitability for 5 forest tree species in canada picea mariana mill britton sterns poggenb abies balsamea l mill betula papyrifera marshall acer saccharum marsh and betula alleghaniensis britton cart is the first nonparametric algorithm within the machine learning group the technique is based on a recursive partitioning process where the dataset is broken into small homogeneous groups noce et al 2017 used this algorithm within a suite of different models to investigate the likelihood of future provision of suitability distributions for important forest tree species in europe the predictive performance of cart is compared with several other algorithms used by aertsen et al 2010 to model three different forest species pinus brutia pinus nigra cedrus libani in turkey cart algorithms were found to be one of the most user friendly models mckenney and pedlar 2003 used a cart algorithm to predict site productivity on the base of climatic and soil characteristics for two forest species in canada ann or sometimes simply neural networks nn is a complex technique inspired by working principles of the brain a basic ann procedure consists of a network of simple elements artificial neurons representing the brain li and wang 2013 the use of a set of adaptive weights allow the tuning of the algorithms with a learning process a nonlinear relationship between a response variable and an explanatory variable is allowed and the possibility of use data in every statistical distribution except with gaussian data are the most relevant features of the algorithm li and wang 2013 pearson et al 2002 ann algorithm is among the 4 different techniques used by thuiller 2004 to evaluate the potential distribution of different species of plant under various hypothetic climate change scenarios bedia et al 2011 also use ann algorithm as one of 6 different algorithms in assessing and comparing the predictive performance for distributions of herbaceous plant species in a northern region of spain in most cases ann turned out to be the best algorithm for predictive performance often improperly reported as presence only algorithm elith et al 2011 merow et al 2013 phillips et al 2006 we include the maxent algorithm in the presence absence group this is due to the fact that this algorithm is deeply different from sre domain mahalanobis and enfa maxent requires additional information about the external environment where the species is located i e the background this information is generally obtained automatically during computation by means of a spatial random sampling procedure guillera arroita 2017 as recognizable from the name this technique estimates the suitability of an area through a maximum entropy principle the algorithm calculates the maximum entropy probability of the distribution species and compares it with a maximum entropy probability of the entire object region guillera arroita et al 2015 the maxent algorithm has been extensively used in the literature lahssini et al 2015 studied the distribution of ceratonia siliqua l across morocco results showed a good predictive performance antönez et al 2018 used the algorithm to predict potential distribution for 13 tree species in three different time periods the most recent glaciation the present and the future period using the a2 scenario form the third assessment report of ipcc del río et al 2018 implemented maxent to evaluate the principal driving factors shaping the distribution of spanish beech in current and future climate conditions cruz cardenas et al 2014 developed a methodology to reduce or resolve the problem of spatial autocorrelation for predictor variables with maxent offering a pca for predictor variables and randomness selection for presence records clark et al 2014 examined the current and future potential distribution of an important invasive species ailanthus altissima in the appalachian region of the united states finally dyderski et al 2018 modelled the potential distribution of 12 forest species for current and future climate conditions garp genetic algorithm for rule set prediction works similarly to maxent in that it requires a presence background method barbet massin et al 2012 the genetic algorithm works on the base of a set of mathematical rules which are randomly selected and interpreted as a different and limited environmental condition or particular relationship between the environment and a species each rules is defined as a gene and each combination of genes generates a different algorithm franklin and miller 2010 li and wang 2013 elith et al 2006 use garp among 16 different algorithms to predict the potential distribution of 226 different species both animals and plants in 6 different regions of the globe garp was found to be the most suitable and best performing algorithm vessella and schirone 2013 used both maxent and garp to investigate the potential distribution of quercus suber on the basis of current climate conditions the garp algorithm outperformed maxent with drought and cold stress found to be the main factors influencing the distribution of the species rf is one of the most important most used and high performing algorithms it consists of a series of decisional trees which are randomly generated and used to build a virtual forest each single tree is constituted by a random bootstrap sample wang et al 2016 the most important feature of rf is that it is nonparametric and not vulnerable to collinearity moreover it is a robust algorithm and performs well with large datasets li and wang 2013 shortcomings of the algorithm include over fitting which can occur in some cases and the black box structure which doesn t allow the user to fully understand the calculation process as well as the weights applied to predictors morin and thuiller 2009 used different techniques to assess the potential range shift of 15 different north eastern american tree species in the context of climate change this technique rf was compared to phenofit which is a process based model and in addition to all the correlative algorithms contained within the biomod2 package thuiller et al 2009 the main aim was to compare the final output of a niche based method with other mechanistic models a high degree of uncertainty was demonstrated by the results which was similar for both models attorre et al 2011 compared rf gam and cart to evaluate the potential effects of climate change on the abundance of 27 species on the italian peninsula in garzón et al 2006 fr ann and cart are used to study the potential distribution area of pinus sylvestris rf demonstrated the best predictive performance rf is also used in koo et al 2017 where 6 other algorithms were combined to model the geographical distribution of machilus thunbergi siebold zucc a typical evergreen broadleaved tree in korea peninsula finally rf was used in benito garzón et al 2008 together with cart and ann to study the future tree distributions in the iberian peninsula the predictive performance of rf is consistently found to beslightly higher than other models all the above described algorithms are briefly summarized in table1 where the main software involved in sdm are reported for each of them the included algorithms are reported concerning r language the basic packages such as for instance stats for glm mgcv for gam randomforest for rf etc were dropped 5 model evaluation as stressed in section 4 the choice of sdm algorithm can give different predictions for habitat suitability the causes of these observed difference can be due to the small sample sizes and measurement errors as well as possible omission of an important predictor variable and the choice of gcm and climate scenario used buisson et al 2010 marmion et al 2009 in the scientific literature many comparisons between differential algorithms have been published in order to quantify and evaluate this variability and uncertainty this issue can raise further problems in particular i how to compare between different statistical algorithms ii which parameters should be used for evaluation and iii how to evaluate the compatibility between the statistical model and ecological model in such a framework two principal solutions to resolve these problems are reported in literature i comparison between different models can be made by indicators of goodness of fit or ii a consensus model approach can be used to balance projections obtained from different algorithms austin 2007 cheaib et al 2012 marmion et al 2009 thuiller 2004 both approaches aim to assess the relative accuracy of different modelling algorithms within these solutions methods can be groups into one of two categories threshold dependent or threshold independent laio et al 2011 watling et al 2013 a threshold independent method evaluates the performance of algorithm only based on comparison of the resulting probabilities in contrast a threshold dependent method requires the conversion of raw probabilities produced by the algorithm into two classes based on a defined cut off value or threshold watling et al 2013 the choice of threshold is a key source of uncertainty three different approaches can be followed a fixed threshold b data driven i e linked to species data or predicted probability c accuracy based i e the value is selected to produce the best compromise between original and the evaluated data hanewinkel et al 2014a in ecology three main methods are consistently applied area under curve auc or receiver operating characteristic roc kappa or cohen kappa statistic and the true skill statistic tss leroy et al 2018 while the first technique is generated by means of an analysis of the auc curve the last two methods are derived from the confusion matrix classification system which facilitates visualization of the performance of an algorithm márcia barbosa et al 2013 the auc area under curve or roc values represents an independent threshold technique auc produces a bi dimensional analysis with true positive error on the y axis and false positive error on the x axis fig 3 the value of auc can vary between 1 and 1 noce et al 2017 rivera and lópez quílez 2017 much of the literature reports the method to be biased and of limited use lobo et al 2008 report five key disadvantages i it ignores the predicted probability values and goodness of fit ii performances are calculated over regions of the roc space in which one would rarely operate iii omission and commission errors are weighted equally iv lack of information concerning spatial distribution of model errors v model extent strongly influences the rate of well predicted absences and auc scores despite these disadvantages auc continued to be used even by recent papers alternatively threshold dependent methods such as the kappa or cohen kappa rates algorithm performance between 0 and 1 with 1 representing good agreement between predicted and observed presence data the indicator is calculated according to the following equation k a p p a t p t n t p f n t p f p f p t n f n t n n n t p f n t p f p f p t n f n t n n where tp is the number of true positives tn is the number of true negatives fp is the number of false positives and fn is the number of false negatives detected by the algorithm on the total number of testing samples n the method is limited by the fact that it is strongly reliant on linked to species prevalence as well as uncertainty relating to the application of a threshold miller 2010 watling et al 2013 2012 tss total sum of squares is also threshold dependent but it has the advantage of being independent from species prevalence values between 1 and 1 correspond to the sum of the value of sensitivity and the value of specificity which are calculated as a proportion of presence areas and absence areas respectively barbet massin et al 2012 tss is calculated using the following equation t s s s e n s i t i v i t y s p e c i f i c i t y 1 where s e n s i t i v i t y t p t p f n s p e c i f i c i t y t n f p t n both auc and tss have been applied by noce et al 2017 to evaluate the capacity of different sdm algorithms to predict potential future suitability of hot spots for many important forest tree species in southern of europe morin and thuiller 2009 used only auc to evaluate predictive performance of alternative niche modelling techniques process based vs correlative similarly only the kappa statistic was calculated by freeman and moisen 2008 to evaluate predictive performance of sdm for 13 forest tree species in usa a combination of methods was used by falk and hempelmann 2013 to evaluate predictive performance zhang et al 2015a b compared all three different methods to evaluate the accuracy of alternative predictive models to study plant distribution in china auc and tss were found to outperform kappa thurm et al 2018 also adopted tss to evaluate algorithms used to estimate the present and future potential distribution of 12 forest tree species in europe all the statistics discussed above are among the most used but not the only in literature and are often employed to generate consensus or ensemble maps the interest in ensemble modeling is growing rapidly not only in ecology but also in other fields such as economy and medicine individual algorithms are combined using different techniques for example a selective algorithm pca or a mathematical or statistical functions such as taking the median mean or weighted average taking the mean remains the most commonly used option in sdm kindt 2018 marmion et al 2009 in many papers studying the forestry sector tss values are the most common weight applied to each algorithm keenan et al 2011 evaluated the predictive performance of models using the weighted mean of tss engler et al 2013 used the same technique to present an interesting method to map the distribution of each individual tree belonging to a principal forest species in switzerland zhang et al 2015a b calculated kappa auc and tss values for each different sdm algorithm employing an ensemble technique which considered three different functions the median the frequency and the simple mean 6 future scenarios dealing with the uncertainty behind modeling steps the process of selecting adequate software presence absence datasets environmental predictors modeling algorithms and weighting procedures is often carried out with the aim of exploring future scenarios in order to derive insight on how climate change might impact forest tree species distributions the future provision of ecosystem services will be highly influenced by climate change albert et al 2017 ray et al 2019 and sdm techniques can support decision makers in developing forest management strategies the use of better adapted forest tree species genotypes and provenance selection genotyping will improve the resilience of forest systems and allow assisted migration strategies hanewinkel et al 2014 marchi and ducci 2018 thus enforcing the adaptive processes of forest ecosystems ferrarini et al 2016 dealing with the uncertainties generated by climate change is a challenging matter by sampling along latitudinal north south or east west or altitudinal gradients research strategies often aim to search for regions where local adaptation is taking place becerra 2016 boisvert marsh et al 2014 kozyr 2014 the selective pressure exerted upon genotypes at higher elevations colder temperatures or southern latitudes warmer temperatures forces forest species to adapt to local conditions this kind of adaptive process if recognized as genetic difference will be a valuable resource in forest management strategies williams and dumroese 2013 future projections are generally based on a specific emission scenario which represents a hypothetical image of the possible trend in greenhouse gas emissions alternative pathways for environmental socio economic technological and demographic development are also included currently the most commonly used projections have been generated by the ipcc 5th assessment report ar5 emission scenarios are represented by representive concentration pathways rcps with four possibilities trajectories of increasing severity rcp 2 6 rcp 4 5 rcp 6 0 and rcp 8 5 these replaced the previous special report on emissions sscenarios sres a1 a2 b1 b2 goberville et al 2015 in addition to the ar5 rcps many global circulation models gcm have been developed by research groups around the world often targeted at specific geographic regions these regional gcms rely heavily on statistical probability which introduces deep degree of uncertainty in sdm efforts using those datasets for this reason researchers have tried to tackle the issue by combining multiple gcm and rcp inputs and analyzing the resulting variance the most common method is to average different outputs goberville et al 2015 for example iverson et al 2008a b used three different climate models and data from the sres emission scenarios a1 and b1 walentowski et al 2017 did repeated this method using new ar5 scenarios thereby providing a comparison hanewinkel et al 2010 used data from emission scenarios a2 and b1 to predict the possible economic consequences of a shift from picea abies to fagus sylvatica in southern germany finally benito garzón et al 2008 used data from a range of emission scenarios a1 a2 b1 b2 to simulate the impact on the distribution of the iberian tree species in three different time slices 2020s 2050s 2080s the use of regional climate models rcm allow higher precision than gcm due to their greater detail at small scale franklin et al 2013 koca et al 2006 rcm are derived from gcm models through a process of statistical downscaling for instance an interesting comparison was made by liu et al 2014 where the use of gcm or rcm was assessed when dealing with climate change impacts and the future scenarios for invasive plants in usa a static sdm i e no migration included is based on the assumption that species distribution is in equilibrium with climate and will react locally to a changing climate the inclusion of the migration capacity of different tree species is a rapidly increasing theme in recent literature and could be used to improve estimations of the ability of a target species to colonize new sites two important methods are currently available to evaluate the migration capacity the migclim engler et al 2012 and kissmig algorithms subba et al 2018 both are currently available as r packages and while the first enables the implementation of species specific dispersal constraints into projections of sdm kissmig offers a simple raster based and stochastic migration model nobis and normand 2014 7 conclusions this review has found an evident increment in scientific contribution relating to sdm from 2000 to 2019 demonstrating a growing interest for the technique the primary aim of sdm in forest research and management is to derive insights relating to the future potential distribution of tree species in order to implement effective adaptation strategies janowiak et al 2017 the literature highlights that the correct interpretation and use of presence absence datasets is central to deriving a correct estimation of the ecological niche for the species in question another key finding is the need to reduce the uncertainties associated with modelling steps e g reliability of species distribution data climate surfaces gcms and further work in this area is highly important to improve estimations of future forest distribution and resulting ecosystem services a key downfall of sdm as it stands is the lack of inclusion of biotic interaction into the modeling procedure inclusion of these processes would see a shift from sdm to true ecological niche models however such models even if theorized are yet to be achieved a promising area of further research are multi species and multi level sdm where many target trees are modeled at the same time currently only single tree models are in use leaving the final merging procedure to a simple overlay process in a gis environment host disease models offer an similar promising advancement where both host and disease are modelled according to climate change scenarios to simulate the potential future impact of biotic stresses e g insects fungi bacteria on forest tree species in this case a co evolution in modelling techniques is expected and consequently a combined sdm offers a promising method to model such interactions acknowledgements this study was partially supported by the phd grant provided by the university of florence to matteo pecchi in the framework of the project effetti di eventiestremi a seguito di cambiamenti climaticisu ambientinaturali e semi naturali impatto mitigazione e resilienza maurizio marchi and vanessa burton were partially funded by the eu in the framework of the horizon 2020 b4est project adaptive breeding for productive sustainable and resilient forests under climate change ue grant agreement 773383 
