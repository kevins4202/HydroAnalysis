index,text
22140,in offshore oil and gas wells the post buckling transition of compressed pipe strings is a significant engineering problem to be addressed particularly in horizontal wellbores many hypotheses exist in theoretical research and it remains difficult to accurately measure the post buckling mode in experimental tests in the current study the compressed pipe strings initially located at the bottom of horizontal wellbores were discretized into beam elements and a gap element was introduced to detect the contact between the horizontal strings and the wellbores the dynamic relaxation algorithm was used in finite element analysis to improve the weak points of the theoretical and experimental research the calculation results show that the post buckling transition exhibits nonlinearity based on the calculated post buckling modes the dimensionless critical loads for sinusoidal and helical buckling were identified after sinusoidal buckling it was observed that the compressed string was not in continuous contact with the horizontal wellbore and two non contact sections appeared near the string ends these numerical results are beneficial for understanding the post buckling behaviors of horizontal strings in wellbores keywords horizontal strings post buckling transition sinusoidal buckling helical buckling gap element dynamic relaxation nomenclature a cross sectional area of horizontal string d o outer diameter of string d d d vector of node displacement velocity and acceleration d i inner diameter of cylinder e elastic modulus of horizontal string e i bending stiffness of compressed pipe string f k coefficient of contact stiffness f pe penetration coefficient f c axial compression force f cq applied external load vector f n vector of contact force f n contact force between horizontal strings and cylinders f min iterative error of contact force of gap element f n k contact force for iteration k f a applied load vector f r initial disturbance force f i internal load vector f r residual force vector f sin f hel critical loads of sinusoidal and helical buckling k 0 elastic stiffness matrix of beam elements k σ geometric stiffness matrix of beam elements k gap contact stiffness matrix of gap elements k gap contact stiffness k gap k contact stiffness for iteration k k gap 0 initial contact stiffness l length of beam element l length of horizontal string δ l axial displacement δ l sin δ l hel axial displacement with respect to critical load of sinusoidal and helical buckling m c k global mass matrix damping matrix and stiffness matrix of horizontal string q weight per unit length of string r radial displacement of string r lateral displacement vector r c initial annular gap vector r c initial annular gap r pe 0 initial penetration t response time t characteristic period t end total response time δ t time increment u node displacement vector u v w translational displacement in x y z direction u lateral displacement of string u lateral displacement vector α damping α 0 reference α damping β dimensionless load β sin β hel dimensionless critical loads of sinusoidal and helical buckling β n δ n newmark integral parameters γ n amplitude attenuation coefficient ε min ε max minimum and maximum iteration errors for gap element strain ε gap normal strain of gap element ε sin ε hel critical strains of sinusoidal and helical buckling ζ damping ratio θ angular displacement θ x θ y θ z rotational displacement around the x y z axis φ rotation angle in cylinder ρ density of horizontal string ω reference natural frequency γ l dimensionless length of horizontal string γ u dimensionless compression displacement 1 introduction as horizontal wells can significantly improve oil and gas production and recovery horizontal well drilling completion and logging techniques have made great progress in recent decades for example the wisting central ii well as shown in fig 1 is the first horizontal appraisal well in the barents sea and it achieved a new drilling record in 2016 it is the shallowest horizontal offshore well drilled from a floating drilling facility the water depth at wisting is 402 m the well started vertically and was successfully steered into a horizontal orientation within a 250 m depth interval the total well length is 2354 m and the horizontal section measures 1402 m to ensure the smooth progress of these tasks in the future it is necessary to conduct a detailed analysis of the stability of the horizontal pipe strings in the wellbores this is necessary because buckled pipe strings can cause many problems such as drilling tool dropping the application of the weight on bit wob fatigue and wear as well as fracture of the pipe strings zhang et al 2014 2016 drumond et al 2018 loads may cause buckling of the pipe string which includes external pressure shahandeh and showkati 2016 li et al 2019 liu and wang 2019 bending moments ghazijahani and showkati 2013 gavriilidis and karamanos 2019 axial compression loads chen and fang 2013 fang et al 2013 huang et al 2015b zhang et al 2019a gravity huang et al 2016 zhang et al 2019b 2019c and torque zhang et al 2019d the buckling behavior of the horizontal strings in wellbores is largely affected by gravity and axial compression forces researchers have generally found that when the axial compression forces at both ends is zero the string lies at the bottom of the horizontal borehole and parallel to the axis direction under the action of gravity and cylinder constraints fig 2 a when the axial compression force increases to a certain critical value the initial deformation becomes unstable and the string axis deviates from the bottom of the cylinder and forms a snake shaped deformation this is known as sinusoidal buckling fig 2 b when the axial compression force continues to increase and reaches another critical value the deformation enters a more stable shape which is known as helical buckling this buckling shape is similar to a helix and the string is in continuous contact with the inner wall of the cylinder fig 2 c throughout this process the gravity bending stiffness and cylinder constraints serve as the stability factors while the axial compression force is the unstable factor thus the final state of the string depends on the relative magnitude of the two opposing factors for sinusoidal buckling paslay and bogy 1964 first used the energy method to deduce the critical load of the pipe string 1 f sin 2 e i q r c where e i is the bending stiffness of the horizontal string r c is the radial gap between the horizontal strings and wellbores and q is the weight per unit length to simplify the derivation process many researchers chen et al 1990 miska et al 1996 liu 1999 assumed that the deformation curve was a sinusoidal curve and obtained the same results using energy methods gao et al 1998 obtained the same result by solving the buckling differential equation as the axial compression force continues to increase the sinusoidal mode becomes unstable and enters a more stable helical buckling mode various researchers have proposed different hypotheses and obtained a series of different results as shown in table 1 the relation between the axial compression force f c and the axial displacement δ l is shown in fig 3 gao and huang 2015 chen et al 1990 first deduced that the critical load of helical buckling is twice that of sinusoidal buckling using an energy method in which f c was assumed to remain unchanged during the transition from sinusoidal to helical buckling by assuming that f c varies linearly during this transition wu 1992 pointed out that the result of chen et al 1990 was only the median of the critical load of sinusoidal and helical buckling and the critical value of helical buckling was 2 2 1 times that of sinusoidal buckling miska et al 1996 assumed that f c varied linearly from non buckling to helical buckling and deduced that the critical load of the helical buckling was 2 2 times that of the sinusoidal buckling miska et al 1996 also demonstrated that when f c reached 1 875 times the critical sinusoidal buckling load the sinusoidal mode became unstable thus it was suggested that the sinusoidal or helical buckling may occur in the interval of 1 875 2 2 cunha 1995 pointed out that two critical loads of helical buckling exist the lower limit is the result presented by chen et al 1990 and the upper limit is the result presented by miska et al 1996 the upper limit corresponds to the minimum f c generated by the excitation of the helical buckling during loading and the lower limit corresponds to the maximum f c required to maintain helical buckling during unloading mitchell 1997 obtained similar results by solving the buckling differential equation gao 2006 summarized the previous research results based on experimental results he suggested that the linear change of the axial compression force in the buckling process ranging from non buckling to sinusoidal buckling and f c remained unchanged in the process of sinusoidal to helical buckling in addition the contact force between the string and the wellbore wall is always present whether it is in a sinusoidal or helical buckling state therefore another condition for the sinusoidal buckling instability is that the contact force at the bottom of the wellbore is zero and a necessary condition for the helical buckling is that the contact force between the string and the top wall of the wellbore is non negative based on these rules gao et al 1998 deduced the critical loads of sinusoidal and helical buckling and found that they were consistent mitchell 2002 used jacobi elliptic functions to solve the buckling differential equation and obtained a more accurate helical buckling solution furthermore he found another new buckling mode which moved substantially around the center line of the top of the well huang et al 2015a further proved that sinusoidal and helical buckling are only two special periodic solutions of the buckling differential equation gao and miska 2009 2010 demonstrated that when the dimensionless length q e i r c 0 25 of the pipe exceeded 5 π the effect of the boundary conditions on the buckling section was negligible liu et al 2018a 2018b studied the buckling behavior of a slender rod confined in a cylindrical tube and obtained the critical conditions from sinusoidal to helical buckling it was emphasized that the slender rod before deformation was placed in the center of the cylinder liu et al 2018a 2018b however wicks et al 2008 considered the case where part of the buckled string was not located at the bottom of the wellbore in this case the initial position of the horizontal pipe string had a great effect on the post buckling behavior at present the post buckling transition and the critical conditions of such strings in horizontal wellbores are still unclear because the transition is complex and nonlinear the sinusoidal mode surrounds the constrained wellbore bottom in an alternate manner while the helical mode forms a helical shape around the constrained wellbore in only one direction the critical loads of the two kinds of buckling configurations can be theoretically obtained by assuming that the axial forces remain constant or linear during the post buckling transition experimental studies can only obtain the relation between the compression load and axial deformation but post buckling mode measurements are absent thus the theoretical and experimental studies of the post buckling transition are quite different in this study the dynamic relaxation method was used to simulate the post buckling behavior to improve the shortcomings of theoretical and experimental research we placed horizontal strings before deformation at the bottom of a wellbore the beam and gap elements were combined to assess the contact relation between the strings and outer cylinders under the action of axial and self weight loads the equilibrium state of the post buckling configuration of horizontal pipe strings was studied and the transition of the post buckling mode was analyzed in addition we analyzed the effect factors of the dynamic relaxation algorithm 2 model and method 2 1 basic assumption 1 the horizontal string is linearly elastic and it was assumed that the deformation is small 2 the cross sections of the string and wellbore are assumed to be circular 3 the horizontal borehole is treated as a rigid cylinder 4 the string before deformation is located at the bottom of the horizontal borehole and maintains a straight line equilibrium state before buckling the main difference is that previous studies liu et al 2018a 2018b placed the horizontal rod at the center of the cylinder 5 the buckled string may contact any circumferential position of the rigid wall of the wellbore ignoring the friction effect 6 the static buckling of the horizontal string under a given axial compression force is studied and the transient effects of inertia and damping forces are neglected 2 2 buckling differential equation the ends of the horizontal string are subjected to axial compression forces f c and the weight per unit length is q the widely used buckling differential equation of strings constrained by boreholes is as follows mitchell 1988 2 d 4 θ d x 2 6 d θ d x 2 d 2 θ d x 2 d d x f c e i d θ d x q sin θ e i r c 0 where θ is the angular displacement and x is the coordinate along the cylinder axis 2 3 mechanical model based on the basic assumptions the buckling mechanics model of the horizontal strings constrained by cylinders is established as shown in fig 4 the force diagram is displayed in fig 4 a after sinusoidal or helical buckling of horizontal strings previous researchers generally used the continuous contact hypothesis to analytically solve eq 2 however the assumption of continuous contact is not necessarily correct after the buckling of horizontal strings some positions of the horizontal string are in contact with the cylinder fig 4 c and other positions may not be in contact with the cylinder fig 4 b using the euler bernoulli beam hypothesis and hermitian shape function approximation zienkiewicz et al 2000 the pipe strings are discretized into 3d beam elements each node contains three translational and rotational displacements the node displacement vector is 3 u u v w θ x θ y θ z t where u v w represent the translational displacements in the x y z directions respectively and θ x θ y θ z are the rotational displacement around the x y z axis respectively it is assumed that both ends of the strings are subjected to hinged constraints the boundary conditions in fig 4 a are as follows 4 v a w a u b v b w b θ b x 0 to prevent rigid body rotation the rotation in the x axis direction θ b x is restricted at the right end in fig 4 a 2 4 equilibrium equation of static buckling first the contact relation between horizontal strings and cylinders is described by gap elements liu et al 2002 after assembling the beam and gap elements the equilibrium equation for the static buckling analysis of the horizontal strings constrained by the cylinders is as follows 5 k 0 k σ k gap d f cq f n where k 0 and k σ are the elastic and geometric stiffness matrices of the beam elements respectively k gap is the contact stiffness matrix of the gap elements the axial compression force f c reduces the stress stiffness d is the node displacement vector of the beam elements f cq is the applied external load vector including the axial compression force f c and the weight per unit length q and f n is the vector of contact force between horizontal strings and cylinders in the gap element the criterion for the contact between the nodes of the horizontal strings and the cylinders is 6 f n 0 k gap r r c r r c 0 r r c 0 where k gap is the contact stiffness which requires iterative computations r is the radial displacement of the horizontal string r c d i d o 2 and d i and d o are the inner diameters of the cylinders and the outer diameters of the strings respectively in the o y z coordinate system assuming that the lateral displacement vector produced by the horizontal string at any position is u the relation between the lateral displacement vector and the radial displacement vector r is as follows 7 r u r c where the direction of the lateral displacement vector u is from the origin of the coordinates to the center of the cross section of the deformed string where the corresponding value is u v 2 w 2 r c is the initial annular gap vector and its direction is from the origin of the coordinates to the center of the cross section of the cylinder the direction of the radial displacement vector r is from the center of the cross section of the cylinder to the center of the cross section of the deformed string and the corresponding values can be obtained by vector operations according to eq 7 the radial displacement value r can be obtained and the normal strain of the gap element can be calculated as follows 8 ε gap r r c based on the strain ε gap in eq 8 and the contact force f n in eq 6 the definite formula for the iterative calculation for the gap element can be written as follows 1 for the free state fig 4 b 9 ε gap 1 0 ε min f n k f min 0 0 k gap k 0 2 for the elastic contact state fig 4 c 10 ε min ε gap 1 0 ε max f n k f min 0 0 k gap k 0 where ε min ε max and f min are small quantities larger than zero to control the convergence accuracy of the gap element iteration ε min and ε max are the minimum and maximum iteration errors for the gap element strain respectively f min is the iterative error of contact force of gap element f n k and k gap k are the contact force and contact stiffness for iteration k respectively to make the contact between the strings and the inner wall of the cylinders satisfy the definite solution of the gap element the contact stiffness k gap k of the gap element should be changed continuously in the iterative calculation the following principles should be adopted in the correction 1 the initial contact stiffness k gap 0 and the initial penetration r pe 0 are given for correction in the iteration 11 k gap 0 f k 12 e i l 3 r pe 0 f pe d o 2 where f k is the coefficient of contact stiffness l is the length of the beam element and f pe is the penetration coefficient 2 in the free state the contact stiffness k gap k is zero 3 for elastic contact the contact stiffness k gap k is related to the bending stiffness and element length the initial contact stiffness k gap 0 is used for the iterative calculation 4 the contact between the strings and the cylinder wall is multi directional the contact stiffness of the gap elements between the adjacent beam elements is mutually affected among the gap elements thus this effect should be considered when correcting the contact stiffness of the gap elements each gap element should be corrected repeatedly until all the gap elements satisfy eq 9 and eq 10 2 5 dynamic relaxation method as mentioned in the introduction the increase in the axial compression force on the horizontal string will lead to instability and sinusoidal or helical buckling may occur during the transition from sinusoidal to helical buckling some researchers suggested that the axial force remains unchanged but others suggested that the axial force is linear for the nonlinear iterative calculations of static buckling using eq 5 we used the dynamic relaxation method rezaiee pajand and estiri 2016 zhang et al 2019a to transfer the static system to the virtual dynamic space by applying an artificial damping force to attenuate the dynamic response of the horizontal string the slow dynamic solution is obtained in the implementation of the dynamic relaxation method the external loads f c and q are converted into the following time varying quantities 12 f c t f c sin π t t 0 t t 4 f c t t 4 13 q t q sin π t t 0 t t 4 q t t 4 where t is the characteristic period and t is the response time to easily form lateral deformation after buckling the following initial disturbance force f r is applied on the horizontal string 14 f r t f r sin 2 π t t 0 t t 2 0 t t 2 since the disturbance force eventually cancels and its application does not affect the critical buckling load the static loading is transformed into dynamic loading by eq 12 eq 13 and eq 14 the mechanical model of the dynamic loading and the time history of the external loading are presented in fig 5 the dynamic relaxation method is used to solve eq 5 and the following dynamic equations are obtained 15 m d c d kd f a t where m c and k are the global mass matrix the damping matrix and the stiffness matrix of the horizontal string respectively the stiffness matrix k k 0 k σ k gap d and d are the vectors of the node velocity and acceleration of the horizontal string respectively f a t is the applied load vector including f c t q t f r t and f n t the time history of the first three loads is shown in fig 5 and f n t is iteratively solved using the gap element rayleigh damping is used to set the α damping to a large value which attenuates the dynamic response of the system the artificial damping force c d is as follows su et al 2019 16 c d α m d and the reference α damping is 17 α 0 2 ζ ω where ζ is damping ratio we set ζ 1 α 0 is the reference α damping and ω is the reference natural frequency of the horizontal string expressed as follows 18 ω π 2 l 2 e i ρ a where l ρ and a are the length density and the cross sectional area of the horizontal string respectively in the non linear dynamic eq 15 the internal load is no longer proportional to the node displacement and the stiffness matrix of the horizontal string depends on the current displacement therefore instead of eq 15 the newmark implicit integration scheme is applied to the nonlinear semi discrete equation 19 m d t c d t f i t f a t where f i is the internal load vector and f i k 0 k σ k gap d t denoting the time increment as δ t when t δ t eq 19 can be rewritten as follows 20 m d t δ t c d t δ t f t δ t i d t δ t f t δ t a f t δ t i d t δ t is dependent on the current displacement d t δ t at time t δ t in addition to eq 20 the following formulas are used to update the displacement d t δ t and velocity d t δ t 21 d t δ t d t 1 δ n d t δ n d t δ t δ t 22 d t δ t d t d t δ t 1 2 β n d t β n d t δ t δ t 2 where β n and δ n are newmark integral parameters the amplitude attenuation coefficient γ n is introduced to control the amount of numerical damping the following relation is satisfied 23 δ n 1 2 γ β n 1 4 1 γ n 2 γ n 0 the newmark scheme is unconditionally stable hughes 2012 in this paper we set γ n 0 005 by using the newton raphson method bathe 2017 eqs 19 21 can be solved simultaneously when the response time t t 2 the disturbing forces f r are equal to zero and the axial compression force f c and self weight q remain unchanged eq 19 can be rewritten as follows 24 f r t m d c d f a t f i t where f r t is the residual force vector with a further increase in the response time the transient response of the horizontal strings tended to be static and the deformation d gradually became constant the velocity d and acceleration d of each node tended to 0 and the residual force f r also tended to 0 using eq 5 f a f i thus we obtain the equilibrium state of the nonlinear static buckling of horizontal strings the dynamic relaxation method was used to calculate the static equilibrium under a given axial compression force f c as for the occurrence of post buckling modes such as sinusoidal or helical shapes it is necessary to assess the deformation shape of the horizontal string based on the calculated results 3 result and discussion the calculation parameters have been described previously suryanarayana and mccann 1995 wang and yuan 2012 the length and diameter of the horizontal string were l 3 683 m and d o 6 35 mm respectively the inner diameter of the cylinder was d i 38 1 mm and the radial gap between the horizontal string and the external cylinder was r c 15 875 mm the elastic modulus density and self weight of the horizontal string were e 75 13 gpa ρ 7800 kg m3 and q 0 86828 n m respectively the characteristic period t was 10 s and total response time t end was 30 s 3 1 verification of calculation results the results of the numerical simulation from this study and the experimental loading and unloading in the literature mccann and suryanarayana 1994 are shown in fig 6 the critical loads of the sinusoidal and helical buckling are summarized in table 2 in fig 6 and table 2 we introduced the dimensionless length γ l axial compression displacement γ u and load β as follows 25 γ l l q e i r c 0 25 γ u u q e i r c 0 25 β f c 2 r c e i q 0 5 in fig 6 the trend of the axial compression force vs axial deformation is similar to previous experimental results suryanarayana and mccann 1995 the calculated results of the axial force in this paper are lower than the experimental loading and higher than the experimental unloading thus the load vs deformation curve is between that of the loading and unloading of the experimental test this occurred because the equilibrium state of the static buckling calculated in this paper did not consider the effect of friction the compression load from the sinusoidal to helical deformation was assumed to be linear in the experimental tests suryanarayana and mccann 1995 and the critical loads were determined in this paper the critical loads of the sinusoidal and helical buckling were f sin 36 27 n and f hel 87 23 n critical loads are identified in section 3 3 respectively the corresponding strains were ε sin 0 0154 10 3 and ε hel 1 21803 10 3 respectively it is difficult to observe the helical deformation of the post buckling transition in experimental tests this transition deformation obtained by the numerical simulation in this paper is also discussed in section 3 3 and the critical load will be identified according to the post buckling mode the axial force versus deformation relation in fig 6 is considerably different from that in fig 3 the results in this paper show that the axial force was neither constant nor linear during the post buckling transition region the axial force during the transition was always non linear in the front part of this transition region the axial load changed slowly with the increasing compression deformation however in the vicinity region of helical buckling and thereafter the axial load increased sharply as shown in table 2 the dimensionless length of the horizontal string was γ l 2 037 π and the dimensionless critical load of sinusoidal buckling was β sin 1 00 which is in good agreement with previous research dawson 1984 huang et al 2015 wang and yuan 2012 the dimensionless critical load of the helical buckling was β hel 2 41 which is in good agreement with wang and yuan 2012 with an error of approximately 2 the largest difference with other theoretical results chen et al 1990 huang et al 2015 huang and pattillo 2000 is mainly due to the errors caused by the continuous contact assumption adopted in the theoretical analysis the calculated results in this paper are quite different from those of previous reports chen et al 1990 wu and juvkam wold 1995 miska et al 1996 cunha 1995 mitchell 1988 gao et al 1998 huang et al 2015a as shown in table 1 the significant difference is that the critical loads of the sinusoidal buckling in table 1 have a large range and beyond this range helical buckling occurs however the conclusion in this paper is that the critical load of helical buckling is 2 41 times that of sinusoidal buckling and the load of the post buckling transition from sinusoidal to helical buckling gradually changes nonlinearly fig 6 b 3 2 effect factors of algorithm 3 2 1 effect of alpha damping in dynamic relaxation various axial compression forces were selected for calculation fig 7 shows the effect of two alpha damping on the lateral displacement when f c 87 23 n fig 8 displays the effect of alpha damping on the lateral displacement velocity and acceleration of the horizontal string in fig 7 a the same alpha damping value α 10 α 0 was set in the response time 0 t 30 s the lateral displacement of the axially compressed load e g f c 36 26 and 36 27 n was not constant within 30 s under such a damping conditions this shows that the alpha damping was too large and the attenuation of the lateral displacement was too slow however when f c 36 30 n the lateral displacement was finally constant in fig 7 b when t 5s a larger alpha damping α 10 α 0 was set and when t 5s a smaller alpha damping α 1 0 α 0 was adopted which accelerated the response of the deformation of the string with time after the disturbance force was unloaded the lateral displacement tended to be constant within 30 s when f c 36 26 n the lateral displacement decreased to 0 indicating that the horizontal string had not yet buckled when f c 36 27 n the lateral displacement decreased to a constant value indicating that the horizontal string had just buckled fig 7 indicates that when the axial compression force was slightly larger than the critical load f c 36 27 n the alpha damping had no effect on the final lateral displacement for a given load therefore the stability of the post buckling deflection was obtained by setting an appropriate alpha damping in the dynamic relaxation method fig 8 illustrates that it took less time to reach stability for the helical buckling deformation when the α damping was small for example the response times needed to keep the lateral displacement unchanged were 3 25 6 25 and 18 25 s for α 50 α 0 100 α 0 and 300 α 0 respectively the corresponding response times needed to decrease the lateral velocity to zero were 5 50 7 25 and 20 25 s respectively and the response times for the lateral acceleration to reach zero were 17 75 21 00 and 25 75 s respectively when the alpha damping was large e g α 800 α 0 the lateral displacement increased continuously for a response time t end 30 s and the time invariant deformation could not be obtained however when the alpha damping was small a larger lateral velocity and acceleration occurred in the application stage of the perturbation and axial compression forces if the alpha damping was further reduced the calculation did not converge therefore based on the calculation of post buckling using the dynamic relaxation method in order to calculate the convergence the damping value must be appropriately increased to obtain results faster and more stably the damping could be appropriately reduced 3 2 2 effect of beam element length in finite element simulations the element length is critical to the accuracy of the calculations therefore we calculated the effect of the beam element length on the horizontal string deflection curve as displayed in fig 9 fig 9 shows that when the element length was less than or equal to 0 05 m the deflection curves coincided by contrast when the element length was more than 0 05 m the rotation angle near the end of the horizontal string varied greatly and the lateral displacement did not coincide to obtain higher accuracy an element length of 0 02 m was selected for this study 3 2 3 effect of contact stiffness of gap element the contact stiffness affects the contact force value and distribution given the axial compression force and damping before satisfying the contact non linear iteration between the horizontal string and the cylinder we use eq 11 to select the appropriate initial contact stiffness and analyze its effect on the contact force as shown in fig 10 when the contact stiffness was small f k 0 01 a continuous contact section is present near x l 0 2 fig 10 a however when the contact stiffness increased e g f k 0 05 the continuous contact section was converted into a point contact fig 10 b regardless of the contact stiffness selected the continuous contact section was always present in the middle of the string for a contact stiffness 0 05 f k 0 5 the contact force of the point contact increased continuously fig 10 b the contact force near the ends of the continuous contact section also varied greatly fig 10 c for f k 0 5 the contact forces of the point contact and the continuous contact section do not change with the contact stiffness fig 10 b and c in the calculations in this paper the coefficient of contact stiffness of the gap element was taken as f k 0 5 3 3 post buckling deformation analysis the deformation curves during the post buckling transition were calculated under various axial compressive loads as presented in fig 11 when the axial compression force was f c 36 26 n the horizontal string was at the bottom of the inner wall of the cylinder both the lateral displacement u and angular displacement φ were zero when f c 36 27 n the lateral deflection of the horizontal string was at the 0 25 l fig 7 b and 0 75 l positions but u and φ were smaller fig 11 under this force the horizontal string exhibited a sinusoidal deformation thus f c 36 27 n is the critical load of sinusoidal buckling with an increase in the axial compression force the lateral displacement u and the angular displacement φ increased gradually the lateral deformation in the sinusoidal wave moved upward along the cylinder wall on both sides of the circumferential direction when f c increased to a certain value e g f c 46 04 n in fig 11 the deformation appeared to be separated from the cylinder wall at a position away from the ends of both sides however as f c was further increased the second non contact section appeared on both sides near the end e g f c 55 49 n in fig 11 and one contact point existed between the two non contact sections which is called the point of contact c2 during the entire transition of post buckling the deformation of the horizontal string in the middle e g the position between the contact points c1 in fig 11 b was still in the continuous contact state the non contact section appeared in the post buckling deformation which is inconsistent with the continuous contact assumption in reported in previous studies chen et al 1990 wu 1992 miska et al 1996 gao et al 1998 as shown in fig 11 the buckling deformation was consistently two half sine waves in the oxy plane view however when f c 70 44 n the buckling deformation changed from one to two sine like waves in the oxz plane view and the angular displacement of the non contact section near the end of the horizontal string was positioned exactly on the y axis when f c 70 44 n the direction of angular displacement changes e g the buckling deformations corresponding to f c 71 47 and 87 23 n in fig 11 when the deformation was in contact with the top of the cylinder the axial compression force was defined as the helical buckling load for f c 87 23 n the angular displacement φ of the top contact point c2 in fig 11 b was 90 that is the deformation of the horizontal string was in contact with the top of the cylinder this force f c 87 23 n was identified as the critical load of helical buckling 3 4 further discussion in this study the numerical simulation was mainly based on existing theoretical and experimental test results we further analyzed the critical load of the sinusoidal to helical buckling process and presented the post buckling mode during the transition which is difficult to accurately measure experimentally in the numerical simulations the conclusion was inconsistent with the theoretical hypothesis i e that continuous contact in the post buckling transition is not applicable and that our calculated post buckling mode of discontinuous contact is difficult to observe experimentally the calculated relation between the load and deformation is generally consistent with the experimental results which is different from the theoretical assumption chen et al 1990 wu 1992 miska et al 1996 gao et al 1998 that the axial force remains unchanged chen et al 1990 or changes linearly wu 1992 miska et al 1996 gao et al 1998 in the post buckling process all the studies discussed here in were performed without considering the friction between the string and the wellbore although this is an ideal case it can provide valuable insight into the post buckling behavior of horizontal strings constrained by wellbores when the friction is relatively small it will not change the sinusoidal and helical shapes nor will it affect the transition between sinusoidal and helical buckling friction will delay the transition from a sinusoidal shape to a helical shape however when the friction force is large it can prevent the transition from a sinusoidal to a helical shape and the string can become locked in the helical shape without any axial extension which is undesirable in the horizontal drilling or completion process lastly there is fluid action in the oil and gas pipe string and the string has torsional deformation the post buckling transition behavior of the flow induced pipe string such as the critical fluid velocity and inside and outside pressure will be subjects of future research 4 conclusion 1 comparing the numerical results with experimental and theoretical results the accuracy of the post buckling finite element simulation of horizontal strings constrained by cylinders was verified the critical load of sinusoidal buckling is completely consistent with the literature while the error between the critical load of helical buckling and wang and yuan 2012 is approximately 2 2 we discussed the effect factors of the dynamic relaxation method including the damping element length and contact stiffness among these factors the damping affects the response time and can effectively solve the convergence problem but does not affect the calculation accuracy the element length affects the buckling deformation to ensure the accuracy of the calculation the coefficient of contact stiffness should be greater than or equal to 0 5 3 the horizontal string initially located at the cylinder bottom did not always stay in contact with the cylindrical wall during the transition from sinusoidal to helical buckling the non contact section appeared near the end of the horizontal string after sinusoidal buckling this observation is different from the continuous contact hypothesis used in theoretical analysis 4 the axial compression force during the post buckling transition gradually increased nonlinearly the dimensionless critical loads of the sinusoidal and helical buckling are recognized according to the post buckling mode author contribution statement qiang zhang conceptualization methodology software jiancheng wang data curation writing original draft preparation wei cui visualization investigation zhongmin xiao result validation supervision reviewing and editing qianbei yue software design and validation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the authors gratefully acknowledge the support of singapore a star serc ame programmatic fund for the structural metal alloys programme project wbs m4070307 051 this research is also supported by national natural science foundation of china 51904075 51774093 51674088 and china postdoctoral science foundation 2019m661248 2018m641804 
22140,in offshore oil and gas wells the post buckling transition of compressed pipe strings is a significant engineering problem to be addressed particularly in horizontal wellbores many hypotheses exist in theoretical research and it remains difficult to accurately measure the post buckling mode in experimental tests in the current study the compressed pipe strings initially located at the bottom of horizontal wellbores were discretized into beam elements and a gap element was introduced to detect the contact between the horizontal strings and the wellbores the dynamic relaxation algorithm was used in finite element analysis to improve the weak points of the theoretical and experimental research the calculation results show that the post buckling transition exhibits nonlinearity based on the calculated post buckling modes the dimensionless critical loads for sinusoidal and helical buckling were identified after sinusoidal buckling it was observed that the compressed string was not in continuous contact with the horizontal wellbore and two non contact sections appeared near the string ends these numerical results are beneficial for understanding the post buckling behaviors of horizontal strings in wellbores keywords horizontal strings post buckling transition sinusoidal buckling helical buckling gap element dynamic relaxation nomenclature a cross sectional area of horizontal string d o outer diameter of string d d d vector of node displacement velocity and acceleration d i inner diameter of cylinder e elastic modulus of horizontal string e i bending stiffness of compressed pipe string f k coefficient of contact stiffness f pe penetration coefficient f c axial compression force f cq applied external load vector f n vector of contact force f n contact force between horizontal strings and cylinders f min iterative error of contact force of gap element f n k contact force for iteration k f a applied load vector f r initial disturbance force f i internal load vector f r residual force vector f sin f hel critical loads of sinusoidal and helical buckling k 0 elastic stiffness matrix of beam elements k σ geometric stiffness matrix of beam elements k gap contact stiffness matrix of gap elements k gap contact stiffness k gap k contact stiffness for iteration k k gap 0 initial contact stiffness l length of beam element l length of horizontal string δ l axial displacement δ l sin δ l hel axial displacement with respect to critical load of sinusoidal and helical buckling m c k global mass matrix damping matrix and stiffness matrix of horizontal string q weight per unit length of string r radial displacement of string r lateral displacement vector r c initial annular gap vector r c initial annular gap r pe 0 initial penetration t response time t characteristic period t end total response time δ t time increment u node displacement vector u v w translational displacement in x y z direction u lateral displacement of string u lateral displacement vector α damping α 0 reference α damping β dimensionless load β sin β hel dimensionless critical loads of sinusoidal and helical buckling β n δ n newmark integral parameters γ n amplitude attenuation coefficient ε min ε max minimum and maximum iteration errors for gap element strain ε gap normal strain of gap element ε sin ε hel critical strains of sinusoidal and helical buckling ζ damping ratio θ angular displacement θ x θ y θ z rotational displacement around the x y z axis φ rotation angle in cylinder ρ density of horizontal string ω reference natural frequency γ l dimensionless length of horizontal string γ u dimensionless compression displacement 1 introduction as horizontal wells can significantly improve oil and gas production and recovery horizontal well drilling completion and logging techniques have made great progress in recent decades for example the wisting central ii well as shown in fig 1 is the first horizontal appraisal well in the barents sea and it achieved a new drilling record in 2016 it is the shallowest horizontal offshore well drilled from a floating drilling facility the water depth at wisting is 402 m the well started vertically and was successfully steered into a horizontal orientation within a 250 m depth interval the total well length is 2354 m and the horizontal section measures 1402 m to ensure the smooth progress of these tasks in the future it is necessary to conduct a detailed analysis of the stability of the horizontal pipe strings in the wellbores this is necessary because buckled pipe strings can cause many problems such as drilling tool dropping the application of the weight on bit wob fatigue and wear as well as fracture of the pipe strings zhang et al 2014 2016 drumond et al 2018 loads may cause buckling of the pipe string which includes external pressure shahandeh and showkati 2016 li et al 2019 liu and wang 2019 bending moments ghazijahani and showkati 2013 gavriilidis and karamanos 2019 axial compression loads chen and fang 2013 fang et al 2013 huang et al 2015b zhang et al 2019a gravity huang et al 2016 zhang et al 2019b 2019c and torque zhang et al 2019d the buckling behavior of the horizontal strings in wellbores is largely affected by gravity and axial compression forces researchers have generally found that when the axial compression forces at both ends is zero the string lies at the bottom of the horizontal borehole and parallel to the axis direction under the action of gravity and cylinder constraints fig 2 a when the axial compression force increases to a certain critical value the initial deformation becomes unstable and the string axis deviates from the bottom of the cylinder and forms a snake shaped deformation this is known as sinusoidal buckling fig 2 b when the axial compression force continues to increase and reaches another critical value the deformation enters a more stable shape which is known as helical buckling this buckling shape is similar to a helix and the string is in continuous contact with the inner wall of the cylinder fig 2 c throughout this process the gravity bending stiffness and cylinder constraints serve as the stability factors while the axial compression force is the unstable factor thus the final state of the string depends on the relative magnitude of the two opposing factors for sinusoidal buckling paslay and bogy 1964 first used the energy method to deduce the critical load of the pipe string 1 f sin 2 e i q r c where e i is the bending stiffness of the horizontal string r c is the radial gap between the horizontal strings and wellbores and q is the weight per unit length to simplify the derivation process many researchers chen et al 1990 miska et al 1996 liu 1999 assumed that the deformation curve was a sinusoidal curve and obtained the same results using energy methods gao et al 1998 obtained the same result by solving the buckling differential equation as the axial compression force continues to increase the sinusoidal mode becomes unstable and enters a more stable helical buckling mode various researchers have proposed different hypotheses and obtained a series of different results as shown in table 1 the relation between the axial compression force f c and the axial displacement δ l is shown in fig 3 gao and huang 2015 chen et al 1990 first deduced that the critical load of helical buckling is twice that of sinusoidal buckling using an energy method in which f c was assumed to remain unchanged during the transition from sinusoidal to helical buckling by assuming that f c varies linearly during this transition wu 1992 pointed out that the result of chen et al 1990 was only the median of the critical load of sinusoidal and helical buckling and the critical value of helical buckling was 2 2 1 times that of sinusoidal buckling miska et al 1996 assumed that f c varied linearly from non buckling to helical buckling and deduced that the critical load of the helical buckling was 2 2 times that of the sinusoidal buckling miska et al 1996 also demonstrated that when f c reached 1 875 times the critical sinusoidal buckling load the sinusoidal mode became unstable thus it was suggested that the sinusoidal or helical buckling may occur in the interval of 1 875 2 2 cunha 1995 pointed out that two critical loads of helical buckling exist the lower limit is the result presented by chen et al 1990 and the upper limit is the result presented by miska et al 1996 the upper limit corresponds to the minimum f c generated by the excitation of the helical buckling during loading and the lower limit corresponds to the maximum f c required to maintain helical buckling during unloading mitchell 1997 obtained similar results by solving the buckling differential equation gao 2006 summarized the previous research results based on experimental results he suggested that the linear change of the axial compression force in the buckling process ranging from non buckling to sinusoidal buckling and f c remained unchanged in the process of sinusoidal to helical buckling in addition the contact force between the string and the wellbore wall is always present whether it is in a sinusoidal or helical buckling state therefore another condition for the sinusoidal buckling instability is that the contact force at the bottom of the wellbore is zero and a necessary condition for the helical buckling is that the contact force between the string and the top wall of the wellbore is non negative based on these rules gao et al 1998 deduced the critical loads of sinusoidal and helical buckling and found that they were consistent mitchell 2002 used jacobi elliptic functions to solve the buckling differential equation and obtained a more accurate helical buckling solution furthermore he found another new buckling mode which moved substantially around the center line of the top of the well huang et al 2015a further proved that sinusoidal and helical buckling are only two special periodic solutions of the buckling differential equation gao and miska 2009 2010 demonstrated that when the dimensionless length q e i r c 0 25 of the pipe exceeded 5 π the effect of the boundary conditions on the buckling section was negligible liu et al 2018a 2018b studied the buckling behavior of a slender rod confined in a cylindrical tube and obtained the critical conditions from sinusoidal to helical buckling it was emphasized that the slender rod before deformation was placed in the center of the cylinder liu et al 2018a 2018b however wicks et al 2008 considered the case where part of the buckled string was not located at the bottom of the wellbore in this case the initial position of the horizontal pipe string had a great effect on the post buckling behavior at present the post buckling transition and the critical conditions of such strings in horizontal wellbores are still unclear because the transition is complex and nonlinear the sinusoidal mode surrounds the constrained wellbore bottom in an alternate manner while the helical mode forms a helical shape around the constrained wellbore in only one direction the critical loads of the two kinds of buckling configurations can be theoretically obtained by assuming that the axial forces remain constant or linear during the post buckling transition experimental studies can only obtain the relation between the compression load and axial deformation but post buckling mode measurements are absent thus the theoretical and experimental studies of the post buckling transition are quite different in this study the dynamic relaxation method was used to simulate the post buckling behavior to improve the shortcomings of theoretical and experimental research we placed horizontal strings before deformation at the bottom of a wellbore the beam and gap elements were combined to assess the contact relation between the strings and outer cylinders under the action of axial and self weight loads the equilibrium state of the post buckling configuration of horizontal pipe strings was studied and the transition of the post buckling mode was analyzed in addition we analyzed the effect factors of the dynamic relaxation algorithm 2 model and method 2 1 basic assumption 1 the horizontal string is linearly elastic and it was assumed that the deformation is small 2 the cross sections of the string and wellbore are assumed to be circular 3 the horizontal borehole is treated as a rigid cylinder 4 the string before deformation is located at the bottom of the horizontal borehole and maintains a straight line equilibrium state before buckling the main difference is that previous studies liu et al 2018a 2018b placed the horizontal rod at the center of the cylinder 5 the buckled string may contact any circumferential position of the rigid wall of the wellbore ignoring the friction effect 6 the static buckling of the horizontal string under a given axial compression force is studied and the transient effects of inertia and damping forces are neglected 2 2 buckling differential equation the ends of the horizontal string are subjected to axial compression forces f c and the weight per unit length is q the widely used buckling differential equation of strings constrained by boreholes is as follows mitchell 1988 2 d 4 θ d x 2 6 d θ d x 2 d 2 θ d x 2 d d x f c e i d θ d x q sin θ e i r c 0 where θ is the angular displacement and x is the coordinate along the cylinder axis 2 3 mechanical model based on the basic assumptions the buckling mechanics model of the horizontal strings constrained by cylinders is established as shown in fig 4 the force diagram is displayed in fig 4 a after sinusoidal or helical buckling of horizontal strings previous researchers generally used the continuous contact hypothesis to analytically solve eq 2 however the assumption of continuous contact is not necessarily correct after the buckling of horizontal strings some positions of the horizontal string are in contact with the cylinder fig 4 c and other positions may not be in contact with the cylinder fig 4 b using the euler bernoulli beam hypothesis and hermitian shape function approximation zienkiewicz et al 2000 the pipe strings are discretized into 3d beam elements each node contains three translational and rotational displacements the node displacement vector is 3 u u v w θ x θ y θ z t where u v w represent the translational displacements in the x y z directions respectively and θ x θ y θ z are the rotational displacement around the x y z axis respectively it is assumed that both ends of the strings are subjected to hinged constraints the boundary conditions in fig 4 a are as follows 4 v a w a u b v b w b θ b x 0 to prevent rigid body rotation the rotation in the x axis direction θ b x is restricted at the right end in fig 4 a 2 4 equilibrium equation of static buckling first the contact relation between horizontal strings and cylinders is described by gap elements liu et al 2002 after assembling the beam and gap elements the equilibrium equation for the static buckling analysis of the horizontal strings constrained by the cylinders is as follows 5 k 0 k σ k gap d f cq f n where k 0 and k σ are the elastic and geometric stiffness matrices of the beam elements respectively k gap is the contact stiffness matrix of the gap elements the axial compression force f c reduces the stress stiffness d is the node displacement vector of the beam elements f cq is the applied external load vector including the axial compression force f c and the weight per unit length q and f n is the vector of contact force between horizontal strings and cylinders in the gap element the criterion for the contact between the nodes of the horizontal strings and the cylinders is 6 f n 0 k gap r r c r r c 0 r r c 0 where k gap is the contact stiffness which requires iterative computations r is the radial displacement of the horizontal string r c d i d o 2 and d i and d o are the inner diameters of the cylinders and the outer diameters of the strings respectively in the o y z coordinate system assuming that the lateral displacement vector produced by the horizontal string at any position is u the relation between the lateral displacement vector and the radial displacement vector r is as follows 7 r u r c where the direction of the lateral displacement vector u is from the origin of the coordinates to the center of the cross section of the deformed string where the corresponding value is u v 2 w 2 r c is the initial annular gap vector and its direction is from the origin of the coordinates to the center of the cross section of the cylinder the direction of the radial displacement vector r is from the center of the cross section of the cylinder to the center of the cross section of the deformed string and the corresponding values can be obtained by vector operations according to eq 7 the radial displacement value r can be obtained and the normal strain of the gap element can be calculated as follows 8 ε gap r r c based on the strain ε gap in eq 8 and the contact force f n in eq 6 the definite formula for the iterative calculation for the gap element can be written as follows 1 for the free state fig 4 b 9 ε gap 1 0 ε min f n k f min 0 0 k gap k 0 2 for the elastic contact state fig 4 c 10 ε min ε gap 1 0 ε max f n k f min 0 0 k gap k 0 where ε min ε max and f min are small quantities larger than zero to control the convergence accuracy of the gap element iteration ε min and ε max are the minimum and maximum iteration errors for the gap element strain respectively f min is the iterative error of contact force of gap element f n k and k gap k are the contact force and contact stiffness for iteration k respectively to make the contact between the strings and the inner wall of the cylinders satisfy the definite solution of the gap element the contact stiffness k gap k of the gap element should be changed continuously in the iterative calculation the following principles should be adopted in the correction 1 the initial contact stiffness k gap 0 and the initial penetration r pe 0 are given for correction in the iteration 11 k gap 0 f k 12 e i l 3 r pe 0 f pe d o 2 where f k is the coefficient of contact stiffness l is the length of the beam element and f pe is the penetration coefficient 2 in the free state the contact stiffness k gap k is zero 3 for elastic contact the contact stiffness k gap k is related to the bending stiffness and element length the initial contact stiffness k gap 0 is used for the iterative calculation 4 the contact between the strings and the cylinder wall is multi directional the contact stiffness of the gap elements between the adjacent beam elements is mutually affected among the gap elements thus this effect should be considered when correcting the contact stiffness of the gap elements each gap element should be corrected repeatedly until all the gap elements satisfy eq 9 and eq 10 2 5 dynamic relaxation method as mentioned in the introduction the increase in the axial compression force on the horizontal string will lead to instability and sinusoidal or helical buckling may occur during the transition from sinusoidal to helical buckling some researchers suggested that the axial force remains unchanged but others suggested that the axial force is linear for the nonlinear iterative calculations of static buckling using eq 5 we used the dynamic relaxation method rezaiee pajand and estiri 2016 zhang et al 2019a to transfer the static system to the virtual dynamic space by applying an artificial damping force to attenuate the dynamic response of the horizontal string the slow dynamic solution is obtained in the implementation of the dynamic relaxation method the external loads f c and q are converted into the following time varying quantities 12 f c t f c sin π t t 0 t t 4 f c t t 4 13 q t q sin π t t 0 t t 4 q t t 4 where t is the characteristic period and t is the response time to easily form lateral deformation after buckling the following initial disturbance force f r is applied on the horizontal string 14 f r t f r sin 2 π t t 0 t t 2 0 t t 2 since the disturbance force eventually cancels and its application does not affect the critical buckling load the static loading is transformed into dynamic loading by eq 12 eq 13 and eq 14 the mechanical model of the dynamic loading and the time history of the external loading are presented in fig 5 the dynamic relaxation method is used to solve eq 5 and the following dynamic equations are obtained 15 m d c d kd f a t where m c and k are the global mass matrix the damping matrix and the stiffness matrix of the horizontal string respectively the stiffness matrix k k 0 k σ k gap d and d are the vectors of the node velocity and acceleration of the horizontal string respectively f a t is the applied load vector including f c t q t f r t and f n t the time history of the first three loads is shown in fig 5 and f n t is iteratively solved using the gap element rayleigh damping is used to set the α damping to a large value which attenuates the dynamic response of the system the artificial damping force c d is as follows su et al 2019 16 c d α m d and the reference α damping is 17 α 0 2 ζ ω where ζ is damping ratio we set ζ 1 α 0 is the reference α damping and ω is the reference natural frequency of the horizontal string expressed as follows 18 ω π 2 l 2 e i ρ a where l ρ and a are the length density and the cross sectional area of the horizontal string respectively in the non linear dynamic eq 15 the internal load is no longer proportional to the node displacement and the stiffness matrix of the horizontal string depends on the current displacement therefore instead of eq 15 the newmark implicit integration scheme is applied to the nonlinear semi discrete equation 19 m d t c d t f i t f a t where f i is the internal load vector and f i k 0 k σ k gap d t denoting the time increment as δ t when t δ t eq 19 can be rewritten as follows 20 m d t δ t c d t δ t f t δ t i d t δ t f t δ t a f t δ t i d t δ t is dependent on the current displacement d t δ t at time t δ t in addition to eq 20 the following formulas are used to update the displacement d t δ t and velocity d t δ t 21 d t δ t d t 1 δ n d t δ n d t δ t δ t 22 d t δ t d t d t δ t 1 2 β n d t β n d t δ t δ t 2 where β n and δ n are newmark integral parameters the amplitude attenuation coefficient γ n is introduced to control the amount of numerical damping the following relation is satisfied 23 δ n 1 2 γ β n 1 4 1 γ n 2 γ n 0 the newmark scheme is unconditionally stable hughes 2012 in this paper we set γ n 0 005 by using the newton raphson method bathe 2017 eqs 19 21 can be solved simultaneously when the response time t t 2 the disturbing forces f r are equal to zero and the axial compression force f c and self weight q remain unchanged eq 19 can be rewritten as follows 24 f r t m d c d f a t f i t where f r t is the residual force vector with a further increase in the response time the transient response of the horizontal strings tended to be static and the deformation d gradually became constant the velocity d and acceleration d of each node tended to 0 and the residual force f r also tended to 0 using eq 5 f a f i thus we obtain the equilibrium state of the nonlinear static buckling of horizontal strings the dynamic relaxation method was used to calculate the static equilibrium under a given axial compression force f c as for the occurrence of post buckling modes such as sinusoidal or helical shapes it is necessary to assess the deformation shape of the horizontal string based on the calculated results 3 result and discussion the calculation parameters have been described previously suryanarayana and mccann 1995 wang and yuan 2012 the length and diameter of the horizontal string were l 3 683 m and d o 6 35 mm respectively the inner diameter of the cylinder was d i 38 1 mm and the radial gap between the horizontal string and the external cylinder was r c 15 875 mm the elastic modulus density and self weight of the horizontal string were e 75 13 gpa ρ 7800 kg m3 and q 0 86828 n m respectively the characteristic period t was 10 s and total response time t end was 30 s 3 1 verification of calculation results the results of the numerical simulation from this study and the experimental loading and unloading in the literature mccann and suryanarayana 1994 are shown in fig 6 the critical loads of the sinusoidal and helical buckling are summarized in table 2 in fig 6 and table 2 we introduced the dimensionless length γ l axial compression displacement γ u and load β as follows 25 γ l l q e i r c 0 25 γ u u q e i r c 0 25 β f c 2 r c e i q 0 5 in fig 6 the trend of the axial compression force vs axial deformation is similar to previous experimental results suryanarayana and mccann 1995 the calculated results of the axial force in this paper are lower than the experimental loading and higher than the experimental unloading thus the load vs deformation curve is between that of the loading and unloading of the experimental test this occurred because the equilibrium state of the static buckling calculated in this paper did not consider the effect of friction the compression load from the sinusoidal to helical deformation was assumed to be linear in the experimental tests suryanarayana and mccann 1995 and the critical loads were determined in this paper the critical loads of the sinusoidal and helical buckling were f sin 36 27 n and f hel 87 23 n critical loads are identified in section 3 3 respectively the corresponding strains were ε sin 0 0154 10 3 and ε hel 1 21803 10 3 respectively it is difficult to observe the helical deformation of the post buckling transition in experimental tests this transition deformation obtained by the numerical simulation in this paper is also discussed in section 3 3 and the critical load will be identified according to the post buckling mode the axial force versus deformation relation in fig 6 is considerably different from that in fig 3 the results in this paper show that the axial force was neither constant nor linear during the post buckling transition region the axial force during the transition was always non linear in the front part of this transition region the axial load changed slowly with the increasing compression deformation however in the vicinity region of helical buckling and thereafter the axial load increased sharply as shown in table 2 the dimensionless length of the horizontal string was γ l 2 037 π and the dimensionless critical load of sinusoidal buckling was β sin 1 00 which is in good agreement with previous research dawson 1984 huang et al 2015 wang and yuan 2012 the dimensionless critical load of the helical buckling was β hel 2 41 which is in good agreement with wang and yuan 2012 with an error of approximately 2 the largest difference with other theoretical results chen et al 1990 huang et al 2015 huang and pattillo 2000 is mainly due to the errors caused by the continuous contact assumption adopted in the theoretical analysis the calculated results in this paper are quite different from those of previous reports chen et al 1990 wu and juvkam wold 1995 miska et al 1996 cunha 1995 mitchell 1988 gao et al 1998 huang et al 2015a as shown in table 1 the significant difference is that the critical loads of the sinusoidal buckling in table 1 have a large range and beyond this range helical buckling occurs however the conclusion in this paper is that the critical load of helical buckling is 2 41 times that of sinusoidal buckling and the load of the post buckling transition from sinusoidal to helical buckling gradually changes nonlinearly fig 6 b 3 2 effect factors of algorithm 3 2 1 effect of alpha damping in dynamic relaxation various axial compression forces were selected for calculation fig 7 shows the effect of two alpha damping on the lateral displacement when f c 87 23 n fig 8 displays the effect of alpha damping on the lateral displacement velocity and acceleration of the horizontal string in fig 7 a the same alpha damping value α 10 α 0 was set in the response time 0 t 30 s the lateral displacement of the axially compressed load e g f c 36 26 and 36 27 n was not constant within 30 s under such a damping conditions this shows that the alpha damping was too large and the attenuation of the lateral displacement was too slow however when f c 36 30 n the lateral displacement was finally constant in fig 7 b when t 5s a larger alpha damping α 10 α 0 was set and when t 5s a smaller alpha damping α 1 0 α 0 was adopted which accelerated the response of the deformation of the string with time after the disturbance force was unloaded the lateral displacement tended to be constant within 30 s when f c 36 26 n the lateral displacement decreased to 0 indicating that the horizontal string had not yet buckled when f c 36 27 n the lateral displacement decreased to a constant value indicating that the horizontal string had just buckled fig 7 indicates that when the axial compression force was slightly larger than the critical load f c 36 27 n the alpha damping had no effect on the final lateral displacement for a given load therefore the stability of the post buckling deflection was obtained by setting an appropriate alpha damping in the dynamic relaxation method fig 8 illustrates that it took less time to reach stability for the helical buckling deformation when the α damping was small for example the response times needed to keep the lateral displacement unchanged were 3 25 6 25 and 18 25 s for α 50 α 0 100 α 0 and 300 α 0 respectively the corresponding response times needed to decrease the lateral velocity to zero were 5 50 7 25 and 20 25 s respectively and the response times for the lateral acceleration to reach zero were 17 75 21 00 and 25 75 s respectively when the alpha damping was large e g α 800 α 0 the lateral displacement increased continuously for a response time t end 30 s and the time invariant deformation could not be obtained however when the alpha damping was small a larger lateral velocity and acceleration occurred in the application stage of the perturbation and axial compression forces if the alpha damping was further reduced the calculation did not converge therefore based on the calculation of post buckling using the dynamic relaxation method in order to calculate the convergence the damping value must be appropriately increased to obtain results faster and more stably the damping could be appropriately reduced 3 2 2 effect of beam element length in finite element simulations the element length is critical to the accuracy of the calculations therefore we calculated the effect of the beam element length on the horizontal string deflection curve as displayed in fig 9 fig 9 shows that when the element length was less than or equal to 0 05 m the deflection curves coincided by contrast when the element length was more than 0 05 m the rotation angle near the end of the horizontal string varied greatly and the lateral displacement did not coincide to obtain higher accuracy an element length of 0 02 m was selected for this study 3 2 3 effect of contact stiffness of gap element the contact stiffness affects the contact force value and distribution given the axial compression force and damping before satisfying the contact non linear iteration between the horizontal string and the cylinder we use eq 11 to select the appropriate initial contact stiffness and analyze its effect on the contact force as shown in fig 10 when the contact stiffness was small f k 0 01 a continuous contact section is present near x l 0 2 fig 10 a however when the contact stiffness increased e g f k 0 05 the continuous contact section was converted into a point contact fig 10 b regardless of the contact stiffness selected the continuous contact section was always present in the middle of the string for a contact stiffness 0 05 f k 0 5 the contact force of the point contact increased continuously fig 10 b the contact force near the ends of the continuous contact section also varied greatly fig 10 c for f k 0 5 the contact forces of the point contact and the continuous contact section do not change with the contact stiffness fig 10 b and c in the calculations in this paper the coefficient of contact stiffness of the gap element was taken as f k 0 5 3 3 post buckling deformation analysis the deformation curves during the post buckling transition were calculated under various axial compressive loads as presented in fig 11 when the axial compression force was f c 36 26 n the horizontal string was at the bottom of the inner wall of the cylinder both the lateral displacement u and angular displacement φ were zero when f c 36 27 n the lateral deflection of the horizontal string was at the 0 25 l fig 7 b and 0 75 l positions but u and φ were smaller fig 11 under this force the horizontal string exhibited a sinusoidal deformation thus f c 36 27 n is the critical load of sinusoidal buckling with an increase in the axial compression force the lateral displacement u and the angular displacement φ increased gradually the lateral deformation in the sinusoidal wave moved upward along the cylinder wall on both sides of the circumferential direction when f c increased to a certain value e g f c 46 04 n in fig 11 the deformation appeared to be separated from the cylinder wall at a position away from the ends of both sides however as f c was further increased the second non contact section appeared on both sides near the end e g f c 55 49 n in fig 11 and one contact point existed between the two non contact sections which is called the point of contact c2 during the entire transition of post buckling the deformation of the horizontal string in the middle e g the position between the contact points c1 in fig 11 b was still in the continuous contact state the non contact section appeared in the post buckling deformation which is inconsistent with the continuous contact assumption in reported in previous studies chen et al 1990 wu 1992 miska et al 1996 gao et al 1998 as shown in fig 11 the buckling deformation was consistently two half sine waves in the oxy plane view however when f c 70 44 n the buckling deformation changed from one to two sine like waves in the oxz plane view and the angular displacement of the non contact section near the end of the horizontal string was positioned exactly on the y axis when f c 70 44 n the direction of angular displacement changes e g the buckling deformations corresponding to f c 71 47 and 87 23 n in fig 11 when the deformation was in contact with the top of the cylinder the axial compression force was defined as the helical buckling load for f c 87 23 n the angular displacement φ of the top contact point c2 in fig 11 b was 90 that is the deformation of the horizontal string was in contact with the top of the cylinder this force f c 87 23 n was identified as the critical load of helical buckling 3 4 further discussion in this study the numerical simulation was mainly based on existing theoretical and experimental test results we further analyzed the critical load of the sinusoidal to helical buckling process and presented the post buckling mode during the transition which is difficult to accurately measure experimentally in the numerical simulations the conclusion was inconsistent with the theoretical hypothesis i e that continuous contact in the post buckling transition is not applicable and that our calculated post buckling mode of discontinuous contact is difficult to observe experimentally the calculated relation between the load and deformation is generally consistent with the experimental results which is different from the theoretical assumption chen et al 1990 wu 1992 miska et al 1996 gao et al 1998 that the axial force remains unchanged chen et al 1990 or changes linearly wu 1992 miska et al 1996 gao et al 1998 in the post buckling process all the studies discussed here in were performed without considering the friction between the string and the wellbore although this is an ideal case it can provide valuable insight into the post buckling behavior of horizontal strings constrained by wellbores when the friction is relatively small it will not change the sinusoidal and helical shapes nor will it affect the transition between sinusoidal and helical buckling friction will delay the transition from a sinusoidal shape to a helical shape however when the friction force is large it can prevent the transition from a sinusoidal to a helical shape and the string can become locked in the helical shape without any axial extension which is undesirable in the horizontal drilling or completion process lastly there is fluid action in the oil and gas pipe string and the string has torsional deformation the post buckling transition behavior of the flow induced pipe string such as the critical fluid velocity and inside and outside pressure will be subjects of future research 4 conclusion 1 comparing the numerical results with experimental and theoretical results the accuracy of the post buckling finite element simulation of horizontal strings constrained by cylinders was verified the critical load of sinusoidal buckling is completely consistent with the literature while the error between the critical load of helical buckling and wang and yuan 2012 is approximately 2 2 we discussed the effect factors of the dynamic relaxation method including the damping element length and contact stiffness among these factors the damping affects the response time and can effectively solve the convergence problem but does not affect the calculation accuracy the element length affects the buckling deformation to ensure the accuracy of the calculation the coefficient of contact stiffness should be greater than or equal to 0 5 3 the horizontal string initially located at the cylinder bottom did not always stay in contact with the cylindrical wall during the transition from sinusoidal to helical buckling the non contact section appeared near the end of the horizontal string after sinusoidal buckling this observation is different from the continuous contact hypothesis used in theoretical analysis 4 the axial compression force during the post buckling transition gradually increased nonlinearly the dimensionless critical loads of the sinusoidal and helical buckling are recognized according to the post buckling mode author contribution statement qiang zhang conceptualization methodology software jiancheng wang data curation writing original draft preparation wei cui visualization investigation zhongmin xiao result validation supervision reviewing and editing qianbei yue software design and validation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the authors gratefully acknowledge the support of singapore a star serc ame programmatic fund for the structural metal alloys programme project wbs m4070307 051 this research is also supported by national natural science foundation of china 51904075 51774093 51674088 and china postdoctoral science foundation 2019m661248 2018m641804 
22141,a novel scheme is proposed for the distributed multi ship collision avoidance ca problem with consideration of the autonomous dynamic nature of the real circumstance all the ships in the envisioned scenario cannot share their decisions or motivation and they make decisions based on the limited observable information each ship is assumed to have a high layer intention to guide the ca decision which is called the collision avoidance logic cal each ship has its own cal that governs the ca decisions and actions meanwhile each ship tries to understand the cals of other ships by continuous inference and observation according to their extrinsic behaviours especially the difference between the observed information and the predicted behaviour this iterative scheme features a four phase programmed decision making procedure namely the observation inference prediction decision oipd model simulation results indicate that the oipd method shows good flexibility and adaptability when all ships comply colregs the proposed scheme can produce normal solutions in case some of the ships fail to make correct decisions the other ships that adopt the proposed scheme can response in time and revise their ca strategies in a proactive way data envelopment analysis method is applied to further quantitatively evaluate the efficiency of the proposed scheme keywords maritime accident multi ship collision avoidance inference programmed decision making anti collision intention 1 introduction ship collisions always constitute a significant proportion of all the ship accidents in terms of their occurrence frequency as well as the catastrophic losses they cause according to statistics the serious ship collision accidents worldwide during 2007 2016 mount to 72 cases making the fourth causal factor of all the maritime accidents allianz global corporate and specialty 2017 for instance in the east mediterranean and black sea region ship collision resulted in 348 casualties in 2015 alone allianz global corporate and specialty 2019 therefore how to prevent ship collision has been attracting sustained attention from the researchers and practitioners in the literature for long meanwhile it is generally recognized that human error contributes to more than 80 of ship collision accidents soares and teixeira 2001 wang et al 2019 wu et al 2017 the major challenges to the collision avoidance ca in the close quarters situation can be categorized into two types namely the manoeuvrability related and the decision related the former refers to the aspects that govern the motions of the vessel and the physical or mechanical impact on the vessel including the ship dynamics external forces such as wind and current etc while the latter involves the strategies and principles of collision settlement in terms of course and speed that are designed and implemented during the whole process of ca manoeuvring in an on going manner when the two types of effects are interwoven the risk of collision can spiral upwards as the vessels are approaching two additional factors should be observed regarding to the ship collision problem firstly the margin of decision and manoeuvring for ca will be narrowed exponentially with the approaching of the vessels which are treated as collision candidates this will account for the growing difficulty and pressure of collision settlement with time passing by in the pre collision phase secondly in multi vessel encounter situation the complexity of ca will increase significantly as the number of collision candidates grows it bears mentioning that in some special waters such as busy gulf and narrow sea passages risk of vessel collision due to multi vessel encounter can never be neglected stakeholders of shipping have long been making efforts to prevent and reduce ship collisions and both technical measures and regulatory actions are promoted and employed in the maritime industry wan et al 2019 some of these anti collision provisions are advocated by inter governmental cooperative bodies like international maritime organization imo from the technical perspective navigation aid technologies are widely utilized in the form of shipborne equipment and onshore infrastructure including ais vts and arpa some of the technical facilities are required by imo as compulsory equipment on board from the piloting crews perspective the technical means track the movement of the neighbouring ships and present some quantitative parameters that characterize the encounter situation such as time to closest point of approach tcpa and distance to cpa dcpa on the policy side imo issued the well known international regulations for preventing collisions at sea colregs in 1972 with some amendments released afterwards the ships engaged on international voyages are all supposed to abide by the convention colregs outline the concepts and principles in dealing with potential collision situation however they only provide with qualitative guidelines for ca li and zhixiong 2014 whereas the actual decision and manoeuvring are conducted by the piloting crews in a subjective manner in spite of the technical facility and the standardized anti collision rules there are still factors that cast a shadow over the collision prevention firstly the state of art shipping technology still relies heavily on human operation and decision making in the case of potential collision situation although the automatic piloting can take effects in open water voyage clear of other ships for a ship involved in a collision settlement scenario observational information of its peripheral ship s may come from the officer on watch oow manually or from the arpa ais devices with dcpa tcpa as the aid for decision making wu et al 2019 zhang et al 2019 nevertheless the critical decision made by the piloting crew remains highly subjective usually largely depending on the crew s professional experience cognitive abilities and sophistication in judgment secondly colregs do not cover the scenario of multi ship encounter if one tries to use colregs in pairwise for collision settlement in a multi ship case it is easy to find contradictions in choosing the ca strategy of the ships i e colregs usually cannot be satisfied in pair wise manner in such cases intuition will take over rule based decision making which may lead to potential conflicts among the envisioned settlements thirdly in the multi ship scenario the decisions are made simultaneously and autonomously by the crew in each ship yet no centralized coordination mechanism actually functions in the process all the ca decisions and manoeuvre are made based on the anti collision strategy of the crew on board which is the hidden intention only known by the piloting crew the anti collision strategy of individual ships lack congruity essentially and this can account for some game like behaviour in the anti collision decision and manoeuvring each ship is subjectively seeking the best path with the least likelihood of collision and the least deviation from its original course the game like behaviour makes ca process similar to a two layer structure consisting with the hidden ca intention at the upper and the observable predictable ca manoeuvre at the bottom this paper concerns the autonomous decision manoeuvring support in the multi ship ca scenario where no guideline for settlement is specified in the current colregs the other consideration is that no global coordinating role is ruling the behaviour of the ships each ship is regarded as a rational agent in dealing with the scenario with the loop of observation inference prediction and decision being modelled as the frame of dynamic anti collision action iteration in this paper the problem is addressed that each involved ship has a high layer and hidden ca intention to move across the region of the multi ship encounter situation which is termed as the collision avoidance logic cal to make an effective ca decision four things should be done for each individual ship firstly observe the latest status of the other involved ships secondly update the inference of the other ships cal according to the new information then predict the movements of the other ships according to the latest inferred cal finally make its own ca decision according to other ships predicted decision all these procedures form a spiral evolution process until own ship pass the encounter region successfully simulation results indicate that the oipd method shows good flexibility and adaptability when all ships comply colregs in simulation the proposed scheme can produce normal solutions in case some of the ships fail to make correct decisions or take actions the other ships that adopt the proposed scheme can response in time and revise their ca strategies in a proactive way data envelopment analysis method is applied to further quantitatively evaluate the efficiency of the ca performance of the proposed scheme the remainder of the paper is organized as follows in section 2 a brief review of the previous of the research is given to illustrate the state of the research the motivation and sketch of this paper is also proposed in section 2 section 3 delineates the basic concept of the method and general framework of the decision making procedure in section 4 detailed real time ca decision making support algorithm is designed at last simulations based on the proposed decision making formulation are carried out by considering several multi ship encounter scenarios in section 5 in order to verify the flexibility of the algorithm different scenarios are considered in simulations including the ships failed of compliance with colregs data envelopment analysis dea method is also applied to further quantitatively evaluate the efficiency of the proposed method some conclusions are discussed in section 6 2 literature review and motivation of research 2 1 the related work as ship ca problem has attracted continuous interest from researchers and practitioners alike a lot of efforts have been made to bring insight into the problem in prior study and several tracks of methods have been formed in treating the issue these methods can be categorized into four classes and are briefly summarized as below the first line of study relates to the geometrical characteristics of the traffic situation among vessels ship domain reflects the most straightforward tactics to deal with ship collision problem the concept was formally proposed by m goodwin 1975 in 1970s which assumes that each ship should keep its own surrounding space in the water that remains clear of other objects ship domain satiates the basic intuitive demands that the minimum distance between ships must be kept and was widely adopted in the literature early stage study on ship domain focused mainly on its size and shape under constant conditions since the collision threat to a ship is usually non uniformly posed on the spatial margin around the ship and is subject to various factors such as ship motion kang et al 2015 ship traffic distribution etc it is reasonable that ship domain is expected to undergo dynamic changes as ship speed and other navigational data vary pietrzykowski and uriasz 2009 defined a variable ship domain with different layers of safe growth and crew s consciousness driven by the big data paradigm recent research attempts to use the ships historical data like the ais data hansen et al 2013 in a specific sea area to extract the sketch of ship domain arena is an analogous concept in the ship collision study and can be essentially regarded as an extended area of ship domain which is a sign of action taking alert once infringed among the geometric parameters of an encounter scenario cpa dcpa tcpa are the most widely used indicators for the situation zhang et al 2017 another collection of research work investigates the ca problem with focus on the uncertainties involved in the motion and behaviour of the vessels usually this sort of work aims at analysing and minimizing the likelihood of collision between the ships and the idea behind is fuelled by the probabilistic risk assessment pra method or statistic based data analysis to this end intentional analysis and data driven methods are both employed by intentional analysis researchers tend to model the mechanism of vessel collision with an analytical approach and the ca problem is investigated in an inside out perspective typical research work includes geometrical probability of collision estimation montewka et al 2010 the minimum distance to collision mode and causation factor montewka et al 2012 and the collision energy and structural capacity analysis goerlandt et al 2012 by data driven methods ship movement and behaviour in the collision or near collision context are extracted from historical vessel traffic data in recent study traffic simulation is generated to evaluate the collision situation goerlandt and montewka 2015 which sheds light on the ca strategy for individual ships these two methods are usually combined to make the analysis more accurate and effective goerlandt and kujala 2014 discussed the application and validity of quantitative risk analysis qra for the proposed ship ship encounter detection mechanisms recent research on the risk and uncertainties in the vessel collision context aims to build a generic framework for collision risk assessment goerlandt and montewka 2015 montewka et al 2014 this work will help the participants including the piloting crew and the shore side administrators make better decisions in a risk informed manner the next strand of study involves path planning among vessels with consideration of the collision risk the formulation of path planning in ca is to find optimal routes for the ships to cross the unsafe water with the least domain infringements apart from the primary constraints of averting the dynamic or static objects there are usually additional objectives in designing effective routes for each ship such as making the navigation distance shorter and returning to the originally intended route faster the concept of velocity obstacle vo can be regarded as the extension and development of dcpa and tcpa it proposes a method that transforms dynamic obstacles into static obstacles thereby reducing the difficulty of ca decisions fiorini and shiller 1998 geng et al 2019 proposed several optimal motion planning algorithms based on the idea of vo for maritime autonomous surface ships mass and verified the efficiency of the algorithms with simulation due to its capability to intuitively display collision risks chen et al 2018a b proposed a ship collision candidate detection method based on time discrete non linear vo the method can be adapted to the characteristics of the ais signal in practice and detect the collision candidate efficiently the path planning in calm water is somewhat similar to the traditional path planning problem developed in the walking robot yet the navigational environment will entail more factors to be considered the artificial potential field apf method is a classical method for robot path planning and it is intuitively believed that the general principle in apf can also be employed in the ship ca problem liu and bucknall 2015 developed a fast marching fm method for unmanned surface vehicle path planning in a dynamic environment the fm method is enhanced from two layered song et al 2015 to multi layered song et al 2017 to adapt to different requirements and environmental conditions the fourth type of research work utilizes multi agent based decision making to deal with the ca problem each ship in an encounter situation can be regarded as an agent with the ability to make ca decisions algorithms in soft computing are employed to provide solutions for the problem typical algorithms include genetic algorithm ant colony algorithm particle swarm optimization algorithm etc liu et al 2017 proposed a hybrid optimization ca algorithm based on the particle swarm optimization and bacterial foraging algorithm the simulation therein includes course alter angle and time parameters and the results show that the algorithm is effective and feasible nevertheless the study is limited to ca between two ships and does not consider the colregs zhang et al 2015 presented a distributed multi ship ca decision support formulation under colregs in which all the involved ships in this algorithm can make decision individually and obey the basic principles of colregs in their work the decision of one ship can be understood by all the other ships in time szlapczynski and szlapczynska 2012 presented a multi ship trajectory planning method by using evolutionary algorithms and several assumptions of game theory were used to set the limitations of path planning however it is as well a centralized algorithm and does not consider uncertainties of the decision of target ships thus there is a strong requirement that the multi agent based decision making scheme for multi ship ca can be fully studied by taking account of the uncertainties therein besides this traditional types of ca research new research trends that combine ship ca research with machine learning are also worth noting luman et al 2019 proposed a path following and ca system for the autonomous ships based on the deep reinforcement learning drl algorithm a line of sight los guidance system and a proximal policy optimization ppo algorithm were applied for drl to learn a safest and most economical trajectory and guide the ship to follow the trajectory based on this zhao and roh 2019 developed a multi ship ca method by using the deep neural network dnn the dnn is trained over multiple ship encounter situations by directly mapping the states of involved ships to the ca steering commands the ca decisions are made based on the rules and regulations of colregs only by rudder angle changes chen et al 2019 proposed a knowledge free path planning method based on reinforcement learning by setting obstacles prohibited areas and navigable areas as punishments or rewards the algorithm can learn a convincing path and manipulating strategies without any knowledge and manual intervention q learning can also be used to form an approximated optimal ca decision of mpc xie et al 2019 2 2 limitations of the prior work despite the plenty of research work devoted to the ca problem the limitation of the prior work is discernible the first weakness is the idealized assumption that the vessels can follow a common scheme to resolve the close quarter situation even in the two vessel case where the ca strategies of both sides are prescribed by colregs it is difficult in reality that the specific conflict resolution algorithm or the intentions are advertised to each other it is therefore envisioned that in the multi vessel case the situation can only be more complex since colregs will not apply in such scenarios hence it is not practically feasible to translate the ca problem in the multi ship scenario into a global optimization problem with static setups for instance by using the traditional apf method given the initial encounter situation the recommended routes will be calculated for each ship however this method ignores the autonomous and dynamic behaviour of the individual ships there is another limitation which relates to the over optimistic presumption that all the environment and information are perceived by each ship with perfect congruity in other words there is a god s perspective that could let each ship know everything about the encounter situation nevertheless in the real circumstances each ship has to observe and sense the situation from its own angle in fact the capability of sensing and detection is subject to the navigational equipment on the individual ships and this will give raise to information asymmetry among the vessels which is beyond the consideration of prior work finally the ca operation is a continuous procedure over time in which each vessel takes actions under two impacts first the own ship os will try to reach the waypoints according to its judgment of the situation secondly it will respond to the behaviours of other ships to prevent collision especially when these behaviours are not expected by the own ship the two impacts are usually co functioning in an entangled manner causing the highly dynamic interaction among the vessels and a closed loop of manoeuvring and responding this suggests that the ca problem in the multi vessel case is an iterative and cooperative decision making process instead of a one deal solution unfortunately this kind of modelling is extremely rare in the prior work 2 3 sketch of the current work in this paper a novel scheme is proposed to provide with a solution for the multi ship ca problem with consideration of the autonomous and dynamical nature of the real circumstance the study is targeted to the ca scenarios in busy waters like bays harbours and gulfs in these restricted areas the density of vessel traffic is higher than that of open waters and thus will cause higher collision risk for the multi ship encounter situation in the complex encounter situation with restricted communication and distributed decision supporting formulation every involved ship makes decisions individually based on the inference of target ships cal there is not a coordination centre to design suggest ca strategies for all ships or exchange the mutual information about the ships ca decision the only information that available to each ship is all the involved ships observable statues such as position speed and course angle as the involved ships cannot share their decision or decision making basis every ship makes decisions based on the limited observable information therefore the iterative decision making procedure including observation inference and prediction for the individual ships is the focus of this paper in the procedure each ship infers the cals of target ships tss based on the observable information and makes an initial decision according to the inferred attitudes to estimate the credibility of the inference and adjust it iteratively a dempster shafer theory dst based method is employed to fuse the discernment in temporal and spatial to evaluate the cal inferences so that an overall reliability between the prediction and real status of the target ships can be quantitatively assessed afterwards the own ship os s decisions are made based on the belief of the inferred tss cals in the current encounter situations and are implemented by adjusting the speed and course angle in the os s decision making procedure a linear extension algorithm for speed course angle alteration are applied to make os s decision it is worth noting that the initial ca decision is mainly based on colregs nevertheless the procedure is more flexible in the subsequent decision making process 3 methodology 3 1 overview of the observation inference prediction decision oipd model in this paper the highly coupled relationship between the ships involved in ca scenario is characterized by a two layer logical decision making structure and an iterative process over time the two layer structure is further decomposed into the proposed oipd model fig 1 presents a schematic diagram of the oipd model for a given ship when each of the involved ships follows the ca scheme independently in a distributed manner the autonomous behaviours of the vessels can be reflected featuring the multi agent dynamics of the vessels each ship will first update the status information of all ships based on observation at the beginning of the current decision cycle afterwards the current state information is compared with the predicted value of the previous decision cycle based on dst the deviation between the prediction information and the actual situation is calculated by fusing the discernment in temporal spatial and combined spatial temporal way with this quantitative approach the inference of ts s cal derived in the previous decision cycle can be confirmed or further corrected based on the inferred cal the ship makes the corresponding cal of current decision cycle subsequently the ship makes ca decision and the prediction about the target ship in accordance with the same logic simultaneously 3 2 the collision avoidance logic and the formulation of ca intention the cal of a ship is its macro strategic to pass through the collision prone situation as mentioned previous the colregs are the basic regulations that both ships should comply with in a typical two ship ca scenarios there are three types of encounter situations addressed by colregs namely crossing head on and overtaking tam and bucknall 2013 and the own ship can be regarded as either a give way ship or a stand on ship when it is involved in a two ship encounter scenario prior research has shown that the instant stand on give way relationship sgr of two encountering ships is categorized by the positions and headings of the two ships at the closest point of approach wang et al 2013 where the cpa calculation is based on the assumption that the two ships keep the constant speed and course notice that the give way stand on relation are not always applicable to the ships there as there can be cases in which the two ships have no potential conflict route apparently the give way or stand on role originates in the instant encountering scenario of the two ships however in what follows the sgr is also used for the actual routes of two ships besides for instant intentions if no confusion is caused obviously the sgr of actual routes is determined by the cross actions of the involved vessels more discussion on this issue will be conducted afterwards in the multi ship encountering scenario the sgr between two ships can be applied in pairwise manner thus a mutual relation matrix can be formulated to represent the pairwise relationship between two ships the first subfigure of fig 2 demonstrates the initial encounter situation of four ships which is the status of the ships at t t 0 each ship is moving to its interim destination labelled with the same colour by repetitive simulations some ca schemes are selected by which the four ships manage to pass through the multiple encounter situation and reach their interim destinations without causing tense situation fig 2 demonstrates these selected schemes that follow the same strategy which consists of 9 successive snapshots of the encountering situations the points in the clouds stand for the sample positions of the ships in the series of simulations from the snapshots the pairwise ca strategy can be summarized as table 1 for each cell in the table the stand on give way role is from the perspective of the ships at the leftmost column besides the diagonal cells in the table the sgr might not apply to some cells in the table in such cases the encountering situation is usually ambiguous or it is unnecessary to identify the sgr for the pair of ships as like s3 and s4 in the example it can be seen that the cells in table 1 demonstrate somewhat antisymmetric feature i e if one cell is stand on the diagonally symmetric cell must be give way and vice versa it is worth noting that the sgr in fig 2 is in the sense of actual route as has been aforementioned the actual route is formed by sustained and continued actions of the ships and the sgr of two routes is in fact an ex post term unlike the sgr of two routes the instant sgr of two ships may change over time this is due to the fluidity in decisions made and actions taken by the ships intuitively global change of ca strategy among the involved ships could possibly occur during the whole process of collision resolution which cannot be conveyed by the sgrs of the pair wise routes alone nevertheless the actual routes in principle embody the overall and prevailing ca intentions of the ships since the instant sgr between two ships is able to characterize the real time decision made by the involved ships the strategic intentions of each ship can be as well presented by mutual sgr matrix which can be straightforwardly obtained from the pairwise sgr table 3 3 principles of decision making and manoeuvring in the ca context as has been discussed the observable and predictable information is highly quantitative moreover the extrinsic behaviour of the vessel can be denoted by the geometric and kinetic parameters these parameters are equivalently referred to as status of a ship denote by t i i 1 2 3 the time slots which are the basic units to investigate the behaviour and motivation of a ship let the set of the actual status of all ships at time t i be represented by s i s i r n 4 where n is the number of ship in question r 1 2 3 n indicates the specific ships let the actual status of ship r at time t i be represented by a vector s i r x i r y i r θ i r v i r where x i r and y i r are the earth fixed x and y coordinate θ i r is the heading angle and v i r is the speed it bears mentioning that s i r are observable parameters let the predicted status of ship p from ship r s perspective at time t i be represented by a vector s i p r x i p r y i p r θ i p r v i p r each variable with a tilde on top stands for the predicted value of the variable meanwhile the predicted status of all ships from ship r s perspective at time t i be represented as s i r s i p r n 4 let the inferred intention of ship p towards ship q from ship r s perspective at time t i be denoted by ψ i p q r hence the inferred intention of all ships from ship r s perspective at time t i can be denoted as ψ i r ψ i p q r n n where p q r ship 1 2 n are the ship numerators and p q moreover ψ i r is equivalently termed as the inferred cal matrix of the ships from the perspective of ship r the value of ψ i p q r can be either 1 or 0 where 1 stands for the intention of ship p towards ship q being give way gw and 0 stands for non gw in compliance with colregs gw means that ship p tends to pass the encounter region from the aft side of the ship q again it is worth mentioning that when an element of the matrix is 1 the diagonally symmetric element is 0 and vice versa with the above notations the fundamental relations of the observable the predictable and the inferred information of a vessel can be formulated as 1 ψ i r f s i r s i ψ i 1 r s i 1 r g s i ψ i r the first line of eq 1 indicates that the inferred ca intention of the ships at time t i is worked out by comparing the actual status and the predicted status of the ships at time t i with reference to the previous inferred intention the second line of eq 1 means that the predicted status at time t i 1 is calculated by the observed status and the inferred intention at time t i in the previous notations s i r x i r y i r θ i r v i r is an ordinary vector with determined value as for the corresponding predicted status s i p r x i p r y i p r θ i p r v i p r is an uncertain vector theoretically there should be a joint distribution function for the random vector s i p r in the implementation of the model the value of the vector is derived by scheme g in the sense of maximum likelihood analogously the inferred cal matrix ψ i r is also an uncertain matrix although eq 1 has elegantly delineated the relations among the three kinds of variables the specific reasoning procedure represented by functions f and g are not given in eq 1 in what follows it can be seen that f and g are not closed form functions but a series of modelling and calculating steps 3 4 ship manoeuvrability model in close quarter ca scenario an important influence factor of ship s ca performance is ship s manoeuvrability on one hand the os s manoeuvrability will affect its decision making on the other hand the ts s manoeuvrability can also affect the inference of os about the ts s motion the navigation environment of the ships is complex and dynamic with wind waves and currents exerting impacts on the movement of the ships however previous literatures montewka et al 2010 zhang et al 2012 indicated the way that such environment factors influence the ships navigation following the assumptions used in the previous ship ca research such as d zhang et al 2013a and j zhang et al 2013b the linear nomoto model is adopted in this paper to approximate express the ship s manoeuvrability which is shown as follows 2 t s d ω d t ω k s δ where ω is the angular velocity and δ is the rudder angle under operation t s and k s are called time constant and rudder gain constant respectively based on eq 2 when the rudder angle is operated for turning to δ 0 and hold for a period time t the course alteration of the ship can be calculated as follow 3 θ t k s δ 0 t t s t s e t t s in the next step of steering the rudder is operated back to mid ship however it will keep on turning because of inertia the nomoto model has advantages in terms of calculation speed it can be effectively used to predict ship trajectories in areas where accuracy is not critical but fast calculation is required its linear form is easy to express fig 4 illustrates the predicted region of the ship in an acceptable way the left part of fig 4 illustrates the reachable region of a ship for keeping a rudder angle for a period while the right part indicates the reachable region of a ship for changing the rudder angle for a period according to fig 3 if the time slot is small enough the position a ship can reach in the next time slot is confined to a limited region regardless of the rudder angle change during the time slot we call the envelop of the region the reachable domain the reachable domain of the ship is a visual representation of the ship s manoeuvrability and is also one of the basic principles for predicting the movement of tss fig 4 illustrates how to filter the predicted positions of tss by using the reachable domain when os s1 in fig 4 makes a prediction according to current situation a point cloud will be formed centred on the predicted position like the point clouds shown in fig 2 the closer the distance is to the predicted position the denser the points are the reachable domain can be used to estimate the prediction according to fig 4 the prediction of s4 black ship is not as credible as ship s2 and s3 as more probabilistic points are located outside of the reachable domain of ship s4 4 the full scheme design 4 1 guidelines of the scheme design 4 1 1 observation of vessel status to enable iterative collision avoidance decision the iterative ca decision model of oipd assumes a synchronized analysis framework in which every ship makes its own decision independently in the following scheme the os refers to the vessel of interest in the problem whereas the other vessels are categorized as tss whose behaviour is observed and estimated by the os during the ca process all the vessels are in a peer to peer status with regard to the scheme based on this the os can be assigned to any ship without distinction 4 1 2 calculation of dcpa and tcpa one of the most widely used criteria for real time ca decisions is dcpa and tcpa given the real time status information of the ship the predicted trajectory can be expressed as a linear equation over time dcpa and tcpa of two ships can be calculated by finding the local minimum of the simultaneous linear parametric equations of two predicted trajectories chen et al 2017 zhang et al 2015 presented a dcpa and tcpa calculation method that is suitable for ca decisions under multi ship encounter situations 4 1 3 preliminary judgment of collision avoidance logic according to the analysis of the major maritime collision accident investigation reports prior data show that 56 of accidents involve violations of road rules colregs statheros et al 2008 although there is no specific regulation on multi ship encounters in colregs it is reasonably assumed that at the beginning of the iterative ca decision process all involved ships initially try to comply with colregs in most of the literatures perera et al 2011 perera and guedes soares 2015 the give way and stand on ships are distinguished according to the colregs based on the relative positions of the two encountering ships besides dcpa and tcpa can be calculated by solving the extremum of quadratic equations the instant speeds courses and the relative positions thus determine the sgr between two ships wang et al 2013 if the sgr truly exists therein meanwhile the ships intention calculated by these observable data imply the initial judgment of the ship s cal hence the core question is how to evaluate the decision manoeuvre behaviour of vessels in a quantitative form and infer the cal accordingly 4 1 4 cross analysis of prediction and decision from the perspectives of oss and tss since the decision manoeuvring of all involved ships are entangled in the anti collision decision context a cross decomposition is proposed in the prediction and decision phase of oipd model the inference of ts s intention and the decision making of os are articulated as follows 1 a ships ca decision manoeuvring is governed by its cal while the ship s current status including the positions speed headings etc is derived from its actions made in the last time slot 2 the observable status of a ship is the only information which all the other ships make their ca decisions based upon it is also assumed that each ship makes rational decisions 3 by deducing the ca solutions according to an os s expectation about the tss behaviour the os chooses its best strategy to participate in the ca resolution procedure 4 an os s decision preference is firstly to keep enough safety collision avoidance margin and then to keep the deviation from its original destination low enough 4 2 the implementation of multi ship ca scheme 4 2 1 the algorithms for collision avoidance from cal to collision avoidance decision manoeuvring the whole scheme consists of four algorithms one of which alg 1 acts as the main and the other three alg 2 3 and 4 act as the subsidiary the algorithms aim to simultaneously output future state predictions of tss and the decision of os the algorithm begins by discretizing the set of decision manoeuvring measures and the prediction is performed after each state observation in two phases 1 update the latest inference of cal matrix ψ i r ψ i p q r n n s i s i r ψ i 1 r 2 status prediction s i 1 r t s t e e r s i ψ i r by simulating the general ca decision making process of ts based on the inferred cal in addition the ca decision of os for next time step can be also achieved simultaneously by using the same method in phase 2 an overview of the algorithm is shown in table 2 4 2 2 interpretation of the main algorithm 1 preparatory work line 2 8 encounter scenario information initialization line 2 6 at the beginning of the trajectory prediction decision making framework the ship status of the encounter scenario is initialized and discretized as s 0 line 2 to enable the algorithm to make sure the theoretical equations as well as the ca decision making system are computable the time also has to be discretized and the duration of the decision loop of each ship is set to an integer multiple of the discretized time line 4 6 it is assumed that the set of possible solutions at each decision loop are available and finite current status input from ship r s perspective lines 7 8 the cal inference the decision making of os and the trajectory prediction of ts all require inputting the current status of all involved ships the observation information s i is obtained from the set of global status information which is also the only information the os can get from the environment 2 cal matrix inference and confirmation lines 9 10 at every decision loop the status of all involved ships is observed s i and the current cal matrix of t i from ship r s perspective is ψ i p ψ i p q r n n which can be calculated by alg 4 this observation is used to update the cal inference by comparing with the historical data and confirmation for each ψ i p q r section 4 2 5 4 2 7 present a more detailed introduction of alg 4 3 trajectory prediction decision making lines 11 35 this section of pseudo code is further divided into two segments trajectory planning for every ship from os s perspective lines 11 21 and prediction verification lines 22 28 trajectory planning for every ship from os s perspective lines 11 21 the trajectory planning algorithm is designed as a logical structure with two layered nested perspective the perspective of os is the bottom logical layer which presents an imaginary external environment for the ca decision making the imaginary here means that the information of all ships comes from the observation and inference of os the specific decision of every ship is the second layer of perspective therefore the procedures of the ca decision need to be operated in every ship line 11 for ship p the decision making algorithm is opposed depending on whether cal 1 line 12 16 or cal 0 line 17 21 the detailed interpretations of alg 2 table 3 and alg 3 are proposed in section 4 2 3 prediction verification lines 22 28 after the procedures of the ca decision if the ship p is os p r the decision made by ship p is the decision of os if ship p is not os the decision made by ship p is the prediction of ship p from os s perspective line 22 although all predictions are performed in accordance with the normal ca performance of a ship the prediction should also be initially verified by the nomoto model line 23 there are several ways to verify the prediction the method shown in fig 5 is applied in this paper the prediction will be accepted when enough points fall within the region of the nomoto model otherwise it should be considered that the ca decision making procedures of ship p from os s perspective does not follow the actual situation of ship p this situation is usually caused by too strict parameters used in the trajectory planning algorithms such as too small maximum alterable angle of steering or minimum safety distance therefore it is necessary to relax the parameter limit and execute the trajectory planning algorithm line11 line 21 again line 26 at the end of algorithm of current decision cycle os will get the decision and the prediction of tss in next few moments 4 2 3 interpretation of the subsidiary algorithms for trajectory planning 1 alg 2 trajectory planning algorithm for ship p when cal 1 the cal 1 means os tends to cross the encounter region from the aft side of ts which is similar with the give way situations in traditional ways the measures that os can take are reduction of speed and turning starboard since the effects of different measures are different according to the crossing angle all the tss are divided into two groups by the crossing angle the measure of speed reduction is taken to avoid the tss that have a small crossing angle against os and then os turn starboard to avoid other tss an overview of the algorithm is shown in table 3 the constant parameters in alg 2 table 3 include collision risk threshold d i s r i s k unit change of speed η v and steering angle η θ maximum steering angle θ m a x maximum steering time t m a x and minimum safe dcpa value d 0 ϕ 0 is a particular value of crossing angle between the courses of two ships when the crossing angle is smaller than ϕ 0 ca performance by steering will be no longer effective and may even increase the risk of collision therefore changing speed should be of higher priority to perform the ca operation 2 alg 3 trajectory planning algorithm for ship p when cal 0 the ca decision making process of os in the case of cal 0 alg 3 is opposite to the case of cal 1 alg 2 the function of the algorithm is parallel to that of table 3 the two algorithms are the same in judging decision conditions the difference between them is that alg 3 s decision making content is exactly the opposite to alg 2 s namely turning left and accelerating so as to pass through the fore side of the ts as soon as possible 4 2 4 cross analysis of decision manoeuvring between prediction and observation the predicted status including trajectory velocity and course will converge towards the real values as the inference verification loops of the ts s cal increase the trajectory prediction part of the algorithm is developed from the ca decision framework the algorithm is called in each ship s decision phase based on its own unique perception of the current encounter situation as all the ships in the encounter situation are influenced by each other the ca decision manoeuvring analysis of ships is easy to be entangled in terms of decision context a style of crossed decomposition is proposed in this section to enable the decision manoeuvring analysis in the oipd method the inference of ts s cal is based on the iterative test and confirmation of the decision manoeuvring behaviour of ts the test and confirmation are achieved by comparing the relative status pairs of ts and os by doing so the inference of ts s cal can be modified or confirmed both kinds of relative status pairs for crossed analysis are defined as follows 1 real status pairs rsp let s i p s i q be the rsp of ship p and q at t i where s i p x i p y i p θ i p v i p and s i q x i q y i q θ i q v i q at t i os made its decision by observing the status and inferring the cal of ts as the effectiveness of the prediction of ts at t i is necessary for cal inference and os s decision at next time steps another status pairs should be constructed for analysis 2 predicted status pairs psp let s i 1 r s i 1 q r be the psp of ship r os and ship q ts at t i where s i 1 r is the status of os at t i 1 which can be achieved as the results of os decision alg 1 at t i and s i 1 q r is the predicted status of ts at t i 1 from os perspective according to the information at t i when the two ships are both tss p and q from os s perspective psp changes into s i 1 p r s i 1 q r for convenience the psp can be expressed as a unified form as s i 1 p r s i 1 q r when p r s i 1 p r s i 1 q r s i 1 r s i 1 q r it should be noted that the first parameters in both rsp and psp are the status of main perspective and the second is ts s for instance the cal calculated by the rsp s i p s i q means it is the ship p s cal towards ship q both status parameters in rsp represent status that have already occurred and can be observed whereas the status parameters in psp represent status that have not occurred yet now the question is how to present a quantitative form to evaluate the decision manoeuvring grade at each time node way point a naïve way is to give score to the action taken at the time nodes nevertheless the decision manoeuvring behaviour is usually complicated and compounded with various uncertainties using a unitary scale to quantify the decision manoeuvring grade will ignore the uncertainties that can contribute to the real time manoeuvring and decision making 4 2 5 inference of the collision avoidance logic based on evidence discrepancy measurement in the oipd model the cal of vessels are inferred by measuring the difference between the prediction and the observation as the evidence theory shows a promising effect in modelling the decision performance a frame of evidence discrepancy is set up in this section in addition even in the case of multi ship encounter scenario the inference of cal is realized by pairwise comparison of two ships 1 prediction measurement by prediction measurement the trend of decision manoeuvring is predicted and examined with the definition introduced in previous section the prediction measurement of ts s cal at time t j is calculated with psp s i 1 p s i 1 i q and rsp s i p s i q following the paradigm of evidence theory let the two element set θ p n p be the frame of discernment where p represents the decision manoeuvring of interest to support the cal inference whereas np is the opposite the power set of θ is 2 θ p n p p n p where p n p is the universal set and is the empty set let m be the basic probability assignment bpa function over θ then m p and m n p quantify the confidence with which the behaviour of interest can be categorized as support or non support to the current cal inference respectively particularly m p n p specifies the degree of uncertainty that the given ca behaviour can be recognized as support or non support let s i p and s i q be two arbitrary principal ship status data d s i p s i q is defined as the actual distance between the two positions d c p a s i p s i q is the expected dcpa of the two ship and t c p a s i p s i q is the corresponding tcpa particularly if the two ship status data indicate that the vessels are departing from each other i e no tendency of moving closer d c p a s i p s i q and t c p a s i p s i q are both assigned with a large number m e g m 2 10 let λ 0 λ 1 be a deterministic weighted parameter several definitions are illustrated as follows definition 1 the spatial closeness factor c l s i p s i q between s i p and s i q is the weighted average of d s i p s i q and d c p a s i p s i q which is denoted as follows 4 cl s i p s i q λ d s i p s i q 1 λ dcpa s i p s i q definition 2 given a pair of two ship status data rsp s i p s i q and psp s i 1 p r s i 1 q r the predicted ca manoeuvring spatial gain factor pre camsg of ship p towards ship q in the time interval t i t i 1 is given by 5 pre g d p q t i t i 1 c l s i 1 p r s i 1 q r c l s i p s i q the predicted ca manoeuvring temporal gain factor pre camtg of ship p towards ship q in the time interval t i t i 1 is given by 6 pre g t p q t i t i 1 t c p a s i 1 p r s i 1 q r t c p a s i p s i q when ship p is os p r s i 1 i p r s i 1 r pre camsg and pre camtg describe the degree of compliance between the predicted status and the ca behaviour of current moment in terms of space and time with the information available at time t i the dst theory is applied to pre camsg and pre camtg to quantify the spatial and temporal evidence and information fusion the same method will be used in the posterior data finally dst will be used to quantify the deviation between the predicted and observed data according to dst the basic bpa curves can be labelled as the m p m n p and m p n p curves with the constraint m p m n p m p n p 1 the curves are given by the following functions and the related parameters let 7 f 0 x α β 1 exp x α β 2 α x 0 α x be the benchmark function the carves are defined as follows m p f 1 x f 0 1 5 x 0 6 0 7 m n p f 2 x f 0 2 1 5 x 0 6 0 7 m n p p f 3 x 1 f 1 x f 2 x it should be noted that the function construction can be subject to modifications according to the practical situation 2 observation measurement by observation measurement the factual status is examined and compared with the prediction the analysis framework is analogous to that of the prediction measurement except that the focused status pair is rsp s i 1 p s i 1 q in t i 1 instead of psp s i 1 p r s i 1 q r which is to be studied against s i p s i q consequently a counterpart definition of definition 2 is denoted as follows definition 3 given the two ship status data pairs s i p s i q s i 1 p s i 1 q the observed ca manoeuvring spatial gain factor obs camsg of ship p towards ship q in the time interval t i t i 1 is given by 8 obs g d p q t i t i 1 c l s i 1 p s i 1 q c l s i p s i q the observed ca manoeuvring temporal gain factor obs camtg of ship p towards ship q in the time interval t i t i 1 is given by 9 obs g t p q t i t i 1 t c p a s i 1 p s i 1 q t c p a s i p s i q with the obs camsg and obs camtg the remaining computing process can follow the route of the prediction case 4 2 6 discrepancy between prediction and observation the discrepancy between the prediction measurement and the observation measurement is necessary to measure the accuracy of the cal inference the distance between the two bodies of evidence is applied to find a quantitative method to describe the discrepancy definition 4 let 10 e ˆ p q i 1 m ˆ p q i 1 p m ˆ p q i 1 n p m ˆ p q i 1 n p p be the prediction measurement of ship p towards ship q at time t i 1 11 e p q i 1 m p q i 1 p m p q i 1 n p m p q i 1 n p p be the corresponding observation measurement let e ˆ p q s i 1 m ˆ p q s i 1 p m ˆ p q s i 1 n p m ˆ p q s i 1 n p p be the pre camsg based evidence of ship p towards ship q at time t i 1 and e ˆ p q t i 1 m ˆ p q t i 1 p m ˆ p q t i 1 n p m ˆ p q t i 1 n p p be the pre camtg based evidence of ship p towards ship q at time t i 1 then the integrated prediction evidence of ship p towards ship q at time t i 1 can be expressed by 12 e ˆ p q i 1 e ˆ p q s i 1 e ˆ p q t i 1 the integrated observation evidence of ship p towards ship q at time t i 1 can be calculated in a similar way 13 e p q i 1 e p q s i 1 e p q t i 1 the discrepancy between prediction and observation of ship p towards ship q at time t i 1 is the distance between e ˆ p q i 1 and e p q i 1 denoted by d p q i 1 14 d p q i 1 1 2 e ˆ p q i 1 e p q i 1 d e ˆ p q i 1 e p q i 1 t 1 2 where d 1 0 1 2 0 1 1 2 1 2 1 2 1 4 2 7 alg 4 combination of prediction and observation at each decision loop the prediction and the observation measurement are both formulated as a body of evidence combined with their spatial and temporal components thus the discrepancy between the prediction and observation reflect the limitations of one ship s perception of the other ship on the other hand one ship s next behaviour manoeuvring may be somehow unexpected to the others at the current step which will result in a certain amount of deviation from the original estimation as a ship s ca decision will be affected by more than one ships in the multi ship encounter situations the decision must be made in the interest of all ships to ensure safety by following eq 4 eq 14 the discrepancy between prediction and observation of ship p towards ship q at time t i 1 can be calculated now that alg 4 is delineated the cal is therefore inferred and then be called by the main algorithm alg 1 line 9 of table 2 5 case studies 5 1 encounter scenario setup in this section the effectiveness of the oipd method for multi ship ca is tested by simulation firstly a typical four ship encounter situation is constructed as the multi ship ca scenario the initial status includes positions speeds and course angles of the involved ships which is listed in table 4 all the initial state set of ships keeps the same from simulation scenario 1 simulation scenario 3 while some initial set of scenario 4 is different with scenario 1 3 fig 5 illustrates the initial status of the scenario 1 3 with the above settings if the ships do not take proper ca measures they will collide at point a after 1000s all of the simulation results are presented by time dependent motion sequences the algorithm has been coded and simulated in matlab firstly it is useful to try to analyse the encounter situation according to colregs from s1 s perspective s2 and s3 is the stand on ship and s1 should give way to them while s1 is the stand on ship towards s4 if s1 complies with colregs it should pass the encounter region from the fore of s4 and from the aft of s2 and s3 as the crossing angle between s1 and s2 is large whereas the angle between s1 and s3 are small the decision made by s1 should be different when avoiding the collision from s2 or s3 in the following subsections this scenario setting will be used to verify the algorithm s performance when it is applied to ships with different compliance of the colregs the effectiveness of the inference of ts s cal will also be verified under the same scenario setting 5 2 simulation scenario 1 in scenario 1 every ship is supposed to comply with colregs and take actions proactively all the ships cal will be 1 gw towards the tss which appear at the starboard and os will cross the encounter scenario from the aft of ts the positions at several typical time points and the historical trajectories from beginning in simulation scenario 1 are presented in fig 6 the dcpa and instantaneous distance of all four ships during the entire ca manoeuvre are shown in fig 7 in which the z folds are the curves of dcpa and the parabolic are the curves of distance according to figs 6 and 7 every involved ship finally infers tss cal correctly and avoids the collision successfully s1 and s3 are crossing from aft region of s2 s2 is crossing from aft region of s4 and s4 is crossing from behind of s1 all the ca behaviour is consistent with colregs in order to see the oipd method performance in a more specific way some details on ships decisions inference and manoeuvres are shown in table 5 including number of times of decision making moment of taking action s turning angle deg period of staying on the new angle s percentage of initial speed and shortest distance ts and moment according to the data s1 makes the initial decision at 621s which include turning 30 to starboard and reduced the speed to 50 of the initial speed due to the initial position and the decision cycle the decision time of each ship is different the decision of s4 is the latest and its first decision occurred at t 815s which include turning 30 to starboard it should be noted that in order to make the magnitude of the change of ships state as small as possible the steering angle within the single decision for all ships is set to a maximum of 30 the time of the steering is maintained for a maximum of 600s finally all ships manage to avoid collisions by turning to starboard 30 during the ca manoeuvre process the highest risky situation occurred at 1603s when the distance between s2 and s3 is 2342 1m considering the setting of 300m of ship length this distance is safe enough fig 7 illustrates the decision making process from another perspective moreover the data under the case that decision made without inference is simulated as a control group depicted by dashed lines as there is no cal change during the ca manoeuvre both ca process with and without inference are successful the difference between the two cases is mainly due to the different time and status of situation 5 3 simulation scenario 2 during the navigation it is possible that the oow violates the regulation of colregs or made inappropriate decision due to human failures or organisational factors an oow may make wrong decisions due to different understanding of situation or being unaware of regulations in this subsection another scenario is studied where s1 follows the opposite of the regulations of colregs to make an unexpected ca decision in this circumstance other ships have to discover this condition in time and respond accordingly according to the requirements of colregs ships must communicate with each other at first and make reasonable decisions through communication however in the case of this paper each ship needs to infer ts s cal and to judge the abnormality of ts the results of ship decisions and manoeuvre are shown in fig 8 the dcpa and instantaneous distance of all ships are shown in fig 9 it can be seen that all ships successfully avoid the collisions the details of ships decisions and inference are shown in table 6 s1 is especially set to make decision without inferring the behaviour of other ships when all ships enter the encounter region their initial decisions are based entirely on the current state of other ships in this step the decision is the same as table 5 except s1 whose decision is the opposite the second decision of s1 is at the end of the first turn i e at t 1221s when it makes a new decision to keep the current turn based on the situation at the time since s4 has not detected the additional collision risks and the cal changes it maintains the initial decision until it passes the encounter region s2 recognizes the abnormality of s1 at t 1824s and t 1855s and subsequently changes its decisions however it should be noted that although there have been 8 changes of s2 s cal only two moments t 1824s and t 1855s are directly related to itself for other situations s2 maintains the old decision based on the situation s3 makes a new decision because of the cal change of s2 after t 1855s in fact s1 s decision makes it depart the central area where collisions might occur from the beginning therefore its ad hoc decision helps to reduce the risk of collision when there is an out of control ship wu et al 2018 in the encounter scenario the proposed scheme has more flexibility to cope with the situation 5 4 simulation scenario 3 for ship collision avoidance scenarios an out of control ship is more dangerous than decision or manoeuvring errors in this simulation s1 is supposed to keep navigating on its initial speed and course angle without considering other ships the planned trajectories are shown in fig 10 in which the closest situation is shown in the subfigure of t 1500s additionally dcpa and instantaneous distance of all ships are shown in fig 11 the detailed information of ships decision and inference is shown in table 7 even this encounter scenario is much more complex than scenario 1 and 2 all ships pass the region successfully the overall process of ca is similar to that of scenario 2 at the beginning all ships make decisions according to normal conditions and then an abnormality of s1 is identified compared with scenario 1 fig 6 s2 and s4 find the uncommon manoeuvre of s1 at t 1220s the resulting chain reaction is that s3 subsequently makes a decision to continue to turn 30 at t 1225s in such a complicated situation it is very difficult to find an abnormality and make a decision without communication therefore in this scenario the highest risky situation occurs at t 1463s when the distance between s1 and s2 is 950m although the two ships are almost parallel in the course it is still an undesirable situation in this case it is not enough to make decisions only based on the current situation without the cal inference according to fig 11 s1 and s2 collide without inferring ts s cal 5 5 simulation scenario 4 the ca process of the entire scenario 4 can be divided into two stages the first phase only involves s1 and s2 at the beginning s1 and s2 both detect the collision risk and made ca decision respectively according to colregs s1 should give way to s2 and s2 should keep its speed and course however regardless of s1 or s2 there is an additional collision risk with the other two ships if s2 continues to maintain its speed and course it does not reduce the risk of collision with s3 or s4 therefore for s2 the most appropriate ca decision is to turn left at 600s after s1 and s2 make first ca decisions the new encounter situation prompts all four ships to enter new ca stage according to the colregs s4 should be the give way ship of s2 therefore s4 turns right to keep clear and avoid s2 meanwhile s2 infers the ca intention of s4 and then turns left from the original right turn course to match the ca manoeuvre of s4 as all ships continue to move each one experiences an iterative ca inference process with other ships during the entire ca process the cal of s2 has been changed 5 times which is higher than that of the other 3 ships this is because s2 is the closest to the centre of the region and the encounter situation with other ships is very pressing and not easy to handle it can be illustrated in fig 14 that the ca route of s2 is the most tortuous the ca decisions of the other three vessels are more stable although s3 also changes ca decisions for 8 times the first five decision alterations are only changed the time of keeping on the new course which can be seen in table 8 the ca process of the entire scenario 4 can be divided into two stages the first phase only involves s1 and s2 at the beginning s1 and s2 both detect the collision risk and made ca decision respectively according to colregs s1 should give way to s2 and s2 should keep its speed and course however regardless of s1 or s2 there is an additional collision risk with the other two ships if s2 continues to maintain its speed and course it does not reduce the risk of collision with s3 or s4 therefore for s2 the most appropriate ca decision is to turn left fig 12 at 600s after s1 and s2 make the first ca decisions the new encounter situation prompts all four ships to enter new ca stage according to the colregs s4 should be the give way ship of s2 therefore s4 turns right to keep clear and avoid s2 meanwhile s2 infers the ca intention of s4 and then turns left from the original right turn course to match the ca manoeuvre of s4 as all ships continue to move each one experiences an iterative ca inference process with other ships during the entire ca process the cal of s2 has been changed 5 times which is higher than that of the other 3 ships this is because s2 is the closest to the centre of the region and the encounter situation with other ships is very pressing and not easy to handle it can be illustrated in fig 14 that the ca route of s2 is the most tortuous the ca decisions of the other three vessels are more stable although s3 also changes ca decisions for 8 times the first five decision alterations are only changed the time of keeping on the new course which can be seen in table 8 5 6 estimation of the efficiency of algorithm performance in the previous four subsections the proposed ca algorithm is verified in 4 different scenarios it can be illustrated from the simulation experiments that the algorithm is effective for most ca scenarios meanwhile as most of the prior algorithms in the literature assumed the mutual understanding of the decision made by the ships involved it is hard to compare the proposed algorithm with the traditional ca schemes therefore in this subsection the data envelopment analysis dea method is used to further quantitatively evaluate the efficiency of the ca performance of the proposed algorithm fig 13 dea is widely used to estimate the efficiency of the performance of the multi input and multi output system wu et al 2015 used this method to evaluate the effectiveness of maritime safety control measures in this subsection each ship is regarded as a decision making union dmu of dea method and the inputs and outputs of dmus are depicted in fig 14 the inputs of dmus include the basic elements that can describe the complexity of the current encounter scenario including 1 spatial urgency factor expressed by dcpa the shortest initial dcpa of each ship can be found in table 4 2 temporal urgency factor expressed by tcpa which can be found in table 4 3 scenario complexity for different scenarios the number of involved ships and the category of encounter scenario determine the complexity of ca decision making for instance if there are several ships in an overtaking scenario like the simulation scenario 4 of section 5 5 the ca decision making will be more complexity than the scenarios with only crossing encounter situation involved the scenario complexity parameter c i d e a can be calculated as c i d e a n when the os needs to deal with the crossing encounter situation with n tss while when there are k tss that in over taking or heading situations with os c i d e a 2 k n k 4 compliance with colregs as a widely accepted international regulation colregs is the most important reference for ca decision making if there is a ship who deviates from the colregs other ships are supposed to detect this trace based on its behaviour and change their decisions accordingly this kind of cases can be found in simulation scenario 2 section 5 3 and 3 section 5 4 when there are k tss that do not comply the colregs the scenario compliance parameter o i d e a can be calculated as o i d e a 3 k while if all tss are obedient the colregs o i d e a 1 the outputs of dmus include the elements that can describe the performance and results of the ca decision making of all involved ships all the output information can be obtained in the results table of each simulation scenario which include 1 safety performance factor the closest distance between os and tss is used to evaluate the safety performance of ca decision making which can be achieved from the result table of each scenario 2 operational performance factor all ca decisions need to be achieved through the ca manoeuvre to cross the encounter region safely the success of the ca decision making does not mean the whole process of ca is successful there are many practical factors that restrict the performance of the ca therefore in order to ensure the success of collision avoidance the decision results should be clear and the number of changes should be reduced as much as possible in the operational performance factor the number of decision changes is defined as an important indicator the fewer times the decision is changed the higher the operability of the ca decision is operational performance factor of every ship can be achieved from the result table of each scenario dea method measures the ca decision and manoeuvre performance of a set of dmus which are the involved ships in this paper these dmus transform a vector of inputs x i x 1 x 2 x 3 x 4 t i 1 2 3 4 into a vector of outputs y i y 1 y 2 y 3 t i 1 2 3 4 by using the proposed ca decision method then all dmus in a scenario form a data matrix x y in which x x 1 x 2 x 3 x 4 and y y 1 y 2 y 3 y 4 based on x y the problem of determining the efficiency of decision making is transformed into an optimal solution of linear programming due to the different concerns the method for solving the optimal solution is also slightly different for instance for dmu i ccr model focuses on solving the following linear programming problem min θ λ θ subject to θ x i x λ y λ y i λ 0 by applying three basic dea models the efficiency of the decision making performance of each ship can be calculated which is depicted in fig 15 in the dea models higher efficiency scores usually indicate better performance when the efficiency score is 1 it is called dea efficiency which means that the relative performance of the input and output is ideal ccr bcc and additive dea are basic and widely used dea models the efficiency estimated by the ccr model comprises technical efficiency and scale efficiency which is called the gross efficiency of a dmu while the bcc model only estimates the technical efficiency and the additive dea model is another technical efficiency to evaluate the model in this section fig 15 illustrates that although the efficiency scores are different in different dea evaluation methods all the indicators show that the dmu decision is efficiency the performance efficiency of the dmu in scenario 4 is inferior to that of scenarios 1 to 3 which is consistent with the complexity of scenario 4 it is worth noting that the performance of the proposed scheme depends on the adjustment of some key parameters particularly the evidence theory based discrepancy d p q i 1 between prediction and observation which can be calculated by eq 14 in section 4 2 6 is sensitive to the determination of successive cals in the simulation tests the threshold parameter d 0 of the evidence discrepancy is adopted by repeated trials which has a critical impact on the performance of ca decision making however in most cases an empiric value of d 0 can be accepted as a useable value 6 discussion and conclusions this paper proposes a distributed ca decision support formulation based on the inference of objective s intention every ship makes decisions from its own perspective and only considers keeping itself safe during the decision making process moreover no communication between the involved ships is granted which is mostly the real world case the information available to each ship is limited to the observable status of the target ships the proposed ca scheme not only predicts the status of the tss in the near future but also infers their ca intensions so that the os can make decisions in response the proposed oipd gives an approach by introducing an iterative decision making procedure the observation of ship status is the beginning of each decision cycle the update of the current information will be compared with the previous prediction using the evidence theory according to the discrepancy between observation and prediction the inference can be confirmed or modified then the new inference is employed to form the decision of os and prediction of tss the objective of the method is to provide the decision support to deal with complicated ship encounter situations the method can also act as a part of autonomous ca system in the unmanned ship system three different typical ca scenarios are simulated for case studies to verify the performance of the proposed method all the involved ships are set to comply with colregs in the first scenario in the second scenario one ship is set to behave exactly the opposite of the requirements of colregs in the last scenario one ship is set to keep on moving without regarding of other ships all ships do not know the intention of other ships in advance and make decisions at the very beginning according to the os s pre set judgements as time elapses a reasonable ca decision is made by inferring the cal of the rational target ships except for the tss with deliberately fixed routes the results of simulation indicate that all the ships have effectively inferred tss cal and made corresponding ca decisions and manoeuvrability all the ships finally cross the encounter region safely it can be concluded that this method can be used to estimate the ship s intention effectively without communication it should be noted that the proposed multi ship ca decision making scheme may be sensitive to some key parameters in some extreme cases in which repeated conflict decisions can cause low convergence of the scheme for instance a large value of the evidence discrepancy threshold parameter may result in unresponsiveness to the cal changes of other ships making intention inference less meaningful on the other hand a small value of this parameter may lead to a sensitive intention inference and a capricious change of the ca decisions in such cases the inferred intention of a ts suffers from constant changes during the ca process giving rise to the chaos of intention inference and the delayed ca decision making furthermore the proposed scheme presently does not take the environmental impact factors including visibility wind and current into consideration but actually these factors not only affect the regular perception and manoeuvrability of the involved ships but also influence the efficiency of the intention inference of the scheme like many other ca schemes in the literature the proposed scheme provides a feasible and programmed decision making algorithm yet how to turn the scheme into tangible devices is left to be further investigated from the engineering perspective especially for the traditional manned ship compared to prior work on the multi ship collision avoidance problem the current work focuses on the autonomous distributed ca scheme by programmed decision making as the unmanned surface vehicles usv or autonomous navigation is acutely envisioned in the previous literature the proposed scheme is also applicable to complex usv collision avoidance scenario where no ca protocols are developed author contribution study conception and design yang wang tengfei wang qing wu data collection analysis and interpolation tengfei wang jinfen zhang analysis and interpretation of results tengfei wang yang wang bing wu draft manuscript preparation tengfei wang yang wang declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement the research presented in this paper is co sponsored by china national key research and development plan project task no 2018yfc0810400 05 the fundamental research funds for the central universities wut 2019iii002gx international cooperation and exchange of the national natural science foundation of china grant no 51920105014 international cooperation technical innovation project of hubei province under grant 2018ahb003 the first author would like to thank the china scholarship council csc and the fundamental research funds for the central universities grant no whut2017 yb 035 for this research 
22141,a novel scheme is proposed for the distributed multi ship collision avoidance ca problem with consideration of the autonomous dynamic nature of the real circumstance all the ships in the envisioned scenario cannot share their decisions or motivation and they make decisions based on the limited observable information each ship is assumed to have a high layer intention to guide the ca decision which is called the collision avoidance logic cal each ship has its own cal that governs the ca decisions and actions meanwhile each ship tries to understand the cals of other ships by continuous inference and observation according to their extrinsic behaviours especially the difference between the observed information and the predicted behaviour this iterative scheme features a four phase programmed decision making procedure namely the observation inference prediction decision oipd model simulation results indicate that the oipd method shows good flexibility and adaptability when all ships comply colregs the proposed scheme can produce normal solutions in case some of the ships fail to make correct decisions the other ships that adopt the proposed scheme can response in time and revise their ca strategies in a proactive way data envelopment analysis method is applied to further quantitatively evaluate the efficiency of the proposed scheme keywords maritime accident multi ship collision avoidance inference programmed decision making anti collision intention 1 introduction ship collisions always constitute a significant proportion of all the ship accidents in terms of their occurrence frequency as well as the catastrophic losses they cause according to statistics the serious ship collision accidents worldwide during 2007 2016 mount to 72 cases making the fourth causal factor of all the maritime accidents allianz global corporate and specialty 2017 for instance in the east mediterranean and black sea region ship collision resulted in 348 casualties in 2015 alone allianz global corporate and specialty 2019 therefore how to prevent ship collision has been attracting sustained attention from the researchers and practitioners in the literature for long meanwhile it is generally recognized that human error contributes to more than 80 of ship collision accidents soares and teixeira 2001 wang et al 2019 wu et al 2017 the major challenges to the collision avoidance ca in the close quarters situation can be categorized into two types namely the manoeuvrability related and the decision related the former refers to the aspects that govern the motions of the vessel and the physical or mechanical impact on the vessel including the ship dynamics external forces such as wind and current etc while the latter involves the strategies and principles of collision settlement in terms of course and speed that are designed and implemented during the whole process of ca manoeuvring in an on going manner when the two types of effects are interwoven the risk of collision can spiral upwards as the vessels are approaching two additional factors should be observed regarding to the ship collision problem firstly the margin of decision and manoeuvring for ca will be narrowed exponentially with the approaching of the vessels which are treated as collision candidates this will account for the growing difficulty and pressure of collision settlement with time passing by in the pre collision phase secondly in multi vessel encounter situation the complexity of ca will increase significantly as the number of collision candidates grows it bears mentioning that in some special waters such as busy gulf and narrow sea passages risk of vessel collision due to multi vessel encounter can never be neglected stakeholders of shipping have long been making efforts to prevent and reduce ship collisions and both technical measures and regulatory actions are promoted and employed in the maritime industry wan et al 2019 some of these anti collision provisions are advocated by inter governmental cooperative bodies like international maritime organization imo from the technical perspective navigation aid technologies are widely utilized in the form of shipborne equipment and onshore infrastructure including ais vts and arpa some of the technical facilities are required by imo as compulsory equipment on board from the piloting crews perspective the technical means track the movement of the neighbouring ships and present some quantitative parameters that characterize the encounter situation such as time to closest point of approach tcpa and distance to cpa dcpa on the policy side imo issued the well known international regulations for preventing collisions at sea colregs in 1972 with some amendments released afterwards the ships engaged on international voyages are all supposed to abide by the convention colregs outline the concepts and principles in dealing with potential collision situation however they only provide with qualitative guidelines for ca li and zhixiong 2014 whereas the actual decision and manoeuvring are conducted by the piloting crews in a subjective manner in spite of the technical facility and the standardized anti collision rules there are still factors that cast a shadow over the collision prevention firstly the state of art shipping technology still relies heavily on human operation and decision making in the case of potential collision situation although the automatic piloting can take effects in open water voyage clear of other ships for a ship involved in a collision settlement scenario observational information of its peripheral ship s may come from the officer on watch oow manually or from the arpa ais devices with dcpa tcpa as the aid for decision making wu et al 2019 zhang et al 2019 nevertheless the critical decision made by the piloting crew remains highly subjective usually largely depending on the crew s professional experience cognitive abilities and sophistication in judgment secondly colregs do not cover the scenario of multi ship encounter if one tries to use colregs in pairwise for collision settlement in a multi ship case it is easy to find contradictions in choosing the ca strategy of the ships i e colregs usually cannot be satisfied in pair wise manner in such cases intuition will take over rule based decision making which may lead to potential conflicts among the envisioned settlements thirdly in the multi ship scenario the decisions are made simultaneously and autonomously by the crew in each ship yet no centralized coordination mechanism actually functions in the process all the ca decisions and manoeuvre are made based on the anti collision strategy of the crew on board which is the hidden intention only known by the piloting crew the anti collision strategy of individual ships lack congruity essentially and this can account for some game like behaviour in the anti collision decision and manoeuvring each ship is subjectively seeking the best path with the least likelihood of collision and the least deviation from its original course the game like behaviour makes ca process similar to a two layer structure consisting with the hidden ca intention at the upper and the observable predictable ca manoeuvre at the bottom this paper concerns the autonomous decision manoeuvring support in the multi ship ca scenario where no guideline for settlement is specified in the current colregs the other consideration is that no global coordinating role is ruling the behaviour of the ships each ship is regarded as a rational agent in dealing with the scenario with the loop of observation inference prediction and decision being modelled as the frame of dynamic anti collision action iteration in this paper the problem is addressed that each involved ship has a high layer and hidden ca intention to move across the region of the multi ship encounter situation which is termed as the collision avoidance logic cal to make an effective ca decision four things should be done for each individual ship firstly observe the latest status of the other involved ships secondly update the inference of the other ships cal according to the new information then predict the movements of the other ships according to the latest inferred cal finally make its own ca decision according to other ships predicted decision all these procedures form a spiral evolution process until own ship pass the encounter region successfully simulation results indicate that the oipd method shows good flexibility and adaptability when all ships comply colregs in simulation the proposed scheme can produce normal solutions in case some of the ships fail to make correct decisions or take actions the other ships that adopt the proposed scheme can response in time and revise their ca strategies in a proactive way data envelopment analysis method is applied to further quantitatively evaluate the efficiency of the ca performance of the proposed scheme the remainder of the paper is organized as follows in section 2 a brief review of the previous of the research is given to illustrate the state of the research the motivation and sketch of this paper is also proposed in section 2 section 3 delineates the basic concept of the method and general framework of the decision making procedure in section 4 detailed real time ca decision making support algorithm is designed at last simulations based on the proposed decision making formulation are carried out by considering several multi ship encounter scenarios in section 5 in order to verify the flexibility of the algorithm different scenarios are considered in simulations including the ships failed of compliance with colregs data envelopment analysis dea method is also applied to further quantitatively evaluate the efficiency of the proposed method some conclusions are discussed in section 6 2 literature review and motivation of research 2 1 the related work as ship ca problem has attracted continuous interest from researchers and practitioners alike a lot of efforts have been made to bring insight into the problem in prior study and several tracks of methods have been formed in treating the issue these methods can be categorized into four classes and are briefly summarized as below the first line of study relates to the geometrical characteristics of the traffic situation among vessels ship domain reflects the most straightforward tactics to deal with ship collision problem the concept was formally proposed by m goodwin 1975 in 1970s which assumes that each ship should keep its own surrounding space in the water that remains clear of other objects ship domain satiates the basic intuitive demands that the minimum distance between ships must be kept and was widely adopted in the literature early stage study on ship domain focused mainly on its size and shape under constant conditions since the collision threat to a ship is usually non uniformly posed on the spatial margin around the ship and is subject to various factors such as ship motion kang et al 2015 ship traffic distribution etc it is reasonable that ship domain is expected to undergo dynamic changes as ship speed and other navigational data vary pietrzykowski and uriasz 2009 defined a variable ship domain with different layers of safe growth and crew s consciousness driven by the big data paradigm recent research attempts to use the ships historical data like the ais data hansen et al 2013 in a specific sea area to extract the sketch of ship domain arena is an analogous concept in the ship collision study and can be essentially regarded as an extended area of ship domain which is a sign of action taking alert once infringed among the geometric parameters of an encounter scenario cpa dcpa tcpa are the most widely used indicators for the situation zhang et al 2017 another collection of research work investigates the ca problem with focus on the uncertainties involved in the motion and behaviour of the vessels usually this sort of work aims at analysing and minimizing the likelihood of collision between the ships and the idea behind is fuelled by the probabilistic risk assessment pra method or statistic based data analysis to this end intentional analysis and data driven methods are both employed by intentional analysis researchers tend to model the mechanism of vessel collision with an analytical approach and the ca problem is investigated in an inside out perspective typical research work includes geometrical probability of collision estimation montewka et al 2010 the minimum distance to collision mode and causation factor montewka et al 2012 and the collision energy and structural capacity analysis goerlandt et al 2012 by data driven methods ship movement and behaviour in the collision or near collision context are extracted from historical vessel traffic data in recent study traffic simulation is generated to evaluate the collision situation goerlandt and montewka 2015 which sheds light on the ca strategy for individual ships these two methods are usually combined to make the analysis more accurate and effective goerlandt and kujala 2014 discussed the application and validity of quantitative risk analysis qra for the proposed ship ship encounter detection mechanisms recent research on the risk and uncertainties in the vessel collision context aims to build a generic framework for collision risk assessment goerlandt and montewka 2015 montewka et al 2014 this work will help the participants including the piloting crew and the shore side administrators make better decisions in a risk informed manner the next strand of study involves path planning among vessels with consideration of the collision risk the formulation of path planning in ca is to find optimal routes for the ships to cross the unsafe water with the least domain infringements apart from the primary constraints of averting the dynamic or static objects there are usually additional objectives in designing effective routes for each ship such as making the navigation distance shorter and returning to the originally intended route faster the concept of velocity obstacle vo can be regarded as the extension and development of dcpa and tcpa it proposes a method that transforms dynamic obstacles into static obstacles thereby reducing the difficulty of ca decisions fiorini and shiller 1998 geng et al 2019 proposed several optimal motion planning algorithms based on the idea of vo for maritime autonomous surface ships mass and verified the efficiency of the algorithms with simulation due to its capability to intuitively display collision risks chen et al 2018a b proposed a ship collision candidate detection method based on time discrete non linear vo the method can be adapted to the characteristics of the ais signal in practice and detect the collision candidate efficiently the path planning in calm water is somewhat similar to the traditional path planning problem developed in the walking robot yet the navigational environment will entail more factors to be considered the artificial potential field apf method is a classical method for robot path planning and it is intuitively believed that the general principle in apf can also be employed in the ship ca problem liu and bucknall 2015 developed a fast marching fm method for unmanned surface vehicle path planning in a dynamic environment the fm method is enhanced from two layered song et al 2015 to multi layered song et al 2017 to adapt to different requirements and environmental conditions the fourth type of research work utilizes multi agent based decision making to deal with the ca problem each ship in an encounter situation can be regarded as an agent with the ability to make ca decisions algorithms in soft computing are employed to provide solutions for the problem typical algorithms include genetic algorithm ant colony algorithm particle swarm optimization algorithm etc liu et al 2017 proposed a hybrid optimization ca algorithm based on the particle swarm optimization and bacterial foraging algorithm the simulation therein includes course alter angle and time parameters and the results show that the algorithm is effective and feasible nevertheless the study is limited to ca between two ships and does not consider the colregs zhang et al 2015 presented a distributed multi ship ca decision support formulation under colregs in which all the involved ships in this algorithm can make decision individually and obey the basic principles of colregs in their work the decision of one ship can be understood by all the other ships in time szlapczynski and szlapczynska 2012 presented a multi ship trajectory planning method by using evolutionary algorithms and several assumptions of game theory were used to set the limitations of path planning however it is as well a centralized algorithm and does not consider uncertainties of the decision of target ships thus there is a strong requirement that the multi agent based decision making scheme for multi ship ca can be fully studied by taking account of the uncertainties therein besides this traditional types of ca research new research trends that combine ship ca research with machine learning are also worth noting luman et al 2019 proposed a path following and ca system for the autonomous ships based on the deep reinforcement learning drl algorithm a line of sight los guidance system and a proximal policy optimization ppo algorithm were applied for drl to learn a safest and most economical trajectory and guide the ship to follow the trajectory based on this zhao and roh 2019 developed a multi ship ca method by using the deep neural network dnn the dnn is trained over multiple ship encounter situations by directly mapping the states of involved ships to the ca steering commands the ca decisions are made based on the rules and regulations of colregs only by rudder angle changes chen et al 2019 proposed a knowledge free path planning method based on reinforcement learning by setting obstacles prohibited areas and navigable areas as punishments or rewards the algorithm can learn a convincing path and manipulating strategies without any knowledge and manual intervention q learning can also be used to form an approximated optimal ca decision of mpc xie et al 2019 2 2 limitations of the prior work despite the plenty of research work devoted to the ca problem the limitation of the prior work is discernible the first weakness is the idealized assumption that the vessels can follow a common scheme to resolve the close quarter situation even in the two vessel case where the ca strategies of both sides are prescribed by colregs it is difficult in reality that the specific conflict resolution algorithm or the intentions are advertised to each other it is therefore envisioned that in the multi vessel case the situation can only be more complex since colregs will not apply in such scenarios hence it is not practically feasible to translate the ca problem in the multi ship scenario into a global optimization problem with static setups for instance by using the traditional apf method given the initial encounter situation the recommended routes will be calculated for each ship however this method ignores the autonomous and dynamic behaviour of the individual ships there is another limitation which relates to the over optimistic presumption that all the environment and information are perceived by each ship with perfect congruity in other words there is a god s perspective that could let each ship know everything about the encounter situation nevertheless in the real circumstances each ship has to observe and sense the situation from its own angle in fact the capability of sensing and detection is subject to the navigational equipment on the individual ships and this will give raise to information asymmetry among the vessels which is beyond the consideration of prior work finally the ca operation is a continuous procedure over time in which each vessel takes actions under two impacts first the own ship os will try to reach the waypoints according to its judgment of the situation secondly it will respond to the behaviours of other ships to prevent collision especially when these behaviours are not expected by the own ship the two impacts are usually co functioning in an entangled manner causing the highly dynamic interaction among the vessels and a closed loop of manoeuvring and responding this suggests that the ca problem in the multi vessel case is an iterative and cooperative decision making process instead of a one deal solution unfortunately this kind of modelling is extremely rare in the prior work 2 3 sketch of the current work in this paper a novel scheme is proposed to provide with a solution for the multi ship ca problem with consideration of the autonomous and dynamical nature of the real circumstance the study is targeted to the ca scenarios in busy waters like bays harbours and gulfs in these restricted areas the density of vessel traffic is higher than that of open waters and thus will cause higher collision risk for the multi ship encounter situation in the complex encounter situation with restricted communication and distributed decision supporting formulation every involved ship makes decisions individually based on the inference of target ships cal there is not a coordination centre to design suggest ca strategies for all ships or exchange the mutual information about the ships ca decision the only information that available to each ship is all the involved ships observable statues such as position speed and course angle as the involved ships cannot share their decision or decision making basis every ship makes decisions based on the limited observable information therefore the iterative decision making procedure including observation inference and prediction for the individual ships is the focus of this paper in the procedure each ship infers the cals of target ships tss based on the observable information and makes an initial decision according to the inferred attitudes to estimate the credibility of the inference and adjust it iteratively a dempster shafer theory dst based method is employed to fuse the discernment in temporal and spatial to evaluate the cal inferences so that an overall reliability between the prediction and real status of the target ships can be quantitatively assessed afterwards the own ship os s decisions are made based on the belief of the inferred tss cals in the current encounter situations and are implemented by adjusting the speed and course angle in the os s decision making procedure a linear extension algorithm for speed course angle alteration are applied to make os s decision it is worth noting that the initial ca decision is mainly based on colregs nevertheless the procedure is more flexible in the subsequent decision making process 3 methodology 3 1 overview of the observation inference prediction decision oipd model in this paper the highly coupled relationship between the ships involved in ca scenario is characterized by a two layer logical decision making structure and an iterative process over time the two layer structure is further decomposed into the proposed oipd model fig 1 presents a schematic diagram of the oipd model for a given ship when each of the involved ships follows the ca scheme independently in a distributed manner the autonomous behaviours of the vessels can be reflected featuring the multi agent dynamics of the vessels each ship will first update the status information of all ships based on observation at the beginning of the current decision cycle afterwards the current state information is compared with the predicted value of the previous decision cycle based on dst the deviation between the prediction information and the actual situation is calculated by fusing the discernment in temporal spatial and combined spatial temporal way with this quantitative approach the inference of ts s cal derived in the previous decision cycle can be confirmed or further corrected based on the inferred cal the ship makes the corresponding cal of current decision cycle subsequently the ship makes ca decision and the prediction about the target ship in accordance with the same logic simultaneously 3 2 the collision avoidance logic and the formulation of ca intention the cal of a ship is its macro strategic to pass through the collision prone situation as mentioned previous the colregs are the basic regulations that both ships should comply with in a typical two ship ca scenarios there are three types of encounter situations addressed by colregs namely crossing head on and overtaking tam and bucknall 2013 and the own ship can be regarded as either a give way ship or a stand on ship when it is involved in a two ship encounter scenario prior research has shown that the instant stand on give way relationship sgr of two encountering ships is categorized by the positions and headings of the two ships at the closest point of approach wang et al 2013 where the cpa calculation is based on the assumption that the two ships keep the constant speed and course notice that the give way stand on relation are not always applicable to the ships there as there can be cases in which the two ships have no potential conflict route apparently the give way or stand on role originates in the instant encountering scenario of the two ships however in what follows the sgr is also used for the actual routes of two ships besides for instant intentions if no confusion is caused obviously the sgr of actual routes is determined by the cross actions of the involved vessels more discussion on this issue will be conducted afterwards in the multi ship encountering scenario the sgr between two ships can be applied in pairwise manner thus a mutual relation matrix can be formulated to represent the pairwise relationship between two ships the first subfigure of fig 2 demonstrates the initial encounter situation of four ships which is the status of the ships at t t 0 each ship is moving to its interim destination labelled with the same colour by repetitive simulations some ca schemes are selected by which the four ships manage to pass through the multiple encounter situation and reach their interim destinations without causing tense situation fig 2 demonstrates these selected schemes that follow the same strategy which consists of 9 successive snapshots of the encountering situations the points in the clouds stand for the sample positions of the ships in the series of simulations from the snapshots the pairwise ca strategy can be summarized as table 1 for each cell in the table the stand on give way role is from the perspective of the ships at the leftmost column besides the diagonal cells in the table the sgr might not apply to some cells in the table in such cases the encountering situation is usually ambiguous or it is unnecessary to identify the sgr for the pair of ships as like s3 and s4 in the example it can be seen that the cells in table 1 demonstrate somewhat antisymmetric feature i e if one cell is stand on the diagonally symmetric cell must be give way and vice versa it is worth noting that the sgr in fig 2 is in the sense of actual route as has been aforementioned the actual route is formed by sustained and continued actions of the ships and the sgr of two routes is in fact an ex post term unlike the sgr of two routes the instant sgr of two ships may change over time this is due to the fluidity in decisions made and actions taken by the ships intuitively global change of ca strategy among the involved ships could possibly occur during the whole process of collision resolution which cannot be conveyed by the sgrs of the pair wise routes alone nevertheless the actual routes in principle embody the overall and prevailing ca intentions of the ships since the instant sgr between two ships is able to characterize the real time decision made by the involved ships the strategic intentions of each ship can be as well presented by mutual sgr matrix which can be straightforwardly obtained from the pairwise sgr table 3 3 principles of decision making and manoeuvring in the ca context as has been discussed the observable and predictable information is highly quantitative moreover the extrinsic behaviour of the vessel can be denoted by the geometric and kinetic parameters these parameters are equivalently referred to as status of a ship denote by t i i 1 2 3 the time slots which are the basic units to investigate the behaviour and motivation of a ship let the set of the actual status of all ships at time t i be represented by s i s i r n 4 where n is the number of ship in question r 1 2 3 n indicates the specific ships let the actual status of ship r at time t i be represented by a vector s i r x i r y i r θ i r v i r where x i r and y i r are the earth fixed x and y coordinate θ i r is the heading angle and v i r is the speed it bears mentioning that s i r are observable parameters let the predicted status of ship p from ship r s perspective at time t i be represented by a vector s i p r x i p r y i p r θ i p r v i p r each variable with a tilde on top stands for the predicted value of the variable meanwhile the predicted status of all ships from ship r s perspective at time t i be represented as s i r s i p r n 4 let the inferred intention of ship p towards ship q from ship r s perspective at time t i be denoted by ψ i p q r hence the inferred intention of all ships from ship r s perspective at time t i can be denoted as ψ i r ψ i p q r n n where p q r ship 1 2 n are the ship numerators and p q moreover ψ i r is equivalently termed as the inferred cal matrix of the ships from the perspective of ship r the value of ψ i p q r can be either 1 or 0 where 1 stands for the intention of ship p towards ship q being give way gw and 0 stands for non gw in compliance with colregs gw means that ship p tends to pass the encounter region from the aft side of the ship q again it is worth mentioning that when an element of the matrix is 1 the diagonally symmetric element is 0 and vice versa with the above notations the fundamental relations of the observable the predictable and the inferred information of a vessel can be formulated as 1 ψ i r f s i r s i ψ i 1 r s i 1 r g s i ψ i r the first line of eq 1 indicates that the inferred ca intention of the ships at time t i is worked out by comparing the actual status and the predicted status of the ships at time t i with reference to the previous inferred intention the second line of eq 1 means that the predicted status at time t i 1 is calculated by the observed status and the inferred intention at time t i in the previous notations s i r x i r y i r θ i r v i r is an ordinary vector with determined value as for the corresponding predicted status s i p r x i p r y i p r θ i p r v i p r is an uncertain vector theoretically there should be a joint distribution function for the random vector s i p r in the implementation of the model the value of the vector is derived by scheme g in the sense of maximum likelihood analogously the inferred cal matrix ψ i r is also an uncertain matrix although eq 1 has elegantly delineated the relations among the three kinds of variables the specific reasoning procedure represented by functions f and g are not given in eq 1 in what follows it can be seen that f and g are not closed form functions but a series of modelling and calculating steps 3 4 ship manoeuvrability model in close quarter ca scenario an important influence factor of ship s ca performance is ship s manoeuvrability on one hand the os s manoeuvrability will affect its decision making on the other hand the ts s manoeuvrability can also affect the inference of os about the ts s motion the navigation environment of the ships is complex and dynamic with wind waves and currents exerting impacts on the movement of the ships however previous literatures montewka et al 2010 zhang et al 2012 indicated the way that such environment factors influence the ships navigation following the assumptions used in the previous ship ca research such as d zhang et al 2013a and j zhang et al 2013b the linear nomoto model is adopted in this paper to approximate express the ship s manoeuvrability which is shown as follows 2 t s d ω d t ω k s δ where ω is the angular velocity and δ is the rudder angle under operation t s and k s are called time constant and rudder gain constant respectively based on eq 2 when the rudder angle is operated for turning to δ 0 and hold for a period time t the course alteration of the ship can be calculated as follow 3 θ t k s δ 0 t t s t s e t t s in the next step of steering the rudder is operated back to mid ship however it will keep on turning because of inertia the nomoto model has advantages in terms of calculation speed it can be effectively used to predict ship trajectories in areas where accuracy is not critical but fast calculation is required its linear form is easy to express fig 4 illustrates the predicted region of the ship in an acceptable way the left part of fig 4 illustrates the reachable region of a ship for keeping a rudder angle for a period while the right part indicates the reachable region of a ship for changing the rudder angle for a period according to fig 3 if the time slot is small enough the position a ship can reach in the next time slot is confined to a limited region regardless of the rudder angle change during the time slot we call the envelop of the region the reachable domain the reachable domain of the ship is a visual representation of the ship s manoeuvrability and is also one of the basic principles for predicting the movement of tss fig 4 illustrates how to filter the predicted positions of tss by using the reachable domain when os s1 in fig 4 makes a prediction according to current situation a point cloud will be formed centred on the predicted position like the point clouds shown in fig 2 the closer the distance is to the predicted position the denser the points are the reachable domain can be used to estimate the prediction according to fig 4 the prediction of s4 black ship is not as credible as ship s2 and s3 as more probabilistic points are located outside of the reachable domain of ship s4 4 the full scheme design 4 1 guidelines of the scheme design 4 1 1 observation of vessel status to enable iterative collision avoidance decision the iterative ca decision model of oipd assumes a synchronized analysis framework in which every ship makes its own decision independently in the following scheme the os refers to the vessel of interest in the problem whereas the other vessels are categorized as tss whose behaviour is observed and estimated by the os during the ca process all the vessels are in a peer to peer status with regard to the scheme based on this the os can be assigned to any ship without distinction 4 1 2 calculation of dcpa and tcpa one of the most widely used criteria for real time ca decisions is dcpa and tcpa given the real time status information of the ship the predicted trajectory can be expressed as a linear equation over time dcpa and tcpa of two ships can be calculated by finding the local minimum of the simultaneous linear parametric equations of two predicted trajectories chen et al 2017 zhang et al 2015 presented a dcpa and tcpa calculation method that is suitable for ca decisions under multi ship encounter situations 4 1 3 preliminary judgment of collision avoidance logic according to the analysis of the major maritime collision accident investigation reports prior data show that 56 of accidents involve violations of road rules colregs statheros et al 2008 although there is no specific regulation on multi ship encounters in colregs it is reasonably assumed that at the beginning of the iterative ca decision process all involved ships initially try to comply with colregs in most of the literatures perera et al 2011 perera and guedes soares 2015 the give way and stand on ships are distinguished according to the colregs based on the relative positions of the two encountering ships besides dcpa and tcpa can be calculated by solving the extremum of quadratic equations the instant speeds courses and the relative positions thus determine the sgr between two ships wang et al 2013 if the sgr truly exists therein meanwhile the ships intention calculated by these observable data imply the initial judgment of the ship s cal hence the core question is how to evaluate the decision manoeuvre behaviour of vessels in a quantitative form and infer the cal accordingly 4 1 4 cross analysis of prediction and decision from the perspectives of oss and tss since the decision manoeuvring of all involved ships are entangled in the anti collision decision context a cross decomposition is proposed in the prediction and decision phase of oipd model the inference of ts s intention and the decision making of os are articulated as follows 1 a ships ca decision manoeuvring is governed by its cal while the ship s current status including the positions speed headings etc is derived from its actions made in the last time slot 2 the observable status of a ship is the only information which all the other ships make their ca decisions based upon it is also assumed that each ship makes rational decisions 3 by deducing the ca solutions according to an os s expectation about the tss behaviour the os chooses its best strategy to participate in the ca resolution procedure 4 an os s decision preference is firstly to keep enough safety collision avoidance margin and then to keep the deviation from its original destination low enough 4 2 the implementation of multi ship ca scheme 4 2 1 the algorithms for collision avoidance from cal to collision avoidance decision manoeuvring the whole scheme consists of four algorithms one of which alg 1 acts as the main and the other three alg 2 3 and 4 act as the subsidiary the algorithms aim to simultaneously output future state predictions of tss and the decision of os the algorithm begins by discretizing the set of decision manoeuvring measures and the prediction is performed after each state observation in two phases 1 update the latest inference of cal matrix ψ i r ψ i p q r n n s i s i r ψ i 1 r 2 status prediction s i 1 r t s t e e r s i ψ i r by simulating the general ca decision making process of ts based on the inferred cal in addition the ca decision of os for next time step can be also achieved simultaneously by using the same method in phase 2 an overview of the algorithm is shown in table 2 4 2 2 interpretation of the main algorithm 1 preparatory work line 2 8 encounter scenario information initialization line 2 6 at the beginning of the trajectory prediction decision making framework the ship status of the encounter scenario is initialized and discretized as s 0 line 2 to enable the algorithm to make sure the theoretical equations as well as the ca decision making system are computable the time also has to be discretized and the duration of the decision loop of each ship is set to an integer multiple of the discretized time line 4 6 it is assumed that the set of possible solutions at each decision loop are available and finite current status input from ship r s perspective lines 7 8 the cal inference the decision making of os and the trajectory prediction of ts all require inputting the current status of all involved ships the observation information s i is obtained from the set of global status information which is also the only information the os can get from the environment 2 cal matrix inference and confirmation lines 9 10 at every decision loop the status of all involved ships is observed s i and the current cal matrix of t i from ship r s perspective is ψ i p ψ i p q r n n which can be calculated by alg 4 this observation is used to update the cal inference by comparing with the historical data and confirmation for each ψ i p q r section 4 2 5 4 2 7 present a more detailed introduction of alg 4 3 trajectory prediction decision making lines 11 35 this section of pseudo code is further divided into two segments trajectory planning for every ship from os s perspective lines 11 21 and prediction verification lines 22 28 trajectory planning for every ship from os s perspective lines 11 21 the trajectory planning algorithm is designed as a logical structure with two layered nested perspective the perspective of os is the bottom logical layer which presents an imaginary external environment for the ca decision making the imaginary here means that the information of all ships comes from the observation and inference of os the specific decision of every ship is the second layer of perspective therefore the procedures of the ca decision need to be operated in every ship line 11 for ship p the decision making algorithm is opposed depending on whether cal 1 line 12 16 or cal 0 line 17 21 the detailed interpretations of alg 2 table 3 and alg 3 are proposed in section 4 2 3 prediction verification lines 22 28 after the procedures of the ca decision if the ship p is os p r the decision made by ship p is the decision of os if ship p is not os the decision made by ship p is the prediction of ship p from os s perspective line 22 although all predictions are performed in accordance with the normal ca performance of a ship the prediction should also be initially verified by the nomoto model line 23 there are several ways to verify the prediction the method shown in fig 5 is applied in this paper the prediction will be accepted when enough points fall within the region of the nomoto model otherwise it should be considered that the ca decision making procedures of ship p from os s perspective does not follow the actual situation of ship p this situation is usually caused by too strict parameters used in the trajectory planning algorithms such as too small maximum alterable angle of steering or minimum safety distance therefore it is necessary to relax the parameter limit and execute the trajectory planning algorithm line11 line 21 again line 26 at the end of algorithm of current decision cycle os will get the decision and the prediction of tss in next few moments 4 2 3 interpretation of the subsidiary algorithms for trajectory planning 1 alg 2 trajectory planning algorithm for ship p when cal 1 the cal 1 means os tends to cross the encounter region from the aft side of ts which is similar with the give way situations in traditional ways the measures that os can take are reduction of speed and turning starboard since the effects of different measures are different according to the crossing angle all the tss are divided into two groups by the crossing angle the measure of speed reduction is taken to avoid the tss that have a small crossing angle against os and then os turn starboard to avoid other tss an overview of the algorithm is shown in table 3 the constant parameters in alg 2 table 3 include collision risk threshold d i s r i s k unit change of speed η v and steering angle η θ maximum steering angle θ m a x maximum steering time t m a x and minimum safe dcpa value d 0 ϕ 0 is a particular value of crossing angle between the courses of two ships when the crossing angle is smaller than ϕ 0 ca performance by steering will be no longer effective and may even increase the risk of collision therefore changing speed should be of higher priority to perform the ca operation 2 alg 3 trajectory planning algorithm for ship p when cal 0 the ca decision making process of os in the case of cal 0 alg 3 is opposite to the case of cal 1 alg 2 the function of the algorithm is parallel to that of table 3 the two algorithms are the same in judging decision conditions the difference between them is that alg 3 s decision making content is exactly the opposite to alg 2 s namely turning left and accelerating so as to pass through the fore side of the ts as soon as possible 4 2 4 cross analysis of decision manoeuvring between prediction and observation the predicted status including trajectory velocity and course will converge towards the real values as the inference verification loops of the ts s cal increase the trajectory prediction part of the algorithm is developed from the ca decision framework the algorithm is called in each ship s decision phase based on its own unique perception of the current encounter situation as all the ships in the encounter situation are influenced by each other the ca decision manoeuvring analysis of ships is easy to be entangled in terms of decision context a style of crossed decomposition is proposed in this section to enable the decision manoeuvring analysis in the oipd method the inference of ts s cal is based on the iterative test and confirmation of the decision manoeuvring behaviour of ts the test and confirmation are achieved by comparing the relative status pairs of ts and os by doing so the inference of ts s cal can be modified or confirmed both kinds of relative status pairs for crossed analysis are defined as follows 1 real status pairs rsp let s i p s i q be the rsp of ship p and q at t i where s i p x i p y i p θ i p v i p and s i q x i q y i q θ i q v i q at t i os made its decision by observing the status and inferring the cal of ts as the effectiveness of the prediction of ts at t i is necessary for cal inference and os s decision at next time steps another status pairs should be constructed for analysis 2 predicted status pairs psp let s i 1 r s i 1 q r be the psp of ship r os and ship q ts at t i where s i 1 r is the status of os at t i 1 which can be achieved as the results of os decision alg 1 at t i and s i 1 q r is the predicted status of ts at t i 1 from os perspective according to the information at t i when the two ships are both tss p and q from os s perspective psp changes into s i 1 p r s i 1 q r for convenience the psp can be expressed as a unified form as s i 1 p r s i 1 q r when p r s i 1 p r s i 1 q r s i 1 r s i 1 q r it should be noted that the first parameters in both rsp and psp are the status of main perspective and the second is ts s for instance the cal calculated by the rsp s i p s i q means it is the ship p s cal towards ship q both status parameters in rsp represent status that have already occurred and can be observed whereas the status parameters in psp represent status that have not occurred yet now the question is how to present a quantitative form to evaluate the decision manoeuvring grade at each time node way point a naïve way is to give score to the action taken at the time nodes nevertheless the decision manoeuvring behaviour is usually complicated and compounded with various uncertainties using a unitary scale to quantify the decision manoeuvring grade will ignore the uncertainties that can contribute to the real time manoeuvring and decision making 4 2 5 inference of the collision avoidance logic based on evidence discrepancy measurement in the oipd model the cal of vessels are inferred by measuring the difference between the prediction and the observation as the evidence theory shows a promising effect in modelling the decision performance a frame of evidence discrepancy is set up in this section in addition even in the case of multi ship encounter scenario the inference of cal is realized by pairwise comparison of two ships 1 prediction measurement by prediction measurement the trend of decision manoeuvring is predicted and examined with the definition introduced in previous section the prediction measurement of ts s cal at time t j is calculated with psp s i 1 p s i 1 i q and rsp s i p s i q following the paradigm of evidence theory let the two element set θ p n p be the frame of discernment where p represents the decision manoeuvring of interest to support the cal inference whereas np is the opposite the power set of θ is 2 θ p n p p n p where p n p is the universal set and is the empty set let m be the basic probability assignment bpa function over θ then m p and m n p quantify the confidence with which the behaviour of interest can be categorized as support or non support to the current cal inference respectively particularly m p n p specifies the degree of uncertainty that the given ca behaviour can be recognized as support or non support let s i p and s i q be two arbitrary principal ship status data d s i p s i q is defined as the actual distance between the two positions d c p a s i p s i q is the expected dcpa of the two ship and t c p a s i p s i q is the corresponding tcpa particularly if the two ship status data indicate that the vessels are departing from each other i e no tendency of moving closer d c p a s i p s i q and t c p a s i p s i q are both assigned with a large number m e g m 2 10 let λ 0 λ 1 be a deterministic weighted parameter several definitions are illustrated as follows definition 1 the spatial closeness factor c l s i p s i q between s i p and s i q is the weighted average of d s i p s i q and d c p a s i p s i q which is denoted as follows 4 cl s i p s i q λ d s i p s i q 1 λ dcpa s i p s i q definition 2 given a pair of two ship status data rsp s i p s i q and psp s i 1 p r s i 1 q r the predicted ca manoeuvring spatial gain factor pre camsg of ship p towards ship q in the time interval t i t i 1 is given by 5 pre g d p q t i t i 1 c l s i 1 p r s i 1 q r c l s i p s i q the predicted ca manoeuvring temporal gain factor pre camtg of ship p towards ship q in the time interval t i t i 1 is given by 6 pre g t p q t i t i 1 t c p a s i 1 p r s i 1 q r t c p a s i p s i q when ship p is os p r s i 1 i p r s i 1 r pre camsg and pre camtg describe the degree of compliance between the predicted status and the ca behaviour of current moment in terms of space and time with the information available at time t i the dst theory is applied to pre camsg and pre camtg to quantify the spatial and temporal evidence and information fusion the same method will be used in the posterior data finally dst will be used to quantify the deviation between the predicted and observed data according to dst the basic bpa curves can be labelled as the m p m n p and m p n p curves with the constraint m p m n p m p n p 1 the curves are given by the following functions and the related parameters let 7 f 0 x α β 1 exp x α β 2 α x 0 α x be the benchmark function the carves are defined as follows m p f 1 x f 0 1 5 x 0 6 0 7 m n p f 2 x f 0 2 1 5 x 0 6 0 7 m n p p f 3 x 1 f 1 x f 2 x it should be noted that the function construction can be subject to modifications according to the practical situation 2 observation measurement by observation measurement the factual status is examined and compared with the prediction the analysis framework is analogous to that of the prediction measurement except that the focused status pair is rsp s i 1 p s i 1 q in t i 1 instead of psp s i 1 p r s i 1 q r which is to be studied against s i p s i q consequently a counterpart definition of definition 2 is denoted as follows definition 3 given the two ship status data pairs s i p s i q s i 1 p s i 1 q the observed ca manoeuvring spatial gain factor obs camsg of ship p towards ship q in the time interval t i t i 1 is given by 8 obs g d p q t i t i 1 c l s i 1 p s i 1 q c l s i p s i q the observed ca manoeuvring temporal gain factor obs camtg of ship p towards ship q in the time interval t i t i 1 is given by 9 obs g t p q t i t i 1 t c p a s i 1 p s i 1 q t c p a s i p s i q with the obs camsg and obs camtg the remaining computing process can follow the route of the prediction case 4 2 6 discrepancy between prediction and observation the discrepancy between the prediction measurement and the observation measurement is necessary to measure the accuracy of the cal inference the distance between the two bodies of evidence is applied to find a quantitative method to describe the discrepancy definition 4 let 10 e ˆ p q i 1 m ˆ p q i 1 p m ˆ p q i 1 n p m ˆ p q i 1 n p p be the prediction measurement of ship p towards ship q at time t i 1 11 e p q i 1 m p q i 1 p m p q i 1 n p m p q i 1 n p p be the corresponding observation measurement let e ˆ p q s i 1 m ˆ p q s i 1 p m ˆ p q s i 1 n p m ˆ p q s i 1 n p p be the pre camsg based evidence of ship p towards ship q at time t i 1 and e ˆ p q t i 1 m ˆ p q t i 1 p m ˆ p q t i 1 n p m ˆ p q t i 1 n p p be the pre camtg based evidence of ship p towards ship q at time t i 1 then the integrated prediction evidence of ship p towards ship q at time t i 1 can be expressed by 12 e ˆ p q i 1 e ˆ p q s i 1 e ˆ p q t i 1 the integrated observation evidence of ship p towards ship q at time t i 1 can be calculated in a similar way 13 e p q i 1 e p q s i 1 e p q t i 1 the discrepancy between prediction and observation of ship p towards ship q at time t i 1 is the distance between e ˆ p q i 1 and e p q i 1 denoted by d p q i 1 14 d p q i 1 1 2 e ˆ p q i 1 e p q i 1 d e ˆ p q i 1 e p q i 1 t 1 2 where d 1 0 1 2 0 1 1 2 1 2 1 2 1 4 2 7 alg 4 combination of prediction and observation at each decision loop the prediction and the observation measurement are both formulated as a body of evidence combined with their spatial and temporal components thus the discrepancy between the prediction and observation reflect the limitations of one ship s perception of the other ship on the other hand one ship s next behaviour manoeuvring may be somehow unexpected to the others at the current step which will result in a certain amount of deviation from the original estimation as a ship s ca decision will be affected by more than one ships in the multi ship encounter situations the decision must be made in the interest of all ships to ensure safety by following eq 4 eq 14 the discrepancy between prediction and observation of ship p towards ship q at time t i 1 can be calculated now that alg 4 is delineated the cal is therefore inferred and then be called by the main algorithm alg 1 line 9 of table 2 5 case studies 5 1 encounter scenario setup in this section the effectiveness of the oipd method for multi ship ca is tested by simulation firstly a typical four ship encounter situation is constructed as the multi ship ca scenario the initial status includes positions speeds and course angles of the involved ships which is listed in table 4 all the initial state set of ships keeps the same from simulation scenario 1 simulation scenario 3 while some initial set of scenario 4 is different with scenario 1 3 fig 5 illustrates the initial status of the scenario 1 3 with the above settings if the ships do not take proper ca measures they will collide at point a after 1000s all of the simulation results are presented by time dependent motion sequences the algorithm has been coded and simulated in matlab firstly it is useful to try to analyse the encounter situation according to colregs from s1 s perspective s2 and s3 is the stand on ship and s1 should give way to them while s1 is the stand on ship towards s4 if s1 complies with colregs it should pass the encounter region from the fore of s4 and from the aft of s2 and s3 as the crossing angle between s1 and s2 is large whereas the angle between s1 and s3 are small the decision made by s1 should be different when avoiding the collision from s2 or s3 in the following subsections this scenario setting will be used to verify the algorithm s performance when it is applied to ships with different compliance of the colregs the effectiveness of the inference of ts s cal will also be verified under the same scenario setting 5 2 simulation scenario 1 in scenario 1 every ship is supposed to comply with colregs and take actions proactively all the ships cal will be 1 gw towards the tss which appear at the starboard and os will cross the encounter scenario from the aft of ts the positions at several typical time points and the historical trajectories from beginning in simulation scenario 1 are presented in fig 6 the dcpa and instantaneous distance of all four ships during the entire ca manoeuvre are shown in fig 7 in which the z folds are the curves of dcpa and the parabolic are the curves of distance according to figs 6 and 7 every involved ship finally infers tss cal correctly and avoids the collision successfully s1 and s3 are crossing from aft region of s2 s2 is crossing from aft region of s4 and s4 is crossing from behind of s1 all the ca behaviour is consistent with colregs in order to see the oipd method performance in a more specific way some details on ships decisions inference and manoeuvres are shown in table 5 including number of times of decision making moment of taking action s turning angle deg period of staying on the new angle s percentage of initial speed and shortest distance ts and moment according to the data s1 makes the initial decision at 621s which include turning 30 to starboard and reduced the speed to 50 of the initial speed due to the initial position and the decision cycle the decision time of each ship is different the decision of s4 is the latest and its first decision occurred at t 815s which include turning 30 to starboard it should be noted that in order to make the magnitude of the change of ships state as small as possible the steering angle within the single decision for all ships is set to a maximum of 30 the time of the steering is maintained for a maximum of 600s finally all ships manage to avoid collisions by turning to starboard 30 during the ca manoeuvre process the highest risky situation occurred at 1603s when the distance between s2 and s3 is 2342 1m considering the setting of 300m of ship length this distance is safe enough fig 7 illustrates the decision making process from another perspective moreover the data under the case that decision made without inference is simulated as a control group depicted by dashed lines as there is no cal change during the ca manoeuvre both ca process with and without inference are successful the difference between the two cases is mainly due to the different time and status of situation 5 3 simulation scenario 2 during the navigation it is possible that the oow violates the regulation of colregs or made inappropriate decision due to human failures or organisational factors an oow may make wrong decisions due to different understanding of situation or being unaware of regulations in this subsection another scenario is studied where s1 follows the opposite of the regulations of colregs to make an unexpected ca decision in this circumstance other ships have to discover this condition in time and respond accordingly according to the requirements of colregs ships must communicate with each other at first and make reasonable decisions through communication however in the case of this paper each ship needs to infer ts s cal and to judge the abnormality of ts the results of ship decisions and manoeuvre are shown in fig 8 the dcpa and instantaneous distance of all ships are shown in fig 9 it can be seen that all ships successfully avoid the collisions the details of ships decisions and inference are shown in table 6 s1 is especially set to make decision without inferring the behaviour of other ships when all ships enter the encounter region their initial decisions are based entirely on the current state of other ships in this step the decision is the same as table 5 except s1 whose decision is the opposite the second decision of s1 is at the end of the first turn i e at t 1221s when it makes a new decision to keep the current turn based on the situation at the time since s4 has not detected the additional collision risks and the cal changes it maintains the initial decision until it passes the encounter region s2 recognizes the abnormality of s1 at t 1824s and t 1855s and subsequently changes its decisions however it should be noted that although there have been 8 changes of s2 s cal only two moments t 1824s and t 1855s are directly related to itself for other situations s2 maintains the old decision based on the situation s3 makes a new decision because of the cal change of s2 after t 1855s in fact s1 s decision makes it depart the central area where collisions might occur from the beginning therefore its ad hoc decision helps to reduce the risk of collision when there is an out of control ship wu et al 2018 in the encounter scenario the proposed scheme has more flexibility to cope with the situation 5 4 simulation scenario 3 for ship collision avoidance scenarios an out of control ship is more dangerous than decision or manoeuvring errors in this simulation s1 is supposed to keep navigating on its initial speed and course angle without considering other ships the planned trajectories are shown in fig 10 in which the closest situation is shown in the subfigure of t 1500s additionally dcpa and instantaneous distance of all ships are shown in fig 11 the detailed information of ships decision and inference is shown in table 7 even this encounter scenario is much more complex than scenario 1 and 2 all ships pass the region successfully the overall process of ca is similar to that of scenario 2 at the beginning all ships make decisions according to normal conditions and then an abnormality of s1 is identified compared with scenario 1 fig 6 s2 and s4 find the uncommon manoeuvre of s1 at t 1220s the resulting chain reaction is that s3 subsequently makes a decision to continue to turn 30 at t 1225s in such a complicated situation it is very difficult to find an abnormality and make a decision without communication therefore in this scenario the highest risky situation occurs at t 1463s when the distance between s1 and s2 is 950m although the two ships are almost parallel in the course it is still an undesirable situation in this case it is not enough to make decisions only based on the current situation without the cal inference according to fig 11 s1 and s2 collide without inferring ts s cal 5 5 simulation scenario 4 the ca process of the entire scenario 4 can be divided into two stages the first phase only involves s1 and s2 at the beginning s1 and s2 both detect the collision risk and made ca decision respectively according to colregs s1 should give way to s2 and s2 should keep its speed and course however regardless of s1 or s2 there is an additional collision risk with the other two ships if s2 continues to maintain its speed and course it does not reduce the risk of collision with s3 or s4 therefore for s2 the most appropriate ca decision is to turn left at 600s after s1 and s2 make first ca decisions the new encounter situation prompts all four ships to enter new ca stage according to the colregs s4 should be the give way ship of s2 therefore s4 turns right to keep clear and avoid s2 meanwhile s2 infers the ca intention of s4 and then turns left from the original right turn course to match the ca manoeuvre of s4 as all ships continue to move each one experiences an iterative ca inference process with other ships during the entire ca process the cal of s2 has been changed 5 times which is higher than that of the other 3 ships this is because s2 is the closest to the centre of the region and the encounter situation with other ships is very pressing and not easy to handle it can be illustrated in fig 14 that the ca route of s2 is the most tortuous the ca decisions of the other three vessels are more stable although s3 also changes ca decisions for 8 times the first five decision alterations are only changed the time of keeping on the new course which can be seen in table 8 the ca process of the entire scenario 4 can be divided into two stages the first phase only involves s1 and s2 at the beginning s1 and s2 both detect the collision risk and made ca decision respectively according to colregs s1 should give way to s2 and s2 should keep its speed and course however regardless of s1 or s2 there is an additional collision risk with the other two ships if s2 continues to maintain its speed and course it does not reduce the risk of collision with s3 or s4 therefore for s2 the most appropriate ca decision is to turn left fig 12 at 600s after s1 and s2 make the first ca decisions the new encounter situation prompts all four ships to enter new ca stage according to the colregs s4 should be the give way ship of s2 therefore s4 turns right to keep clear and avoid s2 meanwhile s2 infers the ca intention of s4 and then turns left from the original right turn course to match the ca manoeuvre of s4 as all ships continue to move each one experiences an iterative ca inference process with other ships during the entire ca process the cal of s2 has been changed 5 times which is higher than that of the other 3 ships this is because s2 is the closest to the centre of the region and the encounter situation with other ships is very pressing and not easy to handle it can be illustrated in fig 14 that the ca route of s2 is the most tortuous the ca decisions of the other three vessels are more stable although s3 also changes ca decisions for 8 times the first five decision alterations are only changed the time of keeping on the new course which can be seen in table 8 5 6 estimation of the efficiency of algorithm performance in the previous four subsections the proposed ca algorithm is verified in 4 different scenarios it can be illustrated from the simulation experiments that the algorithm is effective for most ca scenarios meanwhile as most of the prior algorithms in the literature assumed the mutual understanding of the decision made by the ships involved it is hard to compare the proposed algorithm with the traditional ca schemes therefore in this subsection the data envelopment analysis dea method is used to further quantitatively evaluate the efficiency of the ca performance of the proposed algorithm fig 13 dea is widely used to estimate the efficiency of the performance of the multi input and multi output system wu et al 2015 used this method to evaluate the effectiveness of maritime safety control measures in this subsection each ship is regarded as a decision making union dmu of dea method and the inputs and outputs of dmus are depicted in fig 14 the inputs of dmus include the basic elements that can describe the complexity of the current encounter scenario including 1 spatial urgency factor expressed by dcpa the shortest initial dcpa of each ship can be found in table 4 2 temporal urgency factor expressed by tcpa which can be found in table 4 3 scenario complexity for different scenarios the number of involved ships and the category of encounter scenario determine the complexity of ca decision making for instance if there are several ships in an overtaking scenario like the simulation scenario 4 of section 5 5 the ca decision making will be more complexity than the scenarios with only crossing encounter situation involved the scenario complexity parameter c i d e a can be calculated as c i d e a n when the os needs to deal with the crossing encounter situation with n tss while when there are k tss that in over taking or heading situations with os c i d e a 2 k n k 4 compliance with colregs as a widely accepted international regulation colregs is the most important reference for ca decision making if there is a ship who deviates from the colregs other ships are supposed to detect this trace based on its behaviour and change their decisions accordingly this kind of cases can be found in simulation scenario 2 section 5 3 and 3 section 5 4 when there are k tss that do not comply the colregs the scenario compliance parameter o i d e a can be calculated as o i d e a 3 k while if all tss are obedient the colregs o i d e a 1 the outputs of dmus include the elements that can describe the performance and results of the ca decision making of all involved ships all the output information can be obtained in the results table of each simulation scenario which include 1 safety performance factor the closest distance between os and tss is used to evaluate the safety performance of ca decision making which can be achieved from the result table of each scenario 2 operational performance factor all ca decisions need to be achieved through the ca manoeuvre to cross the encounter region safely the success of the ca decision making does not mean the whole process of ca is successful there are many practical factors that restrict the performance of the ca therefore in order to ensure the success of collision avoidance the decision results should be clear and the number of changes should be reduced as much as possible in the operational performance factor the number of decision changes is defined as an important indicator the fewer times the decision is changed the higher the operability of the ca decision is operational performance factor of every ship can be achieved from the result table of each scenario dea method measures the ca decision and manoeuvre performance of a set of dmus which are the involved ships in this paper these dmus transform a vector of inputs x i x 1 x 2 x 3 x 4 t i 1 2 3 4 into a vector of outputs y i y 1 y 2 y 3 t i 1 2 3 4 by using the proposed ca decision method then all dmus in a scenario form a data matrix x y in which x x 1 x 2 x 3 x 4 and y y 1 y 2 y 3 y 4 based on x y the problem of determining the efficiency of decision making is transformed into an optimal solution of linear programming due to the different concerns the method for solving the optimal solution is also slightly different for instance for dmu i ccr model focuses on solving the following linear programming problem min θ λ θ subject to θ x i x λ y λ y i λ 0 by applying three basic dea models the efficiency of the decision making performance of each ship can be calculated which is depicted in fig 15 in the dea models higher efficiency scores usually indicate better performance when the efficiency score is 1 it is called dea efficiency which means that the relative performance of the input and output is ideal ccr bcc and additive dea are basic and widely used dea models the efficiency estimated by the ccr model comprises technical efficiency and scale efficiency which is called the gross efficiency of a dmu while the bcc model only estimates the technical efficiency and the additive dea model is another technical efficiency to evaluate the model in this section fig 15 illustrates that although the efficiency scores are different in different dea evaluation methods all the indicators show that the dmu decision is efficiency the performance efficiency of the dmu in scenario 4 is inferior to that of scenarios 1 to 3 which is consistent with the complexity of scenario 4 it is worth noting that the performance of the proposed scheme depends on the adjustment of some key parameters particularly the evidence theory based discrepancy d p q i 1 between prediction and observation which can be calculated by eq 14 in section 4 2 6 is sensitive to the determination of successive cals in the simulation tests the threshold parameter d 0 of the evidence discrepancy is adopted by repeated trials which has a critical impact on the performance of ca decision making however in most cases an empiric value of d 0 can be accepted as a useable value 6 discussion and conclusions this paper proposes a distributed ca decision support formulation based on the inference of objective s intention every ship makes decisions from its own perspective and only considers keeping itself safe during the decision making process moreover no communication between the involved ships is granted which is mostly the real world case the information available to each ship is limited to the observable status of the target ships the proposed ca scheme not only predicts the status of the tss in the near future but also infers their ca intensions so that the os can make decisions in response the proposed oipd gives an approach by introducing an iterative decision making procedure the observation of ship status is the beginning of each decision cycle the update of the current information will be compared with the previous prediction using the evidence theory according to the discrepancy between observation and prediction the inference can be confirmed or modified then the new inference is employed to form the decision of os and prediction of tss the objective of the method is to provide the decision support to deal with complicated ship encounter situations the method can also act as a part of autonomous ca system in the unmanned ship system three different typical ca scenarios are simulated for case studies to verify the performance of the proposed method all the involved ships are set to comply with colregs in the first scenario in the second scenario one ship is set to behave exactly the opposite of the requirements of colregs in the last scenario one ship is set to keep on moving without regarding of other ships all ships do not know the intention of other ships in advance and make decisions at the very beginning according to the os s pre set judgements as time elapses a reasonable ca decision is made by inferring the cal of the rational target ships except for the tss with deliberately fixed routes the results of simulation indicate that all the ships have effectively inferred tss cal and made corresponding ca decisions and manoeuvrability all the ships finally cross the encounter region safely it can be concluded that this method can be used to estimate the ship s intention effectively without communication it should be noted that the proposed multi ship ca decision making scheme may be sensitive to some key parameters in some extreme cases in which repeated conflict decisions can cause low convergence of the scheme for instance a large value of the evidence discrepancy threshold parameter may result in unresponsiveness to the cal changes of other ships making intention inference less meaningful on the other hand a small value of this parameter may lead to a sensitive intention inference and a capricious change of the ca decisions in such cases the inferred intention of a ts suffers from constant changes during the ca process giving rise to the chaos of intention inference and the delayed ca decision making furthermore the proposed scheme presently does not take the environmental impact factors including visibility wind and current into consideration but actually these factors not only affect the regular perception and manoeuvrability of the involved ships but also influence the efficiency of the intention inference of the scheme like many other ca schemes in the literature the proposed scheme provides a feasible and programmed decision making algorithm yet how to turn the scheme into tangible devices is left to be further investigated from the engineering perspective especially for the traditional manned ship compared to prior work on the multi ship collision avoidance problem the current work focuses on the autonomous distributed ca scheme by programmed decision making as the unmanned surface vehicles usv or autonomous navigation is acutely envisioned in the previous literature the proposed scheme is also applicable to complex usv collision avoidance scenario where no ca protocols are developed author contribution study conception and design yang wang tengfei wang qing wu data collection analysis and interpolation tengfei wang jinfen zhang analysis and interpretation of results tengfei wang yang wang bing wu draft manuscript preparation tengfei wang yang wang declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement the research presented in this paper is co sponsored by china national key research and development plan project task no 2018yfc0810400 05 the fundamental research funds for the central universities wut 2019iii002gx international cooperation and exchange of the national natural science foundation of china grant no 51920105014 international cooperation technical innovation project of hubei province under grant 2018ahb003 the first author would like to thank the china scholarship council csc and the fundamental research funds for the central universities grant no whut2017 yb 035 for this research 
22142,steel lazy wave riser slwr which is a kind of ultra deepwater riser system is a slender structure with length of over 2 000m the shape design of the slwr is very important for operational stability of the slwr because the slwr has strong structural characteristics and are affected by various ocean environmental loads in this research the simulation based design process is studied to find the optimal shape of slwr at the installation first available parameters and responses are derived and the dynamic characteristics of them were analyzed to select the effective parameters on the responses using multibody dynamic simulation second the simulation based design framework for shape design of the slwr was developed using opensource based pido process integration and design optimization software and developed dynamic simulation model finally the shape design of the slwr at the installation was performed using the developed design framework keywords steel lazy wave riser in ultra deepwater depth installation shape buoyancy module multibody dynamics design optimization 1 introduction offshore riser systems are used for transportation of underwater resources such as oil gas and minerals in the ocean these riser systems are slender structures with wide range of lengths from a few meters to a few thousand meters a riser having length of 2 000m or more among these riser systems is referred to as an ultra deepwater riser wang and duan 2015 although the shape design of riser with high slenderness ratio is important researches on installation and operation of the riser are also very important the ultra deepwater riser has various installation shapes and configurations such as lazy wave and steep wave as shown in fig 1 depending on the environment conditions of the sea area to be installed and operational objectives of the riser system a buoyant material that can artificially generate positive buoyancy is used for particular installation shapes of the riser system shape design and verification of the riser having buoyant materials are very important for the installation of steel risers with lazy wave configuration due to the high bending stiffness of the material and the complex installation shape such as s shape it is most accurate that the determination and verification of the shape to install the ultra deepwater riser such as steel lazy wave riser is carried out through actual field tests however the field tests are difficult to perform because they are expensive and dangerous to tackle the problem simulation based engineering techniques are being used in the ships and ocean engineering research and industries fields altosole et al 2009 etras and yilmaz 2014 especially since offshore structures such as risers are affected by complex dynamic loads such as wave force structural rigidity and fluid resistance dynamic simulations are more effective than static simulations for numerical experiments similar to the actual for this reason dynamic simulation based design and verification techniques have been actively studied in the offshore industry cha et al 2010 ku et al 2014 wang et al 2015 also various numeric methods such as riser mathematical modeling techniques and riser behavior analysis method considering the marine environment have been studied in addition to kinetic studies hong 1992 atadan et al 1997 jung et al 2012 park et al 2015 oh et al 2015 fig 2 the ultra deepwater risers are modular equipment connected system between many unit risers and buoyant modules in various methods therefore effect analysis of the parameters related with the risers and buoyant materials such as the influence on the riser connection type and the buoyant material fastening is very important in the configuration design stage however existing studies are mainly concerned with the structural evaluation behavior analysis and modal analysis of the riser system or the flow analysis of oil and gas after installation lee et al 2015 wang et al 2018 researches about the effect analysis of parameters for the shape design considering these dynamic effects were very small therefore we analyzed the influence of the design parameters for dynamic performance of the steel lazy wave riser slwr in the ultra deepwater riser systems using multibody dynamics and effective design variables were derived based on the results of the influence analysis a simulation based design framework was developed for the optimal configuration for installation of the slwr using screened design variables in this paper we discussed the research results of this study 2 dynamic simulation model of slwr 2 1 dynamic simulation method all mechanical systems are composed as an assembly of many objects this assembly has been called a multi body multi body solutions are different from general dynamic solutions multi body solutions must find dynamic responses of each object and exact solutions must be obtained by applying components which are in correlation each body is defined to calculate the dynamic responses of a multi body oh et al 2014 especially large structures such as risers are greatly affected by changes in inertial forces due to behavior of structures so it is very important to examine the influence by the change of inertial forces the analysis technique that can consider this inertia force is only possible with multibody dynamics a nonlinear dynamic analysis method for these reason multibody dynamics was adopted as a numerical method in this study multibody dynamics models for the slwr are developed by daful dims as shown in fig 3 which is the korean commercial software for the marine mechanical system analysis in general orcaflex is a typical analysis tool for riser analysis however orcaflex is a commercial analysis tool based on finite elements so it does not take into account the secondary inertia force caused by behavior and takes longer to analyze than using rigid beams daful dims provides both rigid beam based analysis and finite element based analysis so that models can be selectively developed according to the research purpose these beam element methods had been verified through comparison of beam analysis solution between rigid beam method and finite element method virtual motion inc 2018a b the analysis model consists of the structure of euler and timoshenko beam elements oh et al 2014 as eq 1 and the marine environment forces as eq 2 such as current drag force added mass and buoyancy in each element 1 f e l e m e n t k d e l 0 c d e where the parameters of k and c are stiffness and damping matrices respectively d e is reformed length and angle l 0 is unreformed length and angle and d e is velocity 2 f h y d r o m a a c a v v c v v f b where the parameters of m a c a v and c v are added mass coefficient wave damping coefficient and drag coefficient respectively the vectors of a and v are acceleration and velocity of body the force of f b is buoyancy force of body current represents the magnitude of the velocity in underwater the currents have just one direction which is a direction of inertia reference frame the current defines a body velocity at the center of mass in each body for the static and dynamics analysis of a system the specified current velocity is applied on all body types drag force added mass and buoyancy are calculated by each coefficients body velocities body accelerations body volumes and required parameters these are applied to system as vector forces for fluid resistances fossen 2002 2 2 development of slwr simulation model in this study the slwr simulation model was developed using the specifications in table 1 presented by ruan et al 2016 this slwr model was used to compare the developed in house riser analysis method with the commercial riser analysis software orcaflex it is also a general slwr model that has been used for verification in recent papers oh et al 2018 fig 4 shows the developed dynamic model of the slwr using daful dims the dynamic model consists of a catenary region that is seated on the seabed a buoyancy region that is equipped with buoyant materials to make s shape and a suspended region that is connected vertically from the mother ship the total length of the dynamic model is 3170 m assembled by 1200 m catenary risers 370 m buoyant risers and 1600 m suspended risers we compared the simulation results of the slwr dynamic model with the results of ruan et al 2016 in order to evaluate the reliability of the developed dynamic model table 2 shows the simulation results of the developed daful dims model orcaflex model and ruan s model errors within 0 5 occurred in the main responses of the slwr analysis such as touchdown position top tension and bottom tension as a result of the review the error was caused by the difference in the stiffness representation method of the seabed ground model the simple stiffness method was used for the seabed ground in the orcaflex and ruan s models but daful dims model used the soil interaction method of bode in order to avoid the error caused by the seabed model we used the truncated slwr model centering on the buoyancy region in the installation shape design of the slwr because the riser region that determines the s shape is important in the installation shape design of the slwr also the truncated model improves the analysis speed and can give quickly design results because the model is simplified the truncated slwr model as shown in fig 5 consists of a total of 450m including the buoyancy region and 30 risers are connected the riser connection model used stiffness force this model can consider the fastening forces such as bolting and welding effects at both ends of the truncated slwr the measured loads were applied from the analysis results of the full scale model to simulate the weight and tension of the cut section also the buoyant material model was applied from the 18th riser to the 27th riser among the total 30 risers to study the design of the installation shape 3 character analysis of design variables using dynamic simulation it is very important to analyze the independency between design parameters in the shape design of the slwr because there are factors that greatly affect the characteristics of the riser buoyant material system depending on the variation of the variable values the installation shape changes greatly according to the design value due to the influence of these factors the design variables were analyzed through the main response characteristics of the slwr system such as the applied loads at the riser connector the curvature values to evaluate the characteristics of the s shape and the eigenvalue of the slwr system as shown in table 3 in particular the s shape coefficient represents the safety impact of the slwr when it has s shape when the slwr is installed underwater the relationship between seg bend and hog bend in fig 4 a is a very important installation design factor li and nguyen 2010 proved through studies that the bending loads acting on the seg and hog bend must be the same for fatigue stability of the risers since the change of bending load affects the bending curvature the same bending load means that the bending curvature is the same therefore the closer the s shape coefficient is to zero the higher safety impact of the slwr and the stable operation is possible the parameters for the design of the slwr are classified into design variables of the riser buoyant material system and the buoyant material itself therefore the system variables and the buoyant variables are discussed respectively 3 1 dynamic effect analysis of design variables for installation shape of slwr design values in the slwr system are determined by api rp 111 regulation according to the usage of environment and purpose so there are only variables related to the riser connection and the buoyant material able to determine the shape configuration of the slwr variables related to the riser connection are a weight of the riser connector and a riser joint stiffness significant parameters related to the buoyant materials are buoyancy arrangement on the risers and magnitude of positive buoyancy of the buoyant material therefore four variables for shape design of the slwr system defined as the effective variables design boundary of variables and case study on the significance of each variable effect performed using the developed dynamic slwr model as shown in table 4 and we analyzed the responses by cases and estimated the effect of variables in case 1 it was analyzed that the installation method of the buoyant material is a concentrated arrangement and a distributed arrangement types the concentrated arrangement method uses a buoyant material with high positive buoyancy at certain position of the riser several buoyant materials with small positive buoyancy are uniformly installed on the riser in the distributed arrangement type table 5 shows the simulation results depending on the arrangement types of the buoyant materials according to the results the responses of the concentrated arrangement and the distribution arrangement types were slightly different also it is analyzed that the concentrated type is more efficient for installation of slwr because s shape coefficient of the concentrated type is closer to zero than the coefficient of the other type although the difference in the coefficient responses is numerically shown the arrangement type of the buoyant material is not an effective design variable because it is not a large difference as shown in fig 6 in case 2 the influence of the positive buoyancy force was evaluated a default buoyancy magnitude mounted on the riser was 7 5 tonf the variation of the parameter was from 5 25 tonf to 9 75 tonf which means variation with 30 of default value and totally 5 cases are evaluated whether the parameter significant or not as shown in table 4 table 6 shows the simulation results depending on the buoyancy magnitude change according to the results the change of buoyancy magnitude had a large change in all responses except frequency domain responses it can be seen that the riser shape has changed greatly as shown in fig 7 specially the s shape coefficient tended to be close to zero as the positive buoyancy increased and tended to be greater than zero again above a certain value fig 8 shows schematized some results of case 2 in fig 8 the top tension tended to decrease linearly as the buoyancy magnitude increases because the total riser underwater weight is reduced however the bottom tension and the s shape coefficient had non linear characteristics it means that buoyancy magnitude of 5 25 tonf 30 variation is not enough buoyancy for slwr installation and buoyancy magnitude of 30 is excessive buoyancy for slwr installation this non linear characteristic also means that the design of the buoyancy magnitude has an optimal point within parameter boundary therefore the buoyancy magnitude is a major effective variable for the shape design of the slwr in case 3 the influence of the riser connector weight was evaluated table 7 and fig 9 show the simulation results depending on changes of the riser connector weight as the results the response characteristics changed linearly with the change of the connector weight especially it is analyzed that small connector weight is more efficient for installation of slwr because the s shape coefficient moves away from zero as the connector weight increase also the mode frequencies were changed because the total mass of the slwr system changed with the variation of the riser connector weight however the change of the mode frequencies was very small because the connector weight was very small compared to the total mass of the slwr system in case 4 the influence of the connector stiffness was evaluated table 8 shows the simulation results depending on changes of the connector stiffness as the results the parameter connector stiffness is not the significant parameter for shape design of the slwr within parameter boundary this means that if the riser connecting force is applied sufficiently the dynamic responses of the slwr system are not affected therefore the riser connector stiffness is not a valid variable 3 2 dynamic effect analysis of design variables for buoyant material shape it is possible to influence the behavior of the slwr system depending on the size of the buoyant material despite having the same positive buoyancy because the fluid resistance varies with the size change of the buoyant material the buoyant material mounted on the riser is generally cylindrical as shown in fig 10 a therefore the shape design parameters of the buoyant material can be defined as shown in fig 10 b the correlation equation between the shape of the buoyant material and the positive buoyancy fb is expressed as eq 3 it means that if the necessary positive buoyancy magnitude is determined the shape of the buoyant material can be designed using eq 3 3 f b ρ f l u i d v m b ρ f l u i d d o u t e r 2 2 d i n n e r 2 2 π l m b where ρ fluid is the density of fluid v is the volume of the buoyancy material m b is the mass of the buoyancy material d outer and d inner are the outer and inner diameters of the buoyancy material l is the length of buoyancy material in the shape design step of the buoyant material in slwr d outer and l are design variables because specs of the riser fluid environment and magnitude of positive buoyancy are determined therefore we applied the buoyant material model with 2 variable parameters in the developed slwr dynamic model as shown in table 9 also since the buoyant material has the same cylinder shape as the riser added mass and drag coefficients of the buoyant material have the same values as the riser s coefficients in order to evaluate the influence of the shape design variables of the buoyant material the parameter boundary condition and the analysis case were defined like table 10 the responses were derived by applying each variable values to the same developed slwr dynamic model and we analyzed the responses and estimated the effect of variables in case 1 the effect of diameter d outer change of buoyant material was evaluated in case 2 the effect of length l change of buoyant material was evaluated in case 3 the effects of diameter and length variation were evaluated when the current 1 m s with larger fluid resistance was generated table 11 shows the simulation results of the evaluation of the effect in case 1 2 and 3 as the results as the d outer increased the s shape coefficient become to zero the response was not significantly affected by l change in the presence of current as the d outer increased the s shape coefficient was close to zero therefore the d outer change among the shape design parameters of the buoyant material influences the dynamic behavior of the slwr however it does not have a large effect on the responses of the slwr because the effect was very small so the shape design parameters of the buoyant material cannot be a valid variable 4 optimal design method for installation shape design of slwr we evaluated the dynamic effects of the several design parameters for the installation shape design of the slwr as the results the positive buoyancy magnitude of the buoyant material was the most dominant effective parameter for the installation shape design in addition to the development of the simulation model of the slwr and the determination of the design variables it is necessary to develop an optimal design framework to develop an interface method between the framework and the simulation model and a design formulation for the optimal design for the installation shape optimization of the slwr the design formulation for the installation shape design utilized the effect evaluation results of the design variables simulation based design optimization design framework for the slwr was developed through the interface with the developed simulation model using a software integration framework 4 1 design framework the software integration framework used to develop the design framework is rce as shown in fig 11 made by dlr in germany rce is a development tool that enables easy integration of various analysis programs analysis models algorithms software and computing tools oh et al 2016a therefore we can perform easily to develop the simulation based design framework through interface studies of various analysis and simulation tools using the rce also rce uses the dakota package which is a reliable optimization design algorithm so we can develop and verify easily the simulation based optimal design process for installation shape design of slwr an interface method between the simulation model of the slwr and rce should be developed for the installation shape design of the slwr using rce the simulation model was linked to rce using jython script because rce is java based development tool fig 12 shows the developed interface script between rce and slwr simulation model the interface script included interworking of parameterized input output variables in the simulation model and batch run of the simulation model 4 2 design formulation for the optimal design it is necessary to define object functions which means the goal of the optimal design constraints affecting design such as environmental conditions and operation conditions and boundary of design variables table 12 shows the results of the defined design formulation for the installation shape optimization of the slwr in this design the design purpose is to minimize the number of available buoyant materials which is able to reduce the cost due to expensive buoyant materials so each riser used in the installation is defined as the presence or absence of buoyant materials on the riser the buoyant materials can deform the outer shape but the magnitude of the positive buoyancy is determined due to the difficulty of the manufacturing process therefore in this study the optimal design was performed by applying two positive buoyancy 7 5 tonf 3 75 tonf using the developed design framework the defined design constraints are the s shape coefficient representing the safety impact of the s shape reviewed in chapter 3 and the available number of buoyant materials although the value of the s shape coefficient is good to be zero it is difficult to be zero due to the characteristics of the dynamic responses of the riser so 5 m which is 1 of the total length is defined as the maximum boundary condition value 4 3 optimal design results the algorithm used for the optimal design is genetic algorithm in dakota package genetic algorithms are global optimization algorithms that searches several solutions simultaneously based on natural selection and evolutionary ideas of genetics it is effective to use global optimization algorithm to shape design of the slwr because the design variables are very many and discrete variables consisting of 0 and 1 table 13 shows the results of the optimal installation configuration of the slwr using buoyant material with positive buoyancy of 7 5 tonf the optimal solution was derived by performing simulation based optimization of 553 iterations fig 13 a shows the optimal installation shape of the slwr the optimal number of buoyant material was 8 which satisfied both constraints 1 and 2 these 8 buoyant materials were mounted at the 19th 1 ea 20th 1 ea 21st 1 ea 22nd 2 ea 23rd 1 ea 24th 1 ea and 26th 1 ea risers from the 18th to 27th riser table 14 shows the results of the optimal installation configuration of the slwr using buoyant material with positive buoyancy of 3 75 tonf the optimal solution was derived by performing simulation based optimization of 552 iterations fig 13 b shows the optimal installation shape of the slwr the optimal number of buoyant material was 16 which satisfied both constraints 1 and 2 these 16 buoyant materials were mounted at the 19th 2 ea 21st 4 ea 22nd 1 ea 23rd 3 ea 24th 2 ea 25th 1 ea 26th 1 ea and 27th 1 ea risers from the 18th to 27th riser according to the optimum design results the total positive buoyancy used to design the installation shape of the slwr was equal to 60 0 tonf when using buoyant materials of 7 5 tonf 8 ea and 3 75 tonf 16 ea although the total positive buoyancy was the same and the ratio of the available buoyant materials was linear the positions where the buoyant materials were mounted were non linear this means that even if the total positive buoyancy is the same the installation position changes randomly when the positive buoyancy of a buoyant material is different therefore the result of the installation shape design is changed when the specifications of the buoyant material to be used is changed find x i minimize number of buoyant material subject to s shape coefficient 5 0 s shape coefficient 0 0 number of buoyant material 20 number of buoyant material 1 x 0 or 1 where x x1 x2 xi i the number of installed buoyant material xk has discrete value 3 75 7 5 tonf 5 conclusion in this study we have analyzed effects of available parameters for the slwr shape design using multibody dynamics simulation technique and developed design framework for shape design according to the results of the effect analysis the positive buoyancy magnitude of the buoyant material and the weight of the riser connector were the effective parameters affecting the dynamic behavior of the slwr especially the change of the positive buoyancy magnitude had non linear response characteristics and has more influence on the dynamic behavior than the other available parameters therefore the positive buoyant magnitude is selected in the most significant parameter for the shape design of the slwr the significant parameter was used in the shape design of the slwr the design framework was developed by an integrated software framework rce genetic algorithm the multibody dynamics simulation model of the slwr and the derived design formulation we performed the optimal shape design of the slwr by applying two types of buoyant materials with different positive buoyancy using the developed design framework as the results the change of the positive buoyancy of the buoyant material and the optimum number of buoyant material had linear relationship but the variation of the positive buoyancy and the arrangement of the buoyant materials had non linear relationship this means that the installation design results may change if the buoyant material specifications are changed even if the necessary total positive buoyancy is the same also the optimization design technique derives different optimal solutions depending on the characteristics and the variable values of the optimization algorithm in particular the design time and results may change if the parameter values of the genetic algorithm are changed because the genetic algorithm is a global optimization algorithm that uses random search method oh et al 2016b in oh s study even if the same simulation model was used the number of iterations and the optimal solutions were changed according to the change of the parameter values of the genetic algorithm therefore we plan to study suitable optimization method for the optimum installation shape design of the slwr through the application of various optimization algorithms author contribution jaewon oh first author conceptualization methodology software writing original draft formal analysis dongho jung funding acquisition hyungwoo kim writing review editing investigation cheonhong min data curation validation su gil cho corresponding author supervision resources project administration declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement the authors are grateful for the full support shown for this research work this research was supported by a grant from endowment project of development of core engineering technology for steel lazy wave riser to develop oil and gas in ultra deep water pes3060 funded by korea research institute of ships and ocean engineering 
22142,steel lazy wave riser slwr which is a kind of ultra deepwater riser system is a slender structure with length of over 2 000m the shape design of the slwr is very important for operational stability of the slwr because the slwr has strong structural characteristics and are affected by various ocean environmental loads in this research the simulation based design process is studied to find the optimal shape of slwr at the installation first available parameters and responses are derived and the dynamic characteristics of them were analyzed to select the effective parameters on the responses using multibody dynamic simulation second the simulation based design framework for shape design of the slwr was developed using opensource based pido process integration and design optimization software and developed dynamic simulation model finally the shape design of the slwr at the installation was performed using the developed design framework keywords steel lazy wave riser in ultra deepwater depth installation shape buoyancy module multibody dynamics design optimization 1 introduction offshore riser systems are used for transportation of underwater resources such as oil gas and minerals in the ocean these riser systems are slender structures with wide range of lengths from a few meters to a few thousand meters a riser having length of 2 000m or more among these riser systems is referred to as an ultra deepwater riser wang and duan 2015 although the shape design of riser with high slenderness ratio is important researches on installation and operation of the riser are also very important the ultra deepwater riser has various installation shapes and configurations such as lazy wave and steep wave as shown in fig 1 depending on the environment conditions of the sea area to be installed and operational objectives of the riser system a buoyant material that can artificially generate positive buoyancy is used for particular installation shapes of the riser system shape design and verification of the riser having buoyant materials are very important for the installation of steel risers with lazy wave configuration due to the high bending stiffness of the material and the complex installation shape such as s shape it is most accurate that the determination and verification of the shape to install the ultra deepwater riser such as steel lazy wave riser is carried out through actual field tests however the field tests are difficult to perform because they are expensive and dangerous to tackle the problem simulation based engineering techniques are being used in the ships and ocean engineering research and industries fields altosole et al 2009 etras and yilmaz 2014 especially since offshore structures such as risers are affected by complex dynamic loads such as wave force structural rigidity and fluid resistance dynamic simulations are more effective than static simulations for numerical experiments similar to the actual for this reason dynamic simulation based design and verification techniques have been actively studied in the offshore industry cha et al 2010 ku et al 2014 wang et al 2015 also various numeric methods such as riser mathematical modeling techniques and riser behavior analysis method considering the marine environment have been studied in addition to kinetic studies hong 1992 atadan et al 1997 jung et al 2012 park et al 2015 oh et al 2015 fig 2 the ultra deepwater risers are modular equipment connected system between many unit risers and buoyant modules in various methods therefore effect analysis of the parameters related with the risers and buoyant materials such as the influence on the riser connection type and the buoyant material fastening is very important in the configuration design stage however existing studies are mainly concerned with the structural evaluation behavior analysis and modal analysis of the riser system or the flow analysis of oil and gas after installation lee et al 2015 wang et al 2018 researches about the effect analysis of parameters for the shape design considering these dynamic effects were very small therefore we analyzed the influence of the design parameters for dynamic performance of the steel lazy wave riser slwr in the ultra deepwater riser systems using multibody dynamics and effective design variables were derived based on the results of the influence analysis a simulation based design framework was developed for the optimal configuration for installation of the slwr using screened design variables in this paper we discussed the research results of this study 2 dynamic simulation model of slwr 2 1 dynamic simulation method all mechanical systems are composed as an assembly of many objects this assembly has been called a multi body multi body solutions are different from general dynamic solutions multi body solutions must find dynamic responses of each object and exact solutions must be obtained by applying components which are in correlation each body is defined to calculate the dynamic responses of a multi body oh et al 2014 especially large structures such as risers are greatly affected by changes in inertial forces due to behavior of structures so it is very important to examine the influence by the change of inertial forces the analysis technique that can consider this inertia force is only possible with multibody dynamics a nonlinear dynamic analysis method for these reason multibody dynamics was adopted as a numerical method in this study multibody dynamics models for the slwr are developed by daful dims as shown in fig 3 which is the korean commercial software for the marine mechanical system analysis in general orcaflex is a typical analysis tool for riser analysis however orcaflex is a commercial analysis tool based on finite elements so it does not take into account the secondary inertia force caused by behavior and takes longer to analyze than using rigid beams daful dims provides both rigid beam based analysis and finite element based analysis so that models can be selectively developed according to the research purpose these beam element methods had been verified through comparison of beam analysis solution between rigid beam method and finite element method virtual motion inc 2018a b the analysis model consists of the structure of euler and timoshenko beam elements oh et al 2014 as eq 1 and the marine environment forces as eq 2 such as current drag force added mass and buoyancy in each element 1 f e l e m e n t k d e l 0 c d e where the parameters of k and c are stiffness and damping matrices respectively d e is reformed length and angle l 0 is unreformed length and angle and d e is velocity 2 f h y d r o m a a c a v v c v v f b where the parameters of m a c a v and c v are added mass coefficient wave damping coefficient and drag coefficient respectively the vectors of a and v are acceleration and velocity of body the force of f b is buoyancy force of body current represents the magnitude of the velocity in underwater the currents have just one direction which is a direction of inertia reference frame the current defines a body velocity at the center of mass in each body for the static and dynamics analysis of a system the specified current velocity is applied on all body types drag force added mass and buoyancy are calculated by each coefficients body velocities body accelerations body volumes and required parameters these are applied to system as vector forces for fluid resistances fossen 2002 2 2 development of slwr simulation model in this study the slwr simulation model was developed using the specifications in table 1 presented by ruan et al 2016 this slwr model was used to compare the developed in house riser analysis method with the commercial riser analysis software orcaflex it is also a general slwr model that has been used for verification in recent papers oh et al 2018 fig 4 shows the developed dynamic model of the slwr using daful dims the dynamic model consists of a catenary region that is seated on the seabed a buoyancy region that is equipped with buoyant materials to make s shape and a suspended region that is connected vertically from the mother ship the total length of the dynamic model is 3170 m assembled by 1200 m catenary risers 370 m buoyant risers and 1600 m suspended risers we compared the simulation results of the slwr dynamic model with the results of ruan et al 2016 in order to evaluate the reliability of the developed dynamic model table 2 shows the simulation results of the developed daful dims model orcaflex model and ruan s model errors within 0 5 occurred in the main responses of the slwr analysis such as touchdown position top tension and bottom tension as a result of the review the error was caused by the difference in the stiffness representation method of the seabed ground model the simple stiffness method was used for the seabed ground in the orcaflex and ruan s models but daful dims model used the soil interaction method of bode in order to avoid the error caused by the seabed model we used the truncated slwr model centering on the buoyancy region in the installation shape design of the slwr because the riser region that determines the s shape is important in the installation shape design of the slwr also the truncated model improves the analysis speed and can give quickly design results because the model is simplified the truncated slwr model as shown in fig 5 consists of a total of 450m including the buoyancy region and 30 risers are connected the riser connection model used stiffness force this model can consider the fastening forces such as bolting and welding effects at both ends of the truncated slwr the measured loads were applied from the analysis results of the full scale model to simulate the weight and tension of the cut section also the buoyant material model was applied from the 18th riser to the 27th riser among the total 30 risers to study the design of the installation shape 3 character analysis of design variables using dynamic simulation it is very important to analyze the independency between design parameters in the shape design of the slwr because there are factors that greatly affect the characteristics of the riser buoyant material system depending on the variation of the variable values the installation shape changes greatly according to the design value due to the influence of these factors the design variables were analyzed through the main response characteristics of the slwr system such as the applied loads at the riser connector the curvature values to evaluate the characteristics of the s shape and the eigenvalue of the slwr system as shown in table 3 in particular the s shape coefficient represents the safety impact of the slwr when it has s shape when the slwr is installed underwater the relationship between seg bend and hog bend in fig 4 a is a very important installation design factor li and nguyen 2010 proved through studies that the bending loads acting on the seg and hog bend must be the same for fatigue stability of the risers since the change of bending load affects the bending curvature the same bending load means that the bending curvature is the same therefore the closer the s shape coefficient is to zero the higher safety impact of the slwr and the stable operation is possible the parameters for the design of the slwr are classified into design variables of the riser buoyant material system and the buoyant material itself therefore the system variables and the buoyant variables are discussed respectively 3 1 dynamic effect analysis of design variables for installation shape of slwr design values in the slwr system are determined by api rp 111 regulation according to the usage of environment and purpose so there are only variables related to the riser connection and the buoyant material able to determine the shape configuration of the slwr variables related to the riser connection are a weight of the riser connector and a riser joint stiffness significant parameters related to the buoyant materials are buoyancy arrangement on the risers and magnitude of positive buoyancy of the buoyant material therefore four variables for shape design of the slwr system defined as the effective variables design boundary of variables and case study on the significance of each variable effect performed using the developed dynamic slwr model as shown in table 4 and we analyzed the responses by cases and estimated the effect of variables in case 1 it was analyzed that the installation method of the buoyant material is a concentrated arrangement and a distributed arrangement types the concentrated arrangement method uses a buoyant material with high positive buoyancy at certain position of the riser several buoyant materials with small positive buoyancy are uniformly installed on the riser in the distributed arrangement type table 5 shows the simulation results depending on the arrangement types of the buoyant materials according to the results the responses of the concentrated arrangement and the distribution arrangement types were slightly different also it is analyzed that the concentrated type is more efficient for installation of slwr because s shape coefficient of the concentrated type is closer to zero than the coefficient of the other type although the difference in the coefficient responses is numerically shown the arrangement type of the buoyant material is not an effective design variable because it is not a large difference as shown in fig 6 in case 2 the influence of the positive buoyancy force was evaluated a default buoyancy magnitude mounted on the riser was 7 5 tonf the variation of the parameter was from 5 25 tonf to 9 75 tonf which means variation with 30 of default value and totally 5 cases are evaluated whether the parameter significant or not as shown in table 4 table 6 shows the simulation results depending on the buoyancy magnitude change according to the results the change of buoyancy magnitude had a large change in all responses except frequency domain responses it can be seen that the riser shape has changed greatly as shown in fig 7 specially the s shape coefficient tended to be close to zero as the positive buoyancy increased and tended to be greater than zero again above a certain value fig 8 shows schematized some results of case 2 in fig 8 the top tension tended to decrease linearly as the buoyancy magnitude increases because the total riser underwater weight is reduced however the bottom tension and the s shape coefficient had non linear characteristics it means that buoyancy magnitude of 5 25 tonf 30 variation is not enough buoyancy for slwr installation and buoyancy magnitude of 30 is excessive buoyancy for slwr installation this non linear characteristic also means that the design of the buoyancy magnitude has an optimal point within parameter boundary therefore the buoyancy magnitude is a major effective variable for the shape design of the slwr in case 3 the influence of the riser connector weight was evaluated table 7 and fig 9 show the simulation results depending on changes of the riser connector weight as the results the response characteristics changed linearly with the change of the connector weight especially it is analyzed that small connector weight is more efficient for installation of slwr because the s shape coefficient moves away from zero as the connector weight increase also the mode frequencies were changed because the total mass of the slwr system changed with the variation of the riser connector weight however the change of the mode frequencies was very small because the connector weight was very small compared to the total mass of the slwr system in case 4 the influence of the connector stiffness was evaluated table 8 shows the simulation results depending on changes of the connector stiffness as the results the parameter connector stiffness is not the significant parameter for shape design of the slwr within parameter boundary this means that if the riser connecting force is applied sufficiently the dynamic responses of the slwr system are not affected therefore the riser connector stiffness is not a valid variable 3 2 dynamic effect analysis of design variables for buoyant material shape it is possible to influence the behavior of the slwr system depending on the size of the buoyant material despite having the same positive buoyancy because the fluid resistance varies with the size change of the buoyant material the buoyant material mounted on the riser is generally cylindrical as shown in fig 10 a therefore the shape design parameters of the buoyant material can be defined as shown in fig 10 b the correlation equation between the shape of the buoyant material and the positive buoyancy fb is expressed as eq 3 it means that if the necessary positive buoyancy magnitude is determined the shape of the buoyant material can be designed using eq 3 3 f b ρ f l u i d v m b ρ f l u i d d o u t e r 2 2 d i n n e r 2 2 π l m b where ρ fluid is the density of fluid v is the volume of the buoyancy material m b is the mass of the buoyancy material d outer and d inner are the outer and inner diameters of the buoyancy material l is the length of buoyancy material in the shape design step of the buoyant material in slwr d outer and l are design variables because specs of the riser fluid environment and magnitude of positive buoyancy are determined therefore we applied the buoyant material model with 2 variable parameters in the developed slwr dynamic model as shown in table 9 also since the buoyant material has the same cylinder shape as the riser added mass and drag coefficients of the buoyant material have the same values as the riser s coefficients in order to evaluate the influence of the shape design variables of the buoyant material the parameter boundary condition and the analysis case were defined like table 10 the responses were derived by applying each variable values to the same developed slwr dynamic model and we analyzed the responses and estimated the effect of variables in case 1 the effect of diameter d outer change of buoyant material was evaluated in case 2 the effect of length l change of buoyant material was evaluated in case 3 the effects of diameter and length variation were evaluated when the current 1 m s with larger fluid resistance was generated table 11 shows the simulation results of the evaluation of the effect in case 1 2 and 3 as the results as the d outer increased the s shape coefficient become to zero the response was not significantly affected by l change in the presence of current as the d outer increased the s shape coefficient was close to zero therefore the d outer change among the shape design parameters of the buoyant material influences the dynamic behavior of the slwr however it does not have a large effect on the responses of the slwr because the effect was very small so the shape design parameters of the buoyant material cannot be a valid variable 4 optimal design method for installation shape design of slwr we evaluated the dynamic effects of the several design parameters for the installation shape design of the slwr as the results the positive buoyancy magnitude of the buoyant material was the most dominant effective parameter for the installation shape design in addition to the development of the simulation model of the slwr and the determination of the design variables it is necessary to develop an optimal design framework to develop an interface method between the framework and the simulation model and a design formulation for the optimal design for the installation shape optimization of the slwr the design formulation for the installation shape design utilized the effect evaluation results of the design variables simulation based design optimization design framework for the slwr was developed through the interface with the developed simulation model using a software integration framework 4 1 design framework the software integration framework used to develop the design framework is rce as shown in fig 11 made by dlr in germany rce is a development tool that enables easy integration of various analysis programs analysis models algorithms software and computing tools oh et al 2016a therefore we can perform easily to develop the simulation based design framework through interface studies of various analysis and simulation tools using the rce also rce uses the dakota package which is a reliable optimization design algorithm so we can develop and verify easily the simulation based optimal design process for installation shape design of slwr an interface method between the simulation model of the slwr and rce should be developed for the installation shape design of the slwr using rce the simulation model was linked to rce using jython script because rce is java based development tool fig 12 shows the developed interface script between rce and slwr simulation model the interface script included interworking of parameterized input output variables in the simulation model and batch run of the simulation model 4 2 design formulation for the optimal design it is necessary to define object functions which means the goal of the optimal design constraints affecting design such as environmental conditions and operation conditions and boundary of design variables table 12 shows the results of the defined design formulation for the installation shape optimization of the slwr in this design the design purpose is to minimize the number of available buoyant materials which is able to reduce the cost due to expensive buoyant materials so each riser used in the installation is defined as the presence or absence of buoyant materials on the riser the buoyant materials can deform the outer shape but the magnitude of the positive buoyancy is determined due to the difficulty of the manufacturing process therefore in this study the optimal design was performed by applying two positive buoyancy 7 5 tonf 3 75 tonf using the developed design framework the defined design constraints are the s shape coefficient representing the safety impact of the s shape reviewed in chapter 3 and the available number of buoyant materials although the value of the s shape coefficient is good to be zero it is difficult to be zero due to the characteristics of the dynamic responses of the riser so 5 m which is 1 of the total length is defined as the maximum boundary condition value 4 3 optimal design results the algorithm used for the optimal design is genetic algorithm in dakota package genetic algorithms are global optimization algorithms that searches several solutions simultaneously based on natural selection and evolutionary ideas of genetics it is effective to use global optimization algorithm to shape design of the slwr because the design variables are very many and discrete variables consisting of 0 and 1 table 13 shows the results of the optimal installation configuration of the slwr using buoyant material with positive buoyancy of 7 5 tonf the optimal solution was derived by performing simulation based optimization of 553 iterations fig 13 a shows the optimal installation shape of the slwr the optimal number of buoyant material was 8 which satisfied both constraints 1 and 2 these 8 buoyant materials were mounted at the 19th 1 ea 20th 1 ea 21st 1 ea 22nd 2 ea 23rd 1 ea 24th 1 ea and 26th 1 ea risers from the 18th to 27th riser table 14 shows the results of the optimal installation configuration of the slwr using buoyant material with positive buoyancy of 3 75 tonf the optimal solution was derived by performing simulation based optimization of 552 iterations fig 13 b shows the optimal installation shape of the slwr the optimal number of buoyant material was 16 which satisfied both constraints 1 and 2 these 16 buoyant materials were mounted at the 19th 2 ea 21st 4 ea 22nd 1 ea 23rd 3 ea 24th 2 ea 25th 1 ea 26th 1 ea and 27th 1 ea risers from the 18th to 27th riser according to the optimum design results the total positive buoyancy used to design the installation shape of the slwr was equal to 60 0 tonf when using buoyant materials of 7 5 tonf 8 ea and 3 75 tonf 16 ea although the total positive buoyancy was the same and the ratio of the available buoyant materials was linear the positions where the buoyant materials were mounted were non linear this means that even if the total positive buoyancy is the same the installation position changes randomly when the positive buoyancy of a buoyant material is different therefore the result of the installation shape design is changed when the specifications of the buoyant material to be used is changed find x i minimize number of buoyant material subject to s shape coefficient 5 0 s shape coefficient 0 0 number of buoyant material 20 number of buoyant material 1 x 0 or 1 where x x1 x2 xi i the number of installed buoyant material xk has discrete value 3 75 7 5 tonf 5 conclusion in this study we have analyzed effects of available parameters for the slwr shape design using multibody dynamics simulation technique and developed design framework for shape design according to the results of the effect analysis the positive buoyancy magnitude of the buoyant material and the weight of the riser connector were the effective parameters affecting the dynamic behavior of the slwr especially the change of the positive buoyancy magnitude had non linear response characteristics and has more influence on the dynamic behavior than the other available parameters therefore the positive buoyant magnitude is selected in the most significant parameter for the shape design of the slwr the significant parameter was used in the shape design of the slwr the design framework was developed by an integrated software framework rce genetic algorithm the multibody dynamics simulation model of the slwr and the derived design formulation we performed the optimal shape design of the slwr by applying two types of buoyant materials with different positive buoyancy using the developed design framework as the results the change of the positive buoyancy of the buoyant material and the optimum number of buoyant material had linear relationship but the variation of the positive buoyancy and the arrangement of the buoyant materials had non linear relationship this means that the installation design results may change if the buoyant material specifications are changed even if the necessary total positive buoyancy is the same also the optimization design technique derives different optimal solutions depending on the characteristics and the variable values of the optimization algorithm in particular the design time and results may change if the parameter values of the genetic algorithm are changed because the genetic algorithm is a global optimization algorithm that uses random search method oh et al 2016b in oh s study even if the same simulation model was used the number of iterations and the optimal solutions were changed according to the change of the parameter values of the genetic algorithm therefore we plan to study suitable optimization method for the optimum installation shape design of the slwr through the application of various optimization algorithms author contribution jaewon oh first author conceptualization methodology software writing original draft formal analysis dongho jung funding acquisition hyungwoo kim writing review editing investigation cheonhong min data curation validation su gil cho corresponding author supervision resources project administration declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement the authors are grateful for the full support shown for this research work this research was supported by a grant from endowment project of development of core engineering technology for steel lazy wave riser to develop oil and gas in ultra deep water pes3060 funded by korea research institute of ships and ocean engineering 
22143,the calculation method of the hydrodynamic force on twin column pier receives less concerns although this kind of pier has been widely used in real practice the three dimensional twin column deep water pier is simplified as a two dimensional twin column model and water is assumed to be irrotational inviscid and incompressible the analytical solution of hydrodynamic force on twin columns is deduced and the calculation equations of the hydrodynamic forces on one column of the twin columns are founded based on the calculation equations of single column by introducing the added mass modified coefficients h x and h y commercial software ansys fluent is employed to validate the analytical solution comparison between the analytical and numerical methods show the analytical solution agree well with the numerical solution the influences of variables i e reynolds number keulegan carpenter number polar angle and relative center distance are discussed analytically and numerically as well as the generating mechanism of the lift force a case study of hydrodynamic force on a real bridge under earthquake shows the proposed calculation solution is not only concise in expression form but also with good precision and high calculation efficiency which exhibits a high application value in real practice keywords hydrodynamic force twin column pier deep water bridge earthquake calculation method added mass coefficient 1 introduction a large number of deep water bridges have been built in china in recent years which are mainly located in china southeastern coasts and western reservoirs these regions are at high risk of earthquake i e the southeastern coasts are located in the circum pacific seismic belt while the western mountainous areas are located in the mediterranean himalayan seismic zone under seismic excitation the hydrodynamic pressure introduces a significant influence on the dynamic characteristics and dynamic responses of the bridge even worse may aggravate the damage of the bridge under earthquakes for example the miaoziping bridge near the city of chengdu china was damaged by the 2008 sichuan earthquake mw 7 9 whose main piers are approximately 100 m tall and with 46 m submerged in water the interaction between structure and water under seismic excitation has attracted the attentions of many experts and scholars among which the added mass hydrodynamic pressure of a single pier vibrating in still water have been studied analytically and extensively in order to obtain a relatively simple mathematical model it is often required that the shape of the structure section is regular and the structure vibrates as a rigid body also some assumptions are necessary i e water is irrotational inviscid and incompressible westergaard and williamson 1933 first proposed the added mass method in his study the hydrodynamic pressure generated by water on dam surface was solved based on the assumptions that structure was rigid and the water was incompressible and the seismic excitation could be decomposed into a series of harmonic loads penzien and kaul 1972 proposed a stochastic analysis method for the interaction between offshore structures and fluid under strong earthquakes liaw and chopra 1974 presented the expression of the hydrodynamic pressure of a cylindrical cantilever structure under simple harmonic excitation and pointed out that the compressibility of water could be neglected lindgren 1984 applied morison equation to calculate the hydrodynamic pressure of a cylinder under seismic excitation tanaka and hudspeth 1988 worked out the eigen function solutions of the hydrodynamic pressure acting on a cylinder with finite depth in compressible fluid under seismic excitation and further discussed the relationship between the dynamic characteristics of rigid or flexible structures and fluid compressibility sun and nogami 1991 proposed a semi analytical and semi numerical method based on complete and non singular trefftz function set which can accurately describe the hydrodynamic pressure of axisymmetric structures under horizontal seismic excitation han and xu 1996 presented the theoretical model of the added mass generated by a cylinder vibrating in a kind of fluid medium based on the radiation wave theory and fluid element in software ansys li and yang 2013 presented the expressions of added mass of circular and square piers by curve fitting du et al 2014 proposed a more accurate simplified formula for hydrodynamic pressure based on radiation wave theory by introducing dimensionless parameters such as frequency ratio width depth ratio and relative height etc wang et al 2018 proposed a method for calculating the additional mass of a conical cylinder with arbitrary cross section by using the finite element method zhang et al 2019 deduced the formula for the additional mass of a single column with arbitrary cross section under horizontal seismic excitation in addition to the analytical method based on the radiation wave theory experiments were also conducted by some scholars to study the in line force and lift force characteristics of a single cylinder vibrating in still water meanwhile with the improvement of computer performance and the development of cfd computational fluid dynamics software numerical methods have also been favored by a large number of scholars mcconnell and park 1982 drove a cylinder to make sinusoidal motion in still water and the resulting in line force lift force and dynamic response of the cylinder were measured and analyzed dütsch et al 1998 used experimental and numerical methods to investigate the drag force lift force and flow filed of the vibrating circular cylinder three cases with different reynolds number re u m a x d ν in which u m a x ν and d represent respectively the maximum velocity of cylinder kinematic viscosity of water and cylinder diameter and different keulegan carpenter number kc 2 π a d in which a is amplitude of vibrating i e the cases of re 100 kc 5 re 200 kc 10 re 210 and kc 6 williamson 1985 experimentally studied the correlation between drag coefficient c d and kc number the correlation between lift coefficient c l and kc number in which kc 0 35 zheng and dalton 1999 used numerical method to study drag force coefficient and lift force coefficient of a cylinder and a square cylinder with kc 1 5 in oscillating fluid ghozlani et al 2012 analyzed the flow fields of vibrating circular cylinder and square prism with re 100 and kc 5 generally the cases with relatively smaller reynolds number and small kc number are concerned in above studies however the reynolds number and kc number relating to the flow field induced by vibration of bridge pier under earthquake are different from those have been widely studied the form of the substructure of deep water bridge is diverse e g a single column pier twin column pier multi column pier or assemble structure composed of pile group pile cap and pier for example the piers of the approach spans of miaoziping bridge of yunyang yangtze river bridge of qinggangzui dadu river bridge of sucunba dadu river bridge etc in china etc are twin column piers the components of the substructures always have large dimensions such as pile diameter can reach 4 m pier diameter can reach 10 m and pile cap diameter can reach tens of meters while ordinarily the vibration amplitude of the bridge under seismic excitation can reach only tens of centimeters at most the ratio of vibration amplitude to the size of pile pier or pile cap is relatively small in other words the flow filed generated by the movement of the substructure of the deep water bridge under earthquake can be characterized as large reynolds number and small kc number i e re 10 6 kc 0 8 approximately yang et al 2017 found that under the actual seismic excitations there are no vortexes or vortex street in the flow field around a single cylindrical pier the inertial force dominates and the flow field characteristics are similar as that introduced by a cylinder vibrating in an ideal fluid as mentioned before the twin column pier or multi column pier are widely used in real practice the flow field motivated by the synchronous multi column is different from the flow field motivated by a single column which leads to the hydrodynamic force on one of multi column is different from that on the single column in other words the hydrodynamic force calculation equation for single column cannot be used for the column in the multi column pier any more however to the best of our knowledge few studies have been carried out to investigate the calculation method of hydrodynamic force on column of multi column pier vibrating in still water under earthquake although there are some studies focus on the interaction between wave and multiple columns for example bonakdar and oumeraci 2015 studied the interaction between regular waves and pile groups through experiments zheng et al 2019 studied the interaction between wave and multiple suspended floating cylinders with arbitrary cross section in which similar analysis and calculation methods may be employed but the calculation method of wave force on piles is different from that of hydrodynamic force on piles oscillating in still water in this study the calculation method of hydrodynamic force on one column of the twin columns under earthquake is investigated the circular columns are selected as research object as they are the most widely used components of the substructure of deep water bridge in real practice firstly the solution conception and deduction process of hydrodynamic force calculation formula for a single column is described briefly and based on which the analytical calculation formula of hydrodynamic force on one column of the twin columns is deduced then the cfd method is used to validate the analytical calculation formulas and the influencing parameters of the added mass modified coefficients are discussed finally an application of the calculation method to a real bridge is conducted to compare the accuracy and efficiency of the proposed calculation method 2 analytical solution 2 1 basic assumptions in real practice the submerged depth of substructure is considerably large e g 46 m for the miaoziping bridge yang et al 2017 168 m for the mangjiedu bridge yang 2012 etc which is much larger than the dimension of the pier and also is extremely larger than the wave height generated by the vibrating pier under earthquake therefore it is reasonable to simplify the three dimensional column water coupling system in real practice as a two dimensional cylinder water coupling model assuming the interactions between cylinder and water are the same at different water depths studies by yang et al 2017 show that complex seismic waves can be decomposed into a series of monochromatic simple harmonic waves to analyze the hydrodynamic pressure on bridge piers therefore simple harmonic waves are used in the deduction process of analytical solution and cfd validation while a real three dimensional twin column pier and a real seismic wave are employed in the application section to verify the applicability of the suggested calculation method in addition water is assumed to be irrotational inviscid and incompressible 2 2 analytical solution of hydrodynamic force on a single column as the deduction of hydrodynamic force formulae for the twin columns is based on the hydrodynamic force formulae of a single column therefore the analytical solution deduction process of hydrodynamic force on a single column is reviewed briefly both the polar coordinate system and the cartesian coordinate system will be used in the following deduction process so the column c1 is placed at the origins of above two coordinate systems shown in fig 1 a and fig 1 b respectively in which r 1 is the radius of c1 θ is polar angle and the polar axis direction is consistent with the x axis direction the harmonic wave propagates along the polar axis or x axis so the column c1 moves back and forth along the polar axis or x axis under the excitation of a harmonic wave with amplitude a angular frequency ω the displacement s and the velocity u of the column can be expressed as 1 s a cos ω t 2 u a ω sin ω t accordingly the velocity potential φ 1 generated by the motion of column is 3 φ 1 ϕ 1 x y cos ω t ϕ 1 r θ cos ω t ϕ 1 satisfies the laplace equation and can be written in polar coordinate system as 4 1 r r r ϕ 1 r 1 r 2 2 ϕ 1 θ 2 0 under boundary conditions the eq 4 can be solved by using the variable separation approach then the velocity potentials ϕ 1 and φ 1 can be expressed shown in eq 5 the detailed deduction process could be found in article by li and yang 2013 omitted here for brevity 5 ϕ 1 r 1 2 a ω cos θ r r 1 2 a ω x x 2 y 2 φ 1 r 1 2 a ω cos θ r cos ω t r 1 2 a ω x x 2 y 2 cos ω t furthermore the velocity and acceleration at any position in polar coordinate system and in cartesian coordinate system can be derived based on eq 5 shown in eq 6 and eq 7 respectively 6 u x y t y 2 x 2 x 2 y 2 2 r 1 2 a ω cos ω t v x y t 2 x y x 2 y 2 2 r 1 2 a ω c o s ω t 7 u x y t x 2 y 2 x 2 y 2 2 r 1 2 a ω 2 sin ω t v x y t 2 x y x 2 y 2 2 r 1 2 a ω 2 sin ω t in which u and u are respectively the velocity and acceleration in the polar axis or in x direction v and v are respectively the velocity and acceleration in the direction perpendicular to polar axis or in y direction substituting eq 5 into the linearized bernoulli equation then the hydrodynamic pressure p can be obtained by integrating pressure p with respect to θ the hydrodynamic forces acting on single column in polar coordinate system can be obtained 8 f x cos ω t 0 2 π p r 1 θ r 1 cos θ d θ a ρ r 1 2 ω 2 π cos ω t f y cos ω t 0 2 π p r 1 θ r 1 sin θ d θ 9 f x m u f y 0 in which m ρ π r 1 2 is the mass of water with the volume same as that displaced by the column f x and f y are the force components in the direction of the polar axis i e in the x direction and in the direction perpendicular to the polar axis i e in the y direction hereinafter f x and f y are also named in line force and lift force respectively 2 3 analytical solution of hydrodynamic force on one column of the twin columns the arrangements of the twin columns c1 and c2 in polar coordinate system and cartesian coordinate system are shown in fig 2 a and fig 2 b respectively r 1 and r 2 are respectively the radii of c1 and c2 θ is polar angle θ 0 is the specific angle between the polar axis and the line connecting the centers of the twin columns l is the distance between the centers of the twin columns l 1 l cos θ 0 and l 2 l sin θ 0 are the projection lengths of l on x axis and y axis respectively similarly the harmonic wave with amplitude a and circular frequency ω propagates along the polar axis or x axis therefore the twin columns moves back and forth synchronously along the polar axis or x axis the relative position of the twin columns in fig 2 are depicted by the distance between the center distance l and the angle θ 0 theoretically r 1 r 2 l and 0 θ 0 2 π change of angle θ 0 equates the rotation of column c2 around the center of column c1 which always keeps still in this study shown in fig 2 b due to the geometric symmetry and kinematic symmetry the analytical deduction process of the hydrodynamic force on columns c1 and c2 in the first quadrant i e 0 θ 0 π 2 is the same as that when they are in the second third and fourth quadrants i e π 2 θ 0 2 π therefore θ 0 varies from 0 to π 2 in this study now setting φ 1 as the velocity potential caused by the vibration of c1 without considering the influence of c2 setting φ 2 as the velocity potential caused by c2 without considering the influence of c1 namely both of c1 and c2 are treated as a separated single column according to eq 5 we have 10 φ 1 r 1 2 a ω cos θ r cos ω t r 1 2 a ω x x 2 y 2 cos ω t 11 φ 2 r 2 2 a ω r cos θ l cos θ 0 r 2 l 2 2 r l cos θ θ 0 cos ω t r 2 2 a ω x l 1 x l 1 2 y l 2 2 cos ω t then assuming c1 to keep stationary and c2 to vibrate the radiation velocity potential at the position of c1 generated by the vibration of c2 is φ 21 ϕ 21 cos ω t in which ϕ 21 also satisfies the laplace equation 12 1 r r r ϕ 21 r 1 r 2 2 ϕ 21 θ 2 0 again the variable separation approach is used 13 ϕ 21 r θ r r θ θ substituting eq 13 into eq 12 yields the equations 14 d 2 θ d θ 2 m 2 θ 0 15 r 2 d 2 r d r 2 r d r d r m 2 r 0 and ϕ 21 satisfies the corresponding boundary conditions i e considering the periodic boundary condition eq 16 16 θ θ θ 2 π θ the solution of eq 14 can be obtained as 17 θ m θ a m cos m θ b m sin m θ m 0 1 2 3 and eq 15 is the typical eulerian ordinary differential equation whose solution is 18 r m r c m r m d m 1 r m m 1 2 3 c d ln r m 0 according to sommerfeld radiation condition eq 19 19 r d r d r i k r 0 r c 0 d 0 c m 0 can be obtained substituting eq 17 and eq 18 into eq 13 the velocity potential ϕ 21 is as follows 20 ϕ 21 r θ m 0 d m a m 1 r m cos m θ b m 1 r m sin m θ m 0 e m 1 r m cos m θ f m 1 r m sin m θ m 0 1 2 3 on the surface of column c1 the velocity potential ϕ 21 should satisfy boundary condition eq 20 namely 21 ϕ 21 r r r 1 ϕ 2 r r r 1 0 then ϕ 21 can be expressed as 22 ϕ 21 m 1 e m 1 r m cos m θ f m 1 r m sin m θ in which e m and f m are as follows 23 e m r 1 m 1 π m π π ϕ 2 r θ r r r 1 cos m θ d θ f m r 1 m 1 π m π π ϕ 2 r θ r r r 1 sin m θ d θ note that the second reflection of velocity potential between c1 and c2 is not considered anymore according to the linear superposition property of velocity potential the total velocity potential φ at any position introduced by the synchronous vibration of the twin columns is 24 φ φ 1 φ 2 φ 21 r 1 2 a ω cos θ r cos ω t r 2 2 a ω r cos θ l cos θ 0 r 2 l 2 2 r l cos θ θ 0 cos ω t m 1 e m 1 r m cos m θ f m 1 r m sin m θ cos ω t substituting eq 24 into the linearized bernoulli equation the hydrodynamic pressure at any position in the flow field can be expressed as 25 p r θ ρ φ t ρ ω ϕ 1 ϕ 2 ϕ 21 sin ω t then by integration the hydrodynamic force components acting on c1 in the polar axis direction and in its perpendicular to the polar axis direction namely x and y directions in the cartesian coordinate system are obtained as 26 f x cos ω t 0 2 π p r 1 θ r 1 cos θ d θ a ρ ω 2 π r 1 2 cos ω t a ρ ω 2 π r 2 2 h x cos ω t m 1 r 2 2 r 1 2 h x u 27 f y cos ω t 0 2 π p r 1 θ r 1 sin θ d θ a ρ ω 2 π r 2 2 h y cos ω t m r 2 2 r 1 2 h y u where u a ω 2 cos ω t is the acceleration of harmonic wave m ρ π r 1 2 is the mass of water with the volume same as that displaced by the column c1 h x and h y are termed as added mass modified coefficients in x and y directions respectively 28 h x 1 π π π f θ cos θ d θ π π g θ cos θ d θ 29 h y 1 π π π f θ sin θ d θ π π g θ sin θ d θ where f θ and g θ are expressed as follows 30 f θ cos θ a a cos θ 2 b sin θ 2 cos θ c cos θ 0 c 2 1 2 c cos θ θ 0 31 g θ ϕ 21 r θ r r r 1 2 a a 2 b 2 1 cos θ 2 a b s i n θ a cos θ 2 b sin θ 2 2 2 c cos θ 0 cos θ c 2 cos θ 2 θ 0 c 2 1 2 c cos θ θ 0 2 in which c l r 1 is defined as the relative distance between the centers of the twin columns a l 1 r 1 and b l 2 r 1 are respectively defined as the relative projection distances in x and y directions in which l 1 and l 2 are defined as the projections of l on x and y axes indicating the horizontal and vertical distances between the centers respectively shown in fig 2 b by further integral operation on eq 28 and eq 29 h x and h y can be simplified as 32 h x 2 cos 2 θ 0 c 2 h y 2 sin 2 θ 0 c 2 eq 32 implies that the added mass modified coefficients h x and h y are only influenced by the relative position of the twin columns i e c and θ 0 in real practice the columns of twin column pier of deep water bridges are always have the same diameter namely r 1 r 2 r then the calculation formulas of hydrodynamic force components can further be simplified as 33 f x m u 1 h x f y m u h y comparison between eq 9 and eq 33 shows that only two added mass modified coefficients are introduced into eq 9 to form the calculation formulae of the hydrodynamic forces on one column of the twin columns which are concise and easy to calculate 3 numerical verification of the analytical solution as discussed in the previous section the added mass modified coefficients h x and h y are just related to the relative position between the twin columns note that this conclusion is obtained based on the assumptions that the fluid is irrotational inviscid and incompressible these assumptions make the analytical analysis simple and viable to access the solutions however the rationality of the assumptions requires further validation and the calculation accuracy require verification researches by scholars such as dütsch et al 1998 williamson 1985 ghozlani et al 2012 show that re and kc number are important parameters affecting the forces exerted on a vibrating cylinder but they are not included in our analytical solutions i e in eq 32 which brings potential risks of error in recent years the cfd software such as ansys fluent which is capable of involving viscosity and vortex computing etc have been widely used to calculate the hydrodynamic forces on structures therefore ansys fluent software will be employed to verify the added mass modified coefficients h x and h y note that in real practice the diameter d of columns in the substructures of deep water bridges is ordinarily 2 4m and the relative distance between the centers of any two columns approximately varies between 4 and 14 for example the column diameter of the twin column piers of the nanchang new bayi bridge in china is 4 m and the distance between the column centers is 18 m therefore d 3 m and c 4 14 m are chosen for the numerical model the statistical analysis of more than 300 seismic waves by yang et al 2017 shows that approximately the amplitude of the seismic wave a 0 1 0 4 m and the main frequency f 0 5 3 hz the amplitude and frequency of the harmonic waves used in the numerical simulation are selected in the above ranges it can be estimated from above data that re 10 6 and kc 0 8 in the following numerical simulations which implies inertial force dominates 3 1 cfd basic equations and the numerical model validation in numerical simulation the navier stokes rans equations are solved by ansys fluent the conservation equations of mass and momentum are 34 u i x i 0 35 u i t u j u j x j 1 ρ p x i μ ρ 2 u i x j x j 1 ρ ρ u i u j x j where i and j represent the direction of cartesian coordinate axis u i denotes the time averaged velocity which is defined as u i 1 δ t t 0 t 0 δ t u i d t u i stands for the pulsating velocity as the definition of u i u i u i and p denotes the time averaged pressure ρ is the density of water and μ is the kinematic viscosity of water in the simulation the dynamic mesh technique is used to reconstruct the numerical mesh due to the small amplitude of the columns the mesh reconstruction in the computational domain does not have a great influence on the quality of the mesh and the accuracy of the calculation can be ensured ansys icem cfd is used to build geometric model and generate mesh in order to reduce the influence of the boundaries of fluid domain on the force exerted on the structure 40 times and 20 times of the diameter of the column are taken along the direction of column motion and perpendicular to the direction of column motion respectively i e the fluid domain is 120 m in length and 60 m in width structural meshes are generated in the fluid domain shown in fig 3 a core regions around the column are set to generate extremely fine meshes as shown in fig 3 b because the velocity gradient and pressure gradient near the column are large the boundary conditions of the column surface and the front back left and right boundaries of computational domain are set as wall and the scalable wall functions are used to simulate the boundary layer effect the k ε rng turbulence model suitable for high reynolds number cases is chosen because the reynolds number in this study is extremely large i e in the range 10 6 10 7 the physical experimental data of a single column vibrating in still water by yang et al 2018 are used to confirm the correctness of modeling method and the related parameters the numerical model has the same dimensions and suffers the same external excitation as the physical experimental model the comparison of the time histories of hydrodynamic forces between the physical experimental model and the numerical model is shown in fig 4 it can be observed that numerical calculation is stable after t 4 s and the two curves coincide well indicating the solution of the present numerical model is trustable 3 2 validation of the numerical model by analytical solution of single column the analytical solution of hydrodynamic force for single column has been widely studied and accepted i e eq 9 as well as the velocity and acceleration equations i e eq 6 and eq 7 respectively therefore these equations are further employed to validate the numerical model set up in section 3 1 the in line force f x on the single column excited by harmonic wave with amplitude a 0 3 m frequency f 1 hz calculated by eq 9 and by ansys fluent are compared in fig 5 note that the amplitude increases gradually from 0 to a in the first four periods in numerical simulation and remains unchanged after the fourth period fig 5 shows the curves of f x by analytical and numerical methods coincide with each other very well and the peak value of f x is about 83 6 kn as to f y the numerical value is extremely close to zero which agrees well with the analytical solution i e zero their comparison is omitted for brevity more harmonic waves with different amplitude and frequency are used to validate the precision of the present numerical model and the relative difference between the analytical and numerical solutions are defined as t f 100 f x a m a x f x n m a x f x n m a x in which f x a m a x and f x n m a x are the peak values of the analytical and numerical solutions respectively the results are shown in table 1 it can be observed that the relative difference is less than 1 indicating that the present numerical model can calculate the hydrodynamic force precisely it s believed that inertial force dominates in above cases as kc 0 8 for all these cases then the parameter most related to the inertial force i e accelerations at points around the column the position of the point is defined as m r θ in which θ 0 π 2 δ θ π 12 r 3 10 5 m δ r 0 3 m are calculated by analytical solution i e eq 7 and compared with the numerical solution by ansys fluent the comparison of the accelerations in x and y directions i e u and v are shown in fig 6 and fig 7 respectively note that the column were suffered the harmonic excitation with a 0 3 m f 1 hz in all the cases figs 6 and 7 show generally the analytical and numerical results agree with each other well except of the values of u when θ π 4 in fig 6 a and values of v when θ π 2 in fig 7 b however with the increase of r the differences between the analytical and numerical values decrease rapidly it can be concluded that the present numerical model can precisely calculate the hydrodynamic force on single column under earthquake as well as the flow field indicating the mesh generation scheme turbulence model boundary conditions etc are correct and is capable enough to provide validation to the analytical solutions of the hydrodynamic force on one of the twin columns under earthquake 3 3 verification of analytical solution for one column of the twin columns when the relative distance c 4 the twin columns arranged in tandem θ 0 0 arranged side by side θ 0 π 2 and arranged in staggered form θ 0 π 4 are selected as three typical cases to validate the analytical solution i e eq 33 fig 8 fig 9 and fig 10 respectively show the comparisons between analytical and numerical solutions of hydrodynamic force time histories generated by the harmonic excitation with a 0 3 m and f 1 hz when θ 0 0 θ 0 π 2 and θ 0 π 4 it can be observed from figs 8 10 that the numerical in line force f x on columns c1 and c2 are the same no matter how θ changes indicating that the interaction between the columns has the same effect on in line force on c1 and c2 and curves of f x obtained numerically almost coincide with the analytical curves after the fourth cycle note that in numerical simulation the harmonic excitation amplitude increases from 0 to a in the first four cycles the peak value of f x on columns c1 and c2 is 74 5 kn when θ 0 0 is 95 7 kn when θ 0 π 2 and is 83 9 kn when θ 0 π 4 which are respectively 10 88 smaller 14 50 and 0 38 larger than that of the single column i e 83 6 kn it can be concluded that the influence introduced by the synchronous vibration of the twin columns on the in line force changes with polar angle θ which cannot be ignored when the twin columns are arranged in tandem θ 0 0 the analytical solutions of lift force f y on columns c1 and c2 are zero seen in eq 33 and the numerical solutions are extremely close to zero i e around 10 7 shown in fig 8 b when θ 0 π 2 the analytical solutions of f y on c1 and c2 are zero but the numerical solutions are not zero in detail the averaged values of f y on c1 and c2 are respectively 0 6 kn and 0 6 kn with the same amplitudes 0 6 kn and the peak value is about 1 70 1 2 kn 89 3 kn of the f x the curves of f y on c1 and c2 are symmetry with x axis shown in fig 9 b in other words when the twin columns arranged side by side vibrates synchronously the flow field produces a pair of lift forces perpendicular to the direction of vibration equal in size and opposite in direction the relationship between the normalized lift forces and the normalized vibrating velocity of the twin columns is shown in fig 11 a demonstrating that the peak values of lift forces on c1 c2 and the peak value of their vibrating velocity occur at the same instant i e at t t 4 and 3 t 4 and as well as the minimum values of the lift forces and the minimum value of the vibrating velocity i e at t 0 and t t 2 fig 11 a implies the lift force is introduced by the relative velocity between water and the vibrating columns fig 11 b and c show the velocity contour and pressure contour at t t 4 when both the lift forces and velocity are at their peaks it can be observed that the flow velocity between the twin columns is slightly larger than that outside left and right sides marked in fig 11 b of the twin columns which introduces slightly smaller pressure on the inner surfaces of the twin columns shown in fig 11 c then the pressure difference on c1 and c2 generates a pair of lift forces equal in size and opposite in direction shown in fig 11 a the frequency of the pressure changes on the inner side surfaces of the twin columns due to the velocity change is twice of the frequency of the velocity shown in fig 11 a because in one period of velocity both the back and forth moving of the column introduces pressure change once that s the reason why the frequency of f y in fig 9 b is twice of the frequency of f x in fig 9 a note that f x is dominated by inertial force i e vibrating acceleration of the twin columns when the polar angle θ 0 π 4 both the curves of the lift force f y on c1 and c2 calculated by the numerical method coincide well with the curve calculated by the analytical method as shown in fig 10 b the peak value ratio of f y to f x 10 6 kn 83 9 kn 1 8 is larger and cannot be ignored comparison between fig 10 a and fig 10 b shows the frequency of f x is basically the same as that of f y which is the frequency of harmonic excitation the reason is explained as follows at the instant t 0 t the in line force f x on the columns c1 and c2 reaches the negative peak value 83 9 kn while the lift f y reaches the positive peak value 10 6 kn at this time the twin columns begin to move forward to the positive direction of x axis and the velocity around the twin columns is small and almost symmetry with their own horizontal centerlines shown in fig 12 a but at this moment the acceleration reaches the maximum and the pressure is positive in front of the column and is negative at the rear shown in fig 12 b in addition the positive pressure in front of c1 is smaller than that in front of c2 and the negative pressure at back of c1 is larger than that at back of c2 which ultimately generate almost the same hydrodynamic forces on c1 and c2 to be more exactly the pressure distribution around the c1 is not symmetrical with their own horizontal centerlines i e the center of the negative pressure at the back of c1 inclines to left and the center of the positive pressure at the front inclines to right the pressure distribution on c2 has the same characteristic with c1 the flow caused by a vibrating column is equivalent to an oscillatory flow around a stationary column note that the pressure on column is mainly generated by relative acceleration of flow to column because the kc number is much small and reynolds number is extremely large the acceleration direction of the flow between the twin columns deviates from x axis generating asymmetric distribution of pressure on the columns and ultimately leads to the inertial forces f on c1 and c2 inclined to x axis shown in fig 12 b essentially the in line force f x and lift force f y are the components of the resultant force f shown in fig 12 that s the reason why the frequency of f y is the same as that of f x which is equal to the frequency of harmonic excitation seen in the hydrodynamic force calculation formula eq 33 when t t 4 the column moves forward along the positive direction of x axis the velocity of the column reaches the maximum but the acceleration is 0 the pressure in the front and behind of the column is positive and almost equal and the pressure on the left and right sides is negative and almost equal too as shown in fig 13 which results in the force components are almost zero i e f x and f y on the column c1 are about 1 0 kn and 0 3 kn respectively 4 parameter analysis of the added mass modified coefficients the main difference of the calculation formulas between the single column and twin columns are the added mass modified coefficients h x and h y as compared between the eq 9 and eq 33 the coefficients h x and h y only include two variables polar angle θ 0 and relative center distance c shown in eq 32 the reynolds number re and kc number which have been found influencing the flow field dramatically have not been included for example dütsch et al 1998 found that when re 100 and kc 5 a pair of stable symmetrical and periodic shedding vortexes generate around the cylinder with two fixed shedding points when re 200 and kc 10 a vortex street extending in the opposite direction generates however when re 210 kc 6 a v shaped vortex street generates the flow field around the single column in this study re 10 6 kc 0 8 shows that boundary layers generate on the sides of the column but no vortexes form therefore the lift force introduced by vortex is extremely small and tends to zero which is consistent with the results by yang et al 2017 the influence of dimensionless variables re and kc number on the coefficients h x and h y will be studied numerically and the influence of θ 0 and c will be studied both numerically and analytically in the following sections 4 1 the influence of re the frequency of the harmonic excitation varies from 0 5 hz to 3 hz with interval 0 5 hz to change the reynolds number re 2 π f a d υ the amplitude of the harmonic excitation a keeps constant as 0 4 m and the relative center distance c between the twin columns changes from 4 to 12 with interval 4 and the polar angle θ 0 changes from 0 to π 2 with interval π 12 accordingly re changes from 3 7 10 6 to 2 3 10 7 as representatives how h x and h y change with re in the cases with c 4 is shown in fig 14 those with c 8 and 12 are omitted as they are basically the same as c 4 it can be observed that h x and h y basically do not change with re 4 2 the influence of kc number the amplitude of the harmonic excitation a changes from 0 1 m to 0 3 m with the interval 0 05 m to make the kc 2 π a d number change from 0 2 to 0 8 the polar angle θ 0 changes in the scope 0 π 12 π 6 π 4 π 3 5 π 12 π 2 the center distance c changes in the scope 4 8 12 and the frequency of the harmonic excitation f keeps consistent as 2 hz how h x and h y change with kc number is shown in fig 15 note that the cases with c 4 are selected as representatives and the cases with c 8 and 12 are omitted as they obey the same rule it can be observed that h x basically does not change with kc number and h y changes slightly only when θ 0 π 2 because when θ 0 π 2 the lift force f y is contributed by the pressure difference between the inner and out surface of the column which is related to the velocity fundamentally is related to kc number considering the relation u a ω s i n ω t kc d f sin 2 π f t 4 3 the influence of relative center distance c the relative center distance c changes from 4 to 14 with the increment 2 and the polar angel changes from 0 to π 2 with increment π 12 the frequency and amplitude of the harmonic excitation keep constants as 1 0 hz and 0 3 m respectively based on the eq 32 theoretically the absolute values of h x and h y are both proportional to 1 c 2 namely h x and h y decrease with c fig 16 shows how the numerical values of h x change with c when θ 0 π 4 h x is negative and the absolute values of analytical solution are larger than that of the numerical solution shown in fig 16 a when θ 0 π 4 h x is positive and the analytical values are smaller than the numerical values shown in fig 16 b when θ 0 π 4 both the numerical and analytical values of h x are close to zero and the numerical values agree well with analytical values except of the cases when θ 0 is larger i e θ 0 π 2 the difference between the analytical and numerical values are a little more remarkable when c is smaller the rule of h y varying with c is similar as that of h x varying with c shown in fig 17 generally the absolute value of h x and h y decrease sharply with c when c is smaller and gradually tends to zero when c is larger 4 4 the influence of θ 0 when θ 0 0 π 4 eq 32 shows analytically h x 0 which makes the added mass coefficient 1 h x 1 indicating the in line force on one of the twin columns is smaller than or equal to that on the single column when θ 0 π 4 π 2 h x 0 which makes the added mass coefficient 1 h x 1 indicating the in line force on one of the twin columns is larger than that on the single column eq 9 shows the analytical solution of the lift force on single column is zero eq 33 shows analytically only when θ 0 0 and θ 0 π 2 h y 0 i e the lift force on one of the twin columns is zero when θ 0 0 π 2 h y 0 i e the lift force on one of the twin columns is larger than that on a single column in cfd simulation the polar angle θ 0 takes values from 0 to π 2 with increment π 12 and the relative center distance increases from 4 to 8 with increment 0 8 the frequency and amplitude of the harmonic excitation keep constants as 1 0 hz and 0 3 m respectively analytically the coefficients h x and h y are harmonically related to θ 0 seen in eq 32 for convenience h x and h y are respectively normalized as 36 h x θ 0 c h x c 2 2 cos 2 θ 0 37 h y θ 0 c h y c 2 2 sin 2 θ 0 equations 36 and 37 show that analytically h x has a cosine relationship with θ 0 and h y has a sinusoidal relationship with θ 0 the numerical values of the added mass modified coefficients are defined as h x θ 0 c and h y θ 0 c which can be normalized as 38 h x θ 0 c h x θ 0 c c 2 2 39 h y θ 0 c h y θ 0 c c 2 2 the comparison of h x θ 0 c between analytical and numerical methods is shown in fig 18 a and the comparison of h y θ 0 c is shown in fig 18 b in which the numerically obtained h x θ 0 c and h y θ 0 c demonstrate a cosine curve shape and a sinusoidal curve shape respectively when c is smaller the numerical values match better with the analytical values than when c is larger this is because when c is larger the added mass modified coefficients h x θ 0 c and h y θ 0 c are much small a slightly deviation from the analytical values will be magnified enormously by c 2 because c 2 is large seen in eqs 38 and 39 generally the analytical values match the numerical values well indicating the relationships between added mass modified coefficients with θ 0 expressed in eq 32 are concisely and correctly 5 application the deduction of the hydrodynamic force calculation formulae is based on the assumptions that 1 water is irrotational inviscid and incompressible 2 the submerged depth of pier is so large that the three dimensional pier can be simplified as a two dimensional model 3 only the first wave reflection is considered and the multi reflections between the twin columns are not included 4 the actual earthquake wave is substituted by its harmonic components i e harmonic excitation therefore it is extremely necessary to validate the analytical calculation method proposed in this study numerically by applying the method to a real bridge under true earthquake a bridge with twin column circular piers in real practice is selected as the calculation model the diameters of the two columns are the same i e r 1 r 2 2 m the center distance is 8m accordingly the relative center distance c 4 the submerged depth of the pier is 40m the kocaeli earthquake wave is employed and is assumed to propagate along x axis the polar angle θ 0 is set as 0 π 4 and π 2 the hydrodynamic forces on one column of the twin columns calculated by ansys fluent and by the proposed method are compared in figs 19 21 for θ 0 0 θ 0 π 4 and θ 0 π 2 respectively comparison shows the analytical values of f x agree quite well with the numerical values when θ 0 0 π 4 and π 2 and the analytical values of f y agree considerable well with the numerical values when θ 0 π 4 when θ 0 0 and π 2 the analytical values of f y is 0 and the numerical values of f y are not zero but in the magnitude of 10 1 when θ 0 0 and in the magnitude of 10 0 when θ 0 π 2 which are extremely small compared to the magnitude of f x i e 10 3 therefore the difference between the f y could be ignored and the analytical method proposed is proven to be correct enough for the real practice application in addition it took about 50 h for numerical method to build the simulation model and complete the calculation on a computer with intel core i7 processer and 16g memory by using the proposed analytical method it only took 15 min to complete the calculation in microsoft excel it can be concluded that the proposed calculation method of hydrodynamic forces on twin column pier in this paper is not only accurate but also efficient in calculation which is valuable for real practice 6 conclusions the twin column piers are widely used for deep water bridges in real practice and the hydrodynamic force on one column of the twin column is different from that on a single column pier with the same diameter under the same earthquake because the flow filed in which the twin columns vibrate is generated by the synchronous vibration of the twin columns which differs from the flow filed in which the single column vibrates the calculation method of the hydrodynamic force on one column of the twin column is deduced and validated by cfd software i e ansys fluent the main conclusions are 1 the calculation formulae of the hydrodynamic force on one of the twin columns vibrating synchronously in water under earthquake are presented i e eq 33 2 the numerical simulation shows the in line forces f x on the twin columns are the same as well as the amplitudes of the lift force f y however the direction of lift force and the generation mechanism of lift force change with the polar angle θ 0 when θ 0 0 the lift force is extremely small when θ 0 π 2 the lift force amplitude is 1 70 of the in line force amplitude the directions of the lift forces on the twin columns are opposite and the lift forces are introduced by the larger velocity in the gap between the twin columns when θ 0 π 4 the lift force amplitude of the twin columns is 1 8 of the in line force amplitude the directions of the lift force on the twin columns are the same the lift forces are the components of the inertial forces 3 generally the numerical values of the hydrodynamic forces agree well with the analytical solutions except of the ignorable difference between the lift forces e g when θ 0 π 2 the analytical amplitude is zero but numerical amplitude is as small as 1 124 of the in line force amplitude 4 the added mass modified coefficients h x and h y almost do not change with reynolds number and kc number in the cases of this study in which re 10 6 kc 0 8 and the inertial force dominates 5 h x and h y decrease with the increase of the relative center distance c the maximum of h x and h y are 0 125 when c 4 with the decrease of c h x and h y are expected to be larger indicating the necessity of the considering the interaction between the twin columns when calculating the hydrodynamic force introduced by earthquake 6 the relationship between h x and θ 0 is cosine and the relationship between h y and θ 0 is sine when θ 0 0 π 4 the in line force on one of the twin columns is smaller than that on single column when θ 0 π 4 π 2 the former is larger than the latter when θ 0 0 π 2 the lift force on one of the twin columns is larger than that on single column when θ 0 0 and π 2 the former equates the latter i e 0 7 the calculation equation i e eq 33 with concise expression form high calculation efficiency and good precision is capable of being employed in real practice in real practice the column sections can be square rectangular round ended and other complex shapes above conclusions are expected to be generally viable to estimate hydrodynamic forces on columns with other section shapes because intimal force dominates hydrodynamic force when columns vibrate in water under earthquakes however further studies are still required to investigate the flow field around the vibrating column with other section shape because the flow field is believed to be different and which would induce some difference in pressure filed and relative acceleration of surrounding water for example obvious vortexes may generate around the rectangular columns and which may change the characteristics of hydrodynamic forces in addition the substructure of sea crossing bridge is composed of pile group pile cap and pier in which the pile group consists of several or tens of piles the calculation method of hydrodynamic forces on piles in pile group is expected to be further investigated based on this study declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work is supported by the national natural science foundation of china grant numbers 51678491 51478390 and thanks go to the science and technology planning project of sichuan province with grant numbers 2017jy0003 2019yfg0460 2019yfg0001 
22143,the calculation method of the hydrodynamic force on twin column pier receives less concerns although this kind of pier has been widely used in real practice the three dimensional twin column deep water pier is simplified as a two dimensional twin column model and water is assumed to be irrotational inviscid and incompressible the analytical solution of hydrodynamic force on twin columns is deduced and the calculation equations of the hydrodynamic forces on one column of the twin columns are founded based on the calculation equations of single column by introducing the added mass modified coefficients h x and h y commercial software ansys fluent is employed to validate the analytical solution comparison between the analytical and numerical methods show the analytical solution agree well with the numerical solution the influences of variables i e reynolds number keulegan carpenter number polar angle and relative center distance are discussed analytically and numerically as well as the generating mechanism of the lift force a case study of hydrodynamic force on a real bridge under earthquake shows the proposed calculation solution is not only concise in expression form but also with good precision and high calculation efficiency which exhibits a high application value in real practice keywords hydrodynamic force twin column pier deep water bridge earthquake calculation method added mass coefficient 1 introduction a large number of deep water bridges have been built in china in recent years which are mainly located in china southeastern coasts and western reservoirs these regions are at high risk of earthquake i e the southeastern coasts are located in the circum pacific seismic belt while the western mountainous areas are located in the mediterranean himalayan seismic zone under seismic excitation the hydrodynamic pressure introduces a significant influence on the dynamic characteristics and dynamic responses of the bridge even worse may aggravate the damage of the bridge under earthquakes for example the miaoziping bridge near the city of chengdu china was damaged by the 2008 sichuan earthquake mw 7 9 whose main piers are approximately 100 m tall and with 46 m submerged in water the interaction between structure and water under seismic excitation has attracted the attentions of many experts and scholars among which the added mass hydrodynamic pressure of a single pier vibrating in still water have been studied analytically and extensively in order to obtain a relatively simple mathematical model it is often required that the shape of the structure section is regular and the structure vibrates as a rigid body also some assumptions are necessary i e water is irrotational inviscid and incompressible westergaard and williamson 1933 first proposed the added mass method in his study the hydrodynamic pressure generated by water on dam surface was solved based on the assumptions that structure was rigid and the water was incompressible and the seismic excitation could be decomposed into a series of harmonic loads penzien and kaul 1972 proposed a stochastic analysis method for the interaction between offshore structures and fluid under strong earthquakes liaw and chopra 1974 presented the expression of the hydrodynamic pressure of a cylindrical cantilever structure under simple harmonic excitation and pointed out that the compressibility of water could be neglected lindgren 1984 applied morison equation to calculate the hydrodynamic pressure of a cylinder under seismic excitation tanaka and hudspeth 1988 worked out the eigen function solutions of the hydrodynamic pressure acting on a cylinder with finite depth in compressible fluid under seismic excitation and further discussed the relationship between the dynamic characteristics of rigid or flexible structures and fluid compressibility sun and nogami 1991 proposed a semi analytical and semi numerical method based on complete and non singular trefftz function set which can accurately describe the hydrodynamic pressure of axisymmetric structures under horizontal seismic excitation han and xu 1996 presented the theoretical model of the added mass generated by a cylinder vibrating in a kind of fluid medium based on the radiation wave theory and fluid element in software ansys li and yang 2013 presented the expressions of added mass of circular and square piers by curve fitting du et al 2014 proposed a more accurate simplified formula for hydrodynamic pressure based on radiation wave theory by introducing dimensionless parameters such as frequency ratio width depth ratio and relative height etc wang et al 2018 proposed a method for calculating the additional mass of a conical cylinder with arbitrary cross section by using the finite element method zhang et al 2019 deduced the formula for the additional mass of a single column with arbitrary cross section under horizontal seismic excitation in addition to the analytical method based on the radiation wave theory experiments were also conducted by some scholars to study the in line force and lift force characteristics of a single cylinder vibrating in still water meanwhile with the improvement of computer performance and the development of cfd computational fluid dynamics software numerical methods have also been favored by a large number of scholars mcconnell and park 1982 drove a cylinder to make sinusoidal motion in still water and the resulting in line force lift force and dynamic response of the cylinder were measured and analyzed dütsch et al 1998 used experimental and numerical methods to investigate the drag force lift force and flow filed of the vibrating circular cylinder three cases with different reynolds number re u m a x d ν in which u m a x ν and d represent respectively the maximum velocity of cylinder kinematic viscosity of water and cylinder diameter and different keulegan carpenter number kc 2 π a d in which a is amplitude of vibrating i e the cases of re 100 kc 5 re 200 kc 10 re 210 and kc 6 williamson 1985 experimentally studied the correlation between drag coefficient c d and kc number the correlation between lift coefficient c l and kc number in which kc 0 35 zheng and dalton 1999 used numerical method to study drag force coefficient and lift force coefficient of a cylinder and a square cylinder with kc 1 5 in oscillating fluid ghozlani et al 2012 analyzed the flow fields of vibrating circular cylinder and square prism with re 100 and kc 5 generally the cases with relatively smaller reynolds number and small kc number are concerned in above studies however the reynolds number and kc number relating to the flow field induced by vibration of bridge pier under earthquake are different from those have been widely studied the form of the substructure of deep water bridge is diverse e g a single column pier twin column pier multi column pier or assemble structure composed of pile group pile cap and pier for example the piers of the approach spans of miaoziping bridge of yunyang yangtze river bridge of qinggangzui dadu river bridge of sucunba dadu river bridge etc in china etc are twin column piers the components of the substructures always have large dimensions such as pile diameter can reach 4 m pier diameter can reach 10 m and pile cap diameter can reach tens of meters while ordinarily the vibration amplitude of the bridge under seismic excitation can reach only tens of centimeters at most the ratio of vibration amplitude to the size of pile pier or pile cap is relatively small in other words the flow filed generated by the movement of the substructure of the deep water bridge under earthquake can be characterized as large reynolds number and small kc number i e re 10 6 kc 0 8 approximately yang et al 2017 found that under the actual seismic excitations there are no vortexes or vortex street in the flow field around a single cylindrical pier the inertial force dominates and the flow field characteristics are similar as that introduced by a cylinder vibrating in an ideal fluid as mentioned before the twin column pier or multi column pier are widely used in real practice the flow field motivated by the synchronous multi column is different from the flow field motivated by a single column which leads to the hydrodynamic force on one of multi column is different from that on the single column in other words the hydrodynamic force calculation equation for single column cannot be used for the column in the multi column pier any more however to the best of our knowledge few studies have been carried out to investigate the calculation method of hydrodynamic force on column of multi column pier vibrating in still water under earthquake although there are some studies focus on the interaction between wave and multiple columns for example bonakdar and oumeraci 2015 studied the interaction between regular waves and pile groups through experiments zheng et al 2019 studied the interaction between wave and multiple suspended floating cylinders with arbitrary cross section in which similar analysis and calculation methods may be employed but the calculation method of wave force on piles is different from that of hydrodynamic force on piles oscillating in still water in this study the calculation method of hydrodynamic force on one column of the twin columns under earthquake is investigated the circular columns are selected as research object as they are the most widely used components of the substructure of deep water bridge in real practice firstly the solution conception and deduction process of hydrodynamic force calculation formula for a single column is described briefly and based on which the analytical calculation formula of hydrodynamic force on one column of the twin columns is deduced then the cfd method is used to validate the analytical calculation formulas and the influencing parameters of the added mass modified coefficients are discussed finally an application of the calculation method to a real bridge is conducted to compare the accuracy and efficiency of the proposed calculation method 2 analytical solution 2 1 basic assumptions in real practice the submerged depth of substructure is considerably large e g 46 m for the miaoziping bridge yang et al 2017 168 m for the mangjiedu bridge yang 2012 etc which is much larger than the dimension of the pier and also is extremely larger than the wave height generated by the vibrating pier under earthquake therefore it is reasonable to simplify the three dimensional column water coupling system in real practice as a two dimensional cylinder water coupling model assuming the interactions between cylinder and water are the same at different water depths studies by yang et al 2017 show that complex seismic waves can be decomposed into a series of monochromatic simple harmonic waves to analyze the hydrodynamic pressure on bridge piers therefore simple harmonic waves are used in the deduction process of analytical solution and cfd validation while a real three dimensional twin column pier and a real seismic wave are employed in the application section to verify the applicability of the suggested calculation method in addition water is assumed to be irrotational inviscid and incompressible 2 2 analytical solution of hydrodynamic force on a single column as the deduction of hydrodynamic force formulae for the twin columns is based on the hydrodynamic force formulae of a single column therefore the analytical solution deduction process of hydrodynamic force on a single column is reviewed briefly both the polar coordinate system and the cartesian coordinate system will be used in the following deduction process so the column c1 is placed at the origins of above two coordinate systems shown in fig 1 a and fig 1 b respectively in which r 1 is the radius of c1 θ is polar angle and the polar axis direction is consistent with the x axis direction the harmonic wave propagates along the polar axis or x axis so the column c1 moves back and forth along the polar axis or x axis under the excitation of a harmonic wave with amplitude a angular frequency ω the displacement s and the velocity u of the column can be expressed as 1 s a cos ω t 2 u a ω sin ω t accordingly the velocity potential φ 1 generated by the motion of column is 3 φ 1 ϕ 1 x y cos ω t ϕ 1 r θ cos ω t ϕ 1 satisfies the laplace equation and can be written in polar coordinate system as 4 1 r r r ϕ 1 r 1 r 2 2 ϕ 1 θ 2 0 under boundary conditions the eq 4 can be solved by using the variable separation approach then the velocity potentials ϕ 1 and φ 1 can be expressed shown in eq 5 the detailed deduction process could be found in article by li and yang 2013 omitted here for brevity 5 ϕ 1 r 1 2 a ω cos θ r r 1 2 a ω x x 2 y 2 φ 1 r 1 2 a ω cos θ r cos ω t r 1 2 a ω x x 2 y 2 cos ω t furthermore the velocity and acceleration at any position in polar coordinate system and in cartesian coordinate system can be derived based on eq 5 shown in eq 6 and eq 7 respectively 6 u x y t y 2 x 2 x 2 y 2 2 r 1 2 a ω cos ω t v x y t 2 x y x 2 y 2 2 r 1 2 a ω c o s ω t 7 u x y t x 2 y 2 x 2 y 2 2 r 1 2 a ω 2 sin ω t v x y t 2 x y x 2 y 2 2 r 1 2 a ω 2 sin ω t in which u and u are respectively the velocity and acceleration in the polar axis or in x direction v and v are respectively the velocity and acceleration in the direction perpendicular to polar axis or in y direction substituting eq 5 into the linearized bernoulli equation then the hydrodynamic pressure p can be obtained by integrating pressure p with respect to θ the hydrodynamic forces acting on single column in polar coordinate system can be obtained 8 f x cos ω t 0 2 π p r 1 θ r 1 cos θ d θ a ρ r 1 2 ω 2 π cos ω t f y cos ω t 0 2 π p r 1 θ r 1 sin θ d θ 9 f x m u f y 0 in which m ρ π r 1 2 is the mass of water with the volume same as that displaced by the column f x and f y are the force components in the direction of the polar axis i e in the x direction and in the direction perpendicular to the polar axis i e in the y direction hereinafter f x and f y are also named in line force and lift force respectively 2 3 analytical solution of hydrodynamic force on one column of the twin columns the arrangements of the twin columns c1 and c2 in polar coordinate system and cartesian coordinate system are shown in fig 2 a and fig 2 b respectively r 1 and r 2 are respectively the radii of c1 and c2 θ is polar angle θ 0 is the specific angle between the polar axis and the line connecting the centers of the twin columns l is the distance between the centers of the twin columns l 1 l cos θ 0 and l 2 l sin θ 0 are the projection lengths of l on x axis and y axis respectively similarly the harmonic wave with amplitude a and circular frequency ω propagates along the polar axis or x axis therefore the twin columns moves back and forth synchronously along the polar axis or x axis the relative position of the twin columns in fig 2 are depicted by the distance between the center distance l and the angle θ 0 theoretically r 1 r 2 l and 0 θ 0 2 π change of angle θ 0 equates the rotation of column c2 around the center of column c1 which always keeps still in this study shown in fig 2 b due to the geometric symmetry and kinematic symmetry the analytical deduction process of the hydrodynamic force on columns c1 and c2 in the first quadrant i e 0 θ 0 π 2 is the same as that when they are in the second third and fourth quadrants i e π 2 θ 0 2 π therefore θ 0 varies from 0 to π 2 in this study now setting φ 1 as the velocity potential caused by the vibration of c1 without considering the influence of c2 setting φ 2 as the velocity potential caused by c2 without considering the influence of c1 namely both of c1 and c2 are treated as a separated single column according to eq 5 we have 10 φ 1 r 1 2 a ω cos θ r cos ω t r 1 2 a ω x x 2 y 2 cos ω t 11 φ 2 r 2 2 a ω r cos θ l cos θ 0 r 2 l 2 2 r l cos θ θ 0 cos ω t r 2 2 a ω x l 1 x l 1 2 y l 2 2 cos ω t then assuming c1 to keep stationary and c2 to vibrate the radiation velocity potential at the position of c1 generated by the vibration of c2 is φ 21 ϕ 21 cos ω t in which ϕ 21 also satisfies the laplace equation 12 1 r r r ϕ 21 r 1 r 2 2 ϕ 21 θ 2 0 again the variable separation approach is used 13 ϕ 21 r θ r r θ θ substituting eq 13 into eq 12 yields the equations 14 d 2 θ d θ 2 m 2 θ 0 15 r 2 d 2 r d r 2 r d r d r m 2 r 0 and ϕ 21 satisfies the corresponding boundary conditions i e considering the periodic boundary condition eq 16 16 θ θ θ 2 π θ the solution of eq 14 can be obtained as 17 θ m θ a m cos m θ b m sin m θ m 0 1 2 3 and eq 15 is the typical eulerian ordinary differential equation whose solution is 18 r m r c m r m d m 1 r m m 1 2 3 c d ln r m 0 according to sommerfeld radiation condition eq 19 19 r d r d r i k r 0 r c 0 d 0 c m 0 can be obtained substituting eq 17 and eq 18 into eq 13 the velocity potential ϕ 21 is as follows 20 ϕ 21 r θ m 0 d m a m 1 r m cos m θ b m 1 r m sin m θ m 0 e m 1 r m cos m θ f m 1 r m sin m θ m 0 1 2 3 on the surface of column c1 the velocity potential ϕ 21 should satisfy boundary condition eq 20 namely 21 ϕ 21 r r r 1 ϕ 2 r r r 1 0 then ϕ 21 can be expressed as 22 ϕ 21 m 1 e m 1 r m cos m θ f m 1 r m sin m θ in which e m and f m are as follows 23 e m r 1 m 1 π m π π ϕ 2 r θ r r r 1 cos m θ d θ f m r 1 m 1 π m π π ϕ 2 r θ r r r 1 sin m θ d θ note that the second reflection of velocity potential between c1 and c2 is not considered anymore according to the linear superposition property of velocity potential the total velocity potential φ at any position introduced by the synchronous vibration of the twin columns is 24 φ φ 1 φ 2 φ 21 r 1 2 a ω cos θ r cos ω t r 2 2 a ω r cos θ l cos θ 0 r 2 l 2 2 r l cos θ θ 0 cos ω t m 1 e m 1 r m cos m θ f m 1 r m sin m θ cos ω t substituting eq 24 into the linearized bernoulli equation the hydrodynamic pressure at any position in the flow field can be expressed as 25 p r θ ρ φ t ρ ω ϕ 1 ϕ 2 ϕ 21 sin ω t then by integration the hydrodynamic force components acting on c1 in the polar axis direction and in its perpendicular to the polar axis direction namely x and y directions in the cartesian coordinate system are obtained as 26 f x cos ω t 0 2 π p r 1 θ r 1 cos θ d θ a ρ ω 2 π r 1 2 cos ω t a ρ ω 2 π r 2 2 h x cos ω t m 1 r 2 2 r 1 2 h x u 27 f y cos ω t 0 2 π p r 1 θ r 1 sin θ d θ a ρ ω 2 π r 2 2 h y cos ω t m r 2 2 r 1 2 h y u where u a ω 2 cos ω t is the acceleration of harmonic wave m ρ π r 1 2 is the mass of water with the volume same as that displaced by the column c1 h x and h y are termed as added mass modified coefficients in x and y directions respectively 28 h x 1 π π π f θ cos θ d θ π π g θ cos θ d θ 29 h y 1 π π π f θ sin θ d θ π π g θ sin θ d θ where f θ and g θ are expressed as follows 30 f θ cos θ a a cos θ 2 b sin θ 2 cos θ c cos θ 0 c 2 1 2 c cos θ θ 0 31 g θ ϕ 21 r θ r r r 1 2 a a 2 b 2 1 cos θ 2 a b s i n θ a cos θ 2 b sin θ 2 2 2 c cos θ 0 cos θ c 2 cos θ 2 θ 0 c 2 1 2 c cos θ θ 0 2 in which c l r 1 is defined as the relative distance between the centers of the twin columns a l 1 r 1 and b l 2 r 1 are respectively defined as the relative projection distances in x and y directions in which l 1 and l 2 are defined as the projections of l on x and y axes indicating the horizontal and vertical distances between the centers respectively shown in fig 2 b by further integral operation on eq 28 and eq 29 h x and h y can be simplified as 32 h x 2 cos 2 θ 0 c 2 h y 2 sin 2 θ 0 c 2 eq 32 implies that the added mass modified coefficients h x and h y are only influenced by the relative position of the twin columns i e c and θ 0 in real practice the columns of twin column pier of deep water bridges are always have the same diameter namely r 1 r 2 r then the calculation formulas of hydrodynamic force components can further be simplified as 33 f x m u 1 h x f y m u h y comparison between eq 9 and eq 33 shows that only two added mass modified coefficients are introduced into eq 9 to form the calculation formulae of the hydrodynamic forces on one column of the twin columns which are concise and easy to calculate 3 numerical verification of the analytical solution as discussed in the previous section the added mass modified coefficients h x and h y are just related to the relative position between the twin columns note that this conclusion is obtained based on the assumptions that the fluid is irrotational inviscid and incompressible these assumptions make the analytical analysis simple and viable to access the solutions however the rationality of the assumptions requires further validation and the calculation accuracy require verification researches by scholars such as dütsch et al 1998 williamson 1985 ghozlani et al 2012 show that re and kc number are important parameters affecting the forces exerted on a vibrating cylinder but they are not included in our analytical solutions i e in eq 32 which brings potential risks of error in recent years the cfd software such as ansys fluent which is capable of involving viscosity and vortex computing etc have been widely used to calculate the hydrodynamic forces on structures therefore ansys fluent software will be employed to verify the added mass modified coefficients h x and h y note that in real practice the diameter d of columns in the substructures of deep water bridges is ordinarily 2 4m and the relative distance between the centers of any two columns approximately varies between 4 and 14 for example the column diameter of the twin column piers of the nanchang new bayi bridge in china is 4 m and the distance between the column centers is 18 m therefore d 3 m and c 4 14 m are chosen for the numerical model the statistical analysis of more than 300 seismic waves by yang et al 2017 shows that approximately the amplitude of the seismic wave a 0 1 0 4 m and the main frequency f 0 5 3 hz the amplitude and frequency of the harmonic waves used in the numerical simulation are selected in the above ranges it can be estimated from above data that re 10 6 and kc 0 8 in the following numerical simulations which implies inertial force dominates 3 1 cfd basic equations and the numerical model validation in numerical simulation the navier stokes rans equations are solved by ansys fluent the conservation equations of mass and momentum are 34 u i x i 0 35 u i t u j u j x j 1 ρ p x i μ ρ 2 u i x j x j 1 ρ ρ u i u j x j where i and j represent the direction of cartesian coordinate axis u i denotes the time averaged velocity which is defined as u i 1 δ t t 0 t 0 δ t u i d t u i stands for the pulsating velocity as the definition of u i u i u i and p denotes the time averaged pressure ρ is the density of water and μ is the kinematic viscosity of water in the simulation the dynamic mesh technique is used to reconstruct the numerical mesh due to the small amplitude of the columns the mesh reconstruction in the computational domain does not have a great influence on the quality of the mesh and the accuracy of the calculation can be ensured ansys icem cfd is used to build geometric model and generate mesh in order to reduce the influence of the boundaries of fluid domain on the force exerted on the structure 40 times and 20 times of the diameter of the column are taken along the direction of column motion and perpendicular to the direction of column motion respectively i e the fluid domain is 120 m in length and 60 m in width structural meshes are generated in the fluid domain shown in fig 3 a core regions around the column are set to generate extremely fine meshes as shown in fig 3 b because the velocity gradient and pressure gradient near the column are large the boundary conditions of the column surface and the front back left and right boundaries of computational domain are set as wall and the scalable wall functions are used to simulate the boundary layer effect the k ε rng turbulence model suitable for high reynolds number cases is chosen because the reynolds number in this study is extremely large i e in the range 10 6 10 7 the physical experimental data of a single column vibrating in still water by yang et al 2018 are used to confirm the correctness of modeling method and the related parameters the numerical model has the same dimensions and suffers the same external excitation as the physical experimental model the comparison of the time histories of hydrodynamic forces between the physical experimental model and the numerical model is shown in fig 4 it can be observed that numerical calculation is stable after t 4 s and the two curves coincide well indicating the solution of the present numerical model is trustable 3 2 validation of the numerical model by analytical solution of single column the analytical solution of hydrodynamic force for single column has been widely studied and accepted i e eq 9 as well as the velocity and acceleration equations i e eq 6 and eq 7 respectively therefore these equations are further employed to validate the numerical model set up in section 3 1 the in line force f x on the single column excited by harmonic wave with amplitude a 0 3 m frequency f 1 hz calculated by eq 9 and by ansys fluent are compared in fig 5 note that the amplitude increases gradually from 0 to a in the first four periods in numerical simulation and remains unchanged after the fourth period fig 5 shows the curves of f x by analytical and numerical methods coincide with each other very well and the peak value of f x is about 83 6 kn as to f y the numerical value is extremely close to zero which agrees well with the analytical solution i e zero their comparison is omitted for brevity more harmonic waves with different amplitude and frequency are used to validate the precision of the present numerical model and the relative difference between the analytical and numerical solutions are defined as t f 100 f x a m a x f x n m a x f x n m a x in which f x a m a x and f x n m a x are the peak values of the analytical and numerical solutions respectively the results are shown in table 1 it can be observed that the relative difference is less than 1 indicating that the present numerical model can calculate the hydrodynamic force precisely it s believed that inertial force dominates in above cases as kc 0 8 for all these cases then the parameter most related to the inertial force i e accelerations at points around the column the position of the point is defined as m r θ in which θ 0 π 2 δ θ π 12 r 3 10 5 m δ r 0 3 m are calculated by analytical solution i e eq 7 and compared with the numerical solution by ansys fluent the comparison of the accelerations in x and y directions i e u and v are shown in fig 6 and fig 7 respectively note that the column were suffered the harmonic excitation with a 0 3 m f 1 hz in all the cases figs 6 and 7 show generally the analytical and numerical results agree with each other well except of the values of u when θ π 4 in fig 6 a and values of v when θ π 2 in fig 7 b however with the increase of r the differences between the analytical and numerical values decrease rapidly it can be concluded that the present numerical model can precisely calculate the hydrodynamic force on single column under earthquake as well as the flow field indicating the mesh generation scheme turbulence model boundary conditions etc are correct and is capable enough to provide validation to the analytical solutions of the hydrodynamic force on one of the twin columns under earthquake 3 3 verification of analytical solution for one column of the twin columns when the relative distance c 4 the twin columns arranged in tandem θ 0 0 arranged side by side θ 0 π 2 and arranged in staggered form θ 0 π 4 are selected as three typical cases to validate the analytical solution i e eq 33 fig 8 fig 9 and fig 10 respectively show the comparisons between analytical and numerical solutions of hydrodynamic force time histories generated by the harmonic excitation with a 0 3 m and f 1 hz when θ 0 0 θ 0 π 2 and θ 0 π 4 it can be observed from figs 8 10 that the numerical in line force f x on columns c1 and c2 are the same no matter how θ changes indicating that the interaction between the columns has the same effect on in line force on c1 and c2 and curves of f x obtained numerically almost coincide with the analytical curves after the fourth cycle note that in numerical simulation the harmonic excitation amplitude increases from 0 to a in the first four cycles the peak value of f x on columns c1 and c2 is 74 5 kn when θ 0 0 is 95 7 kn when θ 0 π 2 and is 83 9 kn when θ 0 π 4 which are respectively 10 88 smaller 14 50 and 0 38 larger than that of the single column i e 83 6 kn it can be concluded that the influence introduced by the synchronous vibration of the twin columns on the in line force changes with polar angle θ which cannot be ignored when the twin columns are arranged in tandem θ 0 0 the analytical solutions of lift force f y on columns c1 and c2 are zero seen in eq 33 and the numerical solutions are extremely close to zero i e around 10 7 shown in fig 8 b when θ 0 π 2 the analytical solutions of f y on c1 and c2 are zero but the numerical solutions are not zero in detail the averaged values of f y on c1 and c2 are respectively 0 6 kn and 0 6 kn with the same amplitudes 0 6 kn and the peak value is about 1 70 1 2 kn 89 3 kn of the f x the curves of f y on c1 and c2 are symmetry with x axis shown in fig 9 b in other words when the twin columns arranged side by side vibrates synchronously the flow field produces a pair of lift forces perpendicular to the direction of vibration equal in size and opposite in direction the relationship between the normalized lift forces and the normalized vibrating velocity of the twin columns is shown in fig 11 a demonstrating that the peak values of lift forces on c1 c2 and the peak value of their vibrating velocity occur at the same instant i e at t t 4 and 3 t 4 and as well as the minimum values of the lift forces and the minimum value of the vibrating velocity i e at t 0 and t t 2 fig 11 a implies the lift force is introduced by the relative velocity between water and the vibrating columns fig 11 b and c show the velocity contour and pressure contour at t t 4 when both the lift forces and velocity are at their peaks it can be observed that the flow velocity between the twin columns is slightly larger than that outside left and right sides marked in fig 11 b of the twin columns which introduces slightly smaller pressure on the inner surfaces of the twin columns shown in fig 11 c then the pressure difference on c1 and c2 generates a pair of lift forces equal in size and opposite in direction shown in fig 11 a the frequency of the pressure changes on the inner side surfaces of the twin columns due to the velocity change is twice of the frequency of the velocity shown in fig 11 a because in one period of velocity both the back and forth moving of the column introduces pressure change once that s the reason why the frequency of f y in fig 9 b is twice of the frequency of f x in fig 9 a note that f x is dominated by inertial force i e vibrating acceleration of the twin columns when the polar angle θ 0 π 4 both the curves of the lift force f y on c1 and c2 calculated by the numerical method coincide well with the curve calculated by the analytical method as shown in fig 10 b the peak value ratio of f y to f x 10 6 kn 83 9 kn 1 8 is larger and cannot be ignored comparison between fig 10 a and fig 10 b shows the frequency of f x is basically the same as that of f y which is the frequency of harmonic excitation the reason is explained as follows at the instant t 0 t the in line force f x on the columns c1 and c2 reaches the negative peak value 83 9 kn while the lift f y reaches the positive peak value 10 6 kn at this time the twin columns begin to move forward to the positive direction of x axis and the velocity around the twin columns is small and almost symmetry with their own horizontal centerlines shown in fig 12 a but at this moment the acceleration reaches the maximum and the pressure is positive in front of the column and is negative at the rear shown in fig 12 b in addition the positive pressure in front of c1 is smaller than that in front of c2 and the negative pressure at back of c1 is larger than that at back of c2 which ultimately generate almost the same hydrodynamic forces on c1 and c2 to be more exactly the pressure distribution around the c1 is not symmetrical with their own horizontal centerlines i e the center of the negative pressure at the back of c1 inclines to left and the center of the positive pressure at the front inclines to right the pressure distribution on c2 has the same characteristic with c1 the flow caused by a vibrating column is equivalent to an oscillatory flow around a stationary column note that the pressure on column is mainly generated by relative acceleration of flow to column because the kc number is much small and reynolds number is extremely large the acceleration direction of the flow between the twin columns deviates from x axis generating asymmetric distribution of pressure on the columns and ultimately leads to the inertial forces f on c1 and c2 inclined to x axis shown in fig 12 b essentially the in line force f x and lift force f y are the components of the resultant force f shown in fig 12 that s the reason why the frequency of f y is the same as that of f x which is equal to the frequency of harmonic excitation seen in the hydrodynamic force calculation formula eq 33 when t t 4 the column moves forward along the positive direction of x axis the velocity of the column reaches the maximum but the acceleration is 0 the pressure in the front and behind of the column is positive and almost equal and the pressure on the left and right sides is negative and almost equal too as shown in fig 13 which results in the force components are almost zero i e f x and f y on the column c1 are about 1 0 kn and 0 3 kn respectively 4 parameter analysis of the added mass modified coefficients the main difference of the calculation formulas between the single column and twin columns are the added mass modified coefficients h x and h y as compared between the eq 9 and eq 33 the coefficients h x and h y only include two variables polar angle θ 0 and relative center distance c shown in eq 32 the reynolds number re and kc number which have been found influencing the flow field dramatically have not been included for example dütsch et al 1998 found that when re 100 and kc 5 a pair of stable symmetrical and periodic shedding vortexes generate around the cylinder with two fixed shedding points when re 200 and kc 10 a vortex street extending in the opposite direction generates however when re 210 kc 6 a v shaped vortex street generates the flow field around the single column in this study re 10 6 kc 0 8 shows that boundary layers generate on the sides of the column but no vortexes form therefore the lift force introduced by vortex is extremely small and tends to zero which is consistent with the results by yang et al 2017 the influence of dimensionless variables re and kc number on the coefficients h x and h y will be studied numerically and the influence of θ 0 and c will be studied both numerically and analytically in the following sections 4 1 the influence of re the frequency of the harmonic excitation varies from 0 5 hz to 3 hz with interval 0 5 hz to change the reynolds number re 2 π f a d υ the amplitude of the harmonic excitation a keeps constant as 0 4 m and the relative center distance c between the twin columns changes from 4 to 12 with interval 4 and the polar angle θ 0 changes from 0 to π 2 with interval π 12 accordingly re changes from 3 7 10 6 to 2 3 10 7 as representatives how h x and h y change with re in the cases with c 4 is shown in fig 14 those with c 8 and 12 are omitted as they are basically the same as c 4 it can be observed that h x and h y basically do not change with re 4 2 the influence of kc number the amplitude of the harmonic excitation a changes from 0 1 m to 0 3 m with the interval 0 05 m to make the kc 2 π a d number change from 0 2 to 0 8 the polar angle θ 0 changes in the scope 0 π 12 π 6 π 4 π 3 5 π 12 π 2 the center distance c changes in the scope 4 8 12 and the frequency of the harmonic excitation f keeps consistent as 2 hz how h x and h y change with kc number is shown in fig 15 note that the cases with c 4 are selected as representatives and the cases with c 8 and 12 are omitted as they obey the same rule it can be observed that h x basically does not change with kc number and h y changes slightly only when θ 0 π 2 because when θ 0 π 2 the lift force f y is contributed by the pressure difference between the inner and out surface of the column which is related to the velocity fundamentally is related to kc number considering the relation u a ω s i n ω t kc d f sin 2 π f t 4 3 the influence of relative center distance c the relative center distance c changes from 4 to 14 with the increment 2 and the polar angel changes from 0 to π 2 with increment π 12 the frequency and amplitude of the harmonic excitation keep constants as 1 0 hz and 0 3 m respectively based on the eq 32 theoretically the absolute values of h x and h y are both proportional to 1 c 2 namely h x and h y decrease with c fig 16 shows how the numerical values of h x change with c when θ 0 π 4 h x is negative and the absolute values of analytical solution are larger than that of the numerical solution shown in fig 16 a when θ 0 π 4 h x is positive and the analytical values are smaller than the numerical values shown in fig 16 b when θ 0 π 4 both the numerical and analytical values of h x are close to zero and the numerical values agree well with analytical values except of the cases when θ 0 is larger i e θ 0 π 2 the difference between the analytical and numerical values are a little more remarkable when c is smaller the rule of h y varying with c is similar as that of h x varying with c shown in fig 17 generally the absolute value of h x and h y decrease sharply with c when c is smaller and gradually tends to zero when c is larger 4 4 the influence of θ 0 when θ 0 0 π 4 eq 32 shows analytically h x 0 which makes the added mass coefficient 1 h x 1 indicating the in line force on one of the twin columns is smaller than or equal to that on the single column when θ 0 π 4 π 2 h x 0 which makes the added mass coefficient 1 h x 1 indicating the in line force on one of the twin columns is larger than that on the single column eq 9 shows the analytical solution of the lift force on single column is zero eq 33 shows analytically only when θ 0 0 and θ 0 π 2 h y 0 i e the lift force on one of the twin columns is zero when θ 0 0 π 2 h y 0 i e the lift force on one of the twin columns is larger than that on a single column in cfd simulation the polar angle θ 0 takes values from 0 to π 2 with increment π 12 and the relative center distance increases from 4 to 8 with increment 0 8 the frequency and amplitude of the harmonic excitation keep constants as 1 0 hz and 0 3 m respectively analytically the coefficients h x and h y are harmonically related to θ 0 seen in eq 32 for convenience h x and h y are respectively normalized as 36 h x θ 0 c h x c 2 2 cos 2 θ 0 37 h y θ 0 c h y c 2 2 sin 2 θ 0 equations 36 and 37 show that analytically h x has a cosine relationship with θ 0 and h y has a sinusoidal relationship with θ 0 the numerical values of the added mass modified coefficients are defined as h x θ 0 c and h y θ 0 c which can be normalized as 38 h x θ 0 c h x θ 0 c c 2 2 39 h y θ 0 c h y θ 0 c c 2 2 the comparison of h x θ 0 c between analytical and numerical methods is shown in fig 18 a and the comparison of h y θ 0 c is shown in fig 18 b in which the numerically obtained h x θ 0 c and h y θ 0 c demonstrate a cosine curve shape and a sinusoidal curve shape respectively when c is smaller the numerical values match better with the analytical values than when c is larger this is because when c is larger the added mass modified coefficients h x θ 0 c and h y θ 0 c are much small a slightly deviation from the analytical values will be magnified enormously by c 2 because c 2 is large seen in eqs 38 and 39 generally the analytical values match the numerical values well indicating the relationships between added mass modified coefficients with θ 0 expressed in eq 32 are concisely and correctly 5 application the deduction of the hydrodynamic force calculation formulae is based on the assumptions that 1 water is irrotational inviscid and incompressible 2 the submerged depth of pier is so large that the three dimensional pier can be simplified as a two dimensional model 3 only the first wave reflection is considered and the multi reflections between the twin columns are not included 4 the actual earthquake wave is substituted by its harmonic components i e harmonic excitation therefore it is extremely necessary to validate the analytical calculation method proposed in this study numerically by applying the method to a real bridge under true earthquake a bridge with twin column circular piers in real practice is selected as the calculation model the diameters of the two columns are the same i e r 1 r 2 2 m the center distance is 8m accordingly the relative center distance c 4 the submerged depth of the pier is 40m the kocaeli earthquake wave is employed and is assumed to propagate along x axis the polar angle θ 0 is set as 0 π 4 and π 2 the hydrodynamic forces on one column of the twin columns calculated by ansys fluent and by the proposed method are compared in figs 19 21 for θ 0 0 θ 0 π 4 and θ 0 π 2 respectively comparison shows the analytical values of f x agree quite well with the numerical values when θ 0 0 π 4 and π 2 and the analytical values of f y agree considerable well with the numerical values when θ 0 π 4 when θ 0 0 and π 2 the analytical values of f y is 0 and the numerical values of f y are not zero but in the magnitude of 10 1 when θ 0 0 and in the magnitude of 10 0 when θ 0 π 2 which are extremely small compared to the magnitude of f x i e 10 3 therefore the difference between the f y could be ignored and the analytical method proposed is proven to be correct enough for the real practice application in addition it took about 50 h for numerical method to build the simulation model and complete the calculation on a computer with intel core i7 processer and 16g memory by using the proposed analytical method it only took 15 min to complete the calculation in microsoft excel it can be concluded that the proposed calculation method of hydrodynamic forces on twin column pier in this paper is not only accurate but also efficient in calculation which is valuable for real practice 6 conclusions the twin column piers are widely used for deep water bridges in real practice and the hydrodynamic force on one column of the twin column is different from that on a single column pier with the same diameter under the same earthquake because the flow filed in which the twin columns vibrate is generated by the synchronous vibration of the twin columns which differs from the flow filed in which the single column vibrates the calculation method of the hydrodynamic force on one column of the twin column is deduced and validated by cfd software i e ansys fluent the main conclusions are 1 the calculation formulae of the hydrodynamic force on one of the twin columns vibrating synchronously in water under earthquake are presented i e eq 33 2 the numerical simulation shows the in line forces f x on the twin columns are the same as well as the amplitudes of the lift force f y however the direction of lift force and the generation mechanism of lift force change with the polar angle θ 0 when θ 0 0 the lift force is extremely small when θ 0 π 2 the lift force amplitude is 1 70 of the in line force amplitude the directions of the lift forces on the twin columns are opposite and the lift forces are introduced by the larger velocity in the gap between the twin columns when θ 0 π 4 the lift force amplitude of the twin columns is 1 8 of the in line force amplitude the directions of the lift force on the twin columns are the same the lift forces are the components of the inertial forces 3 generally the numerical values of the hydrodynamic forces agree well with the analytical solutions except of the ignorable difference between the lift forces e g when θ 0 π 2 the analytical amplitude is zero but numerical amplitude is as small as 1 124 of the in line force amplitude 4 the added mass modified coefficients h x and h y almost do not change with reynolds number and kc number in the cases of this study in which re 10 6 kc 0 8 and the inertial force dominates 5 h x and h y decrease with the increase of the relative center distance c the maximum of h x and h y are 0 125 when c 4 with the decrease of c h x and h y are expected to be larger indicating the necessity of the considering the interaction between the twin columns when calculating the hydrodynamic force introduced by earthquake 6 the relationship between h x and θ 0 is cosine and the relationship between h y and θ 0 is sine when θ 0 0 π 4 the in line force on one of the twin columns is smaller than that on single column when θ 0 π 4 π 2 the former is larger than the latter when θ 0 0 π 2 the lift force on one of the twin columns is larger than that on single column when θ 0 0 and π 2 the former equates the latter i e 0 7 the calculation equation i e eq 33 with concise expression form high calculation efficiency and good precision is capable of being employed in real practice in real practice the column sections can be square rectangular round ended and other complex shapes above conclusions are expected to be generally viable to estimate hydrodynamic forces on columns with other section shapes because intimal force dominates hydrodynamic force when columns vibrate in water under earthquakes however further studies are still required to investigate the flow field around the vibrating column with other section shape because the flow field is believed to be different and which would induce some difference in pressure filed and relative acceleration of surrounding water for example obvious vortexes may generate around the rectangular columns and which may change the characteristics of hydrodynamic forces in addition the substructure of sea crossing bridge is composed of pile group pile cap and pier in which the pile group consists of several or tens of piles the calculation method of hydrodynamic forces on piles in pile group is expected to be further investigated based on this study declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work is supported by the national natural science foundation of china grant numbers 51678491 51478390 and thanks go to the science and technology planning project of sichuan province with grant numbers 2017jy0003 2019yfg0460 2019yfg0001 
22144,in the field of marine hydrodynamics propeller operations in off design conditions represent a challenging topic that has been increasingly attracting interest among industry and research institutions over the ship operating life off design conditions and the associated modifications of the propeller inflow are connected to a wide range of events such as degradation of the overall efficiency amplification of unwanted side effects of propeller operations pressure pulses vibration and noise and ultimately failure of the ship propulsion system in this work the performance of a propeller operating in off design conditions is investigated by a comprehensive experimental activity aimed at synthesizing the cause and effect relation between the propeller loads and its inflow to this purpose two novel set ups are employed the first one is dedicated to the measurement of single blade loads whereas the second a boroscopic based stereo piv spiv system is focused on the inflow analysis the overall measurement apparatus is installed on a twin screw ship model experiments carried out in the cnr inm towing tank consist of straight ahead and steady drift motions at drift angles 1 3 and 2 7 this test matrix is representative of weak and tight maneuvering conditions keywords propeller off design ship maneuvering particle image velocimetry single blade loads measurements 1 introduction the development of marine propeller plays a pivotal role since the early stages of ship design as it is strictly related to crucial problems of the operating life of a ship i e propulsive efficiency vibrations and noise structural strength of the hull and components of the propulsion systems bearings issues related to the overall performance of the marine propeller are associated with the spatially non uniform and unsteady velocity field breslin and andersen 1994 traditionally the design and analysis of marine propeller are centered on the ideal case of straight motion in calm water however in realistic operating conditions the motion of the ship can be different due to environmental factors waves and wind counteracting control actions i e autopilot and maneuvering in these cases the cross flow induced by the motion and the consequent modification of the viscous wake of the hull alter the propeller blade hydrodynamics and consequently the resultant propeller loads the complete assessment of the problem is very challenging because the evolution of the inflow to the propeller depends on geometric details of the stern shape appendages configurations in case of multi screw driven ships and direction of rotation of the propulsors and is strongly coupled with the kinematic response of the body in general the flow impinging upon the propeller slows down due to the speed drop caused by the ship flow relative motion due to waves or maneuvering and is dominated by the concurrent presence of coherent structures and large separated flow regions as a matter of fact the propeller develops higher thrust and torque and more importantly relevant in plane forces and moments are generated as a consequence of non uniform inflow over the propeller disk that further stress the propulsion system shaftline and bearings and hull structure in fact an earlier analysis for a limited series of twin screw naval vessels at full scale highlighted that the power absorption of the external propeller i e on the windward side was almost doubled with respect to the internal one on the leeward side and exceeded by about 80 the value of the rectilinear navigation coraddu et al 2013 systematic investigation performed on captive atsavapranee et al 2010 and free running ortolani et al 2015a maneuvering twin screw models highlighted that the in plane loads lateral and vertical forces during tight maneuvers can achieve up to 30 the value of the thrust in the straight ahead motion similar values can be experienced during transient or maneuvering at lower rudder angle due to interactions of propeller blades with coherent structures detaching from the hull bilges appendages ortolani et al 2015b these findings point out that off design conditions can anyhow be experienced either at low and high rudder angles depending on the flow features that characterize the propeller inflow the case at small rudder angle is very interesting from a practical perspective because this sailing condition is easily met in realistic operations by ships whenever the autopilot is active or to achieve route optimization for low fuel consumption the contribution of in plane forces to the response characteristics of the ship is relevant and their quantification is of crucial importance for the correct prediction of the propeller rudder interaction and hence for the response of the vessel during maneuvering broglia et al 2013 muscari et al 2017 dubbioso et al 2016 or motion in waves these circumstances are also important to consider in case of orientable propulsion units i e pod these devices replacing the action of the rudder to control and maneuver the ship might operate in severe oblique flow conditions these in turn cause the propeller blades to develop large fluctuating loads and in plane forces and moments that can be further amplified by dynamic effects during transients amini and steen 2011 and by ventilation effects caused by wave induced motions berchiche et al 2018 motion in waves is also critical for the overall behavior of the marine propeller because modifications to the inflow usually are associated with marked axial and tangential velocities gradients which have a detrimental effect for the development of cavitation patterns and related side effects i e pressure pulses and radiated noise taskar et al 2016 2017 in recent years more stringent requirements in terms of environmental pollution control co 2 and noise continuity of operation and safety during service drove a growth of interest in the topic of off design operations among industries and academic institutions as an example an extensive survey carried out by different classification societies i e dnv abs germanisher lloyd pointed out that one of the most frequent accidents of the propulsion system for on going vessels is the failure of the tail shaft bearing as a consequence of large radial loads which are developed by the propeller during maneuvers vartdal et al 2009 moreover innovative design approaches for the propulsor device that account for realistic ship operations scenarios have been recently proposed by the nato sto task group avt 204 assess the ability to optimize hull forms of sea vehicles for the best performance in a sea environment grigoropoulos et al 2017 specifically a marine propeller design optimization procedure was proposed accounting for hull wake calculated by cfd at different relative positions of the hull with respect to the wave profile rather than the standard approach that considers only the reference wake in calm water at the target speed the present work is aimed at providing a thorough analysis of the propeller off design behavior and performance by means of non standard experimental tests on a ship model equipped with two innovative set ups for the measurement of the propeller inflow and single blade loads especially the objective of the study is to assess the cause and effect relation between the propeller loads and its inflow in order to get a deeper insight on the interplay between the propeller and the wake of the hull in this regard we point out that to the authors knowledge this kind of analysis has not yet been pursued at this level of detail and completeness by experiments for design and off design operating conditions with the exception of atsavapranee et al 2010 jessup et al 1977 and boswell et al 1976 in atsavapranee et al 2010 the correlation of the propeller hub loads with particular emphasis on thrust torque and in plane loads generated during the steady turn of the turning maneuver was assessed for the d d g 51 model by means of the constrained circular motion test to this purpose a 6 component transducer was fitted in the propeller hub and the inflow was measured with and without running propellers the study highlighted the asymmetric trend of the loads developed by the propeller in the leeward and the windward side of the maneuver with particular emphasis on thrust and the side force that play a relevant role in the determination of the overall dynamic response of the vessel in jessup et al 1977 and boswell et al 1976 the single blade loads were associated with the wake survey carried out by pitot tubes only for the straight ahead motion moreover the availability of accurate experimental data is nowadays needed for the validation of numerical solvers upon which the preliminary design and research rely in fact to date most of the studies performed on the topic are mainly focused on the isolated propeller gutsche 1975 cassella et al 1989 amini and steen 2011 dubbioso et al 2013 yao 2015 that is not representative of realistic conditions characterized by considerable propeller wake interactions despite the feasibility of the numerical simulation of the complete ship with rotating propeller was demonstrated for self propulsion and maneuvering conditions mofidi and carrica 2014 muscari et al 2011 in depth analysis on propeller loads is not provided and most significantly validation is not assessed due to lack of accurate and exhaustive experimental data the set up for the single blade propeller loads relies on a six component load cell housed inside the propeller hub and attached to the blade root the propeller and shafting system were properly redesigned in order to transfer the signal from a rotating source to the hull this system was successfully tested on the same model during free running maneuvering tests providing high quality and high repeatability results ortolani and dubbioso 2019b a the monitoring of the single blade loads makes it possible a thorough inspection of the propeller performance because it better highlights the interaction with the wake and thus the origin of the propeller loads moreover the quantification of the fluctuating component of the loads is essential to analyze the propeller vibratory loads and their side effects pressure pulses noise when combined with field measurements usually in ship and propeller model testing propeller performance is evaluated by measurements of thrust and torque only the investigation of the complete set of propeller or single blade loads is challenging and few applications are documented in literature in particular for propeller in behind hull in earlier and most documented experiments the complete system of single blade loads was derived by a reduced set of measures or by multiple measures for example blaurock 1975 carried out single blade load measurements for a single screw merchant ship towed in pure oblique flow using a custom cantilever beam transducer constrained to the blade root and the hub this transducer measured only two blade bending moments at different points of the beam from which the blade thrust and side force were obtained assuming a linear distribution of the moments the complete system of single blade loads acting on a controllable pitch propeller during different sailing conditions for a constrained model in towing tank calm water waves and crash back ahead was obtained in jessup et al 1977 boswell et al 1976 and jessup and boswell 1982 in these experiments the loads were obtained from multiple measurements for the same operative condition changing the orientation of a custom two components transducer these data were affected by the presence of the dummy hull located behind the ship model and used to carry the propeller and the driving mechanism recently a six component transducer for measuring single blade loads was applied for free running maneuvering tests in waves savio et al 2013 and self propulsion in waves queutey et al 2014 despite only results for single run and reduced set of blade loads were presented the set up for the measurement of the propeller inflow is based upon a modified stereo particle image velocimetry hereafter spiv system optical techniques such as spiv have recently undergone a marked development in the field of ship hydrodynamics with applications both at model pereira et al 2003 calcagno et al 2005 and full scale kleinwächter et al 2017 an underwater modular versatile system for spiv measurements based on water proof casings for equipment protection was proposed and successfully used by pereira et al 2003 in towing tank testing in the present work an approach has been adopted based on the use of boroscopes as the optical piece of equipment in the spiv system rather than typical objective lenses the proposed methodology successfully employed in capone et al 2019 has to be preferred whenever low intrusivity high portability ease of calibration and compactness are required more importantly the set up approach does not make it necessary to develop ad hoc water proof casings to host cameras and other equipment the main drawbacks are related to the low light collection efficiency and the significant geometric deformations and astigmatic aberrations observed on the images taken through the boroscope lenses in this study the propeller off design behavior is investigated under steady drift conditions at a range of drift angles which are representative of weak and tight maneuver operations the range of drift angles is determined based on the free running model test carried out on the same twin screw model ortolani and dubbioso 2019b a the towing tank test campaign presented in this work makes it possible to combine propeller load measurements with inflow velocity measurements so that a deeper insight into the interactions between hull wake and propeller under complex operating conditions can be gained the paper is organized as follows in section 2 the test case and the two experimental set ups are described in section 3 the procedure for the analysis of velocimetry and load data are explained in section 4 the results in pure drift motion are compared with respect to the straight ahead condition and finally in section 5 the conclusions and future developments are outlined 2 experimental set up 2 1 model set up and test matrix the selected test case is a 1 25 scaled model of a fast twin screw twin rudder unit the main particulars of the model and the propeller are reported in table 1 where l b t c b are respectively the length between perpendiculars the overall breadth the draught and the blocking coefficient the ship and propeller model are depicted in fig 1 the model is equipped with a pair of stabilizer fins bilge keels horn rudders and the typical configuration of propulsive shaft supported with brackets the five blade propellers rotate inward from top with the starboard propeller rotating counterclockwise tests are carried out in the cnr inm towing tank facility the towing tank features a 475 m long 13 5 m wide and 6 5 m deep basin four electric main motors 92 kw and two secondary motors 45 kw can drive the tank carriage up to 15 m s with an accuracy of 1 mm s and speed fluctuations within 3 the ship model is made of fiberglass and reinforced with wooden inserts and is painted black in order to minimize laser sheet reflections during spiv measurements the drift angle β between the model axis and the direction of motion of the carriage can be set with an accuracy of 0 1 a schematics of the towing tank set up is shown in fig 2 experiments were carried out in straight ahead i e β 0 and steady drift motions with the aim to simulate weak β 13 and tight β 27 maneuvering conditions according to the data collected during free running maneuvering tests ortolani and dubbioso 2019b a froude number f r u 0 g l based on carriage speed and model length is 0 24 for straight ahead condition for steady drift at β 13 and β 27 carriage speed was set to u 1 0 95 u 0 and u 2 0 7 u 0 respectively to account for the speed loss during turning maneuver according to the top view of the set up in fig 2 positive and negative drift angles corresponds to a clock wise and counter clockwise turn of the bow respectively based on this approach and since all of the measurements were related to the starboard propeller the propeller inflow and loads at positive β are representative of the propeller at the leeward internal side during a maneuver whereas negative β corresponds to the propeller on the windward external conditions fig 3 shows the model during testing at drift angle β 27 2 2 instrumented propeller for this novel setup the model has been equipped with a custom instrumented propeller to measure the complete system of loads 3 forces and 3 moments acting on a single blade fig 4 to this aim a 6 components off the shelf transducer supporting one of the blades has been housed inside the propeller the calibrated ranges and measurement uncertainties of forces t x y z and moments q x y z provided by the manufacturer of the transducer are reported in table 2 power supply and signal from transducer channels are transmitted to the acquisition system through high quality low noise and low resistance slip rings the isolated and hull mounted propeller are shown in fig 4 the instrumented propeller is the starboard one 2 3 spiv system the main components of the spiv apparatus are boroscopes cameras laser unit sheet formation equipment synchronizer and acquisition hardware two olympus 800 mm long 16 mm diameter tube 60 view angle rigid borescopes are used in combination with tsi powerview 8mp high sensitivity cameras featuring a resolution of 3320 2496 pixels the choice of rigid and relatively large diameter boroscopes was driven by the requirements for minimization of optical aberrations and maximization of light collection the cameras bodies can be rotated with respect to the boroscopes in order to account for the scheimpflug condition the laser is a quantel evergreen nd yag unit max pulse energy 200 mj repetition rate 15 hz emitted light wavelength 532 nm a fin like structure shown in detail in fig 5 encloses the mirrors to carry over the laser beam to the appropriate optics i e spherical and cylindrical lenses for the sheet formation which are housed in a terminal head the fin like structure and the boroscopes are the only components of the measurement system which are underwater during acquisitions camera arrangement features two cameras hereafter a and b positioned at an angle of respectively α a 40 and α b 10 with respect to the perpendicular to the acquisition plane and looking at the same side of it both cameras are located at a distance r 800 mm from the acquisition plane the spiv apparatus is shown in fig 5 acquisitions are carried out without the propeller the measurement area has a size of 430 mm 260 mm and is located approximately 1 mm downstream of the propeller hub and centered on it as shown in fig 6 for each test condition 400 image pairs were acquired with an acquisition frequency of 3 hz cavitation generated microbubbles are used as flow tracing particles and are produced by three nuclei generators placed ahead of the towing carriage the suitability of such methodology in terms of piv tracers requirements particle response time and cut off frequency has been validated according to the work by lecoffre 1999 van overbrüggen et al 2014 and mei 1996 3 data analysis 3 1 forces measurement the procedure at the basis of the analysis of the single blade load signals is schematized in fig 7 for a generic run at fixed speed and drift angle at first the full acquisition is re sampled at steps of 1 degree of blade revolution since the ratio between the rotational speed and the acquisition sample rate changed during different test conditions this process allows a consistent statistical analysis of the data for each blade angle position by slicing the whole single run acquisition into blade revolution periods for each re sampled single run acquisition a twofold processing is carried out the first is performed on a θ basis i e the mean and standard deviation of the collection of cycles are calculated at each blade position in order to obtain the dependence on θ of the mean generic load as well as its uncertainty the second is carried out by calculating the same statistical quantities but on a cycle basis each acquisition consists of more than 200 cycles the measured loads i e forces t x y z and moments q x y z are originally measured with respect to the rotating frame centered at the blade root the transducer frame is depicted in fig 8 green colored axes and the axis are identified with t superscripts it is defined with x pointing forward z radially outward and y determined by right hand rule the data are converted to the frame rotating with the blade and centered at the propeller axis i e the blade frame identified by blue colored axes and b superscript additionally a third reference system the hub frame black axes and h superscript fixed with respect to the rotating blade is introduced to analyze the contribution of single blade to total propeller loads we point out that t x h t x b and q x h q x b hold the angular position θ of the b frame with respect to the h frame identifies the position of the blade during the cycle θ is positive oriented with the sense of rotation and is zero for the blade at the top position the measured loads include both the inertial and the hydrodynamic components in this work the analysis is focused on the hydrodynamic component derived by subtracting the inertial component from the measured global one the complete procedure is detailed in ortolani and dubbioso 2019b and is not repeated here for the sake of brevity in the following discussion the period of revolution of the propeller is divided into four sectors the first corresponding to 0 θ 90 and so on the loads are presented in the usual non dimensional form i e the forces k t x y z and moments k q x y z are made non dimensional by factors ρ n 2 d 4 and ρ n 2 d 5 respectively where d is the diameter n is the propeller rate of revolution rps and ρ is water density 3 2 spiv measurements the full three component velocity field u v w is obtained following a series of steps calibration image pre processing processing cross correlation and vector validation and reconstruction the whole process is carried out with the commercial software insight 4g by tsi inc spiv calibration is carried out with a two plane calibration target 300 300 mm size inter marker distance 10 mm with distance between planes in the x direction equal to 1 mm using a two plane target allows a 3 d calibration to be performed without the need to traverse the target adrian and westerweel 2011 the spiv system was validated by a series of free stream runs performed without the model ship average deviation from the reference free stream speed was between 3 to 5 with the latter figure reported in the outer image regions which are more affected by the stereo reconstruction error adrian and westerweel 2011 image pre processing is carried out in order to improve the effectiveness of the next cross correlation step fig 9 show a sample acquisition image used for stereo reconstruction obtained with the spiv apparatus background subtracted images are fed to a dewarping engine to address the perspective deformation introduced by the cameras viewing angle and the boroscope lenses this module applies a dewarping correction algorithm based on a selected window function and resamples the processed images bicubic interpolation paired to a hamming window was chosen as the most effective in terms of beneficial effect on the correlation calculation and computing time the algorithm employed in the cross correlation step implements an iterative multi pass multi grid image deformation scheme with window offset scarano 2001 optimal sub windows grid resolution is set to 128 128 pixels for the first pass and 64 64 pixels for the second and final passes the resulting vector grid spacing is 32 pixels a sub window overlap of 50 was set which corresponds to approximately 3 mm in the validation step spurious vectors are dropped according to local and global criteria the local test consists of a median test carried out on a 5 pixel square window for each vector in the grid each component is tested against the median value of the surrounding vector grid if it exceeds the median value by a certain threshold the vector is labeled as invalid and the secondary valid correlation peak is used for its replacement the global validation test is performed by considering the whole vector field and removing the vectors which exceed 2 times the global standard deviation in the final step the three dimensional vector field is reconstructed from left and right vector fields based on the information provided by the calibration mapping the sources of uncertainty in spiv measurements are mainly three the correlation errors in the two dimensional displacement calculation the stereoscopic three dimensional reconstruction errors the light sheet calibration target misalignment error the latter affects the stereo reconstruction and stems from the non perfect alignment of the laser sheet to the calibration target during the calibration phase the approach outlined in grizzi et al 2010 was followed to address this source of error an estimate of the overall measurement uncertainty is thus obtained by taking into account the first two error sources an agreed value for the two dimensional correlation uncertainty evaluated as the root mean square rms of the particle displacement is 0 1 pixel raffel et al 2018 for the assessment of the reconstruction error we follow the approach of prasad 2000 the uncertainty in the instantaneous velocity field is then estimated as a function of the cameras angle with respect to the acquisition plane and the mentioned correlation noise uncertainty the relative error is then defined for each velocity field component by estimating the corresponding particle displacement measurement error 1 r m s u v w u r m s δ x δ y δ z δ x where capital letters represent averaged quantities and δ x δ y and δ z are the calculated particle displacements in the reference frame as of fig 6 the right hand term of eq 1 is estimated via the following approximated relations from prasad 2000 2 r m s δ x r m s δ y a δ y b c o s α a 2 c o s α b 2 s i n α a α b 3 r m s δ y r m s δ y a δ y b s i n α a 2 s i n α b 2 s i n α a α b 4 r m s δ z r m s δ y a δ y b 2 where δ y a b represents the particle displacement in the two dimensional calculation for camera and a and b and the rms of particle displacement along y and w coordinates is assumed the same according to what previously stated the terms r m s δ y a δ y b can be set to 0 1 pixels whereas the other terms depend on the cameras relative positions given the average displacement in the x direction δ x 8 pixels the estimated relative errors for each component are r m s u u 3 1 r m s v u 1 7 and r m s w u 0 8 additionally accuracy of mean values is estimated by calculating the standard deviation of the mean with a confidence interval of 95 based on student distribution the resulting uncertainty of the mean values was found not to exceed 3 for all the components 4 results the characteristics of the blade loads can be clearly explained with the aid of inflow velocity data by applying 2 dimensional airfoil theory see fig 10 the loads are directly proportional to the incidence angle α of the propeller sections impinged by the incoming flow in fact given the propeller rate of revolution ω 2 π n the axial and tangential components of the wake field u a and v t respectively and the geometric pitch angle of the section θ the global tangential velocity the relative inflow angle and the incidence angle can be easily determined 5 axial velocity u a u tang velocity wake v t v c o s θ w s i n θ tang velocity total v t a n ω r v t inflow angle ϕ a t a n u a v t a n incidence α θ ϕ introducing the section hydrodynamic lift and drag coefficients c l and c d and the generic section position r along the blade span the forces and moments developed by the blades result from the cumulative contribution of the loads generated by the different blade sections from the hub r h to the tip r t without loss of generality eq 6 define blade thrust and its bending pitch moment q y 6 elemental thrust d t x d l c o s α d d s i n α sectional lift d l v t o t 2 c l α α sectional drag d d v t o t 2 c d α α 2 blade thrust t x r h r t d t x d r blade pitch moment q y r h r t d t x r d r on this basis the single blade loads are discussed referring to both the inflow characteristics and the incidence angle calculated by eq 5 in order to discriminate between the effects of the axial and tangential components on the generation of loads the inflow data obtained by spiv measurements are presented as contours of the mean normalized axial velocity component with streamlines of in plane velocity components overlaid the discussion is focused on single blade loads in the b frame while the blade loads characteristics in the h frame are briefly discussed at the end of the chapter to give an insight into the contribution of loads exerted by the propeller the time history of the single blade loads in the rotating frame are reported with error bands for the different maneuvering conditions only blade thrust t x side force t y and spindle moment q z are reported the bending moment q y and torque q x are not visualized because these components denote a similar trend of thrust and side force respectively assuming that the variation of these forces is dominant with respect to changes of the center of pressure see eq 6 in general it can be evidenced that both the mean and fluctuating components of the loads are different for the leeward and windward propeller the amplitude of the error bands is within 5 and of the same order detected for the free running maneuvering results ortolani and dubbioso 2019b a and furthermore it is not sensitive to drift angle 4 1 straight ahead motion during straight ahead motion the inflow to the propeller is characterized by a reduction of the axial velocity u only in the upper half of the disk due to the perturbation of the hull boundary layer and shaft brackets moreover the in plane velocity is upwards oriented as a consequence of the large cut off of the stern see fig 11 as a consequence the blade thrust k t x and absolute side force k t y fig 12 are higher during the first half of the cycle as confirmed by the distribution of the angle of attack experienced by the blade fig 13 the details of the loads fluctuation can be inspected following the blade during the revolution at progressive θ in particular from θ 0 to θ 45 the load increases due to the large defect of the axial speed after a slight decrease the loads experience a second peak with magnitude similar to the previous one at θ 130 in this case the peak is caused by the increase of the in plane component of the flow that is oppositely oriented to blade rotation and the corresponding increase of v t while u increases to the undisturbed value in the lower half of the disk the load increase caused by the tangential flow during the down stroke motion of the propeller confirms the results in jessup et al 1977 for a v shaped stern twin screw ship during the rotation in the lowest half of the disk the blade is unloaded because the axial flow is close to the nominal advance velocity the loads achieve a minimum at about θ 300 as the tangential flow is concurrent to the blade rotation i e v t 0 and therefore acts to reduce the local incidence of the blade foils as inferred from fig 10 finally in the 4th quadrant the loads increase as a consequence of the defect of u associated with the wake of the external astern bracket differently from blade thrust and side force the relation of the spindle torque k q z with the inflow characteristics is not immediate because this moment is representative of the torque of the hydro loads about the axis of the blade or alternatively it is governed by the shift of the point of application of the resultant force along the blade span and chord it can be observed fig 12 that the positive sign of k q z indicates that this moment acts to turn the blade about the spindle axis reducing the geometric pitch of the blade or alternatively the center of pressure of the loads oscillates always past the vertical axis of the blade according to the description proposed in ortolani and dubbioso 2019b a the reduction of the moment during the first half cycle can be explained with the fact that during the overloading the center of pressure shifts toward middle sections thus leading a lower arm with respect to the spindle axis on the contrary at lower loading the center of pressure moves to outer radii the blade is geometrically back skewed and the arm and moment increases 4 2 maneuvering internal propeller during maneuvering as a consequence of the different distribution of the wake the loads evolve differently during a complete blade revolution for the leeward β 0 and windward β 0 propeller and markedly differ with respect to the straight ahead case on leeward side at β 13 the wake is characterized by a relevant cross flow induced by the drift motion see fig 14 the axial velocity is perturbed by the wake past the shaft brackets that in this case is deflected to the 4th quadrant the in plane velocity is almost oriented at 45 over the disk with the exception of the 4th quadrant where it conserves the same orientation of the straight ahead condition moreover in the 1st quadrant the trace of a counterclockwise coherent structure detached from the centerline skeg appears at the outer radii at θ 45 further enhancing the in plane velocity as a consequence of the modification of the wake the trend of k t x and k t y is altered in the first half of the cycle starting from θ 0 these loads abruptly increase and reach a maximum value at θ 60 as a consequence of the interaction of the blade with the coherent structure in fact the orientation of the in plane velocity acts to increase the tangential velocity v t relative to the blade sections and hence the incidence angle as depicted in fig 10 this peak is 50 higher with respect to the maximum observed at β 0 afterwards the loads gradually diminish for 60 θ 180 and then remains constant in the 3rd quadrant because the tangential velocity being concurrent with propeller rotation counteracts the blade overloading caused by the reduction of the axial velocity associated with speed drop in particular this interplay is stressed in the latter sector in fact the gradual drop of u toward θ 270 and the concurrent increase of v t due to the upwards orientation of the inflow lead to an almost constant value of the incidence angle see fig 16 finally in the 4th quadrant the loads rise again due to the drop of the axial velocity caused by the wake of the brackets it is interesting to observe that the maximum values of the incidence angle experienced at about θ 10 at small radii due of the positive interference of u and v t do not coincide with the maximum overloading of the blade due to the small blade chord length and lower hydrodynamic efficiency of the sections close to the hub at β 27 the effects of flow separation past the hull and appendages consequent to severe cross flow is evidenced over most of the disk area in particular the strong reduction of the axial velocity u in the 1st and 3rd quadrants is associated with the deflected wake of the hull and to flow separation past the shaft respectively the large recirculation region clockwise rotating in the 4th quadrant is probably originated by the merging of smaller structures with the separated flow from the bilge keel the in plane flow is almost horizontal with the exception of the 3rd quadrant due to the perturbation of swirling flow see fig 17 the trend of k t x and k t y is qualitatively similar to β 13 although quantitative discrepancies exist due to the counteracting effect of u and v t to determine the incidence angle α see fig 19 the loads increase in the 1st quadrant due to the reduced u and reach a maximum at about θ 75 it is worth noticing that the maximum value is slightly smaller with respect to β 13 as well as the fluctuation of the load in the same interval in fact in this case at θ 0 the blade thrust and side force are higher due to the stronger cross flow after the peak and during the rotation in the 2nd quadrant the loads decrease monotonically because u slightly increases and the cross flow is concordant to blade rotation corresponding to a decrease of v t as a result the incidence angle α is reduced see fig 19 in the 3rd quadrant the loads immediately rise because the axial velocity defect caused by flow separation past the shaft is stronger than the unloading effect provided by the cross flow the increase rate is similar in the 4th quadrant due to the same mechanism moreover the increase of the tangential flow v t relative to the foil caused by the vortical structure at smaller radii overcomes the opposite contribution at outer sections yielding to a smoother blade wake interaction with respect to the one experienced at β 13 the behavior of the blade spindle torque k q z can be explained with the same considerations introduced for the straight ahead motion in fact it is straightforward to observe that the variation trend of this moment is associated with the movement of the hydrodynamic center toward the leading edge of the blade and inner radii given the skewed shape of the blade when the load increases and vice versa furthermore the orientation of k q z changes during the blade revolution period see blue colored lines in figs 15 and 18 the blade vortex interaction at β 13 causes the negative peak to be almost doubled and the load variation faster in the first half of the cycle with respect to higher drift angle on the contrary under tighter maneuver conditions k q z fluctuates rapidly in the second half of the cycle from positive to negative values as a consequence of the overloading caused by the passage of the blade through the separated flow from the propeller shaft 4 3 maneuvering external propeller on the windward side the features of the inflow resemble a pure oblique flow for both maneuvers see figs 20 and 23 the similar evolution of the inflow with drift angle is confirmed by the distributions of the incidence angle higher in the left half of the disk with respect to the opposite sector figs 22 and 25 more thoroughly at β 13 the inflow deviates from being homogeneously distributed only in the 1st quadrant this sector is characterized by the trace of swirling flow plausibly associated with vortical structures detached upstream from the bilge keels of the hull and or shaft the reduction of the axial speed can be partially related to the hull wake deflected toward the leeward side at β 27 the stronger cross flow causes the in plane velocity to be horizontal over the entire disk trace of vortex shedding from the shaft is evident close to the hub and the outer radii of the disk the latter is supposedly associated with longitudinal structure that is shed upwards from the shaft dubbioso et al 2017 consistently the blade thrust and side force experience a similar evolution and both the mean and peak values increase with the drift angle see figs 21 and 24 in particular k t x and k t y increase abruptly in the lower half of the disk reaching the maximum value about θ 220 because the cross flow opposite to blade rotation acts to increase the tangential flow v t relative to the blade sections then the loads decrease in the remaining part of the cycle because u is almost undisturbed and the effect of the cross flow reverses it is worth noticing that the maximum peak of k t x k t y during the tighter maneuver is 150 100 and 70 50 higher with respect to the maximum value experienced in rectilinear motion and the same maneuver on the leeward side respectively although the mean value of k q z diminishes toward negative values similarly to the leeward propeller its evolution over the period is almost inverted the fluctuation is consistent with the description provided for the previous conditions 4 4 single blade loads fixed frame the conversion of the single blade loads in the h frame allows to inspect the nature of loads that are exerted by the propeller onto the shaft in particular in addition to thrust and torque equivalent for the b and h frames the in plane forces and moments are listed in tables 3 5 in terms of mean value standard deviation σ and their ratio γ 0 to respectively blade thrust k t x h for forces and torque k q x h for moments in the straight ahead motion it has to be noticed that γ 0 is the same as the total propeller loads the values of the standard deviation σ are on average less than 10 of the mean and are of the same order of the error bands of the periodic blade loads the origin of the in plane bearing loads can be easily explained by examination of the imbalanced loads distribution between different quadrants of the disk dubbioso et al 2017 ortolani and dubbioso 2019b for example k q y h and k t y h are generated by difference of thrust and side force between the upper 1st and 4th quadrants and lower 2st and 3rd quadrants halves of the disk whereas k q z h and k t z h are generated by difference of thrust and side force between the left 1st and 2nd quadrants and right 3rd and 4th quadrants halves of the disk alternatively given the proportionality of the blade forces with the incidence angle fig 7 the loads imbalance can be gathered by the non homogeneous distributions of α in addition to the variation of the single blade thrust and side force during the period as discussed in previous paragraphs the oblique flow associated with the drift conditions causes the asymmetric monotonic rise of blade propeller thrust and torque as β increases consistently with the different evolution of the wake in particular on the windward side k t x h increases more than 130 and k q x h is higher than 85 as shown in table 5 whereas on the leeward side these values are more than halved 46 and 25 for thrust and torque respectively as reported in table 4 more interestingly in plane forces and moments are developed by the propellers in rectilinear motion and during maneuver on both the lee and windward side with respect to the straight ahead condition the variation of these components is higher than 200 for the tightest maneuver and the magnitude corresponds to a significant fraction of the thrust and torque generated in straight ahead motion in greater detail the side force k t y h in straight ahead motion is negligible i e 6 of k t x h consistently with the fact that the inflow is oriented in the vertical plane it experiences very similar values and almost linear trend with rudder angle for the windward and leeward propellers in case of the tightest maneuver i e β 27 its magnitude corresponds to about 30 and 35 of thrust for the leeward and windward propellers respectively this load component provides a stabilizing effect to the model i e it creates a moment that counteracts the turning motion according to the time histories of blade side force and distribution of incidence angles on the windward side see figs 22 and 25 k t y h is generated in the lower half of the disk where both the tangential velocity relative to the blade induced by the motion and the reduction of the axial speed due to the model speed drop act to increase the loads on the contrary in the upper half of the disk the side force is lower because the axial and tangential components incoming to the blade sections cancel out on the leeward side k t y h is generated in the upper half of the disk here the side force is higher due to the stronger velocity defect whereas in the lower half it is lower due to the cross flow that acts to reduce the incidence of blade sections on the same basis it is straightforward to relate the evolution of the pitching moment k q y h to the top bottom imbalance of the blade thrust in rectilinear motion the pitching moment is negative i e the propeller is pushed down because the higher load is developed during the encounter of the vertical tangential flow during the downstroke motion of the blade that causes the second peak to be stronger with respect to the first one at θ 45 regardless of β according to the load distribution k q y h acts to lift the propeller on the leeward side and the magnitude is similar to the one at β 0 on the windward side k q y h results always negative as a consequence of the higher blade load generated in the 2nd and 3rd quadrants it is worth noticing that the pitch moment at the highest drift angle is quadruplicated with respect to the straight ahead motion the trend of k t z h is completely different for the two propellers in straight ahead condition k t z h is upwards oriented and is non negligible 20 of the thrust because the blade develops an higher vertical force during the downstroke motion in fact both the axial velocity and tangential flow relative to the blade act to increase the incidence angle see fig 13 during drift motion on the windward side the vertical force is markedly reduced at the smaller drift angle and slightly increases at β 27 because the left right imbalance is enhanced by the overloading of the blade in the first half cycle caused by axial velocity defect past the shaft on the leeward side the trend of k t z h is non linear at β 13 it increases by almost 50 with respect to straight ahead motion due to blade wake interactions that enhance the blade loading during the first half of the cycle with respect to the other see fig 15 at β 27 k t z h drops it is halved with respect to the smaller drift because the higher side force developed by the blade during the upstroke phase weakens the left right imbalance the behavior of the yaw moment k q z h is clarified by the left right imbalances in straight ahead motion and for β 0 this moment is negative it pushes the propeller toward the centerline of the hull because the blade develops higher loads during the downstroke motion on the contrary k q z h is positive on the windward propeller it pushes the propeller to the right side because the highest blade thrust is experienced in the 3rd quadrant due to the cross flow opposite to blade rotation at the highest drift angle this load is more than doubled and almost triplicated with respect to straight ahead motion on the leeward and windward propeller respectively 5 conclusions in this paper the performance of a behind hull propeller in off design conditions has been studied in pure oblique towing the test conditions were designed to reproduce the equivalent drift angle at the propeller plane and model advance speed measured during free running maneuvering tests the choice of a towing tank test campaign makes it possible to carry out propeller loads and inflow measurements so that insight into their connections in off design conditions can be gained since the model is a twin screw both positive and negative drift angles were considered to investigate on the behavior of the propeller when it is on the windward and leeward side the assessment of the cause effect relation between the propeller loads and its inflow relied on two novel and non standard set ups in particular the flow field was measured by a boroscope based stereo piv system whereas the propeller loads were obtained by measuring of the single blade loads the velocimetry set up was developed for the sake of compactness desirable in case of experiments involving large amplitude motion of the ship model the combination with single blade loads acquisition allows detailed analysis of the interplay between the blade and the wake of the hull and makes it possible to assess the origin of the propeller loads and related side effects vibrations pressure pulses and noise the flow field survey showed that the propellers in the windward and leeward side exhibit a completely distinct behavior between each other and with respect to the straight ahead advance as a consequence of the complex wake development caused by the oblique towing the propeller on the windward side is characterized by an incoming flow that resembles a pure oblique flow that is weakly disturbed by the wake of the propeller shaft regardless of drift angle β on the contrary on the leeward side the inflow is affected by flow separation past the hull and detachment of coherent structures from bilge and appendages depending on the magnitude of the drift angle at smaller drift angle a well defined coherent structure passing through the propeller disk was detected whereas at higher rudder angle large structures stemming from the interaction of multiple vortex systems are reported consistently the loads developed by the leeward and windward propellers were reported to be well distinct in particular during the maneuvers the thrust and torque of both propellers increased with respect to the straight ahead condition and non negligible in plane loads were developed referring to the starboard propeller in straight ahead motion the blade thrust and side force increase in the upper half of the propeller disk due to the interaction with the wake of the appendages and in the inner left half of the disk as a consequence of the upwards oriented tangential flow as a result the propeller develops a non negligible vertical force with respect to the fixed hub frame and similar in plane moments that act to push the propeller in the 2nd quadrant i e the bottom left disk sector in drift motion the distribution of forces acting on the windward propeller is dramatically modified as a consequence of the almost homogeneous axial and tangential flow the cross flow drives the fluctuating character of the blade loads in the lower half of the disk it is opposite to blade rotation and thus acts to increase the blade incidence angle and loads while the vice versa holds for the upper half of the disk this imbalance causes the propeller side force and pitch moment to be dominant with respect to the others in plane components consistently with the similarity with pure oblique flow conditions conversely on the leeward side the blade loads are spurred by the interaction with the viscous wake characterized by multi scale vortical structures that are generated and evolve depending on the severity of the maneuver at smaller drift angle β 13 the blade loads rise due to the blade vortex interaction the vortex passage causes the blade thrust and side force to peak at a value which is almost twice as high as the maximum value measured during straight ahead conditions this interaction causes the vertical force developed by the propeller to further increase at the largest drift angle the gradients of the inflow are weakened due to the mixing of smaller structures and the further increase of loads is minimal moreover the measurements highlight a strong correlation of the spindle torque fundamental for the assessment of the structural reliability of controllable pitch propellers with blade loading and movement of the hydrodynamic center on the blade in particular the increase of blade loading was associated with the movement of the hydrodynamic center toward the leading edge of the blade and vice versa given the skewed shape of the blade the resulting spindle torque fluctuates to increase and reduce the pitch angle of the blade when load decreases and increases respectively from a practical perspective these studies demonstrate that critical conditions can be experienced both for tighter and weaker maneuvers for the former critical conditions are undergone by the external propeller which yield to overloading of thrust and torque that are almost doubled with respect to the normal straight ahead sailing on the contrary as far as the internal propeller is concerned weaker maneuvers can be critical for complex blade wake interactions that give onset to radial forces and moments of comparable magnitude to those experienced at tighter maneuver on the external shaft more importantly these are responsible for the amplification of propeller side effects pressure pulses noise vibrations finally the combination of novel set ups outlined in this work has proved to be reliable to provide high quality data for the validation of numerical solvers acknowledgments this work was partially funded by european defense agency project flowis contract no b 1399 esm1 gp the authors are grateful to f carta and r zagaglia for their valuable contribution to the technical definition and development of the instrumented propeller and for the adjustments and refinements to cad models as well as to the cnr inm towing tank personnel 
22144,in the field of marine hydrodynamics propeller operations in off design conditions represent a challenging topic that has been increasingly attracting interest among industry and research institutions over the ship operating life off design conditions and the associated modifications of the propeller inflow are connected to a wide range of events such as degradation of the overall efficiency amplification of unwanted side effects of propeller operations pressure pulses vibration and noise and ultimately failure of the ship propulsion system in this work the performance of a propeller operating in off design conditions is investigated by a comprehensive experimental activity aimed at synthesizing the cause and effect relation between the propeller loads and its inflow to this purpose two novel set ups are employed the first one is dedicated to the measurement of single blade loads whereas the second a boroscopic based stereo piv spiv system is focused on the inflow analysis the overall measurement apparatus is installed on a twin screw ship model experiments carried out in the cnr inm towing tank consist of straight ahead and steady drift motions at drift angles 1 3 and 2 7 this test matrix is representative of weak and tight maneuvering conditions keywords propeller off design ship maneuvering particle image velocimetry single blade loads measurements 1 introduction the development of marine propeller plays a pivotal role since the early stages of ship design as it is strictly related to crucial problems of the operating life of a ship i e propulsive efficiency vibrations and noise structural strength of the hull and components of the propulsion systems bearings issues related to the overall performance of the marine propeller are associated with the spatially non uniform and unsteady velocity field breslin and andersen 1994 traditionally the design and analysis of marine propeller are centered on the ideal case of straight motion in calm water however in realistic operating conditions the motion of the ship can be different due to environmental factors waves and wind counteracting control actions i e autopilot and maneuvering in these cases the cross flow induced by the motion and the consequent modification of the viscous wake of the hull alter the propeller blade hydrodynamics and consequently the resultant propeller loads the complete assessment of the problem is very challenging because the evolution of the inflow to the propeller depends on geometric details of the stern shape appendages configurations in case of multi screw driven ships and direction of rotation of the propulsors and is strongly coupled with the kinematic response of the body in general the flow impinging upon the propeller slows down due to the speed drop caused by the ship flow relative motion due to waves or maneuvering and is dominated by the concurrent presence of coherent structures and large separated flow regions as a matter of fact the propeller develops higher thrust and torque and more importantly relevant in plane forces and moments are generated as a consequence of non uniform inflow over the propeller disk that further stress the propulsion system shaftline and bearings and hull structure in fact an earlier analysis for a limited series of twin screw naval vessels at full scale highlighted that the power absorption of the external propeller i e on the windward side was almost doubled with respect to the internal one on the leeward side and exceeded by about 80 the value of the rectilinear navigation coraddu et al 2013 systematic investigation performed on captive atsavapranee et al 2010 and free running ortolani et al 2015a maneuvering twin screw models highlighted that the in plane loads lateral and vertical forces during tight maneuvers can achieve up to 30 the value of the thrust in the straight ahead motion similar values can be experienced during transient or maneuvering at lower rudder angle due to interactions of propeller blades with coherent structures detaching from the hull bilges appendages ortolani et al 2015b these findings point out that off design conditions can anyhow be experienced either at low and high rudder angles depending on the flow features that characterize the propeller inflow the case at small rudder angle is very interesting from a practical perspective because this sailing condition is easily met in realistic operations by ships whenever the autopilot is active or to achieve route optimization for low fuel consumption the contribution of in plane forces to the response characteristics of the ship is relevant and their quantification is of crucial importance for the correct prediction of the propeller rudder interaction and hence for the response of the vessel during maneuvering broglia et al 2013 muscari et al 2017 dubbioso et al 2016 or motion in waves these circumstances are also important to consider in case of orientable propulsion units i e pod these devices replacing the action of the rudder to control and maneuver the ship might operate in severe oblique flow conditions these in turn cause the propeller blades to develop large fluctuating loads and in plane forces and moments that can be further amplified by dynamic effects during transients amini and steen 2011 and by ventilation effects caused by wave induced motions berchiche et al 2018 motion in waves is also critical for the overall behavior of the marine propeller because modifications to the inflow usually are associated with marked axial and tangential velocities gradients which have a detrimental effect for the development of cavitation patterns and related side effects i e pressure pulses and radiated noise taskar et al 2016 2017 in recent years more stringent requirements in terms of environmental pollution control co 2 and noise continuity of operation and safety during service drove a growth of interest in the topic of off design operations among industries and academic institutions as an example an extensive survey carried out by different classification societies i e dnv abs germanisher lloyd pointed out that one of the most frequent accidents of the propulsion system for on going vessels is the failure of the tail shaft bearing as a consequence of large radial loads which are developed by the propeller during maneuvers vartdal et al 2009 moreover innovative design approaches for the propulsor device that account for realistic ship operations scenarios have been recently proposed by the nato sto task group avt 204 assess the ability to optimize hull forms of sea vehicles for the best performance in a sea environment grigoropoulos et al 2017 specifically a marine propeller design optimization procedure was proposed accounting for hull wake calculated by cfd at different relative positions of the hull with respect to the wave profile rather than the standard approach that considers only the reference wake in calm water at the target speed the present work is aimed at providing a thorough analysis of the propeller off design behavior and performance by means of non standard experimental tests on a ship model equipped with two innovative set ups for the measurement of the propeller inflow and single blade loads especially the objective of the study is to assess the cause and effect relation between the propeller loads and its inflow in order to get a deeper insight on the interplay between the propeller and the wake of the hull in this regard we point out that to the authors knowledge this kind of analysis has not yet been pursued at this level of detail and completeness by experiments for design and off design operating conditions with the exception of atsavapranee et al 2010 jessup et al 1977 and boswell et al 1976 in atsavapranee et al 2010 the correlation of the propeller hub loads with particular emphasis on thrust torque and in plane loads generated during the steady turn of the turning maneuver was assessed for the d d g 51 model by means of the constrained circular motion test to this purpose a 6 component transducer was fitted in the propeller hub and the inflow was measured with and without running propellers the study highlighted the asymmetric trend of the loads developed by the propeller in the leeward and the windward side of the maneuver with particular emphasis on thrust and the side force that play a relevant role in the determination of the overall dynamic response of the vessel in jessup et al 1977 and boswell et al 1976 the single blade loads were associated with the wake survey carried out by pitot tubes only for the straight ahead motion moreover the availability of accurate experimental data is nowadays needed for the validation of numerical solvers upon which the preliminary design and research rely in fact to date most of the studies performed on the topic are mainly focused on the isolated propeller gutsche 1975 cassella et al 1989 amini and steen 2011 dubbioso et al 2013 yao 2015 that is not representative of realistic conditions characterized by considerable propeller wake interactions despite the feasibility of the numerical simulation of the complete ship with rotating propeller was demonstrated for self propulsion and maneuvering conditions mofidi and carrica 2014 muscari et al 2011 in depth analysis on propeller loads is not provided and most significantly validation is not assessed due to lack of accurate and exhaustive experimental data the set up for the single blade propeller loads relies on a six component load cell housed inside the propeller hub and attached to the blade root the propeller and shafting system were properly redesigned in order to transfer the signal from a rotating source to the hull this system was successfully tested on the same model during free running maneuvering tests providing high quality and high repeatability results ortolani and dubbioso 2019b a the monitoring of the single blade loads makes it possible a thorough inspection of the propeller performance because it better highlights the interaction with the wake and thus the origin of the propeller loads moreover the quantification of the fluctuating component of the loads is essential to analyze the propeller vibratory loads and their side effects pressure pulses noise when combined with field measurements usually in ship and propeller model testing propeller performance is evaluated by measurements of thrust and torque only the investigation of the complete set of propeller or single blade loads is challenging and few applications are documented in literature in particular for propeller in behind hull in earlier and most documented experiments the complete system of single blade loads was derived by a reduced set of measures or by multiple measures for example blaurock 1975 carried out single blade load measurements for a single screw merchant ship towed in pure oblique flow using a custom cantilever beam transducer constrained to the blade root and the hub this transducer measured only two blade bending moments at different points of the beam from which the blade thrust and side force were obtained assuming a linear distribution of the moments the complete system of single blade loads acting on a controllable pitch propeller during different sailing conditions for a constrained model in towing tank calm water waves and crash back ahead was obtained in jessup et al 1977 boswell et al 1976 and jessup and boswell 1982 in these experiments the loads were obtained from multiple measurements for the same operative condition changing the orientation of a custom two components transducer these data were affected by the presence of the dummy hull located behind the ship model and used to carry the propeller and the driving mechanism recently a six component transducer for measuring single blade loads was applied for free running maneuvering tests in waves savio et al 2013 and self propulsion in waves queutey et al 2014 despite only results for single run and reduced set of blade loads were presented the set up for the measurement of the propeller inflow is based upon a modified stereo particle image velocimetry hereafter spiv system optical techniques such as spiv have recently undergone a marked development in the field of ship hydrodynamics with applications both at model pereira et al 2003 calcagno et al 2005 and full scale kleinwächter et al 2017 an underwater modular versatile system for spiv measurements based on water proof casings for equipment protection was proposed and successfully used by pereira et al 2003 in towing tank testing in the present work an approach has been adopted based on the use of boroscopes as the optical piece of equipment in the spiv system rather than typical objective lenses the proposed methodology successfully employed in capone et al 2019 has to be preferred whenever low intrusivity high portability ease of calibration and compactness are required more importantly the set up approach does not make it necessary to develop ad hoc water proof casings to host cameras and other equipment the main drawbacks are related to the low light collection efficiency and the significant geometric deformations and astigmatic aberrations observed on the images taken through the boroscope lenses in this study the propeller off design behavior is investigated under steady drift conditions at a range of drift angles which are representative of weak and tight maneuver operations the range of drift angles is determined based on the free running model test carried out on the same twin screw model ortolani and dubbioso 2019b a the towing tank test campaign presented in this work makes it possible to combine propeller load measurements with inflow velocity measurements so that a deeper insight into the interactions between hull wake and propeller under complex operating conditions can be gained the paper is organized as follows in section 2 the test case and the two experimental set ups are described in section 3 the procedure for the analysis of velocimetry and load data are explained in section 4 the results in pure drift motion are compared with respect to the straight ahead condition and finally in section 5 the conclusions and future developments are outlined 2 experimental set up 2 1 model set up and test matrix the selected test case is a 1 25 scaled model of a fast twin screw twin rudder unit the main particulars of the model and the propeller are reported in table 1 where l b t c b are respectively the length between perpendiculars the overall breadth the draught and the blocking coefficient the ship and propeller model are depicted in fig 1 the model is equipped with a pair of stabilizer fins bilge keels horn rudders and the typical configuration of propulsive shaft supported with brackets the five blade propellers rotate inward from top with the starboard propeller rotating counterclockwise tests are carried out in the cnr inm towing tank facility the towing tank features a 475 m long 13 5 m wide and 6 5 m deep basin four electric main motors 92 kw and two secondary motors 45 kw can drive the tank carriage up to 15 m s with an accuracy of 1 mm s and speed fluctuations within 3 the ship model is made of fiberglass and reinforced with wooden inserts and is painted black in order to minimize laser sheet reflections during spiv measurements the drift angle β between the model axis and the direction of motion of the carriage can be set with an accuracy of 0 1 a schematics of the towing tank set up is shown in fig 2 experiments were carried out in straight ahead i e β 0 and steady drift motions with the aim to simulate weak β 13 and tight β 27 maneuvering conditions according to the data collected during free running maneuvering tests ortolani and dubbioso 2019b a froude number f r u 0 g l based on carriage speed and model length is 0 24 for straight ahead condition for steady drift at β 13 and β 27 carriage speed was set to u 1 0 95 u 0 and u 2 0 7 u 0 respectively to account for the speed loss during turning maneuver according to the top view of the set up in fig 2 positive and negative drift angles corresponds to a clock wise and counter clockwise turn of the bow respectively based on this approach and since all of the measurements were related to the starboard propeller the propeller inflow and loads at positive β are representative of the propeller at the leeward internal side during a maneuver whereas negative β corresponds to the propeller on the windward external conditions fig 3 shows the model during testing at drift angle β 27 2 2 instrumented propeller for this novel setup the model has been equipped with a custom instrumented propeller to measure the complete system of loads 3 forces and 3 moments acting on a single blade fig 4 to this aim a 6 components off the shelf transducer supporting one of the blades has been housed inside the propeller the calibrated ranges and measurement uncertainties of forces t x y z and moments q x y z provided by the manufacturer of the transducer are reported in table 2 power supply and signal from transducer channels are transmitted to the acquisition system through high quality low noise and low resistance slip rings the isolated and hull mounted propeller are shown in fig 4 the instrumented propeller is the starboard one 2 3 spiv system the main components of the spiv apparatus are boroscopes cameras laser unit sheet formation equipment synchronizer and acquisition hardware two olympus 800 mm long 16 mm diameter tube 60 view angle rigid borescopes are used in combination with tsi powerview 8mp high sensitivity cameras featuring a resolution of 3320 2496 pixels the choice of rigid and relatively large diameter boroscopes was driven by the requirements for minimization of optical aberrations and maximization of light collection the cameras bodies can be rotated with respect to the boroscopes in order to account for the scheimpflug condition the laser is a quantel evergreen nd yag unit max pulse energy 200 mj repetition rate 15 hz emitted light wavelength 532 nm a fin like structure shown in detail in fig 5 encloses the mirrors to carry over the laser beam to the appropriate optics i e spherical and cylindrical lenses for the sheet formation which are housed in a terminal head the fin like structure and the boroscopes are the only components of the measurement system which are underwater during acquisitions camera arrangement features two cameras hereafter a and b positioned at an angle of respectively α a 40 and α b 10 with respect to the perpendicular to the acquisition plane and looking at the same side of it both cameras are located at a distance r 800 mm from the acquisition plane the spiv apparatus is shown in fig 5 acquisitions are carried out without the propeller the measurement area has a size of 430 mm 260 mm and is located approximately 1 mm downstream of the propeller hub and centered on it as shown in fig 6 for each test condition 400 image pairs were acquired with an acquisition frequency of 3 hz cavitation generated microbubbles are used as flow tracing particles and are produced by three nuclei generators placed ahead of the towing carriage the suitability of such methodology in terms of piv tracers requirements particle response time and cut off frequency has been validated according to the work by lecoffre 1999 van overbrüggen et al 2014 and mei 1996 3 data analysis 3 1 forces measurement the procedure at the basis of the analysis of the single blade load signals is schematized in fig 7 for a generic run at fixed speed and drift angle at first the full acquisition is re sampled at steps of 1 degree of blade revolution since the ratio between the rotational speed and the acquisition sample rate changed during different test conditions this process allows a consistent statistical analysis of the data for each blade angle position by slicing the whole single run acquisition into blade revolution periods for each re sampled single run acquisition a twofold processing is carried out the first is performed on a θ basis i e the mean and standard deviation of the collection of cycles are calculated at each blade position in order to obtain the dependence on θ of the mean generic load as well as its uncertainty the second is carried out by calculating the same statistical quantities but on a cycle basis each acquisition consists of more than 200 cycles the measured loads i e forces t x y z and moments q x y z are originally measured with respect to the rotating frame centered at the blade root the transducer frame is depicted in fig 8 green colored axes and the axis are identified with t superscripts it is defined with x pointing forward z radially outward and y determined by right hand rule the data are converted to the frame rotating with the blade and centered at the propeller axis i e the blade frame identified by blue colored axes and b superscript additionally a third reference system the hub frame black axes and h superscript fixed with respect to the rotating blade is introduced to analyze the contribution of single blade to total propeller loads we point out that t x h t x b and q x h q x b hold the angular position θ of the b frame with respect to the h frame identifies the position of the blade during the cycle θ is positive oriented with the sense of rotation and is zero for the blade at the top position the measured loads include both the inertial and the hydrodynamic components in this work the analysis is focused on the hydrodynamic component derived by subtracting the inertial component from the measured global one the complete procedure is detailed in ortolani and dubbioso 2019b and is not repeated here for the sake of brevity in the following discussion the period of revolution of the propeller is divided into four sectors the first corresponding to 0 θ 90 and so on the loads are presented in the usual non dimensional form i e the forces k t x y z and moments k q x y z are made non dimensional by factors ρ n 2 d 4 and ρ n 2 d 5 respectively where d is the diameter n is the propeller rate of revolution rps and ρ is water density 3 2 spiv measurements the full three component velocity field u v w is obtained following a series of steps calibration image pre processing processing cross correlation and vector validation and reconstruction the whole process is carried out with the commercial software insight 4g by tsi inc spiv calibration is carried out with a two plane calibration target 300 300 mm size inter marker distance 10 mm with distance between planes in the x direction equal to 1 mm using a two plane target allows a 3 d calibration to be performed without the need to traverse the target adrian and westerweel 2011 the spiv system was validated by a series of free stream runs performed without the model ship average deviation from the reference free stream speed was between 3 to 5 with the latter figure reported in the outer image regions which are more affected by the stereo reconstruction error adrian and westerweel 2011 image pre processing is carried out in order to improve the effectiveness of the next cross correlation step fig 9 show a sample acquisition image used for stereo reconstruction obtained with the spiv apparatus background subtracted images are fed to a dewarping engine to address the perspective deformation introduced by the cameras viewing angle and the boroscope lenses this module applies a dewarping correction algorithm based on a selected window function and resamples the processed images bicubic interpolation paired to a hamming window was chosen as the most effective in terms of beneficial effect on the correlation calculation and computing time the algorithm employed in the cross correlation step implements an iterative multi pass multi grid image deformation scheme with window offset scarano 2001 optimal sub windows grid resolution is set to 128 128 pixels for the first pass and 64 64 pixels for the second and final passes the resulting vector grid spacing is 32 pixels a sub window overlap of 50 was set which corresponds to approximately 3 mm in the validation step spurious vectors are dropped according to local and global criteria the local test consists of a median test carried out on a 5 pixel square window for each vector in the grid each component is tested against the median value of the surrounding vector grid if it exceeds the median value by a certain threshold the vector is labeled as invalid and the secondary valid correlation peak is used for its replacement the global validation test is performed by considering the whole vector field and removing the vectors which exceed 2 times the global standard deviation in the final step the three dimensional vector field is reconstructed from left and right vector fields based on the information provided by the calibration mapping the sources of uncertainty in spiv measurements are mainly three the correlation errors in the two dimensional displacement calculation the stereoscopic three dimensional reconstruction errors the light sheet calibration target misalignment error the latter affects the stereo reconstruction and stems from the non perfect alignment of the laser sheet to the calibration target during the calibration phase the approach outlined in grizzi et al 2010 was followed to address this source of error an estimate of the overall measurement uncertainty is thus obtained by taking into account the first two error sources an agreed value for the two dimensional correlation uncertainty evaluated as the root mean square rms of the particle displacement is 0 1 pixel raffel et al 2018 for the assessment of the reconstruction error we follow the approach of prasad 2000 the uncertainty in the instantaneous velocity field is then estimated as a function of the cameras angle with respect to the acquisition plane and the mentioned correlation noise uncertainty the relative error is then defined for each velocity field component by estimating the corresponding particle displacement measurement error 1 r m s u v w u r m s δ x δ y δ z δ x where capital letters represent averaged quantities and δ x δ y and δ z are the calculated particle displacements in the reference frame as of fig 6 the right hand term of eq 1 is estimated via the following approximated relations from prasad 2000 2 r m s δ x r m s δ y a δ y b c o s α a 2 c o s α b 2 s i n α a α b 3 r m s δ y r m s δ y a δ y b s i n α a 2 s i n α b 2 s i n α a α b 4 r m s δ z r m s δ y a δ y b 2 where δ y a b represents the particle displacement in the two dimensional calculation for camera and a and b and the rms of particle displacement along y and w coordinates is assumed the same according to what previously stated the terms r m s δ y a δ y b can be set to 0 1 pixels whereas the other terms depend on the cameras relative positions given the average displacement in the x direction δ x 8 pixels the estimated relative errors for each component are r m s u u 3 1 r m s v u 1 7 and r m s w u 0 8 additionally accuracy of mean values is estimated by calculating the standard deviation of the mean with a confidence interval of 95 based on student distribution the resulting uncertainty of the mean values was found not to exceed 3 for all the components 4 results the characteristics of the blade loads can be clearly explained with the aid of inflow velocity data by applying 2 dimensional airfoil theory see fig 10 the loads are directly proportional to the incidence angle α of the propeller sections impinged by the incoming flow in fact given the propeller rate of revolution ω 2 π n the axial and tangential components of the wake field u a and v t respectively and the geometric pitch angle of the section θ the global tangential velocity the relative inflow angle and the incidence angle can be easily determined 5 axial velocity u a u tang velocity wake v t v c o s θ w s i n θ tang velocity total v t a n ω r v t inflow angle ϕ a t a n u a v t a n incidence α θ ϕ introducing the section hydrodynamic lift and drag coefficients c l and c d and the generic section position r along the blade span the forces and moments developed by the blades result from the cumulative contribution of the loads generated by the different blade sections from the hub r h to the tip r t without loss of generality eq 6 define blade thrust and its bending pitch moment q y 6 elemental thrust d t x d l c o s α d d s i n α sectional lift d l v t o t 2 c l α α sectional drag d d v t o t 2 c d α α 2 blade thrust t x r h r t d t x d r blade pitch moment q y r h r t d t x r d r on this basis the single blade loads are discussed referring to both the inflow characteristics and the incidence angle calculated by eq 5 in order to discriminate between the effects of the axial and tangential components on the generation of loads the inflow data obtained by spiv measurements are presented as contours of the mean normalized axial velocity component with streamlines of in plane velocity components overlaid the discussion is focused on single blade loads in the b frame while the blade loads characteristics in the h frame are briefly discussed at the end of the chapter to give an insight into the contribution of loads exerted by the propeller the time history of the single blade loads in the rotating frame are reported with error bands for the different maneuvering conditions only blade thrust t x side force t y and spindle moment q z are reported the bending moment q y and torque q x are not visualized because these components denote a similar trend of thrust and side force respectively assuming that the variation of these forces is dominant with respect to changes of the center of pressure see eq 6 in general it can be evidenced that both the mean and fluctuating components of the loads are different for the leeward and windward propeller the amplitude of the error bands is within 5 and of the same order detected for the free running maneuvering results ortolani and dubbioso 2019b a and furthermore it is not sensitive to drift angle 4 1 straight ahead motion during straight ahead motion the inflow to the propeller is characterized by a reduction of the axial velocity u only in the upper half of the disk due to the perturbation of the hull boundary layer and shaft brackets moreover the in plane velocity is upwards oriented as a consequence of the large cut off of the stern see fig 11 as a consequence the blade thrust k t x and absolute side force k t y fig 12 are higher during the first half of the cycle as confirmed by the distribution of the angle of attack experienced by the blade fig 13 the details of the loads fluctuation can be inspected following the blade during the revolution at progressive θ in particular from θ 0 to θ 45 the load increases due to the large defect of the axial speed after a slight decrease the loads experience a second peak with magnitude similar to the previous one at θ 130 in this case the peak is caused by the increase of the in plane component of the flow that is oppositely oriented to blade rotation and the corresponding increase of v t while u increases to the undisturbed value in the lower half of the disk the load increase caused by the tangential flow during the down stroke motion of the propeller confirms the results in jessup et al 1977 for a v shaped stern twin screw ship during the rotation in the lowest half of the disk the blade is unloaded because the axial flow is close to the nominal advance velocity the loads achieve a minimum at about θ 300 as the tangential flow is concurrent to the blade rotation i e v t 0 and therefore acts to reduce the local incidence of the blade foils as inferred from fig 10 finally in the 4th quadrant the loads increase as a consequence of the defect of u associated with the wake of the external astern bracket differently from blade thrust and side force the relation of the spindle torque k q z with the inflow characteristics is not immediate because this moment is representative of the torque of the hydro loads about the axis of the blade or alternatively it is governed by the shift of the point of application of the resultant force along the blade span and chord it can be observed fig 12 that the positive sign of k q z indicates that this moment acts to turn the blade about the spindle axis reducing the geometric pitch of the blade or alternatively the center of pressure of the loads oscillates always past the vertical axis of the blade according to the description proposed in ortolani and dubbioso 2019b a the reduction of the moment during the first half cycle can be explained with the fact that during the overloading the center of pressure shifts toward middle sections thus leading a lower arm with respect to the spindle axis on the contrary at lower loading the center of pressure moves to outer radii the blade is geometrically back skewed and the arm and moment increases 4 2 maneuvering internal propeller during maneuvering as a consequence of the different distribution of the wake the loads evolve differently during a complete blade revolution for the leeward β 0 and windward β 0 propeller and markedly differ with respect to the straight ahead case on leeward side at β 13 the wake is characterized by a relevant cross flow induced by the drift motion see fig 14 the axial velocity is perturbed by the wake past the shaft brackets that in this case is deflected to the 4th quadrant the in plane velocity is almost oriented at 45 over the disk with the exception of the 4th quadrant where it conserves the same orientation of the straight ahead condition moreover in the 1st quadrant the trace of a counterclockwise coherent structure detached from the centerline skeg appears at the outer radii at θ 45 further enhancing the in plane velocity as a consequence of the modification of the wake the trend of k t x and k t y is altered in the first half of the cycle starting from θ 0 these loads abruptly increase and reach a maximum value at θ 60 as a consequence of the interaction of the blade with the coherent structure in fact the orientation of the in plane velocity acts to increase the tangential velocity v t relative to the blade sections and hence the incidence angle as depicted in fig 10 this peak is 50 higher with respect to the maximum observed at β 0 afterwards the loads gradually diminish for 60 θ 180 and then remains constant in the 3rd quadrant because the tangential velocity being concurrent with propeller rotation counteracts the blade overloading caused by the reduction of the axial velocity associated with speed drop in particular this interplay is stressed in the latter sector in fact the gradual drop of u toward θ 270 and the concurrent increase of v t due to the upwards orientation of the inflow lead to an almost constant value of the incidence angle see fig 16 finally in the 4th quadrant the loads rise again due to the drop of the axial velocity caused by the wake of the brackets it is interesting to observe that the maximum values of the incidence angle experienced at about θ 10 at small radii due of the positive interference of u and v t do not coincide with the maximum overloading of the blade due to the small blade chord length and lower hydrodynamic efficiency of the sections close to the hub at β 27 the effects of flow separation past the hull and appendages consequent to severe cross flow is evidenced over most of the disk area in particular the strong reduction of the axial velocity u in the 1st and 3rd quadrants is associated with the deflected wake of the hull and to flow separation past the shaft respectively the large recirculation region clockwise rotating in the 4th quadrant is probably originated by the merging of smaller structures with the separated flow from the bilge keel the in plane flow is almost horizontal with the exception of the 3rd quadrant due to the perturbation of swirling flow see fig 17 the trend of k t x and k t y is qualitatively similar to β 13 although quantitative discrepancies exist due to the counteracting effect of u and v t to determine the incidence angle α see fig 19 the loads increase in the 1st quadrant due to the reduced u and reach a maximum at about θ 75 it is worth noticing that the maximum value is slightly smaller with respect to β 13 as well as the fluctuation of the load in the same interval in fact in this case at θ 0 the blade thrust and side force are higher due to the stronger cross flow after the peak and during the rotation in the 2nd quadrant the loads decrease monotonically because u slightly increases and the cross flow is concordant to blade rotation corresponding to a decrease of v t as a result the incidence angle α is reduced see fig 19 in the 3rd quadrant the loads immediately rise because the axial velocity defect caused by flow separation past the shaft is stronger than the unloading effect provided by the cross flow the increase rate is similar in the 4th quadrant due to the same mechanism moreover the increase of the tangential flow v t relative to the foil caused by the vortical structure at smaller radii overcomes the opposite contribution at outer sections yielding to a smoother blade wake interaction with respect to the one experienced at β 13 the behavior of the blade spindle torque k q z can be explained with the same considerations introduced for the straight ahead motion in fact it is straightforward to observe that the variation trend of this moment is associated with the movement of the hydrodynamic center toward the leading edge of the blade and inner radii given the skewed shape of the blade when the load increases and vice versa furthermore the orientation of k q z changes during the blade revolution period see blue colored lines in figs 15 and 18 the blade vortex interaction at β 13 causes the negative peak to be almost doubled and the load variation faster in the first half of the cycle with respect to higher drift angle on the contrary under tighter maneuver conditions k q z fluctuates rapidly in the second half of the cycle from positive to negative values as a consequence of the overloading caused by the passage of the blade through the separated flow from the propeller shaft 4 3 maneuvering external propeller on the windward side the features of the inflow resemble a pure oblique flow for both maneuvers see figs 20 and 23 the similar evolution of the inflow with drift angle is confirmed by the distributions of the incidence angle higher in the left half of the disk with respect to the opposite sector figs 22 and 25 more thoroughly at β 13 the inflow deviates from being homogeneously distributed only in the 1st quadrant this sector is characterized by the trace of swirling flow plausibly associated with vortical structures detached upstream from the bilge keels of the hull and or shaft the reduction of the axial speed can be partially related to the hull wake deflected toward the leeward side at β 27 the stronger cross flow causes the in plane velocity to be horizontal over the entire disk trace of vortex shedding from the shaft is evident close to the hub and the outer radii of the disk the latter is supposedly associated with longitudinal structure that is shed upwards from the shaft dubbioso et al 2017 consistently the blade thrust and side force experience a similar evolution and both the mean and peak values increase with the drift angle see figs 21 and 24 in particular k t x and k t y increase abruptly in the lower half of the disk reaching the maximum value about θ 220 because the cross flow opposite to blade rotation acts to increase the tangential flow v t relative to the blade sections then the loads decrease in the remaining part of the cycle because u is almost undisturbed and the effect of the cross flow reverses it is worth noticing that the maximum peak of k t x k t y during the tighter maneuver is 150 100 and 70 50 higher with respect to the maximum value experienced in rectilinear motion and the same maneuver on the leeward side respectively although the mean value of k q z diminishes toward negative values similarly to the leeward propeller its evolution over the period is almost inverted the fluctuation is consistent with the description provided for the previous conditions 4 4 single blade loads fixed frame the conversion of the single blade loads in the h frame allows to inspect the nature of loads that are exerted by the propeller onto the shaft in particular in addition to thrust and torque equivalent for the b and h frames the in plane forces and moments are listed in tables 3 5 in terms of mean value standard deviation σ and their ratio γ 0 to respectively blade thrust k t x h for forces and torque k q x h for moments in the straight ahead motion it has to be noticed that γ 0 is the same as the total propeller loads the values of the standard deviation σ are on average less than 10 of the mean and are of the same order of the error bands of the periodic blade loads the origin of the in plane bearing loads can be easily explained by examination of the imbalanced loads distribution between different quadrants of the disk dubbioso et al 2017 ortolani and dubbioso 2019b for example k q y h and k t y h are generated by difference of thrust and side force between the upper 1st and 4th quadrants and lower 2st and 3rd quadrants halves of the disk whereas k q z h and k t z h are generated by difference of thrust and side force between the left 1st and 2nd quadrants and right 3rd and 4th quadrants halves of the disk alternatively given the proportionality of the blade forces with the incidence angle fig 7 the loads imbalance can be gathered by the non homogeneous distributions of α in addition to the variation of the single blade thrust and side force during the period as discussed in previous paragraphs the oblique flow associated with the drift conditions causes the asymmetric monotonic rise of blade propeller thrust and torque as β increases consistently with the different evolution of the wake in particular on the windward side k t x h increases more than 130 and k q x h is higher than 85 as shown in table 5 whereas on the leeward side these values are more than halved 46 and 25 for thrust and torque respectively as reported in table 4 more interestingly in plane forces and moments are developed by the propellers in rectilinear motion and during maneuver on both the lee and windward side with respect to the straight ahead condition the variation of these components is higher than 200 for the tightest maneuver and the magnitude corresponds to a significant fraction of the thrust and torque generated in straight ahead motion in greater detail the side force k t y h in straight ahead motion is negligible i e 6 of k t x h consistently with the fact that the inflow is oriented in the vertical plane it experiences very similar values and almost linear trend with rudder angle for the windward and leeward propellers in case of the tightest maneuver i e β 27 its magnitude corresponds to about 30 and 35 of thrust for the leeward and windward propellers respectively this load component provides a stabilizing effect to the model i e it creates a moment that counteracts the turning motion according to the time histories of blade side force and distribution of incidence angles on the windward side see figs 22 and 25 k t y h is generated in the lower half of the disk where both the tangential velocity relative to the blade induced by the motion and the reduction of the axial speed due to the model speed drop act to increase the loads on the contrary in the upper half of the disk the side force is lower because the axial and tangential components incoming to the blade sections cancel out on the leeward side k t y h is generated in the upper half of the disk here the side force is higher due to the stronger velocity defect whereas in the lower half it is lower due to the cross flow that acts to reduce the incidence of blade sections on the same basis it is straightforward to relate the evolution of the pitching moment k q y h to the top bottom imbalance of the blade thrust in rectilinear motion the pitching moment is negative i e the propeller is pushed down because the higher load is developed during the encounter of the vertical tangential flow during the downstroke motion of the blade that causes the second peak to be stronger with respect to the first one at θ 45 regardless of β according to the load distribution k q y h acts to lift the propeller on the leeward side and the magnitude is similar to the one at β 0 on the windward side k q y h results always negative as a consequence of the higher blade load generated in the 2nd and 3rd quadrants it is worth noticing that the pitch moment at the highest drift angle is quadruplicated with respect to the straight ahead motion the trend of k t z h is completely different for the two propellers in straight ahead condition k t z h is upwards oriented and is non negligible 20 of the thrust because the blade develops an higher vertical force during the downstroke motion in fact both the axial velocity and tangential flow relative to the blade act to increase the incidence angle see fig 13 during drift motion on the windward side the vertical force is markedly reduced at the smaller drift angle and slightly increases at β 27 because the left right imbalance is enhanced by the overloading of the blade in the first half cycle caused by axial velocity defect past the shaft on the leeward side the trend of k t z h is non linear at β 13 it increases by almost 50 with respect to straight ahead motion due to blade wake interactions that enhance the blade loading during the first half of the cycle with respect to the other see fig 15 at β 27 k t z h drops it is halved with respect to the smaller drift because the higher side force developed by the blade during the upstroke phase weakens the left right imbalance the behavior of the yaw moment k q z h is clarified by the left right imbalances in straight ahead motion and for β 0 this moment is negative it pushes the propeller toward the centerline of the hull because the blade develops higher loads during the downstroke motion on the contrary k q z h is positive on the windward propeller it pushes the propeller to the right side because the highest blade thrust is experienced in the 3rd quadrant due to the cross flow opposite to blade rotation at the highest drift angle this load is more than doubled and almost triplicated with respect to straight ahead motion on the leeward and windward propeller respectively 5 conclusions in this paper the performance of a behind hull propeller in off design conditions has been studied in pure oblique towing the test conditions were designed to reproduce the equivalent drift angle at the propeller plane and model advance speed measured during free running maneuvering tests the choice of a towing tank test campaign makes it possible to carry out propeller loads and inflow measurements so that insight into their connections in off design conditions can be gained since the model is a twin screw both positive and negative drift angles were considered to investigate on the behavior of the propeller when it is on the windward and leeward side the assessment of the cause effect relation between the propeller loads and its inflow relied on two novel and non standard set ups in particular the flow field was measured by a boroscope based stereo piv system whereas the propeller loads were obtained by measuring of the single blade loads the velocimetry set up was developed for the sake of compactness desirable in case of experiments involving large amplitude motion of the ship model the combination with single blade loads acquisition allows detailed analysis of the interplay between the blade and the wake of the hull and makes it possible to assess the origin of the propeller loads and related side effects vibrations pressure pulses and noise the flow field survey showed that the propellers in the windward and leeward side exhibit a completely distinct behavior between each other and with respect to the straight ahead advance as a consequence of the complex wake development caused by the oblique towing the propeller on the windward side is characterized by an incoming flow that resembles a pure oblique flow that is weakly disturbed by the wake of the propeller shaft regardless of drift angle β on the contrary on the leeward side the inflow is affected by flow separation past the hull and detachment of coherent structures from bilge and appendages depending on the magnitude of the drift angle at smaller drift angle a well defined coherent structure passing through the propeller disk was detected whereas at higher rudder angle large structures stemming from the interaction of multiple vortex systems are reported consistently the loads developed by the leeward and windward propellers were reported to be well distinct in particular during the maneuvers the thrust and torque of both propellers increased with respect to the straight ahead condition and non negligible in plane loads were developed referring to the starboard propeller in straight ahead motion the blade thrust and side force increase in the upper half of the propeller disk due to the interaction with the wake of the appendages and in the inner left half of the disk as a consequence of the upwards oriented tangential flow as a result the propeller develops a non negligible vertical force with respect to the fixed hub frame and similar in plane moments that act to push the propeller in the 2nd quadrant i e the bottom left disk sector in drift motion the distribution of forces acting on the windward propeller is dramatically modified as a consequence of the almost homogeneous axial and tangential flow the cross flow drives the fluctuating character of the blade loads in the lower half of the disk it is opposite to blade rotation and thus acts to increase the blade incidence angle and loads while the vice versa holds for the upper half of the disk this imbalance causes the propeller side force and pitch moment to be dominant with respect to the others in plane components consistently with the similarity with pure oblique flow conditions conversely on the leeward side the blade loads are spurred by the interaction with the viscous wake characterized by multi scale vortical structures that are generated and evolve depending on the severity of the maneuver at smaller drift angle β 13 the blade loads rise due to the blade vortex interaction the vortex passage causes the blade thrust and side force to peak at a value which is almost twice as high as the maximum value measured during straight ahead conditions this interaction causes the vertical force developed by the propeller to further increase at the largest drift angle the gradients of the inflow are weakened due to the mixing of smaller structures and the further increase of loads is minimal moreover the measurements highlight a strong correlation of the spindle torque fundamental for the assessment of the structural reliability of controllable pitch propellers with blade loading and movement of the hydrodynamic center on the blade in particular the increase of blade loading was associated with the movement of the hydrodynamic center toward the leading edge of the blade and vice versa given the skewed shape of the blade the resulting spindle torque fluctuates to increase and reduce the pitch angle of the blade when load decreases and increases respectively from a practical perspective these studies demonstrate that critical conditions can be experienced both for tighter and weaker maneuvers for the former critical conditions are undergone by the external propeller which yield to overloading of thrust and torque that are almost doubled with respect to the normal straight ahead sailing on the contrary as far as the internal propeller is concerned weaker maneuvers can be critical for complex blade wake interactions that give onset to radial forces and moments of comparable magnitude to those experienced at tighter maneuver on the external shaft more importantly these are responsible for the amplification of propeller side effects pressure pulses noise vibrations finally the combination of novel set ups outlined in this work has proved to be reliable to provide high quality data for the validation of numerical solvers acknowledgments this work was partially funded by european defense agency project flowis contract no b 1399 esm1 gp the authors are grateful to f carta and r zagaglia for their valuable contribution to the technical definition and development of the instrumented propeller and for the adjustments and refinements to cad models as well as to the cnr inm towing tank personnel 
