index,text
23105,this paper investigates the leader follower cooperative formation control problem of autonomous surface vessels asvs with uncertain dynamics and external disturbances especially asvs can communicate with each other under a directed interaction topology based on directed graph theories backstepping and the minimal learning parameter mlp algorithm a novel distributed robust formation controller with two different adaptive laws is developed for each asv dynamic surface control dsc is utilized to eliminate repeated derivative of virtual control laws which is important to generate real time control signals neural networks nns approximation combined with an mlp based adaptive law is incorporated into the proposed controller to enhance the robustness against model uncertainties then only one learning parameter instead of the enormous weights matrix is estimated for each asv an auxiliary adaptive law is designed to obtain a continuous controller when compensating approximation errors and disturbances it is shown that desired formation shapes can be achieved with the proposed controller if the interaction topology has a directed spanning tree and formation errors are guaranteed to be semi global uniformly ultimately bounded sguub simulations and comparison results are provided to illustrate the effectiveness of theoretical results keywords formation surface vessels adaptive dynamic surface control minimal learning parameter 1 introduction nowadays the formation of autonomous surface vessels asvs plays an increasingly important role in marine missions xiao et al 2017 for instance in marine search and rescue operations the formation of asvs can provide adequate coverage to accomplish the whole mission with less time liu et al 2016 other applications can be found in oceanic mineral exploration yu et al 2017 surveillance of territorial waters liu et al 2017a and so on in the past two decades numerous studies focus on the formation control problem oh et al 2015 which aim to make a group of asvs maintain or track desired positions and orientations with predefined geometrical shapes various formation approaches have been proposed to address such problem e g behavior based balch and arkin 1998 virtual structure beard et al 2001 and leader follower breivik et al 2008 xiang et al 2010 among these approaches the leader follower approach is widely adopted due to its simplicity and reliability since in the leader follower formation formation shapes associated with followers are set with respect to leaders or virtual leaders many attractive results on leader follower formation control have been presented in the field of ocean engineering in cui et al 2010 the authors propose a virtual vessel scheme where a position tracking controller is utilized to follow the virtual trajectory of each follower unlike cui et al 2010 the line of sight los range and angle are used in peng et al 2013a where a robust adaptive formation controller is developed by nns and dsc under los range and angle constraints jin further presents a novel fault tolerant finite time leader follower formation control scheme jin 2016 although the aforementioned schemes are effective in the leader follower formation control they have a common limitation the information of the leader is assumed to be known by all followers which inevitably suffers from the single point failure problem of the leader i e if the leader is under attack or out of work the whole formation would no longer be maintained in order to reduce the dependence on the leader the interaction topology is introduced then the idea of cooperative control can be utilized to the leader follower formation control of asvs ge et al 2017 xi et al 2018 in this scenario the information of the leader is only available to a few followers but the formation can still be achieved ding et al 2013 xi et al 2016 the related research has been conducted in thorvaldsen and skjetne 2011 peng et al 2013b liu et al 2017b using group agreement protocols and maneuvering control theories a novel coordinated formation scheme is presented in thorvaldsen and skjetne 2011 by integrating nns and the graph theory a robust cooperative formation controller is developed in peng et al 2013b to realize cooperative path maneuvering of asvs a modular adaptive control method is proposed in liu et al 2017b although these works can eliminate the single point failure problem the interaction graph is undirected which implies that only bidirectional communication is allowed in practical applications unidirectional communication is inevitable due to limited communication range and possible equipment malfunction therefore the formation of asvs under the directed interaction topology should be further investigated it is worth mentioning that controllers in peng et al 2013b liu et al 2017b are designed based on the backstepping technique li et al 2017 tong et al 2016a 2016b a major drawback in the backstepping design is the explosion of complexity problem which is caused by repeated differentiations of virtual control laws and needs to be taken into account in the cooperative formation of asvs due to imprecise measurements and external disturbances accurate model parameters cannot be obtained to deal with uncertain dynamics some literature utilizes adaptive control to estimate unknown upper bound of uncertainties jin 2016 he and meng 2018 combined with adaptive control the nns technique is found effective to approximate systems with uncertainties ge and wang 2004 and many good results have been achieved for different types of nonlinear systems he et al 2016 2017a xu and sun 2018 xu and shou 2018 in the field of ship motion control adaptive nn controllers have also been widely adopted du et al 2015 he et al 2017b xiang et al 2017 zhang et al 2017 however these adaptive nn controllers suffer from the computational effort caused by updating of the enormous weights matrix especially when the number of nns nodes increases in li et al 2010a the mlp algorithm is incorporated to reduce learning parameters for nns this algorithm has been successfully applied in path following of ships zhang and zhang 2017 and control of pmsms yu et al 2015 but is still not employed in the cooperative formation of asvs where states of asvs are coupled under the interaction topology considering the robustness against disturbances induced by wind waves and current disturbance observation schemes in fu et al 2015 du et al 2016 perform well but the assumption that there exists the first order derivative of disturbances is too strict meanwhile discontinuous control laws are sometimes adopted to compensate disturbances li and zhang 2010 bessa et al 2010 li et al 2010b xu et al 2015 which may cause undesired chattering effects and the inferior performance of the formation system therefore it is necessary to explore new cooperative formation controllers for asvs such that the robustness against model uncertainties and external disturbances can be enhanced especially in terms of reducing the computational effort and relaxing assumptions on the formation system motivated by aforementioned discussions we further investigate the leader follower cooperative formation problem of asvs with model uncertainties and external disturbances where asvs can communicate with each other under a directed interaction topology a novel distributed neural formation controller with two adaptive laws is proposed for each asv first virtual control laws are developed based on static consensus protocols and directed graph theories then dynamic surface control is utilized to derive the formation controller by the nns technique the nominal control law is designed to deal with uncertain dynamics with an mlp based adaptive law the auxiliary control law and corresponding adaptive law are added to obtain a continuous controller when compensating approximation errors and external disturbances finally lyapunov based stability analysis is provided to show the closed loop performance main contributions of this paper are summarized as follows 1 considered asvs are nonlinear and strongly coupled agents and they are connected in a directed topology a new neural adaptive cooperative formation control scheme is presented for asvs such that the formation can be achieved under a directed interaction topology 2 the proposed formation controller is based on the dsc technique and the mlp algorithm then repeated derivative of virtual control laws is avoided and only one learning parameter instead of the enormous weights matrix requires to update for each vessel which can reduce the computational effort 3 two different adaptive laws are designed associated with the formation controller to enhance the robustness against model uncertainties and disturbances thus a continuous rather than discontinuous controller is guaranteed and the assumption on the first derivative of disturbances is relaxed the rest of the paper is organized as follows in section 2 interaction graph and function approximation based on rbf nns are introduced then the cooperative formation control problem is formulated in section 3 main results are presented in section 4 simulations and comparison results are given in section 5 section 6 concludes this paper notations ℝ n denotes the n dimensional real space given a vector x x 1 x n t x 1 i 1 n x i denotes the ℓ 1 norm of x x 2 x t x denotes the ℓ 2 norm of x and x max i 1 n x i denotes the ℓ norm of x given the hyperbolic tangent function tanh and the sign function sgn define t a n h x tanh x 1 tanh x n t and sgn x sgn x 1 sgn x n t for a vector h h 1 t h n t t where h i i 1 n is also a vector we define h h h 1 t h 1 h n t h n t i is the identity matrix of appropriate dimensions i is the column vector with all entries equal to 1 we write a t for the transpose of matrix a and λ a for the eigenvalue of square matrix a a diag a 11 a nn is utilized to represent a diagonal matrix a with leading diagonal elements a 11 a nn a b represents the kronecker product of two matrices a b 2 preliminaries in this section we introduce some basic theories of interaction graph and function approximation based on rbf nns the interaction graph is utilized to represent the communication topology of multiple asvs function approximation based on rbf nns is powerful when addressing model uncertainties of asvs 2 1 interaction graph a weighted digraph g is employed to model communication topology of a network consisting of multiple asvs the set of vessels can be viewed as the set of nodes and the set of directed communication links can be viewed as the set of edges let v v i i ℐ represents a set of n vessels where ℐ 1 2 n a directed edge from v i to v j denoted as v i v j e represents a directed communication link from vessel v i to vessel v j that is vessel v j can receive information from vessel v i where e is the set of edges the adjacency matrix of graph g is denoted as a a i j n n where a i j is the element at the i th row and the j th column of a if v j v i e a i j 1 otherwise a i j 0 moreover we assume that a i i 0 for all i ℐ the set of neighbors of node v i is denoted by n i v j v v j v i e the laplacian matrix ℒ l i j n n associated with graph g is defined as l i j a i j i j and l i i k 1 n a i k a directed path from node v i 1 to node v i s is a sequence of different nodes v i 1 v i s where v i j v i j 1 e j 1 s 1 a digraph has a directed spanning tree if there exists at least one node called the root having a directed path to all of the other nodes the following lemma presents a basic property of a graph with directed spanning trees which is related to its laplacian matrix lemma 1 li and wang 2013 if the interaction graph g contains at least one directed spanning tree then its corresponding laplacian matrix ℒ is positive definite 2 2 function approximation based on rbf nns in control engineering neural networks are usually utilized to approximate an unknown function due to their simplicity and powerful capability of nonlinear fitting rbf nns are good candidates for this purpose the general approximation principle based on rbf nns is summarized as the following lemma 2 lemma 2 for any given real continuous function f x defined on a compact set ω x there exists an ideal weights vector w such that 1 f x w t h x ε where ε is the bounded function approximation error x x 1 x m t is the input vector m is the number of the input h x h 1 x h p x t is the gaussian basis function vector which satisfies 2 h i x exp x c i 2 2 2 b i 2 i 1 p where p is the number of neurons c i ℝ m is the center of the receptive field and b i ℝ is the width of the gaussian function 3 problem formulation consider a network consisting of n asvs kinematic and kinetic equations of the i th asv are given by 3 η i r ψ i ν i m i ν i c i ν i ν i d i ν i ν i g i τ iw τ i where i 1 n is the index of each vessel η i x y y i ψ i t is the position vector in the earth fixed frame x i y i denotes the position coordinate and ψ i denotes the yaw angle r ψ i has the form as 4 r ψ i cos ψ i sin ψ i 0 sin ψ i cos ψ i 0 0 0 1 ν i u i v i r i t is the velocity vector in the body fixed frame u i v i and r i represent the surge sway and yaw angular velocities respectively m i is the inertia matrix which is symmetric positive definite c i ν i is the centripetal and coriolis matrix d i ν i is the hydrodynamic damping matrix which is also symmetric and positive definite g i g i u g i v g i r t represents the unmodeled dynamics τ iw τ i w u τ i w v τ i w r t is the vector of force and moments induced by environmental disturbances τ i τ i u τ i v τ i r t is the vector of actuators inputs assume that there is a virtual leader moving along a predefined time varying trajectory η r ℝ 3 only a few follower asvs have access to the position vector η r of the virtual leader the leader follower cooperative formation control problem of asvs is described as the following problem 1 problem 1 give a network with multiple asvs described as 3 and an interaction topology encoded by a directed graph g find the distributed control law τ i for each vessel v i that depends on its own state η i ν i and its neighbors states η j ν j j n i determined by graph g such that a predefined relative formation shape δ i ℝ 3 can be achieved i e 5 η i δ i η r i 1 n with bounded errors remark 1 there are two typical features of the problem investigated in this paper 1 unlike the conventional leader follower formation in cui et al 2010 peng et al 2013a jin 2016 shojaei 2015 the interaction topology is taken into account in the aforementioned leader follower cooperative formation problem the major advantage of this method is that the information of the leader vessel is unnecessary to be available to all the follower vessels in such case the formation control of multiple vessels would not suffer from the single point failure of the leader 2 compared with the problem in thorvaldsen and skjetne 2011 peng et al 2013b liu et al 2017b directed rather than undirected interaction topology is considered here namely communication links are allowed to be unidirectional next some important assumptions and lemmas are introduced for later use assumption 1 for the time varying reference trajectory η r there exists a positive constant ρ m ℝ such that η r 1 ρ m assumption 2 the external disturbance τ iw is bounded i e there exists a positive constant b d ℝ such that τ iw 2 b d remark 2 in practical applications velocities of each asv are bounded due to the constraints of actuators this implies that assumption 1 can be easily satisfied in the marine practice since external environments keep changing with finite energies disturbances acting on asvs are unknown time varying and bounded it is obvious that assumption 2 is reasonable from assumption 2 we can see that the assumption on the first derivative of disturbances is relaxed compared with fu et al 2015 du et al 2016 lemma 3 the following inequality holds for any ε 0 and for any vector x ℝ n 6 x k p ε x t tanh x ε where k p is a constant that satisfies k p e k p 1 i e k p 0 2785 proof let x x 1 x n t in terms of lemma 1 in chen et al 2011 for any i 1 n we have 7 x i k p ε x i tanh x i ε it leads to the following inequality 8 max 1 i n x i k p ε max 1 i n x i tanh x i ε since x i tanh x i ε 0 inequality 6 can be obtained which completes the proof lemma 4 given two vectors x y ℝ n for any ε 0 we have 9 x t y 1 2 ε x t x 1 ε y t y proof the proof procedure is similar with proposition 1 in lombana and di bernardo 2016 if we choose q 1 q 2 i n as a result it is omitted here lemma 5 ge and wang 2004 consider a system x f x x ℝ n for any bounded initial state x 0 if there exists a c 1 continuous positive definite lyapunov function v x satisfying κ 1 x v x κ 2 x and v α v β where κ 1 κ 2 are class k functions and α β are positive constants then the solution x is sguub 4 main results define the formation error z i 1 and the other two error variables z i 2 z i 3 as 10 z i 1 η i δ i η r z i 2 α i 1 α i 1 z i 3 ν i α i 1 where α i 1 is a virtual control law and α i 1 is a filtered virtual control law each element of α i 1 is obtained by letting its corresponding element in α i 1 pass through a first order filter with the time constant given by the corresponding diagonal element of γ i namely 11 γ i α i 1 α i 1 α i 1 where γ i is a diagonal positive definite matrix then the error dynamics of z i 1 z i 2 z i 3 are given by 12 z i 1 z i 2 z i 3 α i 1 η r z i 2 γ i 1 z i 2 α i 1 m i z i 3 c ν i ν i d ν i ν i g i τ iw τ i m i γ i 1 z i 2 remark 3 to cope with the explosion of complexity problem caused by repeated derivative of virtual control laws α i 1 the dsc approach is employed here as can be observed later the error variable z i 2 instead of α i 1 is utilized in the formation controller design then the proposed controller becomes more practical in the sequel the backstepping design procedure is presented which leads to the formation controller design and the main theorem step 1 at this step the virtual control law α i 1 is designed the cooperative tracking error s i is defined as 13 s i j 1 n a i j η i δ i η j δ j d i η i δ i η r j 1 n a i j z i 1 z j 1 d i z i 1 where d i 1 if the follower vessel has access to the information of the virtual leader and d i 0 otherwise the virtual leader can be treated as a node if the follower has access to the information of the virtual leader a directed edge is constructed from the leader node to the follower node the leader node the constructed edges and the original interaction graph g can constitute an enlarged graph g which is also directed the laplacian matrix associated with g is denoted by ℒ choose the virtual control law α i 1 to be 14 α i 1 k i 1 r t ψ i s i k i 0 r t ψ i tanh n z i 1 ε where k i 0 k i 1 ℝ 3 3 are both diagonal matrices with positive diagonal entries and zero off diagonal entries ε is a positive constant that can be adjusted to facilitate the controller design let z 1 z 11 z n 1 t z 2 z 12 z n 2 t z 3 z 13 z n 3 t ν ν 1 ν n t ℛ diag r ψ i m diag m i s s 1 s n t k 0 diag k i 0 k 1 diag k i 1 α 1 α 11 α n 1 t γ diag γ i then the virtual control law α i 1 can be written in a compact form as 15 α 1 k 1 r t s k 0 r t t a n h n z 1 ε k 1 r t l i 3 z 1 k 0 r t t a n h n z 1 ε consider the candidate lyapunov function v 1 as follows 16 v 1 1 2 z 1 t z 1 the derivative of v 1 with respect to time is given by 17 v 1 z 1 t r z 2 z 3 α 1 1 η r z 1 t r z 2 z 3 z 1 t k 1 l i 3 z 1 z 1 t k 0 t a n h n z 1 ε z 1 t 1 η r by means of lemma 3 we have 18 v 1 z 1 t r z 2 z 3 z 1 t k 1 l i 3 z 1 z 1 t k 0 t a n h n z 1 ε z 1 n ρ m z 1 t r z 2 z 3 z 1 t k 1 l i 3 z 1 z 1 t k 0 t a n h n z 1 ε k p ε ρ m ρ m z 1 t t a n h n z 1 ε choose k 0 properly such that λ min k 0 ρ m we have ρ m z 1 t tanh n z 1 ε z 1 t k 0 tanh n z 1 ε 0 then the derivative of v 1 satisfies 19 v 1 z 1 t k 1 ℒ i 3 z 1 z 1 t ℛ z 2 z 1 t ℛ z 3 k p ε ρ m remark 4 the proposed virtual control law α 1 has three features 1 the laplacian matrix associated with the directed rather than undirected interaction topology is adopted in α 1 the unidirectional communication is allowed for leader follower cooperative formation of multiple asvs which implies that our algorithm is robust against link failure 2 the positive constant ε is introduced into α 1 to make the convergence analysis clearer as can be observed later ε determines the upper bound of the formation error z i 1 namely z i 1 can be reduced if we decrease ε besides if the interaction topology is undirected and ε n the proposed virtual control law turns to be that in peng et al 2013b 3 under assumption 1 α 1 can make the upper bound of the formation error z i 1 independent of the dimension of z i 1 and the number of asvs this can be seen from 18 where k p ε ρ m rather than n n k p ε ρ m appears then using α 1 the formation error cannot be affected by the increasing number of asvs in the formation step 2 control law τ i is designed for each vessel at this step consider the candidate lyapunov function v 2 as follows 20 v 2 v 1 1 2 z 2 t z 2 1 2 z 3 t m z 3 according to the error dynamics 12 z i 2 can be written into the compact form as 21 z 2 γ 1 z 2 k 1 ℛ t ℒ i 3 z 1 k 0 ℛ t 1 tan h t n z 1 ε tanh n z 1 ε n z 1 ε let b k 1 ℛ t ℒ i 3 z 1 k 0 ℛ t 1 tan h t n z 1 ε tanh n z 1 ε n z 1 ε observed that the vector b consists of bounded functions with respect to z 1 z 2 z 3 η r then there exists a positive constant b such that b 2 b similarly z i 3 can be written into the compact form as 22 m z 3 m v m γ 1 z 2 then the derivative of v 2 with respect to time yields 23 v 2 v 1 z 2 t γ 1 z 2 b z 3 t m v m γ 1 z 2 z 1 t k 1 l i 3 z 1 z 2 t γ 1 z 2 z 1 t r z 2 z 2 t b z 3 t r t z 1 m v m γ 1 z 2 k p ε ρ m by means of lemma 4 we have 24 z 1 t ℛ z 2 1 2 z 1 t z 1 z 2 t z 2 25 z 2 t b 1 2 1 ε z 2 t b t b z 2 ε then the derivative of v 2 turns to be 26 v 2 z 1 t k 1 l i 3 0 5 i z 1 z 2 t γ 1 0 5 ε 1 b t b 1 i z 2 z 3 t r t z 1 m v m γ 1 z 2 k p ρ m 0 5 ε let b 1 ℛ t z 1 m v m γ 1 z 2 now taking the term z 3 t b 1 into consideration we have 27 z 3 t b 1 i 1 n z i 3 t m i ν i r t ψ i z i 1 m i γ i 1 z i 2 i 1 n z i 3 t τ i τ iw f i r t ψ i z i 1 where f i c ν i ν i d ν i ν i g i m i γ i 1 z i 2 in practice model parameters c ν i d ν i g i m i are difficult to be obtained accurately therefore rbf nns are utilized to deal with model uncertainties as follows 28 f i w i h i ε i where w i w i 1 t w i 2 t w i 3 t t h i h i 1 t h i 2 t h i 3 t t w ij h ij x ij ℝ p j 1 2 3 x ij ν i j t z i 2 j t t here ν i j means the j th row of ν i and z i 2 j is the same ε i ε n i 1 n ε n 0 in order to reduce the computational effort and meet requirements of the real time control a single parameter ϕ i which can describe the upper bound of the weights matrix w i is estimated instead of updating the values of w i let ϕ i max 1 j 3 w ij 2 2 obviously ϕ i 0 the estimation of ϕ i is denoted by ϕ ˆ i and the initial value of ϕ ˆ i is defined as ϕ ˆ i 0 denote the estimation error of ϕ i as ϕ i we have ϕ i ϕ ˆ i ϕ i choose the control law τ i for each vessel to be 29 τ i τ i nom τ i aux τ i nom k i 2 z i 3 n ϕ ˆ i 2 ε z i 3 h i h i r t ψ i z i 1 τ i aux n b ˆ d i 2 ε z i 3 where τ i nom is the nominal control law to deal with uncertain dynamics τ i aux is the auxiliary control law to compensate environmental disturbances and the approximation error of rbf nns in τ i nom k i 2 is a diagonal matrix with positive diagonal entries and zero off diagonal entries the parameter ϕ ˆ i updates as the following mlp based adaptive law 30 ϕ ˆ i γ n 2 ε j 1 3 z i 3 j 2 h ij 2 2 k ϕ i ϕ ˆ i ϕ ˆ i 0 where γ 0 is the adaption gain k ϕ i 0 is the feedback gain in τ i aux the parameter b ˆ d i is the estimation of the constant b d i ε n b d and the estimation error satisfies b d i b ˆ d i b d i b ˆ d i updates as the following auxiliary adaptive law 31 b ˆ d i γ b n 2 ε z i 3 2 2 k b i b ˆ d i b ˆ d i 0 where γ b is a positive adaption gain and k b i is the positive feedback gain substituting equation 28 and the control law 29 into equation 26 we have 32 v 2 z 1 t k 1 l i 3 0 5 i z 1 z 2 t γ 1 0 5 ε 1 b t b 1 i z 2 z 3 t k 2 z 3 k p ρ m 0 5 ε i 1 n z i 3 t w i h i 0 5 ε 1 ϕ ˆ i z i 3 h i h i τ iw ε i n b ˆ d i 2 ε z i 3 where k 2 diag k i 2 to facilitate the discussion let k ϕ diag k ϕ i and k b diag k b i remark 5 advantages of the proposed robust adaptive formation controller 29 can be found from the following three aspects 1 the control law 29 is distributed rather than centralized since each asv keeps the related formation shape using its own and neighbors information where the information of the leader may be unnecessary then negative effects caused by the single point failure of the leader can be eliminated 2 the mlp based adaptive law 30 is incorporated in 29 for function approximations of uncertain dynamics then only one parameter instead of the enormous weights matrix requires to estimate the computational effort can be considerably reduced and the solving efficiency is improved 3 based on the auxiliary adaptive law 31 a novel auxiliary control law τ i a u x is designed which is a continuous function neither the signum function sgn z i 3 nor the saturation function sat z i 3 is included in 29 such that undesired chattering effects and the inferior performance can be avoided remark 6 focusing on applications in cooperative formation of asvs the developed formation controller 29 with adaptive laws 30 31 is an effective exploration of adaptive nn controllers presented in he and meng 2018 he et al 2016 he et al 2017a he et al 2017b furthermore differences from these existing results include 1 controller 29 is based on the dsc technique such that derivative of virtual control laws is omitted from inputs of nns 2 the mlp algorithm is incorporated in the proposed scheme to obtain updating of only one learning parameter rather than the enormous weights matrix 3 the number of asvs is utilized in controller 29 and adaptive laws 30 31 then the effects caused by the number of asvs on the formation error can be reduced theorem 1 under assumptions 1 and assumptions 2 consider a network with n asvs described as 3 let the enlarged graph g have a directed spanning tree choose the control law 29 with the mlp based adaptive law 30 and the auxiliary adaptive law 31 for each vessel then for bounded initial conditions all the signals in the closed loop system can be guaranteed to be semi global uniformly ultimately bounded sguub by setting the positive controller parameters k 0 k 1 k 2 k ϕ k b γ γ b γ ε appropriately and 5 holds for all vessels provided that control parameters k 0 k 1 γ satisfy the following conditions 33 λ m i n k 0 ρ m λ m i n k 1 1 2 λ m i n ℒ λ m a x γ 2 ε b 2 1 proof put the parameter ϕ i its estimation ϕ ˆ i the corresponding initial value ϕ ˆ i 0 and the estimation error ϕ i into compact vector forms i e let ϕ ϕ 1 ϕ n t ϕ ˆ ϕ ˆ 1 ϕ ˆ n t ϕ ˆ 0 ϕ ˆ 1 0 ϕ ˆ n 0 t and ϕ ϕ 1 ϕ n t similarly let b d b d 1 b d n t b ˆ d b ˆ d 1 b ˆ d n t b ˆ d 0 b ˆ d 1 0 b ˆ d n 0 t and b d b d 1 b d n t consider the candidate lyapunov function v 3 as follows 34 v 3 v 2 1 2 γ ϕ t ϕ 1 2 γ b b d t b d then the derivative of v 3 with respect to time becomes 35 v 3 b 2 k p ρ m 0 5 ε i 1 n z i 3 t w i h i n 2 ε ϕ ˆ i z i 3 t z i 3 h i h i ϕ i n 2 ε j 1 3 z i 3 j 2 h i j 2 2 z i 3 t τ i w ε i n b ˆ d i 2 ε z i 3 n b d i 2 ε z i 3 2 2 i 1 n k ϕ i ϕ i ϕ ˆ i ϕ ˆ i 0 k b i b d i b ˆ d i b ˆ d i 0 let b 2 z 1 t k 1 ℒ i 3 0 5 i z 1 z 2 t γ 1 0 5 ε 1 b t b 1 i z 2 z 3 t k 2 z 3 we have v 3 b 2 k p ρ m 0 5 ε i 1 n z i 3 t w i h i n 2 ε ϕ ˆ i z i 3 t z i 3 h i h i ϕ i n 2 ε j 1 3 z i 3 j 2 h ij 2 2 z i 3 t τ i w ε i n b ˆ d i 2 ε z i 3 n b d i 2 ε z i 3 2 2 i 1 n k ϕ i ϕ i ϕ ˆ i ϕ ˆ i 0 k b i b d i b ˆ d i b ˆ d i 0 on one hand by means of lemma 4 the following holds 36 z i 3 j w ij t h ij n 2 ε ϕ i z i 3 j 2 h ij t h ij ε 2 n then it yields that 37 z i 3 t w i h i j 1 3 z i 3 j w ij t h ij n 2 ε ϕ i j 1 3 z i 3 j 2 h ij t h ij 3 ε 2 n on the other hand we have 38 n 2 ε ϕ ˆ i z i 3 t z i 3 h i h i n 2 ε ϕ i j 1 3 z i 3 j 2 h ij 2 2 n 2 ε ϕ i j 1 3 z i 3 j 2 h ij t h ij besides the following holds 39 z i 3 t τ iw ε i n b ˆ d i 2 ε z i 3 z i 3 2 b d i n b ˆ d i 2 ε z i 3 2 2 also by means of lemma 4 we further have 40 z i 3 t τ iw ε i n b ˆ d i 2 ε z i 3 n 2 ε z i 3 2 2 ε 2 n b d i n b ˆ d i 2 ε z i 3 2 2 n b d i 2 ε z i 3 2 2 ε b d i 2 n therefore the derivative of v 3 turns to be 41 v 3 b 2 k p ρ m 2 0 5 ε n b d ε i 1 n k ϕ i ϕ i ϕ ˆ i ϕ ˆ i 0 k b i b d i b ˆ d i b ˆ d i 0 according to the following two inequalities ϕ i ϕ ˆ i ϕ ˆ i 0 1 2 ϕ i 2 ϕ i ϕ ˆ i 0 2 b d i b ˆ d i b ˆ d i 0 1 2 b d i 2 b d i b ˆ d i 0 2 we have v 3 b 2 k p ρ m 2 0 5 ε n b d ε 0 5 i 1 n k ϕ i ϕ i 2 k b i b d i 2 0 5 i 1 n k ϕ i ϕ i ϕ ˆ i 0 2 k b i b d i b ˆ d i 0 2 z 1 t k 1 l i 3 0 5 i z 1 z 2 t γ 1 0 5 ε 1 b t b 1 i z 2 z 3 t k 2 z 3 0 5 ϕ t k ϕ ϕ 0 5 b d t k b b d 0 5 ϕ ϕ ˆ 0 t k ϕ ϕ ϕ ˆ 0 0 5 b d b ˆ d 0 t k b b d b ˆ d 0 k p ρ m 2 0 5 ε n b d ε by means of lemma 1 it holds that 42 v 3 λ min k 1 λ min ℒ 1 2 z 1 t z 1 λ min γ 1 b 2 1 2 ε z 2 t z 2 λ min k 2 z 3 t z 3 1 2 λ min k ϕ ϕ t ϕ 1 2 λ min k b b d t b d 0 5 ϕ ϕ ˆ 0 t k ϕ ϕ ϕ ˆ 0 0 5 b d b ˆ d 0 t k b b d b ˆ d 0 k p ρ m 2 0 5 ε n b d ε if the following conditions hold 43 λ min k 0 ρ m λ min k 1 1 2 λ min ℒ λ max γ 2 ε b 2 1 then v 3 can be described as 44 v 3 α v 3 β where α and β are positive constants satisfying α min 2 λ min k 1 λ min ℒ 1 2 λ min γ 1 b 2 1 ε 2 λ min k 2 λ max m γ λ min k ϕ γ b λ min k b β 0 5 ϕ ϕ ˆ 0 t k ϕ ϕ ϕ ˆ 0 0 5 b d b ˆ d 0 t k b b d b ˆ d 0 k p ρ m 2 0 5 ε n b d ε according to lemma 5 we can conclude that for bounded initial conditions all the signals in the closed loop system are sguub in addition by integrating 44 we have 45 v 3 v 3 0 e α t β α 1 e α t from the equation 34 and the inequality 45 we further have 46 1 2 z 1 t 2 2 β α t therefore the formation error z 1 converges to a compact set ω z 1 z 1 z 1 2 2 β α as t which implies that 5 holds this completes the proof remark 7 the proof of theorem 1 relies on the lyapunov directed method where the candidate lyapunov function v 3 is adopted it can be seen that v 3 is chosen to be the sum of squared error signals z 1 z 2 z 3 ϕ b d also observed that theorem 1 is based on the communication condition that the interaction topology has a directed spanning tree which is a simplest condition on the directed graph predefined formation shapes can be obtained if the condition 33 is satisfied upper bound of the formation error z 1 is 2 β α which can be reduced if we appropriately increase control gains k 0 k 1 k 2 k ϕ k b γ γ b or decrease the filter gain γ and the parameter ε remark 8 compared with results on distributed maneuvering or containment maneuvering of asvs liu et al 2017b peng et al 2018 peng et al 2017 zhu et al 2017 a new robust adaptive cooperative formation control scheme consisting of the virtual control law 14 the controller 29 and adaptive laws 30 31 is presented for asvs under a directed interaction topology unlike liu et al 2017b peng et al 2018 peng et al 2017 where the enormous weights matrix requires to update for approximation only one learning parameter is estimated in the proposed control scheme meanwhile different from the controller with signum functions in zhu et al 2017 a continuous controller is obtained here 5 simulations and comparison results in this section simulation studies are presented based on the model ship in peng et al 2013b and skjetne et al 2005 with parameters given in table 1 where standard si units are used the mass of the model ship is 23 8 kg its length is 1 255 m and its breadth is 0 29 m model uncertainties g i and external disturbances τ iw are chosen as follows g i u 0 0279 u i v i 2 0 0342 v i 2 r i g i v 0 0912 u i 2 v i g i r 0 0156 u i r i 2 0 0278 u i v i 3 r i τ i w u 2 cos 0 5 t cos t 0 3 cos 0 5 t sin 0 5 t 3 n τ i w v 0 01 sin 0 1 t n and τ i w r 0 6 sin 1 1 t cos 0 3 t n m 5 1 closed loop performance consider a group of three asvs denoted by no 1 no 2 and no 3 with the interaction topology given in fig 1 asv 0 is the virtual leader whose information can only be transmitted to the follower asv 1 observed that communication links are all unidirectional and the interaction graph has a directed spanning tree formation configurations are predefined as δ 1 2 m 0 m 0 rad t δ 2 0 m 2 m 0 rad t and δ 3 0 m 2 m 0 rad t which implies that the formation shaped as the isosceles right triangle is finally achieved for simplicity the trajectory of the virtual leader is set to be a straight line initial values from asv 0 to asv 3 are given by η 0 0 m 10 m 0 rad t η 1 4 m 15 m π 3 rad t η 2 5 m 21 m π 2 rad t η 3 3 m 0 m π 2 rad t ν 0 0 6 m s 0 m s 0 rad s t ν 1 ν 2 ν 3 0 m s 0 m s 0 rad s t by the trial and error the filtered gain matrix is chosen to be γ i diag 0 01 0 02 0 02 i 1 2 3 control gain parameters are selected as k i 0 diag 5 0 65 0 61 k i 1 diag 0 6 0 6 0 6 k i 2 diag 1 0 1 0 1 k ϕ i 0 1 k b i 0 2 ε 0 1 γ 10 and γ b 20 initial values of two adaptive parameters are chosen as ϕ ˆ i 0 0 1 b ˆ d i 0 0 1 parameters in rbf nns are set as follows the number of neurons p 15 the center of the receptive field c i is placed in 1 3 1 3 1 3 1 3 and the width of the gaussian function b i 2 it can be checked that condition 33 in theorem 1 is satisfied with these parameters under the interaction topology given in fig 1 design the control law 29 and adaptive laws 30 31 for each asv using aforementioned controller parameters according to theorem 1 the desired formation can be achieved along the predefined trajectory of the virtual leader fig 2 shows formation trajectories of three asvs in the 2 d plane asvs in fig 2 are 1 1 scale representations of the model ship it is obvious that the desired formation shaped as the isosceles right triangle is finally achieved which conforms to theorem 1 by theorem 1 all the signals in the closed loop system should be sguub using the designed controller solid lines in fig 5 illustrate formation errors z i 1 of three asvs with proposed controllers from three different dimensions as can be seen from a and b in fig 5 the formation error z i 1 1 and z i 1 2 with respect to x and y coordinates in the earth fixed coordinate are sguub respectively from c in fig 5 the formation error z i 1 3 about the yaw angle is also sguub control inputs of three asvs are presented in fig 3 observed that all the control signals are sguub and continuous which can eliminate undesired chattering effects and the inferior performance of the formation system since there exists no signum or saturation functions in the proposed control law adaptive parameters of three asvs are shown in fig 4 we can see that all the adaptive parameters can finally converge to a compact set at the same time only one learning parameter ϕ ˆ i instead of the enormous weights matrix is updated for each vessel leading to less computational effort when the desired formation shapes are guaranteed all of the above mentioned simulation analysis accord with theorem 1 5 2 comparison results first the proposed controller is compared with the model based controller formation control of asvs with model based approaches generates many good results breivik et al 2008 zhu et al 2017 the model based control law τ im to problem 1 with known model parameters m i c i ν i d i ν i is given by 47 τ im c ν i ν i d ν i ν i m i γ i 1 z i 2 r t ψ i z i 1 k i 2 z i 3 for comparison simulation studies are conducted between two types of controllers with the same common control parameters fig 5 shows the simulation results where solid lines represent formation errors with the proposed controller and dot lines describe formation errors with model based controllers it can be observed that better performance is achieved with the proposed controller the reasons for unsatisfied performance of the model based controller 47 mainly lie in two aspects on one hand the unmodeled dynamics g i are not considered into the controller design on the other hand there exists no compensation mechanism for disturbances τ iw since the robustness against uncertain dynamics and external disturbances are enhanced by the rbf nns based controller 29 combined with the mlp based adaptive law 30 and auxiliary adaptive law 31 smaller steady formation errors can be guaranteed second effects of the number of nns nodes on control performance are discussed when using the proposed formation controller we choose different number of nns nodes to carry out simulations in matlab r2016a the program is run on an inter r core tm i5 2450m 2 50 ghz laptop with 4g memory detailed comparisons are summarized in table 2 where the integrated absolute error iae and integrated time absolute error itae are utilized to evaluate the transient and steady state performance iae and itae are defined as iae 0 t z 1 i τ 1 d τ and itae 0 t τ z 1 i τ 1 d τ i 1 2 3 where z 1 i z 11 i z 21 i z 31 i t and z j 1 i means the i th row of z j 1 j 1 2 3 the formation error vector z 1 1 represents tracking errors of three asvs in the x axis direction z 1 2 and z 1 3 denote the formation error z 1 in the y axis and ψ direction respectively from table 2 we can see that as the number of nns nodes increases both of iae and itae in three directions of the asv formation decrease but the running time becomes longer this is because more nodes lead to lower nns approximation errors and larger computational effort also observed that when the node number exceeds 15 iae and itae gradually decrease with smaller rate of change to make a trade off between approximation error and computational effort we choose p 15 in subsection 5 1 and the first comparison in this subsection it is worth mentioning that nns approximation errors cannot be achieved directly since the mlp algorithm is incorporated in the proposed formation controller no matter how the number of nns nodes varies only one learning parameter needs to be updated in the proposed scheme such that the online learning time is reduced this is the reason why the running time is not too long for all cases in table 2 6 conclusion in this paper a new distributed robust adaptive cooperative formation control scheme is presented for asvs under a directed interaction topology it is shown that predefined geometrical configurations can be achieved with the proposed controller and two adaptive laws if the interaction topology has a directed spanning tree which implies unidirectional communication is allowed repeated derivative of virtual control laws is eliminated i e the explosion of complexity problem does not exist robustness against model uncertainties and external disturbances is enhanced and only one learning parameter instead of the enormous weights matrix is updated for each vessel in the future the cooperative formation control problem of underactuated asvs will be considered in addition research of the cooperative formation control based on state feedback can be extended to the control strategy based on output feedback acknowledgments this paper is partly supported by the national natural science foundation of china 61473183 61627810 u1509211 national key r d program of china sq2017yfgh001005 and national postdoctoral program for innovative talents of china bx201600103 
23105,this paper investigates the leader follower cooperative formation control problem of autonomous surface vessels asvs with uncertain dynamics and external disturbances especially asvs can communicate with each other under a directed interaction topology based on directed graph theories backstepping and the minimal learning parameter mlp algorithm a novel distributed robust formation controller with two different adaptive laws is developed for each asv dynamic surface control dsc is utilized to eliminate repeated derivative of virtual control laws which is important to generate real time control signals neural networks nns approximation combined with an mlp based adaptive law is incorporated into the proposed controller to enhance the robustness against model uncertainties then only one learning parameter instead of the enormous weights matrix is estimated for each asv an auxiliary adaptive law is designed to obtain a continuous controller when compensating approximation errors and disturbances it is shown that desired formation shapes can be achieved with the proposed controller if the interaction topology has a directed spanning tree and formation errors are guaranteed to be semi global uniformly ultimately bounded sguub simulations and comparison results are provided to illustrate the effectiveness of theoretical results keywords formation surface vessels adaptive dynamic surface control minimal learning parameter 1 introduction nowadays the formation of autonomous surface vessels asvs plays an increasingly important role in marine missions xiao et al 2017 for instance in marine search and rescue operations the formation of asvs can provide adequate coverage to accomplish the whole mission with less time liu et al 2016 other applications can be found in oceanic mineral exploration yu et al 2017 surveillance of territorial waters liu et al 2017a and so on in the past two decades numerous studies focus on the formation control problem oh et al 2015 which aim to make a group of asvs maintain or track desired positions and orientations with predefined geometrical shapes various formation approaches have been proposed to address such problem e g behavior based balch and arkin 1998 virtual structure beard et al 2001 and leader follower breivik et al 2008 xiang et al 2010 among these approaches the leader follower approach is widely adopted due to its simplicity and reliability since in the leader follower formation formation shapes associated with followers are set with respect to leaders or virtual leaders many attractive results on leader follower formation control have been presented in the field of ocean engineering in cui et al 2010 the authors propose a virtual vessel scheme where a position tracking controller is utilized to follow the virtual trajectory of each follower unlike cui et al 2010 the line of sight los range and angle are used in peng et al 2013a where a robust adaptive formation controller is developed by nns and dsc under los range and angle constraints jin further presents a novel fault tolerant finite time leader follower formation control scheme jin 2016 although the aforementioned schemes are effective in the leader follower formation control they have a common limitation the information of the leader is assumed to be known by all followers which inevitably suffers from the single point failure problem of the leader i e if the leader is under attack or out of work the whole formation would no longer be maintained in order to reduce the dependence on the leader the interaction topology is introduced then the idea of cooperative control can be utilized to the leader follower formation control of asvs ge et al 2017 xi et al 2018 in this scenario the information of the leader is only available to a few followers but the formation can still be achieved ding et al 2013 xi et al 2016 the related research has been conducted in thorvaldsen and skjetne 2011 peng et al 2013b liu et al 2017b using group agreement protocols and maneuvering control theories a novel coordinated formation scheme is presented in thorvaldsen and skjetne 2011 by integrating nns and the graph theory a robust cooperative formation controller is developed in peng et al 2013b to realize cooperative path maneuvering of asvs a modular adaptive control method is proposed in liu et al 2017b although these works can eliminate the single point failure problem the interaction graph is undirected which implies that only bidirectional communication is allowed in practical applications unidirectional communication is inevitable due to limited communication range and possible equipment malfunction therefore the formation of asvs under the directed interaction topology should be further investigated it is worth mentioning that controllers in peng et al 2013b liu et al 2017b are designed based on the backstepping technique li et al 2017 tong et al 2016a 2016b a major drawback in the backstepping design is the explosion of complexity problem which is caused by repeated differentiations of virtual control laws and needs to be taken into account in the cooperative formation of asvs due to imprecise measurements and external disturbances accurate model parameters cannot be obtained to deal with uncertain dynamics some literature utilizes adaptive control to estimate unknown upper bound of uncertainties jin 2016 he and meng 2018 combined with adaptive control the nns technique is found effective to approximate systems with uncertainties ge and wang 2004 and many good results have been achieved for different types of nonlinear systems he et al 2016 2017a xu and sun 2018 xu and shou 2018 in the field of ship motion control adaptive nn controllers have also been widely adopted du et al 2015 he et al 2017b xiang et al 2017 zhang et al 2017 however these adaptive nn controllers suffer from the computational effort caused by updating of the enormous weights matrix especially when the number of nns nodes increases in li et al 2010a the mlp algorithm is incorporated to reduce learning parameters for nns this algorithm has been successfully applied in path following of ships zhang and zhang 2017 and control of pmsms yu et al 2015 but is still not employed in the cooperative formation of asvs where states of asvs are coupled under the interaction topology considering the robustness against disturbances induced by wind waves and current disturbance observation schemes in fu et al 2015 du et al 2016 perform well but the assumption that there exists the first order derivative of disturbances is too strict meanwhile discontinuous control laws are sometimes adopted to compensate disturbances li and zhang 2010 bessa et al 2010 li et al 2010b xu et al 2015 which may cause undesired chattering effects and the inferior performance of the formation system therefore it is necessary to explore new cooperative formation controllers for asvs such that the robustness against model uncertainties and external disturbances can be enhanced especially in terms of reducing the computational effort and relaxing assumptions on the formation system motivated by aforementioned discussions we further investigate the leader follower cooperative formation problem of asvs with model uncertainties and external disturbances where asvs can communicate with each other under a directed interaction topology a novel distributed neural formation controller with two adaptive laws is proposed for each asv first virtual control laws are developed based on static consensus protocols and directed graph theories then dynamic surface control is utilized to derive the formation controller by the nns technique the nominal control law is designed to deal with uncertain dynamics with an mlp based adaptive law the auxiliary control law and corresponding adaptive law are added to obtain a continuous controller when compensating approximation errors and external disturbances finally lyapunov based stability analysis is provided to show the closed loop performance main contributions of this paper are summarized as follows 1 considered asvs are nonlinear and strongly coupled agents and they are connected in a directed topology a new neural adaptive cooperative formation control scheme is presented for asvs such that the formation can be achieved under a directed interaction topology 2 the proposed formation controller is based on the dsc technique and the mlp algorithm then repeated derivative of virtual control laws is avoided and only one learning parameter instead of the enormous weights matrix requires to update for each vessel which can reduce the computational effort 3 two different adaptive laws are designed associated with the formation controller to enhance the robustness against model uncertainties and disturbances thus a continuous rather than discontinuous controller is guaranteed and the assumption on the first derivative of disturbances is relaxed the rest of the paper is organized as follows in section 2 interaction graph and function approximation based on rbf nns are introduced then the cooperative formation control problem is formulated in section 3 main results are presented in section 4 simulations and comparison results are given in section 5 section 6 concludes this paper notations ℝ n denotes the n dimensional real space given a vector x x 1 x n t x 1 i 1 n x i denotes the ℓ 1 norm of x x 2 x t x denotes the ℓ 2 norm of x and x max i 1 n x i denotes the ℓ norm of x given the hyperbolic tangent function tanh and the sign function sgn define t a n h x tanh x 1 tanh x n t and sgn x sgn x 1 sgn x n t for a vector h h 1 t h n t t where h i i 1 n is also a vector we define h h h 1 t h 1 h n t h n t i is the identity matrix of appropriate dimensions i is the column vector with all entries equal to 1 we write a t for the transpose of matrix a and λ a for the eigenvalue of square matrix a a diag a 11 a nn is utilized to represent a diagonal matrix a with leading diagonal elements a 11 a nn a b represents the kronecker product of two matrices a b 2 preliminaries in this section we introduce some basic theories of interaction graph and function approximation based on rbf nns the interaction graph is utilized to represent the communication topology of multiple asvs function approximation based on rbf nns is powerful when addressing model uncertainties of asvs 2 1 interaction graph a weighted digraph g is employed to model communication topology of a network consisting of multiple asvs the set of vessels can be viewed as the set of nodes and the set of directed communication links can be viewed as the set of edges let v v i i ℐ represents a set of n vessels where ℐ 1 2 n a directed edge from v i to v j denoted as v i v j e represents a directed communication link from vessel v i to vessel v j that is vessel v j can receive information from vessel v i where e is the set of edges the adjacency matrix of graph g is denoted as a a i j n n where a i j is the element at the i th row and the j th column of a if v j v i e a i j 1 otherwise a i j 0 moreover we assume that a i i 0 for all i ℐ the set of neighbors of node v i is denoted by n i v j v v j v i e the laplacian matrix ℒ l i j n n associated with graph g is defined as l i j a i j i j and l i i k 1 n a i k a directed path from node v i 1 to node v i s is a sequence of different nodes v i 1 v i s where v i j v i j 1 e j 1 s 1 a digraph has a directed spanning tree if there exists at least one node called the root having a directed path to all of the other nodes the following lemma presents a basic property of a graph with directed spanning trees which is related to its laplacian matrix lemma 1 li and wang 2013 if the interaction graph g contains at least one directed spanning tree then its corresponding laplacian matrix ℒ is positive definite 2 2 function approximation based on rbf nns in control engineering neural networks are usually utilized to approximate an unknown function due to their simplicity and powerful capability of nonlinear fitting rbf nns are good candidates for this purpose the general approximation principle based on rbf nns is summarized as the following lemma 2 lemma 2 for any given real continuous function f x defined on a compact set ω x there exists an ideal weights vector w such that 1 f x w t h x ε where ε is the bounded function approximation error x x 1 x m t is the input vector m is the number of the input h x h 1 x h p x t is the gaussian basis function vector which satisfies 2 h i x exp x c i 2 2 2 b i 2 i 1 p where p is the number of neurons c i ℝ m is the center of the receptive field and b i ℝ is the width of the gaussian function 3 problem formulation consider a network consisting of n asvs kinematic and kinetic equations of the i th asv are given by 3 η i r ψ i ν i m i ν i c i ν i ν i d i ν i ν i g i τ iw τ i where i 1 n is the index of each vessel η i x y y i ψ i t is the position vector in the earth fixed frame x i y i denotes the position coordinate and ψ i denotes the yaw angle r ψ i has the form as 4 r ψ i cos ψ i sin ψ i 0 sin ψ i cos ψ i 0 0 0 1 ν i u i v i r i t is the velocity vector in the body fixed frame u i v i and r i represent the surge sway and yaw angular velocities respectively m i is the inertia matrix which is symmetric positive definite c i ν i is the centripetal and coriolis matrix d i ν i is the hydrodynamic damping matrix which is also symmetric and positive definite g i g i u g i v g i r t represents the unmodeled dynamics τ iw τ i w u τ i w v τ i w r t is the vector of force and moments induced by environmental disturbances τ i τ i u τ i v τ i r t is the vector of actuators inputs assume that there is a virtual leader moving along a predefined time varying trajectory η r ℝ 3 only a few follower asvs have access to the position vector η r of the virtual leader the leader follower cooperative formation control problem of asvs is described as the following problem 1 problem 1 give a network with multiple asvs described as 3 and an interaction topology encoded by a directed graph g find the distributed control law τ i for each vessel v i that depends on its own state η i ν i and its neighbors states η j ν j j n i determined by graph g such that a predefined relative formation shape δ i ℝ 3 can be achieved i e 5 η i δ i η r i 1 n with bounded errors remark 1 there are two typical features of the problem investigated in this paper 1 unlike the conventional leader follower formation in cui et al 2010 peng et al 2013a jin 2016 shojaei 2015 the interaction topology is taken into account in the aforementioned leader follower cooperative formation problem the major advantage of this method is that the information of the leader vessel is unnecessary to be available to all the follower vessels in such case the formation control of multiple vessels would not suffer from the single point failure of the leader 2 compared with the problem in thorvaldsen and skjetne 2011 peng et al 2013b liu et al 2017b directed rather than undirected interaction topology is considered here namely communication links are allowed to be unidirectional next some important assumptions and lemmas are introduced for later use assumption 1 for the time varying reference trajectory η r there exists a positive constant ρ m ℝ such that η r 1 ρ m assumption 2 the external disturbance τ iw is bounded i e there exists a positive constant b d ℝ such that τ iw 2 b d remark 2 in practical applications velocities of each asv are bounded due to the constraints of actuators this implies that assumption 1 can be easily satisfied in the marine practice since external environments keep changing with finite energies disturbances acting on asvs are unknown time varying and bounded it is obvious that assumption 2 is reasonable from assumption 2 we can see that the assumption on the first derivative of disturbances is relaxed compared with fu et al 2015 du et al 2016 lemma 3 the following inequality holds for any ε 0 and for any vector x ℝ n 6 x k p ε x t tanh x ε where k p is a constant that satisfies k p e k p 1 i e k p 0 2785 proof let x x 1 x n t in terms of lemma 1 in chen et al 2011 for any i 1 n we have 7 x i k p ε x i tanh x i ε it leads to the following inequality 8 max 1 i n x i k p ε max 1 i n x i tanh x i ε since x i tanh x i ε 0 inequality 6 can be obtained which completes the proof lemma 4 given two vectors x y ℝ n for any ε 0 we have 9 x t y 1 2 ε x t x 1 ε y t y proof the proof procedure is similar with proposition 1 in lombana and di bernardo 2016 if we choose q 1 q 2 i n as a result it is omitted here lemma 5 ge and wang 2004 consider a system x f x x ℝ n for any bounded initial state x 0 if there exists a c 1 continuous positive definite lyapunov function v x satisfying κ 1 x v x κ 2 x and v α v β where κ 1 κ 2 are class k functions and α β are positive constants then the solution x is sguub 4 main results define the formation error z i 1 and the other two error variables z i 2 z i 3 as 10 z i 1 η i δ i η r z i 2 α i 1 α i 1 z i 3 ν i α i 1 where α i 1 is a virtual control law and α i 1 is a filtered virtual control law each element of α i 1 is obtained by letting its corresponding element in α i 1 pass through a first order filter with the time constant given by the corresponding diagonal element of γ i namely 11 γ i α i 1 α i 1 α i 1 where γ i is a diagonal positive definite matrix then the error dynamics of z i 1 z i 2 z i 3 are given by 12 z i 1 z i 2 z i 3 α i 1 η r z i 2 γ i 1 z i 2 α i 1 m i z i 3 c ν i ν i d ν i ν i g i τ iw τ i m i γ i 1 z i 2 remark 3 to cope with the explosion of complexity problem caused by repeated derivative of virtual control laws α i 1 the dsc approach is employed here as can be observed later the error variable z i 2 instead of α i 1 is utilized in the formation controller design then the proposed controller becomes more practical in the sequel the backstepping design procedure is presented which leads to the formation controller design and the main theorem step 1 at this step the virtual control law α i 1 is designed the cooperative tracking error s i is defined as 13 s i j 1 n a i j η i δ i η j δ j d i η i δ i η r j 1 n a i j z i 1 z j 1 d i z i 1 where d i 1 if the follower vessel has access to the information of the virtual leader and d i 0 otherwise the virtual leader can be treated as a node if the follower has access to the information of the virtual leader a directed edge is constructed from the leader node to the follower node the leader node the constructed edges and the original interaction graph g can constitute an enlarged graph g which is also directed the laplacian matrix associated with g is denoted by ℒ choose the virtual control law α i 1 to be 14 α i 1 k i 1 r t ψ i s i k i 0 r t ψ i tanh n z i 1 ε where k i 0 k i 1 ℝ 3 3 are both diagonal matrices with positive diagonal entries and zero off diagonal entries ε is a positive constant that can be adjusted to facilitate the controller design let z 1 z 11 z n 1 t z 2 z 12 z n 2 t z 3 z 13 z n 3 t ν ν 1 ν n t ℛ diag r ψ i m diag m i s s 1 s n t k 0 diag k i 0 k 1 diag k i 1 α 1 α 11 α n 1 t γ diag γ i then the virtual control law α i 1 can be written in a compact form as 15 α 1 k 1 r t s k 0 r t t a n h n z 1 ε k 1 r t l i 3 z 1 k 0 r t t a n h n z 1 ε consider the candidate lyapunov function v 1 as follows 16 v 1 1 2 z 1 t z 1 the derivative of v 1 with respect to time is given by 17 v 1 z 1 t r z 2 z 3 α 1 1 η r z 1 t r z 2 z 3 z 1 t k 1 l i 3 z 1 z 1 t k 0 t a n h n z 1 ε z 1 t 1 η r by means of lemma 3 we have 18 v 1 z 1 t r z 2 z 3 z 1 t k 1 l i 3 z 1 z 1 t k 0 t a n h n z 1 ε z 1 n ρ m z 1 t r z 2 z 3 z 1 t k 1 l i 3 z 1 z 1 t k 0 t a n h n z 1 ε k p ε ρ m ρ m z 1 t t a n h n z 1 ε choose k 0 properly such that λ min k 0 ρ m we have ρ m z 1 t tanh n z 1 ε z 1 t k 0 tanh n z 1 ε 0 then the derivative of v 1 satisfies 19 v 1 z 1 t k 1 ℒ i 3 z 1 z 1 t ℛ z 2 z 1 t ℛ z 3 k p ε ρ m remark 4 the proposed virtual control law α 1 has three features 1 the laplacian matrix associated with the directed rather than undirected interaction topology is adopted in α 1 the unidirectional communication is allowed for leader follower cooperative formation of multiple asvs which implies that our algorithm is robust against link failure 2 the positive constant ε is introduced into α 1 to make the convergence analysis clearer as can be observed later ε determines the upper bound of the formation error z i 1 namely z i 1 can be reduced if we decrease ε besides if the interaction topology is undirected and ε n the proposed virtual control law turns to be that in peng et al 2013b 3 under assumption 1 α 1 can make the upper bound of the formation error z i 1 independent of the dimension of z i 1 and the number of asvs this can be seen from 18 where k p ε ρ m rather than n n k p ε ρ m appears then using α 1 the formation error cannot be affected by the increasing number of asvs in the formation step 2 control law τ i is designed for each vessel at this step consider the candidate lyapunov function v 2 as follows 20 v 2 v 1 1 2 z 2 t z 2 1 2 z 3 t m z 3 according to the error dynamics 12 z i 2 can be written into the compact form as 21 z 2 γ 1 z 2 k 1 ℛ t ℒ i 3 z 1 k 0 ℛ t 1 tan h t n z 1 ε tanh n z 1 ε n z 1 ε let b k 1 ℛ t ℒ i 3 z 1 k 0 ℛ t 1 tan h t n z 1 ε tanh n z 1 ε n z 1 ε observed that the vector b consists of bounded functions with respect to z 1 z 2 z 3 η r then there exists a positive constant b such that b 2 b similarly z i 3 can be written into the compact form as 22 m z 3 m v m γ 1 z 2 then the derivative of v 2 with respect to time yields 23 v 2 v 1 z 2 t γ 1 z 2 b z 3 t m v m γ 1 z 2 z 1 t k 1 l i 3 z 1 z 2 t γ 1 z 2 z 1 t r z 2 z 2 t b z 3 t r t z 1 m v m γ 1 z 2 k p ε ρ m by means of lemma 4 we have 24 z 1 t ℛ z 2 1 2 z 1 t z 1 z 2 t z 2 25 z 2 t b 1 2 1 ε z 2 t b t b z 2 ε then the derivative of v 2 turns to be 26 v 2 z 1 t k 1 l i 3 0 5 i z 1 z 2 t γ 1 0 5 ε 1 b t b 1 i z 2 z 3 t r t z 1 m v m γ 1 z 2 k p ρ m 0 5 ε let b 1 ℛ t z 1 m v m γ 1 z 2 now taking the term z 3 t b 1 into consideration we have 27 z 3 t b 1 i 1 n z i 3 t m i ν i r t ψ i z i 1 m i γ i 1 z i 2 i 1 n z i 3 t τ i τ iw f i r t ψ i z i 1 where f i c ν i ν i d ν i ν i g i m i γ i 1 z i 2 in practice model parameters c ν i d ν i g i m i are difficult to be obtained accurately therefore rbf nns are utilized to deal with model uncertainties as follows 28 f i w i h i ε i where w i w i 1 t w i 2 t w i 3 t t h i h i 1 t h i 2 t h i 3 t t w ij h ij x ij ℝ p j 1 2 3 x ij ν i j t z i 2 j t t here ν i j means the j th row of ν i and z i 2 j is the same ε i ε n i 1 n ε n 0 in order to reduce the computational effort and meet requirements of the real time control a single parameter ϕ i which can describe the upper bound of the weights matrix w i is estimated instead of updating the values of w i let ϕ i max 1 j 3 w ij 2 2 obviously ϕ i 0 the estimation of ϕ i is denoted by ϕ ˆ i and the initial value of ϕ ˆ i is defined as ϕ ˆ i 0 denote the estimation error of ϕ i as ϕ i we have ϕ i ϕ ˆ i ϕ i choose the control law τ i for each vessel to be 29 τ i τ i nom τ i aux τ i nom k i 2 z i 3 n ϕ ˆ i 2 ε z i 3 h i h i r t ψ i z i 1 τ i aux n b ˆ d i 2 ε z i 3 where τ i nom is the nominal control law to deal with uncertain dynamics τ i aux is the auxiliary control law to compensate environmental disturbances and the approximation error of rbf nns in τ i nom k i 2 is a diagonal matrix with positive diagonal entries and zero off diagonal entries the parameter ϕ ˆ i updates as the following mlp based adaptive law 30 ϕ ˆ i γ n 2 ε j 1 3 z i 3 j 2 h ij 2 2 k ϕ i ϕ ˆ i ϕ ˆ i 0 where γ 0 is the adaption gain k ϕ i 0 is the feedback gain in τ i aux the parameter b ˆ d i is the estimation of the constant b d i ε n b d and the estimation error satisfies b d i b ˆ d i b d i b ˆ d i updates as the following auxiliary adaptive law 31 b ˆ d i γ b n 2 ε z i 3 2 2 k b i b ˆ d i b ˆ d i 0 where γ b is a positive adaption gain and k b i is the positive feedback gain substituting equation 28 and the control law 29 into equation 26 we have 32 v 2 z 1 t k 1 l i 3 0 5 i z 1 z 2 t γ 1 0 5 ε 1 b t b 1 i z 2 z 3 t k 2 z 3 k p ρ m 0 5 ε i 1 n z i 3 t w i h i 0 5 ε 1 ϕ ˆ i z i 3 h i h i τ iw ε i n b ˆ d i 2 ε z i 3 where k 2 diag k i 2 to facilitate the discussion let k ϕ diag k ϕ i and k b diag k b i remark 5 advantages of the proposed robust adaptive formation controller 29 can be found from the following three aspects 1 the control law 29 is distributed rather than centralized since each asv keeps the related formation shape using its own and neighbors information where the information of the leader may be unnecessary then negative effects caused by the single point failure of the leader can be eliminated 2 the mlp based adaptive law 30 is incorporated in 29 for function approximations of uncertain dynamics then only one parameter instead of the enormous weights matrix requires to estimate the computational effort can be considerably reduced and the solving efficiency is improved 3 based on the auxiliary adaptive law 31 a novel auxiliary control law τ i a u x is designed which is a continuous function neither the signum function sgn z i 3 nor the saturation function sat z i 3 is included in 29 such that undesired chattering effects and the inferior performance can be avoided remark 6 focusing on applications in cooperative formation of asvs the developed formation controller 29 with adaptive laws 30 31 is an effective exploration of adaptive nn controllers presented in he and meng 2018 he et al 2016 he et al 2017a he et al 2017b furthermore differences from these existing results include 1 controller 29 is based on the dsc technique such that derivative of virtual control laws is omitted from inputs of nns 2 the mlp algorithm is incorporated in the proposed scheme to obtain updating of only one learning parameter rather than the enormous weights matrix 3 the number of asvs is utilized in controller 29 and adaptive laws 30 31 then the effects caused by the number of asvs on the formation error can be reduced theorem 1 under assumptions 1 and assumptions 2 consider a network with n asvs described as 3 let the enlarged graph g have a directed spanning tree choose the control law 29 with the mlp based adaptive law 30 and the auxiliary adaptive law 31 for each vessel then for bounded initial conditions all the signals in the closed loop system can be guaranteed to be semi global uniformly ultimately bounded sguub by setting the positive controller parameters k 0 k 1 k 2 k ϕ k b γ γ b γ ε appropriately and 5 holds for all vessels provided that control parameters k 0 k 1 γ satisfy the following conditions 33 λ m i n k 0 ρ m λ m i n k 1 1 2 λ m i n ℒ λ m a x γ 2 ε b 2 1 proof put the parameter ϕ i its estimation ϕ ˆ i the corresponding initial value ϕ ˆ i 0 and the estimation error ϕ i into compact vector forms i e let ϕ ϕ 1 ϕ n t ϕ ˆ ϕ ˆ 1 ϕ ˆ n t ϕ ˆ 0 ϕ ˆ 1 0 ϕ ˆ n 0 t and ϕ ϕ 1 ϕ n t similarly let b d b d 1 b d n t b ˆ d b ˆ d 1 b ˆ d n t b ˆ d 0 b ˆ d 1 0 b ˆ d n 0 t and b d b d 1 b d n t consider the candidate lyapunov function v 3 as follows 34 v 3 v 2 1 2 γ ϕ t ϕ 1 2 γ b b d t b d then the derivative of v 3 with respect to time becomes 35 v 3 b 2 k p ρ m 0 5 ε i 1 n z i 3 t w i h i n 2 ε ϕ ˆ i z i 3 t z i 3 h i h i ϕ i n 2 ε j 1 3 z i 3 j 2 h i j 2 2 z i 3 t τ i w ε i n b ˆ d i 2 ε z i 3 n b d i 2 ε z i 3 2 2 i 1 n k ϕ i ϕ i ϕ ˆ i ϕ ˆ i 0 k b i b d i b ˆ d i b ˆ d i 0 let b 2 z 1 t k 1 ℒ i 3 0 5 i z 1 z 2 t γ 1 0 5 ε 1 b t b 1 i z 2 z 3 t k 2 z 3 we have v 3 b 2 k p ρ m 0 5 ε i 1 n z i 3 t w i h i n 2 ε ϕ ˆ i z i 3 t z i 3 h i h i ϕ i n 2 ε j 1 3 z i 3 j 2 h ij 2 2 z i 3 t τ i w ε i n b ˆ d i 2 ε z i 3 n b d i 2 ε z i 3 2 2 i 1 n k ϕ i ϕ i ϕ ˆ i ϕ ˆ i 0 k b i b d i b ˆ d i b ˆ d i 0 on one hand by means of lemma 4 the following holds 36 z i 3 j w ij t h ij n 2 ε ϕ i z i 3 j 2 h ij t h ij ε 2 n then it yields that 37 z i 3 t w i h i j 1 3 z i 3 j w ij t h ij n 2 ε ϕ i j 1 3 z i 3 j 2 h ij t h ij 3 ε 2 n on the other hand we have 38 n 2 ε ϕ ˆ i z i 3 t z i 3 h i h i n 2 ε ϕ i j 1 3 z i 3 j 2 h ij 2 2 n 2 ε ϕ i j 1 3 z i 3 j 2 h ij t h ij besides the following holds 39 z i 3 t τ iw ε i n b ˆ d i 2 ε z i 3 z i 3 2 b d i n b ˆ d i 2 ε z i 3 2 2 also by means of lemma 4 we further have 40 z i 3 t τ iw ε i n b ˆ d i 2 ε z i 3 n 2 ε z i 3 2 2 ε 2 n b d i n b ˆ d i 2 ε z i 3 2 2 n b d i 2 ε z i 3 2 2 ε b d i 2 n therefore the derivative of v 3 turns to be 41 v 3 b 2 k p ρ m 2 0 5 ε n b d ε i 1 n k ϕ i ϕ i ϕ ˆ i ϕ ˆ i 0 k b i b d i b ˆ d i b ˆ d i 0 according to the following two inequalities ϕ i ϕ ˆ i ϕ ˆ i 0 1 2 ϕ i 2 ϕ i ϕ ˆ i 0 2 b d i b ˆ d i b ˆ d i 0 1 2 b d i 2 b d i b ˆ d i 0 2 we have v 3 b 2 k p ρ m 2 0 5 ε n b d ε 0 5 i 1 n k ϕ i ϕ i 2 k b i b d i 2 0 5 i 1 n k ϕ i ϕ i ϕ ˆ i 0 2 k b i b d i b ˆ d i 0 2 z 1 t k 1 l i 3 0 5 i z 1 z 2 t γ 1 0 5 ε 1 b t b 1 i z 2 z 3 t k 2 z 3 0 5 ϕ t k ϕ ϕ 0 5 b d t k b b d 0 5 ϕ ϕ ˆ 0 t k ϕ ϕ ϕ ˆ 0 0 5 b d b ˆ d 0 t k b b d b ˆ d 0 k p ρ m 2 0 5 ε n b d ε by means of lemma 1 it holds that 42 v 3 λ min k 1 λ min ℒ 1 2 z 1 t z 1 λ min γ 1 b 2 1 2 ε z 2 t z 2 λ min k 2 z 3 t z 3 1 2 λ min k ϕ ϕ t ϕ 1 2 λ min k b b d t b d 0 5 ϕ ϕ ˆ 0 t k ϕ ϕ ϕ ˆ 0 0 5 b d b ˆ d 0 t k b b d b ˆ d 0 k p ρ m 2 0 5 ε n b d ε if the following conditions hold 43 λ min k 0 ρ m λ min k 1 1 2 λ min ℒ λ max γ 2 ε b 2 1 then v 3 can be described as 44 v 3 α v 3 β where α and β are positive constants satisfying α min 2 λ min k 1 λ min ℒ 1 2 λ min γ 1 b 2 1 ε 2 λ min k 2 λ max m γ λ min k ϕ γ b λ min k b β 0 5 ϕ ϕ ˆ 0 t k ϕ ϕ ϕ ˆ 0 0 5 b d b ˆ d 0 t k b b d b ˆ d 0 k p ρ m 2 0 5 ε n b d ε according to lemma 5 we can conclude that for bounded initial conditions all the signals in the closed loop system are sguub in addition by integrating 44 we have 45 v 3 v 3 0 e α t β α 1 e α t from the equation 34 and the inequality 45 we further have 46 1 2 z 1 t 2 2 β α t therefore the formation error z 1 converges to a compact set ω z 1 z 1 z 1 2 2 β α as t which implies that 5 holds this completes the proof remark 7 the proof of theorem 1 relies on the lyapunov directed method where the candidate lyapunov function v 3 is adopted it can be seen that v 3 is chosen to be the sum of squared error signals z 1 z 2 z 3 ϕ b d also observed that theorem 1 is based on the communication condition that the interaction topology has a directed spanning tree which is a simplest condition on the directed graph predefined formation shapes can be obtained if the condition 33 is satisfied upper bound of the formation error z 1 is 2 β α which can be reduced if we appropriately increase control gains k 0 k 1 k 2 k ϕ k b γ γ b or decrease the filter gain γ and the parameter ε remark 8 compared with results on distributed maneuvering or containment maneuvering of asvs liu et al 2017b peng et al 2018 peng et al 2017 zhu et al 2017 a new robust adaptive cooperative formation control scheme consisting of the virtual control law 14 the controller 29 and adaptive laws 30 31 is presented for asvs under a directed interaction topology unlike liu et al 2017b peng et al 2018 peng et al 2017 where the enormous weights matrix requires to update for approximation only one learning parameter is estimated in the proposed control scheme meanwhile different from the controller with signum functions in zhu et al 2017 a continuous controller is obtained here 5 simulations and comparison results in this section simulation studies are presented based on the model ship in peng et al 2013b and skjetne et al 2005 with parameters given in table 1 where standard si units are used the mass of the model ship is 23 8 kg its length is 1 255 m and its breadth is 0 29 m model uncertainties g i and external disturbances τ iw are chosen as follows g i u 0 0279 u i v i 2 0 0342 v i 2 r i g i v 0 0912 u i 2 v i g i r 0 0156 u i r i 2 0 0278 u i v i 3 r i τ i w u 2 cos 0 5 t cos t 0 3 cos 0 5 t sin 0 5 t 3 n τ i w v 0 01 sin 0 1 t n and τ i w r 0 6 sin 1 1 t cos 0 3 t n m 5 1 closed loop performance consider a group of three asvs denoted by no 1 no 2 and no 3 with the interaction topology given in fig 1 asv 0 is the virtual leader whose information can only be transmitted to the follower asv 1 observed that communication links are all unidirectional and the interaction graph has a directed spanning tree formation configurations are predefined as δ 1 2 m 0 m 0 rad t δ 2 0 m 2 m 0 rad t and δ 3 0 m 2 m 0 rad t which implies that the formation shaped as the isosceles right triangle is finally achieved for simplicity the trajectory of the virtual leader is set to be a straight line initial values from asv 0 to asv 3 are given by η 0 0 m 10 m 0 rad t η 1 4 m 15 m π 3 rad t η 2 5 m 21 m π 2 rad t η 3 3 m 0 m π 2 rad t ν 0 0 6 m s 0 m s 0 rad s t ν 1 ν 2 ν 3 0 m s 0 m s 0 rad s t by the trial and error the filtered gain matrix is chosen to be γ i diag 0 01 0 02 0 02 i 1 2 3 control gain parameters are selected as k i 0 diag 5 0 65 0 61 k i 1 diag 0 6 0 6 0 6 k i 2 diag 1 0 1 0 1 k ϕ i 0 1 k b i 0 2 ε 0 1 γ 10 and γ b 20 initial values of two adaptive parameters are chosen as ϕ ˆ i 0 0 1 b ˆ d i 0 0 1 parameters in rbf nns are set as follows the number of neurons p 15 the center of the receptive field c i is placed in 1 3 1 3 1 3 1 3 and the width of the gaussian function b i 2 it can be checked that condition 33 in theorem 1 is satisfied with these parameters under the interaction topology given in fig 1 design the control law 29 and adaptive laws 30 31 for each asv using aforementioned controller parameters according to theorem 1 the desired formation can be achieved along the predefined trajectory of the virtual leader fig 2 shows formation trajectories of three asvs in the 2 d plane asvs in fig 2 are 1 1 scale representations of the model ship it is obvious that the desired formation shaped as the isosceles right triangle is finally achieved which conforms to theorem 1 by theorem 1 all the signals in the closed loop system should be sguub using the designed controller solid lines in fig 5 illustrate formation errors z i 1 of three asvs with proposed controllers from three different dimensions as can be seen from a and b in fig 5 the formation error z i 1 1 and z i 1 2 with respect to x and y coordinates in the earth fixed coordinate are sguub respectively from c in fig 5 the formation error z i 1 3 about the yaw angle is also sguub control inputs of three asvs are presented in fig 3 observed that all the control signals are sguub and continuous which can eliminate undesired chattering effects and the inferior performance of the formation system since there exists no signum or saturation functions in the proposed control law adaptive parameters of three asvs are shown in fig 4 we can see that all the adaptive parameters can finally converge to a compact set at the same time only one learning parameter ϕ ˆ i instead of the enormous weights matrix is updated for each vessel leading to less computational effort when the desired formation shapes are guaranteed all of the above mentioned simulation analysis accord with theorem 1 5 2 comparison results first the proposed controller is compared with the model based controller formation control of asvs with model based approaches generates many good results breivik et al 2008 zhu et al 2017 the model based control law τ im to problem 1 with known model parameters m i c i ν i d i ν i is given by 47 τ im c ν i ν i d ν i ν i m i γ i 1 z i 2 r t ψ i z i 1 k i 2 z i 3 for comparison simulation studies are conducted between two types of controllers with the same common control parameters fig 5 shows the simulation results where solid lines represent formation errors with the proposed controller and dot lines describe formation errors with model based controllers it can be observed that better performance is achieved with the proposed controller the reasons for unsatisfied performance of the model based controller 47 mainly lie in two aspects on one hand the unmodeled dynamics g i are not considered into the controller design on the other hand there exists no compensation mechanism for disturbances τ iw since the robustness against uncertain dynamics and external disturbances are enhanced by the rbf nns based controller 29 combined with the mlp based adaptive law 30 and auxiliary adaptive law 31 smaller steady formation errors can be guaranteed second effects of the number of nns nodes on control performance are discussed when using the proposed formation controller we choose different number of nns nodes to carry out simulations in matlab r2016a the program is run on an inter r core tm i5 2450m 2 50 ghz laptop with 4g memory detailed comparisons are summarized in table 2 where the integrated absolute error iae and integrated time absolute error itae are utilized to evaluate the transient and steady state performance iae and itae are defined as iae 0 t z 1 i τ 1 d τ and itae 0 t τ z 1 i τ 1 d τ i 1 2 3 where z 1 i z 11 i z 21 i z 31 i t and z j 1 i means the i th row of z j 1 j 1 2 3 the formation error vector z 1 1 represents tracking errors of three asvs in the x axis direction z 1 2 and z 1 3 denote the formation error z 1 in the y axis and ψ direction respectively from table 2 we can see that as the number of nns nodes increases both of iae and itae in three directions of the asv formation decrease but the running time becomes longer this is because more nodes lead to lower nns approximation errors and larger computational effort also observed that when the node number exceeds 15 iae and itae gradually decrease with smaller rate of change to make a trade off between approximation error and computational effort we choose p 15 in subsection 5 1 and the first comparison in this subsection it is worth mentioning that nns approximation errors cannot be achieved directly since the mlp algorithm is incorporated in the proposed formation controller no matter how the number of nns nodes varies only one learning parameter needs to be updated in the proposed scheme such that the online learning time is reduced this is the reason why the running time is not too long for all cases in table 2 6 conclusion in this paper a new distributed robust adaptive cooperative formation control scheme is presented for asvs under a directed interaction topology it is shown that predefined geometrical configurations can be achieved with the proposed controller and two adaptive laws if the interaction topology has a directed spanning tree which implies unidirectional communication is allowed repeated derivative of virtual control laws is eliminated i e the explosion of complexity problem does not exist robustness against model uncertainties and external disturbances is enhanced and only one learning parameter instead of the enormous weights matrix is updated for each vessel in the future the cooperative formation control problem of underactuated asvs will be considered in addition research of the cooperative formation control based on state feedback can be extended to the control strategy based on output feedback acknowledgments this paper is partly supported by the national natural science foundation of china 61473183 61627810 u1509211 national key r d program of china sq2017yfgh001005 and national postdoctoral program for innovative talents of china bx201600103 
23106,the present study describes the turbulent flow characteristics of the steady flow and the combined wave current flow for two different wave periods on unidirectional current the turbulent kinetic energy distributions for steady flow and combined wave current flow were analyzed to examine the turbulent energy production pressure energy diffusion turbulent energy dissipation and turbulent energy diffusion comprehensively the result shows that the pressure energy diffusion drastically changes to a negative value due to the imposed surface wave on steady unidirectional current this phenomenon indicates a low pressure flow mode near the bed that probably affects the local sediment mobility in the coastal zone furthermore the taylor s frozen flow hypothesis was used to evaluate the dissipation rate of turbulent fluctuations to study the intermittent structure of turbulence due to imposed surface wave on steady current superposition of surface waves on unidirectional current significantly enhanced the finer dissipative eddies of the steady flow by the intonation of the energy cascade mechanism through wave induced length scale keywords adv length scale steady flow turbulence wave current 1 introduction in the coastal region wave and current simultaneously co exists and form intricate flow structure in which different substantial processes with diverse temporal and spatial scales act together the sediment entrainment suspension and sea bed stability characteristics are examples of possible application that can benefit from an enhanced knowledge of the combined action between waves and steady current further the combined effects of waves and currents in free surface flows have been the subject of many studies due to their impacts on coastal hydrodynamics in this environment horizontal and vertical velocities as well as shear stresses depend strongly on the interactions of waves and currents the vertical profiles of these variables are modified and these are major issues in near shore waves and currents modelling hence a large number of studies have been devoted to the study of combined effects of waves and steady currents in free surface flows 1 1 literature review in order to study the combined effects of wave and current majority of the previous experimental for e g kemp and simons 1982 umeyama 2005 2009 singh and debnath 2016 2017 and others and numerical modelling olabarrieta et al 2010 teles et al 2013 zhang et al 2014 and others were carried out over a flat surface to understand the wave current interaction flow and turbulence characteristics generally the emphasis was given to examine the mean velocity profile and how it changed from that of the universal logarithmic law observed for steady flow along with the wave current co existing environment over a flat bed it was also reported that the changes in the different turbulence parameters such as turbulence intensity and reynolds shear stress due to the superimposition of a surface wave on the steady flow over a flat surface furthermore the mechanics of combined wave current flow have been investigated theoretically by many researchers for e g time invariant one layer turbulent eddy viscosity model developed by grant and madsen 1979 to describe combined wave and current motion myrhaug 1982 further extended the eddy viscosity model proposed by grant and madsen 1979 to developed analytical solution for the velocity profile in combined wave current flow nielsen and you 1996 used eulerian approach and suggested an eddy viscosity model by using several ad hoc assumptions to obtained fair results however huang and mei 2003 pointed out that the model proposed by nielsen and you 1996 was not entirely satisfactory with the experimental data thereafter huang and mei 2003 studied the combined effect of waves and current and computed the turbulent shear stresses by using turbulence model which give the eddy viscosity straight from the flow variable however the model proposed by huang and mei 2003 is not easy to apply as suggested by tambroni et al 2015a a simple model proposed by tambroni et al 2015a for the wave current interacting flow which agreed well with the experimental measurements of kemp and simons 1982 klopman 1994 and umeyama 2005 this new model may have a greater capability in simulating the combined wave cuurent flow tambroni et al 2015b performed a flume experiment and study the impact of macroalgal mats on the wave and current dynamics they reported that in the case of waves combined with currents over macroalgae the most significant effect of an algal mat is to damp velocity oscillations induced by waves while the friction velocity remains essentially unchanged and the roughness parameter tends to increase slightly in addition they also reported that the time averaged stream wise velocity profile is very near to that observed in the presence of a current only profile when comparatively feeble waves are superposed with a strong unidirectional current recently singh and debnath 2016 performed a flume experiment to study the effect of surface wave on unidirectional current which mainly focused on the first and second order turbulent statistics spectra analysis was also performed by the author to obtain the oscillation pattern within the flow field that may affect the turbulent properties due to combined wave current flow most of the previous studies focused on the mean velocity profile arising from wave current flow differs from that of steady flow well known logarithmic law and the superposition of waves on a current enhances the turbulent intensity but no study has been reported so far to understand the effect of the superimposed surface wave on the intermittent structure of turbulence as well as the turbulent energy flux therefore the aim of this study is to examine the turbulent energy budget in terms of turbulent energy production pressure energy diffusion turbulent energy dissipation and turbulent energy diffusion in combined wave and steady current flow furthermore the dissipation rate of turbulent fluctuations due to imposed surface wave on steady current is evaluated using taylor s frozen flow hypothesis to study the intermittent structure of the turbulence the flow structure generated by combined wave current flow is of great importance in the coastal zone for determining mass and sediment transport rates because the sediment is picked up by the waves and transported by the mean stream wise flow umeyama 2005 therefore the quantitative results from this study will be useful in model calibrations and in understanding sediment pickup grain sorting and transportation in coastal environments it is to be noted here that this paper mainly focuses on the turbulent energy budget and its distribution over a flat rigid surface with change in surface wave frequency and not specifically sediment transport hydrodynamics although the rigid bottom surface used in the present study is not the correct representation in the coastal zone this study will provide some understanding on energy distribution of the combined wave current flow over the rigid bed without any added difficulty in measurement in the combined wave current flow moreover the use of static rigid surface allows a high spatial resolution of analysis and sampling very close to the boundary which is not possible with mobile bed in the field 2 experimental setup and description experiments were performed in a laboratory flume at the fluid mechanics and hydraulic laboratory fmhl of the indian institute of engineering science and technology iiest shibpur india a specially designed flat bed open channel flume of dimensions 18 3 m long 0 90 m wide and 0 90 m deep was used for the experiments fig 1 the discharge valve was gradually opened to achieve the desired discharge in the flume and the tailgate was operated simultaneously to ensure the desired flow depth h 0 20 m the depth was maintained at a constant level during the experiment using a graduated scale attached to the side wall of the flume simultaneously uniformity was checked by vernier gauge readings of the water depth at the downstream end of the flume the water spills freely into a large sump from where it is recirculated into the flume using a vertical turbine pump located outside the main body of the flume the water flow after discharge from the pump passed through a series of wire meshes placed at the upstream end of the flume to ensure smooth and uniform flow through the experimental channel singh et al 2016 a custom designed vertically reciprocating plunger type wave maker was placed at the upstream end of the flume to produce surface waves fig 1 the wave maker was fabricated in the institute workshop two 20 cm diameter wheels were attached at the end of the spindle which was fitted with a worm gear at the middle position of the shaft and was connected with a speed reduction gear train in order to transfer the rotational motion into reciprocating motion a slider crank mechanism was used one end of the crank was linked at the 5 cm distance from the center of each pulley the connecting bar of the crank was permitted to pass through a guide in order to restrain the lateral displacement of the crank a plunger was fixed at both ends of those connecting bars fig 1 one 2 hp dc motor was used to provide the rotational motion of the gear train power supplied to the motor via a dc variac the variac was used controlled the rpm of the motor for generating the desired wave frequency the oscillation was produced at a right angle to the steady unidirectional current producing surface wave on unidirectional current description of the wave maker and its working principle are given in detail by singh et al 2018a in the present study two separate tests were carried out 1 current only flow test over the horizontal surface and 2 tests over the horizontal surface with addition of surface waves of the period t 0 5 and 1s on the current only flow different flow parameters for which the tests were conducted are as follows mean flow depth h is 20 cm the depth averaged velocity u is 15 cm s flow froude number f r u g h 0 5 is 0 085 flow reynolds number r e u h ν is 30 000 where ν is the kinematic viscosity of water g is the acceleration due to gravity further the wave height h and wave length l w were measured using a digital camera at several locations during the experiment the recorded images were analyzed to calculate the surface wave length and the wave height using the imaging technique converting pixel to the metric unit the presented surface wave describes a single basic wave with amplitude a h 2 wave number k 2 π l w and time period t having ak 1 i e wave height is small compared to wave length which quantifies that the present generated waves are regular 2d waves dean and dalrymple 2000 the experimental parameters for current only and combined wave current flow are shown in table 1 it is to be noted here that x the stream wise coordinate y the transverse coordinate z the bottom normal coordinate and u v and w are the associated velocity components respectively further u v and w denotes the time averaged velocity components and u v and w denotes the corresponding velocity fluctuations a sontek down looking 16 mhz micro acoustic doppler velocimeter micro adv was mounted on the flume to measure the fluid velocity with fluctuations at 40 hz over the flat horizontal surface for both current only and combined wave current flow the measurement was carried out at the flume centerline 11 m from the last wire mesh where the flow is verified to be fully developed flow for 5 min duration the lowest and the highest measurement point from the bed was about 0 40 cm and 14 cm respectively the time series data recorded by adv were firstly filtered by removing erroneous values in fact the data assessment consisted of i visual inspection of plotted time series ii estimation of signal to noise ratio and correlation samples using win adv software and iii velocity spectra the details of the data assessment based on all three procedures are presented in singh et al 2018a after the data assessment the time averaged velocity was computed at every sampling point by taking mean over the total acquisition time the instantaneous velocity for combined wave current flow in stream wise direction was then decomposed as follow 1 u u u u where u is the stream wise velocity fluctuation u is the stream wise time averaged velocity and u is the wave induced orbital velocity the wave imposed on steady current possesses a periodic nature and may be determined by phase averaging of the instantaneous which is detrended by the mean velocity 2 u lim n c 1 n c n 0 n c u t n t u where n is the number of wave cycle nc is the total number of wave cycles t is the wave period and denotes the phase averaging of the wave cycle 3 experimental conditions and obtained results 3 1 distribution of energy dissipation rate lohse and grossmann 1993 used the experimental data of meneveau and sreenivasan 1991 and illustrated that the intermittency level of turbulence reduces due to enhance in reynolds number this interpretation was made based on the estimates of dissipation rate as a function of time which showed that the number of intermittent dissipation peaks observed for lower flow velocity decreased when the flow velocity was increased based on the finding of lohse and grossmann 1993 the role of a surface wave on modulating the intermittent structure of the turbulence was attempted to be analyzed in this study fig 2 a i shows the time series of the normalized dissipation rate ε ε and ε ε for current only and combined wave current flow respectively at different level from the bed z h 0 02 0 3 and 0 5 the dissipation rate of turbulent fluctuations ε u t 2 was estimated by employing taylor s frozen flow hypothesis taylor 1938 and the derivative u t 2 can be interpreted as the dissipation rate per unit mass fig 2a c revealed that for current only flow the intermittency is the maximum and it decreases due to the addition of surface wave on unidirectional current further the time series of dissipation rate show a similar decrease in the intermittent structure for wave induced cases fig 2d i while a higher value of the dissipation rate shows a higher level of intermittent structure for current only flow thus it is pertinent that surface wave changes the intermittent structure probably due to the introduction of wave induced length scales to the current only flow by the intonation of the energy cascade mechanism of the background flow in addition the finer dissipative eddies are significantly enhanced by the change in time period and wave height of the surface wave 3 2 turbulent kinetic energy flux and energy budget the gradient of turbulent kinetic energy flux indicates the rate of increase or decrease of kinetic energy due to turbulent diffusion krogstad and antonia 1999 to understand these the vertical distribution of normalized kinetic energy fluxes in stream wise and bottom normal direction respectively i e f ku f k u u 3 and f kw f k w u 3 are plotted in fig 3 for both current only and combined wave current flow the stream wise and bottom normal direction flux of the turbulent energy for combined wave current flow is calculated as follows krogstad and antonia 1999 singh et al 2018b 3 f k u 0 5 u u u u w w u v v 4 f k w 0 5 w w w u u w w v v it is observed from fig 3a the stream wise kinetic energy flux f ku starts with positive value closed to bed and alters to a negative value at distance z h 0 15 from the bed however bottom normal turbulent kinetic energy flux f kw starts with a negative value close to the boundary and transforms to a positive value at a distance z h 0 15 from the bed the positive value of f ku near the boundary indicates that f ku is moved in bottom normal direction whereas the negative value of f kw near the boundary indicates that the z direction kinetic energy flux is in the downward transport as z h increases f ku showed negative value which denotes the transport of f ku in the upstream and away from the bed f kw advocate the transport of bottom normal flux of turbulent kinetic energy is in the upward direction thus near the boundary region the positive and negative values of f ku and f kw respectively suggested that the flux of turbulent kinetic energy is moved downstream with downward direction further far from the bottom boundary the negative and positive values of f ku and f kw respectively mean that the tke flux is transported upstream with upward direction however f ku and f kw flux of combined wave current flow case have nearly alike in nature than those of current only flow except larger magnitude of f ku is attained close to the bed and larger negative for the rest of the depth compared to current only flow is observed to recognize the physical processes in turbulence for combined wave current flow it is vital to balance the rate of exchange of energy of velocity and phase averaged fluctuations for current only flow and combined wave current flow respectively according to nezu and nakagawa 1993 the balance of energy terms in turbulent energy budget is consist of the turbulent energy production t p τ u z that is equal to the addition of pressure energy diffusion p d 1 ρ z p w turbulent energy dissipation ε turbulent energy diffusion t d f k w z and viscous diffusion ν d ν 2 k z 2 where k 0 5 u u w w v v is the turbulent kinetic energy and p is the pressure fluctuation previous studies nezu and nakagawa 1993 sharma and kumar 2017 proposed that the ν d term in the turbulent flow is unimportant with respect to other terms in the turbulent energy budget equation over the hydraulically rough surface the estimation of ε term is discussed in section 3 1 the purpose of pressure energy diffusion term p d negative value is to extract energy from the stress commenced from the mean flow and rehabilitate it to the other components and can be determined from unknown energy budget equation as p d t p ε t d the non dimensional parameter of turbulent kinetic energy budget t d t p p d and e d t d t p p d ε z u 3 are presented in fig 4 a d respectively for both current only and combined wave current flow cases fig 4b and d revealed that for current only flow t p and e d increase near the bed and then reduces with increase in distance from the bed and attained constant value far from the bed whereas in combined wave current flow t p first increases near the bed with higher value compared to current only flow and then decreases with increase in z h becoming negative toward the free surface the positive and negative t p indicates the exchange of turbulent kinetic energy from the mean flow to turbulence and vice versa further the negative reynolds stress acts as a negative shear in the upper portion of the flow to give negative turbulent production for combined wave current flow in addition the turbulent production is increased mainly in the near boundary with superposition of surface wave compared to current only flow indicating the increased level of turbulence production due to the surface wave usually the production term appears like a source term in favor of positive value however the negative value of production term specified the transportation of energy from the fluctuating eddy to the average flow velocity it is also observed from fig 4d that e d value is decreased when a surface wave is added to current only flow this is due to the fact that with the addition of wave extra energy is added to turbulent fluctuations as a result increase in turbulent energy becomes elevated dissipation of turbulent kinetic energy is less for combined wave current flow as compared to current only flow the turbulent diffusion is decreased near the boundary when a surface wave is added to steady flow as evident from fig 4 probably due to gain in t p and successive reduction in the t d and p d with the addition of surface wave on current only flow detert et al 2010 suggested that the near boundary mobility of sediment is generally related to an exchange of p d to a negative value due to gain in turbulence production hence in combined wave current flow a radical switch of p d to a negative value is observed representing a low pressure flow mode near the bed as a result gain in turbulence production which is responsible for pickup of sediment in the coastal zone detert et al 2010 3 3 variation of turbulent length scale in combined wave and steady flow in turbulent flow eddy size in the inertial subrange can be determined by taylor microscale as λ t 15 ν σ u 2 ε where σ u is the root mean square rms velocity component in x direction the rms velocity components in x direction direction for steady flow and combined wave and steady flow is estimated as follows umeyama 2005 singh et al 2015 5 σ u i 1 n u i u 2 6 σ u 1 n c n 0 n c 1 u i t n t u i t 2 the turbulent kinetic energy dissipation rate is calculated from the procedure discuss above see section 3 1 the normalized taylor scale λ z 0 z 0 λ t where z 0 is the roughness length scale is plotted in fig 5 against normalized vertical distance from the bed for steady flow and combined wave and steady flow in combined wave and steady flow the apparent roughness is obtained by linear extrapolation of the mean velocity profile to the zero velocity level for particular wave periods t 0 0 5 and 1 sec table 1 similar to teles et al 2013 it is revealed from fig 5 that the value of λ z 0 is decreased towards the surface which is associated with the reduced in σ u with the addition of surface wave umeyama 2005 compared to that of steady flow at close to the bed z h 0 02 the values are approximately 10 smaller with t 0 5s and about 4 smaller with t 1s as compared to that of the steady flow decrease of λ z 0 corresponds to the increased in λ t for combined flow signifies that the eddy size is enlarged or stretched near the bed this enlarged eddy may also play the vital role for the sediment mobility in wave induced flow compared to that of steady flow in order to visualise the eddy size and its turnover time due to the addition of surface wave the time scale and integral length scale were computed for the near bed velocity measured at z h 0 02 for 5 min duration this is because an integral length scale corresponds to the eddy of larger size in the turbulent flow and respective time scale shows the eddy turnover time at a specified point the transfers of tke and momentum exchange in the flow are linked with these eddies the integral time scale is expressed as follows tennekes and lumley 1972 7 e t 0 ζ r t d t where ζ denotes the time at which autocorrelation function r t almost reaches to zero tennekes and lumley 1972 r t and dt denote the autocorrelation function and the lag time respectively at first a linear interpolation scheme was adopted here in order to convert the time series data into regularly spaced events and thereafter autocorrelation was calculated further to reduce the inaccuracy in the calculation of turbulence length scales 24000 samples of instantaneous velocities were recorded in 10 min at the corresponding point for both steady flow and combined wave and steady flow experiment the value of time ζ was calculated based on r t 0 01 and dt 0 01s the value of e l and e t are shown in table 2 according to taylor 1938 the integral length scale is narrated to time scale as e l e t u where u is the mean velocity in x direction at the corresponding location it is observed from table 2 that eddy length and time scale are increased close to the bed z h 0 02 especially for t 1 s case compared to steady flow increased length scale close to the bed indicates that the elevated momentum and energy transfer as a result lower destruction of turbulent motions near the bed 4 conclusions the aim of this study is to examine the turbulent kinetic energy budget in combined wave current flow to highlight the changes in turbulent energy budget terms in combined wave current flow a comparative study was performed between the profiles of current only flow and those measured for combined wave current flow velocity data were analyzed within the framework of the phase averaging for combined wave current flow the analysis of the results shows that the finer dissipative eddies are significantly enhanced by the change in time period and wave height of the surface wave the negative reynolds stress acts as a negative shear in the upper portion of the flow to give negative turbulent production for combined wave current flow in addition the turbulent production is enhanced mostly close to the bed due to the addition of surface wave on steady current indicating the increased level of turbulence production due to the surface wave this increased level of turbulence is related with the increased turbulence intensities and increased momentum transfer further an increased length scale in the near bed region indicates that the higher momentum and energy transfer as a result lower destruction of turbulent motions near the bed pressure energy diffusion drastically changes to negative value due to addition of surface wave on steady current which indicates a low pressure flow mode near the bed present experimental results can appropriately be utilized for validation and benchmarking of numerical models of turbulent flows and then the validated and calibrated numerical models can be used to explore the flow field detail for wider ranges of parameters in the presence of surface wave over a solid boundary the result presented in this paper will also provide the causative factors for the transport of sediment in coastal zone further work is required to examine and extend the results to wider ranges of wave parameters and bed condition in the future in the coastal zone tides play an immense role on flow kinematics as the direction of current changed and become just opposite with certain interval of time however in this study such effect of tides on current was not taken into account this is because the surface wave generated in the present study is different from the tides surface waves are actually energy that moves across the surface of the water in the scientific community this is more commonly known as wind waves as these waves are generated by wind these waves occur on the free surface of oceans seas lakes rivers and canals or even on small puddles and ponds therefore in the present study we have tried to simulate this environment experimentally in laboratory flume and made an attempt to study the distribution of energy in wave current combined flow but in the coastal zone effect of tides play an immense role on flow kinematics as the direction of current changed and become just opposite with certain interval of time therefore a detailed study is required considering the effect of tides on current direction it is of interest to perform more experiments to improve our understanding on such effect of tides on current direction this will be studied in a separate paper acknowledgements the author would like to acknowledge the department of science and technology science and engineering research board government of india for financial support for this research contract no emr 2015 000266 the authors would also like to thank two anonymous reviewers for the useful comments which significantly improved the paper appendix a supplementary data the following is the supplementary data related to this article multimedia component 1 multimedia component 1 appendix a supplementary data supplementary data related to this article can be found at https doi org 10 1016 j oceaneng 2018 08 058 
23106,the present study describes the turbulent flow characteristics of the steady flow and the combined wave current flow for two different wave periods on unidirectional current the turbulent kinetic energy distributions for steady flow and combined wave current flow were analyzed to examine the turbulent energy production pressure energy diffusion turbulent energy dissipation and turbulent energy diffusion comprehensively the result shows that the pressure energy diffusion drastically changes to a negative value due to the imposed surface wave on steady unidirectional current this phenomenon indicates a low pressure flow mode near the bed that probably affects the local sediment mobility in the coastal zone furthermore the taylor s frozen flow hypothesis was used to evaluate the dissipation rate of turbulent fluctuations to study the intermittent structure of turbulence due to imposed surface wave on steady current superposition of surface waves on unidirectional current significantly enhanced the finer dissipative eddies of the steady flow by the intonation of the energy cascade mechanism through wave induced length scale keywords adv length scale steady flow turbulence wave current 1 introduction in the coastal region wave and current simultaneously co exists and form intricate flow structure in which different substantial processes with diverse temporal and spatial scales act together the sediment entrainment suspension and sea bed stability characteristics are examples of possible application that can benefit from an enhanced knowledge of the combined action between waves and steady current further the combined effects of waves and currents in free surface flows have been the subject of many studies due to their impacts on coastal hydrodynamics in this environment horizontal and vertical velocities as well as shear stresses depend strongly on the interactions of waves and currents the vertical profiles of these variables are modified and these are major issues in near shore waves and currents modelling hence a large number of studies have been devoted to the study of combined effects of waves and steady currents in free surface flows 1 1 literature review in order to study the combined effects of wave and current majority of the previous experimental for e g kemp and simons 1982 umeyama 2005 2009 singh and debnath 2016 2017 and others and numerical modelling olabarrieta et al 2010 teles et al 2013 zhang et al 2014 and others were carried out over a flat surface to understand the wave current interaction flow and turbulence characteristics generally the emphasis was given to examine the mean velocity profile and how it changed from that of the universal logarithmic law observed for steady flow along with the wave current co existing environment over a flat bed it was also reported that the changes in the different turbulence parameters such as turbulence intensity and reynolds shear stress due to the superimposition of a surface wave on the steady flow over a flat surface furthermore the mechanics of combined wave current flow have been investigated theoretically by many researchers for e g time invariant one layer turbulent eddy viscosity model developed by grant and madsen 1979 to describe combined wave and current motion myrhaug 1982 further extended the eddy viscosity model proposed by grant and madsen 1979 to developed analytical solution for the velocity profile in combined wave current flow nielsen and you 1996 used eulerian approach and suggested an eddy viscosity model by using several ad hoc assumptions to obtained fair results however huang and mei 2003 pointed out that the model proposed by nielsen and you 1996 was not entirely satisfactory with the experimental data thereafter huang and mei 2003 studied the combined effect of waves and current and computed the turbulent shear stresses by using turbulence model which give the eddy viscosity straight from the flow variable however the model proposed by huang and mei 2003 is not easy to apply as suggested by tambroni et al 2015a a simple model proposed by tambroni et al 2015a for the wave current interacting flow which agreed well with the experimental measurements of kemp and simons 1982 klopman 1994 and umeyama 2005 this new model may have a greater capability in simulating the combined wave cuurent flow tambroni et al 2015b performed a flume experiment and study the impact of macroalgal mats on the wave and current dynamics they reported that in the case of waves combined with currents over macroalgae the most significant effect of an algal mat is to damp velocity oscillations induced by waves while the friction velocity remains essentially unchanged and the roughness parameter tends to increase slightly in addition they also reported that the time averaged stream wise velocity profile is very near to that observed in the presence of a current only profile when comparatively feeble waves are superposed with a strong unidirectional current recently singh and debnath 2016 performed a flume experiment to study the effect of surface wave on unidirectional current which mainly focused on the first and second order turbulent statistics spectra analysis was also performed by the author to obtain the oscillation pattern within the flow field that may affect the turbulent properties due to combined wave current flow most of the previous studies focused on the mean velocity profile arising from wave current flow differs from that of steady flow well known logarithmic law and the superposition of waves on a current enhances the turbulent intensity but no study has been reported so far to understand the effect of the superimposed surface wave on the intermittent structure of turbulence as well as the turbulent energy flux therefore the aim of this study is to examine the turbulent energy budget in terms of turbulent energy production pressure energy diffusion turbulent energy dissipation and turbulent energy diffusion in combined wave and steady current flow furthermore the dissipation rate of turbulent fluctuations due to imposed surface wave on steady current is evaluated using taylor s frozen flow hypothesis to study the intermittent structure of the turbulence the flow structure generated by combined wave current flow is of great importance in the coastal zone for determining mass and sediment transport rates because the sediment is picked up by the waves and transported by the mean stream wise flow umeyama 2005 therefore the quantitative results from this study will be useful in model calibrations and in understanding sediment pickup grain sorting and transportation in coastal environments it is to be noted here that this paper mainly focuses on the turbulent energy budget and its distribution over a flat rigid surface with change in surface wave frequency and not specifically sediment transport hydrodynamics although the rigid bottom surface used in the present study is not the correct representation in the coastal zone this study will provide some understanding on energy distribution of the combined wave current flow over the rigid bed without any added difficulty in measurement in the combined wave current flow moreover the use of static rigid surface allows a high spatial resolution of analysis and sampling very close to the boundary which is not possible with mobile bed in the field 2 experimental setup and description experiments were performed in a laboratory flume at the fluid mechanics and hydraulic laboratory fmhl of the indian institute of engineering science and technology iiest shibpur india a specially designed flat bed open channel flume of dimensions 18 3 m long 0 90 m wide and 0 90 m deep was used for the experiments fig 1 the discharge valve was gradually opened to achieve the desired discharge in the flume and the tailgate was operated simultaneously to ensure the desired flow depth h 0 20 m the depth was maintained at a constant level during the experiment using a graduated scale attached to the side wall of the flume simultaneously uniformity was checked by vernier gauge readings of the water depth at the downstream end of the flume the water spills freely into a large sump from where it is recirculated into the flume using a vertical turbine pump located outside the main body of the flume the water flow after discharge from the pump passed through a series of wire meshes placed at the upstream end of the flume to ensure smooth and uniform flow through the experimental channel singh et al 2016 a custom designed vertically reciprocating plunger type wave maker was placed at the upstream end of the flume to produce surface waves fig 1 the wave maker was fabricated in the institute workshop two 20 cm diameter wheels were attached at the end of the spindle which was fitted with a worm gear at the middle position of the shaft and was connected with a speed reduction gear train in order to transfer the rotational motion into reciprocating motion a slider crank mechanism was used one end of the crank was linked at the 5 cm distance from the center of each pulley the connecting bar of the crank was permitted to pass through a guide in order to restrain the lateral displacement of the crank a plunger was fixed at both ends of those connecting bars fig 1 one 2 hp dc motor was used to provide the rotational motion of the gear train power supplied to the motor via a dc variac the variac was used controlled the rpm of the motor for generating the desired wave frequency the oscillation was produced at a right angle to the steady unidirectional current producing surface wave on unidirectional current description of the wave maker and its working principle are given in detail by singh et al 2018a in the present study two separate tests were carried out 1 current only flow test over the horizontal surface and 2 tests over the horizontal surface with addition of surface waves of the period t 0 5 and 1s on the current only flow different flow parameters for which the tests were conducted are as follows mean flow depth h is 20 cm the depth averaged velocity u is 15 cm s flow froude number f r u g h 0 5 is 0 085 flow reynolds number r e u h ν is 30 000 where ν is the kinematic viscosity of water g is the acceleration due to gravity further the wave height h and wave length l w were measured using a digital camera at several locations during the experiment the recorded images were analyzed to calculate the surface wave length and the wave height using the imaging technique converting pixel to the metric unit the presented surface wave describes a single basic wave with amplitude a h 2 wave number k 2 π l w and time period t having ak 1 i e wave height is small compared to wave length which quantifies that the present generated waves are regular 2d waves dean and dalrymple 2000 the experimental parameters for current only and combined wave current flow are shown in table 1 it is to be noted here that x the stream wise coordinate y the transverse coordinate z the bottom normal coordinate and u v and w are the associated velocity components respectively further u v and w denotes the time averaged velocity components and u v and w denotes the corresponding velocity fluctuations a sontek down looking 16 mhz micro acoustic doppler velocimeter micro adv was mounted on the flume to measure the fluid velocity with fluctuations at 40 hz over the flat horizontal surface for both current only and combined wave current flow the measurement was carried out at the flume centerline 11 m from the last wire mesh where the flow is verified to be fully developed flow for 5 min duration the lowest and the highest measurement point from the bed was about 0 40 cm and 14 cm respectively the time series data recorded by adv were firstly filtered by removing erroneous values in fact the data assessment consisted of i visual inspection of plotted time series ii estimation of signal to noise ratio and correlation samples using win adv software and iii velocity spectra the details of the data assessment based on all three procedures are presented in singh et al 2018a after the data assessment the time averaged velocity was computed at every sampling point by taking mean over the total acquisition time the instantaneous velocity for combined wave current flow in stream wise direction was then decomposed as follow 1 u u u u where u is the stream wise velocity fluctuation u is the stream wise time averaged velocity and u is the wave induced orbital velocity the wave imposed on steady current possesses a periodic nature and may be determined by phase averaging of the instantaneous which is detrended by the mean velocity 2 u lim n c 1 n c n 0 n c u t n t u where n is the number of wave cycle nc is the total number of wave cycles t is the wave period and denotes the phase averaging of the wave cycle 3 experimental conditions and obtained results 3 1 distribution of energy dissipation rate lohse and grossmann 1993 used the experimental data of meneveau and sreenivasan 1991 and illustrated that the intermittency level of turbulence reduces due to enhance in reynolds number this interpretation was made based on the estimates of dissipation rate as a function of time which showed that the number of intermittent dissipation peaks observed for lower flow velocity decreased when the flow velocity was increased based on the finding of lohse and grossmann 1993 the role of a surface wave on modulating the intermittent structure of the turbulence was attempted to be analyzed in this study fig 2 a i shows the time series of the normalized dissipation rate ε ε and ε ε for current only and combined wave current flow respectively at different level from the bed z h 0 02 0 3 and 0 5 the dissipation rate of turbulent fluctuations ε u t 2 was estimated by employing taylor s frozen flow hypothesis taylor 1938 and the derivative u t 2 can be interpreted as the dissipation rate per unit mass fig 2a c revealed that for current only flow the intermittency is the maximum and it decreases due to the addition of surface wave on unidirectional current further the time series of dissipation rate show a similar decrease in the intermittent structure for wave induced cases fig 2d i while a higher value of the dissipation rate shows a higher level of intermittent structure for current only flow thus it is pertinent that surface wave changes the intermittent structure probably due to the introduction of wave induced length scales to the current only flow by the intonation of the energy cascade mechanism of the background flow in addition the finer dissipative eddies are significantly enhanced by the change in time period and wave height of the surface wave 3 2 turbulent kinetic energy flux and energy budget the gradient of turbulent kinetic energy flux indicates the rate of increase or decrease of kinetic energy due to turbulent diffusion krogstad and antonia 1999 to understand these the vertical distribution of normalized kinetic energy fluxes in stream wise and bottom normal direction respectively i e f ku f k u u 3 and f kw f k w u 3 are plotted in fig 3 for both current only and combined wave current flow the stream wise and bottom normal direction flux of the turbulent energy for combined wave current flow is calculated as follows krogstad and antonia 1999 singh et al 2018b 3 f k u 0 5 u u u u w w u v v 4 f k w 0 5 w w w u u w w v v it is observed from fig 3a the stream wise kinetic energy flux f ku starts with positive value closed to bed and alters to a negative value at distance z h 0 15 from the bed however bottom normal turbulent kinetic energy flux f kw starts with a negative value close to the boundary and transforms to a positive value at a distance z h 0 15 from the bed the positive value of f ku near the boundary indicates that f ku is moved in bottom normal direction whereas the negative value of f kw near the boundary indicates that the z direction kinetic energy flux is in the downward transport as z h increases f ku showed negative value which denotes the transport of f ku in the upstream and away from the bed f kw advocate the transport of bottom normal flux of turbulent kinetic energy is in the upward direction thus near the boundary region the positive and negative values of f ku and f kw respectively suggested that the flux of turbulent kinetic energy is moved downstream with downward direction further far from the bottom boundary the negative and positive values of f ku and f kw respectively mean that the tke flux is transported upstream with upward direction however f ku and f kw flux of combined wave current flow case have nearly alike in nature than those of current only flow except larger magnitude of f ku is attained close to the bed and larger negative for the rest of the depth compared to current only flow is observed to recognize the physical processes in turbulence for combined wave current flow it is vital to balance the rate of exchange of energy of velocity and phase averaged fluctuations for current only flow and combined wave current flow respectively according to nezu and nakagawa 1993 the balance of energy terms in turbulent energy budget is consist of the turbulent energy production t p τ u z that is equal to the addition of pressure energy diffusion p d 1 ρ z p w turbulent energy dissipation ε turbulent energy diffusion t d f k w z and viscous diffusion ν d ν 2 k z 2 where k 0 5 u u w w v v is the turbulent kinetic energy and p is the pressure fluctuation previous studies nezu and nakagawa 1993 sharma and kumar 2017 proposed that the ν d term in the turbulent flow is unimportant with respect to other terms in the turbulent energy budget equation over the hydraulically rough surface the estimation of ε term is discussed in section 3 1 the purpose of pressure energy diffusion term p d negative value is to extract energy from the stress commenced from the mean flow and rehabilitate it to the other components and can be determined from unknown energy budget equation as p d t p ε t d the non dimensional parameter of turbulent kinetic energy budget t d t p p d and e d t d t p p d ε z u 3 are presented in fig 4 a d respectively for both current only and combined wave current flow cases fig 4b and d revealed that for current only flow t p and e d increase near the bed and then reduces with increase in distance from the bed and attained constant value far from the bed whereas in combined wave current flow t p first increases near the bed with higher value compared to current only flow and then decreases with increase in z h becoming negative toward the free surface the positive and negative t p indicates the exchange of turbulent kinetic energy from the mean flow to turbulence and vice versa further the negative reynolds stress acts as a negative shear in the upper portion of the flow to give negative turbulent production for combined wave current flow in addition the turbulent production is increased mainly in the near boundary with superposition of surface wave compared to current only flow indicating the increased level of turbulence production due to the surface wave usually the production term appears like a source term in favor of positive value however the negative value of production term specified the transportation of energy from the fluctuating eddy to the average flow velocity it is also observed from fig 4d that e d value is decreased when a surface wave is added to current only flow this is due to the fact that with the addition of wave extra energy is added to turbulent fluctuations as a result increase in turbulent energy becomes elevated dissipation of turbulent kinetic energy is less for combined wave current flow as compared to current only flow the turbulent diffusion is decreased near the boundary when a surface wave is added to steady flow as evident from fig 4 probably due to gain in t p and successive reduction in the t d and p d with the addition of surface wave on current only flow detert et al 2010 suggested that the near boundary mobility of sediment is generally related to an exchange of p d to a negative value due to gain in turbulence production hence in combined wave current flow a radical switch of p d to a negative value is observed representing a low pressure flow mode near the bed as a result gain in turbulence production which is responsible for pickup of sediment in the coastal zone detert et al 2010 3 3 variation of turbulent length scale in combined wave and steady flow in turbulent flow eddy size in the inertial subrange can be determined by taylor microscale as λ t 15 ν σ u 2 ε where σ u is the root mean square rms velocity component in x direction the rms velocity components in x direction direction for steady flow and combined wave and steady flow is estimated as follows umeyama 2005 singh et al 2015 5 σ u i 1 n u i u 2 6 σ u 1 n c n 0 n c 1 u i t n t u i t 2 the turbulent kinetic energy dissipation rate is calculated from the procedure discuss above see section 3 1 the normalized taylor scale λ z 0 z 0 λ t where z 0 is the roughness length scale is plotted in fig 5 against normalized vertical distance from the bed for steady flow and combined wave and steady flow in combined wave and steady flow the apparent roughness is obtained by linear extrapolation of the mean velocity profile to the zero velocity level for particular wave periods t 0 0 5 and 1 sec table 1 similar to teles et al 2013 it is revealed from fig 5 that the value of λ z 0 is decreased towards the surface which is associated with the reduced in σ u with the addition of surface wave umeyama 2005 compared to that of steady flow at close to the bed z h 0 02 the values are approximately 10 smaller with t 0 5s and about 4 smaller with t 1s as compared to that of the steady flow decrease of λ z 0 corresponds to the increased in λ t for combined flow signifies that the eddy size is enlarged or stretched near the bed this enlarged eddy may also play the vital role for the sediment mobility in wave induced flow compared to that of steady flow in order to visualise the eddy size and its turnover time due to the addition of surface wave the time scale and integral length scale were computed for the near bed velocity measured at z h 0 02 for 5 min duration this is because an integral length scale corresponds to the eddy of larger size in the turbulent flow and respective time scale shows the eddy turnover time at a specified point the transfers of tke and momentum exchange in the flow are linked with these eddies the integral time scale is expressed as follows tennekes and lumley 1972 7 e t 0 ζ r t d t where ζ denotes the time at which autocorrelation function r t almost reaches to zero tennekes and lumley 1972 r t and dt denote the autocorrelation function and the lag time respectively at first a linear interpolation scheme was adopted here in order to convert the time series data into regularly spaced events and thereafter autocorrelation was calculated further to reduce the inaccuracy in the calculation of turbulence length scales 24000 samples of instantaneous velocities were recorded in 10 min at the corresponding point for both steady flow and combined wave and steady flow experiment the value of time ζ was calculated based on r t 0 01 and dt 0 01s the value of e l and e t are shown in table 2 according to taylor 1938 the integral length scale is narrated to time scale as e l e t u where u is the mean velocity in x direction at the corresponding location it is observed from table 2 that eddy length and time scale are increased close to the bed z h 0 02 especially for t 1 s case compared to steady flow increased length scale close to the bed indicates that the elevated momentum and energy transfer as a result lower destruction of turbulent motions near the bed 4 conclusions the aim of this study is to examine the turbulent kinetic energy budget in combined wave current flow to highlight the changes in turbulent energy budget terms in combined wave current flow a comparative study was performed between the profiles of current only flow and those measured for combined wave current flow velocity data were analyzed within the framework of the phase averaging for combined wave current flow the analysis of the results shows that the finer dissipative eddies are significantly enhanced by the change in time period and wave height of the surface wave the negative reynolds stress acts as a negative shear in the upper portion of the flow to give negative turbulent production for combined wave current flow in addition the turbulent production is enhanced mostly close to the bed due to the addition of surface wave on steady current indicating the increased level of turbulence production due to the surface wave this increased level of turbulence is related with the increased turbulence intensities and increased momentum transfer further an increased length scale in the near bed region indicates that the higher momentum and energy transfer as a result lower destruction of turbulent motions near the bed pressure energy diffusion drastically changes to negative value due to addition of surface wave on steady current which indicates a low pressure flow mode near the bed present experimental results can appropriately be utilized for validation and benchmarking of numerical models of turbulent flows and then the validated and calibrated numerical models can be used to explore the flow field detail for wider ranges of parameters in the presence of surface wave over a solid boundary the result presented in this paper will also provide the causative factors for the transport of sediment in coastal zone further work is required to examine and extend the results to wider ranges of wave parameters and bed condition in the future in the coastal zone tides play an immense role on flow kinematics as the direction of current changed and become just opposite with certain interval of time however in this study such effect of tides on current was not taken into account this is because the surface wave generated in the present study is different from the tides surface waves are actually energy that moves across the surface of the water in the scientific community this is more commonly known as wind waves as these waves are generated by wind these waves occur on the free surface of oceans seas lakes rivers and canals or even on small puddles and ponds therefore in the present study we have tried to simulate this environment experimentally in laboratory flume and made an attempt to study the distribution of energy in wave current combined flow but in the coastal zone effect of tides play an immense role on flow kinematics as the direction of current changed and become just opposite with certain interval of time therefore a detailed study is required considering the effect of tides on current direction it is of interest to perform more experiments to improve our understanding on such effect of tides on current direction this will be studied in a separate paper acknowledgements the author would like to acknowledge the department of science and technology science and engineering research board government of india for financial support for this research contract no emr 2015 000266 the authors would also like to thank two anonymous reviewers for the useful comments which significantly improved the paper appendix a supplementary data the following is the supplementary data related to this article multimedia component 1 multimedia component 1 appendix a supplementary data supplementary data related to this article can be found at https doi org 10 1016 j oceaneng 2018 08 058 
23107,in this research optimization of a marine contra rotating propellers crp set is investigated using rans based cfd genetic algorithm and kriging method the cfd tool is applied for determining the hydrodynamic performance of crps the kriging algorithm is coupled with the genetic optimization tool in order for performing the optimization process in this paper the performed optimization process was an iterative one it means that the extracted geometry of the previous step is simulated using cfd tool and the results are added to the initial population used for the next optimization step in this way the added points reduce the number of simulations the obtained results presented an acceptable efficiency for the utilized algorithm as an optimization package for marine propellers keywords optimization genetic algorithm contra rotating propellers kriging method cfd 1 introduction the best performance of a marine propeller is occurred in a specific regime of flow therefore an open water standard propeller is not the best solution in all problems and the wake flow behind the body should be considered in the design process especially a radially variant wake flow schmitz et al 2002 presented a method for reducing the cost of computational fluid dynamics optimizations by using neural networks algorithm benini 2003 developed a method for optimizing b type screw propellers by coupling evolutionary algorithm and regression formula an optimum composite propeller was designed by lee and lin 2004 using genetic algorithm calcagni et al 2010 combined inviscid flow hydrodynamics modeling neural networks and genetic algorithm for preliminary designing of marine propellers zeng and kuiper 2012 presented a blade section design method by integrating the genetic algorithm with the eppler shen program surrogate methods for optimizing propellers were investigated by vesting and bensow 2014 they discussed several response surfaces to replace the main computations and concluded that kriging and ikriging methods showed good prediction capabilities mirjalili et al 2015 optimized the shape of marine propellers using multi objective particle swarm optimization mopso for the first time the considered objectives were maximizing the efficiency and minimizing cavitation gaggero et al 2016 presented a procedure for optimizing contracted and tip loaded propellers by coupling panel method boundary element method and genetic algorithm they resulted once again that bem method has some limitations in modeling the performance of propellers especially in the case of endplate contraction gaggero et al 2017 presented a procedure for designing a propeller for a high speed craft by coupling bem a viscous flow solver based on ranse approximation a parametric 3d description of the blade and a genetic algorithm they could improve the propulsive efficiency maximize the ship speed reduce the cavitation extension and increase the cavitation inception speed jiang et al 2017 presented a multi objective optimization method by coupling non dominated sorting genetic algorithm ii and fluid solid interaction fsi based on panel method and finite element method using this method they could maximize the propeller efficiency minimize the blade mass and minimize the unsteady thrust coefficient in this research optimization of a crp set was investigated numerically the objective function was to maximize the hydrodynamic efficiency and the design constraints were a keeping the total thrust constant and b keeping the difference between forward and afterward propellers torques at a minimum acceptable range note that balancing the axial torques could help the body to easily avoid rolling motion during its movement according to the literature kriging method and genetic algorithm were selected as surrogate method and optimization tool respectively the initial population for the optimization problem was gathered from several rans based cfd simulations performed on several crps in applied hydrodynamic laboratory of iran university of science and technology after each step of the optimization process the output geometry was simulated using cfd and then the obtained result was added to the initial population required for the next iteration adding new points iterate by iterate increases the convergence speed this process was repeated until the convergence reached 2 propeller theory in order to obtain the required results in the design procedure of an optimum propeller for a certain operating condition utilizing the propeller theories is inevitable these theories contain ghose 2004 1 momentum theory this theory assumes the propeller an actuator disk which increases the pressure of the passing flow this theory gives no detail about the geometry of the propeller 2 blade element theory this theory explains the effect of propellers radial sections on its performance the weakness of this theory is the incorrect result about the hydrodynamic efficiency of the propeller which is 100 percent 3 circulation theory vortex theory this theory explains the performance of propellers more satisfactory than two previous methods in this theory the thrust produced by the propeller is explained in terms of circulations around its radial sections this theory contains lifting line lifting surface and surface panel methods 4 numerical solution of navier stokes equations this method could handle the effects of viscous fluid flow over the propeller performance rans 1 1 reynolds averaged navier stokes based solvers belong to this group these solvers evaluate the performance of the propellers better than panel methods because of the ability of more precise calculation of the wake flow and turbulence effects 3 optimization most optimization problems include several targets and classified as multi objective and multi variant ones in order to solve these problems some multi objective evolutionary algorithms have been proposed since 1985 such algorithms are able to search multiple solutions in a single run zitzler and thiele 1999 genetic algorithm which is used in this study is one of the common evolutionary algorithms that uses biologic properties such as inheritance and mutation and is one of the random search based algorithms inspired from the nature genetic algorithm is a useful tool in optimization problems with linear nonlinear and multiobjective functions 4 surrogate method in this research the applied surrogate method was the kriging algorithm in the other words the kriging method was used as a tool for parabolic interpolation of existing data in order to provide a continuous search space for the genetic algorithm the general form of kriging estimator is as follows bohling 2005 1 z u m u α 1 n u λ α z u α m u α which z u is the estimator u is the location vector of the estimation point u α is the location vector of a neighboring point z u α is the value of the function at the neighboring point n u is the number of neighboring points which are used for estimation m u and m u α are the expected values means for z u and z u α and λ α is the kriging weight assigned for z u α in order to perform the estimation in location u z u is treated as a random field function which is decomposed into residual r u and trend components m u z u r u m u r u is treated as a random field with a stationary mean of 0 and a stationary and isotropic covariance function of cov r u r u h e r u r u h cr h where h is a lag the residual covariance is derived from the input semivariogram model cr h cr 0 γ h where γ is the semivariogram kriging weights λ α are derived from the input variogram the variogram of z x is obtained using the function of 2γ h variance z x h z x the variogram is a function that relates the dissimilarity between data to the distance h the goal in this problem is to find the lambda coefficient coefficients matrix of kriging so that the amount of the following variance is minimized 2 σ 2 u var z u z u which is performed by satisfying the following constraint for the expectation function 3 e z u z u 0 kriging algorithm is decomposed into simple universal and ordinary ones these different types differ each other in their treatments of the trend component m u for example simple kriging assumes that the trend component is a known component m u m in this research the simple kriging was used because of the studied literature vesting and bensow 2014 5 case study a crp contains two coaxial propellers rotating in opposite directions these systems display higher efficiencies compared to single propellers because of reducing the rotational energy of the passing flow behind the propulsion unit furthermore two counter rotating coaxial propellers could prevent the cavitation occurrence and are able to eliminate each other axial torque which could help the body to move smoothly through the water several parameters including diameter blades number pitch ratio camber ratio chord length rotational speed and etc affect the geometry of marine propellers in this research pitch and camber ratios were selected as optimization parameters according to their strong and complicated influence on the propellers performance which would change the main effective angles between the flow and blades radial sections note that other main parameters such as chord length thickness distribution rotational speed diameter and number of blades are selected according to the operational condition cavitation and structural stiffness secondary parameters such as rake and skew do not strongly affect the propellers performance and were neglected in the optimization process the initial population for the optimization process was obtained from several simulations performed over crp propulsion units in applied hydrodynamic laboratory of iran university of science and technology the initial population contained 100 different crp sets with constant geometrical parameters except for the camber and pitch ratios distributions the maximum efficiency between the selected data was about 85 percent for the initial population the applied radial distributions of pitch ratios were selected between 1 6 and 2 8 and the radial distributions of camber ratios were selected between 1 5 and 3 in this research the goal was to maximize the hydrodynamic efficiency with regard to time and cost limitations 6 computational fluid dynamics in order to solve the flow field around crps mass conservation and navier stokes equations should be solved using reynolds decomposition technique these equations are as follows 4 ρ t x i ρ u i 0 ρ u i t ρ u j x j u i p x i μ 2 u i x j 2 μ 3 x i u j x j ρ x j u i u j where u is the velocity vector p is the static pressure u and u are time averaged and fluctuating terms respectively in order to compute the reynolds stresses tensor ρ u i u j some turbulence models are required in this research the rng k ε model was used the rng k ε turbulence models governing equations are as following dong et al 2012 5 u j k x j 1 ρ x j μ μ t σ k k x j p k ε u j ε x i 1 ρ x j μ μ t σ ε ε x j c 1 ε ε k p k c 2 ε ε 2 k p k ν t u i x j u j x i u i x j μ t ρ c μ k 2 ε ρ ν t where k is the turbulent kinetic energy ε is the turbulent kinetic energy dissipation rate and p k is the turbulent kinetic energy production term in the equation 3 c μ c 1 ε c 2 ε σ k σ ε are constants and have the following default values in fluent c 1 ε 1 44 c 2 ε 1 92 c μ 0 09 σ k 1 0 σ ε 1 3 the flow filed was solved around crps numerically using the sliding mesh method the applied cfd tool is a finite volume rans based one the pressure velocity coupling method is simplec vandoormaal and raithby 1984 the pressure discretization method is presto and the discretization method applied for convective terms is quick kaya and karagoz 2008 the applied computational domain in this research contained the propulsion system and the submerged body this domain and its dimensions are shown in figs 1 and 2 in order for grid generation it was tried to use hexahedral elements in all over the domain in this way the domain was divided into several parts tetrahedral elements were generated in zones contained the propulsion unit and hexahedral elements were generated in other zones therefore a hybrid grid was generated arranging the elements near the walls was performed so that the y parameter was placed near 100 in this way the effects of the boundary layers were modeled by means of standard wall functions the generated mesh around the propulsion unit is depicted in fig 3 the applied boundary conditions were 1 velocity inlet on the left side of fig 1 2 pressure outlet on the right side of fig 1 3 velocity inlet parallel to the axis of the body on the lateral face of the cylindrical domain in fig 1 4 interface boundary condition between different zones which is depicted in fig 4 the applied time step was the required time for a movement equal to one degree for the propeller with greater rotational speed the independency of the hydrodynamic performance from the mesh sizing was studied as fig 5 in this figure the variation of the produced thrust was tracked in open water condition against the number of elements both front and rear propellers were standard b wageningen propellers with 6 blades expanded area ratio of 1 pitch ratio of 1 2 and diameter of 25 cm as observed in figure above the produced thrust varied about 0 3 when the number of elements was more than 4 5 million using a mesh size of about 0 8 percent of the propeller diameter over the wall faces the solution method was validated using a 3686f 3687a crp set operating in open water condition the selected crp set is depicted in fig 6 the results are compared with reference miller 1981 and are reported in fig 7 as observed in fig 7 the maximum computational error was about 5 percent therefore the applied computational tool was accepted as a valid tool for further computations in this research 7 optimization process the optimization process used in this research is illustrated in fig 8 as depicted in fig 8 the optimization process is started by collecting the initial data the selected parameters for participating in the crp optimization problem were radial distributions of pitch and camber ratios over forward and afterward propellers the geometry of each propeller was divided into 17 different radial sections so the geometry of each crp contained 68 different geometrical parameters which all together represent the crp set in the initial data in order to reduce the initial data b spline of degree 3 was fitted to each parameter vector therefore each crp was reduced to 16 parameters 4 4 in the initial data after fitting b splines the variogram cloud is plotted for each optimization parameter and then the kriging method is used as the surrogate tool in the last step the genetic algorithm is applied as the optimization tool which seeks in the search space produced by kriging algorithm 8 results firstly the optimization process was evaluated using single and multi variant problems after that the crp problem was solved 8 1 optimization results of a single variant problem in the first step the aforementioned optimization algorithm was evaluated using a single variant problem the goal was to optimize the efficiency of a single propeller versus pitch ratio in the open water condition the selected propeller was a 7 bladed propeller with a diameter of 40 cm the advance velocity and rotational speed were equal to 10 m sec and 1000 rpm respectively all physical and operational parameters were similar between propellers except for the pitch ratio the results are presented in fig 9 the initial data was a uniform distribution of efficiency versus pitch ratio as observed in fig 9 the mentioned algorithm was able to predict the optimum location of the pitch ratio after four iterates in this section the pitch ratio was assumed to be constant in the radial direction over each propeller 8 2 optimization results of a multi variant problem in the second step the optimization process was evaluated using a multi variant problem the optimization process of the selected propeller was performed for camber and pitch ratios the camber ratios were assumed to be radially constant in this step pitch and camber ratios were optimized at the same time the initial data was a non uniform distribution of efficiency versus camber and pitch ratios the convergence procedure is shown in fig 5 as observed in fig 10 the convergence is reached after 5 iterations this figure clarifies the movement direction of the predicted point as observed in fig 10 there were two extremums in the convergence contour and the algorithm was switching between these two zones our optimization algorithm was stopped in one of the zones because of small variations between efficiency magnitudes in fact if there is exact knowledge over all hydrodynamic parameters one could compare the results with respect to thrust efficiency cavitation noise vibration and deflection in order to select the actual optimum geometry in this section pitch and camber ratios were assumed to be constant in the radial direction over each propeller 8 3 optimization process of the crp problem after evaluating the algorithm for single and multi variant problems over a single propeller the algorithm was selected as an appropriate one for the crp set optimization problem the optimization problem was solved in the wake condition of an axisymmetric submerged body 8 3 1 objective functions the objective functions in this optimization problem are 1 maximizing the hydrodynamic efficiency f 1 e t t a or minimizing f 1 e t t a 2 minimizing the difference between forward and afterward propellers axial torques f 2 q a q f 3 minimizing the difference between the sum of forward and afterward propellers thrusts and the desired one f 3 t a t f 10000 8 3 2 fitting an appropriate model to the cloud variogram the initial data included 100 different crp sets at the first step after fitting the b splines the variogram must be plotted for the data points five different variogram clouds for efficiency forward and afterward propellers torques and thrusts should be plotted the variogram cloud for efficiency is plotted in fig 11 as shown in fig 11 there is no data in the range 4 12 which could cause some problems for the estimator model and result in estimation errors due to the non uniformly distribution of data space in the other words for the points outside the provided space incorrect estimation might be occurred and therefore the optimization process takes more iteration on the other hand according to the existence of some lags h with more than one data and some lags without data experimental variogram must be plotted in this step the distance h is divided into 67 intervals except for the range 4 12 in this way the main characteristics of the cloud variogram were kept unchanged using experimental variogram a model could be fitted to data since variogram models have to be positive definite the most famous models are exponential spherical and gaussian models in order to find the best model the error analysis must be performed for each one to find the model with the lowest amount of error three mentioned models are fitted to the experimental variogram for efficiency and the obtained results are depicted in fig 12 comparing the error in three different models the exponential model was selected due to the smaller amount of observed errors for all five different variogram clouds 8 3 3 optimization results of the crp problem after fitting an appropriate model to variogram clouds the optimization process could be started after following the procedure presented by the flowchart illustrated in fig 8 the following results were obtained and depicted in fig 13 15 note that the hydrodynamic efficiency of the crp was calculated using the following equation 6 e f f i c i e n c y t f t a v 2 π n f q f n a q a where a and f are afterward and forward propellers respectively n is the rotational speed rps of the propellers t is the thrust q is the axial torque and v is the advance velocity as shown in figs 13 15 the solution was converged after 19 iterations which indicates the success of the applied algorithm in multiple variants optimization with a large number of optimization parameters the final geometry is depicted in fig 16 and the axial velocity counter around the final geometry is depicted in fig 17 as observed above the final crp reaches 90 percent for the efficiency the research team ended the optimization process reaching this magnitude for the efficiency because of the time and cost limitations each cfd simulation took a time for about 1 weak to be converged to the solution using a computer with a core i7 3 5 ghz cpu and a 16 gb ram in this way maximizing the efficiency by about 5 percent satisfied the design criterion the research team could not be sure whether the reached point is an absolute extremum or a local one but it is obvious that the reached efficiency is a great one between the existence propulsion units anyway this issue would be surveyed in the future researches by the authors 9 conclusion in this paper a new method was developed for optimizing the single and crp marine propellers the applied surrogate method was simple kriging and the optimization tool was genetic algorithm the optimization process was so that the output of the algorithm in the previous step was evaluated using cfd tool and was added to the initial population which was used for the next step of the process this could increase the convergence speed due to the closeness of the output results to the final answer and also would increase the weights of the kriging estimator near the final answer this algorithm was able to optimize the pitch ratio of a single propeller by using a 10 membered uniform distribution of initial data after 4 iterations the next problem was to find the best pitch and camber ratios for a single propeller using a random distribution of initial data containing 8 different members the solution converged after 5 iterations the last problem was to optimize a crp set by finding the best radial distributions of pitch and camber ratios for both propellers using a random distributed initial data with 100 different members the solution converged after 19 iterates for three different objective functions the obtained results indicate the affordability of the applied algorithm in optimizing the marine propellers 
23107,in this research optimization of a marine contra rotating propellers crp set is investigated using rans based cfd genetic algorithm and kriging method the cfd tool is applied for determining the hydrodynamic performance of crps the kriging algorithm is coupled with the genetic optimization tool in order for performing the optimization process in this paper the performed optimization process was an iterative one it means that the extracted geometry of the previous step is simulated using cfd tool and the results are added to the initial population used for the next optimization step in this way the added points reduce the number of simulations the obtained results presented an acceptable efficiency for the utilized algorithm as an optimization package for marine propellers keywords optimization genetic algorithm contra rotating propellers kriging method cfd 1 introduction the best performance of a marine propeller is occurred in a specific regime of flow therefore an open water standard propeller is not the best solution in all problems and the wake flow behind the body should be considered in the design process especially a radially variant wake flow schmitz et al 2002 presented a method for reducing the cost of computational fluid dynamics optimizations by using neural networks algorithm benini 2003 developed a method for optimizing b type screw propellers by coupling evolutionary algorithm and regression formula an optimum composite propeller was designed by lee and lin 2004 using genetic algorithm calcagni et al 2010 combined inviscid flow hydrodynamics modeling neural networks and genetic algorithm for preliminary designing of marine propellers zeng and kuiper 2012 presented a blade section design method by integrating the genetic algorithm with the eppler shen program surrogate methods for optimizing propellers were investigated by vesting and bensow 2014 they discussed several response surfaces to replace the main computations and concluded that kriging and ikriging methods showed good prediction capabilities mirjalili et al 2015 optimized the shape of marine propellers using multi objective particle swarm optimization mopso for the first time the considered objectives were maximizing the efficiency and minimizing cavitation gaggero et al 2016 presented a procedure for optimizing contracted and tip loaded propellers by coupling panel method boundary element method and genetic algorithm they resulted once again that bem method has some limitations in modeling the performance of propellers especially in the case of endplate contraction gaggero et al 2017 presented a procedure for designing a propeller for a high speed craft by coupling bem a viscous flow solver based on ranse approximation a parametric 3d description of the blade and a genetic algorithm they could improve the propulsive efficiency maximize the ship speed reduce the cavitation extension and increase the cavitation inception speed jiang et al 2017 presented a multi objective optimization method by coupling non dominated sorting genetic algorithm ii and fluid solid interaction fsi based on panel method and finite element method using this method they could maximize the propeller efficiency minimize the blade mass and minimize the unsteady thrust coefficient in this research optimization of a crp set was investigated numerically the objective function was to maximize the hydrodynamic efficiency and the design constraints were a keeping the total thrust constant and b keeping the difference between forward and afterward propellers torques at a minimum acceptable range note that balancing the axial torques could help the body to easily avoid rolling motion during its movement according to the literature kriging method and genetic algorithm were selected as surrogate method and optimization tool respectively the initial population for the optimization problem was gathered from several rans based cfd simulations performed on several crps in applied hydrodynamic laboratory of iran university of science and technology after each step of the optimization process the output geometry was simulated using cfd and then the obtained result was added to the initial population required for the next iteration adding new points iterate by iterate increases the convergence speed this process was repeated until the convergence reached 2 propeller theory in order to obtain the required results in the design procedure of an optimum propeller for a certain operating condition utilizing the propeller theories is inevitable these theories contain ghose 2004 1 momentum theory this theory assumes the propeller an actuator disk which increases the pressure of the passing flow this theory gives no detail about the geometry of the propeller 2 blade element theory this theory explains the effect of propellers radial sections on its performance the weakness of this theory is the incorrect result about the hydrodynamic efficiency of the propeller which is 100 percent 3 circulation theory vortex theory this theory explains the performance of propellers more satisfactory than two previous methods in this theory the thrust produced by the propeller is explained in terms of circulations around its radial sections this theory contains lifting line lifting surface and surface panel methods 4 numerical solution of navier stokes equations this method could handle the effects of viscous fluid flow over the propeller performance rans 1 1 reynolds averaged navier stokes based solvers belong to this group these solvers evaluate the performance of the propellers better than panel methods because of the ability of more precise calculation of the wake flow and turbulence effects 3 optimization most optimization problems include several targets and classified as multi objective and multi variant ones in order to solve these problems some multi objective evolutionary algorithms have been proposed since 1985 such algorithms are able to search multiple solutions in a single run zitzler and thiele 1999 genetic algorithm which is used in this study is one of the common evolutionary algorithms that uses biologic properties such as inheritance and mutation and is one of the random search based algorithms inspired from the nature genetic algorithm is a useful tool in optimization problems with linear nonlinear and multiobjective functions 4 surrogate method in this research the applied surrogate method was the kriging algorithm in the other words the kriging method was used as a tool for parabolic interpolation of existing data in order to provide a continuous search space for the genetic algorithm the general form of kriging estimator is as follows bohling 2005 1 z u m u α 1 n u λ α z u α m u α which z u is the estimator u is the location vector of the estimation point u α is the location vector of a neighboring point z u α is the value of the function at the neighboring point n u is the number of neighboring points which are used for estimation m u and m u α are the expected values means for z u and z u α and λ α is the kriging weight assigned for z u α in order to perform the estimation in location u z u is treated as a random field function which is decomposed into residual r u and trend components m u z u r u m u r u is treated as a random field with a stationary mean of 0 and a stationary and isotropic covariance function of cov r u r u h e r u r u h cr h where h is a lag the residual covariance is derived from the input semivariogram model cr h cr 0 γ h where γ is the semivariogram kriging weights λ α are derived from the input variogram the variogram of z x is obtained using the function of 2γ h variance z x h z x the variogram is a function that relates the dissimilarity between data to the distance h the goal in this problem is to find the lambda coefficient coefficients matrix of kriging so that the amount of the following variance is minimized 2 σ 2 u var z u z u which is performed by satisfying the following constraint for the expectation function 3 e z u z u 0 kriging algorithm is decomposed into simple universal and ordinary ones these different types differ each other in their treatments of the trend component m u for example simple kriging assumes that the trend component is a known component m u m in this research the simple kriging was used because of the studied literature vesting and bensow 2014 5 case study a crp contains two coaxial propellers rotating in opposite directions these systems display higher efficiencies compared to single propellers because of reducing the rotational energy of the passing flow behind the propulsion unit furthermore two counter rotating coaxial propellers could prevent the cavitation occurrence and are able to eliminate each other axial torque which could help the body to move smoothly through the water several parameters including diameter blades number pitch ratio camber ratio chord length rotational speed and etc affect the geometry of marine propellers in this research pitch and camber ratios were selected as optimization parameters according to their strong and complicated influence on the propellers performance which would change the main effective angles between the flow and blades radial sections note that other main parameters such as chord length thickness distribution rotational speed diameter and number of blades are selected according to the operational condition cavitation and structural stiffness secondary parameters such as rake and skew do not strongly affect the propellers performance and were neglected in the optimization process the initial population for the optimization process was obtained from several simulations performed over crp propulsion units in applied hydrodynamic laboratory of iran university of science and technology the initial population contained 100 different crp sets with constant geometrical parameters except for the camber and pitch ratios distributions the maximum efficiency between the selected data was about 85 percent for the initial population the applied radial distributions of pitch ratios were selected between 1 6 and 2 8 and the radial distributions of camber ratios were selected between 1 5 and 3 in this research the goal was to maximize the hydrodynamic efficiency with regard to time and cost limitations 6 computational fluid dynamics in order to solve the flow field around crps mass conservation and navier stokes equations should be solved using reynolds decomposition technique these equations are as follows 4 ρ t x i ρ u i 0 ρ u i t ρ u j x j u i p x i μ 2 u i x j 2 μ 3 x i u j x j ρ x j u i u j where u is the velocity vector p is the static pressure u and u are time averaged and fluctuating terms respectively in order to compute the reynolds stresses tensor ρ u i u j some turbulence models are required in this research the rng k ε model was used the rng k ε turbulence models governing equations are as following dong et al 2012 5 u j k x j 1 ρ x j μ μ t σ k k x j p k ε u j ε x i 1 ρ x j μ μ t σ ε ε x j c 1 ε ε k p k c 2 ε ε 2 k p k ν t u i x j u j x i u i x j μ t ρ c μ k 2 ε ρ ν t where k is the turbulent kinetic energy ε is the turbulent kinetic energy dissipation rate and p k is the turbulent kinetic energy production term in the equation 3 c μ c 1 ε c 2 ε σ k σ ε are constants and have the following default values in fluent c 1 ε 1 44 c 2 ε 1 92 c μ 0 09 σ k 1 0 σ ε 1 3 the flow filed was solved around crps numerically using the sliding mesh method the applied cfd tool is a finite volume rans based one the pressure velocity coupling method is simplec vandoormaal and raithby 1984 the pressure discretization method is presto and the discretization method applied for convective terms is quick kaya and karagoz 2008 the applied computational domain in this research contained the propulsion system and the submerged body this domain and its dimensions are shown in figs 1 and 2 in order for grid generation it was tried to use hexahedral elements in all over the domain in this way the domain was divided into several parts tetrahedral elements were generated in zones contained the propulsion unit and hexahedral elements were generated in other zones therefore a hybrid grid was generated arranging the elements near the walls was performed so that the y parameter was placed near 100 in this way the effects of the boundary layers were modeled by means of standard wall functions the generated mesh around the propulsion unit is depicted in fig 3 the applied boundary conditions were 1 velocity inlet on the left side of fig 1 2 pressure outlet on the right side of fig 1 3 velocity inlet parallel to the axis of the body on the lateral face of the cylindrical domain in fig 1 4 interface boundary condition between different zones which is depicted in fig 4 the applied time step was the required time for a movement equal to one degree for the propeller with greater rotational speed the independency of the hydrodynamic performance from the mesh sizing was studied as fig 5 in this figure the variation of the produced thrust was tracked in open water condition against the number of elements both front and rear propellers were standard b wageningen propellers with 6 blades expanded area ratio of 1 pitch ratio of 1 2 and diameter of 25 cm as observed in figure above the produced thrust varied about 0 3 when the number of elements was more than 4 5 million using a mesh size of about 0 8 percent of the propeller diameter over the wall faces the solution method was validated using a 3686f 3687a crp set operating in open water condition the selected crp set is depicted in fig 6 the results are compared with reference miller 1981 and are reported in fig 7 as observed in fig 7 the maximum computational error was about 5 percent therefore the applied computational tool was accepted as a valid tool for further computations in this research 7 optimization process the optimization process used in this research is illustrated in fig 8 as depicted in fig 8 the optimization process is started by collecting the initial data the selected parameters for participating in the crp optimization problem were radial distributions of pitch and camber ratios over forward and afterward propellers the geometry of each propeller was divided into 17 different radial sections so the geometry of each crp contained 68 different geometrical parameters which all together represent the crp set in the initial data in order to reduce the initial data b spline of degree 3 was fitted to each parameter vector therefore each crp was reduced to 16 parameters 4 4 in the initial data after fitting b splines the variogram cloud is plotted for each optimization parameter and then the kriging method is used as the surrogate tool in the last step the genetic algorithm is applied as the optimization tool which seeks in the search space produced by kriging algorithm 8 results firstly the optimization process was evaluated using single and multi variant problems after that the crp problem was solved 8 1 optimization results of a single variant problem in the first step the aforementioned optimization algorithm was evaluated using a single variant problem the goal was to optimize the efficiency of a single propeller versus pitch ratio in the open water condition the selected propeller was a 7 bladed propeller with a diameter of 40 cm the advance velocity and rotational speed were equal to 10 m sec and 1000 rpm respectively all physical and operational parameters were similar between propellers except for the pitch ratio the results are presented in fig 9 the initial data was a uniform distribution of efficiency versus pitch ratio as observed in fig 9 the mentioned algorithm was able to predict the optimum location of the pitch ratio after four iterates in this section the pitch ratio was assumed to be constant in the radial direction over each propeller 8 2 optimization results of a multi variant problem in the second step the optimization process was evaluated using a multi variant problem the optimization process of the selected propeller was performed for camber and pitch ratios the camber ratios were assumed to be radially constant in this step pitch and camber ratios were optimized at the same time the initial data was a non uniform distribution of efficiency versus camber and pitch ratios the convergence procedure is shown in fig 5 as observed in fig 10 the convergence is reached after 5 iterations this figure clarifies the movement direction of the predicted point as observed in fig 10 there were two extremums in the convergence contour and the algorithm was switching between these two zones our optimization algorithm was stopped in one of the zones because of small variations between efficiency magnitudes in fact if there is exact knowledge over all hydrodynamic parameters one could compare the results with respect to thrust efficiency cavitation noise vibration and deflection in order to select the actual optimum geometry in this section pitch and camber ratios were assumed to be constant in the radial direction over each propeller 8 3 optimization process of the crp problem after evaluating the algorithm for single and multi variant problems over a single propeller the algorithm was selected as an appropriate one for the crp set optimization problem the optimization problem was solved in the wake condition of an axisymmetric submerged body 8 3 1 objective functions the objective functions in this optimization problem are 1 maximizing the hydrodynamic efficiency f 1 e t t a or minimizing f 1 e t t a 2 minimizing the difference between forward and afterward propellers axial torques f 2 q a q f 3 minimizing the difference between the sum of forward and afterward propellers thrusts and the desired one f 3 t a t f 10000 8 3 2 fitting an appropriate model to the cloud variogram the initial data included 100 different crp sets at the first step after fitting the b splines the variogram must be plotted for the data points five different variogram clouds for efficiency forward and afterward propellers torques and thrusts should be plotted the variogram cloud for efficiency is plotted in fig 11 as shown in fig 11 there is no data in the range 4 12 which could cause some problems for the estimator model and result in estimation errors due to the non uniformly distribution of data space in the other words for the points outside the provided space incorrect estimation might be occurred and therefore the optimization process takes more iteration on the other hand according to the existence of some lags h with more than one data and some lags without data experimental variogram must be plotted in this step the distance h is divided into 67 intervals except for the range 4 12 in this way the main characteristics of the cloud variogram were kept unchanged using experimental variogram a model could be fitted to data since variogram models have to be positive definite the most famous models are exponential spherical and gaussian models in order to find the best model the error analysis must be performed for each one to find the model with the lowest amount of error three mentioned models are fitted to the experimental variogram for efficiency and the obtained results are depicted in fig 12 comparing the error in three different models the exponential model was selected due to the smaller amount of observed errors for all five different variogram clouds 8 3 3 optimization results of the crp problem after fitting an appropriate model to variogram clouds the optimization process could be started after following the procedure presented by the flowchart illustrated in fig 8 the following results were obtained and depicted in fig 13 15 note that the hydrodynamic efficiency of the crp was calculated using the following equation 6 e f f i c i e n c y t f t a v 2 π n f q f n a q a where a and f are afterward and forward propellers respectively n is the rotational speed rps of the propellers t is the thrust q is the axial torque and v is the advance velocity as shown in figs 13 15 the solution was converged after 19 iterations which indicates the success of the applied algorithm in multiple variants optimization with a large number of optimization parameters the final geometry is depicted in fig 16 and the axial velocity counter around the final geometry is depicted in fig 17 as observed above the final crp reaches 90 percent for the efficiency the research team ended the optimization process reaching this magnitude for the efficiency because of the time and cost limitations each cfd simulation took a time for about 1 weak to be converged to the solution using a computer with a core i7 3 5 ghz cpu and a 16 gb ram in this way maximizing the efficiency by about 5 percent satisfied the design criterion the research team could not be sure whether the reached point is an absolute extremum or a local one but it is obvious that the reached efficiency is a great one between the existence propulsion units anyway this issue would be surveyed in the future researches by the authors 9 conclusion in this paper a new method was developed for optimizing the single and crp marine propellers the applied surrogate method was simple kriging and the optimization tool was genetic algorithm the optimization process was so that the output of the algorithm in the previous step was evaluated using cfd tool and was added to the initial population which was used for the next step of the process this could increase the convergence speed due to the closeness of the output results to the final answer and also would increase the weights of the kriging estimator near the final answer this algorithm was able to optimize the pitch ratio of a single propeller by using a 10 membered uniform distribution of initial data after 4 iterations the next problem was to find the best pitch and camber ratios for a single propeller using a random distribution of initial data containing 8 different members the solution converged after 5 iterations the last problem was to optimize a crp set by finding the best radial distributions of pitch and camber ratios for both propellers using a random distributed initial data with 100 different members the solution converged after 19 iterates for three different objective functions the obtained results indicate the affordability of the applied algorithm in optimizing the marine propellers 
23108,this work develops a risk based framework for a ship and structural design accounting for maintenance planning the risk analysed here covers structural failure where it is deemed as a failure when the structural capacity is less than the subjected loads reducing the stipulated margin of safety the risk in this context also includes hazards such as accidental spills loss of cargo ship and crew members during the operations stage for structural failure time profiles of performance which will incorporate structural degradation in conjunction with ship hull strength to predict the expected behaviour in terms of structural integrity is analysed the profiles are envisaged to be approximate as they are based on the limited data available during the early design stage the risk cantered maintenance methodology is applied for determining the maintenance plan of a ship hull structural system and permits the developed framework to be used in the early stage of design accounting for different hazard scenarios specific economic environment and degradation severity along the service life keywords ship structural design risk cost maintenance 1 introduction nowadays two fundamental risk assessment approaches are employed qualitative and quantitative ones guedes soares and teixeira 2001 apostolakis 2004 the qualitative risk approach identifies the risk employing a pre defined rating scale the risk is scored based on the probability or frequency of occurring a quantitative risk analysis which is a more advanced approach is employed here to develop a probabilistic analysis accounting for the existing uncertainty the approach presented here enables the risk mitigation actions in the early ship design stage accounting for the fact that the ship design and operation are predominantly governed by the ship owner s specification and applicable regulations and classification rules the owner s specification covers the ship performance and minimizes the capital capex and operational costs opex and the regulations and classification rules cover the fundamental design safety environmental and operational requirements the international maritime organization imo implemented the formal safety assessment fsa imo 2005 2006a b 2007 2008 2013 2015 to improve the maritime safety and was used to create new rules as shown in psaraftis 2012 montewka et al 2014 and designing of ships in the degradation condition in papanikolaou et al 2009 recently the formal safety assessment was employed guia et al 2016 to perform a sensitivity analysis on the hull girder safety level of a tanker ship and in garbatov and sisci 2018 for a risk based conceptual ship design of a multipurpose vessel subjected to shipbuilding constraints risen due to the limitation of sme shipyard in building new ships as it was discussed in garbatov et al 2017b atanasova et al 2018 damyanliev et al 2018 however what nowadays is observed is that in the environment of small and medium shipyards the basic planning and the initial design are done outside of the shipyards and outfitting and detailed designs are performed in the shipyards in this perspective to enhance the capacity of sme shipyard in the design process the internet environment can be used to enable remote design and information exchange between smes and design agents the implementation of the available software including in house developed one may support the development of a low budget integrated design framework for smes the objective here is to develop a framework capable to perform ship and structural design accounting for the risk based life cycle assessment and maintenance in a very early stage of ship design where limited information is available and at the same time permits to account for a specific measure related to the future maintenance and repair to be considered the study is performed in three consecutive stages related to conceptual ship design risk based structural assessment and risk based maintenance as can be seen from fig 1 the first stage addresses the risk related to the owner s specification requirements considering aspects including lightweight dead weight cargo capacity freeboard initial stability seakeeping etc due to a large number of items that need to be considered a pareto optimisation algorithm is employed to conclude on the best design choice the details about this stage were already discussed in damyanliev et al 2017 garbatov and sisci 2018 and here only a brief description will be presented based on the output from the first stage the mid ship section scantlings of an mps are determined and a risk based analysis with emphasis on the lifecycle cost and ultimate strength assessment is carried out the analysis focuses on the progressive collapse and related probability of structural failure as well as the cost of progressive collapse structural measures human life loss of cargo accidental spills where the last two are related to the environmental impact the output will be a target structural reliability to which the designed structure needs to comply in the last stage the risk based maintenance planning is performed the severity of structural degradation is defined in probabilistic terms and the different hypothesis of structural degradation consequences are studied the cost of preventive and corrective maintenance is estimated with the aim to optimise the maintenance the output is a maintenance plan that will aim to reduce the cost of the ship operation it is noted that the maintenance planning could result in a redesign of the ship structure 2 risk analysis of ship hull structural system the formal safety assessment formulation is applied here which includes five steps commonly used in a risk analysis methodology including the identification of hazard risk control options risk analysis cost benefit analysis and decision making and sensitivity analysis the risk associated with the ship in operation is estimated based on the probability of failure and the consequences of failure the scope of the present study includes only the ship hull structural system with the failure that may lead either to the loss of the ship hull structure loss of cargo loss of human life or environmental pollution therefore the failure consequence is related to the ship hull structure cargo human life loss and environmental pollution the risk is driven by the failure probabilities and their consequence and the objective is to estimate the time dependent probability of failure as a measure of the risk of a ship in operation the hazard that reduces the ship hull structural integrity is identified and the model that defines the global structural performance is based on the progressive collapse of the ship hull structure regarding the midship section of the ship hull girder the impact of corrosion degradation on the primary structural components is included in the formulations 2 1 ship hull structural system a ship hull structural system is defined as an assembly of structural components including plates stiffened panels platforms decks etc joined to satisfy a specific structural capacity and functionalities of the designed ship to define the ultimate limit state of failure failure rates and consequences information related to the ship operation maintenance and repair during the service life needs to be collected a non failure state of the ship hull structural system is defined as a state when the ship hull structural system can perform its designed functions by meeting measurable requirements defined by an acceptable reliability or risk level however the ship hull structural system may function by only satisfying partially the acceptable level which is not considered a successful performance in this work a quantitative risk based life cycle structural integrity assessment of a multipurpose ship in operation is performed the multipurpose vessel is subjected to the progressive ship hull structural collapse and corrosion degradation during the service life the structural system is defined during the conceptual ship design formulated as a compromise decision support problem with multiple goal constraints given the owner s requirements about the cargo deadweight containers speed range regulations and data on similar ships to find the main dimensions of the ship two models in the design related to the ship and voyage descriptions are involved ventura and guedes soares 2015 damyanliev et al 2017 the first model includes hull dimensions hull form generation hydrostatics freeboard hull resistance propulsion hull internal layout hull structure amidships lightship weight cargo capacity stability and capital and operational cost the voyage model includes port sequence voyage legs data port terminal data cargo handled port round trip time cost annual cargo and operational cost the design solution has to satisfy the system constraints the total cost of the ship is derived from the annual operating cost and capital cost where the first is the sum of the salary of crew members costs related to the stores and supplies insurances port expenses and annual fuel cost and the second one accounts for all expenses of building the vessel the required freight rate has been calculated by dividing the discounted annual average cost of the investment by the annual cargo capacity for the present analysis one design solution of a feeder multi purpose container vessel is considered fig 2 with main dimensions as a length overall loa 126 08 m length between the perpendiculars lpp 113 75 m moulded breadth b 20 00 m moulded depth d 10 40 m summer draft d 8 29 m deadweight dw about 9800 t speed 14 knots and block coefficient cb 0 719 the material used in constructing the hull girder is steel of nominal yield strength 235 mpa and higher tensile steel of 315 mpa 2 2 hazard identification the hazard is identified based on the ship hull structural system mode of operation event and effects causing a potential hazard with this respect the ship hull s structural system is exposed to various hazards that undermine the structural integrity during the service life the most important hazards experienced by ships operating in open sea include extreme sea wave induced load still water load continuous loading and unloading corrosion degradation progressive structural collapse and fatigue cracking other hazards result from accidental loads such as grounding collision fire or blast guedes soares and teixeira 2001 studies in the last decades show that corrosion degradation is one of the most dominant hazards experienced by the ship hull structural system corrosion degradation exists in several forms including general corrosion pitting and grooving caridis 2001 garbatov and guedes soares 2015 in the present study only general corrosion degradation and the progressive structural collapse of the ship hull structural system subjected to vertical still and wave induced bending moments are considered the corrosion degradation and progressive ship hull structural collapse are identified as initiating events of failure the risk based structural integrity assessment transforms these initiating events into a risk measure where all possible outcomes for the ship hull structural system are evaluated four types of limit states may be considered for the ship hull structural system associated with serviceability limit state ultimate limit state fatigue limit state and accidental limit state the ultimate limit state considered in the present analysis represents the collapse of the structure due to the loss of strength due to buckling and plastic collapse of structural components the safety of structures may be evaluated by comparing the ultimate strength with the applied loads 2 3 risk control options a structural design modification factor dmf is employed as a risk control option here to allow the structural design to be modified in a realistic manner and to identify the effect on the ultimate capacity of the structural system a change in the ultimate strength is most effectively achieved by modifying the deck structure consequently the chosen dmf modifies the dimensions of the stiffeners and the thicknesses of the deck while keeping the scantlings of the sides and bottom structure constant horte et al 2007 the ship hull structural ultimate capacity is evaluated with respect to progressive structural collapse the thickness of the high tensile steel structural components shown in green in fig 3 are modified in a range of δt from the original scantling the design modifications are represented by design modification factors which are defined as a relation between the modified midship sectional area and the original one the failure analysis associated with the progressive structural collapse as a part of the limit state failure of a plate and its impact on the ship hull structural system are defined as a sequence of events associated to the buckling of the plate the stiffened panels and the collapse of primary structures ending with the ship hull structural collapse the consequences of with the overall hull girder collapse are defined by possible injuries and loss of crew loss of cargo contamination with fuel and lubricating oil which is conditional to the hull structural degradation and failure of primary structural components and associated cost of inspection maintenance and repair 2 4 reliability analysis 2 4 1 time dependent profile the risk profile is defined based on the progressive collapse of the ship hull structural system subjected to corrosion degradation and vertical still water and wave induced bending moments the probability of occurrence of the failure is affected by a time dependent corrosion degradation mechanism the failure consequences are also time dependent due to the time value of money the expected future failure consequences required an appropriate treatment of the uncertainties of the design variables similar considerations are related to the time dependent value of the human life and environmental pollution the limit state is specified based on the definition of the conditions under which the ship hull structural system may not be able to fulfil its function the load carrying capacity of the ship hull structural system is evaluated either using simplified design formulations or by using more advanced nonlinear finite element analyses garbatov et al 2017a 2 4 2 load the loads are defined as full partial and ballast where the long term value of the still water and wave induced bending moments are estimated based on iacs 2015 the primary total bending moment load on the ship hull can be decomposed into two components the still water bending moment msw and the wave induced bending moment mw statistical descriptors of the still water bending moment are defined by using regression equations as a function of the length of the ship l and dead weight ratio w dwt full load as defined in guedes soares and moan 1988 as a function of the still water bending moment msw cs as given by iacs iacs 2015 see fig 4 the plus sign indicates that the bending moment is in a hogging condition the statistical descriptors of the still water bending moment in full ballast and partial loads are following the normal probability distribution nfl 160 8 mn m 54 4 mn m nbl 295 mn m 72 6 mn m and npl 244 9 mn m 69 2 mn m where the first descriptor defines the mean value and the second one the standard deviation the still water bending moment is in a hogging condition for the full ballast and partial loads the stochastic model for defining the vertical wave induced bending moment proposed in guedes soares et al 1996 is employed here the distribution of the extreme values of the wave induced bending moment at a random point of time over a specified period is assumed to follow the gumbel distribution considering that the wave induced bending moment can be represented as a stationary gaussian process short term analysis then the wave induced bending moment mw cs as given by the classification societies rules may be modelled as a weibull distribution the mean value and standard deviation of the vertical wave induced bending moment in the full ballast and partial loading conditions are defined by the gumbel distribution function as fg fl 443 73 mn m 14 84 mn m fg bl 341 19 mn m 13 15 mn m and fg pl 373 32 mn m 13 04 mn m respectively see fig 5 2 4 3 corrosion degradation the effect of corrosion on metal structures is a material thickness reduction lowering the material s mechanical properties garbatov et al 2014 and making it more vulnerable to the induced load failures in the maritime sector over the service life to corrosion and other causes were discussed in caridis 2001 very extensive corrosion depth measurement data sets of different structural components in different corrosive environments garbatov et al 2007 were analysed by the akaike s information criterion bozdogan 1987 burnham and anderson 2002 to identify which model is more likely to have generated the data and how much more likely concluding that the exponential model is more likely to have generated the data respectively in 71 of studied cases the exponential model is used in the present corrosion degradation modelling the mean value mean value dcd t and standard deviation st dev dcd t of the corrosion depth as a function of time are defined as garbatov et al 2007 1 mean value dcd t d 1 exp t τc τt t τc 2 st dev dcd t a ln t τc b c t τc where a b and c are coefficients the analysed ship hull structural system is assumed to be subjected to general corrosion degradation where the coating life τc 5 years and transition life τt 7 for all structural components and the long term corrosion thickness of any individual structural component are defined based on the corrosion margins as defined by the classification society rules bv 2016 and implemented in the bv software mars 2000 2011 the effect of the spatial distribution of the corrosion degradation garbatov and guedes soares 2017 and material changes due to degradation garbatov et al 2014 2016 are not considered in the present study 2 4 4 progressive collapse assessing the ship hull structural risk of an ageing multipurpose ship requires the development of an ultimate limit state function with a reference to the progressive ship hull structural collapse of the primary ship hull structure where the reference is made to the midship section the ship hull is considered to behave globally as a beam under transverse load subjected to still water and wave induced effects the midship section scantling and the ultimate capacity is estimated using the progressive collapse method as stipulated by the classification society rules the 5 confidence level value of the ultimate bending moment mu 5 mu c is assumed as a characteristic one which respects the value estimated by mars 2000 2011 software and additionally it is assumed that cov equals to 0 08 and it is fitted to the lognormal probability density function fln mu with a mean value μmu and standard deviation σmu as garbatov and guedes soares 2016 3 fln mu 1 mu σmu 2π exp ln mu μmu 2σmu 2 4 σmu logn cov2 1 5 μmu fln 1 0 05 μmu σmu mu 5 where fln 1 is the inverted log normal cumulative distribution function the probability density function of the ultimate bending moments in the hogging loading condition for both gross mu gross and net mu net ship hull scantling for each dmf are presented in fig 6 2 4 5 reliability estimate the reliability of a ship hull structural system can be defined as the likelihood of maintaining its ability to fulfil the design purpose for some period the objective is to estimate the reliability based on its ultimate strength when extreme loads act upon the ship hull structure subjected to corrosion degradation the probability of ship hull structural collapse is estimated here by using the first order reliability method form and formally is defined as 6 pf x p g x 0 g x 0fx x dx where fx x is the joint probability density function of the n basic stochastic variables and pf x denotes the probability of failure the n dimensional integral is defined over the failure region the form methods provide a way of evaluating the probability of ship hull structural failure efficiently with a reasonably good accuracy which is adequate for practical applications hasofer and lind 1974 rackwitz and fiessler 1978 ditlevsen 1979 the limit state function is defined as 7 g x t xu mu xsw msw xw xs mw where mu is the ultimate capacity with a model uncertainty factor xu which is assumed to be described by a normal probability density function nxu 1 05 0 1 mw is the vertical wave induced bending moment the model uncertainty factor xw accounts for the uncertainties in the linear response calculation nxw 1 0 1 and xs for the non linear effects nxs 1 0 1 msw is the still water bending moment with a model uncertainty factor xsw nxsw 1 0 1 silva et al 2014 the reliability index for the gross and net designs can be related assuming that the gross ship hull structural design respects the non corroded ship hull structure up to the moment when the corrosion protection fails and the net design respects the end of the service life when the structure is already corroded and no maintenance actions took place the service life of the ship hull structural system is considered as τs 25 years the coating life the corrosion degradation is assumed as a non linear time dependent process following the time dependent non linear corrosion degradation model as developed in guedes soares and garbatov 1999 and the time variant reliability index where t 0 τs is defined as 8 β t βgross βgross βnet 1 exp t τc ship τt ship t τc 9 β t βgross t τc then the time variant probability of failure pf t may be estimated and it is presented as a function of time conditional to dmfs in fig 7 2 5 risk assessment the risk analysis accounts for the uncertainties associated with the progressive collapse of the ship hull system subjected to corrosion degradation and it is defined as the potential for losses resulting from the structural failure the risk is based on an identified failure scenario considered here as a progressive collapse of a ship hull the risk is measured as a pair of the probability of occurrence of the progressive collapse and the consequences associated with that the risk is evaluated as a product of the likelihood of the occurrence and the impact of an accident that may happen during a period of time which is assumed as the service life of the ship τs 10 risk consequence τs likelihood event τs impact consequence event the likelihood can be expressed as a probability of failure which is described as a numeric value and the consequences are presented in a monetary value 11 risk t σjpf j p g x 1 j t 0 cf j x 2 j t where pf j p g x 1 j t 0 is the probability of failure cf j x 2 t is the impact the consequence cost of failure x 1 and x 2 are the vectors of parameters involved in the probability of failure and consequence analyses and t 0 τs the probability of failure is derived based on the assumed limit state employing the form associated with the progressive collapse of the ship hull structural system subjected to corrosion degradation the consequence costs included in the present risk analysis cover the design structural measures loss of cargo loss of the ship accidental spill and loss of human life the ship s optimal safety level is assessed by performing a cost benefit analysis where the objective is to establish an optimal safety and reliability level by using the risk control option in redesigning the initial midship section scantlings the cost benefit analysis of the ship structural system is performed based on the total expected risk risktotal tn dmf β which is a product of the probability of failure and consequence cost defined as 12 risktotal tn dmf β riskpf tn dmf β riskme dmf β where riskpf tn dmf β is the risk associated with the ship structural failure and its consequence costs and riskme dmf β is the cost of the implemented ship structural safety measures which is used here as a risk estimate of the structural safety measure both terms of eqn 28 are defined as a function of the reliability index β as this in return influences the estimate of the safety target beta reliability level βt at this stage a decision can be made in defining the part of the entire cost associated with the loss of the ship cargo accidental spill and human life related to the minimization of on the total expected risk riskpf tn dmf β the multiple cost function is transformed into one where the converted single cost cw x is defined as 13 cw x σfici x where x is the vector of the cost descriptors and fi is the partial factor the partial factors are defined based on the subjective preferences of the decision maker the risk associated with the ship hull structural collapse is estimated over the service life of the ship accounting for the probability of failure and the discount rate of γ as a function of dmf β and time as 14 cpf tn dmf β σj n pf tj dmf β f1 cs tj dmf β f2 cc f3 cd f4 cv e γtj where pf tj dmf β is the probability of failure cs tj dmf β is the cost of the ship in the year tj cc is the cost associated with the loss of cargo cd is the cost of the accidental spill cv is the cost associated with the loss of human life the cost of the ship at any time tj is a function of the initial cost of the ship at to 0 and the scraping cost at tn τs th year accounting for corrosion degradation estimated as 15 cs tj dmf β cs to dmf β cs to dmf β cs tn dmf β 1 exp tj τc ship τt ship tj τc 16 cs tj dmf β cs to dmf β t τc where cs to dmf β is the initial cost of the ship cs tn dmf β is the scrapping value of the ship and tj is the year of the operation tj 0 τs the resale or scrap value of the ship at tj tn is estimated as 17 cn tn dmf β lw tn dmf β c scrap where lw tn dmf β is the lightweight of the ship accounting for a design modification and corrosion degradation and cscrap is the resale or scrap value the cost of implementing a safety measure accounts for the redesign of the ship hull structure including the cost of material and labour depending on the level of the design modification dmf the cost of the structural redesign cme dmf β may result in a positive or negative value respectively 18 cme dmf β δwsteel dmf β csteel clabor dmf β where δwsteel dmf β dmf 1 wsteel is the weight of steel because of the design modifications tons dmf is the design modification factor ratio which is also associated with the reliability level β wsteel is the weight of the steel related to the ship hull structural design tons csteel is the cost of steel and clabor is the labour cost of the constructing a δwsteel dmf β ton structure the cost associated with the loss of cargo cc is estimated by considering that a part of the total amount of cargo of the ship pcargo is lost in the case of ship hull structural failure defined as 19 cc ccargo fcargo pcargo where c cargo is the cost of a ton of cargo and fcargo is the assumed partial factor of the cargo lost in the case of structural failure in the case of ship hull structural failure a part of the total amount of oil and fuel may be spilt fspill is the considered partial factor of spill ps p is the probability that the oil and fuel reach the shoreline sørgard et al 1999 in the case of an accidental oil spill the weight of spill that needs to be cleaned up is defined as fspill psl woil and fuel and the cost cd associated with that is 20 cd fspill psl cats woil and fuel where cats is the cost of one ton accidentally spilt oil and fuel that needs to be cleaned the implied cost of averting the fatality icaf used in the risk model is obtained from the average of ocde countries ocde 2014 the loss of human life is accounted for by including the icaf as used in a study performed in horte et al 2007 21 cv ncrew fcrew icaf where ncrew is the number of crew members fcrew is the probability of loss of the life of a crew member 2 6 benefit decision making the risk management of ship hull structural system requires the optimisation of the available capacity in supporting the design functionality of the ship subjected to corrosion degradation it also requires a definition of the acceptable risk level and alternative options for decision making the objective is to reduce the risk to an acceptable level the risk of ship hull structural collapse and design structural safety measure is estimated as a function of the structural dmf the target risk or reliability levels are used for developing design procedures for ship structures the selected reliability level determines the probability of failure of ship hull structural system and the cost consequences of that three methods are normally used to select the target reliability level 1 agreeing upon a reasonable level in the case of a novel structural system without prior history 2 calibrating the beta reliability level implied in currently successfully used design codes 3 choosing the target reliability level that minimizes a total consequence cost over the service life of the structural system in the case of design in which the failure results in economic losses and consequences the range of target beta reliability index βt at the tn τs th year of the service life of the ship hull structural system may vary between 1 5 and 5 the target beta reliability index is estimated by minimizing the total risk associated with the probability of failure and consequence cost defined as a function of the beta reliability index the optimum target reliability index is shown in fig 8 where βt 4 296 corresponding to the minimum of the curve of the total risk risktotal tn dmf β the impact of structural degradation with age namely corrosion degradation is reflected by increasing the probability of failure as a function of time a sensitivity analysis using a risk based framework for the conceptual ship design of a multi purpose vessel evaluating the impact of three types of design modification factors related to ship design structural scantling and cost descriptors garbatov and sisci 2018 demonstrated that the structural redesign the length and the block coefficient of the ship have the most significative impact on the reliability and structural collapse consequence cost partial safety factors can be used in the preliminary ship design conditioned by the imposed target reliability index which represents an acceptable risk level and minimum cost garbatov and sisci 2018 the time dependent reliability and risk may be a base to set up a maintenance and inspection plan conditional on the acceptable reliability and risk levels garbatov and guedes soares 1998 2 7 risk centred maintenance planning of ship hull structural maintenance in the past has been done based on structural reliability approaches guedes soares and garbatov 1998 involving models that represent the time deterioration as proposed in garbatov et al 2007 it is evident that operations and maintenance represent a high cost item in ship hull structural system during the service life the approach employed here uses a probabilistic model of time to fail which is used as a basis for maintenance decisions the failure of the ship hull structural system is defined by the weibull probabilistic model which represents the failure rates in operation as described in moubray 1997 rausand 1998 the analysis is used to address important issues of the condition based maintenance action and structural repair this approach covers the analysis of the severity of structural degradation the costs of preventive and corrective maintenance optimal replacement interval optimal replacement age as has been reported in garbatov and guedes soares 2001 2009 2 7 1 degradation tolerance the acceptable risk levels depend on different factors as reported in moan 1998 and the failure cause and mode may result in redundant structures in pf l 4 17 10 5 βl 3 93 for a low degradation tolerance pf m 1 02 10 4 βm 3 71 for a moderate degradation tolerance pf h 1 92 10 4 βh 3 55 for a high degradation tolerance and pf e 3 14 10 4 βe 3 42 for an extreme degradation tolerance see fig 9 using these acceptable beta reliability levels the analysed ship hull structural system subjected to buckling and corrosion degradation has a mean time of failure mttfi of 8 12 16 and 20 years the probability of failure of ship hull structural system is modelled by a weibull probability function where the three parameter weibull distribution is defined by the shape parameter βw location parameter γw and scale parameter ηw where βw and ηw are greater than 0 the reliability estimates for the different levels of degradation tolerance levels defined here as low moderate high and extreme degradation tolerance is given in fig 10 where βlow 2 16 ηlow 6 21 years γlow 5 years βmoderate 2 16 ηmoderate 7 9 years γmoderate 5years βhigh 2 16 ηhigh 11 29 years γhigh 5years βextreme 2 16 ηextreme 20 33 years γextreme 5years in the case of dmf 1 see fig 10 2 7 2 cost of maintenance a major part of the operating expenditures are the maintenance costs during the vessel s lifecycle in general this cost contributes to 25 35 of the total operating expenditures opex turan et al 2009 it depends on many factors including the quality of the work delivered by the shipyard the geographical location of the vessel its access to periodic maintenance operational profile etc it is important to create a procedure for analysing the potential failure by classifying the severity of the effect of failures on the structure which is widely used in many industries during various phases of the service life dod 1984 kececioglu 1991 langford 1995 a failure mode may be defined as how failure is observed and it generally describes how the failure occurs tools used in the design stage for identifying failures and determining their consequences are risk priority numbers occurrence severity matrix risk ranking tables and criticality analysis for the current work these methods are adapted to identify the age of the structure of the first repair and the interval of preventive repairs the input is the cost of a preventive repair cp and the cost of a repair after failure cf which are assumed here for four hypothetical levels low moderate high and extreme repair consequences as an example as can be seen in fig 11 2 7 3 repair interval ship hull structural systems are subjected to corrosion degradation and buckling and when a failure occurs the structural system needs to be repaired since the failure is not expected then it may be assumed that the failure repair is costlier than the one in an earlier repair to reduce the failure consequences repair can be scheduled to occur at specified intervals however a balance is required between the amount spent on the repair and their resulting benefits the repair policy is such so that preventive repair occurs at fixed intervals of time and repair due failure occurs whenever is necessary the objective is to determine an optimal interval between the preventive repairs and to minimize the total expected cost of repairing the ship hull structural system per unit time the total cost of a repair before failure is defined as cp while cfi is the total cost of repair due to failure and f t is the probability density function of the ship hull structural system failure as a function of time the repair policy is to perform the repair at constant intervals of time tp years irrespective of the age of the ship hull structural system and repair due to failure as many times as required in the interval t 0 tp to determine the optimal interval between the preventive repair the total expected repair cost per unit time is minimized the total expected cost per unit time for the preventive repair at the intervals of a length tp years denoted cri tp equals the total expected cost in the interval 0 tp divided by the length of the time interval tp garbatov and guedes soares 2009 22 c tp cp cfh tp tp where h tp is the expected number of failures in the interval t 0 tp to determine h tp the renewal theory approach is to be applied the optimal preventive repair intervals are defined as the minimum of c tp as shown in fig 12 2 7 4 repair age this problem is similar to the one presented before except that instead of making the repair at fixed intervals with the possibility of performing a repair shortly after the repair due to failure the time at which the repair occurs depends on the age of the structure when a failure occurs repair is made when this happens the clock time is reset to zero and the next repair occurs only when the structure has been in use for a specified period the problem is to balance the cost of the repair against the benefits and this is done by determining the optimal repair age to minimize the total expected cost due to repair per unit time the repair policy is to perform a preventive repair when the structure has reached a specified age tp and repair due to failure when necessary the objective is to determine the optimal repair age tp to minimize the total expected repair cost per unit time there are two possible cycles of operation one cycle being determined by the ship hull structural system reaching its planned repair age tp and other being determined by the ship hull structural system ceasing to operate due to a failure occurring before the planned time for repair the total expected cost of repair per unit time is defined as c tp garbatov and guedes soares 2009 the total expected repair cost per cycle equals the cost of a cycle before failure cp times the probability of a cycle r tp plus the cost of a failure cycle cf times the probability of failure cycle 1 r tp divided to the expected length of the cycle tp the mean time to failure is defined as m t tf t 1 r tp dt and therefore the total cost results in 23 c tp cpr tp cf 1 r tp tp r tp t f t dt where r t 1 f t f t is the cumulative distribution function of the ship hull structural system failure the optimal preventive repair age is defined as tp tp cmin γ and the expected cost of repair per unit time as a function of tp is shown in fig 13 and the positioning factor which is associated with the coating life is assumed here as γ 5years in some cases due to difficulties in financing or the desire to get maximum throughput or utilization of ship hull structural system the repair policy applied may be one that minimizes the total downtime per unit time or equivalently maximizes availability garbatov and guedes soares 2009 3 maintenance decision the decision making is performed defining cij x related to the cost associated with the low moderate high and extreme degradation tolerances conditional to the level of repair consequences the weight sum method converts the multiple degradation tolerances into a single cost function for any repair consequence level cw j defined as 24 cw j x σiwijcij x where x is the vector of the repair cost descriptors and wij are the weighting factors σiwij 1 and wij 0 1 the weighting factors may be defined based on the subjective preferences of the decision maker and here they are assumed to be estimated as wij mttfi mttfi 1 σmttfi where mttfi represents the mean time to failure in the case of the low moderate high and extreme degradation tolerance respectively the goal is to define the optimal ship hull structural system age for repair tp see fig 14 left and preventive repair interval tp see fig 14 right by minimizing the converted repair cost of the ship hull structural system conditional of the repair consequence level the preventive repair age and repair interval for the studied repair consequence levels are presented in table 1 the minimal repair can be performed as a minor maintenance that returns the structural system to the same structural capacity state that it was just before the minor maintenance the general repair improves the structural system state and the renewal repair completely returns the structural system to the statistically as good as new condition the concept of virtual age is introduced to model the structural system maintenance the real age run time of the structural system is presented on the vertical axis and the virtual age is on the horizontal axis in fig 15 at the first repair when the structural system age is 16 years in the case of a low repair consequence the structural system becomes of age 14 years after the maintenance action once the structural system has operated for a further period of 11 years to bring its running age for 14 11 years another maintenance action occurs that brings the structural system in a virtual age to 25 years etc the acceptable operational regime and the boundary of the preventive repair for different levels of deterioration tolerance are also shown in fig 15 the issue addressed here is to be taken into consideration when there is a need for a maintenance intervention and to define what kind of repair action should be taken minimal repair general repair or complete renewal to address this issue the repair limit concept through the cost is employed if the cost estimate of the preventive maintenance is between zero and the limit of 10 of the residual cost of steel structural system then a minimal repair is made if the cost is between 10 and the cost boundary then a general repair is made the boundary cost is assumed to be the cost of the residual steel structural system at the moment of the maintenance action see fig 16 right the cost associated with the first maintenance intervention at the 14th year is more than 10 of the resale or scrap value in the case of a low repair consequence so a general repair instead of a minimal repair should be made and consequently the structural system capacity is improved when compared to its condition prior to repair commencing the cost associated with the planned preventive maintenance actions are shown in fig 16 left and how the residual scrapping cost of steel structural system is distributed during the service time accounting for the maintenance planning is given in fig 16 right it can be seen from fig 16 that the repair cost keeping the capacity of the structural system on the same level in the case of lower repair consequence is invested later and with less frequency than the other repair consequence levels in the case of the lower repair consequence the scrapping cost will be less at the end of service life which can be explained by the less resting weight of steel the output of this analysis provides information that can be used by the designer for decision making leading to redesign of the initial solution in optimizing the repair cost needed to be invested during the service life of the ship it has to be pointed out that the present analysis is performed based on the assumption that the structural steel system ship hull will start the service life in the condition of the gross design and will arrive to the end of the service life at the net design where the structural components will be degraded according to the corrosion adds as prescribed by csr and the coating life is assumed to be 5 years and the transition life of 7 years however a much more severe corrosion environment may be seen during the service life and the developed risk based framework of the ship and structural design is capable to account for it 4 conclusions this work developed a risk based framework for the ship and structural design to be used in the conceptual ship design stage accounting for maintenance planning where different approaches are being applied to address the early design stage of ship and ship structures risk covered here is associated with the ship hull structural failure accidental spills loss of cargo loss of ship and crew members during the service life the structural failure accounted for structural corrosion degradation in a conjunction with the ship hull strength some of the employed methods are envisaged to be approximate as they are based on the limited data available during the early design stage the risk cantered maintenance methodology was applied in determining the maintenance planning of a ship hull structural system in its operating context for four hypothetical repair consequences the concept of the virtual age was introduced to model the ship hull structural system maintenance where the boundary of the preventive repair on different deterioration tolerance levels is established the boundary cost of performing a general repair or renewable repair is established based on the resale or scrap value of steel structural system the developed risk based framework for the ship and ship structural design is capable to analyse different types of ships operating in different environmental conditions the present risk based framework is developed to be used in the early stage of ship design where limited data is available and at the same time permits to project a specific maintenance planning allowing a measure related to the future maintenance and repair to be considered making the design solution more economical leading to a less operational cost and satisfying the existing requirements for a safety transportation acknowledgement this paper reports a work developed in the project ship lifecycle software solutions shiplys which was partially financed by the european union through the contract no 690770 shiplys h2020 mg 2014 2015 
23108,this work develops a risk based framework for a ship and structural design accounting for maintenance planning the risk analysed here covers structural failure where it is deemed as a failure when the structural capacity is less than the subjected loads reducing the stipulated margin of safety the risk in this context also includes hazards such as accidental spills loss of cargo ship and crew members during the operations stage for structural failure time profiles of performance which will incorporate structural degradation in conjunction with ship hull strength to predict the expected behaviour in terms of structural integrity is analysed the profiles are envisaged to be approximate as they are based on the limited data available during the early design stage the risk cantered maintenance methodology is applied for determining the maintenance plan of a ship hull structural system and permits the developed framework to be used in the early stage of design accounting for different hazard scenarios specific economic environment and degradation severity along the service life keywords ship structural design risk cost maintenance 1 introduction nowadays two fundamental risk assessment approaches are employed qualitative and quantitative ones guedes soares and teixeira 2001 apostolakis 2004 the qualitative risk approach identifies the risk employing a pre defined rating scale the risk is scored based on the probability or frequency of occurring a quantitative risk analysis which is a more advanced approach is employed here to develop a probabilistic analysis accounting for the existing uncertainty the approach presented here enables the risk mitigation actions in the early ship design stage accounting for the fact that the ship design and operation are predominantly governed by the ship owner s specification and applicable regulations and classification rules the owner s specification covers the ship performance and minimizes the capital capex and operational costs opex and the regulations and classification rules cover the fundamental design safety environmental and operational requirements the international maritime organization imo implemented the formal safety assessment fsa imo 2005 2006a b 2007 2008 2013 2015 to improve the maritime safety and was used to create new rules as shown in psaraftis 2012 montewka et al 2014 and designing of ships in the degradation condition in papanikolaou et al 2009 recently the formal safety assessment was employed guia et al 2016 to perform a sensitivity analysis on the hull girder safety level of a tanker ship and in garbatov and sisci 2018 for a risk based conceptual ship design of a multipurpose vessel subjected to shipbuilding constraints risen due to the limitation of sme shipyard in building new ships as it was discussed in garbatov et al 2017b atanasova et al 2018 damyanliev et al 2018 however what nowadays is observed is that in the environment of small and medium shipyards the basic planning and the initial design are done outside of the shipyards and outfitting and detailed designs are performed in the shipyards in this perspective to enhance the capacity of sme shipyard in the design process the internet environment can be used to enable remote design and information exchange between smes and design agents the implementation of the available software including in house developed one may support the development of a low budget integrated design framework for smes the objective here is to develop a framework capable to perform ship and structural design accounting for the risk based life cycle assessment and maintenance in a very early stage of ship design where limited information is available and at the same time permits to account for a specific measure related to the future maintenance and repair to be considered the study is performed in three consecutive stages related to conceptual ship design risk based structural assessment and risk based maintenance as can be seen from fig 1 the first stage addresses the risk related to the owner s specification requirements considering aspects including lightweight dead weight cargo capacity freeboard initial stability seakeeping etc due to a large number of items that need to be considered a pareto optimisation algorithm is employed to conclude on the best design choice the details about this stage were already discussed in damyanliev et al 2017 garbatov and sisci 2018 and here only a brief description will be presented based on the output from the first stage the mid ship section scantlings of an mps are determined and a risk based analysis with emphasis on the lifecycle cost and ultimate strength assessment is carried out the analysis focuses on the progressive collapse and related probability of structural failure as well as the cost of progressive collapse structural measures human life loss of cargo accidental spills where the last two are related to the environmental impact the output will be a target structural reliability to which the designed structure needs to comply in the last stage the risk based maintenance planning is performed the severity of structural degradation is defined in probabilistic terms and the different hypothesis of structural degradation consequences are studied the cost of preventive and corrective maintenance is estimated with the aim to optimise the maintenance the output is a maintenance plan that will aim to reduce the cost of the ship operation it is noted that the maintenance planning could result in a redesign of the ship structure 2 risk analysis of ship hull structural system the formal safety assessment formulation is applied here which includes five steps commonly used in a risk analysis methodology including the identification of hazard risk control options risk analysis cost benefit analysis and decision making and sensitivity analysis the risk associated with the ship in operation is estimated based on the probability of failure and the consequences of failure the scope of the present study includes only the ship hull structural system with the failure that may lead either to the loss of the ship hull structure loss of cargo loss of human life or environmental pollution therefore the failure consequence is related to the ship hull structure cargo human life loss and environmental pollution the risk is driven by the failure probabilities and their consequence and the objective is to estimate the time dependent probability of failure as a measure of the risk of a ship in operation the hazard that reduces the ship hull structural integrity is identified and the model that defines the global structural performance is based on the progressive collapse of the ship hull structure regarding the midship section of the ship hull girder the impact of corrosion degradation on the primary structural components is included in the formulations 2 1 ship hull structural system a ship hull structural system is defined as an assembly of structural components including plates stiffened panels platforms decks etc joined to satisfy a specific structural capacity and functionalities of the designed ship to define the ultimate limit state of failure failure rates and consequences information related to the ship operation maintenance and repair during the service life needs to be collected a non failure state of the ship hull structural system is defined as a state when the ship hull structural system can perform its designed functions by meeting measurable requirements defined by an acceptable reliability or risk level however the ship hull structural system may function by only satisfying partially the acceptable level which is not considered a successful performance in this work a quantitative risk based life cycle structural integrity assessment of a multipurpose ship in operation is performed the multipurpose vessel is subjected to the progressive ship hull structural collapse and corrosion degradation during the service life the structural system is defined during the conceptual ship design formulated as a compromise decision support problem with multiple goal constraints given the owner s requirements about the cargo deadweight containers speed range regulations and data on similar ships to find the main dimensions of the ship two models in the design related to the ship and voyage descriptions are involved ventura and guedes soares 2015 damyanliev et al 2017 the first model includes hull dimensions hull form generation hydrostatics freeboard hull resistance propulsion hull internal layout hull structure amidships lightship weight cargo capacity stability and capital and operational cost the voyage model includes port sequence voyage legs data port terminal data cargo handled port round trip time cost annual cargo and operational cost the design solution has to satisfy the system constraints the total cost of the ship is derived from the annual operating cost and capital cost where the first is the sum of the salary of crew members costs related to the stores and supplies insurances port expenses and annual fuel cost and the second one accounts for all expenses of building the vessel the required freight rate has been calculated by dividing the discounted annual average cost of the investment by the annual cargo capacity for the present analysis one design solution of a feeder multi purpose container vessel is considered fig 2 with main dimensions as a length overall loa 126 08 m length between the perpendiculars lpp 113 75 m moulded breadth b 20 00 m moulded depth d 10 40 m summer draft d 8 29 m deadweight dw about 9800 t speed 14 knots and block coefficient cb 0 719 the material used in constructing the hull girder is steel of nominal yield strength 235 mpa and higher tensile steel of 315 mpa 2 2 hazard identification the hazard is identified based on the ship hull structural system mode of operation event and effects causing a potential hazard with this respect the ship hull s structural system is exposed to various hazards that undermine the structural integrity during the service life the most important hazards experienced by ships operating in open sea include extreme sea wave induced load still water load continuous loading and unloading corrosion degradation progressive structural collapse and fatigue cracking other hazards result from accidental loads such as grounding collision fire or blast guedes soares and teixeira 2001 studies in the last decades show that corrosion degradation is one of the most dominant hazards experienced by the ship hull structural system corrosion degradation exists in several forms including general corrosion pitting and grooving caridis 2001 garbatov and guedes soares 2015 in the present study only general corrosion degradation and the progressive structural collapse of the ship hull structural system subjected to vertical still and wave induced bending moments are considered the corrosion degradation and progressive ship hull structural collapse are identified as initiating events of failure the risk based structural integrity assessment transforms these initiating events into a risk measure where all possible outcomes for the ship hull structural system are evaluated four types of limit states may be considered for the ship hull structural system associated with serviceability limit state ultimate limit state fatigue limit state and accidental limit state the ultimate limit state considered in the present analysis represents the collapse of the structure due to the loss of strength due to buckling and plastic collapse of structural components the safety of structures may be evaluated by comparing the ultimate strength with the applied loads 2 3 risk control options a structural design modification factor dmf is employed as a risk control option here to allow the structural design to be modified in a realistic manner and to identify the effect on the ultimate capacity of the structural system a change in the ultimate strength is most effectively achieved by modifying the deck structure consequently the chosen dmf modifies the dimensions of the stiffeners and the thicknesses of the deck while keeping the scantlings of the sides and bottom structure constant horte et al 2007 the ship hull structural ultimate capacity is evaluated with respect to progressive structural collapse the thickness of the high tensile steel structural components shown in green in fig 3 are modified in a range of δt from the original scantling the design modifications are represented by design modification factors which are defined as a relation between the modified midship sectional area and the original one the failure analysis associated with the progressive structural collapse as a part of the limit state failure of a plate and its impact on the ship hull structural system are defined as a sequence of events associated to the buckling of the plate the stiffened panels and the collapse of primary structures ending with the ship hull structural collapse the consequences of with the overall hull girder collapse are defined by possible injuries and loss of crew loss of cargo contamination with fuel and lubricating oil which is conditional to the hull structural degradation and failure of primary structural components and associated cost of inspection maintenance and repair 2 4 reliability analysis 2 4 1 time dependent profile the risk profile is defined based on the progressive collapse of the ship hull structural system subjected to corrosion degradation and vertical still water and wave induced bending moments the probability of occurrence of the failure is affected by a time dependent corrosion degradation mechanism the failure consequences are also time dependent due to the time value of money the expected future failure consequences required an appropriate treatment of the uncertainties of the design variables similar considerations are related to the time dependent value of the human life and environmental pollution the limit state is specified based on the definition of the conditions under which the ship hull structural system may not be able to fulfil its function the load carrying capacity of the ship hull structural system is evaluated either using simplified design formulations or by using more advanced nonlinear finite element analyses garbatov et al 2017a 2 4 2 load the loads are defined as full partial and ballast where the long term value of the still water and wave induced bending moments are estimated based on iacs 2015 the primary total bending moment load on the ship hull can be decomposed into two components the still water bending moment msw and the wave induced bending moment mw statistical descriptors of the still water bending moment are defined by using regression equations as a function of the length of the ship l and dead weight ratio w dwt full load as defined in guedes soares and moan 1988 as a function of the still water bending moment msw cs as given by iacs iacs 2015 see fig 4 the plus sign indicates that the bending moment is in a hogging condition the statistical descriptors of the still water bending moment in full ballast and partial loads are following the normal probability distribution nfl 160 8 mn m 54 4 mn m nbl 295 mn m 72 6 mn m and npl 244 9 mn m 69 2 mn m where the first descriptor defines the mean value and the second one the standard deviation the still water bending moment is in a hogging condition for the full ballast and partial loads the stochastic model for defining the vertical wave induced bending moment proposed in guedes soares et al 1996 is employed here the distribution of the extreme values of the wave induced bending moment at a random point of time over a specified period is assumed to follow the gumbel distribution considering that the wave induced bending moment can be represented as a stationary gaussian process short term analysis then the wave induced bending moment mw cs as given by the classification societies rules may be modelled as a weibull distribution the mean value and standard deviation of the vertical wave induced bending moment in the full ballast and partial loading conditions are defined by the gumbel distribution function as fg fl 443 73 mn m 14 84 mn m fg bl 341 19 mn m 13 15 mn m and fg pl 373 32 mn m 13 04 mn m respectively see fig 5 2 4 3 corrosion degradation the effect of corrosion on metal structures is a material thickness reduction lowering the material s mechanical properties garbatov et al 2014 and making it more vulnerable to the induced load failures in the maritime sector over the service life to corrosion and other causes were discussed in caridis 2001 very extensive corrosion depth measurement data sets of different structural components in different corrosive environments garbatov et al 2007 were analysed by the akaike s information criterion bozdogan 1987 burnham and anderson 2002 to identify which model is more likely to have generated the data and how much more likely concluding that the exponential model is more likely to have generated the data respectively in 71 of studied cases the exponential model is used in the present corrosion degradation modelling the mean value mean value dcd t and standard deviation st dev dcd t of the corrosion depth as a function of time are defined as garbatov et al 2007 1 mean value dcd t d 1 exp t τc τt t τc 2 st dev dcd t a ln t τc b c t τc where a b and c are coefficients the analysed ship hull structural system is assumed to be subjected to general corrosion degradation where the coating life τc 5 years and transition life τt 7 for all structural components and the long term corrosion thickness of any individual structural component are defined based on the corrosion margins as defined by the classification society rules bv 2016 and implemented in the bv software mars 2000 2011 the effect of the spatial distribution of the corrosion degradation garbatov and guedes soares 2017 and material changes due to degradation garbatov et al 2014 2016 are not considered in the present study 2 4 4 progressive collapse assessing the ship hull structural risk of an ageing multipurpose ship requires the development of an ultimate limit state function with a reference to the progressive ship hull structural collapse of the primary ship hull structure where the reference is made to the midship section the ship hull is considered to behave globally as a beam under transverse load subjected to still water and wave induced effects the midship section scantling and the ultimate capacity is estimated using the progressive collapse method as stipulated by the classification society rules the 5 confidence level value of the ultimate bending moment mu 5 mu c is assumed as a characteristic one which respects the value estimated by mars 2000 2011 software and additionally it is assumed that cov equals to 0 08 and it is fitted to the lognormal probability density function fln mu with a mean value μmu and standard deviation σmu as garbatov and guedes soares 2016 3 fln mu 1 mu σmu 2π exp ln mu μmu 2σmu 2 4 σmu logn cov2 1 5 μmu fln 1 0 05 μmu σmu mu 5 where fln 1 is the inverted log normal cumulative distribution function the probability density function of the ultimate bending moments in the hogging loading condition for both gross mu gross and net mu net ship hull scantling for each dmf are presented in fig 6 2 4 5 reliability estimate the reliability of a ship hull structural system can be defined as the likelihood of maintaining its ability to fulfil the design purpose for some period the objective is to estimate the reliability based on its ultimate strength when extreme loads act upon the ship hull structure subjected to corrosion degradation the probability of ship hull structural collapse is estimated here by using the first order reliability method form and formally is defined as 6 pf x p g x 0 g x 0fx x dx where fx x is the joint probability density function of the n basic stochastic variables and pf x denotes the probability of failure the n dimensional integral is defined over the failure region the form methods provide a way of evaluating the probability of ship hull structural failure efficiently with a reasonably good accuracy which is adequate for practical applications hasofer and lind 1974 rackwitz and fiessler 1978 ditlevsen 1979 the limit state function is defined as 7 g x t xu mu xsw msw xw xs mw where mu is the ultimate capacity with a model uncertainty factor xu which is assumed to be described by a normal probability density function nxu 1 05 0 1 mw is the vertical wave induced bending moment the model uncertainty factor xw accounts for the uncertainties in the linear response calculation nxw 1 0 1 and xs for the non linear effects nxs 1 0 1 msw is the still water bending moment with a model uncertainty factor xsw nxsw 1 0 1 silva et al 2014 the reliability index for the gross and net designs can be related assuming that the gross ship hull structural design respects the non corroded ship hull structure up to the moment when the corrosion protection fails and the net design respects the end of the service life when the structure is already corroded and no maintenance actions took place the service life of the ship hull structural system is considered as τs 25 years the coating life the corrosion degradation is assumed as a non linear time dependent process following the time dependent non linear corrosion degradation model as developed in guedes soares and garbatov 1999 and the time variant reliability index where t 0 τs is defined as 8 β t βgross βgross βnet 1 exp t τc ship τt ship t τc 9 β t βgross t τc then the time variant probability of failure pf t may be estimated and it is presented as a function of time conditional to dmfs in fig 7 2 5 risk assessment the risk analysis accounts for the uncertainties associated with the progressive collapse of the ship hull system subjected to corrosion degradation and it is defined as the potential for losses resulting from the structural failure the risk is based on an identified failure scenario considered here as a progressive collapse of a ship hull the risk is measured as a pair of the probability of occurrence of the progressive collapse and the consequences associated with that the risk is evaluated as a product of the likelihood of the occurrence and the impact of an accident that may happen during a period of time which is assumed as the service life of the ship τs 10 risk consequence τs likelihood event τs impact consequence event the likelihood can be expressed as a probability of failure which is described as a numeric value and the consequences are presented in a monetary value 11 risk t σjpf j p g x 1 j t 0 cf j x 2 j t where pf j p g x 1 j t 0 is the probability of failure cf j x 2 t is the impact the consequence cost of failure x 1 and x 2 are the vectors of parameters involved in the probability of failure and consequence analyses and t 0 τs the probability of failure is derived based on the assumed limit state employing the form associated with the progressive collapse of the ship hull structural system subjected to corrosion degradation the consequence costs included in the present risk analysis cover the design structural measures loss of cargo loss of the ship accidental spill and loss of human life the ship s optimal safety level is assessed by performing a cost benefit analysis where the objective is to establish an optimal safety and reliability level by using the risk control option in redesigning the initial midship section scantlings the cost benefit analysis of the ship structural system is performed based on the total expected risk risktotal tn dmf β which is a product of the probability of failure and consequence cost defined as 12 risktotal tn dmf β riskpf tn dmf β riskme dmf β where riskpf tn dmf β is the risk associated with the ship structural failure and its consequence costs and riskme dmf β is the cost of the implemented ship structural safety measures which is used here as a risk estimate of the structural safety measure both terms of eqn 28 are defined as a function of the reliability index β as this in return influences the estimate of the safety target beta reliability level βt at this stage a decision can be made in defining the part of the entire cost associated with the loss of the ship cargo accidental spill and human life related to the minimization of on the total expected risk riskpf tn dmf β the multiple cost function is transformed into one where the converted single cost cw x is defined as 13 cw x σfici x where x is the vector of the cost descriptors and fi is the partial factor the partial factors are defined based on the subjective preferences of the decision maker the risk associated with the ship hull structural collapse is estimated over the service life of the ship accounting for the probability of failure and the discount rate of γ as a function of dmf β and time as 14 cpf tn dmf β σj n pf tj dmf β f1 cs tj dmf β f2 cc f3 cd f4 cv e γtj where pf tj dmf β is the probability of failure cs tj dmf β is the cost of the ship in the year tj cc is the cost associated with the loss of cargo cd is the cost of the accidental spill cv is the cost associated with the loss of human life the cost of the ship at any time tj is a function of the initial cost of the ship at to 0 and the scraping cost at tn τs th year accounting for corrosion degradation estimated as 15 cs tj dmf β cs to dmf β cs to dmf β cs tn dmf β 1 exp tj τc ship τt ship tj τc 16 cs tj dmf β cs to dmf β t τc where cs to dmf β is the initial cost of the ship cs tn dmf β is the scrapping value of the ship and tj is the year of the operation tj 0 τs the resale or scrap value of the ship at tj tn is estimated as 17 cn tn dmf β lw tn dmf β c scrap where lw tn dmf β is the lightweight of the ship accounting for a design modification and corrosion degradation and cscrap is the resale or scrap value the cost of implementing a safety measure accounts for the redesign of the ship hull structure including the cost of material and labour depending on the level of the design modification dmf the cost of the structural redesign cme dmf β may result in a positive or negative value respectively 18 cme dmf β δwsteel dmf β csteel clabor dmf β where δwsteel dmf β dmf 1 wsteel is the weight of steel because of the design modifications tons dmf is the design modification factor ratio which is also associated with the reliability level β wsteel is the weight of the steel related to the ship hull structural design tons csteel is the cost of steel and clabor is the labour cost of the constructing a δwsteel dmf β ton structure the cost associated with the loss of cargo cc is estimated by considering that a part of the total amount of cargo of the ship pcargo is lost in the case of ship hull structural failure defined as 19 cc ccargo fcargo pcargo where c cargo is the cost of a ton of cargo and fcargo is the assumed partial factor of the cargo lost in the case of structural failure in the case of ship hull structural failure a part of the total amount of oil and fuel may be spilt fspill is the considered partial factor of spill ps p is the probability that the oil and fuel reach the shoreline sørgard et al 1999 in the case of an accidental oil spill the weight of spill that needs to be cleaned up is defined as fspill psl woil and fuel and the cost cd associated with that is 20 cd fspill psl cats woil and fuel where cats is the cost of one ton accidentally spilt oil and fuel that needs to be cleaned the implied cost of averting the fatality icaf used in the risk model is obtained from the average of ocde countries ocde 2014 the loss of human life is accounted for by including the icaf as used in a study performed in horte et al 2007 21 cv ncrew fcrew icaf where ncrew is the number of crew members fcrew is the probability of loss of the life of a crew member 2 6 benefit decision making the risk management of ship hull structural system requires the optimisation of the available capacity in supporting the design functionality of the ship subjected to corrosion degradation it also requires a definition of the acceptable risk level and alternative options for decision making the objective is to reduce the risk to an acceptable level the risk of ship hull structural collapse and design structural safety measure is estimated as a function of the structural dmf the target risk or reliability levels are used for developing design procedures for ship structures the selected reliability level determines the probability of failure of ship hull structural system and the cost consequences of that three methods are normally used to select the target reliability level 1 agreeing upon a reasonable level in the case of a novel structural system without prior history 2 calibrating the beta reliability level implied in currently successfully used design codes 3 choosing the target reliability level that minimizes a total consequence cost over the service life of the structural system in the case of design in which the failure results in economic losses and consequences the range of target beta reliability index βt at the tn τs th year of the service life of the ship hull structural system may vary between 1 5 and 5 the target beta reliability index is estimated by minimizing the total risk associated with the probability of failure and consequence cost defined as a function of the beta reliability index the optimum target reliability index is shown in fig 8 where βt 4 296 corresponding to the minimum of the curve of the total risk risktotal tn dmf β the impact of structural degradation with age namely corrosion degradation is reflected by increasing the probability of failure as a function of time a sensitivity analysis using a risk based framework for the conceptual ship design of a multi purpose vessel evaluating the impact of three types of design modification factors related to ship design structural scantling and cost descriptors garbatov and sisci 2018 demonstrated that the structural redesign the length and the block coefficient of the ship have the most significative impact on the reliability and structural collapse consequence cost partial safety factors can be used in the preliminary ship design conditioned by the imposed target reliability index which represents an acceptable risk level and minimum cost garbatov and sisci 2018 the time dependent reliability and risk may be a base to set up a maintenance and inspection plan conditional on the acceptable reliability and risk levels garbatov and guedes soares 1998 2 7 risk centred maintenance planning of ship hull structural maintenance in the past has been done based on structural reliability approaches guedes soares and garbatov 1998 involving models that represent the time deterioration as proposed in garbatov et al 2007 it is evident that operations and maintenance represent a high cost item in ship hull structural system during the service life the approach employed here uses a probabilistic model of time to fail which is used as a basis for maintenance decisions the failure of the ship hull structural system is defined by the weibull probabilistic model which represents the failure rates in operation as described in moubray 1997 rausand 1998 the analysis is used to address important issues of the condition based maintenance action and structural repair this approach covers the analysis of the severity of structural degradation the costs of preventive and corrective maintenance optimal replacement interval optimal replacement age as has been reported in garbatov and guedes soares 2001 2009 2 7 1 degradation tolerance the acceptable risk levels depend on different factors as reported in moan 1998 and the failure cause and mode may result in redundant structures in pf l 4 17 10 5 βl 3 93 for a low degradation tolerance pf m 1 02 10 4 βm 3 71 for a moderate degradation tolerance pf h 1 92 10 4 βh 3 55 for a high degradation tolerance and pf e 3 14 10 4 βe 3 42 for an extreme degradation tolerance see fig 9 using these acceptable beta reliability levels the analysed ship hull structural system subjected to buckling and corrosion degradation has a mean time of failure mttfi of 8 12 16 and 20 years the probability of failure of ship hull structural system is modelled by a weibull probability function where the three parameter weibull distribution is defined by the shape parameter βw location parameter γw and scale parameter ηw where βw and ηw are greater than 0 the reliability estimates for the different levels of degradation tolerance levels defined here as low moderate high and extreme degradation tolerance is given in fig 10 where βlow 2 16 ηlow 6 21 years γlow 5 years βmoderate 2 16 ηmoderate 7 9 years γmoderate 5years βhigh 2 16 ηhigh 11 29 years γhigh 5years βextreme 2 16 ηextreme 20 33 years γextreme 5years in the case of dmf 1 see fig 10 2 7 2 cost of maintenance a major part of the operating expenditures are the maintenance costs during the vessel s lifecycle in general this cost contributes to 25 35 of the total operating expenditures opex turan et al 2009 it depends on many factors including the quality of the work delivered by the shipyard the geographical location of the vessel its access to periodic maintenance operational profile etc it is important to create a procedure for analysing the potential failure by classifying the severity of the effect of failures on the structure which is widely used in many industries during various phases of the service life dod 1984 kececioglu 1991 langford 1995 a failure mode may be defined as how failure is observed and it generally describes how the failure occurs tools used in the design stage for identifying failures and determining their consequences are risk priority numbers occurrence severity matrix risk ranking tables and criticality analysis for the current work these methods are adapted to identify the age of the structure of the first repair and the interval of preventive repairs the input is the cost of a preventive repair cp and the cost of a repair after failure cf which are assumed here for four hypothetical levels low moderate high and extreme repair consequences as an example as can be seen in fig 11 2 7 3 repair interval ship hull structural systems are subjected to corrosion degradation and buckling and when a failure occurs the structural system needs to be repaired since the failure is not expected then it may be assumed that the failure repair is costlier than the one in an earlier repair to reduce the failure consequences repair can be scheduled to occur at specified intervals however a balance is required between the amount spent on the repair and their resulting benefits the repair policy is such so that preventive repair occurs at fixed intervals of time and repair due failure occurs whenever is necessary the objective is to determine an optimal interval between the preventive repairs and to minimize the total expected cost of repairing the ship hull structural system per unit time the total cost of a repair before failure is defined as cp while cfi is the total cost of repair due to failure and f t is the probability density function of the ship hull structural system failure as a function of time the repair policy is to perform the repair at constant intervals of time tp years irrespective of the age of the ship hull structural system and repair due to failure as many times as required in the interval t 0 tp to determine the optimal interval between the preventive repair the total expected repair cost per unit time is minimized the total expected cost per unit time for the preventive repair at the intervals of a length tp years denoted cri tp equals the total expected cost in the interval 0 tp divided by the length of the time interval tp garbatov and guedes soares 2009 22 c tp cp cfh tp tp where h tp is the expected number of failures in the interval t 0 tp to determine h tp the renewal theory approach is to be applied the optimal preventive repair intervals are defined as the minimum of c tp as shown in fig 12 2 7 4 repair age this problem is similar to the one presented before except that instead of making the repair at fixed intervals with the possibility of performing a repair shortly after the repair due to failure the time at which the repair occurs depends on the age of the structure when a failure occurs repair is made when this happens the clock time is reset to zero and the next repair occurs only when the structure has been in use for a specified period the problem is to balance the cost of the repair against the benefits and this is done by determining the optimal repair age to minimize the total expected cost due to repair per unit time the repair policy is to perform a preventive repair when the structure has reached a specified age tp and repair due to failure when necessary the objective is to determine the optimal repair age tp to minimize the total expected repair cost per unit time there are two possible cycles of operation one cycle being determined by the ship hull structural system reaching its planned repair age tp and other being determined by the ship hull structural system ceasing to operate due to a failure occurring before the planned time for repair the total expected cost of repair per unit time is defined as c tp garbatov and guedes soares 2009 the total expected repair cost per cycle equals the cost of a cycle before failure cp times the probability of a cycle r tp plus the cost of a failure cycle cf times the probability of failure cycle 1 r tp divided to the expected length of the cycle tp the mean time to failure is defined as m t tf t 1 r tp dt and therefore the total cost results in 23 c tp cpr tp cf 1 r tp tp r tp t f t dt where r t 1 f t f t is the cumulative distribution function of the ship hull structural system failure the optimal preventive repair age is defined as tp tp cmin γ and the expected cost of repair per unit time as a function of tp is shown in fig 13 and the positioning factor which is associated with the coating life is assumed here as γ 5years in some cases due to difficulties in financing or the desire to get maximum throughput or utilization of ship hull structural system the repair policy applied may be one that minimizes the total downtime per unit time or equivalently maximizes availability garbatov and guedes soares 2009 3 maintenance decision the decision making is performed defining cij x related to the cost associated with the low moderate high and extreme degradation tolerances conditional to the level of repair consequences the weight sum method converts the multiple degradation tolerances into a single cost function for any repair consequence level cw j defined as 24 cw j x σiwijcij x where x is the vector of the repair cost descriptors and wij are the weighting factors σiwij 1 and wij 0 1 the weighting factors may be defined based on the subjective preferences of the decision maker and here they are assumed to be estimated as wij mttfi mttfi 1 σmttfi where mttfi represents the mean time to failure in the case of the low moderate high and extreme degradation tolerance respectively the goal is to define the optimal ship hull structural system age for repair tp see fig 14 left and preventive repair interval tp see fig 14 right by minimizing the converted repair cost of the ship hull structural system conditional of the repair consequence level the preventive repair age and repair interval for the studied repair consequence levels are presented in table 1 the minimal repair can be performed as a minor maintenance that returns the structural system to the same structural capacity state that it was just before the minor maintenance the general repair improves the structural system state and the renewal repair completely returns the structural system to the statistically as good as new condition the concept of virtual age is introduced to model the structural system maintenance the real age run time of the structural system is presented on the vertical axis and the virtual age is on the horizontal axis in fig 15 at the first repair when the structural system age is 16 years in the case of a low repair consequence the structural system becomes of age 14 years after the maintenance action once the structural system has operated for a further period of 11 years to bring its running age for 14 11 years another maintenance action occurs that brings the structural system in a virtual age to 25 years etc the acceptable operational regime and the boundary of the preventive repair for different levels of deterioration tolerance are also shown in fig 15 the issue addressed here is to be taken into consideration when there is a need for a maintenance intervention and to define what kind of repair action should be taken minimal repair general repair or complete renewal to address this issue the repair limit concept through the cost is employed if the cost estimate of the preventive maintenance is between zero and the limit of 10 of the residual cost of steel structural system then a minimal repair is made if the cost is between 10 and the cost boundary then a general repair is made the boundary cost is assumed to be the cost of the residual steel structural system at the moment of the maintenance action see fig 16 right the cost associated with the first maintenance intervention at the 14th year is more than 10 of the resale or scrap value in the case of a low repair consequence so a general repair instead of a minimal repair should be made and consequently the structural system capacity is improved when compared to its condition prior to repair commencing the cost associated with the planned preventive maintenance actions are shown in fig 16 left and how the residual scrapping cost of steel structural system is distributed during the service time accounting for the maintenance planning is given in fig 16 right it can be seen from fig 16 that the repair cost keeping the capacity of the structural system on the same level in the case of lower repair consequence is invested later and with less frequency than the other repair consequence levels in the case of the lower repair consequence the scrapping cost will be less at the end of service life which can be explained by the less resting weight of steel the output of this analysis provides information that can be used by the designer for decision making leading to redesign of the initial solution in optimizing the repair cost needed to be invested during the service life of the ship it has to be pointed out that the present analysis is performed based on the assumption that the structural steel system ship hull will start the service life in the condition of the gross design and will arrive to the end of the service life at the net design where the structural components will be degraded according to the corrosion adds as prescribed by csr and the coating life is assumed to be 5 years and the transition life of 7 years however a much more severe corrosion environment may be seen during the service life and the developed risk based framework of the ship and structural design is capable to account for it 4 conclusions this work developed a risk based framework for the ship and structural design to be used in the conceptual ship design stage accounting for maintenance planning where different approaches are being applied to address the early design stage of ship and ship structures risk covered here is associated with the ship hull structural failure accidental spills loss of cargo loss of ship and crew members during the service life the structural failure accounted for structural corrosion degradation in a conjunction with the ship hull strength some of the employed methods are envisaged to be approximate as they are based on the limited data available during the early design stage the risk cantered maintenance methodology was applied in determining the maintenance planning of a ship hull structural system in its operating context for four hypothetical repair consequences the concept of the virtual age was introduced to model the ship hull structural system maintenance where the boundary of the preventive repair on different deterioration tolerance levels is established the boundary cost of performing a general repair or renewable repair is established based on the resale or scrap value of steel structural system the developed risk based framework for the ship and ship structural design is capable to analyse different types of ships operating in different environmental conditions the present risk based framework is developed to be used in the early stage of ship design where limited data is available and at the same time permits to project a specific maintenance planning allowing a measure related to the future maintenance and repair to be considered making the design solution more economical leading to a less operational cost and satisfying the existing requirements for a safety transportation acknowledgement this paper reports a work developed in the project ship lifecycle software solutions shiplys which was partially financed by the european union through the contract no 690770 shiplys h2020 mg 2014 2015 
23109,automatic identification system 3 2 experimental data source 4 experiments and results 4 1 compression experiment 4 2 experiment for performance comparison 5 conclusion acknowledgments devries 2012 13426 13439 g douglas 1973 112 122 d etienne 2012 47 57 l internationalmaritimeorganizationimo 1974 internationalconventionforsafetylifeseasolas internationaltelecommunicationsunionitu 2010 1371 1374 technicalcharacteristicsforautomaticidentificationsystemusingtimedivisionmultipleaccessinvhfmaritimemobileband keogh 2001 289 296 e li 2010 11 13 m li 2016 y 8thinternationalconferencewirelesscommunicationssignalprocessingwcsp15 trajectorycompressionguidedvisualizationspatiotemporalaisvesseldensity meratnia 2004 n internationalconferenceextendingdatabasetechnology765782 spatiotemporalcompressiontechniquesformovingpointobjects mou 2010 483 490 j muckell 2010 j sigspatialinternationalconferenceadvancesingeographicinformationsystems402405 algorithmsforcompressinggpstrajectorydataempiricalevaluation muckell 2014 435 460 j pallotta 2013 2218 2245 g patroumpas 2017 389 427 k qi 2016 l ramer 1972 244 256 u spiliopoulos 2017 g internationalworkshopmobilityanalyticsforspatiotemporalsocialdata109121 abigdatadrivenapproachextractingglobaltradepatterns spiliopoulos 2017 g ieeeinternationalconferencebigdata16821687 knowledgeextractionmaritimespatiotemporaldataevaluationclusteringalgorithmsbigdata wu 2016 67 81 l zhang 2016 729 744 s zhao 2018 1 21 l zhen 2017 492 501 r zhu 2014 59 62 f zhaox2018x37 zhaox2018x37x46 zhaox2018x37xl zhaox2018x37x46xl 2020 08 10t00 00 00 000z 2020 08 10t00 00 00 000z http creativecommons org licenses by nc nd 4 0 2018 elsevier ltd all rights reserved item s0029 8018 18 31487 2 s0029801818314872 1 s2 0 s0029801818314872 10 1016 j oceaneng 2018 08 005 271462 2018 12 17t21 45 53 204549z 2018 10 15 1 s2 0 s0029801818314872 main pdf https s3 amazonaws com prod ucs content store us east content pii s0029801818314872 main application pdf 4d32eee195d693c1543543724b72ab90 main pdf main pdf pdf true 5882826 main 10 1 s2 0 s0029801818314872 main 1 png https s3 amazonaws com prod ucs content store us east content pii s0029801818314872 preview image png 2238c47aec2a437ac2ffcb6a65334810 main 1 png main 1 png png 53234 849 656 image web pdf 1 1 s2 0 s0029801818314872 fx1 sml https s3 amazonaws com prod ucs content store us east content pii s0029801818314872 fx1 thumbnail image gif cbc441fbfa8ce6f6f7aae36832963bcd fx1 sml fx1 fx1 sml sml 11282 164 58 image thumbnail 1 s2 0 s0029801818314872 gr1 sml https s3 amazonaws com prod ucs content store us east content pii s0029801818314872 gr1 thumbnail image gif 8121c3582a5b1ea76c00ccef76b21b96 gr1 sml gr1 gr1 sml sml 17505 164 175 image thumbnail 1 s2 0 s0029801818314872 gr10 sml https s3 amazonaws com prod ucs content store us east content pii s0029801818314872 gr10 thumbnail image gif 655cd93d243899876bfdc0bd96f259a5 gr10 sml gr10 gr10 sml sml 16122 157 219 image thumbnail 1 s2 0 s0029801818314872 gr11 sml https s3 amazonaws com prod ucs content store us east content pii s0029801818314872 gr11 thumbnail image gif 7e59a86747a26452809c082816299e84 gr11 sml gr11 gr11 sml sml 13646 145 219 image thumbnail 1 s2 0 s0029801818314872 gr12a sml https s3 amazonaws com prod ucs content store us east content pii s0029801818314872 gr12a thumbnail image gif deaa8f5e28698ad954730fe22b83c866 gr12a sml gr12a gr12a sml sml 12542 164 63 image thumbnail 1 s2 0 s0029801818314872 gr12b sml https s3 amazonaws com prod ucs content store us east content pii s0029801818314872 gr12b thumbnail image gif dbb663c9276fe681aa1f09cd4c951f78 gr12b sml gr12b gr12b sml sml 18782 164 124 image thumbnail 1 s2 0 s0029801818314872 gr13 sml https s3 amazonaws com prod ucs content store us east content pii s0029801818314872 gr13 thumbnail image gif ee32fa328d08fb0918ab0b6f4ebc2310 gr13 sml gr13 gr13 sml sml 12898 164 126 image thumbnail 1 s2 0 s0029801818314872 gr2 sml https s3 amazonaws com prod ucs content store us east content pii s0029801818314872 gr2 thumbnail image gif ab96db0c8179f0b6631596b16d287161 gr2 sml gr2 gr2 sml sml 14489 164 116 image thumbnail 1 s2 0 s0029801818314872 gr3 sml https s3 amazonaws com prod ucs content store us east content pii s0029801818314872 gr3 thumbnail image gif 60e12f2b69e07750bdc1bd88f80c8ca3 gr3 sml gr3 gr3 sml sml 18512 121 219 image thumbnail 1 s2 0 s0029801818314872 gr4 sml https s3 amazonaws com prod ucs content store us east content pii s0029801818314872 gr4 thumbnail image gif 9661f0ce6ef20e95746f42eed0a3b8ac gr4 sml gr4 gr4 sml sml 32653 152 219 image thumbnail 1 s2 0 s0029801818314872 gr5 sml https s3 amazonaws com prod ucs content store us east content pii s0029801818314872 gr5 thumbnail image gif 0e158ba26dc5fd1d2a48bb8ecd0e7581 gr5 sml gr5 gr5 sml sml 40033 133 219 image thumbnail 1 s2 0 s0029801818314872 gr6 sml https s3 amazonaws com prod ucs content store us east content pii s0029801818314872 gr6 thumbnail image gif 1160de57efa045613e8e02e27cb982bf gr6 sml gr6 gr6 sml sml 17261 163 131 image thumbnail 1 s2 0 s0029801818314872 gr7 sml https s3 amazonaws com prod ucs content store us east content pii s0029801818314872 gr7 thumbnail image gif efa40490884c0ab4272946453310e9bc gr7 sml gr7 gr7 sml sml 38364 130 219 image thumbnail 1 s2 0 s0029801818314872 gr8 sml https s3 amazonaws com prod ucs content store us east content pii s0029801818314872 gr8 thumbnail image gif be97ee135dd73d7dae5d9e0e124c2533 gr8 sml gr8 gr8 sml sml 33533 164 127 image thumbnail 1 s2 0 s0029801818314872 gr9 sml https s3 amazonaws com prod ucs content store us east content pii s0029801818314872 gr9 thumbnail image gif 21869c078534311c653d8ebcb601dcfc gr9 sml gr9 gr9 sml sml 16437 146 219 image thumbnail 1 s2 0 s0029801818314872 fx1 jpg https s3 amazonaws com prod ucs content store us east content pii s0029801818314872 fx1 downsampled image jpeg d2c1ba6ec3f6003f2b4351dbae59a246 fx1 jpg fx1 fx1 jpg jpg 140105 1006 356 image downsampled 1 s2 0 s0029801818314872 gr1 jpg https s3 amazonaws com prod ucs content store us east content pii s0029801818314872 gr1 downsampled image jpeg b96e278643c7e7b7b90f379e5c2d4f2d gr1 jpg gr1 gr1 jpg jpg 53736 340 363 image downsampled 1 s2 0 s0029801818314872 gr10 jpg https s3 amazonaws com prod ucs content store us east content pii s0029801818314872 gr10 downsampled image jpeg 3a1a637b03582625e48feeda9662a7ac gr10 jpg gr10 gr10 jpg jpg 49353 259 362 image downsampled 1 s2 0 s0029801818314872 gr11 jpg https s3 amazonaws com prod ucs content store us east content pii s0029801818314872 gr11 downsampled image jpeg 6baa7cc42d3ade7d5a9e490c53625bf1 gr11 jpg gr11 gr11 jpg jpg 44054 247 374 image downsampled 1 s2 0 s0029801818314872 gr12a jpg https s3 amazonaws com prod ucs content store us east content pii s0029801818314872 gr12a downsampled image jpeg ffcce8ce48ca7ed58999d500356de4bd gr12a jpg gr12a gr12a jpg jpg 139604 1008 388 image downsampled 1 s2 0 s0029801818314872 gr12b jpg https s3 amazonaws com prod ucs content store us east content pii s0029801818314872 gr12b downsampled image jpeg fdeb487e879ac83ab25709c1265291c2 gr12b jpg gr12b gr12b jpg jpg 83978 499 378 image downsampled 1 s2 0 s0029801818314872 gr13 jpg https s3 amazonaws com prod ucs content store us east content pii s0029801818314872 gr13 downsampled image jpeg e0b5f960320f78a8d6ee798f5cea0eba gr13 jpg gr13 gr13 jpg jpg 61341 493 379 image downsampled 1 s2 0 s0029801818314872 gr2 jpg https s3 amazonaws com prod ucs content store us east content pii s0029801818314872 gr2 downsampled image jpeg 80c69bfc0c9070e2a917b209118a3d25 gr2 jpg gr2 gr2 jpg jpg 74263 521 369 image downsampled 1 s2 0 s0029801818314872 gr3 jpg https s3 amazonaws com prod ucs content store us east content pii s0029801818314872 gr3 downsampled image jpeg 05449a0dc114fd8327cae99ab1d308b6 gr3 jpg gr3 gr3 jpg jpg 46796 209 379 image downsampled 1 s2 0 s0029801818314872 gr4 jpg https s3 amazonaws com prod ucs content store us east content pii s0029801818314872 gr4 downsampled image jpeg 64be9044f55373c722e0c1ef4cc57b36 gr4 jpg gr4 gr4 jpg jpg 56928 241 346 image downsampled 1 s2 0 s0029801818314872 gr5 jpg https s3 amazonaws com prod ucs content store us east content pii s0029801818314872 gr5 downsampled image jpeg a0cc0093b99c8b23a545620377d4d15f gr5 jpg gr5 gr5 jpg jpg 129919 303 500 image downsampled 1 s2 0 s0029801818314872 gr6 jpg https s3 amazonaws com prod ucs content store us east content pii s0029801818314872 gr6 downsampled image jpeg 5f24671a3cef88eeddd722eef2c9f83e gr6 jpg gr6 gr6 jpg jpg 71167 462 371 image downsampled 1 s2 0 s0029801818314872 gr7 jpg https s3 amazonaws com prod ucs content store us east content pii s0029801818314872 gr7 downsampled image jpeg 677b5030066cf7121eae7d2b589df15f gr7 jpg gr7 gr7 jpg jpg 224372 421 707 image downsampled 1 s2 0 s0029801818314872 gr8 jpg https s3 amazonaws com prod ucs content store us east content pii s0029801818314872 gr8 downsampled image jpeg 896098ddef4ed61b689df1ca00795ce9 gr8 jpg gr8 gr8 jpg jpg 452686 982 762 image downsampled 1 s2 0 s0029801818314872 gr9 jpg https s3 amazonaws com prod ucs content store us east content pii s0029801818314872 gr9 downsampled image jpeg 06e35c605aced8a9780194654a8ac7ff gr9 jpg gr9 gr9 jpg jpg 50348 248 371 image downsampled 1 s2 0 s0029801818314872 fx1 lrg jpg https s3 amazonaws com prod ucs content store us east content pii s0029801818314872 fx1 highres image jpeg e2d12be070df481e6e85b34f719ff647 fx1 lrg jpg fx1 fx1 lrg jpg jpg 1046257 4455 1577 image high res 1 s2 0 s0029801818314872 gr1 lrg jpg https s3 amazonaws com prod ucs content store us east content pii s0029801818314872 gr1 highres image jpeg e36233331e65ce77bab7e3297f3a7415 gr1 lrg jpg gr1 gr1 lrg jpg jpg 295385 1506 1607 image high res 1 s2 0 s0029801818314872 gr10 lrg jpg https s3 amazonaws com prod ucs content store us east content pii s0029801818314872 gr10 highres image jpeg ec14d5bf9b05d8ff050f8555da3a8bc7 gr10 lrg jpg gr10 gr10 lrg jpg jpg 221816 1146 1602 image high res 1 s2 0 s0029801818314872 gr11 lrg jpg https s3 amazonaws com prod ucs content store us east content pii s0029801818314872 gr11 highres image jpeg 3e5d0a44107b8ec9b5e4a0b79ca9e48e gr11 lrg jpg gr11 gr11 lrg jpg jpg 187244 1096 1659 image high res 1 s2 0 s0029801818314872 gr12a lrg jpg https s3 amazonaws com prod ucs content store us east content pii s0029801818314872 gr12a highres image jpeg b452512d30988c6b005a771affa612a7 gr12a lrg jpg gr12a gr12a lrg jpg jpg 981369 4465 1718 image high res 1 s2 0 s0029801818314872 gr12b lrg jpg https s3 amazonaws com prod ucs content store us east content pii s0029801818314872 gr12b highres image jpeg 436749cac2d0269190260ec899a20186 gr12b lrg jpg gr12b gr12b lrg jpg jpg 521375 2211 1676 image high res 1 s2 0 s0029801818314872 gr13 lrg jpg https s3 amazonaws com prod ucs content store us east content pii s0029801818314872 gr13 highres image jpeg 84d76beb006084dd573d0846c849ab12 gr13 lrg jpg gr13 gr13 lrg jpg jpg 332323 2184 1678 image high res 1 s2 0 s0029801818314872 gr2 lrg jpg https s3 amazonaws com prod ucs content store us east content pii s0029801818314872 gr2 highres image jpeg ebcbfb50275a52dca8595500dc7ce8f5 gr2 lrg jpg gr2 gr2 lrg jpg jpg 445124 2309 1634 image high res 1 s2 0 s0029801818314872 gr3 lrg jpg https s3 amazonaws com prod ucs content store us east content pii s0029801818314872 gr3 highres image jpeg 191464c86bb4367044973dcc1ef9633a gr3 lrg jpg gr3 gr3 lrg jpg jpg 252876 926 1681 image high res 1 s2 0 s0029801818314872 gr4 lrg jpg https s3 amazonaws com prod ucs content store us east content pii s0029801818314872 gr4 highres image jpeg 037e981df9c839bd94f26ed5e721b60f gr4 lrg jpg gr4 gr4 lrg jpg jpg 347198 1068 1535 image high res 1 s2 0 s0029801818314872 gr5 lrg jpg https s3 amazonaws com prod ucs content store us east content pii s0029801818314872 gr5 highres image jpeg 2116f116e5998bc086ae5e1da31401c0 gr5 lrg jpg gr5 gr5 lrg jpg jpg 1091546 1339 2213 image high res 1 s2 0 s0029801818314872 gr6 lrg jpg https s3 amazonaws com prod ucs content store us east content pii s0029801818314872 gr6 highres image jpeg cf58864a43c5906576929675ce16c525 gr6 lrg jpg gr6 gr6 lrg jpg jpg 442979 2050 1645 image high res 1 s2 0 s0029801818314872 gr7 lrg jpg https s3 amazonaws com prod ucs content store us east content pii s0029801818314872 gr7 highres image jpeg 868f6425e63d315431f304052f104a6c gr7 lrg jpg gr7 gr7 lrg jpg jpg 1948292 1863 3131 image high res 1 s2 0 s0029801818314872 gr8 lrg jpg https s3 amazonaws com prod ucs content store us east content pii s0029801818314872 gr8 highres image jpeg e3c917ce87edc62d8595dcfcf33f3bb0 gr8 lrg jpg gr8 gr8 lrg jpg jpg 3931490 4349 3376 image high res 1 s2 0 s0029801818314872 gr9 lrg jpg https s3 amazonaws com prod ucs content store us east content pii s0029801818314872 gr9 highres image jpeg 07eedb878caa6272a8821d6c67b467ea gr9 lrg jpg gr9 gr9 lrg jpg jpg 212348 1099 1644 image high res 1 s2 0 s0029801818314872 si1 gif https s3 amazonaws com prod ucs content store us east content pii s0029801818314872 stripin image gif f96c8dfdd06abf549cd8d8badcd0e3bc si1 gif si1 si1 gif gif 3069 31 91 altimg 1 s2 0 s0029801818314872 si2 gif https s3 amazonaws com prod ucs content store us east content pii s0029801818314872 stripin image gif 6ae8d7dfa82884bf975560670b8a9b5e si2 gif si2 si2 gif gif 3451 42 204 altimg 1 s2 0 s0029801818314872 si3 gif https s3 amazonaws com prod ucs content store us east content pii s0029801818314872 stripin image gif 091e0cff17845de5f1b3346e7a518151 si3 gif si3 si3 gif gif 2818 13 50 altimg 1 s2 0 s0029801818314872 si4 gif https s3 amazonaws com prod ucs content store us east content pii s0029801818314872 stripin image gif 60435fab15c7151bfde157c44e69d32a si4 gif si4 si4 gif gif 2820 13 45 altimg 1 s2 0 s0029801818314872 si5 gif https s3 amazonaws com prod ucs content store us east content pii s0029801818314872 stripin image gif a8a86d54c6fe19bd8d622355734a7ba7 si5 gif si5 si5 gif gif 3006 29 97 altimg 1 s2 0 s0029801818314872 si6 gif https s3 amazonaws com prod ucs content store us east content pii s0029801818314872 stripin image gif df2021390e21c6fb40e357089bda5268 si6 gif si6 si6 gif gif 3006 18 119 altimg 1 s2 0 s0029801818314872 si7 gif https s3 amazonaws com prod ucs content store us east content pii s0029801818314872 stripin image gif ca2e03f549a668da8f15580e9fbc21f8 si7 gif si7 si7 gif gif 3268 21 221 altimg 1 s2 0 s0029801818314872 si8 gif https s3 amazonaws com prod ucs content store us east content pii s0029801818314872 stripin image gif bb8b4488a76ee39fd2ef402a80123a90 si8 gif si8 si8 gif gif 3081 26 128 altimg oe 5410 s0029 8018 18 31487 2 10 1016 j oceaneng 2018 08 005 elsevier ltd fig 1 dp algorithm theory fig 1 fig 2 schematic of the dp algorithm fig 2 fig 3 straight and curve parts in a ship trajectory fig 3 fig 4 range of the study area fig 4 fig 5 experimental data based on the ais from zhou shan islands january 2015 fig 5 fig 6 compression result of an ais trajectory fig 6 fig 7 simplified trajectory map based on the ais data for zhou shan islands january 2015 fig 7 fig 8 comparison of the density map based on the original trajectories and simplified trajectories fig 8 fig 9 comparison of the compression rate fig 9 fig 10 comparison of the length loss fig 10 fig 11 comparison of the running time fig 11 fig 12 compression results of an ais trajectory in the three parallel experiments fig 12 fig 13 comparison result of proposed method and other existing trajectory compression algorithm fig 13 table 1 contents of dynamic message table 1 contents description navigational status status including under way using engine and at anchor etc rot rate of turn sog speed over ground longitude position information latitude position information cog course over ground th true heading table 2 message update rate table 2 types of ships reporting interval ship at anchor or moored and not moving faster than 3 knots 3 min ship at anchor or moored and moving faster than 3 knots 10 s ship with a speed between 0 and 14 knots 10 s ship with a speed between 0 and 14 knots and changing course 3 1 3 s ship with a speed between 14 and 23 knots 6 s ship with a speed between 14 and 23 knots and changing course 2 s ship with a speed exceeding 23 knots 2 s ship with a speed exceeding 23 knots and changing course 2 s table 3 range of the study area table 3 boundary point longitude latitude left bottomright top 121 583326122 799995 29 59993 30 333317 table 4 size of the experimental data table 4 number of position messages number of ships number of trajectories 87434689 5665 53768 table 5 ship type table 5 type number of ships proportion fishing ship 30 0 530 passenger ship 160 2 824 cargo ship 3568 62 983 tanker 980 17 299 other ship 927 16 364 table 6 ship length table 6 length number of ships proportion less than 50 m 310 5 472 50 m 100 m 1883 33 239 100 m 150 m 1282 22 630 150 m 200 m 728 12 851 larger than 200 m 962 16 981 null or invalid 500 8 826 table 7 performance results of compression by the dp algorithm table 7 threshold times the ship length discarded records compression rate length loss nm loss rate running time s 0 1 74686462 86 903 9890 95 1 110 66646 23 0 2 79158715 92 107 20139 44 2 261 50764 37 0 5 83099864 96 693 34980 44 3 927 25617 12 0 8 83913246 97 639 37644 4 4 226 22234 94 1 84519920 98 345 40567 02 4 554 18779 27 1 25 84815084 98 689 42376 9 4 757 15481 91 2 85124335 99 049 45431 35 5 100 12818 84 5 85467446 99 448 52778 63 5 925 10975 87 10 85608372 99 612 62553 6 7 022 10691 32 table 8 performance results of compression by the proposed method table 8 threshold times the ship length discarded records compression rate length loss nm loss rate running time s 0 1 74759286 86 988 11438 85 1 284 37724 96 0 2 79101946 92 041 21091 73 2 368 29229 82 0 5 82923687 96 488 35383 6 3 972 13809 04 0 8 83695539 97 386 37801 65 4 243 12069 8 1 84305155 98 095 40776 31 4 577 9110 86 1 25 84573514 98 408 42412 09 4 761 7819 99 2 84871795 98 755 45262 85 5 081 6194 11 5 85200506 99 137 52578 43 5 902 5157 77 10 85332847 99 291 62204 89 6 983 4601 62 a method for simplifying ship trajectory based on improved douglas peucker algorithm liangbin zhao guoyou shi navigation college dalian maritime university 1 linghai road dalian liaoning china navigation college dalian maritime university 1 linghai road dalian liaoning china corresponding author automatic identification system ais can provide massive ship trajectory data that is valuable for mining information in water traffic however large sizes lead to difficulties in storing querying and processing the aforementioned data in the present study to better compress ship trajectory data regarding compression time and efficiency a method based on the improved douglas peucker dp algorithm is presented in the process of compression the proposed method considers the shape of vessel trajectory derived from course information of track points parallel experiments are conducted based on ais data gathered over the duration of a month in the chinese zhou shan islands the results indicate that this method can effectively compress ship trajectory information additionally when compared with the traditional dp algorithm this method can significantly reduce the compression time and exhibits better performance at high compression strengths also the proposed method outperforms other existing trajectory compression algorithms in term of compression time keywords water traffic ship trajectory automatic identification system ais trajectory compression douglas peucker algorithm 1 introduction recently the value of ship trajectory data has increased thousands of ships sail around the world daily their mobility results in water traffic which is a phenomenon that shows the behavioral patterns of ships these patterns may support managers in the field of maritime supervision and management automatic identification system ais is an automatic tracking system for identifying and locating ships by exchanging data with other nearby ships and ais base stations increasing research in the maritime field is focused on ais data mining given the fast development of ais terminal network data storage and data collection capacity several studies based on ais data aim at various purposes including visualization for detecting spatial distribution regularities in ships abnormal ship identification for maritime control and decision making for collision avoidance wu et al 2016 created the maps of shipping density on a global scale with over 2 5 years of ais data they computed the average number of vessels crossing each grid per unit time and 21 162 882 025 pieces of ais data costs 16 h pallotta et al 2013 presented an unsupervised and incremental learning approach for extracting vessel movement patterns their aim involved converting a large amount of ais data into information supporting decisions two months of ais traffic data in strait of gibraltar and three months of satellite ais position data over the indian ocean are collected for pattern training and testing mou et al 2010 used ais data in studies on ship collision avoidance in busy waterways in the study a period corresponding to 62 days of data during june july and august 2007 in the north sea was analyzed to calculate important parameters such as the closest point of approach cpa and time to the cpa tcpa zhen et al 2017 utilized ais data and clustering method to obtain the clusters of encounter vessels and then constructed the semantic and mathematical relationship of vessel collision risk index for each cluster of encounter vessels with dcpa distance to closest point and tcap a common task for all the ais data studies corresponds to preprocessing massive historical records an ais message is transmitted by a ship at frequent intervals of approximately 3 10 s however the frequency of the clear change in speed and course is significantly lower than the recording rate consequently most information in the raw ais data is redundant in ais trajectories that consist of massive similar track points to reduce the cost of storage and computing in data processing and to satisfy the response time requirement compression of the vessel trajectory data is usually used before the detailed application qi and zheng 2016 proposed a method for recognizing the vessel course alteration and extracting the representative point of a ship trajectory spiliopoulos et al 2017a described an approach which is based on clustering technique and distributed processing technique to transform billions of records of spatiotemporal ais data into information for understanding the patterns of global trade patroumpas et al 2017 presented a system to extract trajectory synopses from the incoming ais positions retaining salient movement features only their method can instantly identify critical point along each trajectory such as a stop a turn or slow motion therefore they may discard redundant locations along a normal course and approximately reconstruct each vessel trajectory from such a synopsis consisting of critical points only a ship trajectory in the small area is considered as line data in two dimensional plane the douglas peucker dp algorithm douglas and peucker 1973 ramer 1972 was considered as one of the most accurate and effective methods to compress line data meratnia and rolf 2004 muckell et al 2010 2014 and was widely adopted in compression of moving object trajectory in terms of dp based compression of vessel trajectory etienne et al 2012 used the dp algorithm filter to reduce the number of positions of a trajectory while retaining only the important positions their purpose involved optimizing the computation time of the traffic flow pattern identification they conducted an experiment based on 104 201 records of 506 trajectories and the compression rate was 84 54 for a threshold of 10 m the precision of a gps device li et al 2010 proposed a method that considered the time attribute of ship trajectory they considered a ship trajectory as line data in three dimensional space an experimental result based on 30 000 records indicated that the method can retain additional feature points that may preserve more information about the speed of trajectory zhu et al 2014 conducted a similar study de vries and van someren 2012 adapted the dp algorithm to better retain stop and move information on the ship trajectory zhang et al 2016 presented a method to select a suitable threshold for ais trajectory based on determining the maximum value that can ensure that the track point of simplified trajectory is within the safety scope of the corresponding original track point thus the calculated ship domain in the navigational situations is used as the threshold value after the experiment based on 5 902 840 records from 962 ships in chinese qiong zhou strait the result revealed that the compression rate corresponded to 98 25 with a threshold set as 0 8 times the ship length li et al 2016 conducted several experiments to select an appropriate threshold that can guarantee a good balance between ais trajectory simplification and visualization quality the experimental ais data included 29 015 coordinate points from 187 vessels running time and compression rate are the two important indicators of compression result compression at high strength costs less time and retains less data and compression at low strength costs more time and retains more data in practical applications the requirement varies to a large extent for different users for example the identification of ship dynamic parameters and statistical analysis of maritime traffic requires more details in the data while the data in visualization analysis should be minimized to the maximum possible extent under the condition of maintaining data quality additionally studies on mapping trajectory with different scales exhibit different requirements of data quality furthermore while dealing with large datasets the running time is an important consideration factor that should not be neglected by users however previous studies do not sufficiently discuss the problem of running time and compressed data quality at high compression strengths in dp algorithm to better apply dp algorithm to ship trajectory compression under the requirements in which the algorithm may utilize considerable time or a high compression strength this study proposes a method that incorporates the course change in the ship trajectory and dp algorithm when compared with the performances of the traditional dp algorithm the proposed method can significantly reduce the running time at the same level of compression strength and additionally exhibits improved compressed data quality at high compression strength also the proposed method outperforms other existing trajectory compression algorithms in term of compression time additionally ship trajectory data which is based on the geographic coordinate system cannot be used directly in the dp algorithm which is based on the cartesian coordinates system in the proposed method the mercator projection coordinate is applied to solve this problem the remainder of this paper is organized as follows in section 2 the method for simplifying ship trajectory based on dp algorithm is introduced in section 3 we introduce ais data and the basic information on the data source in the study section 4 shows the experimental results and the conclusions are discussed in section 5 2 simplification method for ship trajectory 2 1 douglas peucker algorithm 2 1 1 algorithm theory the dp algorithm was presented by d douglas and t peucker in 1973 the algorithm splits the line data recursively and controls the compression quality by the threshold and it is widely used in simplifying the trajectory of moving point objects due to its speed and accuracy the algorithm theory is illustrated in fig 1 an ais trajectory is represented as a point set d p 1 p i as shown in fig 2 a the maximum distance d max between each point pi of the trajectory and its projection p i on the line between the starting point p s and end point p e is calculated as shown in fig 2 b the farthest point p max is retained if the distance d max exceeds a threshold subsequently the trajectory is split at this position p max as shown in fig 2 c the algorithm is recursively applied to both trajectory subparts as shown in fig 2 d and e only points p s and p e of the trajectory subparts are retained if the distance d max is lower than the threshold 2 1 2 application in ship trajectory as described above the data in the application of dp algorithm corresponds to plane cartesian data however it is not possible to directly use the ship trajectory data which is typically based on the geographic coordinate system in the dp algorithm the calculation of spherical distance is complicated more importantly it is difficult to calculate the distance between a track point and a line based on the geographic coordinate system to calculate point to line we convert the geographical coordinates to the coordinates in mercator projection λ φ denote the geographical coordinates of a track point the coordinates in mercator projection of the track point x y are calculated as follows 1 r 0 a cos φ 0 1 e 2 sin 2 φ 0 2 q ln tan π 4 φ 2 1 e sin φ 1 e sin φ e 2 3 x r 0 λ 4 y r 0 q where the φ and λ denote the latitude and longitude respectively φ 0 represents the standard latitude in mercator projection a represents the long radius of earth ellipsoid e represents the first eccentricity of earth ellipsoid r 0 represents the radius of parallel circle of standard latitude q represents the isometric latitude as mentioned in study spiliopoulos et al 2017b based on the cartesian coordinates the point to line distance can be conveniently calculated through vector method which is shown as follow 5 d i s t a n c e a b a where a denote the vector from the start point of line segment to the end point of line segment b denote the vector from the start point of line segment to the target point 2 1 3 compression performance in the study we evaluated the compression performance from three aspects namely the compression rate rate of length loss and running time of compression compression rate denotes the rate between the number of discarded track points and the number of track points prior to compression the rate of length loss denotes the rate of the length loss and the total length of original trajectories the length of compressed trajectory consisted of fewer track points that are less than the length of the original trajectory a trajectory can be represented as a track point set t p 1 p i and its length t is calculated as follows we assumed that the original track set and compressed track set corresponded to tra original t 1 t j and tra compression t 1 t j the length loss denotes the difference in the total lengths of track sets the rate of length loss is calculated as follows 6 t n 1 i 1 p n p n 1 7 l e n g t h l o s s n 1 j t n n 1 j t n 8 l o s s r a t e l e n g t h l o s s n 1 j t n in our study we consider the length loss rate as the indicator of the quality of trajectory data that is compressed in practical application researchers typically need to process data source with massive position points additionally traversal calculations exist in each iteration of dp algorithm consequently the running time is considered as an important evaluation indicator 2 1 4 threshold as described in section 2 1 1 the threshold is the only parameter that should be determined by the user an increase in the threshold value decreases the accuracy of simplified data the suitability of the threshold for a data source or an accuracy requirement directly decides whether the simplified data can be used for subsequent analysis however the choice of optimal threshold values is difficult and potentially differs across various applications for example zhang et al 2016 used a ship domain as the threshold value for ship route planning trajectory data are collected from various ships the differences in the sizes of ships can lead to differences in the size of the trajectory and this can result in a different threshold for compression for example a big ship mostly sails steadily on open water a track point that is slightly away from the main route does not affect the overall shape of ship trajectory however a small ship typically sails on the small water area and the track point with the aforementioned deviation is more important in retaining the trajectory shape of a small ship therefore if a global threshold that is relatively large suits a big ship then the important track points are discarded in the trajectory of the small ship conversely if a global threshold that is relatively low suits a small ship then several unnecessary track points are retained in the trajectory of the big ship and this leads to the low compression rate consequently we consider the ship size in the selection of threshold value the threshold of individual trajectory is set based on each ship s length individually i e equal to one ship length or 0 5 times of the ship length besides in practical application the water area can be considered in the selection of threshold for instance the ratio in open water can be set larger than the ratio in the small water area and in the area with waterway the maximum of threshold value can be set according to the channel width our practical experience shows that the appropriate ratio of the water area in the vicinity of islands usually ranges from 0 1 times to 10 times additionally for different users the requirement of compression strength varies to a large extent thus the performance evaluation in the application of dp algorithm should consider the variability of the threshold value 2 2 simplification method considering the course of track point 2 2 1 ais trajectory when compared with other line data ais trajectory includes more information related to each point each track point includes information on factors such as its course and speed additionally the ais trajectory corresponds to the historical record of ship movement ships usually sail on the sea with a fixed course and speed and sharp changes are rare the straight part corresponds to a majority of the trajectory and it is easily compressed to a few track points the curve part denotes the trajectory segment of the ship that is subject to change the track points in the curve part exhibit more characteristics of the trajectory shape as shown in fig 3 furthermore curve part can be shown clearly in the form of track points due to the high recording rate of ais 2 2 2 proposed method theory straight part and curve part exhibit different properties the straight part is lengthy while the curve part is laconic and exhibits more characteristics of the trajectory shape however both parts are processed without distinction in the compression process based on the dp algorithm the track points in the straight part are repeatedly determined from the iteration process of the dp algorithm and this implies that most calculations are unnecessary additionally we believe that the transition point between the straight and curve parts is extremely important in maintaining the characteristics of trajectory shape the aforementioned track points should be retained irrespective of how high the compression strength is or how low the radius of turning circle is we present a method for simplifying the ship trajectory that considers the course of the track point this method can recognize the straight and curve parts by detecting the transition point in this method both parts are separately compressed by the dp algorithm and the compression of the straight part is achieved through a few iterations which may significantly reduce the running time of the overall compression furthermore the transition points are directly retained as the start and end points of the track segments this method is shown in algorithm 1 the method consists of two steps namely the partition and compression based on dp algorithm in the first step we use a window with 5 track points to detect the clear turning which may lead to the change in the shape of vessel trajectory the differences in the value of the course between each track point and the fifth track point from it are calculated and denoted as c subsequently the situation of c between each two adjacent track points will be judged if the cs of the two track points are greater than 10 and lesser than 10 respectively then it implies that the aforementioned two track points are located at the transition phase between the straight part and curve part we term the aforementioned track points as transition points it s worth mentioning that the parameters of window are determined based on maritime domain experts and the observation of vessel trajectory data if the size of window is too small the course change in a window may not be very clear for detection if the size is too big that it exceeds the length of most transition phase the result of detection may have a big error in the vessel trajectory data from ais the time interval of track points is 2 3 s and most transition phase in the shape of vessel trajectory has more than 10 track points through the evaluation of multiple tests we believed that the parameters 10 degrees of course change and 5 track points could effectively avoid the mistake of taking the track points in straight part that has the error of course information as the transition points and detect the transition phase with acceptable precision in practical applications multiple transition points may be detected in the same transition phase and this may reduce the compression rate thus we empirically set the interval threshold and the transition points in which the difference in the serial number with its previous transition point is less than or equal to interval threshold is deleted with the exception of the end point with the consideration of the reporting interval in ais international telecommunications union 2010 the interval threshold is set to 50 s in the second step the trajectory segments are output based on the remaining transition points each segment is compressed by the traditional dp algorithm with the threshold separately 3 ais and data material 3 1 automatic identification system all ships corresponding to 300 gross tons and upwards engaged on international voyages cargo ships corresponding to 500 gross tons and upwards and not engaged international waters and passenger ships are required to fit an ais transceiver international maritime organization 1974 ais information includes static dynamic and voyage related messages international telecommunications union 2010 the study focuses on dynamic information each dynamic message contains information on a single track point as shown in table 1 the update rate of dynamic message class a depends on speed and course alteration as shown in table 2 3 2 experimental data source the data was collected in zhou shan islands from january 2015 to february 2015 the study area is presented in fig 4 and table 3 we selected all the class a ais messages as the data source and utilized the maritime mobile service identify mmsi number and time stamps to acquire track point sequence data of all the vessels in this area to remove the errors and improve the data quality those sequence data was preprocessed by partition and deletion of the incorrect track points based on the temporal and spatial attribute which was described in work zhao et al 2018 the processed trajectory data is the experimental data in this experimental as shown in fig 5 the size of the experimental data is given in table 4 table 5 and table 6 list the basic statistical results on the ships in the study 4 experiments and results 4 1 compression experiment in order to demonstrate the compression effects of the proposed method we implement the proposed method based on a month of ais trajectory data in the zhou shan islands in the experiment there are 85 942 008 records of position reports class a from 53768 distinct ship trajectories in which the total distance is 890852 4 nautical miles the threshold value of each trajectory is set equal to the length of ship fig 6 shows the compression result of an ais trajectory when compared with fig 3 the trajectory is split into four segments the track points in each segment are denoted in a different color as shown in the red lines and points in fig 6 b the simplified trajectory consists of few points and is almost identical to the original trajectory after compression 84 305 155 track points are discarded the compression rate corresponds to 98 095 additionally the length loss is 40776 31 nautical miles and this only corresponds to 4 577 of the total distance the simplified trajectories based on a month of data are illustrated in fig 7 density mapping is an important approach in trajectory analysis fig 8 shows a comparison of density distribution between original trajectories and simplified trajectories at resolutions of 0 2 km2 as shown in figs 5 7 and 8 the trajectories that are compressed by our method can retain the basic traffic flow characteristics of the original trajectories additionally the time of the mapping density reduces from 32 17 h to 2 58 h consequently the results indicate that the proposed method is effective in compressing ais trajectories while retaining the characteristics of traffic flow and decreasing the time of the trajectory analysis 4 2 experiment for performance comparison in order to validate the advantages of the proposed method we conduct nine parallel experiments with different thresholds the experimental results of traditional dp algorithm are shown in table 7 the experimental results of the proposed method are shown in table 8 figs 9 11 show a comparison in terms of the compression rate length loss and running time of data compression the results indicate that only a slight difference exists between two methods in the performance of the compression rate the compression rates of both methods increase with increases in the value of the threshold given the length loss the loss caused by using traditional dp algorithm is less when the threshold value is relatively low while the loss caused by using the proposed method is less when the threshold value is relatively high exceeds 1 25 times the ship length additionally as shown in fig 11 the running time of the proposed method in all the experiments is significantly less than the time for the traditional dp algorithm because unnecessary calculations in the compression process are reduced the results indicate that the highest reduction ratio corresponds to 56 96 and the average is 48 92 fig 12 shows the details of the compression results of an ais trajectory in three parallel experiments the comparison indicates that as the increasing of the threshold value more track points can be retained by proposed method when compared to those in the dp algorithm denoted with an arrow thus the characteristics of trajectory shape are increasingly preserved when compared to those in the dp algorithm a certain number of important transition points are selected in the first step of the proposed method and they cannot be discarded irrespective of the threshold value therefore the length loss of proposed method is less when the threshold value is relatively high to further validate the advantages of the proposed method regarding compression time we compared our proposed method with other 3 existing trajectory compression algorithms namely opening window algorithms keogh et al 2001 top down time ratio td tr algorithm and opening window time ratio opw tr algorithm meratnia and rolf 2004 the performance of each algorithm based on the dataset are shown in fig 13 since higher compression rates typically result in slower running time a common compression rate of 99 4 was chosen for each implementation from the fig 13 there was no significant difference in the length loss performance and the proposed method slightly underperform the other algorithms however in the term of running time performance the proposed method has a huge advantage 5 conclusion massive quantities of ais trajectory data are valuable for mining information related to marine traffic however the cost of storing and processing limits their application furthermore the requirements of data compression may differ across various applications this study proposes a method to improve the application of the dp algorithm to a ship trajectory the compression experiment and performance analysis are conducted based on a month of ais trajectory data in zhou shan islands the results indicate that the proposed method can quickly compress the ship trajectory while retaining the characteristics of the original trajectory shape additionally the proposed method can sharply reduce the running time of compression when compared to that of the traditional dp algorithm besides the quality of the simplified trajectory by the proposed method is improved when the threshold is relatively high furthermore the proposed method outperforms the existing algorithms regarding the running time of compression of vessel trajectory consequently the proposed method can better satisfies the needs of practical application which is more focused on running time and data quality at high compression strength future studies will focus on the improvement in compression performance under the condition of a low threshold value acknowledgments this work was partly supported by national natural science foundation of china grant number 51579025 
23109,automatic identification system 3 2 experimental data source 4 experiments and results 4 1 compression experiment 4 2 experiment for performance comparison 5 conclusion acknowledgments devries 2012 13426 13439 g douglas 1973 112 122 d etienne 2012 47 57 l internationalmaritimeorganizationimo 1974 internationalconventionforsafetylifeseasolas internationaltelecommunicationsunionitu 2010 1371 1374 technicalcharacteristicsforautomaticidentificationsystemusingtimedivisionmultipleaccessinvhfmaritimemobileband keogh 2001 289 296 e li 2010 11 13 m li 2016 y 8thinternationalconferencewirelesscommunicationssignalprocessingwcsp15 trajectorycompressionguidedvisualizationspatiotemporalaisvesseldensity meratnia 2004 n internationalconferenceextendingdatabasetechnology765782 spatiotemporalcompressiontechniquesformovingpointobjects mou 2010 483 490 j muckell 2010 j sigspatialinternationalconferenceadvancesingeographicinformationsystems402405 algorithmsforcompressinggpstrajectorydataempiricalevaluation muckell 2014 435 460 j pallotta 2013 2218 2245 g patroumpas 2017 389 427 k qi 2016 l ramer 1972 244 256 u spiliopoulos 2017 g internationalworkshopmobilityanalyticsforspatiotemporalsocialdata109121 abigdatadrivenapproachextractingglobaltradepatterns spiliopoulos 2017 g ieeeinternationalconferencebigdata16821687 knowledgeextractionmaritimespatiotemporaldataevaluationclusteringalgorithmsbigdata wu 2016 67 81 l zhang 2016 729 744 s zhao 2018 1 21 l zhen 2017 492 501 r zhu 2014 59 62 f zhaox2018x37 zhaox2018x37x46 zhaox2018x37xl zhaox2018x37x46xl 2020 08 10t00 00 00 000z 2020 08 10t00 00 00 000z http creativecommons org licenses by nc nd 4 0 2018 elsevier ltd all rights reserved item s0029 8018 18 31487 2 s0029801818314872 1 s2 0 s0029801818314872 10 1016 j oceaneng 2018 08 005 271462 2018 12 17t21 45 53 204549z 2018 10 15 1 s2 0 s0029801818314872 main pdf https s3 amazonaws com prod ucs content store us east content pii s0029801818314872 main application pdf 4d32eee195d693c1543543724b72ab90 main pdf main pdf pdf true 5882826 main 10 1 s2 0 s0029801818314872 main 1 png https s3 amazonaws com prod ucs content store us east content pii s0029801818314872 preview image png 2238c47aec2a437ac2ffcb6a65334810 main 1 png main 1 png png 53234 849 656 image web pdf 1 1 s2 0 s0029801818314872 fx1 sml https s3 amazonaws com prod ucs content store us east content pii s0029801818314872 fx1 thumbnail image gif cbc441fbfa8ce6f6f7aae36832963bcd fx1 sml fx1 fx1 sml sml 11282 164 58 image thumbnail 1 s2 0 s0029801818314872 gr1 sml https s3 amazonaws com prod ucs content store us east content pii s0029801818314872 gr1 thumbnail image gif 8121c3582a5b1ea76c00ccef76b21b96 gr1 sml gr1 gr1 sml sml 17505 164 175 image thumbnail 1 s2 0 s0029801818314872 gr10 sml https s3 amazonaws com prod ucs content store us east content pii s0029801818314872 gr10 thumbnail image gif 655cd93d243899876bfdc0bd96f259a5 gr10 sml gr10 gr10 sml sml 16122 157 219 image thumbnail 1 s2 0 s0029801818314872 gr11 sml https s3 amazonaws com prod ucs content store us east content pii s0029801818314872 gr11 thumbnail image gif 7e59a86747a26452809c082816299e84 gr11 sml gr11 gr11 sml sml 13646 145 219 image thumbnail 1 s2 0 s0029801818314872 gr12a sml https s3 amazonaws com prod ucs content store us east content pii s0029801818314872 gr12a thumbnail image gif deaa8f5e28698ad954730fe22b83c866 gr12a sml gr12a gr12a sml sml 12542 164 63 image thumbnail 1 s2 0 s0029801818314872 gr12b sml https s3 amazonaws com prod ucs content store us east content pii s0029801818314872 gr12b thumbnail image gif dbb663c9276fe681aa1f09cd4c951f78 gr12b sml gr12b gr12b sml sml 18782 164 124 image thumbnail 1 s2 0 s0029801818314872 gr13 sml https s3 amazonaws com prod ucs content store us east content pii s0029801818314872 gr13 thumbnail image gif ee32fa328d08fb0918ab0b6f4ebc2310 gr13 sml gr13 gr13 sml sml 12898 164 126 image thumbnail 1 s2 0 s0029801818314872 gr2 sml https s3 amazonaws com prod ucs content store us east content pii s0029801818314872 gr2 thumbnail image gif ab96db0c8179f0b6631596b16d287161 gr2 sml gr2 gr2 sml sml 14489 164 116 image thumbnail 1 s2 0 s0029801818314872 gr3 sml https s3 amazonaws com prod ucs content store us east content pii s0029801818314872 gr3 thumbnail image gif 60e12f2b69e07750bdc1bd88f80c8ca3 gr3 sml gr3 gr3 sml sml 18512 121 219 image thumbnail 1 s2 0 s0029801818314872 gr4 sml https s3 amazonaws com prod ucs content store us east content pii s0029801818314872 gr4 thumbnail image gif 9661f0ce6ef20e95746f42eed0a3b8ac gr4 sml gr4 gr4 sml sml 32653 152 219 image thumbnail 1 s2 0 s0029801818314872 gr5 sml https s3 amazonaws com prod ucs content store us east content pii s0029801818314872 gr5 thumbnail image gif 0e158ba26dc5fd1d2a48bb8ecd0e7581 gr5 sml gr5 gr5 sml sml 40033 133 219 image thumbnail 1 s2 0 s0029801818314872 gr6 sml https s3 amazonaws com prod ucs content store us east content pii s0029801818314872 gr6 thumbnail image gif 1160de57efa045613e8e02e27cb982bf gr6 sml gr6 gr6 sml sml 17261 163 131 image thumbnail 1 s2 0 s0029801818314872 gr7 sml https s3 amazonaws com prod ucs content store us east content pii s0029801818314872 gr7 thumbnail image gif efa40490884c0ab4272946453310e9bc gr7 sml gr7 gr7 sml sml 38364 130 219 image thumbnail 1 s2 0 s0029801818314872 gr8 sml https s3 amazonaws com prod ucs content store us east content pii s0029801818314872 gr8 thumbnail image gif be97ee135dd73d7dae5d9e0e124c2533 gr8 sml gr8 gr8 sml sml 33533 164 127 image thumbnail 1 s2 0 s0029801818314872 gr9 sml https s3 amazonaws com prod ucs content store us east content pii s0029801818314872 gr9 thumbnail image gif 21869c078534311c653d8ebcb601dcfc gr9 sml gr9 gr9 sml sml 16437 146 219 image thumbnail 1 s2 0 s0029801818314872 fx1 jpg https s3 amazonaws com prod ucs content store us east content pii s0029801818314872 fx1 downsampled image jpeg d2c1ba6ec3f6003f2b4351dbae59a246 fx1 jpg fx1 fx1 jpg jpg 140105 1006 356 image downsampled 1 s2 0 s0029801818314872 gr1 jpg https s3 amazonaws com prod ucs content store us east content pii s0029801818314872 gr1 downsampled image jpeg b96e278643c7e7b7b90f379e5c2d4f2d gr1 jpg gr1 gr1 jpg jpg 53736 340 363 image downsampled 1 s2 0 s0029801818314872 gr10 jpg https s3 amazonaws com prod ucs content store us east content pii s0029801818314872 gr10 downsampled image jpeg 3a1a637b03582625e48feeda9662a7ac gr10 jpg gr10 gr10 jpg jpg 49353 259 362 image downsampled 1 s2 0 s0029801818314872 gr11 jpg https s3 amazonaws com prod ucs content store us east content pii s0029801818314872 gr11 downsampled image jpeg 6baa7cc42d3ade7d5a9e490c53625bf1 gr11 jpg gr11 gr11 jpg jpg 44054 247 374 image downsampled 1 s2 0 s0029801818314872 gr12a jpg https s3 amazonaws com prod ucs content store us east content pii s0029801818314872 gr12a downsampled image jpeg ffcce8ce48ca7ed58999d500356de4bd gr12a jpg gr12a gr12a jpg jpg 139604 1008 388 image downsampled 1 s2 0 s0029801818314872 gr12b jpg https s3 amazonaws com prod ucs content store us east content pii s0029801818314872 gr12b downsampled image jpeg fdeb487e879ac83ab25709c1265291c2 gr12b jpg gr12b gr12b jpg jpg 83978 499 378 image downsampled 1 s2 0 s0029801818314872 gr13 jpg https s3 amazonaws com prod ucs content store us east content pii s0029801818314872 gr13 downsampled image jpeg e0b5f960320f78a8d6ee798f5cea0eba gr13 jpg gr13 gr13 jpg jpg 61341 493 379 image downsampled 1 s2 0 s0029801818314872 gr2 jpg https s3 amazonaws com prod ucs content store us east content pii s0029801818314872 gr2 downsampled image jpeg 80c69bfc0c9070e2a917b209118a3d25 gr2 jpg gr2 gr2 jpg jpg 74263 521 369 image downsampled 1 s2 0 s0029801818314872 gr3 jpg https s3 amazonaws com prod ucs content store us east content pii s0029801818314872 gr3 downsampled image jpeg 05449a0dc114fd8327cae99ab1d308b6 gr3 jpg gr3 gr3 jpg jpg 46796 209 379 image downsampled 1 s2 0 s0029801818314872 gr4 jpg https s3 amazonaws com prod ucs content store us east content pii s0029801818314872 gr4 downsampled image jpeg 64be9044f55373c722e0c1ef4cc57b36 gr4 jpg gr4 gr4 jpg jpg 56928 241 346 image downsampled 1 s2 0 s0029801818314872 gr5 jpg https s3 amazonaws com prod ucs content store us east content pii s0029801818314872 gr5 downsampled image jpeg a0cc0093b99c8b23a545620377d4d15f gr5 jpg gr5 gr5 jpg jpg 129919 303 500 image downsampled 1 s2 0 s0029801818314872 gr6 jpg https s3 amazonaws com prod ucs content store us east content pii s0029801818314872 gr6 downsampled image jpeg 5f24671a3cef88eeddd722eef2c9f83e gr6 jpg gr6 gr6 jpg jpg 71167 462 371 image downsampled 1 s2 0 s0029801818314872 gr7 jpg https s3 amazonaws com prod ucs content store us east content pii s0029801818314872 gr7 downsampled image jpeg 677b5030066cf7121eae7d2b589df15f gr7 jpg gr7 gr7 jpg jpg 224372 421 707 image downsampled 1 s2 0 s0029801818314872 gr8 jpg https s3 amazonaws com prod ucs content store us east content pii s0029801818314872 gr8 downsampled image jpeg 896098ddef4ed61b689df1ca00795ce9 gr8 jpg gr8 gr8 jpg jpg 452686 982 762 image downsampled 1 s2 0 s0029801818314872 gr9 jpg https s3 amazonaws com prod ucs content store us east content pii s0029801818314872 gr9 downsampled image jpeg 06e35c605aced8a9780194654a8ac7ff gr9 jpg gr9 gr9 jpg jpg 50348 248 371 image downsampled 1 s2 0 s0029801818314872 fx1 lrg jpg https s3 amazonaws com prod ucs content store us east content pii s0029801818314872 fx1 highres image jpeg e2d12be070df481e6e85b34f719ff647 fx1 lrg jpg fx1 fx1 lrg jpg jpg 1046257 4455 1577 image high res 1 s2 0 s0029801818314872 gr1 lrg jpg https s3 amazonaws com prod ucs content store us east content pii s0029801818314872 gr1 highres image jpeg e36233331e65ce77bab7e3297f3a7415 gr1 lrg jpg gr1 gr1 lrg jpg jpg 295385 1506 1607 image high res 1 s2 0 s0029801818314872 gr10 lrg jpg https s3 amazonaws com prod ucs content store us east content pii s0029801818314872 gr10 highres image jpeg ec14d5bf9b05d8ff050f8555da3a8bc7 gr10 lrg jpg gr10 gr10 lrg jpg jpg 221816 1146 1602 image high res 1 s2 0 s0029801818314872 gr11 lrg jpg https s3 amazonaws com prod ucs content store us east content pii s0029801818314872 gr11 highres image jpeg 3e5d0a44107b8ec9b5e4a0b79ca9e48e gr11 lrg jpg gr11 gr11 lrg jpg jpg 187244 1096 1659 image high res 1 s2 0 s0029801818314872 gr12a lrg jpg https s3 amazonaws com prod ucs content store us east content pii s0029801818314872 gr12a highres image jpeg b452512d30988c6b005a771affa612a7 gr12a lrg jpg gr12a gr12a lrg jpg jpg 981369 4465 1718 image high res 1 s2 0 s0029801818314872 gr12b lrg jpg https s3 amazonaws com prod ucs content store us east content pii s0029801818314872 gr12b highres image jpeg 436749cac2d0269190260ec899a20186 gr12b lrg jpg gr12b gr12b lrg jpg jpg 521375 2211 1676 image high res 1 s2 0 s0029801818314872 gr13 lrg jpg https s3 amazonaws com prod ucs content store us east content pii s0029801818314872 gr13 highres image jpeg 84d76beb006084dd573d0846c849ab12 gr13 lrg jpg gr13 gr13 lrg jpg jpg 332323 2184 1678 image high res 1 s2 0 s0029801818314872 gr2 lrg jpg https s3 amazonaws com prod ucs content store us east content pii s0029801818314872 gr2 highres image jpeg ebcbfb50275a52dca8595500dc7ce8f5 gr2 lrg jpg gr2 gr2 lrg jpg jpg 445124 2309 1634 image high res 1 s2 0 s0029801818314872 gr3 lrg jpg https s3 amazonaws com prod ucs content store us east content pii s0029801818314872 gr3 highres image jpeg 191464c86bb4367044973dcc1ef9633a gr3 lrg jpg gr3 gr3 lrg jpg jpg 252876 926 1681 image high res 1 s2 0 s0029801818314872 gr4 lrg jpg https s3 amazonaws com prod ucs content store us east content pii s0029801818314872 gr4 highres image jpeg 037e981df9c839bd94f26ed5e721b60f gr4 lrg jpg gr4 gr4 lrg jpg jpg 347198 1068 1535 image high res 1 s2 0 s0029801818314872 gr5 lrg jpg https s3 amazonaws com prod ucs content store us east content pii s0029801818314872 gr5 highres image jpeg 2116f116e5998bc086ae5e1da31401c0 gr5 lrg jpg gr5 gr5 lrg jpg jpg 1091546 1339 2213 image high res 1 s2 0 s0029801818314872 gr6 lrg jpg https s3 amazonaws com prod ucs content store us east content pii s0029801818314872 gr6 highres image jpeg cf58864a43c5906576929675ce16c525 gr6 lrg jpg gr6 gr6 lrg jpg jpg 442979 2050 1645 image high res 1 s2 0 s0029801818314872 gr7 lrg jpg https s3 amazonaws com prod ucs content store us east content pii s0029801818314872 gr7 highres image jpeg 868f6425e63d315431f304052f104a6c gr7 lrg jpg gr7 gr7 lrg jpg jpg 1948292 1863 3131 image high res 1 s2 0 s0029801818314872 gr8 lrg jpg https s3 amazonaws com prod ucs content store us east content pii s0029801818314872 gr8 highres image jpeg e3c917ce87edc62d8595dcfcf33f3bb0 gr8 lrg jpg gr8 gr8 lrg jpg jpg 3931490 4349 3376 image high res 1 s2 0 s0029801818314872 gr9 lrg jpg https s3 amazonaws com prod ucs content store us east content pii s0029801818314872 gr9 highres image jpeg 07eedb878caa6272a8821d6c67b467ea gr9 lrg jpg gr9 gr9 lrg jpg jpg 212348 1099 1644 image high res 1 s2 0 s0029801818314872 si1 gif https s3 amazonaws com prod ucs content store us east content pii s0029801818314872 stripin image gif f96c8dfdd06abf549cd8d8badcd0e3bc si1 gif si1 si1 gif gif 3069 31 91 altimg 1 s2 0 s0029801818314872 si2 gif https s3 amazonaws com prod ucs content store us east content pii s0029801818314872 stripin image gif 6ae8d7dfa82884bf975560670b8a9b5e si2 gif si2 si2 gif gif 3451 42 204 altimg 1 s2 0 s0029801818314872 si3 gif https s3 amazonaws com prod ucs content store us east content pii s0029801818314872 stripin image gif 091e0cff17845de5f1b3346e7a518151 si3 gif si3 si3 gif gif 2818 13 50 altimg 1 s2 0 s0029801818314872 si4 gif https s3 amazonaws com prod ucs content store us east content pii s0029801818314872 stripin image gif 60435fab15c7151bfde157c44e69d32a si4 gif si4 si4 gif gif 2820 13 45 altimg 1 s2 0 s0029801818314872 si5 gif https s3 amazonaws com prod ucs content store us east content pii s0029801818314872 stripin image gif a8a86d54c6fe19bd8d622355734a7ba7 si5 gif si5 si5 gif gif 3006 29 97 altimg 1 s2 0 s0029801818314872 si6 gif https s3 amazonaws com prod ucs content store us east content pii s0029801818314872 stripin image gif df2021390e21c6fb40e357089bda5268 si6 gif si6 si6 gif gif 3006 18 119 altimg 1 s2 0 s0029801818314872 si7 gif https s3 amazonaws com prod ucs content store us east content pii s0029801818314872 stripin image gif ca2e03f549a668da8f15580e9fbc21f8 si7 gif si7 si7 gif gif 3268 21 221 altimg 1 s2 0 s0029801818314872 si8 gif https s3 amazonaws com prod ucs content store us east content pii s0029801818314872 stripin image gif bb8b4488a76ee39fd2ef402a80123a90 si8 gif si8 si8 gif gif 3081 26 128 altimg oe 5410 s0029 8018 18 31487 2 10 1016 j oceaneng 2018 08 005 elsevier ltd fig 1 dp algorithm theory fig 1 fig 2 schematic of the dp algorithm fig 2 fig 3 straight and curve parts in a ship trajectory fig 3 fig 4 range of the study area fig 4 fig 5 experimental data based on the ais from zhou shan islands january 2015 fig 5 fig 6 compression result of an ais trajectory fig 6 fig 7 simplified trajectory map based on the ais data for zhou shan islands january 2015 fig 7 fig 8 comparison of the density map based on the original trajectories and simplified trajectories fig 8 fig 9 comparison of the compression rate fig 9 fig 10 comparison of the length loss fig 10 fig 11 comparison of the running time fig 11 fig 12 compression results of an ais trajectory in the three parallel experiments fig 12 fig 13 comparison result of proposed method and other existing trajectory compression algorithm fig 13 table 1 contents of dynamic message table 1 contents description navigational status status including under way using engine and at anchor etc rot rate of turn sog speed over ground longitude position information latitude position information cog course over ground th true heading table 2 message update rate table 2 types of ships reporting interval ship at anchor or moored and not moving faster than 3 knots 3 min ship at anchor or moored and moving faster than 3 knots 10 s ship with a speed between 0 and 14 knots 10 s ship with a speed between 0 and 14 knots and changing course 3 1 3 s ship with a speed between 14 and 23 knots 6 s ship with a speed between 14 and 23 knots and changing course 2 s ship with a speed exceeding 23 knots 2 s ship with a speed exceeding 23 knots and changing course 2 s table 3 range of the study area table 3 boundary point longitude latitude left bottomright top 121 583326122 799995 29 59993 30 333317 table 4 size of the experimental data table 4 number of position messages number of ships number of trajectories 87434689 5665 53768 table 5 ship type table 5 type number of ships proportion fishing ship 30 0 530 passenger ship 160 2 824 cargo ship 3568 62 983 tanker 980 17 299 other ship 927 16 364 table 6 ship length table 6 length number of ships proportion less than 50 m 310 5 472 50 m 100 m 1883 33 239 100 m 150 m 1282 22 630 150 m 200 m 728 12 851 larger than 200 m 962 16 981 null or invalid 500 8 826 table 7 performance results of compression by the dp algorithm table 7 threshold times the ship length discarded records compression rate length loss nm loss rate running time s 0 1 74686462 86 903 9890 95 1 110 66646 23 0 2 79158715 92 107 20139 44 2 261 50764 37 0 5 83099864 96 693 34980 44 3 927 25617 12 0 8 83913246 97 639 37644 4 4 226 22234 94 1 84519920 98 345 40567 02 4 554 18779 27 1 25 84815084 98 689 42376 9 4 757 15481 91 2 85124335 99 049 45431 35 5 100 12818 84 5 85467446 99 448 52778 63 5 925 10975 87 10 85608372 99 612 62553 6 7 022 10691 32 table 8 performance results of compression by the proposed method table 8 threshold times the ship length discarded records compression rate length loss nm loss rate running time s 0 1 74759286 86 988 11438 85 1 284 37724 96 0 2 79101946 92 041 21091 73 2 368 29229 82 0 5 82923687 96 488 35383 6 3 972 13809 04 0 8 83695539 97 386 37801 65 4 243 12069 8 1 84305155 98 095 40776 31 4 577 9110 86 1 25 84573514 98 408 42412 09 4 761 7819 99 2 84871795 98 755 45262 85 5 081 6194 11 5 85200506 99 137 52578 43 5 902 5157 77 10 85332847 99 291 62204 89 6 983 4601 62 a method for simplifying ship trajectory based on improved douglas peucker algorithm liangbin zhao guoyou shi navigation college dalian maritime university 1 linghai road dalian liaoning china navigation college dalian maritime university 1 linghai road dalian liaoning china corresponding author automatic identification system ais can provide massive ship trajectory data that is valuable for mining information in water traffic however large sizes lead to difficulties in storing querying and processing the aforementioned data in the present study to better compress ship trajectory data regarding compression time and efficiency a method based on the improved douglas peucker dp algorithm is presented in the process of compression the proposed method considers the shape of vessel trajectory derived from course information of track points parallel experiments are conducted based on ais data gathered over the duration of a month in the chinese zhou shan islands the results indicate that this method can effectively compress ship trajectory information additionally when compared with the traditional dp algorithm this method can significantly reduce the compression time and exhibits better performance at high compression strengths also the proposed method outperforms other existing trajectory compression algorithms in term of compression time keywords water traffic ship trajectory automatic identification system ais trajectory compression douglas peucker algorithm 1 introduction recently the value of ship trajectory data has increased thousands of ships sail around the world daily their mobility results in water traffic which is a phenomenon that shows the behavioral patterns of ships these patterns may support managers in the field of maritime supervision and management automatic identification system ais is an automatic tracking system for identifying and locating ships by exchanging data with other nearby ships and ais base stations increasing research in the maritime field is focused on ais data mining given the fast development of ais terminal network data storage and data collection capacity several studies based on ais data aim at various purposes including visualization for detecting spatial distribution regularities in ships abnormal ship identification for maritime control and decision making for collision avoidance wu et al 2016 created the maps of shipping density on a global scale with over 2 5 years of ais data they computed the average number of vessels crossing each grid per unit time and 21 162 882 025 pieces of ais data costs 16 h pallotta et al 2013 presented an unsupervised and incremental learning approach for extracting vessel movement patterns their aim involved converting a large amount of ais data into information supporting decisions two months of ais traffic data in strait of gibraltar and three months of satellite ais position data over the indian ocean are collected for pattern training and testing mou et al 2010 used ais data in studies on ship collision avoidance in busy waterways in the study a period corresponding to 62 days of data during june july and august 2007 in the north sea was analyzed to calculate important parameters such as the closest point of approach cpa and time to the cpa tcpa zhen et al 2017 utilized ais data and clustering method to obtain the clusters of encounter vessels and then constructed the semantic and mathematical relationship of vessel collision risk index for each cluster of encounter vessels with dcpa distance to closest point and tcap a common task for all the ais data studies corresponds to preprocessing massive historical records an ais message is transmitted by a ship at frequent intervals of approximately 3 10 s however the frequency of the clear change in speed and course is significantly lower than the recording rate consequently most information in the raw ais data is redundant in ais trajectories that consist of massive similar track points to reduce the cost of storage and computing in data processing and to satisfy the response time requirement compression of the vessel trajectory data is usually used before the detailed application qi and zheng 2016 proposed a method for recognizing the vessel course alteration and extracting the representative point of a ship trajectory spiliopoulos et al 2017a described an approach which is based on clustering technique and distributed processing technique to transform billions of records of spatiotemporal ais data into information for understanding the patterns of global trade patroumpas et al 2017 presented a system to extract trajectory synopses from the incoming ais positions retaining salient movement features only their method can instantly identify critical point along each trajectory such as a stop a turn or slow motion therefore they may discard redundant locations along a normal course and approximately reconstruct each vessel trajectory from such a synopsis consisting of critical points only a ship trajectory in the small area is considered as line data in two dimensional plane the douglas peucker dp algorithm douglas and peucker 1973 ramer 1972 was considered as one of the most accurate and effective methods to compress line data meratnia and rolf 2004 muckell et al 2010 2014 and was widely adopted in compression of moving object trajectory in terms of dp based compression of vessel trajectory etienne et al 2012 used the dp algorithm filter to reduce the number of positions of a trajectory while retaining only the important positions their purpose involved optimizing the computation time of the traffic flow pattern identification they conducted an experiment based on 104 201 records of 506 trajectories and the compression rate was 84 54 for a threshold of 10 m the precision of a gps device li et al 2010 proposed a method that considered the time attribute of ship trajectory they considered a ship trajectory as line data in three dimensional space an experimental result based on 30 000 records indicated that the method can retain additional feature points that may preserve more information about the speed of trajectory zhu et al 2014 conducted a similar study de vries and van someren 2012 adapted the dp algorithm to better retain stop and move information on the ship trajectory zhang et al 2016 presented a method to select a suitable threshold for ais trajectory based on determining the maximum value that can ensure that the track point of simplified trajectory is within the safety scope of the corresponding original track point thus the calculated ship domain in the navigational situations is used as the threshold value after the experiment based on 5 902 840 records from 962 ships in chinese qiong zhou strait the result revealed that the compression rate corresponded to 98 25 with a threshold set as 0 8 times the ship length li et al 2016 conducted several experiments to select an appropriate threshold that can guarantee a good balance between ais trajectory simplification and visualization quality the experimental ais data included 29 015 coordinate points from 187 vessels running time and compression rate are the two important indicators of compression result compression at high strength costs less time and retains less data and compression at low strength costs more time and retains more data in practical applications the requirement varies to a large extent for different users for example the identification of ship dynamic parameters and statistical analysis of maritime traffic requires more details in the data while the data in visualization analysis should be minimized to the maximum possible extent under the condition of maintaining data quality additionally studies on mapping trajectory with different scales exhibit different requirements of data quality furthermore while dealing with large datasets the running time is an important consideration factor that should not be neglected by users however previous studies do not sufficiently discuss the problem of running time and compressed data quality at high compression strengths in dp algorithm to better apply dp algorithm to ship trajectory compression under the requirements in which the algorithm may utilize considerable time or a high compression strength this study proposes a method that incorporates the course change in the ship trajectory and dp algorithm when compared with the performances of the traditional dp algorithm the proposed method can significantly reduce the running time at the same level of compression strength and additionally exhibits improved compressed data quality at high compression strength also the proposed method outperforms other existing trajectory compression algorithms in term of compression time additionally ship trajectory data which is based on the geographic coordinate system cannot be used directly in the dp algorithm which is based on the cartesian coordinates system in the proposed method the mercator projection coordinate is applied to solve this problem the remainder of this paper is organized as follows in section 2 the method for simplifying ship trajectory based on dp algorithm is introduced in section 3 we introduce ais data and the basic information on the data source in the study section 4 shows the experimental results and the conclusions are discussed in section 5 2 simplification method for ship trajectory 2 1 douglas peucker algorithm 2 1 1 algorithm theory the dp algorithm was presented by d douglas and t peucker in 1973 the algorithm splits the line data recursively and controls the compression quality by the threshold and it is widely used in simplifying the trajectory of moving point objects due to its speed and accuracy the algorithm theory is illustrated in fig 1 an ais trajectory is represented as a point set d p 1 p i as shown in fig 2 a the maximum distance d max between each point pi of the trajectory and its projection p i on the line between the starting point p s and end point p e is calculated as shown in fig 2 b the farthest point p max is retained if the distance d max exceeds a threshold subsequently the trajectory is split at this position p max as shown in fig 2 c the algorithm is recursively applied to both trajectory subparts as shown in fig 2 d and e only points p s and p e of the trajectory subparts are retained if the distance d max is lower than the threshold 2 1 2 application in ship trajectory as described above the data in the application of dp algorithm corresponds to plane cartesian data however it is not possible to directly use the ship trajectory data which is typically based on the geographic coordinate system in the dp algorithm the calculation of spherical distance is complicated more importantly it is difficult to calculate the distance between a track point and a line based on the geographic coordinate system to calculate point to line we convert the geographical coordinates to the coordinates in mercator projection λ φ denote the geographical coordinates of a track point the coordinates in mercator projection of the track point x y are calculated as follows 1 r 0 a cos φ 0 1 e 2 sin 2 φ 0 2 q ln tan π 4 φ 2 1 e sin φ 1 e sin φ e 2 3 x r 0 λ 4 y r 0 q where the φ and λ denote the latitude and longitude respectively φ 0 represents the standard latitude in mercator projection a represents the long radius of earth ellipsoid e represents the first eccentricity of earth ellipsoid r 0 represents the radius of parallel circle of standard latitude q represents the isometric latitude as mentioned in study spiliopoulos et al 2017b based on the cartesian coordinates the point to line distance can be conveniently calculated through vector method which is shown as follow 5 d i s t a n c e a b a where a denote the vector from the start point of line segment to the end point of line segment b denote the vector from the start point of line segment to the target point 2 1 3 compression performance in the study we evaluated the compression performance from three aspects namely the compression rate rate of length loss and running time of compression compression rate denotes the rate between the number of discarded track points and the number of track points prior to compression the rate of length loss denotes the rate of the length loss and the total length of original trajectories the length of compressed trajectory consisted of fewer track points that are less than the length of the original trajectory a trajectory can be represented as a track point set t p 1 p i and its length t is calculated as follows we assumed that the original track set and compressed track set corresponded to tra original t 1 t j and tra compression t 1 t j the length loss denotes the difference in the total lengths of track sets the rate of length loss is calculated as follows 6 t n 1 i 1 p n p n 1 7 l e n g t h l o s s n 1 j t n n 1 j t n 8 l o s s r a t e l e n g t h l o s s n 1 j t n in our study we consider the length loss rate as the indicator of the quality of trajectory data that is compressed in practical application researchers typically need to process data source with massive position points additionally traversal calculations exist in each iteration of dp algorithm consequently the running time is considered as an important evaluation indicator 2 1 4 threshold as described in section 2 1 1 the threshold is the only parameter that should be determined by the user an increase in the threshold value decreases the accuracy of simplified data the suitability of the threshold for a data source or an accuracy requirement directly decides whether the simplified data can be used for subsequent analysis however the choice of optimal threshold values is difficult and potentially differs across various applications for example zhang et al 2016 used a ship domain as the threshold value for ship route planning trajectory data are collected from various ships the differences in the sizes of ships can lead to differences in the size of the trajectory and this can result in a different threshold for compression for example a big ship mostly sails steadily on open water a track point that is slightly away from the main route does not affect the overall shape of ship trajectory however a small ship typically sails on the small water area and the track point with the aforementioned deviation is more important in retaining the trajectory shape of a small ship therefore if a global threshold that is relatively large suits a big ship then the important track points are discarded in the trajectory of the small ship conversely if a global threshold that is relatively low suits a small ship then several unnecessary track points are retained in the trajectory of the big ship and this leads to the low compression rate consequently we consider the ship size in the selection of threshold value the threshold of individual trajectory is set based on each ship s length individually i e equal to one ship length or 0 5 times of the ship length besides in practical application the water area can be considered in the selection of threshold for instance the ratio in open water can be set larger than the ratio in the small water area and in the area with waterway the maximum of threshold value can be set according to the channel width our practical experience shows that the appropriate ratio of the water area in the vicinity of islands usually ranges from 0 1 times to 10 times additionally for different users the requirement of compression strength varies to a large extent thus the performance evaluation in the application of dp algorithm should consider the variability of the threshold value 2 2 simplification method considering the course of track point 2 2 1 ais trajectory when compared with other line data ais trajectory includes more information related to each point each track point includes information on factors such as its course and speed additionally the ais trajectory corresponds to the historical record of ship movement ships usually sail on the sea with a fixed course and speed and sharp changes are rare the straight part corresponds to a majority of the trajectory and it is easily compressed to a few track points the curve part denotes the trajectory segment of the ship that is subject to change the track points in the curve part exhibit more characteristics of the trajectory shape as shown in fig 3 furthermore curve part can be shown clearly in the form of track points due to the high recording rate of ais 2 2 2 proposed method theory straight part and curve part exhibit different properties the straight part is lengthy while the curve part is laconic and exhibits more characteristics of the trajectory shape however both parts are processed without distinction in the compression process based on the dp algorithm the track points in the straight part are repeatedly determined from the iteration process of the dp algorithm and this implies that most calculations are unnecessary additionally we believe that the transition point between the straight and curve parts is extremely important in maintaining the characteristics of trajectory shape the aforementioned track points should be retained irrespective of how high the compression strength is or how low the radius of turning circle is we present a method for simplifying the ship trajectory that considers the course of the track point this method can recognize the straight and curve parts by detecting the transition point in this method both parts are separately compressed by the dp algorithm and the compression of the straight part is achieved through a few iterations which may significantly reduce the running time of the overall compression furthermore the transition points are directly retained as the start and end points of the track segments this method is shown in algorithm 1 the method consists of two steps namely the partition and compression based on dp algorithm in the first step we use a window with 5 track points to detect the clear turning which may lead to the change in the shape of vessel trajectory the differences in the value of the course between each track point and the fifth track point from it are calculated and denoted as c subsequently the situation of c between each two adjacent track points will be judged if the cs of the two track points are greater than 10 and lesser than 10 respectively then it implies that the aforementioned two track points are located at the transition phase between the straight part and curve part we term the aforementioned track points as transition points it s worth mentioning that the parameters of window are determined based on maritime domain experts and the observation of vessel trajectory data if the size of window is too small the course change in a window may not be very clear for detection if the size is too big that it exceeds the length of most transition phase the result of detection may have a big error in the vessel trajectory data from ais the time interval of track points is 2 3 s and most transition phase in the shape of vessel trajectory has more than 10 track points through the evaluation of multiple tests we believed that the parameters 10 degrees of course change and 5 track points could effectively avoid the mistake of taking the track points in straight part that has the error of course information as the transition points and detect the transition phase with acceptable precision in practical applications multiple transition points may be detected in the same transition phase and this may reduce the compression rate thus we empirically set the interval threshold and the transition points in which the difference in the serial number with its previous transition point is less than or equal to interval threshold is deleted with the exception of the end point with the consideration of the reporting interval in ais international telecommunications union 2010 the interval threshold is set to 50 s in the second step the trajectory segments are output based on the remaining transition points each segment is compressed by the traditional dp algorithm with the threshold separately 3 ais and data material 3 1 automatic identification system all ships corresponding to 300 gross tons and upwards engaged on international voyages cargo ships corresponding to 500 gross tons and upwards and not engaged international waters and passenger ships are required to fit an ais transceiver international maritime organization 1974 ais information includes static dynamic and voyage related messages international telecommunications union 2010 the study focuses on dynamic information each dynamic message contains information on a single track point as shown in table 1 the update rate of dynamic message class a depends on speed and course alteration as shown in table 2 3 2 experimental data source the data was collected in zhou shan islands from january 2015 to february 2015 the study area is presented in fig 4 and table 3 we selected all the class a ais messages as the data source and utilized the maritime mobile service identify mmsi number and time stamps to acquire track point sequence data of all the vessels in this area to remove the errors and improve the data quality those sequence data was preprocessed by partition and deletion of the incorrect track points based on the temporal and spatial attribute which was described in work zhao et al 2018 the processed trajectory data is the experimental data in this experimental as shown in fig 5 the size of the experimental data is given in table 4 table 5 and table 6 list the basic statistical results on the ships in the study 4 experiments and results 4 1 compression experiment in order to demonstrate the compression effects of the proposed method we implement the proposed method based on a month of ais trajectory data in the zhou shan islands in the experiment there are 85 942 008 records of position reports class a from 53768 distinct ship trajectories in which the total distance is 890852 4 nautical miles the threshold value of each trajectory is set equal to the length of ship fig 6 shows the compression result of an ais trajectory when compared with fig 3 the trajectory is split into four segments the track points in each segment are denoted in a different color as shown in the red lines and points in fig 6 b the simplified trajectory consists of few points and is almost identical to the original trajectory after compression 84 305 155 track points are discarded the compression rate corresponds to 98 095 additionally the length loss is 40776 31 nautical miles and this only corresponds to 4 577 of the total distance the simplified trajectories based on a month of data are illustrated in fig 7 density mapping is an important approach in trajectory analysis fig 8 shows a comparison of density distribution between original trajectories and simplified trajectories at resolutions of 0 2 km2 as shown in figs 5 7 and 8 the trajectories that are compressed by our method can retain the basic traffic flow characteristics of the original trajectories additionally the time of the mapping density reduces from 32 17 h to 2 58 h consequently the results indicate that the proposed method is effective in compressing ais trajectories while retaining the characteristics of traffic flow and decreasing the time of the trajectory analysis 4 2 experiment for performance comparison in order to validate the advantages of the proposed method we conduct nine parallel experiments with different thresholds the experimental results of traditional dp algorithm are shown in table 7 the experimental results of the proposed method are shown in table 8 figs 9 11 show a comparison in terms of the compression rate length loss and running time of data compression the results indicate that only a slight difference exists between two methods in the performance of the compression rate the compression rates of both methods increase with increases in the value of the threshold given the length loss the loss caused by using traditional dp algorithm is less when the threshold value is relatively low while the loss caused by using the proposed method is less when the threshold value is relatively high exceeds 1 25 times the ship length additionally as shown in fig 11 the running time of the proposed method in all the experiments is significantly less than the time for the traditional dp algorithm because unnecessary calculations in the compression process are reduced the results indicate that the highest reduction ratio corresponds to 56 96 and the average is 48 92 fig 12 shows the details of the compression results of an ais trajectory in three parallel experiments the comparison indicates that as the increasing of the threshold value more track points can be retained by proposed method when compared to those in the dp algorithm denoted with an arrow thus the characteristics of trajectory shape are increasingly preserved when compared to those in the dp algorithm a certain number of important transition points are selected in the first step of the proposed method and they cannot be discarded irrespective of the threshold value therefore the length loss of proposed method is less when the threshold value is relatively high to further validate the advantages of the proposed method regarding compression time we compared our proposed method with other 3 existing trajectory compression algorithms namely opening window algorithms keogh et al 2001 top down time ratio td tr algorithm and opening window time ratio opw tr algorithm meratnia and rolf 2004 the performance of each algorithm based on the dataset are shown in fig 13 since higher compression rates typically result in slower running time a common compression rate of 99 4 was chosen for each implementation from the fig 13 there was no significant difference in the length loss performance and the proposed method slightly underperform the other algorithms however in the term of running time performance the proposed method has a huge advantage 5 conclusion massive quantities of ais trajectory data are valuable for mining information related to marine traffic however the cost of storing and processing limits their application furthermore the requirements of data compression may differ across various applications this study proposes a method to improve the application of the dp algorithm to a ship trajectory the compression experiment and performance analysis are conducted based on a month of ais trajectory data in zhou shan islands the results indicate that the proposed method can quickly compress the ship trajectory while retaining the characteristics of the original trajectory shape additionally the proposed method can sharply reduce the running time of compression when compared to that of the traditional dp algorithm besides the quality of the simplified trajectory by the proposed method is improved when the threshold is relatively high furthermore the proposed method outperforms the existing algorithms regarding the running time of compression of vessel trajectory consequently the proposed method can better satisfies the needs of practical application which is more focused on running time and data quality at high compression strength future studies will focus on the improvement in compression performance under the condition of a low threshold value acknowledgments this work was partly supported by national natural science foundation of china grant number 51579025 
